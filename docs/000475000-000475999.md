# StackOverflow 问答 000475000-000475999

# asp.net - 查询 LINQ to SQL 关系

> ID：475003
> 
> 赞同：3
> 
> 时间：2009-01-23T23:07:21.157
> 
> 标签：asp.net, sql, linq, linq-to-sql

使用 LINQ to SQL

```
db.Products.Where(c => c.ID == 1).Skip(1).Take(1).ToList(); 
```

执行

```
SELECT [t1].[ID], [t1].[CategoryID], [t1].[Name], [t1].[Price], [t1].[Descripti
n], [t1].[IsFeatured], [t1].[IsActive]
FROM (
    SELECT ROW_NUMBER() OVER (ORDER BY [t0].[ID], [t0].[CategoryID], [t0].[Name
, [t0].[Price], [t0].[Description], [t0].[IsFeatured], [t0].[IsActive]) AS [ROW
NUMBER], [t0].[ID], [t0].[CategoryID], [t0].[Name], [t0].[Price], [t0].[Descrip
ion], [t0].[IsFeatured], [t0].[IsActive]
    FROM [dbo].[Products] AS [t0]
    WHERE [t0].[ID] = @p0
    ) AS [t1]
WHERE [t1].[ROW_NUMBER] BETWEEN @p1 + 1 AND @p1 + @p2
ORDER BY [t1].[ROW_NUMBER]
-- @p0: Input Int (Size = 0; Prec = 0; Scale = 0) [1]
-- @p1: Input Int (Size = 0; Prec = 0; Scale = 0) [1]
-- @p2: Input Int (Size = 0; Prec = 0; Scale = 0) [1] 
```

它使用 ROW_NUMBER 进行分页......很好。

现在，我正在尝试使用 LINQ to SQL 生成的关系对数据进行分页。使用查询...

```
var cat = db.Categories.Where(c => c.ID == 1).SingleOrDefault();
cat.Products.Where(c => c.ID == 1).Skip(1).Take(1).ToList();

SELECT [t0].[ID], [t0].[Name]
FROM [dbo].[Categories] AS [t0]
WHERE [t0].[ID] = @p0
-- @p0: Input Int (Size = 0; Prec = 0; Scale = 0) [1]
-- Context: SqlProvider(Sql2008) Model: AttributedMetaModel Build: 3.5.30729.1

SELECT [t0].[ID], [t0].[CategoryID], [t0].[Name], [t0].[Price], [t0].[Descriptio
n], [t0].[IsFeatured], [t0].[IsActive]
FROM [dbo].[Products] AS [t0]
WHERE [t0].[CategoryID] = @p0
-- @p0: Input Int (Size = 0; Prec = 0; Scale = 0) [1]
-- Context: SqlProvider(Sql2008) Model: AttributedMetaModel Build: 3.5.30729.1 
```

现在不再使用 ROW_NUMBER 和分页了......它得到了 CategoryID = 1 的所有产品......为什么它得到所有行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T02:48:01.430

我认为这是因为该类别在内存中。您隐含地要求它获取该类别的产品。这个对数据的隐式请求是为了填充，然后在内存中（此时类别所在的位置）执行查询。

我认为它相当于：

```
var cat = db.Categories.Where(c => c.ID == 1).SingleOrDefault();
var prods = db.Products.Where(c => c.ID == 1).ToList();
var r = prods.Where(p.CategoryID == cat.ID).Skip(1).Take(1); 
```

注意意义，如果 cat 内存发生变化怎么办？集合的大小可能会有所不同。

注意：感谢您的头痛:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T00:27:16.083

你有没有尝试过：

```
var cat = db.Categories.Where(c => c.ID == 1);
var prod = cat.Products.Where(c => c.ID == 1).Skip(1).Take(1).ToList(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-24T01:25:37.743

您尚未分配第二个 LINQ 查询的输出。所以'cat'仍然是第一个查询。

# makefile - 在 windows 中使用 cat 的问题

> ID：475007
> 
> 赞同：0
> 
> 时间：2009-01-23T23:07:48.287
> 
> 标签：makefile, cat

我用的是windowsxp。[我正在使用的“猫”版本与arduino](http://arduino.cc)下载捆绑在一起。

makefile 运行 cat。

这是输出：

```
cat \arduino-0012\hardware\cores\arduino\main.cxx >> applet\foo.cpp
cat: arduino-0012hardwarecoresarduinomain.cxx: No such file or directory
make: *** [applet_files] Error 1 
```

我也尝试了正斜杠/，但这给出了

```
cat: /arduino-0012/hardware/cores/arduino/main.cxx: No such file or directory 
```

（加倍反斜杠，\，没有帮助）

但是，如果我手动运行 cat 命令，它就可以工作。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T23:10:58.140

我不熟悉这些工具，但看起来您可能需要转义（加倍）makefile 中的反斜杠，因为错误消息显示没有任何反斜杠的路径。

或者，它可能期望一个 Unix 风格的路径，而该路径将有正斜杠。

**新信息**：看起来需要进行两项更改：（a）使用正斜杠，以及（b）指定驱动器，因为类 Unix 环境不像 DOS 那样默认。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T23:11:22.337

由于错误，我猜猫希望你给它另一个斜线。

'/' 代替 '\'

不确定虽然尝试一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T23:18:40.730

实际上，Unix 风格的路径有效，但不是相对路径。我不得不使用 g:/....

# asp.net-mvc - 在 ASP.NET MVC 应用程序中将图像和静态文件放在何处的正确做法？

> ID：475012
> 
> 赞同：5
> 
> 时间：2009-01-23T23:09:03.527
> 
> 标签：asp.net-mvc

标准 ASP.NET 模板“ `Content`”中有一个目录，大多数人似乎都在其中放入图像和 css 文件等。

比如stackoverflow的logo：

[![替代文字](https://i.stack.imgur.com/rMcPF.png)](https://i.stack.imgur.com/rMcPF.png)
[（来源：[stackoverflow.com](http://www.stackoverflow.com/Content/Img/stackoverflow-logo-250.png)）]

实际上是指在 URL 中包含“内容”的服务器路径（只需查看任何 SO 页面的源代码，您就会看到这一点）。所以他们显然将图像存储在“ `content/images/...`”中。

```
src="/Content/Img/stackoverflow-logo-250.png" 
```

编辑：在过去 10 年的某个时候，他们改变了道路——但这就是过去的样子。

我不是特别喜欢这个。我的 HTML 最终`/content`全是它，迁移只有 /image 的现有页面稍微困难一些。幸运的是`content`，只要我将样式表保存在`content\site.css`.

另一种方法是将`images`目录放在根目录中，但随后您将获得`images`与 相同的级别`Controllers`，`Views`这非常可怕。

我想知道尝试添加这样的重定向规则：

```
routes.RedirectRoute(
   "images rule",
   "Images/{*}",
   "Content/Images/{1}");    // this is NOT valid code - I made it up 
```

但是该代码不起作用，因为我只是编造了它。我可以使用第三方重定向/重写插件，但我想在 MVC 模型中保持一切“纯粹”。

其他人在这个地区发现了什么？还是每个人都`("/content".length)`对他们提供的每张图片的源代码中的额外字节感到满意。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T23:46:30.970

老实说，我不认为它真的值得担心......“/Content”将对您的页面大小做出相当小的贡献。如果您仍然想这样做，这里有一些选项：

选项 1，如果您在自己的服务器上运行，则检查 IIS URL 重写模块：[http ://learn.iis.net/page.aspx/460/using-url-rewrite-module/](http://learn.iis.net/page.aspx/460/using-url-rewrite-module/)

选项 2 是使用 RedirectResult 或 ContentResult，以在 MVC 框架中实现相同的效果

首先，将“Images/”下的“catchall”路由映射到控制器操作，如下所示

```
routes.MapRoute("ImageContent", 
                "Images/{*relativePath}", 
                 new { controller = "Content", action = "Image" }) 
```

确保它高于您的标准“{controller}/{action}/{id}”路线。然后，在 ContentController 中（或您决定放置它的任何地方）：

```
public ActionResult Image() {
    string imagePath = RouteData.Values["relativePath"]
    // imagePath now contains the relative path to the image!
    // i.e. http://mysite.com/Images/Foo/Bar/Baz.png => imagePath = "Foo/Bar/Baz.png"
    // Either Redirect, or load the file from Content/Images/{imagePath} and transmit it
} 
```

我做了一个快速测试，它似乎工作。如果您有任何问题，请在评论中告诉我！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T22:55:31.510

通常最好将图像放在不同的子域下。原因是浏览器限制了每个 URL 的连接数。因此，如果您现在使用[http://static.mysiste.com](http://static.mysiste.com)，浏览器可以打开更多并发连接，因为它位于不同的 URL 中。

# gis - 如何按地理位置对 Salesforce 潜在客户进行排序/分组？

> ID：475015
> 
> 赞同：2
> 
> 时间：2009-01-23T23:10:24.723
> 
> 标签：gis, salesforce

如果我在 Salesforce 中拥有所有潜在客户的经纬度数据，有没有办法编写查询来对它们进行分组，或者说列出加利福尼亚州旧金山 10 英里内的所有潜在客户？

[编辑：澄清] 我有成千上万的潜在客户，包括完整地址和长/纬度。我想对这些潜在客户建立一个查询，这将为我提供加利福尼亚州旧金山附近的所有潜在客户。这意味着在 Salesforce 中进行 GIS 类型的工作。

我当然可以专门过滤城市、邮政编码或区号，但这在尝试汇总整个都会区时会出现一些问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T23:15:14.417

是的。您需要使用工具/服务对它们进行反向地理编码。过去我使用过[Maporamas](http://world.maporama.com/)服务，但它非常昂贵，而且那是在谷歌地图和虚拟地球出现之前，所以我确信现在有更便宜（免费）的东西......谷歌搜索我发现[了这个](http://www.viawindowslive.com/Articles/VirtualEarth/Freereversegeocoding.aspx)和[这个](http://groups.google.com/group/Google-Maps-API/web/resources-non-google-geocoders?pli=1)

**编辑：**

好的，据我了解，您正在尝试计算 2 个纬度/经度点之间的距离。我会首先打折那些在你（比如说）10英里范围之外的地方。因此，从您的中心点，您将想要获得东、西、南和北 10 英里的坐标。为此，您需要使用[大圆距离](http://en.wikipedia.org/wiki/Great-circle_distance)公式。

从那时起，如果您希望进一步分解此数据，您就拥有了销售人员数据，那么您需要按与中心点的距离对这些点进行排序。为此，您需要使用[Haversine 公式](http://en.wikipedia.org/wiki/Haversine_formula)

我不确定您的语言偏好是什么，所以我只包含了一些来自 SQL（主要）和 C# 的示例

[C# 和 SQL 中的半正弦公式](http://megocode3.wordpress.com/2008/02/05/haversine-formula-in-c/)

[使用 C# 确定邮政编码之间的距离](https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/programming-and-development/?p=634)

[大圆SQL](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=81360)

[大圈子 2](http://www.bigresource.com/MS_SQL-Great-Circle-distance-calculation-AAuK69yL.html#ZWR4HbHJ)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T16:47:18.180

这些是一些很棒的技术解决方案，可以提供非常准确的答案，但需要考虑两件事：

*   地理空间*接近度*并没有很好地映射到*责任*

所有权计算似乎最好通过邮政编码查找或其他不允许间隙或重叠的规则来完成。否则，您将有两个（或更多）销售人员争夺靠近他们的潜在客户，而忽略那些远离他们的潜在客户。

因此，如果您使用上述地理计算来分配所有权，只需确认系统会泄漏并为此创建业务规则即可。但是一个简单的邮政查询来定义区域（就像 salesforce 自己的[区域管理](http://www.salesforce.com/community/crm-best-practices/sales-professionals/account-management/territory-management/detail273.jsp)功能所做的那样）可能会更好。

我建议我们试图在地理空间上解决的问题不是谁拥有哪条线索。相反，考虑到您拥有的所有潜在客户，哪些在附近？

*   地图通常每像素提供比柱状报告更多的数据

同样，报告中的地理空间数据可能不是最佳答案。一条 50 公里外的铅，但沿着一条主要道路，比另一条 50 公里外的山或湖另一边的铅更有趣。或者靠近其他潜在客户的潜在客户比潜在客户本身更有趣。

报告无法显示这一点，但地图可以。

Salesforce 有一些很好的 Google 地图集成示例。为什么不使用名为“我附近的潜在客户”的柱状报告，而不要使用带有谷歌地图的 visualforce 页面？您为用户提供的信息远远超过柱状报告所能提供的信息。他们可能更喜欢它，而且它比尝试计算上面的一些方程更容易实现。

只是另一种可能（或可能不）适合手头问题的观点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T18:15:01.683

使用 GeoHash.org（作为 Web 服务或实现算法）。它将您的经纬度坐标散列成与附近地点相似的形式。例如，A 可能有一个像“akusDf3af”这样的散列，而 B 可能有一个像“akusDf3b2”这样的散列，如果它们在附近的话。然后执行 SOQL 查询，查找以与已知位置相同的 n 个字符开头的位置。您的 n 将确定查找的半径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-04T15:16:17.023

这篇文章真的很旧，但出现在谷歌搜索结果的顶部，所以我想我还是会向它发布一些信息。

2 个不错的地图工具是 batchgeo.com 和 geocod.io。Geocod.io 甚至可以为您提供地址的经纬度坐标。

如果您只需要一次计算，您可以使用 Excel。使用经纬度导出所有潜在客户。然后去谷歌地图，获取你想测量的城市中心的经度和十进制度。

然后在excel中使用这个公式来计算坐标之间的距离（以英里为单位）。Lat1dd 和 Long1dd 是一个点的坐标，而 lat2dd 和 long2dd 是另一个点的坐标点。

```
=3963*ACOS(COS(RADIANS(90-lat1dd))*COS(RADIANS(90-lat2dd))+SIN(RADIANS(90-lat1dd))*SIN(RADIANS(90-lat2dd))*COS(RADIANS(long1dd-long2dd))) 
```

运行后，只需将结果从小到大排序即可得到最接近的结果。

我还没有完成下一部分，但从概念上讲它应该可以工作。我们有一个字段列出了每个帐户所在的主要市场。例如，伊利诺伊州芝加哥。我将构建一个触发器或公式字段，它基本上说 IF(Market="Chicago IL") 然后使用 X 和 Y 作为纬度和经度。这些将被硬编码为该特定市场的市中心。然后，该查询将针对来自市中心的账户运行每个账户的经纬度，以计算距离。

如果您想将市场划分为不同的区域，您可以调整您的公式，使其在纬度和经度字段上使用 < 和 >。小于 X 但大于 Y 的所有东西都进入 A 区，依此类推。

希望这可以帮助某人。

# debugging - 如何调试 beanshell 脚本？

> ID：475025
> 
> 赞同：3
> 
> 时间：2009-01-23T23:13:26.870
> 
> 标签：debugging, beanshell

我在调试 beanshell 脚本时遇到了麻烦，我一直得到的是：

调用导入对象方法的异常。：在第 194 行：在文件中：内联评估：``import java.lang.reflect.InvocationTargetException; 导入 java.util.Arrays；一世 。. . '' : migrateModels (模型, apiManager, isSAPRetailImportCondition, isSAPAFSCondition)

从方法调用：initMissingImportSources：在行：-1：在文件中：：目标异常：java.lang.reflect.InvocationTargetException

```
at bsh.BshMethod.invoke(Unknown Source)
at bsh.BshMethod.invoke(Unknown Source)
at bsh.Name.invokeLocalMethod(Unknown Source)
at bsh.Name.invokeMethod(Unknown Source)
at bsh.BSHMethodInvocation.eval(Unknown Source)
at bsh.BSHPrimaryExpression.eval(Unknown Source)
at bsh.BSHPrimaryExpression.eval(Unknown Source)
at bsh.BSHBlock.evalBlock(Unknown Source)
at bsh.BSHBlock.eval(Unknown Source)
at bsh.BshMethod.invokeImpl(Unknown Source)
at bsh.BshMethod.invoke(Unknown Source)
at bsh.BshMethod.invoke(Unknown Source)
at bsh.This.invokeMethod(Unknown Source)
at ImportSourceMigration.initMissingImportSources(BeanShell Generated via ASM (www.objectweb.org))
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:585)
at bsh.Reflect.invokeMethod(Unknown Source)
at bsh.Reflect.invokeObjectMethod(Unknown Source)
at bsh.Name.invokeMethod(Unknown Source)
at bsh.BSHMethodInvocation.eval(Unknown Source)
at bsh.BSHPrimaryExpression.eval(Unknown Source)
at bsh.BSHPrimaryExpression.eval(Unknown Source)
at bsh.BSHBlock.evalBlock(Unknown Source)
at bsh.BSHBlock.eval(Unknown Source)
at bsh.BSHBlock.eval(Unknown Source)
at bsh.BSHTryStatement.eval(Unknown Source)
at bsh.Interpreter.eval(Unknown Source)
at bsh.Interpreter.eval(Unknown Source)
at bsh.Interpreter.eval(Unknown Source)
at bsh.servlet.BshServlet.evalScript(Unknown Source)
at bsh.servlet.BshServlet.doGet(Unknown Source) 
```

我正在尝试使用此代码检索完整的堆栈跟踪

```
 try {
        migration.initMissingImportSources();
    } catch (java.lang.Throwable e) {
        print(ExceptionUtils.getFullStackTrace(e));
    } 
```

是否有可能检索导致的异常？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T00:46:51.753

你“ExceptionUtils.getFullStackTrace()”到底在做什么？您确定它正在打印嵌套异常吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T14:14:45.857

非常感谢您的回复。是的 getFullStackTrace 来自 apache commons，应该可以工作。我发现了问题。关键是我在一个方法调用中没有完整的脚本。这很重要，只有这样你才能用 try catch 包围它并查看异常。希望将来也对其他人有所帮助。我现在看到了例外。我有几种方法互相调用。

# programming-languages - 从片段中检测编程语言

> ID：475033
> 
> 赞同：127
> 
> 时间：2009-01-23T23:16:30.500
> 
> 标签：programming-languages, language-detection

检测代码片段中使用哪种编程语言的最佳方法是什么？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-01-23T23:21:41.393

我认为垃圾邮件过滤器中使用的方法效果很好。您将片段分成单词。然后，您将这些单词的出现与已知片段进行比较，并计算该片段以您感兴趣的每种语言的语言 X 编写的概率。

[http://en.wikipedia.org/wiki/Bayesian_spam_filtering](http://en.wikipedia.org/wiki/Bayesian_spam_filtering)

如果您有基本机制，那么添加新语言非常容易：只需使用新语言的一些片段训练检测器（您可以将其提供给开源项目）。通过这种方式，它知道“System”可能出现在 C# 代码片段中，而“puts”可能出现在 Ruby 代码片段中。

我实际上已经使用这种方法将语言检测添加到论坛软件的代码片段中。它在 100% 的时间内都有效，除了在模棱两可的情况下：

```
print "Hello" 
```

让我找到代码。

我找不到代码，所以我做了一个新的。这有点简单，但它适用于我的测试。目前，如果你给它提供的 Python 代码比 Ruby 代码多得多，它可能会说这段代码：

```
def foo
   puts "hi"
end 
```

是 Python 代码（虽然它确实是 Ruby）。这是因为 Python 也有`def`关键字。因此，如果它`def`在 Python 中看到了 1000 倍`def`，在 Ruby 中看到了 100 倍，那么它可能仍然会说 Python`puts`并且`end`是特定于 Ruby 的。您可以通过跟踪每种语言看到的单词并除以某处的单词（或通过在每种语言中为其提供等量的代码）来解决此问题。

我希望它可以帮助你：

```
class Classifier
  def initialize
    @data = {}
    @totals = Hash.new(1)
  end

  def words(code)
    code.split(/[^a-z]/).reject{|w| w.empty?}
  end

  def train(code,lang)
    @totals[lang] += 1
    @data[lang] ||= Hash.new(1)
    words(code).each {|w| @data[lang][w] += 1 }
  end

  def classify(code)
    ws = words(code)
    @data.keys.max_by do |lang|
      # We really want to multiply here but I use logs 
      # to avoid floating point underflow
      # (adding logs is equivalent to multiplication)
      Math.log(@totals[lang]) +
      ws.map{|w| Math.log(@data[lang][w])}.reduce(:+)
    end
  end
end

# Example usage

c = Classifier.new

# Train from files
c.train(open("code.rb").read, :ruby)
c.train(open("code.py").read, :python)
c.train(open("code.cs").read, :csharp)

# Test it on another file
c.classify(open("code2.py").read) # => :python (hopefully) 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-03-12T22:11:29.943

别人解决的语言检测：

Ohloh的做法：[https ://github.com/blackducksw/ohcount/](https://github.com/blackducksw/ohcount/)

Github 的做法：[https ://github.com/github/linguist](https://github.com/github/linguist)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-02-27T10:20:23.693

Guesslang 是一个可能的解决方案：

[http://guesslang.readthedocs.io/en/latest/index.html](http://guesslang.readthedocs.io/en/latest/index.html)

还有 SourceClassifier：

[https://github.com/chrislo/sourceclassifier/tree/master](https://github.com/chrislo/sourceclassifier/tree/master)

在我无法识别的博客文章中找到一些代码后，我对这个问题产生了兴趣。添加此答案，因为此问题是“识别编程语言”的第一次搜索命中。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-12T09:42:52.370

另一种方法是使用[highlight.js](http://softwaremaniacs.org/soft/highlight/en/)，它执行语法突出显示，但使用突出显示过程的成功率来识别语言。原则上，任何语法高亮代码库都可以以相同的方式使用，但是 highlight.js 的好处是语言检测被认为是一项功能并[用于测试目的](http://softwaremaniacs.org/media/soft/highlight/test.html)。

**更新：**我试过了，但效果不太好。压缩的 JavaScript 完全混淆了它，即标记器对空格敏感。一般来说，只计算亮点点击似乎不太可靠。一个更强大的解析器，或者可能是无与伦比的节数，可能会更好。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-23T23:21:19.600

首先，我会尝试找到一种语言的特定keyworks，例如

```
"package, class, implements "=> JAVA
"<?php " => PHP
"include main fopen strcmp stdout "=>C
"cout"=> C++
etc... 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-23T23:27:30.650

这非常困难，有时甚至是不可能的。这个简短的片段来自哪种语言？

```
int i = 5;
int k = 0;
for (int j = 100 ; j > i ; i++) {
    j = j + 1000 / i;
    k = k + i * j;
} 
```

（提示：它可以是几个中的任何一个。）

您可以尝试分析各种语言并尝试决定使用关键字的频率分析。如果某些关键字集在文本中以某些频率出现，则该语言很可能是 Java 等。但我认为您不会得到任何完全万无一失的东西，因为您可以将 C 中的变量命名为相同的名称作为Java中的关键字，频率分析会被愚弄。

如果您将其复杂性提高一个档次，则可以寻找结构，如果某个关键字总是在另一个关键字之后，那将为您提供更多线索。但它的设计和实施也将更加困难。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-23T23:20:57.060

这取决于您拥有哪种类型的代码段，但我会通过一系列标记器运行它，并查看它针对哪种语言的 BNF 有效。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-06-08T06:17:22.673

我需要这个，所以我创建了自己的。 [https://github.com/bertyhell/CodeClassifier](https://github.com/bertyhell/CodeClassifier)

通过在正确的文件夹中添加一个培训文件，它很容易扩展。用c#写的。但我想代码很容易转换为任何其他语言。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-07-27T17:34:42.323

我遇到的最佳解决方案是在 Ruby on Rails 应用程序中使用[linguist gem 。](https://github.com/github/linguist)这是一种特定的方法，但它确实有效。@nisc 上面提到了这一点，但我会告诉你我使用它的确切步骤。（以下一些命令行命令特定于 ubuntu，但应该很容易翻译到其他操作系统）

如果您有任何不介意暂时弄乱的 Rails 应用程序，请在其中创建一个新文件以插入有问题的代码片段。（如果您没有安装 rails，[这里](http://installrails.com/)有一个很好的指南，尽管对于 ubuntu 我推荐[这个](https://gorails.com/setup/ubuntu/14.04)。然后运行`rails new <name-your-app-dir>`并 cd 进入该目录。运行 rails 应用程序所需的一切都已经存在）。

在你有一个可以使用它的 rails 应用程序之后，添加`gem 'github-linguist'`到你的 Gemfile（字面意思是`Gemfile`在你的应用程序目录中调用，没有 ext）。

然后安装 ruby​​-dev ( `sudo apt-get install ruby-dev`)

然后安装 cmake ( `sudo apt-get install cmake`)

现在你可以运行了`gem install github-linguist`（如果你得到一个说需要 icu 的错误，做`sudo apt-get install libicu-dev`然后再试一次）

（如果上述方法不起作用，您可能需要执行`sudo apt-get update`or`sudo apt-get install make`或）`sudo apt-get install build-essential`

现在一切都设置好了。您现在可以在任何时候使用它来检查代码片段。在文本编辑器中，打开您为插入代码片段而制作的文件（假设它是`app/test.tpl`，但如果知道片段的扩展名，请使用它而不是`.tpl`. 如果您不知道扩展名，请不要使用）。现在将您的代码片段粘贴到此文件中。转到命令行并运行`bundle install`（必须在您的应用程序的目录中）。然后运行`linguist app/test.tpl`（更一般地`linguist <path-to-code-snippet-file>`）。它会告诉你类型、mime 类型和语言。对于多个文件（或与 ruby​​/rails 应用程序一起使用），您可以`bundle exec linguist --breakdown`在应用程序的目录中运行。

似乎需要做很多额外的工作，尤其是如果您还没有 rails，但是如果您按照这些步骤操作，您实际上不需要了解有关 rails 的任何信息，而且我真的没有找到更好的方法来检测文件/代码片段的语言。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-23T23:22:05.013

不错的拼图。

我认为检测所有语言是不可能的。但是您可以触发关键令牌。（某些保留字和常用字符组合）。

Ben 有很多具有相似语法的语言。所以这取决于片段的大小。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-04-05T15:15:04.517

Prettify 是一个 Javascript 包，可以很好地检测编程语言：

[http://code.google.com/p/google-code-prettify/](http://code.google.com/p/google-code-prettify/)

它主要是一个语法荧光笔，但可能有一种方法可以提取检测部分，以便从片段中检测语言。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-23T23:22:37.507

我认为不会有一种简单的方法来实现这一点。我可能会生成某些语言/语言类别特有的符号/常用关键字列表（例如，C 风格语言的大括号，BASIC 语言的 Dim 和 Sub 关键字，Python 的 def 关键字，函数式语言的 let 关键字） . 然后，您可能能够使用基本语法功能来进一步缩小范围。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-11-28T00:37:01.240

我认为语言之间最大的区别在于它的结构。所以我的想法是查看所有语言中的某些共同元素，看看它们有何不同。例如，您可以使用正则表达式来挑选以下内容：

*   函数定义
*   变量声明
*   类声明
*   评论
*   for 循环
*   while 循环
*   打印报表

也许还有其他一些大多数语言应该具备的东西。然后使用积分系统。如果找到正则表达式，每个元素最多奖励 1 分。显然，某些语言将使用完全相同的语法（for 循环通常写成这样`for(int i=0; i<x; ++i)`，因此多种语言可以为同一事物各得一分，但至少您降低了它是完全不同语言的可能性）。其中一些可能全面得分为 0（例如，代码片段根本不包含函数），但这完全没问题。

将此与 Jules 的解决方案结合起来，它应该可以很好地工作。也许还可以寻找关键字的频率以获得额外的分数。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-10-29T07:55:57.357

有趣的。我有一个类似的任务来识别不同格式的文本。YAML、JSON、XML 或 Java 属性？例如，即使存在语法错误，我也应该自信地将 JSON 与 XML 区分开来。

我认为我们如何为问题建模是至关重要的。正如 Mark 所说，单个词标记化是必要的，但可能还不够。我们将需要二元组，甚至三元组。但我认为我们可以从那里走得更远，因为我们正在研究编程语言。我注意到几乎所有编程语言都有两种独特的标记类型——**符号**和**关键字**。符号相对容易识别（某些符号可能是不属于语言的文字）。然后符号的二元组或三元组将在符号周围拾取独特的语法结构。如果训练集足够大且足够多样化，关键字是另一个简单的目标。一个有用的功能可能是围绕可能的关键字的二元组。另一种有趣的标记类型是**空格**. 实际上，如果我们以通常的方式通过空格进行标记，我们将丢失这些信息。我想说，为了分析编程语言，我们保留空白标记，因为这可能携带有关语法结构的有用信息。

最后，如果我选择像随机森林这样的分类器，我会爬 github 并收集所有公共源代码。大多数源代码文件都可以通过文件后缀来标记。对于每个文件，我会在空行处将其随机拆分为各种大小的片段。然后，我将提取特征并使用标记的片段训练分类器。训练完成后，可以测试分类器的精度和召回率。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-07-13T12:12:27.977

如果您想要一种将代码段粘贴到 Web 表单中的快速方法，而不是以编程方式进行，那么该站点似乎非常擅长识别语言：http: [//dpaste.com/](http://dpaste.com/)

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2016-02-04T21:09:06.760

我相信没有单一的解决方案可以仅基于该单个片段来识别片段所使用的语言。取关键词`print`。它可以以任意数量的语言出现，每种语言都有不同的用途，并且具有不同的语法。

我确实有一些建议。我目前正在为我的网站编写一小段代码，可用于识别编程语言。像大多数其他帖子一样，可能有**大量**您根本没有听说过的编程语言，您无法解释所有这些。

我所做的是，每种语言都可以通过选择的关键字来识别。例如，可以通过多种方式识别 Python。如果您选择当然也是该语言独有的“特征”，这可能会更容易。对于 Python，我选择使用冒号开始一组语句的特性，我认为这是一个相当独特的特性（如果我错了，请纠正我）。

如果在我的示例中，您找不到冒号来启动语句集，那么请转到另一个可能的特征，假设使用`def`关键字来定义函数。现在这可能会导致一些问题，因为 Ruby 也使用关键字`def`来定义函数。区分这两者（Python 和 Ruby）的关键是使用不同级别的过滤来获得最佳匹配。Ruby 使用关键字`end`来完成一个函数，而 Python 没有任何东西来完成一个函数，只是一个 de-indent 但你不想去那里。但同样，`end`也可能是 Lua，这是另一种添加到组合中的编程语言。

您可以看到编程语言只是覆盖太多。一个可能是一种语言的关键字的关键字可能恰好是另一种语言的关键字。使用经常一起出现的关键字组合，例如 Java 的关键字，`public static void main(String[] args)`有助于消除这些问题。

就像我已经说过的那样，您最好的机会是寻找相对独特的关键字或一组关键字来将一个与另一个分开。而且，如果你弄错了，至少你有机会。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2016-02-16T04:27:47.613

设置随机扰码器，如

```
matrix S = matrix(GF(2),k,[random()<0.5for _ in range(k^2)]); while (rank(S) < k) : S[floor(k*random()),floor(k*random())] +=1; 
```

# actionscript - 为什么 Actionscript 2.0 在这里有不可预测的输出？

> ID：475034
> 
> 赞同：1
> 
> 时间：2009-01-23T23:17:24.570
> 
> 标签：actionscript, actionscript-2

我在一段时间内第一次在 Actionscript 2.0 中做一些工作（非常简单的东西，只是从文本文件中提取内容），我无法理解为什么我会在这里得到如此不可预测的输出。

有时当我测试构建这样一个简单的脚本时，变量被列为未定义，有时它们不是。

我假设这可能是因为从 cookware.txt 加载的数据尚未加载到内存中，但这似乎并非如此 - 根据[此处](http://www.adobe.com/support/flash/action_scripts/actionscript_dictionary/actionscript_dictionary427.html)的 Actionscript 字典，onLoad 函数仅在以下情况下触发数据已被加载，程序的其余部分可以访问。

任何人都可以解释一下吗？或者看看为什么会发生这种情况？

## cookware.txt 的内容：

```
pots=44&kettles=43 
```

## 代码

```
_global.pots;
_global.kettles;

trace('variables not assigned')
trace('before: kettles (global) = ' + _global.kettles);

trace('before: pots (global) = ' + _global.pots);

var my_lv:LoadVars = new LoadVars();

my_lv.onLoad = function(success:Boolean):Void {
    if (success) {

        trace('variables clearly loaded: kettles = ' + kettles); 

        _global.kettles = this.kettles;

        trace('assigned during loop: kettles in = ' + _global.kettles); 

        trace('pots = ' + kettles);

        _global.pots = this.pots;

        trace('during: pots = ' + _global.pots);

     } else {
        trace("Error");
    }
}

my_lv.load("cookware.txt");

trace('after: kettles (global) = ' + _global.kettles);

trace('after: pots (global) = ' + _global.pots); 
```

## 输出：：

有时是这样的：

```
variables not assigned
before: kettles (global) = undefined
before: pots (global) = undefined
after: kettles (global) = undefined
after: pots (global) = undefined
variables clearly loaded: kettles = undefined
assigned during loop: kettles in = 43
pots = 43
during: pots = 43 
```

有时是这样的：

```
variables not assigned
before: kettles (global) = 43
before: pots (global) = 44
after: kettles (global) = 43
after: pots (global) = 44
variables clearly loaded: kettles = 43
assigned during loop: kettles in = 43
pots = 43
during: pots = 43 
```

同样，变量是否未定义似乎完全随机。这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T06:56:00.057

您可能遇到[范围链](http://timotheegroleau.com/Flash/articles/scope_chain.htm)问题。它在 Flash 中的工作方式非常令人困惑。简短的回答是将您的 _global.pots 和 _global.kettles 命名为不同于外部文件中使用的名称以避免冲突。

问题是在您的函数内部，“kettles”对象将引用本地“this.kettles”对象，但前提是它已定义。如果不是，那么它将引用“_global.kettles”对象。这使得 OnLoad 的设置行为难以预测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T13:17:07.760

小范围建议：创建一个变量 currentTimeline = _level0（或您的 levelN），您可以在 onLoad 函数的成功部分中使用，避免名称冲突并仅在绝对必要时使用 _global。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T07:08:15.200

这里可能存在一些范围问题，但我不知道如何

```
before: kettles (global) = 43 
```

曾经发生过-您甚至还没有调用加载。和

```
after: kettles (global) = 43 
```

可能也不应该工作，因为负载将异步执行。这似乎表明 Flash 播放器在播放之间缓存了 _global 变量，但我以前从未听说过这种情况。你是如何建造这个的？你每次都只是在 Flash IDE 中编译 swf 吗？

是的，大卫所说的范围界定和这个，特别是我会追踪 this.kettles 而不是仅仅为保持一致而使用水壶。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T00:18:07.953

感谢各位的帮助——我之前没有点击 LoadVars() 是一个异步函数，并且脚本的其余部分将继续运行而不检查它是否已加载。

我设法通过检查 loadVar 是否已在每一帧上完成来解决此问题，然后在 loadVar 完成后执行代码。

我已经编译了 swf 以进行测试（命令 + 返回）。

# configuration - 在 Tomcat 启动时加载上下文/servlet *不更改部署描述符 (web.xml)

> ID：475037
> 
> 赞同：3
> 
> 时间：2009-01-23T23:19:30.493
> 
> 标签：configuration, tomcat, servlets

我有一个`foo.war`来自第三方供应商的文件。我通过创建`conf/Catalina/localhost/foo.xml`包含以下内容在我的 Tomcat 配置中定义了一个上下文：

```
<Context docBase="/path/to/foo.war" ...> ... </Context> 
```

我希望 Tomcat 在启动时加载 foo 上下文。但是文件中的`WEB-INF/web.xml`（部署描述符）`foo.war`不包含`<load-on-startup`>，所以Tomcat一直等到第一个请求。我真的宁愿不解压第三方`foo.war`来编辑他们的 web.xml。另外，每次供应商发布他们的.war 的新版本时，我都必须这样做。

在 Tomcat 配置中是否有任何方法可以告诉 Tomcat 在启动时加载 foo 上下文？我知道`<Context>`您可以在元素中设置参数、环境变量等，而无需编辑 web.xml。但我在 Tomcat 文档中找不到任何关于启动时加载的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T01:40:09.273

这很棘手。您受到 Tomcat 和其他容器约定的限制，因此没有直接的解决方案。

您可以使用全局 web.xml 使用该`<load-on-startup>`元素从 .war 初始化特定的 servlet 和/或 JSP。这是我所知道的在不修改 .war 文件或其中的 WEB-INF/web.xml 的情况下强制加载启动的唯一方法。请注意，您可能需要使用不同的名称/路径来初始化 servlet 和 JSP 以避免冲突。

当然，这样做意味着您必须对 .war 有足够的了解才能初始化应用程序，这可能意味着查看其 web.xml 以确定要加载的内容。这可能会破坏目的，因为它并不是一种在启动时加载任何 .war 的不干涉方法。但是通过一些额外的工作，您可以编写一个脚本，从 .war 文件的 web.xml 中提取必要的信息并将其自动添加到您的全局 web.xml 中。

现在，如果您愿意考虑编写脚本来修改 .war 文件，您可以编写一个脚本，从 .war 文件中提取 WEB-INF/web.xml，将`<load-on-startup>`子元素添加到所有`<servlet>`元素，然后更新.war 与新副本。我不确定您使用什么环境来运行 Tomcat，但这里有一个可以完成这项工作的示例 bash 脚本：

```
#!/bin/sh

TEMPDIR=/tmp/temp$$
WARFILE=/path-to-tomcat/webapps/foo.war

mkdir -p $TEMPDIR/WEB-INF
pushd $TEMPDIR
unzip -qq -c $WARFILE WEB-INF/web.xml \
    | sed 's#</servlet>.*#<load-on-startup>99</load-on-startup></servlet>#' \
    > WEB-INF/web.xml
zip -f $WARFILE WEB-INF/web.xml
popd
rm -rf $TEMPDIR 
```

作为 Tomcat 启动的一部分，您可以运行此脚本或类似的脚本。希望这可以帮助。

# crystal-reports - Crystal Reports 2008 列中的最小值和最大值

> ID：475043
> 
> 赞同：0
> 
> 时间：2009-01-23T23:21:54.467
> 
> 标签：crystal-reports, formula

假设我在 Crystal 的命令中返回了此列：

```
deposit_no
123
130
125
124
126
127
128
129 
```

我需要在报告标题中有这个：

> 包括 123 - 130 之间的存款

我已经尝试了最小值和最大值的运行公式，无论我如何操作它们，它们都没有返回正确的值。我已经尝试评估每条记录，更改 deposit_no 字段等。我对此报告没有分组。

编辑添加：虽然我更喜欢在 CR 方面处理这个问题，但我更改了我的命令以包含 mson 在下面写的内容。所以从技术上讲，mson 有正确的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T18:02:12.927

创建具有所需信息的存储过程或视图。通过水晶报表访问存储过程或查看。

水晶报告是正确编码任何东西的障碍。

您得到的意外结果可能是因为该列不是数字。通常，数值存储为 varchar/nvarchar。这尤其适用于邮政编码/电话号码/等字段。其中值可能是数字，但您永远不会对它们进行数学运算。

无论如何，这里是您可以用来在 sql server 中构建的片段（然后从水晶调用）

从 tableA 中选择 min(coalesce(cast(deposit_no as int),0)) 作为 min_deposit

从 tableA 中选择 max(coalesce(cast(deposit_no as int),0)) 作为 max_deposit

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-27T04:26:42.613

在搜索相同的东西时遇到了这个问题，并想添加到 SqlACID 的答案中。

您可以在公式编辑器中执行此操作。

```
'XX'+totext(Minimum ({YY.Num}), 0, '') + '-XX'+totext(Maximum ({YY.Num}), 0, '') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T02:58:01.207

使用汇总函数为 deposit_no 字段的最小值和最大值创建公式字段，然后将公式字段拖到页眉

# sql - 为 varchar 或 varbinary 选择较大的 MAX 值的缺点

> ID：475049
> 
> 赞同：4
> 
> 时间：2009-01-23T23:24:26.193
> 
> 标签：sql, sql-server, types, varchar

在创建 varchar 或 varbinary 列时为 max 选择较大值有什么缺点？

我正在使用 MS SQL，但我认为这也与其他数据库相关。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T23:34:36.080

这取决于在特定列中存储大量数据是否合理。

如果您声明一个永远不会正确存储大量数据的列（即员工名字作为 VARCHAR(1000)），您最终会遇到各种问题

1.  许多（如果不是大多数）客户端 API（即 ODBC 驱动程序、JDBC 驱动程序等）在客户端上分配足够大的内存缓冲区以存储特定列的最大大小。因此，即使数据库只需要存储实际数据，您也可能会大大增加客户端应用程序使用的内存量。
2.  您失去了从表定义中驱动数据验证规则（或传递有关数据的信息）的能力。如果数据库允许 1000 个字符的名字，那么每个与数据库交互的应用程序最终可能都会有自己的规则来决定员工姓名的大小。如果没有通过在所有应用程序和表之间放置存储过程层来缓解这种情况，这通常会导致各种应用程序具有各种规则。
3.  墨菲定律指出，如果您允许 1000 个字符，那么最终会有人在列中存储 1000 个字符，或者至少是一个大到足以导致一个或多个应用程序出错的值（即没有人检查每个应用程序的员工姓名字段是否可以显示1000 个字符）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-23T23:48:22.587

取决于关系数据库管理系统。IIRC，MySql 为 varchars > 255 个字符分配 2 字节开销（以跟踪 varchar 长度）。MSSQL <= 2000 将允许您分配大于 8060 字节的行大小，但如果您尝试插入或更新实际超过 8060 字节的行，则会失败。SQL 2005[1] 允许插入，但会为溢出分配一个新页面并留下一个指针。显然，这会影响性能。

[1] varchar(max) 有点特殊，但如果字段长度 > 8000 或行 > 8060，也会分配溢出页。这是 MSSQL 的默认值，行为会随着大类型而改变在数据行选项中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T23:34:04.693

如果大量数据以某种方式进入（例如来自外部接口）并且您的应用程序并非旨在处理它，您可能会增加破坏您的应用程序的风险。

作为一个好的设计，您应该始终将字段的大小限制为实际值。

# html - 打印时不要重复 TFOOT

> ID：475063
> 
> 赞同：16
> 
> 时间：2009-01-23T23:32:32.697
> 
> 标签：html, css, firefox

延伸到多个打印页面的表格将在 Firefox 中重新打印其 thead 和 tfoot 部分。这通常很好，但是，有没有办法用 CSS 关闭这种行为？

[更新] 感谢您到目前为止的回复。我想在表格底部有一次 tfoot 打印，但不是在每页的末尾。再次感谢。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-11-19T18:46:36.397

我找到了另一种方法来做到这一点：

```
<tfoot style="display: table-row-group">
</tfoot> 
```

这适用于 Firefox，但当然，众所周知，显示属性不是跨浏览器兼容的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-24T00:36:32.647

简单的解决方案：不要使用`tfoot`. 将页脚行放在`tbody`. 现在他们将打印在表格的末尾，而不是其他地方。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T23:40:27.377

```
<link rel='stylesheet' src='something.css' media='print'> 
```

在该样式表中，隐藏（显示：无）或对 thead 和 tfoot 元素做任何你想做的事情。如果表格是动态生成的，您可以使用 javascript 检查其大小并在该打印样式表中应用适当的类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T23:39:13.370

我相信这是客户的偏好 - 其他人建议使用 javascript 解决方案来生成可打印页面，特别是如果您的表格页脚有总计等。

# python - 在 Django 中声明 DB 字段时，verbose_name 参数中的非 ascii 字符串

> ID：475073
> 
> 赞同：2
> 
> 时间：2009-01-23T23:36:31.863
> 
> 标签：python, django, unicode

我声明：

```
#This file is using encoding:utf-8
...
class Buddy(models.Model):
    name=models.CharField('ФИО',max_length=200)
    ... 
```

...在models.py中。manage.py syncdb 工作顺利。但是，当我进入管理界面并尝试添加一个新好友时，我发现了一个 DjangoUnicodeDecodeError，它说：“'utf8' 编解码器无法解码位置 0-1 中的字节：无效数据。你传入了 '\xd4\xc8\ xce' (<type 'str'<r;)"。

我正在使用 sqlite3，因此所有字符串都存储为以 utf8 编码的字节字符串。Django的编码也是utf8。看过django关于这个主题的文档，不知道。

UPD：最终我发现了问题所在。原来是我用 ANSI 编码保存了我的源代码。

解决方案：我将源代码保存在 UTF-8 中，效果非常好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-24T00:37:48.057

首先，我会将您的描述明确定义为 Unicode 字符串：

```
class Buddy(models.Model):
    name=models.CharField(u'ФИО',max_len) 
```

注意中的“u” `u'ФИО'`。

其次，`__unicode__()`您的模型上是否定义了功能？如果是这样，请确保它返回一个 Unicode 字符串。当管理界面尝试访问模型的 unicode 表示时，您很可能会收到此错误，而不是在将模型添加到数据库时。如果您从 中返回非 unicode 字符串`__unicode__()`，则可能会导致此问题。

# regex - RegEx 解析或验证 Base64 数据

> ID：475074
> 
> 赞同：120
> 
> 时间：2009-01-23T23:36:31.863
> 
> 标签：regex, base64, standards-compliance, rfc

是否可以使用正则表达式来验证或清理 Base64 数据？这是一个简单的问题，但驱动这个问题的因素是使它变得困难的因素。

我有一个不能完全依赖输入数据来遵循 RFC 规范的 Base64 解码器。因此，我面临的问题可能是 Base64 数据可能无法分解为 78 的问题（我认为是 78，我必须仔细检查 RFC，所以如果确切数字错误，请不要叮我）字符行，或者行不能以 CRLF 结尾；因为它可能只有一个 CR 或 LF，或者两者都没有。

所以，我在解析这种格式的 Base64 数据时度过了一段地狱般的时光。因此，以下示例无法可靠解码。为简洁起见，我将只显示部分 MIME 标头。

```
Content-Transfer-Encoding: base64

VGhpcyBpcyBzaW1wbGUgQVNDSUkgQmFzZTY0IGZvciBTdGFja092ZXJmbG93IGV4YW1wbGUu 
```

好的，所以解析没有问题，这正是我们所期望的结果。在 99% 的情况下，使用任何代码至少验证缓冲区中的每个字符都是有效的 base64 字符，都可以完美运行。但是，下一个示例将扳手投入其中。

```
Content-Transfer-Encoding: base64

http://www.stackoverflow.com
VGhpcyBpcyBzaW1wbGUgQVNDSUkgQmFzZTY0IGZvciBTdGFja092ZXJmbG93IGV4YW1wbGUu 
```

这是我在一些病毒和其他试图利用某些邮件阅读器希望不惜一切代价解析 mime 的东西中看到的 Base64 编码版本，而不是那些严格按照书本，或者更确切地说是 RFC 的东西；如果你愿意的话。

我的 Base64 解码器将第二个示例解码为以下数据流。请记住，原始流都是 ASCII 数据！

```
[0x]86DB69FFFC30C2CB5A724A2F7AB7E5A307289951A1A5CC81A5CC81CDA5B5C1B19481054D0D
2524810985CD94D8D08199BDC8814DD1858DAD3DD995C999B1BDDC8195E1B585C1B194B8 
```

任何人有一个很好的方法来一次解决这两个问题？我不确定这是否可能，除了对应用了不同规则的数据进行两次转换并比较结果之外。但是，如果您采用这种方法，您信任哪个输出？似乎 ASCII 启发式方法是*最好*的解决方案，但是对于像病毒扫描程序这样复杂的东西，这段代码实际上参与其中，会增加多少代码、执行时间和复杂性？您将如何训练启发式引擎以了解什么是可接受的 Base64，什么不是？

* * *

## **更新：**

对于这个问题继续获得的视图数量，我决定发布我在 C# 应用程序中使用了 3 年的简单正则表达式，其中包含数十万个事务。老实说，我最喜欢[Gumbo](https://stackoverflow.com/users/53114/gumbo/ "秋葵")给出的答案，这就是我选择它作为选定答案的原因。但是对于任何使用 C# 并且正在寻找一种非常快速的方法来至少检测字符串或字节 [] 是否包含有效的 Base64 数据的人，我发现以下内容对我来说非常有效。

```
[^-A-Za-z0-9+/=]|=[^=]|={3,}$ 
```

是的，这只是针对 Base64 数据的*字符串*，而不是格式正确的[RFC1341](https://www.rfc-editor.org/rfc/rfc1341 "RFC1341")消息。因此，如果您正在处理这种类型的数据，请在尝试使用上述 RegEx 之前考虑到这一点。如果您出于其他目的（URL、文件名、XML 编码等）处理 Base16、Base32、Radix 甚至 Base64，那么*强烈*建议您阅读[Gumbo在他的回答中提到的](https://stackoverflow.com/users/53114/gumbo/ "秋葵")[RFC4648](https://www.rfc-editor.org/rfc/rfc4648 "RFC4648")，因为您需要做好在尝试使用此问题/答案集中的建议之前，请了解实现使用的字符集和终止符。

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2009-01-24T00:40:53.653

来自[RFC 4648](http://www.ietf.org/rfc/rfc4648.txt)：

> 数据的基本编码在许多情况下用于在可能由于遗留原因仅限于 US-ASCII 数据的环境中存储或传输数据。

因此，是否应将数据视为危险数据取决于编码数据的使用目的。

但是，如果您只是在寻找一个正则表达式来匹配 Base64 编码的单词，您可以使用以下内容：

```
^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$ 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2011-05-04T14:33:26.517

```
^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$ 
```

这个很好，但会匹配一个空字符串

这个不匹配空字符串：

```
^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$ 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-10-21T15:50:43.000

到目前为止提供的答案未能检查 Base64 字符串是否将所有填充位设置为 0，因为它是 Base64 的规范表示（这在某些环境中很重要，请参阅[https://www.rfc-editor。 org/rfc/rfc4648#section-3.5](https://www.rfc-editor.org/rfc/rfc4648#section-3.5)），因此，它们允许对同一二进制字符串使用不同编码的*别名。*这可能是某些应用程序中的安全问题。

这是验证给定字符串不仅是有效的 base64 字符串，而且是二进制数据的规范 base64 字符串的正则表达式：

```
^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/][AQgw]==|[A-Za-z0-9+/]{2}[AEIMQUYcgkosw048]=)?$ 
```

引用的 RFC 认为空字符串是有效的（参见[https://www.rfc-editor.org/rfc/rfc4648#section-10](https://www.rfc-editor.org/rfc/rfc4648#section-10)），因此上述正则表达式也是如此。

base64url 的等效正则表达式（再次参考上面的 RFC）是：

```
^(?:[A-Za-z0-9_-]{4})*(?:[A-Za-z0-9_-][AQgw]==|[A-Za-z0-9_-]{2}[AEIMQUYcgkosw048]=)?$ 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-24T01:01:49.850

" **:** " 和 " **.** " 都不会出现在有效的 Base64 中，所以我认为你可以明确地扔掉这`http://www.stackoverflow.com`条线。在 Perl 中，比如说，类似

```
my $sanitized_str = join q{}, grep {!/[^A-Za-z0-9+\/=]/} split /\n/, $str;

say decode_base64($sanitized_str); 
```

可能是你想要的。它产生

*这是 StackOverflow 示例的简单 ASCII Base64。*

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-05-06T07:46:51.357

要验证**base64 图像**，我们可以使用这个正则表达式

> /^data:image/(?:gif|png|jpeg|bmp|webp)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/] )+={0,2}

```
 private validBase64Image(base64Image: string): boolean {
    const regex = /^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/;
    return base64Image && regex.test(base64Image);
  } 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2021-08-27T18:32:26.663

检查 RFC-4648 合规性强制规范编码的最短正则表达式（即所有填充位设置为 0）：

```
^(?=(.{4})*$)[A-Za-z0-9+/]*([AQgw]==|[AEIMQUYcgkosw048]=)?$ 
```

实际上，这是[这个](https://stackoverflow.com/a/63758783/9868257)和[那个](https://stackoverflow.com/a/64467300/9868257)答案的混合。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-03-26T09:33:03.747

到目前为止我能找到的最好的正则表达式在这里 [https://www.npmjs.com/package/base64-regex](https://www.npmjs.com/package/base64-regex)

当前版本中的内容如下：

```
module.exports = function (opts) {
  opts = opts || {};
  var regex = '(?:[A-Za-z0-9+\/]{4}\\n?)*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)';

  return opts.exact ? new RegExp('(?:^' + regex + '$)') :
                    new RegExp('(?:^|\\s)' + regex, 'g');
}; 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2020-09-05T21:44:29.137

这是一个替代的正则表达式：

```
^(?=(.{4})*$)[A-Za-z0-9+/]*={0,2}$ 
```

它满足以下条件：

*   字符串长度必须是四的倍数 -`(?=^(.{4})*$)`
*   内容必须是字母数字字符或 + 或 / -`[A-Za-z0-9+/]*`
*   它的末尾最多可以有两个填充 (=) 字符 -`={0,2}`
*   它接受空字符串

# wcf - WCF 服务的负载平衡错误 - NLB

> ID：475076
> 
> 赞同：5
> 
> 时间：2009-01-23T23:37:27.837
> 
> 标签：wcf, iis-6, windows-server-2003, load-balancing, nlb

**更新 3：**
我创建了一个 Visual Studio 2008 测试项目并尝试创建对共享站点 WCF 服务引用的服务引用并收到以下错误：

> 下载“ [http://apps.mydomain/MyService.svc](http://apps.mydomain/MyService.svc) ”时出错。请求失败，HTTP 状态为 400：错误请求。元数据包含无法解析的引用：“ [http://apps.mydomain/MyService.svc](http://apps.mydomain/MyService.svc) ”。内容类型应用程序/soap+xml；[服务http://apps.mydomain/MyService.svc](http://apps.mydomain/MyService.svc)不支持 charset=utf-8 '。客户端和服务绑定可能不匹配。远程服务器返回错误：（415）无法处理消息，因为内容类型'application/soap+xml; charset=utf-8' 不是预期的类型 'text/xml; charset=utf-8'.. 如果在当前解决方案中定义了服务，请尝试构建解决方案并再次添加服务引用。

**更新 2：**
@Nick - 我尝试了您的建议，即使用每个服务器的完全限定路径明确设置每个端点的地址，但我仍然得到相同的结果。

此外，当我尝试使用共享站点 URL 设置 listenUri 属性时，我收到 400 bad request 错误而不是 404 错误。

**更新经过一些额外的研究，** [http://apps1.mydomain](http://apps1.mydomain)和[http://apps2.mydomain](http://apps2.mydomain)
之间存在一些 IIS 配置设置冲突，并且能够克服“服务器应用程序不可用”错误。

现在，当我尝试浏览到共享站点 ( [http://apps.mydomain](http://apps.mydomain) ) 时出现 404 错误，但我能够浏览到[http://apps1.mydomain](http://apps1.mydomain)和[http://apps2.mydomain](http://apps2.mydomain)服务参考。

**原始问题**

我的公司使用[Microsoft NLB](http://technet.microsoft.com/en-us/library/bb742455.aspx)来平衡 IIS 服务器之间的流量。我最近在每台 IIS 6 Windows Server 2003 Standard Edition SP1 服务器上部署了 WCF 服务。当我尝试使用 IE 7 浏览到共享域名时收到以下错误：

> 服务器应用程序不可用 您尝试在此 Web 服务器上访问的 Web 应用程序当前不可用。请在您的网络浏览器中点击“刷新”按钮以重试您的请求。
> 
> 管理员注意：可在 Web 服务器的应用程序事件日志中找到详细说明此特定请求失败原因的错误消息。请查看此日志条目以了解导致此错误发生的原因。

消费者将指向[http://apps.mydomain](http://apps.mydomain)以使用服务，但虚拟域映射到[http://apps1.mydomain](http://apps1.mydomain)或[http://apps2.mydomain](http://apps2.mydomain)。如果我浏览到每台服务器上的服务，我不会收到该错误。

该服务当前使用匿名的 basicHttpBinding。

有没有其他人遇到过这个问题？

**历史**

在此错误开始发生之前，当我浏览所有三个域名（[http://apps.mydomain](http://apps.mydomain)、[http://apps1.mydomain](http://apps1.mydomain)、[http://apps2.mydomain](http://apps2.mydomain)）时收到以下错误：

> 这个集合已经包含一个带有 http 方案的地址。此集合中的每个方案最多可以有一个地址。

我使用[ServiceHostFactory](http://msdn.microsoft.com/en-us/library/system.servicemodel.activation.servicehostfactory.aspx)类来自定义我的 .svc 文件以指定自定义服务工厂。然后我通过从 ServiceHostFactory 继承并根据需要覆盖来创建我们的自定义工厂。

```
public class MyFactory : ServiceHostFactory
{
    protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
    {
        return new ServiceHost(serviceType, baseAddresses[0]);
    }
}

<%@ ServiceHost Language="C#" Factory="MyFactory" Debug="true" Service="MyService" CodeBehind="~/App_Code/MyService.cs" %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T20:45:23.890

After some experimenting with different configurations for my WCF service and consuming application. I created a service reference to one of the working service references ([http://apps1.mydomain](http://apps1.mydomain) or [http://apps2.mydomain](http://apps2.mydomain)) in the consuming application. Then I changed the endpoint reference in the client configuration to point to the shared site WCF address ([http://apps.mydomain](http://apps.mydomain)) and I was able to consume and use the service.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T22:55:05.320

I've had an issue before with WCF and load balancing where the servers had multiple Network cards with different IP addresses and WCF would just pic the first IP address it found. We had to explicitly set the IP address on each server's Service Definition so WCF would bind to the right one.

# performance - 如何估计以太网性能？

> ID：475078
> 
> 赞同：3
> 
> 时间：2009-01-23T23:37:51.033
> 
> 标签：performance, networking

我需要考虑 100 mbps 以太网的性能限制（包括在同一子网上最多有 100 个端点的场景），我想知道如何最好地估计网络容量。这有什么经验法则吗？

我问的原因是我正在对性能限制进行一些粗略的计算，所以它不需要非常准确。我只是以前没有经历过这个练习，并希望从那些有过的人那里获得一些见解。[Mark Brackett 的回答](https://stackoverflow.com/questions/475078/how-can-i-estimate-ethernet-performance#475135)（截至 1/26）与我正在寻找的内容一致。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T00:01:29.287

如果您正在使用交换机（老实说，现在谁不是）-那么我发现 80% 的容量是一个合理的估计。通常，由于 TCP 开销，它实际上大约是 90% - 但 80% 占偶尔重传。

如果它是一个单一的冲突域（集线器），那么在这 100 个节点上的活动可能会达到 30% 左右。但是，它会根据产生的流量而变化很大。如今，任何将 100 个节点放在一张 CD 中的人无疑都会被枪杀——所以我认为你不会真正遇到那些 IRL。

编辑：请注意，这些数字适用于相对健康的网络——通常被定义为正常工作的网络。众所周知，过度广播或其他异常流量模式会使网络瘫痪。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T06:32:29.263

## [使用广域网](http://wanem.sourceforge.net/)

> WANem 是一个广域网模拟器，旨在在 LAN 环境中的应用程序开发/测试期间提供广域网/互联网的真实体验。

您可以使用它模拟任何网络场景，然后使用它测试应用程序的行为。它是开源的，可通过 sourceforge 获得。

**[链接：WANem - 广域网模拟器](http://wanem.sourceforge.net/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T23:46:10.673

[Opnet](http://www.opnet.com/)创建用于模拟网络性能的软件。我曾经使用过 Opnet IT Guru 学术版。也许这个应用程序或来自 opnet 的其他一些软件可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T00:01:06.400

100 个端点不应该是一个问题。如果网络配置正确（没什么特别的），唯一的问题是带宽。快速以太网（100 mbps）应该能够每秒传输近 10Mb（字节）。它能够将其传输给一个客户或多个客户。如果您使用集线器而不是交换机。如果您使用的是半双工而不是全双工。然后你应该改变它（这是经验法则）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T20:53:59.563

根据您的帖子标题“我如何估计以太网性能”，请参阅此 wiki 链接；[http://en.wikipedia.org/wiki/Ethernet_frame#Maximum_throughput](http://en.wikipedia.org/wiki/Ethernet_frame#Maximum_throughput)

# c++ - 创建网络驱动程序

> ID：475081
> 
> 赞同：5
> 
> 时间：2009-01-23T23:39:09.847
> 
> 标签：c++, windows, hal

在编写硬件驱动程序时，我几乎是个白痴，但我在 C/C++ 方面相当不错。

我有一个有趣的项目，我想尝试将设备用作网络系绳代理。

我想做的是创建一个似乎是 Windows 的网络驱动程序的驱动程序，但实际上是通过连接到另一个设备的 USB 端口发送/接收。

我很清楚需要实施什么，但我不知道从哪里开始寻找研究信息。

任何指针？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T00:22:11.303

获取[DDK](http://www.microsoft.com/whdc/devtools/ddk/default.mspx)它有很多文档和示例驱动程序可供开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T23:43:47.793

[codeproject 的这篇](http://www.codeproject.com/KB/system/WDM_Driver_development.aspx)文章是关于创建 WDM 驱动程序的教程。我不能保证它的正确性，但快速浏览显示了很多信息。这应该是一个很好的研究起点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-24T00:38:45.093

我还没有彻底完成它，但这篇[文章](http://www.codeproject.com/KB/system/driverdev.aspx)似乎是对 Windows 中的编程设备驱动程序的一个很好的介绍。

编辑：阅读它。它很好地介绍了设备驱动程序，简要介绍了相关概念和常见的陷阱以及良好的外部链接。如果您对驱动程序一无所知，值得一读。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-10T01:23:43.570

除了 DDK 文档之外，通常推荐的书是 Oney 的*Microsoft Windows 驱动程序模型*(WDM) 编程。尽管现在您可能只能为较新的*Windows 驱动程序基础*(WDF) 进行开发，这大大减少了使您的驱动程序 PnP 和电源感知的工作量。

那么[OSR](http://www.osronline.com/)的资源非常棒，无论是初学者还是高级讨论，包括论文、教程和邮件列表。OSR 还提供演示硬件套件，可帮助您开始为真实设备开发驱动程序。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-24T04:06:18.137

避免codeproject（根本不专业）下载带有几十个示例的MS DDK（专业）

# frameworks - 网络框架

> ID：475090
> 
> 赞同：2
> 
> 时间：2009-01-23T23:42:40.743
> 
> 标签：frameworks

Ruby On Rails、Django 或 ASP.NET MVC。

哪个更好？优缺点都有什么？

只是好奇你的意见，请不要火焰。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-24T00:22:32.037

**免责声明：这些只是我的观点，不是事实**

取决于您的需求。

**[导轨 +](http://onstartups.com/home/tabid/3339/bid/160/Reasons-Why-Your-Startup-Should-Use-Ruby-On-Rails-RoR.aspx)**

*   大社区
*   快速启动和运行
*   托管便宜

**导轨 -**

*   速度较慢，如果您想扩展它，将需要一些“帮助”（这对大多数人来说几乎不是问题）
*   更难卖给老板

**[ASP.NET MVC +](http://www.cnblogs.com/xioxu/archive/2008/12/16/1356377.html)**

*   易卖
*   菲尔哈克（需要我多说）
*   将被广泛采用（IMO）
*   多多支持

**ASP.NET MVC -**

*   更贵（托管）
*   仍处于测试阶段

**[姜戈 +](http://www.porcheron.info/why-django/)**

*   Python 是谷歌选择的语言之一，因此值得一看
*   [运行在谷歌的云环境](http://code.google.com/appengine/articles/django.html) （[应用引擎](http://code.google.com/appengine/)）
*   动态 - 易于使用 廉价运行

**姜戈——**

*   无函数重载(v2.5)
*   再次比编译语言慢
*   不像其他一些语言那么大的社区（IMO）

*我包括了其他人对所有 3 个选项的积极选项的一些链接....*

语言\技术的选择成为网站、项目或业务的失败是非常非常罕见的...... IMO

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T09:20:35.600

IMHO that question isn't really the right one. Given that you'll be writing all your business logic in the language of your framework, I'd say decide on a language first. All the frameworks you listed are for different languages.

Pick a language you like (or that fits the job best) and *then* research what frameworks are available for it.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T23:48:53.523

Ruby on Rails。

Ruby 是一种非常棒的动态语言，可以适应编程挑战。与我交谈过的大多数人都发现开始使用新的 Rails 应用程序非常容易。[Railscasts](http://railscasts.com/)作为教程也非常棒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T09:02:49.270

[Django](http://djangoproject.com)是一个非常好的框架。非常适合做“简单”的应用程序，尽管我是根据我使用它的经验说的，这仅限于做大多数教程所涵盖的“简单”事情。像博客应用程序。

I don't have any experience with Ruby, or ASP.NET, so I can't really chime in on their respective well-known frameworks.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-25T16:46:49.217

The right answer is this:

**the one that you like**

NO ONE can argue with me about this. No matter if a language is faster or even you get more money for what you do, because if you don't like what you do, will be a real pain in the... (guess)

# java - 何时编写静态方法与实例方法是否有经验法则？

> ID：475097
> 
> 赞同：7
> 
> 时间：2009-01-23T23:46:22.123
> 
> 标签：java, oop, class-design

我正在学习 Java（和 OOP），尽管它可能与我现在所处的位置无关，但我想知道 SO 是否可以分享一些常见的陷阱或良好的设计实践。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-24T00:13:39.417

要记住的一件重要事情是静态方法不能被子类覆盖。代码中对静态方法的引用本质上将其与该实现联系在一起。使用实例方法时，行为可以根据实例的类型而变化。您可以利用多态性。静态方法更适合于行为一成不变的功利型操作。例如 base 64 编码或计算校验和。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-24T00:46:42.407

我认为任何答案都没有触及 OO 的核心，即何时选择其中一个。当然，当您需要处理实例成员时使用实例方法，但您可以将所有成员设为公开，然后编写一个静态方法，将类的实例作为参数。你好ç。

您需要考虑您正在设计的对象响应的**消息。**这些将永远是您的实例方法。如果你以这种方式考虑你的对象，[你几乎永远不会有静态方法](http://misko.hevery.com/2008/12/15/static-methods-are-death-to-testability/)。静态成员在某些情况下是可以的。

想到的值得注意的例外是工厂方法和单例（谨慎使用）模式。当你想写一个“助手”类时要小心，因为从那里开始，它是进入过程编程的一个滑坡。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-24T00:43:41.120

如果一个方法的实现可以完全用你的类的公共接口（没有向下转换）来表达，那么它可能是静态“实用程序”方法的一个很好的候选者。这允许您维护一个最小的接口，同时仍然提供代码客户端可能经常使用的便利方法。正如[Scott Meyers 解释](http://www.ddj.com/cpp/184401197)的那样，这种方法通过最大限度地减少因更改类的内部实现而影响的代码量来鼓励封装。[这是 Herb Sutter 的另一篇有趣的文章](http://www.gotw.ca/gotw/084.htm)，他将 std::basic_string 分解，决定哪些方法应该是成员，哪些不应该。

在像 Java 或 C++ 这样的语言中，我承认静态方法会使代码不那么优雅，因此仍然需要权衡。在 C# 中，扩展方法可以为您提供两全其美的方法。

如果由于某种原因该操作需要被子类覆盖，那么它当然必须是实例方法，在这种情况下，您需要考虑设计继承类的所有因素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T23:54:48.253

我的经验法则是：如果该方法执行与类的特定实例相关的任何事情，无论它是否需要使用类实例变量。如果您可以考虑可能需要使用某个方法而不必引用类的实例的情况，那么该方法绝对应该是静态的（类）。如果此方法在某些情况下也碰巧需要使用实例变量，那么最好创建一个单独的实例方法来调用静态方法并传递实例变量。在性能方面，我相信差异可以忽略不计（至少在 .NET 中，尽管我认为 Java 会非常相似）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T00:21:56.373

如果您保留对象的状态（值）并且该方法用于访问或修改状态，那么您应该使用实例方法。

即使该方法不会改变状态（实用函数），我也建议您使用实例方法。主要是因为这样你可以有一个执行不同操作的子类。

其余的你可以使用静态方法。

:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-23T23:53:27.400

该线程看起来很相关：[方法可以设为静态，但应该这样做吗？](https://stackoverflow.com/questions/169378/c-method-can-be-made-static-but-should-it)C# 和 Java 之间的差异不会影响其相关性（我认为）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-24T00:32:33.293

您的默认选择应该是实例方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-24T00:34:45.223

如果它使用实例变量，则它必须是实例方法。

如果没有，这取决于您，但如果您发现自己有很多静态方法和/或静态非最终变量，您可能希望将所有静态内容提取到一个新的类实例中。（一堆静态方法和成员是一个单例，但真的很烦人，拥有一个真正的单例对象会更好——一个常规对象恰好是其中之一，最好的！）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-24T00:49:48.627

基本上，经验法则是它是否使用特定于对象、实例的任何数据。所以 Math.max 是静态的，但 BigInteger.bitCount() 是实例。显然，随着您的域模型变得更加复杂，并且存在边界情况，但总体思路很简单。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-24T01:00:54.097

我会默认使用实例方法。优点是可以在子类中覆盖行为，或者如果您针对接口进行编码，则可以使用协作者的替代实现。这对于测试代码的灵活性非常有用。

静态引用被嵌入到您的实现中并且无法更改。我发现 static 对于短实用程序方法很有用。如果您的静态方法的内容非常大，您可能需要考虑将职责分解为一个或多个单独的对象，并让这些对象作为对象实例与客户端代码协作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-24T07:07:33.420

恕我直言，如果您可以将其设为静态方法（无需更改其结构），则将其设为静态方法。它更快，更简单。

如果您知道要覆盖该方法，我建议您在实际执行此操作的地方编写一个单元测试，因此不再适合将其设为静态。如果这听起来太辛苦了，那就不要让它成为一个实例方法。

通常，您不应该在您想象有一天使用时立即添加功能（那是疯狂的所在），您应该只添加您知道您实际需要的功能。

对于更长的解释......

[http://en.wikipedia.org/wiki/You_Ain%27t_Gonna_Need_It](http://en.wikipedia.org/wiki/You_Ain%27t_Gonna_Need_It)

[http://c2.com/xp/YouArentGonnaNeedIt.html](http://c2.com/xp/YouArentGonnaNeedIt.html)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-24T12:14:06.437

静态方法的问题在于，当您与实现耦合时，您正在破坏核心的面向对象原则之一。您希望支持开闭原则并让您的类实现一个描述依赖关系的接口（在行为抽象意义上），然后让您的类依赖于该接口。在那一点之后更容易扩展。..

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-09-11T23:41:52.337

我的静态方法总是以下之一：

1.  评估仅对该类有用的公式的私有“助手”方法。
2.  工厂方法（`Foo.getInstance()`等）
3.  在一个最终的“实用程序”类中，有一个私有构造函数并且除了公共静态方法之外什么都不包含（例如`com.google.common.collect.Maps`）

我不会仅仅因为它不引用任何实例变量而将方法设为静态。

# sql-server - RTMed 的 SQL Server 2008 Web 版的内部版本号是多少？

> ID：475102
> 
> 赞同：0
> 
> 时间：2009-01-23T23:48:10.717
> 
> 标签：sql-server

我的标题是完整的问题：RTMed 的 SQL Server 2008 Web 版的内部版本号是多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T23:49:51.197

```
SELECT @@VERSION

Microsoft SQL Server 2008 (RTM) - 10.0.1600.22 (X64) 
```

# model-view-controller - MVC：数据模型和视图模型

> ID：475129
> 
> 赞同：49
> 
> 时间：2009-01-24T00:00:10.083
> 
> 标签：model-view-controller, model, separation-of-concerns

我过去读过一些关于模型的 MVC 建议，指出您不应该为域和视图重用相同的模型对象；但我找不到任何愿意讨论*为什么*这很糟糕的人。

我认为创建两个单独的模型——一个用于域，一个用于视图——然后在它们之间进行映射会产生很多重复，加上繁琐的映射代码（其中一些可能会被[AutoMapper](http://www.lostechies.com/blogs/jimmy_bogard/archive/2009/01/22/automapper-the-object-object-mapper.aspx)之类的东西缓解），这很可能容易出错。

是什么让为这两个问题建立一个单独的模型值得重复和映射代码的麻烦？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-01-24T01:23:12.583

两个模型的核心是关注点分离。我希望我的视图可以使用单个模型。我希望我的领域模型能够代表我与领域专家建立的概念模型。ViewModel 通常有技术限制。域模型是关于 POCO 的，不受显示（视图）或持久化数据（在数据库中或其他地方）的技术约束的约束。

假设我在屏幕上显示了三个实体。这是否意味着我需要强制三者之间建立关系？或者只是创建一个包含所有三个项目的 ViewModel 组件对象。使用单独的 ViewModel，视图关注点与我的域分离。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-24T01:42:53.560

为什么？因为视图不应该有使用模型对象的能力！

想象一下，您将项目传递给网页设计师来做视图层。突然间，他/她有能力通过模型层来处理应用程序的数据。这不好。

所以总是只传递视图需要的数据，而不是带有方法的对象。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-24T00:46:39.460

JP Boodhoo 的文章[Screen Bound DTO](http://codebetter.com/blogs/jean-paul_boodhoo/archive/2007/09/27/screen-bound-dto-s.aspx)将帮助您了解设计优势。

还有一个我写过的[安全好处。](http://geekswithblogs.net/liammclennan/archive/2009/01/19/128798.aspx)

拥有一个表示模型可以简化您的视图。这一点尤其重要，因为视图通常很难测试。通过拥有一个表示模型，您可以将大量工作移出视图并进入域->表示模型。诸如格式化、处理空值和展平对象图之类的事情。

我同意额外的映射是一种痛苦，但我认为您可能需要在您的特定环境中尝试这两种方法，看看哪种方法最适合您。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-24T13:49:56.633

甚至还有更明显的问题，包括视图模型的特殊格式化能力和空值安全性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T00:38:00.337

我想这个想法是您的域模型可能会扩展到其他实现，而不仅仅是您的 MVC 应用程序，这会破坏关注点分离原则。如果您的视图模型是您的域模型，那么您的域模型有两个更改原因：域更改要求和视图要求更改。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-24T15:02:19.030

似乎我也有重复的规则。

IE。UI 上的客户端对象验证，然后映射到必须验证的域对象。

然而，我倾向于做的是映射我的域对象集以创建模型 - 即。一个显示客户信息、库存信息等的网页……我的模型变成了一个包含 Customer 对象和 Stock 对象的结构。

公司页面模型

public Customer Customer{get;} public Stock Stock {get;}

然后在我的 mvc 项目 ViewData.Model.Customer.Name ViewData.Model.Stock.CurrentStocks

分离“似乎”需要更多的工作，但后来，最好有这种 UI/域模型的划分......有点像编写测试:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-09T03:15:08.517

我终于喝完了酷助手，我确实喜欢能够用显示说明标记我的视图模型，并让所有这些都自动连接起来。

我现在需要的是某种来自 poco 实体的视图模型的自动生成器。我总是将一些字符串设置为 int 并且我要花很长时间才能找到它。除非您喜欢痛苦，否则不要考虑在没有自动映射器的情况下执行此操作。

# c# - 值得学习的开源项目

> ID：475145
> 
> 赞同：20
> 
> 时间：2009-01-24T00:06:21.583
> 
> 标签：c#, open-source

我经常读到继续学习如何编程的最好方法之一就是在野外研究伟大的开源项目。可以在某个地方推荐一个他们从中学到很多东西的好的开源 C# 项目。我已经编码了几年，Windows 和 Web 应用程序，非常标准的东西，sql server，asp .net。我对提高构建良好架构的 n 层应用程序的技能特别感兴趣

谢谢，

布伦丹

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T03:05:03.847

你看过[Codeplex](http://www.codeplex.com/)吗？那里有超过 800 个开源 C# 项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T00:44:45.500

微软自己的[ASP.Net MVC 项目](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=18764)是开源的。它在他们自己的许可下，这可能对您可以实际使用代码执行的操作非常严格。但这是一个相当大的项目，而且看起来很有趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T00:19:13.900

在一般层面上，我发现标准库代码通常是值得学习的。阅读应用程序代码的源代码当然很有用。但是，将代码阅读为 STL 或[D 的 std.algorithm](http://digitalmars.com/d/2.0/phobos/std_algorithm.html)或类似的东西，会教您如何在更高层次上思考，并创建通用的、可重用的代码。相比之下，应用程序代码在样板文件上通常更临时和更重，因此没有教育意义。

对于您的具体情况，我会阅读您正在使用的库/框架的代码。知道这些东西是如何工作的，而不是把它们当作魔法，这本身就很有趣，它们是由顶级程序员编写的，而且每行的重要编程概念可能比大多数应用程序代码质量更高，更密集.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T00:56:43.870

媒体门户。有些很棒，有些很糟糕。但是，如果有什么你想做的，它就在某个地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T11:14:28.607

OpenJDK（Java 开发工具包的开源版本）怎么样？

[这是 OpenJDK 6](http://download.java.net/openjdk/jdk6/)

[这是 OpenJDK 7](http://download.java.net/openjdk/jdk7/)（计划在 2010 年左右发布）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T11:26:20.557

看看[NHibernate代码，他们的存储库在](http://www.hibernate.org/343.html)[这里](http://www.hibernate.org/6.html)很棒

# dll - 如何找出可执行文件将加载哪些 dll？

> ID：475148
> 
> 赞同：80
> 
> 时间：2009-01-24T00:07:13.877
> 
> 标签：dll, executable

如果我有一个 Windows 可执行文件，我如何找出它将加载哪些 dll？

我只是在谈论哪些将静态加载，而不是可能使用 LoadLibrary 之类的动态加载。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-01-24T01:55:27.463

[dumpbin](https://web.archive.org/web/20121114095715/http://support.microsoft.com/kb/177429)是 VC++ 自带的一个工具。

要查看程序将导入哪些 DLL：

*   打开 Visual Studio
*   菜单项工具 | Visual Studio 命令提示符
*   cd 到包含可执行文件的文件夹
*   垃圾箱/从属任何东西.exe

> ```
> Dump of file whatever.exe
> 
> File Type: EXECUTABLE IMAGE
> 
>   Image has the following dependencies:
> 
>     AIOUSB.DLL
>     sqlite3.dll
>     wxmsw293u_core_vc_custom.dll
>     wxbase293u_vc_custom.dll
>     KERNEL32.dll
>     ole32.dll
>     OLEAUT32.dll
>     MSVCP90.dll
>     MSVCR90.dll 
> ```

要查看它将导入哪些函数（和 DLL），请使用

```
C:\> dumpbin /imports whatever.exe 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-01-24T00:12:07.203

有一些实用程序可以为您执行此操作。

过去我使用过（我认为）VB 附带的 MS 工具（depends.exe）。：
[VS2010](https://web.archive.org/web/20111210021011/http://msdn.microsoft.com/en-us/library/8kche8ah.aspx) [VS2012](https://web.archive.org/web/20130110162057/http://msdn.microsoft.com/en-us/library/8kche8ah.aspx) [VS2013](https://web.archive.org/web/20141227031953/http://msdn.microsoft.com/en-us/library/8kche8ah.aspx) [VS2015](https://web.archive.org/web/20171228054548/https://msdn.microsoft.com/en-us/library/8kche8ah.aspx) [Current](https://docs.microsoft.com/en-us/cpp/windows/determining-which-dlls-to-redistribute?view=msvc-160)

还有这个： http:
[//dependencywalker.com/](http://dependencywalker.com/)

可能还有其他人。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2014-09-08T04:45:59.040

打开命令提示符，然后键入以下命令

**任务列表 /m /fi "imagename eq netbeans.exe"**

键入 netbeans.exe，无论您的 exe 文件名如何。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-01-24T00:12:36.783

[Dependency Walker](http://www.dependencywalker.com/)可以帮助您确定将加载哪个 .dll。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-03-12T08:30:46.340

只需转到命令提示符并键入`tasklist /m`，您将看到特定程序使用的 dll 文件列表。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-30T15:13:56.713

Microsoft .Net 的解决方案：

```
foreach (AssemblyName a in Assembly.ReflectionOnlyLoadFrom("SAMPLE.EXE").GetReferencedAssemblies()) 
{
    MessageBox.Show(a.Name); 
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-24T00:20:15.143

progfr 简单实用：[ [http://members.fortunecity.com/michaelmoser/tip11.htm]](http://members.fortunecity.com/michaelmoser/tip11.htm])

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-24T02:00:04.257

有一个名为 NDepend 的方便工具，它将为您提供所有 DLL 依赖项。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-01-28T12:41:34.867

[Dependencies - 一个开源的现代 Dependency Walker](https://github.com/lucasg/Dependencies)显示 Windows 可执行文件将加载哪些 DLL，并且它在现代 Windows 10 中运行良好。

它不如[Dependency Walker](http://www.dependencywalker.com/)强大，但后者可能会或可能不会在 Windows 10 中工作，因为它最后一次更新是在 2006 年。（较新版本的 Dependency Walker 与 Windows 10 的某些版本的 Windows Development Kit 捆绑在一起，但不是更多。）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-01-16T15:59:40.027

Process Explorer 随附 SysInternals Suite [https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite](https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite)

好处：允许探索已经运行的进程（我还没有找到将依赖walker附加到现有进程的方法）

# asp.net-mvc - WebForms 到 MVC 的转换

> ID：475149
> 
> 赞同：1
> 
> 时间：2009-01-24T00:08:30.783
> 
> 标签：asp.net-mvc, webforms

我有一个非常简单的网站（大约 8 页），只有一个包含任何重要代码隐藏的方式页面，我想尝试学习 MVC，将其用作测试。

最好从头开始一个新的 MVC Web 应用程序并将 HTML 剪切并粘贴进去，还是更容易对现有文件进行重组。

基本上，我在做什么？怎样才能让我的 Web 窗体应用程序进入 MVC 模型？我应该采取什么方法？创建默认的 MVC Web 应用程序并开始剪切和粘贴？添加适当的命名空间并学习自己设置 MVC 结构？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T01:21:56.707

与 tvanfosson 不同，我认为您实际上会通过尝试翻译现有应用程序来了解有关 MVC 的更多信息。您将了解要添加哪些程序集，您将了解如何关联正确的 http 处理程序，您将了解正确的 web.config 设置是什么，您将知道要从您的 Web 应用程序中删除哪些依赖项以获取它工作。

老实说，这样做会感觉更难，也会更令人沮丧，但在这个过程结束时，你会知道比从头开始一个新的要多得多。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T00:13:10.993

您需要从新项目中的项目模板开始。根据需要将您的标记转移到您的新视图中，尽管您更有可能只是将旧站点用作设计模板，而不是实际重用代码。您会发现 MVC 与 WebForms 有很大不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T03:54:59.173

我不认为对现有的 Web 窗体应用程序进行重组是最好的方法（甚至是可行的）。您一定会发现，Web 窗体和 MVC 之间的差异非常大。因此，从头开始（尽管您可以回收 html）很可能是更好的方法，也是尽可能多地了解 MVC 的最佳方式。

# .net - 定义实体框架 1:1 关联

> ID：475150
> 
> 赞同：12
> 
> 时间：2009-01-24T00:09:27.053
> 
> 标签：.net, visual-studio, entity-framework, ado.net

我正在尝试在实体框架模型中定义两个实体（一个映射到表，另一个映射到视图 - 使用 DefinedQuery）之间的 1:1 关联。当试图在设计器中为此定义映射时，它让我选择 (1) 表或视图来映射关联。我应该选择什么？我可以选择两个表中的任何一个，但随后我不得不从该表（或视图）中为关系的每一端选择一列。我希望能够从一个表中选择一列作为关联的一端，从另一个表中选择一列作为关联的另一端，但是没有办法做到这一点。

在这里，我选择映射到“DW_WF_ClaimInfo”视图，这迫使我从该视图中选择两列——关系的每一端各一列。

我还尝试在 XML 中手动定义映射，如下所示：

```
<AssociationSetMapping Name="Entity1Entity2" TypeName="ClaimsModel.Entity1Entity2"
     StoreEntitySet="Entity1">
  <EndProperty Name="Entity2">
    <ScalarProperty Name="DOCUMENT" ColumnName="DOCUMENT" />
  </EndProperty>
  <EndProperty Name="Entity1">
    <ScalarProperty Name="PK_DocumentId" ColumnName="PK_DocumentId" />
  </EndProperty>
</AssociationSetMapping> 
```

但这会给出：错误 2010：指定为此 MSL 的一部分的“文档”列在 MetadataWorkspace 中不存在。似乎它仍然希望两列都来自同一个表，这对我来说没有意义。

此外，如果我为每一端选择相同的键，例如：

```
<AssociationSetMapping Name="Entity1Entity2" TypeName="ClaimsModel.Entity1Entity2"
     StoreEntitySet="Entity1">
  <EndProperty Name="Entity2">
    <ScalarProperty Name="DOCUMENT" ColumnName="PK_DocumentId" />
  </EndProperty>
  <EndProperty Name="Entity1">
    <ScalarProperty Name="PK_DocumentId" ColumnName="PK_DocumentId" />
  </EndProperty>
</AssociationSetMapping> 
```

然后我得到：

```
Error 3021: Problem in Mapping Fragment starting at line 675: Each of the following
columns in table AssignedClaims is mapped to multiple conceptual side properties:
  AssignedClaims.PK_DocumentId is mapped to
    <AssignedClaimDW_WF_ClaimInfo.DW_WF_ClaimInfo.DOCUMENT,
    AssignedClaimDW_WF_ClaimInfo.AssignedClaim.PK_DocumentId> 
```

我没有得到什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T16:34:04.383

You have to select the table, that cotains the foreign key. The next step is to remove that foreign key from the entity, as it is already expressed using the relation you just created.

Example:

```
table A
-------
A_ID int
B_ID int

table B
-------
B_ID int 
```

In this case, you would select the table A in the designer, as it contains the foreign key. Also you'll need to remove B_ID from the A entity afterwards.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-06T02:18:47.250

简单来说，我做了以下事情：

1.  在列上使用主键 (PK) 创建表。
2.  在列上使用外键 (FK) 创建视图。或相反亦然。
3.  在 edmx Diagram Designer 中，创建了一个 Association 。
4.  编译代码。

在 XAML 元数据代码中，具有 PK 的父实体将显示子视图实体，可以关联以绑定项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-29T09:13:02.057

首先在数据库中创建一个外键，然后从数据库中创建关联或更新模型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-07T21:28:58.400

我同意这种设置方式似乎违反直觉。对于任何太慢（如我）无法获得 driAn 答案的人：根据下面的论坛帖子，我记得我们正在处理一个实体，而不是直接处理一个表。关联在**实体**上（可以为表建模，但不是必须的）。

[http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/2823634f-9dd1-4547-93b5-17bb8a882ac2/](http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/2823634f-9dd1-4547-93b5-17bb8a882ac2/)

实体框架将**PROPERTIES**关联到**TABLE COLUMNS**。这就是为什么我们必须删除**ENTITY**上的“外键” **PROPERTY**（注意：我们不是删除表列）。要在代码中引用该列，（使用**实体***建模*表 A 和表 B 的给定示例）您将编写如下内容：

 *****```
variable_A = tableAs.A_ID
variable_B = tableAs.tableBs.B_ID 
```

第二个任务是使用实体中定义的关联来获取数据。表 A 上没有名为“B_ID”的**属性。**

这一切都假设我理解正确:)。它现在至少对我来说是正确的。

：-担

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-16T18:34:48.313

我正在处理一个遗留应用程序，所以添加一个额外的主键对我来说不是一个选项。我必须做的是将它映射为 1:(0 或 1) 而不是 1:1 以使其工作。例如，如果我有两个表，分别是 Customer 和 CustomerDetails，它们都有一个名为 CustomerID 的主键。要创建关联，我必须将其设置为 1 个客户可以与（0 或 1）个 CustomerDetails 记录相关。每次插入客户时，请确保同时插入 CustomerDetails，以便保持 1:1。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-05T15:11:10.667

在实体框架**中，概念设计中不应该有外键。** 我相信现在在 EF4 中允许这样做（经过一些调整），但在 EF3.5 中，它无法做到。

要解决此问题，只需删除 EF 设计器中代表外键的所有属性。不要删除主键！

如果您随后收到*“关联端未映射..”*错误，请参阅（我的回答）[这篇文章](https://stackoverflow.com/questions/448374/association-end-is-not-mapped-in-ado-entity-framework)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-03T22:17:08.533

经过将近一整天的工作，我想通了！事实上，假设我遇到了与 Craig 相同的问题，我找到了两种不同的方法来解决这个问题。

首先，driAn 的回答并没有真正帮助（再一次，如果 Craig 有同样的问题），因为问题是表 A 中没有单独的外键。表 A 的主键是完全相同的主键表 B！特别是在我的情况下，我使用的是一个视图和一个表，而不是两个表：

```
table A
-------
A_ID int
col1 int
col2 int

view A_extra
-------
A_ID int
col3 int 
```

所以，这是我找到的解决方案：

**1\. 映射到两个不同的实体，但使用 hack。**所以 driAn 的答案的全部问题是我们没有单独的外键列来映射，然后我们可以从属性中删除它（我们不能从属性中删除它，因为它是视图 A_extra 的主键！ ）。因此，一旦您意识到这一点，黑客就会非常简单：编辑 A_extra 并简单地创建 A_ID 的副本并将其设置为备用外键：

```
table A
-------
A_ID int
col1 int
col2 int

view A_extra
-------
A_ID int
A_FK_ID int        
col3 int 
```

A_FK_ID 在视图的 SQL 中被简单地定义为“A_ID as A_FK_ID”，并且它始终具有与 A_ID 完全相同的值。

现在，对于实体框架来说，这是一个非常熟悉的场景。只需创建 1 对 1 关联，将关联映射到 A_extra，并将表 A 中的属性 A_ID 映射到 A_FK_ID，将 A_extra 中的属性 A_ID 映射到 A_ID。现在，您不再根据 EF 让同一列执行双重任务！然而，有趣的是当然，A_FK_ID 总是与 A_extra 中的 A_ID 相同。

现在您有了 A_extra 的导航属性，并且 col3 可以访问，正如您所期望的那样。更好的是，您仍然可以本地更新 table_A，因为 EF 认为它是一个表（如果您从该组合中创建了一个视图并将其导入 EF，则无法本地更新它）。

**2\. 将表和视图映射到单个实体。**对于这个解决方案，您不需要 hack，而且它更可取，因为您不必通过导航属性即可到达 col3。

要获得此配置，请将 A 和 A_extra 添加到 EF。将 col3 从 A_extra 复制并粘贴到 A 中，这样您现在在 A 中拥有未映射的属性“col3”，而在 A_extra 中没有任何内容。现在转到 A 的映射并将 A_extra 添加为要映射到的视图（以便实体“A”现在映射到表“A”和视图“A_extra”）。将属性 col3（在实体 A 中）映射到列 col3（在视图 A_extra 中）。**现在，您将向 EF 展示如何将两者连接起来以创建单个实体：**将 A_extra 中的 A_ID 列映射到实体 A 中的属性 ID。如果您注意到，您现在有两个列映射到同一个属性。这没关系，因为它们代表相同的东西，并且正是 EF 知道加入该列的方式。

现在，要完成清理工作，您必须在设计器中删除浮动实体“A_extra”。（您可能希望确保它不再映射到视图 A_extra 只是为了确保它也不会带走 A_extra 的存储映射——我希望它不会因为实体 A 现在映射到它）。现在您应该能够从实体 A 构建和访问 col1、col2 和 col3！

很酷的是您可以将数据更新为 col1 和 col2，因为它们已映射到表 (A)，但 EF 会阻止您更新 col3，因为它已映射到视图 (A_extra)。这比使 A 成为数据库中的组合视图并导入它更方便，因为 EF 会阻止您更新*任何*列，因为就它而言，它们都来自视图。

唷，我很高兴我终于成功了。希望我的解决方案对你们有帮助！

-罗伯特

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-12-09T01:01:02.263

当我尝试在通过主键连接的两个表之间进行一对一操作时，我收到了同样的错误。（不，我没有设计数据库）。所以，删除FK的解决方案是行不通的——FK也是PK，所以你不打算删除它。作为一个实验，我将关联的一侧更改为 0..1，你瞧，模型编译时没有错误。我使用的是 EF3.5

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-03-26T15:13:25.427

不知道答案，但是使用 Entity Framework，我总是在每个表中创建一个主键（即使我不需要它）。例子 ：

*   表客户将客户 ID 作为主键
*   表产品有 ProductID 作为主键
*   Table Order 当然使用 CustomerID + ProductID 作为主键。好吧，我还创建了一个本地主键：OrderID。

# php - PHP 正则表达式：什么是“偏移量 0 的类”？

> ID：475159
> 
> 赞同：30
> 
> 时间：2009-01-24T00:13:26.220
> 
> 标签：php, regex

我正在尝试使用简单的正则表达式和 php preg_replace 函数从字符串中删除所有标点符号，尽管我收到以下错误：

> 编译失败：仅在偏移量 0 的类中支持 POSIX 命名类

我想这意味着我不能在偏移量 0 的类之外使用 POSIX 命名类。我的问题是，当它说“在偏移量 0 的类内”时是什么意思？

```
$string = "I like: perl";    

if (eregi('[[:punct:]]', $string))  
    $new = preg_replace('[[:punct:]]', ' ', $string); echo $new; 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-01-24T00:20:04.443

这些[`preg_*`函数](http://docs.php.net/manual/en/ref.pcre.php)需要与Perl兼容的带有分隔符的[正则表达式。](http://en.wikipedia.org/wiki/Perl_Compatible_Regular_Expressions)所以试试这个：

```
preg_replace('/[[:punct:]]/', ' ', $string) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-24T00:24:18.617

**注意：`g`PHP 的实现不需要修饰符`PCRE`！**

除了[Gumbo 的 answer](https://stackoverflow.com/questions/475159/php-regex-what-is-class-at-offset-0#475170)之外，使用`g`修饰符替换*所有*出现的标点符号：

```
preg_replace('/[[:punct:]]/g', ' ', $string)
//                         ^ 
```

来自[Johnathan Lonowski](https://stackoverflow.com/users/15031/jonathan-lonowski)（见评论）：

```
> [The g modifier] means "Global" -- i.e., find all existing matches. Without it, regex functions will stop searching after the first match. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T00:30:01.897

关于*为什么*会出现该错误的解释：PCRE 使用 Perl 对分隔符的松散定义。您的外部`[]`s 看起来像是有效的分隔符，导致它被读取`[:punct:]`为正则表达式部分。

（哦，`ereg`如果可以的话，请避免使用这些函数 - 它们不会包含在 PHP 5.3 中。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T00:56:51.327

我只是按照其中一个答案中的建议将 g 添加到正则表达式中，它的作用与预期相反，并且没有过滤掉标点符号，结果 preg_replace 不需要 g，因为它首先是全局/递归的

# php - 创建 SQL 查询，根据满足的条件对结果进行排序

> ID：475178
> 
> 赞同：0
> 
> 时间：2009-01-24T00:23:07.947
> 
> 标签：php, sql, mysql, magento

这适用于 MySQL 和 PHP

我有一个包含以下列的表：

```
navigation_id (unsigned int primary key)
navigation_category (unsigned int)
navigation_path (varchar (256))
navigation_is_active (bool)
navigation_store_id (unsigned int index) 
```

数据将填写如下：

```
1, 32, "4/32/", 1, 32
2, 33, "4/32/33/", 1, 32
3, 34, "4/32/33/34/", 1, 32
4, 35, "4/32/33/35/", 1, 32
5, 36, "4/32/33/36/", 1, 32
6, 37, "4/37/", 1, 32
... another group that is under the "4/37" node
... and so on 
```

所以这将代表一个树状结构。我的目标是编写一个 SQL 查询，给定商店 ID 32 和类别 ID 33，将返回

首先，作为类别 33（在本例中为 4 和 32）的父元素的一组元素

然后，一组元素属于类别 33（在本例中为 34、35 和 36）的子元素

然后是类别 4 下的其余“根”类别（在本例中为 37）。

所以下面的查询会返回正确的结果：

```
SELECT * FROM navigation 
WHERE navigation_store_id = 32 
AND (navigation_category IN (4, 32) 
    OR navigation_path LIKE "4/32/33/%/" 
    OR (navigation_path LIKE "4/%/" 
        AND navigation_category <> 32)) 
```

我的问题是我想按上面列出的顺序对类别的“组”进行排序（首先是 33 的父母，其次是 33 的孩子，最后是根节点的父母）。因此，如果他们满足第一个条件，则先排序，如果满足第二个条件，则排序第二个，如果满足第三个（和第四个）条件，则最后排序。

您可以在此站点上查看类别结构如何工作的示例：

www.eacortes.net

您可能会注意到它相当慢。目前我这样做的方式是使用magento的原始类别表并对其执行三个特别慢的查询；然后将结果放在 PHP 中。使用这个新表，我正在解决我在使用 magento 时遇到的另一个问题，但同时也想提高我的性能。我认为实现这一点的最好方法是将所有三个查询放在一起，并通过对结果进行正确排序来减少 PHP 的工作量。

谢谢

**编辑**

好的，现在效果很好。将其从 4 秒减少到 500 毫秒。现在速度很好:)

这是我在 Colleciton 类中的代码：

```
 function addCategoryFilter($cat)
    {
        $path = $cat->getPath();
        $select = $this->getSelect();
        $id = $cat->getId();
        $root = Mage::app()->getStore()->getRootCategoryId();
        $commaPath = implode(", ", explode("/", $path));

        $where = new Zend_Db_Expr(
            "(navigation_category IN ({$commaPath}) 
                    OR navigation_parent = {$id}
                    OR (navigation_parent = {$root}
                    AND navigation_category <> {$cat->getId()}))");

        $order = new Zend_Db_Expr("
                CASE
                    WHEN navigation_category IN ({$commaPath})  THEN 1
                    WHEN navigation_parent = {$id} THEN 2
                    ELSE 3
                END, LENGTH(navigation_path), navigation_name");

        $select->where($where)->order($order);
        return $this;
    } 
```

然后我使用在我的 Category 块中找到的以下代码来使用它：

```
 // get our data
        $navigation = Mage::getModel("navigation/navigation")->getCollection();
        $navigation->
            addStoreFilter(Mage::app()->getStore()->getId())->
            addCategoryFilter($currentCat);

        // put it in an array
        $node = &$tree;
        $navArray = array();
        foreach ($navigation as $cat)
        {
            $navArray[] = $cat;
        }
        $navCount = count($navArray);

        $i = 0;

        // skip passed the root category
        for (; $i < $navCount; $i++)
        {
            if ($navArray[$i]->getNavigationCategory() == $root)
            {
                $i++;
                break;
            }
        }

        // add the parents of the current category
        for (; $i < $navCount; $i++)
        {
            $cat = $navArray[$i];

            $node[] = array("cat" => $cat, "children" => array(), 
                "selected" => ($cat->getNavigationCategory() == $currentCat->getId()));
            $node = &$node[0]["children"];

            if ($cat->getNavigationCategory() == $currentCat->getId())
            {
                $i++;
                break;
            }
        }

        // add the children of the current category
        for (; $i < $navCount; $i++)
        {
            $cat = $navArray[$i];
            $path = explode("/", $cat->getNavigationPath());
            if ($path[count($path) - 3] != $currentCat->getId())
            {
                break;
            }

            $node[] = array("cat" => $cat, "children" => array(), 
                "selected" => ($cat->getNavigationCategory() == $currentCat->getId()));
        }

        // add the children of the root category
        for (; $i < $navCount; $i++)
        {
            $cat = $navArray[$i];
            $tree[] = array("cat" => $cat, "children" => array(), 
                "selected" => ($cat->getNavigationCategory() == $currentCat->getId()));
        }

        return $tree; 
```

如果我能接受两个答案，我会接受第一个和最后一个，如果我能接受一个“有趣/有用”的答案，我会接受第二个。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T00:30:07.183

尝试一个额外的派生列，如“重量”：

**（未经测试）**

```
(IF(criteriaA,1,0)) + (IF(criteriaB,1,0)) ... AS weight
....
ORDER BY weight 
```

每个标准都会增加排序的“权重”。您还可以通过嵌套 IF 并给组一个特定的整数来明确设置权重，以便按如下方式排序：

```
IF(criteriaA,0, IF(criteriaB,1, IF ... )) AS weight 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T03:43:02.257

MySQL 是否有`UNION`用于组合查询的 SQL 关键字？您的三个查询主要具有不重叠的标准，因此我怀疑最好将它们保留为本质上独立的查询，但使用`UNION`or将它们组合起来`UNION ALL`。这将节省 2 次数据库往返，并可能使 MySQL 的查询计划器更容易“看到”查找每组行的最佳方法。

顺便说一句，您通过存储从根到尖端的路径来表示树的策略很容易遵循，但每当您需要使用表单的 WHERE 子句时效率很低`navigation_path like '%XYZ'`——在我见过的所有数据库中，`LIKE`条件必须以非通配符以启用该列上的索引。（在您的示例代码片段中，如果您还不知道根类别是 4，那么您将需要这样一个子句（顺便说一下，您是如何知道的？来自一个单独的、较早的查询？））

您的类别多久更改一次？如果它们不经常更改，您可以使用[此处](http://www.intelligententerprise.com/001020/celko1_1.jhtml)描述的“嵌套集”方法来表示您的树，这样可以更快地查询“哪些类别是给定类别的后代/祖先”之类的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T03:55:49.593

`CASE`表达式应该可以解决问题。

```
SELECT * FROM navigation 
    WHERE navigation_store_id = 32 
        AND (navigation_category IN (4, 32) 
            OR navigation_path LIKE "4/32/33/%/" 
            OR (navigation_path LIKE "4/%/" 
            AND navigation_category <> 32))
    ORDER BY
        CASE
            WHEN navigation_category IN (4, 32) THEN 1
            WHEN navigation_path LIKE "4/32/33/%/" THEN 2
            ELSE 3
        END, navigation_path 
```

# asp.net - 全局记录来自 ASP.NET [ScriptService] 服务的异常

> ID：475189
> 
> 赞同：14
> 
> 时间：2009-01-24T00:30:29.803
> 
> 标签：asp.net, asp.net-ajax, error-handling

我正在使用 [System.Web.Script.Services.ScriptService] 标记来使用可从客户端 JavaScript 调用的 Web 服务。我需要的是一种在这些方法中全局记录任何未处理异常的方法。在客户端，我收到错误回调并可以从那里继续，但我需要一个服务器端捕获来记录异常。

这个网址的人：http: [//ayende.com/Blog/archive/2008/01/06/ASP.Net-Ajax-Error-Handling-and-WTF.aspx](http://ayende.com/Blog/archive/2008/01/06/ASP.Net-Ajax-Error-Handling-and-WTF.aspx)

表明这是无法做到的。

那准确吗？我真的必须去整个系统中的每一个 webmethod 并尝试/捕获整个方法。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-15T20:28:15.853

您可以使用 HTTP 模块来捕获 Web 服务方法抛出的异常消息、堆栈跟踪和异常类型。

首先是一些背景...

*   如果 Web 服务方法引发异常，则 HTTP 响应的状态代码为 500。

*   如果自定义错误关闭，则 Web 服务将异常消息和堆栈跟踪作为 JSON 返回给客户端。例如：
    `{"Message":"Exception message","StackTrace":" at WebApplication.HelloService.HelloWorld() in C:\Projects\Stackoverflow Examples\WebApplication\WebApplication\HelloService.asmx.cs:line 22","ExceptionType":"System.ApplicationException"}`

*   当自定义错误出现时，Web 服务会向客户端返回默认消息并删除堆栈跟踪和异常类型：
    `{"Message":"There was an error processing the request.","StackTrace":"","ExceptionType":""}`

所以我们需要做的是为 Web 服务设置自定义错误并插入一个 HTTP 模块：

1.  检查请求是否针对 Web 服务方法
2.  检查是否抛出异常 - 即返回状态码 500
3.  如果 1) 和 2) 为真，则获取将发送到客户端的原始 JSON 并将其替换为默认 JSON

下面的代码是执行此操作的 HTTP 模块的示例：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.Web;

public class ErrorHandlerModule : IHttpModule {

  public void Init(HttpApplication context) {
    context.PostRequestHandlerExecute += OnPostRequestHandlerExecute;
    context.EndRequest += OnEndRequest;
  }

  static void OnPostRequestHandlerExecute(object sender, EventArgs e) {
    HttpApplication context = (HttpApplication) sender;
    // TODO: Update with the correct check for your application
    if (context.Request.Path.StartsWith("/HelloService.asmx") 
        && context.Response.StatusCode == 500) {
      context.Response.Filter = 
        new ErrorHandlerFilter(context.Response.Filter);
      context.EndRequest += OnEndRequest;
    }
  }

  static void OnEndRequest(object sender, EventArgs e) {
    HttpApplication context = (HttpApplication) sender;
    ErrorHandlerFilter errorHandlerFilter = 
      context.Response.Filter as ErrorHandlerFilter;
    if (errorHandlerFilter == null) {
      return;
    }

    string originalContent =
      Encoding.UTF8.GetString(
        errorHandlerFilter.OriginalBytesWritten.ToArray());

    // If customErrors are Off then originalContent will contain JSON with
    // the original exception message, stack trace and exception type.

    // TODO: log the exception
  }

  public void Dispose() { }
}
```

该模块使用以下过滤器覆盖发送到客户端的内容并存储原始字节（包含异常消息、堆栈跟踪和异常类型）：

```
public class ErrorHandlerFilter : Stream {

  private readonly Stream _responseFilter;

  public List OriginalBytesWritten { get; private set; }

  private const string Content = 
    "{\"Message\":\"There was an error processing the request.\"" +
    ",\"StackTrace\":\"\",\"ExceptionType\":\"\"}";

  public ErrorHandlerFilter(Stream responseFilter) {
    _responseFilter = responseFilter;
    OriginalBytesWritten = new List();
  }

  public override void Flush() {
    byte[] bytes = Encoding.UTF8.GetBytes(Content);
    _responseFilter.Write(bytes, 0, bytes.Length);
    _responseFilter.Flush();
  }

  public override long Seek(long offset, SeekOrigin origin) {
    return _responseFilter.Seek(offset, origin);
  }

  public override void SetLength(long value) {
    _responseFilter.SetLength(value);
  }

  public override int Read(byte[] buffer, int offset, int count) {
    return _responseFilter.Read(buffer, offset, count);
  }

  public override void Write(byte[] buffer, int offset, int count) {
    for (int i = offset; i < offset + count; i++) {
      OriginalBytesWritten.Add(buffer[i]);
    }
  }

  public override bool CanRead {
    get { return _responseFilter.CanRead; }
  }

  public override bool CanSeek {
    get { return _responseFilter.CanSeek; }
  }

  public override bool CanWrite {
    get { return _responseFilter.CanWrite; }
  }

  public override long Length {
    get { return _responseFilter.Length; }
  }

  public override long Position {
    get { return _responseFilter.Position; }
    set { _responseFilter.Position = value; }
  }
}
```

This method requires custom errors to be switched off for the web services. You would probably want to keep custom errors on for the rest of the application so the web services should be placed in a sub directory. Custom errors can be switched off in that directory only using a web.config that overrides the parent setting.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T13:24:29.087

You run the Stored Procedure in the backend. Then, for a single variable, it returns more than 1 value. Because of that, a conflicts occurs, and, this error is thrown.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T07:48:25.023

I know this doesn't answer the question per-say, but I went on my own quest a while back to find this out and would up empty handed. Ended up wrapping each web service call in a try/catch, and the catch calls our error logger. Sucks, but it works.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-24T10:05:51.750

在 ASP.Net 中，可以使用[全局错误处理程序](http://msdn.microsoft.com/en-us/library/ms998372.aspx#pagpractices0001_exchowtocreateaglobalerrorhandlerforyourapplication)捕获所有运行处理的异常，尽管博客文章建议这不起作用，但您可以尝试使用这种方法尝试以某种方式重新抛出错误？

另一个想法是查看 ASP.Net 的开源[elmah](http://code.google.com/p/elmah/)（错误记录模块和处理程序），这可能会有所帮助，或者该社区中的某个人可能有想法。

# machine-learning - 神经网络结构

> ID：475200
> 
> 赞同：3
> 
> 时间：2009-01-24T00:34:24.790
> 
> 标签：machine-learning, neural-network

我目前正在构建一个神经网络库。为简单起见，我将其构建为对象图。我想知道是否有人可以量化采用基于数组的方法的性能优势。我现在所拥有的对于构建接近任意复杂性的网络非常有效。支持常规（反向支持）网络以及循环网络。我正在考虑将训练有素的网络“编译”成一些“更简单”的形式，例如数组。

我只是想看看那里是否有人有任何实用的建议或构建神经网络的经验，这些神经网络可以很好地部署到生产环境中。让最终产品基于数组而不是基于对象图有什么好处吗？

PS 内存占用不如速度重要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T01:22:46.640

人们已经开始在 AI 中使用 GPGPU 技术，让您的神经网络采用矩阵形式可以利用典型显卡中更快的矩阵运算。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T00:40:06.603

这一切都取决于您使用的语言 - 我假设您使用的是 C 衍生产品。

在我的实现中，我发现对象图方法要优越得多。在速度上有一些折衷，但易于维护胜过对象查找调用。这一切都取决于您是否正在寻找训练速度或解决速度......我假设您最担心训练速度？

如果需要，您总是可以最终对一些对象调用问题进行微优化。

考虑到您对网络进行子网划分的次要动机，我认为基于对象更为重要——它可以更容易地取出部分工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-24T01:49:21.347

无论你如何实现它，你都不能忘记：

![只要确保你没有最大化而不是最小化。](https://imgs.xkcd.com/comics/genetic_algorithms.png)

[http://xkcd.com/534/](http://xkcd.com/534/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T00:39:52.657

已经有一段时间了，但我记得速度通常只是神经网络训练期间的一个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T00:42:14.163

我没有任何编写此类库的个人经验，但我可以将您链接到一些您可能可以从中学习的流行开源项目。（就我个人而言，我只会使用这些现有库之一。）

*   [快速人工神经网络库](http://leenissen.dk/fann/)
*   [神经元网络](http://sourceforge.net/projects/neurondotnet/)

# python - Python 应用程序：你能以某种方式保护你的代码吗？

> ID：475216
> 
> 赞同：8
> 
> 时间：2009-01-24T00:40:09.503
> 
> 标签：python, security, reverse-engineering

如果真的有“最佳”方式，那么发布 python 应用程序并确保人们不能（轻松）对您的算法/安全性/工作进行逆向工程的最佳方式*是什么？*

如果没有“最佳”方式，有哪些不同的选择？

背景：我喜欢用 Python 编码，并希望用它发布更多的应用程序。我想知道的一件事是人们是否有可能绕过我输入的任何许可代码，或者能够窃取我的整个源代码库。我听说过 Py2Exe 和类似的应用程序，但我很好奇是否有“首选”方法，或者这个问题是否只是生活中的事实。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-24T00:56:39.190

通过默默无闻的安全*永远不会*奏效。如果您必须使用专有许可证，请通过法律强制执行，而不是半生不熟的混淆尝试。

如果您担心他们学习您的安全（例如密码学）算法，同样适用。真实、有用的安全算法（如 AES）是安全的，即使该算法是完全已知的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-24T03:02:04.960

即使您使用 C# 或 Java 之类的编译语言，如果人们有动力并具备技术能力，他们也可以执行逆向工程。混淆不是对此的可靠保护。

您可以在您的软件的最终用户许可协议中添加禁止逆向工程。大多数专有公司都这样做。但这并不能防止违规，它只会给你法律追索权。

*最好*的解决方案是提供产品和服务，在这些产品和服务中，用户读取您的代码的权限不会损害您销售产品或服务的能力。您的业​​务基于提供的服务或订阅数据的定期更新，而不是代码本身。

示例：Slashdot 实际上使他们的网站代码可用。这会损害他们运行网站的能力吗？不。

另一种补救措施是设定您的价格点，以便盗版您的代码的努力比简单地购买合法许可证来使用您的产品更昂贵。Joel Spolsky 在他的文章和播客中对这种效果提出了建议。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-24T14:43:27.883

用Python发布[商业 mac 桌面应用程序](http://www.checkoutapp.com)，我们完全按照其他答案中的描述进行操作；用体面的 EULA 保护自己，而不是混淆视听。

我们从来没有遇到过人们对我们的代码进行逆向工程的麻烦。如果我们这样做，我相信我们可以采取法律行动。所以，是的，这是生活中的事实。但是一个并不太难相处的人。只需找一位体面的律师，写出体面的 EULA。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-24T01:12:13.510

你要找的词是模糊的。一个快速的谷歌揭示：

[http://www.lysator.liu.se/~astrand/projects/pyobfuscate/](http://www.lysator.liu.se/~astrand/projects/pyobfuscate/)

但：

a) 如果侵犯版权成为问题，那么法律站在您这边（只要您在所有文件中包含适当的版权声明）。

b) 如果你很聪明，也可以从开源应用程序中获利。

c）如果您希望您的知识产权真正安全，那么唯一的答案是首先不要让任何人拥有它：将您的应用程序编写为网络应用程序，（我建议使用 django）并且只有您的网络托管服务提供商有访问您的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T21:35:29.430

**py2exe**

在 Windows 上，py2exe 是向最终用户发送代码的一种方式，py2exe 捆绑了 python 解释器、必要的 dll 和编译为 python 字节码的代码。

以下是 python 字节码指令，以了解它的外观：

[http://www.python.org/doc/2.5.2/lib/bytecodes.html](http://www.python.org/doc/2.5.2/lib/bytecodes.html)

或者你可以使用**dis**反汇编一些 pyc/pyo 文件。

因此，使用 py2exe 类似于分发已编译的 python (pyc/pyo) 文件。

**剥皮 C++ 编译器**

Shedskin 编译器将 python 的子集编译为 C++，您可以使用任何编译器将其编译为本机代码。

**pypy**

我对 PyPy 不太了解。根据他们的文档，Pypy 能够生成 C 代码。

# language-agnostic - 模型视图控制器

> ID：475218
> 
> 赞同：3
> 
> 时间：2009-01-24T00:41:40.187
> 
> 标签：language-agnostic, design-patterns, oop

我的 GUI 中有一个树控件（自然有很多 GUI/平台特定的功能来处理节点）。
我有一个数据模型，它有自己的复杂节点集、子节点、属性等。
我希望树显示模型的表示，能够向模型内的节点发送消息，并被告知在模型变化。

但我不希望 GUI 代码需要知道模型数据类型的详细信息，也不希望通过将模型链接到 GUI 类来污染模型。

我无法理解控制器应该如何执行此操作以及它应该提供哪些功能？

（这是在 C++ 中，但没关系）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T04:11:38.860

GUI“控件”不太适合模型-视图-控制器模式，因为它们通常有自己的内部模型，而不是接受对模型的引用。如果控件是这样构造的，您将需要一个适配器类，将控件的内部模型“数据绑定”到底层数据模型。

这可以完成类似于模型-视图-控制器所做的事情，除了适配器类同时扮演视图连接组件（从数据模型更新 GUI）和控制器（将 GUI 事件解释为模型操作）的角色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T04:01:02.313

我认为你的麻烦始于一个不幸的单词选择。“控制”的东西与 MVC 中的“控制器”没有任何关系。这就是为什么一些 GUI 库使用其他名称的原因（小部件是一种常见的名称）。

您的“树控件”是视图，而不是控制器。它应该绑定到 GUI，既用于显示，也用于获取 GUI 事件并将它们转换为“树事件”。

控制器获取那些“树事件”并对模型进行必要的修改。这就是您将“动作”与“响应”结合起来的地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T00:45:11.320

[Qt 为模型视图编程](http://doc.trolltech.com/4.4/model-view-programming.html)提供了一组类。例如，您可以将树*视图*与文件系统*模型*挂钩，并且两者都不会直接了解彼此的任何信息（视图中指向模型的指针除外）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T01:00:53.767

您的要求是：

*   树显示模型的表示
*   树中的节点可以向模型内的节点发送消息
*   树根据模型更改重绘自身

我不知道您在这里使用的是哪种数据，但分层模型是一件相当简单的事情。我会认为你知道如何迭代分层数据和填充树视图。

您的控制器应该具有用于​​向模型发送消息的成员函数。参数应该是模型元素和您要发送的消息。这样，UI 完全不知道消息是如何到达元素的，但可以让消息通过。

最后一个要求更加棘手，并且取决于一些事情（例如，控制器的生命周期、应用程序架构等）。我将假设控制器的生命周期与树视图一样长。如果是这种情况，那么您的控制器应该提供一种方法来设置模型更改的回调。然后，当控制器更改模型时，它可以在不知道 UI 的情况下回调 UI。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T04:49:04.667

**第一个解决方案：**您可以在模型和视图之间实现“主题观察者”模式，模型作为主题，视图作为观察者。每当模型状态发生变化时，它可以向所有注册的观察者触发一个事件，他们可以更新自己。

**第二种解决方案：**引入一个控制器，它向模型注册为观察者。从模型接收到更新事件后，它可以更新视图。即使您可以在控制器和视图之间使用另一种主题观察者模式将视图与控制器分离

**第三种解决方案：**使用 MVP 模式。模型视图演示者。每当控制器中没有太多计算时使用此模式，即控制器的工作只是更新其相应的视图。这里控制器变成了 Presenter。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T01:10:32.593

您需要一个控制器，它位于显示小部件之外，但具有树的状态（在 MFC 中有 CTreeView/CTreeCtrl 类 - 在 Qt 中有类似的分离）树控制器处理所有数据存储并在树小部件上调用重绘.
树小部件中的更改被发送到树控制器 - 所以这个控制器需要了解 gui 函数。

该模型将需要为节点的所有相关参数设置/获取函数。但这些可以返回简单类型，因此不依赖于 gui。

更新模型的视图表单需要发送一条消息，如果您不希望模型知道您的 gui 消息传递，您可以做的最好的事情是从树控制器注册一个回调函数（一个指向函数的 void 指针） - 并调用这是为了做一个更新。然后，此更新函数可以查询模型的更改。

# compiler-construction - 实现编译器和解释器有什么区别？

> ID：475223
> 
> 赞同：23
> 
> 时间：2009-01-24T00:43:40.153
> 
> 标签：compiler-construction, interpreter

我最近阅读了整本《龙之书》（只是为了好玩，我并没有真正打算实现一个实际的编译器），我的脑海中留下了一个悬而未决的大问题。

实现编译器和解释器有什么不同？

对我来说，编译器由以下部分组成：

*   词法分析器
*   解析器（构建语法树）
*   生成中间码（如 3 地址码）
*   如果你愿意，可以做所有这些疯狂的事情来优化:-)
*   从 3 地址码生成“汇编”或“本机代码”。

现在，很明显，解释器也具有与编译器相同的词法分析器和解析器。
但在那之后它会做什么？

*   它是否“读取”语法树并直接执行它？（有点像有一个指向树中当前节点的指令指针，执行是一个大树遍历加上调用堆栈的内存管理）（如果是这样，它是如何做到的？我希望执行比检查它是什么类型的节点的巨大 switch 语句更好）

*   它会生成 3 个地址代码并对其进行解释吗？（如果是这样，它是如何做到的？同样，我正在寻找比一英里长的 switch 语句更优雅的东西）

*   它会生成真正的本机代码，将其加载到内存中并使其运行吗？（此时我猜它不再是解释器，而更像是 JIT 编译器）

另外，“虚拟机”的概念是在什么时候切入的？您在语言中使用虚拟机做什么？（要清楚我的无知程度，对我来说虚拟机是VMWare，我不知道VM的概念如何应用于编程语言/执行程序）。

如您所见，我的问题非常广泛。我主要不仅在寻找使用哪种方法，而且主要是首先了解大概念，然后详细了解它的工作原理。我想要丑陋的原始细节。显然，这更多的是寻求参考要阅读的内容，而不是期望您在这里回答所有这些细节。

谢谢！
丹尼尔

* * *

编辑：谢谢你到目前为止的回答。但我意识到我的标题具有误导性。我了解编译器和解释器之间的“功能”差异。
我正在寻找的是您如何*实现*解释器与编译器的区别。
我现在了解编译器是如何实现的，问题是解释器与它有何不同。

例如：VB6 显然既是编译器又是解释器。我现在了解编译器部分。但是，我无法理解，当在 IDE 中运行时，它可以让我在任意点停止程序、更改代码并使用新代码恢复执行。这只是一个很小的例子，这不是我正在寻找的答案。正如我在下面解释的那样，我试图理解的是在我拥有解析树之后会发生什么。编译器将从它以“目标”语言生成新代码。口译员做什么的？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T01:01:39.663

编译器是将一种编程语言的程序翻译成另一种编程语言的程序的程序。就是这样——简单明了。

解释器将编程语言翻译成它的语义。

x86 芯片是 x86 机器语言的解释器。

Javac 是java 到java 虚拟机的编译器。可执行应用程序 java 是 jvm 的解释器。

一些解释器共享一些编译元素，因为他们可以将一种语言翻译成另一种更容易解释的内部语言。

解释器通常（但并非总是）具有 read-eval-print 循环。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-24T04:04:18.327

程序是对您想要完成的**工作**的描述。

**编译器**将高级描述转换为更简单的描述。

**口译员**阅读关于做什么的描述并完成*工作*。

*   一些解释器（例如 Unix shell）一次读一小段描述，并在他们看到的每一段上采取行动；有些人（例如 Perl、Python）阅读整个描述，在内部将其转换为更简单的形式，然后对其采取行动。
*   一些解释器（例如 Java 的 JVM 或 Pentium 4 芯片）只能理解一种非常简单的描述语言，这种语言对于人类来说过于繁琐而无法直接使用，因此人类使用编译器将其高级描述转换为这种语言。

编译器*从*不做这项工作。口译员*总是*做这项工作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-24T01:24:27.357

简短的回答：

*   编译器将源代码转换为可执行格式以供以后执行
*   解释器评估源代码以立即执行

两者的实施方式都有很大的余地。解释器可以生成本地机器代码然后执行它，而虚拟机的编译器可以生成 p 代码而不是机器代码。像 Forth 这样的线程解释语言在字典中查找关键字并立即执行它们相关的本机代码函数。

编译器通常可以更好地优化，因为他们有更多时间研究代码并生成文件以供以后执行；解释器有更少的时间进行优化，因为他们倾向于在第一眼看到时“按原样”执行代码

在后台优化的解释器，学习更好的代码执行方式也是可能的

摘要：真正的区别在于“准备代码以供以后执行”或“立即执行代码”

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-24T00:53:18.103

两者都有很多共同点（例如词法解析器），并且在差异上存在分歧。我这样看：

**经典定义**是编译器解析符号流并将其转换为可由 CPU 运行的字节流，而解释器做同样的事情，但将它们转换为必须在软件上执行的形式（例如JVM，CLR）。

然而，人们称“javac”为编译器，因此编译器的**非正式定义**必须将源代码作为一个单独的步骤来完成，而解释器没有“构建”步骤（例如 PHP、Perl）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-24T00:54:09.040

它不像以前那样清晰。它曾经是构建一个解析树，绑定它并执行它（通常在最后一秒绑定）。

BASIC 主要是这样完成的。

您可以声称在不执行 JIT 的情况下运行字节码 (java/.net) 的东西是解释器 - 但不是传统意义上的，因为您仍然必须“编译”为字节码。

老派的区别是：如果它生成 CPU 代码，它就是一个编译器。如果您直接在编辑环境中运行它并且可以在编辑时与之交互，它就是一个解释器。

这远没有真正的龙书那么正式——但我希望它能提供信息。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-24T01:24:00.867

如果我的经验表明了什么；

1.  解释器不会尝试进一步减少/处理 AST，每次引用代码块时，都会遍历并执行相关的 AST 节点。编译器最多遍历一个块几次，以在确定的位置生成可执行代码并完成它。
2.  解释器的符号表在执行时保存值和引用，编译器的符号表保存变量的位置。执行时没有这样的符号表。

在镜头中，差异可能很简单

```
case '+':
    symtbl[var3] = symtbl[var1] + symtbl[var2];
    break; 
```

之间，

```
case '+':
    printf("%s = %s + %s;",symtbl[var3],symtbl[var1],symtbl[var2]);
    break; 
```

（如果您以另一种语言或（虚拟）机器指令为目标，这并不重要。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-26T15:14:33.567

关于您问题的这一部分，其他答案尚未真正解决：

> 另外，“虚拟机”的概念是在什么时候切入的？您在语言中使用虚拟机做什么？

像 JVM 或 CLR 这样的虚拟机是一个抽象层，它允许您对编译后在 VM 上运行的完全不同的语言重用 JIT 编译器优化、垃圾收集和其他实现细节。

它们还可以帮助您使语言规范更加独立于实际硬件。例如，虽然 C 代码在理论上是可移植的，但如果您真的想要生成可移植代码，则必须经常担心字节顺序、类型大小和变量对齐等问题。而在 Java 中，JVM 在这些方面有非常明确的规定，因此语言设计者和它的用户不必担心它们；在实际硬件上实现指定行为是 JVM 实现者的工作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-04T00:29:14.373

一旦解析树可用，就有几种策略：

1）直接解释AST（Ruby，WebKit的原始解释器） 2）代码转换->成字节码或机器码

为了实现编辑并继续，程序计数器或指令指针必须重新计算和移动。这需要 IDE 的配合，因为代码可能已经插入到黄色小箭头之前或之后。

可以做到这一点的一种方法是将程序计数器的位置嵌入到解析树中。例如，可能有一个名为“break”的特殊语句。程序计数器只需要定位在“break”指令之后就可以继续运行。

此外，您必须决定要对当前堆栈帧（以及堆栈上的变量）执行什么操作。也许弹出当前堆栈，并复制变量，或保留堆栈，但修补 GOTO 并返回到当前代码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-26T15:12:25.753

鉴于您的步骤列表：

*   词法分析器
*   解析器（构建语法树）
*   生成中间码（如 3 地址码）
*   如果你愿意，可以做所有这些疯狂的事情来优化:-)
*   从 3 地址码生成“汇编”或“本机代码”。

一个非常简单的解释器（如早期的 BASIC 或 TCL）一次只能执行第 1 步和第 2 步。然后在继续执行下一行时丢弃大部分结果。其他 3 个步骤根本不会执行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-05-11T06:48:20.887

如果您正在寻找一本书，[Structure and Interpretation of Computer Programs](http://mitpress.mit.edu/sicp/)（“向导书”）是从解释器概念开始的好地方。您只需要处理 Scheme 代码，它可以像 AST 一样被遍历、评估和传递。

此外，[Peter Norvig](http://norvig.com/lispy.html)有一个简短的示例来解释使用 Python 的主要思想（评论中有更多示例），这是 Wikipedia 上的另一个[小示例](http://en.wikipedia.org/wiki/Interpreter_pattern)。

就像你说的，它是一个树遍历，至少对于按值调用来说它是一个简单的：每当你看到一个运算符时，评估操作数的拳头，然后应用运算符。返回的最终值是程序的结果（或给 REPL 的语句）。

请注意，您不必总是明确地进行树遍历：您可以以接受访问者的方式生成 AST（我认为 SableCC 会这样做），或者对于非常小的语言，例如用于演示的小型算术语法解析器生成器，您可以在解析期间评估结果。

为了支持声明和赋值，你需要保持一个环境。正如您通过添加操作数来评估“加号”一样，您可以通过在环境中查找来评估函数、变量等的名称。支持范围意味着将环境视为堆栈并在正确的时间推送和弹出内容。通常，您的解释器有多复杂取决于您要支持的语言功能。例如，解释器使垃圾收集和自省成为可能。

对于 VM：plinth 和 j_random_hacker 将计算机硬件描述为一种解释器。反之亦然——口译员是机器；他们的指令恰好比真正的 ISA 的指令级别更高。对于 VM 风格的解释器，这些程序实际上类似于机器代码，尽管是非常简单的机器。[Java 字节码](http://www.artima.com/underthehood/leanmeanP.html)只使用了几个“寄存器”，其中一个包含一个程序计数器。因此，与我上面链接的示例中的解释器相比，VM 解释器更像是硬件模拟器。

但请注意，出于速度原因，默认的 Oracle JVM 通过将 Java 字节码指令的运行转换为 x86 指令（“即时编译”）来工作。

# php - Zend Framework：如何在模块化应用程序中设置布局目录？

> ID：475236
> 
> 赞同：3
> 
> 时间：2009-01-24T00:49:04.697
> 
> 标签：php, zend-framework, bootstrapping

我试图实现的目录结构是这样的：

```
application/default/views/layouts/layout.phtml
application/default/views/scripts/index/index.phtml
application/admin/views/layouts/layout.phtml
application/admin/views/scripts/index/index.phtml
library/Zend
config/config.ini
public/index.php (bootstrap) 
```

但我不知道如何让 Zend 在我的每个模块中找到我的 layout.phtml。

在我的引导程序中，我有：

```
define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/../application/'));
define('APPLICATION_ENVIRONMENT', 'testing');

//setup path to our library files
set_include_path( APPLICATION_PATH . '/../library' . PATH_SEPARATOR .
                  get_include_path() );

//register the autoloader
require_once 'Zend/Loader.php';
Zend_Loader::registerAutoload(); 

//set config in the registry
$config = new Zend_Config_Ini( APPLICATION_PATH . '/../config/config.ini', APPLICATION_ENVIRONMENT ); 
Zend_Registry::set('config', $config);

//setup logging
$writer = new Zend_Log_Writer_Stream(APPLICATION_PATH . '/../log/debug.log');
$logger = new Zend_Log($writer);
Zend_Registry::set('logger', $logger);

//run!
$frontController = Zend_Controller_Front::getInstance();
$frontController->addModuleDirectory(APPLICATION_PATH);
//initialize Zend_Layout's MVC helpers
Zend_Layout::startMvc();

$frontController->throwExceptions(true);

try {

    Zend_Controller_Front::getInstance()->dispatch();

} catch (Exception $exception) {

    echo '<html><body><center>'  . 'An exception occured while dispatching the front controller.'; 
    if (defined('APPLICATION_ENVIRONMENT') && APPLICATION_ENVIRONMENT != 'production'  ) {
        echo '<br /><br />' . $exception->getMessage() . '<br />'  . '<div align="left">Stack Trace:' . '<pre>' . $exception->getTraceAsString() . '</pre></div>'; 
    }
    echo '</center></body></html>';
    exit(1);
} 
```

我哪里错了？

## 更新：

我很久没有看过这个了，所以接受的解决方案可能不是最新的。如果有人想针对这个问题发布更新的解决方案（即 ZF 1.8+），请这样做！这将有助于其他正在寻找解决方案的人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T16:27:10.700

您应该查看[Per Module Zend_Layout](http://dustint.com/archives/28)，在本文中，作者准确地涵盖了您想要实现的目标。他的方法是为处理布局注册的前端控制器编写一个插件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T03:16:09.733

使用 Zend Framework 1.12（尚未在以前的版本上测试过）：开箱即用！

我通常使用 application.ini 进行设置，以便启用布局：

```
resources.layout.layout = "layout" 
```

...或应调用的默认布局。由于尚未定义“layoutPath”，Zend_Layout 将在“Application/modules//views/scripts”中查找名为“layout.phtml”的文件

如果您使用 zend 工具，它将使用以下行开始布局：

```
resources.layout.layoutPath = APPLICATION_PATH "layouts/scripts" 
```

这也可以，只需删除目录或避免创建默认的“layout.phtml”。如果在该目录中找不到默认布局，它将像以前一样在“Application/modules//views/scripts”中查找“layout.phtml”的模块。

如果在模块中找不到布局，它将加载默认模块的布局。

就如此容易！

如果您需要对模板进行一些额外的工作，您可以添加一个插件，例如：

```
resources.layout.pluginClass = "YourLibrary_Controller_Plugin_Layout" 
```

并在其中做一些额外的事情。

# php - PHP 检查 bool 和 int 有什么价值吗？

> ID：475265
> 
> 赞同：0
> 
> 时间：2009-01-24T01:08:59.400
> 
> 标签：php, boolean, magic-quotes

我有以下行：

```
$this->magicQuotes = (bool) get_magic_quotes_gpc(); 
```

我`get_magic_quotes_gpc()`将它存储在我的对象中，因为它在我生成 SQL 时被多次使用。我也将其转换为布尔值。

我想知道将其转换为布尔值是否值得。我的主要原因是速度，因为检查的语句是：

```
if ($this->magicQuotes) { ... } 
```

如果测试严格是布尔值，我认为会稍微快一些。

是否有任何原因它不更快，或者是否有任何其他原因不这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T01:19:14.230

如果您不转换为，PHP在评估 if 语句中的表达式时无论如何`bool`都必须转换为。`bool`因此，无论您是否明确转换它，它都会`bool`在某个时间或另一个时间转换为，我更喜欢让您输入更少的方式。

此外，通过这种微小的优化，您应该更担心哪个更具可读性，而不是担心哪个比另一个快 0.0...01 秒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T01:21:09.920

它不应该更快......取决于 php 最后如何转换 bool 和 int 。

通常，在 x86 上，bool 和 int 都`if(foo)`将是针对零的测试，并相应地跳转。所以演员表不应该提高性能。

# .net - asp.net mvc 和 css：让菜单选项卡在选择时保持突出显示

> ID：475278
> 
> 赞同：8
> 
> 时间：2009-01-24T01:22:38.810
> 
> 标签：.net, html, asp.net-mvc, css

有一个更好的方法吗？

我有一个 HTML 帮助器扩展方法，它检查当前选项卡菜单是否是选定的，然后选择 .selected css 类。我将 html.IsSelected 链接放在每个 li 中

```
<li class="<%=Html.IsSelected(string a, string b)%>" > 
```

其中 a 是选项卡名称，b 是分配的 ViewData。

这是干净还是有更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-27T21:14:53.743

我在我的一个项目中使用的这种方法效果很好。我在每个控制器中分配 ViewData["Home"] = "activeTab" 类，并在视图中使用空字符串的默认值，如下所示。如果采用该 viewData 字典的值，这将使选项卡处于活动状态。很简单也很干净。

您的家庭控制器将如下所示：

```
 ViewData["Home"] = "activeTab";

        return View("Index");
    } 
```

视图将如下所示：

```
<li class="<%= ((string)ViewData["Home"] ?? "") %>"><%= Html.ActionLink("Home", "Index", "Home")%></li>
<li class="<%= ((string)ViewData["About"] ?? "") %>"><%= Html.ActionLink("About", "About", "Home")%></li> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T10:20:16.717

你也可以看看之前的建议：

> [在 ASP.NET MVC 中使用控制器和用户控件设置活动选项卡的简单方法？](https://stackoverflow.com/questions/287679/an-easy-way-to-set-the-active-tab-using-controllers-and-a-usercontrol-in-asp-net)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-24T01:56:22.737

如果您可以使用 javascript 解决方案，请查看[jQuery UI Accordion](http://api.jqueryui.com/accordion/)插件如何处理此问题。本质上，您可以通过在页面加载时检查请求 url 来根据控制器选择突出显示的选项卡。

或者，您可以为每个选项卡设置一个与选项卡的类值相对应的 ViewBag 项。将当前选项卡的值设置为活动的 css 类，将其他选项卡的值设置为空（或它们的默认值）。然后你可以使用：

```
<li id="HomeTab" class="<%= ViewBag.HomeTabClass %>" />
<li id="OtherTab" class="<%= (string)ViewBag.OtherTabClass %>" /> 
```

在您的控制器中，您将为 ViewData 变量设置正确的值。

```
ViewBag.HomeTabClass = "tab activeTab";
ViewBag.OtherTabClass = "tab"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-28T01:35:43.747

我试图让这个工作没有运气。

你的 CSS 是什么样的？我的在下面。

.activeTab { 背景：#FFFFFF; 颜色：#000000; }

我将它与母版页而不是主页视图一起使用，不确定这是否会影响它。

# gdb - 当程序使用文件 X 中的任何函数时，使用 gdb 停止程序

> ID：475283
> 
> 赞同：21
> 
> 时间：2009-01-24T01:23:13.020
> 
> 标签：gdb

我想知道在使用某个文件中的函数时是否有任何方法可以停止程序。理想情况下，我正在寻找的是：

```
GDB Stop when use a function from file foo.cpp 
```

这样做的原因是因为我正在调试一个不属于我的代码，并且我不确切知道哪些函数被调用，哪些函数没有被调用。GDB 中是否有一个函数可以做我正在寻找的事情，或者有任何其他推荐的方法来做类似的事情？

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-25T17:53:44.323

第 1 步：构建`foo.cpp`
我能想到的最简单方法中定义的所有函数的列表（假设你有`binutils`GNU `grep`）：

```
nm a.out | grep ' T ' | addr2line  -fe a.out |
  grep -B1 'foo\.cpp' | grep -v 'foo\.cpp' > funclist 
```

第 2 步：构建一个 GDB 脚本，它将在上述每个函数上设置一个断点：

```
sed 's/^/break /' funclist > stop-in-foo.gdb 
```

[显然，步骤 1 和 2 可以合并；-]

第三步：实际设置断点：

```
gdb a.out
(gdb) source stop-in-foo.gdb 
```

看看[这个](https://stackoverflow.com/questions/311840/tool-to-trace-local-function-calls-in-linux#312058)答案，一个更简单的方法（如果你在 Fedora Linux 上）找出调用了哪些 foo.cpp 函数：

```
ftrace -sym='foo.cpp#*' ./a.out 
```

太糟糕了[ftrace](http://sourceware.org/frysk/manpages/ftrace.1.html)手册页说这还没有实现。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-07-29T13:25:57.043

**`rbreak regex`**

在与正则表达式 regex 匹配的所有函数上设置断点。此命令在所有匹配项上设置一个无条件断点，打印它设置的所有断点的列表。一旦设置了这些断点，它们将被视为使用 break 命令设置的断点。您可以删除它们、禁用它们或使它们像任何其他断点一样有条件。

正则表达式的语法是与“grep”等工具一起使用的标准语法。请注意，这与 shell 使用的语法不同，因此例如 foo* 匹配所有包含 fo 后跟零个或多个 os 的函数。您提供的正则表达式有一个隐含的 .* 前导和尾随，因此要仅匹配以 foo 开头的函数，请使用 ^foo。

在调试 C++ 程序时，rbreak 对于在不是任何特殊类成员的重载函数上设置断点很有用。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-06-14T08:03:19.783

**`rbreak foo.cpp:.`**

这里`.`匹配任何东西，因此会破坏 file 的所有功能`foo.cpp`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-25T19:40:04.217

Employed Russian 的回答看起来很好，但既然你说：

> 我不确切知道调用了哪些函数，没有调用哪些函数。

由代码覆盖工具（如[gcov](http://gcc.gnu.org/onlinedocs/gcc/Gcov.html)或涉及[Valgrind](http://valgrind.org/)的工具）生成的哪些函数被命中的报告会是解决您问题的好方法吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T19:48:37.337

您可以使用命令：

```
break foo.cpp:function-name 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T01:32:30.133

gdb 断点有几种语法...[请参见此处。](http://theory.uwinnipeg.ca/localfiles/infofiles/gdb/gdb_29.html#SEC29)

它不会破坏文件中的任何功能......

编辑：你可以做一些愚蠢的事情，比如让所有函数调用一个虚拟函数 void foo(void)，并在里面设置断点。至少你会破坏文件内部，并且应该很容易找到文件 X 侧的哪个函数被调用。

# php - mysqli::real_escape_string 的对应物？

> ID：475284
> 
> 赞同：0
> 
> 时间：2009-01-24T01:23:51.850
> 
> 标签：php, mysql, mysqli

带斜线（）？那太蹩脚了，所以4.0。什么是 mysqli::real_escape_string 的 5.0 版本，它去除了为 SQL 查询添加的所有斜杠？

还有一些问题：

1.  尝试更新记录并在文本字段中添加单引号，结果 phpMyAdmin 用单引号而不是斜杠转义字符串 - 例如，单引号被转义为 ''（2 个单引号）而不是 \' - 什么功能phpMyAdmin 使用还是它自己的？那么，mysql 支持两种转义字符串的方法，即斜杠和单引号？

2.  我是否总是必须取消从 mysql 中选择的字符串？因为'你知道它在插入时被削减了。但我认为我不必这样做。

任何想法，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T01:33:13.873

使用[PDO](http://php.net/pdo)代替任何`mysql[i]`/ `pgsql`/... 扩展。

但是，如果您只是想扭转魔术引号造成的损害，`stripslashes()`那么这正是您要寻找的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T01:38:49.057

如果您不想使用 PDO，并且正在使用 mysqli，则应该使用准备好的语句，因此您不必担心使用 mysql_real_escape_string_i_mean_it_this_time 之类的东西转义引号。

更具体地说，您可以调用[mysqli->prepare](http://ca.php.net/manual/en/mysqli.prepare.php)来准备您的查询。调用[mysqli_stmt->bind_param](http://ca.php.net/manual/en/mysqli-stmt.bind-param.php)设置参数值。并且，调用[mysqli_stmt->execute](http://ca.php.net/manual/en/mysqli-stmt.execute.php)来执行查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T02:31:07.907

`ini_set('magic_quotes_runtime', false);`

# c# - 使用 C# 更改 XML 文件中的节点名称

> ID：475293
> 
> 赞同：17
> 
> 时间：2009-01-24T01:31:14.033
> 
> 标签：c#, xml

我有一大堆具有以下结构的 XML 文件：

```
<Stuff1>
  <Content>someContent</name>
  <type>someType</type>
</Stuff1>
<Stuff2>
  <Content>someContent</name>
  <type>someType</type>
</Stuff2>
<Stuff3>
  <Content>someContent</name>
  <type>someType</type>
</Stuff3>
...
... 
```

我需要将每个“内容”节点名称更改为 StuffxContent；基本上将父节点名称添加到内容节点的名称。

我计划使用该`XMLDocument`课程并找出一种方法，但我想我会问是否有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2010-12-13T22:17:23.757

(1.) [XmlElement / XmlNode].Name 属性是只读的。

(2.) 问题中使用的 XML 结构很粗糙，可以改进。

(3.) 无论如何，这是给定问题的代码解决方案：

```
String sampleXml =
  "<doc>"+
    "<Stuff1>"+
      "<Content>someContent</Content>"+
      "<type>someType</type>"+
    "</Stuff1>"+
    "<Stuff2>"+
      "<Content>someContent</Content>"+
      "<type>someType</type>"+
    "</Stuff2>"+
    "<Stuff3>"+
      "<Content>someContent</Content>"+
      "<type>someType</type>"+
    "</Stuff3>"+
  "</doc>";

XmlDocument xmlDoc = new XmlDocument();
xmlDoc.LoadXml(sampleXml);

XmlNodeList stuffNodeList = xmlDoc.SelectNodes("//*[starts-with(name(), 'Stuff')]");

foreach (XmlNode stuffNode in stuffNodeList)
{
    // get existing 'Content' node
    XmlNode contentNode = stuffNode.SelectSingleNode("Content");

    // create new (renamed) Content node
    XmlNode newNode = xmlDoc.CreateElement(contentNode.Name + stuffNode.Name);

    // [if needed] copy existing Content children
    //newNode.InnerXml = stuffNode.InnerXml;

    // replace existing Content node with newly renamed Content node
    stuffNode.InsertBefore(newNode, contentNode);
    stuffNode.RemoveChild(contentNode);
}

//xmlDoc.Save 
```

PS：我来这里是为了寻找一种更好的重命名节点/元素的方法；我还在找。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-02T10:16:18.580

我发现重命名节点的最简单方法是：

```
xmlNode.InnerXmL = newNode.InnerXml.Replace("OldName>", "NewName>") 
```

不要包含开头`<`以确保关闭`</OldName>`标签也被重命名。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-02-17T11:01:44.237

我使用此方法重命名节点：

```
/// <summary>
/// Rename Node
/// </summary>
/// <param name="parentnode"></param>
/// <param name="oldname"></param>
/// <param name="newname"></param>
private static void RenameNode(XmlNode parentnode, string oldChildName, string newChildName)
{
    var newnode = parentnode.OwnerDocument.CreateNode(XmlNodeType.Element, newChildName, "");
    var oldNode = parentnode.SelectSingleNode(oldChildName);

    foreach (XmlAttribute att in oldNode.Attributes)
        newnode.Attributes.Append(att);
    foreach (XmlNode child in oldNode.ChildNodes)
        newnode.AppendChild(child);

    parentnode.ReplaceChild(newnode, oldNode);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-23T11:17:00.443

也许更好的解决方案是遍历每个节点，并将信息写入新文档。显然，这将取决于您将来如何使用数据，但我建议重新格式化与 FlySwat 建议的相同......

```
<stuff id="1">
    <content/>
</stuff> 
```

我还建议使用最近添加的 XDocument 将是创建新文档的最佳方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T10:29:59.230

我会回答更高的问题：你为什么要尝试这个使用`XmlDocument`？

我认为实现您的目标的最佳方法是一个简单的 XSLT 文件
，它匹配“CONTENTSTUFF”节点并输出“CONTENTS”节点......

看不出有什么理由买这么重的枪……

无论哪种方式，如果您仍希望使用 C# 样式，
请使用`XmlReader`+`XmlWriter`而不是`XmlDocument`出于内存和速度目的。 `XmlDocument`将整个 XML 存储在内存中，并且对于 Traversing once 来说非常繁重......

如果您多次访问该元素（不是这里的情况），XmlDocument 就很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-24T21:10:25.003

我不是 XML 方面的专家，在我的例子中，我只需要将 HTML 文件中的所有标记名称设置为大写，以便在 XmlDocument 中使用 GetElementsByTagName 进行进一步操作。我需要大写的原因是，对于 XmlDocument，标签名称区分大小写（因为它是 XML），并且我不能保证我的 HTML 文件在标签名称中具有一致的大小写。

所以我这样解决它：我使用 XDocument 作为中间步骤，您可以在其中重命名元素（即标记名称），然后将其加载到 XmlDocument 中。这是我的 VB.NET 代码（C# 代码非常相似）。

```
Dim x As XDocument = XDocument.Load("myFile.html")
For Each element In x.Descendants()
  element.Name = element.Name.LocalName.ToUpper()
Next
Dim x2 As XmlDocument = New XmlDocument()
x2.LoadXml(x.ToString()) 
```

就我的目的而言，它运行良好，但我知道在某些情况下，如果您正在处理纯 XML 文件，这可能不是一个解决方案。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2018-01-24T07:35:57.273

将其作为字符串加载并在整个批次上进行替换..

```
 String sampleXml =
  "<doc>"+
    "<Stuff1>"+
      "<Content>someContent</Content>"+
      "<type>someType</type>"+
    "</Stuff1>"+
    "<Stuff2>"+
      "<Content>someContent</Content>"+
      "<type>someType</type>"+
    "</Stuff2>"+
    "<Stuff3>"+
      "<Content>someContent</Content>"+
      "<type>someType</type>"+
    "</Stuff3>"+
  "</doc>"; 

    sampleXml = sampleXml.Replace("Content","StuffxContent") 
```

* * *

## 回答 #8

> 赞同：-34
> 
> 时间：2009-01-24T01:47:00.570

您提供的 XML 表明有人完全忽略了 XML 的重点。

而不是拥有

```
<stuff1>
   <content/>
</stuff1> 
```

你应该有：/

```
<stuff id="1">
    <content/>
</stuff> 
```

现在您将能够使用 Xpath 遍历文档（即，//stuff[id='1']/content/）节点的名称不应该用于建立身份，您可以使用属性来建立身份。

按照您的要求，将 XML 加载到 xml 文档中，然后简单地遍历重命名它们的第一级子节点。

伪代码：

```
foreach (XmlNode n in YourDoc.ChildNodes)
{        
    n.ChildNode[0].Name = n.Name + n.ChildNode[0].Name;
}

YourDoc.Save(); 
```

但是，我强烈建议您实际修复 XML 以便它有用，而不是进一步破坏它。

# c# - Visual Studio 2005 搜索内存

> ID：475300
> 
> 赞同：4
> 
> 时间：2009-01-24T01:35:16.523
> 
> 标签：c#, visual-studio, search, memory

我不认为这存在，但无论如何我都会把它扔在那里。调试时是否可以在内存中搜索值？

例如，如果我有一个字符串“uniqueString”缓存在内存中的某处，但我不知道它存储在哪个变量下——我可以搜索它吗？如，找出哪些变量具有“uniqueString”作为它们的值？

这适用于 C# 托管代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T12:38:49.880

windbg 将让您直接进行搜索。's' 是您要查找的命令，这是一个非常好的[备忘单](http://www.software.rkuster.com/windbg/cmd.htm)。sos 扩展允许您在托管代码中扫描字符串对象，尽管 s 命令也应该找到它们（必须使用 unicode 感知搜索）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T06:48:20.920

您在 Visual Studio 中拥有相同的功能，[可](http://msdn.microsoft.com/en-us/library/ms171363(VS.80).aspx)在即时窗口中使用。虽然，您必须以某种方式手动限制要搜索的地址范围（请参阅链接中的语法）。

（编辑）顺便说一句，您也可以轻松地从 VS 创建转储：Debug->Save Dump As。

# c++ - 为 C++ 自动生成单元测试的工具？

> ID：475301
> 
> 赞同：11
> 
> 时间：2009-01-24T01:37:43.133
> 
> 标签：c++, unit-testing

我们在共享库中拥有大量用于数十种产品的遗留 C++ 代码。忽略自动生成测试的利弊（这是另一天的讨论），是否有人对可以分析源代码并生成一组测试来执行该代码的工具有任何建议？

理想情况下，它是一个 Windows 工具，如果绝对必要，Linux 也可以。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T02:08:56.110

我曾多次听到[Parasoft提到过。](http://www.parasoft.com/jsp/solutions/cpp_solution.jsp)我从未使用过他们的产品，但文章[“无畏地改变软件”](http://www.ddj.com/development-tools/206105233?pgno=1)（由他们的一名员工撰写）以非销售方式涵盖了自动测试生成（他们称之为“行为回归测试”），并简要介绍了他们的软件。

# python - PostgreSQL 过程语言：选择？

> ID：475302
> 
> 赞同：3
> 
> 时间：2009-01-24T01:38:35.253
> 
> 标签：python, postgresql

两年来，我一直在使用 PostgreSQL，玩弄维基百科的数百万超链接等。我要么直接通过发送 SQL 命令来做我的事情，要么我在 python 中编写一个客户端脚本来管理一百万个查询，当这不能有效地（高效且有效地）手动完成时。

我会在我的 32 位笔记本电脑上运行我的 python 脚本，并让它与运行 PostgreSQL 的 6000 美元的 64 位服务器通信；因此，我将拥有一个额外的 2.10 Ghz、3 GB RAM、psyco 和一个多线程 SQL 查询管理器。

我现在意识到是时候升级了。我需要学习使用过程语言（PL）的服务器端脚本；我真的需要减少网络流量及其固有的序列化开销。

现在，我真的不想研究所有的 PL。知道我已经知道 python，并且我正在寻找努力和语言效率之间的方法，你们认为我应该安装、学习和使用什么 PL，为什么以及如何？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T02:02:11.460

既然你已经知道 python，那么 PL/Python 应该是值得一看的。而且您听起来像是为数据库查询编写 SQL，因此 PL/SQL 是它的自然扩展。

PL/SQL 感觉就像 SQL，只是包含了你对 SQL 所期望的所有东西，比如整行的变量和过程语言的通常控制结构。它适合您通常与数据库交互的方式，但它并不是有史以来最优雅的语言。我不能说任何关于 PL/Python 的事情，因为我从来没有使用过它，但是既然你知道 python，它应该很容易翻阅[一些例子](http://www.postgresql.org/docs/8.3/interactive/plpython-funcs.html)，看看你是否喜欢它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T12:13:14.830

为什么不能在数据库服务器上运行 Python？这具有最少的复杂性——您可以运行已有的程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T14:34:25.780

我和你的情况完全相同，一段时间后放弃 PL/SQL 后选择了 PL/Python。这是一个很好的决定，回顾过去。有些事情让我觉得 unicode 问题（客户端编码、字节序列）和特定的 postgres 数据类型（bytea）。

# php - 从 osCommerce 中的类别中列出随机产品

> ID：475314
> 
> 赞同：0
> 
> 时间：2009-01-24T01:47:57.370
> 
> 标签：php, sql, oscommerce

我被要求为 osCommerce 在线商店实施随机产品列表。我可以做一些基本的 PHP，但商店使用自己的框架，我不知道该怎么做。首先，我尝试在首页创建一个随机列表：我打开 index.php 并找到

```
include(DIR_WS_MODULES . FILENAME_UPCOMING_PRODUCTS); 
```

我在之后添加的行

```
include(DIR_WS_MODULES . "random_products.php"); 
```

但我应该在里面放什么？我检查了即将到来的_products.php 以找到一些我可以修改的 SQL，并且可能对产品进行了循环，但其中没有这样的东西。那么如何在不必检查表结构/包含文件的情况下做到这一点呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T02:59:06.230

解决了。我使用了更清晰的 new_products.php：我修改了标题并将 SQL 中的顺序更改为 RAND()。

# .net - 仅在我的机器上发生异常：找不到方法：WaitHandle.WaitOne(Int32)

> ID：475319
> 
> 赞同：5
> 
> 时间：2009-01-24T01:53:42.007
> 
> 标签：.net

异常仅发生在我的机器上引用的 .dll 内：找不到方法：WaitHandle.WaitOne(Int32)

这似乎是一个 .NET 运行时版本问题，但我已经安装了 .NET 3.5 并重新启动，但仍然看到同样的问题。Gacutil 显示 mscorlib 版本 2.0.0.0。

我们已经修改了代码以调用两个参数 WaitOne() API，并且所有机器上都可以正常工作。但是，了解为什么某些安装了 .NET 3.5 的机器不包含此函数的单参数版本会很有帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-24T02:01:09.793

从[MSDN](http://msdn.microsoft.com/en-us/library/cc189907.aspx)看起来像是`WaitHandle.WaitOne(Int32)`在 SP1 中添加的。在源代码、安装程序中检查这一点，或使用 2 参数版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T02:18:29.073

感谢您的建议。

Google Groups 帖子还指出了与 API (.NET 2.0 SP2) 的框架兼容性问题。重申一下，在机器上安装 3.5 后，我们仍然看到异常。.NET 3.5 应该包含从 2.0 SP2 开始的所有 API 添加。

从 MSDN 页面：支持：3.5 SP1、3.0 SP2、2.0 SP2

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T02:03:07.620

我发现了一个可能适用的[Google Groups 结果。](http://groups.google.com/group/ausdotnetlist/browse_thread/thread/0a1e7a7351c03939)

# c++ - SAX 在 C++ 中解析用户对象的片段？

> ID：475324
> 
> 赞同：1
> 
> 时间：2009-01-24T01:56:03.097
> 
> 标签：c++, parsing, sax

任何人都可以分享一段代码，他们在 C++ 中使用 SAX 解析器解析用户定义的对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T02:10:35.297

SAX 代表[XML 的简单 API](http://en.wikipedia.org/wiki/Simple_API_for_XML)。

SAX 仅用于解析 XML 文件。因此，如果您想使用 SAX 从 C++ 解析对象，唯一有意义的方法是先将该对象序列化为 XML。

您想要使用 SAX XML 解析器的原因是您可能有一个非常大的 XML 文件，并且您只想读取它的一部分，这样做会使用更少的 RAM。

为什么要使用 SAX 解析器的一个很好的例子是，如果您将字符串的 serizlied std::vector 放入 XML 文件中。假设这个向量包含数百万个条目。那么你不能一次将整个 XML 文件读入内存。您将不得不改用 SAX 解析器。

SAX 解析器有许多不同的实现，但您甚至可以自己创建一个，非常容易地绘制一个[有限状态机](http://en.wikipedia.org/wiki/Finite_state_machine)。当您进入读取完整元素的状态时，您将调用回调函数。

您还可以使用 LibXML、MSXML、Xerces-C++ XML Parser 以及更多用于 SAX 解析的库。

回到你原来的问题。您的 SAX 解析器将简单地解析对象的 XML 表示，然后填充对象的成员。或者，如果您的对象是容器，请添加容器的元素。

# java - 2D 构造区域几何的最佳工具

> ID：475329
> 
> 赞同：3
> 
> 时间：2009-01-24T01:58:44.883
> 
> 标签：java, c, apache-flex, geometry

处理 2D 构造区域几何的最佳工具/库（任何语言）是什么？

也就是说，一个库使用或多或少的任意二维形状并提供联合、交集、差异和异或。

我的基线是[java.awt.geom.Area](http://java.sun.com/javase/6/docs/api/java/awt/geom/Area.html)类，如果速度慢的话也可以使用。外面有什么更好的？我特别感兴趣的是 Java、ActionScript/Flex 和 C 库，但我对任何人都开放。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T13:38:38.230

想到两个选项

1.  C 语言的[开罗图形](http://www.cairographics.org/)
2.  用于 C++ 的[Antigrain](http://www.antigrain.com/)

我建议开罗。这是

*   成熟
*   经过测试（在 GTK+ 和 Mozilla 内部使用）
*   支持（伟大的社区邮件列表、irc、web 等）
*   开源

Cairo 已经有您提到的运算符（联合、交叉、差异等），并且使用路径可以绘制您可以想象的任何形状。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T08:01:11.923

计算[几何算法库](http://www.cgal.org/)非常广泛。我上次检查时它有商业和开源许可证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T16:35:15.847

如果您在 Windows 世界中，您可以考虑使用 MFC，它具有 CRgn 和其他可用于计算这些差异的操作 - 最值得注意的是，创建剪切区域的样条线很容易 - 然后您可以轻松处理这些剪切区域 (区域、十字路口等）。

我假设由于 MFC 操作封装了 GDI——您可以直接使用 GDI 来执行相同的操作，但当然，如果您有并且不介意 MFC，那么值得一试。

# java - 如何将 FileSet 转换为 Mojo 中的文件列表

> ID：475348
> 
> 赞同：3
> 
> 时间：2009-01-24T02:15:05.180
> 
> 标签：java, maven-2

我正在编写我的第一个 Maven Mojo，在其中我想获取一个文件集并处理它引用的所有文件。

在伪代码中我想做的...

```
void myCode(org.apache.maven.model.FileSet fileSet) {
    List<java.io.File> files = FileSetTransformer.toFileList(fileSet);
    for (File f : files) {
        doSomething(f);
    }
} 
```

所以我想要的是“FileSetTransformer.toFileList”的真实代码，在我看来这是一件很常见的事情，但我似乎不知道该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-25T00:03:16.177

感谢emeraldjava，这给了我足够的答案来解决我的问题。

plexus-utils 有一个名为 FileUtils 的实用程序类，您可以添加对它的依赖项：

```
<dependency>
  <groupId>org.codehaus.plexus</groupId>
  <artifactId>plexus-utils</artifactId>
  <version>1.1</version>
</dependency> 
```

一旦你有了 FileUtils，你就可以实现 FileSetTransformer：

```
public final class FileSetTransformer {
        private FileSetTransformer () {
        }

        public static List<File> toFileList(FileSet fileSet) {
                File directory = new File(fileSet.getDirectory());
                String includes = toString(fileSet.getIncludes());
                String excludes = toString(fileSet.getExcludes());
                return FileUtils.getFiles(directory, includes, excludes);
        }

        private static String toString(List<String> strings) {
                StringBuilder sb = new StringBuilder();
                for (String string : strings) {
                        if (sb.length() > 0)
                                sb.append(", ");
                        sb.append(string);
                }
                return sb.toString();
        }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T18:02:33.673

请参阅 Maven [FileSet](http://maven.apache.org/ref/current/maven-model/apidocs/org/apache/maven/model/FileSet.html)的 javadoc并使用 getDirectory() 和 getIncludes() 方法。这是一个[现有的 maven mojo](http://code.google.com/p/birt-maven-plugin/source/browse/trunk/birt-maven-plugin/src/main/java/org/dailydev/mojo/birt/AbstractBirtMojo.java?r=20#227)的例子，它做一些类似的事情。

# theory - 在非图灵完备语言中停止

> ID：475350
> 
> 赞同：15
> 
> 时间：2009-01-24T02:23:56.517
> 
> 标签：theory, turing-complete, halting-problem

对于图灵完备的语言，停止问题无法解决，而对于某些非 TC 语言（如它总是停止的正则表达式），它可以轻松解决。

我想知道是否有任何语言同时具有停止和不停止的能力，但承认可以确定它是否停止的算法。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-24T02:36:28.270

[停止问题](http://en.wikipedia.org/wiki/Halting_problem)不适用于语言。相反，它作用于机器（即程序）：它询问给定程序是否在给定输入时停止。

也许您的意思是问它是否可以解决其他计算模型（例如您提到的正则表达式，以及 [下推自动机](http://en.wikipedia.org/wiki/Pushdown_automaton)）。

通常，可以在具有有限资源的模型中检测到停止（如正则表达式或等效的有限自动机，它们具有固定数量的状态且没有外部存储）。这很容易通过枚举所有可能的配置并检查机器是否两次进入相同的配置（表示无限循环）来完成；在资源有限的情况下，如果机器没有停止，我们可以在*必须*看到重复配置之前设置一个时间上限。

通常，具有无限资源的模型（例如，无限的 TM 和 PDA）不能进行停止检查，但最好单独调查模型及其未解决的问题。

（对不起所有的维基百科链接，但它实际上是这类问题的一个很好的资源。）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-24T03:26:50.027

是的。这种类型的一个重要类是[原始递归函数](http://en.wikipedia.org/wiki/Primitive_recursive_function)。此类包括您希望能够对数字进行的所有基本操作（加法、乘法等），以及@adrian 提到的一些复杂类（正则表达式/有限自动机、上下文无关语法/下推自动机）。但是，确实存在非原始递归的函数，例如[Ackermann 函数](http://en.wikipedia.org/wiki/Ackermann_function)。

理解原始递归函数实际上很容易。它们是您可以在没有真正递归的编程语言中获得的函数（因此函数 f 不能调用自身，无论是直接调用还是通过调用另一个函数 g 然后调用 f 等）并且没有 while 循环，而是有界的for循环。有界 for 循环类似于“for i from 1 to r”，其中 r 是程序前面已经计算过的变量；另外，我不能在 for 循环中修改。这种编程语言的要点是*每个*程序都会停止。

我们编写的大多数程序实际上都是原始递归的（我的意思是，可以翻译成这样的语言）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-24T02:49:21.070

简短的回答是肯定的，这样的语言甚至可以非常有用。

几个月前在 LtU 上有一个讨论：http: [//lambda-the-ultimate.org/node/2846](http://lambda-the-ultimate.org/node/2846)

# asp.net-mvc - 如何从示例 ASP.NET MVC 应用程序中查看 ASPNETDB 数据库？

> ID：475353
> 
> 赞同：1
> 
> 时间：2009-01-24T02:27:09.397
> 
> 标签：asp.net-mvc

一个基本的 ASP.NET MVC 应用程序似乎将用户信息存储在 App_Data\ASPNETDB 中。如何使用 VS2008 查看该数据库中的表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T06:13:05.370

谢谢。我的问题是，作为数据源，我选择了“Microsoft SQL Server”而不是“Microsoft SQL Server 数据库文件”，这是一个位于列表下方的选项。

# .net - MDI Child .Show() 方法在框架中引发 NullReferenceException

> ID：475355
> 
> 赞同：2
> 
> 时间：2009-01-24T02:28:11.360
> 
> 标签：.net, winforms, exception

以下是一个涉及的问题，我已经进行了大量研究，但到目前为止还无法解决。我很高兴找到解决方案或解决方法。虽然框架很旧（1.0），但我现阶段无法升级到 1.1 或更高版本（客户目前不愿意为转换付费），我什至不确定这是否能解决问题... 任何帮助深表感谢 ：

**平台**：.NET 1.0 VB.NET Windows Forms MDI 应用程序在 Windows XP 上运行

**问题**：一个 MDI 子窗口 (child1) 调用`.Show()`不同 MDI 子窗口 (child2) 的方法并`NullReferenceException`抛出 a。

这只发生在一个特定的窗体 (child1) 中，并且仅当该子窗体处于最大化状态并且 MDI 父窗口也处于最大化状态时。

对于从 child1 中的代码打开的任何其他子表单，都会引发异常（即，该错误不会与打开一种类型的表单隔离）。

仅当从调试器运行“抛出异常时进入调试器”时才会抛出异常（尽管此错误稍后会出现，这是真正的问题）。就捕获到异常但未对其进行任何处理（参见下面的反映代码）而言，这种行为似乎在框架中得到了解释。

该异常似乎是从框架（1.0）本身内部抛出的。请参阅下面的堆栈跟踪：

```
system.windows.forms.dll!System.Windows.Forms.NativeWindow::WindowClassCallback(__int32 hWnd = 461572, __int32 msg = 36, __int32 wparam = 0, __int32 lparam = 1239164) + 0x48 bytes 
    system.windows.forms.dll!System.Windows.Forms.UnsafeNativeMethods::CreateWindowEx(__int32 dwExStyle = 327744, String* lpszClassName = "WindowsForms10.Window.8.app13", String* lpszWindowName = "Diary Entry: ROSIE MILES", __int32 style = 1204748288, __int32 x = -2147483648, __int32 y = -2147483648, __int32 width = 480, __int32 height = 380, __int32 hWndParent = 920114, __int32 hMenu = 0, __int32 hInst = 285212672, System.Object pvParam = null) + 0x3c bytes  
    system.windows.forms.dll!System.Windows.Forms.NativeWindow::CreateHandle(System.Windows.Forms.CreateParams cp = {System.Windows.Forms.CreateParams}) + 0x1d6 bytes  
    system.windows.forms.dll!System.Windows.Forms.Control::CreateHandle() + 0x19a bytes 
    system.windows.forms.dll!System.Windows.Forms.Form::CreateHandle() + 0x12f bytes    
    system.windows.forms.dll!System.Windows.Forms.Control::get_Handle() + 0x2f bytes    
    system.windows.forms.dll!System.Windows.Forms.Form::SetVisibleCore(bool value = true) + 0x1e9 bytes 
    system.windows.forms.dll!System.Windows.Forms.Control::set_Visible(bool value = true) + 0x1e bytes  
    system.windows.forms.dll!System.Windows.Forms.Control::Show() + 0x14 bytes  
>   SpecMed.exe!SpecMed.ScheduleForm.viewScheduleMenuItem_Click(Object sender = {System.Windows.Forms.MenuItem}, System.EventArgs e = {System.EventArgs}) Line 1508 + 0xb bytes Basic
    system.windows.forms.dll!System.Windows.Forms.MenuItem::OnClick(System.EventArgs e = {System.EventArgs}) + 0x8d bytes   
    system.windows.forms.dll!MenuItemData::Execute() + 0x1e bytes   
    system.windows.forms.dll!System.Windows.Forms.Command::Invoke() + 0x4c bytes    
    system.windows.forms.dll!System.Windows.Forms.Command::DispatchID(__int32 id = 299) + 0x2c bytes    
    system.windows.forms.dll!System.Windows.Forms.Control::WmCommand(System.Windows.Forms.Message m = {System.Windows.Forms.Message}) + 0x4a bytes  
    system.windows.forms.dll!System.Windows.Forms.Control::WndProc(System.Windows.Forms.Message m = {System.Windows.Forms.Message}) + 0x1f3 bytes   
    system.windows.forms.dll!ControlNativeWindow::OnMessage(System.Windows.Forms.Message m = {System.Windows.Forms.Message}) + 0x19 bytes   
    system.windows.forms.dll!ControlNativeWindow::WndProc(System.Windows.Forms.Message m = {System.Windows.Forms.Message}) + 0xda bytes 
    system.windows.forms.dll!System.Windows.Forms.NativeWindow::Callback(__int32 hWnd = 6621754, __int32 msg = 273, __int32 wparam = 299, __int32 lparam = 0) + 0x4a bytes  
    system.windows.forms.dll!System.Windows.Forms.Application::ComponentManagerSystem.Windows.Forms.UnsafeNativeMethods+IMsoComponentManager.FPushMessageLoop(__int32 dwComponentID = 1, __int32 reason = -1, __int32 pvLoopData = 0) + 0x2c1 bytes 
    system.windows.forms.dll!ThreadContext::RunMessageLoop(__int32 reason = -1, System.Windows.Forms.ApplicationContext context = {System.Windows.Forms.ApplicationContext}) + 0x1c5 bytes  
    system.windows.forms.dll!System.Windows.Forms.Application::Run(System.Windows.Forms.Form mainForm = {SpecMed.MainForm}) + 0x34 bytes    
    SpecMed.exe!SpecMed.Program.Main() Line 15 + 0x1d bytes Basic 
```

我已经将这种方法反映在获得对问题的一些洞察力的机会上。WindowClass.Callback() 方法的代码是：

```
public IntPtr Callback(IntPtr hWnd, int msg, IntPtr wparam, IntPtr lparam)
{
    try
    {
        UnsafeNativeMethods.SetWindowLong(hWnd, -4, this.defWindowProc);
        this.targetWindow.AssignHandle(hWnd);
        return this.targetWindow.Callback(hWnd, msg, wparam, lparam);
    }
    catch (Exception)
    {
    }
    return IntPtr.Zero;
} 
```

如您所见，异常被捕获，但没有对其进行任何处理。

**用户界面表现：**

然后，此异常的原因似乎在稍后表现出来，调用 (child1) 和调用 (child2) 子窗体的行为很糟糕。

在 UI 中，即使忽略了异常，MDI 父级也会显示两个 MDI 子级控制框（即两组最小化、恢复和关闭框）和两个子级图标（见屏幕截图）。一个控制箱被禁用。

[替代文字 http://www.freeimagehosting.net/uploads/a65a085cd3.jpg](http://www.freeimagehosting.net/uploads/a65a085cd3.jpg) [替代文字 http://www.freeimagehosting.net/uploads/fcbee0eccf.jpg](http://www.freeimagehosting.net/uploads/fcbee0eccf.jpg)

关闭 child2 表单后，child1 变得无响应并且无法重新绘制。

**研究 ：**

在网上搜索，我发现了以下文章，这些文章似乎描述了相似或几乎相同的问题（但在不同的框架上），但这些解决方案都没有帮助。

[http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/66cee5a3-c743-4be6-ae63-7416b81a9688/](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/66cee5a3-c743-4be6-ae63-7416b81a9688/)（听起来完全一样的问题，但似乎从未发布过解决方案） .

[http://support.microsoft.com/kb/871045](http://support.microsoft.com/kb/871045)（类似但不一样的问题，解决方案似乎没有帮助）。

[http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework.windowsforms/topic39112.aspx](http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework.windowsforms/topic39112.aspx)：（听起来像同样的问题，但不同的框架）。

调用子窗体 (child1) 上有一些第三方控件 (Janus WinForms Suite)，我怀疑这是导致问题的原因。这些控件是 .NET 控件而不是 Activex。

**尝试的解决方案**

我尝试在 child1 上引发 MDI Parent 处理的事件，然后 MDI Parent 打开 child2。还是同样的问题。

在 child1 调用 child2.Show() 之后，我尝试设置 child2 的 MDI 父级。还是没有起色。

我尝试在 child2.InitialiseComponents() 调用之前设置 child2 的 MDI Parent。没提升。

在输入所有这些之后，我开始认为问题不在于调用 child2，而是当 child2 打开、最大化并因此将 child1 发送到它后面时如何处理 child1？

如果有人可以帮助我，或者指出我正确的方向，我肯定会很感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T03:39:41.687

**解决方法：**

我找到了一种解决方法，虽然不是特别优雅，但目前似乎可行：

通过检查调用表单是否最大化并存储它，然后可以在 .Show() 调用之前最小化（或恢复）调用表单（防止问题），然后将调用的表单 WindowState 设置为最大化。将调用的表单状态设置为最大化模拟通常应该发生的行为（除了随着表单大小的调整而闪烁）。

*代码 ：*

```
'-- workaround to prevent UI problem with maximised child form calling another maxmised child form --'
Dim isMaximised As Boolean = (WindowState = FormWindowState.Maximized)

'-- minimise the current form so the problem wont occur when we call the new child Form --'
If isMaximised Then WindowState = FormWindowState.Minimized

Dim form As DiaryEntryForm = DiaryEntryForm.GetForm(scheduleId, Me)
'-- if the calling child was originally maximised, then maximsed the called form to similute what should normally happen --'
If isMaximised Then form.WindowState = FormWindowState.Maximized
form.Show() 
```

不过，我会继续努力寻找解决方案。任何帮助表示赞赏。谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T14:47:26.873

您是否尝试将菜单合并为 MDI 子显示的一部分？如果是这样，您可能会遇到此问题

[http://support.microsoft.com/kb/895579](http://support.microsoft.com/kb/895579)

如果它是您所看到的，那里的修补程序将解决该问题。

# iphone - iPhone 模拟器默认值中的不一致默认值 (NSUserDefaults) 行为

> ID：475367
> 
> 赞同：5
> 
> 时间：2009-01-24T02:35:26.073
> 
> 标签：iphone, ios-simulator

在开发 iPhone 应用程序并尝试通过标准 NSUserDefaults 机制保存首选项时，我遇到了非常不一致的结果。我使用的代码几乎直接来自 Erica Sadun 的 iPhone Developer's Cookbook（顺便说一句很棒的书），它看起来像这样：

```
（无效）更新默认值
{
    NSMutableArray *spells = [[NSMutableArray alloc] init];
    NSMutableArray *locs = [[NSMutableArray alloc] init];

    for (DragView *dv in [boardView subviews])
    {
        [spells addObject:[dv whichSpell]];
        [locs addObject:NSStringFromCGRect([dv frame])];
    }

    [[NSUserDefaults standardUserDefaults] setObject:spells forKey:@"spells"];
    [[NSUserDefaults standardUserDefaults] setObject:locs forKey:@"locs"];
    [[NSUserDefaults standardUserDefaults] 同步];

    [法术释放]；
    [位置释放]；
}

```

这些值有时会被保存……有时会被恢复。我无法确切知道什么使它起作用或不起作用。

有没有其他人有类似的经历？关于什么可能使它起作用的任何建议？同步方法是强制写入磁盘并保存值的最佳方法，还是有更好的方法（用于生产和模拟器）。

谢谢瑞恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T03:38:44.557

您应该使用 NSKeyedArchiver 来保存您的数组，例如：

```
[[NSUserDefaults standardUserDefaults] setObject:[NSKeyedArchiver archivedDataWithRootObject:spells] forKey:@"spells"];
[[NSUserDefaults standardUserDefaults] setObject:[NSKeyedArchiver archivedDataWithRootObject:locs] forKey:@"locs"];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

你还应该确保你的 spells 类实现了 NSCoding 协议（encodeWithCoder: 和 initWithCoder:)，如果它是一个自定义类的话。看起来您的 locs 是 NSStrings，可以很好地归档。

你还需要做类似的事情

```
NSData *dataRepresentingSavedSpells = [currentDefaults objectForKey:@"spells"];
if (dataRepresentingSavedSpells != nil)
{
    NSArray *oldSpells = [NSKeyedUnarchiver unarchiveObjectWithData:dataRepresentingSavedSpells];
} 
```

从默认值加载旧值。

我在退出时使用同步写入磁盘，根据我的经验，它非常可靠。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T09:33:45.523

在 Mac OS X 上，也可能在 iPhone OS 上，默认数据库只能包含属性列表对象：NSString、NSNumber、NSArray、NSDictionary 和 NSData。

从您的代码片段中不清楚咒语是什么类型，但如果不是上述类型之一，它将不会存储在默认数据库中。您的选择是：

1.  编写一个方法，将您的对象转换为 plist 表示和从 plist 表示转换。换句话说，一种从对象创建 NSDictionary 的方法和另一种使用 NSDictionary 初始化对象的方法。您还可以选择将其存储为 NSArray 或 NSString。
2.  使您的对象实现 NSCoding 协议，然后使用 NSKeyedArchiver 将对象转换为 NSData 对象，并使用 NSKeyedUnarchiver 将其转换回来。

# c# - String.Format() 中真的需要 CultureInfo.CurrentCulture 吗？

> ID：475383
> 
> 赞同：32
> 
> 时间：2009-01-24T02:53:26.850
> 
> 标签：c#, .net, culture, string.format

您认为真正有必要提供`IFormatProvider`的方法是`String.Format(string, object)`什么？

写完整的变体更好吗

```
String.Format(CultureInfo.CurrentCulture, "String is {0}", str); 
```

要不就

```
String.Format("String is {0}", str); 
```

?

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-24T11:47:48.113

一般来说，如果要以一种独立于当前用户文化的方式（例如，在注册表中或在文件中）保存要生成的字符串，您将希望使用 InvariantCulture。

您将希望将 CurrentCulture 用于要在 UI 中呈现给当前用户的字符串（表单、报告）。

如果您在应该使用 InvariantCulture 的地方使用 CurrentCulture，则可能会出现细微的错误：只有当您有多个具有不同文化的用户访问同一注册表项或文件，或者如果用户更改了他的默认文化时，这些错误才会出现。

显式指定 CurrentCulture （如果省略 IFormatProvider 参数，则为默认值），本质上是证明您已考虑上述内容并且生成的字符串应使用当前用户的文化的文档。这就是 FxCop 建议您指定 IFormatProvider 参数的原因。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-01-24T03:29:20.630

如果您不指定`IFormatProvider`（或等效地传递`null`）大多数参数类型最终将落入根据`CultureInfo.CurrentCulture`. 有趣的是，您可以指定一个自定义`IFormatProvider`，该自定义可以在格式化参数时首先破解，或者根据其他上下文覆盖格式化文化。

请注意，这`CultureInfo.CurrentCulture`会影响参数格式，而不是资源选择；资源选择由 控制`CultureInfo.CurrentUICulture`。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-24T03:12:39.867

不，您不需要指定文化，除非您的字符串包含文化特定元素，例如小数分隔符、货币等，这些元素必须根据文化呈现。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-24T02:58:17.573

如果您关心应用程序中的本地化（全球化），这将特别有用。也就是说，如果您希望您的应用程序支持多种语言和文化特定格式，那么您应该使用它。

# html - 如何让 CSS 悬停影响不同的标签？

> ID：475384
> 
> 赞同：4
> 
> 时间：2009-01-24T02:55:22.197
> 
> 标签：html, css

假设我有以下内容：

```
<style>
    .myLabel {
      color: blue;
    }
    .myLabel:hover {
      color:red;
    }
</style>
<div>
    <img src='myimage.png' />
    <span class='myLabel'>Image Label</span>
</div> 
```

当它们悬停在跨度上时是否可以替换图像（也通过css）？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T03:23:45.743

***以前***的兄弟姐妹似乎没有任何兄弟姐妹选择器。

W3 定义了[**相邻的兄弟姐妹**](http://www.w3.org/TR/CSS2/selector.html#adjacent-selectors)和一些浏览器支持似乎可用于[**一般兄弟姐妹**](http://reference.sitepoint.com/css/generalsiblingselector)- 但是，两者都适用于***跟随***兄弟姐妹。

`:hover`所以，我认为你会发现使用设置为 div更容易完成。

而且，我从未听说过 CSS 能够改变`src`属性。关于我认为***可以***通过 CSS 更改图像的唯一方法是拥有`src`一个透明图像并更改`background-image`.

```
<style>
    .myLabel img { background-image: url('...'); }
    .myLabel span { color: blue; }
    .myLabel:hover img { background-image: url('...'); }
    .myLabel:hover span { color:red; }
</style>
<div class='myLabel'>
    <img src='transparent.png' />
    <span>Image Label</span>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T10:24:12.493

一个更简单的方法是删除`img`元素并将图像作为背景图像放在`span`. 然后你可以在你的两个 CSS 规则中控制背景图片：

```
.myLabel { color: blue; background-image:url(myimage.png) }
.myLabel:hover {color:red; background-image:url(myotherimage.png) } 
```

然后你只需要一些 CSS 来定位背景图像，并且可能为背景图像添加足够的填充以不与任何文本重叠。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T04:13:14.783

您还可以将图像放在跨度内：

```
<div class='myLabel'>
    <span>
      <img src='transparent.png' />
      Image Label
    </span>
</div> 
```

那么你的CSS将是：

```
.myLabel span:hover img { ... } 
```

仅供参考，只有 <a> 标签在 IE6 中与 :hover 一起使用（但它还是旧的）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T07:53:57.777

不，您不能以任何方式*替换*src-attribute 的值。

Jonathan Lanowski 说：而且，我从未听说过 CSS 能够改变 src 属性。关于我认为可以通过 CSS 更改图像的唯一方法是让 src 成为透明图像并更改背景图像。

牢记 IMG 元素的含义。它应该将图像显示为内容，而不是演示。如果您在 src-attribute 中放置一个透明的 .gif 或任何内容，您也会从页面中删除内容。

这同样适用于使用不同的 CSS-hover-techniques 来更改图像，只要您在 src-attribute 中没有实际图像，您仍然可以删除内容。另外，只要您的文档按原样标记，您将无法在悬停跨度元素时更改图像。

那么，这是一个典型的 Javascript 工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T03:07:41.157

一种技术是让单个图像文件中包含多个图像，然后使用 css 规则更改要显示的文件中的偏移量。

见：[http ://www.alistapart.com/articles/sprites/](http://www.alistapart.com/articles/sprites/)

特别是“悬停”部分。

他们在这里提供了一个功能示例：

[http://www.alistapart.com/d/sprites/ala-image3.html](http://www.alistapart.com/d/sprites/ala-image3.html)

编辑：我刚刚意识到您要求更改图像，然后将鼠标悬停在**跨度**而不是图像本身上。为此，我相信您需要使用 javascript。

# ruby-on-rails - Twitter-like login system (passing parameters in URL?)

> ID：475401
> 
> 赞同：1
> 
> 时间：2009-01-24T03:05:54.140
> 
> 标签：ruby-on-rails, web-applications, parameters, routing, twitter

How do you pass parameters in a URL? I'm trying to design a login system similar to Twitter's. Notice how you can either login to the main page of www.twitter.com or you can go directly to customised pages such as www.twitter.com/lancearmstrong and www.twitter.com/rails . That's exactly what I need for my project. Thanks.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T09:34:42.577

in config/routes.rb create a rule like this:

```
 map.connect '/:user_name', :controller => 'login', :action => 'custom' 
```

or somethjing similar.

then in your controller pick up the user name with params[:user_name]

This should go at the end of the file near the default rules. The system chooses the first route that matches the incoming URL. so if you have a rule like:

```
 map.connect '/foo', :controller => 'foo', :action => 'bar' 
```

it will need to come before the login rule. - bear in mind that if you do this you will have to disallow 'foo' as a username :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T03:27:06.860

Look into [Apache's mod_rewrite module](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html) for information on directing `www.mysite.com/asdf` to a CGI script with the argument "`asdf`".

# java - Maven Embedded Jetty Container 无法加载 Taglibs：无法初始化 TldLocationsCache

> ID：475402
> 
> 赞同：1
> 
> 时间：2009-01-24T03:06:28.053
> 
> 标签：java, maven-2, build, jetty

我正在使用 Maven Cargo 插件来启动一个 Jetty Web 容器，以便在单独的项目模块中运行一些集成测试。

当我将标记库添加到 jsp 页面并尝试从集成测试中击中它们时，就会出现我正在与之斗争的问题。当 jetty 尝试编译页面时，它会因以下错误而失败：

```
org.apache.jasper.JasperException: Unable to initialize TldLocationsCache: null 
```

当在已安装的 Tomcat 容器中运行或在命令行上通过 maven 运行的独立 Jetty 中运行时，Web 应用程序运行良好，所以我认为问题一定与货物如何嵌入码头以及码头如何编译应用程序有关。

我试过在分叉和非分叉模式下运行，将标签库添加到容器类路径中，在 web.xml 中明确定义标签库并且那里没有配置......一切都无济于事。

这是我用来调试的测试项目：

web.xml

```
<?xml version='1.0' encoding='UTF-8'?>
<web-app version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">

<display-name>taglibs-test</display-name>

<jsp-config>
    <taglib>
        <taglib-uri>http://java.sun.com/jsp/jstl/core</taglib-uri>
        <taglib-location>/WEB-INF/tld/c.tld</taglib-location>
    </taglib>
</jsp-config> 
```

以及测试模块 pom.xml：

```
<?xml version="1.0" encoding="UTF-8"?> 
```

http://maven.apache.org/maven-v4_0_0.xsd">

```
...

<build>

        <!-- Integration Test Embedded Servlet Container -->
        <plugin>
            <groupId>org.codehaus.cargo</groupId>
            <artifactId>cargo-maven2-plugin</artifactId>
            <configuration>
                <wait>false</wait>
                <container>
                    <containerId>jetty6x</containerId>
                    <type>embedded</type>
                    <log>${project.build.directory}/log</log>
                    <dependencies>
                        <dependency>
                            <groupId>javax.servlet</groupId>
                            <artifactId>jstl</artifactId>
                        </dependency>
                        <dependency>
                            <groupId>taglibs</groupId>
                            <artifactId>standard</artifactId>
                        </dependency>
                    </dependencies>
                    <systemProperties>
                        <DEBUG>true</DEBUG>
                    </systemProperties>
                </container>
                <configuration>
                    <properties>
                        <cargo.servlet.port>8090</cargo.servlet.port>
                        <cargo.logging>high</cargo.logging>
                    </properties>
                    <deployables>
                        <deployable>
                            <groupId>test</groupId>
                            <artifactId>web</artifactId>
                            <type>war</type>
                            <properties>
                                <context>taglibs-test</context>
                            </properties>
                        </deployable>
                    </deployables>
                </configuration>
            </configuration>
            <executions>
                <execution>
                    <id>start-container</id>
                    <phase>test-compile</phase>
                    <goals>
                        <goal>start</goal>
                    </goals>
                </execution>
                <execution>
                    <id>stop-container</id>
                    <phase>package</phase>
                    <goals>
                        <goal>stop</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build> 
```

这是错误的堆栈跟踪：

```
 2009-01-24 13:53:06.766::WARN:  /taglibs-test/index.jsp: 
org.apache.jasper.JasperException: Unable to initialize TldLocationsCache: null
    at org.apache.jasper.compiler.TldLocationsCache.init(TldLocationsCache.java:253)
    at org.apache.jasper.compiler.TldLocationsCache.getLocation(TldLocationsCache.java:224)
    at org.apache.jasper.JspCompilationContext.getTldLocation(JspCompilationContext.java:526)
    at org.apache.jasper.compiler.Parser.parseTaglibDirective(Parser.java:422)
    at org.apache.jasper.compiler.Parser.parseDirective(Parser.java:492)
    at org.apache.jasper.compiler.Parser.parseElements(Parser.java:1552)
    at org.apache.jasper.compiler.Parser.parse(Parser.java:126)
    at org.apache.jasper.compiler.ParserController.doParse(ParserController.java:211)
    at org.apache.jasper.compiler.ParserController.parse(ParserController.java:100)
    at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:155)
    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:295)
    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:276)
    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:264)
    at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:563) 
```

我已经在 jasper 的 TldLocationsCache 中追踪到以下几行：

```
 private void init() throws JasperException {
        if (initialized) return;
        try {
            processWebDotXml();
            scanJars();
            processTldsInFileSystem("/WEB-INF/");
            initialized = true;
        } catch (Exception ex) {
            throw new JasperException(Localizer.getMessage(
                    "jsp.error.internal.tldinit", ex.getMessage()));
        }
    } 
```

[http://svn.apache.org/repos/asf/tomcat/jasper/tc6.0.x/src/share/org/apache/jasper/compiler/TldLocationsCache.java](http://svn.apache.org/repos/asf/tomcat/jasper/tc6.0.x/src/share/org/apache/jasper/compiler/TldLocationsCache.java)

任何帮助是极大的赞赏！！

凸轮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-27T10:10:23.400

提交的错误报告：http: [//jira.codehaus.org/browse/CARGO-651](http://jira.codehaus.org/browse/CARGO-651)

# gcc - 如何使这个 GCC 警告成为错误？

> ID：475407
> 
> 赞同：34
> 
> 时间：2009-01-24T03:10:41.150
> 
> 标签：gcc, gcc-warning

我从 GCC 得到这个警告：

> 警告：不能通过 '...' 传递非 POD 类型 'class Something' 的对象；调用将在运行时中止

这是非常致命的，尤其是因为它调用了中止。为什么这不是错误？我想让它成为一个错误，但是：

1.  如何使特定警告成为错误？
2.  是哪个警告？根据*[3.8 Options to Request or Suppress Warnings](http://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html)*，`-Wno-invalid-offsetof`它看起来像是隐藏它的标志，但事实并非如此。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-24T03:13:59.180

我不确定正确的警告是什么，但是一旦找到它，您可以使用以下内容更改其配置（以“格式”为例）：

```
#pragma GCC diagnostic error "-Wformat" 
```

或者正如[*strager*指出的那样](https://stackoverflow.com/questions/475407/make-one-gcc-warning-an-error/475414#475414)：

```
gcc -Werror=format ... 
```

我已经为此检查了 gcc 源，并且无法通过命令行标志禁用此特定警告。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-26T01:56:12.490

`-Werror=specific-warning`将`-Wspecific-warning`在 GCC 4.3.x 或更高版本中将指定转换为错误。在 4.1.2 中，仅`-Werror-implicit-function-declaration`适用。请注意连字符而不是等号——它仅适用于特定情况，不适用于其他情况。这是更严重的常见警告之一，将其变为错误绝对很方便。

除此之外，旧版本的 GCC 似乎只提供了`-Werror`使每个最后一个警告都成为错误的大锤。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-24T03:17:01.060

听起来还有很多其他警告，您不想变成错误（使用*[-Werror](https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#index-Werror)*标志）。一般来说，修复所有警告是一种很好的做法。使用*-Werror 会*强制执行此操作。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-24T03:15:47.507

您可以使用*[-Werror](https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#index-Werror)*编译器标志将所有或部分警告转换为错误。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-12-16T13:51:35.547

您可以使用[-fdiagnostics-show-option](https://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Message-Formatting-Options.html#index-fno-diagnostics-show-option)查看适用于特定警告的 -W 选项。

不幸的是，在这种情况下，没有任何特定选项可以涵盖该警告。

看来 GCC 4.5 会对此提供更好的支持。

# html - XHTML 中的 WBR 替代方案

> ID：475408
> 
> 赞同：2
> 
> 时间：2009-01-24T03:10:46.453
> 
> 标签：html, css, xhtml, wbr

我一直在表格的标题单元格中使用标签，因此我可以控制浏览器在哪里打断长词。这很好用，但它不兼容 XHTML。使用 wbr 标记的最佳替代方法是什么，即有效的 XHTML？例子：

```
<table>
  <thead>
    <tr><th>ThisIsAReally<wbr />LongWord<th></tr>
  </thead>
  <tbody>
    <tr><td>...</td></tr>
    <tr><td>...</td></tr>
    <tr><td>...</td></tr>
  </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T03:28:38.900

[quirksmode](http://www.quirksmode.org/oddsandends/wbr.html)有解决办法

# iphone - iOS 应用图标的尺寸、文件类型和 ppi 分辨率是多少？

> ID：475410
> 
> 赞同：20
> 
> 时间：2009-01-24T03:12:32.863
> 
> 标签：iphone, ios, icons

Apple 发布的定制 iPhone 应用程序所需的图标规范是什么？

> 57x57，PNG，无透明度，无图层，72 PPI
> 
> 512x512、TIFF 或 JPEG、无透明度、无图层、72 PPI

注意：iPhone OS 应用圆角、可选的光泽和其他效果

还要有一个带有应用程序名称的大版本徽标，以防 Apple 联系您需要一个用于营销目的的版本。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-24T05:14:53.910

图标应该是 57x57 像素的 PNG。Apple 生成的 PNG 的 PPI 为 72.01，所以我猜这个范围内的东西可以正常工作。不要有非常高的 PPI 否则图像无法正确渲染。

如果您想使用自定义图标并且不让 iPhone 将光泽应用于您的图标，请在 info.plist 中添加一个名为 UIPrerenderedIcon 的键（是一个布尔值）并使其选中。

向应用商店提交应用时，您需要一个 512x512 像素版本的应用图标（此图标为 jpeg 或 tiff 格式）和至少一张应用的屏幕截图。您可以拥有该应用程序的额外 4 个屏幕截图。

**编辑** 现在图标的规格（将在 iTunes 连接中提交）和应用程序图标已更改。提交到 itunesconnect 的图标必须是 1024x1024 像素。

对于应用程序图标，您可以在此处找到详细信息 - [http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/App-RelatedResources/App-RelatedResources.html#//apple_ref/doc/ uid/TP40007072-CH6-SW1](http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/App-RelatedResources/App-RelatedResources.html#//apple_ref/doc/uid/TP40007072-CH6-SW1)

此外，请确保图标文件是非交错 PNG 文件。最近我们的一个应用程序的二进制文件被标记为无效，因为其中一个应用程序图标文件是隔行扫描的 PNG。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-24T03:16:01.390

从[这里](http://developer.apple.com/iphone/library/documentation/UserExperience/Conceptual/MobileHIG/IconsImages/chapter_14_section_2.html)：

为确保您的图标可以利用这些视觉增强功能，请提供 PNG 格式的图像：

*   尺寸为 57 x 57 像素，具有 90 度角（如果图像尺寸不是这个尺寸，iPhone OS 会缩放它）
*   没有任何光泽或光泽

将您的图标文件命名为 Icon.png 并将其放在应用程序包的顶层。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-23T01:54:23.700

截至 2012 年 5 月，Apple 官方文档包括以下图表： ![在此处输入图像描述](https://i.stack.imgur.com/BctPf.png)

这描述了必须在应用程序中可见的图标。文档还说文件必须是 jpeg 或 png，但没有指定 dpi。

您还必须在 iTunes 中包含该页面的较大副本。同样，来自苹果文档

![在此处输入图像描述](https://i.stack.imgur.com/9mEFl.png)

[此处提供完整文档。](https://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/App-RelatedResources/App-RelatedResources.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-08-11T02:14:37.093

新的 Retina 显示屏为 114 x 114 的图标。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-09T14:48:04.757

要将应用程序提交到 iTunes 商店，您需要具有以下尺寸：

*   57x57
*   72x72
*   114x114
*   228x228
*   512x512

参考：http: [//ios-funda.blogspot.in/2013/02/all-icon-size-needed-for-app-store.html](http://ios-funda.blogspot.in/2013/02/all-icon-size-needed-for-app-store.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-24T04:20:08.047

应用商店也在寻找 512x512 图标（不确定 PPI）。最好的办法是将其设计为矢量，然后您可以轻松调整大小并将其导出为任何内容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-08-18T09:52:30.863

这篇[博文](http://mrgan.tumblr.com/post/708404794/ios-app-icon-sizes)描述了所有图标大小以及它们的使用位置。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-06-19T17:56:09.127

57x57 像素 png... 您可以通过代码选择是否应用光泽效果。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-18T21:51:17.227

我在我的博文[iOS App Icons, Listed and Summarized](http://crafted-software.blogspot.com/2013/06/ios-app-icons-listed-and-summarized.html)中列出了十 (10) 个所需的应用程序图标文件。我的信息是 iOS 3、4、5 和 6 的最新信息。两个链接可带您到重要的 Apple 文档。

我展示了三个表格，每个表格都列出了所需的图标文件：

*   手持设备（iPhone、iPod touch）
*   平板设备 (iPad)
*   iTunes 和应用商店

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-12-13T09:21:42.737

> 注意：iOS 会忽略图标图像的 PPI（每英寸像素数）。您可以在任何 PPI 下创作您的图标图像，但它们的宽度和高度（以像素为单位）必须与下表中的值匹配。

这来自[Apple Technical Q&A QA1686](https://developer.apple.com/library/ios/qa/qa1686/_index.html)，还包含有关大小和文件类型的信息。

# c# - 在 C# 中 Base64 编码 PDF？

> ID：475421
> 
> 赞同：35
> 
> 时间：2009-01-24T03:19:11.243
> 
> 标签：c#, encoding, base64

有人可以提供一些关于如何做到这一点的信息吗？我可以对常规文本或字节数组执行此操作，但不确定如何处理 pdf。我先将pdf填充到字节数组中吗？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-01-24T03:23:15.277

用于[`File.ReadAllBytes`](http://msdn.microsoft.com/en-us/library/system.io.file.readallbytes.aspx)加载 PDF 文件，然后使用[`Convert.ToBase64String(bytes)`](http://msdn.microsoft.com/en-us/library/system.convert.tobase64string.aspx).

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-03-29T00:37:09.067

有一种方法可以分块执行此操作，这样您就不必一次消耗大量内存。

.Net 包含一个可以进行分块的编码器，但它有点奇怪。他们把它放在 System.Security.Cryptography 命名空间中。

我已经测试了下面的示例代码，并且使用我的方法或上面的 Andrew 方法得到了相同的输出。

它是这样工作的：你启动了一个名为 CryptoStream 的类。这是一种插入另一个流的适配器。您将一个名为 CryptoTransform 的类插入到 CryptoStream（它又附加到您的文件/内存/网络流）中，它在从流中读取或写入数据时对数据执行数据转换。

通常，转换是加密/解密，但 .net 也包括 ToBase64 和 FromBase64 转换，所以我们不会加密，只是编码。

这是代码。我包含了 Andrew 建议的一个（可能命名不当）实现，以便您可以比较输出。

```
 class Base64Encoder
    {
        public void Encode(string inFileName, string outFileName)
        {
            System.Security.Cryptography.ICryptoTransform transform = new System.Security.Cryptography.ToBase64Transform();
            using(System.IO.FileStream inFile = System.IO.File.OpenRead(inFileName),
                                      outFile = System.IO.File.Create(outFileName))
            using (System.Security.Cryptography.CryptoStream cryptStream = new System.Security.Cryptography.CryptoStream(outFile, transform, System.Security.Cryptography.CryptoStreamMode.Write))
            {
                // I'm going to use a 4k buffer, tune this as needed
                byte[] buffer = new byte[4096];
                int bytesRead;

                while ((bytesRead = inFile.Read(buffer, 0, buffer.Length)) > 0)
                    cryptStream.Write(buffer, 0, bytesRead);

                cryptStream.FlushFinalBlock();
            }
        }

        public void Decode(string inFileName, string outFileName)
        {
            System.Security.Cryptography.ICryptoTransform transform = new System.Security.Cryptography.FromBase64Transform();
            using (System.IO.FileStream inFile = System.IO.File.OpenRead(inFileName),
                                      outFile = System.IO.File.Create(outFileName))
            using (System.Security.Cryptography.CryptoStream cryptStream = new System.Security.Cryptography.CryptoStream(inFile, transform, System.Security.Cryptography.CryptoStreamMode.Read))
            {
                byte[] buffer = new byte[4096];
                int bytesRead;

                while ((bytesRead = cryptStream.Read(buffer, 0, buffer.Length)) > 0)
                    outFile.Write(buffer, 0, bytesRead);

                outFile.Flush();
            }
        }

        // this version of Encode pulls everything into memory at once
        // you can compare the output of my Encode method above to the output of this one
        // the output should be identical, but the crytostream version
        // will use way less memory on a large file than this version.
        public void MemoryEncode(string inFileName, string outFileName)
        {
            byte[] bytes = System.IO.File.ReadAllBytes(inFileName);
            System.IO.File.WriteAllText(outFileName, System.Convert.ToBase64String(bytes));
        }
    } 

```

我也在玩我附加 CryptoStream 的地方。在 Encode 方法中，我将它附加到输出（写入）流，所以当我实例化 CryptoStream 时，我使用它的 Write() 方法。

当我阅读时，我将它附加到输入（阅读）流，所以我使用 CryptoStream 上的 read 方法。我将它附加到哪个流并不重要。我只需要将适当的 Read 或 Write 枚举成员传递给 CryptoStream 的构造函数。

# .net - 是否可以使用 .NET 跟踪每个 http/url 重定向？

> ID：475438
> 
> 赞同：0
> 
> 时间：2009-01-24T03:36:20.193
> 
> 标签：.net, http, url, redirect

我正在做一个 Windows 窗体应用程序，它要求我记录用户机器上发生的每个 url 重定向。就像当用户在谷歌上搜索某些东西并点击赞助链接时，那里会发生一些重定向，我想跟踪这些重定向。

是否有任何侦听器类可以用来完成此任务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T03:42:13.053

如果您尝试监视用户可能正在运行的任何浏览器，请实施直通 HTTP 代理并监视请求。浏览器本身仍然需要配置为通过代理，并且这个过程本身是依赖于浏览器的。

虽然它相当简单，但即使是直通代理也是一项不平凡的任务，因此您可能希望将其基于一些第三方代码，例如[Mentalis.org Proxy](http://www.mentalis.org/soft/projects/proxy/)。

有关出于调试目的执行此操作的工具示例，请参阅[Fiddler 。](http://www.fiddlertool.com/fiddler/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T03:39:07.117

我认为您的意思是推荐人，而不是重定向。如果是这种情况，请在 global.asax 中的 application_begin 方法中记录 httpcontext.current.request.referrer.uri。

# lua - KDevelop 中的 Lua 语法高亮显示

> ID：475464
> 
> 赞同：2
> 
> 时间：2009-01-24T04:05:53.987
> 
> 标签：lua, syntax-highlighting, kdevelop

有谁知道如何修复 Kdevelop 中的 Lua 语法突出显示。用于获取表长度的# 符号导致该行的其余部分看起来好像被注释掉了。

t[ *#t+1] = "富"*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T04:14:50.477

我对 Lua 一无所知，所以我不能给你具体的代码，但要修复突出显示，你必须编辑位于 $KDEDIR/share/apps/katepart/syntax/lua 的 KatePart Lua 语法突出显示文件.xml（在我的系统上 $KDEDIR 是 /usr/kde/3.5）。[您可以在http://kate-editor.org/article/writing_a_kate_highlighting_xml_file](http://kate-editor.org/article/writing_a_kate_highlighting_xml_file)找到 XML 格式的描述......它们不是最清晰的方向，但我还没有找到任何其他等价物。值得庆幸的是，KDE 中包含大量示例。

# c# - 让用户排序记录？

> ID：475492
> 
> 赞同：4
> 
> 时间：2009-01-24T04:27:21.887
> 
> 标签：c#, sql, list, sorting

我试图找出一种方法让用户对记录（等朋友列表）进行排序。

我想让用户有机会将记录（朋友）直接移动到列表的顶部或底部，或者输入一个数字（介于两者之间）。

首先，我想在所有用户朋友的表中添加一个名为 SortOrder (int) 的列，并根据记录应显示的顺序设置数字。

但我要避免的是，用户有 400 个朋友，如果他想将朋友编号 400 设置为列表中的第 1 位，那么我将不得不使用新的 SortOrder 更新每条记录。

所有数据都存储在 MS SQL 数据库中。

我希望有人对此有一个神奇的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T15:27:20.120

对排序列使用**浮点数**。

将初始项目设置为 0.0、1.0 等。

移到顶部，使用 min -1.0。移至底部，设置为 max+1.0。在两个项目之间移动，设置为 (prev+next)/2.0

这类似于行号方法，但数字之间有更多的“空间”。从理论上讲，当两个相邻值增长到接近时，仍然需要重新编号。我不知道这在实践中多久会发生，但我希望它非常罕见，因此可以通过任何维护任务来完成。

* * *

**[编辑]** FWIW，这个问题好几次回到我身边，所以[这是一种大致相同的方法，但使用 strings](http://www.codeproject.com/Articles/453077/Generating-Keys-for-a-Custom-Sort-Order)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T04:40:33.043

我不认为他们会经常这样做以引起真正的关注，但是，如果您担心，请使用我们从过去几天开始使用 BASIC 代码开创的技巧。

回到 BASIC 有行号的时候，我们只是简单地给它们编号 10、20、30 等等，所以如果我们需要在 10 和 20 之间插入一个，我们就叫它 15。或者如果 20 应该在 10 之前，我们将其重新编号为 5。

使用 32 位整数列，您可以拥有 200,000 个间距为 100 的朋友，这足以移动事物，尤其是如果您很聪明的话。

您可能希望偶尔运行一次扫描作业，将朋友重新编号为 100、200 等（类似于社交网络的磁盘碎片整理程序）。不要试图通过查看朋友编号来检测这一点，使用另一个字段，当用户重新排列他们的朋友时将其设置为 true，并在您进行碎片整理时将其清除。这样会更有效率。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T04:34:36.973

听起来您正在寻找一个链表类型结构，其中每条记录将按顺序保存下一条记录的 ID。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T04:38:39.693

我不知道魔术，但要移动到顶部或底部，您可以将 SortOrder 设置为 MIN/MAX(SortOrder) +/- 1。谁说顶部必须是 1 或 0？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T04:38:48.493

以下是我的做法：使用您的 SortOrder 列。大概会有一个初始的默认排序顺序，比如字母顺序，因此每个人都会根据他们的字母顺序获得一个 SortOrder 值。

然后，当用户将某人移至顶部时，您只需将 SortOrder 设置为最大 +1。如果他们将某人移到底部，那么它将是 min -1。如果他们将某人移动到中间的某个地方，那么您需要计算他们正在移动到中间的哪一半。如果是上半部分，则提高他们上方每个人的 SortOrder。如果是下半部分，则减少下面每个人的 SortOrder。

不知道有没有更方便的方法...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T14:33:59.040

您可以将其视为一群朋友。

最初，每个人都在第 0 组中，顺序是按名称或什么的。
- 如果用户随后将朋友 (a) 的“群组”增加到 1，则他们移至顶部
- 如果用户随后将朋友 (b) 的“群组”增加到 1，则 (a) 和 (b)出现在顶部
- 如果用户随后再次增加朋友 (b) 的“组”，则 (b) 出现在第 1 个和 (a) 第 2 个

只是一个念头...

# java - 如何确定 Java 程序使用了哪些类？

> ID：475516
> 
> 赞同：6
> 
> 时间：2009-01-24T04:44:31.040
> 
> 标签：java, optimization, jar, dependencies

是否有任何工具可以列出应用程序有效使用哪些类以及何时有效使用，或者更好的是，自动修剪 JAR 库以仅提供既被引用又被使用的类？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-24T04:55:57.617

请记住，正如[停止问题](http://en.wikipedia.org/wiki/Halting_problem)所证明的那样，您不能肯定地说某个特定的类已使用或未使用。至少在任何中等复杂的应用程序上。这是因为类不仅在编译时绑定，而且可以加载：

*   基于 XML 配置（例如 Spring）；
*   从属性文件加载（例如 JDBC 驱动程序名称）；
*   动态添加注释；
*   作为外部输入的结果加载（例如，用户输入、来自数据库的数据或远程过程调用）；
*   等等

所以仅仅看源代码是不够的。话虽如此，任何合理的 IDE 都会为您提供依赖关系分析工具。IntelliJ 当然可以。

您真正需要的是运行时检测您的应用程序正在做什么，但即使这样也不能保证。毕竟，由于输入的奇怪组合，特定的代码路径可能会在 1000 万次运行中出现一次，因此无法保证您已被覆盖。

不过，像这样的工具确实有一些价值。你可能想看看像[Emma](http://emma.sourceforge.net/)这样的东西。像[Yourkit](http://www.yourkit.com/)这样的分析器可以为您提供一个代码转储，您也可以对其进行分析（尽管它不会很好地提取瞬态对象）。

就个人而言，除了 IDE 将告诉您的内容之外，我发现没有什么价值：删除未使用的 JAR。比这更细化只是自找麻烦，收效甚微。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-24T06:08:42.320

是的，你想要[ProGuard](http://proguard.sourceforge.net)。它是一个完全免费的 Java 代码收缩器和混淆器。它易于配置、快速且有效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-24T05:00:49.603

你可以试试 JarJar [http://code.google.com/p/jarjar/](http://code.google.com/p/jarjar/)

它修剪 jar 依赖项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T11:58:43.863

在大多数情况下，您只需使用 javac 即可轻松完成。

删除现有的类文件。使用您的入口类的名称调用 javac。它将编译那些必要的类，但仅此而已。任务完成。

# c# - C# .NET 3.5 - 对列表成员执行类似列表的操作

> ID：475518
> 
> 赞同：1
> 
> 时间：2009-01-24T04:45:14.643
> 
> 标签：c#, list

我有一个字段对象，我创建了一个字段列表：

```
class Field {

string objectName;
string objectType;
string fieldName;
string fieldValue;

//constructor...

}

List<Field> fieldList = new List<Field>(); 
```

假设我想查询此列表以返回不同对象名称的集合（然后插入到选中列表框中。我将如何去做呢？

我想一些 LINQ 魔法可以解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T05:00:51.227

该表达式应从定义的列表中返回不同对象名称的列表。我将它转换为一个列表，因为 CheckedListBox DataSource 属性的文档表明它需要实现 IList 或 IListSource，而不仅仅是 IEnumerable。

```
((ListControl)cbListBox).DataSource = fieldList.Select( f => f.objectName )
                                               .Distinct()
                                               .ToList() ); 
```

如果将 checkedListBox 作为 ListControl 访问不能访问 DataSource（有时[文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.checkedlistbox.aspx)会说谎），您可以尝试：

```
cbListBox.Items.AddRange( fieldList.Select( f => f.objectName )
                                   .Distinct()
                                   .ToArray() ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T04:50:00.950

```
var q = from Field f in fileldList select f.objectName;

chkBoxList.DataSource = q.Distinct(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T05:01:16.730

这些工作中的任何一个

使用 var

1) var fieldNameCollection = from f in fieldList select f.FieldName; 2) Lambda 语法 var fieldNameCollection = fieldList.Select(f => f.FieldName);

或者，除了使用 var，您还可以使用 IEnumerable fieldNameCollection = fieldList.Select(f => f.FieldName);

# c# - 不再有“如果/那么”；字典使用？

> ID：475532
> 
> 赞同：1
> 
> 时间：2009-01-24T05:00:05.843
> 
> 标签：c#, dictionary

我正在编写一段代码，它需要大量的 if/then 语句才能工作。为了消除逐行编写 if/then 语句的需要，我可以使用字典或列表吗？如果是这样，有人可以将我引导到一个好的网络资源或展示他们以前做过的实例吗？

编辑

澄清：我有六个输入，每个都是带有一组选择的组合框。下面是输入和选择的详细信息。

（安培）1:1 - 1:12（12 种不同的选择）

(电缆尺寸) 2:1 - 2:13 (13 种不同的选择) 此列表中的某些项目将被第一个输入的选择排除在外。

（电缆类型）3:1 - 3:2（2 种不同选择）

(温度等级) 4:1 - 4:3 (3 种不同的选择)

（系统类型）5:1 - 5:2（2 种不同选择）

（导管类型）6:1 - 6:2（2 种不同选择）

从上面的输入将有两个输出，它们将出现在两个文本框中。

（电缆数量）7:1 - 7:16（16 种不同的输出）

（导管尺寸）8:1 - 8:8（8 种不同的输出）

我希望这有助于而不是阻碍。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T05:08:22.037

可能想对您对 if/the 语句所做的工作有所了解。如果您只是从键中获取值，那么，是的，字典可能会起作用。

```
Dictionary<string,string> map = new Dictionary<string,string>();

... populate the map with keys... 
```

然后用它...

```
string value = "default value";
if (map.ContainsKey(key))
{
   value = map[key];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T06:20:06.977

我实际上建议构建一个对象模型来存储您的设置。这将使您有机会封装有关何时可用的选项的逻辑。另一个好处是您的 Amp[1] 控件可以绑定到您的 SettingsContainer.Amp[1].Value，或者它最终会绑定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-24T06:26:13.610

看起来您正在尝试将 6 个输入（12 * 13 * 2 * 3 * 2 * 2 种可能性）的每个组合映射到 (16 * 8) 输出之一。如果是这种情况，您仍然需要进行大量输入工作 - 但移动到集合将允许您轻松地将映射外部化。我猜这可能最适合数据库表：

```
Amps | CableSize | CableType | TempRating | SystemType | ConduitType | CableQty | ConduitSize 
```

您将在 6 个输入列上放置一个主键，然后执行一个简单的 SELECT：

```
SELECT CableQty, ConduitSize 
FROM Table 
WHERE Amps = @amps AND CableSize = @cableSize...etc 
```

要在快速而肮脏的代码中做到这一点，数组可以工作：

```
const int AMPS = 0; const int CABLE_SIZE = 1; const int TEMP_RATING = 2; // etc.
var mappings = new Dictionary<int[], int[]>(12 * 13 * 2 * 3 * 2 * 2);
mappings.Add(
   new int[] { 1, 1, 1, 1, 1, 1 }, // inputs
   new int[] { 1, 2 } //outputs
);
// repeat...a lot

var outputs = mappings.First(inputs => {
   inputs[AMPS] == myAmps
   && inputs[CABLE_SIZE] == myCableSize
   && inputs[TEMP_RATING] == myTempRating
   && // etc
}); 
```

它不会为您节省太多输入 - 尽管如果有某种逻辑，您可以使用 for 循环等来填充映射 - 但它比 6 页 if 语句更具可读性（我会可能是区域关闭或部分类加载映射）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T06:13:08.240

如果您总是只是获得一个简单的键值查找，那么是的，字典查找可以替换一长串 if-then 语句。但是，如果有时您的逻辑比简单的键值查找更复杂，您可能必须创建 if-then 语句和字典查找的混合体。有时这些会被组合成一个合乎逻辑的陈述。

在您的情况下，唯一正确的答案是完全遵循您的业务领域的规定。如果您可以在大多数情况下简化为字典查找，请使用它们。不过，不要太死板地选择一个。通常，业务逻辑太杂乱，无法像那样整齐地放在合适的位置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T06:25:49.137

可以进行字典查找，但我认为您描述的问题不可行。

David Thomas Garcia 为您的问题提供了一个很好的解决方案。我喜欢这个解决方案，因为它很好地封装了您可能重用的业务对象，并且我希望它也可以为您简化维护/调试。

让对象模型为每个选项列表公开默认列表，然后在选择每个选项时，自动过滤较低级别的选项。

# wcf - 带有对象列表的数据绑定 Silverlight 组合框 - 工作但丑陋

> ID：475537
> 
> 赞同：2
> 
> 时间：2009-01-24T05:02:14.810
> 
> 标签：wcf, silverlight, data-binding, combobox

我正在开发一个业务应用程序，将 Silverlight 用于 UI，将 WCF Web 服务用于后端。在数据库中，我有许多查找表。当 WCF 服务返回一个业务对象时，其中一个属性包含查找表中的整行，而不仅仅是外键，因此在 UI 中我可以显示查找表中的描述等内容，而无需再次调用服务。我目前要做的是提供一个绑定到整个查找值列表的组合框，并让它正确更新。我在此示例中处理的业务对象称为 Session，查找称为 SessionType。

下面是组合框的定义。DataContext 设置为 Session 的一个实例。我正在设置一个 ItemTemplate，因为组合框显示的不仅仅是字符串列表。

```
<ComboBox 
x:Name="SessionTypesComboBox"
ItemTemplate="{StaticResource SessionTypeDataTemplate}"
ItemsSource="{Binding Source={StaticResource AllSessionTypes}}"
SelectedItem="{Binding Path=SessionType, Mode=TwoWay}"
/> 
```

业务对象和查找表都通过 Web 服务异步加载。如果我什么都不做，组合框列表将填充 SessionTypes，但它不会显示来自 Session 的初始 SessionType 值。但是，如果更改组合框选择，则 Session 将使用正确的 SessionType 进行更新。

似乎正在发生的事情是 SelectedItem 绑定无法将 Session 中的 SessionType 与其在 SessionType 列表中的等价物相匹配。对象值相同，但引用不同。

我找到的解决方法是加载 Session 和 SessionTypes 列表，然后用 SessionTypes 列表中的对应更新当前 Session 的 SessionType。如果我这样做，那么组合框会正确显示。但是对我来说，这有一种不好的代码气味。因为一切都是异步加载的，所以我必须确定一切何时可用。我是这样做的：

在我的 Silverlight 用户控件的代码隐藏中：

```
// incremented every time we get data back during initial form load.
private volatile int m_LoadSequence = 0;

...

// Loaded event, called when the form is er... loaded.
private void UserControl_Loaded(object sender, RoutedEventArgs e)
{
    // load session types
    var sessionTypes = this.Resources["AllSessionTypes"] as Lookups.AllSessionTypes;
    if (sessionTypes != null)
    {
        sessionTypes.DataLoadCompleted += (s, ea) =>
        {
            IncrementLoadSequence();
        };
        sessionTypes.LoadAsync();
    }

    // start loading another lookup table, same as above
    // omitted for clarity

    // set our DataContect to our business object (passed in when form was created)
    this.LayoutRoot.DataContext = this.m_Session;
    IncrementLoadSequence();
}

// This is the smelly part. This gets called by OnBlahCompleted events as web service calls return.
private void IncrementLoadSequence()
{
    // check to see if we're expecting any more service calls to complete.
    if (++m_LoadSequence < 3)
        return;

    // set lookup values on m_Session to the correct one in SessionType list.

    // Get SessionType list from page resources
    var sessionTypes = this.Resources["AllSessionTypes"] as Lookups.AllSessionTypes;

    // Find the matching SessionType based on ID
    this.m_Session.SessionType = sessionTypes.Where((st) => { return st.SessionTypeID == this.m_Session.SessionType.SessionTypeID; }).First();

    // (other lookup table omitted for clarity)
} 
```

所以基本上我有一个计数器，每次我从 web 服务取回数据时都会递增。因为我期待 3 件事（核心业务对象 + 2 个查找表），所以当该计数器达到 3 时，我匹配引用。

对我来说，这似乎很hacky。我宁愿看到组合框指定一个 ValueMemberPath 和 SelectedValue 以将所选项目与列表中的一个匹配。

任何人都可以看到更清洁的方法吗？这种情况在商业应用中很常见，所以我相信一定有一个很好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T04:25:40.537

杰夫，

为了确认我理解您的问题：数据绑定基础结构似乎无法识别*您*认为“相等”**的**两个对象实际上是相等的 - 因此初始`SelectedItem`设置不正确，因为数据绑定在您的`StaticResource`集合匹配`Session.SessionType`。您可以通过“扁平化”引用来解决此问题（即，您**强制**在代码`Session.SessionType`中引用等于。`Where((st)...First()`

我们也遇到过[类似的问题](http://silverlight.net/forums/t/65264.aspx)。

Silverlight 不会因为*您*知道它们代表相同的数据而自动将来自不同“来源”的两个对象“等同”起来，这*确实有点道理。*就像您说的“*对象值相同但引用不同*”。但是如何使数据绑定等同于它们呢？

 **我们想到/尝试的事情：

*   在类上实现 .Equals() （`SessionType`在您的情况下）

*   在类上实施 operator == （`SessionType`在你的情况下）

*   [`IEquatable`](http://msdn.microsoft.com/en-us/library/ms131187.aspx)在课堂上实施（`SessionType`在你的情况下）

*   使集合仅`String`s 并绑定到字符串属性

但最终我们放弃并使用了与您相同的方法 - 从“集合”中“提取”正确的引用等于对象（在所有内容加载后）并将其插入`SelectedItem`-bound 属性。

我同意你关于代码气味的看法，并且怀疑*必须*有更好的解决方案。到目前为止，我们在属性访问器和 no-op 中`IValueConverter`的所有调试都没有找到解决方案——但如果我们找到了，我也会在这里发布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T06:51:17.633

我不确定我是否完全理解这个问题（现在还早:)）但是你不能在一个电话中转移你需要的所有物品吗？（即使您必须将 3 包装在一个新的 DTO 类中），那么您可以使用一个完整的事件来更新当前会话类型。它仍然不完美，但至少你不必保留任何计数器。

我还将所有这些逻辑移动到 ViewModel 并绑定到它，但这只是我 :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T07:38:26.117

你最好绑定到 ObservableCollection 然后使用其他代码（MVVM 的视图模型部分不是一个糟糕的选择）在后台更新它。这样您就可以与 UI 分离，并且在 UI 刚刚绑定时更容易处理更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T20:36:55.333

感谢您的回答，以上所有内容都很有用！我正在转向 MVVM 方式，并将多个服务调用组合成一个（也减少了往返开销）。看起来我暂时会坚持查找重新引用 - 如果我找到更好的方法，我也会发布它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-18T16:01:27.647

**geofftnz**，你有没有找到任何好的解决方案？

**CraigD**，我怀疑覆盖 Equals 等是一个很好的解决方案。首先，这是在生成的代理类 SessionType 中完成的，因此这些更改将在每次服务引用更新时丢失。其次，SessionType 设置器中的通知（这里 SessionType 是相同的生成的客户端代理类）使用 ReferenceEquals 调用......所以这是触摸生成代码的另一个地方！好的，第一件事可以通过手工制作的部分类 SessionType 完成（更新后不会丢失），但第二件事肯定不能以同样的方式完成。

# iphone - iPhone 开发 - 防止泄漏

> ID：475539
> 
> 赞同：4
> 
> 时间：2009-01-24T05:02:50.143
> 
> 标签：iphone, ios, memory-management, memory-leaks

当我使用 Leaks 运行我的应用程序并查看任何泄漏的扩展详细信息时，它会将我带到代码中的特定行，但我不知道在那之后该怎么做！

例如，Leaks 在这一行显示了一个 malloc

```
NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error]; 
```

但我不知道声明中的问题是什么！有人可以告诉我如何解释这些问题并避免泄漏。

谢谢。

*编辑：关于我之前的问题，NSZombieEnabled 确保没有对象被释放，这增加了内存使用量。因此，在使用 Leaks 进行测试时，请确保从您的应用程序中删除此设置。认为这可能对某人有所帮助。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T14:24:54.087

找到了答案。Fredrik 的回答让我思考。我正在创建一个 NSURLResponse 和 NSError 的实例，然后将其传递给 sendSynchronousRequest 方法。根据 iPhone 的内存管理文档，不应该这样做。我们只需要将 NSURLResponse 和 NSError 对象的引用传递给该方法，该方法负责创建和释放对象。

希望对其他人有所帮助。非常感谢大家的回答。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T06:04:24.780

Extended Detail 窗格将为您提供堆栈跟踪，显示泄漏处的堆栈。一般来说，一个好的起点是查看您的方法和堆栈中代码的最后一个方法，看看您在内存方面做了什么，听起来您可能会过度保留一个对象。现在从那里开始

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T09:58:33.573

调用后是否释放响应和错误对象？这些可能是在调用中分配的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T19:28:34.687

您上面提到的方法中的泄漏应该在 iPhone OS 2.2 版本中得到修复。您使用的是哪个版本的 iPhone 操作系统？

# silverlight - 您可以在 Silverlight 中访问屏幕显示的 DPI 设置吗？

> ID：475543
> 
> 赞同：1
> 
> 时间：2009-01-24T05:06:09.983
> 
> 标签：silverlight, dpi, display-dpi

有没有办法在 Silverlight 中访问屏幕显示的 DPI 设置？如果是这样，怎么做？

谢谢，

杰夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T07:36:45.810

我不认为你可以。它非常受保护。

# python - 在 django 中分组

> ID：475552
> 
> 赞同：3
> 
> 时间：2009-01-24T05:15:15.470
> 
> 标签：python, django, django-models

如何在 django 的主干版本中通过查询创建简单的组？

我需要类似的东西

```
SELECT name
FROM mytable
GROUP BY name 
```

实际上我想要做的只是获取所有具有不同名称的条目。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-24T15:37:28.350

如果您需要所有不同的名称，只需执行以下操作：

```
Foo.objects.values('name').distinct() 
```

你会得到一个字典列表，每个字典都有一个**名称**键。如果您需要其他数据，只需将更多属性名称作为参数添加到 .values() 调用。当然，如果您添加的属性可能在同名的行之间有所不同，您将破坏 .distinct()。

如果您想取回完整的模型对象，这将无济于事。但无论如何，获得不同的名称和获得完整的数据本质上是不相容的目标。您如何知道要完整返回具有给定名称的*哪一行？*如果您想为具有给定名称的所有行计算某种聚合数据，[聚合支持](http://docs.djangoproject.com/en/dev/topics/db/aggregation/#topics-db-aggregation)最近添加到 Django 主干中，可以为您处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T07:04:07.280

将 .distinct 添加到您的查询集：

```
Entries.objects.filter(something='xxx').distinct() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-24T07:09:16.550

这将不起作用，因为每一行都有唯一的 ID。所以每条记录都是不同的..

为了解决我的问题，我使用了

```
foo = Foo.objects.all()
foo.query.group_by = ['name'] 
```

但这不是官方 API。

# cocoa-touch - 如何使用 iPhone 模拟器测试横向视图？

> ID：475553
> 
> 赞同：43
> 
> 时间：2009-01-24T05:16:54.267
> 
> 标签：cocoa-touch, cordova, ios-simulator

我想知道我是否可以使用模拟器测试横向视图？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-01-24T05:37:23.413

![替代文字](https://i.imgur.com/zKnTZ9Y.png?1)

在硬件菜单下，您将找到对应于 CMD+Left 和 CMD+Right 的旋转项

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-24T05:30:33.677

在硬件菜单中，有一个更改方向的选项。此外，Cmd-Left 和 Cmd-Right 将旋转虚拟手机。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-11-16T12:31:53.453

*   在 IDE 中设置模拟器方向

上述（硬件->设备）是仅在启动模拟器后才旋转模拟器的解决方案，但您的 IDE 中还应该有一个选项来定义模拟器的方向。

如果您使用的是 JDeveloper IDE，请转到

**应用程序 --> 部署 --> 新部署配置文件 --> 选择配置文件类型 (iOS) --> iOS 选项 --> 设备方向。** [IDE 设备方向。](https://i.stack.imgur.com/lPxpk.png) 您可以在此处提及默认情况下需要的方向，横向或纵向。

*   切换方向的快捷键

**按命令键并按左箭头/右箭头。** 这将在您需要的横向和纵向视图之间切换。

我希望这可能对您的查询有所帮助。

# php - 获取PHP中类的所有实例

> ID：475569
> 
> 赞同：10
> 
> 时间：2009-01-24T05:31:00.620
> 
> 标签：php, class, dynamic

我想获取某个类的对象的所有实例。

例如：

```
class Foo {
}

$a = new Foo();
$b = new Foo();

$instances = get_instances_of_class('Foo'); 
```

`$instances`应该是`array($a, $b)`或`array($b, $a)`（顺序无关紧要）。

一个优点是该函数将返回具有所请求类的超类的实例，尽管这不是必需的。

我能想到的一种方法是使用一个包含实例数组的静态类成员变量。在类的构造函数和析构函数中，我会`$this`在数组中添加或删除。如果我必须在许多课程上这样做，这是相当麻烦且容易出错的。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-24T06:14:02.497

如果您从 TrackableObject 类派生所有对象，则可以设置此类来处理此类事情（只需确保在子类中调用`parent::__construct()`和`parent::__destruct()`重载这些对象时）。

```
class TrackableObject
{
    protected static $_instances = array();

    public function __construct()
    {
        self::$_instances[] = $this;
    }

    public function __destruct()
    {
        unset(self::$_instances[array_search($this, self::$_instances, true)]);
    }

    /**
     * @param $includeSubclasses Optionally include subclasses in returned set
     * @returns array array of objects
     */
    public static function getInstances($includeSubclasses = false)
    {
        $return = array();
        foreach(self::$_instances as $instance) {
            if ($instance instanceof get_class($this)) {
                if ($includeSubclasses || (get_class($instance) === get_class($this)) {
                    $return[] = $instance;
                }
            }
        }
        return $return;
    }
} 
```

这样做的主要问题是垃圾收集不会自动拾取任何对象（因为对它的引用仍然存在于 中`TrackableObject::$_instances`），因此`__destruct()`需要手动调用以销毁所述对象。（循环参考垃圾收集是在 PHP 5.3 中添加的，可能会提供额外的垃圾收集机会）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-24T05:59:15.960

这是一个可能的解决方案：

```
function get_instances_of_class($class) {
    $instances = array();

    foreach ($GLOBALS as $value) {
        if (is_a($value, $class) || is_subclass_of($value, $class)) {
            array_push($instances, $value);
        }
    }

    return $instances;
} 
```

**编辑**：更新代码以检查是否`$class`是超类。

**编辑2**：制作了一个稍微混乱的递归函数来检查每个对象的变量，而不仅仅是顶级对象：

```
function get_instances_of_class($class, $vars=null) {
    if ($vars == null) {
        $vars = $GLOBALS;
    }

    $instances = array();

    foreach ($vars as $value) {
        if (is_a($value, $class)) {
            array_push($instances, $value);
        }

        $object_vars = get_object_vars($value);
        if ($object_vars) {
            $instances = array_merge($instances, get_instances_of_class($class, $object_vars));
        }
    }

    return $instances;
} 
```

我不确定它是否可以与某些对象进行无限递归，所以要小心......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-24T05:33:40.973

据我所知，PHP 运行时不会公开底层对象空间，因此无法查询它以获取对象的实例。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-27T11:44:28.717

> 我需要这个，因为我正在制作一个事件系统，并且需要能够将事件发送到某个类的所有对象（如果你愿意的话，一个全局通知，它是动态绑定的）。

我建议有一个单独的对象，您可以在其中注册对象（[观察者模式](http://books.google.dk/books?id=qVLjFk_4zVYC&pg=PA207&lpg=PA207&dq=spl+php+observer+pattern&source=bl&ots=fOaPhg0VSl&sig=IWa5RzL40ypycRU6Rfj0B-O8AJ4&hl=da&sa=X&oi=book_result&resnum=8&ct=result#PPA207,M1)）。PHP 通过 spl 内置了对此的支持；请参阅：[SplObserver](http://www.php.net/~helly/php/ext/spl/interfaceSplObserver.html)和[SplSubject](http://www.php.net/~helly/php/ext/spl/interfaceSplSubject.html)。

# c++ - 共享库发现

> ID：475570
> 
> 赞同：0
> 
> 时间：2009-01-24T05:32:24.047
> 
> 标签：c++, shared-libraries

我在 Linux 上使用 C++。我想动态绑定一组未知共享库。我需要我的代码来检测共享库公开的所有公共函数以及这些函数的字符串名称。我如何完成这项任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T06:03:22.910

AFAIK，没有 glibc 函数可以枚举 .so 文件的所有公共接口函数。您可以参考 libelf 从动态文件中读取所有符号。Libelf 在这里[http://www.mr511.de/software/](http://www.mr511.de/software/)。找到符号后，您可以使用 dlopen 和 dlsym 来加载它。

# java - 第一个Java程序（计算器）问题

> ID：475584
> 
> 赞同：0
> 
> 时间：2009-01-24T05:46:09.060
> 
> 标签：java, class, operators, calculator

我正在学习 Java，我的第一个项目是计算器，但是我遇到了障碍。我试图让我的计算器让我输入一个数字，然后单击一个运算符（+、-、x、/），输入另一个数字，然后再次点击一个运算符并让显示更新并能够继续进行。

例如，我希望能够点击以下内容，并在每次点击操作员后显示总数：

> a + b / c - d =

我拥有的代码（对我而言）似乎应该可以工作，但事实并非如此。我究竟做错了什么？

以下是我在点击运算符时使用的代码。默认情况下，等待设置为 false。运行完该类一次后， value1 被存储并将 wait 设置为 true 并且工作正常。从那里它似乎并不完全正确：

```
class OperatorListener implements ActionListener {
    public void actionPerformed(ActionEvent event) {
        String input = event.getActionCommand();

        // Set display as string
        String s = display.getText();

        if (!wait) {
            // Convert first input string to double
            try {
                value1 = Double.valueOf(s.trim()).doubleValue();
            } catch (NumberFormatException nfe) {
                System.out.println("NumberFormatException: " + nfe.getMessage());
            }

            dec = false;
        } else {
            // Convert second input string to double
            try {
                value2 = Double.valueOf(s.trim()).doubleValue();
            } catch (NumberFormatException nfe) {
                System.out.println("NumberFormatException: " + nfe.getMessage());
            }

            // Determine operation to be performed
            if (operator == "add") {
                value1 = Operators.add(value1, value2);             
            } else if (operator == "subtract") {
                value1 = Operators.subtract(value1, value2);
            } else if (operator == "multiply") {
                value1 = Operators.multiply(value1, value2);
            } else if (operator == "divide") {
                value1 = Operators.divide(value1, value2);
            }

            // Convert final value to string and display
            display.setText(Double.toString(value1));

            dec = false;
        }

        // Determine operator hit
        if (input.equals("+")) {
            operator = "add";
        } else if (input.equals("-")) {
            operator = "subtract";
        } else if (input.equals("x")) {
            operator = "multiply";
        } else if (input.equals("/")) {
            operator = "divide";
        }

        // Set wait
        wait = true;

    }
} 
```

编辑：更新代码以修复一些混乱并更新 if 语句。即使在此之后，同样的问题仍然存在。此外，完整的源代码可[在此处获得](http://www.chriskankiewicz.com/documents/java/development/Calculator/src/Calculator.java)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T06:23:48.610

几点建议。

首先，我建议在使用 a`boolean`作为`if`语句的条件时，避免与`true`and进行比较——反正`false`只有两种状态。`boolean`此外，由于只有两种状态，而不是 using `else if (false)`， an`else`就足够了：

```
if (condition == true)
{
  // when condition is true 
}
else if (condition == false)
{
  // when condition is false
} 
```

可以改写为：

```
if (condition)
{
  // when condition is true 
}
else
{
  // when condition is false
} 
```

其次，不要比较字符串文字`"add"`等，而是`"subtract"`尝试使用常量（`final`变量）或[`enum`](http://java.sun.com/j2se/1.5.0/docs/guide/language/enums.html)s。进行`String`比较，例如`(operator == "add")`检查字符串文字`"add"`和`operator`变量是否都*引用*同一个对象，而不是*值*是否相同。因此，在某些情况下，您可能`operator`设置为，`"add"`但比较可能不是`true`因为字符串文字引用了一个单独的对象。一个简单的解决方法是：

```
final String operatorAdd = "add";
// ...

if (input.equals("+"))
  operator = operatorAdd;
  // ...

if (operator == operatorAdd)
  // ... 
```

现在，两者的赋值`operator`和比较`operator`都引用了常量`operatorAdd`，所以比较可以使用 a`==`而不是`equals()`方法。

第三，由于这似乎是不需要两个操作数（即）的计算器类型，`operand1 + operand2`而是一个作用于存储值的单个操作数（即`operand + currentValue`当前值，另一个保存运算符的变量，以及一个根据当前运算符和操作数进行操作的方法。（或多或少是[累加器](http://en.wikipedia.org/wiki/Accumulator_(computing))或单操作数计算机的概念。）

基本的操作方法是：

1.  设置`currentValue`.
2.  设置运算符。
3.  设置`operand`.
4.  执行计算。
5.  将 设置`currentValue`为计算结果。
6.  将运算符设置为空白状态。

每一步都应该检查上一步是否发生——确保指定了一个操作（`operator`设置为一个有效的操作符），然后输入的下一个值变成`operand`. 计算器就像一[台状态机](http://en.wikipedia.org/wiki/Finite_state_machine)，从一个步骤到另一个步骤必须按照一定的顺序执行，否则将无法进行下一步。

所以，计算器可能是这样的（伪代码！）：

```
// Initialize calculator (Step 1)
currentValue = 0;
operand = 0;
operator = operatorNone;

loop 
{
  operand = getOperand();     // Step 2
  operator = getOperator();   // Step 3

  // Step 4 and 5
  if (operator == operatorAdd)
    currentValue += operand;
  if (operator == operatorSubtract)
    currentValue -= operand;
  // ...

  // Step 6
  operator = operatorNone;
} 
```

尽管上面的代码使用单个循环并且不像基于事件的 GUI 模型那样工作，但它应该概述了运行计算器所需的步骤。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T05:57:25.120

每当您输入运算符时，您的代码都会执行以下操作：

```
Double.valueOf(s.trim()) 
```

用于设置`value1`或`value2`（取决于`wait`）。这将引发异常，因为运算符不能被解析为双精度。在尝试将输入解析为数字之前，您可能会更幸运地*先*检查运算符。那么如果是算子，就可以跳过数字解析部分。

还要考虑如果有人连续输入两个数字或两个运算符会发生什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T06:10:01.787

正如格雷格所说，无论输入是什么，无论当前程序状态如何，您总是会解析出数字。您需要更清晰地跟踪程序状态。我假设当你的代码有“String s = output.getText();” 你的意思是“String s = input.getText();”。

另请注意

```
  如果（等待==假）{
    // !wait 的东西
  } else if (wait == true) {
    // 等待的东西
  }

```

是不必要的冗余。您可以将其替换为：

```
  如果（！等待）{
    // !wait 的东西
  } 别的 {
    // 等待的东西
  }

```

您可能应该首先检查输入字符串以查看它是否是运算符，如果不是，则确保它是数字。编写一个中[缀](http://en.wikipedia.org/wiki/Infix_notation)计算器（正确处理优先级）并非易事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-25T02:42:22.597

经过高低搜索后，我终于确定问题不在我提供的代码中。我有一个“等待=假；” 在我的 NumberListener 类中搞砸了执行。为了解决这个问题，我创建了 2 个单独的等待变量，到目前为止一切正常。

感谢您的帮助和提示，+1 对你们所有人的尝试。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-24T07:29:44.187

您可以使用 Java 中的脚本引擎。如果你没有 Java 6+，你可以使用 Rhino，它做同样的事情。然后，您几乎可以在 JavaScript 中做任何可以做的事情

```
// create a script engine manager
ScriptEngineManager factory = new ScriptEngineManager();
// create a JavaScript engine
ScriptEngine engine = factory.getEngineByName("JavaScript");

// expose a, b, c, d
engine.put("a", 1);
engine.put("b", 8);
engine.put("c", 2);
engine.put("d", 3);

// evaluate JavaScript code from String
Number value = (Number) engine.eval("a + b / c * d");
System.out.println(value); 
```

[更多示例](http://java.sun.com/javase/6/docs/technotes/guides/scripting/programmer_guide/index.html)

# php - 使用 MySQL 和 PHP 检查线程中有多少帖子的最快方法

> ID：475585
> 
> 赞同：3
> 
> 时间：2009-01-24T05:46:13.583
> 
> 标签：php, mysql, optimization, query-optimization

我想知道在尝试例如检查论坛上特定线程中有多少帖子时，哪个更快。我是不是该...

(a) 使用特定线程 ID 浏览数据库中的每个帖子，并计算有多少行

或者

(b) 每次创建线程时，在线程数据库中的单独列中添加一个，然后查询该单行

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-24T05:51:53.977

线程 ID 的索引有什么问题？按线程 ID 字段分组的简单 COUNT 表达式还不够吗？

有了任何缓存，据我所知，这将非常快。

```
--This will provide counts for all threads
SELECT COUNT(threadID)
FROM Posts
GROUP BY threadID;

--This will provide count for one thread
SELECT COUNT(threadID)
FROM Posts
WHERE threadID=123
GROUP BY threadID; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T05:49:27.057

过早的优化是万恶之源。

使用解决方案 (a) 启动，然后，如果您的站点需要，切换到解决方案 (b)。

# php - php 4 和 php 5 的区别？

> ID：475594
> 
> 赞同：3
> 
> 时间：2009-01-24T05:57:02.580
> 
> 标签：php, migration, php4

我正在寻找虚拟主机空间，并且知道 PHP 版本是 4.3 和 MySQL 版本 4.1

但是我在 MySQL 5.x 版和 PHP 5.x 版中开发了我的应用程序

谁能给我版本的差异？

我现在无法访问什么？

谢谢...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T06:03:58.290

PHP 版本 5 我认为 PHP 何时成为一种真正的语言，原因有很多，但最重要的是因为它可以编写受人尊敬的面向对象代码。

但是不要轻视 MySQL 4 和 5 之间的区别——我认为它更深更重要。MySQl 5 是 MySQL 成为真正的关系数据库平台的时候，原因有很多，但最重要的是因为它可以编写完全表达的 SQL 语句（从完全子查询支持开始）。

我希望，只是早期版本的这两个限制对你来说是最重要的。接受低于版本 5 的任何一个都没有合理的借口。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-24T06:01:32.850

为什么不看看 PHP 文档：

[http://www.php.net/manual/en/migration5.php](http://www.php.net/manual/en/migration5.php)

[http://www.php.net/manual/en/faq.migration5.php](http://www.php.net/manual/en/faq.migration5.php)

[http://www.php.net/manual/en/migration5.incompatible.php](http://www.php.net/manual/en/migration5.incompatible.php)

关于 MySQL，您可以在此处跟踪版本的更改：

[http://dev.mysql.com/doc/mysqld-version-reference/en/key-changes.html](http://dev.mysql.com/doc/mysqld-version-reference/en/key-changes.html)

添加到 MySQL 5.0 和 5.1 的主要新功能在 4.x 中可能不起作用/不起作用可以在这里找到：

MySQL 5.0 - [http://dev.mysql.com/doc/refman/5.0/en/mysql-nutshell.html](http://dev.mysql.com/doc/refman/5.0/en/mysql-nutshell.html)

MySQL 5.1 - [http://dev.mysql.com/doc/refman/5.1/en/mysql-nutshell.html](http://dev.mysql.com/doc/refman/5.1/en/mysql-nutshell.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-24T06:00:17.987

这是发布历史的[基本概述](http://en.wikipedia.org/wiki/PHP#Release_history)。PHP 5 是一个很大的变化。

[不过，由于PHP 4 已弃用](http://www.wolerized.com/blog/remi-woler/php4-deprecated)，我不会详细介绍这些差异。坚持使用 PHP 5 和 MySQL 5。如果虚拟主机不提供 PHP 5 和 4，我会感到惊讶。4 只能用于遗留代码，并且不应该用于新的开发。

# javascript - 从 NSTextView 写入 iframe

> ID：475600
> 
> 赞同：0
> 
> 时间：2009-01-24T06:02:45.327
> 
> 标签：javascript, cocoa, webkit

我已经构建了一个基于 Web 的所见即所得编辑器，我可以从我的可可应用程序中以编程方式访问它。目前我可以在编辑器中运行脚本并从 iFrame 中检索 HTML，但我无法将文本从 NSTextView 发送到 iFrame。有任何想法吗？

编辑器在这里[http://www.alexmillsdesign.com/Developer/FernEngine/](http://www.alexmillsdesign.com/Developer/FernEngine/)

干杯亚历克斯米尔斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-24T09:21:34.740

我不是这方面的专家，但我过去曾编写过类似的示例代码。我采用的方法如下：在您想要更新文本插入代码的 Cocoa 类中，类似于

```
WebScriptObject *webScriptObject = [_webView windowScriptObject];
id result = [webScriptObject callWebScriptMethod:@"setTableRows" withArguments:[NSArray arrayWithObject:fauxData]]; 
```

其中 fauxData 是您想要传递给 JS 的任何内容，并且在 JS 源代码中有类似于

```
var mytable = document.getElementById("myTable");
var mytbody = document.getElementById("myTbody");
var docFragment = document.createDocumentFragment();
var myNewtbody = document.createElement("tbody");   
myNewtbody.id = "myTbody";

var trElem, tdElem, txtNode;
for(var j = 0; j < row_data.length; ++j) {
    trElem = document.createElement("tr");
    trElem.className = "tr" + (j%2);

    tdElem = document.createElement("td");
    tdElem.className = "col0";
    txtNode = document.createTextNode(row_data[j].lastName);
    tdElem.appendChild(txtNode);
    trElem.appendChild(tdElem);

    tdElem = document.createElement("td");
    tdElem.className = "col4";
    txtNode = document.createTextNode(row_data[j].firstName);
    tdElem.appendChild(txtNode);
    trElem.appendChild(tdElem);

    docFragment.appendChild(trElem);
}
myNewtbody.appendChild(docFragment);
mytable.replaceChild(myNewtbody, mytbody); 
```

当然你的 HTML 应该有类似的东西

```
<table id="myTable">

<thead id="myThead">
<tr>
<th>Last</th>
<th>First</th>
</tr>
</thead>

<tbody id="myTbody">
</tbody>

</table> 
```

Obviously this fills in rows of data in a table, but updating text would be similar.

# ps3 - 为 PS3 开发应用程序

> ID：475604
> 
> 赞同：8
> 
> 时间：2009-01-24T06:05:52.157
> 
> 标签：ps3

是否可以在 PS3 上创建应用程序（不是游戏）？我知道有一些方法可以安装 Linux 和所有这些，但我希望有一些东西可以从网上下载并运行。我希望该应用程序像服务器/守护程序一样运行并能够访问网络。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-24T06:42:18.743

您可能会发现以下内容很有趣。

### 来自 StackOverflow：

*   [为 Playstation 3 Linux 开发](https://stackoverflow.com/questions/467711/develop-for-playstation-3-linux)
*   [Playstation 3 上 Mono 的开发资源](https://stackoverflow.com/questions/27153/development-resources-for-mono-on-ps3)
*   [如何编写 Mono 守护进程？](https://stackoverflow.com/questions/186493/how-do-i-code-a-mono-daemon)

* * *

### 在 Cell BE 处理器上编程高性能应用程序

*   第 1 部分：[PLAYSTATION 3 上的 Linux 简介](http://www.ibm.com/developerworks/power/library/pa-linuxps3-1/index.html?S_TACT=105AGX16&S_CMP=EDU)
*   第 2 部分：[对 Sony PLAYSTATION 3 的协同处理元素进行编程](http://www.ibm.com/developerworks/power/library/pa-linuxps3-2/index.html?S_TACT=105AGX16&S_CMP=EDU)
*   第 3 部分：[认识协同处理单元](http://www.ibm.com/developerworks/power/library/pa-linuxps3-3/index.html?S_TACT=105AGX16&S_CMP=EDU)
*   第 4 部分：[对 SPU 进行编程以提高性能](http://www.ibm.com/developerworks/power/library/pa-linuxps3-4/index.html?S_TACT=105AGX16&S_CMP=EDU)

* * *

*有趣，但可能不是您想要的：*

在 PLAYSTATION®3 单元处理器编程中学习和竞争（[来源](http://www.cag.csail.mit.edu/ps3/)）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-24T07:09:47.190

为 PS3 编程的唯一方法是通过 Linux。除非您可以与索尼签订合同，并且您正在制作一款 AAA 游戏，否则您无法访问“真正的”SDK。

其他人都必须以 Linux 为目标。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-30T21:03:18.580

您还可以为 PS3 开发 BD-Java (BD-J) 应用程序。

# air - 什么是 Adob e Air？

> ID：475607
> 
> 赞同：5
> 
> 时间：2009-01-24T06:09:52.147
> 
> 标签：air, adobe

Adobe Air 究竟是什么？我看到很多人在谈论它，我什至看到了它的应用程序，但我仍然不完全确定它的独特之处或它与其他语言的不同之处。有人可以从程序员的角度给我简明的版本吗？

**编辑：** 我不熟悉 Flex，所以我找到了这个很好的解释：[http ://www.onflex.org/ted/2008/01/what-is-flex.php](http://www.onflex.org/ted/2008/01/what-is-flex.php)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-24T06:12:59.660

简而言之。

首先假设您知道 Flex 和 Actionscript 是什么。然后，它们都只在您的浏览器中运行，并且所有意图和目的都是为了构建 Web 应用程序。

现在假设您要开发相同的应用程序，使用相同的语言和用户界面资源，但将其作为桌面应用程序在 worktion（PC、Mac 或 Linux 可互换）上运行。

AIR 是您添加（作为链接库）到 Flex 和 Actionscript 以实现该目的的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T07:46:09.817

[http://en.wikipedia.org/wiki/Adobe_Integrated_Runtime](http://en.wikipedia.org/wiki/Adobe_Integrated_Runtime) 用 Flash、Flex、HTML、Ajax 编写跨平台桌面应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-12T11:40:22.173

Adobe Air 是一个允许构建桌面应用程序的框架，它基于 HTML/JS 和 Flash。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-19T23:15:15.267

Adobe Air 它的 Flash Runtime 可以在其中运行 Flash 并提供对您的操作系统的访问。

Adobe Air 可以像往常一样用于游戏和软件 Flash。它的独立 Flash 播放器具有扩展和到达功能。例如，您可以开发将与文件系统或硬件交互的 Flash 应用程序。

它还支持原生扩展，因此您可以使用原生 C/Java 库来扩展 Air。

air 可以生成为 windows 的 exe、mac 的应用程序、ios 的 ipa、android 的 apk、有限制的 linux 和黑莓。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-31T09:15:59.353

Adobe Air 是用于移动、窗口和 OSX 应用程序的跨平台语言/工具。

# c# - 在 C# 中同步包装异步方法

> ID：475617
> 
> 赞同：8
> 
> 时间：2009-01-24T06:20:00.363
> 
> 标签：c#, asynchronous, wrapper, synchronous

我有一个第三方库，其中包含一个异步执行功能的类。该类继承自Form。该函数基本上基于存储在数据库中的数据执行计算。完成后，它会在调用表单中调用 _Complete 事件。

我想做的是同步调用函数，但从非 Windows 窗体应用程序。问题是，无论我做什么，我的应用程序都会阻塞并且 _Complete 事件处理程序永远不会触发。从 Windows 窗体中，我可以通过使用“完成”标志和“while (!complete) application.doevents”来模拟同步运行的功能，但显然 application.doevents 在非 Windows 窗体应用程序中不可用。

有什么东西会阻止我在 Windows 窗体应用程序之外使用该类的方法（由于它继承自“Form”）？有什么办法可以解决这个问题吗？

谢谢，迈克

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T06:46:59.437

在 stab 中，可能值得尝试以下类似的方法，它使用 WaitHandle 来阻塞当前线程，而不是旋转和检查标志。

```
using System;
using System.Threading;

class Program
{
    AutoResetEvent _autoEvent;

    static void Main()
    {
        Program p = new Program();
        p.RunWidget();
    }

    public Program()
    {
        _autoEvent = new AutoResetEvent(false);
    }

    public void RunWidget()
    {
        ThirdParty widget = new ThirdParty();           
        widget.Completed += new EventHandler(this.Widget_Completed);
        widget.DoWork();

        // Waits for signal that work is done
        _autoEvent.WaitOne();
    }

    // Assumes that some kind of args are passed by the event
    public void Widget_Completed(object sender, EventArgs e)
    {
        _autoEvent.Set();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T02:47:16.583

我有更多关于这个问题的信息（我和 mikecamimo 在同一个团队工作）。

如果正确复制，该问题也会出现在 Windows 窗体应用程序中。在原来的 OP 中，由于没有阻塞，所以在 windows 窗体中没有出现问题。当使用 ResetEvent 引入阻塞时，会出现同样的问题。

这是因为事件处理程序 (Widget_Completed) 与调用 Widget.DoWork 的方法位于同一线程上。AutoResetEvent.WaitOne(); 的结果 永远阻塞，因为永远不会调用事件处理程序来设置事件。

在 Windows 窗体环境中，这可以通过使用 Application.DoEvents 轮询消息队列并允许处理事件来解决。见下文。

```
using System;
using System.Threading;
using System.Windows.Forms;

class Program
{
    EventArgs data;

    static void Main()
    {
        Program p = new Program();
        p.RunWidget();
    }

    public Program()
    {
        _autoEvent = new AutoResetEvent(false);
    }

    public void RunWidget()
    {
        ThirdParty widget = new ThirdParty();                   
        widget.Completed += new EventHandler(this.Widget_Completed);
        data = null;
        widget.DoWork();

        while (data == null);
            Application.DoEvents();

        // do stuff with the results of DoWork that are contained in EventArgs.
    }

    // Assumes that some kind of args are passed by the event
    public void Widget_Completed(object sender, EventArgs e)
    {
        data = e;
    }
} 
```

在非 Windows 窗体应用程序（例如 Windows 服务）中，应用程序不可用，因此无法调用 DoEvents。

问题是线程之一，widget.DoWork 的关联事件处理程序不知何故需要在另一个线程上。这应该可以防止 AutoResetEvent.WaitOne 无限期地阻塞。我认为... ：）

关于如何实现这一点的任何想法都会很棒。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T14:11:36.877

```
AutoResetEvent _autoEvent = new AutoResetEvent(false);

public  WebBrowser SyncronNavigation(string url)
{
    WebBrowser wb  = null;

    wb = new WebBrowser();
    wb.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(wb_DocumentCompleted);

    wb.ScriptErrorsSuppressed = true;
    wb.Navigate(new Uri(url));

    while (!_autoEvent.WaitOne(100))
        Application.DoEvents();

    return wb;
}

void wb_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
{
    //throw new NotImplementedException();
    _autoEvent.Set();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T06:32:35.673

你有组件的来源吗？听起来它依赖于将从 WinForms 环境中调用的事实（一定是库从 Form 继承的一个很好的理由！），但很难确定。

# c++ - C++0x 实现猜测？

> ID：475619
> 
> 赞同：6
> 
> 时间：2009-01-24T06:20:38.803
> 
> 标签：c++, programming-languages, language-design, legacy

C++0x 标准即将完成。到目前为止，我已经涉足 C++，但避免彻底学习它，因为它似乎缺少许多我在其他语言中被宠坏的现代特性。但是，我会对 C++0x 非常感兴趣，它解决了我的很多抱怨。任何猜测，在标准被批准后，主要编译器供应商需要多长时间才能提供相当完整的、生产质量的实现？它会很快发生以扭转 C++ 受欢迎程度的下降，还是太少、太晚了？你相信 C++0x 会在几年内成为“C++”，还是你相信大多数人会在实践中坚持早期的标准，而 C++0x 会有点像一个混蛋继子，有点像C99？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-24T07:32:09.407

我认为没有理由不采用 C++0x。C++ 社区比 C 更具前瞻性。C 一直被认为是一种“可移植的汇编语言”，因此使用它的人对花哨的新功能并不是非常感兴趣。C++ 的范围更广，而且我还没有听说过*不*期待 0x 的 C++ 程序员。（这也是我的印象，C++ 社区更加“严格”，并且真的不想超出标准进入未定义的行为，这意味着您选择 C++03 或 C++0X 而不是半实现混合。C 程序员往往对此更加放松，并且似乎乐于使用 C89，只混合了几个 C99 特性和头文件）

然而，微软至少需要几年的时间才能赶上。Visual Studio 2010 将支持少数 C++0x 功能（lambdas、decltype 和其他一些功能），但绝大多数将*不受支持*。我们将不得不等待 VS2012 或任何下一个版本最终得到一些完整的支持。

使用 GCC/G++，情况要好得多，因为大多数标准已经在那里实现了（标准委员会不喜欢采用尚未在真实编译器中实现和测试的功能，而 GCC 分支是常用于此）

但可能仍需要一些时间才能获得稳定和生产就绪。

关于 C++ 的“流行度下降”，我并没有真正看到。我认为过去几年 C++ 的受欢迎程度并没有显着下降。当然，RAD 开发人员已经跳槽到 .NET、Python 或其他语言或平台。但是在今天使用 C++ 的地方，没有多少可行的替代方案，也没有理由让它的普及度下降。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T16:11:16.410

我不了解其他供应商，但[据我](http://blogs.msdn.com/vcblog/archive/2008/10/28/lambdas-auto-and-static-assert-c-0x-features-in-vc10-part-1.aspx)所知，微软计划在 Visual C++ 2010 中包含四个 C++0x 语言功能[：](http://www.codeguru.com/forum/showthread.php?t=466893)

1.  [右值引用](http://en.wikipedia.org/wiki/C%2B%2B0x#Rvalue_reference_and_move_semantics)
2.  [汽车](http://en.wikipedia.org/wiki/C%2B%2B0x#Type_inference)
3.  [拉姆达斯](http://en.wikipedia.org/wiki/C%2B%2B0x#Lambda_functions_and_expressions)
4.  [静态断言](http://en.wikipedia.org/wiki/C%2B%2B0x#Static_assertions)

Although this is a small set of C++0x features, they are important ones. Some will enable programmers to write much more compact (auto, lambdas) and error free code. Some (like rvalue references) enable libraries to be more efficient. Microsoft likes lambdas as an [enabler for parallel computing](http://channel9.msdn.com/pdc2008/TL25/).

IMHO: `auto` alone will make it so much easier to use templates that more programmers will do so. And hopefully this will increase demand for more C++0x features from Microsoft and all vendors.

Microsoft will also be updating their C++ Standard Library implementation but I don't know the details. I believe they are modifying some container classes to take advantage of rvalue reference move semantics. And I believe they including more of TR1 .

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-24T06:33:45.547

一些实现已经在通往 C++0x 的路上：（[gcc](http://gcc.gnu.org/projects/cxx0x.html)）。我的直觉是 C++0x 支持将很快在主要编译器中可用。然而，仍然存在大量必须维护的遗留代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-24T06:35:19.273

较新版本的 gcc 已经支持许多 C++0x 功能： http: [//gcc.gnu.org/projects/cxx0x.html](http://gcc.gnu.org/projects/cxx0x.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T06:38:34.430

Microsoft 将在今年晚些时候在 Visual Studio 2010 中包含 C++0x 支持（社区技术预览已经可用）。

我认为它不会很快成为“C++”，但某些人会选择在代码中有意义的地方添加新语法的一部分。

这些天我不怎么做 C++，但我与之交谈的人要么喜欢它，要么觉得 C++ 的美在他们得到的控制中，如果他们想要一种具有所有这些额外功能的语言，他们会使用 C# /爪哇。

# linux - 文件管理

> ID：475626
> 
> 赞同：4
> 
> 时间：2009-01-24T06:30:13.557
> 
> 标签：linux, document, document-management

我们正在寻找一个简单的、开源的、基于 Web 的 Linux 文档管理系统。对于文档管理，我的意思是能够将一组文件（最少是 doc、xls 和 pdf）存储为文档。将元数据与所有者和版本等文档相关联。更新和删除文档。能够索引和搜索内容。身份验证和授权至少读取和可能写入的能力。如果可能的话，我想避免在 Java 或 PHP 中实现，因为我们已经使用 MySQL，这对于元数据存储特别有效。

我们过去曾使用过 Google 应用程序，但缺乏对 PDF 的支持使其不适合。其他缺点包括他们的服务丢失了我们的一些电子表格，没有公司拥有与个人账户相反的信息的概念，而且我们的一些信息是敏感的，我们更喜欢将其保留在内部（密码、合同等）。

MediaWiki 也不适合，因为我们的文档实际上是一组反对结构化内容（即不寻找内容管理系统），并且至少我们安装的版本不能很好地处理附件。

基于对过去问题的回顾，我计划研究 KnowledgeTree。还有其他我们应该考虑的项目吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T07:15:08.303

几个月来，我一直在使用 KnowledgeTree 开发一个 ASP.Net 应用程序，我对此只有好话要说。我们的产品将其用于 PDF 存储/检索，处理起来真的再简单不过了。基本安装为您提供了一个简单的环境，为元数据、文档组和各种安全选项提供了几乎无穷无尽的配置。此外，KnowledgeTree 的工作人员非常乐于助人，并在我们遇到“我们将如何做到这一点？”时为我们提供了示例代码。时刻。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-11T10:06:58.773

我将支持 KnowledgeTree 的建议。已经使用它几年了，并且索引了大约 1K 文档。去年的某个时候，我编写了一个简短的脚本来监控 KT 的事务表（在 MySQL 中），并通过 Twitter、Identica 和/或 Jabber 通知用户新的或更新的文档。然后可以使用 RSS 阅读器监控 Twitter/Identica 提要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T07:49:24.363

寻找可以索引所有文档格式并保持可搜索的内容。

我在办公室使用 Coldfusion 解决了这个问题。它内置了真正的搜索引擎。这会索引您网络上的文件（doc/xls/pdf 等），以使其中的文本可搜索（如 google）。

Coldfusion免费内置了我所有文件的即时搜索引擎，最多可搜索150,000个左右，因此它适合我的目的。这样的东西可以让您将文件保存在网络上，无论您如何/在任何地方，您都可以通过 java / .net 中可用的库提取有关所有者、修改日期的其余信息。

我相信你可以用另一种语言复制它，但可能需要更多的努力。我现在希望我可以在我自己的内部 wiki 中使用 Google Docs API 作为所见即所得的编辑器。这将解决我的大部分问题，因为一切都将基于 Intranet。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-09T02:41:05.000

试试[https://www.mayan-edms.com](https://www.mayan-edms.com)，写在 Django 上，数据库不可知论

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-25T17:21:59.790

您可以考虑[使用 GroupDocs](http://groupdocs.com/apps) ，因为它们具有存储、转换和其他一些功能。

# sql - 通用 SQL 问题

> ID：475633
> 
> 赞同：0
> 
> 时间：2009-01-24T06:35:02.783
> 
> 标签：sql

我有一张桌子 A

```
ID    Term
10    A
10    B
10    C
20    A
20    B
20    E 
```

编写sql的最佳方法是什么

*   如果我尝试查找 (A,B,C)，则获取 ID 10
*   如果我试图找到（A，B），什么也得不到
*   获取 ID 20，如果我尝试在 (C,D) 中查找 NOT

.

```
Select distinct ID from TableA where Term in (A,B,C) will return both 10 and 20

Select distinct ID from TableA where Term in (A,B) will also return both 10 and 20

Select distinct ID from TableA where Term NOT in (C,D) will also return both 10 and 20 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T07:18:36.703

1.

```
SELECT ID 
FROM TableA
WHERE Term IN ('A','B','C')
GROUP BY ID
HAVING COUNT(ID)=3
LIMIT 1 
```

这里 3 将是集合的长度（在这种情况下为 A、B、C）。2 & 3 可能是上述的一些变化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T08:18:39.873

我假设您想要一种可用于回答所有三个问题的查询形式，而不是针对每个问题的不同类型的查询。

这些解决方案利用`COUNT()`不计算`NULL`s。当 与`OUTER JOIN`中的行不匹配时`t2`，将导致 中`NULL`的所有列`t2`。

**如果我尝试查找 (A,B,C)，则获取 ID 10**

ID 10 具有三个不同的术语值，我们正在搜索所有三个。

```
SELECT t1.ID
FROM TableA t1 LEFT OUTER JOIN TableA t2 
  ON (t1.ID = t2.ID AND t1.term = t2.term AND t2.term IN ('A', 'B', 'C'))
GROUP BY t1.ID
HAVING COUNT(t1.term) = COUNT(t2.term); 
```

**如果我试图找到（A，B），什么也得不到**

ID 10 和 ID 20 都具有三个不同的术语值，但我们的搜索仅针对两个。两个 ID 的计数均为 3 = 2，因此计数均不相等。

```
SELECT t1.ID
FROM TableA t1 LEFT OUTER JOIN TableA t2 
  ON (t1.ID = t2.ID AND t1.term = t2.term AND t2.term IN ('A', 'B'))
GROUP BY t1.ID
HAVING COUNT(t1.term) = COUNT(t2.term); 
```

**获取 ID 20，如果我尝试在 (C,D) 中查找 NOT**

ID 20 具有三个不同的术语值，它们都不是“C”或“D”。所以计数是相等的。

```
SELECT t1.ID
FROM TableA t1 LEFT OUTER JOIN TableA t2 
  ON (t1.ID = t2.ID AND t1.term = t2.term AND t2.term NOT IN ('C', 'D'))
GROUP BY t1.ID
HAVING COUNT(t1.term) = COUNT(t2.term); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T08:08:46.277

第一季度

```
SQLite version 3.6.10
Enter ".help" for instructions
Enter SQL statements terminated with a ";"
sqlite> create table A(ID smallint, term varchar(1));
sqlite> insert into A values(10, 'A');
sqlite> insert into A values(10, 'B');
sqlite> insert into A values(10, 'C');
sqlite> insert into A values(20, 'A');
sqlite> insert into A values(20, 'B');
sqlite> insert into A values(20, 'E');
sqlite> SELECT ID FROM A WHERE TERM = 'A' INTERSECT SELECT ID FROM A WHERE TERM
= 'B' INTERSECT SELECT ID FROM A WHERE TERM = 'C';
10 
```

第二季度

```
sqlite> SELECT ID FROM A WHERE TERM = 'A' EXCEPT SELECT ID FROM A WHERE TERM = '
B'; 
```

不返回任何结果。EXCEPT 在某些版本的 SQL 中也可以称为 MINUS

第三季度

```
sqlite> SELECT ID FROM A EXCEPT SELECT ID FROM A WHERE TERM = 'C' UNION SELECT I
D FROM A WHERE TERM = 'D';
20 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T14:23:07.830

```
CREATE TABLE mySearch (
    search_id       INT,
    val             CHAR(1),
    is_required     INT,
    is_excluded     INT
    )  

INSERT INTO mySearch VALUES (1, 'A', 1, 0)   -- Search1 : A is required  
INSERT INTO mySearch VALUES (1, 'B', 1, 0)   -- Search1 : B is required  
INSERT INTO mySearch VALUES (1, 'C', 1, 0)   -- Search1 : C is required  

INSERT INTO mySearch VALUES (2, 'A', 1, 0)   -- Search2 : A is required  
INSERT INTO mySearch VALUES (2, 'B', 1, 0)   -- Search2 : B is required  

INSERT INTO mySearch VALUES (3, 'C', 0, 1)   -- Search3 : C is excluded
INSERT INTO mySearch VALUES (3, 'D', 0, 1)   -- Search3 : D is excluded  

SELECT
    [search].search_id,
    [data].id
FROM
    TableA            AS [data]
LEFT JOIN
    my_search         AS [search]
        ON [search].val = [data].Term
GROUP BY
    [search].search_id,
    [data].ID
HAVING
    ISNULL(SUM([search].is_included),0) = (SELECT SUM(is_included) FROM mySearch WHERE search_id = [search].search_id)
    AND MAX([search].is_excluded) IS NULL 
```

Should satisfy all three seaches in one query. Unfortunately I can't test it as I'm at the in-laws house and they don't have geek toys to test on ;)

# internet-explorer-7 - IE7 最小化点击链接

> ID：475636
> 
> 赞同：1
> 
> 时间：2009-01-24T06:37:44.430
> 
> 标签：internet-explorer-7, cross-browser

我正在为客户开发这个网站。直到几天前，它在所有主要浏览器上都运行良好。

从昨天开始，我一直面临着这个不寻常的问题：

在 IE7 中，每当我单击页面上的任何链接（导航链接或其他任何内容）时，IE7 窗口都会最小化。当我恢复窗口时，正确的链接（新页面）打开并显示。此外，仅当我打开一个 IE7 选项卡时才会发生这种情况，即：如果我在窗口上有两个选项卡，那么它可以完美运行。

此外，这在 IE6 和 Firefox 上运行良好。当我在 Firefox 中加载同一页面时，Firebug 没有显示任何类型的错误。

谁能想到可能发生这种情况的原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T07:06:14.653

*   如果将 IE7 恢复为默认设置，问题是否仍然存在？
*   如果禁用 Javascript，问题是否仍然存在？

# c# - 我需要为 ASP.NET MVC 中的每个操作都有一个视图页面吗？

> ID：475637
> 
> 赞同：1
> 
> 时间：2009-01-24T06:37:49.250
> 
> 标签：c#, asp.net-mvc

我有一个显示客户列表的客户索引页面。我在此页面中有搜索功能，我希望在执行搜索时 URL 为[http://mysite/search?id=434](http://mysite/search?id=434)。索引页面也会显示搜索结果。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T11:57:49.603

```
public class CustomerController : Controller

...

public ActionResult Search(int id)
{
 ViewData["SearchResult"] = MySearchBLL.GetSearchResults(id);

 return View("Index");
}

... 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T06:38:40.093

不，你不应该有。只需`View("ViewName");`在控制器中使用以在其他操作中显示适当的视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T06:52:15.587

在您建议的 URL 中，您应该有一个名为“搜索”的控制器方法，并为该控制器使用“索引”视图。

如果是这种情况，您可以将其发布回相同的操作，并在控制器中为“GET”和“POST”提供不同的代码集，以提供您正在寻找的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T13:57:13.297

让 HTML 表单发布到呈现它的相同操作。该操作可以决定它是非搜索（首次访问）还是搜索结果呈现。该操作可以填充`ViewData`适当的数据。也就是说，如果你想这样做。

你也可以有两个视图，真的很容易。并且动作可以透明地决定要渲染哪一个。

# c++ - 错误（文件）== 32

> ID：475652
> 
> 赞同：0
> 
> 时间：2009-01-24T06:47:28.343
> 
> 标签：c++, c, evc4

有时，当我像这样打开文件时：

```
FILE *file = fopen(fname, "wb");
if(!file) printf("Error code: %d\n",ferror(file)); 
```

我得到 32 的结果。这是什么意思？具体来说，对于 eMbedded Visual C++ 4.0

此外，eVC 似乎不支持 perror/errno :(

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T08:49:46.567

您以错误的方式使用 ferror() ：它仅适用于有效（非空）文件句柄。将其传递为 NULL（在 fopen() 失败的情况下）会导致 UB，这在您的情况下通过打印随机值来体现（不捕获 NULL 指针访问表明底层平台没有内存保护）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T06:52:22.437

您应该尝试测试 perror 所说的错误消息是什么。像这样使用：

```
perror("fopen"); 
```

它将输出如下消息：

```
fopen: <error description here> 
```

我想，由于您在文件对象为 NULL 时使用 ferror，因此错误 32 只是随机垃圾，正如另一个帖子提到的那样，可能缺少 NULL 指针捕获。使用 errno/perror 获取阻止您打开文件的错误。实际上，将 NULL 指针传递给 ferror 是非法的。

编辑：我发现该编译器不支持 perror 和 errno 令人惊讶。我建议您找到**正确**的错误检测功能并使用它。在这种情况下肯定不是ferror。

编辑：查看[GetLastError()](http://msdn.microsoft.com/en-us/library/ms679360(VS.85).aspx)和[FormatMessage()](http://msdn.microsoft.com/en-us/library/ms679351(VS.85).aspx)，应该支持它们。[http://msdn.microsoft.com/en-us/library/ms680582(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms680582(VS.85).aspx)也有一个使用示例。尽管您可能需要替换普通 C 函数的微软“安全字符串”函数。（例如：StringCchPrintf -> _snprintf/sprintf）

一点谷歌搜索表明这可能对你有用。这不是我的代码，但看起来很合理：

```
// OS provides a system error string
DWORD dwError = GetLastError();
CString csDescription;
FormatMessage( FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,
    NULL, dwError, MAKELANGID(LANG_NEUTRAL,SUBLANG_DEFAULT),
    csDescription.GetBuffer(255), nSize, NULL );
csDescription.ReleaseBuffer(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-13T19:23:57.387

[从这里](http://msdn.microsoft.com/en-us/library/t3ayayh1.aspx)看起来你的管道坏了

# java - 有没有办法将可序列化对象读/写到 RandomAccesFile？

> ID：475655
> 
> 赞同：3
> 
> 时间：2009-01-24T06:49:51.613
> 
> 标签：java, serialization

如何在 Java 中将可序列化对象实例读/写到 RandomAccessFile？我希望能够像在 c++ 中通过结构一样做到这一点。在 java 中，只有 ObjectInputStreams/ObjectOutputStreamscan 可以读/写对象。我很惊讶 Java 还没有实现一些东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-24T07:43:57.917

通过 ObjectOutputStream 将数据写入 ByteArrayOutputStream，然后您可以将 byte[] 放入随机访问文件中。你可以用同样的方法做相反的事情。

但是，您为什么要这样做？我怀疑有些产品可以为您执行此操作，例如可以持久保存到磁盘的缓存。在这种情况下，您可以只拥有一个将对象放入其中的 Map，而库会负责其余的工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-24T07:41:53.397

序列化的 Java 对象和使用 fwrite 写出的 C 结构之间存在差异：序列化的 Java 对象可能没有固定的字节大小。

> 我很惊讶 Java 还没有实现一些东西。

当然可以。较新版本的 Java 附带[Java DB](http://developers.sun.com/javadb/)，这是一个嵌入式数据库，可以满足您的需求，等等。（请注意，这种类型的数据库基本上是随机访问文件，它适用于字符串和数字等数据类型，而不是字节）。这确实有你必须编写一些 JDBC 样板的缺点。

如果您不介意包含外部依赖项，那么对象数据库（如[db4o](http://www.db4o.com/)）非常有趣并且需要最少的代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-24T12:56:46.553

我明白您为什么要这样做来读取旧文件格式。在这种情况下，默认的 Java 序列化机制是一个障碍，而不是帮助。在某种程度上，您*可以*使用反射来读/写类似结构的类。

示例代码：

```
public static class MyStruct {
    public int foo;
    public boolean bar = true;
    public final byte[] byteArray = new byte[3];
}

public static void main(String[] args) throws IOException {
    LegacyFileHandler handler = new LegacyFileHandler();
    MyStruct struct = new MyStruct();

    RandomAccessFile file = new RandomAccessFile("foo", "rw");
    try {
        for (int i = 0; i < 4; i++) {
            struct.foo = i;
            handler.write(file, struct);
        }

        struct = readRecord(file, handler, 2);
        System.out.println(struct.foo);
    } finally {
        file.close();
    }
}

private static MyStruct readRecord(RandomAccessFile file,
        LegacyFileHandler handler, int n) throws IOException {
    MyStruct struct = new MyStruct();

    long pos = n * handler.sizeOf(struct);
    file.seek(pos);

    handler.read(file, struct);

    return struct;
} 
```

处理程序类；可以处理原始类型和字节数组，但仅此而已：

```
public class LegacyFileHandler {

    private final Map<Class<?>, Method> readMethods = createReadMethodMap();

    private final Map<Class<?>, Method> writeMethods = createWriteMethodMap();

    private Map<Class<?>, Method> createReadMethodMap() {
        Class<DataInput> clazz = DataInput.class;
        Class<?>[] noparams = {};
        try {
            Map<Class<?>, Method> map = new HashMap<Class<?>, Method>();
            map.put(Boolean.TYPE, clazz.getMethod("readBoolean", noparams));
            map.put(Byte.TYPE, clazz.getMethod("readByte", noparams));
            map.put(Character.TYPE, clazz.getMethod("readChar", noparams));
            map.put(Double.TYPE, clazz.getMethod("readDouble", noparams));
            map.put(Float.TYPE, clazz.getMethod("readFloat", noparams));
            map.put(Integer.TYPE, clazz.getMethod("readInt", noparams));
            map.put(Long.TYPE, clazz.getMethod("readLong", noparams));
            map.put(Short.TYPE, clazz.getMethod("readShort", noparams));
            return map;
        } catch (NoSuchMethodException e) {
            throw new IllegalStateException(e);
        }
    }

    private Map<Class<?>, Method> createWriteMethodMap() {
        Class<DataOutput> clazz = DataOutput.class;
        try {
            Map<Class<?>, Method> map = new HashMap<Class<?>, Method>();
            map.put(Boolean.TYPE, clazz.getMethod("writeBoolean",
                    new Class[] { Boolean.TYPE }));
            map.put(Byte.TYPE, clazz.getMethod("writeByte",
                    new Class[] { Integer.TYPE }));
            map.put(Character.TYPE, clazz.getMethod("writeChar",
                    new Class[] { Integer.TYPE }));
            map.put(Double.TYPE, clazz.getMethod("writeDouble",
                    new Class[] { Double.TYPE }));
            map.put(Float.TYPE, clazz.getMethod("writeFloat",
                    new Class[] { Float.TYPE }));
            map.put(Integer.TYPE, clazz.getMethod("writeInt",
                    new Class[] { Integer.TYPE }));
            map.put(Long.TYPE, clazz.getMethod("writeLong",
                    new Class[] { Long.TYPE }));
            map.put(Short.TYPE, clazz.getMethod("writeShort",
                    new Class[] { Integer.TYPE }));
            return map;
        } catch (NoSuchMethodException e) {
            throw new IllegalStateException(e);
        }
    }

    public int sizeOf(Object struct) throws IOException {
        class ByteCounter extends OutputStream {
            int count = 0;

            @Override
            public void write(int b) throws IOException {
                count++;
            }
        }

        ByteCounter counter = new ByteCounter();
        DataOutputStream dos = new DataOutputStream(counter);
        write(dos, struct);
        dos.close();
        counter.close();
        return counter.count;
    }

    public void write(DataOutput dataOutput, Object struct) throws IOException {
        try {
            Class<?> clazz = struct.getClass();
            for (Field field : clazz.getFields()) {
                Class<?> type = field.getType();

                if (type == byte[].class) {
                    byte[] barray = (byte[]) field.get(struct);
                    dataOutput.write(barray);
                    continue;
                }

                Method method = writeMethods.get(type);
                if (method != null) {
                    method.invoke(dataOutput, field.get(struct));
                    continue;
                }

                throw new IllegalArgumentException("Type "
                        + struct.getClass().getName()
                        + " contains unsupported field type " + type.getName()
                        + " (" + field.getName() + ")");
            }
        } catch (IllegalAccessException e) {
            throw new IllegalArgumentException(e);
        } catch (InvocationTargetException e) {
            throw new IllegalStateException(e);
        }
    }

    public void read(DataInput dataInput, Object struct) throws IOException {
        try {
            Class<?> clazz = struct.getClass();
            Object[] noargs = {};
            for (Field field : clazz.getFields()) {
                Class<?> type = field.getType();

                if (type == byte[].class) {
                    byte[] barray = (byte[]) field.get(struct);
                    dataInput.readFully(barray);
                    continue;
                }

                Method method = readMethods.get(type);
                if (method != null) {
                    Object value = method.invoke(dataInput, noargs);
                    field.set(struct, value);
                    continue;
                }

                throw new IllegalArgumentException("Type "
                        + struct.getClass().getName()
                        + " contains unsupported field type " + type.getName()
                        + " (" + field.getName() + ")");
            }
        } catch (IllegalAccessException e) {
            throw new IllegalArgumentException(e);
        } catch (InvocationTargetException e) {
            throw new IllegalStateException(e);
        }
    }

} 
```

这段代码只经过了粗略的测试。

试图概括这样的读/写数据存在问题。

*   处理任何对象类型都很棘手，因为您必须自己将它们转换为字节数组并确保它们保持固定大小。
*   最大的问题可能是保持所有字符串的长度正确——您需要了解一些关于 unicode 的知识，以了解字符数和编码字节大小之间的关系。
*   Java 使用网络字节顺序并且没有真正的无符号类型。如果您正在读取遗留数据，您可能需要进行一些位操作。

如果我需要处理二进制格式，我可能会将功能封装在专门的类中，这些类将能够向 I/O 源写入/读取它们的状态。您仍然会遇到上面列表中的问题，但它是一种更加面向对象的方法。

如果我可以自由选择文件格式，我会采用[waqas 的建议](https://stackoverflow.com/questions/475655/is-there-a-way-for-reading-writing-serializable-objects-to-a-randomaccesfile#475704)并使用数据库。

# android - Android 上的 WebKit 可以使用哪些 DOM 事件？

> ID：475674
> 
> 赞同：33
> 
> 时间：2009-01-24T07:13:16.480
> 
> 标签：android, dom, webkit, dom-events

我正在构建一个针对 Android 用户的移动网络应用程序。我需要知道我可以使用哪些 DOM 事件。我已经能够完成以下工作，但不是非常可靠：

*   点击
*   鼠标移到
*   鼠标按下
*   mouseup
*   改变

我无法使以下工作：

*   按键
*   按键
*   键位

有谁知道支持什么以及在什么情况下的完整列表（例如，onchange 是否仅可用于表单输入？）？我在 Google 上找不到这方面的参考资料。

谢谢！

**更新：**我[在 Android 开发者列表上问了同样的问题](http://groups.google.com/group/android-developers/browse_thread/thread/b9e24e2b05f39c5a/81292b608623f643)。我会做更多的测试，并会在这里和那里发布我的结果。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-24T21:51:28.940

好的，这很有趣。`A`我的用例是我在 WebKit 视图的屏幕上有一系列链接（标签）。为了测试可用的事件区域，使用 jQuery 1.3.1，我将[这个页面](http://www.quirksmode.org/dom/events/ "QuirksMode.org 上的事件兼容性表")上列出的每个事件（即使是没有意义的事件）附加到链接上，然后使用 Android 模拟器上的向上、向下和输入控件并注意哪些事件在哪些情况下触发。

这是我用来附加事件的代码，结果如下。请注意，我使用的是“实时”事件绑定，因为对于我的应用程序，`A`标签是动态插入的。

```
$.each([
    'blur',
    'change',
    'click',
    'contextmenu',
    'copy',
    'cut',
    'dblclick',
    'error',
    'focus',
    'keydown',
    'keypress',
    'keyup',
    'mousedown',
    'mousemove',
    'mouseout',
    'mouseover',
    'mouseup',
    'mousewheel',
    'paste',
    'reset',
    'resize',
    'scroll',
    'select',
    'submit',

    // W3C events
    'DOMActivate',
    'DOMAttrModified',
    'DOMCharacterDataModified',
    'DOMFocusIn',
    'DOMFocusOut',
    'DOMMouseScroll',
    'DOMNodeInserted',
    'DOMNodeRemoved',
    'DOMSubtreeModified',
    'textInput',

    // Microsoft events
    'activate',
    'beforecopy',
    'beforecut',
    'beforepaste',
    'deactivate',
    'focusin',
    'focusout',
    'hashchange',
    'mouseenter',
    'mouseleave'
], function () {
    $('a').live(this, function (evt) {
        alert(evt.type);
    });
}); 
```

以下是它的震动方式：

*   在第一页加载时没有突出显示（任何项目周围都没有丑陋的橙色选择框），使用向下按钮选择第一个项目，触发以下事件（按顺序）：`mouseover`, `mouseenter`, `mousemove`,`DOMFocusIn`

*   选择一个项目，使用向下按钮移动到下一个项目，触发以下事件（按顺序）：`mouseout`, `mouseover`, `mousemove`, `DOMFocusOut`,`DOMFocusIn`

*   选择一个项目后，单击“输入”按钮，将触发以下事件（按顺序）：`mousemove`, `mousedown`, `DOMFocusOut`, `mouseup`, `click`,`DOMActivate`

这让我觉得是一堆随机垃圾。而且，谁是那个厚颜无耻的仅限 IE 的活动 ( `mouseenter`) 来客串，然后休息一天？哦，好吧，至少现在我知道要注意什么事件了。

如果其他人想要使用我的测试代码并进行更彻底的运行，可能会使用表单元素、图像等，那就太好了。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-11-03T15:39:05.387

由于这是 SO 上第二受欢迎的 Android + JavaScript 帖子（这只是对针对 Android 平台的 Web 开发状态的悲哀评论），我认为在 [http 上包含指向 pkk 的触摸事件测试结果的链接可能是值得的： //www.quirksmode.org/mobile/tableTouch.html](http://www.quirksmode.org/mobile/tableTouch.html)和[http://www.quirksmode.org/mobile/](http://www.quirksmode.org/mobile/)一般。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-07T07:12:26.060

从 Android 1.5 开始，iPhone 支持的相同 touch(start|move|end|cancel) 事件也可以在 Android 中工作。

我发现的一个问题是 touchmove 结束排队。还没有解决方法。

# function - 什么时候函数太长？

> ID：475675
> 
> 赞同：142
> 
> 时间：2009-01-24T07:13:39.663
> 
> 标签：function, refactoring, coding-style

35行、55行、100行、300行？你应该什么时候开始把它分开？我之所以问，是因为我有一个 60 行（包括注释）的函数，并且正在考虑将其拆分。

```
long_function(){ ... } 
```

进入：

```
small_function_1(){...}
small_function_2(){...}
small_function_3(){...} 
```

这些函数不会在 long_function 之外使用，制作更小的函数意味着更多的函数调用，等等。

你什么时候会把一个函数分解成更小的函数？为什么？

1.  方法应该只做一件合乎逻辑的事情（考虑功能）
2.  您应该能够用一句话解释该方法
3.  它应该适合您的显示器的高度
4.  避免不必要的开销（指出显而易见的评论......）
5.  小型逻辑功能的单元测试更容易
6.  检查部分函数是否可以被其他类或方法重用
7.  避免过度的类间耦合
8.  避免深度嵌套的控制结构

**感谢大家的回答**，编辑列表并投票给正确的答案，我会选择那个;）

我现在正在考虑这些想法进行重构:)

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2009-01-24T08:57:29.563

以下是可能表明函数太长的危险信号列表（无特定顺序）：

1.  **深度嵌套的控制结构**：例如，for 循环 3 级深度，甚至只有 2 级深度，嵌套的 if 语句具有复杂的条件。

2.  ***状态定义*参数过多**：*状态定义参数*是指保证通过函数的特定执行路径的函数参数。获取太多这些类型的参数，执行路径的组合就会爆炸式增长（这通常与 #1 一起发生）。

3.  **在其他方法中重复的逻辑**：糟糕的代码重用是单一程序代码的巨大贡献者。许多这样的*逻辑重复*可能非常微妙，但一旦重构，最终结果可能是一个更加优雅的设计。

4.  **过度的类间耦合**：缺乏适当的封装导致函数与其他类的密切特征有关，因此延长了它们。

5.  **不必要的开销**：指出明显的、深度嵌套的类、私有嵌套类变量的多余 getter 和 setter 以及异常长的函数/变量名称的注释都会在相关函数中产生语法噪音，最终会增加它们的长度。

6.  **您的大型开发级显示器不足以显示它**：实际上，今天的显示器足够大，以至于任何接近其高度的功能都可能太长了。但是，如果它**更大**，那就是有问题的确凿证据。

7.  **你不能立即确定函数的用途：此外，一旦***你*真正确定了它的用途，如果你不能用一句话概括这个用途或者碰巧非常头疼，这应该是一个线索。

总之，单一功能可能会产生深远的影响，并且通常是主要设计缺陷的症状。每当我遇到阅读起来绝对令人*愉悦*的代码时，它的优雅就立即显现出来。猜猜看：函数的长度通常*很*短。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2009-01-24T07:22:37.257

没有真正的硬性规定。一般来说，我喜欢我的方法只是“做一件事”。因此，如果它正在抓取数据，然后用该数据做某事，然后将其写入磁盘，那么我会将抓取和写入拆分为单独的方法，因此我的“主要”方法只包含“做某事”。

不过，“做某事”可能仍然有很多行，所以我不确定使用多少行是正确的度量标准:)

编辑：这是我上周在工作中邮寄的一行代码（为了证明一点……这不是我养成的习惯:)）-我当然不希望在我的方法中使用 50-60 个这些坏男孩:D

```
return level4 != null ? GetResources().Where(r => (r.Level2 == (int)level2) && (r.Level3 == (int)level3) && (r.Level4 == (int)level4)).ToList() : level3 != null ? GetResources().Where(r => (r.Level2 == (int)level2) && (r.Level3 == (int)level3)).ToList() : level2 != null ? GetResources().Where(r => (r.Level2 == (int)level2)).ToList() : GetAllResourceList(); 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-01-24T16:25:03.903

我认为这个页面上的“只做一件事”的口头禅有一个很大的警告。有时做一件事会影响很多变量。如果较小的函数最终具有较长的参数列表，请不要将较长的函数分解为一堆较小的函数。这样做只会将单个函数变成一组高度耦合的函数，没有真正的个体价值。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-01-24T07:20:35.263

一个函数应该只做一件事。如果你在一个函数中做很多小事，把每一个小事都变成一个函数，然后从长函数中调用这些函数。

您真正**不想**做的是将长函数的每 10 行复制并粘贴到短函数中（如您的示例所示）。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2009-01-24T15:06:53.513

我同意一个函数应该只做一件事，但那是什么级别的一件事。

如果您的 60 行正在完成一件事（从您的程序的角度来看）并且组成这 60 行的部分不会被其他任何东西使用，那么 60 行就可以了。

分解它并没有真正的好处，除非你能把它分解成独立的混凝土块。要使用的指标是功能而不是代码行。

我参与过许多程序，其中作者将唯一的一件事发挥到了极致，最终所做的只是让它看起来像是有人拿着手榴弹到一个函数/方法上，然后把它炸成几十个不相连的部分。很难跟上。

在提取该功能的各个部分时，您还需要考虑是否会增加任何不必要的开销并避免传递大量数据。

我相信关键是要在那个长函数中寻找可重用性并将这些部分拉出来。剩下的就是函数，不管它是 10 行、20 行还是 60 行。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-01-24T07:23:57.333

60 行对于一个函数来说很大但不会太长。如果它适合编辑器的一个屏幕，您可以一次看到所有内容。这实际上取决于函数在做什么。

为什么我可以分解一个函数：

*   太长了
*   通过分解代码并为新函数使用有意义的名称，它使代码更易于维护
*   函数没有凝聚力
*   部分功能本身很有用。
*   当很难为函数想出一个有意义的名字时（它可能做得太多了）

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-24T11:12:30.587

我个人的启发是，如果我不滚动就看不到整个东西，那就太长了。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-24T08:01:56.430

尺寸大约是你的屏幕尺寸（所以去找一个大的枢轴宽屏并转动它）...... :-)

开个玩笑，每个功能一件合乎逻辑的事情。

积极的一面是，使用只做一件事的小逻辑函数来进行单元测试真的要容易得多。做很多事情的大函数更难验证！

/约翰

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-01-24T08:56:12.013

经验法则：如果一个函数包含做某事的代码块，这与其余代码有些分离，请将其放在单独的函数中。例子：

```
function build_address_list_for_zip($zip) {

    $query = "SELECT * FROM ADDRESS WHERE zip = $zip";
    $results = perform_query($query);
    $addresses = array();
    while ($address = fetch_query_result($results)) {
        $addresses[] = $address;
    }

    // now create a nice looking list of
    // addresses for the user
    return $html_content;
} 
```

好多了：

```
function fetch_addresses_for_zip($zip) {
    $query = "SELECT * FROM ADDRESS WHERE zip = $zip";
    $results = perform_query($query);
    $addresses = array();
    while ($address = fetch_query_result($results)) {
        $addresses[] = $address;
    }
    return $addresses;
}

function build_address_list_for_zip($zip) {

    $addresses = fetch_addresses_for_zip($zip);

    // now create a nice looking list of
    // addresses for the user
    return $html_content;
} 
```

这种方法有两个优点：

1.  每当您需要获取某个邮政编码的地址时，您都可以使用现成的功能。

2.  当您需要`build_address_list_for_zip()`再次读取该函数时，您知道第一个代码块将要做什么（它获取某个邮政编码的地址，至少这是您可以从函数名称中得出的）。如果您将查询代码保留为内联，则首先需要分析该代码。

[另一方面（我会否认我告诉过你这一点，即使受到折磨）：如果你阅读了很多关于 PHP 优化的内容，你可能会想到尽可能少地使用函数，因为函数调用非常， PHP 非常昂贵。我不知道这一点，因为我从未做过任何基准测试。如果是这种情况，如果您的应用程序非常“性能敏感”，您可能最好不要遵循您的问题的任何答案;-)]

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-02-04T07:12:09.537

看看 McCabe 的圈，他在其中将他的代码分解成一个图形，其中，“图形中的每个节点对应于程序中的一个代码块，其中流程是连续的，弧对应于程序中的分支。 "

现在想象你的代码没有函数/方法；它只是图表形式的一大堆代码。

你想把这种蔓延分解成方法。考虑一下，当你这样做时，每个方法中都会有一定数量的块。每个方法中只有一个块对所有其他方法可见：第一个块（我们假设您只能在一个点跳转到一个方法：第一个块）。每个方法中的所有其他块都将是隐藏在该方法中的信息，但是方法中的每个块可能会跳转到该方法中的任何其他块。

要根据每个方法的块数确定方法的大小，您可能会问自己一个问题：我应该使用多少方法来最小化所有块之间的最大潜在依赖数 (MPE)？

这个答案是由一个方程给出的。如果 r 是最小化系统 MPE 的方法数，n 是系统中的块数，则等式为：r = sqrt(n)

并且可以证明，这使得每个方法的块数也为 sqrt(n)。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-24T16:05:57.933

请记住，您最终可能只是为了重构而进行重构，这可能会使代码比一开始更不可读。

我的一个前同事有一个奇怪的规则，一个函数/方法只能包含 4 行代码！他试图如此死板地坚持这一点，以至于他的方法名称经常变得重复且毫无意义，而且调用变得非常嵌套和混乱。

所以我自己的口头禅变成了：如果你想不出一个合适的函数/方法名称来为你重构的代码块，不要打扰。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-01-24T07:20:33.330

我通常分解一个函数的主要原因要么是因为它的零碎也是我正在编写的另一个附近函数的成分，所以公共部分被排除在外。此外，如果它使用了其他类中的大量字段或属性，则很有可能可以将相关块大量取出，并在可能的情况下移入其他类。

如果您的代码块顶部带有注释，请考虑将其拉出到函数中，并使用函数和参数名称说明其用途，并保留注释以说明代码的基本原理。

你确定那里没有在其他地方有用的部件吗？它是什么样的功能？

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-01-24T07:49:56.500

我通常通过放置描述下一个代码块的注释来分解功能。之前进入评论的内容现在进入新的函数名称。这不是硬性规则，但（对我来说）一个很好的经验法则。我更喜欢代码自己说话而不是需要注释的代码（因为我了解到注释通常会撒谎）

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-24T07:24:51.467

在我看来，答案是：当它做太多事情时。您的函数应该只执行您期望从函数本身的名称中获得的操作。另一件要考虑的事情是，如果您想在其他人中重用您的某些部分功能；在这种情况下，拆分它可能很有用。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-24T07:20:14.657

这部分是一个品味问题，但我如何确定这一点是我尽量只保留我的功能，只要一次适合我的屏幕（最多）。原因是如果您可以立即看到整个事情，就更容易理解正在发生的事情。

当我编写代码时，它混合了编写长函数，然后重构以提取可以被其他函数重用的位 - 以及编写执行离散任务的小函数。

我不知道对此有任何正确或错误的答案（例如，您可能会选择 67 行作为您的最大值，但有时可能需要添加更多行）。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-24T16:49:52.043

已经对这个主题进行了一些深入的研究，如果你想要最少的错误，你的代码不应该太长。但它也不应该太短。

我不同意一种方法应该适合您的显示器，但如果您向下滚动超过一页，则该方法太长。

有关进一步讨论，请参阅 [面向对象软件的最佳类大小。](http://www.ehealthinformation.ca/documents/1074.pdf)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-24T16:56:27.020

我之前写过 500 行函数，但是这些只是用于解码和响应消息的大开关语句。当单个消息的代码比单个 if-then-else 更复杂时，我将其提取出来。

本质上，虽然函数是 500 行，但独立维护的区域平均为 5 行。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-03-05T14:36:07.083

我通常使用测试驱动的方法来编写代码。在这种方法中，函数大小通常与测试的粒度有关。

如果您的测试足够集中，那么它将引导您编写一个小的集中函数来使测试通过。

这也适用于另一个方向。函数需要足够小才能有效地测试。因此，在处理遗留代码时，我经常发现我会分解更大的函数以测试它们的不同部分。

我通常会问自己“这个功能的职责是什么”，如果我不能用简洁明了的句子来说明职责，然后将其翻译成一个小的重点测试，我想知道这个功能是否太大了。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-03-05T15:09:31.590

如果它有三个以上的分支，通常这意味着应该将一个函数或方法拆分，以将分支逻辑封装在不同的方法中。

每个 for 循环、if 语句等都不会被视为调用方法中的一个分支。

用于 Java 代码的 Cobertura（我确信还有其他用于其他语言的工具）计算每个函数的函数中 if 等的数量，并将其求和为“平均圈复杂度”。

如果一个函数/方法只有三个分支，它将在该指标上得到三个，这非常好。

有时很难遵循此准则，即验证用户输入。然而，将分支放在不同的方法中不仅有助于开发和维护，而且还有助于测试，因为可以轻松分析执行分支的方法的输入，以查看需要将哪些输入添加到测试用例中以覆盖分支没有被覆盖。

如果所有分支都在一个方法中，则必须从方法开始就跟踪输入，这会妨碍可测试性。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-01-24T07:22:56.353

我想你会在这个问题上找到很多答案。

我可能会根据函数中正在执行的逻辑任务将其分解。如果您认为您的短篇小说正在变成一部小说，我建议您找到并提取不同的步骤。

例如，如果您有一个处理某种字符串输入并返回字符串结果的函数，您可能会根据将字符串拆分为多个部分的逻辑、添加额外字符的逻辑和放置它的逻辑来分解函数所有重新组合在一起作为格式化的结果。

简而言之，无论是使您的代码干净且易于阅读（无论是通过简单地确保您的函数具有良好的注释还是将其分解）都是最好的方法。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-24T07:40:35.367

假设您正在做*一*件事，长度将取决于：

*   你在做什么
*   你使用什么语言
*   你需要在代码中处理多少层抽象

60 行可能太长，也可能恰到好处。我怀疑它可能太长了。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-01-24T08:21:07.700

一件事（从函数名称中应该很明显），但无论如何都不过是一屏代码。并随意增加您的字体大小。如果有疑问，请将其重构为两个或更多功能。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-03-05T14:54:04.997

将鲍勃叔叔的推文的精神延续一段时间，当您觉得需要在两行代码之间放置一个空白行时，您就会知道函数变得太长了。这个想法是，如果你需要一个空行来分隔代码，那么它的职责和范围就是分开的。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-09-21T02:58:47.383

我的想法是，如果我不得不问自己它是否太长，那可能是太长了。它有助于在这个领域制作更小的功能，因为它可以在应用程序的生命周期后期提供帮助。

# c - 验证内存是否已在 C 中初始化

> ID：475686
> 
> 赞同：5
> 
> 时间：2009-01-24T07:23:42.123
> 
> 标签：c, memory-management

我编写了一个 API，需要初始化一个上下文，然后将其传递给每个 API 调用。调用者为上下文分配内存，然后将其与其他参数一起传递给 init 函数，这些参数描述了他们希望以后的 API 调用如何表现。上下文是不透明的，所以客户不能在那里乱七八糟；它仅用于 API 函数的内部使用。

我遇到的问题是调用者正在分配上下文，但没有初始化它。结果，后续的 API 函数引用了无意义的垃圾，就好像它是一个真实的上下文一样。

我正在寻找一种方法来验证传递给 API 函数的上下文是否已经被初始化。我不确定这是否可能。我想到的两个想法是：

1.  使用预定义的常量并将其存储在上下文的“魔术”字段中，以便在 API 调用时进行验证。
2.  使用上下文内容的校验和，将其存储在“魔术”字段中并在调用时对其进行验证。

不幸的是，我知道这些选项中的任何一个都可能导致误报验证，要么是因为内存中的随机垃圾与“魔术”数字匹配，要么是因为上下文恰好与先前初始化的上下文占用相同的空间。我认为后一种情况的可能性更大。

这是否简单地归结为概率问题？在大多数情况下我可以避免误报，但不是全部？是否值得使用一个仅仅给我一个合理的准确概率的系统，或者这只会让调试其他问题变得更加困难？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T07:29:10.707

我认为最好的解决方案是将 create()/delete() 函数添加到您的 API 并使用 create 来分配和初始化结构。您可以在结构的开头放置一个签名，以验证您传递的指针是否指向使用 create() 分配的内存，并在释放内存之前使用 delete() 覆盖签名（或整个缓冲区）。

您实际上无法避免 C 中的误报，因为调用者 malloc 的内存“发生”以您的签名开始；但是让你的签名相当长（比如 8 个字节）并且几率很低。不过，通过提供 create() 函数将分配从调用者手中夺走将有很长的路要走。

而且，是的，您最大的风险是初始化的缓冲区在不使用 delete() 的情况下被释放，并且随后的 malloc 碰巧重用了该内存块。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T08:31:52.750

您的上下文变量目前可能是某种指向已分配内存的指针。取而代之的是，使其成为可以显式验证的令牌或句柄。每次初始化上下文时，您都会返回一个新标记（不是实际的上下文对象）并将该标记存储在内部列表中。然后，当客户稍后为您提供上下文时，您可以通过查看列表来检查它是否有效。如果是，则可以将令牌转换为实际上下文并使用，否则返回错误。

```
typedef Context long;

typedef std::map<Context, InternalContext> Contexts;
Contexts _contexts;

Context nextContext()
{
  static Context next=0;
  return next++;
}

Context initialise()
{
  Context c=nextContext();
  _contexts.insert(make_pair(c, new InternalContext));
  return c;
}

void doSomethingWithContext(Context c)
{
  Contexts::iterator it=_ _contexts.find(c);
  if (it==_contexts.end())
    throw "invalid context";
  // otherwise do stuff with the valid context variable
  InternalContext *internalContext=*it.second;
} 
```

使用此方法，不会存在无效内存访问的风险，因为您只会正确使用有效的上下文引用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-24T09:49:30.893

查看 Matt Bishop 关于[鲁棒编程](http://nob.cs.ucdavis.edu/bishop/secprog/robust.html)的论文。使用票据或令牌（在某些方面类似于文件句柄，但也包括一个 nonce - 使用一次的数字）允许您的库代码确保它使用的令牌是有效的。实际上，您代表用户分配数据结构，并将票证传回给用户，每次调用您定义的 API 时必须提供该票证。

我有一些基于该系统的代码。标题包括注释：

```
/*
** Based on the tickets in qlib.c by Matt Bishop (bishop@ucdavis.edu) in
** Robust Programming.  Google terms: Bishop Robust Nonce.
** http://nob.cs.ucdavis.edu/~bishop/secprog/robust.pdf
** http://nob.cs.ucdavis.edu/classes/ecs153-1998-04/robust.html
*/ 
```

我还构建了一个基于竞技场的内存分配系统，使用票证来识别不同的竞技场。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T07:32:13.370

您可以定义一个新的 API 调用，该调用采用未初始化的内存并以您需要的任何方式对其进行初始化。然后，客户端 API 的一部分是客户端必须调用上下文初始化函数，否则将导致未定义的行为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T07:28:54.483

为了回避重用先前上下文的内存位置的问题，除了释放上下文之外，您还可以重置它并删除“魔术”数字，当然假设用户使用您的 API 释放上下文。这样，当系统为下一个上下文请求返回相同的内存块时，幻数检查将失败。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T08:11:13.353

看看你的系统对未初始化的内存做了什么。m$ 确实：[VC++ 中未初始化的内存块](https://stackoverflow.com/questions/65724/uninitialized-memory-blocks-in-vc)

# c# - c# 中是否有任何算法来单数化 - 复数一个单词？

> ID：475705
> 
> 赞同：110
> 
> 时间：2009-01-24T07:42:08.840
> 
> 标签：c#, algorithm

c# 中是否有任何算法来单数化 - 复数一个单词（英文）或是否存在一个 .net 库来执行此操作（可能也使用不同的语言）？

* * *

## 回答 #1

> 赞同：187
> 
> 时间：2010-03-08T22:30:18.910

您还有[System.Data.Entity.Design.PluralizationServices.PluralizationService](http://msdn.microsoft.com/en-us/library/system.data.entity.design.pluralizationservices.pluralizationservice.aspx)。

**更新**：旧答案值得更新。现在还有 Humanizer：[https ://github.com/MehdiK/Humanizer](https://github.com/MehdiK/Humanizer)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-24T07:52:46.200

我可以为世界语做到这一点，没有特殊情况！

```
string plural(string noun) { return noun + "j"; } 
```

对于英语，熟悉名词规则[复数](http://web2.uvcs.uvic.ca/elc/studyzone/330/grammar/plural.htm)和[不规则](http://web2.uvcs.uvic.ca/elc/studyzone/330/grammar/irrplu.htm)名词复数的规则会很有用。有一整篇关于[英语复数](http://en.wikipedia.org/wiki/English_plural)的维基百科文章，其中可能也有一些有用的信息。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-24T07:46:47.130

大多数 ORM 都有尝试，尽管它们通常并不完美。我知道 Castle 有它的[Inflector 类](http://api.castleproject.org/html/T_Castle_ActiveRecord_Framework_Internal_Inflector.htm)，你可能可以四处寻找。不过，“完美”地做到这一点并不是一件容易的事（英语“规则”并不是真正的规则:)），所以这取决于你是否对“合理猜测”的方法感到满意。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-24T07:54:09.283

我在 Java 中作弊——我希望能够为“有 n 个东西”生成一个正确的字符串，所以我写了下面的代码。小重载实用方法：

```
static public String pluralize(int val, String sng) {
    return pluralize(val,sng,(sng+"s"));
    }

static public String pluralize(int val, String sng, String plu) {
    return (val+" "+(val==1 ? sng : plu)); 
    } 
```

像这样调用

```
System.out.println("There were "+pluralize(count,"something"));
System.out.println("You have broken "+pluralize(count,"knife","knives")); 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2011-03-04T01:33:36.963

我在 .net (C#) 中为此创建了一个小型库，称为 Pluralizer（不出所料）。

它适用于完整的句子，就像 String.Format 一样。

它基本上是这样工作的：

```
var target = new Pluralizer();
var str = "There {is} {_} {person}.";

var single = target.Pluralize(str, 1);
Assert.AreEqual("There is 1 person.", single);

// Or use the singleton if you're feeling dirty:
var several = Pluralizer.Instance.Pluralize(str, 47);
Assert.AreEqual("There are 47 people.", several); 
```

它还可以做更多的事情。[在我的博客上](http://jasonq.com/index.php/pluralizer)阅读有关它的更多信息。它在 NuGet 中也可用。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2010-01-12T19:12:29.863

我根据 Rails 的复数形式将其中一个组合在一起。[你可以在这里](http://mattgrande.wordpress.com/2009/10/28/pluralization-helper-for-c/)查看我的博文，或者[在 github 上查看](https://github.com/mattgrande/Grande.Pluralizer)

```
output = Formatting.Pluralization(100, "sausage"); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-02-08T11:34:19.870

由于问题是针对 C#，这里是 Software Monkey 解决方案的一个很好的变体（同样有点“作弊”，但对我来说确实是最实用和可重用的方法）：

```
 public static string Pluralize(this string singularForm, int howMany)
    {
        return singularForm.Pluralize(howMany, singularForm + "s");
    }

    public static string Pluralize(this string singularForm, int howMany, string pluralForm)
    {
        return howMany == 1 ? singularForm : pluralForm;
    } 
```

用法如下：

```
"Item".Pluralize(1) = "Item"
"Item".Pluralize(2) = "Items"

"Person".Pluralize(1, "People") = "Person"
"Person".Pluralize(2, "People") = "People" 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-08-28T09:43:35.527

Subsonic 3 有一门[`Inflector`](http://github.com/subsonic/SubSonic-3.0/blob/c8a7add431114f0382bdaa33f7aedbaab7d89ba7/SubSonic.Core/Extensions/Inflector.cs)课程让我印象`Person`深刻`People`。我看了看源代码，发现它自然地用硬编码列表作弊，但这确实是用英语做这件事的唯一方法，也是人类如何做的——我们记住每个单词的单数和复数，而不仅仅是应用规则. 由于没有男性/女性（/中性）可以添加到组合中，因此要简单得多。

这是一个片段：

```
AddSingularRule("^(ox)en", "$1");
AddSingularRule("(vert|ind)ices$", "$1ex");
AddSingularRule("(matr)ices$", "$1ix");
AddSingularRule("(quiz)zes$", "$1");

AddIrregularRule("person", "people");
AddIrregularRule("man", "men");
AddIrregularRule("child", "children");
AddIrregularRule("sex", "sexes");
AddIrregularRule("tax", "taxes");
AddIrregularRule("move", "moves");

AddUnknownCountRule("equipment"); 
```

它解释了一些没有复数等价词的词，例如设备示例。正如您可能知道的那样，它`Regex`使用 $1 进行了简单的替换。

**更新：**
看来 Subsonic 的`Inflector`实际上是[Castle ActiveRecord`Inflector`](https://svn.castleproject.org/svn/castle/trunk/ActiveRecord/Castle.ActiveRecord/Framework/Internal/Inflector.cs)类！

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-09-24T00:32:02.413

MSDN 关于 PluralizationService 类的具体用法的文档不多，所以这里有一个单元测试类 (NUnit) 来展示基本用法。请注意底部的奇怪测试用例，它表明服务在涉及非标准复数形式时并不完美。

```
[TestFixture]
public class PluralizationServiceTests
{
    [Test]
    public void Test01()
    {
        var service = PluralizationService.CreateService(CultureInfo.CurrentCulture);

        Assert.AreEqual("tigers", service.Pluralize("tiger"));
        Assert.AreEqual("processes", service.Pluralize("process"));
        Assert.AreEqual("fungi", service.Pluralize("fungus"));

        Assert.AreNotEqual("syllabi", service.Pluralize("syllabus")); // wrong pluralization
    }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-02-03T00:42:18.937

使用 Microsoft 的 Northwind 示例数据库：

```
 System.Data.Entity.Design.PluralizationServices.PluralizationService.CreateService(new System.Globalization.CultureInfo("en-US")); 
```

Singularize does not Singularize "Order_Details" It returns "Order_Details" with the `s` at the end. What is the work around?

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-09-24T22:56:35.647

此页面显示如何使用`PluralizationService`( `System.Data.Entity`.NET Framework 4.0)

[http://zquanghoangz.blogspot.it/2012/02/beginner-with-pluralizationservices.html](http://zquanghoangz.blogspot.it/2012/02/beginner-with-pluralizationservices.html)

# url - 为什么我应该使用“Web 2.0”风格的 URL？

> ID：475707
> 
> 赞同：8
> 
> 时间：2009-01-24T07:45:08.350
> 
> 标签：url, clean-urls

简而言之，为什么要使用类似`http://stackoverflow.com/badges/6/supporter`的东西而不是“更简单”的东西（并且主观上是这样）`http://stackoverflow.com/badges/6/`。

即使在我自己的网站上，我也只是使用 /post/6/ 来引用帖子（通过 ID，即使我仍然存储一个 slug。）而不是`/post/6/small-rant-on-urls`，并且在某些情况下，它们会变得***更加荒谬***，更是如此比真的必要。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-24T07:48:00.107

[搜索引擎优化](http://en.wikipedia.org/wiki/Search_engine_optimization)将是其中之一，并使 URL 对人类更具可读性。搜索引擎通常喜欢你的 URL、Title 和 H2 来包含页面的“主题”。

如果你两者都在那里，那么你可以手动输入 /ID 并通过重写自动带到“华丽”的 URL .. 节省你的手指 :)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-24T08:08:49.317

因为如果你不小心，你可能会得到重复。我想堆栈溢出添加了 ID，因为考虑到创建的帖子数量，重复的可能性很大。

其他系统可能选择不使用 URL 中的 ID - 例如，博客系统可能不需要。

如果您有用户生成的内容会导致创建一个包含帖子 ID 的新 URL，这是一个更好的主意。如果创建新 URL 的唯一方法是通过管理员类型访问，那么只要检查重复项，您就可以不用它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-24T07:48:04.820

*在内容的所有链接中*添加 slug有助于搜索引擎，因为搜索引擎通常会使用 URL 本身中的单词来帮助索引内容。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-24T08:07:11.130

在 url 中包含 id 的原因是它可以更容易地在幕后从数据库中检索正确的文章，因为可以对 ID 而不是文章的标题执行查找。

包含文章完整标题的原因是，Google 会为文件名中匹配的搜索词提供大量奖励积分。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-24T14:48:56.653

URL 是 Web 用户界面的一部分。

有[一项关于搜索引擎使用](http://209.85.129.132/search?q=cache:0qgyhw-TUOoJ:ftp://ftp.research.microsoft.com/pub/tr/TR-2007-01.pdf+eyetracking+study+of+search+engine+use&hl=en&ct=clnk&cd=1&gl=it&client=firefox-a)的眼动追踪研究发现，人们花费**24% 的凝视时间查看**搜索结果中的 URL。

搜索者在评估目的地的可信度和有用性时对 URL 特别感兴趣。如果 URL 看起来像垃圾，人们就不太可能点击该搜索命中。另一方面，如果 URL 看起来像页面会解决用户的问题，那么他们更有可能点击。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-24T07:58:43.113

@格雷格休吉尔

> 在内容的所有链接中添加 slug 有助于搜索引擎，因为搜索引擎通常会使用 URL 本身中的单词来帮助索引内容。

我应该澄清一下：我的意思是同时包含 id**和**slug 的 URL。我只是看不出有类似`/post/1/la-la-la-la-text-hahahaha`vs`/post/1/` **或** `/post/la-la-la-la-text-hahahaha`之类的东西的意义，因为第一个可以在没有多余文本的情况下工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-24T08:10:29.673

通过 id 在博客中获取帖子可能比通过 slug 更快，因此将 id 用于 SQL 查询，将 slug 用于搜索引擎 (SEO)。

[https://stackoverflow.com/users/58163/movaxes65675](https://stackoverflow.com/users/58163/movaxes65675)

我喜欢 /post/la-la-la-la-text-hahahaha 类型，我可以记住网址，知道帖子的标题是什么（在实际加载网站之前）。不太喜欢 /post/1/ 它对我来说没有任何意义，但帖子 #1 （不利于营销？）

编辑： id 也有助于避免像 andybaird 指出的重复

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-25T00:30:00.087

嗯，首先应该指出，“Web 2.0 风格的 URL”实际上是称为[REST](http://en.wikipedia.org/wiki/Representational_State_Transfer)的东西的一部分。这些 URL 有时称为 RESTful URL。声称的[好处](http://en.wikipedia.org/wiki/Representational_State_Transfer#Claimed_benefits)是：

> *   由于支持缓存表示，因此提供了改进的响应时间并减少了服务器负载；
> *   通过减少维护会话状态的需要来提高服务器的可伸缩性。这意味着可以使用不同的服务器来处理会话中的不同请求；
> *   与其他方法相比，需要编写更少的客户端软件，因为单个浏览器可以访问任何应用程序和任何资源；
> *   较少依赖供应商软件和机制，这些软件和机制在 HTTP 之上添加了额外的消息传递框架；
> *   与替代通信方法相比，提供等效的功能；
> *   由于在表示中使用了超链接，因此不需要单独的资源发现机制；
> *   提供比 RPC 更好的长期兼容性和可演化特性。这是因为：
>     *   文档类型（如 HTML）在不破坏向后或向前兼容性的情况下发展的能力；和
>     *   资源在不放弃或减少对旧内容类型的支持的情况下添加对定义的新内容类型的支持的能力。

# file - 无法将 Java 源文件粘贴到 IntelliJ IDEA

> ID：475713
> 
> 赞同：2
> 
> 时间：2009-01-24T07:49:33.350
> 
> 标签：file, intellij-idea, copy-paste

我最近搬到了 IntelliJ IDEA。我需要在我的项目中的一个包中添加几个文件。

问题是我无法将这些文件粘贴到该包中。我还尝试在资源管理器中粘贴文件并在 IntelliJ IDEA 中按 F5，但它不起作用。

除了手动创建这些源文件之外，如何将文件复制到 IntelliJ 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T08:12:24.693

出于某种原因，现在下拉菜单中提供了两个或三个不同的粘贴功能。其中之一通常有效。文件菜单下还有一个*同步*按钮，可以在出现不一致时使用，但坦白说我很少使用同步按钮。

我不知道为什么会有这么多不同的粘贴函数，而且在一个以其一般的好而闻名的 IDE 中它绝对不是很好；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-31T12:25:22.787

将一对一的文件复制到 intellj 中的目标位置。几个选定的文件不起作用。

# design-patterns - 适合任务的设计模式

> ID：475717
> 
> 赞同：2
> 
> 时间：2009-01-24T07:53:37.773
> 
> 标签：design-patterns, oop

我需要以各种格式保存图像文件。格式列表会经常更改，因此我希望保存的内容非常可扩展。此外，可以在许多地方（硬盘、ftp、http 等）进行保存。保存*位置*列表也将经常更改。

我想我会为每种格式使用一个基础 Image 类和许多派生类：

```
ImageBase {}
JpegImage : ImageBase {}
TiffImage : ImageBase{} 
```

并适当地处理每个子类中的保存以进行格式化。这是一个好的设计决策吗？

另外，如何附加可扩展的*保存位置*机制（Ftp、文件共享等）？

我想要这样的东西：

```
var image=ImageBase.GetImageFromDisk(path);
//some casting to subclass maybe??
var tiffImage=image as TiffImage;
tiffImage.Location=new FtpLocation();//not sure if this is a good idea
tiffImage.Save(); 
```

这里的问题是，具体的图像实现不应该知道或关心保存位置。在调用`Save();`图像子类时，我想将工作委托给某个类，例如`FtpLocation`.

请建议如何将这些部分放在一起。

谢谢你。

瓦伦丁。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-24T07:59:24.937

首先，我会在您的图像上实现流。通过这种方式，您可以从流中创建构造函数，以及为任何“图像”子类创建流的方法。

此外，我将创建您的“保存”基础架构，以简单地接受流并将它们写入您的适当技术（ftp、文件等）

这样你最终得到了可扩展的图像（如果你可以得到一个流，你可以做很多很多事情），你最终得到一个可扩展的保存基础设施（任何可以进入流的东西都可以保存）

编辑：就个人而言，数据类型对象的保存方法听起来像是在错误的位置，但在不了解您的整个系统的情况下，我不能肯定地说。只是我的2c。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T08:03:32.137

在我看来，具体类应该只处理原始数据；这可能是写入本地文件（然后由基本代码处理），或写入流。

例如，也许是这样的：

```
public void Save()
{
    // TODO: add any language-specific constructs like "using", etc
    Stream stream = Location.OpenWrite();
    Save(stream);
    stream.Close();
}

protected abstract void Save(Stream stream); 
```

因此，`Location`负责提供一个流（可以是内存流、传输流、临时文件流等），并在该流关闭时可选地做额外的工作（通过装饰器模式封装内部流） . 子类所做的只是写入流。

加载有点棘手，因为基类可能必须（鉴于您建议的基类静态加载）查看流以识别类型。但最终，你可能会有类似的东西：

```
public static ImageBase Load(Location location)
{
    // TODO: add any language-specific constructs like "using", etc
    Stream stream = location.OpenRead();
    // TODO: wrap in a buffered/seekable stream so we can peek
    // TODO: parse headers and resolve image type
    ImageBase image = ...
    image.Location = location;
    stream.Position = 0; // rewind buffered/seekable stream
    // (don't use Load() since we have already opened the stream)
    image.Load(stream);
    stream.Close();
    return image;
}
protected abstract void Load(Stream stream);
public void Load()
{
    // TODO: add any language-specific constructs like "using", etc
    Stream stream = Location.OpenRead();
    Load(stream); // don't need to buffer if loading from subclass
    stream.Close();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T13:24:00.227

我会采取稍微不同的方式。（语法是 Java。）

```
public class Image {
    public void load(byte[] imageData);
    public byte[] getImageData();
}

public class JpegImage extends Image {
    public void load(byte[] imageData) {
        /* decode image data. */
    }

    public byte[] getImageData() {
        /* encode and return the JPG data. */
    }
}

public class Location {
    public Image loadImage(String uri);
    public void saveImage(Image image);
}

public class HttpLocation extends Location {
    public Image loadImage(String uri) {
        byte[] = getData(uri);
        if (type == JPEG) {
            return new JpegImage().load(byte);
        } else if (type == PNG) {
            return new PngImage().load(byte);
        }
    }
    public void saveImage(Image image) {
        byte[] imageData = image.getImageData();
        /* upload. */
    }
} 
```

从 Web 服务器的内容类型到 Image 类的映射也可以在 Location 基类（或完全不同的帮助器类）中以更可重用的方式发生，但这就是我将如何做到的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T08:13:09.853

在 ImageBase 类中实现 Save()，而不是在派生类中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T08:49:21.530

我认为为保存/加载子类化图像本身不是一个正确的想法，因为您将没有实例来调用加载。此外，内存中的图像与原始格式完全无关——例如，绝对可以打开 jpg 然后将其另存为 png。

我会这样做：

```
Image

ImageFormat { Save(Image, Stream); Image Load(Stream); }
JpegFormat : ImageFormat {}
TiffFormat : ImageFormat {} 
```

现在对于该位置，您只需提供一种获取读取流和写入流的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T13:28:51.497

对于图像，我会选择继承。对于加载/保存部分，我会采用策略设计模式，这样每个图像都可以有一个 LoadingAlgorithm 和一个 SavingAlgorithm 。这样，您可以改变加载和保存过程，而不必创建 Image 类的加载和保存方法。

# c# - 从另一个列表中过滤列表对象

> ID：475725
> 
> 赞同：3
> 
> 时间：2009-01-24T08:01:37.570
> 
> 标签：c#, generics, checkedlistbox

我的 C# .NET 3.5 win forms 应用程序中有以下类：

```
class Field {

string objectName;
string objectType;
string fieldName;
string fieldValue;

} 
```

和一个 List fieldList，它是一个选中列表框的数据源。这个列表框显示了我的 fieldList 集合中所有不同的对象名称。

我想创建另一个包含 fieldNames 的选中列表框，但仅显示在第一个列表框中具有关联的选中 objectName 的字段名。

所以我的问题是如何查询原始 objectNames 列表的 DataSource 以返回与所选 objectName 关联的不同字段名称集？

这不是很容易阅读，所以我将举一个例子：

```
Field1 {

objectName = 'objA'
FieldName = 'FieldA'

}

Field2 {

objectName = 'objA'
FieldName = 'FieldB'

}

Field3 {

objectName = 'objB'
FieldName = 'FieldA'

}

Field4 {

objectName = 'objC'
FieldName = 'FieldC'

} 
```

所以假设在我的复选框中我选择了 objectNames objA 和 objB。然后我返回的字段将是“FieldA”和“FieldB”。

如何使用 LINQ 或过滤我的通用字段列表来实现这一点？我可以使用列表可用的“选择”或“位置”方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T08:22:33.783

首先，将对象名称读入数组或列表；我会伪造那部分。那么它应该是这样的：

```
 string[] objectNames = { "objA", "objC" };
    var hashSet = new HashSet<string>(objectNames);

    var qry = (from row in data
               where hashSet.Contains(row.objectName)
               select row.fieldName).Distinct().ToList(); 
```

（编辑）

要获得选定的名称（我伪造的位），您可以尝试（未经测试）：

```
 var selectedNames = namesCheckedListBox.CheckedItems.Cast<Field>()
        .Select(field => field.objectName);
    var hashSet = new HashSet<string>(selectedNames); 
```

（注意不需要`Distinct()`在上面使用，因为`HashSet<T>`无论如何都是这样）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T08:09:26.680

```
var selectedNames = ... // List of selected names
var selectedFields = (from f in fieldList
                      where selectedNames.Contains(f.objectName)
                      select f.FieldName).Distinct().ToList(); 
```

# c++ - 运算符重载

> ID：475750
> 
> 赞同：1
> 
> 时间：2009-01-24T08:41:55.287
> 
> 标签：c++

```
class test {
public:
    test &operator=(const test & other){} // 1
    const test & operator+(const test& other) const {} // 2
    const test & operator+(int m) {} //3
private:
    int n;
};

int main()
{
test t1 , t2, t3;

// this works fine  t1 = t2.operator+(t3) , calls  2 and 1
t1 = t2 + t3; 

// this works fine    t1 = t2.operator+ (100). calls 3 and 1
t1 = t2 + 100;

//this works fine t1 = (t2.operator+ (100)).operator+ (t3)
t1 = t2 + 100 +t3;

//why is the error in this one  ????
// it should be t1 = (t2.operator+ (t3)).operator+ (100)
t1  =  t2 + t3 + 100; 

return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T08:54:02.563

因为 t2+t3 返回的对象是 const 的，不能调用它的非常量函数（3）。

在“t1 = t2 + 100 +t3;”的情况下它工作正常，因为 t2+1​​00 返回的对象也是 const，但是你调用它的 const 函数（2），这没关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T08:57:28.750

1.  更改 X 进行测试。
2.  在倒数第二条语句的末尾添加分号。
3.  在您修改它们时，从加法运算符返回值中删除 const。

以下编译：

```
class test {
 public:
  test& operator=(const test & other){} // 1
  test& operator+(const X& other) const {} // 2
  test& operator+(int m) {} //3
 private:
  int n;
};

int main()
{
  test t1, t2, t3;

  t1 = t2 + t3; 
  t1 = t2 + 100;
  t1 = t2 + 100 + t3;  // <-- added a ';'
  t1 = t2 + t3 + 100; 

  return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T15:30:57.273

你错过了一个常量：

```
const test & operator+(int m) /* ADD CONST HERE */ const {} //3 
```

# qt - 如何确定 Qt 在运行时运行的平台？

> ID：475758
> 
> 赞同：28
> 
> 时间：2009-01-24T08:54:53.827
> 
> 标签：qt, qt4, cross-platform

是否有（Qt）方法来确定 Qt 应用程序在运行时运行的平台？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2011-02-08T20:08:21.017

> 意图：虽然我讨厌提出一个将近 2 年的问题，但我认为一个好的修正答案值得记录在案，以便最终解决这个问题的其他人可以以正确的方式做到这一点。

我不禁注意到，大多数答案都建议使用 Q_WS 宏集来确定操作系统，这不是一个好的解决方案，因为 Q_WS_* 指的是窗口系统而不是操作系统平台（例如。 X11 可以在 Windows 或 Mac OS X 上运行，然后呢？），因此不应遵循这些宏来确定应用程序编译的平台。

相反，应该使用 Q_OS_* 一组具有确定操作系统的精确目的的宏。

该集当前包含 Qt 4.8 的以下宏：

```
Q_OS_AIX
Q_OS_BSD4
Q_OS_BSDI
Q_OS_CYGWIN
Q_OS_DARWIN
Q_OS_DGUX
Q_OS_DYNIX
Q_OS_FREEBSD
Q_OS_HPUX
Q_OS_HURD
Q_OS_IRIX
Q_OS_LINUX
Q_OS_LYNX
Q_OS_MAC
Q_OS_MSDOS
Q_OS_NETBSD
Q_OS_OS2
Q_OS_OPENBSD
Q_OS_OS2EMX
Q_OS_OSF
Q_OS_QNX
Q_OS_RELIANT
Q_OS_SCO
Q_OS_SOLARIS
Q_OS_SYMBIAN
Q_OS_ULTRIX
Q_OS_UNIX
Q_OS_UNIXWARE
Q_OS_WIN32
Q_OS_WINCE 
```

参考：

*   Qt 4 [https://doc.qt.io/archives/qt-4.8/qtglobal.html](https://doc.qt.io/archives/qt-4.8/qtglobal.html)
*   Qt 5 [https://doc.qt.io/qt-5/qtglobal.html](https://doc.qt.io/qt-5/qtglobal.html)
*   Qt 6 [https://doc.qt.io/qt-6/qtglobal.html](https://doc.qt.io/qt-6/qtglobal.html)

注意：正如 Wiz 在评论中提到的，Qt 5 完全删除了 Q_WS_* 宏集，因此现在您只能使用 Q_OS_* 宏。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-01-24T18:27:08.710

请注意，Q_WS_* 宏是在编译时定义的，但 QSysInfo 提供了一些运行时的详细信息。

要扩展 gs 的功能以在运行时获取特定的 windows 版本，您可以这样做

```
#ifdef Q_WS_WIN
switch(QSysInfo::windowsVersion())
{
  case QSysInfo::WV_2000: return "Windows 2000";
  case QSysInfo::WV_XP: return "Windows XP";
  case QSysInfo::WV_VISTA: return "Windows Vista";
  default: return "Windows";
}
#endif 
```

和 Mac 类似。

如果您使用的是 Qt 5.9 或更高版本，请使用下面提到的库函数来检索正确的操作系统详细信息，更多信息可以在[这里](https://doc.qt.io/qt-5/qoperatingsystemversion.html)找到。还有一个[QSysInfo](https://doc.qt.io/qt-5/qsysinfo.html)类可以做一些额外的功能。

```
#ifdef Q_WS_WIN
#include <QOperatingSystemVersion>

switch(QOperatingSystemVersion::current())
{
  case QOperatingSystemVersion::Windows7: return "Windows 7";
  case QOperatingSystemVersion::Windows8: return "Windows 8";
  case QOperatingSystemVersion::Windows10: return "Windows 10";
  default: return "Windows";
}
#endif 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-10-30T18:32:57.657

对于**Qt5**，我使用以下内容：

```
logging.info("##### System Information #####")
sysinfo = QtCore.QSysInfo()
logging.info("buildCpuArchitecture: " + sysinfo.buildCpuArchitecture())
logging.info("currentCpuArchitecture: " + sysinfo.currentCpuArchitecture())
logging.info("kernel type and version: " + sysinfo.kernelType() + " " + sysinfo.kernelVersion())
logging.info("product name and version: " + sysinfo.prettyProductName())
logging.info("#####") 
```

文档：[http ://doc.qt.io/qt-5/qsysinfo.html](http://doc.qt.io/qt-5/qsysinfo.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-12T21:43:53.540

这是我的代码的一部分，用于在运行时检测 windows 或 mac 和版本

```
 #include <QSysInfo>
        #include <QOperatingSystemVersion>
        auto OSType= OSInfo.type();
        auto OSInfo = QOperatingSystemVersion::current();

        if (OSType !=1) //not windows os
        {
            return 0;
        }

        if (OSInfo < QOperatingSystemVersion::Windows7) // less than win7
        {
            return 0;
        } 
```

# c# - 如果您在应用程序中使用 System.Timers.Timer，是否有必要处理它？

> ID：475763
> 
> 赞同：44
> 
> 时间：2009-01-24T09:01:12.440
> 
> 标签：c#, .net, timer, dispose

我在我的应用程序的一个类中使用 System.Timers.Timer 类。我知道 Timer 类具有从实现 IDisposable 接口的父 Component 类继承的 Dispose 方法。下面的类的实例在我的应用程序生命周期中被创建了很多次；它们中的每一个都有一个 Timer 类的实例，该实例在类的生命周期中不断地生成 Elapsed 事件。我应该在使用 Timer 类来处理计时器对象的类中实现 IDisposable 接口吗？（我见过根本不这样做的代码）。如果我像这样使用下面的类，我担心一些非托管资源不会被释放：

```
SomeClass someClass = new SomeClass();
someClass.DoSomething();
someClass = null; 
```

班上：

```
using System.Timers;

public class SomeClass
{
    private Timer m_timer;

    public SomeClass()
    {           
        m_timer = new Timer();
        m_timer.Interval = 1000;
        m_timer.Elapsed += new ElapsedEventHandler(m_timer_Elapsed);
        m_timer.AutoReset = false;
        m_timer.Start();                       
    }

    public void DoSomething()
    {

    }

    private void m_timer_Elapsed(object sender, ElapsedEventArgs e)
    {
        try
        {
            //Do some task
        }
        catch (Exception ex)
        {
            //Ignore
        }
        finally
        {
            if (m_timer != null)
            {
                //Restart the timer
                m_timer.Enabled = true;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-24T09:08:19.620

一般来说，您应该始终处理一次性资源。在您上面概述的情况下，我当然会考虑。如果您在实现计时器的类上实现 IDisposable，则可以在 using 语句中使用该类，这意味着在释放您的类时将显式释放资源。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2010-05-21T08:33:13.163

我看到你在一年前问过这个问题，但让我投入我的 2 美分。由于通货膨胀而略少:)。最近我在我们的应用程序中发现我们没有处理计时器。我们有一组对象，每个对象都有一个计时器。当我们从集合中删除该项目时，我们认为它应该被垃圾回收。出于某种原因，计时器并非如此。我们必须调用集合中的对象的 dispose 以在对象实际被垃圾回收之前摆脱计时器。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-24T12:15:43.093

我使用的经验法则是制作任何具有 IDisposable 对象、IDisposable 本身的东西（并且仅在显式调用 Dispose 时才释放子对象）

在[Joe Duffy 的博客上对 IDisposable 进行了很好的讨论，以及看起来与我的优秀](http://joeduffyblog.com/2005/04/08/dg-update-dispose-finalization-and-resource-management/)[框架设计指南](http://www.amazon.co.uk/gp/product/0321545613?ie=UTF8&tag=didcotcom&linkCode=as2&camp=1634&creative=19450&creativeASIN=0321545613)书副本中的代码示例非常相似

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-11-25T12:36:12.773

计时器必须被丢弃，否则它会在你“完成”它之后继续触发一段时间。但是由于线程问题，它可能在您处理它后的短时间内仍会触发！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-24T09:15:01.510

我猜想计时器对象会创建或使用工作线程来触发计时器事件。dispose 调用将释放线程和与其关联的资源。如果是这种情况，调用 dispose 是个好主意，这样您就不会让未使用的线程停留太久。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-24T09:50:49.067

通过实现 idisposable，您将能够整理任何也实现了 idisposable 的内部资源，例如您的计时器。

此外，您还可以更改调用代码以使用 using 语句。

```
using (SomeClass someClass = new SomeClass())
{  
someClass.DoSomething();  
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-29T17:37:26.810

我同意罗兰的观点。

FxCop 中有一条规则可查找包含 Disposable 对象但未正确实现 IDisposable 的类。

# java - 用于将 XML 转换为语法彩色 HTML 的 Java 库

> ID：475764
> 
> 赞同：4
> 
> 时间：2009-01-24T09:02:26.293
> 
> 标签：java, xml, syntax-highlighting

我有一个 XML 内容的 Java 字符串。我使用 Velocity 生成一些 HTML 报告，并且这个 XML 需要包含在其中一个 HTML 文件中。如果这个 XML 是彩色和格式化的语法，那就太好了。有谁知道一个Java库来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T09:34:02.733

[https://jhighlight.dev.java.net/](https://jhighlight.dev.java.net/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-28T11:10:57.367

使用[Oliver Becker 的 XSLT 和 CSS](http://www2.informatik.hu-berlin.de/~obecker/XSLT/)：

```
import javax.xml.transform.*;

TransformerFactory tf = TransformerFactory.newInstance();
InputStream xslt = getClass().getResourceAsStream("xmlverbatim.xsl"); // or FileInputStream
Transformer t = tf.newTransformer(new StreamSource(xslt));
t.setParameter("indent-elements", "yes");
ByteArrayOutputStream s = new ByteArrayOutputStream();
t.transform(new StreamSource(new ByteArrayInputStream(xml)), new StreamResult(s));
byte[] out = s.toByteArray(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T09:39:23.690

如何使用 XSLT 样式表和转换 API 将您的 xml 转换为 html。请参阅**使用 XSLT 将 XML 转换为 HTML**：[http ://www.rgagnon.com/javadetails/java-0407.html](http://www.rgagnon.com/javadetails/java-0407.html)

# cmd - 创建一个可以运行 cmd 提示符的程序

> ID：475772
> 
> 赞同：0
> 
> 时间：2009-01-24T09:14:00.887
> 
> 标签：cmd, prompt

我有一个程序可以通过将图片文件拖到它上面来更改我的桌面墙纸。我还有一个无线网络程序，可以在每次连接到某个网络时自动打开程序。

我想在每次连接到某个网络时更改我的桌面，但是除非我将图片拖到它上面，否则运行壁纸程序不会做任何事情。但是，我也可以运行 cmd 提示符“c:/program.exe picture.jpg”

我尝试创建一个批处理文件 START C:/PROGRAM.EXE PICTURE.JPG，但它不起作用。

所以基本上我正在尝试创建一个可以运行 cmd 提示符“c:/program.exe picture.jpg”的程序 - 你能帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T09:22:56.813

从批处理文件中删除“开始”，并确保其中包含空格的所有路径都用引号引起来，否则它们将被分解为参数。

例如：

"C:\Program Files\MyProgram.exe" "C:\Documents and Settings\Me\MyPicture.jpg"

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T09:19:21.530

批处理作业应该可以工作。尝试从您的示例中跳过该 START 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T19:06:54.020

Start - Run - Type : cmd /c "start /max ""C:\Program Files\MyProgram.exe"" ""C:\Documents and Settings\Me\MyPicture.jpg""" . The cmd /c - starts a new cmd instance and quits

# c# - 无锁列表求助！

> ID：475776
> 
> 赞同：2
> 
> 时间：2009-01-24T09:17:49.023
> 
> 标签：c#, multithreading, lock-free

嗨，我正在尝试编写一个无锁列表，我认为添加部分正在工作，但是从列表中提取对象的代码不起作用:(

那么这个列表不是一个普通的列表..我有接口 IWorkItem

```
interface IWorkItem
{
    DateTime ExecuteTime { get; }
    bool Cancelled { get; }
    void Execute(DateTime now);
} 
```

好吧，我有一个列表，我可以在其中添加这个：P，理想的是当我运行 Get(); 在列表上它应该循环它，直到它找到一个 IWorkItem

```
If (item.ExecuteTime < DateTime.Now) 
```

并将其从列表中删除并返回..我在我的双核 cpu 上运行了许多线程的测试，似乎 Add 工作到目前为止从未失败，但是 Get 函数丢失了一些我不知道有什么问题的工作项.. ...

ps如果我得到这个工作，任何人都可以免费使用代码:)好吧，你是任何方式，但我不明白它被窃听时的重点：P

代码在这里[http://www.easy-share.com/1903474734/LinkedList.zip](http://www.easy-share.com/1903474734/LinkedList.zip)如果您尝试运行它，您会发现它有时无法获得与它放入的一样多的工作项列表...

编辑：我有一个无锁列表工作它比使用 lock(obj) 语句更快，但我有一个使用 Interlocked 的锁对象，它仍然优于无锁列表，我将尝试制作一个无锁数组列表，如果我当我在这里完成上传结果时得到相同的结果..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-02T09:43:43.553

问题在于您的算法：考虑以下事件序列：

线程 1 调用`list.Add(workItem1)`，完全完成。

状态是：

```
first=workItem1, workItem1.next = null 
```

然后线程 1 调用`list.Add(workItem2)`并在第二个之前到达该位置`Replace`（您有注释“//lets try”）。

状态是：

```
first=workItem1, workItem1.next = null, nextItem=workItem1 
```

此时线程 2 接管并调用`list.Get()`. 假设`workItem1`的 executionTime 是现在，所以调用成功并返回`workItem1`。

这个状态之后是：

```
first = null, workItem1.next = null 
```

（在另一个线程中，`nextItem`仍然是`workItem1`）。

现在我们回到第一个线程，它完成了`Add()`by setting `workItem1.next:=workItem2`。

如果我们现在调用，即使成功完成`list.Get()`，我们也会得到。`null``Add()`

You should probably look up a real peer-reviewed lock-free linked list algorithm. I think the standard one is [this](ftp://ftp.cs.rpi.edu/pub/valoisj/podc95.ps.gz) by John Valois. There is a C++ implementation [here](http://www.cs.rpi.edu/~bushl2/portfolio/lockfree-grape/code/lockfreelist.h). [This](http://www.cs.chalmers.se/~dcs/ConcurrentDataStructures/phd_chap5.pdf) article on lock-free priority queues might also be of use.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T16:36:54.160

那么你确定它需要无锁吗？根据您的工作负载，非阻塞解决方案有时可能会更慢。查看这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/bb310595(VS.85).aspx)了解更多信息。同样证明无锁数据结构是正确的也非常困难。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-01T21:10:39.110

您可以很好地为数据结构使用时间戳协议，从数据库世界中镜像这个示例：

[并发](http://vocw.edu.vn/content/m10678/latest/)

但是要清楚每一项都需要读写时间戳，一定要清楚地遵循算法的规则。

我认为，在链表上实现这一点还有一些额外的困难。数据库示例适用于您知道所需数组索引的向量。但是，在链表中，您可能需要沿着指针向下走——并且在您搜索时，链表的结构可能会发生变化！我想您可以通过某种细微差别来解决这个问题（或者如果您只想按原样遍历“新”列表，则什么都不做），但这会带来问题。尝试在不引入比锁定列表更糟糕的回滚条件的情况下解决它！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T16:25:31.983

我绝不是该主题的专家，但据我所知，您需要在 IWorkItem 的实现中使 ExecutionTime-field 易失性（当然可能已经是这样），或者在您之后插入一个[内存屏障](http://msdn.microsoft.com/en-us/library/system.threading.thread.memorybarrier.aspx)设置 ExecutionTime 或在阅读之前设置。

# google-search - 如何让附加链接出现在 Google 搜索中？

> ID：475779
> 
> 赞同：3
> 
> 时间：2009-01-24T09:20:59.390
> 
> 标签：google-search

如何让我的附加链接出现在 Google 搜索结果中？

![谷歌附加链接](https://i.stack.imgur.com/MsYjf.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T09:32:18.463

根据您的图片，您指的是站点链接，而不是 Google 术语中的站点地图。以下是 Google 网站管理员网站对附加链接的评价：

> Google 尚未为您的网站生成任何附加链接。附加链接是完全自动化的，只有在我们认为它们对用户有用时才会显示它们。如果您网站的结构不允许我们的算法找到好的附加链接，或者我们认为这些附加链接与用户的查询无关，我们将不会显示它们。但是，我们一直在努力改进查找和显示附加链接的方式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-24T09:32:29.803

您看到的是不是从您的站点地图生成的“附加链接”。谷歌[没有详细](http://www.google.com/support/websearch/bin/answer.py?answer=28082&topic=8994)说明这些链接的来源，但它们似乎与[清晰的导航结构](http://www.hochmanconsultants.com/articles/sitelinks.shtml)等相关。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-24T09:33:27.383

没有办法做到这一点。谷歌决定是否显示[附加链接](http://www.google.com/support/webmasters/bin/answer.py?answer=47334)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T09:33:44.107

那不是站点地图，而是站点链接。即使您将您的网站放入谷歌、站点地图或其他方式，您也不会获得网站链接，除非他们认为它适合您的网站。谷歌网站管理员工具是一个很好的起点，但不要指望很快就会有网站链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-04T12:29:19.053

您可以在 Google 的搜索结果中获得附加链接，但需要时间。假设如果你想在站点链接下获得你的产品页面，你需要推广它并看到你得到了很多点击，这个页面应该是用户和搜索引擎友好的。它应该与您的目标关键字一起出现在首页上。现在取决于您如何在线推广它，一旦您在排名靠前的页面获得良好的点击率，您可以在几个月内获得结果。

根据我的经验，我在上面提出的任何建议，您都可以尝试，但我不能保证它会起作用。

# design-patterns - 在不使用 Singleton 的情况下从非 bean 对象获取 Spring Application 上下文

> ID：475785
> 
> 赞同：10
> 
> 时间：2009-01-24T09:28:57.767
> 
> 标签：design-patterns, spring, singleton

我需要从非 bean 对象中获取 spring 应用程序上下文。在 SO 的另一个线程中，接受的答案建议使用单例来获取应用程序上下文。 [获取 Spring 应用程序上下文](https://stackoverflow.com/questions/129207/getting-spring-application-context)

但是使用单例使我的代码更加耦合且可测试性更低，这是许多线程中讨论的常见问题（例如[Singletons 有什么不好](https://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons)）

问题是，是否有一种优雅的方法可以在不使用单例的情况下从非 bean 对象获取应用程序上下文？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T09:43:04.480

总是存在引导问题。对于 Web 应用程序，通常有处理这种情况的外部 servlet 过滤器。

如果不是网络应用程序，那么就无法绕过某种外部单例或引导程序。但; 在此处使用单例只会影响该单个引导程序类的可测试性。您的代码中应该只有很少的地方需要以任何显式方式引用容器。所以它并没有真正显着增加耦合。

或者换一种说法，实际上应该只有很少的非 bean 对象需要访问 spring 容器。如果不是这种情况，那么您可能没有最佳地使用弹簧。大多数/所有需要容器的人可能应该只实现[BeanFactoryAware](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/BeanFactoryAware.html)或[ApplicationContextAware](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/context/ApplicationContextAware.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-10T08:58:37.593

我认为您的问题与我几天前的问题差不多。我认为以下内容应该适合您：

首先创建一个类`AppContextManager`，如下所示：

```
@Component
public class AppContextManager implements ApplicationContextAware{
    private static ApplicationContext _appCtx;

    @Override
    public void setApplicationContext(ApplicationContext ctx){
         _appCtx = ctx;
    }

    public static ApplicationContext getAppContext(){
        return _appCtx;
    } 
} 
```

在`@Component`您的`application context xml`.

现在在您的`non-singleton` `non-spring`实例中使用以下代码片段来获取任何其他 Spring bean：

```
ApplicationContext ctx = ApplicationContextManager.getAppContext();
SomeSpringBean bean = ctx.getBean(SomeSpringBean.class); 
```

这将为您提供代码中任何位置的 bean 实例。

# unix - 是否有替代 MKS Yacc 支持“选择首选项语法”或类似的东西？

> ID：475787
> 
> 赞同：1
> 
> 时间：2009-01-24T09:31:19.400
> 
> 标签：unix, open-source, yacc

MKS Yacc 支持他们的网站称为“[选择首选项语法](http://www.mkssoftware.com/docs/wp/wp_lyuse.asp)”的符号。它没有说明，但它由方括号中的标记组成，可选地带有插入符号，它表示特定标记需要遵循或不遵循其余规则：

```
non_terminal:  TOKEN1 non_terminal2 TOKEN2 [TOKEN3]

non_terminal:  TOKEN1 non_terminal2 TOKEN2 [^TOKEN3] 
```

（我不清楚括号中的项目是否可以是非终端。我看到的使用符号的代码总是使用一个标记或几个空格分隔的标记，而不是非终端。）

是否有人知道提供相同支持（符号可以不同 - 功能不能）的替代 Yacc 兼容系统（最好是开源），在 Unix 或 Linux 机器上运行，最好以源格式提供？

（MKS Yacc 在处理错误和调整错误行为方面也提供了一些灵活性。可以使用的一种方法是，当关键字在被视为关键字时毫无意义的位置遇到时，将其视为标识符。我是能够将其改造成`byacc`- Berkeley Yacc - 但我没有花足够的时间来研究如何处理“选择偏好”。）

* * *

另见：[有没有人使用过 MKS Yacc 提供的“选择偏好”机制？](https://stackoverflow.com/questions/478891/has-anyone-used-the-selection-preferences-provided-by-mks-yacc)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T08:54:43.647

为了完整起见，由于我在答案中将其链接到您的其他版本，[Thinkage](http://www.thinkage.ca/english/index.shtml)似乎有一个名为[YAY](http://www.thinkage.ca/english/products/yay-manual.html)的产品，它类似于 yacc 并支持选择器语法。他们在 Kitchner，显然与 MKS 密切相关，但从网站上看，他们似乎也负责 MKS 的文档，所以如果其他所有方法都失败了，你可以打电话给他们，问他们这些选择偏好到底是什么意思。;-)

# c# - Protocol Buffer 有多快或多轻？

> ID：475794
> 
> 赞同：34
> 
> 时间：2009-01-24T09:35:19.113
> 
> 标签：c#, remoting, protocol-buffers

.NET 的协议缓冲区会比 Remoting（SerializationFormat.Binary）更轻量/更快吗？在语言/框架方面会有一流的支持吗？即它是否像 Remoting/WebServices 一样透明地处理？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-24T10:10:13.830

我非常怀疑它是否会获得直接的语言支持甚至框架支持——这种东西在 3rd 方库中处理得非常好。

[我自己的 Java 代码端口](http://code.google.com/p/protobuf-csharp-port/)是显式的 - 您必须调用方法来序列化/反序列化。（有 RPC 存根会自动序列化/反序列化，但还没有 RPC 实现。）

[不过， Marc Gravell 的项目](http://code.google.com/p/protobuf-net/)非常适合 WCF - 据我所知，您只需告诉它（一次）使用协议缓冲区进行序列化，其余的都是透明的。

在速度方面，您应该查看[Marc Gravell 的基准页面](http://code.google.com/p/protobuf-net/wiki/Performance)。我的代码往往比他的略快，但两者都比框架中的其他序列化/反序列化选项快得多。应该指出的是，协议缓冲区也受到更多限制——它们不会尝试序列化任意类型，只会序列化受支持的类型。将来，我们将尝试以可移植的方式（作为它们自己的协议缓冲区消息）支持更多常见的数据类型（十进制、日期时间等）。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-01-24T11:42:53.270

[此页面](http://code.google.com/p/protobuf-net/wiki/Performance)上有一些性能和大小指标。我现在还没有 Jon 的统计数据，只是因为页面有点旧（Jon：我们必须解决这个问题！）。

重新透明；[protobuf-net](http://code.google.com/p/protobuf-net/)可以通过合约挂钩到 WCF；请注意，它也可以与 MTOM 通过 basic-http 很好地配合使用。但是，这不适用于 Silverlight，因为 Silverlight 缺少注入点。如果使用 svcutil，还需要向类添加属性（通过部分类）。

Re BinaryFormatter（远程处理）；是的，这完全支持；您可以通过简单的`ISerializable`实现来做到这一点（即只需`Serializer`使用相同的参数调用方法）。如果您使用`protogen`创建类，那么它可以为您完成：您可以在命令行通过参数启用它（默认情况下不启用，因为`BinaryFormatter`不适用于所有框架 [CF 等]）。

请注意，对于本地远程处理 (IPC) 上的非常小的对象（单个实例等），原始`BinaryFormatter`性能实际上更好 - 但对于非平凡的图形或远程链接（网络远程处理），protobuf-net 的性能可以很好地胜过它。

我还应该注意，协议缓冲区有线格式不直接支持继承；protobuf-net 可以欺骗这一点（同时保持线路兼容性），但与 XmlSerializer 一样，您需要预先声明子类。

* * *

## 为什么有两个版本？

开源的乐趣，我猜 ;-p Jon 和我之前曾参与过联合项目，并讨论过合并这两个项目，但事实是它们针对两个不同的场景：

*   [dotnet-protobufs](http://github.com/jskeet/dotnet-protobufs/tree/master) (Jon's) 是现有 java 版本的一个端口。这意味着对于已经使用 java 版本的任何人来说，它都有一个非常熟悉的 API，并且它建立在典型的 java 构造（构建器类、不可变数据类等）之上——带有一些 C# 曲折。
*   [protobuf-net](http://code.google.com/p/protobuf-net/) (Marc's) 是一个全新的重新实现，遵循相同的二进制格式（实际上，一个关键要求是您可以在不同格式之间交换数据），但使用典型的 .NET 习惯用法：
    *   可变数据类（无构建器）
    *   序列化成员细节以属性表示（类似于`XmlSerializer`,`DataContractSerializer`等）

如果您正在处理 java 和 .NET 客户端，Jon's 可能是双方熟悉的 API 的不错选择。如果你是纯 .NET，protobuf-net 有优势——熟悉的 .NET 风格的 API，还有：

*   您不必*被迫*以合同为先（尽管您可以，并且提供了代码生成器）
*   您可以重新使用现有的对象（事实上，`[DataContract]`类`[XmlType]`通常可以在没有任何更改的情况下使用）
*   它完全支持继承（它通过欺骗封装在网络上实现）（对于协议缓冲区实现可能是唯一的？请注意，必须提前声明子类）
*   它不遗余力地插入和利用核心 .NET 工具（`BinaryFormatter`、、`XmlSerializer`WCF、`DataContractSerializer`）——允许它直接作为远程处理引擎工作。这可能与 Jon 的端口的主要 Java 主干有很大的区别。

重新合并它们；我认为我们都会对此持开放态度，但您似乎不太可能同时需要这两个功能集，因为它们针对的是不同的需求。

# double - 在 g77、Fortran 编译器中设置双精度默认值

> ID：475801
> 
> 赞同：3
> 
> 时间：2009-01-24T09:43:32.263
> 
> 标签：double, fortran, fortran77, g77

g77（GNU Fortran 77 编译器）中是否有“-fdefault-real-8”gfortran（GNU Fortran 95 编译器）选项的类似物？此选项将默认实类型设置为 8 字节宽类型。

我目前的代码中单精度算术限制了我的准确性，所以我需要双精度。（我想要双精度的不仅仅是中间值，它是一个 FPU 标志；我希望一切都是双精度的。）我知道我有一些其他方法（使用 gfortran，使用其他编译器，或者将所有 REAL 更改为 DOUBLE PRECISIONs），但它们并不适合我的情况。

那么，有没有办法在g77中将默认的实数类型设置为双精度，即8字节宽？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T14:16:54.847

如果您在手册页中找不到标志，您可以尝试使用#define 宏。

```
#define REAL DOUBLE PRECISION 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T20:49:37.913

由于很多 FORTRAN 77 仍然是合法的，是否可以`gfortran`用来编译您的 FORTRAN 77 代码并提供`-fdefault-real-8`选项？

# reporting-services - 来自查询的 SQL Server Reporting Services 默认值在部署的报表中不起作用

> ID：475803
> 
> 赞同：1
> 
> 时间：2009-01-24T09:44:07.393
> 
> 标签：reporting-services

为了在页眉中填充文本框，我设置了一个参数（因为您不能使用字段）并在文本框中引用它。该参数的默认值设置为“来自查询”，并且相应地设置了数据集和值字段。这在 Visual Studio 2005 的开发中很有效。一旦我部署了报告并在 ReportViewer 控件中查看报告，我就会收到错误消息：

“参数验证失败。无法为所有参数提供有效值。(rsParameterError)”。

如果我删除参数，报告工作正常。

（奇怪的是，我以为我早先有这个工作）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T09:59:11.700

您可能已经检查过了，但是是否复制了默认值？我过去曾遇到过报告服务问题，当我将报告从一个框移到另一个框时，默认值会丢失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T11:38:37.193

感谢您的回答 - 它为我指明了正确的方向......我一直在使用自己的程序来部署多个报告，因此很少通过报告管理器网站查看它们。无论如何 - 我刚刚在我的家用 PC 上部署了报告，它运行良好....查看两台 PC 上的报告管理器中的报告，我发现 PC 上没有工作的“提示用户”没有勾选......去搞清楚。勾选这个解决了这个问题。

我喜欢我从 SSRS 获得的结果，但我对它很陌生，并且发现一些东西（比如这样）有点令人沮丧......鼠标和键盘很幸运没有发现自己被扔出窗外！

# svg - SVG 自动换行 - 显示塞子？

> ID：475804
> 
> 赞同：24
> 
> 时间：2009-01-24T09:44:36.287
> 
> 标签：svg, word-wrap

为了好玩，我想看看我在为 RIA 实现 SVG 浏览器客户端方面能走多远，我在业余时间搞砸了。

但是遇到了似乎是一个巨大的绊脚石。没有自动换行！！

有谁知道任何解决方法（我在想某种 JavaScript 或我不知道的特殊标签）？

如果不是，我将不得不走 xhtml 路线并开始在我的 SVG 中添加 HTML 元素（哎哟），或者在 SVG 1.2 准备好十年后再次回来。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2011-03-19T15:14:27.313

还有foreignObject标签。然后，您可以将 HTML 嵌入到 SVG 中，这提供了最大的灵活性。HTML 非常适合文档布局，并且已经被无限支持以支持应用程序布局、绘图以及我们开发人员想要的一切。但它的优势在于自动换行和文档布局。让 HTML 做它最擅长的事情，让 SVG 做它最擅长的事情。

[http://www.w3.org/TR/SVG/extend.html](http://www.w3.org/TR/SVG/extend.html)

这适用于大多数浏览器 FireFox、Opera、Webkit，除了 IE（从 IE11 开始）。:-( 网络故事不是吗？

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-07-25T08:35:56.713

这个 SVG 的东西很莫名其妙，不是吗？

值得庆幸的是，您*可以获得*一些不错的结果，但它比使用 HTML 5 需要更多的工作。

这是我的 ASP.Net / SVG 应用程序的屏幕截图，其中包含一些“伪造”的自动换行。

![在此处输入图像描述](https://i.stack.imgur.com/LQprF.png)

以下函数将为您创建一个 SVG**文本**元素，分成**tspan**片段，其中每行的长度不超过 20 个字符。

```
<text x="600" y="400" font-size="12" fill="#FFFFFF" text-anchor="middle">
    <tspan x="600" y="400">Here a realy long </tspan>
    <tspan x="600" y="416">title which needs </tspan>
    <tspan x="600" y="432">wrapping </tspan>
</text> 
```

它并不完美，但它简单、快速，用户永远不会知道其中的区别。

我的**createSVGtext()** JavaScript 函数采用三个参数：x 位置、y 位置和要显示的文本。字体、每行最大字符数和文本颜色都在我的函数中进行了硬编码，但这很容易更改。

要显示上面屏幕截图中显示的右侧标签，您可以使用以下方法调用该函数：

```
var svgText = createSVGtext("Here a realy long title which needs wrapping", 600, 400);
$('svg').append(svgText); 
```

这是 JavaScript 函数：

```
function createSVGtext(caption, x, y) {
    //  This function attempts to create a new svg "text" element, chopping 
    //  it up into "tspan" pieces, if the caption is too long
    //
    var svgText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
    svgText.setAttributeNS(null, 'x', x);
    svgText.setAttributeNS(null, 'y', y);
    svgText.setAttributeNS(null, 'font-size', 12);
    svgText.setAttributeNS(null, 'fill', '#FFFFFF');         //  White text
    svgText.setAttributeNS(null, 'text-anchor', 'middle');   //  Center the text

    //  The following two variables should really be passed as parameters
    var MAXIMUM_CHARS_PER_LINE = 20;
    var LINE_HEIGHT = 16;

    var words = caption.split(" ");
    var line = "";

    for (var n = 0; n < words.length; n++) {
        var testLine = line + words[n] + " ";
        if (testLine.length > MAXIMUM_CHARS_PER_LINE)
        {
            //  Add a new <tspan> element
            var svgTSpan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');
            svgTSpan.setAttributeNS(null, 'x', x);
            svgTSpan.setAttributeNS(null, 'y', y);

            var tSpanTextNode = document.createTextNode(line);
            svgTSpan.appendChild(tSpanTextNode);
            svgText.appendChild(svgTSpan);

            line = words[n] + " ";
            y += LINE_HEIGHT;
        }
        else {
            line = testLine;
        }
    }

    var svgTSpan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');
    svgTSpan.setAttributeNS(null, 'x', x);
    svgTSpan.setAttributeNS(null, 'y', y);

    var tSpanTextNode = document.createTextNode(line);
    svgTSpan.appendChild(tSpanTextNode);

    svgText.appendChild(svgTSpan);

    return svgText;
} 
```

自动换行的逻辑基于[这个 HTML5 Canvas 教程](http://www.html5canvastutorials.com/tutorials/html5-canvas-wrap-text-tutorial/)

希望这个对你有帮助 ！

麦克风

[http://www.MikesKnowledgeBase.com](http://www.MikesKnowledgeBase.com)

**更新**

一件事我忘了提。

我上面显示的那个“工作流程图”屏幕最初只是使用 HTML 5 **canvas**编写的。它工作得很好，图标可以拖动，当你点击它们时会出现弹出菜单，甚至 IE8 似乎也很满意。

但是我发现，如果图表变得“太大”（例如 4000 x 4000 像素），那么在所有浏览器中都将无法初始化，什么都不会出现 -**但是**- 就 JavaScript 代码而言，一切正常。

因此，即使进行了错误检查，我的图表仍然显示为空白，并且我无法检测到何时发生此显示停止问题。

```
var canvasSupported = !!c.getContext;
if (!canvasSupported) {
    //  The user's browser doesn't support HTML 5 <Canvas> controls.
    prompt("Workflow", "Your browser doesn't support drawing on HTML 5 canvases.");
    return;
}

var context = c.getContext("2d");
if (context == null) {
    //  The user's browser doesn't support HTML 5 <Canvas> controls.
    prompt("Workflow", "The canvas isn't drawable.");
    return;
}

//  With larger diagrams, the error-checking above failed to notice that
//  the canvas wasn't being drawn. 
```

所以，这就是为什么我不得不重写 JavaScript 代码来改用 SVG。它似乎可以更好地处理更大的图表。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-18T14:28:39.313

SVGT 1.2 引入了 textArea 元素[http://www.w3.org/TR/SVGTiny12/text.html#TextInAnArea](http://www.w3.org/TR/SVGTiny12/text.html#TextInAnArea)，但目前它仅被 Opera 10 实验性支持。我不知道其他浏览器是否会计划实现它，尽管我希望他们会。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-24T09:52:42.010

根据此[文档](http://apike.ca/prog_svg_text.html)，似乎**tspan**可以给人一种自动换行的错觉：

> tspan 标记与文本标记相同，但可以嵌套在文本标记内部和自身内部。再加上 'dy' 属性，这允许在 SVG 1.1 中出现自动换行的错觉。请注意，“dy”相对于最后绘制的字形（字符）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-05T08:47:56.033

svg.js库有一个[svg.textflow.js](https://github.com/wout/svg.textflow.js)[插件](http://svgjs.com/)。它不是超快，但它可以解决问题。它甚至将溢出的文本存储在数据属性中，因此您可以使用它来创建连续流动的列。[这里是文本流示例页面](http://svgjs.com/textflow/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T20:43:54.663

另一种方法是使用 Andreas Neuman 的[文本框](http://www.carto.net/papers/svg/gui/textbox/)对象。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-19T04:14:02.350

这些天来，flowPara 可以进行自动换行，但我还没有找到合适支持它的浏览器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-16T16:28:32.590

我一直在寻找一个关于在 svg 中换行这么几个小时（或很多天）的解决方案。如果您可以在您的应用程序中，编辑您的代码以放入一些 tspan 或任何其他方法，进入其中。

文本换行将在 1.2 版本中实现，但除了 opera，还没有浏览器完全实现它（4 年，规范在 W3 上......）。

因为我必须使用一些对齐设置，所以我不能使用许多论坛可以提供的任何代码（没有异物，没有 carto 脚本或任何东西）。

如果我发布此消息，这只是为了在谷歌搜索自动换行 svg 时对其他人有用，因为此帖子位于最佳结果，并且在许多情况下，此帖子无济于事。

这是一个很酷、简单且轻便的解决方案： http: [//dev.w3.org/SVG/profiles/1.1F2/test/svg/text-dom-01-f.svg](http://dev.w3.org/SVG/profiles/1.1F2/test/svg/text-dom-01-f.svg)

# c# - 为什么我的 EventHandler 没有触发？(Asp.Net C#)

> ID：475805
> 
> 赞同：0
> 
> 时间：2009-01-24T09:45:33.677
> 
> 标签：c#, asp.net

我正在以编程方式制作一些 LinkBut​​tons，它们工作了一段时间，但现在事件没有触发，我不知道为什么？

这就是制作按钮的原因：

```
protected void MakeUploadButton(attachment a, PlaceHolder ph)
{
    LinkButton lb = new LinkButton()
    {
        Text = "Upload New " + a.attachment_type.type_name,
        CssClass = "button right",
        ID = "lb" + a.attachment_type.file_tag,
        CommandArgument = a.attachment_type_id.ToString(),
        CommandName = a.attachment_type.type_name,
        CausesValidation = false
    };
    lb.Click += new EventHandler(showModalPopup);
    lb.DataBind();
    ph.Controls.Add(lb);
} 
```

**ShowModalPopup**存在，但当我在调试中运行它时，它里面没有任何东西会触发......由于某种原因，它没有被调用。有任何想法吗？

* * *

在这里找到我的答案：http: [//bytes.com/groups/net-asp/329287-linkbutton-event-not-firing](http://bytes.com/groups/net-asp/329287-linkbutton-event-not-firing)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T10:02:20.850

这是因为 .NET 如果未在视图状态中设置元素事件处理程序，则会在回发时对它们进行核对。您需要做的就是在 onload 事件中重新附加事件处理程序。

```
Protected Sub Page_Load(sender As Object, e As EventArgs) Handles MyBase.Load
   If Page.IsPostBack Then
      Dim lb as ListButton = TryCast(Page.FindControl("IDOfControl"), LinkButton)
      lb.Click += new EventHandler(showModalPopup);
   End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T10:04:18.727

确保在每个页面周期都创建控件（也是回发）。这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms178472.aspx)很好地概述了 ASP.NET 页面生命周期。

> **添加控件的追赶事件**
> 
> 如果控件是在运行时动态创建的，或者是在数据绑定控件的模板中以声明方式创建的，则它们的事件最初不会与页面上其他控件的事件同步。例如，对于在运行时添加的控件，Init 和 Load 事件在页面生命周期中发生的时间可能比以声明方式创建的控件的相同事件要晚得多。
> 
> 因此，从它们被实例化的那一刻起，动态添加的控件和模板中的控件一个接一个地引发它们的事件，直到它们赶上它被添加到 Controls 集合中的事件。

# delphi - Delphi - 如何在 TStringGrid 中设置垂直滚动条，始终可见

> ID：475806
> 
> 赞同：2
> 
> 时间：2009-01-24T09:46:28.777
> 
> 标签：delphi, scrollbar, delphi-2007

我在 Win32 上使用 Delphi 2007，需要将 TstringGrid 中的垂直滚动条设置为始终可见。你是怎样做的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T14:43:20.473

You can hide scrollbars with the Scrollbar property set to either ssNone, ssHorizontal, ssVertical, even when the number of rows and / or columns would normally make them appear.

You can however not force one or both scrollbars to be always visible but disabled, without creating a new descendent class and overriding methods. Unfortunately the standard grid controls have not evolved much since the days of Delphi 1, so your best bet is using some third party grid control instead. Preferably one that does also show proper proportional scroll thumbs.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T14:11:58.477

There is a scrollbar property that can be set to ssNone, ssHorizontal, ssVertical or ssBoth.

# excel - 如何使用绑定数据集自动更新访问中的报表？

> ID：475814
> 
> 赞同：3
> 
> 时间：2009-01-24T09:55:38.057
> 
> 标签：excel, ms-access, vba, paradox

我有一个悖论表的单个条目输出，它被导入到 Access 中。现在我已经创建了一个报表，并完成了报表中的数据绑定到来自 Paradox 的数据集。在 Paradox 中完成工作后，单条目输出会发生变化...如何打开访问权限并自动更新报告中的值，而无需手动重新导入表？

目的是当访问被打开时，报告会在打印前立即出现以供检查。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T09:59:17.770

使用链接表而不是导入数据（假设 paradox 提供程序可用，这[似乎很可能](http://support.microsoft.com/kb/230126)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T14:59:19.677

直接链接到 Paradox 表应该可以。执行您所要求的自动导入的方法是在 autoexec 宏或报告的 OnLoad 事件中运行 DoCmd.TransferDatabase。您可能还想从删除查询开始也重置表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T20:20:41.213

通过菜单上的 GetData 将表链接到 Paradox 文件。您从 db 文件所在的路由目录中选择文件并选择。维护链接并将日期关系绑定到数据集。当您使用 Paradox 数据库进行更新时，Access 中的表也会随之更新。您不能同时运行数据库并访问，否则喷气发动机将无法工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-25T04:15:11.457

从报告的设计视图中，转到属性表和事件选项卡。找到 On Load 事件并单击省略号按钮。如果出现“选择生成器”对话框，请选择“代码生成器”。这将使您进入 Report_Load 事件中的 VBA 编辑器。编辑看起来像这样：

私有子 Report_Load()

```
DoCmd.TransferDatabase acImport, "Paradox 7.x", "c:\yourdata\yourfile.tbl", acTable, "SourceTable", "YourAccessTable" 
```

结束子

我不确定 Paradox 版本的细节、文件命名约定等（我只是简单地涉足 Paradox，不记得它的细节）。观看智能感知或将光标放在 TransferData 上并按 F1 以获取 TransferDatabase 方法的帮助以供参考。

在 TrasferDatabase 语句之前，您可能需要运行以下内容：

CurrentDb.Execute “从表名中删除”

这将在来自 Paradox 端的负载之前炸毁 Access 端的目标表。

# c++ - static_cast (foo) 与 (int)foo

> ID：475824
> 
> 赞同：30
> 
> 时间：2009-01-24T10:05:53.777
> 
> 标签：c++, casting

有人可以详细说明差异吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-01-24T10:13:46.647

不同之处在于 (int)foo 可能意味着六种不同的东西。它可能是一个 static_cast（在静态已知类型之间转换），它可能是一个 const_cast（添加或删除 const-ness），或者它可能是一个 reinterpret_cast（在指针类型之间转换）

编译器会尝试它们中的每一个，直到找到一个可以工作的。这意味着它可能并不总是选择您期望的那个，因此它可能成为一个微妙的错误来源。

此外， static_cast 更容易搜索或搜索/替换。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-24T10:22:02.327

看看[Stroustrup 对此](http://www.stroustrup.com/bs_faq2.html#static-cast)有何评论，包括以下内容：

> 因为 C 风格的强制转换 (T) 可用于表示许多逻辑上不同的操作，所以编译器只有极少的机会来发现误用。[...]
> 
> 引入“新式转换”是为了让程序员有机会更清楚地表达他们的意图，并让编译器捕捉更多错误。[...]

特别是，C++ 区分`static_cast`和`reinterpret_cast`：

> 这个想法是 static_cast 允许的转换比需要 reinterpret_cast 的转换不太可能导致错误。原则上，可以使用 static_cast 的结果而不将其转换回其原始类型，而您应始终在使用 reinterpret_cast 之前将其转换回其原始类型以确保可移植性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T10:11:26.340

(int) foo 与 c++ 比较最多`reinterpret_cast<int>`，即不检查强制转换的有效性。

# linq - Linq - 它使用什么语言环境/排序规则来比较对象？

> ID：475825
> 
> 赞同：1
> 
> 时间：2009-01-24T10:07:39.140
> 
> 标签：linq, .net-3.5

当我调用 Linq（不是 Linq-for-SQL，只是简单的内存中 Linq）时 - 它使用什么语言环境来比较对象，我如何影响它？

例如

```
string[] a = { "a", "b", ... };
string max = a.Max(); 
```

这里使用什么语言环境——当前的，不变的？我怎么能影响它？比较似乎不区分大小写，如果我想找到区分大小写的最大值怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T10:13:18.893

它使用`IComparable<string>`字符串中的实现。

你可以很容易地编写你自己的 Max 版本，它*确实*需要一个`IComparer<T>`比较 - 我很惊讶还没有一个。或者，您可以以某种繁琐的方式使用 Aggregate 来完成相同的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T10:56:26.950

我决定更深入地了解正在发生的事情。

Max 方法使用 Comparer 类来比较项目。比较器类又使用 GenericComparer.Compare 方法。此方法调用 String.CompareTo 方法。CompareTo 使用以下代码：

```
CultureInfo.CurrentCulture.CompareInfo.Compare(this, strB, CompareOptions.None); 
```

也就是说，您可以通过更改来影响 Max 方法的行为

```
Thread.CurrentThread.CurrentCulture 
```

如果不可接受，您必须按照 Jon 的建议推出自己的 Max 版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T11:08:05.633

根据 Jon 的建议发布我的代码：

```
static T Max<T>(this IEnumerable<T> coll, IComparer<T> comp)
{
    return coll.Aggregate((a, b) => comp.Compare(a, b) < 0 ? b : a);
} 
```

它可以用作

```
string max = coll.Max(StringComparer.OrdinalIgnoreCase); 
```

# php - 在 PHP 中进行身份验证的最佳方法

> ID：475833
> 
> 赞同：5
> 
> 时间：2009-01-24T10:14:59.483
> 
> 标签：php, model-view-controller, authentication, remember-me

以模型-视图-控制器方式编写身份验证库时，最好和最安全的方法是什么？

让我很难过的事情是跟踪用户活动并通过 cookie 记住用户或在数据库中存储会话？

提前致谢 ：）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T12:03:20.483

如果您想使用会话，您可以保护它们免受**[会话固定](http://en.wikipedia.org/wiki/Session_fixation)**和**[会话劫持](http://en.wikipedia.org/wiki/Session_hijacking)**等攻击。

为了防止这两种情况，您必须确保只允许经过身份验证的请求使用会话。这通常通过在会话中链接尽可能多的关于客户端的特定（可能是唯一的）信息来完成。但由于某些信息可能会在每次请求时发生变化（例如 IP 地址），因此很难找到好的信息。
这就是为什么使用表示为[Trending](http://shiflett.org/blog/2007/dec/php-advent-calendar-day-24)的方法很有用的原因。

另一个好的保护措施是定期交换会话 ID。因此，对有效会话 ID 的攻击时间更短。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T10:27:32.767

实现它的最简单方法是使用 PHP SESSIONS。

只是 session_start(); 在脚本开头附近，您可以访问 $_SESSION 全局数组来保存您的身份验证数据。

根据您服务器的配置，存储在 $_SESSION 中的所有数据将仅在托管它的服务器上可用（少数例外）。您可以将其配置为保存在临时目录、memcached 甚至数据库中。

客户端和服务器之间传输的唯一内容是“会话密钥”。密钥可以通过 cookie 或 URL 重写（由 start_session 输出缓冲区透明地处理）传递。

# java - 如何在 JSP 中转义特殊的 HTML 字符？

> ID：475839
> 
> 赞同：42
> 
> 时间：2009-01-24T10:34:47.103
> 
> 标签：java, html, jsp, escaping

在我去创建自定义标记或 Java 方法之前，在 JSP 中转义 HTML 字符的标准方法是什么？

我有一个 String 对象，我想在 HTML 中显示它，以便它按原样显示给用户。

例如：

```
String a = "Hello < World"; 
```

会成为：

```
Hello &lt; World 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-01-24T11:28:33.267

简短的回答：

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<c:out value="${myString}"/> 
```

还有另一种选择：

```
<%@taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>
${fn:escapeXml(myString)} 
```

# javascript - 从 JavaScript 更改浏览器首选项

> ID：475840
> 
> 赞同：-1
> 
> 时间：2009-01-24T10:36:31.453
> 
> 标签：javascript, cookies

我的 cookie 有问题。如果浏览器禁用了 cookie，则 cookie 会被拒绝。有没有办法在与 Internet Explorer、Firefox、Opera 和 Chrome 兼容的客户端浏览器上启用 cookie？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-24T10:43:38.740

如果用户选择禁用 cookie，您是谁来覆盖该选择？
最好的办法是通知用户他们需要启用 cookie 以使您的脚本/站点正常工作，并提供一些有关如何执行此操作的说明的链接。
或者找到一种不同的方式来实现你想要做的事情

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T10:43:07.697

如果这是可能的，那将是一个安全漏洞。所以不，这是不可能的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-24T10:43:30.067

我不知道有一个，如果有一个，我会感到惊讶——人们出于（除其他外）安全原因关闭 cookie，因此允许站点重新启用它们将是一个安全问题。

您可以做的是在您的应用程序中写入一些逻辑来检查 cookie：

第一的

```
set a cookie called 'test';
redirect the user to http://wherevertheywere?cookiecheck=1 
```

然后，包括这样的逻辑：

```
if the querystring contains cookiecheck=1:
  if the 'test' cooke is set
    cookies are working - do whatever you need to do.
  else
    redirect the user to a special page on your site explaining that they need to enable cookies to use the site. This can include browser detection to give them relevant instructions, 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-24T11:06:01.783

如果浏览器未启用或不支持 cookie，您应该让您的软件使用另一种方式来维护逐页会话。您可能必须包含会话密钥作为 URL 参数。只要确保您有积极的会话密钥验证。根据您的语言和环境，可能已经有一些不会增加大量开发开销的工具（例如 PHP $_SESSION）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T10:45:26.273

我认为没有办法做到这一点。

希望也没有办法做到这一点。

如果用户禁用 cookie 有理由这样做并且重新启用它们应该作为安全漏洞提交

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T11:40:07.503

这可能是可能的，但是浏览器有很多版本，您很难涵盖合理数量的场景。

此外，如果用户禁用了 cookie，为用户打开它们并使用它们将是对他们计算机的犯罪干扰。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-06T13:10:39.207

认为这可以帮助任何人，在某些浏览器上，您可以使用以下命令检查是否启用了 cookie：

```
if(navigator.cookieEnabled) 
```

# java - 在 Java 中复制对象

> ID：475842
> 
> 赞同：21
> 
> 时间：2009-01-24T10:40:47.217
> 
> 标签：java, object, copy, clone

我有一个需要在 Java 中复制的对象。我需要在不更改原始对象本身的情况下创建一个副本并对其运行一些测试。

我假设我需要使用 clone() 方法，但这是受保护的。在网上做了一些研究后，我可以看到这可以用我班级中的公共方法覆盖。但我找不到如何做到这一点的解释。怎么可能做到这一点？

另外，这是实现我需要的最佳方式吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-24T11:07:22.217

使用 Copy Constructor 的另一种选择（来自[Java Practices](http://www.javapractices.com/topic/TopicAction.do?Id=12)）：

```
public final class Galaxy {

    public Galaxy (double aMass, String aName) {
        fMass = aMass;
        fName = aName;
    }

    /**
    * Copy constructor.
    */
    public Galaxy(Galaxy aGalaxy) {
        this(aGalaxy.getMass(), aGalaxy.getName());
        //no defensive copies are created here, since 
        //there are no mutable object fields (String is immutable)
    }

    /**
    * Alternative style for a copy constructor, using a static newInstance
    * method.
    */
    public static Galaxy newInstance(Galaxy aGalaxy) {
        return new Galaxy(aGalaxy.getMass(), aGalaxy.getName());
    }

    public double getMass() {
        return fMass;
    }

    /**
    * This is the only method which changes the state of a Galaxy
    * object. If this method were removed, then a copy constructor
    * would not be provided either, since immutable objects do not
    * need a copy constructor.
    */
    public void setMass( double aMass ){
        fMass = aMass;
    }

    public String getName() {
        return fName;
    }

    // PRIVATE /////
    private double fMass;
    private final String fName;

    /**
    * Test harness.
    */
    public static void main (String... aArguments){
        Galaxy m101 = new Galaxy(15.0, "M101");

        Galaxy m101CopyOne = new Galaxy(m101);
        m101CopyOne.setMass(25.0);
        System.out.println("M101 mass: " + m101.getMass());
        System.out.println("M101Copy mass: " + m101CopyOne.getMass());

        Galaxy m101CopyTwo = Galaxy.newInstance(m101);
        m101CopyTwo.setMass(35.0);
        System.out.println("M101 mass: " + m101.getMass());
        System.out.println("M101CopyTwo mass: " + m101CopyTwo.getMass());
    }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-24T16:12:55.923

有两种流行的方法。一个是提供`clone`您提到的方法，就像这样。

```
public class C implements Cloneable {
    @Override public C clone() {
        try {
            final C result = (C) super.clone();
            // copy fields that need to be copied here!
            return result;
        } catch (final CloneNotSupportedException ex) {
            throw new AssertionError();
        }
} 
```

注意“复制字段……这里！” 部分。初始`result`只是一个浅拷贝，这意味着如果有对一个对象的引用，那么原始对象和`result`将共享同一个对象。例如，如果`C`包含`private int[] data`您可能想要复制它。

```
...
final C result = (C) super.clone();
result.data = data.clone();
return result;
... 
```

请注意，您不需要复制原始字段，因为它们的内容已经被复制，或者不可变对象，因为它们无论如何都无法更改。

第二种方法是提供一个复制构造函数。

```
public class C {
    public C(final C c) {
        // initialize this with c
    }
} 
```

或者复制工厂。

```
public class C {
    public static C newInstance(final C c) {
        return new C(c);
    }

    private C(final C c) {
        // initialize this with c
    }
} 
```

两种方法都有各自的属性。 `clone`很好，因为它是一种方法，因此您不必知道确切的类型。最后，你应该总是得到一个“完美”的副本。复制构造函数很好，因为调用者有机会做出决定，正如 Java 集合所见。

```
final List c = ... 
// Got c from somewhere else, could be anything.
// Maybe too slow for what we're trying to do?

final List myC = new ArrayList(c);
// myC is an ArrayList, with known properties 
```

我建议选择任何一种方法，哪种方法更适合您。

我只会在单元测试中使用其他方法，例如反射复制或立即序列化/反序列化。对我来说，他们觉得不太适合生产代码，主要是因为性能问题。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-24T10:49:57.900

一些选项：

*   您可以`Cloneable`为您的对象实现并将`clone()`方法设为公共。在此处查看完整说明：http: [//www.cafeaulait.org/course/week4/46.html](http://www.cafeaulait.org/course/week4/46.html)
    但是，这会产生浅拷贝，可能不是您想要的。
*   您可以序列化和反序列化您的对象。您将需要`Serializable`为对象及其所有字段实现接口。
*   您可以使用[`XStream`](http://xstream.codehaus.org/)通过 XML 执行序列化 - 您不必在这里实现任何东西。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-24T11:04:03.833

对于测试代码，序列化可能是最安全的答案，特别是如果对象已经是可序列化的，请尝试使用 Apache Commons SerializationUtils 来实现。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-06-01T04:37:08.550

您可以使用 org.apache.commons.lang3.SerializationUtils 类进行对象克隆， - 类应实现 Serializable 接口。

*   类名 copyobject = SerializationUtils.clone(classobjectTocopy)

**Google App Engine 实例**也支持 SerializationUtils.clone

 *** * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-24T13:51:04.040

Joshua Bloch[对 cloneable 有一些有趣的说法](http://www.artima.com/intv/bloch13.html)。根据对象的大小/构造，我会向对象添加一个复制构造函数，或者使用上述解决方案之一进行序列化/反序列化。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-03-23T07:40:59.250

有多种方法可以在 java 中复制对象（浅或深）。
这个[答案](https://stackoverflow.com/questions/869033/how-do-i-copy-an-object-in-java/9834683#9834683)会帮助你。

# java - 单独的解码/编码接口或在一个接口中

> ID：475843
> 
> 赞同：3
> 
> 时间：2009-01-24T10:40:59.137
> 
> 标签：java, api, oop, fluent-interface

我正在创建一个执行从一种形式到另一种形式的转换的实现。

我现在面临的设计问题是 Encoder 和 Decoder API 应该在一个接口中还是在不同的接口中。例如 Apache MINA 使用[单独的接口](http://mina.apache.org/report/1.1/apidocs/org/apache/mina/filter/codec/package-summary.html)

我目前正在做这样的事情：

```
interface Convertor
{
    A encode( B b );

    B decode( A a );
} 
```

将它们放在一个接口中的基本原理是，您可以集中实现并在一个地方修复任何协议更改。对此有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-24T13:43:02.717

拥有单独的接口并不意味着您不能集中实施。例如，您可以让一个类实现两个接口。或者每个类都可以引用一个实现协议的公共类。

所以我要做的是有单独的接口，至少在开始时，让一个类实现两者。因此实现是共享的，但用户代码将编码器和解码器视为独立且独立的概念。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T10:45:30.267

唯一的问题是，您通常有一个代码部分将使用解码器，而另一个代码部分将使用编码器。因此，对接口编码部分的更改将强制对解码部分进行不必要的重新编译，反之亦然。

适用于带有头文件的 c/c++ 等。

搜索可靠的原则并查看接口隔离原则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T11:05:15.747

好吧，您*可以*有两个单独的接口，然后是另一个将它们组合在一起的接口。这将使能够更容易地为两者声明一个参数，例如

```
private IEncoder encoder;
private IDecoder decoder;

public ThingWhichUsesEncodeAndDecode(IEncoder encoder, IDecoder decoder)
{
    this.encoder = encoder;
    this.decoder = decoder;
}

public ThingWhichUsesEncodeAndDecode(IEncoderDecoder both)
{
    this(both, both);
} 
```

这实际上取决于您设想使用一个部件而不是另一个部件的频率。大多数时候，我发现编码/解码的东西我需要两个部分都可用，所以我*可能*只用两种方法声明一个接口——但这确实取决于具体情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T11:55:27.380

将它们放在同一个接口中的缺点是它*迫使*您的实现在单个类中同时成为编码器和解码器。目前这似乎是合理的，但可能并非总是如此。所以我会问自己这是否应该是一个要求/是否可取？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T02:20:40.267

将它们分开会更加灵活。如果您编写单独的接口，您可以随时将它们组合成第三个接口，以便在需要编码**和**解码功能时使用。

反过来是不正确的。如果您从一开始就编写一个接口，您将失去选择仅包含编码**或**解码功能的灵活性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T11:18:21.400

通常你会一起使用它们，但有时不会。这取决于什么对你来说更自然。顺便说一句：如果您单独定义它们，您仍然可以一起使用它们，例如

```
interface Converter extends Decoder, Encoder { } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-24T11:23:46.350

考虑没有单独的编码器/解码器接口，而是

```
interface Encodable
{
    Decodable encode();
}
interface Decodable
{
    Encodable decode();
}
class A implements Encodable;
class B implements Decodable; 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-24T11:27:06.687

取决于应用程序。

如果通常你在同一个二进制文件中有一个编码器和一个解码器，一个接口就可以了。如果它们通常是分开的（例如，捕获应用程序仅编码，管理应用程序仅解码），则使用单独的接口。

# c++ - 使用 C++Builder 5 将 UTF-8 转换为 WIN1252

> ID：475850
> 
> 赞同：-1
> 
> 时间：2009-01-24T10:47:42.320
> 
> 标签：c++, unicode, encoding, c++builder-5

我必须将一些 UTF-8 编码的文本文件导入到我的 C++Builder 5 程序中。是否有任何组件或代码示例可以实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T12:20:07.983

您最好阅读所有其他标记为 unicode 和 c++ 的 SO 问题。对于初学者，您可能应该看看[这个](https://stackoverflow.com/questions/433301/portable-and-simple-unicode-string-library-for-c-c)，看看接受的答案（[UTF8-CPP](http://utfcpp.sourceforge.net/)）中的库是否适合您。

但是，我首先会考虑您要实现的目标，因为您无法将 UTF-8 编码的字符串导入“Ansi”（您的意思是什么，可能类似于 ISO8859_1 或 WIN1252 编码？） .

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-14T00:54:42.617

这是一个更以 VCL 为中心的方法：

```
UTF8String utf8 = "...";
WideString utf16;
AnsiString latin1;

int len = ::MultiByteToWideChar(CP_UTF8, 0, utf8.c_str(), utf8.Length(), NULL, 0);
utf16.SetLength(len);
::MultiByteToWideChar(CP_UTF8, 0, utf8.c_str(), utf8.Length(), utf16.c_bstr(), len);

len = ::WideCharToMultiByte(1252, 0, utf16.c_bstr(), utf16.Length(), NULL, 0, NULL, NULL);
latin1.SetLength(len);
::WideCharToMultiByte(1252, 0, utf16.c_bstr(), utf16.Length(), latin1.c_str(), len, NULL, NULL); 
```

如果升级到 CB2009，可以将其简化为：

```
UTF8String utf8 = "...";
AnsiString<1252> latin1 = utf8; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T11:59:11.787

由于周末没有人工作，我必须自己回答:)

```
String Utf8ToWinLatin1(char* aData, char* aValue)
{
    int i=0;
    for(int j=0;j<strlen(aData);)
    {   int val=aData[j];
        int c=(unsigned char)aData[j];
        if(c<=127)
        {   aValue[i]=c;
            j+=1;                                  
            i++;
        }
        else if(c>=192 && c<=223)
        {
            aValue[i]=(c-192)*64 + (aData[j+1]-128);
            i++;
            j+=2;
        }
        else if(c>=224 && c<=239)
        {
            aValue[i]=( c-224)*4096 + (aData[j+1]-128)*64 + (aData[j+2]-128);
            i++;
            j+=3;
        }
        else if(c>=240 && c<=247)
        {
            aValue[i]=(c-240)*262144 + (aData[j+1]-128)*4096 + (aData[j+2]-128)*64 + (aData[j+3]-128);
            i++;
            j+=4;
        }
        else if(c>=248 && c<=251)
        {
            aValue[i]=(c-248)*16777216 + (aData[j+1]-128)*262144+ (aData[j+2]-128)*4096 + (aData[j+3]-128)*64 + (aData[j+4]-128);
            i++;
            j+=5;
        }
        else
            j+=1;
    }
    return aValue;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-24T12:38:34.220

您的问题没有具体说明您要转换为哪个字符集。如果您只想要基本的 7 位 ASCII 字符集，则丢弃值高于 127 的每个字符都可以。

如果您想转换为 8 位字符集，例如 latin1，您将不得不费尽心思。

# c++ - 我可以使用 CreateFile，但将句柄强制为 std::ofstream 吗？

> ID：475853
> 
> 赞同：19
> 
> 时间：2009-01-24T10:50:39.473
> 
> 标签：c++, windows, winapi, iostream

有什么方法可以利用 Win32 API 中的文件创建标志，例如`FILE_FLAG_DELETE_ON_CLOSE`或`FILE_FLAG_WRITE_THROUGH`此处所述[http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)，然后强制那个句柄变成一个std :: ofstream？

ofstream 的接口显然是平台无关的；我想在“幕后”中强制一些平台相关设置。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-24T13:24:51.987

可以将 C++ 附加`std::ofstream`到 Windows 文件句柄。以下代码适用于 VS2008：

```
HANDLE file_handle = CreateFile(
    file_name, GENERIC_WRITE,
    0, NULL, CREATE_ALWAYS,
    FILE_ATTRIBUTE_NORMAL, NULL);

if (file_handle != INVALID_HANDLE_VALUE) {
    int file_descriptor = _open_osfhandle((intptr_t)file_handle, 0);

    if (file_descriptor != -1) {
        FILE* file = _fdopen(file_descriptor, "w");

        if (file != NULL) {
            std::ofstream stream(file);

            stream << "Hello World\n";

            // Closes stream, file, file_descriptor, and file_handle.
            stream.close();

            file = NULL;
            file_descriptor = -1;
            file_handle = INVALID_HANDLE_VALUE;
        }
} 
```

这适用于`FILE_FLAG_DELETE_ON_CLOSE`，但`FILE_FLAG_WRITE_THROUGH`可能没有预期的效果，因为数据将由`std::ofstream`对象缓冲，而不是直接写入磁盘。但是，缓冲区中的任何数据都将在`stream.close()`调用时刷新到操作系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-23T12:37:15.327

使用 _fsopen / fopen 时也可以使用其中一些标志：

```
FILE* pLockFile = _fsopen(tmpfilename.c_str(), "w", _SH_DENYWR );
if (pLockFile!=NULL
{
   // Write lock aquired
   ofstream fs(pLockFile);
} 
```

在这里，我们打开文件，因此在进行刷新时，它会写入（并且在关闭时会被删除）：

```
FILE* pCommitFile = fopen(tmpfilename.c_str(), "wcD");
if (pCommitFile!=NULL)
{
   // Commits when doing flush
   ofstream fs(pCommitFile);
} 
```

# project-management - 您的 Web 开发过程由哪些步骤组成，每个阶段需要多少时间？

> ID：475854
> 
> 赞同：4
> 
> 时间：2009-01-24T10:52:19.300
> 
> 标签：project-management, process, methodology

假设您在一个项目上工作了 100 天。您流程的每个阶段（需求分析、规范等）需要多少天？

我也对每个阶段特定活动的比例感兴趣，例如编写测试、后端编码、前端编码、视觉设计、数据库设计等。

非常感谢！

编辑：

为了清楚起见，我不是在谈论网站设计——我对更“严肃”的 Web 开发感兴趣，例如自定义业务 Web 应用程序。我知道，一切都取决于每个项目的具体情况，但是我想各个项目的比率可能大致相同。

编辑2：

正如海伦所说，这个问题真的很难回答，因为项目可以如此不同，团队也可以如此。更具体地说，假设您有一个由四名开发人员组成的团队 - 其中两名负责后端工作，一名负责前端编程，一名负责设计和 html/css 编码（团队中的一名成员充当项目经理），你应该开发 StackOverflow.com 网站。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T13:11:11.000

我们正在运行敏捷 Scrum 项目，因此我们通常并行运行所有这些活动。所以虽然我不能回答你的确切问题，但我可以给你一些关于我们发现有效的比率的想法：

一名客户端程序员（html/css）、一名团队测试人员和一名交互设计师（与客户一起设计线框）可以为 4-5 名开发人员提供服务。对于大多数应用程序，像这样的团队通常需要 50% 的图形设计师，但您的工作量可能会有所不同。然后是项目经理，还有其他各种不属于核心开发团队的利益相关者。

在开发团队中，您通常有几个开发人员在客户端开发方面非常敏锐，而在后端开发方面也有类似的数量。这些人员配备也往往反映资源使用情况；）测试是开发的一个组成部分，也是团队测试人员的努力。

当然，您当地的条件可能会有所不同，但这些数字只是为了给您一些想法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T20:50:58.300

*   第 1 步：拒绝
*   第二步：愤怒
*   第三步：接受

每个步骤所花费的时间对于所有参与的团队成员都是不同的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T18:15:01.293

我同意每个人的观点，“这取决于项目”。

另一方面，我确实认为可以遵循一个一致的过程。只调整与项目匹配的工作百分比：

通常，我遵循以下基本原则：

1.  **发现**- 确定系统的特性/功能。最简单（也是最糟糕）的事情就是接受所要求的并顺其自然。
    例如，“构建 stackoverflow.com”是一个非常广泛的请求 - 实际上是*错误*的请求。该项目必须从“我需要一个程序员可以协作的在线位置”开始。基于你想要解决的那一件事，你可以深入了解你想要的所有细节——比如如何回答、询问、评价问题等。我认为**这是最关键的一步**！输出=要求/规范；在这里可以安全度过 20/100 天
2.  **线框图**- 这是我喜欢使用基本 HTML 页面、paint.NET 甚至是施工图纸和胶水来模拟最终网站功能的各个方面的地方。我喜欢使用纸张，因为它很容易进行更改 :) 完成此过程会迫使您考虑用户体验的几乎所有方面，并让您可以灵活地添加/删除功能并根据需要调整您的要求。在您投入大量时间编写代码之前，您的客户已经对更改进行了一些输入。额外的好处是您可以使用 paste :) 10/100 天
3.  **实施/测试**- 我将实施和测试组合在一起，因为我认为开发整个网站而不进行测试是短视的。（同时，还需要第 4 步）。这是橡胶碰到路面的部分。如果您在第 1 步和第 2 步中正确处理了您的客户，那么您将愉快地编写代码，而不会在最后一刻更改范围（或至少很少更改）。我尝试遵循一套通用的实施步骤：
    *   数据开发（数据库设计、查询设计、样本数据设置）
    *   站点框架（设置您的环境；生产、开发和质量保证）
    *   前端结构（css、标准类、标准html结构）
    *   开始编码！55/100 天
4.  **SQA** - 希望您可以让一些非相关方/最终用户随时测试应用程序。需要制定测试计划，以确保清楚应该测试什么以及期望的结果。我喜欢用真人来测试前端；自动化工具适用于代码/后端模块 这是让客户看到事情进展的好时机 - 他们此时进行更改的能力应该非常有限。10/100 天
5.  **交付/后期制作蜜月**- 您已经构建、测试并准备好部署。把代码拿出来，让客户玩。你不应该有太多的调整；但我相信会有一些调整。5/100 天

Some of this seems idealistic; but you'd be surprised how quickly you can ship your application when you've got a well-reviewed, well-created specification.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T12:53:44.453

不可能对这个问题给出一个有意义的答案。各个项目的比率甚至不会大致相同。对于某些项目，视觉设计几乎不重要（只要它或多或少有效），但数据库至关重要且复杂。对于其他人来说，这一切都是为了通过许多 AJAX 好东西和其他吸引眼球的东西来提供流畅的用户体验，但底层数据的组织和存储非常简单。

听起来您主要考虑的是单人项目，但对于较大的团队来说，团队的规模和设置以及您的开发过程也很重要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T20:47:30.477

可能[我们](https://cybernetics.hudora.biz/projects/)是一家不寻常的开发商店。我们的整个存在（至少在工作时间）都是需求收集。开发人员也必须在其他所有部门工作。无论是在售后支持中接听电话（与 CRM 软件作斗争），在仓库里驾驶叉车（与移动终端作斗争），还是在装运站包装板条箱（与混乱的交货单作斗争）。

当我们处理一个新项目时，“需求收集”通常是在白板上的一个下午，通常与使用新软件最多的部门的某个人在一起。很少有前期设计，还有很多重构和重写。我们对此非常满意，并生成了大约 100.000 行架构良好且稳定的代码。

但似乎我们现在遇到了复杂性障碍。这是非常令人沮丧的，因为转向比 hack 和 slay 编码更“重”的流程会导致生产力的巨大损失。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-28T13:31:07.597

需要明确的是——你基本上是在对你的工作进行时间限制——这与拥有固定预算（4 个开发人员 x 每天 x 美元 x 100 天——假设它是 100 天的持续时间而不是 100 天的工作量）直接相关。如果是这种情况，那么，平均。你会花费：

*   25% 的前期规划，包括范围、规格开发、技术方法、物流（计算机、服务器、工作空间）、资源收集。
*   50 % 开发 - 测试用例 (TDD) 开发、模式设计和实施、前端编码、后端编码、部署
*   15% 测试 - 基本中断/修复活动
*   10% 开销/管理 - 项目管理、沟通和协调。

非常粗略的估计 - 许多“领域”需要考虑，包括资源技能/成熟度、正在使用的技术、资源的位置（一个房间或全国范围内）、要求水平等。使用“特定技能”资源将进行规划更困难，因为您可能需要资源来执行多角色 - 一个建议是让 3 位可以帮助规范/设计/计划的通才和一个技术向导，以确保正确设置平台和数据库（成功的关键一旦你有尽可能好的要求）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-28T22:53:27.990

这真是一个棘手的问题。为了对您需要申请每个步骤的时间比例给出一个准确的估计——如果我们采用经典的设计、实施、测试和部署方法——需要了解项目成员的规范和专业知识。如果您阅读 McConnell 的“软件估计”一书（我强烈推荐），那么您在他们的书中有一章是关于历史数据以及如何将其用于未来项目的。我不认为你有以前项目的确切历史数据——嗯——我没有——尽管我总是提醒我记录它们；）因为设计阶段最小的失败或不确定性是最关键的**花很多时间来指定你想做什么**. 确保每个人都以相同的方式理解并写下来。长话短说——我将 50% - 75% 的时间用于设计（如果 75% 将包括一个原型以清除所有不确定性），并在实施和测试中投入相同的部分。如果您使用的是 TDD，您将混合设计和测试，这样您就需要一些设计阶段并将其添加到测试阶段。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-24T11:30:08.583

1.  建立客户需求清单 1-2 天
        这取决于客户、他们的需求以及他们的准备情况。
2.  设计师在 2-3 天内完成初步草图设计
        这里会发生一些分支，因为 2 和 3 将同时发生。
3.  程序员构建我们现有系统中尚未包含的任何功能 1 天 - 1 个月
        这取决于客户，以及他们比大多数其他东西更需要什么。
        这也只会产生功能代码。
4.  重复步骤 2 和 3，直到客户对我们所拥有的总体感觉感到满意。
        可能是 1 次迭代可能是 100 次（如果到 10 次我们不能让他们高兴，我们会将他们发送到其他地方，这不太可能。

5.  构建最终设计 1-5 天
        这是最终的，没有错误，有效的 CSS/HTML/JS，一切都是跨浏览器等

6.  构建最终功能 2-3 天
        这个代码是“完美的”，它 100% 工作，它很漂亮，没有*已知*的错误，开发人员很乐意发送它
        这和第 5 步同时发生。
7.  部署 10 秒。

然后 2 周、2 个月和 6 个月后，我们会进行审查以确保没有问题。

因此，如果您跳过审核，这通常需要 8-20 天，IDK 您将如何将其工作到 100 天。

* * *

如果我们只是为客户构建一个应用程序（或扩展一个应用程序），我们将花费 2-3 时间来准确定义***他们***需要什么，然后不管构建它需要多长时间。

# vb.net - 为什么 Cint("1") 会失败？

> ID：475858
> 
> 赞同：3
> 
> 时间：2009-01-24T11:03:11.570
> 
> 标签：vb.net, citrix

我正在尝试在 Citrix 环境中部署 WinForms 应用程序。它已经在其他物理机和虚拟机上可靠地运行了一段时间，但只有在 Citrix 桌面上运行应用程序时才会出现故障。

失败通常是我们在（SQL Server 2005）数据库的通用设置表中将混合类型的数据作为字符串，然后在运行时将它们转换为适当的类型。

因此，例如，数据库中的 varchar(50) 列中有一个“1”，它被读入，然后类似

```
dim myNumericVariable as integer = Cint(dr.Item(columnName)) 
```

（其中 dr 是来自 ADO.NET 的 DataRow）。

抛出的异常中的消息说：

```
Conversion from string "1" to type 'integer' is not valid 
```

这种故障发生在整个应用程序中，但仅限于 Citrix 环境中。在我们所有其他环境中，它运行良好，但我不知道它是 Citrix 的事实是否只是侥幸，还有其他一些根本原因。

这是一个 VB.NET 应用程序，.NET 2.0，同时开启了 Strict 和 Explicit，针对 x86 编译。它可以在 XP SP3 以及 Windows 2003 Server x64 上完美运行。

我对此束手无策 - 我已经看了一遍，没有发现任何关于我为什么会看到这种行为的暗示。我将非常感谢您的建议。如果您需要有关环境或应用程序构建方式的更多信息，我会很乐意编辑问题。提前致谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T11:12:48.183

这是一个[已知的错误](https://support.microsoft.com/en-us/kb/942460)；希望他们能解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T14:14:15.977

是的，我在我的 32 位 Vista 笔记本电脑上也没有看到任何错误，所以很难说。

也许你可以试试 Integer.Parse()？

```
Dim yourVar as Integer = Integer.Parse(dr.Item("YourColName").toString()) 
```

# directx - directx鼠标点击模拟

> ID：475860
> 
> 赞同：1
> 
> 时间：2009-01-24T11:05:01.693
> 
> 标签：directx, mouse, click, simulation

如何在 directx 应用程序中模拟鼠标点击？带有 WM_LBUTTONDOWN 的 mouse_event 和 PostMessage 不起作用...

所以它必须与 DirectInput 有关

我没有发现任何对谷歌有用的东西，所以你可能知道答案......

提前致谢

//更新

我写错了文字，我想要的是让directx应用程序相信鼠标刚刚点击，但没有有效地使用鼠标，也没有使用SendInput或mouse_event，这需要窗口必须聚焦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T22:58:35.557

试试[AutoIt](http://www.autoitscript.com/)，它非常适合向特定控件发送点击。这

```
ControlClick ( "title", "text", controlID [, button [, clicks [, x [, y ]]]] ) 
```

command 可以做你想做的事。directx 控件将检测到点击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T18:06:47.987

如果它是您自己的应用程序，您能否将点击事件重构为类似（在伪代码中）：

```
void click(int x, int y)  {
     do_action();
} 
```

或者

```
void area_click(int x, int y) {
     do_action();
} 
```

由*真正的*点击处理程序调用。

# python - Python - 为什么在课堂上使用“自我”？

> ID：475871
> 
> 赞同：86
> 
> 时间：2009-01-24T11:13:19.617
> 
> 标签：python, oop

这两个班级有何不同？

```
class A():
    x=3

class B():
    def __init__(self):
        self.x=3 
```

有什么显着差异吗？

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2009-01-24T11:17:47.843

`A.x`是一个*类变量*。 `B`'s`self.x`是一个*实例变量*。

ie是在实例之间共享`A`的。`x`

使用可以修改的内容（例如列表）更容易证明差异：

```
#!/usr/bin/env python

class A:
    x = []
    def add(self):
        self.x.append(1)

class B:
    def __init__(self):
        self.x = []
    def add(self):
        self.x.append(1)

x = A()
y = A()
x.add()
y.add()
print("A's x:", x.x)

x = B()
y = B()
x.add()
y.add()
print("B's x:", x.x) 
```

输出

```
A's x: [1, 1]
B's x: [1] 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-01-24T11:57:59.107

顺便说一句：`self`实际上只是一个随机选择的词，每个人都使用，但你也可以使用`this`, `foo`，`myself`或任何你想要的东西，它只是类的每个非静态方法的第一个参数。这意味着这个词`self`不是一种语言结构，而只是一个名称：

```
>>> class A:
...     def __init__(s):
...        s.bla = 2
... 
>>> 
>>> a = A()
>>> a.bla
2 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-01-24T11:41:32.227

Ax 是一个类变量，将在 A 的所有实例之间共享，除非在一个实例中特别重写。Bx 是一个实例变量，B 的每个实例都有它自己的版本。

我希望下面的 Python 示例可以澄清：

```
 >>> class Foo():
    ...     i = 3
    ...     def bar(self):
    ...             print 'Foo.i is', Foo.i
    ...             print 'self.i is', self.i
    ... 
    >>> f = Foo() # Create an instance of the Foo class
    >>> f.bar()
    Foo.i is 3
    self.i is 3
    >>> Foo.i = 5 # Change the global value of Foo.i over all instances
    >>> f.bar()
    Foo.i is 5
    self.i is 5
    >>> f.i = 3 # Override this instance's definition of i
    >>> f.bar()
    Foo.i is 5
    self.i is 3 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2012-07-05T10:30:27.680

我曾经用这个例子来解释它

```
# By TMOTTM

class Machine:

    # Class Variable counts how many machines have been created.
    # The value is the same for all objects of this class.
    counter = 0

    def __init__(self):

        # Notice: no 'self'.
        Machine.counter += 1

        # Instance variable.
        # Different for every object of the class.
        self.id = Machine.counter

if __name__ == '__main__':
    machine1 = Machine()
    machine2 = Machine()
    machine3 = Machine()

    #The value is different for all objects.
    print 'machine1.id', machine1.id
    print 'machine2.id', machine2.id
    print 'machine3.id', machine3.id

    #The value is the same for all objects.
    print 'machine1.counter', machine1.counter
    print 'machine2.counter', machine2.counter
    print 'machine3.counter', machine3.counter 
```

然后输出将由

```
machine1.id 1
machine2.id 2
machine3.id 3

machine1.counter 3
machine2.counter 3
machine3.counter 3

```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-07-29T21:47:11.673

我刚刚开始学习 Python，这也让我困惑了一段时间。试图弄清楚这一切是如何运作的，我想出了这段非常简单的代码：

```
# Create a class with a variable inside and an instance of that class
class One:
    color = 'green'

obj2 = One()

# Here we create a global variable(outside a class suite).
color = 'blue'         

# Create a second class and a local variable inside this class.       
class Two:             
    color = "red"

    # Define 3 methods. The only difference between them is the "color" part.
    def out(self):     
        print(self.color + '!')

    def out2(self):
        print(color + '!')

    def out3(self):
        print(obj2.color + '!')

# Create an object of the class One
obj = Two() 
```

当我们调用时，`out()`我们得到：

```
>>> obj.out()

red! 
```

当我们打电话时`out2()`：

```
>>> obj.out2()

blue! 
```

当我们打电话时`out3()`：

```
>>> obj.out3()

green! 
```

因此，在第一个方法`self`中指定 Python 应该使用变量（属性），它“属于”我们创建的类对象，而不是全局对象（在类之外）。所以它使用`color = "red"`. 在方法中，Python 隐式替换`self`了我们创建的对象的名称（`obj`）。`self.color`意思是“我从那里`color="red"`得到`obj`”

在第二种方法中，没有`self`指定应该从中获取颜色的对象，因此它获取的是全局的`color = 'blue'`。

在第三种方法中，`self`我们使用`obj2`了 - 另一个对象的名称来获取`color`。它得到`color = 'green'`.

# c# - 如何从弹出窗口重新加载父页面而不删除控件值

> ID：475876
> 
> 赞同：0
> 
> 时间：2009-01-24T11:18:59.637
> 
> 标签：c#, asp.net, javascript, asp.net-2.0

我创建了两个 aspx 页面，父页面和弹出页面。我想在弹出页面中的某些操作完成后刷新父页面。我正在使用 Page.RegisterStartupscript 选项来重新加载父页面但是如果我从父页面调用一些服务器事件这也重复两次..我不需要那个...我尝试了每个解决方案我能做的...但是没有任何效果所以请帮助我...我正在等待回复........在这里是一些代码，我通过它从父页面重新发送或取消弹出窗口....

//在 Popup.aspx.cs 文件中

会话["txt"]=txtval.Text; Page.RegisterStartUpScript("ReloadParent","window.opener.location.reload(false);");

//在 Parent.aspx.cs 文件中 Response.Write(Session["txt"]);

--->在页面加载中此语句之后调用某些事件...

请帮帮我....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T15:32:49.950

你可以尝试做

window.opener.__doPostBack();

# hibernate - Hibernate 中的多图

> ID：475879
> 
> 赞同：9
> 
> 时间：2009-01-24T11:22:56.273
> 
> 标签：hibernate, multimap

我需要一个将条目存储为键值对的集合（因此我可以通过键查找值），但我需要一个允许多个值使用休眠共享同一个键的集合

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-24T11:59:09.930

一个键具有多个值的映射称为多映射 - 在 Apache 公共库中有一个实现。Hibernate 不直接支持这种集合，但可以通过实现`UserCollectionType`接口相对容易地进行扩展。这篇[博客文章](http://blog.xebia.com/mapping-multimaps-with-hibernate/)详细描述了如何做到这一点。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-24T13:00:27.577

我也发现了一些相关的东西

> [http://commons.apache.org/collections/api-3.1/org/apache/commons/collections/MultiMap.html#get(java.lang.Object)](http://commons.apache.org/collections/api-3.1/org/apache/commons/collections/MultiMap.html#get(java.lang.Object))

所以也可以喜欢这个。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-07-14T22:42:34.340

[谷歌收藏](http://code.google.com/p/google-collections/)上有一个[多图](http://google-collections.googlecode.com/svn/trunk/javadoc/index.html?com/google/common/collect/Multimap.html)。我不知道它们是否与休眠兼容。

# linux - 网络设备的 ACL

> ID：475880
> 
> 赞同：3
> 
> 时间：2009-01-24T11:23:24.120
> 
> 标签：linux, authentication, cgi, acl, access-control

我需要为设备实现基于 ACL 的身份验证机制。该设备可以通过各种界面访问，如网页、TL1（基本上通过一些命令提示符）等。

我需要保持 ACL 逻辑集中，以便可以对来自任何接口的请求进行身份验证。

ACL 逻辑基本上会检查登录用户是否可以执行他尝试执行的操作。为此，我将创建组并将用户添加到这些组。每个组将维护该特定组下允许的操作列表。

有人可以建议是实现这一点的最佳方式吗？

是否有任何现有的软件/工具可以让我实现这一目标？有什么开源项目吗？

我是一名 C/C++ 程序员，也是 ACL 概念的新手。上面提到的模块是为 Linux 操作系统开发的。Web 界面将在 CGI 中。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-12T12:53:11.060

你的问题具有误导性。您所问的，在大多数情况下与 linux 中文件系统对象的 ACL 无关。

我假设您的 cgi 是一个用 c++ 编写的单个文件。

您将不得不使用一些本地数据存储解决方案。在您的位置，我使用了 sqlite 或其他一些基于 sql 的解决方案。

我认为，您的 acl 列表（不是基于文件系统的 ACL）应该存储在您的本地数据库中。

Ps 此外，我建议至少使用多线程 fcgi，大型 cgi 二进制文件确实非常不理想。

# sql-server - Sql server 数据库 疑似标记？

> ID：475887
> 
> 赞同：1
> 
> 时间：2009-01-24T11:29:03.827
> 
> 标签：sql-server

我的 sql server 将一个数据库标记为可疑，在检查时我发现我的 mdf,ldf 文件丢失，但 chkdsk 上没有错误，这意味着一些病毒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T12:25:52.310

[http://support.microsoft.com/kb/180500](http://support.microsoft.com/kb/180500)

*启动时，SQL Server 尝试获取设备文件的排他锁。如果设备正在被其他进程（例如备份软件）使用或**文件丢失**，则会遇到上述情况。在这些情况下，设备和数据库通常没有问题。**要使数据库正确恢复，必须使设备可用，并且必须重置数据库状态**。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T13:02:11.503

这意味着有人删除了文件。

它们在使用时*无法*删除，因此发生了：

*   SQL Server 关闭时
*   数据库已关闭（通常是 Express 版本）
*   数据库已脱机

默认情况下（结束编辑），所有用户 dbs 将共享同一个文件夹（编辑），所以这是故意的

更奇特的选项包括恢复主数据库，其中恢复的主数据库中列出的数据库/MDF 文件不存在等。但我对此表示怀疑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T15:03:17.030

文件已被删除，或者它们已被移动并从位置更改之前恢复了主数据库备份。在这两种情况下，只有在数据库处于脱机状态时才能删除或移动物理文件——因为 sql server 已关闭或数据库已关闭。

这些事情中的任何一个都不太可能是偶然发生的。它不太可能是通用病毒或特洛伊木马，因此要么必须在 SQL Server 启动之前在启动时专门删除文件（假设您的数据库自动启动），要么关闭数据库然后专门删除文件。鉴于 chkdsk 不报告错误，也不太可能是磁盘问题，因此可以确定错误的原因是故意的数据库（错误）管理。

我认为最有可能的选择是 dba 已决定将文件移到其他地方 - 通常这是出于空间或性能原因 - 例如，如果将新驱动器添加到空间不足的机器上，那么数据库可以移到那个。由于某种原因，主数据库的备份随后已从移动前的某个点恢复。

我的第一个动作是对系统进行全面扫描以查找所有 mdf/ldf 文件并（希望）找到它们。我还会扫描备份并寻找最新的主数据库备份。然后，您可以尝试恢复最后一个主备份，看看是否解决了问题（我当然会先备份当前的主备份），如果失败，或者直接重新附加丢失的文件。

如果您找不到 mdf/ldf 文件，那么您唯一的选择是从备份中恢复。如果您没有备份，那么您的数据库将丢失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-05T07:22:38.647

在 SQL Server 中，可疑数据库是用户无法连接数据库的一种模式。此时用户无法执行任何操作，也无法执行任何操作，例如不打开不备份和不恢复等。

此问题的可能原因可能是以下之一： 1\. 数据库已损坏 2\. 内存状态不足。3.意外关机等 4.操作系统找不到数据库文件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-26T07:09:13.240

在这种情况下，您可以检查 SQL Server 日志。转到管理，单击 SQL Server 日志，然后单击当前并检查消息。

就我而言，我得到了这个：错误 17207，严重性 16，状态 1（它与日志文件删除或损坏有关）

**解决方案：**

**将数据库设置为单用户模式：**

```
Alter database dbname set single_user 
```

现在将数据库设置为紧急模式：

```
Alter database dbname set emergency 
```

修复丢失的日志文件或损坏的日志文件与数据丢失。

```
DBCC CHECKDB ('dbname', REAPIR_ALLOW_DATA_LOSS) 
```

注意：使用此命令可能会丢失数据。这也取决于客户的批准。

现在将数据库设置为多用户模式；

```
alter database dbname set multi_user 
```

# c++ - 这会导致 C++ 中的内存泄漏吗？

> ID：475888
> 
> 赞同：6
> 
> 时间：2009-01-24T11:29:39.567
> 
> 标签：c++, pointers, memory-leaks, reference, memory-management

我对 C++ 内存管理有疑问，这（显然）与引用和指针有关。假设我有一个`Class`带有方法的类`my_method`：

```
OtherClass& Class::my_method( ... ) {
    OtherClass* other_object = new OtherClass( ... );
    return *other_object;
} 
```

同时在附近的一段代码中：

```
{
    Class m( ... );
    OtherClass n;
    n = m.my_method( ... );
} 
```

所以，我知道有一个关于指针的一般规则（~“任何新的，都必须是 delete-d”）以避免内存泄漏。但基本上我引用了我的堆分配对象，所以当 n 超出范围时，不应该调用 OtherClass 的析构函数从而释放 other_object 先前指向的内存吗？所以最后真正的问题是：这会导致内存泄漏吗？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-24T11:34:58.200

是的，这将导致内存泄漏。

您要做的是，在 return 语句中，取消引用您创建的新对象。编译器将调用赋值运算符作为返回的一部分，并将新对象的 CONTENTS 复制到调用方法中分配给它的对象。

新对象将留在堆上，其指针从堆栈中清除，从而造成内存泄漏。

为什么不返回一个指针并以这种方式管理它呢？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-24T12:04:49.043

很明显，您希望向调用者返回一个不需要保留任何引用的新对象。为此，最简单的做法是按值返回对象。

```
OtherClass Class::my_method( ... ) {
    return OtherClass( ... );
} 
```

然后在调用代码中，您可以像这样构造新对象。

```
{
    Class m( ... );
    OtherClass n( m.mymethod( ... ) );
} 
```

这避免了对返回对临时对象的引用或要求客户端管理删除返回的指针的任何担忧。请注意，这确实要求您的对象是可复制的，但这是一种合法且通常实现的优化，以便在按值返回时避免复制。

如果您需要共享所有权或对象的生命周期超出调用函数的范围，则只需要考虑共享指针或类似的东西。在后一种情况下，您可以将此决定留给客户端，但仍按值返回。

例如

```
{
    Class m( ... );

    // Trust me I know what I'm doing, I'll delete this object later...
    OtherClass* n = new OtherClass( m.mymethod( ... ) );
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-24T11:33:58.093

在 C++ 中调用析构函数和释放内存是两个不同的事情。

`delete`既调用析构函数又释放内存。`delete[]`为分配的元素数量调用析构函数，然后释放内存。

当 OtherClass 超出范围时，将调用析构函数，但不会释放内存。

* * *

作为一个建议，当您觉得您已经彻底理解了 C++ 中的指针时，请查看智能指针，例如提升智能指针以简化您在 C++ 中的内存管理寿命。（例如，请参阅此处的[文章](http://www.codeproject.com/KB/stl/boostsmartptr.aspx)以获取介绍）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-24T11:38:34.993

您有 2 个 OtherClass 对象：

一个是n，在栈上创建，超出范围后成功删除。

另一个是您在 my_method 内的堆上创建的。这个永远不会被删除，会导致内存泄漏。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-24T11:46:28.973

通常，当本地对象超出范围时，它的内存被*释放*只是因为它被分配在堆栈上并且堆栈被自动清理。由于您的对象是在堆上分配的，因此无法自动释放它。释放它的唯一方法是显式调用 delete。

我想你可能可以这样做：

声明另一个类`DummyClass`，其中包含一个公共成员，该成员是指向`OtherClass`对象的指针。在 DummyClass 的构造函数中，清除指向 NULL 的指针。在你的函数中，声明一个类型的对象`DummyClass`，以及它的成员指针来创建另一个类型的对象`OtherClass`。然后在 的析构函数中`DummyClass`，检查指针是否为 NULL，如果不是，则删除它。这样，当 DummyClass 对象超出范围时，您的对象将被自动清理。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-24T11:54:23.310

如果可能，您可以考虑使用 std::auto_ptr 或 boost/c0x shared_ptr 来简化内存管理。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-24T12:18:12.637

如果您坚持堆栈分配，请不要使用`new`运算符 in`my_method()`并传递引用来`n`代替，即：

```
void Class::my_method( OtherClass& other_object, ... ) {
    other_object.init( ... );
} 
```

然后`my_method()`像这样调用：

```
{
    Class m( ... );
    OtherClass n;
    m.my_method( n, ... );
} 
```

要使这种模式起作用，`Class`必须实现某种`init()`方法，该方法允许在不调用构造函数的情况下正确初始化对象。

# hibernate - 为了避免死锁，休眠所需的 C3P0 设置是什么

> ID：475893
> 
> 赞同：49
> 
> 时间：2009-01-24T11:31:09.470
> 
> 标签：hibernate, c3p0

我将 Hibernate 与 MySQL 5.1.30 一起使用。

我有下一个库：

*   **c3p0-0.0.1.2.jar**
*   **mysql-connector-java-5.0.3-bin.jar**
*   **hibernate3.jar**

我使用 hibernate.cfg.xml 进行配置：

```
<!DOCTYPE hibernate-configuration PUBLIC
    "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
    "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">

<hibernate-configuration>
    <session-factory>
        <!-- Database connection settings -->
        <property name="connection.driver_class">org.gjt.mm.mysql.Driver</property> 

        <property name="connection.url">jdbc:mysql://localhost/fooDatatbase</property>
    <property name="connection.username">foo</property>
    <property name="connection.password">foo123</property>

        <!-- Use the C3P0 connection pool provider -->
    <property name="hibernate.c3p0.min_size">5</property>
    <property name="hibernate.c3p0.max_size">20</property>
    <property name="hibernate.c3p0.timeout">300</property>
    <property name="hibernate.c3p0.max_statements">50</property>
    <property name="hibernate.c3p0.idle_test_periods">3000</property>       

        <!-- SQL dialect -->
        <property name="dialect">org.hibernate.dialect.MySQLDialect</property>

        <!-- Enable Hibernate's automatic session context management -->
        <property name="current_session_context_class">thread</property>

        <!-- Disable the second-level cache  -->
        <property name="cache.provider_class">org.hibernate.cache.NoCacheProvider</property>

        <!-- Echo all executed SQL to stdout -->
        <property name="show_sql">true</property>

        <mapping resource="databaselayer/mail/Mail.hbm.xml"/>
        <mapping resource="databaselayer/courses/Course.hbm.xml"/>
        <mapping resource="databaselayer/price/Price.hbm.xml"/>        
        <mapping resource="databaselayer/contact/Contact.hbm.xml"/>
        <mapping resource="databaselayer/artists/Musician.hbm.xml"/>
        <mapping resource="databaselayer/concerts/Concert.hbm.xml"/>     
        <mapping resource="databaselayer/welcome/Welcome.hbm.xml"/>
        <mapping resource="databaselayer/information/Information.hbm.xml"/>                             
    </session-factory>
</hibernate-configuration> 
```

在**JAVA persistence with hibernate**一书中，对 c3p0 配置选项进行了解释：

*   **hibernate.c3p0.min_size**这是 C3P0 始终保持就绪的最小 JDBC 连接数
*   **hibernate.c3p0.max_size**这是池中的最大连接数。如果此数字用尽，则在运行时引发异常。
*   **hibernate.c3p0.timeout**您指定从池中删除空闲连接的超时时间（在本例中为 300 秒）。
*   **hibernate.c3p0.max_statements**将被缓存的最大语句数。缓存准备好的语句对于 Hibernate 的最佳性能至关重要。
*   **hibernate.c3p0.idle_test_periods**这是自动验证连接之前的中间时间（以秒为单位）。

我使用 Java 1.5.0_09 和**tomcat 6.0**。我在 tomcat 中部署了三个应用程序。他们每个人都使用 hibernate 和一个几乎等同于上面显示的配置文件（只有用户名、数据库名、密码和映射资源发生变化）。

不幸的是，使用上述设置，运行几个小时后，我得到了一些令人讨厌的**死锁错误**，最终杀死了 tomcat。

```
Jan 22, 2009 3:29:07 PM com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector run
WARNING: com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector@2437d -- APPARENT DEADLOCK!!! Creating emergency threads for unassigned pending tasks!
Jan 22, 2009 3:29:07 PM com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector run
WARNING: com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector@1dc5cb7 -- APPARENT DEADLOCK!!! Creating emergency threads for unassigned pending tasks!
Jan 22, 2009 3:29:07 PM com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector run
WARNING: com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector@9cd2ef -- APPARENT DEADLOCK!!! Creating emergency threads for unassigned pending tasks!
Jan 22, 2009 3:29:07 PM com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector run
WARNING: com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector@4af355 -- APPARENT DEADLOCK!!! Creating emergency threads for unassigned pending tasks!
Jan 22, 2009 3:29:07 PM com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector run
WARNING: com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector@1275fcb -- APPARENT DEADLOCK!!! Creating emergency threads for unassigned pending tasks!
Jan 22, 2009 3:29:35 PM com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector run 
```

这似乎是几个人已经遇到的错误。我将设置更改为尝试遵循此处描述的解决方法[http://forum.hibernate.org/viewtopic.php?p=2386237](http://forum.hibernate.org/viewtopic.php?p=2386237)为：

```
<property name="hibernate.c3p0.acquire_increment">1</property>
<property name="hibernate.c3p0.min_size">0</property>
<property name="hibernate.c3p0.max_size">48</property>
<property name="hibernate.c3p0.timeout">0</property>
<property name="hibernate.c3p0.max_statements">0</property> 
```

使用新设置，我不会遇到死锁，但我会：

```
WARNING: SQL Error: 0, SQLState: 08S01
Jan 24, 2009 5:53:37 AM org.hibernate.util.JDBCExceptionReporter logExceptions
SEVERE: Communications link failure due to underlying exception: 

** BEGIN NESTED EXCEPTION ** 

java.io.EOFException

STACKTRACE:

java.io.EOFException
    at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:1913) 
```

有谁知道我做错了什么，以及如何正确设置 c3p0？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2010-09-17T00:52:26.110

实际上这可能为时已晚，但问题很简单： `hibernate.c3p0.idle_test_periods`不能高于`hibernate.c3p0.timeout`或无法正确检测到数据库关闭的连接。

此外，死锁检测警告看起来像您的代码的某些部分没有正确地将连接返回到池（即 session.close()）

当您的应用程序空闲并且 MySQL 关闭服务器上的连接时，会发生 MysqlIO 异常。现在，如果 C3P0 没有正确检查连接是否仍然实际连接，您将获得 EOFExceptions。

我希望这可能会有所帮助。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-08-13T15:14:29.563

这个问题没有明确的答案，因为它会根据使用情况和负载模式在应用程序之间发生变化。

第一点是参考链接[https://www.hibernate.org/214.html](https://www.hibernate.org/214.html)，因为您似乎已经这样做了并且继续前进。这里有一些提示；

*   numHelperThreads ：不持有竞争锁的辅助线程。将这些操作分布在多个线程上
*   maxStatements ：c3p0 的全局 PreparedStatement 缓存的大小。
*   maxStatementsPerConnection ：PreparedStatements c3p0 将为单个池连接缓存的数量。
*   maxAdministrativeTaskTime ：如果任务超过设定的时间限制，则强制调用任务线程的中断（）方法的参数

前三个参数可以根据设置的值提高或降低性能，其中第四个参数可以在设置限制后中断线程并改变运行到其他线程。

近似值

*   numHelperThreads = 6
*   最大语句数 =100
*   maxStatementsPerConnection = 12
*   maxAdministrativeTaskTime = 需要足够的时间才能在生产环境中运行繁重的查询

maxStatements 和 maxStatementsPerConnection 应该测试几个月，因为由于这些参数，很少有帖子指向死锁。

也参考这些链接将是有用的；

*   [http://www.mchange.com/projects/c3p0/index.html#configuration_properties](http://www.mchange.com/projects/c3p0/index.html#configuration_properties)
*   [http://www.mchange.com/projects/c3p0/index.html#hibernate-specific](http://www.mchange.com/projects/c3p0/index.html#hibernate-specific)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-10T10:29:05.747

**hibernate.c3p0.idle_test_periods**必须小于 h* *ibernate.c3p0.timeout* * 因为第一个只是休眠检查空闲连接并尝试关闭它的时间值。

同时，第二个是需要弹出连接的时间。

如果 idle_test_periods 大于 timeout 参数而不是 hibernate 则查找系统中为 null 或不存在的任何内容。至少我是这样理解的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-08-29T21:02:25.337

```
 <property name="hibernate.c3p0.timeout">300</property>     
    <property name="hibernate.c3p0.idle_test_periods">3000</property> 
```

idle_test_period 值应小于等于超时值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-18T00:03:41.793

那是Connector/J 的一个相当老的版本。为了确保您没有与已知且已修复的错误作斗争，我将从获取最新的错误（5.0.8）开始：

[http://dev.mysql.com/downloads/connector/j/5.0.html](http://dev.mysql.com/downloads/connector/j/5.0.html)

这有点可疑`EOFException`。`MysqlIO`在正常/非错误使用情况下，您不应该从该层得到错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T13:33:07.073

三个应用程序共享同一个连接池，还是每个应用程序都有自己的连接池？我推荐后者。

# iphone - iPhone 开发 - 当我更改方向时，我的应用程序崩溃

> ID：475911
> 
> 赞同：2
> 
> 时间：2009-01-24T11:47:26.850
> 
> 标签：iphone, orientation

我遇到了这个问题，我的应用程序`EXC_BAD_ACCESS`出错并卡住/停止。我正在使用模拟器的“向左旋转”和“向右旋转”选项来模拟方向变化行为。此错误的可能原因是什么？由于我没有得到有关错误的详细信息，因此无法追踪它。

我所有的控制器类都有：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return (interfaceOrientation == UIInterfaceOrientationPortrait);    // Return YES for supported orientations
} 
```

任何想法，指针？谢谢。

* * *

但是我的代码没有调用 [UIDevice setOrientation:] 方法。

这是我在调试窗口中得到的跟踪：

```
objc_msgSend
-[UIWindow _handleDeviceOrientationChange:]
_nsnote_callback
__CFXNotificationPost
_CFXNotificationPostNotification
-[NSNotificationCenter postNotificationName:object:userInfo:]
-[UIDevice setOrientation:]
-[UIApplication handleEvent:withNewEvent:]
_[UIApplication sendEvent:]
_UIApplicationHandleEvent 
SendEvent
PurpleEventTimerCallBack
CFRunLoopRunSpecific
CFRunLookRunInMode
GSEventRunModel
GSEventRun
-[UIApplication _run]
UIApplicationMain
main 
```

请注意，当我的视图包含标签栏时会出现错误。由于没有人回复，我想这不是一个常见问题，我找不到任何资源来解决这个问题。

> 我可以以某种方式告诉我的应用程序以单一方向（纵向）运行，并且不要发送事件以改变方向吗？这可能会解决我的问题，但这是我正在寻找的替代方案。

* * *

谢谢保罗，您的评论很有帮助，我能够解决问题，但需要为我不需要的视图保留内存。这是发生了什么：

我有一个视图（视图 A），它打开另一个视图（视图 B）。App Delegate 方法负责打开视图 A 和视图 B。应用程序不会在视图 A 上崩溃。我从窗口中删除视图 A，并释放它的控制器对象，并将视图 B 添加到窗口。我相信这是我做错了什么。你能帮我写代码吗？

下面是释放视图 A 和打开视图 B 的代码：

```
- (void)openViewB {
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:1.0];
    [UIView setAnimationTransition:UIViewAnimationTransitionFlipFromLeft forView:window cache:YES];

    // Remove viewControllerA from the window's view
    [window removeFromSuperview];

    // !-- Commenting out this block fixes the issue --!
    // Release memory wired for viewControllerA view
    if(viewControllerA) {
        [viewControllerA release];
        viewControllerA = nil;
    }       

    // We call window:addSubView to add the viewB to the main window. 
    // You can use this call to add other views as child views not only to windows
    // but to other views as well. (UIWindow is a subclass of UIView).
    [window addSubview:viewControllerB.view];
    [UIView commitAnimations];

    // Override point for customization after application launch
    [window makeKeyAndVisible];
} 
```

我使用标签栏应用程序模板启动了应用程序，`viewControllerB`类型为`UITabBarController`. 我肯定在这里做错了什么。任何指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T19:02:55.290

由于设置不正确而导致系统库代码崩溃的情况并不少见。这可能是您的 UIWindow 或其内容视图或您的视图控制器实例未保留或以某种方式释放。

如果您的控制器不在身边，则 shouldrotate 方法将无济于事。

rpetrich 的建议可能仍然有助于确定哪个对象被释放。

对于特别棘手的问题，您可以将 release、retain 和 dealloc 方法（记录并调用 super）添加到您的可疑类中，然后查看释放它的内容。记录 -retaincount 以进行跟踪（我仅将其用于诊断目的，而不是在运输应用程序中进行内存管理）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T00:14:34.110

在调试器中设置断点`-[UIDevice setOrientation:]`并单步执行您的代码。

为了使调试更容易，您可以`call (void)instrumentObjcMessageSends(YES)`在调试器控制台中直接键入以开始将`objc_msgSend`s 记录到 /tmp/，然后`continue`执行，它将跟踪所有发送的消息，直到崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T07:01:53.057

我也遇到了同样的问题，我认为如果使用 [ViewController release] 释放视图控制器但仍在使用视图，那么到那时如果您更改方向应用程序崩溃。

您必须弄清楚何时应该释放视图控制器[最好在退出时]。

# c# - 设计一个可以直接处理 IL 的 CPU 有什么意义吗？

> ID：475915
> 
> 赞同：12
> 
> 时间：2009-01-24T11:55:22.403
> 
> 标签：c#, performance, compiler-construction, cpu, cpu-architecture

如果我理解正确：

当前的 CPU 开发公司，如 AMD 和 Intel，拥有自己的 API 代码（汇编语言），他们认为是机器代码（1G 语言）之上的 2G 语言

是否有可能或希望（性能或其他）拥有一个在其核心执行 IL 处理而不是当前 API 调用的 CPU？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-24T12:22:34.967

Java 确实存在类似的技术——ARM 提供了一系列可以做到这一点的 CPU，他们称之为“Jazelle”技术。

但是，.net IL 操作码所表示的操作仅结合堆栈中保存的类型信息进行了良好定义，而不是单独定义。这是与 Java 字节码的主要区别，并且会使创建合理的硬件来执行 IL 变得更加困难。

此外，IL 旨在编译为最终目标。大多数吐出 IL 的后端很少进行优化，而是旨在保留语义内容以在最终编译步骤中进行验证和优化。即使可以克服硬件问题，结果几乎肯定仍会比体面的优化 JIT 慢。

所以，总结一下：虽然这不是不可能的，但与其他架构相比，这将是不成比例的困难，而且收效甚微。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-24T12:32:35.433

您似乎对 CPU 的工作方式有些困惑。汇编不是与机器代码分开的语言。它只是它的不同（文本）表示。

汇编代码只是要执行的指令的顺序列表。和机器码完全一样。CPU 支持的每条指令都有一个特定的位模式来执行它，它还有一个可以在汇编代码中使用的文本名称。

如果我`add $10, $9, $8`通过汇编程序编写并运行它，我会得到 add 指令的机器代码，获取寄存器 9 和 8 中的值，将它们相加并将结果存储在寄存器 10 中。

汇编程序和机器代码之间存在一对一的映射。

也没有“API 调用”。CPU 简单地从地址 X 读取，并将后续位与它理解的所有指令进行匹配。一旦找到与该位模式匹配的指令，它就会执行该指令，然后继续读取下一条指令。

你所问的在某种意义上是不可能的或矛盾的。IL代表Intermediate Language，即一种由编译器发出但尚未翻译成机器码的伪代码。但是如果 CPU 可以直接执行它，那么它就不再是中间*代码*，而是机器代码。

所以问题变成了“你的 IL 代码是否比 CPU 现在支持的机器代码更好、更有效地表示程序？”

答案很可能是否定的。MSIL（我假设这就是您所说的 IL，这是一个更笼统的术语）被设计为可移植、简单且一致。每种 .NET 语言都编译为 MSIL，并且每个 MSIL 程序都必须能够被翻译成任何地方的任何 CPU 的机器代码。这意味着 MSIL 必须是通用的和抽象的，而不是对 CPU 做出假设。出于这个原因，据我所知，它是一个纯粹的基于堆栈的架构。每条指令不是将数据保存在寄存器中，而是处理堆栈顶部的数据。这是一个非常干净和通用的系统，但它的效率不是很高，并且不能很好地转化为 CPU 的刚性结构。（在你美妙的高级小世界里，你可以假装堆栈可以自由增长。为了让 CPU 快速访问它，它必须存储在一些有限大小的小型快速片上存储器中。那么如果你的程序在堆栈上推送了太多数据会发生什么？）

Yes, you *could* make a CPU to execute MSIL directly, but what would you gain? You'd no longer need to JIT code before execution, so the first time you start a program, it would launch a bit faster. Apart from that, though? Once your MSIL program has been JIT'ed, it *has* been translated to machine code and runs as efficiently as if it had been written in machine code originally. MSIL bytecode no longer exists, just a series of instructions understood by the CPU.

事实上，您将回到 .NET 之前的位置。非托管语言直接编译为机器代码，就像您的建议一样。唯一的区别是，非托管代码的目标机器代码是由 CPU 设计人员设计的，适合在 CPU 上执行，而在您的情况下，它的目标机器代码是由软件设计人员设计的，易于翻译成和从。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-24T12:10:33.853

这不是一个新想法——Java 也有同样的预测，[Lisp 机器](http://en.wikipedia.org/wiki/Lisp_machine)甚至已经实现了。

但这些经验表明它并不是真正有用 - 通过设计专用 CPU，您无法从“传统” CPU 的进步中受益，而且您很可能无法在自己的游戏中击败英特尔。维基百科文章中的一句话很好地说明了这一点：

> 很快，便宜的台式电脑就能够比 Lisp 机器更快地运行 Lisp 程序，而无需使用专用硬件。

即时从一种机器代码转换为另一种机器代码是一个很好理解的问题，而且很常见（现代 CISC CPU 甚至在内部做类似的事情，因为它们真的是 RISC），我相信我们可以假设它已经足够高效地完成了避免它不会产生显着的好处 - 这意味着您必须将自己与传统 CPU 的最新技术脱钩。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-24T12:11:45.647

我会说不。

需要在计算机上运行的实际机器语言指令的级别低于 IL。例如，IL 并没有真正描述应该如何进行方法调用、应该如何管理寄存器、应该如何访问堆栈，或者机器代码级别所需的任何其他细节。

因此，让机器直接识别 IL 将简单地将所有 JIT 编译逻辑从软件转移到硬件中。

这将使整个过程非常僵化和不可改变。

通过拥有基于机器功能的机器语言和基于捕获程序员意图的中间语言，您将获得一个更好的系统。定义机器的人可以专注于定义高效的计算机架构，定义 IL 系统的人可以专注于表现力和安全性。

如果工具供应商和硬件供应商都必须对所有内容使用完全相同的表示，那么硬件空间或工具空间的创新都会受到阻碍。所以，我说它们应该彼此分开。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T12:10:55.303

我不会这么认为有两个原因：-

1.  如果您有硬件处理 IL，则该硬件将无法运行更新版本的 IL。使用 JIT，您只需要一个新的 JIT，然后现有硬件就可以运行更新的 IL。
2.  IL 很简单，并且设计为与硬件无关。IL 必须变得更加复杂，才能以最有效的方式描述操作，以便接近现有机器代码的性能。但这意味着 IL 将更难在非 IL 特定硬件上运行。

# xpath - Xpath 查询和时间

> ID：475923
> 
> 赞同：2
> 
> 时间：2009-01-24T12:01:16.633
> 
> 标签：xpath, time

**嗨，这是我的 XML 文件的内容：**

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<mainNode>
    <sub time="08:00">
        <status id="2">On</status>
        <status id="3">Off</status>
    </sub>
    <sub time="13:00">
        <status id="4">On</status>
        <status id="7">On</status>
    </sub>
    <sub time="16:00">
        <status id="5">On</status>
        <status id="6">On</status>
        <status id="7">Off</status>
        <status id="8">On</status>
    </sub>
    <sub time="20:00">
        <status id="4">Off</status>
        <status id="7">On</status>
    </sub>
    <sub time="23:59">
        <status id="4">On</status>
        <status id="7">On</status>
    </sub>
</mainNode> 
```

**我的程序获取当前时间：如果我得到 15.59，我必须检索下一个子时间（16.00）的所有状态 ID：**

```
<sub time="16:00">
        <status id="5">On</status>
        <status id="6">On</status>
        <status id="7">Off</status>
        <status id="8">On</status>
    </sub> 
```

**使用第二个 XPath 查询，我必须获取上一个子时间 (13.00) 的所有状态 ID。怎么做？我知道 SQL，但我对 XPath 很陌生。如果有的话，我也接受重要的 XPath 资源的 url。谢谢！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T12:54:54.153

这是丑陋的 Xpath 1.0 解决方案：-

```
sub[number((substring-before(@time, ':')) * 60 + number(substring-after(@time, ':'))) &gt; 959][1] 
```

注意 959 = 15 * 60 + 59 我相信你可以在你的调用代码中做到这一点。

给该节点前一个节点可以访问为： -

```
preceding-sibling::sub[1] 
```

然而，实用的、常识性的解决方案是将 XML 数据加载到一组数据结构中，并使用更适合此任务的语言来查找项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T16:53:55.093

这里有两个解决方案：

# 一、XPath 1.0

**这是一对选择所需节点的[XPath 1.0](http://www.w3.org/TR/xpath)表达式**：

```
/*/*
    [translate(@time, ':','') 
    > 
     translate('15:59',':','')
    ][1] 
```

**选择`sub`时间晚于 的第一个节点`15:59`。**

```
/*/*
    [translate(@time, ':','') 
    < 
     translate('15:59',':','')
    ][last()] 
```

**selects 选择时间早于时间的第一个`sub`节点`15:59` `sub`**。

**我们可以将这些包含在 XSLT 转换中**，并检查是否产生了真正想要的结果：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output omit-xml-declaration="yes"/>

    <xsl:template match="/">
      First time after 15:59: 
      <xsl:copy-of select=
       "/*/*
          [translate(@time, ':','') 
         > 
           translate('15:59',':','')
          ][1]
      "/>

      First time before 15:59: 
      <xsl:copy-of select=
       "/*/*
          [translate(@time, ':','') 
         &lt; 
           translate('15:59',':','')
          ][last()]
      "/>
  </xsl:template>
</xsl:stylesheet> 
```

**当对最初提供的 XML 文档**应用上述转换时：****

 **```
<mainNode>
    <sub time="08:00">
        <status id="2">On</status>
        <status id="3">Off</status>
    </sub>
    <sub time="13:00">
        <status id="4">On</status>
        <status id="7">On</status>
    </sub>
    <sub time="16:00">
        <status id="5">On</status>
        <status id="6">On</status>
        <status id="7">Off</status>
        <status id="8">On</status>
    </sub>
    <sub time="20:00">
        <status id="4">Off</status>
        <status id="7">On</status>
    </sub>
    <sub time="23:59">
        <status id="4">On</status>
        <status id="7">On</status>
    </sub>
</mainNode> 
```

**产生了想要的结果**：

```
 First time after 15:59: 

<sub time="16:00">
        <status id="5">On</status>
        <status id="6">On</status>
        <status id="7">Off</status>
        <status id="8">On</status>
</sub>

  First time before 15:59: 

 <sub time="13:00">
        <status id="4">On</status>
        <status id="7">On</status>
 </sub> 
```

**请注意**以下事项：

1.  **使用 XPath[`translate()`](http://www.w3.org/TR/xpath#function-translate)函数**去掉冒号

2.  **[`last()`](http://www.w3.org/TR/xpath#function-last)**第二个表达式中**函数****的使用**

3.  **比较前**无需将时间转换为秒****

***   当用作 XML 文档（例如 XSLT 样式表）的一部分时，**必须****对`<`**运算符进行转义。** 

 **# 二、XPath 2.0

**在[XPath 2.0](http://www.w3.org/TR/xpath20/)中，我们可以使用以下两个表达式**来生成选择所需的节点：

```
/*/*[xs:time(concat(@time,':00')) 
    gt 
     xs:time('15:59:00')
    ][1] 
```

**选择`sub`时间晚于 的第一个节点`15:59`。**

```
/*/*[xs:time(concat(@time,':00')) 
   lt 
     xs:time('15:59:00')
    ][last()] 
```

**selects 选择时间早于时间的第一个`sub`节点`15:59` `sub`**。

**我们可以将这些包含在 XSLT 2.0 转换中**，并检查是否产生了真正想要的结果：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xsl:output omit-xml-declaration="yes"/>

    <xsl:template match="/">
      First time after 15:59: 
      <xsl:copy-of select=
       "/*/*[xs:time(concat(@time,':00')) 
           gt 
             xs:time('15:59:00')
             ][1]
      "/>

      First time before 15:59: 
      <xsl:copy-of select=
       "/*/*[xs:time(concat(@time,':00')) 
           lt 
             xs:time('15:59:00')
          ][last()]
      "/>
    </xsl:template>
</xsl:stylesheet> 
```

**当将上述转换应用于**最初提供的 XML 文档时（与第一个解决方案相同），会产生相同的预期结果。

**请注意**以下事项：

1.  **在 XPath 2.0[`xs:time`](http://www.w3.org/TR/xmlschema-2/#time)中是本机数据类型**。但是，为了`xs:time()`从 xml 文档中的值构造一个，我们必须将丢失的秒部分连接到它们。
2.  **在 XPath 2.0`xs:time`中，值可以与“[原子值comarison 运算符](http://www.w3.org/TR/xpath-functions/#comp.duration.datetime)”**进行比较，例如`lt`or `gt`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T12:36:37.063

好吧，只要时间是 HH:MM 就应该像下面这样工作：（我必须原谅我的语法，因为我只是在不跑步的情况下涉足，请考虑这个伪 xpath）：

```
xmlns:fn="http://www.w3.org/2005/02/xpath-functions"

//sub[fn:compare(@time,'12:59') > 0][1]/status 
```

这应该选择时间大于 12:59 的所有元素，然后选择这些元素中的第一个。

您还可以将值“12:59”作为[外部参数](http://www.w3.org/TR/xslt#top-level-variables)传递到 xpath 评估中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T12:35:52.290

如果您自己生成 xml，您可以使用整数值（例如刻度）更改存储时间属性的方式，然后您可以使用类似的东西进行简单的数值比较

```
//sub[@time > 1389893892] 
```

# python - Vista UAC（用户访问控制）的python IPC（进程间通信）

> ID：475928
> 
> 赞同：4
> 
> 时间：2009-01-24T12:05:46.517
> 
> 标签：python, windows-vista, wxpython, ipc, vista-security

我正在 (wx)python 中编写文件管理器 - 很多已经有效。复制文件时已经有一个进度对话框，覆盖处理等。

现在在 Vista 中，当用户想要将文件复制到某些目录（例如 %Program Files%）时，应用程序/脚本需要提升，在运行时不能要求提升。所以我必须启动另一个提升的应用程序/脚本，它可以完成工作，但需要与主应用程序通信，因此后者可以更新进度等。

我搜索并发现很多文章说共享内存和管道是最简单的方法。所以我正在寻找的是一个“高级”平台独立的ipc库，它使用共享内存或管道进行python绑定。

我已经找到了 ominORB、fnorb 等。它们看起来很有趣，但是使用 TCP/IP，是否有使用共享内存或管道的等效库？由于 ipc-client 总是在同一台机器上，因此这里似乎不需要套接字。而且我还担心用户必须在他/她的个人防火墙上允许 ipc-socket-communications。

编辑：我的意思是高级别的：能够像使用omniORB而不是将字符串发送到stdin/stdout时那样调用一些函数会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T14:00:50.510

使用标准输入/标准输出与第二个进程通信怎么样？

由于输入和输出缓冲，有一些警告，但请查看[这个 Python Cookbook recipe](http://code.activestate.com/recipes/440554/)和[Pexpect](http://www.noah.org/wiki/Pexpect)，了解如何执行此操作的想法。

# asp.net - asp.net中的Web应用程序和网站有什么区别？

> ID：475938
> 
> 赞同：28
> 
> 时间：2009-01-24T12:11:52.557
> 
> 标签：asp.net, web-applications, web

asp.net中的Web应用程序和网站有什么区别？
如果它有一个从各个方面最好的区别？

# parsing - 如何判断一种语言是否为 LL(1) LR(0) SLR(1)

> ID：475949
> 
> 赞同：23
> 
> 时间：2009-01-24T12:19:49.623
> 
> 标签：parsing, compiler-construction, theory, grammar, bnf

是否有一种简单的方法可以确定语法是否为 LL(1)、LR(0)、SLR(1)... 只需查看语法而不进行任何复杂的分析？

例如：要确定 BNF 语法是否为 LL(1)，您必须计算 First 和 Follow 集——在某些情况下这可能很耗时。

有没有人知道如何更快地做到这一点？任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-24T13:22:23.427

首先，有点迂腐。您无法通过检查语法来确定**语言**是否为 LL(1)，您只能对**语法**本身进行陈述。完全有可能为存在 LL(1) 语法的语言编写非 LL(1) 语法。

顺便说一句：

*   您可以为语法编写一个解析器，并让一个程序首先为您计算并遵循集合和其他属性。毕竟，这是 BNF 语法的一大优势，它们是机器可理解的。

*   检查语法并寻找**违反**各种语法类型约束的情况。例如：LL(1) 允许右递归但不允许左递归，因此，包含左递归的文法不是 LL(1)。（对于其他语法属性，您将不得不花一些时间来定义定义，因为我现在不记得其他任何事情了 :)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-16T21:13:12.557

回答您的主要问题：对于一个非常简单的语法，可以在不构造 FIRST 和 FOLLOW 集的情况下确定它是否为 LL(1)，例如

> A → A + A | 一种
> 
> 不是 LL(1)，而
> 
> 一个 → 一个 | b

是。

但是当你变得比这更复杂时，你需要做一些分析。

> A → B | A
> B → A + A

这不是 LL(1)，但可能不会立即明显

算术的语法规则很快变得非常复杂：

> expr → term { '+' term }
> term → factor { '*' factor }
> factor → number | '(' 表达式 ')'

该文法只处理乘法和加法，目前尚不清楚该文法是否为 LL(1)。仍然可以通过查看语法来评估它，但是随着语法的增长，它变得不那么可行了。如果我们要为整个编程语言定义语法，几乎肯定会进行一些复杂的分析。

也就是说，有一些明显的迹象表明语法不是 LL(1)——就像上面的 A → A + A——如果你能在你的语法中找到任何这些，你就会知道它需要重写如果您正在编写递归下降解析器。但是没有捷径可以验证语法*是否为*LL(1)。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-25T02:14:31.310

一方面，“语言/语法是否有歧义”是[一个已知的不可判定问题](http://en.wikipedia.org/wiki/Ambiguous_grammar#Recognizing_an_ambiguous_grammar)，例如[邮政通信](http://en.wikipedia.org/wiki/Post_correspondence_problem)和[停顿](http://en.wikipedia.org/wiki/Halting_problem)问题。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-04-27T18:44:00.400

直接来自 Aho 等人的《编译器：原理、技术和工具》一书。人。

第 223 页：

一个文法 G 是 LL(1)**当且仅**当当 A -> *alpha* | *beta*是 G 的两个不同产生，以下条件成立：

1.  对于没有终端“a”，*alpha*和*beta*都派生以“a”开头的字符串
2.  至多*alpha*和*beta*之一可以导出空字符串
3.  如果*beta*可以通过零个或多个转换到达空转换，则*alpha*不会派生任何以 FOLLOW(A) 中的终端开头的字符串。同样，如果*alpha*可以通过零个或多个转换到达空转换，则*beta*不会派生任何以 FOLLOW(A) 中的终端开头的字符串

本质上，这是验证语法通过成对不相交测试并且不涉及左递归的问题。或者更简洁地说，左递归或模棱两可的文法 G 不能是 LL(1)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-25T14:47:46.600

检查语法是否有歧义。如果是，则文法不是 LL(1)，因为没有歧义文法是 LL(1)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-17T12:38:26.380

是的，有 ll(1) 语法的快捷方式

1) 如果 A->B1|B2|.......|Bn then first(B1)intersection first(B2)intersection .first(Bn)=empty set 那么它是 ll(1) 语法

2) 如果 A->B1|epsilon 则 B1 交集 follow(A) 为空集

3) 如果 G 是任何文法，使得每个非终结符只派生一个产生式，则文法为 LL(1)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2011-12-12T15:38:12.197

```
p0 S' → E
p1 E → id
p2 E → id ( E )
p3 E → E + id 
```

*   构造 LR(0) DFA、E 的 FOLLOW 集和 SLR 动作/转到表。
*   这是 LR(0) 语法吗？证明你的答案。
*   使用 SLR 表，显示 LR 解析器解析的步骤（移位、归约、接受）：
    `id ( id + id )`

# .net - 每个开发人员都应该知道的 ADO.NET 实体框架性能提示

> ID：475956
> 
> 赞同：10
> 
> 时间：2009-01-24T12:26:49.127
> 
> 标签：.net, entity-framework, ado.net

每个 ADO.NET EF 开发人员都应该了解的性能技巧有哪些？

请在每个答案中填写每个提示并解释为什么提示是好的（例如，通过最小化 DB 往返）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-24T12:33:55.913

用于`ObjectContext#GetObjectByKey()`通过键检索实体，而不是在 LINQ 查询中使用`First()`(or ) 运算符。`FirstOrDefault`后者每次都会访问数据库，而前者将`ObjectStateManager`首先在 EF 缓存（具体而言）中搜索实体，如果找到具有指定键的实体，则不会访问数据库。

参考

*   [关于 ObjectContext#GetObjectByKey 的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.getobjectbykey.aspx)
*   [EF 中的 GetObjectbyKey 与查询单个实体](http://www.thedatafarm.com/blog/2008/08/06/GetObjectbyKeyInEFVsQueryingForASingleEntity.aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-07-17T16:50:39.747

我在分析我的应用程序中使用的 EF 代码生成的 SQL 时刚刚学到的一件事：两者之间有区别：

```
IEnumerable<User> users = DB.User.Where(...);
int count = users.Count(); 
```

和

```
IQueryable<User> users = DB.User.Where(...);
int count = users.Count(); 
```

前者生成完整查询以从`User`表中检索匹配的行，并在数据传输回 EF 后完成计数。后者做了通常预期的事情：生成`SELECT COUNT ...`SQL，效率更高。

这是非常微妙的，但在注意到它之后不难理解为什么：这是由于 C# 扩展方法的静态绑定性质。

解决这个问题的一个小技巧是使用“var”关键字来声明变量：

```
var users = DB.users.Where(...);
int count = users.Count(); 
```

这将导致“users”被声明为与“.Where”返回的相同类型；这是一个 IQueryable<>。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-24T12:36:37.343

假设我们有实体通过属性`BlogPost`引用实体。而不是为属性指定完整实体（这可能需要数据库往返），而是使用正确的. 例如：`User``Author``User``BlogPost.Author``EntityKey`

```
BlogPost.AuthorReference.EntityKey = new EntityKey("EFNamespace.User", "Id", userId); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T16:17:24.567

一种更新分离实体对象的快速简便的方法。这是一种扩展方法。

```
public static void AttachUpdated(this ObjectContext obj, EntityObject objectDetached)
{
    if (objectDetached.EntityState == EntityState.Detached)
    {
        object original;
        if (obj.TryGetObjectByKey(objectDetached.EntityKey, out original))
            obj.ApplyPropertyChanges(objectDetached.EntityKey.EntitySetName, objectDetached);
        else
            throw new ObjectNotFoundException();
    }
} 
```

# computer-science - 计算机科学在过去 5 年的进步

> ID：475964
> 
> 赞同：5
> 
> 时间：2009-01-24T12:36:28.933
> 
> 标签：computer-science

我没有计算机科学背景，对 CS 的全部内容只有初步的了解。但是，我想知道，过去五年中最重要的 CS 进步是什么？

为了让您了解我是多么的无知，我无法说出这些进步中的任何一个。但是，请不要让我知道所有血腥的细节。

我不是在寻找有关 CS 的教育或有关 CS 历史的故事。就这个问题而言，只有过去五年才重要！:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T12:42:42.837

此外，看看[自 1980 年以来计算领域的重大新发明](https://stackoverflow.com/questions/432922/significant-new-inventions-in-computing-since-1980)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T13:08:37.403

我能想到的一个明确的例子是[量子计算](http://en.wikipedia.org/wiki/Timeline_of_quantum_computing)：它是一个全新的 CS 领域，大多数重要的研究都发生在过去 10 年中（再一次，一些非常基础的研究可以追溯到 70 年代），虽然它不是但实际上很重要，它很可能会。

回答你的问题的问题是：理论进步几乎总是事后才变得重要，一旦它们产生了改变人们生活的实际应用（因为这是大多数人衡量重要性的方式）——而且这通常在最初的理论之后很久工作。

一个明显的例子就是互联网，在万维网出现之前它已经默默无闻地存在了几十年。我相信，过去 10 年中几乎所有具有重大实际意义的进步都是基于一项更古老的理论工作。

其他类型的重大进展是对众所周知的未解决问题和概念的解决方案，这些问题和概念改变了许多其他理论工作。在过去的 10 年里，我也不知道有类似的事情发生，不是在真正的科学水平上——但我不是科学家。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-24T13:19:17.817

[在过去的 5 年中，手势界面](http://en.wikipedia.org/wiki/Gesture_recognition)似乎发展迅速。虽然人们对它们的探索时间更长，但直到最近我们才有了成功的商业应用：iPhone 和 iPod Touch。微软和研究界最近也展示了一些非常有趣的应用程序。20 年后，我们可能会回顾并认为这是一项非常非凡的创新。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-02T19:04:20.363

CS现在很广泛，可以对您的问题给出一般性的答案。所以我坚持理论 CS：[PCP 定理](http://en.wikipedia.org/wiki/PCP_theorem)。您可以阅读更多内容，例如[这里](http://people.csail.mit.edu/madhu/pcp/course.html)。注意：这在数学上相当复杂。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T13:10:11.363

[IEEE 计算机协会](http://www2.computer.org/portal/web/guest)在计算机科学的许多领域针对不同类型的消费者（一般、行业从业者和管理人员、学术界）发布了几本出版物，软件开发就是其中之一。这里和那里都有一些免费文章，但通过订阅，您将了解 CS 的所有最新进展（和历史成就）......数字档案可以追溯到几十年前！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T13:12:58.347

首先，我会投票赞成敏捷运动的兴起，尤其是 TDD。它与其说是技术发展，不如说是对流程的编纂。然而，鉴于软件开发的历史上充斥着形式化的失败（瀑布方法，有人吗？），并且敏捷及其衍生产品似乎是我们领域中第一个成功的*过程学科*，我会首先投票支持它.

其次，作为一名前 ISAPI dll 开发人员（用于创建 Web 应用程序的低级技术），我认为我们有时会低估 Web 开发框架（从 JQuery 到 ASP.NET 的一切）的重要性。曾经，Web 开发受到构建 CGI 应用程序和 ISAPI dll 的限制，而现在我们拥有更高效的方式来创建 Web 应用程序。这导致了相当复杂的网络应用程序的爆炸式增长。不过，这个故事开始于 10 多年前。

5 到 10 年一般来说有点困难：几项非常重要的技术在 10 多年前就出现了，但需要时间来放松和成熟。

更新：请注意，当我回答时，时间范围是 5-10 年。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-17T03:57:02.313

我将包括社交网站现在在人们生活中的巨大重要性。即使在 5 年前，虽然它们存在，但我不确定有多少人意识到Facebook 和 Twitter 将变得多么*必要。*可能比计算机科学更多的社会科学......这是我的第一篇文章，如果我犯了一些大错，请原谅我;）

# command-line - Mercurial：命令行上的多行提交消息？

> ID：475970
> 
> 赞同：58
> 
> 时间：2009-01-24T12:40:37.757
> 
> 标签：command-line, mercurial

如何在命令行上为 mercurial 指定多行提交消息？

```
hg commit -m "* add foo\n* fix bar" 
```

不起作用。日志显示：

```
changeset:   13:f2c6526e5911
tag:         tip
date:        Fri Jan 23 23:22:36 2009 +0100
files:       foobar.cpp
description:
    * add foo\n*fix bar 
```

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-01-24T12:45:43.440

> Mercurial：命令行上的多行提交消息？

点击进入。

```
$ hg commit -m "Did some work
> Now I'm done" 
```

其中一件事是只有第一行显示在 hg 日志中：

```
$ hg log
changeset:   0:d2dc019450a2
tag:         tip
user:        Aaron Maenpaa <zacherates@gmail.com>
date:        Sat Jan 24 07:46:23 2009 -0500
summary:     Did some work 
```

...但是如果您启动“hg view”，您会看到整个消息都在那里。

编辑添加：

...但是 hg -v log 显示了整个消息：

```
$ hg -v log
changeset:   0:d2dc019450a2
tag:         tip
user:        Aaron Maenpaa <zacherates@gmail.com>
date:        Sat Jan 24 07:46:23 2009 -0500
files:       work
description:
Did some work
Now I'm done 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-04-26T19:20:19.067

在**Windows cmd**中，对多行提交执行此命令。

```
hg commit -l con 
```

这允许您直接从命令行输入多行提交消息。要结束您的消息，请点击`Enter`，然后在一行上单独点击`Ctrl`+`Z`并`Enter`再次点击。

**为什么？**表示从文件中读取提交消息的选项，并指定`-l`该文件实际上是控制台。`hg commit``con`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-24T16:06:39.353

如果您以交互方式进行操作（相对于脚本），只需`hg commit`不使用 -m 标志即可。我不确定 Linux 或 Mac 上的行为是什么，但在 Windows 上，它会弹出记事本，其中包含您填写并保存为多行消息的文件。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-17T12:40:41.543

我知道，已经有针对 linux 用户的解决方案，但是我需要针对 windows 命令行的另一种解决方案，所以我一直在寻找它......

我找到了一个： [https ://www.mercurial-scm.org/pipermail/mercurial/2011-November/040855.html](https://www.mercurial-scm.org/pipermail/mercurial/2011-November/040855.html)

```
hg commit -l filename.txt 
```

我希望，它对那里的人有用，）

[编辑] oO - 它已被添加到帮助中

> -l --logfile FILE 从文件中读取提交信息

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-17T18:43:19.583

这是另一种更接近您最初尝试的方法：

```
hg commit -m "$(echo -e 'foo\nbar')" 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-03-17T09:02:46.053

在 bash 中（从 2.0 版开始）：

```
hg commit -m $'foo\nbar' 
```

（即在开始的单引号之前放一个**美元符号**以使其解析转义序列（如`\n)`在字符串中 - 请注意，它不适用于双引号。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-19T08:11:53.123

对于带有 PowerShell的**Windows ：**

```
 hg commit --message "foo`nbar" 
```

# django - 在 Windows XP 上安装 django-1.0.2 的问题

> ID：475972
> 
> 赞同：0
> 
> 时间：2009-01-24T12:42:53.023
> 
> 标签：django, installation

我是 Windows 用户。我试图通过命令提示符安装 django-1.0.2 final，但它一直在第 70 行给我一个错误：

> 错误发生在 u"SVN"... 它无法越过那条线。

怎么做才能安装 django-1.0.2？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T12:49:29.500

您的机器上没有安装[SubVersion](http://subversion.tigris.org/)。您正在尝试通过 SubVersion 从当前生产流同步，这是一个源代码控制系统，您尚未安装。

最简单的解决方案 - 按照[http://www.djangoproject.com/download/的说明下载最新的官方版本](http://www.djangoproject.com/download/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T12:50:12.650

[请为Subversion](http://subversion.tigris.org)版本控制系统安装客户端。由于您使用的是 Windows，因此您还可以使用[TortoiseSVN](http://tortoisesvn.net/)，它是一个易于使用的 Windows SVN 客户端。

[或者，您可以直接](http://www.djangoproject.com/download/1.0.2/tarball/)下载 Django 1.0.2 的压缩包。

并且请不要在互联网论坛上大喊大叫。我们听到你的声音:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T13:22:52.430

如果我没记错的话，安装 TortoiseSVN 对你没有帮助，因为 Django 的代码试图使用 SVN 的**命令行版本**。

安装命令行 SVN，如：

*   [斯利克SVN](http://www.sliksvn.com/en/home/)
*   [CollabNet SVN 命令行](http://www.collab.net/downloads/subversion/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-21T13:13:55.367

你用的是什么版本的python？在 python 3.2 而不是 2.7 上安装时，我遇到了同样的错误。Django 仅适用于 2.7。 [http://docs.djangoproject.com/en/1.2/faq/install/#can-i-use-django-with-python-3](http://docs.djangoproject.com/en/1.2/faq/install/#can-i-use-django-with-python-3)

# c++ - 如何将数字信号从 USB 端口加载到内存中？

> ID：475973
> 
> 赞同：4
> 
> 时间：2009-01-24T12:43:15.957
> 
> 标签：c++, usb, driver

我的朋友正在做一个项目，他需要将一些数字信号输入计算机以显示/处理它们。

所以我建议他将这些信号插入 USB 端口，因为它很受欢迎（因为设备（输出信号）和用于显示和操作的程序都应该为现实世界使用而设计，并且可能在市场上出售）

目标平台主要是 Windows，但如果该软件是跨平台的会更好。我的朋友有 C++ 知识，也不介意学习 C。

他应该从哪里开始，将信号输入内存的步骤是什么？

非常感谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-24T12:51:50.167

这里有一篇很棒的文章：[USB 硬件/软件集成](http://www.codeproject.com/KB/system/HIDAche.aspx "USB硬件/软件集成")，完整地描述了该过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T16:08:52.703

得到一个Labjack或一个[Phidg](http://www.labjack.com/) [​​ets](http://www.phidgets.com/)。（我多次使用前者，而不是后者）它们相当便宜，并且都具有 Java 驱动程序支持等。（如 LabView 驱动程序）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T08:45:55.847

电脑上的端口比较多，很多端口都比USB方便。USB 支持 127 个设备，因此设备必须配合。另一方面，麦克风输入仅用于一个输入。您可以以 8 位/22Khz 或更高的频率对其进行采样，通常您会获得硬件缓冲。您还可以使用现有的驱动程序和简单的 API。

# asp.net - ASP.NET DataGrid 和自定义分页

> ID：475982
> 
> 赞同：3
> 
> 时间：2009-01-24T12:57:52.807
> 
> 标签：asp.net, datagrid, custompaging

我正在尝试在 ASP.NET 中实现 DataGrid，并希望实现自定义分页，这样我就不必一次性提供所有数据。我花了几个小时在互联网上进行研究，但没有发现任何有用的东西。

当我查看页面时，我看到网格中的第一组结果，之前的链接被禁用。但是，当我单击下一步时，我再次看到网格的第一页禁用了上一个链接。在调试代码时，我确定从未调用 MyGrid_PageIndexChanged() 事件处理程序。

我在下面包含了我的简化代码。我更改了变量名称并省略了方法以专注于数据网格分页问题。

在 ASPX 文件中：

```
<asp:DataGrid ID="myGrid" runat="server" GridLines="None" UseAccessibleHeader="true" AutoGenerateColumns="false" AllowPaging="true" AllowCustomPaging="true" PageIndexChanged="MyGrid_PageIndexChanged">
<PagerStyle Mode="NextPrev" NextPageText="Next >" PrevPageText="< Previous" />

<Columns>
<asp:BoundColumn HeaderText="Title" DataField="Name" />
<asp:BoundColumn HeaderText="Date" DataField="Date" />
</Columns>
</asp:DataGrid> 
```

在 CS 文件中：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
                            myGrid.PageSize = 20;
                            myGrid.VirtualItemCount = GetNumItems();
            BindMyGrid();
        }
    }

    protected void MyGrid_PageIndexChanged(object sender, DataGridPageChangedEventArgs e)
    {
        myGrid.CurrentPageIndex = e.NewPageIndex;
        BindMyGrid();
    }

    private int GetNumItems()
    {
        return 500;
    }

    private void BindMyGrid()
    {
            Data[] array = GetDataFromInternetSomehow();
            this.myGrid.DataSource = array;
            this.myGrid.DataBind();
    }

    private class Data
    {
        public string Date { get; set; }
        public string Name { get; set; }
    } 
```

对此的任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T13:24:09.493

您的 ASPX 中有一个错误：要连接 PageIndexChanged 事件处理程序，请使用属性**O​​nPageIndexChanged**（不是您的代码中的**PageIndexChanged ）：**

```
<asp:DataGrid ID="myGrid" runat="server"
   OnPageIndexChanged="MyGrid_PageIndexChanged"  /// <--- here's the error
   ... 
```

然后，如果您有**AllowCustomPaging="true"**，则必须确保 GetDataFromInternetSomehow() 方法将只返回当前选定页面的数据，例如将当前页面传递给该方法并仅返回相应的数据：

```
GetDataFromInternetSomehow(e.NewPageIndex); 
```

否则，禁用自定义分页，它将正常工作（但每次都会加载所有数据）。

# vb.net - Linq 中的表名

> ID：475984
> 
> 赞同：1
> 
> 时间：2009-01-24T13:00:19.183
> 
> 标签：vb.net, linq

我在 Vb.net 中的 Sql 查询是这样的：

```
Dim TableName As String ="City"
Dim Str As String="Select * from "+TableName+"" 
```

我从另一个 Form 获得了 TableName。我们如何在 linq 中做到这一点？我们可以在 Linq 查询中动态使用 TableName 吗？

请帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T13:12:40.233

对不起，我的例子是在 C# 中，但我的 Vb 生锈了。我可以阅读它，但不能很好地从头顶上写下来。

我能想到的最好方法是使用反射和扩展方法而不是 LINQ 语法。

```
 PropertyInfo info = dataContext.GetType().GetProperty( "City" );
 IQueryable table = info.GetValue( dataContext, null ) as IQueryable;

 var query = table.Where( t => t.Column == "Value" )
                  .Select( t => t.OtherColumn ); 
```

我在此示例中假设使用 LINQtoSQL，因此我从数据上下文中获取对象。如果您正在使用其他东西，则需要调整查找对象的方法。

您还可以根据表名的值使用一堆 if-then 语句。如果可能的表的数量是固定的并且很小，这可能会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-18T10:32:56.907

我明白了，谢谢，非常有帮助，但是我无法看到这些属性。

```
 string linqObjectName = "Test";
    PropertyInfo info = db.GetType().GetProperty(linqObjectName);
    IQueryable table = info.GetValue(db, null) as IQueryable;

    PropertyInfo[] properties = table.GetType().GetProperties();

    ltr.Text += "properties: <hr size=1/>";
    foreach (PropertyInfo p in properties)
    {
        ltr.Text += p.Name + "<br />";

    } 
```

这就是结果；

## 特性：

上下文是只读的

编辑：我找到了！

```
PropertyInfo[] properties = 
        table.Where("WebRef = \"" + webref + "\"").ElementType.GetProperties(); 
```

# asp.net - 为动态表单指定 FormPanel.form.load 的根节点

> ID：475986
> 
> 赞同：1
> 
> 时间：2009-01-24T13:00:35.047
> 
> 标签：asp.net, web-services, json, extjs

我正在构建一个基于从 ASP.NET Web 服务加载的 JSON 数据的动态 ExtJS 表单。我发现的问题是 ExtJS 需要特定格式的 JSON，即。

```
{ "metaData": { "title": "Testing" }, "data": [], "success": true } 
```

当使用 ASP.NET Web 服务将对象作为 JSON 返回时，它会返回第一个元素“d”，即。

```
{ "d": { "metaData": { "title": "Testing" }, "data": [], "success": true } } 
```

是否可以告诉 ExtJS 表单使用“d”作为根节点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-25T10:06:31.903

经过更多测试后，我发现 ExtJS 表单确实从我的 Web 服务加载了 JSON，但是因为响应文本在根目录中没有 "success": true 它由 "failed" 处理程序处理。幸运的是，此处理程序接受与“成功”处理程序相同的参数，因此可以进行相同的操作。

这是我的表单加载处理程序的示例：

```
this.form.load({
  url: "myservice.asmx/getUser",
  headers: {'Content-Type': 'application/json'},
  success: function(form, action) {
    //not fired
  },
  failure: function(form, action){
    if (action.result.d){
      //process data
    }
  }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T15:55:12.587

当然，您不必调用 form.load() 。我绕过它，直接通过调用 ScriptManager 提供的链接到我的 web 方法的 AJAX 函数来调用我的 ASMX web 方法。MS AJAX 完成所有 JSON 解码，并排除 'd' 属性等。

您的 Web 方法甚至不必按照 form.load() 的要求返回带有“成功”和“数据”对象的对象，尽管它是一种有用的格式并且我坚持使用它。

通过 web 方法返回的“数据”对象（使用名称/值对，其中名称 == 字段名称），您现在可以调用 ExtJs 的 form.setValues(data); 将值写入字段。

这是绕过 ExtJS 代码的一个完全有效的案例。

--

与加载一样，提交也是如此。要解决必须由提交 Web 方法返回的对象中的“d”属性问题，请处理提交按钮的单击事件，并通过直接调用您的 Web 方法将数据推送到服务器。您的 web 方法可以/应该返回与 ExtJs 所需格式相同的对象。但是你取回了这个对象，如果不成功，你自己调用 form.markInvalid() ，传入'errors'属性。Peasy很容易，效果很好。

同样，由于 ExtJs 不能很好地使用 'd' 属性，因此绕过它并自己做事是完全有效的。

--

我越来越倾向于使用 ScriptManager 提供的函数来调用我的 web 方法，并绕过 ExtJs 的 AJAX 方法调用代码。前者更易于使用，了解“d”属性，还知道如何反序列化 Microsoft 的 JSON 格式以用于序列化的 DateTime 对象。

# html - 即时渲染标记或存储 html？

> ID：475987
> 
> 赞同：2
> 
> 时间：2009-01-24T13:00:38.137
> 
> 标签：html, wiki, markdown

在处理用户输入的标记（例如 wiki 或 markdown）时对您有用的任何建议。我有 CPU 和数据库空间成本，所以我不确定该走哪条路。

1.  将标记存储在数据库中并为每个页面浏览呈现到服务器上的 html。（更少的数据库空间，但更多的 CPU 使用率）

2.  将标记存储在数据库中并使用 javascript 在客户端上呈现为 html。（可能更难实现）

3.  仅将呈现的 html 存储在数据库中并在需要编辑时转换回标记。（同样，实施起来可能很棘手）。

4.  将 html 和标记都存储在数据库中。（数据库空间翻倍）。

5.  别的东西。

（我正在使用 MFC 和 Linqtosql）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-24T13:05:30.497

我会将它作为 Wiki 标记存储在数据库中，然后将转换后的 HTML 输出保存在内存中的网络服务器缓存中。无论您使用哪种网络技术，都应该支持这一点 - 以 url、id 或类似名称为键的基本元组（哈希表）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T13:07:34.940

我会即时存储标记并渲染 html 服务器端。您可以使用服务器端缓存来减少您执行的实际计算量，并且您可以保留具有合理语义的表示，并且可以在需要时呈现为 text/html/pdf。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T13:07:50.260

最简单的方法是在缓存中存储标记并按需渲染 HTML（可能在磁盘上或在 memcached onjects 中），并带有渲染的时间戳。这样，您可以检查是否需要再次渲染，因为标记已更改，或者只是提供缓存的 HTML。这是大多数 Ruby on Rails 应用程序/CMS 的工作方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T13:10:36.057

我会将它作为 RST 标记存储在数据库中，并根据需要转换为 HTML。由于您可能正在使用前端（例如 JSP、PHP、Django 或其他呈现模板语言的东西），因此对 RST 的额外处理不会引入太多开销。

在决定实施复杂的缓存机制之前，实际测量将标记呈现为 HTML 的实际开销。

“（更少的数据库空间，但更多的 CPU 使用）”不是一个衡量的事实，它是一个假设，结果可能不是真的。

# c# - 枚举转换的性能

> ID：475988
> 
> 赞同：1
> 
> 时间：2009-01-24T13:01:22.020
> 
> 标签：c#, performance, enums

经过一点速度跟踪后，我发现了一段代码（经常调用），它将一个枚举的值转换为另一个枚举的值，如下所示：

```
public Enum2 ConvertToEnum2(Enum1 enum1)
{
   switch(enum1)
   {
      case Enum1.One:
         return Enum2.One;
         break;
      case Enum1.Two:
         return Enum2.Two;
         break;
   }
} 
```

如果我将这些转换保存在字典中并执行以下操作，我会不会更高效：

```
public Enum2 ConvertToEnum2(Enum1 enum1)
{
   return m_ConversionTable[enum1];
} 
```

感谢您的意见！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-24T13:05:07.910

字典肯定不会更快。

如果 Enum1 中的枚举是连续的，那么 Enum2 的数组可能会更快（但这可能是边际的）。如果 Enum1 接近顺序，因此阵列不会太多余，它可能仍然是有用的方法。

对于具有 [Flags] 属性的枚举，那么开关可能是最好的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T14:02:13.677

你确定这是一个瓶颈？我发现许多分析器报告小方法的时间百分比不正确。
在我的计算机中，我可以使用一个开关在 1.7 秒内在具有 10 个元素的枚举之间执行 100 万次转换（安东尼的答案是快 10 倍）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T14:22:46.177

这可能取决于您的枚举。对于小型枚举，我希望 switch 可能是最快的方法，而对于非常大的枚举，字典查找可能会更快。

要获得明确的答案，您必须使用枚举对其进行测量。

# php - PHP 参考

> ID：475990
> 
> 赞同：3
> 
> 时间：2009-01-24T13:02:17.993
> 
> 标签：php, reference

有人可以解释一下“&”在下面的作用：

```
class TEST {

}

$abc =& new TEST(); 
```

我知道这是通过参考。但是有人可以说明为什么以及何时需要这样的东西吗？或者指向我一个很好解释的网址。我无法理解这个概念。

非常感谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-24T13:34:01.673

据我了解，您不是在问一般的 PHP 参考，而是在问`$foo =& new Bar();`构造成语。

这仅在 PHP4 中可见，因为通常`$foo = new Bar()`存储对象的*副本*。除非类在构造函数中存储了对 $this 的引用，否则这通常不会被注意到。稍后在返回的对象上调用方法时，将存在该对象的两个不同副本，而意图可能只有一个。

考虑这段代码，其中构造函数在全局变量中存储了对 $this 的引用

```
class Bar {
    function Bar(){
       $GLOBALS['copy']=&$this;
        $this->str="hello";
    }

}

//store copy of constructed object
$x=new Bar;
$x->str="goodbye";

echo $copy->str."\n"; //hello
echo $x->str."\n"; //goodbye

//store reference to constructed object
$x=&new Bar;
$x->str="au revoir";

echo $copy->str."\n"; //au revoir
echo $x->str."\n"; //au revoir 
```

在第一个例子中，$x 和 $copy 指的是不同的 Foo 实例，但在第二个例子中它们是相同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T13:09:57.057

首先，如果您使用的是 PHP 5，则实际上不需要使用它，在 PHP 5 中，默认情况下所有对象都是通过引用传递的。

其次，当您通过创建、传入参数或设置变量值将对象分配给变量名时，您要么通过引用要么通过值来执行此操作。

通过引用传递意味着您传递对象的实际内存引用，因此假设您将对象作为参数传递给函数，该函数对该变量所做的任何更改也将反映在父方法中，您实际上是在更改该对象在内存中的状态。

另一种方法，按值传递意味着您传递该对象的副本，而不是内存引用，因此您所做的任何更改都不会反映在原始对象中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T13:22:25.177

[PHP 手册](http://www.php.net/manual/en/language.references.php)在解释参考方面做得相当不错。

我应该注意，它们与许多其他语言中的指针或引用不同，尽管有相似之处**。**至于默认情况下“通过引用传递”的对象 - 这也不完全正确。

我建议先阅读手册部分（然后可能会重新阅读几次，直到你明白为止），如果你还有更多问题，然后再回到这里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T13:25:33.047

一种更简单的查看方式可能是这样的：

```
$a = 'foo';
$b = 'bar';
$a =& $b;
$b = 'foobar';
echo $a . ' ' . $b; 
```

将输出

```
foobar foobar 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T13:51:09.907

这样想可能会有所帮助：在 PHP 中，所有变量实际上都是某种指针：符号表中的条目——将变量名映射到值的东西——`zval *`在 Zend 引擎的 C 实现中包含 a。

在赋值期间——这包括设置函数参数——魔法会发生：

如果这样做`$a = $b`，将创建一个由符号表条目指向的值的副本，并将`$b`指向该新值的指针放置在 的符号表条目中`$a`。现在，`$a`and`$b`将指向不同的值。PHP 使用它作为它的默认调用约定。

如果你这样做`$a =& $b`，符号表条目`$a`将被设置为包含在符号表条目中的指针`$b`。这意味着`$a`和`$b`现在指向相同的值——它们是彼此具有同等权利的别名，直到它们被程序员重新绑定。另请注意，这`$a`并不是真正的引用*——* `$b`它们都是指向同一个对象的指针。

这就是为什么称它们为“别名”可能是一个好主意，以强调与 C++ 参考实现的差异：

在 C++ 中，包含值的变量和从该变量创建的引用是不相等的——这就是为什么会有像悬空引用这样的东西的原因。

需要明确的是：在 PHP 中没有像引用类型这样的东西，因为所有变量都已经在内部实现为指针，因此它们中的每一个都可以*充当*引用。

PHP5 对象仍然与此描述一致——它们*不是*通过引用传递，而是*指向对象*的指针（手册称它为“对象标识符”——它可能不会被实现为实际的 C 指针——我没有检查这个）*按值*传递（意思是在分配时复制，如上所述）。

[有关 PHP5 对象和引用之间关系](http://www.php.net/manual/en/language.oop5.references.php)的详细信息，请查看手册。*************