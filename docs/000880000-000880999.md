# StackOverflow 问答 000880000-000880999

# c# - c#中的页面加载

> ID：880003
> 
> 赞同：2
> 
> 时间：2009-05-18T21:48:15.003
> 
> 标签：c#, asp.net

这是我写的一段代码。我遇到的问题是：当我单击gridview“rowcommand”中的按钮时，将项目添加到工作正常的arraylist。用户单击按钮后，页面再次加载并再次转到“rowcommand”！结果，相同的值被添加到数组列表中。

这是关于回发的事情吗？如果是我认为我理解得不够清楚！这里似乎有什么问题？

//编辑2：整个代码块

```
public partial class Action_k : System.Web.UI.Page
{
    ArrayList array;
    ArrayList tmpArrayList = new ArrayList();
    string itemIDs = string.Empty;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (IsPostBack == false)
        {
            if (Session["username"] == null)
            {
                Session["anonuser"] = "anon";

                Label1.Text = "";
                userLabel.Text = "";
                ImageButton1.ImageUrl = "~/images/logink.gif";
                ImageButton1.PostBackUrl = "~/Login_k.aspx";
            }
            else
            {
                userLabel.Text = Session["username"].ToString();
                Label1.Text = "Your logged in as: ";
                ImageButton1.ImageUrl = "~/images/logoutk.gif";
            }

            if (Session["array"] == null)
            {
                array = new ArrayList();
                Session.Add("array", array);
            }

        }
        array = Session["array"] as ArrayList;
    }

    public void GridView2_RowCommand(object sender, GridViewCommandEventArgs e)
    {

        if (e.CommandName == "AddToCart")
        {
            int index = Convert.ToInt32(e.CommandArgument);
            string items = GridView2.DataKeys[index].Value.ToString();
            array.Add(items);
            Response.Redirect("ShoppingCart_k.aspx?itemID=" + items);
        }

    }
} 
```

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T22:14:14.717

它正在做它应该做的事情。首先处理您的页面加载事件，然后处理您的行命令事件。

你看到的是两个事件一个接一个地被处理。

还可以查看 Callbacks 与 Postbacks。

就像 Joel 说的，回传会使你的页面失效并重建。回调使用 Javascript/AJAX __doPostBack() 并且不会使整个页面无效，只是您的回调组件或容器。虽然仍会调用页面加载事件，但您可以测试 IsCallback 属性。

此链接可能会有所帮助... [http://msdn.microsoft.com/en-us/library/ms178141.aspx](http://msdn.microsoft.com/en-us/library/ms178141.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T17:31:06.603

好吧，我找到了答案，而且很简单。当 ButtonType="Button" 时，这似乎是一个问题。

该问题可以通过将 ButtonType 更改为“Link”来解决。

以防万一，如果您对此感兴趣，这是帮助我的链接。

```
http://forums.asp.net/p/1002747/1324414.aspx#1324414 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T21:55:37.533

> 用户单击按钮后，页面再次加载并再次转到“rowcommand”！

我没有看到问题。用户单击了按钮，因此它处理了事件。你期望它做什么？

请记住，每个回帖（以及所有事件都会强制回帖）意味着运行整个页面生命周期，包括您的页面加载事件，以及可能触发回帖的任何事件。此外，您正在为每个回帖使用您的班级的新实例。

* * *

所以在第一个按钮单击时，您期望页面被重定向并最终到达其他地方？

# c# - “System.Reflection.ParameterInfo”类型的对象无法转换为“System.Int32”类型

> ID：880004
> 
> 赞同：0
> 
> 时间：2009-05-18T21:48:54.317
> 
> 标签：c#, oop

我正在尝试为将对象结构转储到调试输出的对象编写扩展方法。当 propertyInfo 被索引（GetIndexParameters().Length >0）时，我遇到了一个问题。

我尝试过使用以下内容：

```
object value = propInfo.GetValue(myObject, propInfo.GetIndexParameteres()); 
```

这会导致以下运行时错误：

*   “System.Reflection.ParameterInfo”类型的对象无法转换为“System.Int32”类型

有人有什么想法吗？该方法的完整代码如下：

```
[System.Diagnostics.Conditional("DEBUG")]
public static void DebugObject(this object debugObject)
{
    System.Diagnostics.Debug.WriteLine("Debugging object: " + debugObject.GetType().Namespace);
    System.Diagnostics.Debug.WriteLine(String.Format("> {0}", debugObject.GetType()));
    System.Diagnostics.Debug.Indent();
    try
    {
        if (debugObject.GetType().IsArray)
        {
            object[] array = ((object[])debugObject);

            for (int index = 0; index < array.Length; index++)
            {
                System.Diagnostics.Debug.WriteLine(String.Format("- {{0}} = [{1}]", index, array[index]));
            }
            return;
        }

        object value = null;
        foreach (System.Reflection.PropertyInfo propInfo in debugObject.GetType().GetProperties())
        {
            try
            {
                if (propInfo.IsIndexed())
                {
                    System.Diagnostics.Debug.WriteLine(propInfo.ReflectedType.IsArray + " is indexed");
                    // THIS IS WHERE IT CHOKES.  As an example, try sending in something of type System.Net.Mail.MailMessage;
                    value = propInfo.GetValue(debugObject, propInfo.GetIndexParameters());
                }
                else
                {
                    value = propInfo.GetValue(debugObject, null);
                }

                if (value != null)
                {
                    System.Diagnostics.Debug.WriteLine(String.Format("> {0} = [{1}]", propInfo.Name, value));

                    if (
                            (value.GetType() != typeof(string))
                            &&
                            (value.GetType() != typeof(int))
                        )
                    {
                        value.DebugObject();
                    }
                }
            }
            catch (System.Reflection.TargetParameterCountException tpce)
            {
                System.Diagnostics.Debug.WriteLine(
                    String.Format(
                        "> Could not run GetValue for {1} (type '{0}', '{2}') because of incorrect prarmeters", 
                        propInfo.GetType().ToString(),
                        propInfo.Name,
                        propInfo.PropertyType.Namespace
                        )
                    );
            }
        }
    }
    finally
    {
        System.Diagnostics.Debug.Unindent();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T22:07:17.227

转储索引器属性是个坏主意。它类似于“转储方法”。这是不可能的。

在尝试获取价值之前，还可以考虑使用 PropertyInfo.CanRead。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T21:55:52.413

您实际上是在尝试访问 SomeProp[foo, bar...]... 所以；什么是合理的指数值？对于整数，也许 0,0,0... 是安全的——也许不是。这取决于上下文。就个人而言，我不确定这是最好的方法。我可能会查看`IList`主要对象，但除此之外 - 只需查看常规属性...

# linq - 实体框架 - “全部”方法

> ID：880011
> 
> 赞同：8
> 
> 时间：2009-05-18T21:52:43.450
> 
> 标签：linq, entity-framework, linq-to-entities

**All**方法应该针对列表中的所有元素评估参数。它在常规 Linq 中工作正常，但是当我尝试将它与 EF 一起使用时，它会引发错误（“*无法创建类型为 'Closure type' 的常量值。仅支持原始类型（例如 Int32、String 和 Guid）上下文。* ”）

例子：

```
var myList = from person in entities.People
             where searchList.All(arg => arg == arg).ToList(); 
```

*（arg == arg 这里只是为了说明我的问题）*

在我的场景中，searchList 是一个包含搜索项的列表，例如“John”、“Accounting”、“75”。在我的 EF 查询中，我想检索人中 John、Accounting 和 75 出现在某些指定的可搜索字段中的所有记录。一个更现实的例子是这样的：

```
where SearchList.All((person.FirstName + " " + person.LastName + " " + person.DepartmentName + " " + person.Phone).Contains) 
```

第二个示例在内存中也适用于 Linq，但 EF 不喜欢它。

请帮忙！我该怎么做才能让它发挥作用？

这是一个更具体的问题，来自我的[另一个问题](https://stackoverflow.com/questions/879411/entity-framework-unable-to-create-a-constant-value-of-type-closure-type-er)。

## 示例代码：

```
IEnumerable<string> searchList = ParseSearchText(searchText); //search text is broken into search tokens - each token is an element in searchList. For instance "John", "Sales", "654"

var peopleQuery = from person in entities.vSearchPeople
where upperSearchList.All((person.FirstName + " " + person.Lastname + " " + person.Phone).ToUpperInvariant().Contains)
select person; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-18T22:23:46.103

实体框架不支持所有查询。如果您想到以下内容，这将变得很明显

```
dataContext.Persons.Where(person => MyMethod(person)); 
```

返回`MyMethod()`一个布尔值。该方法可能会做所有事情，但您无法将所有内容都转换为 SQL。解决方案是使用 LINQ to Object 将所有实体放入本地内存`ToList()`，然后使用。

```
dataContext.Persons.ToList().Where(person => MyMethod(person)); 
```

它是否可以重写取决于您的实际查询，以便它可以通过实体框架转换为 SQL，或者您是否必须使用 LINQ to Object 在本地内存中进行查询。

您提到的异常听起来像是您正在尝试以下内容。

```
Company company = datacontext.Companies.Where(company.Name == "ACME").Single();

dataContext.Employees.Where(employee => employee.Company == company); 
```

LINQ to Entity 不支持包含实体的表达式，因此实体的比较`Company`无效。在这种情况下，您可以按如下方式重写它。

```
dataContext.Employees.Where(employee => employee.Company.Id == company.Id); 
```

这仅比较 id - 一个原始类型，如整数或 GUID - 这可以转换为 SQL。

**逐字搜索示例（另见评论）**

```
IQueryable<People> result = entities.People;

foreach (String item in searchList)
{
    // This copy is important in order not to modify the closure.
    String itemCopy = item;

    result = result.Where(p =>
        p.FirstName.ToUpper().Contains(itemCopy) ||
        p.LastName.ToUpper().Contains(itemCopy) ||
        p.Phone.ToUpper().Contains(itemCopy));
} 
```

这将逐字构造查询。注意到实体框架可以识别`ToUpper()`、`ToLower()`和`Contains()`（以及更多）——所以当我说实体框架不识别方法调用时，我很严格。确实如此，但不是很多，也不是`ToUpperInvariant()`and `ToLowerInvariant()`。此外，此查询使用列的排序规则转换为`CHARINDEX()`函数调用，因此搜索可以不区分大小写而无需显式`ToUpper()`或`ToLower()`调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-15T12:12:58.423

这个很好的例子在 All() 方法中有什么好处。

```
model.ReferenceList = db.JournalCardReference.OrderBy(a => a.orderF)
 .Include(x => x.JournalCardField)
  .Where(x => x.JournalCardField
    .All(f => f.deleted == null || f.deleted != true)).ToList(); 
```

# stack - 有人可以解释这几行 MSIL 吗？

> ID：880021
> 
> 赞同：5
> 
> 时间：2009-05-18T21:56:32.833
> 
> 标签：stack, branch, cil, local-variables, typechecking

有人可以解释这几行 MSIL 吗？为什么它将评估堆栈中的值移到局部变量中，只是立即将其移回并返回？

以下 MSIL 代码加载单个参数（字符串），调用返回 bool 的方法，然后返回该 bool 值。我不明白为什么它调用 stloc.0 将方法的返回值存储在局部变量中，然后执行显式无条件控制转移到下一个标记行（似乎没有必要），只是将值移回返回之前的评估堆栈。

```
.maxstack 1
.locals init ([0] bool CS$1$0000)
L_0000: nop
L_0001: ldarg.0
L_0002: call bool FuncNameNotImporant::MethodNameNotImporant(string)
L_0007: stloc.0 
L_0008: br.s L_000a
L_000a: ldloc.0 
L_000b: ret 
```

我对它为什么这样做的最佳猜测是执行某种类型检查以确保评估堆栈上的值在返回之前实际上是一个布尔值。但是我对明确跳转到下一行一无所知；我的意思是，它不会去那里吗？该方法的 C# 源代码只有一行，它返回该方法的结果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-19T23:16:32.827

如果您在调试器中打开此函数，并在调试模式下编译代码：

```
bool foo(string arg)
{
    return bar(arg);
} 
```

您可以设置 3 个断点：

1.  在函数的左大括号处。
2.  在“返回”线上。
3.  在函数的右大括号处。

在左大括号上设置断点意味着“在调用此函数时中断”。这就是为什么在方法的开头有一个无操作指令的原因。当断点设置在左大括号上时，调试器实际上将它设置为空操作。

在右大括号上设置断点意味着“此函数退出时中断”。为了实现这一点，函数需要在它的 IL 中有一个返回指令，可以在其中设置断点。编译器通过使用临时变量来存储返回值并转换

```
return retVal; 
```

进入

```
$retTmp = retVal;
goto exit; 
```

然后在方法的底部注入以下代码：

```
exit:
return $ret; 
```

此外，在调试模式下，编译器对他们生成的代码很愚蠢。他们基本上会做类似的事情：

```
GenerateProlog();
foreach (var statement in statements)
{
    Generate(statement);
}
GenerateEpilog(); 
```

在您的情况下，您会看到：

```
return foo(arg); 
```

被翻译成：

```
; //this is a no-op
bool retTemp = false;
retTemp = foo(arg);
goto exit;
exit:
return retTemp; 
```

如果编译器正在执行“滑动窗口优化”，它可能会查看该代码并意识到存在一些冗余。但是，编译器通常不会在调试模式下执行此操作。编译器优化可以做诸如消除变量和重新排序指令之类的事情，这使得调试变得困难。由于调试构建的目的是启用调试，因此打开优化并不好。

在发布版本中，代码不会像那样。那是因为编译器没有引入特殊代码来启用左大括号和右大括号上的断点，只留下以下代码进行编译：

```
return bar(arg); 
```

最终看起来很简单。

然而，需要注意的一件事是，我认为 C# 编译器不会对滑动窗口进行太多优化，即使在零售版本中也是如此。那是因为大多数优化依赖于底层处理器架构，因此由 JIT 编译器完成。在 C# 编译器中进行优化，即使是与处理器无关的优化，也会阻碍 JIT 优化代码的能力（它正在寻找由非优化代码生成生成的模式，如果它看到高度优化的 IL，它可以获得使困惑）。所以通常托管代码编译器不会这样做。它做了一些“昂贵的事情”（JIT 不想在运行时做），比如死代码检测和实时变量分析，但它们并没有解决滑动窗口优化解决的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T22:35:18.420

你是在调试还是发布模式下编译？在发布模式下，我得到：

```
.method private hidebysig static bool Test1(string arg) cil managed
{
    .maxstack 8
    L_0000: ldarg.0 
    L_0001: call bool FuncNameNotImportant::MethodNameNotImportant(string)
    L_0006: ret 
} 
```

您看到的分支可能是用于调试器支持。

# asp.net - 是否可以使用 SqlCommand 将数据更新/插入数据集中？

> ID：880030
> 
> 赞同：1
> 
> 时间：2009-05-18T21:58:39.740
> 
> 标签：asp.net, sql, dataset

我使用此代码更新数据库表中的数据。可以重复使用相同的代码来更新数据集吗？谢谢。

```
 using (SqlConnection cn =  new SqlConnection(ConfigurationManager.ConnectionStrings["Northwind"].ConnectionString))
        {
            string sql = "UPDATE tbh_Categories SET Title = @Title, 
                           Description = @Description 
                           WHERE CategoryID = @CategoryID";
            SqlCommand cmd = new SqlCommand(sql, cn);
            cmd.CommandType = CommandType.Text;
            cmd.Parameters.Add("@CategoryID", SqlDbType.Int).Value = category.ID;
            cmd.Parameters.Add("@Title", SqlDbType.NVarChar).Value = category.Title;
            cmd.Parameters.Add("@Description", SqlDbType.NVarChar).Value = category.Description;

            cn.Open();
            int ret = cmd.ExecuteNonQuery();

            return (ret == 1);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T22:01:07.803

完全相同的代码？不。SqlConnection（和 SqlCommand）是特定于 SqlServer 的。DataSet 存在于该上下文之外，因此您必须重写代码以适应更新 DataSet。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T22:03:00.670

不，我不这么认为。循环遍历您的行`DataTable`，或更新数据库并重新加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T22:11:09.420

答案是不。但是，您可以使用[DataTable.Select](http://msdn.microsoft.com/en-us/library/system.data.datatable.select.aspx)来标识 DataTable 中要更新的行。但是随后您将不得不“手动”修改实际表本身。

我必须问您要做什么……例如，您是否正在尝试使用可更新的数据集缓存某些数据？或者您是否试图避免额外的数据库访问？如果您让我们知道，可能会有更好的方法来做您想做的事情。如果你想要一个内存数据库，那里[有很多](http://en.wikipedia.org/wiki/In-memory_database)。

每条评论：查看[SQLite](http://www.sqlite.org/)。有[.NET Wrappers](http://jclement.ca/devel/dotnet/sqlite.html)可以让你做你想做的事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T00:00:50.417

您必须稍微更改您的代码。您应该使用[SqlDataAdapter](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldataadapter.aspx)的实例并使用它的[Update](http://msdn.microsoft.com/en-us/library/at8a576f.aspx)方法。来自 MSDN的一个小[代码示例：](http://msdn.microsoft.com/en-us/library/z1z2bkx2.aspx)

```
public DataSet CreateCmdsAndUpdate(string connectionString,
    string queryString) 
{
    using (OleDbConnection connection = new OleDbConnection(connectionString))
    {
        OleDbDataAdapter adapter = new OleDbDataAdapter();
        adapter.SelectCommand = new OleDbCommand(queryString, connection);
        OleDbCommandBuilder builder = new OleDbCommandBuilder(adapter);

        connection.Open();

        DataSet customers = new DataSet();
        adapter.Fill(customers);

        //code to modify data in dataset here

        adapter.Update(customers);

        return customers;
    }
} 
```

# javascript - Dijit DateTextBox 上的限制 [一周中的有效日期]

> ID：880036
> 
> 赞同：2
> 
> 时间：2009-05-18T22:00:32.187
> 
> 标签：javascript, constraints, widget, dojo

关于 Dijit.Form.DateTextBox 的快速问题

[http://docs.dojocampus.org/dijit/form/DateTextBox](http://docs.dojocampus.org/dijit/form/DateTextBox)

此页面包含以下内容：“还针对开发人员提供的约束进行验证，例如最小值、最大值、一周中的有效日期等。”

我似乎找不到允许我对一周中的日子进行限制的文档。例如，我需要一个 DateTextBox，它只允许用户选择发生在星期日的日期。

我很感激这方面的任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T05:53:19.820

我为此仔细研究了源代码，我认为该手册可能会误导你一点——没有办法使用对象的约束来做到这一点。他们用户论坛的以下引用似乎支持了我的发现：

> DateTextBox 目前不允许您自定义 isDisabledDate。它只允许您设置最小值/最大值。您可能必须修补或继承 DateTextBox 以提供您自己的 isDisabledDate 实现并在验证期间进行检查。

[您可以在http://dojotoolkit.org/forum/dijit-dijit-0-9/dijit-support/datetextbox-mondays-only-selectable#comment-19508](http://dojotoolkit.org/forum/dijit-dijit-0-9/dijit-support/datetextbox-mondays-only-selectable#comment-19508)看到 DateTextBox 这样一个子类的示例。

如果这对您来说工作量太大，DateTextBox 确实源自 dijit.form.ValidationTextBox，因此我们可以使用此小部件的 regExpGen 创建验证器 - 它不会阻止我们选择无效日期，但会导致 dijit 标记小部件无效并给用户一个“输入的值无效”。

```
dijit.byId('toDate').regExpGen = function() {
  if (dojo.date.locale.format(this.value, {datePattern: "E", selector: "date"}) == 6)
    返回 ”。*”;
  返回“0”；
}

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T23:38:32.583

碰巧的是，a 内部对象上的`isDisabledDate`函数只是调用自身。因此，出于您的目的，这将起作用：`Calendar``DateTextBox``rangeCheck``DateTextBox`

```
dijit.byId('toDate').rangeCheck = function(date,constraints) {
  var day=date.getDay();
  return day===0;
} 
```

如果您还想要最小/最大的东西，则必须重新添加约束逻辑，但这解决了上述问题，而且很短。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-03T17:54:33.780

我希望尽快实现的功能

[http://bugs.dojotoolkit.org/ticket/4765](http://bugs.dojotoolkit.org/ticket/4765)

# hibernate - 手动初始化所 需的 Hibernate 数据库表

> ID：880047
> 
> 赞同：2
> 
> 时间：2009-05-18T22:02:03.900
> 
> 标签：hibernate, initialization, hbm2ddl

我开始使用 Hibernate，到目前为止还不算太难。但我对 hbm2ddl.auto 属性感到困惑。有没有办法手动执行初始化数据库表的任何操作？我只想在更改数据库后执行此操作，而不是每次运行程序时执行此操作。

**编辑：**在运行时呢？我的 Java 程序中有没有办法以编程方式重新初始化数据库表？[org.hibernate.tool.hbm2ddl.SchemaUpdate](https://www.hibernate.org/hib_docs/v3/api/org/hibernate/tool/hbm2ddl/SchemaUpdate.html)看起来可能是正确的野兽，但我不确定它到底做了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T22:05:31.193

我将使用 HBM2DDL 生成数据库，然后使用数据库上存在的任何复制/备份来保存数据库模式，并在需要时使用该脚本重新创建数据库；仅在对象模型更改时运行 HBM2DDL 以生成数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T22:04:19.887

使用休眠蚂蚁任务：[https ://www.hibernate.org/381.html](https://www.hibernate.org/381.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T16:12:49.357

好的，感谢所有线索！以下工作：

```
public class HibernateUtil {
...

  public static SessionFactory createSessionFactory(Properties p)
  {
    try {
        // Create the SessionFactory from hibernate.cfg.xml
        Configuration cfg = new AnnotationConfiguration().configure();
        if (p != null)
            cfg.addProperties(p);
        return cfg.buildSessionFactory();
    } catch (Throwable ex) {
        // Make sure you log the exception, as it might be swallowed
        System.err.println("Initial SessionFactory creation failed." + ex);
        throw new ExceptionInInitializerError(ex);
    }
  }
} 
```

然后在我的应用程序代码中：

```
private void init() {
    Properties p = new Properties();
    p.setProperty("hibernate.hbm2ddl.auto", "create");
    Session session = HibernateUtil.createSessionFactory(p)
        .getCurrentSession();
    session.beginTransaction();
    session.getTransaction().commit();
    session.getSessionFactory().close();
    System.out.println("should be initialized....");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T22:07:30.427

使用此属性集，您可以为数据库生成创建/更新脚本并执行它们。这是一个很好的原型设计工具，但一段时间后我会建议转向另一种数据库更新策略。

# msbuild - 如何在 ms 发布事件宏中获取公共令牌

> ID：880054
> 
> 赞同：0
> 
> 时间：2009-05-18T22:05:15.920
> 
> 标签：msbuild

我想创建一个构建后脚本，将生成的 pdb 复制到 gac 文件夹中，如下所示： 复制 $(TargetDir)$(TargetName).pdb C:\Windows\assembly\GAC_MSIL\$(TargetName)\?Public Token? 但我需要当前构建项目的公共令牌，有没有办法得到这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T23:56:13.873

根据您的问题，我认为您正在寻找可以从 Visual Studio 快速添加到构建后事件的内容。如果使用`XCOPY`，则可以在目标路径中指定通配符。这对您来说可能就足够了：

```
XCOPY "$(TargetDir)$(TargetName).pdb" "%WINDIR%\Assembly\GAC_MSIL\$(TargetName)\*\" 
```

`SN.exe`另一种选择是尝试使用框架提供的公钥令牌来提取。这可能看起来像：

```
FOR /F "usebackq tokens=5" %%T in (`sn.exe -q -T "$(TargetDir)$(TargetName).dll"`) DO COPY ""$(TargetDir)$(TargetName).pdb" "%WINDIR%\Assembly\GAC_MSIL\$(TargetName)\%%T\" 
```

但实际上，目标目录不包括程序集版本以及公钥令牌吗？

最后，您始终可以下载[MSBuildExtensions](http://msbuildextensionpack.codeplex.com/)库，其中包含一个`Assembly`任务（或自己实现一个自定义任务）。但是，在这种情况下，您需要手动编辑 proj 文件。

此外，请查看此[博客条目](http://www.elumenotion.com/Blog/Lists/Posts/Post.aspx?ID=23)- 您可能会对它感兴趣。

# java - 泛型混淆

> ID：880056
> 
> 赞同：1
> 
> 时间：2009-05-18T22:05:23.473
> 
> 标签：java, generics, collections, polymorphism

以下是来自 Kathy & Bert Bates SCJP 5 准备 CD 的问题。我也在其他地方发布了这个，但直到现在还没有得到令人满意的解释......请帮助我理解这一点：

```
public class BackLister {  
  //Insert code here
  {
    List<T> output=new LinkedList<T>();  
    for(T t:input)  
      output.add(0,t); 
    return output;  
  }  
} 
```

以下哪项可以插入`//Insert code here`？

*   **一个**。`public static <T> List<T> backwards(List<T> input)`
*   **乙**。`public static <T> List<T> backwards(List<? extends T> input)`
*   **C.** _`public static <T> List<T> backwards(List<? super T> input)`
*   **D.** _`public static <T> List<? extends T> backwards(List<T> input)`
*   **E。** _`public static <T> List<? super T> backwards(List<T> input)`
*   **F。** _`public static <? extends T> List<T> backwards(List<T> input)`

我理解 A 和 B 是正确的；但是，不是为什么 D 和 E 也是正确的。我可以看到 C 和 F 也不正确。谁能告诉我为什么D和E是正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T22:19:23.897

答案 D, `public static <T> List <? extends T> backwards(List <T> input)`, 返回一个可以包含类型`T`或其任何子类的列表。由于它可以容纳`T`，它可以容纳输入中的任何元素，并且在这个意义上是“正确的”。

答案 E, `public static <T> List <? super T> backwards(List <T> input)`, 类似，但返回一个可以容纳`T`或任何超类的列表。由于它还可以保存输入元素，因此它也是“正确的”。

选择这些备选方案之一将影响用户可能期望对结果列表执行的操作。

*   通过`List<? extends T>`输出，可以遍历列表并将每个元素分配给 type 的变量`T`，但没有任何元素，即使是 type `T`，也可以安全地添加到`List`. （有人可能会将此列表称为，并且在尝试将 检索为 时`List<SubT>`会得到a 。）`ClassCastException``T``SubT`

*   通过`List<? super T>`输出，可以安全地将元素添加到`List`if 它们的类型为`T`。但是，列表中的元素只能安全地分配给类型为 的变量`Object`。（有人可能将此列表称为`List<Object>`，并添加 的实例`Object`或其他超类`T`）。

*   使用`List<T>`，可以安全地将列表的元素分配给 type 的变量`T`，并且可以将 type 的元素添加`T`到列表中（假设它是可修改的`List`实现）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T22:18:34.740

因为根据定义， a`List<T>`是 a`List<? extends T>`和 a `List<? super T>`。
`? extends T`是通配符指示`T`或子类型，并且`? super T`是通配符指示`T`或超类型。因此，返回 a`List<T>`将满足两种返回类型。

选择返回其中一个是有原因的，但这里的重点是它们是合法的。

# nhibernate - FirstOrDefault() 打破 FetchType=join 与 Linq 到 NHibernate

> ID：880061
> 
> 赞同：2
> 
> 时间：2009-05-18T22:06:16.917
> 
> 标签：nhibernate, linq-to-nhibernate

如果我做

```
Session.Linq<MyClass>().Where(x => x.Id = someId).FirstOrDefault(); 
```

其中`MyClass`有一组急切加载的子对象，似乎通过向SQL`FirstOrDefault()`添加 a 来阻止它工作。`TOP 1`

这只是 Linq2NH 中的一个错误（功能？）（我知道正在重写）还是我错过了什么？

是否有一个可以正常工作的首选替代方案？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T22:15:52.810

看起来像一个错误，在我看来，FirstOrDefault 是一个定义良好的 Linq 运算符，它与急切/延迟加载无关，所以它不应该破坏它。

我想有很多这样的细微差别，这导致库没有准备好生产。我建议将错误提交给开发人员。

在这种情况下，回退到 DetachedCriteria（或 HQL）是我认为的唯一选择。

# regex - 编写一个正则表达式来匹配 img 标签的 src、height 和 width 属性

> ID：880062
> 
> 赞同：1
> 
> 时间：2009-05-18T22:06:46.603
> 
> 标签：regex

我正在尝试编写一个正则表达式来匹配图像标签上的 src、宽度和高度属性。宽度和高度是可选的。

我想出了以下几点：

```
(?:<img.*)(?<=src=")(?<src>([\w\s://?=&.]*)?)?(?:.*)(?<height>(?<=height=")\d*)?(?:.*)(?<width>(?<=width=")(\d*)?)? 
```

expresso 仅显示以下 html 片段的 src 位匹配

```
<img src="myimage.jpg" height="20" />
<img src="anotherImage.gif" width="30"/> 
```

我希望我真的很亲近，这里有人可以指出我做错了什么，我觉得它是我在字符之间的可选位（？：。*）我试过让它不贪婪，没有成功. 那么有什么指示吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T22:09:58.953

使用正则表达式从 HTML 中提取值总是一个错误。HTML 语法要复杂得多，它可能首先出现，而且页面很容易捕捉到非常复杂的正则表达式。

请改用[HTML 解析器](http://www.google.com/search?q=html+parser)。

[这个问题以前被问过](https://stackoverflow.com/questions/677038/how-to-use-regular-expressions-to-parse-html-in-java)，以后还会再问。正则表达式似乎是解决这个问题的好选择，但事实并非如此。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T22:12:25.283

正则表达式根本不擅长解析 HTML（请参阅[您能否提供一些示例，说明为什么用正则表达式解析 XML 和 HTML 很困难？](https://stackoverflow.com/questions/701166)为什么）。您需要的是一个 HTML 解析器。请参阅[您能否提供一个使用您最喜欢的解析器解析 HTML 的示例？](https://stackoverflow.com/questions/773340)对于使用各种解析器的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T22:09:53.260

在大多数正则表达式方言中，`.*`是“贪婪的”并且会过分匹配；用于`.*?`匹配“尽可能少”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T22:22:45.387

我没有机会测试它，但也许这对你有用（注意我没有使用命名匹配）：

```
<img(?:(\s*(src|height|width)\s*=\s*"([^"]+)"\s*)+|[^>]+?)*> 
```

# ruby-on-rails - Rails 控制器中的功能测试重定向

> ID：880067
> 
> 赞同：0
> 
> 时间：2009-05-18T22:08:08.677
> 
> 标签：ruby-on-rails, ruby, testing

我正在尝试这样做，因此当通过创建的操作创建模型时，它会重定向到其显示操作。那部分工作正常，但我无法让我的功能测试正常运行。这些测试已根据脚手架提供的内容进行了修改。

```
 def setup
    @thing = Factory(:thing)
    assert(@thing.id, "Virtual fixture not valid.")
  end

  def test_create_valid
    Thing.any_instance.stubs(:valid?).returns(true)
    post :create
    assert_redirected_to @thing
  end 
```

我在设置中使用 factory_girl。当我运行测试时，我得到了这个：

> 预期的响应是重定向到[http://test.host/thing/2](http://test.host/thing/2)但重定向到[http://test.host/thing/3](http://test.host/thing/3)。

我在这个控制器中用我的更新操作做了一些非常相似的事情，测试看起来一样，但它有效。我对发生了什么感到有点困惑。

**编辑**：Maximiliano 在下面指出，这可能是因为这会在数据库中创建一条新记录，因此它会重定向到该记录。如何找到刚刚使用 create post 请求创建的新记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T23:12:07.830

在 Max 的帮助下弄清楚了（谢谢！）要获取在数据库中创建的对象，我必须使用 assigns()：

assert_redirected_to 分配（：事物）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T22:27:02.773

免责声明：（我还没有使用工厂女孩......所以拿一粒盐）你的工厂不是在创建数据库记录吗？如果是这样，您将创建两次，一次使用工厂，另一次使用控制器；那么新记录的ID与工厂ID不同是正常的...

# iphone - 为什么presentationLayer的transform代表动画完成的状态，而动画正在运行？

> ID：880068
> 
> 赞同：1
> 
> 时间：2009-05-18T22:09:12.560
> 
> 标签：iphone, uikit, core-animation

文档说：

> 呈现树包含当前在动画发生时呈现给用户的值。例如，为图层的背景颜色设置新值会立即更改图层树中的值。但是，表示树中相应层中的 backgroundColor 值将在向用户显示时使用内插颜色进行更新。

现在，我在一个只有一个视图和一个动画的沙盒中进行了 8 小时的核心测试。在动画期间，我要求：

CATransform3D currentTransform = [(CALayer*)[self.layer presentationLayer] 变换]

我检查 currentTransform 的 m11 和 m12 值，以计算当前旋转角度。

当我设置为旋转 90 度时，会发生两件事，而动画发生但尚未完成：

*   有时我根据 currentTransform 计算出的角度是 0.0，尽管视图旋转了某个角度并且绝对不是 0.0。

*   有时（大多数情况下）它恰好是 90 度的目标值。

但我从来没有得到我想要的：动画中的当前状态。我在网上搜索了一段时间，开发人员似乎很少使用它。所以这要么是框架中的错误，要么是文档中的错误，或者我上面获取当前可见转换的代码是完全错误的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T22:55:02.140

我知道我已经从表示层拉出框架以在动画期间找到屏幕上视图的位置。这绝对有效。

我用它来停止动画，然后用表示层框架更新当前视图。

它应该可以工作，我认为您需要发布您的特定代码来解决这个问题。

# perl - 理解一些 dprof 输出

> ID：880069
> 
> 赞同：1
> 
> 时间：2009-05-18T22:09:26.070
> 
> 标签：perl, profiling

这是一些 dprofpp -I 输出，对于不同输入大小的几乎相同的程序（程序使用 File:Tie 读取输入文件并对行进行一些过滤。

问题是为什么这个程序的运行时间总是加倍？

我之所以问这个问题，是因为修复它会使我的程序速度提高 2 倍，而无需任何魔法 - 可能是因为 dprof 吗？我怎么知道这个？

同样令人困惑的是最后两组中 %Time 的值：

```
Total Elapsed Time = 456.5656 Seconds
  User+System Time = 206.2156 Seconds
Inclusive Times
%Time ExclSec CumulS #Calls sec/call Csec/c  Name
 87.6   25.71 180.65 157920   0.0000 0.0001  Tie::File::FETCH
 75.1   28.96 154.93 157920   0.0000 0.0001  Tie::File::_fetch
 26.0   14.77 53.769 839753   0.0000 0.0001  Tie::File::Cache::insert
 20.2   41.73 41.732 167950   0.0000 0.0000  Tie::File::_read_record
 18.9   11.54 38.998 839753   0.0000 0.0000  Tie::File::Heap::insert
 17.2   21.16 35.610 157920   0.0000 0.0000  Tie::File::Cache::lookup
 12.4   0.566 25.571  14503   0.0000 0.0018  Tie::File::FETCHSIZE
 11.9   6.701 24.732      1   6.7008 24.731  Tie::File::_fill_offsets
 11.5   10.57 23.874 839753   0.0000 0.0000  Tie::File::Heap::_insert_new
 7.00   4.756 14.444 739447   0.0000 0.0000  Tie::File::Heap::lookup
 6.25   11.62 12.893 839755   0.0000 0.0000  Tie::File::_seek
 5.33   10.99 10.991 839753   0.0000 0.0000  Tie::File::Cache::_heap_move
 4.70   6.796  9.688 739447   0.0000 0.0000  Tie::File::Heap::promote
 3.14   6.474  6.474 157920   0.0000 0.0000  Tie::File::Heap::_nseq
 1.12   2.311  2.311 839753   0.0000 0.0000  Tie::File::Heap::_nelts_inc

Total Elapsed Time = 1029.736 Seconds
  User+System Time = 562.5560 Seconds
Inclusive Times
%Time ExclSec CumulS #Calls sec/call Csec/c  Name
 119\.   58.01 671.82 304761   0.0000 0.0002  Tie::File::FETCH
 109\.   62.95 613.81 304761   0.0000 0.0002  Tie::File::_fetch
 68.6   30.71 385.95 154266   0.0000 0.0003  Tie::File::Cache::insert
 47.2   4.344 265.93 536190   0.0000 0.0005  Tie::File::Cache::flush
 46.5   7.502 261.58 536190   0.0000 0.0005  Tie::File::Cache::reduce_size_to
 45.1   4.131 254.08 636473   0.0000 0.0004  Tie::File::Heap::popheap
 44.4   148.4 249.95 636473   0.0002 0.0004  Tie::File::Heap::remove
 21.7   122.5 122.50 142968   0.0000 0.0000  Tie::File::Cache::_heap_move
 15.9   48.97 89.786 304761   0.0000 0.0000  Tie::File::Cache::lookup
 15.8   25.25 89.314 154266   0.0000 0.0001  Tie::File::Heap::insert
 14.2   80.39 80.394 308533   0.0000 0.0000  Tie::File::_read_record
 10.0   26.06 56.595 154266   0.0000 0.0000  Tie::File::Heap::_insert_new
 9.13   16.15 51.384      1   16.157 51.384  Tie::File::_fill_offsets
 9.13       - 51.384      1        - 51.384  Tie::File::FETCHSIZE
 7.26   15.52 40.815 150494   0.0000 0.0000  Tie::File::Heap::lookup

Total Elapsed Time = 556.7212 Seconds
  User+System Time = 290.2512 Seconds
Inclusive Times
%Time ExclSec CumulS #Calls sec/call Csec/c  Name
 115\.   51.05 336.00 335279   0.0000 0.0001  Tie::File::FETCH
 98.1   50.85 284.95 335279   0.0000 0.0001  Tie::File::_fetch
 35.4   45.84 102.90 335279   0.0000 0.0000  Tie::File::Cache::lookup
 29.0   18.79 84.176 107247   0.0000 0.0001  Tie::File::Cache::insert
 22.5   17.16 65.380 107247   0.0000 0.0001  Tie::File::Heap::insert
 19.6   21.19 57.056 228032   0.0000 0.0000  Tie::File::Heap::lookup
 17.2   50.07 50.077 214494   0.0000 0.0000  Tie::File::_read_record
 14.9   16.68 43.486 107247   0.0000 0.0000  Tie::File::Heap::_insert_new
 12.3   25.18 35.862 228032   0.0000 0.0000  Tie::File::Heap::promote
 10.8   9.213 31.547      1   9.2133 31.546  Tie::File::_fill_offsets
 10.8       - 31.546      1        - 31.546  Tie::File::FETCHSIZE
 7.90   22.92 22.923 107247   0.0000 0.0000  Tie::File::Cache::_heap_move
 6.64   15.98 19.280 107247   0.0000 0.0000  Tie::File::_seek
 5.31   15.41 15.411 335279   0.0000 0.0000  Tie::File::Heap::_nseq
 1.34   3.883  3.883 107247   0.0000 0.0000  Tie::File::Heap::_nelts_inc 
```

这是我正在谈论的那种代码：[http ://www.perlmonks.org/?node_id=763564](http://www.perlmonks.org/?node_id=763564)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T22:41:25.270

1.  Tie::File 告诉你你的瓶颈是从磁盘读取。这样你的优化就结束了。当然，除非您可以找到一种更聪明的方法来*不*从磁盘读取。

2.  使用[Devel::NYTProf](http://p3rl.org/Devel::NYTProf)，它更全面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-10T17:52:32.133

> > 问题是为什么这个程序的运行时间总是加倍？

我的理解是因为一半的时间都花在了I/O上[我这里可能错了]

但是，为了更好地了解实际时间花在哪里，请使用

```
$> dprofpp -I -r 
```

或者

```
$>dprofpp -I -r -A 
```

# iphone - 在 iPhone 设置应用程序中向滑块添加文本标签

> ID：880080
> 
> 赞同：6
> 
> 时间：2009-05-18T22:11:27.017
> 
> 标签：iphone, objective-c, cocoa-touch, settings

将 Settings.bundle 配置为 iPhone 应用程序包的一部分时，将最小值和最大值*图像*添加到滑块 (PSSliderSpecifier) 很简单，但不是简单的最大值和最小值*文本*标签。

[http://developer.apple.com/iPhone/library/documentation/PreferenceSettings/Conceptual/SettingsApplicationSchemaReference/Articles/PSSliderSpecifier.html](http://developer.apple.com/iPhone/library/documentation/PreferenceSettings/Conceptual/SettingsApplicationSchemaReference/Articles/PSSliderSpecifier.html)

iPhone 专家：**是否有人知道将文本标签应用于这些滑块以在“设置”应用程序中使用的简单方法**（因此，没有滑块子类化恶作剧；这一切都必须通过 plist 完成）？我想我可以只使用标签的*图像*，但是......呃。

如果有办法以某种数字格式显示滑块的当前值，则可以加分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-06-01T17:37:51.323

我需要通过将我的代码中的一些时间变量暴露给设置包来做同样的事情，以便非开发人员可以使用它们。据我所知，没有办法使用滑块来做到这一点。我做到了，但是找到了一个很好的解决方法：

请改用多值控件并为其提供字符串和值的列表。例如，要使用多值控件实现选择时间，我会使用标题和值的组合，例如：

30 秒 = 30、1 分钟 = 60、5 分钟 = 300 等。

事实证明，这是一种比使用滑块控件选择一系列数值更优雅的设计。例如，您可以将上述多值控件组合到现有设置组中（与滑块不同，您需要通过为每个滑块创建单独的组来标记滑块）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-08-27T01:42:38.277

我在每个滑块上方使用了 PSTitleValueSpecifier。不是最优雅的，但它炒锅。多值是一个很好的解决方案，因为它解决了滑块的另一个问题 - 当您移动它们时它们不会显示值。我最终改用了一个文本字段，并依赖于用户输入一个合理的值。

# asp.net-mvc - ASP.NET MVC 中的链接按钮

> ID：880081
> 
> 赞同：10
> 
> 时间：2009-05-18T22:11:38.203
> 
> 标签：asp.net-mvc, webforms, runatserver, asplinkbutton

我需要将一些 ASP LinkBut​​tons 实例化到 ASP.NET MVC 视图页面上。我已经尝试了一些事情，但我无法让它们正确出现。这是我最近的代码化身：aspx 文件

```
<body>
<% using (Html.BeginForm("TitleDetail", "Movies", FormMethod.Post, new{runat="server"})) { %> 

    <ul>
    <% foreach (var disc in Model.Title.tblDiscs) %>
    <% { %>

        <li>
            <asp:LinkButton ID="Play">Link</asp:LinkButton>
        </li>
    <% } %>
    </ul>
<% } %> 
</body> 
```

它在 Firefox 中呈现的是我正在枚举的集合中每个成员的文本链接的一个实例，但它们不是超链接，只是文本。生成的 HTML 如下所示

```
<form action="/MyMovies/TitleDetail/239" method="post" runat="server">test title <br />

   <ul>
        <li>

            <asp:LinkButton ID="Play">Link</asp:LinkButton>
        </li>

        <li>
            <asp:LinkButton ID="Play">Link</asp:LinkButton>
        </li>

        <li>
            <asp:LinkButton ID="Play">Link</asp:LinkButton>

        </li>

    </ul> 
```

我尝试向每个 asp:LinkBut​​ton 标记添加一个 runat="server" 属性，但我得到一个运行时异常，即控件只能放在具有 runat="server" 属性的表单标记内。我想我已经做过了，所以我不太明白。谁能向我解释我做错了什么，以及我需要做些什么来修复它，以便 LinkBut​​tons 实际上是链接的？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-19T19:45:23.237

我的猜测是您想使用 LinkBut​​ton 来提交表单吗？如果是这样的话，我做了类似的事情，它是这样的：

```
<% using (Html.BeginForm("TitleDetail", "Movies", 
    FormMethod.Post, new{ id = "MyForm", name = "MyForm" })) { %>     
<ul>
    <% foreach (var disc in Model.Title.tblDiscs) { %>
        <li>
            <a class="do-something-link" href="javascript:void(0);">Click</a> 
        </li>
    <% } %>
</ul>
<% } %> 
```

然后通过 jQuery 处理提交：

```
$(document).ready(function(){
    $("a.do-something-link").click(function(ev) {
        ev.preventDefault();
        $("#MyForm").submit();
    });
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-18T22:23:23.543

使用 ASP.NET MVC，您应该使用`Html.ActionLink(...)`辅助方法（等等）。它们提供比 LinkBut​​tons 更丰富的功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T22:20:30.680

不幸的是，ASP.NET MVC 目前不支持 Web 表单控件。对不起！:(

您必须使用标准的 HTML 链接。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-14T18:42:45.063

我写了一个有点粗糙的扩展方法。随意改进这一点（这就是我所需要的）：

```
public static IHtmlString ActionButton(this UrlHelper urlHelper, string buttonText,
    string actionName)
{
    var html = string.Format("<input type=\"button\" value=\"{0}\" " +
        "onclick=\"window.location = '{1}'\"/>",
        buttonText, urlHelper.Action(actionName));

    return new HtmlString(html);
} 
```

在视图中，这样称呼它：

```
@Url.ActionButton("Button Text", "ActionMethod") 
```

# html - 我可以在 A 标签上添加一个属性来获取在新选项卡而不是同一窗口中打开的链接吗？

> ID：880087
> 
> 赞同：1
> 
> 时间：2009-05-18T22:14:37.620
> 
> 标签：html, browser, tabs

我知道 target="_blank" 应该让它在新窗口中打开，对于某些浏览器，比如 FF3，它实际上会让它在新标签中打开。作为开发人员，有没有办法对这种行为进行更多控制？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-18T22:21:33.377

根据[https://developer.mozilla.org/En/Window.open](https://developer.mozilla.org/En/Window.open)，“”“ **如何在新选项卡或特定选项卡中打开链接的引用资源？**

目前，你不能。只有用户可以设置他的高级偏好来做到这一点。K-meleon 1.1 是一个基于 Mozilla 的浏览器，它为用户提供了关于如何打开链接的完全控制和权力。一些高级扩展还为 Mozilla 和 Firefox 提供了很大的权限来控制引用资源的加载方式。

几年后，CSS3超链接模块的目标属性可能会实现（如果现在的CSS3超链接模块被批准的话）。即使发生这种情况，您也可以期望具有标签浏览功能的浏览器开发人员能够赋予用户完全否决权并完全控制链接如何打开网页。如何打开链接应始终完全在用户的控制之下。"""

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T22:26:28.890

目前，如何打开链接的最终决定权在用户和他们的浏览器手中。

另外，如果开发人员以您描述的方式推翻了我的选择，我也不会太高兴。我只希望一次打开一个浏览器窗口，并且不希望出现子窗口。其他人的感觉恰恰相反。作为开发人员，我们应该尽量尊重这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T22:22:54.823

以“_blank”为目标的内容是否打开到新选项卡或窗口是在大多数支持新选项卡的浏览器中可设置的浏览器/用户特定选项。目前还没有办法定位标签。

# c# - C# Linq-SQL：存储库模式的 UpdateByID 方法

> ID：880090
> 
> 赞同：3
> 
> 时间：2009-05-18T22:15:14.153
> 
> 标签：c#, linq-to-sql, generics, repository-pattern

我已经实现了一种`Repository`类，它有`GetByID`,`DeleteByID`方法等，但是我在实现该`UpdateByID`方法时遇到了麻烦。

我做了这样的事情：

```
public virtual void UpdateByID(int id, T entity)
{
        var dbcontext = DB;
        var item = GetByID(dbcontext, id);
        item = entity; 
        dbcontext.SubmitChanges();
}

protected MusicRepo_DBDataContext DB
{
    get
    {
        return new MusicRepo_DBDataContext();
    }
} 
```

但它不会更新传递的实体。

有没有人实施过这样的方法？

* * *

*供参考[，](http://pastebin.com/m1ef0c7c0)方法`GetByID`如下*

* * *

**[更新]**

正如 Marc 正确建议的那样，我只是在更改局部变量的值。那么您认为我应该如何使用这种方法？使用反射并将属性从复制`entity`到`item`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-18T22:20:03.333

您更新的只是一个局部变量；为此，您必须将*成员值*从`entity`to 复制到`item`- 不是那么简单。

* * *

像下面这样的东西；我使用的唯一原因`TKey`是我在 Northwind.Customer 上进行了测试，它有一个字符串键；-p

使用元模型的优点是即使您使用 POCO 类（和基于 xml 的映射）它也可以工作，并且它不会尝试更新与模型无关的任何内容。

出于示例的目的，我已经传入了数据上下文，您需要`SubmitChanges`在某些时候添加 a，但其余部分应该可以直接比较。

顺便说一句 - 如果您乐于从传入的对象中获取 ID，那也很容易 - 然后您可以支持复合身份表。

```
 static void Update<TEntity>(DataContext dataContext, int id, TEntity obj)
        where TEntity : class
    {
        Update<TEntity, int>(dataContext, id, obj);
    }
    static void Update<TEntity, TKey>(DataContext dataContext, TKey id, TEntity obj)
        where TEntity : class
    {
        // get the row from the database using the meta-model
        MetaType meta = dataContext.Mapping.GetTable(typeof(TEntity)).RowType;
        if(meta.IdentityMembers.Count != 1) throw new InvalidOperationException("Composite identity not supported");
        string idName = meta.IdentityMembers[0].Member.Name;

        var param = Expression.Parameter(typeof(TEntity), "row");
        var lambda = Expression.Lambda<Func<TEntity,bool>>(
            Expression.Equal(
                Expression.PropertyOrField(param, idName),
                Expression.Constant(id, typeof(TKey))), param);

        object dbRow = dataContext.GetTable<TEntity>().Single(lambda);

        foreach (MetaDataMember member in meta.DataMembers)
        {
            // don't copy ID
            if (member.IsPrimaryKey) continue; // removed: || member.IsVersion
            // (perhaps exclude associations and timestamp/rowversion? too)

            // if you get problems, try using StorageAccessor instead -
            // this will typically skip validation, etc
            member.MemberAccessor.SetBoxedValue(
                ref dbRow, member.MemberAccessor.GetBoxedValue(obj));
        }
        // submit changes here?
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-08T16:06:05.707

*在这里重新审视一下，以前对问题的回答对应用程序做出了各种假设。*

应用程序中的并发性是需要预先考虑的事情，并且实际上并没有一刀切的答案。为您的应用选择时需要考虑的事项：

*   LINQ to SQL / Entity Framework 是非常可配置的，因为没有万能的。
*   在您的应用程序有一定的负载之前，您不会看到并发的效果（即，您一个人，在您自己的机器上可能*永远*看不到它）
*   您的应用程序多久允许 2 个（或更多）用户编辑同一个实体？
*   您想如何处理两个编辑重叠的情况？
*   您的应用程序是否在另一层（例如 Ajax）之间来回序列化数据？如果是这样，那么您如何知道已编辑的实体是否在读取/更新之间被修改？时间戳？版本字段？
*   您是否关心编辑是否重叠？特别注意 FK 关系。数据完整性是您可能被最后一场胜利所困扰的地方。

不同的解决方案具有非常不同的性能影响！在开发过程中您不会注意到，但当 25 人同时使用时，您的应用程序可能会崩溃。注意大量的来回复制和许多 SQL 读取：

*   **不要在循环中调用 SQL**（传入实体列表时注意这一点）
*   当您已经通过 LINQ 进行并发检查时，不要为此使用反射
*   尽量减少字段的来回复制（在跨越 N 层边界时可能需要）。
*   不要进行单独的查询来查找旧实体，（仅当您已经拥有它时才使用它）让 LINQ 执行此操作，因为它更适合在 SQL 中执行此操作。

以下是一些很好的链接，可用于深入阅读以确定您的特定需求：

*   [乐观并发概述（LINQ to SQL、MSDN）](http://msdn.microsoft.com/en-us/library/bb399373.aspx)
*   [反模式：错误处理的并发（2009 年 6 月，MSDN 杂志）](http://msdn.microsoft.com/en-us/magazine/dd882522.aspx#id0420025)

我推荐的解决方案：

```
public virtual void Update(T entity)
{
    var DB = ...;
    DB.GetTable<T>().Attach(entity, true);
    try
    {
        // commit to database
        DB.SubmitChanges(ConflictMode.ContinueOnConflict);
    }
    catch (ChangeConflictException e)
    {
        Console.WriteLine(e.Message);
        foreach (ObjectChangeConflict occ in DB.ChangeConflicts)
        {
            occ.Resolve(REFRESH_MODE);
        }
    }
} 
```

其中`REFRESH_MODE`指定以下之一：

*   `RefreshMode.KeepChanges`
*   `RefreshMode.KeepCurrentValues`
*   `RefreshMode.OverwriteCurrentValues`

您还需要对模型进行一些考虑：

可能不言而喻，但您需要让 LINQ 知道哪个字段是您更新实体的主键。您不必将其作为另一个参数传递（如在您的原始方法中），因为 LINQ 已经知道这是 PK。

您可以（*而不是“必须”*）决定实际检查哪些字段。例如，外键字段对于并发检查非常重要，而描述字段可能值得最后一胜。您可以通过`UpdateCheck`属性控制它。默认值为`UpdateCheck.Always`. 来自 MSDN：

> 只有成员映射为`Always`或 `WhenChanged`参与乐观并发检查。对标记为 的成员不进行检查`Never`。有关详细信息，请参阅[`UpdateCheck`](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.updatecheck.aspx)。

要启用乐观并发，您需要指定一个用作并发标记的字段（例如时间戳或版本），并且在来回序列化时必须始终存在该字段。 [用 标记此列`IsVersion=true`。](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.columnattribute.isversion.aspx)

如果您不想进行并发检查，则必须将所有标记为 UpdateCheck.Never。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-12T02:39:15.720

我遇到了一些类似的问题，最终选择了[PLINQO](http://www.plinqo.com/)，对 LINQ-TO-SQL 生成的代码进行了很多增强。但是，如果您还没有它，它确实需要购买 CodeSmith（尽管可以免费评估 30 天）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T14:39:28.427

好吧，我有这样的事情（从我的头顶）：

```
public Question UpdateQuestion(Question newQuestion)
    {
        using (var context = new KodeNinjaEntitiesDataContext())
        {
            var question = (from q in context.Questions where q.QuestionId == newQuestion.QuestionId select q).SingleOrDefault();
            UpdateFields(newQuestion, question);
            context.SubmitChanges();                
            return question;
        }
    }

    private static void UpdateFields(Question newQuestion, Question oldQuestion)
    {
        if (newQuestion != null && oldQuestion != null)
        {
            oldQuestion.ReadCount = newQuestion.ReadCount;
            oldQuestion.VotesCount = newQuestion.VotesCount;
            //.....and so on and so on.....
        }
    } 
```

它适用于简单的实体。当然，如果你有很多实体，你可以使用反射。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-06T23:17:00.613

如果我理解正确，您不需要对此进行反思。

要为特定实体执行此操作，您需要获取您的实体并将其附加到数据库上下文。附加后，LINQ-to-SQL 将确定需要更新的内容。类似于以下内容：

```
// update an existing member
dbcontext.Members.Attach(member, true);

// commit to database
dbcontext.SubmitChanges(); 
```

这将用于更新成员表中的成员。真正的论点说你修改了它。或者，如果您有原始文件，您可以将其作为第二个参数传递，并让数据库上下文为您执行差异。这是 DB 上下文实现（实现“工作单元”模式）的主要部分。

为了概括这一点，您可以将 Member 类型替换为 T，并将 .Members 替换为 .GetTable：

```
public virtual void Update(T entity)
{
        var dbcontext = DB;
        dbcontext.GetTable<T>().Attach(entity, true);
        dbcontext.SubmitChanges();
} 
```

假设已经在实体上正确设置了 ID（并且它在模型中被标记为主键），您甚至不需要先查找它。如果您觉得有必要，您可以通过 ID 查找它，然后将其传递给 Attach 方法，但这可能只会导致不需要的额外查找。

**编辑：**您需要[在模型中的列上将 UpdateCheck 设置为 Never](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.columnattribute.updatecheck.aspx)，否则它会尝试执行并发检查。如果您将其设置为从不，您将获得最后一次更新胜利。否则，您将 tmestamp 字段添加到表中，并发检查将确定实体是否已过期。

UpdateCheck.Never 与 Attach(entity, bool) 结合使用将是使用 LINQ-to-SQL 解决此问题的最简单和最高效的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-06T23:31:30.337

嘿，dreas，我也为此苦苦挣扎，并找到了一个非常优雅的解决方案。

您基本上必须使用 DataContext.Attach(EntityToUpdate,OriginalEntity) 方法。

有一些陷阱......所以，[阅读此信息，它将解释一切](http://www.west-wind.com/weblog/posts/135659.aspx)。

读完之后，有任何问题都可以回来找我。我已经根据该信息编写了一个非常有用的 EntitySaver 类，所以如果你需要，一旦你得到了陷阱，我们就可以通过你的类。

干杯

**编辑**：这是我的完整课程，以防您想尝试一下。它实际上自动处理更新和插入。让我知道你有任何问题。

实体保护程序：

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using QDAL.CoreContext;
using QDAL.CoreEntities;
using LinqExtension.CustomExtensions;

namespace QDAL
{
    internal class DisconnectedEntitySaver
    {
        private QDataDataContext ContextForUpdate;

        public DisconnectedEntitySaver() {
            ContextForUpdate = Base.CreateDataContext();
        }

        public List<TEntityType> SaveEntities<TEntityType, TKeyType>(List<TEntityType> EntitiesToSave) {

            string PKName;

            PKName = Base.GetPrimaryKeyName(typeof(TEntityType), ContextForUpdate);

            return SaveEntities<TEntityType, TKeyType>(EntitiesToSave, PKName);
        }

        public List<TEntityType> SaveEntities<TEntityType, TKeyType>(List<TEntityType> EntitiesToSave, string KeyFieldName)
        {
            List<TEntityType> EntitiesToPossiblyUpdate;
            List<TEntityType> EntitiesToInsert;
            List<TEntityType> HandledEntities = new List<TEntityType>();

            bool TimeStampEntity;
            Type ActualFieldType;

            if (EntitiesToSave.Count > 0) {
                TimeStampEntity = Base.EntityContainsTimeStamp(typeof(TEntityType), ContextForUpdate);

                ActualFieldType = EntitiesToSave.FirstOrDefault().GetPropertyType(KeyFieldName);

                if (ActualFieldType != typeof(TKeyType)) {
                    throw new Exception("The UniqueFieldType[" + typeof(TKeyType).Name + "] specified does not match the actual field Type[" + ActualFieldType.Name + "]");
                }

                if (ActualFieldType == typeof(string)) {
                    EntitiesToPossiblyUpdate = EntitiesToSave.Where(ent => string.IsNullOrEmpty(ent.GetPropertyValue<string>(KeyFieldName)) == false).ToList();
                    EntitiesToInsert = EntitiesToSave.Where(ent => string.IsNullOrEmpty(ent.GetPropertyValue<string>(KeyFieldName)) == true).ToList();
                } else {
                    EntitiesToPossiblyUpdate = EntitiesToSave.Where(ent => EqualityComparer<TKeyType>.Default.Equals(ent.GetPropertyValue<TKeyType>(KeyFieldName), default(TKeyType)) == false).ToList();
                    EntitiesToInsert = EntitiesToSave.Where(ent => EqualityComparer<TKeyType>.Default.Equals(ent.GetPropertyValue<TKeyType>(KeyFieldName), default(TKeyType)) == true).ToList();
                }

                if (EntitiesToPossiblyUpdate.Count > 0) {
                    EntitiesToInsert.AddRange(ResolveUpdatesReturnInserts<TEntityType, TKeyType>(EntitiesToPossiblyUpdate, KeyFieldName));

                    HandledEntities.AddRange(EntitiesToPossiblyUpdate.Where(ent => EntitiesToInsert.Select(eti => eti.GetPropertyValue<TKeyType>(KeyFieldName)).Contains(ent.GetPropertyValue<TKeyType>(KeyFieldName)) == false));
                }

                if (EntitiesToInsert.Count > 0) {
                    ContextForUpdate.GetTable(typeof(TEntityType)).InsertAllOnSubmit(EntitiesToInsert);

                    HandledEntities.AddRange(EntitiesToInsert);
                }

                ContextForUpdate.SubmitChanges();
                ContextForUpdate = null;

                return HandledEntities;
            } else {
                return EntitiesToSave;
            }
        }

        private List<TEntityType> ResolveUpdatesReturnInserts<TEntityType, TKeyType>(List<TEntityType> PossibleUpdates, string KeyFieldName)
        {
            QDataDataContext ContextForOrginalEntities;

            List<TKeyType> EntityToSavePrimaryKeys;
            List<TEntityType> EntitiesToInsert = new List<TEntityType>();
            List<TEntityType> OriginalEntities;

            TEntityType NewEntityToUpdate;
            TEntityType OriginalEntity;

            string TableName;

            ContextForOrginalEntities = Base.CreateDataContext();

            TableName = ContextForOrginalEntities.Mapping.GetTable(typeof(TEntityType)).TableName;
            EntityToSavePrimaryKeys = (from ent in PossibleUpdates select ent.GetPropertyValue<TKeyType>(KeyFieldName)).ToList();

            OriginalEntities = ContextForOrginalEntities.ExecuteQuery<TEntityType>("SELECT * FROM " + TableName + " WHERE " + KeyFieldName + " IN('" + string.Join("','", EntityToSavePrimaryKeys.Select(varobj => varobj.ToString().Trim()).ToArray()) + "')").ToList();

            //kill original entity getter
            ContextForOrginalEntities = null;

            foreach (TEntityType NewEntity in PossibleUpdates)
            {
                NewEntityToUpdate = NewEntity;
                OriginalEntity = OriginalEntities.Where(ent => EqualityComparer<TKeyType>.Default.Equals(ent.GetPropertyValue<TKeyType>(KeyFieldName),NewEntityToUpdate.GetPropertyValue<TKeyType>(KeyFieldName)) == true).FirstOrDefault();

                if (OriginalEntity == null)
                {
                    EntitiesToInsert.Add(NewEntityToUpdate);
                }
                else
                {
                    ContextForUpdate.GetTable(typeof(TEntityType)).Attach(CloneEntity<TEntityType>(NewEntityToUpdate), OriginalEntity);
                }
            }

            return EntitiesToInsert;
        }

        protected  TEntityType CloneEntity<TEntityType>(TEntityType EntityToClone)
        {
            var dcs = new System.Runtime.Serialization.DataContractSerializer(typeof(TEntityType));
            using (var ms = new System.IO.MemoryStream())
            {
                dcs.WriteObject(ms, EntityToClone);
                ms.Seek(0, System.IO.SeekOrigin.Begin);
                return (TEntityType)dcs.ReadObject(ms);
            }
        }
    }
} 
```

你也需要这些助手：

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using QDAL.CoreContext;
using QDAL.CoreEntities;
using System.Configuration;

namespace QDAL
{
    internal class Base
    {
        public Base() {
        }

        internal static QDataDataContext CreateDataContext() {
            QDataDataContext newContext;
            string ConnStr;

            ConnStr = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString;

            newContext = new QDataDataContext(ConnStr);

            return newContext;
        }

        internal static string GetTableName(Type EntityType, QDataDataContext CurrentContext) {
            return CurrentContext.Mapping.GetTable(EntityType).TableName;
        }

        internal static string GetPrimaryKeyName(Type EntityType, QDataDataContext CurrentContext) {
            return (from m in CurrentContext.Mapping.MappingSource.GetModel(CurrentContext.GetType()).GetMetaType(EntityType).DataMembers where m.IsPrimaryKey == true select m.Name).FirstOrDefault();
        }

        internal static bool EntityContainsTimeStamp(Type EntityType, QDataDataContext CurrentContext) {
            return (CurrentContext.Mapping.MappingSource.GetModel(CurrentContext.GetType()).GetMetaType(EntityType).DataMembers.Where(dm => dm.IsVersion == true).FirstOrDefault() != null);
        }
    }
} 
```

这些扩展使反射更容易：

```
<System.Runtime.CompilerServices.Extension()> _
    Public Function GetPropertyValue(Of ValueType)(ByVal Source As Object, ByVal PropertyName As String) As ValueType
        Dim pInfo As System.Reflection.PropertyInfo

        pInfo = Source.GetType.GetProperty(PropertyName)

        If pInfo Is Nothing Then
            Throw New Exception("Property " & PropertyName & " does not exists for object of type " & Source.GetType.Name)
        Else
            Return pInfo.GetValue(Source, Nothing)
        End If
    End Function

    <System.Runtime.CompilerServices.Extension()> _
    Public Function GetPropertyType(ByVal Source As Object, ByVal PropertyName As String) As Type
        Dim pInfo As System.Reflection.PropertyInfo

        pInfo = Source.GetType.GetProperty(PropertyName)

        If pInfo Is Nothing Then
            Throw New Exception("Property " & PropertyName & " does not exists for object of type " & Source.GetType.Name)
        Else
            Return pInfo.PropertyType
        End If
    End Function 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-09T21:24:52.943

我对存储库模式不是很熟悉，但是如果您从数据库中删除旧实体，然后将新实体放入具有相同 ID 的数据库中怎么办？像这样的东西：

```
public virtual void UpdateByID(int id, T entity)
{
    DeleteByID(id);
    var dbcontext = DB;
    //insert item (would have added this myself but you don't say how)
    dbcontext.SubmitChanges();
} 
```

# git - 合并分支之间的大更改的提示

> ID：880101
> 
> 赞同：3
> 
> 时间：2009-05-18T22:19:14.520
> 
> 标签：git, version-control, refactoring

为了学习 Doxygen，我创建了一个分支并修改了一个慢速项目的源文件注释。但是，该项目此后发生了很大变化，将一个大文件拆分为几个较小的文件：

```
big_file.c -> big_file.c file_a.[ch] file_b.[ch] 
```

我想在我的分支上做同样的事情。显然，我可以将我的分支的 large_file.c 复制为 file_a.[ch] 等，然后手动合并，删除不相关的部分。但是，我想知道是否有更少容易出错的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T00:13:15.050

已经有一段时间了，但我很快就完成了合并，如果很无聊的话。为了将来参考，该项目遵循了两个良好实践：

*   频繁的小提交
*   *只做*了拆分，没有添加新功能

我合并到我的分支中的第一个更改是创建几个空文件（file_a.[ch]、file_b.[ch]）。简单的合并。第二个更改是从 big_file.c 中剪切和粘贴代码并将其合并到 file_a.[ch] 中。合并很简单，即使有一些冲突。同样对于其他更改，直到项目的 HEAD 合并到我的分支中，几乎没有冲突。从那时起，跟踪变化就变得微不足道了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T22:39:15.573

git merge 在某些情况下可以自动跟随这些变化。我建议在做任何复杂的事情之前先尝试直接合并。

# qt - QTCreator 的集成表单编辑器不会加载自定义小部件插件（Designer 会）

> ID：880109
> 
> 赞同：3
> 
> 时间：2009-05-18T22:21:48.993
> 
> 标签：qt, designer, qt-creator

尝试使用集成到 QTCreator 的表单编辑器，但即使我将插件放入 QtCreator.app/Contents/MacOS/designer 也不会显示。不过，相同的 dylib 文件确实适用于独立的设计器应用程序。

QTCreator 版本信息：QTCreator 1.1.0（基于 QT 版本 4.5.1） Designer 版本信息：版本 4.5.1

有什么提示吗？这个网页： http: [//labs.trolltech.com/page/Projects/Tools/QtCreator/FAQ](http://labs.trolltech.com/page/Projects/Tools/QtCreator/FAQ)，建议我有版本问题，但这似乎很疯狂，因为我使用的是“纯”4.5（全新安装和所有这些） )...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T11:43:59.507

您是否正确地为插件提供了链接器引用？尝试

```
otool -L /path/to/plugin/dylib 
```

在插件二进制文件上，看看它是否能够正确引用 Qt 库，假设 @executable_path 是设计器二进制文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-11T09:10:54.330

在 QT 4.7 中，应该将 QT Designer 插件复制到 /qt-install-dir/plugins/designer。请注意，插件应该创建为发布而不是调试！

# c# - 将数据从一个 asp.net 页面发布到另一个页面

> ID：880110
> 
> 赞同：1
> 
> 时间：2009-05-18T22:22:05.420
> 
> 标签：c#, asp.net, forms, post

好的，我已经对此进行了足够的研究，但找不到解决方案。它从应用程序的一页到应用程序的另一页。因为我要发送用户名和密码，所以我不能将它作为“getT”发送，所以我需要做一个“post”。不过我会使用 ssl - 不确定这是否有帮助.. 所以我不能在不同的应用程序上使用会话，并且使用像 databsae 这样的共享会话会导致性能下降此外，一旦用户单击源页面上的链接，我需要做一些后期处理，然后想发布到另一个页面，所以使用表单和东西不会工作..

任何帮助

仅供参考：我想要实现的是，当一个人登录应用程序 A 时，他们点击了一些链接，我没有进行一些处理并希望将它们转移到应用程序 B，他们不必重新登录应用程序 B，而是自动登录..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T22:34:37.640

我们使用 Global.asax 来做与您描述的相同的事情。假设两个 Web 应用程序使用相同的业务域。您可以使用以下内容在我们的业务域中设置登录用户。然后，您可以使用该属性的存在来知道不要在您的第二个 Web 应用程序上再次要求登录。

```
 /// <summary>
    ///     Event fires when an HTTP request is made to the application.
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void Application_PreRequestHandlerExecute(object sender, EventArgs e)
    {
        // If we don't have a logged in user.
        if (<BusinessDomain>.Constants.LoggedInUserID == null)
        {
            // Ensure that Context.Handler for this particular HTTP request implements an interface that uses a Session State.
            if (Context.Handler is IRequiresSessionState || Context.Handler is IReadOnlySessionState)
            {
                if (Session != null)
                {
                    // Set the currently logged in user in our Business Domain.
                    if ((Guid)Session["UserID"] != Guid.Empty)
                    {
                        <BusinessDomain>.Constants.LoggedInUserID = Session["UserID"];
                    }
                }
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T22:26:46.127

也许不是最好的解决方案，但您可以使用 cookie。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T23:41:59.470

我认为您正在寻找[单站点登录](http://aspalliance.com/1545_Understanding_Single_SignOn_in_ASPNET_20.all)解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T23:50:24.447

同意 Thomas 的观点，听起来是为单点登录解决方案量身定制的。使用单点登录的多个 Web 应用程序，因此一旦您登录一个应用程序，您就登录了所有引用成员资格提供商的应用程序。

[http://weblogs.asp.net/scottgu/archive/2006/05/07/ASP.NET-2.0-Membership-and-Roles-Tutorial-Series.aspx](http://weblogs.asp.net/scottgu/archive/2006/05/07/ASP.NET-2.0-Membership-and-Roles-Tutorial-Series.aspx)

[http://dotnetslackers.com/ASP_NET/re-29031_ASP_NET_2_0_Implementing_Single_Sign_On_SSO_with_Membership_API.aspx](http://dotnetslackers.com/ASP_NET/re-29031_ASP_NET_2_0_Implementing_Single_Sign_On_SSO_with_Membership_API.aspx)

希望有帮助

# delphi - 如何减少新表单的“使用”样板？

> ID：880125
> 
> 赞同：11
> 
> 时间：2009-05-18T22:28:10.820
> 
> 标签：delphi, templates, boilerplate

每次我在我的项目中添加一个新表单时，它都会在 uses 子句中丢掉一大堆样板文件。

```
uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs; 
```

说真的，谁会定期使用 Variants 单元？我通常最终会删除 Windows、消息、变体、图形和对话框，并且永远不会错过它们。

那一定是从某个模板文件中出来的，但我似乎找不到它。有谁知道我在哪里可以找到模板并进行编辑？我正在使用 D2009，以防它最近发生变化。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-18T23:50:43.570

相应的资源位于 $(BDS)\bin\delphivclide*.bpl 并命名为“VCLIDECMD”；您可以使用您选择的资源编辑器提取、编辑和更新它（我推荐[Pelles C](http://www.smorgasbordet.com/pellesc/)中包含的那个）。

对于 C++Builder 用户，模板文件是 bcbvclide*.bpl 中的“CPPVCLIDECMD”。

如果您使用的是 RAD Studio 的本地化版本，请查看相应的语言资源文件（*.DE、*.FR 或 *.JA）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-19T00:14:31.433

您不会通过删除**Windows**和**Messages**来保存任何内容。 **图形**和**对话框**可能会根据您在表单上放置的组件重新添加，无论如何它们都非常有用。怀疑你通过删除它们节省了很多。如果您不使用它们，请随意删除**它们**（我同意这很常见，除非进行 COM 或 DB 开发）。

我想这完全取决于您清理使用条款的目标。 **变体**实际上是唯一可能对您的应用程序产生影响的变体。

至于更改默认模板，我相信它在一个包中，上面写着如果你是从 TForm 下降的，那么你会得到那些。您很可能需要修改 .PAS 文件并重建 VCL 包。做很多工作却收获很少。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-19T08:43:37.553

[我通常在完成项目后使用cnPack](http://www.cnpack.org)附带的“使用清洁器” ，它会为您提供项目中所有未使用单元的列表，因为通常在完成项目时您可能有比您提到的更大的未使用单元。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T09:28:57.103

其实，这也让我很困扰。

但后来我检查了使用默认单位编译的可执行文件大小，然后在没有它们的情况下检查了它（消息、变体、图形），大小并没有小很多。

Dialogs.pas 增加了一些千字节，但我经常使用 delphi VCL 对话框而不是 Win API 对话框。

所以，我会说不要太在意他们

# client-server - 为什么某些 posix 共享内存段和 posix 信号量对 ipcs 不可见

> ID：880127
> 
> 赞同：2
> 
> 时间：2009-05-18T22:30:51.190
> 
> 标签：client-server, posix, shared-memory, semaphore, ipcs

我使用 posix 共享内存和 pshared=1 的 posix 未命名信号量构建了一个客户端服务器应用程序。信号量放置在共享内存中。程序运行良好，但是当我键入 ipcs -m 或 ipcs -s 时，我没有看到我创建的任何共享内存段或信号量。为什么会这样？

```
/* Server main function for implementing client server program using Posix Shared Memory and Posix Unnamed Semaphores*/  
#include "shm_sem.h"
int main(int argc,char ** argv)  
{  
    int fd;  
    struct shmstruct *ptr;  
    shm_unlink(MYSHM); // delete shared memory segment, if it already exists     
    /* create shared memory, set its size, map it and close descriptor */
    fd=shm_open(MYSHM,O_RDWR|O_CREAT|O_EXCL,0777);  
    ptr=mmap(NULL,sizeof(struct shmstruct),PROT_READ|PROT_WRITE,MAP_SHARED,fd,0);  
    // truncate the size of shared memory to the size of shmstruct  
    ftruncate(fd,sizeof(struct shmstruct)); 
    close(fd);  
    // initialize the semaphores in shared memory  
    sem_init(&ptr->client_mutex,1,1); // set client semaphore to 1  
    sem_init(&ptr->server_mutex,1,0); // set server semaphore to 0  
    for(;;)
        {
        serverPosixShmSem(ptr); // calling server
        }  
} 
```

* * *

```
/* Server main function for implementing client server program using Posix Shared Memory and Posix Unnamed Semaphores*/  

#include "shm_sem.h"
int main(int argc,char ** argv)  
{  
    int fd;  
    struct shmstruct *ptr;  
    shm_unlink(MYSHM); // delete shared memory segment, if it already exists     
    /* create shared memory, set its size, map it and close descriptor */
    fd=shm_open(MYSHM,O_RDWR|O_CREAT|O_EXCL,0777);  
    ptr=mmap(NULL,sizeof(struct shmstruct),PROT_READ|PROT_WRITE,MAP_SHARED,fd,0);  
    // truncate the size of shared memory to the size of shmstruct  
    ftruncate(fd,sizeof(struct shmstruct)); 
    close(fd);  

    // initialize the semaphores in shared memory  
    sem_init(&ptr->client_mutex,1,1); // set client semaphore to 1  
    sem_init(&ptr->server_mutex,1,0); // set server semaphore to 0  
    for(;;)
    {
        serverPosixShmSem(ptr); // calling server
    }  
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T23:43:17.767

ipcs 显示有关 System V IPC 系统的信息。POSIX 信号量和共享内存是一个独立的（更好的）系统，不受“ipcs”的监控。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T22:39:51.547

几个问题：

*   您是否`ipcs`以创建共享内存/信号量的同一用户（或超级用户）身份运行？
*   `ipcs`程序运行时你在运行吗？（你确定它退出时不会删除它们吗？）

*更新*：

实际上，在阅读了这个[帖子](http://unix.derkeiler.com/Newsgroups/comp.unix.programmer/2007-01/msg00416.html)之后，我不确定 ipcs 是否应该能够显示 POSIX 信号量。`/dev/shm`我尝试了您的示例代码（进行了一些编辑以修复编译错误），您可以在目录中看到共享内存段。

# wpf - (WPF) 如何防止 GUI 代码混乱

> ID：880128
> 
> 赞同：4
> 
> 时间：2009-05-18T22:30:55.247
> 
> 标签：wpf, user-interface

我有一个 GUI 可以完成很多不同的任务。我目前在标签 UI 中将它们分开。完成所有繁重工作的功能被分成不同的类，但剩下的看起来仍然一团糟。您如何在代码中组织 GUI 函数以使所有内容保持一致？我正在专门使用 WPF，但也欢迎一般答案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-18T22:36:48.103

你应该看看[Model-View-ViewModel 设计模式](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)，它非常适合编写干净的 GUI 代码，与业务逻辑明显分离。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T01:05:28.880

除了 Thomas 的回答 - MVVM 如果用于 GUI-非 GUI 分离。您还应该分离 GUI 模块，而[Prism](http://www.codeplex.com/CompositeWPF)将对此有所帮助。

# .net - Process.WaitForExit() 导致 NullReferenceException

> ID：880129
> 
> 赞同：0
> 
> 时间：2009-05-18T22:31:44.667
> 
> 标签：.net, vb.net, system.diagnostics

以下代码导致 NullReferenceException

```
tStartParameter = String.Format(tStartParameter, tTo, tSubject)
tProcess = Process.Start(New ProcessStartInfo(tStartParameter) _
           With {.UseShellExecute = True})
tProcess.WaitForExit() 
```

tStartParameter 是：

```
https://mail.google.com/?view=cm&fs=1&tf=1&to=t@example.com&su=boogaloo!! 
```

使用调试器，我看到 Process.Start 返回 null。所以..关于为什么会发生这种情况的任何想法？我真的很想阻止程序执行，直到用户完成启动的进程。

更新：将代码重构为：

```
tStartParameter = String.Format(tStartParameter, tTo, tSubject)
tProcess = New Process
tProcess.StartInfo = New ProcessStartInfo(tStartParameter) _
                     With {.UseShellExecute = True}
tProcess.Start()
tProcess.WaitForExit() 
```

导致此异常：

> InvalidOperationException：没有进程与此对象关联。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T22:48:21.530

从 MSDN，Process.Start 将返回：

> **如果没有启动进程资源**（例如，如果重用现有进程），则与进程资源或空引用（Visual Basic 中的 Nothing）关联的新进程组件 。

在您的情况下，由于您将 URL 传递给 Process.Start 而不是可执行文件，因此您实际上并没有启动一个新进程。您将 URL 传递给 iexplore 或任何您的浏览器。所以你得到一个空回。

无论如何，“阻止程序执行直到用户完成启动的进程”是什么意思？等到用户关闭网络浏览器？在这种情况下，您可能需要以下内容：

```
Process p = Process.Start("iexplore", "http://www.google.com");
p.WaitForExit(); 
```

...这对我来说很合适。不过，它确实需要您指定浏览器可执行文件。

# javascript - 基于父 URL 的帧中断

> ID：880131
> 
> 赞同：0
> 
> 时间：2009-05-18T22:32:51.747
> 
> 标签：javascript, frames

我正在尝试帮助我的一个朋友打破他的网站摆脱一些讨厌的框架： [example](http://getweb.info/college/?p=4386)。这通常不会是一个问题，但这个特定的网站通过在页面顶部放置一个不付钱给我朋友的广告跨越了一些道德界限。

这就是复杂的地方，他希望他的网站在某些网站（如[netvibes](http://www.netvibes.com) ）的框架中。

所以，我尝试了这样的事情：

```
<!-- start break from getweb.info -->
<script type="text/javascript">

    purl = parent.location.href;
    //alert(purl);
    if(purl.indexOf('getweb') > 0 && top.frames.length!=0)
    {
        top.location=self.document.location;
    }
</script>
<!-- end break from getweb.info --> 
```

但是，因为它需要有条件的中断，所以这不起作用，因为 firefox.（假设其他人也有相同的错误，尚未测试）给出了一个错误，指出框架中的站点不允许获取 location.href父框架的属性。

JavaScript 有没有办法根据父框架的位置跳出框架？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T23:07:05.017

您遇到了[相同的来源策略](https://developer.mozilla.org/en/Same_origin_policy_for_JavaScript)。您看不到具有不同源域的框架的位置（或任何其他属性）。

但是，您可以查看自己的`document.referrer`. 如果您被陷害，那么引用者应该是包含框架的 URL。

```
if (window.self != window.top && document.referrer.indexOf('getweb') > 0 ) {
  top.location.replace(window.location.pathname);
} 
```

这不是防弹的。例如，框架站点可以使用中介（如 netvibes）。然而，他们停止构筑您朋友的网站可能会很烦人。

# asp.net - 在 VB.Net Web 应用程序中使用 SubSonic

> ID：880133
> 
> 赞同：3
> 
> 时间：2009-05-18T22:33:10.793
> 
> 标签：asp.net, vb.net, subsonic

我第一次在 VB.net 应用程序中使用 Subonic（我已经在网站项目中成功使用过很多次）。我按照“入门”视频的第二部分实际生成了 DAL 源文件，而不是生成提供程序方法，并且一切似乎都像预期的那样。但是，我所做的任何事情都不会让我生成的命名空间出现。我觉得这与我在 VB.Net 中运行我的 Web 应用程序和在 C# 中生成 Subsonic 的事实有关。

这是我遵循的过程：

1) 我在 Visual Studio 中创建了一个空白的 Web 应用程序项目 2) 我将 web.config 配置为具有必要的部分、连接字符串等。 3) 我运行了 subcommander，它生成了我需要的所有类到一个名为 DAL 的文件夹中。4) 我构建了 Web 应用程序项目 5) 我在后面打开了一个代码，输入了“Imports”，但我没有看到生成的命名空间。

我什至打开了实际的 Subsonic 源文件，看到我配置的生成的命名空间有一个命名空间语句。我试图简单地将亚音速文件移动到一个单独的类库项目中，编译 .dll 并在我的项目中使用它，但它仍然不起作用。

有人对我可能做错了什么有任何想法吗？

谢谢，

麦克风

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T22:43:40.307

当然，

我发布问题的那一刻，我就能找到答案。诀窍是当您在 SubCommander 中生成 DAL 时，您必须指定 /lang vb 参数。我的最终参数列表如下所示：

生成 /out DAL /lang vb

然后它给了我我在 VB.net 中的 DAL 代码，它适用于我所拥有的一切。

麦克风

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T11:50:25.297

我已经做过很多次了。我的命令行是：

```
generate /out Classes\DAL /lang vb 
```

# java - 在图中查找“连接的组件”

> ID：880135
> 
> 赞同：0
> 
> 时间：2009-05-18T22:35:03.757
> 
> 标签：java, hashmap, graph-traversal

我正在构建一个词库，使用 a`HashMap <String,ArrayList<String>>`来保存单词及其同义词（需要此数据结构）。

为了分配的目的，同义关系被认为是传递的。（我们可以把词库想象成一个图表）。我想要完成的是在一个文本文件中打印这个图，每行都有一个连接的组件。换句话说，所有可以合并为同义词的单词都应该放在一行中。

```
public void save() {
    try {
        FileWriter fw = new FileWriter(defaultDefinitionFile);
        BufferedWriter out = new BufferedWriter(fw);
        Set<String> keys = thesaurus.keySet();
        Iterator<String> ite = keys.iterator();
        while (ite.hasNext()) {
            String key = ite.next();
            out.write(key);
            ArrayList<String> synonyms = thesaurus.get(key);
            Iterator<String> i = synonyms.iterator();
            while (i.hasNext()) {
                String syn = i.next();
                out.write(","+syn);
                keys.remove(syn);
            }
            out.write("\r\n");
        }
        out.close();
        fw.close();
    }
    catch (Exception e) {
        System.out.println("Error writing to file");
        e.printStackTrace();
    }
} 
```

这就是我想象它发生的方式：

打印一个单词及其每个同义词，然后从数据结构中删除这些同义词，这样我们就没有重复的行。

问题当然是我在迭代哈希图的内容时无法删除任何内容。

我缺少任何替代方法吗？

PS我一直保留“图表”的隐喻只是因为我需要标题雄辩而简洁。我知道这个比喻的用处有限。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T22:40:51.327

您可以将打印的单词存储在[Set](http://java.sun.com/javase/6/docs/api/java/util/Set.html)中，然后只处理尚未在集合中的单词。

*旁注*：尽管确实可以将其视为图形问题，但您的代码并未将其视为这样。如果我们将其视为一个图问题，那么我们就不会假设每个单词都有其所有同义词列在相应的 中`ArrayList`，因此需要计算对称和传递闭包。只有这样我们才能提取等价类。

（实际上，同义词关系不是及物的，我知道。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T22:41:05.177

我不认为这个（你的一般想法）会起作用，因为“同义性”不是传递属性。

有很多词的同义词本身不是同义词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T22:41:18.860

不要删除该项目，而是将其添加到要忽略的项目列表中。

# hash - 如何在 D 中唯一标识用户定义的类型？

> ID：880141
> 
> 赞同：3
> 
> 时间：2009-05-18T22:39:06.617
> 
> 标签：hash, metaprogramming, d

我需要生成可以用作[D 编程语言](http://digitalmars.com/d/1.0/index.html)中用户定义类型（结构或类）的唯一句柄的东西。最好这将是一个编译时可计算值。我希望句柄与类型的名称相关，并在类型的内部结构（数据布局）发生变化时进行更改，但对于大多数其他编辑（包括将相同类型编译到不同的应用程序）保持不变。

这不是一个安全的事情，所以它不需要很难绕过或任何东西

我目前的想法是使用带有类型名称和成员类型和名称的 MD5 哈希之类的字符串。

有什么想法吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T03:32:20.537

考虑了一会儿，我认为这将是一种可行的方法（注意：这只是伪代码）：

```
UniqueId(Type) = Type.stringof ~ MemberIds!(Type.tupleof)

UniqueId(Type) if( Type is builtin ) = Type.stringof

MemberIds(M, Ms...) = "," ~ UniqueId!(typeof(M))
                      ~ "@" ~ ToString!(M.offsetof)
                      ~ ":" ~ M.stringof
                      ~ MemberIds!(Ms) 
```

也就是说，从类型的名称（您可能需要去掉模块和包，不确定）以及每个成员的类型的 ID、偏移量和名称构造唯一 ID。

根据您想要的内容，您可以删除成员名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T11:13:55.820

类型的完全限定名称应该是唯一的。这与 typeid(T).toString 相同。这与*T.stringof*不同——T.stringof 将删除任何模板实例，并且不会给出完全限定的名称。

解决方法是在编译时使用 demangled(T.mangleof) 并在运行时使用 typeid(T).toString。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T22:49:32.290

typeid[表达式](http://www.digitalmars.com/d/1.0/expression.html#typeidexpression)将返回 TypeInfo 对象的唯一实例。理论上，您应该能够使用 TypeInfo 对象的地址作为类型的唯一标识符值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T00:28:50.500

您知道，您可以将修订硬编码到类型中，例如“const REV = 173;”，然后在每次更改布局时更新它，然后将其与类型名称混合以生成您的标识符。

这有点麻烦，因为它需要手动更新，但是您可以编写脚本，以便在 svn diff 识别到该类中的更改时在提交时自动更新。这可能是最简单的解决方案。

# css - CSS 中的@page 是什么？

> ID：880146
> 
> 赞同：4
> 
> 时间：2009-05-18T22:39:42.247
> 
> 标签：css

我正在创建一个 epub 文件，并试图了解电子书的示例 css：

```
@page {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
} 
```

有什么`@page`规律？我在我的书或 Google 中找不到它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T22:44:41.193

@page 描述了您的文档在基于页面的媒体（如打印）上的行为方式。这应该清除它： [http ://www.w3.org/TR/CSS21/page.html](http://www.w3.org/TR/CSS21/page.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T22:44:10.960

页面框是一个包含两个区域的矩形区域：

*   页面区域。该区域包括该页面上布置的框。页面区域的边缘充当在分页符之间发生的布局的初始包含块。
*   页边距区域，围绕页面区域。

我们在@page 规则中指定页面框的大小、边距等。

页面框的大小由 size 属性设置。页面区域的大小是页面框的大小减去边距区域。

[根据 w3c 学校的链接](http://www.w3schools.com/css/pr_print_size.asp)

# php - 为什么速记 PHP 开场白不起作用？

> ID：880150
> 
> 赞同：2
> 
> 时间：2009-05-18T22:40:10.983
> 
> 标签：php, php-shorttags

我正在尝试将我的 Mac 设置为 php 服务器，但是，到目前为止，我已经取得了成功，但我似乎遇到了一些麻烦。

我的 PHP 开头语句不起作用......但只有速记的。

这有效：

```
<?php 
  phpinfo();
?> 
```

这不会：

```
<?
  phpinfo();
?> 
```

这是 Mac 10.5。希望有人能提供帮助。

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-18T22:42:12.947

在您的 php.ini 中，将[short_open_tag](http://ie.php.net/manual/en/ini.core.php#ini.short-open-tag)设置为 On。

```
short_open_tag = On 
```

从文档：

> short_open_tag 布尔值
> 
> `<? ?>`指示是否应允许 PHP 的 open 标记的缩写形式 ( )。如果您想将 PHP 与 XML 结合使用，您可以禁用此选项以使用`<?xml ?>` 内联。否则，您可以使用 PHP 打印它，例如：`<?php echo '<?xml version="1.0"'; ?>`. 此外，如果禁用，您必须使用 PHP 开放标记 ( `<?php ?>`) 的长格式。

编辑：

`short_open_tag`从 5.3.0 开始是[PHP_INI_ALL](http://www.php.net/manual/en/ini.list.php)，这意味着它可以在任何地方更改（php.ini、.htaccess、在脚本中）。而且5.3.0之前是PHP_INI_PERDIR，也就是说可以在php.ini和.htaccess中设置。因此，在大多数情况下，即使您不控制服务器，您也可以更改其值。

但是，此设置默认为关闭。如果您要分发您的脚本，那么它不适用于大多数开箱即用的安装。在这种情况下，切换到搜索/替换`<?php`是个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T22:43:16.860

检查您的 php.ini 文件是否包含该[`short_open_tag=1`](http://php.net/manual/es/ini.core.php)行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T22:44:04.470

您是否确认`short_open_tag`（请参阅[此处](http://de2.php.net/manual/en/ini.core.php)）在您的 php.ini 中启用？

# css - 输入背景颜色会破坏样式？

> ID：880152
> 
> 赞同：21
> 
> 时间：2009-05-18T22:40:41.293
> 
> 标签：css, browser

我正在创建一个在[jQuery Validation](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)下验证的表单。我想将浅红色背景颜色应用于无效且需要更正的输入。

当我应用`background-color: #FFCCCC;`到输入时，有吸引力的样式似乎被删除了，而硬边框取代了它。例如，在 Firefox 中输入文本：

[有样式和无样式的文本输入 http://liranuna.com/strager/b/textbox-difference.png](http://liranuna.com/strager/b/textbox-difference.png)
（[现场演示](http://jsbin.com/ipojo)）

这发生在几个浏览器上。如果我设置`background`除`#FFFFFF`.

有没有办法在应用背景颜色时保留样式？

*我对以某种方式模拟这种风格的 Javascript 解决方案持开放态度。*

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-18T23:32:04.000

抱歉 - 输入元素上的任何样式都会破坏它们的操作系统/浏览器默认值。默认输入以完全不同的方式呈现 - 不幸的是，它们不像 CSS 样式那样被编码到浏览器中。

最好的办法是，不要试图让你的红色背景输入模仿正常的输入，而是创建你自己有吸引力的样式！如果您喜欢那些浅色边框，请使用`border: 1px #ccc solid`. 如果您喜欢圆角，请利用`border-radius`和`-moz-border-radius`- 对于那些处于浏览器开发边缘的人来说，他们将拥有它们。对于那些不是，他们不会注意到差异。

简而言之，不要试图让输入适合操作系统环境，而是根据您自己网站的外观和感觉来设置它们的样式。这将为您的网站整体创造更好的设计:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T22:57:31.900

我想说控件的默认（Windows 2000）外观对于浏览器供应商来说更容易实现。浏览器必须自己绘制所有内容，包括任何控件。它们在默认样式中看起来是原生的，这对用户来说只是一点点方便，但如果没有像 WPF 这样真正花哨（和重量级）的东西，使用 OS*和*CSS 的视觉样式正确绘制控件很快就会变得笨拙。

确切的样式还取决于操作系统，因此为您提供准确外观的解决方案可能不是您网站的大多数访问者想要的。再说一次，仅使用 CSS 您可以实现 The One Look™。如果这恰好看起来像特定操作系统上的原生操作系统，那么就这样吧:-)

您正在寻找的内容可能会通过使用浅灰色边框和悬停/聚焦浅蓝色边框来模拟一点，模拟 Vista 和 Windows 7 的 Aero 外观。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T22:49:12.870

此处浏览器使用其默认样式。

我建议在两个输入中添加类似以下 CSS 的内容，然后它们看起来会保持一致。

```
border: solid 1px #ccc; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T23:13:24.053

**简短的回答：没有。**

浏览器和表单控件无疑是 CSS 中最不一致的部分。我只能建议在输入字段上使用 1px 边框，因为大多数浏览器都使用类似的东西。CSS3 圆角也应该在一些浏览器中工作。

```
input.text {
  border: 1px solid #ccc;
  background-color: #fcc;
  border-radius: 4px;
  -moz-border-radius: 4px;
} 
```

您会发现[位于 456 Berea Street 的这个页面](http://www.456bereastreet.com/lab/styling-form-controls-revisited/text-input-single/)很有趣。它展示了每个浏览器如何在文本框上应用不同的样式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T22:44:18.683

查看普通输入字段的边框样式。并将其应用于错误之一。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T22:48:37.800

将您的 HTML 更改为如下所示：

```
<p><input type="text" value="text" style="border:1px solid #999999;" /></p> 
<p><input type="text" value="text" style="background-color: #FFDDDD;border:1px solid #999999;" /></p> 
```

**编辑**：如果您希望它在所有浏览器中看起来一致，而不仅仅是在 Mozilla 中略微圆润，那么您将不得不做更多的工作。 [这是一个链接](http://www.cssportal.com/form-elements/text-box.htm)，它将向您展示如何完全覆盖文本框样式。

# python - 查看目录中列出的属性和方法列表时，您如何知道哪些是属性，哪些是方法？

> ID：880160
> 
> 赞同：5
> 
> 时间：2009-05-18T22:42:38.577
> 
> 标签：python, attributes, methods, python-datamodel

我正在努力学习用 Python 编程，并专注于更好地处理如何使用标准和其他模块。dir 函数在解释器中似乎非常强大，但我想知道我是否因为缺乏 OOP 背景而遗漏了什么。使用 S.Lotts 的书，我决定使用他的 Die 类来学习更多关于语法以及类和实例的使用。

这是原始代码：

```
class Die(object):
''' simulate a six-sided die '''
def roll(self):
    self.value=random.randrange(1,7)
    return self.value
def getValue(self):
    return self.value 
```

我正在查看它，在创建了一些实例之后，我想知道单词 value 是否是关键字，以及 class 语句中单词 object 的用途是什么，因此我决定通过将类定义更改为以下内容来找出答案：

```
class Die():
''' simulate a six-sided die '''
def roll(self):
    self.ban=random.randrange(1,7)
    return self.ban
def getValue(self):
    return self.ban 
```

这种变化表明我从我的实例中得到了相同的行为，但是当我执行 dir 时，实例中缺少以下方法/属性：

```
'__class__', '__delattr__', '__dict__', '__doc__', '__getattribute__',
 '__hash__', '__init__', '__module__', '__new__', '__reduce__', '__reduce_ex__',
_repr__', '__setattr__', '__str__', '__weakref__' 
```

我还发现当我在一个实例上做一个目录时，我有一个额外的关键字**ban**，我最终发现它是我实例的一个属性。这帮助我了解我可以使用**d1.ban**来访问我的实例的值。我能弄清楚这是一个属性的唯一原因是我输入了**d1.happy**并得到了一个**AttributeError** 我发现**d1.GetValue**是一个附加到 Die 的方法，因为这是解释器告诉我的。

因此，当我尝试使用诸如 BeautifulSoup 之类的复杂但有用的模块时，在键入**dir(instance)**后，我如何知道列出的哪些内容是我的实例的属性或我的实例的方法。我需要知道这一点，因为这种探索告诉我，我使用属性调用方法的结果，使用方法调用实例上的函数。

这个问题可能太罗嗦了，但它确实帮助我更好地理解了属性和方法之间的区别。具体来说，当我查看在 Die 类的实例上调用 dir 的结果时，我看到了这个

```
['__doc__', '__module__', 'ban', 'getValue', 'roll'] 
```

因此，通过查看该列表来了解哪些是属性和哪些是方法似乎很有用，而不必诉诸试验和错误或导致输入**hasattr(myInstance,suspectedAttributeName)**。

发布问题后，我尝试了

```
for each in dir(d1):
    print hasattr(d1,each) 
```

严格来说，它告诉我所有方法都是属性。但我不能调用没有**()**的方法，所以在我看来 hasattr() 具有误导性。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-18T23:16:17.697

而不是：“ `print hasattr(d1,each)`”，尝试：“ `print each, type(getattr(d1,each))`”。您应该会发现结果信息丰富。

此外，代替`dir()`try `help()`，我认为你真的在寻找。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T04:25:07.587

考虑使用标准库的`inspect`模块——它通常是最方便的自省方法，将大量功能打包（你可以从头开始实现它，但重用经过良好测试、精心设计的代码是一件好事）。有关所有详细信息，请参阅[http://docs.python.org/library/inspect.html](http://docs.python.org/library/inspect.html)，但例如`inspect.getmembers(foo, inspect.ismethod)`是获取 foo 的所有方法的好方法（您将获得`(name, value)`按名称排序的对）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T23:07:30.070

> 严格来说，它告诉我所有方法都是属性。但我不能调用没有 () 的方法，所以在我看来 hasattr() 具有误导性。

为什么会误导？如果`obj.ban()`是一个方法，那么`obj.ban`就是对应的属性。你可以有这样的代码：

```
print obj.getValue() 
```

或者

```
get = obj.getValue
print get() 
```

如果你想获取一个对象的方法列表，你可以试试这个函数。这并不完美，因为它也会触发不是方法的可调用属性，但对于 99% 的情况应该足够好：

```
def methods(obj):
    attrs = (getattr(obj, n) for n in dir(obj))
    return [a for a in attrs if a.hasattr("__call__")] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T18:40:25.170

这个`info`受 Dive into Python 启发的模块可以达到目的。

```
def info(obj, spacing=20, collapse=1, variables=False):
    '''Print methods and their doc Strings

    Takes any object'''
    if variables:
    methodList = [method for method in dir(obj)]
    else:
    methodList = [method for method in dir(obj) if callable(getattr(obj,method))]

    #print methodList

    print '\n'.join(['%s %s' %
            (method.ljust(spacing),
             " ".join(str(getattr(obj,method).__doc__).split()))
            for method in methodList])

if __name__=='__main__':
    info(list) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T23:08:30.223

理想情况下，当使用像 BeautifulSoup 这样的复杂库时，您应该查阅其文档以了解每个类提供了哪些方法。但是，在您没有易于访问的文档的极少数情况下，您可以使用以下方法检查是否存在方法。

所有本身是对象的方法都实现了该`__call__`方法，并且可以使用返回的 callable() 方法`True`进行检查，如果被检查的值具有该`__call__`方法。

以下代码应该可以工作。

```
x = Die()
x.roll()

for attribute in dir(x) :
    print attribute, callable(getattr(x, attribute)) 
```

上面的代码将对所有方法返回 true，对所有不可调用的属性（例如数据成员，如 ban）返回 false。但是，此方法也返回`True`任何可调用对象（如内部类）。您还可以检查属性的类型是否为`instancemethod`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T23:09:17.260

有一个内置的方法叫做 callable。您可以将它应用于任何对象，它会根据是否可以调用它返回 True/False。例如

```
>>> def foo():
...   print "This is the only function now"
...
>>> localDictionary = dir()
>>> for item in localDictionary:
...   print repr(item) + "is callable: " + str(callable(locals()[item]))
'__builtins__'is callable: False
'__doc__'is callable: False
'__name__'is callable: False
'foo'is callable: True 
```

请注意 locals() 调用将返回一个字典，其中包含当前范围内定义的所有内容。我这样做是因为字典中的项目只是字符串，我们需要在实际对象上运行 callable。

# java - java的崩溃报告

> ID：880179
> 
> 赞同：7
> 
> 时间：2009-05-18T22:49:15.817
> 
> 标签：java, reporting-services, crash

你知道任何好的 Java 崩溃报告系统或任何使用崩溃报告系统的开源项目吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T09:11:26.983

从简单开始 如果您想在 Java Swing 应用程序中向用户报告错误和异常，那么[zeus-jscl](http://sourceforge.net/projects/zeus-jscl/)是一个不错的库，它有几个有用的组件：

**gr.zeus.ui.JMessage** - 显示简单消息和异常堆栈跟踪以及更多 **gr.zeus.ui.JConsolePane** - 用于替换命令行窗口的 java 控制台。重定向标准输出和标准错误等。

这只是在本地方便地发送到任何地方。

所有这些让我想到了如何处理在野外发生的未经处理的异常。NetBeans 会弹出这个小对话框并要求您发送报告。一旦你发送它，它几乎是神奇的，报告被排队，分析，与新报告或现有报告相关联，最后通用报告与 IssueZilla 中的问题相关联，这一切都是自动完成的。如果问题得到解决，它甚至会告诉您它已在哪个版本中得到修复，无论是否即将到来。从[这里](http://codepimpsdotorg.blogspot.com/2008/08/netbeans-exception-reporting.html)

您可以下载 NetBeans 的源代码并抄袭您需要的内容。[在这里阅读如何](http://www.netbeans.org/community/sources/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T19:18:50.233

故障转储只是一个文本文件。您可以编写一个脚本来重复运行您的问题并通过邮件向您/通知您任何新的故障转储。

# wcf - WCFTestClient 是否有任何替代方案

> ID：880185
> 
> 赞同：7
> 
> 时间：2009-05-18T22:51:36.203
> 
> 标签：wcf

WCFTestClient 是否有任何开源（或没有）替代品？

WCFTestClient 有很多限制，使其难以使用（例如，它不支持实体框架对象）。

所以我想看看是否还有其他可能更好（甚至不同）的东西。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-19T00:13:21.513

[WCF Storm](http://www.wcfstorm.com/wcf/default.aspx)或开源[Storm](http://www.codeplex.com/storm)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-19T00:04:04.123

我更喜欢创建实际的单元测试来测试我编写的服务器。这个想法是它们可以经常重新运行。

你也可以试试[soapUI](http://soapUI.org)。

# visual-studio-2008 - 选择哪一个？DXCore、Resharper 还是 VSX？

> ID：880186
> 
> 赞同：5
> 
> 时间：2009-05-18T22:53:24.077
> 
> 标签：visual-studio-2008, resharper, vsx, visual-studio-addins, dxcore

我想编写一个 Visual Studio 插件来为我做一些代码修改（比如一些特定的重构）。我想知道我应该使用这些工具中的哪一个，为什么？

我们有 resharper 的许可证，另外两个是免费的，这是一个内部使用的软件，所以我们不需要担心许可证问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-08-22T18:34:30.430

我只使用过 DXCore，但我不得不说它非常棒。

我自己和其他开发人员已经通过这个非常强大的框架取得了很多成就

我提交了我们的[社区网站](http://code.google.com/p/dxcorecommunityplugins/)作为这方面的证据。

DevExpress 在回答有关框架的特定用途的问题时非常有帮助，并且在许多情况下，增强它以为基于它编写插件的人提供额外的功能。

[我已经在我的博客](http://rorybecker.blogspot.com/)上写了很多关于创建此类插件的文章，并且我正在努力使[社区网站上的这个页面](http://code.google.com/p/dxcorecommunityplugins/wiki/PluginResources)保持最新，并提供指向 Internet 上多个页面的链接，其中包含教程和完整工作的示例。

我还打算继续在我​​的博客上编写有关该主题的教程，因此随着时间的推移，这应该会成为更好的资源。

使用 DXCore 编写重构非常容易，因为它具有极其全面的对象模型。

[我也很高兴通过http://twitter.com/RoryBecker](http://twitter.com/RoryBecker)或电子邮件（G Mail dot Com 的 Rory Becker ）回答有关 DXCore（和 Coderush/RefactorPro）主题的问题

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T00:10:49.380

虽然我看过 ReSharper，但我并没有使用太多。我使用过 DXCore，我喜欢他们所做的。[VSX](http://msdn.microsoft.com/en-us/vsx/default.aspx)看起来很有希望，尤其是在[VS2010中使用](http://www.microsoft.com/visualstudio/en-us/products/2010/default.mspx)[MEF](http://www.codeplex.com/MEF)。

如果您要面向更广泛的受众，我会说 VSX。但由于这是您组织内部的，我会选择[DXCore](http://www.devexpress.com/Products/Visual_Studio_Add-in/DXCore/)。

更多 DXCore[信息在这里](http://www.devexpress.com/Support/Center/kb/p/K18142.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-22T18:55:42.150

我建议您使用您最熟悉其 API 的框架。如果你需要做一些复杂的事情（比如解析代码，眼睛糖果效果）你不想使用 VSX - 这会花费太多时间。

如果您没有偏好，我建议您使用 DXCore，主要是因为它的 API 可以快速学习，尽管在文档方面还有很多需要改进的地方，您有一些[示例项目](http://code.google.com/p/dxcorecommunityplugins/)以及一个非常支持的社区。每当我需要发现如何做某事时，我需要做的就是在[DXcore 插件论坛](http://community.devexpress.com/forums/181.aspx)上询问它，我的问题很快就得到了回答。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T00:01:10.167

如果您已经充分了解 ReSharper API 可以使用它进行有用的工作，那么您应该将您的知识卖给出价最高的人。他们一直承诺为过去三个主要版本提供文档。

# python - 如何从 django 中的文本输入中去除 html/javascript

> ID：880188
> 
> 赞同：87
> 
> 时间：2009-05-18T22:53:47.510
> 
> 标签：python, django

从字符串中删除所有 html/javascript 的最简单方法是什么？

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2009-05-18T23:15:37.853

Django 提供了一个实用函数来删除 HTML 标签：

```
from django.utils.html import strip_tags

my_string = '<div>Hello, world</div>'
my_string = strip_tags(my_string)
print(my_string)
# Result will be "Hello, world" without the <div> elements 
```

这个函数在旧的 Django 版本（1.7 之前）上曾经是不安全的，但现在使用它是**完全安全**的。[这是](https://www.mehmetince.net/django-strip_tags-bypass-vulnerability-exploit/)一篇文章，它在相关时审查了这个问题。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-05-18T23:04:13.853

striptags模板过滤器[。](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#striptags)

```
{{ value|striptags }} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-05-21T00:39:13.540

姜戈 3

```
{{ the_value | striptags | safe | escape }} 
```

# iphone - 当我的 UITableView 还没有数据时，如何显示占位符图像？

> ID：880189
> 
> 赞同：1
> 
> 时间：2009-05-18T22:54:08.037
> 
> 标签：iphone, uinavigationcontroller, uitableview

我有一个应用程序，在加载时会显示一个 UITableView，其中包含用户的数据。

但是，当用户*第一次*加载应用程序时（在他们创建任何数据之前），我想显示背景图像而不是空表（带有指向“添加记录”导航栏按钮的箭头） . 一旦用户添加了他们的第一条记录，就会显示 tableview。我已经看到很多应用程序都这样做了——我目前能想到的唯一例子是 Cha-Ching，在你设置任何预算/等之前。不过，我一生都无法弄清楚如何做到这一点。

我最初在主窗口的 xib 中添加了一个 navigationcontroller，它的 rootViewController 是一个自定义的 viewcontroller/xib。这个 rootViewController 包含背景图像，上面有一个隐藏的 tableview，以及一个管理 tableview 的自定义 tableviewcontroller。这似乎工作得很好，如果有数据，它将加载并显示在表格中。但是，如果我将数据滚动到屏幕外，应用程序会崩溃，并出现以下错误：

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason:
'*** -[UITextEffectsWindow tableView:cellForRowAtIndexPath:]: unrecognized selector sent to instance 0xd2d130' 
```

我不知道 UITextEffectsWindow 是什么，也不知道它为什么要管理我的 tableview。我认为在我的视图层次结构中可能会错误地连接某些东西......

如果有更简单/更直接的方法可以做到这一点，如果有人能解释一下，我将不胜感激。你会怎么做？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T23:33:39.050

到目前为止，这是我满意的一种解决方案。

首先，我创建了一个与我的 TableView 大小相同的透明视图。每当 TableView 的数据源中没有数据时，我都会将此视图添加为 TableView 的同级。当数据可用时，我完全删除了视图，因为透明度会影响 TableViews 滚动动画的平滑度。

我只是在这个视图中添加了一个透明标签，它说明了“无可用数据”的效果。给这个标签添加一点阴影确实有助于强化标签“浮动”在空 TableView 之上的概念。

我喜欢你使用图像的方法。做得好，如果您不必像我目前那样本地化字符串，它可能会为您节省一些工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-04T02:48:49.503

为了实现这一点，我使用 UITableViewController 子类作为我唯一的视图（根据 Apple 模板在 UINavigationController 内），我使用了以下方法：

1.  在包含您的 UITableViewController 和 tableView 的 XIB 中创建一个与我的 tableView 大小相同的 UIView。

2.  将带有我的占位符图像的 ImageView 集添加到 UIView。

3.  将 UIView 连接为 IBOutlet（在下面的示例代码中，我将其称为 emptyTableView）

4.  何时从 UITableViewController 子类中显示占位符：

    [self.tableView addSubView:emptyTableView]; [self.tableView setScrollEnabled:FALSE];

禁用滚动是必要的，否则用户将能够上下移动占位符图像。只要记住在用户添加项目后启用它。

5.  删除图像视图

    [emptyTableView removeFromSuperview];

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-08T19:30:49.067

为此，我使用以下控制器而不是`UITableViewController`. 它会在表格为空时自动在表格上放置一个视图，并在表格填满时将其删除。

只需调用`[self reloadData]`而不是，`[self.tableView reloadData]`以便它可以检查表是否为空。

在您的子类中，实现一个`makeEmptyOverlayView`函数，该函数将创建视图以显示在一个空表上。

```
@interface MyTableViewController : UITableViewController
{
      BOOL hasAppeared;
      BOOL scrollWasEnabled;
      UIView *emptyOverlay;
}

- (void) reloadData;
- (void) checkEmpty;

@end

@implementation MyTableViewController

- (void)viewWillAppear:(BOOL)animated
{
   [self reloadData];
   [super viewWillAppear: animated];
}

- (void)viewDidAppear:(BOOL)animated
{
   hasAppeared = YES;

   [super viewDidAppear: animated];

   [self checkEmpty];
}

- (void)viewDidUnload
{
   if (emptyOverlay)
   {
      self.tableView.scrollEnabled = scrollWasEnabled;
      [emptyOverlay removeFromSuperview];
      emptyOverlay = nil;
   }
}

- (void) reloadData
{
   [self.tableView reloadData];

   if (hasAppeared &&
       [self respondsToSelector: @selector(makeEmptyOverlayView)])
      [self checkEmpty];
}

- (void) checkEmpty
{
   BOOL isEmpty(YES);

   id<UITableViewDataSource> src(self.tableView.dataSource);
   NSInteger sections(1);
   if ([src respondsToSelector: @selector(numberOfSectionsInTableView:)])
      sections = [src numberOfSectionsInTableView: self.tableView];
   for (int i(0); i<sections; ++i)
   {
      NSInteger rows([src tableView: self.tableView numberOfRowsInSection: i]);
      if (rows)
         isEmpty = NO;
   }

   if (!isEmpty != !emptyOverlay)
   {
      if (isEmpty)
      {
         scrollWasEnabled = self.tableView.scrollEnabled;
         self.tableView.scrollEnabled = NO;
         emptyOverlay = [self makeEmptyOverlayView];
         [self.tableView addSubview: emptyOverlay];
         [emptyOverlay release];
      }
      else
      {
         self.tableView.scrollEnabled = scrollWasEnabled;
         [emptyOverlay removeFromSuperview];
         emptyOverlay = nil;
      }
   }
   else if (isEmpty)
   {
      // Make sure it is still above all siblings.
      [emptyOverlay retain];
      [emptyOverlay removeFromSuperview];
      [self.tableView addSubview: emptyOverlay];
      [emptyOverlay release];
   }
}

@end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T23:52:24.443

如果您使用[Three20](http://github.com/joehewitt/three20/tree/master)，您可以在填充表格之前轻松地将任何您想要的图像设置为占位符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T12:09:05.537

所以，为了解决这个问题，我按照上面评论中的讨论做了：

我创建了一个普通的 UIViewController 子类，其中包含一个 UIImageView 和一个 UITableView。viewController 符合 UITableViewDelegate 和 UITableViewDatasource 协议，负责管理 tableView。viewController 类只是根据数据是否可用来显示或隐藏 imageView。

我之前尝试使用 UITableViewController 管理这两个视图时出错了。UITableViewController 必须有一个 tableView 作为它的视图，而在这个解决方案中，一个 viewController 可以包含图像和 tableView，并实现必要的协议来管理 tableView。

感谢所有的帮助！

# client-server - 客户端意外关闭

> ID：880191
> 
> 赞同：-1
> 
> 时间：2009-05-18T22:54:21.843
> 
> 标签：client-server, transactions

我正在开发一个 .net 富客户端服务器应用程序，客户端通过 Web 服务调用服务器，如果客户端在调用服务器时突然关闭（连接关闭）会发生什么情况？服务器能检测到这个吗？如果客户端正在提交将一组数据持久化到服务器数据库的请求，事务还会运行吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T22:58:37.513

试试看。拨打网络服务电话，然后拔下您的互联网电缆。

# asp.net - asp.net 会话状态

> ID：880192
> 
> 赞同：1
> 
> 时间：2009-05-18T22:54:25.307
> 
> 标签：asp.net, session

在会话开始期间，可以访问请求对象。Session End 怎么样，它仍然可以访问 Request 对象吗？例如，我想计算当前连接到我的应用程序的浏览器数量。

编辑 1：如果 Session End 无权访问请求对象，它可以访问什么信息？会话 ID 等？

编辑 2：如果 Session End 不能用于跟踪断开连接，如何在 ASP.Net 中跟踪断开连接？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T23:17:56.170

如果使用 InProc，Session_End 将被触发。

Session_End 将在 1) 不活动 n 分钟后触发（n = 超时值），或 2) 如果有人调用 Session.Abandon()

如果关闭浏览器，Session_End 不会被触发。

Session_End 需要设置会话状态。

如果需要原始 Request.Browser 数据，则应将其保存在 Session State 中。

在 Session_End 期间，它可以访问 Session State。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T23:02:05.340

不，Request 对象在 Session End 中不可用。

还要注意 Session End 仅在您从代码中调用 Session.Abandon() 时触发，而不是在 Session 由于自然超时或您有什么而过期时触发。因此，它不是用于跟踪断开连接的可靠方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T23:30:15.190

从[文档](http://msdn.microsoft.com/en-us/library/ms524689.aspx)

> **Session_OnEnd**事件在会话被放弃或超时时发生。在服务器内置对象中，只有应用程序对象、服务器对象和会话对象对象可用。
> 
> **评论**
> 
> 您不能在 Session_OnEnd 脚本中调用 Server.MapPath 方法。默认情况下，Session_OnEnd 作为应用程序定义的匿名用户运行。如果没有匿名用户，或者匿名用户登录失败，则不会调用 OnEnd 函数，并且会记录一个事件。

# maven-2 - maven不仅可以签名生成的jar，还可以签名依赖

> ID：880193
> 
> 赞同：9
> 
> 时间：2009-05-18T22:54:27.197
> 
> 标签：maven-2, jar, sign

我设法创建了主 jar，将依赖项复制到一个目录，剩下的唯一步骤就是签署所有 jar。

我可以将自己生成的 jar 签名作为 jar:sign 的一部分，但我如何签署依赖项？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T06:48:21.537

这里有几个选项：

1.  使用 Maven ant 任务从 JDK 中针对所有依赖项运行 jarsigner。
2.  使用可以签署所有 JAR 的[webstart 插件](http://www.mojohaus.org/webstart/webstart-maven-plugin/)，即使您没有将它用于 JNLP 化您的应用程序。我正在使用它来实际 JNLPize 一个应用程序。
3.  看看 webstart 插件源正在做什么来迭代所有依赖项并对其进行签名并启动一个新的 Maven 插件/Mojo，它做同样的事情，没有 JNLP。
4.  [Onejar 您的应用程序及其依赖项](http://code.google.com/p/onejar-maven-plugin/)，然后签名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-06T18:39:40.183

添加到插件配置`<archiveDirectory>target</archiveDirectory>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-29T18:48:21.353

如果您正在使用`maven-jar-plugin`，则可以使用“jarPath”设置指定要签名的*单个jar。*以下配置会导致对 jar-with-dependencies 文件进行签名，*而不是*对无依赖项的 jar 文件进行签名：

```
<plugin>
    <artifactId>maven-jar-plugin</artifactId>
    <executions>
      <execution>
        <goals>
          <goal>sign</goal>
        </goals>
      </execution>
      <execution>
        <id>make-assembly</id>
        <phase>package</phase>
        <goals>
          <goal>sign</goal>
        </goals>
      </execution>
    </executions>
    <configuration>
      <!-- NOTE: The secret key is in shared version control.  The
           password is in shared version control.  This IS NOT
           SECURE.  It's intended to help avoid accidentally
           loading the wrong class, nothing more. -->
      <jarPath>${project.build.directory}/${project.build.FinalName}-${project.packaging}-with-dependencies.${project.packaging}</jarPath>
      <keystore>${basedir}/keystore</keystore>
      <alias>SharedSecret</alias>
      <storepass>FOO</storepass>
    </configuration>
  </plugin> 
```

如果您想同时签署两者，我不知道如何使用`maven-jar-plugin`，因此您可能需要查看上面提到的其他选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T20:58:07.870

还可以使用 maven-assembly-plugin 创建单个 JAR。

连同 Eric Anderson 的另一个建议（签署另一个 JAR），然后可以签署这个组装好的 JAR（而不是原始 JAR）。请注意，插件定义的顺序在这里很重要。

假设 sign.keystore.file 等设置在别处（例如在配置文件中）。

```
<build>
    <plugins>
        <!-- It seems that maven-assembly-plugin must be declared before the maven-jar-plugin,
             so that it is executed first in the package phase,
             and then the signing of the packaged jar can succeed. -->
        <plugin>
            <artifactId>maven-assembly-plugin</artifactId>
            <version>2.4</version>
            <configuration>
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                </descriptorRefs>
                <archive>
                    <manifestEntries>
                        <!-- ... -->
                    </manifestEntries>
                </archive>
            </configuration>
            <executions>
                <execution>
                    <id>make-assembly</id>
                    <phase>package</phase>
                    <goals>
                        <goal>single</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>2.4</version>
            <executions>
                <execution>
                    <goals>
                        <goal>jar</goal>
                    </goals>
                </execution>
                <execution>
                    <id>make-assembly</id>
                    <phase>package</phase>
                    <goals>
                        <goal>sign</goal>
                    </goals>
                    <configuration>
                        <jarPath>${project.build.directory}/${project.build.FinalName}-${project.packaging}-with-dependencies.${project.packaging}</jarPath>
                        <keystore>${sign.keystore.file}</keystore>
                        <type>${sign.keystore.type}</type>
                        <storepass>${sign.keystore.storepass}</storepass>
                        <alias>${sign.keystore.alias}</alias>
                        <verify>true</verify>
                        <verbose>false</verbose>
                        <removeExistingSignatures>true</removeExistingSignatures>
                    </configuration>
                </execution>
            </executions>
            <configuration>
                <archive>
                    <manifest>
                        <!-- <addClasspath>true</addClasspath> -->
                    </manifest>
                    <manifestEntries>
                        <!-- ... -->
                    </manifestEntries>
                </archive>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

# javascript - ExecWB 打印预览有时显示空白页

> ID：880194
> 
> 赞同：4
> 
> 时间：2009-05-18T22:54:33.933
> 
> 标签：javascript, internet-explorer, internet-explorer-6, exec

这是一个奇怪的问题。我正在使用 ExecWB 方法来创建 PrintPreview 窗口。大多数情况下，打印预览正确显示。但有时它会显示一个空白页，仅此而已。有没有人见过这个？该问题似乎与 IE6 无关。这个问题非常偶然，因此很难确定出了什么问题。

```
 function onBodyLoad() {
    if (document.getElementById("contentPanel") != null) {
        var editCloseCell = document.getElementById('editCloseCell');
        editCloseCell.style.visibility = "hidden";

        var OLECMDID = 7; // 7 == Print Preview
        var PROMPT = 1; // 2 == DONTPROMPTUSER

        document.getElementById('webBrowser').ExecWB(OLECMDID, PROMPT);
        editCloseCell.style.visibility = "visible"; 
```

'webBroswer' 元素是一个对象。控件的内容似乎正确显示。可能是在填充控件之前调用了 execWB 方法吗？

任何有关此的网站都会有所帮助。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T00:42:25.177

问题似乎是 JQuery .. 信不信由你。在我使用 ExecWB() 方法的同一页面上，我还包括 JQuery 库来对我的 web 服务执行一些不相关的 POST。我尝试从此页面中删除 JQuery，它似乎已经解决了这个问题。我的第一个想法是与 $. 所以我包含了 jQuery.noConflicts() 并将我的 POST 方法更改为 jQuery.Ajax。出现同样的问题。所以我不情愿地删除了我的 JQuery 引用并重构了 Ajax 调用。IE6 不酷……一点也不酷。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T17:02:41.177

我注意到缩放似乎可以修复预览。我想知道有没有人见过这个？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T22:47:47.270

如果我让预览窗口在那里停留大约 10 分钟......它最终会呈现预览。有时我只预览 2 页？！任何人？我是唯一一个试图使用这个的傻瓜吗？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-11-05T16:32:39.357

由于线程似乎已打开且未解决...

当我在桌面应用程序的其他位置使用异步 winint 调用（HttpSendRequestEx（））时，打印预览显示空白灰色页面时遇到了同样的问题。等待一段时间后，预览再次起作用。直到大约一年前，缩放预览确实有所帮助。

# string - “字符串”定义背后的历史

> ID：880195
> 
> 赞同：78
> 
> 时间：2009-05-18T22:54:56.943
> 
> 标签：string, programming-languages, terminology, history

直到最近我才考虑过，但我不确定我们为什么要调用 strings `strings`。我是一名 .NET 程序员，但我相信字符串的概念几乎存在于每种编程语言中。

在编程之外，我不相信我听说过`string`用来描述单词或字母的词。快速搜索一下“定义：字符串”会产生一堆定义，这些定义与字母、单词或与编程相关的任何性质的概念无关。

我的猜测是，在过去，字符串实际上只是特定长度的字符数组，最后通常带有分隔符。但是，我看不到从“字符数组”到`string`.

有人可以提供一些关于我们为什么调用字符串的见解`strings`吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-18T22:59:21.943

我的假设一直是编程术语起源于“字符串”一词的以下定义（来自 Merriam-Webster）：

> (1)：排列成一行或好象排列成一行的一系列事物<a string of cars> <a string of names>
> 
> (2)：一系列相似的项目（如位、字符或单词）

由于编程中的字符串只是一个有序的字符序列，因此将其称为“字符串”（或简称为“字符串”）似乎是最可能的起源。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-05-18T23:02:14.340

从[这个](https://humanist.kdl.kcl.ac.uk/Archives/Virginia/v05/0863.html)参考：

> 1971 年的牛津英语词典（第 3097 页）在 1898 年 1 月 11 日的密尔沃基哨兵报（第 3 节，第 1 页）中引用了 1891 世纪词典，大意是这是一个合成器的术语。打印机会将他们生成的文本粘贴到一长串字符中。（据推测，他们是按脚支付的，而不是按字付钱的！）引述说，合成师每小时创作超过 1500 个（字符？）并不罕见。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-19T07:31:21.920

通过搜索 ACM 参考书目，似乎字符串一词在 1960 年代在计算机科学中获得了它的含义。一开始，字符串是一种通用的序列或列表，例如从 1958 年开始[用于处理符号字符串的命令语言。](http://doi.acm.org/10.1145/610937.610965)

[这篇文章](http://doi.acm.org/10.1145/364099.364236)在 1964 年明确提到了“字符串”。

不幸的是，我无法访问收费站后面的全文。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2011-06-22T00:12:14.860

我猜想“字符串”早在被编程语言采用之前就已经被数学家使用了。图灵机有效地在弦上运行。图灵可能没有使用过这个术语，但它在自动机教科书中随处使用，可以追溯到几十年前。

我能找到的最早的参考资料是逻辑学家 Emil Post 在 AMS 公告中的 1944 年文章“递归可枚举正整数集及其决策问题”的 Google 书籍中的一个片段。幸运的是，AMS 提供了完整文章的在线档案供免费下载。这是一个链接：[http ://www.ams.org/journals/bull/1944-50-05/S0002-9904-1944-08111-1/S0002-9904-1944-08111-1.pdf](http://www.ams.org/journals/bull/1944-50-05/S0002-9904-1944-08111-1/S0002-9904-1944-08111-1.pdf)

我认为毫无疑问，他使用的是计算机科学中传统意义上的“字符串”。P. 286 “出于工作目的，我们引入字母 b，并考虑 1 和 b 的“字符串”，例如 11b1bb1。对此类字符串的操作，例如“b1bP 产生 P1bb1”，我们将其称为正常操作。这种特殊的正常操作仅适用于以 b1b 开头的字符串，然后从给定字符串中获得派生字符串，方法是首先删除初始 b1b，然后在末尾添加 1bb1。因此 b1bb 变为 b1bb1。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-05-30T20:07:23.510

我能在计算中找到的最早参考资料来自 1963 年 3 月的[*METEOR: A LISP Interpreter for String Transformations*](http://dspace.mit.edu/handle/1721.1/6106)，作者 Daniel G. Bobrow 在 MIT 的 AI 实验室。

但是，定义 15d。在*牛津英语词典*中是：

> *计算*记录或数据的线性序列。

... 并引用了 1956 年*计算机协会杂志的第一句话*：

> 预留区域用于来回穿梭控制字段字符串，直到获得完全排序的序列。

这种用法自然遵循定义 15c：

> *数学。*等。按一定顺序排列的一系列符号或语言元素。

...并首次用于*Clarence Irving Lewis 和 Cooper Harold Langford*的*符号逻辑*(1932)：

> 命题不是一串记号或一串声音，除非是偶然的。

这反过来又源于许多其他更早的对同一行事物的定义。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-18T23:00:05.407

我*怀疑*这是因为`string`最初的意思只是一系列数据值：“我将把它们串在一起”等等。这些值不必是字符。这个一般概念的一个非常常见的用途恰好是一系列字符，这成为了这个词的一般含义。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-18T23:18:31.763

该词最初用于区分一组与元素的特定顺序无关的值（例如，一组随机测量样本）和另一个只有在顺序也保留时才能保留其含义的值. 最初，字符串可以是任何类型的值的集合，但由于在后大型机时代，字符串是迄今为止最常见的类型，值是字符的事实成为“默认值”。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-07-26T02:10:52.150

字符串是一系列离散对象（通常是`char`）。

鉴于此，我可能会大胆猜测它可能与“珍珠串”相关的隐喻有关。字符串上的每个珠子都是一个字符。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-11-07T11:56:11.883

在一次关于 Javascript 历史的演讲中，Douglas Crockford 说“没人知道”并给出了一些替代方案： [http ://www.youtube.com/watch?v=RO1Wnu-xKoY#t=2989](http://www.youtube.com/watch?v=RO1Wnu-xKoY#t=2989)

我发现了一份报告，据称，这是计算机历史上第一次将一系列字符作为“字符串”引用。我认为它位于pdf第4页的右上角，编号为47：

[http://web.eecs.umich.edu/~bchandra/courses/papers/Naure_Algol60.pdf](http://web.eecs.umich.edu/~bchandra/courses/papers/Naure_Algol60.pdf)

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-05-18T22:58:37.983

它被称为字符串，因为它实际上是一个 char 类型元素的数组。

话虽这么说，它们通过这个数组“串在一起”（或者是串在一起），这将它们变成了“串”。

# sql - SQL - 识别多条记录的完全匹配

> ID：880217
> 
> 赞同：3
> 
> 时间：2009-05-18T23:07:05.547
> 
> 标签：sql, ms-access

表父级

```
Column1
S1
S2
S3 
```

表孩子

```
Column1     Column2
S1          P1
S1          P2
S2          P1
S2          P2
S3          P1 
```

其中 parent.column1 = child.column1

鉴于上述表格，我需要确定其孩子在 column2 中与父 S1 具有相同记录的父母。

例如，S1 和 S2 都有 P1 和 P2，这样就满足条件。然而，S3 没有 P2，因此应该被排除在外。

SQL新手，所以我遇到了一些麻烦。通过使用 not in 语句进行了尝试，但由于 S3 具有 P1，因此不会被排除在外。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T00:27:55.307

为找到所有匹配的父母的一般情况解决这个问题更有趣:) 请参阅底部的注释，了解如何将其用于更简单的情况（其中一个父键是固定的）。

我会给出我认为是“正确”的解决方案，但我没有 Access（或 SQL Server）的副本来查看它是否在那里工作。（是的，我已经在这里对数据库进行了测试......）

```
SELECT p1.column1, p2.column1
FROM parent p1 JOIN parent p2 ON p1.column1 < p2.column1
WHERE NOT EXISTS (SELECT 1
       FROM (SELECT c1.column1, c1.column2 FROM child c1 WHERE c1.column1 = p1.column1) c1f
            FULL OUTER JOIN
            (SELECT c2.column1, c2.column2 FROM child c2 WHERE c2.column1 = p2.column1) c2f
            ON c1f.column2 = c2f.column2
       WHERE c1f.column1 IS NULL OR c2f.column1 IS NULL
      ); 
```

所以希望你能看到我上面所说的内容是如何联系在一起的:)我会试着解释一下......

“外部”（第一个）选择生成 column1 值（p1.column1 和 p2.column1）的组合。对于每个组合，我们在“child”中列出这些值的行（这些是 c1f 和 c2f：c1f 表示“child 1 filtered”）并执行 FULL OUTER JOIN。根据我的经验，这是一个相对罕见的结构。我们想要匹配c1f 和 c2f中的*所有条目（使用它们的 column1 值），并**在任一侧找到任何条目*在另一侧没有相应的条目。如果有任何这样的非匹配器，那么它们将显示为来自连接的行，其 column1 值为空。因此，父查询仅选择子查询中不存在此类行的 column1 值的组合，即 p1 的 column1 值的每个子行都有一个对应于 p2 的 column1 值的子行，反之亦然。

例如，对于 p1.column1 为“S1”且 p2.column2 为“S3”的迭代，该子查询（无聚合）将产生：

```
 c1f__column1 | c1f__column2 | c2f__column1 | c2f__column2
--------------+--------------+--------------+--------------
 S1           | P1           | S3           | P1
 S1           | P2           |              | 
```

正是第二行中的那些空值将此组合标记为不匹配。涉及一些曲折的想法，当找到不匹配的组合更容易时，很容易专注于寻找匹配的组合。

作为最后的奖励，当我为此创建一些测试表时，我将 (column1,column2) 设置为 child 的主键，这恰好是您有效驱动过滤表的完全外连接所需的。赢！（所以请注意我没有尝试处理孩子中的重复组合......但你可以在 c1f 和 c2f 派生中打“不同”）

NB 基于马特的评论，如果您的父值之一是已知的（即您只想列出与 S1 具有相同子项的所有父值），那么您可以在最后拍打“and p1.column1 = 'S1'”这个的。但是在这种情况下将“parent p1 JOIN parent p2 ON p1.column1 < p2.column1”替换为“parent p1, parent p2”......请记住，否则所写的查询将只输出所有可能对的一半...... .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T23:12:15.490

你需要加入。这将因 SQL 方言而异。就像是：

```
select child.column1, child.column2 from (
  select column2 as parentsColumn2Value from child where column1='S1'
) as parentsColumn2Table
left join child on parentsColumn2Table.column2=child.column2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T08:41:06.490

ACE/Jet 可能不直接支持 FULL OUTER JOIN，但解决方法很简单，即分别将表的 LEFT JOIN、INNER JOIN 和 RIGHT JOIN 联合起来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T07:44:42.600

这是一个 Access，而不是 SQL 解决方案，因为它使用了用户定义函数 (UDF)。

```
SELECT p.Column1, 
       ConcatList("SELECT Column2 FROM c WHERE Column1='S1'","|") AS S1, 
       ConcatList("SELECT Column2 FROM c WHERE Column1='" & [p].[Column1] & "'","|") AS Child, 
       Format([S1]=[Child],"Yes/No") AS [Match]
FROM p; 
```

UDF

```
 Function ConcatList(strSQL As String, strDelim, ParamArray NameList() As Variant)
   ''Reference: Microsoft DAO x.x Object Library
   Dim db As Database
   Dim rs As DAO.Recordset
   Dim strList As String

   Set db = CurrentDb

   If strSQL <> "" Then
       Set rs = db.OpenRecordset(strSQL)

       Do While Not rs.EOF
           strList = strList & strDelim & rs.Fields(0)
           rs.MoveNext
       Loop

       strList = Mid(strList, Len(strDelim) + 1)
   Else

       strList = Join(NameList, strDelim)
   End If

   ConcatList = strList

   End Function 
```

不幸的是，我不相信 Jet 支持 Full Outer Join，因此仅使用 SQL 的解决方案可能有点繁琐，并且需要更多信息，例如 S1 在 column2 中是否有固定数量的条目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-12T05:26:41.190

顺便说一句，我正在寻找相同的解决方案并自己解决了

```
select * from TableParent where id in 
  (select temp_parent.id from
    (select TableParent.*, count(exact_match.match_count) as exact_count 
     from TableParent
     inner join 
       (select Column1, count(*) as match_count from TableChild
        group by Column1
        having match_count = 2
       ) as exact_match on exact_match.Column1 = TableParent.Column1
     inner join 
       TableChild on TableChild.event_id = exact_match.Column1 where TableChild.Column2 in (P1,P2)
   group by TableParent.Column1
   having exact_count = 2) as temp_parent) 
```

# sql-server-2005 - 将 SQL Server 2000 与 2005 同步——DTS 还能工作吗？

> ID：880221
> 
> 赞同：0
> 
> 时间：2009-05-18T23:08:14.953
> 
> 标签：sql-server-2005, synchronization, sql-server-2000, dts

我们有一个运行 sql server 2000 的本地临时服务器和一个也运行 sql server 2000 的远程公共版本。远程版本将升级到 2005，我想知道我们现有的 DTS 包是否会继续在两台机器之间运行？

如果不是，那么在两者之间进行同步的最简单、最有效的方法是什么？

我们不会升级本地服务器，远程服务器的升级很快就会发生（不在我们的控制范围内）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T23:11:05.023

如果您的 DTS 包驻留在本地服务器上，则应该没有问题（除了对 SQL 本身的明显更改（即老式连接不再起作用）），事实上，我什至看到开发人员保存 DTS SQL 2005 数据库上的软件包虽然我确信这不是一个好主意。

编辑：查看[此链接](http://www.microsoft.com/downloads/details.aspx?familyid=DF0BA5AA-B4BD-4705-AA0A-B477BA72A9CB&displaylang=en&displaylang=en)以获取使用 SQL Server Management Studio 设计/修改 DTS 包的工具也可能是值得的。

# rpm - 创建 RPM 文件我必须做的最低限度是什么？

> ID：880227
> 
> 赞同：153
> 
> 时间：2009-05-18T23:10:14.713
> 
> 标签：rpm, rpmbuild

我只想创建一个 RPM 文件来分发我的 Linux 二进制“foobar”，只有几个依赖项。它有一个配置文件 /etc/foobar.conf，应该安装在 /usr/bin/foobar 中。

不幸的是[，RPM 的文档长达](http://docs.fedoraproject.org/drafts/rpm-guide-en/)27 章，我真的没有时间坐下来阅读，因为我还忙于为其他平台制作 .deb 和 EXE 安装程序。

创建 RPM 所需的绝对最低限度是多少？假设 foobar 二进制文件和 foobar.conf 在当前工作目录中。

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2009-07-22T13:21:08.413

我经常在 Linux 上为每个打包专有应用程序执行二进制 rpm - 也最常见于 websphere。所以我的经验对你也很有用，除了如果可以的话，最好做一个真正的 RPM。但我离题了。

因此，打包（二进制）程序的基本步骤如下 - 我假设该程序是 1.0 版的 toybinprog，在 /etc/toybinprog/toybinprog.conf 中安装了一个 conf，并有一个要安装的 bin在 /usr/bin 中称为 tobinprog ：

## 1\. 为 RPM < 4.6,4.7 创建你的 rpm 构建环境

```
mkdir -p ~/rpmbuild/{RPMS,SRPMS,BUILD,SOURCES,SPECS,tmp}

cat <<EOF >~/.rpmmacros
%_topdir   %(echo $HOME)/rpmbuild
%_tmppath  %{_topdir}/tmp
EOF

cd ~/rpmbuild 
```

## 2\. 创建项目的压缩包

```
mkdir toybinprog-1.0
mkdir -p toybinprog-1.0/usr/bin
mkdir -p toybinprog-1.0/etc/toybinprog
install -m 755 toybinprog toybinprog-1.0/usr/bin
install -m 644 toybinprog.conf toybinprog-1.0/etc/toybinprog/

tar -zcvf toybinprog-1.0.tar.gz toybinprog-1.0/ 
```

## 3.复制到源目录

```
cp toybinprog-1.0.tar.gz SOURCES/

cat <<EOF > SPECS/toybinprog.spec
# Don't try fancy stuff like debuginfo, which is useless on binary-only
# packages. Don't strip binary too
# Be sure buildpolicy set to do nothing
%define        __spec_install_post %{nil}
%define          debug_package %{nil}
%define        __os_install_post %{_dbpath}/brp-compress

Summary: A very simple toy bin rpm package
Name: toybinprog
Version: 1.0
Release: 1
License: GPL+
Group: Development/Tools
SOURCE0 : %{name}-%{version}.tar.gz
URL: http://toybinprog.company.com/

BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root

%description
%{summary}

%prep
%setup -q

%build
# Empty section.

%install
rm -rf %{buildroot}
mkdir -p  %{buildroot}

# in builddir
cp -a * %{buildroot}

%clean
rm -rf %{buildroot}

%files
%defattr(-,root,root,-)
%config(noreplace) %{_sysconfdir}/%{name}/%{name}.conf
%{_bindir}/*

%changelog
* Thu Apr 24 2009  Elia Pinto <devzero2000@rpm5.org> 1.0-1
- First Build

EOF 
```

## 4.构建源码和二进制rpm

```
rpmbuild -ba SPECS/toybinprog.spec 
```

就这样。

希望这有帮助

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-06-26T14:19:24.430

作为应用程序分销商，[fpm 听起来非常适合您的需求](https://github.com/jordansissel/fpm)。这里有[一个例子](http://fpm.readthedocs.io/en/latest/use-cases/make-install.html)展示了如何从源代码打包一个应用程序。FPM 可以生成 deb 文件和 RPM 文件。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-09-17T02:54:55.927

# 要快速构建 RPM，请查看 Togo：

[https://github.com/genereese/togo-rpm](https://github.com/genereese/togo-rpm)

该项目有一个快速入门指南，我能够在不到 3 分钟的时间内创建一个基本的 RPM。

## 使用原始问题中提供的数据的示例：

1）使用脚本创建项目目录：

```
$ togo project create foobar; cd foobar 
```

2）在 ./root 下创建所需的目录结构并将文件复制到其中：

```
$ mkdir -p root/etc; cp /path/to/foobar.conf root/etc/
$ mkdir -p root/usr/bin; cp /path/to/foobar root/usr/bin/ 
```

3) 从您的 RPM 所有权中排除系统拥有的目录：

```
$ togo file exclude root/etc root/usr/bin 
```

4）（可选）修改生成的规范以更改您的包描述/依赖项/版本/其他等：

```
$ vi spec/header 
```

5) 构建 RPM：

```
$ togo build package 
```

- 并且您的 RPM 被吐出到 ./rpms 目录中。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2011-03-03T23:25:31.267

同样，我需要创建一个只包含几个文件的 rpm。因为这些文件是源代码控制的，而且看起来很傻，所以我不想为了让 rpm 解压它们而对它们进行去皮重处理。我想出了以下内容：

1.  设置您的环境：

    `mkdir -p ~/rpm/{BUILD,RPMS}`

    `echo '%_topdir %(echo "$HOME")/rpm' > ~/.rpmmacros`

2.  使用以下内容创建规范文件 foobar.spec：

    ```
    Summary: Foo to the Bar
    Name: foobar
    Version: 0.1
    Release: 1
    Group: Foo/Bar
    License: FooBarPL
    Source: %{expand:%%(pwd)}
    BuildRoot: %{_topdir}/BUILD/%{name}-%{version}-%{release}

    %description
    %{summary}

    %prep
    rm -rf $RPM_BUILD_ROOT
    mkdir -p $RPM_BUILD_ROOT/usr/bin
    mkdir -p $RPM_BUILD_ROOT/etc
    cd $RPM_BUILD_ROOT
    cp %{SOURCEURL0}/foobar ./usr/bin/
    cp %{SOURCEURL0}/foobar.conf ./etc/

    %clean
    rm -r -f "$RPM_BUILD_ROOT"

    %files
    %defattr(644,root,root)
    %config(noreplace) %{_sysconfdir}/foobar.conf
    %defattr(755,root,root)
    %{_bindir}/foobar 
    ```

3.  构建你的 rpm： `rpmbuild -bb foobar.spec`

那里有一些hackery将“源”指定为您的当前目录，但它似乎比替代方案更优雅，在我的情况下，它是编写一个单独的脚本来创建一个tarball等，等等。

注意：在我的特殊情况下，我的文件根据需要去的位置排列在文件夹中，如下所示：

```
./etc/foobar.conf
./usr/bin/foobar 
```

所以准备部分变成了：

```
%prep
rm -rf $RPM_BUILD_ROOT
mkdir -p $RPM_BUILD_ROOT
cd $RPM_BUILD_ROOT
tar -cC %{SOURCEURL0} --exclude 'foobar.spec' -f - ./ | tar xf - 
```

哪个更干净一些。

另外，我碰巧在 RHEL5.6 上，rpm 版本为 4.4.2.3，所以你的里程可能会有所不同。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-09-08T14:18:45.727

从二进制构建 rpm 包的简单方法（这些步骤已使用 Fedora 18 进行了测试）：

1）首先你必须安装rpmdevtools，所以运行这些命令（注意：以普通用户运行）

```
$ sudo yum install rpmdevtools rpmlint
$ rpmdev-setuptree 
```

2) 在 ~/rpmbuild/SPECS 文件夹中创建新文件：package_name.spec

3）用编辑器（如gedit）打开它并写下：

```
Name:           package_name
Version:        1.0
Release:        1
Summary:        Short description (first char has to be uppercase)

License:        GPL
URL:            www. your_website/

BuildRequires:  package_required >= (or ==, or <=) 1.0.3 (for example)

%description
Description with almost 79 characters (first char has to be uppercase)

#This is a comment (just as example)

%files
/usr/bin/binary_file.bin
/usr/share/applications/package_name.desktop
/usr/share/pixmaps/package_name.png

%changelog
* date Packager's Name <packager's_email> version-revision
- Summary of changes

#For more details see: docs.fedoraproject.org/en-US/Fedora_Draft_Documentation/0.1/html/Packagers_Guide/sect-Packagers_Guide-Creating_a_Basic_Spec_File.html 
```

4) 制作 ~/rpmbuild/BUILDROOT/package_name-version-release.i386 并重现将放置文件的路径所以在这种情况下，例如创建：

*   ~/rpmbuild/BUILDROOT/package_name-version-release.i386/usr/bin/
*   ~/rpmbuild/BUILDROOT/package_name-version-release.i386/usr/share/applications/
*   ~/rpmbuild/BUILDROOT/package_name-version-release.i386/usr/share/pixmaps/

5) 将要插入包中的文件放入这些文件夹中：

*   ~/rpmbuild/BUILDROOT/package_name-version-release.i386/usr/bin/binary_file.bin
*   ~/rpmbuild/BUILDROOT/package_name-version-release.i386/usr/share/applications/package_name.desktop
*   ~/rpmbuild/BUILDROOT/package_name-version-release.i386/usr/share/pixmaps/package_name.png

usr/share/pixmaps/package_name.png 是二进制的图标 usr/share/applications/package_name.desktop 是在菜单项中插入程序的规则

6) package_name.desktop 必须是这样的：

```
[Desktop Entry]
Encoding=UTF-8
Type=Application
Name=example
GenericName=Short description
Comment=Comment of the application
Exec=package_name
Icon=package_name
Terminal=false
Categories=System; 
```

类别如下：standards.freedesktop.org/menu-spec/latest/apa.html

7) 运行`$ rpmbuild -bb ~/rpmbuild/SPECS/package_name.spec`

8) 你的包被内置到 ~/rpmbuild/RPMS 文件夹中

如果您安装此软件包，则安装：

*   /usr/bin/binary_file.bin
*   /usr/share/applications/package_name.desktop
*   /usr/share/pixmaps/package_name.png

感谢：losurs.org/docs/tips/redhat/binary-rpms

有关构建 rpm 的更多详细信息，请查看此[链接](https://fedoraproject.org/wiki/How_to_create_an_RPM_package)。

GUI java软件构建rpm：[https ://sourceforge.net/projects/javarpmbuilder/](https://sourceforge.net/projects/javarpmbuilder/)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-02-15T09:49:36.830

如果`make config`适用于您的程序，或者您有一个将您的两个文件复制到适当位置的 shell 脚本，您可以使用[checkinstall](http://www.asic-linux.com.mx/~izto/checkinstall/)。只需转到您的 makefile 所在的目录并使用参数`-R`（对于*RPM*）和可选的安装脚本调用它。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-03-31T21:40:00.053

如果您熟悉 Maven，那里也`rpm-maven-plugin`简化了 RPM 的制作：您只需编写`pom.xml`将用于构建 RPM 的内容。RPM 构建环境由插件隐式创建。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2016-03-21T12:42:46.430

从源文件生成 RPM 的过程：

1.  下载扩展名为.gz的源文件。
2.  从 yum install 安装 rpm-build 和 rpmdevtools。（将生成 rpmbuild 文件夹...SPECS、SOURCES、RPMS .. 文件夹应在 rpmbuild 文件夹内生成）。
3.  将源代码.gz 复制到 SOURCES 文件夹。(rpmbuild/SOURCES)
4.  使用以下命令解压缩 tar 球。转到存在 tar 文件的 SOURCES 文件夹 :rpmbuild/SOURCES。命令：例如 tar -xvzf httpd-2.22.tar.gz httpd-2.22 文件夹将在同一路径下生成。
5.  转到提取的文件夹，然后键入以下命令：./configure --prefix=/usr/local/apache2 --with-included-apr --enable-proxy --enable-proxy-balancer --with-mpm=worker - -enable-mods-static=all（.configure 可能会根据需要构建 RPM 的源而有所不同——我已经为需要 apr 和 apr-util 依赖包的 apache HTTPD 完成了）。
6.  配置成功后运行以下命令：make
7.  成功执行 od make 命令后运行：检查安装在同一文件夹中。（如果您没有 checkinstall 软件，请从网站下载最新版本） checkinstall 软件也有错误，可以通过以下方式解决：::::: 找到 checkinstallrc，然后使用 vim 命令将 TRANSLATE = 1 替换为 TRANSLATE=0。还要检查排除包：EXCLUDE="/selinux"
8.  checkinstall 将询问选项（如果您想为源文件构建 rpm，请输入 R）
9.  完成的 .rpm 文件将构建在 rpmbuild/RPMS 文件内的 RPMS 文件夹中......一切顺利......

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2009-05-18T23:24:26.650

RPM 通常是从源代码构建的，而不是二进制文件。

您需要编写包含如何配置和编译应用程序的规范文件；还有，哪些文件要包含在您的 RPM 中。

快速浏览一下手册就会发现，您需要的大部分内容都在第 8 章中介绍了——此外，由于大多数基于 RPM 的发行版都有可用的源代码，因此您可以查看大量不同方法的示例。

# oracle - Oracle中用户和模式之间的区别？

> ID：880230
> 
> 赞同：338
> 
> 时间：2009-05-18T23:11:55.147
> 
> 标签：oracle

Oracle 中的用户和模式有什么区别？

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2009-05-18T23:23:39.727

从[问汤姆](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:6162110256950)

您应该将架构视为用户帐户和其中所有对象的集合，作为用于所有意图和目的的架构。

SCOTT 是一个包含 EMP、DEPT 和 BONUS 表以及各种授权和其他内容的模式。

SYS 是一个包含大量表、视图、授权等的模式。

SYSTEM是一个模式......

从技术上讲——模式是数据库使用的一组元数据（数据字典），通常使用 DDL 生成。模式定义了数据库的属性，例如表、列和属性。数据库模式是对数据库中数据的描述。

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2009-12-10T09:56:27.113

我认为问题在于甲骨文使用术语*模式*与它通常的含义略有不同。

1.  Oracle 的模式（如 Nebakanezer 的回答中所述）：基本上是用户帐户拥有的所有表和其他对象的集合，因此大致相当于用户帐户
2.  一般模式：构成给定系统/应用程序数据库的所有表、存储过程等的集合（如“开发人员应与 DBA 讨论我们的新应用程序的模式。”）

意义 2 中的模式与意义 1 中的模式相似，但并不相同。例如，对于使用多个数据库帐户的应用程序，意义 2 中的模式可能包含多个 Oracle 模式:-)。

加上*模式*也可能意味着在其他上下文中（例如在数学中）的一堆其他相当不相关的事情。

Oracle 应该只使用像“userarea”或“accountobjects”这样的术语，而不是在“schema”中重载......

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2009-05-18T23:17:40.673

来自[维基答案](http://wiki.answers.com/Q/Difference_between_user_and_schema_oracle)：

*   模式是数据库对象的集合，包括表、视图、序列、存储过程、同义词、索引、集群和数据库链接等逻辑结构。
*   用户拥有一个模式。
*   用户和模式具有相同的名称。
*   CREATE USER 命令创建一个用户。它还会自动为该用户创建一个模式。
*   CREATE SCHEMA 命令不会像它所暗示的那样创建“模式”，它只允许您在单个事务中创建多个表和视图并在您自己的模式中执行多个授权。
*   出于所有意图和目的，您可以将用户视为模式，将模式视为用户。

此外，如果有权限，用户可以访问他们自己的模式以外的模式中的对象。

* * *

## 回答 #4

> 赞同：53
> 
> 时间：2009-05-18T23:23:59.583

像往常一样考虑用户（有权登录和访问系统中某些对象的用户名/密码）和作为用户主目录的数据库版本的模式。用户“foo”通常在模式“foo”下创建东西，例如，如果用户“foo”创建或引用表“bar”，那么 Oracle 将假定用户的意思是“foo.bar”。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2012-08-01T17:55:58.200

这个答案没有定义所有者和模式之间的区别，但我认为它增加了讨论。

在我的小世界里：

我一直在为创建 N 个用户的想法而苦苦挣扎，我希望每个用户在其中“消费”（又名，使用）一个模式。

[oracle-base.com 的 Tim 展示了如何做到这一点](http://www.oracle-base.com/articles/misc/schema-owners-and-application-users.php)（有 N 个用户，每个用户都将被“重定向”到单个模式。

他有第二种“同义词”方法（此处未列出）。我在这里只引用 CURRENT_SCHEMA 版本（他的方法之一）：

> **`CURRENT_SCHEMA`方法**
> 
> 此方法使用`CURRENT_SCHEMA`会话属性自动将应用程序用户指向正确的模式。
> 
> 首先，我们创建模式所有者和应用程序用户。
> 
> ```
> CONN sys/password AS SYSDBA
> 
> -- Remove existing users and roles with the same names.
> DROP USER schema_owner CASCADE;
> DROP USER app_user CASCADE;
> DROP ROLE schema_rw_role;
> DROP ROLE schema_ro_role;
> 
> -- Schema owner.
> CREATE USER schema_owner IDENTIFIED BY password
>   DEFAULT TABLESPACE users
>   TEMPORARY TABLESPACE temp
>   QUOTA UNLIMITED ON users;
> 
> GRANT CONNECT, CREATE TABLE TO schema_owner;
> 
> -- Application user.
> CREATE USER app_user IDENTIFIED BY password
>   DEFAULT TABLESPACE users
>   TEMPORARY TABLESPACE temp;
> 
> GRANT CONNECT TO app_user; 
> ```
> 
> 请注意，应用程序用户可以连接，但没有任何表空间配额或创建对象的权限。
> 
> 接下来，我们创建一些角色来允许读写和只读访问。
> 
> ```
> CREATE ROLE schema_rw_role;
> CREATE ROLE schema_ro_role; 
> ```
> 
> 我们希望为我们的应用程序用户提供对模式对象的读写访问权限，因此我们授予相关角色。
> 
> ```
> GRANT schema_rw_role TO app_user; 
> ```
> 
> 我们需要确保应用程序用户的默认架构指向架构所有者，因此我们创建了一个 AFTER LOGON 触发器来为我们执行此操作。
> 
> ```
> CREATE OR REPLACE TRIGGER app_user.after_logon_trg
> AFTER LOGON ON app_user.SCHEMA
> BEGIN
>   DBMS_APPLICATION_INFO.set_module(USER, 'Initialized');
>   EXECUTE IMMEDIATE 'ALTER SESSION SET current_schema=SCHEMA_OWNER';
> END;
> / 
> ```
> 
> 现在我们准备在模式所有者中创建一个对象。
> 
> ```
> CONN schema_owner/password
> 
> CREATE TABLE test_tab (
>   id          NUMBER,
>   description VARCHAR2(50),
>   CONSTRAINT test_tab_pk PRIMARY KEY (id)
> );
> 
> GRANT SELECT ON test_tab TO schema_ro_role;
> GRANT SELECT, INSERT, UPDATE, DELETE ON test_tab TO schema_rw_role; 
> ```
> 
> 请注意权限是如何授予相关角色的。没有这个，应用程序用户将看不到对象。我们现在有一个正常工作的模式所有者和应用程序用户。
> 
> ```
> SQL> CONN app_user/password
> Connected.
> SQL> DESC test_tab
>  Name                                                  Null?    Type
>  ----------------------------------------------------- -------- ------------------------------------
>  ID                                                    NOT NULL NUMBER
>  DESCRIPTION                                                    VARCHAR2(50)
> 
> SQL> 
> ```
> 
> 这种方法非常适合应用程序用户只是主模式的替代入口点，不需要自己的对象。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2012-09-12T07:36:46.973

这很简单。

```
If USER has OBJECTS
then call it SCHEMA
else
     call it USER
end if; 
```

一个用户可以被授予访问不同用户拥有的模式对象的权限。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-01-16T11:50:57.347

Schema 是 DB.objects 关于感兴趣的想法/领域的封装，由一个用户拥有。然后它将由具有抑制角色的其他用户/应用程序共享。所以用户不需要拥有一个模式，但一个模式需要有一个所有者。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-11-07T08:21:22.620

--用户和模式

用户和模式这两个词是可以互换的，这就是为什么大多数人对下面这个词感到困惑我解释了它们之间的区别

--User 用户是连接数据库（服务器）的帐户。我们可以使用 CREATE USER user_name IDENTIFIED BY password 创建用户。

--架构

实际上Oracle数据库包含处理数据的逻辑和物理结构。模式也是逻辑结构来处理数据库中的数据（内存组件）。它在用户创建时由 oracle 自动创建。它包含与该架构关联的用户创建的所有对象。例如，如果我创建了一个名为 santhosh 的用户，那么 oracle 创建一个名为 santhosh 的架构，oracle 将用户 santhosh 创建的所有对象存储在 santhosh架构。

我们可以通过 CREATE SCHEMA 语句创建模式，但 Oracle 会自动为该模式创建用户。

我们可以使用 DROP SCHEMA schama_name RESTRICT 语句来删除模式，但它不能删除包含对象的模式，因此要删除模式，它必须为空。这里的限制字强制指定没有对象的模式。

如果我们试图在他的模式中删除用户包含的对象，我们必须指定 CASCADE 字，因为 oracle 不允许您删除用户包含的对象。DROP USER user_name CASCADE 所以 oracle 删除模式中的对象，然后自动删除用户，从其他模式（如视图和私有同义词）引用此模式对象的对象进入无效状态。

我希望现在您能了解它们之间的区别，如果您对此主题有任何疑问，请随时提出。

谢谢你。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-06-21T06:27:01.153

用户帐户就像持有您家的钥匙但不拥有任何东西的亲戚，即用户帐户不拥有任何数据库对象...没有数据字典...

而模式是数据库对象的封装。这就像拥有你房子里所有东西的房子的所有者，只有当所有者（即模式）向它提供所需的授权时，用户帐户才能访问家中的商品。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-11-22T07:10:35.723

架构和数据库用户是相同的，但是如果架构拥有数据库对象并且他们可以做任何他们的对象但用户只是访问对象，他们不能做任何 DDL 操作，直到架构用户给你适当的权限。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-09-10T14:47:54.187

根据我对 Oracle 的一点了解...... USER 和 SCHEMA 有点相似。但也有很大的不同。如果“USER”拥有任何对象，则可以将 USER 称为 SCHEMA，否则......它将仅保留为“USER”。一旦 USER 拥有至少一个对象，那么根据您上面的所有定义......现在可以将 USER 称为 SCHEMA。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-06-03T17:49:46.630

用户：访问数据库资源。就像进入房子的钥匙一样。

Schema：关于数据库对象的信息的集合。就像您书中的索引一样，其中包含有关该章的简短信息。

[看这里了解详情](http://www.arraynotfound.com/2016/06/difference-between-user-and-schema-in-oracle-database.html)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-04-26T09:31:03.447

对于大多数更熟悉 MariaDB 或 MySQL 的人来说，这似乎并不令人困惑，因为在 MariaDB 或 MySQL 中，它们具有不同的模式（包括不同的表、视图、PLSQL 块和 DB 对象等），而用户是可以访问这些的帐户架构。因此，没有特定用户可以属于任何特定模式。必须向该架构授予权限，然后用户才能访问它。用户和模式在 MySQL 和 MariaDB 等数据库中是分开的。

在 Oracle 模式中，用户几乎被视为相同。要使用该架构，您需要拥有权限，您会觉得架构名称只不过是用户名。可以跨模式授予权限，以从不同的模式访问不同的数据库对象。在 oracle 中，我们可以说用户拥有模式，因为当您创建用户时，您会为其创建数据库对象，反之亦然。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-12-10T09:49:22.277

Schema 是对象的容器。它归用户所有。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2015-08-12T05:43:18.447

好吧，我在某处读到，如果您的数据库用户具有 DDL 权限，那么它就是模式，否则就是用户。

# django - 重新启动 django runserver 时如何“清除”端口

> ID：880239
> 
> 赞同：70
> 
> 时间：2009-05-18T23:15:57.260
> 
> 标签：django

通常，在重新启动 Django 运行服务器时，如果我使用相同的端口号，我会收到“端口已在使用”消息。随后，我需要每次增加端口号以避免这种情况。

但是，并非所有服务器都如此，所以我想知道如何在我正在处理的当前系统上实现这一点？

顺便说一句，平台是 Ubuntu 8.10

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2011-04-26T09:48:20.493

我找到了这些信息（最初来自 Kristinn Örn Sigurðsson）来解决我的问题：

要使用 -9 杀死它，您必须列出所有正在运行的 manage.py 进程，例如：

```
ps aux | grep -i manage 
```

如果您已在多个端口上启动，您将获得与此类似的输出：

```
14770     8264  0.0  1.9 546948 40904 ?        S    Sep19   0:00 /usr/local/bin/python manage.py runserver 0.0.0.0:8006
14770    15215  0.0  2.7 536708 56420 ?        S    Sep13   0:00 /usr/local/bin/python manage.py runserver 0.0.0.0:8001
14770    30144  0.0  2.1 612488 44912 ?        S    Sep18   0:00 /usr/local/bin/python manage.py runserver 0.0.0.0:8000
14770    30282  0.0  1.9 678024 40104 ?        S    Sep18   0:00 /usr/local/bin/python manage.py runserver 0.0.0.0:8002
14770    30592  0.0  2.1 678024 45008 ?        S    Sep18   0:00 /usr/local/bin/python manage.py runserver 0.0.0.0:8003
14770    30743  0.0  2.1 678024 45044 ?        S    Sep18   0:00 /usr/local/bin/python manage.py runserver 0.0.0.0:8004 
```

然后，您必须为正确的 manage.py 进程（python manage.py runserver... 等）选择 pid（这是左侧的第二个数字）并执行以下操作：

```
kill -9 pid 
```

对于上面的例子，如果你想释放 8000 端口，你可以这样做：

```
kill -9 30144 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-05-18T23:22:22.317

您收到该消息是因为服务器已经在运行（可能在后台）。确保终止进程（将其带到前台并按 ctrl-c）以停止进程。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-03-13T07:46:34.203

如果`ps aux`命令（根据 Meil​​o 的回答）没有列出您想要杀死的进程，但显示在`netstat -np | grep 8004`网络活动中处于活动状态的端口，请尝试此命令（在 Ubuntu 上工作）。

```
sudo fuser -k 8004/tcp 
```

其中，8004 是您要关闭的端口号。这应该会杀死与端口 8004 关联的所有进程。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-05-20T05:07:35.953

不，他不是白痴。同样的事情发生在我身上。显然，这是 python UUID 进程的一个错误，在 django 服务器关闭后很长时间会继续运行，这会绑定端口。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-05-29T03:49:34.613

```
fuser -k 8000/tcp 
```

在终端中运行它在 ubutu 中工作。`8000`是港口。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-05-21T19:23:16.257

# 此错误是由于服务器已在运行。

## 背景

我在更一般的层面上回答，而不是像原始问题所问的那样特定于 Django。这样那些从谷歌登陆的人就可以轻松解决问题。

## 解决方案

当您需要清除端口时，您需要做的就是这两个步骤

1.  在终端运行`fg`
2.  按 Control-C（如果在 Mac 上）

## 解释

[fg](http://en.wikipedia.org/wiki/Fg_%28Unix%29)将进程带到*前台*。然后 Control-C 停止服务器。

## 例子

运行角度应用程序时，我的端口 8000 实际上遇到了这个问题。我跑的时候出错了`npm start`

![在 angular-seed@0.0.0 启动脚本错误时失败](https://i.stack.imgur.com/XeVEF.png)

所以我跑了`fg`，然后我用 Control-C 停止了服务器

![fg](https://i.stack.imgur.com/EE3pF.png)

然后我能够成功运行服务器

![npm 开始](https://i.stack.imgur.com/FaASx.png)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-03-10T10:09:59.357

在终端中键入`fg`以将后台任务调到前台。

按`Ctrl`+`C`关闭/停止正在运行的服务器。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-05-19T23:38:22.477

我使用`pkill -If 'manage.py'`(`-I`表示交互式，`-f`不仅匹配进程名称)。请参阅[如何杀死具有给定部分名称的所有进程？](https://stackoverflow.com/questions/8987037/how-to-kill-all-processes-with-a-given-partial-name)有关 pkill 的更多信息。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-12-18T23:45:59.727

```
sudo lsof -t -i tcp:8000 | xargs kill -9 
```

如果您想释放 8000 端口，而不仅仅是复制命令并粘贴到您的 cmd 中，它会要求输入 sudo 密码。然后你就可以走了。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-08-12T05:41:57.627

如果您尝试的端口号是 8001，请使用此命令

```
sudo fuser -k 8001/tcp 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-05-25T23:31:04.033

您不想在重新启动 Django 服务器时简单地增加端口号。这将导致 Django 服务器的多个实例同时运行。更好的解决方案是杀死当前实例并启动一个新实例。

为此，您有多种选择。最简单的是

**Python2：** `$ killall -9 python`

**Python3：** `$ killall -9 python3`

如果由于某种原因，这不起作用，你可以做

`$ kill <pid>``<pid>`从简单`$ ps aux | grep python`命令中找到的进程 ID在哪里。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-04-22T13:58:41.837

```
netstat -tulpn |grep 8000|awk '{print $7}'|cut -d/ -f 1|xargs kill 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-11-25T23:14:12.700

从[https://stackoverflow.com/a/27138521/1467342](https://stackoverflow.com/a/27138521/1467342)转发：

您可以使用此脚本代替`./manage.py runserver`. 我把它放进去`scripts/runserver.sh`。

```
#!/bin/bash

pid=$(ps aux | grep "./manage.py runserver" | grep -v grep | head -1 | xargs | cut -f2 -d" ")

if [[ -n "$pid" ]]; then
    kill $pid
fi

fuser -k 8000/tcp
./manage.py runserver 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-18T23:40:30.690

就像 mipadi 所说，您应该终止服务器（ctrl+c）并在`manage.py runserver`再次调用之前返回命令提示符。

唯一可能会破坏这种情况的是，如果您设法使 runserver 充当守护程序。如果是这种情况，我猜您正在使用 Django 测试服务器作为实际的 Web 服务器，您不应该*这样*做。Django 测试服务器是单线程的，速度慢且脆弱，只适合本地开发。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-17T18:35:15.797

在 Leopard 中，我打开了 Activity Monitor 并杀死了 python。解决了。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-06-08T15:18:27.243

发生得如此频繁，以至于我写了一个别名来终止`python`名称中的进程（如果您有其他此类进程，请小心）。现在我只是运行（没有 Ubuntu）

```
kill $(ps | grep "python" | awk "{print $1}") 
```

您甚至可以添加`python manage.py runserver ...`到同一个别名，这样您就可以通过两次击键重新启动。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-01-28T09:45:20.807

你一定一直在做 control + z .. 而是做 control + c 会杀死服务器会话......干杯！！！

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-04-28T03:13:49.200

**在manage.py**中添加以下库

 **> 导入操作系统
> 导入子进程
> 导入重新

**现在在if __name__ == "__main__"**之后添加以下 python 代码：

 **```
ports = ['8000']
popen = subprocess.Popen(['netstat', '-lpn'],
                         shell=False,
                         stdout=subprocess.PIPE)
(data, err) = popen.communicate()
pattern = "^tcp.*((?:{0})).* (?P<pid>[0-9]*)/.*$"
pattern = pattern.format(')|(?:'.join(ports))
prog = re.compile(pattern)
for line in data.split('\n'):
    match = re.match(prog, line)
    if match:
        pid = match.group('pid')
        subprocess.Popen(['kill', '-9', pid]) 
```

**这将首先找到端口 8000 的进程 ID，将其杀死，然后重新启动您的项目。现在每次你不需要手动杀死 pid。**

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2017-04-11T09:23:49.343

```
netstat -ntlp 
```

在这里查看我的完整答案。[https://stackoverflow.com/a/34824239/5215825](https://stackoverflow.com/a/34824239/5215825)

# iphone - iPhone - 从本地 xml 文件加载本地图像

> ID：880248
> 
> 赞同：0
> 
> 时间：2009-05-18T23:20:17.877
> 
> 标签：iphone, resources, local

为什么我可以从主包中加载本地 xml 文件，但我无法加载图像？

NSString *path = [[NSBundle mainBundle] resourcePath];

这被加载（我知道，因为我可以跟踪它）/Users/me/Library/Application Support/iPhone Simulator/User/Applications/5B888456-40FF-4C72-A2ED-5D5CFA287777/MyApp.app/test.xml

此图像永远不会加载（也不会加载任何图像）：/Users/me/Library/Application Support/iPhone Simulator/User/Applications/5B888456-40FF-4C72-A2ED-5D5CFA287777/MyApp.app/background.png

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T23:34:08.287

您可以使用`[UIImage imageNamed:@"background.png"]`.

这将加载 background.png（它应该位于 Xcode 的 Resources 文件夹中）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-11-20T04:11:49.283

您在评论中说您正在为路径编写 NSURL。要对本地文件系统路径（例如包中的文件）执行此操作，您需要使用`NSURL fileURLWithPath:`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-19T07:57:36.173

就像是

```
UIImage *testimg = [UIImage imageNamed:myfilename];

if (nil==testimg) [testimg initWithContentsOfURL:myurl]; 
```

我现在远离编译器，所以我无法检查是否需要先将其下载到 NSData 对象，然后再将其制作为图像。您还应该将 initWithContents... 放在 try...catch... finally 块中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-19T07:00:52.677

这里有两种可能：

1）您的图像文件名不正确。这意味着，文件名区分大小写。所以可能是大写小写字母的问题。

2）您可能已从图像属性中取消选中目标名称。这意味着您的图像不是您正在编译的项目目标的成员。要验证这一点，请右键单击 XCode 项目中的任何图像名称 --> 选择获取信息 --> 从文件信息对话框中选择目标选项卡 --> 验证目标名称附近复选框的状态。万一，它被选中/选中，那么就会出现一个奇怪的问题。但是如果它没有被选中/取消选中，这意味着图像没有被添加到编译后创建的包文件中。

**第三种可能性是您可能没有添加您所指的图像。重新检查您的项目层次结构并查看所有资源是否存在。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-24T20:25:55.927

NSURL *imageURL = [NSURL URLWithString:@"bundle://background.png"];

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-19T08:45:34.497

嗨使用以下代码

[UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"background" ofType:@"png"]];

# eclipse - 从 Eclipse 使用 Portal 启动 JBoss 时出现内存不足错误

> ID：880255
> 
> 赞同：3
> 
> 时间：2009-05-18T23:22:16.203
> 
> 标签：eclipse, jboss, portal

我无法让 JBoss Portal 从 Eclipse 启动，尽管 AS 单独启动良好，并且当从命令行启动而不是从 Eclipse 内启动时，Portal 也正确启动。我在 Windows 中运行，有 3GB。建议？谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T13:45:06.637

我花了几个小时才发现这一点，几乎放弃并开始使用 Eclipse 之外的 JBoss。

为了在从 Eclipse 启动时增加 JBoss vmargs，您必须更改 JBoss 启动配置。如果您更改standalone.conf，则不会发生任何事情，因为Eclipse 不使用它。

**因此，要在 Eclipse 中更改 JBoss vmargs，您必须转到“服务器”选项卡，右键单击您的 Jboss 实例，然后选择“打开”。**

**它将出现一个新窗口。在第一部分，您有一个选项：“打开启动配置”。单击此处时，您将看到更改 vmargs 的文本框。**

希望这对你有帮助！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-19T20:51:07.223

有不同类型的 OutOfMemory 错误：

**java.lang.OutOfMemoryError：Java 堆空间**

增加 -Xms 和 -Xmx。我会确保它们至少设置为 256m，通常将它们设置为相同的值是个好主意。

**java.lang.OutOfMemoryError: PermGen 空间**

添加 -XX:+CMSPermGenSweepingEnabled 或增加 PermGen 大小：-XX:PermSize=256m

**java.lang.OutOfMemoryError：超出 GC 开销限制**

添加更多堆，垃圾收集器无法在每个循环中释放足够的内存。还可以尝试打开 GC 日志记录。

**java.lang.OutOfMemoryError：无法创建新的本地线程**

减少你的堆:) 这意味着你有太多的内存分配给堆，操作系统没有足够的内存来创建线程..

* * *

最后两件事，上面可以在jboss/bin/run.conf中配置。

此外，当启动 JBoss 时，查看哪些 -X 参数正在传递给 JVM，默认情况下会打印此信息，验证它是否符合您的预期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T23:28:20.870

您需要增加分配给 Java 的内存，尤其是堆空间和 PermGen。 [这篇文章](http://blog.xam.dk/archives/68-Eclipse-and-memory-settings.html)是高度相关的。它提到这个问题经常发生在 Eclipse 和 JBoss 中（因为两者都相当大），并提供了一个解决方案（调整命令行标志）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-15T14:04:06.230

你用什么从 Eclipse 运行门户？也许 Jboss 工具可以帮助你 [http://www.jboss.org/tools](http://www.jboss.org/tools)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-30T12:31:04.810

1.  根据我的实验，在 eclipse.ini 中设置的所有 vmargs 选项只播放一次 - 在创建新工作区时。如果要更改现有工作区中的选项，请使用运行/调试配置，如[https://stackoverflow.com/a/10814631/715269](https://stackoverflow.com/a/10814631/715269)中所示。ini 中的 vmargs 将不再被读取。

2.  小心，你应该设置 -XX:MaxPermSize=...M，而不是 -XX:PermSize=...，最后设置最小，开始 PermSize。

3.  广告。杰里米。将最小值和最大值设置为相同的值是没有意义的。您剥夺了 Eclipse 的适应性。-Xms 和 -Xmx（堆）和 PermGen 和 MaxPermGen 应该不同。（MaxPermGen = 256 默认）

# sharepoint - searchboxex AppQueryTerms 枚举的有效值是什么？

> ID：880258
> 
> 赞同：2
> 
> 时间：2009-05-18T23:22:46.530
> 
> 标签：sharepoint, moss, web-parts

我正在构建一个自定义搜索页面并尝试使用现有的自定义搜索范围。我成功使用 SearchBoxEx 和 AppQueryTerms = "ContentType:'my custom content type name'" 但是当我尝试使用 AppQueryTerms = "Scope:'My Custom Search Scope'" 时，我没有收到任何错误，但也没有正确的结果. 我知道我的范围是使用高级搜索填充的，所以我一定是错误地使用了 AppQuwryTerms。

我在网上搜索过，找不到允许的 AppQueryTerms 过滤器列表。这个 Enum 对 stackerverse 了解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-23T21:18:06.890

问题是您的范围名称有空格。

这对我有用：

```
AppQueryTerms="Scope:&quot;My Scope&quot;" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-21T21:32:24.080

的值`SearchBoxEx.AppQueryTerms`不是枚举。它们实际上是用特定语言编写的用于 SharePoint 搜索的查询。SharePoint 2010 的语法由微软在此[页面](http://msdn.microsoft.com/en-us/library/ee558911.aspx)上定义。它遵循格式`<Property Name><Property Operator><Property Value>`

*   `Scope`是您的财产名称。
*   `:`是您使用属性存储数据库进行匹配的属性运算符。
*   `My Scope`是您的财产价值。

上面的页面指出：

> 属性限制不得在属性名称、属性运算符和属性值之间包含空格，否则属性限制将被视为自由文本查询。属性限制的长度限制为 2,048 个字符。

因此，就像在 HelloSharePoint 的示例中一样，如果属性值包含空格，则必须将其括在引号中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T03:44:43.887

您的自定义范围是否出现在范围的网站列表中？ [http://intranet/[sitecollection]/_layouts/viewscopes.aspx?mode=site](http://intranet/[sitecollection]/_layouts/viewscopes.aspx?mode=site)

范围是否出现在显示组中？

# c++ - 如何在 Linux 中检测文件访问？

> ID：880263
> 
> 赞同：10
> 
> 时间：2009-05-18T23:24:27.773
> 
> 标签：c++, linux, resources

我有一堆流和数据处理应用程序，我偶尔需要监视它们，这意味着我需要知道它们读取了哪些文件。这主要是为了帮助打包测试用例，但在调试时也很有用。

有没有办法以产生这样一个列表的方式运行可执行文件？

对此我有两个想法：

1.  我可以调用一个命令，该命令会调用我的应用程序。类似于 GDB 的东西。我调用 GDB，给它一个可执行文件的路径和一些参数，然后 GDB 为我调用它。也许有类似告诉我如何使用系统资源的东西。
2.  也许更有趣（但不必要的小路）解决方案。
    1.  创建名为 libc.so 的库，它实现了 fopen （和其他一些）
    2.  更改 LD_LIBRARY_PATH 以指向新库
    3.  复制真正的 libc.so 并在编辑器中重命名 fopen（也许是 nepof）
    4.  我的库加载副本并根据需要调用重命名的函数以提供 fopen 功能。
    5.  调用应用程序，然后调用我的代理 fopen。

备选方案#1 肯定是更可取的方案，但也欢迎对如何更轻松地完成#2 提出意见。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-18T23:27:49.763

一种选择是使用 strace：

```
strace -o logfile -eopen yourapp 
```

这将记录所有文件打开事件，但会造成可能很严重的性能损失。然而，它具有易于使用的优点。

另一种选择是使用 LD_PRELOAD。这对应于您的选项#2。基本思想是做这样的事情：

```
#define _GNU_SOURCE
#include <stdio.h>
#include <dlfcn.h>

int open(const char *fn, int flags) {
    static int (*real_open)(const char *fn, int flags);

    if (!real_open) {
        real_open = dlsym(RTLD_NEXT, "open");
    }

    fprintf(stderr, "opened file '%s'\n", fn);
    return real_open(fn, flags);
} 
```

然后构建：

```
gcc -fPIC -shared -ldl -o preload-example.so preload-example.c 
```

并运行您的程序，例如：

```
$ LD_PRELOAD=$PWD/preload-example.so cat /dev/null
opened file '/dev/null' 
```

这具有更少的开销。

但是请注意，还有其他用于打开文件的入口点 - 例如 fopen()、openat() 或许多遗留兼容性入口点之一：

```
00000000000747d0 g    DF .text      000000000000071c  GLIBC_2.2.5 _IO_file_fopen
0000000000068850 g    DF .text      000000000000000a  GLIBC_2.2.5 fopen
000000000006fe60 g    DF .text      00000000000000e2  GLIBC_2.4   open_wmemstream
00000000001209c0  w   DF .text      00000000000000ec  GLIBC_2.2.5 posix_openpt
0000000000069e50 g    DF .text      00000000000003fb  GLIBC_2.2.5 _IO_proc_open
00000000000dcf70 g    DF .text      0000000000000021  GLIBC_2.7   __open64_2
0000000000068a10 g    DF .text      00000000000000f5  GLIBC_2.2.5 fopencookie
000000000006a250 g    DF .text      000000000000009b  GLIBC_2.2.5 popen
00000000000d7b10  w   DF .text      0000000000000080  GLIBC_2.2.5 __open64
0000000000068850 g    DF .text      000000000000000a  GLIBC_2.2.5 _IO_fopen
00000000000d7e70  w   DF .text      0000000000000020  GLIBC_2.7   __openat64_2
00000000000e1ef0 g    DF .text      000000000000005b  GLIBC_2.2.5 openlog
00000000000d7b10  w   DF .text      0000000000000080  GLIBC_2.2.5 open64
0000000000370c10 g    DO .bss       0000000000000008  GLIBC_PRIVATE _dl_open_hook
0000000000031680 g    DF .text      0000000000000240  GLIBC_2.2.5 catopen
000000000006a250 g    DF .text      000000000000009b  GLIBC_2.2.5 _IO_popen
0000000000071af0 g    DF .text      000000000000026a  GLIBC_2.2.5 freopen64
00000000000723a0 g    DF .text      0000000000000183  GLIBC_2.2.5 fmemopen
00000000000a44f0  w   DF .text      0000000000000088  GLIBC_2.4   fdopendir
00000000000d7e70 g    DF .text      0000000000000020  GLIBC_2.7   __openat_2
00000000000a3d00  w   DF .text      0000000000000095  GLIBC_2.2.5 opendir
00000000000dcf40 g    DF .text      0000000000000021  GLIBC_2.7   __open_2
00000000000d7b10  w   DF .text      0000000000000080  GLIBC_2.2.5 __open
0000000000074370 g    DF .text      00000000000000d7  GLIBC_2.2.5 _IO_file_open
0000000000070b40 g    DF .text      00000000000000d2  GLIBC_2.2.5 open_memstream
0000000000070450 g    DF .text      0000000000000272  GLIBC_2.2.5 freopen
00000000000318c0 g    DF .text      00000000000008c4  GLIBC_PRIVATE __open_catalog
00000000000d7b10  w   DF .text      0000000000000080  GLIBC_2.2.5 open
0000000000067e80 g    DF .text      0000000000000332  GLIBC_2.2.5 fdopen
000000000001e9b0 g    DF .text      00000000000003f5  GLIBC_2.2.5 iconv_open
00000000000daca0 g    DF .text      000000000000067b  GLIBC_2.2.5 fts_open
00000000000d7d60  w   DF .text      0000000000000109  GLIBC_2.4   openat
0000000000068850  w   DF .text      000000000000000a  GLIBC_2.2.5 fopen64
00000000000d7d60  w   DF .text      0000000000000109  GLIBC_2.4   openat64
00000000000d6490 g    DF .text      00000000000000b6  GLIBC_2.2.5 posix_spawn_file_actions_addopen
0000000000121b80 g    DF .text      000000000000008a  GLIBC_PRIVATE __libc_dlopen_mode
0000000000067e80 g    DF .text      0000000000000332  GLIBC_2.2.5 _IO_fdopen 
```

为了完整起见，您可能需要钩住所有这些——至少，应该钩住不带 _ 前缀的那些。特别是，*请务必单独挂钩 fopen*，因为从 fopen() 到 open() 的 libc 内部调用不会被 LD_PRELOAD 库挂钩。

类似的警告适用于 strace - 还有“openat”系统调用，并且根据您的架构，可能还有其他遗留系统调用。但没有 LD_PRELOAD 钩子那么多，所以如果你不介意性能损失，它可能是一个更简单的选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T23:26:29.673

```
man strace 
```

示例（假设 2343 是进程 ID）：

```
# logging part
strace -p 2343 -ff -o strace_log.txt 

# displaying part
grep ^open strace_log.txt 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T23:28:01.200

我使用的是这样的：

```
strace -o file.txt ./command 
```

然后你可以

```
cat file.txt | grep open 
```

获取程序打开的所有文件的列表。

# ruby - Ruby中平均数组中的集合的最佳方法是什么？

> ID：880268
> 
> 赞同：2
> 
> 时间：2009-05-18T23:25:14.467
> 
> 标签：ruby

给定以下简单的数据集，对 0 25 53 和 80 集的值进行平均的最佳方法是什么。

```
 [["0", "148.5"],
   ["0", "146.5"],
   ["0", "148.6"],
   ["0", "202.3"],
   ["25", "145.7"],
   ["25", "145.5"],
   ["25", "147.4"],
   ["25", "147.3"],
   ["53", "150.4"],
   ["53", "147.6"],
   ["53", "147.8"],
   ["53", "215.4"],
   ["80", "150.4"],
   ["80", "149.4"],
   ["80", "148.0"],
   ["80", "149.9"]] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T00:03:34.497

注入很简单。我经常在项目中实现一个通用的 group_by 方法来帮助处理这样的事情。

如果数据很大并且性能很重要，请考虑在适当的情况下使用数字库或数据库。

```
data = [ ... ]

groups = data.inject({}) do |hash, pair| 
  hash[pair.first] ||= []
  hash[pair.first] << pair.last.to_f
  hash
end

groups.inject({}) do |hash, pair| 
  hash[pair.first] = pair.last.inject(0,&:+) / pair.last.size
  hash
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T13:22:42.550

使用带有散列的注入将产生较差的性能（您在每次迭代时重新分配 memo var）。如果您使用的是 1.9，则 Enumerable 实现了 method `group_by`，可用于使代码更加明显：

```
result = array.map{ |row| [row.first.to_i, row.last.to_f] }.group_by(&:first)
result.each_pair do |key, values|
  result[key] = values.average
end 
```

`Array#average`很容易实现为

```
class Array
  def average
    inject(0.0) { |sum, e| sum + e } / length
  end
end 
```

您的数据是字符串这一事实非常不方便，我建议尽可能避免这种情况。

# c++ - 如何在 C++ 中清理已删除的对象

> ID：880269
> 
> 赞同：7
> 
> 时间：2009-05-18T23:25:43.823
> 
> 标签：c++

是否可以将 C++ 中已删除对象的内存清零？我想这样做是为了在单元测试中重现一个核心转储：

```
//Some member variable of object-b is passed-by-pointer to object-a
//When object-b is deleted, that member variable is also deleted
//In my unit test code, I want to reproduce this
//even if I explicitly call delete on object-b
//accessBMemberVariable should coredump, but it doesn't
//I'm assuming even though object-b is deleted, it's still intact in memory
A *a = new A();
{
  B *b = new B(a);
  delete b;
}
a->accessBMemberVariable(); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-18T23:31:40.193

您可能应该覆盖`delete`运算符。

给定 B 类的示例：

```
class B
{
public:

  // your code
  ...

  // override delete
  void operator delete(void * p, size_t s)
  {
    ::memset(p, 0, s);
    ::operator delete(p, s);
  }
}; 
```

**编辑：**感谢*litb*指出这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T00:07:10.137

> accessBMemberVariable 应该核心转储，但它没有

不，为什么要这样？很有可能 b 曾经占用的内存现在由 CRT 拥有，即您的应用程序拥有的 CRT。CRT 可能会选择不将内存释放回操作系统。*只有当您访问不*属于您的应用程序的内存时，才会发生核心转储。

根据 A 具有地址的变量类型，将 b 占用的内存清零可能对您没有任何好处。

我的建议是在堆栈上分配 B，这应该会带出烟花......但话又说回来，不太像你期望的那样......

所以如果你真的想要一个核心转储，你应该使用操作系统函数来分配内存并释放它：

```
char *buf = OS_Alloc(sizeof(B));
B *b = new(buf) B();
a->someBMember = &b->myMember;
b->~B();
OS_Free(buf);
a->accessBMemberVariable(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T23:33:13.153

另一位海报建议：

```
 delete b;
 memset(b,0,sizeof(B)); 
```

请不要这样做！！！写入返回到内存管理器的地址空间是未定义的！！！！

即使您的编译器和库现在让您侥幸逃脱，它也很糟糕。库或平台的更改，甚至编译器的更新都会让你大吃一惊。

想想一个竞争条件，你删除 b，然后其他线程进行分配，b 处的内存被分配，然后你调用 memset！砰，你死定了。

如果您必须在调用删除之前清除内存（谁在乎）将其清零。

```
 memset(b,0,sizeof(B));
 delete b; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T23:53:46.310

如果可以的话，使用放置“新”（[http://www.parashift.com/c++-faq-lite/dtors.html#faq-11.10](http://www.parashift.com/c++-faq-lite/dtors.html#faq-11.10)）并将您在手动调用对象析构函数后给出的块归零。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-18T11:23:00.227

在您的环境中使用调试 malloc/新功能。

在 MSVC 上，链接到调试运行时库。在 FreeBSD 上，根据需要将 MALLOC_OPTIONS 设置为具有“Z”或“J”标志。在其他平台上，阅读文档或替换为具有调试支持的适当分配器。

删除后调用 memset() 在很多层面上都是不好的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T02:21:20.973

在你的例子中你写

'A->accessBMemberVariable' 这是一个错字吗？不应该是 'a->accessBMemberVariable' 吗？

假设它是一个错字（否则整个设计看起来有点奇怪）。

如果您想验证是否正确删除了“a”，最好改为更改处理分配的方式并改用 auto_ptr。这样，您将确保正确删除内容：

```
auto_ptr<A> a( new A );
{
  auto_ptr<B> b( new B(a) ); // B takes ownership of 'a', delete at scope exit
}
a->accessBMemberVariable(); // shouldn't do to well. 
```

和 B 的构造函数，形式为

```
B( auto_ptr<A>& a ) : m_a(a) {;} 
```

在哪里

```
auto_ptr<A> m_a 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-05-18T23:30:14.160

删除`b`后，您实际上无权改写它的位置。但是你通常可以侥幸做到这一点；你会看到程序员`memset`为此使用的代码。

* * *

但是，批准的方法是直接调用析构函数，然后覆盖内存（例如，`memset`），然后调用`delete`对象。这确实需要您的析构函数非常聪明，因为`delete`它将调用析构函数。所以析构函数必须意识到整个对象只不过是`0`'s 并且什么也不做：

```
b->~B();
memset(b, 0, sizeof(b));
delete b; 
```

# tomcat - Web 应用程序用户注册和登录的最佳策略

> ID：880284
> 
> 赞同：0
> 
> 时间：2009-05-18T23:29:10.683
> 
> 标签：tomcat, login

我正在编写一个 Web 应用程序（tomcat 上的 servlet/JSP），并且想了解用户管理（登录和注册）的最佳实践/经验

我更感兴趣

数据库设计安全问题（如何在服务器上存储密码以及如何通过https从cline发送密码）常见错误

ETC

谢谢——贾廷

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T23:35:56.957

当用户创建他们的密码时，您希望创建该密码的哈希（带有一些盐）并存储该哈希。

您应该无法检索要发送给用户的密码。您应该只能根据存储的哈希验证用户的输入。

如果用户忘记了密码，您可以向他们提供重置密码的链接，但向用户发送密码是不好的做法。

# javascript - 使用 javascript 创建一个新的空文档

> ID：880288
> 
> 赞同：4
> 
> 时间：2009-05-18T23:30:04.690
> 
> 标签：javascript, xml, dom

我正在使用一些非常不直观的 xml（所有标签都是诸如“TX”、“H”、“VC”之类的东西）。

我想复制这些数据，但所有标签都重命名为它们的实际含义。我可以创建一个新的空文档来放入我的新的、命名良好的标签吗？

我试过这个：

```
doc = (new DOMParser()).parseFromString("", 'text/xml'); 
```

但是当我这样做时，我会得到一个包含子节点的文档，而不是空的。此外，该孩子的标记名是“parsererror”

那么，有什么想法可以创建一个空文档吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-18T00:09:24.937

我有同样的问题，我解决了如下：

```
xmlDoc = document.implementation.createDocument("", "", null);
root = xmlDoc.createElement("description");
xmlDoc.appendChild(root);
alert((new XMLSerializer()).serializeToString(xmlDoc)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T08:13:53.627

您可以使用以下代码在符合 W3C DOM 的浏览器（IE9+ 和其他浏览器）中创建一个空[文档。](https://developer.mozilla.org/en/DOM/document)

```
var doc = (new DOMParser()).parseFromString('<dummy/>', 'text/xml');
doc.removeChild(doc.documentElement); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T23:34:59.187

我认为没有根节点就无法创建文档。您可以创建一个假节点：

```
doc = (new DOMParser()).parseFromString("<dummy/>", 'text/xml'); 
```

但是，更好的解决方案可能是为节点名称创建常量：

```
// Use different variable names, like RealTxName, if desired
var REAL_TX_NAME = "TX";
var REAL_H_NAME = "H";

...
doc.find (REAL_TX_NAME);
... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-04T20:53:52.310

[WHATWG 的方法规范`createDocument`](//dom.spec.whatwg.org/#dom-domimplementation-createdocument)允许[为](//dom.spec.whatwg.org/#dom-domimplementation-createdocument)的`null`3 个参数中的每一个提供一个`createDocument`，以创建并返回一个“空”XML 文档——一个没有任何根节点并以`application/xml`为其内容类型的文档。

当`document`对象可用（兼容的 Web 用户代理）时，`createDocument`可以使用以下方法引用该方法的实现`document.implementation`：

```
document.implementation.createDocument(null, null, null); 
```

然后，您可以像其他方式一样简单地附加您选择的根节点，如下所示（`empty_doc`将引用由上述调用创建和返回的文档）：

```
empty_doc.appendChild(empty_doc.createElement("foobar")); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-25T23:36:46.203

```
var xmldom = require('xmldom');
var tree = (new xmldom.DOMImplementation()).createDocument(); 
```

# java-native-interface - 试图通过 JNI 将原始图像数据读入 Java

> ID：880291
> 
> 赞同：0
> 
> 时间：2009-05-18T23:30:21.397
> 
> 标签：java-native-interface, bufferedimage

我正在使用 JNI 获取以下格式的原始图像数据：

图像数据以线性数组中每个像素的 DATA32（32 位）格式返回，从图像的左上角到右下角，每行从左到右排列。每个像素都有高 8 位作为 alpha 通道，低 8 位是蓝色通道 - 所以一个像素的位是 ARGB（从最高有效到最低有效，每个通道 8 位）。您必须在某个时候将数据放回原处。

DATA32 格式本质上是 C 中的无符号整数。

所以我获得了一个 int[] 数组，然后尝试通过它创建一个缓冲图像

```
 int w = 1920;
        int h = 1200;

        BufferedImage b = new BufferedImage(w, h, BufferedImage.TYPE_INT_ARGB); 

        int[] f = (new Capture()).capture();
        for(int i = 0; i < f.length; i++){;
                b.setRGB(x, y, f[i]);
        } 
```

f 是具有像素数据的数组。

根据 Java 文档，这应该可以工作，因为 BufferedImage.TYPE_INT_ARGB 是：

表示包含 8 位 RGBA 颜色分量的图像，这些分量被打包到整数像素中。该图像具有带 alpha 的 DirectColorModel。此图像中的颜色数据被认为没有与 alpha 进行预乘。当此类型作为 BufferedImage 构造函数的 imageType 参数时，创建的图像与 JDK1.1 及更早版本中创建的图像一致。

除非通过 8 位 RGBA，否则它们意味着加在一起的所有组件都以 8 位编码？但这是不可能的。

此代码确实有效，但生成的图像与它应该生成的图像完全不同。有成吨的文物。任何人都可以在这里看到明显错误的东西吗？

注意我获得了我的像素数据

```
imlib_context_set_image(im);
data = imlib_image_get_data(); 
```

在我的 C 代码中，使用库 imlib2 和 api [http://docs.enlightenment.org/api/imlib2/html/imlib2_8c.html#17817446139a645cc017e9f79124e5a2](http://docs.enlightenment.org/api/imlib2/html/imlib2_8c.html#17817446139a645cc017e9f79124e5a2)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T01:37:24.277

我是个白痴。

这只是一个错误。

我忘了包括我如何计算上面的 x,y 。

基本上我在使用

```
 int x = i%w;
 int y = i/h; 
```

在 for 循环中，这是错误的。应该

```
 int x = i%w;
 int y = i/w; 
```

不敢相信我犯了这个愚蠢的错误。

# jquery - jQuery 以 CSV 格式获取剩余的 OPTION 值

> ID：880293
> 
> 赞同：1
> 
> 时间：2009-05-18T23:31:47.527
> 
> 标签：jquery

我希望返回一个 CSV 格式的字符串，以使用 SELECT 框中的 OPTION 值设置输入文本字段的值。

> $.map($('#addedchargeamtid option'), function(e) { var exp = $(e).text(); alert(exp); })

在使用 map 函数时，但它看起来每次都会覆盖该值。无法弄清楚如何以某种方式将这些连接在一起。

顺便说一句，感谢今天所有的 jQuery 大师，对我的问题有很多支持！！！

更新：

```
<option value="123">123</option>
<option value="asd">asd</option>
<option value="trr">trr</option>
<option value="345">345</option> 
```

我需要这个：

**123,asd,trr,345**

但是选项是动态的，可以添加或删除，所以可能有 1 或 100

新的：

嗯，这有点工作。当我只添加一次时，它给了我 4 个相同项目的选项。也不会使用 CSV 值更新隐藏的文本字段

```
// Add remove button
$('#addButton').click(function() {
   $('#removeButton').show();

   // Add 
   var myOptions = $('#typedchargeamtid').val();
   $.each(myOptions, function() {
      $('#addedchargeamtid').append(
         $('<option></option>').val(myOptions).html(myOptions)
      );
   });

   var txt = $('#addedchargeamtid').val() || [];
      $('#commasepchargeamtid').val(txt.join(','));
   }); 
```

再次感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T23:52:39.730

您可以使用 each 而不是 map：

```
 var options = Array();
    $('#addedchargeamtid option').each(function(index){
        options[index] = $(this).val();
    });

    $('#commasepchargeamtid').val(options.join(',')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T23:44:36.487

JQuery[文档](http://docs.jquery.com/Attributes/val)指出 $.val() 函数在用于选择时将返回所选值的列表。我相信只需简单地使用它就`array.join`可以完成您正在寻找的东西。

```
var txt = $('#addedchargeamtid option').val() || [];
$('#myinputbox').val(txt.join(',')); 
```

或者Javascript 1.8 中有一个[array.reduce函数](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Global_Objects/Array/Reduce)

```
var txt = $('#addedchargeamtid option').val() || [];
$('#myinputbox').val(txt.reduce(
   function(prev, next, index, array){
       return prev + "," + next;
   },
   '')
); 
```

# c# - C# PropertyGrid 拖放

> ID：880298
> 
> 赞同：3
> 
> 时间：2009-05-18T23:34:05.507
> 
> 标签：c#, drag-and-drop, propertygrid

我正在尝试使用 VS2005 (.NET 2.0) 在 C# 中实现对属性网格的拖放支持。propertygrid 可以处理 dragenter 等事件，但似乎没有办法在拖动事件期间获取指针下的 griditem。到目前为止，我能得到的最好的方法是使用 selectedgriditem 属性来检索自定义属性描述符并设置值，但这需要在开始拖放操作之前已经选择了一个网格项。

有没有人有任何运气来实施这个？

谢谢 ：-）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T07:46:04.877

如果你没有得到任何快乐，你可以试试[SmartPropertyGrid](http://www.visualhint.com/index.php/propertygrid/spgnet/)；我**不知道**它是否会起作用，但它也许值得一看。作为来自第 3 方的“功能请求”，您甚至可能会更加高兴，因为现在 WPF 已经接管了 MS 版本。

# windows - 我应该使用哪个 Windows SVN 服务器？

> ID：880302
> 
> 赞同：37
> 
> 时间：2009-05-18T23:35:23.773
> 
> 标签：windows, svn, version-control, svn-server

在 SVN Windows 二进制文件下载页面上，有几个可供选择：

[http://subversion.tigris.org/getting.html#windows](http://subversion.tigris.org/getting.html#windows)

不同组织提供的不同版本有优缺点吗？有什么我需要注意的吗？

主要是，我只是想要一些免费的东西，我可以在我的 Vista 笔记本电脑上运行。然后我可能会不时将 SVN 文件备份到外部硬盘驱动器。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-19T00:31:55.750

我们选择了[VisualSVN](http://www.visualsvn.com/)，因为它可以轻松使用 Windows 身份验证，而不是拥有单独的 SVN 用户。

其他好处是易于使用的 GUI 用于权限管理和管理 SVN 挂钩。

我不喜欢的一件事是 Web GUI。据我所知，您无法查看基于网络的差异，所以如果这有所作为......

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-18T23:40:14.810

开Windows商店的朋友对[VisualSVN评价很高](http://www.visualsvn.com/)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-05-14T10:52:00.510

我刚刚根据Jeff Atwood的[这篇文章配置](http://www.codinghorror.com/blog/2008/04/setting-up-subversion-on-windows.html)[了 win32svn服务器。](http://sourceforge.net/projects/win32svn/)

与 VisualSVN 相比，win32svn 与 Windows 的集成并没有那么紧密，它以终端使用为导向，并且在 Apache 许可下开源。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-12-27T01:35:45.170

所有这些解决方案都设置了具有 Subversion 集成的标准 Apache HTTPD 服务器。他们没有真正的魔法。

UberSVN 和 VisualSVN 提供了一个漂亮的前端界面，但在幕后，它只是标准的 Apache 设置。如果您不是 CM，并且不希望这成为您的工作，那么这不是一个糟糕的选择。但是，永远不要试图在他们背后调整配置。他们要么恢复更改，要么真的把事情搞砸了。

但是，我使用 Apache httpd 来访问我的 Windows Active Directory。我设置了我的用户，所以他们的 Windows 帐户和密码就是他们的 Subversion 帐户和密码。我将 Active Directory 安全组或 Active Directory Exchange 组设置为我的授权数据库。如果用户是该组的成员，则他们可以通过 Windows 登录访问存储库。如果没有，他们就没有访问权限。干净简单。我不再从事用户授权业务，这让我有更多时间~~玩 Candy Crush~~ ..我的意思是.. 其他 CM 工作。

否则，我还不如直接使用`svnserve`：它比 Apache httpd 更快，更容易设置，也更稳定。

如果您不打算使用 Active Directory 作为您的授权后端，您是技术人员，并且不介意让您的手有点脏，我会使用任何一种游戏`svnserve`（并将其设置为[Windows 服务](https://subversion.open.collab.net/articles/svnserve-service.htm)。不需要任何这些包。

如果您打算使用 Active Directory 作为您的授权后端（为什么不呢？），我会使用 CollabNet Subversion Edge 来帮助设置 Apache httpd 和 Subversion 并手动完成我的所有配置。通过 LDAP 通过 Apache httpd 设置 Active Directory 并没有那么困难，一旦完成，您可能再也不需要接触了。[可以很容易地找到](https://stackoverflow.com/q/5652982/368630)有关集成 Apache httpd/Subversion/LDAP/ActiveDirectory 的文档。

我建议您查看在线[Subversion 文档](http://svnbook.red-bean.com)并仔细阅读。如果考虑使用`svn`命令行客户端让您头晕目眩，那么请获取 VisualSVN 或 UberSVN，让他们为您处理事情。如果您不介意在 1990 年使用您的计算机，那么请忘记漂亮的前端，并使用 CollabNet Edge。

还有一件事，我不是CollabNet Edge 附带的[ViewVC的粉丝。](http://viewvc.org)它必须使用`file://`协议并且必须与您的 Subversion 服务器软件在同一台服务器上运行。相反，我更喜欢[Sventon](http://sventon.org)。它可以在单独的服务器上运行，并且您可以使用与标准 Subversion 凭据相同的凭据。另外，我更喜欢界面。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-03-03T00:05:33.803

为 CollabNet Subversion Edge 投票，通过 Web 前端进行设置和管理非常简单。*如果必须*，我很乐意编辑配置文件，尤其是来自 Linux 环境，但最好不要这样做 - CollabNet 让这一切变得简单。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-26T22:07:03.493

我们将 Apache SSPI 模块与 Collab.Net subversion 服务器一起使用。

对我们来说非常有效。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-12-26T22:23:09.670

试试 UberSVN [http://www.wandisco.com/ubersvn/download#windows](http://www.wandisco.com/ubersvn/download#windows) 唯一的缺点是需要大量服务器内存。我试过的最好的免费 SVN 服务器。VisualSVN 免费版也可以。

# c# - 在 C# 中的 SQLite 数据库上运行并发 INSERTS 很困难

> ID：880303
> 
> 赞同：4
> 
> 时间：2009-05-18T23:35:25.070
> 
> 标签：c#, sqlite, system.data.sqlite

我正在运行多个线程，每个线程都尝试对一个 SQLite 数据库执行 INSERTS。每个线程都创建自己与数据库的连接。他们各自创建一个命令，打开一个事务执行一些 INSERTS，然后关闭事务。似乎尝试任何操作的第二个线程得到以下 SQLiteException：数据库文件已锁定。我尝试从事务中解开 INSERTS 并缩小每个提交中包含的 INSERTS 的范围，但没有实际效果；对 db 文件的后续访问会引发相同的异常。

有什么想法吗？我被难住了，我不知道下一步该往哪里看……

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T23:40:28.413

更新您的插入代码，以便如果遇到指示数据库锁定的异常，它会稍等片刻，然后重试。每次以随机增量增加等待时间（“随机退避”算法）。这应该允许线程各自获取全局写锁。性能会很差，但代码无需重大修改即可工作。

但是，SQLite 不适合高并发修改。您有两个永久解决方案：

*   移至“真实”数据库，例如 PostgreSQL 或 MySQL
*   通过一个线程序列化所有数据库修改，以避免 SQLite 的修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T23:42:04.277

要检查的两件事：

1) 确认您的 SQLite 版本是使用 THREAD 支持编译的

2) 确认您没有打开数据库 EXCLUSIVE

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-12T21:03:29.360

我不是在 C# 中执行此操作，而是在 Android 中执行此操作，但我通过在包装类的整个生命周期内始终在拥有它的包装类中打开 sqlite 数据库来解决这个“数据库已锁定”错误。然后在这个类中完成的每个插入都可以在它自己的线程中（因为，取决于你的数据存储情况，sd 卡与设备内存等，数据库写入可能需要很长时间），我什至尝试限制它，大约一次插入十几个线程，每个线程都处理得很好，因为插入方法不必担心打开/关闭数据库。

我不确定持久性数据库生命周期是否被认为是好的风格（在大多数情况下它可能被认为是不好的），但现在它工作得很好。

# xslt - xsl 使用变量的奇怪行为

> ID：880311
> 
> 赞同：0
> 
> 时间：2009-05-18T23:40:30.190
> 
> 标签：xslt, variables, attributes

我已将文件的树存储到 $onto

```
<xsl:variable name="onto" select="document('file.xml')"/> 
```

在某些地方，我可以按预期使用此变量：

```
<xsl:copy-of select="$onto/rdf:RDF"/> 
```

但是我在其他地方遇到了麻烦，输出上写着奇怪的字符：

```
<xsl:element name="autor">
     <xsl:attribute name="rdf:resource">

     <xsl:text>#</xsl:text> <xsl:value-of select="$onto"/>
     </xsl:attribute>
</xsl:element> 
```

这是我得到的输出的开始：

```
<autor rdf:resource="#&#10;  &#10;  &#10;    &#10;      &#10;    &#10;  &#10;  &#10;    &#10;      &#10;    &#10;  &#10;  &#10;    &#10;      &#10;    &#10;  &#10;  &#10;  &#10;    &#10;  &#10;  &#10;    &#10;      &#10;    &#10;  &#10; 
```

我错过了什么？怎么了？如果这对于一个属性来说太多了，我该怎么办？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T00:03:34.793

当`<xsl:value-of>`应用于树片段时，它会获取该树的文本内容。在您的情况下，您的 XML 文件似乎不包含任何不在属性值中的文本（空格除外）。我怀疑您的意思是选择文档中特定属性节点的值*，*例如：

```
<xsl:value-of select="$onto//foo/@bar"/> 
```

（在不知道 XML 的结构以及您要选择的内容的情况下，我不知道真正的路径是什么。）

# ios - 如何调整图像大小以适合 UITableView 单元格？

> ID：880317
> 
> 赞同：6
> 
> 时间：2009-05-18T23:42:17.223
> 
> 标签：ios, objective-c, uitableview, cocoa-touch, uikit

如何适应，UITableViewCell（？）`UIImage`的单元格。`UITableView`

您是否`addSubview`或`cell`是否有办法调整大小`cell.image`或`UIImage`分配给它之前的大小`cell.image`？

我想保持单元格大小为默认值（无论何时使用零矩形初始化），并希望为每个条目添加类似图片的图标。图像略大于单元格大小（表格行大小）。

我认为代码看起来像这样（从我的脑海中）：

```
UIImage * image = [[UIImage alloc] imageWithName:@"bart.jpg"];
cell = ... dequeue cell in UITableView data source (UITableViewController ...)
cell.text = @"bart";
cell.image = image; 
```

我需要做什么来调整图像大小以适合单元格大小？我见过类似的东西：

```
UIImageView * iview = [[UIImageView alloc] initWithImage:image];
iview.frame = CGRectMake(...); // or something similar
[cell.contentView addSubview:iview] 
```

以上将图像添加到单元格，我可以计算适合它的大小，但是：

1.  我不确定是否有更好的方法，`UIImageView`只是为了调整大小而添加的开销是不是太大了 `cell.image`？
2.  现在我的标签 ( `cell.text`) 需要移动，因为它被图像遮挡了，我看到了一个解决方案，您只需将文本添加为​​标签：

例子：

```
UILabel * text = [[UILable alloc] init];
text.text = @"bart";
[cell.contentView addSubview:iview];
[cell.contentView addSubview:label];
// not sure if this will position the text next to the label
// edited original example had [cell addSubview:label], maybe that's the problem 
```

有人能指出我正确的方向吗？

**编辑**：也许我`[cell.contentview addSubview:view]`不`[cell addSubview:view]`应该看看这个：

```
- (UITableViewCell *)tableView:(UITableView *)tableView
cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = ...;
    CGRect frame = cell.contentView.bounds;
    UILabel *myLabel = [[UILabel alloc] initWithFrame:frame];
    myLabel.text = ...;
    [cell.contentView addSubview:myLabel];
    [myLabel release];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T23:51:23.493

[该站点发布](http://blog.logichigh.com/2008/06/05/uiimage-fix/)了有关重新缩放`UIImage*`. 您可以使用缩放来获得适合`UIImage*`您正在使用的比例，将其缩小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-06T09:43:29.390

如果您可以访问苹果开发者中心，这里有一个关于为表格视图缩放图像的视频。它更专注于性能问题，并讨论了很多关于线程的问题，但他确实展示了一些用于调整图像大小的示例代码。

视频名称：“有效的 iPhone 应用程序开发 - 第 2 部分”，大约 30 分钟。

# c++ - 如何捕获从新的 Popup IE 窗口触发的事件

> ID：880325
> 
> 赞同：0
> 
> 时间：2009-05-18T23:45:59.557
> 
> 标签：c++, activex, browser, mshtml

问候！

**情况：**

我的 ActiveX DLL 包含一个定制的网络浏览器。网络浏览器显示网页。当用户单击显示页面中的链接时，会弹出一个新的 IE 窗口并导航到单击的链接 URL。

**问题：**

如何捕获从新弹出 IE 窗口触发的**DocumenComplete和 NavigateComplete 事件？**

**我已经尝试过的：**

我试图捕获从自定义浏览器（不是新的 IE 窗口）触发的 *NewWindow2(IDispatch **ppDisp, VARIANT_BOOL *Cancel)* 事件，并获得指向新 IE 窗口的指针 ppDisp。我尝试将此指针用作事件源来建议或连接到事件处理程序 (IDispatch::Invoke) 以进行事件捕获。但是它不起作用。可能是因为新的 IE 窗口中的文档还没有加载。我不知道。

你能给我一个建议我应该怎么做吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T13:15:49.370

您没有在 ppDisp 中获得新的 Web 浏览器。您创建一个接收事件，并将其在 ppDisp 中的应用程序属性返回给事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T14:31:13.583

```
void CYourDlg::OnNewWindow2(LPDISPATCH FAR* ppDisp, BOOL FAR* Cancel)
{
  CDlgNewWB* dlgNewWB = new CYourDlg;
  this.listDialogWeb.Add(dlgNewWB);
  dlgNewWB ->Create(IDD_WBDLG_DIALOG);

  dlgNewWB ->m_webBrowser.SetRegisterAsBrowser(TRUE);

  *ppDisp = dlgNewWB ->m_webBrowser.GetApplication(); 
```

}

# algorithm - 功能学习困境

> ID：880329
> 
> 赞同：3
> 
> 时间：2009-05-18T23:47:57.040
> 
> 标签：algorithm, haskell, coding-style

我是函数式语言的初学者，我正试图在 Haskell 中完成所有工作。这是一个快速而简单的函数，可以找到一个数字的所有因数：

```
factors :: (Integral a) => a -> [a]
factors x = filter (\z -> x `mod` z == 0) [2..x `div` 2] 
```

工作正常，但我发现它对于大量的人来说慢得难以忍受。所以我让自己变得更好：

```
factorcalc :: (Integral a) => a -> a -> [a] -> [a]
factorcalc x y z
    | y `elem` z      = sort z
    | x `mod` y == 0  = factorcalc x (y+1) (z ++ [y] ++ [(x `div` y)])
    | otherwise       = factorcalc x (y+1) z 
```

但这是我的问题：尽管代码有效，并且可以从字面上减少程序的执行时间，但它是*可怕的！*

它散发着难看的命令式思维的味道：它不断地循环更新计数器和数据结构，直到完成。由于您无法在纯函数式编程中更改状态，因此我通过将数据保存在参数中来作弊，函数只是一遍又一遍地传递给自己。

我可能错了，但必须有更好的方法来做同样的事情......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-19T02:14:01.177

请注意，原始问题要求*所有*因素，而不仅仅是*主要*因素。主要因素的数量要少得多，因此可能可以更快地找到它们。也许这就是 OQ 想要的。也许不是。但是让我们解决原来的问题，把“乐趣”放回“功能”！

一些观察：

*   这两个函数不会产生相同的输出——如果 x 是一个完全平方，则第二个函数包含两次平方根。

*   第一个函数枚举检查与 x 的大小成正比的一些潜在因素；第二个函数仅检查**与 的平方根成比例`x`**，然后停止（存在上述错误）。

*   第一个函数 ( `factors`) 分配从 2 到 的所有整数的列表`n div 2`，其中第二个函数从不分配列表，而是在参数中一次访问*更少的整数。*我使用 运行优化器`-O`并查看输出`-ddump-simpl`，而 GHC 还不够聪明，无法优化掉这些分配。

*   `factorcalc`是尾递归的，这意味着它编译成一个紧密的机器代码循环；`filter`不是，也没有。

一些实验表明**平方根是杀手**：

这是一个示例函数，它产生从 z 到 2 的 x 因子：

```
factors_from x 1 = []
factors_from x z 
  | x `mod` z == 0 = z : factors_from x (z-1)
  | otherwise      =     factors_from x (z-1)

factors'' x = factors_from x (x `div` 2) 
```

它有点快，因为它不分配，但它仍然不是尾递归的。

这是一个更忠实于原始版本的尾递归版本：

```
factors_from' x 1 l = l
factors_from' x z l
  | x `mod` z == 0 = factors_from' x (z-1) (z:l)
  | otherwise      = factors_from' x (z-1) l

factors''' x = factors_from x (x `div` 2) 
```

这仍然比它慢，`factorcalc`因为它枚举了从 2 到 的所有整数`x div 2`，而`factorcalc`在平方根处停止。

有了这些知识，我们现在可以创建一个功能更强大的版本，`factorcalc`它可以复制它的速度和错误：

```
factors'''' x = sort $ uncurry (++) $ unzip $ takeWhile (uncurry (<=)) $ 
                [ (z, x `div` z) | z <- [2..x], x `mod` z == 0 ] 
```

我没有准确计时，但是输入 1 亿作为输入，它和`factorcalc`瞬间终止，其他都需要几秒钟。

该功能的工作方式和原因留给读者作为练习:-)

* * *

**附录**：好的，为了减轻眼球出血，这里有一个稍微理智的版本（并且没有错误）：

```
saneFactors x = sort $ concat $ takeWhile small $
                [ pair z | z <- [2..], x `mod` z == 0 ]
    where pair z = if z * z == x then [z] else [z, x `div` z]
          small [z, z'] = z < z'
          small [z]     = True 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T00:07:48.733

好吧，深呼吸。一切都会好的。

首先，*为什么*你的第一次尝试很慢？它是如何度过时间的？

你能想出一个不具有该属性的素数分解的递归定义吗？

（[提示](http://www.amby.com/educate/math/2-1_fact.html)。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T09:28:46.073

> 由于您无法在纯函数式编程中更改状态，因此我通过将数据保存在参数中来作弊，函数只是一遍又一遍地传递给自己。

实际上，这不是作弊。这是——不，让它*成为*——标准技术！这种参数通常被称为“累加器”，它通常隐藏在一个辅助函数中，该辅助函数在您调用的函数设置后执行实际递归。

一个常见的情况是当您执行依赖于列表中先前数据的列表操作时。您需要解决的两个问题是，您从哪里获得有关先前迭代的数据，以及您如何处理任何特定迭代的“感兴趣的工作区域”实际上位于结果列表的尾部这一事实重建。对于这两者，蓄能器来救援。例如，要生成一个列表，其中每个元素都是输入列表中截至该点的所有元素的总和：

```
sums :: Num a => [a] -> [a]
sums inp = helper inp []
    where
        helper []     acc       = reverse acc
        helper (x:xs) []        = helper xs [x]
        helper (x:xs) acc@(h:_) = helper xs (x+h : acc) 
```

请注意，我们翻转了累加器的方向，因此我们可以在其头部进行操作，这样效率更高（正如 Dominic 所提到的），然后我们只需反转最终输出。

顺便说一句，我发现阅读*The Little Schemer*是一个有用的介绍，并提供了递归思考的良好实践。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T01:39:17.940

首先，虽然`factorcalc`“丑陋”，但您可以添加一个包装函数`factors' x = factorscalc x 2 []`，添加评论，然后继续。

如果你想让一个“漂亮”的`factors`快，你需要找出它慢的原因。查看您的两个函数，遍历`factors`列表大约*n* /2 个元素，但在迭代`factorcalc`后停止。`sqrt n`

这是另一个`factors`在 about 迭代后也停止`sqrt n`的，但使用折叠而不是显式迭代。它还将问题分为三个部分：找到因素（`factor`）；*在x* ( )的平方根处停止，`small`然后计算因子对 ( `factorize`)：

```
因素' :: (Integral a) => a -> [a]
因子' x = sort (foldl factorize [] (takeWhile small (filter factor [2..])))
  在哪里
    因子 z = x `mod` z == 0
    小 z = z <= (x `div` z)
    分解 acc z = z : (如果 z == y 那么 acc else y : acc)
      其中 y = x `div` z

```

这比`factorscalc`我的机器上要快一点。你可以融合`factor`和`factorize`它的速度大约是`factorscalc`.

Real World Haskell的[Profiling and Optimization 章节](http://book.realworldhaskell.org/read/profiling-and-optimization.html)是 GHC 套件性能工具的一个很好的指南，用于解决更棘手的性能问题。

顺便说一句，我有一个次要风格的 nitpick ：将单个元素添加到列表 O(1) 的前面比添加到长度为*n* O(n)`factorscalc`的列表的末尾要高效得多。因素列表通常很小，所以没什么大不了的，但可能应该是这样的：*`factorcalc`*

 *```
factorcalc :: (Integral a) => a -> a -> [a] -> [a]
因子计算 xyz
    | y `elem` z = 排序 z
    | x `mod` y == 0 = factorcalc x (y+1) (y : (x `div` y) : z)
    | 否则 = 因子计算 x (y+1) z

```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T12:09:33.753

这似乎是一个有趣的问题，而且我已经有一段时间没有编写任何真正的 Haskell 代码了，所以我试了一下。我已经`factors''''`针对相同的值运行了它和 Norman 的值，*感觉*就像我的更快，尽管它们都非常接近以至于很难分辨。

```
factors :: Int -> [Int]
factors n = firstFactors ++ reverse [ n `div` i | i <- firstFactors ]
    where
    firstFactors = filter (\i -> n `mod` i == 0) (takeWhile ( \i -> i * i <= n ) [2..n]) 
```

因子可以配对成大于`sqrt n`和小于或等于的因子（为简单起见，确切的平方根，如果`n`是一个完美的平方，则属于这一类。所以如果我们只取那些小于等于，后面的可以通过做 来计算`div n i`。它们的顺序是倒序的，所以我们可以`firstFactors`先倒序，也可以后倒序。没关系。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T15:19:40.953

这是我解决问题的“功能性”方法。（引号中的“功能性”，因为即使在非功能性语言中我也会以同样的方式解决这个问题，但也许那是因为我被 Haskell 污染了。）

```
{-# LANGUAGE PatternGuards #-}
factors :: (Integral a) => a -> [a]
factors = multiplyFactors . primeFactors primes 0 [] . abs where
    multiplyFactors [] = [1]
    multiplyFactors ((p, n) : factors) =
        [ pn * x
        | pn <- take (succ n) $ iterate (* p) 1
        , x <- multiplyFactors factors ]
    primeFactors _ _ _ 0 = error "Can't factor 0"
    primeFactors (p:primes) n list x
        | (x', 0) <- x `divMod` p
        = primeFactors (p:primes) (succ n) list x'
    primeFactors _ 0 list 1 = list
    primeFactors (_:primes) 0 list x = primeFactors primes 0 list x
    primeFactors (p:primes) n list x
        = primeFactors primes 0 ((p, n) : list) x
    primes = sieve [2..]
    sieve (p:xs) = p : sieve [x | x <- xs, x `mod` p /= 0] 
```

`primes`是 Eratothenes 的幼稚筛子。有更好的方法，但这是最短的方法。

```
 sieve [2..]
=> 2 : sieve [x | x <- [3..], x `mod` 2 /= 0]
=> 2 : 3 : sieve [x | x <- [4..], x `mod` 2 /= 0, x `mod` 3 /= 0]
=> 2 : 3 : sieve [x | x <- [5..], x `mod` 2 /= 0, x `mod` 3 /= 0]
=> 2 : 3 : 5 : ... 
```

`primeFactors`是简单的重复试除算法：它遍历素数列表，并尝试将给定的数除以每个数，同时记录因数。

```
 primeFactors (2:_) 0 [] 50
=> primeFactors (2:_) 1 [] 25
=> primeFactors (3:_) 0 [(2, 1)] 25
=> primeFactors (5:_) 0 [(2, 1)] 25
=> primeFactors (5:_) 1 [(2, 1)] 5
=> primeFactors (5:_) 2 [(2, 1)] 1
=> primeFactors _ 0 [(5, 2), (2, 1)] 1
=> [(5, 2), (2, 1)] 
```

`multiplyPrimes`获取素数和幂的列表，并将其分解为完整的因子列表。

```
 multiplyPrimes [(5, 2), (2, 1)]
=> [ pn * x
   | pn <- take (succ 2) $ iterate (* 5) 1
   , x <- multiplyPrimes [(2, 1)] ]
=> [ pn * x | pn <- [1, 5, 25], x <- [1, 2] ]
=> [1, 2, 5, 10, 25, 50] 
```

`factors`只需将这两个函数串在一起，再加上一个`abs`以防止在输入为负数的情况下无限递归。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T23:52:35.877

我对 Haskell 了解不多，但不知何故我认为这个链接是合适的：

[http://www.willamette.edu/~fruehr/haskell/evolution.html](http://www.willamette.edu/~fruehr/haskell/evolution.html)

编辑：我不完全确定为什么人们对此投票反对如此激进。原始发帖人的真正问题是代码很难看。虽然很有趣，但链接文章的重点是，在某种程度上，高级 Haskell 代码实际上是丑陋的；在某种程度上，你学得越多，你的代码就越难看。这个答案的重点是向 OP 指出，显然，他所感叹的代码的丑陋并不少见。

# bash - bash 检查用户挂载是否失败

> ID：880330
> 
> 赞同：4
> 
> 时间：2009-05-18T23:48:10.863
> 
> 标签：bash, sshfs

我正在编写一个脚本来通过 sftp 传输一些文件。我想通过使用 sshfs 挂载目录来将传输作为本地传输进行，因为它可以更轻松地创建所需的目录结构。我遇到的问题是我不确定如何处理没有网络连接的情况。基本上我需要一种方法来判断 sshfs 命令是否失败。如果无法挂载远程目录，有什么想法可以使脚本退出吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T23:53:06.843

只需测试是否`sshfs`返回 0（成功）：

```
sshfs user@host:dir mountpoint || exit 1 
```

上面的工作是因为在 bash 中逻辑或`||`执行[短路评估](http://en.wikipedia.org/wiki/Short-circuit_evaluation)。允许您打印错误消息的更好的解决方案如下：

```
if !( sshfs user@host:dir mountpoint ); then
  echo "Mounting failed!"
  exit 1
fi 
```

**编辑：**

> 我要指出，这是您在大多数平台上检查几乎所有表现良好的应用程序是否成功的方式。– [Sparr](https://stackoverflow.com/users/13675/sparr) 1 分钟前

确实。更详细地说：大多数应用程序在成功时返回 0，在失败时返回另一个值。shell 知道这一点，因此将返回值 0 解释为 true，将任何其他值解释为 false。因此逻辑或和否定测试（使用感叹号）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-10T20:45:32.263

我试图检查一个目录是否不是挂载的`sshfs`挂载点。使用上面的示例失败：

```
if !( mountpoint -q /my/dir ); then
    echo "/my/dir is not a mountpoint"
else
    echo "/my/dir is a mountpoint"
fi 
```

错误：`-bash: !( mountpoint -q /my/dir ): No such file or directory`

我用以下内容修改了我的代码并取得了成功：

```
if (! mountpoint -q /my/dir ); then
    echo "/my/dir is not a mountpoint"
else
    echo "/my/dir is a mountpoint"
fi 
```

# c# - 使用 linq 连接查询

> ID：880347
> 
> 赞同：0
> 
> 时间：2009-05-18T23:54:37.947
> 
> 标签：c#, linq, .net-3.5, c#-3.0, left-join

我在这里尝试将一些左连接加入到 linq 查询中，但我想说我宁愿不知道如何实现这个想法。

基本上这里是我想玩的 3 个数据库结构。

```
<tags>
id | name

<events_tags>
tag_id | event_id

<events>
id | name | some-other-fields 
```

所以对于每个事件，标签之间存在一对多的关系，一个事件可以有一个或多个标签。

我想知道如何根据标签搜索事件，或者我如何根据事件 ID 知道相关标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T00:05:58.703

你想在这里做多对多加入吗，看起来那样.... Linq to sql 不支持这个...这是一篇很棒的文章

[http://blogs.msdn.com/mitsu/archive/2007/06/21/how-to-implement-a-many-to-many-relationship-using-linq-to-sql.aspx](http://blogs.msdn.com/mitsu/archive/2007/06/21/how-to-implement-a-many-to-many-relationship-using-linq-to-sql.aspx)

这个来自 Scott Guthrie 的文章对于掌握基础知识很有用

[http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx](http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx)

希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T00:23:26.157

要按标签搜索事件，我认为您可以编写如下内容：

```
var tagsIds = from t in DataContext.Tags
              where t.Name == "sometag"
              select t.id;

var eventsByTag = from et in DataContext.EventTags
                  where tagsIds.Contains(et.tag_id)
                  select et.Event; 
```

要获取事件的标签：

```
var tagsByEvent = from et in myEvent.EventTags
                  select et.Tag; 
```

对于后者，为方便起见，您可以将其放在 Events 的属性中：

```
public List<Tag> Tags
{
   get
   {
      List<Tag> tags = (from et in this.EventTags
                        select et.Tag).ToList();
      return tags;
   }
} 
```

只需在需要它们的地方参考 myEvent.Tags 即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T00:59:51.810

要查找指定标签名称的事件名称，您可以执行以下操作：

```
Console.WriteLine("\nEvents tagged as .NET:\n");

(from evtTag in ctx.EventsTags
 join tag in ctx.Tags on evtTag.TagID equals tag.ID
 where tag.Name == ".NET"
 join evt in ctx.Events on evtTag.EventID equals evt.ID
 select evt)
 .ToList()
 .ForEach(evt => Console.WriteLine(evt.Name)); 
```

同样，您可以搜索具有特定事件名称的标签，如下所示：

```
Console.WriteLine("\nTags for TechEd:\n");

(from evtTag in ctx.EventsTags
 join evt in ctx.Events on evtTag.EventID equals evt.ID
 where evt.Name == "TechEd"
 join tag in ctx.Tags on evtTag.TagID equals tag.ID
 select tag)
 .ToList()
 .ForEach(tag => Console.WriteLine(tag.Name)); 
```

请注意我是如何从连接表开始的，使用已知值对表进行连接和过滤，然后使用搜索到的值连接到表。

乔

# visual-studio-2008 - 替换vs2008中的文本块

> ID：880348
> 
> 赞同：1
> 
> 时间：2009-05-18T23:54:42.067
> 
> 标签：visual-studio-2008, text, replace, multiline

有什么方法可以替换 VS2008（VS2005）中的文本块（多行）？到目前为止，我知道 VS2008 只支持单行替换。

欢迎任何提示，欢呼X。

编辑：感谢提示家伙。我宁愿寻找一些更简单的选项：比如选择多行文本，单击 Ctrl+H、Ctrl+V（从内存中复制文本）并点击全部替换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T23:56:38.817

Visual Studio 2005（可能更早）支持正则表达式，允许选择和替换多行文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T23:59:15.223

CTRL+H -> 查找选项 -> 使用正则表达式 | 通配符。然后您可以按下“查找内容”和“替换为”文本框旁边的右箭头，看看您可以使用什么。说明[在这里](http://msdn.microsoft.com/en-us/library/87a13zt0.aspx)。

# html - 我可以使用 CSS 在同一个元素上设置两个背景图像吗？

> ID：880350
> 
> 赞同：9
> 
> 时间：2009-05-18T23:55:50.847
> 
> 标签：html, css

示例 HTML 代码：

```
<table>
<tr>
 <td class="a b"> 
```

示例 CSS 文件：

```
.a
{
  background-image:url(a.png);
}

.b
{
  background-image:url(b.png);
} 
```

似乎“b”部分被忽略了。

有没有办法将两个图像包含在同一个单元格中，即使使用其他技术？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-05-29T02:10:02.453

现在您可以使用 CSS3。[http://www.zenelements.com/blog/css3-background-images/](http://www.zenelements.com/blog/css3-background-images/)

```
#my_CSS3_id {
background: url(image_1.extention) top left no-repeat,
url(image_2.extention) bottom left no-repeat,
url(image_3.extention) bottom right no-repeat;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-18T23:58:54.273

你可以这样做：

```
<td class="a"><div class="b">...</div></td> 
```

然后`td`将有第一个背景，`div`内部将有第二个。如果一个是透明的，另一个将显示出来。我认为`b.png`会在顶部，但我不确定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T00:00:42.647

不，背景图像的每个声明都将替换/覆盖给定元素的前一个声明。您需要为要应用的每个其他背景嵌套一个元素。如果您尝试为元素应用精美的边框，CSS3 中有一些新的边框属性，但它们并未得到广泛支持。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T00:08:52.770

像这样的东西可以工作：

```
<table>
<tr>
  <td class="a">
    <div class="b"> 
```

和CSS：

```
.a
{
  background: url(a.png) top left no-repeat;
}

.b
{
  background: url(b.png) top right no-repeat;
} 
```

将 div 设置得足够宽，你会看到一张图片漂浮在左上角，另一张图片漂浮在右上角

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T01:08:18.050

这是一个有趣的想法，但想想其他属性是如何工作的，比如颜色。

```
.a { color: red; }
.b { color: blue; } 
```

文字怎么可能是*红色*和*蓝色*？在这种情况下，蓝色赢得了决胜局，因为它是稍后指定的。

如果您可以创建一个图像 ab.png，它是 a.png 和 b.png 组合的结果，可能还有另一种方法。

```
.a { background-image(a.png) }
.b { background-image(b.png) }
.a.b { background-image(ab.png) } 
```

警告：它在 IE6 中不起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T23:59:20.777

您不能将两个图像都作为单元格的背景图像。您需要制作 2 个单元格或将图像作为`<img ... />`标签放在单元格内。还有一些浏览器在阅读 class="ab c" 类定义时遇到问题。

# .net - setter中的数据绑定和抛出异常

> ID：880357
> 
> 赞同：6
> 
> 时间：2009-05-18T23:59:38.920
> 
> 标签：.net, winforms, data-binding, exception, setter

假设我有一个简单的课程

```
public class Person
{
  public string Name { get; set; }

  private int _age;
  public int Age
  {
    get { return _age; }
    set
    {
      if(value < 0 || value > 150)
        throw new ValidationException("Person age is incorrect");
      _age = value;
    }
  }
} 
```

然后我想为这个类设置一个绑定：

```
txtAge.DataBindings.Add("Text", dataSource, "Name"); 
```

现在，如果我在文本框中输入不正确的年龄值（比如 200），setter 中的异常将被吞下，并且在我更正文本框中的值之前，我将无法做任何事情。我的意思是文本框将无法失去焦点。这一切都是无声的——没有错误——在你更正值之前，你什么也做不了（甚至关闭表单或整个应用程序）。

这似乎是一个错误，但问题是：解决方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T11:39:14.173

好的，这是解决方案：

我们需要处理 BinsingSource、CurrencyManager 或 BindingBanagerBase 类的 BindingComplete 事件。代码可能如下所示：

```
/* Note the 4th parameter, if it is not set, the event will not be fired. 
It seems like an unexpected behavior, as this parameter is called 
formattingEnabled and based on its name it shouldn't affect BindingComplete 
event, but it does. */
txtAge.DataBindings.Add("Text", dataSource, "Name", true)
.BindingManagerBase.BindingComplete += BindingManagerBase_BindingComplete;

...

void BindingManagerBase_BindingComplete(
  object sender, BindingCompleteEventArgs e)
{
  if (e.Exception != null)
  {
    // this will show message to user, so it won't be silent anymore
    MessageBox.Show(e.Exception.Message); 
    // this will return value in the bound control to a previous correct value
    e.Binding.ReadValue();
  }
} 
```

# vba - 在 VBA 中读取撤消历史记录

> ID：880363
> 
> 赞同：5
> 
> 时间：2009-05-19T00:01:06.420
> 
> 标签：vba, ms-word, undo

我在 Word 2003 中有一个相当简单的 VBA，将文档的字体更改为“生态字体”（长篇故事），并打开“打印”对话框。

当用户点击取消或确定时，代码会执行“撤消”以恢复更改。

问题是，有时当我按“确定”打印文档时，需要撤消*两个操作（“字体更改”和“更新字段”）。*我似乎无法预测何时会发生这种情况。

有没有办法读取 Word 撤消缓冲区中的最后一项？这样我就可以一直按撤消，直到字体更改完成。

**编辑：** 最终代码（减少）：

```
ActiveDocument.Range.Bookmarks.Add ("_tempEcoUndoStart_") 
ActiveDocument.Content.Font.Name = "Nanonymus Eco Sans" 
Dialogs(wdDialogFilePrint).Show 
While ActiveDocument.Bookmarks.Exists("_tempEcoUndoStart_") 
    ActiveDocument.Undo 
Wend 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-20T10:28:30.627

您可以使用一个技巧在 Word 中进行类似“事务性”的撤消：在宏的开头在整个文档上放置一个特殊的书签。完成宏后，您应该再次删除此书签。现在，当调用撤消命令时，在文档中有您的特殊书签时重复撤消。

以下相关问题有详细信息：

> [**我可以在 Word 或 Excel 中创建撤消事务吗？(VSTO)**](https://stackoverflow.com/questions/661269/can-i-create-an-undo-transaction-in-word-or-excel-vsto)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T11:29:36.643

我还没有测试过，但也许你可以在你的动作之前使用 UndoClear，然后再使用 undo？

```
ActiveDocument.UndoClear
ActiveDocument.Undo 2 
```

# java - 有什么方法可以调用私有方法？

> ID：880365
> 
> 赞同：167
> 
> 时间：2009-05-19T00:01:10.540
> 
> 标签：java, reflection, private

我有一个使用 XML 和反射将`Object`s 返回到另一个类的类。

通常这些对象是外部对象的子字段，但偶尔它是我想动态生成的。我尝试过这样的事情，但无济于事。我相信这是因为 Java 不允许您访问`private`反射方法。

```
Element node = outerNode.item(0);
String methodName = node.getAttribute("method");
String objectName = node.getAttribute("object");

if ("SomeObject".equals(objectName))
    object = someObject;
else
    object = this;

method = object.getClass().getMethod(methodName, (Class[]) null); 
```

如果提供的方法是`private`，则失败并显示`NoSuchMethodException`. 我可以通过制作方法来解决它`public`，或者制作另一个类来派生它。

长话短说，我只是想知道是否有办法`private`通过反射访问方法。

* * *

## 回答 #1

> 赞同：326
> 
> 时间：2009-05-19T00:13:28.317

您可以使用反射调用私有方法。修改发布代码的最后一位：

```
Method method = object.getClass().getDeclaredMethod(methodName);
method.setAccessible(true);
Object r = method.invoke(object); 
```

有几点需要注意。首先，`getDeclaredMethod`只会找到在 current 中声明的方法`Class`，而不是从超类型继承的。因此，如有必要，向上遍历具体的类层次结构。二是一种`SecurityManager`可以防止使用的`setAccessible`方法。因此，它可能需要作为`PrivilegedAction`（使用`AccessController`或`Subject`）运行。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-05-19T00:06:13.260

用于`getDeclaredMethod()`获取私有 Method 对象，然后用于`method.setAccessible()`允许实际调用它。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-09-20T06:10:38.903

如果该方法接受非原始数据类型，则可以使用以下方法调用任何类的私有方法：

```
public static Object genericInvokeMethod(Object obj, String methodName,
            Object... params) {
        int paramCount = params.length;
        Method method;
        Object requiredObj = null;
        Class<?>[] classArray = new Class<?>[paramCount];
        for (int i = 0; i < paramCount; i++) {
            classArray[i] = params[i].getClass();
        }
        try {
            method = obj.getClass().getDeclaredMethod(methodName, classArray);
            method.setAccessible(true);
            requiredObj = method.invoke(obj, params);
        } catch (NoSuchMethodException e) {
            e.printStackTrace();
        } catch (IllegalArgumentException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InvocationTargetException e) {
            e.printStackTrace();
        }

        return requiredObj;
    } 
```

接受的参数是 obj、methodName 和参数。例如

```
public class Test {
private String concatString(String a, String b) {
    return (a+b);
}
} 
```

方法 concatString 可以调用为

```
Test t = new Test();
    String str = (String) genericInvokeMethod(t, "concatString", "Hello", "Mr.x"); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2018-05-14T12:48:14.683

您可以使用 Spring 的 ReflectionTestUtils ( [org.springframework.test.util.ReflectionTestUtils](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/test/util/ReflectionTestUtils.html) )来做到这一点

```
ReflectionTestUtils.invokeMethod(instantiatedObject,"methodName",argument); 
```

示例：如果您有一个带有私有方法的类`square(int x)`

```
Calculator calculator = new Calculator();
ReflectionTestUtils.invokeMethod(calculator,"square",10); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-04-05T10:20:33.837

让我通过反射为执行受保护的方法提供完整的代码。它支持任何类型的参数，包括泛型、自动装箱参数和空值

```
@SuppressWarnings("unchecked")
public static <T> T executeSuperMethod(Object instance, String methodName, Object... params) throws Exception {
    return executeMethod(instance.getClass().getSuperclass(), instance, methodName, params);
}

public static <T> T executeMethod(Object instance, String methodName, Object... params) throws Exception {
    return executeMethod(instance.getClass(), instance, methodName, params);
}

@SuppressWarnings("unchecked")
public static <T> T executeMethod(Class clazz, Object instance, String methodName, Object... params) throws Exception {

    Method[] allMethods = clazz.getDeclaredMethods();

    if (allMethods != null && allMethods.length > 0) {

        Class[] paramClasses = Arrays.stream(params).map(p -> p != null ? p.getClass() : null).toArray(Class[]::new);

        for (Method method : allMethods) {
            String currentMethodName = method.getName();
            if (!currentMethodName.equals(methodName)) {
                continue;
            }
            Type[] pTypes = method.getParameterTypes();
            if (pTypes.length == paramClasses.length) {
                boolean goodMethod = true;
                int i = 0;
                for (Type pType : pTypes) {
                    if (!ClassUtils.isAssignable(paramClasses[i++], (Class<?>) pType)) {
                        goodMethod = false;
                        break;
                    }
                }
                if (goodMethod) {
                    method.setAccessible(true);
                    return (T) method.invoke(instance, params);
                }
            }
        }

        throw new MethodNotFoundException("There are no methods found with name " + methodName + " and params " +
            Arrays.toString(paramClasses));
    }

    throw new MethodNotFoundException("There are no methods found with name " + methodName);
} 
```

方法使用 apache ClassUtils 检查自动装箱参数的兼容性

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-04-05T15:51:14.827

另一种变体是使用非常强大的 JOOR 库[https://github.com/jOOQ/jOOR](https://github.com/jOOQ/jOOR)

```
MyObject myObject = new MyObject()
on(myObject).get("privateField"); 
```

它允许修改任何字段，如最终静态常量并调用 yne 受保护的方法，而无需在继承层次结构中指定具体类

```
<!-- https://mvnrepository.com/artifact/org.jooq/joor-java-8 -->
<dependency>
     <groupId>org.jooq</groupId>
     <artifactId>joor-java-8</artifactId>
     <version>0.9.7</version>
</dependency> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-09T04:41:41.167

您可以使用[Manifold 的](https://github.com/manifold-systems/manifold) **@Jailbreak**进行直接的、类型安全的 Java 反射：

```
@Jailbreak Foo foo = new Foo();
foo.callMe();

public class Foo {
    private void callMe();
} 
```

`@Jailbreak`解锁`foo`编译器中的局部变量，以便直接访问`Foo`的层次结构中的所有成员。

同样，您可以将**jailbreak()**扩展方法用于一次性使用：

```
foo.jailbreak().callMe(); 
```

通过该`jailbreak()`方法，您可以访问`Foo`层次结构中的任何成员。

在这两种情况下，编译器都会以类型安全的方式为您解析方法调用，就像一个公共方法一样，而 Manifold 会在后台为您生成高效的反射代码。

或者，如果类型不是静态已知的，您可以使用[结构](http://manifold.systems/docs.html#structural-interfaces)类型来定义一个类型可以满足的接口，而无需声明其实现。此策略维护类型安全并避免与反射和代理代码相关的性能和身份问题。

了解有关[歧管](http://manifold.systems/)的更多信息。

# windows-7 - Windows 7 中的桌面窗口管理器

> ID：880367
> 
> 赞同：1
> 
> 时间：2009-05-19T00:01:58.930
> 
> 标签：windows-7, dwm

Windows 7 中是否有任何新的 DWM API？如果是这样，我在哪里可以找到有关它们的文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T00:08:18.823

Windows 7 API 已经记录在 MSDN 上。请参阅[http://msdn.microsoft.com/en-us/library/aa969499(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa969499(VS.85).aspx)

以下 API 似乎是新的：

*   DwmSetIconicLivePreviewBitmap
*   DwmInvalidateIconicBitmaps
*   DwmSetIconicThumbnail

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T00:06:30.873

[在windows 博客](http://windowsteamblog.com/blogs/developers/default.aspx)上有一些关于 Windows 7 库和 API 的信息。这可能会引导你找到你正在寻找的东西。

# jquery-ui-tabs - 使用jquery ui选项卡插件时如何不在选项卡中执行脚本代码

> ID：880373
> 
> 赞同：0
> 
> 时间：2009-05-19T00:04:20.440
> 
> 标签：jquery-ui-tabs

我刚刚遇到 jquery ui tabs 插件。

它是一个非常好的实现，但是如果当前代码已经到位。

```
<div id="tabs">
    <ul>
        <li><a href="#tabs-1">tab1 </a></li>
        <li><a href="#tabs-2">tab2</a></li>

    </ul>
    <div id="tabs-1"><%System.out.println("test1");%></div>
    <div id="tabs-2"><%System.out.println("test2");%></div>
</div> 
```

在这种情况下，当页面最初加载时，tab1 是默认选项卡。但是，这两个 sys out 语句都是最初执行的。默认选项卡是什么并不重要。理想情况下，第一个 sys out 应该在选择 tab1 时执行，第二个在选择 tab2 时执行。

有没有办法避免这种情况？或者唯一的方法是为不同的选项卡设置不同的页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T01:12:59.303

scriptlet 将执行，因为它不受 javascript 的限制。如果您有内容`tabs-1`并且`tabs-2`除非单击选项卡，否则您不想执行，那么您应该使用此插件的“ajax”功能。[演示站点](http://jqueryui.com/demos/tabs/#ajax)显示了如何执行此操作。

# jquery - jQuery：使相应的文本框影响彼此的值

> ID：880375
> 
> 赞同：2
> 
> 时间：2009-05-19T00:05:11.343
> 
> 标签：jquery, textbox

情况：

2 个文本框，TextBoxA 和 TextBoxB。我在 TextBoxA 中输入文本，它设置了 TextBoxB 的值。现在，我需要能够编辑 TextBoxB 的值，并设置 TextBoxA 的值。很简单，但我需要它来处理单个页面上的几对文本框。

这是我到目前为止所拥有的：

```
$(function() {
        $(':text').css("border", "1px solid #666"); // Remove for actual app

        // Sets value of corresponding textbox by ID
        $(':text').blur(function() {
            $('#inputval_' + ($(this).attr("id"))).val($(this).val());
        });

        //Styles all inputs set to read only
        $('input[readonly=readonly]').css("border", "none");

        $('input[readonly=readonly]').click(function() {// on click allows edit of readonly inputs
            if ($(this).attr("readonly") == true) {
                $(this).removeAttr("readonly");
                $(this).css("border", "1px solid #666");
            }
            $(this).blur(function() {//on blur sets readonly back to true
                if ($(this).attr("readonly") == false) {
                    $(this).attr("readonly", "readonly");
                    $(this).css("border", "none");
                    $('#' + ($(this).attr(("id").remove("inputval_")))).val($(this).val());
                }
            });
        });

    }); 
```

和：

```
<input type="text" id="text1" name="userinput" /><br /><br />
<input type="text" id="text2" name="userinput" /><br /><br />
<input type="text" readonly="readonly" id="inputval_text1" />
<input type="text" readonly="readonly" id="inputval_text2" /> 
```

一切正常，除了使第二组文本框影响其对应的对应项。你能看出我做错了什么吗？我几乎是一个 JavaScript/jQuery 菜鸟（我大部分时间都花在 CSS/XHTML 上）所以要温柔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T03:32:13.173

我发现了问题。这是非常微妙的。第二组的选择器需要更改为：

```
$('#' + ($(this).attr(("id").remove("inputval_")))).val($(this).val()); 
```

到：

```
$('#' + ($(this).attr("id")).replace("inputval_","")).val($(this).val()); 
```

# wpf - 如何确定添加到 TabControl 的项目的类型？

> ID：880381
> 
> 赞同：2
> 
> 时间：2009-05-19T00:06:17.067
> 
> 标签：wpf, tabcontrol, tabitem

我创建了一个`CloseableTabItem`从`TabItem`. 现在我想指定一个给定的应该使用而不是`TabControl`添加新项目。这可能吗？如何？`CloseableTabItem``TabItem`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T01:26:16.153

```
public class CloseableItemsTabControl : TabControl
{
    protected override DependencyObject GetContainerForItemOverride()
    {
        return new CloseableTabItem();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T00:12:05.167

您可能需要制作自己的`ClosableTabControl`扩展`TabControl`以覆盖基本功能。

但是，您也可以手动添加标签，`ClosableTabItems`而不是常规添加标签`TabItems`。可以安全地假设这是可能的，因为大多数基于集合的控件都可以通过这种方式以编程方式填充。

# c - 程序验证问题。请帮忙！

> ID：880388
> 
> 赞同：1
> 
> 时间：2009-05-19T00:08:33.893
> 
> 标签：c

//伙计们，我的代码有问题，一直在努力解决这个问题。问题是我正在尝试验证我的代码，因此它不会计算负数。如果有人可以帮助顺利完成这个程序，我将不胜感激。请。

//税收计算器程序的目标是使用 C 编程计算每个 Kudler Fine Food 商店（DelMar、Encinitas 和 La Jolla）的销售税 //标准输入/输出处理

```
#include <stdio.h>
#include <ctype.h>
#include <stdlib.h>

//Starting point    
int main ()
{   
//Variables defined
//st = sales tax, tax rated = tr, pa = total purchase amount, sa = purchase amoount

    float fstDelmar;
    float ftrDelmar;
    float fpaDelmar;
    float fstEncinitas;
    float ftrEncinitas;
    float fpaEncinitas;
    float fstLajolla;
    float ftrLajolla;
    float fpaLajolla;
    float fsaPurchaseAmount;
    int fStoreselect;

//Variable initializations for tax rates and purchase amount 
    ftrDelmar = .0725;
    ftrEncinitas = .075;
    ftrLajolla = .0775;
    fsaPurchaseAmount = 0;

//Header & Introduction
    printf("\n***********************************************************************");
    printf("\n*                         Kudler Fine Foods                           *");
    printf("\n*                       Sales Tax Calculator                          *");
    printf("\n*                           Version 3.0                               *");
    printf("\n***********************************************************************\n");

//Ask user to select store.

    printf ("\n                 STORE LOCATION \n");
    printf ("\n                 1) Del Mar \n");
    printf ("\n                 2) Encinitas \n");
    printf ("\n                 3) La Jolla \n");

    printf ("\n Please select the store location (1-3):  \n");
    scanf ("%d", &fStoreselect);    

//Validate store selection.
    while (fStoreselect < 1 || fStoreselect > 3) {
        fflush (fStoreselect);
        printf ("INVALID SELECTION! Please select a valid location (1-3): \n"); 
        scanf ("%d", &fStoreselect);
        }
//Ask user to enter in total purchase amount.

    printf ("\n What was your purchase amount? "); 
    scanf("$%f", &fsaPurchaseAmount); //user enters variable amount

//Validation to ensure that user's enter in purchase amounts using correct format.

    while (fsaPurchaseAmount <= 0.0) 
        {
        fflush(fsaPurchaseAmount);                                          
        printf("\n INVALID SELECTION! Please enter a valid purchase amount greater than zero.\n");
        printf("\n The purchase amount is: $ ");
        scanf("%f", &fsaPurchaseAmount);    
        }

//Calculation of sales tax in dollars for each of the store locations
    fstDelmar = fsaPurchaseAmount * ftrDelmar;
    fstEncinitas = fsaPurchaseAmount * ftrEncinitas;
    fstLajolla = fsaPurchaseAmount * ftrLajolla; 

//Calculation of total sales amount for each of the locations

    fpaDelmar = fsaPurchaseAmount + fstDelmar;
    fpaEncinitas = fsaPurchaseAmount + fstEncinitas;
    fpaLajolla = fsaPurchaseAmount + fstLajolla;

//Displaying sales amount for purchase for each of the different locations

    switch (fStoreselect) {

        case 1: 
    //for Delmar location
        printf("\n       Purchase Amount      Sales Tax     Total Sales Amount ");
        printf("\n       _______________      _________     _________________ ");
        printf("\n            $%.2f              $%.2f            $%.2f",fsaPurchaseAmount, fstDelmar, fpaDelmar);
        break;

        case 2:
    //for Encinitas location
        printf("\n       Purchase Amount      Sales Tax     Total Sales Amount ");
        printf("\n       _______________      _________     _________________ ");
            printf("\n            $%.2f              $%.2f            $%.2f",fsaPurchaseAmount, fstEncinitas, fpaEncinitas);
            break;

            case 3:
        //for La Jolla location
            printf("\n       Purchase Amount      Sales Tax     Total Sales Amount ");
        printf("\n       _______________      _________     _________________ ");
            printf("\n            $%.2f              $%.2f            $%.2f",fsaPurchaseAmount, fstLajolla, fpaLajolla);   
        break; 
        }

    printf("\n Hit the ENTER key to exit program\n");
//Pause the screen and wait for user to hit the ENTER key
    getchar();

//EOF      
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T00:42:24.403

此行有错误：

scanf(" **$** %f", &fsaPurchaseAmount); //用户输入可变金额

它应该是：

scanf("%f", &fsaPurchaseAmount); //用户输入可变金额

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T00:58:20.923

以下是对所呈现代码的一些观察：

*   不要用浮点数来赚钱。只会在以后造成悲伤。理想情况下，听取会计专业人士的建议。同时，以美分为单位进行算术运算，并在美元之间进行缩放以进行显示。

*   使用浮点乘法*可能*会正确计算销售税等计算，但请确保您遵守公认的做法，以四舍五入为整数。再次，向会计专业人士寻求建议。

*   `fflush()`不做你认为它做的事。对于为写入而打开的文件描述符（例如`stdout`），它保证该描述符上的所有输出都已完成。它*在*打印提示之后和调用类似读取输入的内容*之前使用。*`scanf()`一个例子是：`printf("What is your favorite color? "); fflush(stdout); fgets(color, sizeof(color), stdin);`

*   始终检查`scanf()`. 它返回成功的转换次数。如果它与格式说明符的数量不匹配，那么只有那些成功的才会将值写入命名变量。

*   `scanf()`请注意格式字符串中出现的除空格以外的文字字符。这些必须与输入文本完全匹配，否则转换失败。因此，类似的格式`"$%f"`仅与包含文字美元符号的输入匹配。这可能不是您的用户所期望的。这种格式`"%f"`对用户来说更容易。如果你想允许一个可选的美元符号，那么`scanf()`可能不是最好的选择。

# .htaccess - 使用 .htaccess 进行 REST 301 重定向

> ID：880391
> 
> 赞同：3
> 
> 时间：2009-05-19T00:10:35.763
> 
> 标签：.htaccess, rest, http-status-code-301

我正在尝试为我正在开发的应用程序构建一个非常简单的 RESTful 测试平台。我正在使用 .htaccess 将 url 重定向到我的控制器脚本，在那里我将解析 url 以处理逻辑。

我的重定向工作正常，但问题是，如果我执行 POST/PUT/DELETE，Firebug 会显示我的请求正确地进入测试平台，但我得到一个 301 重定向响应，然后是第二个 GET 响应。

如何在不向浏览器发送 301 的情况下使用 htaccess 进行 url 重定向？

这是我现在使用的 .htaccess：

```
RewriteEngine On
RewriteCond %{SCRIPT_FILENAME} !-f
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T00:26:52.233

尝试这样的事情：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

除非请求的文件存在（例如图像或 CSS 文件），否则这将重定向。我经常使用这些规则，而且我从来没有遇到过 301。

检查您的 PHP 脚本是否没有将响应更改为 301。

# jquery - JQuery 和单选按钮帮助

> ID：880392
> 
> 赞同：0
> 
> 时间：2009-05-19T00:10:45.793
> 
> 标签：jquery

我有从数据库导入的数据，我想在一组单选按钮中表示该数据。如果数据库中的值为 1，则“客户状态”应显示“活动”单选按钮，否则显示“非活动”按钮。

我对 JQuery 知之甚少，但我每天都在学习，因此我们将不胜感激任何详细的帮助。

我从我的文件中获取了主要的代码片段，并将它们包括在这里。

我发布的代码的有趣之处在于我可以使用按钮来更改数据库中的数据。这有效，但显示数据库中的内容不是。

```
var admCustStatus = $("input[name='admCustStatus']:checked").val();

if (item.field == "admCustStatus")
{
   // ?? radio buttons
}

<tr>
    <td class="admMarker">Active<input type="radio" id="admCustStatusActive" name="admCustStatus" value="1" checked="checked" class="admChkbx"></td>
    <td class="admMarker">Inactive<input type="radio" id="admCustStatusInactive" name="admCustStatus" value="0" class="admChkbx"></td>
</tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T00:22:45.410

这可能是您正在寻找的：

```
if (item.field == "admCustStatus")
{
  if(item.value == 1) //assuming this is how you get the value
   $("#admCustStatusActive").attr('checked',true);
  else
   $("#admCustStatusInactive").attr('checked',true);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T00:37:16.457

你是如何从数据库中取出数据的？服务器端脚本？

假设您通过 MySQL DB 中的 php 进行数据库查询，您可能需要考虑执行类似...

```
$cust_query = "SELECT status FROM custDB WHERE cust_name = '$cust'";
$cust_result = mysql_query($cust_query);

while ($row = mysql_fetch_assoc($cust_result)) {
      $cust_status = $row['status'];
      } 
```

现在，这真的很简单，因为它假设您只想要一个客户的状态。如果您有几个客户，您可能会选择...

```
$cust_query = "SELECT cust_name, status FROM custDB ORDER cust_name";
$cust_result = mysql_query($cust_query);

while ($row = mysql_fetch_assoc($cust_result)) {
      $cust_status[$row['cust_name'] = $row['status'];
      } 
```

这将为您提供所有客户及其状态的关联数组，打印出来如下所示：

```
 [Jones] => 'Active',
     [Smith] => 'Inactive' 
```

ETC...

有了它，您只需进行输出即可。由于它是一个布尔值（它们可以是活动的或非活动的），我建议使用复选框而不是无线电。这是基本的 HTML：

```
 <table>
      <tr><td>Jones</td><tr><input type="checkbox" checked="checked" value="active" /></td></tr>
     <tr><td>Smith</td><tr><input type="checkbox" value="active" /></td></tr>
  </table> 
```

并且要为您的数据库结果解决这个问题，您可以使用...

```
 echo <<<EOT
 <table id="cust_status">
 <tr><th>Customer Name</th><th>Status</th></tr>
 EOT;

 while($row = mysql_fetch_assoc($cust_results)) {
       $status = ($row['status'] == 'active') ? 'checked="checked"' : "";
       $cust_name = $row['cust_name'];
       echo <<<EOT
       <tr><td>$cust_name</td><tr><input type="checkbox" $status value="active" /></td></tr>
      EOT;
  }
  echo "</table>"; 
```

最后一点避免了将结果移动到数组中的需要，而只是直接回显它们。加载完成后，如果要运行更新，可以使用 jquery 在表上运行一些 ajax。因此，也许您更改状态以反映新活动，选中该框，显示原因的文本字段，然后单击“更新”并将值传递给存储新信息的服务器端脚本，而无需为整个客户表提交一份。

# c# - 什么关于 C# 的 TDD 和 Mocks 处理的书

> ID：880401
> 
> 赞同：4
> 
> 时间：2009-05-19T00:13:42.637
> 
> 标签：c#, .net, tdd, mocking

您能否推荐一本关于 C# 的单元测试和 TDD 的书，其中至少对 Mock Objects 进行了一些处理？

我见过这个[问题](https://stackoverflow.com/questions/31837/best-books-about-tdd)，但似乎没有提到嘲笑。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T00:24:41.570

看看Steve Freeman 和 Nat Pryce[的测试指导下的成长中的面向对象软件](http://www.mockobjects.com/book/)- 一项正在进行中的工作，但在线免费。代码示例是用 java 编写的，如果您是 C# 开发人员，这应该不是问题，并且确实广泛关注 Mocks。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T16:25:38.440

*The Art of Unit Testing: With Examples in .NET* by Roy Osherove（[亚马逊页面](https://rads.stackoverflow.com/amzn/click/com/1933988274)，[官方网站](http://www.artofunittesting.com/)）听起来像您正在寻找的东西。他用一章来介绍存根和模拟对象的概念（使用“自己动手”的方法），然后用第二章介绍如何使用模拟对象框架，尤其是[Rhino Mocks](http://ayende.com/projects/rhino-mocks.aspx)。对测试驱动开发的重视程度有所降低，但是可以从其他来源获得大量有关 TDD 的信息，而且 TDD 并不是所有特定于语言的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-19T00:25:13.673

在我看来，Pragmatic Unit Testing in C# with NUnit, 2nd Edition 是单元测试的最佳介绍。它也有一章关于模拟对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-09T19:39:22.683

[XUnit 测试模式](http://xunitpatterns.com/)有几个关于测试替身的部分，包括模拟。不是 C# 特定的，但确实包含 C# 示例。

# iphone - 当显示删除按钮时，IPhone UITableView 抑制显示按钮

> ID：880403
> 
> 赞同：2
> 
> 时间：2009-05-19T00:14:06.440
> 
> 标签：iphone, cocoa-touch, uitableview

我有一个`UITableView`每一行都有一个披露按钮。当表格进入编辑模式并按下删除控件（“-”号）时，会显示删除按钮，但不会替换显示按钮，而是滑动到删除按钮的左侧。

苹果`UITableView`指南解释了代表的所有内容，除了在按下“-”符号时调用的代表，但在显示删除按钮之前。

我只想在显示删除按钮时抑制披露指示符。

我猜我遗漏了一些东西......我已经`setHidesAccessoryWhenEditing:NO` 在表格的单元格上设置了，以便显示指示器以向用户指示如果他们选择了行，他们可以编辑它......

我试图复制的行为是在编辑联系人时在联系人应用程序中完成的。任何帮助将不胜感激...

谢谢，格雷格

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T02:11:26.190

执行此操作的标准方法是使用`cell.hidesAccessoryWhenEditing = YES`，并且该编辑是一种模态操作，其中导航通常被禁用。

Contacts 应用程序实际上使用自定义表格单元格，如果它没有使用附件，而是在单元格的右边缘有一个图像，我不会感到惊讶，从它的行为来看。

`showingDeleteConfirmation`如果您想知道删除按钮何时出现，我建议您尝试在单元格的属性上安装键值观察器，如下所示：

```
[cell addObserver: self forKeyPath: @"showingDeleteConfirmation"
          options: NSKeyValueObservingOptionNew context: NULL]; 
```

然后实现观察者回调方法：

```
- (void)observeValueForKeyPath: (NSString *) keyPath ofObject: (id) object
                        change: (NSDictionary *) change context: (void *) context
{
    if ( [keyPath isEqualToString: @"showingDeleteConfirmation"] )
    {
        UITableViewCell * cell = (UITableViewCell *) object;
        BOOL isShowing = [[change objectForKey: NSKeyValueChangeNewKey] boolValue];
        if ( isShowing == NO )
            cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
        else
            cell.accessoryType = UITableViewCellAccessoryNone;
    }
} 
```

我应该注意，我不确定 UITableViewCell 类是否与此属性的 KVO 兼容，但值得一试……</p>

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-13T17:18:20.253

或者，当您创建单元格时，您可以定义附件类型： cell.editingAccessoryType = UITableViewCellAccessoryNone;

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T00:44:50.107

披露指示器由管理，`tableView:accessoryTypeForRowWithIndexPath:`因此您可以在编辑模式下更改附件类型。

我相信有一个`tableView:accessoryButtonTappedForRowWithIndexPath:`，也许你可以注意到你将要进入编辑模式，然后更改`tableView:accessoryTypeForRowWithIndexPath:`每一行的返回值——在编辑模式下没有附件。

我会试一试。

[这是来自 Apple 参考的关于如何在编辑模式下插入和删除行](http://developer.apple.com/iphone/library/documentation/UserExperience/Conceptual/TableView_iPhone/ManageInsertDeleteRow/ManageInsertDeleteRow.html#//apple_ref/doc/uid/TP40007451-CH10-SW1)的调用序列（不确定是否有帮助）描述/教程/示例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T02:46:22.967

我对吉姆的解决方案的评论不太好……这是为我解决问题的版本……再次感谢吉姆！

```
   - (void)observeValueForKeyPath: (NSString *) keyPath ofObject: (id) object
                        更改：（NSDictionary *）更改上下文：（void *）上下文
  {
    UITableViewCell * 单元格 = 对象；
    if ( [keyPath isEqualToString: @"showingDeleteConfirmation"] )
    {
        BOOL isShowing = [[更改 objectForKey: NSKeyValueChangeNewKey] boolValue];
        如果 ( !isShowing )
        {
            cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
        }
        别的
        {

            cell.accessoryType = UITableViewCellAccessoryNone;
        }
    }
}

```

# reporting-services - 创建自定义 SSRS 控件

> ID：880406
> 
> 赞同：6
> 
> 时间：2009-05-19T00:14:59.140
> 
> 标签：reporting-services, reporting, controls, service

是否可以为 Reporting Services 创建自定义第三方？

Dundas 图表控件就是一个例子，但是我不确定对这些控件的支持是否已在内部内置到 SSRS 中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T03:45:13.453

是的。

在咨询谷歌后，我发现 SSRS 有 CRI（自定义报告项）。这些可以通过实现 ICustomReportItem 接口（用于呈现）并从 CustomReportItemDesigner 类（用于设计器）继承来以 .NET 语言创建。这些使用 Microsoft.ReportDesigner 和 Microsoft.ReportingServices.Interfaces 命名空间。

CRI 中还有一个限制，即最终输出必须是图像。这将使任何交互变得非常困难。

有关更多信息，请参阅

[使用 SQL Server Reporting Services 中的自定义报告项使您的数据更加生动](http://msdn.microsoft.com/en-us/magazine/cc188686.aspx "使用 SQL Server Reporting Services 中的自定义报告项使您的数据更加生动")

[创建自定义报告项](http://msdn.microsoft.com/en-us/library/ms345224.aspx "创建自定义报告项")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T13:37:42.347

Dundas 控件对 SSRS 有一些内部知识（尽管它们是使用公共 API 构建的）。例如，他们使用反射解决了某些 SSRS CRI 限制 - 我发现默认情况下，在 SSRS 2008 CRI 中只能有一个钻槽操作 - Dundas 和其他供应商（Nevron）顺便解决了这个问题......

否则，交互性将仅限于所有自定义报告的工具提示、URL 链接、书签和跳转到报告操作，并且图像输出仅为栅格。

# refactoring - 静态/强类型和重构

> ID：880410
> 
> 赞同：6
> 
> 时间：2009-05-19T00:17:44.127
> 
> 标签：refactoring, strong-typing, static-typing, weak-typing

在我看来，静态/强类型编程语言最宝贵的地方在于它有助于重构：如果/当您更改任何 API 时，编译器会告诉您该更改破坏了什么。

我可以想象用运行时/弱类型语言编写代码……但我无法想象没有编译器的帮助就进行重构，也无法想象在没有重构的情况下编写数万行代码。

这是真的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-19T01:23:14.913

我认为您将检查类型与检查方式混为一谈。运行时类型不一定很弱。

静态类型的主要优点正是您所说的：它们是详尽的。只需让编译器执行此操作，您就可以确信所有调用站点都符合该类型。

静态类型的主要限制是它们受限于它们可以表达的约束。这因语言而异，大多数语言具有相对简单的类型系统（c、java），而其他语言具有极其强大的类型系统（haskell、cayenne）。

由于这种限制，类型本身是不够的。例如，在 java 中，类型或多或少地仅限于检查类型名称是否匹配。这意味着您要检查的任何约束的含义都必须编码到某种命名方案中，因此 java 代码常见的过多间接和样板。C++ 稍微好一点，因为模板允许更多的表现力，但不能接近你可以用依赖类型做的事情。我不确定更强大的类型系统的缺点是什么，但显然肯定会有一些或更多的人在工业中使用它们。

即使您使用的是静态类型，也可能不足以检查您关心的所有内容，因此您也需要编写测试。静态类型是否比样板代码节省了更多的精力，这是一个长期激烈的争论，我认为并不是所有情况都有一个简单的答案。

至于你的第二个问题：

我们如何在运行时类型语言中安全地重构？

答案是测试。您的测试必须涵盖所有重要的情况。工具可以帮助您衡量测试的详尽程度。覆盖检查工具让您知道测试是否覆盖了代码行。测试变异工具（jester、heckle）可以让您知道您的测试是否在逻辑上不完整。验收测试让您知道您编写的内容符合要求，最后回归和性能测试确保产品的每个新版本都保持上一个版本的质量。

进行适当的测试与依赖复杂的类型间接相关的好处之一是调试变得更加简单。运行测试时，您会在测试中获得特定的失败断言，这些断言清楚地表达了它们在做什么，而不是钝的编译器错误语句（想想 c++ 模板错误）。

无论您使用什么工具：编写您有信心的代码都需要付出努力。它很可能需要编写大量测试。如果错误的惩罚*非常*高，例如航空航天或医疗控制软件，您可能需要使用正式的数学方法来证明您的软件的行为，这使得此类开发非常昂贵。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-19T00:30:57.373

我完全同意你的观点。动态类型语言应该擅长的灵活性实际上是使代码难以维护的原因。真的，如果数据类型以非平凡的方式更改而没有实际更改代码，是否有程序继续工作？

同时，您可以检查传递的变量的类型，如果它不是预期的类型，则以某种方式失败。你仍然需要运行你的代码来根除这些情况，但至少会告诉你一些事情。

我认为 Google 的内部工具实际上会对其 Javascript 进行编译和类型检查。我希望我有这些工具。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-20T04:36:50.527

首先，我是一名本地 Perl 程序员，所以一方面我从未使用静态类型网络进行过编程。OTOH 我从来没有和他们一起编程，所以我不能谈论他们的好处。我能说的是重构是什么样的。

我不认为缺少静态类型是重构的问题。我发现一个问题是缺少重构*浏览器*。动态语言的问题是，在实际运行代码之前，您并不真正知道代码真正要做什么。Perl 比大多数都拥有这一点。Perl 的另一个问题是语法非常复杂，几乎无法解析。结果：没有重构工具（尽管[他们在这方面工作得非常迅速](http://padre.perlide.org/)）。最终结果是我必须手动重构。这就是引入错误的原因。

我有测试来捕捉它们……通常。我确实发现自己经常面对一堆未经测试和几乎无法测试的代码，面临着鸡/蛋问题，即必须重构代码才能测试它，但必须测试它才能重构它。伊克。在这一点上，我必须编写一些非常愚蠢的高级“程序是否输出与以前相同的东西”之类的测试，以确保我没有破坏某些东西。

正如 Java 或 C++ 或 C# 所设想的那样，静态类型实际上只能解决一小部分编程问题。它们保证您的接口传递带有正确标签的数据位。但仅仅因为你得到一个 Collection 并不意味着 Collection 包含你认为它包含的数据。因为你得到一个整数并不意味着你得到了正确的整数。您的方法需要一个用户对象，但该用户是否已登录？

经典示例：`public static double sqrt(double a)`是[Java 平方根函数的签名](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Math.html#sqrt(double))。平方根不适用于负数。签名的什么地方这么写的？它没有。更糟糕的是，它在哪里说明该功能甚至是做什么的？签名只说明它采用什么类型以及返回什么。它没有说明中间发生的事情，这就是有趣的代码所在的地方。有些人试图通过使用[按合同设计](https://secure.wikimedia.org/wikipedia/en/wiki/Design_by_contract)来捕获完整的 API ，这可以广泛地描述为嵌入对函数的输入、输出和副作用（或缺乏）的运行时测试......但这是另一个展示。

API 不仅仅是函数签名（如果不是，您将不需要 Javadocs 中的所有描述性散文），重构甚至不仅仅是更改 API。

静态类型、静态编译、非动态语言给您的最大重构优势是能够编写重构工具来为您进行相当复杂的重构，因为它知道对您的方法的所有调用在哪里。我很羡慕[IntelliJ IDEA](http://www.jetbrains.com/idea/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T00:25:32.190

我想说重构超出了编译器可以检查的范围，即使在静态类型的语言中也是如此。重构只是改变程序的内部结构而不影响外部行为。即使在动态语言中，仍然有一些事情你可以期待发生和测试，你只是失去了编译器的一点帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T00:56:38.290

*在 C# 3.0 中使用var*的好处之一是您*可以*经常更改类型而不会破坏任何代码。类型需要看起来仍然相同 - 必须存在具有相同名称的属性，具有相同或相似签名的方法必须仍然存在。但是你真的可以改变成一个非常不同的类型，即使不使用 ReSharper 之类的东西。

# language-agnostic - 为什么在游戏中使用向量来表示速度？

> ID：880411
> 
> 赞同：0
> 
> 时间：2009-05-19T00:18:27.213
> 
> 标签：language-agnostic

速度=长度/时间

那么为什么要用向量（x, y, z）来表示呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-19T00:32:01.680

从技术上讲，长度除以时间给你的是速度，而不是速度。速度并不能告诉您您正在朝哪个方向行驶，而速度却可以。在三维空间中，为了描述你要去的地方和速度，你需要提供三个值：你在三个基本方向（通常称为轴，由 x、y 表示）中的每一个方向和速度, 和 z)。但是，如果您愿意，您可以将它们称为向前/向后、横向和向上/向下。例如，如果您以 5 公里/小时以上的速度行驶，则向量可能是 (0,0,5)。以 5 公里/小时的速度向下行驶，您的速度是一样的，但矢量将是 (0,0,-5)。以 5 公里/小时的速度向前 45 度角行驶，沿 x 轴和 z 轴中的每一个的 SPEED 将是 5 的平方根，因此向量将（大约）为（2.2，0,2.2)。等等。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-19T00:21:52.353

因为速度*不是*“长度/时间”。它是位置的一阶导数。位置是一个向量，因此它的导数*也是*向量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T00:20:42.763

最有可能测量对象在三维空间中的变化。

矢量的大小应该是您期望的速度，并且随着对象改变方向，矢量分量很可能会发生变化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T00:21:17.380

您将使用矢量，因为您可以在 3 维上获得速度。换句话说，3D 速度是所有 3 个维度中距离/时间的组合。将变量命名为 xPrime、yPrime 和 zPrime 可能会更好，以便向量更清楚地表示速度，而不是位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T00:23:49.793

也许是物体在 3D 空间中每个方向上移动的速度，这样做意味着您可以推断出运动方向，毕竟速度是有方向的运动。

# .net - D8045：无法使用 /clr 选项编译 C 文件 'serialcommands.c'

> ID：880413
> 
> 赞同：9
> 
> 时间：2009-05-19T00:20:24.573
> 
> 标签：.net, c++-cli, clr

我收到编译器错误 D8045。无法使用 /clr 选项编译 C 文件“serialcommands.c”。

该文件是一个 C 库，已编写为通过串行端口与 TI 处理器通信。我需要做的任务是用 CLR 包装器包装这个库（如果你想从 CLI 问题中获得更简单的观点，将会有其他关于来回编组数据的问题发布到 stackoverflow。）

我只想从我的 CLR 包装器中使用这个 C 库。我去了属性->配置属性->C/C++->常规->使用公共语言运行时支持编译=没有公共语言运行时支持

这是正确的方法吗？我以后会遇到令人讨厌的奇怪错误，还是我需要做其他事情才能使用它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-19T00:25:42.207

是的。您需要在没有 /CLR 的情况下编译任何 C 对象，因为 clr 只理解类和对象。

你仍然可以在你的 C++/CLI 项目中使用它们，包裹在你的“ref 类”对象中。这是在 .NET 对象中包装 C api 的常规方式。

# log4j - 如何使用 log4j.xml 配置 log4j 以根据类名附加到不同的日志文件？

> ID：880422
> 
> 赞同：27
> 
> 时间：2009-05-19T00:22:41.633
> 
> 标签：log4j

我想设置 log4j，以便从包 com.foo.bar 下的类生成的所有日志消息都转到 bar.log，并且从包 com.bar.blatz 下的类生成的所有日志消息都转到 blatz.log。

### 问题

*   如何使用 log4j.xml 执行此操作？
*   我知道它可以使用属性文件，但我该如何使用 XML 配置呢？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-19T00:39:59.667

这是基于我对类似问题的回答[：](https://stackoverflow.com/questions/728295/creating-multiple-log-files-of-different-content-with-log4j/731106#731106)

```
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">
    <!-- general application log -->
    <appender name="BarLogFile" class="org.apache.log4j.FileAppender">
        <param name="File" value="bar.log" />
        <param name="Threshold" value="INFO" />
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%-5p %t [%-40.40c] %x - %m%n"/>
        </layout>
    </appender> 

    <!-- additional fooSystem logging -->
    <appender name="BlatzLogFile" class="org.apache.log4j.FileAppender">
        <param name="File" value="blatz.log" />
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%-5p %t [%-40.40c] %x - %m%n"/>
        </layout>
    </appender>

    <logger name="com.foo.bar">
        <appender-ref ref="BarLogFile"/>
    </logger>

    <logger name="com.bar.blatz">
        <appender-ref ref="BlatzLogFile"/>
    </logger>

    <root>
        <level value="INFO"/>
        <!-- no appender, output will be swallowed (I think) -->
    </root>
</log4j:configuration> 
```

如果将 appender-ref 添加到根元素，它也会收到 com.foo.bar 等消息。您可以通过在记录器上指定 'additivity="false"' 来停止这种情况。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-04-24T12:45:20.150

```
 <root>
        <level value="INFO"/>
        <!-- no appender, output will be swallowed (I think) -->
  </root> 
```

我们可以在这里添加附加程序。如果应用程序使用根记录器，它将起作用。例如石英调度程序 API。

# php - Mysql ORDER BY 使用日期数据行

> ID：880430
> 
> 赞同：8
> 
> 时间：2009-05-19T00:24:26.263
> 
> 标签：php, sql, mysql, sql-order-by

我有一个这样的查询：

```
SELECT 
 title, desc, date 
FROM 
 tablename 
ORDER BY 
 date ASC, title ASC; 
```

当数据实际上有一个日期时工作正常。问题是，日期提交是可选的，所以我有时会得到 0000-00-00 作为日期，这会产生将所有未注明日期的行放在最上面的不幸效果。

所以，我然后尝试了这个：

```
SELECT 
 title, desc, date 
FROM 
 tablename 
ORDER BY 
 date DESC, title ASC; 
```

哪种有效，但不是真的 - 所有日期（非 0000-00-00）的项目按降序列出，然后是所有 0000-00-00 的项目。

我想要做的是按日期 ASC、标题 ASC 排序，但前提是日期！= 0000-00-00，但如果日期 = 0000-00-00，那么只需按标题 ASC 排序（我想我正确解释）。

我能想到的唯一方法是基于非 SQL 的（或者 2 个查询，或者，每个查询只填充一个内存数组，然后我使用 PHP 进行排序）。

是否有可以执行此操作的 SQL 查询？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-19T00:29:57.237

```
ORDER BY date = '0000-00-00' ASC, date ASC, title ASC 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T00:32:07.483

您的 2 查询解决方案是一个很好的解决方案，您可以使用[`UNION`](http://dev.mysql.com/doc/refman/5.1/en/union.html)命令在 SQL 中完成所有操作。

第一个查询将针对非零日期，然后查询中的 UNION 针对零日期。

编辑：类似于：

```
SELECT * FROM tbl 
   WHERE DATE != '0000-00-00' 
   ORDER BY date ASC 
UNION SELECT * FROM tbl
   WHERE DATE = '0000-00-00'
   ORDER BY title ASC 
```

这在这种情况下可能不是很有用，但对于复杂的查询，`UNION`可以派上用场。

# html - 防止双重表单提交

> ID：880437
> 
> 赞同：6
> 
> 时间：2009-05-19T00:26:01.270
> 
> 标签：html, forms, double-submit-prevention

> **完全重复**：[如何在服务器端处理多个提交](https://stackoverflow.com/questions/218907/how-to-handle-multiple-submissions-server-side)

手头的一般任务：防止在基于 Web 的多用户应用程序中提交双重表单。想想金融交易。

我有两种可以串联使用的方法：

1.  JavaScript 禁用按钮
    *   缺点：如果禁用 JavaScript，则不起作用
2.  后端验证 - 查看此类型的最后一个请求来自该用户多久之前，如果不是太久之前发出错误
    *   缺点：如果两个提交的距离足够近，每个提交都可能无法察觉到另一个

我正在寻找主题专家来贡献他们的最佳实践以及深奥的技巧。可以是任何语言和框架，但 Django 特别感兴趣。网上已经写了很多关于手头任务的文章，但如果能在此处展示最佳实践，那就太好了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-19T00:36:20.623

常见的解决方案是每次生成表单时在服务器上生成一个令牌。将令牌存储在服务器上，将其作为隐藏字段添加到表单中，并在使用该令牌提交表单后将其删除。

如果您收到没有有效令牌的表单提交，则表示该表单已经提交并忽略它。

这具有为您的项目添加 XSRF 保护的额外优势。

# unix - 使用 -c 标志时如何重定向 Dtrace 输出？

> ID：880439
> 
> 赞同：2
> 
> 时间：2009-05-19T00:26:15.030
> 
> 标签：unix, pipe, dtrace

运行带有 -C 标志的脚本时，如何仅重定向 Dtrace 的输出？

就像在这种情况下：

```
dscript.d -s myscript.d -c date 
```

**注意：**我在发布之前找到了我的问题的答案，但我把它放在这里，所以它是 SO 的一部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T00:35:16.943

管道的一种解决方案是：

```
dtrace -o /dev/fd/3 -s dscript.d -c date 3>&1 1>out 2>err 
```

其中说：

*   dtrace 的标准输出到 fd 3，它是从当前标准输出中复制的
*   dtrace 的 stderr 变为 'err'
*   日期的标准输出被修改为'out'
*   date 的 stderr 被修改为 'err'

或者更简单的方法是：

```
dtrace -o log.txt -s dscript.d -c date 
```

# sql - 如何匹配两个包含友好电子邮件地址的电子邮件字段

> ID：880456
> 
> 赞同：1
> 
> 时间：2009-05-19T00:32:44.877
> 
> 标签：sql, sql-server, tsql, function, user-defined-functions

一张桌子有“ `John Doe <jdoe@aol.com>`”，而另一张桌子有“ `jdoe@aol.com`”。是否有 UDF 或替代方法可以将第一个字段中的电子邮件地址与第二个字段匹配？

这不会是生产代码，我只需要它来运行临时分析。很遗憾，数据库不存储友好和非友好的电子邮件地址。

**更新：** 修正了格式，应该是`<`和`>`第一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T00:47:47.763

我会在最后一个空格上拆分电子邮件地址——这应该给你电子邮件地址。确切的代码将取决于您的数据库，但有一些粗略的伪代码：

```
email = row.email
parts = email.split(" ")
real_email = parts[ len(parts) - 1 ] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T03:59:47.483

您应该能够使用 LIKE 关键字，具体取决于“友好”电子邮件地址的模式的一致性。

```
SELECT
     T1.nonfriendly_email_address,
     T2.friendly_email_address
FROM
     My_Table T1
INNER JOIN My_Table T2 ON
     T2.friendly_email_address LIKE '%<' + T1.nonfriendly_email_address + '>' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T01:04:00.960

也许下面的 TSQL 代码可以帮助你：

```
DECLARE @email varchar(200)
SELECT @email = 'John Doe jdoe@aol.com'

SELECT REVERSE(SUBSTRING(REVERSE(@email), 0,CHARINDEX(' ', REVERSE(@email)))) 
```

该语句返回：

jdoe@aol.com

讲逻辑：

1.  反转电子邮件列
2.  找到第一个 ' ' 字符的索引...到目前为止的所有内容都是您的实际电子邮件地址
3.  从（反转）字符串的开头到步骤 2 中找到的索引对列进行子串化。
4.  再次反转字符串，以正确的顺序放置。

可能有更优雅的方法来做这件事，但这会起作用，因此您可以将它用于 JOIN 的一侧。它之所以有效，是因为电子邮件地址不能包含空格，因此最后一个空格（或反转它时的第一个空格）将是您的实际电子邮件地址和友好地址之间的分隔符。据我所知，TSQL 不包含 LastIndexOf() 函数，这对于避免双重 Reverse() 函数调用很方便。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T01:08:26.707

您可以使用 LOCATE 方法进行连接，例如...

```
 SELECT * FROM table1 JOIN table2 ON (LOCATE(table2.real_email, table1.friend_email) > 0) 
```

# java - 如何确定我在序列化 Java 对象的最后一个字节？

> ID：880457
> 
> 赞同：0
> 
> 时间：2009-05-19T00:34:12.360
> 
> 标签：java, serialization

**问题**

什么是（如果有的话）序列化 java 对象中的终止字符/字节序列？

**背景**

我正在做一个小型的自学项目，我想序列化 java 对象并将它们写入一个流，在那里读取然后反序列化。因为，我需要识别序列化对象之间的边界，并且我不能确定当前对象不是最后一个，是否有一个始终存在的终止字符可以用作我的标识符？

我注意到有一个幻数 ACED 可以让我识别对象的开始，那么我如何识别结束呢？

编辑：如果没有终止字符，是否有任何*安全*的终止字符/序列可以使用（插入）来识别对象的结尾？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T00:39:51.850

从理论上讲，您应该始终能够找到对象的末端，但实际上您不能。我知道问题是自定义`writeObject`实现既不调用也不`defaultReadObject`具有`readFields`非标准表示。

我过去玩过序列化。包括创建流以供我对`ObjectInputStream`. 这不愉快（！）。

您可以阅读[规范](http://java.sun.com/javase/6/docs/platform/serialization/spec/protocol.html)中的详细信息，来源值得一读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T19:11:15.053

You can add a terminating object to your object stream. e.g. null or a special String.

However, I suggest that you instead convert the ObjectsStream to a byte[] and write the byte length of the byte[] followed by its data. This way each ObjectStream is independent and you always know where it finishes.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T01:27:42.550

没有了。AFAIK 唯一的要求是，当给定相应的序列化时，反序列化器知道何时停止读取。在此前提下，序列化程序可以写任何它想要的东西——在任何位置，而不仅仅是最后一个。

如果您是老 skool，则在开头转储一个 32 位长度的字段，拒绝处理大于 4 gig 的对象。

nu scool，您只需确保您的读取和写入逻辑是一致的，而不关心长度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T01:09:08.967

您是否考虑过应用类似于[HTTP 块编码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.6.1)的记录标记层？

分块编码旨在解决这种情况的概括：识别长度不确定的消息的结尾，该消息本身不包含可识别的结尾，并且嵌入到更长的流中而不结束它。

# php - PHP 内存分析

> ID：880458
> 
> 赞同：101
> 
> 时间：2009-05-19T00:34:21.330
> 
> 标签：php, memory, profiling

分析 PHP 页面的内存使用情况的好方法是什么？例如，查看我的数据使用了多少内存，和/或哪些函数调用分配了最多的内存。

*   xdebug 似乎没有在其分析功能中提供内存信息。

*   xdebug**确实**在其跟踪功能中提供了它。这与我想要的非常接近，除了大量的数据是压倒性的，因为它显示了每个函数调用的内存增量。如果可以将调用隐藏在某个深度以下，也许可以使用一些 GUI 工具，那将解决我的问题。

还有别的事吗？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2014-05-21T09:55:33.977

你可能知道，Xdebug 从 2.* 版本开始就放弃了内存分析支持。请在此处搜索“已删除函数”字符串：[http ://www.xdebug.org/updates.php](http://www.xdebug.org/updates.php)

> **删除的功能**
> 
> 删除了对内存分析的支持，因为它不能正常工作。

所以我尝试了另一种工具，它对我来说效果很好。

[https://github.com/arnaud-lb/php-memory-profiler](https://github.com/arnaud-lb/php-memory-profiler)

这是我在我的 Ubuntu 服务器上为启用它所做的：

```
sudo apt-get install libjudy-dev libjudydebian1
sudo pecl install memprof
echo "extension=memprof.so" > /etc/php5/mods-available/memprof.ini
sudo php5enmod memprof
service apache2 restart 
```

然后在我的代码中：

```
<?php

memprof_enable();

// do your stuff

memprof_dump_callgrind(fopen("/tmp/callgrind.out", "w")); 
```

最后用[KCachegrind](http://kcachegrind.sourceforge.net/html/Home.html)`callgrind.out`打开文件

# 使用 Google gperftools（推荐！）

首先通过在此处下载最新软件包来安装**Google gperftools ：** [https ://code.google.com/p/gperftools/](https://code.google.com/p/gperftools/)

然后像往常一样：

```
sudo apt-get update
sudo apt-get install libunwind-dev -y
./configure
make
make install 
```

现在在您的代码中：

```
memprof_enable();

// do your magic

memprof_dump_pprof(fopen("/tmp/profile.heap", "w")); 
```

然后打开你的终端并启动：

```
pprof --web /tmp/profile.heap 
```

*pprof*将在您现有的浏览器会话中创建一个新窗口，如下所示：

![使用 memprof 和 gperftools 进行 PHP 内存分析](https://i.stack.imgur.com/EAnGC.png)

# Xhprof + Xhgui（我认为最好的配置 CPU 和内存）

使用**Xhprof**和**Xhgui**，您还可以分析 cpu 使用情况，或者如果这是您目前的问题，则只分析内存使用情况。这是一个非常完整的解决方案，它可以让您完全控制，并且日志可以写在 mongo 或文件系统中。

有关更多详细信息[，请参见我的答案](https://stackoverflow.com/questions/16787462/php-xdebug-how-to-profile-forked-process/31388948#31388948)。

# 黑火

Blackfire 是 SensioLabs 的 PHP 分析器，Symfony2 的家伙[https://blackfire.io/](https://blackfire.io/)

如果您使用[puphpet](https://puphpet.com/)设置您的虚拟机，您会很高兴知道它受支持；-)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-19T00:46:09.700

好吧，这可能不是您正在寻找的，但 PHP 确实有几个内置函数可以输出内存使用情况。如果您只是想查看函数调用使用了多少内存，您可以在调用前后使用[memory_get_peak_usage()并获取差异。](http://php.net/memory_get_peak_usage)

您使用非常相似的[memory_get_usage()](http://php.net/memory_get_usage)围绕数据使用相同的技术。

相当简单的方法，但它是检查一段代码的快速方法。我同意 xdebug mem deltas 有时可能过于冗长而无用，所以我经常使用它来缩小到一段代码，然后手动转储小块的特定内存使用情况。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2018-02-19T19:18:27.290

[Xdebug](https://xdebug.org/) [在 2.6](https://bugs.xdebug.org/bug_view_page.php?bug_id=00000474) (2018-01-29) 中重新实现了内存跟踪，可用于 Qcachegrind 或类似工具。只要[确保选择内存选项](https://bugs.xdebug.org/view.php?id=1524):)

从文档：

> 从 Xdebug 2.6 开始，分析器还收集有关正在使用的内存量以及哪些函数 aGnd 方法增加了内存使用量的信息。

我不熟悉文件的格式，但它的 Qcachegrind 在跟踪几个内存问题时对我来说非常有用。

[![qcachegrind 示例](https://i.stack.imgur.com/dzJVi.jpg)](https://i.stack.imgur.com/dzJVi.jpg)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T19:27:52.753

[http://geek.michaelgrace.org/2012/04/tracing-php-memory-usage-using-xdebug-and-mamp-on-mac/](http://geek.michaelgrace.org/2012/04/tracing-php-memory-usage-using-xdebug-and-mamp-on-mac/)

我在 Mac 上，所以如果你在 Windows 上，你必须对此进行测试，但这对我有用。

我修改了我的 tracefile-analyzer.php 文件，并在顶部添加了 PHP 二进制文件的路径，以便您可以在终端中将其作为普通的 unix 脚本调用。

```
#!/Applications/MAMP/bin/php5.3/bin/php
<?php
if ( $argc <= 1 || $argc > 4 )
{ 
```

不要忘记将此文件 chmod 为 755。

您可以轻松地创建一个 ruby​​ watchr 脚本，以便在每次创建内存配置文件 (*.xt) 时自动调用该脚本。这样你就可以继续测试并看到你的改进，而不必一遍又一遍地执行命令。

# asp.net - ASP.NET 网页到设备连接到服务器的 USB (COM) 端口

> ID：880460
> 
> 赞同：2
> 
> 时间：2009-05-19T00:36:01.997
> 
> 标签：asp.net, vb.net, usb, arduino

我正在研究一种从网站向 Arduino 板发送命令的方法。Arduino 板通过 USB 端口（COM 端口）连接到计算机。

我已经设法使用 VB.NET 程序连接和控制电路板。我还编写了一个 VB.NET 类，它可以实例化 COM 连接并发送和接收消息。

我的下一步基本上是创建一个程序，它将充当我的 Web 服务器（在 Windows Vista 上运行的 IIS 7）和 Arduino 板之间的代理。当用户访问我的 ASP.NET 页面时，该页面将向代理发送命令以打开 COM 连接。当连接打开并准备好时，我可以向代理发送命令。反过来，代理会将这些命令发送到董事会并监听它从董事会收到的响应。然后代理会将这些消息传递回 ASP.NET 页面。

我有几个问题希望群里能帮我解答...

1.  我用这种方法走在正确的方向吗？有没有更简单或更有效的方法来做到这一点？

2.  我看到的主要问题是，如果第二个用户打开网页并尝试打开 COM 端口，则会出现错误。这会导致第一次连接失败吗？我想我可以先检查端口是否已在使用中，然后给第二个用户一条消息。

3.  是否还有其他我遗漏或没有看到的潜在挑战？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T15:22:37.187

与其将连接对象存储在 中，不如将其[`HttpSessionState`](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.httpsessionstate.aspx)存储在 中，[`HttpApplicationState`](http://msdn.microsoft.com/en-us/library/system.web.httpapplicationstate.aspx)以便所有用户都可以访问它。

您需要小心同步对 COM 端口的访问，以避免由单个 HTTP 请求发起的串行通信混淆并混淆 Arduino。

# oop - OOP，类/对象矫枉过正

> ID：880461
> 
> 赞同：4
> 
> 时间：2009-05-19T00:36:06.880
> 
> 标签：oop

什么是了解课程设计不当甚至必要时的良好衡量标准。换句话说，什么时候写课，什么时候不写。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-19T00:43:50.593

如果一个类设计得不好，SOLID 可能会有所帮助，但它不会帮助回答诸如“面向对象编程是解决这个问题的最佳方法吗？”这样的问题。

在面向对象编程流行之前，人们在数学和科学编程方面已经做了很多非常好的工作。如果您的问题属于这些类别，那么面向对象编程可能不适合您。

对象是状态和行为在一起；他们倾向于一对一地映射到问题域对象上。如果您的问题不是这样，那么面向对象编程可能不适合您。

如果您不太了解面向对象的语言，那么面向对象的编程可能不适合您。

如果您的组织不知道也不能支持面向对象的解决方案，那么面向对象的编程可能不适合您。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-19T00:38:55.610

很多人会说“SOLID 原则”是一个很好的类设计指南。

有很多关于 SOLID 原则的文章/播客，只需快速搜索即可。这是一个好的开始：

[http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-19T01:08:28.983

与其列出一堆不要这样做的规则来识别设计不佳的类，不如列出一些管理*良好*类设计的规则更容易 - 也更有效：

*   类是*相关*状态和行为的集合
*   行为应该只使用状态和方法参数
*   如果您将状态视为一种关系（即关系数据库表中的列），则对象 ID（指针）是主（合成）键，状态包含非键属性。对象是第三范式吗？如果不是，则将其拆分为两个或多个对象。
*   对象的生命周期是否完整？换句话说，您是否有足够的方法将对象从创建到使用，最后到销毁/处置？如果没有，缺少哪些方法（或状态/转换）？
*   是否至少一种方法使用了所有状态？如果不是，它是否提供了对对象用户有用的描述性信息？如果这两个问题的答案都是否定的，那么就摆脱无关的状态。

如果您要解决的问题不需要状态，则不需要对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T01:02:53.223

在 SOLID 原则之上，看看 Code Smells。它们在 Martin Fowler 的“重构”一书中首次被提及（IIRC），这是一本极好的读物。

代码异味通常适用于 OO 以及在某种程度上也适用于程序开发，包括像“Shotgun Surgery”这样的东西，其中需要在整个代码库中进行编辑以更改一件小事，或者“Switch Case Smell”，其中巨大的开关案例控制您的流程应用程序。

Refactoring（书）的最佳之处在于它推荐了修复代码异味的方法，并对它们采取了务实的看法——它们就像真正的异味——你可以忍受其中的一些，但不能忍受其他的。

# c++ - boost::ptr_vector 和 boost::any 的问题

> ID：880463
> 
> 赞同：0
> 
> 时间：2009-05-19T00:36:49.733
> 
> 标签：c++, boost, stl, auto-ptr, ptr-vector

好的，所以我有疑问，我想知道这是否可能：

我正在使用带有通用数据（字符串、整数、布尔值等）的数据库。每当构造对象或修改对象的成员时，我都必须使用特定操作（SELECT 或 UPDATE）查询数据库。首先，这不是与数据库相关的问题，我真正的问题是我有一个 ptr_vector，它保存 boost::any 指向对象成员的指针。在这样的代码中：

```
class Enemy{
  private:
    //some private data...
  public:
    auto_ptr<int> ID_Enemy;
    auto_ptr<string> Enemy_Name;
    //miscellaneous methods...
}; 
```

然后我将要修改的成员传递给另一个杂项类的函数，该函数以 boost::any* 为参数：

```
misc_class.addValues((boost::any*)(ID_Enemy.get()));
misc_class.addValues((boost::any*)(Enemy_Name.get())); 
```

同一个类接受 any*，并执行以下操作：

```
auto_ptr<boost::any> val2(val); //being val, the passed any*
Enemy_Values.push_back(val2); 
```

Enemy_Values 是一个 ptr_vector。因此，当我访问这个具有 Enemy_Values 作为成员的 misc_class 时，我想更改内部的 auto_ptr 指向的值：

```
misc_class.Enemy_Values[0] = (boost::any)(69); 
```

在这里，我得到一个违规错误。我尝试了很多事情，有人告诉我，我不应该使用 auto_ptr 容器或使用 boost::any 来回转换。这是我正在做的可能，还是有更好更直观的方法？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T01:01:04.973

`(boost::any*)(ID_Enemy.get())`执行 a`reinterpret_cast`因为您正在转换不相关的指针类型。这意味着你得到一个指向 的无效指针`any`，指向真正的整数。相反，构造一个临时的 boost::any 对象并通过引用传递给 addValues：

```
misc_class.addValues(boost::any(ID_Enemy.get()); 
```

您的使用`auto_ptr`实际上是不正确的：`auto_ptr`删除了 freestore 上的对象，但在这里我们处理的是本地人。`addValues`只需要将对象的值推入*向量*`any`中：

```
Enemy_Values.push_back(val); 
```

...并且 Enemy_Values 应该只是一个 std::vector。

您*可以*使用 ptr_vector 和 freestore 分配的`boost::any`对象来执行此操作，但这会比必要的更复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T01:07:10.873

auto_ptr 有[很多问题](http://aszt.inf.elte.hu/~gsd/halado_cpp/ch05s03.html)。既然你已经在使用 boost，为什么不使用 boost::shared_ptr 呢？

# linux - 在 Linux 上将一组文件重命名为 001、002、...

> ID：880467
> 
> 赞同：20
> 
> 时间：2009-05-19T00:38:29.043
> 
> 标签：linux, bash, shell, file, rename

我最初有一组图像，格式为 image_001.jpg、image_002.jpg、...

我浏览了它们并删除了几个。现在我想将剩余文件重命名为 image_001.jpg、image_002.jpg、...

是否有一个 Linux 命令可以巧妙地做到这一点？我对重命名很熟悉，但看不到任何可以像这样订购文件名的东西。我在想，由于`ls *.jpg`按顺序列出文件（有间隙），解决方案是将其输出传递到 bash 循环或其他东西中？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-19T00:47:32.240

如果我理解正确，您有例如 image_001.jpg、image_003.jpg、image_005.jpg，并且您想重命名为 image_001.jpg、image_002.jpg、image_003.jpg。

编辑：修改为将临时文件放在当前目录中。正如 Stephan202 所指出的，如果 temp 位于不同的文件系统上，这可能会产生重大影响。为了避免在循环中碰到临时文件，它现在通过图像*

```
i=1; temp=$(mktemp -p .); for file in image*
do
mv "$file" $temp;
mv $temp $(printf "image_%0.3d.jpg" $i)
i=$((i + 1))
done 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-19T00:46:43.037

一个简单的循环（用 测试`echo`，用 执行`mv`）：

```
I=1
for F in *; do
  echo "$F" `printf image_%03d.jpg $I`
  #mv "$F" `printf image_%03d.jpg $I` 2>/dev/null || true
  I=$((I + 1))
done 
```

（我添加`2>/dev/null || true`了禁止有关相同源文件和目标文件的警告。如果这不符合您的喜好，请使用[Matthew Flaschen](https://stackoverflow.com/users/47773/matthew-flaschen)的[回答](https://stackoverflow.com/questions/880467/renaming-a-set-of-files-to-001-002-on-linux/880488#880488)。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-23T20:07:55.103

尝试以下脚本：

[计算.sh](http://sourceforge.net/projects/numerate/files/numerate.sh/download)

这段代码剪断应该可以完成这项工作：

```
./numerate.sh -d <your image folder> -b <start number> -L 3 -p image_ -s .jpg -o numerically -r 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T00:43:52.577

这与您所要求的相反（获取格式为 *.jpg.001 的文件并将它们转换为 *.001.jpg），但可以根据您的目的轻松修改：

```
for file in * 

do

if [[ "$file" =~ "(.*)\.([[:alpha:]]+)\.([[:digit:]]{3,})$" ]]

then

mv "${BASH_REMATCH[0]}" "${BASH_REMATCH[1]}.${BASH_REMATCH[3]}.${BASH_REMATCH[2]}"

fi

done 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T06:28:36.920

这里已经有一些很好的答案；但有些人依赖隐藏错误，这不是一个好主意（假设`mv`只会因为预期的条件而出错 - 所有其他原因`mv`可能会出错呢？）。

此外，它可以做得更短一点，应该更好地引用：

```
for file in *; do
    printf -vsequenceImage 'image_%03d.jpg' "$((++i))"
    [[ -e $sequenceImage ]] || \
        mv "$file" "$sequenceImage"
done 
```

另请注意，[您不应](https://stackoverflow.com/questions/673055/correct-bash-and-shell-script-variable-capitalization/673940#673940)在 bash 脚本中将变量大写。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T00:49:21.580

我打算使用 for 循环、迭代器、cut -f1 -d "_" 和 mv i i.iterator 来建议类似上面的内容。不过，看起来它已经涵盖了其他方式。

# java - 在不直接使用同步的情况下避免在 Java 中丢失更新

> ID：880474
> 
> 赞同：4
> 
> 时间：2009-05-19T00:41:15.450
> 
> 标签：java, synchronization

我想知道是否有可能避免丢失更新问题，即多个线程更新同一日期，同时避免使用`synchronized(x) { }`.

我将做大量的添加和增量：

```
val++;
ary[x] += y;
ary[z]++; 
```

我不知道 Java 将如何将这些编译成字节码，以及线程是否可以在这些语句块中的一个字节码块的中间被中断。换句话说，这些语句是线程安全的吗？

另外，我知道 Vector 类是同步的，但我不确定这意味着什么。下面的代码是否是线程安全的，因为 position 的值`i`不会在`vec.get(i)`和之间改变`vec.set(...)`。

```
class myClass {
  Vector<Integer> vec = new Vector<>(Integer);

  public void someMethod() {
    for (int i=0; i < vec.size(); i++)
      vec.set(i, vec.get(i) + value);
  }
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T00:52:00.953

出于线程的目的，`++`和`+=`被视为两个操作（四个 for`double`和`long`）。因此，更新可能会相互影响。不仅是一个，而且在错误时刻采取行动的调度程序可能会消除几毫秒的更新。

`java.util.concurrent.atomic`是你的朋友。

假设您不介意每个元素单独更新并且您不更改大小（！），您的代码可以变得安全，如：

```
for (int i=0; i < vec.size(); i++) {
    synchronized (vec) {
        vec.set(i, vec.get(i) + value);
    }
} 
```

如果你想添加调整大小，`Vector`你需要将`synchronized`语句移到`for`循环之外，你也可以使用普通的 new `ArrayList`。同步列表实际上并没有太多用处。

但你可以使用`AtomicIntegerArray`：

```
private final AtomicIntegerArray ints = new AtomicIntegerArray(KNOWN_SIZE);
[...]
    int len = ints.length();
    for (int i=0; i<len; ++i) {
        ints.addAndGet(i, value);
    }
} 
```

这具有没有锁（！）和拳击的优点。该实现也很有趣，您需要了解它进行更复杂的更新（例如随机数生成器）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T00:52:27.817

vec.set() 和 vec.get() 是线程安全的，因为它们不会以丢失集合并进入其他线程的方式设置和检索值。这并不**意味着**你的设置和你的得到会不间断地发生。

如果你真的要像上面的例子那样编写代码，你可能应该锁定一些东西。和`synchronized(vec) { }`任何一样好。您在这里要求**两个**操作同步发生，而不仅仅是一个线程安全操作。

甚至 java.util.concurrent.atomic 也只能确保一个操作（get 或 set）安全发生。您需要在一次操作中获取和递增。

# php - 如何设置 PHP + xDebug + (x)Unit + Eclipse 在单元测试中使用断点？

> ID：880479
> 
> 赞同：6
> 
> 时间：2009-05-19T00:44:25.350
> 
> 标签：php, eclipse, debugging, xdebug, simpletest

已经尝试了很长一段时间以使其正常工作，但没有运气。基本上，我有带有 PHP 开发工具 (PDT) 的 Eclipse (3.3)，以及 PDT XDebug 插件以及 SimpleTest eclipse 插件。

我想做的是调试 SimpleTest 单元测试调用的代码。SimpleTest 清楚地可以看到 XDebug，因为我可以生成代码覆盖率报告，但它不会在断点处停止。

**编辑**：应该添加 XDebug 和断点在 Eclipse 中工作正常，而不是在 SimpleTest 调用时

有人设置成功了吗？周围有很多乱七八糟的文档，而有用的信息却很少。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T23:12:15.507

确保您的 PHP 版本具有正确的 XDebug 版本，并将其添加到 php.ini 文件的最开头：

```
[xdebug]
zend_extension=full_path_to_your_xdebug.so 
xdebug.default_enable=On
xdebug.remote_enable=On
xdebug.remote_handler="dbgp"
xdebug.remote_host="localhost"
xdebug.remote_port=9000 
```

然后执行 an `apachectl graceful`and a`phpinfo`并确保 XDebug 存在且处于活动状态。如果是，一切都应该正常。我知道它对我有用。

**编辑：**我在阅读整个问题之前回答了。

在运行脚本之前，您应该设置环境变量；

```
export XDEBUG_CONFIG="idekey=session_name" 
```

可能可以从 php 执行此操作，但我无法对此进行测试：

```
putenv('XDEBUG_CONFIG="idekey=session_name"'); 
```

您应该确保您使用的 php 二进制文件已加载 XDebug 扩展，在我的系统上 apache 模块有它，但默认的 CLI 解释器没有，但我故意运行不同的版本。

这里有一些[很好的文档](http://www.xdebug.org/docs/remote)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T11:32:42.637

要进一步了解 Kris 的回答，如果您在同一台服务器上管理生产和开发环境，最好将您的 xdebug 设置降级为 a`php include`或那些`virtualhosts`专用于`dev`or`testing`环境的设置：

*   虚拟主机的语法是

    ```
    <virtualHost ....>

      (...)

      # Xdebug ENV
      php_flag xdebug.auto_trace on
      php_flag xdebug.idekey session_name
      php_flag xdebug.profiler_enable_trigger 1
      php_flag xdebug.(...)

      (...) 
    ```

# ruby-on-rails - 缓存在 rake 任务中的 ActiveRecord 模型？

> ID：880482
> 
> 赞同：6
> 
> 时间：2009-05-19T00:46:07.033
> 
> 标签：ruby-on-rails, activerecord, rake

我知道在 rails 2.3.2 ActiveRecord 查询被缓存，即您可能会在开发/生产日志中看到一些内容：

```
CACHE (0.0ms)   SELECT * FROM `users` WHERE `users`.`id` = 1 
```

我想知道相同的原则是否适用于 rake 任务。

我有一个 rake 任务，它将查询很多不同的模型，我想知道我是否应该实现自己的缓存，或者默认情况下是否包含此行为。

另外，有没有办法查看 rake 任务期间执行的 sql 查询？类似于开发/生产日志

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-16T14:46:55.077

默认情况下，不会为 rake 任务启用 SQL 缓存。您可以将代码包装在缓存块中，如下所示：

```
task :foobar => :environment do
  ActiveRecord::Base.connection.cache do
    User.find 1 # Will hit the db
    User.find 1 # Will hit the cache
  end
end 
```

这本质上是 Rails 对控制器操作所做的。请注意，缓存使用内存，而 rake 任务倾向于处理大量数据，这可能会给您带来问题。您可以选择性地选择退出部分代码的缓存，使用[`uncached`](http://api.rubyonrails.org/classes/ActiveRecord/QueryCache/ClassMethods.html#method-i-uncached)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-09T12:11:56.903

您正在谈论 ActiveRecord 查询缓存。这也应该在 Rake-Tasks 中工作，前提是您在启用缓存的环境中运行它们，例如`production`. 有关示例，请参阅[Rails 缓存指南。](http://guides.rubyonrails.org/caching_with_rails.html#sql-caching)

对于您的情况，它可能是也可能不是正确的缓存类型：

```
u1=User.find 1  # loads user1 first time from DB
u2=User.find 2  # loads user2 first time from DB
u1again = User.find 1 # loads user1 from cache
all = User.all # loads user1 and user2 from DB again 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T00:50:39.287

rake 任务将在您指定的环境中运行，在这种情况下，它将采用该环境的规则。

您可以从命令行设置 rails env：

```
RAILS_ENV=test 
```

日志记录可以设置为 rake 的一部分，您应该在正常的 Rails 日志中看到这一点。

# sql-server - SQL Server 命令行备份语句

> ID：880487
> 
> 赞同：35
> 
> 时间：2009-05-19T00:47:22.520
> 
> 标签：sql-server, command-line, backup

有谁知道是否有办法将 SQL Server 备份脚本写入批处理文件，以便可以从命令行执行？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-05-19T00:50:57.240

这是一个示例，您可以使用Sql Server 客户端工具中的[SQLCMD](http://msdn.microsoft.com/en-us/library/ms162773(v=sql.100).aspx)实用程序作为批处理脚本运行（复制粘贴到 .bat 文件中） ：

备份：

```
echo off
cls
echo -- BACKUP DATABASE --
set /p DATABASENAME=Enter database name:

:: filename format Name-Date (eg MyDatabase-2009.5.19.bak)
set DATESTAMP=%DATE:~-4%.%DATE:~7,2%.%DATE:~4,2%
set BACKUPFILENAME=%CD%\%DATABASENAME%-%DATESTAMP%.bak
set SERVERNAME=your server name here
echo.

sqlcmd -E -S %SERVERNAME% -d master -Q "BACKUP DATABASE [%DATABASENAME%] TO DISK = N'%BACKUPFILENAME%' WITH INIT , NOUNLOAD , NAME = N'%DATABASENAME% backup', NOSKIP , STATS = 10, NOFORMAT"
echo.
pause 
```

恢复：

```
echo off
cls
echo -- RESTORE DATABASE --
set /p BACKUPFILENAME=Enter backup file name:%CD%\
set /p DATABASENAME=Enter database name:
set SERVERNAME=your server name here
sqlcmd -E -S %SERVERNAME% -d master -Q "ALTER DATABASE [%DATABASENAME%] SET SINGLE_USER WITH ROLLBACK IMMEDIATE"

:: WARNING - delete the database, suits me
:: sqlcmd -E -S %SERVERNAME% -d master -Q "IF EXISTS (SELECT * FROM sysdatabases WHERE name=N'%DATABASENAME%' ) DROP DATABASE [%DATABASENAME%]"
:: sqlcmd -E -S %SERVERNAME% -d master -Q "CREATE DATABASE [%DATABASENAME%]"

:: restore
sqlcmd -E -S %SERVERNAME% -d master -Q "RESTORE DATABASE [%DATABASENAME%] FROM DISK = N'%CD%\%BACKUPFILENAME%' WITH REPLACE"

:: remap user/login (http://msdn.microsoft.com/en-us/library/ms174378.aspx)
sqlcmd -E -S %SERVERNAME% -d %DATABASENAME% -Q "sp_change_users_login 'Update_One', 'login-name', 'user-name'"
sqlcmd -E -S %SERVERNAME% -d master -Q "ALTER DATABASE [%DATABASENAME%] SET MULTI_USER"
echo.
pause 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-21T15:42:04.637

[Seba Illingworth](https://stackoverflow.com/users/93451/seba-illingworth)的代码，以防您在文件名中需要时间（它给出 2014-02-21_1035）

```
echo off
cls
echo -- BACKUP DATABASE --
set /p DATABASENAME=Enter database name:
For /f "tokens=2-4 delims=/ " %%a in ('date /t') do (set mydate=%%c-%%a-%%b)
For /f "tokens=1-2 delims=/:" %%a in ("%TIME%") do (set mytime=%%a%%b)

:: filename format Name-Date (eg MyDatabase-2009.5.19.bak)
set DATESTAMP=%mydate%_%mytime%
set BACKUPFILENAME=%CD%\%DATABASENAME%-%DATESTAMP%.bak
set SERVERNAME=.
echo.

sqlcmd -E -S %SERVERNAME% -d master -Q "BACKUP DATABASE [%DATABASENAME%] TO DISK = N'%BACKUPFILENAME%' WITH INIT , NOUNLOAD , NAME = N'%DATABASENAME% backup', NOSKIP , STATS = 10, NOFORMAT"
echo.
pause 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-12-04T09:39:18.570

您可以使用 sqlcmd 运行备份或任何其他 T-SQL 脚本。您可以在本文中找到有关各种有用 sqlcmd 开关的详细说明和示例：[使用 SQL Server 命令行 (sqlcmd)](https://www.sqlshack.com/working-sql-server-command-line-sqlcmd/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T00:50:57.147

如果您需要批处理文件来计划备份，SQL 管理工具已内置计划任务...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-04-27T10:53:12.490

[将删除旧备份文件](http://maxvit.net/sah_remove_backup_files)与上述脚本相结合，然后可以通过调度程序执行备份，保留最后 10 个备份文件

```
echo off
:: set folder to save backup files ex. BACKUPPATH=c:\backup
set BACKUPPATH=<<back up folder here>>

:: set Sql Server location ex. set SERVERNAME=localhost\SQLEXPRESS
set SERVERNAME=<<sql host here>>

:: set Database name to backup
set DATABASENAME=<<db name here>>

:: filename format Name-Date (eg MyDatabase-2009-5-19_1700.bak)
For /f "tokens=2-4 delims=/ " %%a in ('date /t') do (set mydate=%%c-%%a-%%b)
For /f "tokens=1-2 delims=/:" %%a in ("%TIME%") do (set mytime=%%a%%b)

set DATESTAMP=%mydate%_%mytime%
set BACKUPFILENAME=%BACKUPPATH%\%DATABASENAME%-%DATESTAMP%.bak
echo.

sqlcmd -E -S %SERVERNAME% -d master -Q "BACKUP DATABASE [%DATABASENAME%] TO DISK = N'%BACKUPFILENAME%' WITH INIT , NOUNLOAD , NAME = N'%DATABASENAME% backup', NOSKIP , STATS = 10, NOFORMAT"
echo.

:: In this case, we are choosing to keep the most recent 10 files
:: Also, the files we are looking for have a 'bak' extension
for /f "skip=10 delims=" %%F in ('dir %BACKUPPATH%\*.bak /s/b/o-d/a-d') do del "%%F" 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-12T09:52:07.420

我使用的是 SQL Server 2005 Express，我必须启用命名管道连接才能从 Windows 命令进行备份。我的最终脚本是这样的：

```
@echo off
set DB_NAME=Your_DB_Name
set BK_FILE=D:\DB_Backups\%DB_NAME%.bak
set DB_HOSTNAME=Your_DB_Hostname
echo.
echo.
echo Backing up %DB_NAME% to %BK_FILE%...
echo.
echo.
sqlcmd -E -S np:\\%DB_HOSTNAME%\pipe\MSSQL$SQLEXPRESS\sql\query -d master -Q "BACKUP DATABASE [%DB_NAME%] TO DISK = N'%BK_FILE%' WITH INIT , NOUNLOAD , NAME = N'%DB_NAME% backup', NOSKIP , STATS = 10, NOFORMAT"
echo.
echo Done!
echo. 
```

它在这里工作得很好！

# javascript - JQuery 提交的复选框值未定义

> ID：880490
> 
> 赞同：2
> 
> 时间：2009-05-19T00:49:04.313
> 
> 标签：javascript, jquery

我今天刚刚在之前的 jQuery 问题上收到了一些非常好的帮助，并且我想，由于我的运气很好，也许我也可以在一些复选框方面获得一些帮助。有人可以告诉我我做错了什么吗？

谢谢！

复选框正确地回显了数据库布尔值，但是当我提交更改的值时，alert() 告诉我它们未定义。

```
 else if (item.field == "admCustRptDly" && item.value == "1")
        {
          $('#admCustRptDly').attr('checked', true);
        }

        else if (item.field == "admCustRptSumm" && item.value == "1")
        {
          $('#admCustRptSumm').attr('checked', true);
        }

        else if (item.field == "admCustRptDtl" && item.value == "1")
        {
          $('#admCustRptDtl').attr('checked', true);
        }

<tr>
    <td class="admMarker">Daily<input type="checkbox" id="admCustRptDly" name="admCustRptDly" class="admChkbx"></td>
    <td class="admMarker">Summary<input type="checkbox" id="admCustRptSumm" name="admCustRptSumm" class="admChkbx"></td>
    <td class="admMarker">Detail<input type="checkbox" id="admCustRptDtl" name="admCustRptDtl" class="admChkbx"></td>
</tr> 
```

* * *

```
$(function() {   $('.error').hide();
    $('input.text-input').css({backgroundColor:"#FFFFFF"});
    $('input.text-input').focus(function(){
        $(this).css({backgroundColor:"#FFDDAA"});
    });  
    $('input.text-input').blur(function(){
        $(this).css({backgroundColor:"#FFFFFF"});
    });

      $(".admCustBtn").click(function()
    {       // validate and process form
            // first hide any error messages
        $('.error').hide();

          var admCustRPSecPhone =
    $("input#admCustRPSecPhone").val();
          var admCustRptDly =
    $("checkbox#admCustRptDly").val();  
    var admCustRptSumm =
    $("checkbox#admCustRptSumm").val();
          var admCustRptDtl =
    $("checkbox#admCustRptDtl").val();

            var dataString =
        'admCustID='+ admCustID +
        '&admCustRptDly='+ admCustRptDly +
        '&admCustRptSumm='+ admCustRptSumm +
        '&admCustRptDtl='+ admCustRptDtl;

            alert (dataString);return false;

            $.ajax({
          type: "POST",
          url: "body.php?action=admCustomer",
          data: dataString,
          success: function(){
            alert( "Success! Data Saved");
          }
         });
        return false;   }); }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T01:02:39.637

其实两者..

复选框没有价值，因此如果您尝试提醒（）它们的值，它将导致“未定义”，但如果您在提醒复选框本身时遇到这种情况，您可能做错了。

正如@Soviut 所说，将它们的值设置为 true 不会导致任何结果，大多数属性在设置时都会重复它们的名称。因此，您的输入将如下所示：

```
<input type="checkbox" checked="checked" value="1" name="myCheck" /> 
```

所以，试试上面的方法，给我们一些反馈=´p

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-11T10:23:26.740

抱歉，在我的情况下，它是 .attr() - 对我来说很好，即使在 adobe air 中也是如此。

```
jQuery('#mycheckbox').attr( "checked" ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T00:54:14.893

您没有在 HTML 输入元素上设置 value 属性

```
<input type="checkbox" value="1" id="admCustRptDly" name="admCustRptDly"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T01:30:22.340

您的复选框选择器不正确。

```
 var admCustRPSecPhone = $("input#admCustRPSecPhone:checked").val() == 'on';
  var admCustRptDly = $("input#admCustRptDly:checked").val() == 'on';  
  var admCustRptSumm = $("input#admCustRptSumm:checked").val() == 'on';
  var admCustRptDtl = $("input#admCustRptDtl:checked").val() == 'on'; 
```

你也可以使用类似的东西：

```
 var admCustRptDly = $("#admCustRptDly:checkbox:checked").val() == 'on'; 
```

这将根据是否选中复选框将值设置为真/假。

# windows - Windows GUI 编程 - C + SDK 或 C# + Windows 窗体

> ID：880491
> 
> 赞同：4
> 
> 时间：2009-05-19T00:49:11.113
> 
> 标签：windows, user-interface

我是一名具有大量服务器代码经验（AIX、HPUX、一些 Linux）的 C 程序员我需要为 Windows（2000、XP、Vista、7）编写一个 GUI 程序，它需要类似 CAD 的绘图功能和大量数据输入表格（这是一个专门的工程应用程序）。多年前，我使用 Gupta SQLwindows（现在的 Centura Builder）编写了一些 Win32 代码。老板们已经下令它“必须”编译代码。我的看法是 C+SDK 可以完成这项工作，但需要付出相当大的努力，而且 C# + Windows 窗体会更有能力，但我有点担心 .Net 框架的要求。

根据您的经验，您有什么建议？

如果是.Net，哪个版本？2.0, 3.0, 3.5 ??

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-19T01:31:34.040

我不熟悉 Centura Builder，所以我不确定您之前的 Windows 编程经验处于什么抽象级别。如果您选择使用 C/C++ 和 Win32 的本机代码路线，请务必购买Charles Petzold的[Programming Windows副本。](http://www.charlespetzold.com/pw5/index.html)阅读本书的前几章可以帮助你决定是否也想走原生代码路线。

如果您选择 .NET Framework 和 C#，并且不需要 3.5 版特有的功能（例如用于数据库访问的 LINQ），我建议选择 3.0 版。它是 Windows Vista 上的内置组件，因此您不必将运行时与程序安装程序一起打包，除非您必须支持 Windows XP（您可能会这样做，所以没关系:)。使用 3.0 版，您可以获得 Windows Presentation Foundation（代替 Windows 窗体使用或与 Windows 窗体一起使用），它为您提供了许多图形功能，而无需付出很多努力。我不了解 CAD，所以我不知道 WPF 是否会提供您需要的绘图功能，但它可能会提供一个很好的平台，您可以在此平台上编写自己的绘图例程。

编辑：我在初读时错过了您的 Windows 版本要求，尤其是 Windows 2000 要求。我猜您必须使用 .NET Framework 2.0 版和 Windows 窗体。不过，我不得不问：通过将他们使用了 8 年的机器升级到更新、更快的机器从而摆脱 Windows 2000 支持要求来提高工程师的工作效率，这不是成本效益高吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T01:30:24.603

如果您要使用 .NET 路线，则必须使用 .NET 2.0，因为仅 Windows XP 及更高版本（Vista、7、2003、2008）支持 .NET 3.0 及更高版本。

我个人不会为 .NET 框架要求出汗。这是在每台机器上一次性安装，如果需要，可以通过 Windows 更新进行简化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T00:51:56.380

如果你不想要 .NET，Qt + C++ 绝对是你要走的路；它肯定胜过 C 和 Win32。.NET 仍然允许比 Qt 更快的开发。Qt 具有快速和易于部署的优势（不需要 .NET），并且使可移植性更加容易（如果您想移植到 Linux 或 Mac）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T01:02:59.650

如果您必须使用本机代码，那么我强烈建议您使用Codegear / Embarcadero 的[RAD Studio](http://www.codegear.com/products/radstudio)，如果您已经熟悉 C/C++，它是一个 Studio 产品，附带 Delphi（从 Turbo Pascal 演变而来的面向对象语言）和 C++ Builder那么你**很**容易就能把它捡起来。两种语言共享的可视化组件库是可扩展的、强大的和 RAD 的。

如果您能够使用托管代码，那么带有 Winforms 的 C# 很容易使用，从长远来看，WPF 可能是更好的 UI 选择，但它的学习曲线更陡峭。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T00:53:00.747

根据类 CAD 绘图的复杂性要求，我会使用 C# + Windows 窗体，甚至更可取的是 C# + WPF。

WPF 将使绘图比在 GDI 中进行绘制要干净得多。如果您要进行一些 3D“绘图”，则尤其如此，因为您可以直接在 WPF 中制作大量（简单）3D 对象。C# 将使您的 GUI 编程比直接使用 Windows API（甚至 MFC）在 C/C++ 中进行更有效率。

就我个人而言，我认为 .NET 的要求是最低限度的，但这实际上取决于您组织中的权力......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T00:54:30.150

如果它必须编译代码，我会推荐 MFC 的 WTL，但使用 C# + WinForms 或 WPF 会更快（在开发成本方面）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-19T09:41:09.747

您可以使用 C 或 C++/Win32 api完成**所有**
操作 （用于类似 CAD 绘图的 Win32 示例在 MSDN 中。）

# c++ - C++ 接口编译

> ID：880495
> 
> 赞同：0
> 
> 时间：2009-05-19T00:50:20.237
> 
> 标签：c++, compiler-construction, interface, g++

**编辑：**

*我想出了解决方案。我没有将 -combine 添加到我的编译指令中，这会产生错误。*

* * *

我正在阅读 Deitel 和 Deitel 的《C++ How to Program》一书，并且在使用 g++ 构建和编译 C++ 接口时遇到了问题。问题是，我已经在 .h 文件中声明了类并在 .cpp 文件中定义了实现，但是当我尝试编译我编写的测试文件时，我无法弄清楚如何让它编译和工作。我收到的 g++ 错误是：

```
Undefined symbols:
  "GradeBook::GradeBook(std::basic_string<char, std::char_traits<char>, std::allocator<char> >)", referenced from:
      _main in ccohy7fS.o
      _main in ccohy7fS.o
  "GradeBook::getCourseName()", referenced from:
      _main in ccohy7fS.o
      _main in ccohy7fS.o
ld: symbol(s) not found
collect2: ld returned 1 exit status< 
```

如果有人能指出我正确的方向，我将不胜感激。

我的头文件：

```
 //Gradebook 6 Header
//Purpose is to be the class declaration for the class Gradebook 6
//Declare public, privates, and function names. 

#include  //the standard c++ string class library
using std::string;

//define the class gradebook
class GradeBook
{
    public:  //all the public functions in the class

     GradeBook(string ); //constructor expects string input
     void setCourseName (string ); //method sets course name--needs string input
     string getCourseName(); //function returns a string value
     void displayMessage();  //to console

    private: //all private members of the class
        string courseName; 
}; //ends the class declaration 
```

我的 .cpp 文件是：

```
 //Gradebook 6
// The actual implementation of the class delcaration in gradebook6.h

#include 
using std::cout;
using std::endl;

#include "gradebook6.h" //include the class definition

//define the class gradebook

GradeBook::GradeBook(string name) //constructor expects string input
{
    setCourseName(name); //call the set method and pass the input from the constructor. 
}

void GradeBook::setCourseName (string name) //method sets course name--needs string input
{
    courseName = name; //sets the private variable courseName to the value passed by name
}

string GradeBook::getCourseName() //function returns a string value
{
    return courseName;
}

void GradeBook::displayMessage()  //function does not return anything but displays //message to console
{
   cout //message here, the pre tag isn't letting it display
} //end function displayMessage 
```

最后是我写的实现接口并测试的测试文件。

```
 // Gradebook6 Test
// Program's purpose is to test our GradeBook5 header file and file seperated classes

#include 
using std::cout;
using std::endl;

#include "gradebook6.h" //including our gradebook header from the local file.

//being program
int main()
{
    //create two gradebook objects 
    GradeBook myGradeBook1 ("CSC 101 Intro to C++ Programming"); //create a default object using the default constructor
    GradeBook myGradeBook2 ("CSC 102 Data Structures in C++");

    //display intitial course name
    cout //another output message here that the code tag does not like

    return 0;
}
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T00:52:12.543

看起来您只需要将 GradeBook.cpp 目标文件链接到您的最终可执行文件。关心发布您的 makefile 或您构建它的方式吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T01:08:20.170

您看到的是链接器错误（指示在“返回的 ld”位中：ld 是链接器）。您需要将所有 .cpp 文件提供给 g++，以便它编译并链接它们，或者使用后者的 -c 开关从 .cpp 创建一个 .o，然后在另一个 g++ 命令上使用 THAT .o 来构建（链接）可执行文件。

# .net - C1083：无法打开包含文件“serialheader.h”：没有这样的文件或目录

> ID：880509
> 
> 赞同：1
> 
> 时间：2009-05-19T00:55:06.983
> 
> 标签：.net, c++-cli, clr

我正在为用 C 编写的库编写一个包装器。

此库的头文件位于
C:\Projects\SerialLibrary
包装器位于
C:\Projects\SerialLibrary\Client\ClrSerialLibrary

不管我做什么，VS2008，似乎都找不到

```
#include "serialheader.h" 
```

我总是收到没有这样的文件或目录错误。我尝试在 ClrSerialLibrary Property Pages->Configuration Properties->C/C++->General->Additional Include Directories 中放置目录的硬编码路径

我也试过

```
#include "..\..\serialheader.h" 
```

我还尝试将头文件的副本放在与 clr 库相同的目录中。不走运！帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T01:29:35.430

并且您已经检查了 msdn 中提到的所有潜在问题？

1.  文件不存在。
2.  文件、子目录或磁盘是只读的。
3.  没有文件或目录的访问权限。
4.  没有足够的文件句柄。关闭一些应用程序并重新编译。
5.  INCLUDE 环境变量设置不正确。
6.  #include 指令在路径规范周围使用双引号，这会导致标准目录被跳过。
7.  您没有指定 /clr 并且您的程序使用 CLR 构造。
8.  您试图在没有先编译 stdafx.cpp 的情况下编译项目中的单个文件。在编译项目中的单个文件之前，您需要编译 stdafx.cpp。对于 /analyze（企业代码分析）编译器选项，您需要对 stdafx.cpp 使用与 .cpp 文件相同的 /analyze 设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T01:39:27.020

我不能告诉你我脑海中的答案，但我相信这正是那种不可避免地屈服于一点决心和逻辑问题解决的问题。我会做以下事情；

1) 找到可行的方法，尝试您还没有想到的其他可能性，例如

```
- #include "c:\projects\seriallibrary\serialheader.h"
- #include <serialheader.h>
- Copy serialheader.h to a known good include directory 
```

2）如果没有任何效果，将问题减少到最低限度 - 一个 .cpp 文件 一个 .h 文件

3）一旦你开始工作，你会确信你或你的开发环境都不是非理性的和/或疯狂的。在那个阶段，您将准备好...

4) ...逐步将工作但人为的情况转变为您可以实际使用的实际情况。在每个阶段逐步执行此操作，以测试新设置是否仍然有效。

我猜在第 4 步）的某个地方你会有一个啊哈！瞬间，一切都会变得清晰。即使不是，您也应该有一些可以同时使用的东西。

请注意，通过一些细节更改，上面的配方适用于各种非深奥的编程问题！

# javascript - 双击后防止文本选择

> ID：880512
> 
> 赞同：340
> 
> 时间：2009-05-19T00:55:52.130
> 
> 标签：javascript, selection-object

我正在我的网络应用程序的跨度上处理 dblclick 事件。一个副作用是双击会选择页面上的文本。我怎样才能防止这种选择发生？

* * *

## 回答 #1

> 赞同：381
> 
> 时间：2009-05-19T00:58:57.600

```
function clearSelection() {
    if(document.selection && document.selection.empty) {
        document.selection.empty();
    } else if(window.getSelection) {
        var sel = window.getSelection();
        sel.removeAllRanges();
    }
} 
```

您还可以将这些样式应用于所有非 IE 浏览器和 IE10 的跨度：

```
span.no_selection {
    user-select: none; /* standard syntax */
    -webkit-user-select: none; /* webkit (safari, chrome) browsers */
    -moz-user-select: none; /* mozilla browsers */
    -khtml-user-select: none; /* webkit (konqueror) browsers */
    -ms-user-select: none; /* IE10+ */
} 
```

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2010-11-05T14:19:28.390

在纯 JavaScript 中：

```
element.addEventListener('mousedown', function(e){ e.preventDefault(); }, false); 
```

或者使用 jQuery：

```
jQuery(element).mousedown(function(e){ e.preventDefault(); }); 
```

* * *

## 回答 #3

> 赞同：120
> 
> 时间：2017-04-10T11:08:58.410

仅在双击后防止文本选择：

你可以使用`MouseEvent#detail`财产。对于 mousedown 或 mouseup 事件，它是 1 加上当前点击次数。

```
document.addEventListener('mousedown', function (event) {
  if (event.detail > 1) {
    event.preventDefault();
    // of course, you still do not know what you prevent here...
    // You could also check event.ctrlKey/event.shiftKey/event.altKey
    // to not prevent something useful.
  }
}, false); 
```

请参阅[https://developer.mozilla.org/en-US/docs/Web/API/UIEvent/detail](https://developer.mozilla.org/en-US/docs/Web/API/UIEvent/detail)

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2018-12-27T02:38:45.463

FWIW，我设置`user-select: none`为那些我不想在双击父元素的任意位置时以某种方式选择的子元素的父元素**。**它有效！很酷的是`contenteditable="true"`，文本选择等仍然适用于子元素！

就像：

```
<div style="user-select: none">
  <p>haha</p>
  <p>haha</p>
  <p>haha</p>
  <p>haha</p>
</div> 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-07-24T21:54:17.680

一个简单的 Javascript 函数，它使页面元素内的内容无法选择：

```
function makeUnselectable(elem) {
  if (typeof(elem) == 'string')
    elem = document.getElementById(elem);
  if (elem) {
    elem.onselectstart = function() { return false; };
    elem.style.MozUserSelect = "none";
    elem.style.KhtmlUserSelect = "none";
    elem.unselectable = "on";
  }
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-04-10T16:45:12.293

对于那些正在寻找**Angular 2+**解决方案的人。

**您可以使用`mousedown`表格单元格的输出。**

```
<td *ngFor="..."
    (mousedown)="onMouseDown($event)"
    (dblclick) ="onDblClick($event)">
  ...
</td> 
```

并防止如果`detail > 1`.

```
public onMouseDown(mouseEvent: MouseEvent) {
  // prevent text selection for dbl clicks.
  if (mouseEvent.detail > 1) mouseEvent.preventDefault();
}

public onDblClick(mouseEvent: MouseEvent) {
 // todo: do what you really want to do ...
} 
```

`dblclick`输出继续按预期工作。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-08-10T15:47:02.737

如果您试图完全阻止通过任何方法以及仅双击来选择文本，则可以使用`user-select: none`css 属性。我已经在 Chrome 68 中进行了测试，但根据[https://caniuse.com/#search=user-select](https://caniuse.com/#search=user-select)它应该可以在其他当前普通用户浏览器中使用。

在行为上，在 Chrome 68 中，它由子元素继承，并且不允许选择元素包含的文本，即使选择了围绕并包含元素的文本。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-19T01:06:24.183

或者，在 Mozilla 上：

```
document.body.onselectstart = function() { return false; } // Or any html object 
```

在 IE 上，

```
document.body.onmousedown = function() { return false; } // valid for any html object as well 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-06-24T20:23:09.250

旧线程，但我想出了一个我认为更干净的解决方案，因为它不会禁用每个甚至绑定到对象，并且只会阻止页面上的随机和不需要的文本选择。这很简单，对我来说效果很好。这是一个例子；当我在具有“右箭头”类的对象上单击几次时，我想阻止文本选择：

```
$(".arrow-right").hover(function(){$('body').css({userSelect: "none"});}, function(){$('body').css({userSelect: "auto"});}); 
```

！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-11-18T22:27:05.303

为了防止 IE 8 CTRL 和 SHIFT 单击单个元素上的文本选择

```
var obj = document.createElement("DIV");
obj.onselectstart = function(){
  return false;
} 
```

防止在文档上选择文本

```
window.onload = function(){
  document.onselectstart = function(){
    return false;
  }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-09-04T09:12:02.413

如果您使用的是 Vue JS，只需附加`@mousedown.prevent=""`到您的元素，它就会神奇地消失！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-07-19T14:42:01.167

我知道这是一个老问题，但它在 2021 年仍然完全有效。但是，我在答案方面缺少的是任何提及[`Event.stopPropagation()`](https://developer.mozilla.org/en-US/docs/Web/API/Event/stopPropagation).

OP 正在请求该`dblclick`事件，但据我所知，该`pointerdown`事件发生了同样的问题。在我的代码中，我注册了一个监听器，如下所示：

```
this.addEventListener("pointerdown", this._pointerDownHandler.bind(this)); 
```

侦听器代码如下所示：

```
_pointerDownHandler(event) {
  // Stuff that needs to be done whenever a click occurs on the element
} 
```

在我的元素上快速单击多次会被浏览器解释为双击。根据您的元素在页面上的位置，双击将选择文本，因为这是给定的行为。

您*可以*通过调用*确实*[`Event.preventDefault()`](https://developer.mozilla.org/en-US/docs/Web/API/Event/preventDefault)解决问题的侦听器来禁用该默认操作，至少在某种程度上是这样。

 *但是，如果您在一个元素上注册一个侦听器并编写相应的“处理”代码，您可能会*吞下*那个`Event.stopPropagation()`确保的事件。因此，处理程序将如下所示：

```
_pointerDownHandler(event) {
  event.stopPropagation();
  // Stuff that needs to be done whenever a click occurs on the element
} 
```

因为我的元素已经使用了该事件，所以层次结构中更靠前的元素不知道该事件，也不会执行它们的处理代码。

如果您让事件冒泡，层次结构中较高的元素*都会*执行它们的处理代码，但被告知不要这样做，`Event.preventDefault()`这对我来说比从一开始就阻止事件冒泡更没有意义。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2021-09-17T16:36:16.877

顺风 CSS：

```
<div class="select-none ...">
  This text is not selectable
</div> 
```

* * *

## 回答 #14

> 赞同：-5
> 
> 时间：2017-08-04T19:55:23.047

我有同样的问题。我通过切换到`<a>`并添加来解决它`onclick="return false;"`（这样单击它就不会在浏览器历史记录中添加新条目）。

# asp.net-mvc - xVal 和 ViewModel 模式——可以做到吗？

> ID：880514
> 
> 赞同：3
> 
> 时间：2009-05-19T00:57:28.663
> 
> 标签：asp.net-mvc, xval

我一直在将 xVal 添加到 NerdDinner 应用程序中 - 到目前为止一切都很好，我在一行中使用 jQuery.validate 进行了客户端验证，这真的很漂亮。但我似乎无法让 xVal 验证一个复杂的对象。假设我有一个如下所示的 Dinner 对象：

```
public class Dinner
{
     [Required]
     public string Title { get; set; }
} 
```

和另一个对象，一个容器：

```
public class DinnerWrapper
{
     public Dinner Dinner { get; set; }
     public string Name { get; set; }
} 
```

如果我的控制器传递`Dinner`给视图，我可以让 xVal 在表单末尾执行客户端验证，如下所示：

```
<% using (Html.BeginForm())
       { %>
    <fieldset>
        <p>
            <label for="Title">
                Dinner Title:</label>
            <%= Html.TextBox("Title") %>
            <%= Html.ValidationMessage("Title", "*") %>
        </p>
    </fieldset>
    <% } %>
<%=Html.ClientSideValidation<Dinner>()%> 
```

但是当我通过 DinnerWrapper 时，我无法让它工作 - xVal 不使用以下设置执行客户端验证：

```
<% using (Html.BeginForm())
       { %>
    <fieldset>
        <p>
            <label for="Title">
                Dinner Title:</label>
            <%= Html.TextBox("Title", Model.Dinner.Title) %>
            <%= Html.ValidationMessage("Title", "*") %>
        </p>
    </fieldset>
    <% } %>
<%=Html.ClientSideValidation<DinnerWrapper>()%> 
```

有任何想法吗？到目前为止，我已经成功地将 xVal（和 NHaml）集成到了 NerdDinner 应用程序中，但我似乎遇到了障碍。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T18:06:19.387

原来我不必更改 ClientSideValidation 行 - 它的工作原理如下：

```
<%=Html.ClientSideValidation<Dinner>()%> 
```

# c# - 在asp mvc中显示数据库中的图像

> ID：880515
> 
> 赞同：67
> 
> 时间：2009-05-19T00:57:46.633
> 
> 标签：c#, asp.net-mvc

我从控制器获取字节数组格式的图像，如何在视图中显示它？以最简单的方式。

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2009-05-19T01:07:59.860

创建一个用于显示图像的控制器，该控制器具有一个 Show 操作，该操作从数据库中获取要显示的图像 id。该操作应返回一个 FileResult，其中包含具有适当内容类型的图像数据。

```
public class ImageController : Controller
{
    public ActionResult Show( int id )
    {
        var imageData = ...get bytes from database...

        return File( imageData, "image/jpg" );
    }
} 
```

在您的视图中，构造图像并使用图像 id 使用控制器和操作来构造图像的路径。

```
<img src='<%= Url.Action( "show", "image", new { id = ViewData["imageID"] } ) %>' /> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-12-25T08:22:17.027

使用这个的公认答案：

```
<img src='<%= Url.Action( "show", "image", new { id = ViewData["imageID"] } ) %>' 
```

很好，但对于 mvc 4 来说已经过时了。更新后的语法现在应该是：

```
<img src='@Url.Action( "show", "image", new { id = ViewData["imageID"] })' /> 
```

此外，我发现当我需要此功能时，我已经将其他数据传递给视图，因此使用模型而不是 ViewData 非常好。

```
public class MyModel {
    public string SomeData {get;set;}
    public int FileId {get; set;}
} 
```

从您的控制器：

```
public ActionResult Index() {
    MyEntity entity = fetchEntity();

    MyModel model = new MyModel {
        SomeData = entity.Data,
        FileId = entity.SomeFile.ID
    };

    return View(model);
} 
```

最后从你的角度来看：

```
<img src='@Url.Action("show", "image", new { id = Model.FileId })' /> 
```

控制器上用于接受答案的“显示”方法将起作用，但我会将硬编码的“图像/jpg”更改为使用 File.ContentType - 您可以将其与字节 [] 一起存储，因此您无需猜测是否用户正在上传自己的图像。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-03-15T06:32:46.353

这里的每个答案都可能是正确的，但我认为最简单的方法是获取包含图像的字节数组或模型，然后像这样简单地添加

```
<img  src="data:image/jpeg;base64,@(Convert.ToBase64String(Model.Picture))"> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-08-13T23:23:14.280

我知道这篇文章相当陈旧，但它是当我试图弄清楚如何做到这一点时出现的第一个帖子，大部分情况下，Augi 的答案是正确的，但大多数程序集都已经过时了

1.  我下载 mvc2 预览 1

2.  无需担心 microsoft.web.mvc 的东西我无论如何都找不到这些东西并搜索了大约一个小时试图弄清楚它演变成什么

这是我编写的代码，适用于从图像类型的 db 字段显示图像

在我称为商店的控制器类中，我有这个

```
public ActionResult GetImage(int id)
{
    byte[] imageData = storeRepository.ReturnImage(id);

    //instead of what augi wrote using the binarystreamresult this was the closest thing i found so i am assuming that this is what it evolved into 
    return new FileStreamResult(new System.IO.MemoryStream(imageData), "image/jpeg");
}

//in my repository class where i have all the methods for accessing data i have this

public byte[] ReturnImage(int id)
{
    // i tried his way of selecting the right record and preforming the toArray method in the return statment 
    // but it kept giving me an error about converting linq.binary to byte[] tried a cast that didnt work so i came up with this
    byte[] imageData = GetProduct(id).ProductImage.ToArray();
    return imageData;
} 
```

现在对于我的视图页面，我尝试了在这些表单中找到的各种方法，但没有任何效果

```
<image src='/store/getimage/<%= Html.Encode(Model.productID) %>' alt="" /> 
```

我不断从网站上收到关于发布 img 标签的错误，因此请确保将上面的图片更改为 img

希望这有助于阻止任何人整天寻找当前答案

[http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=30886](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=30886)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-12-01T08:47:40.643

```
public ActionResult EmployeeImage(int id)
{
    byte[] imageData ="Retrieve your Byte[] data from database";
    if (imageData!= null && imageData.Length > 0)
    {
        return new FileStreamResult(new System.IO.MemoryStream(imageData), "image/jpeg");
    }
} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-19T01:08:54.070

假设您有一个包含两列“name”和“binary_image”的 dataRow (dr)（binary_image 包含二进制信息）

```
 Byte[] bytes = (Byte[])dr["Data"];
 Response.Buffer = true;
 Response.Charset = "";

 Response.Cache.SetCacheability(HttpCacheability.NoCache);
 Response.ContentType = dr["Image/JPEG"].ToString();

 Response.AddHeader("content-disposition", "attachment;filename=" & dt.Rows[0]["Name"].ToString());

 Response.BinaryWrite(bytes);
 Response.Flush();
 Response.End(); 
```

# ruby-on-rails - 为什么在连接表上有一个主键不好？

> ID：880524
> 
> 赞同：27
> 
> 时间：2009-05-19T01:02:26.437
> 
> 标签：ruby-on-rails, database, migration, primary-key, junction-table

我正在观看一个截屏视频，作者说在连接表上有一个主键不好，但没有解释原因。

示例中的连接表在 Rails 迁移中定义了两列，作者为每一列添加了索引，但没有主键。

为什么在这个例子中有一个主键不好？

```
create_table :categories_posts, :id => false do |t|
  t.column :category_id, :integer, :null => false
  t.column :post_id, :integer, :null => false
end
add_index :categories_posts, :category_id
add_index :categories_posts, :post_id 
```

编辑：正如我向 Cletus 提到的，我可以理解自动编号字段作为主键的潜在用途，即使对于连接表也是如此。但是在我上面列出的示例中，作者明确避免在“create table”语句中使用语法“:id => false”创建自动编号字段。通常，Rails 会自动将自动编号 id 字段添加到像这样在迁移中创建的表中，这将成为主键。但是对于这个join table，作者特意阻止了。我不确定他为什么决定采用这种方法。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-05-19T01:54:09.970

一些注意事项：

1.  category_id 和 post_id 的组合本身是唯一的，因此额外的 ID 列是多余和浪费的
2.  截屏视频中的短语“拥有主键不好”是不正确的。你仍然有一个主键——它只是由两列组成（例如 CREATE TABLE foo( cid, pid, PRIMARY KEY( cid, pid ) ）。对于习惯于在任何地方添加 ID 值的人来说，这可能看起来奇怪，但在关系理论中它是非常正确和自然的；截屏作者最好说“将一个名为'ID'的隐式整数属性作为主键是不好的”。
3.  拥有额外的列是多余的，因为无论如何您都会在 category_id 和 post_id 的组合上放置一个唯一索引，以确保不会插入重复的行
4.  最后，虽然常见的命名法是称它为“复合键”，但这也是多余的。关系理论中的“键”一词实际上是唯一标识行的零个或多个属性的集合，因此可以说主键是category_id，post_id
5.  将 MOST SELECTIVE 列 FIRST 放在主键声明中。对 b(+/*) 树的构建的讨论超出了这个答案的范围（对于一些较低级别的讨论，请参见：[http](http://www.akadia.com/services/ora_index_selectivity.html) ://www.akadia.com/services/ora_index_selectivity.html ）但在你的情况下，您可能希望在 post_id、category_id 上使用它，因为 post_id 在表中出现的频率会降低，从而使索引更有用。当然，由于表很小，而索引本质上是数据行，所以这不是很重要。在更广泛的情况下，表格更宽。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T01:05:43.717

DBA 会告诉您，在这种情况下，主键实际上是两个 FK 列的组合。由于 Rails/ActiveRecord 不能很好地处理复合 PK（至少默认情况下），这可能是原因。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-19T01:40:54.240

基本上是因为不需要它。两个外键字段的组合足以唯一地标识任何行。

但这仅仅说明了为什么它不是一个好主意……但为什么它会是一个坏主意？

考虑添加标识列会增加的开销。该表将占用 50% 以上的磁盘空间。更糟糕的是指数情况。使用身份字段，您必须维护身份计数以及第二个索引。您将使磁盘空间增加三倍，每次插入所需执行的工作量增加三倍。唯一的优点是 DELETE 命令中的 WHERE 子句稍短。

另一方面，如果复合键字段是整个表，那么索引可以是表。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-19T01:42:04.517

在任何表、期间（如果 DBMS 是关系 DBMS - 或 SQL DBMS）上没有主键是一个坏主意。主键是数据库完整性的关键部分。

我想如果你不介意你的数据库不准确并且经常提供不正确的答案，那么你可以不用......但大多数人都希望他们的 DBMS 提供准确的答案，对于这些人来说，主键是至关重要的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-19T01:11:31.210

外键的组合可以是一个主键（称为复合主键）。就我个人而言，我更喜欢使用技术主键而不是那个（自动编号字段、序列等）。为什么？好吧，它使识别记录变得**更加**容易，如果您要删除它，您可能需要这样做。

想一想：如果您要显示所有链接的网页，使用主键来识别记录会更容易。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-19T10:34:29.157

首先放置最有选择性的列应该只在 INDEX 声明中相关。在 KEY 声明中，它应该无关紧要（因为，正如已经正确指出的那样，KEY 是一个 SET，并且在一个集合中，顺序无关紧要 - 集合 {a1,a2} 与 {a2 ,a1})。

如果 DBMS 产品使得 KEY 声明中的属性排序产生了影响，那么该 DBMS 产品犯有没有正确区分数据库的逻辑设计（您执行 KEY 声明的部分）和物理设计数据库（执行 INDEX 声明的部分）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-19T17:43:30.690

我想评论以下评论：“说零或更多是不正确的”。

我想指出，添加此评论的文本根本不包含文本“零或更多”，因此我要评论的评论的作者是在批评其他人没有说过的话。

我还想评论说，说“零或更多”是不正确的是不正确的。当今为数不多的仍然费心研究该理论细节的人普遍知道的关系理论实际上需要没有属性的密钥的可能性。

但是当我按下“评论”按钮时，系统回复我说评论需要 50 分（或一些这样的分数）。

一个悲惨的例证，世界似乎忘记了科学不是民主，在科学中，真理不是由碰巧占多数的人决定的，也不是由碰巧拥有“足够声誉”的人决定的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-19T01:57:22.770

**单次PK的好处**

*   唯一标识具有单个值的行
*   如果需要，可以轻松地从其他地方引用**关系**
*   有些工具希望你有一个整数值 pk

**单一PK的缺点**

*   使用更多磁盘空间
*   需要 3 个索引而不是 1 个
*   如果没有唯一约束，您最终可能会为同一关系获得多行

**笔记**

*   如果要避免重复，则需要定义唯一约束
*   在我看来，如果您的表会很大，请不要使用单个 pk，否则会为了方便而牺牲一些磁盘空间。是的，这很浪费，但是在现实世界的应用程序中，谁在乎磁盘上的几 MB。

# c++ - UDP 客户端 - 发行版仅在 VS 2005 中不起作用

> ID：880528
> 
> 赞同：1
> 
> 时间：2009-05-19T01:03:04.923
> 
> 标签：c++, networking, mfc

我有一个简单的 UDP 客户端/服务器程序，它发送（服务器）一个文本字符串并接收（客户端）该文本字符串以显示在对话框上。这是一个 MFC C++ 程序，我让它在 Visual Studio 6.0、Visual Studio 2003 的调试和发布版本中都能正常工作。我试图在 Visual Studio 2005 上执行相同的代码，不幸的是，UDP 客户端似乎只能在调试模式下工作，而不是在发布模式下工作。如果我尝试在发布模式下运行 UDP 客户端可执行文件，这正是会发生的情况：当 UDP 客户端从服务器接收到一个数据包时，我的读取函数被调用，它接收到数据并且我的对话框退出，只是退出...... . 我注释掉了我的 OnOK(), OnCancel() 函数，看看它们是否在收到数据包后被调用，但不是这样。

同样，请记住，在调试和发布模式下，我在 VS 6、VS 2003 中工作的完全相同的代码，但我必须在 VS 2005 中有这个

**我已经包含了一些代码，如果有人能对可能发生的事情有所了解，我会非常感激它。**

顺便说一句，我尝试在发布模式下设置项目属性以禁用优化等，看看这是否会导致任何问题，但仍然没有运气.....

这是我的 UDP 客户端应用程序的实现文件中的内容：

```
BEGIN_MESSAGE_MAP(CUDPClientDlg, CDialog)
    ON_MESSAGE(WM_SOCKETREAD,(LRESULT(AFX_MSG_CALL CWnd::*)(WPARAM, LPARAM))readData)
END_MESSAGE_MAP()

BOOL CUDPClientDlg::OnInitDialog()
{
    // Socket Initialization

    WSADATA data;
    if (WSAStartup(MAKEWORD(2,2), &data) != 0) return(0);

    int ret;
    sock = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);
    if (!sock)
    {
        WSACleanup();
        return(0);
    }

    saServer.sin_family = AF_INET;
    saServer.sin_addr.s_addr = INADDR_ANY;
    saServer.sin_port = htons(0x1983);
    et = bind(sock, (SOCKADDR *)&saServer, sizeof(SOCKADDR));

    WSAAsyncSelect(sock, this->m_hWnd, WM_SOCKETREAD, FD_READ);
}

LRESULT  CUDPClientDlg::readData()
{
    char bufferTMP[4096];
    memset(bufferTMP, '\0', sizeof(bufferTMP));

    socklen_t fromaddrLen = sizeof(fromSockAddr); 

    recvfrom(sock, bufferTMP, sizeof(bufferTMP)-1, 0, (struct sockaddr*)   
        &fromSockAddr, &fromaddrLen);

    SetDlgItemText(IDC_EDIT1, bufferTMP);

    return 1;
}

void CUDPClientDlg::OnExit()
{
    closesocket(sock);
    WSACleanup();
    OnOK();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T08:10:06.467

您永远不需要向消息映射条目添加强制转换。

对于[`ON_MESSAGE`](http://msdn.microsoft.com/en-us/library/k35k2bfs.aspx)处理程序，函数的类型必须是`afx_msg LRESULT (CWnd::*)(WPARAM, LPARAM)`，因此您应该从以下更改您的`readData`函数：

```
LRESULT CUDPClientDlg::readData() {
    ...
} 
```

对此：

```
LRESULT CUDPClientDlg::readData(WPARAM wParam, LPARAM lParam) {
    ...
} 
```

并删除强制转换，以便消息映射条目变为：

```
ON_MESSAGE(WM_SOCKETREAD,readData) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-16T20:15:48.683

发布版本不工作也可能是由 Windows 防火墙引起的。

# python - 模块可以像对象一样具有属性吗？

> ID：880530
> 
> 赞同：116
> 
> 时间：2009-05-19T01:03:31.083
> 
> 标签：python, properties, python-module

使用 python 属性，我可以做到这一点

```
obj.y 
```

调用一个函数，而不仅仅是返回一个值。

有没有办法用模块做到这一点？我有一个我想要的案例

```
module.y 
```

调用一个函数，而不仅仅是返回存储在那里的值。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-05-19T01:09:42.430

只有新式类的实例才能具有属性。你可以让 Python 相信这样的实例是一个模块，方法是将它存储在`sys.modules[thename] = theinstance`. 因此，例如，您的 m.py 模块文件可能是：

```
import sys

class _M(object):
    def __init__(self):
        self.c = 0
    def afunction(self):
        self.c += 1
        return self.c
    y = property(afunction)

sys.modules[__name__] = _M() 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-05-19T02:40:12.230

我这样做是为了正确继承模块的所有属性，并被 isinstance() 正确识别

```
import types

class MyModule(types.ModuleType):
    @property
    def y(self):
        return 5

>>> a=MyModule("test")
>>> a
<module 'test' (built-in)>
>>> a.y
5 
```

然后你可以将它插入到 sys.modules 中：

```
sys.modules[__name__] = MyModule(__name__)  # remember to instantiate the class 
```

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2019-07-30T02:21:42.207

由于[PEP 562](https://www.python.org/dev/peps/pep-0562)已在 Python >= 3.7 中实现，现在我们可以这样做

**文件：模块.py**

```
def __getattr__(name):
    if name == 'y':
        return 3
    raise AttributeError(f"module '{__name__}' has no attribute '{name}'")

other = 4 
```

**用法：**

```
>>> import module
>>> module.y
3
>>> module.other
4
>>> module.nosuch
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "module.py", line 4, in __getattr__
    raise AttributeError(f"module '{__name__}' has no attribute '{name}'")
AttributeError: module 'module' has no attribute 'nosuch' 
```

请注意，如果您`raise AttributeError`在`__getattr__`函数中省略了 ，则表示函数以 结尾`return None`，那么`module.nosuch`将得到 的值`None`。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2019-10-23T15:58:19.067

基于[约翰林的回答](https://stackoverflow.com/a/57263518/2124834)：

```
def module_property(func):
    """Decorator to turn module functions into properties.
    Function names must be prefixed with an underscore."""
    module = sys.modules[func.__module__]

    def base_getattr(name):
        raise AttributeError(
            f"module '{module.__name__}' has no attribute '{name}'")

    old_getattr = getattr(module, '__getattr__', base_getattr)

    def new_getattr(name):
        if f'_{name}' == func.__name__:
            return func()
        else:
            return old_getattr(name)

    module.__getattr__ = new_getattr
    return func 
```

用法（注意前导下划线），在`the_module.py`：

```
@module_property
def _thing():
    return 'hello' 
```

然后：

```
import the_module

print(the_module.thing)  # prints 'hello' 
```

前导下划线是区分属性化函数和原始函数所必需的。我想不出重新分配标识符的方法，因为在装饰器执行期间，它还没有被分配。

请注意，IDE 不会知道该属性存在并且会显示红色波浪。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-01-16T17:13:19.393

一个典型的用例是：用一些（很少）动态属性来丰富一个（巨大的）现有模块——而不是将所有模块的东西变成一个类布局。不幸的是，一个最简单的模块类补丁（`sys.modules[__name__].__class__ = MyPropertyModule`如`TypeError: __class__ assignment: only for heap types`. 所以模块创建需要重新布线。

这种方法不需要 Python 导入钩子，只需在模块代码顶部添加一些序言即可：

```
# propertymodule.py
""" Module property example """

if '__orgmod__' not in globals():

    # constant prolog for having module properties / supports reload()

    print "PropertyModule stub execution", __name__
    import sys, types
    class PropertyModule(types.ModuleType):
        def __str__(self):
            return "<PropertyModule %r from %r>" % (self.__name__, self.__file__)
    modnew = PropertyModule(__name__, __doc__)
    modnew.__modclass__ = PropertyModule        
    modnew.__file__ = __file__
    modnew.__orgmod__ = sys.modules[__name__]
    sys.modules[__name__] = modnew
    exec sys._getframe().f_code in modnew.__dict__

else:

    # normal module code (usually vast) ..

    print "regular module execution"
    a = 7

    def get_dynval(module):
        return "property function returns %s in module %r" % (a * 4, module.__name__)    
    __modclass__.dynval = property(get_dynval) 
```

用法：

```
>>> import propertymodule
PropertyModule stub execution propertymodule
regular module execution
>>> propertymodule.dynval
"property function returns 28 in module 'propertymodule'"
>>> reload(propertymodule)   # AFTER EDITS
regular module execution
<module 'propertymodule' from 'propertymodule.pyc'>
>>> propertymodule.dynval
"property function returns 36 in module 'propertymodule'" 
```

注意：`from propertymodule import dynval`当然会产生冻结副本 - 对应于`dynval = someobject.dynval`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-02-07T19:57:16.517

## 简短的回答：使用`proxy_tools`

该[`proxy_tools`](https://github.com/jtushman/proxy_tools)包试图提供`@module_property`功能。

它安装有

```
pip install proxy_tools 
```

对@Marein 的示例稍作修改，`the_module.py`我们将

```
from proxy_tools import module_property

@module_property
def thing():
    print(". ", end='')  # Prints ". " on each invocation
    return 'hello' 
```

现在从另一个脚本，我可以做

```
import the_module

print(the_module.thing)
# . hello 
```

### 意外行为

该解决方案并非没有警告。即，`the_module.thing`不是**字符串**！它是一个`proxy_tools.Proxy`对象，其特殊方法已被覆盖，因此它模仿了一个字符串。以下是一些说明这一点的基本测试：

```
res = the_module.thing
# [No output!!! Evaluation doesn't occur yet.]

print(type(res))
# <class 'proxy_tools.Proxy'>

print(isinstance(res, str))
# False

print(res)
# . hello

print(res + " there")
# . hello there

print(isinstance(res + "", str))
# . True

print(res.split('e'))
# . ['h', 'llo'] 
```

在内部，原始函数存储到 `the_module.thing._Proxy__local`：

```
print(res._Proxy__local)
# <function thing at 0x7f729c3bf680> 
```

### 进一步的想法

老实说，我对为什么模块没有内置这个功能感到困惑。我认为问题的关键在于类`the_module`的一个实例`types.ModuleType`。设置“模块属性”相当于在此类的*实例*`types.ModuleType`上设置属性，而不是在类本身上。有关更多详细信息，请参阅[此答案](https://stackoverflow.com/a/1355444/10155767)。

我们实际上可以`types.ModuleType`如下实现属性，尽管结果不是很好。我们不能直接修改内置类型，但我们可以[诅咒](https://github.com/clarete/forbiddenfruit)它们：

```
# python -m pip install forbiddenfruit
from forbiddenfruit import curse
from types import ModuleType
# curse has the same signature as setattr.
curse(ModuleType, "thing2", property(lambda module: f'hi from {module.__name__}')) 
```

这给了我们一个存在于所有模块中的属性。这有点笨拙，因为我们打破了所有模块的设置行为：

```
import sys

print(sys.thing2)
# hi from sys

sys.thing2 = 5
# AttributeError: can't set attribute 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-08T08:37:51.663

基于[user2124834的回答](https://stackoverflow.com/a/58526852/15580905)：

```
import sys
class AttrGeter:
    def __new__(cls, gt):
        if isinstance(gt, cls):
            return gt
        else:
            o = super().__new__(cls)
            o.oldgetattr = gt
            o.funcmap = {}
            return o

    def __call__(self, name):
        name2 = "_" + name
        if name2 in self.funcmap:
            return self.funcmap[name2]()
        else:
            return self.oldgetattr(name)

    def add(self, func):
        self.funcmap[func.__name__] = func

def module_property(func):
    """Decorator to turn module functions into properties.
    Function names must be prefixed with an underscore."""
    module = sys.modules[func.__module__]
    def base_getattr(name):
        raise AttributeError(
            f"module '{module.__name__}' has no attribute '{name}'")
    ag = AttrGeter(getattr(module, '__getattr__', base_getattr))
    module.__getattr__ = ag
    ag.add(func)
    return func 
```

用法（注意前导下划线），在 the_module.py 中：

```
@module_property
def _thing():
    return 'hello' 
```

然后：

```
import the_module

print(the_module.thing)  # prints 'hello' 
```

我使用 a`dict`而不是嵌套`function`在原始解决方案中。当在一个模块中多次使用装饰器时，这可能会更有效。

# java - 如何在 Java 中将 .js 文件加载到 Rhino 上下文中

> ID：880533
> 
> 赞同：10
> 
> 时间：2009-05-19T01:05:19.007
> 
> 标签：java, javascript, rhino

这是我的情况：

我可以访问 Java 类中的 Rhino Context 对象。我想读入一堆 .js 文件并将它们传递给 Rhino 上下文以对其进行评估。我对让 .js 文件中的函数在脚本上下文中可用并不真正感兴趣，而只是让 .js 文件中声明的变量可用（这是一种工具验证问题）。

理想情况下，我会读入并尝试一次评估每个文件，而不是逐行评估。我注意到 Context 中有一个方法（参见[Rhino API](http://www.mozilla.org/rhino/apidocs/org/mozilla/javascript/Context.html)），称为`evaluateReader()`. 我的第一个猜测是我应该得到所有我想要加载的文件，遍历它们，然后调用这个方法，为每个文件传入某种阅读器对象，太好了，现在它们都在我的脚本上下文中。

所以，假设我在正确的轨道上，谁能告诉我在 Java 脚本上下文中使用 .js 文件是否有任何好的做法可以遵循，或者是否有更好的方法，或者你做了一些其他方式等？

不是在这里寻找实现细节，只是来自其他人的反馈，这些人可能已经在他们的一些代码中做到了这一点。使用 Java 的脚本语言对我来说是新事物。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-19T07:26:42.147

你知道[Rhino 是在 Java 6 中发布的](http://java.sun.com/javase/6/docs/technotes/guides/scripting/index.html)吗？

```
String javaScriptExpression = "sayHello(name);";
Reader javaScriptFile = new StringReader(
    "function sayHello(name) {\n"
        + "    println('Hello, '+name+'!');\n" + "}");

ScriptEngineManager factory = new ScriptEngineManager();
ScriptEngine engine = factory
    .getEngineByName("JavaScript");
ScriptContext context = engine.getContext();
context.setAttribute("name", "JavaScript",
    ScriptContext.ENGINE_SCOPE);

engine.eval(javaScriptFile);
engine.eval(javaScriptExpression); 
```

如果您想在 Java 5 中使用它，则必须单独[下载](http://www.jcp.org/en/jsr/detail?id=223)API。[您可以从scripting.dev.java.net](https://scripting.dev.java.net/)获得许多流行脚本语言的引擎。

# browser - 如何从 WebBrowser Control 控制应用程序？

> ID：880541
> 
> 赞同：4
> 
> 时间：2009-05-19T01:08:02.620
> 
> 标签：browser, webbrowser-control

我用谷歌搜索了它，但结果是空的。最糟糕的是，我知道这是可能的。

无论如何，我正在开发一个应用程序，它使用`WebBrowser`控件来显示有关对象的信息（就像 Outlook 对规则和警报对话框所做的那样）。

我的问题是如何单击`WebBrowser`Windows 窗体中执行某些功能中的超链接？

例如，假设我有一个这样的链接[，](http://stackoverflow.com)当我单击它时，我希望应用程序显示一个特定的表单，就像 Outlook 在您单击超链接时所做的那样`People and Distribution List`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-19T01:21:15.293

这看起来很有用：[如何：在 DHTML 代码和客户端应用程序代码之间实现双向通信](http://msdn.microsoft.com/en-us/library/a0746166.aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-19T01:27:34.437

ChrisW 的答案会奏效，但如果您只是依赖超链接，还有另一种方法。

在[Comicster](http://comicster.net)中，我的 WebBrowser 控件中有如下链接：

```
<a href="action:FileNew">New Collection</a> 
```

然后在 WebBrowser 的[Navigating](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.navigating.aspx)事件中，我有一些代码来检查用户是否尝试导航到“action:”链接，并拦截它：

```
private void webBrowser1_Navigating(object sender,
    WebBrowserNavigatingEventArgs e)
{
    if (e.Url.Scheme == "action")
    {
        e.Cancel = true;

        string actionName = e.Url.LocalPath;
        // do stuff when actionName == "FileNew" etc
    }
} 
```

只需一点代码，您甚至可以解析 URL 参数并将它们“传递”到主机应用程序的操作，因此我可以执行以下操作：

```
<a href="action:EditIssue?ID=1">Edit this issue</a> 
```

...这将为 ID 1 的问题打开一个属性对话框。

# objective-c - 如何动态子类化一个类并在Objective C中实例化子类？

> ID：880549
> 
> 赞同：1
> 
> 时间：2009-05-19T01:09:27.780
> 
> 标签：objective-c

我想动态子类化一个类（比如 NSString）并实例化该子类以进行测试。我如何在 Objective C 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T04:24:25.560

我怀疑你不需要做你想做的事，但如果没有更多细节，就不可能确定。由于 Objective-C 是一种后期绑定语言，因此很少需要出于测试目的进行子类化。相反，请查看[类类别](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocCategories.html#//apple_ref/doc/uid/TP30001163-CH20-SW1)或考虑重新设计，以便您可以通过类型参数`id`或符合协议的测试替身（存根、伪造或模拟）。

出于兴趣，您可以使用`objc_allocateClassPair(Class superclass, const char *name, size_t extraBytes)`来分配一个新的类。您可以使用`class_addMethod(Class cls, SEL name, IMP imp, const char *types)`和 ivars添加方法`class_addIvar(Class cls, const char *name, size_t size, uint8_t alignment, const char *types)`。最后，您应该使用`objc_registerClassPair(Class cls)`. [在Objective-C 2.0 运行时参考](http://developer.apple.com/documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)中了解更多信息。如果我有时间，我会测试一些代码并将其发布在这里。

# visual-studio - 我可以创建一个基于具有多个项目的解决方案文件的 Visual Studio 2008 入门工具包吗

> ID：880553
> 
> 赞同：0
> 
> 时间：2009-05-19T01:12:30.240
> 
> 标签：visual-studio, visual-studio-2008, starter-kits

我过去成功地创建了 Visual Studio 入门工具包，但据我所知，它们只能在项目级别制作。

我有一个包含多个项目的解决方案，我想在整个组织中为多个软件项目分发这些项目。

我想要制作的入门工具包处于解决方案级别，并且包含多个明确分开的 Visual Studio 项目（例如，单独的代码和测试项目）。

Visual Studio 2008 是否支持这一点，如果支持，它是如何完成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T01:16:46.907

我在这里找到了解决方案[http://msdn.microsoft.com/en-us/library/ms364046(VS.80).aspx#creatstrtkt_topic3](http://msdn.microsoft.com/en-us/library/ms364046(VS.80).aspx#creatstrtkt_topic3)

我没有删除它，而是认为它对其他人来说是有用的参考。

# c - 套接字接受 - “打开的文件太多”

> ID：880557
> 
> 赞同：80
> 
> 时间：2009-05-19T01:15:00.767
> 
> 标签：c, sockets

我正在做一个学校项目，我必须编写一个多线程服务器，现在我通过对其运行一些测试将它与 apache 进行比较。我正在使用 autobench 来帮助解决这个问题，但是在我运行了一些测试之后，或者如果我给它的速度太高（大约 600+）来建立连接，我得到一个“打开的文件太多”的错误。

在我处理完请求后，我总是`close()`在套接字上做一个。我也尝试过使用该`shutdown()`功能，但似乎没有任何帮助。有什么办法吗？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-05-19T01:20:57.430

Linux 可以在多个地方限制允许打开的文件描述符的数量。

您可以检查以下内容：

```
cat /proc/sys/fs/file-max 
```

这将为您提供文件描述符的系统范围限制。

在 shell 级别，这将告诉您您的个人限制：

```
ulimit -n 
```

这可以在 /etc/security/limits.conf 中更改 - 它是 nofile 参数。

但是，如果您正确关闭了套接字，则除非您打开大量同时连接，否则您不应该收到此消息。听起来好像有什么东西阻止了你的套接字被适当地关闭。我会验证它们是否得到妥善处理。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2011-12-20T22:59:42.897

我有类似的问题。快速解决方案是：

```
ulimit -n 4096 
```

解释如下——每个服务器连接都是一个文件描述符。在 CentOS、Redhat 和 Fedora，可能还有其他的，文件用户限制是 1024 - 不知道为什么。输入时很容易看到：ulimit -n

请注意，这与系统最大文件 (/proc/sys/fs/file-max) 没有太大关系。

就我而言，这是 Redis 的问题，所以我做了：

```
ulimit -n 4096
redis-server -c xxxx 
```

在您的情况下，您需要启动服务器而不是 redis。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2010-06-03T14:17:29.077

TCP 有一个称为“TIME_WAIT”的功能，可确保干净地关闭连接。它需要连接的一端在套接字关闭后保持监听一段时间。

在高性能服务器中，进入 TIME_WAIT 的是客户端，而不是服务器，这一点很重要。客户端可以负担得起开放端口，而繁忙的服务器可能会迅速耗尽端口或打开太多的 FD。

为了实现这一点，服务器永远不应该先关闭连接——它应该总是等待客户端关闭它。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2011-06-01T18:04:33.160

用于`lsof -u `whoami` | wc -l`查找用户有多少打开的文件

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-09-21T15:38:25.473

这意味着同时打开文件的最大数量。

**解决了：**

在文件末尾，`/etc/security/limits.conf`您需要添加以下行：

```
* soft nofile 16384
* hard nofile 16384 
```

在当前控制台从根（sudo 不起作用）做：

```
ulimit -n 16384 
```

虽然这是可选的，但如果可以重新启动服务器。

在`/etc/nginx/nginx.conf`文件中注册新值`worker_connections`等于`16384`除以值`worker_processes`。

如果没有`ulimit -n 16384`，需要重新启动，然后问题就会消失。

**PS：**

如果修复后在日志中可见`error accept() failed (24: Too many open files)`：

在 nginx 配置中，propevia（例如）：

```
worker_processes 2;

worker_rlimit_nofile 16384;

events {
  worker_connections 8192;
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-05-21T15:42:06.783

我也有这个问题。您有文件句柄泄漏。您可以通过打印出所有打开文件句柄的列表来调试它（在 POSIX 系统上）：

```
void showFDInfo()
{
   s32 numHandles = getdtablesize();

   for ( s32 i = 0; i < numHandles; i++ )
   {
      s32 fd_flags = fcntl( i, F_GETFD ); 
      if ( fd_flags == -1 ) continue;

      showFDInfo( i );
   }
}

void showFDInfo( s32 fd )
{
   char buf[256];

   s32 fd_flags = fcntl( fd, F_GETFD ); 
   if ( fd_flags == -1 ) return;

   s32 fl_flags = fcntl( fd, F_GETFL ); 
   if ( fl_flags == -1 ) return;

   char path[256];
   sprintf( path, "/proc/self/fd/%d", fd );

   memset( &buf[0], 0, 256 );
   ssize_t s = readlink( path, &buf[0], 256 );
   if ( s == -1 )
   {
        cerr << " (" << path << "): " << "not available";
        return;
   }
   cerr << fd << " (" << buf << "): ";

   if ( fd_flags & FD_CLOEXEC )  cerr << "cloexec ";

   // file status
   if ( fl_flags & O_APPEND   )  cerr << "append ";
   if ( fl_flags & O_NONBLOCK )  cerr << "nonblock ";

   // acc mode
   if ( fl_flags & O_RDONLY   )  cerr << "read-only ";
   if ( fl_flags & O_RDWR     )  cerr << "read-write ";
   if ( fl_flags & O_WRONLY   )  cerr << "write-only ";

   if ( fl_flags & O_DSYNC    )  cerr << "dsync ";
   if ( fl_flags & O_RSYNC    )  cerr << "rsync ";
   if ( fl_flags & O_SYNC     )  cerr << "sync ";

   struct flock fl;
   fl.l_type = F_WRLCK;
   fl.l_whence = 0;
   fl.l_start = 0;
   fl.l_len = 0;
   fcntl( fd, F_GETLK, &fl );
   if ( fl.l_type != F_UNLCK )
   {
      if ( fl.l_type == F_WRLCK )
         cerr << "write-locked";
      else
         cerr << "read-locked";
      cerr << "(pid:" << fl.l_pid << ") ";
   }
} 
```

通过转储所有打开的文件，您将快速找出文件句柄泄漏的位置。

如果您的服务器产生子进程。例如，如果这是一个 'fork' 风格的服务器，或者如果您正在生成其他进程（例如通过 cgi），您必须确保使用“cloexec”创建文件句柄 - 既适用于真实文件，也适用于套接字。

如果没有 cloexec，每次 fork 或 spawn 时，所有打开的文件句柄都会克隆到子进程中。

关闭网络套接字也很容易失败 - 例如，当远程方断开连接时就放弃它们。这会像疯了一样泄漏句柄。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-19T01:20:21.130

真正释放关闭的套接字可能需要一些时间

`lsof`列出打开的文件

`cat /proc/sys/fs/file-max`看看是否有系统限制

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-07-10T09:56:51.363

只是关于 CentOS 的另一个信息。在这种情况下，当使用“systemctl”启动进程时。您必须修改系统文件 ==> /usr/lib/systemd/system/processName.service 。文件中有这一行：

```
LimitNOFILE=50000 
```

只需重新加载您的系统配置文件：

```
systemctl daemon-reload 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-08-10T10:56:06.677

在 MacOS 上，显示限制：

```
launchctl limit maxfiles 
```

结果如下：`maxfiles 256 1000`

如果数字（软限制和硬限制）太低，您必须设置上限：

```
sudo launchctl limit maxfiles 65536 200000 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-19T01:21:23.810

当你的程序打开的描述符比打开的文件 ulimit 多时（ulimit -a 会列出这个），内核将拒绝打开更多的文件描述符。确保您没有任何文件描述符泄漏 - 例如，运行一段时间，然后停止并查看是否有任何额外的 fd 在空闲时仍然打开 - 如果仍然存在问题，请更改您的 nofile ulimit /etc/security/limits.conf 中的用户

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-05-21T12:32:23.150

我遇到了同样的问题，我没有费心检查 close() 调用的返回值。当我开始检查返回值时，问题神秘地消失了。

我只能假设编译器的优化故障（在我的例子中是 gcc），假设 close() 调用没有副作用，如果不使用它们的返回值可以省略。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-10-22T20:41:21.567

vsphere 上的 Ubuntu 18 上的类似问题。原因 - 配置文件 nginx.conf 包含太多的日志文件和套接字。套接字在 Linux 中被视为文件。当 nginx -s reload 或 sudo service nginx start/restart 时，error.log 中出现 Too many open files 错误。

NGINX 工作进程由 NGINX 用户启动。nginx 用户的 ulimit（软硬）为 65536。ulimit 和设置 limits.conf 不起作用。

nginx.conf 中的 rlimit 设置也没有帮助：worker_rlimit_nofile 65536；

**有效的解决方案是：**

```
$ mkdir -p /etc/systemd/system/nginx.service.d
$ nano /etc/systemd/system/nginx.service.d/nginx.conf
    [Service]
    LimitNOFILE=30000
$ systemctl daemon-reload
$ systemctl restart nginx.service 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-05-28T20:59:44.010

为了将来参考，我遇到了类似的问题；我通过创建太多文件和套接字（在 Unix 操作系统上，一切都是 FD）创建了太多的文件描述符 (FD)。我的解决方案是在运行时使用`setrlimit()`.

首先，我得到了 FD 限制，代码如下：

```
// This goes somewhere in your code
struct rlimit rlim;

if (getrlimit(RLIMIT_NOFILE, &rlim) == 0) {
    std::cout << "Soft limit: " << rlim.rlim_cur << std::endl;
    std::cout << "Hard limit: " << rlim.rlim_max << std::endl;
} else {
    std::cout << "Unable to get file descriptor limits" << std::endl;
} 
```

运行后`getrlimit()`，我可以确认在我的系统上，软限制是 256 个 FD，硬限制是无限 FD（这取决于您的发行版和规格）。由于我在文件和套接字之间创建了 > 300 个 FD，因此我的代码崩溃了。

就我而言，我无法减少 FD 的数量，所以我决定改为增加 FD 软限制，使用以下代码：

```
// This goes somewhere in your code
struct rlimit rlim;

rlim.rlim_cur = NEW_SOFT_LIMIT;
rlim.rlim_max = NEW_HARD_LIMIT;

if (setrlimit(RLIMIT_NOFILE, &rlim) == -1) {
    std::cout << "Unable to set file descriptor limits" << std::endl;
} 
```

请注意，您还可以使用[此代码](https://stackoverflow.com/a/8153026/1404614)获取您正在使用的 FD 的数量以及这些 FD 的来源。

您还可以在[此处](https://pubs.opengroup.org/onlinepubs/009695399/functions/getrlimit.html)`gettrlimit()`和[此处](https://www.informit.com/articles/article.aspx?p=23618&seqNum=6)找到更多信息。`setrlimit()`

# substring - 获取所有子串（拼字游戏）的字谜的所有单词列表的算法？

> ID：880559
> 
> 赞同：12
> 
> 时间：2009-05-19T01:16:41.933
> 
> 标签：substring, anagram

例如，如果输入字符串是 helloworld，我希望输出如下：

```
do
he
we
low
hell
hold
roll
well
word
hello
lower
world
... 
```

一直到最长的单词，即 helloworld 子字符串的字谜。例如在 Scrabble 中。输入字符串可以是任意长度，但很少超过 16 个字符。

我已经进行了搜索并提出了类似 trie 的结构，但我仍然不确定如何实际执行此操作。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-19T01:38:29.593

用于保存有效条目字典的结构将对效率产生巨大影响。将其组织为一棵树，根是单数零字母“单词”，即空字符串。root 的每个子节点是可能单词的单个第一个字母，这些子节点是可能单词的第二个字母，依此类推，每个节点都标记为它是否实际上构成了一个单词。

您的测试器函数将是递归的。它以零个字母开头，从有效条目树中找到“”不是一个单词但它确实有孩子，所以你递归地调用你的测试器，你的起始词（没有字母）附加你的每个可用的剩余字母输入字符串（当时所有的字符串）。检查树中的每个单字母条目，如果有效，请记下；如果是孩子，则重新调用附加每个剩余可用字母的测试器函数，依此类推。

例如，如果您的输入字符串是“helloworld”，您将首先使用“”调用递归测试器函数，将剩余的可用字母“helloworld”作为第二个参数传递。函数看到“”不是单词，但子“h”确实存在。所以它用“h”和“elloworld”来称呼自己。函数看到“h”不是一个词，但存在子“e”。所以它用“he”和“lloworld”来称呼自己。函数看到标记了“e”，所以“he”是一个单词，注意。此外，子“l”存在，因此下一个调用是“hel”和“loworld”。它接下来会找到“hell”，然后是“hello”，然后必须退出，然后可能会找到“hollow”，

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-19T07:13:19.577

我无法抗拒我自己的实现。它通过按字母顺序对所有字母进行排序，并将它们映射到可以从中创建的单词来创建字典。这是一个 O(n) 启动操作，无需查找所有排列。您可以将字典实现为另一种语言的 trie，以实现更快的加速。

“getAnagrams”命令也是一个 O(n) 操作，它在字典中搜索每个单词以查看它是否是搜索的子集。在我的笔记本电脑上执行 getAnagrams("radiotelegraphically")"（一个 20 个字母的单词）大约需要 1 秒钟，并返回 1496 个字谜。

```
# Using the 38617 word dictionary at 
# http://www.cs.umd.edu/class/fall2008/cmsc433/p5/Usr.Dict.Words.txt
# Usage: getAnagrams("helloworld")

def containsLetters(subword, word):
    wordlen = len(word)
    subwordlen = len(subword)

    if subwordlen > wordlen:
        return False

    word = list(word)
    for c in subword:
        try:
            index = word.index(c)
        except ValueError:
            return False
        word.pop(index)
    return True

def getAnagrams(word):
    output = []
    for key in mydict.iterkeys():
        if containsLetters(key, word):
            output.extend(mydict[key])

    output.sort(key=len)
    return output

f = open("dict.txt")
wordlist = f.readlines()
f.close()

mydict = {}
for word in wordlist:
    word = word.rstrip()
    temp = list(word)
    temp.sort()
    letters = ''.join(temp)

    if letters in mydict:
        mydict[letters].append(word)
    else:
        mydict[letters] = [word] 
```

运行示例：

```
>>> getAnagrams("helloworld")
>>> ['do', 'he', 'we', 're', 'oh', 'or', 'row', 'hew', 'her', 'hoe', 'woo', 'red', 'dew', 'led', 'doe', 'ode', 'low', 'owl', 'rod', 'old', 'how', 'who', 'rho', 'ore', 'roe', 'owe', 'woe', 'hero', 'wood', 'door', 'odor', 'hold', 'well', 'owed', 'dell', 'dole', 'lewd', 'weld', 'doer', 'redo', 'rode', 'howl', 'hole', 'hell', 'drew', 'word', 'roll', 'wore', 'wool','herd', 'held', 'lore', 'role', 'lord', 'doll', 'hood', 'whore', 'rowed', 'wooed', 'whorl', 'world', 'older', 'dowel', 'horde', 'droll', 'drool', 'dwell', 'holed', 'lower', 'hello', 'wooer', 'rodeo', 'whole', 'hollow', 'howler', 'rolled', 'howled', 'holder', 'hollowed'] 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-19T02:25:49.997

您想要的数据结构称为有向无[环词图 (dawg)](http://en.wikipedia.org/wiki/Directed_acyclic_word_graph)，Andrew Appel 和 Guy Jacobsen 在他们的论文“世界上最快的拼字游戏”中对其进行了描述，不幸的是他们选择不在线免费提供。ACM 会员或大学图书馆将为您提供。

我已经用至少两种语言实现了这个数据结构——它简单、易于实现，而且非常非常快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T01:50:24.780

一种简单的方法是生成所有“子字符串”，并为每个“子字符串”检查它是否是一组可接受单词的元素。例如，在 Python 2.6 中：

```
import itertools
import urllib

def words():
  f = urllib.urlopen(
    'http://www.cs.umd.edu/class/fall2008/cmsc433/p5/Usr.Dict.Words.txt')
  allwords = set(w[:-1] for w in f)
  f.close()
  return allwords

def substrings(s):
  for i in range(2, len(s)+1):
    for p in itertools.permutations(s, i):
      yield ''.join(p)

def main():
  w = words()
  print '%d words' % len(w)
  ss = set(substrings('weep'))
  print '%d substrings' % len(ss)
  good = ss & w
  print '%d good ones' % len(good)
  sgood = sorted(good, key=lambda w:(len(w), w))
  for aword in sgood:
    print aword

main() 
```

将发出：

```
38617 words
31 substrings
5 good ones
we
ewe
pew
wee
weep 
```

当然，正如其他回复所指出的那样，有目的地组织数据可以大大加快运行时间——尽管快速字谜查找器的最佳数据组织可能会有所不同……但这在很大程度上取决于字典的性质允许的字数（几万，比如这里 - 还是数百万？）。应该考虑哈希映射和“签名”（基于对每个单词中的字母进行排序），以及尝试 &c。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-19T01:26:39.697

你想要的是一个[power set](http://en.wikipedia.org/wiki/Power_set)的实现。

也看看 Eric Lipparts 的博客，他不久前在博客上写过这[件事](http://blogs.msdn.com/ericlippert/archive/2009/02/04/a-nasality-talisman-for-the-sultana-analyst.aspx)

编辑：

这是我编写的从给定字符串中获取 powerset 的实现...

```
private IEnumerable<string> GetPowerSet(string letters)
{
  char[] letterArray = letters.ToCharArray();
  for (int i = 0; i < Math.Pow(2.0, letterArray.Length); i++)
  {
    StringBuilder sb = new StringBuilder();
    for (int j = 0; j < letterArray.Length; j++)
    {
      int pos = Convert.ToInt32(Math.Pow(2.0, j));
      if ((pos & i) == pos)
      {
        sb.Append(letterArray[j]);
      }
    }
    yield return new string(sb.ToString().ToCharArray().OrderBy(c => c).ToArray());
  }
} 
```

此函数为我提供了构成传入字符串的字符的幂集，然后我可以将它们用作变位词字典的键...

```
Dictionary<string,IEnumerable<string>> 
```

我像这样创建了我的字谜词典......（可能有更有效的方法，但这很简单，而且对于拼字游戏单词列表来说足够快）

```
wordlist = (from s in fileText.Split(new string[] { Environment.NewLine }, StringSplitOptions.RemoveEmptyEntries)
                let k = new string(s.ToCharArray().OrderBy(c => c).ToArray())
                group s by k).ToDictionary(o => o.Key, sl => sl.Select(a => a)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T03:28:27.407

我相信[这个问题](https://stackoverflow.com/questions/843034/unable-to-combine-english-words-from-letters-by-ruby)的答案中的 Ruby 代码也能解决你的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-19T01:41:42.787

像[Tim J](https://stackoverflow.com/questions/880559/algorithm-to-get-a-list-of-all-words-that-are-anagrams-of-all-substrings-scrabbl/880586#880586)一样，[Eric Lippert](http://blogs.msdn.com/ericlippert/)的博客文章首先出现在我的脑海中。我想补充一点，他写了一篇关于如何提高他第一次尝试的表现的后续文章。

*   [苏丹娜分析师的鼻音护身符](http://blogs.msdn.com/ericlippert/archive/2009/02/04/a-nasality-talisman-for-the-sultana-analyst.aspx)
*   [Santalic 尾扇，第二部分](http://blogs.msdn.com/ericlippert/archive/2009/02/06/santalic-tailfans-part-two.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-26T21:25:43.790

我最近在手机上玩了很多 Wordfeud，我很好奇我是否可以想出一些代码来给我一个可能的单词列表。以下代码采用您的可用源字母（* 表示通配符）和一个包含允许单词（TWL、SOWPODS 等）主列表的数组，并生成一个匹配列表。它通过尝试从源字母构建主列表中的每个单词来做到这一点。

写完代码就找到了这个话题，肯定没有John Pirie的方法或者DAWG算法那么高效，但是还是挺快的。

```
public IList<string> Matches(string sourceLetters, string [] wordList)
{
    sourceLetters = sourceLetters.ToUpper();

    IList<string> matches = new List<string>();

    foreach (string word in wordList)
    {
        if (WordCanBeBuiltFromSourceLetters(word, sourceLetters))
            matches.Add(word);
    }

    return matches;
}

public bool WordCanBeBuiltFromSourceLetters(string targetWord, string sourceLetters)
{
    string builtWord = "";

    foreach (char letter in targetWord)
    {
        int pos = sourceLetters.IndexOf(letter);
        if (pos >= 0)
        {
            builtWord += letter;
            sourceLetters = sourceLetters.Remove(pos, 1);
            continue;
        }

        // check for wildcard
        pos = sourceLetters.IndexOf("*");
        if (pos >= 0)
        {
            builtWord += letter;
            sourceLetters = sourceLetters.Remove(pos, 1);
        }

    }

    return string.Equals(builtWord, targetWord);

} 
```

# objective-c - 在  应用程序中使用 unicode 符号或形状是不好的做法吗？

> ID：880560
> 
> 赞同：16
> 
> 时间：2009-05-19T01:16:46.237
> 
> 标签：objective-c, cocoa, macos, unicode

有几次我在我的一个 Cocoa 应用程序中使用 unicode 符号代替小图标，或者因为它更容易与文本内联绘制，或者因为我不想启动 Photoshop 来绘制一个简单的箭头. 不过，我想知道，本地化或我可能不知道的字体是否存在问题？是否存在这些符号可能与我在工作站上看到的不匹配的情况？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-19T01:48:37.017

我认为这种快捷方式没有任何问题，尤其是考虑到 Apple 对印刷质量的关注。在你的鞋子里，我会查阅[Unicode Code Charts](http://unicode.org/charts/symbols.html)，并确保我非常仔细地指定了一个编程的 unicode 字符，而不是依赖于在我的编辑器中输入它。

由于 cocoa 在内部广泛使用 unicode，并且由于大多数未指定编码的 API 方法已在 OS X 的最后几次迭代中被弃用，我认为你很安全。当您编写桌面/iphone 应用程序，而不是部署字体​​未知的 web 应用程序时，如果您坚持使用可以由作为一部分提供的已知默认字体呈现的 unicode 字符，那么从位图渲染的角度来看，您应该没问题系统的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T02:04:52.833

只要您确保它是标准系统字体中包含的符号之一并且设置为正确的字体，就不必担心任何事情。Apple 本身在 Aqua 中使用 Lucida Unicode 符号。在最终用户的计算机上可能出错的唯一方法是他的系统无论如何都被破坏了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T02:15:25.043

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T01:21:42.093

我不会那样做的。与您通常在 iPhone 或 Mac 上获得的外观和感觉不一致......

# language-agnostic - 帮助速度矢量

> ID：880569
> 
> 赞同：0
> 
> 时间：2009-05-19T01:20:41.423
> 
> 标签：language-agnostic

我有一个速度矢量是 V(233, 188)。

当原点为 V(0, 0) 时，它使对象以每秒 300 像素的速度向屏幕的右下方移动。

例如，当对象的位置为 (592, 334) 时，我将速度矢量设置为 V(294, 55) 但对象并没有开始朝那个方向移动……它一直在同一个方向移动，但是它似乎做了一个10度的小曲线......

我正在做的是：

```
objectLocation += velocity * elapsedTime; 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T23:40:02.777

从宏观上看，(233,188) 和 (294,55) 之间的区别并不大。要验证您的代码是否正常工作，请尝试使用 (200,-200) 等向量。这将导致它实际上从 y 方向上的点反弹。

如果该代码有效，那么只是您的价值观无效。

# c++ - 关于服务器套接字编程模型的问题

> ID：880570
> 
> 赞同：11
> 
> 时间：2009-05-19T01:20:41.440
> 
> 标签：c++, sockets

在过去的几个月里，我一直在研究一些用 C++ 和 Java 实现的套接字服务器。我用 Java 编写了一个小型服务器，它将处理和处理来自网站上托管的 flash 应用程序的输入，并且我成功地编写了一个服务器来处理来自 C++ 中具有多个玩家的 2D 游戏客户端的输入。我在一个项目中使用了 TCP，在另一个项目中使用了 UDP。现在，我确实有一些我在网上找不到的问题，我希望一些专家可以帮助我。:)

假设我想用 C++ 构建一个服务器来处理来自数千个独立和/或 Web 应用程序的输入，那么我应该如何设计我的服务器？到目前为止，我通常为每个连接的用户创建一个新的和独特的线程，但我怀疑这是要走的路。

此外，如何确定通过网络发送的数据包的布局？数据通常是以二进制还是文本状态通过网络发送的？当您将数据发送到不同的媒体（例如 C++ 服务器到闪存应用程序）时，您如何处理序列化对象？

最后，除了boost asio之外，是否有任何易于使用的常用库支持可移植性（例如在windows机器上开发和在linux机器上部署）。

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-19T01:54:48.830

听起来你在这里有几个问题。我会尽我所能回答我能看到的。

**1\. 我应该如何处理我的网络服务器中的线程？**

我会好好看看你在你的服务器产生的工作线程上做了什么样的工作。为每个请求生成一个新线程并不是一个好主意……但如果并行请求的数量很少并且每个线程上执行的任务运行速度很快，它可能不会造成任何伤害。

如果你真的想以正确的方式做事，你可以有一个可配置的/动态的线程池，当工作线程空闲时回收它们。这样您就可以设置最大线程池大小。然后，您的服务器将达到池大小......然后发出进一步的请求，直到有工作线程可用。

**2\. 如何格式化数据包中的数据？**

除非你正在开发一个全新的协议......这不是你真正需要担心的事情。除非您正在处理流媒体（或其他可以接受数据包丢失/损坏的应用程序），否则您可能不会为该应用程序使用 UDP。TCP/IP 可能是您最好的选择……这将决定您的数据包设计。

**3\. 我使用哪种格式进行序列化？**

您通过网络对数据进行序列化的方式取决于将使用您的服务的应用程序类型。二进制序列化通常更快，并且需要通过网络传输的数据量更少。使用二进制序列化的缺点是一种语言的二进制序列化在另一种语言中可能不起作用。因此，连接到您的服务器的客户端很可能必须用您使用的相同语言编写。

XML 序列化是另一种选择。这将需要更长的时间并且需要通过网络传输更多的数据。使用诸如 XML 序列化之类的东西的好处是，您将不受限于可以连接到您的服务器并使用您的服务的客户端类型。

您必须选择最适合您需求的产品。

...玩弄不同的选项并找出最适合您的选项。希望你能找到比我在这里提到的任何东西更快、更可靠的东西。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-19T01:55:25.833

至于服务器设计问题，我会说你是对的：虽然 ONE-THREAD-PER-SOCKET 是一种简单易行的方法，但它不是可行的方法，因为它不会像其他服务器设计模式那样扩展.

我个人喜欢 COMMUNICATION-THREADS/WORKER-THREADS 方法，其中动态数量的工作线程池处理生产者线程生成的所有工作。

在此模型中，池中有许多线程等待将要从另一组处理网络 I/O 的线程中生成的任务。

我发现了 Richard Stevens 的[UNIX Network Programming](https://rads.stackoverflow.com/amzn/click/com/0139498761)以及关于网络编程方法的此类惊人来源。而且，尽管它的名字，它在 Windows 环境中也将非常有用。

关于数据包的布局（在我看来，您应该为此发布一个不同的问题，因为这是一个完全不同的问题），在选择 TEXT 与 BINARY 方法时需要权衡。

TEXT（即 XML）可能更容易解析和记录，并且通常更简单，而 BINARY 协议应该在处理速度和网络数据包大小方面为您提供更好的性能，但您将不得不处理更复杂的问题比如ENDIANNES之类的词和东西。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-19T02:26:44.723

尽管以前的答案提供了很好的方向，但只是为了完整性，我想指出线程并不是出色的套接字服务器性能的绝对要求。[这里](http://www.acme.com/software/thttpd/benchmarks.html)有一些例子。可伸缩性也有很多方法——线程池、预分叉进程、服务器池等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T06:38:05.017

1）**最后，除了boost asio之外，是否有任何易于使用的常用库支持可移植性（例如在windows机器上开发和在linux机器上部署）。**

[ACE](http://en.wikipedia.org/wiki/Adaptive_Communication_Environment)库是另一种选择。它非常成熟（自 90 年代初就已经存在）并且被广泛部署。[Riverace](http://www.riverace.com/)网站上提供了[有关它与](http://www.riverace.com/newsletters/May2008.htm#LETTER.BLOCK7)[Boost ASIO](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_asio.html)比较的简要讨论。请记住，ACE 长期以来必须支持大量遗留平台，因此它没有像 Boost ASIO 那样充分利用现代 C++ 功能。

2)**假设我想用 C++ 构建一个服务器来处理来自数千个独立和/或 Web 应用程序的输入，那么我应该如何设计我的服务器？到目前为止，我通常为每个连接的用户创建一个新的和独特的线程，但我怀疑这是要走的路。**

有许多常用的方法，包括但不限于：*thread-per-connection*（您描述的方法）和*线程池*（Justin 描述的方法）。每个都有其优点和缺点。许多人都看过权衡取舍。一个好的起点可能是[Thread Pool Pattern](http://en.wikipedia.org/wiki/Thread_pool) Wikipedia 页面上的链接。

Dan Kegel 的“ [The C10K Problem](http://www.kegel.com/c10k.html) ”网页也有很多关于提高可伸缩性的有用说明。

3）**此外，如何确定通过网络发送的数据包的布局；数据通常是以二进制还是文本状态通过网络发送的？当您将数据发送到不同的媒体（例如 C++ 服务器到闪存应用程序）时，您如何处理序列化对象？**

我同意其他人的观点，即发送二进制数据通常是最有效的。[boost 序列化](http://www.boost.org/doc/libs/1_39_0/libs/serialization/doc/index.html)库可用于将数据编组为二进制形式（以及文本）。成熟的二进制格式包括[XDR](http://en.wikipedia.org/wiki/External_Data_Representation)和[CDR](http://en.wikipedia.org/wiki/Common_Data_Representation)。例如， CDR 是[CORBA](http://www.omg.org/cgi-bin/doc?formal/02-06-51)使用的格式。[ZeroC](http://www.zeroc.com/)公司定义了[ICE](http://www.zeroc.com/doc/Ice-3.3.1/manual/Protocol.39.6.html)编码，它应该比 CDR 更有效。

有很多二进制格式可供选择。我的建议是至少通过阅读其中一些二进制格式来避免重新发明轮子，这样您就不会最终遇到这些现有二进制格式旨在解决的相同陷阱。

也就是说，存在许多[中间件](http://en.wikipedia.org/wiki/Middleware)，它们已经为您的大部分需求提供了一个固定的解决方案。例如，[OpenSplice](http://www.opensplice.com/)和[OpenDDS](http://www.opendds.org/)都是[OMG](http://www.omg.org/) [数据分发服务](http://portals.omg.org/dds)标准的实现。DDS 侧重于数据的有效分发，例如通过[发布-订阅模型](http://en.wikipedia.org/wiki/Publish/subscribe)，而不是远程调用函数。我更熟悉 OMG 定义的技术，但我确信还有其他中间件实现可以满足您的需求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T01:55:05.910

您仍然需要一个套接字来处理每个客户端，但想法是创建一个 X 套接字池（例如 50 个），然后，当您接近（例如 90%）消耗所有这些套接字时，创建另一个X 套接字池。在某些时候，在客户端连接、发送数据和断开连接后，您的一些套接字将可供使用并且您可以使用它们（谷歌套接字池获取此信息）

数据的布局总是很困难。如果您的所有客户端和服务器都将使用相同的硬件和操作系统，您可以以二进制格式发送数据，但那里有许多行程和陷阱（字节对齐位于列表顶部）。发送格式化文本总是更容易，但在带宽和处理能力方面肯定更昂贵，因为您必须在发送之前将格式从机器更改为文本，当然，在接收器处再次返回。

回复：序列化，对不起，我无法帮助你，也无法使用库（我太嵌入了，无法使用其中的大部分）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-07T06:46:02.620

关于服务器套接字和序列化（编组）。最重要的问题是不断增长的套接字数量在 select 中处于可读可写状态。我不是关于 FD_SET 的限制。这可以简单地解决。我是关于在处理评估套接字中可用的数据时，未读取套接字中的信令时间和问题数据积累的增长。所以解决方案可能甚至超出了软件边界，需要多处理器模型，当处理器的角色有限时：一个读取和写入，N个处理。在这种情况下，当 select 返回并发送到另一个处理单元时，应该已经读取了所有可用的套接字数据。

传入数据也是如此。

关于编组。粗略的二进制格式更可取，因为性能。顺便说一下，在 UNICODE 方面的 XML 也有同样的问题。但是，...同志们，这不仅仅是将长整数或整数值复制到套接字流中。但在这种情况下，即使是 htons，htonl 也可以提供帮助（它以 NW 格式发送/接收，操作系统负责数据转换）。但是在表示头之后发送数据更安全，其中最高/最低有效位的公开格式、字节顺序和 IEEE 数据类型。这行得通，我没有一个案例。

亲切的问候和大家的巨大成功。西蒙康托尔

# objective-c - 我在哪里可以获得所有基于 NS 的类 (Cocoa) 的完整列表？

> ID：880576
> 
> 赞同：1
> 
> 时间：2009-05-19T01:21:28.223
> 
> 标签：objective-c, cocoa

我在哪里可以获得所有基于 NS 的类的完整列表？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-19T04:16:32.307

据我回忆，Foundation、AppKit 和 Core Data 框架包含所有未弃用的 NS* 类。您可以在 developer.apple.com 或使用 Apple 开发人员工具在本地安装的文档中找到[Foundation](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/ObjC_classic/index.html#//apple_ref/doc/uid/20001091)、[AppKit](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/ObjC_classic/index.html)和[Core Data的参考资料（使用 Xcode 的 Help->Documentation）。](http://developer.apple.com/documentation/Cocoa/Reference/CoreData_ObjC/index.html#//apple_ref/doc/uid/TP40001181)有关所有“Cocoa”框架的列表，请从[此处](http://developer.apple.com/referencelibrary/API_Fundamentals/Cocoa-api-date.html)开始。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T01:24:27.923

Xcode -> 帮助 -> 文档：查看 AppKit 参考和基础参考。我确信苹果的开发网站上有类似的文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T09:00:04.900

[您将在Cocoa Fundamentals Guide中找到](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CocoaFundamentals/Introduction/Introduction.html)[Foundation 类层次结构](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CocoaFundamentals/WhatIsCocoa/WhatIsCocoa.html#//apple_ref/doc/uid/TP40002974-CH3-SW40)和[Application Kit 类层次结构](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CocoaFundamentals/WhatIsCocoa/WhatIsCocoa.html#//apple_ref/doc/uid/TP40002974-CH3-SW41)（按主题分组）的概述。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T19:19:16.040

Andy Lee 编写了一个免费的应用程序，它对快速方法参考非常有用，名为 AppKiDo：

[http://homepage.mac.com/aglee/downloads/appkido.html](http://homepage.mac.com/aglee/downloads/appkido.html)

它使您可以选择在搜索结果中包含单个框架。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-12-12T11:32:33.970

如果您只想列出所有基于目标 c 的类的列表，只需打开终端运行

```
grep -Rho "@interface [a-zA-Z]\+" /Applications/Xcode.app/Contents/Developer/Platforms | cut -d" " -f2 | awk '!a[$0]++' | sort 
```

您将需要安装 Xcode。这将需要一段时间，但涵盖所有平台（macOS、tvOS、watchOS 等）。要仅针对特定平台，请相应地调整路径。因此，对于 macOS 更改：

```
/Applications/Xcode.app/Contents/Developer/Platforms 
```

到：

```
/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk 
```

或者您可以将其进一步缩小到特定框架。这也适用于协议。只需更改@protocol 的@interface。

# java - 如何在 Java 中将 int[] 转换为 Integer[]？

> ID：880581
> 
> 赞同：196
> 
> 时间：2009-05-19T01:24:22.790
> 
> 标签：java, arrays, generics, collections

我是 Java 新手，很困惑。

我有一个长度为 4 的大型数据集，`int[]`我想计算 4 个整数的每个特定组合出现的次数。这与计算文档中的词频非常相似。

我想创建一个`Map<int[], double>`在迭代列表时将每个 int[] 映射到运行计数，但 Map 不采用原始类型。

所以我做了`Map<Integer[], Double>`

我的数据存储为一个`ArrayList<int[]>`所以我的循环应该是这样的

```
ArrayList<int[]> data = ... // load a dataset`

Map<Integer[], Double> frequencies = new HashMap<Integer[], Double>();

for(int[] q : data) {

    // **DO SOMETHING TO convert q from int[] to Integer[] so I can put it in the map

    if(frequencies.containsKey(q)) {
    frequencies.put(q, tfs.get(q) + p);
    } else {
        frequencies.put(q, p);
    }
} 
```

我不确定在注释中需要什么代码才能将其转换`int[]`为`Integer[]`. 或者，也许我从根本上对正确的方法感到困惑。

* * *

## 回答 #1

> 赞同：238
> 
> 时间：2014-11-20T15:18:58.610

# 本机 Java 8（一行）

使用 Java 8，`int[]`可以`Integer[]`轻松转换为：

```
int[] data = {1,2,3,4,5,6,7,8,9,10};

// To boxed array
Integer[] what = Arrays.stream( data ).boxed().toArray( Integer[]::new );
Integer[] ever = IntStream.of( data ).boxed().toArray( Integer[]::new );

// To boxed list
List<Integer> you  = Arrays.stream( data ).boxed().collect( Collectors.toList() );
List<Integer> like = IntStream.of( data ).boxed().collect( Collectors.toList() ); 
```

正如其他人所说，`Integer[]`通常不是一个好的地图键。但就转换而言，我们现在有一个相对干净和原生的代码。

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2009-05-19T01:30:03.073

如果您想将 an 转换`int[]`为`Integer[]`， JDK 中没有自动的方法可以做到这一点。但是，您可以执行以下操作：

```
int[] oldArray;

... // Here you would assign and fill oldArray

Integer[] newArray = new Integer[oldArray.length];
int i = 0;
for (int value : oldArray) {
    newArray[i++] = Integer.valueOf(value);
} 
```

如果您有权访问[Apache 语言](http://commons.apache.org/lang/)库，则可以使用如下[`ArrayUtils.toObject(int[])`](http://commons.apache.org/lang/api-release/org/apache/commons/lang3/ArrayUtils.html#toObject(int[]))方法：

```
Integer[] newArray = ArrayUtils.toObject(oldArray); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2019-11-21T07:19:15.510

**将 int[] 转换为 Integer[]：**

```
 import java.util.Arrays;
    ...

    int[] aint = {1,2,3,4,5,6,7,8,9,10};
    Integer[] aInt = new Integer[aint.length];

    Arrays.setAll(aInt, i -> aint[i]); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-04-08T15:25:37.940

## 使用没有外部库的常规 for 循环：

**将 int[] 转换为 Integer[]：**

```
int[] primitiveArray = {1, 2, 3, 4, 5};
Integer[] objectArray = new Integer[primitiveArray.length];

for(int ctr = 0; ctr < primitiveArray.length; ctr++) {
    objectArray[ctr] = Integer.valueOf(primitiveArray[ctr]); // returns Integer value
} 
```

**将 Integer[] 转换为 int[]：**

```
Integer[] objectArray = {1, 2, 3, 4, 5};
int[] primitiveArray = new int[objectArray.length];

for(int ctr = 0; ctr < objectArray.length; ctr++) {
    primitiveArray[ctr] = objectArray[ctr].intValue(); // returns int value
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-19T01:34:38.043

大概您希望地图的键匹配元素的值而不是数组的标识。在这种情况下，您需要某种对象来定义`equals`您`hashCode`所期望的。最简单的方法是转换为 a`List<Integer>`或`ArrayList`更好地使用`Arrays.asList`。更好的是，您可以引入一个表示数据的类（类似于`java.awt.Rectangle`但我建议将变量设为私有 final，并且也将类设为 final）。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-08-12T14:08:40.657

1.  将 int[] 转换为 Integer[]

    ```
    public static Integer[] toConvertInteger(int[] ids) {

      Integer[] newArray = new Integer[ids.length];
         for (int i = 0; i < ids.length; i++) {
           newArray[i] = Integer.valueOf(ids[i]);
         }
       return newArray;
    } 
    ```

2.  将 Integer[] 转换为 int[]

    ```
    public static int[] toint(Integer[] WrapperArray) {

       int[] newArray = new int[WrapperArray.length];
          for (int i = 0; i < WrapperArray.length; i++) {
             newArray[i] = WrapperArray[i].intValue();
          }
       return newArray;
    } 
    ```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-19T01:52:10.160

我之前的回答错了。正确的解决方案是使用此类作为包装实际 int[] 的映射中的键。

```
public class IntArrayWrapper {
        int[] data;

        public IntArrayWrapper(int[] data) {
            this.data = data;
        }

        @Override
        public boolean equals(Object o) {
            if (this == o) return true;
            if (o == null || getClass() != o.getClass()) return false;

            IntArrayWrapper that = (IntArrayWrapper) o;

            if (!Arrays.equals(data, that.data)) return false;

            return true;
        }

        @Override
        public int hashCode() {
            return data != null ? Arrays.hashCode(data) : 0;
        }
    } 
```

并像这样更改您的代码：

```
 Map<IntArrayWrapper, Double > freqs = new HashMap<IntArrayWrapper, Double>();

    for (int[] data : datas) {
        IntArrayWrapper wrapper = new IntArrayWrapper(data);

        if ( freqs.containsKey(wrapper)) {
            freqs.put(wrapper, freqs.get(wrapper) + p);
        }

        freqs.put(wrapper, p);
    } 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-19T12:14:45.273

您可以使用 IntBuffer 包装现有的 int[] 而不必编写自己的代码，而无需将数据复制到 Integer 数组中

```
int[] a = {1,2,3,4};
IntBuffer b = IntBuffer.wrap(a); 
```

IntBuffer 实现了可比性，因此您可以使用您已经编写的代码。正式映射比较键，这样 a.equals(b) 用于表示两个键相等，因此数组 1,2,3 的两个 IntBuffers - 即使数组位于不同的内存位置 - 也被认为是相等的，因此将为您的频率代码工作。

```
ArrayList<int[]> data = ... // load a dataset`

Map<IntBuffer, Double> frequencies = new HashMap<IntBuffer, Double>();

for(int[] a : data) {

    IntBuffer q = IntBuffer.wrap(a);

    if(frequencies.containsKey(q)) {
        frequencies.put(q, tfs.get(q) + p);
    } else {
        frequencies.put(q, p);
    } 
```

}

希望有帮助

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-08-03T12:29:54.823

不知道为什么您需要在地图中使用 Double。就您要执行的操作而言，您有一个 int[] 并且您只想计算每个序列出现的次数？为什么这需要一个 Double 呢？

我要做的是使用适当的 .equals 和 .hashCode 方法为 int 数组创建一个包装器，以说明 int[] 对象本身不考虑这些方法的版本中的数据。

```
public class IntArrayWrapper {
    private int values[];

    public IntArrayWrapper(int[] values) {
        super();
        this.values = values;
    }

    @Override
    public int hashCode() {
        final int prime = 31;
        int result = 1;
        result = prime * result + Arrays.hashCode(values);
        return result;
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (obj == null)
            return false;
        if (getClass() != obj.getClass())
            return false;
        IntArrayWrapper other = (IntArrayWrapper) obj;
        if (!Arrays.equals(values, other.values))
            return false;
        return true;
    }

} 
```

然后使用 google guava 的 multiset，这完全是为了计算出现次数，只要您放入其中的元素类型具有正确的 .equals 和 .hashCode 方法。

```
List<int[]> list = ...;
HashMultiset<IntArrayWrapper> multiset = HashMultiset.create();
for (int values[] : list) {
    multiset.add(new IntArrayWrapper(values));
} 
```

然后，要获得任何特定组合的计数：

```
int cnt = multiset.count(new IntArrayWrapper(new int[] { 0, 1, 2, 3 })); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-06-12T13:49:52.907

这就像一个魅力！

```
int[] mInt = new int[10];
Integer[] mInteger = new Integer[mInt.length];

List<Integer> wrapper = new AbstractList<Integer>() {
    @Override
    public int size() {
        return mInt.length;
    }

    @Override
    public Integer get(int i) {
        return mInt[i];
    }
};

wrapper.toArray(mInteger); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-08-03T11:52:50.023

**更新：**虽然下面的编译，它`ArrayStoreException`在运行时抛出一个。太糟糕了。我会让它留下以供将来参考。

* * *

将`int[]`, 转换为`Integer[]`:

```
int[] old;
...
Integer[] arr = new Integer[old.length];
System.arraycopy(old, 0, arr, 0, old.length); 
```

我必须承认，考虑到它是低级的，我对它的编译感到有点惊讶`System.arraycopy`，但它确实如此。至少在java7中。

您可以同样轻松地转换其他方式。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2009-05-19T01:27:46.417

你不需要。`int[]`是一个对象，可以用作地图内的键。

```
Map<int[], Double> frequencies = new HashMap<int[], Double>(); 
```

是频率图的正确定义。

这是错误的:-)。也发布了正确的解决方案:-)。

# c# - System.Windows.Forms.ColumnHeader 可以使用与主 ImageList 不同的图像吗？

> ID：880585
> 
> 赞同：1
> 
> 时间：2009-05-19T01:26:16.360
> 
> 标签：c#, winforms, listview, imagelist, columnheader

我设置了一个 ListView 进行排序，并且效果很好。

但是，当对 ListView 进行排序时，不会提供有关当前排序列和顺序的指示。

每次排序时，我都尝试了设置 ColumnHeader.ImageKey 属性的解决方案，但我希望能够使用不是由 ListView 的 SmallImageList 指定的大小的图像。

有没有办法在*不*使用 OwnerDraw 模式的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T12:29:52.137

我认为没有 OwnerDraw 就无法做到这一点。然而，OwnerDraw 并没有你想象的那么糟糕。[CodeProject.com](http://www.codeproject.com/)上有很多例子；像[这样](http://www.codeproject.com/KB/list/ObjectListView.aspx)和[这样](http://www.codeproject.com/KB/list/aa_listview.aspx)

# asp.net - linq orderby升序？

> ID：880596
> 
> 赞同：2
> 
> 时间：2009-05-19T01:31:05.380
> 
> 标签：asp.net, linq, datatable

您好我正在使用以下内容对 tableadapter 返回的数据表的结果进行排序

```
 Dim spots = myDataTable.Where(Function(t) t.UserID = 1).OrderByDescending(Function(t) t.Title) 
```

问题是，我还需要 OrderByAscending 相同的数据表。但据我所知，它并没有将其作为一种选择。我相信有一种方法可以升序排序。谁能告诉我怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T01:34:38.947

[OrderBy](http://msdn.microsoft.com/en-us/library/bb534966.aspx)将按升序排列。

```
Dim spots = myDataTable.Where(Function(t) t.UserID = 1) _
                       .OrderBy(Function(t) t.Title ) 
```

或者，如果您需要按第二个值排序，请使用[ThenBy](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.thenby.aspx)

```
Dim spots = myDataTable.Where(Function(t) t.UserID = 1) _
                       .OrderByDescending(Function(t) t.Title ) _
                       .ThenBy(Function(t) t.OtherField ) 
```

# language-agnostic - 如何将每个单词的第一个字母大写？

> ID：880597
> 
> 赞同：3
> 
> 时间：2009-05-19T01:31:15.413
> 
> 标签：language-agnostic, scripting

我需要任何语言的脚本来将文件中每个单词的首字母大写。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-19T02:00:49.237

在 Python 中，`open('file.txt').read().title()`应该足够了。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-09-05T16:23:12.423

`sed`从命令行使用非标准（Gnu 扩展）实用程序：

```
sed -i '' -r 's/\b(.)/\U\1/g' file.txt 
```

`-i`如果您不希望它就地修改文件，请去掉“ ”。

请注意，您不应在可移植脚本中使用它

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-19T02:19:29.997

C＃：

```
string foo = "bar baz";
foo = System.Globalization.CultureInfo.CurrentCulture.TextInfo.ToTitleCase(foo);
//foo = Bar Baz 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-19T02:13:37.993

在 shell 中，使用 ruby​​，假设您的输入文件名为 FILENAME，并且它应该保留所有现有的文件格式 - 它不会像其他一些解决方案那样折叠间距：

```
cat FILENAME | ruby -n -e 'puts $_.gsub(/^[a-z]|\s+[a-z]/) { |a| a.upcase }' 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-19T02:16:35.353

斯卡拉：

```
scala> "hello world" split(" ") map(_.capitalize) mkString(" ")
res0: String = Hello World 
```

或者好吧，假设输入应该是一个文件：

```
import scala.io.Source
Source.fromFile("filename").getLines.map(_ split(" ") map(_.capitalize) mkString(" ")) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-02-15T13:47:37.607

你也可以这样做，`Ruby`在终端中使用命令行格式：

```
cat FILENAME | ruby -n -e 'puts gsub(/\b\w/, &:upcase)' 
```

或者：

```
ruby -e 'puts File.read("FILENAME").gsub(/\b\w/, &:upcase)' 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-10-22T18:02:56.013

重击：

```
$ X=(hello world)
$ echo ${X[@]^}
Hello World 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-19T01:57:56.670

执行此操作的简单 perl 脚本：（通过[http://www.go4expert.com/forums/showthread.php?t=2138](http://www.go4expert.com/forums/showthread.php?t=2138)）

```
sub ucwords {
  $str = shift;
  $str = lc($str);
  $str =~ s/\b(\w)/\u$1/g;
  return $str;
}

while (<STDIN>) {
    print ucwords $_;
} 
```

然后你用

```
perl ucfile.pl < srcfile.txt > outfile.txt 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-19T01:49:37.467

php 使用 ucwords($string) 或 ucwords('all all this will start with capitals') 来解决问题。所以你可以打开一个文件并获取数据，然后使用这个函数：

```
<?php 
$file = "test.txt"; 
$data = fopen($file, 'r');
$allData = fread($data, filesize($file));
fclose($fh);
echo ucwords($allData);
?> 
```

编辑，我的代码被切断了。对不起。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-19T01:51:17.230

这是在 PHP 中完成的。

```
$string = "I need a script in any language to capitalize the first letter of every word in a file."
$cap = ucwords($string); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-19T02:07:27.773

红宝石：

```
irb> foo = ""; "foo bar".split.each { |x| foo += x.capitalize + " " }
=> ["foo", "bar"]

irb> foo
=> "Foo Bar " 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-19T02:21:32.720

```
VB.Net:

Dim sr As System.IO.StreamReader = New System.IO.StreamReader("c:\lowercase.txt")
Dim str As String = sr.ReadToEnd()
sr.Close()
str = System.Threading.Thread.CurrentThread.CurrentCulture.TextInfo.ToTitleCase(str)
Dim sw As System.IO.StreamWriter = New System.IO.StreamWriter("c:\TitleCase.txt")
sw.Write(str)
sw.Close() 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-19T21:20:18.380

这是另一个 Ruby 解决方案，使用 Ruby 漂亮的小单行脚本助手（自动读取输入文件等）

```
ruby -ni~ -e "puts $_.gsub(/\b\w+\b/) { |word| word.capitalize }" foo.txt 
```

（假设您的文本存储在名为 的文件中`foo.txt`。）

如果您的文本包含非 ASCII 字符，则最好与 Ruby 1.9 及其出色的多语言支持一起使用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-19T02:05:12.007

在红宝石中：

```
str.gsub(/^[a-z]|\s+[a-z]/) { |a| a.upcase } 
```

hrm，实际上这更好：

```
str.each(' ') {|word| puts word.capitalize} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-19T02:11:47.110

perl:

```
$ perl -e '$foo = "foo bar"; $foo =~ s/\b(\w)/uc($1)/ge; print $foo;' 
```

富吧

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-05-25T19:36:43.777

尽管在评论[中提到](https://stackoverflow.com/questions/880597/how-can-i-capitalize-the-first-letter-of-each-word#comment687835_880597)过，但没有人发布过`awk`解决此问题的方法：

```
$ cat output.txt
this is my first sentence. and this is the second sentence. that one is the third.
$
$ awk '{for (i=0;i<=NF;i++) {sub(".", substr(toupper($i), 1,1) , $i)}} {print}' output.txt 
This Is My First Sentence. And This Is The Second Sentence. That One Is The Third. 
```

### 解释

我们遍历字段并将每个单词的第一个字母大写。如果字段分隔符不是空格，我们可以用 或其他方式定义`-F "\t"`它`-F "_"`。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-11-14T06:51:53.130

zsh解决方案

```
#!/bin/zsh
mystring="vb.net lOOKS very unsexy"
echo "${(C)mystring}"
Vb.Net Looks Very Unsexy 
```

**请注意**，它会在每个非字母字符之后进行**CAP**`VB.Net` ，请参阅.

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-12-18T14:04:13.387

Amiga 上的 AMOS Basic 的非常基本的版本——虽然只将空格视为单词分隔符。我确信使用 PEEK 和 POKE 有更好的方法，但我的记忆力已经超过 15 年了。

```
FILE$=Fsel$("*.txt")
Open In 1,FILE$
Input #1,STR$
STR$=Lower$(STR$)
L=Len($STR)
LAST$=" "
NEW$=""
For I=0 to L-1
  CUR$=MID$(STR$,I,1)
  If LAST$=" "
    NEW$=NEW$+Upper$(CUR$)
  Else
    NEW$=NEW$+$CUR$
  Endif
  LAST$=$CUR$
Next
Close 1
Print NEW$ 
```

我想念古老的 AMOS，一种很好的学习语言……虽然很丑，呵呵。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-01-05T22:18:52.873

awk 的另一种解决方案，假装更简单而不是[更短](https://stackoverflow.com/a/16753227)；）

```
$ cat > file
  thanks for all the fish
  ^D
$ awk 'function tocapital(str) {
           if(length(str) > 1)
               return toupper(substr(str, 1, 1)) substr(str,2)
           else
               return toupper(str)
       }

       {
           for (i=1;i<=NF;i++) 
               printf("%s%s", tocapital($i), OFS);
           printf ORS
       }
      ' < file
  Thanks For All The Fish 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-01-10T23:30:11.807

如果使用管道和 Python：

```
$ echo "HELLO WORLD" | python3 -c "import sys; print(sys.stdin.read().title())"
Hello World 
```

例如：

```
$ lorem | python3 -c "import sys; print(sys.stdin.read().title())"
Officia Est Omnis Quia. Nihil Et Voluptatem Dolor Blanditiis Sit Harum. Dolore Minima Suscipit Quaerat. Soluta Autem Explicabo Saepe. Recusandae Molestias Et Et Est Impedit Consequuntur. Voluptatum Architecto Enim Nostrum Ut Corrupti Nobis. 
```

您还可以使用诸如`strip()`删除空格之类的方法，或者`capitalize()`：

```
$ echo "  This iS mY USER ${USER}   " | python3 -c "import sys; print(sys.stdin.read().strip().lower().capitalize())"
This is my user jenkins 
```

# c++ - 警告：声明没有声明任何东西

> ID：880600
> 
> 赞同：-1
> 
> 时间：2009-05-19T01:31:40.933
> 
> 标签：c++, iphone, objective-c, xcode

我在 XCode 中一些运行良好的 Objective-c 代码中到处都收到了这个警告。我的 google-fu 让我失望了……其他人也遇到过这种情况，但我找不到关于究竟是什么原因导致它或如何修复它的解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T01:36:39.380

在纯 C 中，以下代码：

```
int;
typedef int; 
```

在未设置警告选项的情况下从 GCC 引发以下警告：

```
x.c:1: warning: useless keyword or type name in empty declaration
x.c:1: warning: empty declaration
x.c:2: warning: useless keyword or type name in empty declaration
x.c:2: warning: empty declaration 
```

也许你的代码中有类似的东西？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T02:33:03.510

发现问题并修复它。我有这个：

```
enum eventType { singleTouch };
enum eventType type; 
```

...并将其更改为：

```
enum eventType { singleTouch } type; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-27T18:32:00.323

我能够使用以下代码复制此错误：

```
#define MY_INT int;
MY_INT a; 
```

它编译删除';' 在#define 行中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-01T19:27:54.750

自从谷歌把我带到这里后，再添加一个到列表中：这个警告也可能在 using 声明中出现一个无关的“类型名”：

```
using SomeType = typename SomeNamespace::SomeType; 
```

SomeType 不是依赖类型。

经过一些重构以将模板类之外的“SomeType”提升到命名空间范围以节省嵌入式 C++ 环境中的内存后，我遇到了这种情况。原始实现：

```
namespace SomeNamespace {
    template <typename T>
    SomeClass
    {
    public:
        enum class SomeType
        {
            A,
            B,
        };
        ...
    };
} //namespace SomeNamespace
...
void someFunction()
{
    using SomeType = typename SomeNameSpace::SomeClass<uint8_t>::SomeType;
    //typename is required above to resolve dependent scope
    ...
} 
```

我重构了以下内容，但忘记删除 someFunction 中的“typename”：

```
namespace SomeNamespace {
    // Now elevated to namespace scope so it is clear to the compiler that it does
    //    not need to be created for every template type of the class. While most
    //    compilers may be able to figure this one out easily, mine couldn't based
    //    on the optimization settings I need to use for my embedded project.
    enum class SomeType
    {
        A,
        B,
    };

    template <typename T>
    SomeClass
    {
    public:
        ...
    };
} //namespace SomeNamespace
...
void someFunction()
{
    using SomeType = **typename** SomeNameSpace::SomeType;
    //typename is no longer needed, but its removal was missed during refactoring
    ...
} 
```

也许其他一些随机的旅行者会降落在这里，并为他们节省 15 分钟的时间来尝试理解警告在这种情况下的含义。

# iphone - 覆盖 UIView

> ID：880601
> 
> 赞同：3
> 
> 时间：2009-05-19T01:33:30.977
> 
> 标签：iphone, user-interface, uiview, transparency, overlay

为 iPhone 覆盖两层 UIView 的合适方法是什么？在按下按钮之前，底层视图应该处于活动状态，然后另一个 UIView 应该以透明的方式覆盖所有内容。我找到了模态视图控制器，但它们只是交换 UI 视图但不覆盖。

提前致谢。

克里斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-19T02:41:56.020

您应该使用`[existingView addSubview:newView];`将视图添加到现有视图。newView 将出现在现有视图之上。因此，从概念上讲，您将在现有视图上创建一个按钮，将其连接到调用如下方法的 IBAction：

```
CGRect newSize = CGRectMake(0.0f ,0.0f, 320.f, 400.0f);
UIView *newView = [[UIView alloc] initWithFrame:newSize];
[existingView addSubview:newView];
[newView release]; 
```

这将在现有视图之上放置一个新视图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-03T14:52:11.853

下面是一个简单的 3 行 ARC 兼容 UIView 的透明覆盖

```
_overlayView = [[UIView alloc] initWithFrame:[UIScreen mainScreen].bounds];
  _overlayView.backgroundColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:0.5];
    [self.view addSubview:_overlayView]; 
```

# architecture - 在设计软件平台时，构成成功的可插拔架构的关键要素是什么？

> ID：880602
> 
> 赞同：7
> 
> 时间：2009-05-19T01:34:11.380
> 
> 标签：architecture, plugins, collaboration

越来越多的软件平台让外部开发人员通过可插拔架构（插件/扩展）贡献代码，这给我留下了深刻的印象。

我一直在研究哪些平台有最好的插件社区......

**具有蓬勃发展的插件社区的优秀插件架构：**

*   用于博客的 WordPress（和 WordPress MultiUser）：[4245 个插件](http://wordpress.org/extend/plugins/)
*   bbPress 用于留言板：[165 个插件](http://bbpress.org/plugins/view/new)
*   Firefox 浏览器：[1265 个扩展](https://addons.mozilla.org/en-US/firefox/search?q=&cat=all&as=true&vfuz=true&appid=1&lver=1.0&hver=1.0&atype=1&pid=0&lup=&pp=100&sort=)
*   电子商务的 Magento：[732 个插件](http://www.magentocommerce.com/magento-connect/list)

然后是插件社区不太活跃的平台：

*   用于 wiki 的 MediaWiki：[22-38 个扩展？](http://www.mediawiki.org/wiki/Category:Extensions)

（为了集中注意力，让我们搁置或忽略支持成熟软件应用程序的平台，如 Microsoft Windows、iPhone 和 Facebook。）

与另一个拥有更小或不活跃的开发者社区的平台相比，你认为如何为软件平台提供具有大量插件的成功插件架构？

只是为了让事情开始，这里有一个部分列表：

*   该平台做了一些广泛有用的事情：让人们浏览网页、买卖东西、发布博客和留言板等。
*   该平台是开源的（或者至少，源代码是免费的）。
*   平台中的所有重要功能都可以通过钩子和过滤器完全插入。
*   所有或大多数可插入功能都有很好的文档记录（或者有一个 wiki，因此开发人员可以为您记录它）。
*   有一个论坛或电子邮件列表，开发人员可以在其中分享插件，分享技巧和窍门
*   有一个论坛或电子邮件列表，不太成熟的用户可以在其中获得安装和配置插件的帮助。

平台开发人员可以做些什么来创建一个可插拔的架构，以鼓励许多外部开发人员创建插件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T01:48:37.453

就我个人而言，我是否学习（并确实）为任何给定系统编写应用程序有 3 个主要贡献者：

该系统是否非常有用，以至于我想使用它来激发足够的动力来扩展它？

系统是否使用我熟悉的语言，或者易于学习的语言，而不是一些晦涩的或专有的或其他过于复杂的解决方案（请参阅 elisp）？

插件系统是否以清晰的语言记录得非常好，以便我可以开始编写插件的工作，而不是花费数小时（或数天）来破译系统？

如果这些都是真的，那么您不想为平台开发的唯一原因是其他人已经为您的所有想法编写了插件。:)

我认为拥有一个中央且众所周知的存储库来容纳用户贡献的插件（根据您的示例项目）也是非常有帮助/重要的。我讨厌不得不在网上搜索我正在尝试做的事情的个人、可能低质量甚至可能是恶意的附加组件。这应该是一个网站或 wiki，因为即使是论坛或邮件列表存档也可能很烦人且很耗时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T01:50:45.623

你没有抓住重点。

JVM 是一种可插拔架构。每个类文件都插入并扩展它。

Apache 是一个多层次的可插拔架构。有“模组”。一些模组运行其他解释器，它们本身就是可插拔的架构。PHP、mod_wsgi/Python 等都插入 Apache。

Python 是一种可插入的体系结构，其中包含 Python .pyc 文件和插入其中的目标文件（.DLL、.SO）。

每个语言框架实际上都是一个可插拔的架构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T02:03:51.430

**平台是基础**

软件平台的一种观点是作为其他软件执行另一项任务所依赖的基础。这可能是一个简单且相当明显的声明，但它是一个重要的声明。

**基础应该很简单**

平台必须有一个目的，并且平台开发人员在设计 API 时应该意识到这一点，以便清楚主要用例是什么，并且围绕它们的 API 应该尽可能直接地使用，以适应它们的设计方式但也关于他们周围的文档。

**扩展点应该很明显**

平台的可扩展性是为开发人员提供扩展或更改平台的机会。如果这是您想要鼓励的，那么您需要非常清楚这种可扩展性的性质和限制，并提供一组定义良好的接口来实现这一点。

这听起来似乎很明显，但是如果您希望社区围绕一个平台开发，那么该平台必须有用途，并且扩展它应该是一种直接的体验。

抱歉，如果这个接缝有点“建筑宇航员”，我确实认为我提出了一些有效的观点，我可能做得很糟糕，请随时指出这一点或添加它们

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-07T13:06:51.953

不要忘记[Eclipse](http://eclipse.org)（有[超过 1000 个注册的第 3 方“插件”](http://marketplace.eclipse.org/)（实际上它们是由 Eclipse 术语中更小的插件组成的））。它的成功部分可能来自于如何设计一个也可以被其他人扩展的插件有很好的经验法则。还有一个严格的 API 版本控制政策（当然也有它的缺点）。

# c++ - 在嵌入式环境中使用 C++

> ID：880603
> 
> 赞同：7
> 
> 时间：2009-05-19T01:34:14.267
> 
> 标签：c++, embedded

今天我与一位同事进行了一次非常有趣的对话，其中一个主题让我在今晚思考和搜索。在嵌入式环境中使用 C++（相对于 C）。环顾四周，似乎有一些与 C++ 提供的特性相反的好[交易](http://www.informit.com/articles/article.aspx?p=101167)，但其他[Meyers](http://www.aristeia.com/c++-in-embedded.html)显然支持它。所以，我想知道谁能对这个话题有所了解，以及社区的普遍共识是什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T01:56:49.153

嵌入式开发人员对 C++ 的恐惧在很大程度上已成为过去，当时 C++ 编译器不如 C 编译器好（优化和代码质量方面）。

这尤其适用于具有 32 位架构的现代平台。但是，对于更受限的环境，C 肯定仍然是首选（8 位或 4 位目标的汇编程序也是如此）。

因此，它实际上归结为您的目标平台提供的资源，以及您可能实际需要多少这些资源，即您是否能够负担得起在 C++（甚至 Java 中进行嵌入式开发）的“奢侈品”） ，因为您知道在内存或 CPU 限制方面几乎不会有任何问题。

如今，许多现代嵌入式平台（想想游戏机、手机、PDA 等）已经真正成为非常有能力的目标，它们具有 RISC 架构、几 MB 的 RAM 和 3D 硬件加速。

出于不知情的性能考虑，仅使用 C 甚至汇编程序对此类平台进行编程将是一个糟糕的决定，另一方面，在 C++ 中编写 16 位 PIC 也可能是一个有争议的决定。

所以，这实际上是一个问自己，为了改善开发体验（高级语言、更快的开发、更少繁琐/冗余的任务），您实际需要多少功能以及可以牺牲多少功能.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-19T04:06:47.743

用于嵌入式平台的 C++ 非常好 - 只要您将其视为更好的 C。我喜欢该语言稍微结构化的事实。你仍然可以用 C 做所有你想做的事情。只要记住坚持使用像 Newlib 或 uClibc 这样的嵌入式 C 库。

我特别喜欢我们可以使用 C++ 构建的抽象，特别是对于 I/O 设备。所以，我们可以有一个用于 UART 的类和一个用于 GPIO 的类等等。它比拥有一堆功能（恕我直言）更干净。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-19T01:52:06.133

这在某种程度上取决于您的嵌入式系统的特定性质以及您使用的 C++ 的哪些功能。该语言本身不一定会生成比 C 更大的代码。

例如，如果内存是您最严格的约束，您可以像“C with classes”一样使用 C++——也就是说，只使用直接成员函数，禁用 RTTI，并且没有任何虚拟函数或模板。这将适合与等效 C 代码几乎相同的空间，因为您没有类型信息、vtable 或冗余函数来使事情变得混乱。

我发现当内存非常紧张时，模板是最需要避免的事情，因为你会为每个模板函数的每个专门处理的类型获取一个副本，这会迅速膨胀代码段。

在控制台视频游戏行业（这是嵌入式世界的强项）C++ 是王者。我们的限制是对内存（当前一代为 512mb）和实时性能的硬限制。通常使用虚函数和模板，但不例外，因为它们使堆栈膨胀并且性能成本太高。事实上，一家主要制造商的编译器甚至根本不支持异常。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T03:26:04.540

在我以前的公司中，由于安全性 (SIL-2) 和内存原因，所有嵌入式代码都是用一小部分 C 代码编写的。通过在特定场景中引入更丰富的语言（如 C++）可能会带来更多的麻烦而不是好处。

在所有应有的尊重 C++（这是我真正喜欢的语言），但我认为 C - 在我们的特定场景中 - 是更好的选择。

我敢打赌，在某些情况下，C++ 可以很好地用于嵌入式应用程序，但它确实取决于应用程序——如果您的程序是控制核电站或管理手机上的通讯录，则会有所不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T01:47:54.740

我不知道“普遍共识”，只知道我工作的公司（对手机、汽车导航系统、DPF 等进行了大量开发）。

我在嵌入式平台上使用 C++ 而不是 C 时遇到的主要缺点是它的可移植性不太好——还有更多编译器不符合标准的情况，如果你需要的话，可能会导致问题使用超过 1 个编译器构建您的代码，或者在实现中完全存在错误。然后是 C++ 代码根本无法运行的环境 - BREW 的可重定位代码问题及其“本机 OOP”在“常规”C++ 类和继承方面表现不佳。

不过，最后，如果您只针对 1 个平台，我会说使用您认为“更好”（更快、更少错误、更好的设计）的任何东西来进行开发 - 在大多数情况下，这些问题都可以很好地解决容易地。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-19T01:53:55.477

取决于你在做什么样的嵌入式开发。我已经在各种平台上使用 C++、C 和 Assembly 进行过嵌入式开发，您甚至可以使用 Java 在智能手机上编写应用程序。

例如，在运行 Windows CE 5 的智能手机等设备上，几乎所有代码都是 C++，包括在操作系统中。只有一小部分是用 C 或汇编编写的。

另一方面，我已经为 MSP430 微控制器编写了 C 代码，如果编译器更可靠且符合标准，我可能会在 C++ 中这样做。

我似乎还记得我的一位大学讲师谈到在 Forth 或其他东西中编写嵌入式代码。所以真的任何语言都可以。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-19T03:37:40.723

现在有一天，一切都将归结为平台的 C++ 运行时支持。您可能会找到一种使用 GCC 将 C++ 代码编译到几乎任何嵌入式平台的方法，但是如果您找不到适合该平台的 C++ 运行时，您的努力将是徒劳的，除非您编写自己的 C++ 运行时。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-19T12:22:40.653

我倾向于同意 Linus 的少数几件事之一是他对 C++ 的看法[http://thread.gmane.org/gmane.comp.version-control.git/57643/focus=57918](http://thread.gmane.org/gmane.comp.version-control.git/57643/focus=57918)

除此之外，如果你真的想使用 C++，你可能想看看描述嵌入式 C++ 的[http://www.caravan.net/ec2plus/](http://www.caravan.net/ec2plus/)，或者更好地说你不应该在嵌入式系统中使用 C++。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-19T12:27:44.903

让我们长期使用 C++ 的最大原因是 VxWorks 对它的支持，这真的很糟糕。据说这在 VxWorks 6 上变得更好了（是的，已经有一段时间了……良好的 'ole 供应商锁定和缺乏公司远见使我们停留在 VxWorks 5.5 上）。

所以对我们来说，这主要是环境问题。在那之后，C++ 显然可以和 C 一样好......这是人们理解他们的工具做什么以及如何使用它的问题。C++ 可能使编写效率极低的代码变得更容易，但这并不意味着我们必须屈服于它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-02T19:19:56.297

我目前正在解决嵌入式 Linux 应用程序中的异常问题。我们正在尝试移植为似乎很好地支持异常的不同平台编写的软件，但是新的编译器工具（gcc 的移植）在创建 eh_frame 时会报告错误。我反对为这个工具使用异常，但开发人员向我保证现代编译器会很好地支持它。

我的观点是 C++ 有一些优势，但我会远离异常和标准模板库。我们在使用虚函数时没有遇到问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-10-23T05:15:42.487

C++ 适用于没有操作系统的微控制器和设备。您只需要了解系统的架构并注意时间和空间限制，尤其是在执行关键任务编程时。

使用 C++，您可以进行抽象，这通常会导致代码占用量增加。在为资源有限的机器（例如 8 位 MCU）进行编程时，您不希望这样做。

一般来说，避免：

*   动态内存分配，因为它代表时间的不确定性
*   重载
*   RTTI 因为内存开销大
*   由于执行速度降低而导致的异常

对虚函数要谨慎，因为它们的资源成本是每个类一个 vtable 和一个指向每个对象的 vtable 指针。此外，使用 const 代替 #define。

随着您升级到 16 位和 32 位 MCU，以及 10 或 100 MB RAM，可能会使用上述更重的功能。

因此，总而言之，C++ 对于嵌入式系统很有用。一个主要的好处是，当您想要抽象微控制器的各个方面（例如 UART 或状态机）时，OOP 会很有用。但是您可能希望始终避免某些功能，并且有时要避免某些功能，具体取决于您正在编程的目标。

# javascript - dblclick 事件触发时防止触发 click 事件

> ID：880608
> 
> 赞同：47
> 
> 时间：2009-05-19T01:37:27.787
> 
> 标签：javascript, dom-events

我正在处理 DOM 元素上的 click 和 dblclick 事件。每个执行不同的命令，但我发现双击元素时，除了触发双击事件外，还触发了两次单击事件。防止这种行为的最佳方法是什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2015-05-01T18:49:29.203

万一其他人偶然发现这个（就像我一样）寻找答案，我能想出的绝对最佳解决方案如下：

```
 $node.on('click',function(e){
      if(e.originalEvent.detail > 1){
         return;
        /* if you are returning a value from this
         function then return false or cancel 
         the event some other way */
      }
    }); 
```

完毕。如果背靠背点击不止一次，第二次，第三次等。不会开火。我绝对更喜欢使用任何类型的计时器。

[通过阅读这篇](http://www.simonbattersby.com/blog/2010/10/preventing-doubleclick-firing-two-clicks-with-jquery/)文章，我让自己指向了这个方向。

* * *

*顺便说一句：我第一次研究这个问题是因为我不小心双击了一个分页链接，事件触发并在回调发生之前完成了两次。*

*在想出上面的代码之前，我有*

```
 if e.originalEvent.detail === 2 //return 
```

*但是，我能够点击链接 3 次（三次点击），虽然第二次点击没有触发，但第三次点击了*

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-19T03:08:56.230

你在评论中说，

> 我将点击处理程序延迟了 300 毫秒（一个明显且令人讨厌的延迟），甚至......

因此，听起来您想要的是，当您单击时，DOM 应该立即生成一个单击事件，除非单击是双击的第一次单击。

要实现此功能，当您单击时，DOM 需要能够预测这是最终单击还是第一次双击（但我认为 DOM 通常无法预测用户是否要再次点击）。

* * *

您尝试在单击和双击时采取的两种不同的操作是什么？IMO，在一个正常的应用程序中，您可能需要这两个事件：例如单击以关注一个元素，然后双击以激活它。

当您必须分离事件时，某些应用程序会使用双击以外的方式：例如，它们使用右键单击或控制单击。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2018-03-24T14:22:49.383

[`UIEvent.detail`](https://developer.mozilla.org/en-US/docs/Web/API/UIEvent/detail)如果您想检测元素被点击的次数并基于此触发事件，您可以使用。

一个简单的例子：

```
element.addEventListener("click", function (e) {
  if (e.detail === 1) {
    // do something if the element was clicked once.
  } else if (e.detail === 2) {
    // do something else if the element was clicked twice
  }
}); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-19T01:40:59.713

在这种情况下，最好稍微延迟单击事件的执行。让您的双击处理程序设置一个单击事件将检查的变量。如果该变量具有特定值，可能是`boolDoubleClick == true`，则不要`fire/handle`单击。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-15T20:04:04.433

感谢这里的所有其他答案，因为当交互需要两者但相互排斥时，它们的组合似乎为我提供了一个合理的解决方案：

```
var pendingClick = 0;

function xorClick(e) {
    // kill any pending single clicks
    if (pendingClick) {
        clearTimeout(pendingClick);
        pendingClick = 0;
    }

    switch (e.detail) {
        case 1:
            pendingClick = setTimeout(function() {
                console.log('single click action here');
            }, 500);// should match OS multi-click speed
            break;
        case 2:
            console.log('double click action here');
            break;
        default:
            console.log('higher multi-click actions can be added as needed');
            break;
    }
}

myElem.addEventListener('click', xorClick, false); 
```

**更新：**我在这个 Github 存储库中添加了这种方法的通用版本以及用于触摸设备的 click polyfill，并附有示例：

[https://github.com/mckamey/doubleTap.js](https://github.com/mckamey/doubleTap.js)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-29T10:56:50.750

AFAIK DOM Level 2 Events 没有指定双击。它在 IE7 上对我不起作用（令人震惊），但 FF 和 Opera 管理规范没有问题，我可以将所有操作附加到点击事件，但双击只需等到“详细信息”属性事件对象的值为 2。来自文档：“如果在同一屏幕位置发生多次点击，则序列重复，详细属性随着每次重复而递增。”

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-02-14T14:20:57.467

这是我在模块中所做的区分

```
 node.on('click', function(e) {

            //Prepare for double click, continue to clickHandler doesn't come soon enough
            console.log("cleared timeout in click",_this.clickTimeout);
            clearTimeout(_this.clickTimeout);
            _this.clickTimeout = setTimeout(function(){
                console.log("handling click");
                _this.onClick(e);
            },200);
            console.log(_this.clickTimeout);
        });

        node.on('dblclick', function (e) {

            console.log("cleared timeout in dblclick",_this.clickTimeout);
            clearTimeout(_this.clickTimeout);
            // Rest of the handler function 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-05-17T23:03:20.213

如果我有 dblclick 事件应该做不同的事情，我会在我的项目中使用这个解决方案来防止点击事件动作。

**注意：此解决方案仅适用于 click 和 dblclick，而不适用于 Tripleclick 等任何其他内容。**

要查看单击和双击之间的适当时间，请参阅[此](https://stackoverflow.com/questions/29917287/what-is-the-max-delay-between-two-clicks-to-trigger-a-double-click-event)

对不起，我的英语不好。我希望它有帮助:)

```
var button, isDblclick, timeoutTiming;
var clickTimeout, dblclickTimeout;
//-----
button = $('#button');
isDblclick = false;
/*
the proper time between click and dblclick is not standardized,
and is cutsomizable by user apparently (but this is windows standard I guess!)
*/
timeoutTiming = 500;
//-----
button.on('dblclick', function () {

  isDblclick = true;
  clearTimeout(dblclickTimeout);
  dblclickTimeout = setTimeout(function () {
    isDblclick = false;
  }, timeoutTiming);
  //-----
  // here goes your dblclick codes
  console.log('double clicked! not click.');

}).on('click', function () {

  clearTimeout(clickTimeout);
  clickTimeout = setTimeout(function () {
    if(!isDblclick) {
      // here goes your click codes
      console.log('a simple click.');
    }
  }, timeoutTiming);

});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<button type="button" id="button">
click/dblclick on this to see the result
</button>
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-05-05T08:45:36.603

您可以使用 debounce 将单击处理程序从检测双击/多次单击中释放出来

测试：[https ://jsfiddle.net/L3sajybp/](https://jsfiddle.net/L3sajybp/)

HTML

```
<div id='toDetect'>
Click or double-click me
</div>
<hr/>

<ol id='info'>
</ol> 
```

JS

```
function debounce(func, wait, immediate) {
    let timeout;
    return function () {
        const context = this,
            args = arguments;
        const later = function () {
            timeout = null;
            if (!immediate) func.apply(context, args);
        };
        const callNow = immediate && !timeout;
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
        if (callNow) func.apply(context, args);
    };
}

function debounceSingleClickOnly(func, timeout = 500) {
   function eventHandler (event) {
        const { detail } = event;
      if (detail > 1) {
         console.log('no double click for you '+ func.name);
         console.log('');
         return;
      }

      func.apply(this, arguments);
   }

   return debounce(eventHandler, timeout); 
}

window.toDetect.addEventListener('click', debounceSingleClickOnly(handleSingleClick));

window.toDetect.addEventListener('dblclick', handleDoubleClick);

function handleS() {
    console.log('S func');
  console.log(this.id);
}

function handleSingleClick(event) { 
   console.log('single click');
   const divText = document.createElement('li');
   divText.appendChild(document.createTextNode('single click'));
   window.info.appendChild(divText)

   console.group();
   console.log('this element was single-clicked: ' + event.target.id);   
   console.log(this.id);  
     console.log('');   
   console.groupEnd();
}

function handleDoubleClick(event) {
   console.log('double click');
   const divText = document.createElement('li');
   divText.appendChild(document.createTextNode('double click'));
   window.info.appendChild(divText);

     console.group();  
   console.log('this element was double-clicked: ' + event.target.id);
   console.log(this.id);  
     console.log('');
   console.groupEnd();
 } 
```

输出：[![在此处输入图像描述](https://i.stack.imgur.com/N4amZ.png)](https://i.stack.imgur.com/N4amZ.png)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-11-21T19:02:29.843

我知道这已经很老了，但我想无论如何我都会发布，因为我遇到了同样的问题。这是我解决它的方法。

```
 $('#alerts-display, #object-display').on('click', ['.item-data-summary', '.item-marker'], function(e) {
    e.preventDefault();

    var id;

    id = setTimeout(() => {
       // code to run here
       return false;
    }, 150);

    timeoutIDForDoubleClick.push(id);
});

$('.panel-items-set-marker-view').on('dblclick', ['.summary', '.marker'], function(e) {
    for (let i = 0; i < timeoutIDForDoubleClick.length; i++) {
       clearTimeout(timeoutIDForDoubleClick[i]);
    }

    // code to run on double click

    e.preventDefault();
}); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-06-11T10:04:14.890

这是我防止第二次点击的简单解决方案。当然，我可以在检测到双击时重新启动超时，但实际上我从来不需要它。

```
clickTimeoutId = null;

onClick(e) {
    if (clickTimeoutId !== null) {
        // Double click, do nothing
        return;
    }

    // Single click
    // TODO smth

    clickTimeoutId = setTimeout(() => {
        clearTimeout(clickTimeoutId);
        clickTimeoutId = null;
    }, 300);
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-11-15T13:06:42.423

总而言之，要识别同一元素上的 simpleClick 和 doubleClick 事件，只需使用此方法处理 onClick 事件：

```
var EVENT_DOUBLE_CLICK_DELAY = 220; // Adjust max delay btw two clicks (ms)
var eventClickPending = 0;

function onClick(e){
    if ((e.detail == 2 ) && (eventClickPending!= 0)) {
//       console.log('double click action here ' + e.detail);
         clearTimeout(eventClickPending);
         eventClickPending = 0;
         // call your double click method
         fncEventDblclick(e);

    } else if ((e.detail === 1 ) && (eventClickPending== 0)){   
//      console.log('sigle click action here 1');
        eventClickPending= setTimeout(function() {
//          console.log('Executing sigle click');
            eventClickPending = 0
            // call your single click method
            fncEventClick(e);
        }, EVENT_DOUBLE_CLICK_DELAY);

//    } else { // do nothing
//      console.log('more than two clicks action here ' + e.detail);

    }
} 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2019-05-28T17:27:23.717

```
 const toggle = () => {
      watchDouble += 1;
      setTimeout(()=>{
        if (watchDouble === 2) {
          console.log('double' + watchDouble)
        } else if (watchDouble === 1) {
          console.log("signle" + watchDouble)
        }
        watchDouble = 0
      },200);

  } 
```

# c# - 如何在 Visual Studio 单元测试中使用包含私有类型的泛型

> ID：880609
> 
> 赞同：1
> 
> 时间：2009-05-19T01:37:29.550
> 
> 标签：c#, unit-testing, generics

我正在尝试测试的课程有问题。我已经声明了一个私有枚举，并且我在代码的通用字典中使用它。此枚举在此类之外没有任何意义，但它用于私有方法。当我生成代码时，访问器被写入通用字典类型，但是当我尝试使用测试时抛出一个无效的强制转换异常。

```
MyClass_Accessor target = new MyClass_Accessor();
Dictionary<MyClass_Accessor.MyEnum, long> dictionary = new Dictionary<MyClass_Accessor.MyEnum, long>();
dictionary.Add(MyClass_Accessor.Myenum.EnumValue, 1);
target.Method(dictionary); //Throws invalid cast exception here. 
```

例外的是accessor => enum, long的泛型字典不能转换为Myclass => enum, long。

*除了改变我的工人阶级之外*，有没有办法可以测试这种方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T02:04:41.283

您可以使用 InternalsVisibleTo 程序集属性，并将您的私有更改为内部。（如果您不能将私有枚举更改为内部枚举，那么这将不起作用，但通常这是一个可以接受的权衡。）

假设您有一个名为 AssemblyA 的程序集正在由 AssemblyATest 进行单元测试，并且由 AssemblyAIntegTest 进行集成测试，您可以在您的 AssemblyInfo.cs 文件中粘贴以下内容：

```
using System.Runtime.CompilerServices;

// ...

[assembly: InternalsVisibleTo("AssemblyATest")]
[assembly: InternalsVisibleTo("AssemblyAIntegTest")] 
```

如果您签署您的主要程序集，您还需要签署您的测试程序集，并提供完全限定、文化和主键的程序集名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T01:58:03.393

我不得不承认这个问题对我来说并不清楚。但看起来您需要通过公共调用者测试您的私有方法。

在大多数情况下，当您进行 TDD 时，您会创建一个公共方法来满足您的测试，然后在需要时在私有测试中对其进行重构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T06:20:13.953

我承认我没有像您那样调用也具有私有定义的私有函数，但是查看您的代码，您似乎没有从字典对象中选择有效值。

代码不应该是这样的吗？

```
target.Method(dictionary[0]); 
```

好的，在你下面的评论之后。

以下代码取自使用类（PaDeviceManager）的私有方法进行的测试，它可以适应您的要求吗？

```
PaDeviceManager paDeviceManager = PaDeviceManager.Create;
PrivateObject param0 = new PrivateObject(paDeviceManager);
PaDeviceManager_Accessor target = new PaDeviceManager_Accessor(param0);
PaDeviceManager_Accessor(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T03:36:50.530

我很乐意承认，在您的情况下，这是您可能需要执行的一项测试，在这种情况下，jrista 的答案就是要遵循的答案 (InternalsVisibleTo)。

但是，在进行单元测试时，我认为您通常不应该测试类的非公共 API。如果这个枚举是类私有的，因此只在类内部使用，那么它也不应该出现在任何单元测试中。

单元测试的目的是确定您的类的公共（包括虚拟/抽象保护）API 按预期执行。通过包含依赖于诸如此私有枚举之类的实现细节的测试，您基本上无法在将来更改实现（例如更改为可能不需要枚举的实现）。

# math - 你有更好的想法来模拟硬币翻转吗？

> ID：880623
> 
> 赞同：1
> 
> 时间：2009-05-19T01:45:45.930
> 
> 标签：math, random, coin-flipping

现在我有

```
return 'Heads' if Math.random() < 0.5 
```

有一个更好的方法吗？

谢谢

编辑：请忽略返回值，“更好”表示准确的 50-50 概率。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-19T01:52:55.057

总是有死的简单

硬币=兰特（1）；

在许多脚本语言中，这会给你一个介于 0 和你的 arg 之间的随机整数，所以传递 1 会给你 0 或 1（正面或反面）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-19T03:52:25.103

[C 语言中的数值配方](http://www.nrbook.com/a/bookcpdf/c7-1.pdf)表示在重要的时候不要相信内置的随机数生成器。您可能可以将书中所示的算法实现为函数ran1()，它声称通过所有已知的随机性统计测试（1992 年）不到大约10 ⁸次调用。

ran1() 算法背后的基本思想是在随机数生成器的输出中添加一个 shuffle 以减少低阶序列相关性。他们使用计算机编程艺术第 2 卷第 3.2-3.3 节中的 Bays-Durham shuffle，但我猜您也可以使用[Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)。

如果您需要比这更多的随机值，同一个文档还提供了一个生成器 (ran2)，它应该适用于至少 10 ^(17 个)值（我的猜测基于 2.3 x 10 ^(18)的周期）。还提供了一个函数 (ran3)，它使用不同的方法来生成随机数，如果线性同余生成器会给您带来某种问题。

您可以将这些函数中的任何一个与 < 0.5 测试一起使用，以更有信心获得均匀分布。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-19T04:48:13.007

向 xkcd 致敬：

```
string getHeadsOrTails {
        return "heads"; //chosen by fair coin toss,
                        //guaranteed to be random
    } 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-19T02:14:45.963

你所拥有的就是我会做的事情。如果 0.0 <= Math.random() < 1.0，这是标准的，那么 (Math.random() < 0.5) 当 Math.random() 在 0.0 和 0.4999 之间时会给你正面...它在 0.5 和 0.999 之间......这是你能得到的最公平的硬币翻转。

当然，我假设 Math.random() 的实现很好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-19T05:07:16.090

在 linux 系统上，您可以从 /dev/random 读取位以获取“更好”的随机数据，但是像 Math.Random() 这样几乎随机的方法对于您能想到的几乎所有应用程序来说都很好，没有严重的密码学工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T04:09:19.980

我不能对人们的帖子发表评论，因为我没有声誉，而只是关于整个 <= vs. < 比尔蜥蜴评论中提到的主题的仅供参考：因为可以有效地假设随机生成之间的任何数字0-1（由于浮点数大小的限制，这在技术上不是这种情况，但在实践中或多或少是正确的） num <= .5 或 num < .5 不会有差异因为在任何连续范围内获得任何一个特定数字的概率都是 0。即：当 X = 0 和 1 之间的随机变量时，P(X=.5) = 0。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-19T01:54:48.627

尝试区分奇数和偶数。此外，返回枚举值（或布尔值），而不是字符串。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-19T23:28:36.530

这个问题的唯一真正答案是你不能“保证”概率。如果你想一想，真正的硬币翻转并不能保证 50/50 的概率，这取决于硬币、翻转它的人，以及硬币是否掉落并在地板上滚动。;)

关键是它“足够随机”。如果您正在模拟硬币翻转，那么您发布的代码就更好了。

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2009-05-19T01:47:56.767

尝试

```
return 'Heads' if Math.random() * 100 mod 2 = 0 
```

我真的不知道您使用的是什么语言，但如果随机数可被 2 整除，那么它就是正面，如果不是，那么它就是反面。

# emacs - 停止在 emacs 启动时运行的 tramp-mode

> ID：880625
> 
> 赞同：11
> 
> 时间：2009-05-19T01:46:35.303
> 
> 标签：emacs, tramp

我正在尝试[tramp-mode](http://www.emacswiki.org/emacs/TrampMode)，但现在我似乎无法摆脱它。每当我启动 emacs 时，它都会花费大约 20 秒来完成各种与 tramp 相关的初始化..

```
tramp: Waiting 60s for prompt from remote shell
tramp: Setting up remote shell environment 
```

..等等。

我到底要如何卸载流浪汉？`~/.emacs.d`除了插件本身（似乎没有在任何地方加载..）之外，我没有发现任何东西

我已经清除了最近的文件历史记录，但这没有任何区别..

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-19T14:08:25.853

啊哈，我找到了正在装载流浪汉的地方：

```
Loading /Users/dbr/.recentf...done
Loading tramp-mode.. 
```

我的`~/.recentf`文件历史记录中有两个文件是用 tramp 打开的，删除它们会阻止 tramp 加载..

我刚刚发现[emacs wiki 的这一部分](http://www.emacswiki.org/emacs/RecentFiles#toc9)解释了这个问题，

> 当使用带recentf.el 的TrampMode 时，建议关闭recentf 的清理功能，该功能会尝试统计所有文件并将它们从最近访问的列表中删除（如果它们是可读的）。Tramp 意味着这需要recentf 打开一个远程站点，这将在最不合时宜的时候阻止您的emacs 进程。
> 
> ```
> (require 'recentf)
> (setq recentf-auto-cleanup 'never) ;; disable before we start recentf!
> (recentf-mode 1) 
> ```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-03-06T23:36:54.250

如果您使用 ido 模式，另一种可能性是在 ~/.ido.last 中列出。在这种情况下，补救措施就是“rm ~/.ido.last”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-19T13:17:54.630

在我看来，您有一个通过 tramp 打开并在启动时重新打开的文件。必须设置 emacs 来恢复您的会话？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T02:25:56.207

从[流浪汉常见问题解答](http://www.gnu.org/software/emacs/manual/html_node/tramp/Frequently-Asked-Questions.html)：

> 如何禁用流浪汉？
> 
> 惭愧，你为什么读到现在？
> 
> 如果您只想将 Ange-FTP 作为默认远程文件访问包，您应该 > 应用以下代码：
> 
> ```
>  (setq tramp-default-method "ftp") 
> ```
> 
> 卸载tramp可以通过应用Mx tramp-unload-tramp来实现。这也会重置 > Ange-FTP 插件。

请注意，我还没有尝试过，但希望它对你有用！

# automation - Fortran 的自动文档类型功能？

> ID：880636
> 
> 赞同：5
> 
> 时间：2009-05-19T01:50:11.507
> 
> 标签：automation, uml, fortran, documentation-generation

过去我在 C 和 C++ 中使用过 Doxygen，但现在我被 Fortran 项目所吸引，我想快速了解一下该架构。

在过去，我发现逆向工程工具在不存在架构文档的情况下很有用。

那么，有没有一种工具可以对 Fortran 代码进行逆向工程？

我尝试使用 Doxygen，但没有任何运气。我将处理两个不同的项目——一个是 Fortran 90，我认为是 Fortran 77。

感谢您的任何见解和反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T04:48:45.627

可能有助于逆向工程的工具：
[SciTools 了解](http://www.scitools.com/)
[与更多工具的链接（搜索“fortran”）](http://www.laatuk.com/tools/documentation_tools.html)

此外，也许其中一些单元测试框架会有所帮助（我没有使用过它们，所以我无法评论它们的优缺点）：
[FUnit](http://fortranwiki.org/fortran/show/FUnit)
[FRUIT](http://fortranwiki.org/fortran/show/Fortran+Unit+Test+Framework)
[Ftnunit](http://fortranwiki.org/fortran/show/Ftnunit)
（这些链接链接到 fortranwiki，您可以在其中找到他们每个人的花絮，从那里有指向他们主页的链接）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-16T21:26:26.730

Doxygen 1.6.1 将为自由格式 (F90) 格式的 Fortran 源代码生成文档、调用图等。使用 doxygen 自动记录固定格式 (F77) 代码很不走运。

然而，一切并没有丢失。从固定格式到自由格式的转换很简单，并且可以在很大程度上自动化——将注释字符更改为“！”，将继续字符更改为“&”，并将“&”附加到要继续的行。事实上，如果附加的连续字符放在第 73 列，标准 F77 编译器应该忽略它（仍然只识别第 1 到 72 列中的代码），但 F9x/F2003/F2008 编译器会识别它。这允许将相同的代码识别为固定格式和自由格式，这样您就可以优雅地从一种格式迁移到另一种格式。

方便的是，大约有一千个小程序会在某种程度上进行这种格式调整。实际上，如果您要维护代码，不妨将其从 1928 年的 Hollerith (IBM) 穿孔卡片规范中移开。:)

# c++ - cxxTestgen.py 抛出语法错误

> ID：880639
> 
> 赞同：0
> 
> 时间：2009-05-19T01:50:55.293
> 
> 标签：c++, python, visual-studio, unit-testing

我已经按照[cxxtest Visual Studio Integration](http://cxxtest.com/index.php?title=Visual_Studio_integration)的教程进行操作，并且在 google 上查看过，但一无所获。

当我尝试使用 cxxtest 和 Visual Studio 进行基本测试时，我收到此错误：

```
1>Generating main code for test suite
1>  File "C:/cxxtest/cxxtestgen.py", line 60
1>    print usageString()
1>                    ^
1>SyntaxError: invalid syntax 
```

我在教程的第 7 步，我的所有设置都完全按照教程中的设置。

这是基本的测试脚本：

```
#include <cxxtest/TestSuite.h>
 class MyTestSuite : public CxxTest::TestSuite 
  {
  public:
      void testAddition( void )
      {
          TS_ASSERT( 1 + 1 > 1 );
          TS_ASSERT_EQUALS( 1 + 1, 2 );
      }
  }; 
```

编辑：我正在使用 Python 3.0，这可能是问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T03:38:35.420

您似乎在没有为 python 3.0 准备好的代码体上使用 Python 3.0 - 您最好的选择是降级到 python 2.6，直到 cxxtestgen.py 与 python 3.0 一起使用。

有关详细信息，请参阅[http://docs.python.org/3.0/whatsnew/3.0.html#print-is-a-function](http://docs.python.org/3.0/whatsnew/3.0.html#print-is-a-function)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-21T05:07:48.823

前面的评论正确地指出 CxxTest 3.x 不支持 Python 3.x。但是，最近发布了 CxxTest 4.0，它支持 Python 3.1 和 3.2。

查看 CxxTest 主页：[cxxtest 网站](http://cxxtest.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T01:58:42.363

尝试运行`cxxtestgen.py`on 命令行。它是否打印使用页面？

# regex - 单个 perl 正则表达式，用于从 href 属性内部而不是其他地方删除转义的 & 符号

> ID：880649
> 
> 赞同：1
> 
> 时间：2009-05-19T01:54:18.643
> 
> 标签：regex, perl

对于我的好奇心来说，这更像是一个谜题。我正在寻找一个单一的正则表达式替换，它将实体转义的 & 符号转换为仅在 html 文件中的 href 属性内的非转义 & 符号。例如：

```
<a href="http://example.com/index.html?foo=bar&amp;baz=qux&amp;frotz=frobnitz">
Me, myself &amp; I</a> 
```

将转换为：

```
<a href="http://example.com/index.html?foo=bar&baz=qux&frotz=frobnitz">
Me, myself &amp; I</a> 
```

现在，我可以在几个语句中做到这一点，但我很好奇是否有任何 perl 正则表达式专家可以在一个语句中做到这一点。

到目前为止，我最接近的是下面的正则表达式，它不起作用，因为lookbehinds 不能是可变长度的。当然，即使他们被允许，它也可能不起作用，我不确定。

```
s/(?<=href=".*?)&amp;(?=.*?")/&/g; 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T03:07:26.810

调整您的近似值：

```
while (s/(?<=href=")([^"]*?)&amp;/$1&/) {} 
```

这是一个骗局；但它是一个单一的正则表达式。关键部分是对非右双引号后跟字符串的字符进行*非贪婪扫描。*`&amp;`另一个要观察的是给定输入：

```
<a href="http://example.com/index.html?x=y&amp;amp;amp;y=z"> 
```

你会出去：

```
<a href="http://example.com/index.html?x=y&y=z"> 
```

你必须决定这是否重要。

任何非迭代解决方案的困难在于，一旦您`href="`在第一场比赛中阅读了 ' '，您将不会在后续比赛中再次看到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-01T01:33:41.670

此正则表达式将在一行 Perl 代码中执行您想要的操作，而没有低效的 while 循环（这使得正则表达式每次都从头开始）或后视：

```
s/((href="|\G)[^"]*?&)amp;/$1/g; 
```

诀窍是使用 \G 使正则表达式“记住”它在 href 属性中。

这个正则表达式也正确地替换了 &amp; 与&

唯一的缺陷是如果 & 出现在主题字符串的开头，它也会被替换。如果你想避免这种情况，请使用：

```
s/((href="|\G(?!\A))[^"]*?&)amp;/$1/g; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T07:14:25.443

不要试图用正则表达式解析非常规语言。从 CPAN 获取 HTML 解析器，然后只对您需要的元素进行操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-01T07:46:39.723

好的。首先 - & in hrefs 非常好，所以我不明白你为什么要更改它 - 实际上带有 & in hrefs 的 html 是无效的！

其次 - 如果你需要它来做任何事情 - 你真的应该使用一些合理的 HTML Parser。

第三，你想要的可以很容易地完成，但不是很好：

```
s{href="([^"]*)"}{my $q=$1; $q =~ s/\&amp;/&/g; 'href="' . $q . '"'}eg; 
```

但是，请：技术上可行的事实并不意味着您应该使用它。

# c# - 使用委托而不是接口进行解耦。好主意？

> ID：880652
> 
> 赞同：4
> 
> 时间：2009-05-19T01:55:04.617
> 
> 标签：c#, unit-testing, functional-programming, readability, decoupling

在编写 GUI 应用程序时，我使用“控制”或“协调”应用程序的顶级类。顶级类将负责协调诸如初始化网络连接、处理应用程序范围的 UI 操作、加载配置文件等事情。

在 GUI 应用程序的某些阶段，控件被移交给不同的类，例如，一旦用户进行身份验证，主控件就会从登录屏幕切换到数据输入屏幕。不同的类需要使用顶层控件所拥有的对象的功能。过去我会简单地将对象传递给从属控件或创建一个界面。最近我已经改为传递方法委托而不是整个对象，主要原因有两个：

*   单元测试时模拟方法比模拟类容易得多，
*   它通过在类构造函数中准确记录下级类正在使用哪些方法，使代码更具可读性。

一些简化的示例代码如下：

```
delegate bool LoginDelegate(string username, string password);
delegate void UpdateDataDelegate(BizData data);
delegate void PrintDataDelegate(BizData data);

class MainScreen {
    private MyNetwork m_network;
    private MyPrinter m_printer;

    private LoginScreen m_loginScreen;
    private DataEntryScreen m_dataEntryScreen;

    public MainScreen() {
        m_network = new Network();
        m_printer = new Printer();

        m_loginScreen = new LoginScreen(m_network.Login);
        m_dataEntryScreen = new DataEntryScreen(m_network.Update, m_printer.Print);
    }
}

class LoginScreen {
    LoginDelegate Login_External;

    public LoginScreen(LoginDelegate login) {
        Login_External = login
    }
}

class DataEntryScreen {
    UpdateDataDelegate UpdateData_External;
    PrintDataDelegate PrintData_External;

    public DataEntryScreen(UpdateDataDelegate updateData, PrintDataDelegate printData) {
        UpdateData_External = updateData;
        PrintData_External = printData;
    }
} 
```

我的问题是，虽然我更喜欢这种方法，而且这对我来说很有意义，但下一个开发人员如何找到它？在示例和开源 C# 代码中，接口是解耦的首选方法，而这种使用委托的方法更倾向于函数式编程。我是否可能让后续开发人员低声咒骂什么是违反直觉的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T02:43:23.737

这是一个有趣的方法。您可能需要注意两件事：

1.  就像 Philip 提到的，当你有很多方法要定义时，你最终会得到一个大的构造函数。这将导致类之间的深度耦合。多一位或少一位代表将要求每个人修改签名。您应该考虑将它们设为公共属性并使用一些 DI 框架。

2.  有时将实现分解到方法级别可能过于细化。使用类/接口，您可以按域/功能对方法进行分组。如果您将它们替换为代表，它们可能会混淆并变得难以阅读/维护。

代表人数似乎是这里的一个重要因素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T02:17:36.753

虽然我当然可以看到使用委托而不是接口的积极方面，但我不得不不同意你的两个要点：

*   *“在单元测试时模拟一个方法比模拟一个类要容易得多”*。大多数 c# 的模拟框架都是围绕模拟类型的想法构建的。虽然许多可以模拟方法，但示例和文档（和焦点）通常围绕类型。用一种方法模拟接口与模拟方法一样容易或更容易。

*   *“它通过在类构造函数中准确记录下级类正在使用哪些方法，使代码更具可读性。”* 也有它的缺点——一旦一个类需要多个方法，构造函数就会变大；并且一旦从属类需要新的属性或方法，而不仅仅是修改接口，您还必须将其添加到链上的所有类构造函数中。

我并不是说这是一种不好的方法——传递函数而不是类型确实清楚地说明了你在做什么，并且可以降低你的对象模型的复杂性。但是，在 c# 中，您的下一个开发人员可能会认为这很奇怪或令人困惑（取决于技能水平）。将 OO 和函数式方法混合使用可能至少会引起与您合作的大多数开发人员的注意。

# iframe - iframe nytimes.com 是不可能的吗？

> ID：880655
> 
> 赞同：2
> 
> 时间：2009-05-19T01:56:27.373
> 
> 标签：iframe, reload

我试过了，它只是重新加载到 nytimes.com 有什么想法吗？

```
<div style="position:absolute; top: 0; left: 0; width:80%; height:100%; background-color:white">
<iframe border=0 width=50% height=1000 src="http://nytimes.com/"></iframe>
</div> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-19T02:13:55.887

我只是想补充克里斯托弗凯利所说的话——他们显然不希望你把他们的内容放在一个框架中，所以你不应该这样做。您可能需要参考他们[的使用条款，](http://www.nytco.com/terms_of_use.html)以了解他们可以使用的**内容**类型。

这是相关的：

> 商标、版权和限制。本网站由纽约时报公司控制和运营。本网站上的所有材料，包括但不限于图像、插图、音频剪辑和视频剪辑，均受纽约时报公司及其相关公司拥有和控制的版权、商标和其他知识产权的保护。公司或已将其材料许可给纽约时报公司的其他方。本网站上的材料仅供您个人使用，非商业用途。未经纽约时报公司事先明确书面同意，不得以任何方式（包括通过电子邮件或其他电子方式）复制、复制、再版、修改、上传、张贴、传输或分发此类材料。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-19T02:04:35.283

他们正在使用框架突破 javascript，因为这是他们的网站，所以您无能为力。一种可能性是不要将他们的网站嵌入框架中，而是使用服务器端方法下载所需内容并将其内联显示在您的网站上。

# c# - 如何在sql中将带时区的varchar转换为日期时间

> ID：880656
> 
> 赞同：2
> 
> 时间：2009-05-19T01:56:40.277
> 
> 标签：c#, sql, xml

我将我的 c# 对象序列化为 xml，然后得到 varchar，例如“2009-05-09T13:50:59.6361485+08:00”。

但是 SQL Server 返回以下消息：“结果：消息 241：转换日期和/或时间时转换失败 - 从字符串。”

在我执行以下 sql 之后：声明 @msg xml

设置@msg='<root><date>2009-05-09T13:50:59.6361485+08:00</date></root>'

选择@msg.value(N'(//root/date/text())[1]','datetime')

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T02:25:05.163

试试这个：

```
declare @msg xml
set @msg='<root><date>2009-05-09T13:50:59.6361485+08:00</date></root>'
select @msg.value(N'(xs:dateTime((//root/date/text())[1]))', 'datetime') 
```

问题是，XML 中的日期时间格式的“秒”值比 value() 函数（及其对 CAST 或 CONVERT 的底层调用）可以处理的精度更高。请参阅[http://msdn.microsoft.com/en-us/library/ms187928(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms187928(SQL.90).aspx)。转换类型 126 和 127 需要 .mmm（3 位精度），而在您的原始值中，您有 7。

对于调试步骤，请考虑以下内容：

```
select @msg.value(N'(//root/date/text())[1]', 'varchar(100)')
> 2009-05-09T13:50:59.6361485+08:00

select @msg.value(N'(xs:dateTime((//root/date/text())[1]))', 'varchar(100)')
> 2009-05-09T05:50:59.636Z 
```

# java - 在另一个 java 文件中从一个文件扩展一个 java 类

> ID：880662
> 
> 赞同：65
> 
> 时间：2009-05-19T01:58:31.333
> 
> 标签：java, import, include

如何将一个 java 文件包含到另一个 java 文件中？

例如：如果我有 2 个 java 文件，一个被调用`Person.java`，一个被调用`Student.java`。我怎样才能包含`Person.java`进去`Student.java`，以便我可以从`Person.java`in扩展类`Student.java`

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-05-19T02:07:22.843

只需将两个文件放在同一个目录中即可。这是一个例子：

人.java

```
public class Person {
  public String name;

  public Person(String name) {
    this.name = name;
  }

  public String toString() {
    return name;
  }
} 
```

学生.java

```
public class Student extends Person {
  public String somethingnew;

  public Student(String name) {
    super(name);
    somethingnew = "surprise!";
  }

  public String toString() {
    return super.toString() + "\t" + somethingnew;
  }

  public static void main(String[] args) {
    Person you = new Person("foo");
    Student me = new Student("boo");

    System.out.println("Your name is " + you);
    System.out.println("My name is " + me);
  }
} 
```

运行 Student（因为它具有 main 功能）会产生我们想要的结果：

```
Your name is foo
My name is boo  surprise! 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-09-17T19:23:16.120

所有解释中都缺少一个事实，即 Java 有一个严格的*class name = file name*规则。这意味着如果你有一个类“Person”，它必须在一个名为“Person.java”的文件中。因此，如果一个类试图访问“Person”，则不需要文件名，因为它必须是“Person.java”。

来到 C/C++，我有完全相同的问题。答案是创建一个新类（在与类名匹配的新文件中）并创建一个公共字符串。这将是您的“头”文件。然后通过使用“扩展”关键字在主文件中使用它。

这是你的答案：

1.  创建一个名为 Include.java 的文件。在此文件中，添加以下内容：

    ```
    public class Include {
        public static String MyLongString= "abcdef";
    } 
    ```

2.  创建另一个文件，例如 User.java。在这个文件中，输入：

    ```
    import java.io.*;

    public class User extends Include {
        System.out.println(Include.MyLongString);
    } 
    ```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-05-19T02:27:43.257

Java 不像 C 那样使用包含。相反，java 使用了一个名为 classpath 的概念，一个包含 java 类的资源列表。JVM 可以通过名称访问类路径上的任何类，因此如果您可以扩展类并通过声明它们来引用类型。java 包含语句的关闭是'import'。由于类被分解为像 foo.bar.Baz 这样的命名空间，如果您在 qux 包中并且想要使用 Baz 类而不必使用其全名 foo.bar.Baz，那么您需要使用在您的 java 文件开头的 import 语句如下所示： `import foo.bar.Baz`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-19T02:00:51.857

你没有。

如果您想用 Student 扩展 Person，只需执行以下操作：

```
public class Student extends Person
{
} 
```

并确保，当你编译这两个类时，一个可以找到另一个。

你用的是什么IDE？

# smalltalk - GNU Smalltalk 与 Squeak 的兼容性如何

> ID：880663
> 
> 赞同：11
> 
> 时间：2009-05-19T01:58:36.310
> 
> 标签：smalltalk, porting, squeak

我正在开发一个完全不需要图形的应用程序，它只是数据操作。问题是我在一个相当保守的环境中工作，我认为我无法向我的经理出售一个吱吱声的应用程序（我觉得明亮的颜色、圆形的界面和一般的“这到底是什么” “吱吱声会吓跑他们）。所以我正在考虑在 GNU Smalltalk 下运行该应用程序，因为更“传统”的命令行界面不太可能吓跑利益相关者。

那么，任何人都可以提供或指出我在 Squeak 和 Gnu Smalltalk 之间兼容或不兼容的功能/类的列表或集合。换句话说，将应用程序从一个应用程序移植到另一个应用程序有多难（再次假设它是非图形的，因此无需担心形态）？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T09:36:17.690

有一个 ANSI Smalltalk 标准 ( [http://www.smalltalk.org/versions/ANSIStandardSmalltalk.html](http://www.smalltalk.org/versions/ANSIStandardSmalltalk.html "安西小话") )。Gnu 似乎是该标准的完整实现（请参阅[Gnu Wiki](http://scratchpad.wikia.com/wiki/GNU_Smalltalk)），而 Squeak 似乎相当兼容（请参阅[Squeak Wiki](http://wiki.squeak.org/squeak/3172)）。所以坚持标准，你应该做得很好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T07:59:24.583

我 100% 同意 iguy；除此之外，主要区别在于文件系统类。GNU Smalltalk 更类似于 Squeak 的*Rio*包。

您可以使用[gst-convert](http://smalltalk.gnu.org/faq/169)将您的代码从 Squeak 转换为 GST，这也将处理一些差异。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-20T16:55:11.487

GST 实施将为您提供比我们更好的答案 - 所以试试吧 - 归档您的代码，看看 GST 失败的原因。

我不知道[Rosetta "Cross-Dialect Smalltalk Code Interchange Tool"](http://rosettast.sourceforge.net/)的更新程度如何，但它可能会有所帮助。

以下是一些细微的差异，这些差异已被拉平以使基准游戏更容易 - [GNU Smalltalk](http://shootout.alioth.debian.org/gp4/smalltalk.php#about) :: [Squeak](http://shootout.alioth.debian.org/gp4/benchmark.php?test=all&lang=squeak#about)

[当您遇到特定问题时，请在GNU Smalltalk 邮件列表](http://smalltalk.gnu.org/community/ml)中询问它们。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-22T20:40:11.483

除了其他建议之外，请确保您的 SUnit 测试用例是最新的；在 GNU Smalltalk 中找到您的应用程序以这种方式使用的任何缺失方法要容易得多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-19T19:10:28.517

Pharo 看起来更专业，可能会有所帮助。或者，如果您的数据少于 4GB，Gemstone。Seaside 用户界面看起来与 ASP.NET MVC 或 Rails 相同，并且可以更轻松地创建。

# php - 格式化日期的问题

> ID：880664
> 
> 赞同：1
> 
> 时间：2009-05-19T01:58:36.310
> 
> 标签：php, mysql, datetime, mktime

我正在尝试编写一个函数来为我格式化日期和时间。我有一个几乎相同的函数，它只格式化一个日期。该功能工作正常。我刚刚添加了一些代码来尝试用时间格式化日期。它应该返回类似“2009 年 5 月 18 日晚上 9:50”的内容，但我收到以下警告：

```
Warning: mktime() expects parameter 6 to be long, string given in
public_html/include/functions.php on line 421 
```

这是我的代码：

```
function dateTimeFormat($dateIn)
{
   $x = explode(" ",$dateIn);
   $y = explode("-",$x[0]);
   $z = explode(":",$x[1]);

   $year = $y[0]; 
   $month = $y[1];
   $day = $y[2];
   $hour = $z[0];
   $min = $z[1];

   $dateOut =date("F j, Y h:i A", mktime($hour, $min, 0, $month, $day, $year)); 

   return $dateOut;
} 
```

它发布的内容也是错误的。它提出：

```
December 31, 1969 07:00 PM 
```

但数据库中的时间戳是

```
2009-05-18 05:07:39 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T02:05:59.930

PHP 已经有一个非常好的日期解析功能：[`strtotime()`](http://us.php.net/strtotime). 它返回一个 Unix 时间戳，您可以将其传递给`date()`.

换句话说，您的功能可以简化为：

```
function dateTimeFormat($dateIn)
{
    return date("F j, Y h:i A", strtotime($dateIn));
} 
```

# linq - 卡在 Linq 中正在分组的子查询上

> ID：880665
> 
> 赞同：1
> 
> 时间：2009-05-19T01:58:40.270
> 
> 标签：linq

我有一些 Linq 代码，它工作正常。`Where`这是一个在子句中有子查询的查询。此子查询正在执行 groupby。效果很好。

问题是我不知道如何将子查询中的结果之一从子查询中抓取到父查询中。

首先，这是代码。之后，我将解释我想要提取的数据。

```
 var results = (from a in db.tblProducts
               where (from r in db.tblReviews
                      where r.IdUserModified == 1
                      group r by
                          new
                              {
                                  r.tblAddress.IdProductCode_Alpha,
                                  r.tblAddress.IdProductCode_Beta,
                                  r.tblAddress.IdProductCode_Gamma
                              }
                      into productGroup
                          orderby productGroup.Count() descending
                          select
                          new
                              {
                                  productGroup.Key.IdProductCode_Alpha,
                                  productGroup.Key.IdProductCode_Beta,
                                  productGroup.Key.IdProductCode_Gamma,
                                  ReviewCount = productGroup.Count()
                              }).Take(3)
                   .Any(
                   r =>
                   r.IdProductCode_Alpha== a.IdProductCode_Alpha&& 
                       r.IdProductCode_Beta== a.IdProductCode_Beta&&
                       r.IdProductCode_Gamma== a.IdProductCode_Gamma)
               where a.ProductFirstName == ""
               select new {a.IdProduct, a.FullName}).ToList(); 
```

行。我更改了一些字段和表的名称以保护无辜者。:)

请参阅最后一行：-

```
select new {a.IdProduct, a.FullName}).ToList(); 
```

我希望包括 ReviewCount （来自子查询）。我只是不确定如何。

为了帮助理解问题，这就是数据的样子。

### 子查询

IdProductCode_Alpha = 1，IdProductCode_Beta = 2，IdProductCode_Gamma = 3，ReviewCount = 10 ... 第 2 行 ... ... 第 3 行 ...

### 父查询

IdProduct = 69, FullName = 'Jon Skeet's Wonder Balm'

所以子查询获取我需要的实际数据。父查询根据子查询过滤器确定正确的产品。

# 编辑 1：架构

tbl产品

*   产品编号
*   全名
*   产品名

tblReviews（每个产品有零到多个评论）

*   标识产品
*   IdProductCode_Alpha（可以为空）
*   IdProductCode_Beta（可以为空）
*   IdProductCode_Gamma（可以为空）
*   身份

所以我试图找到一个人做过评论的前 3 种产品。

linq 工作得很好......除了我只是不知道如何在父查询中包含 COUNT（即从子查询中提取结果）。

干杯:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T06:09:09.567

我自己搞定了。请注意`from`查询开头的双精度，然后将`Any`() 替换为`Where()`子句。

```
var results = (from a in db.tblProducts
               from g in (
                  from r in db.tblReviews
                  where r.IdUserModified == 1
                  group r by
                      new
                          {
                              r.tblAddress.IdProductCode_Alpha,
                              r.tblAddress.IdProductCode_Beta,
                              r.tblAddress.IdProductCode_Gamma
                          }
                  into productGroup
                      orderby productGroup.Count() descending
                      select
                      new
                          {
                              productGroup.Key.IdProductCode_Alpha,
                              productGroup.Key.IdProductCode_Beta,
                              productGroup.Key.IdProductCode_Gamma,
                              ReviewCount = productGroup.Count()
                          })
                  .Take(3)
           Where(g.IdProductCode_Alpha== a.IdProductCode_Alpha&& 
               g.IdProductCode_Beta== a.IdProductCode_Beta&&
               g.IdProductCode_Gamma== a.IdProductCode_Gamma)
           where a.ProductFirstName == ""
           select new {a.IdProduct, a.FullName, g.ReviewCount}).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T02:06:08.463

虽然我不完全了解 LINQ，但是 JOIN 不起作用吗？
我知道我的回答无济于事，但看起来您需要与内表进行 JOIN（？）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T03:13:21.167

我同意 shahkalpesh 关于模式和连接的观点。

您应该能够重构...

```
 r => r.IdProductCode_Alpha == a.IdProductCode_Alpha  && 
      r.IdProductCode_Beta == a.IdProductCode_Beta  &&
      r.IdProductCode_Gamma == a.IdProductCode_Gamma 
```

与`tblProducts`.

# vim - 在 Vim 中更改制表位后如何避免缩进错误？

> ID：880668
> 
> 赞同：4
> 
> 时间：2009-05-19T02:00:00.643
> 
> 标签：vim, vi

我曾经在 Vim 中有 8 个空格的制表符。然后我改为 4 个空格，但现在每当我在更改为 4 个空格之前编写的一些代码中添加一行时，即使一切都很好地排列，它也会给我一个缩进不匹配错误。有没有办法避免这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-19T02:03:03.600

你做过`:%retab`……吗？

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-19T02:04:06.703

您是否仅更改了 tabstop 选项？

我使用 4 个空格（当我点击制表符时用空格填充，以插入实际的制表符命中`ctrl-v tab`）。以下是来自 .vimrc 的选项卡相关设置：

```
" tabs
set tabstop=4
set shiftwidth=4
set expandtab 
```

当您用空格填充制表符时，您将始终插入空格而不是制表符，并且您的代码将始终看起来相同。

当您使用选项卡时，每个工具都会以不同的方式显示选项卡，您最终会花时间设置应为选项卡 (8、4、3.5) 显示多少空间，而不是进行生产性工作。

或选择其中之一（来自 vim 7.1 help tabstop）：

```
 Note: Setting 'tabstop' to any other value than 8 can make your file
    appear wrong in many places (e.g., when printing it).

    There are four main ways to use tabs in Vim:
    1\. Always keep 'tabstop' at 8, set 'softtabstop' and 'shiftwidth' to 4
       (or 3 or whatever you prefer) and use 'noexpandtab'.  Then Vim
       will use a mix of tabs and spaces, but typing <Tab> and <BS> will
       behave like a tab appears every 4 (or 3) characters.
    2\. Set 'tabstop' and 'shiftwidth' to whatever you prefer and use
       'expandtab'.  This way you will always insert spaces.  The
       formatting will never be messed up when 'tabstop' is changed.
    3\. Set 'tabstop' and 'shiftwidth' to whatever you prefer and use a
       |modeline| to set these values when editing the file again.  Only
       works when using Vim to edit the file.
    4\. Always set 'tabstop' and 'shiftwidth' to the same value, and
       'noexpandtab'.  This should then work (for initial indents only)
       for any tabstop setting that people use.  It might be nice to have
       tabs after the first non-blank inserted as spaces if you do this
       though.  Otherwise aligned comments will be wrong when 'tabstop' is
       changed. 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-19T02:20:14.690

对于 python 代码，您可能最好使用以下内容：

```
:set tabstop=8
:set shiftwidth=4
:set expandtab 
```

这样，您仍然使用“行业标准”的 8 个空格选项卡，但您不会将它们中的任何一个放入您的文件中。这也应该使您的旧代码保持干净，尽管您必须重新检查并手动移动所有剩余的内容。你肯定也想 :retab 一切。

如果你想用 4 个空格缩进替换所有内容

```
:set tabstop=4
:retab
:set tabstop=8 
```

这将使用每个选项卡 4 个空格的空格重新缩进所有内容，并使您恢复正常的默认值。

显然，这取决于意见，但在我的书中，使用选项卡设置为您在 cat 文件时获得的任何内容之外的任何内容都是在自找麻烦。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T05:06:57.167

可视化不匹配的最佳方法是 :set list 它将显示空白问题。

```
set listchars=tab:>-,trail:-,nbsp:+ "This is terminal friendly but you can make fancy
set list 
```

当间隔缩进是常态时，我会说这是 python 编辑的基本设置。尤其是当文件由同事编辑时。

我还仔细检查了“代码布局”下的样式指南。[您可能想要使用http://www.python.org/dev/peps/pep-0008/](http://www.python.org/dev/peps/pep-0008/)中指定的 python -tt 选项。如果您将制表符与空格混合使用，则会引发警告和错误。

您可以将其合并到您的单元测试中。似乎 pep 建议为较新的代码使用 4 个空格。如果您打算为开源项目做出贡献，您可能需要考虑进行更改。

为了在 eol 处删除空格，我还要更加整洁

```
nnoremap <leader>wd :%s/\s\+$//<cr> 
```

# php - 在使用 get_the_tag_list($ID) WordPress 时需要帮助

> ID：880673
> 
> 赞同：2
> 
> 时间：2009-05-19T02:02:56.237
> 
> 标签：php, wordpress, wordpress-theming

我正在制作一个新的 WordPress 模板，我只想以文本格式获取与帖子关联的标签列表。我在用

```
get_the_tag_list($id) 
```

但问题是它返回 URL 以及文本。有什么方法可以获取附加到以逗号分隔的帖子的标签的“文本”？

即**tag1、tag2、tag3、tag4**等没有 URL 并且只是作为文本？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T23:20:44.540

```
<?php
$posttags = get_the_tags();
if ($posttags) {
foreach($posttags as $tag) {
echo $tag->name . ','; 
}
}
?> 
```

来源：[http ://codex.wordpress.org/Template_Tags/get_the_tags](http://codex.wordpress.org/Template_Tags/get_the_tags)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T02:38:49.113

模板标签[get_the_tags()](http://codex.wordpress.org/Template_Tags/get_the_tags)返回与当前在循环中的上下文相关联的所有标签的数组。您可以遍历这个数组并手动生成一个逗号分隔的列表。

这是一个如何使用 implode 和 print_r 函数的示例：

```
<?php
$posttags = get_the_tags();
if ($posttags) {
  foreach ($posttags as $tag) {
     $tagnames[count($tagnames)] = $tag->name;
  }
  $comma_separated_tagnames = implode(", ", $tagnames);
  print_r($comma_separated_tagnames);
}
?> 
```

# django - 在 Django admin 中，如何按组过滤用户？

> ID：880684
> 
> 赞同：8
> 
> 时间：2009-05-19T02:05:29.430
> 
> 标签：django, django-admin, django-authentication

它使您可以按员工状态和超级用户状态进行过滤，但是组呢？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-10-22T14:33:08.317

从 1.3 版开始，可以[使用以下](https://docs.djangoproject.com/en/1.3/ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_filter)方法完成：

```
list_filter = ('groups__name') 
```

当然，正如@S.Lott 解释的那样，您必须在 admin.py 文件中注册您的自定义类：

```
from django.contrib import admin
from django.contrib.auth.admin import UserAdmin
from django.contrib.auth.models import User

class MyUserAdmin(UserAdmin):
    list_filter = UserAdmin.list_filter + ('groups__name',)

admin.site.unregister(User)
admin.site.register(User, MyUserAdmin) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-19T02:15:36.680

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-13T19:39:58.787

这是一个完整的示例，它继承自 SimpleListFilter，它在 Django 1.4 及更高版本中可用。

[https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_filter](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_filter)

它支持设置所有可用的标签和参数来创建完全自定义的过滤器。

它在过滤器面板中显示为“按组”，其中包含所有可用组的列表。

```
from django.contrib.admin import SimpleListFilter
from django.contrib.auth.models import Group
from django.utils.translation import ugettext as _

class GroupListFilter(SimpleListFilter):
    title = _('group')
    parameter_name = 'group'

    def lookups(self, request, model_admin):
        items = ()
        for group in Group.objects.all():
            items += ((str(group.id), str(group.name),),)
        return items

    def queryset(self, request, queryset):
        group_id = request.GET.get(self.parameter_name, None)
        if group_id:
            return queryset.filter(groups=group_id)
        return queryset

from django.contrib import admin
from django.contrib.auth.admin import UserAdmin
from django.contrib.auth.models import User

class MyUserAdmin(UserAdmin):
    list_filter = UserAdmin.list_filter + (GroupListFilter,)

admin.site.unregister(User)
admin.site.register(User, MyUserAdmin) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-10-25T06:29:39.943

在更高版本的 Django 中，它完全按照您的预期工作：

```
list_filter = ('groups', ) 
```

无需注销/注册管理类。

# python - 我应该实现 BeautifulSoup 和 REGEX 的混合使用还是完全依赖 BS

> ID：880687
> 
> 赞同：0
> 
> 时间：2009-05-19T02:06:57.510
> 
> 标签：python, regex, beautifulsoup

我有一些需要从 html 文件集合中提取的数据。我不确定数据是否驻留在 div 元素、table 元素或组合元素中（其中 div 标签是 table 的元素。我见过所有三种情况。我的文件大到 2 mb 和我有数万个。到目前为止，我已经查看了表格中的 td 元素并查看了孤独的 div 元素。在我看来，最长的时间是文件被**汤化**，超过 30 秒。我尝试创建一个正则表达式来查找我要查找的数据，然后查找下一个关闭标记表、tr、td 或 div 以确定我的文本包含在哪种类型的结构中。找到匹配的打开标记，剪切该部分，然后将其全部包装在打开和关闭 HTML 标记中

```
 stuff

 <div>
 stuff
 mytext
 stuff
 </div> 
```

所以我创建了一个看起来像这样的字符串：

```
s='<div>stuffmyTextstuff</div>' 
```

然后我包装字符串

```
 def stringWrapper(s):
     newString='<HTML>'+s+'</HTML>'
     return newString 
```

然后使用 BeautifulSoup

```
littleSoup=BeautifulSoup(newString) 
```

然后我可以访问 BeautifulSoup 的强大功能，用 newString 做我想做的事。

这比首先测试所有表格的所有单元格内容直到我找到我的文本并且如果我找不到它那里测试所有 div 内容的替代方法运行得快得多。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T02:11:37.763

你试过`lxml`吗？BeautifulSoup 很好，但速度不是很快，我相信`lxml`它可以提供相同的质量，但通常性能更好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T02:42:28.687

BeautifulSoup 在内部使用正则表达式（这是它与其他 XML 解析器的区别），因此您可能会发现自己只是在重复它所做的事情。如果您想要一个更快的选项，请先使用 try/catch 尝试 lxml 或 etree 解析，然后在解析器失败时尝试 BeautifulSoup 和/或 tidylib 解析损坏的 HTML。

对于您正在做的事情，您似乎真的想使用 XPath 或 XSLT 来查找和检索您的数据，lxml 两者都可以。

最后，考虑到文件的大小，您可能应该使用路径或文件句柄进行解析，以便可以增量读取源而不是保存在内存中进行解析。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T03:26:33.213

我发现即使 lxml 比 BeautifulSoup 快，对于这种大小的文档，通常最好尝试通过正则表达式（或直接剥离）将大小减小到几 kB 并将其加载到 BS 中，就像你现在所做的那样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T02:47:00.673

我不太明白你想做什么。但我知道你不需要用 < html> 标签括起来你的 div 字符串。BS会很好地解析它。

# c# - 正则表达式在 VB 中有效，但在 C# 中无效

> ID：880707
> 
> 赞同：0
> 
> 时间：2009-05-19T02:15:53.560
> 
> 标签：c#, .net, vb.net, regex

我有以下用于验证文件名的正则表达式：

^(([a-zA-Z]:|\)\)?(((.)|(..)|([^\/:*\?"\|<>.](([^\/ :*\?"\|<>. ])|([^\/:*\?"\|<>] *[^\/:*\?"\|<>. ]))?))\)* [^\/:*\?"\|<>. ](([^\/:*\?"\|<>.])|([^\/:*\?"\|<>]* [^\/:*\?"\|<>. ]))?$

我可以让它在 VB.NET 中工作，但不能在 C# 中工作。我不明白为什么它在一个中起作用，而在另一个中不起作用。

VB代码：

```
Regex.Matches("c:\temp\abc.exe", "^(([a-zA-Z]:|\\)\\)?(((\.)|(\.\.)|([^\\/:\*\?""\|<>\. ](([^\\/:\*\?""\|<>\. ])|([^\\/:\*\?""\|<>]*[^\\/:\*\?""\|<>\. ]))?))\\)*[^\\/:\*\?""\|<>\. ](([^\\/:\*\?""\|<>\. ])|([^\\/:\*\?""\|<>]*[^\\/:\*\?""\|<>\. ]))?$") 
```

C#代码：

```
Regex.Matches("c:\temp\abc.exe", @"^(([a-zA-Z]:|\\)\\)?(((\.)|(\.\.)|([^\\/:\*\?""\|<>\. ](([^\\/:\*\?""\|<>\. ])|([^\\/:\*\?""\|<>]*[^\\/:\*\?""\|<>\. ]))?))\\)*[^\\/:\*\?""\|<>\. ](([^\\/:\*\?""\|<>\. ])|([^\\/:\*\?""\|<>]*[^\\/:\*\?""\|<>\. ]))?$"); 
```

据我所知，两种语言中的模式都是相同的，并带有转义。当我运行 VB 代码时，我得到了匹配。当我运行 C# 代码时，我什么也得不到。

谁能看到我错过了什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-19T02:19:58.043

你不需要在 C# 中转义文件名吗？例如：

```
@"c:\temp\abc.exe" 
```

# c# - 使用 Google 应用域登录的 Picasa 网络相册数据 API 的 ClientLogin

> ID：880710
> 
> 赞同：1
> 
> 时间：2009-05-19T02:16:48.550
> 
> 标签：c#, picasa, google-data

我正在使用 Picasa 网络相册数据 API 从 WPF 应用程序访问用户的相册。

我遵循了位于此处的代码： [http ://code.google.com/apis/gdata/clientlogin.html](http://code.google.com/apis/gdata/clientlogin.html)

我使用 Google Apps（托管）帐户创建了 Picasa 网络相册帐户。每当我尝试使用 WPF 应用程序登录时，都会返回“BadAuthentication”错误代码。

希望有人知道我做错了什么。请注意，这在我使用普通 Google 帐户登录时有效。

这是我的代码片段：

```
 GDataGAuthRequestFactory authFactory = new GDataGAuthRequestFactory("lh2", _appName);
authFactory.AccountType = "HOSTED_OR_GOOGLE";

_picasaService = new PicasaService(authFactory.ApplicationName);
_picasaService.RequestFactory = authFactory;

_picasaService.setUserCredentials(username, password);
return _picasaService.QueryAuthenticationToken(); 

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T12:56:36.497

在玩了一会儿之后，我改变了`AccountType = "GOOGLE"`, 并且奏效了。

想来想去，也是有道理的。我使用现有的电子邮件地址创建了帐户。所以在这种情况下，我登录的是 Google 帐户，而不是托管帐户。

最初，我没有指定 a `RequestFactory`，所以代码如下所示：

```
 _picasaService = new PicasaService(_appName);

_picasaService.setUserCredentials(username, password);
return _picasaService.QueryAuthenticationToken(); 
```

这将导致“无效用户”错误。我最初认为我需要设置`AccountType = "HOSTED_OR_GOOGLE"`, 才能使其正常工作。我脑子里有这个。所以我添加了`RequestFactory`，认为这可以解决我的问题。

查看[GDataGAuthRequestFactory](http://google-gdata.googlecode.com/svn/docs/folder16/AllMembers_T_Google_GData_Client_GDataGAuthRequestFactory.htm)的文档。它指出`AccountType`默认为`"GOOGLE_OR_HOSTED"`，所以我尝试了以下代码：

```
GDataGAuthRequestFactory authFactory = new GDataGAuthRequestFactory("lh2", _appName);
authFactory.AccountType = "GOOGLE_OR_HOSTED";

_picasaService = new PicasaService(authFactory.ApplicationName);
_picasaService.RequestFactory = authFactory; 
```

那行得通。`AccountType`我必须得出结论，记录的of的默认值`"GOOGLE_OR_HOSTED"`不正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-23T10:30:29.570

`HOSTED`指 Google Apps 帐户，`GOOGLE` 指 Google 帐户。您必须自己决定，这不完全是文档中的错误..

# vim - emacs 的 viper-mode 等的提示和技巧

> ID：880713
> 
> 赞同：13
> 
> 时间：2009-05-19T02:18:11.993
> 
> 标签：vim, emacs

基本上，我真的很喜欢 vi[m] 的键绑定，但不喜​​欢编辑器的其他部分。我真的不喜欢 emacs 键绑定，但*喜欢*编辑器的其他部分。

[`viper-mode`](http://www.emacswiki.org/emacs/ViperMode)似乎是两全其美，但它并不完美..

您在 emacs 中错过了哪些 vim 功能（更重要的是，您是如何找回它们的）？你做了哪些配置调整来让 viper 模式更好用？

作为一个开始：我真的很怀念 vim 的视觉选择模式.. [vimpulse 将此](http://www.emacswiki.org/emacs/vimpulse)添加到 emacs 中！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-14T04:40:35.443

我也想念 / 和 ? 的增量搜索。. 类似于 TODO 部分中首先发布的内容。 [http://common-lisp.net/project/vial/darcs/extended-viper/vimlike.el](http://common-lisp.net/project/vial/darcs/extended-viper/vimlike.el)

如果有人能提供，那就太好了。尤尔塔？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T01:32:27.187

据我所知，VIM/VI 一直具有`:set nu`在行本身旁边显示行号的功能。默认情况下，emacs 只有`line-number-mode`在模式行中显示当前行的行号（不是同一件事）。

为了解决这个问题，我总是发现[linum.el](http://stud4.tuwien.ac.at/~e0225855/linum/linum.el)非常有用。从即将推出的 emacs 23 开始，该`linum`模式将包含在标准发行版中。但是对于 emacs <= 22，仍然需要手动安装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-20T00:51:38.093

我建议您使用[我的 emacs starter kit 版本](https://github.com/m7d/emacs-starter-kit)。它完全是为 emacs 和 vi/vim（通过 viper 和 vimpulse）的大量（共生）使用而定制的。

# html - 在不使用 javascript 的情况下确定用户代理时区偏移量？

> ID：880719
> 
> 赞同：4
> 
> 时间：2009-05-19T02:20:28.060
> 
> 标签：html, datetime, cross-browser, utc

有没有办法确定没有 javasript 的用户代理的时区？

通常，我会执行这段 javascript：

```
<script type="text/javascript" language="JavaScript">
 var offset = new Date();
 document.write('<input type="hidden" id="clientTzOffset" 
 name="clientTzOffset" value="' + offset.getTimezoneOffset() + '"/>');
</script> 
```

然而，对于很多手机和客户端来说，JS 要么不存在，要么被关闭。有什么聪明的事情我可以做，还是我被简化为“告诉我你在哪里，你在哪个 timzeone？”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-19T02:35:32.380

两者都用。让 javascript 设置列表或文本字段的默认值。没有 javascript 的人的比例太小了，负担也很小。

我本来想说“使用请求日期：标头”，但这似乎只是一个响应标头。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T05:47:22.050

我想到了另一种解决方案，但它有点复杂。设置一些带有 max-age: 1 响应标头的虚假 HEAD 请求，以强制浏览器重新获取它们。然后，您应该从任何现代浏览器收到一个 if-modified-since 标头，如下所示：

```
If-Modified-Since: Sat, 29 Oct 1994 19:43:31 GMT 
```

请注意不要在第一个响应中发送任何 Last-Modified 标头，因为

> 为了在发送 If-Modified-Since 标头字段以进行缓存验证时获得最佳结果，建议客户端尽可能使用在先前的 Last-Modified 标头字段中收到的确切日期字符串。

请注意“尽可能”的免责声明。这一点，以及头部描述的其他部分暗示客户端将在它不知道服务器的任何内容时使用它自己的时钟。

使用正确的标题组合，这实际上可以很好地工作。

编辑：尝试使用 FF 进行一些测试，但找不到有效的标头组合以在客户端时间触发 if-modified-since。FF 仅在之前获得最后修改的标头时才发送标头，然后仅将值反映回来（即使它不是有效日期）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T02:22:46.900

也许使用服务器端语言，您可以进行 IP 查找，然后从他们的国家/地区确定他们可能在哪个时区。

不过，我想这可能会有问题。

如果沿着这条路走下去，这个问题（和答案）可能会有所帮助。

[从 IP 地址获取位置](https://stackoverflow.com/questions/409999/getting-location-from-ip-address)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T02:46:12.733

我见过一个网站，它没有询问用户所在的时区，而是简单地询问“选择正确的时间”，并向他们展示了一个时间列表。这与“您在哪个时区”略有不同，但更容易理解。不幸的是，我再也找不到该网站了

# asp.net - ASP.Net 页面方法异常没有冒泡？

> ID：880729
> 
> 赞同：0
> 
> 时间：2009-05-19T02:26:36.067
> 
> 标签：asp.net, pagemethods

我无法弄清楚为什么来自静态 ASP.Net Page 方法的异常没有冒泡到要在 global.asax 文件中处理的 Application_Error 事件。我并没有真正期待任何错误，但我希望安全并了解它们是否碰巧发生，并且不想将每个静态方法都包装在 try...catch 中。

有谁知道如何捕捉这些异常，或者至少为什么它们没有冒泡？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T02:40:53.400

如果未在较低层中处理异常，则异常会冒泡到 Application_Error 中的错误处理程序。如果您认为发生异常的地方已经有一个 TRY/CATCH 块，那么它将在该点被捕获。

请发布您的静态方法和 Application_Error 的代码。它将更容易为您提供准确的答案，而不是笼统的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T02:58:41.710

如果在 Visual Studio 中开发，您应该调试您的代码，然后单步调试源代码以查找异常，并在冒泡到 Application_Error 方法之前查看是什么捕获了它。

# iphone - 检测图像触摸（cocos2d）？

> ID：880732
> 
> 赞同：1
> 
> 时间：2009-05-19T02:28:32.253
> 
> 标签：iphone, image, cocos2d-iphone

在 cocos2d 中，您如何检测图像上的触摸？我在这方面遇到了很多麻烦，所以提前谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T01:20:43.177

您在 Layer 类中实现 ccTouchesBegan/Ended/Moved 方法，然后根据您希望检测触摸的节点的容器检查触摸位置。

例如：

```
-(BOOL)ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
  UITouch touch = [touches anyObject];
  CGPoint location = [[Director sharedDirector] convertCoordinate: [touch locationInView: [touch view]]];

  CGRect mySurface = CGRectMake(100, 100, 50, 50);
  if(CGRectContainsPoint(mySurface)) {
    // do something
    return kEventHandled;
  }
  return kEventIgnored;
} 
```

现在，Cocos2D 0.8（现在处于活动测试阶段）中的所有变化都通过使用“Touch Delegates”，并且可以在“Touches Test”中看到示例（从我刚刚查看的源代码来看，这似乎是一个乒乓球游戏）。

我不确定为什么 Corey 说要使用 UIKit 控件来检测触摸，因为 Cocos2D 有自己的处理方式。

只有图层可以接收触摸 - 不建议您为每个可触摸的“游戏对象”（即玩家和对象）使用图层......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T07:31:34.057

您需要使用标准 UIKit 类在游戏顶部过度隐藏触摸表面。

然后，您通过这些对象检测和解释触摸，并将控件传递给您的游戏。

如果您有更具体的问题，您可以提供更多信息或提出其他问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T20:29:09.277

这篇文章将为您解答 **关于 cocos2D for iPhone 和触摸检测的** [问题 关于 cocos2D for iPhone 和触摸检测的问题](https://stackoverflow.com/questions/377785/problem-with-cocos2d-for-iphone-and-touch-detection/379892)

# c# - LINQ options.loadwith 问题

> ID：880734
> 
> 赞同：8
> 
> 时间：2009-05-19T02:31:18.163
> 
> 标签：c#, linq, linq-to-sql, 3nf

我正在编写一个基于标签的 ASP.net 系统。使用以下数据库方案：

`Topic <many-many> TagTopicMap <many-many> Tag`

基本上这是我从以下内容中发现的 3NF 方法（毒物）：[http ://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html](http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html)

这是我的代码片段：

```
DataLoadOptions options = new DataLoadOptions();
        options.LoadWith<Topic>(t => t.TagTopicMaps);
        options.LoadWith<TagTopicMap>(tt => tt.Tag);
        var db = new lcDbDataContext();
        db.LoadOptions = options;
        db.Log = w;

        var x = from topic in db.Topics
                orderby topic.dateAdded descending
                select topic;

        ViewData["TopicList"] = x.Take(10); 
```

当我执行此操作时，结果很好，但它提供了 11 个单个 SQL 查询，其中一个用于获取前 10 个主题的列表：

```
 SELECT TOP (10) [t0].[Id], [t0].[title], [t0].[dateAdded]
FROM [dbo].[Topics] AS [t0] ORDER BY [t0].[dateAdded] DESC
-- Context: SqlProvider(Sql2005) Model: AttributedMetaModel Build: 3.5.30729.1 
```

还有 10 个用于单独获取标签的详细信息。

我尝试打开和关闭这两个 loadwith 语句，发现发生了以下情况：

```
loadwith<topic> : no difference for on or off.
loadwith<tagtopicmap>: 11 Queries when on, much more when off. 
```

简而言之，只有第二个 loadwith 选项按预期工作。第一个没有任何影响！

我还尝试制作结果集 ToList()。但更多的问题出现了：对于标签详细信息部分，它只检索那些 UNIQUE 项目，所有那些重复的标签（当然，同一个标签可能出现在许多主题中！）被查询删除。

最后一件事，以下是我在 aspx 中用于检索数据的代码，如果生成结果 tolist()，我将 (IQueryable) 更改为 (IList)：

```
<% foreach (var t in (IQueryable)ViewData["TopicList"])
       {
           var topic = (Topic)t;

    %>
    <li>
        <%=topic.title %> || 
        <% foreach (var tt in (topic.TagTopicMaps))
           { %>
                <%=tt.Tag.Name%>, 
                <%} %>
    </li>
    <%
        }
    %> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T20:17:19.497

简短的回答是：LinqToSql 有几个这样的怪癖，有时你必须使用变通方法......

Linq2Sql LoadWith 选项只会导致数据库表之间的内部连接，因此您可以通过将 Linq 语句重写为类似的内容来强制执行类似的行为（请原谅任何拼写错误，我习惯于用 VB 语法编写 Linq...）：

```
var x = from topic in db.Topics
        join topicMap in topic.TagTopicMaps
        orderby topic.dateAdded descending
        group topicMap by topicMap.topic into tags = Group; 
```

这种语法可能非常错误，但基本思想是强制 Linq2Sql 评估 Topics 和 TagTopicMaps 之间的连接，然后使用分组（或“组连接”、“让”等）在结果集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-29T05:17:41.400

将 datacontext 类的 EnabledDefferedLoad 设置为 false。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-06T17:01:45.073

您的问题是 Take(10)。这是马的口中：

[https://connect.microsoft.com/VisualStudio/feedback/details/473333/linq-to-sql-loadoptions-ignored-when-using-take-in-the-query](https://connect.microsoft.com/VisualStudio/feedback/details/473333/linq-to-sql-loadoptions-ignored-when-using-take-in-the-query)

建议的解决方法是添加 Skip(0)。这对我不起作用，但 Skip(1) 确实有效。尽管它可能没用，但至少我知道我的问题出在哪里。

# windows-vista - Compaq Visual Fortran 在 Vista 上安装？

> ID：880741
> 
> 赞同：1
> 
> 时间：2009-05-19T02:35:12.803
> 
> 标签：windows-vista, installation, fortran

任何人都能在 Vista 上成功安装 Compaq Visual FORTRAN 6.x 吗？

前几天尝试过，但没有任何运气，所以只是想知道这个老编译器是否过时了。

再次感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-09-27T15:37:14.837

*回答主要问题，并遵循几条评论。*

[自 2011 年 3 月更新 3 起，英特尔® Visual Fortran Composer XE 2011](http://software.intel.com/en-us/articles/intel-fortran-composer-xe-2011-release-notes/)对 Vista 的支持已正式贬值。较新的版本支持 Windows 7。在此之前，Vista 得到支持（据我所知，它仍然有效，尽管我没有它作为我的操作系统，因此无法确定）。

Compaq 的 Visual Fortran 与 MS Fortran Powerstation、Digital、Compaqs 和现在的 Intel 的“同线”，不再支持任何现代操作系统，尽管我可以证明它在 XP SP3 上运行良好。由于它*前段时间*停产，我不希望它在没有一些摆弄的情况下在 Vista 或 Win7 上工作。

这仅适用于 IDE 部分，编译器本身可以正常工作。

如果您想进入尝试设置的过程，[这些人的](http://www.tomshardware.com/forum/2083-63-compaq-visual-fortran-64bit)经验可能对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-26T10:03:16.207

我听说如果您右键单击设置图标并单击“以管理员身份运行”，那么它就可以工作。祝你好运。我仍在尝试为 Vista 寻找 fortran ......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-26T10:08:18.413

您始终可以使用为其编写的任何操作系统运行 VM。不是最优雅的解决方案，但无论如何，Vista 并不是最好的操作系统。你有没有考虑过升级到XP？

# linux - 如何在新格式化的硬盘上创建文件时禁用密码请求

> ID：880743
> 
> 赞同：-1
> 
> 时间：2009-05-19T02:35:44.830
> 
> 标签：linux, unix, formatting, filesystems

我刚刚使用以下命令格式化了外部硬盘：

```
$ sudo mkfs -t ext3 /dev/sdc1 
```

但是，一旦这样做了，每当我想在这个硬盘上创建一个目录或文件时，它总是要求输入密码（即权限要求）。

有没有办法可以禁用它？

请注意，除非我使用 sudo，否则我无法使用 mkfs 格式化分区。

请指教。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T02:40:29.937

如果你将分区挂载到 /media/foo，那么试试这个：

```
sudo chmod 1777 /media/foo 
```

它会像 /tmp 那样行事。因此，任何用户都可以在其中创建文件夹/文件，但您只能删除自己的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T02:47:41.763

我建议你在[ServerFault](http://serverfault.com)上问同样的问题。我想你会在那里得到更好的答案。

# spring - 如果我忘记将 Spring SessionStatus 标记为“完成”会怎样？

> ID：880746
> 
> 赞同：17
> 
> 时间：2009-05-19T02:37:01.817
> 
> 标签：spring, session, spring-mvc, annotations

在 Spring MVC 中，假设我使用 @SessionAttribute 标签定义了一个 SessionAttribute，如下所示：

```
@SessionAttributes(value = "myModel")
public class MyController{
   ...
} 
```

假设我忘记在 SessionStatus 上调用 status.setComplete()，如下所示：

```
@RequestMapping(method = RequestMethod.POST)
public void doSomething(@ModelAttribute("myModel") MyModel model, SessionStatus status){
   ...
   //status.setComplete(); <-- Never gets called
} 
```

模型会永远留在会话中吗？它会被清理掉，还是会随着用户浏览网站而变得越来越大？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-02-17T15:54:50.670

关于控制器退出后是否清除会话属性存在很大的争议。

为了一劳永逸地澄清，我们可以查看**Spring MVC 3.1.0 RELEASE**源代码。

***org.springframework.web.bind.support.SessionAttributeStore***接口公开了以下方法：

```
void storeAttribute(WebRequest request, String attributeName, Object attributeValue);

Object retrieveAttribute(WebRequest request, String attributeName);

void cleanupAttribute(WebRequest request, String attributeName); 
```

默认实现是***org.springframework.web.bind.support.DefaultSessionAttributeStore***

通过在 Eclipse 中对*cleanupAttribute()执行“* *Open Call Hierarchy* ” ，我们可以看到该方法被 2 个不同的流程调用：

 *1) ***org.springframework.web.method.annotation.ModelFactory***

```
public void updateModel(NativeWebRequest request, ModelAndViewContainer mavContainer) throws Exception {

        if (mavContainer.getSessionStatus().isComplete()){
            this.sessionAttributesHandler.cleanupAttributes(request);
        }
        else {
            this.sessionAttributesHandler.storeAttributes(request, mavContainer.getModel());
        }

        if (!mavContainer.isRequestHandled()) {
            updateBindingResult(request, mavContainer.getModel());
        } 
    } 
```

2) ***org.springframework.web.bind.annotation.support.HandlerMethodInvoker***

```
public final void updateModelAttributes(Object handler, Map<String, Object> mavModel,
            ExtendedModelMap implicitModel, NativeWebRequest webRequest) throws Exception {

        if (this.methodResolver.hasSessionAttributes() && this.sessionStatus.isComplete()) {
            for (String attrName : this.methodResolver.getActualSessionAttributeNames()) {
                this.sessionAttributeStore.cleanupAttribute(webRequest, attrName);
            }
        }
...
} 
```

很明显，在这两种情况下，只有在*调用 this.sessionStatus.isComplete()*时才会删除 session 属性。

我研究了***DefaultSessionAttributeStore***的代码。在底层，它获取真正的**HTTP Session**对象来存储属性，因此它们可能会被同一会话中的其他控制器访问。

**所以不，在干净的 POST 之后不会删除会话属性。**

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-01T21:58:32.823

编辑＃2：请注意，此答案不再正确。请参阅下面[的@doanduyhai 的答案](https://stackoverflow.com/a/9331400/294657)。

编辑：请注意，这适用于 Spring 2.5 并且可能，但不一定确保 Spring 3.x 也是如此。仔细检查文档！

这与@Gandalf 所说的一致。

表单控制器对表单请求的生命周期进行建模，从最初查看表单到提交表单。提交表单后，表单控制器的工作就完成了，它将从会话中删除命令对象。

因此，要将命令对象保留在表单工作流之间的会话中，您需要手动管理会话。在干净的 POST 之后，该对象将从会话中删除。

简而言之，我相信 setComplete() 方法只是一种很好的做法，但不一定是必需的。

**编辑**：我刚刚查看了我的 Spring book 来确认这一点。我将引用它：

> 当不使用@SessionAttribute 时，将在每个请求上创建一个新的命令对象，即使由于绑定错误而再次呈现表单时也是如此。如果启用此注释，命令对象将存储在会话中以供后续使用，**直到表单成功完成。然后这个命令对象将从会话中清除。** 这通常在命令对象是一个持久对象时使用，该对象需要在不同请求之间保持相同以跟踪更改。

基本上这就是我上面所说的。它将它存储在会话中，直到您 A) 调用 setComplete() 或 B) 控制器成功完成 POST。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T15:09:55.573

你有什么理由想要这样做吗？

来自这个线程：[@SessionAttribute 问题](http://forum.springsource.org/showthread.php?t=49396)

> @SessionAttributes 的工作方式与 SimpleFormController 的 sessionForm 相同。在第一个请求和最后一个请求之间的持续时间内（大部分时间是初始 GET 和最终 POST），它将命令（或 @SessionAttributes 的任何对象）放入会话中。之后，这些东西被删除。

# java - 如何使用鼠标拖动事件在java小程序上绘制矩形

> ID：880753
> 
> 赞同：2
> 
> 时间：2009-05-19T02:40:46.350
> 
> 标签：java, applet, drawing, awt

我正在使用java。我想根据 mousedrag 事件绘制矩形。如果用户拖动鼠标，则小程序上的矩形应根据当前鼠标坐标增加或减少。我有以下代码。

在下面的代码中，我使用了 [b]SelectionArea[/b] 类，它扩展了我正在执行绘图操作的画布。我在这个类中使用 [b]image[/b] 变量进行双缓冲以减少闪烁并保存小程序的先前状态（即小程序的绘制内容）

但是如果我绘制第一个矩形，代码工作正常。如果我开始绘制第二个矩形，则先前绘制的矩形正在消失。我希望之前绘制的矩形出现在屏幕上

谁能告诉我如何解决这个问题。

```
import java.awt.*;
import java.applet.Applet;
import java.awt.event.*;

/* 
 * This displays a framed area.  When the user drags within
 * the area, this program displays a rectangle extending from
 * where the user first pressed the mouse button to the current
 * cursor location.
 */

public class RectangleDemo extends Applet {
SelectionArea drawingPanel;
Label label;

public void init() {
    GridBagLayout gridBag = new GridBagLayout();
    GridBagConstraints c = new GridBagConstraints();

    setLayout(gridBag);

    drawingPanel = new SelectionArea(this);
    c.fill = GridBagConstraints.BOTH;
    c.weighty = 1.0;
    c.gridwidth = GridBagConstraints.REMAINDER; //end row
    gridBag.setConstraints(drawingPanel, c);
    add(drawingPanel);

    label = new Label("Drag within the framed area.");
    c.fill = GridBagConstraints.HORIZONTAL;
    c.weightx = 1.0;
    c.weighty = 0.0;
    gridBag.setConstraints(label, c);
    add(label);
    drawingPanel.setVisible(true);

    validate();
}

public void paint(Graphics g){
    drawingPanel.repaint();
}

public void update(Graphics g){
    paint(g);
} 
```

}

```
class SelectionArea extends Canvas implements ActionListener, MouseListener,    MouseMotionListener{
Rectangle currentRect;
RectangleDemo controller;
//for double buffering
Image image;
Graphics offscreen;
public SelectionArea(RectangleDemo controller) {
    super();
    this.controller = controller;
    addMouseListener(this);
    addMouseMotionListener(this);        
}

public void actionPerformed(ActionEvent ae){
    repaintoffscreen();
}

public void repaintoffscreen(){
    image = createImage(this.getWidth(), this.getHeight());
    offscreen = image.getGraphics();
    Dimension d = getSize();
    if(currentRect != null){
        Rectangle box = getDrawableRect(currentRect, d);            

        //Draw the box outline.
        offscreen.drawRect(box.x, box.y, box.width - 1, box.height - 1);  
        //repaint();
    }
}

public void mouseEntered(MouseEvent me) {}
public void mouseExited(MouseEvent me){ }
public void mouseClicked(MouseEvent me){}
public void mouseMoved(MouseEvent me){}

public void mousePressed(MouseEvent me) {        
    currentRect = new Rectangle(me.getX(), me.getY(), 0, 0);
    repaintoffscreen();        
}

public void mouseDragged(MouseEvent me) {
    System.out.println("here in dragged()");
    currentRect.setSize(me.getX() - currentRect.x, me.getY() - currentRect.y);
    repaintoffscreen();    
    repaint();
}

public void mouseReleased(MouseEvent me) {
    currentRect.setSize(me.getX() - currentRect.x, me.getY() - currentRect.y);
    repaintoffscreen();  
    repaint();
}

public void update(Graphics g){
    paint(g);
}

public void paint(Graphics g) {
    g.drawImage(image, 0, 0, this);
}

Rectangle getDrawableRect(Rectangle originalRect, Dimension drawingArea) {
    int x = originalRect.x;
    int y = originalRect.y;
    int width = originalRect.width;
    int height = originalRect.height;

    //Make sure rectangle width and height are positive.
    if (width < 0) {
        width = 0 - width;
        x = x - width + 1;
        if (x < 0) {
            width += x;
            x = 0;
        }
    }
    if (height < 0) {
        height = 0 - height;
        y = y - height + 1;
        if (y < 0) {
            height += y;
            y = 0;
        }
    }

    //The rectangle shouldn't extend past the drawing area.
    if ((x + width) > drawingArea.width) {
        width = drawingArea.width - x;
    }
    if ((y + height) > drawingArea.height) {
        height = drawingArea.height - y;
    }

    return new Rectangle(x, y, width, height);
} 
```

}

另外，如果我在全屏模式下运行此代码，那么我会看到矩形仅在我释放鼠标后才出现在屏幕上。但我希望在拖动鼠标时矩形出现在屏幕上，它应该根据当前鼠标坐标改变它的尺寸。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T02:47:50.517

在家工作？

基本上你需要做的是：

1.  在鼠标按下时保持鼠标按下的坐标并重新绘制
2.  鼠标移动时保持当前鼠标坐标并重新绘制
3.  在鼠标向上时，取消鼠标向下坐标以指示没有矩形，然后重新绘制。
4.  在油漆上，绘制背景，然后在 mousedown 和 cur-mouse 坐标之间进行调整。

如果您不想保留背景图像，您可以使用 Graphics xor 函数做一个技巧，两次绘制相同的矩形将擦除旧的矩形，因此您可以使用它直接在图形对象上恢复旧图像。

编辑：代码异或用法示例：

```
public void paint(Graphics g)
{
   g.setXORMode(Color.black);
   // draw old rect if there is one. this will erase it
   // draw new rect, this will draw xored
   g.setDrawMode(); // restore normal draw mode
} 
```

Xor 有一个有趣的特性：

```
xor(xor(x)) = x 
```

所以对同一个像素进行两次异或运算可以恢复它的原始颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T03:32:31.423

有几个问题需要解决。

首先，关于只能绘制一个矩形，这是由于您的程序设计造成的。在您的代码中，每当`repaintoffscreen`调用该方法时，该`currectRect`字段都用于绘制一个矩形。但是，没有规定要继续保留过去制作的矩形。

保留过去矩形的一种方法可能是创建另一个字段，例如，`List<Rectangle>`用于存储过去矩形的 a。然后，当鼠标被释放时，`add`当前矩形到那个列表。

然后，为了让所有矩形`currentRect`和过去的矩形出现，`repaintoffscreen`不仅需要执行`getDrawableRect`和`offscreen.drawRect`使用 ，`currentRect`而且还需要使用存储在`List<Rectangle>`. （提示，使用`for`循环遍历列表。）

其次，关于直到释放鼠标按钮后才出现的矩形，而不是使用该`mouseDragged`方法，也许使用该`mouseMoved`方法以及检查鼠标按钮是否被按下可能是一种解决方法。（我想我过去在处理这种`mouseDragged`方法时也遇到了麻烦。）

[`MouseEvent`](http://java.sun.com/javase/6/docs/api/java/awt/event/MouseEvent.html)传递给该方法的`mouseMoved`参数可用于检查该[`getButton`](http://java.sun.com/javase/6/docs/api/java/awt/event/MouseEvent.html#getButton())方法是否按下了按钮：

```
public void mouseMoved(MouseEvent e)
{
    // Check if button1 is pressed.
    if (e.getButton() == MouseEvent.BUTTON1)
    {
        // Perform sizing of rectangle and off-screen drawing, and repaint.
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T05:23:18.960

我的问题是关于创建一个选择矩形反转鼠标点击位置，但是，最后我用这个方法做了这个：

```
...     //to set the selection area
    private int iniSelX;
    private int iniSelY;
    private int endSelX;
    private int endSelY;

    private JPanel myJPanel = new JPanel() {

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            g.setColor(Color.WHITE);
            g.fillRect(0, 0, this.getWidth(), this.getHeight());

            g.setColor(Color.red);
            g.drawLine(260, 5, 260, 260);

            g.setColor(Color.BLUE);

            //verify if go draw the rectangle
            if (iniSelX != 0 || endSelX != 0) {
                boolean revertX = iniSelX < endSelX;
                boolean revertY = iniSelY < endSelY;

                //Simple way
                //g.drawRect(iniSelX, iniSelY, endSelX - iniSelX, endSelY - iniSelY);

                //reverse way
                g.drawRect(revertX ? iniSelX : endSelX, revertY ? iniSelY : endSelY,
                        revertX ? endSelX - iniSelX : iniSelX - endSelX, revertY ? endSelY - iniSelY : iniSelY - endSelY);
            }
        }
    }; ...
        addMouseMotionListener(new MouseMotionListener() {

            @Override
            public void mouseDragged(MouseEvent m) {
                //update selection area
                endSelX = m.getX();
                endSelY = m.getY();

                repaint();
            }

            @Override
            public void mouseMoved(MouseEvent m) {
                repaint();
            }
        });

        addMouseListener(new MouseListener() {

 ...
            @Override
            public void mousePressed(MouseEvent e) {
               //start  drawing the selection
                iniSelX = e.getX() - 15;
                iniSelY = e.getY() - 20;
            }

            @Override
            public void mouseReleased(MouseEvent e) {
                //start  drawing the selection
                iniSelX = 0;
                iniSelY = 0;
                endSelX = 0;
                endSelY = 0;
            }

...
        });

    }

    public void log() {
        System.out.println("iniSelX" + iniSelX);
        System.out.println("iniSelY" + iniSelY);
        System.out.println("endSelX" + endSelX);
        System.out.println("endSelY" + endSelY);
    } ... 
```

我希望这很有用。

# java - 将分号文本转换为 Excel

> ID：880757
> 
> 赞同：0
> 
> 时间：2009-05-19T02:42:13.600
> 
> 标签：java, .net, excel

我需要将分号分隔的文件转换为 Excel。但是，必须从 Excel 文件中删除一些字段，并添加一些额外的字段。这些额外的字段是下拉字段。

有没有办法做到这一点？最好使用的编程语言是 Java，但也欢迎使用 Excel 宏的可能性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T02:58:45.690

我很确定你可以用香草 Excel 做到这一点。您可以进行全局搜索并将分号替换为逗号，然后以 CSV 格式打开或使用“文本到列”功能。

[编辑：我没有在 Java 中以编程方式完成此操作，但在 Perl 中，使用Text::xSV](http://search.cpan.org/~tilly/Text-xSV-0.18/lib/Text/xSV.pm)和[Spreadsheet::WriteExcel](http://search.cpan.org/~jmcnamara/Spreadsheet-WriteExcel-2.25/lib/Spreadsheet/WriteExcel.pm#dropdown)应该非常简单

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T11:02:00.107

我不确定如何使用 Excel 宏执行此操作，但对于 Java：

1.  使用 FileReader 读取文件
2.  使用带有“;”的 StringTokenizer 分隔字段的分隔符
3.  为每一行创建一个数组，其中包含一个代表每一行的自定义对象。该对象可以存储填充下拉框所需数据的数组
4.  使用 Apache POI 创建 Excel 电子表格（Stackoverflow 上有很多 POI 示例）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T02:49:03.710

你可以看看[opencsv](http://opencsv.sourceforge.net/)和[HSSF](http://poi.apache.org/spreadsheet/index.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T11:11:39.353

你有两个选择：

1.  使用[Apache POI](http://poi.apache.org/spreadsheet/)编写和自定义 XLS
2.  在 Excel 中创建一个示例电子表格，但将其另存为 HTML 页面。获取保存的 HTML 并将其用作数据的模板。您可以将输出（模板+数据）保存为带有 .xls 后缀的文件。即使它的内容是真正的 HTML，它也会正确打开。

如果您使用 CSV，您将无法获得其他功能，例如下拉菜单或样式。

# ruby - 如何在 Ruby 中构建类似顶级的 UI

> ID：880760
> 
> 赞同：0
> 
> 时间：2009-05-19T02:45:48.053
> 
> 标签：ruby, text, user-interface, interface, tui

我想构建一个基于文本的 UI 的应用程序，它类似于 Ruby 中的 Linux 命令“top”。我可以使用哪些工具包和/或技术来构建 UI？特别是我想要一个不断更新的控制台窗口区域，以及按键操作显示的能力。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T03:01:09.927

对于终端接口，请参见[http://ncurses-ruby.berlios.de/](http://ncurses-ruby.berlios.de/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T03:11:57.503

Ncurses 非常适合控制台应用程序，您可以找到许多语言的绑定（或仅使用 shell 脚本）。甚至还有一个被诅咒的 gtk ( [http://zemljanka.sourceforge.net/cursed/](http://zemljanka.sourceforge.net/cursed/) ) 虽然我认为它的工作已经停止了很长时间。

您没有提到您的平台，但是对于 OS/X，有一个很棒的小应用程序叫做 Geektool ( [http://projects.tynsoe.org/en/geektool/](http://projects.tynsoe.org/en/geektool/) )，它允许您将脚本输出放在桌面上。我使用一个小的 ruby​​ 脚本来生成我的顶级进程列表：

```
puts %x{uptime}

IO.popen("ps aruxl") { |readme|
    pslist = readme.to_a
    pslist.shift # remove header line
    pslist.each_with_index { |i,index|
      ps = i.split
      psh = { user: ps[0], pid: ps[1], pcpu: ps[2], pmem: ps[3],
              vsz: ps[4], rss: ps[5], tty: ps[6], stat: ps[7],
              time: ps[8], uid: ps[9], ppid: ps[10], cpu: ps[11], pri: ps[12], 
              nice: ps[13], wchan: ps[14], cmd: ps[16..ps.size].join(" ") }
      printf("%-6s %-6s %-6s %s", "PID:", "%CPU:", "%Mem", "Command\n") if index == 0
      printf("%-6d %-6.1f %-6.1f %s\n", 
        psh[:pid].to_i, psh[:pcpu].to_f, psh[:pmem].to_f, psh[:cmd]) if index < 10

    }

} 
```

（这可能会更好，但它是我编写的第一个 ruby​​ 脚本，因为它有效，所以我从未重新审视它来改进它——而且它不需要输入。无论如何，它可能有助于给你一些想法）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T11:59:53.190

有[stfl](http://svn.clifford.at/stfl/trunk/README)但我不知道是否维护了 ruby​​ 绑定。ncurses 可能是你最好的选择。

# asp.net - 在 Windows XP 上将应用程序映射添加到 IIS6 网站

> ID：880764
> 
> 赞同：0
> 
> 时间：2009-05-19T02:47:06.600
> 
> 标签：asp.net, iis-6, windows-xp

我正在尝试将应用程序扩展映射添加到在 Windows XP 上运行的 IIS6 中的网站。我的步骤如下：

主目录 > 配置 > 映射 > 添加

```
Executable: aspnet_isapi.dll
Extension: .xml
Verbs: All Verbs 
```

但是确定按钮总是灰色的。

这是 IIS6 在 XP 上的限制吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T04:37:21.900

您需要将其设置为：

```
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll 
```

（或者，从 .aspx 复制路径 - 您不能使用 ctrl 命令，而是右键单击文本框）

此外，您应该取消选择“检查文件是否存在”

# wcf - 通过网络发送接口定义（WCF 服务）

> ID：880765
> 
> 赞同：0
> 
> 时间：2009-05-19T02:47:26.990
> 
> 标签：wcf, entity-framework, interface, partial-classes

我有一个 WCF 服务，它生成负载实体框架对象（以及用于减轻负载的一些其他结构和简单类）并将它们发送到客户端应用程序。

我已经更改了 2 个类来实现一个接口，以便我可以在我的应用程序中将它们作为单个对象类型引用。很像这个例子： [是否可以强制实体框架生成的属性来实现接口？](https://stackoverflow.com/questions/523409/is-it-possible-to-force-properties-generated-by-entity-framework-to-implement-int)

但是，接口类型没有添加到我的 WCF 服务代理客户端 thingymebob 中，因为它没有在通过网络发送回的对象中直接引用。

因此，在我使用服务代理类的应用程序中，我无法转换或引用我的接口..

有什么我想念的想法吗？

这是一些示例代码：

```
//ASSEMBLY/PROJECT 1 -- EF data model

namespace Model
{
    public interface ISecurable
    {
        [DataMember]
        long AccessMask { get; set; }
    }

    //partial class extending EF generated class
    //there is also a class defined as "public partial class Company : ISecurable"
    public partial class Chart : ISecurable
    {
        private long _AccessMask = 0;
        public long AccessMask
        {
            get { return _AccessMask; }
            set { _AccessMask = value; }
        }

        public void GetPermission(Guid userId)
        {
            ChartEntityModel model = new ChartEntityModel();
            Task task = model.Task_GetMaskForObject(_ChartId, userId).FirstOrDefault();
            _AccessMask = (task == null) ? 0 : task.AccessMask;
        }
    }
}

//ASSEMBLY/PROJECT 2 -- WCF web service
namespace ChartService
{
    public Chart GetChart(Guid chartId, Guid userId)
    {
         Chart chart = LoadChartWithEF(chartId);
         chart.GetPermission(userId); //load chart perms
         return chart; //send it over the wire
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T21:44:53.507

接口不会在您的 WSDL 中作为单独的实体出现——它们只会将它们的方法和属性添加到公开它们的对象中。

您想要完成的任务可以使用抽象类来完成。这些将作为不同的实体出现。

祝你好运。让我们知道您决定如何继续。

# vb.net - 编辑选定列表视图项的项或子项值

> ID：880773
> 
> 赞同：2
> 
> 时间：2009-05-19T02:57:27.313
> 
> 标签：vb.net, listview

好的，所以我在一个表单上有一个列表视图，当按下按钮时，它会打开一个新表单，其中包含所选列表视图项的内容，它是一系列文本框中的子项。然后，用户可以更改文本框中的数据，然后按保存进行更改或取消以关闭窗口。我将使用什么命令将选定的列表视图项和子项更改为框中的任何内容？

这是填充框的代码：

```
 Private Sub Form_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Dim appeditcontents As String = main.passlist.SelectedItems(0).ToString
    Dim appstrlen As Integer = appeditcontents.Length()
    Dim apptotal As Integer = appstrlen - 16
    Dim usereditcontents As String = main.passlist.SelectedItems(0).SubItems(1).ToString
    Dim userstrlen As Integer = usereditcontents.Length()
    Dim usertotal As Integer = userstrlen - 19
    Dim passeditcontents As String = main.passlist.SelectedItems(0).SubItems(2).ToString
    Dim passstrlen As Integer = passeditcontents.Length()
    Dim passtotal As Integer = passstrlen - 19
    appedit.Enabled = False
    appedit.Text = main.passlist.SelectedItems(0).ToString.Substring(15, apptotal)
    useredit.Text = main.passlist.SelectedItems(0).SubItems(1).ToString.Substring(18, usertotal)
    passedit.Text = main.passlist.SelectedItems(0).SubItems(2).ToString.Substring(18, passtotal)
    End Sub 
```

有关清理此代码的任何指示也可能会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T04:26:11.613

[这个页面](http://social.msdn.microsoft.com/forums/en-US/vblanguage/thread/770cf727-0f5b-4047-85dd-faf31bdf3db4)看起来对你有帮助。

# asp.net - 命名 Dom 元素的 id 属性的最佳实践

> ID：880776
> 
> 赞同：20
> 
> 时间：2009-05-19T02:59:23.567
> 
> 标签：asp.net, javascript, naming-conventions

这与 DOM 元素的 id 属性的命名约定有关，我猜也是 name 属性。谈到 JavaScript，据我了解和所做的，除了类名外，总是使用驼峰式大小写。类是 Pascal 大小写的。

话虽如此，我主要在 ASP.NET 中进行开发，在这里我遇到了 id 属性的命名问题。在 ASP.NET 中，如果您将新的服务器控件拖放到页面中（我很少这样做，我是那种标记类型的人），默认名称总是 Pascal 大小写，因为它们需要符合 .NET 框架服务器端代码的命名准则。

因此，在命名 ASP.NET 服务器控件的 id 属性或仅命名标记中的元素时，我遵循将 id 属性命名为驼峰式的规则（Javascript 命名准则），但这与 .NET 命名准则冲突。

那么，第一，你们这些人通常为 DOM 元素中的 id 属性使用什么外壳，第二，在 ASP.NET 中开发的 .NET 人员如何命名 id 属性？

最重要的是，当我在标记中创建表单元素时，我通常将匈牙利符号用于文本输入，例如

```
<input type="text" id="txtUserName" /> 
```

或者对于像这样的复选框

```
<input type="checkbox" id="chkSelectAll" /> 
```

这肯定违反了 .NET 服务器端代码命名准则，也可能违反了 JavaScript 准则。

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-19T03:26:59.580

*   保持语义。使用完整、简单（最好是英文）的单词。不要试图想出一些花哨或技术性的东西，也不要描述它*是*什么——我们知道这一点。描述它*的作用*。描述目的增加了信息价值。

*   不要缩写任何东西！`BW_RCB01_SW`对几年前做我们 CSS 的团队来说意义重大，但现在对我来说没有任何意义，我必须向后工作以尝试翻译`BW_RCB01_SW`与我的目的相对应的内容，并记住该翻译或将其记录在某个地方。更好的？`blackwhite-boxtype1-bottomleft`. 它更长，但也不需要罗塞塔石碑。

*   保持全部小写并使用下划线或连字符。我更喜欢连字符，但这完全是一种偏好。使用连字符应该没有任何障碍，因为它们在 CSS 或 HTML 中没有保留，并且 ID 在所有其他语言中都被视为文字字符串。小写是所有经验 - 浪费了太多时间想知道为什么这种风格不适用哦。`pageContainerLeft`不一样`pageContainerleft`。

*   *确切地*确定该元素是什么，但仅此而已。认真考虑您在名称中嵌入的每条信息以及是否有必要。在您的示例中-您*需要*知道它是 ID 的复选框吗？不太可能。您已经知道您所指的元素是什么，因为它是唯一的 ID，并且无论如何您都必须针对该元素进行编码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T03:34:33.247

尽可能少地命名对象肯定有助于保持清洁。如果您可以通过命名父母并仅提及孩子来获得，那会更好（在我看来）。您获得的好处是在每个页面上呈现给客户端的 html 略少。

因为当我必须命名元素时，我更喜欢全小写，下划线表示法。我之前因为没有在 CSS 文件中正确处理我的情况而被欺骗了，所以如果我能及早将其算作一个问题，那将是一种解脱。

下划线是字符，而破折号可以解释为减号，所以这是另一个潜在的问题 - 只使用下划线是有意义的。例如，Flex 不接受带有以破折号命名的属性的 XML（我知道这些是值而不是属性；但仍然是一个安全的选择）。

我同意上述观点——没有元素类型或定位或颜色作为类/id。匈牙利符号 == 不好。对于确定什么是 ID 非常有用。我喜欢以对象特定的方式命名表单字段 -`user_login, user_email, user_address_state_id, user_address_country_id`等等，可能都显示在用户注册表单上。通常非表单字段的长度不足以容纳下划线，否则您可以重命名它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T05:09:27.977

信不信由你，但在使用某些 javascript 库时，我遇到了将连字符作为 id 名称和 css 类名称的问题。这是非常罕见的，但你显然想避免这样的事情。因此，我使用驼峰式大小写或下划线。您也可以使用下划线。

否则，一般规则是具有易于阅读和理解的有意义的名称。当涉及到“控件”时，请确保您遵循某种命名约定。就我个人而言，我更喜欢后缀而不是前缀（即 nameText 而不是 textName），但我尽量避免使用后缀，因为我发现它们太冗长了。

所以： 1\. 有意义的名字。2.避免后/前缀。3\. 避免缩写（即地址而不是地址）。4.慢慢来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T03:07:04.207

以下是一些命名指南，它们帮助我处理了 DOM 中的 id 和类：

*   不要在名称中包含类型（即，没有 txt 或 chk）。我可以更详细地使用 CSS 或 jQuery 选择该信息
*   在名称中使用下划线作为分隔符。连字符在其他语言中并不总是有效，并且驼峰式大小写在标记中有点难以阅读

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T03:12:04.087

我上一份工作中的一位 HTML 专家实际上建议用破折号分隔多字 ID

```
<input type="text" id="user-name" /> 
```

我很难记住原因——我再也无法访问那些内部标准文件了。不过，我知道这确实不能回答您关于 Pascal vs Camel 套管的问题。

我个人建议不要使用 HN - 我发现这是一种非常可恶的做法。如果您需要将复选框数组更改为选择元素，会发生什么情况？现在元素的 ID 已经嵌入了错误的语义。IMO，这不值得麻烦。

# uml - 示例结构的 UML 数据流图策略

> ID：880779
> 
> 赞同：0
> 
> 时间：2009-05-19T03:01:14.437
> 
> 标签：uml, diagram, dataflow

描述以下内容的最佳策略是什么：

1) A 类创建了 B 类和 C 类的实例 2) B 类能够通过 B 类中的指针与 D 类中的特定成员进行通信

提前感谢您的建议，因为我不知道合适的术语来描述它们，以便在互联网上搜索更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T03:14:15.813

有一种图称为“数据流图”，但这不是 UML 图。

显示 A 创建 B 和 C 的实例可以在 UML“序列图”中显示，它显示了事情发生的时间顺序（例如，A 的实例存在于时间 T0，在时间 T1 它创建了 B 的实例，并在时间 T2 创建 C) 的一个实例。

显示 B 有一个指向 D 的成员可以显示在 UML“类图”中，该图说明了一个或多个类的成员（方法和实例数据）。

但是，我认为 UML 没有“指向成员的指针”的符号……当您说“B 通过指向 D 中特定成员的指针与 D 类通信”时，我不确定您的意思：可以你请举一个例子（例如在源代码中）来说明这一点？

# java - 从数据库表生成 java 域对象

> ID：880785
> 
> 赞同：9
> 
> 时间：2009-05-19T03:05:52.320
> 
> 标签：java, eclipse, spring, spring-mvc, domain-driven-design

我可以知道在 Eclipse 中，是否有任何功能可以自动生成所有表关系在类中正确映射的域对象？

可以为我提供一些关于此的参考文章吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-19T03:14:53.317

[您可以使用Hibernate 之](http://en.wikipedia.org/wiki/Hibernate_(Java))类的东西来完成此操作

这个[用于 Eclipse 的插件集](https://www.hibernate.org/255.html)称为 Hibernate Tools for Eclipse and ANT 将为您完成大部分工作。

特别是它会进行逆向工程：Hibernate Tools 最强大的特性是一个数据库逆向工程工具，它可以在几秒钟内生成域模型类和 Hibernate 映射文件、带注释的 EJB3 实体 bean、HTML 文档甚至整个 JBoss Seam 应用程序！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-12-05T17:06:03.127

**Telosys 代码生成器**可以完成这种工作。它是一个**Eclipse 插件**，它使用数据库模式来创建用于生成 Java 代码的光照模型。

GitHub 上有一些可用的预定义模板（用于 JPA、POJO、文档、Spring MVC 等）

见[http://www.telosys.org](http://www.telosys.org)

和[http://marketplace.eclipse.org/content/telosys-tools](http://marketplace.eclipse.org/content/telosys-tools)

模板：[https ://github.com/telosys-templates-v3](https://github.com/telosys-templates-v3)

关于使用 Telosys 生成代码的文章：

*   [https://modeling-languages.com/telosys-tools-the-concept-of-lightweight-model-for-code-generation/](https://modeling-languages.com/telosys-tools-the-concept-of-lightweight-model-for-code-generation/)
*   [https://dzone.com/articles/telosys-a-code-generation-tool-by-laurent-guerin](https://dzone.com/articles/telosys-a-code-generation-tool-by-laurent-guerin)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T05:09:39.020

您可以通过 Eclipse 或 ANT 使用 Hibernate Tools 3.0.0.GA 直接从数据库表中自动生成休眠域实体。

请参阅此处的教程： [http://docs.jboss.org/tools/3.0.0.GA/en/hibernatetools/html_single/index.html](http://docs.jboss.org/tools/3.0.0.GA/en/hibernatetools/html_single/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-28T06:03:43.737

我有一个解决方案给你，即创建自动生成域对象，所有表关系在类中正确映射......试试***Dal4j***是的，你可以在**[sourceforge.net/p/dal4j/wiki/](http://sourceforge.net/p/dal4j/wiki/)**中找到它DAL4j 是一个命令行和框架工具可用于将 MySQL 或 SQLServer 数据库模式反向工程为一组 JPA 实体 Bean。

DAL4j 可用于存在现有数据库模式但应用程序使用 JPA 以外的技术与数据库交互的情况。DAL4j 可以提供一种简单的方法来将您的代码库从其他技术（例如 JDBC 或 Hibernate）迁移到 JPA。

生成的 bean 可以是 1 或两种类型：Simple 或 Framework。简单 bean 是由您的应用程序使用 JPA 语义管理的标准 pojo 类。框架生成的 pojo 使用 DAL4j 框架 DAO 泛型来简化 CRUD 操作。

DAL4j 提供了可选的钩子，允许您集成必须在数据库中加密的数据字段的加密/解密。

最后，DAL4j 提供了一组通用类，可用于简化会话 Bean 的创建，会话 Bean 使用生成的实体执行 CRUD 操作。

我想你会发现这篇文章是可行的......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T03:29:13.660

您需要一个 [对象关系映射](http://en.wikipedia.org/wiki/Object-relational_mapping)，其中 Hibernate 在 Java 中是最流行的。hibernate 工具通常更适合使用带注释的类并使用它们来生成模式，反之亦然，这听起来就像你正在做的那样。如果您使用的是遗留数据库模式，我怀疑您会做很多手工注释。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-10T13:40:42.433

如果您使用 grails，您可以使用 GRAG [http://sourceforge.net/projects/grag生成域对象](http://sourceforge.net/projects/grag)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-29T23:07:36.083

我使用 eclipse 进行 java 开发，但在生成域实体时，我使用 Net beans。

创建一个 EJB 模块，然后右键单击并生成实体。您需要设置数据库，也可以直观地选择所需的表。

问候 Lyju

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-24T14:28:20.833

这感觉像是人们经常遇到的另一个相当普遍的问题。

下面的链接链接到一个足够详细的博客，让我第一次学习如何从数据库模式生成实体。 [http://shengwangi.blogspot.com/2014/12/how-to-create-java-classes-from-tables.html](http://shengwangi.blogspot.com/2014/12/how-to-create-java-classes-from-tables.html)

以防万一，以下链接指的是 eclipse 帮助页面。此链接永不过期： [http ://help.eclipse.org/juno/index.jsp?topic=%2Forg.eclipse.jpt.doc.user%2Ftasks021.htm](http://help.eclipse.org/juno/index.jsp?topic=%2Forg.eclipse.jpt.doc.user%2Ftasks021.htm)

我下载了 JBoss，但无法理解它是如何工作的。我认为我使用的插件是 Hibernate Tools，但我不确定，因为我没有为此目的安装任何新插件。我正在为 EE 使用 Eclipse Luna。

希望这可以帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-01-04T21:18:55.833

我厌倦了手动编码这种东西，所以我制作了一个工具来从模式生成模型、dao 和 dao 实现。它面向 Spring Boot，仅在 MySQL 上进行了测试，但对于那些不想使用 Hibernate 而只想使用 jdbc/sql 和 JdbcTemplate，或者只想为表生成带有 getter/setter 的 POJO 的人，那么这可能成为开始编码的东西。

称为 Jassd（用于数据库生成器的 Java 自动化 Spring 源代码），我很高兴介绍这个工具：[https ://github.com/aforslund/jassd](https://github.com/aforslund/jassd)

# api - 什么是 OpenID“自动登录”？

> ID：880791
> 
> 赞同：7
> 
> 时间：2009-05-19T03:08:50.613
> 
> 标签：api, authentication, openid

什么是 OpenID“自动登录”？

直到今天，我才从技术意义上听过这个术语。它突然出现在 Facebook 的营销博客中，提及他们与谷歌的新协议。

需要明确的是，他们声称除了 Google 之外几乎没有其他 OpenID 提供商实现 OpenID“自动登录”，因此 Facebook 目前不支持其他 OpenID。

这甚至存在吗？

仅供参考，是的，这是一个编程问题。我真的很想看到这个功能的***API 文档***。如果您熟悉它，请发布它的链接。谢谢！！

Facebook 公告： http: [//www.insidefacebook.com/2009/05/18/facebook-launches-openid-support-users-can-now-login-with-a-gmail-account/](http://www.insidefacebook.com/2009/05/18/facebook-launches-openid-support-users-can-now-login-with-a-gmail-account/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-19T03:24:46.120

我很确定这只是 OpenID 的“即时模式”的一个应用：

立即模式允许您尝试验证用户而无需他们离开您的站点。如果在您第一次尝试验证用户时，他们选择始终允许您验证他们并提供稍微简化的登录体验，这通常是可能的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T03:26:47.817

人们对此感到兴奋的原因是它比仅使用 OpenID 更流畅的用户界面体验。

新系统首先由 Plaxo 开发人员演示，现在提供更多信息，请参阅[http://code.google.com/apis/accounts/docs/OpenID.html](http://code.google.com/apis/accounts/docs/OpenID.html)

TechCrunch 的博客文章：[http ://www.readwriteweb.com/archives/google_openid_updates_ui.php](http://www.readwriteweb.com/archives/google_openid_updates_ui.php)

现在的问题，afaik，是该方法的记录很差，所以它主要出现在支付 JanRain corp 的网站上。为他们的实施。

# c++ - 在 Visual Studio 中运行小型 C++ 程序而不创建项目

> ID：880803
> 
> 赞同：17
> 
> 时间：2009-05-19T03:14:49.383
> 
> 标签：c++, visual-studio, build

有没有办法在 Visual Studio 中构建/运行小型 C++ 程序而不创建项目？

例如，如果我有一个文件，我可以在没有项目的情况下`hello.cpp`编译它吗？`hello.exe`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-23T04:47:08.933

[GMan](https://stackoverflow.com/questions/880803/running-small-c-programs-in-visual-studio-without-creating-projects/880861#880861)拥有一个“沙盒”项目的想法是一个很好的想法，因为它允许轻松地尝试多文件测试。我称我为“cppTest”。

但是，如果您只想编译您碰巧打开的任何 C 或 C++ 文件，只需创建一个简单的“外部工具”。实际上，它并不像它应该的那么简单。

首先，创建一个将设置编译器环境并运行编译器的批处理文件。类似于以下内容：

```
@rem - runcl.cmd
@rem     a batch file to drive simple VC9 compiles
#rem
@echo off

set LIBRARIES=kernel32.lib user32.lib advapi32.lib shlwapi.lib oleaut32.lib
set WIN32_WINNT=0x0500

call "%ProgramFiles%\Microsoft Visual Studio 9.0\Common7\Tools\vsvars32.bat"

echo Visual C/C++ 2008 (VC 9.0) Compile...
set CC="%ProgramFiles%\Microsoft Visual Studio 9.0\VC\bin\cl.exe" /Zi /EHsc -D_WIN32_WINNT=%WIN32_WINNT% %1 /link /incremental:no %LIBRARIES%
echo %CC%
%CC% 
```

在“工具/外部工具...”对话框中，添加一个新项目并填写以下字段：

*   标题：`&Compile File`
*   命令：`c:\path\to\runcl.cmd`
*   论据：`$(ItemPath)`
*   初始目录：`$(ItemDir)`

*   选中“使用输出窗口”框

现在您可以使用“工具”菜单中的“编译文件”项来编译当前打开的文件。您甚至可以双击输出窗口中的错误，将您带到有错误的行。

这有一些限制，您可以通过修改批处理文件或使用 Visual Studio 宏来解决其中的一些限制（我对 VS 宏不太熟悉）。

1.  如果您还没有保存文件，编译将针对最近的保存运行。外部工具配置中没有强制保存的选项。
2.  如果您运行该命令并且没有活动的 C 或 C++ 文件，则批处理文件将失败
3.  批处理文件可能还有很多其他区域会混淆

像这样的批处理文件的好处是您还可以使用它来帮助将编译器集成到各种编辑器中，这些编辑器可以让您调用外部工具，如 UltraEdit、Zeus Editor、EditPad Pro、PSPad、Programmer's Notepad 等。

如果你喜欢，我已经发布了一个批处理文件，我用它来将几个编译器集成到上面的编辑器中。此批处理文件处理多个编译器，包括从版本 6 到版本 9 的各种 MSVC 编译器、Digital Mars、MinGW 和 Comeau 编译器（要使用的编译器由附加参数选择）。批处理文件非常复杂（不幸的是，这是具有任何复杂性的 Windows 批处理文件的本质）。但我发现它使从各种编辑器运行这些东西变得非常简单。我可以快速点击我分配给编译器的几个键来针对 5 个不同的编译器编译单个文件，这样我就可以轻松地测试兼容性。

除了我发现它对我自己的目的有用之外，我不做任何承诺——如果你也这样做，那就太好了。否则，不要使用它...

*   [https://gist.github.com/mburr/3308168](https://gist.github.com/mburr/3308168)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-19T03:39:55.080

在实际的 IDE 中，我认为不可能运行小程序，您必须像 Matt 建议的那样使用命令行。

我对这个问题的解决方案是，我的计算机上有一个名为“sandbox”的项目，它只有一个 main.cpp，我可以在那里乱七八糟。

它让我在这里和那里尝试一些东西，但我永远不必继续开始一个新项目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-11T20:27:54.867

一种方法是构建一个通用项目，例如沙盒、测试甚至 Hello World，然后添加和删除源文件以更改您想要执行的操作。您甚至可以删除旧的源文件，然后添加新的以重新开始。这既快速又简单，同时可以返回已构建的程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-10-14T08:19:39.670

如果您有一个 hello.cpp 文件并且希望它编译成一个 hello.exe 文件而不在 code::blocks 或 Visual Studio 中创建项目，您可以查看：[https ://courses.cs.washington.edu/courses /cse373/99au/unix/g++.html](https://courses.cs.washington.edu/courses/cse373/99au/unix/g++.html)

关于如何在 Windows 上通过 MinGW 安装 g++ 的指南：http: [//www.codebind.com/cprogramming/install-mingw-windows-10-gcc/](http://www.codebind.com/cprogramming/install-mingw-windows-10-gcc/)

然后，您将能够通过打开命令提示符编译单个 hello.cpp 文件，导航到您放置它的文件（hello.cpp 文件）并运行命令，该命令`g++ -o hello hello.cpp`应该会生成一个名为“hello .exe”在与您的 hello.cpp 相同的位置。

请注意，这不是 Visual Studio 的一部分，但如果您想保持简单，它是一种仅编译单个 .cpp 文件的简单方法。

# c# - 如何知道 WebBrowser 是否导航错误页面？

> ID：880811
> 
> 赞同：5
> 
> 时间：2009-05-19T03:21:53.083
> 
> 标签：c#

例如，我们导航到[http://www.ggg111.com](http://www.ggg111.com)，这是一个错误 URL。但在 WebBrowser 中，它会显示一个错误页面：

```
找不到网页
 HTTP 400  
   最可能的原因：
地址可能有输入错误。
如果您单击了链接，则该链接可能已过期。

   你可以尝试什么：
     重新输入地址。  

     返回到前一页。
     转到并查找您想要的信息。  

```

如何知道 WebBrowser 是否导航错误页面？

还要检查这个： [https ://sso.youshang.com/sso/userAuthnAction.do1](https://sso.youshang.com/sso/userAuthnAction.do1)

```
HTTP 状态 404 - /sso/userAuthnAction.do1
类型状态报告
消息 /sso/userAuthnAction.do1
描述 请求的资源 (/sso/userAuthnAction.do1) 不可用。

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T06:14:38.093

基于此控件： http: [//www.codeproject.com/KB/cpp/ExtendedWebBrowser.aspx](http://www.codeproject.com/KB/cpp/ExtendedWebBrowser.aspx)

有 NavigateError 函数，在导航过程中发生错误时触发。这是我修改后的代码：

首先添加事件参数类：

```
 public class NavigateErrorArgs : EventArgs
{
    public object StatusCode { get; set; }

    public NavigateErrorArgs()
            : base()
    { }

    public NavigateErrorArgs(object statusCode)
            : base()
    {
       this.StatusCode = statusCode;
    }
} 
```

然后在 ExtendedWebBrowser 类中添加委托和事件：

```
 public delegate void NavigateErrorHandler(object sender, NavigateErrorArgs e);
public event NavigateErrorHandler NavigateError;

protected void OnNavigateError(NavigateErrorArgs e)
{
  if (NavigateError != null)
      NavigateError(this, e);
} 

```

并修改类 WebBrowserExtendedEvents 中的方法：

```
 public void NavigateError(object pDisp, ref object URL, ref object frame, ref object statusCode, ref bool cancel)
{
    _Browser.OnNavigateError(new NavigateErrorArgs(statusCode));
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2014-07-06T16:38:50.813

不确定，但是，....试试看，...

```
string check = webBrowser1.DocumentText;
        if (check.IndexOf("The webpage cannot be found") > 1)
        {
            MessageBox.Show("ERROR OCCURED");
            //what else you want to do, do here!!!
        } 
```

这将搜索给定的文本，如果找到将执行进一步的代码

# wordpress - 无法在 Wordpress 模板中获取 get_the_tags()

> ID：880825
> 
> 赞同：2
> 
> 时间：2009-05-19T03:27:32.120
> 
> 标签：wordpress, wordpress-theming

我正在使用此代码在我的 wordpress 帖子中获取主题的标签

```
`<?php
$posttags = get_the_tags();
if ($posttags) {
  foreach ($posttags as $tag) {
     $tagnames[count($tagnames)] = $tag->name;
  }
  $comma_separated_tagnames = implode(", ", $tagnames);
  print_r($comma_separated_tagnames);
}
?>` 
```

问题是它正在返回“所有帖子”的标签，而不仅仅是单个帖子，我认为问题是如果帖子没有标签 - 它只是插入标签。

任何人都可以帮助修改这个：

> 1.  它仅返回帖子的标签 - 不是所有标签
> 2.  如果帖子没有标签，则不返回任何内容

PS -[可以在这里查看 wordpress 文档](http://codex.wordpress.org/Template_Tags/get_the_tags)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-07-05T13:49:56.150

```
<footer class="entry-footer">
                    <?php //get all tags for the post
                    $t = wp_get_post_tags($post->ID);
                    echo "<p class='tags-list'>TAGGED WITH: ";
                    foreach ($t as $tag) {
                        $tag_link = get_tag_link($tag->term_id);
                    echo "<a href='$tag_link' class='used-tag' rel='tag'>".($tag->name)."</a>&nbsp;";
                    }
                    echo "</p>";
                    ?>
                    </footer> 
```

这就是我所做的，显示循环中每个帖子的标签。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2010-03-08T00:42:57.347

尝试使用：

```
<?php the_tags(); ?> 
```

在“[循环](http://codex.wordpress.org/The_Loop)”内部。

[功能参考](http://codex.wordpress.org/Template_Tags/the_tags)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-08-13T18:16:00.297

好吧，我希望这可以帮助某人，我在这个问题上停留了大约一个小时，试图获取我的帖子的标签“所以我可以将它与 twitter 共享链接” the_tags(); 函数没用，因为我在 WP 循环 get_the_tag_list() 之外使用它；对我来说很完美，因为它可以包含帖子 ID，

```
$postid = $wp_query->post->ID; 

$posttags =  strip_tags( get_the_tag_list( ' ', '', '', "$postid" ) ) ; 
```

^^ 上面的代码我剥离了 html 代码以获得没有 href 链接的标签名称。

这是功能用例：-

```
get_the_tag_list( string $before = '', string $sep = '', string $after = '', int $id ) 
```

# performance - 编程语言的性能多久成为一个重要问题？

> ID：880826
> 
> 赞同：3
> 
> 时间：2009-05-19T03:27:39.220
> 
> 标签：performance, programming-languages

似乎我经常听到人们批评某些编程语言，因为它们“性能不佳”，或者因为某些其他语言总体上“更快”（不一定适用于特定应用程序）。然而，我的经验和教育告诉我，每当你遇到性能问题时，至少可能会发生以下情况之一：

1.  瓶颈不在于 CPU，而在于其他设备，例如网络或硬盘驱动器。
2.  性能不佳是由您的算法引起的，而不是由您使用的语言引起的。

我的总体印象是，编程语言本身的速度在绝大多数情况下几乎无关紧要，严重的数据处理问题除外。即使在这些情况下，我相信您也可以使用混合方法并仅对 CPU 密集型部分使用较低级别的语言，这样您就不会完全失去更抽象语言的好处。

你同意吗？编程语言的速度在大多数情况下是微不足道的，还是批评者有权指出语言性能问题？

我希望这个问题不要太主观，但在我看来应该有一个相对客观的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T03:37:10.833

在库、操作系统等中，性能可能是一个严重的问题。但是，我相信超过 90% 的时间原始性能是无关紧要的。

在许多情况下，更重要的是时间。任何垃圾收集语言在这方面都会有一些不可预测性，这使得它们不适合嵌入式和实时设计空间。

GC 和“慢”语言的重叠相当大，因此当真正的问题是时间不一致时，您可能会看到由于速度原因而打折的语言。

有一些分配/线程/等。允许垃圾收集同时还保证系统部分运行时的方案，例如[Realtime Java](http://www.rtsj.org/)，尽管我个人还没有在任何地方看到它使用。

简短的回答：大多数时候语言的速度是无关紧要的（在合理的范围内），语言的选择是基于熟悉度和可用的库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T03:35:45.370

这不可能如此广泛地回答。这就像问大型发动机是否在汽车中是一种浪费。嗯，对某些人来说，是的。对于其他人，根本不是。介于两者之间。

有无数因素在起作用。你的目标环境是什么？最终用户部署还是服务器？假设我们正在讨论服务器的 Web 开发和编码。众所周知，RoR 是（相对）缓慢的。相比之下，.NET 相当快。但 RoR 还具有 .NET 无法与之竞争的 RAD 品质。

*   昨天让您的应用程序启动并运行比可扩展性更重要吗？
*   您的商业模式是在您为页面提供服务的几毫秒内，还是在您进入市场的那一刻起生死存亡？
*   您的 TCO 和应用程序架构是否支持横向扩展或纵向扩展？你甚至期望需要扩大规模吗？

这些只是架构师在做出平台/语言决策时必须回答的一小部分问题。速度重要吗？有时。如果我计划编写一个最终需要扩展到每秒数千个事务的 LoB 服务，并且它将部署在企业环境中，我可能会选择 .NET。如果我对 Web 2.0 业务有一个想法，比如销售[Twitter T 恤](http://twitshirt.com/)，我昨天需要利用这个想法，而且我知道在准备之前我可能不会因为足够多的业务而让网站倒闭。

老实说，这过度简化了一个非常复杂的问题，但希望能说明不可能简单地“说”它是否重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T03:38:21.177

令人惊讶的是，一个系统的性能是编程语言、它正在执行的系统、系统正在执行的操作以及它所依赖的外部资源（网络、磁盘、慢行打印机等）的组合。

如果你的系统很慢，而不是猜测，测试它。

如果计算中有任何“规则”，那就是“测试你的假设”。其他一切都是粗略的指导方针。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T23:07:11.910

您的问题非常广泛，所以我将尝试给出一个更狭窄的答案：

*   除非有充分的理由不这样做，否则项目的语言应始终从那些有助于项目团队提高生产力和生产可轻松适应未来需求的可靠软件的语言中选择。权衡通常有利于具有自动内存管理的高级语言。

    注意有*很多*很好的理由做出其他选择，例如与当前产品和库的兼容性。

*   有时会发生当程序太慢时，加速它的最快和最简单的方法是用新语言重写程序（或关键部分）。这种情况最常发生在解释实现语言并编译新语言时。

    示例：通过重写邮件标题的词法分析，我从[OSBF-Lua垃圾邮件过滤器中获得了大约 4 倍的加速。](http://osbf-lua.luaforge.net)通过从 Lua 重写为 CI，不仅可以从解释转换为编译，而且还能够消除对每个输入字符的数组边界检查。

如前所述，要回答您的问题，语言性能*本身***并不是**一个问题。

 ** * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T12:47:58.170

我认为这是一个很好的问题。要回答这个问题，需要有一个考虑性能的通用框架，所以让我尝试提供一个。（其中一些听起来很明显，但请耐心等待。）

为简单起见，让我们只考虑一个简单的应用程序案例，它有特定的工作要做，开始，然后结束，你关心的是挂钟时间。让我们假设一个标准的 CPU 循环率和一个单处理器。

持续时间由时间片流（例如纳秒）组成。要完成这项工作，需要最少的时间，并且通常大于零。没有要求的最长时间。如果一个程序花费的时间超过了最小纳秒数，那么严格来说，这些纳秒中的一些花费是不必要的（即出于不良原因）。

因此，为了优化程序的执行时间，有必要找出它所花费的、不必花费的纳秒（即没有充分理由的）并将它们删除。

做到这一点的一种方法是，如果可能，单步执行程序并跟踪每个步骤为什么要执行该步骤。如果原因不好，则有机会删除步骤。

另一种方法是从程序的执行中随机选择纳秒，并询问其原因。例如，程序计数器可以告诉你程序在做什么，但调用堆栈可以告诉你为什么。为了有充分的理由花费纳秒，调用堆栈上的每条调用指令都必须有充分的理由。如果调用堆栈上的任何指令没有充分的理由，那么就有机会进行优化。事实上，该指令在调用堆栈上的时间量就是将其删除所节省的时间量。

在某些高度异步、消息驱动或解释的软件中，调用堆栈可能无法提供足够的信息。在这种情况下，要回答为什么要花费给定的纳秒可能会更加困难。它可能需要检查更多的状态信息，而不仅仅是调用堆栈。例如，在解释器中，可能还需要检查正在解释的程序的堆栈。但是，硬件调用堆栈通常确实提供了足够的信息，因此检查它是有用的。

现在，试着回答你的问题。

有“热点”之类的东西。这是一小组地址，通常位于调用堆栈的底部。在该代码中花费的纳秒可能有也可能没有充分的理由。

有“性能问题”之类的东西。这是一条指令，通常可以解释为什么要花费纳秒，但这没有充分的理由。这样的指令可能处于热点中。也可以是子程序调用指令。（不能两者兼有。）它可能是发送消息以供稍后处理的指令，没有充分的理由花费。为了优化软件，正在寻找这样的指令（而不是函数）。

松散地说，语言要么被编译成机器语言，要么被解释。解释型语言通常比编译型语言慢 1 或 2 个数量级，因为它们不断地重新确定自己需要做什么。但是，粗略地说，这只是发生在热点中的性能问题。如果一个程序将所有时间都花在调用已编译的库函数或等待 I/O 完成上，那么它的执行速度可能并不重要，因为大部分纳秒时间都花在了其他原因上。

现在，当然，原则上任何语言或程序都可能是高度非最优的，但就编译器而言，对于热点代码，它们大多都相当不错，给或取大约 30%。如果涉及后台进程，例如垃圾收集，则会增加开销，但这取决于程序生成垃圾的速率。

综上所述，语言的速度在热点代码中很重要，但在其他地方则无关紧要。当通过消除所有其他性能问题来优化程序时，如果编译器/解释器实际看到热点代码，那么语言的速度很重要。

# iphone - 我的复选框绘图有什么问题？

> ID：880833
> 
> 赞同：1
> 
> 时间：2009-05-19T03:30:42.597
> 
> 标签：iphone

我构建了一个 UIButton 子类，它是一个非常基本的复选框。一切正常（例如，我得到了我期望的事件，drawRect 方法在我期望的时候被调用，等等），但我的图像没有绘制。我检查了我的图像不是零并且我的图像不同。

代码：

```
-(void)awakeFromNib {
    [super awakeFromNib];
    [self addTarget:self action:@selector(buttonClick) forControlEvents:UIControlEventTouchUpInside];
    self.state=YES;
}

-(void) buttonClick {
    self.state = !self.state;
    [self setNeedsDisplay];
}

-(void)drawRect:(CGRect)rect {
    UIImage *img = nil;
    if (self.state) {
        img = [self backgroundImageForState:UIControlStateSelected];
    }
    else {
        img = [self backgroundImageForState:UIControlStateNormal];
    }
    [img drawInRect:rect];
} 
```

在绘制之前检查“img”的值：

```
Printing description of img:
<UIImage: 0x52a710>
(gdb) continue

Printing description of img:
<UIImage: 0x52a5d0> 
```

背景图像正在NIB中设置。如果我更改 IB 中的选定状态，我会看到正确的图像出现。我还从调用中返回了一个有效的图像（如果我尝试获取未在 NIB 中设置的 imageForState，我不会这样做）。

子类的原因是我需要一个复选框。UIButton 不这样做，并且 UISwitch 对于除了最实用的视图之外的所有视图都非常丑陋。

想法？

谢谢。

tj

编辑：添加了子类的所有代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T03:35:46.867

你在哪里设置 backgroundImageForState？你确定这是正确的图像？iPhone OS 可能会默认为您提供透明（空白）图像。

其次，我不会使用传入的“rect”参数来绘制图像。这只是告诉您它希望您重绘的区域，而不一定是其他任何东西。而是使用

`CGRectMake(0, 0, img.size.width, img.size.height)`

或类似的东西。

最后，你为什么要做自定义绘图？我做了一些非常相似的事情，你绝对不需要子类化和实现`drawRect`. UIButton 为图像内置了一组极其丰富的选项，包括“突出显示”和“选定”图像，它们将通过用户交互自动绘制。让我们知道您需要完成什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T07:25:22.553

仅仅因为 UIImage 不是 nil 并不意味着它包含图像数据。

检查文件名的大小写。
我已经这样做了好几次了：

@"CheckBox.png" 和 @"checkbox.png" 是 iPhone 的 2 个不同名称。

看来您可能也在做一些过早的优化。

对于我的第一个选项，我不会深入到 drawRect: 中。

使用 UIButton 子类（您只需要子类来跟踪状态）。在 IB 中设置按钮并将其放置在您想要的位置。将按钮连接到下面的方法，只需单击即可交换图像：

```
- (IBAction)toggle:(id)sender{

    MyButtonSubClass *aButton = (MyButtonSubClass*)sender;

    [aButton toggleChecked];

    if(aButton.checked)
        [aButton setImage:checkedImage forState:UIControlStateNormal];
    else
        [aButton setImage:uncheckedImage forState:UIControlStateNormal];

} 
```

可选地，您不能子类化 UIButton 并在控制器中跟踪状态

# sharepoint - SharePoint 2007 - 此 URL 的内容被服务器排除，因为没有索引属性

> ID：880836
> 
> 赞同：1
> 
> 时间：2009-05-19T03:32:04.700
> 
> 标签：sharepoint, search, attributes, indexing

是否有人遇到过搜索爬虫忽略 aspx 页面的错误？我收到这些页面的以下警告消息：“此 URL 的内容被服务器排除，因为没有索引属性”。

任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T03:37:41.363

使用以下设置页面检查网站的搜索可见性。 [http://[mywebsiteurl]/_layouts/srchvis.aspx](http://[mywebsiteurl]/_layouts/srchvis.aspx)

“从不索引此站点上的任何 aspx 页面”的值将导致日志消息。注意：关于搜索爬网，单个列表也可以“关闭”。 [http://[mywebsiteurl]/_layouts/advsetng.aspx?List=[list](http://[mywebsiteurl]/_layouts/advsetng.aspx?List=[list) GUID] （或者更简单地转到列表设置 -> 高级设置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T15:21:02.830

感谢您的回复纳特。我弄清楚了这个问题。

我们有两个版本的网站，win auth 和 forms auth。经过一番挖掘后，我发现其中一个用户控件正在破坏 win auth 版本 - 因此页面也是如此。它在表单身份验证中运行良好。我忘记在 win auth 的 web.config 中添加一个 appsettings 条目。所以我猜测当爬虫进入页面时，看到页面被破坏 - 它没有爬取它并在爬取日志中记录了警告消息。

修复用户控件后，页面按预期爬取。

# java - Maven、Proguard 和组装问题

> ID：880839
> 
> 赞同：19
> 
> 时间：2009-05-19T03:32:23.983
> 
> 标签：java, maven-2, plugins, assemblies, proguard

我正在尝试让 Maven 与 ProGuard 一起工作。

我想要实现的是以下内容：

*   在我的源文件上运行 ProGuard 并生成混淆类

*   创建一个引用主类的清单文件，以便我可以将其作为 jar 执行

*   解压所有相关的库 jar，并创建一个包含所有这些的巨大 jar。此文件应仅联系 .class 和 .xml 文件。

*   将它们组装成包含各种 README.txt 文件等的 .zip 和 tar.gz 文件。

到目前为止，我有这样的事情：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>2.2</version>
            <configuration>
                <archive>
                    <manifest>
                        <mainClass>com.class.path.MainClass</mainClass>
                    </manifest>
                </archive>
                <includes>
                    <include>**/*.class</include>
                    <include>**/*.xml</include>
                </includes>
            </configuration>
        </plugin>

        <plugin>
            <groupId>com.pyx4me</groupId>
            <artifactId>proguard-maven-plugin</artifactId>
            <configuration>
                <options>
                    <option>-allowaccessmodification</option>
                </options>
                <obfuscate>true</obfuscate>
                <injar>classes</injar>
                <outjar>${project.build.finalName}.jar</outjar>
                <outputDirectory>${project.build.directory}</outputDirectory>
                <proguardInclude>src/main/assembly/proguard.conf</proguardInclude>
                <libs>
                    lib/rt.jar</lib>
                </libs>
            </configuration>
            <executions>
                <execution>
                    <phase>process-classes</phase>
                    <goals>
                        <goal>proguard</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>

        <plugin>
            <artifactId>maven-assembly-plugin</artifactId>
            <executions>
                <execution>
                    <id>assembly</id>
                    <phase>package</phase>
                    <goals>
                        <goal>assembly</goal>
                    </goals>
                    <configuration>
                        <descriptors>
                            <descriptor>
                                src/main/assembly/bin.xml
                            </descriptor>
                        </descriptors>
                    </configuration>
                </execution>
            </executions>
        </plugin> 
```

但我没有快乐。任何人都可以给我任何模糊的指示吗？

在此先感谢，马特

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-20T07:51:02.100

这是对我有用的配置

```
<plugin>
    <groupId>com.pyx4me</groupId>
    <artifactId>proguard-maven-plugin</artifactId>
    <executions>
        <execution>
            <phase>package</phase>
            <goals>
                <goal>proguard</goal>
            </goals>
        </execution>
    </executions>
    <configuration>
        <obfuscate>true</obfuscate>
        <options>
            <option>-allowaccessmodification</option>
            <option>-keep public class com.class.path.MainClass { public *; public static *; }</option>
        </options>
        <injar>${project.build.finalName}.jar</injar>
        <outjar>${project.build.finalName}-small.jar</outjar>
        <outputDirectory>${project.build.directory}</outputDirectory>
        <libs>
            <lib>${java.home}/lib/rt.jar</lib>
            <lib>${java.home}/lib/jsse.jar</lib>
        </libs>
        <addMavenDescriptor>false</addMavenDescriptor>
    </configuration>
</plugin> 
```

最终的 jar 是 finalName-small.jar

# mainframe - 主机上的 Changeman - 每一步是什么意思？

> ID：880844
> 
> 赞同：0
> 
> 时间：2009-05-19T03:34:44.010
> 
> 标签：mainframe, change-management

我目前正在尝试在大型机上推广 Changeman 中的软件包。目前看来，我必须遵循一系列咒语。不幸的是，我不记得魔法咒语。我需要先了解发生了什么，然后才能跟进。那么，Changeman 涉及什么，以下是什么意思：Stage、Checkout、Audit，它们是做什么的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-08T20:33:26.200

ChangeMan严格但公平！:-)

不过说真的。ChangeMan 确实需要一些时间来适应，但之后它确实使开发过程更加统一和简化。

阶段：
在女巫开发阶段告诉包是。
最重要的是：
DEV 用于“开发中”
FRZ 用于“冻结”（锁定以进行更改并生成 FTP/复制脚本）
AUD 用于“已审核”（见下文）
BAS 用于“基线”（当前生产版本）

审计：
意味着对您所做的更改（包含在包中）进行检查，以查看在生产代码方面是否存在有害和/或有问题的问题。就像对界面的更改。然后所有使用该接口的程序也必须更改。

签出：
与其他版本/源代码控制系统一样，是签出代码以便其他人无法签出的方法。

问候
           西格斯特

# jquery - 为 load 事件回调中的每个新元素设置不同的 id

> ID：880848
> 
> 赞同：0
> 
> 时间：2009-05-19T03:36:18.663
> 
> 标签：jquery, events, callback, css-selectors, closures

编辑了我原来的问题

将 id 设置为新添加的元素或者我使用函数中的参数 noteid 时，问题是相同的。结果是，如果这个函数得到循环，每个元素都会得到相同的 id。

如何为每个新添加的元素设置不同的 id ？？？

就像现在一样，提交事件中的值对于每个元素都是相同的。如果我必须循环此函数以根据数据库条目创建多个注释，则仅记住最后添加的 noteid 并且每个元素都使用相同的 id。

你可以看到如果你看到[页面](http://www.woonbel.nl)会发生什么 首先你必须通过单击带有箭头的图标来创建两个笔记然后删除顶部的一个然后刷新页面。你会看到第二个被删除了。

```
newnote(tbnoteid){

    $('.wrappertbnote:last').load('tbnote.html .paneltbnote', function() { 
       var t = this;
       var tt= $(t).children(1).children("form").children("#frmnoteid");
        $(tt).attr('id' , tbnoteid);

        $(".frmremovetbnote:last").submit(function(){   
             var idvalue = $(tt).attr('id');

             $.post("tbnotesact.php",{
           noteid: tbnoteid,
           action: "remove",
           time: timestamp
           }, function(xml) { 
```

谢谢，理查德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T12:18:20.443

你必须记住这个函数是从另一个函数循环而来的！你可以从我的页面看到

我也发现[了这个](http://jquery-howto.blogspot.com/2009/03/only-last-element-is-boundinsertedetc.html#comment-form)关于我相信的同一个问题的评论，但我不明白解决方案

我必须测试一下

我不知道如何测试它

我通过删除加载方法和绑定提交事件解决了这个问题也许jquery处理起来变得复杂了

相反，我使用 prepend 方法卸载负载，并使用带有 live 的普通点击事件

向其中添加变量也容易得多。和 php 的 echo 差不多

# java - 永久增加java堆大小？

> ID：880855
> 
> 赞同：49
> 
> 时间：2009-05-19T03:38:13.097
> 
> 标签：java, size, heap-memory, jvm-arguments

有没有办法可以在我自己的计算机上为 jvm 设置默认堆大小？我想将其设置为 1g，因为我总是在运行自定义程序，这些程序总是在默认 jvm 大小中达到超额点。

我只是不想每次从命令行运行我的 java 应用程序时都要记住输入 -XmX1g ......

必须有一种管理方式才能做到这一点吗？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-10-02T10:00:40.953

显然，`_JAVA_OPTIONS`也适用于 Linux：

```
$ export _JAVA_OPTIONS="-Xmx1g"
$ java -jar jconsole.jar &
Picked up _JAVA_OPTIONS: -Xmx1g 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-19T03:50:58.347

对于 Windows 用户，您可以添加一个名为 _JAVA_OPTIONS 的系统环境变量，并在那里设置堆大小值。JVM 应该能够从 _JAVA_OPTIONS 中获取虚拟机选项。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2017-06-01T13:00:35.427

这对我有用：

```
export _JAVA_OPTIONS="-Xmx1g" 
```

重要的是你没有空间，因为对我来说它不起作用。我建议只是复制和粘贴。然后我跑了：

```
java -XshowSettings:vm 
```

它会告诉你：

> 拿起_JAVA_OPTIONS：-Xmx1g

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-19T03:48:34.037

你在运行什么平台？..
如果它的unix，也许添加

```
alias java='java -Xmx1g' 
```

到 .bashrc （或类似的）工作

编辑：将 XmX 更改为 Xmx

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-01T12:58:01.053

如果平台是 Linux，那么在 bash_profile 中添加一个条目会有所帮助。

```
vim ~/.bash_profile 
```

然后加

```
export _JAVA_OPTIONS="-Xmx4g" 
```

# ruby-on-rails - 在 Rails 迁移中，是否可以指示新添加的列应该在表中现有列之前或之后？

> ID：880871
> 
> 赞同：6
> 
> 时间：2009-05-19T03:43:15.757
> 
> 标签：ruby-on-rails, migration

假设我在 Rails 迁移中创建了一个表，指定省略 ID 列：

```
create_table :categories_posts, :id => false do |t|
  t.column :category_id, :integer, :null => false
  t.column :post_id, :integer, :null => false
end 
```

后来我决定要添加一个 ID 列作为主键，所以我创建了一个新的迁移：

```
class ChangeCategoriesToRichJoin < ActiveRecord::Migration
  def self.up
    add_column :categories_posts, :id, :primary_key
  end

  def self.down
    remove_column :categories_posts, :id
  end
end 
```

但是当我迁移后查看表格时，它看起来像这样：

```
category_id
post_id
id 
```

id 列位于表中的最后一个位置，而通常 id 列将位于第一个位置。

有没有办法更改 ChangeCategoriesToRichJoin 迁移以坚持在表中的 category_id 列之前创建 id 列？

还是我需要删除表并在“创建表”定义中添加列？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T03:31:50.973

使用`:after => :another_column_name`，例如：

```
change_table :users do |t|
  t.integer :like_count, :default => 0, :after => :view_count
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T03:47:41.163

我自己无法按顺序排列列，但是使用 Rails，您可以回滚，更改旧迁移文件以按您想要的顺序添加新列，然后重新迁移旧迁移，包括新字段. 它并不完全理想，但是可以轻松迁移和回滚，如果您的强迫症足够需要列顺序，它就可以工作。:P

我不是专家，但我已经阅读了很多 Rails 文档（最近也是如此），并且想不起为此找到了解决方案。

# c# - 有没有办法截取用户的 Windows 桌面？

> ID：880878
> 
> 赞同：15
> 
> 时间：2009-05-19T03:47:40.960
> 
> 标签：c#, windows, desktop, screenshot

我想在我的应用程序中为用户提供他们桌面的缩小屏幕截图。

**有没有办法截取当前用户的 Windows 桌面？**

我正在用 C# 编写，但如果有其他语言的更好解决方案，我愿意接受。

澄清一下，我需要一张 Windows 桌面的截图——那只是壁纸和图标；没有应用程序或任何有焦点的东西。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-19T03:52:30.860

您正在寻找[Graphics.CopyFromScreen](http://msdn.microsoft.com/en-us/library/fw1kt6f9.aspx)。创建一个大小合适的新 Bitmap，并将 Bitmap 的 Graphics 对象屏幕坐标传递给要复制的区域。

还有[一篇文章](http://csharpnet.blogspot.no/2007/01/snap-it-how-to-take-screen-shot-using.html)描述了如何以编程方式拍摄快照。

**对编辑的回应**：我误解了您所说的“桌面”是什么意思。如果您想为桌面拍照，您必须：

1.  首先使用 Win32API （发送`MIN_ALL`消息）[最小化所有窗口](https://stackoverflow.com/questions/785054/minimizing-all-open-windows-in-c/786506)
2.  拍摄快照
3.  然后撤消所有最小化（发送`MIN_ALL_UNDO`消息）。

* * *

**更好的方法**是不要干扰其他窗口，而是直接从桌面窗口复制图像。[User32 中的 GetDesktopWindow](http://msdn.microsoft.com/en-us/library/ms633504(VS.85).aspx)将返回桌面句柄。获得窗口句柄后，获取它的设备上下文并将图像复制到新的位图。

[CodeProject](http://www.codeproject.com/KB/system/snapshot.aspx)上有一个很好的例子，说明如何从中复制图像。在“捕获窗口内容”部分中查找有关获取和创建设备上下文的示例代码。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-19T04:12:06.597

我的印象是，您正在拍摄实际桌面的照片（带有壁纸和图标），仅此而已。

1) 使用 COM 在 Shell32 中调用 ToggleDesktop()
2) 使用 Graphics.CopyFromScreen 复制当前桌面区域
3) 调用 ToggleDesktop() 恢复之前的桌面状态

编辑：是的，调用 MinimizeAll() 是好战的。

这是我一起整理的更新版本：

```
 /// <summary>
    /// Minimizes all running applications and captures desktop as image
    /// Note: Requires reference to "Microsoft Shell Controls and Automation"
    /// </summary>
    /// <returns>Image of desktop</returns>
    private Image CaptureDesktopImage() {

        //May want to play around with the delay.
        TimeSpan ToggleDesktopDelay = new TimeSpan(0, 0, 0, 0, 150);

        Shell32.ShellClass ShellReference = null;

        Bitmap WorkingImage = null;
        Graphics WorkingGraphics = null;
        Rectangle TargetArea = Screen.PrimaryScreen.WorkingArea;
        Image ReturnImage = null;

        try
        {

            ShellReference = new Shell32.ShellClass();
            ShellReference.ToggleDesktop();

            System.Threading.Thread.Sleep(ToggleDesktopDelay);

            WorkingImage = new Bitmap(TargetArea.Width,
                TargetArea.Height);

            WorkingGraphics = Graphics.FromImage(WorkingImage);
            WorkingGraphics.CopyFromScreen(TargetArea.X, TargetArea.X, 0, 0, TargetArea.Size);

            System.Threading.Thread.Sleep(ToggleDesktopDelay);
            ShellReference.ToggleDesktop();

            ReturnImage = (Image)WorkingImage.Clone();

        }
        catch
        {
            System.Diagnostics.Debugger.Break();
            //...
        }
        finally
        {
            WorkingGraphics.Dispose();
            WorkingImage.Dispose();
        }

        return ReturnImage;

    } 
```

调整以适应多个显示器场景（尽管听起来这对您的应用程序来说应该很好）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T04:28:15.263

您可能会考虑通过 p/invoke使用[GetDesktopWindow ，然后获取设备上下文并拍摄快照。](http://msdn.microsoft.com/en-us/library/ms633504(VS.85).aspx)[这里](http://www.dreamincode.net/forums/showtopic34831.htm)有一个非常详细的教程。这可能比扰乱现有的窗户更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T07:45:24.260

在应用程序运行或使用其他桌面之前，您始终可以通过桌面切换在 Windows 启动时捕获屏幕截图。看看这里： http: [//www.codeproject.com/Articles/7666/Desktop-Switching](http://www.codeproject.com/Articles/7666/Desktop-Switching) 切换到其他桌面，拍照并记住你不需要显示它只需创建它“桌面”

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-20T14:31:55.330

所有以前的答案都是完全错误的（**最小化应用程序是荒谬的**）
只需使用 SHW api：*一行*代码（桌面位图被缓存，api 只是将它传送到你的 HDC ......）

# rest - REST 媒体类型爆炸

> ID：880881
> 
> 赞同：48
> 
> 时间：2009-05-19T03:47:42.317
> 
> 标签：rest

在尝试使用 REST 架构风格重新设计现有应用程序时，我遇到了一个我想称之为“媒体类型爆炸”的问题。但是，我不确定这是否真的是一个问题或 REST 的固有优势。为了解释我的意思，请看下面的例子

我们应用程序的一小部分如下所示：

集合集合->项目集合->项目

即顶层是集合的集合，并且这些集合中的每一个又是项目的集合。

此外，每个项目都有 8 个属性，可以单独读取和写入。尝试将上述层次结构公开为 RESTful 资源会给我留下以下媒体类型：

```
application/vnd.mycompany.collection-of-collections+xml
application/vnd.mycompany.collection-of-items+xml
application/vnd.mycompany.item+xml 
```

此外，由于每个项目都有 8 个可以单独读取和写入的属性，因此会产生另外 8 种媒体类型。例如，一个项目的“值”属性的一种这样的媒体类型是：

```
application/vnd.mycompany.item_value+xml 
```

正如我之前提到的，这只是我们应用程序的一小部分，我预计需要以这种方式公开几个不同的集合和项目。

我的问题是：

1.  拥有这些大量的媒体类型是不是我做错了什么？
2.  避免这种媒体类型爆炸的替代设计方法是什么？

我也知道上面的设计是高度精细的，尤其是暴露了项目的各个属性并为每个属性设置了单独的媒体类型。然而，粗化意味着我最终会通过网络传输不必要的数据，而实际上客户端只需要读取或写入项目的单个属性。您将如何处理这样的设计问题？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-19T12:15:16.783

减少所需媒体类型数量的一种方法是使用定义的媒体类型来保存其他媒体类型的列表。这可以用于您的所有收藏。通常，列表往往具有一致的行为集。你可以滚动你自己的 vnd.mycompany.resourcelist 或者你可以重用类似[Atom 集合](http://bitworking.org/projects/atom/draft-ietf-atompub-protocol-04.html#collections_intro)的东西。

对于像 vnd.mycompany.item 这样的特定资源表示，您可以做什么很大程度上取决于您的客户的特征。它在浏览器中吗？你能做代码下载吗？您的客户端是富 UI，还是数据处理客户端？

如果客户端要进行特定的数据处理，那么您几乎需要坚持使用精确的媒体类型，您最终可能会得到大量的媒体类型。但是从好的方面来看，如果您使用 SOAP，您将拥有的媒体类型将少于名称空间！

请记住，媒体类型是您的合同，如果您的应用程序需要与客户端定义大量合同，那就这样吧。

但是，我不会定义合约来交换单个属性值。如果您觉得有必要这样做，那么您在设计中做错了其他事情。分布式界面设计需要有大量的对话，而不是喋喋不休的对话。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-07-11T04:52:46.997

我想我终于从[Ian Robinson 的演讲](http://www.infoq.com/presentations/robinson-restful-enterprise)中得到了对上述问题的澄清，并认为我应该在这里分享。

最近，我在[Jim Webber](http://jim.webber.name/2008/11/23/61766710-3def-4dd9-9e36-b8d3147d14b1.aspx)的博客文章中看到了“***用于帮助调整超媒体引擎的媒体类型、用于结构的模式***”的声明。然后我发现了 Thoughtworks的[Ian Robinson的这个](http://iansrobinson.com/)[演讲](http://www.infoq.com/presentations/robinson-restful-enterprise)。这个演示文稿是我遇到的最好的演示文稿之一，它提供了对媒体类型和模式语言的角色和责任的非常清晰的理解（整个演示文稿是一种享受，我强烈推荐给所有人）。尤其要注意标题为“您选择了应用程序/xml，您是最佳人选”的*幻灯片*。和“自定义媒体类型”。Ian 清楚地解释了模式和媒体类型的不同角色。简而言之，这是我从 Ian 的演讲中得出的结论：

 *媒体类型描述包括识别超媒体控件并定义适用于该类型资源的方法的处理模型。识别超媒体控件意味着“我们如何识别链接？” 在 XHTML 中，链接是基于标签来识别的，而 RDF 有不同的语义。媒体类型帮助识别的下一件事是哪些方法适用于给定媒体类型的资源？一个很好的例子是 ATOM (application/atom+xml) 规范，它对超媒体控件提供了非常丰富的描述；他们告诉我们链接元素是如何定义的？以及当我们取消引用 URI 时我们可以期望能够做什么，因此它实际上告诉了我们可以期望能够应用于资源的方法。*媒体类型描述的一部分或*不*包含在媒体类型描述中，但作为实际表示的适当模式的一部分提供，即媒体类型规范不一定对表示的结构做出任何规定。*

 *那么这对我们意味着什么？只是我们不需要单独的媒体类型来描述我在原始问题中描述的每个资源。整个应用程序只需要一种媒体类型。这可能是一个全新的自定义媒体类型或重用现有标准媒体类型的自定义媒体类型，或者更好的是，简单的标准媒体类型可以在我们的应用程序中重用而无需更改。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-06-06T21:56:04.800

在我看来，这是 REST 概念的薄弱环节。作为一种架构和界面风格，REST 非常出色，Roy F. 和其他人所做的工作大大提高了最新技术水平。但是标准媒体类型可以传达（不仅仅是表示）的内容有上限。

为了让人们理解和使用你的 REST-ish API，他们需要理解数据的**含义**。有媒体类型讲述大部分故事的 API；例如，如果您有一个文本到语音的 API，输入媒体类型是 text/plain，输出媒体类型是音频/mp4，那么熟悉该主题的人可能会做。文本输入，音频输出，在这种情况下可能就足够了。

但是许多 API 不能仅通过媒体类型来传达它们的大部分含义。假设您有一个处理机票的 API。输入和输出将主要是数据。每个 API 的输入和输出的媒体类型可以是 application/json 或 application/xml，因此媒体类型不会传输很多信息。因此，您将查看输入和输出中的各个字段。也许有一个字段叫做“价格”。是美元还是便士？美元还是其他货币？我不知道如果没有（a）非常描述性的名称，如“price_pennies_in_usd”或（b）文档，用户将如何回答这些问题。更不用说格式约定了。是提供或不提供破折号的帐号，字母必须全部大写等。

当我们处于客户端不需要对数据的语义理解的情况下，这是一回事。效果很好。浏览器可以直观地呈现任何兼容的文档，并与任何兼容的资源进行交互，这一事实非常棒。这基本上就是“媒体”用例。

但是当客户端（或者实际上是客户端背后的开发人员/用户）需要理解数据的语义时，情况就完全不同了。 ***数据不是媒体***。除了记录数据之外，没有办法解释数据的所有现实意义和微妙之处。这是“数据”用例。

REST 的过度学术定义适用于媒体用例。它不起作用，对于其他用例，需要补充一些非纯但有用的东西，比如文档。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T03:58:56.673

您正在使用媒体类型来传达应存储在表示本身中的数据的详细信息。因此，您可以只有一种媒体类型，例如“application/xml”，然后您的 XML 表示将如下所示：

```
<collection-of-collections>
    <collection-of-items>
        <item>
        </item>
        <item>
        </item>
    </collection-of-items>
    <collection-of-items>
        <item>
        </item>
        <item>
        </item>
    </collection-of-items>
</collection-of-collections> 
```

如果您担心发送太多数据，请将 JSON 替换为 XML。另一种节省写入和读取字节数的方法是使用 gzip 编码，它可以减少大约 60-70%。除非您有超高性能的需求，否则其中一种方法应该适合您。（为了获得更好的性能，您可以使用非常简洁的手工字符串，甚至可以使用自定义二进制 TCP/IP 协议。）

**编辑**您的担忧之一是：

> 使[表示]粗糙意味着我最终将通过网络传输不必要的数据，而实际上客户端只需要读取或写入项目的单个属性

在任何 Web 服务中，发送消息都会产生相当多的开销（每个 HTTP 请求的起始行和请求标头可能会花费数百字节，每个 HTTP 响应也是如此，如[本例所示](http://www.http.header.free.fr/http.html)）。所以一般来说，你*希望*有更少粒度的表示。因此，您将编写您的客户端来请求这些更大的表示，然后将它们缓存在一些方便的内存数据结构中，您的程序可以从中多次读取数据（但请确保遵守服务器设置的 HTTP 到期日期）。将数据写入服务器时，您通常会结合对内存数据结构的一*组*更改，然后将更新作为单个 HTTP PUT 请求发送到服务器。

[您应该获取 Richardson 和 Ruby 的RESTful Web Services](https://rads.stackoverflow.com/amzn/click/com/0596529260)的副本，这是一本关于如何设计 REST Web 服务的真正优秀的书，并且比我更清楚地解释了事情。如果您使用 Java，我强烈推荐[RESTlet](http://www.restlet.org/)框架，它非常忠实地模拟了 REST 概念。Roy Fielding定义 REST 原则的[USC 论文也可能会有所帮助。](http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-20T23:56:48.797

应该很少创建媒体类型，并且应该投入时间来确保格式能够在变化中存活下来。

由于您依赖于 xml，因此没有什么特别的原因不能创建一种媒体类型，前提是该媒体类型在一个来源中进行了描述。

选择 ATOM 而不是拥有一种支持多个根元素的主机媒体类型并不一定会给您带来任何好处：您仍然需要在确定是否存在足够的信息来处理请求之前，在特定操作的上下文中开始阅读消息。

所以我建议您可以愉快地拥有一种媒体类型，由一个根元素表示，并使用模式语言来指定可以包含哪些元素。

换句话说，像 xsd 这样的语言可以让您键入媒体类型以支持多个根元素之一。application/vnd.acme.humanresources+xml 描述一个可以采用或作为根元素的 xml 文档本身并没有错。

因此，要回答您的问题，请创建尽可能少的媒体类型，方法是询问您放入媒体类型文档中的内容是否可以被开发人员理解和实施。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T21:35:18.290

除非您打算注册这些媒体类型，否则您应该选择[现有的 mime 类型](http://www.iana.org/assignments/media-types/)之一，而不是尝试制作自己的格式。正如 Jim 提到的[，application/xml 或 text/xml](http://www.rfc-editor.org/rfc/rfc3023.txt)或[application/json](http://www.ietf.org/rfc/rfc4627.txt)适用于 REST 设计中传输的大部分内容。

作为对 Darrel 的回复，这里是[Roy 的完整帖子](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)。您不是想通过创建自己的 mime 类型来定义类型化资源吗？

Suresh，为什么不是 HTTP+POX Restful？

# c++ - 优化提升无序映射和集合，C++

> ID：880882
> 
> 赞同：4
> 
> 时间：2009-05-19T03:47:46.217
> 
> 标签：c++, c++11

我将解析 60GB 的文本并在地图中进行大量插入和查找。我刚开始使用 boost::unordered_set 和 boost::unordered_map 当我的程序开始填充这些容器时，它们开始变得越来越大，我想知道为这些容器预先分配内存是否是个好主意。类似 mymap::get_allocator().allocate(N); ?

还是我应该让他们自己分配和找出增长因素？代码看起来像这样

```
boost::unordered_map <string,long> words_vs_frequency, wordpair_vs_frequency;   
boost::unordered_map <string,float> word_vs_probability, wordpair_vs_probability,
           wordpair_vs_MI;                  
//... ... ...                                   

N = words_vs_frequency.size();
long   y =0; float MIWij =0.0f, maxMI=-999999.0f;
for (boost::unordered_map <string,long>::iterator i=wordpair_vs_frequency.begin(); 
                     i!=wordpair_vs_frequency.end(); ++i){
if (i->second >= BIGRAM_OCCURANCE_THRESHOLD)
    {
    y++;
    Wij = i->first;
    WordPairToWords(Wij, Wi,Wj);
    MIWij =  log ( wordpair_vs_probability[Wij] /
             (word_vs_probability[Wi] * word_vs_probability[Wj]) 
            );

    // keeping only the pairs which MI value greater than 
    if (MIWij > MUTUAL_INFORMATION_THRESHOLD)
        wordpair_vs_MI[ Wij ] = MIWij;
    if(MIWij > maxMI )
        maxMI = MIWij; 
    }

   } 
```

提前致谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-19T06:02:53.147

根据[文档](http://www.boost.org/doc/libs/1_37_0/doc/html/boost/unordered_map.html)`unordered_set`，两者`unordered_map`都有一个方法

```
void rehash(size_type n); 
```

重新生成哈希表，使其至少包含`n`存储桶。（听起来它对`reserve()`STL 容器做了什么）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T04:06:12.487

我会尝试两种方式，这将让您生成硬数据，显示一种方法是否比另一种更好。我们可以整天猜测哪种方法是最佳的，但与大多数性能问题一样，最好的办法是尝试一下，看看会发生什么（然后修复实际需要修复的部分）。

话虽如此，Boost 作者似乎非常聪明，所以它很可能会按原样正常工作。您只需要测试并查看即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T03:50:09.327

老实说，我认为您最好编写自己的分配器。例如，您可以使用一个调用方法创建一个分配器，该方法`preallocate(int N)`将保留 N 个字节，然后`unordered_map::get_allocator()`用于您的所有乐趣。此外，使用您自己的分配器，您可以告诉它一次抓取大块。

# php - 关闭mysql连接重要吗？

> ID：880885
> 
> 赞同：97
> 
> 时间：2009-05-19T03:48:22.850
> 
> 标签：php, mysql

关闭mysql连接效率是否至关重要，还是在php文件运行后自动关闭？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-05-19T03:51:05.023

从[文档](http://us.php.net/function.mysql-connect)中：

> 注意：一旦脚本执行结束，到服务器的链接将关闭，除非它通过显式调用 mysql_close() 提前关闭。

如果您的脚本在获取结果并检索到完整的结果集后需要执行大量处理，那么您绝对应该关闭连接。如果你不这样做，当 Web 服务器被大量使用时，MySQL 服务器可能会达到它的连接限制。如果在脚本接近尾声之前您不能关闭 MySQL 连接，虽然没有必要明确地这样做，但它会更干净。

我不确定 fastcgi 如何影响事物。 [一页](http://blog.andreineculau.com/2009/01/fastcgi-on-dreamhost/)声称支持fastcgi的PHP构建将创建持久连接，即使对于mysql_connect也是如此。这与文档相矛盾，因为当进程而不是脚本结束时连接关闭。我建议使用 mysql_close()，而不是对其进行测试。实际上，我建议使用[PDO](http://www.php.net/pdo)（如果可用）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-19T03:55:31.723

很关键吗？没那么多

是否被认为是一种好的做法？是的。

我不明白你为什么不想关闭它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-19T03:52:30.970

使用 cgi 之类的东西时，完全没有必要关闭 mysql 连接，因为它们会在脚本执行结束时自动关闭。当使用像 mod_perl 等持久性技术来维护请求之间的连接时，跟踪连接、全局变量等很重要。

基本上，对于持久性数据，请自行清理。对于琐碎的非持久数据，无论如何，当请求完成时，它都会消失。无论哪种方式，最佳做法是始终关闭您的连接。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-19T18:17:15.053

脚本完成执行后立即关闭。除非您打开了持久连接。理想情况下，您应该在完成后立即释放资源（此处为连接）。除非您很有可能在执行过程中很快再次需要它。

如果您在单个数据库服务器后面，连接池或使用持久连接（如果这就是您的意思）是一个好主意。但是，如果有更多服务器并且您正在负载平衡，则可能会损害工作分配。通常，一些客户端运行繁重的查询，而其他客户端运行较轻的查询。因此，如果在 n 次以上使用相同的连接，则某些服务器会负载过重，而另一些服务器会利用率不足。考虑使用更小的 ttls 和可变的连接池大小。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-04-11T14:32:09.913

大多数 CMS 在请求结束时关闭 MySQL 连接，这真的没有意义，因为 PHP 无论如何都会这样做。

但是，如果您有一个不再需要连接的脚本，在脚本中间说，然后发生其他繁重的活动，那么明确关闭连接是个好主意。这将释放一些资源。

现在，关于关闭连接的好处已经说了很多，但是关于不关闭连接的好处几乎没有人说。本质上，如果您没有在脚本结束时关闭连接，那么您确实在节省一些资源。想象一个 Web 应用程序（或任何应用程序）每秒接收 100 次网页浏览。因此，每一秒，您都需要调用`mysqli_close`100 次——这意味着在每一秒中，您有 100 次不必要的往返数据库服务器来关闭打开的连接。从性能的角度来看，这是纯粹的开销，因为 PHP 将在脚本完成时检查打开的连接并关闭这些连接，并且可能是因为一切都发生得如此之快，以至于 PHP 看不到你有关闭这些连接并将尝试再次关闭它们。

注意：上面的答案假设您没有使用持久连接（持久连接未在任何主要 CMS 中使用）。

# css - css 无序列表菜单类似于 IE 中的“步骤”

> ID：880903
> 
> 赞同：2
> 
> 时间：2009-05-19T03:57:07.310
> 
> 标签：css, internet-explorer, menu

我的菜单在好的浏览器上运行良好。代码都是有效的（到目前为止！）。在 IE 中，虽然它看起来像一个楼梯，但每个菜单项都比它的左邻居低几个像素。它应该是水平的。

[请看这里](http://www.digiflipconcepts.com/daycare/templates/daycare/)

[替代文字 http://www.digiflipconcepts.com/images/bbdc-menu-anomaly.jpg](http://www.digiflipconcepts.com/images/bbdc-menu-anomaly.jpg)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T04:21:20.127

适用`display: inline`于`ul.menu li`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T04:10:52.523

我的第一个猜测是 li 元素的填充或边距。看看这是否有帮助：

```
li {
  padding: 0;
  margin: 0;
} 
```

（说话太早了，看起来你确实有那个）

乍一看，您似乎正在设置以下内容：

```
ul.menu li a {
  display: block
  padding: 11px 0 0;
} 
```

看看删除 11px 填充是否有帮助

# asp.net-mvc - 我的 ASP.NET MVC 应用程序贫血

> ID：880906
> 
> 赞同：4
> 
> 时间：2009-05-19T03:59:12.930
> 
> 标签：asp.net-mvc, model-view-controller, design-patterns, domain-driven-design

我阅读了 Fowlers 对贫血域的描述，我相信我有这些症状。我有几个对象什么都不做，只是在不同的包中传递数据。我还有几个服务几乎可以处理所有行为（执行功能）。我开始忘记我为什么和我做了什么以及在哪里可以找到某些任务。

该应用程序做我想要的，但我想知道我是否只是有一个伪装的程序程序。也许我永远无法摆脱过去的程序编程？我是不是该？

在 MVC 中，我应该取消我的服务并将该责任分散到我的控制器和模型对象吗？

我很欣赏 MVC 概念和 DDD 概念之间的类比...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T21:42:43.343

我认为控制器应该相对较薄。他们的工作主要是接受请求，将其委托给适当的应用程序服务并确定正确的操作结果。

如果您觉得您的域实体过于贫乏，我建议您检查您的服务并确定该功能是否属于实体。我发现这是我从 DDD 开始的最大问题，我会将所有行为推送到服务，而不是批判性地思考这是否更适合实体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T18:56:13.787

Why don't you try the Evans book as suggested in one of your previous questions?

# python - Python的应用

> ID：880917
> 
> 赞同：2
> 
> 时间：2009-05-19T04:03:09.033
> 
> 标签：python

**相对业余的程序员**可以使用哪些 Python 应用程序？例如，Ruby 有用于构建 Web 应用程序的 Rails。Python有哪些很酷的应用程序？

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-19T04:11:47.280

Google App Engine 为使用 Python 开发（尤其是部署）Web 应用程序提供了出色的支持（具有多种可能的框架，其中 Django 可能是最适合“相对业余爱好者”的框架）。除了网络应用程序，Blender 允许您使用 Python 进行 3D 图形，Poser 用于涉及移动类人图形的应用程序，SPSS 用于统计，scipy 和 Enthought 发行版中包含的许多其他工具支持 Python 在科学编程和高级可视化等方面的使用——天空是极限。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-19T04:06:24.780

您可以使用 Python 构建 Web 应用程序。请参阅[Django 框架](http://www.djangoproject.com/)。

除此之外，[这里](http://www.python.org/about/apps/)有一个不错的清单。

不是特别相关，但有趣的是 NASA 使用 Python 的事实。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-19T04:09:35.423

“酷”是一种心态。因此，酷应用取决于您对酷的定义。如果您想实现该理论，蚁群模拟很酷。

Python 拥有自己的第三方库（电池），可能已应用于日常编程的所有领域。我的建议是，决定你想编写的酷应用程序，然后看看 Python 在该领域提供什么。如果你足够满意，你就可以开始编码了。祝你好运！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-19T04:27:59.413

当时我不是编程爱好者，但使用[pygame](http://pygame.org)是我对 Python 的第一次介绍。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T04:11:34.833

Python 是一种类似于 Ruby 的通用编程语言。它可用于系统编程、嵌入式编程、桌面编程和网络编程。简而言之，它对于“酷”项目的潜力与任何其他通用语言一样多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T04:22:35.323

我喜欢：

*   [Django](http://www.djangoproject.com/) , 用于网络开发
*   用于 GUI 编程的[PyQt4](http://www.riverbankcomputing.co.uk/software/pyqt/intro)
*   [pygame](http://www.pygame.org/news.html)用于游戏、输入管理等
*   [PIL](http://www.pythonware.com/products/pil/) - python 成像库，它不是很大的应用程序，但真的很有帮助和库 imo
*   此外，[Blender](http://www.blender.org/)是一个可在 Python 中编写脚本的应用程序，因此，如果您喜欢一些 3D 图形，那么您就可以了。

如果您正在为 Windows 制作应用程序并希望轻松发布它们，您还可以查看[py2exe](http://www.py2exe.org/)之类的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-19T04:42:25.830

我做过的最早的 Python 编程之一是破解Soulseek 点对点网络的[尼古丁客户端，添加一个“/g [query]”聊天命令来打开默认浏览器并搜索 Google。](http://www.nicotine-plus.org/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-19T05:04:39.803

可能不是最通用的示例，但是当 AutoDesk Maya 采用 Python 作为辅助编程语言来补充 MEL（Maya 表达式语言）时，我学习了 Python。相比之下，这简直是天赐良机。

# python - 如何将.exe的输出重定向到python中的文件？

> ID：880918
> 
> 赞同：18
> 
> 时间：2009-05-19T04:03:32.140
> 
> 标签：python, redirect, io

在脚本中，我想运行一个带有一些命令行参数作为“-a”的.exe，然后

将程序的标准输出重定向到文件？

我该如何实施？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-19T09:02:05.300

您可以使用子进程直接重定向到文件。

```
import subprocess
with open('output.txt', 'w') as output_f:
    p = subprocess.Popen('Text/to/execute with-arg',
                         stdout=output_f,
                         stderr=output_f) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-19T04:07:35.390

最简单的是`os.system("the.exe -a >thefile.txt")`，但还有许多其他方法，例如使用`subprocess`标准库中的模块。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-19T08:05:29.317

您可以执行类似的操作，例如读取 ls -l （或任何其他命令）的输出

```
p = subprocess.Popen(["ls","-l"],stdout=subprocess.PIPE)
print p.stdout.read() # or put it in a file 
```

你可以为 stderr/stdin 做类似的事情

但正如亚历克斯提到的，如果你只是想把它放在一个文件中，只需将 cmd 输出重定向到一个文件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T08:21:20.297

如果您只想运行可执行文件并等待结果，Anurag 的解决方案可能是最好的。我需要在每行输出到达时对其进行响应，并发现以下方法有效：

1) 使用 write(text) 方法创建一个对象。将标准输出重定向到它（sys.stdout = obj）。在您的 write 方法中，在输出到达时对其进行处理。

2）在一个单独的线程中运行一个方法，代码如下：

```
 p = subprocess.Popen('Text/to/execute with-arg', stdout=subprocess.PIPE,
                        stderr=subprocess.PIPE, shell=False)
    while p.poll() is None:
        print p.stdout.readline().strip() 
```

因为您已经重定向了标准输出，所以 PIPE 会将输出逐行发送到您的 write 方法。如果您不确定是否会换行，我相信 read(amount) 也可以。

3）记住将标准输出重定向回默认值：sys.stdout =`__sys.stdout__`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T04:02:35.753

虽然标题 (.exe) 听起来像是 Windows 上的问题。我不得不分享接受的答案（带有stdout/stderr参数的subprocess.Popen（））在Mac OS X（10.8）和python 2.7上对我不起作用。

我必须使用 subprocess.check_output() （python 2.7 及更高版本）才能使其工作。例子：

```
import subprocess

cmd = 'ls -l'
out = subprocess.check_output(cmd, shell=True)
with open('my.log', 'w') as f:
    f.writelines(out)
    f.close() 
```

请注意，此解决方案会在程序完成时写出所有累积的输出。如果要在运行期间监控日志文件。您可能想尝试其他方法。就我自己而言，我只关心最终结果。

# php - 如何使外部 XML 文件在浏览器中很好地显示？

> ID：880922
> 
> 赞同：2
> 
> 时间：2009-05-19T04:05:02.687
> 
> 标签：php, xml, xslt

我有这个 PHP Web 应用程序。
它有一个指向我无法控制的 XML 文件的链接。

我怎样才能使 XML 显示得很好？

我只是希望它在表格中排列，或者它甚至可以看起来像一个数据文件。

我可以从外部将 XSLT 文件或样式表附加到 XML 文件吗？我希望我可以，但我不能把它放在 XML 中：

```
<?xml-stylesheet type="text/xsl" href="tabledisplay.xsl"?> 
```

我唯一能想到的就是创建一个指向 PHP 文件的链接，该文件将 XML 读入字符串，插入 XSL 引用，然后将所有内容打印到浏览器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T07:39:13.797

最安全的方法是读取 xml 文件并在服务器端对其进行转换，并在必要时将链接“保存原始 xml”插入其中。

如果 xsl 和 xml 在同一个域上，那么简单地插入 xsl 文件引用几乎总是有效的，但在不同域之间可能会出现问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T04:21:28.473

[http://ca3.php.net/xsl](http://ca3.php.net/xsl)

# visual-c++ - CMenu 和基于对话框的应用程序

> ID：880930
> 
> 赞同：4
> 
> 时间：2009-05-19T04:08:20.947
> 
> 标签：visual-c++, mfc, menu, dialog

是否可以在基于对话框的应用程序中放置菜单？如何？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-19T04:14:51.450

是的，可以将菜单添加到基于对话框的应用程序中。您可以将菜单创建为资源并将其附加到对话框。

如果您打开对话框的属性，您可以看到一个菜单作为您可以为其分配现有菜单 ID 的属性。

脚步：

*   右键单击资源视图并插入一个新的`Menu`. （带有一些 ID 的菜单——比如说 IDR_MENU1——被创建）
*   配置菜单以在菜单中添加所需的项目，并为菜单项提供 ID、标题。
*   右键单击对话框并打开属性...
*   从菜单组合框中，选择所需菜单的 ID（此处为 IDR_MENU1）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T18:58:51.930

您可以将菜单资源添加到对话框应用程序，但您尚未说明您使用的是哪个版本的 Visual Studio，因此很难提供详细信息。您应该知道，由于 CDialog 不是从 CFrameWnd 派生的，因此更新路由将不起作用 - 您需要阅读[本文](http://support.microsoft.com/kb/q242577/)了解详细信息。

如果您使用的是 Visual Studio post-VC6 版本，那么该文章包含添加菜单的说明，您可能正在使用该版本 - 请阅读文章下方的“更多信息”部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T07:17:53.033

请参阅MSDN 中的[DLGCBR32 MFC 示例](http://msdn.microsoft.com/en-us/library/aa232544(VS.60).aspx)。

# javascript - 带排序的 JQuery 表

> ID：880931
> 
> 赞同：1
> 
> 时间：2009-05-19T04:09:16.953
> 
> 标签：javascript, jquery

有各种 JQuery 小部件提供一些不错的功能，例如按列排序（例如[http://tablesorter.com/docs/](http://tablesorter.com/docs/)或[http://www.datatables.net/](http://www.datatables.net/)）

我还没有找到一个与服务器端排序集成的。我有以下要求：

1.  按点击的列排序（服务器端排序）
2.  按每列上的文本字段过滤
3.  可选择显示哪些列

关于具有部分或全部这些标准的小部件的任何建议？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T04:22:44.730

老实说，在这种情况下，我更愿意自己动手​​。使用 jQuery 过滤特别容易`$('tr > td.columnName').each(...)`：如果不匹配，只需将`display`行的样式设置为，否则。隐藏列可以以类似的方式完成。排序并不算太糟糕——尽管要复杂得多。您需要排序（这可能需要一段时间，具体取决于您的算法），然后按照您确定的顺序将行放入表中。`none``block`

或者，找到一个已完成排序但也生成简单标记的插件，以便您可以使用自己的过滤对其进行扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T18:08:34.893

作为自己滚动的一步（这不是一个坏建议，顺便说一句），试试这个 jQuery 插件：[Ingrid](http://www.reconstrukt.com/ingrid/ "英格丽德")。代码的描述讨论了使用服务器端数据生成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T18:15:46.193

试试[小桌子](http://www.leigeber.com/2009/03/table-sorter/)。它不需要 jQuery，但你在它周围放置了一个包装器。

[http://www.leigeber.com/2009/03/table-sorter http://www.leigeber.com/2009/03/table-sorter](http://www.leigeber.com/2009/03/table-sorter)

[![替代文字](https://i.stack.imgur.com/CBrSN.gif)](https://i.stack.imgur.com/CBrSN.gif)
[（来源：[leigeber.com](http://www.leigeber.com/wp-content/uploads/2009/03/tiny-table.gif)）]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T21:14:35.427

我认为[DisplayTag](http://demo.displaytag.org/displaytag-examples-1.1/example-sorting.jsp)是您的解决方案。它用于显示 servlet、portlet 的数据，并支持许多功能，如服务器端的分页、排序。

# c# - MVC 自定义视图模型问题

> ID：880933
> 
> 赞同：2
> 
> 时间：2009-05-19T04:09:27.640
> 
> 标签：c#, asp.net-mvc, viewmodel

我是一个 MVC 新手，所以你必须原谅我想象的一个基本问题。

我创建了一个自定义视图模型，以便在我的表单中有一个多选列表：

```
public class CustomerFormViewModel
{
    public Customer Customer { get; private set; }
    public MultiSelectList CustomerType { get; private set; }

    public CustomerFormViewModel(Customer customer)
    {
        Customer = customer
        // this returns a MultiSelectList:
        CustomerType = CustomerOptions.Get_CustomerTypes(null);
    }
} 
```

我发现我的第一次尝试只捕获了多选的第一个值，我猜这是因为我的创建操作看起来像这样：

```
 // GET: /Buyer/Create
    public ActionResult Create() { ... }

    // POST: /Buyer/Create
    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Create(Customer customer) { ... } 
```

所以，我决定把它改成这样：

```
 // GET: /Buyer/Create
    public ActionResult Create() { ... }

    // POST: /Buyer/Create
    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Create(CustomerFormViewModel model) { ... } 
```

这样我就可以从 MultiSelectList 获得完整的输出并相应地解析它。麻烦的是，这抱怨没有用于视图模型的无参数构造函数（并且没有） - 我不确定解决这个问题的正确方法。我尝试过的任何方法都没有奏效，我真的需要一些帮助！

如果有帮助，我的视图如下所示：

```
<%@  Language="C#" Inherits="System.Web.Mvc.ViewUserControl<MySite.Controllers.CustomerFormViewModel>" %>
...
<% using (Html.BeginForm())
    <%= Html.ListBox("CustomerType", Model.CustomerType)%>
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T17:51:33.427

您是否尝试过自定义 ModelBinder。不确定我是否清楚地理解了您的代码，但这可能是您的起点：

```
public class CustomerFormViewModelBinder : DefaultModelBinder
{
    protected virtual object CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Type modelType)
    {
        var model = new CustomerFormViewModel(customer)
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T02:03:00.963

我相信我明白了：

```
public class CustomerModelBinder : DefaultModelBinder
{
    public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        var form = controllerContext.HttpContext.Request.Form;

        Customer customer = base.BindModel(controllerContext, bindingContext) as Customer;

        if (customer!= null)
        {
            customer.CustomerType= form["CustomerType"];
        }

        return customer;
    }
} 
```

连同 global.asax 文件的 Application_Start() 中的一个条目：

```
 ModelBinders.Binders.Add(typeof(Customer), new CustomerModelBinder()); 
```

它将逗号分隔的列表框选择列表放在字段中。例如“1,3,4”。

# asp.net - 使用 ASP.NET 中的 PartialCaching 因控件属性而异

> ID：880937
> 
> 赞同：12
> 
> 时间：2009-05-19T04:10:59.683
> 
> 标签：asp.net, caching, outputcache

我在用户控件的基类上使用 PartialCaching 属性。

我希望缓存的控件根据控件实例上设置的属性而有所不同。

例如：

```
<mycontrols:control1 runat="server" param1="10" param2="20" /> 
```

...输出将与具有不同属性的控件实例分开缓存：

```
<mycontrols:control1 runat="server" param1="15" param2="20" /> 
```

...并且此控件也将单独缓存：

```
<mycontrols:control1 runat="server" param1="10" param2="25" /> 
```

但是，如果两个单独页面上的两个控件实例具有**相同**的param1 和 param2 属性，我希望它们作为一个对象缓存（以便共享缓存的控件）。

上述用例可以通过 PartialCaching 属性实现吗？我会使用什么设置？变化控制？

另外，是否可以在运行时使缓存持续时间变量？

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-24T09:35:52.173

要回答你的第一个问题，让我先告诉你，你的问题本身就有答案；）。'Shared' ... 是的，这就是关键字 :) 要在缓存中为所有页面的用户控件提供一个实例，请在 @OutputCache 指令中设置 Shared='true'。这应该在用户控制级别设置，即在 ascx 页面中。

要基于用户控件属性缓存用户控件，您应该在 PartialCachingAttribute 的 varyByControls 部分中指定属性的完全限定名称。多个属性（如果有）应以分号分隔。

```
<%@ Control Language="C#" AutoEventWireup="true" 
CodeFile="WebUserControl.ascx.cs" 
Inherits="UC_WebUserControl" %>
<%@ OutputCache Duration="60" 
VaryByControl="UC_WebUserControl.param1;UC_WebUserControl.param2" 
VaryByParam="none" Shared="true" %> 
```

或者您还可以包含用户控件的 PartialCache 属性：

```
[PartialCaching(60, null, "UC_WebUserControl.param1;UC_WebUserControl.param2", null, true)]
public partial class UC_WebUserControl : System.Web.UI.UserControl
{
    public string param1 { get; set; }
    public string param2 { get; set; }

} 
```

或者另一种缓存控制两个值组合的方法是：

```
[PartialCaching(60, null, "UC_WebUserControl.BothParams", null, true)]
public partial class UC_WebUserControl : System.Web.UI.UserControl
{
    public string param1 { get; set; }
    public string param2 { get; set; }

    public string BothParams    
    {
        get { return String.Concat(param1, param2); }
    }

} 
```

最后一个参数 (true) 指定共享。持续时间由 60 指定。请参阅链接[How to: Cache Multiple Versions of a User Control Based on Parameters](http://msdn.microsoft.com/en-us/library/z72yz1zs.aspx)

要回答您的第二个问题，要在运行时为用户控制变量设置缓存持续时间，您可以通过两种方式完成：

1.  在后面的用户控制代码中赋值：

    ```
    [PartialCaching(60, null, "UC_WebUserControl.BothParams", null, true)]
    public partial class WebUserControl1 : System.Web.UI.UserControl
    {
        ...
        protected void Page_Load(object sender, EventArgs e)
        {
            this.CachePolicy.Duration = new TimeSpan(0, 0, 60);
        }    
    }
    ```

2.  您可以在使用用户控件的 ID 引用用户控件的页面后面的代码中分配它。

例如，如果 aspx 上的用户控件是：

```
<mycontrols:control1 ID="ucControl1" runat="server" param1="15" param2="20" /> 
```

然后在aspx后面的代码中，你应该写：

```
this.ucControl1.CachePolicy.Duration = new TimeSpan(0, 0, 60); 
```

仅供参考，如果用户控件和页面都被缓存：如果页面输出缓存持续时间小于用户控件的持续时间，则用户控件将被缓存直到其持续时间到期，即使在页面的其余部分重新生成一段时间后也是如此要求。例如，如果页面输出缓存设置为 50 秒，而用户控件的输出缓存设置为 100 秒，则用户控件每过期两次，页面其余部分过期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T19:10:34.123

您需要的是[使用声明性属性缓存用户控件的多个版本](http://msdn.microsoft.com/en-us/library/53a3xxk8(VS.90).aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-12T19:35:59.190

我正在为这个非常古老的问题发布一个新答案，因为接受的答案非常不准确。这个正确答案是：

*   没有内置方法可以根据控件属性值进行更改。VaryByControl 仅适用于控件。
*   提供缓存版本时，您的控制字段将为空。您不能在代码中更改缓存持续时间 - 您会得到 NullReferenceException。
*   如果 VaryByControl 设置为任何值，则存在一个错误，该错误会根据控件 ID 和 NamingContainer ID 改变缓存。这就是为什么它有时会起作用的原因。错误就在这里：[http ://referencesource.microsoft.com/#System.Web/xsp/system/Web/UI/PartialCachingControl.cs#530](http://referencesource.microsoft.com/#System.Web/xsp/system/Web/UI/PartialCachingControl.cs#530)

我最近在这里写了一篇博客：http: [//tabeokatech.blogspot.be/2014/09/outputcache-on-user-controls.html](http://tabeokatech.blogspot.be/2014/09/outputcache-on-user-controls.html)。

您可以使这项工作的一种方法是在代码隐藏中自己调用 PartialCachingControl 的构建器方法，并将您想要改变的属性值嵌入到 guid 参数中：

```
 // PhControls is an asp:PlaceHolder
    protected void Page_Init(object sender, EventArgs e)
    {
        for (int i = 0; i < 3; i++)
        {
            System.Web.UI.StaticPartialCachingControl.BuildCachedControl(PhControls, String.Format("Test{0}", i), String.Format("1234567{0}", i), 180, null, null, null, null, new System.Web.UI.BuildMethod(GetBuilderDelegate(i)), null);
        }
    }

    public Func<Control> GetBuilderDelegate(int number)
    {
        return delegate()
        {
            var control = (UserControls.Test)LoadControl("~/UserControls/Test.ascx");
            control.Number = number;
            return control;
        };
    } 
```

这也巧妙地处理了代码隐藏中不同的缓存持续时间。确保在执行此操作时从 ascx 中的标记中删除 OutputCache 指令。否则 LoadControl 会为您提供另一个 PartialCachingControl 并且强制转换失败。

# matlab - 如何在 MATLAB 中计算结构中的属性数量？

> ID：880939
> 
> 赞同：3
> 
> 时间：2009-05-19T04:11:43.630
> 
> 标签：matlab, matlab-struct

我有一个返回一个或多个变量的函数，但是随着它的变化（取决于函数是否成功），以下内容不起作用：

```
[resultA, resultB, resultC, resultD, resultE, resultF] = func(somevars); 
```

这有时会返回一个错误，*varargout{2} not defined*`resultA` ，因为当函数失败时，实际上只有第一个变量被赋予了一个值。相反，我将所有输出放在一个变量中：

```
output = func(somevars); 
```

但是，变量被定义为结构的属性，这意味着我必须使用`output.A`. 这本身不是问题，但我需要计算属性的数量以确定我是否得到了正确的结果。

我试过了`length(output)`，`numel(output)`但`size(output)`无济于事，所以如果有人有聪明的方法，我将非常感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-19T04:21:05.900

```
length(fieldnames(output)) 
```

可能有更好的方法，但我想不出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T14:25:39.360

看起来[Matthews 的回答](https://stackoverflow.com/questions/880939/count-struct-properties-in-matlab/880960#880960)最适合您的问题：

```
nFields = numel(fieldnames(output)); 
```

有一个警告可能不适用于您的情况，但可能会很有趣：即使结构字段为空，[FIELDNAMES](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fieldnames.html)仍将返回该字段的名称。例如：

```
>> s.a = 5;
>> s.b = [1 2 3];
>> s.c = [];
>> fieldnames(s)

ans = 

    'a'
    'b'
    'c' 
```

如果您有兴趣了解*非空*字段的数量，可以使用[STRUCTFUN](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/structfun.html)：

```
nFields = sum(~structfun(@isempty,s)); 
```

或[STRUCT2CELL](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/struct2cell.html)和[CELLFUN](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/cellfun.html)的组合：

```
nFields = sum(~cellfun('isempty',struct2cell(s))); 
```

以上都返回 2 的答案，而：

```
nFields = numel(fieldnames(s)); 
```

返回 3。

# c# - 本地化动态生成的数据

> ID：880943
> 
> 赞同：0
> 
> 时间：2009-05-19T04:12:15.707
> 
> 标签：c#, asp.net, sql-server, localization

这对我来说是一个很难总结的问题，所以我们可能需要稍微编辑一下。

## 背景

大约四年前，我们不得不为墨西哥的客户翻译我们的 asp.net 应用程序。可扩展性和可扩展性在当时并不是什么大问题（哦，是的，我刚刚说了那些可怕的话），因为我们只有美国和墨西哥的客户。

我们没有使用资源文件，而是将应用程序中的每一段静态文本替换为某种类型的服务器控件（例如 asp.net 标签）。我们将每个英语单词存储在 SQL 数据库中。我们增加了将英文文本翻译成另一种语言的功能，还可以添加文化覆盖。例如，**你好**可以翻译成**¡hola！**使用一种语言并覆盖为**¡bueno！**在不同的文化中。企业可以完全控制这些翻译，因为将为他们构建管理实用程序来控制一切。当我们检测到用户的浏览器文化不是 en-us 时，翻译就会启动。每个表单都源自一个基本表单，它遍历每个服务器控件并执行翻译（翻译数据作为数据表存储在文化的应用程序变量中）。我仍然对控制迭代的速度感到惊讶。

## 问题

企业对翻译的工作方式非常满意。除了我上面提到的静态内容之外，企业现在还希望翻译某些数据。系统注释是他们想要的翻译的一个很好的例子。示例“ *Sent Letter #XXXX* to Customer” - 企业希望根据其浏览器文化翻译“Sent Letter to Customer”文本。

我已经阅读了关于 SO 的其他几篇关于本地化的文章，但它们并没有解决我的问题。如何翻译动态生成的短语？我可以轻松地阅读英文文本并翻译“Sent”、“Letter”、“to”和“Customer”，但我保证它对最终用户来说看起来很愚蠢，因为它是一个短语。如果我们以英语存储短语，而不是动态文本，系统生成的注释的动态部分将搞砸我们对短语执行的任何查找。

我有一个想法……我们没有系统生成的笔记类型表。我想我们可以创建一个包含动态数据的占位符，并且翻译引擎会忽略占位符标记。这种方法的问题在于，我们的 SQL 服务器数据库是旧选择数据库的复制品，我们并不真正了解系统生成短语的所有类型（它们在 pic 代码库、子程序、控制文件等中很深） .)。诸如便笺、记事本和付款拒绝原因之类的东西都以不同的方式存储。事实证明，试图规范化这些数据很困难。返回并识别和更改每个生成消息的选择程序将是一项巨大的努力。

[这个问题](https://stackoverflow.com/questions/359870/localizing-system-generated-status-messages)非常接近；但我处理的不仅仅是系统生成的状态消息，而是无限数量的短语和短语类型，没有中央生成机制。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T04:21:10.500

在紧要关头，如果您手头没有特定短语的翻译，我想您可以尝试[将工作强加给 Google ，然后将翻译存储起来以备后用。](http://code.google.com/p/google-api-translate-java/)

为以后存储翻译提供了一个用于构建消息目录的数据收集点和一个粗略的（如果有时[可笑的](http://tvtropes.org/pmwiki/pmwiki.php/Main/TheVodkaIsGoodButTheMeatIsRotten) [古怪](http://catb.org/~esr/jargon/html/W/wonky.html)）动态构建的起始翻译集。开始该过程后，跟踪哪些翻译已经过审核以及每个翻译被点击的频率。然后可以审查和改进经常出现的机器翻译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T04:35:19.570

缺少“瓶颈”——您认为是（缺失的）“中央生成机制”——是这种情况下的架构问题。理想情况下，重新架构以解决这样的瓶颈（这样您就可以继续使用您的通用方法和一个适合文化的消息再现数据库，只需使用“占位符”，例如您的示例中的#XXXX）。

如果这不可行，您可以将“瓶颈”放在管道的另一端——当消息即将发出时。到那时，或几点，您需要尝试将即将发出的（英文）字符串与一系列精心设计的正则表达式（“占位符”通常像`(.*?)`...）相匹配，从而确定适当的键用于数据库查找。是的，这**仍然**是很多工作，但至少它应该是可行的，没有你提到的旧翻译挑选代码的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T04:36:28.870

我们使用您建议的插入点技术。

“向客户 {1:Customer Full Name} 发送信件 #{0:Letter Num}”

这可能是（例如，反向猪拉丁语）：

“Ustomercay {1:Customer Full Name} asway entsay etterlay #{0:Letter Num}”

请注意，这处理特定目标语言反转插入顺序等的情况。它不处理必须使用应用程序逻辑/更多短语处理的微妙之处，如第一、第二等：

“这是您的 {0:first, second, third} 警告”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T15:29:16.847

动态机器翻译不适用于您实际上希望人们花钱购买的产品。唯一的方法是使用包含插入点的静态模板（正如 Cade Roux 在他的回答中所证明的那样）。

无法绕过对代码进行彻底重构以使其可行。另一种方法是对这些短语不做任何事情（这就是你现在正在做的事情，而且效果很好，对吧？）。通常没有翻译总比翻译糟糕透顶好。

# wpf - 依赖属性是如何实现的？

> ID：880950
> 
> 赞同：6
> 
> 时间：2009-05-19T04:16:18.017
> 
> 标签：wpf, user-interface, .net-3.5, dependency-properties

谁能解释依赖属性是如何实现的？它只是在基类中声明的静态字典，并以给定实例的引用作为键吗？我在互联网上找不到任何关于此的资源......
非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T11:20:16.147

我看到两个问题：

1.  依赖属性如何工作？关于 WPF 中的属性的[MSDN 文章](https://msdn.microsoft.com/en-us/library/ms753192(v=vs.100).aspx)是关于依赖属性的精彩系列。应该是一个很好的概述，可以帮助您入门。
2.  依赖属性是如何实现的？您将找不到任何关于此的资源，因为 Microsoft 为什么要公开他们的 DP 实现？话虽如此，这当然可以讨论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-30T16:56:43.730

...几年后。

并且已经有 .NET 的源代码浏览器。你可以在这里研究它是如何实现的：[DependencyProperty.cs](http://referencesource.microsoft.com/#WindowsBase/Base/System/Windows/DependencyProperty.cs)

# asp.net - 使用 SqlConnection 和 VB.NET 创建 ASP.NET 联合源

> ID：880954
> 
> 赞同：2
> 
> 时间：2009-05-19T04:18:17.987
> 
> 标签：asp.net, sql, vb.net, rss, syndication

这似乎是 Scott Mitchell 撰写的一篇很棒的文章，用于在**ASP.NET 3.5**中创建联合提要。对我来说，问题是它使用了 C# 和 Linq，我目前还没有那么敏锐。

[http://dotnetslackers.com/articles/aspnet/How-to-create-a-syndication-feed-for-your-website.aspx](http://dotnetslackers.com/articles/aspnet/How-to-create-a-syndication-feed-for-your-website.aspx)

有谁知道命名空间的示例在哪里可以使用**VB.NET**和**SQLConnection**对象`System.ServiceModel.Syndication`生成像本文这样的联合提要？

 ****我环顾四周，每个示例似乎都是用 C# 和 Linq 生成的（这可能证明我需要尽快而不是稍后学习它们）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-01-28T07:52:54.977

你现在可能已经想通了，但这里有一个完整的实现和一些 VB 的爱（以及[死灵法师徽章](https://stackoverflow.com/badges/17/necromancer)的尝试。:)

aspx页面很简单，注意60秒缓存：

```
<%@ Page Language="vb" AutoEventWireup="false" CodeBehind="Default.aspx.vb" Inherits="YourProject._Default" %>
<%@ OutputCache Duration="60" VaryByParam="Type" %> 
```

您可能想考虑改用 HttpHandler，但这也可以正常工作。

后面的代码：

```
Imports System.ServiceModel.Syndication
Imports System.Xml

Partial Public Class _Default
  Inherits System.Web.UI.Page

  Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Dim dbConn As String = "[your db connection]"
    Dim format As FeedFormats = GetFeedFormat()
    Dim posts As New List(Of SyndicationItem)

    Using cnn As New SqlClient.SqlConnection(dbConn)
      cnn.Open()

      Using cmd As New SqlClient.SqlCommand("SELECT ID, Title, Text, Url, Created FROM Posts", cnn)
        Dim reader As SqlClient.SqlDataReader = cmd.ExecuteReader

        While reader.Read
          Dim item As New SyndicationItem(reader.Item("Title"), reader("Text"), New Uri(reader("Url")))

          posts.Add(item)
        End While
      End Using
    End Using

    Dim feed As New SyndicationFeed("Your feed title", "Your feed description", New Uri("http://yourdomain.com"), posts)

    Using feedWriter As XmlWriter = XmlWriter.Create(Response.OutputStream)
      Select Case format
        Case FeedFormats.Atom
          Response.ContentType = "application/rss+xml"

          Dim atomFormatter As New Atom10FeedFormatter(feed)
          atomFormatter.WriteTo(feedWriter)
        Case FeedFormats.Rss
          Response.ContentType = "application/atom+xml"

          Dim rssFormatter As New Rss20FeedFormatter(feed)
          rssFormatter.WriteTo(feedWriter)
      End Select
    End Using
  End Sub

  Private Function GetFeedFormat() As FeedFormats
    If Request.QueryString("format") = "atom" Then
      Return FeedFormats.Atom
    Else
      Return FeedFormats.Rss
    End If
  End Function

  Public Enum FeedFormats
    Rss = 1
    Atom = 2
  End Enum
End Class 
```

最后，为了超级完整，创建表的 SQL 脚本：

```
CREATE TABLE [dbo].[Posts](
 [ID] [int] IDENTITY(1,1) NOT NULL,
 [Title] [nvarchar](50) NOT NULL,
 [Text] [ntext] NOT NULL,
 [Url] [nvarchar](50) NOT NULL,
 [Created] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_Posts] PRIMARY KEY CLUSTERED 
(
 [ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

ALTER TABLE [dbo].[Posts] ADD  CONSTRAINT [DF_Posts_Url]  DEFAULT ('') FOR [Url]
GO

ALTER TABLE [dbo].[Posts] ADD  CONSTRAINT [DF_Posts_Created]  DEFAULT (getdate()) FOR [Created]
GO 
```

完毕。VB.NET，一个 SQL 连接，`System.ServiceModel.Syndication`命名空间，没有 LINQ。:)

更新：在 2010 年 11 月 11 日获得死灵法师徽章。耶！谢谢！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T04:29:23.423

我不知道在 VB.Net 中使用这些对象的示例，但是有几种方法可以将 c# 代码转换为 VB.Net。您可以使用 SharpDevelop 之类的 IDE，也可以使用多种免费在线转换器中的任何一种。

我最喜欢的技术是将源下载或剪切并粘贴到 Visual Studio 中，然后用 C# 编译项目。然后使用[Reflector](http://www.red-gate.com/products/reflector/)将 IL 反汇编为 VB.Net。通过这样做，您可以将 C# 与 VB.Net 进行比较，如果您愿意，它可能会帮助您看到相似之处并更快地学习 C#。

# windows - 从 MSXML4 切换到 MSXML6 可能会出现哪些问题？

> ID：880956
> 
> 赞同：0
> 
> 时间：2009-05-19T04:18:49.580
> 
> 标签：windows, xml, msxml

由于与安装 MSXML4 相关的问题（[像这样](http://www.pcreview.co.uk/forums/thread-2266961.php)），我们想切换到 MSXML6。是否存在与此相关的任何已知问题，或者这种过渡是否顺利且无痛？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T06:09:05.127

该评论与其说是关于 4 到 6 的转换，不如说是关于 MSXML6 安装程序本身。显然，有些人在正确安装它时确实遇到了问题。如果未正确安装，它会破坏 Visual Studio 中的加载项管理器。

[从这个页面](http://www.mztools.com/articles/2007/MZ2007009.aspx)引用：

“报告的问题是在未正确安装 MSXML 6.0 时发生。在这种情况下，加载项管理器不显示任何基于 XML 的加载项（使用 .AddIn 文件进行注册）。它仅显示注册表- “

# git - 从一个分支拉取所有提交，将指定的提交推送到另一个

> ID：880957
> 
> 赞同：110
> 
> 时间：2009-05-19T04:20:26.443
> 
> 标签：git, branch

我有以下分支：

*   `master`
*   `production`

和以下远程分支：

*   `origin/master`
*   `origin/production`

我有一个脚本，它获取`origin/master`分支并获取与我上次获取 ( `log -p master..origin/master`) 相比发生变化的差异。然后我合并`origin/master`。

找到的提交被推送到代码审查工具。

我想将成功的提交——而且只有它们——推送到生产分支，然后当然是`origin/production`.

我该怎么做？

此外，我有 2 个脚本正在运行：一个从 获取`origin/master`、将提交详细信息推送到数据库并合并，另一个我目前正在编写的脚本必须推送成功的提交。

我希望在避免竞争条件/合并冲突的同时运行这两个脚本。由于我只想处理指定的提交，也许有办法摆脱我不想要的提交？

* * *

## 回答 #1

> 赞同：336
> 
> 时间：2009-05-19T04:53:32.583

我认为您正在寻找的术语是“樱桃采摘”。也就是说，从一个分支的中间获取一个提交并将其添加到另一个：

```
A-----B------C
 \
  \
   D 
```

变成

```
A-----B------C
 \
  \
   D-----C' 
```

当然，这可以通过 git cherry-pick 命令来完成。

这个提交的问题是 git 认为提交包括它们之前的所有历史 - 因此，如果你有三个这样的提交：

```
A-----B-----C 
```

并尝试摆脱 B，您必须像这样创建一个全新的提交：

```
A-----------C' 
```

其中 C' 具有不同的 SHA-1 ID。同样，cherry 从一个分支到另一个分支的提交基本上涉及生成一个补丁，然后应用它，因此也会以这种方式丢失历史记录。

这种提交 ID 的更改破坏了 git 的合并功能（尽管如果谨慎使用，会有一些启发式方法可以解决这个问题）。更重要的是，它忽略了函数依赖——如果 C 真的使用了 B 中定义的函数，你永远不会知道。

处理这个问题的更好方法可能是拥有更细粒度的分支。也就是说，不仅仅是拥有一个“master”，而是拥有“featureA”、“bugfixB”等。一次对整个分支执行代码审查——每个分支都非常专注于只做一件事——然后合并它完成后一个分支。这是 git 设计的工作流程，也是它擅长的工作:)

如果您坚持在补丁级别处理事情，您可能需要查看 darcs - 它认为存储库是一组补丁，因此樱桃挑选成为基本操作。然而，这有其自身的一系列问题，例如非常慢:)

编辑：另外，我不确定我是否理解你的第二个问题，关于这两个脚本。也许您可以更详细地描述它，可能作为一个单独的问题来防止事情变得混乱？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-25T06:54:24.307

I realise this is an old question, but is referenced here: [How to merge a specific commit in Git](https://stackoverflow.com/questions/881092/how-to-merge-a-specific-commit-in-git/881112#881112)

Hence, a newer answer: Use feature branches and pull requests.

What this looks like, where fA is a commit with feature A, and fB is a commit with feature B:

```
 fA   fC (bad commit, don't merge)
           /  \ /
master ----A----B----C
                \  /
                 fB 
```

Pull requests are associated with GitHub's functionality, but really all I mean is that someone has the responsibility of merging the feature branches into master.

# asp.net - ASP.NET 从 javascript 设置 DetailsView BoundField 值

> ID：880958
> 
> 赞同：0
> 
> 时间：2009-05-19T04:20:44.993
> 
> 标签：asp.net, javascript, detailsview

我想知道是否可以从 javascript 设置 DetailsView BoundField 的字段（在编辑模式下）？我无法为 boundfield 设置 id，所以显然不能使用 document.getElementById() 来获取它，但我想知道是否还有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T17:29:25.387

您可以尝试创建一个 EditItemTemplate，在其中放置一个 TextBox 并为其指定一个您选择的 ID。

像这样：

```
<Fields>
        <asp:TemplateField HeaderText="Column1">
            <EditItemTemplate>
                <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
            </EditItemTemplate>
        </asp:TemplateField>
    </Fields> 
```

如果要在 TextBox 的 Text 属性上绑定一些东西，您可以使用 Bind() 方法。

祝你好运。

# linq - 将 LINQ 应用于对象分组依据和排序依据到通用列表 （C＃）

> ID：880959
> 
> 赞同：5
> 
> 时间：2009-05-19T04:20:54.497
> 
> 标签：linq, group-by, ienumerable

我很难针对通用列表 myList 创建工作组依据和排序依据子句。myList 有一个属性“设置”列表，它本身包含每个业务的“子”属性列表。

我想按行业分组，并在每个行业内按企业名称排序。我的意图是这样的：

```
string groupSetting = "Industry";
sortSetting = "BusinessName";
myList.GroupBy(p => p.Settings.Find(s => s.Name == groupSetting)).OrderBy(p => p.Settings.Find(t => t.Name == sortSetting)); 
```

但是我收到错误消息：' *System.Linq.IGrouping 不包含设置的定义，并且没有扩展方法设置接受 System.Linq.Igrouping 类型的第一个参数可以找到....* '表明我无法调用订单by 子句没有一些转换或额外的处理。

我已经尝试了各种各样的方法来分解它并让它工作，但我错过了一些东西。任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-19T04:25:41.393

您的问题是它`GroupBy`不会返回单个设置列表，而是返回“列表列表”。这就是`IGrouping`你所看到的。

您需要遍历 中的每个组，`IGrouping`对该组进行排序，然后遍历该组中的每个项目。观察：

```
public static void Main( string[] args )
{
    var groupSetting = "Industry";

    // step 1: group the data. Note this doesn't actually create copies of the data as
    // it's all lazy loaded
    // BEWARE. If a company doesn't have the "Industry" setting, this will throw an exception
    var grouped = companies.GroupBy(c => c.Settings.First(s => s.Name == groupSetting).Value);
    foreach( var group in grouped )
    {
        Console.WriteLine(group.Key);// this is the Value that came out of the GroupBy

        // Note how we have to do the ordering within each individual group. 
        // It doesn't make sense to try group them in one hit like in your question
        foreach( var item in group.OrderBy(bus => bus.Name) )
            Console.WriteLine(" - " + item.Name);
    }
} 
```

为清楚起见提供的数据结构：

```
struct Setting { public string Name; public string Value; }
struct Business { public string Name; public IEnumerable<Setting> Settings; }

static IEnumerable<Business> companies = new[]{
    new Business{ Name = "XYZ Inc.", Settings = new[]{ 
        new Setting{ Name="Age", Value="27"},
        new Setting{ Name="Industry", Value="IT"}
    }},
    new Business{ Name = "Programmers++", Settings = new[]{ 
        new Setting{ Name="Age", Value="27"},
        new Setting{ Name="Industry", Value="IT"}
    }},
    new Business{ Name = "Jeff's Luxury Salmon", Settings = new[]{ 
        new Setting{ Name="Age", Value="63"},
        new Setting{ Name="Industry", Value="Sports"}
    }},
    new Business{ Name = "Bank of Khazakstan", Settings = new[]{ 
        new Setting{ Name="Age", Value="30"},
        new Setting{ Name="Industry", Value="Finance"}
    }},
}; 
```

这将产生以下输出：复制/粘贴代码并运行它并使用它

```
IT
 - Programmers++
 - XYZ Inc.
Sports
 - Jeff's Luxury Salmon
Finance
 - Bank of Khazakstan 
```

# spring-ws - 用于调用 Apache 轴 web 服务的 Spring web 服务客户端

> ID：880971
> 
> 赞同：1
> 
> 时间：2009-05-19T04:25:41.393
> 
> 标签：spring-ws

我需要通过我的 Spring Web 服务客户端程序调用外部（远程）Web 服务。

*   如何将请求发送到远程 Web 服务服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-17T08:27:27.833

[http://static.springsource.org/spring-ws/sites/1.5/reference/html/client.html](http://static.springsource.org/spring-ws/sites/1.5/reference/html/client.html)

基本上你可以使用 Spring webservice 模板来调用远程soap服务。

# ruby-on-rails - 在连接表中，Rails 缺少组合键的最佳解决方法是什么？

> ID：880981
> 
> 赞同：32
> 
> 时间：2009-05-19T04:30:25.203
> 
> 标签：ruby-on-rails, database, composite-key, junction-table

```
create_table :categories_posts, :id => false do |t|
  t.column :category_id, :integer, :null => false
  t.column :post_id, :integer, :null => false
end 
```

我有一个连接表（如上），其中包含引用相应*类别*表和*帖子*表的列。我想对**categories_posts**连接表中**的复合键 category_id、post_id强制执行唯一约束。**但是 Rails 不支持这一点（我相信）。

 **为了避免在我的数据中出现具有相同 category_id 和 post_id 组合的重复行的可能性，对于**Rails 中缺少复合键的最佳解决方法是**什么？

我的假设是：

1.  在这种情况下，默认的自动编号列 (id:integer) 不会保护我的数据。
2.  ActiveScaffold 可能会提供一个解决方案，但我不确定仅仅为了这个单一功能将它包含在我的项目中是否有点矫枉过正，特别是如果有更优雅的答案。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-19T04:59:23.800

添加包含两列的唯一索引。这将阻止您插入包含重复 category_id/post_id 对的记录。

```
add_index :categories_posts, [ :category_id, :post_id ], :unique => true, :name => 'by_category_and_post' 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2011-08-16T08:41:54.500

很难推荐“正确”的方法**。**

1)**务实的方法**

使用验证器，不要添加唯一复合索引。这会在 UI 中为您提供很好的消息，并且可以正常工作。

```
class CategoryPost < ActiveRecord::Base
  belongs_to :category
  belongs_to :post

  validates_uniqueness_of :category_id, :scope => :post_id, :message => "can only have one post assigned"
end 
```

您还可以在连接表中添加两个单独的索引以加快搜索速度：

```
add_index :categories_posts, :category_id
add_index :categories_posts, :post_id 
```

请注意（根据*Rails 3 Way*一书）*验证并非万无一失，因为 SELECT 和 INSERT/UPDATE 查询之间存在潜在的竞争条件*。如果您必须绝对确定没有重复记录，建议使用唯一约束。

2）**防弹方法**

在这种方法中，我们希望在数据库级别上施加约束。所以这意味着创建一个复合索引：

```
add_index :categories_posts, [ :category_id, :post_id ], :unique => true, :name => 'by_category_and_post' 
```

大的优点是数据库的完整性很好，缺点是没有太多有用的错误报告给用户。请注意，在创建复合索引时，列的顺序很重要。

如果您将较少选择性的列作为索引中的前导列，并将大多数选择性列放在最后，则其他对非前导索引列有条件的查询也可能会利用 INDEX SKIP SCAN。您可能需要再添加一个索引才能利用它们，但这是高度依赖数据库的。

3)**两者结合**

人们可以阅读两者的组合，但我倾向于只喜欢第一。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-19T06:55:21.450

我认为您可以更轻松地验证其中一个字段的唯一性，并将另一个字段作为范围：

从 API：

```
validates_uniqueness_of(*attr_names) 
```

验证指定属性的值在系统中是否唯一。用于确保只能将一个用户命名为“davidhh”。

```
 class Person < ActiveRecord::Base
    validates_uniqueness_of :user_name, :scope => :account_id
  end 
```

它还可以根据多个范围参数验证指定属性的值是否唯一。例如，确保教师每学期只能在特定课程的时间表上安排一次。

```
 class TeacherSchedule < ActiveRecord::Base
    validates_uniqueness_of :teacher_id, :scope => [:semester_id, :class_id]
  end 
```

创建记录时，将执行检查以确保数据库中不存在具有指定属性（映射到列）的给定值的记录。更新记录时，会进行相同的检查，但不考虑记录本身。

配置选项：

```
* message - Specifies a custom error message (default is: "has already been taken")
* scope - One or more columns by which to limit the scope of the uniquness constraint.
* case_sensitive - Looks for an exact match. Ignored by non-text columns (true by default).
* allow_nil - If set to true, skips this validation if the attribute is null (default is: false)
* if - Specifies a method, proc or string to call to determine if the validation should occur (e.g. :if => :allow_validation, or :if => Proc.new { |user| user.signup_step > 2 }). The method, proc or string should return or evaluate to a true or false value. 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-19T05:00:39.180

当我在 Rails 中遇到此问题时，我实现了以下两项：

1）您应该在数据库级别声明一个唯一的复合索引，以确保 dbms 不会让创建重复记录。

2) 为了提供比上述更平滑的错误消息，向 Rails 模型添加验证：

```
validates_each :category_id, :on => :create do |record, attr, value|
  c = value; p = record.post_id
  if c && p && # If no values, then that problem 
               # will be caught by another validator
    CategoryPost.find_by_category_id_and_post_id(c, p)
    record.errors.add :base, 'This post already has this category'
  end
end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-27T09:23:44.863

解决方案可以是在模型中添加索引和验证。

所以在迁移中你有： add_index :categories_posts, [:category_id, :post_id], :unique => true

在模型中： validates_uniqueness_of :category_id, :scope => [:category_id, :post_id] validates_uniqueness_of :post_id, :scope => [:category_id, :post_id]

# c++-cli - 从 C++/CLI 实现在 C# 中声明的接口

> ID：880984
> 
> 赞同：36
> 
> 时间：2009-05-19T04:35:18.683
> 
> 标签：c++-cli

假设我有一个 C# 接口，`IMyInterface`定义如下：

```
// C# code
public interface IMyInterface
{
  void Foo(string value);
  string MyProperty { get; }
} 
```

假设我还有一个 C++/CLI 类，`MyConcreteClass`它实现了这个接口，并且它的头声明如下：

```
// C++/CLI header file
ref class MyConcreteClass : IMyInterface
{
public:

}; 
```

如何实现C++/CLI 标头中的方法`Foo`和属性？`MyProperty`

我的尝试导致以下编译错误：

> 错误 C3766：“MyConcreteClass”必须为接口方法“void IMyInterface::Foo(System::String^ value)”提供实现

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-19T04:38:58.807

```
public ref class MyConcreteClass : public IMyInterface
{
 public:
  virtual void __clrcall Foo(String^ value) sealed;  

  virtual property String^ __clrcall MyProperty 
         { String^ get() sealed { String::Empty; } }
}; 
```

接口需要定义为虚拟的。还要注意类声明后的“public IMy..”，它的语法与 C# 略有不同。

如果可以，密封接口成员以提高性能，编译器将能够比典型的虚拟成员更紧密地绑定这些方法。

希望有帮助；）

我没有编译它，但对我来说看起来不错......哦，另外，将您的方法定义为 __clrcall 消除了双重 thunk 性能损失的危险。

**编辑** 属性的正确语法是：

```
public ref class MyConcreteClass : public IMyInterface
{
 public:
  virtual property String^ MyProperty 
  {
    String^ get() sealed { return String::Empty; };
    void set( String^ s ) sealed { };
  }
}; 
```

或者，将定义放入源文件时：

```
public ref class MyConcreteClass : public IMyInterface
{
 public:
  virtual property String^ MyProperty 
  {
    String^ get() sealed;
    void set( String^ s ) sealed;
  }
};

String^ MyConcreteClass::MyProperty::get()
{
  return String::Empty;
}

void MyConcreteClass::MyProperty::set( String^ )
{
  //...
} 
```

# asp.net-ajax - ASP.NET AJAX 的组合框 - 无法以编程方式更改所选项目

> ID：880986
> 
> 赞同：5
> 
> 时间：2009-05-19T04:35:51.180
> 
> 标签：asp.net-ajax

我在我的 Web 应用程序中使用了新的 Microsoft ASP.NET Ajax ComboBox 控件，但我无法弄清楚如何以编程方式设置选定的列表项。例如，我有一个接受地址的表单和一个接受城市名称的 ComboBox。用户输入并保存地址后，我想重置表单，包括 ComboBoxes。

使用常规 ASP.NET 下拉列表控件，我可以重置所选项目，如下所示：

```
City.SelectedIndex = -1; 
```

ASP.NET AJAX ComboBox 控件接受这行代码；但是当页面回发时，之前选择的值仍然被选中。帮助将不胜感激。

更新：我尝试了以下无济于事...

```
City.ClearSelection(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-04T20:21:59.297

一种解决方案是在第二次加载页面或使其在更新面板中可见之前使用以下 2 个命令

```
 Combobox1.ClearSelection()
            Combobox1.Dispose() 
```

这将清除组合框值。

希望这可以帮助。我花了一段时间才找到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T20:18:06.560

这是 CodePlex 上的一个未解决问题。所以，因为它是一个错误，所以在发布补丁之前没有解决方案。这是 CodePlex 上的[问题](http://ajaxcontroltoolkit.codeplex.com/WorkItem/View.aspx?WorkItemId=22451)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-01T08:44:59.713

当我使用 DropDownStyle="DropDown" 和此命令清除文本 combobox1.SelectedItem.Text = ""

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-18T23:51:35.190

*** 这仍然是工具包 2-18-2011 版本 3.5.40412.2 的错误 ***

为了所有的谷歌搜索者，我发现的这个问题的修复都没有奏效（包括涉及遍历控件集合以查找隐藏控件、Dispose 等的各种修复）

***这对我有用，无论我将组合框埋在其他控件/面板等中有多深***

组合框.Items.Clear();

((TextBox)cmbMachineNum.FindControl("TextBox")).Text = "";

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T05:10:02.250

尝试：

```
ComboBox.Text = "";  
ComboBox.ClearSelection(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T11:41:32.273

您指的是 CascadingDropDown 吗？如果是这样，请将 CascadingDropDown 的 SelectedValue 设置为 null。

```
CascadingDropDown1.SelectedValue = null; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-22T20:44:02.037

好的，所以如果你想设置索引，它实际上存储在控件的隐藏字段中，它看起来像。所以我正在做的是清除它。

```
foreach (Control control in cbFeatures.Controls)
            {
                if (control is HiddenField)
                    ((HiddenField)control).Value = "0";
            } 
```

这对我来说非常有用，因为值是您要设置的索引。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-09T05:17:08.320

这可以通过清除隐藏字段来解决，如以下博客[http://techiecentre.blogspot.com/中所述](http://techiecentre.blogspot.com/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-29T19:26:11.143

替换`City.ClearSelection()`为以下内容：

```
City.Items.Insert(0, "");
City.SelectedIndex = 0; 
```

现在这将在 City 控件的下拉列表部分中放置一个空字符串，并将文本设置为空字符串。要从下拉列表中删除空字符串，请使用

```
City.Items.Remove(""); 
```

在城市`Page_Load`事件中。

# url - Pythonic URL 解析

> ID：880988
> 
> 赞同：0
> 
> 时间：2009-05-19T04:36:31.710
> 
> 标签：url, python

关于如何在 Python 中解析 URL 有很多问题，这个问题是关于最好或最 Pythonic 的方法。

在我的解析中，我需要 4 个部分：网络位置、URL 的第一部分、路径和文件名以及查询字符串部分。

[http://www.somesite.com/base/first/second/third/fourth/foo.html?abc=123](http://www.somesite.com/base/first/second/third/fourth/foo.html?abc=123)

应该解析为：

```
netloc = 'www.somesite.com'
baseURL = 'base'
path = '/first/second/third/fourth/'
file = 'foo.html?abc=123' 
```

下面的代码产生了正确的结果，但是在 Python 中有没有更好的方法来做到这一点？

```
url = "http://www.somesite.com/base/first/second/third/fourth/foo.html?abc=123"

file=  url.rpartition('/')[2]
netloc = urlparse(url)[1]
pathParts = path.split('/')
baseURL = pathParts[1]

partCount = len(pathParts) - 1

path = "/"
for i in range(2, partCount):
    path += pathParts[i] + "/"

print 'baseURL= ' + baseURL
print 'path= ' + path
print 'file= ' + file
print 'netloc= ' + netloc 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T04:44:12.007

由于您对所需部分的要求与 urlparse 给您的要求不同，所以它会得到最好的。但是，您可以替换它：

```
partCount = len(pathParts) - 1

path = "/"
for i in range(2, partCount):
    path += pathParts[i] + "/" 
```

有了这个：

```
path = '/'.join(pathParts[2:-1]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T06:55:31.307

我倾向于从`urlparse`. 此外，您可以使用`rsplit`, 和 的`maxsplit`参数`split`来`rsplit`简化一些事情：

```
_, netloc, path, _, q, _ = urlparse(url)
_, base, path = path.split('/', 2) # 1st component will always be empty
path, file = path.rsplit('/', 1)
if q: file += '?' + q 
```

# python - 尝试向南迁移 django 应用程序时出错

> ID：880989
> 
> 赞同：0
> 
> 时间：2009-05-19T04:36:40.040
> 
> 标签：python, database, django, migration

运行“./manage.py migrate app_name”时出现此错误

```
While loading migration 'whatever.0001_initial':
Traceback (most recent call last):
 File "manage.py", line 14, in <module> execute_manager(settings)

...tons of other stuff..

   raise KeyError("The model '%s' from the app '%s' is not available in this migration." % (model, app))
KeyError: "The model 'appuser' from the app 'whatever' is not available in this migration." 
```

我确信模型“appuser”在应用程序models.py和0001_initial.py中

来自 models.py 的 AppUser 模型：

```
class AppUser(models.Model):
    person = models.OneToOneField('Person')
    user = models.ForeignKey(User, unique=True)
    class Meta:
        permissions = (
            ('is_one', 'one'),
            ('is_two', 'two')
        )
    def __unicode__(self):
        return self.person.__unicode__() 
```

来自 0001_initial.py 的 AppUser 模型：

```
 # Adding model 'AppUser'
    db.create_table('app_appuser', (
        ('person', models.OneToOneField(orm.Person)),
        ('id', models.AutoField(primary_key=True)),
        ('user', models.ForeignKey(orm['auth.User'], unique=True)),
    ))
    db.send_create_signal('app', ['AppUser'])
    ...
    'app.appuser': {
        'Meta': {'permissions': "(('is_one','one'),('is_two','two'))"},
        'id': ('models.AutoField', [], {'primary_key': 'True'}),
        'person': ('models.OneToOneField', ["'Person'"], {}),
        'user': ('models.ForeignKey', ['User'], {'unique': 'True'})
    }, 
```

我试图在空数据库（即没有“app_ *”表）上运行它：

```
manage.py migrate app 
```

这似乎只发生在 Mac OS 上的 python 2.5 上，Ubuntu/python 2.6 没有问题

问题 - 如何解决？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T00:53:37.670

问题似乎与 0001_initial.py 文件中的模型顺序有关。有一个从 AppUser 派生的类。当我在 Mac OS 上重新创建迁移时

```
manage.py startmigration app --initial 
```

并将其与在 Ubuntu 上生成的模型进行比较，模型的顺序不同。因此，当我更改顺序以匹配 Mac OS 上的顺序时，一切正常。

这个问题似乎只存在于 0.5 版本的 south 中，并且据说已修复在主干上。

# c# - StringBuilder 和容量？

> ID：880990
> 
> 赞同：2
> 
> 时间：2009-05-19T04:38:21.507
> 
> 标签：c#, stringbuilder

我已经创建了测试应用程序进行测试，StringBuilder 是否将数据复制到另一个实例并在其长度超过当前容量时增加它的缓冲区，并在 ildasm.exe 中进行验证，但它看起来相同。

如何验证 StringBuilder 会将其数据复制到新实例中并按指定限制增长缓冲区？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-19T05:08:16.340

容量表示分配给 StringBuilder 的连续内存。容量可以 >= 字符串的长度。当附加到 StringBuilder 的数据多于容量时，StringBuilder 会自动增加容量。由于已经超过容量（即连续内存被填满，没有更多可用的缓冲空间），因此分配了更大的缓冲区并将数据从原始内存复制到这个新区域。

它不会将数据复制到新的“实例”，而是复制到新的“内存位置”。该实例保持不变，但指向新的内存位置。

编辑仅供参考：如果在创建期间未指定，则 StringBuilder 的默认容量为 16

如果您想查看 StringBuilder 的内存位置，那么您可以调试您的应用程序并使用 Debug > Windows > Memory 检查内存。当 Append stmt 运行时，您实际上可以看到存储在 StringBuilder 中的每个字节的地址。

如果您需要以编程方式获取位置，[此链接](http://www.codeproject.com/KB/cs/sojaner_memory_scanner.aspx)可能会有所帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-19T05:09:37.727

并不是说我们真的在测试 StringBuilder 是否有效，因为它确实有效，但是为了您自己的乐趣，您总是可以编写一个单元测试。

```
StringBuilder sb = new StringBuilder(10);
Console.WriteLine("Capacity = " + sb.Capacity + " Length = " + sb.Length 
      + " MaxCapacity = " + sb.MaxCapacity);
sb.Append("1234567890");
sb.Append("1234567890");
sb.Append("1234567890");
Console.WriteLine("Capacity = " + sb.Capacity + " Length = " + sb.Length 
      + " MaxCapacity = " + sb.MaxCapacity);
Assert.AreEqual("123456789012345678901234567890"
      , sb.ToString()); // NUnit assert. 
```

不出所料，它通过了，并给出了以下输出。

```
    容量 = 10 长度 = 0 最大容量 = 2147483647
    容量 = 40 长度 = 30 最大容量 = 2147483647

```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-19T05:31:27.897

如果您想检查 StringBuilder 是如何实现的，只需启动 Reflector 并查看它。的实现`StringBuilder.Append(string)`如下

```
public StringBuilder Append(string value)
{
   if (value != null)
   {
      string stringValue = this.m_StringValue;
      IntPtr currentThread = Thread.InternalGetCurrentThread();
      if (this.m_currentThread != currentThread)
      {
         stringValue = string.GetStringForStringBuilder(stringValue, stringValue.Capacity);
      }
      int length = stringValue.Length;
      int requiredLength = length + value.Length;
      if (this.NeedsAllocation(stringValue, requiredLength))
      {
         string newString = this.GetNewString(stringValue, requiredLength);
         newString.AppendInPlace(value, length);
         this.ReplaceString(currentThread, newString);
      }
      else
      {
         stringValue.AppendInPlace(value, length);
         this.ReplaceString(currentThread, stringValue);
      }
   }
   return this;
} 
```

查看带有 等的部分`NeedsAllocation`以`GetNewString`找到您要查找的内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T04:53:11.087

StringBuilder 在需要时增加其缓冲区的方式由 StringBuilder 的内部代码处理；它不会显示在您的应用程序的 IL 代码中；编译器无法知道某个方法中的 StringBuilder 将包含多大的字符串，因为这可能会不时发生变化。

但是，当 StringBuilder*确实*增加其缓冲区时，它不会产生新的 StringBuilder 实例。这可能会导致它将其保存的字符串的内部表示复制到一个新实例中（我对类的内部工作了解得不够多，无法准确说明会发生什么）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T21:33:37.453

```
 class Program
    {
        static void Main()
        {
            StringBuilder sb = new StringBuilder();
            Console.WriteLine(sb.Capacity); //16

            for (int i = 0; i < 50; i++) 
                sb.Append(i + ",");

            Console.WriteLine(sb.Capacity); //256

            sb = new StringBuilder();
            Console.WriteLine(sb.Capacity); //16
        }
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T05:15:48.160

您可以使用 Reflector 来了解 StringBuilder 的工作原理。

见方法

```
StringBuilder Append(string value) 
```

对于 .Net 3.5 逻辑是这样的：如果缓冲区长度不足以容纳新字符串，则创建长度等于 Max(oldSize * 2, requiredSize) 的新缓冲区。

换句话说，StringBuffer 尝试将缓冲区加倍，如果这还不够，则使缓冲区大小刚好足以容纳新字符串。

对旧缓冲区的引用被删除，旧缓冲区在下一次垃圾回收中被回收。

# linq - Linq 错误：InvalidOperationException：无法翻译表达式

> ID：880992
> 
> 赞同：2
> 
> 时间：2009-05-19T04:41:21.430
> 
> 标签：linq

如果为 null 则从 DateTime 列中获取值以返回 String.Empty 否则 DateTime.ToShortDateString

我在做什么错=>下面产生的查询：

```
var queryable = from p in Products
    select new {
               selldate = p.SellEndDate == null
                           ? string.Empty
                           : p.SellEndDate.Value.ToShortDateString()  }; 
```

错误：InvalidOperationException：无法将表达式 'Table(Product).Select(p => new <>f__AnonymousType0 `1(selldate = IIF((p.SellEndDate = null), Invoke(value(System.Func`1[System.String]))、p.SellEndDate.Value.ToShortDateString())))' 转换为 SQL 并且无法将其视为本地表达式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T04:56:01.943

基本上这里发生的事情是 LINQ to SQL 正在获取您的整个查询并尝试将其转换为 SQL Server 可以理解的内容。但是，问题在于 SQL Server 没有 DateTime.ToShortDateString 的概念，因此转换为 SQL 失败。

您必须更改您的查询，以便它只选择 SellEndDate （将其作为 a `Nullable<DateTime>`），然后当您使用该查询的结果时，您可以转换为字符串。例如：

```
var list = (from p in Products
           select p.SellEndDate).ToList();

// calling ToList() above means we have the entire resultset in memory and
// no longer have to pass the query back to SQL Server

var stuff = from p in list select new
{ 
    selldate = p.SellEndDate == null ?
                   string.Empty :
                   p.SellEndDate.Value.ToShortDateString()
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T04:56:11.490

`ToShortDateString`似乎没有等效的 SQL 翻译。
改为使用`ToString`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T16:44:05.233

如果日期时间字段允许空值：

```
from order in repository.Order
     select order.OrdShipDate == null ? "" : order.OrdShipDate.GetValueOrDefault(DateTime.Now).Month.ToString() + "/" + order.OrdShipDate.GetValueOrDefault(DateTime.Now).Day.ToString() + "/" + order.OrdShipDate.GetValueOrDefault(DateTime.Now).Year.ToString(); 
```

如果日期时间字段不允许空值：

```
from order in repository.Order
     select order.OrdShipDate.Month.ToString() + "/" + order.OrdShipDate.Day.ToString() + "/" + order.OrdShipDate.Year.ToString(); 
```****************