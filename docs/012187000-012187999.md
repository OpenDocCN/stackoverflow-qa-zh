# StackOverflow 问答 12187000-12187999

# javascript - 所有 css 数值的 csshooks

> ID：12187001
> 
> 赞同：1
> 
> 时间：2012-08-29T21:47:26.977
> 
> 标签：javascript, jquery, css

有没有办法为所有 css 数值编写一个 csshooks，这样所有的东西都被认为是在“px”中，从而节省了每次你想对它们进行计算时在字符串和整数之间转换的麻烦？我不只是在谈论顶部/左侧/宽度/高度......甚至像 fontSize 这样的东西

# ruby-on-rails - 尝试设置 Snorby：找不到 dm-active_model-1.2.1

> ID：12187003
> 
> 赞同：0
> 
> 时间：2012-08-29T21:47:49.350
> 
> 标签：ruby-on-rails, ruby, gem, snort

我正在尝试在 backtrack5 R3 上设置 snorby，因为它看起来很酷，而且我的老板想要它。此外，backtrack 已经安装了 snort，这让我的工作更轻松。在确保一切都已安装并解决了许多其他问题之后，我开始收到 dm-active_model-1.2.1 的错误它一直在说“在任何来源中都找不到 dm-active_model-1.2.1。每当我把在 snorby 文件夹中的 bundle install 中，它会吐出看起来像 gem 的源代码...我将在下面发布。

```
WARNING:  #<ArgumentError: Illformed requirement ["#<Syck::DefaultKey:0xa54414c> 1.2.3"]>
 # -*- encoding: utf-8 -*-

Gem::Specification.new do |s|
  s.name = %q{dm-active_model}
  s.version = "1.2.1"

  s.required_rubygems_version = Gem::Requirement.new(">= 0") if 
s.respond_to? :required_rubygems_version=
  s.authors = ["Martin Gamsjaeger (snusnu)"]
  s.date = %q{2012-02-15 00:00:00.000000000Z}
  s.description = %q{A datamapper plugin for active_model compliance and thus rails 3 compatibility.}
  s.email = %q{gamsnjaga [a] gmail [d] com}
  s.extra_rdoc_files = ["LICENSE", "README.rdoc", "TODO"]
  s.files = [".document", "CHANGELOG", "Gemfile", "LICENSE", "README.rdoc", "Rakefile", "TODO", "VERSION", "dm-active_model.gemspec", "lib/dm-active_model.rb", "lib/dm-active_model/version.rb", "spec/amo_interface_compliance_spec.rb", "spec/amo_validation_compliance_spec.rb", "spec/dm-active_model_spec.rb", "spec/lib/amo_lint_extensions.rb", "spec/rcov.opts", "spec/spec.opts", "tasks/changelog.rake", "tasks/spec.rake", "tasks/yard.rake", "tasks/yardstick.rake"]
  s.homepage = %q{http://github.com/datamapper/dm-active_model}
  s.require_paths = ["lib"]
  s.rubyforge_project = %q{datamapper}
  s.rubygems_version = %q{1.3.7}
  s.summary = %q{active_model compliance for datamapper}

  if s.respond_to? :specification_version then
    current_version = Gem::Specification::CURRENT_SPECIFICATION_VERSION
    s.specification_version = 3

    if Gem::Version.new(Gem::VERSION) >= Gem::Version.new('1.2.0') then
      s.add_runtime_dependency(%q<dm-core>, ["~> 1.2.0"])
      s.add_runtime_dependency(%q<activemodel>, ["~> 3.0"])
      s.add_development_dependency(%q<dm-validations>, ["~> 1.2.0"])
      s.add_development_dependency(%q<jeweler>, ["~> 1.6.4"])
      s.add_development_dependency(%q<rake>, ["~> 0.9.2"])
      s.add_development_dependency(%q<rspec>, ["~> 1.3.2"])
      s.add_development_dependency(%q<test-unit>, ["#<Syck::DefaultKey:0xa54414c> 1.2.3"])
    else
      s.add_dependency(%q<dm-core>, ["~> 1.2.0"])
      s.add_dependency(%q<activemodel>, ["~> 3.0"])
      s.add_dependency(%q<dm-validations>, ["~> 1.2.0"])
      s.add_dependency(%q<jeweler>, ["~> 1.6.4"])
      s.add_dependency(%q<rake>, ["~> 0.9.2"])
      s.add_dependency(%q<rspec>, ["~> 1.3.2"])
      s.add_dependency(%q<test-unit>, ["#<Syck::DefaultKey:0xa54414c> 1.2.3"])
    end
  else
    s.add_dependency(%q<dm-core>, ["~> 1.2.0"])
    s.add_dependency(%q<activemodel>, ["~> 3.0"])
    s.add_dependency(%q<dm-validations>, ["~> 1.2.0"])
    s.add_dependency(%q<jeweler>, ["~> 1.6.4"])
    s.add_dependency(%q<rake>, ["~> 0.9.2"])
    s.add_dependency(%q<rspec>, ["~> 1.3.2"])
    s.add_dependency(%q<test-unit>, ["#<Syck::DefaultKey:0xa54414c> 1.2.3"])
  end
end
WARNING:  Invalid .gemspec format in '/var/lib/gems/1.9.2/specifications/dm-active_model- 1.2.1.gemspec'
Could not find dm-active_model-1.2.1 in any of the sources 
```

编辑：现在我在 Ubuntu 11 32 位中运行。我想出了同样的连续问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T18:22:25.440

Snorby 需要 Ruby 1.9.3 或更高版本。既然您提到了简化，请看一下 Security Onion。它设置了 Snort 和 Snorby 以及许多其他工具。

# php - 在两个php数组中找到匹配的元素，然后将两个数组元素一起列出

> ID：12187004
> 
> 赞同：-2
> 
> 时间：2012-08-29T21:47:58.957
> 
> 标签：php, arrays

```
大批
(
    [0] => 数组
        (
            [0] => ï»¿“产品类别”
            [1] => 产品名称
            [2] => 产品编号
            [3] => 平均商品价格
            [4] => 物品销售
            [5] => 已售商品
            [6] => 产品转化（售出/浏览）
            [7] => 物品放弃率
        )
    [1] => 数组
        (
            [0] => 总体
            [1] => -
            [2] => -
            [3] => 51.17 美元
            [4] => 1335974.77 美元
            [5] => 26111
            [6] => 16.25%
            [7] => 42.06%
        )

阵列 B：
大批
(
    [0] => 数组
        (
            [0] => ï»¿“内容类别”
            [1] => 页面名称
            [2] => 页面浏览量
            [3] => 会话
            [4] => 订单/会话
            [5] => 销售
            [6] => 跳出率
            [7] => 页面浏览量/会话
        )

    [1] => 数组
        (
            [0] => 总体
            [1] => -
            [2] => 1017924
            [3] => 135154
            [4] => 16.57%
            [5] => 1354866.20 美元
            [6] => 23.81%
            [7] => 7.53
        )

```

我想将两个数组合并为一个......结果将如下所示：

```
大批
(
    [0] => 数组
        (
            [0] => ï»¿“产品类别”
            [1] => 产品名称
            [2] => 产品编号
            [3] => 平均商品价格
            [4] => 物品销售
            [5] => 已售商品
            [6] => 产品转化（售出/浏览）
            [7] => 物品放弃率
            [8] => ï»¿“内容类别”
            [9] => 页面名称
            [10] => 页面浏览量
            [11] => 会话
            [12] => 订单/会话
            [13] => 销售
            [14] => 跳出率
            [15] => 页面浏览量/会话

        )
     [1] => 数组
        (
            [0] => 总体
            [1] => -
            [2] => -
            [3] => 51.17 美元
            [4] => 1335974.77 美元
            [5] => 26111
            [6] => 16.25%
            [7] => 42.06%
            [8] => 总体
            [9] => -
            [10] => 1017924
            [11] => 135154
            [12] => 16.57%
            [13] => 1354866.20 美元
            [14] => 23.81%
            [15] => 7.53

        )

```

我只想输出“产品类别”==“内容类别”的匹配数组，并结合两个数组元素......

我不太确定是否有一个预定义的函数，但我假设我必须做某种 array_intersect() 或 array_merge() ......重点是抓住匹配的元素并结合两个元素从两个数组合二为一，所以我可以做一些后处理计算......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T21:59:46.170

这会产生您要求的数组：

```
$result = array(
    array_merge($A[0], $B[0]), 
    array_merge($A[1], $B[1])
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T19:34:52.617

我想出了我的问题的答案..

```
// loop through ARRAY A
for ($i = 0; $i < count($arrA); $i++) {

    //loop through ARRAYB

    for ($j = 0; $j < count($arrB); $j++) {

        // if arrA value 0 matches arrB value 0
        if ($arrA[$i][0] == $arrB[$j][0]) {
            //append arrB to arrA
            $arrA[$i] = array_merge($arrA[$i], $arrB[$j]);
            break;
        }
    }
}

//clean out items

for ($i = (count($arrA)-1); $i >= 0 ; $i--) {

    if (count($arrA[$i]) < 16) {
        unset($arrA[$i]);
    }
} 
```

# reflection - Metro 中的 D3D11 不支持 D3DReflect？（为什么不？）

> ID：12187008
> 
> 赞同：2
> 
> 时间：2012-08-29T21:48:38.760
> 
> 标签：reflection, microsoft-metro, shader, hlsl, direct3d11

****Metro**中的**D3D11**不支持`D3DReflect`.**

 ****为什么不？**

我的 API 使用它来动态获取着色器的常量缓冲区大小。 **有没有其他方法可以在没有`ID3D11ShaderReflection`对象的情况下在 D3D11 中动态获得恒定的缓冲区大小？**还是按名称获取常量变量？

*   如果我想为 Metro 制作一个着色器编译工具怎么办？

*   什么是我想要制作一个允许您动态生成需要着色器生成的复杂画笔的艺术应用程序。但这不起作用。

**Windows(Desktop)**、**OSX**、**Linux**、**iOS**或**Android**是否有这些着色器限制？

不，那Metro到底为什么要这么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T06:44:55.740

有关它的一些讨论，请参阅[http://social.msdn.microsoft.com/Forums/en-US/wingameswithdirectx/thread/9ae33f2c-791a-4a5f-b562-8700a4ab1926](http://social.msdn.microsoft.com/Forums/en-US/wingameswithdirectx/thread/9ae33f2c-791a-4a5f-b562-8700a4ab1926)。

没有官方立场解释他们为什么做出这样的限制，但它与 WinRT 上动态代码执行的整个限制非常相似。所以很遗憾你的应用场景是不可能的。

虽然，破解/修补 d3dcompiler_xx.dll 并重定向所有 dll 导入以调用另一个仅使用授权 API 的 DLL 是可行的，但这是相当多的工作，甚至不确定这是否合法（即使通过提取来自原始 d3dcompiler 的 dll 代码并重建一个新的 dll）。

您的场景的另一个选择是通过互联网将着色器发送到编译并返回字节码和反射信息的服务器......远非完美。

在您提到的平台中，可能iOS是可能具有相同限制的平台（我不在此平台上开发，因此无法确认）。**

# java - 如何为 jar 配置 log4j 日志记录？

> ID：12187014
> 
> 赞同：6
> 
> 时间：2012-08-29T21:49:11.233
> 
> 标签：java, log4j

我在其构建路径上有一个带有 log4j.jar 的项目 A。我有许多类具有以下形式的日志记录语句：

```
Logger _log = Logger.getLogger(A.<>.class);
...
_log.info("..."); 
```

我将项目作为 jar 导出到另一个项目 B。项目 B 已经有自己的 log4j jar 和自己的 .xml 配置文件。我想从 A 配置特定的类以在不同的“级别”登录到控制台 Apender。请问我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:05:00.823

一般来说，你不会。通常，您希望拥有一个 log4j 配置文件。但我想您可以从代码中显式加载配置，如[log4j 文档中所述](http://logging.apache.org/log4j/1.2/manual.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:05:42.267

选择一个 log4j.jar 版本，可能是较新的版本。您只能使用一个版本。您需要合并项目 A 和项目 B 的日志记录配置。您可以在运行时在 log4j 类中执行此操作，但不要这样做。只需咬紧牙关，在源代码管理中将它们合并一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T22:06:35.917

好吧，基本上，你不应该那样做。可以这样想：如果这样做的话，任何应用程序中包含的每个库都将托管自己的日志记录配置，很可能会以未指定的顺序覆盖应用程序中的任何配置，并且相互覆盖. 你不会想要那个。所以不要。

[如果您真的非常想这样做，您可以在 jar 中拥有可以被主应用程序中的 xml 文件覆盖的属性文件。[在此处](https://stackoverflow.com/questions/2732981/how-to-disable-log4j-in-3rd-party-jar?rq=1)查看详细信息。但是不要。:)]

# lua - Lua 无缘无故崩溃

> ID：12187017
> 
> 赞同：3
> 
> 时间：2012-08-29T21:49:28.067
> 
> 标签：lua

我们将 Lua 集成到一个项目中，但我们发现了一个奇怪的测试用例，它在 ARM 上始终崩溃：

```
data = {"A","B","C","D","E","F","G","H","I","J"};

function OnTick(_object)

    local params = {};

    return 1;
end 
```

以下是如何从 C++ 调用函数的基础知识：

```
lua_getglobal(Lua, function_name->c_str()); // Push function name that we want to call onto the stack
if (lua_isnil(Lua, -1))
{
    // Error
    lua_pop(Lua, 1);
    return -1;
}
lua_pushlightuserdata(Lua, (void*)object);  // Push the reference object onto the stack

if (lua_pcall(Lua, 1, 1, 0) != 0)
{
    // Error
    lua_pop(Lua, 1);
    return -1;
}

lua_pop(Lua, 1);
return 1; 
```

OnTick 在被调用大约 5 次后崩溃。

当垃圾收集器尝试清理时，Lua 似乎正在崩溃。其他人遇到过这样的事情并解决了吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-06T22:48:05.437

解决了这个问题，客户端代码破坏了 Lua 状态

# sqlite - SQLite3 中兼容的预写日志记录和只读模式？

> ID：12187023
> 
> 赞同：1
> 
> 时间：2012-08-29T21:49:35.290
> 
> 标签：sqlite

## 以只读方式打开

我在文件系统上有一个 sqlite3 文件，该文件属于与运行读取过程不同的用户。我希望读取过程能够以只读模式读取文件，所以我传递了 SQLITE_OPEN_READONLY。我希望这能奏效。当然，这个想法是只读模式适用于我们不想写入的文件？

当我准备我的第一份陈述时，我得到

> `unable to open database file`

同样，如果我运行`sqlite3`命令行工具，我会得到相同的结果，除非我使用 sudo。这似乎向我证实了问题在于可写性而不是其他任何问题。

## 日志文件

[这个问题](https://stackoverflow.com/questions/7957778/opening-a-sqlite3-db-on-a-read-only-filesystem-with-a-journal-file)的答案似乎表明，如果周围有日志文件，那么只读访问是不可能的。

为什么会有日志文件？因为另一个进程正在写入文件，所以我的用户进程正试图以只读方式打开它。为此，我使用了Write-Ahead Logging，它产生两个日志文件，`-shm`和`-wal`. 确实，如果我停止写入过程并删除日志文件，我的用户进程可以以只读模式打开它。

## 不兼容？

所以我有两种情况：

*   如果文件既属于写入进程又属于只读进程，则预写日志记录使进程 A 可以写入，而进程 B 可以只读

*   如果文件属于写进程但不*属于*只读进程，则阻止只读进程以只读方式打开。

我如何实现这两个？把它拼出来，我想要：

*   写入进程拥有数据库
*   只读进程不拥有数据库
*   只读进程无法写入数据库
*   在数据库上启用了预写日志记录

似乎是一组简单的要求，但我看不到明显的解决方案。

**编辑：**按照[这个文档](http://www.sqlite.org/draft/wal.html#readonly)，看起来这是不可能的。你能建议任何替代方法来实现上述目标吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T09:43:42.960

是的 WAL 日志数据库不能以只读方式打开，显式或以其他方式（即在数据库文件对进程只读的情况下）。

如果您要求绝对不允许只读进程修改数据库文件，那么唯一想到的就是写进程维护一个非 WAL-journal 数据库的附加副本。

底线：据我所知，WAL 和只读无法完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-12T14:19:11.843

我认为文档所说的是 WAL 数据库本身可能不存在于只读**媒体**上，这并不一定意味着您不能使用`SQLITE_OPEN_READONLY`。事实上，我已经成功地打开了两个连接，一个读写连接以及一个使用 SQLITE_OPEN_READONLY 的连接，都在 WAL sqlite 数据库上。这些工作得很好。`INSERT`我使用只读连接测试了一个查询，该语句正确返回了数据库为只读的错误。

只需确保数据库存储在具有写访问权限的某些介质上，因为需要创建和维护 -shm 文件，因此即使是“仅就绪”连接也可能实际上将某些内容物理写入磁盘 - 这不一定意味着它可以使用 SQL 修改数据。

# iphone - 将对象添加到数组

> ID：12187025
> 
> 赞同：1
> 
> 时间：2012-08-29T21:49:46.317
> 
> 标签：iphone, objective-c

我正在尝试将对象添加到数组中。我具体要做的是，计算我可以在页面上容纳多少项目，将这些项目添加到我的 itemsOnAPageArray，将其添加到我的 pagesArray，然后稍后使用此信息。所以我的代码是：

```
NSMutableArray *pagesArray = [[NSMutableArray alloc] init];
NSMutableArray *itemsOnAPage = [[NSMutableArray alloc] init];

for (NSUInteger i = 0; i < [self.textObjects count]; i++) {
    TextObject *t = [self.textObjects objectAtIndex:i];

    width = MAX(width, t.size.width);

    // Fits on a page, add the object, update the size
    if (height + t.size.height < kReportPDFDefaultHeight) {
        [itemsOnAPage addObject:t];
        height += t.size.height;
    }
    // Doesn't fit on a page, add the items to the page
    else {

        [pagesArray addObject:itemsOnAPage];
        [pagesArray enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
            NSLog(@"obj before: %@", [obj description]);
        }];

        [itemsOnAPage removeAllObjects];
        [pagesArray enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
            NSLog(@"obj after: %@", [obj description]);
        }];
    }
} 
```

但是，当我开始一个新页面时，我想清除初始数组并开始将对象添加到我的第二页，依此类推。但是如果我清除我的数组，那么我的 pagesArray 最终会是空的。我该如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T21:53:44.727

`itemsOnAPage`当您将数组插入 时，您需要制作一个副本`pagesArray`，否则您最终会得到最后一页的多个副本：

```
 [pagesArray addObject:[NSArray arrayWithArray:itemsOnAPage]]; 
```

# ruby - 将 Tumblr 迁移到 octopress (Jekyll) - 在错误的目录中

> ID：12187026
> 
> 赞同：2
> 
> 时间：2012-08-29T21:49:54.710
> 
> 标签：ruby, gem, jekyll

我正在尝试将博客从 Tumblr 迁移到 Octopress。

当我在 octopress 目录中运行时

```
ruby -rubygems -e 'require "jekyll/migrators/tumblr"; Jekyll::Tumblr.process("http://example.org", format="md")' 
```

它开始运行，但随后抱怨它在哪个文件夹中

```
/usr/lib/ruby/gems/1.9.1/gems/jekyll-0.11.2/lib/jekyll/convertible.rb:27:in `read': No such file or directory - /usr/lib/ruby/gems/1.9.1/gems/jekyll-0.11.2/lib/jekyll/migrators/../_posts/tumblr/2012-08-28-how-to-add-your-picture-to-google-results.md (Errno::ENOENT)
  from /usr/lib/ruby/gems/1.9.1/gems/jekyll-0.11.2/lib/jekyll/convertible.rb:27:in `read_yaml'
  from /usr/lib/ruby/gems/1.9.1/gems/jekyll-0.11.2/lib/jekyll/post.rb:39:in `initialize'
  from /usr/lib/ruby/gems/1.9.1/gems/jekyll-0.11.2/lib/jekyll/migrators/tumblr.rb:124:in `new'
  from /usr/lib/ruby/gems/1.9.1/gems/jekyll-0.11.2/lib/jekyll/migrators/tumblr.rb:124:in `block in rewrite_urls_and_redirects'
  from /usr/lib/ruby/gems/1.9.1/gems/jekyll-0.11.2/lib/jekyll/migrators/tumblr.rb:119:in `map'
  from /usr/lib/ruby/gems/1.9.1/gems/jekyll-0.11.2/lib/jekyll/migrators/tumblr.rb:119:in `rewrite_urls_and_redirects'
  from /usr/lib/ruby/gems/1.9.1/gems/jekyll-0.11.2/lib/jekyll/migrators/tumblr.rb:30:in `process'
  from -e:1:in `<main>' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:22:51.477

这是一个对我有用的快速而肮脏的修复程序（显然，如果您没有 root 访问权限，则不适用），但它可以完成工作。

这是您的错误消息以供参考：

```
/usr/lib/ruby/gems/1.9.1/gems/jekyll-0.11.2/lib/jekyll/convertible.rb:27:in `read': \
    No such file or directory - \
   /usr/lib/ruby/gems/1.9.1/gems/jekyll0.11.2/lib/jekyll/migrators/../_posts/tumblr/2012-08-28-how-to-add-your-picture-to-google-results.md (Errno::ENOENT) 
```

异常中的完整路径是：

/usr/lib/ruby/gems/1.9.1/gems/jekyll0.11.2/lib/jekyll/migrators/../_posts/tumblr/2012-08-28-how-to-add-your-picture-to-谷歌结果.md

这是解决方案：

```
 1\. cd to /usr/lib/ruby/gems/1.9.1/gems/jekyll0.11.2/lib/jekyll/migrators/
 2\. cd ..
 3\. ln -s %{DIRECTORY_WHERE__posts_LIVES}
 4\. Re-run your migration command 
```

只需创建此符号链接即可解决问题，但这是一个明显且完全的 hack。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T03:59:41.493

文件是否`/usr/lib/ruby/gems/1.9.1/gems/jekyll-0.11.2/lib/jekyll/_posts/tumblr/2012-08-28-how-to-add-your-picture-to-google-results.md`存在？如果不是，也许您可​​以先将您的帖子移动到该文件夹​​，这只是一种简单的解决方法。

# amazon-ec2 - Amazon Linux 上的 LDAP 配置

> ID：12187029
> 
> 赞同：1
> 
> 时间：2012-08-29T21:50:34.063
> 
> 标签：amazon-ec2, ldap, openldap

我正在尝试在 Amazon Linux 上安装 openldap 并收到以下错误：

```
olcRootPW: value #0: <olcRootPW> can only be set when rootdn is under suffix
config error processing olcDatabase={1}monitor,cn=config: <olcRootPW> can only be set when rootdn is under suffix
slaptest: bad configuration file! 
```

我还尝试将 olcRootPW 放在 olcDatabase={2}bdb.ldif 文件中，但这只会给出相同的错误。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:55:05.027

信息很清楚。如果 rootDN 在数据库的后缀下，您只能在监控数据库上设置密码。换句话说，rootDN 必须以 'cn=monitor,cn=config' 结尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-17T13:04:16.487

尝试像下面一样在文件中添加它`olcDatabase={2}hdb.ldif`

```
olcSuffix: dc=my-domain,dc=com

olcRootDN: cn=manager,dc=my-domain,dc=com

olcRootPW: {SSHA}---password--- 
```

# jquery - 无法让 jQuery( html, props ) 处理事件

> ID：12187032
> 
> 赞同：4
> 
> 时间：2012-08-29T21:50:50.413
> 
> 标签：jquery

我无法让 click 事件对由此创建的元素起作用。

[http://jsfiddle.net/iambriansreed/PEZXa/](http://jsfiddle.net/iambriansreed/PEZXa/)

jQuery

```
$('<a href="#">a</a>', {
  click: function(){
    alert('a clicked');
  }
}).appendTo("div");

$('<span>span</span>', {
  click: function(){
    alert('span clicked');
  }
}).appendTo("div"); 
```

**请不要向我展示可以将`onclick`事件添加到元素的 50 种不同方法，我想知道为什么这种特定方法有效或无效。**

来自文档： [http ://api.jquery.com/jQuery/#jQuery2](http://api.jquery.com/jQuery/#jQuery2)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T21:57:45.813

```
$('<a />', {
    href: '#',
    text: 'a',
  'click': function(){
    alert('a clicked');
  }
}).appendTo("div");

$('<span />', {
    text: 'span',
  'click': function(){
    alert('span clicked');
  }
}).appendTo("div"); 
```

[http://jsfiddle.net/PEZXa/56/](http://jsfiddle.net/PEZXa/56/)

从文档

> html - 定义单个独立 HTML 元素的字符串（例如 <div/> 或 <div></div>）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-29T21:58:07.840

当像这样创建的元素包含文本节点或属性时，jQuery 似乎不喜欢它。本质上，您提供的 HTML 代码应该是一个（可能是自闭合的）标签。

这可能是因为您使用的语法要求在对象参数中定义属性，而不是在 HTML 和对象之间混合。

无论如何，这段代码对我有用：

```
$('<a /> ', {
    href: '#',
    text: 'a',
    click: function() {
        alert('a clicked');
    }
}).appendTo("div");

$('<span />', {
    text: 'span',
    click: function() {
        alert('span clicked');
    }
}).appendTo("div");​ 
```

**演示：http: [//jsfiddle.net/PEZXa/60/](http://jsfiddle.net/PEZXa/60/)**

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-29T21:57:33.727

这应该有效：

```
$('<a/>', {
    href: "#",
    text: 'a',
    click: function(){
        alert('a clicked');
    }
}).appendTo("div"); 
```

[小提琴](http://jsfiddle.net/PEZXa/57/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-29T21:59:00.943

`jQuery(html, props)`只有当`html`它是一个没有其他属性或子元素的裸标签时才有效。

# java - JCurses 颜色不起作用

> ID：12187035
> 
> 赞同：2
> 
> 时间：2012-08-29T21:51:13.733
> 
> 标签：java, colors, console-application, jcurses

我刚刚开始使用 JCurses 开发我的第一个控制台应用程序。到目前为止，我可以使用几个按钮来显示一个窗口，但是焦点按钮和非焦点按钮之间没有视觉上的区别。

从源头上看，焦点按钮应该有不同的颜色，我也尝试过为焦点按钮显式设置不同的颜色`Button.setFocusedButtonColors`，但没有效果。

任何使用过 JCurses 的人都可以告诉我我需要在我的应用程序中做什么来启用颜色，或者确认这是一个终端仿真问题吗？（我通过从 perl 程序打印转义码成功地在同一个终端中使用了颜色。）

# actionscript-3 - Twitter OAuth update.json 发回“无法使用 OAuth 进行身份验证”（使用 AS3 OAuth 库）

> ID：12187037
> 
> 赞同：1
> 
> 时间：2012-08-29T21:51:26.957
> 
> 标签：actionscript-3, oauth, air, twitter-oauth

我目前正在使用 org.iotashan.oauth.* 包 (https://github.com/iotashan/oauth-as3/tree/master/src/org/iotashan/oauth) 在 AS3/Adobe 中处理我的 Twitter OAuth空气。我正在使用 HTMLLoader 加载允许权限对话框并侦听位置更改事件以获取验证者、排队以授权令牌等。我已获得身份验证工作并让 Twitter 成功向我发送令牌并成功授权访问令牌的令牌。但是当我尝试做一个测试帖子时，我不断收到以下错误。这是我成功获取访问令牌的事件处理程序：

```
 protected function handleTwitterOAuthAccessTokenLoadComplete( evt:Event ):void
    {
        _twitterAccessToken     = OAuthUtil.getTokenFromResponse( evt.target.data );
        trace( "THE ACCESS TOKEN:", _twitterAccessToken.key );

        //Code to send out a test tweet to logged in Twitter user's account
        var oauthRequest:OAuthRequest = 
            new OAuthRequest(
                OAuthRequest.HTTP_MEHTOD_POST, "https://api.twitter.com/1/statuses/update.json", 
                {},
                _twitterOAuthConsumer, _twitterAccessToken
            );

        var request:URLRequest = new URLRequest(oauthRequest.requestURL);
        request.requestHeaders.push( oauthRequest.buildRequest( _twitterOAuthSignature, OAuthRequest.RESULT_TYPE_HEADER) );
        request.method = URLRequestMethod.POST;
        request.data    = new URLVariables( "scope=hello" );
        var urlLoader:URLLoader = new URLLoader();
        urlLoader.addEventListener( Event.COMPLETE, function( evt:Event ):void
        {
            trace( evt.target.data );
        } );
        urlLoader.addEventListener( IOErrorEvent.IO_ERROR, function( evt:IOErrorEvent ):void
        {
            trace("ERROR");
            trace( evt.currentTarget.data );
        } );
        urlLoader.load( request );
    } 
```

我从服务器得到的错误是：

```
{"error":"Could not authenticate with OAuth.","request":"\/statuses\/update.json"} 
```

我检查了正在发送的标头，它与 Twitter OAuth 工具（在 Twitter 上的应用程序设置页面中）告诉我的内容非常匹配。我不知道还能尝试什么。以下是标题的内容：

```
Authorization: OAuth oauth_timestamp="1346276194",
oauth_token="14815835-[REMOVED FOR STACK OVERFLOW]",
oauth_signature="Vj%2FTjbV%2FumMKS66yK8VMXSv%2Fpl4%3D",
oauth_consumer_key="bUka[REMOVED FOR STACK OVERFLOW]",
oauth_signature_method="HMAC-SHA1",
oauth_version="1.0",
oauth_nonce="74C5E2D8-D805-9B04-6353-7450770E1056" 
```

Twitter OAuth 工具告诉我它应该是这样的：

```
Authorization: OAuth oauth_consumer_key="bUka[REMOVED FOR STACK OVERFLOW]",
oauth_nonce="95a9ef376211a67f550e55a32ad307e4",
oauth_signature="avFkHD4d9fPRv9iE4OuczEI2AOU%3D",
oauth_signature_method="HMAC-SHA1",
oauth_timestamp="1346268740",
oauth_token="14815835-[REMOVED FOR STACK OVERFLOW]",
oauth_version="1.0" 
```

如您所见，一切似乎都匹配...包括 oauth_token。

# c# - 合并子句的奇怪行为

> ID：12187039
> 
> 赞同：0
> 
> 时间：2012-08-29T21:51:41.127
> 
> 标签：c#, winforms

好人！我在这里遇到一个问题，真的需要你的帮助。我有一个 Winforms 应用程序，它有几个选项卡。它连接到 MS SQL Server 2008 数据库，并在我们连接到数据库的第一个选项卡上显示 DataGridView：

```
private void button_ConnectDB_Click(object sender, EventArgs e)
{
    if (sqlConnection == null || sqlConnection.State != ConnectionState.Open)
        sqlConnection = new SqlConnection(connectionString);
    sqlConnection.Open();
    try
    {
        dataAdapter = new SqlDataAdapter(queryStringUsers, sqlConnection);
        SetConnectDBObjects();
        SetConnectDBButtons();
    }
    catch
    {
        ShowUnableToConnect();
        return;
    }

} 
```

并从 DB 获得一些信息：

```
private void button_SpecAcc_Click(object sender, EventArgs e)
    {
        dataGridView1.DataSource = this.usersBindingSource;
        LoadData(ref dataAdapter, ref clientDataSet, TAB_USERS);
        dataGridView1.ReadOnly = false;
    }, 
```

其中**LoadData**实际上是：

```
private void LoadData(ref SqlDataAdapter dataAdapter, ref clientDataSet dataset, string table)
    { dataAdapter.Fill(dataset, table); } 
```

我将 dataAdapter 直接连接到 SQL Server，因此它是自动配置的（所有操作，如 INSERT、UPDATE、DELETE 也是）。一切正常（可以连接到数据库，进行任何操作，保存它（通过应用按钮，它使用适配器的**更新**方法）），直到我决定创建另一个选项卡。另一个选项卡应该让我得到信息（几行）从其他地方（我连接的一些ext设备），将其放入DataTable并与数据库中的其他行合并。按照本教程在此选项卡上完成所有操作：[**网站**](http://www.jarloo.com/c-bulk-upsert-to-sql-server-tutorial/)。

当我尝试合并某些行时，我可以在我的数据库中看到很好的**UPDATE**，但是在我的第一个选项卡（在表单上）中，我可以看到两个不同的行（一个，好像它没有被触及，第二个 - 好像它已更新）。我认为它与刷新（尝试刷新 GridView，没有帮助）或其他一些元素的刷新（但哪个？...）有关，但我仍然找不到它。将不胜感激任何帮助...谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:51:52.060

通过创建临时数据集、编辑它（通过 DataRows）并将其放入数据库来处理它。感谢所有的观察者:)

# c++ - 使用 Visual Studio 2010 编译 Maxmind C 库

> ID：12187040
> 
> 赞同：0
> 
> 时间：2012-08-29T21:51:41.827
> 
> 标签：c++, visual-studio-2010, geoip

anybony 在 Visual Studio 2010 上成功编译了 Maxmind C 库吗？我无法在 Windows 上编译它，因为我收到很多关于未找到的文件的错误，例如 unistd.h

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T10:30:09.230

您看到的错误可能是因为您包含了并非真正需要的 GeoIPUpdate。GeoIPUpdate 是用于更新数据库的独立脚本，不需要使用 API 本身。尝试删除它以查看是否可以解决您的问题。

此外，为了在 Visual Studio 2005 上为我编译 1.4.8 版，我必须执行以下附加步骤：

1.  在 GeoIPCity.c 中，将 GeoIP*.h 文件的包含更改为使用 "" 而不是 <>
2.  在 GeoIPCity.h 中，将 GeoIP.h 的包含更改为使用 "" 而不是 <>
3.  在 GeoIP.h 中添加`#define ssize_t long`
4.  在 GeoIP.c 中更改`PACKAGE_VERSION`为“1.4.8”
5.  `static const`在 GeoIPCity.c 中，声明数组时不能使用 a 。改变`tmp_fixed_record`to 的定义`unsigned char tmp_fixed_record[6+4]; //Can't use CITYCONFIDENCEDIST_FIXED_RECORD in declaration`
6.  在 GeoIPCity.c`t`的开头声明`_extract_record()`。
7.  将 main 函数添加到 GeoIPCity.c 以编译您的代码。
8.  [从http://www.winimage.com/zLibDll/index.html](http://www.winimage.com/zLibDll/index.html)下载 zlib125.dll.zip 文件。提取这些文件并将 dllx64/* 和 static64/zlibstat.lib 文件保存到磁盘上的某个位置。现在，在 Visual Studio 中转到 Project->Properties->Linker->Input 并在“Additional Dependencies”下添加“ws2_32.lib zlibwapi.lib zlibstat.lib”。接下来，在 Linker->General 下，转到“Additional Library Dependencies”并添加上面保存文件的位置。
9.  在 GeoIPCity.c 和 GeoIP.c`pread`中未定义。将以下定义添加到每个文件中：

```
#define pread my_pread
static size_t my_pread( int file_no, void *buffer, size_t size, size_t offset )
{
  if (_lseek( file_no, (long)offset, SEEK_SET) == offset)
    return _read(file_no, buffer, (int)size);
  else
    return -1L;
} 
```

此外，添加`#include <io.h>`到 GeoIP.h 以便包含`_lseek`和`_read`。

# ios - LLDB 手册/文档

> ID：12187042
> 
> 赞同：8
> 
> 时间：2012-08-29T21:51:59.717
> 
> 标签：ios, xcode, debugging, prompt, lldb

我想更好地了解如何使用 LLDB 调试我的 iOS 代码。我经常看到我的同事使用提示进行调试，例如查看变量的值等。我在哪里可以找到一些关于如何在命令行上使用 LLDB 调试器的文档？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T10:39:25.803

如果您可以访问这些视频，您可能希望从 6 月开始在 lldb 上观看 Apple WWDC 会话视频。 [https://developer.apple.com/videos/wwdc/2012/](https://developer.apple.com/videos/wwdc/2012/) 会话标题为“Debugging with LLDB”，会话描述为

> LLDB 是 OS X 和 iOS 的下一代调试器。通过控制台界面和 Xcode 的图形调试器了解如何使用 LLDB。创建 LLDB 的团队将展示最新的功能和改进，帮助您比以往更有效地跟踪错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T21:56:53.737

我认为[这](http://lldb.llvm.org/tutorial.html)是 LLDB 的最佳资源，因为它是官方教程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-08T16:43:53.443

看起来[Apple 终于在 2013 年 9 月左右编写了 LLDB 文档](https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/gdb_to_lldb_transition_guide/document/Introduction.html)。

我添加这个答案是因为这个问题在我的搜索中是热门问题，而且 Apple 通常在文档方面做得很好（当他们最终解决它时）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-30T05:49:33.103

这个 GDB->LLDB 图表可能会有所帮助，即使您不熟悉 GDB：

[http://lldb.llvm.org/lldb-gdb.html](http://lldb.llvm.org/lldb-gdb.html)

# delphi - 服务应用程序的实时日志记录

> ID：12187043
> 
> 赞同：1
> 
> 时间：2012-08-29T21:52:30.317
> 
> 标签：delphi, logging, delphi-xe2

我有一个服务应用程序，我将很快实现一个日志文件。在开始编写它如何保存日志文件之前，我还有一个要求，即应该可以使用一个小的简单表单应用程序来实时查看日志。换句话说，如果服务将某些内容写入日志，它不仅应该将其保存到文件中，而且其他应用程序应该立即知道并显示记录的内容。

一个肮脏的解决方案是让这个应用程序不断地打开这个文件并检查最近的变化，并加载任何新的东西。但这是非常草率和沉重的。另一方面，我可以编写一个服务器/客户端套接字对并通过那里监视它，但我认为使用 TCP/IP 发送一个字符串有点过载。我正在考虑使用文件方法，但是我该如何以一种不会那么重的方式来实现呢？换句话说，假设日志文件增长到 100 万行。我不想加载整个文件，我只需要检查文件末尾是否有新数据。我也可以延迟最多 5 秒，但这与“实时”相矛盾。

我熟悉的读取/写入文件的唯一方法包括保持文件打开/锁定和读取文件的所有内容，我不知道如何只从文件末尾读取部分内容并保护它从试图访问它的两个应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T23:49:02.827

你所要求的正是我在我公司的一个项目中所做的。

它有一个托管进程外 COM 对象的服务，因此我们所有的应用程序都可以将消息写入中央日志文件，然后是一个单独的查看器应用程序，该应用程序使用相同的 COM 对象在日志出现时直接从服务接收通知文件更改。COM 对象让查看者知道日志文件的物理位置，以便查看者可以在需要时直接打开文件。

对于收到的每个通知，查看器都会检查新文件的大小，然后仅读取自上次通知以来写入的新字节（查看器会跟踪先前的文件大小）。在早期版本中，我让服务直接将每个单独的日志条目推送到查看器，但在负载过重的情况下需要筛选大量流量，所以我最终取消了该功能并让查看器处理读取数据相反，它可以更有效地一次读取多个日志条目。

服务和查看器都同时打开了日志文件。当服务创建/打开日志文件时，它将文件设置为具有只读共享的读/写访问权限。当查看器打开文件时，它会将文件设置为具有读/写共享的只读访问权限（因此服务仍然可以对其进行写入）。

不用说，服务和查看器都在同一台机器上运行，因此它们可以访问同一个本地文件（不使用远程文件）。尽管该服务确实具有通过 TCP/IP 将日志条目转发到在另一台机器上运行的服务的远程实例的功能（然后在该机器上运行的查看器可以看到它们）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T05:40:20.450

我们的[开源`TSynLog`类满足您的大部分需求](http://blog.synopse.info/post/2011/04/14/Enhanced-logging-in-SynCommons)- 它已经稳定且经过验证（用于现实世界的应用程序，包括服务）。

它主要具有快速日志记录（具有一组级别，而不是级别层次结构）、带有堆栈跟踪的异常拦截和自定义日志记录（包括将对象序列化为日志中的 JSON）。

您甚至还有一些附加功能，例如*客户端方法分析器*和[日志查看器](http://blog.synopse.info/post/2011/08/20/Enhanced-Log-viewer)。

日志文件在生成期间被锁定：您可以读取它们，而不是修改它们。

适用于从 Delphi 5 到 XE2，完全开源并每日更新。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T22:06:49.813

这听起来像是一个完全疯狂的答案，但是..

我使用 Gurock Softwares Smart Inspect.. [http://www.gurock.com/smartinspect/](http://www.gurock.com/smartinspect/) 它很棒，因为您可以发送图片、变量以及所有内容，因此当您需要文本自动取款机时，它非常适合观看您的应用程序即使在远程机器上也是实时的..它可以将其发送到本地文件..

它可能是对您的问题的有用答案，或者是一条红鲱鱼 - 它有点不合常规，但您以后可能会觉得值得加入它的附加功能（例如，如果出现严重错误，它非常适合捕获信息）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-30T02:02:56.737

几年前，我编写了一个循环缓冲区二进制文件跟踪日志系统，它避免了文件无限增长的问题，同时为我提供了我想要的功能，例如，如果我愿意，能够看到问题，否则，能够忽略跟踪缓冲区。

但是，如果您想要一个连续的在线系统，那么我根本不会使用文件。

我使用文件是因为我确实想要类似文件的持久性并且不需要运行侦听器应用程序。我只是想要文件解决方案，因为我希望无论现在是否有人在“听”，我都希望记录发生，但没有使用无休止增长的文本日志，因为我担心在日志文件上用完数百兆，并填满我 250 兆字节的硬盘。在 1 TB 硬盘的时代，人们几乎没有这样的担忧。

正如大卫所说，客户端服务器解决方案是最好的，而且并不复杂。

但是你可能更喜欢文件，就像我一样，在我的情况下。我只是将我的查看器应用程序作为崩溃后运行的事后分析工具启动。这是在 MadExcept 或类似的东西出现之前，所以我有一些应用程序刚刚死掉，我想知道发生了什么。

在我的循环缓冲区之前，我会使用像 sys-internals DebugView 和 OutputDebugString 这样的调试视图工具，但是在我启动 DebugView 之前发生崩溃时，这对我没有帮助。

基于文件的日志记录（二进制）是我允许自己创建二进制文件的少数几次之一。我通常讨厌讨厌讨厌二进制文件。但是您只是尝试制作一个循环缓冲区而不使用固定长度的二进制记录。

这是一个示例单元。如果我现在而不是在 1997 年写这篇文章，我就不会使用“记录文件”，但是，嘿，就是这样。

要扩展此单元以便将其用作实时查看器，我建议您只需检查二进制文件上的日期时间戳并每 1-5 秒刷新一次（您的选择），但仅当二进制跟踪上的日期时间戳文件已更改。不难，也不会对系统造成很大的负担。

该单元用于记录器和查看器，它是一个可以读取和写入磁盘上的循环缓冲区二进制文件的类。

```
unit trace;

{$Q-}
{$I-}

interface

uses Classes;

const
  traceBinMsgLength = 255; // binary record message length
  traceEOFMARKER = $FFFFFFFF;

type
  TTraceRec = record
    index: Cardinal;
    tickcount: Cardinal;
    msg: array[0..traceBinMsgLength] of AnsiChar;
  end;
  PTraceBinRecord = ^TTraceRec;
  TTraceFileOfRecord = file of TTraceRec;

  TTraceBinFile = class
    FFilename: string;
    FFileMode: Integer;
    FTraceFileInfo: string;
    FStorageSize: Integer;
    FLastIndex: Integer;
    FHeaderRec: TTraceRec;
    FFileRec: TTraceRec;
    FAutoIncrementValue: Cardinal;
    FBinaryFileOpen: Boolean;
    FBinaryFile: TTraceFileOfRecord;
    FAddTraceMessageWhenClosing: Boolean;
  public
    procedure InitializeFile;
    procedure CloseFile;
    procedure Trace(msg: string);
    procedure OpenFile;
    procedure LoadTrace(traceStrs: TStrings);
    constructor Create;
    destructor Destroy; override;

    property Filename: string       read FFilename write FFilename;
    property TraceFileInfo: string  read FTraceFileInfo write FTraceFileInfo;

   // Default 1000 rows.
   // change storageSize to the size you want your circular file to be before
   // you create and write it. Remember to set the value to the same number before
   // trying to read it back, or you'll have trouble.
    property StorageSize: Integer   read FStorageSize write FStorageSize;
    property AddTraceMessageWhenClosing: Boolean
      read FAddTraceMessageWhenClosing write FAddTraceMessageWhenClosing;

  end;

implementation

uses SysUtils;

procedure SetMsg(pRec: PTraceBinRecord; msg: ansistring);
var
  n: Integer;
begin
  n := length(msg);
  if (n >= traceBinMsgLength) then
  begin
    msg := Copy(msg, 1, traceBinMsgLength);
    n := traceBinMsgLength;
  end;
  StrCopy({Dest} pRec^.msg, {Source} PAnsiChar(msg));
  pRec^.msg[n] := Chr(0); // ensure nul char termination
end;

function IsBlank(var aRec: TTraceRec): Boolean;
begin
  Result := (aRec.msg[0] = Chr(0));
end;

procedure TTraceBinFile.CloseFile;
begin
  if FBinaryFileOpen then
  begin
    if FAddTraceMessageWhenClosing then
    begin
      Trace('*END*');
    end;
    System.CloseFile(FBinaryFile);
    FBinaryFileOpen := False;
  end;
end;

constructor TTraceBinFile.Create;
begin
  FLastIndex := 0; // lastIndex=0 means blank file.
  FStorageSize := 1000; // default.
end;

destructor TTraceBinFile.Destroy;
begin
  CloseFile;
  inherited;
end;

procedure TTraceBinFile.InitializeFile;
var
  eofRec: TTraceRec;
  t: Integer;
begin
  Assert(FStorageSize > 0);
  Assert(Length(FFilename) > 0);
  Assign(FBinaryFile, Filename);
  FFileMode := fmOpenReadWrite;
  Rewrite(FBinaryFile);

  FBinaryFileOpen := True;

  FillChar(FHeaderRec, sizeof(TTraceRec), 0);
  FillChar(FFileRec, sizeof(TTraceRec), 0);
  FillChar(EofRec, sizeof(TTraceRec), 0);

  FLastIndex := 0;
  FHeaderRec.index := FLastIndex;
  FHeaderRec.tickcount := storageSize;
  SetMsg(@FHeaderRec, FTraceFileInfo);

  Write(FBinaryFile, FHeaderRec);
  for t := 1 to storageSize do
  begin
    Write(FBinaryFile, FFileRec);
  end;

  SetMsg(@eofRec, 'EOF');
  eofRec.index := traceEOFMARKER;
  Write(FBinaryFile, eofRec);
end;

procedure TTraceBinFile.Trace(msg: string);
// Write a trace message in circular file.
begin
  if (not FBinaryFileOpen) then
    exit;
  if (FFileMode = fmOpenRead) then
    exit; // not open for writing!
  Inc(FLastIndex);
  if (FLastIndex > FStorageSize) then
    FLastIndex := 1; // wrap around to 1 not zero! Very important!
  Seek(FBinaryFile, 0);
  FHeaderRec.index := FLastIndex;
  Write(FBinaryFile, FHeaderRec);
  FillChar(FFileRec, sizeof(TTraceRec), 0);
  Seek(FBinaryFile, FLastIndex);
  Inc(FAutoIncrementValue);
  if FAutoIncrementValue = 0 then
    FAutoIncrementValue := 1;
  FFileRec.index := FAutoIncrementValue;
  SetMsg(@FFileRec, msg);
  Write(FBinaryFile, FFileRec);
end;

procedure TTraceBinFile.OpenFile;
begin
  if FBinaryFileOpen then
  begin
    System.CloseFile(FBinaryFile);
    FBinaryFileOpen := False;
  end;
  if FileExists(FFilename) then
  begin
    //    System.FileMode :=fmOpenRead;
    FFileMode := fmOpenRead;
    AssignFile(FBinaryFile, FFilename);
    System.Reset(FBinaryFile); // open in current mode
    System.Seek(FBinaryFile, 0);
    Read(FBinaryFile, FHeaderRec);
    FLastIndex := FHeaderRec.index;
    FTraceFileInfo := string(FHeaderRec.Msg);
    FBinaryFileOpen := True;
  end
  else
  begin
    InitializeFile; // Creates the file.
  end;
end;

procedure TTraceBinFile.LoadTrace(traceStrs: TStrings);
var
  ReadAtIndex: Integer;
  Safety: Integer;

  procedure NextReadIndex;
  begin
    Inc(ReadAtIndex);
    if (ReadAtIndex > FStorageSize) then
      ReadAtIndex := 1; // wrap around to 1 not zero! Very important!
  end;

begin
  Assert(Assigned(traceStrs));
  traceStrs.Clear;

  if not FBinaryFileOpen then
  begin
    OpenFile;
  end;

  ReadAtIndex := FLastIndex;

  NextReadIndex;

  Safety := 0; // prevents endless looping.

  while True do
  begin
    if (ReadAtIndex = FLastIndex) or (Safety > FStorageSize) then
      break;
    Seek(FBinaryFile, ReadAtIndex);
    Read(FBinaryFIle, FFileRec);
    if FFileRec.msg[0] <> chr(0) then
    begin
      traceStrs.Add(FFileRec.msg);
    end;
    Inc(Safety);
    NextReadIndex;
  end;
end;

end. 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-30T23:37:18.880

看看这篇文章。

[TraceTool 12.4：Trace 的瑞士军刀](http://www.codeproject.com/Articles/5498/TraceTool-12-4-The-Swiss-Army-Knife-of-Trace)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-29T22:41:25.867

我的建议是以日志文件每天“滚动”的方式实现您的日志记录。例如，在午夜，您的日志记录代码将您的日志文件（例如 MyLogFile.log）重命名为过时/归档版本（例如 MyLogFile-30082012.log），并开始一个新的空“实时”日志（例如再次 MyLogFile.log）。

那么这只是一个使用[BareTail](http://www.baremetalsoft.com/baretail/)之类的东西来监视您的“实时”/每日日志文件的问题。

我接受这可能不是网络效率最高的方法，但它相当简单并且满足您的“实时”要求。

# r - autokrige 和 proj4string

> ID：12187045
> 
> 赞同：0
> 
> 时间：2012-08-29T21:52:43.003
> 
> 标签：r, spatial-interpolation, automap

我正在使用包中的 R 函数`autokrige`，`automap`但出现错误，我不知道如何解决。你有什么提示吗？

谢谢！

```
sp.poidf <- SpatialPointsDataFrame(sp.poi,thresh.df)
proj4string(sp.poidf) <- CRS("+proj=longlat +datum=WGS84")
pro.df=spTransform(sp.poidf, CRS("+proj=merc +zone=32s +datum=WGS84"))
sp.new <- SpatialPoints(new.poi)
proj4string(sp.new) <- CRS("+proj=longlat +datum=WGS84")
pro.new <- spTransform(sp.new, CRS("+proj=merc +zone=32s +datum=WGS84"))
mykri <- autoKrige(mythresh~1,pro.df,newdata=pro.new)

Error in function (classes, fdef, mtable)  : 
unable to find an inherited method for function "proj4string", for signature "NULL" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T05:28:07.493

以下代码重现了您的问题：

```
require(automap)
require(rgdal)
loadMeuse()

proj4string(meuse) = CRS("+init=epsg:28992")
proj4string(meuse.grid) = CRS("+init=epsg:28992")
meuse = spTransform(meuse, CRS("+proj=merc +zone=32s +datum=WGS84"))
# Note that meuse.grid no longer is a grid due to the reprojection
meuse.grid = spTransform(meuse.grid, CRS("+proj=merc +zone=32s +datum=WGS84"))

kr = autoKrige(zinc~1, meuse, newdata = meuse.grid)
Error in function (classes, fdef, mtable)  : 
  unable to find an inherited method for function "proj4string", for signature "NULL" 
```

问题是您使用`newdata =`，而您应该使用`new_data =`（注意下划线）。以下代码运行良好：

```
kr = autoKrige(zinc~1, meuse, new_data = meuse.grid) 
```

的文档`autoKrige`显示了这一点，但是`krige`（来自 gstat）使用`newdata`，所以我理解这种混淆。

出问题的是它`newdata =`不被 识别`autoKrige`，并放入`...`参数列表的一部分。`autoKrige`调用时，提供者和提供者`krige`之间存在冲突。为了防止其他用户收到相当模糊的错误消息，我在 automap 中添加了一个检查。错误的代码现在导致异常：`new_data``autoKrige``newdata``...`

```
> kr = autoKrige(zinc~1, meuse, newdata = meuse.grid)
Error in autoKrige(zinc ~ 1, meuse, newdata = meuse.grid) : 
  The argument name for the prediction object is not 'newdata', but 'new_data'. 
```

# c# - 在 ASP.NET 中打印

> ID：12187047
> 
> 赞同：-2
> 
> 时间：2012-08-29T21:53:00.290
> 
> 标签：c#, .net, asp.net-3.5, printing-web-page, system.printing

我有一个名为“Details.aspx”的 asp.net 网页。在那我有两个标签命名：“名字”和“姓氏”。我有两个用于插入值的文本框。我有一个名为“打印”的按钮当我点击打印按钮时，我如何打印在文本框中输入的值。

例如：最终打印件应如下所示：-

> 你的名字是：马修
> 你的姓是：托马斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T21:57:33.077

您可以做的是拥有一个适合打印的页面版本，其中包含所需格式的内容 当您单击“打印”按钮时，在新窗口中打开该页面（您可以使用`window.open`JavaScript）。在该页面中，调用`window.print`将打开浏览器的打印对话框的 JavaScript 函数。

# django - 自定义用户管理员

> ID：12187050
> 
> 赞同：1
> 
> 时间：2012-08-29T21:53:36.237
> 
> 标签：django, django-models, django-admin, django-admin-filters

我正在尝试像这样自定义 UserAdmin：

```
from django.contrib import admin
from django.contrib.auth.models import User

admin.site.unregister(User)

class CustomUserAdmin(admin.ModelAdmin):
    filter_horizontal = ('groups',)
    list_display = ('username', 'email', 'last_login')

admin.site.register(User, CustomUserAdmin) 
```

但是，在执行此操作并在管理站点上进行测试后，这些更改并未反映出来。

如果我删除最后一行：

```
admin.site.register(User, CustomUserAdmin) 
```

它会抛出一个错误，指出用户未注册，所以我认为它正在识别新管理员，只是没有任何效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T22:55:13.023

不确定是否是这种情况，但也许您应该从 ModelAdmin 继承`from django.contrib.auth.admin import UserAdmin`而不是从 ModelAdmin 继承。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-19T20:08:25.433

覆盖内置的 UserAdmin 可能更简单，更改您需要的内容：

```
from django.contrib import admin
from django.contrib.auth.models import User
from django.contrib.auth.admin import UserAdmin

admin.site.unregister(User)

UserAdmin.filter_horizontal = ('groups',)
UserAdmin.list_display = ('username', 'email', 'last_login')

admin.site.register(User, UserAdmin) 
```

# python - 在python脚本中查找具有变量名的文件

> ID：12187051
> 
> 赞同：1
> 
> 时间：2012-08-29T21:53:39.400
> 
> 标签：python, linux, shell-exec

我正在尝试在 python 脚本中执行 find 命令，使用 for 循环传递变量索引来确定要查找的特定文件名。我正在使用以下语法，它在 python 中返回一个空集，但在终端中有效：

```
for j in [1,2,3,5]:  
    file_name = cmd.getoutput('find . -type f -name "*${j}-xyz.stc" -printf "%f\n"') 
```

显然，该变量没有被传递给我的 python 代码中的 find 表达式，但我该如何补救呢？任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T21:58:07.930

变量在 python 中的扩展与在 bash 中的扩展不同。你可能想要：

```
command = r'find . -type f -name "*{0}-xyz.stc" -printf "%f\n"'.format(j)
file_name = cmd.getoutput(command) 
```

另请注意，该`commands`模块已弃用，取而代之的是`subprocess`. 最后，可能应该指出的是，您可以在*python*中编写此函数，而无需依赖`find`是否`os.walk`与`glob.glob`.

*未经测试，但这样的事情应该很接近......*

```
import os
import glob

def find_files(glob_expr):
    for root,_,_ in os.walk(os.curdir):
        for fname in glob.iglob(os.path.join(os.curdir,root,glob_expr)):
            yield fname
for i in (1,2,3,4):
    print (list(find_files('{0}-xyz.stc'.format(i)))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T21:57:57.193

```
file_name = cmd.getoutput('find . -type f -name "*%i-xyz.stc" -printf "%%f\n"' % (j)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T23:30:14.600

Passing filenames in a string to the shell is unsafe (leads to potentially security-impacting bugs). Best practice is to pass an explicit `argv` list:

```
import subprocess
for j in range(1, 6):
    file_name = subprocess.check_output(['find', '.', '-type', 'f', '-name',
                                         '*%s-xyz.stc' % (j,),
                                         '-printf', '%f\\n']) 
```

If you *really* care about correctness (and you should!), use `'%f\\0'` as your format string, and expect your outputs to be NUL-separated. Otherwise, you can't tell the difference between a file with a newline in its name and two files returned.

To appreciate the importance, consider the case where an attacker can persuade software running on your system to create a file named like so:

```
/your/top/dir/$'\n'/etc/passwd$'\n'/1-xyz.stc 
```

If you treat each line returned by find as a filename, you would consider `/etc/passwd` to be part of your returned values -- a very bad thing if you then present this data to the user, delete it, etc.

# symfony - Symfony2：错误持久多对多/一对多关系

> ID：12187053
> 
> 赞同：2
> 
> 时间：2012-08-29T21:54:02.940
> 
> 标签：symfony, doctrine

我不知道为什么，也许我错过了一些基本逻辑，但我总是再次遇到同样的问题。我不能保留 ManyToMany 集合，它也面临着 OneToMany 集合，尽管我可以解决这个问题。

我通读了学说文档，我想我确实理解了 mappedBy 和 inversedBy 的东西（最后一个始终是所有者，因此负责保存数据，如果我错了，请纠正我）。

所以这是我现在拥有的一个基本示例，我无法弄清楚。

我有一个名为**Site**的实体：

```
#Site.php
...
/**
 * @ORM\ManyToMany(targetEntity="Category", mappedBy="sites")
 */
protected $categories; 
```

另一个叫做**Category**：

```
#Category.php
...
/**
 * @ORM\ManyToMany(targetEntity="Site", inversedBy="categories")
 * @ORM\JoinTable(name="sites_categories")
 */
protected $sites; 
```

使用 Symfony2 实体生成器，它为我的实体添加了一些 getter 和 setter，看起来像这样。

**网站**：

```
#Site.php
...
/**
 * Add categories
 *
 * @param My\MyBundle\Entity\Category $categories
 */
public function addCategory(\My\MyBundle\Entity\Category $categories)
{
    $this->categories[] = $categories;
}

/**
 * Get categories
 *
 * @return Doctrine\Common\Collections\Collection 
 */
public function getCategories()
{
    return $this->categories;
} 
```

同样重要的是

**类别**：

```
#Category.php
...
/**
 * Add sites
 *
 * @param My\MyBundle\Entity\Site $sites
 */
public function addSite(\My\MyBundle\Entity\Site $sites)
{
    $this->sites[] = $sites;
}

/**
 * Get sites
 *
 * @return Doctrine\Common\Collections\Collection 
 */
public function getSites()
{
    return $this->sites;
} 
```

很公平。

现在在我的控制器中，我试图保留一个 Site 对象：

```
public function newsiteAction() {

    $site = new Site();
    $form = $this->createFormBuilder($site); // generated with the FormBuilder, so the form includes Category Entity

    // ... some more logic, like if(POST), bindRequest() etc.

        if ($form->isValid()) {
            $em = $this->getDoctrine()
            ->getEntityManager();
            $em->persist($site);
            $em->flush();
        }
} 
```

结果总是一样的。**它保留站点对象，但不保留类别实体。**而且我也知道为什么（我认为）：因为 Category 实体是拥有方。

但是，我是否总是必须做这样的事情才能坚持下去？（这实际上是我对一些 OneToMany 集合的解决方法）

```
$categories = $form->get('categories')->getData();
foreach($categories as $category) {
    // persist etc.
} 
```

但是我在这里遇到了很多问题，比如我必须执行与上面相同的循环来删除、编辑等。

有什么提示吗？我真的会给能够让我清醒的人一个网络拥抱。谢谢！

. . .

# 更新

我最终改变了 ManyToMany 映射之间的关系（拥有和反向）。

如果其他人遇到这个问题，你需要清楚双向关系的概念，我也花了一段时间才理解（我希望我现在明白了，请参阅此[链接](http://doctrine-orm.readthedocs.org/en/2.0.x/reference/association-mapping.html#association-mapping-owning-inverse)）。基本上我的问题是：您要保留的对象**必须**始终是拥有站点（拥有站点**始终**是在注释中“反转”的实体）。

还有一个级联注释的概念（请参阅此[链接](http://doctrine-orm.readthedocs.org/en/2.0.x/reference/working-with-associations.html)，感谢[moonwave99](https://stackoverflow.com/users/1073758/moonwave99)）

所以谢谢，我希望这对将来的参考有所帮助！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:16:00.903

关于`OneToMany`关系，您想了解**级联**注释 - 来自[Doctrine docs](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/working-with-associations.html#transitive-persistence-cascade-operations) [8.6]：

> 存在以下级联选项：
> 
> *   persist ：级联将操作持久化到关联实体。
> *   remove ：级联删除操作到关联实体。
> *   merge ：级联合并操作到关联实体。
> *   detach : 将分离操作级联到关联的实体。
> *   all ：级联对关联实体进行持久化、删除、合并和分离操作。

以下文档示例：

```
<?php
class User
{
    //...
    /**
     * Bidirectional - One-To-Many (INVERSE SIDE)
     *
     * @OneToMany(targetEntity="Comment", mappedBy="author", cascade={"persist", "remove"})
     */
    private $commentsAuthored;
    //...
} 
```

当您向作者添加评论时，它们会在您保存它们时保留 - 当您删除作者时，评论也会告别。

我最近在设置 REST 服务时遇到了同样的问题，级联注释让我摆脱了你之前提到的所有解决方法 [我在一开始就使用了] - 希望这会有所帮助。

# ios5 - Titanium：无法切换选项卡、关闭选项卡以及当前选项卡以外的任何内容

> ID：12187055
> 
> 赞同：0
> 
> 时间：2012-08-29T21:54:14.710
> 
> 标签：ios5, titanium, appcelerator, titanium-mobile

我尝试的一切都什么都不做，没有错误，消息，真的什么。所以我有三个选项卡，第一个是登录选项卡，每个选项卡都有自己的.js 代码，例如，登录有自己的 login.js。现在，我使用 httpClient 对我们的网站进行身份验证，现在想删除登录选项卡并显示其他选项卡，无法让它为我的生活工作，我现在可以删除登录选项卡但无法加载任何其他选项卡。让我发疯，因为我找到了 20 个示例，但他们要么没有将选项卡分成自己的 .js 文件，要么只是简单的示例对我不起作用。帮助！这似乎很基本，但...

**应用程序.js**

```
 // this sets the background color of the master UIView (when there are no windows/tab groups on it)
    Titanium.UI.setBackgroundColor('#000');

    // create tab group
    var tabGroup = Titanium.UI.createTabGroup();

    // create base UI tab and root window
    //
    var scan = Titanium.UI.createWindow({  
        title:'Scan',
        backgroundColor:'#fff',
        url:'scan.js',
        mylabel:'Hello Scan'
    });

    var tab1 = Titanium.UI.createTab({  
        icon:'KS_nav_views.png',
        title:'Scan',
        window:scan
    });

    var login = Titanium.UI.createWindow({  
        title:'User Authentication',  
        tabBarHidden:true,  
        url:'login.js'  
    });  

    var loginTab = Titanium.UI.createTab({  
        title:"Login",  
        window:login  
    });  

    //
    // create controls tab and root window
    //
    var win2 = Titanium.UI.createWindow({  
        title:'Manual',
        backgroundColor:'#fff'
    });
    var tab2 = Titanium.UI.createTab({  
        icon:'KS_nav_ui.png',
        title:'Manual',
        window:win2
    });

    var label2 = Titanium.UI.createLabel({
        color:'#999',
        text:'I am Manual Window ',
        font:{fontSize:20,fontFamily:'Helvetica Neue'},
        textAlign:'center',
        width:'auto'
    });

    win2.add(label2);

    //
    //  add tabs
    //
    tabGroup.addTab(loginTab); 
    tabGroup.addTab(tab1);  
    tabGroup.addTab(tab2); 

    // open tab group
    tabGroup.open(); 
```

**登录.js**

```
 var win = Titanium.UI.currentWindow;  
    var tabGroup = Ti.UI.currentWindow.tabGroup;

    var appUrl = "http://localhost:3001/ticket_agents/sign_in";

    var email = Titanium.UI.createTextField({  
        color:'#336699',  
        top:10,  
        left:10,  
        width:300,  
        height:40,  
        hintText:'Email',  
        keyboardType:Titanium.UI.KEYBOARD_DEFAULT,  
        returnKeyType:Titanium.UI.RETURNKEY_DEFAULT,  
        borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED  
    });  
    win.add(email);  

    var password = Titanium.UI.createTextField({  
        color:'#336699',  
        top:60,  
        left:10,  
        width:300,  
        height:40,  
        hintText:'Password',  
        passwordMask:true,  
        keyboardType:Titanium.UI.KEYBOARD_DEFAULT,  
        returnKeyType:Titanium.UI.RETURNKEY_DEFAULT,  
        borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED  
    });  
    win.add(password);  

    var loginBtn = Titanium.UI.createButton({  
        title:'Login',  
        top:110,  
        width:90,  
        height:35,  
        borderRadius:1,  
        font:{fontFamily:'Arial',fontWeight:'bold',fontSize:14}  
    });  

    var loginReq = Titanium.Network.createHTTPClient({  

         onload : function(e)  { 
            var json = this.responseText;  
            var response = JSON.parse(json); 
            Ti.API.info("Received text: " + this.responseText);
            if (response.id > 0)
            {
                alert("login Success");
                win.tabGroup.close();
                tabGroup.removeTab(loginTab);
                tabGroup.setActiveTab(2);
                tabGroup.open();
            }
            else
            {
                alert("Unknown login error");
            }
        },  

        onerror : function(e) {
            var response = this.responseText;
            Ti.API.debug(e.error);
            alert('error: ' + this.responseText);
        },
        timeout : 5000
    });

    loginBtn.addEventListener('click',function(e)  
    {  
        if (email.value != '' && password.value != '')  
        {  
            loginReq.open("POST",appUrl);  
            var params = {ticket_agent: {email: email.value, password: password.value, remember_me: 0} 
            }; 
            var authstr = 'Basic ' + Titanium.Utils.base64encode(email.value + ':' + password.value);
            loginReq.setRequestHeader("Content-Type", "application/json; charset=utf-8");
            loginReq.setRequestHeader('Authorization', authstr);
            loginReq.send(JSON.stringify(params));  
        }  
        else  
        {  
            alert("Email/Password are required");  
        }  
    });  

    win.add(loginBtn); 
```

我认为这就是您需要看到的全部内容，login.js 有我最近的尝试，但我已经尝试过 tabGroup.open({url : 'app.js'}) 和其他四个选项中的大约三个。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-11T17:26:25.213

您可能希望将此 eventListener 添加到 tabGroup 所在的 app.js 中。然后，您可以从任何地方触发“app:gotoTab”事件。

**应用程序.js**

```
Ti.App.addEventListener('app:gotoTab', function(e) {
    tabGroup.setActiveTab(e.tab);
}); 
```

**登录.js**

```
// tab index starts with 0, so 0 is your first tab
Ti.App.fireEvent('app:gotoTab', { tab: 0 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T09:32:41.613

只需复制粘贴此代码 Login.js

```
var win = Titanium.UI.currentWindow;  

    var appUrl = "http://localhost:3001/ticket_agents/sign_in";

    var email = Titanium.UI.createTextField({  
        color:'#336699',  
        top:10,  
        left:10,  
        width:300,  
        height:40,  
        hintText:'Email',  
        keyboardType:Titanium.UI.KEYBOARD_DEFAULT,  
        returnKeyType:Titanium.UI.RETURNKEY_DEFAULT,  
        borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED  
    });  
    win.add(email);  

    var password = Titanium.UI.createTextField({  
        color:'#336699',  
        top:60,  
        left:10,  
        width:300,  
        height:40,  
        hintText:'Password',  
        passwordMask:true,  
        keyboardType:Titanium.UI.KEYBOARD_DEFAULT,  
        returnKeyType:Titanium.UI.RETURNKEY_DEFAULT,  
        borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED  
    });  
    win.add(password);  

    var loginBtn = Titanium.UI.createButton({  
        title:'Login',  
        top:110,  
        width:90,  
        height:35,  
        borderRadius:1,  
        font:{fontFamily:'Arial',fontWeight:'bold',fontSize:14}  
    });  

    var loginReq = Titanium.Network.createHTTPClient({  

         onload : function(e)  { 
            var json = this.responseText;  
            var response = JSON.parse(json); 
            Ti.API.info("Received text: " + this.responseText);
            if (response.id > 0)
            {
                alert("login Success");
                tabGroup.setActiveTab(2);

            }
            else
            {
                alert("Unknown login error");
            }
        },  

        onerror : function(e) {
            var response = this.responseText;
            Ti.API.debug(e.error);
            alert('error: ' + this.responseText);
        },
        timeout : 5000
    });

    loginBtn.addEventListener('click',function(e)  
    {  
        if (email.value != '' && password.value != '')  
        {  
            loginReq.open("POST",appUrl);  
            var params = {ticket_agent: {email: email.value, password: password.value, remember_me: 0} 
            }; 
            var authstr = 'Basic ' + Titanium.Utils.base64encode(email.value + ':' + password.value);
            loginReq.setRequestHeader("Content-Type", "application/json; charset=utf-8");
            loginReq.setRequestHeader('Authorization', authstr);
            loginReq.send(JSON.stringify(params));  
        }  
        else  
        {  
            alert("Email/Password are required");  
        }  
    });  

    win.add(loginBtn); 
```

嘿罗斯，你总是记得 window.close 完美地在子窗口上工作。

在这个应用程序中。您可以使用单个窗口基础应用程序。如果，在第一个窗口登录成功然后，您可以打开第二个子窗口。

有关更多详细信息，您可以使用 KICHEN Shink 示例。这对你非常有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T16:22:58.327

您可能想要重新设计您的 UI。Apple 人机界面指南明确指出，您不应以编程方式切换选项卡或添加/删除选项卡。他们希望标签组只有在您将其放在他们面前时才应由用户控制。

如果用户需要登录才能使用您应用的其他功能，您可以在带有选项卡组的窗口之前显示登录窗口。否则，您应该在成功登录后将登录选项卡的内容替换为其他内容，可能是用户个人资料信息或一些说明。

# javascript - setTimeout 导致无限循环

> ID：12187057
> 
> 赞同：0
> 
> 时间：2012-08-29T21:54:16.763
> 
> 标签：javascript, jquery, while-loop, infinite-loop

这是我第一次在实际应用中使用while循环，请原谅我的无知。

我正在创建一个网页，展示随着时间的推移使用灯泡的成本。

在这个阶段，我正在尝试使用 while 循环来更新并显示自用户单击电灯开关以来经过的小时数。（1 小时代表 1 秒实时）

当我在萤火虫上设置断点时，一切都正常运行，直到我在我的 while 循环中到达 setTimeout 方法。在它在 setTimeout 方法处中断并单击继续后，它会立即再次在同一位置中断，而没有实际执行任何其他操作。

当我不设置断点时，它会冻结 firefox，我必须停止脚本执行。

我重新检查以确保我正确使用了 setTimeout。现在我什至不确定在哪里检查或搜索什么，因为我不明白出了什么问题。即使只是提示我可能会检查或研究的内容也会非常有帮助。

我试图尽可能详细地注释代码。如果需要，我很乐意澄清一些事情。

我强烈建议您看一下 jsfiddle：

[JS小提琴](http://jsfiddle.net/loweryaustin/tdS3A/19/)

但这是我的代码：

我的JS

```
$(document).ready(function () {
    //set image to default off position
    $('#lightswitch').css("background-image", "url(http://www.austinlowery.com/graphics/offswitch.png)");

    // setup the lifetime hours of the lightbulb for later use
    var lifetimeHours = 0;
    // setup function to update the calculated lifetime hours number on the webpage to
    // be called later
    function updateLifetimeHoursHtml (lifetimeHours) {
        $('#lifetimeHours').html(lifetimeHours);
    }
    // set up function to to send to setTimeout
    function updateNumbers () {
        // increment lifetimeHours by one
        lifetimeHours = lifetimeHours++;
        // call function to update the webpage with the new number result
        updateLifetimeHoursHtml(lifetimeHours);
    }

    // When the lightswitch on the webpage is clicked, the user should see the
    // lifetime hours update every second until the user clicks the switch again
    // which will then display the off graphic and pause the updating of the lifetime
    // hours
    $('#lightswitch').click(function(){
        // if the lightswitch is off:
        if ($('#lightswitch').attr('state') == 'off') {
            // set switch to on
            $('#lightswitch').attr('state', 'on');
            // update graphic to reflect state change
            $('#lightswitch').css("background-image", "url(http://austinlowery.com/graphics/onswitch.png)");
            // start updating the lifetime hours number on the webpage
            // while the #lightswitch div is in the on state:
            while ($('#lightswitch').attr('state') == 'on'){
                //call update numbers every second
                setTimeout('updateNumbers()', 1000);
            }
        // the lightswich was not in the off state so it must be on
        }else{
            // change the state of the switch to off
            $('#lightswitch').attr('state', 'off');
            // update graphic to reflect state change
            $('#lightswitch').css("background-image", "url(http://austinlowery.com/graphics/offswitch.png)");
        };
    });
}); 
```

我的 HTML

```
<div id="container">
    <div id="lightswitch" state="off">&nbsp;</div>
        <span>After </span><span id="lifetimehours">0</span><span> lifetime hours:</span>
        <br><br>
        <span><b>You have spent:</b></span>
        <br><br>
        <span id="dollaramoutelectricity"></span><span> on electricty</span>
        <br>
        <span id="mainttime"></span><span> on maintenace</span>
        <br>
        <span id="dollaramountbulbs"></span><span> on replacement bulbs</span>
        <br><br>
        <span><b>You have:</b></span>
        <br><br>
        <span>Produced </span><span id="amountgreenhousegasses"></span><span> of greenhouse gasses</span>
        <br>
        <span>Sent </span><span id="amounttrash"></span><span> of trash to the dump</span>
        <br>
        <span>Used </span><span id="amountelectricty"></span><span> of electricity</span>

</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T22:00:05.197

```
var switchTimer;

$('#lightswitch').click(function(){
    if ($('#lightswitch').attr('state') == 'off') {
        $('#lightswitch').attr('state', 'on');
        switchTimer = setInterval(updateNumbers, 1000);
    } else {
        $('#lightswitch').attr('state', 'off');
        $('#lightswitch').css("background-image", "url(http://austinlowery.com/graphics/offswitch.png)");
        clearInterval(switchTimer);
    }; 
```

Javascript 是一种基于事件的语言。这意味着代码不会持续运行。它仅在有事件时运行。通过使用 while 循环，您基本上已经冻结了它 - javascript 在该循环中不断运行。这对于像 C 这样的语言来说很好，它必须一直运行一些东西。

但这对 javascript 来说是一个错误。对于 javascript，您必须对其进行编码以响应事件，然后停止。setInterval 不断为您生成一个事件，每 xx 毫秒运行一个函数。

在计时器运行之间没有代码正在运行！记住这一点很重要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T22:00:08.020

JavaScript 使用事件循环。因为您的`while`循环永远不会产生（`#lightswitch`'s`state`将永远是`on`因为无限循环锁定 UI，防止用户关闭它），所以事件循环永远不会再次运行，并且您注册的回调`setTimeout`永远不会有机会执行。

你真正想做的是用一个`setInterval`函数更新你的计数器。

```
setInterval(updateNumbers, 1000); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T01:07:52.420

根据 yngum 的回答，

我认为这样更好：

```
if ($('#lightswitch').attr('state') == 'off') {
    $('#lightswitch').attr('state', 'on');
    $('#lightswitch').css("background-image", "url(http://austinlowery.com/graphics/onswitch.png)");
    updateNumbers();
} 
```

进而

```
function updateNumbers () {
    lifetimeHours++;
    updateLifetimeHoursHtml(lifetimeHours);
    if($('#lightswitch').attr('state') == 'on'){
        setTimeout(updateNumbers,1000);
    }
} 
```

在这里看到它：http: [//jsfiddle.net/tdS3A/24/](http://jsfiddle.net/tdS3A/24/)

但是，如果您想要最大精度，则应该存储`new Date().getTime()`，因为执行`setTimeout`or `setInterval`1 秒并不能确保您每秒都会调用它...

```
function updateNumbers () {
    // call function to update the webpage with the new number result
    updateLifetimeHoursHtml(lifetimeHours+(new Date().getTime()-timerStart)/1000);
    // call updateNumbers() again
    if($('#lightswitch').attr('state') == 'on'){
        timer=setTimeout(updateNumbers,1000);
    }
}
$('#lightswitch').click(function(){
    // if the lightswitch is off:
    if ($('#lightswitch').attr('state') == 'off') {
        // set switch to on
        $('#lightswitch').attr('state', 'on');
        // update graphic to reflect state change
        $('#lightswitch').css("background-image", "url(http://austinlowery.com/graphics/onswitch.png)");
        // update the lifetime hours number on the webpage
        timerStart=new Date().getTime();
        timer=setTimeout(updateNumbers,1000);
        // the lightswich was not in the off state so it must be on
    }else{
        // change the state of the switch to off
        lifetimeHours+=(new Date().getTime()-timerStart)/1000;
        clearTimeout(timer);
        $('#lightswitch').attr('state', 'off');
        // update graphic to reflect state change
        $('#lightswitch').css("background-image", "url(http://austinlowery.com/graphics/offswitch.png)");
    };
}); 
```

在这里看到它：http: [//jsfiddle.net/tdS3A/26/](http://jsfiddle.net/tdS3A/26/)

即使您想要具有最大精度的数字，因为您希望计算精确，也许您希望在向用户显示该值时对其进行四舍五入。然后，使用

```
function updateLifetimeHoursHtml (lifetimeHours) {
    $('#lifetimehours').html(Math.round(lifetimeHours));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T22:02:01.860

由于 setTimeout 通常优于 setInterval，因此另一种解决方案是

改变

```
while ($('#lightswitch').attr('state') == 'on'){
    //call update numbers every second
    setTimeout('updateNumbers()', 1000); 
```

到

```
setTimeout(function() {  
    updateNumbers();
    if ($('#lightswitch').attr('state') == 'on') 
        setTimeout(arguments.callee, 1000);
    }, 0); 
```

这将每秒检查一次您的灯开关，并在关闭时停止。

# jquery - jquery - 选择器类型减去名称

> ID：12187063
> 
> 赞同：0
> 
> 时间：2012-08-29T21:54:48.000
> 
> 标签：jquery, jquery-selectors

> **可能重复：**
> [选择具有类的元素，但具有特定 id 的元素除外](https://stackoverflow.com/questions/7636275/select-elements-with-class-except-one-with-specific-id)

我必须选择表单的类型选择，但我想丢弃带有名称的 ID 就像一个单词。

我有：

```
 $("select").onchange(function(){
   alert("change");
 }); 
```

我想要类型

```
$("select minus select with ID like 'noChange'").onchange(function(){
   alert("change");
 }); 
```

tnx

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T21:55:41.023

使用[`:not()`](http://api.jquery.com/not-selector)：

```
$("select:not(#noChange)").onchange(function(){
   alert("change");
}); 
```

或者，如果`noChange`是 ID 的一部分而不是确切的 ID：

```
$("select:not([id*='noChange'])").onchange(function(){
   alert("change");
}); 
```

# c++ - 使用预编译头文件编译 cpp

> ID：12187067
> 
> 赞同：2
> 
> 时间：2012-08-29T21:55:05.377
> 
> 标签：c++, g++, precompiled-headers

假设您有 2 个文件：

*   `A.h`和
*   `A.cpp`, 其中`A.cpp`包括`A.h`

您将标头预编译为`A.h.gch`并删除`A.h`

有2个文件：

*   `A.cpp`和
*   `A.h.gch`,

**如何使用 g++ 编译最终产品？**

就我而言，`g++`抱怨`.h`找不到文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:43:25.447

我不是专家，但来自[维基百科](http://en.wikipedia.org/wiki/Precompiled_header)：

> 如果设置了与编译头文件时相同的编译器开关，GCC 只能使用预编译版本，并且最多可以使用一个。

我试过了：

```
g++ a.h
rm a.h
g++ -c a.cpp 
```

您可以查看 g++ 是否正在使用它：

```
g++ -H -c a.cpp

! a.h.gch
a.cpp 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:52:38.560

我假设 g++ 会检查标题的日期，以查看 gch 是否已过时。令我惊讶的是，事实并非如此。我可以修改和重命名标题，并且仍然可以编译 cpp。

如果某些参数与创建 gch 时不同，则编译失败。因此，我假设您的编译失败，因为[GCC 预编译的头文件](http://gcc.gnu.org/onlinedocs/gcc/Precompiled-Headers.html)中提到的至少一个条件没有得到满足。

如果您经常在不同的编译配置之间切换，则可以使用包含每个配置的 pch 的目录，如该文档中所述。

如果您只是想确保/如果使用了 pch，请使用该`-Winvalid-pch`选项，并确保在每次更改标题后更新 pch。

# sql - |数据目录|在哪里 定义？

> ID：12187068
> 
> 赞同：47
> 
> 时间：2012-08-29T21:55:16.473
> 
> 标签：sql, asp.net-mvc, database, entity-framework, vwdexpress

[这是关于我的系统上的文件在哪里](https://stackoverflow.com/questions/12169590/)的后续问题？

SO和互联网上有大量的问题和答案，但我找不到任何可以回答这个特定问题的答案。

一切都是默认的，但我找不到文件本身，

## **它不存在**。

在哪里/**如何**获得 |DataDirectory| **定义**？

文件保存在哪里，它甚至存在吗？如果不是，那是怎么回事？

**编辑**：文件**根本不**存在`AppDomain.CurrentDomain.GetData("DataDirectory").ToString();`（分散的）答案告诉我应该是。它必须在某个地方，因为当我更改模型时，调试器会中断关于模型不等于表格的唠叨。它**不在**那里。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-09-05T07:36:12.717

`|DataDirectory|`本身不是文件。引用一篇相当古老的 MSDN 文章：

> 默认情况下，**|DataDirectory|** 变量将扩展如下：
> 
> *   对于放置在用户计算机目录中的应用程序，这将是应用程序的 (.exe) 文件夹。
> *   对于在 ClickOnce 下运行的应用程序，这将是 ClickOnce 创建的特殊数据文件夹
> *   对于 Web 应用程序，这将是 App_Data 文件夹
> 
> 在后台，**|DataDirectory|的值** 只是来自应用程序域上的属性。可以通过执行以下操作更改该值并覆盖默认行为：
> 
> ```
> AppDomain.CurrentDomain.SetData("DataDirectory", newpath) 
> ```

关于您的架构不一致的进一步报价：

> 使用本地数据库文件时要知道的一件事是它们被视为任何其他内容文件。对于桌面项目，这意味着默认情况下，每次构建项目时都会将数据库文件复制到输出文件夹（又名 bin）。在 F5 之后，这是它在磁盘上的样子
> 
> ```
>  MyProject\Data.mdf
> 
>  MyProject\MyApp.vb
> 
>  MyProject\Bin\Debug\Data.mdf
> 
>  MyProject\Bin\Debug\MyApp.exe 
> ```
> 
> 在设计时，数据工具使用 MyProject\Data.mdf。在运行时，应用程序将使用输出文件夹下的数据库。由于复制，很多人的印象是应用程序没有将数据保存到数据库文件中。实际上，这仅仅是因为涉及到的数据文件有两个副本。通过数据库浏览器查看模式/数据时同样适用。这些工具使用的是项目中的副本，而不是 bin 文件夹中的那个。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-09-06T09:00:00.243

|数据目录| 算法位于 System.Data.dll 程序集的内部 System.Data.Common.DbConnectionOptions 类中。这里它由[ILSpy](http://wiki.sharpdevelop.net/ILSpy.ashx)显示（注意它现在在参考源存储库中可用的源：[https](https://github.com/Microsoft/referencesource/blob/e458f8df6ded689323d4bd1a2a725ad32668aaec/System.Data.Entity/System/Data/EntityClient/DbConnectionOptions.cs) ://github.com/Microsoft/referencesource/blob/e458f8df6ded689323d4bd1a2a725ad32668aaec/System.Data.Entity/System/Data/EntityClient/DbConnectionOptions.cs ):

```
internal static string ExpandDataDirectory(string keyword,
                                           string value,
                                           ref string datadir)
{
    string text = null;
    if (value != null && 
        value.StartsWith("|datadirectory|", StringComparison.OrdinalIgnoreCase))
    {
        string text2 = datadir;
        if (text2 == null)
        {
            // 1st step!
            object data = AppDomain.CurrentDomain.GetData("DataDirectory");
            text2 = (data as string);
            if (data != null && text2 == null)
                throw ADP.InvalidDataDirectory();

            if (ADP.IsEmpty(text2))
            {
                // 2nd step!
                text2 = AppDomain.CurrentDomain.BaseDirectory;
            }
            if (text2 == null)
            {
                text2 = "";
            }
            datadir = text2;
        }

        // 3rd step, checks and normalize
        int length = "|datadirectory|".Length;
        bool flag = 0 < text2.Length && text2[text2.Length - 1] == '\\';
        bool flag2 = length < value.Length && value[length] == '\\';
        if (!flag && !flag2)
        {
            text = text2 + '\\' + value.Substring(length);
        }
        else
        {
            if (flag && flag2)
            {
                text = text2 + value.Substring(length + 1);
            }
            else
            {
                text = text2 + value.Substring(length);
            }
        }
        if (!ADP.GetFullPath(text).StartsWith(text2, StringComparison.Ordinal))
            throw ADP.InvalidConnectionOptionValue(keyword);
    }
    return text;
} 
```

所以它首先查看当前的 AppDomain 数据（默认情况下，我相信没有定义“DataDirectory”数据），然后到达当前的 AppDomain 基目录。其余的主要是检查路径根和路径规范化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T05:45:47.400

在[MSDN 论坛上](http://social.msdn.microsoft.com/Forums/en-US/sqlce/thread/dc31ea59-5718-49b6-9f1f-7039da425296/)有一个类似但简化的问题，它说：

默认情况下 |DataDirectory| 指向您的应用程序文件夹（正如您在原始问题中发现的那样：指向 App_Data）。

由于只是数据库的替代路径，因此您可以使用**AppDomain.SetData**自己定义路径。

# linq-to-sql - 十进制和十进制值之间的区别？

> ID：12187077
> 
> 赞同：0
> 
> 时间：2012-08-29T21:56:19.227
> 
> 标签：linq-to-sql

在访问我的 Linq to SQL 对象以检查空值或出现异常时，我经常必须调用 Value 属性。有人可以解释这些似乎包装原始类型的数据类型（即十进制？，布尔？等......）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:04:13.187

`decimal?`是简写（和等价于）`nullable<decimal>`，这意味着它可以设置一个值`null`。同样的事情适用于`bool?`,`int?`等。

当您的数据库字段允许空值时，这些值由 Linq 2 SQL 选择。否则，您将无法指示这些值应为`null`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:21:48.473

它们是 type 的泛型`Nullable<T>`，并且它们确实包装了原始类型。

为什么他们发明了短形式 int？is Nullable 似乎归结于简洁和简洁的基于 C 的语言开发人员之间的标准混淆。

```
decimal? total = null; 
```

`total.HasValue`将返回 false，它不会因空引用而崩溃

但`total.Value.ToString();`会抛出异常，因为`Value`total的属性为null。

`Value`和 HasValue 属性是只读的。

```
total = 10; 
```

表示 total.Value 将返回 10.0 并且 total.HasValue 将返回 true。

这是一个非常好的泛型，特别是对于数据库类型，虽然仍然没有得到简短的形式......

# c - 为什么 gcc 找不到我的静态库？

> ID：12187078
> 
> 赞同：20
> 
> 时间：2012-08-29T21:56:21.183
> 
> 标签：c, gcc

我正在尝试将 cspec 库链接到我的 C 项目中。这是我位于测试文件夹中的 Makefile：

```
all: test

test: sample.o
    gcc -Wall -o test sample.o -L ../lib/cspec -llibcspec.a

sample.o: sample.c
    gcc -Wall -c sample.c -I../lib/cspec

clean:
    rm -rf *o test 
```

我的目录是：

```
/
/src
/lib
/lib/cspec
/tests 
```

当我运行 make 我收到以下错误：

```
gcc -Wall -o test sample.o -L ../lib/cspec -llibcspec.a
/usr/bin/ld: cannot find -llibcspec.a 
```

我已确保 libcs​​pec.a 文件位于 lib/cspec 文件夹中，但为了确保我也尝试将其放在测试文件夹中并删除 -L 命令，但无济于事。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-08-29T21:58:38.443

改变：

```
gcc -Wall -o test sample.o -L ../lib/cspec -llibcspec.a 
```

至：

```
gcc -Wall -o test sample.o -L ../lib/cspec -lcspec 
```

（按照惯例，gcc 和其他 *nix 编译器会自动添加`lib`前缀和适当的后缀。）

# ruby-on-rails - 超时从 Rails 控制器返回，同时等待和处理来自控制器中调用的 web 服务的响应

> ID：12187083
> 
> 赞同：0
> 
> 时间：2012-08-29T21:56:47.550
> 
> 标签：ruby-on-rails, soap, http-post

```
http = Net::HTTP.new(url.host, url.port)
http.use_ssl = true
http.verify_mode = OpenSSL::SSL::VERIFY_NONE
request = Net::HTTP::Post.new(url.path)
request.content_type p= 'text/xml'
request.body = websvcRQ.result(binding).gsub("\n","")
# need to set the read timeout for http POST
response= http.request(request)
# return from controller after some timeout, but keep waiting for the response (could be 3 mins) 
```

* * *

我在 begin-catch 中执行上述操作，但在超时时直接在控制器中返回 POST 响应失败。我需要的是控制器向 web 服务客户端（对于 datanoise/RoR 服务器）返回故障状态的方法，同时我们继续等待，直到外部 web 服务的读取超时时间更长，有时需要 3 分钟才能响应。该响应需要处理并存储在数据库中（简单地更新 mysql 中的一列）。

关于如何做到这一点的任何想法？我在 RHEL5 上使用 Rails 2.3.5、Ruby 1.8.7。

# ruby-on-rails - Rails HABTM 无表格

> ID：12187084
> 
> 赞同：0
> 
> 时间：2012-08-29T21:56:50.223
> 
> 标签：ruby-on-rails, has-and-belongs-to-many, hashtag

我在 HABTM 关系中有两个模型，帖子和主题标签。

我的帖子控制器如下所示：

```
 def create
    @post = current_user.posts.new(params[:post])

    respond_to do |format|
      if @post.save
        format.html { redirect_to @post, :notice => 'Post was successfully created.' }
        format.json { render :json => @post, :status => :created, :location => @post }
      else
        format.html { render :action => "new" }
        format.json { render :json => @post.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

现在，当用户创建新帖子时，我想做以下事情：

*   检查主题标签，以“#”开头的单词
*   如果主题标签已经存在，请链接帖子和主题标签
*   如果主题标签不存在，则将其添加到主题标签中，并将帖子和新添加的主题标签链接起来

我想在我做完posts.new之后我必须这样做，但我不确定如何继续。我只是编辑@post 对象吗？如果是这样，@post.save 应该采用什么格式来获取链接？

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T22:04:15.310

好的，如果您的关系设置正确，您可以在帖子文本上运行正则表达式以获取所有主题标签，然后您可以为主题标签分配类似的`@post.hashtags = tags`内容（标签是您从文本中提取的主题标签），然后保存模型.

另一种（我想说的不太合适的方法）是做同样的事情，但检查标签的存在并创建它们并通过模型保存它们，但良好的做法要求你通过与`Post`模型的关系来做到这一点。

# mysql - 在 MySQL 中查找具有特定日期时间差异的记录

> ID：12187087
> 
> 赞同：1
> 
> 时间：2012-08-29T21:57:06.400
> 
> 标签：mysql

我有一个审计跟踪表，我在其中存储每笔交易所用时间的记录

例如：日期时间 ReferenceID 状态
2012-08-29 18:54:22 abc
2012-08-29 18:54:28 abc 成功
2012-08-29 18:54:32 abcd
2012-08-29 18:54:48 abcd成功

我想找出所有花费超过 10 秒的记录。

我的输出应该类似于
ReferenceID TimeTaken
abcd 16

谢谢索尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:09:06.137

您可以在表上从具有空白状态的记录到相应的成功记录进行自联接，并计算它们之间的差异。此查询假设您只有每个 ReferenceID 的两条记录，如果可能有更多，您将不得不做一些进一步的过滤。

```
select d1.ReferenceID,
  TimeStampDiff(SECOND, d1.Dttm, d2.Dttm) TimeTaken
from data d1
left join data d2 on d2.ReferenceID = d1.ReferenceID
  and d2.Status = 'Success'
where d1.Status = ''
  and TimeStampDiff(SECOND, d1.Dttm, d2.Dttm) > 10 
```

[SQL小提琴](http://sqlfiddle.com/#!2/2c2e4/1)

# ios - Apple Mach-O 链接器 (id) 错误 pjsip

> ID：12187092
> 
> 赞同：0
> 
> 时间：2012-08-29T21:57:38.523
> 
> 标签：ios, xcode, pjsip

我正在尝试使用 PJSIP 构建这个 SIP 应用程序。

当我编译时，我得到了这个错误，不知道为什么或如何重复某些东西。我检查了：构建阶段->链接二进制与库构建阶段->编译源

重复但没有。

这是错误：

```
ignoring file /Users/kaanersan/Gogo/Gogo/libsrtp-arm-apple-darwin9.a, file was built for archive which is not the architecture being linked (i386): /Users/kaanersan/Gogo/Gogo/libsrtp-arm-apple-darwin9.a

duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/UINavigationController+CustomAnimation.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/UINavigationController+CustomAnimation.o
duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/UINavigationController+CustomAnimation.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/NSString+CustomMethods.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/NSString+CustomMethods.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIHTTPRequest.o
duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIHTTPRequest.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIInputStream.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIInputStream.o
duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIInputStream.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASINetworkQueue.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASINetworkQueue.o
duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASINetworkQueue.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/RoundedRectView.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/RoundedRectView.o
duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/RoundedRectView.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/HelpCell.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/HelpCell.o
duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/HelpCell.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/InputCell.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/InputCell.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/InfoViewController.o
duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/InfoViewController.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/SignInViewController.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/SignInViewController.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ConnectViewController.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ConnectViewController.o
duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ConnectViewController.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ring.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ring.o
duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ring.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/NSNotificationAdditions.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/NSNotificationAdditions.o
duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/NSNotificationAdditions.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/Reachability.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/dtmf.o
duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/dtmf.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/APIManager.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/APIManager.o
duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/APIManager.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/AppDelegate.o
duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/AppDelegate.o
duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/AppDelegate.o
duplicate symbol _kSIPCallState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/main.o

duplicate symbol _kSIPRegState in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/main.o

duplicate symbol _kSIPMwiInfo in:
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/ASIDataDecompressor.o
    /Users/kaanersan/Library/Developer/Xcode/DerivedData/Gogo-haciurlkiibxaffblggckauokhyf/Build/Intermediates/Gogo.build/Debug-iphonesimulator/Gogo.build/Objects-normal/i386/main.o

ld: 126 duplicate symbols for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我不得不删掉错误的某些部分，因为它不适合问题，但我相信最重要的部分是最后一部分，那是红色错误，其余的是警告。

一些帮助将不胜感激！

编辑：

ASIDataDecompressor.h：

```
#import <Foundation/Foundation.h>
#import <zlib.h>

@interface ASIDataDecompressor : NSObject {
    BOOL streamReady;
    z_stream zStream;
}

// Convenience constructor will call setupStream for you
+ (id)decompressor;

// Uncompress the passed chunk of data
- (NSData *)uncompressBytes:(Bytef *)bytes length:(NSUInteger)length error:(NSError **)err;

// Convenience method - pass it some deflated data, and you'll get inflated data back
+ (NSData *)uncompressData:(NSData*)compressedData error:(NSError **)err;

// Convenience method - pass it a file containing deflated data in sourcePath, and it will write inflated data to destinationPath
+ (BOOL)uncompressDataFromFile:(NSString *)sourcePath toFile:(NSString *)destinationPath error:(NSError **)err;

// Sets up zlib to handle the inflating. You only need to call this yourself if you aren't using the convenience constructor 'decompressor'
- (NSError *)setupStream;

// Tells zlib to clean up. You need to call this if you need to cancel inflating part way through
// If inflating finishes or fails, this method will be called automatically
- (NSError *)closeStream;

@property (assign, readonly) BOOL streamReady;
@end 
```

ASIDataDecompressor.m：

```
#import "ASIDataDecompressor.h"
#import "ASIHTTPRequest.h"

#define DATA_CHUNK_SIZE 262144 // Deal with gzipped data in 256KB chunks

@interface ASIDataDecompressor ()
+ (NSError *)inflateErrorWithCode:(int)code;
@end;

@implementation ASIDataDecompressor

+ (id)decompressor
{
    ASIDataDecompressor *decompressor = [[[self alloc] init] autorelease];
    [decompressor setupStream];
    return decompressor;
}

- (void)dealloc
{
    if (streamReady) {
        [self closeStream];
    }
    [super dealloc];
}

- (NSError *)setupStream
{
    if (streamReady) {
        return nil;
    }
    // Setup the inflate stream
    zStream.zalloc = Z_NULL;
    zStream.zfree = Z_NULL;
    zStream.opaque = Z_NULL;
    zStream.avail_in = 0;
    zStream.next_in = 0;
    int status = inflateInit2(&zStream, (15+32));
    if (status != Z_OK) {
        return [[self class] inflateErrorWithCode:status];
    }
    streamReady = YES;
    return nil;
}

- (NSError *)closeStream
{
    if (!streamReady) {
        return nil;
    }
    // Close the inflate stream
    streamReady = NO;
    int status = inflateEnd(&zStream);
    if (status != Z_OK) {
        return [[self class] inflateErrorWithCode:status];
    }
    return nil;
}

- (NSData *)uncompressBytes:(Bytef *)bytes length:(NSUInteger)length error:(NSError **)err
{
    if (length == 0) return nil;

    NSUInteger halfLength = length/2;
    NSMutableData *outputData = [NSMutableData dataWithLength:length+halfLength];

    int status;

    zStream.next_in = bytes;
    zStream.avail_in = (unsigned int)length;
    zStream.avail_out = 0;

    NSInteger bytesProcessedAlready = zStream.total_out;
    while (zStream.avail_in != 0) {

        if (zStream.total_out-bytesProcessedAlready >= [outputData length]) {
            [outputData increaseLengthBy:halfLength];
        }

        zStream.next_out = (Bytef*)[outputData mutableBytes] + zStream.total_out-bytesProcessedAlready;
        zStream.avail_out = (unsigned int)([outputData length] - (zStream.total_out-bytesProcessedAlready));

        status = inflate(&zStream, Z_NO_FLUSH);

        if (status == Z_STREAM_END) {
            break;
        } else if (status != Z_OK) {
            if (err) {
                *err = [[self class] inflateErrorWithCode:status];
            }
            return nil;
        }
    }

    // Set real length
    [outputData setLength: zStream.total_out-bytesProcessedAlready];
    return outputData;
}

+ (NSData *)uncompressData:(NSData*)compressedData error:(NSError **)err
{
    NSError *theError = nil;
    NSData *outputData = [[ASIDataDecompressor decompressor] uncompressBytes:(Bytef *)[compressedData bytes] length:[compressedData length] error:&theError];
    if (theError) {
        if (err) {
            *err = theError;
        }
        return nil;
    }
    return outputData;
}

+ (BOOL)uncompressDataFromFile:(NSString *)sourcePath toFile:(NSString *)destinationPath error:(NSError **)err
{
    NSFileManager *fileManager = [[[NSFileManager alloc] init] autorelease];

    // Create an empty file at the destination path
    if (![fileManager createFileAtPath:destinationPath contents:[NSData data] attributes:nil]) {
        if (err) {
            *err = [NSError errorWithDomain:NetworkRequestErrorDomain code:ASICompressionError userInfo:[NSDictionary dictionaryWithObjectsAndKeys:[NSString stringWithFormat:@"Decompression of %@ failed because we were to create a file at %@",sourcePath,destinationPath],NSLocalizedDescriptionKey,nil]];
        }
        return NO;
    }

    // Ensure the source file exists
    if (![fileManager fileExistsAtPath:sourcePath]) {
        if (err) {
            *err = [NSError errorWithDomain:NetworkRequestErrorDomain code:ASICompressionError userInfo:[NSDictionary dictionaryWithObjectsAndKeys:[NSString stringWithFormat:@"Decompression of %@ failed the file does not exist",sourcePath],NSLocalizedDescriptionKey,nil]];
        }
        return NO;
    }

    UInt8 inputData[DATA_CHUNK_SIZE];
    NSData *outputData;
    NSInteger readLength;
    NSError *theError = nil;

    ASIDataDecompressor *decompressor = [ASIDataDecompressor decompressor];

    NSInputStream *inputStream = [NSInputStream inputStreamWithFileAtPath:sourcePath];
    [inputStream open];
    NSOutputStream *outputStream = [NSOutputStream outputStreamToFileAtPath:destinationPath append:NO];
    [outputStream open];

    while ([decompressor streamReady]) {

        // Read some data from the file
        readLength = [inputStream read:inputData maxLength:DATA_CHUNK_SIZE]; 

        // Make sure nothing went wrong
        if ([inputStream streamStatus] == NSStreamEventErrorOccurred) {
            if (err) {
                *err = [NSError errorWithDomain:NetworkRequestErrorDomain code:ASICompressionError userInfo:[NSDictionary dictionaryWithObjectsAndKeys:[NSString stringWithFormat:@"Decompression of %@ failed because we were unable to read from the source data file",sourcePath],NSLocalizedDescriptionKey,[inputStream streamError],NSUnderlyingErrorKey,nil]];
            }
            [decompressor closeStream];
            return NO;
        }
        // Have we reached the end of the input data?
        if (!readLength) {
            break;
        }

        // Attempt to inflate the chunk of data
        outputData = [decompressor uncompressBytes:inputData length:readLength error:&theError];
        if (theError) {
            if (err) {
                *err = theError;
            }
            [decompressor closeStream];
            return NO;
        }

        // Write the inflated data out to the destination file
        [outputStream write:(Bytef*)[outputData bytes] maxLength:[outputData length]];

        // Make sure nothing went wrong
        if ([inputStream streamStatus] == NSStreamEventErrorOccurred) {
            if (err) {
                *err = [NSError errorWithDomain:NetworkRequestErrorDomain code:ASICompressionError userInfo:[NSDictionary dictionaryWithObjectsAndKeys:[NSString stringWithFormat:@"Decompression of %@ failed because we were unable to write to the destination data file at %@",sourcePath,destinationPath],NSLocalizedDescriptionKey,[outputStream streamError],NSUnderlyingErrorKey,nil]];
            }
            [decompressor closeStream];
            return NO;
        }

    }

    [inputStream close];
    [outputStream close];

    NSError *error = [decompressor closeStream];
    if (error) {
        if (err) {
            *err = error;
        }
        return NO;
    }

    return YES;
}

+ (NSError *)inflateErrorWithCode:(int)code
{
    return [NSError errorWithDomain:NetworkRequestErrorDomain code:ASICompressionError userInfo:[NSDictionary dictionaryWithObjectsAndKeys:[NSString stringWithFormat:@"Decompression of data failed with code %d",code],NSLocalizedDescriptionKey,nil]];
}

@synthesize streamReady;
@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T06:08:22.127

我也有同样的问题，从错误日志中搜索重复的符号并替换它们解决了问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T16:11:30.617

这可能是由于一些关于`kSIPCallState`, `kSIPRegState`or的时髦包含或错误定义声明`kSIPMwiInfo`，但它似乎不在 ASIDataDecompressor 中。它必然来自`ASIHTTPRequest`或它包含的东西。

阅读错误消息显示只有三个符号重复（`kSIPCallState`或`kSIPRegState`）`kSIPMwiInfo`并且它们总是涉及`ASIDataDecompressor`。从那里查看可能存在重复符号的位置是调试链接器错误的最佳方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-03T06:44:25.287

我尝试了以下步骤来解决问题：

1.  我尝试使用下面提到的命令运行 i386 架构的构建：

    > 导出 DEVPATH=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer ARCH="-arch i386" CFLAGS="-O2 -m32 -mios-simulator-version-min=5.0" LDFLAGS="- O2 -m32 -mios-simulator-version-min=5.0" ./configure-iphone make dep && make clean && make

2.  从 Xcode Preferences 中删除 Derive 数据。

3.  在 Xcode 中设置正确的头文件路径：

    ```
    $(SRCROOT)/../../../../pjlib/include
    $(SRCROOT)/../../../../pjlib-util/include
    $(SRCROOT)/../../../../pjmedia/include
    $(SRCROOT)/../../../../pjnath/include
    $(SRCROOT)/../../../../pjsip/include 
    ```

# css - 添加一个 块弄乱了页面的其余部分

> ID：12187102
> 
> 赞同：1
> 
> 时间：2012-08-29T21:58:09.760
> 
> 标签：css, layout, html

我正在编辑一个由左侧宽区域和右侧窄边栏组成的论坛布局。左侧区域底部还附有内容块。我正在尝试向侧边栏添加其他块，但这会弄乱左侧的底部内容块。

这是我要添加的代码：

```
<div class="rt-block>
<div class="module-surround">
<div style="background-color:#FFFFFF;">
      My content
</div></div></div> 
```

我只是克隆了侧边栏中已经存在的现有元素并添加了一个额外的框，它破坏了左侧。知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T22:00:45.900

你没有关闭报价`<div class="rt-block>`

# python - 如何使用nosetests从python覆盖率报告中排除模拟包

> ID：12187106
> 
> 赞同：30
> 
> 时间：2012-08-29T21:58:53.800
> 
> 标签：python, mocking, code-coverage, nose, python-mock

我目前尝试使用模拟库在 python 中编写一些基本的鼻子单元测试。

在完成一些基本示例后，我现在尝试使用`nosetests --with-coverage`，现在我有了模拟包，我试图“模拟”的包显示在覆盖率报告中。有没有可能排除这些？

这是我要测试的课程：

```
from imaplib import IMAP4

class ImapProxy:
    def __init__(self, host):
        self._client = IMAP4(host) 
```

和测试用例：从模拟导入补丁

```
from ImapProxy import ImapProxy

class TestImap:
    def test_connect(self):
        with patch('ImapProxy.IMAP4') as imapMock:
            proxy = ImapProxy("testhost")
            imapMock.assert_called_once_with("testhost") 
```

我现在得到以下输出`nosetests --with-coverage`

```
.
Name         Stmts   Miss  Cover   Missing
------------------------------------------
ImapProxy        4      0   100%   
imaplib        675    675     0%   23-1519
mock          1240    810    35%   [ a lot of lines] 
```

有什么方法可以排除 mock 包和 imaplib 包**，而**无需手动将除这些包之外的所有包都列入白名单`--cover-package=PACKAGE`

感谢 Ned Batchelder，我现在知道了 .coveragerc 文件，谢谢！

我创建了一个包含以下内容的 .coveragerc 文件：

```
[report]
omit = *mock* 
```

现在我在覆盖率报告中的模拟输出是：

```
mock                     1240   1240     0%   16-2356 
```

它不再涵盖模拟包，但仍显示在报告中。

如果有帮助，我使用 Coverage.py，版本 3.5.2。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-30T14:18:37.853

创建一个 .coveragerc 文件，排除报告中不需要的内容：http: [//nedbatchelder.com/code/coverage/config.html](http://nedbatchelder.com/code/coverage/config.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-05-07T19:00:09.583

在您的 .coveragerc 中，将您的`omit`条目从该`[report]`部分移动到该`[run]`部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-02T09:57:39.053

我有类似的情况在我的主包目录中测试一系列子包。我`nosetests`从我的模块的顶级目录中运行，`Mock`并且其他库包含在覆盖率报告中。我尝试`--cover-module my_package`在鼻子测试中使用，但后来没有包含子包。

运行以下解决了我的问题：

```
nosetests --with-coverage --cover-erase --cover-package ../my_package 
```

因此，*如果*您要测试的所有代码都在同一个目录中，*那么*您可以通过将模块路径指定为`nosetests`. 这避免了单独将每个子模块列入白名单的需要。

（Python 2.7.6，覆盖率 4.0.3，鼻子 1.3.7）

# android - 使用 XMPP 的 Android 推送通知

> ID：12187114
> 
> 赞同：8
> 
> 时间：2012-08-29T21:59:13.857
> 
> 标签：android, xmpp, push-notification

我已经仔细阅读了所有关于主题和 Android 推送通知的帖子。基本上，根据这篇文章[Android & (millions of) push notifications](https://stackoverflow.com/questions/6923497/android-millions-of-push-notifications) ，对于一小笔钱，定义了三种可能性：谷歌云消息、MQTT 和 XMPP。

关于 Google Cloud Message 我看到了一些优点和一些缺点（Android 版本、已安装 Google Play、活跃 google 计数、不保证按顺序发送通知等......）

MQTT 不知道，但我放弃了我的阅读或它们的复杂性以及与其他组件的困难集成。

我选择了 XMPP，因为它是我用来制作游戏应用程序的服务器。

当您在玩游戏并且玩家 A 移动时，它会在他与玩家 B 共享的聊天室中发送一条消息，后者在其客户端应用程序中接收、分析并执行必要的操作。因此，游戏的开发是在聊天室中进行的。

但我也喜欢WhastApp或AngryWords的风格，当一个玩家没有打开应用程序并且另一个玩家发送挑战开始玩或玩游戏时，Android中会出现一个通知。

这就是我所说的，我希望我错了，推送通知。客户不会在特定的时间间隔（轮询）询问，而是在事件发生后启动流程的服务器。我了解所描述的所有方法（XMPP）都涉及永久打开 TCP / IP。

但是是否有必要执行发布/订阅？。如果我有 10,000 个用户，他们必须成对发布/订阅？可以将聊天消息发送到某些类型的完整 JID 吗？

最后，只有当应用程序未在设备上打开时才会在状态栏中显示通知。

谢谢

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2015-02-14T17:00:35.003

如果您想在应用未运行时向设备发送消息，则需要使用 Google Cloud Messaging。您可以维护一个 xmpp 会话，但这需要应用程序在后台运行和管理服务。

我们选择扩展我们的 xmpp 离线消息模块，向离线用户发送 GCM 和 APN 推送通知，但这确实需要用户注册他们的设备，并且我们将它们映射到一个 jid。

仅当您想接收状态更新时，您才需要订阅某人向他们发送 xmpp 消息。

# python - 开源科学项目 - 使用 Python 2.6 还是 2.7？

> ID：12187115
> 
> 赞同：2
> 
> 时间：2012-08-29T21:59:17.133
> 
> 标签：python, numpy, version, scipy, optparse

我已经看到其他几个关于是使用 2.x 还是 3.x 的主题。但是，其中大多数至少有两年的历史，并且不区分 2.6 和 2.7。

我正在重新启动一个我最终可能希望在 2013 年发布的科学项目。我在标准 2.6+ 模块（如 itertools）中使用了 numpy、scipy 和 pylab。哪个版本，2.6 或 2.7，会更好？

这也将明确在制作我的脚本时是否使用 optparse。

编辑：我在一所大学工作，我拿起的工作站有 Python 2.4。在 2.6 和 2.7 之间选择决定了要升级到哪个发行版。感谢您的建议！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T22:01:30.190

如果您需要的一切都可以与 2.7 一起使用，我会使用它，那么继续使用 2.6 毫无意义。此外，`.format()`工作得更好一些（无需`{}`在格式化指令的参数中指定位置）。

FWIW，我通常使用 2.7 或 3.2，每隔一段时间我就会将一些代码移植到我的 Linux 机器上，它仍然运行 2.6.5，而 format() 的事情很烦人:)

2.7 已经足够得到很好的支持——3.x 也有望实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T22:20:38.010

如果您打算分发此代码，您的答案实际上取决于您的目标受众。最近在一些私营部门研究实验室的工作表明，Python 2.5 仍然经常使用。

另一个例子：EnSight，一个用于 3D 可视化/操作的商业包，附带 Python 2.5（如果我没记错的话，还有 NumPy 1.3 或 1.4）。

对于个人项目，我会为 2.7 拍摄。对于更多的观众，我会错误地选择 2.6。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T20:37:39.293

我个人将 Debian stable 用于我自己的项目，所以我很自然地倾向于使用该发行版作为默认 Python 安装的内容。对于 Squeeze（当前稳定），它是 2.6.6，但 Wheezy 将使用 2.7。

为什么这是相关的？好吧，作为一名程序员，有很多次我希望我能够访问更新版本的 Python 的新功能，但总的来说 Debian 非常保守，我发现它是一个很好的衡量标准，可以覆盖可能正在运行旧版本的更广泛的受众操作系统。

由于 Wheezy 可能会在今年年底（或明年早些时候）变得稳定，我也将转向 2.7。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T22:05:40.827

绝对是 Python 2.7，除非有真正令人信服的理由不这样做，这通常意味着缺乏对关键依赖项的支持。使用[argparse](http://www.doughellmann.com/PyMOTW/argparse/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-29T22:08:00.517

截至今天，Enthought 的官方[发行版](http://www.enthought.com/products/epd.php)使用 Python 2.7。默认的 Ubuntu python 2.x 发行版是 2.7 已经有一段时间了。如果你是从头开始一个项目，你应该使用 2.7。

# c# - 数组元素的多线程交换

> ID：12187119
> 
> 赞同：0
> 
> 时间：2012-08-29T21:59:43.650
> 
> 标签：c#, arrays, multithreading, concurrency, locking

我必须通过并行交换随机索引元素来对数组进行洗牌。我的问题是如何防止其他线程读取和写入当前正在被另一个线程交换的元素。我不想在一个线程交换时锁定整个数组。

我想让几个线程同时交换不同的元素对。

我试过这样的事情：

```
 object[] lockArray = new object[array.Length];
        for (int i = 0; i < array.Length; i++)
            lockArray[i] = new object();

        for (int i = 0; i < thredCount; i++)
        {
            Thread t = new Thread(th => Shuffle.Shuflle(array,lockArray));
            t.Start();
        }

        public class Shuffle
        {
            public static void Shuflle(char[] array,object [] lockArray)
            {
                    for (int count = array.Length - 1; count > 1; count--)
                    {
                        Random rand = new Random();
                        int y = rand.Next(count) + 1;

                        lock (lockArray[count])
                        {
                            lock (lockArray[y])
                            {
                                char temp = array[count];
                                array[count] = array[y];
                                array[y] = temp;
                            }
                        }

                    }
            }
        } 
```

在数组中有数字作为从 0 到 9 的字符，结果是重新排序的数字。但有时我会得到一个加倍的结果。138952469\. 9 现在在 shuffled 数组中加倍，并且 7 丢失了。

请帮我诊断问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T08:39:48.387

根本不使用锁怎么办：

```
private void OptimisticalSwap(object[] arr, int i, int j, object sentinel, SpinWait spinWait)
{
  Interlocked.Increment(ref nSwap);
  if(i == j) return;
  var vi = ExchangeWithSentinel(arr, i, sentinel, spinWait);
  var vj = ExchangeWithSentinel(arr, j, sentinel, spinWait);
  Interlocked.Exchange(ref arr[i], vj);
  Interlocked.Exchange(ref arr[j], vi);
}

private object ExchangeWithSentinel(object[] arr, int i, object sentinel, SpinWait spinWait)
{
  spinWait.Reset();
  while(true) {
    var vi = Interlocked.Exchange(ref arr[i], sentinel);
    if(vi != sentinel) return vi;
    spinWait.SpinOnce();
  }
} 
```

哨兵只是一些虚拟对象，在所有进行交换的线程之间共享，用于“保留”交换位置。

```
var sentinel = new object(); 
```

我的笔记本电脑（i7）上的运行结果：

```
Run 0 took 272ms (nSwap=799984, nConflict=300)
Run 1 took 212ms (nSwap=799984, nConflict=706)
Run 2 took 237ms (nSwap=799984, nConflict=211)
Run 3 took 206ms (nSwap=799984, nConflict=633)
Run 4 took 228ms (nSwap=799984, nConflict=350) 
```

nConflict 是交换未能保留头寸的次数。与交换的总数相比，它相当低，因此我针对没有冲突的情况优化了例程，仅在发生冲突时调用 SpinUntil。

我测试的整个代码：

```
[TestClass]
  public class ParallelShuffle
  {
    private int nSwap = 0;
    private int nConflict = 0;
    [TestMethod]
    public void Test()
    {
      const int size = 100000;
      const int thCount = 8;
      var sentinel = new object();
      var array = new object[size];

      for(int i = 0; i < array.Length; i++)
        array[i] = i;

      for(var nRun = 0; nRun < 10; ++nRun) {
        nConflict = 0;
        nSwap = 0;
        var sw = Stopwatch.StartNew();
        var tasks = new Task[thCount];
        for(int i = 0; i < thCount; ++i) {
          tasks[i] = Task.Factory.StartNew(() => {
            var rand = new Random();
            var spinWait = new SpinWait();
            for(var count = array.Length - 1; count > 1; count--) {
              var y = rand.Next(count);
              OptimisticalSwap(array, count, y, sentinel, spinWait);
            }
          }, CancellationToken.None, TaskCreationOptions.LongRunning, TaskScheduler.Default);
        }

        Task.WaitAll(tasks);

        //Console.WriteLine(String.Join(", ", array));
        Console.WriteLine("Run {3} took {0}ms (nSwap={1}, nConflict={2})", sw.ElapsedMilliseconds, nSwap, nConflict, nRun);
        // check for doubles:
        var checkArray = new bool[size];
        for(var i = 0; i < array.Length; ++i) {
          var value = (int) array[i];
          Assert.IsFalse(checkArray[value], "A double! (at {0} = {1})", i, value);
          checkArray[value] = true;
        }
      }
    }

   private void OptimisticalSwap(object[] arr, int i, int j, object sentinel, SpinWait spinWait)
    {
      Interlocked.Increment(ref nSwap);
      if(i == j) return;
      var vi = ExchangeWithSentinel(arr, i, sentinel, spinWait);
      var vj = ExchangeWithSentinel(arr, j, sentinel, spinWait);
      Interlocked.Exchange(ref arr[i], vj);
      Interlocked.Exchange(ref arr[j], vi);
    }

    private object ExchangeWithSentinel(object[] arr, int i, object sentinel, SpinWait spinWait)
    {
      spinWait.Reset();
      while(true) {
        var vi = Interlocked.Exchange(ref arr[i], sentinel);
        if(vi != sentinel) return vi;
        spinWait.SpinOnce();
      }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T22:19:16.577

只是出于好奇，为什么要允许多个线程并行交换？交换不应该花费很长时间，因此在交换期间锁定整个数组可能比锁定单个元素的任何尝试要快得多。

也就是说，如果你真的想做并行洗牌，你最好这样做：

1.  用单独的线程对数组的每一半进行洗牌（它们不能冲突）。
2.  对数组进行“完美洗牌”（即从两侧交错元素；有关更多信息，请参阅[Faro Shuffle](http://en.wikipedia.org/wiki/Faro_shuffle)。）
3.  再次洗牌阵列的每一半。

如果您想做四个线程值得洗牌，您可以将其概括为四个部分。也就是说，“交换”必须是一个非常缓慢的操作，才能从中获得任何性能优势。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T10:02:20.550

一种简单的方法是使用 Fisher-Yates 算法创建映射列表，然后在使用映射执行转置 en-mass 时锁定源数组上的所有操作。但是，这会消耗额外的资源，会花费更长的时间，并且只会略微减少阵列的不稳定时间。您也可以像这样构建一个新结果。

```
public static IEnumerable<T> Shuffle<T>(
    this IEnumerable<T> source,
    Random random = null)
{
    random = random ?? new Random();
    var list = source.ToList();

    for (int i = list.Length; i > 1; i--)
    {
        // Pick random element to swap.
        int j = random.Next(i); // 0 <= j <= i-1;

        // Swap.
        T tmp = list[j];
        list[j] = list[i - 1];
        list[i - 1] = tmp;
    }

    return list;
} 
```

做

```
var shuffler = new Task<char[]>(() => return array.Shuffle().ToArray());
array = shuffler.Result; 
```

如果你想在多个线程上洗牌，你需要一个不同的算法和一个大的资源来让它值得。

# c# - Oracle IN 语句的 C# 等效项是什么？

> ID：12187121
> 
> 赞同：0
> 
> 时间：2012-08-29T21:59:46.540
> 
> 标签：c#, oracle, syntax

我将如何检查一个变量是否是几个值之一？

在`IN`甲骨文中它会读起来像

```
where strVar in ('A','H','X','Z') 
```

不用写

```
if (strVar == "A" || strVar == "H" || strVar == "X" || strVar =="Z") 
```

* * *

*编辑以更改变量名称*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T22:02:33.030

这对你来说应该足够了：

```
if(new string[]{"A","B",".."}.Contains(strVar)) {
    .... CONTAINS ...
} 
```

也可以用

```
if(new string[]{"A","B",".."}.Any(strVar)) {
    .... CONTAINS ...
} 
```

但`Contains`也适用于`C# 2.0`，而`Any`不是。

**编辑**

正如@brendan 正确指出的那样，摆脱`var`命名变量，即`C#`关键字，让我们避免造成混淆。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T23:13:16.013

这可能是你最好的选择：

```
if ("hxza".Contains(value)) 
```

我用一些不同的方法做了一些“**测试速度**”来做你想做的事情。

***您可以在底部**看到代码。请注意，**X 是**我重复测试以求平均值的次数*

X = 1 的结果：

```
Average of ticks for test7 : 4
Average of ticks for test2 : 5
Average of ticks for test10 : 6
Average of ticks for test9 : 7
Average of ticks for test4 : 19
Average of ticks for test8 : 35
Average of ticks for test6 : 451
Average of ticks for test5 : 2711
Average of ticks for test1 : 3146
Average of ticks for test3 : 8569 
```

X = 100 的结果：

```
Average of ticks for test2 : 3
Average of ticks for test7 : 3
Average of ticks for test10 : 3
Average of ticks for test9 : 5
Average of ticks for test4 : 5
Average of ticks for test8 : 5
Average of ticks for test6 : 11
Average of ticks for test3 : 20
Average of ticks for test5 : 23
Average of ticks for test1 : 35 
```

X = 100 000 的结果：

```
Average of ticks for test2 : 3
Average of ticks for test7 : 3
Average of ticks for test5 : 3
Average of ticks for test1 : 3
Average of ticks for test6 : 3
Average of ticks for test10 : 3
Average of ticks for test9 : 5
Average of ticks for test4 : 5
Average of ticks for test8 : 5
Average of ticks for test3 : 5 
```

所以我们可以说测试 2、7 和 10 是制作你想要的东西的好方法：

```
//test2
if (value == 'a' || value == 'h' || value == 'x' || value == 'z')

//test7
if (value == 'h' || value == 'x' || value == 'z' || value == 'a')

//test10
if ("hxza".Contains(value)) 
```

见代码：

```
 char value = 'a';
            Dictionary<string, long> tests = new Dictionary<string, long>()
            {
                {"test1", 0},
                {"test2", 0},
                {"test3", 0},
                {"test4", 0},
                {"test5", 0},
                {"test6", 0},
                {"test7", 0},
                {"test8", 0},
                {"test9", 0},
                {"test10", 0}
            };
            Stopwatch watch = new Stopwatch();
            // tested with 1, 100 and 100 000
            long X = 1;

            for (int i = 0; i < X; i++)
            {
                watch.Start();
                if ("ahxz".Any(c => c == value))
                {
                }
                watch.Stop();
                tests["test1"] += watch.ElapsedTicks;
                watch.Reset();

                watch.Start();
                if (value == 'a' || value == 'h' || value == 'x' || value == 'z')
                {
                }
                watch.Stop();
                tests["test2"] += watch.ElapsedTicks;
                watch.Reset();

                watch.Start();
                if (new[] { 'a', 'h', 'x', 'z' }.Contains(value))
                {
                }
                watch.Stop();
                tests["test3"] += watch.ElapsedTicks;
                watch.Reset();

                watch.Start();
                if (new[] { 'a', 'h', 'x', 'z' }.Contains(value))
                {
                }
                watch.Stop();
                tests["test4"] += watch.ElapsedTicks;
                watch.Reset();

                watch.Start();
                if ("ahxz".Contains(value))
                {
                }
                watch.Stop();
                tests["test5"] += watch.ElapsedTicks;
                watch.Reset();

                watch.Start();
                if ("hxza".Any(c => c == value))
                {
                }
                watch.Stop();
                tests["test6"] += watch.ElapsedTicks;
                watch.Reset();

                watch.Start();
                if (value == 'h' || value == 'x' || value == 'z' || value == 'a')
                {
                }
                watch.Stop();
                tests["test7"] += watch.ElapsedTicks;
                watch.Reset();

                watch.Start();
                if (new[] { 'h', 'x', 'z', 'a' }.Contains(value))
                {
                }
                watch.Stop();
                tests["test8"] += watch.ElapsedTicks;
                watch.Reset();

                watch.Start();
                if (new[] { 'h', 'x', 'z', 'a' }.Contains(value))
                {
                }
                watch.Stop();
                tests["test9"] += watch.ElapsedTicks;
                watch.Reset();

                watch.Start();
                if ("hxza".Contains(value))
                {
                }
                watch.Stop();
                tests["test10"] += watch.ElapsedTicks;
                watch.Reset();
            }

            foreach (var test in tests.OrderBy(p => p.Value))
            {
                Console.WriteLine("Average of ticks for {0} : {1}\n", test.Key, test.Value / nbrOfTimes);
            }

            Console.ReadLine(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T22:02:44.623

没有任何上下文：

`new [] {'A','H','X','Z'}.Contains(var);`

# python - 断言未使用 Mock 调用函数/方法

> ID：12187122
> 
> 赞同：164
> 
> 时间：2012-08-29T21:59:50.317
> 
> 标签：python, unit-testing, mocking, python-mock

我正在使用 Mock 库来测试我的应用程序，但我想断言某些函数没有被调用。模拟文档谈论类似`mock.assert_called_with`and的方法`mock.assert_called_once_with`，但我没有找到任何类似`mock.assert_not_called`或相关的东西来验证模拟**没有被调用**。

我可以使用类似以下的内容，尽管它看起来既不酷也不像pythonic：

```
def test_something:
    # some actions
    with patch('something') as my_var:
        try:
            # args are not important. func should never be called in this test
            my_var.assert_called_with(some, args)
        except AssertionError:
            pass  # this error being raised means it's ok
    # other stuff 
```

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2012-08-29T22:12:30.073

这应该适用于您的情况；

```
assert not my_var.called, 'method should not have been called' 
```

样本;

```
>>> mock=Mock()
>>> mock.a()
<Mock name='mock.a()' id='4349129872'>
>>> assert not mock.b.called, 'b was called and should not have been'
>>> assert not mock.a.called, 'a was called and should not have been'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AssertionError: a was called and should not have been 
```

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2017-01-10T12:12:00.227

虽然是一个老问题，但我想补充一下当前`mock`库（unittest.mock 的反向移植）支持`assert_not_called`方法。

只需升级你的；

`pip install mock --upgrade`

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-07-02T17:48:24.983

您可以检查该`called`属性，但如果您的断言失败，接下来您会想知道*有关*意外调用的信息，因此您不妨从一开始就安排显示该信息。使用`unittest`，您可以检查以下内容`call_args_list`：

```
self.assertItemsEqual(my_var.call_args_list, []) 
```

当它失败时，它会给出如下消息：

```
AssertionError：元素计数不相等：
First 有 0，Second 有 1： call('first argument', 4)

```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2018-12-07T13:43:19.270

有了`python >= 3.5`你就可以使用`mock_object.assert_not_called()`。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2015-06-24T21:48:17.690

当您使用类继承**unittest.TestCase**进行测试时，您可以简单地使用以下方法：

*   断言真
*   断言假
*   断言相等

和类似的（在[python文档](https://docs.python.org/3.4/library/unittest.html#unittest.TestCase.debug)中你可以找到其余的）。

在您的示例中，我们可以简单地断言**mock_method.called**属性是否为***False***，这意味着该方法未被调用。

```
import unittest
from unittest import mock

import my_module

class A(unittest.TestCase):
    def setUp(self):
        self.message = "Method should not be called. Called {times} times!"

    @mock.patch("my_module.method_to_mock")
    def test(self, mock_method):
        my_module.method_to_mock()

        self.assertFalse(mock_method.called,
                         self.message.format(times=mock_method.call_count)) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-09-24T16:54:57.103

从其他答案来看，除了[@rob-kennedy](https://stackoverflow.com/a/17432369/2219670)没有人谈论`call_args_list`.

它是一个强大的工具，你可以实现完全相反的`MagicMock.assert_called_with()`

`call_args_list`是一个`call`对象列表。每个`call`对象代表对模拟可调用对象的调用。

```
>>> from unittest.mock import MagicMock
>>> m = MagicMock()
>>> m.call_args_list
[]
>>> m(42)
<MagicMock name='mock()' id='139675158423872'>
>>> m.call_args_list
[call(42)]
>>> m(42, 30)
<MagicMock name='mock()' id='139675158423872'>
>>> m.call_args_list
[call(42), call(42, 30)] 
```

使用一个`call`对象很容易，因为您可以将它与长度为 2 的元组进行比较，其中第一个组件是包含相关调用的所有位置参数的元组，而第二个组件是关键字参数的字典。

```
>>> ((42,),) in m.call_args_list
True
>>> m(42, foo='bar')
<MagicMock name='mock()' id='139675158423872'>
>>> ((42,), {'foo': 'bar'}) in m.call_args_list
True
>>> m(foo='bar')
<MagicMock name='mock()' id='139675158423872'>
>>> ((), {'foo': 'bar'}) in m.call_args_list
True 
```

因此，解决 OP 特定问题的一种方法是

```
def test_something():
    with patch('something') as my_var:
        assert ((some, args),) not in my_var.call_args_list 
```

`MagicMock.called`请注意，通过这种方式，您现在可以检查是否已使用一组特定的参数调用了它，而不仅仅是检查是否已调用模拟的可调用对象。

这很有用。假设您想测试一个函数，该函数接受一个列表并调用另一个函数，`compute()`仅当列表的每个值满足特定条件时才调用。

您现在可以模拟`compute`，并测试它是否已在某些值上调用，但在其他值上未调用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-11-08T19:04:05.960

根据 python stdlib 文档，对于[python >= 3.5，应该使用 assert_not_call](https://docs.python.org/3.5/library/unittest.mock.html#unittest.mock.Mock.assert_not_called)：

```
my_var.assert_not_called() 
```

注意：Python 3.5。9 于 2019 年 11 月 1 日发布，这个问题于 2013 年首次提出。

# iphone - 将视频+生成的音频写入 AVAssetWriterInput，音频卡顿

> ID：12187124
> 
> 赞同：4
> 
> 时间：2012-08-29T21:59:59.807
> 
> 标签：iphone, objective-c, ios, avfoundation, avassetwriter

我正在从 iOS 上的 Unity 应用程序生成视频。我正在使用 iVidCap，它使用 AVFoundation 来执行此操作。那边一切正常。本质上，视频是通过使用纹理渲染目标并将帧传递给 Obj-C 插件来渲染的。

现在我需要在视频中添加音频。音频将是在特定时间发生的声音效果，也可能是一些背景声音。使用的文件实际上是 Unity 应用程序内部的资产。我可能会将这些写入手机存储，然后生成一个 AVComposition，但我的计划是避免这种情况并将音频合成为浮点格式缓冲区（从音频剪辑中获取音频为浮点格式）。稍后我可能会做一些即时音频效果。

几个小时后，我设法录制了音频并与视频一起播放……但它结结巴巴。

目前，我只是在每一帧视频的持续时间内生成一个方波并将其写入 AVAssetWriterInput。稍后，我将生成我真正想要的音频。

如果我生成一个大量样本，我就不会出现口吃。如果我把它写成块（我更喜欢分配一个庞大的数组），那么音频块似乎会相互剪辑：

![毛刺](../Images/bf69088711b23d3ab430dae56c23a5b7.png)

我似乎无法弄清楚这是为什么。我很确定我得到了正确的音频缓冲区的时间戳，但也许我做错了整个部分。还是我需要一些标志来让视频同步到音频？我看不出这是问题所在，因为在将音频数据提取到 wav 后，我可以在波形编辑器中看到问题。

编写音频的相关代码：

```
- (id)init {
    self = [super init];

    if (self) {
        // [snip]

        rateDenominator = 44100;
        rateMultiplier = rateDenominator / frameRate;

        sample_position_ = 0;
        audio_fmt_desc_ = nil;
        int nchannels = 2;
        AudioStreamBasicDescription audioFormat;
        bzero(&audioFormat, sizeof(audioFormat));
        audioFormat.mSampleRate = 44100;
        audioFormat.mFormatID   = kAudioFormatLinearPCM;
        audioFormat.mFramesPerPacket = 1;
        audioFormat.mChannelsPerFrame = nchannels;
        int bytes_per_sample = sizeof(float);
        audioFormat.mFormatFlags = kAudioFormatFlagIsFloat | kAudioFormatFlagIsAlignedHigh;
        audioFormat.mBitsPerChannel = bytes_per_sample * 8;
        audioFormat.mBytesPerPacket = bytes_per_sample * nchannels;
        audioFormat.mBytesPerFrame = bytes_per_sample * nchannels;

        CMAudioFormatDescriptionCreate(kCFAllocatorDefault,
                                       &audioFormat,
                                       0,
                                       NULL,
                                       0,
                                       NULL,
                                       NULL,
                                       &audio_fmt_desc_
        );
    }

    return self;
}

- (BOOL)beginRecordingSession {
    NSError* error = nil;

    isAborted = false;
    abortCode = No_Abort;

    // Allocate the video writer object.
    videoWriter = [[AVAssetWriter alloc] initWithURL:[self getVideoFileURLAndRemoveExisting:
                   recordingPath] fileType:AVFileTypeMPEG4 error:&error];

    if (error) {
        NSLog(@"Start recording error: %@", error);
    }

    // Configure video compression settings.
    NSDictionary* videoCompressionProps = [NSDictionary dictionaryWithObjectsAndKeys:
                                           [NSNumber numberWithDouble:1024.0 * 1024.0], AVVideoAverageBitRateKey,
                                           [NSNumber numberWithInt:10],AVVideoMaxKeyFrameIntervalKey,
                                           nil];

    // Configure video settings.
    NSDictionary* videoSettings = [NSDictionary dictionaryWithObjectsAndKeys:
    AVVideoCodecH264, AVVideoCodecKey,
    [NSNumber numberWithInt:frameSize.width], AVVideoWidthKey,
    [NSNumber numberWithInt:frameSize.height], AVVideoHeightKey,
    videoCompressionProps, AVVideoCompressionPropertiesKey,
    nil];

    // Create the video writer that is used to append video frames to the output video
    // stream being written by videoWriter.
    videoWriterInput = [[AVAssetWriterInput assetWriterInputWithMediaType:AVMediaTypeVideo outputSettings:videoSettings] retain];
    //NSParameterAssert(videoWriterInput);
    videoWriterInput.expectsMediaDataInRealTime = YES;

    // Configure settings for the pixel buffer adaptor.
    NSDictionary* bufferAttributes = [NSDictionary dictionaryWithObjectsAndKeys:
    [NSNumber numberWithInt:kCVPixelFormatType_32ARGB], kCVPixelBufferPixelFormatTypeKey, nil];

    // Create the pixel buffer adaptor, used to convert the incoming video frames and
    // append them to videoWriterInput.
    avAdaptor = [[AVAssetWriterInputPixelBufferAdaptor assetWriterInputPixelBufferAdaptorWithAssetWriterInput:videoWriterInput sourcePixelBufferAttributes:bufferAttributes] retain];

    [videoWriter addInput:videoWriterInput];

    // <pb> Added audio input.
    sample_position_ = 0;
    AudioChannelLayout acl;
    bzero( &acl, sizeof(acl));
    acl.mChannelLayoutTag = kAudioChannelLayoutTag_Stereo;

    NSDictionary* audioOutputSettings = nil;

    audioOutputSettings = [NSDictionary dictionaryWithObjectsAndKeys:
    [ NSNumber numberWithInt: kAudioFormatMPEG4AAC ], AVFormatIDKey,
    [ NSNumber numberWithInt: 2 ], AVNumberOfChannelsKey,
    [ NSNumber numberWithFloat: 44100.0 ], AVSampleRateKey,
    [ NSNumber numberWithInt: 64000 ], AVEncoderBitRateKey,
    [ NSData dataWithBytes: &acl length: sizeof( acl ) ], AVChannelLayoutKey,
    nil];

    audioWriterInput = [[AVAssetWriterInput
    assetWriterInputWithMediaType: AVMediaTypeAudio
    outputSettings: audioOutputSettings ] retain];

    //audioWriterInput.expectsMediaDataInRealTime = YES;
    audioWriterInput.expectsMediaDataInRealTime = NO; // seems to work slightly better

    [videoWriter addInput:audioWriterInput];

    rateDenominator = 44100;
    rateMultiplier = rateDenominator / frameRate;

    // Add our video input stream source to the video writer and start it.
    [videoWriter startWriting];
    [videoWriter startSessionAtSourceTime:CMTimeMake(0, rateDenominator)];

    isRecording = true;
    return YES;
}

- (int) writeAudioBuffer:(float *)samples sampleCount:(size_t)n channelCount:(size_t)nchans {
    if (![self waitForAudioWriterReadiness]) {
        NSLog(@"WARNING: writeAudioBuffer dropped frame after wait limit reached.");
        return 0;
    }

    //NSLog(@"writeAudioBuffer");
    OSStatus status;
    CMBlockBufferRef bbuf = NULL;
    CMSampleBufferRef sbuf = NULL;

    size_t buflen = n * nchans * sizeof(float);
    // Create sample buffer for adding to the audio input.
    status = CMBlockBufferCreateWithMemoryBlock(
        kCFAllocatorDefault,
        samples,
        buflen,
        kCFAllocatorNull,
        NULL,
        0,
        buflen,
        0,
        &bbuf);

    if (status != noErr) {
        NSLog(@"CMBlockBufferCreateWithMemoryBlock error");
        return -1;
    }

    CMTime timestamp = CMTimeMake(sample_position_, 44100);
    sample_position_ += n;

    status = CMAudioSampleBufferCreateWithPacketDescriptions(kCFAllocatorDefault, bbuf, TRUE, 0, NULL, audio_fmt_desc_, 1, timestamp, NULL, &sbuf);
    if (status != noErr) {
        NSLog(@"CMSampleBufferCreate error");
        return -1;
    }
    BOOL r = [audioWriterInput appendSampleBuffer:sbuf];
    if (!r) {
        NSLog(@"appendSampleBuffer error");
    }
    CFRelease(bbuf);
    CFRelease(sbuf);

    return 0;
} 
```

关于发生了什么的任何想法？

我应该以不同的方式创建/附加样本吗？

这与AAC压缩有关吗？如果我尝试使用未压缩的音频（它会抛出），它就不起作用。

据我所知，我正在正确计算 PTS。为什么音频通道甚至需要这个？视频不应该与音频时钟同步吗？

* * *

### 更新

我尝试以 1024 个样本的固定块提供音频，因为这是 AAC 压缩器使用的 DCT 的大小。没有任何区别。

在编写任何视频之前，我曾尝试一次性推动所有块。不工作。

我尝试将 CMSampleBufferCreate 用于剩余块，并将 CMAudioSampleBufferCreateWithPacketDescriptions 仅用于第一个块。没变。

我已经尝试过这些组合。还是不对。

* * *

### 解决方案

看起来：

```
audioWriterInput.expectsMediaDataInRealTime = YES; 
```

是必不可少的，否则它会扰乱它的思想。也许这是因为视频是用这个标志设置的。此外，`CMBlockBufferCreateWithMemoryBlock`即使您将标志传递`kCMBlockBufferAlwaysCopyDataFlag`给它，也不会复制样本数据。

因此，可以使用它创建一个缓冲区，然后使用`CMBlockBufferCreateContiguous`它进行复制，以确保您获得一个带有音频数据副本的块缓冲区。否则它会引用你最初传入的内存，事情就会变得一团糟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T08:51:17.670

它看起来不错，尽管我会使用它，`CMBlockBufferCreateWithMemoryBlock`因为它会复制样本。您的代码是否可以不知道 audioWriterInput 何时完成？

不`kAudioFormatFlagIsAlignedHigh`应该`kAudioFormatFlagIsPacked`吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-25T03:29:12.103

```
CMAudioSampleBufferCreateWithPacketDescriptions(kCFAllocatorDefault, bbuf, TRUE, 0, NULL, audio_fmt_desc_, 1, timestamp, NULL, &sbuf); 
```

应该

```
CMAudioSampleBufferCreateWithPacketDescriptions(kCFAllocatorDefault, bbuf, TRUE, 0, NULL, audio_fmt_desc_, n, timestamp, NULL, &sbuf);i made it. 
```

# ios - Cocos2D pauseAllRunningActions?

> ID：12187129
> 
> 赞同：3
> 
> 时间：2012-08-29T22:00:39.707
> 
> 标签：ios, cocos2d-iphone, target, resume, onpause

我很难在我的 Cocos2D 应用程序中恢复动画。我将一个 CCSprite 作为一个子项添加到一个 CCSpriteBatchNode 中，它会在动画中消失。

因此，当我单击暂停按钮时，我会这样做：

```
[[[CCDirector sharedDirector] actionManager] pauseAllRunningActions]; 
```

现在在他们说要使用的文档中：

```
[[[CCDirector sharedDirector] actionManager] resumeTargets:]; 
```

但是，我已经尝试了所有可能的目标，包括精灵本身、batchnode、self (CCLayer) 和当前的 CCScene，但没有任何效果。

有什么方法可以恢复***所有目标吗？***

**编辑：**我在 Singleton 中声明了一个 NSSet，我这样做：

```
[Singleton sharedSingleton].pauseTargets = [[[CCDirector sharedDirector] actionManager] pauseAllRunningActions];
[[[CCDirector sharedDirector] actionManager] pauseAllRunningActions]; 
```

然后恢复我做：

```
[[[CCDirector sharedDirector] actionManager] resumeTargets:[Singleton sharedSingleton].pauseTargets]; 
```

但我遇到了崩溃：

```
2012-08-29 18:40:05.433 App[34872:707] -[__NSMallocBlock__ countByEnumeratingWithState:objects:count:]: unrecognized selector sent to instance 0x1e075a40
2012-08-29 18:40:05.434 App[34872:707] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSMallocBlock__ countByEnumeratingWithState:objects:count:]: unrecognized selector sent to instance 0x1e075a40' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T23:10:21.540

**存储暂停的目标** 

```
NSSet *pausedTargets = [[NSSet alloc] initWithSet:[[[CCDirector sharedDirector] actionManager] pauseAllRunningActions]]; 
```

**恢复暂停的目标**

```
[[[CCDirector sharedDirector] actionManager] resumeTargets:pausedTargets]; 
```

也不要忘记`pausedTargets`在取消暂停后释放。

# javascript - 如何轻松制作自己的 jQuery 手风琴？

> ID：12187133
> 
> 赞同：1
> 
> 时间：2012-08-29T22:00:49.023
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-accordion

如何轻松制作自己的 jQuery 手风琴？我想避免浪费时间尝试适应其他非标准 jQuery UI 手风琴。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T22:06:32.183

HTML：

```
<div>
    <h2 class="h2toggle">title</h2>
    <div class="cont">content here</div>
</div> 
```

jQuery：

```
$('.h2toggle').click(function() {
    var $el = $(this).next('.cont');  
    var vis = $el.is(":visible");
    $('.cont').slideUp();
    $el[ vis ? "slideUp" : "slideDown"]();
}).next('.cont').hide(); 
```

***[带有 + / - 图标的 jsBin 演示](http://jsbin.com/wirana/2/edit)***

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:00:49.023

**一：获取jQuery库**

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js">
</script> 
```

**第二：将其放在您的页面中**

```
<!-- NOTE: You MUST give a unique id to ALL the menu items -->
<div id="item1" class="menuItem">
    First Item
</div>
<div>text</div>
<div id="item2" class="menuItem">
    Second Item
</div>
<div>text</div> 
```

**第三：将脚本放在任何你想要的地方**

```
<script type="text/javascript" language="javascript">
    $(document).ready(function () {
        $('.menuItem').next().css({ display: 'none' });

        $('.menuItem').click(function (event) {
            if ($('#' + event.target.id).next().css('display') == 'none') {
                collapseAll();
                $('#' + event.target.id).next().slideDown(500);
            }
        });
    });

    function collapseAll() {
        $('.menuItem').next().slideUp(500);
    }
</script> 
```

**奖励：您可以放置​​一些避免头痛的图像**

```
<div id="item1" class="menuItem">
    <img src='@Url.Content("~/Content/icon.png")' alt="" />
    <span>First Item</span>
</div>
<div>text</div>
<div id="item2" class="menuItem">
    <img src='@Url.Content("~/Content/icon.png")' alt="" />
    <span>Second Item</span>
</div>
<div>text</div> 
```

**为了正确显示文本左侧的图像，您需要一些 css 格式**

```
.menuItem img { float: left; }
.menuItem span { float: left; }
/* Avoided further styling for simplicity */ 
```

# java - 指定从哪个超类调用方法

> ID：12187136
> 
> 赞同：0
> 
> 时间：2012-08-29T22:00:55.183
> 
> 标签：java, inheritance

我有一个具有多个级别的层次结构，它看起来像这样（<---- 表示从左到右的子类化）：

```
MyClass <----- ParentClass <------ Abstract Class 
```

我想调用一个在 AbstractClass 中声明和定义但在 ParentClass 中被覆盖的非静态方法。我想调用 AbstractClass 中的版本，而不是 ParentClass 中的版本，所以我需要类似的东西

```
super.super.method(); 
```

或者是那种精神。有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T22:11:38.500

[这个 Stack Overflow 线程](https://stackoverflow.com/questions/586363/why-is-super-super-method-not-allowed-in-java)很好地讨论了这个问题。简而言之，有几个 hacky 方法可以做到这一点，但[你真的不应该](https://stackoverflow.com/a/586397/1437878)。

# objective-c - UITableViewCell 没有接收到指定索引路径的单元格对象

> ID：12187137
> 
> 赞同：2
> 
> 时间：2012-08-29T22:01:00.487
> 
> 标签：objective-c, ios, ipad, uitableview

我通过指定 indexPath 手动创建一个 tableViewCell（这是自定义的）。出于某种原因，有时单元格会收到单元格对象，有时它不包含对象。我知道在指定的 indexPath 处存在一个单元格，但更多的原因是代码有时无法从中获取对象。有任何想法吗？

```
-(BOOL)checkRequiredValues {

    NSIndexPath *cellIndexPath;
    CheckoutCell *cell;

    cellIndexPath = [NSIndexPath indexPathForRow:1 inSection:0];
    cell = (CheckoutCell *)[self.tableView cellForRowAtIndexPath:cellIndexPath];

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T22:04:53.093

如果单元格不可见，则on`cellForRowAtIndexPath:`返回`UITableView`：`nil`

> 表示表格单元格的对象，或者`nil`该单元格不可见或 indexPath 超出范围。

如果您想一直获取一个单元格，请在您的数据源上调用相同的方法：

```
cell = (CheckoutCell *)[self.tableView.dataSource
    tableView:self.tableView
    cellForRowAtIndexPath:cellIndexPath
]; 
```

# vba - 日期格式 dd:mm:yy:hh:mm:ss 到 dd/mm/yy hh:mm:ss

> ID：12187144
> 
> 赞同：1
> 
> 时间：2012-08-29T22:02:09.127
> 
> 标签：vba, datetime, excel

我想使用 VBA 将存储在格式文件中的日期转换`dd:mm:yy:hh:mm:ss`为可用于使用 VBA 处理文件的 excel 中排序的日期。我找不到任何紧凑的东西。我已经尝试将文本转换为列，然后将分离出来的值组合回日期和时间，但这对于大数据文件来说既麻烦又慢。

有人知道可以使用的快速方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T22:09:08.630

也许这可以转换范围内的日期`A1:A10`：

```
[A1:A10]=[IF({1},TEXT(SUBSTITUTE(A1:A10,":",""),"00\/00\/00  00\:00\:00"))] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:45:30.547

下面怎么样

```
Option Explicit

Sub test()
Dim dtStr As String
Dim dtArr() As String
Dim rebuildDt As String
Dim dtDte As Date
Dim dtStr2 As String

dtStr = "29:08:12:23:37:04"
dtArr = Split(dtStr, ":")
rebuildDt = dtArr(0) & "/" & dtArr(1) & "/" & dtArr(2) _
    & " " & dtArr(3) & ":" & dtArr(4) & ":" & dtArr(5)

dtDte = CDate(rebuildDt)
dtStr2 = Format(dtDte, "dd/mm/yy hh:mm:ss")
Debug.Print dtStr2

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T22:20:34.000

您可以使用该`split`函数并解析出字符串，因为您将（假设在这里）有`dd:mm:yy:hh:mm:ss` 前三个是日期，后三个是时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T02:23:44.850

一种快速的方法您可以使用下面的代码

1.  `DateLastModified`将某个文件夹中的所有文件读入一个数组
2.  在临时工作表中转储和排序数组
3.  存储排序后的数组（在下面的变量`Y`中）

**代码**

```
Sub GetFiles()
Dim objFSO As Object
Dim objFolder As Object
Dim objFile As Object
Dim strFolder As String
Dim strFileName As String
Dim lngCnt As Long
Dim X()
Dim Y
Dim ws As Worksheet

With Application
.ScreenUpdating = False
.DisplayAlerts = False
.EnableEvents = False
End With

strFolder = "c:\temp"
strFileName = Dir(strFolder & "\*.*")

Set objFSO = CreateObject("scripting.filesystemobject")
Set objFolder = objFSO.getfolder(strFolder)

ReDim X(1 To objFolder.Files.Count, 1 To 2)

For Each objFile In objFolder.Files
lngCnt = lngCnt + 1
X(lngCnt, 1) = objFile.Name
X(lngCnt, 2) = objFile.datelastmodified
Next

Set ws = Sheets.Add
ws.[a1].Resize(UBound(X, 1), 2) = X
ws.Range("A:B").Sort ws.Range("B1"), xlDescending
Y = ws.[a1].Resize(UBound(X, 1), 2)
ws.Delete

With Application
.ScreenUpdating = True
.DisplayAlerts = True
.EnableEvents = True
End With

End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-30T05:50:44.443

仅使用 Excel 公式，不使用 VBA 的方法

`=DATE(2000+MID(A1,7,2),MID(A1,4,2),LEFT(A1,2))+TIMEVALUE(RIGHT(A1,8))`

我假设，例如，凌晨 1 点表示为 01:00:00，即不会在任何地方丢弃读数为零，6 个元素中的每个元素总是两个字符。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-08-30T07:01:40.390

这是一个简单的 VBA 函数：

```
Function ConvertDateFormat(dateInOldFormat As String)
    Dim d As Date
    Dim ss() As String
    ss = Split(dateInOldFormat, ":")
    d = DateSerial(CInt(ss(2)), CInt(ss(1)), CInt(ss(0))) _
        + TimeSerial(CInt(ss(3)), CInt(ss(4)), CInt(ss(5)))
    ConvertDateFormat = Format(d, "dd/mm/yy hh:mm:ss")
End Function 
```

用法：

```
s = ConvertDateFormat("30:08:12:08:52:11")
'returns "30/08/12 08:52:11" 
```

在这里，我什至不考虑处理[Y2K](http://en.wikipedia.org/wiki/Y2K)问题...在此函数内部，我假设年份“12”表示公元 12 年，但这对最终结果没有任何影响，无论如何都有 2 位数的年份.

# iphone - three20 和 iOS 6 不工作

> ID：12187148
> 
> 赞同：9
> 
> 时间：2012-08-29T22:02:25.733
> 
> 标签：iphone, objective-c, ios, ipad, three20

我只是在尝试我的一个项目，其中包含 Three20，它似乎没有编译/给我构建错误。似乎是因为一些 UITouch 界面发生了变化。想知道是否有快速解决方法可以做到这一点？

似乎这是问题所在：

> UITouch ivars 已从 iOS 6 SDK 标头中删除：UIViewAdditions 中的私有 API 访问会破坏 iOS 6 上的构建。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-29T22:22:34.827

[GitHub 上的这个补丁](https://github.com/cogenta/three20-1.0.5/commit/be70e1ff3965c0ff4f7598bf5213349629a27540)似乎解决了在 iOS 6 下使用 Three20 时的这个问题。

基本上补丁是更新`src/Three20UI/Headers/UIViewAdditions.h`和`src/Three20UI/Headers/UIViewAdditions.m`更改所有引用

```
#ifdef DEBUG 
```

对此：

```
#ifdef DEBUG_TOUCHES 
```

# ios - 我如何为我的 uiview 绘制阴影

> ID：12187159
> 
> 赞同：0
> 
> 时间：2012-08-29T22:04:00.643
> 
> 标签：ios, uiview, drawing, shadow

我有一个表格视图，我在其中自定义了视图单元格，我想在它们上绘制阴影。我已经使用了视图的图层，但是如果我通过这种方式绘制阴影，我的 tableview 非常非常慢。这是代码：

```
UIView  *foreground             = [[UIView alloc] initWithFrame:CGRectMake(8., 8., 305, 290.)];
foreground.tag                  = kForegroundTag;
foreground.backgroundColor      = [UIColor whiteColor];
/* Draw from here */
foreground.layer.shadowColor    = [UIColor blackColor].CGColor;
foreground.layer.shadowOpacity  = 0.7;
foreground.layer.shadowOffset   = CGSizeMake(0., 1.);
foreground.layer.shadowRadius   = 3.; 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T22:17:13.943

使用这些属性绘制阴影的性能可能很差。不过，您有几个选择：

您可以`shouldRasterize`在图层上设置以将其转换为将图层渲染为位图而不是重绘（注意：这仅在您的视图不需要经常重绘时才有用，并且如果使用最终可能会比现有性能更差在错误的情况下）

另一种选择是也使用`shadowPath`图层上的属性。根据`CALayer`文档：

> 指定显式路径通常会提高渲染性能

我肯定会使用该`shadowPath`属性，并且根据视图的性质，也可能设置`shouldRasterize`标志

# ios - 我想中途冻结翻页动画。这可能与 UIPageViewController 吗？

> ID：12187164
> 
> 赞同：0
> 
> 时间：2012-08-29T22:04:15.637
> 
> 标签：ios, uipageviewcontroller

我正在尝试获得类似于 Maps App 的翻转动画（此处类似示例：http://www.cocoacontrols.com/platforms/ios/controls/fdcurlviewcontrol），以便上一页仍然可见并卷曲（或侧面）。

如果我可以在中途冻结动画，iBooks (UIPageViewController) 的动画将是完美的。我知道你可以通过代码翻页。有没有办法通过代码冻结动画？也许模仿用户触摸？

有没有第三方库可以做到这一点？我查看了 PaperStack，但它还没有准备好用于商业用途，我也找不到任何冻结功能。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:54:09.653

我找到了一个第三方库：[https](https://github.com/xissburg/XBPageCurl#concepts) ://github.com/xissburg/XBPageCurl#concepts 它允许您自定义页面的卷曲并随时停止它。这是一堂了不起的课。谢谢西斯堡！

# python - 多个键上的 pycassa 时间序列数据

> ID：12187168
> 
> 赞同：1
> 
> 时间：2012-08-29T22:04:31.247
> 
> 标签：python, cassandra, time-series, pycassa

我正在尝试为 twitter 克隆制作一个新闻源——它显示选择用户的最新推文，而不是来自所有用户的最新推文或来自单个用户的最新推文。

我将 UUID 密钥存储在单个密钥中，例如：

```
user1, {UUID01: '', UUID02: '', UUID03: '', UUID04: ''}
user2, {UUID05: '', UUID06: '', UUID07: '', UUID08: ''}
user3, {UUID09: '', UUID10: '', UUID11: '', UUID12: ''}
user4, {UUID13: '', UUID14: '', UUID15: '', UUID16: ''} 
```

结束每个 UUID 与另一个列族中的推文相关：

```
UUID01, { ... }
UUID02, { ... }
UUID03, { ... } 
```

现在，我可以有效地为所有用户或单个用户排序推文时间。但是我怎样才能得到时间排序的事件，例如，user1、user2 和 user3？

请注意，用户 1 可能有很多新推文，但用户 2 可能有几条新推文。

我考虑过创建一个“新闻源”列族，其中包含用户关注的所有用户的推文的 UUID，但是这种纯粹的数据冗余级别似乎……矫枉过正。这是一个更明智的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T17:22:32.433

在客户端排序（合并）或复制到单独的新闻源中，基本上是您的两个选择。选择你的毒药。

FWIW，我看到一篇找不到了的研究论文，分析哪个更好。它得出的结论是，在推文量达到一定阈值的情况下，复制效果更好。（每个用户约 10000 个，IIRC。）

# matlab - 使用 GNU 编译器（包括库）生成独立的 MEX 文件

> ID：12187169
> 
> 赞同：1
> 
> 时间：2012-08-29T22:04:35.817
> 
> 标签：matlab, gcc, g++, gnu, mex

我编写并编译了一个 MEX 函数以从 MATLAB 例程中调用，它在我的计算机上运行良好。但是，当我尝试让另一台计算机运行我的例程时，它会因错误提示模块不存在而中断。我的 MEX 函数正在引用 GSL 库和其他一些库。我想知道是否可以编译我的 MEX 函数，以便它是独立的。当我说独立时，我的意思是如果我只是将 MEX 文件复制到另一台计算机，并且没有安装任何库或编译器，它仍然可以工作。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T12:42:04.710

您的外部库需要是静态库。然后有很多方法可以做到：

*   在运行 mex（gcc 选项）时添加一个“-static”链接器标志。
*   而不是使用 '-lgsl' 添加 '/path/to/libgsl.a' (Linux)
*   或者只是将您在 mex 文件中使用的库中的目标文件添加到 mex 命令

mex 文件本身仍将仅在兼容系统上运行（64 位与 32 位，匹配 libc 版本）。

在 linux 上，要检查您是否已正确编译，请键入“ldd mexfile.mexext”。您的外部库不应显示在列表中。

# ruby-on-rails - Ruby on Rails - rspec 使用 spork 失败了 1 个示例，但没有它也可以工作

> ID：12187174
> 
> 赞同：1
> 
> 时间：2012-08-29T22:05:37.053
> 
> 标签：ruby-on-rails, ruby-on-rails-3, railstutorial.org, spork

我对 RoR 非常陌生，并且正在关注 Rails 教程。我创建了一个 Pages 控制器，首先只创建了 Home 和 Contact 页面并运行了测试。这两个例子都通过了。接下来，我手动添加了第三个“关于”页面并进行了适当的更改。但是，第三个“关于”示例在运行 spork 时失败。一旦我关闭了spork，示例就通过了。这是 spork 运行的输出：

```
Failed examples:

rspec ./spec/controllers/pages_controller_spec.rb:21 # PagesController GET 'about' returns http success

Randomized with seed 15477 
```

这是我的 pages_controller_spec.rb：

```
require 'spec_helper'

describe PagesController do 
  render_views

  describe "GET 'home'" do 
    it "returns http success" do 
      get 'home'
      response.should be_success 
    end
  end

  describe "GET 'contact'" do
    it "returns http success" do
      get 'contact'
      response.should be_success
    end
  end

    describe "GET 'about'" do
    it "returns http success" do
      get 'about'
      response.should be_success
    end
  end

end 
```

将此行添加到 routes.rb ：

```
 get "pages/about" 
```

将此行添加到 pages_controller.rb：

```
 def about
  end 
```

并在 views 文件夹中添加了 about.html.erb。

此外，url- localhost:3000/pages/about 可以在浏览器中使用。我不确定为什么这个例子失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:22:28.573

如果您已经在运行 spork 并尝试对路由进行更改，则这些更改将在 spork 重新启动之前反映。这很可能是该特定测试失败的原因。

# visual-studio-2012 - 如何在 Visual Studio 2012 的解决方案资源管理器中获取文件的 Visual Studio 2010 图标

> ID：12187178
> 
> 赞同：5
> 
> 时间：2012-08-29T22:06:00.300
> 
> 标签：visual-studio-2012

几天前我访问了 Visual Studio 2012，我发现解决方案资源管理器对我来说有点过于简约。
大多数图标都是灰色和黑色的，我必须付出额外的努力才能找到我正在寻找的文件。

有没有办法恢复到 2010 年风格的文件图标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T22:33:04.800

我知道的唯一“解决方案”是卸载 Visual Studio 2012。

问题归结为图标的注册方式。安装 2012 时，所有 HKEY_CLASSES_ROOT 图标注册都会被 2012 覆盖。从概念上讲，您可以编辑这些注册以“恢复”或更改图标。例如，.csproj 文件链接到 C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC#\VCSPackages\csproj.dll 文件中的第一个图标。您可以更改它，使图标指向 C:\Program Files (x86)\Microsoft Visual Studio **10.0** \VC#\VCSPackages\csproj.dll 中的第一个图标。`.reg`可以创建用于设置该值的文件来设置该值，例如：

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\VisualStudio.Launcher.csproj.11.0\DefaultIcon]
@="c:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\VC#\\VCSPackages\\csproj.dll,0 
```

双击时，会将图标“恢复”为 2010 图标。但是，您必须为要“恢复”的每个图标执行此操作。

### 更新：

我想您可以编写一些代码来搜索注册表并替换指向 11.0 文件的图标并将它们替换为 10.0 文件。例如：

```
const string vsDirectory = "c:\\Program Files (x86)\\Microsoft Visual Studio 11.0\\";
int index = vsDirectory.IndexOf("10.0\\", StringComparison.Ordinal);

var keyNames = Registry.ClassesRoot.GetSubKeyNames();
foreach (var name in keyNames.Where(name => name.StartsWith("VisualStudio.Launcher.")))
{
    using(RegistryKey key = Registry.ClassesRoot.OpenSubKey(name+@"\DefaultIcon"))
    {
        if (key == null) continue;
        var value = key.GetValue(null).ToString();
        if (!value.StartsWith(vsDirectory)) continue;
        var sb = new StringBuilder(value);
        var newValue = sb.Replace("10.0", "11.0", index, 4).ToString();
        var elements = newValue.Split(',');
        if (elements.Length <= 0) continue;
        var filename = elements[0];
        if (File.Exists(filename))
        {
            key.SetValue(null, sb.ToString());
        }
    }
} 
```

这段特定的代码仅更改与 VisualStudio.Launcher 关联的类根键，并且仅更改包含在“c:\Program Files (x86)\Microsoft Visual Studio 11.0\”目录中的文件中*并*具有相应 10.0 文件的图标. 即它不会改变.cs 文件的图标。要将这些文件更改`"VisualStudio.Launcher."`为`"VisualStudio."`它还假定图标索引未从 10 更改为 11。

我没有一起安装 10 和 11，所以我没有测试`SetValue`这段代码。如果您使用该代码，则需要确保您的安装位于“c:\Program Files (x86)”中。

没有任何明示或暗示的保证。仅在备份后使用，风险自负。如果它符合您的要求，请告诉我。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-09T00:29:25.667

```
const string vsDirectory = "c:\\Program Files (x86)\\Microsoft Visual Studio 11.0\\";
int index = vsDirectory.IndexOf("10.0\\", StringComparison.Ordinal); 
```

index 为 -1，因为“c:\Program Files (x86)\Microsoft Visual Studio 11.0\”实际上并不包含字符串“10.0\”

..因此，当我运行它时，不会发生一件事，或者更确切地说，单步执行它以查看它是否有效。它没有。良好的测试工作，用于**更新注册表的东西**

# ruby-on-rails - 尝试启动 rails 控制台会导致堆栈过深错误

> ID：12187183
> 
> 赞同：0
> 
> 时间：2012-08-29T22:06:16.353
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

每当我尝试启动 rails 控制台时，我都会收到堆栈级别太深的错误，并且不知道如何解决该问题。

[这里的堆栈跟踪： https](https://gist.github.com/3519364) ://gist.github.com/3519364

当我运行 rails 控制台时，究竟会发生什么？该命令涉及我的应用程序的哪些部分，以及以什么方式？

编辑1：

```
config.assets.compress = false
config.assets.debug = true
config.cache_classes     = false
config.whiny_nils        = true
config.consider_all_requests_local = true 
config.action_controller.perform_caching = false
config.action_mailer.delivery_method = :smtp
config.action_mailer.smtp_settings = {
  :address => "localhost",
  :port => 1025,
  :authentication => :none
}
config.action_mailer.perform_deliveries = true
config.action_mailer.raise_delivery_errors = false
config.active_support.deprecation = :log
config.action_dispatch.best_standards_support = :builtin 
```

不幸的是，删除 excon 并没有解决任何问题。我什至将堆栈大小增加了四倍，`rails c`但问题仍然存在。更令人沮丧的是，还有其他四个开发人员在从事同一个项目，但他们都没有遇到同样的问题。这让我相信这实际上不是代码库或 gems 中的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T15:14:16.513

这是一个类似的问题，github.com/jacott/rails-latex/issues/19，捆绑更新应该可以解决您的错误。

# r - 如何检索数据框中存在的列中重复次数最多的值

> ID：12187187
> 
> 赞同：15
> 
> 时间：2012-08-29T22:06:46.757
> 
> 标签：r, dataframe, max

我正在尝试检索数据框中存在的特定列中重复次数最多的值。下面是我的示例数据和代码。A

```
data("Forbes2000", package = "HSAUR")
head(Forbes2000)

  rank                name        country             category  sales profits  assets marketvalue
1    1           Citigroup  United States              Banking  94.71   17.85 1264.03      255.30
2    2    General Electric  United States        Conglomerates 134.19   15.59  626.93      328.54
3    3 American Intl Group  United States            Insurance  76.66    6.46  647.66      194.87
4    4          ExxonMobil  United States Oil & gas operations 222.88   20.96  166.99      277.02
5    5                  BP United Kingdom Oil & gas operations 232.57   10.27  177.57      173.54
6    6     Bank of America  United States              Banking  49.01   10.81  736.45      117.55 
```

根据我的示例数据，我需要返回重复次数最多的类别，即保险。

```
subset(subset(Forbes2000,country=="Bermuda") 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-29T22:19:30.437

```
tail(names(sort(table(Forbes2000$category))), 1) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-29T22:14:48.107

如果两个或多个类别可能最常见，请使用以下内容：

```
x <- c("Insurance", "Insurance", "Capital Goods", "Food markets", "Food markets")
tt <- table(x)
names(tt[tt==max(tt)])
[1] "Food markets" "Insurance" 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-07-19T08:35:36.580

使用 data.table 包的另一种方法，对于大型数据集来说更快：

```
set.seed(1)
x=sample(seq(1,100), 5000000, replace = TRUE) 
```

**方法1（上面提出的解决方案）**

```
start.time <- Sys.time()
tt <- table(x)
names(tt[tt==max(tt)])
end.time <- Sys.time()
time.taken <- end.time - start.time
time.taken 
```

时差 4.883488 秒

**方法2（数据表）**

```
start.time <- Sys.time()
ds <- data.table( x )
setkey(ds, x)
sorted <- ds[,.N,by=list(x)]

most_repeated_value <- sorted[order(-N)]$x[1]
most_repeated_value

end.time <- Sys.time()
time.taken <- end.time - start.time
time.taken 
```

时间差 0.328033 秒

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-21T15:26:21.403

我知道我的答案来得有点晚，但我构建了以下函数，它可以在不到一秒的时间内为包含超过 50,000 行的数据框完成这项工作：

```
print_count_of_unique_values <- function(df, column_name, remove_items_with_freq_equal_or_lower_than = 0, return_df = F, 
                                         sort_desc = T, return_most_frequent_value = F)
{
  temp <- df[column_name]
  output <- as.data.frame(table(temp))
  names(output) <- c("Item","Frequency")
  output_df <- output[  output[[2]] > remove_items_with_freq_equal_or_lower_than,  ]

  if (sort_desc){
    output_df <- output_df[order(output_df[[2]], decreasing = T), ]
  }

  cat("\nThis is the (head) count of the unique values in dataframe column '", column_name,"':\n")
  print(head(output_df))

  if (return_df){
    return(output_df)
  }

  if (return_most_frequent_value){
      output_df$Item <- as.character(output_df$Item)
      output_df$Frequency <- as.numeric(output_df$Frequency)
      most_freq_item <- output_df[1, "Item"]
      cat("\nReturning most frequent item: ", most_freq_item)
      return(most_freq_item)
  }
} 
```

因此，如果您有一个名为“df”的数据框和一个名为“name”的列，并且您想知道“name”列中最多的评论值，您可以运行：

```
most_common_name <- print_count_of_unique_values(df=df, column_name = "name", return_most_frequent_value = T) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-10-09T19:50:48.207

你可以创建一个函数：

```
get_mode <- function(x){
  return(names(sort(table(x), decreasing = T, na.last = T)[1]))
} 
```

然后做

```
get_mode(Forbes3000$category) 
```

我创建一个函数的原因是我经常要做这种事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-23T21:08:24.637

您可以使用`table(Forbes2000$CategoryName, useNA="ifany")`. 这将为您提供所选类别中所有可能值的列表以及每个值在该特定数据框中使用的次数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-06T16:45:05.027

以下是（对我来说）最容易阅读和记住的：

```
names(which.max(table(Forbes2000$category))) 
```

关于效率的额外说明：这种方法避免了对表条目进行排序（发现最大值比完全排序便宜）。最有效的解决方案是避免完整的列表。您可以想象一个 Rcpp 解决方案，它循环遍历源向量并保持正在运行的制表，但在比赛结束前停止。如果有人写了该解决方案，请联系我，以便我给您 +1 并编辑此答案以参考您的答案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-08T19:34:41.353

我建议`Rfast::Table`。

```
Rfast::Table(as.character(Forbes2000$CategoryName)) 
```

你可以获得最大值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-27T20:10:28.850

使用来自@Malvika 的函数选项可以轻松地跨表应用并为每一列获取这些值

```
#create a mode function
get_mode_name <- function(x){
  return(names(sort(table(x), decreasing = T, na.last = T)[1]))
}

get_mode_value <- function(x){
  return(unname(sort(table(x), decreasing = T, na.last = T)[1]))
}

get_mode_pct<- function(x){
  return(unname(sort(table(x), decreasing = T, na.last = T)[1])/length(x))
}

#Identify character columns
type_table <- sapply(table_name, class)

#create vector numeric and character types
num_table <- (unname(type_table) == "numeric")
char_table <- (unname(type_table) == "character")

#View the modes of character columns
mode_name <- apply(table_name[,char_table], 2, function(x) get_mode_name(x))    
mode_value <- apply(table_name[,char_table], 2, function(x) get_mode_value(x))
mode_pct <- apply(table_name[,char_table], 2, function(x) get_mode_pct(x)) 
```

# spring - Hibernate/JPA 简单的创建/删除实体

> ID：12187190
> 
> 赞同：0
> 
> 时间：2012-08-29T22:07:05.027
> 
> 标签：spring, hibernate, jpa

我无法跨事务进行简单的创建/删除工作。我使用 Spring/JPA/Hibernate，没有 ehcache。

我的实体类 User 和 MyDao 使用 Spring 的 @Transactional 标记的两个方法（我知道 @Transactional 应该在服务中，这里只是简化我的情况）

```
    公共类 MyDao {
      @PersistenceContext
      私有实体管理器实体管理器；

      @Transactional
      公共无效创建（用户用户）{
        entityManager.persist(user);
        entityManager.refresh(user);
      }

      @Transactional
      公共无效删除（用户用户）{
        // 由于用户可能已分离，因此我使用 Hibernate 进行删除。
        会话 sess = entityManager.unwrap(Session.class);
        sess.delete（用户）；
      }
    }

```

我的测试：

```
    {
      用户用户 = 新用户（）；
      myDao.create(user);

      // 上面没问题。使用生成的 ID 创建的用户。
      // 我假设事务已关闭，因此用户已分离

      myDao.delete(user);

      // 上面失败并出现错误“正在删除一个分离的实例......”
    }

```

根据 Hibernate， session.delete() 可以删除分离的或托管的。但是为什么失败了？

感谢帮助

迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T04:41:59.063

Hibernate 文档说，只有当它覆盖 equals() 和 hashCode() 时，你才能对分离的实体进行操作。明天回去上班看看能不能用。我不满意的两件事：

*   如果之前分离，实体必须具有标识字段的值，为什么不直接使用它呢？
*   文件...

我们的 db 表有用于 ID 列的 long 和 string，所以我不能使用带有抽象 getId() 的基本实体类。我几乎继续实现一种方法来通过反射从我们的实体类中检索@Id 字段，然后是纯 JPA 首先查找（）然后删除。

顺便说一句，我说的是应用于我们所有实体的通用方法，而不仅仅是一个 User 类。

# java - 从 xhtml 文件创建 jsf 视图/组件树

> ID：12187192
> 
> 赞同：7
> 
> 时间：2012-08-29T22:07:13.997
> 
> 标签：java, jsf-2

我需要在应用程序启动时访问 jsf 页面组件树。我在网上找到了这个来源

```
 UIViewRoot viewRoot = context.getApplication().getViewHandler().createView(context, "/path/to/some.xhtml"); 
```

但生成的 viewRoot 没有任何孩子。有谁知道最好的方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T02:37:56.327

您忘记**构建**视图。你可以用[`ViewDeclarationLanguage#buildView()`](http://docs.oracle.com/javaee/6/api/javax/faces/view/ViewDeclarationLanguage.html#buildView%28javax.faces.context.FacesContext,%20javax.faces.component.UIViewRoot%29)这个。[这是其javadoc](http://docs.oracle.com/javaee/6/api/javax/faces/view/ViewDeclarationLanguage.html#buildView%28javax.faces.context.FacesContext,%20javax.faces.component.UIViewRoot%29)的摘录（重点是我的）：

> 采取任何特定于此 VDL 实现的操作，以使必须通过调用创建的参数`UIViewRoot`填充**子代**。[`createView(javax.faces.context.FacesContext, java.lang.String)`](http://docs.oracle.com/javaee/6/api/javax/faces/view/ViewDeclarationLanguage.html#createView%28javax.faces.context.FacesContext,%20java.lang.String%29)

 **因此，这应该这样做：

```
String viewId = "/path/to/some.xhtml";
FacesContext context = FacesContext.getCurrentInstance();
ViewHandler viewHandler = context.getApplication().getViewHandler();

UIViewRoot view = viewHandler.createView(context, viewId);
viewHandler.getViewDeclarationLanguage(context, viewId).buildView(context, view);
// view should now have children. 
```

顺便说一下，您也可以使用[`ViewDeclarationLanguage#createView()`](http://docs.oracle.com/javaee/6/api/javax/faces/view/ViewDeclarationLanguage.html#createView%28javax.faces.context.FacesContext,%20java.lang.String%29)直接创建视图而不是[`ViewHandler#createView()`](http://docs.oracle.com/javaee/6/api/javax/faces/application/ViewHandler.html#createView%28javax.faces.context.FacesContext,%20java.lang.String%29)速记。

```
String viewId = "/path/to/some.xhtml";
FacesContext context = FacesContext.getCurrentInstance();
ViewDeclarationLanguage vdl = context.getApplication().getViewHandler().getViewDeclarationLanguage(context, viewId);

UIViewRoot view = vdl.createView(context, viewId);
vdl.buildView(context, view);
// view should now have children. 
```**

# perl - 将项目添加到 perl cgi th

> ID：12187194
> 
> 赞同：1
> 
> 时间：2012-08-29T22:07:20.773
> 
> 标签：perl, cgi

有没有办法在使用 perl cgi 模块时向调用添加额外的参数（即类）？

我知道我们可以使用一堆打印/等，但我想看看我们是否可以使用 th

这是我的电话：

```
print th({-class=>'myClass'},['Col1','Col2',@MoreColumns]); 
```

它为所有列设置 myClass。我只想为一列设置和/或为每列设置差异

我希望它是这样的：

```
<thead>
 <tr>
    <th class=specialClass>Col1
    <th class=AnotherClass>Col2
    <th class=ArrayClass>Col3FromArray
    <th class=ArrayClass>Col4FromArray
    <th class=ArrayClass>Col4FromArray
 </tr>
</thead> 
```

perl cgi th([ 或者我需要使用一堆打印/循环吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T22:17:17.513

1.  您预期的 HTML 或 XHTML 无效。`<th>`只能在`<td>`合法的地方使用；它不是特别的`<tr>`。如果您期待 XHTML（与 HTML 相对），还有两个问题：必须关闭所有标记并且必须引用所有属性值。

2.  AFAIK [`CGI.pm`](http://search.cpan.org/perldoc?CGI)HTML 构造方法也可以对单个字符串进行操作。下面的工作吗？

    ```
    print th({-class=>'specialClass'}, 'Col1'),
          th({-class=>'AnotherClass'}, 'Col2'),
          th({-class=>'ArrayClass'},   \@MoreColumns); 
    ```

# knockout.js - 如何更新或刷新 ViewModel 数据和视图

> ID：12187196
> 
> 赞同：0
> 
> 时间：2012-08-29T22:07:28.927
> 
> 标签：knockout.js, knockout-2.0

我是淘汰赛的新手，并试图弄清楚如何使它适用于我当前的项目。具体来说，我有一个视图模型，它通过对服务器的 ajax 调用加载了 json 数据。一旦接收到数据，就会应用剔除绑定，并且数据会以 html 的形式显示在屏幕上。效果很好。

现在困难的部分......（至少对我来说）另外，在 html 中，我有元素（复选框、单选按钮、下拉菜单等），用户可以在其中选择值。选择完值后，该用户单击一个按钮来更新页面上的数据。因此，单击按钮会将选定的值发送回服务器，以重新查询数据库以获取新的数据集合。然后服务器需要将更新后的 json 列表发送回页面并敲除，viewmodel 和 html 显示需要用新数据更新。或者，至少这是我需要它的工作方式。一段时间以来，我一直在思考如何做到这一点。

那么，在查询完数据库，绑定knockout和viewmodel，展示数据后，如何通过重新查询数据库请求不同的数据，从服务器获取新数据，重新绑定knockout和viewmodel到新数据，并显示新数据在同一个 html 页面中（仅包含更新的数据）？？？？？？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T06:23:37.477

您可以尝试在 View Model 中使用代表您的数据的模型并更新此模型，而不是更新整个 View Model

```
 function ViewModel()
        {
            this.data = ko.observable();
            var self = this;

            self.load = function()
            {
                var dataModel = new DataModel(1, 'Value');
                self.data(dataModel); // init
            };

            self.update = function()
            {
                var dataModel = new DataModel(2, 'Value UPD');
                self.data(dataModel); // update
            };
        }

        function DataModel(id, property)
        {
            this.id = id;
            this.property = property;
        }

        ko.applyBindings(new ViewModel()); 
```

# ruby-on-rails - Rails link_to 语法以添加一些内部 html

> ID：12187197
> 
> 赞同：8
> 
> 时间：2012-08-29T22:07:34.853
> 
> 标签：ruby-on-rails, ruby, link-to

我有这段代码通过'link_to'函数生成一个“取消关注”按钮：

```
<%= link_to "Non seguire più", user_user_relationship_path(id:@relationship.id), remote: true, id: "follow_#{@user.id}", class:"btn btn-small btn-danger", method: :delete %> 
```

我想知道如何将“do..end”语法与所有这些参数一起使用。谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-29T22:35:32.713

您只需跳过第一个参数，可以将其余参数包装在括号中，然后添加 do/end。

```
<%= link_to(user_user_relationship_path(id:@relationship.id), remote: true, id: "follow_#{@user.id}", class:"btn btn-small btn-danger", method: :delete) do %>
  <!-- your button html here -->
<% end %> 
```

# c++ - 在 c++/c 中通过引用传递

> ID：12187198
> 
> 赞同：0
> 
> 时间：2012-08-29T22:07:35.840
> 
> 标签：c++, c, pass-by-reference

```
#include<stdio.h>

void sq(int &b) {
    b=b+12;
}

void main() {

int a=5;
sq(a);
printf("%d",a);

} 
```

在上面的 c 程序中，它不起作用，但在 c++ 中同样有效，即

```
#include<iostream>

void sq(int &b) {
    b=b+12;
}

 int main() {

int a=5;
sq(a);
std::cout<<a;

} 
```

变量在 c++ 中的传递方式有什么不同吗？为什么它在 c++ 中工作？上面的代码是在 c++ 中通过引用传递的吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-29T22:08:47.417

C 和 C++ 是不同的语言。C 没有引用。

如果您想要 C 中的引用语义，请使用指针：

```
void sq(int * b) {      // Pass by pointer
    *b = *b + 12;       // Dereference the pointer to get the value
}

int main() {            // Both languages require a return type of int
    int a = 5;
    sq(&a);             // Pass a pointer to a
    printf("%d\n", a);
    return 0;           // C used to require this, while C++ doesn't
                        //     if you're compiling as C99, you can leave it out
} 
```

# playframework - 从服务器到浏览器的 Playframework websocket 实时流式传输

> ID：12187202
> 
> 赞同：2
> 
> 时间：2012-08-29T22:08:01.107
> 
> 标签：playframework, websocket, playframework-2.0

我正在尝试使用 playframework 不断地将数据从网络服务器流式传输到浏览器。我根据示例[文档创建了一个示例代码](http://www.playframework.org/documentation/2.0.3/JavaWebSockets)

这是我的代码片段

```
public static WebSocket<String> sockHandler() {
    return new WebSocket<String>() {
        // called when the websocket is established
        public void onReady(WebSocket.In<String> in, final WebSocket.Out<String> out) {
            // register a callback for processing instream events
            in.onMessage(new F.Callback<String>() {
                public void invoke(String event) {
                    Logger.info(event);
                }
            });

            int i = 0;
            while(i<20){
                Logger.info("Sending message ");
                try{
                    Thread.sleep(1000);
                }catch (Exception e){
                   Logger.error("Exception " ,e);
                }

                out.write("Sending message " + i++ + "\n");

            }
        }
    };
} 
```

在浏览器上，写入 out 的消息不会在每次迭代后立即收到。在 while 循环完成后，浏览器会立即收到消息。

有没有办法在每次迭代后清除流..？还是有更好的示例/文档将实时数据从 websocket 服务器流式传输到浏览器..？

谢谢，拉贾。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T18:59:12.973

我强烈建议你看看[这个样本](https://github.com/playframework/Play20/tree/master/samples/java/websocket-chat)。

它使用 Websockets 和 Akka 演员。Actor 系统不是很难理解，[Akka 文档](http://doc.akka.io/docs/akka/2.0.3/)是一个很好的起点！

# ruby-on-rails-3 - Capistrano 多服务器配置

> ID：12187204
> 
> 赞同：1
> 
> 时间：2012-08-29T22:08:11.327
> 
> 标签：ruby-on-rails-3, deployment, capistrano

我正在尝试让 Capistrano 运行多阶段部署，其中每个阶段都有多个服务器。

以具有以下角色的部署设置的第一阶段为例。

```
Staging
    Web: "server_a", "server_b"
    DB:  "server_c" 
```

`server_a`和`server_b`两者`deploy_to "/var/www/appname"`。

`server_c`需要`deploy_to "/apps/www/appname"`。

部署后，需要运行 Bundler 和迁移，然后设置重启文件。

1.  是否可以使用 Capistrano 为不同的服务器/角色部署到不同的目录？
2.  如果没有，是否有任何部署系统可以？
3.  如果不是，我是否被困在手动部署中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:48:25.740

您可以使用[Capistrano 多阶段扩展](https://github.com/capistrano/capistrano/wiki/2.x-Multistage-Extension)并为每个环境设置不同的阶段。您将为每个环境设置角色，因此登台可能使用一组服务器进行部署，而生产使用另一组服务器。

在同一阶段特定的配方中（即在 中`config/deploy/staging`），您可以设置仅适用于该阶段的钩子。您还可以在那里为 Capistrano 变量设置不同的值。

例如，您可能有阶段“登台”：

```
role :web, "server_a", "server_b"
role :db,  "server_c"

set :deploy_to, "/var/www/stagingsite"
after "deploy:update_code" do
    run "echo hello"
end 
```

在“生产”阶段：

```
role :web, "server_d", "server_e"
role :db,  "server_f"

set :deploy_to, "/apps/www/appname"
after "deploy:update_code" do
    run "chmod g+w #{release_path}/tmp"
end 
```

# php - Paypal IPN - 关于存储变量

> ID：12187209
> 
> 赞同：0
> 
> 时间：2012-08-29T22:09:05.430
> 
> 标签：php, mysql, curl, paypal

在 paypal IPN 系统中，paypal 将使用 curl 在您的服务器上使用 URL 中的许多参数发出请求。我想知道是否应该将每个键/值存储在数据库中的单独字段中，或者是否应该将整个请求作为字符串存储在单个字段中。

哪个是首选或常用方法？

与我有关的主要事情是，如果以后贝宝决定添加更多变量或弃用旧变量，则需要更改数据库。当您有 item_name#（未知数量的变量）要存储时，将值存储在单独的字段中也会使存储订单数据变得更加困难。

有什么理由我应该在我的数据库中为每个贝宝将返回的变量创建一个单独的字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:18:59.557

我会尽可能少地存储信息。不要存储你不需要的东西。另外，我建议为您要存储的每个内容创建字段，因为这样以后，如果 paypal 确实更改了他们的 api，您需要更改的只是数据库和 paypal 之间的映射器，而不是您为每个内容解析的字符串值时间。

# html - 仅在单列中更改单元格间距

> ID：12187212
> 
> 赞同：6
> 
> 时间：2012-08-29T22:09:16.990
> 
> 标签：html, css, html-table

有没有办法只改变单列中的单元格间距？可能在html或css中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T08:34:40.360

不，HTML 属性`cellspacing`及其对应的 CSS`border-spacing`仅适用于整个表格。当不使用边框并且背景不是问题时，您可以使用填充来实现相同的效果。但是关于表格单元格边界之间的间距，表格内不可避免地是统一的。

使用假细胞可能是一种解决方法。不要在单元格上设置边框，而是在单元格内的容器上设置它们。然后单元格上的任何填充将看起来像单元格边界之间的间距。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T23:06:29.680

对此的良好约定是：

HTML：

```
<table border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td class="large-padding">Row 1, Col 1</td>
    <td>Row 1, Col 2</td>
    <td>Row 1, Col 3</td>
  </tr>
  <tr>
    <td class="large-padding">Row 2, Col 1</td>
    <td>Row 2, Col 2</td>
    <td>Row 2, Col 3</td>
  </tr>
  <tr>
    <td class="large-padding">Row 3, Col 1</td>
    <td>Row 3, Col 2</td>
    <td>Row 3, Col 3</td>
  </tr>
</table> 
```

CSS：

```
/* Used for all table cells */
td {
  padding: 10px;
}

/* Used for all table cells with the class large-padding, used on the first cell of every row (the first column */
.large-padding {
  padding: 10px 20px; /* 10px for top and bottom to keep inline with the other cells, 20px for left and right */
} 
```

我希望这很好地说明了这一点。这将使您更好地控制单元格中的填充。使用边距在单元格之间做间距。如果将 css 类应用于每一行的第一个 td，那将是表的第一列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T06:27:57.740

我发现使用以下内容：

CSS：

```
.flag {padding-left:8px;} 
```

表格内的 HTML：

```
<td class="flag"> 
```

帮助我解决了只有一列之间的间距问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T22:33:26.733

如果您有一个包含 2 列的表，并且您希望其中一列的宽度为 100% 而不是 50%，则使用 td 标记上的 colspan 属性。（我从 w3schools 复制了一张快速表，别生气）

```
<table border="1">
  <tr>
    <th>Month</th>
    <th>Savings</th>
  </tr>
  <tr>
    <td>January</td>
    <td>$100</td>
  </tr>
  <tr>
    <td>February</td>
    <td>$100</td>
  </tr>
  <tr>
    <td colspan="2">Sum: $180</td>
  </tr>
</table> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-29T22:39:00.070

如果您将一些 css 应用于您想要更宽的列，它应该很容易解决。

```
<table>
    <tr>
        <td></td>
        <td id="extra_width"></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
    </tr>
</table> 
```

在 css 中，您只需在该列上应用所需的样式：

```
#extra_width {padding-left: 10px; padding-right: 10px;} 
```

当您将宽度应用于第一行中间的表格单元格时，实际上我认为它适用于任何行，同一列中的单元格可能会继承，或者至少获得与该单元格相同的宽度。

你当然应该测试你的方式，如果你想要填充或边距，我无法从你的问题中找出那个，而且我有点不确定表格中两者的结果。

# java - 从菜单活动调用 GPS 活动

> ID：12187213
> 
> 赞同：0
> 
> 时间：2012-08-29T22:09:31.313
> 
> 标签：java, android, android-layout

我的基本应用程序有一个小问题。当我尝试从列表（“IIMODULE”）开始第二个位置时，我的手机没有反应。这是来自 LogCat 的日志：

```
System.err(3416): java.lang.ClassNotFoundException: com.example.aplikacjatestowa.IIMODULE 
```

我对这个错误几乎没有研究，但我没有发现任何具体的案例。任何人都可以看到我的错误？有任何想法吗？

菜单类：

```
public class Menu extends ListActivity {

String[] mainMenuStrings = { "MAINACTIVITY", "IIMODULE", "III_Module",
        "empty" };

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setListAdapter(new ArrayAdapter<String>(Menu.this,
            android.R.layout.simple_list_item_1, mainMenuStrings));

}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    // TODO Auto-generated method stub
    super.onListItemClick(l, v, position, id);

    String localSelector = mainMenuStrings[position];

    Class ourClass;
    try {
        ourClass = Class.forName("com.example.aplikacjatestowa."
                + localSelector);
        Intent ourIntent = new Intent(Menu.this, ourClass);
        startActivity(ourIntent);
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    }

} 
```

}

我打电话给 GPS 的新活动：

```
 public class GpsModule extends Activity {

    public static Context cont;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.gps);
        cont = getApplicationContext();

        LocationManager locManager = (LocationManager) getSystemService(LOCATION_SERVICE);
        LocationListener locListener = new MyLocationListener();
        locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0,
                locListener);
    }

} 
```

这是AndroidManifest：

```
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.aplikacjatestowa"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="4"
        android:targetSdkVersion="15" />
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".Splash"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity
            android:name=".Menu"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="com.example.aplikacjatestowa.MENU" />
                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>

        <activity
           android:name=".MainActivity"
           android:label="@string/title_activity_main" >
            <intent-filter>
               <action android:name="com.example.aplikacjatestowa.MAINACTIVITY" />
               <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>

        <activity
           android:name=".GpsModule"
           android:label="@string/title_activity_main" >
            <intent-filter>
               <action android:name="com.example.aplikacjatestowa.IIMODULE" />
               <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
</application>

<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.INTERNET" />
</manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:14:21.697

问题是没有加载 IIMODULE 类，你是否包含了 jar？

也请 c/p 包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:16:25.690

您正试图获得一个不存在的课程。

```
 ourClass = Class.forName("com.example.aplikacjatestowa."+ localSelector);
 Intent ourIntent = new Intent(Menu.this, ourClass); 
```

而不是上面的代码使用

```
Intent ourIntent = new Intent("com.example.aplikacjatestowa."+ localSelector) 
```

但是您仍然没有 III_Module 的操作标签，并且清单中的任何应用程序都为空

# html - Weebly 不会上传我的 CSS

> ID：12187215
> 
> 赞同：-1
> 
> 时间：2012-08-29T22:09:53.040
> 
> 标签：html, css, upload

当我尝试上传为 Weebly 制作的 CSS 模板时，它显示“错误：无法上传文件”。我试了又试，一无所获。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T22:55:06.820

您无需联系支持人员。Weebly 不支持多个 CSS 文件。我假设您正在尝试将其上传到编辑器的“文件”部分。您必须复制您的样式并将它们粘贴到“main-style.css”文件的末尾。

即使您要导入主题，它仍然必须具有相同且孤独的 css 文件。这是一个很好的标准，因为它迫使设计人员不要上传大量文件，因为多个服务器请求会减慢加载时间。！

[带有说明的屏幕截图](http://i.stack.imgur.com/jd61L.png)

# ruby - 在 Ruby 中解析“发件人”和“收件人”字段的电子邮件地址

> ID：12187220
> 
> 赞同：10
> 
> 时间：2012-08-29T22:10:37.270
> 
> 标签：ruby, parsing, email

在一封电子邮件中，看起来“发件人”或“收件人”字段可以包含一个或多个地址，每个地址可以像`"john@test.com"`或`"John D Jr <john@test.com>"`

因此，“来自”字段可能如下所示：

```
"a@a.com"

"a@a.com, Bob Blue <b@b.com>"

"Abe Allen <a@a.com>, b@b.com"

"Abe Allen <a@a.com>, Bob Blue <b@b.com>"

"Abe Allen <a@a.com>, Bob Blue <b@b.com>, c@c.com" 
```

等等。

我想解析这些字段，提取每个地址的电子邮件是否有效，如果存在则提取名称。由于我不熟悉电子邮件标准，因此我可能会遗漏一些地址字段的样子。有没有可以做到这一点的 Ruby 库？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-29T22:41:23.697

是的，这有一个宝石；它叫做**[邮件](https://github.com/mikel/mail)**。

```
require 'mail'

addresses = []
raw_addresses = Mail::AddressList.new("Abe Allen <a@a.com>, Bob Blue <b@b.com>, c@c.com")

raw_addresses.addresses.each do |a|  
  address = {}

  address[:address] = a.address
  address[:name]    = a.display_name if a.display_name.present?

  addresses << address      
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T22:38:51.183

假设您的数据遵循您提供的示例，这应该有效：

```
def extract_emails(string)
  string.split(', ').map do |user_string|
    if user_string.include? '<'
      user_string =~ /^([^<]*)<([^>]*)>$/
      {user: $1.strip, email: $2}
    else
      {user: nil, email: user_string}
    end
  end
end

extract_emails "a@a.com"                                          
# => [{:user=>nil, :email=>"a@a.com"}]

extract_emails "a@a.com, Bob Blue <b@b.com>"                      
# => [{:user=>nil, :email=>"a@a.com"}, {:user=>"Bob Blue", :email=>"b@b.com"}]

extract_emails "Abe Allen <a@a.com>, b@b.com"                     
# => [{:user=>"Abe Allen", :email=>"a@a.com"}, {:user=>nil, :email=>"b@b.com"}]

extract_emails "Abe Allen <a@a.com>, Bob Blue <b@b.com>"          
# => [{:user=>"Abe Allen", :email=>"a@a.com"}, {:user=>"Bob Blue", :email=>"b@b.com"}]

extract_emails "Abe Allen <a@a.com>, Bob Blue <b@b.com>, c@c.com" 
# => [{:user=>"Abe Allen", :email=>"a@a.com"}, {:user=>"Bob Blue", :email=>"b@b.com"}, {:user=>nil, :email=>"c@c.com"}] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T00:48:34.293

我不知道图书馆，但如果您想获取电子邮件列表，您可以自己执行以下操作。（故意长篇大论）

```
@a = "Abe Allen <a@a.com>, Bob Blue <b@b.com>, c@c.com"
b = @a.split(',') #=> ["Abe Allen <a@a.com>", " Bob Blue <b@b.com>", " c@c.com"] 
c = b.collect{|x| x[/<(.*?)>|^([^<>]*)$/]} #=> ["<a@a.com>", "<b@b.com>", " c@c.com"] 
d = c.gsub(/[<>]/,'') #=> ["a@a.com", "b@b.com", " c@c.com"] 
```

如果您想匹配他们的姓名和电子邮件地址，则需要其他内容。

此外，如果电子邮件地址中有“<”或“>”，这将不起作用，但这并不常见。

# python - 使用 python 正则表达式抓取 html

> ID：12187221
> 
> 赞同：1
> 
> 时间：2012-08-29T22:10:39.140
> 
> 标签：python, html, screen-scraping

我对python中的正则表达式有一些问题。我有一些 html 页面，其中包含对我有用的信息。在保存页面时，encodig 字符集是一种 iso... 它保存了所有德国典型字母编码，例如。比如 Früchte 和儿子的“Fr%C3%BCchte”。html 的结构非常糟糕，因此唯一合理的方法是使用正则表达式来抓取它。

我在 python 中有这个正则表达式：

```
re.compile('<a\s+href="javascript.*?\(\'(\w+).*?\s.(\d+.+\d+).*?(.*)\'\)\">') 
```

不幸的是，这并不是我真正想要的，因为编码的单词只会被部分提取，例如。结果将是：

```
[('showSubGroups', "160500', 'Fr%C3", '%BCchte in Alkohol'),
 ('showSubGroups', '160400', "', 'Rumtopf"),
 ('showSubGroups', '160300', "', 'Spirituosen (Bio)"),
 ('showSubGroups', '160200', "', 'Spirituosen zur Verarbeitung in der Confiserie"),
 ('showSubGroups', '160100', "', 'Spirituosen, allgemein")] 
```

也许我累了，但我看不出错误在哪里：

使用 html：

```
<td colspan="3" width="100%"><a href="javascript:sendForm('showSubGroups', '160500', 'Fr%C3%BCchte in Alkohol')">Früchte in Alkohol</a></td>
       </tr>
       <tr valign="top">
        <td colspan="3"><img src="NoName_Time_200843_93448%20-Dateien/pix.gif" height="5" width="1"></td>
       </tr>       <tr valign="top">
        <td colspan="3" width="100%"><a href="javascript:sendForm('showSubGroups', '160400', 'Rumtopf')">Rumtopf</a></td>
       </tr>
       <tr valign="top">
        <td colspan="3"><img src="NoName_Time_200843_93448%20-Dateien/pix.gif" height="5" width="1"></td>
       </tr>       <tr valign="top">
        <td colspan="3" width="100%"><a href="javascript:sendForm('showSubGroups', '160300', 'Spirituosen (Bio)')">Spirituosen (Bio)</a></td>
       </tr>
       <tr valign="top">
        <td colspan="3"><img src="NoName_Time_200843_93448%20-Dateien/pix.gif" height="5" width="1"></td>
       </tr>       <tr valign="top">
        <td colspan="3" width="100%"><a href="javascript:sendForm('showSubGroups', '160200', 'Spirituosen zur Verarbeitung in der Confiserie')">Spirituosen zur Verarbeitung in der Confiserie</a></td>
       </tr>
       <tr valign="top">
        <td colspan="3"><img src="NoName_Time_200843_93448%20-Dateien/pix.gif" height="5" width="1"></td>
       </tr>       <tr valign="top">
        <td colspan="3" width="100%"><a href="javascript:sendForm('showSubGroups', '160100', 'Spirituosen, allgemein')">Spirituosen, allgemein</a></td>
       </tr>
       <tr valign="top">
        <td colspan="3"><img src="NoName_Time_200843_93448%20-Dateien/pix.gif" height="5" width="1"></td>
       </tr>                </tbody></table>
            </td>
        </tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:26:54.307

尝试这个：

```
f = re.compile("sendForm\((?:.*), (.*), (.*)\)") 
```

以您的文本作为输入，它提供以下内容：

```
In [7]: f.findall(txt)
Out[7]:  [('160500', 'Fr%C3%BCchte in Alkohol'), ('160400', 'Rumtopf'), ('160300', 'Spirituosen (Bio)'), ('160200', 'Spirituosen zur Verarbeitung in der Confiserie'), ('160100', 'Spirituosen, allgemein')] 
```

就解码`%C3%BC`(for 'ü') 而言，它似乎只是来自拉丁语 1 块的 UTF-8，并添加了一些额外的 '%'，因为如果将 '%' 替换为 '\x'，它就会解码：

```
In [39]: '\xC3\xBC'.decode('utf-8')
Out[39]: u'\xfc' 
```

0x00FC 是 ü 的 unicode。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T22:24:58.663

[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)是一个很棒的 html 解析库。

一旦你从 html 中提取了 href，那么使用正则表达式应该很容易。

# asp.net - nvarchar 错误信息

> ID：12187224
> 
> 赞同：0
> 
> 时间：2012-08-29T22:10:42.940
> 
> 标签：asp.net, sql-server, nvarchar

我用 SQL Server 数据库在 ASP.NET 中构建了一个小项目。当我在浏览器中查看它或调试我的项目时，一切正常。但是当我在表单中输入内容并单击发送时，我收到错误消息

> *'nvarchar' 附近的语法不正确。
> 规范：System.Data.SqlClient.SqlException：“nvarchar”附近的语法不正确。*

在我的数据库中，我有带有值的表：

```
Name      nvarchar(50) 
Mail      nvarchar(200) 
Message   nvarchar(MAX) 
```

在我的源代码中，我还定义了最大长度（在 EditItemTemplate、InsertItemTemplate、ItemTemplate 中）。

```
Name   MaxLength="<%# 50 %>"  
Mail   MaxLength="<%# 200 %>"  
Message TextMode="MultiLine" 
```

保存到表中的代码：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
            ConnectionString="<%$ ConnectionStrings:ConnectionString %>" 
            SelectCommand="SELECT * FROM [Table1]"
            InsertCommand="INSERT INTO [Table1] ([Name], [Mail], [Message]) VALUES (@Name, @Mail, @Message)">
        <InsertParameters>
            <asp:Parameter Name="Name" />
            <asp:Parameter Name="Mail" />
            <asp:Parameter Name="Message" />
        </InsertParameters>
 </asp:SqlDataSource> 
```

当我看到引用时，它应该没问题......允许空值也应该有问题吗？

# mongodb - 重新索引所有 mongodb 集合的命令

> ID：12187225
> 
> 赞同：7
> 
> 时间：2012-08-29T22:10:45.133
> 
> 标签：mongodb, indexing

重新索引 MongoDB 集合的引用通常是每个集合：

```
db.mycollection.reIndex(); 
```

我想一次重新索引多个集合。一个接一个可能会有点累。

`reIndex();`在所有集合中发出的适当命令是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-18T11:38:00.133

塞尔吉奥的回答稍微小一点：

```
db.getCollectionNames().forEach(function(collection){db[collection].reIndex()}); 
```

无需先获取对集合的引用。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-08-29T22:13:45.613

那这个呢？对于数据库，它仍然是一对一的，但对您来说只是一个命令。

```
db.getCollectionNames().forEach(function(coll_name) {
  var coll = db.getCollection(coll_name);
  coll.reIndex();
}); 
```

# wpf - wpf中隐藏和关闭方法的区别

> ID：12187226
> 
> 赞同：1
> 
> 时间：2012-08-29T22:10:45.227
> 
> 标签：wpf

我目前正在开发 wpf 应用程序。我在该应用程序中有对话框。我使用自定义按钮关闭。我有两个选项可以在该按钮的事件代码中使用。

1.

```
 private void btn_close_Click(object sender, RoutedEventArgs e)
    {
        this.Close();
    } 
```

2.

```
 private void btn_close_Click(object sender, RoutedEventArgs e)
    {
        this.hide();
    } 
```

close() 和 hide() 有什么区别。哪个更好用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T22:13:51.727

[`Hide`](http://msdn.microsoft.com/en-us/library/system.windows.window.hide.aspx)只是隐藏窗口，它可以再次显示。一旦窗口关闭，它就会消失并被处理掉。

因此，如果您想重用该实例（并且不要忘记隐藏的窗口），请仅使用 hide。

# c++ - 模板类中的好友函数

> ID：12187231
> 
> 赞同：1
> 
> 时间：2012-08-29T22:11:18.710
> 
> 标签：c++, templates, friend

我试图让乘法运算符成为名为 TVector3 的模板类的朋友。我已经读过我可以在类声明中声明之前对朋友函数进行前向声明，但是我这样做的尝试是徒劳的。我知道我可以简单地定义朋友函数而不是声明它，但我希望它与前向声明技术一起使用。

特别是我试图为我的案例实施[这个解决方案。](http://www.parashift.com/c++-faq-lite/template-friends.html)我也发现[这篇](https://stackoverflow.com/questions/4660123/overloading-friend-operator-for-template-class/4661372#4661372)文章是 David Rodriguez 给出了一个解决方案（第三版），但我不知道我做错了什么。

我使用' *g++ template.cpp tempmain.cpp a* '进行编译，编译器（g++）给出以下错误：

**未定义对 'ray::TVector3 ray::operator*(float, ray::TVector3 const&)' 的引用**

对于以下代码：

模板.h：

```
#ifndef TVECTOR_H
#define TVECTOR_H

#include <cmath>

namespace ray
{
    //forward declarations
    template <class T> class TVector3;
    template <class T> TVector3<T> operator* (T, const TVector3<T> &);

    template <class T>
    class TVector3 {

        public:
            union {
                struct {
                    T x, y, z;
                };
                T xyz[3];
            };

        //function needed
        friend TVector3<T> operator*<T> (T, const TVector3<T> &);
    };

}

#endif 
```

模板.cpp：

```
#include "template.h"

using namespace ray;

//friend operator function
template<class T> TVector3<T> operator * (T f, const TVector3<T> &v)
{
    return TVector3<T>(f * v.x, f * v.y, f * v.z);
}

//instantiate template of type float
template class TVector3<float>; 
```

tempmain.cpp：

```
#include <iostream>
#include "template.h"

int main()
{
    ray::TVector3<float> v1, v2;

    v2.x = 3;
    v1 = 4.0f * v2; //this reports as undefined

    std::cout << v1.x << "\n";

    return 0;
} 
```

那是完整的源代码。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T22:23:40.660

作为一般经验法则，模板应在标题中定义。如果在 cpp 文件中定义它们，则需要手动实例化模板。您正在为类模板执行此操作，但您没有实例化`operator*`模板。

```
template TVector3<T> operator*<T> (T, const TVector3<T> &); 
```

此外，我建议不要使用模板，而是`operator*`通过在类模板中声明和定义它来使用非模板自由函数：

```
template <class T>
class TVector3 {
//function needed
    friend TVector3<T> operator*(T f, const TVector3<T> & v) {
       return TVector3<T>(f * v.x, f * v.y, f * v.z);
    }
}; 
```

这具有自由函数（它允许对第一个参数进行转换）和模板（它将按需生成自由函数——即无需手动提供所有实现）以及有限的可见性（它只会可通过 ADL 进行查找）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T23:24:58.820

你应该显式实例化 operator* 并且它像这样工作

```
using namespace ray;

//friend operator function
template<class T> TVector3<T> ray::operator * (T f, const TVector3<T> &v)
{
    return TVector3<T>(f * v.x, f * v.y, f * v.z);
}

//instantiate template of type float
template class TVector3<float>;
template TVector3<float> ray::operator*<float>( float, TVector3<float> const& ); 
```

请记住，如果您`operator*`代替`ray::operator*`编译器编写，则无法知道您的意思`ray::operator*`，并且您没有在全局命名空间中声明新的运算符！

并且不要忘记定义`TVector3( T x_, T y_, T z_ )`:)

# c# - C# 中的 getter 和 setter 有哪些更好的替代方法？

> ID：12187232
> 
> 赞同：2
> 
> 时间：2012-08-29T22:11:20.280
> 
> 标签：c#, oop, accessor

我已经阅读了一些关于在面向对象编程中使用 getter/setter 的内容，并且许多诸如此类的资源[表明](http://www.javaworld.com/javaworld/jw-09-2003/jw-0905-toolbox.html?page=1)它们应该很少使用。那篇文章的一句话说：

> 不要要求你提供工作所需的信息；请有信息的对象为您完成工作。

虽然这在原则上听起来不错，但我不确定如何最好地实施。说我有一门描述汽车的课程。在该类中，假设该类中存储的这辆车的品牌是“Toyota”。现在我有一个 GUI 想要显示这是一个“丰田”。没有吸气剂如何做到这一点？

即使我抽象出“Toyota”存储为字符串并返回一个已经写有“Toyota”的TextBox，这听起来充其量就像原始属性的包装形式的getter。我只是认为像 TextBoxes 这样的东西应该只在 GUI 的类中，而不是像我这里的汽车类这样的辅助类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T22:40:56.137

那篇文章描述了您应该使用方法而不是属性获取器/设置器。基本上，它建议一个方法应该执行一个操作来修改状态，而不是允许设置器修改状态。例如，我可以有一个具有月和日属性的类。然后我可以有这样的代码：

```
obj.Day = 28;
obj.Month = Months.February;
obj.Day = 30;
obj.Month = Months.March; 
```

一旦我将一天设置为 30 而月份是二月，我就会处于无效状态。

文章建议一个类不应该允许这种类型的事情，而是提供特定的方法来执行特定的操作，例如：

```
obj.ChangeDate(Months.March, 30); 
```

如果日期时间类比由于 DateTime 而令人困惑，您可以使用 lat/long 坐标的类似示例：

```
obj.Latitude = 45.4112;
obj.Longitude = -75.6981;
//... 
obj.Latitude = 39.73;
obj.Longitude = -86.27; 
```

当纬度设置为 39.73 时，该位置将变为靠近纽瓦克而不是渥太华（第一个纬度/经度）或印第安纳波利斯（第二个纬度/经度）的地方。保留纬度/经度设置会使界面开放，无法验证其不变量，有些人可能会说不是真正面向对象的。因此，您可能有一个方法：

```
obj.MoveTo(39.73, -86.27); 
```

OO 意味着封装状态和行为。虽然有些人可能认为属性“封装”了状态，但它们通常不会。它们将实现与接口分离，以便用作属性后备存储的内容可以更改——但是，它很少这样做；因此，这些属性只是提供与提供公共字段不同的实现细节。

有像命令查询分离这样的概念建立在这个想法上，建议接口应该更新状态或查询状态，但不能同时更新。同时具有 getter 和 setter 的属性提供了更新状态和查询状态的接口。上面的例子`MoveTo`和`ChangeDate`将是“命令”。从概念上讲，您将提供其他查询状态的方法；如果需要的话。

属性的另一个问题是人们习惯性地添加 getter 和 setter 仅仅是因为它是一个属性。获取或设置属性的能力可能不是必需的，只需通过死记硬背的创建和接口添加 getter 和 setter，这可能永远不需要测试和维护。

微妙的？当然; 但他说的是面向对象的设计，而不是“正常工作”的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T22:51:33.653

你忽略了“做工作”。如果您要完成的工作是汽车的品牌，那么返回品牌的吸气剂就可以完成工作。

这篇文章的意思是，如果你想在课堂数据上完成工作，就把工作放在课堂上。不要从类中提取数据，对其进行处理，然后将其返回给类：

```
var c = new Car();
c.Odometer += 10;  // bad
c.DriveMiles(10);  // good 
```

我也质疑那篇文章对 C# 的适用性；它声称：

> Getter 和 setter 方法（也称为访问器）是危险的，原因与公共字段危险的原因相同：它们提供对实现细节的外部访问。

在 C# 中这是错误的，C# 访问器可以接受任意类，它们不“提供对实现细节的外部访问”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T22:50:49.033

Getter 和 setter 并不邪恶，它们只是不应该为每个属性自动生成。就您的示例而言，Car 类可能应该有一个返回 String 的 getBrand 方法，但可能不需要此属性的 setter。Car 中返回带有品牌名称的 TextBox 的方法很可能比返回 String 的简单 getter 更糟糕，因为它不是很通用。

我现在可以看到 Peter Ritchie 的回答：changeDate 的好例子。Date 类应该提供这样的方法，而不是提供日期和月份的 getter 并要求用户代码自己计算日历中的第二天。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T23:05:30.357

基本上他的意思是，假设你有一个有十个属性的类，你想把它转储到一行 csv 中。在类中添加一个 Tocsv 方法以返回一个包含一堆 csv 的字符串。不要编写通过属性访问它并构建 csv 字符串的其他类，因为它们必然会变得非常紧密耦合。

不知道他为什么选择访问器，问题与获取和设置的离散方法完全相同，或者更糟糕的是成员变量。

显然是有限制的，你必须有很好的理由更换

```
SomeLabel.Text = SomeInstance.StringValue; 
```

和

```
SomeInstance.MakeStringValueALabel(SomeLabel); 
```

# android - 从 TextView 复制文本

> ID：12187234
> 
> 赞同：-1
> 
> 时间：2012-08-29T22:11:34.903
> 
> 标签：android

这是我的代码：

```
Button copy;
Button previous;
Button more;
TextView screen;
String quote=screen.getText().toString(); 
```

我需要按钮复制来复制变量的值`quote`。我怎样才能做到这一点？我试过了：

```
ClipboardManager clipboard = (ClipboardManager) getSystemService(CLIPBOARD_SERVICE); 
clipboard.setText(screen.getText()); 
```

但它仅适用于 Android 4.0+ 设备。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T22:33:06.023

我认为你的导入是错误的。

采用

```
import android.text.ClipboardManager ; 
```

并不是

```
import android.content.ClipboardManager; // this was instroduced only in API level 11 
```

# ios - iOS：如何在矩形内创建按钮？

> ID：12187235
> 
> 赞同：1
> 
> 时间：2012-08-29T22:11:36.263
> 
> 标签：ios, xcode, uibutton

我对此没有太多经验，但我想将两个 UIButtons 放置在一个矩形内，如下图所示。那么最好的方法是什么？我不想从 Photoshop 中绘制矩形图像并导入 xCode。谢谢

![在此处输入图像描述](../Images/2f9408d94727aeebe4c6f5b9f65dc342.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:17:31.727

您可以将 UIView 拖到 Storyboard 上，然后将按钮拖到上面，因此它们是子视图。故事板看起来像：

```
view controller
  -view (main)
      -view (your new subview)
           -button1
           -button2 
```

然后您可以在子视图上设置背景等以直观地定义矩形

# algorithm - AO(n*log(n)) 算法找到具有最低斜率的段（在 n*n 段中）

> ID：12187238
> 
> 赞同：12
> 
> 时间：2012-08-29T22:11:43.843
> 
> 标签：algorithm, computational-geometry, lines, points

给定定义*n* *²**条线的不同点的P={p [1] ,...,p [n] }* ，编写一个算法，找到在最坏情况下具有时间复杂度的最低斜率（最小绝对值）的线。`O(n*log(n))`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-30T05:39:44.070

定理：

*   给定一组点 P。
*   在 P 中选择两个点 A 和 C，使得线 AC 具有最小的绝对斜率（如问题中所定义）。
*   对于多对点具有相同斜率的退化情况，令 AC 为具有该斜率的最短线段。
*   则 P 中不存在其他点，其 Y 坐标位于 A 和 C 之间。

证明（反证法）：

*   假设至少有一个点 B，其 Y 坐标在 A 和 C 之间。
*   那么存在三种可能的情况：
    *   B 与 A 和 C 共线。那么线 AB 或 BC 与 AC 具有相同的斜率，但*它们*都比 AC 短。矛盾。
    *   B 落在 AC“上方”的半平面中。然后线 AB 的斜率比 AC 的斜率更小。矛盾。
    *   B 落在“低于”AC 的半平面中。那么BC线的斜率比AC线的斜率小。矛盾。
*   所有情况都会导致矛盾，因此 A 和 C 之间不存在点。
*   QED。

有了这个定理，您可以清楚地使用@Zshazz 的算法来找到正确的配对——因为它们将是最近的邻居——在`O(n*log n)`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-30T01:17:34.790

根据点的 y 位置对点进行排序（使用任意数量的众所周知的算法 n log n 次）。按从 0 到 n - 1 的顺序浏览列表，将每个点对的斜率与迄今为止发现的最低斜率进行比较。（那是 n 次）。

总的来说，这将是 O(n log n)。

在伪代码中：

```
Let P be the list of points (this list starts at 1)
n = P.length
S = quicksort("a.y < b.y", P) // or some other O(n log n) algorithm
bestSlope = float.inf
let p1 and p2 be points
for i = 1 to n-1:
    currSlope = abs((P[i].y - P[i+1].y) / (P[i].x - P[i+1].x))
    if currSlope < bestSlope:
        bestSlope = currSlope
        p1 = P[i]
        p2 = P[i+1] 
```

# database - 从数据库更新模型会删除对 SSDL 文件 EF4 的所有自定义

> ID：12187241
> 
> 赞同：0
> 
> 时间：2012-08-29T22:12:10.643
> 
> 标签：database, entity-framework, visual-studio-2010, ado.net, entity-framework-4

我对 .edmx 中的 SSDL 进行了一些更改，主要用于自定义存储过程，但是每当我从数据库执行更新模型时，它会删除我的所有自定义，是否有解决方法或设置可以使它不会删除我的更改？示例：我将其放入 ssdl

```
 <Function Name="InsertUpdateStoredProc" IsComposable="false">
    <CommandText>
      EXEC TWO.dbo.InsertUpdateProduct
      @Address = @Code,
      @CustomerNumber = @CustomerNumber,
      @EquipmentID = @EquipmentID,
      @ManufacturerID = @ManufacturerID,
      @EquipmentType = @EquipmentType,

    </CommandText> 
```

然后，一旦我进行更新，它就会被覆盖

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T22:14:17.287

您有义务删除您的模型，然后重新创建

# intersystems-cache - CacheSQL datediff 格式 hhmm

> ID：12187245
> 
> 赞同：0
> 
> 时间：2012-08-29T22:12:44.320
> 
> 标签：intersystems-cache

我需要从两列计算以分钟或小时为单位的方差。使用 datediff(hh,start,stop) 有时会很大，而使用 datediff(mi,start,stop) 有时会很小。我怎样才能让它显示为 hh:mm？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:18:01.173

```
SELECT {fn TRUNCATE(DATEDIFF('mi',start,stop)/60,0)}
       || ':' 
       ||{fn MOD (DATEDIFF('mi',start,start) ,60)} 
From MySchema.MyTable 
```

# javascript - 取消选择滚动启动时的所有列表视图项

> ID：12187246
> 
> 赞同：2
> 
> 时间：2012-08-29T22:12:45.053
> 
> 标签：javascript, jquery, css, jquery-mobile, jquery-events

当您滚动页面并通过按下列表视图按钮开始滚动时，该按钮将保持突出显示以进行滚动，并在滚动完成后保持突出显示。滚动开始时如何取消选择它？

如果我这样做，它会起作用：

```
$(document).bind('scrollstart', function(ev) {
    $('*').blur();
}); 
```

但这效率低下，并导致页面在滚动开始之前滞后，我尝试仅模糊`a`、和`li`，但这并没有取消突出显示它。`ui-btn``ui-li`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:54:35.683

当您单击 jQuery Mobile 伪页面上的列表项时，您基本上是将`ui-btn-down-*`类添加到列表项（`*`表示主题字母之一）。

一旦用户开始滚动，您就可以删除此类，这是一个示例：

```
$(document).on("scrollstart", function () {
    setTimeout(function () {
        $.mobile.activePage.find('.ui-li').removeClass('ui-btn-down-a ui-btn-down-b ui-btn-down-c ui-btn-down-d ui-btn-down-e');
    }, 100);
});​ 
```

**更新**

在我的 Droid XI 上进行的测试发现，超时有助于更一致地消除突出显示的状态。您可以出于自己的目的弄乱超时的持续时间。

这是一个演示：http: [//jsfiddle.net/WrqbG/7/](http://jsfiddle.net/WrqbG/7/)

**更新**

我还意识到`.ui-btn-hover-*`该类已应用，因此要返回未突出显示的列表，您还必须删除这些类。

```
.removeClass('ui-btn-down-a ui-btn-down-b ui-btn-down-c ui-btn-down-d ui-btn-down-e') 
```

只需更改为：

```
.removeClass('ui-btn-down-a ui-btn-down-b ui-btn-down-c ui-btn-down-d ui-btn-down-e ui-btn-hover-a  ui-btn-hover-b  ui-btn-hover-c  ui-btn-hover-d  ui-btn-hover-e') 
```

# android - 创建一个 bat 文件以从命令行运行 Android 自动化测试（Robotium）

> ID：12187248
> 
> 赞同：0
> 
> 时间：2012-08-29T22:12:51.993
> 
> 标签：android, batch-file, automated-tests, ui-automation, robotium

我正在从事 Android 自动化测试。我们希望有一个与 MSBuild.exe 集成的 bat 文件。我已经创建了所有测试用例，但是，我无法让 bat 文件正常工作。

目前我的 bat 文件看起来像：

```
call android delete avd -n %avdName%
call android create avd -n %avdName% -t 8 --skin WVGA800 --force
call emulator -avd  %avdName%

call adb install %batPath%\..\%projectName%\bin\release.apk
call adb install %batPath%\..\%testProjectName%\bin\release.apk
call adb shell am instrument -w com.example.mobiletest/android.test.InstrumentationTestRunner 
```

这个想法是，在每次运行时，bat 文件都会创建一个新的 AVD，启动它，上传 APK 并运行测试。但是，它不会等待 AVD 完成启动并尝试上传 APK，这让我遇到了这个错误：

> 错误：无法访问包管理器。系统在运行吗？

如何告诉 bat 文件等到 AVD 完全启动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T22:28:07.630

adb 等待设备安装 %batPath%..\%projectName%\bin\release.apk

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T13:48:57.320

最后我使用这样的黑客

```
echo waiting...
ping 127.0.0.1 -n 100 -w 1000 > NUL
echo ...done 
```

在继续之前等待 100 秒。AVD 应该在 100 秒内启动并运行。

# javascript - 加载新内容后不久，动态页面 div 会闪烁

> ID：12187249
> 
> 赞同：6
> 
> 时间：2012-08-29T22:12:56.957
> 
> 标签：javascript, jquery, ajax, hashchange

我正在使用 dynamicpage 脚本通过 Ajax 将内容加载到我的页面中。除了 1 个问题外，一切正常。我有一个页面，其中 div 彼此堆叠，例如：header-banner-nav-content-likebox-twitterwidget-footer。

如果我更改页面，例如，如果我从家里去联系，那么我会在不到一秒的时间内看到我的likebox 和 twitterwidget 进入页面顶部（导航下方）。之后一切都正确加载，但是在显示联系页面之前看到框在顶部闪烁很烦人。如何修改 dynamicpage.js 脚本，使其不会很快将内容下方的 div 从顶部移到顶部？

这是我的脚本：

```
$(function() {

    var newHash      = "",
        $mainContent = $("#main-content"),
        $pageWrap    = $("#page=wrap"),
        baseHeight   = 0,
        $el;

    $pageWrap.height($pageWrap.height());
    baseHeight = $pageWrap.height() - $mainContent.height();

    $("nav").delegate("a", "click", function() {
        window.location.hash = $(this).attr("href");
        return false;
    });

    $(window).bind('hashchange', function(){ 
String.prototype.toTitleCase = function(n) {
   var s = this;
   if (1 !== n) s = s.toLowerCase();
   return s.replace(/\b[a-z]/g,function(f){return f.toUpperCase()});
   }

   newHash = window.location.hash.substring(1);         

   function changeTitle(title) { 

   document.title = window.location.hash.replace("#","").replace(/[_]/g,"").replace(".html","").replace("and","+").toTitleCase(); }
   changeTitle("");

        newHash = window.location.hash.substring(1);

        if (newHash) {
            $mainContent
                .find("#guts")
                .fadeOut(200, function() {
                    $mainContent.hide().load(newHash + " #guts", function() {
                        $mainContent.fadeIn(200, function() {
                            $pageWrap.animate({
                                height: baseHeight + $mainContent.height() + "px"
                            });
                        });
                        $("nav a").removeClass("current");
                        $("nav a[href="+newHash+"]").addClass("current");
                    });
                });
        };

    });
    $(window).trigger('hashchange');

}); 
```

这是我的CSS：

```
.header-wrapper {
    display:block;
    clear: none;
    max-width:960px;
    margin:auto;

}
header {
    position:relative;
    display: block;
    width: 100%;
    max-width:960px;
    min-height: 110px;
    background: url('../img/header-d.gif') no-repeat;
    margin:0 auto;
    margin-top:15px;
}
.like-button {
    position:absolute;
    right: 36%;
    bottom:0;
}
.like-button-twitter {
    position:absolute;
    right:22%;
    bottom:2px;
}
#email {
     width: 180px; 
     background: #FFFFFF; 
     border: 1px solid #BBBBBB;
     position:absolute;
     right:2px;
     bottom:5px;
     margin: 0 5px 0 0;
     padding: 4px;  
     font-size: 10px;
     }  
.go {
    position: absolute;
    right:8px;
    bottom:10px;
    border:none;
    color: #455868;
    font-weight:bold;

}
#icons {
    background: url('../img/icons.png') no-repeat;
    position: absolute;
    list-style:none;
    width:210px;
    height:35px;
    right:0;

    }
#icons li {
    position:absolute;
    list-style:none;
    }
li icon1 {
    position:absolute;
    right:100px;
    width:35px;

}
nav {
    min-height: 40px;
    width: 100%; 
    background: #374652 ; /*#455868 */
    font-size: 10pt;
    font-family: sans-serif;
    position: relative;
    border-bottom: 2px solid #283744;
}
nav ul {
    padding: 0;
    margin: 0 auto;
    width: 400px;
    height: 20px;
}
nav li {
    display: inline;
    float: left;
}
nav a {
    display: inline-block;
    width: 100px;
    text-align: center;
    text-decoration: none;
    line-height: 40px;
    color:#ffffff;
}
nav li a {
    border-right: 1px solid #576979;
    box-sizing:border-box;
    -moz-box-sizing:border-box;
    -webkit-box-sizing:border-box;
    color:#ffffff;
}
nav a:visited
{   color:#ffffff; }

nav li:last-child a {
    border-right: 0;
}
nav a:hover, nav a:active {
    background-color: #2d3a44;
}
nav a#pull {
    display: none;
}
#banner {
    clear: both;
    float: left;
    margin-left: 0;
    width: 100%;
    display:block;  
    }
.wrapper {
    width: 100%;
    max-width: 960px;
    margin: auto;
}
article {
    clear: both;
    float: left;
    margin-left: 0;
    margin-top:30px;
    width: 62%;
    display: block;
}

#youtube-music .container {height:450px;}

section {
    padding-left:8px;
}
aside {
    clear: none;
    float: right;
    margin-left: 3%;
    padding-right:1%;
    margin-top:30px;
    width: 33.2033%;
    display: block;
}
#like-box {
    clear: none;
    float: left;
    width: 100%;
    display: block;
    overflow:hidden;
    border:1px solid #2c2c2c;
}
.fb-like-box  {
    width: 100% !important;
    border:none; 
    overflow:hidden;

}
#youtube-box {
    clear: none;
    float: left;
    width: 100%;
    margin-top:10px;
    display: block;
    border:1px solid #2c2c2c;
}
#twitter-box {
    clear: none;
    float: left;
    width: 100%;
    margin-top:10px;
    display: block;
    overflow:hidden;
    border:1px solid #2c2c2c;
}
#twitter {
width:100%;
}

#twitter_m {
width: 100%;
padding: 0 13px;
}
#twitter_container {
min-height:45px;
height:auto !important;

}
#twitter_update_list {
width: 100%;
padding: 0;
overflow: hidden;
font-size: 14px;
color: #374652;
line-height: 16px;
margin-left:-13px;
}
#twitter_update_list li {
width: 90%;
padding:10px;
border-bottom: solid 1px #ccc;
}
#twitter_update_list li a {
color:#631891;
text-decoration: none;
}
#twitter_update_list li a:hover {
color: #31353d;
}

footer { margin-top: 15px; display:block; background:#374652; color: #d5d5d5;}
#footer-container {position: relative; height: 250px; max-width:960px; margin:auto;}
footer ul { padding-top: 5px; padding-left:15px;}
footer ul li{float:left; position: relative; padding-right:15px;  display:inline;}
footer ul li a{color: #d5d5d5;}
footer ul li a:hover{color: #777;}
#footer-container p { position: absolute; bottom:30px;}

#youtube-music {    
    clear: none;
    float: left;
    width: 100%;
    display: block;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T19:09:25.147

在所有样式完全加载之前，您的代码可能正在运行。您可以尝试使用`.load()`而不是`$(function(){...})`调用您的代码

```
 $(window).load(function () {
      // run code
    }); 
```

这将导致您的代码在窗口完全加载后运行。

# javascript - 为了防止拉伸，我将如何动态调整文本大小以适应元素？

> ID：12187253
> 
> 赞同：0
> 
> 时间：2012-08-29T22:13:38.140
> 
> 标签：javascript

无论如何，我希望文本所在元素的高度为 100px。如果有一个段落可以拉伸元素，我将如何缩小它直到它完全适合盒子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T22:15:41.780

碰巧我写了一个jQuery插件来解决这个问题。链接在这里。

[http://code.google.com/p/jquery-fit-text-to-height/](http://code.google.com/p/jquery-fit-text-to-height/)

# php - 如何在 Yii CHtml::link 中包含 javascript 操作？

> ID：12187254
> 
> 赞同：1
> 
> 时间：2012-08-29T22:13:39.123
> 
> 标签：php, html, yii

**情况：**
我当前的链接是通过以下yii方法生成的：

```
<?php 
echo CHtml::link(CHtml::encode($data->name), array('view', 'id'=>$data->idCategory)); 
?> 
```

**我想做的：**
需要建立一个像这样结构的链接

```
<a onmouseover="doSomething();" href="http://mysite.com/index.php?r=categories/view">Books</a> 
```

请指教。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T22:16:54.917

最后一个可选变量是属性：

```
CHtml::link(
    CHtml::encode($data->name), 
    array('view', 'id'=>$data->idCategory),
    array('class'=>'linkClass','onmouseover'=>'doSomething();')
); 
```

您可以将所有内容放入您需要的最后一个数组中，`onclick` `data-foo` `id`等等。

# c# - 将 EF 查询限制为具有 TPT 继承的基本类型

> ID：12187259
> 
> 赞同：3
> 
> 时间：2012-08-29T22:14:03.307
> 
> 标签：c#, .net, linq, entity-framework, linq-to-entities

考虑以下具有 TPT 继承的实体框架模型。

数据库表：

```
Person (PersonID, Name)
Student (PersonID, Grade) 
```

英孚实体：

```
Person (PersonID, Name)
Student (Grade) : inherits from Person 
```

现在，当您尝试从数据库中选择人员条目时，它将返回 Student 类型。

```
var person = db.Persons.First();
// person here is of type Student and has Grade peoperty populated
// SQL query generated by EF selects data from both tables with a JOIN 
```

**如何强制此查询仅从 Person db 表中选择数据，而不是从 Person 和 Student db 表中选择数据？**

例如，可以使用以下查询来完成：

```
db.Persons.Select(x => new Person { PersonID = x.PersonID, Name = x.Name }).First() 
```

但它看起来很蹩脚，在现有查询上生成一个额外的 SELECT 语句，这样返回的 Person 实体对象将不会被 EF 上下文跟踪。所以，我想知道为什么要`db.Persons.First()`返回一个`Student`对象？这不是违反直觉吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T20:33:01.513

如果您使用列表`Person`并将单曲存储`Student`到列表中，您调用时会收到什么`First`？您将收到一个`Student`实例，因为这就是面向对象代码的工作`Student`方式，但是如果不创建新实例并从原始实例复制数据，`Person`您将永远不会只获得实例。`Person``Student`

EF 以同样的方式工作——实体是原子的。它跨越多少个表并不重要。如果您查询继承层次结构，您将始终获得正确类型的整个实例，因为这就是面向对象代码的工作方式。

如果在 Linq-to-entities 中使用第二个示例，则根本不应该工作，因为您正在查询中创建实体的实例 - 这是不允许的。不能对映射实体进行投影，因为它可能会破坏数据的一致性。

要走的路是对非实体类型使用投影 - 自定义非映射类或匿名类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:17:44.893

尝试使用此代码

```
db.Persons.TypeOf<Person>().First(); 
```

# java - JOptionPane ：在一定时间后显示按钮“确定”

> ID：12187266
> 
> 赞同：0
> 
> 时间：2012-08-29T22:14:33.183
> 
> 标签：java, swing, button, wait, joptionpane

**我想仅在一定时间后才显示此 JOptionPane 的按钮“确定”**（例如**5 秒**）。（我的目标实际上是让在另一个线程后面完成一些线程工作）

```
JOptionPane jop2 = new JOptionPane();   
jop2.showMessageDialog(null, "Please wait 5s", "WAIT", JOptionPane.INFORMATION_MESSAGE); 
```

我完全不知道该怎么做，你能给我一些可以解决这个问题的代码吗？非常感谢您！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T22:16:58.027

没有特定的方法可以使用`JOptionPane`. 您必须创建一个自定义对话框并在固定时间后显示“确定”按钮。您可以使用一次[Swing 计时器](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)。

```
ActionListener taskPerformer = new ActionListener() {
    public void actionPerformed(ActionEvent evt) {
        button.setVisible(true);
    }
};

Timer timer = new Timer(0, taskPerformer);
timer.setInitialDelay(5000);
timer.setRepeats(false);
timer.start(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T04:27:03.023

听起来您正在寻找的是`SwingWorker`和的组合`ProgressMonitor`。将`SwingWorker`执行您长时间运行的任务（5 秒的任务），并使用`ProgressMonitor`. 可以在这里找到一个向您展示如何让两者一起工作的示例： [getting the cancel event of Java ProgressMonitor](https://stackoverflow.com/questions/12108127/getting-the-cancel-event-of-java-progressmonitor/12111465#12111465)

当然，如果您确信要在工作完成后采用显示继续按钮的方法，那么这里有一个示例可以让您朝着正确的方向开始。您将使用 a`SwingWorker`来提醒您的 Dialog 长时间运行的后台任务已完成。

```
import java.awt.*;
import java.awt.Dialog.ModalityType;
import java.awt.event.*;
import javax.swing.*;

public class TempProject extends Box{

    public TempProject(){
        super(BoxLayout.Y_AXIS);

        //Contains the content of the Alert Dialog
        Box info = Box.createVerticalBox();
        info.add(new Label("Please wait 5 seconds"));
        final JButton continueButton = new JButton("Continue");
        info.add(continueButton);

        //The alert to wait 5 seconds
        final JDialog d = new JDialog();
        d.setTitle("WAIT");
        d.setModalityType(ModalityType.APPLICATION_MODAL);
        d.setContentPane(info);
        d.pack();

        //The action of the "Continue Button"
        continueButton.addActionListener(new ActionListener(){
            @Override
            public void actionPerformed(ActionEvent arg0) {
                d.dispose();
            }
        });
        continueButton.setVisible(false);

        //Thread That Does Work
        final SwingWorker sw = new SwingWorker<Integer, Integer>()
        {
            protected Integer doInBackground() throws Exception  {
                //Do long running thread work here
                int i = 0;
                while (i++ < 100) {
                    System.out.println(i);
                    Thread.sleep(100);
                }
                return null;
            }

            @Override
            protected void done(){
                // What to do when the long runnng thread is done
                continueButton.setVisible(true);
            }

        };

        //Button to start the long running task
        JButton button = new JButton("Click Me");
        button.addActionListener(new ActionListener(){

            @Override
            public void actionPerformed(ActionEvent arg0) {
                sw.execute();
                d.setVisible(true);
            }});
        add(button);
    }

    public static void main(String args[])
    {
        EventQueue.invokeLater(new Runnable()
        {
            public void run()
            {
                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );
                frame.setContentPane(new TempProject());
                frame.setPreferredSize(new Dimension(500, 400));
                frame.pack();
                frame.setVisible(true);
            }
        });
    }   

} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-29T22:20:23.213

你可以使用这样的东西来停止代码 5 秒

```
 try {
            Thread.sleep(5000); // do nothing for 5000 miliseconds (5 seconds)
        } catch (InterruptedException e) {
            e.printStackTrace();
       } 
```

# c++ - 使用 c++ 和 x86 和 x64 架构访问处理器中断

> ID：12187269
> 
> 赞同：4
> 
> 时间：2012-08-29T22:14:44.213
> 
> 标签：c++, c, windows, linux

我想知道是否可以从 c++ 代码访问处理器中断（我想我需要使用汇编代码）。

事情就是这样。我习惯于使用嵌入式系统（PIC、ARM7 和 Atmel 处理器），我可以毫无问题地编程我的中断（我使用 C）。所有寄存器都已映射，总而言之，这非常容易，具体取决于应用程序。现在我正在使用 x86 和 x64 架构，我希望（强调**WANT**）能够在这些处理器中做同样的事情。

例如：我想让 C++ 中的一个线程运行一个代码，该代码不断验证当前按下的键，而无需按下回车键（cin、getchar 等）。我想编写一个定时器中断，以便能够在特定时间执行操作。我知道我想做的很多事情都可以通过操作系统来完成，但我真的很想拥有自己做的自由。

目前我正在使用 Linux (Ubuntu)，但我肯定会很快使用 Windows，如果这是回答该问题所需的信息

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T22:24:27.070

对于用户级进程，中断被信号取代。您可以通过调用来安排将信号发送到您的进程`setitimer`。但最有可能的是，做你想做的事情的最好方法是以下两件事之一：

1.  使用事件循环。基本上，把你的程序写成一个巨大的循环，定期检查它是否需要做任何事情。在循环中，检查时间，检查按键，等等。做一些你需要做的工作，然后再次循环。

2.  使用线程。您可以有一个线程来观察时间并触发计时器作业。当数据到达时，您可以让一个线程在 a 上阻塞`read`以充当中断。

很可能你已经在脑海中钻了出来，你在中断处理程序本身中做的工作很少，通常只是将信息传递给在正常上下文中运行的其他代码。好吧，操作系统已经为您完成了这部分工作。您只需编写等待中断处理程序（或任何需要的）检测并开始处理事件的代码。

> 我想在 C++ 中有一个线程运行一个代码，该代码不断验证当前按下的键而不按回车键（cin、getchar 等）。

就这样做吧。这需要一个线程，并且需要将终端的输入模式更改为不需要输入键的模式。这与中断无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T22:29:09.600

对于 Windows：

Windows 在隐藏低级硬件访问（如访问 cpu 中断）方面做得很好，原因是 win 内核正在使用它们在进程和其他内部内容之间切换。因此，您需要编写一个驱动程序来直接访问硬件或让您的代码在执行环 < 3（用户模式）中执行。

但是出于教育目的，您可以使用 DOS 甚至 Windows DOS 窗口，甚至可以模拟中断。当然，您将使用一些编译器，例如 Borland C++ 3.x (dos 16bit)。setvect 和 getvect 可用于中断挂钩。

# ruby-on-rails-3 - 如何更新 Rails 中的嵌套数据

> ID：12187271
> 
> 赞同：1
> 
> 时间：2012-08-29T22:14:48.587
> 
> 标签：ruby-on-rails-3, activerecord

我有一些参加测验的用户。我跟踪他们选择的结果。我需要弄清楚如何让他们更改他们的测验提交。如果我只是将答案联系起来，他们会回答两次这个问题。建立数据很复杂，ActiveRecord 是否提供了一种方法来处理这个问题？

整个示例将在独立文件中运行。

这是我的架构：

```
require 'active_record'

ActiveRecord::Base.establish_connection adapter: 'sqlite3', database: ':memory:'

ActiveRecord::Schema.define do
  self.verbose = false

  create_table :users do |t|
    t.string :name
  end

  create_table :questions do |t|
    t.string :name
  end

  create_table :question_results do |t|
    t.string  :name
    t.integer :question_id
  end

  create_table :question_results_users do |t|
    t.integer :user_id
    t.integer :question_result_id
  end
end 
```

这是我的模型：

```
class User < ActiveRecord::Base
  has_and_belongs_to_many :question_results
  has_many :questions, through: :question_results
end

class Question < ActiveRecord::Base
  has_many :question_results
end

class QuestionResult < ActiveRecord::Base
  belongs_to :question
  has_and_belongs_to_many :users
end 
```

让我们提出三个问题和一些答案：

```
Question.create! name: "What's your favourite movie?" do |question|
  question.question_results.build name: 'Gattaca'
  question.question_results.build name: 'Super Troopers'
end

Question.create! name: 'Who do you want to be president?' do |question|
  question.question_results.build name: 'Barack Obama'
  question.question_results.build name: 'Mitt Romney'
  question.question_results.build name: 'Mickey Mouse'
end

Question.create! name: "What's your favourite colour?" do |question|
  question.question_results.build name: 'black'
  question.question_results.build name: 'green'
end 
```

让我们创建一个用户：

```
jim = User.create! name: 'Jim'
jim.question_results << QuestionResult.find_by_name('Gattaca')
jim.question_results << QuestionResult.find_by_name('Barack Obama')
jim.question_results << QuestionResult.find_by_name('black')

jim.question_results                  # => [#<QuestionResult id: 1, name: "Gattaca", question_id: 1>, #<QuestionResult id: 3, name: "Barack Obama", question_id: 2>, #<QuestionResult id: 6, name: "black", question_id: 3>]
jim.question_results.map(&:question)  # => [#<Question id: 1, name: "What's your favourite movie?">, #<Question id: 2, name: "Who do you want to be president?">, #<Question id: 3, name: "What's your favourite colour?">] 
```

现在 Jim 改变了主意，他决定喜欢 Super Troopers 并且不想投票，但他仍然喜欢黑色。我如何在不让他多次回答问题的情况下更新它？

```
# pretend we're in a controller here (also note that I can change the format of the data, if there is something more convenient)
posted_from_form = {
  questions: {
    Question.all[0].id => 'Super Troopers',
    Question.all[1].id => '',
    Question.all[2].id => 'black',
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T17:39:49.707

首先让我们更改数据的格式，以便结果是 id 形式而不是 name 形式：

```
posted_from_form = {
  questions: {
    Question.all[0].id => QuestionResult.find_by_name('Super Troopers').id.to_s,
    Question.all[1].id => '',
    Question.all[2].id => QuestionResult.find_by_name('black').id,
  }
} 
```

然后您可以直接设置 id，ActiveRecord 将处理所有复杂性：

```
jim.question_result_ids = posted_from_form[:questions].values # => ["2", "", 6]
jim.question_results # => [#<QuestionResult id: 6, name: "black", question_id: 3>, #<QuestionResult id: 2, name: "Super Troopers", question_id: 1>] 
```

# java - doThrow 中看起来正确的 Mockito 异常

> ID：12187274
> 
> 赞同：22
> 
> 时间：2012-08-29T22:15:04.193
> 
> 标签：java, mockito

我正在尝试模拟一种方法，看看我是否正确处理了异常。这是据我所知。

界面：

```
interface SampleManager {
    void deleteVariome(String specimenId, String analysisId) throws Exception;
    // ...
} 
```

单元测试：

```
// ...
SampleManger sampleManager = mock(SampleManager.class);

// below is line 753
doThrow(Exception.class).when(sampleManager).deleteVariome(sample1.getId(), analysisId); 
```

结果：

```
org.mockito.exceptions.misusing.UnfinishedStubbingException: 
Unfinished stubbing detected here:
-> at ...server.ArchiveManagerImplUTest.deleteVariomeFails(ArchiveManagerImplUTest.java:753)

E.g. thenReturn() may be missing.
Examples of correct stubbing:
    when(mock.isOk()).thenReturn(true);
    when(mock.isOk()).thenThrow(exception);
    doThrow(exception).when(mock).someVoidMethod(); <-- this looks a log like what I did!

Hints:

 1\. missing thenReturn()

 2\. you are trying to stub a final method, you naughty developer! <-- I have a lot of other mocks of this interface in this test that work. 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-03T09:42:14.427

从我刚刚遇到的一个相同问题中，我怀疑这`sample`是一个模拟，你`sample.getId()`在其他地方存根吗？无论如何，这在我的情况下导致了这个问题。

出于某种原因，如果您传递给以这种方式使用的存根的参数之一是您也模拟的方法的结果，则 Mockito 会感到不安`doThrow`。也许这是一种避免无限循环的重入检查，我不知道。

无论如何，尝试用`sample.getId()`一个常数值替换，这应该可以解决问题。您可以考虑使用在测试中声明的常量来进行模拟和任何进一步的使用。然后，您还`sample.getId()`可以通过添加另一个调用来检查您正在测试的方法所使用的`verify`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T16:33:16.630

正如 Gijs 的回答中所述，这可能是由于 Mockito 中的一个错误。这是一个重现它的完整测试：

```
interface Sample { String getId(); }
interface SampleManager {
    void deleteVariome(String specimenId, String analysisId);
}

@Test
public void probableMockitoBug() {
    Sample sample1 = mock(Sample.class);
    when(sample1.getId()).thenReturn("a");

    SampleManager manager = mock(SampleManager.class);
    doThrow(Exception.class).when(manager).deleteVariome(sample1.getId(), "b");

    manager.deleteVariome("a", "b");
} 
```

测试产生以下输出：

```
org.mockito.exceptions.misusing.UnfinishedStubbingException：
此处检测到未完成的存根：
-> 在 org.mockitousage.JavadocExamplesTest.probableMockitoBug(JavadocExamplesTest.java:404)

例如 thenReturn() 可能会丢失。
正确的存根示例：
    当（模拟。isOk（））。然后返回（真）；
    when(mock.isOk()).thenThrow(异常);
    doThrow(exception).when(mock).someVoidMethod();
提示：
 1\. 缺少 thenReturn()
 2\. 你正试图存根最后的方法，你这个顽皮的开发者！

    在 org.mockito.exceptions.Reporter.unfinishedStubbing（Reporter.java:55）
    在 org.mockito.internal.progress.MockingProgressImpl.validateState(MockingProgressImpl.java:74)
    在 org.mockito.internal.progress.ThreadSafeMockingProgress.validateState(ThreadSafeMockingProgress.java:49)
    在 org.mockito.internal.MockHandler.handle(MockHandler.java:71)
    在 org.mockito.internal.InvocationNotifierHandler.handle(InvocationNotifierHandler.java:36)
    在 org.mockito.internal.creation.MethodInterceptorFilter.intercept(MethodInterceptorFilter.java:48)
    在 org.mockitousage.JavadocExamplesTest$Sample$$EnhancerByMockitoWithCGLIB$$d5ac41.getId()
    在 org.mockitousage.JavadocExamplesTest.probableMockitoBug（JavadocExamplesTest.java:404）
    在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    在 org.mockito.internal.runners.JUnit45AndHigherRunnerImpl.run(JUnit45AndHigherRunnerImpl.java:37)
    在 org.mockito.runners.MockitoJUnitRunner.run(MockitoJUnitRunner.java:62)

```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-30T00:01:46.020

这个错误通常在它实际发生的地方之后报告。如果您未能正确地存根某些东西，Mockito 通常直到您下次调用其中一个 Mockito 方法时才能知道。这可能在同一个测试方法中，在同一个类中稍后的测试方法，甚至是完全不同的测试类。

你引用的那行对我来说看起来不错。看一下它上面的行，您在其中调用了 Mockito 存根或验证方法。您很可能有一个`when`没有关联的`thenReturn`,`then`或`thenThrow`. 或者您可能`verify`缺少实际的方法调用。还有一些其他的可能性。

如果您在引用的行上方找不到错误，请发布更多代码，我会仔细查看。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T22:52:48.923

您必须提供 Exception.class 的*实例*，而不是 Exception 类本身。

```
doThrow(new Exception()).when(sampleManager).deleteVariome(sample1.getId(), analysisId); 
```

**编辑** @DavidWallace 纠正了我，所以请注意（或者说是开明的），从 1.9 开始，您可以只提供要抛出的异常类，它会为您构建一个。

# java - JDialog 用于状态显示。.

> ID：12187279
> 
> 赞同：1
> 
> 时间：2012-08-29T22:15:39.310
> 
> 标签：java, swing, jdialog, joptionpane, modality

我只想实现一个状态对话框。如何显示阻止用户输入但允许父窗口处理自己的工作的 JDialog？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T22:19:13.567

您可以为此使用模态 JDialog 或 JOptionPane（实际上只不过是一个专门的模态 JDialog），只要确保

*   这项工作不能在父“窗口”中完成
*   而是应该在后台线程中完成
*   并且这个线程应该在设置对话框可见之前启动。
*   将 SwingWorker 用于此后台线程，然后您的对话框可以通过添加 PropertyChangeListener 并让 SwingWorker 更新其进度属性来显示定量进度信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T22:18:46.403

您可以使用创建和自定义不同类型的对话框`JOptionPane`。看看[JOptionPane Features](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html#features)。另外，还得看

*   [JDialog（对话框所有者，布尔模式）](http://docs.oracle.com/javase/7/docs/api/javax/swing/JDialog.html#JDialog%28java.awt.Dialog,%20boolean%29)

*   [模态类型](http://docs.oracle.com/javase/7/docs/api/java/awt/Dialog.html#setModalityType%28java.awt.Dialog.ModalityType%29)

*   最好的可能是[JOptionPane](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html#features)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T22:20:07.513

带有静态方法的[JOptionPane](http://docs.oracle.com/javase/7/docs/api/index.html?javax/swing/JOptionPane.html)`JOptionPane.showXXXDialog();`，还有什么？

# java - 如果并行 Java 程序受内存限制，如何提高性能？

> ID：12187282
> 
> 赞同：1
> 
> 时间：2012-08-29T22:16:05.773
> 
> 标签：java, multithreading, optimization, parallel-processing, bandwidth

我写了一个并行的java程序。它通常工作：

*   它需要 a`String input`作为输入；
*   然后`input`切成`String inputs[numThreads]`均匀；
*   每个`inputs[i]`被分配到`thread_i`处理，并生成`results[i]`；
*   在所有工作线程完成后，`main`线程将合并`results[i]`到`result`.

10核（物理核）机器上的性能数据如下。

```
Threads#    1 thread    2 threads   4 threads   8 threads   10 threads
Time(ms)       78           41          28          21           21 
```

笔记：

*   JVM 预热时间已被消除（前 50 次运行）。
*   该时间不包括线程开始/加入时间。

当线程数超过 8 个时，内存带宽似乎成为瓶颈。

在这种情况下，如何进一步提高性能？我的并行 Java 程序中是否存在任何设计问题？

为了检查这个可伸缩性问题的原因，我在方法中插入了一个（无意义的计算）循环`process(inputs[i])`。这是新数据：

```
Threads#    1 thread      10 threads
Time(ms)     41000          4330 
```

新数据显示了 10 个线程的良好可扩展性，这反过来证实了原始（没有无意义的循环）存在内存问题，因此其可扩展性仅限于 8 个线程。

但是无论如何要规避这个问题，例如将数据预加载到每个内核的本地缓存中，还是批量加载？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T22:18:13.537

我发现您在这里不太可能遇到内存带宽问题。您的运行时间很可能很短，以至于当您接近 0 时，您主要是在计时线程启动/关闭或热插拔编译器优化周期。从运行如此短的 Java 任务中获取相关的时间信息几乎毫无价值。最初运行的热插拔编译器和其他优化通常在类生命周期的早期主导 CPU 使用。我们的生产应用程序只有在现场服务运行几分钟后才能稳定下来。

如果您可以通过添加更多输入数据或通过反复计算相同结果来显着增加运行时间，您可能会更好地了解最佳线程数是多少。

**编辑：**

现在您已经在较长时间内添加了 1 个和 10 个线程的计时，在我看来您不受任何约束，因为计时似乎是相当线性的——有一些线程开销。41000/10 = 4100 与 10 个线程的 4330。

很好地演示了线程可以对 CPU 绑定的应用程序做什么。:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T22:39:07.603

你有多少个逻辑核心？

考虑一下——假设你有一个核心和一百个线程。要做的工作是一样的，它不能分布在多个核心上，但是现在你有大量的线程切换开销。

现在想象你说四个核心和四个线程。假设没有其他瓶颈，计算时间是四分之一。

现在想象你有四个核心和八个线程。您的计算时间大约是四分之一，但您会增加一些线程交换开销。

请注意超线程，它可能会帮助或阻碍您，具体取决于计算任务的性质。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T22:34:33.573

我会说你的损失归结为切换线程。您的线程比内核多，并且不需要为较慢的进程阻塞，因此它们会被切换进来，做一些工作，然后 gettimg 切换出来以切换另一个线程。切换线程是一个昂贵的过程，考虑到你似乎在做什么我会本能地将线程数限制为 8 个（为操作系统保留两个内核），你的性能数据似乎支持我。

# android - Android：如何在 onDraw() 中获取位图的缩放宽度

> ID：12187283
> 
> 赞同：5
> 
> 时间：2012-08-29T22:16:07.630
> 
> 标签：android, bitmap, scale

简单的问题，简单的答案不起作用。我有一个位图，我想通过系统在 onDraw() 方法中为不同的 DPI 屏幕将其尺寸缩放到显示器。bitmap.width() 成功返回其未缩放的宽度。但是， bitmap.getScaledWidth() 返回零。我试过 getScaledWidth(canvas) 和 getScaledWidth(canvas.getDensity())，但都返回 0。确实，canvas.getDensity() 返回零，所以我什至无法手动计算。

我究竟做错了什么？

详细一点。我正在使用自定义视图。位图在类中声明并在构造函数中加载。

编辑：

我发现使用：

```
 DisplayMetrics metrics = new DisplayMetrics();
        wm.getDefaultDisplay().getMetrics(metrics); 
```

bitmap.getScaledHeight(metrics) 返回与 bitmap.getHeight() 相同的值。

看起来 bitmap.getWidth() 会在缩放后返回驻留位图的尺寸，这意味着没有明显的方法可以获取位图的原始宽度。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T22:59:54.997

Canvas 类对 drawBitmap() 函数有很多重载。其中之一允许您通过非常舒适的界面缩放/剪切位图。

[`public void drawBitmap (Bitmap bitmap, Rect src, RectF dst, Paint paint`)](http://developer.android.com/reference/android/graphics/Canvas.html#drawBitmap%28android.graphics.Bitmap,%20android.graphics.Rect,%20android.graphics.RectF,%20android.graphics.Paint%29)

在哪里

*   **Bitmap bitmap** - 是你要绘制的位图
*   **Rect src** - 位图中的源矩形。如果它不为空，它将从您的位图中切出一块（在 src 的大小和位置）
*   **RectF dst** - 此 Rect 将代表矩形，您的位图将适合。
*   **油漆油漆**- 可选油漆

现在举个例子！比方说，您想将位图**宽度**缩小到***1/2***，并将其**高度**增加到原来的***2***倍：

```
float startX = 0; //the left
float startY = 0; //and top corner (place it wherever you want)
float endX = startX + bitmap.getWidth() * 0.5f; //right
float endY = startY + bitmap.getHeight() * 2.0f; //and bottom corner

canvas.drawBitmap(bitmap, null, new RectF(startX, startY, endX, endY), null); 
```

**更新**

在阅读您的评论后，我真的不明白您要完成什么，但这里有一些额外的信息可以开始：

获取 Bitmap 的原始大小而不将其加载到内存中：

```
BitmapFactory.Options options = new BitmapFactory.Options();
bitmapOptions.inJustDecodeBounds = true; // bitmap wont be loaded into the memory

//won't load the Bitmap, but the options will contain the required information.
BitmapFactory.decodeStream(inputStream, null, options);
/*or*/ BitmapFactory.decodeFile(pathName, options);

int originalWidth = bitmapOptions.outWidth;
int originalHeight = bitmapOptions.outHeight; 
```

现在，如果您有另一个您的实际（缩放）`Bitmap`或一个`ImageView`，您想与原始比较，那么您可以使用它（使用`getWidth()`和获取宽度和高度`getHeight()`）：

```
/*Get these values*/
int originalWidth, originalHeight, scaledWidth, scaledHeight; 

float scaleWidthRatio = (float)scaledWidth / originalWidth;
float scaleHeightRatio = (float)scaledHeight / originalHeight; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T15:15:10.083

这个怎么样？您自己缩放位图。:-)

```
protected void onDraw(Canvas canvas) {
        //super.onDraw(canvas);
        Drawable drawable = getDrawable();
        if(drawable==null)
            Log.d("onDraw()","getDrawable returns null");

        Bitmap  fullSizeBitmap,scaledBitmap = null,roundBitmap = null;

        fullSizeBitmap = ((BitmapDrawable)drawable).getBitmap() ;

        //get width & height of ImageView
        int scaledWidth = getMeasuredWidth();
        int scaledHeight = getMeasuredHeight();

        //bitmap, which will receive the reference to a bitmap scaled to the bounds of the ImageView.
        if(fullSizeBitmap!=null)
        scaledBitmap= getScaledBitmap(fullSizeBitmap,scaledWidth,scaledHeight);

        //Now, draw the bitmap on the canvas
        if(roundBitmap!=null)
           canvas.drawBitmap(roundBitmap, 0,0 , null);
} 
```

# regex - 在正则表达式中捕获逗号之前的字符串

> ID：12187287
> 
> 赞同：4
> 
> 时间：2012-08-29T22:16:42.210
> 
> 标签：regex, capture

我正在编写一些原始的正则表达式代码并在在线测试仪上对其进行测试。我想在逗号之前捕获一个字符串列表。具体来说，我想在逗号之前最多捕获 3 个字符串。前任。

```
string string string, 
```

我想捕获“字符串字符串”（包括空格）。

我怎么做？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-29T22:32:40.283

捕获逗号前字符的最安全方法是：`^([^,]*)`

解释：

```
^        Start of string
(        Start of capture group
[^,]*    Any number of any non-comma characters
)        End of capture group 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-29T22:18:24.720

如果你的字符串只以逗号结尾，你可以使用这样的东西：

```
(.*?), 
```

如果您的字符串*包含*逗号，则应该可以：

```
(.*), 
```

这`?`使得第一个模式的捕获组尽可能不贪婪。删除它会使捕获组变得贪婪。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-16T03:51:19.810

```
^[^,]+ 
```

从字符串的开头开始，获取所有不是逗号的内容。

# jquery - 让 jQuery-Validation-Engine 工作：jquery.validationEngine.closure.js？

> ID：12187289
> 
> 赞同：1
> 
> 时间：2012-08-29T22:16:46.193
> 
> 标签：jquery, jquery-plugins, jquery-validation-engine

我正在尝试在我的表单上使用 jQuery-Validation-Engine。我已经下载了文件，查看了本地演示，并尝试按照说明让我的表单工作。但是，在回顾该站点时，我看到了这一点：

1.  在页面中包含脚本 jquery.validationEngine.closure.js

我在演示的 /js/ 文件中没有看到任何此类文件。

我的文件结构包含： index.html 文件（带表格）

1.  jQuery-Validation-Engine（子文件夹 - 包含 jQuery 验证文件）
2.  jQuery-Validation-Engine/css（子文件夹）
3.  jQuery-Validation-Engine/js（子文件夹）

我调用了validationEngine.jquery.css 和template.css 样式表；以及 jquery.validationEngine-en.js 和 jquery.validationEngine.js 文件。我还包含了 demoValidators.html 演示页面第 14-32 行的脚本。

我已将 id="formID" 属性添加到我的表单标签，并将 class="validate[required]" 属性添加到表单的第一个字段。但是，当我重新加载页面并将光标放在第一个表单字段中，然后将其删除时，我没有看到任何我期望的错误样式：不是红色轮廓，也不是错误消息气泡。

我还应该检查什么以查看脚本是否在表单上起作用？jquery.validationEngine.closure.js 脚本在哪里，在使用此验证器的说明的第 2 步中提到？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T00:34:21.357

从[其中一个演示](http://www.position-relative.net/creation/formValidator/demos/demoValidators.html)的来源：

```
<link rel="stylesheet" href="../css/validationEngine.jquery.css" type="text/css"/>
<link rel="stylesheet" href="../css/template.css" type="text/css"/>
<script src="../js/jquery-1.6.min.js"></script>
<script src="../js/languages/jquery.validationEngine-en.js"></script>
<script src="../js/jquery.validationEngine.js"></script>
<script>
    jQuery(document).ready(function(){
        jQuery("#formID").validationEngine();
    });
</script> 
```

看起来对“jquery.validationEngine.closure.js”的引用在他们的文档中是一个错误。

# javascript - Knockout.js - 向服务器端发送的数据添加属性

> ID：12187292
> 
> 赞同：3
> 
> 时间：2012-08-29T22:17:06.467
> 
> 标签：javascript, json, knockout.js

我有一些通过服务器发送的数据，格式如下：

```
[
  {"Username":"user1@domain.com", "id":1},
  {"Username":"user2@domain.com", "id":2},
  {"Username":"user3@domain.com", "id":3}
] 
```

我将它绑定到一个表，但我希望能够在选中复选框时向表行添加一个类（以表明它已被选中）。这是最终会起作用的方法，我知道问题在于这`Selected`不是我数据中当前的属性。

```
<table>
    <tbody data-bind="foreach: Items">
        <tr data-bind="css:{selected: Selected}">
            <td>
                <input type='checkbox' data-bind="attr:{name: id}, checked: Selected" />
            </td>
            <td data-bind="text: Username"> </td>
        </tr>
    </tbody>
</table>​ 
```

由于 的概念`Selected`纯粹是针对 UI 的，因此让服务器通过网络为我的数据中的每个项目发送它似乎有点愚蠢。

我*想要*发生的基本上是这样的：http: [//jsfiddle.net/xSSMX/](http://jsfiddle.net/xSSMX/)但不必`Selected`在每个项目上添加 observable 属性。

**如何为数据中的每个现有项目添加属性以实现此目的？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T00:46:03.437

您可以使用 map 将字段添加到从服务器获取的数组中，如下所示...

```
data = data.map(function(item) {
            item.Selected = ko.observable(false);
            return item;
        }); 
```

这会将 Selected 添加到每个项目。尽管如果我没记错的话，并非所有浏览器都支持地图，因此您必须添加支持，您可以使用类似于此处找到的功能来完成此功能... [http://www.tutorialspoint.com/javascript /array_map.htm](http://www.tutorialspoint.com/javascript/array_map.htm)。或者您可以使用 jQuery 的`$.each`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T23:46:29.500

当服务器发送数据时，您可以创建一个`userModel(id, userName)`. 默认情况下，此模型将具有`selected`on `false`。我包含了一个 jsFiddle 以使其更加清晰。

[http://jsfiddle.net/xSSMX/1/](http://jsfiddle.net/xSSMX/1/)

# java - 小程序中的主要方法替代

> ID：12187296
> 
> 赞同：3
> 
> 时间：2012-08-29T22:17:19.433
> 
> 标签：java, applet, main

我是一名新程序员，最近才开始使用小程序。但是，我仍然对将通常放在应用程序的 main 方法中的代码放在哪里感到困惑。目前，我正在编写一个程序，它会从普通牌组中随机抽取 10 张牌。

```
import java.awt.Graphics;
import java.awt.Image;
import java.applet.Applet;
import java.lang.Math;

public class unit12Assignment extends Applet
{
Image card1, card2, card3, card4, card5, card6, card7, card8, card9, card10, card11, card12, card13;
Image card14, card15, card16, card17, card18, card19, card20, card21, card22, card23, card24, card25, card26;
Image card27, card28, card29, card30, card31, card32, card33, card34, card35, card36, card37, card38, card39;
Image card40, card41, card42, card43, card44, card45, card46, card47, card48, card49, card50, card51, card52;

public void init()
{
    card1 = getImage( getDocumentBase(), "c1.gif" );
    card2 = getImage( getDocumentBase(), "c2.gif" );
    card3 = getImage( getDocumentBase(), "c3.gif" );
    card4 = getImage( getDocumentBase(), "c4.gif" );
    card5 = getImage( getDocumentBase(), "c5.gif" );
    card6 = getImage( getDocumentBase(), "c6.gif" );
    card7 = getImage( getDocumentBase(), "c7.gif" );
    card8 = getImage( getDocumentBase(), "c8.gif" );
    card9 = getImage( getDocumentBase(), "c9.gif" );
    card10 = getImage( getDocumentBase(), "c10.gif" );
    card11 = getImage( getDocumentBase(), "cj.gif" );
    card12 = getImage( getDocumentBase(), "cq.gif" );
    card13 = getImage( getDocumentBase(), "ck.gif" );
    card14 = getImage( getDocumentBase(), "d1.gif" );
    card15 = getImage( getDocumentBase(), "d2.gif" );
    card16 = getImage( getDocumentBase(), "d3.gif" );
    card17 = getImage( getDocumentBase(), "d4.gif" );
    card18 = getImage( getDocumentBase(), "d5.gif" );
    card19 = getImage( getDocumentBase(), "d6.gif" );
    card20 = getImage( getDocumentBase(), "d7.gif" );
    card21 = getImage( getDocumentBase(), "d8.gif" );
    card22 = getImage( getDocumentBase(), "d9.gif" );
    card23 = getImage( getDocumentBase(), "d10.gif" );
    card24 = getImage( getDocumentBase(), "dj.gif" );
    card25 = getImage( getDocumentBase(), "dq.gif" );
    card26 = getImage( getDocumentBase(), "dk.gif" );
    card27 = getImage( getDocumentBase(), "h1.gif" );
    card28 = getImage( getDocumentBase(), "h2.gif" );
    card29 = getImage( getDocumentBase(), "h3.gif" );
    card30 = getImage( getDocumentBase(), "h4.gif" );
    card31 = getImage( getDocumentBase(), "h5.gif" );
    card32 = getImage( getDocumentBase(), "h6.gif" );
    card33 = getImage( getDocumentBase(), "h7.gif" );
    card34 = getImage( getDocumentBase(), "h8.gif" );
    card35 = getImage( getDocumentBase(), "h9.gif" );
    card36 = getImage( getDocumentBase(), "h10.gif" );
    card37 = getImage( getDocumentBase(), "hj.gif" );
    card38 = getImage( getDocumentBase(), "hq.gif" );
    card39 = getImage( getDocumentBase(), "hk.gif" );
    card40 = getImage( getDocumentBase(), "s1.gif" );
    card41 = getImage( getDocumentBase(), "s2.gif" );
    card42 = getImage( getDocumentBase(), "s3.gif" );
    card43 = getImage( getDocumentBase(), "s4.gif" );
    card44 = getImage( getDocumentBase(), "s5.gif" );
    card45 = getImage( getDocumentBase(), "s6.gif" );
    card46 = getImage( getDocumentBase(), "s7.gif" );
    card47 = getImage( getDocumentBase(), "s8.gif" );
    card48 = getImage( getDocumentBase(), "s9.gif" );
    card49 = getImage( getDocumentBase(), "s10.gif" );
    card50 = getImage( getDocumentBase(), "sj.gif" );
    card51 = getImage( getDocumentBase(), "sq.gif" );
    card52 = getImage( getDocumentBase(), "sk.gif" );

}
public void paint(Graphics g)
{
    String card[] = new String[10];

    getCards( card[] );

    g.drawImage( cardSelection[0], 10, 10, this);
    g.drawImage( cardSelection[1], 90, 10, this);
    g.drawImage( cardSelection[2], 170, 10, this);
    g.drawImage( cardSelection[3], 250, 10, this);
            //unfinished
} 
```

}

在那里的某个地方，我想添加将随机卡片放入数组并允许绘制方法完成其工作的代码。我的代码就是这个。

```
String cardNumber; 
    double cardRandom;
    int cardRandomNumber;

    for ( int number = 0; number <  10; number++ );
    {
        cardRandom = Math.random() * Math.random() * 10;

        if ( cardRandom <= 52 );
        {
            cardRandomNumber = (int) Math.round( cardRandom );
        }
        cardNumber =  "card" + cardRandomNumber;
        cardSelection[number] = cardNumber;
    } 
```

那么我应该把通常放在应用程序的 main 方法中的代码放在哪里呢？我想我应该把它放在一个方法中，但要确保我会称之为它。任何见解都值得赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:20:46.983

您应该覆盖该`start()`方法并将您的代码放在那里。

ps 我强烈建议你学习数组。当您有许多变量名称仅相差一个数字后缀时，您会发现数组很可能更适合解决问题。在这种特殊情况下，您很可能会将`init()`方法中的 52 行减少到 10 行以下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:34:50.353

您的卡设置代码属于小程序`init()`方法，因为您只初始化一次。您可以将其提取到辅助方法中。

# hibernate - 使用 Hibernate 部署 Axis2 POJO 服务时如何更正 java.lang.IncompatibleClassChangeError？

> ID：12187306
> 
> 赞同：1
> 
> 时间：2012-08-29T22:18:36.360
> 
> 标签：hibernate, axis2, wso2

我目前正在尝试使用 Hibernate 部署示例 POJO Axis2 服务。为了避免在访问 hibernate.cfg.xml 时出现更多错误，我将我的服务分成了 2 个 Maven 项目。一个包含数据映射类和`src/main/resources/hibernate.cfg.xml`文件。

```
<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE hibernate-configuration PUBLIC
          "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
          "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
  <session-factory>
    <property name="connection.url">jdbc:postgresql://localhost/prueba_drools</property>
    <property name="connection.username">prueba_drools</property>
    <property name="connection.password">123456</property>
    <property name="connection.driver_class">org.postgresql.Driver</property>
    <property name="dialect">org.hibernate.dialect.PostgreSQLDialect</property>
    <property name="show_sql">true</property>
    <property name="format_sql">true</property>
    <property name="hbm2ddl.auto">update</property>

    <!-- JDBC connection pool (use the built-in) -->
    <property name="connection.pool_size">1</property>
    <property name="current_session_context_class">thread</property>

    <mapping class="local.lunacore.axis2test.model.Piloto"/>
    <mapping class="local.lunacore.axis2test.model.Robot"/>
    <mapping class="local.lunacore.axis2test.model.TipoRobot"/>
  </session-factory>
</hibernate-configuration> 
```

另一个具有用作 Web 服务的 POJO。

```
package local.lunacore.axis2test;

import local.lunacore.axis2test.model.*;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.Transaction;
import org.hibernate.cfg.AnnotationConfiguration;

/**
 * Hello world!
 *
 */
public class Axis2TestService
{
    public void seed()
    {
        SessionFactory sessionFactory = new AnnotationConfiguration().configure().buildSessionFactory();
        Session session = sessionFactory.getCurrentSession();
        Transaction tx = session.beginTransaction();

        TipoRobot tipoRobotMelee = new TipoRobot();
        tipoRobotMelee.setNombre("Melee (Combate cuerpo a cuerpo)");
        session.save(tipoRobotMelee);

        TipoRobot tipoRobotArtilleria = new TipoRobot();
        tipoRobotArtilleria.setNombre("Artillería");
        session.save(tipoRobotArtilleria);

        TipoRobot tipoRobotAereo = new TipoRobot();
        tipoRobotAereo.setNombre("Aéreo");
        session.save(tipoRobotAereo);

        TipoRobot tipoRobotSoporte = new TipoRobot();
        tipoRobotSoporte.setNombre("Soporte");
        session.save(tipoRobotSoporte);

        Robot robotGundamStrikeFreedom = new Robot();
        robotGundamStrikeFreedom.setNombre("ZGMF-X20A Strike Freedom Gundam");
        robotGundamStrikeFreedom.setTipoRobot(tipoRobotMelee);
        session.save(robotGundamStrikeFreedom);

        Robot robotGundamAileStrike = new Robot();
        robotGundamAileStrike.setNombre("GAT-X105+AQM/E-X01 Aile Strike Gundam");
        robotGundamAileStrike.setTipoRobot(tipoRobotAereo);
        session.save(robotGundamAileStrike);

        Piloto pilotoKiraYamato = new Piloto();
        pilotoKiraYamato.setNombre("Kira Yamato");
        pilotoKiraYamato.getRobots().add(robotGundamStrikeFreedom);
        pilotoKiraYamato.getRobots().add(robotGundamAileStrike);
        session.save(pilotoKiraYamato);
        session.saveOrUpdate(robotGundamStrikeFreedom);
        session.saveOrUpdate(robotGundamAileStrike);

        tx.commit();
    }
} 
```

这是我的`src/main/resources/META-INF/services.xml`：

```
<serviceGroup>
    <service name="Axis2TestService" targetNamespace="http://lunacore.local/axis2test" scope="application">
        <schema schemaNamespace="http://lunacore.local/types" elementFormDefaultQualified="false"/>
        <parameter
                locked="true"
                name="ServiceClass">local.lunacore.axis2test.Axis2TestService</parameter>
    </service>
</serviceGroup> 
```

数据模型 Maven 项目的单元测试表明 Hibernate 配置正确，可以从数据库中读取/创建数据模型。当我在 WSO2 AS 上部署它时，它部署没有错误，但是在调用该`seed`方法时，它崩溃了，并显示以下消息：

```
[2012-08-29 16:45:57,605] ERROR {org.apache.axis2.rpc.receivers.RPCInOnlyMessageReceiver} -  Implementing class
java.lang.IncompatibleClassChangeError: Implementing class
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at org.apache.axis2.deployment.DeploymentClassLoader.findClass(DeploymentClassLoader.java:78)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at org.apache.axis2.deployment.DeploymentClassLoader.loadClass(DeploymentClassLoader.java:273)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    at local.lunacore.axis2test.Axis2TestService.seed(Axis2TestService.java:17)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.axis2.rpc.receivers.RPCUtil.invokeServiceClass(RPCUtil.java:178)
    at org.apache.axis2.rpc.receivers.RPCInOnlyMessageReceiver.invokeBusinessLogic(RPCInOnlyMessageReceiver.java:66)
    at org.apache.axis2.receivers.AbstractMessageReceiver.receive(AbstractMessageReceiver.java:110)
    at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:181)
    at org.apache.axis2.transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:172)
    at org.apache.axis2.transport.http.AxisServlet.doPost(AxisServlet.java:146)
    at org.wso2.carbon.core.transports.CarbonServlet.doPost(CarbonServlet.java:199)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.eclipse.equinox.http.helper.FilterServletAdaptor$FilterChainImpl.doFilter(FilterServletAdaptor.java:56)
    at org.wso2.carbon.mashup.jsservices.custom.ui.CustomUIServletFilter.doFilter(CustomUIServletFilter.java:217)
    at org.eclipse.equinox.http.helper.FilterServletAdaptor.service(FilterServletAdaptor.java:37)
    at org.eclipse.equinox.http.servlet.internal.ServletRegistration.handleRequest(ServletRegistration.java:90)
    at org.eclipse.equinox.http.servlet.internal.ProxyServlet.processAlias(ProxyServlet.java:111)
    at org.eclipse.equinox.http.servlet.internal.ProxyServlet.service(ProxyServlet.java:67)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.wso2.carbon.bridge.BridgeServlet.service(BridgeServlet.java:164)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:240)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:164)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:462)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
    at org.wso2.carbon.server.CarbonStuckThreadDetectionValve.invoke(CarbonStuckThreadDetectionValve.java:154)
    at org.wso2.carbon.server.TomcatServer$1.invoke(TomcatServer.java:254)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:563)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:399)
    at org.apache.coyote.http11.Http11NioProcessor.process(Http11NioProcessor.java:396)
    at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:356)
    at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1534)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662)
[2012-08-29 16:45:57,609] ERROR {org.apache.axis2.receivers.AbstractMessageReceiver} -  org.apache.axis2.AxisFault: Implementing class 
```

在此先感谢，山姆

# java - 解释循环不变量

> ID：12187321
> 
> 赞同：4
> 
> 时间：2012-08-29T22:20:04.877
> 
> 标签：java, loop-invariant

这是过去试卷中的一道题。

为什么`i<=n`循环测试说循环不变量说`i<n`。

是一个合适的答案：它说`i<=n`as `i`will equal`n`在 while 循环的失败条件下。因此，第 6 次迭代`i`将等于`n`失败条件下的值 6。但是，while 循环本身状态`i<n`为`i`从 0 开始，并且将完成循环一次`i`等于 5。

```
private int n =6;

public int fact(){
    int i = 0;
    int f = 1;

    /**loop invariant
     * 0<=i<=n
     * f=i!
     */
    while(i<n){//loop test
        i=i+1;
        f=f*i;
    }

    return f;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:25:56.933

循环不变量是在循环的每次迭代期间必须为真的条件。在这个例子中，我们正在考虑变量的可能值是什么`i`。循环开始时， 的值为`i`0。在循环的最后一次迭代中，`i`递增到`n`循环开始时，然后进行另一次计算。因此， 的值在此循环执行期间`i`满足条件。`0<=i<=n`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:35:57.973

因为`Post-Condition`是`i==n`离开循环的时候。`Pre-Condition`进入循环时是`i==0`. 循环内部`i`正在向 计数`n`。所以不变量是`0 <= i <= n`。

我在解释中省略了不变的部分`f`。这还不够，因为不变量必须捕获循环的正确性和含义。

```
private int n = 6;

public int fact(){
    int i = 0;
    int f = 1;

    /* loop invariant: 0 <= i <= n && f == i! */
    /* PRE: i == 0 && f == i! */
    while (i < n) {
        i = i + 1;
        f = f * i;
    }
    /* POST: i == n && f == i! */

    return f;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T22:34:45.040

在循环的最后一次迭代中，`i`从 5 开始，然后增加到 6。`i<n`在最后一次迭代完成后不会保持。请记住，循环不变量必须在每次迭代的开头（条件）和结尾（最后一条语句之后）都成立。

另请注意，它必须是 0 **<=** i<=n 而不是 0 **<** i<=n，因为`0<i`在第一次迭代结束时不会成立。

# spring - 某些请求上的 Spring MVC 404 错误

> ID：12187328
> 
> 赞同：0
> 
> 时间：2012-08-29T22:20:42.643
> 
> 标签：spring, jakarta-ee, web-applications, spring-mvc

我正在开发 Spring MVC，在 Apache 7.xx 应用程序上并设置了所有内容，没有任何错误。

我有一个我的应用程序将我的调度程序 servlet 映射到 HomeController，它为视图“home/View”提供服务，该视图也在工作。

我想在使用 Spring Security 进行布线和迭代之前实现 UserAccount 和注册用例。

但是，我在表单提交（或 action="UserRegisteration/RegisterForm" method="POST">）上的注册表单（Register.jsp）给出了 404 错误，而不是通过提供视图（为了测试，我让 UserRegisterationController 再次服务 Register.jsp）

* * *

Register.jsp（表单片段）

```
<form action="/UserRegisteration/RegisterForm" method="POST">
                <table width="283" border="1">
  <tr>
    <td width="123"><label for="firstname">First Name</label></td>
    <td width="144"><input type="text" name="firstname" id="firstname"></td>
  </tr>
  <tr>
    <td><label for="lastname">Last Name</label></td>
    <td><input type="text" name="lastname" id="lastname"></td>
  </tr>
  <tr>
    <td><label for="email">Email</label></td>
    <td><input type="text" name="email" id="email"></td>
  </tr>
  <tr>
    <td><label for="phonecontact1">Phone Contact 1</label></td>
    <td><input type="text" name="phonecontact1" id="phonecontact1"></td>
  </tr>
  <tr>
    <td><label for="phonecontact2">Phone Contact 2</label></td>
    <td><input type="text" name="phonecontact2" id="phonecontact2"></td>
  </tr>
  <tr>
    <td><label for="address1">Address 1</label></td>
    <td><input type="text" name="address1" id="address1"></td>
  </tr>
  <tr>
    <td><label for="address2">Address 2</label></td>
    <td><input type="text" name="address2" id="address2"></td>
  </tr>
  <tr>
    <td><label for="industry ">Industry </label></td>
    <td><input type="text" name="industry " id="industry "></td>
  </tr>
  <tr>
    <td><label for="password">Enter Desired Password</label></td>
    <td><input type="text" name="password" id="password"></td>
  </tr>
  <tr>
    <td><input type="reset" name="clear " id="clear " value="Clear Fields"></td>
    <td><input type="submit" name="register" id="register" value="Register"></td>
  </tr>
</table>
</form> 
```

* * *

我有以下方法 createUserAccountRegisteration() 映射到

@RequestMapping(value="/RegisterForm", method=RequestMethod.POST) 见下文：

```
(UserRegisterationController.java)
@Controller
@RequestMapping("/UserRegisteration")
public class UserRegisterationController {
    @Autowired
    private RegisterationService registerationService;
    @Autowired
    private UserAccountService userAccountService;
    @Autowired
    private PasswordService passwordService;
    public UserRegisterationController() {
    }
    public UserRegisterationController(RegisterationService registerationService, UserAccountService userAccountService, PasswordService password) {
        this.registerationService = registerationService;
        this.userAccountService = userAccountService;
        this.passwordService = password;
    }
    //if checked on register link , forward to registeration page
    @RequestMapping(value="/RegisterForm", method=RequestMethod.GET)
    public String serveRegisterationView()
    {
       return  "UserAccount/Register";
    }
    @RequestMapping(value="/RegisterForm", method=RequestMethod.POST)
    public String createUserAccountRegisteration()
    {
     //if submited registeration 
    //check for previous registeration 
    //if registered prompt , forward to sign in 
    //else create registeration , and user account , and password , forward to main user page  
       return  "UserAccount/Register";
    }

} 
```

web.xml

```
<web-app metadata-complete="true" version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
        /WEB-INF/applicationContext.xml
        /WEB-INF/hibernate-context.xml
        </param-value>
    </context-param>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <servlet>
        <servlet-name>cmgr</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>cmgr</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout> 
            30 
        </session-timeout>
    </session-config>
</web-app> 
```

spring-servlet 相关片段（在我的例子中是 cmgr-servlet）

```
 <bean class="org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping"/>

   <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver"     
        p:prefix="/WEB-INF/views/" p:suffix=".jsp" p:viewClass="org.springframework.web.servlet.view.JstlView" /> 
```

applicationContext.xml（相关片段）

```
 <!-- Activates various annotations to be detected in bean classes --> 
    <context:annotation-config />
    <!-- Scans the classpath for annotated components that will be auto-registered as Spring beans.   For example @Controller and @Service. Make sure to set the correct base-package--> 
    <context:component-scan base-package="com.cmgr.*" />    
    <!-- Configures the annotation-driven Spring MVC Controller programming model.  Note that, with Spring 3.0, this tag works in Servlet MVC only!  --> 
    <mvc:annotation-driven/>
    <!-- mapping of static resources-->
    <mvc:resources mapping="/resources/**" location="/resources/" />

</beans> 
```

Register.jsp 表单提交的结果：

浏览器网址：（http://localhost:8084/UserRegisteration/RegisterForm）

HTTP 状态 404 - /UserRegisteration/RegisterForm

* * *

类型状态报告

消息 /UserRegisteration/RegisterForm

描述 请求的资源 (/UserRegisteration/RegisterForm) 不可用。

* * *

Apache Tomcat/7.0.22

* * *

**我注意到浏览器 url 缺少我的应用程序上下文 (/cmgr) 正确的 url 应该是“http://localhost:8084/cmgr/UserRegisteration/RegisterForm”**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:16:18.930

> Register.jsp 表单提交结果：浏览器 URL：(http://localhost:8084/UserRegisteration/RegisterForm)
> 
> 我注意到浏览器 url 缺少我的应用程序上下文 (/cmgr) 正确的 url >应该是“http://localhost:8084/cmgr/UserRegisteration/RegisterForm”

没错，缺少上下文根“/cmgr”。向我们展示您的观点，大概是表单动作是问题所在。

您可以使用 Spring url 标签，如下所示：

```
<spring:url value="/UserRegisteration/RegisterForm" var="targetURL"/>

<form action="${targetURL}" [...] >
</form>` 
```

# ios - 当用户升级手机时，如何测试以确保我的 iOS 应用程序保留其数据？

> ID：12187333
> 
> 赞同：1
> 
> 时间：2012-08-29T22:21:42.717
> 
> 标签：ios, testing, upgrade

我有两部手机。第一部手机有一个尚未发布到商店的我的应用程序的新版本。

*   我在 iTunes 中备份电话 #1。
*   我连接电话#2 并从备份中恢复。

当我打开手机#2 时，下载的是应用程序的 iTunes 版本，而不是通过备份传输新版本。

当用户升级到新手机时，我如何测试以确保我的应用程序商店能够正常工作？

# scala - Scala：在集合中查找匹配并返回匹配依赖值的通用方法

> ID：12187338
> 
> 赞同：1
> 
> 时间：2012-08-29T22:22:28.477
> 
> 标签：scala, scala-collections

我希望在 List 中找到匹配项并根据匹配项返回值。CollectFirst 适用于匹配集合的元素，但在这种情况下，我想匹配元素的成员 swEl 而不是元素本身。

```
abstract class CanvNode (var swElI: Either[CSplit, VistaT])
{         
  private[this] var _swEl: Either[CSplit, VistaT] = swElI
  def member = _swEl
  def member_= (value: Either[CSplit, VistaT] ){ _swEl = value; attach}
  def attach: Unit
  attach

  def findVista(origV: VistaIn): Option[Tuple2[CanvNode,VistaT]] = member match
  {
    case Right(v) if (v == origV) => Option(this, v) 
    case _ => None
  }
}

def nodes(): List[CanvNode] = topNode :: splits.map(i => List(i.n1, i.n2)).flatten

//Is there a better way of implementing this? 
val temp: Option[Tuple2[CanvNode, VistaT]] = 
  nodes.map(i => i.findVista(origV)).collectFirst{case Some (r) => r} 
```

**我是否需要对此进行查看，或者 collectFirst 方法会确保仅根据需要创建集合？**

我觉得这一定是一个相当普遍的模式。另一个例子是，如果一个人有一个主 List 元素的 List 成员，并且想要返回第四个元素（如果有的话）。**有没有我可以调用的标准方法？**如果失败，我可以创建以下内容：

```
implicit class TraversableOnceRichClass[A](n: TraversableOnce[A])
{
  def findSome[T](f: (A) => Option[T]) = n.map(f(_)).collectFirst{case Some (r) => r}
} 
```

然后我可以将上面的内容替换为：

```
val temp: Option[Tuple2[CanvNode, VistaT]] = 
  nodes.findSome(i => i.findVista(origV)) 
```

这使用 2.10 中的隐式类，用于 2.10 之前的使用：

```
class TraversableOnceRichClass[A](n: TraversableOnce[A])
{
  def findSome[T](f: (A) => Option[T]) = n.map(f(_)).collectFirst{case Some (r) => r}
}

implicit final def TraversableOnceRichClass[A](n: List[A]):
  TraversableOnceRichClass[A] = new TraversableOnceRichClass(n) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:19:47.750

作为介绍性侧节点：您正在描述的操作（`Some`如果存在则返回第一个，否则返回）是s 的“第一个”幺半群实例下的 s`None`集合的总和。例如，使用[Scalaz 6](http://code.google.com/p/scalaz/wiki/Scalaz6)：`Option``Option`

```
scala> Stream(None, None, Some("a"), None, Some("b")).map(_.fst).asMA.sum
res0: scalaz.FirstOption[java.lang.String] = Some(a) 
```

或者，您可以将这样的内容放在范围内：

```
implicit def optionFirstMonoid[A] = new Monoid[Option[A]] {
  val zero = None
  def append(a: Option[A], b: => Option[A]) = a orElse b
} 
```

并跳过这一`.map(_.fst)`部分。不幸的是，这些方法在 Scalaz 中都没有适当的惰性，因此将评估整个流（与 Haskell 不同，`mconcat . map (First . Just) $ [1..]`例如 where 就可以了）。

* * *

编辑：作为旁注的旁注：显然Scalaz*确实*提供了一个`sumr`适当的惰性（对于流-这些方法都不适用于视图）。因此，例如，您可以这样写：

```
Stream.from(1).map(Some(_).fst).sumr 
```

不要永远等待你的答案，就像在 Haskell 版本中一样。

* * *

但假设我们坚持使用标准库，而不是这样：

```
n.map(f(_)).collectFirst{ case Some(r) => r } 
```

我会写以下内容，这或多或少是等效的，并且可以说更惯用：

```
n.flatMap(f(_)).headOption 
```

例如，假设我们有一个整数列表。

```
val xs = List(1, 2, 3, 4, 5) 
```

我们可以使它变得惰性，并`map`在其上添加一个具有副作用的函数，以在访问其元素时向我们显示：

```
val ys = xs.view.map { i => println(i); i } 
```

现在我们可以在结果集合上使用`flatMap`一个`Option`-returning 函数，并使用`headOption`它（安全地）返回第一个元素，如果它存在的话：

```
scala> ys.flatMap(i => if (i > 2) Some(i.toString) else None).headOption
1
2
3
res0: Option[java.lang.String] = Some(3) 
```

很明显，当我们按需要达到非空值时，这种情况就会停止。是的，如果您的原始集合是严格的，您肯定需要一个视图，因为否则`headOption`(or `collectFirst`) 无法返回并停止它之前的`flatMap`(or )。`map`

在您的情况下，您可以跳过`findVista`并使用以下内容更加简洁：

```
val temp = nodes.view.flatMap(
  node => node.right.toOption.filter(_ == origV).map(node -> _)
).headOption 
```

当然，您是否觉得这更清晰或只是一团糟，这是一个品味问题。

# php - 如何重新初始化 Zend_Form_Element_Hash？

> ID：12187341
> 
> 赞同：2
> 
> 时间：2012-08-29T22:23:00.880
> 
> 标签：php, zend-framework, zend-form, csrf

在我的网页上，我有`Zend_Form`CSRF 哈希。它提交到同一页面并用于更新用户的数据（姓名、姓氏、生日等......）。我想在每次提交有效的帖子后重新初始化 CSRF 哈希。我怎么能做到？

现在，当我第一次提交“用户数据”表单时，我得到了正确的行为（用户数据得到更新）。但是，如果我再次提交（在第一次正确提交之后）以更改另一个表单字段，我会收到错误消息：

> 两个给定的令牌不匹配

反正有没有正确重新初始化哈希？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T08:52:31.167

您的问题来自设置为**1 hop**`Zend_Form_Element_Hash`的此功能，因此如果您尝试重新提交相同的表单，它将始终失败。这是设计使然，是您寻求的安全性的根源。`$session->setExpirationHops`

 **但是，您可以更改此行为，只需扩展`Zend_Form_Element_Hash`并覆盖此方法即可将*expirationHops*设置为您喜欢的值（*如果您愿意，也可以随时手动设置会话选项*）。

```
public function initCsrfToken()
    {
        $session = $this->getSession();
        $session->setExpirationHops(1, null, true);
        $session->setExpirationSeconds($this->getTimeout());
        $session->hash = $this->getHash();
    } 
```

不言而喻，为了安全起见，执行完全刷新并重新填充表单以执行任何编辑。这应该重置哈希。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T22:18:03.903

我的问题来自篡改 Zend_Form_Element_Hash 初始化方法，我有这个：

```
$_csrf = new Zend_Form_Element_Hash($this->_csrfName);  
$_csrf->setSalt(md5($name));  
$_csrf->setAttrib('id', '');  
$_csrf->initCsrfToken(); 
```

最后一行不应该在那里。当我删除它时，一切都开始正常运行。
@RockyFord：这个`initCsrfToken()`功能是我一开始就看的地方，但
对我来说（我的意思是我的直觉）它不可能是那样的。所以我只是调试，调试，调试，
最后注释掉第 4 行是正确的解决方案。抱歉推迟回复，我完全忘记了。**

# jquery - 与 jquery 滚动路径一起使用时链接不起作用

> ID：12187346
> 
> 赞同：0
> 
> 时间：2012-08-29T22:23:46.133
> 
> 标签：jquery, hyperlink

我知道这可能是一个非常简单和愚蠢的解决方法，但我找不到答案，这让我发疯。

看看[http://mozlo.com/zabzie/](http://mozlo.com/zabzie/)

如果您单击顶部导航中的任何链接，它们就死了。如果我禁用 jquery.scrollpath.js ，它会按预期工作，但问题是我需要那个脚本。关于如何解决这个问题的任何想法？我尝试了我能想到的一切都无济于事，任何帮助表示赞赏

提前致谢！

法比奥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:35:07.243

改变这个：

```
// Add scrollTo on click on the navigation anchors
$("nav").find("a").each(function() {
    var target = $(this).attr("href").replace("#", "");
    $(this).click(function(e) {
        e.preventDefault();

        // Include the jQuery easing plugin (http://gsgd.co.uk/sandbox/jquery/easing/)
        // for extra easing functions like the one below
        $.fn.scrollPath("scrollTo", target, 1000, "easeInOutSine");
    });
}); 
```

到：

```
// Add scrollTo on click on the navigation anchors
$("nav#panelnav").find("a").each(function() {
    var target = $(this).attr("href").replace("#", "");
    $(this).click(function(e) {
        e.preventDefault();

        // Include the jQuery easing plugin (http://gsgd.co.uk/sandbox/jquery/easing/)
        // for extra easing functions like the one below
        $.fn.scrollPath("scrollTo", target, 1000, "easeInOutSine");
    });
}); 
```

这样它就不会影响您的主导航

在 demo.js

# php - 数据库设计；或带有 json 数据的条件选择

> ID：12187347
> 
> 赞同：0
> 
> 时间：2012-08-29T22:23:46.910
> 
> 标签：php, mysql, database

我有一个包含几个表的数据库，这些表包含基本的静态 ID-to-name 数据。2 仅在每个这些参考表中的列。

然后我有另一个表将接收用户输入的数据。每个用户输入实例都有自己的带有时间戳的行，但这里的重要列将包含一个或几个与其他表之一中的名称相关的 ID。为了便于提交和检索此信息，我选择将其作为文本输入，采用 json 格式。

一切都很顺利，直到我意识到我需要将大表与小表连接起来以将名称引用到 ID。我还需要在结果中返回 ID。

此表中的几行可能如下所示的示例：

```
Column 1                            | Column 2                  | Timestamp
["715835199","91158582","90516801"] | ["11987","11987","22474"] | 2012-08-28 21:18:48
["715835199"]                       | ["0"]                     | 2012-08-28 21:22:48
["91158582","90516801"]             | ["11987"]                 | 2012-08-28 21:25:48 
```

此表中将重复 ID# 的输入，但不一定在相同的分组中，因此我将 ID 与名称配对放在单独的表中。

有可能做一个`WHERE name='any-of-these-json-values'`吗？在我查询主表以提取我需要包含的名称的 ID 后，我最好在 php 中加入 ghetto 吗？还是我只需要完全重新设计数据输入表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:29:55.100

首先：

**如果您想单独访问它们，永远不要将多个信息放入一个字段中。绝不。**

也就是说，我认为您将需要创建一个完整的`N:M`关系，其中包括一个连接表：示例表中的一行需要被连接表中的 1-N 行替换。

带有字符串匹配的棘手连接仅对极少数行执行可接受，并且`WHERE name='any-of-these-json-values'`在您的构造中是不可能的：MySQL 不“理解”这是一个 JSON 数组 - 它将其视为非结构化文本。在连接表上，这个子句很自然地出现`WHERE somecolumn IN (1234,5678,8012)`

**编辑**

假设您在`Column 1`其中包含 ID 数组并在`table1`其中`Column 2`携带 ID 数组，则`table2`您必须执行类似的操作

```
CREATE TABLE t1t2join (
  t1id INT NOT NULL ,
  t2id INT NOT NULL ,
  `Timestamp` DATETIME NOT NULL ,
  PRIMARY KEY (t1id,t2id,`Timestamp`) , 
  KEY (t2id)
) 
```

（您可能需要对密钥进行健全性检查）

在插入时执行以下操作（在伪代码中）

```
Remember timestamp
Cycle all permutations of (Column1,Column2) given by user
Create row 
```

因此，对于您的第三个示例行，SQL 将是：

```
SELECT @now:=NOW();
INSERT INTO t1t2join VALUES
  (91158582,11987,@now),
  (90516801,11987,@now); 
```

# java - Android SocketException - 未从服务器收到信息

> ID：12187350
> 
> 赞同：0
> 
> 时间：2012-08-29T22:24:14.560
> 
> 标签：java, android

我正在尝试发送服务器 json 并获取 json 作为回报以在列表视图中显示。listview 由 refreshViewModels() 方法处理。我发送的 json 字符串在这行代码中：

outputJSONserv = "{\"to\":\"广播\",\"type\":\"1\",\"payload\":"+outputJSON+"}"; 其中 outputJSON 是一个 json 字符串。

当我发送这个字符串时，我确实在一部手机上得到了一个字符串，但在另一部手机上却没有。我在 logcat 中收到一条警告，说这是一个错误，与我的输出 json 的 SocketException 有关。下面是两个 logcat，用于显示正在发生的事情并提供有关 SocketException 的详细信息：

来自phone1的Logcat：

```
I/ActivityManager(  110): Config changed: { scale=1.0 imsi=310/0 loc=en_US touch=3     keys=1/1/2 nav=1/1 orien=1 layout=18 uiMode=17 seq=31}
I/ActivityManager(  110): Starting activity: Intent { act=android.intent.action.MAIN    cat=[android.intent.category.HOME] flg=0x10200000 cmp=com.android.launcher/com.android.launcher2.Launcher }
W/InputManagerService(  110): Ignoring hideSoftInput of: com.android.internal.view.IInputMethodClient$Stub$Proxy@45ca49c8
I/ActivityManager(  110): Starting activity: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=com.google.android.gm/.ConversationListActivityGmail bnds=[83,240][157,319] }
--------- beginning of /dev/log/main
W/System.err( 2263): java.net.SocketException: Socket is closed
W/System.err( 2263):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err( 2263):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err( 2263):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON3:{"from":"65.46.170.6:14842","type":11,"payload":{"message":""}}
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm( 2263): GC_FOR_MALLOC freed 131 objects / 1883144 bytes in 216ms
W/System.err( 2263): java.net.SocketException: Socket is closed
W/System.err( 2263):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err( 2263):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err( 2263):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON3:
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm( 2263): GC_FOR_MALLOC freed 131 objects / 1883016 bytes in 221ms
W/System.err( 2263): java.net.SocketException: Socket is closed
W/System.err( 2263):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err( 2263):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err( 2263):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON3:
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm( 2263): GC_FOR_MALLOC freed 131 objects / 1883016 bytes in 214ms
W/System.err( 2263): java.net.SocketException: Socket is closed
W/System.err( 2263):    at oorg.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err( 2263):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err( 2263):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON3:
D/WindowManager(  110): Home Key Test : false : false
D/PhoneWindow(  423): couldn't save which view has focus because the focused view android.webkit.WebView@45affd60 has no id.
D/Gmail   (  423): com.google.android.gm.HtmlConversationActivity@45b240d0 onPause() finished
I/ActivityManager(  110): Starting activity: Intent { act=android.intent.action.MAIN cat=[android.intent.category.HOME] flg=0x10200000 cmp=com.android.launcher/com.android.launcher2.Launcher }
W/InputManagerService(  110): Ignoring hideSoftInput of: com.android.internal.view.IInputMethodClient$Stub$Proxy@45e77378
D/dalvikvm( 2263): GC_FOR_MALLOC freed 131 objects / 1883016 bytes in 309ms
W/System.err( 2263): java.net.SocketException: Socket is closed
W/System.err( 2263):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err( 2263):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err( 2263):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON3:
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm( 2263): GC_FOR_MALLOC freed 131 objects / 1883016 bytes in 82ms
W/System.err( 2263): java.net.SocketException: Socket is closed
W/System.err( 2263):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err( 2263):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err( 2263):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON3:{"from":"65.46.170.6:14842","type":11,"payload":{"message":""}}
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm( 2263): GC_FOR_MALLOC freed 131 objects / 1883144 bytes in 116ms
D/dalvikvm( 2263): GC_FOR_MALLOC freed 42 objects / 1252232 bytes in 95ms
W/System.err( 2263): java.net.SocketException: Socket is closed
W/System.err( 2263):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err( 2263):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err( 2263):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON3:
W/System.err( 2263): java.net.SocketException: Socket is closed
W/System.err( 2263):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err( 2263):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err( 2263):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON3:
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm( 2263): GC_FOR_MALLOC freed 215 objects / 2513520 bytes in 93ms
W/System.err( 2263): java.net.SocketException: Socket is closed
W/System.err( 2263):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err( 2263):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err( 2263):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON3:
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm(  198): GC_EXTERNAL_ALLOC freed 3572 objects / 355992 bytes in 102ms
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm( 2263): GC_FOR_MALLOC freed 144 objects / 1883560 bytes in 616ms
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm( 2263): GC_FOR_MALLOC freed 26 objects / 626264 bytes in 121ms
I/ActivityManager(  110): Starting activity: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=com.iconnexus.client/.SplashScreen }
D/dalvikvm( 2263): GC_FOR_MALLOC freed 22 objects / 1564120 bytes in 155ms
W/System.err( 2263): java.net.SocketException: Socket is closed
W/System.err( 2263):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err( 2263):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err( 2263):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON3:{"from":"65.46.170.6:14842","type":11,"payload":{"message":""}}
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm( 2263): GC_FOR_MALLOC freed 449 objects / 3462208 bytes in 89ms
W/System.err( 2263): java.net.SocketException: Socket is closed
W/System.err( 2263):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err( 2263):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err( 2263):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON3:
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm( 2263): GC_FOR_MALLOC freed 131 objects / 1883016 bytes in 195ms
W/System.err( 2263): java.net.SocketException: Socket is closed
W/System.err( 2263):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err( 2263):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err( 2263):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON3:
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON
I/ActivityManager(  110): Starting activity: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=com.iconnexus.client/.SplashScreen }
D/dalvikvm( 2263): GC_FOR_MALLOC freed 135 objects / 1883144 bytes in 233ms
W/System.err( 2263): java.net.SocketException: Socket is closed
W/System.err( 2263):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err( 2263):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err( 2263):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err( 2263):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient( 2263): IN REPEATINGTHREAD-INPUTJSON3:{"from":"65.46.170.6:14842","type":11,"payload":{"message":""}} 
```

来自电话 2 的 Logcat：

```
E/AndroidClient(25069): Sent dataOutputStream
E/AndroidClient(25069): Before initEventHandlers
E/AndroidClient(25069): After initEventHandlers
E/AndroidClient(25069): Start Repeat Timer
E/AndroidClient(25069): In RepeatingTask()
E/AndroidClient(25069): Before inputJSON String
E/AndroidClient(25069): Hello String:org.apache.harmony.luni.net.SocketInputStream@45a15fb8
E/AndroidClient(25069): Hello String2:
D/dalvikvm(25069): GC_FOR_MALLOC freed 174 objects / 809424 bytes in 94ms
W/System.err(25069): java.net.SocketException: Socket is closed
W/System.err(25069):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err(25069):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err(25069):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err(25069):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err(25069):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient(25069): IN REPEATINGTHREAD-INPUTJSON3:
I/ActivityManager(  110): Displayed activity com.iconnexus.client/.AndroidClient: 2234 ms (total 2234 ms)
E/AndroidClient(25069): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm(25069): GC_FOR_MALLOC freed 357 objects / 778680 bytes in 198ms
W/System.err(25069): java.net.SocketException: Socket is closed
W/System.err(25069):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err(25069):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err(25069):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err(25069):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err(25069):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient(25069): IN REPEATINGTHREAD-INPUTJSON3:
I/WindowManager(  110): home key test1= 1
D/WindowManager(  110): Home Key Test : false : false
D/WindowManager(  110): Home Key Test : false : false
I/ActivityManager(  110): Starting activity: Intent { act=android.intent.action.MAIN cat=[android.intent.category.HOME] flg=0x10200000 cmp=com.android.launcher/com.android.launcher2.Launcher }
W/InputManagerService(  110): Ignoring hideSoftInput of: com.android.internal.view.IInputMethodClient$Stub$Proxy@45e1c7f8
E/AndroidClient(25069): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm(25069): GC_FOR_MALLOC freed 322 objects / 778768 bytes in 182ms
W/System.err(25069): java.net.SocketException: Socket is closed
W/System.err(25069):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err(25069):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err(25069):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err(25069):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err(25069):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient(25069): IN REPEATINGTHREAD-INPUTJSON3:
I/ActivityManager(  110): Starting activity: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=org.jtb.alogcat/.LogActivity }
D/dalvikvm( 1827): GC_FOR_MALLOC freed 8088 objects / 813080 bytes in 104ms
E/AndroidClient(25069): IN REPEATINGTHREAD-INPUTJSON
D/dalvikvm(25069): GC_FOR_MALLOC freed 131 objects / 770248 bytes in 186ms
W/System.err(25069): java.net.SocketException: Socket is closed
W/System.err(25069):    at org.apache.harmony.luni.net.PlainSocketImpl.getOutputStream(PlainSocketImpl.java:306)
W/System.err(25069):    at java.net.Socket.getOutputStream(Socket.java:515)
W/System.err(25069):    at com.iconnexus.client.AndroidClient.sendBytes(AndroidClient.java:379)
W/System.err(25069):    at com.iconnexus.client.AndroidClient$RepeatingTask.run(AndroidClient.java:499)
W/System.err(25069):    at java.util.Timer$TimerImpl.run(Timer.java:289)
E/AndroidClient(25069): IN REPEATINGTHREAD-INPUTJSON3: 
```

onCreate() 方法：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Log.e(LOG_TAG, "Before OnCreate() Try");
    try {
        Log.e(LOG_TAG, "In OnCreate() Try");
        socket = new Socket("23.23.175.213", 9000); 
        Log.e(LOG_TAG, "Created Socket");
        dataOutputStream = new DataOutputStream(socket.getOutputStream());
        Log.e(LOG_TAG, "Created DataOutputStream");
        dataInputStream = new DataInputStream(socket.getInputStream());
        Log.e(LOG_TAG, "Created DataInputStream");

        //out = new OutputStream();
        out = socket.getOutputStream();
        inputStr = socket.getInputStream();

        //Thread readjsonthrd = new Thread(new ReadJSONThread());
        //inputstrrd = new InputStreamReader(socket.getInputStream());

        p = new Profile();
        Log.e(LOG_TAG, "Created Profile Instance");

        //Gets the local profile via JSON and converts into Profile type
        Gson gson = new Gson();
        Log.e(LOG_TAG, "Created Gson Instance" + "GetProfileJSONStr:" + p.getProfileJSONStr());
        p = gson.fromJson(p.getProfileJSONStr(), Profile.class);
        setProfile(p);
        Log.e(LOG_TAG, "Converted Profile to JSON");

        //Gson gson = new Gson();
        Log.e(LOG_TAG, "Before: outputJSON = gson.toJson(p);");
        outputJSON = gson.toJson(p).toString();
        outputJSON = removeExcessStr(outputJSON);
        Log.e(LOG_TAG, "ProfilePicStr Base64:"+p.getProfilePicStr());

        outputJSON = outputJSON.replace("Name","name");
        outputJSON = outputJSON.replace("TagLine","message");
        outputJSON = outputJSON.replace("Title","title");
        outputJSON = outputJSON.replace("Company", "company");
        outputJSON = outputJSON.replace("Industry","industry");
        outputJSON = outputJSON.replace("WhatIDo","whatido");
        outputJSON = outputJSON.replace("WhoDoIWantToMeet","meetwho");
        outputJSON = outputJSON.replace("WHOOZNEAR_PROFILEPIC","photo");
        outputJSON = outputJSON.replaceAll("[c][o][n][t][e][n][t][:][/][/][a-zA-Z0-9]+[/][a-zA-Z0-9]+[/][a-zA-Z0-9]+[/][a-zA-Z0-9]+[/][a-zA-Z0-9]+", getPicBase64Str()); /*"helloworld2"*/

        if (!outputJSON.contains(",\"photo\":")) { 
            outputJSON = outputJSON.replace("}",",\"photo\":"+"\"IconnexUs\"}");
            outputJSON = outputJSON.replace("}",",\"photo\":"+"\""+getPicBase64Str()+"\"}");
            outputJSON = outputJSON.replace("}",",\"status\":\"enabled\"}");
        }
        else { 
            outputJSON = outputJSON.replace("}",",\"status\":\"enabled\"");
        }

        outputJSONserv = "{\"to\":\"broadcast\",\"type\":\"1\",\"payload\":"+outputJSON+"}";

        Log.e(LOG_TAG, "Created outputJSON:" + outputJSON);
        Log.e(LOG_TAG, "Created outputJSON Server:" + outputJSONserv);
        JSONObject outObject = new JSONObject();
        try {
            outObject.put("photo", "hello");
            outObject.put("type", "50");
            outObject.put("payload", outputJSON);
            outputJSON = gson.toJson(outObject).toString();
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        Log.e(LOG_TAG, "Value of PROFILEPIC STRING FROM PROFILEMAP: "+profileMap.get("WHOOZNEAR_PROFILEPIC"));
        p.setProfilePicStr(ConvertandSetImagetoBase64(profileMap.get("WHOOZNEAR_PROFILEPIC")));
        //String headerJSON = gson.toJson(outObject).toString();
        outputJSON = outputJSON.substring(nthOccurrence(outputJSON, '{', 2)-1, nthOccurrence(outputJSON, '}', 1)-1);

        String input = "["+"Ryan"+"[";
        //"[foo".replaceAll(Pattern.quote("["), "\""); 
        String result = input.replaceAll(Pattern.quote("["), "\"");
        Log.e(LOG_TAG, "REGEX REPLACEALL:"+result);

        outputstrwr = new PrintWriter(new OutputStreamWriter(socket.getOutputStream()), true);
        outputstrwr.write(outputJSONserv);

        Log.e(LOG_TAG, "Base64 String:"+p.getProfilePicStr());
        Log.e(LOG_TAG, "Sent dataOutputStream");
    } catch (UnknownHostException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    Log.e(LOG_TAG, "Before initEventHandlers");
    initEventHandlers();
    Log.e(LOG_TAG, "After initEventHandlers");
    //refreshViewModels();

    /*Log.e(LOG_TAG, "Start Repeat Thread");
    rt = new Thread(new RepeatingThread());
    //rt = new RepeatingThread();
    rt.start();
    Log.e(LOG_TAG, "Started Repeat Thread");*/

    Log.e(LOG_TAG, "Start Repeat Timer");
    TimerTask task = new RepeatingTask();
    Timer timer = new Timer();
    timer.scheduleAtFixedRate(task, 0, 3000);
    Log.e(LOG_TAG, "Started Repeat Timer");
} 
```

我的定时器任务：

```
public class RepeatingTask extends TimerTask {
     //private int len = 0; 
     //private byte[] input = new byte[len];

     public RepeatingTask() {
            Log.e(LOG_TAG, "In RepeatingTask()");
            Log.e(LOG_TAG, "Before inputJSON String");

            String hello = "hello world";
            //String inputJSON = getStringFromBuffer(new InputStreamReader(socket.getInputStream()));
            try {
                Log.e(LOG_TAG, "Hello String:"+inputStr);
                inputJSON = ConvertByteArrayToString(getBytesFromInputStream(inputStr));
                Log.e(LOG_TAG, "Hello String2:"+inputJSON);
                sendBytes(ConvertStringToByteArray(outputJSONserv), 0, ConvertStringToByteArray(outputJSONserv).length);
                Log.e(LOG_TAG, "Hello String3:"+hello);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            //Convert 
            Log.e(LOG_TAG, "After inputJSON String:" + inputJSON); 

         //LOOK HERE FIRST  
         //inputJSON is what is received back from the server - Take the inputJSON 
         //String and use regular expressions HERE to remove all the other characters in the 
         //string except the payload JSON.
         //refreshViewModels(inputJSON);
     }

     @Override
     public void run() { 
          /*try {
              Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON");
              //outputstrwr.write(outputJSONserv);  //UNCOMMENT IF NEED TO SEND DATA TO GET JSON BACK
              //inputJSON = ConvertByteArrayToString(getBytesFromInputStream(inputStr));
              inputJSON = ConvertByteArrayToString(getFileBytes(inputStr));
          } catch (IOException e) {
              // TODO Auto-generated catch block
              e.printStackTrace();
          }

          Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON2:" + inputJSON);
          refreshViewModels(inputJSON);*/

      try {
          Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON");
          //outputstrwr.write(outputJSONserv);  //UNCOMMENT IF NEED TO SEND DATA TO GET JSON BACK
          //byte[] = myByteArray = readBytes(inputStr);
          sendBytes(ConvertStringToByteArray(outputJSONserv), 0, ConvertStringToByteArray(outputJSONserv).length);
          //sendBytes(myByteArray, 0, myByteArray.length);
          Log.e(LOG_TAG, "AFTER SENDING DATA");
          //inputJSON = ConvertByteArrayToString(getBytesFromInputStream(inputStr));
              inputJSON = ConvertByteArrayToString(getBytesFromInputStream(inputStr));
              Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON2:" + inputJSON);
      } 
      catch (IOException e) {
              // TODO Auto-generated catch block
              e.printStackTrace();
      }

      Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON3:" + inputJSON);
      refreshViewModels(inputJSON);   //UNCOMMENT THIS AFTER I GET IT WORKING
     }
} 
```

refreshViewModels() 方法：

```
 public void refreshViewModels(String inputJSON) {

        try {
            ListView servicesListView = (ListView) this
                    .findViewById(R.id.profilesListView);

            String[] from = new String[] { "profilePic", "neighborName",
                    "tagLine" };
            int[] to = new int[] { R.id.avatar, R.id.username, R.id.email };

            // prepare the list of all records
            List<HashMap<String, Object>> fillMaps = new ArrayList<HashMap<String, Object>>();
            List<Profile> profiles = new ArrayList<Profile>();

            // Clear the position mapping list and reset it
            this.posMap.clear();
            Log.i(LOG_TAG, "NEW inputJSON: " + inputJSON);
            inputJSON = getPayloadStr(inputJSON);
            Log.i(LOG_TAG, "NEW inputJSON2: " + inputJSON);
            JSONArray profileArray = new JSONArray(inputJSON);

            for (int i=0; i<profileArray.length(); i++) { 
                JSONObject jsonObject = profileArray.getJSONObject(i);
                Gson gson = new Gson(); 
                Profile p = gson.fromJson(gson.toJson(jsonObject).toString(), Profile.class);
                profiles.add(p);
            }

            int pos = 0;

            // Creates the fillMaps list for the listAdapter
            Log.i(LOG_TAG, "Profiles size: " + profiles.size());
            //showToast("Profiles size: " + profiles.size());
            for (Profile p : profiles) {
                // Create mapping for list adapter
                HashMap<String, Object> map = new HashMap<String, Object>();
                map.put("profilePic",
                        p.getAttributeValue("photo")== null? "Not Set" : p
                                .getAttributeValue("photo"));
                map.put("neighborName",
                        p.getAttributeValue("Name") == null? "Not Set" : p
                                .getAttributeValue("Name"));
                map.put("tagLine",
                        p.getAttributeValue("TagLine") == null? "Not Set" : p
                                .getAttributeValue("TagLine"));
                fillMaps.add(map);

                // Reset the postion mapping
                this.posMap.put(pos++, p);

            }

            ListAdapter servicesListAdapter = new myAdapter(this, fillMaps,
                    R.layout.listitem, from, to);
            servicesListView.setAdapter(servicesListAdapter);

        } catch (Exception e) {
            Log.e(LOG_TAG, "Error making list adapter: " + e.getMessage());
        }

    } 
```

这是我的转换方法：

```
public String ConvertByteArrayToString(byte[] b) { 
    // byte[] to string
    String input = new String(b);
    return input;
}

public byte[] ConvertStringToByteArray(String str) { 
    // string to byte[]
    byte[] bytes = str.getBytes();
    return bytes;
} 
```

以下是我用来发送和接收 json 字符串的方法：

```
public void sendBytes(byte[] myByteArray, int start, int len) throws IOException {
    if (len < 0)
        throw new IllegalArgumentException("Negative length not allowed");
    if (start < 0 || start >= myByteArray.length)
        throw new IndexOutOfBoundsException("Out of bounds: " + start);
    // Other checks if needed.

    // May be better to save the streams in the support class;
    // just like the socket variable.

    OutputStream out = socket.getOutputStream(); 
    DataOutputStream dos = new DataOutputStream(out);

    dos.writeInt(len);
    if (len > 0) {
        dos.write(myByteArray, start, len);
    }

    //OutputStream out = socket.getOutputStream(); //COMMENTED THIS OUT

    //DataOutputStream dos = new DataOutputStream(out); //COMMENTED THIS OUT

    /*dataOutputStream.writeInt(len);    //COMMENTED THIS OUT
    if (len > 0) {
        dataOutputStream.write(myByteArray, start, len);
    }*/
}

public static byte[] getBytesFromInputStream(InputStream is) throws IOException {
        // Get the size of the file
        int length = is.available();

        if (length > Integer.MAX_VALUE) {
        // File is too large
        }

        // Create the byte array to hold the data
        byte[] bytes = new byte[(int) length];

        // Read in the bytes
        int offset = 0;
        int numRead = 0;
        while (offset < bytes.length
        && (numRead = is.read(bytes, offset, bytes.length - offset)) >= 0) {
        offset += numRead;
        }
        // Ensure all the bytes have been read in
        if (offset < bytes.length) {
        throw new IOException("Could not completely stream ");
        }
        // Close the input stream and return bytes
        is.close();
        return bytes;
} 
```

任何正确方向的帮助或指示将不胜感激。通过聊天提供的任何帮助也将不胜感激。如果需要，可以在聊天会话中发布或查看整个文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:44:51.993

`SocketException: socket is closed`表示*您*关闭了套接字，然后继续使用它。这是您的代码中的错误。您可能正在关闭其中一个流，然后仍在尝试使用另一个：关闭任一流都会关闭另一个流和套接字。

您还滥用了 available()：请参阅 Javadoc。它不执行您使用它的目的，Javadoc 中特别指出这是无效的。

# python - 获取RGB值opencv python

> ID：12187354
> 
> 赞同：15
> 
> 时间：2012-08-29T22:24:46.883
> 
> 标签：python, opencv, computer-vision

我正在将图像加载到 python 中，例如

```
image = cv2.imread("new_image.jpg") 
```

我如何访问 RGB 值`image`？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-29T22:51:56.850

你可以做

```
image[y, x, c] 
```

或等效地`image[y][x][c]`。

它将返回`x,y,c`坐标中像素的值。请注意，索引从 开始`0`。因此，如果您想访问第三个 BGR（注意：不是 RGB）组件，您必须执行所需的行和列的位置和`image[y, x, 2]`列`y`。`x`

此外，您可以通过键入来获取给定对象在 Python 中可用的方法`dir(<variable>)`。例如，加载后`image`，运行`dir(image)`，你会得到一些有用的命令：

```
“cumprod”、“cumsum”、“数据”、“对角线”、“点”、“dtype”、“转储”、“转储”、“填充”、
'flags'，'flat'，'flatten'，'getfield'，'imag'，'item'，'itemset'，'itemsize'，
“最大”、“平均”、“最小”、...

```

用法：`image.mean()`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-07-05T11:19:27.737

**使用opencv在Python中获取像素的BGR颜色值**

```
import cv2
image = cv2.imread("sample.jpg")
color = int(image[300, 300])
# if image type is b g r, then b g r value will be displayed.
# if image is gray then color intensity will be displayed.
print color 
```

**输出：** [73 89 102]

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-05-02T17:29:57.420

此代码将打印像素 300、300 的红色、绿色和蓝色值：

```
img1 = cv2.imread('Image.png', cv2.IMREAD_UNCHANGED)
b,g,r = (img1[300, 300])
print (r)
print (g)
print (b) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-11T08:42:47.317

它对我很有效：

```
import cv2 
import numpy as np  

cap = cv2.imread('/home/PATH/TO/IMAGE/IMG_0835.jpg')
#You're free to do a resize or not, just for the example
cap = cv2.resize(cap, (340,480))
for x in range (0,340,1):
    for y in range(0,480,1):
        color = cap[y,x]
        print color` 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-08T17:13:55.950

我认为获取图像 RGB 的最简单方法是使用`cv2.imshow("windowName",image)`. 图像会以窗口形式显示，小信息栏还会在图像下方显示坐标（x，y）和RGB。喜欢[这张照片](https://i.imgur.com/NzCxyrY.png)。您可以使用鼠标查看您想要的任何像素的 RGB。

代码示例：

```
import cv2

image = cv2.imread("new_image.jpg")
try:
    cv2.imshow("windowName",image)
    cv2.waitKey(0)
except:
    print("No this image") 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2019-09-05T10:57:08.940

您可以使用 numpy 更好地将图像转换为 numpy 数组并转置矩阵 [RGB] 将是 [BGR] 反之亦然

# kineticjs - KineticJS鼠标悬停不起作用

> ID：12187355
> 
> 赞同：0
> 
> 时间：2012-08-29T22:24:56.267
> 
> 标签：kineticjs

我已经尽一切努力让这个工作以硬编码数字结束，但是当我将鼠标悬停在舞台上时，什么也没有发生。鼠标悬停（或鼠标移动）仅在我实际位于图像本身上方时才会激活。谁能告诉我当我将鼠标移到舞台上时如何使图像向左或向右移动？

`stage.on('mouseover', function(){ var mousePos = stage.getUserPosition(); if (mousePos.x >= 289) { rect.move(5, 0); } else { rect.move(-5,0); } stage.add(layer); });`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T10:41:59.173

当我们在图像之前添加 Rectangle(Transparent) 时，KineticJS Moverover 工作。请参阅下面的代码，它的工作。

```
<!DOCTYPE HTML>
<html>  
  <head>    
    <style>      
      body {
        margin: 0px;
        padding: 0px;
      }
      canvas {
        border: 1px solid #9C9898;
      }
    </style>
    <script src="http://www.html5canvastutorials.com/libraries/kinetic-v4.0.0.js"></script>
    <script>
      window.onload = function() {
        var stage = new Kinetic.Stage({
          container: "container",
          width: 578,
          height: 200
        });
        var layer = new Kinetic.Layer();
        var imageObj = new Image();
        imageObj.onload = function() {
          var yoda = new Kinetic.Image({
            x: 140,
            y: stage.getHeight() / 2 - 59,
            image: imageObj,
            width: 106,
            height: 118
          });         
          var rect = new Kinetic.Rect({
              x: 0,
              y: 0,
              width: stage.getWidth(),
              height: stage.getHeight()
          });

          layer.add(rect);
          layer.add(yoda);
          stage.add(layer);

          stage.on('mousemove', function(){ 
            var mousePos = stage.getUserPosition(); 
            if (mousePos.x >= 289) 
            { 
              yoda.move(5, 0);
            } 
            else 
            { 
              yoda.move(-5, 0);
            } 
            layer.draw();
          });
        };
        imageObj.src = "http://www.html5canvastutorials.com/demos/assets/yoda.jpg";
      };
    </script>
  </head>
  <body>
    <div id="container"></div>
  </body>
</html> 
```

# hibernate - 在休眠本机查询或 HQL 中哪个性能更好

> ID：12187358
> 
> 赞同：16
> 
> 时间：2012-08-29T22:25:11.640
> 
> 标签：hibernate

在服务器端代码中，通常为了更好的性能，我们不应该使用“select * from table”，而是应该根据需要查询必要的列（选择名称，从员工添加）。这是我在数据库性能指南文章中读到的。

现在我对休眠有疑问，我读到最好在休眠中使用 session.load(id) 来根据主键检索记录。这将检索与给定“id”（表中的记录）的实体关联的所有列。

现在是不是与一般数据库性能指南相矛盾。hibernate native sql 查询和hibernate 查询语言哪个性能更好？

让我知道您的宝贵意见，因为我正在尝试调整我的代码以获得更好的性能。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-08-30T09:11:18.853

你搞砸了一些部分。您也可以仅使用 HQL 选择某些列，例如您可以`select column from table`在 HQL 中使用。

原生 SQL 不一定比 HQL 快。HQL 最后也被翻译成 SQL（你可以在运行应用程序时看到生成的语句，`show_sql`属性设置为 true）。在某些情况下，Hibernate 可能不会生成最有效的语句，因此原生 SQL 可以更快 - 但是使用原生 SQL，您的应用程序会失去从一个数据库到另一个数据库的可移植性，因此通常最好调整 hibernate 映射和 HQL语句以生成更高效的 SQL 语句。在本机 SQL 的另一方面，您缺少 Hibernate 缓存 - 因此在某些情况下本机 SQL 可能比 HQL 慢。

当您使用`session.load(class, id)`并且该行尚未在缓存中时，负载也会生成一个`select * from classTable`，因此速度与 HQL 相同`from`。（但是当对象已经在缓存中时，可能`load`会更快。）

我不同意您的性能指南：在大多数情况下，如果您加载所有列或仅加载所需的列，则与性能无关。在数据库访问中，搜索行时会丢失时间，而**不是**将数据传输到应用程序中时。当您只阅读必要的列时，它具有以下缺点：

*   当您需要尚未加载的列时，更改应用程序会比较麻烦（或者您必须再次加载该行，这意味着性能不佳）。
*   它给您的应用程序带来了糟糕的设计（Hibernate 更喜欢一张表 - 一类）
*   它不适用于 Hibernate 缓存。

（想一想，如果您的应用程序中存在您永远不需要的列，或者在您的应用程序完成后将添加的列，那么您只是不要将它们放入您的类和映射中，它们永远不会被加载，而且您的应用程序设计仍然很好。Hibernate 不生成`select * from table`语句，它总是生成`select col1, col2, ... from table`。）

有一个例外：如果您加载大量数据（数千行），那么仅加载必要的列会明显更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-06-26T07:10:30.547

实体查询（例如 JPQL、HQL、Criteria API）再次被渲染回 SQL 查询，因此很明显，运行原生 SQL 查询将比运行实体查询更快。

但是，如果您正确设置查询计划缓存大小，那么您可以加快实体查询的速度，使其运行速度与 SQL 查询一样快。

但是，如果您想从脏检查机制中受益并从修改后的实体中自动发出 UPDATE，那么实体查询要方便得多。只要实体查询和 SQL 查询之间的时间差异很小（这通常是如果您使用数据库索引并且实体查询呈现非常高效的 SQL 查询），就没有什么可担心的。

# xml - XSLT：我需要用顺序解析具有相同元素名称的 xml，以映射到另一个具有不同名称的 xml

> ID：12187361
> 
> 赞同：0
> 
> 时间：2012-08-29T22:25:19.587
> 
> 标签：xml, parsing, xslt

由于下面的源 XML 值/字符串元素值必须替换为目标元素值，请有人帮助我如何创建 XSL 以将源 xml 转换为目标 xml。请。源 XML：

```
<PricingResultsV6>     
 <subItems>
 <SubItem>   
<profiles>
<ProfileValues>
<values> 
 <strings>800210</strings> 
 <strings>THC</strings> 
 <strings>10.0</strings> 
 <strings>20.0</strings> 
 <strings>30.0</strings> 
 <strings>40.0</strings> 
 <strings>550.0</strings> 
 <strings>640.0</strings> 
 </values>
</ProfileValues>
</rofiles>
</SubItem>
</subItems>
</PricingResultsV6> 
```

目标 XML：

```
<CalculationOutput>
            <PolicyNumber> 800210 </PolicyNumber>
            <CommissionFactorMultiplier> THC </CommissionFactorMultiplier>
            <PremiumValue>10.0</PremiumValue>
            <SalesmanCommissionValue>20.0</SalesmanCommissionValue>
            <ManagerCommissionValue>30.0</ManagerCommissionValue>
            <GL_COR> 550.0</GL_COR>
            <GL_OPO>640.0</GL_OPO>

</CalculationOutput> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:06:30.650

你可以做一些基本的事情......

**XML 输入**（格式正确）

```
<PricingResultsV6>
    <subItems>
        <SubItem>
            <profiles>
                <ProfileValues>
                    <values>
                        <strings>800210</strings>
                        <strings>THC</strings>
                        <strings>10.0</strings>
                        <strings>20.0</strings>
                        <strings>30.0</strings>
                        <strings>40.0</strings>
                        <strings>550.0</strings>
                        <strings>640.0</strings>
                    </values>
                </ProfileValues>
            </profiles>
        </SubItem>
    </subItems>
</PricingResultsV6> 
```

**XSLT 1.0**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="/PricingResultsV6/subItems/SubItem/profiles/ProfileValues/values">
        <CalculationOutput>
            <PolicyNumber><xsl:value-of select="strings[1]"/></PolicyNumber>
            <CommissionFactorMultiplier><xsl:value-of select="strings[2]"/></CommissionFactorMultiplier>
            <PremiumValue><xsl:value-of select="strings[3]"/></PremiumValue>
            <SalesmanCommissionValue><xsl:value-of select="strings[4]"/></SalesmanCommissionValue>
            <ManagerCommissionValue><xsl:value-of select="strings[5]"/></ManagerCommissionValue>
            <GL_COR><xsl:value-of select="strings[7]"/></GL_COR>
            <GL_OPO><xsl:value-of select="strings[8]"/></GL_OPO>            
        </CalculationOutput>
    </xsl:template>

</xsl:stylesheet> 
```

**XML 输出**

```
<CalculationOutput>
   <PolicyNumber>800210</PolicyNumber>
   <CommissionFactorMultiplier>THC</CommissionFactorMultiplier>
   <PremiumValue>10.0</PremiumValue>
   <SalesmanCommissionValue>20.0</SalesmanCommissionValue>
   <ManagerCommissionValue>30.0</ManagerCommissionValue>
   <GL_COR>550.0</GL_COR>
   <GL_OPO>640.0</GL_OPO>
</CalculationOutput> 
```

* * *

实际映射选项。所有这些都产生与上述相同的输出......

**XSLT 1.0**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
    xmlns:loc="local" exclude-result-prefixes="loc">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <loc:map>
        <entry pos="1">PolicyNumber</entry>
        <entry pos="2">CommissionFactorMultiplier</entry>
        <entry pos="3">PremiumValue</entry>
        <entry pos="4">SalesmanCommissionValue</entry>
        <entry pos="5">ManagerCommissionValue</entry>
        <entry pos="7">GL_COR</entry>
        <entry pos="8">GL_OPO</entry>
    </loc:map>

    <xsl:template match="ProfileValues">
        <CalculationOutput>
            <xsl:apply-templates select="values/strings"/>
        </CalculationOutput>
    </xsl:template>

    <xsl:template match="strings[position()=document('')/*/loc:map/entry/@pos]">
        <xsl:variable name="vPos" select="position()"/>
        <xsl:element name="{document('')/*/loc:map/entry[@pos=$vPos]}">
            <xsl:value-of select="."/>
        </xsl:element>
    </xsl:template>

    <xsl:template match="text()"/>

</xsl:stylesheet> 
```

**XSLT 2.0**

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:variable name="vMap">
        <entry pos="1">PolicyNumber</entry>
        <entry pos="2">CommissionFactorMultiplier</entry>
        <entry pos="3">PremiumValue</entry>
        <entry pos="4">SalesmanCommissionValue</entry>
        <entry pos="5">ManagerCommissionValue</entry>
        <entry pos="7">GL_COR</entry>
        <entry pos="8">GL_OPO</entry>       
    </xsl:variable>

    <xsl:template match="ProfileValues">
        <CalculationOutput>
            <xsl:apply-templates select="values/strings"/>
        </CalculationOutput>
    </xsl:template>

    <xsl:template match="strings[position()=$vMap/entry/@pos]">
        <xsl:variable name="vPos" select="position()"/>
        <xsl:element name="{$vMap/entry[@pos=$vPos]}">
            <xsl:value-of select="."/>
        </xsl:element>
    </xsl:template>

    <xsl:template match="text()"/>

</xsl:stylesheet> 
```

**XSLT 3.0**（使用 Saxon-EE 9.4 测试）

```
<xsl:stylesheet version="3.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
    exclude-result-prefixes="map">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:variable name="vMap" select="map {
        1:='PolicyNumber',
        2:='CommissionFactorMultiplier',
        3:='PremiumValue',
        4:='SalesmanCommissionValue',
        5:='ManagerCommissionValue',
        7:='GL_COR',
        8:='GL_OPO',
        }"/>

    <xsl:template match="ProfileValues">
        <CalculationOutput>
            <xsl:apply-templates select="values/strings"/>
        </CalculationOutput>
    </xsl:template>

    <xsl:template match="strings[map:contains($vMap,position())]">      
        <xsl:element name="{map:get($vMap,position())}">
            <xsl:value-of select="."/>
        </xsl:element>
    </xsl:template>

    <xsl:template match="text()"/>

</xsl:stylesheet> 
```

# ruby-on-rails - 寻找像 RailsAdmin 这样的东西，但重量更轻，并且与主应用程序不在同一个进程中

> ID：12187364
> 
> 赞同：3
> 
> 时间：2012-08-29T22:25:40.130
> 
> 标签：ruby-on-rails, rails-admin

我们已经在一个项目中使用 rails_admin 一年了。这很好，但最好有一个管理界面，该界面与 Rails 主应用程序和完全独立的代码库在完全独立的进程中运行。rails_admin 有如此多的依赖项，以至于将其与主要的 Rails 应用程序一起升级已被证明是脆弱的。

所以我们需要的功能只是数据库表的基本功能，加上一点点魔法让编辑关联变得更容易。

有什么轻量级的解决方案吗？轻量级和基于 Sinatra 而不是基于 Rails 的加分项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T11:30:35.067

我会研究[git submodules](http://missingreadme.wordpress.com/2010/11/06/how-to-update-submodules-in-git/)或[subversion externals](http://svnbook.red-bean.com/en/1.7/svn-book.html#svn.advanced.externals)。我做类似的事情的方式是

1.  列表项将模型迁移到独立的 ruby​​ 项目中。
2.  将它们放在“核心”子目录/模块中。
3.  创建一个新的 Rails 项目仅用于管理。
4.  使用 'core' 目录的外部 svn 在每个项目的 app/models 目录中共享 2 个 rails 应用程序之间的模型。

# sql - 如何使用 Zend 框架编写子查询重构 WITH 子句？

> ID：12187366
> 
> 赞同：5
> 
> 时间：2012-08-29T22:26:03.777
> 
> 标签：sql, oracle, zend-framework, zend-db, zend-db-select

我想`WITH`在 Zend 框架中使用 SQL 查询中的语法，SQL 看起来像这样：

```
WITH t AS
(SELECT item_id, row_number() OVER (ORDER BY some_criteria DESC) rn
   FROM orders)
SELECT t2.rn, t2.item_id
  FROM t t1 JOIN t t2 ON (t2.rn > t1.rn)
 WHERE t1.item_id = 145; 
```

我如何在 Zend Framework 中这样做？与`Zend_Db_Select`？有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T07:05:12.973

使用 Zend_Db_Select 你不能以漂亮的方式做到这一点，所以我建议你使用简单的查询：

```
$q = "WITH t ..."
$db->fetchAll($q); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T21:51:38.483

我引用-

> 使用**Zend_Db_Select**不是强制性的。**对于非常简单的 SELECT 查询，将整个 SQL 查询指定为字符串并使用诸如query()**或**fetchAll()**之类的适配器方法执行它通常更简单。如果您需要以程序方式或基于应用程序中的条件逻辑来组装 SELECT 查询，则使用 Zend_Db_Select 会很有帮助。

所以你可以试试这个

```
$wthselect = 'WITH t AS
          (SELECT item_id, row_number() OVER (ORDER BY some_criteria DESC) rn
              FROM orders)
         SELECT t2.rn, t2.item_id
           FROM t t1 JOIN t t2 ON (t2.rn > t1.rn)
           WHERE t1.item_id = 145';

$stmt = $select->query($wthselect);
$result = $stmt->fetchAll(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T08:23:03.623

`Zend_Db_Select`如果查询有点复杂，应用程序中包含参数和逻辑，这很有用，正如另一个答案中已经引用的那样。查看[官方 Zend Framework](http://framework.zend.com/manual/1.12/en/zend.db.select.html)上的此链接以获取此指令的详细说明。

还可以查看Zend Framework 社区的[这个有用链接](http://zend-framework-community.634137.n4.nabble.com/too-bad-there-s-no-select-gt-fromString-SQL-td3466006.html)，特别是[这篇文章](http://zend-framework-community.634137.n4.nabble.com/too-bad-there-s-no-select-fromString-SQL-tp3466006p3466211.html)。它清楚地表明，对于您发布的小型且不复杂的查询，使用`fetchAll()`or`query()`指令更简单。

所以，我的建议是，使用`fetchAll()`or`query()`来处理你的情况。

# java - Eclipse永远挂起，线程转储说主线程正在休眠

> ID：12187369
> 
> 赞同：5
> 
> 时间：2012-08-29T22:26:14.547
> 
> 标签：java, eclipse

我在 Solaris 11 X86 中运行 Eclipse 3.7.2。它随机挂起（每隔几个小时或每隔几分钟）。当它挂起时，我做了一个线程转储，它表明`Main`线程处于定时等待状态。Eclipse 永远不会从睡眠状态中醒来并且变得无响应，我必须重新启动 Eclipse 才能再次使用它。

主线程正在休眠，因为：

```
org.eclipse.swt.widgets.Control.dragDetect 
```

是否有任何已知的解决此问题的方法？

编辑：

操作系统

```
SunOS solaris 5.11 11.0 i86pc i386 i86pc Solaris 
```

完整的堆栈跟踪：

```
"main" prio=3 tid=0x080e8400 nid=0x1 waiting on condition [0x08045000]
   java.lang.Thread.State: TIMED_WAITING (sleeping)
    at java.lang.Thread.sleep(Native Method)
    at org.eclipse.swt.widgets.Control.dragDetect(Control.java:2204)
    at org.eclipse.swt.widgets.Tree.dragDetect(Tree.java:1125)
    at org.eclipse.swt.widgets.Control.gtk_button_press_event(Control.java:2791)
    at org.eclipse.swt.widgets.Control.gtk_button_press_event(Control.java:2759)
    at org.eclipse.swt.widgets.Composite.gtk_button_press_event(Composite.java:681)
    at org.eclipse.swt.widgets.Tree.gtk_button_press_event(Tree.java:1871)
    at org.eclipse.swt.widgets.Widget.windowProc(Widget.java:1731)
    at org.eclipse.swt.widgets.Control.windowProc(Control.java:5016)
    at org.eclipse.swt.widgets.Tree.windowProc(Tree.java:3530)
    at org.eclipse.swt.widgets.Display.windowProc(Display.java:4408)
    at org.eclipse.swt.internal.gtk.OS._gtk_main_do_event(Native Method)
    at org.eclipse.swt.internal.gtk.OS.gtk_main_do_event(OS.java:8422)
    at org.eclipse.swt.widgets.Display.eventProc(Display.java:1245)
    at org.eclipse.swt.internal.gtk.OS._g_main_context_iteration(Native Method)
    at org.eclipse.swt.internal.gtk.OS.g_main_context_iteration(OS.java:2276)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3207)
    at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2701)
    at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2665)
    at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2499)
    at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:679)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:668)
    at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
    at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:123)
    at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:622)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:577)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1410)

   Locked ownable synchronizers:
    - None

"VM Thread" prio=3 tid=0x08209c00 nid=0x2 runnable 

"VM Periodic Task Thread" prio=3 tid=0x0825d000 nid=0x8 waiting on condition 

JNI global references: 713 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T07:48:45.330

您的系统时钟是否有可能在跳动？

Eclipse 的事件循环用于`System.currentTimeMillis()`跟踪时间，并且`currentTimeMillis`不能保证是单调的（不像`System.nanoTime()`本来那样。）

```
long timeout = System.currentTimeMillis() + 500;
while (System.currentTimeMillis() < timeout) {
    eventPtr = OS.gdk_event_get ();
    if (eventPtr != 0) {
        break;
    } else {
        try {Thread.sleep(50);} catch (Exception ex) {}
    }
} 
```

如果是这样，作为您在“ [Is there a way to interrupt a sleep thread in a running JVM, without access to the application's code?](https://stackoverflow.com/questions/12224077) ”中请求的解决方法，您可以轻松地使用 JBoss Byteman 创建一个规则集，该规则集从一定数量的睡眠后的睡眠循环。

Foo.java：

```
public class Foo {

    public void test1() {
        long timeout = System.currentTimeMillis() + 500;
        int i = 0;
        while (System.currentTimeMillis() < timeout) {
            System.out.println(i++);
            try {Thread.sleep(50);} catch (Exception ex) {}
        }
    }

    public static void main(final String ... args) throws Exception {
        new Foo().test1();
    }

} 
```

卧铺.btm:

```
RULE counter
CLASS Foo
METHOD test1
AT ENTRY
IF TRUE
DO createCountDown($0, 5)
ENDRULE

RULE sleeper
CLASS Foo
METHOD test1
AT INVOKE Thread.sleep()
IF countDown($0)
DO RETURN
ENDRULE 
```

使用 Byteman 脚本运行：

```
$ ~/Downloads/byteman-download-2.1.0/bin/bmjava.sh -l ./sleeper.btm Foo
0
1
2
3
4
5 
```

正常运行：

```
$ java Foo 
0
1
2
3
4
5
6
7
8
9 
```

# cocoa - NSScrollview 内的 NSView 不会改变大小

> ID：12187375
> 
> 赞同：1
> 
> 时间：2012-08-29T22:27:17.593
> 
> 标签：cocoa, nsview, nsscrollview

我在 Interface Builder 中制作了一个 NSWindow。这个窗口里面是一个 NSScrollView，里面是一个自定义的 NSView。

NSScrollview 填充 NSWindow，自定义 NSView 填充 NSScrollview。

当自定义 NSView 发送 awakeFromNib 方法时，它的边界是 0,0 和 256x373，正如我所期望的那样，填充滚动视图。

但是后来我将 NSView 的大小更改为大于 373high 但它永远不会更改滚动视图中的大小。我试过设置框架，我试过设置界限，但没有任何改变。

除了，当我尝试更改自定义 NSView 的intrinsicSize 时，它​​确实发生了变化，但是它使 NSWindow 和 NSScrollview 的大小也发生了变化，以适应新的 256x1452 大小

谁能告诉我哪里可能出错了？这与在 Scrollview 或 NSView 上设置的约束有关吗？我没有设置，但是当我在 Interface Builder 中添加项目时，它们会自动为我添加

[编辑]

我已经对其进行了更改，以便以编程方式创建自定义 NSView 并使用 setDocumentView 添加到 NSScrollView：并且一切都按我的预期工作。所以我想从技术上讲我已经解决了这个问题，但如果有人知道，我仍然想解释为什么它不能通过 Interface Builder 工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-03T01:43:53.787

我有一个部分解决方案，这也让我提出了一个额外的问题。我有一个类似的问题，我需要以编程方式更改嵌入在 NSScrollView 中的视图的大小。

此代码有效，需要两种方法

```
-(void)markViewSizeChanged /* Works correctly */
{
    [self setFrameSize:currentViewSize];
    [self setBoundsSize:currentViewSize];
    [self setNeedsDisplay:YES];
}

-(NSSize)intrinsicContentSize // Override of class method
{
    return currentViewSize;
} 
```

注意：必须在 awakeFromNib 中设置 currentViewSize

现在是好奇的部分。如果我颠倒设置框架和边界的两个调用的顺序，嵌入视图的大小是正确的，但绘制的对象的缩放因子是关闭的。

```
-(void)markViewSizeChanged /* DOES NOT work correctly, scaling in drawing off */
{
    [self setBoundsSize:currentViewSize];
    [self setFrameSize:currentViewSize];
    [self setNeedsDisplay:YES];
} 
```

# webmatrix-2 - webmatrix 2：如何为 asp.net 表单页面获取智能感知

> ID：12187380
> 
> 赞同：1
> 
> 时间：2012-08-29T22:28:10.657
> 
> 标签：webmatrix-2

将此作为请求发布在[WebMatrix uservoice 上](http://webmatrix.uservoice.com/forums/128313-webmatrix-suggestions/suggestions/3117532-support-intellisense-for-asp-net-forms)，但也许我忽略了一些东西。是否可以让智能感知在 ASP.NET 表单页面上工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:21:59.903

WebMatrix 不支持用于 Web 表单（.aspx 页面）的深度 c# intellisense，您将获得基本的 html intellisense 和基本的 c# intellisense（基本上是一些默认的参考程序集，仅此而已）。

WebMatrix 旨在对这些类型的文件进行轻度编辑，适用于您想要快速修复明显错误/更改一些文本/添加一些标签的情况，但仅此而已。您确实希望将 Visual Studio Web Developer 用于这些类型的场景。

# c - C：变量突然改变（为什么会这样？）

> ID：12187382
> 
> 赞同：1
> 
> 时间：2012-08-29T22:28:26.210
> 
> 标签：c, variable-assignment

当我在玩一些在线站点提供的代码时，我遇到了一个我从未预料到的奇怪故障：一个变量在没有任何手动赋值的情况下突然改变了它的值。

这是下面的代码：

```
int rc = fwrite(conn->db, sizeof(struct Database), 1, conn->file);
printf("rc is equal to %d\n", rc); // should print out 1
if (rc != 1) die("Failed to write Database.");

rc = fflush(conn->file);
printf("rc is equal to %d\n", rc); // should print out 0
if (rc == -1); die("Cannot flush database"); // error handling
// error comes up because rc suddenly changes to -1 
```

我不明白它是如何发生的，但想知道为什么一个变量在 C 中不应该发生变化时突然发生变化。

代码来源： [http](http://c.learncodethehardway.org/book/learn-c-the-hard-waych18.html) ://c.learncodethehardway.org/book/learn-c-the-hard-waych18.html （Database_write下的堆栈和内存）

顺便说一句，我在 Mac osx 10.6 雪豹上的终端中使用 vim。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-29T22:31:00.683

它不会更改为 -1。它仍然为零。您的代码中有一个分号 (;)，您不应该在其中使用它。您应该改为：

```
if (rc == -1) die("Cannot flush database"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T22:31:28.023

的值`rc`没有改变，而是您的`if`陈述有问题：

```
if (rc == -1); die("Cannot flush database");
             ^ 
```

第二`if`条语句没有与之关联的操作。除非`;`被删除，否则`die()`无论 的值如何，都将始终执行`rc`。即，改用这个：

```
if (rc == -1) die("Cannot flush database");
             ^ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T22:32:42.523

你有一个小错误

```
 if (rc == -1);
              ^
              ^ 
```

这样 die 语句总是被执行。条件的值被检查并且从未使用过

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T22:47:24.307

这是错误：

```
if (rc == -1); die("Cannot flush database"); // error handling 
```

因为你`;`之后的`if`，`die`是超出了你的范围的`if`。如果您不编写结构化代码，这种错误是非常可能和频繁的。这应该是：

```
if (rc == -1)
{
    die("Cannot flush database"); // error handling
} 
```

如果你有一个`;`之后`if`，你会立即看到。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T23:01:27.087

如前所述，分号是您的问题。

你在这里所做的，虽然不是你想要的，是完全合法的——它被称为空语句。这被写成一个分号，没有别的。if 语句，如果为真，实际上是在继续执行一个语句——只是一个空语句。

# ruby-on-rails - Heroku 路线不起作用

> ID：12187383
> 
> 赞同：0
> 
> 时间：2012-08-29T22:28:53.677
> 
> 标签：ruby-on-rails, heroku, routes

所以我的主要导轨模型是“公司”。当我在本地托管我的应用程序并导航到 localhost:3000/companies 时，一切正常。但是当我导航到我的应用程序的 heroku 版本时：

[http://calm-journey-2877.herokuapp.com/companies](http://calm-journey-2877.herokuapp.com/companies)

.. 我收到错误“我们很抱歉，但出了点问题”

这表明该页面存在但正在产生某种错误。知道会发生什么吗？这是我通过阅读 Rails 教程书构建的一个非常基本的应用程序。

谢谢！！

编辑：

这是 Heroku 日志。

```
2012-08-29T22:20:54+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:38:in `receive_data'
2012-08-29T22:20:54+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/backends/base.rb:63:in `start'
2012-08-29T22:20:54+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'
2012-08-29T22:20:54+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/server.rb:159:in `start'
2012-08-29T22:20:54+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'
2012-08-29T22:20:54+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:185:in `run_command'
2012-08-29T22:20:54+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/controllers/controller.rb:86:in `start'
2012-08-29T22:20:54+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:151:in `run!'
2012-08-29T22:20:54+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `load'
2012-08-29T22:20:54+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `<main>'
2012-08-29T22:20:54+00:00 app[web.1]: 
2012-08-29T22:20:54+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/bin/thin:6:in `<top (required)>'
2012-08-29T22:20:54+00:00 app[web.1]: 
2012-08-29T22:20:54+00:00 heroku[router]: GET calm-journey-2877.herokuapp.com/clients dyno=web.1 queue=0 wait=0ms service=7ms status=404 bytes=728
2012-08-29T22:21:00+00:00 app[web.1]: 
2012-08-29T22:21:00+00:00 app[web.1]: 
2012-08-29T22:21:00+00:00 app[web.1]: Started GET "/companies" for 24.14.103.65 at 2012-08-29 22:21:00 +0000
2012-08-29T22:21:00+00:00 app[web.1]: Processing by CompaniesController#index as HTML
2012-08-29T22:21:00+00:00 app[web.1]: Completed 500 Internal Server Error in 7ms
2012-08-29T22:21:00+00:00 app[web.1]: 
2012-08-29T22:21:00+00:00 app[web.1]: ActiveRecord::StatementInvalid (PG::Error: ERROR:  relation "companies" does not exist
2012-08-29T22:21:00+00:00 app[web.1]: LINE 4:              WHERE a.attrelid = '"companies"'::regclass
2012-08-29T22:21:00+00:00 app[web.1]:                                         ^
2012-08-29T22:21:00+00:00 app[web.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod), d.adsrc, a.attnotnull
2012-08-29T22:21:00+00:00 app[web.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d
2012-08-29T22:21:00+00:00 app[web.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum
2012-08-29T22:21:00+00:00 app[web.1]:              WHERE a.attrelid = '"companies"'::regclass
2012-08-29T22:21:00+00:00 app[web.1]:                AND a.attnum > 0 AND NOT a.attisdropped
2012-08-29T22:21:00+00:00 app[web.1]:              ORDER BY a.attnum
2012-08-29T22:21:00+00:00 app[web.1]: ):
2012-08-29T22:21:00+00:00 app[web.1]:   app/controllers/companies_controller.rb:86:in `sort_column'
2012-08-29T22:21:00+00:00 app[web.1]:   app/controllers/companies_controller.rb:6:in `index'
2012-08-29T22:21:00+00:00 app[web.1]: 
2012-08-29T22:21:00+00:00 app[web.1]: 
2012-08-29T22:21:00+00:00 heroku[router]: GET calm-journey-2877.herokuapp.com/companies dyno=web.1 queue=0 wait=0ms service=13ms status=500 bytes=643
2012-08-29T22:21:00+00:00 heroku[router]: GET calm-journey-2877.herokuapp.com/favicon.ico dyno=web.1 queue=0 wait=0ms service=3ms status=304 bytes=0
2012-08-29T22:27:31+00:00 app[web.1]: 
2012-08-29T22:27:31+00:00 app[web.1]: 
2012-08-29T22:27:31+00:00 app[web.1]: Started GET "/companies" for 24.14.103.65 at 2012-08-29 22:27:31 +0000
2012-08-29T22:27:31+00:00 app[web.1]: Processing by CompaniesController#index as HTML
2012-08-29T22:27:31+00:00 app[web.1]: Completed 500 Internal Server Error in 14ms
2012-08-29T22:27:31+00:00 app[web.1]: 
2012-08-29T22:27:31+00:00 app[web.1]: LINE 4:              WHERE a.attrelid = '"companies"'::regclass
2012-08-29T22:27:31+00:00 app[web.1]: ActiveRecord::StatementInvalid (PG::Error: ERROR:  relation "companies" does not exist
2012-08-29T22:27:31+00:00 app[web.1]:                                         ^
2012-08-29T22:27:31+00:00 app[web.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod), d.adsrc, a.attnotnull
2012-08-29T22:27:31+00:00 app[web.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d
2012-08-29T22:27:31+00:00 app[web.1]:              WHERE a.attrelid = '"companies"'::regclass
2012-08-29T22:27:31+00:00 app[web.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum
2012-08-29T22:27:31+00:00 app[web.1]:                AND a.attnum > 0 AND NOT a.attisdropped
2012-08-29T22:27:31+00:00 app[web.1]:              ORDER BY a.attnum
2012-08-29T22:27:31+00:00 app[web.1]: ):
2012-08-29T22:27:31+00:00 app[web.1]:   app/controllers/companies_controller.rb:86:in `sort_column'
2012-08-29T22:27:31+00:00 app[web.1]:   app/controllers/companies_controller.rb:6:in `index'
2012-08-29T22:27:31+00:00 app[web.1]: 
2012-08-29T22:27:31+00:00 app[web.1]: 
2012-08-29T22:27:31+00:00 heroku[router]: GET calm-journey-2877.herokuapp.com/companies dyno=web.1 queue=0 wait=0ms service=42ms status=500 bytes=643
2012-08-29T22:27:31+00:00 heroku[router]: GET calm-journey-2877.herokuapp.com/favicon.ico dyno=web.1 queue=0 wait=0ms service=3ms status=304 bytes=0
2012-08-29T22:29:13+00:00 app[web.1]: 
2012-08-29T22:29:13+00:00 app[web.1]: 
2012-08-29T22:29:13+00:00 app[web.1]: Started GET "/companies" for 24.14.103.65 at 2012-08-29 22:29:13 +0000
2012-08-29T22:29:13+00:00 app[web.1]: Processing by CompaniesController#index as HTML
2012-08-29T22:29:13+00:00 app[web.1]: Completed 500 Internal Server Error in 3ms
2012-08-29T22:29:13+00:00 app[web.1]: 
2012-08-29T22:29:13+00:00 app[web.1]: LINE 4:              WHERE a.attrelid = '"companies"'::regclass
2012-08-29T22:29:13+00:00 app[web.1]: ActiveRecord::StatementInvalid (PG::Error: ERROR:  relation "companies" does not exist
2012-08-29T22:29:13+00:00 app[web.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod), d.adsrc, a.attnotnull
2012-08-29T22:29:13+00:00 app[web.1]:                                         ^
2012-08-29T22:29:13+00:00 app[web.1]:              WHERE a.attrelid = '"companies"'::regclass
2012-08-29T22:29:13+00:00 app[web.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d
2012-08-29T22:29:13+00:00 app[web.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum
2012-08-29T22:29:13+00:00 app[web.1]:                AND a.attnum > 0 AND NOT a.attisdropped
2012-08-29T22:29:13+00:00 app[web.1]:              ORDER BY a.attnum
2012-08-29T22:29:13+00:00 app[web.1]: ):
2012-08-29T22:29:13+00:00 app[web.1]:   app/controllers/companies_controller.rb:6:in `index'
2012-08-29T22:29:13+00:00 app[web.1]:   app/controllers/companies_controller.rb:86:in `sort_column'
2012-08-29T22:29:13+00:00 app[web.1]: 
2012-08-29T22:29:13+00:00 app[web.1]: 
2012-08-29T22:29:13+00:00 heroku[router]: GET calm-journey-2877.herokuapp.com/companies dyno=web.1 queue=0 wait=0ms service=10ms status=500 bytes=643
2012-08-29T22:33:52+00:00 app[web.1]: 
2012-08-29T22:33:52+00:00 app[web.1]: 
2012-08-29T22:33:52+00:00 app[web.1]: Started GET "/companies" for 186.147.240.150 at 2012-08-29 22:33:52 +0000
2012-08-29T22:33:52+00:00 app[web.1]: Processing by CompaniesController#index as HTML
2012-08-29T22:33:52+00:00 app[web.1]: Completed 500 Internal Server Error in 3ms
2012-08-29T22:33:52+00:00 app[web.1]: 
2012-08-29T22:33:52+00:00 app[web.1]: ActiveRecord::StatementInvalid (PG::Error: ERROR:  relation "companies" does not exist
2012-08-29T22:33:52+00:00 app[web.1]: LINE 4:              WHERE a.attrelid = '"companies"'::regclass
2012-08-29T22:33:52+00:00 app[web.1]:                                         ^
2012-08-29T22:33:52+00:00 app[web.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d
2012-08-29T22:33:52+00:00 app[web.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod), d.adsrc, a.attnotnull
2012-08-29T22:33:52+00:00 app[web.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum
2012-08-29T22:33:52+00:00 app[web.1]:              WHERE a.attrelid = '"companies"'::regclass
2012-08-29T22:33:52+00:00 app[web.1]: 
2012-08-29T22:33:52+00:00 app[web.1]:              ORDER BY a.attnum
2012-08-29T22:33:52+00:00 app[web.1]:   app/controllers/companies_controller.rb:86:in `sort_column'
2012-08-29T22:33:52+00:00 app[web.1]:                AND a.attnum > 0 AND NOT a.attisdropped
2012-08-29T22:33:52+00:00 app[web.1]: ):
2012-08-29T22:33:52+00:00 app[web.1]:   app/controllers/companies_controller.rb:6:in `index'
2012-08-29T22:33:52+00:00 app[web.1]: 
2012-08-29T22:33:52+00:00 heroku[router]: GET calm-journey-2877.herokuapp.com/companies dyno=web.1 queue=0 wait=0ms service=10ms status=500 bytes=643
2012-08-29T22:33:52+00:00 heroku[router]: GET calm-journey-2877.herokuapp.com/favicon.ico dyno=web.1 queue=0 wait=0ms service=4ms status=200 bytes=0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:34:43.383

您是否在 Heroku 中迁移了数据库`heroku run rake db:migrate`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T22:57:14.607

您的解决方案在 git 中。编写您的 rake 任务并确保它在您的 git 存储库中。

比尝试 Heroku 运行 rake your_task

或者将您的数据库种子文件用于其预期目的。

# html - HTML 锚链接是否可以明确要求打开安全选项卡？

> ID：12187384
> 
> 赞同：1
> 
> 时间：2012-08-29T22:28:54.477
> 
> 标签：html, anchor, secure-coding

大多数浏览器都有安全标签（Opera 有私人标签，Chrome 有隐身模式，IE 有隐私浏览等）。锚标记能够强制链接在新选项卡 ( `target="_blank"`) 中打开。**是否有一种纯 HTML、跨浏览器的方式来强制链接在安全选项卡中打开？**

我不想讨论它的实用性、安全性等，只是它是否可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T22:30:34.333

不可以。不保留历史记录和丢弃 cookie 的决定必须由用户做出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:31:43.497

纯 html 是不可能的，也许是 chrome 扩展

# php - mysql_connect 与 mysqli_connect

> ID：12187385
> 
> 赞同：3
> 
> 时间：2012-08-29T22:28:58.157
> 
> 标签：php, mysql, database

我在尝试使用 mysqli_connect 时遇到了一些问题，就像我使用 mysql_connect 一样

这将是我的代码示例：

**查询.PHP**

```
class classQuery{
  public function __construct(){
    require('conex/classConex.php');
    require('conex/statement/classStatement.php');
    $this->ObjConex = new classConex;
    $this->ObjStatement = new classStatement;
  }
  public function Query($email){
    $this->ObjConex->Conex();
    $query='SELECT user_email from table where email='.mysql_real_escape_string($email).'';
    $consulta = $this->ObjStatement->Select($query);
    return $consulta;
  } 
```

**班级声明**

```
class classStatement{
  public function __construct(){
    $this->ObjConex = new classConex;
  }
    public function Select($query){
      $query_execute = mysql_query($query);
      while($row = mysql_fetch_row($query_execute)){
         $consulta=htmlentities($row[0]);
      }
      return $consulta; 
    }
} 
```

**类CONEX**

```
class classConex{
  public function Conex(){
    require ('conex.php');
    mysql_connect ($server,$dbuser,$dbpasswd) or die('Error de Conexión');
    mysql_select_db($dbname);
  }
} 
```

好的，现在我想使用 mysqli_connect 而不是 mysql_connect，根据 php 手册，我的新连接类应该是这样的：

`$mysqli = new mysqli('localhost', 'my_user', 'my_password', 'my_db');`

现在我的连接是一个对象，我将无法以与我相同的方式从 ClassStatement 执行我的查询，我已经测试了从连接类返回对象，但这意味着我发现更多的代码是多余的......有没有更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T22:42:19.950

`mysql_connect`创建您所依赖的全局连接。这已经很不雅了。如果您将连接视为对象实例，您将拥有更多的控制权（特别是如果您需要同时维护多个连接）——这就是`mysqli`强制您做的事情。

它也不是多余的..它很清楚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T22:43:48.860

像这样构造你的类怎么样：

```
class Database {

  public function __construct ( $server, $dbuser, $dbpasswd, $dbname ) {
    $this->dbhandle = new mysqli($server, $dbuser, $dbpasswd, $dbname);
  }

  public function Select ($query) {
    $result = $this->dbhandle->query($query);

    while ( $row = $result->fetch_row() ){
      // Whatever you're doing here...
      //$consulta = htmlentities($row[0]);
    }

    return $consulta; 
  }

} 
```

因此，您可以将其与以下代码一起使用：

```
class Query{
  public function __construct(){
    require('conex/classDatabase.php');

    $this->Database = new Database($host, $user, $pass, $dbname);
  }

  public function Query ($email) {
    $query = "SELECT user_email from table where email='".mysql_real_escape_string($email)."'";
    $consulta = $this->Database->Select($query);
    return $consulta;
  }
} 
```

我在示例中包含了面向对象的语法。由于无论如何您都在使用对象，因此您可能会相处得很好。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2017-06-25T05:38:17.363

mysqli_connect 是 mysql 库的较新版本。

这里我在 mysqli 中代表改进。

Mysqli 引入的东西很少。

他们是，

1.准备好的陈述。2.面向对象的接口。3.支持多种报表。4.嵌入式服务器支持。

# oracle - Oracle 报告将数据库时间戳与当前时间戳进行比较

> ID：12187386
> 
> 赞同：0
> 
> 时间：2012-08-29T22:29:01.747
> 
> 标签：oracle, timestamp, oraclereports

我正在尝试编写一个 BeforeReport 触发器，用于检查用户是否在创建后 120 秒内访问报告数据。

我的代码如下：

```
function BeforeReport return boolean is

ENTRYDATE TIMESTAMP;
SERVERDATE TIMESTAMP;
DIFFSECONDS NUMBER;
begin

/*Checks to see if user is accessing the data within 120 seconds of creation in database*/
VALIDTIMELENGTH := 120;
SELECT SYS_DATE INTO ENTRYDATE FROM WOS_REPORT_PARAM WHERE SEQUENCE_NUM=UPPER(:SEQUENCENUM) AND PARAMETER='year';
SERVERDATE := CURRENT_TIMESTAMP;
DIFFSECONDS := ((EXTRACT(YEAR FROM ENTRYDATE)- EXTRACT(YEAR FROM SERVERDATE))*31536000) +
             ((EXTRACT(MONTH FROM ENTRYDATE)- EXTRACT(MONTH FROM SERVERDATE))*2592000) +
             ((EXTRACT(DAY FROM ENTRYDATE) - EXTRACT(DAY FROM SERVERDATE))*86400) +
             ((EXTRACT(HOUR FROM ENTRYDATE) - EXTRACT(HOUR FROM SERVERDATE))*3600) +
             ((EXTRACT(MINUTE FROM ENTRYDATE) - EXTRACT(MINUTE FROM SERVERDATE))*60) +
             (EXTRACT(SECOND FROM ENTRYDATE) - EXTRACT(SECOND FROM SERVERDATE));
  IF DIFFSECONDS > VALIDTIMELENGTH THEN RETURN(FALSE);
  ELSE
  return (TRUE);
  END IF;
  END; 
```

问题是，无论过去了多少时间，我的代码似乎都会返回 true。我没有正确实现我的秒/分钟代码吗？奇怪的是，我尝试同时返回（FALSE），但它仍然继续通过报告！甲骨文报告如此不一致，令人愤怒。非常感谢任何回应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:12:36.360

if`wos_report_param.sys_date`是 a `TIMESTAMP`（请注意，`sys_date`当有一个`sysdate`返回 a 的函数时，命名一列是相当混乱的`DATE`），并假设这`wos_report_param.sys_date`是过去的时间戳，您的逻辑可以简化很多

```
IF( current_timestamp - entrydate > numtodsinterval( validTimeLength, 'second' ) )
THEN
  RETURN true;
ELSE 
  RETURN false;
END IF; 
```

如果我的猜测是正确的并且 `wos_report_param.sys_date`是过去的时间戳，那么`diffseconds`您正在计算的将是一个负数，这解释了为什么您的过程总是返回`false`。您需要从较晚的日期中减去较早的日期，以产生正区间而不是负区间。或者你可以抛出`abs`你的`diffseconds`计算。

# powershell - 如何读取文本文件中的特定行

> ID：12187388
> 
> 赞同：3
> 
> 时间：2012-08-29T22:29:21.357
> 
> 标签：powershell

我在工作站上有主机文件，我需要读取特定行以获取 IP 地址。ip地址位置不同

这是我发现效果最好的线路。

**获取内容主机 | 选择对象-Last 1**

有什么方法可以解析特定单词的文本文件以读取和输出该 1 行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T23:06:13.820

如果您知道要查找的内容，下面将向您显示文件中的匹配行

```
Get-Content .\hosts | select-string 'searchstringhere' -SimpleMatch 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T23:08:41.743

好吧，您可以使用以下内容：

```
(Get-Content file.txt) -match '\d{1,3}(\.\d{1,3}){3}' 
```

它应该匹配 IPv4 地址并产生出现的行。

# indexing - 具有多个值的 pycassa 索引

> ID：12187390
> 
> 赞同：1
> 
> 时间：2012-08-29T22:29:54.270
> 
> 标签：indexing, cassandra, pycassa

我想查询多个值的索引列族。例如：

```
key, {key1: val1, key2: val2, key3, val1} 
```

所以如果我查询`[val1, val2]`， then`[key1, key3]`将被返回。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T17:25:38.530

Thrift API（Pycassa 所基于的）不允许分离查询，只允许连接查询。

CQL 确实允许查询`column IN (val1, val2)`：[https ://github.com/apache/cassandra/blob/trunk/doc/cql3/CQL.textile](https://github.com/apache/cassandra/blob/trunk/doc/cql3/CQL.textile)

# javascript - 为什么 Javascript SetTimeout() 不是多线程的

> ID：12187393
> 
> 赞同：12
> 
> 时间：2012-08-29T22:30:13.103
> 
> 标签：javascript

我有一个测试：

html:

```
<div id="f1">Empty</div>
<div id="f2">Empty</div>

​ 
```

js：

```
var s1 = function() {
    for (i = 1; i < 1000000000; i++) {
        var b = i * i;
    }
    $('#f1').html('Set');
}

var s2 = function() {
    if ($('#f1').html() == 'Empty') {
        $('#f2').html('Multi Thread');
        return;            
    };
    $('#f2').html('One Thread');
}

setTimeout(s2,110);
setTimeout(s1,100);​ 
```

是否有任何真正的原因为什么 setTimeOut() 不在不同的线程中运行，而是像事件模型一样？

[jsfiddle](http://jsfiddle.net/L4Rd8/4/)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-29T22:36:18.287

Javascript 本身不是多线程的，也不是非多线程的。但是，目前在主流浏览器中实现的 Javascript 的具体实现大多是单线程的。

此外，对于正确的多线程，该语言需要具有共享内存、锁、信号量和其他并发编程工具的功能，而当前定义的 JavaScript 没有这些功能（例如，无法描述并发 JS 线程如何控制谁可以更新 DOM 对象，这些对象当然是共享的，因为一个窗口中只有一个 DOM）。

有一些尝试让 JS 更加并行化——看看网络工作者、英特尔的 River Trail、[谷歌的 HTML5](http://softtalkblog.com/2011/02/07/google-uses-fractals-to-show-off-parallel-processing-in-javascript/)[工作](http://www.infoq.com/articles/js_multithread)等等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-27T20:59:21.450

eicto，***在请求时***`setTimeout`不会触发代码。 它将代码与之前的所有其他代码一起排队，内联，但它将其在行中的位置设置***为至少***请求的时间。

 **此外，大多数浏览器对最小超时都有硬性限制。
如果您请求 1 毫秒的超时，那么在大多数浏览器中，您很可能会在 10 毫秒到 15 毫秒后收到您的请求。

所有 JS 与 DOM 的交互，实际上，几乎单个页面所做的所有事情，都发生在一个线程上，除了自定义浏览器扩展和一些新的 API（如 webworkers）。

这就是为什么大型项目需要考虑页面上的其他所有内容，以及为什么所有内容都需要异步的原因。

因为`setTimeout`is 不是 a`sleep`并且它不会在它被`cron`编辑的确切微秒内返回... ...它在事件堆栈上放置一个回调，时间不早于您指定的时间。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-29T22:52:12.287

浏览器中的 Javascript 实现有很多设计决策，假设它只有单线程访问浏览器 DOM 和其他全局变量/属性。这使得使用它进行编程不太可能导致问题，但引入了一些必须处理的限制。

该语言本身完全具备多线程能力，我们已经在 WebWorkers 和该语言的某些服务器实现中看到了这一点。但是，每当您使用多个线程并尝试读取/写入在多个线程之间共享的变量或属性时，必须使用保护设备（如互斥锁）以允许对这些共享资源进行可靠访问。这使得如何进行这种编程变得非常复杂，并且浏览器中的 Javascript 决定不需要那种程度的理解来可靠地对其进行编程。

对于任何做过多线程编程的人来说，它可以很强大，但是很容易引入难以发现的错误。那些负责浏览器中 Javascript 的人决定应该完全避免这种难度和由此产生的错误类型。

即使现在使用 WebWorkers，WebWorker 和主 javascript 线程之间也没有共享资源。两者必须通过消息传递系统进行通信，这是一种强制安全的万无一失的方式。而且，结果是无法从 WebWorker 访问 DOM。相反，如果您希望更改 DOM，则必须向单个主线程发布消息并要求 IT 更新 DOM。主线程只有在完成其他事情时才会收到该消息（它是单线程的）。

DOM 现在也很可能已经花费了数亿年作为一个仅为单线程访问而设计的结构，因此设计和实现一种从多个线程访问它的方法（并修复所有导致的错误）将是一项艰巨的任务在该实施中）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-29T22:33:13.503

Javascript 不支持多线程，因为您在浏览器中的解释器是单线程

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-29T23:00:49.567

JavaScript 不是多线程的，但即使是 setTimeout 也是同步的。setTimeout 和 setInterval 由正确的 JavaScript 语言之外的浏览器提供，它提供了访问该语言的外部方法，例如事件执行。当人们将 JavaScript 称为异步或多线程语言时，这很可能是他们所指的，因为多个外部访问点（例如大量计时器或事件执行）可以同时发生，每个访问点都会在内存中生成一个对解释器的唯一访问点。这正是 Node.js 的开发人员在对 JavaScript 提出此类声明时所指的内容。

这意味着对各种隔离线程的多个外部访问可能会导致 UI 中的冲突，因为模拟的多线程效果可能会导致浏览器输出中的冲突，其中只有一个文档对象代表整个页面。这就是为什么 setInterval 的间隔很短通常被认为是不安全的。setInterval 是完全异步的，即使在前一个时间间隔内的执行还没有结束，它也会按照提供的时间间隔执行。这种碰撞就是我所说的故障转移，因为下一个时间间隔是执行的代码会超过之前的执行，如果您的代码需要访问 DOM 或使用闭包，您可能会遇到问题。为了安全起见，建议使用递归 setTimeout，

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-27T20:44:55.600

Mozilla 确实支持 Javascript 中的多线程 - 只要您不想从多个线程进行 UI 工作。[我的删除重复消息 (Alternatve)](https://addons.mozilla.org/en-US/firefox/addon/remove-duplicate-messages-alte/)扩展的早期版本是多线程的。

在我的扩展中查看[我自己的关于这个问题的错误页面，或者更好的是，](https://www.mozdev.org/bugs/show_bug.cgi?id=16631)[这个](https://developer.mozilla.org/En/Using_web_workers)关于在 Mozilla 中使用工作线程的页面。eicto，您可以使用后台线程很好地实现您的代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-29T22:33:17.953

Javascript 不是多线程的。

HTML5 将赋予 javascript 多线程功能。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2020-01-28T13:17:51.377

等待给定的时间后，方法（s1，s2）的执行仍然发生在javascript线程本身（单线程）中。

s2 等待 s1 的原因。**

# javascript - 主元素属性？（或技术）

> ID：12187399
> 
> 赞同：0
> 
> 时间：2012-08-29T22:31:12.437
> 
> 标签：javascript, jquery, html

有什么方法可以将一个元素设置为主元素，并让页面上的所有其他元素以完全相同、相同的样式、相同的代码、相同的属性、相同的值出现和表现？

```
<input id="btnBack" name="btnBack" type="button" value="Back" disabled="disabled" style="margin-right: 10px" />
$('#btnBack').click(...do stuff);

<input master="btnBack" /> 
```

或者如果失败了，是否有任何技术可以简洁地达到相同的结果？

我有一半期望有一个 Javascript 库可以复制所有属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:36:03.097

相同的样式= css

相同的属性、值等 = JS

请参阅此[小提琴](http://jsfiddle.net/pqadz/)以获取帮助您入门的示例或此代码片段...

CSS

```
 input {
    width: 200px;
    background-color: yellow;
 } 
```

JS

```
var value = 'myval';
var disabled = 'disabled';

var myElements = document.getElementsByTagName('input');

for(var i = 0; i < myElements.length; i++){
    myElements[i].value = value;
    myElements[i].disabled = disabled;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T22:47:08.970

我不知道这是否是您所指的，但最好的办法是对您想要设置样式和行为相同的所有元素使用一个类。

例如

```
File: index.html
<a href="#" class="master-class">Awesome Link</a>
<button class="master-class">Awesome Button</a>

File: style.css
.master-class {
   color: black;
   background: white;
   more of your styles...
}

File: scripts.js
$(function() {
  $(".master-class").click(function() {
    alert("This is from one of the many elements with the class 'master-class'");
  });
}); 
```

Team Treehouse 是一个真正了解所有网络知识的好地方。尽管我知道那里的大部分内容，但我已经使用它们一段时间了，但我总是会捡起一些新东西。[http://teamtreehouse.com/](http://teamtreehouse.com/)

W3Schools ( [http://www.w3schools.com](http://www.w3schools.com) ) 也很棒。这是我一开始学到很多东西的地方。

还有大量的播客和 vodcast 可以教你，只需在 iTunes 中搜索网页设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T22:35:41.133

是的，使用 CSS 类。创建一个大师班，然后在所有元素上使用 class="master"。

但是我想你会发现一旦你进入它，你并不想这样做。但是更改要更改的元素的类很容易，因此以这种方式开始不会对您造成伤害。

您可以在此处阅读有关 CSS 的信息：http: [//www.w3schools.com/css/](http://www.w3schools.com/css/)尽管有更好的资源 w3schools 涵盖了很多领域。

如果您有兴趣为网站构建一致的感觉并且不介意使用 jquery（我喜欢它！），那么您应该查看 jquery UI 主题滚轮：http: [//jqueryui.com/themeroller/](http://jqueryui.com/themeroller/)

# asp.net - 在没有 web 服务的情况下使用自动完成扩展器

> ID：12187400
> 
> 赞同：0
> 
> 时间：2012-08-29T22:31:13.150
> 
> 标签：asp.net

我有一个动态数据网站，我试图在其中添加一个带有 AutoCompleteExtender 的文本框。我已经像这样声明了控件

```
<asp:TextBox ID="tbTerm" runat="server" Width="300px"/>
  <asp:AutoCompleteExtender runat="server"
       id="autoCompleteExtenderTerms"
       TargetControlID="tbTerm" 
       ServiceMethod="GetCompletionList" 
       UseContextKey="True">
  </asp:AutoCompleteExtender> 
```

在该页面的代码隐藏中，我已经像这样声明了 web 方法

```
[System.Web.Services.WebMethod]
[System.Web.Script.Services.ScriptMethod]
public static List<string> GetCompletionList(string prefixText, int count)
{
    using (ProductDataEntities context = new ProductDataEntities())
    {
        var terms = (from t in context.Terms
                     where t.Name.StartsWith(prefixText, StringComparison.CurrentCultureIgnoreCase)
                     select t.Name).ToList();

        return terms;
    }
} 
```

目前这个方法没有被调用，这不是一个伪造的键列，所以我不能为此使用标准过滤器。

我已确保在 ScriptManager 上设置了 EnablePageMethods="true" 并且我不知道为什么没有从页面中触发此方法。控制没有包含在更新面板中，对此我没有什么特别之处.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T04:32:57.937

设置`ServicePath`属性值。

# javascript - 使用 JavaScript 查找具有特定属性的 SVG 元素

> ID：12187406
> 
> 赞同：1
> 
> 时间：2012-08-29T22:31:45.877
> 
> 标签：javascript, svg

我在 HTML 页面中有一部分 JavaScript，上面写着：

```
function flashElements() {
    var svg = document.getElementById("mysvg").getSVGDocument();
    var all = svg.getElementsByTagName("flash");
    for (var i=0, max=all.length; i < max; i++) {
        if (all[i].flash === "on")
        {
            all[i].setAttributeNS(null, "fill", "lime");
        }
    }
} 
```

SVG加载如下：

```
<object data="alpha.svg" type="image/svg+xml" id="mysvg" width="800" height="600"></object> 
```

这个想法是在一个特定的触发器上调用它，如果任何 SVG 元素具有“flash”的特定属性，那么它们的填充属性将改变颜色。当然，上面的方法不起作用——它在寻找元素，而不是属性。那么我如何遍历所有的 SVG 元素，寻找具有特定属性的任何东西呢？

SVG 具有：

```
<polygon points="203,20 209,32 205,32 203,28" class="trackPlain" flash="on" />
<polygon points="205,32 209,32 217,48 213,48" class="trackPlain" flash="off" /> 
```

实际上我想要做的就是闪烁元素（开/关），但当然 IE 不支持动画。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T23:21:03.660

效率不高，但我想你可以做这样的事情：

```
var allElements = svg.getElementsByTagName("*");
for(var i = 0; i < allElements.length; i++) {
    var element = allElements[i];

    if(element.getAttribute("myAttr") === "on") {
        element.setAttribute("fill", "lime");
    }    
} 
```

您的另一个选择是进行树遍历。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T07:06:25.193

另一种解决方案是使用 CSS 选择器，这样可以避免更改大量属性并且效果应该相同。

```
<style>
  .trackplain[flash="on"] { fill: lime; }
</style> 
```

**更新：**需要明确的是，以上内容应放在 svg 文档中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-11T14:16:22.533

使用 Typescript 和 inskscape svg 的其他答案：

```
this.mySvg = svg.getElementsByTagName("svg")[0];
let myDom = this.svg.getElementsByTagName("*");
    for(let i=0; i < myDom.length; i++) {
      let label = myDom[i].getAttribute('inkscape:label');
      let style = myDom[i].getAttribute('style');
      if (label && style) {
           myDom[i].addEventListener("click", () => this.onClick(myDom[i], style));
      }
    } 
```

# jquery - jQuery：获取点击元素的值

> ID：12187407
> 
> 赞同：2
> 
> 时间：2012-08-29T22:31:46.417
> 
> 标签：jquery

我有这段代码：

```
<tr class="editField">
  <td>abc</td>
  <td>123</td>
  </td>
</tr>
<tr class="editField">
  <td>dfg</td>
  <td>456</td>
  </td>
</tr> 
```

然后我有这个javascript来打开一个带有jQuery的对话框：

```
$( ".editField" ).click(function() {
        alert(...); // should get me 123
}); 
```

假设我点击第一个`tr`，我会得到第二个的内容`td`（即123），我应该写什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-29T22:33:14.150

鉴于您当前的加价，我建议：

```
$( ".editField" ).click(function() {
        alert($(this).find('td:eq(1)').text());
}); 
```

但是，虽然这在给定的示例中有效，但将一些定义属性添加到您希望从中恢复“值”的元素会更容易（并且随后更可靠），例如类名“值” '，像这样给出 HTML：

```
<tr class="editField">
  <td>abc</td>
  <td class="value">123</td>
</tr> 
```

和 jQuery：

```
$( ".editField" ).click(function() {
        alert($(this).find('td.value').text());
}); 
```

或者，当然，如果“值”始终是任何给定行（相关类的）的*最后一个* `td`元素，那么您可以改用：

```
$( ".editField" ).click(function() {
        alert($(this).find('td:last').text());
}); 
```

Incidentally, please note that your HTML is malformed, you have a surplus `</td>` after the last cell in both rows of your sample code.

References:

*   [`eq()` selector](http://api.jquery.com/eq/).
*   [`find()`](http://api.jquery.com/find/).
*   [`:last` selector](http://api.jquery.com/last-selector/).
*   [`text()`](http://api.jquery.com/text/).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T13:24:23.980

try this:

```
$( ".editField" ).click(function() {

    var clickedValue = $(this).find('td:first').next().text();

alert(clickedValue );    

}); 
```

fiddle link : [http://jsfiddle.net/9cRRj/8/](http://jsfiddle.net/9cRRj/8/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-13T22:21:26.070

```
 $(function () {
        $(".Cartbtn").click(function () {
            var temp = {
                "Id": $(this).data("itemid"),
                "Name": $(this).data("itemname"),
                "Price": $(this).data("itemprice"),
                "Quantity": $(this).data("itemqty"),
                "ImageUrl": $(this).data("itemimgurl"),
            }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-04T08:56:54.120

```
$(document).bind("click", function (e) {
    $(e.target).closest("li").toggleClass("highlight");
    alert($(event.target).text());
}); 
```

this will directly give you the selected element id. $(event.target).text(); will give you the selected element text within a second.

# jquery - 在 jQuery 中将 if / else 与 .click 结合时遇到问题

> ID：12187412
> 
> 赞同：0
> 
> 时间：2012-08-29T22:32:11.903
> 
> 标签：jquery, click, if-statement

这是我的 javascript

```
$(document).ready(function(){
        $('.frontpageimg').click(function(){
            $(this).data('clicked', true);
        });
        if('.frontpageimg').data('clicked') {
            $('#imagepos').slideUp(2000).fadeOut(2000);
            $('#contentpos').slideUp(2000).fadeIn(2000);
        } else {
            $('#imagepos').delay(8000).slideUp(2000).fadeOut(2000);
            $('#contentpos').delay(8000).slideUp(2000).fadeIn(5000);
        }
    }); 
```

该网站会在延迟后显示主要内容，这是应该发生的。但是，我希望用户能够通过单击图像来跳过等待并激活较短的动画。目前“其他”部分下的所有内容都有效，但单击图像时没有任何反应。

编辑：我已经更改了代码以试图让事情正常进行，但仍然没有按照我的意愿去做。

```
$(document).ready(function(){
        $('#imagepos').delay(8000).slideUp(2000).fadeOut(2000);
        $('#contentpos').delay(8000).slideUp(2000).fadeIn(5000);    
    });
    $('#frontpageimg').click(function(){
                $('div:animated').stop();
                $('div:animated').clearQueue();
                $('#imagepos').slideUp(2000).fadeOut(2000);
                $('#contentpos').slideUp(2000).fadeIn(2000);
            }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T22:42:30.393

您正在尝试更改其行为的函数（在单线程环境中仅调用一次）中绑定点击处理程序。

您最好尝试从 cluck 处理程序取消或修改动画序列（如果它仍在运行），或者，您可以让动画序列检查按钮是否已被单击

# wpf - 在特定时间每 2-3 天运行一次函数

> ID：12187413
> 
> 赞同：0
> 
> 时间：2012-08-29T22:32:30.340
> 
> 标签：wpf, dispatcher

我想知道最好的方法是什么，我在想的是一个检查当前时间的调度程序，如果它等于用户指定的日期时间，那么函数就会被调用，有没有更好的方法来做到这一点?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T22:41:14.793

是的，无需重新发明轮子，改用 Quartz.NET（库低于 500k）...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T22:42:20.627

您可以访问 CRON 吗？它应该内置在您的服务器中，并且您应该可以通过控制面板访问它。这正是 CRON 的发明目的。

# javascript - 每次单击 li 的一部分时，href 都不会加载链接。使用 javascript 使整个 li 可点击

> ID：12187419
> 
> 赞同：0
> 
> 时间：2012-08-29T22:32:53.677
> 
> 标签：javascript, css, html-lists

[http://hemakessites.com](http://hemakessites.com)

我想单击“关于”按钮转到“关于”页面。我正在使用 Javascript 和 JQuery 来处理行为（使整个 li 可点击）。出于某种原因，在 li 的不同区域单击 about 并不总是加载页面。

如果有更好的解决方案，我愿意不使用 jQuery。

“联系信息”和“爱好项目”没有href，所以链接不起作用。如果您转到“关于”页面，则菜单基于 CSS 工作，而 javascript 不会试图使整个 li 可点击。所以 about.html 页面上没有 javascript，你可以看到没有任何 javascript 的菜单问题。

谢谢你的帮助！

```
index.html
    <div class="navcontainer">
    <ul><li>Link Title</
    li><li>Second_Link Title</ <!-- fixes extra space with </li><li> -->
    li></ul>
    </div>

style.css
    #nav li
      {
      display: inline-block;
      List-Style-Type: None;
      float:left;
      text-align:Center;
      width: 153px;
      height:46px;  
      font-size: 80%;
      border-Bottom: 1px solid #666666;
      }

    #nav li #about    
      {
      z-index: 10000;
      position: relative;
      top: 18px;
      text-decoration: underline;
      -moz-user-select: -moz-none;
      -khtml-user-select: none;
      -webkit-user-select: none;
      } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:30:12.917

The problem you have right now is that the `li` is bigger then the `a`. Clicking on the `l`i, but outside the `a` will not make the link work, as you already found out.

In stead of applying all your styles and effects to the `li` element, you should apply them to the `a` element directly and set it to display as a block. This way the `li` will take the same size as the `a`, and whereever you click on the hovered item, your href will work just fine. Bigger links is always a good idea, definitly with the amount of tablets and other toutchscreen devices rizing every day.

Note that it will not be a straight copy / paste of your code, especially when it comes to floats and positioning, but it should not be to hard to achieve what you are after by applying the styles directly to the `a` element. If you have difficulty converting your code, feel free to set up a working example on jsfiddle and we will be happy to help out where possible.

This solution does not require any js what so ever. Using js for your main navigation is always a bad idea, as it will make it hard, if not impossible, to navigate your site for people with js disabled. Not exactly what i would call gracefull degrading...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T22:39:52.453

只需在您的 CSS 中添加以下内容：

```
#nav li.about a{
z-index:10000; } 
```

它会起作用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T23:00:44.257

您的问题不是javascript，而是CSS。你有一个悬停属性，可以放大`<li>`. 单击时，活动属性会使其缩小，从而使元素比以前更小。如果单击放大元素的上角，则不会加载，因为该元素现在位于可单击区域下方。如果你点击中间的底部，它会。

最终，对于这样的事情，您最好使用 jQuery UI 来管理您的选项卡或使用 Twitter Bootstrap。开箱即用，您不必担心 CSS 问题，而且它们已经看起来不错，因此无需额外的样式。

如果你想坚持你已经有了，你可能只想放弃花哨的 CSS。摆脱 :active 课程，我认为它应该可以正常工作。

# ffmpeg - ffmpeg 在创建时流式传输多个 avi 文件

> ID：12187425
> 
> 赞同：2
> 
> 时间：2012-08-29T22:33:09.653
> 
> 标签：ffmpeg, streaming, avi

背景故事：我有一个 VB.net 程序（它使用一个更老的 COM 对象访问 DVR）以每 15 秒的长度创建按顺序编号的 AVI 文件。每 15 秒创建一个新的 AVI，其中包含最近 15 秒的视频。我知道与每个文件相关的确切日期时间。所以文件可能被命名为（20121008-133445.avi，所以 yyyyMMdd-hhmmss.avi）。

问题：使用 ffmpeg/ffserver（最好但我是开放的），我如何创建一个流，这样当一个人访问它时，他们会看到一个连续的视频，该视频从尽可能近的位置开始并继续流式传输创建时的 avi 文件？

如果 Linux 功能更强大，我可以通过 samba 共享将这些文件发送到 Linux 机器（或者让 linux 机器访问 Windows 机器上的共享）。然而，我坚持使用 Windows 来实际生成原始 AVI 文件。

最终目标是能够在 iPad 上查看这些流，但该过程在其他地方似乎有很好的记录。

我发现了一个与我的需求类似但似乎没有解决的问题：[FFmpeg make mpeg2 ts without discontinuity](https://stackoverflow.com/questions/10825476/ffmpeg-make-mpeg2-ts-without-discontinuity)

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T08:36:47.613

为什么不编写一个小程序，简单地一个接一个地连续读取这些文件并将它们转储到命名管道。然后，ffmpeg 可以从命名管道中读取，它会认为它是一个文件。

更复杂的解决方案是使用 gstreamer 的 multifilesrc。

# jquery - 使用 jQuery 获取链接文本（如果有）或图像的 id（如果是图像链接）

> ID：12187443
> 
> 赞同：1
> 
> 时间：2012-08-29T22:34:56.347
> 
> 标签：jquery, text, find

我想使用 jQuery 来确定链接是文本链接还是图像链接。如果是文本链接，我想抓取文本。如果是图片链接，我想获取图片的 id。我尝试将 .text() 用于文本链接，但这也为我的图像链接返回 true。

```
function get_link_content(object) {

            if($(object).text()) {
                var link_content = $(object).text();
            }
// even if it's an image link, this ^^ always returns true
            else if($(object).find('img')) {
                if($(object).find('img').attr('id')) {
                    var link_content = $(object).find('img').attr('id');
                }
                else {
                    var link_content = 'unidentified';
                }
            }

            return link_content;
        } 
```

通过文本链接，我的意思是：

```
<a href="#">This is a text link</a> 
```

通过图片链接，我的意思是：

```
 <a href="#"><img id="the-id" src="#"></a> 
```

除了 .text() 之外，我还应该使用另一种方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T22:41:43.383

```
if( $('img', $(object)).length ){
//object has a img as child
}
else{
//object doesnt have
} 
```

或者

```
var myText = $('img', $(object)).length ? $('img', $(object)).attr('id') 
             : $(object).text(); 
```

或作为一个函数

```
function get_link_content(object) {
    return $('img', $(object)).length ? $('img', $(object)).attr('id') 
                 : $(object).text();
} 
```

或者

```
return ( $('img', $(object)) && $('img', $(object)).attr('id') ) || $(object).text(); 
```

从@undefined 的建议将所有长度更改为 has() ，然后在阅读 'has()' 的文档后恢复为长度：P

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:41:05.913

您可以使用 jQuery 对象的`length`属性：

```
var $obj = $(object);
if(!$obj.children().length) {
    var link_content = $obj.text();
} else {
    var link_content = $('img', $obj).attr('id');
    // ...
} 
```

[请注意，您可以`$(object)`多次缓存而不是制作 jQuery 对象。]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T22:41:35.227

```
function get_link_content(e) {
        if($(e).find('img').length != 0) {
            if($(e).find('img').attr('id')) {
                var link_content = $(e).find('img').attr('id');
            } else {
                var link_content = 'unidentified';
            }
        } else {
            var link_content = $(object).text();
        }
        return link_content;
    } 
```

`$(object).find('img')`- 这将始终返回 jQuery 对象，并且对象始终为真。要检查 jQuery 是否找到了某些元素，您应该使用 length 属性。

顺便说一句： $(e).find('img').attr('id') - 多次这样做不是最好的方法。最好一次获取该值并将其放入某个临时变量中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T22:44:54.767

```
function get_link_content(object) {
    var link_content = 'unidentified';
    var $img = $(object).find('img');
    if(!$img.length){
      //no image found
      //get the text
      var $txt = $(object).text();
      if($txt.length){
          link_content = $txt;
      }
    }else{
      //there's an image
      link_content = $img.attr('id');
    }
    return link_content;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-29T23:32:33.937

以下是您的代码的清理和略微优化的版本：

```
function get_link_content(object) {
  var $object = $(object), // Cache the element for faster execution
      $img = $object.find('img'),
      link_content,
      id;

  if (!$img.length) { // Does the object element not have an image?
    link_content = $object.text();
  } else {
    id = $img.attr('id'); // Get the image ID (if it exist)

    if (id.length) { // Was there an ID?
      link_content = id;
    } else {
      link_content = 'unidentified';
    }
  }

  return link_content;
} 
```

**编辑：**这是一个进一步优化的版本（通过了一个 jQuery 元素）。

```
function get_link_content($object) {
  var $img = $object.find('img'),
      link_content;

  if (!$img.length) { // Does the object element not have an image?
    link_content = $object.text();
  } else {
    link_content = $img.attr('id'); // Get the image ID (if it exist)

    if (!link_content.length) { // Was there no ID?
      link_content = 'unidentified';
    }
  }

  return link_content;
} 
```

正如你所看到的，我已经删除了, 因为它无论如何`id`都要存储（如果存在并且有一个值）。这意味着当它遇到具有 的图像时它会稍微快一些，因为它不必将 id 值分配给变量，然后如果有值则在第二步中分配给。它也比第一个版本短一点，这增加了一点可读性。`link_content``id``id``id``id``link_element`

# linq - LINQ Lamba 从表中全选，其中字段包含列表中的所有元素

> ID：12187447
> 
> 赞同：2
> 
> 时间：2012-08-29T22:35:16.543
> 
> 标签：linq, list, search, lambda, contains

我需要一个 Linq 语句，它将从一个字段包含所有元素的表中选择所有内容，`list<String>`同时在其他字段中搜索整个字符串，而不考虑单词。

它基本上只是对所有单词都需要在记录中的字段进行包容性单词搜索，并在其他字段上进行字符串搜索。

即我有一个查找屏幕，允许用户搜索整个搜索字符串的 AccountID 或 Detail，或搜索包含单词的 clientID，如果我能找出 ClientId 组件，我会将其扩展到详细字段。

复杂性在于，AccountId 和 Detail 也在被搜索中，这基本上阻止了我在第二个示例中执行 foreach，因为“or”。

示例 1，当我之后执行 query.Count() 时，这给了我以下错误：

查询.Count(); 'query.Count()' 抛出类型为 'System.NotSupportedException' int {System.NotSupportedException} 的异常

+base {"本地序列不能在查询运算符的 LINQ to SQL 实现中使用，但 Contains 运算符除外。"} System.SystemException {System.NotSupportedException}

```
var StrList = searchStr.Split(' ').ToList();

query = query.Where(p => p.AccountID.Contains(searchStr) || StrList.All(x => p.clientID.Contains(x)) || p.Detail.Contains(searchStr)); 
```

示例 2，这给了我任何搜索词类型的结果：

```
var StrList = searchStr.Split(' ').ToList();
  foreach (var item in StrList)
    query = query.Where(p => p.AccountID.Contains(searchStr) || p.clientID.Contains(item) || p.Detail.Contains(searchStr)); 
```

## 更新

我有一个包含 3 个字段的表，AccountID、ClientId、Details

记录 ID、AccountID、CLientId、详细信息

1、“123223”、“bobo and co”、“此客户 suxs”

2、“654355”、“Jesses hair”、“我们喜欢这个客户之类的东西”

3、《456455》、《微软》、《我们爱微软》

搜索示例

searchStr = "232" 返回记录 1；

searchStr = "bobo hair" 不返回任何记录

searchStr = "bobo and" 返回记录 1

searchStr = "123 bobo and" 返回什么都不返回

这里的想法是：

*   如果客户端输入部分 AccountId 它会返回内容，
*   如果客户想要搜索 ClientId，他们可以通过搜索词（即单词列表）键入和取消客户。由于客户端数量众多，ClientID 将需要包含所有单词（以任何顺序）

我知道这看起来很奇怪，但这只是一个以强大方式查找帐户的简单界面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T00:17:23.820

我认为您的问题有两种解决方案。

一种是像这样计算内存中的结果：

```
int count = query.ToList().Count(); 
```

另一种是**不要**`All`在您的查询中使用：

```
var query2 = query;
foreach (var item in StrList)
{
    query2 = query2.Where(p => p.clientID.Contains(item));
}
var result = query2.Union(query.Where(p => p.AccountID.Contains(searchStr) || p.Detail.Contains(searchStr))); 
```

最后`Union`的作用就像`OR`两个查询之间的一个。

# wolfram-mathematica - 解决旋转变换

> ID：12187454
> 
> 赞同：0
> 
> 时间：2012-08-29T22:35:38.993
> 
> 标签：wolfram-mathematica

我对仿射变换矩阵的重建有疑问。平移矩阵重建工作得很好，但不是旋转。

感谢你们！

```
(*Works just fine*)
Clear["Global`*"]
data = RandomReal[10, {100, 3}];
data0 = TranslationTransform[{1, -1, 1}]@data;
{dX0, dY0, dZ0} /. 
 Solve[data0 == TranslationTransform[{dX0, dY0, dZ0}]@data, {dX0, dY0,
    dZ0}]

(*Yields {} ????*)
Clear["Global`*"]
data = RandomReal[10, {10, 3}];
data0 = RotationTransform[10 , {1, 0, 0}]@data;
Solve[data0 == RotationTransform[aZ0 Degree, {0, 0, 1}]@data, {aZ0}] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T16:49:04.757

您只有一个 var 的方程太多。

```
data = RandomReal[1, {10, 3}];
data0 = RotationMatrix[1/2, {1, 0, 0}].# & /@ data;
Solve[Thread[data[[1]] == RotationMatrix[aZ0, {1, 0, 0}].data0[[1]]][[2]], {aZ0}]
(*
-> -0.5
*) 
```

# php - 对 MySQL 的查询返回 null 并且在它以前可以正常工作之前

> ID：12187464
> 
> 赞同：0
> 
> 时间：2012-08-29T22:37:30.123
> 
> 标签：php, mysql

基本上我想使用 php PDO 创建一个查询来检查我的数据库“test”中是否存在表“page”。我不知道该怎么做，我在[这里](https://stackoverflow.com/questions/12097991/problems-checking-whether-a-table-exist-or-not-in-the-db)得到了一些帮助。

我的代码运行完美......直到现在我把所有东西都放在课堂上......现在`var_dump($r2)`返回`NULL`，我不知道代码有什么问题。除了将它放入OOP之外，我没有改变任何东西......

谁能发现问题？？因为我看不到。谢谢你

```
$r1 = $this->db->query('SHOW TABLES LIKE \'page\'');

 // Debbug
    $r2 = $r1->fetchAll;
    var_dump ($r2);

    if (count($r1->fetchAll()) > 0 ) {

        echo "The table PAGE exists";

    } 
```

完整的类是以下一个

```
 class phase2 {

        function __construct () {

        $dbFile = 'dbconfig.php';
        $this->dbFile = $dbFile;

        require_once ("$dbFile");   

        $step = $_GET["step"];

        $username = $DB_USER;
        $password = $DB_PASS;
        $server = $DB_SERVER;
        $dbName = $DB_NAME;

        $this->step = $step;
        $this->dbFile = $dbFile;
        $this->username = $username;
        $this->password = $password;
        $this->server = $server;
        $this->dbName = $dbName;

        $db = new PDO ('mysql:host=' .$server.';dbname='.$this->dbName,$this->username,$this->password);

        $this->db = $db;

        if (empty ($_GET['fot']) ) { 

            $fOT = 'false'; 

        } elseif ($_GET['true']) { $fOT = 'true'; }

        $this->fOT = $fOT;

        $this->IDB = $this->handleDatabase( 1 );
        $this->IDB2 = $this->handleDatabase( 2 );
        $this->IDB3 = $this->handleDatabase( 3 );

        }

public function handleDatabase ($num = 1){

// Prepare SQL Statements

    $IDB1 = $this->db->prepare( 
         "CREATE TABLE pages (
          id int(11) NOT NULL auto_increment,
         subject_id int(11) NOT NULL,
          menu_name varchar(30) NOT NULL,
          position int(3) NOT NULL,
          visible tinyint(1) NOT NULL,
          content text NOT NULL,
          PRIMARY KEY  (id)
    )ENGINE=MyISAM AUTO_INCREMENT=7 DEFAULT CHARSET=utf8");

    $IDB2 = $this->db->prepare("
        CREATE TABLE subjects (
          id int(11) NOT NULL auto_increment,
          menu_name varchar(30) NOT NULL,
          position int(3) NOT NULL,
          visible tinyint(1) NOT NULL,
          PRIMARY KEY  (id)
    )ENGINE=MyISAM AUTO_INCREMENT=6 DEFAULT CHARSET=utf8");

    $IDB3 = $this->db->prepare("
        CREATE TABLE users (
          id int(11) NOT NULL auto_increment,
          username varchar(50) NOT NULL,
          hashed_password varchar(40) NOT NULL,
          PRIMARY KEY  (id)
    )ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=utf8");

    $name = "IDB".$num;
    return isset( $$name)?$$name:false;

}
//Set Option to True or False

function createTablePages ($fOT){

    $r1 = $this->db->query('SHOW TABLES LIKE \'page\'');

// Debbug
    $r2 = $r1->fetchAll;
    var_dump ($r2);

    if (count($r1->fetchAll()) > 0) {

        echo "The table PAGE exists";

    } elseif ($fOT == 'true') {

            echo "enteres";
            $this->IDB1->execute();
            $this->stepFunction (1,false);

    } 

}
function createTableSubjects ($fOT){

    $r2 = $this->db->query('SHOW TABLES LIKE \'subjects\'');

    if (count($r2->fetchAll()) > 0  && $fOT == 'false') {

            echo "The table SUBJECTS exists ";

    } elseif ($fOT == 'true') {

        $this->IDB2->execute();
        $this->stepFunction (2,false);

    }
}

function createTableUsers ($fOT){

    $r3 = $this->db->query('SHOW TABLES LIKE \'users\'');   

    if (count($r3->fetchAll()) > 0  && $fOT == 'false') {

            echo "The table USERS exists";

    } elseif ($fOT == 'true') {

            $this->IDB3->execute();
            echo "Would you like to populate all the tables?";
    }   
}

public function stepFunction ($fOT,$step){

switch ($step) {

    case 0: 
            $this->createTablePages ($fOT);
            break;
    case 1: 
            $this->createTableSubjects($fOT);
            break;
    case 2: $this->createTableUsers ($fOT);
            break;
    }

}

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:00:50.753

我可以看到的最大问题是您没有创建 $db - 仅在构造内部。尝试添加到此部分：

```
class phase2 {

    function __construct () { 
```

添加此语句`public $db;`：

```
class phase2 {

    public $db;

    function __construct () { 
```

除非我弄错了，否则您不能在不先声明的情况下从方法中强制转换变量。您需要对需要从该类中的其他方法访问的任何其他变量执行相同的操作。阅读基础知识：[http ://www.php.net/manual/en/language.oop5.basic.php](http://www.php.net/manual/en/language.oop5.basic.php)

另外，我建议打开错误报告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T23:06:03.637

您的查询试图找到一个名为 的表`page`，但是，您`CREATE TABLE`创建了一个名为 的表`pages`：

```
$IDB1 = $this->db->prepare( 
    "CREATE TABLE pages ("
...

$r1 = $this->db->query('SHOW TABLES LIKE \'page\''); 
```

除非您实际上同时拥有*两张*表，否则错误出在这两个地方之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T00:39:58.553

您在构造函数中使用 require_once() 。该类只会在第一次正确初始化。之后配置将不会加载，因此不会设置变量。

# mysql - 选择彼此在一定时间范围内加时间戳的记录

> ID：12187468
> 
> 赞同：1
> 
> 时间：2012-08-29T22:38:02.660
> 
> 标签：mysql, sql

您将如何选择彼此在一定时间内带有时间戳的记录？

应用和寻求的解决方案：

我有一个包含点击记录的表，我想通过并找到在特定时间段内发生的来自同一 IP 的点击。

例如：SELECT ALL ip_address WHERE 5 个或更多相同的 ip_address，发生/被分组/时间戳，彼此相隔 10 分钟

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:50:44.100

你可以选择这样的记录

```
$recorddate = date("Y-m-d");
SELECT * FROM table WHERE date > UNIX_TIMESTAMP('$recorddate'); 
```

UNIX_TIMESTAMP 函数将日期转换为时间戳。您可以轻松地在查询中使用它。

如果您想以 10 分钟的间隔获取记录，您可以执行类似的操作

```
$starttime = "2012-08-30 19:00:00";
$endtime   = "2012-08-30 19:10:00";
SELECT * FROM table WHERE date >= UNIX_TIMESTAMP('$starttime') AND date <= UNIX_TIMESTAMP('$endtime') ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T00:18:34.293

决定不尝试对原始数据进行单一查询。

与朋友讨论后，然后阅读有关提及内存引擎和 PHP memcatch 的选项；我决定使用常规表格来记录使用生存时间时间戳的点击次数。在该时间戳通过后，分配一个新的 ttl 并重新设置计数。一件事是对于我的应用程序，我无法确切确定参数配置设置将持续多长时间 - 如果它们更大并且内存被清除，那么事情就会重新开始。

如果它在用户链接点击时运行，这不是一个完美的解决方案，但它应该很好地捕捉点击欺诈风暴并完成工作。

一些管理 PHP/MySQL 代码（“Drupalized 查询”）：

```
$timeLimit = $clickQualityConfigs['edit-submitted-within-x-num-of-same-ip-clicks']." ".$clickQualityConfigs['edit-submitted-time-period-same-ip-ban']; // => 1 days // e.g.
$filterEndTime = strtotime("+".$timeLimit);

$timeLimitUpdate_results = db_query('UPDATE {ip_address_count} 
SET ttl_time_stamp = :filterendtime, click_count = :clickcountfirst WHERE ttl_time_stamp < :timenow', array(':filterendtime' => $filterEndTime, ':clickcountfirst' => '0', ':timenow' => time()));

$clickCountUpdate_results = db_query('INSERT INTO {ip_address_count} (ip_address,ttl_time_stamp,click_count) 
VALUES (:ipaddress,:timestamp,:clickcountfirst) 
ON DUPLICATE KEY UPDATE click_count = click_count + 1', array(':ipaddress' => $ip_address,':timestamp' => $filterEndTime,':clickcountfirst' => '1')); 
```

* * *

数据库信息：

```
CREATE TABLE `ip_address_count` (
   `ip_address` varchar(24) NOT NULL DEFAULT '',
   `ttl_time_stamp` int(11) DEFAULT NULL,
    `click_count` int(11) DEFAULT NULL,
 PRIMARY KEY (`ip_address`)
) 
```

# android - 使用指南针时如何将 OnTap/Touch 侦听器设置为 googleMap Marker，地图自动旋转

> ID：12187469
> 
> 赞同：0
> 
> 时间：2012-08-29T22:38:01.847
> 
> 标签：android, google-maps

1.  我使用谷歌地图构建导航应用程序，地图由指南针自动旋转。

问题是当我设置标记时。

我在我的扩展 ItemizedOverlay 中使用 OnTap(int)，当我单击标记时弹出 Toast msg，它在标准使用谷歌地图时工作正常。但是，因为我使用由指南针旋转的地图，所以触摸监听器不会随地图旋转。只有标记可以随着地图旋转，但触摸监听器会留在屏幕上的其他位置。

有人知道如何引用标记位置或如何修复它？

谢谢你！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T01:54:53.987

每当您的地图被指南针旋转时，使用 mapView.postInvalidate() 刷新标记。我不完全确定这是否会奏效，因为我从未遇到过这种情况。请让我知道会发生什么。

# algorithm - 停在无限街道上的汽车：找到汽车并计算复杂性

> ID：12187473
> 
> 赞同：2
> 
> 时间：2012-08-29T22:38:20.107
> 
> 标签：algorithm, math, complexity-theory

这是面试时被问到的问题：

你被放置在一条很长的街道上。这是您停放汽车的街道。你必须在这条街上找到你的车。

找到您的汽车的算法是什么，复杂性是什么。他们正在寻找的答案是 O(nlogn)...但是您必须证明为什么它是 o(nlogn)... 提示：要获得这​​个答案涉及很多数学。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T22:42:26.893

我想`n`这里是到汽车的距离。问题是你在一条无限的街道/线的中间，你不知道往哪个方向走。

对此的解决方案是在一个方向上移动 x 个单位，然后向另一个方向移动 2x，然后向前移动 4x，反向移动 8x 等等......所需的步行是~~O(n*logn)~~ O(n)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T23:06:41.823

[这是网上牛路径问题](http://web.mit.edu/jaillet/www/general/online-or.pdf)的一个特例。通常的度量标准是最坏情况下的行驶距离与如果您知道汽车在哪里（[竞争比率](http://en.wikipedia.org/wiki/Competitive_analysis_%28online_algorithm%29)）将行驶的距离相比。这是 9n，实际上是 O(n)，而不是 O(n log n)。但是，您可以进行 O(log n) 方向的更改。

# maven - 如何使用 maven 将任意二进制文件部署到 Nexus

> ID：12187483
> 
> 赞同：3
> 
> 时间：2012-08-29T22:39:21.217
> 
> 标签：maven, nexus

我想我遇到了一个 Maven 部署插件错误，但我想在打开错误报告并开始通过源代码查找之前确认我没有做错。

我正在尝试将任意二进制文件（tar.gz、jar、box 等）部署到 maven 存储库。我正在使用的用户位于 settings.xml 文件中，并带有明文密码。用户位于通过角色连接到关系的 LDAP 组中。

该角色有 3 个与之关联的特权。更新、创建、读取依次与存储库目标相关联。

现在使用 wget 用户可以从 repo 中提取数据，并使用这个 curl 命令我可以部署到 repo：

```
curl --request PUT --user USERNAME:PASSWORD https://NEXUS_URL/nexus/content/repositories/REPO_NAME/path/to/file/with/groupid/version/iamafile.jar \
--data @./iamafile.jar  -H Content-Type:application/java-archive --verbose 
```

这工作正常，http 201 并添加了文件。当我使用类似的 mvn deploy 命令时：

```
mvn deploy:deploy-file --settings /path/to/settings.xml \
-Durl=https://NEXUS_URL/nexus/content/repositories/REPOSITORYID -Dfile=iamafile.jar \
-DrepositoryId=REPOSITORYID -DartifactId=ARTIFACTID -DgroupId=GROUPID \
-Dversion=VERSION 
```

我收到一个 http 401 未经授权的错误。

有[多个关于此的](https://issues.sonatype.org/browse/NEXUS-3048) [错误](http://jira.codehaus.org/browse/MNG-4469)报告，但据说它们已得到修复。使用具有相同版本、artifcatId 等值的 pom 文件 `mvn deploy`可以正常工作。

我是否发现了一个错误，还是我使用不当？

编辑：

我打开了[这个](http://jira.codehaus.org/browse/MDEPLOY-155?page=com.atlassian.jira.plugin.system.issuetabpanels%3aall-tabpanel)关于这个问题的错误。如果开发人员最终说这不是错误，如果有人没有击败我，我会添加它作为答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-28T16:56:33.040

您需要另外指定 -DrepositoryId

# java - EventSource 中的错误处理

> ID：12187484
> 
> 赞同：6
> 
> 时间：2012-08-29T22:39:22.293
> 
> 标签：java, javascript, html, event-sourcing, server-sent-events

我正在尝试制作一个使用 EvenSource 对象（在 javascript 中）来制作服务器发送事件（彗星）的页面。我阅读了很多关于它的教程，但没有找到解释以下问题的教程：

1.  当我订阅 EventSource 的“onerror”事件时 - 我得到的参数类型是什么？我怎么知道究竟是什么错误？

2.  我知道 EvenSource 有一个就绪状态，它的变化取决于浏览器。为什么每次“onmessage”事件发生后我的 readystate 都变为 0？（我使用铬）。

3.  我如何证明我与服务器的连接保持连接而不是每次都重新连接？

浏览器：铬。

服务器端：Java（如果相关，我制作的示例在 Java EE 预览版中。**但我将在 WebLogic 10R3 上工作。**

在我的示例中发生的情况是数据正在从服务器发送到客户端，然后发生“onerror”事件（readystate 为 0），3 秒后（chrome 的默认值）它重新连接并再次发送数据。

javascript代码：

```
var source = new EventSource("TrySRV");
source.onmessage = function(event){
    alert(event.data);
}

source.onerror = function(event){
    alert(source.readystate);
} 
```

Java 代码：

```
response.setHeader("Content-Type", "text/event-stream");
response.setHeader("Cache-Control", "no-cache");
response.getWriter.write("Hello World"); 
```

如果还有什么你想知道的——告诉我。希望你能帮助我。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-02T14:47:05.723

您需要在服务器上保持连接，而不是响应它并关闭。

请参阅[http://jcp.org/en/jsr/detail?id=315](http://jcp.org/en/jsr/detail?id=315)或 Glassfish / Grizzly / Jetty 服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-01T21:37:26.907

尝试使用：

`response.getWriter.write("data:Hello World")`

根据 w3schools：输出要发送的数据（始终以“数据：”开头）

[http://www.w3schools.com/html/html5_serversentevents.asp](http://www.w3schools.com/html/html5_serversentevents.asp)

# sql - Coldfusion：SELECT FROM QoQ WHERE X in (SELECT Y FROM QoQ) 不起作用

> ID：12187486
> 
> 赞同：0
> 
> 时间：2012-08-29T22:39:55.850
> 
> 标签：sql, coldfusion, qoq

在 CF 中，我正在尝试做一个 QoQ，其中行位于其他行的列表中。基本上将一些代码从 cftags 移动到 cfscript（为什么不重要）。在标签中，我们有一个主查询，我们有几个可以做一些繁重工作的嵌套。我将其移至 cfscript 并具有以下有效语法：

```
var submissionList = new Query(dbtype="query", QoQsrcTable=ARGUMENTS.answers, sql="
SELECT submission_id FROM QoQsrcTable GROUP BY submission_id
").execute().getResult();
var submissions = new Query(dbtype="query", QoQsrcTable=ARGUMENTS.answers, sql="
    SELECT * FROM QoQsrcTable WHERE submission_id IN (#submissionList.submission_id#)
").execute().getResult(); 
```

我尝试了以下方法，但它无法正常工作：

```
var submissions = new Query(dbtype="query", QoQsrcTable=ARGUMENTS.answers, sql="
    SELECT * FROM QoQsrcTable WHERE submission_id IN (SELECT submission_id FROM QoQsrcTable GROUP BY submission_id)
").execute().getResult(); 
```

我认为第二个例子应该有效。我试过以各种方式弄乱它。但似乎无法弄清楚我做错了什么。也许嵌套的 QoQ 不能那样工作。有没有另一种方法可以在没有两块代码的情况下完成我正在尝试的事情？只是这样它更具可读性，我不必两次分配变量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T08:49:33.957

QoQ 不支持子查询。这就是它的长处和短处。

[文档](http://help.adobe.com/en_US/ColdFusion/10.0/Developing/WSc3ff6d0ea77859461172e0811cbec0e4fd-7ff9.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T03:19:56.363

在 Coldfusion 10 或 Railo 4 中，您可以利用 Underscore.cfc 的groupBy[函数](http://russplaysguitar.github.com/UnderscoreCF/)[以](http://russplaysguitar.github.com/UnderscoreCF/#groupBy)更少的代码完成您想要的：

```
_ = new Underscore();// instantiate the library    

submissions = _.groupBy(arguments.answers, 'submission_id'); 
```

`groupBy()`返回一个结构，其中键是组元素的值（在本例中为`submission_id`）。

（免责声明：我写了 Underscore.cfc）

# c# - 在 C# 中模仿 PHP 的 ksort

> ID：12187487
> 
> 赞同：2
> 
> 时间：2012-08-29T22:39:58.050
> 
> 标签：c#, php, linq, ksort

我从没想过我会问这个……我需要一种`ksort`在 C# 中模仿 PHP 函数的方法。

这就是问题所在... PHP 是这样做的...

**PHP代码**

```
$arr = array(
    "tagValues" => "asdfasd",
    "email" => "asdfasd",
    "referrer" => "asdfasd",
    "tags" => "asdfasd",
);

echo "Base array \n\n";
print_r($arr);

ksort($arr);

echo "\n\nksort'ed array \n\n";
print_r($arr); 
```

**PHP 输出**

```
Base array 

Array
(
    [tagValues] => asdfasd
    [email] => asdfasd
    [referrer] => asdfasd
    [tags] => asdfasd
)

ksort'ed array 

Array
(
    [email] => asdfasd
    [referrer] => asdfasd
    [tagValues] => asdfasd
    [tags] => asdfasd
) 
```

如果我在 C# 中执行此操作...

```
string[] sortedKeys = form.AllKeys.OrderBy(x => x).ToArray(); 
```

它以不同的顺序出现。`tags`will be before `tagValues`，因为它理应如此。这是真正的字母顺序。

我的理解是`ksort`对数组进行某种区分大小写的 ASCII 工作，这就是为什么它以不同的顺序出现的原因。

***如何在 C# 中实现它？***最好使用 LINQ。谢谢！

*对于那些对背景故事感兴趣的人...*

我基本上是在尝试创建一个输入参数的 MD5 哈希，按照[FastSpring](http://www.fastspring.com/) API 的 alpha 顺序排序。当我翻译成 C# 时，他们的 PHP 代码片段的运行方式与我预期的不同，因此哈希值总是不正确的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T22:50:41.913

关键字是[*StringComparer.Ordinal*](http://msdn.microsoft.com/en-us/library/system.stringcomparer.ordinal.aspx)

```
string[] sortedKeys= form.AllKeys.OrderBy(x => x,StringComparer.Ordinal).ToArray(); 
```

# asp.net-membership - 我如何知道我的主机上是否安装了 Universal Membership Providers？

> ID：12187488
> 
> 赞同：1
> 
> 时间：2012-08-29T22:39:59.390
> 
> 标签：asp.net-membership, membership-provider

我将使用 MVC 4 开发一个新的 Web 应用程序。它将托管在共享服务器上（其中一个 5 美元/月的网站：sqlservermart.com）

已经有几年了，看起来有一个新的“通用会员提供者”而不是旧的会员提供者。我的问题是，如果 .NET 4.0 在远程服务器上，我是否可以假设通用成员资格提供程序可用？如果不是，作为一部分安装的提供程序是什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T17:04:08.103

通用提供程序未随 .NET Fx 一起安装。它是一个 nuget 包，您必须将其安装在您的项目中。当您将项目发布到远程服务器时，您必须发布通用提供程序 dll，该 dll 将位于您的应用程序 [http://nuget.org/packages/Microsoft.AspNet.Providers.Core的 bin 中](http://nuget.org/packages/Microsoft.AspNet.Providers.Core)

# intellij-idea - 使用 IntelliJ IDEA，我如何知道一个类有多少方法？

> ID：12187489
> 
> 赞同：7
> 
> 时间：2012-08-29T22:40:02.690
> 
> 标签：intellij-idea, metrics

我正在使用 IntelliJ IDEA。

我怎么知道一个类有多少方法？是否有任何插件可以查看有关方法数量的指标？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-29T23:12:08.533

试试[**MetricsReloaded**](http://plugins.intellij.net/plugin/?idea&pluginId=93)插件。

帮助 | 寻找行动 | 计算指标。

[创建启用](https://i.imgur.com/0Dk3zJO.png)**CSO**的[新空配置文件](https://i.imgur.com/UueL2mM.png)-类指标、类大小（操作）：

 **[![公民社会组织](../Images/dc79636334d5bc4749f8e1df0ce9a828.png)](https://i.imgur.com/SlBtkiH.png)

运行配置文件，它将显示每个类的方法数：

[![结果](../Images/3d6486d7ddf4a062dfad5cab9841ec52.png)](https://i.imgur.com/CjnBdec.png)

您可能还想启用[ISO（接口大小）](https://i.imgur.com/xOkuwof.png)指标。**

# jquery - SlideJS 改变宽度

> ID：12187491
> 
> 赞同：0
> 
> 时间：2012-08-29T22:40:11.777
> 
> 标签：jquery, width

我正在寻找一种改变 SlideJS 宽度的方法。我想让它全部 950 像素，包括箭头。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T03:50:01.623

只需设置容器的大小并使用 CSS 定位箭头。这是我使用的代码示例：http: [//jsfiddle.net/planxdesign/LpPTY/](http://jsfiddle.net/planxdesign/LpPTY/)

# google-drive-api - 如何使用 Google Drive SDK 访问电影文件的预览视频？

> ID：12187492
> 
> 赞同：2
> 
> 时间：2012-08-29T22:40:13.633
> 
> 标签：google-drive-api

在 iOS 版 Google Drive 应用程序中，当我打开视频文件时，我会立即通过低质量版本预览该文件。这不是原始文件。

那么你知道如何获取这个预览视频的 url 吗？

非常感谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-04T03:15:42.280

使用`embedLink`文件的字段。它包含一个流媒体视频播放器的链接（YouTube，几乎），适用于移动应用程序。

# c++ - 编译没有 _UNICODE 的 MongoDB c++ 驱动程序

> ID：12187493
> 
> 赞同：1
> 
> 时间：2012-08-29T22:40:39.827
> 
> 标签：c++, mongodb, compiler-errors, driver

我正在尝试将 MongoDB c++ 驱动程序编译到我的项目中，但遇到了一个有趣的错误。

在 util/text.h 中，您可以找到以下代码：

```
/* like toWideString but UNICODE macro sensitive */
# if !defined(_UNICODE)
#error temp error 
    inline std::string toNativeString(const char *s) { return s; }
# else
    inline std::wstring toNativeString(const char *s) { return toWideString(s); }
# endif 
```

看起来你应该能够在没有 _UNICODE 定义的情况下编译它，但是这个看似任意的行 #error temp error 会导致失败。在 Github 上，文件的整个生命周期似乎都是这种情况。有谁知道删除它是否安全？

不幸的是，我不能只用 unicode 编译这个项目，因为项目中也有许多 unicode 不兼容的源。

干杯

凯尔

# iphone - iOS 6 - YouTube 应用

> ID：12187494
> 
> 赞同：3
> 
> 时间：2012-08-29T22:40:47.987
> 
> 标签：iphone, objective-c, ios, ios6

目前在 iOS 5 上，我有一个 iPhone 应用程序，其中包含 web 视图，这是 youtube 的视频屏幕截图，当用户点击视频时，视频会打开以填满屏幕并播放......

我想知道 iOS 6 更新是否不适用于我的应用程序，因为我使用的是 Youtube 视频...

有没有人测试过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:45:01.530

我也一直在想这个。根据这篇文章你应该没问题

[http://gigaom.com/mobile/yes-youtube-is-gone-from-ios-6-so-what/](http://gigaom.com/mobile/yes-youtube-is-gone-from-ios-6-so-what/)

“我已经在我自己的 iPhone 4S 上验证了 iOS 的 beta 4 确实删除了 YouTube 应用程序。但我也验证了它确实没有改变任何东西。YouTube 视频的链接打开了 YouTube 的移动网络应用程序并播放得很好。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T22:44:15.347

删除 YouTube 应用并不意味着不支持播放 YouTube 视频。它们仍然可以由浏览器或任何其他应用程序播放。

# php - PHP include() 不加载 config.php

> ID：12187496
> 
> 赞同：1
> 
> 时间：2012-08-29T22:41:01.683
> 
> 标签：php

我正在尝试制作一个简单的脚本，但是当我尝试包含配置文件时，它不会加载。这是我的代码-

```
<?php
$config = include("http://MyWebSite/config.php");
$mysql = mysql_connect($host, $user, $pass);
if (!$mysql) { die(mysql_error()); }
$data = mysql_select_db($database);
if (!$data) { die(mysql_error()); }
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T22:43:17.813

试试这个：

```
include($_SERVER['DOCUMENT_ROOT'] . '/config.php'); 
```

另外，不要将其分配给变量。您只需要将文件包含在脚本中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:44:43.820

你应该这样尝试

```
<?php
include("config.php");
?> 
```

因为在正常的服务器设置中，您不允许直接远程包含文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T22:46:12.713

1) 包含不返回任何内容 2) 包含整个 url 必须由服务器启用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T22:54:01.007

您需要确保文件的路径正确。以下代码将在与您正在运行的脚本相同的目录中查找 config.php：

```
include('config.php'); 
```

如果这不起作用，您可以查看错误日志或使用以下代码打开错误报告：

```
ini_set('display_errors', 1);
ini_set('error_reporting', E_ALL);
include('config.php'); 
```

错误消息现在应该向您显示它在哪里寻找文件。该错误将类似于以下内容：

```
Warning: include() [function.include]: Failed opening 'config.php' for inclusion (include_path='.:/usr/share/pear:/usr/share/php') in /path/to/your/script.php on line 4 
```

上面的消息指出它在以下任何位置都找不到 config.php：

```
 /path/to/your/ 
 /usr/share/pear/
 /usr/share/php/ 
```

# gcc - GIMP 2.6 编译在 Fedora 17 上失败并出现致命错误：gegl.h: No such file or directory

> ID：12187500
> 
> 赞同：1
> 
> 时间：2012-08-29T22:41:18.100
> 
> 标签：gcc, makefile, fedora, gimp, gegl

yum 在 Fedora 17 上安装 GIMP 2.8，但我想使用 2.6，所以我正在尝试编译它。但是，我一直收到这个错误，说它找不到`gegl.h`，它已安装并在包含路径上：

```
[root@life gegl]# pwd
/home/james/packages/gimp-2.6.12/app/gegl

[root@life gegl]# make
gcc -DHAVE_CONFIG_H -I. -I../.. -I../.. -I../.. -I../../app -I../../app /usr/include/gegl-0.1/ -pthread -I/usr/include/gdk-pixbuf-2.0 -I/usr/include/libpng15 -I/usr/include/glib-2.0 -I/usr/lib64/glib-2.0/include   -I/usr/local/include -DG_LOG_DOMAIN=\"Gimp-GEGL\" -DGIMP_DISABLE_DEPRECATED -DGDK_MULTIHEAD_SAFE -DGTK_MULTIHEAD_SAFE  -g -O2 -Wall -Wdeclaration-after-statement -Wmissing-prototypes -Wmissing-declarations -Winit-self -Wpointer-arith -Wold-style-definition -Wformat-security -MT gimp-gegl.o -MD -MP -MF .deps/gimp-gegl.Tpo -c -o gimp-gegl.o gimp-gegl.c
gimp-gegl.c:24:18: fatal error: gegl.h: No such file or directory
compilation terminated.
make: *** [gimp-gegl.o] Error 1

[root@life gegl]# ls -l /usr/include/gegl-0.1/gegl.h 
-rw-r--r--. 1 root root 31086 Nov 18  2011 /usr/include/gegl-0.1/gegl.h 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:53:15.280

请重新运行配置：

```
gcc -DHAVE_CONFIG_H 
  -I. 
  -I../.. 
  -I../.. 
  -I../.. 
  -I../../app 
  -I../../app 
  /usr/include/gegl-0.1/ // THIS IS WRONG: it should be "-I/usr/include/gegl-0.1"
  -pthread 
  ... 
```

还请确保您的“-L”和/或“-l”库路径在链接时也是正确的。

# desire2learn - Desire2Learn Valence API - 文件名中的空格

> ID：12187504
> 
> 赞同：0
> 
> 时间：2012-08-29T22:41:27.283
> 
> 标签：desire2learn

我们正在尝试从储物柜中提取文件和文件夹，但命令 (/d2l/api/le/(D2LVERSION: version)/locker/myLocker/(string: path)) 不喜欢文件或文件夹中的空格姓名。它返回错误请求或无效令牌，具体取决于我们如何尝试处理末尾的空格（即字符串替换为 %20）。

我们如何检索名称中带有空格的文件/文件夹？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T15:21:27.450

我能想到你可能遇到的一些问题。

当您向 D2LUserContext 对象提供 API 路径时，您只需传入 API 路径，其中包含内部空格，而不是转义字符。因此，到一个名为的文件的正确路径`test file name`可能如下所示：

```
/d2l/api/le/1.0/locker/myLocker/firstFolderBelowRoot/test file name 
```

要为此创建经过身份验证的 URL，您将调用

```
yourD2LUserContext.createAuthenticatedUri('/d2l/api/le/1.0/locker/myLocker/firstFolderBelowRoot/test file name', 'GET') 
```

这将形成一个经过身份验证的 URL，您可以使用它来`test file name`从您的储物柜中获取该文件。要获取其包含的文件夹：

```
yourD2LUserContext.createAuthenticatedUri('/d2l/api/le/1.0/locker/myLocker/firstFolderBelowRoot/', 'GET') 
```

请注意，当您要识别储物柜中的文件夹时，该`path`参数*必须*以斜杠结尾。（如果您正在尝试获取一个文件夹，并且您没有尾部斜杠，那么这可能是您的问题的根源。）

获得该 URL 后，您将需要使用某种 HTTP 库来实际进行调用。我们内部的 PHP 开发人员建议在 PHP 中使用 HttpRequest 而不是 cURL。最值得注意的是，您应该调用的 URL 应该在 URL 的路径组件中保留文件或文件夹名称中的空格。

当我使用 Python 客户端对 9.4.1 实例进行测试以从储物柜中获取/放置，或者使用用户上下文对象生成 URL，然后将这些 URL 输入浏览器时，一切似乎都很好。使用 Python 客户端对 10.0.0 测试实例进行测试似乎也有效。

# ruby - 如何在 Ruby 中编写一个简单的 HTTPS 代理服务器？

> ID：12187509
> 
> 赞同：6
> 
> 时间：2012-08-29T22:41:50.673
> 
> 标签：ruby, ssl, https, proxy

我已经看过几个用 Ruby 编写 HTTP 代理的示例，例如[Torsten Becker 的这个要点](https://gist.github.com/74107)，但是我将如何扩展它来处理 HTTPS，也就是“中间人”SSL 代理？

我正在寻找一个简单的源代码框架，我可以扩展它以满足我自己的日志记录和测试需求。

### 更新

我已经在使用[Charles，](http://www.charlesproxy.com/)这是一个类似于 Fiddler 的漂亮 HTTPS 代理应用程序，它基本上是我想要的，只是它被打包在一个应用程序中。我想自己写，因为我对过滤和呈现有特定的需求。

### 更新二

闲逛之后，我对术语的理解要好一些。我不追求完整的“中间人”SSL 代理。相反，它将在我的机器上本地运行，因此我可以尊重它提供的任何 SSL 证书。但是，我需要查看我的请求数据包的解密内容和响应的解密内容。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-30T01:20:26.740

仅作为背景信息，普通 HTTP 代理通过以下`CONNECT`方法处理 HTTPS 请求：它读取主机名和端口，在此端口上建立到此目标服务器的 TCP 连接，`200 OK`然后返回并仅将该 TCP 连接隧道连接到初始客户端（ SSL/TLS 在 TCP 连接之上交换的事实几乎没有相关性）。

这就是`do_CONNECT`if 的方法[`WEBrick::HTTPProxyServer`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/webrick/rdoc/WEBrick/HTTPProxyServer.html)。

如果您想要 MITM 代理，即如果您希望能够查看 SSL/TLS 流量内部，您当然可以使用`WEBrick::HTTPProxyServer`，但您需要更改`do_CONNECT completely`：

*   首先，您的代理服务器需要嵌入一个能够即时生成证书的迷你 CA（如果您愿意绕过浏览器中的警告消息，则可以使用自签名证书）。然后，您将该 CA 证书导入浏览器。
*   当您收到`CONNECT`请求时，您需要生成一个对该主机名有效的证书（最好使用该主机名的 Suject Alt.Name，或在主题 DN 的公用名中），并将套接字升级为 SSL/TLS服务器套接字（使用该证书）。如果浏览器接受信任该证书，那么您从该 SSL/TLS 套接字上获得的就是纯文本流量。
*   然后，您必须处理请求（获取请求行、标头和实体）并通过普通的 HTTPS 客户端库使用它。您也许可以将该流量发送到 的第二个实例`WEBrick::HTTPProxyServer`，但必须对其进行调整以发出传出 HTTPS 请求而不是普通的 HTTP 请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T23:31:21.147

那个博客是没有办法写代理的。这很容易：您只需接受一个连接，读取一条告诉您要连接什么的行，尝试上游连接，如果失败则发送适当的响应并关闭套接字，否则只需*同时开始双向复制字节，*直到EOS 发生在两个方向。HTTPS 的唯一区别是您必须使用 SSL 而不是纯文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T23:35:49.833

根据我的经验，HTTPS 远非“简单”。您是否需要一个可以从您自己的机器上捕获流量的代理？有几个应用程序，例如[Fiddler](http://www.fiddler2.com/fiddler2/)。或谷歌寻找替代品。附带调试网络流量所需的一切。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T23:43:18.827

Webrick 可以代理 ssl：

```
require 'webrick'
require 'webrick/httpproxy'
WEBrick::HTTPProxyServer.new(:Port => 8080).start 
```

# git - 无法推送主 heroku PHP 应用程序（昨天工作）

> ID：12187510
> 
> 赞同：0
> 
> 时间：2012-08-29T22:41:54.647
> 
> 标签：git, heroku, push, main

我正在尝试推送一个 PHP 应用程序。昨天工作得很好。今天它抛出错误。Submodule path 'sdk' 的错误可能与它有关，但正如我所说，除了一些小的代码调整之外，自昨天以来没有大的变化！

```
Benjamins-MacBook-Pro:everyvotematters benjamin$ git status
# On branch master
# Your branch is ahead of 'everyvotematters/master' by 4 commits.
#
nothing to commit (working directory clean)
Benjamins-MacBook-Pro:everyvotematters benjamin$ git push everyvotematters master
Counting objects: 24, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (19/19), done.
Writing objects: 100% (20/20), 4.49 KiB, done.
Total 20 (delta 7), reused 0 (delta 0)

-----> Heroku receiving push
-----> Git submodules detected, installing
       Submodule 'sdk' (https://github.com/facebook/facebook-php-sdk.git) registered for path 'sdk'
       Initialized empty Git repository in /tmp/build_awiw4oll8o2g/sdk/.git/
       Submodule path 'sdk': checked out '98f2be163c96a51166354e467b95dd38aa4b0a19'
 !     Heroku push rejected, no Cedar-supported app detected

To git@heroku.com:everyvotematters.git
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:everyvotematters.git'
Benjamins-MacBook-Pro:everyvotematters benjamin$ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T13:24:29.907

嗯，“没有检测到雪松支持的应用程序”很奇怪。`index.php`我怀疑您已经修改了您的应用程序，以至于根文件夹中不再存在？这就是 Heroku 检测它是 PHP 应用程序的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T21:19:23.137

我有一个本地版本的 SDK 文件夹。这很好，然后有一天它就停止了对我的工作。

首先复制您的 SDK 文件夹，然后运行：

```
git rm sdk
git commit -am "removing sdk folder"
git push heroku master 
```

然后我将文件夹复制回来，重新运行提交和推送命令这为我修复了它。

# r - 推特追随者连通性 R Python

> ID：12187512
> 
> 赞同：1
> 
> 时间：2012-08-29T22:42:15.833
> 
> 标签：r, twitter, igraph, sna

我正在尝试获取 Twitter 中某个机构的追随者的邻接矩阵以及它们之间的联系。我想看看追随者之间的关系。我知道从邻接矩阵开始做什么，`igraph`并且`statnet`包允许这样做。但是我在获取矩阵时遇到了麻烦。

我尝试使用`twitteR`包来一一获取用户，但我超时或机器挂起。我还没有看到这样做，但我确信有更短的方法。关于此事的任何见解或参考资料都会很棒。

谢谢。

# c# - “预测”下一个模型 ID

> ID：12187520
> 
> 赞同：0
> 
> 时间：2012-08-29T22:42:38.567
> 
> 标签：c#, asp.net-mvc

嘘...

我认为这可以做到，但我现在无法弄清楚。

所以我创建了这个应用程序，它运行良好。但由于某种原因（太长无法解释抱歉）我需要预测下一个 ID 来自数据表。

请注意，最后一个 id + 1 将不起作用。我试过这个。

```
var lastProperty = db.Properties.OrderByDescending(p => p.PropertyID).FirstOrDefault();
int propID;
if (lastProperty == null)
{
    propID = 1;
}
    else
{
    propID = 1 + lastProperty.PropertyID;
} 
```

只要属性不被删除，它就可以工作......一旦删除，它当然会搞砸，因为假设我们 delete `6th Property`，最后一个将是`5th`现在，并且使用该代码我们将得到`6` `5(last one) + 1`，并且我保存了`Property`与`PropertyID` `6`我从该代码中获得的模型相关的模型，下一个将`Property`是 7，因为数据库仍然记得 6 存在并已被删除...失败...`PropertyID``Property`

另外，我无法在保存后添加此`Property`内容，我意识到这似乎是一种解决方案，但事实并非如此。它必须被预测。

谢谢...请帮忙...

**更新**

这是我要完成的用例。

`Property`具有`ID` `Name` `DataType`属性的模型。 `List`具有`ID` `ListValue` `PropertyID`属性的模型。

当在`Property`中创建新用户类型`Name`，并从预制下拉列表中`DataType`选择一个值，如果该值是`List`，它会打开包含列表框、文本框和按钮 ( `add_Button`) 的附加表单。用户在文本框中输入值，然后单击 将`add_Button`其添加到`List`。

`List`列表框是从模型填充的，并且`add_Button`，将文本框中的值保存到的`ListValue`属性中`List`，正如您所见，我试图通过预测它的值来手动`PropertyID`添加`List`...

然后，在完成通过文本框添加所有想要的元素后，通过单击`Create`按钮，`Property`然后保存。

希望这已经足够清楚了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T22:44:08.673

您似乎想知道标识列的当前状态：

```
SELECT IDENT_CURRENT('Table') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T06:54:00.407

当需要在提交到 Db 之前知道您的主键值将是什么时，您可以使用唯一标识符 (GUID) 作为您的 Pk `Property`，因此作为您的`List`实体的 Fk。这样你就可以自己创造它，而且它在承诺上总是独一无二的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T23:04:28.787

您提到实体框架，您是否尝试过调整模型？

`StoreGeneratedPattern`可以调整以允许在存储到数据库时自动更新本地模型。

# actionscript-3 - 自上而下填充网格中的开放空间

> ID：12187522
> 
> 赞同：0
> 
> 时间：2012-08-29T22:43:05.397
> 
> 标签：actionscript-3, grid, match

我正在编写一个匹配三引擎，我成功地使用巨大的循环来创建匹配项来查找匹配项。关于如何用项目填充空白空间（下拉到空白空间）并在没有过多循环和 if 语句的情况下创建新项目的任何想法？

到目前为止，这是我的相关代码。

```
public var rows:uint = 8;
public var cols:uint = 7;
public var cell:Array = new Array();
public var plot:Array = new Array();

public var height:int;
public var width:int;

public var relativePositions:Array = [{name:'top', position:-1}, {name:'bottom', position:1}, {name:'left', position:rows*-1}, {name:'right', position:rows*1}];
public var dictionary:Dictionary = new Dictionary();
public var matches:Array = new Array();

public function createGrid(target:*, displayObject:*, spacer:int) : void {

        var iterator:uint = 0;
        for(var c:uint = 0;c<cols;c++){ 
            for(var r:uint = 0;r<rows;r++){                                         
                cell[iterator] = createGamePiece();
                Sprite(cell[iterator]).name = String(iterator);
                Sprite(cell[iterator]).addEventListener(MouseEvent.CLICK, _handleGamePiece_CLICK);
                Sprite(cell[iterator]).addEventListener(MouseEvent.MOUSE_OVER, _handleGamePiece_MOUSE_OVER);
                Sprite(cell[iterator]).addEventListener(MouseEvent.MOUSE_OUT, _handleGamePiece_MOUSE_OUT);
                cell[iterator].y = cell[iterator].height  * r + (spacer*r);
                cell[iterator].x = cell[iterator].width * c + (spacer*c);
                GamePiece(cell[iterator]).positionX = cell[iterator].x;
                GamePiece(cell[iterator]).positionY = cell[iterator].y;
                GamePiece(cell[iterator]).positionRow = r;
                GamePiece(cell[iterator]).positionCol = c;
                target.addChild(cell[iterator]);
                dictionary[String(iterator)] = cell[iterator]
                iterator++
            }
        } 

    }

public function findRelativeMatches(targetSprite:Sprite) : void {

        targetSprite.alpha = .5;
        var rootPosition:Number = Number(targetSprite.name);

        for ( var i:int = 0; i < relativePositions.length; i ++ ) {
            var key:String = String(rootPosition + relativePositions[i].position);
            // to do >> Not hardcoded to 'Pig'
            if (findSprite(key) != null && GamePiece(targetSprite).color == GamePiece(findSprite(key)).color && GamePiece(findSprite(key)).found == false) {
                var sprite:Sprite = findSprite(key);
                sprite.alpha = .5;
                GamePiece(sprite).found = true;
                matches.push(sprite);
                findRelativeMatches(sprite);
            };
        };

        targetSprite.addEventListener(MouseEvent.MOUSE_OUT, function() : void {
            if ( matches.length != 0 ) {
                for ( var j:int = 0 ; j < matches.length ; j++ ) {
                    Sprite(matches[j]).alpha = 1;
                    GamePiece(matches[j]).found = false;
                }
                matches.splice(0);
            }
        });
    }

public function findSprite(key:String) : Sprite {
        var sprite:Sprite;
        dictionary[key] != undefined ? sprite = dictionary[key] : null;
        return sprite;
    }

protected function _handleGamePiece_CLICK(event:MouseEvent):void
    {
        for ( var j:int = 0 ; j < matches.length ; j++ ) {
            var sprite:Sprite = matches[j];
            view.removeChild(matches[j]);

        }

        matches.splice(0);
    }
public function createGamePiece() : Sprite {
        var gamePiece:GamePiece = new GamePiece();
        return gamePiece;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T04:07:42.710

你想向下折叠你的网格，对吧？常见的算法是从每一行的底部向上，找到第一个空白空间的一个索引，另一个用于空白空间上方的第一个占用空间，然后在找到后交换这些值，迭代到顶部。但是您不会以任何可访问的形式存储网格！您应该创建一个网格对象，例如一个精灵向量的向量，并在您四处移动时在其中分配值。像这样：

```
var GRID:Vector.<Vector.<Sprite>>; // this should be allocated at createGrid
// populate GRID with your sprites once generated:
// put the following into your inner loop in CreateGrid:
GRID[r][c]=cell[iterator];

// and the following into your removal of matches[] sprites:
GRID[GamePiece(sprite).positionRow][GamePiece(sprite).positionCol]=null; // release link from GRID

// now to move grid objects:
function DropAll():void {
    var i:int;
    var j:int;
    for (i=GRID.length-1;i>=0;i--) {
        var lastEmpty:int=-1;
        for (j=GRID[i].length-1;j>=0;j--) {
            if (GRID[i][j]) {
                if (lastEmpty>0) {
                    GRID[i][lastEmpty--]=GRID[i][j];
                    // relocate your sprite properly here
                    GRID[i][j]=null;
                } // else we're still at full part of grid, continue
            } else if (lastEmpty<0) lastEmpty=j;
        }
    }
} 
```

要正确实例化 GRID，您需要分配填充“空”值的所需长度的向量。此外，“GRID”本身是一个向量，也需要实例化。

```
GRID=new Vector.<Vector.<Sprite>>();
for (i=0;i<rows;i++) {
    var a:Vector.<Sprite>=new Vector.<Sprite>(cols);
    GRID.push(a);
} 
```

完成此操作后，您可以通过直接在其中分配链接来填充 GRID，例如`GRID[r][c]=gameObject;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T22:27:32.807

这实际上是我想要的。一种无需遍历整个电路板即可折叠的方法。这样，我只需遍历已删除的项目。

```
protected function _handleGamePiece_CLICK(event:MouseEvent):void
    {
        for ( var j:int = 0 ; j < matches.length ; j++ ) {
            var oldSprite:Sprite = matches[j];
            moveAllPiecesDown(oldSprite);
            view.removeChild(oldSprite);
            oldSprite = null;
        }
        matches.splice(0);
    }

private function moveAllPiecesDown(oldSprite:Sprite):void
    {
        var piecesAbove:int = GamePiece(oldSprite).positionRow;
        var index:int = int(oldSprite.name);

        for( var i:int = 0; i < piecesAbove; i ++ ) {
            var spriteAbove:Sprite = Sprite(view.getChildByName(String(index-(1+i))));
            if(spriteAbove) {
                spriteAbove.y = spriteAbove.y + spriteAbove.height + 1;
                spriteAbove.name = String(Number(spriteAbove.name)+1);
                GamePiece(spriteAbove).textField.text = spriteAbove.name;
                delete dictionary[spriteAbove.name];
                dictionary[spriteAbove.name] = spriteAbove;
            }
        }
    } 
```

# php - Zend Framework Navigation，转义选项以在标题中查看 html？

> ID：12187531
> 
> 赞同：2
> 
> 时间：2012-08-29T22:44:25.973
> 
> 标签：php, zend-framework, zend-navigation

好吧，我在任何地方都找不到这个选项。我正在通过数据库生成 Zend Navigation，并通过递归生成多维数组，蛋糕。因此，其中一些标题中包含 html 或 html 特殊字符。那么，为什么我不能在任何地方找到转义选项，以便我可以显示这些东西。任何对这种框架选项迷宫的见解将不胜感激。

```
$this->navigation()
   ->menu()
   ->setUlClass('navbar')
   ->setMinDepth(0)
   ->setMaxDepth(0)
   ->setRenderParents(false) 
   ->setOnlyActiveBranch(false); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T04:34:46.023

您可以重新定义`Zend_View_Abstract` `escape()`行为，默认情况下使用`htmlspecialchars`.

引导程序中的示例：

```
protected function _initNav()
{
    $this->bootstrap('view');
    $view = $this->getResource('view');
    $view->setEscape(function($var){ 
        return $var; });
} 
```

# nginx - 为什么 ^~ 不停止在 nginx 中处理路由规则？

> ID：12187534
> 
> 赞同：1
> 
> 时间：2012-08-29T22:44:56.440
> 
> 标签：nginx, webserver, rewrite

所以我有 2 条路线，第 1 条路线不会停止路线匹配，正如文档所说的那样：

```
location ^~ /p/ {
    root /www/domain.com/;
    try_files $uri $uri/ /path/index.html;
}

location ^~ /v/ {
    root /www/domain.com/;
    try_files $uri $uri/ /path/index.html;
}

location ^~ / {
    root /www/domain.com/php_www/;
    try_files $uri $uri/ /index.php;

        location ~* \.(?:php|html)$ {   
            try_files $uri =404;
            fastcgi_pass 127.0.0.1:9000;
            include /etc/nginx/fastcgi_params;
        }

        auth_basic "Staging";
        auth_basic_user_file /www/.htpasswd;

} 
```

所以如果我有这样的网址：

```
http://domain.com/p/1234567890 
```

它匹配最后一条路线，而不是第一条路线。问题浮出水面是因为我们的一个人在应用程序中添加了一个页面：

```
http://domain.com/privacy 
```

这是由 FIRST 路线拾取的？？这就是问题的来源。

我遇到的问题是^~。在文档中，它说一旦匹配，它将停止匹配，但是最后一条路线始终是加载的路线。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T17:40:42.880

升级到最新的 nginx，并重新排序了一些指令，现在一切正常。

# javascript - windows 8 appbar 抢焦点

> ID：12187540
> 
> 赞同：3
> 
> 时间：2012-08-29T22:45:49.673
> 
> 标签：javascript, windows-8, microsoft-metro

我目前正在使用 HTML+Javascript 在 Windows 8 上开发应用程序。我在我的应用程序中使用 iFrame，并为键盘事件添加了 keyeventlisteners。

但是，当我右键单击鼠标时，appbar 会出现，它会抢走我的应用程序的焦点，所以现在所有的键盘事件都没有做任何事情。但是，如果再次右键单击以关闭应用栏，一切都会再次正常工作。

有谁知道有焦点的应用栏是否是微软设计的？还是将焦点带回我的 iFrame 的一种方式？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:25:37.983

这是故意的；这是为了让用户可以使用他们想要显示应用栏的任何方法，然后使用键盘来控制它。验证行为的一个好方法是在 VS 中创建默认的“网格模板”应用程序，并取消注释 Appbar，添加一些额外的按钮，然后测试行为。

但是请注意，粘性应用栏和非粘性应用栏之间的*期望*有所*不同*。在非粘性的情况下，焦点需要移动到应用栏，因为没有其他方法可以在不导致应用栏关闭的情况下（使用键盘时）。但是，对于sticky，它只能通过使用手势（右键单击，或win-z，或轻扫触摸）来解除，默认情况下不将焦点放在其中是可以的。

您的解决方案可能是在文档级别而不是在 IFRAME 中附加您的偶数处理程序，由于两个上下文之间消息传递的性质，这将是复杂的。

# php - 如有必要，在 php 中将分钟转换为小时

> ID：12187543
> 
> 赞同：0
> 
> 时间：2012-08-29T22:46:39.513
> 
> 标签：php

我试过这个：

```
$total_time_minutes = '132';
$total_time_hours = '26';

if($total_time_minutes > 60)
{
    $time = strtotime( $minutes . ' minutes'); 

    $time = date('H:i', $time); 

    $time = explode(':', $time); 

    $hours = $time[0]; 
    $minutes = $time[1]; 

    $total_time_hours += $hours;
    $total_time_minutes = $minutes;
} 
```

如果我从中输出 $total_time_hours 和 $total_time_minutes 它会给我：26:44，这是不正确的。

它应该给我 28:12，这里有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T22:48:35.893

```
$total_time_minutes = '132';
$total_time_hours = '26';

if($total_time_minutes > 60)
{
    $hours = floor($total_time_minutes / 60);
    $minutes = $total_time_minutes % 60;

    $total_time_hours += $hours;
    $total_time_minutes = $minutes;
} 
```

`date()`如果用于 unix 时间戳格式，则为函数。您拥有的不是有效的 unix 时间戳（是的，我知道它可能很小，但在这种特殊情况下不是）

# iphone - 在表视图控制器中加载数据

> ID：12187545
> 
> 赞同：0
> 
> 时间：2012-08-29T22:46:55.753
> 
> 标签：iphone, objective-c, ios

我正在处理的 iOS 应用程序中有一个表格视图，我想加载数据并仅在单击键盘上的搜索键时才开始搜索。目前，当我开始在搜索字段中输入时，它会加载数据，但是，由于有很多数据，这会产生很多延迟。

我尝试过在线查找，但大多数教程或示例都指的是立即加载数据或在用户在搜索栏中输入时加载数据。

任何建议将不胜感激，谢谢！

## 更新：已解决

***[感谢 Tim & channi 的建议]***

下面的代码是更新的解决方案：

```
- (void)filterContentForSearchText:(NSString*)searchText scope:(NSString*)scope
{
/* loads the file into a dictionary */
    NSString *myFile=[[NSBundle mainBundle] pathForResource:@"test" ofType:@"plist"];

    dict = [[NSDictionary alloc] initWithContentsOfFile:myFile];
    recipes = [dict allKeys];

    NSPredicate *resultPredicate = [NSPredicate
                                predicateWithFormat:@"SELF contains[cd] %@",
                                searchText];

    searchResults = [recipes filteredArrayUsingPredicate:resultPredicate];
}

-(void)searchBarSearchButtonClicked:(UISearchBar *)searchBar
{
    [self filterContentForSearchText:self.searchBar.text scope:[[self.searchDisplayController.searchBar scopeButtonTitles] objectAtIndex:[self.searchDisplayController.searchBar selectedScopeButtonIndex]]];

/* reloads the searchResults table view with the new data */
    [self.searchDisplayController.searchResultsTableView reloadData];
    [self.searchBar resignFirstResponder];
}

-(void)searchBarCancelButtonClicked:(UISearchBar *)searchBar
{
/* Sets both arrays to nil so main table view is a clean view */
    searchResults = nil;
    recipes = nil;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:40:59.160

看看[`searchDisplayController:shouldReloadTableForSearchString:`](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UISearchDisplayDelegate_Protocol/Reference/Reference.html#//apple_ref/doc/uid/TP40008226-CH1-SW2)你的 UISearchDisplayController 的委托方法。如果您`NO`从该方法返回，您的搜索显示控制器将不会立即尝试重新加载结果，因此您可以避免在用户输入时出现延迟。稍后，当用户按下搜索按钮时，您可以强制重新加载结果表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T00:18:54.780

我想你可能会`-(void)filterContentForSearchText:(NSString*)searchText scope:(NSString*)scope`在方法中调用`-(void)searchBarSearchButtonClicked:(UISearchBar *)searchBar`方法

让我知道它是否有效

# c++ - typedef 改变含义

> ID：12187549
> 
> 赞同：20
> 
> 时间：2012-08-29T22:47:58.127
> 
> 标签：c++, typedef

当我编译以下代码片段时`g++`

```
template<class T>
class A
{};

template<class T>
class B
{
    public:
        typedef A<T> A;
}; 
```

编译器告诉我

```
error: declaration of ‘typedef class A<T> B<T>::A’
error: changes meaning of ‘A’ from ‘class A<T>’ 
```

另一方面，如果我`typedef`将

```
typedef ::A<T> A; 
```

一切都编译得很好`g++`。Clang++ 3.1 不关心任何一种方式。

为什么会这样？第二个行为标准是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-29T23:07:21.813

g++ 是正确的并且符合标准。从 [3.3.7/1] 开始：

> 在 S 类中使用的名称 N 应在其上下文中引用相同的声明，并且在 S 的完整范围内重新评估时。违反此规则不需要诊断。

在 typedef 之前，`A`引用了`::A`，但是通过使用 typedef，您现在`A`可以引用被禁止的 typedef。但是，因为`no diagnostic is required`，clang 也符合标准。

[jogojapan 的评论](https://stackoverflow.com/questions/12187549/typedef-changes-meaning/12187709#comment16321921_12187709)解释了这条规则的原因。对您的代码进行以下更改：

```
template<class T>
class A
{};

template<class T>
class B
{
    public:
        A a; // <-- What "A" is this referring to?
        typedef     A<T>            A;
}; 
```

由于类范围的工作方式，`A a;`变得模棱两可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-30T18:47:39.327

我将在 Jesse 的回答中添加关于 GCC 在编译中看似特殊的行为：

```
typedef A<T> A; 
```

对比

```
typedef ::A<T> A; 
```

这也适用于以下形式的 using 语句：

```
using A =   A<T>;
using A = ::A<T>; 
```

在 GCC 中似乎发生的事情是，在编译声明 B::A 的 typedef/using 语句期间，符号 B::A 成为**using 语句本身内的**有效候选者。即当说`using A = A<T>;`或`typedef A<T> A;`GCC 考虑两个`::A`和`B::A`有效的候选人时`A<T>`。

这似乎很奇怪，因为正如您的问题所暗示的那样，您不希望新别名 A 成为 typedef 本身内的有效候选者，但正如 Jesse 的回答也所说，在类中声明的任何内容都对类中的其他所有内容可见 -在这种情况下，显然甚至是声明本身。这种类型的行为可以以这种方式实现以允许递归类型定义。

您找到的解决方案是在 typedef 中准确地为 GCC 指定您所指的 A ，然后它不再抱怨。

# jquery - Rails：在 js.erb 文件 3.2.7 中呈现部分的正确方法是什么

> ID：12187551
> 
> 赞同：1
> 
> 时间：2012-08-29T22:48:08.367
> 
> 标签：jquery, ruby-on-rails

我读过帖子说不可能在 js.erb 文件中呈现部分内容。实现此目的的正确方法是什么？

我正在尝试使用 jquery ui 在对话框中呈现联系表单。

```
var contactHtml = $('<div></div>').html("test").dialog({
    autoOpen: false,
    title: 'hi'
}); 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T22:59:39.133

```
 $('<div></div>').html("<%= j(render :partial => 'example/file') %>") 
```

只要记住用 j 转义你的渲染调用（与 escape_javascript 同义）。在处理 ajax 调用时，您会经常使用这种方法。

编辑

如果您从资产文件夹中尝试此操作，则这是不可能的，您将收到未定义的方法渲染错误。这是一个[类似的问题](https://stackoverflow.com/questions/8370399/rails-js-erb-file-cannot-find-method-render)以获取更多详细信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T00:29:59.923

我仍然为我的表单使用了一个部分，但我用 ajax 渲染了它。

在我的 js.erb 文件中

```
 var contactHtml = $('<div></div>').dialog({
    autoOpen: false,
    title: 'Get a Free Estimate',
    minWidth:400,
    close: function(){$(this).empty();}
});
$('#consultation').click(function(){
    $.get('/contact_form', function(data){
        contactHtml.append(data);
    });
    contactHtml.dialog('open');
    return false;
}); 
```

路线：

```
 match "contact_form" => "application#contact_form", :via => :get 
```

应用控制器：

```
 def contact_form
  @contact = Refinery::Contacts::Contact.new
  render :partial => "/contact_form", :locals => {:contact => @contact}
  end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T23:00:23.607

通常，您可以在 js.erb 中执行以下操作：

```
$("yourclass").javascript_action("<%= escape_javascript(render('partial_name', :local_var_name => @local_var_name)) %>"); 
```

并在您的部分通行证当地人中：

```
 <%= render 'partial_name', :local_var_name => local_var_name %> 
```

希望这可以帮助！

# javascript - 如何让 twitter 引导子菜单在左侧打开？

> ID：12187554
> 
> 赞同：94
> 
> 时间：2012-08-29T22:48:37.513
> 
> 标签：javascript, jquery, css, twitter-bootstrap

我试图在下拉菜单中创建 twitter 引导子菜单，但我遇到了一个问题：我在页面的右上角有下拉菜单，并且该菜单还有一个子菜单。但是，当子菜单打开时 - 它不适合窗口并且向右移动太多，因此用户只能看到第一个字母。如何使该子菜单不向右打开，而是向左打开？

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2014-01-24T14:31:07.007

如果我理解这一点，bootstrap 为这种情况提供了一个 CSS 类。将 'pull-right' 添加到菜单 'ul' 中：

```
<ul class="dropdown-menu pull-right"> 
```

..最终结果是菜单选项显示为右对齐，与它们下拉的按钮一致。

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2013-05-10T15:16:14.727

最简单的方法是将`pull-left`类添加到您的`dropdown-submenu`

```
<li class="dropdown-submenu pull-left"> 
```

jsfiddle：[演示](http://jsfiddle.net/SchmalzyB/szx4Y/51/)

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-08-30T00:20:17.533

当前班级`.dropdown-submenu > .dropdown-menu`有`left: 100%;`。因此，如果您想在左侧打开子菜单，请将这些设置覆盖到负左位置。例如`left: -95%;`. 现在您将在左侧获得子菜单，您可以调整其他设置以获得完美的预览。

这是[演示](http://jsfiddle.net/mQnv2/1/)

编辑：OP 的问题和我的回答来自 2012 年 8 月。与此同时，Bootstrap 发生了变化，所以现在你有了 .pull-left 类。那时，我的回答是正确的。现在你不必手动设置 css，你有那个 .pull-left 类。

编辑 2：演示不起作用，因为 Bootstrap 更改了它们的 URL。只需更改 jsfiddle 中的外部资源并用新资源替换它们。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2016-04-16T18:35:51.757

如果您使用的是 bootstrap v4，则有一种新方法可以做到这一点。

您应该`.dropdown-menu-right`在`.dropdown-menu`元素上使用。

```
<div class="btn-group">
  <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Right-aligned menu
  </button>
  <div class="dropdown-menu dropdown-menu-right">
    <button class="dropdown-item" type="button">Action</button>
    <button class="dropdown-item" type="button">Another action</button>
    <button class="dropdown-item" type="button">Something else here</button>
  </div>
</div> 
```

代码链接：[https ://getbootstrap.com/docs/4.0/components/dropdowns/#menu-items](https://getbootstrap.com/docs/4.0/components/dropdowns/#menu-items)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-12-02T19:40:26.803

完成任务的正确方法是：

```
/* Submenu placement itself */
.dropdown-submenu > .dropdown-menu { left: auto; right: 100%; }
/* Arrow position */
.dropdown-submenu { position: relative; }
.dropdown-submenu > a:after { position: absolute; left: 7px; top: 3px; float: none; border-right-color: #cccccc; border-width: 5px 5px 5px 0; }
.dropdown-submenu:hover > a:after { border-right-color: #ffffff; } 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-10-12T14:37:58.063

我创建了一个 javascript 函数，用于查看他的右侧是否有足够的空间。如果有，他会在右侧显示，否则他会在左侧显示

测试：

*   火狐 (Mac)
*   乔姆 (mac)
*   野生动物园（Mac）

Javascript：

```
$(document).ready(function(){
    //little fix for the poisition.
    var newPos     = $(".fixed-menuprofile .dropdown-submenu").offset().left - $(this).width();
    $(".fixed-menuprofile .dropdown-submenu").find('ul').offset({ "left": newPos });

    $(".fixed-menu .dropdown-submenu").mouseover(function() {
        var submenuPos = $(this).offset().left + 325;
        var windowPos  = $(window).width();
        var oldPos     = $(this).offset().left + $(this).width();
        var newPos     = $(this).offset().left - $(this).width();

        if( submenuPos > windowPos ){
            $(this).find('ul').offset({ "left": newPos });
        } else {
            $(this).find('ul').offset({ "left": oldPos });
        }
    });
}); 
```

因为我不想在我创建了一个新类的每个菜单项上添加此修复程序。将固定菜单放在 ul 上：

```
<ul class="dropdown-menu fixed-menu"> 
```

我希望这对你有用。

附言。safari 和 chrome 中的小错误，如果我修复它，第一次悬停会将它放在左边的 mutch 将更新这篇文章。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-11-18T14:27:47.960

如果您只有一个级别并且使用 bootstrap 3 添加`pull-right`到`ul`元素

```
<ul class="dropdown-menu pull-right" role="menu"> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-05-05T13:37:42.550

实际上 - 如果你对浮动`dropdown`包装器感到满意 - 我发现它就像添加`navbar-right`到`dropdown`.

这似乎是作弊，因为它不在导航栏中，但对我来说效果很好。

```
<div class="dropdown navbar-right">
...
</div> 
```

然后，您可以`pull-left`直接在`dropdown`...

```
<div class="dropdown pull-left navbar-right">
...
</div> 
```

...或作为它的包装...

```
<div class="pull-left">
  <div class="dropdown navbar-right">
  ...
  </div>
</div> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-06-04T17:21:45.577

如果你使用的是 LESS CSS，我写了一个小混入来移动带有连接箭头的下拉列表：

```
.dropdown-menu-shift( @num-pixels, @arrow-position: 10px ) {  // mixin to shift the dropdown menu
    left: @num-pixels;
    &:before { left: -@num-pixels + @arrow-position; }        // triangle outline
    &:after  { left: -@num-pixels + @arrow-position + 1px; }  // triangle internal
} 
```

然后移动一个`.dropdown-menu`id`dropdown-menu-x`例如，你可以这样做：

```
#dropdown-menu-x {
    .dropdown-menu-shift( -100px );
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-04-20T09:53:39.977

我创建了一个 javascript 函数，用于查看他的右侧是否有足够的空间。如果有，他将在右侧显示，否则他将在左侧显示。同样，如果右侧有足够的空间，它将显示右侧。这是一个循环...

```
$(document).ready(function () {

$('body, html').css('overflow', 'hidden');
var screenWidth = $(window).width();
$('body, html').css('overflow', 'visible');

if (screenWidth > 767) {

    $(".dropdown-submenu").hover(function () {

        var dropdownPosition = $(this).offset().left + $(this).width() + $(this).find('ul').width();
        var newPosition = $(this).offset().left - $(this).find('ul').width();
        var windowPosition = $(window).width();

        var oldPosition = $(this).offset().left + $(this).width();
        //document.title = dropdownPosition;
        if (dropdownPosition > windowPosition) {
            $(this).find('ul').offset({ "left": newPosition });
        } else {
            $(this).find('ul').offset({ "left": oldPosition });
        }
    });

} 
```

});

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-29T23:02:25.433

您使用的是最新版本的引导程序吗？我已经改编了[流体布局示例](http://twitter.github.com/bootstrap/2.3.2/examples/fluid.html "流体布局示例。")中的 html，如下所示。我添加了一个下拉菜单，并通过添加类将其放置在最右侧`pull-right`。将鼠标悬停在下拉菜单上时，它会自动拉到左侧并且没有隐藏任何内容 - 所有菜单文本都是可见的。我没有使用任何自定义CSS。

```
<div class="navbar navbar-inverse navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container-fluid">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="#">Project name</a>
      <div class="nav-collapse collapse">
        <ul class="nav pull-right">
          <li class="active"><a href="#">Home</a></li>
          <li><a href="#about">About</a></li>
          <li><a href="#contact">Contact</a></li>
          <li class="dropdown open">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="#">Action</a></li>
              <li><a href="#">Another action</a></li>
              <li><a href="#">Something else here</a></li>
              <li class="divider"></li>
              <li class="nav-header">Nav header</li>
              <li><a href="#">Separated link</a></li>
              <li><a href="#">One more separated link</a></li>
            </ul>
          </li>
        </ul>
        <p class="navbar-text pull-right">
          Logged in as <a href="#" class="navbar-link">Username</a>
        </p>
      </div><!--/.nav-collapse -->
    </div>
  </div>
</div> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-08-18T06:38:08.173

你唯一需要做的就是

```
 <ul style='left:-100%'> 
```

您想在右侧显示的菜单。

# facebook-graph-api - 来自 facebook 的特定位置事件

> ID：12187558
> 
> 赞同：0
> 
> 时间：2012-08-29T22:49:20.107
> 
> 标签：facebook-graph-api, object, location

有没有办法从特定区域（例如使用 facebook 平台的巴西）获取“事件”（或就此而言任何公开可用的对象）？我了解我们需要身份验证才能访问受隐私保护的数据。但是事件/页面是公开的吗？（如果错了，请纠正我）

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:14:44.407

您可以使用 Search API 搜索某个区域的公共对象：[https ://developers.facebook.com/docs/reference/api/#searching](https://developers.facebook.com/docs/reference/api/#searching)

# sql-server - SQL Server 触发器 - 从第一个插入存储过程中获取变量？

> ID：12187560
> 
> 赞同：0
> 
> 时间：2012-08-29T22:49:49.247
> 
> 标签：sql-server, tsql

我有一个带有递增 Id ( `int`) 的插入存储过程。我想把`Id`它插入到另一个表中，也是插入存储过程中的一个变量。

我知道你可以这样做`select from inserted`，但如果我没记错的话，你可以从`inserted`行中选择值。

无论如何在执行存储过程并将其传递给触发器后保持变量？

编辑：对不起，让我包括我正在使用的存储过程。表 foo 有一个自动递增的 Id，我希望在运行此存储过程后触发器将 foo 的 Id 和 @mid 插入另一个表。但是，正如您所看到的，@mid 没有被插入到表 foo 中。

```
 ALTER PROCEDURE [dbo].[foo]
    @userName varchar(50),
    @somefoo varbinary(max),
    @mid int
AS
BEGIN
    SET NOCOUNT ON;

    INSERT INTO fooTable(UserName, SomeFoo)
    VALUES (@userName, @somefoo);

END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:18:33.060

插入的伪表允许您选择表中现在的值。删除的伪表允许您选择插入发生之前表中的值。既然你说插入过程，我假设它不是插入/更新过程。我不清楚你想做什么。您希望触发器复制身份字段和另一列吗？简单的。您希望触发器复制未实际存储在表中的标识字段和 proc 参数吗？不可能 - 但如果这是您想要的，那么您可以在 proc 中执行此操作。

1) 触发器：

```
Insert into foo (a, b)
select my_identity, some_column
from inserted 
```

2) 过程：

```
 ..do main insert...
    insert into foo (a, b)
    select scope_identity(), @some_parameter 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T06:08:41.610

您可以将您的表扩展属性用于您的目的。

第 1 步：为您的表定义一个扩展属性。

![在此处输入图像描述](../Images/0f7b79484ba0722198373592c9444936.png)

第 2 步：在存储过程中，在插入到您的表集之前通过您的参数定义扩展属性。

```
EXEC sys.sp_updateextendedproperty @name=N'@ParameterName', @value='YourValue' 
```

第 3 步：在触发器中获取定义的扩展属性并使用它。使用`sys.extended_properties`表获取定义的扩展属性。

# android - google map api查找10公里内的医院

> ID：12187563
> 
> 赞同：1
> 
> 时间：2012-08-29T22:50:03.917
> 
> 标签：android, google-maps-api-3

我在我的 php 项目中使用了 google map api，只是为了指向标记。现在我正在构建一个安卓应用程序。我在自己的 mysql 数据库中有我所在州的医院的经度和纬度列表。我想构建这样的应用程序，它将从 gps 获取坐标并在我的数据库中搜索 10 公里半径内的医院。我见过类似 API

maps.googleapis.com/maps/api/place/search/output?parameters

但在这里我想使用我自己的数据库。有什么出路吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:02:53.183

如果您的问题是寻找附近的医院，您可以使用以下代码：

```
private boolean isItemInRange(double radius,
        double latOrigin, double lonOrigin, double latDestination,
        double lonDestination) {

    double resultRadius = 6371 * Math.acos(Math.cos(Math.PI
            * (90 - latDestination) / 180)
            * Math.cos((90 - latOrigin) * Math.PI / 180)
            + Math.sin((90 - latDestination) * Math.PI / 180)
            * Math.sin((90 - latOrigin) * Math.PI / 180)
            * Math.cos((lonOrigin - lonDestination) * Math.PI / 180));

    if (resultRadius <= radius){
        return true;
    } else {
        return false;
    }
} 
```

只需传递设备的坐标和每个医院的坐标。如果数据在服务器上，只需发送设备坐标，您就可以在您的服务器或数据库中实现上述功能。

希望它可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T22:57:14.857

我做了一些非常相似的事情，也遇到了这个问题。

我收到了这个答案[https://stackoverflow.com/a/10771017/975959](https://stackoverflow.com/a/10771017/975959)

基本上，您可以编写一个 php 文件来与您的数据库进行交互（比直接通过 Android 访问更好的解决方案）并让 MySQL 进行必要的计算，并且只返回接近 10 公里的那个。

祝你好运

# javascript - 使用 javascript ajax 发送数组

> ID：12187564
> 
> 赞同：3
> 
> 时间：2012-08-29T22:50:07.867
> 
> 标签：javascript, ajax

在 jquery 我可以做到这一点

```
myAray=['abc', '123', 'more'];
$.post('myscript.php', {data:myAray}, function(data){
    alert(data);
}); 
```

如何使用纯 javascript 做同样的事情？我想使用 POST 方法将数组发送到我的 php 脚本。我发现了很多示例，但所有示例都与 jquery 相关。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:02:43.390

您必须自己使用`XMLHttpRequest`和序列化数组：

```
function ajax(myArray) {

    var xmlHTTP;

    if (window.XMLHttpRequest) { 
        xmlHTTP = new XMLHttpRequest();
    } else { 
        xmlHTTP = new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlHTTP.onreadystatechange = function () {
        if (xmlHTTP.readyState == 4 && xmlHTTP.status == 200) {
            // do whatever it is you want to do
        }
    }

    //Serialize the data
    var queryString = "";
    for(var i = 0; i < myArray.length; i++) {
        queryString += "myArray=" + myArray[i];

        //Append an & except after the last element
        if(i < myArray.length - 1) {
           queryString += "&";
        }
    }

    xmlHTTP.open("POST", "www.myurl.com", true);
    xmlHTTP.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
    xmlHTTP.send(queryString);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T22:58:07.217

乱搞这个。

JS

```
var myarray = Array("test","boom","monkey");
send("test.php", myarray);  

function send(url, data)  
{
var xhr = new XMLHttpRequest();
xhr.onreadystatechange=function()
{
    if (xhr.readyState==4 && xhr.status==200)
    {
        console.log(xhr.responseText);
    }
}
xhr.open("POST", url, true);
xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
xhr.send("data= " +data);
} 
```

PHP

```
<?php 
$array = explode(',', $_POST["data"]);

for($i=0,$l=count($array); $i<$l; $i++) 
{
echo $array[$i].'<br>';
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T23:15:23.730

```
function loadXMLDoc()
{
  var xmlhttp;
  if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
   xmlhttp=new XMLHttpRequest();
  }
  else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
  xmlhttp.onreadystatechange=function()
  {
   if (xmlhttp.readyState==4 && xmlhttp.status==200)
   {
    document.getElementById("myDiv").innerHTML=xmlhttp.responseText;
   }
  }
xmlhttp.open("POST","jsArrayPhp.php",true);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
xmlhttp.send("test[]=Henry&test[]=Ford");
} 
```

注意这里： **test[]=Henry&test[]=Ford"**

其中 test 是您将在 php.ini 中使用的数组的名称。

在php中

```
<?php
 print_r($_POST['test']);
?> 
```

它会产生： Array ( [0] => Henry [1] => Ford )

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T22:56:08.337

像这样：post 是 POST 或 GET。参数仅在 POST 中使用，否则在 GET 的 url 中包含您需要的内容。成功和错误都是函数的字符串名称，而不是函数本身，这就是为什么需要 executeFunctionByName，感谢 Jason Bunting： [当我将其名称作为字符串时如何执行 JavaScript 函数](https://stackoverflow.com/questions/359788/how-to-execute-a-javascript-function-when-i-have-its-name-as-a-string)

```
getRemoteData = function (url, post,params, success, error){

var http = false;
if (navigator.appName === "Microsoft Internet Explorer") {
http = new ActiveXObject("Microsoft.XMLHTTP");
}
else {
http = new XMLHttpRequest();
}

http.open(post, url, true);
http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
http.onreadystatechange = function() {var resp; if (http.readyState === 4 && http.status == 200) {  resp=http.responseText; executeFunctionByName(success, window, resp); }else if(http.status == 400){resp=http.responseText; executeFunctionByName(error, window, resp);}};

http.send(params);
return false;
};

function executeFunctionByName(functionName, context, args) {
  args = Array.prototype.slice.call(arguments).splice(2);
  var namespaces = functionName.split(".");
  var func = namespaces.pop();
  for(var i = 0; i < namespaces.length; i++) {
    context = context[namespaces[i]];
  }
  return context[func].apply(this, args);
} 
```

# java - 具有多个连接的 HQL 查询

> ID：12187574
> 
> 赞同：0
> 
> 时间：2012-08-29T22:51:18.653
> 
> 标签：java, hibernate, jakarta-ee, hql

我有以下三个类的关系：

```
 @Entity
    public class User{

       @OnetoMany
       List<Attribute> attributes = new ArrayList<Attribute>();
    }

    @Entity
    public class Attribute{
       @ManyToOne
       AttributeType attributeType;

    }

    @Entity
    public class AttributeType{

       @Column
       String type;
    } 
```

一个用户可以拥有 m 种类型的 n 个属性。

我需要创建 HQL 查询，它将返回`List<AttributeType>`特定用户属性的所有属性类型。

例如，用户具有类型 t 的属性 a、类型 t 的属性 b 和类型 t1 的属性 c。我需要返回`List<AttributeType>`包含 t 和 t1 的内容。

请帮忙。我刚刚迷失在这个查询中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:59:09.827

您应将 Attribute 映射到 User 多对一关系，因此您需要以下查询：

```
select distinct atr.attributeType
  from Attribute atr
 where atr.user = :user 
```

我认为以下查询也可以：

```
select distinct atrs.attributeType
  from User as user
  join user.attributes as atrs   
 where user.id = :user_id 
```

# perl - 实例化 HTML::TokeParser 时出现未初始化错误

> ID：12187575
> 
> 赞同：1
> 
> 时间：2012-08-29T22:51:21.657
> 
> 标签：perl

使用 HTML::TokeParser 时出现未定义的错误。

```
print $agent->content();
my $stream = HTML::TokeParser->new($agent->{content}); 
```

第 1 行 - 我确实从我的打印语句中获得了所需的输出。

第 2 行 - 错误：在打印中使用了未初始化的值 $stream。

不知道为什么它不能工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:53:26.810

`$agent->content`不一样`$agent->{content}`。前者是方法调用，后者是哈希解引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T23:02:10.740

构造函数的标量参数`HTML::TokeParser`被视为文件名或文件句柄，打开文件失败将导致构造函数返回`undef`并设置`$!`.

如果要将实际的 HTML 传递给构造函数，则必须使用标量引用：

```
my $stream = HTML::TokeParser->new( \$agent->content ) 
```

# facebook - Facebook API 无法将流式音频上传到页面墙

> ID：12187576
> 
> 赞同：1
> 
> 时间：2012-08-29T22:51:31.823
> 
> 标签：facebook, facebook-graph-api, audio, mp3, audio-streaming

我有一个音乐博客，想将我所有的帖子复制到 facebook，但是当我手动发布时，我无法让 api 像我一样发布流式音频。它确实发布了，但音频被删除了。这是我的代码：

```
<?php

require 'facebook-php-sdk/src/facebook.php';
$APP_ID = 'MYAPPID';
$APP_SECRET = 'MYAPPSECRET';
$PAGE_ID = 'MYPAGEID';
$ACCESS_TOKEN = 'GENERATEDACCESSTOKEN';

$facebook = new Facebook(array(
  'appId'  => $APP_ID,
  'secret' => $APP_SECRET,
  'cookie' => true,
));

$attachment = array(
                'message' => 'some message',
                'attachment' => '{"media": [{"type": "mp3","src": "http://EXAMPLE.COM/music.mp3", "title": "title", "artist": "artist", "album":"album"}]}',
                'access_token' => $ACCESS_TOKEN
              );

$result = $facebook->api('/'.$PAGE_ID.'/feed', 'post', $attachment);

if($result){ 
    echo "<p>Posted status update</p>";
}
else { 
    echo "<p>Unable to post update.</p>";
}

?> 
```

知道如何解决这个问题吗？谢谢大家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T00:15:04.713

这是不可能的，只有列入白名单的合作伙伴才能使用 Open Graph Music 标签。
更多信息在这里 - [https://developers.facebook.com/docs/opengraph/music/](https://developers.facebook.com/docs/opengraph/music/)

# java - 使用 web 视图从 1 个以上的活动中清除 Webcache

> ID：12187578
> 
> 赞同：0
> 
> 时间：2012-08-29T22:51:33.847
> 
> 标签：java, android, caching, android-activity, webview

试图弄清楚为什么我无法从我拥有的多个 webviews 中清除缓存，当我在下面以这种方式获取代码时，我似乎遇到了强制关闭错误。但是，当它只有 1 个 webview 时，它工作正常。任何建议的家伙。

由于多个 Web 视图而无法工作的部分

```
Preference customPref = (Preference) findPreference("clearcache");
customPref.setOnPreferenceClickListener(new OnPreferenceClickListener() {

        // When Cache Preference is clicked
        public boolean onPreferenceClick(Preference preference) {
            Toast.makeText(getBaseContext(), "Cache Cleared",
                    Toast.LENGTH_LONG).show();          
            WebViewClientDemoActivity.web.clearCache(true);
            Commercial.web4.clearCache(true);
            Community.web2.clearCache(true);
            Distributors.web6.clearCache(true);
            Downloads.web7.clearCache(true);
            EnlightenInfoPage.web4.clearCache(true);
            Support.web3.clearCache(true);
            return false;
        }
    }); 
```

它的作品只有这个

```
WebViewClientDemoActivity.web.clearCache(true); 
```

所有 ove webview 都是死的 webviews 并且确实被使用，是我没有的声明东西或类似的东西。

或者，如果您知道清除应用程序缓存而不是数据的方法，只需使用“首选项”单击进行缓存

LOGCAT

```
08-29 20:46:14.413: E/AndroidRuntime(337): FATAL EXCEPTION: main
08-29 20:46:14.413: E/AndroidRuntime(337): java.lang.NullPointerException
08-29 20:46:14.413: E/AndroidRuntime(337):  at com.jaisonbrooks.enlighten.Prefs$1.onPreferenceClick(Prefs.java:60)
08-29 20:46:14.413: E/AndroidRuntime(337):  at android.preference.Preference.performClick(Preference.java:812)
08-29 20:46:14.413: E/AndroidRuntime(337):  at android.preference.PreferenceScreen.onItemClick(PreferenceScreen.java:190)
08-29 20:46:14.413: E/AndroidRuntime(337):  at android.widget.AdapterView.performItemClick(AdapterView.java:284)
08-29 20:46:14.413: E/AndroidRuntime(337):  at android.widget.ListView.performItemClick(ListView.java:3382)
08-29 20:46:14.413: E/AndroidRuntime(337):  at android.widget.AbsListView$PerformClick.run(AbsListView.java:1696)
08-29 20:46:14.413: E/AndroidRuntime(337):  at android.os.Handler.handleCallback(Handler.java:587)
08-29 20:46:14.413: E/AndroidRuntime(337):  at android.os.Handler.dispatchMessage(Handler.java:92)
08-29 20:46:14.413: E/AndroidRuntime(337):  at android.os.Looper.loop(Looper.java:123)
08-29 20:46:14.413: E/AndroidRuntime(337):  at android.app.ActivityThread.main(ActivityThread.java:4627)
08-29 20:46:14.413: E/AndroidRuntime(337):  at java.lang.reflect.Method.invokeNative(Native Method)
08-29 20:46:14.413: E/AndroidRuntime(337):  at java.lang.reflect.Method.invoke(Method.java:521)
08-29 20:46:14.413: E/AndroidRuntime(337):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
08-29 20:46:14.413: E/AndroidRuntime(337):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
08-29 20:46:14.413: E/AndroidRuntime(337):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:02:50.113

也许其中一个 webviews 是空的，访问另一个活动的 UI 元素永远不会好。此外，只有当您至少启动一次所有活动时，才会初始化 webview。为每个 Web 元素添加空检查

```
if(Commercial.web4 != null)
     Commercial.web4.clearCache(true); 
```

但是我认为有静态元素是不好的设计，这些活动可以只有一个实例吗？您必须确保所有活动都是单例的

**编辑：**

如果要删除自己应用的 Cachedirectory，可以使用

```
try {
        File dir = context.getCacheDir();
        if (dir != null && dir.isDirectory()) {
            deleteDir(dir);

        }
    } catch (Exception e) {
        e.printStackTrace();
    } 
```

# jquery-mobile - JQuery Mobile 在页面加载时显示和隐藏加载消息

> ID：12187580
> 
> 赞同：1
> 
> 时间：2012-08-29T22:51:55.377
> 
> 标签：jquery-mobile

我试图在页面加载时显示加载消息，这是我的尝试：

```
$('#page1').live("pagebeforeshow", function(e, ui){
    setTimeout($.mobile.showPageLoadingMsg, 5); 
});

$('#page1').live("pageshow", function(e, ui){
    setTimeout($.mobile.hidePageLoadingMsg, 5); 
}); 
```

上面代码的问题是消息甚至没有显示。

这不是正确的方法吗？

# php - 如何在没有额外空格的情况下从 MySQL 检索字符数据？

> ID：12187592
> 
> 赞同：1
> 
> 时间：2012-08-29T22:53:00.447
> 
> 标签：php, javascript, mysql, html

我正在使用表单将文本加载到数据库中。然后，我使用 php 将文本拉回，以便动态创建我的 CSS 选择器。然后我使用 javascript 根据需要打开和关闭选择器。一切正常，除了检索到的数据中有很长的空格（比如表单的整个文本区域都包括在内），因此，由于多余的空格，javascript 不起作用。因为这些是标签，所以它们的长度不同。我尝试将数据存储为 VARCHAR CHAR 和 TEXT。如何仅从 MySQL 中检索字符？我在手册的某个地方看到过它，但现在似乎找不到它。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T22:56:13.070

你可以只`trim`在 PHP 中使用。MySQL 也有一个`TRIM()`.

请注意，这会删除字符串前后的所有空格，而不是字符串中的空格。

由于 html 本身的空格，您显然也总是会提交换行符。您可能应该关闭`textarea`而不创建额外的空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T22:56:02.600

您只想替换所有空格吗？

```
REPLACE(col, ' ', '') 
```

[http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace)

# lambda - 如何返回到点的最小距离？

> ID：12187593
> 
> 赞同：2
> 
> 时间：2012-08-29T22:53:12.777
> 
> 标签：lambda, prolog

我正在尝试解决一个问题，我有一个坐标列表并想要最接近某个点。

示例：我得到了坐标 [[1,2],[3,4],[10,3]] 并且想要获得离原点 [0,0] 最近的点。[1,2] 在这个例子中。

我写了这个：

```
list_min([H|T], Min):-
   list_min(T, H, Min).

list_min([], H, H).

list_min([L|Ls], Min0, Min) :-
    point(P),
    distance(Min0,P,D0),
    distance(L,P,D1),
    Lower is min(D0, D1),
    assert(candidate(Min0)),
    assert(candidate(L)),
    forall(candidate(X),distance(X,P,Lower)),
    retractall(candidate(_)),
    list_min(Ls, X, Min).

distance(A,B,D):-
    A = [A1,A2],
    B = [B1,B2],
    Y is B2 - A2,
    X is B1 - A1,
    D is sqrt(X*X + Y*Y). 
```

但是，看起来它总是在 forall 行中失败。我做错了什么？有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:49:51.130

您可以使用库（[聚合](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%27A.1%27,swi%28%27/doc/Manual/aggregate.html%27%29%29)）：

```
distance_min(L, MinXY) :-
    distance_min(L, 0, 0, MinXY).
distance_min(L, X0, Y0, MinXY) :-
    aggregate(min(D, [X,Y]),
              (member([X,Y], L), D is sqrt((X-X0)^2+(Y-Y0)^2)),
              MinXY). 
```

测试：

```
?- distance_min([[1,2],[3,4],[10,3]], R).
R = min(2.23606797749979, [1, 2]). 
```

**编辑**

```
....
assert(candidate(Min0)),
assert(candidate(L)),
forall(candidate(X),distance(X,P,Lower)),
retractall(candidate(_)),
... 
```

我没有评论你的代码，但现在这里有一个提示：这些行的风格真的很糟糕，而且真的没用。承认 forall/2 成功，你期待什么结果？

无论如何，forall/2 失败，因为`Lower`它已经从上面的语句中实例化 ( `Lower is min(D0, D1)`)，因此 distance/3 将在`D`不匹配的地方失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T22:46:31.003

使用 SWI-Prolog，您还可以使用功能样式：

```
:- use_module(library(lambda)).

point([0,0]). % The reference point

% Entry point predicate
% First parameter : a list of points
% Second parameter (result) : the point closest to the reference point
list_min([H|Tail], Min) :-
  point(Reference),
  distance(H, Reference, D),

  foldl(\X^Y^Z^(distance(X, Reference, DX),
                Y = [Cur_D, _Cur_P],
                (   DX < Cur_D
                ->  Z = [DX, X]
                ;   Z = Y)),
    Tail, [D, H], Min).

distance(A,B,D):- % copy-pasted from your version
  A = [A1,A2],
  B = [B1,B2],
  Y is B2 - A2,
  X is B1 - A1,
  D is sqrt(X*X + Y*Y). 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T13:20:51.783

我提出了一个没有建议的库或四叉树的解决方案，我留在基本序言中（我用 SWI 编写）。

如果我正确理解了您的问题，则实际上不需要`assert`/ `retract`/ 。`forall`我假设`point(P)`P 是我们计算距离的唯一定义的参考点，但它有点奇怪（我会将它用作参数，以确保它是唯一的）。

```
point([0,0]). % The reference point

% Entry point predicate
% First parameter : a list of points
% Second parameter (result) : the point closest to the reference point
list_min([H|Tail], Min) :-
  point(Reference),
  distance(H, Reference, D),
  list_min(Tail, H, D, Min).

% First parameter : the list remaining to consider
% Second parameter : the closest point, at this point of the computation
% Third parameter : the corresponding (minimum) distance, at this point of the computation
% Fourth parameter : the result (one point, to be bound at the end of computation)
list_min([], CurrentMin, _, CurrentMin). % Stop condition : list processed
list_min([Candidate|Tail], CurrentMin, CurrentDist, Min) :-
  point(Reference),
  distance(Candidate, Reference, CandidateDist),
  (
   % if the new candidate is not better, keep the current candidate
   CurrentDist < CandidateDist ->
   list_min(Tail, CurrentMin, CurrentDist, Min)
  ;
   % if the new candidate is better, take it as the current candidate
   list_min(Tail, Candidate, CandidateDist, Min) 
   ).

distance(A,B,D):- % copy-pasted from your version
  A = [A1,A2],
  B = [B1,B2],
  Y is B2 - A2,
  X is B1 - A1,
  D is sqrt(X*X + Y*Y). 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T23:07:40.710

使用二维四叉树[http://en.wikipedia.org/wiki/Quadtree](http://en.wikipedia.org/wiki/Quadtree)

# java - 用于 Juno (Eclipse 4.2) 的 Google Eclipse 插件是否损坏？

> ID：12187595
> 
> 赞同：3
> 
> 时间：2012-08-29T22:53:34.167
> 
> 标签：java, eclipse, eclipse-juno, google-eclipse-plugin

我刚刚安装了 Eclipse EE Juno (4.2) 和一大堆插件。我现在正在尝试安装 Google 插件（GAE 和 GWT），通过 Juno 的`Install new software`窗口添加更新站点时出现错误：

```
Name: Google-Plugin
Location: http://dl.google.com/eclipse/plugin/4.2 
```

当我尝试输入时，我得到：

> 找不到[http://dl.google.com/eclipse/plugin/4.2](http://dl.google.com/eclipse/plugin/4.2)

我从几个月前看到[了这个问题。](https://stackoverflow.com/questions/10152818/error-installing-google-appengine-plugin-in-eclipse-juno-4-2)虽然我有一个非常相似的问题，但我认为我有一个完全不同的问题。

当我将 更改为`Location`时`http://dl.google.com/eclipse/plugin/3.7`，我得到相同的错误（除了`3.7`附加在错误消息的末尾而不是`4.2`）。我绝对可以访问互联网（否则我会如何发布这个问题？！）所以这不是问题。如果这仅适用于 4.2 插件，我会很乐意尝试另一篇文章中提到的“解决方法”，或者甚至退回到 Eclipse 3.7（我**必须**拥有这个插件！）直到 4.2 工作。但它甚至不适用于 3.7 的事实告诉我，这里还有其他问题。提前致谢！

**编辑**：

只是为了解决问题，我下载了 Indigo (3.7) 并立即尝试安装 Google-Eclipse 插件。我为我的更新站点输入了以下内容：

> [http://dl.google.com/eclipse/plugin/3.7](http://dl.google.com/eclipse/plugin/3.7)

并收到一个令人讨厌的错误：

```
Artifact not found: http://dl.google.com/eclipse/plugin/3.7/compositeContent.xml.
Artifact not found: http://dl.google.com/eclipse/plugin/3.7/compositeContent.xml.
http://dl.google.com/eclipse/plugin/3.7/compositeContent.xml 
```

我在这里*疯*了吗？！？！我已经安装了相当多的 Eclipse 插件，*从来没有*遇到过这么多麻烦。特别是来自谷歌。而且我知道这不是我的 Internet 连接或我的 Eclipse 实例，因为*在*我尝试安装 Google 插件之前，我安装了 Subversive、IvyDE 和 EclEmma ......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:34:54.830

它不久前对我来说也坏了，但现在似乎可以工作了。也许该网站已经关闭了一段时间？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T21:02:36.697

You can try installing the plugin from archive as described in the link: [https://developers.google.com/eclipse/docs/install-from-zip](https://developers.google.com/eclipse/docs/install-from-zip)

Basically what you are doing is, you download the plugin as a zip(archive) and browse this archive instead of update site, during the plugin installation.

# serialization - 是否可以连接到 protobuf-net 序列化程序以添加一些自定义逻辑？

> ID：12187596
> 
> 赞同：1
> 
> 时间：2012-08-29T22:53:44.360
> 
> 标签：serialization, protobuf-net

这可能有点矫枉过正，但我​​试图通过让双方保留先前传输的 URI 的副本来减少客户端/服务器协议的网络消耗，以便在后续聊天中使用 2-4 字节占位符而不是完整的 URI。

问题是我认为通过所有被传输的复杂对象进行反射以定位需要处理的 URI 将非常昂贵，而序列化程序已经在访问所有这些字段并且可能使用比反射快得多的机制。

这可以在 protobuf-net 中完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T07:07:50.157

`Serialize`如果这是对/的单个调用的一部分`Deserialize`（即您的数据在多个位置重复了相同的 uri），那么您*已经可以这样做了*，只需告诉它将这些字符串视为引用（它对字符串有特殊处理，所以相同字符串内容的两个不同引用算作相等）：

```
[ProtoMember(7, AsReference=true)]
public string Uri {get;set;} 
```

在序列化过程中，它第一次发现一个***新***的字符串值（用 装饰`AsReference=true`）时，它将生成一个唯一的标记来表示该字符串；同一字符串的所有后续用法将*仅*序列化令牌。

`Serialize`如果这是对/的单独调用`Deserialize`，则不：您必须手动进行。我可以想到一些方法，但我认为这会在序列化层*之外更好地处理。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T01:49:40.170

您是否可以自定义要标记化 URI 的正在使用的对象，并让它们继承或实现一个接口，您可以检查该特定对象是否是 Tokenizer。

然后，如果是这种情况，您也许可以使用`BeforeSerialization`/`AfterDeserialization`进行转换。

# java - ViewPager 和 AsyncTask 用于加载项目

> ID：12187598
> 
> 赞同：3
> 
> 时间：2012-08-29T22:53:52.457
> 
> 标签：java, android, android-fragments

我有`ViewPager`一个正在`PageAdapter`加载的`ImageViews`。显示的图像来自互联网，我使用 AsyncTask 加载`Bitmap`然后（如果页面没有被破坏）将其分配给 ImageView。

```
@Override
public Object instantiateItem(ViewGroup container, int position) {
    ImageView img = new ImageView(container.getContext());
    new LoadImageTask(img,Data.getImageUrL(position)).execute();
    container.addView(img );
    return img;
} 
```

所以它`ImageView`有两种状态：加载或加载。我需要跟踪用户是否等待图像。所以我在`LoadImageTask` **onPostExecute**实现了这个：

```
if (loadListener != null) {
    loadListener.onImageLoaded(position);
} 
```

在听众中：

```
public void onImageLoaded(int position) {
    if (position == mViewPager.getCurrentItem()) {
        // Save record ..
    }
} 
```

因为我只需要计算在“ViewPager 的当前项目”中显示的图像，这个方法是不够的，因为如果用户移动到项目 5，例如，`ViewPager`缓存中的加载项目 6。如果用户等待足够的时间此加载（将第 5 项作为当前项）对 onImageLoaded 的回调丢失（因为此时第 6 项不是 currentItem，然后当用户移动到第 6 项时，我无法知道图像是否是加载与否。

我正在考虑添加类似**[[PSEUDOCODE]]**的内容：

```
mViewPager.setOnPageChangeListener(new OnPageChangeListener() {

        @Override
        public void onPageSelected(int position) {

             if (mViewPager.isLoaded(posistion)){
                      // Save record ...
             }
        } 
```

但是我现在不知道如何检索相应的视图是否加载了图像。我该怎么做？

# javascript - 是否可以更改html的内容用javascript文件？

> ID：12187608
> 
> 赞同：0
> 
> 时间：2012-08-29T22:55:13.847
> 
> 标签：javascript, html, file-upload

我的网站要求用户上传指定格式的 xml 文件。所以我想在客户端进行语法和格式检查，并帮助他们在上传到服务器之前修复这些错误。（我不需要更改硬盘上的真实本地文件，只需要更改发送到服务器的数据）我目前使用：

```
var reader = new FileReader();
reader.onload = function(e) {
  var xml = e.target.result;
  // I help them correct xml here, this will involve lots of interaction with user,
  // so I want it only happen on client side
  var correctXML = fixSyntaxAndFormat(xml);  
  $.post('/foo/bar', {xml: correctXML});
}
reader.readAsText(evt.target.files[0]); 
```

此代码有效，除了它在发布数据中发送 xml 而不是真正上传的文件。因为我想监控文件上传进度并保存其他文件信息，所以我希望可以有类似的东西：`oldfile.content = correctXML` 然后我可以提交包含我的`<input type="file"/>`. 这可能吗？还是有“正确”的方法来做到这一点？

谢谢

**更新** 感谢 austincheney 的示例，我最终创建`new Blob()`并使用此替换原始文件。似乎工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:05:18.643

是的，这是完全可能的，它通常用于协助拖放文件操作。例如，如果您希望用户能够将文件拖放到 textarea 上，您可以将 textarea 设置为拖放区，在该拖放区中，文件的路径会以静默方式传送到输入类型文件元素。我在我自己的网站上这样做。

[在http://prettydiff.com/pd.js](http://prettydiff.com/pd.js)中检查函数 pd.file 和 pd.filedrop并在我的工具上演示结果[http://prettydiff.com/](http://prettydiff.com/)

# eclipse - 使用tomcat7 maven插件的tomcat7部署不起作用

> ID：12187610
> 
> 赞同：3
> 
> 时间：2012-08-29T22:55:20.903
> 
> 标签：eclipse, eclipse-plugin, maven-3, tomcat7, m2eclipse

我正在尝试使用 eclipse maven 插件，但是在使用命令时：

tomcat7:deploy 我正在构建成功，有很多关于添加用户的 html 输出解释，我已经将用户添加到只有管理器脚本的 tomcat。并将其添加到 Maven 中的 settings.xml 用户。

我究竟做错了什么？

从tomcat日志

```
127.0.0.1 - - [29/Aug/2012:23:50:34 +0100] "PUT /manager/text/deploy?path=%2F HTTP/1.1" 401 2486 
```

我的配置

pom.xml

```
 <plugins>
        <plugin>
            <groupId>org.apache.tomcat.maven</groupId>
            <artifactId>tomcat7-maven-plugin</artifactId>
            <version>2.0-SNAPSHOT</version>
            <configuration>
                <server>tomcat_7</server>
                <port>8180</port>
                <path>/</path>
                <url>http://localhost:8180/manager/text</url>
            </configuration>
          </plugin>
    </plugins> 
```

设置.xml

```
<server>
  <id>tomcat_7</id>
  <username>admin</username>
  <password>secret</password>
</server> 
```

tomcat-users.xml

```
<user username="admin" password="secret" roles="manager-script" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T15:04:23.373

好的，所以我设法解决了这个问题。

我检查了 eclipse 认为 maven settings.xml 文件在哪里。这是主要问题，没有 settings.xml 文件，因此没有身份验证。我将文件复制到eclipse中指定的路径。

现在构建成功。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-03T04:18:10.483

消除

```
<server>tomcat_7</server> 
```

并添加

```
<username>admin</username>
<password>s3cret</password> 
```

排除任何 Maven settings.xml 问题。

# c# - 将多个数据插入数据库时 可能存在的风险

> ID：12187611
> 
> 赞同：0
> 
> 时间：2012-08-29T22:55:22.050
> 
> 标签：c#, mysql, client-server

我有一个带有数据库的服务器客户端程序。客户端向服务器发送数据，服务器将数据保存到数据库中。现在的问题是，如果多个客户端同时向服务器发送数据，而服务器要写入数据库，会不会有问题？

例如：client1 调用一个方法：

```
client.save_data(data1); 
```

client2 调用一个方法：

```
client.save_data(data2); 
```

服务器尝试：

```
save_data(data){
  sql.insert_intoDB(data);
}
insert_intoDB(data)
{
  //not real code, just to show what i mean
   query = "insert into tablename values "+data;
   query.execute;
} 
```

在 c# 中处理这个问题的好方法是什么？或者根本就没有风险？

thx，最好的问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:25:11.930

如果您只是插入数据，则不会出现并发问题。插入操作按照数据库引擎接收到的顺序进行排队和插入，该顺序始终是线性的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T23:29:36.123

> 会不会有问题？

一般来说，是的，这个问题被称为并发。不同的数据库以不同的方式处理这个问题。在处理更新而不是插入时，通常更值得关注。

我认为大多数（如果不是全部）数据库引擎会单独处理每个插入，因此您不必担心。但是，为了安全起见，您应该始终使用事务，以便在出现任何*问题*时可以回滚。

如果您使用 C#，我建议您使用[TransactionScope 。](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx)

# coldfusion - 如何确定已安装的 ColdFusion 位数

> ID：12187612
> 
> 赞同：6
> 
> 时间：2012-08-29T22:55:27.947
> 
> 标签：coldfusion

如何确定安装的 ColdFusion 服务器是 32 位还是 64 位？

我很想看到一个解决我的问题的答案，既可以通过登录服务器，也可以通过 CFML 代码以编程方式解决。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-30T00:16:11.447

好吧，不像我想象的那么简单，但信息就在那里。

## 程序化访问

在所有三个 CFML 引擎中，您都可以通过服务器范围以编程方式访问 JVM 信息`Server.Os.Arch`。这包含一个值，例如`amd64`64 位`i386`或`x86`32 位系统。

在 Railo（但不是 ACF/OBD）上，也`Server.Os.ArchModel`有简单地包含`64`或`32`酌情。

对于所有三个引擎，您可以通过以下方式获得这个 64/32 值：`createObject('java','java.lang.System').getProperty("sun.arch.data.model")`

## 服务器管理员

在 CF 管理员中，如果您转到“服务器设置”>“设置摘要”，您可以找到包含`Java HotSpot(TM) 64-Bit Server VM`（或等效于 32 位）的“Java VM 名称”。

在 OpenBD 管理员中，选择“服务器”>“系统信息”，第三个选项包含“操作系统”，包括`amd64`64 位系统，以及指向“JVM 属性”的链接，您可以在其中找到“java.vm” .name" 和 "sun.arch.data.model" 包含架构名称和位数的值。

在 Railo 管理员中，“概述”页面（当您登录时）有一个“信息”部分，其中包括操作系统和 JVM 的字段，每个字段都有版本信息`64bit`或`32bit`版本信息之后。

# sql-server - SQL Server 2012 scope_identity 建议

> ID：12187613
> 
> 赞同：3
> 
> 时间：2012-08-29T22:55:32.440
> 
> 标签：sql-server, stored-procedures, identity-column, scope-identity

我在 SQL Server 2012 中创建了一个存储过程，我曾经`scope_identity`获取过标识列的值，但在我的情况下，我不知道这是否正确请帮忙

```
CREATE PROCEDURE Add_Translation
    @english nvarchar(70),
    @kurdish nvarchar(70),
    @english_category int,
    @kurdish_category int,
    @result int out
AS
BEGIN
    SET NOCOUNT ON;

    if @english is not null and @kurdish is not null and @english_category is not null and @kurdish_category is not null
    begin
        insert into english_table values(@english, @english_category);

        declare @identityEnglish int;
        set @identityEnglish = SCOPE_IDENTITY();

        insert into kurdish_table values(@kurdish, @kurdish_category);
        declare @identityKurdish int;
        set @identityKurdish = SCOPE_IDENTITY();

        insert into transactions values(@identityEnglish, @identityKurdish);
        set @result = 1;
    end
    else
    begin
        set @result = 0;
    end
END 
```

我的问题是变量将`@identityEnglish`获得最后一个身份值，`english_table`而变量`@identityKurdish`将获得最后一个身份值`kurdish_table`

谢谢你..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T00:15:07.600

如果插入成功，则`scope_identity()`可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T11:18:12.607

您可以对 DML 操作使用“输出”子句。

[点击这里](http://blog.sqlauthority.com/2007/10/01/sql-server-2005-output-clause-example-and-explanation-with-insert-update-delete/)

# c++ - 低级 C++ 图形库

> ID：12187615
> 
> 赞同：0
> 
> 时间：2012-08-29T22:55:38.620
> 
> 标签：c++, windows, netbeans, graphics

我目前正在学习一个图形类，我们可以在其中使用任何语言或库来完成分配给我们的任务，只要它们允许我们执行诸如设置单个像素的值之类的操作。这主要是为了学习图形的基本原理。

我想知道是否有人可以推荐一个易于使用的免费 C++ 库，我可以将其添加到项目中并能够用于这些类型的任务。

请注意：我有点 C++ 菜鸟，我只在 Mac 上用 XCode 编写过一点 C++，因此对 C++ 的来龙去脉知之甚少。如果有人可以推荐一个我可以在 Windows 中的 NetBeans 中与 C++ 一起使用的库，甚至可能是关于如何正确添加它/使用它的示例的说明，我将非常感激。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T22:57:24.983

OpenGL 可能是你最好的选择。[http://www.opengl.org/](http://www.opengl.org/)

Cairo 适合 2d 图形，但它可能有点太高级了。它与 Gtk 很好地集成，这是一个很棒的小窗口库。

Windows 也有directx 之类的，但是你必须学习COM 才能使用它，而且一次学习可能太多了。

# android - 使用外部文件构建 Android 库项目

> ID：12187620
> 
> 赞同：0
> 
> 时间：2012-08-29T22:56:13.410
> 
> 标签：android, eclipse, ant

我有一个 Android 库项目（已检查属性 > Android > IsLibrary），它引入了一个外部文件（C++ 共享库），并将它与所有类文件一起打包到一个 jar 中。使用 Eclipse，一切正常，但使用 ant，jar 文件只包含类文件而不包含共享库。有没有办法修改 build.xml 以包含外部文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T00:47:55.123

这样做的方法显然是创建带有 Java 源和 C++ 库路径的 ant.properties：

```
source.dir=src:path-to-dir 
```

但是，这在当前的 Android SDK 中不起作用，解决方法是通过添加以下内容来修改 build.xml：

```
<target name="-pre-clean">
    <delete dir="tmp" />
</target>
<target name="-pre-build">
    <copy todir="tmp">
        <fileset dir="path-to-dir" includes="**" />
    </copy>
    <copy todir="tmp">
        <fileset dir="src" includes="**" />
    </copy>
</target> 
```

并使用以下命令创建 ant.properties：

```
source.dir=tmp 
```

# windows-phone-7 - 半透明应用栏

> ID：12187621
> 
> 赞同：1
> 
> 时间：2012-08-29T22:56:29.963
> 
> 标签：windows-phone-7

我是WP7新手。我想让它半透明，这样整个页面都可以看到。但是，我在互联网上搜索并没有找到如何做到这一点。有人可以为我提供一个示例或链接。提前致谢。

有我的代码：

```
<phone:PhoneApplicationPage.ApplicationBar>
    <shell:ApplicationBar IsVisible="true" IsMenuEnabled="True" BackgroundColor="FloralWhite" ForegroundColor="LightGreen">
        <shell:ApplicationBarIconButton IconUri="images/light/flag.png" Text="Call Response"/>
        <shell:ApplicationBarIconButton IconUri="images/buttons/call.png" Text="Call"/>
        <shell:ApplicationBarIconButton IconUri="images/buttons/createEvent.png" Text="New Event"/>
        <shell:ApplicationBarIconButton IconUri="images/buttons/eventCompleted.png" Text="Completed"/> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T22:59:31.890

我相信你只是设置了不透明度......

```
Opacity="0.5" 
```

这导致了这个......

![在此处输入图像描述](../Images/01e46119d5875a99f758bf15111d3614.png)

完整的代码...

```
<Rectangle Height="210" HorizontalAlignment="Left" Margin="66,474,0,0" Name="rectangle1" Stroke="White" StrokeThickness="1" Fill="Chartreuse" VerticalAlignment="Top" Width="134" /> 
```

...

```
<phone:PhoneApplicationPage.ApplicationBar>
    <shell:ApplicationBar IsVisible="True" IsMenuEnabled="True" Opacity=".75" BackgroundColor="Aqua" ForegroundColor="AliceBlue">
        <shell:ApplicationBarIconButton IconUri="/Images/appbar_button1.png" Text="Button 1"/>
        <shell:ApplicationBarIconButton IconUri="/Images/appbar_button2.png" Text="Button 2"/> 
```

# mysql - 大型表的 MySQL InnoDB INSERT 性能

> ID：12187626
> 
> 赞同：2
> 
> 时间：2012-08-29T22:57:24.263
> 
> 标签：mysql, performance, database-design, insert, innodb

我有 8 个表，超过 200 万行使用 INT(4B) PK 用于频繁插入和读取。较旧的 9/10 数据偶尔会被读取，无论访问它需要多长时间，而较新的 1/10 对于 INSERT 和 SELECT 都必须快速。这些表格分为 2 类要求：

1.  100 次插入/秒
2.  20 INSERTs/sec，偶尔更新

因为它应该使用设置为 32M 的 innodb_buffer_pool_size 并且旧数据并不重要，所以我认为最好的解决方案是每周一次将每个表的旧一半复制到大型存档表中。另外，我应该使用 infile 插入而不是当前事务。这是一个很好的解决方案吗？我将不胜感激有关此问题的任何建议和链接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T02:18:05.737

如果您使用 InnoDB，数据自然会使用表的 PRIMARY KEY “聚集”，如果您定义了一个（即：“id INT NOT NULL PRIMARY KEY AUTO_INCREMENT”），则数据按 ID 分组（并将保持方式）。

因此，您最近的 INSERTed 数据自然地分组在一些 InnoDB 缓冲区中，而您的旧存档数据根本无关紧要。我认为您不会从将数据拆分为存档表/数据库和最近的数据中受益，除非您会使一切变得更加复杂！

为了加快 InnoDB 上的插入/更新/删除，您必须考虑 InnoDB 日志文件的物理位置：InnoDB 需要将修改插入其中以实现操作（无论是显式事务还是隐式事务！） ，它不会等待数据或索引被放回磁盘。这是一个与 MyISAM 完全不同的策略。

因此，如果您可以为 InnoDB 日志文件、10krpm+ 硬盘驱动器或 SSD 分配快速顺序存储，并将 ibdata 保存在另一个驱动器或 RAID 阵列中，您将能够维持大量的 DB 修改：它是 IO 绑定的在 InnoDB 日志文件上（例外是您在更新/删除时使用复杂或繁重的 where 子句）。

# java - OpenGL 类似于光照的乘法效果

> ID：12187630
> 
> 赞同：0
> 
> 时间：2012-08-29T22:58:04.843
> 
> 标签：java, opengl, lwjgl

所以我正在开发一款游戏，我想知道如何在 Photoshop 但在 OpenGL 中实现类似的乘法效果。也可以更好地解释它，我附上了一些图像，显示了它将经历的步骤。

所以首先我有我的图像，我正常渲染。

![在此处输入图像描述](../Images/3f2945ce55dde9899b16e39e7f5622b6.png)

然后我在上面画了一个黑屏。

然后我有我的灯光图像，这些只是白色渐变。

![在此处输入图像描述](../Images/ec93b7c6f7e1751dca996be1348644d3.png)

之后，我在 Photoshop 中应用我的乘法效果：

![在此处输入图像描述](../Images/8374d13a89affa921153ce31ebf87240.png)

但是在opengl中，我将如何实现相同的效果？

灯光也必须融合在一起。

然而，在 Photoshop 中如何创建效果并不重要，只要我可以创建相同的最终结果即可。

我正在使用 LWJGL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T04:29:22.470

1.  将灯光图像绘制到屏幕上。
2.  启用与功能混合`glBlendFunc(GL_DST_COLOR, GL_ZERO)`
3.  将其他对象绘制到屏幕上。

绘制的结果片段将是背景（光）和传入对象（四边形）的乘积值。

# rest - 使用自签名证书和基本身份验证的 Powershell Invoke-RestMethod - 任何示例？

> ID：12187634
> 
> 赞同：9
> 
> 时间：2012-08-29T22:58:34.577
> 
> 标签：rest, powershell-3.0

我正在使用 RESTful API 并使用 Firefox RESTClient 插件一切都很好。我可以轻松查询 API。

但是，当我尝试将相同的 API 调用插入 powershell 时，它不起作用！

我已经尝试了其他各种帖子中的以下代码，这些代码应该排除证书问题，但我仍然无法让它工作：

```
 # This nugget should help me to get around any self-signed certificate issues I believe

    $netAssembly =[Reflection.Assembly]::GetAssembly([System.Net.Configuration.SettingsSection])

    if($netAssembly)
    {
        $bindingFlags = [Reflection.BindingFlags] "Static,GetProperty,NonPublic"
        $settingsType = $netAssembly.GetType("System.Net.Configuration.SettingsSectionInternal")

        $instance = $settingsType.InvokeMember("Section", $bindingFlags, $null, $null, @())

        if($instance)
        {
            $bindingFlags = "NonPublic","Instance"
            $useUnsafeHeaderParsingField = $settingsType.GetField("useUnsafeHeaderParsing", $bindingFlags)

            if($useUnsafeHeaderParsingField)
            {
              $useUnsafeHeaderParsingField.SetValue($instance, $true)
            }
        }
    }

    [System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}

    $headers = @{"AUTHORIZATION"="Basic YWRtaW46Y2xvdWQ="}

    # I exported this certificate from the web browser
    $cert=New-Object System.Security.Cryptography.X509Certificates.X509Certificate2("HPCSA.crt")

    Invoke-RestMethod -Uri https://192.168.5.3:8444/csa/rest/login/CSA-Provider/admin -Certificate $cert -Headers $headers -Method Get` 
```

我无法使用 Powershell V3 的 Invoke-RestMethod 复制它，并且想知道是否有人可以共享示例代码来访问具有自签名证书并使用基本授权的 HTTPS RESTful API。

我得到的错误信息：

```
PS C:\Users\landg> C:\Users\landg\Documents\Scripts\CSA API\CSA_API_DEMO_take2.ps1
Invoke-RestMethod : Unable to connect to the remote server
At C:\Users\landg\Documents\Scripts\CSA API\CSA_API_DEMO_take2.ps1:31 char:1
+ Invoke-RestMethod -Uri https://192.168.5.3:8444/csa/rest/login/CSA-Provider/admi ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidOperation: (System.Net.HttpWebRequest:HttpWebRequest) [Invoke-RestMethod], WebException
    + FullyQualifiedErrorId : WebCmdletWebResponseException,Microsoft.PowerShell.Commands.InvokeRestMethodCommand 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-31T19:00:24.073

[我的解决方案的来源](http://connect.microsoft.com/PowerShell/feedback/details/419466/new-webserviceproxy-needs-force-parameter-to-ignore-ssl-errors)

使用它可以让我进入实际的服务器......现在出现 HTTP 500 错误，但这个错误是另一天。

这是我的“工作”片段：

```
 add-type @"
        using System.Net;
        using System.Security.Cryptography.X509Certificates;

            public class IDontCarePolicy : ICertificatePolicy {
            public IDontCarePolicy() {}
            public bool CheckValidationResult(
                ServicePoint sPoint, X509Certificate cert,
                WebRequest wRequest, int certProb) {
                return true;
            }
        }
    "@
    [System.Net.ServicePointManager]::CertificatePolicy = new-object IDontCarePolicy 

    Invoke-RestMethod -Uri https://192.168.5.3:8444/csa/rest/login/CSA-Provider/admin -Headers @{"AUTHORIZATION"="Basic YWRtaW46Y2xvdWQ="} -Method Get 
```

希望这将帮助其他人度过几个令人沮丧的小时:)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-10-21T11:39:41.357

```
[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true} 
```

# iphone - Facebook 应用程序 URL 没有转到正确的位置

> ID：12187637
> 
> 赞同：0
> 
> 时间：2012-08-29T22:58:42.760
> 
> 标签：iphone, ios, facebook, ipad

我正在尝试通过 URL“fb://page/{pageid}”从我的 Facebook 应用程序中的应用程序打开一个 facebook 页面，但它没有指向该页面，facebook 应用程序的页面没有被这个 URL 更改？

我正在使用最新的 facebook sdk for ios。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T04:44:35.277

我认为这可能有助于回答您的问题.. 我只是想通了，我将它发布在我可以发布的任何地方。它目前适用于 iPhone 的 facebook ios 5.0.1 .. 尚未在 iPad 上尝试过。

网址是 fb://profile/132753734806

现在重要的部分是那个数字。这与我的一位客户查尔斯·斯科特有关。但是，这不是他们的 FBID 或页面 ID .. 他们的页面 ID 是 10150348920319807

所以你会认为它应该是 fb://profile/10150348920319807 但这给了我一个错误。

这是您获得正确代码的方法.. 单击您页面的任何照片.. 这是我的客户的示例[https://www.facebook.com/photo.php?fbid=10150348920319807&set=a.10150348920314807.356942.132753734806&type=1&theater](https://www.facebook.com/photo.php?fbid=10150348920319807&set=a.10150348920314807.356942.132753734806&type=1&theater)

如果您注意到该 URL 中 fbid= 之后的 FBID 不起作用。您想要的数字就在 &type=1theater 之前，但在最后一个时期之后。132753734806 是在 fb://profile/ 之后打卡的正确代码

# java - 在 Android 上运行 Python 控制台应用程序

> ID：12187640
> 
> 赞同：0
> 
> 时间：2012-08-29T22:59:16.323
> 
> 标签：java, android, python

我熟悉 Python 和其他一些语言，我想知道是否可以得到一个简单的 Python 脚本（一个文件）作为 Android 上的本机应用程序运行。我相信构建一个 APK 并运行它可以解决问题。我不希望用户下载外部应用程序并从那里加载脚本，我想制作应用程序，当它被执行时，它只会显示任何内容，而是在后台运行（一种无限循环） . 此外，将其连接到启动时自动启动将是理想的。还有一件事.. 是否可以访问 Android 服务，例如 Location、Accelerometer 等？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:04:34.730

Kivy 对此有好处.... [http://kivy.org/](http://kivy.org/) ...事实上它是我见过的唯一选择

[编辑] 呸，这与 Denizen 的评论相同... 蹩脚

# c - 多线程编程 C. 互斥锁不起作用

> ID：12187641
> 
> 赞同：3
> 
> 时间：2012-08-29T22:59:30.107
> 
> 标签：c, multithreading, pthreads

我有一个用 pthreads 编写的多线程 c 程序。我想知道我所做的是否正确。目前，该程序似乎在没有优化时运行。但是当我使用优化时，它失败了。我试图找出原因。

我想知道我使用的基本多线程同步是否正确。这是一个仅包含相关部分的简短版本。请让我知道这是否是多线程的正确方法。

它的工作方式：每个工人都有许多工作要做。工作线程首先启动。然后他们等到主线程分配给他们一个工作。他们完成了工作，关闭了主线程并再次返回等待。

主线程将作业分配给 N 个工作人员并通知他们开始。然后它等待它们完成并恢复正常工作。

每个工作线程都有一个名为 workerCtx 的上下文变量。这存储了工作人员所需的所有相关信息以及互斥锁和 cond 变量。

主线程也有一个互斥锁和一个 cond 变量。

父级也有一个名为 threadCompletionCount 的变量。在分配工作之前，该变量最初为 0。一旦每个工作线程完成，它将在互斥锁的保护下将该变量加一并向父线程发出信号。当这个变量等于worker的数量时，父线程就会知道所有的worker都已经完成了。

这是workerCtx的简短版本

```
typedef enum {INITIALIZE = 0 , WAIT = 1, WORK1 = 2, WORK2 =3, DIE = 4} worktype_t;

typedef struct workerCtx_t
{
    int id;

    pthread_mutex_t mutex;
    pthread_cond_t cond;

    pthread_mutex_t * parentMutex;
    pthread_cond_t * parentCond;
    int * parentThreadCompletionCount;

    worktype_t workType;

    //Other application specific variables follow.
}workerCtx_t; 
```

这里 mutex 和 cond 指的是特定于该线程的本地 mutex 和 cond 变量。parentMutex 和 parentCond 是引用父级变量的变量。所有线程都指向相同的 parentMutex 和 parentCond。

以下是主线程的工作方式：

```
void waitForWorkerCompletion()
{
    int status;

    status = pthread_mutex_lock(&mutex);
    while (threadCompletionCount < NUM_WORKERS) 
    {
        status = pthread_cond_wait(&cond, &mutex);
    }
    status = pthread_mutex_unlock(&mutex);

    status = pthread_mutex_lock(&mutex);
        threadCompletionCount = 0;
    status = pthread_mutex_unlock(&mutex);
}

void assignWorkToWorker(worktype_t workType)
{
    for(int i=0; i<NUM_WORKERS; i++)
    {
        pthread_mutex_lock(&(workerCtxs[i]->mutex) );
            workerCtxs[i]->workType = workType;
            pthread_cond_signal(&(workerCtxs[i]->cond) );
        pthread_mutex_unlock(&(workerCtxs[i]->mutex));      
    }
    waitForWorkerCompletion();
}

void setup
{
    for(int i=0; i<NUM_WORKERS; i++)
    {       
        workerCtxs[i]->id = i;
        workerCtxs[i]->workType = WAIT;

        assert( pthread_mutex_init(&(workerCtxs[i]->mutex), NULL) == 0) ;
        assert( pthread_cond_init(&(workerCtxs[i]->cond), NULL) == 0);

        workerCtxs[i]->parentMutex = &mutex;
        workerCtxs[i]->parentCond = &cond;
        workerCtxs[i]->parentThreadCompletionCount = &threadCompletionCount;

        pthread_create (&(workers[i]), NULL, workerMain, (workerCtxs[i]) );

    }
}

int main()
{
    setup()

    For each work (workType_t workType) that comes up
        assignWorkToWorker(workType);
} 
```

以下是每个工人的工作：

```
void signalCompletion(workerCtx_t * ctx)
{
    pthread_mutex_lock(&ctx->mutex);
        ctx->workType = WAIT;
    pthread_mutex_unlock(&ctx->mutex);

    int rc = pthread_mutex_lock(ctx->parentMutex);
        *(ctx->parentThreadCompletionCount) = *(ctx->parentThreadCompletionCount) + 1;
        pthread_cond_signal(ctx->parentCond);
    rc = pthread_mutex_unlock(ctx->parentMutex);
}

void * workerMain(void * arg)
{
    workerCtx_t * ctx = (workerCtx_t *) arg;

    while(1)
    {
        pthread_mutex_lock(&ctx->mutex);
        while(ctx->workType == WAIT);
        {
            int status = pthread_cond_wait(&ctx->cond, &ctx->mutex);
        }
        pthread_mutex_unlock(&ctx->mutex);

        if(ctx->workType == INITIALIZE)
        {
            init(ctx);
            signalCompletion(ctx);
        }
        else if(ctx->workType == WORK1)
        {
            doWork1(ctx);
            signalCompletion(ctx);
        }
        else if(ctx->workType == WORK2)
        {
            doWork2(ctx);
            signalCompletion(ctx);
        }
        else if(ctx->workType == DIE)
        {
            signalCompletion(ctx);
            break;
        }
    }

    return NULL;
} 
```

我希望我已经使这很容易理解，并从发布的代码中删除了所有面向应用程序的细节。此代码仅处理多线程部分。现在程序挂起。当我使用 gdb 时，它告诉我它正在*waitForWorkerCompletion()*方法中等待。

这个多线程模型正确吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T00:09:58.557

什么鬼，我会回答这个问题。

以下行看起来非常可疑：

```
while(ctx->workType == WAIT); 
```

我不认为你想要那里的分号。有了它，您会遇到各种奇怪的竞争条件......这可以解释为什么非优化和优化构建之间的行为不同。

否则，我认为这段代码没有任何问题。使用工作池的方式有点奇怪，但在我看来它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T23:44:28.327

假设您在某处有以下全局声明，我看不出有什么问题：

```
pthread_cond_t cond = PTHREAD_COND_INITIALIZER;
pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;
int threadCompletionCount = 0;
workerCtx_t workerCtxs[NUM_WORKERS]; 
```

# android - 在 Intent.ACTION_SEND 期间恢复应用程序而不会丢失最后一个活动

> ID：12187644
> 
> 赞同：0
> 
> 时间：2012-08-29T22:59:50.473
> 
> 标签：android, android-intent

我的恢复/暂停应用程序有问题。现在，假设我们有一个我覆盖`onBackPressed()`方法并为此方法重新定义的活动，如下所示：

```
@Override
public void onBackPressed() {
    moveTaskToBack(true);
} 
```

所以，它在后台运行没有任何问题。因此，为了恢复我的应用程序，我在`onResume()`override 方法中声明了以下代码：

```
@Override
protected void onResume() {
    Intent resume = new Intent(this, MainActivity.class);
    if ((resume.getFlags() & Intent.FLAG_ACTIVITY_REORDER_TO_FRONT) != 0) {
        resume.setFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT);
        Logger.e(M_tag, "Resume Activity");
        startActivity(resume);
        return;
    }

    super.onResume();
} 
```

最小化进程后，我可以成功恢复活动，但我面临的问题是，当我长按链接`Internet Browser`并与我的应用程序共享链接时，它会恢复活动但不运行条件

```
if (getIntent().getAction().equals(Intent.ACTION_SEND)) 
```

我在`onCreate()`覆盖方法中定义的，如下所示：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    if (getIntent().getAction.equals(Intent.ACTION_SEND))
        Log.e("App", "In action send mode");
} 
```

I've tested `Intent.ACTION_SEND` action while no process in background, and it successfully runs the condition, but now, how can I force my applicatin to run `ACTION_SEND` intent ?

Thanks in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T00:02:34.470

If you are not getting OnCreate for a new intent you will be getting [OnNewIntent](http://developer.android.com/reference/android/app/Activity.html#onNewIntent%28android.content.Intent%29).

Handle the intent again in this method.

# java - java utf8 编码 - 字符、字符串类型

> ID：12187645
> 
> 赞同：22
> 
> 时间：2012-08-29T22:59:51.360
> 
> 标签：java, utf-8

```
public class UTF8 {
    public static void main(String[] args){
        String s = "ﾖ"; //0xFF6E
        System.out.println(s.getBytes().length);//length of the string
        System.out.println(s.charAt(0));//first character in the string
    }
} 
```

**输出：**

```
3
ﾖ 
```

请帮助我理解这一点。试图了解 utf8 编码在 java 中是如何工作的。根据 char **char 的 java doc 定义： char 数据类型是单个 16 位 Unicode 字符。**

这是否意味着java中的char类型只能支持那些可以用2个字节表示的unicode字符而不是更多？

在上面的程序中，为该字符串分配的字节数为 3，但是在返回第一个字符（java 中为 2 个字节）的第三行中可以容纳一个 3 个字节长的字符？真的很困惑吗？

在 java/general 中有关此概念的任何良好参考将不胜感激。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-29T23:27:41.557

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T23:10:45.413

`String.getBytes()`使用不需要匹配内部表示的平台的默认字符编码返回字节。

在大多数情况下，最好不要使用这种方法，因为在大多数情况下，依赖平台的默认编码是没有意义的。改为使用`String.getBytes(String charsetName)`并明确指定应用于将字符串编码为字节的字符集。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-29T23:07:22.543

UTF-8 是一种可变长度编码，ASCII 字符仅使用一个字节（0 到 127 之间的值），其他 unicode 符号使用两个、三个（甚至更多）字节。

这是因为字节的高位用于告诉“这是一个多字节序列”，所以 8 上的一位并不是用来实际表示“真实”数据（字符代码）而是用来标记字节。

因此，尽管 Java 在 ram 中为每个字符使用 2 个字节，但当使用 UTF-8 对字符进行“序列化”时，它们可能会在结果字节数组中产生一个、两个或三个字节，这就是 UTF-8 编码的工作方式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-29T23:09:51.430

这就是[Java 表示字符](http://docs.oracle.com/javase/7/docs/api/java/lang/Character.html#unicode)的方式。

# c# - 串行数据仅适用于消息框

> ID：12187652
> 
> 赞同：1
> 
> 时间：2012-08-29T23:00:45.917
> 
> 标签：c#, visual-studio-2010, serial-port

在通过串行端口接收数据的处理程序中，当接收到数据时，我将其存储到一个字符串中并执行 .contains 搜索以确定是否需要对数据进行处理。当应用程序处于空闲状态并且（让我们称之为调制解调器）发送类似“已连接”的内容时，它可以正常工作。

问题是当我轮询机器时。当我启动一个期望返回结果的命令时它不起作用，我不知道为什么。现在，如果我使用消息框启动该功能，它将起作用。我宁愿没有不必要的消息框。

这是我的代码示例。

```
private void DataReceivedHandler(object sender, SerialDataReceivedEventArgs e)
{
    if (this.InvokeRequired)
    {
        RefreshTextBox d = new RefreshTextBox(RefreshTextBoxResults);
        Invoke(d);
    }
    else
    {
        RefreshTextBoxResults();
    }
}

private void RefreshTextBoxResults()
{
    //MessageBox.Show("refresh text is occurring");
    indata1 = serialPort1.ReadExisting();
    rx.AppendText(indata1);

    string dataCheck = indata1.ToUpper();

    //MessageBox.Show(dataCheck);
    if (indata1.ToUpper().Contains("CONNECT"))//dataCheck.Contains("CONNECT"))
    {
        // MessageBox.Show("connect");
        cState.Text = "Connected";
        if(connected==false)
            connectLink();
    }
    if (dataCheck.Contains("CONNECTED"))
    {
        // MessageBox.Show("Active Call in Session");
        cState.Text = "Connected";
        if (connected==false)
            connectLink();
    }
    if (dataCheck.Contains("NO"))
    {
        cState.Text = "Disconnected";
        disconnect();
    }
    if (dataCheck.Contains("CAMPOS"))
    {
        campos = indata1;
        camDat = true;
    }
}

private void cState_Click(object sender, EventArgs e)
{
    writeDevice("callstatus");
}

public void writeDevice(string cmd)
{
    try
    {
        {
            serialPort1.Write(cmd + "\r\n");
        }
    }
    catch
    { noconnect(); }
} 
```

当我执行 cstate() 时，它应该返回呼叫状态和类型（如果有）。正如我在提示框中看到的那样，调制解调器确实会响应。如果单词 connected 在那里的任何地方它应该将标签的文本更改为“Connected”。随着代码的放置，该标签没有任何反应。但是，如果我删除 RefreshTextBoxResults() 中第一行的注释，使 MessageBox 处于活动状态，它会检测调制解调器的状态。

我只是不明白发生了什么。有人可以向我解释为什么会这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T23:50:34.670

> 但是，如果我删除 RefreshTextBoxResults() 第一行的注释

这是关键短语。问题是您使用 ReadExisting()。串行端口非常慢，您的 DataReceived 事件处理程序通常只会得到一两个字符。通过显示消息框，您可以*减慢它*的速度。这允许串行端口驱动程序读取*更多*字符。ReadExisting 足以读取整个“Connected”字符串，而不仅仅是“C”或“Co”。

当您使用调试器时也很难诊断，单步执行代码也会减慢它的速度，以允许端口获得足够的字符。

您需要做的是*仅*在获得整个响应字符串后才处理响应。使用调制解调器总是很容易，只需使用 ReadLine() 而不是 ReadExisting()。您可能需要调整 NewLine 属性的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T23:27:55.333

`MessageBox()` starts a modal dialog message loop, which will allow queued window messages an opportunity to be processed. It's conceivable that some of the manipulations you're doing to the textbox control in your RefreshTextboxResults() function post messages to the control window handle. If this is the case, the window handle won't receive such messages until execution flow enters or returns to the message loop. That will happen in your function if you open a modal dialog (like MessageBox).

Not that this is a solution, but it should confirm this theory: try replacing `MessageBox()` with a call to `Application.DoEvents()`. (Assuming your app is a WinForms app) If this clears up the blockage to the same degree as calling `MessageBox()`, then it's pretty clear that you have some pending messages piled up in the message queue that need to be dealt with.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T17:58:45.727

我建议您阻止应用程序，直到完全收到数据，或者您可以使用后台踏板为您完成这项工作。

# php - 使用 MySQL 查询列出 PHP 中的所有社区成员

> ID：12187655
> 
> 赞同：1
> 
> 时间：2012-08-29T23:01:00.923
> 
> 标签：php, mysql, while-loop

我想在我的索引页面中列出我网站的所有成员，但我不知道该怎么做，我尝试使用 while 循环但它变成了无限循环，因为我只是告诉它它小于整数 exc ..

这是我的代码：

```
<?php
$profile_query = "SELECT * FROM `members` ORDER BY `join_date` DESC";
$profile_query_check = $db->prepare($profile_query);
$profile_query_check->execute();
$ac = $db->query("SELECT FOUND_ROWS()")->fetchColumn();
if(!empty($ac)) {
$_loader = true;
$fetch = $profile_query_check->fetch (PDO::FETCH_ASSOC);
$profile_name = $fetch['profile_name'];
$profile_photo = $fetch['profile_photo'];
$profile_id = $fetch['profile_id'];

while($profile_id <1000) { // this is the place i want to change to make it working well :)
?> 
<li><a href="http://mywebsite.com/profiles/<?php echo $profile_id;?>">  
<img src="http://mywebsite.com/photos/<?php echo $profile_photo;?>" />
<br>  
<?php echo $profile_name; ?></a></li>  
<?php } ?> 
```

正如我所说，它的打印效果很好，但是页面变得疯狂并且无限循环开始，并且我的浏览器变得疯狂:) 我可以在这里应用任何 mysql 或 php 函数来获取所有行以及它停止的位置，停止打印或类似的东西

谢谢你的建议。

问候

编辑：迈克尔修复了错误，但这次它显示了除最后一个之外的所有配置文件，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:08:29.877

我认为你应该把它改成这样：

```
while ($fetch = $profile_query_check->fetch (PDO::FETCH_ASSOC)) {
    if ($fetch == NULL OR $fetch["profile_id"] > 1000) {
        break;
    }

    $profile_name = $fetch['profile_name'];
    $profile_photo = $fetch['profile_photo'];
    $profile_id = $fetch['profile_id'];

    //echo the profile info
} 
```

否则，您现在的操作方式是仅从返回的数据中获取一行，因此 profile_id 将始终小于 1000（除非返回的第一个大于 1000）

# python - 将手动包装方法添加到 Swig 输出

> ID：12187658
> 
> 赞同：2
> 
> 时间：2012-08-29T23:01:18.810
> 
> 标签：python, swig

我有一个 SWIG 模块，我想在其中添加一个手动方法。

```
%module frob

%inline %{

    int Foo(int x, int y) { return x+y; }

    PyObject* Bar(PyObject* self, PyObject* args) {
        return PyString_FromString("Hello from Bar");
    }
%} 
```

但是，当我在它上面运行 swig 时`swig -python frob.i`，我看到 SWIG 实际上将 Foo 和 Bar 都包装为 _wrap_Foo、_wrap_Bar。

```
 SWIGINTERN PyObject *_wrap_Foo(PyObject *SWIGUNUSEDPARM(self), PyObject *args) {
   // ...
   result = (int)Foo(arg1,arg2);
   // ...
 }    
 SWIGINTERN PyObject *_wrap_Bar(PyObject *SWIGUNUSEDPARM(self), PyObject *args) {
   // ...
   result = (PyObject *)Bar(arg1,arg2);
   // ... 
} 
```

如何告诉 SWIG 停止为我包装 Bar，而只是在 PyMethodDef 表中公开它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:59:57.010

要从包装中排除函数，请使用 %native 指令。

```
%module "test"

/* Prototype */    
%native(DontWrapMeBro)
PyObject* DontWrapMeBro(PyObject* self, PyObject* args);

%{
  PyObject* DontWrapMeBro(PyObject* self, PyObject* args)
  {
    return PyString_AsString("Don't wrap me");
  }
%} 
```

# android - 如何检查两个已安装的应用程序是否使用相同的共享用户标签？

> ID：12187660
> 
> 赞同：0
> 
> 时间：2012-08-29T23:01:37.960
> 
> 标签：android

如何扫描 android 设备上已安装的应用程序并查找是否有两个应用程序正在使用相同的应用程序`SharedUserLabel`？然后列出这些应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:33:15.373

尝试这个。您可以使用标签字符串并将其添加到地图中，然后根据需要进行排序

```
 List<PackageInfo> pkgs = context.getPackageManager().getInstalledPackages(0);
        for (int i=0; i<pkgs.size(); i++) {
            MyPackageInfo info = new MyPackageInfo();
            info.info = pkgs.get(i);

            if(info.sharedUserLabel != 0) {
             // you can use label to get the label
                    CharSequence label = pm.getText(name,
                            info.sharedUserLabel, info.applicationInfo);
             }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T23:33:25.403

错误...这样的事情...可能不是一个完美的解决方案

```
PackageManager pm = getPackageManager();
List<ApplicationInfo> packages = pm.getInstalledApplications(PackageManager.GET_META_DATA);

for (ApplicationInfo packageInfo : packages) {
    packageInfo.sharedUserLabel()
} 
```

.. 请参阅此链接以获取[packageinfo](http://developer.android.com/reference/android/content/pm/PackageInfo.html)基本上列出了所有已安装的软件包，然后遍历它们以查看哪个具有您感兴趣的 shareduserlabel

# iphone - 需要有关 Apple 开发计划的一些信息

> ID：12187662
> 
> 赞同：0
> 
> 时间：2012-08-29T23:01:46.743
> 
> 标签：iphone, ios, xcode

我到处搜索，但似乎找不到答案。如果您不是官方开发者，您能否制作一个供您个人使用的应用程序，例如支付 99 美元/年。我是开发者计划的成员，我想，我可以登录，但我不支付 99。我制作了一个应用程序，我真的很想在我的 iPhone 上试用，但不知道如何......谢谢.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T23:04:11.890

不。 99 美元让您获得的部分内容是能够在您的设备上运行构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T23:25:26.157

只是为了说清楚。您还有另外两个选择：

1- 与朋友分享开发者资料，只要你们俩都将其仅用于开发目的。

2-越狱您的设备。“我反对那个选项”

3-注册付费开发者计划。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T00:16:05.560

没有付费开发者计划，您无法构建到设备，但我相信如果您从未向应用商店发送应用提交，Apple 会停用您的帐户。

# ruby-on-rails - 需要帮助了解 ActiveRecord 的工作原理

> ID：12187663
> 
> 赞同：0
> 
> 时间：2012-08-29T23:02:04.743
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

以下面的基本论坛为例。

```
class Forum < ActiveRecord::Base
  has_many :topics, :dependent => :destroy
end

class Topic < ActiveRecord::Base
  belongs_to :forum
  belongs_to :user
  has_many   :posts, :dependent => :destroy
end

class Post < ActiveRecord::Base
  belongs_to :topic
  belongs_to :user 
end

class User < ActiveRecord::Base
  has_many :posts
  has_many :topics
end 
```

现在说我想添加获取每个论坛的“最后一篇文章”信息的能力。我的论坛表有一个名为“last_post_id”的列，其中包含在所述论坛中发布的最后一篇帖子的 ID。如果我了解活动记录的工作原理，我需要在我的论坛模型中添加“has_one”关系并指定我要使用的主键，如下所示：

class Forum < ActiveRecord::Base has_many :topics, :dependent => :destroy has_one :last_post, :class_name => 'Post', :primary_key => :last_post_id end

然后我的查询将如下所示：

```
@forums = Forum.all(:include => [:last_post]) 
```

到目前为止这是正确的吗？但是假设我还想获取发布最后一篇文章的用户信息。好吧，我的 post 表有一个我可以使用的“user_id”列。我是否需要像使用 last_post 一样创建“has_one”关系？这似乎不起作用：

```
class Forum < ActiveRecord::Base
  has_many :topics, :dependent => :destroy
  has_one :last_post  , :class_name => 'Post', :primary_key => :last_post_id 
  has_one :last_poster, :class_name => 'User', :primary_key => :last_post_user_id
end 
```

如何使用 last_post.user_id 的值从用户表中获取用户信息。原始查询看起来像这样：

```
SELECT forums.*, 
       last_post.id              as last_post_id,
       last_post.user_id         as last_post_user_id,
       last_post_user.username   as last_post_username,
  FROM forums as forums
 INNER JOIN posts  as last_post      ON last_post.id       = forums.last_post_id
 INNER JOIN users  as last_post_user ON last_post.user_id  = last_post_user.id 
```

请注意，我使用 last_post.user_id 获取用户信息。你如何使用rails做到这一点？目标是让以下变量可用于在视图中呈现最后的帖子信息。

```
forum.last_post.date       # the last post object
forum.last_poster.username # the user object who created the last post 
```

我是否理解这是如何正常工作的，我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:07:39.920

我会说论坛模型上的 last_poster 似乎是必要的。因为只有一个，所以当我在视图中调用该信息时，我可能会懒惰地加载它。

因此，当您在视图中工作时，只需执行 forum.last_post.user.username

# matlab - Matlab如何从文本中读取矩阵

> ID：12187664
> 
> 赞同：0
> 
> 时间：2012-08-29T23:02:08.287
> 
> 标签：matlab, file-io

前几天碰到这个问题，我不是一个程序员，老师让我们做一个程序，从一个txt中读取一个方阵。然后使用信息来解决它。我一直想知道如何执行该程序的第一部分，因为我已经弄清楚如何解决矩阵，但我只是不知道如何扫描文本。只是为了让你们能理解我，这就是文本的样子：

4

1 2 3 8

7 4 1 2

1 2 1 2

3 4 5 6

如您所见，它必须读取第一个数字并将其存储在一个变量中，以便程序知道矩阵的大小，然后读取矩阵并将其存储在一个数组中，或者我认为。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:35:26.260

假设`file.txt`是

> 1 2 3 8
> 
> 7 4 1 2
> 
> 1 2 1 2
> 
> 3 4 5 6

命令是

> 加载文件.txt

然后你得到一个变量**文件**

**文件**大小为**[4,4]**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T00:57:18.717

```
D = importdata('file.txt');
rows = D(1);
cols = (numel(D)-1)/rows;
D = reshape(D(2:end),[cols rows])'; 
```

（最好的 MATLAB 解决方案是删除开头的行数。然后`importdata`就足够了）

# java - 在html中集成小程序？

> ID：12187666
> 
> 赞同：1
> 
> 时间：2012-08-29T23:02:23.183
> 
> 标签：java, html, applet, classnotfoundexception

```
<html>
<applet code="de.wim.outldd.examples.DragDropTest_ModeMemoryStream" archive="outIdd.jar" width="500" height="500"/>

</html> 
```

我尝试在 HTML中打开这个[小程序，但我得到一个 ClassNotFoundException。](http://www.wilutions.com/outldd/download.html)html 与 .jar 位于同一目录中。在代码属性中，我将目录结构放在 .jar 中的类中。有人请试试这些。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T00:37:57.050

```
<applet 
  code="de.wim.outldd.examples.DragDropTest_ModeMemoryStream" 
  archive="outIdd.jar" 
  width="500" 
  height="500"/> 
```

小程序元素曾经打算自封闭，即 jar 名称中的小写“l”（用于 Lucy）而不是大写“I”（用于 Imogen）。所以元素应该是这样的：

```
<applet 
  code="de.wim.outldd.examples.DragDropTest_ModeMemoryStream" 
  archive="outldd.jar" 
  width="500" 
  height="500">
</applet> 
```

# html - Facebook Box Count Like 按钮垂直对齐

> ID：12187667
> 
> 赞同：1
> 
> 时间：2012-08-29T23:02:23.607
> 
> 标签：html, css, alignment

![在此处输入图像描述](../Images/8ed1b31d577cf48dc041ad5703ae58f2.png)

我正在使用这种按钮。如何将其与其他按钮（G+、Twitter 等）垂直对齐？

因为`vertical-align: top`对于这种盒子计数没有正确对齐。

```
<div class=fb-like data-layout=box_count></div>
<a class=twitter-share-button href=//twitter.com/share data-count=vertical data-dnt=true>Tweet</a>
<div class=g-plusone data-size=tall></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:34:21.150

```
.fb-like{
position:relative;
top:-20px; //adjust to your needs
} 
```

`vertical-align`我猜适用于`inline`和`inline-block`元素，您应该将此样式放在父元素上而不是`.fb-like`

# javascript - 如何可靠地执行通过 phantomjs 使用 requirejs 的 Jasmine 测试？

> ID：12187669
> 
> 赞同：4
> 
> 时间：2012-08-29T23:02:26.457
> 
> 标签：javascript, unit-testing, jasmine, phantomjs

我正在使用 phantomjs 运行 jasmine 测试。我的 jasmine 测试在 describe 块周围使用 require 以确保加载所有正确的模块。

我的测试不会运行，因为`page.evaluate -> jasmine.getEnv().execute();`在 requirejs 完成加载模块之前运行。

我想知道是否有人知道解决这个问题的真正好方法。我有一个答案，我将在下面发布，但很想通过其他答案比较笔记。如果你的更好，我会明确选择它作为答案:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T16:37:35.647

我做了一些不同的事情——我的 HTML 页面有一个函数，包含在一个 require() 调用中：

```
var run_tests = function (specfiles) {
    require(specfiles, function () {
        jasmine.getEnv().execute();
    });
}; 
```

然后我`page.evaluate( function (test_specs) { run_tests(test_specs) }, ['test1.spec', 'test2.spec']);`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T23:10:26.173

我使用 jQuery 的解决方案是：

在任何测试运行之前加载配置文件。

```
var jasmine_deferreds = [];

// Setup an event to fire on the document
// I actually did this with native code rather than jquery because
// I wanted to minimize jquery usage

// ....

// setTimeout so all files loaded after this will finish registering their requires
setTimeout( function() {

  $.when.apply( null, jasmine_deferreds ).then( function() {

    // Fire event that was created

  });

}, 5 ); 
```

如何构建延迟数组然后解决它们取决于您。我基本上推到了数组，然后在要求完成后解决。我用我自己的版本包装了 require ，它知道在完成后自动解决它 - 所以我不需要在每个测试中手动推送和解决。

然后在我的幻像文件中我这样做：

```
page.evaluate ->
    mylistener = ( document ) -> jasmine.getEnv().execute();
    document.addEventListener( 'test_ready_event', mylistener, false); 
```

这使得我知道我所有的 require 模块都被加载了，而`setTimeout`一旦我加载了太多文件，就没有一些可能太短的任意模块。我正在使用的那个`setTimeout`是安全的，因为它只在主调用堆栈完成后被用来触发。它并不真正关心时间。

# django - 如何更改 django 的 selectDateWidget 的年份选项

> ID：12187671
> 
> 赞同：2
> 
> 时间：2012-08-29T23:02:42.967
> 
> 标签：django, django-widget

我想将 django 的 selectDateWidget 用于表单，但多年的选项是从 2012 年到 2021 年。我需要显示过去几年，可能到 1980 年。如何修改 selectDateWidget？

```
lessTime = forms.DateField(required=False, widget=SelectDateWidget()) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-29T23:06:15.697

传递一个`years`参数：

```
lessTime = forms.DateField(required=False, 
                           widget=SelectDateWidget(years=range(1980, 2012))) 
```

# ios - 以编程方式切换 TabBarController 视图时未调用 ViewDidAppear

> ID：12187676
> 
> 赞同：0
> 
> 时间：2012-08-29T23:03:06.020
> 
> 标签：ios, iphone, uitabbarcontroller

我正在以编程方式从模态视图控制器切换 TabBarController 视图（请参阅[此问题](https://stackoverflow.com/questions/12181677/programmatically-switch-parent-tabs-from-modal-view-controller)）。委托正确地切换选项卡，但`viewDidAppear`没有在新呈现的选项卡中被调用。有没有办法强制 viewDidAppear 被调用？还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T04:14:27.707

终于弄明白了——这是因为我在关闭模式视图之前调用了选项卡开关。一旦我切换了订单，它就可以正常工作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-30T00:09:03.483

强制调用viewDidAppear；

```
- (void)viewController:(YourViewControllerSubclass *)viewController isBeingDismissedWithImage:(BOOL)imageTaken {
  // Select the tabbar index (which is the second controller)
  [secondController viewDidAppear:YES];
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-02-14T07:53:13.490

I had the same issue before. In my TabBarViewController's `viewDidLoad()`, I selected other tab programatically as `selectedIndex = 3`. The target viewController's `viewDidAppear()` isn't called. But if I move `selectedIndex = 3` from `viewDidLoad()` to `viewDidAppear()`, the problem is solved.

# ios - 如何在多线程环境下实现核心数据

> ID：12187677
> 
> 赞同：2
> 
> 时间：2012-08-29T23:03:14.183
> 
> 标签：ios

我正在尝试在多线程环境中实现核心数据实体。我了解 iOS 指南，每个线程都有私有托管对象上下文。我已经阅读了 UIManagedDocument 如何与核心数据对象很好地集成。任何人都可以建议，如果使用 UIManagedocument 是推荐的方法？由于这是在 iOS-5 中发布的，我的应用程序可以在具有 i0s 4.3.3 或更早版本的设备上运行吗？另外，有人可以向我推荐一些可以指导我了解该主题的教程/示例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T01:35:40.073

核心数据很简单。直到您使用多个 MOC 和线程。然后，你必须非常迅速地关注很多细节。

不，iOS 5 中引入的 Core Data 内容**不**向后兼容以前的版本。

以下是一般并发指南：http: [//developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008091](http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008091)

并与特定的核心数据并发：http: [//developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreData/Articles/cdConcurrency.html#//apple_ref/doc/uid/TP40003385-SW1](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreData/Articles/cdConcurrency.html#//apple_ref/doc/uid/TP40003385-SW1)

如果您使用核心数据编写多线程程序，并且没有阅读这些文档（至少），那么您只是在自找麻烦……您应该得到所有。

# jquery-ui - jQuery Mobile UI 和 URL 框架屏幕在移动设备上呈现太小

> ID：12187681
> 
> 赞同：0
> 
> 时间：2012-08-29T23:04:20.823
> 
> 标签：jquery-ui, url, mobile, jquery-mobile

我正在使用 URL 框架来显示我的网络应用程序，而不是讨厌的 EC2 网址。但是，当我尝试在使用 URL 框架的移动设备上查看屏幕时，窗口大小非常大，比手机大得多。如果我不使用 URL 框架，那么屏幕会小得多并放大。我假设当我调整窗口大小时，它会获得框架的大小，而不是手机上的实际浏览器窗口。

如何仍然使用 URL 框架并将窗口大小设置为手机的宽度/高度？

这是丑陋的屏幕：
![这是丑陋的画面](../Images/f7756d611cb5815fe3e680d22c30f021.png)

这就是我想要的样子：
![这就是我希望屏幕的样子](../Images/d4cc2108c2acfdf2f91a5bbee5636e67.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T05:54:31.883

正如@Jasper 在评论中提到的那样，使用 Route 53 和 EC2 作为 DNS 服务器就可以了。

# c# - 如何使用 STUN 协议从 Window Phone 7 获取公共 IP 地址？

> ID：12187685
> 
> 赞同：-1
> 
> 时间：2012-08-29T23:04:33.103
> 
> 标签：c#, windows-phone-7, networking

我知道还有其他选择，我们可以在 findmyip 之类的网站上获取 IP。但我有一个要求使用 STUN 协议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T20:11:37.483

这是 C# 的 STUN-Client，您可以将其用作为 Windows Phone 7 实现相同代码的起点。[http://www.codeproject.com/Articles/18492/STUN-Client](http://www.codeproject.com/Articles/18492/STUN-Client)

此 Microsoft 页面描述了在 Windows Phone 7 上使用 C# 创建 UDP 套接字：http: [//msdn.microsoft.com/en-us/library/windowsphone/develop/hh202864%28v=vs.92%29.aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202864%28v=vs.92%29.aspx)

# objective-c - 当 AVQueuePlayer 完成最后一个播放项时如何做某事

> ID：12187686
> 
> 赞同：6
> 
> 时间：2012-08-29T23:04:39.297
> 
> 标签：objective-c, ios, avqueueplayer

我有一个 AVQueuePlayer，它是从 4 个 AVPlayerItems 的数组中创建的，并且一切正常。

我想在队列中的最后一个项目播放完毕时做点什么，我在这里看了很多答案，这是我想要的最有希望的答案： [声音完成后执行代码的最佳方法玩](https://stackoverflow.com/questions/10604740/the-best-way-to-execute-code-after-a-sound-has-finished-playing)

在我的按钮处理程序中，我有以下代码：

```
static const NSString *ItemStatusContext;

    [thePlayerItemA addObserver:self forKeyPath:@"status" options:0 context:&ItemStatusContext];
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(playerItemDidReachEnd)
                                                 name:AVPlayerItemDidPlayToEndTimeNotification
                                               object:thePlayerItemA];

     theQueuePlayer = [AVQueuePlayer playerWithPlayerItem:thePlayerItemA]; 

    [theQueuePlayer play]; 
```

然后我有一个函数来处理 playerItemDidReachEnd：

```
- (void)playerItemDidReachEnd:(NSNotification *)notification {
// Do stuff here
NSLog(@"IT REACHED THE END");
} 
```

但是当我运行它时，我得到一个内部不一致异常：

```
 An -observeValueForKeyPath:ofObject:change:context: message was received but not handled.
Key path: status
Observed object: <AVPlayerItem: 0x735a130, asset = <AVURLAsset: 0x73559c0, URL = file://localhost/Users/mike/Library/Application%20Support/iPhone%20Simulator/5.0/Applications/A0DBEC13-2DA6-4887-B29D-B43A78E173B8/Phonics%2001.app/yes.mp3>>
Change: {
    kind = 1; 
```

}

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-30T21:36:58.073

这种方法似乎对我有用，在我的按钮处理程序中，我有很多东西可以为我想播放的 4 个 mp3 文件创建 URL，然后：

```
AVPlayerItem *thePlayerItemA = [[AVPlayerItem alloc] initWithURL:urlA];
AVPlayerItem *thePlayerItemB = [[AVPlayerItem alloc] initWithURL:urlB];
AVPlayerItem *thePlayerItemC = [[AVPlayerItem alloc] initWithURL:urlC];    
AVPlayerItem *thePlayerItemD = [[AVPlayerItem alloc] initWithURL:urlD];  

NSArray *theItems = [NSArray arrayWithObjects:thePlayerItemA, thePlayerItemB, thePlayerItemC, thePlayerItemD, nil];
theQueuePlayer = [AVQueuePlayer queuePlayerWithItems:theItems];

[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(playerItemDidReachEnd:)
                                             name:AVPlayerItemDidPlayToEndTimeNotification
                                           object:[theItems lastObject]];
[theQueuePlayer play]; 
```

之后我实现了这样的“playerItemDidReachEnd”选择器：

```
- (void)playerItemDidReachEnd:(NSNotification *)notification {
    // Do stuff here
    NSLog(@"IT REACHED THE END");
} 
```

这会将 4 个 MP3 文件排队，然后当最后一段音频完成时，它会调用选择器，并且我的消息会出现在控制台中。

我希望这对其他人有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-29T11:53:25.700

观察状态不会告诉您项目何时完成播放（它只会告诉您项目何时准备播放）

您所要做的就是为`AVPlayerItemDidPlayToEndTimeNotification` **您的playbackQueue 中的lastItem 注册，用于**初始化您的`AVQueuePlayer`实例。

```
AVQueuePlayer* player = [AVQueuePlayer queuePlayerWithItems:currentPlaybackQueue];
[[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(playerItemDidReachEnd:)
                                                 name:AVPlayerItemDidPlayToEndTimeNotification
                                               object:currentPlaybackQueue.lastObject]; 
```

（注意选择器有`playerItemDidReachEnd:`，你忘了两个点）

所以 then`-playerItemDidReachEnd:`只会在你需要的时候被调用一次。（也不要忘记将自己移除为观察者 - 你可以在`-playerItemDidReachEnd:`using中做到这一点`notification.object`）

不得不说，还有**其他方法可以做到这一点**：对 currentItem 使用 key-value 观察，然后检查 currentItem 是否更改为`[NSNull null]`in `observeValueForKeyPath:`。

```
[player addObserver:self forKeyPath:@"currentItem" options:NSKeyValueObservingOptionNew context:nil];

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
    if ([keyPath isEqualToString:@"currentItem"]) {

        if (change[NSKeyValueChangeNewKey] == [NSNull null]) {
            //last item finished playing - do something

        }
    }
} 
```

通常，`AVQueuePlayer`您将为`AVPlayerItemDidPlayToEndTimeNotification`in 中的每个项目注册`playbackQueue`，因此除非您不想在本地存储并使用in`playbackQueue`检查其 lastObject，否则您将使用第二种方式`notification.object``-playerItemDidReachEnd:`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-30T03:41:22.010

您可能没有`-observeValueForKeyPath:ofObject:change:context:`在您的类中实现该方法。查看[Apple KVO 指南](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/KeyValueObserving/Articles/KVOCompliance.html)以获取更多详细信息。

# c++ - libcurl curl_easy_setopt long 参数未正确传递 - va_arg(param, long)

> ID：12187688
> 
> 赞同：0
> 
> 时间：2012-08-29T23:04:49.223
> 
> 标签：c++, visual-studio-2010, visual-studio, libcurl

任何可能对此有所了解的 libcurl 专家？

我注意到这一点是因为我无法关闭 libcurl VERBOSE：

```
curl_easy_setopt(curl, CURLOPT_VERBOSE, 0L); 
```

当我通过对 libcurl 的调用进行跟踪时，我发现 0L（long）被转换为非零数字，导致 VERBOSE 始终处于打开状态。我没有尝试过，但我很确定任何长参数都不会正确传递。

```
data->set.verbose = (0 != va_arg(param, long))?TRUE:FALSE; 
```

在哪里

```
#define va_arg _crt_va_arg
#define _crt_va_arg(ap,t)    ( *(t *)((ap += _INTSIZEOF(t)) - _INTSIZEOF(t)) )
#define _INTSIZEOF(n)   ( (sizeof(n) + sizeof(int) - 1) & ~(sizeof(int) - 1) ) 
```

但我不确定这些在做什么。
为什么会发生这种情况以及如何解决？

我正在使用带有 libcurl 7.27.0 的 Visual Studio 2010 C++

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T01:05:00.960

`va_arg()`正在使用*指针算法*从您的`va_list param`. [您可以在此处](https://stackoverflow.com/questions/988290/populating-a-va-list)或[此处](https://stackoverflow.com/questions/4958384/what-is-the-format-of-the-x86-64-va-list-structure)阅读有关`va_list`类型的更多信息。它**不会**将您的 0L 转换为非零数字。

 **在打开连接**之前**尝试调用 curl_easy_setopt() 。该文档指出，您的详细设置是“设置一次即可进行许多独立连接”（urldata.h ln 1537）。

如果您仍然不相信它正在工作，您可以将您的 CURL* 转换为**SessionHandle***并在调试器中检查它，例如：

```
struct SessionHandle *data = reinterpret_cast<SessionHandle*>(curl);
// Inspect data->set.verbose 
```

您将在 urldata.h 中找到 SessionHandle 的定义。**

# php - Crypto++ 到 PHP mcrypt 不起作用

> ID：12187689
> 
> 赞同：2
> 
> 时间：2012-08-29T23:05:04.523
> 
> 标签：php, c++, mcrypt, crypto++

我有一个使用 Crypto++ 将加密数据发送到 PHP 站点的 C++ 应用程序。但是，当数据到达 PHP 端时，它并没有正确解密数据。

C++ / Crypto++ 代码：

```
char stupidKey[AES::MAX_KEYLENGTH] = "thisisastupidkeythisisastupidke";

ECB_Mode<AES>::Encryption aes((byte *)stupidKey, AES::MAX_KEYLENGTH);

std::string cypher;
StringSource(aData, true, new StreamTransformationFilter(aes, new StringSink( cypher ))); 
StringSource(cypher, true, new Base64Encoder( new StringSink(aOutput) )); 
```

PHP代码：

```
define('CRYPT_SECRET', 'thisisastupidkeythisisastupidke');

$postData = mcrypt_decrypt(MCRYPT_RIJNDAEL_256, 
                CRYPT_SECRET, base64_decode($_POST['request']), 
                MCRYPT_MODE_ECB); 
```

注意：我知道 ECB 是一个糟糕的加密模式选择，但我希望在没有增加 IV 的奇怪之处的情况下让它工作，然后使事情复杂化。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-18T20:16:37.750

我对 mcrypt 没有运气，但 openssl 似乎可以更好地使用 Crypto++。

这是加密++代码：

```
#include <iostream>
#include <cryptopp/aes.h>
#include <cryptopp/modes.h>
#include <cryptopp/base64.h>

std::string encrypt(const std::string& str_in, const std::string& key, const std::string& iv)
{
    std::string str_out;
    CryptoPP::CFB_Mode<CryptoPP::AES>::Encryption encryption((byte*)key.c_str(), key.length(), (byte*)iv.c_str());

    CryptoPP::StringSource encryptor(str_in, true, 
        new CryptoPP::StreamTransformationFilter(encryption, 
            new CryptoPP::Base64Encoder(
                new CryptoPP::StringSink(str_out),
                false // do not append a newline
            )
        )
    );
    return str_out;
}

std::string decrypt(const std::string& str_in, const std::string& key, const std::string& iv)
{
    std::string str_out;

    CryptoPP::CFB_Mode<CryptoPP::AES>::Decryption decryption((byte*)key.c_str(), key.length(), (byte*)iv.c_str());

    CryptoPP::StringSource decryptor(str_in, true, 
        new CryptoPP::Base64Decoder(
            new CryptoPP::StreamTransformationFilter(decryption, 
                new CryptoPP::StringSink(str_out)
            )
        )
    );
    return str_out;
}

int main(int argc, char *argv[])
{
    std::string str = "Hello, world!";
    std::string key = "01234567891234560123456789123456"; // 32 bytes
    std::string iv  = "0123456789123456"; // 16 bytes
    std::string str_encrypted = encrypt(str, key, iv);
    std::string str_decrypted = decrypt(str_encrypted, key, iv);
    std::cout << "str_encrypted: " << str_encrypted << std::endl;
    std::cout << "str_decrypted: " << str_decrypted << std::endl;
} 
```

这是PHP代码：

```
<?php
    $string = 'Hello, world!';
    $key = '01234567891234560123456789123456'; // 32 bytes
    $iv  = '0123456789123456'; // 16 bytes
    $method = 'aes-256-cfb';
    $encrypted = base64_encode( openssl_encrypt ($string, $method, $key, true, $iv));
    $decrypted = openssl_decrypt( base64_decode($encrypted), $method, $key, true, $iv);
    echo "encrypted: $encrypted<br/>";
    echo "decrypted: $decrypted<br/>";
?> 
```

这是 Crypto++ 输出：

```
str_encrypted: pF1gsk+GolfeTSYnEQ==
str_decrypted: Hello, world! 
```

...和 ​​PHP 输出：

```
encrypted: pF1gsk+GolfeTSYnEQ==
decrypted: Hello, world! 
```

不要忘记将 key 和 iv 更改为一些更智能的值 :o)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-29T23:12:13.377

查看 PHP 手册（http://php.net/manual/en/function.mcrypt-decrypt.php），MCRYPT_RIJNDAEL_256 与 AES_256 不同。第一条评论提供了一些帮助：[http ://www.php.net/manual/en/function.mcrypt-decrypt.php#105985](http://www.php.net/manual/en/function.mcrypt-decrypt.php#105985)

> 注意，MCRYPT_RIJNDAEL_256 不等同于 AES_256。
> 
> 使用 openssl 从 AES 解密 RIJNDAEL 的方法是使用 MCRYPT_RIJNDAEL_128 并在使用以下函数加密之前填充要加密的字符串：

```
<?php 
function pkcs5_pad ($text, $blocksize) { 
    $pad = $blocksize - (strlen($text) % $blocksize); 
    return $text . str_repeat(chr($pad), $pad); 
} 
?> 
```

> 在解密时，AES_256 或 AES_128 等的选择基于加密时使用的密钥大小。在我的情况下，它是一个 128 位密钥，所以我使用了 AES_128。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T04:48:40.107

```
Client Side using ECB - DES_EDE3
==================================

#include "cryptlib.h"
#include "modes.h"
#include "des.h"
#include "base64.h" <-- any base64 encoder/decoder i found the usage of crypto++ base64 class a bit hard to use since you have to know how many byte are taken to encode a byte in base 64...
#include "hex.h"

// Encode the data using the handy Crypto++ base64 encoder. Base64 uses
// 3 characters to store 2 characters.
const int BUFFER_LENGTH = 255;
byte plaintext[BUFFER_LENGTH];
byte ciphertext[BUFFER_LENGTH];
byte newciphertext[BUFFER_LENGTH];
byte decrypted[BUFFER_LENGTH];

CryptoPP::Base64Encoder base64Encoder;
CBase64Coding base64Coder;
CString MySensitiveDataUncrypted;
CString MySensitiveData;

// Set up the same key and IV
const int KEY_LENGTH = 24;
const int BLOCK_SIZE = CryptoPP::DES::BLOCKSIZE;
byte key[KEY_LENGTH], iv[CryptoPP::DES::BLOCKSIZE];
memset( key, 0, KEY_LENGTH);
memcpy( key, "012345678901234567890123", KEY_LENGTH );
memset( iv, 0, CryptoPP::DES::BLOCKSIZE);
memcpy( iv, "01234567", CryptoPP::DES::BLOCKSIZE );
memset( plaintext, 0, BUFFER_LENGTH);
memset( ciphertext, 0, BUFFER_LENGTH);
memset( newciphertext, 0, BUFFER_LENGTH);
strcpy((char*)plaintext,MySensitiveDataUncrypted.GetBuffer(0));
// now encrypt
CryptoPP::ECB_Mode::Encryption ecbEncryption(key, sizeof(key));
ecbEncryption.ProcessString(newciphertext, plaintext, BUFFER_LENGTH);
// your own base64 encoder/decoder
base64Coder.Encode((char *)newciphertext,BUFFER_LENGTH,(char *)ciphertext);
MySensitiveData.Format(_T("%s"),ciphertext);

// MySensitiveData can now be send over http

Server Side in PHP using ECB - DES_EDE3
=========================================

// $MyBase64EncodedSecretString will receive/store the encrypted string which will also be base64Encoded for HTTP protocol convenience

$key = "012345678901234567890123";
$iv = "01234567";

// Set up an "encryption" descriptor. This is basically just an object that
// encapsulates the encryption algorithm. 'tripledes' is the name of the
// algorithm, which is simply the DES algorithm done three times back to
// back. 'ecb' describes how to encrypt different blocks. See, DES
// actually only encrypts 8-byte blocks at a time. To encrypt more than 8
// bytes of data, you break the data up into 8-byte chunks (padding the
// last chunk with NULL, if need be), and then encrypt each block
// individually. Now, ECB (which stands for "Electronic Code Book", for
// whatever that's worth) means that each 8-byte block is encrypted
// independently. This has pros and cons that I don't care to discuss.
// The other option is CBC ("Cipher Block Chaining") which links the blocks,
// such as by XORing each block with the encrypted result of the previous
// block. Security geeks probably really get excited about this, but for my
// needs, I don't really care.
$td = mcrypt_module_open( 'tripledes', '', 'ecb', '' );
mcrypt_generic_init( $td, $key, $iv );

// Grab some interesting data from the descriptor.
// $maxKeySize = 24, meaning 24 bytes
// $maxIVSize = 8, meaning 8 bytes
$maxKeySize = mcrypt_enc_get_key_size( $td );
$maxIVSize = mcrypt_enc_get_iv_size( $td );
//echo "maxKeySize=$maxKeySize, maxIVSize=$maxIVSize\n";

// let's decrypt it and verify the result. Because DES pads
// the end of the original block with NULL bytes, let's trim those off to
// create the final result.
$MyEncodedSecretString = base64_decode( $MyBase64EncodedSecretString );
$MyDecodedString = rtrim( mdecrypt_generic( $td, $MyEncodedSecretString ), "\0" );

// And finally, clean up the encryption object
mcrypt_generic_deinit($td);
mcrypt_module_close($td);

Client Side Stronger Encryption using RSA
=========================================

First you will need to generate a public/private key pair using crypto++ keygen console application then your client code should be something like

// Client Side Using RSA
#include "cryptlib.h"
#include "rsa.h"
#include "hex.h"
#include "randpool.h"
#include "filesource.h"

CString MyNotverySecretStringInMemory;
CString MySensitiveData;
char pubFilename[128];
char seed[1024], message[1024];

// MAX = 19999991
strcpy(seed,"12345");

CString tmpPath;
TCHAR appPath[MAX_PATH];
::GetModuleFileName(NULL,appPath,MAX_PATH);

tmpPath = appPath;
tmpPath = tmpPath.Left(tmpPath.ReverseFind('\\')+1);
tmpPath += "public.key"; // 1024 key length for higher security.

strcpy(pubFilename,tmpPath.GetBuffer(0));
strcpy(message,MyNotverySecretStringInMemory.GetBuffer(0));
CryptoPP::FileSource pubFile(pubFilename, true, new CryptoPP::HexDecoder);
CryptoPP::RSAES_OAEP_SHA_Encryptor pub(pubFile);
CryptoPP::RandomPool randPool;
randPool.IncorporateEntropy((byte *)seed, strlen(seed));
std::string result;
CryptoPP::StringSource(message, true, new CryptoPP::PK_EncryptorFilter(randPool, pub, new CryptoPP::HexEncoder(new CryptoPP::StringSink(result))));
MySensitiveData.Format(_T("%s"),result.c_str()); 
```

# c++ - 将向量复制到向量

> ID：12187691
> 
> 赞同：0
> 
> 时间：2012-08-29T23:05:24.420
> 
> 标签：c++, vector, copy

我正在尝试使用 `std::copy` 将一个向量复制到另一个向量

```
vector<note_name> notes =  AppSettings::getAllNotes();
copy(notes.begin(), notes.end(), song.noteList); 
```

该函数`getAllNotes()`返回一个`vector<note_name>`和noteList 是同一类型的公共成员。当我尝试跑步时，我得到：

![在此处输入图像描述](../Images/471c3b8df25c9a260dfbbb5b16d8af8b.png)

所以我认为 vector 使用 type 的事实存在一些问题`note_name`，但我不知道如何解决它。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T23:10:07.280

你也需要一个输出*迭代器*。如果`noteList`已经具有所需的大小，请说：

```
copy(notes.begin(), notes.end(), song.noteList.begin()); 
```

如果它是空的并且你想*插入*复制的范围，`#include <iterator>`然后说：

```
copy(notes.begin(), notes.end(), std::back_inserter(song.noteList)); 
```

但是，正如@Mike 指出的那样，说以下内容之一可能更简单：

```
song.noteList = notes;                            // keep both 
```

```
AppSettings::getAllNotes().swap(song.noteList);   // dispose of the temporary 
```

# sql - SQL 子查询和分组

> ID：12187698
> 
> 赞同：2
> 
> 时间：2012-08-29T23:06:10.397
> 
> 标签：sql, postgresql

我应该能够做到这一点，但大脑似乎已经融化了

数据库是postgres

表结构很简单，只有四列很重要：

位置、用户、活动、日期时间

我需要按位置排序并仅输出已发生的每个活动的最新事件。事先不知道有什么活动

就像是

```
位置用户活动日期时间
伦敦弗雷德 A 08-29-2012
伦敦弗雷德 B 08-27-2012
巴黎约翰 A 08-29-2012
东京弗雷德 A 08-17-2012
东京简 D 08-29-2012

```

谢谢大家

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T23:33:24.003

PostgreSQL 中最快的方法可能是[`DISTINCT ON`](http://www.postgresql.org/docs/current/interactive/sql-select.html#SQL-DISTINCT)：

```
SELECT DISTINCT ON (location, activity)
       location, activity, datetime, usr
FROM   tbl
ORDER  BY location, activity, datetime DESC, usr; -- usr only to break ties 
```

带有位置参数的简写形式：

```
SELECT DISTINCT ON (1 ,2)
       location, activity, datetime, usr
FROM   tbl
ORDER  BY 1, 2, 3 DESC, 4; 
```

这在一个操作中结合了排序和归约到不同的行。[此相关答案](https://stackoverflow.com/a/7630564/939860)中的更多详细信息、解释和基准。

`user`是保留字。实际上不要将其用作列名。我用`usr`.

**如果**性能应该是至关重要的，那么像下面这样的索引将会有所作为：

```
CREATE INDEX tbl_multi_idx ON tbl (location, activity, datetime DESC, usr); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T23:10:18.967

```
SELECT * FROM table JOIN (
  SELECT Activity, Location, Max(DateTime) DateTime FROM table
  GROUP BY Activity, Location
  ) m USING (Activity, Location, DateTime) 
```

最好在不完全理解您的问题的情况下回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T23:10:11.163

```
SELECT
   Location,
   User
   Activity
   DateTime
From
   myTable a
   INNER JOIN
   (SELECT Location, User, Max(DateTime) as DateTime FROM myTable GROUP BY Location, User) b
   ON a.Location = b.Location AND a.User = b.User AND a.DateTime = b.DateTime 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T23:16:51.877

```
select t1.location, t1.user, m.activity, m.datetime 
from table1 t1 inner join
(select activity, max(datetime) datetime from table1 group by activity) m
on t1.activity = m.activity and t1.datetime = m.datetime
order by t1.location asc 
```

# javascript - 判断 jQuery 中是否隐藏了任何 div

> ID：12187706
> 
> 赞同：0
> 
> 时间：2012-08-29T23:06:49.577
> 
> 标签：javascript, jquery, asp.net, radtreeview

我有一个带有自定义 NodeTemplate 的 RadTreeView。在该节点模板中，我将节点包围在 a 中`div`，如下所示：

```
<div id="divCommandRow">
    <!-- My template goes here -->
</div> 
```

RadTreeView 呈现后，我的 DOM`<div id="divCommandRow">`在 DOM 中有几个 div。我的问题是，我如何使用 jQuery 来查询这些 div 是否有`display: none`样式？我创建了以下代码，但它似乎不起作用：

```
 function IsInEditMode() {
        $('#divCommandRow').each(function () {
            if ($(this).is(':visible'))
                return true;
        });
        return false;
    } 
```

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T23:09:06.750

```
$('selector').length == $('selector:visible').length 
```

或者

```
$('selector:not(:visible)').length == 0 
```

在此条件下，您检查是否所有匹配`selector`选择器的元素都可见

# java - 将字符串转换为整数。字符串值 = 扫描仪输入.....很难解释

> ID：12187713
> 
> 赞同：2
> 
> 时间：2012-08-29T23:07:33.477
> 
> 标签：java, string, int, java.util.scanner

好的，所以我正在尝试转换一些东西。

所以我已经将我的扫描仪转换为字符串，现在我想做的是，获取他们输入的值并将其用作几个 else if 语句的整数。它不会工作！

到目前为止，这是我的代码：

```
import java.util.Scanner;
public class apples {
public static void main(String args[]) {

    Scanner fname = new Scanner(System.in);
    Scanner sname = new Scanner(System.in);
    Scanner number = new Scanner(System.in);
    tuna weight = new tuna();

    System.out.println("Enter Your First Name: ");
    String fname1 = fname.nextLine();
    String fnames = fname1;

    System.out.println("Enter Your Last Name: ");
    String sname1 = sname.nextLine();
    String snames = sname1;

    System.out.println("Enter Your Weight (Lbs.) : ");
    String num = number.nextLine();
    String num1 = num;

    System.out.println("Okay " + fname1 + " " + sname1
            + " I can see here that you weigh " + num + "lbs.");
    int num2 = num1.parseInt();
    if (num1 >= 275)
        System.out
                .println("You know, you should maybe consider laying off the candy my friend.....");
} 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T23:10:44.223

你应该使用一个参数`parseInt`：

```
int num2 = Integer.parseInt(num1); 
```

和

```
if (num2 >= 275) 
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T23:13:47.613

试试这个：

```
try{
  num2 = Integer.parseInt(num1);
}
catch(Exception ex) {
  System.out.println("Something went wrong, the string could not be converted to int.");
} 
```

try-catch 非常重要，因为字符串可能包含无法转换为 int 的字符，你需要比这更好地捕捉它，但请记住这一点

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T11:57:09.963

您也可以使用其他类型的扫描仪方法来获取 int 值

```
num = number.nextInt(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-19T04:05:04.757

这是我所做的：

```
Scanner input = new Scanner(System.in);
System.out.println("Type number");
int number = input.nextInt();
System.out.println(number); 
```

希望这可以帮助...

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-08-27T16:09:54.147

我自己不是 Java 专家，但我将您的代码调整了一个档次以使其正常工作。这里是。很高兴它有帮助。

p

```
ackage APPLE;
import java.util.Scanner;
public class apples {
public static void main(String args[]) {

    Scanner fname = new Scanner(System.in);
    Scanner sname = new Scanner(System.in);
    Scanner number = new Scanner(System.in);
    Scanner intScanner = new Scanner(System.in);

    System.out.println("Enter Your First Name: ");
    String fname1 = fname.nextLine();
    String fnames = fname1;

    System.out.println("Enter Your Last Name: ");
    String sname1 = sname.nextLine();
    String snames = sname1;

    System.out.println("Enter Your Weight (Lbs.) : ");
    int num = intScanner.nextInt();

    System.out.println("Okay " + " " + fname1 + " " + sname1 
            + " I can see here that you weigh " + num + "lbs.");

    if (num > 275){
        System.out.println("You know, you should maybe consider laying off the candy my friend.....");
    }
}
} 
```

# amazon-web-services - Amazon Simple DB 中的 TOP、DISTINCT 和 Sub 查询

> ID：12187716
> 
> 赞同：0
> 
> 时间：2012-08-29T23:07:43.890
> 
> 标签：amazon-web-services, amazon-simpledb

我有一个带有“MachineName”和“TimeStamp”属性的 Amazon SimpleDB 域，用于记录用户活动。我想创建一个查询，返回每台机器的最新日志条目。这是我可以用 SimpleDB 查询做的事情吗？我对常规 SQL 查询不是那么精通，但我想我想对 TOP、Distinct 和/或子查询做一些事情。但是 SimpleDB 不支持这些。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T06:25:13.593

你能试试这个查询吗 -

select * from `<domain_name>`where `TimeStamp`is not null AND `MachineName`= 'A' order by `TimeStamp`desc limit 1

# wordpress - 仅显示正在查看的自定义帖子类型类别的术语文本和链接

> ID：12187717
> 
> 赞同：1
> 
> 时间：2012-08-29T23:07:44.900
> 
> 标签：wordpress, loops, get, categories

我正在尝试在 wordpress 循环中为自定义分类的类别页面显示类别名称，并且我已经进行了多次搜索以寻找答案，但我无法找到它或者我做错了什么。我试图只显示 1 个术语。类别具有子类别和另一个级别的子类别。

所以我需要该术语来动态反映正在查看的页面的术语。我有这段代码可以工作，但它显示了与帖子相关的整个术语列表，并且由于帖子有父、子和孙子术语，我不希望它一次显示所有术语。

```
<?php $terms = wp_get_post_terms( $post->ID, 'videoscategory');

echo '<h2>';

foreach ($terms as $term) {

echo '<a href="'.get_term_link($term->slug, 'videoscategory').'">'.$term->name.'</a>';

}

echo '</h2>'; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:51:48.833

这与`foreach`循环每个术语有关。一种快速而肮脏的方法是`<?php break; ?>`在`endfor`

有关更多信息，请参见此线程：[如何从 foreach(PHP) 中仅获取一个结果](https://stackoverflow.com/questions/7689626/how-to-get-only-one-result-from-foreachphp)

# javascript - clearRect 后无法在画布上绘制图像

> ID：12187720
> 
> 赞同：2
> 
> 时间：2012-08-29T23:07:55.723
> 
> 标签：javascript, html, canvas, html5-canvas

我在使用以下代码时遇到了一些问题。本质上，这包含在图像上传器中。因此，一旦上传者完成其回调，就会执行以下代码：

```
var c = canvas.getContext('2d');
var logoImage = new Image();
logoImage.onload = function() {

   c.clearRect(0, 0, canvas.width, canvas.height);
   c.drawImage(logoImage, 0, 0, 200, 300); // i've simplified this call...
}
logoImage.src = "/path/to/" + fileName; 
```

所以这是第一次。但我希望它在以后的时间里也能奏效。因此，当上传另一个图像时，画布会被清除并绘制该图像。相反，会发生画布被清除但没有进一步绘制的情况......

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T07:44:21.863

尝试这个：

更换

```
 c.clearRect(0, 0, canvas.width, canvas.height); 
```

和：

```
canvas.width=canvas.width; 
```

# ruby-on-rails - Rails：使用collection_singular_ids = ids方法保存令牌时指定关联类型

> ID：12187730
> 
> 赞同：0
> 
> 时间：2012-08-29T23:09:07.263
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

下面是我的模型。用语言来形容它，“节目”有“船员”。“船员”由“人”组成。“Crew”中“Show”和“People”之间的关联可以是“Actor”或“Other”类型。我有来自“显示”表单上的自动完成 UI 的令牌，其中“人物”填写在“演员”字段或“其他”字段中。

问题：在“显示”模型的`actor_tokens=(ids)`和`actor_tokens=(ids)`方法中，我保存进入的令牌，如何将关系保存为“演员”或“其他”？

从中保存的所有关联`actor_tokens=(ids)`都应为“演员”类型，并且从中保存的所有关联`other_tokens=(ids)`都应为“其他”类型，并且

我正在寻找一个优雅的解决方案来匹配使用 *collection_singular_ids=ids* 来保存我的令牌。

> 船员模型

```
class Crew < ActiveRecord::Base
  belongs_to :show
  belongs_to :person

  attr_accessor  :type    #this can be 'actor'  'other' string

end 
```

> 人物模型

```
class Person < ActiveRecord::Base
          attr_accessible :first_name, :handle, :last_name
          has_many :crews
          has_many :shows, :through => :crews

        end 
```

> 显示模型

```
 class Show < ActiveRecord::Base
      attr_accessible :handle, :name, :crew_tokens
      has_many :crews
      has_many :people, :through => :crews

      attr_reader :actor_tokens

      def actor_tokens=(ids)
        self.person_ids = ids.split(",")
            #----->associate tokens coming in here as type = 'actor'
      end

      def other_tokens=(ids)
        self.person_ids = ids.split(",")
            #----->associate tokens coming in here as type = 'other'
      end

    end 
```

PS：请为这篇文章建议一个更好的标题！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T01:16:50.233

你不能用你想要的方式`collection_singular_ids=`创建新实例。只接受有效的、已经存在的 id 列表；您不能通过此方法指定其他属性。`Crew`[`ids_writer`](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/associations/collection_association.rb#L57)

相反，您可以构建`Crew`实例，根据需要指定`:person_id`and`:type`并将它们关联回`Show`.

```
def actor_tokens(ids)
  create_crews_from_ids(ids, :actor)
end

def other_tokens=(ids)
  create_crews_from_ids(ids, :other)
end

  private

  def create_crews_from_ids(ids, type)
    ids = ids.split(",").each do |id|
      crews.create({ person_id: id, type: type })
    end
  end 
```

# java - 从 Java 迁移到 PHP

> ID：12187733
> 
> 赞同：-1
> 
> 时间：2012-08-29T23:09:44.677
> 
> 标签：java, php, development-environment

最近，我从移动 Java 世界转向 PHP 编码。过去，我也编写过代码并尝试尽可能多地收集有关 Java EE 平台的知识。我已经习惯了在 Eclipse 中进行编码的所有惊人可能性，现在我可以看到我往往会错过或者只是不知道如何达到如此流畅的程度。

**有没有什么好的博客文章、教程，甚至是一本关于如何使用 PHP 实现最佳工具集的书？**

根据我已经了解到的是：

*   使用 vim。手指一直按在键盘上确实是一种神奇的流程
*   当我想查找函数的用法时，我会使用 grep
*   我使用 ctags 和 vim 的插件命令 tjump 去方法定义

***不知何故，每次我从 vim 切换到命令行来 grep 时，我都会感到有些恼火。这就像在 Eclipse 中使用搜索来找出类层次结构一样。***

我相信你们中的一些人可能经历了同样的过程，并为 Java 工程师已经理所当然地认为他们就在那里的事情找到了良好且运行良好的解决方案。

我知道这是一个非常笼统的问题，但是我的目的是要么获得一篇文章的链接，该文章描述了我提到的所有内容，要么只是收集很多关于 PHP 的提示（在我看来，这就是方式它目前通常有效 - 我希望这不是真的）。

**编辑**：我当前的操作系统是 Mac OS X，因此首选跨平台解决方案 :-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:14:49.980

如果您使用过 Java，那么您就使用过 Eclipse。

我建议您从[Zend Studio](http://www.zend.com/en/products/studio/downloads?src=downloadb)的社区版开始。就个人而言，它是 PHP 最好的 IDE 之一。如果你对这种语言更舒服，那就随便用什么，但从能教给你的东西开始，而不是让你的生活变得更困难。

这是 Eclipse for Java 的所有乐趣，但对于 PHP。功能查找、调试、构建配置文件、SVN、FTP 和所有好东西合二为一！

如果没有，请查看 Eclipse 的 PDT 模块。它不像 Zend Studio 那样功能丰富，但为您提供了一个很好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T23:14:34.297

不熟悉 PHP 但您可能需要一些[很棒的 ViM 技巧。](http://vim.wikia.com/wiki/Best_Vim_Tips)

# symfony1 - 安装 Symfony 的问题

> ID：12187742
> 
> 赞同：0
> 
> 时间：2012-08-29T23:10:22.587
> 
> 标签：symfony1, mamp

如果我看起来很困惑，请道歉——我已经为此工作了好几天，进入了一个更深的洞！

我在 OS X Lion 上运行了 MAMP PRO。我开始使用[脚本指令](http://skripted.ruhoh.com/2012/06/16/setting-up-symfony-2-on-mac-os-x-lion-with-mamp/)安装 Symfony 2 。我在使用 MAMP PRO 时出现了一些问题，但 Symfony 以针对我的版本的指示进行了回应。

然后我发现我的 MAMP PRO 已经过时了，D/Led 是最新版本（2.1.1）。但它有更新版本的 PHP (5.4.4)。我考虑到了这一点，并且我确定我将`intl.so`扩展名复制到了正确的位置。然后我将正确的文件复制`php.ini`到桌面，并在其中进行了更改。

但现在，我无法“将文件移回原来的目录”。它根本不会去！即使删除已安装的文件也没有什么区别：我复制到目录的文件是文件的原始版本（`/Library/Application Support/appsolute/MAMP PRO/conf/php.ini`）。呸呸呸。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T21:20:02.520

这听起来像是权限问题。尝试[以 root 身份启动 Finder](http://www.mikesel.info/launch-finder-as-root/)，然后将 php.ini 文件移回它所属的位置。

# php - PHP - Error: No database selected - reading from a database issue

> ID：12187749
> 
> 赞同：0
> 
> 时间：2012-08-29T23:11:04.463
> 
> 标签：php, mysql, connection-string

I figured out hot to get contected to my database in line one I dont get a connection error anymore. But not Im getting an error that says no database selected. What could the issues be? Is my code correct?

First time reading from a mysql database in php. Thanks for the help.

```
<?php     

if (!($con = mysql_connect('host', 'user', 'pw'))) { 
   die('Connect failed: ' . mysql_error()); 
} 

mysql_select_db("my_db", $con) or die('Error select: '.mysql_error()); 

$result = mysql_query ('SELECT * FROM Gallerys') or die ('Error query: '.mysql_error ());

echo "<table border='1'>
 <tr>
 <th>Thumb Url </th>
 <th>Gallery Url</th>
 </tr>";

while($row = mysql_fetch_array($result))
   {
   echo "<tr>";
   echo "<td>" . $row['THUMBURL'] . "</td>";
   echo "<td>" . $row['GALLERYURL'] . "</td>";
   echo "</tr>";
   }
 echo "</table>";

mysql_close($con);
 ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:14:51.560

Your connect-code is using `mysql_connect`, but your error-checking is using `mysqli`:

```
if (mysqli_connect_errno()) {
    exit('Connect failed: '. mysqli_connect_error());
} 
```

Try updating to:

```
if (!($con = mysql_connect('host', 'user', 'pass'))) {
    die('Connect failed: ' . mysql_error());
} 
```

Alternatively, you could update all of the references to `mysql_*` functions to actually use the `mysqli_*` functions - as this is recommended. This is a long-way-around to solve the problem at hand though, but it should also solve the problem.

Sample with mysqli:

```
$con = mysqli_connect('host', 'user', 'pass', 'db_name');
if (!$con) {
    die('Connect Error (' . mysqli_connect_errno() . ') ' . mysqli_connect_error());
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T23:35:58.600

In addition to getting rid of `mysqli_...` function do the following:

```
mysql_select_db("my_db", $con) or die('Error: '.mysql_error()); 
```

That will tell you what happened when you were selecting database. I bet you don't have my_db or you don't have permission to open it.

* * *

Final resultion to anyone following this thread - the problem was with the name of the datbase. It was not my_db but something else.

# javascript - 为什么这段代码返回 NaN？

> ID：12187750
> 
> 赞同：0
> 
> 时间：2012-08-29T23:11:08.900
> 
> 标签：javascript

二十一点游戏：我做了下面的发牌函数，它应该返回一个代表花色的 1-4 之间的随机数，以及另一个代表卡号的 1-3 之间的随机数。

当我通过调用它来测试代码时，`console.log(getSuit(card1));`它返回 NaN

有谁知道为什么？

```
// Make your card constructor again here, but make sure to use private
// variables!
function Card(num, suit){
    var num = num; 
    var suit = suit;
    getSuit = function(){
        return suit; 
    }; 
    getNumber = function(){
        return num; 
    };

    getValue = function(card){
        if (card > 10){
            return 10; 
        }else if (card === 1){
            return 11; 
        }else{
            return card; 
        }

    };

}

// Make a deal function here.  It should return a new card with a suit
// that is a random number from 1 to 4, and a number that is a random
// number between 1 and 13

var deal = function(){
    var suit = Math.floor(Math.random * 4 + 1);
    var number = Math.floor(Math.random * 13 + 1);
    return new Card(number, suit); 
}; 

// examples of the deal function in action
var card1 = deal();
var card2 = deal();

console.log(getSuit(card1)); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T23:18:47.630

只需在随机后添加 ()

```
var deal = function() {
    var suit = Math.floor(Math.random() * 4 + 1);
    var number = Math.floor(Math.random() * 13 + 1);
    return new Card(number, suit);
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T23:15:17.510

你不应该打电话：

```
console.log(card1.getSuit()); 
```

?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T23:20:27.937

您遇到了一些复杂的问题，但是您获得 NaN 的原因是您使用了 random 函数。请包括`()`对方法/函数的所有调用。

对 Card 类进行了其他更改。`this.`将变量分配给该类实例。同样适用于功能。所以这改变了你调用的方式`getSuit()`，作为方法调用。它以前工作过，因为您的 getSuit() 被放入全局命名空间。

```
function Card(num, suit){
    this.num = num; 
    this.suit = suit;
    this.getSuit = function(){
        return suit; 
    }; 
    this.getNumber = function(){
        return num; 
    };

    this.getValue = function(card){
        if (card > 10){
            return 10; 
        }else if (card === 1){
            return 11; 
        }else{
            return card; 
        }

    };

}

var deal = function(){
    var suit = Math.floor(Math.random() * 4 + 1);
    var number = Math.floor(Math.random() * 13 + 1);
    return new Card(number, suit); 
}; 

// examples of the deal function in action
var card1 = deal();
var card2 = deal();

console.log(card1.getSuit()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T23:13:39.980

改变：

```
var num = num; 
var suit = suit; 
```

到

```
this.num = num; 
this.suit = suit; 
```

等等

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T23:21:50.307

试试这个：

```
// Make your card constructor again here, but make sure to use private 
// variables!
function Card(num, suit){
    // NOTE: "this."
    this.num = num;
    this.suit = suit;
    this.getSuit = function(){
        return this.suit;
    };
    this.getNumber = function(){
        return this.num;
    };

    this.getValue = function(card){
        if (card > 10){
            return 10;
        }else if (card === 1){
            return 11;
        }else{
            return card;
        }
    };
}

// Make a deal function here.  It should return a new card with a suit
// that is a random number from 1 to 4, and a number that is a random
// number between 1 and 13   
var deal = function(){
    // NOTE: Math.random()
    var suit = Math.floor(Math.random() * 4 + 1);
    var number = Math.floor(Math.random() * 13 + 1);
    return new Card(number, suit);
};

// examples of the deal function in action
var card1 = deal();
var card2 = deal();

// NOTE: card1.getSuit()
console.log(card1.getSuit()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-29T23:21:54.227

您需要解决三个不同的问题：

1.  你需要在`Math.random()`.
2.  你需要`getSuit()`像这样打电话`card1.getSuit()`而不是你怎么做的。
3.  您需要真正地制作`getSuit`，`getNumber`并`getValue`成为 Card 对象的方法。正如您到目前为止所声明的那样，它们只是 Card 构造函数内部的局部函数，不能从该构造函数外部调用。

有两种常用的方法来制作这些函数方法。一种是将它们分配给 Card 原型对象。另一种是在构造函数中分配它们`this`。

以下是将它们分配给原型对象的样子：

```
function Card(num, suit){
    this.num = num; 
    this.suit = suit;
}

Card.prototype = {
     getSuit: function() {
         return suit;
     },
     getNumber: function() {
         return num;
     },
     getValue: function(card) {
        if (card > 10){
            return 10; 
        }else if (card === 1){
            return 11; 
        }else{
            return card; 
        }
    }
};

// Make a deal function here.  It should return a new card with a suit
// that is a random number from 1 to 4, and a number that is a random
// number between 1 and 13

var deal = function(){
    var suit = Math.floor(Math.random() * 4 + 1);
    var number = Math.floor(Math.random() * 13 + 1);
    return new Card(number, suit); 
}; 

// examples of the deal function in action
var card1 = deal();
var card2 = deal();

console.log(card1.getSuit()); 
```

* * *

如果您想保留私有变量`num`，`suit`那么您必须像这样在 Card 内部定义方法：

```
// Make your card constructor again here, but make sure to use private
// variables!
function Card(num, suit){
    var num = num; 
    var suit = suit;
    this.getSuit = function(){
        return suit; 
    }; 
    this.getNumber = function(){
        return num; 
    };

    this.getValue = function(card){
        if (card > 10){
            return 10; 
        }else if (card === 1){
            return 11; 
        }else{
            return card; 
        }

    };

}

// Make a deal function here.  It should return a new card with a suit
// that is a random number from 1 to 4, and a number that is a random
// number between 1 and 13

var deal = function(){
    var suit = Math.floor(Math.random() * 4 + 1);
    var number = Math.floor(Math.random() * 13 + 1);
    return new Card(number, suit); 
}; 

// examples of the deal function in action
var card1 = deal();
var card2 = deal();

console.log(card1.getSuit()); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-29T23:28:42.660

这个版本保留了私有变量的使用。请注意，函数参数自动为私有变量，因此您无需重新声明它们。

```
function Card(num, suit) {
    this.getSuit = function() {
        return suit;
    }; 
    this.getNumber = function() {
        return num;
    };
    this.getValue = function() {
        if (num > 10)
            return 10;
        if (num == 1)
            return 11;
        return num;
    };
} 
```

# django - Django 将多个模型传递给一个模板

> ID：12187751
> 
> 赞同：41
> 
> 时间：2012-08-29T23:11:22.353
> 
> 标签：django, templates, model, views

我正在构建一个地址簿，其中包含条目之间的关系等。我为个人、公司、地点和角色设置了单独的模型。在我的索引页面上，我想列出每个模型的所有实例，然后过滤它们。这样人们就可以轻松搜索并找到条目。我已经能够使用通用视图列出一个模型并使用 get_extra_context 来显示另一个模型：

```
#views.py

 class IndividualListView(ListView):

    context_object_name = "individual_list"
    queryset = Individual.objects.all()
    template_name='contacts/individuals/individual_list.html'

class IndividualDetailView(DetailView):

    context_object_name = 'individual_detail'
    queryset = Individual.objects.all()
    template_name='contacts/individuals/individual_details.html'

    def get_context_data(self, **kwargs):
        context = super(IndividualDetailView, self).get_context_data(**kwargs)
        context['role'] = Role.objects.all()
        return context 
```

我还可以使用自定义视图列出单个模型：

```
#views.py
def object_list(request, model):
    obj_list = model.objects.all()
    template_name = 'contacts/index.html'
    return render_to_response(template_name, {'object_list': obj_list}) 
```

以下是这两个测试的 urls.py：

```
(r'^$', views.object_list, {'model' : models.Individual}),

(r'^individuals/$', 
    IndividualListView.as_view(),
        ),
(r'^individuals/(?P<pk>\d+)/$',
    IndividualDetailView.as_view(),

         ), 
```

所以我的问题是“如何修改它以将多个模型传递给模板？” 甚至可能吗？StackOverflow 上的所有类似问题只询问两个模型（可以使用 get_extra_context 解决）。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-09-10T18:31:57.217

我最终修改了@thikonom 的答案以使用基于类的视图：

```
class IndexView(ListView):
    context_object_name = 'home_list'    
    template_name = 'contacts/index.html'
    queryset = Individual.objects.all()

    def get_context_data(self, **kwargs):
        context = super(IndexView, self).get_context_data(**kwargs)
        context['roles'] = Role.objects.all()
        context['venue_list'] = Venue.objects.all()
        context['festival_list'] = Festival.objects.all()
        # And so on for more models
        return context 
```

在我的 urls.py

```
url(r'^$', 
    IndexView.as_view(),
    name="home_list"
        ), 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-08-29T23:22:57.063

我建议你删除你的`object_list`观点，

为此特定视图定义字典，

```
 all_models_dict = {
        "template_name": "contacts/index.html",
        "queryset": Individual.objects.all(),
        "extra_context" : {"role_list" : Role.objects.all(),
                           "venue_list": Venue.objects.all(),
                           #and so on for all the desired models...
                           }
    } 
```

然后在您的网址中：

```
#add this import to the top  
from django.views.generic import list_detail

(r'^$', list_detail.object_list, all_models_dict), 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-05-18T13:43:53.230

如果你想在 Django 1.5 上构建它，你将能够使用稳定版本的 CBV。请在下面找到代码。

你可以在这里找到很棒的文档[https://docs.djangoproject.com/en/dev/topics/class-based-views/mixins/](https://docs.djangoproject.com/en/dev/topics/class-based-views/mixins/)

```
class ProductsCategoryList(ListView):
    context_object_name = 'products_list'
    template_name = 'gallery/index_newborn.html'

    def get_queryset(self):
        self.category = get_object_or_404(Category, name=self.args[0])
        return Products.objects.filter(category=self.category)

    def get_context_data(self, **kwargs):
        kwargs['category'] = Category.objects.all()
        # And so on for more models
        return super(ProductsCategoryList, self).get_context_data(**kwargs) 
```

# php - Php, Javascript - 动态表单 ID 和动态验证

> ID：12187759
> 
> 赞同：0
> 
> 时间：2012-08-29T23:12:55.110
> 
> 标签：php, javascript, forms, validation, dynamic

我的javascript编程技能很少，所以这一定是它的问题。我的问题并没有那么复杂，但我只是找不到答案，我几乎尝试了所有方法，但正如我所说，我在 javascript 编程方面很蹩脚。

我的问题是，我有一个 php 页面，在这个页面上有多个由 mysql 查询生成的表单。我使用它们将动态生成的隐藏字段值发布到另一个 php 文件中，并且在该文件中我可以使用它们的发布值而无需刷新主页。表单 ID（或名称）也由 mysql 查询生成。我使用 javascript 来验证 (?) 表单并将其隐藏的内容发送到另一个页面。

Javascript：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="http://ajax.microsoft.com/ajax/jquery.validate/1.7/jquery.validate.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
        $("#1").validate({
            debug: false,
            submitHandler: function(form) {
                $.post('process_like_dislike.php', $("#1").serialize(), function(data) {
                    $('#results').html(data);
                });
            }
            });
    });
    </script> 
```

如您所见，本例中的表单 id 为 1。我在一页上生成了近 40 个唯一表单，这取决于 mysql 查询。

php：

```
<form name='$formnumber' id='$formnumber' action='' method='POST'>
<input type=hidden value='$us_id' name='us_id' id='us_id'>
<input type=hidden value='$an_id' name='an_id' id='an_id'>
<input type=hidden value='1' name='on' id='on'>
<input type=submit class=something value='' title='Something'>
</form> 
```

我不知道我应该如何使 javascript 代码在提交时动态验证所选表单。我试图在 javascript 中获取 php formnumber 变量，但这没有帮助。不知道有没有别的办法，我只知道这个。我需要将动态生成的隐藏值传递给另一个页面，但我需要一个动态生成的 javascript，否则我不知道。

这段代码的主要概念是，我创建了一个页面，您可以在其中对事物进行评分，并且该事物具有我需要以帖子格式获取的隐藏值，因为这是我可以决定按下哪个按钮的唯一方法在第二个 php 文件中执行 mysql 查询而不刷新当前文件。我不想要简单的帖子，因为我会丢失上一页并且我不想刷新页面。

请帮帮我，谢谢各位。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:58:48.150

@Michael Wheeler 的解决方案比我最初想出的更优雅 - 但是，'this' 没有设置为表单（我测试过），所以你必须将他的解决方案更改为 $(form) 对于其他 $( "#1") 而不是 $(this) ，它会完美运行。=)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-29T23:24:55.910

您将从 AJAX 中受益匪浅：http: [//www.w3schools.com/ajax/default.asp](http://www.w3schools.com/ajax/default.asp) 并且可能从 jquery 中受益，尽管我知道您没有提到它，以简化您的 AJAX 问题： [http://api.jquery .com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# iphone - 字体文件添加到项目、plist、代码和编译资源中，但仍然无法正常工作

> ID：12187762
> 
> 赞同：1
> 
> 时间：2012-08-29T23:12:59.103
> 
> 标签：iphone, ios, xcode, cocoa-touch, uiappfonts

我已按照此[相关问题](https://stackoverflow.com/questions/360751/can-i-embed-a-custom-font-in-an-iphone-application)中讨论的步骤进行操作，但没有成功。

1.  将文件添加`fontFile.ttf`到 Xcode 项目资源。
2.  `fontFile.ttf`在 Info.plist 的 UIAppFonts 数组中作为字符串添加。
3.  `actualFontName`在代码中添加。
4.  将文件添加`fontFile.ttf`到目标。

我已经检查过我使用的是 Font Book 和 Finder 信息（`CMD + i`在每个）中识别的实际字体名称。我还仔细检查了包含文件名的拼写和区分大小写。

呈现标签的代码适用于其他嵌入式系统字体，但不适用于自定义 TTF。还能缺少什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T00:07:42.597

## 答：检查文件是否添加到“复制捆绑资源”构建阶段

问题是我将文件添加到“编译源”而不是“复制捆绑资源”。

因此，步骤 4 应如下所示：

*4.添加文件fontFile.ttf到target的资源捆绑*

要检查文件是否在正确的位置，导航到项目的 Build Phases 选项卡，向下滚动到“Copy Bundle Resources”并验证文件是否存在。如果不存在，只需单击相应的“+”按钮添加它。

**注意：**如果您在第一次将文件拖到项目中时选择“添加到目标”复选框，则可以避免这种情况。

# .net - SqlBulkCopy 是如何工作的

> ID：12187768
> 
> 赞同：15
> 
> 时间：2012-08-29T23:13:44.583
> 
> 标签：.net, sql-server, sqlbulkcopy

我熟悉 C# SqlBulkCopy 类，您可以在其中调用通过 DataTable 传递的“WriteToServer”方法。

我的问题是 SQL Server 中的什么底层机制用于批量插入该数据？

我问的原因是[批量插入](http://msdn.microsoft.com/en-us/library/ms188365.aspx)MSDN T-SQL 帮助文件中引用的批量插入需要导入数据文件。SqlBulkCopy 是否创建数据文件？

我想了解这些东西以确定我是否可以在 SQL 中使用批量插入功能。

如果我编写一个 SQL 语句，准备将所有行插入到特定表（数千行）中，我可以将它们批量插入到目标表中吗？像这样的事情就是我现在正在做的事情，

```
INSERT INTO sync_filters (table_name, device_id, road_id, contract_id)
    SELECT * FROM dbo.sync_contract_filters (@device_id) 
```

dbo.sync_contract_filters 是一个生成所有要插入的行的函数。这个可以批量插入吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-30T03:07:20.177

SqlBulkCopy 不创建数据文件。它使用可用的通信协议（命名管道、TCP/IP 等）将数据表直接从 .Net DataTable 对象流式传输到服务器，并使用 BCP 使用的相同技术将数据批量插入目标表.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2020-01-01T05:23:09.920

花了7年，但我们终于有了答案……

根据 Sam Anwar 的回答，我可以确认它正在将数据转换为原始字节流并将其写入 SQL，就好像它是从文件中流入一样。*它如何*欺骗 SQL 使其认为它正在读取文件超出了我的理解。

我想从查询内部进行批量插入，以加快慢速聚集索引插入。在这里找到你的帖子后，不知何故，我对它产生了令人不安的兴趣，所以我花了几个小时研究它。

实际向服务器写入数据的执行路径似乎是：

您的代码：

1.  您的代码调用 System.Data.SqlClient.SqlBulkCopy.WriteToServer()

System.Data.SqlClient.SqlBulkCopy 内部：

2.  它调用[WriteRowSourceToServerAsync](https://referencesource.microsoft.com/#System.Data/fx/src/data/System/Data/SqlClient/SqlBulkCopy.cs,54cddf315537c12c) ()
3.  它调用[WriteRowSourceToServerCommon](https://referencesource.microsoft.com/#System.Data/fx/src/data/System/Data/SqlClient/SqlBulkCopy.cs,98b371f4e4cd3855) () 来映射列并调用[WriteToServerInternalAsync](https://referencesource.microsoft.com/#System.Data/fx/src/data/System/Data/SqlClient/SqlBulkCopy.cs,021747994517159e) () 来写入数据
4.  它调用[WriteToServerInternalRestContinuedAsync](https://referencesource.microsoft.com/#System.Data/fx/src/data/System/Data/SqlClient/SqlBulkCopy.cs,f45a7880167221b7) ()
5.  它调用[了 AnalyzeTargetAndCreateUpdateBulkCommand](https://referencesource.microsoft.com/#System.Data/fx/src/data/System/Data/SqlClient/SqlBulkCopy.cs,e5fb9da82448b1d3) () *（这就是答案。跳到第 14 步来阅读它。）*和[CopyBatchesAsync](https://referencesource.microsoft.com/#System.Data/fx/src/data/System/Data/SqlClient/SqlBulkCopy.cs,a2c3b79077a39bd0) ()
6.  其中 (CopyBatchesAsync) 调用[SubmitBulkUpdateCommand](https://referencesource.microsoft.com/#System.Data/fx/src/data/System/Data/SqlClient/SqlBulkCopy.cs,e117e60d7c7f5552) ()

-- 在 System.Data.SqlClient.TdsParser 内部：

7.  它调用 System.Data.SqlClient.TdsParser。[TdsExecuteSQLBatch](https://referencesource.microsoft.com/#System.Data/fx/src/data/System/Data/SqlClient/TdsParser.cs,a160614ab3bee307) ()
8.  它调用[WriteString](https://referencesource.microsoft.com/#System.Data/fx/src/data/System/Data/SqlClient/TdsParser.cs,5737e2a7166d07d5) () 或类似方法将数据转换为字节数组
9.  它调用[WriteByteArray](https://referencesource.microsoft.com/#System.Data/fx/src/data/System/Data/SqlClient/TdsParserStateObject.cs,e4d2f6ab4fd506dc) ()
10.  它调用[WritePacket](https://referencesource.microsoft.com/#System.Data/fx/src/data/System/Data/SqlClient/TdsParserStateObject.cs,89a673f5325418aa) ()
11.  它调用[WriteSni](https://referencesource.microsoft.com/#System.Data/fx/src/data/System/Data/SqlClient/TdsParserStateObject.cs,fadf9910ccd522a9) ()
12.  调用[SNIWritePacket](https://referencesource.microsoft.com/#System.Data/fx/src/data/System/Data/SqlClient/TdsParserStateObject.cs,f71ef034502cfa6a) ()

-- 在 System.Data.SqlClient.SNINativeMethodWrapper 内部：

12.  它调用[System.Data.SqlClient.SNINativeMethodWrapper.SNIWritePacket](https://source.dot.net/#System.Data.SqlClient/Interop/SNINativeMethodWrapper.Windows.cs,1fea24d2e14b3b10) ()
13.  哪个*外部*调用[SNIWriteAsyncWrapper](https://source.dot.net/#System.Data.SqlClient/Interop/SNINativeMethodWrapper.Windows.cs,308526c44635a7fe) () 或[SNIWriteSyncOverAsync](https://source.dot.net/#System.Data.SqlClient/Interop/SNINativeMethodWrapper.Windows.cs,b48f03083ebf5c87) ()

现在这是棘手的地方。我*认为*这如下，但我是如何到达那里的有点hacky。我在我的 sni.dll 副本上打开了文件属性，转到详细信息选项卡，在 Product Version 属性中，我找到了对 d0d5c7b49271cadb6d97de26d8e623e98abdc8db 的“提交哈希”的引用。

所以我用谷歌搜索[了那个哈希](https://www.google.com/search?q=%22d0d5c7b49271cadb6d97de26d8e623e98abdc8db)，通过[这个 Nuget 搜索](https://www.nuget.org/packages?q=d0d5c7b49271cadb6d97de26d8e623e98abdc8db)我找到[了这个 Nuget 包](https://www.nuget.org/packages/runtime.win-x86.runtime.native.System.Data.SqlClient.sni/)，它的标题包括“System.Data.SqlClient.sni”，这意味着我在[这里找到的命名空间](https://source.dot.net/#System.Data.SqlClient/System/Data/SqlClient/SNI/SNICommon.cs)*System.Data.SqlClient.SNI* ，但这并没有'没有正确的方法，实际上似乎没有与服务器通信。

所以这就是我用尽专业知识的地方；在它进入我在任何地方都找不到的本机代码之前，这是我所能达到的深度。虽然我不确定上面的所有其他噪音是什么......

14.  记住第 4 步（[WriteToServerInternalRestContinuedAsync](https://referencesource.microsoft.com/#system.data/system/data/sqlclient/SqlBulkCopy.cs,f45a7880167221b7) ()）也调用[了 AnalyzeTargetAndCreateUpdateBulkCommand](https://referencesource.microsoft.com/#system.data/system/data/sqlclient/SqlBulkCopy.cs,e5fb9da82448b1d3) ()
15.  它在名为 updateBulkCommandText 的 StringBuilder 中连接一个 SQL 查询。最后一个链接中的第 544 行。

TLDR：最终，它似乎只是执行了一个*[INSERT BULK](https://docs.microsoft.com/en-us/sql/t-sql/statements/insert-transact-sql?view=sql-server-ver15)*查询（不需要文件），实际上并没有使用*[BULK INSERT](https://docs.microsoft.com/en-us/sql/t-sql/statements/bulk-insert-transact-sql?view=sql-server-ver15)*（确实如此）。请注意，这两个命令看起来非常相似。

Microsoft 文档中的重要说明：

> 由外部工具用于上传二进制数据流。此选项不适用于 SQL Server Management Studio、SQLCMD、OSQL 等工具或 SQL Server Native Client 等数据访问应用程序编程接口。

我将其解释为“使用风险自负，不要指望帮助”。公平地说，这几乎和绿灯一样好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-30T03:34:28.690

SqlBulkCopy 可以使用数据表、IDataReader 或 DataRow[] 作为数据源。看一下类的 WriteToServer 方法。我发现它是一种将数据导入 SQL Server 的非常有用的机制。我之前已经将它与[CSVReader](http://www.csvreader.com/code/cs/upload_csv.php)结合使用。上一个链接让您了解它如何与实现 IDataReader 的类一起使用。

您可能需要[调整批量大小](https://stackoverflow.com/questions/779690/what-is-the-recommended-batch-size-for-sqlbulkcopy)以确保获得预期的性能。

如果您希望通过快速写入大量数据来获得最佳性能，那么 MSDN 上[的数据加载性能指南是一个非常有用的资源。](http://msdn.microsoft.com/en-us/library/dd425070%28v=sql.100%29.aspx)它更多地关注 BCP 和 BULK INSERT 之类的东西，但涉及 SQLBulkCopy 并且还提供了很多值得思考的东西（可能有点太多，但至少无论如何它是一个有用的参考）。

# c# - 使用更新面板轮换不同的 .ascx 文件

> ID：12187771
> 
> 赞同：1
> 
> 时间：2012-08-29T23:14:07.700
> 
> 标签：c#, asp.net

我过去曾使用更新面板和计时器来使用 ASP.net 创建幻灯片。我想做同样的事情，除了旋转图像，我想旋转 .ascx 文件。这可能吗？到目前为止，这是我所拥有的，但我被困在如何从代码隐藏文件中访问 .ascx 上。

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
    </asp:ScriptManager>
    <asp:UpdatePanel ID="SlideShow" runat="server" UpdateMode="Always">
        <ContentTemplate>
            <img runat="server" id="SlideShowImage1" src="~/Controls/Testimonials.ascx" alt="Testimonial" />
            <asp:Label runat="server" ID="SlideShowText" Text="First Slide" />
        </ContentTemplate>
        <Triggers>
            <asp:AsyncPostBackTrigger ControlID="SlideShowTimer" EventName="Tick" />
        </Triggers>
    </asp:UpdatePanel>
    <asp:Timer ID="SlideShowTimer" runat="server" Interval="15000" OnTick="SlideShowTimer_Tick">
    </asp:Timer> 
```

代码背后：

```
 protected void SlideShowTimer_Tick(object sender, EventArgs e)
    {
        DateTime later = DateTime.Now.AddSeconds(.5);
        while (DateTime.Now < later)
        {

        }

        this.SlideShowImage1.Src = RandomImageName();
        this.SlideShowText.Text = this.SlideShowImage1.Src.ToString();

    }
    private string RandomImageName()
    {

        Random rand = new Random();

        int RandomInt = rand.Next(0, 5);

        switch (RandomInt)
        {

            case 0:
                return "~/Controls/Testimonials.ascx";
                break;
            case 1:
                return "~/Controls/Testimonials2.ascx";
                break;
            case 2:
                return "~/Controls/Testimonials3.ascx";
                break;
            default:
                return "~/Controls/Testimonials4.ascx";
                break;

        }
    } 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:58:32.880

1）在顶部的aspx文件中添加以下指令

```
<%@ Register TagPrefix="uc1" TagName="ucLoanTerms" Src="ucLoanTerms.ascx" %> 
```

(2) 然后在您要动态加载用户控件的表单中添加以下内容

```
<asp:PlaceHolder ID="PlaceHolder1" runat="server"></asp:PlaceHolder> 
```

(3) 在文件 Page_Load 方法后面的代码中执行以下代码，

```
PlaceHolder1.Controls.Clear();
ucLoanTerms lt = (ucLoanTerms) LoadControl("ucLoanInfo.ascx");
PlaceHolder1.Controls.Add(lt); 
```

我还发现这篇关于动态加载用户控件的好文章。

[http://geekswithblogs.net/rashid/archive/2007/08/11/Loading-UserControl-Dynamically-in-UpdatePanel.aspx](http://geekswithblogs.net/rashid/archive/2007/08/11/Loading-UserControl-Dynamically-in-UpdatePanel.aspx)

# c# - 如何在 radgrid Telerik 中设置复选框列以启用拖动选择

> ID：12187774
> 
> 赞同：1
> 
> 时间：2012-08-29T23:14:30.777
> 
> 标签：c#, asp.net, telerik-grid, radgrid

在我的 Telerik radgrid 中，我有 2 个复选框列，名为“已批准”和“已拒绝”。如何通过拖动复选框来“检查”每列中的多个复选框？请注意，我不想通过拖动来选择多个整行，而只是选择这些相应列中的多个复选框。这是aspx：

```
 <telerik:GridTemplateColumn UniqueName="checkBoxYesColumn">
                            <HeaderStyle HorizontalAlign="Center"   />
                            <HeaderTemplate>
                                 <asp:CheckBox  ID="cbYesHead2" runat="server" />
                                <cc1:MutuallyExclusiveCheckBoxExtender ID="mecbeYesHead" runat="server" TargetControlID="cbYesHead2"  />
                            </HeaderTemplate>
                             <ItemStyle ... HorizontalAlign="Center"   />
                            <ItemTemplate>
                                 <asp:CheckBox class="enforceAll" ID="cbYes2" runat="server"  />
                                    <cc1:MutuallyExclusiveCheckBoxExtender ID="mecbe1" runat="server" TargetControlID="cbYes2"  />
                             </ItemTemplate>
                        </telerik:GridTemplateColumn>                           
                        <telerik:GridTemplateColumn HeaderText="" UniqueName="ignoreCheckBoxYesColumn">
                             <HeaderStyle HorizontalAlign="Center"  />

                             <ItemStyle  HorizontalAlign="Center"   />
                             <ItemTemplate>    
                                 <asp:CheckBox  ID="cbNo2" runat="server"  />
                                    <cc1:MutuallyExclusiveCheckBoxExtender ID="mecbe2" runat="server" TargetControlID="cbNo2" />
                             </ItemTemplate>
                        </telerik:GridTemplateColumn> 
```

下面是 C# 中的代码：

```
CheckBox cb = (CheckBox)headerItem.FindControl("cbYesHead2");

                cb.Attributes.Add(...);
                AjaxControlToolkit.MutuallyExclusiveCheckBoxExtender mecbeYes = (AjaxControlToolkit.MutuallyExclusiveCheckBoxExtender)headerItem.FindControl("mecbeYesHead2");
                mecbeYes.Key = "head_" +...

cb = (CheckBox)headerItem.FindControl("cbNo2");
                cb.Attributes.Add(...);
                AjaxControlToolkit.MutuallyExclusiveCheckBoxExtender mecbeNo = (AjaxControlToolkit.MutuallyExclusiveCheckBoxExtender)headerItem.FindControl("mecbe2");
                mecbeNo.Key = "head_" + ... 
```

# java - 在父类的主方法中调用子类覆盖抽象方法

> ID：12187777
> 
> 赞同：0
> 
> 时间：2012-08-29T23:14:34.053
> 
> 标签：java, methods, call, subclass, abstract

我有抽象类 Tester，带有抽象方法 test() 和 main 方法：

```
 abstract class Tester {

     abstract String test();

     public static void main(String[] args) {
          doSomething();

          Tester t = new Tester() {
          @Override
              String test() {
                return "";
              }
          };        
          result = t.test();

          doSomethingElse();
     }            
    } 
```

显然 t.test() 将始终为此类和任何其他子类返回 "" 。

但是我想在 main 方法中调用 test() 方法，这样任何子类都会在其执行时调用**自己的**测试方法（在其继承的 main 方法中）。

这甚至可能以我想象的方式吗？我可以以某种方式将对象 t 声明为子类对象（不知道他的名字），以便他可以使用他自己的这个抽象方法的实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T00:44:10.237

在我看来，您还没有完全考虑过您希望如何设计您的应用程序/对象结构。尝试看看是否有更好的方法可以组织您的对象。

使您的情况正常工作的唯一方法是，如果您有一个 test() 方法委托给当前实例的 test0() 方法或类似方法。这是 Java 在某些地方内部使用的技巧。

# xml - XSLT：解析多个同名

> ID：12187779
> 
> 赞同：2
> 
> 时间：2012-08-29T23:14:41.933
> 
> 标签：xml, xslt, xpath

由于下面的源 XML 值/字符串元素值必须替换为目标元素值，请有人帮助我如何创建 XSL 以将源 xml 转换为目标 xml。请。

## 源 XML：

```
 <PricingResultsV6>     
 <subItems>
 <SubItem>   
 <profiles>
 <ProfileValues>
 <values> 
 <strings>800210</strings> 
 <strings>THC</strings> 
 <strings>10.0</strings> 
 <strings>20.0</strings> 
 <strings>30.0</strings> 
 <strings>40.0</strings> 
 <strings>550.0</strings> 
 <strings>640.0</strings> 
 </values>
</ProfileValues>
</rofiles>
</SubItem>
</subItems>
</PricingResultsV6> 
```

目标 XML：

```
<CalculationOutput>
            <PolicyNumber> 800210 </PolicyNumber>
            <CommissionFactorMultiplier> THC </CommissionFactorMultiplier>
            <PremiumValue>10.0</PremiumValue>
            <SalesmanCommissionValue>20.0</SalesmanCommissionValue>
            <ManagerCommissionValue>30.0</ManagerCommissionValue>
            <GL_COR> 550.0</GL_COR>
            <GL_OPO>640.0</GL_OPO>

</CalculationOutput> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:32:15.483

利用：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" />

    <xsl:template match="//values">
        <CalculationOutput>
            <PolicyNumber>
                <xsl:value-of select="strings[1]"/>
            </PolicyNumber>
            <CommissionFactorMultiplier>
                <xsl:value-of select="strings[2]"/>
            </CommissionFactorMultiplier>
            <PremiumValue>
                <xsl:value-of select="strings[3]"/>
            </PremiumValue>
            <SalesmanCommissionValue>
                <xsl:value-of select="strings[4]"/>
            </SalesmanCommissionValue>
            <ManagerCommissionValue>
                <xsl:value-of select="strings[5]"/>
            </ManagerCommissionValue>
            <GL_COR>
                <xsl:value-of select="strings[7]"/>
            </GL_COR>
            <GL_OPO>
                <xsl:value-of select="strings[8]"/>
            </GL_OPO>
        </CalculationOutput>
    </xsl:template>
</xsl:stylesheet> 
```

输入：

```
<PricingResultsV6>     
    <subItems>
        <SubItem>   
            <profiles>
                <ProfileValues>
                    <values> 
                        <strings>800210</strings> 
                        <strings>THC</strings> 
                        <strings>10.0</strings> 
                        <strings>20.0</strings> 
                        <strings>30.0</strings> 
                        <strings>40.0</strings> 
                        <strings>550.0</strings> 
                        <strings>640.0</strings> 
                    </values>
                </ProfileValues>
            </profiles>
        </SubItem>
    </subItems>
</PricingResultsV6> 
```

输出：

```
<CalculationOutput>
    <PolicyNumber>
        800210
    </PolicyNumber>
    <CommissionFactorMultiplier>
        THC
    </CommissionFactorMultiplier>
    <PremiumValue>
        10.0
    </PremiumValue>
    <SalesmanCommissionValue>
        20.0
    </SalesmanCommissionValue>
    <ManagerCommissionValue>
        30.0
    </ManagerCommissionValue>
    <GL_COR>
        550.0
    </GL_COR>
    <GL_OPO>
        640.0
    </GL_OPO>
</CalculationOutput> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T04:19:24.327

啊。我刚刚回答[了这个问题的确切副本](https://stackoverflow.com/questions/12187361/xslt-i-need-to-parse-the-xml-with-same-element-name-with-sequence-of-order-to)。

由于我的 XSLT 1.0 示例和我的 XSLT 2.0 示例都包含在 Dimitre 和 Kirill 的答案中，我将添加我的 XSLT 3.0 答案...

**XML 输入**

```
<PricingResultsV6>
    <subItems>
        <SubItem>
            <profiles>
                <ProfileValues>
                    <values>
                        <strings>800210</strings>
                        <strings>THC</strings>
                        <strings>10.0</strings>
                        <strings>20.0</strings>
                        <strings>30.0</strings>
                        <strings>40.0</strings>
                        <strings>550.0</strings>
                        <strings>640.0</strings>
                    </values>
                </ProfileValues>
            </profiles>
        </SubItem>
    </subItems>
</PricingResultsV6> 
```

**XSLT 3.0**（使用 Saxon-EE 9.4 测试）

```
<xsl:stylesheet version="3.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
    exclude-result-prefixes="map">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:variable name="vMap" select="map {
        1:='PolicyNumber',
        2:='CommissionFactorMultiplier',
        3:='PremiumValue',
        4:='SalesmanCommissionValue',
        5:='ManagerCommissionValue',
        7:='GL_COR',
        8:='GL_OPO',
        }"/>

    <xsl:template match="ProfileValues">
        <CalculationOutput>
            <xsl:apply-templates select="values/strings"/>
        </CalculationOutput>
    </xsl:template>

    <xsl:template match="strings[map:contains($vMap,position())]">      
        <xsl:element name="{map:get($vMap,position())}">
            <xsl:value-of select="."/>
        </xsl:element>
    </xsl:template>

    <xsl:template match="text()"/>

</xsl:stylesheet> 
```

**XML 输出**

```
<CalculationOutput>
   <PolicyNumber>800210</PolicyNumber>
   <CommissionFactorMultiplier>THC</CommissionFactorMultiplier>
   <PremiumValue>10.0</PremiumValue>
   <SalesmanCommissionValue>20.0</SalesmanCommissionValue>
   <ManagerCommissionValue>30.0</ManagerCommissionValue>
   <GL_COR>550.0</GL_COR>
   <GL_OPO>640.0</GL_OPO>
</CalculationOutput> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T01:52:07.810

**`strings`**这种通用转换允许在元素和必须生成**的相应元素名称****之间进行单独的（即使在不同的文档中或作为外部参数传递）映射：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:my="my:my" exclude-result-prefixes="my">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <my:mapping>
  <map key="1" value="PolicyNumber"/>
  <map key="2" value="CommissionFactorMultiplier"/>
  <map key="3" value="PremiumValue"/>
  <map key="4" value="SalesmanCommissionValue"/>
  <map key="5" value="ManagerCommissionValue"/>
  <map key="7" value="GL_COR"/>
  <map key="8" value="GL_OPO"/>
 </my:mapping>
 <xsl:variable name="vMaps" select="document('')/*/my:mapping/*"/>  

 <xsl:template match="values">
     <CalculationOutput>
       <xsl:apply-templates/>
     </CalculationOutput>
 </xsl:template>

 <xsl:template match="strings">
  <xsl:if test="position()=$vMaps/@key">
    <xsl:variable name="vPos" select="position()"/>
    <xsl:element name="{$vMaps[@key = $vPos]/@value}">
      <xsl:value-of select="."/>
    </xsl:element>
  </xsl:if>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<PricingResultsV6>
    <subItems>
        <SubItem>
            <profiles>
                <ProfileValues>
                    <values>
                        <strings>800210</strings>
                        <strings>THC</strings>
                        <strings>10.0</strings>
                        <strings>20.0</strings>
                        <strings>30.0</strings>
                        <strings>40.0</strings>
                        <strings>550.0</strings>
                        <strings>640.0</strings>
                    </values>
                </ProfileValues>
            </profiles>
        </SubItem>
    </subItems>
</PricingResultsV6> 
```

**产生了想要的正确结果**：

```
<CalculationOutput>
   <PolicyNumber>800210</PolicyNumber>
   <CommissionFactorMultiplier>THC</CommissionFactorMultiplier>
   <PremiumValue>10.0</PremiumValue>
   <SalesmanCommissionValue>20.0</SalesmanCommissionValue>
   <ManagerCommissionValue>30.0</ManagerCommissionValue>
   <GL_COR>550.0</GL_COR>
   <GL_OPO>640.0</GL_OPO>
</CalculationOutput> 
```

* * *

**二、这个解决方案可以通过使用 keys 变得非常高效**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:my="my:my" exclude-result-prefixes="my">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <my:mapping>
  <map key="1" value="PolicyNumber"/>
  <map key="2" value="CommissionFactorMultiplier"/>
  <map key="3" value="PremiumValue"/>
  <map key="4" value="SalesmanCommissionValue"/>
  <map key="5" value="ManagerCommissionValue"/>
  <map key="7" value="GL_COR"/>
  <map key="8" value="GL_OPO"/>
 </my:mapping>
 <xsl:variable name="vMaps" select="document('')/*/my:mapping/*"/>  

 <xsl:key name="kValueByKey" match="@value" use="../@key"/>

 <xsl:template match="values">
     <CalculationOutput>
       <xsl:apply-templates/>
     </CalculationOutput>
 </xsl:template>

 <xsl:template match="strings">
  <xsl:if test="position()=$vMaps/@key">
    <xsl:variable name="vPos" select="position()"/>
    <xsl:variable name="vCur" select="."/>
     <xsl:for-each select="$vMaps/..">
        <xsl:element name="{key('kValueByKey', $vPos)}">
          <xsl:value-of select="$vCur"/>
        </xsl:element>
     </xsl:for-each>
  </xsl:if>
 </xsl:template>
</xsl:stylesheet> 
```

# django - 将客户端 IP 信息添加到 django 记录器中

> ID：12187786
> 
> 赞同：5
> 
> 时间：2012-08-29T23:15:20.890
> 
> 标签：django, logging, ip

我正在尝试将客户端 IP 添加到日志文件中，我曾考虑扩展 Logger，但不确定如何访问请求对象并将 IP 放入记录对象

```
from logging.handlers import RotatingFileHandler

class RequestRotatingFileLogger(RotatingFileHandler, object):
    def emit(self, record):
        """
        code to manipulate the record to add an attribute to have client IP
        record.ip = '123.123.123.123'
        """
        super(RequestRotatingFileLogger,self).emit(record) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-30T00:35:06.267

好的，在阅读了一些 Logger 源代码后，我发现了一种 hacky 方法

```
from logging.handlers import RotatingFileHandler

class RequestRotatingFileLogger(RotatingFileHandler, object):
        def emit(self, record):
            record.ip = '0.0.0.0'
            try:
                request = record.args[0]
                record.ip = request.META.get('REMOTE_ADDR')  
                record.args = None
            except:
                pass

            super(RequestRotatingFileLogger,self).emit(record) 
```

并在记录时，将请求对象作为第二个参数传递，例如。

```
logger.info('message', request) 
```

# javascript - 如何通过java servlet中的javascript刷新图像

> ID：12187792
> 
> 赞同：1
> 
> 时间：2012-08-29T23:16:22.057
> 
> 标签：javascript, servlets, refresh, image

刷新图像时遇到一些麻烦，我有一个在后台运行的脚本更新图像，我想每 X 秒显示一次新图像，但是当我在浏览器中运行时，图像没有刷新
有人有任何想法吗？

```
<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\>
<html> 
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1\>
        <title> Title </title> 

        <script>
            var image;
            var imgBase="images/test.jpeg"
            function count(){
                image.src=imgBase;
            }

            function init(){
                image = document.getElementById("image");

                if( image ){
                    setInterval("count()",1000);
                }
            }

            window.onload = init;
        </script>
    </head>
    <body>
        <img src="images/test.jpeg" id="image">
    </body>
</html> 
```

Web 应用程序具有以下目录树..

```
.
├── Home.jsp
├── images
│   ├── test.jpeg
├── META-INF
│   └── MANIFEST.MF
├── style.css
└── WEB-INF
    ├── classes
    │   └── test
    │       └── my
    │           └── new
    │               └── package
    │                   └── Test.class
    ├── lib
    └── web.xml
    9 directories, 10 files 
```

Web 控制台在检索图像时没有显示任何错误，但它没有刷新？
`[00:53:15.896] GET http://host:8085/Servlet/Display?config=L1 [HTTP/1.1 200 OK 2ms]`
`[00:53:16.419] GET http://host:8085/Servlet/images/test.jpeg [HTTP/1.1 200 OK 2ms]`

感谢任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T11:36:44.243

浏览器正在显示浏览器缓存中的图像。

一种解决方法是使用唯一的请求参数（例如时间戳）来请求图像，从而迫使浏览器实际发送新的 HTTP 请求，而不是显示来自浏览器缓存的图像。

```
function count(){
    image.src = imgBase + "?" + new Date().getTime();
} 
```

* * *

请注意，这个具体问题与 servlet 无关。更重要的是，将 HTML 代码直接放在 servlet 类中是一种糟糕的做法。HTML 代码属于 JSP 文件（而 Java 代码属于 servlet 类）。

# ruby-on-rails - Bootstrap Typeahead 仅显示第一个字母

> ID：12187793
> 
> 赞同：5
> 
> 时间：2012-08-29T23:16:24.123
> 
> 标签：ruby-on-rails, twitter-bootstrap, datasource, typeahead

我很难让 Twitter Bootstrap 的 Typeahead 正常工作。Typeahead 仅匹配输入的第一个字母。我在预输入框中的结果看起来像

```
n
n
n
N
N
n. 
```

我的代码是

```
<%= text_field_tag :search, params[:search], "data-provide" => "typeahead", "data-source" => '["USA", "Canada","Mexico"]' %> 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T10:54:48.917

检查 html 中为 data-source 属性输出的引号组合。下面的代码片段我遇到了同样的问题。

```
<input type="text" name="test" id="test" class="span2" data-provide="typeahead" 
data-items="4" data-source="['thisone','another','zzzz']"> 
```

更改为我在其他示例中看到的以下内容并没有解决它

```
data-source="["thisone","another","zzzz"]" 
```

但是切换到属性值周围的单引号和可搜索元素的双引号修复了它。**这行得通**。

```
data-source='["thisone","another","zzzz"]' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-10T10:42:16.080

对于在使用源函数（即对您的服务器的 ajax 调用）时遇到此问题的任何人：

利用：

```
process(JSON.parse(data)); 
```

代替：

```
process(data); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T20:49:21.843

我刚刚尝试了您的代码，它对我有用。但是，当我将引号更改为这样时，我遇到了您遇到的问题：

```
"['USA', 'Canada','Mexico']" 
```

我遇到了类似的问题，它与您的问题略有不同，但它可能对其他人有所帮助。发生在我身上的是，我传递给 typeahead 的 JSON 被解释为字符数组。所以如果我通过了：

```
["USA", "Canada","Mexico"] 
```

它会将其解释为 26 个字符的数组，因此预先输入给我的结果是单个字符。

就我而言，这是因为我正在进行 ajax 调用并且我没有将 dataType 设置为“json”。在你的情况下，这不是问题，但希望这能让你走向解决方案！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-24T06:12:32.357

```
var data = "";
$.ajax({
        url: 'ajax/getdirverandpass.php',
        success: function (result) {
            data = JSON.parse(result);
        },
        async: false
});

 $("#nav-search-input").typeahead({source: data, updater: function (a) {
            $("#nav-search-input").focus();
            return a
}}); 
```

请使用这个 JSON.parse(result);

# python - 如何在 Mac 上使用 R 从蓝牙源流式传输数据？

> ID：12187795
> 
> 赞同：0
> 
> 时间：2012-08-29T23:16:43.323
> 
> 标签：python, macos, r, bluetooth

我有一台通过蓝牙连接到我的 Mac 的设备。我想使用 R（或者 Python，但首选 R）来实时读取数据并进行处理。有谁知道我如何在 Mac 上使用 R 进行数据流传输？干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:39:07.960

很有可能您可以将蓝牙枚举为蓝牙的串行端口，并使用 pyserial 模块很容易地进行通信......

但是如果这个设备没有连续枚举，你会非常头疼尝试这样做......

查看是否有任何可用的 com 端口，如果几乎可以肯定地枚举为串行连接

# python - Python中的正则表达式不会匹配字符串的结尾

> ID：12187799
> 
> 赞同：18
> 
> 时间：2012-08-29T23:17:16.173
> 
> 标签：python, regex

我只是在学习Python，我似乎无法弄清楚正则表达式。

```
r1 = re.compile("$.pdf")
if r1.match("spam.pdf"):
    print 'yes'
else:
    print 'no' 
```

我希望这段代码打印“是”，但它顽固地打印“否”。我还尝试了以下各项：

```
r1 = re.compile(r"$.pdf")

r1 = re.compile("$ .pdf")

r1 = re.compile('$.pdf')

if re.match("$.pdf", "spam.pdf")

r1 = re.compile(".pdf") 
```

加上无数其他变化。我一直在寻找很长一段时间，但找不到/理解任何可以解决我的问题的东西。有人可以帮助新手吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-08-29T23:18:54.240

您已经尝试了所有变体，除了有效的变体。出现`$`在模式的*末尾*。此外，您需要转义句点，以便它实际上匹配一个句点（通常它匹配任何字符）。

```
r1 = re.compile(r"\.pdf$") 
```

但是，更简单、更清晰的方法是使用字符串的`.endswith()`方法：

```
if filename.endswith(".pdf"):
    # do something 
```

这样你就不必破译正则表达式来理解发生了什么。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-08-29T23:24:06.160

## 的行为`re.match()`和`re.search()`

有一个显着的区别：[`re.match()`](http://docs.python.org/library/re.html#re.match)检查字符串**的开头**，您很可能正在寻找[`re.search()`](http://docs.python.org/library/re.html#re.search).

两种方法的比较清楚地显示在名为“ [*search() vs. match()*](http://docs.python.org/library/re.html#search-vs-match) ”的 Python 文档章节中

## 正则表达式中的特殊字符

此外，正则表达式中字符的含义与您尝试使用它的含义不同（有关详细信息，请参阅[正则表达式语法](http://docs.python.org/library/re.html#regular-expression-syntax)）：

*   `^`匹配开头：

    > （插入符号。）匹配字符串的开头，并且在 MULTILINE 模式下也立即匹配每个换行符之后。

*   `$`匹配结尾：

    > 匹配字符串的结尾或字符串末尾的换行符之前，并且在`MULTILINE`模式下也匹配换行符之前。foo 匹配 '<code>foo' 和 '<code>foobar'，而正则表达式`foo$`仅匹配 '<code>foo'。更有趣的是，在 'foo1\nfoo2\n' 中搜索 foo.$ 通常匹配 '<code>foo2'，但在`MULTILINE`mode 中搜索 '<code>foo1'；`$`在 ' ' 中搜索单个`foo\n`将找到两个（空）匹配项：一个在换行符之前，一个在字符串末尾。

## 完整答案

您正在寻找的解决方案可能是：

```
import re
r1 = re.compile("\.pdf$")  # regular expression corrected
if r1.search("spam.pdf"):  # re.match() replaced with re.search()
    print "yes"
else:
    print "no" 
```

检查字符串是否以“ `.pdf`”结尾。与 kindall 的答案相同`.endswith()`，但如果 kindall 的答案适合您，请选择它（它更简洁，因为您可能根本不需要正则表达式）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-29T23:21:49.963

## 你的问题

`$`意思是“字符串的结尾”。所以，你需要一个正则表达式`\.pdf$`来匹配：

1.  一个点 ( `.`)，因为它是正则表达式中的特殊字符而被转义。
2.  字符串“ `pdf`”
3.  字符串结束。

## 延伸阅读

正则表达式超越了语言、Python 或其他语言，所以你应该先阅读一些关于它们的教程。考虑[正则表达式.info](http://www.regular-expressions.info)。这实际上不是 Python 问题，而是一个基本的正则表达式问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T23:19:36.767

正则表达式`$.pdf`说“找到字符串的结尾，然后找到任何字符以及超出字符串结尾的任何字符，找到 ap、ad 和一个 f”。

正如所写，它无法合理地匹配任何东西。

但是，`pdf$`会匹配。

在这种特定情况下，您可能还想做 a`search`而不是`match`，因为我相信 match 本质上锚定在字符串的开头。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-12-14T15:11:50.757

我看到了 2 个快速的选择：

*   `re.match(pattern='.*pdf$', string='filename.pdf')`

    使用这个解决方案，我们必须指定我们不关心字符串如何开始。但是我们不能省略开头的表达式。使用时，`re.match()`您必须确保提供对整个字符串有效的正则表达式，即从索引 0 开始，请参阅[https://docs.python.org/3/howto/regex.html#match-versus-search](https://docs.python.org/3/howto/regex.html#match-versus-search)

*   `re.search(pattern='\.pdf$', string='filename.pdf')`

    我们不关心字符串是如何开始的，我们只是搜索一个以扩展名结尾的字符串

已回答已被接受，但我个人需要检查官方文档以明确这一点。

# gallery - Galleria 从文件夹加载图像

> ID：12187800
> 
> 赞同：0
> 
> 时间：2012-08-29T23:17:18.397
> 
> 标签：gallery, photo, galleria

如何配置 Galleria 图片库 (http://galleria.io/) 以从指定文件夹加载图片？这样，如果我想上传一张新照片，我不需要在我的 html 文件中添加新的 img src。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:25:43.880

Javascript 无法查看服务器上的文件系统。没有真正的方法可以做到这一点。但是，您可以在该文件夹中有一个 js 文件，该文件保留该文件夹中所有图像的索引。然后您可以先加载该文件，然后从中动态加载图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T15:35:52.970

如果您正在寻找一种简单地将图像上传到文件夹的方法（例如在旅途中使用手机）并让 Galleria 显示此文件夹中的所有图像，您可以使用 htaccess 文件，拆分页面进入 header.html 和 footer.html。如果配置正确，htacess 文件将读取目录中的所有文件，根据您的设置对其进行排序（如日期降序）并将 img src 代码放入最终的 html 文档中。Galleria 脚本进入 footer.html 并将读取 htaccess 文件创建的 img 列表。

# objective-c - 如何直接更新像素 - 使用 CGImage 和直接 CGDataProvider

> ID：12187801
> 
> 赞同：9
> 
> 时间：2012-08-29T23:17:45.720
> 
> 标签：objective-c, ios, opengl-es, core-graphics, core-video

**实际问题**

几个答案将解决我的问题：

1.  我可以像这样强制 a`CGImage`从直接数据提供者（使用 创建`CGDataProviderCreateDirect`）重新加载其数据`CGContextDrawImage`吗？还是有其他方法可以设置 self.layer.contents 来做到这一点？
2.  是否有`CGContext`配置或技巧可以用来渲染 1024x768 图像，至少 30 fps 与`CGContextDrawImage`.
3.  有没有人能够成功地使用`CVOpenGLESTextureCacheCreateTextureFromImage`他们自己的纹理数据进行实时缓冲区更新？我认为我最大的问题是创建一个`CVImageBuffer`，因为我从 Apples 的纹理文档中复制了其他属性。如果有人对此有更多信息，那就太棒了。
4.  关于如何以 30 fps 从内存中获取图像到屏幕上的任何其他指南。

**背景（批次）：**

我正在做一个项目，我需要实时修改 NPOT 图像数据的像素（最低 30 fps）并将其绘制在 iOS 的屏幕上。

我的第一个想法是使用 OpenGL`glTexSubimage2D`进行更新，不幸的是最终速度非常慢（iPad 上为 6 fps），因为驱动程序将我的 RGB 数据每帧转换为 BGR。所以用你说的 BGR 发送它，我也是，但由于某种原因你不能`glTexSubImage2D`用`GL_BGR`go figure 调用。我知道有些慢是因为它不是 2 图像数据的幂，但我的要求决定了这一点。

更多阅读使我想到，`CVOpenGLESTextureCacheCreateTextureFromImage`但所有示例都是使用直接相机输入来获取`CVImageBufferRef`我尝试使用文档（没有官方但只是标题注释）来使我自己的 CVImageBuffer 形成我的图像数据，但它不适用于此（否错误只是调试器中的一个空纹理），这让我认为Apple专门为处理实时相机数据而构建了它，并且除了IDK之外，它还没有在这个领域之外进行过太多测试。

无论如何，在通过转储 OpenGL 并将我的想法切换到 CoreGraphics 来放弃我的尊严之后，我被引导到这个问题，这[是在 iPhone 上绘制屏幕缓冲区的最快方法，](https://stackoverflow.com/questions/2395650/fastest-way-to-draw-a-screen-buffer-on-the-iphone) 它建议使用`CGImage`backed by `CGDataProviderCreateDirect`，它允许您在CGImage 需要它，很棒吧？好吧，它似乎并不像宣传的那样有效。如果我使用`CGContextDrawImage`，那么一切正常。我可以修改像素缓冲区，每次绘制时，它都会像它应该的那样从我的数据提供者那里请求图像数据，调用`CGDataProviderDirectCallbacks`(`Note:`他们似乎有一个内置的优化，如果更新的指针与之前的地址相同，则忽略更新的指针）。即使禁用插值，CGContextDrawImage 也不是超快（大约 18 fps），这从 6 fps 提高了。Apple 的文档告诉我使用`self.layer.contents`会比`CGContextDrawImage`. using`self.layer.contents`适用于第一次分配，但即使我`CGImage`调用. 在我引用的 SO 问题中，用户通过每帧从数据源创建和销毁一个新的 CGImage 来展示他对问题的解决方案，这是一个非常缓慢的过程（是的，我确实尝试过），所以是时候提出真正的问题了。`CGContextDrawImage``[layer setNeedsDisplay]`

**注意**：我已经分析了所有这些操作，并且知道问题确实`glTexSubImage`出在 OpenGL 上，并且`CGContextDrawImage`确实是 CoreGraphics 的问题，所以没有“go profile”的答案。

**编辑**演示此技术的源代码现在可以在[http://github.com/narpas/image-sequence-streaming找到](http://github.com/narpas/image-sequence-streaming)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-01T03:13:50.253

感谢 Brad Larson 和 David H 提供的帮助（请参阅我们在评论中的完整讨论）。事实证明，使用 OpenGL 和 CoreVideo`CVOpenGLESTextureCache`最终成为将原始图像推送到屏幕的最快方式（我知道 CoreGraphics 不可能是最快的！），在 iPad 1 上为我提供 60 fps 的全屏 1024x768 图像。几乎没有文档现在就这一点，所以我将尝试尽可能多地解释以帮助人们：

`CVOpenGLESTextureCacheCreateTextureFromImage`允许您创建一个 OpenGL 纹理，其内存直接映射到`CVImageBuffer`您用于创建它的内存。这允许您使用原始数据创建 a`CVPixelBuffer`并修改从 收集的数据指针`CVPixelBufferGetBaseAddress`。这为您在 OpenGL 中提供即时结果，无需修改或重新上传实际纹理。只需确保`CVPixelBufferLockBaseAddress`在修改像素之前锁定并在完成后解锁。请注意，目前这在 iOS 模拟器中不起作用，仅在我推测来自 VRAM/RAM 部门的设备上工作，其中 CPU 无法直接访问 VRAM。`glTexImage2D`Brad 建议使用条件编译器检查在原始更新和使用纹理缓存之间切换。

需要注意的几件事（这些因素的组合导致它对我不起作用）：

1.  在设备上测试
2.  确保您`CVPixelBuffer`得到支持，例如`kCVPixelBufferIOSurfacePropertiesKey`查看[链接](http://allmybrain.com/2011/12/08/rendering-to-a-texture-with-ios-5-texture-cache-api/)（再次感谢布拉德）。
3.  您必须`GL_CLAMP_TO_EDGE`在 OpenGL ES 2.0 中使用 NPOT 纹理数据
4.  绑定纹理缓存 `glBindTexture(CVOpenGLESTextureGetTarget(_cvTexture), CVOpenGLESTextureGetName(_cvTexture));`不要像我一样愚蠢并`CVOpenGLESTextureGetTarget`用于两个参数。
5.  不要每帧都重新创建纹理，只需将图像数据复制到从中获取的指针中`CVPixelBufferGetBaseAddress`即可更新纹理。

# javascript - 如何修复 Greasemonkey (GM_xmlhttpRequest) 上的 __exposedProps__ 错误？

> ID：12187805
> 
> 赞同：3
> 
> 时间：2012-08-29T23:18:14.333
> 
> 标签：javascript, firefox, greasemonkey, gm-xmlhttprequest

我已经为 Greasemonkey 编写了我的第一个脚本，它工作得很好，只是它在它正在处理的每个页面中都返回**了exposedProps**错误。我已经修复了所有其他错误，但这个错误仍然存​​在，并且基于网络上的一些文章（如[this](http://www.ghacks.net/2012/08/22/mozilla-firefox-17-better-add-on-security-but-some-add-ons-may-break/)），它会在将来发布 Firefox 17 时破坏我的脚本。（现在我使用的是 Firefox 15.0，幸运的是它只是返回一个警告错误！）

我在我的脚本中使用 GM_xmlhttpRequest：

```
function doProcess(id, in_process_type){

    var set_id = GM_getValue("pid"+id);

    GM_xmlhttpRequest({
        method: "POST",
        url: "https://website_address/return_params.php",
        data: "pid="+set_id,
        headers: {
            "Content-Type": "application/x-www-form-urlencoded"
        },
        onload: function(response) {
    --->    var params = response.responseText;
            params = params.replace(/(\r\n|\n|\r|\s)/gm,"");

            ..........
        }
    });
} 
```

这是错误消息，指的是我在它前面放了一个箭头的那一行：

```
Error: Exposing chrome JS objects to content without __exposedProps__ is insecure and deprecated. See https://developer.mozilla.org/en/XPConnect_wrappers for more information.
Source File: file:///Users/Mona/Library/Application%20Support/Firefox/Profiles/tonfd656.default/gm_scripts/MonaTest/MonaTest.user.js
Line: 133 
```

我找到了这个[页面](https://blog.mozilla.org/addons/2012/08/20/exposing-objects-to-content-safely/)，它提供了这个错误的解决方案，但老实说，我不知道如何在这里使用它！

我非常感谢您提前提供的所有帮助...感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T00:50:24.750

这是 Greasemonkey 本身的问题/潜在错误。看：

*   [*问题 #1595*，“使用**暴露道具**”](https://github.com/greasemonkey/greasemonkey/issues/1595)
*   [*问题 #1607*，“GM_xmlhttpRequest response.responseText 在 Nightly17.0a1 中未定义...”](https://github.com/greasemonkey/greasemonkey/issues/1607)

您可能想要权衡并跟踪这些错误报告。

如果您链接到您的**完整脚本**，我们可能会提供解决方法，但很可能只能在 Greasemonkey 本身内修复。

# iphone - iOS 将整个核心数据数据库保存为 JSON 字符串，反之亦然

> ID：12187806
> 
> 赞同：1
> 
> 时间：2012-08-29T23:18:18.420
> 
> 标签：iphone, ios, json, ipad, core-data

我想知道如何将 iOS 应用程序上的整个核心数据库序列化为 JSON，以便我可以在云中备份它。当用户想要恢复时，如何取回 JSON 字符串并从中生成整个核心数据库？

是否可以？有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T23:34:14.050

当然。您可以轻松地使用JSON 序列化/反序列化对象，以及上传或下载 JSON。 `[NSJSONSerialization](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)` `[NSURLRequest](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLRequest_Class/Reference/Reference.html)/[Connection](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsurlconnection_Class/Reference/Reference.html)`

`[AFNetworking](http://engineering.gowalla.com/2011/10/24/afnetworking/)` 是一个流行的网络框架，内置了 JSON 序列化/反序列化。我还没有使用它，所以我不能亲自担保它，但它看起来很实用。

`[NSManagedObject](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObject_Class/Reference/NSManagedObject.html)` （Core Data 基础对象）有一个与之关联的方法，它应该可以轻松编写序列化/反序列化方法，而无需为每个类和属性编写显式代码。 `[NSEntityDescription](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSEntityDescription_Class/NSEntityDescription.html)` `- (NSDictionary *)attributesByName`

我发现 Core Data 对我的大部分需求来说既繁重又复杂，并且通常使用该协议编写本地存储和序列化/反序列化。您也可以为未来的项目考虑这一点。 `[NSCoding](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Protocols/NSCoding_Protocol/Reference/Reference.html)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T23:37:41.187

看看[NSJSONSerialization 类参考](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)。将 JSON 放入 Core Data 肯定是可以做到的，但它需要一个自定义函数将所有数据放在适当的位置。`JSONObjectWithData`将获取一个 JSON 文件并将其放入 NSDictionary。

```
NSData *data = [NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://linktojson.com/file.json"]];

NSError *error = nil;

NSDictionary *results = [NSJSONSerialization
                                 JSONObjectWithData:data
                                 options:NSJSONReadingMutableLeaves
                                 error:&error]; 
```

从那里您可以将字典中的数据放入 Core Data。

相反，它可能可以完成并且`dataWithJSONObject`可能是最后一步，但到达那里可能会沿着重建`JSONObjectWithData`上面创建的 NSDictionary 的路线。

# php - 从在线表单中获取的电子邮件在传入消息中未显示为发件人（PHP 代码问题？）

> ID：12187807
> 
> 赞同：0
> 
> 时间：2012-08-29T23:18:26.040
> 
> 标签：php, forms

我的php有问题。我确定它过去是有效的，但现在是错误的。问题是 - 此代码假设使用表单数据发送电子邮件消息，并且它应该来自“电子邮件”，因此将在“电子邮件”字段中键入的任何内容都应该显示为传入消息的发件人。它无法正确显示，因此当我在 Outlook 中使用 REPLY 按钮时，它无法发送电子邮件，因为它无法回复任何内容。可能是什么问题？这段代码可以吗？

代码在这里：

```
$adresdo = "office@tucadomusic.co.uk";
$temat = "Quote from the website";
$zawartosc = "Name: ".$_POST['name']."\n"
           ."Email: ".$_POST['email']."\n"
           ."Telephone: ".$_POST['tel']."\n"
           ."Date: ".$_POST['date']."\n";

if(!$_POST['name'] || !$_POST['tel'] || !$_POST['date']){
 header("Location: ../quote.html");
 exit;
}
 if(mail($adresdo, $temat, $zawartosc, 'From: Contact <'.$email.'>')){
header("Location: ../msg_sent.html"); 
} 
```

感谢您提前提供任何帮助。P。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T23:21:24.537

`$email`没有定义。您需要将其分配给某些东西。

```
$email = $_POST['email']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T23:23:41.897

当您发送邮件时，您应该使用标题信息。（您可以在这里查看：[php 电子邮件标头](https://stackoverflow.com/questions/4178223/php-email-headers)）

您的问题与此主题有关。

# c# - 从列表中添加、编辑、删除项目

> ID：12187810
> 
> 赞同：0
> 
> 时间：2012-08-29T23:18:41.370
> 
> 标签：c#, list, listview

我有一个字符串列表，`List<String>`.

我希望能够打开一个表单，显示此列表的内容，并允许用户在运行时添加、编辑和删除列表中的项目。

我一直在查看 ListView，但它并没有为我点击。我不确定那是因为它不是正确的解决方案还是我不明白。

我想做的正确解决方案是什么？

查克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T05:47:58.347

您可以使用 a`list view`和 a`context menu`作为您的目标：试试这个代码：

```
 List<string> listofstring = new List<string>() {"A","B","C" };
    private void Form1_Load(object sender, EventArgs e)
    {
        FillLstView();
    }

    private void Additem_Click(object sender, EventArgs e)
    {
        listofstring.Add("New Item");
        FillLstView();
    }

    private void RemoveItem_Click(object sender, EventArgs e)
    {
        listofstring.RemoveAt(lstview.FocusedItem.Index);
        EditItem.Enabled = false;
        RemoveItem.Enabled = false;
        FillLstView();
    }

    private void lstview_SelectedIndexChanged(object sender, EventArgs e)
    {
            RemoveItem.Enabled = true;
            EditItem.Enabled = true;
    }

    private void EditItem_Click(object sender, EventArgs e)
    {
        string input = Microsoft.VisualBasic.Interaction.InputBox("Enter Edit", "Title", "Edited", 0, 0);
        if (input != "")
        {
            listofstring[lstview.FocusedItem.Index] = input;
            EditItem.Enabled = false;
            RemoveItem.Enabled = false;
            FillLstView();
        }
    }

    private void FillLstView()
    {
        lstview.Clear();
        foreach (var item in listofstring)
        {
            lstview.Items.Add(item);
        }
    } 
```

**结果**

![在此处输入图像描述](../Images/72caa99049890b3779c30fa78c27fbca.png)

**[下载项目](http://www.uploadbaz.com/r5tztluu43ax)**

# objective-c - 关闭弹出框后如何确定从 UIDatePicker 中选择的日期？

> ID：12187811
> 
> 赞同：0
> 
> 时间：2012-08-29T23:18:42.507
> 
> 标签：objective-c, xcode, uidatepicker, uistoryboard

我目前有一个`DatePickerViewController`我在情节提要中创建的具有 UIDatePicker 的弹出框。我希望能够关闭弹出窗口并将日期发送到我的原始视图`ViewController`，但我不确定如何执行此操作。我知道如何从 UIDatePicker 获取日期，只是不知道如何在弹出框被解除时获取该数据。

我正在尝试这个，`ViewController`但从未显示 NSLog 输出......

```
- (void) popoverControllerDidDismissPopover:(UIPopoverController *)popoverController {
    NSDate *selectedDate = ((DatePickerViewController *) popoverController.contentViewController).datePicker.date;
    NSCalendar * calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
    NSDateComponents *dateComponents = [calendar components:(NSYearCalendarUnit|NSMonthCalendarUnit|NSDayCalendarUnit) fromDate:selectedDate];
    int selectedYear = [dateComponents year];
    int selectedMonth = [dateComponents month];
    int selectedDay = [dateComponents day];

    self.dateLabel.text = [NSString stringWithFormat:@"%d/%d/%d",selectedMonth,selectedDay,selectedYear];

    NSLog(@"hello world"); // never shows up
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T00:09:21.800

我必须在 prepareForSegue 中设置 delegate=self：

```
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
if ([segue.identifier isEqualToString:@"toDatePicker"]) {
    UIStoryboardPopoverSegue *popoverSegue;
    popoverSegue = (UIStoryboardPopoverSegue *)segue;

    UIPopoverController *popoverController;
    popoverController = popoverSegue.popoverController;
    popoverController.delegate=self;
}
} 
```

# ruby-on-rails - activerecord-import gem NoMethodError：未定义的方法“导入”

> ID：12187813
> 
> 赞同：7
> 
> 时间：2012-08-29T23:18:48.190
> 
> 标签：ruby-on-rails, activerecord, activerecord-import

我正在尝试使用 activerecord-import gem，并且按照 wiki 上的说明进行操作，但我得到了`NoMethodError: undefined method 'import' for #<Class:0x8b009b0>`. 这是我的代码（与 wiki 中的示例基本相同）

```
 class ExampleCode
      def self.testing
        orders = []
        10.times do |i|
          orders << Order.new(:raw_data => "order #{i}")
        end

        Order.import orders

      end
    end 
```

我这样称呼该方法：

```
ExampleCode.testing 
```

我在 windows、linux、sqlite 数据库、mysql 数据库上尝试过，但仍然没有运气。而且我确定我已经安装了 gem：

```
actionmailer (3.2.6, 3.2.3, 3.2.1, 3.2.0)
actionpack (3.2.6, 3.2.3, 3.2.1, 3.2.0)
activemodel (3.2.6, 3.2.3, 3.2.1, 3.2.0)
activerecord (3.2.6, 3.2.3, 3.2.1, 3.2.0)
activerecord-import (0.2.10)
activerecord-oracle_enhanced-adapter (1.4.1)
activerecord-sqlserver-adapter (3.2.1).... 
```

我什至尝试使用 require （在安装 gem 时这不应该是必需的。我还没有在其他任何地方看到过这种情况，所以我担心我必须错过一些非常明显的东西

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T23:56:34.063

您必须导入 active_record 和 activerecord-import

IE

```
require active_record
require activerecord-import 
```

（如维基中所述）

原因是，除非您明确导入这些库，否则 ruby​​ 不会知道它。对于 rails 项目，rails 会为您导入 Gemfile 中提到的所有 gem。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-09T22:46:47.853

我遇到了同样的事情；事实证明，至少对我来说，我将 gem 包含在 gemfile 的测试块中。确保当您包含它时，它不仅限于 gem 文件中的一个应用程序环境。

# javascript - 如何在不指定高度的情况下仅将垂直滚动条添加到一个 div？

> ID：12187815
> 
> 赞同：1
> 
> 时间：2012-08-29T23:19:01.760
> 
> 标签：javascript, jquery, html, css

我**可以在需要时向 div 添加滚动条，但不**为 div 本身或该 div 必须位于的容器指定任何高度吗？

div 是页面上的最底部元素，我希望用户能够调整浏览器窗口的大小。因此，当动态添加到 div 的“数据”到达页面底部时，滚动条就会出现。

我的页面只包含一个表格，表格的第二行在代码下方。

```
<table border="0">
 <tr>
    <td><button type="button" onclick="$('#info').text('')" > clear info area </button></td>
 </tr>
 <tr class="tr_info">
    <td><div id='info'></div></td>  
 </tr>
</table> 
```

我尝试`overflow-y: scroll;`了 div，但它向整个窗口而不是 div 添加了滚动条。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:38:16.030

```
html, body { height: 100%; }
div { height: 100%; overflow: auto; } 
```

[http://jsfiddle.net/Wexcode/xMdPA/](http://jsfiddle.net/Wexcode/xMdPA/)

*少文本：http:* [//jsfiddle.net/Wexcode/xMdPA/1/](http://jsfiddle.net/Wexcode/xMdPA/1/)

您还可以让文本留在页面底部：http: [//jsfiddle.net/Wexcode/xMdPA/2/](http://jsfiddle.net/Wexcode/xMdPA/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T00:07:40.453

小提琴[http://jsfiddle.net/RSh9H/2/show/](http://jsfiddle.net/RSh9H/2/show/)

更正小提琴：http: [//jsfiddle.net/RSh9H/8/show/](http://jsfiddle.net/RSh9H/8/show/)

jQuery：

```
$(window).on('load resize',function(){
var heightOfWindow = $(window).height();
var totalHeightOfContents = $(document).height();
    if(heightOfWindow <= totalHeightOfContents){
        var heightExcludingInfo = $('table#main').height() - $('#info').height();
        var availableHeightForInfo = heightOfWindow - heightExcludingInfo;
        $('#info').height(availableHeightForInfo);
    }
    else{
        $('#info').css({height:'auto'});
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T23:39:20.830

关闭@zenkaty 的帖子，

在该元素的样式中， put `overflow-y:auto`，这样，当它有溢出时，它将显示一个滚动条，但如果没有，它将没有滚动条。

（与之相反`overflow-y:scroll`，它将*始终*显示滚动条。

**编辑：**

正如 Sabithpocker 指出的那样，如果您没有高度，据我所知，如果太多，表格将展开以显示所有文本。如果设置高度，*则*可以使用`overflow-y:auto`. 例如，请参阅[http://jsfiddle.net/rZV5u/](http://jsfiddle.net/rZV5u/)。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T23:28:48.987

只需将其放在您的 div 上 - 如果您将其添加到 body/html 中，那么整个窗口显然会滚动。

```
div {
  overflow-y: scroll;
} 
```

# android - OnTouchListener 防止地图移动

> ID：12187817
> 
> 赞同：2
> 
> 时间：2012-08-29T23:19:14.037
> 
> 标签：android, touch-event, ontouchlistener

我正在使用谷歌地图 API，并且我有一些代码试图在用户拖动地图后捕获地图中心的位置。

```
MapView mv = ...;

mv.setOnTouchListener(new OnTouchListener() {

    public boolean onTouch(View v, MotionEvent event) {
        if (event.getAction() == MotionEvent.ACTION_UP) {
            GeoPoint pt = mv.getMapCenter();
            //do something with the point
            return A;
        }
        return B;
    }
}); 
```

现在我的问题是返回值：

*   如果 B 为假，地图会被拖动，但我只看到`ACTION_DOWN`事件并且`ACTION_UP`从未触发 - 我理解
*   如果 B 为真，我收到`ACTION_UP`事件，但地图没有被拖动
*   似乎A是真还是假并没有区别

我想要的是接收`ACTION_UP`事件并拖动地图。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T00:23:38.217

这是一个解决方案：不使用默认 MapView，而是使用具有 GestureDetector 的自定义 MapView，基本上，这可以让您为地图创建自定义事件侦听器，帮助您避免拖拽等问题，此外还可以为您提供与默认的 MapView 相比，有大量的交互选项。几个月前，我遇到了类似的问题，所以我决定实施我刚才提到的解决方案。下面是名为 TapControlledMapView 的自定义 MapView 的代码，底部提供了自定义侦听器的接口代码：http: [//pastebin.com/kUrm9zFg](http://pastebin.com/kUrm9zFg)。

因此，要实现监听器，您需要做的就是在您的 mapactivity 类中使​​用以下代码（哦，如果您不知道这一点，您必须在 MapActivity 布局 XML 文件中声明以下内容，因为您使用的是自定义地图视图：

```
<?xml version="1.0" encoding="utf-8"?>
//The bottom line was the tricky business (You get ClassCastExceptions and whatnot)
<NAMEOFYOURPROJECT.TapControlledMapView (ex: com.android.googlemapsapp.TapControlledMapView)
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/mapview"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:clickable="true"
android:apiKey="API_KEY_HERE"
/> 
```

并在您的 MapActivity 类中使​​用以下代码。

```
mapView.setOnSingleTapListener(new OnSingleTapListener() {

@Override
 public boolean onSingleTap(MotionEvent arg1) {
 if(arg1.getAction() == MotionEvent.ACTION_UP)
 {
  GeoPoint pt = mv.getMapCenter();
  // do something with the point.
  return ***true***;
 }
return true;
}); 
```

让我知道事情的后续。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T21:03:01.747

按照@ViswaPatel 的想法，我创建了一个新的MapView 类，扩展了MapView，它重写了`onTouchEvent`方法并管理了自己的监听器：

```
public class CustomMapView extends MapView {

    private OnTouchListener lst;

    public CustomMapView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public CustomMapView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public CustomMapView(Context context, String apiKey) {
        super(context, apiKey);
    }

    public void setOnActionUpListener(OnTouchListener lst) {
        this.lst = lst;
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        super.onTouchEvent(event);
        if (lst != null && event.getAction() == MotionEvent.ACTION_UP) {
            lst.onTouch(this, event); // return value ignored
        }
        return true;
    }
} 
```

调用代码是：

```
 mv.setOnActionUpListener(new OnTouchListener() {

        public boolean onTouch(View v, MotionEvent event) {
            final GeoPoint pt = mv.getMapView().getMapCenter();
            //doing my stuff here
            return true; //ignored anyway
        }
    });
} 
```

# algorithm - 如何寻找 3+ 方式交易的机会（例如运动队的做法）

> ID：12187823
> 
> 赞同：7
> 
> 时间：2012-08-29T23:19:58.077
> 
> 标签：algorithm

我正在尝试拼凑一个算法（最好在 ruby​​ 中），它将分析数据库以寻找 3+ 方式交易的机会，就像棒球队通常如何做的那样。

例如：

想象一下有 100 支球队，每支球队有 20 名左右的球员。每个玩家都有一些可能的属性组合。（比如“跑得快”、“防守好”等）

每支球队都有球员**需求**（具有来自上述可能集合的特定属性）以及要**提供**的球员，（每个球员都具有与上述可能选项相匹配的属性）。

这种理论算法可以搜索所有需求和提议，以找到可以相互交易的团队组合。

在一个理论场景中，想象三个团队：

A队有一名速度快的球员，需要一名防守好的球员 F队有一名防守好的球员，需要一名投球好的球员 Q队有一名投球好的球员，需要一名速度好的球员

所以 A、F 和 Q 队可以进行三路交易，每个人都赢。

我的问题是关于可以识别这个机会的算法。这是以前用算法解决过的问题吗？如果是这样，我将不胜感激在哪里看的任何方向。我对如何巧妙地使用缓存和 cron 在数据库中构建它有一些不同的想法。在 Rails 中构建它。只是有点卡在机会寻找算法上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T00:06:45.797

您可以将您的需求和报价建模为图表：每个团队都是一个节点，并且`A`团队`B`之间的能力存在优势`x`iif可以从必须提供的玩家中`A`获利。您可以在 中构建此图表，其中是报价的数量， 是通过按属性对报价进行分类的需求数量。`x``B``O(o + n)``o``n`

现在，您需要在此图中找到一个满足您在问题中未说明的特定属性的循环（可能性是：长度> 3，最大长度，最大容量，...）。对于这些问题中的每一个，您都可以使用现有算法来解决它们（最大流量、最短路径、BFS 等）

# haskell - 如何通过FFI从包含数据类型的haskell导出函数

> ID：12187825
> 
> 赞同：5
> 
> 时间：2012-08-29T23:20:13.870
> 
> 标签：haskell, ffi

我能够通过包含标准数据类型的 FFI 导出简单的 haskell 函数。但是，我不知道如何导出采用标准数据类型以外的数据类型的函数。

例如

```
data SomeType a = SomeType a
data SomeOtherType b = SomeOtherType b

doSomething:: SomeType a -> SomeOtherType b 
```

如何导出函数 doSomething？

现有文件讨论了非常简单的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T15:59:03.583

另一种方法是解除函数以使用StablePtr，并使用StablePtr 导出函数。当然，正如上述答案中所指出的，您已经使用了带有导出实例的函数。

使用 H/Direct 之类的东西将这段代码插入到 c++ 对象中，这样它就可以作为对象进行访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T10:03:57.223

简短的回答是，[你不能](http://www.cse.unsw.edu.au/~chak/haskell/ffi/ffi/ffise3.html#x6-140003.4)。

您需要选择该函数的一个实例并将其导出。

例如`doSomething :: SomeType Int -> SomeOtherType Int`是可出口的。[我在这里](https://stackoverflow.com/questions/6562378/using-higher-order-haskell-types-in-c-sharp/6839159#6839159)写了一个更长的答案，可能会有所帮助

原因是 Haskell 端需要知道如何编组结构、分配多少内存等。

# android-camera - 报告的垂直/水平相机视角与支持的图片尺寸不一致。哪个在显示时被剪裁或填充？

> ID：12187827
> 
> 赞同：0
> 
> 时间：2012-08-29T23:20:27.127
> 
> 标签：android-camera

报告的垂直/水平相机视角与支持的图片尺寸不一致。大概这种差异是通过在`onPicture()`回调中返回图像之前填充/剪辑来解决的。它是如何解决的？我想通过处理图片来正确测量角度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T23:49:22.210

Actually, the angles of view are consistent with some of the supported picture sizes. In the case of an Samsung Captivate, the angles are reported as 51.2 x 39.4\. Taking the ratio of the tangents of these angles divided by 2, you get 1.338\. This agrees closely enough with the 640x480, 1600x1200, 2048x1536, and 2560x1920 aspect ratios: 1.333... Additionally, the angles do not change either when you change the picture size, or the zoom, so they are describing the hardware, specifically a relationship between lens and sensor.

So my question only applies to the other picture sizes, having an aspect ratio of 1.66....

# android - TitlePageIndicator：标题文本未出现或隐藏在活动布局顶部。（Viewpager，Xml）

> ID：12187833
> 
> 赞同：0
> 
> 时间：2012-08-29T23:21:11.123
> 
> 标签：android, android-layout, android-viewpager, android-xml, viewpagerindicator

**ViewPagerFragment.java**

```
package nsixty.crew.app;

import java.util.List;
import java.util.Vector;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentPagerAdapter;
import android.support.v4.view.ViewPager;

import com.viewpagerindicator.TitlePageIndicator;
import com.viewpagerindicator.TitleProvider;

public class ViewPagerFragment extends FragmentActivity {

    private CustomFragmentAdapter mPagerAdapter;

    ViewPager pager;
    TitlePageIndicator titleIndicator;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        super.setContentView(R.layout.lcmeter);

        this.initialisePaging();

    }

    private void initialisePaging() {

        List<Fragment> fragments = new Vector<Fragment>();

        fragments
                .add(Fragment.instantiate(this, LoginActivity.class.getName()));
        fragments.add(Fragment.instantiate(this, main.class.getName()));
        this.mPagerAdapter = new CustomFragmentAdapter(
                super.getSupportFragmentManager(), fragments);
        pager = (ViewPager) findViewById(R.id.viewpager);
        pager.setAdapter(this.mPagerAdapter);
        titleIndicator = (TitlePageIndicator) findViewById(R.id.titles);
        titleIndicator.setViewPager(pager);

    }

    public static class CustomFragmentAdapter extends FragmentPagerAdapter
            implements TitleProvider {
        public static final int POSITION_PAGE_1 = 0;
        public static final int POSITION_PAGE_2 = 1;
        public static final int POSITION_PAGE_3 = 2;
        private List<Fragment> fragments;
        private static final String[] TITLES = new String[] { "LOGIN", "HOME" };

        public static final int NUM_TITLES = TITLES.length;

        @Override
        public String getTitle(int position) {
            return TITLES[position];
        }

        public CustomFragmentAdapter(FragmentManager fm,
                List<Fragment> fragments) {
            super(fm);
            this.fragments = fragments;
        }

        @Override
        public int getCount() {
            // return this.fragments.size();
            return NUM_TITLES;
        }

        @Override
        public Fragment getItem(int position) {

            try {
                LoginActivity.class.newInstance();
            } catch (InstantiationException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IllegalAccessException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            return this.fragments.get(position);

        }

    }

} 
```

**lcmeter.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <com.viewpagerindicator.TitlePageIndicator
        android:id="@+android:id/titles"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />

    <android.support.v4.view.ViewPager
        android:id="@+android:id/viewpager"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight="1" />

</LinearLayout> 
```

**AndroidManifest.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="nsixty.crew.app"
    android:versionCode="1"
    android:versionName="1.0" >

    <support-screens
        android:largeScreens="true"
        android:normalScreens="true"
        android:smallScreens="false" />

    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

    <application
        android:icon="@drawable/icon87"
        android:label="@string/app_name" >
        <activity
            android:name="ViewPagerFragment"
            android:theme="@android:style/Theme.Black.NoTitleBar" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name=".main" >
            <intent-filter>
                <action android:name="nsixty.crew.app.main" />

                <category
                    android:name="android.intent.category.DEFAULT"
                    android:screenOrientation="portrait" />
            </intent-filter>
        </activity>
        <activity
            android:name=".play"
            android:label="@string/app_name"
            android:theme="@android:style/Theme.NoTitleBar.Fullscreen" >
            <intent-filter>
                <action android:name="nsixty.crew.app.play" />

                <category
                    android:name="android.intent.category.DEFAULT"
                    android:screenOrientation="landscape" />
            </intent-filter>
        </activity>
        <activity
            android:name=".secondView"
            android:label="@string/app_name"
            android:screenOrientation="landscape" >
            <intent-filter>
                <action android:name="nsixty.crew.app.SECONDVIEW" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name=".recorder"
            android:configChanges="orientation"
            android:label="@string/app_name"
            android:theme="@android:style/Theme.NoTitleBar.Fullscreen" >
            <intent-filter>
                <action android:name="nsixty.crew.app.RECORD" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name=".send"
            android:label="@string/app_name" >

            <!-- android:theme="@android:style/Theme.Dialog" -->
            <intent-filter>
                <action android:name="nsixty.crew.app.SHARE" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name=".gallery"
            android:theme="@android:style/Theme.Dialog" >
            <intent-filter>
                <action android:name="nsixty.crew.app.gallery" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name=".RegisterActivity"
            android:theme="@android:style/Theme.Dialog" >
        </activity>
        <activity
            android:name=".media"
            android:theme="@android:style/Theme.Dialog" >
            <intent-filter>
                <action android:name="nsixty.crew.app.media" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity android:name=".LoginActivity" >
        </activity>
        <activity android:name="CustomTitleBar" >
        </activity>
    </application>

    <uses-sdk android:minSdkVersion="8" />

    <uses-permission android:name="android.permission.WRITE_SETTINGS" >
    </uses-permission>
    <uses-permission android:name="android.permission.CAMERA" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.RECORD_AUDIO" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.READ_CONTACTS" />

    <uses-feature android:name="android.hardware.camera" />

</manifest> 
```

**截图1** ![登录活动活动](../Images/df7e20967e93d6d1e2b423042b9ebb3a.png)

**截图2** ![滑动到主要活动](../Images/d1b0bb9c66a7c7e31ec957c12f886058.png)

请帮我解决这些小问题，我只是不知道问题出在哪里，我已经为此工作了几个小时。我认为问题将来自 Xml 布局谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T04:25:09.180

试试这样：

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.viewpager);

    // Create our custom adapter to supply pages to the viewpager.
    mPagerAdapter = new Pager_Adapter(this,getSupportFragmentManager());
    mViewPager = (ViewPager)findViewById(R.id.pager);
    mViewPager.setAdapter(mPagerAdapter);

    // Start at a custom position
    mViewPager.setCurrentItem(0);

     // Find the indicator from the layout
    mTabs = (TitleIndicator) findViewById(R.id.swipeytabs);
    mTabs.setAdapter(mPagerAdapter);

    // Set the indicator as the pageChangeListener
    mViewPager.setOnPageChangeListener(mTabs);

}

class Pager_Adapter extends FragmentPagerAdapter implements ViewpagerAdapter{

    private final Context mContext;

    public Pager_Adapter(Context context, FragmentManager fm) {
        super(fm);

        this.mContext = context;
    }

    @Override
    public Fragment getItem(int pos) {

        return ItemFragment.newInstance(QUES[pos],listArray[pos]);
        //return ItemFragment.newInstance(QUES[pos % TITLES.length]);

    }

    @Override
    public int getCount() {
        return TITLES.length;
    }

    public TextView getTab(final int position, TitleIndicator root) {
        TextView view = (TextView) LayoutInflater.from(mContext).inflate(
                R.layout.swipey_tab_indicator, root, false);

                             //  swipey_tab_indicator is the your titleBar Layout ,
                              //  You can use only textview on that layout for the titlebar
        view.setText(TITLES[position]);
        view.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                mViewPager.setCurrentItem(position);

            }
        });
        return view;
    }

} 
```

有关更多信息，请查看此 [链接](https://github.com/JakeWharton/Android-ViewPagerIndicator/tree/master/sample/src/com/viewpagerindicator/sample)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T17:06:54.220

我使用了这个库[查看寻呼机扩展](https://github.com/astuetz/ViewPagerExtensions)，其中我使用了滑动标签视图指示器而不是标题页面指示器，它工作得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T18:06:50.043

嗯，看起来此文本的默认选择颜色是黑色，而您的背景是，因此您应该在 android XML 文件中将其更改为另一种颜色。

# powershell - .ps1 脚本中的 PowerShell tee 对象？

> ID：12187834
> 
> 赞同：2
> 
> 时间：2012-08-29T23:21:11.560
> 
> 标签：powershell

我目前有一个执行如下的脚本： .\script.ps1 “param1” “param2” 2>&1 | tee -filePath buildlog.txt

我找不到执行以下操作的方法.. 记录到脚本中封装的控制台和文件。.\script.ps1 “param1” “param2”</p>

这是我的尝试：

# powershelltest.ps1

```
param([string]$paramOne, [string]$paramTwo)

function DoWork()
{
 Write-Host '3'
}

function WriteLogFile()
{
    DoWork
 # The following would not be captured by Start-Transcript & Stop-Transcript
 # program.exe ....
 Write-Host '4'
}

function CollectorFunction()
{
    Write-Host '2'
 WriteLogFile;
    Write-Host '5'
}

Write-Host '1'
CollectorFunction 2>&1 | tee -filePath c:\log.foo 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T02:07:41.510

如果要写入日志文件，请不要使用`Write-Host`. 使用`Write-Output`或根本不使用`Write-*`，因为`Write-Output`是默认设置，例如：

```
Write-Output 'hello' > foo.txt 
```

相当于：

```
'hello' > foo.txt 
```

`Write-Output`将输出发送到标准输出流（即 1）。用于`Write-Error`将输出发送到错误流（即 2）。这两个流可以被重定向。 `Write-Host`或多或少地直接写入主机 UI，完全绕过输出流。

在 PowerShell V3 中，您还可以重定向以下流：

```
The Windows PowerShell redirection operators use the following characters
to represent each output type:
  *   All output
  1   Success output
  2   Errors
  3   Warning messages
  4   Verbose output
  5   Debug messages 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T01:27:56.597

我会用`Start-Transcript`. 唯一需要注意的是，它不捕获标准输出，只捕获来自`Write-Host`. 因此，您只需将旧命令行应用程序的输出通过管道传输到`Write-Host`：

```
Start-Transcript -Path C:\logs\mylog.log
program.exe | Write-Host 
```

# django - 我想在 django 中使用文本样式的标签，但我不想被 XSSed

> ID：12187842
> 
> 赞同：1
> 
> 时间：2012-08-29T23:21:54.867
> 
> 标签：django, xss

在我正在工作的网站上，用户可能会互相发送消息。我希望用户能够使用诸如 < b > 、 < i > 和 < u > 之类的文本样式标签来分别使文本变为粗体、斜体和下划线。但是，事实上，我不想被那些 <script> 标签所影响。或者可能是带有 mouseover 属性的 < b >。

最简单、最安全的方法是什么？

如果这很重要，我正在使用 django 和 jQuery。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T01:55:08.357

不允许标签。[而是使用Django 支持的](https://docs.djangoproject.com/en/dev/ref/contrib/markup/)一种标记语言，它一开始就不允许 XSS 攻击。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T14:29:15.390

如果你真的想使用 HTML 标签，你应该考虑使用[Bleach](http://pypi.python.org/pypi/bleach)。

```
>>> evil = "This <script>...</script> is partly <b>evil</b>"
>>> bleach.clean(evil)
u'This &lt;script&gt;...&lt;/script&gt; is partly <b>evil</b>' 
```

您可以明确地将`clean`您想要允许的标签列入白名单。通过使用`strip`，您还可以去除不允许的标签而不是转义它们：

```
>>> evil = "This uses <i>i</i> and <b title='hovertext'>b</b> and <em>em</em>"
>>> bleach.clean(evil, tags=["b"], attributes=dict(), strip=True)
u'This uses i and <b>b</b> and em' 
```

# javascript - 为什么当我单击 X 时所有项目都从我的 Backbone.js 视图中删除

> ID：12187843
> 
> 赞同：0
> 
> 时间：2012-08-29T23:22:17.083
> 
> 标签：javascript, dom, backbone.js

js。我想知道为什么当我单击专辑和艺术家旁边的 X 时，我的主干.js 会删除这两个项目。

IE

```
The Chronic-- Dr. Dre-- X
Ten-- Pearl Jam-- X 
```

我很感激我能得到的任何反馈，这将允许我只删除一个项目，而不是两个

Java脚本：

```
(function($){

Backbone.sync = function(method, model, success, error){ 
    success();
}

//Declare model 
var Album = Backbone.Model.extend({
defaults: {
    album: 'Logical Progresions vol. 1',
    artist:'LTJ Bukem'
    }
});

//Declare collection
var eList = Backbone.Collection.extend({
    model: Album
});

//Declare the view for the Albums
var AlbumView = Backbone.View.extend({
    el: $('div#main'),
    template: _.template(
            "<div class=\"alert\"> " +  
            "   <span class=\"album\"><%= album %>--</span> " +
            "   <span claas=\"artist\"><%= artist %>--</span> " +
            "   <span class =\"delete\">X</span> " +
            "</div>"
            ),

    events: { 
        'click span.delete':  'deleteAlbum'
    },  

    initialize: function(){
        _.bindAll(this, 'render','unrender','deleteAlbum');
        this.model.bind('remove', this.unrender);
    },

    // `unrender()`: Makes Model remove itself from the DOM.
    unrender: function(){
        this.$el.remove();
    },

    deleteAlbum: function(){
        this.model.destroy();
    },

    render: function(){
        $(this.el).append(this.template(this.model.toJSON()));
    }
});

var appendItem = function(item){
    var albumView = new AlbumView({
        model: item
        });
     albumView.render();
}

//// set the stuff in motion
var elist = new eList();

elist.bind("add",function(listItem){appendItem(listItem)});

elist.add({
    album: 'The Chronic',
    artist: 'Dr. Dre'
    });

elist.add({
    album: 'Ten',
    artist: 'Pearl Jam'
    });

})(jQuery); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T00:41:32.130

有几点我可以指出。

首先，您的视图 - 当您为每个相册创建多个实例时 - 每个实例共享相同的 el。也就是说，div#main。每次添加一个时，您都会将模板内容附加到 el 中，这就是您仍然看到另一个的原因。但是当您单击 .delete 并执行 this.$el.remove() 时，您将删除 el 中的所有内容。其中包括另一种观点。

你应该把它分开，每个视图都应该有它自己独特的 el。

```
el: 'div',
className: 'albumView' 
```

添加每个专辑视图时，您可以创建视图并将其附加到您的 div#main

```
var view = new AlbumView();
$('#main').append(view.render().el);  // the el refers to the subview (albumView) el. 
```

这应该让每个视图都对自己的 el 感到满意，并且删除只会影响该视图/模型/DOM 元素。

**更新 - 的上下文`$('#main').append(view.render().el);`**

基本上，当您创建专辑视图并附加它们时，最理想的位置是在您的 div#main 存在的更大上下文中。例如，这可能发生在标题中的主 js 脚本中，或者甚至可能发生在包含许多专辑视图子视图的更大视图中。为了说明子视图上下文：

```
var ParentView = Backbone.View.extend({
    el: $('#main'),
    render: function() {
        this.addAllAlbums();  // On rendering the parent view, we add each album subview
        return this;
    },
    addAllAlbums: function() {
        var self = this;

        // This loops through the collection and makes a view for each album model
        this.collection.each(function(albumModel) {
            self.addAlbumView(albumModel);
        });
    },
    addAlbumView: function(albumModel) {
        var view = new AlbumView({
            'model': albumModel
        });

        // We are adding/appending each albumView to this view's el
        this.$el.append(view.render().el);

        // ABOVE: `this.$el` refers to ParentView el. view.render().el refers to the
        // albumView or subview el.

        // As explained before, now each album view has it's own el which exists in
        // the parent view's this.el = `$('#main')`
    }
});

// We create the parent BIG/ALLAlbumsView and toss into it the collection of albums
var BigAlbumsView = new ParentView({
    'collection': albumsCollection
});

BigAlbumsView.render();  // Run the `render()` to generate all your album subviews 
```

您可能还希望通过在父视图的代码中添加这些行来存储对这些子视图的引用。如果您打算通过子视图本身清理单个视图，这将使清理变得更容易，尽管这没什么大不了的。

```
// In your initialization, we create an array to store album subviews
this.albumViews = [];

// In `addAlbumView()` we push each view into the array so we have a reference
this.albumViews.push(view);

// When cleaning up, you just simply cycle through the subviews[] and remove/close
// each album subview
_.each(this.albumViews, function(albumView) {
    albumView.$el.remove();
}); 
```

希望这可以帮助。

PS - 我注意到的最后一点。当您删除视图时，我注意到您使用`remove()`which 将其从 DOM 中取出。如果您正在制作更复杂的子视图与集合、模型和其他视图的事件侦听器交织/纠缠 - 您可能想阅读 Derick Bailey 对 Zombie 视图的看法并实现一种`close()`方法，该方法将`remove()`与`unbind()`您的视图相结合，因此没有参考它可以被垃圾收集。不是这个问题的重点，但有利于获得额外的荣誉并且可能相关，因为这可能会使您的代码更加复杂。:-P

[删除视图 - 避免僵尸](http://lostechies.com/derickbailey/2011/09/15/zombies-run-managing-page-transitions-in-backbone-apps/)

# html - 在新选项卡中打开链接（在框架设置内）

> ID：12187846
> 
> 赞同：2
> 
> 时间：2012-08-29T23:23:09.080
> 
> 标签：html

我是 html 新手，正在尝试使用框架设计一个基本网站（我很欣赏这是一种旧的做事方法，但它易于导航和简单，我可以应付！）要做到这一点，我使用以下代码：

```
<FRAMESET frameborder=0, border=1, rows="90,*">
    <FRAME name="top", src="banner.html">
    <FRAMESET rows="*" cols="20%,80%">
        <FRAME name="side", src="sidemenu.html">
    <FRAME name="main", src="welcome.html">
    </FRAMESET>
</FRAMESET><noframes></noframes> 
```

然后在带有导航链接的侧面菜单中，我已经说出了最新消息的链接：

```
<a href="news.html" target="main">News</a> 
```

这工作正常。但是，如果用户尝试在新选项卡中打开新闻链接，他们只会得到 news.html 页面。有没有办法让他们尝试在新选项卡中打开此链接时，它会打开一个新选项卡，其中包含主框架中的横幅、侧面菜单和新闻页面？

我希望这是有道理的，并感谢您的帮助。

# sql - 如何创建包含用户接触或负责的所有工单的 Trac 报告？

> ID：12187847
> 
> 赞同：1
> 
> 时间：2012-08-29T23:23:09.500
> 
> 标签：sql, report, trac

有许多创建[TracReports](http://trac.edgewall.org/wiki/TracReports)的示例。[这](http://groups.google.com/group/trac-users/t/acefc2830b78df49)仍然是一个棘手的问题，没有包含在任何现有的食谱中，我知道：

> ... 设计一个报告以显示用户是所有者、记者的所有工单，或他们尚未创建但他们留下评论的工单。这是最后一部分，这是棘手的。

任何指针，将有效性视为额外的奖励？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:26:51.760

这是我自己的第一个工作解决方案：

**“（当前）用户是所有者或记者或（之一）评论作者”**

```
SELECT
  p.value AS __color__,
  t.milestone AS __group__,
  id AS ticket, t.type AS type,
  reporter, t.time as created,
  owner, changetime AS modified,
  author as commenter, tcg.time as date
FROM ticket t
LEFT JOIN enum p ON p.name = t.priority AND p.type = 'priority'
LEFT JOIN ticket_change tcg ON t.id = tcg.ticket
WHERE owner = $USER OR reporter = $USER
GROUP BY id

UNION

SELECT
  p.value AS __color__,
  t.milestone AS __group__,
  id AS ticket, t.type AS type,
  reporter, t.time as created,
  owner, changetime AS modified,
  author as commenter, tcg.time as date
FROM ticket t
LEFT JOIN enum p ON p.name = t.priority AND p.type = 'priority'
LEFT JOIN ticket_change tcg ON t.id = tcg.ticket
WHERE author = $USER
  AND id NOT IN (
  SELECT id
  FROM ticket
  WHERE owner = $USER OR reporter = $USER
)
GROUP BY id
ORDER BY t.milestone, p.value, t.type, t.time 
```

我绝不是 SQL 专家，所以可能有一个更有效的解决方案，但这个解决方案至少可以显示评论的票证，而且每张票证不超过一次。

# django - 自定义 sorl 缩略图处理器

> ID：12187848
> 
> 赞同：0
> 
> 时间：2012-08-29T23:23:31.910
> 
> 标签：django, sorl-thumbnail

我发现了一个与 sorl-thumbnail 相关的问题（和一个答案），这看起来与我正在寻找的内容相关： [使用新的 sorl-thumbnail 进行图像过滤](https://stackoverflow.com/questions/6151468/image-filtering-with-the-new-sorl-thumbnail)。但是我的 django 知识太弱了，无法理解我能用它做什么。

我想扩展 sorll-thumbnail 以便我可以在提供图像之前对其进行处理。例如：添加模糊效果。我可以处理图像处理部分（已经用 php/imagemagick 做过这样的事情），但我不知道从哪里开始在 sorl-thumbnail 上方插入我自己的函数。

在我的项目中，我使用 pip 安装了 lib。在我的代码中，我可以在哪里创建一个类/子类，以便我可以将参数传递给模板标签？这门课应该是什么样子的？

提到的帖子中描述的 RoundedCornerEngine 类是否可以？我应该在哪里获得此代码？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T13:18:55.357

任何地方……好的……唯一的细节是从设置中正确链接新引擎：

```
THUMBNAIL_ENGINE = "my.module.MyEngine" 
```

如果有人正在寻找在 sorl-thumbnail 之上使用 PIL 构建的定制处理器，这里有两个示例：[https](https://gist.github.com/1647660) ://gist.github.com/1647660和[https://gist.github.com/1920535](https://gist.github.com/1920535)。

# asp.net-mvc - 如何在 MVC 中访问查询字符串

> ID：12187849
> 
> 赞同：0
> 
> 时间：2012-08-29T23:23:32.760
> 
> 标签：asp.net-mvc

我正在使用以下方法取回查询字符串：

```
public ActionResult Index(int id)
{
  var queryString = Request["myQueryString"];
} 
```

然后我看了看：

[帮助测试-mvc3-controller-that-accesses-querystring](https://stackoverflow.com/questions/5751490/help-testing-mvc3-controller-that-accesses-querystring)

其中指出：

直接使用 HttpRequest 是违反 MVC 的设计模式的。您可以将操作上的查询字符串变量作为参数访问。

我真的不明白这一点。我所做的是否违反了设计模式？如果是，为什么会这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:24:55.903

它打破了模型绑定的概念。单元测试和尝试新的测试也变得复杂`HttpContext`。如果它只是一个参数，你可以只传递值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T03:29:22.500

首选（且更易于阅读）的方法是：

```
public ActionResult Index(int id, string myQueryString)
{
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T23:26:54.053

您的操作方法应该采用从您的表单提交的大部分数据。MVC 的优势之一是它在其中的模型绑定。看看这个页面，因为它有一个很好的例子：

[http://www.codeproject.com/Articles/159749/ASP-NET-MVC-Model-Binding-Part1](http://www.codeproject.com/Articles/159749/ASP-NET-MVC-Model-Binding-Part1)

您可以在操作方法中接受文字（字符串、布尔值等）但也可以接受强类型对象。

# php - 通过电子邮件（PHP）向自己发送 get_defined_vars()

> ID：12187850
> 
> 赞同：0
> 
> 时间：2012-08-29T23:23:34.960
> 
> 标签：php, email

在开发过程中，当其他人在尝试我的网站并遇到问题时，我希望能够找出我的代码出现问题的地方，get_defined_vars() 可能对我了解此时发生的事情最有用。

我已经准备好编写这个函数了，但是它正在返回：

> 解析错误：语法错误，意外的 '='

有人知道从 php 向自己发送 get_defined_vars() 的方法吗？

```
if(isset($_GET['sendmeanemail'])){
$emailarr = get_defined_vars();
$to      = 'myemail@gmail.com';
$subject = 'Debug Report for'. $currentApiUser['first-name']. ' '. $currentApiUser['last-name'];
$message = '<pre>\n';

$message. = print_r(addslashes($emailarr));
$message. = '</pre>';
$headers = 'From: webmaster@domain.com' . "\r\n" .
    'Reply-To: webmaster@domain.com' . "\r\n" .
    'X-Mailer: PHP/' . phpversion();

    mail($to, $subject, $message, $headers);
} 
```

编辑：通过更改为：（实际上不需要预先标记，我正在研究如何更好地为 gmail 设置格式）

```
if(isset($_GET['sendmeanemail'])){
$emailarr = get_defined_vars();
$to      = 'myemail@gmail.com';
$subject = 'Debug Report for'. $currentApiUser['first-name']. ' '. $currentApiUser['last-name'];
$message = '<pre>';

$message .= print_r($emailarr, true);
$message .= '</pre>';
$headers = 'From: webmaster@domain.com' . "\r\n" .
    'Reply-To: webmaster@domain.com' . "\r\n" .
    'X-Mailer: PHP/' . phpversion();

    mail($to, $subject, $message, $headers);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:25:29.027

您需要调用 print_r 并将第二个参数设置为 true。此外，不应在数组上调用 addlashes。它应该看起来像：

```
print_r($emailarr,true); 
```

最后，您需要移动 . （句点）在等号旁边。您的代码应如下所示：

```
$message = '<pre>\n';
$message .= print_r($emailarr,true);
$message .= '</pre>'; 
```

# javascript - Javascript JSON对象替换对象内的字符串

> ID：12187851
> 
> 赞同：0
> 
> 时间：2012-08-29T23:23:35.553
> 
> 标签：javascript, jquery, regex, string, replace

好的，我将一个大型多维 JSON 对象倒入我的应用程序中，其中一个对象是 html 字符串，用于创建链接。现在我无法更改此对象的输出以将我想要的内容替换为我需要的内容，因为这个对象在几个不同的应用程序中被用于几个地方。到目前为止，其中工作正常。

我需要做的是在 JSON 对象中替换一小部分这个 html 字符串来改变它，使它适合这个新应用程序的需要。

对象内的 HTML 看起来像（直接取自“响应选项卡”下的萤火虫控制台，减去整个对象数据）

```
<a href='\/ng\/other\/?object_id=6bfb00fb-2b76'>Some Text<\/a> 
```

我需要做的是将该字符串中的“ng”和“other”完全替换为其他内容。我已经尝试过了。

```
var swapVal1 = data.rows[index1].vals[1].replace(\/ng\/other\/,"/new/placement/"); 
```

但是我得到 SyntaxError: 非法字符第 31 行及其指向替换函数的第一部分。那么，为了暂时正确处理这个问题，我需要做什么，直到可以在后端重写其他东西作为这个问题的更好替代方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T23:26:02.490

您的正则表达式格式错误。尝试这个：

```
var swapVal1 = data.rows[index1].vals[1].replace(/\\\/ng\\\/other\\\//, "/new/placement/"); 
```

正则表达式文字以字符为界`/`。反斜杠字符 ,`\`用于转义正则表达式元字符，因此需要转义为`\\`. 由于该`/`字符用于表示正则表达式文字的开始和结束，因此还需要将其转义为`\/`. 因此，您可以将正则表达式分解为：

```
/     -> start of regex
\\    -> the first \
\/    -> the next /
ng    -> the string "ng"
\\    -> the next \
\/    -> the / after that
other -> the string "other"
\\    -> the next \
\/    -> the / after that
/     -> end of the regex 
```

# javascript - Extjs 4在父窗口关闭时保存checkboxGroup的状态

> ID：12187856
> 
> 赞同：1
> 
> 时间：2012-08-29T23:24:01.007
> 
> 标签：javascript, extjs4, javascript-framework

我有一个带有 checkboxGroup 的窗口。我希望在按下窗口上的“应用”按钮时保存在 checkboxGroup 中所做的任何选择。到目前为止我有

```
 xtype: 'checkboxgroup',
                    stateful: true,
                    stateID: 'checks',
                    getState: function() {
                            return {
                                    items: this.items
                            };
                    },
                    stateEvents: ['close'],
                    columns: 2,
                    vertical: false,
                    items: [...] 
```

我很确定我的 stateEvents 是错误的，我会用什么来表明我希望在父窗口关闭时保存状态？

在我创建顶部视口之前，我的 app.js 文件的启动函数中有这一行

```
 Ext.state.Manager.setProvider(Ext.create('Ext.state.CookieProvider')); 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T19:08:41.037

显然复选框组的状态不包括复选框[http://docs.sencha.com/ext-js/4-0/#!/api/Ext.form.CheckboxGroup-method-getState的值](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.form.CheckboxGroup-method-getState)

我必须通过会话变量和父窗口事件..

```
var configPopup;
var configForm = Ext.create('Ext.form.Panel', {
    id: 'form-config',
    name: 'form-config',
    frame: true,
    layout: 'anchor',
    items: [
      {
        border:0,
        anchor: "100%",
        xtype: 'checkboxgroup',
        fieldLabel: 'Include options',
        labelWidth: 100,
        id: 'opt_relation',
        labelStyle: 'margin-left:10px;',
        items: [
          {         
        boxLabel: 'relation 1',
        name: 'opt_relation',
        inputValue: 'rel1',
        checked: true
      },
      {
        boxLabel: 'relation 2',
        name: 'opt_relation',
        inputValue: 'rel2',
        checked: true
      },
      {
        boxLabel: 'relation 3',
        name: 'opt_relation',
        inputValue: 'rel3',
        checked: true
       }
     ]
   }        
    ],
buttons: [
      {
      text: 'Close',
    handler: function() {
      configPopup.hide();
    }

  }]
});

configPopup = new Ext.Window({
  id:'configPopup',
  title: 'Chart configuration',
  layout      : 'fit',
  width       : 390,
  closeAction :'hide',
  plain       : true,
  listeners: {
    show: function() { 
      var v = Ext.state.Manager.get("optRelation");
      if (v) {        
        Ext.getCmp('opt_relation').setValue(v);
      } 
    },
    hide: function() { 
      var v = Ext.getCmp('opt_relation').getValue();      
      Ext.state.Manager.set("optRelation",v); 
    }
  },
  items : [ 
    configForm
  ]
}); 
```

# php - PHP Overlay PNG over JPG 然后调整 JPG 的大小并将其定位为 PNG 的掩码

> ID：12187857
> 
> 赞同：-1
> 
> 时间：2012-08-29T23:24:04.490
> 
> 标签：php, image, gd

我需要拍摄背景和头盔的PNG，头盔中间是透明的。在 PHP 中，我将传递它的顶部和左侧坐标，以及 JPG 的宽度和高度。我想把JPG放在PNG下面，把它变成我发送它的大小（根据我给它的大小调整大小），把它放在PNG下面的X和Y处，把PNG放在最前面. 换句话说，JPG 的任何部分在 PNG 边框之外都会被剪掉，生成的图像是以 PNG 的宽度和高度覆盖在 JPG 上的 PNG。

这是我目前拥有的，但它只是将头盔保存在头部应该在的黑色背景中。

```
$photo1 = imagecreatefromjpeg($_POST['photo']);
    $foto1W = imagesx($photo1);
    $foto1H = imagesy($photo1);
    $photoFrameW = $res['width'];
    $photoFrameH = $res['height'];
    $photoFrame = imagecreatetruecolor($photoFrameW,$photoFrameH);
    imagecopyresampled($photoFrame, $photo1, 0, 0, 0, 0, $photoFrameW, $photoFrameH, $foto1W, $foto1H);

    $photo2 = imagecreatefrompng('images/casco.png');
    $foto2W = imagesx($photo2);
    $foto2H = imagesy($photo2);
    $photoFrame2W = '500';
    $photoFrame2H = '556';

    $photoFrame2    = imagecreatetruecolor($photoFrame2W,$photoFrame2H);
    $trans_colour   = imagecolorallocatealpha($photoFrame2, 0, 0, 0, 127);
    imagefill($photoFrame2, 0, 0, $trans_colour);

    imagecopyresampled($photoFrame2, $photo2, 0, 0, 0, 0, $photoFrame2W, $photoFrame2H, $foto2W, $foto2H);

    imagecopy($photoFrame2, $photoFrame, $res['left']+556, $res['top'], 0, 0, imagesx($photoFrame), imagesy($photoFrame));

    imagejpeg($photoFrame2, "fb_images/$codigo2.jpg"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T19:14:51.247

以上述内容为起点，我自己想出来了。问题是双重的，它把错误的图像放在了顶部，我没有使用正确的位置来重新定位图像。我最终在插入之前重新调整大小和重新定位图像。然后在最后插入 JPG 顶部的 PNG。

```
 $photo1 = imagecreatefromjpeg($_POST['photo']);
    $foto1W = imagesx($photo1);
    $foto1H = imagesy($photo1);
    $photoFrameW = $res['width'];
    $photoFrameH = $res['height'];
    $photoFrame = imagecreatetruecolor(500,556);
    imagecopyresampled($photoFrame, $photo1, $res['left'], $res['top']+556, 0, 0, $photoFrameW, $photoFrameH, $foto1W, $foto1H);

    $photo2 = imagecreatefrompng('images/casco.png');
    $foto2W = imagesx($photo2);
    $foto2H = imagesy($photo2);
    $photoFrame2W = '500';
    $photoFrame2H = '556';

    $photoFrame2    = imagecreatetruecolor($photoFrame2W,$photoFrame2H);
    $trans_colour   = imagecolorallocatealpha($photoFrame2, 0, 0, 0, 127);
    imagefill($photoFrame2, 0, 0, $trans_colour);

    imagecopyresampled($photoFrame2, $photo2, 0, 0, 0, 0, $photoFrame2W, $photoFrame2H, $foto2W, $foto2H);

    imagecopy($photoFrame, $photoFrame2, 0, 0, 0, 0, imagesx($photoFrame2), imagesy($photoFrame2));

    imagejpeg($photoFrame, "fb_images/$codigo2.jpg"); 
```

# linux - 如果 bash 中已经存在文件名，则创建新文件但添加数字

> ID：12187859
> 
> 赞同：38
> 
> 时间：2012-08-29T23:24:09.343
> 
> 标签：linux, bash, filenames

我发现了类似的问题，但在 Linux/Bash 中没有

我希望我的脚本创建一个具有给定名称的文件（通过用户输入），但如果文件名已经存在，则在末尾添加数字。

例子：

```
$ create somefile
Created "somefile.ext"
$ create somefile
Created "somefile-2.ext" 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-29T23:33:44.327

以下脚本可以帮助您。您不应该同时运行多个脚本副本以避免竞争条件。

```
name=somefile
if [[ -e $name.ext || -L $name.ext ]] ; then
    i=0
    while [[ -e $name-$i.ext || -L $name-$i.ext ]] ; do
        let i++
    done
    name=$name-$i
fi
touch -- "$name".ext 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-04-05T11:33:00.260

更轻松：

```
touch file`ls file* | wc -l`.ext 
```

你会得到：

```
$ ls file*
file0.ext  file1.ext  file2.ext  file3.ext  file4.ext  file5.ext  file6.ext 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-08-30T10:05:47.207

~~为了避免竞争条件~~：

```
name=some-file

n=
set -o noclobber
until
  file=$name${n:+-$n}.ext
  { command exec 3> "$file"; } 2> /dev/null
do
  ((n++))
done
printf 'File is "%s"\n' "$file"
echo some text in it >&3 
```

此外，您已打开文件以在 fd 3 上写入。

使用`bash-4.4+`，您可以将其设为如下函数：

```
create() { # fd base [suffix [max]]]
  local fd="$1" base="$2" suffix="${3-}" max="${4-}"
  local n= file
  local - # ash-style local scoping of options in 4.4+
  set -o noclobber
  REPLY=
  until
    file=$base${n:+-$n}$suffix
    eval 'command exec '"$fd"'> "$file"' 2> /dev/null
  do
    ((n++))
    ((max > 0 && n > max)) && return 1
  done
  REPLY=$file
} 
```

例如用作：

```
create 3 somefile .ext || exit
printf 'File: "%s"\n' "$REPLY"
echo something >&3
exec 3>&- # close the file 
```

当`max`文件由于`noclobber`.

请注意，`noclobber`仅适用于`>`运算符，而不`>>`适用于`<>`。

## 剩余比赛条件

实际上，`noclobber`并不是在所有情况下都消除竞争条件。它只防止破坏*常规*文件（而不是其他类型的文件，因此`cmd > /dev/null`不会失败）并且在大多数 shell 中本身都有竞争条件。

shell首先`stat(2)`对文件进行检查以检查它是否是常规文件（fifo，目录，设备......）。仅当文件不存在（尚）或者是常规文件时才`3> "$file"`使用 O_EXCL 标志来保证不会破坏文件。

因此，如果有一个具有该名称的 fifo 或设备文件，它将被使用（前提是它可以以只写方式打开），并且如果创建一个常规文件作为 fifo/device/directory 的替代品，则它可能会被破坏。 ..介于两者之间`stat(2)`并且`open(2)`没有O_EXCL！

改变

```
 { command exec 3> "$file"; } 2> /dev/null 
```

至

```
 [ ! -e "$file" ] && { command exec 3> "$file"; } 2> /dev/null 
```

将避免使用已经存在的非常规文件，但不解决竞争条件。

现在，这只是面对想要让您覆盖文件系统上的任意文件的恶意对手时真正需要担心的问题。在同一脚本的两个实例同时运行的正常情况下，它确实消除了竞争条件。因此，在这方面，它比仅使用`[ -e "$file" ]`.

对于完全没有竞争条件的工作版本，您可以使用`zsh`shell 而不是`bash`具有原始接口的 shell 作为模块`open()`中的`sysopen`内置`zsh/system`：

```
zmodload zsh/system

name=some-file

n=
until
  file=$name${n:+-$n}.ext
  sysopen -w -o excl -u 3 -- "$file" 2> /dev/null
do
  ((n++))
done
printf 'File is "%s"\n' "$file"
echo some text in it >&3 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-02-15T06:48:02.557

尝试这样的事情

```
name=somefile
path=$(dirname "$name")
filename=$(basename "$name")
extension="${filename##*.}"
filename="${filename%.*}"
if [[ -e $path/$filename.$extension ]] ; then
    i=2
    while [[ -e $path/$filename-$i.$extension ]] ; do
        let i++
    done
    filename=$filename-$i
fi
target=$path/$filename.$extension 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-05-10T07:32:51.263

使用`touch`或任何你想要的东西，而不是`echo`：

```
echo file$((`ls file* | sed -n 's/file\([0-9]*\)/\1/p' | sort -rh | head -n 1`+1)) 
```

部分表达解释：

*   按模式列出文件：`ls file*`
*   每行只取数字部分：`sed -n 's/file\([0-9]*\)/\1/p'`
*   应用反向人类排序：`sort -rh`
*   只取第一行（即最大值）：`head -n 1`
*   在管道和增量中组合所有（上面的完整表达式）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-29T23:33:32.320

尝试这样的事情（未经测试，但你明白了）：

```
filename=$1

# If file doesn't exist, create it
if [[ ! -f $filename ]]; then
    touch $filename
    echo "Created \"$filename\""
    exit 0
fi

# If file already exists, find a similar filename that is not yet taken
digit=1
while true; do
    temp_name=$filename-$digit
    if [[ ! -f $temp_name ]]; then
        touch $temp_name
        echo "Created \"$temp_name\""
        exit 0
    fi
    digit=$(($digit + 1))
done 
```

根据您正在执行的操作，将调用替换`touch`为创建您正在使用的文件所需的任何代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-02-27T01:45:36.703

这是我用来增量创建目录的更好方法。

它也可以针对文件名进行调整。

```
LAST_SOLUTION=$(echo $(ls -d SOLUTION_[[:digit:]][[:digit:]][[:digit:]][[:digit:]] 2> /dev/null) | awk '{ print $(NF) }')
if [ -n "$LAST_SOLUTION" ] ; then
    mkdir SOLUTION_$(printf "%04d\n" $(expr ${LAST_SOLUTION: -4} + 1))
else
    mkdir SOLUTION_0001
fi 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-10-14T17:39:42.177

[将choroba 的答案](https://stackoverflow.com/a/12187944/1306874)简单地重新包装为通用函数：

```
autoincr() {
    f="$1"
    ext=""

    # Extract the file extension (if any), with preceeding '.'
    [[ "$f" == *.* ]] && ext=".${f##*.}"

    if [[ -e "$f" ]] ; then
        i=1
        f="${f%.*}";

        while [[ -e "${f}_${i}${ext}" ]]; do
            let i++
        done

        f="${f}_${i}${ext}"
    fi
    echo "$f"
}

touch "$(autoincr "somefile.ext")" 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-12-27T21:45:14.467

没有循环并且不使用正则表达式或shell expr。

```
last=$(ls $1* | tail -n1)
last_wo_ext=$($last | basename $last .ext)
n=$(echo $last_wo_ext | rev | cut -d - -f 1 | rev)
if [ x$n = x ]; then
    n=2
else
    n=$((n + 1))
fi
echo $1-$n.ext 
```

更简单，没有扩展名和“-1”例外。

```
n=$(ls $1* | tail -n1 | rev | cut -d - -f 1 | rev)
n=$((n + 1))
echo $1-$n.ext 
```

# mysql - 我想看看是否有人能告诉我这有多安全

> ID：12187860
> 
> 赞同：0
> 
> 时间：2012-08-29T23:24:13.617
> 
> 标签：mysql

我正在编写一个代码，它将检查 2 个不同的表以确定用户将拥有的权限。代码如下所示：

```
 $query1 = ("SELECT 1 FROM `customers` WHERE `Email` = '$email' AND `Password` = '$password'");
    $query2 = ("SELECT 1 FROM `admins` WHERE `Email` = '$email' AND `Password` = '$password'");

    $result1 = mysql_query($query1) or die(mysql_error());
    $result2 = mysql_query($query2) or die(mysql_error());

    if (mysql_num_rows($result1) == 1) {
        // Log user in as a Customer
        exit;
    } else if (mysql_num_rows($result2) == 1) {
        // Log user in as an Admin.
        exit;
    } else {
        // Direct user to registration page.
    } 
```

任何人都可以看看这个并告诉我这样做是否会有任何安全风险？预先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:27:01.573

这是不安全的，例如我的密码是

```
OR 1=1 
```

我可以访问。使用 mysql 准备好的语句

```
<?php
$mysqli = new mysqli("example.com", "user", "password", "database");
if ($mysqli->connect_errno) {
    echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
}

/* Prepared statement, stage 1: prepare */
if (!($stmt = $mysqli->prepare("SELECT 1 FROM customers WHERE Email = (?) AND Password = (?)"))) {
    echo "Prepare failed: (" . $mysqli->errno . ") " . $mysqli->error;
}

if (!$stmt->bind_param("ss", $email, $password)) {
    echo "Binding parameters failed: (" . $stmt->errno . ") " . $stmt->error;
}

if (!$stmt->execute()) {
    echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T23:29:16.500

Firstly you have a change that your code is only known by you.

Secondly you have to check the input data. email and password area is not safety. You should prevent SQL injection. Otherwise your code is not secure.

By the way i'm offering you IP restricted login for admins. I'm using this. And it is more secure.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T23:29:26.480

One big problem here is that the code is vulnerable for sql injections. Which basicly means that the user could put code in the email or password form to bypass the check you have here.

A start would be to perform the following to your input BEFORE you use them in your query:

```
$email = mysql_real_escape_string($email);
$password = mysql_real_escape_string($password); 
```

Though, the mysql library is not recommended by php, rather read about prepared statements in pdo here: [http://www.php.net/manual/en/ref.pdo-mysql.php](http://www.php.net/manual/en/ref.pdo-mysql.php)

But you can try the mysql_real_escape_string to have a first security measure against sql injections.

# c# - 有没有办法将流传递给某个外部组件，同时保持对该流的所有权？

> ID：12187861
> 
> 赞同：0
> 
> 时间：2012-08-29T23:24:40.747
> 
> 标签：c#, .net, stream, filestream

我有一个读取特定文件格式的应用程序。此外，该应用程序还支持读取替代文件格式的“插件”，并将它们转换为该工具本机支持的标准化格式。

我想定义一个类似这样的接口：

```
/// <summary>
/// Interface for file transformer. Implementers of this interface provide a means to
/// convert a given file into Foo Format.
/// </summary>
public interface IFileTransformerPlugin
{
    /// <summary>Gets the name of the transformer to display to the user.</summary>
    /// <value>The name of the transformer displayed to the user.</value>
    string DisplayName
    {
        get;
    }

    /// <summary>Determines if this transformer can handle the given format.</summary>
    /// <remarks>
    /// This method should return very quickly; reading only a small portion of the
    /// input stream. This method is intended to be a rough cut check -- returning true
    /// does not necessarily mean that the file will parse successfully on full load.
    /// </remarks>
    /// <param name="fileContents">The file contents.</param>
    /// <returns>
    /// true if this transformer can handle the supplied format, false otherwise.
    /// </returns>
    bool CanHandleLogFormat(Stream fileContents);

    /// <summary>Transforms a file into Foo Format.</summary>
    /// <param name="inputFile">The input log stream.</param>
    /// <param name="outputFile">The output log stream (where the output should be
    /// written).</param>
    /// <returns>A transformation result which includes error information.</returns>
    LogTransformationResult Transform(Stream inputFile, Stream outputFile);
} 
```

问题来自采用流的转换方法。从概念上讲，我希望插件主机而不是插件“拥有”这些流，并负责在这些流上调用 IDispose 或其他任何内容。例如，在测试场景下，调用者最好能够将 MemoryStream 作为输出传递，然后验证输出是否有效。

但是，作为插件作者，希望能够在框架中使用上层格式化结构；即TextReader/TextWriter；XmlTextReader/XmlTextWriter；等等。但是这些类拥有底层流的所有权并在底层流上调用 Dispose，而不管提供流的代码做什么。（至少，假设这些类本身被正确处理）

我该如何修改这个界面来解决这个问题？它甚至是一个可以解决的问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T00:30:36.133

这引用了经典的软件工程路线：“每个问题都可以通过额外的间接级别来解决”。只需包装流并提供委托给基本流的单行方法。除了 Dispose 方法，什么都不做，这样无论客户端代码做什么，您都可以控制流。喜欢：

```
public class OwnedStream : Stream {
    private Stream stream;
    public OwnedStream(Stream stream) { this.stream = stream; }
    protected override void Dispose(bool disposing) {
        // Do nothing
    }
    public override bool CanRead { get { return stream.CanRead; } }

    // etcetera, just delegate to "stream"
} 
```

请注意该奖章的另一面：您正在提交对其他代码的引用。它可以存储它，您将不知道它们何时完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T23:41:47.753

我从来没有真正喜欢关闭读取器/写入器关闭流（正是您描述的原因。）我通常通过传递读取器/写入器而不是流来解决这个问题。通常，您无论如何都想控制流的格式（文本与二进制），并且 XmlTextReader/Writer 可以从提供的 TextReader/Writer 实例化，所以现在只需决定是否为插件提供二进制或文本访问器.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T23:34:57.487

为什么不通过接口中的 getter 访问流对象呢？然后，您的应用程序可以在需要时从实现中获取流引用。

```
public interface IFileTransformerPlugin {
  string DisplayName { get; }
  string Stream inputFile { get; }

  // etc.
} 
```

# c# - Request.UrlReferrer.ToString() ->System.NullReferenceException：对象引用未设置为对象的实例

> ID：12187866
> 
> 赞同：9
> 
> 时间：2012-08-29T23:25:03.157
> 
> 标签：c#, asp.net

当我尝试`Request.UrlReferrer.ToString()`出现此错误时：

> System.NullReferenceException：对象引用未设置为对象的实例

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-29T23:26:10.290

您必须检查是否`UrlReferrer`为空，因为它并不总是设置（即，当有人直接在地址栏中键入 URL 或单击书签时）...

```
(Request.UrlReferrer == null) ? "" : Request.UrlReferrer.ToString() 
```

# html - 如何在 td 和 span 中垂直对齐文本？

> ID：12187882
> 
> 赞同：4
> 
> 时间：2012-08-29T23:26:13.177
> 
> 标签：html, html-table, valign

这就是我所拥有的，唯一的 CSS 是我的标签的样式，所以没有相关的 CSS 影响这一点。

```
<tr>
    <td colspan="2" valign="top"><span style="font-size:20px; color:#ed8f49">Fall Classes with</span><img src="REDACTED.png" height="90" width="482"></td>
</tr> 
```

当我只有 TD 时，一切正常，但是一旦我将该文本放在一个跨度中或尝试将其设为 h1，它就会与底部对齐，即使我也将对齐属性添加到跨度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:28:40.397

尝试：

```
<td colspan="2" style="vertical-align: top;"> 
```

该属性`valign`已弃用，不应使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T23:31:39.700

您需要`align="top"`或`style="vertical-align:top`在您的图像上:)

# python - 使用 Python 的 asyncore 和 smtpd 检测套接字关闭

> ID：12187890
> 
> 赞同：3
> 
> 时间：2012-08-29T23:27:24.803
> 
> 标签：python, asyncore, smtpd

Python新手在这里。我正在使用 asyncore 和 smtpd 编写电子邮件服务器。除了我无法弄清楚如何检测连接客户端何时/是否关闭套接字之外，一切似乎都有效。此外，我似乎无法设置超时以在不活动后自动关闭连接。这是一些示例代码。CustomSTMPServer.handle_close 永远不会被调用。而且我不知道如何设置有效的超时。任何帮助将不胜感激。

```
import smtpd
import asyncore

class CustomSMTPServer(smtpd.SMTPServer):

    def handle_accept(self):
        pair = self.accept()
        if pair is None:
            pass
        conn, addr = pair
        print 'Incoming connection from %s' % addr[0]
        channel = smtpd.SMTPChannel(self, conn, addr)

    def handle_close(self):
        print 'Received close'

    def process_message(self, peer, mailfrom, rcpttos, data):
        print 'Receiving message from:', peer
        print 'Message addressed from:', mailfrom
        print 'Message addressed to  :', rcpttos
        print 'Message length        :', len(data)
        return

server = CustomSMTPServer(('127.0.0.1', 1025), None)

asyncore.loop() 
```

# r - 如何从数据框中按降序获得前 n 家公司

> ID：12187891
> 
> 赞同：10
> 
> 时间：2012-08-29T23:27:30.650
> 
> 标签：r, sorting, plyr, top-n

我正在尝试从数据框中获取前“n”家公司。下面是我的代码。

```
data("Forbes2000", package = "HSAUR")
sort(Forbes2000$profits,decreasing=TRUE) 
```

现在我想从这个排序的向量中获得前 50 个观察值。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-29T23:30:28.730

`head`并且`tail`是非常有用的功能！

```
head(sort(Forbes2000$profits,decreasing=TRUE), n = 50) 
```

如果你想要 data.frame 的前 50 行，那么你可以使用`arrange`函数 from`plyr`对`data.frame`然后使用`head`

```
library(plyr)

head(arrange(Forbes2000,desc(profits)), n = 50) 
```

请注意，我包装`profits`了一个调用，`desc`这意味着它将按降序排序。

没有 plyr 工作

```
head(Forbes2000[order(Forbes2000$profits, decreasing= T),], n = 50) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-29T23:40:22.920

用于`order`对 进行排序`data.frame`，然后用于`head`仅获取前 50 行。

```
data("Forbes2000", package = "HSAUR")
head(Forbes2000[order(Forbes2000$profits, decreasing=TRUE), ], 50) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-11-29T01:12:09.757

您可以使用`rank`来自`dplyr`.

```
 library(dplyr)
    top_fifty <- Forbes2000 %>%
         filter(rank(desc(profits))<=50) 
```

这会按降序对您的数据进行排序，并且仅保留排名小于或等于 50 的值（即前 50 名）。
Dplyr 非常有用。命令和链接语法非常容易理解。10/10 会推荐。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-29T02:42:28.213

Mnel 是对的，一般来说，您希望使用 head() 和 tail() 函数以及排序函数。我应该提一下，对于中等数据集，Vince 的方法工作得更快。如果你没有使用 head() 或 tail()，那么你可以使用基本的小节调用运算符 []....

```
 library(plyr)
 x = arrange(Forbes2000,desc(profits))
 x = x[1:50,]
 #Or using Order
 x = Forbes2000[order(Forbes2000$profits, decreasing= T),]
 x = x[1:50,] 
```

但是，我确实推荐使用 head()、tail() 或 filter() 函数，因为常规的 [] 运算符假定您的数据是以易于绘制的数组或矩阵格式构造的。（希望这能回答 Teja 的问题）

现在，您选择哪种包装很大程度上是主观的。但是阅读人们的评论，我会说选择使用plyr的arrange（），{bases}的order（）与{utils} head（）和tails，或者plyr（）很大程度上取决于内存大小和行大小你的数据集。我可以更详细地介绍 Plyr 和有时 Dplyr 如何在处理大型复杂数据集时遇到问题，但我不想跑题。

PS这是我第一次回答，因此感谢您的反馈。

# parameters - 如何将参数传递给水晶报表？

> ID：12187894
> 
> 赞同：0
> 
> 时间：2012-08-29T23:27:46.493
> 
> 标签：parameters, crystal-reports, parameter-passing

我**没有使用 VB、C# 或 ASP**，也就是说我想将参数直接传递给 Crystal Reports XI R2。例如：

```
click 'Start'
type 'Run' then Enter 
'MyReport.rpt 12345' 
```

(12345) 是我要传入的参数，或者我可以键入

```
 'MyReport.rpt?parameter1=12345' 
```

我在研究时发现的大多数示例都在讨论 VB 或 ASP，这不是我想要的。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T21:42:01.477

今天才发现这个： [http ://www.rainforestnet.com/crystal-reports-exporter/](http://www.rainforestnet.com/crystal-reports-exporter/)

它是一个命令行工具，可以完成所有工作（获取参数、凭据并具有导出可能性）

只需为每个报告创建一个 .cmd 文件，然后从 powershell 等外部来源收集所有困难的值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T12:04:40.067

RPT 文件不是可执行文件，因此它不接受命令行参数。

你想要做的是类似`crw32.exe -u:"file:///path/to/file.rpt -p0:12345"`. 不幸的是，crw32.exe 不接受命令行参数。

您将需要编写一个从命令行接受和解析参数的 EXE，打开报告，设置参数值，执行报告（您需要传递数据库凭据），最后显示查看器。

# python - Listing XenCenter inventory with Python and the XenAPI module

> ID：12187896
> 
> 赞同：1
> 
> 时间：2012-08-29T23:27:55.923
> 
> 标签：python, xen

I'm trying to get a simple inventory list of servers (by hostname) from Xencenter, using XenAPI from the python shell. However, the documentation on XenAPI seems to be pretty sparse, and I'm unable to even do a dir() on the objects that I need to learn more about.

I installed it and ran as follows:

```
# pip install XenAPI
# python
>>> session = XenAPI.Session("http://myhost")
>>> session.xenapi.login_with_password("myuser", "mypass") 
```

I'm stuck here. Where pysphere has a simple way to pull all VM's, I can't figure out how to do the same thing in XenAPI. A dir(session) does not allow me to view the object -- it looks like the implementation of **dict**() was not done properly?

Does someone have experience with this module?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T23:51:31.177

例如：

```
>>> for opaque_ref, vm in session.xenapi.VM.get_all_records().items():
...     print vm["name_label"] 
```

您无法获取 api 方法，`dir(session)`因为 XenAPI 的底层协议是 XML-RPC，而`XenAPI.Session`对象只是代理您的请求。

有许多全面的[API 参考](http://support.citrix.com/article/CTX130426)用于未来的信息，其中包含每个类的字段名称和方法。

由于您使用`XenAPI`库，因此不应将会话引用添加到所有请求并从结果中获取值： not `.get_all_records("session")['Value']`, but `.get_all_records()`。`XenAPI.Failure`您可以使用Exception捕获所有 XenAPI 错误。

XenServer 对象表示`XenAPI`是一个字典，是的。

# android - Adding layout elements from another layout file

> ID：12187899
> 
> 赞同：0
> 
> 时间：2012-08-29T23:28:05.010
> 
> 标签：android, android-layout

I'm trying to get views from another layout modified these and then add them to the current layout. This is what i'm doing.

myLayout looks as follows:

```
<LinearLayout>
  <RelativeLayout>
    <TextView> 
```

And my code:

```
LinearLayout layout = (LinearLayout) findViewById(R.id.linear);
ViewGroup info = (ViewGroup) getLayoutInflater().inflate(R.layout.myLayout, layout,false); 
RelativeLayout relative = (RelativeLayout) info.getChildAt(1);
ViewGroup vg = (ViewGroup) hiddenInfo.getChildAt(1);
TextField tv = vg.getChildAt(1);
...modify tv...
layout.addView(relative);
layout.addView(tv); 
```

Though my program always crashes as layout.addView, what am i doing wrong?

# google-app-engine - Google App Engine 上的多次放置 - 全部失败还是全部成功？

> ID：12187901
> 
> 赞同：0
> 
> 时间：2012-08-29T23:28:12.533
> 
> 标签：google-app-engine

我有一个在 Google App Engine 上运行的游戏服务器。我的一些 HTTP 请求导致对不同模型的多次放置。因此，例如，我有一个用户模型和一个游戏模型，一个请求可能会同时写入两者。我正在使用带有 NDB 数据库接口的 python。

有没有办法确保两者都成功，或者甚至一个成功而一个失败，让它们都失败？交易听起来可能是正确的事情，但在阅读文档后我并不清楚，它正在谈论多个请求和冲突。

我确实看到单个 put 可以获取实体列表，但我没有看到任何提及如果一个失败则它们都失败了行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:36:52.950

是的，交易就是您所需要的。您需要使用 Ancestors 正确构建数据，以便将它们全部写入事务中。

如果任何 put 失败，事务中的 put 都不会被写入。在文档中说得对。

[https://developers.google.com/appengine/docs/python/datastore/transactions](https://developers.google.com/appengine/docs/python/datastore/transactions)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T01:12:18.797

您可以使用 XG 事务来更新最多 5 个实体组（如果您不使用父子模型，最多可以更新 5 个对象）。

每个实体组（或对象）都有大约 1 个事务/秒的限制。

ndb 交易：[https](https://developers.google.com/appengine/docs/python/ndb/transactions) ://developers.google.com/appengine/docs/python/ndb/transactions xg 交易的限制：[https ://developers.google.com/appengine/docs/python/datastore/overview#Cross_Group_Transactions](https://developers.google.com/appengine/docs/python/datastore/overview#Cross_Group_Transactions)

# ruby-on-rails - Rails --> 一个不会消失的 n+1 数据库问题

> ID：12187913
> 
> 赞同：1
> 
> 时间：2012-08-29T23:29:52.863
> 
> 标签：ruby-on-rails, activerecord

我第一次尝试优化活动记录中的一些 N+1 查询。有 3 个要杀死 - 2 个很容易通过 .includes 调用，但我终其一生都无法弄清楚为什么第三个仍在调用一堆查询。下面的相关代码 - 如果有人有任何建议，我会非常感激。

控制器：

```
@enquiries = Comment.includes(:children).faqs_for_project(@project) 
```

模型;

```
def self.faqs_for_project(project)
  Comment.for_project_and_enquiries(project, project.enquiries).where(:published => true).order("created_at DESC")
end 
```

（及相关范围）

```
scope :for_project_and_enquiries, lambda{|p, qs| where('(commentable_type = ? and commentable_id = ?) or (commentable_type = ? and commentable_id IN (?))', "Project", p.id, "Enquiry", qs.collect{|q| q.id})} 
```

看法：

```
...
= render :partial => 'comments/comment', :collection => @enquries
... 
```

（以及部分中的违规行）

```
...
= 'Read by ' + pluralize(comment.acknowledgers.count, 'lead')
... 
```

为每个评论调用两个 SQL 查询。2个查询是：

```
SQL (2.8ms)  SELECT COUNT(*) FROM "users" INNER JOIN "acknowledgements" ON "users".id = "acknowledgements".user_id WHERE (("acknowledgements".feedback_type = 'Comment') AND ("acknowledgements".feedback_id = 177621))
CACHE (0.0ms)  SELECT "users".* FROM "users" WHERE "users"."id" = 1295 LIMIT 1 
```

我原以为将 (:user, :acknowledgements) 附加到控制器的 .includes 中可以解决问题，但它似乎没有任何效果。如果有人对我所缺少的有任何建议，我将非常感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T23:45:23.253

我相信在您的`Comment`表中您想添加一`:acknowledgers_count`列作为计数器缓存

```
has_many :acknowledgers, ....., counter_cache: true 
```

您将需要创建迁移以将`:acknowledgers_count`列添加到`comments`表中。Rails 应该负责其余的工作。

**[您可以在此处](http://api.rubyonrails.org/classes/ActiveRecord/CounterCache.html)**了解有关`ActiveRecord::CounterCache`api的更多信息。

`count`方法 in在 ActiveRecord 中重载，`comment.acknowledgers.count`首先检查计数器缓存列是否存在，如果存在，则直接从模型*（在本例中为`Comment`模型）*返回，而无需再次访问数据库。

最后，最近有一个很棒的[Railscast](http://railscasts.com/episodes/372-bullet)关于 gem 调用[Bullet](https://github.com/flyerhzm/bullet)可以帮助您识别这些查询问题并指导您找到解决方案。它涵盖了计数器缓存和 N+1 查询。

正如@ismaelga 在对此答案的评论中指出的那样，调用`.size`而不是调用`.count`关系通常是一种更好的做法。查看[源](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L196)代码`size`：

```
def size
  loaded? ? @records.length : count
end 
```

如果关系已经加载，它只会调用`length`它，否则它会调用`count`. 这是一个额外的检查，试图防止不必要地查询数据库。

# sql-server-2008 - sql server difference between a blank column and column with value = 'NULL'

> ID：12187914
> 
> 赞同：0
> 
> 时间：2012-08-29T23:30:03.117
> 
> 标签：sql-server-2008

In sql server, I see a strange behaviour: When I do

`select col1+ ' ' + cast(col2 as varchar(10)) as concat_col`

it returns me a column with a value = NULL (not a blank column).

My suspicion is that it is because col2 has a value = NULL (not blank column). So what is the reason for this behavior? But more importantly, what is the meaning of a column with value = NULL as opposed to a blank column? I do not imagine somebody went in the table and updated all the columns with value = NULL.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:32:33.187

NULL 表示该字段没有任何值。您可以使用 ISNULL 函数将空值转换为您想要的值。以下内容有望为您提供正确的结果（不会给出空值）

```
select ISNULL(col1,'')+ ' ' + cast(ISNULL(col2,'') as varchar(10)) as concat_col 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T23:34:37.820

空白是一个值，而 null 完全没有。

认为零是一个数字，而 null 什么都不是。

# python - AttributeError：'numpy.ndarray'对象没有使用PANDAS的属性'values'

> ID：12187928
> 
> 赞同：-1
> 
> 时间：2012-08-29T23:32:03.507
> 
> 标签：python, pandas

您好我正在尝试对数据样本使用 bootstrap_plot() 函数，但遇到以下错误。我使用相同的数据数组使用 matplotlibs hist() 函数绘制直方图没有问题。

```
Traceback (most recent call last):
 File "/home/Astrophysics/BootStrapping.py", line 19, in <module>
    bootstrap_plot(C, size=17517, samples=1000, color='grey')
  File "/usr/local/lib/python2.7/dist-packages/pandas-0.8.2.dev_eec8a83-py2.7- linux-    i686.egg/pandas/tools/plotting.py", line 301, in bootstrap_plot
    data = series.values
AttributeError: 'numpy.ndarray' object has no attribute 'values' 
```

我的代码

```
import matplotlib.pyplot as plt
import numpy as np
import scipy
import matplotlib.mlab as mlab
import statsmodels.api as sm
import pyfits
from pandas.tools.plotting import bootstrap_plot

F = '/home/khary/Astrophysics/outfiles/outmag20_2dr_9_658.txt'
#data_cube ,header_data_cube = pyfits.getdata("/home/Astrophysics/SDSS_Counts    /count.dr72bright0.3dlz01r01c06.0.fits",1,header=True)

#load arrays with data 
data=np.loadtxt(F)
C=data[:,3]
#obs_count = data_cube.field(3)

#Bootstrap plot
bootstrap_plot(C, size=17517, samples=1000, color='grey')
plt.show() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T07:57:13.357

Pandas bootstrap_plot 需要一个 Series 作为第一个参数。

```
from pandas import Series
bootstrap_plot(Series(C), size=17517, samples=1000, color='grey') 
```

# jquery - 带有 jQ uery 1.4.2 的 jQuery 验证引擎？

> ID：12187935
> 
> 赞同：1
> 
> 时间：2012-08-29T23:33:07.093
> 
> 标签：jquery, jquery-plugins

有没有人在jQuery 1.4.2中使用过 jQuery 验证引擎（位于[http://posabsolute.github.com/jQuery-Validation-Engine/ ）？](http://posabsolute.github.com/jQuery-Validation-Engine/)在文档中，他们使用 jQuery 1.4.4；但我找不到有关测试此插件的最旧版本的任何信息。我们正试图让它与 jQuery 1.4.2 一起工作。有没有人尝试在旧版本的 jQuery 中使用这个插件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:21:43.517

我发现截至 2012 年 8 月，这个特定插件的最新版本实际上需要 jQuery 1.7.2 或更高版本才能工作。在这方面，文档似乎有点过时了。

这个脚本的演示附带了一个最小化的 jQuery 1.7.2 副本，它可以工作。

我尝试下载 jQuery 1.4.4 的副本并在页面中调用它，看看这是否可行，就像文档似乎表明的那样。jQuery 验证引擎不起作用。（它也适用于 jQuery 1.8.0，它的占用空间比 1.7.2 小。）

# batch-file - 按顺序运行批处理文件

> ID：12187938
> 
> 赞同：13
> 
> 时间：2012-08-29T23:33:15.153
> 
> 标签：batch-file, sequential

想请教大家如何在Windows中按顺序运行批处理文件。我努力了 ：

```
start /w batchfile_1.bat 
start /w batchfile_2.bat
..
start /w batchfile_n.bat 
```

但我必须手动关闭前一个 .bat 文件进程（例如通过单击），然后才能继续下一个。是否有任何解决方案可以自动执行此操作，而无需我每次都手动关闭以前的 .bat 程序？

非常感谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-29T23:37:59.160

我会检查这个问题的解决方案：[运行多个批处理文件](https://stackoverflow.com/questions/2071408/how-to-run-multiple-batch-files-in-serial-in-windows-command-line-environment)

*   取自链接中的答案。

使用调用：

```
call bat1.cmd
call bat2.cmd 
```

默认情况下，当您仅从另一个控件运行批处理文件时，控件不会传回给调用控件。这就是为什么你需要使用调用。

基本上，如果您有这样的批次：

```
@echo off
echo Foo
batch2.cmd
echo Bar 
```

那么它只会输出

```
Foo 
```

如果你这样写

```
@echo off
echo Foo
call batch2.cmd
echo Bar 
```

但是，它会输出

```
Foo
Bar 
```

因为在 batch2 终止后，程序控制权被传递回您的原始批处理文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T01:50:11.353

如果你喜欢使用`START`，你可以让你的批处理文件以`EXIT`命令结尾。这将关闭该`start`命令创建的窗口。

```
@echo off
 .
 .
:: Inspired coding
 .
 .
exit 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T13:51:26.420

我不确定，但根据您的评论，当您运行该`START`命令序列时，似乎会发生以下情况：

1.  `START /W`调用命令并启动批处理文件。

2.  批处理文件开始执行并运行程序。

3.  批处理文件完成，其控制台窗口保持打开状态，但程序继续运行。

4.  用于运行批处理文件的`START /W`命令仍在执行，因为控制台窗口仍然打开。

5.  您等到程序终止，然后关闭控制台窗口，然后`START /W`调用下一个命令，一切都将重复。

现在，如果您将`EXIT`要按顺序运行的每个批处理文件放在末尾，这会使情况变得更糟，因为它会导致控制台窗口在批处理脚本完成后关闭，进而结束相应的`START /W`命令并导致另一个命令执行，即使批处理脚本调用的程序可能仍在运行。所以效果是批处理脚本（或者更确切地说，由它们执行的程序）同时运行而不是顺序运行。

我认为，如果可以完全解决这个问题，您需要移动`START /W`命令并将其放在该批处理文件执行的（每个）命令前面的每个批处理文件中，并且不等待终止。也就是说，如果您`batchfile_1.bat`运行 a `program.exe`，请将命令行更改为`START /W program.exe`，对于其他批处理文件中的其他相关命令，同样如此。

# xcode - 如何从 shell 脚本调用苹果脚本？

> ID：12187943
> 
> 赞同：3
> 
> 时间：2012-08-29T23:33:32.207
> 
> 标签：xcode, shell, applescript

如何从 shell 脚本调用苹果脚本。

我有一个 shell 脚本，我在我的 xcode 项目的运行脚本阶段使用它。在执行此 shell 脚本之前，我想调用另一个苹果脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T23:37:15.493

您可以使用该`osascript`实用程序。

这是该实用程序的介绍，使用`man osascript`：

```
OSASCRIPT(1)              BSD General Commands Manual             OSASCRIPT(1)

NAME
   osascript -- execute AppleScripts and other OSA language scripts

SYNOPSIS
   osascript [-l language] [-s flags] [-e statement | programfile] [argument ...]

DESCRIPTION
   osascript executes the given script.  It was designed for use with AppleScript,
   but will work with any Open Scripting Architecture (OSA) language. 
   ... 
```

您可能还对该`osacompile`实用程序感兴趣。

# matlab - Matlab：函数@（x，y，z）的一维积分

> ID：12187954
> 
> 赞同：0
> 
> 时间：2012-08-29T23:34:49.083
> 
> 标签：matlab, integration, anonymous-function, dimension-reduction

让我们说

> ```
>  y=2;
>  z=4;
>  f=@(x,y,z) x.^2+y.^2+z.^2; 
> ```

我想在 [0,1] 中为 x 积分 f。看来我必须定义 g 并执行 quad(g,0,1)

> ```
>  g=@(x) f(x,y,z); 
>  quad(g,0,1) 
> ```

我的问题是是否可以在不定义新函数的情况下直接在 f 上执行 quad。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T00:59:11.600

是的 ; 您可以直接使用[匿名函数](http://www.mathworks.com/help/techdoc/matlab_prog/f4-70115.html)作为参数。

```
quad(@(x)f(x,y,z),0,1); 
```

# php - 关于 CakePHP 中的邮件的困惑

> ID：12187958
> 
> 赞同：0
> 
> 时间：2012-08-29T23:34:59.017
> 
> 标签：php, cakephp

我对邮件在 PHP 和 CakePHP 中的工作方式感到困惑。

1.) 使用 PHP 邮件功能/CakePHP 电子邮件帮助程序或 SMPTP 发送电子邮件有什么区别，如下所示：http: [//book.cakephp.org/1.3/en/view/1290/Sending-A-Message -Using-SMTP](http://book.cakephp.org/1.3/en/view/1290/Sending-A-Message-Using-SMTP)作为结果看起来一样吗？

2.）要指定电子邮件来自谁，您可以在标题中传递电子邮件，但您可以输入任何您想要的内容，那么是什么阻止您输入任何内容？喜欢 yourbank.com？`mail('you@gmail.com', "Subject", "Message", "From: <dave@yourbank.com>");`我刚刚尝试过，它运行良好，但无论如何我在 Gmail 中都找不到它是否来自 yourbank.com 上的 dave...

希望我能对这两个问题有所了解。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T00:43:07.497

1）。CakePHP 实现了许多帮助程序和功能，以使开发应用程序时的生活更轻松。正如您所发现的，Cake 具有邮件功能。我建议阅读整个页面[http://book.cakephp.org/2.0/en/core-utility-libraries/email.html](http://book.cakephp.org/2.0/en/core-utility-libraries/email.html)（它是 2.0 而不是 1.3，所以请不要在两个版本之间有一些大的改动）。本文深入介绍了为什么您可以以特定方式配置某些东西。

**CakePHP 使用 PHP 的默认邮件功能。它只是允许您将视图合并到内容中并以更简单的方式配置外发邮件。**

2）至于在 From Header 中放入潜在的任何电子邮件地址......这可能属于[Email Spoofing](http://en.wikipedia.org/wiki/Email_spoofing)的类别，本质上是在未从源（From Header）授权时发送电子邮件。这再次链接回配置特定的邮件服务器。

默认邮件客户端和通常设置为防止垃圾邮件和垃圾邮件，这是通过采取大量步骤来完成的。有些可能是..

1.  关键字检查，（检查电子邮件内容中是否有任何归类为垃圾邮件的关键字）。

2.  标头检查，<---**这是回答您问题的问题。**

    本质上...检查并检查标头以查看发送邮件的服务器是否有权使用给定的发件人地址。

由于我没有足够的技术知识，我将向您介绍几页内容，讨论针对您的 DNS/域设置记录，以便正确验证电子邮件，而不是将其放入垃圾邮件文件夹中。

[http://www.ipswitch.com/support/imail/guide/imailgsv8.1/Appendix%20A%20dns4.html](http://www.ipswitch.com/support/imail/guide/imailgsv8.1/Appendix%20A%20dns4.html)

[http://help.postageapp.com/kb/application-features/dkim-and-spf-setup-and-validation](http://help.postageapp.com/kb/application-features/dkim-and-spf-setup-and-validation)

[如何正确设置 DNS SPF 记录？](https://stackoverflow.com/questions/9784415/how-to-properly-set-up-dns-spf-records)

我希望我乱七八糟的胡言乱语有某种意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T00:48:00.380

问题 1：PHP 邮件功能使用您自己的服务器内置的电子邮件功能来发送电子邮件。如果您使用 SMTP，您将连接到另一台服务器（例如 Google 的邮件服务器）并使用该服务器发送电子邮件。

**CakePHP 的电子邮件组件可以使用 PHP 邮件或 SMTP，这取决于您的配置方式。**

结果在很多方面基本相同。哪种方式最适合您将取决于您的设置、您发送的电子邮件量、您自己的服务器在发送邮件方面是否有任何限制等。如果您谷歌“PHP 邮件与 SMTP”或类似内容，那么你会得到一些信息来帮助你决定哪个最适合你。

如果您不发送太多电子邮件，例如。如果您只是想发送每天提交几次的查询表单的结果，那么只需使用 PHP 邮件，不用担心。

问题 2：虽然电子邮件程序采取了各种措施来确保邮件是合法的，但基本上没有什么可以完全阻止虚假电子邮件。您可以发送假电子邮件。查看此站点：[http](http://deadfake.com/Send.aspx) ://deadfake.com/Send.aspx ，尤其是他们的常见问题解答部分：[http ://deadfake.com/FAQ.aspx](http://deadfake.com/FAQ.aspx)

垃圾邮件过滤器尽最大努力捕捉虚假电子邮件，但最终还是要靠最终用户保持警惕，尤其是银行电子邮件！

# asp.net-mvc - mvc 从控制器中的方法获取列表

> ID：12187959
> 
> 赞同：0
> 
> 时间：2012-08-29T23:35:00.960
> 
> 标签：asp.net-mvc, controller, webgrid, actionlink, asp.net-mvc-partialview

我是 MVC 的新手。我有一个按钮，单击该按钮会打开一个模式弹出窗口（JQuery）。在此模式中，我有 10 个 DropDownLists，并且我使用这些下拉列表中的所有选定值创建了一个特定键。我还有另一个按钮可以打开另一个模式。这就是我感到困惑的地方：我需要执行一个包含键的查询，并且根据这个结果，我需要在第二个模式中填充一个 WebGrid。

我怎样才能做到这一点？我一直在考虑一个动作链接或部分视图，或者在控制器中调用返回列表的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T23:08:05.650

用ajax很简单，看：

```
$.ajax({
  type: "POST", // type of request
  url: "page.php", // page
  dataType: 'JSON', // Format of send and response
  data: { id: "2", name: "example" }, // data in JSON format
  sucess: function(response) {
    alert('The response was: ' + response); // All ok
  },
  error: function() {
    alert('Connection expired!'); // Request failed
  }
}); 
```

# r - 构建 data.frame 来设置名称？

> ID：12187971
> 
> 赞同：1
> 
> 时间：2012-08-29T23:36:58.223
> 
> 标签：r

我可以使用 do.call 函数将列表转换为 data.frame：

```
z=list(c(1:3),c(5:7),c(7:9))
x=as.data.frame(do.call(rbind,z))
names(x)=c("one","two","three")
x

##   one two three
## 1   1   2     3
## 2   5   6     7
## 3   7   8     9 
```

我想让它更简洁，将两个语句合并为一个语句，可以吗？

```
x=as.data.frame(do.call(rbind,z))  
names(x)=c("one","two","three") 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T23:44:52.160

`setNames`是你想要的。它在`stats`应该加载的包中`R`

`setNames(as.data.frame(do.call(rbind,z)), c('a','b','c'))`

```
##   a b c
## 1 1 2 3
## 2 5 6 7
## 3 7 8 9 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T00:10:33.220

另一种方法是`structure()`函数，这是基本的，更通用的：

```
structure(as.data.frame(do.call(rbind,z)), names=c('a','b','c')) 
```

# iphone - 在 iPhone 项目中使用 libpng 的问题

> ID：12187972
> 
> 赞同：2
> 
> 时间：2012-08-29T23:37:14.320
> 
> 标签：iphone, xcode, libpng

我正在尝试将 libpng 添加到我的 iPhone 项目中。

我将 .c 和 .h 文件复制到它们自己的目录“thirdparty/libpng/”中，并将 png.h 包含在我的纹理类中：

```
#ifndef PNG_H
    #include "thirdparty/libpng/png.h"
#endif 
```

在这一点上，我的项目编译得很好，没有警告和错误。

接下来，我尝试添加一个函数来检查纹理是否为 png，并且在 png_sig_cmp 上出现编译错误，即使包含 png.h：

```
#define PNG_BYTES_TO_CHECK 4
int GETexture::CheckIfValidPNGTexture( const char* pTextureName, FILE **ppFp )
{
    char buf[PNG_BYTES_TO_CHECK];

    /* Open the prospective PNG file. */
    if ((*ppFp = fopen(pTextureName, "rb")) == NULL)
        return 0;

    /* Read in some of the signature bytes */
    if (fread(buf, 1, PNG_BYTES_TO_CHECK, *ppFp) != PNG_BYTES_TO_CHECK)
        return 0;

    /* Compare the first PNG_BYTES_TO_CHECK bytes of the signature.
     Return nonzero (true) if they match */

    return(!png_sig_cmp(buf, (png_size_t)0, PNG_BYTES_TO_CHECK)); // <- COMPILE ERROR

} 
```

我得到的错误是：没有匹配函数调用'png_sig_cmp'

标题肯定会被包括在内。如果我尝试在其中输入一些随机的东西，比如“sdfdd”，我会得到一个编译错误，表明它正在解析那个头文件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-06T10:36:14.827

我曾经遇到过完全相同的问题，帮助我的是简单的转换 - 因为如果你查看 png.h 头文件，png_sig_cmp 定义：

```
 png_sig_cmp(png_const_bytep sig, png_size_t start, png_size_t num_to_check) 
```

第一个参数是**png_const_bytep** - 定义为：

```
PNG_CONST png_byte        FAR * png_const_bytep 
```

这实际上翻译为：

```
const unsigned char* 
```

我会简单的类型转换：

```
return(!png_sig_cmp((png_const_bytep)buf, (png_size_t)0, PNG_BYTES_TO_CHECK)); 
```

希望能帮助到你！

# javascript - 简单的javascript方法问题

> ID：12187982
> 
> 赞同：-4
> 
> 时间：2012-08-29T23:38:15.820
> 
> 标签：javascript, jquery

我试图了解以下代码之间的区别..

```
Select.prototype.create = function(){

codes1......

}

Search.prototype.create = function(){

codes2......
} 
```

它们都有不同的代码，但方法相同。我不确定它为什么以及如何工作。任何人都可以帮助我吗？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:41:11.297

它们是在两个不同构造函数的原型上定义的相同方法。Select 和 Search 似乎是不同对象的构造函数（正如它们的名称所暗示的那样）。如果你做了

var a = new Select(); a.create(); // 这将运行代码1 ....

var b = 新搜索（）；b.create(); // 这将运行代码2 ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T00:24:05.253

Javascript 函数/方法不是唯一的名称。整个定义 Search.prototype.create 应该是唯一的。 *我说应该是因为 Javascript 允许您替换定义而不会导致任何错误/警告*

Javascript 有两种方法，一种在 Search 原型链上，另一种在 Select 原型链上。这两种方法恰好被称为相同但根据语言无关。

通常，在任何其他语言或 API 中，都会使用常用名称，这样`length, toString, call, dispose, replace`的列表可以继续。

# css - 如果编写 CSS 以最小化调用属性而不是选择器的数量，是否会有性能差异？

> ID：12187986
> 
> 赞同：1
> 
> 时间：2012-08-29T23:38:40.860
> 
> 标签：css, performance, load, stylesheet, minify

澄清：

现在，很可能是因为可读性，CSS 的写法有点像这样：

```
element {
    text-decoration: underline;
}

#selector {
    font-size: 50px;
    color: red;
    text-decoration: underline;
}

.selector-two {
    color: red;
} 
```

在此示例中，属性被分配给选择器以赋予它们特定的样式。此外，某些属性被多次分配给不同的选择器。如果这样写，样式表的性能或大小是否会有所不同：

```
element, #selector { text-decoration: underline; }
#selector, .selector-two { color: red; }
#selector { font-size: 50px; } 
```

当然，这不会很容易地在 CSS 中查看哪些样式应用于某些元素，但是如果您可以缩小 CSS 代码以使其看起来有什么好处吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T00:14:55.543

CSS 速度优化完全是浪费时间。

浏览器可以非常快地解析这些东西。

你最好专注于减少你的附属文件的大小，即你的图片、css文件、html、javascript等。

# spring - Spring 3.1.1 服务不延迟加载加入的自定义对象

> ID：12187994
> 
> 赞同：2
> 
> 时间：2012-08-29T23:39:55.937
> 
> 标签：spring, hibernate, jpa, spring-mvc

调用服务时出现奇怪的错误。

它不会将用户对象加载到卡 pojo 中。

错误显示在我的*卡*pojo中的*用户*属性上（通过 eclipse 调试模式查看）。

 *```
com.sun.jdi.InvocationException occurred invoking method. 
```

然后在尝试渲染视图时发生错误：

```
SEVERE: Servlet.service() for servlet [WebApp] in context with path [/WebApp] threw exception [Request processing failed; nested exception is org.thymeleaf.exceptions.TemplateProcessingException: Exception evaluating SpringEL expression: "user.card.alias" (card/index:37)] with root cause
org.hibernate.LazyInitializationException: could not initialize proxy - no Session 
```

```
@Controller
public class CardController extends AppController
{
    static Logger logger = LoggerFactory.getLogger(CardController.class);

    @Autowired
    private ICardService cardService;

    // Card home page (list all cards and options)
    @RequestMapping(value = "/card", method = RequestMethod.GET)
    public String cardMain(Model model, HttpServletRequest request)
    {
        PagedListHolder<Card> cards = new PagedListHolder<Card>(
                cardService.getAll());

        ...
    }

    ...
} 
```

```
@Service
public class CardService implements ICardService
{
    @Autowired
    ICardDAO cardDAO;

    @Transactional
    public List<Card> getAll()
    {
        return cardDAO.findAll();
    }

    ...
} 
```

```
@Entity
public class Card implements Serializable
{
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumns({ @JoinColumn(name = "USERID", referencedColumnName = "ID") })
    @Valid
    private User user;

    public User getUser()
    {
        if (user == null)
        {
            user = new User();
        }

        return user;
    }

    public void setUser(User user)
    {
        this.user = user;
    }

    ...
} 
```

```
@Entity
public class User implements Serializable
{
    @OneToOne(mappedBy="user", cascade={CascadeType.ALL})
    private UserRole userRole;

    @OneToMany(mappedBy = "user", fetch = FetchType.LAZY, cascade = { CascadeType.ALL })
    private Set<Card> cards;

    public UserRole getUserRole()
    {
        if (userRole == null)
        {
            userRole = new UserRole();
        }

        return userRole;
    }

    public void setUserRole(UserRole userRole)
    {
        this.userRole = userRole;
    }

    public Set<Card> getCards()
    {
        if (cards == null)
        {
            cards = new LinkedHashSet<Card>();
        }

        return cards;
    }

    public void setCards(Set<Card> cards)
    {
        this.cards = cards;
    }

    ...
} 
```

我启用了日志记录，看起来它确实在某个时候得到了它们（user=com.webapp.model.User#35，pan=5499999999999999，expiry=1214....）：

```
2012-08-30 00:15:47,212 DEBUG [http-bio-8080-exec-4] o.s.b.f.s.DefaultListableBeanFactory [AbstractBeanFactory.java:245] Returning cached instance of singleton bean 'transactionManager'
2012-08-30 00:15:47,214 DEBUG [http-bio-8080-exec-4] o.s.o.j.JpaTransactionManager [AbstractPlatformTransactionManager.java:365] Creating new transaction with name [com.webapp.service.impl.CardService.getAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT; ''
2012-08-30 00:15:47,215 DEBUG [http-bio-8080-exec-4] o.h.i.SessionImpl [SessionImpl.java:265] opened session at timestamp: 13462821472
2012-08-30 00:15:47,216 DEBUG [http-bio-8080-exec-4] o.s.o.j.JpaTransactionManager [JpaTransactionManager.java:368] Opened new EntityManager [org.hibernate.ejb.EntityManagerImpl@d49865b] for JPA transaction
2012-08-30 00:15:47,216 DEBUG [http-bio-8080-exec-4] o.h.t.JDBCTransaction [JDBCTransaction.java:78] begin
2012-08-30 00:15:47,217 DEBUG [http-bio-8080-exec-4] o.h.j.ConnectionManager [ConnectionManager.java:444] opening JDBC connection
2012-08-30 00:15:47,217 DEBUG [http-bio-8080-exec-4] o.s.j.d.DriverManagerDataSource [DriverManagerDataSource.java:162] Creating new JDBC DriverManager Connection to [jdbc:mysql://localhost:3306/Thesis]
2012-08-30 00:15:47,288 DEBUG [http-bio-8080-exec-4] o.h.t.JDBCTransaction [JDBCTransaction.java:83] current autocommit status: true
2012-08-30 00:15:47,289 DEBUG [http-bio-8080-exec-4] o.h.t.JDBCTransaction [JDBCTransaction.java:86] disabling autocommit
2012-08-30 00:15:47,290 DEBUG [http-bio-8080-exec-4] o.s.o.j.JpaTransactionManager [JpaTransactionManager.java:400] Exposing JPA transaction as JDBC transaction [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@296fb592]
2012-08-30 00:15:47,292 DEBUG [http-bio-8080-exec-4] o.h.j.AbstractBatcher [AbstractBatcher.java:410] about to open PreparedStatement (open PreparedStatements: 0, globally: 0)
2012-08-30 00:15:47,293 DEBUG [http-bio-8080-exec-4] o.h.SQL [SQLStatementLogger.java:111] select card0_.id as id6_, card0_.active as active6_, card0_.alias as alias6_, card0_.cvc as cvc6_, card0_.expiry as expiry6_, card0_.pan as pan6_, card0_.USERID as USERID6_ from Card card0_
2012-08-30 00:15:47,297 DEBUG [http-bio-8080-exec-4] o.h.j.AbstractBatcher [AbstractBatcher.java:426] about to open ResultSet (open ResultSets: 0, globally: 0)
2012-08-30 00:15:47,300 DEBUG [http-bio-8080-exec-4] o.h.l.Loader [Loader.java:1322] result row: EntityKey[com.webapp.model.Card#1]
2012-08-30 00:15:47,301 DEBUG [http-bio-8080-exec-4] o.h.l.Loader [Loader.java:1322] result row: EntityKey[com.webapp.model.Card#2]
2012-08-30 00:15:47,303 DEBUG [http-bio-8080-exec-4] o.h.l.Loader [Loader.java:1322] result row: EntityKey[com.webapp.model.Card#3]
2012-08-30 00:15:47,317 DEBUG [http-bio-8080-exec-4] o.h.j.AbstractBatcher [AbstractBatcher.java:433] about to close ResultSet (open ResultSets: 1, globally: 1)
2012-08-30 00:15:47,317 DEBUG [http-bio-8080-exec-4] o.h.j.AbstractBatcher [AbstractBatcher.java:418] about to close PreparedStatement (open PreparedStatements: 1, globally: 1)
2012-08-30 00:15:47,318 DEBUG [http-bio-8080-exec-4] o.h.e.TwoPhaseLoad [TwoPhaseLoad.java:130] resolving associations for [com.webapp.model.Card#1]
2012-08-30 00:15:47,319 DEBUG [http-bio-8080-exec-4] o.h.e.TwoPhaseLoad [TwoPhaseLoad.java:255] done materializing entity [com.webapp.model.Card#1]
2012-08-30 00:15:47,320 DEBUG [http-bio-8080-exec-4] o.h.e.TwoPhaseLoad [TwoPhaseLoad.java:130] resolving associations for [com.webapp.model.Card#2]
2012-08-30 00:15:47,321 DEBUG [http-bio-8080-exec-4] o.h.e.TwoPhaseLoad [TwoPhaseLoad.java:255] done materializing entity [com.webapp.model.Card#2]
2012-08-30 00:15:47,322 DEBUG [http-bio-8080-exec-4] o.h.e.TwoPhaseLoad [TwoPhaseLoad.java:130] resolving associations for [com.webapp.model.Card#3]
2012-08-30 00:15:47,323 DEBUG [http-bio-8080-exec-4] o.h.e.TwoPhaseLoad [TwoPhaseLoad.java:255] done materializing entity [com.webapp.model.Card#3]
2012-08-30 00:15:47,339 DEBUG [http-bio-8080-exec-4] o.h.e.StatefulPersistenceContext [StatefulPersistenceContext.java:893] initializing non-lazy collections
2012-08-30 00:15:47,339 TRACE [http-bio-8080-exec-4] o.s.o.j.JpaTransactionManager [AbstractPlatformTransactionManager.java:922] Triggering beforeCommit synchronization
2012-08-30 00:15:47,340 TRACE [http-bio-8080-exec-4] o.s.o.j.JpaTransactionManager [AbstractPlatformTransactionManager.java:935] Triggering beforeCompletion synchronization
2012-08-30 00:15:47,341 DEBUG [http-bio-8080-exec-4] o.s.o.j.JpaTransactionManager [AbstractPlatformTransactionManager.java:752] Initiating transaction commit
2012-08-30 00:15:47,341 DEBUG [http-bio-8080-exec-4] o.s.o.j.JpaTransactionManager [JpaTransactionManager.java:507] Committing JPA transaction on EntityManager [org.hibernate.ejb.EntityManagerImpl@d49865b]
2012-08-30 00:15:47,342 DEBUG [http-bio-8080-exec-4] o.h.t.JDBCTransaction [JDBCTransaction.java:130] commit
2012-08-30 00:15:47,342 DEBUG [http-bio-8080-exec-4] o.h.e.d.AbstractFlushingEventListener [AbstractFlushingEventListener.java:134] processing flush-time cascades
2012-08-30 00:15:47,345 DEBUG [http-bio-8080-exec-4] o.h.e.d.AbstractFlushingEventListener [AbstractFlushingEventListener.java:177] dirty checking collections
2012-08-30 00:15:47,347 DEBUG [http-bio-8080-exec-4] o.h.e.d.AbstractFlushingEventListener [AbstractFlushingEventListener.java:108] Flushed: 0 insertions, 0 updates, 0 deletions to 12 objects
2012-08-30 00:15:47,348 DEBUG [http-bio-8080-exec-4] o.h.e.d.AbstractFlushingEventListener [AbstractFlushingEventListener.java:114] Flushed: 0 (re)creations, 0 updates, 0 removals to 0 collections
2012-08-30 00:15:47,349 DEBUG [http-bio-8080-exec-4] o.h.p.Printer [Printer.java:106] listing entities:
2012-08-30 00:15:47,354 DEBUG [http-bio-8080-exec-4] o.h.p.Printer [Printer.java:113] com.webapp.model.Card{id=2, alias=sadsdsdf, cvc=111, active=true, user=com.webapp.model.User#35, pan=5499999999999999, expiry=1214}
2012-08-30 00:15:47,355 DEBUG [http-bio-8080-exec-4] o.h.p.Printer [Printer.java:113] com.webapp.model.Card{id=3, alias=asdsdsdfsdf, cvc=122, active=false, user=com.webapp.model.User#47, pan=5411222222222222, expiry=1214}
2012-08-30 00:15:47,358 DEBUG [http-bio-8080-exec-4] o.h.p.Printer [Printer.java:113] com.webapp.model.Card{id=1, alias=sdfsdfsdfd, cvc=111, active=true, user=com.webapp.model.User#35, pan=5411111111111111, expiry=1214}
2012-08-30 00:15:47,361 DEBUG [http-bio-8080-exec-4] o.h.t.JDBCTransaction [JDBCTransaction.java:223] re-enabling autocommit
2012-08-30 00:15:47,363 DEBUG [http-bio-8080-exec-4] o.h.t.JDBCTransaction [JDBCTransaction.java:143] committed JDBC Connection
2012-08-30 00:15:47,363 DEBUG [http-bio-8080-exec-4] o.h.j.ConnectionManager [ConnectionManager.java:427] aggressively releasing JDBC connection
2012-08-30 00:15:47,364 DEBUG [http-bio-8080-exec-4] o.h.j.ConnectionManager [ConnectionManager.java:464] releasing JDBC connection [ (open PreparedStatements: 0, globally: 0) (open ResultSets: 0, globally: 0)]
2012-08-30 00:15:47,365 TRACE [http-bio-8080-exec-4] o.s.o.j.JpaTransactionManager [AbstractPlatformTransactionManager.java:948] Triggering afterCommit synchronization
2012-08-30 00:15:47,365 TRACE [http-bio-8080-exec-4] o.s.o.j.JpaTransactionManager [AbstractPlatformTransactionManager.java:964] Triggering afterCompletion synchronization
2012-08-30 00:15:47,366 DEBUG [http-bio-8080-exec-4] o.s.o.j.JpaTransactionManager [JpaTransactionManager.java:593] Closing JPA EntityManager [org.hibernate.ejb.EntityManagerImpl@d49865b] after transaction
2012-08-30 00:15:47,367 DEBUG [http-bio-8080-exec-4] o.s.o.j.EntityManagerFactoryUtils [EntityManagerFactoryUtils.java:343] Closing JPA EntityManager 
```

关于这个错误的原因有什么建议吗？

顺便说一句，我正在使用 Spring 3.1.1.RELEASE。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-05T21:41:49.327

我有同样的问题，原因是百里香，加载对象后，关闭数据库会话，正如@garis-m-suero 在[我自己的帖子](https://stackoverflow.com/questions/29885802/form-parameter-is-null-with-thymeleaf-and-spring-mvc)中所述。

到目前为止，这就是 thymeleaf 视图的工作方式，并引用 @garis-m-suero 先生

> 您可能可以在春季将模型的范围设为会话，但这不值得

编辑：

另一个对我来说似乎真的很好的选择是在您的配置上设置 OpenSessionInViewInterceptor，如下所示：

```
@Bean
public OpenSessionInViewInterceptor openSessionInViewInterceptor(){
    OpenSessionInViewInterceptor openSessionInterceptor = new OpenSessionInViewInterceptor();
    openSessionInterceptor.setSessionFactory(sessionFactory);
    return openSessionInterceptor;
} 
```

他们用这个覆盖 addInterceptor ：

```
@Override
public void addInterceptors(InterceptorRegistry registry) { 
    registry.addInterceptor(thymeleafLayoutInterceptor());
    registry.addInterceptor(applicationInterceptor());
    registry.addWebRequestInterceptor(openSessionInViewInterceptor());
} 
```

[在github](https://github.com/wiecia/spring-test/blob/master/src/main/java/com/wiecia/springtest/config/WebConfig.java)上找到了这个解决方案*

# java - 什么时候应该使用带有 Java NIO 的直接缓冲区进行网络 I/O 的简单规则？

> ID：12187996
> 
> 赞同：9
> 
> 时间：2012-08-29T23:40:22.917
> 
> 标签：java, real-time, css-selectors, nio, bytebuffer

具有以简单直接的方式解释复杂事物的天赋的人可以解决这个问题吗？在使用 Java NIO 进行网络 I/O 时，何时应该使用直接 ByteBuffers 而不是常规 ByteBuffers，以获得最佳性能？

* * *

例如：我应该读入一个堆缓冲区并从那里解析它，做很多 get() （逐字节）还是应该将它读入一个直接缓冲区并从直接缓冲区解析？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-30T07:39:34.360

> 在使用 Java NIO 进行网络 I/O 时，何时应该使用直接 ByteBuffers 而不是常规 ByteBuffers，以获得最佳性能？

直接缓冲区有许多优点

*   避免在 Java 和本机内存之间传递额外的数据副本。
*   如果它们被重新使用，只有使用过的页面会变成真正的内存。这意味着你可以让它们比我需要的大得多，它们只会浪费虚拟内存。
*   您可以有效地以本机字节顺序访问多字节原语。（基本上是一条机器码指令）

> 我应该读入堆缓冲区并从那里解析它，做很多 get() （逐字节）还是应该将它读入直接缓冲区并从直接缓冲区解析？

如果您一次读取一个字节，您可能不会获得太多优势。但是，使用直接字节缓冲区，您一次可以读取 2 或 4 个字节，并一次有效地解析多个字节。

> [实时] [选择器]

如果您正在解析实时数据，我会避免使用选择器。我发现使用阻塞 NIO 或忙等待 NIO 可以为您提供最低的延迟性能（假设您的连接数量相对较少，例如最多 20 个）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-30T00:00:09.343

当您只是复制数据时，直接缓冲区是最好的，比如从套接字到文件，*反之亦然，*因为数据不必遍历 JNI/Java 边界，它只停留在 JNI 区域。如果您打算自己查看数据，那么直接缓冲区毫无意义。

# javascript - 如何将 HTML div 对齐在一行中？

> ID：12187997
> 
> 赞同：0
> 
> 时间：2012-08-29T23:40:24.450
> 
> 标签：javascript, html, css

我正在尝试在水平行结构中对齐一些 div。有一个 div`container`有子 div，这些子 div 应该在同一行。可以有许多这样的容器 div，它们具有不同的 id 但类名相同。

我怎样才能做到这一点？这是我尝试的 jsFiddle：http: [//jsfiddle.net/unix_user/VSd6Y/6/](http://jsfiddle.net/unix_user/VSd6Y/6/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:57:01.290

使用`display:inline-block`. 这样，您`div`将彼此相邻堆叠，*并且*您可以指定`block`元素的宽度和其他属性。

查看[更新的小提琴](http://jsfiddle.net/VSd6Y/12/)。您可以看到`div`带有样式的 s`container`位于不同的行上，但子`div`s 彼此相邻堆叠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T00:03:47.103

把它想象成一个`UL LI`结构。您可以使用`float:left;`元素或`display:inline-block;`新浏览器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T00:11:49.337

我建议使用 .class 做一些事情，例如：

```
.repeating{width:400px; height:100px;margin:0px;padding:0px;}    
.repeatMe{width:90px; height:100px; padding:0px 5px; float:left;}

<div id="repeating">
<div class="repeatMe"><img src="imghere.gif" /></div>
<div class="repeatMe"><img src="imghere.gif" /></div>
<div class="repeatMe"><img src="imghere.gif" /></div>
<div class="repeatMe"><img src="imghere.gif" /></div>
</div> 
```

# android - android mediaplayer 正在从一个播放器播放多个实例

> ID：12187998
> 
> 赞同：0
> 
> 时间：2012-08-29T23:40:24.900
> 
> 标签：android, media-player

所以我试图通过 android 播放声音。我创建了一个这样的媒体播放器

```
MediaPlayer player; (outside onCreate())
player = MediaPlayer.create(this, R.raw.theninth); (inside onCreate()) 
```

然后我在整个活动中引用这个玩家。.start() 摇晃。.pause onclick 等。它看起来像这样

```
if(mag >= 500) {
    if(!started) {
        mainView.setText(R.string.waitforit);
        player.start();
        started = true;
        if(doThisOnce) {
            timer.schedule(changeText, 26000);
            doThisOnce = false;
        }
    }
    player.setVolume((float)(2*mag/3.0),(float)(2*mag/3.0));
} 
```

和

```
public void stopAudio(View v) {
    mainView.setText(R.string.shakeme);
    player.pause();
    started = false;
} 
```

所以问题是当我点击屏幕时播放器没有暂停，而是转到 hte 应用程序的起始文本，就像我重新加载了整个应用程序一样，我可以摇动它，然后从同一个文件的另一个实例同一播放器将开始播放.. 怎么办？