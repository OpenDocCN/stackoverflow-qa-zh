# StackOverflow 问答 000325000-000325999

# c# - 使用 WCF 从 Silverlight 传递列表

> ID：325001
> 
> 赞同：2
> 
> 时间：2008-11-28T02:56:26.810
> 
> 标签：c#, .net, asp.net, wcf, silverlight

我的 WCF 服务定义如下 [ServiceContract] public interface IService1 { [OperationContract] IList GetMyTable();

```
 [OperationContract]
    void SendMyTable(List<RatePositions> ratePositions);

    [OperationContract]
    void SendString(string value);
} 
```

当我从 SilverLight 应用程序调用 GetMyTable() 时，它工作正常，它会将 ratePositions 列表带入我的应用程序。SendString() 也可以正常工作，它从我的应用程序发送一个字符串。

SendMyTable(List ratePositions) 不起作用，它应该从我的应用程序发送一个 ratePositions 列表。

我得到的错误是：远程服务器返回了意外响应：（404）未找到

任何想法为什么这种方法不起作用但其他方法起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T13:32:11.270

问题可能是 WCF 的消息大小问题。查看在您的 silverlight 项目中创建的 clientconfig 文件以及在您的服务器项目中创建的 web.config，以确保您返回的数据的大小不会太大。

404 错误是任何 WCF 故障的全部捕获。您可以调试服务器代码以查看它是否达到那么远吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T03:33:42.147

因为 Silverlight 不喜欢“列表”，而是会将其（在客户端）转换为“ObservableCollection”。尝试使用 ObservableCollection 而不是 List。那应该可以解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T00:43:56.860

我通过增加配置文件中的 MaxBufferSize 解决了这个问题。

垃圾错误信息！

# javascript - 用“this”调用函数

> ID：325004
> 
> 赞同：11
> 
> 时间：2008-11-28T03:01:53.833
> 
> 标签：javascript

我有一个 <a> 元素的 onclick 处理程序（实际上，它是一个 jQuery 创建的处理程序，但这并不重要）。它看起来像这样：

```
function handleOnClick() {
    if(confirm("Are you sure?")) {
        return handleOnClickConfirmed();
    }
    return false;
} 
```

从此函数中，单击 <a> 元素时可以访问**this对象。**但是，handleOnClickConfirmed 的**this**是一个 Window 元素！我希望 handleOnClickConfirmed 与**handleOnClick**一样。我该怎么做？

（我知道我可以将**它**作为参数传递给handleOnClickConfirmed，但我的一些代码已经使用了handleOnClickConfirmed，我不想重写这些调用。此外，我认为使用**它**看起来更干净。）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-28T03:14:49.627

以下应该做到这一点：

```
function handleOnClick() {
    if( confirm( "Sure?" ) ) {
        return handleOnClickConfirmed.call( this );
    }
    return false;
} 
```

[`call()`](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Function/call)附加到对象的功能`Function`旨在允许这样做；调用具有所需上下文的函数。在设置回调到其他对象中的函数的事件处理程序时，这是一个非常有用的技巧。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-28T06:51:07.070

Rob 的答案是您问题的最佳答案，但我想解决您在原始问题中写的一些内容：

> 我知道我可以将它作为参数传递给 handleOnClickConfirmed，但是我的一些代码已经使用了 handleOnClickConfirmed，我不想重写这些调用。

就解释器而言，JavaScript 参数始终是可选的。例如，如果您具有以下功能：

```
function MyFunction(paramA, paraB) {
  // do nothing
} 
```

所有这些调用都将毫无错误地执行：

```
MyFunction(1,2);
MyFunction(1);
MyFunction(); 
```

因此，您可以修改 handleOnClickConfirmed 以接受本质上是可选参数的内容。像这样：

```
function handleOnClickConfirmed(context) {
  context = context || this;
  // use context instead of 'this' through the rest of your code
} 
```

同样，在这种特殊情况下，调用函数是最好的解决方案。但是我上面概述的技术是您工具箱中的一个很好的技术。

# c# - 在sharepoint中按组获取用户

> ID：325007
> 
> 赞同：10
> 
> 时间：2008-11-28T03:07:10.393
> 
> 标签：c#, sharepoint, moss, console, wss

谁能告诉我如何使用共享点获取某个组内的用户？

所以我有一个包含用户和或组的列表。我想检索该列表中的所有用户。有没有办法区分列表项是组还是用户。如果它是一个组，我需要获取该组中的所有用户。

我正在使用 c#，并且我试图通过使其成为控制台应用程序来做精简。

我是sharepoint的新手，我真的跳进了这里的池子的深处，任何帮助都将不胜感激。

干杯..

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-28T16:56:13.123

您需要知道的第一件事是，当您有一个包含用户/组字段的列表时，您必须知道它的类型。当项目值中有一个用户或组时，字段类型为 SPFieldUserValue。但是，如果字段有多个用户/组选择，则字段类型为 SPFieldUserValueCollection。
我假设您的字段允许单个用户/组选择，并且您已经拥有以下对象：

```
SPSite site;
SPWeb web;
SPListItem item; 
```

现在，我们将检查用户/组的字段值并检索用户列表，与用户类型无关（该字段的名称是*"Users"*）。

```
SPFieldUserValue usersField = new SPFieldUserValue(mainWeb, item["Users"].ToString());
bool isUser = SPUtility.IsLoginValid(site, usersField.User.LoginName);
List<SPUser> users = new List<SPUser>();

if (isUser)
{
    // add a single user to the list
    users.Add(usersField.User);
}
else
{
    SPGroup group = web.Groups.GetByID(usersField.LookupId);

    foreach (SPUser user in group.Users)
    {
        // add all the group users to the list
        users.Add(user.User);
    }
} 
```

我希望它对你有帮助。

Tks，
佩德罗·何塞·巴蒂斯塔

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-11-05T13:59:29.957

注意：SPUser 对象也可以是 AD 组（也就是说，“DOMAIN\Domain Users”可能存在一个 SPUser 对象......这就是 SPUser 对象还包含属性 IsDomainGroup 的原因。

从这些信息中，您可以开始使用 SPPrincipalInfo 对象遍历 AD 组......但这并不总是令人愉快的。

值得记住的一件事是 SPGroup 对象包含可以遍历 AD 组的 ContainsCurrentUser 属性……但是，这假设您有一个 SPGroup 对象可以使用。

享受。
-斯科特

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-11T14:10:15.957

这更好地使用`web.SiteGroups`而不是`web.Groups`作为一个组可能被该站点继承。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-02T08:28:06.973

```
private bool IsMember()
    {
        bool isMember;
        SPSite site = new SPSite(SiteURL);
        SPWeb web = site.OpenWeb();
        isMember = web.IsCurrentUserMemberOfGroup(web.Groups["GroupName"].ID);
        web.Close();
        site.Close();
        return isMember;
    } 
```

# .net - 如何从内存中的 Excel 工作表中填充 DataTable

> ID：325010
> 
> 赞同：1
> 
> 时间：2008-11-28T03:10:02.413
> 
> 标签：.net, excel, ado.net, automation

我们的客户端获取 Excel 的 HTML 格式的 Excel 文件。（它就是这样到达的；没有人可以控制它。）然后我们需要根据文件中的数据运行报告。使用 ADO.NET (OleDbReader) 会导致“外部文件不是预期格式”异常。

如果将数据转换为常规 Excel 格式，则可以正常读取。然而，这并不是一个真正的解决方案，因为它强加了他们必须采取的额外步骤，而且他们在最好的时候也不太懂计算机。

我能想出的唯一解决方案是使用 Excel 自动化创建一个新的电子表格，用相同的数据填充它，然后读取那个数据。但是 ADO.NET 似乎只能从磁盘上的文件中读取。我当然可以保存文件并在完成后删除它（我已经验证过它可以工作）。但是我对弄乱他们的文件系统的想法感到不舒服。所以我的第一个问题是 - 有没有办法从内存中的 Excel 工作表中填充数据表？

此外，我不喜欢使用自动化的整个业务；它非常慢。即使没有填充 DataTable，该操作也需要 30 多秒。因此，使其速度变慢的解决方案不会有任何好处。这让我想到了第二个问题——有没有更好的方法来完成我在这里尝试的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-25T20:41:48.173

试试 HTML 敏捷包： http: [//www.codeplex.com/htmlagilitypack](http://www.codeplex.com/htmlagilitypack)

我在类似的场景中使用它。在我的情况下：...

*   有人将 excel 中的表格粘贴到剪贴板中
*   检索 HTML 文本
*   使用 HTML Agility 返回找到 TABLE、TR、TH、TD 标签
*   然后从中构造 DataTable

在我的情况下，HTML 绝不会持久保存到磁盘

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T20:26:27.240

我不确定您所说的“Excel 的 HTML 格式”是什么意思。最新版本的 Excel 具有 XML 文件格式，我 Excel 可以打开包含表格的 HTML 文件并将其转换为工作表，但 Í 不知道任何特定的 Excel HTML 格式。

关于使用 Excel 自动化的解决方案，一旦内存中有工作表，就可以使用 Value2 属性将值放入对象的二维数组中，然后使用它来构建 DataTable。我认为这样做不会在使用自动化的初始开销（需要创建 Excel 进程）之上增加太多额外开销。

有没有更好的办法？解析任意 HTML 并非易事，但如果您收到的文件具有一致的格式，则可以解析它们。

# c# - JavaScriptSerializer C# 和泛型（我认为是新手错误！）

> ID：325020
> 
> 赞同：4
> 
> 时间：2008-11-28T03:26:39.667
> 
> 标签：c#

WinForms C#.. 正在获取以下格式的 JSON（消息底部）并尝试使用以下格式进行反序列化：

使用 System.Web.Script.Serialization；

当我简单地返回这个 json 时：

```
{
"objects": [
    {
        "categoryid": "1",
        "name": "funny",
        "serverimageid": "1",
        "dateuploaded": "2008-11-17 16:16:41",
        "enabled": "1"
    },
    {
        "categoryid": "2",
        "name": "happy",
        "serverimageid": "2",
        "dateuploaded": "2008-11-17 16:17:00",
        "enabled": "1"
    },
    {
        "categoryid": "3",
        "name": "sad",
        "serverimageid": "3",
        "dateuploaded": "2008-11-16 16:17:13",
        "enabled": "1"
    }
]
} 
```

然后很容易反序列化：（哎呀..有点hacky）

```
// s is the string
s = s.Remove(0, 11);
// last }
int stringLength = s.Length;
s = s.Remove(stringLength - 1, 1);

listOfCategories = serializer1.Deserialize<List<Category>>(s); 
```

在哪里

```
public class Category
    {
        public int categoryID;
        public string name;
        public int imageID;
        public DateTime dateUpdated;
        public int isActive;
        public int displayOrder;
    } 
```

然而现在，我被困住了！已经尝试了列表列表...但无法到达任何地方..

非常感谢任何帮助。

```
{
    "objects": {
        "categories": [
            {
                "name": "Congratulations",
                "imageID": "1",
                "isActive": "1",
                "displayOrder": "0",
                "dateUpdated": "2008-11-27 00:00:00"
            },
            {
                "name": "Animals",
                "imageID": "2",
                "isActive": "1",
                "displayOrder": "0",
                "dateUpdated": "2008-11-26 00:00:00"
            },
            {
                "name": "Romance",
                "imageID": "3",
                "isActive": "1",
                "displayOrder": "0",
                "dateUpdated": "2008-11-24 00:00:00"
            }
        ],
        "present": [
            {
                "presentID": "1",
                "name": "Tiger",
                "categoryID": "2",
                "imageID": "1",
                "dateUpdated": "2008-11-27",
                "isActive": "1",
                "isAnimated": null,
                "isInteractive": null,
                "isAdaptive": null,
                "webLinkURL": null
            },
            {
                "giphtID": "2",
                "name": "Donkey",
                "categoryID": "2",
                "imageID": "2",
                "dateUpdated": "2008-11-27",
                "isActive": "1",
                "isAnimated": null,
                "isInteractive": null,
                "isAdaptive": null,
                "webLinkURL": null
            },
            {
                "giphtID": "3",
                "name": "Elephant",
                "categoryID": "2",
                "imageID": "3",
                "dateUpdated": "2008-11-27",
                "isActive": "1",
                "isAnimated": null,
                "isInteractive": null,
                "isAdaptive": null,
                "webLinkURL": null
            }
        ]
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T05:24:15.047

这似乎工作正常（并且没有古怪的字符串修剪！）：

```
using System;
using System.Collections.Generic;
using System.Web.Script.Serialization;

class Program
{
    static void Main( string[] args )
    {
        string json = System.IO.File.ReadAllText( "../../input.json" );

        var serializer = new JavaScriptSerializer();
        Structure jsonStructure = serializer.Deserialize<Structure>( json );
        System.Diagnostics.Debugger.Break();
    }
}

class Structure
{
    public StructureObjects objects;
}

class StructureObjects
{
    public List<StructureCategory> categories;
    public List<StructurePresent> present;
}

class StructureCategory
{
    public string name;
    public int imageID;
    public DateTime dateUpdated;
    public int isActive;
    public int displayOrder;
}

class StructurePresent
{
    public int presentID;
    public string name;
    public int categoryID;
    public int imageID;
    public DateTime dateUpdated;
    public int isActive;
    public int? isAnimated;
    public int? isInteractive;
    public int? isAdaptive;
    public Uri webLinkURL;
} 
```

感谢 System.Web.Script.Serialization 指针，我永远不会发现！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T05:32:16.060

编辑：以下适用于`DataContractJsonSerializer`，但不适**用于**OP 中的 JavascriptSerializer。所以这个仅供参考。

```
[DataContract]
class Foo
{
    [DataMember(Name = "objects")]
    public Bar Bar { get; set; }
}

[DataContract]
class Bar
{
    public Bar() {
        Categories = new List<Category>();
        Present = new List<Present>();
    }
    [DataMember(Name = "categories")]
    public List<Category> Categories { get; private set; }
    [DataMember(Name = "present")]
    public List<Present> Present { get; private set; }
}
[DataContract]
class Category
{
    [DataMember(Name = "name")]
    public string Name {get;set;}
    [DataMember(Name = "imageID")]
    public int ImageID {get;set;}
    [DataMember(Name = "isActive")]
    public int IsActive {get;set;}
    [DataMember(Name = "displayOrder")]
    public int DisplayOrder {get;set;}
    [DataMember(Name = "dateUpdated")]
    public string DateUpdated {get;set;}
}
[DataContract]
class Present
{
    [DataMember(Name = "presentID")]
    public int PresentID {get;set;}
    [DataMember(Name = "name")]
    public string Name {get;set;}
    [DataMember(Name = "categoryID")]
    public int CategoryID {get;set;}
    [DataMember(Name = "imageID")]
    public int ImageID {get;set;}    
    [DataMember(Name = "dateUpdated")]
    public string DateUpdated {get;set;}
    [DataMember(Name = "isActive")]
    public int IsActive {get;set;}
    [DataMember(Name = "isAnimated")]
    public int? IsAnimated {get;set;}
    [DataMember(Name = "isInteractive")]
    public int? IsInteractive {get;set;}
    [DataMember(Name = "isAdaptive")]
    public int? IsAdaptive {get;set;}
    [DataMember(Name = "webLinkURL")]
    public string WebLinkUrl {get;set;}
} 
```

# windows - 访问网络共享

> ID：325029
> 
> 赞同：0
> 
> 时间：2008-11-28T03:56:07.097
> 
> 标签：windows, visual-c++, networking, share

我目前正在尝试使用 vc++ 6.0 以编程方式从我的机器访问网络共享。我正在使用 WNetAddConnection2 使用我的凭据连接到共享。

我面临以下问题：考虑有 2 个用户一个接一个地尝试从同一台机器访问同一个远程共享的情况。现在，一旦用户登录，其他用户将无法使用他的凭据登录共享，直到第一个用户注销。

此外，如果第一个用户登录到远程计算机的根共享，则其他用户无法访问该计算机上的任何其他共享。

请让我知道是否有任何解决方法。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-28T17:00:09.580

答案取决于第一个用户是否仍需要访问权限。如果没有，则调用 WNetCancelConnection2()。如果他们这样做了，Keith Brown 在他的“Programming Windows Security”一书中有一个技巧，即调用 LogonUser() 来建立一个新的登录会话，从而创建一个新的 SMB“端口”来避免冲突。模拟后，您的线程将能够使用不同的凭据进行连接。

# objective-c - 我的对象范围有问题吗？

> ID：325035
> 
> 赞同：0
> 
> 时间：2008-11-28T04:04:02.400
> 
> 标签：objective-c, cocoa, scope

这是我正在编写的程序（我自己而不是复制别人的，因此不学习）作为 ObjectiveC 和 Cocoa 学习曲线的一部分。我想在 NSView 上绘制简单的形状（现在限制为椭圆和矩形）。这个想法是我将每个 NSBezierPath 记录到一个 NSMutableArray 中，这样我还可以调查/实现保存/加载、撤消/重做。我有一个画布，可以在上面画画，还有 2 个用于选择工具的按钮。为了处理路径，我创建了另一个对象，该对象可以保存每个绘制对象的 NSBezierPath、颜色值和大小值。这就是我要存储在数组中的内容。我使用 mouseDown/Dragged/Up 来获取绘图路径的坐标。然而，这就是事情变得不稳定的地方。我可以实例化应该保存路径/颜色/等的对象。info 但是，当我尝试更改实例变量时，应用程序崩溃，调试器中没有有用的消息。我会尽量缩短我的代码片段，但如果我需要包含更多，请告诉我。代码也因为我尝试了很多事情来使它工作而退化了一点。

项目：基于 Cocoa 文档的应用程序
我有以下 .m/.h 文件

*   `MyDocument:NSDocument`- 由 XCode 生成
*   `DrawnObject:NSObject`- 处理绘制的对象，即路径、颜色、类型（椭圆/矩形）和大小
*   `Canvas:NSView`- 好吧，显示绘图，处理鼠标和按钮

Canvas 还负责维护`NSMutableArray`对象`DrawnObject`。

`DrawnObject.h`看起来像这样：

 `````
#import <Foundation/Foundation.h>
//The drawn object must know what tool it was created with etc as this needs to be used for generating the drawing

@interface DrawnObject : NSObject {
    NSBezierPath * aPath;
    NSNumber * toolType;//0 for oval, 1 for rectangular etc....
    float toolSize;
    struct myCol{
        float rd;
        float grn;
        float blu;
        float alp;
    } toolColor;
}

-(void)setAPath:(NSBezierPath *) path;
-(NSBezierPath *)aPath;
@property (readwrite,assign) NSNumber * toolType;
-(float)toolSize;
-(void)setToolSize:(float) size;
-(struct myCol *)toolColor;
-(void)setCurrentColor:(float)ref:(float)green:(float)blue:(float)alpha;

@end

```` 

``Canvas.h`看起来像这样`

 ````
＃进口
#import "drawnObject.h"

@界面画布：NSView {
    NSMutableArray * myDrawing;
    NSPoint 下点；
    NSPoint 当前点；
    NSBezierPath * viewPath;//显示用户拖动鼠标时的路径
    NSNumber * 当前工具类型；
    BOOL mouseUpFlag;//尝试不同的方式使其工作
    布尔鼠标拖动；
}

-（IBAction）useOval：（id）发件人；
-(IBAction)useRect:(id)sender;
-(IBAction)showTool:(id)sender;
-（NSRect）当前矩形；
-(NSBezierPath *)createPath:(NSRect) aRect;
-(void)setCurrentToolType:(NSNumber *) t;
-(NSNumber *)currentToolType;
@结尾

```

在`Canvas.m`文件中有几个函数来处理鼠标和 NSView/XCode 也放入了 `-(id)initWithFrame:(NSRect)frame`，`-(void)drawRect:(NSRect)rect`最初我`mouseUp`用来尝试将新`DrawnObject`的插入到数组中，但这导致了崩溃。所以，现在我使用两个`BOOL`标志来查看鼠标何时被释放（笨拙但我正在尝试......）`drawRect`插入到数组中。我已经包含了下面的方法，并指出了它导致应用程序失败的位置：

```
- (void)drawRect:(NSRect)rect { //这是自动调用的
    // 这里绘制代码。
    //NSLog(@"drawRect内工具类型为%d", [self currentTool]);
    NSRect 边界 = [自我边界];
    NSRect aRect = [self currentRect];
    viewPath = [self createPath:aRect];
//createPath 方法使用工具类型在椭圆和矩形贝塞尔曲线之间切换

    if(mouseUpFlag==YES && mouseDrag==YES){
        鼠标拖动=否；
        //在这里新建一个drawedObject
        DrawnObject * anObject = [[DrawnObject alloc]init];//- 工作正常到这里
        NSLog(@"创建新的 drawObject");
        [anObject setAPath:viewPath]; //- 应用程序立即死亡！！！！
        NSLog(@"在drawedObject中设置路径");
        [anObject setToolType:[[NSNumber alloc]initWithInt:5]];
        NSLog(@"在 DrawnObject 中设置 toolType");
        [anObject setToolType:currentToolType];

        [myDrawing addObject:anObject];
        NSLog(@"添加的对象");
    }   

    [[NSColor colorWithCalibratedRed:0.0 green:0.9 blue:0.0 alpha:0.5]set];
    [NSBezierPath fillRect:bounds];

    [[NSColor lightGrayColor]set];
    [视图路径描边]；//这是为了让用户可以看到正在绘制的位置

    //现在，在数组中绘制路径
    [[NSColor blueColor]set];
    for(DrawnObject * indexedObject in myDrawing){
        [[indexedObject aPath] stroke];//这将做所有对象的实际绘制

    }

}

```

我想这与对象范围或其他东西有关，但我就是想不通。正如我所说，当我尝试过一些事情时，代码已经发生了某种变化，遗憾的是不是更好。像那些 BOOLS 等。

**帮助！任何聪明的人，请指出我正确的方向！**

添加这个：

```
 -(NSBezierPath *)createPath:(NSRect) aRect
{

    NSBezierPath * tempPath;
    //I need to know what tool

    switch(0){  //temporary - this would use the toolType as a selector
        case 0:
            tempPath = [NSBezierPath bezierPathWithOvalInRect:aRect];
            break;
        case 1:
            tempPath = [NSBezierPath bezierPathWithRect:aRect];
            break;
        default:
            tempPath = [NSBezierPath bezierPathWithOvalInRect:aRect];
            break;
    }
    return tempPath;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T07:34:50.163

你说你的 init 方法是：

```
-(void)init {
[super init];
//set default color = black
toolColor.rd=1.0;
toolColor.grn=1.0;
toolColor.blu=1.0;
toolColor.alp=1.0;
//set default size
toolSize=0.8;
//set default toolType
toolType=0;
//oval
NSLog(@"Init %@",self);
} 
```

这***绝对***是错误的；阅读 Obj-C 指南中的如何创建 init 方法或阅读示例代码。它应该是这样的：

```
-(id)init {
if (self = [super init]) {
    //set default color = black
    toolColor.rd=1.0;
    toolColor.grn=1.0;
    toolColor.blu=1.0;
    toolColor.alp=1.0;
    //set default size
    toolSize=0.8;
    //set default toolType
    toolType=0;
    //oval
    NSLog(@"Init %@",self);
}
return self;
} 
```

通过不从 -init 返回任何内容，您正在阻止对象的创建。祝你好运！:-)

**编辑：**阿什利打败了我......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T04:41:30.263

它只是挂起。在调试器中，我看到：

```
  [会议开始于 2008-11-28 14:40:34 +1000。]
2008-11-28 14:40:36.157 CH18Challenge_try2[1893:10b] 鼠标按下 (80.000000,285.000000)
2008-11-28 14:40:36.333 CH18Challenge_try2[1893:10b] 鼠标在 (166.000000,217.000000)
2008-11-28 14:40:36.348 CH18Challenge_try2[1893:10b] 初始化
2008-11-28 14:40:36.349 CH18Challenge_try2[1893:10b] 创建了新的drawedObject

[会议开始于 2008-11-28 14:40:36 +1000。]
正在将程序加载到调试器中……
GNU gdb 6.3.50-20050815（Apple 版本 gdb-962）（2008 年 7 月 26 日星期六 08:14:40 UTC）
版权所有 2004 Free Software Foundation, Inc.
GDB 是自由软件，受 GNU 通用公共许可证保护，您是
欢迎在某些条件下更改和/或分发它的副本。
键入“显示复制”以查看条件。
GDB 绝对没有任何保证。键入“显示保修”以获取详细信息。
此 GDB 配置为“i386-apple-darwin”。程序已加载。
共享库应用加载规则全部
附加到程序：`/Users/johan_kritzinger/Documents/Cocoa/CH18Challenge_try2/build/Debug/CH18Challenge_try2.app/Contents/MacOS/CH18Challenge_try2'，进程 1893。
(gdb)

```

然后我必须强制退出来阻止它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T04:54:23.843

我们需要从 DrawnObject.m 中查看 setAPath 的实现。此外，对于调试器左上角的“堆栈跟踪”，它应该列出一堆函数，显示代码中崩溃的位置。确保您在调试模式下运行，而不是发布。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T06:05:10.720

在命令行上，您可以键入 print-object，然后可以在该行中设置断点并从那里逐步执行。似乎 setAPath 不知何故坏了

问候弗里德里希

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T04:26:47.690

“崩溃”是什么意思？

调试器控制台 (⇧⌘R) 中是否出现任何内容？

调试器窗口中是否出现堆栈跟踪？

如果有堆栈跟踪，它在您的代码中的哪个位置崩溃？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-29T07:31:33.637

你所拥有的不是崩溃。崩溃是指发出信号（如 EXC_BAD_ACCESS）或未捕获的异常。

你所拥有的似乎是一个无限循环。

您需要使用调试器中的暂停按钮并查看确切的位置。我猜你的 setAPath: 方法中有一个无限循环。你需要弄清楚为什么这个函数会无限循环。

# database - 我需要将邮政编码存储在数据库中。柱子应该有多大？

> ID：325041
> 
> 赞同：117
> 
> 时间：2008-11-28T04:15:03.670
> 
> 标签：database, oracle, globalization, postal-code

我希望该列在我的 Oracle 数据库中是 VARCHAR2。

美国邮编是 9。

加拿大7岁。

我认为 32 个字符是合理的上限

我错过了什么？

[编辑] TIL：12 是这个问题的合理答案感谢所有做出贡献的人。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-11-28T04:19:31.790

浏览[维基百科的邮政编码页面](http://en.wikipedia.org/wiki/Postal_codes)，32 个字符应该绰绰有余。我会说即使是16个字符也很好。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-03-26T14:13:31.480

正如@neil-mcguigan 已经提出的那样，维基百科在该主题上有一个不错的页面。基于这 12 个字符应该这样做：[http ://en.wikipedia.org/wiki/List_of_postal_codes](http://en.wikipedia.org/wiki/List_of_postal_codes)

维基百科文章列出了约 254 个国家，这对于[UPU（万国邮政联盟）](http://www.upu.int/en/the-upu/the-upu.html)有 192 个成员国来说相当不错。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-28T21:41:42.207

为什么要声明一个大于您期望存储在其中的实际数据的字段大小？

如果您的应用程序的初始版本将支持美国和加拿大地址（我从您在问题中指出这些大小的事实推断），我会将该字段声明为 VARCHAR2(9) （或 VARCHAR2( 10）如果您打算将连字符存储在 ZIP+4 字段中）。即使查看其他国家/地区的邮政编码的帖子，VARCHAR2(9) 或 VARCHAR2(10) 对于大多数（如果不是所有）其他国家/地区来说就足够了。

下线，如果需要，您可以随时更改列以增加长度。但通常很难阻止某人出于某种原因决定获得“创意”并将 50 个字符填充到 VARCHAR2(50) 字段中（即，因为他们希望在运输标签上再写一行）。您还必须处理边界情况的测试（每个显示 ZIP 的应用程序都会处理 50 个字符吗？）。事实上，当客户端从数据库中检索数据时，它们通常会根据将要获取的数据的最大大小而不是给定行的实际长度来分配内存。在这种特定情况下可能不是什么大问题，但在某些情况下，每行 40 个字节可能是相当大的 RAM 块。

顺便说一句，您还可以考虑分别存储（至少对于美国地址）邮政编码和 +4 扩展名。能够按地理区域生成报告通常很有用，并且您可能经常希望将所有内容放在一个邮政编码中，而不是通过 +4 扩展名将其分解。此时，不必尝试 SUBSTR 删除邮政编码的前 5 个字符是很有用的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-28T21:28:33.980

正常化？邮政编码可能不止一次使用，并且可能与街道名称或城镇名称有关。单独的表。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-28T06:12:04.950

您缺少的是您需要特别处理邮政编码的原因。

如果您真的不需要使用**邮政编码**，我建议您不要担心。通过工作，我的意思是对而不是仅仅用于打印地址标签等进行特殊处理。

只需创建三个或四个 VARCHAR2(50) [例如] 的地址字段，然后让用户输入他们想要的任何内容。

您真的**需要**按邮政编码对订单或交易进行分组吗？我认为不会，因为不同的国家在这个领域有非常不同的计划。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-28T04:18:53.930

加拿大邮政编码只有 6 个字符，采用字母和数字的形式 (LNLNLN)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-12-29T06:17:44.583

英国已发布标准：[英国政府数据标准目录](http://webarchive.nationalarchives.gov.uk/+/http://www.cabinetoffice.gov.uk/media/254290/GDS%20Catalogue%20Vol%202.pdf)

```
Max 35 characters per line 
```

国际邮政地址：

```
Minimum of 2 lines and maximum of 5 lines for the postal delivery point 
details, plus 1 line for country and 1 line for postcode/zip code 
```

英国邮政编码长度为：

```
Minimum 6 and Maximum 8 characters 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-09-07T13:01:27.873

如果您想在数据库中集成邮政编码，那么最好使用 geonames 数据库。尽管它很难使用和理解，但它是最大的地理数据库，可供像我们这样的用户免费使用。

所有其他此类数据库或多或少可能具有相同的数据和结构。他们只是从数据库中删除一些额外/冗余的信息。如果您只是为低负载系统使用它们的免费服务，那么限制很有吸引力，并且使用 json 和 ajax 提供更简单的界面。您可以在[此处查看限制](http://www.geonames.org/export/ "概述")

供您参考 varchar(20) 足以存储邮政编码

# regex - 尝试使用 Visual Studio IDE（查找和替换）作为快速而肮脏的正则表达式工具，但卡住了

> ID：325056
> 
> 赞同：0
> 
> 时间：2008-11-28T04:29:57.493
> 
> 标签：regex, ide, visual-studio-2005

我在 VS2005 IDE 中打开了一个 xml 文本文件。

它有 4 条模拟线：

```
<mc id="dog" name="mydogBob"/>
<mc id="cat" name="katie"/>
<mc id="turtle" name="slow"/>
<mc id="fish" name="happy"/> 
```

如何使用带有正则表达式的 VS2005 查找/替换函数来替换单词并使最终结果如下：

```
dog
cat
turtle
fish 
```

太感谢了

-西蒙

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-28T04:39:56.023

找什么：

```
^.*id="{.*}" .*$ 
```

用。。。来代替：

```
\1 
```

在查找选项中检查*使用*并从下拉列表中选择*正则表达式。*

# java - 如何向用户显示数组

> ID：325057
> 
> 赞同：0
> 
> 时间：2008-11-28T04:30:22.470
> 
> 标签：java, arrays

我正在尝试以 JTextField 之类的方式显示有序数组的内容。

```
for (int i=0; i<array.length; i++) {
    this.textField.setText(array[i]);
} 
```

这不起作用有两个原因。第一个次要原因：如果数组长度为 4，则 jtextfield 将其值重置 4 次，而不是将每个元素附加到最后一个元素上。第二个原因： JTextField 只接受字符串。我在 Swing 中找不到任何可以让我向用户显示整数的东西。有什么帮助吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-28T04:35:47.903

## 快速而肮脏的答案

```
for (int i=0; i<array.length; i++) {
    this.myJTextField.setText(this.myJTextField.getText() + ", " + array[i]);
} 
```

## 正确的方式

首先，调用成员变量`JTextField`可能并不明智。由于该类已被这样调用，因此会使读者感到困惑。Java 状态成员变量中的命名约定`myTextField`例如。（注意：原始问题已更改）。

### 用户定义格式

请注意，您也可以通过简单的操作将任何数字转换为字符串`"" + number`。如果您有很多字符串，请考虑使用字符串生成器，因为这样更快并且不会多次更新 GUI 元素：（还​​修复了`", "`第一个项目之前的初始值，这发生在上面）

```
StringBuilder builder = new StringBuilder();
for (int i=0; i<array.length; i++) {
    builder.append(array[i]));
    if(i + 1 != array.length) 
        builder.append(", ");
}
this.myJTextField.setText(builder.toString()); 
```

### 规范数组表示

或者，您可以使用这个：

```
this.myJTextField.setText(Arrays.toString(array)); 
```

它看起来像`[1, 4, 5, 6]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T04:35:37.390

您可以将所有这些整数连接成一个字符串，然后在文本字段中显示该值。

```
StringBuilder sb = new StringBuilder();
for( int i : array ) {  // <-- alternative way to iterate the array
     sb.append( i );
     sb.append( ", " );
}

sb.delete(sb.length()-2, sb.length()-1); // trim the extra ","
textField.setText( sb.toString() ); 
```

您也可以使用 JTextArea 代替文本字段。

# visual-sourcesafe - VSS 历史 - 排除标签

> ID：325061
> 
> 赞同：0
> 
> 时间：2008-11-28T04:35:14.240
> 
> 标签：visual-sourcesafe, history

在 VSS 的 GUI 中，可以查看项目“包括”或“排除”标签的历史记录。

我正在尝试做同样的事情，但从命令行但我看不到我需要使用哪个开关来“排除”标签（默认情况下它们包括在内）。

例如我正在运行：- ss.exe HISTORY -I- $/Source/Path/FileName.txt

为什么？我们有巡航控制设置，可以在每次成功构建时自动创建一个标签……所以有很多标签。当我运行上面的“获取历史记录”命令时，每个文件需要 20-30 秒，我想运行一个会命中每个文件的进程......

如果有人能告诉我我需要使用哪个开关（如果 GUI 允许您选择，它必须在那里？？）这将非常有帮助:-)

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T18:40:36.220

您可以按如下方式使用 -L 参数： ss.exe history -L ：仅显示历史标签 ss.exe history -L- ：显示不带标签的历史

# delphi - 虚拟字符串树中是否可以有多个标题行？

> ID：325073
> 
> 赞同：0
> 
> 时间：2008-11-28T04:52:18.543
> 
> 标签：delphi, virtualtreeview

我需要多个固定行作为虚拟字符串视图的标题 - 如果您将 a`StringGrid`的`FixedRows`属性设置为大于 1 的值，这看起来就像您得到的效果。有没有办法实现这一点？

在 Soft-Gems 网站和论坛上的一些搜索让我提到了虚拟字符串树上的一个`AdvancedHeaderDraw`方法和一个`HeaderQueryElements`属性，但我不知道如何使用它们。

我还找到了一个演示，用于`THeaderControls`实现类似的效果，但必须有一个更优雅的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T08:28:15.017

AFAIK 没有这样的内置功能。但是您可以尝试在[此页面](http://www.soft-gems.net/index.php/controls/virtual-treeview)上标记为“Virtual Treeview desc.（嵌套标题）”的 VT 后代。

**十年后的注意事项：**请注意，VT 的主页现在不在 Soft gems 上，而是在[JAM 软件](https://www.jam-software.de/virtual-treeview/index.shtml)上，但我在那里找不到相关下载。我也不知道后代是否仍然适用于当前的 VT 版本。

# wpf - 如何更改 RichTextBox 段落间距？

> ID：325075
> 
> 赞同：69
> 
> 时间：2008-11-28T04:54:41.003
> 
> 标签：wpf, richtextbox

我在 WPF 中使用 RichTextBox，并尝试将默认段落间距设置为 0（这样就没有段落间距）。虽然我可以在 XAML 中做到这一点，但如果可能的话，我想以编程方式实现它。有任何想法吗？

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2009-01-15T07:06:48.227

我**用风格**做到了（双关语缩进）

```
<RichTextBox  Margin="0,51,0,0" Name="mainTextBox" >
        <RichTextBox.Resources>
            <Style TargetType="{x:Type Paragraph}">
                <Setter Property="Margin" Value="0"/>
            </Style>
        </RichTextBox.Resources>
    </RichTextBox> 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-11-28T05:07:16.780

使用行高

```
RichTextBox rtb = new RichTextBox();    
Paragraph p = rtb.Document.Blocks.FirstBlock as Paragraph;    
p.LineHeight = 10; 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-11-28T05:31:08.713

关闭，所以你得到了积分。原来是设置边距，

```
p.Margin = new Thickness(0); 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2017-11-27T14:24:58.863

对我来说，WPF 中的 VS2017 可以这样工作：

```
 <RichTextBox HorizontalAlignment="Left" Height="126" Margin="10,280,0,0" VerticalAlignment="Top" Width="343" FontSize="14" Block.LineHeight="2"/> 
```

关键是**Block.LineHeight="2"**

您也可以在“属性”视图中找到它，但不能从那里更改低于 6 像素。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-11-28T23:31:02.640

```
RichTextBox rtb = new RichTextBox();
rtb.SetValue(Paragraph.LineHeightProperty, 1.0); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-05-06T13:25:22.227

```
<RichTextBox  Height="250" Width="500" VerticalScrollBarVisibility="Auto" TextWrapping="Wrap" IsReadOnly="True" >
    <Paragraph>
        XYZ
        <LineBreak />
    </Paragraph>
</RichTextBox> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-10-28T11:02:11.997

在 C# 2008 中

```
richtextbox1.SelectionCharOffset =
    -1 * ( Convert.ToInt32(R223.Txt_Space_Before.Text) * 100); 
```

或者

```
richtextbox1.SelectionCharOffset =
    Convert.ToInt32(R223.Txt_Space_Before.Text) * 100; 
```

可用于行间距。

这是获得行高间距的唯一方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-28T16:17:47.120

我知道这个问题是在我开始编码之前发布的，但我发现只需设置`ShowSelectedMargin`就可以`true`了

# asp.net - ASP.NET 中的 JSON Web 服务

> ID：325081
> 
> 赞同：1
> 
> 时间：2008-11-28T05:10:24.230
> 
> 标签：asp.net, ajax, json

如何创建返回 JSON 格式数据的 ASP.NET Web 服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T05:42:46.287

最重要的是要了解如何以 JSON 格式表示数据。请参阅[http://www.json.org/](http://www.json.org/) 了解更多信息。

一旦你理解了这一点，那么剩下的部分就很简单了。

请检查以下 URL 以获取相同的示例。

[http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=264](http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=264) [http://code.msdn.microsoft.com/JSONSampleDotNet](http://code.msdn.microsoft.com/JSONSampleDotNet)
[http://www.phdcc.com/xml2json.htm](http://www.phdcc.com/xml2json.htm)

我为此推荐 Jquery 库。它是一个轻量级的丰富库，支持调用 Web 服务，处理 json 数据格式输出等。

有关更多信息，请参阅 www.jquery.com。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T06:46:40.887

.NET 3.5 具有内置支持。对于 .NET 2.0，需要额外的库。我使用了 Jayrock 库。

我最近交付了一个在浏览器上使用纯 Javascript 的应用程序（即使用 AJAX 技术，但不使用 Microsoft AJAX 或 Scriptaculous 等），它在后端与 Microsoft webservices 结合使用。当我开始写这篇文章时，我是 .NET 世界的新手，并且对那里的所有框架感到不知所措！所以我有一种使用小型库而不是非常大的框架的冲动。

在 javascript 应用程序中，我调用这样的 Web 服务。它直接读取 Web 服务的输出，去掉非 JSON 部分，然后使用[https://github.com/douglascrockford/JSON-js/blob/master/json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)解析 JSON 对象。

这不是标准方法，但很容易理解，并且可能对您有价值，无论是使用还是只是学习 Web 服务和 JSON。

```
// enclosing html page has loaded this:
<script type="text/javascript" src="res/js/json2.js"></script> 

// Invoke like this:
// var validObj = = callAnyWebservice("WebServiceName", "");
//    if (!validObj || validObj.returnCode != 0) {
//      alert("Document number " + DocId + " is not in the vPage database. Cannot continue.");
//      DocId = null;
//    }

function callAnyWebservice(webserviceName, params) {
  var base = document.location.href;
  if (base.indexOf(globals.testingIPaddr) < 0) return;

  gDocPagesObject=null;

  var http = new XMLHttpRequest();
  var url = "http://mywebserver/appdir/WebServices.asmx/" + webserviceName;

  //alert(url + " " + params);

  http.open("POST", url, false);
  http.setRequestHeader("Host", globals.testingIPaddr);
  http.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
  http.setRequestHeader("Content-Length", params.length);
  // http.setRequestHeader("Connection", "close");
  //Call a function when the state changes.
  http.onreadystatechange = function() { 
    if (http.readyState == 4 ) {
      if (http.status == 200) {

        var JSON_text = http.responseText;

        var firstCurlyQuote = JSON_text.indexOf('{');
        JSON_text = JSON_text.substr(firstCurlyQuote);
        var lastCurlyQuote = JSON_text.lastIndexOf('}') + 1;
        JSON_text = JSON_text.substr(0, lastCurlyQuote);   

        if (JSON_text!="")
        {
            //if (DEBUG)
            //  alert(url+" " +JSON_text);
            gDocPagesObject = eval("(" + JSON_text + ")");
        }
      }
      else if (http.readyState == 4)
        {alert(http.readyState + " " + http.status + " " + http.responseText)}
    }
  }

  http.send(params);

  if (gDocPagesObject != null) {
    //alert(gDocPagesObject.returnCode + " " + gDocPagesObject.returnString);
    return gDocPagesObject;
  }
  else
    return "web service unavailable: data not ready"; 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T07:17:21.057

在我们的项目中，要求如下——服务器上的 ASP.NET 2.0，浏览器上的纯 Javascript（没有 JQuery 库或 .NET AJAX）

在这种情况下，在服务器端，只需将 webmethod 标记为使用 JSON。请注意，输入和输出参数都是 json 格式

```
[WebMethod]
[ScriptMethod(ResponseFormat = ResponseFormat.Json)]
public String Foo(String p1, String p2)
{
    return "Result: p1= " + p1 + " p2= " + p2;
} 
```

在 javascript 方面，使用常规 XmlHttpRequest 对象，确保将输入参数格式化为 JSON 并在输出参数上执行“评估”。

```
var httpobj = getXmlHttpRequestObject();

//Gets the browser specific XmlHttpRequest Object
function getXmlHttpRequestObject() 
{
    if (window.XMLHttpRequest) 
       return new XMLHttpRequest();
    else if(window.ActiveXObject) 
       return new ActiveXObject("Microsoft.XMLHTTP");
} 

CallService()
{
    //Set the JSON formatted input params
    var param = "{'p1' : 'value1', 'p2' : 'value2'}";

    //Send it to webservice
    if(httpobj.readyState == 4 || httpobj.readyState == 0)
    {
        httpobj.open("POST", 'service.asmx/' + 'Foo', true);
        //Mark the request as JSON and UTF-8
        httpobj.setRequestHeader('Content-Type','application/json; charset=utf-8');
        httpobj.onreadystatechange = OnSuccess;
        httpobj.send(param);
    }

}

OnSuccess()
{
   if (httpobj.readyState == 4) 
   {
      //Retrieve the JSON return param
      var response = eval("(" + httpobj.responseText + ")");
   }
} 
```

# ruby - 如何从 Ruby 检查具有特定 pid 的进程是否正在运行？

> ID：325082
> 
> 赞同：51
> 
> 时间：2008-11-28T05:11:57.520
> 
> 标签：ruby, process, pid

如果有不止一种方法，请列出它们。我只知道一个，但我想知道是否有一种更清洁的、在 Ruby 中的方式。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2010-08-25T16:43:41.193

`Process.getpgid`和方法之间的区别`Process::kill`似乎是当 pid 存在但由另一个用户拥有时会发生什么。`Process.getpgid`将返回答案，`Process::kill`将抛出异常`(Errno::EPERM)`。

基于此，我建议`Process.getpgid`，如果只是因为它使您不必捕获两个不同的异常。

这是我使用的代码：

```
begin
  Process.getpgid( pid )
  true
rescue Errno::ESRCH
  false
end 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2008-11-28T05:17:26.633

如果它是您希望“拥有”的进程（例如，您使用它来验证您控制的进程的 pid），您可以发送 sig 0 给它。

```
>> Process.kill 0, 370
=> 1
>> Process.kill 0, 2
Errno::ESRCH: No such process
    from (irb):5:in `kill'
    from (irb):5
>> 
```

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2008-11-28T05:23:57.027

@John T，@Dustin：实际上，伙计们，我仔细阅读了 Process rdocs，它看起来像

```
Process.getpgid( pid ) 
```

是应用相同技术的不那么暴力的方法。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2013-01-17T15:00:25.330

对于子进程，其他解决方案（如发送信号）不会按预期运行：它们将表明进程在实际退出时仍在运行。

如果你想检查你自己产生的进程，你可以使用[Process.waitpid 。](http://www.ruby-doc.org/core-1.9.3/Process.html#method-c-waitpid2)`Process::WNOHANG`如果您正在使用该标志，则该调用不会阻塞，并且`nil`只要子进程未退出，该调用就会返回。

例子：

```
pid = Process.spawn('sleep 5')
Process.waitpid(pid, Process::WNOHANG) # => nil
sleep 5
Process.waitpid(pid, Process::WNOHANG) # => pid 
```

如果 pid 不属于子进程，则会抛出异常 ( `Errno::ECHILD: No child processes`)。

这同样适用于[Process.waitpid2](http://www.ruby-doc.org/core-1.9.3/Process.html#method-c-waitpid2)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-09-10T23:44:28.787

这就是我一直在做的事情：

```
def alive?(pid)
  !!Process.kill(0, pid) rescue false
end 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-28T05:19:38.830

您可以尝试使用

```
Process::kill 0, pid 
```

其中 pid 是 pid 号，如果 pid 正在运行，它应该返回 1。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-01-03T11:35:56.183

Linux下使用proc文件系统可以获得很多运行程序的属性：

```
File.read("/proc/#{pid}/cmdline")
File.read("/proc/#{pid}/comm") 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-05T14:40:28.280

一种`*nix`-only 方法是`ps`检查并检查`\n`返回的字符串中是否存在（新行）分隔符。

***示例 IRB 输出***

```
1.9.3p448 :067 > `ps -p 56718`                                                          
"  PID TTY           TIME CMD\n56718 ttys007    0:03.38 zeus slave: default_bundle   \n" 
```

***打包为方法***

```
def process?(pid)  
  !!`ps -p #{pid.to_i}`["\n"]
end 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-08-05T18:11:06.133

我之前和昨天都处理过这个问题，我将它编译到“ [process_exists](https://github.com/wilsonsilva/process_exists) ”gem 中。

它将空信号 (0) 发送到具有给定 pid 的进程以检查它是否存在。即使当前用户没有将信号发送到接收进程的权限，它也可以工作。

用法：

```
require 'process_exists'

pid = 12
pid_exists = Process.exists?(pid) 
```

# javascript - 何时更喜欢 JSON 而不是 XML？

> ID：325085
> 
> 赞同：149
> 
> 时间：2008-11-28T05:14:50.663
> 
> 标签：javascript, jquery, xml, json

我的要求只是显示一组从数据库中检索到的值。我正在使用 jquery。

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2008-12-01T00:34:19.313

当以下任何一种情况为真时，优先使用 XML 而不是 JSON：

*   您需要消息验证
*   您正在使用 XSLT
*   您的消息包含大量标记文本
*   您需要与不支持 JSON 的环境进行互操作

当所有这些都为真时，优先使用 JSON 而不是 XML：

*   消息不需要验证，或者验证它们的反序列化很简单
*   你不是在转换消息，或者转换它们的反序列化很简单
*   您的消息主要是数据，而不是标记文本
*   消息传递端点具有良好的 JSON 工具

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2008-11-28T05:32:59.240

我使用 JSON，除非我需要使用 XML。它更容易理解，并且（因为它需要更少的配置开销）如果库在您的上下文中可用，那么读取和写入的编程会更容易，而且它们现在非常普遍。

当亚马逊第一次将他们的目录公开为一种网络服务时，他们同时提供了 JSON 和 XML。大约 90% 的实施者选择了 JSON。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-11-28T06:09:27.373

考虑到您已经在客户端执行 javascript 的特定情况，出于以下原因，我会使用 JSON：

*   由于 JSON 是 JavaScript 原生的，因此您必须在客户端编写更少的代码 - 只需`eval()`（或者，更好`JSON.parse()`的是）JSON 字符串并获取您可以使用的对象。

*   同时，在客户端评估 JSON 会更有效，因此也更快。

*   JSON 序列化生成的字符串比 XML 短。使用 JSON 将减少通过网络传输的数据量并提高这方面的性能。

这里有一些进一步的阅读：[http ://www.subbu.org/blog/2006/08/json-vs-xml](http://www.subbu.org/blog/2006/08/json-vs-xml)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-11T06:33:42.053

我在 XML vs JSON relm 中遇到的其他一些事情：

JSON 非常适合

*   名称/值对
*   嵌套这些对

这意味着它倾向于喜欢数组或嵌套数组。但是 JSON 都缺少

*   属性
*   命名空间

因此，如果您要组合两个或多个 JSON 服务，则可能存在潜在的命名空间冲突。话虽这么说，根据我的经验，在交换数据时，大约 90% 的事情都可以使用 JSON。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-11-28T06:45:33.150

通常 JSON 更紧凑，解析速度更快。

在以下情况下首选 XML：

*   您需要处理客户端上的数据，并且可以利用 XSL 来实现。XML + XSL 链的运行速度可能比 JSON + JavaScript 更快，尤其是对于大块数据。
    *   一个很好的案例是将数据转换为 HTML 片段。
*   各种遗留案例：
    *   有一个现有的 XML 服务，由于某些原因，用 JSON 重写它很麻烦。
    *   在使用用户输入进行一些轻量级处理后，您必须将此数据作为 XML 发布。

（几乎）XML 的一个重要案例：尝试检测何时发送 HTML 片段比发送原始数据更有益。[AHAH](http://en.wikipedia.org/wiki/Ahah)可以在简单的应用程序中创造奇迹，但经常被忽视。通常这种风格假定服务器发送 HTML 片段，这些片段将被内联到网页中而不进行处理。

通常在 AHAH 案例中，CSS 被最大限度地利用以可视化地按摩片段并实现简单的条件，例如使用特定于用户或特定于应用程序的设置隐藏/显示片段的相关部分。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-01-24T14:07:50.590

在客户端浏览器解析数据时必须执行的处理方面，JSON 总是更可取的。此外，JSON 是轻量级数据交换格式。

XML 解析总是消耗大量浏览器资源，除非另有要求，否则应尽可能避免。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-28T05:22:51.490

JSON 解析起来既简单又快捷。XML 更难解析，解析和传输也更慢（在大多数情况下）。

由于您使用的是 jQuery，我建议使用 JSON：jQuery 可以检索 JSON 数据并将其自动转换为 Javascript 对象。事实上，您可以[使用 eval 将 JSON 数据转换为 Javascript 对象](http://www.json.org/js.html)。XML 必须由您手动横向处理（我不知道这在 Javascript 中是如何工作的，但在我使用过 XML 库的大多数语言中它是困难的/更烦人的）。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2010-08-18T01:28:45.103

我有一篇关于该主题的博客文章，详细介绍了 Web 协议（即 SOAP、XML、JSON、REST、POX 等）的历史，提供了摘要以及每种协议的一些优点和缺点：[http ://www.servicestack.net /mythz_blog/?p=154](http://www.servicestack.net/mythz_blog/?p=154)

实际上，我认为您可以通过比较动态 (JSON) 和静态 (XML) 语言之间的差异来得出 XML 和 JSON 之间的许多相似之处。

基本上，XML 是一种更严格、更严格的序列化格式，可以选择使用随附的模式（XSD 或 DTD）进行验证。XSD 非常精细，允许您描述许多不同的类型，例如日期、时间、枚举、用户定义的类型甚至类型继承等。SOAP 有效地构建在 XML 功能集之上，提供了一种标准化的方式来描述您的 Web 服务（例如类型和操作）通过 WSDL。WSDL 规范的冗长和复杂意味着使用它进行开发可能会更加乏味，但同时有更多可用的工具可供您使用，并且大多数现代语言都提供了自动化工具来生成您的客户端代理，从而减轻了一些负担尝试与外部服务互操作时关闭。

如果您有一个定义明确且不受频繁更改影响的“企业服务”，或者您的 Web 服务需要从多种不同的语言访问，我仍然建议您将 XML 用于您的 Web 服务。

尽管 XML 具有所有优点，但也有缺点。它依赖命名空间来提供类型化的可扩展格式，并使您能够在同一文档中指定属性和元素。在一个文档中拥有不同的命名空间意味着在很多时候使用 Xml 解析器来提取数据时，您还需要提供要检索/遍历的每个元素的命名空间。它还推断有效负载，使其比需要的更详细。可以选择输出属性和元素意味着您的类不能很好地映射到 XML 文档。仅这些特性就使其不适用于大多数语言的编程，使其使用起来更加乏味和麻烦。

另一方面，JSON 在许多方面与 XML 完全相反，因为它的类型非常松散，并且仅对基本类型有简单的支持：数字、布尔值、字符串、对象和数组。其他一切本质上都必须放在一个字符串中。这在尝试跨语言边界进行通信时并不是很好，因为如果您想支持更具体的类型，您将需要遵守一些带外非标准规范。从好的方面来说，它有限的功能集可以很好地适应大多数语言 - 并且非常适合 JavaScript，因为 JSON 字符串可以直接**评估**为 JavaScript 对象。

**尺寸和性能**

我有一些[可用的 Northwind 数据库基准，](http://www.servicestack.net/benchmarks/NorthwindDatabaseRowsSerialization.100000-times.2010-08-17.html)比较 Microsoft 的 XML 和 JSON 实现之间的大小和速度。基本上 XML 的大小是 JSON 的 2 倍以上，但与此同时，微软似乎在优化他们的 XML DataContractSerializer 方面付出了很多努力，因为它比他们的 JSON 快 30% 以上。看来您必须在尺寸和性能之间进行权衡。对这个事实不满意，我决定编写自己的快速[JsonSerializer](http://www.servicestack.net/mythz_blog/?p=344)，它现在比 MS 的 XML 快 2.6 倍 - 两全其美 :)。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-11-28T12:46:08.590

如果我需要验证输入数据块，我会选择 XML 而不是 JSON，因为 XML 通过 XSD 原生支持这一点。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-07-14T08:33:51.097

[来自 JSON - 最后的脚](http://pragprog.com/magazines/2010-03/jsonthe-last--feet)

> 当您走 JSON 路线时，您会遇到 XML 10 年前面临的相同问题：
> 
> 将来自两个不同来源的数据混合到一个 JSON 数据包中可能会导致元素标签相互碰撞。将装箱单和发票混在一起，突然之间，发件人地址可能意味着完全不同的东西。这就是 XML 具有**名称空间**的原因。
> 
> 在不同的 JSON 结构之间进行转换需要编写普通代码。一种更具声明性的数据映射方式将使工作更容易。这就是 XML 具有**XSLT**的原因。
> 
> 描述 JSON 数据包的结构（其字段、数据类型等）对于人们连接到您的服务是必要的。为此拥有元数据语言至关重要。这就是 XML 有**Schemas**的原因。
> 
> 进行两个同时的客户端-服务器对话需要小心。如果你问服务器两个问题并得到一个答案，你怎么知道它回答了什么问题？这就是 XML 具有**WS-Correlation**的原因。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-28T05:22:40.570

JSON 是 javascript 的本机编码。它应该更快更容易使用。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-03-18T15:22:10.973

从[http://json.org/xml.html的第一行开始](http://json.org/xml.html)

> 可扩展标记语言 (XML) 是从标准通用标记语言 (SGML) 派生的文本格式。与 SGML 相比，XML 简单。相比之下，超文本标记语言 (HTML) 更加简单。即便如此，一本好的 HTML 参考书也只有一英寸厚。这是因为文档的格式化和结构化是一项复杂的业务。. . .

显然 JSON 更快，但更清楚的是它难以阅读。使用 JSON 来提高速度，如果需要人工交互，则使用 XML，您可以牺牲速度。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-28T05:46:18.027

我将 JSON 用于任何类型的配置、数据交换或消息传递。仅当出于其他原因或在语义上标记类似文档的数据时，我才使用 XML。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-29T10:04:26.097

Microsoft 支持 XML 和 JSON。XML 文字是 VB 9 中新的很酷的特性。在即将到来的 ASP.NET 4.0 版本中，必须使用 JSON 来利用客户端模板的强大功能。

从您提出的问题来看，似乎 JSON 可能是您的选择，因为无论是否使用 jQuery，它都很容易在客户端进行处理。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-04-23T09:57:09.413

使用 JSON

*   如果数据要由浏览器中的 JavaScript 使用。
*   数据模型简单而不复杂（复合对象太多）。

使用 XML

*   主要是在 SOA 类型的环境中，您在异构平台和技术上集成多个服务。
*   SOAP 的一个优点是它可以通过 HTTP 以外的不同协议进行传输。
*   易于在 XSLT、XSL-FO 等数据模型转换工具中使用。
*   许多数据库支持存储/查询（XQuery）XML 数据。
*   XML 是一种非常成熟的数据格式，因此您可以找到大量工具来支持您能想到的任何用例。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-08-20T00:45:00.913

我[在数字集市上发现这篇文章](http://digitalbazaar.com/2010/11/22/json-vs-xml/)非常有趣。

下面引用了文章的一些部分。

关于 JSON 专业人士：

> 如果你想要传递的只是原子值或原子值的列表或散列，JSON 具有 XML 的许多优点：它可以直接在 Internet 上使用，支持多种应用程序，很容易编写处理 JSON 的程序，它几乎没有可选功能，易于阅读且相当清晰，其设计正式而简洁，JSON 文档易于创建，并且使用 Unicode。...

关于 XML 专家：

> XML 非常好地处理了丰富的非结构化数据。我一点也不担心 XML 的未来，即使它的死亡被一群 Web API 设计人员兴高采烈地庆祝。
> 
> 我忍不住塞了一句“我早就告诉过你了！” 令牌在我的办公桌上。我期待看到 JSON 人员在被要求开发更丰富的 API 时会做什么。当他们想要交换结构不太好的数据时，他们会将其硬塞到 JSON 中吗？我看到偶尔提到 JSON 的模式语言，其他语言会跟随吗？...

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-12-18T18:50:32.020

**快速规则：**

*   **JSON：**程序到程序的数据格式
*   **YAML（JSON 超集）：**人机交互数据格式
*   **XML：**文档标记格式

**解释：**

JSON 的唯一作用是使用大多数编程语言常见的数据类型来序列化面向对象的数据：**列表**、**散列**和**标量**，为此，它确实无法被击败或改进。也就是说，“JSON 没有版本号 [as] 预计不会对 JSON 语法进行修订”。-[道格拉斯·克罗克福德](http://www.json.org/fatfree.html)（不能把它作为你完美工作的标志）

XML 曾经作为数据交换格式出售，但考虑两个最常见的用例：**异步客户端-服务器通信 (AJAX)** - JSON 几乎完全取代了 XML（X 应该真的是 J）和**Web 服务**: JSON 使 XML 成为一种多余的选择。

XML 被广泛使用的另一件事是用于程序的人类可写/可读（？）数据文件，但在这里你也有一个更简洁、更程序友好、更人性化的 YAML 格式，一个 JSON 超集。

因此，对于数据表示，JSON 全面胜过 XML。那么，XML 还剩下什么？混合内容文档表示，这正是它[的用途](http://seanmcgrath.blogspot.com/2007/01/mixed-content-trying-to-understand-json.html)。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-10-12T03:27:19.733

大多数较新的 Web 技术都使用 JSON，因此绝对是使用 JSON 的一个很好的理由。一个很大的优点是，在 XML 中，您可以用多种不同的方式表示相同的信息，而在 JSON 中则更直接。

JSON 恕我直言也比 XML 更清晰，这对我来说是一个明显的优势。如果您正在使用 .NET，那么 Json.NET 无疑是帮助您使用 JSON 的赢家。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-10-06T12:54:47.827

我在这里看到了一些偏见教条。似乎对于 xml 和仅来自 Web 开发的上下文（这对问题有意义）而言，对此的答案过于简化了，所以我认为 id 提供了一些额外的见解，以防万一有人越过这个问题并需要数据的答案其他情况下的序列化。

以下是硬性规定：

**XML 毫无疑问更强大。因此，当您的数据模型复杂到需要以下功能时，请使用它：**

1.  支持命名空间
2.  支持面向对象，即继承/多态
3.  支持复杂类型重用的包含和可扩展性。
4.  可靠、成熟和完整的模式验证系统所需的支持。
    *   w3c Schema Validation system 比 JSON Schema 更有能力，并且有更多的文献可以学习它。
5.  支持混合内容文档数据建模和记录，如数据建模。

**JSON 更易于学习、理解和使用。因此，当您没有时间学习 XML 并且不需要上述任何功能时，请使用它。如果这对您的用例很重要，它在电线上的重量也更轻。**

**TL:DR，** XML 可以做 json 可以做的所有事情，但更重。反过来根本不正确。是的，Json 更简单，因此使用得更多，但这并不意味着它可以取代 XML。就我今年 2020 年的情况而言，json 没有在我们的用例中脱颖而出，我们确实需要 XML。如果需要，我可以多谈。干杯和好运。

# java - Java Stackoverflow 错误

> ID：325086
> 
> 赞同：2
> 
> 时间：2008-11-28T05:15:13.190
> 
> 标签：java, stack-overflow

嗨，有时我在重新启动 sun 应用程序服务器 8.2 域后遇到此错误，有人知道可能是什么原因吗？

> javax.servlet.ServletException at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:255) at javax.servlet.http.HttpServlet.service(HttpServlet.java:860) at sun.reflect.GeneratedMethodAccessor156.invoke( Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:585) at org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil .java:249) 在 java.security.AccessController.doPrivileged(Native Method) 在 javax.security.auth.Subject.doAsPrivileged(Subject.java:517) 在 org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java :282) 在 org.apache.catalina.core.ApplicationFilterChain 的 org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:165)。internalDoFilter(ApplicationFilterChain.java:257) at org.apache.catalina.core.ApplicationFilterChain.access$000(ApplicationFilterChain.java:55) at org.apache.catalina.core.ApplicationFilterChain$1.run(ApplicationFilterChain.java:161) at java .security.AccessController.doPrivileged(Native Method) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157) at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:723) at org .apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:484) 在 org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:417) 在 org.apache.catalina.core.ApplicationDispatcher.access$000( ApplicationDispatcher.java:80) 在 org.apache.catalina.core.ApplicationDispatcher$PrivilegedForward。在 org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:313) 在 org.apache.catalina.core.StandardHostValve 的 java.security.AccessController.doPrivileged(Native Method) 运行(ApplicationDispatcher.java:95)。 custom(StandardHostValve.java:448) at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:339) at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:282) at org.apache .catalina.core.StandardHostValve.postInvoke(StandardHostValve.java:184) 在 org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:552) 在 org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java :132) org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:551) org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:933) 在 org.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:189) 在 com.sun.enterprise.web.connector.grizzly.ProcessorTask.doProcess(ProcessorTask.java:604) 在 com.sun .enterprise.web.connector.grizzly.ProcessorTask.process(ProcessorTask.java:475) 在 com.sun.enterprise.web.connector.grizzly.ReadTask.executeProcessorTask(ReadTask.java:371) 在 com.sun.enterprise.web .connector.grizzly.ReadTask.doTask(ReadTask.java:264) 在 com.sun.enterprise.web.connector.grizzly.TaskBase.run(TaskBase.java:281) 在 com.sun.enterprise.web.connector.grizzly .WorkerThread.run(WorkerThread.java:83)----- 根本原因-----java.lang.StackOverflowError at java.security.AccessController.doPrivileged(Native Method) at com.sun.security.auth.PolicyFile .getPermissions(PolicyFile.java:818) 在 javax.security.auth。SubjectDomainCombiner$3.run(SubjectDomainCombiner.java:357) at java.security.AccessController.doPrivileged(Native Method) at javax.security.auth.SubjectDomainCombiner.combineJavaxPolicy(SubjectDomainCombiner.java:353) at javax.security.auth.SubjectDomainCombiner.combine (SubjectDomainCombiner.java:191) 在 java.security.AccessControlContext.goCombiner(AccessControlContext.java:390) 在 java.security.AccessControlContext.optimize(AccessControlContext.java:304) 在 java.security.AccessController.checkPermission(AccessController.java: 426) 在 java.lang.SecurityManager.checkPermission(SecurityManager.java:532) 在 java.security.Security.getProperty(Security.java:724) 在 com.sun.security.auth.PolicyFile.initPolicyFile(PolicyFile.java:356 ) 在 com.sun.security 的 com.sun.security.auth.PolicyFile.init(PolicyFile.java:269)。auth.PolicyFile.getPermissions(PolicyFile.java:869) 在 com.sun.security.auth.PolicyPermissions.init(PolicyFile.java:1416) 在 com.sun.security.auth.PolicyPermissions.elements(PolicyFile.java:1429)在 javax.security.auth.SubjectDomainCombiner.combineJavaxPolicy(SubjectDomainCombiner.java:366) 在 javax.security.auth.SubjectDomainCombiner.combine(SubjectDomainCombiner.java:191)

… 无限期

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T05:18:47.147

[无限递归。](http://en.wikipedia.org/wiki/Infinite_recursion#Infinite_recursion)

这从您漫长的、重复的回溯中可以看出。[您收到堆栈溢出](http://en.wikipedia.org/wiki/Stack_buffer_overflow)错误的事实也支持这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-14T12:17:08.983

我的猜测是您的安全策略正在触发无限递归操作。虽然似乎没有涉及任何应用程序代码，所以很难确定。重复部分是否总是在对 SubjectDomainCombiner 的调用之间有界？

您可以做的一件事是确认它确实是一个*无限*递归问题，那就是增加堆栈大小。您应该会看到循环部分在崩溃时展开以填充剩余空间。否则，您只是在堆栈上运行不足......它确实会发生，尤其是当您已经从应用程序服务器框架本身获得 30 或 40 帧时。

默认堆栈大小为 256k。

您可以通过应用 JVM 参数来增加它，例如`-Xss2M`获得 2MB 的堆栈。

这样做只是为了确认问题，而不是作为永久解决方案。

# jquery - 将 jQuery 集转换为 HTML

> ID：325087
> 
> 赞同：8
> 
> 时间：2008-11-28T05:15:19.430
> 
> 标签：jquery

给定一个 jQuery 结果集，如何将其转换回纯 HTML？

```
<div class="abc">
    foo <strong>FOO</strong>
</div>
<div class="def">
    bar
</div> 
```

--

```
var $mySet = $('div'); 
```

鉴于`$mySet`，您将如何返回到上面的纯 HTML？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-28T06:18:50.333

我建议创建一个临时容器，然后抓住`html()`那个新容器：

```
var html = $('<div>').append( $('div').clone() ).html();
alert(html);

// alerts:

<div class="abc">
    foo <strong>FOO</strong>
</div><div class="def">
    bar
</div> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-10T15:03:06.363

如果您的集合恰好包含一个项目，您可以使用 ye olde Javascript：

```
var html = $mySet[0].outerHTML; // note HTML is all caps... that always burns me 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T19:16:49.580

也许您想要的是客户端模板引擎。查看[使用 jQuery 进行客户端模板化的帖子](http://www.west-wind.com/weblog/posts/509108.aspx)

我正在使用它，它非常酷。您只需在 div 中设置要使用的模板，然后使用 json 对象/数组来提供它，就是这样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T05:17:44.700

```
var $mySet = $('div');
var html = $mySet.html(); 
```

如果您还想要元素的 HTML（未经测试）：

```
var $mySet = $('div');
var html = $mySet.clone().wrap('<div></div>').html(); 
```

顺便说一句，这里 $ 是变量名的一部分。Javascript 不需要像 PHP 中的 $ 作为变量名，但拥有它并没有什么坏处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T06:09:07.780

使用 jQuery [appendTo](http://docs.jquery.com/Manipulation/appendTo#selector)方法，如果我理解你所说的“返回到上面的纯 HTML”是什么意思。

# ruby-on-rails - 检测访问我网站的公司名称

> ID：325099
> 
> 赞同：2
> 
> 时间：2008-11-28T05:24:27.697
> 
> 标签：ruby-on-rails, ruby, web-services

我想在公司名称中使用访客 IP 地址。这将用于显示诸如“Hello visitor from **Apple Inc.** ”之类的内容。注意我正在寻找公司名称，而不是域名。确定原产国的加分。该应用程序是用 Ruby on Rails 编写的，但其他语言的示例也可以。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-28T05:26:10.313

这类事情有数据库，但它们几乎不是 100% 准确的，所以在使用它们对您呈现给访问者的内容做出假设之前，我会考虑很长时间。如果您仍然想这样做，这里有两家公司提供包含组织级别详细信息的数据库：

[http://www.maxmind.com/app/ip-location](http://www.maxmind.com/app/ip-location)
[http://www.ip2location.com/](http://www.ip2location.com/)

根据其他答案进行编辑以澄清：

这些供应商的数据库中的组织级别详细信息与其他人所指的 ISP 信息不同。上述供应商的数据库实际上是根据研究分配的组织信息，而不是对 IP 所有权的反向查找。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-28T05:28:15.787

首先，要知道这通常是不可能的——例如，许多人的连接将来自 Insight、Comcast 或任何他们的 ISP。如果您将我视为“来自”Insight Broadband，我不确定您想要的功能是否那么时髦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T05:27:39.937

你很可能得到这个错误多于正确，但你可以从 whois 客户那里得到这个。

例如，要查看美国地址的所有者（至少），您可以从 CLI 中使用 whois：

```
whois -h whois.arin.net 17.18.19.20 
```

# crystal-reports - 如何将报表从 Crystal Reports 迁移到 Business Objects Enterprise

> ID：325106
> 
> 赞同：1
> 
> 时间：2008-11-28T05:34:02.250
> 
> 标签：crystal-reports

如何将报表从 Crystal Reports 迁移到 Business Objects Enterprise？

有没有人有任何想法、建议或建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-19T19:06:00.113

与其说是部署，不如说是迁移。

在 Crystal Reports 中，选择文件 | 另存为...，单击企业快捷方式，选择所需文件夹并单击保存。

您还可以通过 InfoView 和 CMC 应用程序向 BOE 添加报告。

# java - 在Java中访问没有顶级类的非顶级类

> ID：325114
> 
> 赞同：0
> 
> 时间：2008-11-28T05:47:45.823
> 
> 标签：java, compiler-construction, jvm, classloader

我有一个 Java 文件`TestThis.java`，如下所示：

```
class A
{
    public void foo() 
    {
        System.out.println("Executing foo");
    }
}

class B
{
    public void bar()
    {
        System.out.println("Executing bar");
    }
} 
```

上面的代码文件编译良好，没有任何警告/错误。有什么方法可以访问任何课程`A`或`B`没有任何其他外部课程的顶级课程？

如果不是，那么为什么 Java 甚至允许在没有顶级类的情况下编译此类文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-28T05:55:29.100

像往常一样（例如，从 Test.java 访问）：

```
public class Test {
    public static void main(String... args) {
        A a = new A();
        a.foo();
        B b = new B();
        b.bar();
    }
} 
```

The rule here is that you could not have more than one public class in the source file. If you have one, the filename must match this public class name. Otherwise (your case), you can name your file as you wish. Other, non-public classes, will be package-visible and you can access them as usual.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T05:54:32.630

同一个包中的任何其他类都可以访问A和B；在这种情况下，将使用空包，因为源文件不存在包语句。

# php - 如何将英制长度单位转换为公制？

> ID：325116
> 
> 赞同：3
> 
> 时间：2008-11-28T05:51:04.133
> 
> 标签：php, regex, code-snippets

在这里，我面临一个我相信（或至少希望）已经解决了 100 万次的问题。我作为输入得到的是一个字符串，它以英制单位表示对象的长度。它可以是这样的：

```
$length = "3' 2 1/2\""; 
```

或像这样：

```
$length = "1/2\""; 
```

或者实际上我们通常会以任何其他方式编写它。

为了减少全球车轮发明，我想知道是否有一些函数、类或正则表达式允许我将英制长度转换为公制长度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T07:55:12.090

Zend 框架有一个用于此目的的测量组件。我建议你检查一下 -[在这里](http://framework.zend.com/manual/en/zend.measure.html)。

```
$unit = new Zend_Measure_Length($length,Zend_Measure_Length::YARD);
$unit -> convertTo(Zend_Measure_Length::METER); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T06:58:56.680

这是我的解决方案。它使用[eval()](http://php.net/eval)来评估表达式，但不用担心，最后的正则表达式检查使其完全安全。

```
function imperial2metric($number) {
    // Get rid of whitespace on both ends of the string.
    $number = trim($number);

    // This results in the number of feet getting multiplied by 12 when eval'd
    // which converts them to inches.
    $number = str_replace("'", '*12', $number);

    // We don't need the double quote.
    $number = str_replace('"', '', $number);

    // Convert other whitespace into a plus sign.
    $number = preg_replace('/\s+/', '+', $number);

    // Make sure they aren't making us eval() evil PHP code.
    if (preg_match('/[^0-9\/\.\+\*\-]/', $number)) {
        return false;
    } else {
        // Evaluate the expression we've built to get the number of inches.
        $inches = eval("return ($number);");

        // This is how you convert inches to meters according to Google calculator.
        $meters = $inches * 0.0254;

        // Returns it in meters. You may then convert to centimeters by
        // multiplying by 100, kilometers by dividing by 1000, etc.
        return $meters;
    }
} 
```

例如，字符串

```
3' 2 1/2" 
```

转换为表达式

```
3*12+2+1/2 
```

被评估为

```
38.5 
```

最终转换为 0.9779 米。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-21T15:31:01.667

英制字符串值有点复杂，所以我使用了以下表达式：

```
string pattern = "(([0-9]+)')*\\s*-*\\s*(([0-9])*\\s*([0-9]/[0-9])*\")*";
Regex regex = new Regex( pattern );
Match match = regex.Match(sourceValue);
if( match.Success ) 
{
    int feet = 0;
    int.TryParse(match.Groups[2].Value, out feet);
    int inch = 0;
    int.TryParse(match.Groups[4].Value, out inch);
    double fracturalInch = 0.0;
    if (match.Groups[5].Value.Length == 3)
         fracturalInch = (double)(match.Groups[5].Value[0] - '0') / (double)(match.Groups[5].Value[2] - '0');

    resultValue = (feet * 12) + inch + fracturalInch; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-28T06:02:56.137

也许查看[单位库](http://units.sourceforge.net/)？不过，它似乎没有 PHP 绑定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-28T06:04:09.317

正则表达式看起来像这样：

```
"([0-9]+)'\s*([0-9]+)\"" 
```

（其中 \s 代表空格 - 我不确定它在 php 中是如何工作的）。然后你提取第一+第二组并做

```
(int(grp1)*12+int(grp2))*2.54 
```

转换为厘米。

# objective-c - Cocoa 中打开的读取流上的 Posix 错误 14（错误地址）。提示？

> ID：325122
> 
> 赞同：1
> 
> 时间：2008-11-28T05:55:56.713
> 
> 标签：objective-c, cocoa, networking

我正在关注*CFNetwork Programming Guide*中的示例代码，特别是有关**使用 Streams 时防止阻塞**的部分。我的代码与他们的代码几乎相同（如下），但是，当我连接到我的服务器时，我收到 posix 错误 14（错误地址 - 是错误的 IP 地址（除非不是）？我拨打的某些电话的内存地址错误？或什么？！。

我不知道如何进行调试。我对整个 CFNetworking 的东西真的很陌生，而且从一开始就不是特别擅长网络（我真正喜欢 Java 的一件事：简单的网络！:D）

无论如何，日志如下，代码如下。任何提示将不胜感激。

日志：

```
[6824:20b] [DEBUG] Compat version: 30000011
[6824:20b] [DEBUG] resovled host.
[6824:20b] [DEBUG] writestream opened.
[6824:20b] [DEBUG] readstream client assigned.
[6824:20b] [DEBUG] readstream opened.
[6824:20b] [DEBUG] *** Read stream reported kCFStreamEventErrorOccurred
[6824:20b] [DEBUG] *** POSIX error: 14 - Bad address
[6824:20b] Error closing readstream
[6824:20b] [DEBUG] Writing int: 0x09000000 (0x00000009) 
```

代码：

```
+ (BOOL) connectToServerNamed:(NSString*)name atPort:(int)port {
    CFHostRef theHost = CFHostCreateWithName (NULL, (CFStringRef)name);
    CFStreamError error;

    if (CFHostStartInfoResolution (theHost, kCFHostReachability, &error))
    {
        NSLog (@"[DEBUG] resovled host.");
        CFStreamCreatePairWithSocketToCFHost (NULL, theHost, port, &readStream, &writeStream);
        if (CFWriteStreamOpen(writeStream))
        {
            NSLog (@"[DEBUG] writestream opened.");

            CFStreamClientContext myContext = { 0, self, NULL, NULL, NULL };
            CFOptionFlags registeredEvents = kCFStreamEventHasBytesAvailable |
                    kCFStreamEventErrorOccurred | kCFStreamEventEndEncountered;
            if (CFReadStreamSetClient (readStream, registeredEvents, readCallBack, &myContext))
            {
                NSLog (@"[DEBUG] readstream client assigned.");
                CFReadStreamScheduleWithRunLoop(readStream, CFRunLoopGetCurrent(),
                                                kCFRunLoopCommonModes);
                if (CFReadStreamOpen(readStream))
                {
                    NSLog (@"[DEBUG] readstream opened.");
                    CFRunLoopRun();
         // Lots of error condition handling snipped.
        [...]
    return YES;
}

void readCallBack (CFReadStreamRef stream, CFStreamEventType event, void *myPtr)
{
    switch (event)
    {
        case kCFStreamEventHasBytesAvailable:
        {
            CFIndex bytesRead = CFReadStreamRead(stream, buffer, kNetworkyBitsBufferSize); // won't block
            if (bytesRead > 0)                                                  // <= 0 leads to additional events
            {
                if (listener)
                {
                    UInt8 *tmpBuffer = malloc (sizeof (UInt8) * bytesRead);
                    memcpy (buffer, tmpBuffer, bytesRead);
                    NSLog(@"[DEBUG] reveived %d bytes", bytesRead);
                    [listener networkDataArrived:tmpBuffer count:bytesRead];
                }
                NSLog(@"[DEBUG] reveived %d bytes; no listener", bytesRead);
            }
        }
            break;

        case kCFStreamEventErrorOccurred:
            NSLog(@"[DEBUG] *** Read stream reported kCFStreamEventErrorOccurred");
            CFStreamError error = CFReadStreamGetError(stream);
            logError(error);
            [NetworkyBits shutDownRead];
            break;

        case kCFStreamEventEndEncountered:
            NSLog(@"[DEBUG] *** Read stream reported kCFStreamEventEndEncountered");
            [NetworkyBits shutDownRead];
            break;
    }
}

void logError (CFStreamError error)
{
    if (error.domain == kCFStreamErrorDomainPOSIX)                              // Interpret error.error as a UNIX errno.
    {
        NSLog (@"[DEBUG] *** POSIX error: %d - %s", (int) error.error, strerror(error.error));
    }
    else if (error.domain == kCFStreamErrorDomainMacOSStatus)
    {
        NSLog (@"[DEBUG] *** MacOS error: %d", (int) error.error);
    }
    else
    {
        NSLog (@"[DEBUG] *** Stream error domain: %d, error: %d", (int) error.error);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T06:42:10.350

奥利，在哪里

```
buffer 
```

你提供给

```
CFReadStreamRead() 
```

来自？EFAULT 是一个错误的缓冲区地址......你确定你已经初始化了这个缓冲区以指向有效的东西吗？这显然是一个全球性的或某个时候......这本身就是一个非常糟糕的主意。你应该在你的函数中分配它或者它应该是一个 ivar（如果你使用的是 Obj-C）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T06:08:08.560

我不熟悉 Cocoa 或 Objective-C，但我可以告诉您 POSIX 错误代码 14 称为[EFAULT](http://www.wlug.org.nz/EFAULT)，这意味着您使用无效指针值进行了系统调用。这几乎可以肯定是一些用户提供的缓冲区指针，指向某种读或写系统调用。检查所有缓冲区指针并确保它们不为 NULL。检查返回值`malloc()`- 您可能无法分配缓冲区。

# database - 存储少量图像：blob 还是 fs？

> ID：325126
> 
> 赞同：9
> 
> 时间：2008-11-28T06:02:38.913
> 
> 标签：database, image, blob

我正在向我的网站添加一些功能，以便用户可以上传自己的个人资料图片，所以我想知道是将它们作为 BLOB 存储在数据库中，还是将它们放在文件系统中。

我在这里发现了一个与此类似的问题：[Storing images in DB: Yea or Nay](https://stackoverflow.com/questions/3748/storing-images-in-db-yea-or-nay)，但给出的答案更适合人们期待成千上万甚至数百万张图像，而我更关心小图像（JPEG 最高可能是 150x150 像素），并且数量很少：可能最多一两千。

**对于这种情况，DB BLOB 与文件系统有何感受？**客户端如何从数据库缓存图像与从文件系统缓存图像？

如果存储在数据库中的 BLOB 是要走的路 - 我应该知道在*哪里*存储它们吗？由于我认为我的大多数用户不会上传图片，我是否应该在需要时创建一个`user_pics`表以（外部）加入常规`users`表？

* * *

编辑：我重新打开这个问题，因为它*不是*你链接到的那两个的重复。这个问题专门针对少量图像使用 DB 或 FS 的优缺点。正如我上面所说，另一个问题是针对需要存储成千上万张大图像的人。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-28T06:14:25.100

要回答您的部分问题：

> 客户端如何从数据库缓存图像与从文件系统缓存图像？

对于数据库：在数据库中有一个 last_modified 字段。使用 Last-Modified HTTP 标头，以便客户端的浏览器可以正确缓存。当浏览器请求图像“如果较新”时，请务必发送适当的响应（不记得它叫什么；一些 HTTP 请求标头）。

对于文件系统：做同样的事情，但文件的修改时间。

> 如果存储在数据库中的 BLOB 是要走的路 - 我应该知道在哪里存储它们吗？由于我认为我的大多数用户不会上传图片，我是否应该创建一个 user_pics 表以在需要时（外部）加入常规用户表？

我会将 BLOB 和相关元数据放在它自己的表中，并在它与您的用户表之间存在某种关系。这样做会更容易优化数据的表存储方法，使事情更整洁，并为可扩展性留出空间（例如，一般的“文件”表）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T08:37:40.990

我曾经遇到过一个用于 pdf 文件的小型 DMS 的类似问题。该场景与您的不同：最多可能有 100 个文件，每个文件大小不超过 10 MB - 这不是您对个人资料图片的期望。但是当时朋友给我的答案也适用于您的情况：

> 将每个存储系统用于其设计用途。
> 
> 将*数据*存储在*数据库*中。*将文件*存储在*文件系统中*。

这不是最终的答案（*），但它是初学者的一个很好的经验法则。

正如 Aaron Digulla 在他的回答中所说，我从未听说过 Windows FS 速度慢，有时甚至不可靠。如果有这样的问题，这当然需要考虑。但对于头像图片，我觉得它并不重要。

(*) 我知道，我知道，42...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-09-27T05:24:00.807

DB 针对延迟、事务等进行了优化。

图像存储针对读取延迟、存储成本等进行了优化。

Blob 存储非常适合存储数百万张图像。我在 SeaweedFS 上工作。它基于 Facebook 存储用户照片的设计。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T06:05:34.900

从服务他们的角度，编写服务他们的代码，备份程序等，什么会更方便？你想给自己正确的答案，而不是给别人的正确答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T06:57:04.873

从我的角度来看，任何可能留在数据库之外的东西都应该留在外面。它可能是您不会每天复制或备份的文件系统或单独的表。它使数据库更轻巧，增长更慢，更易于理解和维护。

如果您使用的是 MSSQL，请确保 blob 存储在单独的数据文件中。不像其他一切一样在初级。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T08:08:07.383

在 Windows 上，尽可能多地放入数据库中。文件系统有点慢，有时甚至不可靠。

在 Linux 上，您有更多选择。在这里，您应该考虑将大文件移动到文件系统中，并将名称保留在数据库中。如果您使用像 Ext3 或 ReiseFS 这样的现代文件系统，您甚至可以创建许多性能相当不错的小文件。

您还需要考虑如何访问数据。如果您拥有数据库中的所有内容，则您有一个访问路径，无需担心另一组权限，但您必须处理读取/写入 BLOB 的额外复杂性。在许多数据库中，无法搜索 BLOB。

在文件系统上，您可以对您的数据运行其他工具，如果文件存储在数据库中，这是不可能的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-15T22:39:27.257

我会将它们存储在数据库中：

1.  备份/恢复很容易（如果你备份文件和数据库，时间点恢复更复杂）
2.  数据库中的事务意味着您永远不应最终指向不存在的文件名
3.  不太可能有人会想出一种偷偷摸摸的方法，通过狡猾的图像上传黑客将脚本放到您的服务器上

由于您谈论的是少量图像，因此易用性/管理应该优先于链接问题中争论的性能问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-15T23:00:49.513

我认为将它们存储在数据库中具有可管理性的优势。它们可以与其他数据一致地备份和恢复 - 您不会忘记删除过时的数据（嗯，您可能会，但可能性较小），如果您将数据库迁移到另一台机器，图像会随它。

# c# - 使用仅在执行时已知的类型参数调用泛型方法

> ID：325156
> 
> 赞同：131
> 
> 时间：2008-11-28T06:28:55.647
> 
> 标签：c#, linq, generics, reflection

编辑：

当然，我的真实代码看起来并不完全像这样。我尝试编写半伪代码以更清楚地说明我想要做什么。

看起来它只是把事情搞砸了。

所以，我真正想做的是：

```
Method<Interface1>();
Method<Interface2>();
Method<Interface3>();
... 
```

嗯......我想也许我可以用反射把它变成一个循环。所以问题是：我该怎么做。我对反射的了解*很*浅。所以代码示例会很棒。

场景如下所示：

```
public void Method<T>() where T : class
{}
public void AnotherMethod()
{
    Assembly assembly = Assembly.GetExecutingAssembly();

    var interfaces = from i in assembly.GetTypes()
    where i.Namespace == "MyNamespace.Interface" // only interfaces stored here
    select i;

    foreach(var i in interfaces)
    {
        Method<i>(); // Get compile error here!
    } 
```

* * *

原帖：

你好！

我正在尝试遍历命名空间中的所有接口，并将它们作为参数发送给这样的通用方法：

```
public void Method<T>() where T : class
{}
public void AnotherMethod()
{
    Assembly assembly = Assembly.GetExecutingAssembly();

    var interfaces = from i in assembly.GetTypes()
    where i.Namespace == "MyNamespace.Interface" // only interfaces stored here
    select i;

    foreach(var interface in interfaces)
    {
        Method<interface>(); // Get compile error here!
    }
} 
```

我得到的错误是“需要类型名称，但找到了局部变量名称”。如果我尝试

```
...
    foreach(var interface in interfaces)
    {
        Method<interface.MakeGenericType()>(); // Still get compile error here!
    }
} 
```

我得到“无法将运算符'<'应用于'方法组'和'System.Type'类型的操作数”关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2008-11-28T06:34:34.280

编辑：好的，是时候进行一个简短但完整的程序了。基本答案和以前一样：

*   使用 Type.GetMethod 找到“打开”的泛型方法
*   使用 MakeGenericMethod 使其通用
*   用 Invoke 调用它

这是一些示例代码。请注意，我将查询表达式更改为点表示法 - 当您基本上只有一个 where 子句时，使用查询表达式是没有意义的。

```
using System;
using System.Linq;
using System.Reflection;

namespace Interfaces
{
    interface IFoo {}
    interface IBar {}
    interface IBaz {}
}

public class Test
{
    public static void CallMe<T>()
    {
        Console.WriteLine("typeof(T): {0}", typeof(T));
    }

    static void Main()
    {
        MethodInfo method = typeof(Test).GetMethod("CallMe");

        var types = typeof(Test).Assembly.GetTypes()
                                .Where(t => t.Namespace == "Interfaces");

        foreach (Type type in types)
        {
            MethodInfo genericMethod = method.MakeGenericMethod(type);
            genericMethod.Invoke(null, null); // No target, no arguments
        }
    }
} 
```

**原始答案**

让我们先把调用变量“接口”的明显问题放在一边。

你必须通过反思来称呼它。泛型的重点是在*编译*时进行更多类型检查。您在编译时不知道类型是什么 - 因此您必须使用泛型。

获取泛型方法，并在其上调用 MakeGenericMethod，然后调用它。

您的接口类型本身实际上是通用的吗？我问是因为你在上面调用 MakeGenericType ，但没​​有传入任何类型参数......你是否试图调用

```
Method<MyNamespace.Interface<string>>(); // (Or whatever instead of string) 
```

或者

```
Method<MyNamespace.Interface>(); 
```

如果是后者，您只需要调用 MakeGenericMethod - 而不是 MakeGenericType。

# c - 从 sqlite3_column_blob() 方法获取的指针是否需要删除？

> ID：325158
> 
> 赞同：3
> 
> 时间：2008-11-28T06:31:51.773
> 
> 标签：c, sqlite

像这样： const void * test = sqlite3_column_blob(stat, 1); 我可以删除或删除[]测试吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-03-23T05:16:40.370

从[sqllite 文档](http://www.sqlite.org/c3ref/column_blob.html)：

> 返回的指针在发生类型转换或调用 sqlite3_step() 或 sqlite3_reset() 或 sqlite3_finalize() 之前都是有效的。用于保存字符串和 BLOB 的内存空间会自动释放。**不要将 sqlite3_column_blob() 返回的指针传递给 sqlite3_free()。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T06:36:09.330

查看它的 API 手册。如果它是 C API，您可能必须使用`free`它。如果它不提供自己的函数，如 sqlite3_free（例如 pcre 这样做），则必须使用该函数。

你不能做的是使用 C++ 的删除操作符删除它，因为你有一个 void 指针。您不能删除 void 指针，因为编译器必须知道它的类型。（并且 void 是一个不完整的类型。你也不能删除不完整的类型）。

# python - 是否有一个库可以检测代码块的源代码语言？

> ID：325165
> 
> 赞同：22
> 
> 时间：2008-11-28T06:40:35.267
> 
> 标签：python

编写一个python脚本，它需要找出一段代码是用什么语言编写的。**我自己可以很容易地编写这个，但我想知道是否已经存在解决方案。**

Pygments 是不够的和不可靠的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-28T11:16:17.113

[Pygments](http://pygments.org)也可以猜测。这是文档中的一个示例：

```
>>> from pygments.lexers import guess_lexer, guess_lexer_for_filename

>>> guess_lexer('#!/usr/bin/python\nprint "Hello World!"')
<pygments.lexers.PythonLexer>

>>> guess_lexer_for_filename('test.py', 'print "Hello World!"')
<pygments.lexers.PythonLexer> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-28T08:01:46.617

我想你应该试试这个网站使用的东西：[google-code-prettify](http://code.google.com/p/google-code-prettify/)（来自[这个问题](https://stackoverflow.com/questions/235982/how-code-color-is-set-in-stackoverflow)）

[编辑]JF Sebastian 指点我到[Pygments](http://pygments.org/)（见[这个答案](https://stackoverflow.com/questions/325165/is-there-a-library-that-will-detect-the-source-code-language-of-a-block-of-code#325521)）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-28T08:40:37.583

可靠地做到这一点可能有点困难。例如，以下是什么语言：

```
print("blah"); 
```

最可靠的方法（当然，除了让用户选择正确的语言之外）是检查第一行是否以`#!`("hashbang") 开头——之后的任何内容都是脚本语言的解释器。

这对于许多脚本语言（包括 python、shell 脚本、perl、ruby 等）都可以可靠地工作，但不适用于编译语言。

您可以寻找独特的语法样式或特定关键字，并将每个关键字加权到特定语言。例如`$#somevar`可能是 Perl。`somevar.each do |another| ..... end`可能是红宝石..但这最终会做*很多*工作，而且并不总是有效（尤其是短代码块）

另一种明显的方法是使用文件扩展名。如果是`*.pl`它可能是 Perl 代码..

你想达到什么目的？如果你想语法高亮，看看[google-code-prettify](http://code.google.com/p/google-code-prettify/)做了什么——基本上是一个相当智能的通用语法高亮器。

在上面的模棱两可的例子中，`print`很可能是一个语句或函数名，`"blah"`也可能是一个字符串。如果您以不同的方式突出显示这两种语言，则您已经成功突出显示了*许多*不同的语言，而无需检测它实际上是什么……但这可能并不总是有效，具体取决于任务……

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-28T07:32:59.543

Vim 使用一系列有趣的测试和正则表达式来查找某些文件格式。您可以查看 vim 指令文件`vim/vim71/filetype.vim`，或[在线查看](https://github.com/vim/vim/blob/master/runtime/filetype.vim)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-28T10:02:36.170

Ohcount 正是为此而开发的：http: [//labs.ohloh.net/ohcount](http://labs.ohloh.net/ohcount)

他们在 www.ohloh.net 上使用它来计算人们对语言的贡献。

坏消息是它是用 ruby​​ 编码的，但我相信你可以将它以一种或另一种方式集成到 python 中。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-08-14T10:02:29.853

既然你问了这个问题，GitHub 已经发布了他们用来检测编程语言的代码[**Linguist**](https://github.com/github/linguist/)。根据我的经验，GitHub 非常准确。

> ### 语言检测
> 
> Linguist 在 yaml 文件中定义了 GitHub 已知的所有语言的列表。为了突出显示文件，必须在其中定义语言和词法分析器。
> 
> 大多数语言都是通过其文件扩展名来检测的。这是最快和最常见的情况。
> 
> 为了消除具有共同扩展名的文件之间的歧义，我们使用贝叶斯分类器。例如，这可以帮助我们区分 .h 文件之间的区别，这些文件可以是 C、C++ 或 Obj-C。

红宝石宝石：[http ://rubygems.org/gems/github-linguist](http://rubygems.org/gems/github-linguist)

如果你因为某种原因不能使用 Ruby，逻辑很简单，可以移植[https://github.com/github/linguist/blob/master/lib/linguist/language.rb](https://github.com/github/linguist/blob/master/lib/linguist/language.rb)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-28T09:53:55.530

您可以检查自动突出显示代码块的 highlight.js，他们说他们正在使用某种启发式方法来完成此[http://softwaremaniacs.org/soft/highlight/en/](http://softwaremaniacs.org/soft/highlight/en/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-28T06:49:36.573

> 一段代码是用什么语言编写的

在哪些语言中，您有哪些替代方案？没有办法普遍地确定这一点。但是如果你缩小你的注意力，那么某处可能有一个工具

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-06T21:43:24.503

正如其他人所说，Pygments 将是你最好的选择。

# javascript - 如何使用 google.load 加载 javascript 文件，而不是直接使用 freemarker 模板语言中的标签？

> ID：325167
> 
> 赞同：0
> 
> 时间：2008-11-28T06:41:59.023
> 
> 标签：javascript, freemarker, google.load

如何使用 google.load 加载 javascript 文件，而不是直接使用 freemarker 模板语言中的标签？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-28T06:50:05.997

要从 Google CDN 加载常见的 JavaScript 库，如 jQuery、Prototype、MooTools、Dojo...，您可以[在此处](http://code.google.com/apis/ajaxlibs/)找到更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T18:43:23.720

并补充 CMS 的答案：这是[详细的文档](http://code.google.com/apis/ajax/documentation/#DetailedDocumentation)。

# java - 覆盖应用程序服务器行为以在打包的 Web 应用程序中加载 jsp-api 和 servlet-api jar

> ID：325171
> 
> 赞同：3
> 
> 时间：2008-11-28T06:44:39.830
> 
> 标签：java, web-applications, jakarta-ee, classloader

我有一个使用特定版本的 jsp-api 和 servlet-api jar 文件构建和打包的项目。现在我希望在任何应用程序服务器（例如 tomcat、WAS、Weblogic 等）上部署 Web 项目时加载这些 jar。

我在 tomcat 上看到的行为是它给出的消息是这些 api 的打包版本没有与有问题的类一起加载。

有什么办法可以覆盖这些服务器设置或行为？

我担心的是，让服务器的默认行为可能会允许不同服务器上的不同行为，甚至是同一应用服务器的不同版本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-28T06:47:01.290

1.  如果您可以控制要安装此 web 应用程序的服务器，则可以用您的核心 jar 替换。
2.  此外，您可以在应用服务器的启动中添加 jar。

**更新：**

至于第二部分，你需要自己修改应用服务器的启动文件。

我手头没有安装，但假设在 $YOUR_APPSERV/bin 目录中有一堆脚本（.cmd 或 .sh 文件）

其中一些启动应用程序服务器，其他一些帮助配置它。

您需要以命令行如下所示的方式修改其中一个：

（假设安装了windows）

```
java -Xbootclasspath/p:c:\cutomjars\myJar.jar;customjars\myOtherJar.jar ..................... // the rest of the normal command line. 
```

-bootclasspath/p 将 jars 添加到应用程序类路径中

-bootclasspath/a 将 jar 附加到应用程序 claspath

此选项允许您使用 jar 中指定的类覆盖 JVM 中的任何类，因此您甚至可以根据需要替换 java.lang.String。

这是一种方法。不幸的是 -Xbootclasspath 是 Sun JVM 的一个选项（即 JRockit 没有它，IBM 的 VM 也没有他的名字）

还有另一种选择，您可以在其中声明所有扩展名所在的文件夹。另外，jre 中有一个 ext 目录。

深入了解您的应用程序服务器 bin 目录并找出每个脚本的用途，我很确定您会通过它。

这是对该主题的更正式的解释：http: [//java.sun.com/j2se/1.5.0/docs/tooldocs/findingclasses.html](http://java.sun.com/j2se/1.5.0/docs/tooldocs/findingclasses.html)

我希望它有所帮助。

顺便说一句，我几年前曾经这样做过，用一个古怪的旧版本替换 CORBA 包。所以这肯定有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T20:21:05.890

*为了清楚起见，我将答案一分为二*

图树，我有两个消息要告诉你。

好的是我已经使用我在上一篇文章中描述的步骤（下面的截图）将我的 tomcat 中的 servlet api 从 2.5 替换为 2.3

坏新的（我之前应该猜到了）tomcat 不会启动。很明显，servlet-api.jar 是tomcat 的核心，版本取决于那里存在的一些功能。如果换了，发动机就不能工作了。

我向您展示的解决方案可以改变一两个类的行为，但不能替代整个系统。

因此，您唯一的选择是：

1.  在符合您的 servlet 规范的 servlet 容器上运行 升级您的应用程序
2.  按照新规范对其进行测试。很有可能（如果您没有链接到非公开课程）您的应用程序仍然可以工作
3.  （我过去这样做过）创建一个包含所需类的新 jar（假设您的应用程序只需要一个类即可运行良好），然后将该类添加到容器中。

* * *

这是测试jsp

```
Servlet version: <%=application.getMajorVersion()%>.<%=application.getMinorVersion()%> 
```

未修改版本的输出：

[未修改版本 http://img89.imageshack.us/img89/9822/87694136ld9.png](http://img89.imageshack.us/img89/9822/87694136ld9.png)

修改版：

[修改版 http://img241.imageshack.us/img241/7842/86370197ev3.png](http://img241.imageshack.us/img241/7842/86370197ev3.png)

修改后的catalina启动截图

[差异输出 http://img246.imageshack.us/img246/3333/30172332tp7.png](http://img246.imageshack.us/img246/3333/30172332tp7.png)

Tomcat 堆栈跟踪

```
SEVERE: Servlet.service() for servlet jsp threw exception

javax.servlet.ServletException: javax.servlet.jsp.JspFactory.getJspApplicationContext(Ljavax/servlet/ServletContext;)Ljavax/servlet/jsp/JspApplicationContext;

at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:275)

at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)

at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)

at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)

at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)

at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)

at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)

at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)

at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)

at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)

at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)

at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)

at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)

at java.lang.Thread.run(Thread.java:619) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-29T14:03:43.253

JRockit 可以使用 -Xbootclasspath。请参阅[命令行参考](http://edocs.bea.com/jrockit/jrdocs/refman/optionX.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-09T00:19:25.720

其他选择是使用

> *-Djava.endorsed.dirs*

JVM启动时

# .net - .NET 中真的有 COBOL 吗？

> ID：325177
> 
> 赞同：29
> 
> 时间：2008-11-28T06:46:50.683
> 
> 标签：.net, cobol, microfocus

刚才在查看微软的 Visual Studio 页面时，突然在广告侧边栏看到了一个不可思议的广告：

> “Net Express 是一个[COBOL](http://en.wikipedia.org/wiki/COBOL)开发环境，用于将核心业务流程扩展到 .NET Framework 和其他分布式平台。”

当然我跟着[链接](http://www.microfocus.com/Products/)找到了一家做这个的公司，但是还有地方还在用COBOL吗？有人真的在 .NET 框架中使用 COBOL 吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-11-28T09:26:05.790

[Micro Focus](http://www.microfocus.com)制作了一个 COBOL 开发套件，主要用于维护旧的大型机应用程序。它会说来自各种平台的 20 种 COBOL 方言，并具有[CICS](http://en.wikipedia.org/wiki/CICS)仿真工具。截至 2004 年，他们推荐它来替换高达[400 MIPS](http://en.wikipedia.org/wiki/Mainframe_computer)左右的大型机工作负载。请记住，您仍然可以在 1990 年代初期从 Amdahl 购买额定为 22 MIPS 的大型机系统，在大型机上 400 MIPS 是相当大的工作量。

将传统的 COBOL 后端集成到现代前端是一项大生意。有相当丰富的[终端](http://x3270.bgp.nu/x3270-man.html#Options) [仿真](http://tn5250.sourceforge.net/) [软件](http://en.wikipedia.org/wiki/3270_emulator)生态系统、[屏幕抓取](http://en.wikipedia.org/wiki/Screen_scraping)工具、[接口库](http://www.inventu.com/ehllapi.html)和用于各种协议（如 CORBA 和 SOAP）的 [RPC 包装器。](http://www.cicsug.org/Documents/1-CICS-MidAtlantic-TS13.pdf)

几年前，Micro Focus 推出了一个[COBOL .NET 编译器](http://www.microfocus.com/products/more/COBOLandNet/index.asp)，允许您在 CLR 后端运行 COBOL 应用程序。您可以编译任何受支持的方言，它将运行所有旧版仿真功能。这允许您将 GUI 或 Web 前端（或 Web 服务层）放在现有的 COBOL 应用程序上，从而保留对现有代码库的投资。几乎可以使用任何支持 CLR 的开发工具来编写前端。您想使用 C#/Windows Forms、MS Workflow Foundation、SSIS、IronPython、ASP.NET 或 SQL Server CLR 与您的 COBOL 后端集成 - 让自己失望。

因此，对于遗留应用程序的完全重写和迁移，它通常是一个非常有吸引力的替代方案。

这种类型的工作占了他们业务的很大一部分，但仍然有一些利基市场，COBOL 实际上本身就做得很好。对于许多大批量作业，打开面向记录的文件并按程序处理它是获得简单、可理解和*快速*的应用程序的良好范例。我曾经读过一篇帖子（在 Slashdot IIRC 上），有人在谈论一个 COBOL 应用程序，该应用程序读取 35GB 的信用卡退款文件并*每小时*处理一次。这是很久以前发布的，在 1990 年代的某个时候——当时 35GB 比大多数 PC 的磁盘容量大得多。

让 RDMBS 在一个小时内批量加载和处理 35GB 的数据（估计 100-2 亿条记录）不一定是一件微不足道的工作，即使在现代硬件上也是如此。通常，从 SQL 中获得性能需要您对处理采取一种有些不恰当的方法，这可能会混淆代码的含义；高度调整的 SQL 可以是相当“只写”的。

COBOL 已在此类应用程序中使用了大约 50 年，是一种成熟、易于理解且可靠的技术，*实际上做得很好。*

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-28T08:21:43.847

我真的很喜欢[COBOL](http://en.wikipedia.org/wiki/COBOL)编码 - 学习 Fortran、Pascal 和 C，但我前 5 年的大部分时间都在 IBM/390 上的 COBOL 上进行专业编码。不过15年没碰过。

COBOL 是出类拔萃的批处理财务处理语言。结构合理，它可以做它最擅长的事情——处理大量财务数据——比其他任何事情都好。它也是一种将其他系统嵌入其中的非常好的语言——通常作为其他系统之间的粘合剂运行。

把它想象成一个机车:-)。在 19 世纪，每个人都曾经乘坐火车旅行，因为我们只有火车，但大多数人都被汽车和飞机所取代。尽管铁路系统仍然是要走的路，但要运送大量的重型货物。您在日常生活中并不经常看到机车，但它们让您的发电站使用煤炭运行。

值得注意的是，Lisp 在 AI 编码中仍然具有相似的地位。我发现有趣的是，1960 年代/70 年代三种“大”语言组中的另一个成员 - Fortran - 比其他语言下降得更多，这不是我当时所期望的。然而，我们仍然有很大一部分[BASIC](http://en.wikipedia.org/wiki/BASIC)，它实际上是 Fortran 的私生子，所以可以说这三个人都像他们在任何地方一样活跃和活跃。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-28T06:50:12.143

Rob，虽然不一定适用于 .NET，但仍有*很多地方在做 COBOL；*我们仍然进行大量大型机开发，并且绝大多数金融应用程序仍然使用与 CICS 交互的 COBOL 编写。

此外，您仍然可以获得适用于 Windows 平台的 COBOL 编译器（例如，Fujitsu）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-28T06:55:44.987

我认为更常见的场景是互操作性，例如，Windows 和 ASP.NET 应用程序与 COBOL/CICS 应用程序通信，反之亦然。

几年前，我曾为我国的一家大型银行参与过这样的项目，我可以想象这对于任何拥有超过 40 年 IT 经验的银行来说都是相当普遍的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-05T12:43:55.750

COBOL 是一个利基市场。一个不错的、舒适的、有利可图的利基市场。这可能（迟早）会变得不存在，但现在它仍然存在。就在这里，几家主要的银行组织都在 COBOL 中开发了他们的核心系统。这不仅是维护，更是开发！

It has been around for 50 years or so. Every 10 years someone announcing it dead, but it still hangs on.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-28T07:12:10.180

Wikipedia 上的一篇文章让我大吃一惊：

> COBOL 程序在全球范围内用于政府和军事机构、商业企业以及 IBM 的 z/OS、Microsoft 的 Windows 和 POSIX 系列（Unix/Linux 等）等操作系统。1997 年，Gartner Group 报告称，全球 80% 的业务在 COBOL 上运行，现有代码超过 2000 亿行，估计每年有 50 亿行新代码。

[http://en.wikipedia.org/wiki/COBOL](http://en.wikipedia.org/wiki/COBOL)

我认为COBOL是“木材”。这不是真的。顺便说一下，[Fujitsu NetCOBOL for .NET](http://www.netcobol.com/products/windows/netcobol.html)和[Micro Focus Net Express® with .NET](http://www.microfocus.com/products/netexpresswithnet/index.asp)是相当全面的实现。也许我们应该学习这门语言，然后找到一份高薪的好工作？:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-31T09:32:23.517

I know of Raincode, Fujitsu, and Microfocus.

*   Microfocus attempts ASP.NET using COBOL Codebehind.

*   Fujitsu I'm not sure if they are still offering their own web solution or attempting to fit into ASP.NET.

*   Raincode offers a standard COBOL compiler targetting .NET without any attempt to harness ASP.NET

# macros - R6RS Scheme 的 make-variable-transformer 有什么好处？

> ID：325186
> 
> 赞同：2
> 
> 时间：2008-11-28T06:55:03.473
> 
> 标签：macros, scheme

在查看`syntax-case`R6RS 中的部分时，我看到了关键字`make-variable-transformer`，描述为*标识符宏*。给出的例子非常少，我不明白为什么它是必要的，或者什么用例需要它。事实证明，寻找其使用的其他示例也很困难。大概它使某种形式的语法转换成为可能，或者更优雅？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-03T08:26:30.420

阅读[http://www.r6rs.org/final/html/r6rs-lib/r6rs-lib-ZH-13.html#node_sec_12.3](http://www.r6rs.org/final/html/r6rs-lib/r6rs-lib-Z-H-13.html#node_sec_12.3)后，我的看法如下：

If`mac`是一个语法转换器

`(mac foo (bar baz))`会将整个 s-expr 替换为转换的结果，这可能会导致任何结果`(SOMETHING)`，而`(foo mac bar)`只会替换`mac`导致`(foo SOMETHING bar)`.

通常`(set! mac 'foo)`会发出错误信号，似乎转换器不能出现在集合表达式的左侧，但如果`mac`是变量转换器`(set! mac 'foo)`，则会改为`mac`使用整个 s-expr 调用。

我的直觉告诉我，如果您开始使用宏实现数据类型，这将很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T18:13:17.220

我在搜索有关 make-variable-transformer 的文档时遇到了这个问题。这是我提出的一个问题，建议使用 make-variable-transformer ......

[http://groups.google.com/group/comp.lang.scheme/browse_frm/thread/96b07d431f1a66de/777f8e07ae1855f3#777f8e07ae1855f3](http://groups.google.com/group/comp.lang.scheme/browse_frm/thread/96b07d431f1a66de/777f8e07ae1855f3#777f8e07ae1855f3)

杰克交易

# language-agnostic - 您如何使用 Windows API 将信息写入 Windows“全局（内存中）变量”而不是由各种应用程序共享？

> ID：325190
> 
> 赞同：2
> 
> 时间：2008-11-28T06:58:05.480
> 
> 标签：language-agnostic, winapi

也许这无法做到，但请帮助或建议如何在不向磁盘写入内容的情况下实现这一点。

假设我想在两个独立的应用程序之间共享两个字符串值。

欢迎您提供任何编程语言的代码示例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-28T07:01:07.830

您可能想要做的是创建一个内存映射文件。您可以创建一个内存映射文件，该文件在磁盘上没有任何后备存储，而是由系统页面文件支持。查看文档[`CreateFileMapping`](http://msdn.microsoft.com/en-us/library/aa366537(VS.85).aspx)，特别是当第一个参数是`INVALID_HANDLE_VALUE`.

您可以给这样的文件映射一个唯一的系统范围名称，然后其他应用程序可以使用`OpenFileMapping`并提供相同的名称打开它。

一旦你有了这样一块共享内存，你就可以把你喜欢的任何信息放进去。请注意，由于内存是跨进程共享的，因此您不希望将任何指针存储到内存块中（这排除了在`std::string`此处存储之类的操作）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T07:07:57.503

推荐的方法是创建一个命名的内存映射（`CreateFileMapping`，可能`INVALID_HANDLE_VALUE`作为第一个参数，因为您不需要实际文件）并将您的共享数据放入映射中。您还需要一个命名的互斥锁来同步对这些数据的访问。

一种懒惰的方法是使用`#pragma data_seg`（对于 MSVC；其他编译器有类似的工具）将您的数据放在共享部分中。请注意，MSVC 要求数据显式初始化；否则，它将进入常规数据部分，甚至没有警告。

第二种方法的缺点是这里没有应用安全性，因此任何用户（甚至跨会话）都可以访问共享部分。另一个问题是只有同一个可执行文件（或 DLL）的实例才能共享该部分。即，如果您复制 .exe 并从两个不同的位置运行它，则不会共享数据。

# visual-studio - 关于获取给定项目中使用的标头的 Visual Studio 提示？

> ID：325197
> 
> 赞同：0
> 
> 时间：2008-11-28T07:06:16.087
> 
> 标签：visual-studio, visual-studio-2008, visual-studio-2005

我已经在路径中添加了库中的所有头文件如何获取项目只需要的头文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-28T14:12:01.240

有一个编译器选项将在您的构建输出窗口中为编译单元生成包含文件的列表。

在编译单元的属性页中，在 C/C++ Advanced 部分下，有一个名为“Show Includes”的选项。打开它并重新编译。您也可以在项目级别执行此操作，但我建议您逐个编译单元 (.cpp) 执行此操作。

# jquery - 如何在jquery中最近添加的标签上绑定点击事件

> ID：325200
> 
> 赞同：1
> 
> 时间：2008-11-28T07:10:33.600
> 
> 标签：jquery, click, bind

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-28T07:26:56.093

使用事件委托 - 这意味着将点击绑定到某个容器并让它处理事件。然后，您可以查询 event.target 以查看它是否是被点击的锚点，那么您是否需要行为。出于多种原因，这更好。

1.  更少的事件绑定到元素（性能）
2.  添加/删除内容后无需重新绑定事件，因为容器保持不变并且将始终在那里处理冒泡的点击事件。

代码将类似于

```
$('#someContainer').click( function(ev){

    var $el=$(ev.target);
    if ( $el.is('a') ){
       //do your stuff
    }

}); 
```

请参阅此[帖子](http://www.danwebb.net/2008/2/8/event-delegation-made-easy-in-jquery)以获取更多阅读

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T07:17:29.653

<a> 丢失了 onclick 处理程序，因为它正在被删除。当您重新添加 HTML 时，它不会返回该处理程序。

无需过多地重新排列代码，您就可以创建一个函数来充当您的点击处理程序。

```
function playerClicked() {    
        // replace the <a> tag from the previous media player installation
        if (previousplayerlocation != null) {
            $("#" + previousplayerlocation + " .storyplayer")
                .html(graboldcode)
                .click(playerClicked);  // Re-add the onclick handler
        }

        // now remember this installation's <a> tag before it's replaced
        graboldcode = $(this).parent().html();
        // remember where I grabbed this <a> tag from
        previousplayerlocation = $(this).parents("div.storylisting").attr("id");

        // replaces the <a> tag with the media player.
        $(this).media({width: 190,height: 30});
        return false;
}

$(".storyplayer a").bind("click", playerClicked); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T14:32:06.567

看看[livequery](http://brandonaaron.net/docs/livequery/)插件。使用此插件，您甚至可以为 DOM 中不可用的元素绑定事件侦听器。

```
$('a').livequery('click', function(){

    }); 
```

插件监控 DOM 并绑定监听器。您也可以自己强制评估：

```
$.livequery.run() 
```

其他一些强大的功能：

您可以使侦听器过期：

```
$('a').livequery.expire('click') 
```

您可以注册 onmatch 侦听器：

```
$('a').livequery(
function(){ onmatchHandler},
function(){ onmismatchHandler }
); 
```

# java - java.util.zip.ZipException：打开 zip 文件时出错

> ID：325202
> 
> 赞同：87
> 
> 时间：2008-11-28T07:12:01.567
> 
> 标签：java, zip, unzip

我有一个 Jar 文件，其中包含其他嵌套的 Jar。当我在这个文件上调用新的`JarFile()`构造函数时，我得到一个异常，它说：

> java.util.zip.ZipException：打开 zip 文件时出错

当我手动解压缩此 Jar 文件的内容并再次压缩时，它工作正常。

我只在 WebSphere 6.1.0.7 及更高版本上看到此异常。同样的事情在 tomcat 和 WebLogic 上也能正常工作。

当我使用 JarInputStream 而不是 JarFile 时，我能够毫无例外地读取 Jar 文件的内容。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2010-09-27T07:14:11.140

确保您的 jar 文件没有损坏。如果它已损坏或无法解压缩，则会发生此错误。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-09-22T01:48:37.800

我遇到了同样的问题。我有一个 java.util.zip.ZipFile 无法处理的 zip 存档，但 WinRar 将其解压缩得很好。我[在 SDN 上](https://web.archive.org/web/20110427091148/http://java.sun.com/developer/technicalArticles/Programming/compression/)找到了关于 Java 中压缩和解压缩选项的文章。我稍微修改了一个示例代码以生成最终能够处理存档的方法。技巧在于使用 ZipInputStream 而不是 ZipFile 并按顺序读取 zip 存档。此方法还能够处理空的 zip 存档。我相信您可以调整该方法以满足您的需要，因为所有 zip 类都有 .jar 档案的等效子类。

```
public void unzipFileIntoDirectory(File archive, File destinationDir) 
    throws Exception {
    final int BUFFER_SIZE = 1024;
    BufferedOutputStream dest = null;
    FileInputStream fis = new FileInputStream(archive);
    ZipInputStream zis = new ZipInputStream(new BufferedInputStream(fis));
    ZipEntry entry;
    File destFile;
    while ((entry = zis.getNextEntry()) != null) {
        destFile = FilesystemUtils.combineFileNames(destinationDir, entry.getName());
        if (entry.isDirectory()) {
            destFile.mkdirs();
            continue;
        } else {
            int count;
            byte data[] = new byte[BUFFER_SIZE];
            destFile.getParentFile().mkdirs();
            FileOutputStream fos = new FileOutputStream(destFile);
            dest = new BufferedOutputStream(fos, BUFFER_SIZE);
            while ((count = zis.read(data, 0, BUFFER_SIZE)) != -1) {
                dest.write(data, 0, count);
            }
            dest.flush();
            dest.close();
            fos.close();
        }
    }
    zis.close();
    fis.close();
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-28T17:50:02.283

当 JVM 认为是**临时**目录由于不存在或没有写入权限而无法访问时，我已经看到过这个异常。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-28T07:16:35.083

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-02-08T17:34:10.490

我通过清除 jboss-xyz/server[config]/tmp 和 jboss-xyz/server/[config]/work 目录解决了这个问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-04-23T19:44:17.907

我在 Java 6 的特定 Zip 文件中看到了这一点，但是当我升级到 Java 8（没有测试 Java 7）时它就消失了，所以 Java 中新版本的 ZipFile 似乎支持更多的压缩算法，因此可以读取文件早期版本失败。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-09T14:10:40.690

Liquibase 为我收到了这个错误。在我调试并观察 liquibase 尝试加载库并发现它在 commons-codec-1.6.jar 的清单文件上出错后解决了这个问题。本质上，您的路径中某处存在损坏的 zip 文件，或者正在使用不兼容的版本。当我对这个库的 Maven 存储库进行探索时，我发现有更新的版本并将更新的版本添加到 pom.xml。我能够在这一点上进行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-30T12:32:03.670

我遇到了异常

```
java.util.zip.ZipException: invalid entry CRC (expected 0x0 but got 0xdeadface)
    at java.util.zip.ZipInputStream.read(ZipInputStream.java:221)
    at java.util.zip.ZipInputStream.closeEntry(ZipInputStream.java:140)
    at java.util.zip.ZipInputStream.getNextEntry(ZipInputStream.java:118)
... 
```

在 Java 中解压缩档案时。存档本身似乎没有损坏，因为 7zip（和其他人）打开它时没有任何问题或对无效 CRC 的投诉。

我切换到[Apache Commons Compress](http://commons.apache.org/proper/commons-compress)来读取 zip 条目并解决了问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-16T06:05:44.367

就我而言，我`-Dloader.path="lib"`包含其他不需要的罐子。例如，`mvn dependency:copy-dependencies`列出 100 个 jar 文件。但我的`lib`目录包含 101 个 jar 文件。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-03-14T04:26:28.340

在我的情况下，具有多个版本的 SL4j-api.jar 在 maven 存储库中存在冲突。比我删除 m2 maven repo 中的整个 SL4j-api 文件夹并更新 maven 项目，构建 maven 项目而不是在 JBOSS 服务器中运行项目。问题得到解决。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-02-14T13:28:29.037

为了克服 ZipException 的问题，我使用了^([1.14](https://mvnrepository.com/artifact/org.apache.commons/commons-compress/1.14))^(的包装器，由 thrau 编写)，^([可以](https://stackoverflow.com/users/804840/thrau))轻松地从文件对象中提取或压缩。[`commons-compress`](http://commons.apache.org/proper/commons-compress/)[`jarchivelib`](http://rauschig.org/jarchivelib/examples.html)

例子：

```
public static void main(String[] args) {
        String zipfilePath = 
                "E:/Selenium_Server/geckodriver-v0.19.0-linux64.tar.gz";
                //"E:/Selenium_Server/geckodriver-v0.19.0-win32.zip";
        String outdir = "E:/Selenium_Server/";
        exratctFileList(zipfilePath, outdir );
}
public void exratctFileList( String zipfilePath, String outdir ) throws IOException {
    File archive = new File( zipfilePath );
    File destinationDir = new File( outdir );

    Archiver archiver = null;
    if( zipfilePath.endsWith(".zip") ) {
        archiver = ArchiverFactory.createArchiver( ArchiveFormat.ZIP );
    } else if ( zipfilePath.endsWith(".tar.gz") ) {
        archiver = ArchiverFactory.createArchiver( ArchiveFormat.TAR, CompressionType.GZIP );
    }
    archiver.extract(archive, destinationDir);

    ArchiveStream stream = archiver.stream( archive );
    ArchiveEntry entry;

    while( (entry = stream.getNextEntry()) != null ) {
        String entryName = entry.getName();
        System.out.println("Entery Name : "+ entryName );
    }
    stream.close();
} 
```

Maven 依赖项 «您可以从[Sonatype](https://oss.sonatype.org/) Maven 存储库的[org/rauschig/jarchivelib/](https://oss.sonatype.org/content/repositories/releases/org/rauschig/jarchivelib)下载 jars 。

```
<dependency>
  <groupId>org.rauschig</groupId>
  <artifactId>jarchivelib</artifactId>
  <version>0.7.1</version>
</dependency> 
```

@看

*   [存档器和压缩器](http://commons.apache.org/proper/commons-compress/examples.html)
*   [使用 Java API 压缩和解压缩数据](https://web.archive.org/web/20110427091148/http://java.sun.com/developer/technicalArticles/Programming/compression/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-02-24T07:21:30.520

在 Windows7 上，我在 Samba 网络连接上遇到了 Java8 Jar 文件 >80 MB 大的问题。将文件复制到本地驱动器解决了这个问题。

# c# - 为什么要在 WinForm 对话框上使用 InitializeLifetimeService？

> ID：325204
> 
> 赞同：1
> 
> 时间：2008-11-28T07:12:55.373
> 
> 标签：c#, winforms

我正在重构我从一个早已离开的开发人员那里继承的一些代码，我发现：

```
ImportExportForm l_Form = new ImportExportForm();
l_Form.InitializeLifetimeService();
l_Form.ShowDialog(); 
```

我以前从未见过或使用过 LifetimeService，但从我读过的书来看，我不明白为什么要在这里使用它，但在说 WTF 之前，我想知道我是否可能遗漏了一些微妙的细节？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T09:40:42.610

据我所知，这是一种通常用于远程 .Net 对象的方法，用于建立实例的生命周期。看这里：

[http://msdn.microsoft.com/es-es/magazine/cc300474(en-us).aspx](http://msdn.microsoft.com/es-es/magazine/cc300474(en-us).aspx)

我认为这对于普通的 Windows 窗体并不重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-15T09:59:27.613

没错，它用于 .Net 远程处理，如 WCF。除非您的对象 ImportExportForm 正在远程加载某些东西，否则我看不出有任何理由使用它。见那里： http: [//msdn.microsoft.com/en-us/library/23bk23zc (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/23bk23zc(v=vs.100).aspx)

# svn - SVN一次性备份所有存储库

> ID：325213
> 
> 赞同：2
> 
> 时间：2008-11-28T07:26:46.280
> 
> 标签：svn, backup

我已经看到了很多在 subversion 中备份单个存储库的方法。有没有办法一次性备份所有存储库。我有很多不同项目的存储库，不想每次都创建一个脚本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-28T07:36:12.453

Subversion 中的单个存储库是在 Subversion 内部管理的最大存储单元。单独的存储库只是不同的目录，每个目录包含一个存储库。

如果您已经有一个脚本来备份单个存储库，那么您可以设置该脚本以将存储库名称/路径作为参数。然后，您可以编写如下脚本：

```
#!/bin/sh
for repo in /home/repositories/*; do
    backup-single-repository $repo
done 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-28T07:32:13.930

如果您已将所有存储库配置为使用 fsfs 后端，则可以使用常规的基于文件的备份工具（例如 tar、dump、rsync、...）。

如果您使用 bsddb 存储库，我建议使用 svndump/restore 循环将它们转换为 fsfs。

# apache-camel - 关于通过 javaDSL 路由的 Apache Camel 问题

> ID：325216
> 
> 赞同：3
> 
> 时间：2008-11-28T07:28:13.377
> 
> 标签：apache-camel

通过 RouteBuilder 在 Camel 上下文中使用路由时，以下之间的实际区别是什么：

1) 从(A).to(B).to(C)；

2）从（A）到（B）；从（B）到（C）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T08:52:42.283

1）使用来自A的单个消费者然后发送到B并将调用B的结果（如果B返回一些输出）发送到C。所以它是一个管道。

2) 使用 B 上的消费者发送到 C，并且不会将 B 的输出发送到 C

# java - 哪个 Java IDE 以类似 Delphi 的方式最 RAD？

> ID：325217
> 
> 赞同：5
> 
> 时间：2008-11-28T07:28:29.193
> 
> 标签：java, ide, rad

我想快速开发 Java 应用程序，我应该选择什么 IDE？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-28T07:35:43.953

[IntelliJ 想法。](http://www.jetbrains.com/idea/)来自 JetBrains。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-28T07:56:09.357

这取决于您是哪种类型的开发人员。您是“emacs”（强大的工具）还是“vi”（完成任务）类型？例如，即使我为 IntelliJ IDEA 付费（而且我是），我也不会触碰 IntelliJ IDEA。它只是妨碍我。我是 Eclipse 人。除了NetBeans，其他人什么都受不了。

我建议下载 IntelliJ、Eclipse 和 NetBeans 并试一试。每个人花一天时间，写一段代码，看看它如何适合你。你绕不过去？还是IDE妨碍了？你能快速找到你想要的东西还是被淹没在选择中？骑行感觉平稳还是颠簸？默认值是否符合您的个人喜好？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-28T07:30:45.430

我认为 CodeGear [jbuilder](http://www.codegear.com/products/jbuilder)是一个非常好的开始。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-28T07:49:32.973

您是指桌面 GUI 应用程序吗？那么NetBeans 的GUI builder 据说非常好。

对于任何其他类别的应用程序，IntelliJ IDEA 胜出很多。注意：要花钱。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-28T09:15:22.787

对于 Web 应用程序 - [IBM RAD](http://www-01.ibm.com/software/awdtools/developer/application/) - 它基于 Eclipse，但包含更多高级功能。

# flash - 算法声音和音乐生成

> ID：325223
> 
> 赞同：5
> 
> 时间：2008-11-28T07:32:32.960
> 
> 标签：flash, audio

我希望在我正在编写的 Flash 程序中使用程序生成的声音和音乐。我在 ActionScript 3.0 参考手册中没有找到任何说明如何执行此操作的内容。这可能吗？是否开发了任何第三方工具可以做到这一点？或者 Flash/ActionScript 是否可以与更适合此类事情的外部编程语言进行通信？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T07:45:36.680

播放动态生成/修改的声音的能力是 Flash 10 的新功能，因此请确保您使用的是最新版本的 AS3 参考，否则您将看不到必要的 API。

至于示例，请查看[SampleDataEvent](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/media/Sound.html#event:sampleData)上的文档以查看播放从头开始生成的声音的示例，[Sound.extract()](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/media/Sound.html#extract())上的文档有一个有用的示例，可以播放加载的 MP3，其中数据正在被实时修改。

要回答您的最后一个问题，我认为没有任何好的方法可以将其加载到另一种技术中。AS3 应该为您提供所需的所有基本功能（即以字节流的形式访问解码的声音），但我认为它没有太多高级功能（例如，更改八度音阶或进行傅立叶变换) - 还没有。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-02T18:40:08.297

这个问题已经很老了，但我想我会发布一个链接，指向我一直在做的一些 AS3 音频实验。几乎所有这些都可以使用源代码。[http://labs.makemachine.net/](http://labs.makemachine.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T08:05:02.053

我在 Adob​​e Developer Connection 站点上找到了这篇文章：[在 Flash Player 10 中动态生成声音](http://www.adobe.com/devnet/flash/articles/dynamic_sound_generation.html)。我只是略读了一下，但它看起来像是基于您可以调整样本的方式。

这[是另一个](http://www.kaourantin.net/2008/05/adobe-is-making-some-noise-part-2.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T17:42:01.243

Flash 9 不支持动态生成的声音，但是（我可以确认）可以绕过该限制：

[链接的](http://www.flashbrighton.org/wordpress/?p=9)

# c# - 使用 .NET 代码更改 Windows 代理地址的最简单方法是什么？

> ID：325225
> 
> 赞同：0
> 
> 时间：2008-11-28T07:34:47.480
> 
> 标签：c#, windows, internet-explorer, proxy

我在这里找到了一个代码示例：

[http://sturla.simnet.is/post/2008/09/22/Enable-proxy-in-IE.aspx](http://sturla.simnet.is/post/2008/09/22/Enable-proxy-in-IE.aspx)

但它非常复杂，涉及操作 Windows 注册表。

是否有更简单且不易出错的方法来更改代理服务器地址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T07:51:32.097

可以在[此处](http://huddledmasses.org/setting-windows-internet-connection-proxy-from-c/)找到执行此操作的代码，使用适当的 API 而不是直接入侵注册表

# c# - 查找列表视图的选定项

> ID：325241
> 
> 赞同：1
> 
> 时间：2008-11-28T07:46:31.467
> 
> 标签：c#, listview, contextmenustrip

我目前有一个包含多行数据的列表视图，并且我在 C# .NET 中有一个 contextmenustrip。

我遇到的问题是当您单击菜单条项目时，我想知道选择了哪一行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T08:26:51.277

要像 sindre 所说的那样获取选定的行，您可以这样做：

```
foreach (ListViewItem item in lvFiles.SelectedItems)
{
....................................
} 
```

lvFiles 是列表视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T15:19:41.027

要获取列表视图的选定项，请尝试以下操作：

整数索引 = 0；
if (this.myListView.SelectedItem.Count > 0)
index = this.myListView.SelectedIndices[0]

这将为您提供列表视图中所选项目的索引。
您也可以参考：
[http ://www.neowin.net/forum/index.php?showtopic=358458](http://www.neowin.net/forum/index.php?showtopic=358458)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T08:20:13.943

我真的不明白你在这里的意思。您能否进一步解释您的问题或提供代码示例？

要获取 ListView 中的选定行，请使用 ListView.SelectedItems 属性。ListView.SelectedItems[0] 将为您提供第一个选择的项目（因为可以选择多个项目）

# php - 使用 PHP 渲染令人眼花缭乱的条形图：工具/最佳实践

> ID：325253
> 
> 赞同：1
> 
> 时间：2008-11-28T07:58:43.003
> 
> 标签：php, charts

我们使用 Google Charts 来渲染图表图像，但每天 500 个请求已经不够用了。哪些 PHP 类/框架值得关注？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T08:01:22.670

Google Chart API 不再有 500 个请求/天的限制。我记得这在几个月前发生了变化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T08:02:31.637

[JpGraph](http://jpgraph.net/)和[GraPHPite](http://graphpite.sourceforge.net/)是可用的最发达的开源软件包。我特别推荐 GraPHPite，它有更好的 API 并生成更好看的图表。

**编辑：**我最近开发了一个用于获取数据库数据的小型[图形库](http://www.binpress.com/app/analytics-and-graphing-with-php-sql/851)，用 PHP 处理它并从中创建 Google Analytics 风格的交互式图形（使用[flot](http://code.google.com/p/flot/)在客户端呈现图形）。它基本上是将数据库表转换为图形的完整服务器/客户端解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-29T02:34:53.767

虽然不是 PHP 解决方案，但我们在应用程序中使用[amCharts](http://www.amcharts.com/)来绘制图表。它们是基于 Flash 的，但看起来很棒，并且允许您的用户进一步放大图表。只需使用您的数据生成 XML，即可绘制图表。

# c# - C# 使用新 []

> ID：325267
> 
> 赞同：9
> 
> 时间：2008-11-28T08:19:17.517
> 
> 标签：c#, new-operator

我有一个关于使用的问题`new[]`。

想象一下：

```
Object.SomeProperty = new[] {"string1", "string2"}; 
```

SomeProperty 需要一个字符串数组。

我知道这个代码片段会起作用。但我想知道它在幕后做了什么。是否`new[]`创建类的实例`object`并在`SomeProperty`其中自动将其转换为`string`对象？

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-28T08:49:28.703

好吧，这里还是*有点*混乱。

正在进行的推断与 Object.SomeProperty 的类型无关，而是与数组初始值设定项中表达式的类型有关。换句话说，你可以这样做：

```
object o = new[] { "string1", "string2" }; 
```

并且 o 仍然是对字符串数组的引用。

基本上，编译器会查看如下表达式：

```
new[] { A, B, C, D, ... } 
```

（其中 A、B、C、D 等是表达式）并尝试找出要使用的正确数组类型。它仅将 A、B、C 和 D 等类型视为数组元素类型。采用这组候选类型，它试图找到一个所有其他类型都可以隐式转换为的类型。如果不*完全是一种*这样的类型，那么编译器会抱怨。

例如：

```
new[] { new Form(), new MemoryStream() } 
```

不会编译 - 既不能`MemoryStream`也不能`Form`转换为另一个。然而：

```
new[] { GetSomeIDisposable(), new MemoryStream() } 
```

将被视为 ，因为存在从to`IDisposable[]`的隐式转换。同样地：`MemoryStream``IDisposable`

```
new[] { 0, 1, 3.5 } // double[]
new[] { 1, 3, 100L } // long[] 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-28T08:25:06.583

这只是语法糖。编译器将在此处推断实际需要的类型并创建等效于显式构造的代码：

```
Object.SomeProperty = new string[] {"string1", "string2"}; 
```

没有`new[]`在运行时执行的事情。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-28T08:28:00.430

大致翻译为：

```
string[] $temp = new string[2];
$temp[0] = "string1";
$temp[1] = "string2";
Object.SomeProperty = $temp; 
```

有趣的是，`var x = new[] { "string1", "string2" };`同样有效，它可以推断 x 为 a `string[]`，但`var x = { "string1", "string2" };`失败了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-28T08:26:09.797

编译器替换：

```
Object.SomeProperty = new[] {"string1", "string2"}; 
```

和：

```
Object.SomeProperty = new string[] {"string1", "string2"}; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-28T08:46:02.517

我希望从您的回复中您不会在这里对类型替换和类型推断感到困惑！我假设 Object.SomeProperty 的类型是 string[]，尽管由于数组协方差，它可能是 object[]（注意这*不是*一件好事 - 查看[Eric Lippert](http://blogs.msdn.com/ericlippert/archive/2007/10/17/covariance-and-contravariance-in-c-part-two-array-covariance.aspx)关于这个主题的帖子！）。

编译器使用启发式执行类型推断 - 它确定“string1”和“string2”是字符串类型，因此它有效地将您的代码替换为：-

```
Object.SomeProperty = new string[] {"string1", "string2"}; 
```

它真的是那么简单！这一切都是在编译时完成的，在运行时什么都没有。

# html - 使 iframe 适合容器剩余高度的 100%

> ID：325273
> 
> 赞同：307
> 
> 时间：2008-11-28T08:23:48.583
> 
> 标签：html, css, iframe

我想设计一个带有横幅和 iframe 的网页。我希望 iframe 可以填充所有剩余的页面高度并在浏览器调整大小时自动调整大小。是否可以在不编写 JavaScript 代码的情况下仅使用 CSS 来完成它？

我尝试`height:100%`在 iframe 上设置，结果非常接近，但 iframe 试图填充整个页面高度，包括`30px`横幅 div 元素的高度，所以我得到了不必要的垂直滚动条。这并不完美。

我尝试了 DIV 上的 CSS 边距、填充属性以成功占据网页的整个剩余高度，但该技巧在 iframe 上不起作用。

```
 <body>
    <div style="width:100%; height:30px; background-color:#cccccc;">Banner</div>
    <iframe src="http: //www.google.com.tw" style="width:100%; height:100%;"></iframe>
</body>
```

* * *

## 回答 #1

> 赞同：287
> 
> 时间：2008-11-28T09:11:32.137

### 2019年更新

**TL;DR：**今天最好的选择是 - **flexbox**。一切都很好地支持它并且多年来一直如此。去吧，不要回头。这是 flexbox 的代码示例：

```
body, html {width: 100%; height: 100%; margin: 0; padding: 0}
.row-container {display: flex; width: 100%; height: 100%; flex-direction: column; background-color: blue; overflow: hidden;}
.first-row {background-color: lime; }
.second-row { flex-grow: 1; border: none; margin: 0; padding: 0; }
```

```
<div class="row-container">
  <div class="first-row">
    <p>Some text</p>
    <p>And some more text</p>
  </div>
  <iframe src="https://jsfiddle.net/about" class="second-row"></iframe>
</div>
```

#### 这个答案的其余部分是出于学习和历史原因而留下的。

* * *

诀窍是了解 100% 的内容。阅读 CSS 规范可以帮助你。

长话短说 - 有“包含块”这样的东西 - 这不是父元素所必需的。简单地说，它是层次结构中具有位置：相对或位置：绝对的第一个元素。或者身体元素本身，如果没有别的东西的话。因此，当您说“宽度：100%”时，它会检查“包含块”的宽度并将元素的宽度设置为相同的大小。如果那里还有其他东西，那么您可能会得到比自身大的“包含块”的内容（因此“溢出”）。

高度的工作方式相同。~~除了一个例外。您无法将高度设置为浏览器窗口的 100%。可以计算 100% 的最顶层元素是 body（或 html？不确定）元素，它的伸展刚好足以包含其内容。在它上面指定 height:100% 不会有任何效果，因为它没有“父元素”来衡量 100%。窗口本身不算数。;)~~

要使某些东西准确地伸展 100% 的窗口，您有两种选择：

2.  使用 JavaScript
3.  不要使用 DOCTYPE。这不是一个好的做法，但它会将浏览器置于“怪癖模式”，您可以在其中对元素执行 height="100%" 并将它们拉伸到窗口大小。请注意，您页面的其余部分可能也必须更改以适应 DOCTYPE 更改。

**更新：**我不确定当我发布这个时我是否已经错了，但这肯定已经过时了。今天你可以在你的样式表中做到这一点：`html, body { height: 100% }`它实际上会延伸到你的整个视口。即使使用 DOCTYPE。`min-height: 100%`也可能有用，具体取决于您的情况。

而且我**也不建议任何人再制作 quirks-mode 文档**，因为它带来的麻烦远比解决问题的方式多。每个浏览器都有不同的 quirks-mode，因此让您的页面在浏览器中保持一致的外观变得更加困难两个数量级。使用文档类型。总是。最好是 HTML5 之一 - `<!DOCTYPE html>`. 它很容易记住，并且在所有浏览器中都具有魅力，即使是 10 年前的浏览器。

唯一的例外是当您必须支持诸如 IE5 之类的东西时。如果你在那里，那么无论如何你都是一个人。那些古老的浏览器与今天的浏览器完全不同，这里给出的一些建议将对您有所帮助。从好的方面来说，如果你在那里，你可能只需要支持一种浏览器，这就消除了兼容性问题。

祝你好运！

**更新2：**嘿，好久不见！6 年后，新的选择出现了。我刚刚在下面的评论中进行了讨论，这里有更多适用于当今浏览器的技巧。

**选项 1** - 绝对定位。当您知道第一部分的精确高度时，它又漂亮又干净。

```
body, html {width: 100%; height: 100%; margin: 0; padding: 0}
.first-row {position: absolute;top: 0; left: 0; right: 0; height: 100px; background-color: lime;}
.second-row {position: absolute; top: 100px; left: 0; right: 0; bottom: 0; background-color: red }
.second-row iframe {display: block; width: 100%; height: 100%; border: none;}
```

```
<div class="first-row">
  <p>Some text</p>
  <p>And some more text</p>
</div>
<div class="second-row">
  <iframe src="https://jsfiddle.net/about"></iframe>
</div>
```

一些注意事项 -`second-row`需要容器，因为`bottom: 0`并且`right: 0`由于某种原因不适用于 iframe。与成为“替换”元素有关。但是`width: 100%`并且`height: 100%`工作得很好。`display: block`是必需的，因为`inline`默认情况下它是一个元素，否则空格会开始创建奇怪的溢出。

**选项 2** - 表格。当您不知道第一部分的高度时工作。您可以使用实际`<table>`标签，也可以使用`display: table`. 我会选择后者，因为这些天它似乎很流行。

```
body, html {width: 100%; height: 100%; margin: 0; padding: 0}
.row-container {display: table; empty-cells: show; border-collapse: collapse; width: 100%; height: 100%;}
.first-row {display: table-row; overflow: auto; background-color: lime;}
.second-row {display: table-row; height: 100%; background-color: red; overflow: hidden }
.second-row iframe {width: 100%; height: 100%; border: none; margin: 0; padding: 0; display: block;}
```

```
<div class="row-container">
  <div class="first-row">
    <p>Some text</p>
    <p>And some more text</p>
  </div>
  <div class="second-row">
    <iframe src="https://jsfiddle.net/about"></iframe>
  </div>
</div>
```

一些注释 -`overflow: auto`确保该行始终包含其所有内容。否则浮动元素有时会溢出。第二`height: 100%`行的 确保它尽可能多地扩展，尽可能地挤压第一行。

**推荐：选项 3 - flexbox - 其中最干净的一个。**

```
body, html {width: 100%; height: 100%; margin: 0; padding: 0}
.row-container {display: flex; width: 100%; height: 100%; flex-direction: column; background-color: blue; overflow: hidden;}
.first-row {background-color: lime; }
.second-row { flex-grow: 1; border: none; margin: 0; padding: 0; }
```

```
<div class="row-container">
  <div class="first-row">
    <p>Some text</p>
    <p>And some more text</p>
  </div>
  <iframe src="https://jsfiddle.net/about" class="second-row"></iframe>
</div>
```

一些注意事项 - 这是因为即使在这种情况下`overflow: hidden`，iframe 仍然会产生某种溢出。`display: block`它在全屏视图或片段编辑器中不可见，但小预览窗口有一个额外的滚动条。不知道那是什么，iframe 很奇怪。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2008-12-01T03:57:25.940

我们使用 JavaScript 来解决这个问题；这是来源。

* * *

```
var buffer = 20; //scroll bar buffer
var iframe = document.getElementById('ifm');

function pageY(elem) {
    return elem.offsetParent ? (elem.offsetTop + pageY(elem.offsetParent)) : elem.offsetTop;
}

function resizeIframe() {
    var height = document.documentElement.clientHeight;
    height -= pageY(document.getElementById('ifm'))+ buffer ;
    height = (height < 0) ? 0 : height;
    document.getElementById('ifm').style.height = height + 'px';
}

// .onload doesn't work with IE8 and older.
if (iframe.attachEvent) {
    iframe.attachEvent("onload", resizeIframe);
} else {
    iframe.onload=resizeIframe;
}

window.onresize = resizeIframe; 
```

* * *

注意：`ifm`是iframe ID

`pageY()`由 John Resig（jQuery 的作者）创建

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2010-03-11T14:29:24.163

另一种方法是使用`position: fixed;`父节点。
如果我没记错的话，`position: fixed;`将元素与视口联系起来，因此，一旦你给出了这个节点`width: 100%;`和`height: 100%;`属性，它将跨越整个屏幕。从这一点开始，您可以将标签放入其中，并使用简单的CSS 指令将`<iframe>`其跨越剩余空间（宽度和高度） 。`width: 100%; height: 100%;`

示例代码

* * *

```
 body {
        margin: 0px;
        padding: 0px;
    }

    /* iframe's parent node */
    div#root {
        position: fixed;
        width: 100%;
        height: 100%;
    }

    /* iframe itself */
    div#root > iframe {
        display: block;
        width: 100%;
        height: 100%;
        border: none;
    }
```

```
 <html>
        <head>
            <title>iframe Test</title>
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        </head>
        <body>
            <div id="root">
                <iframe src="http://stackoverflow.com/">
                    Your browser does not support inline frames.
                </iframe>
            </div>
        </body>
    </html>
```

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2015-01-13T04:14:35.513

## 以下是一些现代方法：

* * *

*   ### 方法 1 -[视口相对单位](http://www.w3.org/TR/css3-values/#viewport-relative-lengths)/的组合[`calc()`](https://developer.mozilla.org/en-US/docs/Web/CSS/calc)。

    该表达式`calc(100vh - 30px)`表示剩余高度。`100vh`浏览器的高度在哪里，并且[`calc()`](https://developer.mozilla.org/en-US/docs/Web/CSS/calc)有效地取代了其他元素的高度。

    [**示例在这里**](http://jsfiddle.net/dbmr7gy8/)

    ```
    body {
        margin: 0;
    }
    .banner {
        background: #f00;
        height: 30px;
    }
    iframe {
        display: block;
        background: #000;
        border: none;
        height: calc(100vh - 30px);
        width: 100%;
    }
    ```

    ```
    <div class="banner"></div>
    <iframe></iframe>
    ```

    支持[`calc()`这里](http://caniuse.com/#feat=calc)；此处支持[视口相对单位](http://caniuse.com/#feat=viewport-units)。

* * *

*   ### 方法 2 - Flexbox 方法

    [**示例在这里**](http://jsfiddle.net/zgywx68w/)

    将`display`公共父元素的 设置为`flex`，以及`flex-direction: column`（假设您希望元素堆叠在一起）。然后设置`flex-grow: 1`子`iframe`元素以填充剩余空间。

    ```
    body {
        margin: 0;
    }
    .parent {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }
    .parent .banner {
        background: #f00;
        width: 100%;
        height: 30px;
    }
    .parent iframe {
        background: #000;
        border: none;
        flex-grow: 1;
    }
    ```

    ```
    <div class="parent">
        <div class="banner"></div>
        <iframe></iframe>
    </div>
    ```

    由于这种方法的[支持较少](http://caniuse.com/#feat=flexbox)¹，我建议采用上述方法。

¹[虽然它似乎在 Chrome/FF 中有效，但在 IE 中无效（第一种方法适用于当前所有浏览器）。]

* * *

## 回答 #5

> 赞同：39
> 
> 时间：2009-07-13T10:30:47.517

你可以用 来做`DOCTYPE`，但你必须用`table`. 看一下这个：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<style>
*{margin:0;padding:0}
html, body {height:100%;width:100%;overflow:hidden}
table {height:100%;width:100%;table-layout:static;border-collapse:collapse}
iframe {height:100%;width:100%}

.header {border-bottom:1px solid #000}
.content {height:100%}
</style>
</head>
<body>
<table>
    <tr><td class="header"><div><h1>Header</h1></div></td></tr>
    <tr><td class="content">
        <iframe src="http://google.com/" frameborder="0"></iframe></td></tr>
</table>
</body>
</html> 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2010-07-08T11:17:35.563

也许这已经得到了回答（上面的一些答案是“正确”的做法），但我想我也应该添加我的解决方案。

我们的 iFrame 加载在一个 div 中，因此我需要其他东西然后是 window.height。看到我们的项目已经严重依赖 jQuery，我发现这是最优雅的解决方案：

```
$("iframe").height($("#middle").height()); 
```

当然，“#middle”是 div 的 id。您需要做的唯一额外的事情是在用户调整窗口大小时调用此大小更改。

```
$(window).resize(function() {
    $("iframe").height($("#middle").height());
}); 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2010-12-24T05:48:30.950

MichAdel 代码对我有用，但我做了一些小的修改以使其正常工作。

```
function pageY(elem) {
    return elem.offsetParent ? (elem.offsetTop + pageY(elem.offsetParent)) : elem.offsetTop;
}
var buffer = 10; //scroll bar buffer
function resizeIframe() {
    var height = window.innerHeight || document.body.clientHeight || document.documentElement.clientHeight;
    height -= pageY(document.getElementById('ifm'))+ buffer ;
    height = (height < 0) ? 0 : height;
    document.getElementById('ifm').style.height = height + 'px';
}
window.onresize = resizeIframe;
window.onload = resizeIframe; 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-10-28T06:43:56.157

这就是我所做的。我遇到了同样的问题，最终在网上搜索了几个小时的资源。

```
<style type="text/css">
   html, body, div, iframe { margin:0; padding:0; height:100%; }
   iframe { position:fixed; display:block; width:100%; border:none; }
</style> 
```

我将此添加到头部。

请注意，我的 iframe 位于具有 3 行和 1 列的表格的中间单元格内。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2020-11-12T20:44:08.150

另一种选择使用`vh`

```
<iframe src='/' style="display:block; border:none; height:100vh; width:100%;"></iframe> 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-11-28T09:24:50.443

没错，您正在展示一个相对于其容器 100% 高度的 iframe：body。

试试这个：

```
<body>
  <div style="width:100%; height:30px; background-color:#cccccc;">Banner</div>
  <div style="width:100%; height:90%; background-color:transparent;">
    <iframe src="http: //www.google.com.tw" style="width:100%; height:100%;">
    </iframe> 
  </div>
</body> 
```

当然，把第二个div的高度改成你想要的高度。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-12-02T21:35:36.513

您可以使用 html/css 执行此操作，如下所示：

```
<body>
    <div style="width:100%; height:30px; background-color:#cccccc;">Banner</div>
    <iframe src="http: //www.google.com.tw" style="position:fixed;top:30px;bottom:0px;width:100%;"></iframe>
</body> 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2012-12-11T06:20:08.563

尝试以下操作：

```
<iframe name="" src="" width="100%" style="height: 100em"/> 
```

它对我有用

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-12-29T13:36:14.550

HTML5 中的新功能：使用 calc（在高度上）

```
<html style="width:100%; height:100%; margin: 0px; padding: 0px;">
<body style="width:100%; height:100%; margin: 0px; padding: 0px;">
<div style="width:100%; height:30px; background-color:#cccccc;">Banner</div>
<iframe src="http://www.google.com.tw" style="width:100%; height: calc(100% - 30px);"></iframe>
</body>
</html> 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-03-09T01:43:18.997

我使用 display:table 来解决类似的问题。它*几乎*适用于此，留下一个小的垂直滚动条。如果您尝试使用 iframe 以外的其他内容填充该灵活列，则它可以正常工作（不是

采取以下 HTML

```
<body>
  <div class="outer">
    <div class="banner">Banner</div>
    <div class="iframe-container">
      <iframe src="http: //www.google.com.tw" style="width:100%; height:100%;border:0;"></iframe>
    </div>
  </div>
</body> 
```

将外部 div 更改为使用 display:table 并确保它设置了宽度和高度。

```
.outer {
  display: table;
  height: 100%;
  width: 100%;
} 
```

将横幅设为表格行并将其高度设置为您的偏好：

```
.banner {
  display: table-row;
  height: 30px;
  background: #eee;
} 
```

在您的 iframe（或您需要的任何内容）周围添加一个额外的 div 并将其设置为高度设置为 100% 的表格行（如果您想嵌入 iframe 来填充高度，则设置其高度至关重要）

```
.iframe-container {
  display: table-row;
  height: 100%;
} 
```

下面是一个 jsfiddle 显示它在工作中（没有 iframe，因为这似乎在小提琴中不起作用）

[https://jsfiddle.net/yufceynk/1/](https://jsfiddle.net/yufceynk/1/)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-28T09:41:23.857

我认为你在这里有一个概念问题。要说*“我尝试在 iframe 上设置高度：100%，结果很接近，但 iframe 试图填满整个页面”*，那么，“100%”何时不等于“整个”？

您已要求 iframe 填充其容器（即主体）的整个高度，但不幸的是，它在上面的 <div> 中有一个块级兄弟姐妹，您要求其为 30px 大。所以现在要求父容器总数调整为 100% + 30px > 100%！因此滚动条。

我认为你的*意思*是你希望 iframe 像框架和表格单元格一样消耗*剩下的*东西，即 height="*"。IIRC 这不存在。

不幸的是，据我所知，也没有办法有效地混合/计算/减去绝对单位和相对单位，所以我认为你只有两个选择：

1.  绝对定位您的 div，这会将其从容器中取出，因此仅 iframe 将消耗它的容器高度。这会给你留下各种各样的其他问题，但也许你正在做的事情不透明或对齐是可以的。

2.  或者，您需要为 div 指定 % 高度，并将 iframe 的高度降低这么多。如果绝对高度真的那么重要，您需要将其应用于 div 的子元素。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-10-15T08:58:55.360

在尝试了一段时间的 css 路由之后，我最终在 jQuery 中编写了一些相当基本的东西来为我完成这项工作：

```
function iframeHeight() {
    var newHeight = $j(window).height();
    var buffer = 180;     // space required for any other elements on the page 
    var newIframeHeight = newHeight - buffer;
    $j('iframe').css('height',newIframeHeight);    //this will aply to all iframes on the page, so you may want to make your jquery selector more specific.
}

// When DOM ready
$(function() {
    window.onresize = iframeHeight;
} 
```

在 IE8、Chrome、Firefox 3.6 中测试

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-05-13T10:13:18.550

它将与下面提到的代码一起使用

```
<iframe src="http: //www.google.com.tw"style="position: absolute; height: 100%; border: none"></iframe> 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-08-20T13:01:31.600

@MichAdel 的类似答案，但我使用的是 JQuery 并且更优雅。

```
<script type="text/javascript">
    $(document).ready(function() {
        var $iframe = $('#iframe_id')[0];

        // Calculate the total offset top of given jquery element
        function totalOffsetTop($elem) {
            return $elem.offsetTop + ($elem.offsetParent ? totalOffsetTop($elem.offsetParent) : 0);
        }

        function resizeIframe() {
            var height = window.innerHeight || document.body.clientHeight || document.documentElement.clientHeight;
            height -= totalOffsetTop($iframe);
            $iframe.height = Math.max(0, height) + 'px';
        }

        $iframe.onload = resizeIframe();
        window.onresize = resizeIframe;
    });
</script> 
```

`iframe_id`是 iframe 标签的 ID

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2017-02-25T01:36:08.417

为什么不这样做（对主体填充/边距进行微调）

```
<script>
  var oF = document.getElementById("iframe1");
  oF.style.height = document.body.clientHeight - oF.offsetTop - 0;
</script> 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-11-28T11:39:36.300

您可以通过测量加载/调整大小事件的主体大小并将高度设置为（全高 - 横幅高度）来做到这一点。

*请注意，目前在 IE8 Beta2 中，您无法在调整大小时执行此操作，因为该事件目前在 IE8 Beta2 中已被破坏。*

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-03-30T11:49:40.500

或者你可以去老派并使用[框架集](http://www.w3schools.com/tags/tag_frameset.asp)：

```
<frameset rows="30,*">
  <frame src="banner.swf"/>
  <frame src="inner.html" />
</frameset> 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-04-18T14:25:50.933

虽然我同意 JS 似乎是一个更好的选择，但我有一个仅适用于 CSS 的解决方案。它的缺点是，如果您必须经常向 iframe html 文档添加内容，您将不得不调整 1% 的时间。

解决方案：

尝试不为您的 html 文档**指定任何高度，**

```
html, body, section, main-div {} 
```

然后只编码：

```
#main-div {height:100%;}
#iframe {height:300%;} 
```

注意： div 应该是您的主要部分。

这应该相对有效。iframe 确实计算了可见窗口高度的 300%。如果第二个文档（在 iframe 中）的 html 内容的高度小于浏览器高度的 3 倍，则它可以工作。如果您不需要经常向该文档添加内容，这是一个永久的解决方案，您可以根据您的内容高度找到自己需要的百分比。

这是有效的，因为它可以防止第二个 html 文档（嵌入的那个）从父 html 文档继承其高度。它阻止了它，因为我们没有为它们指定一个高度。当我们给孩子一个 % 时，它会寻找它的父母，如果没有，它会获取它的内容高度。并且只有在其他容器没有被指定高度的情况下，根据我的尝试。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-10-06T18:24:41.910

“**无缝**”属性是旨在解决此问题的新标准：

[http://www.w3schools.com/tags/att_iframe_seamless.asp](http://www.w3schools.com/tags/att_iframe_seamless.asp)

分配此属性时，它将删除边框和滚动条并将 iframe 调整为其内容大小。虽然它仅在 Chrome 和最新的 Safari 中受支持

更多信息在这里： [HTML5 iFrame 无缝属性](https://stackoverflow.com/questions/4804604/html5-iframe-seamless-attribute)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2014-07-10T02:12:26.393

一个简单的jQuery解决方案

在 iframed 页面内的脚本中使用它

```
$(function(){

    if(window != top){
        var autoIframeHeight = function(){
            var url = location.href;
            $(top.jQuery.find('iframe[src="'+ url +'"]')).css('height', $('body').height()+4);
        }
        $(window).on('resize',autoIframeHeight);
        autoIframeHeight();
    }

} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2014-08-19T11:09:10.353

您不能以 % 为单位设置 iframe 高度，因为您的父身高不是 100%，所以将父身高设为 100%，然后应用 iframe 高度 100%

```
For eg.
<html>
<head>
<style>
html,body{height:100%}
</style> 
</head>
<body>
<iframe src="http://www.quasarinfosystem.com" height="100%" width="100%" ></iframe>
</body>
</html> 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2015-06-23T17:22:26.623

如果您有权访问要加载的 iframe 的内容，则可以告诉其父级在调整大小时调整大小。

```
 $(window).resize(function() {
        $(parent.document)
            .find("iframe")
            .css("height", $("body").css("height"));        
    }).trigger("resize"); 
```

如果页面上有多个 iframe，则可能需要使用 id 或其他巧妙的方法来增强 .find("iframe") 以便选择正确的 iframe。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2016-02-17T09:21:54.407

我认为使用 css 位置实现这种情况的最佳方法。设置相对于您的父 div 的位置和位置：绝对到您的 iframe。

```
.container{
  width:100%;
  position:relative;
  height:500px;
}

iframe{
  position:absolute;
  width:100%;
  height:100%;
}
```

```
<div class="container">
  <iframe src="http://www.w3schools.com">
  <p>Your browser does not support iframes.</p>
 </iframe>
</div>
```

现在，对于其他填充和边距问题，css3 calc() 非常先进，并且几乎与所有浏览器兼容。

检查[计算（）](http://caniuse.com/#feat=calc)

# wcf - 在 WCF 中，是否应该为大型消息设置较大的 MaxBufferPoolSize 值？

> ID：325275
> 
> 赞同：13
> 
> 时间：2008-11-28T08:25:21.390
> 
> 标签：wcf, performance

对于我开发的这个 WCF 服务，我必须将 MaxReceivedMessageSize 设置为 5MB。我目前的问题是弄清楚是拥有更大的 MaxBufferPoolSize 值（如 5MB）更好，还是保留原始的 512KB 值更好。

有谁知道这种情况的推荐设置是什么？
简而言之，我应该设置 MaxBufferPoolSize = 5242880 (5MB) 还是 MaxBufferPoolSize = 524288 (512KB)？

**更新：**为澄清起见，该服务旨在插入新的客户记录以及一些扫描文件。因此，邮件大小可能会达到 5MB。

我们*可以*尝试使用替代技术将扫描文档的上传分开，但是要求客户记录和扫描文档必须在同一个事务中，所以我们决定采用这种方法，直到我们弄清楚如何使用 WCF 的事务能力。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T17:59:57.843

看看这篇文章。 [http://kennyw.com/?p=51](http://kennyw.com/?p=51)

它建议将大消息的 MaxBufferPoolSize 设置为零，以避免缓冲。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-28T21:30:42.473

将大量数据传输到基于 WCF 的服务是完全可以的，但是您应该研究支持流传输而不是缓冲传输的绑定（BasicHttpBinding 或 CustomBinding），这样每个服务实例就不会占用太多内存。

--larsw

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-28T19:01:55.657

如果您尝试传输文件等，这似乎是您唯一的选择。否则，我会首先回顾一下为什么要通过服务发送如此大量的数据。如果是文件等，您将不得不忍受如此大的尺寸和可能的影响。同样，如果您要移动的是文件，您也可能想尝试使用 FTP 组件或其他东西。

我可以稍微详细地提供更多信息。我稍后会回来查看您是否在问题中添加了任何内容。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2008-12-17T15:42:44.543

5 Mb 似乎需要通过 Web 服务传输大量数据。您应该寻找的第一件事是发送更少的数据。其次，您需要根据需要设置大小。

# c# - 显示和编程游戏板的最佳方式？

> ID：325278
> 
> 赞同：6
> 
> 时间：2008-11-28T08:25:51.887
> 
> 标签：c#

在 C# 中显示和编程简单游戏板（例如国际象棋、跳棋等）的最佳方式是什么？在控制和底层游戏逻辑方面。

我想到的一个想法是将**Picture Box**（或从它继承的类）与 Board & Field 类一起使用。

*   毕竟这是一个不错的解决方案吗？
*   如何使用此解决方案将图形与游戏逻辑分开（我相信 Board & Field 类可能还不够）？
*   对于这样的目的，PictureBox 是否足够高效？

谷歌搜索一些也让我找到了为每个游戏领域使用按钮/标签的解决方案。但回到 Board、Field 和 PictureBox。

可扩展性 - 正确设计它可以轻松实现任何其他棋盘游戏（甚至纸牌游戏），因为它毕竟是具有可修改字段的棋盘。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T08:30:16.730

在面向对象的方法中，考虑游戏中涉及的对象（例如棋盘、棋子）……让它们各自提供一个绘制方法，该方法获取一个`Graphics`对象并在其上绘制自身。

绘图本身可以在 a 上完成`PictureBox`——这是用于此目的的理想控件——但这并不是那么重要，因为一旦你的绘图逻辑到位，它就不会依赖于控件的类型。

通常，*不要*使用具有不同控件的变通方法。这些对于传统的 GUI 来说可能很好。对于游戏（或任何类型的图形密集型应用程序）而言，并没有那么多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-28T09:04:19.530

从数据结构的角度来看一下位板数据结构。[http://en.wikipedia.org/wiki/Bitboard](http://en.wikipedia.org/wiki/Bitboard)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T08:38:02.190

如果你想要闪亮的，你可以试试 WPF，perf。现在还不错，而且很容易获得非常可定制的图形，从外部文件加载等等......

在概括行为方面，您可能想要分离场景图形代码（布局、绘制对象和所有无聊的低级东西），然后放置一个用于一般棋盘游戏交互的层：选择源，然后选择移动、转弯和移动的目标之类的，然后将您的游戏逻辑分层。

我可能会先让井字游戏开始，看看是否有任何地方你需要打破你的层分离，并在陷入游戏逻辑之前尽早修复它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-28T09:09:47.197

如果你觉得很有冒险精神，你可以试试 XNA ;)

是的，它比其他解决方案更复杂，并且对于棋盘游戏来说可能有点矫枉过正，但是一旦你掌握了它，你就可以自由地制作一些很棒的游戏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T12:20:27.097

一般来说，首先设计棋盘、棋子等的逻辑结构，然后对它们进行操作，最后才设计一个图形界面，或多或少作为前端。

# windows - 使用任务调度器 1.0 COM API

> ID：325289
> 
> 赞同：1
> 
> 时间：2008-11-28T08:32:34.027
> 
> 标签：windows, com, scheduled-tasks

我正在尝试用 VC++ 编写一个简单的程序，它只会初始化任务调度程序。我正在遵循[MSDN 站点上建议的示例](http://msdn.microsoft.com/en-us/library/aa446829(VS.85).aspx)，但我从链接器中得到未解决的符号错误。

错误在这一行：

```
 hr = CoCreateInstance(CLSID_CTaskScheduler,
                           NULL,
                           CLSCTX_INPROC_SERVER,
                           IID_ITaskScheduler,
                           (void **) &pITS); 
```

我得到的错误是：

错误 LNK2001：未解析的外部符号`_CLSID_CTaskScheduler`

相同的错误`_IID_ITaskScheduler`。我包含了相关的头文件。我是否还需要向任何其他 DLL 添加依赖项？

谢谢，

罗希特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T09:26:38.253

好的，我自己发现的。您需要将 mstask.lib 添加为附加依赖项。转到项目属性 -> 链接器 -> 输入 -> 附加依赖项并添加 mstask.lib。链接器错误应该消失。

# java - 使用 Java 1.5 打开文件的跨平台方式

> ID：325299
> 
> 赞同：11
> 
> 时间：2008-11-28T08:41:40.093
> 
> 标签：java, linux, file-association, jdk1.5

我正在使用 Java 1.5，我想启动关联的应用程序来打开文件。我知道 Java 1.6 引入了[Desktop API](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/javase6/desktop_api/)，但我需要**Java 1.5**的解决方案。

到目前为止，我找到了一种在 Windows 中执行此操作的方法：

```
Runtime.getRuntime().exec(new String[]{ "rundll32", 
                          "url.dll,FileProtocolHandler", fileName }); 
```

有跨平台的方法吗？或者至少有一个类似的**Linux**解决方案？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-28T11:15:01.967

```
public static boolean isWindows() {
    String os = System.getProperty("os.name").toLowerCase();
    return os.indexOf("windows") != -1 || os.indexOf("nt") != -1;
}
public static boolean isMac() {
    String os = System.getProperty("os.name").toLowerCase();
    return os.indexOf("mac") != -1;
}
public static boolean isLinux() {
    String os = System.getProperty("os.name").toLowerCase();
    return os.indexOf("linux") != -1;
}
public static boolean isWindows9X() {
    String os = System.getProperty("os.name").toLowerCase();
    return os.equals("windows 95") || os.equals("windows 98");
} 
```

和

```
 if (isLinux())
  {
     cmds.add(String.format("gnome-open %s", fileName));
     String subCmd = (exec) ? "exec" : "openURL";
     cmds.add(String.format("kfmclient "+subCmd+" %s", fileName));
  }
  else if (isMac())
  {
     cmds.add(String.format("open %s", fileName));
  }
  else if (isWindows() && isWindows9X())
  {
     cmds.add(String.format("command.com /C start %s", fileName));
  }
  else if (isWindows())
  {
     cmds.add(String.format("cmd /c start %s", fileName));
  } 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-28T11:46:56.883

[JDIC](http://javadesktop.org/articles/jdic/)是一个在 Java 1.5 中提供类似桌面功能的库。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-28T18:14:42.950

[对此答案](https://stackoverflow.com/questions/325299/#325517)+1

另外，我建议使用多态性进行以下实现：

通过这种方式，您可以通过减少类之间的耦合来更轻松地添加新平台。

*客户端代码：*

```
 Desktop desktop = Desktop.getDesktop();

 desktop.open( aFile );
 desktop.imaginaryAction( aFile ); 
```

*桌面实现：*

```
package your.pack.name;

import java.io.File;

public class Desktop{

    // hide the constructor.
    Desktop(){}

    // Created the appropriate instance
    public static Desktop getDesktop(){

        String os = System.getProperty("os.name").toLowerCase();

        Desktop desktop = new Desktop();
         // This uf/elseif/else code is used only once: here
        if ( os.indexOf("windows") != -1 || os.indexOf("nt") != -1){

            desktop = new WindowsDesktop();

        } else if ( os.equals("windows 95") || os.equals("windows 98") ){

            desktop = new Windows9xDesktop();

        } else if ( os.indexOf("mac") != -1 ) {

            desktop = new OSXDesktop();

        } else if ( os.indexOf("linux") != -1 && isGnome() ) {

            desktop = new GnomeDesktop();

        } else if ( os.indexOf("linux") != -1 && isKde() ) {

            desktop = new KdeDesktop();

        } else {
            throw new UnsupportedOperationException(String.format("The platform %s is not supported ",os) );
        }
        return desktop;
    }

    // default implementation :( 
    public void open( File file ){
        throw new UnsupportedOperationException();
    }

    // default implementation :( 
    public void imaginaryAction( File file  ){
        throw new UnsupportedOperationException();
    }
}

// One subclass per platform below:
// Each one knows how to handle its own platform   

class GnomeDesktop extends Desktop{

    public void open( File file ){
        // Runtime.getRuntime().exec: execute gnome-open <file>
    }

    public void imaginaryAction( File file ){
        // Runtime.getRuntime().exec:gnome-something-else <file>
    }

}
class KdeDesktop extends Desktop{

    public void open( File file ){
        // Runtime.getRuntime().exec: kfmclient exec <file>
    }

    public void imaginaryAction( File file ){
        // Runtime.getRuntime().exec: kfm-imaginary.sh  <file>
    }
}
class OSXDesktop extends Desktop{

    public void open( File file ){
        // Runtime.getRuntime().exec: open <file>
    }

    public void imaginaryAction( File file ){
        // Runtime.getRuntime().exec: wow!! <file>
    }
}
class WindowsDesktop extends Desktop{

    public void open( File file ){
        // Runtime.getRuntime().exec: cmd /c start <file>
    }

    public void imaginaryAction( File file ){
        // Runtime.getRuntime().exec: ipconfig /relese /c/d/e
    }
}
class Windows9xDesktop extends Desktop{

    public void open( File file ){
        //Runtime.getRuntime().exec: command.com /C start <file>
    }

    public void imaginaryAction( File file){
       //Runtime.getRuntime().exec: command.com /C otherCommandHere <file>
    }
} 
```

这只是一个例子，在现实生活中创建一个新类只是为了参数化一个值（命令字符串 %s ）是不值得的，但是让我们想象每个方法以特定于平台的方式执行另一个步骤。

使用这种方法，可能会删除不需要的 if/elseif/else 结构，这些结构随着时间的推移可能会引入错误（如果代码中有 6 个这样的结构并且需要更改，您可能会忘记更新其中一个，或者通过复制 /粘贴您可能会忘记更改要执行的命令）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-28T23:45:54.873

就像一个补充：而不是`gnome-open`，使用`xdg-open`。它是[XdgUtils](http://portland.freedesktop.org/wiki/)的一部分，而后者又是 LSB 桌面支持包的一部分（从 3.2 开始）。

您可以（应该）仍将`gnome-open`其用作后备，但`xdg-open`也可以在非 GNOME 桌面上工作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-28T08:58:28.623

[SWT](http://www.eclipse.org/swt/)使您可以通过以下方式为标准程序打开文件：

```
final Program p = Program.findProgram(fileExtension);
p.execute(file.getAbsolutePath()); 
```

严格来说，这不是跨平台的，因为 SWT 依赖于平台，但是对于每个平台，您都可以使用不同的 SWT jar。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T09:05:00.140

您可以使用操作系统默认方式为您打开它。

*   Windows：“cmd /c*文件名*
*   Linux w/gnome “gnome-open*文件名*”
*   Linux w/Kde ??
*   OSx“打开*文件名*”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-17T19:19:31.143

另一个答案（通过 boutta）建议使用 SWT。我不建议仅出于此目的引用该库，但如果您已经在使用它，只需执行：

```
Program.launch("http://google.com/"); 
```

请注意，此方法仅在已创建对象（例如通过创建）时才有效（并返回`true`）。还要注意它必须在主线程中运行；例如：`Display``Shell`

```
Display.syncExec(new Runnable() {
    public void run() {
        Program.launch("http://google.com/");
    }
}); 
```

在上面的示例中，我启动了一个 URL，但启动文件的工作方式相同。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2008-11-28T18:22:55.773

我们确实将命令放在配置文件的某个位置之外。

您的“JAR 和源代码”将是“跨平台的”，但您的部署不是。

您也可以执行类似[此答案](https://stackoverflow.com/questions/325299/cross-platform-way-to-open-a-file-using-java-15#326360)的操作。您可以将“Deskop”实现的工厂类的类名放入设置文件中。（如果你愿意，可以是指南或弹簧）

# performance - 优化代码

> ID：325301
> 
> 赞同：11
> 
> 时间：2008-11-28T08:44:39.027
> 
> 标签：performance, language-agnostic, optimization

你会得到一堆用你最喜欢的语言编写的代码，这些代码组合起来形成了一个相当复杂的应用程序。它运行得相当慢，你的老板要求你优化它。**您遵循哪些步骤来最有效地优化代码？**

在优化代码时，您发现哪些策略**不成功？**

**重写**：在什么时候你决定停止优化并说“这与没有完全重写的速度一样快”。在什么情况下你会提倡简单的完全重写？你会如何设计它？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-11-28T08:47:09.177

在尝试任何优化之前进行分析。

10 次中有 9 次，时间不会消耗在您可能猜到的地方。

通常不成功的策略是微优化，而实际上需要的是适当的算法。

强制性 Donald Knuth 报价：

> *“我们应该忘记小的效率，比如大约 97% 的时间：过早的优化是万恶之源”*

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-11-28T08:49:40.590

脚步：

1.  措施
2.  分析
3.  决定
4.  实施
5.  重复

首先获取一个分析器来测量代码。不要陷入假设你知道瓶颈在哪里的陷阱。即使事后，如果您的假设被证明是正确的，也不要认为您可以在下次执行类似任务时跳过测量步骤。

然后分析你的发现。查看代码，确定您可以做些什么的瓶颈会产生影响。尝试估计这将有多大的改进。

根据您的分析决定是否要走这条路。收益是否值得？是否需要重写？也许您发现虽然它运行缓慢，但它已达到预期效果，或者您已接近性能曲线的顶部，在这种情况下，不需要进行微小改进所需的工作。

实施您的更改，在必要时进行重写，或者重构代码（如果这是您走的路）。分小步进行，以便轻松衡量您的更改是否达到了您想要的效果，或者您是否需要回溯一个步骤并尝试不同的路线。

然后回到起点，测量、分析、决定、实施等。

另外，关于重构代码的注意事项。您应该更改的第一件事是大型算法级方法。诸如将排序算法替换为性能更好的排序算法等。不要从行级优化开始，例如如何使增加值的行运行得稍微快一些。这些是最后一级优化，通常不值得，除非您在极端性能条件下运行。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-28T08:53:17.293

如果没有*某种*分析，甚至都不要费心去尝试**任何事情**，我不能强调这一点！不幸的是，我认识的所有分析器要么很烂，要么很贵（是的，业务成本！）所以我会让其他人在那里提出建议:)。

 *当您的数据告诉您需要重写时，您知道您需要重写，这听起来是递归的，但实际上只是意味着您当前架构或软件堆栈的成本本身就足以将您推向性能悬崖，因此您在本地更改中所做的任何事情都无法解决整体问题。然而，在你使用 File->New... 命令之前，制定一个计划，构建一个原型并测试原型在相同任务中的表现优于当前系统：令人惊讶的是，没有明显差异的频率！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-28T09:15:48.027

首先不要忘记这些：

*   过早的优化是万恶之源
*   性能来自设计

第二;

**不要假设尝试看看**

我认为这是优化的基本规则，测试它，除非你测试它并证明它工作你不会知道。

在你的情况下，我要做的是，首先**重构代码**，掌握它。

如果您进行了单元测试，那么您很幸运，只需逐个函数执行，特别是检查**最常调用的**代码（使用*分析*来观察调用以及瓶颈在哪里）。如果您没有测试，请编写一些基本测试来确认某些条件下的整体输出，这样您就可以确保您没有破坏任何东西并**可以自由地进行实验**。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-28T09:10:35.120

除了分析，正如大家提到的，我总是首先（在分析之后）使用的两个解决方案是记忆化和延迟加载，它们都很容易实现并且通常会产生很大的不同。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-28T13:09:04.750

所有好的答案。

我会完善建议的“衡量”部分。我进行测量是为了量化我可能做出的任何改进。但是，为了*找到*需要修复的内容（这是一个不同的目的），我*手动*获取了调用堆栈的几个样本。

假设，为简单起见，程序需要 20 个千兆周期才能运行，而它应该需要 10 个。如果我随机暂停它 10 次，那么在其中 5 次或多或少的情况下，它将处于那些不必要的周期之一. 我可以通过查看调用堆栈的每一层来查看循环是否必要。如果可以消除堆栈任何级别的任何调用指令，则循环是不必要的。如果这样的指令出现在多个堆栈上，消除它**会**加速程序，其速度大约是它所在的堆栈样本的百分比。

任何出现在多个堆栈上的指令都是可疑的——堆栈越多，越可疑。现在，`call _main`可能不是我可以删除的，但
`foo.cpp:96 call std::vector::iterator:++`
如果它出现在多个堆栈上，绝对是关注的焦点。

出于风格原因，人们可能*不想*更换它，但人们会大致知道该选择所付出的性能代价。

因此，优化包括识别嫌疑人并找到替代或消除嫌疑人的方法。

困难的部分（我已经做过很多次了）是理解什么是必要的，什么不是。为此，您将了解该程序中的事情是如何以及为什么完成的，因此如果某些活动是循环猪，您可以知道如何安全地替换它。

一些自行车可能很容易修复，但您很快就会遇到不知道如何安全更换的自行车。为此，您需要更熟悉代码。

如果您可以挑选已经参与过该程序的人的大脑，这将有所帮助。

否则（假设代码约为 10 ^ 6 行，就像我一直在研究的那样）你可以相当容易地获得一些加速，但除此之外，可能需要几个月的时间才能达到你愿意做出重大改变的地方。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-28T08:56:32.310

确保有足够的单元测试以确保您将进行的任何优化都不会破坏任何东西

确保限定您的*执行环境*。有时，执行选项中的简单更改可能会有很长的路要走。

然后，只有这样，才开始分析代码。

仅当有足够的未来发展可能不被当前架构支持时，才应考虑重写决定（对于已经*工作的代码）。*
如果简单的修复可以加速不应该发展太多的代码，那么就不需要完全重写。

停止的标准通常是与最终用户（客户）合作确定的，但我建议使用*正式文档*来确定通过此优化过程实现的目标。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-28T09:12:39.903

首先决定你的优化目标是什么——为给定硬件平台上特定操作的时间设定目标。准确测量性能（确保您的结果是可重复的）并在类似生产的环境中（没有 VM 等，除非这是您在生产中使用的！）。

然后，如果您认为它已经足够快，您可以停在那里。

如果它仍然不够好，那么将需要一些额外的工作 - 这就是分析的用武之地。您可能无法很好地使用分析器（例如，如果它对行为的影响太大），在这种情况下，仪器应改为使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-28T09:53:41.727

假设代码需要优化，那么我会使用： 1.) 优化使用缓冲区的处理方式 - 缓存优化。缓存延迟是一个很大的领域，它会像坏的一样吸收 CPU 周期。大致在 5-10 % 的开销范围内因此以缓存有效的方式使用数据缓冲区。

2.) 关键循环和 MCPS 密集型函数可以用汇编语言或使用编译器为该硬件目标提供的低级内在函数进行编码。

3.) 从外部存储器读/写是周期昂贵的。尽可能减少外部存储器访问。或者，如果您必须以有效的方式访问（预加载数据、并行 DMA 访问等）

通常，如果您通过以下优化技术获得大约 20% 的优化（最佳情况），我会说这已经足够好并且足够好，无需任何重大的代码重组、算法重新设计。之后它变得诡计、复杂和乏味。

-广告

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-28T10:58:13.000

我在 Linux 上的 C 和 C++ 数值计算方面做了最多优化的语言。我发现分析虽然有用，但可以使您的运行时结果产生偏差，从而使廉价的、经常调用的操作（如 c++ 迭代器增量）。所以带上一粒盐。就产生良好加速的实际策略而言：

1.  使用数值数组而不是对象数组。例如，c++ 具有“复杂”数据类型。对这些数组的操作比对两个浮点数组的类似操作慢得多。这可以概括为对任何性能关键代码“使用机器类型”。
2.  编写代码以使编译器更有效地进行优化。例如，如果您有一个固定大小的数组，请使用数组索引，以便自动矢量化（英特尔编译器的一项功能）可以工作。
3.  如果您的问题适合它们设计的那种域（同时乘/除浮点数或整数），SIMD 指令可以提供很好的加速。这是 MMX、SSE、SSE2 等的东西。
4.  对精确值不重要的昂贵函数使用带有插值的查找表。这并不总是好的，因为在内存中查找数据本身可能很昂贵。

我希望这能给你一些启发！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-28T13:38:37.673

正如许多其他人已经说过的那样，分析是您的第一步。

我要补充一点，首先关注数据结构和算法通常比直接进行微优化更有利可图。

一方面，编译器通常会为您执行许多经典的优化技巧（而且通常比您更好）。这在更现代的语言（如 C#）中尤其如此，而不是在旧的、约束较少的语言 C 中，因为编译器对程序结构有更多的了解；更糟糕的是，通过“优化”混淆你的代码实际上会使编译器更难应用它自己的、更有效的优化。

不过，大多数情况下，当您开始改进您的运营的大事时，还有更多的空间可以改进。例如，搜索一个链表是 O(n)；这意味着搜索它所花费的时间以与存储在其中的数据大小相同的速度增加。搜索哈希表只需 O(1)，因此您可以在不增加搜索时间的情况下添加更多数据（当我们离开理论世界时还有其他因素，所以这并不完全正确，但大多数情况下它是正确的时间）。

弄乱你的循环，使它们从高到低运行，因此生成的代码可以使用 JumpIfZero 而不是 JumpIfLessThan 节省几个时钟周期可能不会产生完全相同程度的影响！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-05-23T07:58:19.890

**好策略**

除了提到的优化的基本法则（衡量，如果没有必要就不要优化），虽然这个问题明确要求**效率**，但我总是在检查期间**重构**这样的代码。

通常情况下，性能不佳的代码也会被错误地记录下来。因此，通过重构，我确保代码本身可以更好地记录并且更易于理解。这是确保我知道我在优化什么的基础（因为在大多数情况下，对那段代码的要求也不会完全可用）。

**何时停止**

对于性能非常差的应用程序，您通常会在分析器中为单个方法（或一组相关方法）显示运行时峰值，这表明存在编程错误或设计缺陷。因此，如果分析方法的运行时分布大致均等（或者如果显示的大多数瓶颈方法是平台代码，如 Sun Java 方法），我通常会停止。如果您的客户需要进一步优化，您将不得不重新设计应用程序的较大部分，而不是优化现有代码。

# windows-xp - Cygwin sshd 服务的 SSH 密码/用户问题

> ID：325305
> 
> 赞同：1
> 
> 时间：2008-11-28T08:46:05.090
> 
> 标签：windows-xp, ssh, cygwin, sshd

我刚刚使用 RAT 在海外的 Windows XP Pro 机器上通过 Cygwin 设置了 SSHd，并从安装中排除了 openssh 包。我运行了 cywin shell（来自 c:\cywin）并运行了现在，它位于一个我知道是安全且正确转发的端口下，但我不会分享它的号码。这不是一个常见的端口，但它低于 40000。防火墙已关闭等。我在盒子上创建的第一个管理员帐户。（它是完整的管理员）我已经运行了以下命令

`chmod +r /etc/passwd
chmod +r /etc/group
hmod 777 /var
/*Created New Admin User Account To Be Used via SSH*/
mkpasswd -cl > /etc/passwd
mkgroup --local > /etc/group`

我可以在本地连接，但不能在外部连接。我知道我的端口等都很好。

任何可能的问题，因为我真的需要这条隧道：P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-21T16:48:21.393

通过本地连接，您的意思是您尝试过`ssh localhost`吗？如果是这样，您可能只将 sshd 绑定到 127.0.0.1 接口。检查您的 /etc/sshd_config 以获取以下行：

```
ListenAddress 0.0.0.0 
```

然后通过 ssh-ing 到实际的 IP 地址而不是 localhost/127.1 来测试它。

如果这可行，那么您可能有 NAT 或防火墙问题，但问题不再在 Cygwin 上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T12:35:02.787

如何尝试以下方法：

1）你说它在本地工作，但通过连接到 127.0.0.1 / **localhost**来确保端口正常，并且你得到“SSH握手”。例如，如果您使用端口 1234，您可以运行：

> > 远程登录本地主机 12345

你应该得到类似的东西：

> > SSH-2.0-OpenSSH_5.1p .....

2) 确保远程主机的端口正常。
从**远程**主机再次运行 telnet 并查看是否收到 SSH 提示。

如果你能做到以上，那么你知道你的服务器正在监听。如果您仍然无法从远程连接，请检查您的签名是否正常。例如删除您客户端上的 known_hosts(2) 等。

在 Windows 中，请注意 sshd 将在另一个“环境/shell”下从命令行或您的本地用户帐户运行。您可以将服务设置为以指定用户或本地系统帐户运行，因此请确保您的“帐户环境”正常。一种调试方法是启用本地系统帐户并启用与桌面交互。然后，您可以在 cygwin 服务安装工具的注册表中添加“-d”开关。您也可以参考[此链接](http://www.certaintysolutions.com/tech-advice/ssh_on_nt.html)了解一些信息。

我敢肯定，如果您遵循“/usr/share/doc/Cygwin/openssh.README”，您应该能够使其正常运行。你也可以[谷歌](http://www.google.com/search?q=openssh.README.txt)搜索这个文档。

# openid - 在英语以外的其他语言中使用 RPX 或类似的 openID 选择器

> ID：325306
> 
> 赞同：3
> 
> 时间：2008-11-28T08:46:52.187
> 
> 标签：openid, translation, rpx

当您登录 Stackoverflow 时，您会在文本输入字段和提交按钮之间看到一个带有 openID 徽标的按钮。

当您单击此按钮时，您会看到一个包含主要 openID 提供程序的下拉列表。这是一个集成的第 3 方服务，称为“ID 选择器”，已被弃用，取而代之的是它的继任者 RPX ( [rpxnow.com](http://rpxnow.com) )。RPX 甚至让用户可以使用现有的 Facebook、AOL、Google 等帐户登录。

这是一项**出色的服务**，但我需要*德语*版本，而且似乎只有*英语*版本。

有没有人遇到过这个问题并可以分享想法？或者有没有人解决它？如果我不能仅仅因为无法翻译（@PhiLho：see*）js 弹出窗口中的这几个字符串而无法使用这项出色的服务，那将是一个遗憾...

**编辑**：*作为一个编程术语：获取，翻译，返回......就像翻译（）;

问题是，我可以取出字符串并注入我的翻译吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-29T14:53:23.777

感谢您对 RPX 的好评。翻译在短期路线图上。

更新：翻译已经实施。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-29T11:30:04.497

实际上，您可能想查看我昨天开始合并到[Stacked](http://stacked-ra.ajax.org)中的 DotNetOpenID。我还没有玩太多，显然我不关心英语以外的任何其他东西（至少），但它似乎很有希望...... :)

# select - 道场网格中的多选组合框

> ID：325321
> 
> 赞同：2
> 
> 时间：2008-11-28T09:02:19.363
> 
> 标签：select, dojo, grid

我已经实现了自定义的单选组合框作为 dojo 网格中的单元格元素。有人可以告诉我如何实现多选组合框吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-28T18:39:37.423

回答您的高度具体问题的最佳方式是通过官方渠道，例如[Dojox Grid Support](http://dojotoolkit.org/forum/532)。

# security - 有没有办法避免 Lua 中的这个安全问题？

> ID：325323
> 
> 赞同：7
> 
> 时间：2008-11-28T09:03:39.580
> 
> 标签：security, lua

我只是在研究一个可本地化的 Lua 字符串解决方案，当我想出这个 hack 时，问题是我不知道如何避免被它攻击 :) 所以我想知道是否有人做过类似的事情或者知道如何以保护免受这种攻击。（在用户代码中）

因为我们可以这样做：

```
=("foo"):upper() -->output: FOO 
```

它可以像这样被黑客入侵：

```
getmetatable("foo").__index.upper = function() print("bye bye sucker");os.exit() end
=("foo"):upper() -->output: bye bye sucker (application quits)
-- or this way
=string.upper("bar") -->output: bye bye sucker (application quits) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-28T17:55:54.970

First and foremost execute untrusted code in sandboxed environment only – as it was said by other posters. Except for loading bytecode chunks, Lua allows all other sandboxing issues to be covered. (And bytecode chunk problems get fixed promptly as discovered.)

See [Lua Live Demo](http://www.lua.org/cgi-bin/demo) for an example of sandboxing. Sources are available [here](http://www.tecgraf.puc-rio.br/~lhf/ftp/lua/#demo).

Your specific problem with metatables is solved by setting a `__metatable` field:

> If you set a `__metatable` field in the metatable, `getmetatable` will return the value of this field, whereas `setmetatable` will raise an error.
> 
> – Roberto Ierusalimschy, Programming in Lua 1st edition, 13.3 - [Library-Defined Metamethods](http://www.lua.org/pil/13.3.html)

For example:

```
> mt = { __metatable = true }                                                   
> t = {}
> setmetatable(t, mt)
> setmetatable(t, mt)
stdin:1: cannot change a protected metatable
stack traceback:
 [C]: in function 'setmetatable'
 stdin:1: in main chunk
 [C]: ? 
```

So, all you have to do is:

```
getmetatable("").__metatable = true 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-28T09:19:06.630

如果您的黑客能够添加代码，并且您需要允许该代码调用诸如 os.exit 之类的东西，那么无论如何您都非常不走运。

不过，您可以限制他们的代码可以调用的函数。这取决于您仍然希望用户代码能够做什么。请参阅 setfenv 的文档和 google 的“lua 沙盒”文档

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-28T09:30:57.310

我不确定您为什么会遇到问题，因为您可能已经了解沙盒：您可以删除像 io.exit 这样的危险函数，并且可以确保被覆盖的函数只是用户全局表中的函数，即。应用程序内部使用的 Lua 函数将保持不变。
无论如何，如果黑客可以直接调用 os.exit，那么他可以通过对他稍后将使用的无辜函数进行增压而将自己开枪打死自己的事实是他的问题。
此外，只有在您的服务器上运行用户功能时才会出现问题，例如：如果黑客再次破坏了他的系统，那就是他的问题！
现在，还有分发危险代码的问题：由您来限制用户脚本的权力。毕竟，这就是浏览器对 JavaScript 所做的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-28T09:41:35.650

This *security problem* is typically illustrated with this sentence, said by Ford Prefect in the brilliant books *The Hitchhiker's Guide to the Galaxy*: [It rather involved being on the other side of this airtight hatchway](http://blogs.msdn.com/oldnewthing/archive/2007/08/07/4268706.aspx)

My ability to write code cannot be said to be a security vulnerability, and if you can't control your code, *that* is your security problem, not what that code can do.

There are tons and tons of things you can do if you can just get the machine to execute some of your code. The security is to avoid getting the code in there in the first place. Everything after that is just collateral damage.

The way to avoid being hacked by that problem is to avoid getting unknown code into your application.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T11:45:25.660

I don't see the possibility to redefine `upper` as the problem. Being able to see `os.exit` is the problem.

As suggested by others, make a sandboxed environment for your scripts. Each script can get a new one; then a person can redefine upper or anything like that, and all they'll screw up is their own thing.

Creating Lua states is so fast and easy, this won't cause any problems.

Another thing you might beware of is eternal loops. Making a 'watchdog' that kills a script after, say, 10000 instructions takes about 10 lines of C code. I can send you sample if you need.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T09:33:31.517

I have no solution (I don't use Lua, I'm just interested in it from afar), but what you're after is called a "sandbox". Google for [Lua sandbox](http://www.google.com/search?q=Lua+sandbox), I found a few seemingly interesting pages that way. For example: [http://lua-users.org/wiki/SandBoxes](http://lua-users.org/wiki/SandBoxes).

# multithreading - EventLog 间歇性异常

> ID：325325
> 
> 赞同：3
> 
> 时间：2008-11-28T09:03:55.150
> 
> 标签：multithreading, event-log

`EventLog`我有一些使用 C# 和 .Net类写入 Windows 事件日志的代码的间歇性问题。

基本上，这段代码每天都能完美运行，但我们偶尔会开始遇到如下错误：

> “System.ArgumentException：只有自定义日志名称的前八个字符有意义，并且系统上已经有另一个使用给定名称的前八个字符的日志。给定的名称：'应用程序'，现有日志的名称：'应用'。”

我可以从我们日志上的其他信息中确定受影响的调用堆栈是这样的 - 您可以清楚地看到我实际上正在尝试写入现有`LB_Email`日志（`LogEmail`首先调用）：

```
public static void LogEmail(string to, string type)
{
    string message = String.Format("{0}\t{1}\t{2}", DateTime.Now, to, type);
    Log(message, "LB_Email", EventLogEntryType.Information);
}

private static void Log(string message, string logName, EventLogEntryType type)
{
    using (EventLog aLog = new EventLog())
    {
        aLog.Source = logName;
        aLog.WriteEntry(message, type);
    }
} 
```

一旦错误开始发生，似乎对我们的事件日志的访问以`LB_Email`某种方式被锁定 - 查看特定事件日志上的属性显示大多数信息灰显且不可更改，并且其他进程似乎也被阻止记录到该日志。但是，我通过记录到“LB_Error”日志的 try-catch 看到错误（使用上述相同的 Log 方法），并且继续按预期运行。

我正在从多线程应用程序调用此代码，但我无法确定上面的代码是否是线程安全的。

我还可以确认有问题的日志在终止并重新启动进程后再次正常工作......并且它具有适当的设置以在它满时重用条目......虽然我不认为这是问题所在。

我很想听听您的想法和建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T09:45:42.053

该[文件](http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.aspx)指出：

> 您一次只能使用 Source 写入一个日志

所以我怀疑这个问题是由于您的多线程应用程序`Log`在给定时间多次调用该方法并为同一个源引起的。

我建议您使用线程安全的单例类来记录这些事件，而不是静态类（或方法）。

编辑：

Jon Skeet 有一篇关于单例的[优秀文章](http://www.yoda.arachsys.com/csharp/singleton.html)。

如果您不想实现单例类，可以执行以下操作：

```
 static readonly object lockObj = new object();

    public static void LogEmail(string to, string type)
    {
        string message = String.Format("{0}\t{1}\t{2}", DateTime.Now, to, type);
        Log(message, "LB_Email", EventLogEntryType.Information);
    }

    private static void Log(string message, string logName, EventLogEntryType type)
    {
        lock (lockObj)
        {
            using (EventLog aLog = new EventLog())
            {
                aLog.Source = logName;
                aLog.WriteEntry(message, type);
            }
        }
    } 
```

希望这能解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T10:43:51.453

谢谢布鲁诺，

那么，我是否误以为 Log 方法中的 EventLog 实例与不同线程中同一方法调用中的 EventLog 实例不同？还是我只是对静态方法中的对象实例感到困惑？

好的，所以我对 Log(...) 方法有几个包装器方法。如果我将 Log 方法移动到单例类中，更改了包装器（LogEmail、LogXxxx、LogYyy 等），那么我可以保持我的 Log.Zzzz 接口相同，但利用单例 LogSingleton.Instance.Log(...)从当前日志。或者因为我想写入不同的日志，每个日志都需要自己的 LogSingletonXxx 吗？

你可以说我很困惑 :) 是的 - 我真的很感激一些同步代码 :)

尼日

# eclipse - 在 Eclipse 中使用更新站点的规则？

> ID：325328
> 
> 赞同：6
> 
> 时间：2008-11-28T09:07:10.773
> 
> 标签：eclipse, automation

您知道有关使用更新站点规则的任何文档吗？过去两年半我一直在管理我们公司的更新站点，这些是我必须解决的问题：

*   并非所有项目都使用相同的 eclipse 版本。我们有使用 eclipse 2.1 (WSAD)、eclipse 3.0 (RAD 6)、eclipse 3.2 (RAD 7)、eclipse 3.3 和 eclipse 3.4 的项目。
*   我们公司的更新站点大多是打包在一起的。所以我写了一些小插件（有时是片段）来打包我们公司的Checkstyle配置和当前版本的Checkstyle。
*   我们每年发布两次新版本的变化。因此，如果我有 1 个或 4 个更新站点，这将极大地改变我必须承担的负载。

所以问题是：我们应该使用多少个更新站点，如果数量超过 1，我怎样才能最大限度地减少维护更新站点的工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T10:03:14.140

我建议将所有内容放在一个 Web 服务器上，并将每个版本的 Eclipse 的包部署到不同的 URL：

[http://your.server/eclipse-3.3/site.xml](http://your.server/eclipse-3.3/site.xml)
[http://your.server/eclipse-3.4/site.xml](http://your.server/eclipse-3.4/site.xml)
等。

这将使其易于部署，将事物分开，并使用户可以轻松地看到“啊，这是给我的”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T10:07:48.733

您可能应该使用按 Eclipse 版本划分的功能和类别。

```
|
+-WSAD-2-1 Category
|   |
|   +- Checkstyle 3.1 Feature
|   |
|   `- Team Checkstyle configuration for Checkstyle 3.1
|   
`-Eclipse-3-4 Category
    |
    +- Checkstyle 4.4 Feature
    |
    `- Tema Checkstyle configuration for Checkstyle 4.4 
```

这可能与维护多个更新站点是同构的，尽管可以考虑：

*   坚持工作的最低公分母，并最大限度地减少错误
*   不能合理地期望为 Eclipse 3.4 编写的插件适用于 Eclipse 2.1。
*   Eclipse 版本之间的一些版本冲突给插件编写者带来了一定程度的升级痛苦（例如 3.0 到 3.1 是一个很大的跳跃）
*   同一产品的不同版本之间的配置可能不兼容。
*   同一插件的版本可能具有不同的功能集，但不适用于所有版本（例如 Checkstyle 5 支持 Java 5，但可能不适用于与 Eclipse 2.1 一起使用的 Checkstyle 插件）

但是，如果不可能或不希望有多个级别的类别，那么将上面建议的类别提升到单独的更新站点是前进的方向。

这具有部署优势，因为可以将用户指向他们正在使用的 IDE 版本的更新站点，但这正是您要避免的。

# c# - Visual Studio C#-settings 和 StyleCop（MS 源代码分析）

> ID：325330
> 
> 赞同：3
> 
> 时间：2008-11-28T09:09:36.387
> 
> 标签：c#, visual-studio, coding-style, conventions, stylecop

是否有人在 XML 或 .vssettings 文件中具有与[StyleCop](http://code.msdn.microsoft.com/sourceanalysis)兼容的 Visual Studio 设置？

我使用《[框架设计指南：可重用 .NET 库的约定、惯用语和模式》](https://rads.stackoverflow.com/amzn/click/com/0321545613)一书来指导 Microsoft 发现什么是格式化 C# 并相应地设置我的 Visual Studio 设置的正确方法。

但是当我在 Visual Studio 中使用“格式化文档”时，StyleCop 会在所有气缸上开火并抱怨各种事情。

有些错误甚至似乎无法在设置中设置。就像花括号应该在新行上一样，如果某些内容跨越多行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T12:32:14.407

[ReSharper 的 StyleCop](http://www.codeplex.com/StyleCopForReSharper)肯定会有所帮助：

用于 ReSharper 的 StyleCop 现在功能完整，已达到与 StyleCop 4.3 相同的功能。

有 148 条 StyleCop 规则。

*   其中 38 个必须手动修复（通常是因为您必须输入描述性文本或重命名变量）。
*   在剩余的 110 条规则中，有 58 条由 R# Code Cleanup（静默模式）修复。
*   在剩下的 52 个中，我们有自动修复所有这些的代码清理规则。

我们还提供了 106 个快速修复，为违反 110 条规则提供了上下文菜单修复，这些规则可以自动修复

我们还发布了“StyleCop 友好的 ReSharper 代码样式共享设置文件”，它将 ReSharper 配置为以 StyleCop 友好的方式自动格式化代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T17:00:50.177

它要花钱，但有人[为 StyleCop 制作了一个 ReSharper 插件](http://www.codeplex.com/StyleCopForReSharper)。感谢您发布问题，我以前从未听说过 StyleCop。

# php - 在 PHP 中解析动态文本列表的最佳方法

> ID：325337
> 
> 赞同：2
> 
> 时间：2008-11-28T09:12:59.843
> 
> 标签：php, regex, text, parsing

我在下面有一个文本列表，它来自一个名为 EVE Online 的流行在线游戏，当你在游戏中杀死一个人时，这基本上会邮寄给你。我正在构建一个工具来使用 PHP 解析这些以提取所有相关信息。我将需要显示的所有信息，并且我正在编写类以将其很好地分解为相关的封装数据。

```
2008.06.19 20:53:00

Victim: Massi
Corp: Cygnus Alpha Syndicate
Alliance: NONE
Faction: NONE
Destroyed: Raven
System: Jan
Security: 0.4
Damage Taken: 48436

Involved parties:

Name: Kale Kold
Security: -10.0
Corp: Vicious Little Killers
Alliance: NONE
Faction: NONE
Ship: Drake
Weapon: Hobgoblin II
Damage Done: 22093

Name: Harulth (laid the final blow)
Security: -10.0
Corp: Vicious Little Killers
Alliance: NONE
Faction: NONE
Ship: Drake
Weapon: Caldari Navy Scourge Heavy Missile
Damage Done: 16687

Name: Gistatis Tribuni / Angel Cartel
Damage Done: 9656

Destroyed items:

Capacitor Power Relay II, Qty: 2
Paradise Cruise Missile, Qty: 23
Cataclysm Cruise Missile, Qty: 12
Small Tractor Beam I
Alloyed Tritanium Bar, Qty: 2 (Cargo)
Paradise Cruise Missile, Qty: 1874 (Cargo)
Contaminated Nanite Compound (Cargo)
Capacitor Control Circuit I, Qty: 3
Ballistic Deflection Field I
'Malkuth' Cruise Launcher I, Qty: 3
Angel Electrum Tag, Qty: 2 (Cargo)

Dropped items:

Ballistic Control System I
Shield Boost Amplifier I, Qty: 2
Charred Micro Circuit, Qty: 4 (Cargo)
Capacitor Power Relay II, Qty: 2
Paradise Cruise Missile, Qty: 10
Cataclysm Cruise Missile, Qty: 21
X-Large Shield Booster II
Cataclysm Cruise Missile, Qty: 3220 (Cargo)
Fried Interface Circuit (Cargo)
F-S15 Braced Deflection Shield Matrix, Qty: 2
Salvager I
'Arbalest' Cruise Launcher I
'Malkuth' Cruise Launcher I, Qty: 2 
```

我正在考虑使用正则表达式来解析数据，但你会如何处理呢？您会将邮件折叠成单行字符串还是从数组中解析每一行？问题是有一些异常需要解释。

首先，“参与方：”部分是动态的，可以包含很多人，结构如下，但如果计算机控制的敌人也向受害者开枪，它会缩短为只有“名称”和“伤害” Done' 字段，如上图所示（Gistatis Tribuni / Angel Cartel）。

其次，“Destroyed”和“Dropped”项目是动态的，每封邮件的长度都不同，我还需要获取数量以及它们是否在货物中。

欢迎提出方法的想法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-28T09:26:33.560

我可能会采用状态机方法，按顺序读取每一行并根据当前状态进行处理。

某些行，例如“Dropped items:”会更改状态，导致您将以下行解释为项目。在“阅读相关方”状态下，您会将每一行添加到有关此人的数据数组中，并且当您阅读空白行时，您知道您有完整的记录。

这是我在 GraphViz 中敲出的粗略 FSM

[![状态机](https://i.stack.imgur.com/lYm6R.png)](https://i.stack.imgur.com/lYm6R.png)

某些边缘会触发代码中的操作，例如读取空行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T10:51:51.623

如果您想要一些灵活的东西，请使用状态机方法。

如果您想要快速而肮脏的东西，请使用正则表达式。

对于第一个解决方案，您可以使用专门用于解析的库，因为这不是一项简单的任务。但是因为它是相当简单的格式，你可以破解一个简单的解析器，例如：

```
<?php

class Parser 
{
   /* Enclosing the parser in a class is not mandatory but it' clean */

    function Parser()
    {

        /* data holder */
        $this->date = '';
        $this->parties = array();
        $this->victim = array();
        $this->items = array("Destroyed" => array(),
                                            "Dropped" => array());

        /* Map you states on actions. Sub states can be necessary (and sub parsers too :-) */                   
        $this->states = array('Victim' => 'victim_parsing',
                                             'Involved' => 'parties_parsing' ,
                                             'items:' => "item_parsing");

        $this->state = 'start';                      
        $this->item_parsing_state = 'Destroyed';     
        $this->partie_parsing_state = '';           
        $this->parse_tools = array('start' => 'start_parsing',
                                           'parties_parsing' =>'parties_parsing',
                                           'item_parsing' => 'item_parsing',
                                           'victim_parsing' => 'victim_parsing');

    }

    /* the magic job is done here */

    function checkLine($line) 
    {
        foreach ($this->states as $keyword => $state) 
            if (strpos($line, $keyword) !== False)
                    $this->state = $this->states[$keyword];

        return trim($line);
    }

    function parse($file)
    {
        $this->file = new SplFileObject($file);
        foreach ($this->file as $line) 
            if ($line = $this->checkLine($line))
                 $this->{$this->parse_tools[$this->state]}($line);
    }

    /* then here you can define as much as parsing rules as you want */

    function victim_parsing($line) 
    {
        $victim_caract = explode(': ', $line);
        $this->victim[$victim_caract[0]] = $victim_caract[1];
    }

    function start_parsing($line)
    {
        $this->date = $line;
    }

    function item_parsing($line) 
    {
        if (strpos($line, 'items:') !== False)
        {
            $item_state = explode(' ', $line);
            $this->item_parsing_state = $item_state[0];
        }   
          else 
         {
               $item_caract = explode(', Qty: ', $line);
               $this->items[$this->item_parsing_state][$item_caract[0]] = array();
               $item_infos =  explode(' ', $item_caract[1]);
               $this->items[$this->item_parsing_state][$item_caract[0]] ['qty'] = empty($item_infos[0]) ? 1 : $item_infos[0];
               $this->items[$this->item_parsing_state][$item_caract[0]] ['cargo'] = !empty( $item_infos[1]) ? "True":  "False";
               if  (empty( $this->items[$this->item_parsing_state][$item_caract[0]] ['qty'] ))
                print $line;
         }
    }

    function parties_parsing($line) 
    {        

        $partie_caract = explode(': ', $line);

        if ($partie_caract[0] == "Name")
        {
            $this->partie_parsing_state = $partie_caract[1];
            $this->parties[ $this->partie_parsing_state ] = array();
        }
        else
            $this->parties[ $this->partie_parsing_state ][$partie_caract[0]] = $partie_caract[1];

    }

}

/* a little test */

$parser = new Parser();
$parser->parse('test.txt');

echo "======== Fight report - ".$parser->date." ==========\n\n";
echo "Victim :\n\n";
print_r($parser->victim);
echo "Parties :\n\n";
print_r($parser->parties);
echo "Items: \n\n";
print_r($parser->items);

?> 
```

我们可以这样做，因为在这里，可靠性和性能不是问题:-)

快乐的游戏！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T09:49:31.127

您可能对[http://pear.php.net/package/PHP_LexerGenerator感兴趣](http://pear.php.net/package/PHP_LexerGenerator)

（是的，它是 alpha 版。是的，我自己没用过。是的，你需要知道/学习词法分析器的语法。我为什么要推荐它？只是好奇你对它的体验是什么 ;-)）

# .net - 如何在.net 中正确绘制列表框和图像？

> ID：325342
> 
> 赞同：0
> 
> 时间：2008-11-28T09:17:58.663
> 
> 标签：.net, winforms, graphics, drawing

```
protected override void OnPaint(PaintEventArgs e)
{
    e.Graphics.DrawImage(render, 400, 400);
} 
```

这是 Form1 类的 OnPaint。该表单有一个列表框。问题在于在表单上调整大小时渲染仅部分显示。列表框是否以某种方式将其剪掉？列表框和位图不重叠。

我尝试了以下方法：

1.  调用 base.OnPaint(e); 在 DrawImage(); 之前和之后。
2.  将表单设置为 doublebuffer、userpaint、在 WM conf 中绘制所有内容等。
3.  在 DrawImage() 之前和之后，使用我想出的每个组合尝试列表框的 Refresh() 和 Update()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T20:29:19.450

是的，ListBox 有自己的窗口句柄和 Paint 事件。您不能在 LB 上作画。通常，您也不希望它会掩盖 LB 中显示的任何信息。解释你为什么要这样做。

# c# - 文本掩码 c#

> ID：325345
> 
> 赞同：1
> 
> 时间：2008-11-28T09:20:23.057
> 
> 标签：c#, masking

我需要验证我的一个类的某个属性。当我设置属性时，类应该验证输入，如果不正确，将对象设置为无效状态。

问题：属性值必须采用某种掩码/格式，例如。&&&&-&&&&-&&&&。我不能使用正则表达式。是否可以根据掩码值验证文本？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T09:24:27.917

正则表达式经常被过度使用，但这是一个非常好的例子，说明正则表达式何时是理想的......所以：你为什么不能在这里使用它们？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T09:23:50.037

> 是否可以根据掩码值验证文本？

当然这是可能的，因为您可以编写一个函数来获取一个字符串和一个掩码并相互检查。

所以我不清楚你在问什么 - 你是在问标准.Net库中是否有函数可以做到这一点？或者要求实现掩码验证功能？或者是其他东西？

如果您正在图书馆中寻找帮助，[MaskedTextProvider](http://msdn.microsoft.com/en-us/library/system.componentmodel.maskedtextprovider.aspx)可能会这样做，虽然它是矫枉过正。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T09:33:03.780

如果没有正则表达式，您必须编写自己的验证代码来检查掩码。

# http - HTTP 请求+响应的名称

> ID：325346
> 
> 赞同：41
> 
> 时间：2008-11-28T09:21:12.057
> 
> 标签：http, naming, http-1.1

[我在RFC 2616](https://www.rfc-editor.org/rfc/rfc2616) （“超文本传输​​协议 -- HTTP/1.1”）中没有找到一件事，那就是请求/响应对的“规范”名称。有这种事吗？

[4.1 消息类型](https://www.rfc-editor.org/rfc/rfc2616#section-4.1)：

> ```
> 4.1 Message Types
> 
>    HTTP messages consist of requests from client to server and responses
>    from server to client.
> 
>        HTTP-message   = Request | Response     ; HTTP/1.1 messages 
> ```

以此为模板，你会在下面的句子中加入哪个词？

```
A single complete HTTP ... consists of one HTTP Request and one HTTP Response

    HTTP-... = Request Response 
```

往返？循环？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-11-28T09:32:45.667

规范称它们为“交换”（或“请求/响应交换”）。

根据[第 1.4 节“总体操作”](https://www.rfc-editor.org/rfc/rfc2616#section-1.4)：

> 在 HTTP/1.0 中，大多数实现为每个请求/响应交换使用一个新连接。在 HTTP/1.1 中，一个连接可用于一个或多个请求/响应交换 […]

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-09-22T00:58:03.723

*   RFC2616 将其称为*Exchange*。
*   Wireshark 和 HTTPNetworkSniffer 将其称为*Request/Response*。
*   Fiddler 称之为*Session*。
*   Charles 称其为*Sequence*。
*   HTTP Scoop 将其称为*Conversation*。
*   其他词汇包括：*Message*、*Transaction*、*Communication*。

我会选择`Exchange`或`RequestResponse`。

我还在`Operation`我的代码中命名它，因为我会排队操作、刷新操作、暂停或恢复操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-09-06T17:43:51.870

**Exchanges**是个好名字，我们也可以使用**Connection**，**Communication**或**session**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-15T10:51:55.177

**有效载荷**

在我的项目中，我需要一个名称，以便区分模型（数据库）和 HTTP 交互对象，因此我使用有效负载，例如：

*   ProductPayload, ProductModel
*   CartPayload, CartModel
*   订单有效负载，订单模型

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-28T09:30:49.820

事务，是的，或者“一个 HTTP 请求由一个 HTTP 请求消息和一个 HTTP 响应消息组成。”

# c# - 如何让每个 Treeview 节点都有一个相关的 TextBox

> ID：325366
> 
> 赞同：-1
> 
> 时间：2008-11-28T09:37:47.890
> 
> 标签：c#, .net, windows, winforms

我正在尝试制作一个用户填写值的表单。它很长。我希望使用可扩展的树来适应我的一种形式。有没有办法让每个 TreeView 节点旁边都有一个 TextBox？自己编辑节点文本是不够的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T10:03:58.740

是编辑节点的文本框吗？或用于辅助数据？如果是节点，它已经可以是可编辑的（Edit/BeginEdit 什么的）。如果是辅助数据，我很想将其推送到单个文本框中，该文本框显示/编辑当前选定节点的数据。那可能文本框会令人困惑！

或者，第三方提供了一些树视图/网格组合控件。可能是个不错的搭配。[这是](http://www.binarymission.co.uk/)（查找`TreeListView`）快速搜索命中（不是特定推荐 - 只是搜索结果）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T09:50:13.980

您可以在 TreeNode.Tag 中创建文本框，然后根据实际的 TreeNode 位置绘制文本框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T15:29:39.303

不要使用无用的 3rd 方控件，因为它们是 Windows 中的原生控件！（特别是 TreeListView，它是自 NT 3.5 以来原生的）

# asp.net - 如何使 http://my.domain.com 在 http://my.domain.com/virtualdir 中启动我的 ASP.NET 应用程序

> ID：325367
> 
> 赞同：0
> 
> 时间：2008-11-28T09:38:15.080
> 
> 标签：asp.net, iis

我无法让我的 ASP.NET 应用程序启动应用程序。例如，当我输入： http: [//my.domain.com/virtualdir](http://my.domain.com/virtualdir)或

[http://my.domain.com/virtualdir/default.aspx](http://my.domain.com/virtualdir/default.aspx)

[我的应用程序将启动，但是当我键入http://my.domain.com](http://my.domain.com)时，我无法启动 ASP.NET 。

我试图将默认文档设置为 default.aspx，但没有成功。我敢肯定，我在这里遗漏了一些明显的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T09:42:18.723

您的 virtualdir 指向您的 Web 应用程序，因此在调用它之前它不会启动。您可以将[http://my.domain.com](http://my.domain.com)重定向到[http://my.domain.com/virtualdir](http://my.domain.com/virtualdir)，因此将请求 Default.aspx。但是不要忘记将Default.aspx设置为可以作为主页的文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T10:14:50.980

如果您在名为 的目录（应用程序）中有一个应用程序`virtualdirectory`，那么**您的应用程序的 URL 是** `http://my.domain.com/virtualdirectory/`。

但是，如果您想`http://my.domain.com/`用作起始 URL，则需要

## 方法一

将所有内容从 移动`C:\Inetpub\wwwroot\virtualdirectory`到`C:\Inetpub\wwwroot\`

如果这是您拥有的唯一应用程序，或者这是核心应用程序，我只会推荐此操作过程。

## 方法二

**或者**您可以尝试更改[主目录/根目录](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/a59a2665-9078-43ef-8b5a-5bf9bcacc95e.mspx?mfr=true)

## 方法三

**或者**你可以创建一个名为`c:\inetpub\wwwroot\default.aspx`

并坚持这个

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="WebForm2.aspx.cs" Inherits="Portal.App.WebForm2" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<script runat="server">
protected void Page_Load(object sender, EventArgs e) {
Server.Transfer("virtualdirectory/default.aspx");

// or 
// Response.Redirect("http://my.domain.com/virtualdirectory/default.aspx");
}
</script>
<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
<title>Untitled Page</title>
</head>
<body>
<form id="form1" runat="server">
<div>

</div>
</form>
</body>
</html> 
```

# sql - 如何在 SQL 中过滤掉包含具有 null 或空数据的特定列的行？

> ID：325370
> 
> 赞同：9
> 
> 时间：2008-11-28T09:40:08.507
> 
> 标签：sql

在 SQL 中，我们如何检查过滤所有包含列数据的行是否为空或空？
例如

```
Select Name,Age from MEMBERS 
```

我们需要检查 Name 不应该等于 null 或为空。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-28T09:42:54.273

这将适用于所有健全的数据库（*眨眼，眨眼*），并将返回名称不为空也不为空的行

```
select name,age from members where name is not null and name <> '' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-28T10:43:37.617

对于将 '' 视为值（非空）的 DBMS，Vinko 的查询有效：

```
select name,age from members where name is not null and name <> '' 
```

对于将 '' 视为 null 的 Oracle，上面的 tha 不起作用，但这样做：

```
select name,age from members where name is not null 
```

我试图想出一个“与 DBMS 无关”的解决方案，但失败了——主要是由于不同的 DBMS 使用了不同的连接运算符/函数！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T09:43:46.503

`SELECT Name,Age FROM MEMBERS WHERE name IS NOT null OR name <> ''`

您可以从[http://www.w3schools.com/sql/default.asp获得更多信息](http://www.w3schools.com/sql/default.asp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T09:42:36.520

nvl(Name, 'some thumb string') 如果 Name 不为 null 并且与 '' 不同（oracle，其他人不知道），这将返回 Name。如果 null 或等于 ''，它将等于 '一些愚蠢的字符串'。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T09:44:57.937

取决于正在使用的数据库；尝试从名称不为空的成员中选择名称、年龄

如果您需要以其他方式过滤 Select Name, Age from Members where name IS NULL

某些 RDBMS 将 enpty 字符串与 null 不同，您需要添加；从名称不为空或名称 <> '' 的成员中选择名称、年龄

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T10:56:14.393

T-SQL

```
select name,age from members where COALESCE(name, '') <> '' 
```

# c# - ToolstripmenuItem 上的下拉项目并查看它们的项目是否被选中

> ID：325375
> 
> 赞同：0
> 
> 时间：2008-11-28T09:41:54.323
> 
> 标签：c#, winforms, visual-studio-2008

我正在构建一个小型 Winform，我可以在其中查看厨房中的食物类型。

我的整个股票可以通过数据网格视图显示。

现在，我有一个过滤器菜单，其中包含可以选中和取消选中的项目的下拉列表。

根据检查该列表中的哪些项目，datagridview 中的显示会更改。仅显示选择的项目。

至少，这就是我想要的样子。菜单目前有 5 个项目：肉类、鱼类、水果、蔬菜和其他。

我正在使用一个抽象类 Food，所有其他类都是从它派生的。最终，我为每块食物制作了一个字符串表示，看起来有点像这样

FoodType*FoodName*AmountInStock*...

所以一个星 * 作为分隔符。

然后我这样做

```
foreach(Food f in this.kitchen.FoodList)
{
    string[] s = f.ToString().Split('*');
    Object o = filterMenu.DropDownItems[s[0]];
} 
```

FoodList 是一个 ArrayList。然后我用 VisualStudio 2008 调试它

Object o 始终包含 null。

然而 s[0] 总是包含食物类型的名称。我想要的是能够找出该菜单列表上的项目是否被选中。如果选中，datagridview 必须显示它。如果不是，请不要显示它。

我用这个在构造函数中填充它：

```
public static void Fill(ToolStripMenuItem item, Type food)
{
    foreach (string element in Enum.GetNames(food))
    {
        if (element != "nothing")
        {
            ToolStripMenuItem it = (ToolStripMenuItem)item.DropDownItems.Add(element);
            it.Checked = true;
            it.CheckOnClick = true;
        }
    }
} 
```

我已经尝试过对象浏览器，但找不到任何有用的东西，所以我转向这里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-28T10:05:29.470

当你做参考检查时

filterMenu.DropDownItems[s[0]]。

您不将 s[0] 的值与 DropDownItems 中的项目匹配，但您匹配它们的引用，而那些不匹配。

您要么需要遍历所有项目并手动检查它们的**值**是否相同，要么您找到一种方法将您自己的比较器插入该过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T20:18:07.037

您可以使用 IndexOfKey 属性来查找 ToolStripMenuItem。这需要在添加它们时设置 Name 属性：

```
ToolStripMenuItem it = (ToolStripMenuItem)item.DropDownItems.Add(element);
it.Name = element;
// etc.. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-17T22:53:43.003

当您从构造函数填充 MenuStrip 时，您添加了元素而不给它们命名。然后您尝试按名称访问项目：

```
Object o = filterMenu.DropDownItems[s[0]]; //null  Name?? 
```

如果添加元素并为其分配名称，则可以访问这些项目：

```
ToolStripMenuItem it = (ToolStripMenuItem)item.DropDownItems.Add(element);
it.Name = element;  // This was missing 
```

基于 OP 问题*我想要的是能够找出是否检查了该菜单列表上的项目。* 此代码将显示如何找到**被选中的菜单项：**

```
filterMenu.DropDownItems.Cast<ToolStripMenuItem>().Where(tsi=>tsi.Checked).First().Text 
```

# ms-access - 访问：运行时错误 13 类型不匹配

> ID：325383
> 
> 赞同：1
> 
> 时间：2008-11-28T09:46:03.893
> 
> 标签：ms-access

我在以下代码末尾收到运行时错误 13：

```
Sub plausibilitaet_check()

Dim rs As DAO.Recordset
Dim rs2 As ADODB.Recordset
Dim db As database
Dim strsql As String
Dim strsql2 As String
Dim tdf As TableDef

Set db = opendatabase("C:\Codebook.mdb")
Set rs = db.OpenRecordset("plausen1")

Set rs2 = CreateObject("ADODB.Recordset")
rs2.ActiveConnection = CurrentProject.Connection

For Each tdf In CurrentDb.TableDefs

   If Left(tdf.Name, 4) <> "MSys" Then
        rs.MoveFirst
        strsql = "SELECT * From [" & tdf.Name & "] WHERE "

        Do While Not rs.EOF
            On Error Resume Next

            strsql2 = "select * from table where GHds <> 0"
            Set rs2 = CurrentDb.OpenRecordset(strsql2) 
```

错误发生在 Set rs2 = CurrentDb.OpenRecordset(strsql2)

有人可以看到我哪里出错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-28T09:50:48.893

CurrentDB.OpenRecordset 返回 DAO.Recordset 的一个实例。您正在尝试将结果分配给 ADODB.Recordset

将 rs2 定义更改为

`dim rs2 as DAO.Recordset`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-28T09:53:06.517

您正在混淆 ADO 和 DAO。在这种情况下，rs2 应该是一个 DAO 记录集。

```
Sub plausibilitaet_check()

Dim rs As DAO.Recordset
Dim rs2 As DAO.Recordset
Dim db As database
Dim strsql As String
Dim strsql2 As String
Dim tdf As TableDef

Set db = opendatabase("C:\Codebook.mdb")
Set rs = db.OpenRecordset("plausen1")

For Each tdf In CurrentDb.TableDefs

   If Left(tdf.Name, 4) <> "MSys" Then
        rs.MoveFirst
        strsql = "SELECT * From [" & tdf.Name & "] WHERE "

        Do While Not rs.EOF
            On Error Resume Next

            strsql2 = "select * from table where GHds <> 0"
            Set rs2 = CurrentDb.OpenRecordset(strsql2) 
```

# xsd - CodeWarrior xml项目文件架构？

> ID：325384
> 
> 赞同：1
> 
> 时间：2008-11-28T09:46:31.333
> 
> 标签：xsd, codewarrior

我正在寻找准确描述 CodeWarrior 使用的 XML 项目文件格式的参考。我设法找到了最新版本的 Visual C++ 的 XSD 文件（[这里](http://msdn.microsoft.com/en-us/library/y4sy8216.aspx)），有人能指出我对 CodeWarrior 的等效吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T15:31:49.920

作为在 CodeWarrior 及其 IDE 上工作多年的工程师之一，我可以告诉您，内部没有生成任何模式或 XSD 文件。标签名称和值取决于您在项目中设置的链接器和编译器碰巧拥有的特定首选项面板集。

如果您有想要定位的 CW IDE 的特定配置，您可以从该版本执行 XML 导出并查看结果。导出工具不会省略标签，但如果在首选项面板中有列表类型的控件，那么如果列表中没有任何项目，这些控件可能会被省略。

# javascript - jQuery 和 Unicode 字符

> ID：325392
> 
> 赞同：3
> 
> 时间：2008-11-28T09:50:33.587
> 
> 标签：javascript, jquery

我正在从 jquery ajax 调用中调用 .txt 文件。它有一些特殊字符，例如`±`. 这`±`是一组数组的分隔符；我想拆分并推送到 JavaScript 数组中的数据。

`±`当这样解释时，它不被视为符号。

我如何像浏览器内容一样获取这些数据？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-28T10:02:34.640

为什么不使用[JSON](http://www.json.org/)对文本文件进行编码？更容易，因为它已经是 javascript。

使用JQuery的[getJSON()](http://docs.jquery.com/Ajax/jQuery.getJSON)方法，文件内容会直接解析成数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-28T10:05:29.737

您可以使用该`escape()`值来拆分字符串。对于±我发现了两个值（也许还有更多？）。

```
var string = escape('test±test2±test3');
var split = string.split('%C2%B1');

alert(split); // test,test2,test3

// %B1%0A is the value i found for ±
// %C2%B1 is the value escape() gives me when i just copy and paste that char :) 
```

# ruby-on-rails - “使用 subversion/git 修改文件”是什么意思？

> ID：325399
> 
> 赞同：2
> 
> 时间：2008-11-28T09:54:09.650
> 
> 标签：ruby-on-rails, svn, git

```
% rails
...
General Options:
...
-c, --svn                        Modify files with subversion. (Note: svn must be in path)
-g, --git                        Modify files with git. (Note: git must be in path) 
```

这些“修改文件”选项对我有什么作用？

编辑：我不清楚使用这些选项中的一个（或两个？）实际上做了什么。如，他们如何改变工作流程？然后我不会自己发出什么 svn/git 命令，或者我现在最终不得不发出什么类型的更深奥的命令？从根本上说，有关此功能的文档在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T10:10:03.330

'-c' 将指示 rails 从 subversion 源代码存储库中检索和存储数据。'-g' 将指示 realis 在 git 存储库中检索和存储代码。

在这两种情况下，都必须安装和配置源代码存储库，并且您应该事先将本地环境设置为指向所需的实例、项目目录等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-08T05:48:37.267

看起来像`--git`在[r8772](http://dev.rubyonrails.org/changeset/8772)中添加以响应[票 #](http://dev.rubyonrails.org/ticket/10690) 10690 。阅读那个补丁是我找到的最接近文档的东西。该选项适用于[Rails::Generator::Commands](http://api.rubyonrails.org/classes/Rails/Generator/Commands.html)`svn add`，并对`git add`由`script/generate`.

它还对被 删除的东西做适当的`rm`或处理。`reset``script/destroy`

它不*提交*任何更改，只添加文件以便 VCS 跟踪它们。

哦，[rails app generator](https://rails.lighthouseapp.com/projects/8994-ruby-on-rails/tickets/3896-generatorcommandscreatefile-git-broken-with-app-generator)`--git`也坏了，至少通过 rails 2.3.5。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T15:21:02.893

许多开发者使用版本控制系统来管理他们的项目。对于 Rails 应用程序，Subversion 和 Git 是最流行的选择，而 Git 往往会接管这些天。

这些系统通过编辑文件来帮助开发团队进行协作，而不会“互相干扰”。也就是说，如果 2 个协作者同时编辑同一文件的 2 个不同部分，则两个编辑都将安全保存。

即使是独立程序员也发现使用 svn 和 git 带来了很多优势。

如果您修改 o 文件、重命名或其他方式，则需要将这些更改提交到存储库。上面的命令通过在更改文件本身的基础上将更改提交到存储库来节省一步。

您需要查找有关 Subversion 和 Git 基础知识的信息。一种方法是访问[Github.com](http://github.com)。

# svn - 您如何在 IBM i 上组织 RPGLE 颠覆存储库？

> ID：325401
> 
> 赞同：6
> 
> 时间：2008-11-28T09:57:35.073
> 
> 标签：svn, ibm-midrange, rpgle

您如何在 IBM i 上组织您的 RPGLE subversion 存储库？

我目前在一家旅游业务公司工作，该公司拥有大量（约 13k）的 RPGLE - 他们内部应用程序的资源，最后他们想要使用版本控制并采用更现代的编码风格（整个 WDSC - RDi 的东西）。

所以我一直以来的项目是一点一点地清理和现代化整个编码过程。

OS/400的[开源颠覆版](http://www.softlanding.com/subversion/d-subversion.htm)就像一个魅力，在安装过程中只有 2 个小问题。

我的脑海中有一个很好的形象，它应该如何工作，但我认为它打破了一些传统，所以我想听听你的意见。

```
/subversion/repositories/{name of the in-house-application}
   /{project_a}
       /trunk
           /doc
           /sql
           /{a source file that is named like the project. i.e. project_a }
               /myRPGsrc.rpgle
               /myCLLEsrc.clle
               /myDDSsrc.dspf
               /myDDSsrc.pf
               /compile.clle
            .iseries_project_properties
            .project
       /branch
       /tag
   /{project_b}
   /global_stuff
   /nightly_build 
```

因此，主要区别在于没有不同的源文件，如 QRPGLESRC、QCLSRC、QDDSSRC 等，而是*一个*包含所有项目源并且可以作为 WDSC 项目检出的源文件。项目源文件也可以很容易地命名为“src”，就像它在其他存储库中很常见一样，但是如果一些开发人员想要将多个项目检出到 /QSYS.LIB/SOMELIB.LIB/ 中，他们就不必担心命名空间本身。

所以你怎么看？是混合动力车吗？你看到问题了吗？你已经有一些经验了吗？请分享！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-23T21:29:38.187

当前如何组织源和对象？您想设置 Subversion 以使用当前的库结构而不是创建这个新的 IFS 目录结构吗？

我建议使用对象类型（pgm、file、cmd、pnlgrp、sql 等）作为文件扩展名，而不是源文件类型（rpgle、clle、sql 等）。您可能有 xyz.rpgle 和 xyz.cle 源冲突，因为它们都编译为 XYZ *PGM。

# umbraco - 在 umbraco 中分配主机名

> ID：325402
> 
> 赞同：4
> 
> 时间：2008-11-28T09:58:15.350
> 
> 标签：umbraco

我正在使用 umbraco cms 设置多语言页面。

我的内容结构如下所示：

*   内容
    *   大
        *   丹麦子页面 1
        *   丹麦子页面 2
    *   zh
        *   英文子页面 1
        *   英文子页面 2

我希望路由类似于：

[http://mysite.dk](http://mysite.dk)应该转到[http://mysite.dk/da/danish](http://mysite.dk/da/danish)子页面 1

[http://mysite.dk/da/](http://mysite.dk/da/)应该转到[http://mysite.dk/da/danish](http://mysite.dk/da/danish)子页面 1（以及）

[http://mysite.dk/en/](http://mysite.dk/en/)应该转到[http://mysite.dk/en/english](http://mysite.dk/en/english)子页面 1

我知道我需要在 umbraco 中设置主机名，但我不知道该怎么做。我无法访问 IIS，因为它位于托管环境中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-29T22:00:17.923

您只需右键单击一个节点并选择出现的“主机名”选项，然后按照出现的说明进行操作

但我认为您还需要将主机名添加到 IIS。

# automation - 将程序写入输入流

> ID：325404
> 
> 赞同：0
> 
> 时间：2008-11-28T09:59:40.217
> 
> 标签：automation

我正在使用 oracle 钱包来存储 oracle 数据库密码，创建钱包的批处理文件在您运行时要求输入密码。有没有办法修改批处理文件，并事先提供密码

这样我就可以避免每次运行时输入密码。

所以为了概括这个问题，有什么办法可以写入另一个程序的输入流。

这样我就可以避免来自我的自动化脚本的提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T10:25:38.400

您可以使用管道运算符“|” 将一个程序的标准输出流重定向到另一个程序的输入流。我在 unix 和 windows 平台上工作。

在您的示例中，您将有一个脚本

```
echo mypassword 
```

你可以从命令行运行它：

```
myscript | wallet 
```

我假设您的脚本将被称为 myscript.bat，而钱包程序 wallet.exe 会相应地更改这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T08:47:13.433

在 password.txt 等文本文件中输入密码

你可以像这样跑

我的程序.exe <密码.txt

如果程序接受两个输入，则在文本文件的第二行中键入第二个输入。

# vb.net - 如何从 LINQ 匿名列表中的函数返回数组？

> ID：325407
> 
> 赞同：0
> 
> 时间：2008-11-28T10:00:53.147
> 
> 标签：vb.net, linq, generics

本质上，我想要一个通用函数，它接受一个 LINQ 匿名列表并返回一个数组。我希望使用泛型，但我似乎可以让它工作。

希望下面的示例有所帮助

假设我有一个带有 id、fname、lname 和 dob 的人员对象。我有一个包含对象列表的通用类。

我返回一组人

我的代码片段将类似于

```
dim v = from p in persons.. select p.fname,p.lname 
```

我现在有一个来自 system.collections.generic.ineumerable(of t) 的匿名类型

要将其绑定到网格，我必须迭代并添加到数组中，例如

```
dim ar() as array

for each x in v
    ar.add(x)
next

grid.datasource = ar 
```

我不想不断地进行迭代，因为我可能有不同的对象

我想要一个执行以下操作的函数：

```
function getArrayList(of T)(dim x as T) as array()

    dim ar() as array

    for each x in t
       ar.add(x)
    next

    return ar
end 
```

希望澄清。我怎样才能得到一个通用函数，它接受一个匿名的 ienumearable 列表并返回一个数组。不幸的是，我拥有的那个不起作用。

非常感谢任何和所有的指针/帮助将不胜感激。

问候

阿扎德

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T15:12:39.557

您可以将网格直接绑定到匿名类型数组。这是一个例子：

```
 var qry = from a in Enumerable.Range(0, 100)
                  select new { SomeField1 = a, SomeField2 = a * 2, SomeField3 = a * 3 };
        object[] objs = qry.ToArray();
        dataGridView1.DataSource = objs; 
```

还要注意对 ToArray 的调用，它消除了循环的需要。我还将它分配给 object[] 的类型，以证明您可以根据需要将其作为其类型传递。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T14:54:10.827

你只需调用[ToArray](http://msdn.microsoft.com/en-us/library/bb298736.aspx)。当然，该类型是匿名的……但由于类型推断，您不必说出类型的名称。

从示例代码：

```
 packages _
    .Select(Function(pkg) pkg.Company) _
    .ToArray() 
```

公司恰好是字符串，但没有理由不能是其他任何东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T10:19:16.853

你的问题有点不清楚，所以我不确定我的答案会有多大帮助，但这里有......

*   [匿名类型具有方法范围](http://msdn.microsoft.com/en-us/library/bb397696.aspx)，因此您不能从函数中返回它，至少不能以强类型的方式返回。[您可以转换为`object`然后再重新创建匿名类型](http://tomasp.net/blog/cannot-return-anonymous-type-from-method.aspx)，但最好声明一个带有一些[自动属性](http://weblogs.asp.net/scottgu/archive/2007/03/08/new-c-orcas-language-features-automatic-properties-object-initializers-and-collection-initializers.aspx)的简单类。
*   要将 a 转换`IEnumerable`为数组，只需调用`ToArray()`
*   但是，您可以`DataBind`直接`IEnumerable`将其转换为数组，而无需将其转换为数组
*   如果您正在处理的数据可以有不同的字段，那么您最好创建一个`DataTable`并将其绑定到您的 DataGrid。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T10:28:40.093

我不确定您是否可以轻松地将匿名对象作为参数传递，而不是将它们作为返回值。

我说得轻松，因为：

*   [http://tomasp.net/blog/cannot-return-anonymous-type-from-method.aspx](http://tomasp.net/blog/cannot-return-anonymous-type-from-method.aspx)
*   [http://blog.decarufel.net/2007/11/passing-anonymous-to-and-from-methods.html](http://blog.decarufel.net/2007/11/passing-anonymous-to-and-from-methods.html)

*[在您的问题上尝试代码格式化选项（编辑器中的“按钮），这将使您更容易阅读问题中的代码片段部分。]*

# database - 生成报告的 MySQL 表结构

> ID：325414
> 
> 赞同：0
> 
> 时间：2008-11-28T10:04:45.917
> 
> 标签：database, database-design

继续我昨天的问题....

[用于问卷调查的 MySQL 表设计](https://stackoverflow.com/questions/323842/mysql-table-design-for-a-questionnaire)

昨天下午我和我的老板坐下来讨论我打算如何设计数据库。然而，现在我比以往任何时候都更加困惑。

他已经使用 Access 多年，并质疑我是否能够仅使用一列作为答案 (ENUM) 生成报告。根据他对 Access 的经验，他认为每个可能的响应（即非常满意、相当满意、相当不满意、非常不满意）都应该有自己的列和数值（即 100、66.6、33.3、0）。

这样数据库就可以生成报告，显示全国和每个零售商的平均满意度。

我真的很感激一些指导，因为我真的不想弄错？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T10:38:06.817

在这种情况下，我不会选择枚举，而是选择“分数”列。所以这些列可能是：

```
userid, questionid, score
1,1,4
1,2,4
1,3,3
2,1,1
2,2,4
... 
```

1非常不满意，4非常满意。

然后是这样的查询：

```
select 25*avg(score) from Blah 
```

会给你你的整体百分比。

```
select 25*avg(score), questionid from Blah group by questionid 
```

每个问题会给你一个百分比。

Access 并不是真正的数据库，所以不要听你老板的；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T12:36:33.430

JD 是对的，鉴于需要进行平均得分，INT 列是要走的路。

至于你的老板，嗯，他错了。8^) 也许说服他的最好方法是演示如何使用我们正在讨论的设计生成报告：编写一个小脚本来生成一些假数据（即，在1..4范围）然后使用一些SQL（JD有一些很好的起点）生成一些Q&D报告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T13:57:52.203

以防万一其他人有这个问题；我还找到了一个非常有用的教程。 [http://www.roughguidetophp.com/generating-reports-using-mysqls-aggregate-functions-sum-max-min-and-more/](http://www.roughguidetophp.com/generating-reports-using-mysqls-aggregate-functions-sum-max-min-and-more/)

它澄清了京东和 Genehack 所说的话。

# matlab - matlab和comsol脚本的区别？

> ID：325416
> 
> 赞同：5
> 
> 时间：2008-11-28T10:05:22.967
> 
> 标签：matlab

我发现 matlab 有很多用途，但我现在的雇主没有 matlab 许可证：有一个用于 Comsol 的许可证，它带有 comsol Script。乍一看，comsol 脚本与 matlab 相同，但过一会儿你会发现令人毛骨悚然的差异。许多图形图形的功能不存在，您无法将图形导出为矢量图形格式。但更糟糕的是，对于繁重的计算，性能似乎要差得多，在琐碎的算法上有很多崩溃。

（当然，comsol 包的用途完全不同，但我*只*对像 matlab 一样使用它感兴趣，因为我们没有 matlab 许可证。）

matlab 和 Comsol 脚本内核有区别吗？

他们处理内存和矩阵计算的方式不同吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-28T14:55:12.573

> 他们处理内存和矩阵计算的方式不同吗？

几乎可以肯定，是的（在实施级别）。comsol 之前没听说过，不过慢一点也就不足为奇了。在过去的几年里，Mathworks 在性能优化上投入了大量精力。使用 JIT 消除了很多解释器开销。他们还做缓存友好的技巧，比如执行

```
 mybigresult = big1 .* big2 + big1 .* big3 
```

as (C 风格的伪代码)

```
 for (size_t i=0; i<numelement; i++) {
    mybigresult[i] = big1[i] * big2[i] + big1[i] * big3[i];
 } 
```

而不是创建临时文件和多次扫描内存。最后，在最近的版本中，他们为大部分后端添加了多线程支持。（注意：语义上，Matlab 仍然是单线程的）。

一些免费的 Matlab 替代品：octave（旨在成为开源等价物）、python + numpy（非常不同的语言，但具有相似的基本功能）。

如果 Matlab 让您的工作效率更高，您可能想尝试让您的雇主支付许可证费用...（5 万美元/年工资 * 10% 的生产力提高）= 如果购买了 Matlab，则完成的额外工作价值 5000 美元（只是在这里编数字）。

# user-interface - Visual Basic 6.0 表单设计器 - 无法拖动以移动对象

> ID：325419
> 
> 赞同：1
> 
> 时间：2008-11-28T10:06:24.897
> 
> 标签：user-interface, drag-and-drop, vb6, form-designer

我是 Visual Basic 6 项目的新手。我下载了一些教程进行测试；但是，我无法在这些项目中拖动、移动或编辑 UI 表单设计器对象。

有人知道VB6中有对象锁定功能吗？
如果有，如何解锁？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-28T10:11:44.777

您是说您在 VB6 窗体设计器中，并且不能移动窗体上的任何控件吗？

如果是这种情况，我似乎记得表单有一个“锁定”属性 - 它的设置应该在属性窗口中。

希望有帮助...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T17:39:03.083

我在一篇文章中读到了这篇文章，这是在这篇文章之后的以下谷歌搜索链接，用于“vb6 解锁拖动移动”。它对我有用。

> 这可能不是问题，但您可以检查一下：有一个隐藏设置（微软甚至对程序员隐藏设置！）这将导致控件无法移动。在记事本中打开 .FRM 文件。如果它包含一行： LockControls = -1 然后删除该行。

原始海报名为“Mayayana”：[http ://bytes.com/topic/visual-basic/answers/14881-cant-move-controls-form](http://bytes.com/topic/visual-basic/answers/14881-cant-move-controls-form)

# c# - MDI 子刷新/重绘问题（C#、Winforms、.NET 2.0、VS2005、DevExpress 8.2）

> ID：325421
> 
> 赞同：1
> 
> 时间：2008-11-28T10:07:13.150
> 
> 标签：c#, winforms, visual-studio-2005, .net-2.0

嗨——我的一个朋友对你们指指点点。

我有一个 MDI 应用程序（C#、Winforms、.NET 2.0、VS2005、DevExpress 8.2），我的一个表单的行为非常奇怪——在与同一表单类的另一个实例重叠的地方没有正确地重新绘制自己。

这些表单包含一个自定义控件（其中包含各种 DevExpress 控件），并且继承自一个基本表单（它本身是继承的）。

由于表单继承的问题（那个旧栗子），在构造函数中进行了一些控制重新排列。

问题 1（次要）：除非调整表单大小，否则此控件重新定位/调整大小似乎都不会生效，因此我在重新排列后将宽度上下微调了一个像素。丑陋，hacky，我真的不想这样做。

问题 2（主要）：如果显示表单，然后使用 API 调用 SetParent 将其附加到 MDI 表单，当我显示第二个实例时，两个表单的各个部分在它们重叠的地方没有正确绘制 - 顶部的位在后面现有的 - 当表单四处移动时，这个问题会变得更糟，使它们基本上无法使用。其他不同类型的子窗体（如果存在）似乎不受影响......

停止新闻：我已经确定它不必是子表单的 2 个实例。只有一个仍然存在问题 - 主要是围绕表单的边缘，例如正在刷新的区域小于表单本身。

如果使用子窗体的 .MDIParent 属性设置父级，则不会出现此问题 - 但我们不能这样做，因为该窗体可能由托管在非 .Net 应用程序中的控件显示。此外，即使现有子项（不同类型）已最大化，我也需要显示未最大化的子表单，并且仅使用 SetParent 才会发生这种情况。

我已经在这种类型的所有表单上尝试了 Refresh() （我有一个保存它们列表的控制器），但没有任何乐趣。我试图从具有相同继承结构的基本应用程序中重现这种效果，但我做不到。显然它与表单有关 - 因为我昨天从头开始重新创建表单并且它仍然是相同的，它必须是代码 - 但是什么？

我在形式绘画活动等方面不是最热门的，所以我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T20:04:43.367

是的，那样就可以了。更改 FormBorderStyle 需要 Windows 窗体从头开始重新创建窗口，现在在 CreateWindowEx() 调用中使用不同的样式标志。这将使它完全忘记您使用 SetParent() P/Invoke 设置的父级。还有许多其他属性会导致这种情况发生。通过在 OnHandleCreated() 方法的覆盖中进行这些调用来避免您遇到的那种麻烦。

更好的是，通过将所有控件和逻辑放在 UserControl 中来完全避免麻烦的 API，例如 SetParent()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T12:22:36.890

啊哈！

在显示表单之前，我在代码中更改了 FormBorderStyle。我删除了那条线，问题就消失了......

那会为我做的。:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-16T02:11:09.083

我知道这是一个旧线程，但我确实为我解决了这个问题。这可能会帮助有类似问题的人。

**我的问题：** 我们有一个应用程序，其中我们将两个外部应用程序嵌入到一个由拆分器分隔的父窗口中。它用于并排显示来自两个应用程序的信息。我们面临的问题是两个子窗口在父窗口上绘制得很好（使用 SetParent、SetWindowLong 和 MoveWindow），但是在子窗口中移动或执行操作时，它们会出现绘制/刷新问题（更具体地说，父面板将被绘制在子窗口上）

在阅读了大量关于嵌入窗口、SetParent 问题的文章后，MSDN 页面[http://msdn.microsoft.com/en-us/library/windows/desktop/ms632600(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632600%28v=vs.85%29.aspx)给了我一个线索。

**解决方案：** 使用 SetWindowLong（设置样式）时，使用 WS_CLIPCHILDREN 样式 -

```
::SetWindowLong(hwnd, GWL_STYLE, WS_VISIBLE | WS_CLIPCHILDREN)); 
```

这种风格的作用是防止父窗口重新绘制子窗口占用的区域。这完全为我解决了这个问题。

# linux - 如何警告在 KornShell 脚本中使用未设置的变量。

> ID：325424
> 
> 赞同：2
> 
> 时间：2008-11-28T10:11:31.330
> 
> 标签：linux, unix, shell, scripting, ksh

有没有办法在 KornShell (ksh) 脚本中抛出错误或警告以防止使用未设置的变量？假设我有一个要删除的临时文件夹。

```
TEMP_FILES_DIR='/app/myapp/tmp'
rm -Rf $TEMP_FILE_DIR #notice the misspelling 
```

如何在这种错误真正发生之前防止它们发生？

我知道脚本应该在尝试删除之前检查文件是否存在和空字符串，这只是一个愚蠢的例子来说明可以通过一些警告避免的错误。我不知道这个功能是否存在于 ksh 中。如果它确实存在，你如何打开它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-28T11:00:02.123

命令

```
设置-u
```

当尝试扩展未设置的变量时，将导致 POSIX *sh* (1) 及其派生词发牢骚。

例子：

```
$ 回声 $foo

$设置-u
$ 回声 $foo
sh: foo: 参数未设置

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T10:48:17.777

您可以检查变量是否有内容，即不是''，并打印出一条消息，如“变量为空”。

然而，这仍然不能解决这样的 PEBCAK 错误——你所知道的就是什么也没发生。

# c# - 默认（类型）的编程等效项

> ID：325426
> 
> 赞同：574
> 
> 时间：2008-11-28T10:11:47.260
> 
> 标签：c#, reflection, default

我正在使用反射来循环 a`Type`的属性并将某些类型设置为默认值。现在，我可以对类型进行切换并`default(Type)`显式设置，但我宁愿在一行中完成。是否存在与默认程序等效的程序？

* * *

## 回答 #1

> 赞同：778
> 
> 时间：2008-12-09T15:14:35.083

*   如果是值类型，请使用[Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)，它应该可以正常工作。
*   使用引用类型时只返回 null

```
public static object GetDefault(Type type)
{
   if(type.IsValueType)
   {
      return Activator.CreateInstance(type);
   }
   return null;
} 
```

在 .net 标准等较新版本的 .net 中，`type.IsValueType`需要写为`type.GetTypeInfo().IsValueType`

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2011-11-05T19:24:32.780

为什么不用反射调用返回 default(T) 的方法呢？您可以将任何类型的 GetDefault 用于：

```
 public object GetDefault(Type t)
    {
        return this.GetType().GetMethod("GetDefaultGeneric").MakeGenericMethod(t).Invoke(this, null);
    }

    public T GetDefaultGeneric<T>()
    {
        return default(T);
    } 
```

* * *

## 回答 #3

> 赞同：95
> 
> 时间：2012-04-23T21:48:21.673

您可以使用`PropertyInfo.SetValue(obj, null)`. 如果在值类型上调用，它将为您提供默认值。此行为记录[在 .NET 4.0](http://msdn.microsoft.com/en-us/library/xb5dd1f1(v=vs.100).aspx)和[.NET 4.5](http://msdn.microsoft.com/en-us/library/xb5dd1f1(v=vs.110).aspx)中。

* * *

## 回答 #4

> 赞同：58
> 
> 时间：2012-10-04T18:24:59.003

如果您使用的是 .NET 4.0 或更高版本，并且您想要一个不是*在代码之外*定义的规则编纂的程序化版本，您可以创建一个[`Expression`](http://msdn.microsoft.com/en-us/library/system.linq.expressions.expression.aspx)，即时编译和运行它。

以下扩展方法将通过类上的[方法](http://msdn.microsoft.com/en-us/library/system.linq.expressions.expression.default.aspx)[`Type`](http://msdn.microsoft.com/en-us/library/system.type.aspx)获取并获取返回值：[`default(T)`](http://msdn.microsoft.com/en-us/library/xwth0h0d%28v=vs.80%29.aspx)[`Default`](http://msdn.microsoft.com/en-us/library/system.linq.expressions.expression.default.aspx)`Expression`

```
public static T GetDefaultValue<T>()
{
    // We want an Func<T> which returns the default.
    // Create that expression here.
    Expression<Func<T>> e = Expression.Lambda<Func<T>>(
        // The default value, always get what the *code* tells us.
        Expression.Default(typeof(T))
    );

    // Compile and return the value.
    return e.Compile()();
}

public static object GetDefaultValue(this Type type)
{
    // Validate parameters.
    if (type == null) throw new ArgumentNullException("type");

    // We want an Func<object> which returns the default.
    // Create that expression here.
    Expression<Func<object>> e = Expression.Lambda<Func<object>>(
        // Have to convert to object.
        Expression.Convert(
            // The default value, always get what the *code* tells us.
            Expression.Default(type), typeof(object)
        )
    );

    // Compile and return the value.
    return e.Compile()();
} 
```

您还应该基于 缓存上述值`Type`，但请注意，如果您为大量`Type`实例调用它，并且不要经常使用它，缓存消耗的内存可能会超过好处。

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2010-10-26T20:47:47.963

你为什么说仿制药不在画面中？

```
 public static object GetDefault(Type t)
    {
        Func<object> f = GetDefault<object>;
        return f.Method.GetGenericMethodDefinition().MakeGenericMethod(t).Invoke(null, null);
    }

    private static T GetDefault<T>()
    {
        return default(T);
    } 
```

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2012-11-14T10:00:22.173

这是优化的 Flem 的解决方案：

```
using System.Collections.Concurrent;

namespace System
{
    public static class TypeExtension
    {
        //a thread-safe way to hold default instances created at run-time
        private static ConcurrentDictionary<Type, object> typeDefaults =
           new ConcurrentDictionary<Type, object>();

        public static object GetDefaultValue(this Type type)
        {
            return type.IsValueType
               ? typeDefaults.GetOrAdd(type, Activator.CreateInstance)
               : null;
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-10-16T19:30:22.617

选择的答案是一个很好的答案，但要小心返回的对象。

```
string test = null;
string test2 = "";
if (test is string)
     Console.WriteLine("This will never be hit.");
if (test2 is string)
     Console.WriteLine("Always hit."); 
```

外推...

```
string test = GetDefault(typeof(string));
if (test is string)
     Console.WriteLine("This will never be hit."); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-11-28T11:18:09.310

我做同样的任务。

```
//in MessageHeader 
   private void SetValuesDefault()
   {
        MessageHeader header = this;             
        Framework.ObjectPropertyHelper.SetPropertiesToDefault<MessageHeader>(this);
   }

//in ObjectPropertyHelper
   public static void SetPropertiesToDefault<T>(T obj) 
   {
            Type objectType = typeof(T);

            System.Reflection.PropertyInfo [] props = objectType.GetProperties();

            foreach (System.Reflection.PropertyInfo property in props)
            {
                if (property.CanWrite)
                {
                    string propertyName = property.Name;
                    Type propertyType = property.PropertyType;

                    object value = TypeHelper.DefaultForType(propertyType);
                    property.SetValue(obj, value, null);
                }
            }
    }

//in TypeHelper
    public static object DefaultForType(Type targetType)
    {
        return targetType.IsValueType ? Activator.CreateInstance(targetType) : null;
    } 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-12-26T00:15:41.180

表达式可以在这里提供帮助：

```
 private static Dictionary<Type, Delegate> lambdasMap = new Dictionary<Type, Delegate>();

    private object GetTypedNull(Type type)
    {
        Delegate func;
        if (!lambdasMap.TryGetValue(type, out func))
        {
            var body = Expression.Default(type);
            var lambda = Expression.Lambda(body);
            func = lambda.Compile();
            lambdasMap[type] = func;
        }
        return func.DynamicInvoke();
    } 
```

我没有测试这个片段，但我认为它应该为引用类型产生“类型化”的空值。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-06-26T15:48:15.290

相当于 Dror 的答案，但作为扩展方法：

```
namespace System
{
    public static class TypeExtensions
    {
        public static object Default(this Type type)
        {
            object output = null;

            if (type.IsValueType)
            {
                output = Activator.CreateInstance(type);
            }

            return output;
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-01-10T09:34:27.917

对[@Rob Fonseca-Ensor 的解决方案稍作](https://stackoverflow.com/a/4027869/70345)调整：以下扩展方法也适用于 .Net Standard，因为我使用 GetRuntimeMethod 而不是 GetMethod。

```
public static class TypeExtensions
{
    public static object GetDefault(this Type t)
    {
        var defaultValue = typeof(TypeExtensions)
            .GetRuntimeMethod(nameof(GetDefaultGeneric), new Type[] { })
            .MakeGenericMethod(t).Invoke(null, null);
        return defaultValue;
    }

    public static T GetDefaultGeneric<T>()
    {
        return default(T);
    }
} 
```

...以及针对那些关心质量的人的相应单元测试：

```
[Fact]
public void GetDefaultTest()
{
    // Arrange
    var type = typeof(DateTime);

    // Act
    var defaultValue = type.GetDefault();

    // Assert
    defaultValue.Should().Be(default(DateTime));
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-03-31T18:52:11.457

```
 /// <summary>
    /// returns the default value of a specified type
    /// </summary>
    /// <param name="type"></param>
    public static object GetDefault(this Type type)
    {
        return type.IsValueType ? (!type.IsGenericType ? Activator.CreateInstance(type) : type.GenericTypeArguments[0].GetDefault() ) : null;
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-06-05T02:25:20.640

这应该有效： `Nullable<T> a = new Nullable<T>().GetValueOrDefault();`

# c# - 以编程方式在 MS Word 中打开 xml 文件

> ID：325428
> 
> 赞同：2
> 
> 时间：2008-11-28T10:12:26.960
> 
> 标签：c#, xml, ms-word, uri, openxml

我正在使用 C# 在 Microsoft Word 2007 中打开一个 xml 文件。我正在使用 xsl 文件来定义布局，该布局达到了我需要包含图像的程度。我使用了典型的 src html 标记，当在 ie 中查看 xml 时显示图像，但在 Word 中打开时不显示。我得到了图像占位符，所以我只能假设 Word 根本找不到图像。它位于 xml 文件和 xsl 文件旁边，但这没有任何区别。要打开文档，我将传递 xml 和 xsl 的文件名。我想，由于 src 在 xsl 中，它看起来只是相对于这些文件之一。

任何建议将不胜感激。

[编辑] 抱歉，我忘记了这个。我最后修好了。明天我会检查我的解决方案并更新它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T12:38:18.540

我认为您需要指定文档的工作路径以指向基本位置。像这样的东西：**wordDocument.Path** = xml 文件路径（或该图像假定为基础的任何内容）

# java - 在 Java 中使用 UUID 的最高有效位发生冲突的可能性

> ID：325443
> 
> 赞同：240
> 
> 时间：2008-11-28T10:24:18.717
> 
> 标签：java, collision, uuid

如果我使用`Long uuid = UUID.randomUUID().getMostSignificantBits()`它发生碰撞的可能性有多大。它切断了最低有效位，因此您可能会遇到碰撞，对吗？

* * *

## 回答 #1

> 赞同：219
> 
> 时间：2008-11-28T10:37:27.957

根据[文档](http://docs.oracle.com/javase/7/docs/api/java/util/UUID.html)，静态方法`UUID.randomUUID()`生成类型 4 UUID。

这意味着 6 位用于某些类型信息，其余 122 位是随机分配的。

六个非随机位分布在 UUID 的最高有效一半中，四个在最低有效一半中。因此，您的 UUID 的最重要的一半包含 60 位随机性，这意味着您平均需要生成 2^30 个 UUID 才能发生冲突（相比之下，完整 UUID 需要 2^61 个）。

所以我会说你是相当安全的。但是请注意，正如 Carl Seleborg 所提到的，对于其他类型的 UUID，这绝对不是真的。

顺便说一句，使用 UUID 的最低有效一半（或仅使用 SecureRandom 生成随机长整数）会稍微好一些。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-11-28T10:26:44.343

Raymond Chen 对此有一篇非常出色的博文：

[GUID 是全局唯一的，但 GUID 的子字符串不是](https://devblogs.microsoft.com/oldnewthing/20080627-00/?p=21823)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-05-15T10:02:29.447

我认为这是使用 randomUUID 的最佳示例：

[http://www.javapractices.com/topic/TopicAction.do?Id=56](http://www.javapractices.com/topic/TopicAction.do?Id=56)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-13T21:36:17.507

你最好只生成一个随机长值，然后所有位都是随机的。在 Java 6 中， new Random() 使用 System.nanoTime() 加上一个计数器作为种子。

有不同程度的独特性。

如果您需要跨多台机器的唯一性，您可以拥有一个中央数据库表来分配唯一 ID，甚至是批量唯一 ID。

如果您只需要在一个应用程序中具有唯一性，则可以只使用一个计数器（或根据您的要求从 currentTimeMillis()*1000 或 nanoTime() 开始的计数器）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-05-03T00:31:13.270

使用时间`YYYYDDDD`（年份 + 年份）作为前缀。这减少了表和索引中的数据库碎片。此方法返回`byte[40]`. 我在混合环境中使用它，其中 Active Directory SID ( `varbinary(85)`) 是 LDAP 用户的键，应用程序自动生成的 ID 用于非 LDAP 用户。此外，交易表（银行业）中每天的大量交易不能使用标准`Int`类型的键

```
private static final DecimalFormat timeFormat4 = new DecimalFormat("0000;0000");

public static byte[] getSidWithCalendar() {
    Calendar cal = Calendar.getInstance();
    String val = String.valueOf(cal.get(Calendar.YEAR));
    val += timeFormat4.format(cal.get(Calendar.DAY_OF_YEAR));
    val += UUID.randomUUID().toString().replaceAll("-", "");
    return val.getBytes();
} 
```

# hash - Visual Basic 6.0 哈希函数

> ID：325446
> 
> 赞同：6
> 
> 时间：2008-11-28T10:28:37.303
> 
> 标签：hash, vb6

在我的应用程序中，我需要在将字符串保存到文本文件之前对其进行哈希处理。有谁知道这是怎么做到的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T19:32:14.397

使用 CAPICOM 获取哈希的示例

添加`CAPICOM.DLL`为项目参考

```
uses 
  DIM key As String
  DIM sValue As String

  Dim sEncrypedValue as String 

Dim oCAP As CAPICOM.EncryptedData
Set oCAP = New CAPICOM.EncryptedData

With oCAP.
  .Algorithm.KeyLength = CAPICOM_ENCRYPTION_KEY_LENGTH_56_BITS
  .Algorithm.Name = CAPICOM_ENCRYPTION_ALGORITHM_RC4         
  .SetSecret key
  .Content = sValue 
end with

sEncrypedValue = objCAP.Encrypt(CAPICOM_ENCODE_BASE64)

To Decrypt:
oCAP.SetSecret key
oCAP.Content = sEncrypedValue 
sValue = oCAP.Decrypt(CAPICOM_ENCODE_BASE64) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-28T12:24:30.817

您出于什么目的使用哈希？这很重要，因为某些哈希算法（例如 MD5）适用于某些目的，但不适用于其他目的。

此链接显示[MD5 的 VB6 实现](http://sourceforge.net/projects/vb6md5hashcode/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T10:55:20.340

（评论需要 50 个代表）

Joel 提供的链接很好，但请注意，您需要将种子值更改为标准，以生成与其他人相同的 CRC32：

```
Optional ByVal Seed As Long = &HEDB88320 
```

希望可以节省其他人 30 分钟的工作时间！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T11:54:41.827

您可以尝试使用 CriptoASP。不要介意名称中的“ASP”，它是一个可以从 VB6 实例化的 ActiveX DLL。它提供了生成随机数、MD2、MD4、MD5 和 SHA 哈希以及某种加密/解密的方法。

您可以从[CriptoASP下载它](http://www.instisec.com/publico/descargas/?id=3)

[很抱歉，web 的语言是西班牙语，但我认为您可以通过Doc](http://www.instisec.com/publico/descargas/criptoasp.asp)底部的示例了解 COM 的简单使用。[对于 CriptoASP](http://www.instisec.com/publico/descargas/criptoasp.asp) ，只需用 VB6 中的新对象语句更改*Server.CreateObject 。*

如果您想要翻译示例或文档，请告诉我。

要将其保存到文本文件，您可以使用 FSO（文件系统对象）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T17:01:37.217

**我在这方面取得了非常好的结果，但实施是 c**

数据库

该算法是为 sdbm（ndbm 的公共域重新实现）数据库库创建的。发现它在加扰位方面做得很好，导致更好的密钥分布和更少的分裂。它也恰好是具有良好分布的良好通用散列函数。实际函数是 hash(i) = hash(i - 1) * 65599 + str[i]; 下面包含的是 gawk 中使用的更快的版本。[甚至还有一个更快的 duff-device 版本] 魔法常数 65599 是在尝试不同常数时凭空挑选出来的，结果证明它是一个素数。这是 berkeley db（参见 sleepycat）和其他地方使用的算法之一。

```
static unsigned long
sdbm(str)
unsigned char *str;
{
    unsigned long hash = 0;
    int c;

    while (c = *str++)
        hash = c + (hash << 6) + (hash << 16) - hash;

    return hash;
} 
```

**要将其移植到 vb，计算过程如下所示。基本上它从左到右遍历字符串的字符，计算哈希为**

```
newHash = the character (c) + (previousHashValue * 2^6) + 
                              (previousHashValue * 2^16) - 
                               previousHashValue**
previousHashValue = newHash 
```

# optimization - 您如何分析/优化模拟工具？

> ID：325452
> 
> 赞同：1
> 
> 时间：2008-11-28T10:31:13.413
> 
> 标签：optimization, profiling, modeling, simulation

过去，现在间歇性地，我使用过[Easy Java Simulations](http://www.um.es/fem/EjsWiki/index.php/Main/WhatIsEJS?)和[NetLogo](http://ccl.northwestern.edu/netlogo/)等模拟工具。

它们是对各种数学/comp-sci 概念进行可视化建模的绝佳工具，因为“您所要做的就是编写模拟循环——图形等已为您处理。

然而，我注意到的一件事是，使用这些工具提高执行时间/建模速度是极其困难的，因为实现的核心隐藏在表面之下。

一般来说，有关于如何使用模拟器工具的很好的文档，但我没有找到任何关于提高执行时间的东西。

例如，假设您正在实施牛顿法来求根。这是一个简单的算法，但取决于

*   您使用的图形附件类型，或
*   选择了各种其他杂项选项

模拟将以不同的速度运行。

有没有办法确定模拟数据的“最佳”显示？

在使用这种工具教授有关建模/科学编程的课程的情况下，我正在考虑这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T14:56:52.910

您可以尝试使用[Repast Symphony](http://repast.sourceforge.net/)代理模拟工具包。它是一个成熟的、免费的、开源的编程环境，具有许多有用的功能。您可以将 Repast 与具有[分析器插件](http://eclipsecolorer.sourceforge.net/index_profiler.html)的 Eclipse 集成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-18T13:13:46.073

通过 Netlogo，您可以使用 Profiler 扩展

```
    扩展 [分析器]

```

请参阅[netlogo 主页上的分析器文档](http://ccl.northwestern.edu/netlogo/docs/profiler.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T10:59:12.560

如果一切都失败了，您可以结合使用这两种方法：

*   对环境进行二次猜测：问问自己你将如何实现它的功能，然后推断出哪个功能可能需要最少的计算工作。
*   反复试验：只需通过测试来比较不同的方法。如果环境有一些工具来为你的代码计时，例如一个（准确地）告诉你现在时间的函数，那将是一个很大的帮助。

不要忘记内存缓存和优化等效果。如果您尝试在特定上下文中使用特定功能，它的运行方式可能与您之前的体验不同。

# oop - 如何以 OOP 方式编写 main()？

> ID：325453
> 
> 赞同：6
> 
> 时间：2008-11-28T10:33:16.247
> 
> 标签：oop, procedural, main-method

当我第一次开始编程时，我把所有东西都写在 main.js 中。`main()`但据我所知，我试图在我的方法中尽可能少做。

但是你决定让其他类/方法负责从哪里接管程序`main()`？你怎么做呢？

我见过很多方法，比如：

```
class Main
{
  public static void main(String[] args)
  {
    new Main();
  }
} 
```

有些像：

```
class Main {

   public static void main(String[] args) {

    GetOpt.parse(args);

    // Decide what to do based on the arguments passed
    Database.initialize();
    MyAwesomeLogicManager.initialize();
    // And main waits for all others to end or shutdown signal to kill all threads.
  }
} 
```

应该做什么和不应该做什么`main()`？还是没有银弹？

谢谢你的时间！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-28T12:25:57.133

主函数中的代码：

*   不能进行单元测试。
*   无法通过注入接收依赖项。
*   不能被类似于您编写的第一个应用程序的其他应用程序重用。

因此 main 函数中的代码：

*   必须非常简单，以至于您只对功能/系统测试感到满意。
*   必须负责为所有其他代码使用的依赖项设置滚动（也就是说，main 就像创建应用程序的超级工厂一样）。
*   应该只做特定于你的应用程序设置方式的事情（即测试代码或演示版本不需要做完全相同的事情）。

在实践中，这意味着真正的应用程序没有太多的主要内容。玩具应用程序和一次性程序可能有很多主要内容，因为您不打算测试或重用它们。

实际上，我上面所说的一些内容是特定于 C++ 的。Java 主要方法当然可以由测试代码或变体应用程序调用。但是它们仍然不将对象作为参数，仅将命令行参数作为参数，因此它们在测试中被隔离或在重用方面表现良好的程度非常低。我想你可以传递类名让它们实例化并用于创建应用程序的其余部分。

[编辑：有人从这个问题中删除了“C++，Java”标签。所以：我上面说的是 C++ 和 Java 特定的。其他语言可能以不那么特殊的方式对待 main ，在这种情况下，您也可能没有特别的理由来特殊对待它。]

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-28T10:46:13.117

在我看来，一个大型项目的“主要”应该包含大约 3 个函数调用：

*   调用为应用程序设置所有必需设置、首选项等的初始化函数。
*   启动应用程序的主“控制器”
*   等待主控制器终止，然后调用 Termination 函数来清理“main”中需要清理的任何内容（尽管控制器已经完成了大部分清理工作）。

任何相当大的应用程序都会被分成功能块，通常具有一些层次结构。主控制器可能有几个用于特定功能的子控制器。

这样做可以更容易地找到特定的功能，并且更好地分离关注点。

当然，正如其他回复所说，软件开发确实没有灵丹妙药。对于一个简短的项目，我可能会将所有内容都放在 main 中，以便快速启动和运行。我认为还取决于语言 - 某些选项可能比特定语言中的其他选项更容易。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-28T10:41:36.607

正如他们所说，无论你的船漂浮着什么。:) 你应该真正专注于使代码简单、易于阅读和高效，使用你需要的任何工具来实现这一点。如果它保证在 main 中放置大量代码 - 就这样做。如果你觉得物品会让事情更有条理——那就去吧。

制作单个实例`class Main`然后调用`Main()`完成所有工作的实例方法与直接在 main 方法中编写所有内容一样好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-28T10:55:58.307

我会说这不是你的主要功能，但不是。根据项目的复杂程度，您需要将其分解为功能部分，例如“数据库功能”、“显示功能”、“与牧师一起喝下午茶”等。

这都是关于代码的可读性。以前从未见过您的程序的其他人能否在遇到它时首先对它的作用有一个很好的概括性想法？

然后可以很容易地看到该去哪里更深入地挖掘机制？

您使用的每个功能部分是否仅执行逻辑流程块？它不必只做一件事，但它不应该做*所有事情*加上厨房水槽。

以一种外部资源可维护的方式分解您的代码。

因为老天知道，当涉及到它时，如果有人 - 其他 - 可以修复这个错误，那就更好了 =)

作为对您问题的直接回答，我会将对每个主要组件的函数调用放在 main、设置、过程和完成中，以便查看它的任何人都能快速了解程序的工作原理。然后，如果需要，他们可以进一步深入研究。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-08T02:08:32.987

看，“main”方法的内容和形式非常依赖于语言和环境。在 Java 中，每个类都可以有一个`public static void main()`方法，因此拥有多个方法是完全可行的。

但是现在，让我们通过帕纳斯模块化定律来思考这个问题：“每个模块都隐藏着一个秘密，而这个秘密是可以改变的。” 最初调用的模块的“秘密”是进程与操作系统接口的细节：诸如获取参数和处理不规则终止之类的事情。在 Python 中，这会导致如下情况：

```
def main(args=None):
    #argument processing
    #construct instances of your top level objects
    #do stuff

if __name__ == "__main__":
   try:
      main(Sys.Argv)
   except: # everything
      # clean up as much as you can
   else:
      # normal cleanup, no exceptions 
```

这里的重点是您可以从环境中获取所有内容，然后调用 main() 函数；您捕获所有未捕获的异常，并在程序终止之前对它们进行智能处理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T10:38:37.517

我认为主要方法应该解释程序在启动时的作用。所以它可能会调用初始化方法，但应该将逻辑提取到方法中。

在您的示例中，我不会创建 Main() 方法，而是将其放入原始方法中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-28T10:55:51.693

你的程序设计将决定你的“主要”的形状。

有一个“规则”来说明你的主要功能应该是什么 - 恕我直言 - 胡说八道。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-08T02:40:47.867

请记住，如果有人想了解您的程序是如何工作的，他们可能首先要看的地方是 main（至少我会）。所以，我认为尽可能少地投入它不是一个好主意。但我会说尽可能少地投入以鸟瞰您的程序是如何工作的。

因此，我认为您在实现主要功能时最大的担忧应该是可读性。

# ajax - Sharepoint、ajax 和页面标题

> ID：325461
> 
> 赞同：3
> 
> 时间：2008-11-28T10:39:54.800
> 
> 标签：ajax, sharepoint, moss

我对 sharepoint 和 ajax 功能有奇怪的问题。我们在 webpart 中放置了一个 UpdatePanel。当发生部分回发时，页面标题会丢失。

我们发现临时的部分解决方案是将标题元素写入一行，并且在其中不使用任何空格或控件......甚至不是文字控件。

但是我们需要一些方法来为所有页面提供 sommon 标题，所以标题看起来像这样：我的默认标题 - 当前页面标题

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T17:17:17.293

我想我会分享我对这个讨厌问题的解决方案。我最终做的是扔掉我放在下面的这个方便的小脚本。您可以将其放在自定义页面布局或自定义母版页中。它的工作原理是连接一个 AJAX 事件处理程序以在 AJAX 更改标题之前获取标题，然后使用上面的 Darpy 代码重新应用它。这允许始终显示正确的页面标题。

```
<script type="text/javascript">

// This script is to fix the issue where AJAX causes SharePoint 
// publishing pages to sometimes make the page title something 
// whacky. 
var app = Sys.Application;
var origTitle = "";
app.add_init(SPCustomAppnInit);

function SPCustomAppnInit(sender) {
  origTitle = document.title; // grab the original title.
  var prm = Sys.WebForms.PageRequestManager.getInstance();
  if (!prm.get_isInAsyncPostBack())
  {
 prm.add_pageLoaded(SPCustomPageLoaded); // wire up loaded handler.
  }
}

function SPCustomPageLoaded(sender, args) {

 document.title = origTitle; // put the original title back on the document.
}

<script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T15:09:33.697

我没有对新闻组帖子的引用，但正如 drax 所提到的，这是发布页面的一个已知问题。我过去使用的解决方法是对页面上的标题进行硬编码——丢失的元数据标题是错误的一部分。

当无法进行硬编码时，我使用 javascript 来更改页面标题： document.title = "title fixup here";

据说微软计划在下一个 sharepoint 版本中解决这个问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-11-10T20:04:42.407

我意识到这已经得到了回答，但我要投入我的 0.02 美元。问题似乎是由于两个条件而表现出来的：(1) 使用 AJAX 异步回发和 (2) 在页面的 <head> 中具有多行 <title> 元素。

检查您的母版页。如果它有类似的东西：

```
<title>
<sharepointwebcontrols:listitemproperty property="Title" ...>
</title> 
```

...然后将其全部更改为一行，如下所示：

```
<title><sharepointwebcontrols:listitemproperty property="Title" ...></title> 
```

问题解决了。不需要javascript。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T14:20:59.910

这看起来像是纯共享点的问题..而且看起来只是基于发布页面布局的网站受到影响。

我在 firebug 中调试了响应，由于某种原因，它返回了页面标题的设置，因此来自服务器的响应不仅包含更新面板信息，还包含空页面标题。

我调试了我们的 Web 部件，但它们都没有使用页面标题。我建议不要使用发布或不使用标题内的任何控件。

我们目前正在我工作的公司处理这个问题，所以当我们弄清楚一些事情时，我会上传你的发现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-20T21:24:06.130

在我的 webpart 用户控件的开头添加以下 @ 修复了问题

```
<script type="text/javascript"> 

// This script is to fix the issue where AJAX causes SharePoint  
// publishing pages to sometimes make the page title something  
// whacky.  
var app = Sys.Application; 
var origTitle = ""; 
app.add_init(SPCustomAppnInit); 

function SPCustomAppnInit(sender) { 
  origTitle = document.title; // grab the original title. 
  var prm = Sys.WebForms.PageRequestManager.getInstance(); 
  if (!prm.get_isInAsyncPostBack()) 
  { 
 prm.add_pageLoaded(SPCustomPageLoaded); // wire up loaded handler. 
  } 
} 

function SPCustomPageLoaded(sender, args) { 

 document.title = origTitle; // put the original title back on the document. 
} 

</script> 
```

非常感谢：D

# python - 在 python 脚本中启动 shell 命令，等待终止并返回脚本

> ID：325463
> 
> 赞同：77
> 
> 时间：2008-11-28T10:42:03.033
> 
> 标签：python, subprocess, popen, os.execl

我有一个 python 脚本，它必须为目录中的每个文件启动一个 shell 命令：

```
import os

files = os.listdir(".")
for f in files:
    os.execlp("myscript", "myscript", f) 
```

这适用于第一个文件，但在“myscript”命令结束后，执行停止并且不会返回到 python 脚本。

我能怎么做？我必须`fork()`以前`calling os.execlp()`吗？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2008-11-28T10:48:18.900

> subprocess：该`subprocess`模块允许您生成新进程，连接到它们的输入/输出/错误管道，并获取它们的返回码。

[http://docs.python.org/library/subprocess.html](http://docs.python.org/library/subprocess.html)

用法：

```
import subprocess
process = subprocess.Popen(command, shell=True, stdout=subprocess.PIPE)
process.wait()
print process.returncode 
```

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2008-11-28T11:01:45.270

您可以使用[`subprocess.Popen`](http://docs.python.org/library/subprocess.html). 有几种方法可以做到：

```
import subprocess
cmd = ['/run/myscript', '--arg', 'value']
p = subprocess.Popen(cmd, stdout=subprocess.PIPE)
for line in p.stdout:
    print line
p.wait()
print p.returncode 
```

或者，如果您不关心外部程序的实际作用：

```
cmd = ['/run/myscript', '--arg', 'value']
subprocess.Popen(cmd).wait() 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-03-03T18:29:29.257

自 2008 年以来，子流程模块已经出现。特别是[`check_call`](http://docs.python.org/library/subprocess.html#subprocess.check_call)让[`check_output`](http://docs.python.org/library/subprocess.html#subprocess.check_output)简单的子流程变得更容易。函数族`check_*`很好，如果出现问题，它们会引发异常。

```
import os
import subprocess

files = os.listdir('.')
for f in files:
   subprocess.check_call( [ 'myscript', f ] ) 
```

生成的任何输出`myscript`都将显示为好像您的进程生成了输出（从技术上讲`myscript`，您的 python 脚本共享相同的标准输出）。有几种方法可以避免这种情况。

*   `check_call( [ 'myscript', f ], stdout=subprocess.PIPE )`
    标准输出将被抑制（注意是否`myscript`产生超过 4k 的输出）。除非您添加选项，否则仍将显示 stderr `stderr=subprocess.PIPE`。
*   `check_output( [ 'myscript', f ] )`
    `check_output`将标准输出作为字符串返回，因此不显示。除非您添加选项，否则仍会显示 stderr `stderr=subprocess.STDOUT`。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-28T10:45:23.150

这些`os.exec*()`功能用新的程序*替换*当前程序。当这个程序结束时，您的进程也会结束。你可能想要`os.system()`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-28T10:58:10.987

使用产卵

```
import os
os.spawnlp(os.P_WAIT, 'cp', 'cp', 'index.html', '/dev/null') 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-03-08T20:56:10.330

我使用 os.system

```
import os
os.system("pdftoppm -png {} {}".format(path2pdf, os.path.join(tmpdirname, "temp"))) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-12-02T21:45:37.780

这对我有用！

`shell_command = "ls -l" subprocess.call(shell_command.split())`

# c# - 使用复选框列出文件 (C# / WinForms)

> ID：325464
> 
> 赞同：1
> 
> 时间：2008-11-28T10:42:17.650
> 
> 标签：c#, winforms, file, list

我想要一种方法来列出目录中的文件并在每个文件旁边放置一个复选框，以便我可以选择其中一些并对每个选定的文件执行操作，最好的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-28T10:58:55.697

将 CheckedListBox 控件拖放到表单上，然后使用 DirectoryInfo 和 FileSystemInfo 类填充内容，如下所示：

```
System.IO.DirectoryInfo di = new System.IO.DirectoryInfo("c:\\");
System.IO.FileSystemInfo[] files = di.GetFileSystemInfos();
checkedListBox1.Items.AddRange(files); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-28T10:52:08.753

您可以使用内置 winforms 控件的选中列表框控件（请参见下面的链接）：

[http://www.functionx.com/vcsharp/controls/checkedlistbox1.htm](http://www.functionx.com/vcsharp/controls/checkedlistbox1.htm)

[http://msdn.microsoft.com/en-us/library/3ss05xx6.aspx](http://msdn.microsoft.com/en-us/library/3ss05xx6.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-28T10:53:49.497

控制将[`CheckedListBox`](http://msdn.microsoft.com/en-us/library/system.windows.forms.checkedlistbox.aspx)是一个好的开始:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-28T11:07:40.687

您还可以使用 OpenFileDialog 类。这将显示标准的 windows 打开文件对话框，您可以将其设置为允许选择多个文件。

在许多情况下，对用户而言，使用标准对话框比使用自定义用户界面更容易。

尝试这样的事情：

```
OpenFileDialog fileDialog = new OpenFileDialog();
fileDialog.InitialDirectory =@"C:\temp\";
fileDialog.Multiselect = true;
if (fileDialog.ShowDialog() == DialogResult.OK)
{
  string[] files = fileDialog.FileNames;
} 
```

或者，您可以在表单设计器中添加对话框并在那里设置其属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-03T11:32:37.690

查看[FileView 控件](http://www.ssware.com/fileview/fileview.htm) 它可以显示带有复选框的文件/文件夹。

# c# - MaskedTextProvider c#

> ID：325468
> 
> 赞同：2
> 
> 时间：2008-11-28T10:46:05.740
> 
> 标签：c#

掩码文本提供程序用于什么？为什么它与正则表达式不同？

是否可以将正则表达式格式转换为掩码或反之亦然？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T10:48:13.283

蒙版编辑区强制用户以某种方式填写该字段：例如，看起来像### 的蒙版将只允许输入最多 3 个数字。

另一方面，正则表达式通常仅在用户输入所有文本后才检查。验证发生得太晚，无法提供逐个字符的反馈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T10:54:11.650

掩码编辑提供输入掩码，带有可选的分隔符和占位符。用户只能以提供的格式输入数据。另外，您可以将掩码类型设置为日期或时间，因此还会针对该特定类型验证数据。

# c# - 将单元测试代码写入 XML 注释

> ID：325475
> 
> 赞同：3
> 
> 时间：2008-11-28T10:50:49.443
> 
> 标签：c#, documentation, sandcastle

我正在尝试评论我向客户公开的 API (.Net)。我通过使用 XML 注释和通过 SandCastle 提取来做到这一点。

这一切都很好而且很花哨，但是我对 API 进行了单元测试，并且认为这些代码可以很好地放在示例标签中。

那么有人知道提取单元测试代码并放入示例标签的好方法吗？或者有人有更好的想法吗？

当然，我使用 API 重新分发单元测试，但最好将它们包含在文档中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T20:20:15.953

我正在使用 NUnit 和 Sandcastle 帮助文件生成器。请查看有关代码块组件的 Sandcastle 帮助文件生成器文档。

这是我如何在示例标记中放置单元测试代码的示例：

```
 /// <summary>
    /// Returns a string representation of an object.
    /// </summary>
    /// <returns>Comma separated string.</returns>
    /// <example>
    /// <code source="UnitM.CentrallProcessingLib.Tests\Data\CSVDataRowTests.cs" region="ToString_a" />
    /// </example>
    public override string ToString()
    {
        return this.Data;
    } 
```

这是一个引用的单元测试 (CSVDataRowTests.cs)（它应该在 #region 部分内）：

```
 #region ToString_a

    [Test]
    public void ToString_a()
    {
        CSVDataRow res = new CSVDataRow 
        {
            Data = "1;2;3"
        };

        Assert.AreEqual(res.ToString(), res.Data);
    }

  #endregion 
```

最好的祝福。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T10:57:54.060

我看到 Jon Skeet 给出了一个答案，这需要一些工作： [自动单元测试示例代码](https://stackoverflow.com/questions/301365/automatically-unit-test-example-code#301423) 有人去实现这个吗？有没有更简单的方法？这个问题是关于从 cs 文件中获取方法体： [Get a method's contents from a cs file](https://stackoverflow.com/questions/261741/get-a-methods-contents-from-a-cs-file)

我做了一个项目来做到这一点： [http ://code.google.com/p/addsourcetodocumentation/](http://code.google.com/p/addsourcetodocumentation/)

# xml - 使用变量选择元素

> ID：325479
> 
> 赞同：4
> 
> 时间：2008-11-28T10:52:38.563
> 
> 标签：xml, xslt, fxsl

基本上我有一个小模板，看起来像：

```
<xsl:template name="templt">
    <xsl:param name="filter" />
    <xsl:variable name="numOrders" select="count(ORDERS/ORDER[$filter])" />
</xsl:template> 
```

我正在尝试使用它来调用它

```
<xsl:call-template name="templt">
    <xsl:with-param name="filter" select="PRICE &lt; 15" />
</xsl:call-template> 
```

不幸的是，它似乎在调用模板之前对其进行评估（因此有效地传递了“false”）将它括在引号中只会使其成为字符串文字，因此这也不起作用。有谁知道我想要实现的目标是否可行？如果是这样，你能解释一下吗？干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-28T11:15:24.040

以下内容如何：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template name="templt">
    <xsl:param name="filterNodeName" />
    <xsl:param name="filterValue" />
    <xsl:variable name="orders" select="ORDERS/ORDER/child::*[name() = $filterNodeName and number(text()) &lt; $filterValue]" />
    <xsl:for-each select="$orders">
      <xsl:value-of select="."/>
    </xsl:for-each>
  </xsl:template>

  <xsl:template match="/">
    <xsl:call-template name="templt">
      <xsl:with-param name="filterNodeName" select="'PRICE'" />
      <xsl:with-param name="filterValue" select="15" />
    </xsl:call-template>
  </xsl:template>
</xsl:stylesheet> 
```

如果您仍然只想使用单个参数，您可以先在模板“templt”中进行标记。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-29T03:40:11.170

Divo 的回答很好。

但是，它将任何最终过滤限制为指定孩子的姓名和值。

**很高兴知道可以将一个（相当于一个）函数作为参数传递**。这个非常强大的概念在 FXSL 中实现[**——XSLT**](http://fxsl.sf.net)的函数式编程库。FXSL 完全用 XSLT 本身编写。

[**这是使用过滤器功能/模板**](http://fxsl.cvs.sourceforge.net/viewvc/fxsl/fxsl-xslt2/f/filter.xsl?revision=1.1&view=markup)的适当示例。我们将过滤器作为参数传递给执行过滤的模板。过滤器可以是任何代码/逻辑。在这种特殊情况下，我们将作为参数传递给检查数字是否为偶数的模板的引用。完整的转换仅输出那些值为偶数的“num”个元素。

**我们可以很容易地通过任何其他过滤器**，使用完全相同的技术：过滤（非）偶数、平方、素数等。

**请注意，不必为自己编写“过滤器”模板**——它是一次性编写的，并且由 FXSL 库提供。因此，您通常只使用 <xsl:import/> 指令来导入“过滤器”模板和 FXSL 已经提供的许多其他有用的功能/模板。

下面的变换：

```
<xsl:stylesheet 版本="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:f="http://fxsl.sf.net/"
xmlns:myIsEven="myIsEven"
>

  <xsl:import href="filter.xsl"/>

  <!-- 应用于numList.xml -->

  <xsl:output indent="yes" 省略-xml-declaration="yes"/>

  <myIsEven:myIsEven/>

  <xsl:模板匹配="/">
    <xsl:变量名="vIsEven"
         select="document('')/*/myIsEven:*[1]"/>

    按 IsEven 过滤：
    <xsl:call-template name="_filter">
        <xsl:with-param name="pList" select="/*/*"/>
        <xsl:with-param name="pController" select="$vIsEven"/>
    </xsl:调用模板>

  </xsl:模板>

  <xsl:模板名称="myIsEven" 模式="f:FXSL"
    匹配="myIsEven:*">
    <xsl:param name="arg1"/>

    <xsl:if test="$arg1 mod 2 = 0">1</xsl:if>
  </xsl:模板>
</xsl:样式表>

```

应用于此源 XML 文档时：

```
<数字>
  <num>01</num>
  <num>02</num>
  <num>03</num>
  <num>04</num>
  <num>05</num>
  <num>06</num>
  <num>07</num>
  <num>08</num>
  <num>09</num>
  <num>10</num>
</nums>

```

产生所需的（过滤的）结果，仅包含具有偶数值的节点：

```
按 IsEven 过滤：
<num>02</num>
<num>04</num>
<num>06</num>
<num>08</num>
<num>10</num>

```

有关 XSLT 中函数式编程的更多信息可以在[**FXSL 页面上**](http://fxsl.sf.net)找到，并且库本身可以从其[**sourceforce 项目**](http://www.sf.net/projects/fxsl)下载。

回到具体问题：

这种转变：

```
<xsl:stylesheet 版本="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:f="http://fxsl.sf.net/"
xmlns:myFilter="myFilter"
>

  <xsl:import href="filter.xsl"/>

  <!-- 应用于 Orders.xml -->

  <xsl:output indent="yes" 省略-xml-declaration="yes"/>

  <myFilter:myFilter/>

  <xsl:模板匹配="/">
    <xsl:变量名="vFilter"
         select="document('')/*/myFilter:*[1]"/>

    按 PRICE < 15 过滤：
    <xsl:call-template name="_filter">
        <xsl:with-param name="pList" select="/*/*"/>
        <xsl:with-param name="pController" select="$vFilter"/>
    </xsl:调用模板>

  </xsl:模板>

  <xsl:template name="myFilter" mode="f:FXSL"
    匹配="myFilter:*">
    <xsl:param name="arg1"/>

    <xsl:if test="$arg1/PRICE < 15">1</xsl:if>
  </xsl:模板>
</xsl:样式表>

```

应用于此源 XML 文档时：

```
<订单>
  <订单>
    <价格>10</价格>
  </订单>
  <订单>
    <价格>7</价格>
  </订单>
  <订单>
      <价格>22</价格>
</订单>
  <订单>
      <价格>16</价格>
  </订单>
  <订单>
      <价格>13</价格>
  </订单>
  <订单>
      <价格>19</价格>
  </订单>
</订单>  

```

产生想要的结果：

```
按 PRICE < 15 过滤：
<订单>
   <价格>10</价格>
</订单>
<订单>
   <价格>7</价格>
</订单>
<订单>
   <价格>13</价格>
</订单>

```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-28T11:27:31.583

使用 EXSLT 库，特别是[dyn:evaluate](http://exslt.org/dyn/functions/evaluate/index.html)函数，它可以将字符串计算为 XPath 表达式。

# java - Eclipse在哪里找到javac来编译项目？

> ID：325498
> 
> 赞同：17
> 
> 时间：2008-11-28T11:03:42.550
> 
> 标签：java, eclipse

这是我所拥有的：

JAVA_HOME=C:\Software\Java\jdk1.5.0_12（指向JDK 5.0）

在 Eclipse “已安装的运行时”中，我有： jre 1.5.0_12（指向 JRE 5.0） jre 1.6.0_3（指向 JRE 6.0）（这是默认设置）

我的 PATH 上没有“javac”（即，如果我不在 JDK/bin 中，则无法从命令行运行 javac -version）。

我的项目设置为使用 jre 1.6.0_3，编译器的合规级别设置为 6.0。

问题是：Eclipse 如何编译我的项目？它在哪里找到 6.0 的编译器？此外，有没有办法准确判断 Eclipse 使用了哪个编译器（即 javac 的路径）？

PS OS XP SP2 如果它是相关的 PPS 我没有在 eclipse.ini 中设置任何 -vm。在 Eclipse 中，我看到 eclipse.vm=C:\Program Files\Java\jre6\bin\client\jvm.dll 它仍然是一个 JRE。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-28T11:07:58.173

Eclipse 拥有包含增量编译器的[JDT](http://www.eclipse.org/jdt/overview.php)，因此除非您愿意，否则它不需要外部编译器：)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T14:33:47.593

Eclipse 在**window->preferences->java->Installed JRE** 's 下有一个已安装 JRE 的列表。被选为默认值的那个将是 Eclipse 中包含的那个，但是您可以轻松地从同一个首选项窗格中添加任何其他 JRE，并选择您希望的任何默认值。

这将是系统范围的默认设置，可以从 Build Path->Libraries 选项卡逐个项目覆盖。要更改，请选择**Add Library->JRE System Library**并从您配置的 JRE 中进行选择。然后删除默认的库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-28T11:11:15.720

Eclipse 附带一个内置编译器。如果您在首选项中配置它，您可以使用外部 JDK。

编辑：感谢安德烈！

# .net - Castle/Active Records：你如何计算对象？

> ID：325501
> 
> 赞同：5
> 
> 时间：2008-11-28T11:04:27.590
> 
> 标签：.net, sql, nhibernate, castle-activerecord

我正在尝试使用 NHibernate 上的 Castle 做一个简单的“从 PRODUCTS where date > xxx 中选择计数（*）”。

如果我直接使用 NHibernate，我可以重用[这个问题](https://stackoverflow.com/questions/116188/how-do-i-select-the-count-of-an-nhibernate-subquerys-results)的答案，但不幸的是，我看不到从 Castle Records 访问 Current NHibernate 会话的简单方法。

我显然不想检索我的所有对象并在 C# 端进行计数；）。我只需要知道有多少个对象。

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-28T12:14:40.837

有很多方法可以做到这一点，最简单的是：

```
ActiveRecordMediator<Product>.Count(Expression.Gt("date", DateTime.Now)) 
```

或者您可以使用 CountQuery、HQL 等，还有很多选择。

更新：对于 NHibernate 2.0+，它`Restrictions`不是`Expression`.

我会将这些常见问题复制到[ActiveRecord wiki](http://using.castleproject.org/display/AR/FAQ)。

# oracle - PL/SQL：从两个函数之间传递的游标中获取

> ID：325503
> 
> 赞同：1
> 
> 时间：2008-11-28T11:06:28.740
> 
> 标签：oracle, plsql, cursors

我有一个关于从弱类型游标中获取结果的快速问题，想知道以前是否有人遇到过这个问题？

我的设置如下；

内部功能；

```
create or replace FUNCTION A_CURSOR_TEST_INNER
(
  varCursor OUT SYS_REFCURSOR
)
RETURN NUMBER
AS
  varStatus NUMBER;
BEGIN
  OPEN varCursor  FOR
  SELECT docid
  FROM DOCUMENT_TABLE;

  RETURN 0;
END; 
```

调用函数；

```
create or replace FUNCTION A_CURSOR_TEST_OUTER
(
  varCursor  OUT SYS_REFCURSOR
)
RETURN NUMBER
AS
  varStatus NUMBER;
BEGIN
  varStatus := A_CURSOR_TEST_INNER(varCursor  => varCursor);
  RETURN 0;
END; 
```

测试线束代码；

```
DECLARE
  varCursor  SYS_REFCURSOR;
  v_Return NUMBER;
BEGIN
  v_Return := A_CURSOR_TEST_OUTER(varCursor  => varCursor);
    DECLARE
        docid_ NUMBER;
    BEGIN
        IF(varCursor %ISOPEN) THEN
            LOOP
                FETCH varCursor  INTO docid_ ;
                EXIT WHEN varCursor %NOTFOUND;
                DBMS_OUTPUT.PUT_LINE(' docid_:' || docid_ );
            END LOOP;
            CLOSE varCursor ;
        END IF;
    END;
END; 
```

如果我运行我的测试工具代码，我得到的错误是；

> ORA-06504: PL/SQL: 结果集变量或查询的返回类型不匹配

我不确定是什么导致了这种情况发生。该错误发生在我的测试代码中，但我之前已经使用了数百次完全相同的方法并且没有遇到这个问题。现在唯一的区别是，光标通过两个函数而不是一个函数传递回来。

有谁知道这里可能出现什么问题？我已经用谷歌搜索了它，我能找到的只是强烈键入光标的建议，不幸的是，这对我来说不是一个选择。

感谢任何人都可以提供的任何帮助，干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T12:18:10.283

我可以复制您的问题，对我来说这似乎是一个 Oracle 错误。通过谷歌搜索错误，我[在 OraFAQ 上发现了对同一问题的讨论](http://www.orafaq.com/forum/index.php?t=rview&goto=358469&th=127491)。

# java - 初始化 Map 的类型安全可变参数方法

> ID：325508
> 
> 赞同：1
> 
> 时间：2008-11-28T11:11:02.007
> 
> 标签：java, generics, variadic-functions

我想写一个可以用来初始化地图的方法。第一剪：

```
Map map(Object ... o) {for (int i = 0; i < o.length; i+=2){result.put(o[i], o[i+1])}} 
```

简单，但不是类型安全的。使用泛型，可能类似于：

```
<TKey, TValue> HashMap<TKey, TValue> map(TKey ... keys, TValue ... values) 
```

但不支持该语法。所以最终我来到了这个：

```
public static <TKey, TValue, TMap extends Map<? super TKey, ? super TValue>> TMap map(TMap map, Pair<? extends TKey, ? extends TValue> ... pairs) {
    for (Pair<? extends TKey, ? extends TValue> pair: pairs) {
        map.put(pair.getKey(), pair.getValue());
    }
    return map;
}

public static <TKey, TValue> HashMap<? super TKey, ? super TValue> map(Pair<? extends TKey, ? extends TValue> ... pairs) {
    return map(new HashMap<TKey, TValue>(), pairs);
}

public static <TKey, TValue> Pair<TKey, TValue> pair(TKey key, TValue value) {
    return new Pair<TKey, TValue>(key, value);
}

public static final class Pair<TKey, TValue> {
    private final TKey key;
    private final TValue value;
    Pair(TKey key, TValue value) {this.key = key; this.value = value; }
    public TKey getKey() {return key;}
    public TValue getValue() {return value;}
} 
```

但是当我尝试它时，我需要转换它：

```
private static final Map<? extends Class<? extends Serializable>, ? super TypeHandler<? extends Serializable > > validCodeTypes =
    /* (Map<? extends Class<? extends Serializable>, ? super TypeHandler<? extends Serializable >>) */
 map(
    pair(Integer.class,   new IntHandler()),
    pair(Integer.TYPE,    new IntHandler()),
    pair(Character.class, new CharHandler()),
    pair(Character.TYPE,  new CharHandler()),
    pair(String.class,    new StringHandler())
);

private interface TypeHandler<TType extends Serializable> {}

private static class CharHandler implements TypeHandler<Character> {}
private static class IntHandler implements TypeHandler<Integer> {}
private static class StringHandler implements TypeHandler<String> {} 
```

谁能告诉我如何编写我的 map() 方法，使其完全通用但不需要强制转换？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-28T11:17:58.903

为了让自己的生活更轻松，切勿使用包含通配符的返回类型。通常，通配符类型仅用于方法参数。

所以，试试这个：

```
public static <TKey, TValue, TMap extends Map<TKey, TValue>> TMap map(TMap map, Pair<? extends TKey, ? extends TValue>... pairs) {
    for (Pair<? extends TKey, ? extends TValue> pair: pairs) {
        map.put(pair.getKey(), pair.getValue());
    }
    return map;
}

public static <TKey, TValue> HashMap<TKey, TValue> map(Pair<? extends TKey, ? extends TValue>... pairs) {
    return map(new HashMap<TKey, TValue>(), pairs);
} 
```

我还没有测试过，但试一试，看看你的表现如何。

PS，而不是使用虚构的`Pair`类型，您可能会发现它更易于使用`Map.Entry`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T15:05:47.060

为什么不是这个？我是不是误会了什么？

```
import java.util.HashMap;
import java.util.Map;

public class ToHash {
    public static <K, V> Map<K, V> toHash(Object... objects) {
        Map<K, V> map = new HashMap<K, V>(objects.length / 2);
        if (objects.length % 2 != 0) {
            throw new IllegalArgumentException("Odd number of elements: " + objects.length);
        }
        for (int i = 0; i < objects.length; i += 2) {
            map.put((K) objects[i], (V) objects[i + 1]);
        }
        return map;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-29T23:21:56.793

pgdx：你的技术确实有效，但它并不妨碍我说类似的话：

```
Map<Long, Date> map = toHash("hello", "world"); 
```

我正在寻找一种允许编译器发现任何类型不匹配错误的方法。

# c# - 枚举结构？行为类似于 Enum 的 Value 对象

> ID：325511
> 
> 赞同：4
> 
> 时间：2008-11-28T11:12:14.983
> 
> 标签：c#, enums

我想知道你将如何解决这个问题

我有两种适用于我的产品的税率。我特别想避免将税率持久化到数据库中，同时仍然能够在中心位置更改它们（例如税率从 20% 到 19% 等）。

所以我决定将它们编译到我的应用程序中会很棒（它是内部的）。问题是我不仅想知道税率，还想知道税率的名称。

我可以使用映射到该值的枚举。但是我必须创建一些方法来检索英语枚举值的该税率的德语名称（我用英语编写代码，应用程序是德语）。

我想过只使用硬编码的对象来反映这一点，

```
public interface Taxrate
{
    string Name { get; }
    decimal Rate { get; }
}

public class NormalTaxRate : Taxrate
{
    public string Name
    { get { return "Regelsteuersatz"; } }

    public decimal Rate
    { get { return 20m; } }
} 
```

但是我必须创建某种列表来保存这两个对象的两个实例。做静态可能有效，但我仍然必须保留某种列表。此外，我必须找到一种方法将我的 POCO 域对象映射到此，因为我怀疑 NHibernate 是否可以根据字段中的值实例化正确的对象。

感觉不太对劲，我想我在这里遗漏了一些东西。希望有人有更好的解决方案，我想不出一个。

问候，丹尼尔

*Ps：如果你找到合适的东西，也请重新标记这个问题，我现在想不出更有意义的标签。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-28T11:25:53.240

编辑：请注意，这里的代码可以很容易地通过让私有构造函数获取税率和名称来缩写。我假设在现实生活中，税率之间可能存在实际的行为差异。

听起来你想要像 Java 的枚举这样的东西。

C# 使这相当棘手，但您可以在某种程度上使用私有构造函数和嵌套类来做到这一点：

```
 public abstract class TaxRate
 {
     public static readonly TaxRate Normal = new NormalTaxRate();
     public static readonly TaxRate Whatever = new OtherTaxRate();

     // Only allow nested classes to derive from this - and we trust those!
     private TaxRate() {}

     public abstract string Name { get; }
     public abstract decimal Rate { get; }

     private class NormalTaxRate : TaxRate
     {
         public override string Name { get { return "Regelsteuersatz"; } }
         public override decimal Rate { get { return 20m; } }
     }

     private class OtherTaxRate : TaxRate
     {
         public override string Name { get { return "Something else"; } }
         public override decimal Rate { get { return 120m; } }
     }
 } 
```

您可能希望 TaxRate 中的某种静态方法根据名称或其他内容返回正确的实例。

我不知道这有多容易与 NHibernate 配合，但希望它会在一定程度上有所帮助......

正如评论中所指出的，它非常难看——或者至少当你有很多不同的值时会变得非常难看。部分课程可以在这里提供帮助：

```
// TaxRate.cs
public partial abstract class TaxRate
{
    // All the stuff apart from the nested classes
}

// TaxRate.Normal.cs
public partial abstract class TaxRate
{
    private class NormalTaxRate : TaxRate
    {
        public override string Name { get { return "Regelsteuersatz"; } }
        public override decimal Rate { get { return 20m; } }
    }
}

// TaxRate.Other.cs
public partial abstract class TaxRate
{
    private class OtherTaxRate : TaxRate
    {
        public override string Name { get { return "Something else"; } }
        public override decimal Rate { get { return 120m; } }
    }
} 
```

然后，您可以调整项目文件以将嵌套类显示为外部类的子类，[如此 SO question](https://stackoverflow.com/questions/223249/)中所示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T12:00:19.040

我会这样做：

```
public class TaxRate
{
    public readonly string Name;
    public readonly decimal Rate;

    private TaxRate(string name, decimal rate)
    {
        this.Name = name;
        this.Rate = rate;
    }

    public static readonly TaxRate NormalRate = new TaxRate("Normal rate", 20);
    public static readonly TaxRate HighRate = new TaxRate("High rate", 80);
} 
```

这样就很容易使用它——只需访问`TaxRate`像枚举值这样的静态成员。要将它与 NHibernate 一起使用，您必须创建自己的自定义 NHibernate 类型类（请参阅它的文档），但这并不难。我已经做过一次了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T11:22:33.870

为什么不将税率存储在应用程序配置中，例如在 web.config 或 app.config 文件中？这些是简单的 XML 文件，其中有一个名为的部分，您可以在其中使用键和值指定自定义参数。例如：

```
<appSettings>
    <add key="BaseTaxRate" value=20"/>
    <add key="HigherTaxRate" value=40"/>
</appSettings> 
```

然后，您可以简单地在应用程序中检索这些：

```
string baseTaxRate = ConfigurationSettings.AppSettings["BaseTaxRate"]; 
```

这样，它们很容易更改，并且不需要重新编译和重新部署您的应用程序。

显然，您还可以将税率名称作为额外设置存储在配置文件中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-28T14:33:42.553

我必须说我发现使用嵌套类的想法有点奇怪，因为在我看来这是一种主流要求。

将速率存储在数据库（或其他持久性介质，例如应用程序配置文件）中有什么问题？我原以为您希望每个税率都有一个唯一的 ID，用于产品和税率之间的关系。

因此，您将拥有一个带有 Id/Description/Rate (*) 的 TaxRate 类。您可以加载包含所有可能值的字典，以便按 Id 快速查找速率/描述。

(*) 在多语言应用程序中，您需要查找每对 Culture/Id 的本地化描述 - 从数据库中的第二个表或资源等...

无论如何，硬性税率似乎是错误的——尤其是现在政府正在利用税率来促进经济发展。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-28T15:01:47.987

我知道这违背了你问题的主要前提，但我想对这个问题提出一些想法。

虽然目前看来避免在数据库中保留增值税和税率似乎是一个合乎逻辑的决定，但时间会证明你错了。首先，您应该始终能够在给定时间提取数据，为此您需要对速率进行版本控制。

众所周知，唯一不变的就是变化。说利率变化（他们会）。如果您失去了对源的访问权限，则无法进行适当的维护。如果将税率从统一增值税拆分为不同的税率，更新系统将更加困难。

这个问题虽然不是问题。自 12 月 1 日起，英国已将增值税从 17.5% 降至 15%。许多人被旧软件困住而无法更新费率。请避免犯此错误（将费率拆分到数据库中也会带来许多其他改进）。

# .net - 从 WebBrowser 控件中打开文件？

> ID：325512
> 
> 赞同：3
> 
> 时间：2008-11-28T11:12:38.853
> 
> 标签：.net, winforms, webbrowser-control

有谁知道是否可以通过 WebBrowser 组件中的链接打开文件系统中的文件？我正在编写一个小报告工具，其中我在 WebBrowser 组件中将摘要显示为 HTML，并带有指向更详细分析的链接，该分析保存为磁盘上的 Excel 文件。

我希望用户能够在网络浏览器中单击该链接（目前只是一个标准的 href 标记，以 file://path.xls 作为目标）并得到打开文件的提示。如果我在 IE 中打开我的页面，这是可行的，但在 WebBrowser 控件（C# Windows Forms，.Net 2.0）中没有任何反应。

我不知道我是否需要一些额外的权限/信任或类似的东西 - 有没有人成功地做到了这一点，或者任何人都可以建议如何调试这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T11:51:51.570

我还测试了罗斯的解决方案，它也对我有用。

但这是另一种方法，您可以在应用程序（不是 HTML 页面）中使用自己的 C# 代码直接打开文件，而不是使用弹出对话框要求您下载、打开或取消下载的内置功能（或者也许做其他事情）。

根据[Microsoft MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.objectforscripting.aspx)示例：

```
using System;
using System.Windows.Forms;
using System.Security.Permissions;

[PermissionSet(SecurityAction.Demand, Name="FullTrust")]
[System.Runtime.InteropServices.ComVisibleAttribute(true)]
public class Form1 : Form
{
    private WebBrowser webBrowser1 = new WebBrowser();
    private Button button1 = new Button();

    [STAThread]
    public static void Main()
    {
        Application.EnableVisualStyles();
        Application.Run(new Form1());
    }

    public Form1()
    {
        button1.Text = "call script code from client code";
        button1.Dock = DockStyle.Top;
        button1.Click += new EventHandler(button1_Click);
        webBrowser1.Dock = DockStyle.Fill;
        Controls.Add(webBrowser1);
        Controls.Add(button1);
        Load += new EventHandler(Form1_Load);
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        webBrowser1.AllowWebBrowserDrop = false;
        webBrowser1.IsWebBrowserContextMenuEnabled = false;
        webBrowser1.WebBrowserShortcutsEnabled = false;
        webBrowser1.ObjectForScripting = this;
        // Uncomment the following line when you are finished debugging.
        //webBrowser1.ScriptErrorsSuppressed = true;

        webBrowser1.DocumentText =
            "<html><head><script>" +
            "function test(message) { alert(message); }" +
            "</script></head><body><button " +
            "onclick=\"window.external.Test('called from script code')\">" +
            "call client code from script code</button>" +
            "</body></html>";
    }

    public void Test(String message)
    {
        MessageBox.Show(message, "client code");
    }

    private void button1_Click(object sender, EventArgs e)
    {
        webBrowser1.Document.InvokeScript("test",
            new String[] { "called from client code" });
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T11:34:15.813

我刚刚尝试了一个看起来像 <a href="file:///C:\temp\browsertest\bin\Debug\testing.xls">Test</a> 的链接

它按预期工作。

您是否指定了 xls 的完整路径？

# c# - 强类型视图数据

> ID：325513
> 
> 赞同：2
> 
> 时间：2008-11-28T11:12:54.063
> 
> 标签：c#, asp.net-mvc

我创建了`LocationViewData`一个具有类似属性的强类型

```
public Location location { get; set; } 
```

`Location`本身是模型，具有属性`Address`,`Country`等。

在控制器中我有：

```
public ActionResult Edit(int id)
{
    LocationViewData ld = new LocationViewData();
    ...
    return View(ld);
} 
```

在视图代码隐藏中，我有：

```
public partial class Edit : ViewPage<MvcTest.Models.LocationViewData>
{
} 
```

我的问题是：如何让`Location`模型中的属性`ViewData`显示在适当的文本框中，例如：

```
<%=Html.TextBox("address") %> 
```

我不想用全名指定每个字段：

```
<%=Html.TextBox("address", ViewData.Model.location.address) %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T11:22:17.973

它已经完全像那样工作了。启动一个新的 MVC (beta 1) 项目，并将其放入“Home”控制器的“Index”操作中：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        this.ViewData.Model = new MyObject
        {
            Name = "Timmy",
            FavColor = "Blue",
        };

        return View();
    }

    public class MyObject
    {
        public string Name { get; set; }

        public string FavColor { get; set; }
    }
} 
```

现在，把它放在视图中：

```
<%=Html.TextBox("FavColor") %> 
```

它会在里面说“蓝色”。它已经尝试按名称绑定（MVC 检查几个地方，其中之一是“模型”）。

编辑：你需要做的是：

1.  确保“位置”是一个属性，而“地址”是一个属性。

2.  将“location.address”作为名称......不仅仅是“地址”。

# language-agnostic - 代码可重用性：值得吗？

> ID：325514
> 
> 赞同：16
> 
> 时间：2008-11-28T11:13:43.390
> 
> 标签：language-agnostic, code-reuse

我们都编写可重用的类和代码。

我们考虑了可配置性，以允许我们一次又一次地重用这个奇妙的新类。

我们告诉我们的老板，现在花费这些额外的时间将为我们以后节省时间和金钱。

但实际上，对于我们这些不编写第三方库并将时间花在整个应用程序上的人来说，有多少次你花费额外时间编写的一个类实际上会在另一个项目中被重用?

您的图书馆中有多少定制课程将用于多个项目？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-28T11:15:54.290

我的共同经验法则是：

1.  如果你重复一次，复制它。
2.  如果你重复两次，重构它。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-28T11:16:38.580

好问题！
我认为“为重复使用而设计”是错误的方法。我发现我编写的代码可以正常工作、干净且漂亮，是可重用的。实际的重用 *设计只发生在代码第一次真正被重用时！*

事先花时间尝试使某些东西可重用往往是浪费时间，因为您永远不知道需要重用什么。

话虽如此，在我的工作中，我们有一个库集合（大，500MB 或更多），几乎可以在每个项目中重复使用——主要是特定领域的东西。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-28T11:20:32.253

莱皮写道：

> 我的共同经验法则是：
> 
> 1.  如果你重复一次，复制它。
> 2.  如果你重复两次，重构它

我还要补充一点，确保在代码的***两个***部分都添加注释以指示重复，以防出现错误。您不想修复它的一部分而不是另一部分（BDTTGTT）。

抢

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-28T12:00:23.017

我不是 XP 方法（或任何方法）方面的专家，但我认为[YAGNI](http://en.wikipedia.org/wiki/You_Ain%27t_Gonna_Need_It)原则可以在这里应用。

**仅在必须**重用时修改代码以供重用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-28T12:02:47.960

可配置性和可重用性之间存在差异——前者在许多不同的情况下非常有用，当环境发生变化或其他任何事情时——以我理解的方式使事物可配置，主要是分离代码和数据的情况——这真的是很好的做法。

仅当您正在创建计划用作多个项目的库时，为可重用性设计才真正有用。随着岁月的流逝，我越来越意识到 YAGNI 原则，这些天我的目标只是为手头的任务编写干净而健壮的代码。我的经验是，如果要重用某些东西，您不太可能准确预测它需要如何重用，因此最好只添加您现在需要的代码*。*这样，如果您将来需要重用它，您可以添加新的东西来完全满足您的需要，而不必破坏您过去编写的任何现有功能，试图预测您现在可能需要它的方式。

您可能会发现，在这样做几次之后，您就有了一个稳定且健壮的库，并且不需要您更改它，因为它实际上可以完成您需要的所有事情 - 对我来说，允许这种情况发生要容易得多这种进化方式比浪费太多时间猜测未来。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-28T12:18:13.933

我认为最好的方法是尝试设计具有良好接口和类之间职责分离的代码，而不必过多担心重用。但至少如果你以这种方式设计，你就会留下重用的*可能性*。一个好的经验法则是问自己“如果我在 3 个月后回到这段代码，我会理解它吗？如果必须的话，我可以扩展它吗？”

IMO 行业中最糟糕的做法之一是当一个团队被允许开始编写他们自己的“可重用”框架时......

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-28T20:36:30.060

我喜欢你不断扩展语言的 LISP 模型。最终，您最终会为您的问题域提供一种特定于域的语言。并不是说我真的写了任何 lisp，而是在我最常使用的语言中——Lua 和 C——我通常将一些东西拉到一个模块中并重用它，而不是克隆和修改。

对于 C 程序员，这种方法的典型例子是 Dave Hanson 的书[C 接口和实现](http://www.cs.princeton.edu/software/cii/)。Dave 将他在编写三四个编译器时的每一个可重复使用的想法都写进了一本书中——而且该软件是免费的。很棒的东西。现在，如果我编写 C 代码并且想再次使用它，我会创建一个 Hanson 风格的界面。这个学期我做了一些事情：二维数组、带阻塞的二维数组、二维位图、pbmplus 文件的读取器和写入器，等等。有了这个基础设施，很容易编写一个我多年来一直想要的程序，该程序是从书页影印件的扫描中去除黑边。

所以我同意任何人所说的，当你想重复使用它时，把它拔出来——但不是之前。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-29T08:33:18.083

恕我直言，某些代码可能会经常被重用，并且为频繁重用做好准备是有意义的。除了解决眼前的问题之外，其他代码不需要，而且可能不需要开发。

当然，请注意区分是 NP 难的。:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-28T11:20:08.290

如果您确定不再需要它，请不要打扰。即使您认为它*可能*会派上用场，也不会。当你真的再次需要它时重构它......

但是，不使其可重用并不是不使其透明的借口。每当我尽可能透明地编写代码时，它总是 99% 可重用......

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-28T12:16:43.780

一旦你超越了技术实用程序的水平，我在现实世界中看到的实际重用很少。

如果你仔细想想，原因就很清楚了。假设 widget_bodger 应用程序包含了您需要的 90% 的功能，而不是仅将缺少的功能添加到应用程序中。

或者说企业很欣赏 widget_bodger 中一个非常酷的“哔”功能，并希望将其整合到 gernerate_executive_expenses 应用程序中。啊，您可能会认为重用，但随后您深入研究代码，发现 GEE 应用程序是公司中最古老的应用程序之一，用 C 编写，必须在高可用硬件上运行，唯一可重用的是基本算法.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-28T12:49:45.260

关于是什么使代码可重用存在非常不同的意见。我想说你的时间花在使代码清晰和精心设计上（即职责分离）。

这样做的一个附带好处是更好的可重用性。主要好处是使代码更易于理解、更改和调试。

把它包起来。不要仅仅为了使其可重用而做复杂的配置方案、扩展点和事件。尝试找到正确的移动部件，以便可以根据新需求编写代码。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-29T08:39:23.173

“可重用”代码通常是抽象和模块化的代码，对我来说，主要的好处不是可重用性，而是增加了可测试性。因为当您隔离和模块化代码时，它通常变得更可测试。重用是一种方便但经常未被使用的副作用。

另一方面，Juval Lowry 提倡基于接口的编程，因为他认为接口是可重用性的唯一组成部分。其他任何东西都具有隐含的功能（难以重用），而接口仅定义可隐式重用的合约。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-28T11:26:12.350

我同意你的观点，因为以一种使类在当前应用程序之外易于使用的方式进行编码是没有意义的。大多数情况下，如果我们不这样做，在商业环境中就没有必要这样做。如果另一个应用程序在以后需要此功能，则可以将代码提取和通用化作为第二个项目的一部分，并且管理层可能会同意这一观点。

然而，让您的代码在当前应用程序的约束下可重用是一种很好的做法。重构您的代码，以避免在您当前的工作范围内重复。这样，您以后可以更轻松地使用它。不要像改变那样重用代码，改变要普遍得多。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-28T11:32:44.210

我的 2c 是代码重用的道德需要成为公司的事情，而不仅仅是项目的事情。这意味着当您开始一个新项目时，主要关心的是“我可以从哪些其他项目中窃取代码以尽可能快地完成这项工作？”。

这将与“什么是最好的 - 或最流行的 - 工作语言/工具？”的问题相冲突？

采用这种方法的公司最终拥有一批工程师，可以轻松地从一个项目切换到另一个项目，因为语言、框架和内部代码库都是一致的。

不利的一面是，切换到“新”语言或框架在政治上要困难得多，即使它需要在某个时候发生。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-11-28T11:56:37.393

SOA 失败或尚未解除的原因之一是很难重用服务：要么它太具体，无法在其他地方使用，要么太通用（通常非常复杂），不能满足不同客户的需求。

这不是“代码重用”，而是“服务重用”，但有一些共同的概念。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-29T14:33:38.387

重用的另一个好处是您可以轻松地跟踪在 oode 库中发生的事情。如果你有一百万行代码，可能需要几个小时才能找到应用程序以某种方式运行的所有地方。使用现代 IDE，您只需单击“查找引用”，您将在几秒钟内找到使用您的组件/方法的所有位置。当您想要添加新功能、修复错误或只是想了解系统如何工作时，这可能很有用。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-02T00:11:04.943

我们有一些，但我们有更多的是具有您想要的功能但以自己的方式完成的项目，因此通常您最终会从旧项目中蚕食功能并在新项目中重新实现它们。我认为这仍然很重要 - 您仍然可以从之前编写代码中受益，并且您仍然可以节省时间。

此外，我发现只有第二次尝试使用该功能时，可重用性就变得很明显了，如果您尝试推测性地概括某些东西，您几乎总是会出错，并且下次必须更改它。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-02T00:37:18.933

就像其他海报所说的那样，如果您要复制代码然后重新使用，一旦您开始调试复制的代码，您会很高兴这样做。

# c# - MVC ASP.NET 从视图到控制器获取 52 个文本框键/值的最佳方法

> ID：325515
> 
> 赞同：2
> 
> 时间：2008-11-28T11:13:48.757
> 
> 标签：c#, asp.net-mvc

我希望不要将每个参数作为参数传递给控制器​​ post 方法。

有一个由 52 个文本框组成的网格，代表一年中的几周，每个文本框都包含一个十进制值，需要将所有这些都传递回控制器以进行数据库的大规模更新。

编辑：添加更多细节。

所以我的行动 Index(); 返回一个包含 52 个对象列表的视图。

所以

返回视图（日期）；

在视图中，我为模型中该类型的所有对象执行 foreach，并将它们的值放入文本框中，然后我想更改它们并点击提交。

**有什么方法可以将更新的列表放入我的 POST 控制器中，而不必为它提供 52 个带有文本框 ID 的参数？**

提前非常感谢！

编辑：也许有一种方法可以将论坛发布到控制器并遍历文本框控件并获取 id/value，知道怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T11:15:38.317

我建议使用模型活页夹：

[http://www.singingeels.com/Articles/Model_Binders_in_ASPNET_MVC.aspx](http://www.singingeels.com/Articles/Model_Binders_in_ASPNET_MVC.aspx)

[http://www.singingeels.com/Articles/Model_Binders_in_ASPNET_MVC__Part_2.aspx](http://www.singingeels.com/Articles/Model_Binders_in_ASPNET_MVC__Part_2.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T23:50:33.740

看看这个问题。它应该为您提供比使用 FormCollection 更好的答案。

[复杂模型绑定到列表](https://stackoverflow.com/questions/231878/complex-model-binding-to-a-list)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-11-28T12:58:15.820

嘿，经过一番折腾，我得到了想要的解决方案。我刚刚传入了参数“FormCollection myForm”，在对该对象进行了一些探索之后，我发现了我的 52 个值！谢谢您的帮助。

编辑：我可能在一年前因为同侪压力而删除了它......但回顾它，除了回答我自己的问题之外，我看不出问题是什么......

# .net - 使用 Console.ReadKey 读取 Unicode

> ID：325516
> 
> 赞同：2
> 
> 时间：2008-11-28T11:14:01.203
> 
> 标签：.net, console.readkey

是否可以向控制台应用程序提供 Unicode 输入，并通过 Console.ReadKey() 读取 Unicode 字符/字符串？

我知道 Unicode 在通过其他方法读取输入时有效，但不幸的是我需要使用 ReadKey 提供的“拦截”功能。

更新：

将 U+03BB (λ) 等 Unicode 字符粘贴到控制台时，会读取 3 个键。

1.  Alt + 数字键盘1
2.  Alt + 数字键盘1
3.  Alt + NumPad8

我试图看看这是否是某种编码，但什么也看不到。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-30T17:56:32.610

不幸的是，Console.ReadKey 只能处理键盘事件。键盘事件只能表示可以在键盘上键入的内容（使用 ConsoleKey 枚举中定义的真实和“虚拟”键）。因此，当使用 ReadKey 时，您只会得到两件事：原始键码，对应于键盘上的键，以及翻译后的字符，即原始键码映射到控制台输入代码页中的 Unicode 字符（和每个代码页最多可以映射 256 个字符）。您无法使用 ReadKey 读取任何其他类型的数据（即无法直接键入和/或在输入代码页中没有映射的字符）。

此外，当您将 Unicode 字符粘贴到控制台时，ReadKey 使用的 API 会尝试将该字符转换为 Windows ALT+nnn 序列（即，按住 ALT 并在键盘上键入代码点编号）。不幸的是，它首先转换字符，使用为输入代码页定义的规则，因此即使您重构代码点编号，您也不会得到粘贴的实际字符，您将得到代码页映射的任何字符到。

使用 Read 或 ReadLine 时一切正常的原因是它们是基于流的方法，而不是基于键盘的方法。显然，任何字符都可以通过输入流进入，因为没有发生键盘和代码页转换。但是您不能直接使用 ReadKey 获取输入流，只能使用键盘（如果输入流已从键盘以外的其他地方重定向，ReadKey 将彻底失败）。

如果您手动将控制台 API 与 P/Invoke 一起使用，可能有一些方法可以使用输入流复制 ReadKey 的“拦截”功能，但这将是不平凡的，并且控制台并不是真正设计来做那种事情的所以你可能会一直与之抗争。

* * *

编辑：话虽如此，您仍然可以实现自己的组合键，以允许通过键盘输入 Unicode 字符——例如输入 CTRL+ALT+U，然后输入四个十六进制数字——您的 ReadKey 例程可以检测到 CTRL+ALT +U 然后抓取接下来的四个击键并从中生成一个 int 并将其转换为 char ——但这当然不允许粘贴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T17:14:03.087

Console.ReadKey() 返回的 ConsoleKeyInfo 对象有一个名为 KeyChar 的属性，其中包含按下的键或组合键的 Unicode 字符（如果键或组合键具有 Unicode 等效项）。所以...

```
char c = Console.ReadKey().KeyChar; 
```

如果键没有 Unicode 等效项（例如，功能键），您将获得一个 '\0' 字符。

如有必要，您可以使用 StringBuilder 将这些字符连接成一个 Unicode 字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-04T11:53:41.467

现在这很奇怪。IIRC 我的测试是在 32 位上进行的，可能是 Vista。

现在在Win7 64位上测试了同样的东西，该死的东西有效！

所以无论是 Vista 还是 32 位错误。

有人可以确认一下吗？

# networking - 基于邻近度的负载均衡

> ID：325523
> 
> 赞同：6
> 
> 时间：2008-11-28T11:17:17.110
> 
> 标签：networking, load-balancing

我正在做一个项目，如果我们拥有遍布全球的服务器数量（目前为 5 个）。客户端通过集中式代理连接到其中一台服务器。我们只知道客户的原产国，但一无所知。我们可以完全控制服务器，因此我们可以获得所需的所有信息。我们不控制客户端，他们必须按照标准通过这个代理进行连接。

经纪人选择具有低延迟的服务器很重要，因此对于我们拥有的数据，我认为接近度是我们唯一可用的标准。

想到的第一个想法是从每个服务器 ping 客户端，但我们没有 IP，只有国家。

我们的另一个想法是从每个服务器 ping 每个国家/地区的根节点。那里的问题是在每个国家/地区找到一个根节点。

您知道如何计算/查找“国家”之间的接近度吗？您对如何以另一种方式解决此问题有任何见解或想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-28T11:35:04.767

这很棘手，比许多人想象的要复杂，但我觉得有一个**正确**的答案。

当然，幼稚（但很酷）的解决方案是检查客户端的 IP，这是一个好的开始，但在“现实世界”中，**地理位置并不是一切**......

您只是要求“**低延迟**”，这意味着您应该在服务器和客户端之间进行**ping并相应地分配。**这个问题多次影响我个人的一个很好的例子是我在日本工作，而台湾的服务器对我来说更接近美国的服务器。**但是**，日本和美国之间的延迟比台湾少很多倍（更好的响应），因为连接**日本和台湾**的电缆和路由器以及你有什么不如日本和**美国**之间的延迟。所以如果你把我和台湾联系起来，因为你认为我的 IP 更接近，你会**非常不喜欢我**那里。除了在启动时进行 ping 和实际的小测试比保持一些不断更新的地理定位数据库更容易

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-28T11:34:03.380

我认为您需要的术语是“地理负载平衡”。大多数主要的负载平衡供应商都有一个解决方案——你的代理可以使用这些。

谷歌搜索[地理负载平衡](http://www.google.co.uk/search?hl=en&q=geographic+load+balancing)会得到一些有用的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-28T12:49:46.630

Paul 拥有它，你想要地理负载平衡——但我要补充一点，如果可以选择的话，你最好的选择是找到专门研究它的人并向他们投钱。它属于比最初出现的问题更难可靠解决*的问题。*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-01T21:37:09.530

对此的最佳解决方案称为*BGP 任播*（[链接到演示文稿](http://newnog.net/meetings/nanog29/presentations/miller.pdf)）。它是所有现代 CDN 的基石。

使用*BGP 任播*，多个不同的服务器分布在世界各地，并使用*相同的 IP*通过 BGP 向 Internet 发布。然后互联网发挥了作用——像往常一样，网络通过最短路径将流量路由到*同一个 IP ，本质上为每个用户选择最近的服务器（从网络拓扑的角度来看）。*

不幸的是，你不能自己通过 BGP 宣布任何事情——只有大型网络（通常是数据中心）才能做到这一点。但是可以使用负担得起的解决方案，其中大多数基于*DNS 任播*（即根据客户端位置解析到不同的 Web 服务器 IP） - 这并不完美，但在许多情况下就足够了（例如：dnsmadeeasy、Route 53、edgedirector 和几乎所有便宜的 CDN - cloudflare、maxcdn、cloudfront 等）。还有一些解决方案可以实现真正的 BGP 任播，即通过任播（例如 cachefly）实际提供 HTTP 流量或允许您这样做（例如 hostvirtual - 不便宜）。[这](http://packetpushers.net/podcast/podcasts/show-286-busting-anycast-tcp-myths/)也可能是一个有趣的阅读。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-06T11:39:53.553

ping 它们并选择具有最低延迟的那个听起来不错，但我觉得它不会扩展（当你有 100 或 1000 时会发生什么？） - 所以也许另一种解决方案更好？有很多供应商的系统就是这样做的。DNS 任播也被广泛使用。

如果您只是对它们执行 ping，则需要对每个执行多次 ping（最好是并行执行），以确保您选择的延迟确实很低，而不是碰运气。

此外，当流量非常高时，您可能希望最终通过某种方式为它们添加权重。

最后，您需要某种方法将其中一些标记为管理性关闭（用于维护）-但也许您可以通过让您的损坏而不是广告当前不可用的那些来做到这一点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-31T07:34:22.550

ping 将不起作用。大多数客户端将位于网关和/或防火墙之后，您的 ping 数据包将无法通过。Genehack 说得最好。您需要服务器负载平衡，并且仅使用地理方法可能并不总是最好的方法。最好把钱扔给专门提供 SLB 解决方案的人。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-31T14:09:56.947

好的，所以有一些快速的想法。我是[Digital Envoy](http://www.digitalenvoy.net)的创始人——他们从事地理 IP 情报。几年前我离开了公司，但大约 6 年前，我们与[Coyote Point Systems](http://www.coyotepoint.com/)[建立了一个联合产品](http://www.networkcomputing.com/1306/1306sp2.html)，该产品正是实现了这个功能——基于地理的负载平衡。当然，有一些边缘情况（本线程中提到的台湾/中国示例）可能无法自动运行，但该产品允许用户确定一个国家的流量将流向何处。因此，如果您认为台湾最好在美国之外提供服务，那么它将被推向这种方式。

不幸的是，对该解决方案的需求并没有我们希望的那么大，而且我相信该产品已经停产。我建议[联系 Coyote Point](http://www.coyotepoint.com/contact.php)，看看他们是否可以为您提供等效的解决方案。如果没有，我认为他们会对如何去做你想做的事情有一些想法。

根据您需要提供的服务，另一种选择是使用类似 Amazon 的 CloudFront 服务。当然，如果您需要客户端连接到应用程序而不是静态文件，那将不适合您。

顺便说一句，[完全披露](http://www.linkedin.com/in/sanjayparekh)- 我不仅是 Digital Envoy 的创始人，而且我目前在 Coyote Point 的董事会任职。

# java - 在哪里放置外部罐子？

> ID：325524
> 
> 赞同：52
> 
> 时间：2008-11-28T11:17:29.747
> 
> 标签：java, eclipse, jar, eclipse-3.4, ganymede

我使用 Eclipse (3.4) 并且我的类在没有警告或错误的情况下编译。我的项目使用外部 jar 文件。

我需要把这个外部 jar 文件放在哪里，以免在`java.lang.NoClassDefFoundError`从另一个项目（不在 Eclipse 中）使用这个类时得到一个？

我可以将 jar 提取到项目文件夹中，但这感觉不对。

编辑：这个问题不是关于在 Eclipse 中导入 jar，而是在 Eclipse 之外使用它们。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-11-28T11:28:12.673

如果你想在你的 Eclipse 项目中包含一个 JAR 文件，你通常会在项目文件夹中创建一个“lib”文件夹，然后把文件放在那里。然后，您需要告诉 eclipse 将其包含在您的类路径中，以便您的代码将在 eclipse 中编译和运行。

要做到这一点：
- 进入项目的属性
- 在左侧栏中选择“Java Build Path”
- 选择窗口中心部分的“库”选项卡
- 单击“添加 JAR”按钮 - 这将为您提供您在 Eclipse 中的项目列表 - 展开您的项目并进入 lib 文件夹 - 您的 jar 将在那里。
- 选择 JAR，单击 OK，然后再次从属性窗口中单击 OK。

您的代码现在将编译并运行。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-11-28T11:23:51.810

把它放在你的`jre/lib/ext`文件夹里

关于类路径的一切都是真实的，但这是一个一致且合理的地方。

您可以通过查看 Windows 上的 JAVA_HOME 环境变量找到您的 jre 文件夹。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-28T11:20:58.150

将它放在哪里并不重要，但是您需要配置您的其他非 Eclipse 项目以将外部 jars 放在其类路径中 - 或使用扩展目录机制，如果必须的话。（这更容易，但明确表示可能更好。）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-12-24T11:12:00.217

西蒙的答案似乎是最好的，但现在有点过时了。已经用谷歌搜索了这个 Oracle 文档[Installed extensions](http://docs.oracle.com/javase/tutorial/ext/basics/install.html)。

> 从 Java 6 开始，扩展 JAR 文件也可以放置在独立于任何特定 JRE 的位置，以便系统上安装的所有 JRE 都可以共享扩展。

它说对于 Windows，您应该将扩展名放在这里 %SystemRoot%\Sun\Java\lib\ext 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-28T11:23:16.943

您只需要使用一个`-classpath`选项来引用它，该选项位于一个不包含在 Eclipse 工作区中的文件夹中，即根本不依赖于 Eclipse。

警告，如果您使用选项`java -jar`引用外部 jar ，您将无法执行其他项目（[请参阅此问题](https://stackoverflow.com/questions/250166)）`-cp`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T11:21:05.403

我把它放到一个新文件夹中。该文件夹必须包含在构建路径中。它是在 Eclipse 中还是在外部都没有关系。Eclipse 有一个特定于项目的构建路径，并将此路径传递给 javac。如果要在 Eclipse 之外执行 javac，则必须手动传递构建路径。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-28T11:32:42.087

我知道这不是您要问的，但是您考虑过使用 Maven 吗？像汇编这样的一些插件在这种情况下可能会有所帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-28T11:43:59.027

正如 James Camfield 所写，在 Eclipse 中有一个 jar。

然后，当您构建（Ant，Maven，手动）以进行分发时，确保 jar 文件包含在您的应用程序 jar 或 war 或 ear 或任何文件中或其中，并且任何启动脚本都使用 -classpath 命令行将其包含在类路径中正如 VonC 所写，java 的选项。

不要担心将 jars 粘贴在 java extensions 文件夹中，所有这些都会让您在将代码发送给第三方使用时忘记它，因为他们不会在最后设置它.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-28T14:23:56.050

创建一个共享的 lib 目录并放置这个 jar，以及您可能拥有的任何其他常见 jar 文件。如果您使用的是 Maven，那么您已经以本地 repo 的形式拥有它。

在 Eclipse 中，为此目录创建一个类路径变量，然后使用它来引用项目中的 jar 文件。如果您有多个满足这些条件的项目，它将使生活变得更加轻松。如果您从本地驱动器转到网络驱动器，它还可以轻松更改根目录的位置。

在外部应用程序中，您还将从应用程序类路径中的共享位置包含此 jar 文件。

# velocity - 你知道有多少项目使用 Velocity 框架

> ID：325537
> 
> 赞同：2
> 
> 时间：2008-11-28T11:22:32.560
> 
> 标签：velocity

你知道有多少成功的项目使用 Velocity 框架来开发他们的 UI 吗？我问的原因是在大多数情况下，Velocity 被 JSP 标签取代，但在我们的产品中，我们仍然使用 Velocity 框架。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T02:06:36.710

通常情况正好相反。人们用 Velocity 代替 JSP。（因为更好[的关注点分离](http://en.wikipedia.org/wiki/Separation_of_concerns)）使用 Velocity 的项目列表太长，无法在此处列出。我知道使用velocity 的一个大网站是[joost.com](http://www.joost.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-08T08:00:45.613

这个[由 Velocity 提供支持的 WIKI 页面](http://wiki.apache.org/velocity/PoweredByVelocity)应该让您了解以某种方式使用 Velocity 的“少数”项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-18T11:16:05.557

> 你知道有多少成功的项目使用 Velocity 框架来开发他们的 UI 吗？

至少有数百个:)。

在上面提到的*由 Velocity 提供支持的*页面上，仅列出了其中的“少数”。

> 我问的原因是在大多数情况下，Velocity 被 JSP 标签取代，但在我们的产品中，我们仍然使用 Velocity 框架。

我认为 Velocity 并没有被 JSP“取代”，但它是一种替代方案。这是一个非常好的和有效的替代方案，因为大多数用户会发现它比 JSP 更容易学习。

当然，还有其他非常好的模板引擎，但是 Velocity 似乎是目前为止语法最简单的，而且它的性能非常好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-25T04:31:11.443

我敢打赌，在企业防火墙后面使用速度进行 ui 渲染、电子邮件格式化等的网站比我们所知道的要多得多。它也嵌入在其他 apache 项目中，也可以用作非常干净的代码生成器……比使用 xslt/xpath 好得多。我的下一个项目是 jdo/stripes/velocity/gwt。

# c# - c# 检索对项目资源的引用 (VS2008)

> ID：325548
> 
> 赞同：1
> 
> 时间：2008-11-28T11:29:25.510
> 
> 标签：c#, visual-studio-2008, listview, icons

我目前有一个列表视图，我想为每个条目添加一个适当的图标。

我在项目资源中创建了一个图标并将其命名为“errorIcon.ico”。如何引用此图标/资源并在列表视图中使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T12:34:29.207

首先，您需要创建一个`ImageList`实例，请参阅[http://msdn.microsoft.com/en-us/library/system.windows.forms.imagelist.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.imagelist.aspx)（只需将其放在您的表单/用户控件上）。使用属性视图将您的图标上传到图像列表。

然后，将图像列表分配给每个 ListViewItem ( `listViewItem.ImageList = imageList`) 并设置图标索引 ( `listViewItem.ImageIndex = 0`)

请查看此处的备注以获取更多信息：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.listviewitem.imageindex.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.listviewitem.imageindex.aspx)

# c# - 控制台应用程序 - 无法捕获未处理的异常

> ID：325549
> 
> 赞同：1
> 
> 时间：2008-11-28T11:30:32.187
> 
> 标签：c#, visual-studio-2005, windows-vista, console-application, unhandled-exception

我编写了一个非常简单的 C# 控制台应用程序，它将打开一个 Crystal Report，刷新它并将其作为 PDF 保存到指定位置。

在 VS2005 中运行时一切正常；pdf文件按预期生成。当我将 .exe 复制到我的根 C: 驱动器并从命令行运行它时，我得到一个对话框，指出“CrystalGenerator 已停止工作” - 但仍会生成 pdf 文件！查找此对话框的可能原因表明发生了未处理的异常，但 Main 方法的全部内容包含在 try/catch 中，因此这不是我的问题。

查看事件日志，我看到许多条目说明“找不到插入索引 (%1) 的替换字符串”，但找不到对此含义的合理解释。

好处是，如果我将文件复制到运行 Server 2003（它打算在其中运行）的机器上，则命令运行没有错误 - 但我想知道为什么该应用程序在 Vista 上的行为异常以及如何解决它。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T12:36:55.440

如果您从提升的命令提示符（WinKey 后按 cmd 后按 Ctrl+Shift+Return）运行应用程序，它是否有效？

可能是您正在调用的进程之一需要提升。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-25T02:36:30.207

如果由于某种原因导致堆栈溢出，则无法捕获它，因为无法可靠地展开调用堆栈。

在这种情况下，您的应用程序将像您所说的那样运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T09:17:15.403

好吧，经过大量的链接追逐后，这种行为看起来是“设计使然”！

StackOverflows 自己的 Jeff Atwood 遇到了这个问题（[见这里](https://blog.codinghorror.com/console-apps-and-appdomain-currentdomain-unhandledexception/)）并在 Microsoft Connect 上提出了这个问题（[见这里](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=93671)）。

看起来我将寻找另一种方法 - 尽管代码确实适用于 Server 2003。

感谢 divo 的建议，这些建议非常有帮助。

# c++ - 对类实例的 C++ 静态成员方法调用

> ID：325555
> 
> 赞同：48
> 
> 时间：2008-11-28T11:33:44.660
> 
> 标签：c++, visual-c++, standards

这是一个小测试程序：

```
#include <iostream>

class Test
{
public:
    static void DoCrash(){ std::cout<< "TEST IT!"<< std::endl; }
};

int main()
{
    Test k;
    k.DoCrash(); // calling a static method like a member method...

    std::system("pause");

    return 0;
} 
```

在 VS2008 + SP1 (vc9) 上它编译得很好：控制台只显示“测试它！”。

据我所知，不应在实例对象上调用静态成员方法。

1.  我错了吗？从标准的角度来看，这段代码是否正确？
2.  如果它是正确的，那是为什么？我找不到为什么会被允许，或者可能是为了帮助在模板中使用“静态或非静态”方法？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-11-28T11:43:53.160

标准规定不需要通过实例调用方法，这并不意味着您不能这样做。甚至还有一个使用它的例子：

C++03、9.4 静态成员

> 可以使用限定 ID 表达式 X::s; 来引用类 X 的静态成员 s；不必使用类成员访问语法 (5.2.5) 来引用静态成员。可以使用类成员访问语法来引用静态成员，在这种情况下，对象表达式会被求值。

```
class process {
public:
   static void reschedule();
};

process& g();

void f()
{
   process::reschedule(); // OK: no object necessary             
   g().reschedule(); // g() is called
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-28T11:49:10.670

静态函数不需要实例化对象来调用，所以

```
k.DoCrash(); 
```

行为与

```
Test::DoCrash(); 
```

使用范围解析运算符 (::) 来确定类中的静态函数。

*请注意，在这两种情况下，编译器都不会将`this`指针放入堆栈，因为静态函数不需要它。*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-06-30T06:41:16.480

> 2）如果它是正确的，那是为什么？我找不到为什么会被允许，或者可能是为了帮助在模板中使用“静态或非静态”方法？

它在几种情况下可能很有用：

*   *[您建议的“模板中的“静态与否”方法”：]*当可以为模板指定许多类型，然后模板想要调用该成员时：可以使用相同的表示法调用提供静态函数的类型作为成员函数 - 前者可能更有效（没有`this`传递/绑定指针），而后者允许多态（`virtual`）分派和使用成员数据

*   最小化代码维护

    *   如果一个函数从需要特定于实例的数据演变为不需要它——因此`static`可以轻松地无实例使用并防止意外使用实例数据——现有客户端使用的所有点都不需要费力地更新

    *   如果类型改变了`var.f()`调用继续使用`var`类型的功能，而`Type::f()`可能需要手动更正

*   当您有一个表达式或函数调用返回一个值并想要调用（可能或总是）`static`函数时，该`.`符号可能会阻止您需要使用`decltype`或支持模板来访问该类型，以便您可以使用该`::`符号

*   有时变量名更短、更方便，或者以更自文档的方式命名

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-28T11:42:35.050

静态方法也可以使用类的对象来调用，就像在 Java 中一样。不过，您不应该这样做。使用范围运算符，就像`Test::DoCrash();`您可能会想到命名空间一样：

```
namespace Test {
    void DoCrash() {
        std::cout << "Crashed!!" << std::endl;
    }
}; 
```

`Test::DoCrash();`如果函数没有使用 a 显式导入`using directive/declaration`到调用者的范围内，则只能从该命名空间外部调用。

# aop - 面向方面的编程示例

> ID：325558
> 
> 赞同：51
> 
> 时间：2008-11-28T11:34:24.050
> 
> 标签：aop

*任何人都可以发布一个不*记录的面向方面编程（AOP）的示例吗？

我查看了几个资源，但所有示例都是微不足道的日志记录。它有什么用？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-11-28T12:12:55.537

直接从[Aspect Oriented Programming: Radical Research in Modularity 借来的示例之一，Youtube 视频](http://www.youtube.com/watch?v=cq7wpLI0hco)正在绘制到显示器上。在示例中，您有一个绘图程序，它由点、形状等组成，当这些对象发生更改时，您需要告诉显示器自行更新。如果不从某个方面处理它，您最终会重复自己很多次。

正如我所理解的，AOP 的创建是为了不重复自己可能与业务逻辑无关的横切关注点。使用方面，您可以将这些关注点模块化为方面。其中一个示例是记录，但您最终可能会重复许多不同的事情。从那以后它一直在发展，不再是面向方面的编程，而是面向方面的建模。

有关面向方面编程的更多信息可以从以下来源中找到：

*   读书：
    *   [维基百科 - 面向方面的编程](http://en.wikipedia.org/wiki/Aspect-oriented_programming)
*   听：
    *   [软件工程广播 - 第 106 集：AOP 简介](http://www.se-radio.net/2008/08/episode-106-introduction-to-aop/)
    *   [软件工程广播 - 第 11 集：采访 Gregor Kiczales](http://www.se-radio.net/podcast/2006-04/episode-11-interview-gregor-kiczales)
*   观看：
    *   [Google 视频 - Anurag Mendhekar：面向方面的编程（Dan Friedman 诞辰 60 周年）](http://video.google.com/videoplay?docid=1875973989673234551&ei=xW4lSeWTD4Li2gL-son3Bg)
    *   [Youtube - 面向方面的编程：模块化的激进研究](http://www.youtube.com/watch?v=cq7wpLI0hco)
    *   [Youtube - 面向方面的建模 - 它是什么以及它有什么好处](http://www.youtube.com/watch?v=tzjRr3usV6I)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-28T11:50:31.557

安全

*   注入检查权限并阻止访问的代码

更友好的 asp.net webcontrols/webparts 错误消息

*   注入捕获异常并在调试编译时写入堆栈跟踪的代码或在错误编译时写入友好消息的代码（就像这里的东西：[asp.net / MOSS2007（带代码）的透明通用异常处理](https://stackoverflow.com/questions/280412/transparent-generic-exception-handling-for-aspnet-moss2007-with-code)）

表现

*   注入设置性能计数器的代码，以了解您的应用程序慢的地方

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-28T11:51:25.017

验证：

```
[NotNull]
public string Property1 { get; set; }

[Length(Min = 10, Max = 20)]
public string Property2 { get; set; }

[Regex(Expression = @"[abc]{2}")]
public string Property3 { get; set; } 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-20T13:44:11.687

撤消 - 我正在调用支持撤消操作的第三方程序集。它要求调用者创建一个撤消上下文，调用程序集中的一些方法，然后销毁撤消上下文。上下文可以嵌套。此外，如果创建了上下文但处于需要重新启动应用程序的不良状态。

通常要使用撤消，我会写这样的东西

```
 void foo()
    {
        int id = lib.create_undo_context();
        try
        {
            lib.performsomeaction();
            lib.performsomeaction();
            lib.performsomeaction();

        }
        finally
        {
            lib.destroy_undo_context(id);
        }
    } 
```

使用 PostSharp 我定义了一个名为 [Undo] 的属性，它在方法启动时创建撤消上下文，并在方法退出时销毁它（即使抛出异常） - 所以代码看起来像这样

```
 [Undo]
    void foo()
    {
        lib.performsomeaction();
        lib.performsomeaction();
        lib.performsomeaction();
    } 
```

实现这一点比我展示的要复杂一些，因为我确保即使在存在嵌套 Undo 上下文的情况下也会清理所有 undo 上下文 - 但你明白了。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-28T20:55:53.437

另一个经典示例（如日志记录）是缓存。但其他例子更有趣。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-07-17T09:39:32.577

依赖注入

严格来说，依赖注入只不过是一个横切关注点。许多依赖注入框架使用这样的基于属性的编程风格：

```
public class Car:IDisposable
{
    [Inject]
    public IGearBox Gearbox { get; set; }
   ...
} 
```

[Inject] 属性也可以设计为不依赖于外部框架的方面。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-28T12:31:28.197

Java 和 AspectJ 中的设计模式实现（Hannemann 和 Kiczales）：[http ://www.cs.ubc.ca/labs/spl/papers/2002/oopsla02-patterns.pdf](http://www.cs.ubc.ca/labs/spl/papers/2002/oopsla02-patterns.pdf)

本文展示了如何使用 AspectJ 在 Java 中以更好的方式实现一些 GoF 设计模式

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-28T11:44:13.533

安全性 - 在执行某些方法之前检查用户是否具有适当的权限。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-28T12:55:01.660

在 Java 中不能有多重继承。但是，通过使用 AOP，您可以拥有“有限的”多重继承。尝试用谷歌搜索以查看一些示例。

我也同意 Eyvid 的观点。Hannemann 和 Kiczales 的论文非常适合学习设计模式的基础知识并获得一些很棒的 AOP 示例。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-28T11:46:45.853

公共不变检查。由于 PostSharp 1.5 会自带切面继承，即使是通过接口，也会带来很多新的机会。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-28T20:43:03.697

[我的相册](http://github.com/dustin/photo)将 aspectj 用于三件事：

1.  [将观察者“模式”实现为一段可重用的代码。](http://github.com/dustin/photo/tree/master/src/aspectj/net/spy/photo/aspects/ObservableMixin.aj)
2.  [销毁特定类型呼叫的会话。](http://github.com/dustin/photo/tree/master/src/aspectj/net/spy/photo/aspects/RestSessionDestroyAspect.aj)
3.  [发生突变时在 DTO 上设置脏标志。](http://github.com/dustin/photo/tree/master/src/aspectj/net/spy/photo/aspects/SavableModifierAspect.aj)

第一个，特别是几乎直接来自[关于 AOP 的谷歌技术演讲](http://video.google.com/videoplay?docid=8566923311315412414)。它与大多数人认为的模块化方式不同。如果您对如何永久使用它感兴趣，绝对建议您观看。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-04-08T15:32:09.460

交易管理。

在我看来，您不希望可能是事务一部分的对象知道它们在事务中。使用 AOP，您可以根据需要将对象组合成事务，而事务中的对象不需要知道它们在事务中的事实，甚至不需要知道 AOP 框架的存在。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-08-01T05:52:16.287

我使用面向方面的编程来实现关键字搜索引擎。它更像是一个实验，但它展示了 AOP 如何用于日志记录和跟踪以外的目的。

基本上：
（i）引擎的用户将他/她的类标记为 KeywordSearchable，
（ii）引擎开始跟踪这些 KeywordSearchable 实例的创建和销毁，
（iii）引擎从这些 KeywordSearchable 对象中提取关键字，
（iv）给定对象和关键字，算法负责搜索。

有关这方面的更多详细信息，请访问[http://montrealistic.blogspot.com/2011/08/aspect-orientation-implementation-of.html](http://montrealistic.blogspot.com/2011/08/aspect-oriented-implementation-of.html)。[](http://montrealistic.blogspot.com/2011/08/aspect-oriented-implementation-of.html)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-11-23T18:14:35.333

AOP 的例子：

*   算术表达式的解析器和求值器。这可以使用访问者模式进行编程，但我相信方面是更好的选择。
*   一个简单的文本编辑器，其中一些管理任务（例如，维护“文件已更改”标志和窗口标题）被视为单独的方面。
*   一种字符串的数据结构，其中字符串表示为树，因此可以在不复制的情况下实现连接和子字符串选择。为了保持效率，树有时需要重新平衡；平衡代码被视为一个方面。

假设您想在域模型的方法中记录一条消息：

示例：没有 AOP 的日志记录：

```
namespace Examples\Forum\Domain\Model;

class Forum {

    /**
     * @Flow\Inject
     * @var \Examples\Forum\Logger\ApplicationLoggerInterface
     */
    protected $applicationLogger;

    /**
     * Delete a forum post and log operation
     *
     * @param \Examples\Forum\Domain\Model\Post $post
     * @return void
     */
    public function deletePost(Post $post) {
            $this->applicationLogger->log('Removing post ' . $post->getTitle(), LOG_INFO);
            $this->posts->remove($post);
    }

} 
```

如果您必须在很多地方执行此操作，那么日志记录将成为您域模型逻辑的一部分。您必须在模型中注入所有日志记录依赖项。由于日志不是领域模型应该关心的，因此这是一个非功能性需求和所谓的横切关注点的示例。

使用 AOP，模型中的代码对日志一无所知。它将只专注于业务逻辑。

# database - 使用 psql 运行更新

> ID：325559
> 
> 赞同：0
> 
> 时间：2008-11-28T11:34:32.600
> 
> 标签：database, postgresql

我有一个包含两列的表是一个唯一键，我无法更改架构。

我正在尝试使用 psql 执行更新，其中我更改了关键列之一的值。该脚本类似于以下内容：

```
BEGIN;
UPDATE t1 SET P1='23' where P1='33';
UPDATE t1 SET P1='23' where P1='55';
COMMIT; 
```

将 psql 与命令一起使用：

```
psql -U user -f file 
```

我有错误

```
ERROR: duplicate key violates unique constraint "<key_name>" 
```

但是该列与另一列处于键中，并且更改它不会“破坏”任何唯一约束。**pgAdmin3 中的相同查询运行良好，没有错误**。

我不是 dba，在我看来，我遗漏了一些明显的东西。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-28T19:20:38.200

您可以在 psql 中键入以下内容并将输出添加到您的问题中吗？

```
\d schema.table 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T08:13:03.210

这是输出：

```
 Tabella "public.partitaiva"

    Colonna     |          Tipo          | Modificatori

----------------+------------------------+--------------

 id             | bigint                 | not null

 idnazione      | bigint                 | not null

 partitaiva     | character varying(20)  | not null

 logicaldelete  | boolean                |

 prevego        | bigint                 |

 nextego        | bigint                 | not null

 lastmodified   | bigint                 |

 creationuser   | character varying(255) |

 creationtime   | bigint                 |

 lastmodifyuser | character varying(255) |

 version        | bigint                 |

Indici:

    "partitaiva_pkey" PRIMARY KEY, btree (id)

    "partitaiva_idnazione_key" UNIQUE, btree (idnazione, partitaiva, nextego)

Vincoli di integrità referenziale

    "fk2659231b8f0d2c9" FOREIGN KEY (idnazione) REFERENCES nazione(id) 
```

idnazione 和 partitaiva 两列是键（与 nextego 一起，但始终等于 -1）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T14:14:04.260

真正的更新声明是：

```
BEGIN;

UPDATE partitaiva SET partitaiva='02469480244' WHERE partitaiva='80911556878';
UPDATE partitaiva SET partitaiva='02469480244' WHERE partitaiva='75545502025';
UPDATE partitaiva SET partitaiva='02469480244' WHERE partitaiva='11056297226';

COMMIT; 
```

每一行中的“idnazione”列都不同，更重要的是，pgAdmin3 中的相同语句运行良好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T20:43:51.807

嗯，如果你：

```
select idnazione, nextego 
from partitaiva 
where partitaiva='02469480244' 
order by idnazione, nextego; 
```

你没有得到任何重复的行？

你在做什么

```
BEGIN;
...
COMMIT; 
```

也使用 pgadmin 时？

# c# - Passing interface as a parameter to an extension method

> ID：325561
> 
> 赞同：4
> 
> 时间：2008-11-28T11:36:48.820
> 
> 标签：c#, asp.net-mvc, extension-methods, interface

I have used extension methods to extend html helpers to make an RSS repeater:

```
 public static string RSSRepeater(this HtmlHelper html, IEnumerable<IRSSable> rss)
    {
        string result="";

        foreach (IRSSable item in rss)
        {
            result += "<item>" + item.GetRSSItem().InnerXml + "</item>";
        }

        return result;
    } 
```

So I make one of my business objects implement IRSSable, and try to pass this to the HTML helper. But I just cannot seem to make it work, I have tried:

```
<%=Html.RSSRepeater(ViewData.Model.GetIssues(null, null, "") as IEnumerable<IRSSable>) %> 
```

Compiles fine, but null is passed

```
<%=Html.RSSRepeater(ViewData.Model.GetIssues(null, null, "")) %> 
```

Intellisense moans about not being able to pass IEnumerable issue to IEnumberable IRSSable

*   So how do you do it? That method I am calling definitly returns `IEnumberable<Issue>` and Issue definitly implements IRSSAble

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-28T11:42:13.523

Ahh... try:

```
 public static string RSSRepeater<T>(this HtmlHelper html, IEnumerable<T> rss)
     where T : IRSSable
 {
     ...
 } 
```

This then should allow you to pass any sequence of things that implement `IRSSable` - and the generic type inference should mean you don't need to specify the `T` (as `Issue`) yourself - the compiler will handle it.

By the way - [avoid concatenation here](http://www.yoda.arachsys.com/csharp/stringbuilder.html); `StringBuilder` is preferable:

```
 StringBuilder result = new StringBuilder();

    foreach (IRSSable item in rss)
    {
        result.Append("<item>").Append(item.GetRSSItem().InnerXml).Append("</item>");
    }

    return result.ToString(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-28T11:41:14.617

You're running into [generic variance issues](https://stackoverflow.com/questions/229656). Just because something implements `IEnumerable<Issue>` doesn't mean it implements `IEnumerable<IRssable>`. (It will in C# 4, but I'm assuming you're not using that :)

You could make your extension method take just `IEnumerable` and call `IEnumerable.Cast<IRssable>` on it though - that's probably the simplest approach.

EDIT: [Marc's suggestion](https://stackoverflow.com/questions/325561/passing-interface-as-a-parameter-to-an-extension-method#325568) is probably the better one, but I'll leave this answer here as it explains what's going on rather than just the fix :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T11:43:37.187

Try this:

```
<%=Html.RSSRepeater(ViewData.Model.GetIssues(null, null, "").Cast<IRSSable>()) %> 
```

# linux - Linux 文件系统基准测试最佳实践

> ID：325565
> 
> 赞同：4
> 
> 时间：2008-11-28T11:39:42.480
> 
> 标签：linux, filesystems, benchmarking, ext3

（不是真正的编程问题，抱歉）

我正在针对 Linux 机器上的特定情况使用各种文件系统选项（例如：noatime、relatime 等）对各种文件系统（最重要的是：ext3）进行基准测试。

对于原始文件系统基准，我正在研究 bonnie 和 bonnie++。

使用 bonnie 和 bonnie++ 对文件系统进行基准测试最有用的方法是什么？
关于文件系统基准测试的最佳实践是什么？
当我们在这里的时候：你如何在你的机器上挂载你的 ext3 文件系统？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T11:31:32.973

我没有得到很多答案;-)所以我会尝试解释我的想法是什么。

最终，我选择了 iozone 作为基准测试工具，主要是因为它提供的信息量巨大。

恕我直言，如果试图找到具有统计意义的数据，运行一次基准测试是不够的，所以我编写了一个小 shell 脚本来运行 iozone 10 次并将输出写入 10 个日志文件。

然后，我编写了另一个脚本（这个在 Python 中）来将矩阵中每个单元格的所有值相加。丢弃每个单元格的最高和最低值，以防止异常扭曲现实；-)

对于每个单元格，我取其余八个值的平均值。我将生成的矩阵复制到 OpenOffice.org Calc 中。

我为“基线”（在我的情况下：使用默认选项安装的 ext3 文件系统）执行了此过程，然后为我的测试重复了它。

每次测试，我将结果矩阵复制到存储基线的电子表格中。在 Calc 中，我进行了比较并将结果绘制在图表中。

效果很好。

# php - 用于 Java 服务器组件的 JSP 或 PHP？

> ID：325575
> 
> 赞同：0
> 
> 时间：2008-11-28T11:45:54.623
> 
> 标签：php, jsp

我必须为一些用 Java 编写并由 Tomcat 托管的服务器组件选择一种服务器页面技术，例如 Lucene 搜索服务和一个 flex BlazeDS 图形组件。

不确定是使用 JSP 还是 PHP。

一方面，JSP 可以轻松地与组件 Java API 集成，而 PHP 将需要另一种集成方式，例如 XML 或可能引入性能开销的桥接器。

另一方面，PHP 似乎开发得更快，而且不确定，但最近使用和支持得更多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T12:01:01.380

JSP 在这种情况下一路走来。首先，您可以从无数不同的框架中进行选择——Struts 和 Tiles、Spring、Hibernate 等，以帮助开发。

其次，发展速度并没有那么慢，如果有的话。此外，许多框架强制执行体面的 MVC 编码实践。

但是，考虑到这些框架，我现在不建议编写纯 servlet 和 JSP 代码，除非您编写的代码非常具体。

其他替代方案可能是研究 JRuby 或 JPython 以在 Ruby 或 Python 中进行开发——尽管我不知道这有多容易，因为我自己没有做过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T11:52:28.947

鉴于您的情况，我会选择 JSP。

PHP 应用程序的开发速度可能会稍微快一些，但前提是您不习惯 Java。集成用 Java 编写的现有组件，很容易与 JSP 集成。

如果您正在寻找廉价的低要求托管，则 Web 托管公司更多地支持 PHP。JSP 被广泛支持用于专用托管。每个适当的 linux/unix 发行版都可以开箱即用地使用 Java+Tomcat。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T11:55:43.370

JSP 被广泛使用和支持。

Google for *JSP Tag library*查看可用的第 3 方支持的数量。

# php - 使用 PHP 和 pop3 检索电子邮件 - 你的技术是什么？

> ID：325579
> 
> 赞同：2
> 
> 时间：2008-11-28T11:47:42.700
> 
> 标签：php, pop3

我可以看到一些可用的选项：

1) 使用 PEAR 的 POP3 类 --> 试过了，有一些奇怪的奇怪问题，比如 FF 在他们的示例代码中窒息而死！！！

2）使用PHPClasses（[在这里](http://www.phpclasses.org/)）->当时似乎是可行的选择，仍在努力

3）写我自己的或使用可用的片段之一

目标目前是 Gmail，但我希望它也能在我的 ISP 邮件上工作（当然不一定是相同的代码）。

你用什么？指向工作片段的指针将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-28T12:15:59.820

原生 PHP IMAP 函数支持 POP3 邮箱，并且可能比纯粹用 PHP 编写的任何东西都要快。PHP 手册中通常有一些有用的注释和示例，例如在[imap_open](http://uk3.php.net/imap_open)页面上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T12:04:50.403

我使用 PHPClasses 版本。对我来说效果很好 - 我一直在开发 AJAX 邮件客户端（个人项目，真的是学习练习）。我还发现他们提供的示例代码非常好，因此您应该可以使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-12T05:58:13.840

我刚刚发现了[ezcomponents](http://ezcomponents.org)。真的很高兴与之合作。

# vb6 - 在 vb6 中填充组合框时出现运行时错误 0

> ID：325583
> 
> 赞同：1
> 
> 时间：2008-11-28T11:50:49.463
> 
> 标签：vb6

特定于特定机器的奇怪错误...

我有一个应用程序，其中组合框的文本值设置为文档的路径（即..

```
cmbAIDFile.Text = clsTonyToolkit.GetSetting("ExportAIDFile",gtypmetadata.gcnnCentral) & "" 
```

忘记所有的 GetSetting 过程等，只是它返回一行文本并且工作正常。

这适用于除一台以外的所有机器。这台特定的 Vista 机器抛出错误 Run-time error 0 并将用户抛出程序，而不管过程中的 ErrorHandling 是什么。其他 Vista 机器工作正常。

我们将不胜感激地收到对这个令人困惑的问题的任何答案。

* * *

谢谢你的帮助。

机器运行 Vista Business 64 位。

用户可以通过打开的用户帐户控制获得管理员权限。

按照您的提示，我尝试以管理员身份运行该应用程序并得到各种奇怪的响应（缺少文件、未注册的依赖项等）。已卸载该应用程序并将尝试重新安装。我认为文件夹的卷影副本也可能令人困惑。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-30T06:53:23.840

您可能在错误的地方寻找错误。当您更改`Text`a 的属性时`ComboBox`，如果新文本与以前的文本不同，则会触发`ComboBox`'事件。`Change`和`LostFocus`/或`Validate`事件也可能触发，这取决于您的代码在做什么以及您的表单是如何设置的。

如果在事件处理程序中发生错误`Change`（或在`LostFocus`或`Validate`事件处理程序中，如果您对它们执行任何操作），则更改组合框文本的代码中的错误处理代码将**永远不会**被调用（这与错误的发生方式有关-处理和事件在 VB6 中工作）。

**作为一般规则，您应该始终在 VB6 代码中的每个例程（Sub、Function 或 Property）中放置一个错误处理程序，因为否则您永远无法确定是否会捕获每个错误。**

这是一个简单的示例，它演示了错误处理可能并不总是像您认为的那样在 VB6 中起作用。

*新建一个Standard EXE项目，在默认窗体中添加一个CommandButton（Command1）和一个ComboBox（Combo1），在窗体中添加如下代码：*

```
Private Sub Combo1_Change()

   Dim a As Long
   a = 1/0 '<-- this will cause a divide-by-zero runtime error'

End Sub

Private Sub Command1_Click()

    On Error GoTo MyErrorHandler

    'Change the combobox text.'
    'This will cause the Change event to fire' 

    Combo1.Text = "test"

    Exit Sub

MyErrorHandler:
    'This code will not be executed if an error occurs in Combo1_Change...'
    MsgBox "My error-handler called."

End Sub 
```

如果您编译该项目并运行生成的 EXE，则每当您单击 Command1 时都会出现运行时错误，并且程序将终止。这是因为添加的错误处理代码（`MyErrorHandler`在示例中）没有被调用。但是，如果您将错误处理代码添加到`Combo1_Change`事件处理程序，您可以捕获错误并尝试处理它（至少，您可以防止程序崩溃）。

因此，我会确保每个事件过程中都有错误处理代码，如果它丢失了就添加它。这应该可以更容易地查明错误实际发生的位置。例如，如果您在`cmbAIDFile_Change`事件过程中有代码，请确保它具有错误处理功能。我也会在您的代码中添加行号（如果您还没有）：这样您就可以`Erl`在错误处理代码中使用来获取发生错误的实际行号。有关如何在错误消息中记录行号的示例，请参见以下代码。

**使用 Erl 报告错误消息中的行号**

```
Private Sub cmbAIDFile_Change()

1000   On Error Goto ErrorHandler

1010   DoSomething
1020   DoSomethingElse

ErrorHandler:

1030   Dim sErrMsg As String
       sErrMsg = "A fatal error occurred." & vbCrLf & vbCrLf  & _
                 "Method: cmbAIDFile_Change" & vbCrLf & _
                 "Line: " & Erl & vbCrLf & _ 
                 "Err.Number: " & Err.Number & vbCrLf & _
                 "Err.Description: " & Err.Description

1040   MsgBox sErrMsg, vbCritical+vbOKOnly, "Fatal error"

End Sub 
```

一旦你有了更细粒度的错误处理，你就可以开始调查为什么只在一台机器上看到问题，因为你应该有关于正在发生的错误的更可靠的信息，并且处于更好的状态。位置来确定根本原因是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T13:16:19.993

Mike Spears 的建议是正确的，因为您需要将错误处理程序放入所有事件中，因为将字符串分配给组合框的文本会导致许多事件触发。

我的贡献是尝试以下。

```
Dim TempS as String
TempS = clsTonyToolkit.GetSetting("ExportAIDFile",gtypmetadata.gcnnCentral) & ""
cmbAIDFile.Text = TempS 
```

Unicode 可能会发生一些奇怪的事情。这在其他正常分配上由错误 0“无效的过程调用或参数”指示。同样，如果您有 cmbAIDfile 的事件过程，那么您需要捕获它们，以便您可以查看那里是否发生错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T11:56:27.783

vista机器有什么区别？

*   版本
*   设置
*   用户权限

Al 会影响应用程序的工作方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-17T04:15:27.417

**使用这些代码**

```
Private Sub Command1_Click()
    On Error Resume Next
        'Your combo-box code here
    On Error GoTo 0
End Sub 
```

# mysql - mysql的集成身份验证

> ID：325587
> 
> 赞同：3
> 
> 时间：2008-11-28T11:52:22.130
> 
> 标签：mysql, database, linux, security

在 Windows 上使用 MSSQL 时，我习惯了一个非常方便的功能，称为集成身份验证。简而言之，在 Windows 中进行身份验证可以让您访问数据库，因此无需提供任何特定密码。现在我正在 Linux 上开发一个没有用户交互的应用程序；这个应用程序出于自己的目的需要访问一个mysql数据库，那么我该如何让它登录呢？我发现即使默认在mysql中创建了一个root帐户，这个root帐户与unix root没有任何联系，即使我不是Linux中的超级用户，我也可以使用它，并且密码为空。当然，我可以在 mysql 中为我的应用程序的需要创建一个专用的用户帐户，但在这种情况下，我需要在某处硬编码密码，这不太好。再一次 - 我的应用程序中没有用户交互，所以没有机会有人输入密码。我有一种明显的感觉，我在这里遗漏了一些重要的东西。感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T11:58:55.703

首先，你真的应该在 mysql root 帐户上设置一个密码......

其次，是的，您几乎必须将密码放在某个地方，除非您将应用程序帐户设置为也使用空白密码......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T12:18:41.267

您可以将设置放在 .my.cnf 文件中：

```
[Client]
user=ken
password=ken
host=localhost
database=foo 
```

您可以使用 --defaults-file 选项使用不同的配置文件

[dev.mysql.com](http://dev.mysql.com/doc/refman/5.0/en/option-files.html)上有关选项文件的更多信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T12:20:16.520

您可以对密码进行硬编码，正如您所说，这并不是特别好。例如在 PHP 中：

```
 $connection = mysql_connect('HOSTNAME', 'USERNAME', 'PASSWORD')
   or die('Could not connect: ' . mysql_error());

 mysql_select_db('DATABASE') or die('Could not select database'); 
```

或者，您可以从配置文件中加载密码，在这种情况下，您可以将其以加密形式存储，但如果有人可以看到您的源代码并看到您如何解密它，他们也可以解密它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-12T08:52:09.257

快进十年，您现在可以使用身份验证套接字登录：

```
CREATE USER 'user'@'localhost' IDENTIFIED WITH auth_socket; 
```

从控制台，您可以通过以下方式直接登录，无需密码：

```
mysql -u user 
```

不太确定在这种情况下您将如何处理来自其他应用程序的连接字符串，我仍在寻找自己...

此方法仅适用于本地连接，不适用于 TCP/IP 连接。请参阅 MySQL 手册[第 11 章：启用身份验证](https://dev.mysql.com/doc/mysql-secure-deployment-guide/5.7/en/secure-deployment-configure-authentication.html)。

# java - 我在 Java 中的撤消功能方面需要一些帮助

> ID：325590
> 
> 赞同：0
> 
> 时间：2008-11-28T11:53:46.073
> 
> 标签：java, class, function, stack, undo

我用 Java 写了一个文本编辑器，我想给它添加 Undo 功能

但是没有 UndoManager 类，我需要使用 Stack 或 LinkedList 之类的数据结构，但 Java 中的 Stack 类使用 Object 参数，例如： push(Object o) ， Not Push(String s) 我需要一些提示或链接。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-28T11:56:54.477

假设您使用的是 Java 5，Stack 是一个泛型类。你可以根据它应该持有的对象来实例化它。

然后你可以使用：

```
Stack<String> stack = new Stack<String>();
String string = "someString";
stack.push(string); 
```

另请注意，在您使用 Java 1.4 或更低版本的情况下，您仍然可以将 String 对象推送到堆栈中。只有当您将它们 pop() 出来时，您需要显式地向下转换它们，如下所示：

```
Stack stack = new Stack();
String string = "someString";
stack.push(string);

String popString = (String) stack.pop(); // pop() returns an Object which needs to be downcasted 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T11:59:23.910

实际上是一种模式的“数据结构”称为[Memento](http://en.wikipedia.org/wiki/Memento_pattern)。当您需要存储多个状态并可以选择返回到以前的状态时，它会很有帮助。对于状态的有效数据存储取决于您正在使用哪种文本编辑器，如果可以进行一些格式化，请查看[Flyweight](http://en.wikipedia.org/wiki/Flyweight_pattern)模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T12:02:56.773

嗯……

对我来说似乎有点像 RTFM 的情况 ;-)

如果您使用的是 Java 1.4.2，则只需在从堆栈中获取对象时显式[转换对象即可：](http://www.javabeginner.com/java-object-type-casting.htm)

```
Command cmd = (Command) stack.pop(); // same for peek() etc. 
```

如果您使用的是 Java 1.5，请使用[泛型](http://java.sun.com/j2se/1.5.0/docs/guide/language/generics.html)，并且不需要显式转换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T12:34:25.133

好的，我解决了

我必须按 textArea 中的文本而不是键盘上的字符

多谢你们

# java - Java 中最好的可调整大小的循环字节缓冲区是什么？

> ID：325602
> 
> 赞同：20
> 
> 时间：2008-11-28T12:00:21.160
> 
> 标签：java, buffer, byte

我需要一个 Java 中的字节缓冲区类以供单线程使用。我应该能够在缓冲区的后面插入数据并在前面读取数据，摊销成本为 O(1)。缓冲区满时应该调整大小，而不是抛出异常或其他东西。

我可以自己写一个，但是如果标准 Java 包中还不存在它，我会感到非常惊讶，如果它不存在，我希望它存在于一些经过良好测试的公共库中。

你会推荐什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-28T12:07:00.803

不确定它是否是“最好的”，但你有一个很好的[循环字节缓冲区示例here](http://ostermiller.org/utils/CircularBuffer.html)。

那些[Java Utilities-OstermillerUtils](http://ostermiller.org/utils/) 类在[GPL 许可](http://ostermiller.org/utils/licenseFAQ.html)下。

> 这个循环字节缓冲区实现了字节的循环缓冲区生产者/消费者模型。使用标准 Java InputStreams 和 OutputStreams 填充和清空缓冲区。
> 
> 使用此类是使用 PipedInputStream 和 PipedOutputStream 的更简单的替代方法。
> PipedInputStreams 和 PipedOutputStreams 不支持标记操作，不允许您控制它们使用的缓冲区大小，并且具有更复杂的 API，需要实例化两个类并连接它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-09T16:13:17.587

我想知道这个是否运作良好

[https://svn.apache.org/repos/asf/etch/releases/release-1.0.0/util/src/main/java/etch/util/CircularByteBuffer.java](https://svn.apache.org/repos/asf/etch/releases/release-1.0.0/util/src/main/java/etch/util/CircularByteBuffer.java)

我们可能会尝试这个，因为它是 apache 许可证。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-25T17:50:47.787

我`java.util.ArrayDeque<Byte>`在具有类似要求的项目中使用 a 。请注意，您可以使用 java.util.concurrent 实现轻松更改`Queue` 实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-03T20:41:45.947

我写过这样一个类： [ByteRingBuffer](http://www.source-code.biz/snippets/java/ByteRingBuffer/)

它不会自动调整大小，但有一个 resize() 方法。

它通过自动测试程序“经过充分测试”，使用随机数来测试所有可能的情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-13T20:11:41.823

另一种解决方案是使用JBoss 的[GrowablePipedOutputStream](http://www.jboss.org/jbossremoting/docs/api/org/jboss/remoting/transport/multiplex/utility/GrowablePipedOutputStream.html)和[GrowablePipedInputStream](http://www.jboss.org/jbossremoting/docs/api/org/jboss/remoting/transport/multiplex/utility/GrowablePipedInputStream.html)。

# java - value 和 itemvalue 的区别

> ID：325616
> 
> 赞同：10
> 
> 时间：2008-11-28T12:10:07.303
> 
> 标签：java, html, jsp, jsf

Jsf中单选按钮的value和itemValue属性有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-25T14:28:21.330

该值旨在发送 SelectItem 对象，而不是像 itemValue 那样的字符串。itemValue 是项目值，它作为请求参数传递给服务器，但该值是指向 SelectItem 实例的值绑定表达式。

如果您查看此 JSF：

```
 <h:selectOneRadio value="">
    <f:selectItem itemValue="TestValue" itemLabel="TestLabel" />
</h:selectOneRadio> 
```

这变成了这个HTML：

```
<table>
    <tr>
    <td>
        <input type="radio" name="j_id_id9" id="j_id_id9:0" value="TestValue" />
        <label for="j_id_id9:0"> TestLabel</label>
    </td>
    </tr>
</table> 
```

因此 value = valueBinding 指向托管 bean 中的 SelectItem，而 itemValue = 正在提交的值。如果您决定添加 value="#{TestBean.mySelectItem}" 它不会以任何方式更改输出的 HTML，但 JSF 实现会知道 mySelectItem 字段的 getter 属性应该用于此。

**编辑：**进一步澄清答案。SelectItem 的 value 属性通过 getter 和 setter 属性将 SelectItem 绑定到托管 bean 中的 SelectItem 字段。如果你这样设置值：

```
 <h:selectOneRadio value="">
    <f:selectItem itemValue="TestValue" itemLabel="TestLabel" value="#{TestBean.mySelect}"/>
</h:selectOneRadio> 
```

它将调用 TestBean 中的 getMySelectItem() 方法。如您所见，这与 itemValue 无关，因为 itemValue 负责设置用户提交表单时请求中内容的值。itemValue 然后将存储在 h:selectOneRadio 的值中，希望您已经绑定到这样的字符串字段：

```
<h:selectOneRadio value="#{TestBean.selectedRadioValue}">
<f:selectItem itemValue="1" itemLabel="1\. radio one" />
<f:selectItem itemValue="2" itemLabel="2\. radio two" />
</h:selectOneRadio> 
```

现在，如果用户检查对他来说看起来像这样的收音机：“ *1\. radio one* ”，则值“1”将存储在 TestBean 的名为 selectedRadioValue 的变量中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T12:20:32.183

来自这篇 IBM 文章[使用单选按钮向 JSF 数据表添加行选择](http://www.ibm.com/developerworks/rational/library/05/1213_he/)：

**属性 id**用于单选按钮组的组件值。它将绑定到 Value 字段

![属性id](https://i.stack.imgur.com/QxTc0.jpg)

属性 selectedRowId 用于单选按钮的**项目值**，将绑定到项目值字段

![项目价值](https://i.stack.imgur.com/lbkjf.jpg)

# open-source - 你知道任何开源免费的想法/建议管理工具吗？

> ID：325623
> 
> 赞同：4
> 
> 时间：2008-11-28T12:16:08.370
> 
> 标签：open-source

在这家“小”公司中，我将自己包括在一群思想家中。为了从我的开发团队成员那里收集建议和改进想法，我负责安装一个想法/建议管理系统。

一些令人愉快的功能是：

*   提供基于用户（可能匿名）的建议机制
*   提供对建议的投票机制
*   （可选）记录为实施建议而采取的行动的机制

您是否使用或知道任何此类工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-04-11T17:05:53.520

查看以下链接

*   www.ideatorrent.org/
*   www.osqa.net/gallery/
*   code.google.com/p/stacked/downloads/list
*   Alternativeto.net/software/google-moderator/
*   www.google.com/moderator/

顺便说一句，我正在考虑使用 JIRA 来跟踪这个想法，有什么建议吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T10:23:28.913

试试[Pligg](http://www.pligg.com/)，它就像你可以用来添加新的想法投票和讨论一样挖掘

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-28T12:33:33.530

查看[uservoice.com](https://www.uservoice.com/)。

Stackoverflow 使用它。自己试试吧。

[http://stackoverflow.uservoice.com](https://web.archive.org/web/20090219112537/http://stackoverflow.uservoice.com:80/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T10:19:40.733

你考虑过像 Kluster 这样的东西吗？[http://www.kluster.com/](http://www.kluster.com/) 它有一个很棒的界面，适合对想法进行评级。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-28T12:33:07.133

也许是使用[VotePlugin](http://trac-hacks.org/wiki/VotePlugin)或[FiveStarVotePlugin的](http://trac-hacks.org/wiki/FiveStarVotePlugin)[Trac](http://trac.edgewall.org/)实例？用户可以提交票作为他们的建议，然后使用投票系统。如果您正确配置，Trac 也可以满足您的日志记录要求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-22T21:27:27.983

我一直在使用许多不同的软件来捕捉想法、用户声音、获得满意度等……你试过[http://hunchbuzz.com/idea-management-software-tools/free/](http://hunchbuzz.com/idea-management-software-tools/free/)吗？

# algorithm - 尝试算法的媒介？

> ID：325627
> 
> 赞同：2
> 
> 时间：2008-11-28T12:17:16.010
> 
> 标签：algorithm, excel, simulation, specifications

根据定义，算法独立于它们运行的​​介质。例如，在用编程语言实现算法之前，我使用 Excel 表来玩数据结构并做一些移动/洗牌/标记实验。

您使用什么工具和技术来设计和模拟算法的功能？你如何使用绘图程序？一种特殊的规范语言？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-28T12:28:51.167

我通常在纸上画出草图，然后尝试在 Common Lisp 中快速实现并在 REPL 上进行测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T13:06:02.450

算法是独立于语言的，真的。但是你使用的任何媒介都是一种语言，句号。使用 Excel 意味着您正在使用 excel“语言”（行、列、单元格等）来表达您的一些算法。也许不是完整的成品，但您已经在 Excel 中表达了它。

UML 图是一种表达算法的语言。纸上的草图是一种表达语言。很难将柏拉图式的理想算法与所有具体表示区分开来。无论你做什么，你都是在用某种语言表达它。

诀窍是将算法与特定的语言特征和限制分开。

任何“非正式”符号都将有助于做到这一点。英语（或其他自然语言）、数学、图表等都是用没有实现怪癖和问题的语言表达算法的候选者。

我从英语的概述开始。纯文本，甚至不是 MS-Word 或格式会分散注意力的东西。

对于真正复杂的事情，一些补充数学有助于围绕程序的状态提出正式的断言。

此外，UML 图也有帮助。我使用[Argo UML——既](http://argouml.tigris.org/)便宜又有效。

有关此主题的更多信息，您想了解[形式验证](http://en.wikipedia.org/wiki/Formal_verification)系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-28T12:23:34.140

我不使用这样的工具，但在用 Java 实现它之前，我通常会在高级脚本语言（如 groovy）中粗略地编写算法。

我发现使用更高级别的脚本语言，您不必太担心语言，您可以更专注于算法。然后，当您证明了该算法时，您可以将其移植为限制性更强的语言。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-28T12:55:09.600

我通常使用白板（我有一个在工作，两个在家里）来勾勒粗略的算法，并尝试一个非常小的问题实例。如果我需要编写代码，我会用 Python 编写一个原型。

我通常只在需要编写正式的规范文档时才使用绘图程序。这些通常显示比算法更高级别的设计，例如将 Visio 用于 UML 图。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T12:22:41.180

我想这取决于算法的复杂性。

很多时候，我实际上会在一些纸上画一个流程图的草图。有一些优秀的图表工具可用，但我仍然没有找到一个像在一张纸上画出一个好的老式草图一样快的工具。

除此之外，我经常在 VB.NET Windows 窗体或控制台应用程序中拼凑出一个真正“快速而肮脏”的算法模型。借助 LINQ-to-SQL 等一些较新的功能，您甚至可以在很短的时间内将依赖于数据库访问的原型放在一起。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T18:25:08.967

> 根据定义，算法独立于它们运行的​​介质。

那是什么定义？是谁做的？他们知道[泄漏抽象](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)吗？

好的算法必须经常了解他们正在使用的平台。如果不是这样，程序将自动为 GPU 并行化，并且可以毫不费力地重写以在量子计算机上工作。

也就是说，许多基本算法确实与平台无关。奇怪的是，我实际上觉得使用 C++ 来摆弄算法是最舒服的。但是，在执行此操作时，我严重依赖高级抽象，因此我不会使用指针或类似的东西。另一方面，STL 实际上提供了一个非常丰富的工具包来玩弄算法。

而且，和比尔一样，我也经常使用我的白板。我的客厅里实际上有一块 1m * 2m 的白板。爬行。;-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-28T18:54:59.530

我通常用 Python 破解一些实现算法的东西。我将完全忽略任何合理的编码准则——例如，我不会创建类来存储我的数据，但我只会创建越来越大的元组来包含我的所有信息并表示一个“对象”。这只是为了尽快获得算法的工作版本。一旦我理解了它，我将用目标语言以更理智的方式实现它。

# linux - 使用锁定文件避免两个脚本实例同时运行时如何避免竞争条件？

> ID：325628
> 
> 赞同：18
> 
> 时间：2008-11-28T12:17:18.287
> 
> 标签：linux, bash, shell, locking, mutex

避免同一脚本的两个实例同时运行的典型方法如下所示：

```
[ -f ".lock" ] && exit 1
touch .lock
# do something
rm .lock 
```

有没有更好的方法来锁定来自 shell 脚本的文件，避免竞争条件？必须改用目录吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-11-28T12:23:32.037

是的，示例脚本中确实存在竞争条件。您可以使用 bash 的`noclobber`选项来在比赛中失败，当不同的脚本潜入`-f`测试和`touch`.

以下是说明该机制的示例代码片段（受[本文启发）：](https://www.davidpashley.com/articles/writing-robust-shell-scripts.html)

```
if (set -o noclobber; echo "$$" > "$lockfile") 2> /dev/null; 
then
   # This will cause the lock-file to be deleted in case of a
   # premature exit.
   trap 'rm -f "$lockfile"; exit $?' INT TERM EXIT

   # Critical Section: Here you'd place the code/commands you want
   # to be protected (i.e., not run in multiple processes at once).

   rm -f "$lockfile"
   trap - INT TERM EXIT
else
   echo "Failed to acquire lock-file: $lockfile." 
   echo "Held by process $(cat $lockfile)."
fi 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-10-15T11:14:12.257

尝试群命令：

```
exec 200>"$LOCK_FILE"
flock -e -n 200 || exit 1 
```

如果锁定文件被锁定，它将退出。它是原子的，可以在最新版本的 NFS 上运行。

我做了一个测试。我创建了一个包含 0 的计数器文件，并在两台服务器上同时循环执行以下 500 次：

```
#!/bin/bash

exec 200>/nfs/mount/testlock
flock -e 200

NO=`cat /nfs/mount/counter`
echo "$NO"
let NO=NO+1
echo "$NO" > /nfs/mount/counter 
```

一个节点正在与另一个节点争夺锁。当两次运行完成时，文件内容为 1000。我尝试了多次，它总是有效！

注意：NFS 客户端是 RHEL 5.2，使用的服务器是 NetApp。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-03-06T09:13:05.353

锁定您的脚本（防止并行运行）

[http://wiki.bash-hackers.org/howto/mutex](http://wiki.bash-hackers.org/howto/mutex)

供参考。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-10T18:12:25.983

创建一个目录是原子的，如果你不使用它已经存在就会失败`-p`，所以

```
 mkdir $lockName || exit 1 
```

作品。

...但`flock`改为使用。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-28T12:28:34.693

似乎我找到了一个更简单的解决方案： man lockfile

# com - 我如何可靠地判断两个 Inspector 引用指向同一个 Inspector 实例？

> ID：325629
> 
> 赞同：1
> 
> 时间：2008-11-28T12:17:20.190
> 
> 标签：com, outlook, identity, outlook-object-model

[继续从[有没有办法判断两个 COM 接口引用是否指向同一个实例？](https://stackoverflow.com/questions/323289)]

我有`Inspector`来自两个不同来源的对象的引用，并且需要能够区分来自一个来源的哪个项目对应于来自另一个来源的哪个项目。但是，到目前为止，我想出的方法都没有（可靠）：

*   我不能简单地[比较`IUnknown`接口](https://stackoverflow.com/questions/323289)，因为该`Inspectors.Item()`方法似乎返回了对动态创建的代理对象的引用，而不是检查器实例本身。试试看：两次访问同一个索引将返回两个截然不同的指针。

*   比较`Inspector.CurrentItem.EntryID`也不好。新的/未保存的项目`EntryID`始终为空白，一次可能有多个未保存的项目打开。

*   `Inspector.Caption`或者`Inspector.CurrentItem.Subject`同样模棱两可。

*   暂时将`Inspector.CurrentItem.Subject`（或任何其他项目属性）设置为明确的值，然后在其他列表类型的作品中查找该值，但具有将检查器中的项目标记为“脏”的烦人副作用，即在关闭检查器时将再次要求用户保存该项目（即使他只是查看收到的邮件）。

还有其他想法吗？

* * *

*语境：*

我正在尝试解决众所周知的错误/功能，即通过简单 MAPI 发起的新电子邮件消息（例如，资源管理器上下文菜单中的发送到>邮件收件人）不会生成`Inspectors.NewInspector`事件，因此无法向那些添加任何插件功能检查员（例如添加工具栏按钮或在消息创建时执行代码）。在我的 COM 插件中，我有一个用于捕获事件的包装器对象的内部列表`Inspector`。`Inspectors.NewInspector`通过监视和`Inspector.Close`事件将项目添加和删除到此列表中。

作为一种替代方法，我使用了一个 shell 钩子：我现在能够在创建或销毁新的检查器窗口时收到通知，因此这似乎是一个很好的地方，可以跳入并将我的内部包装对象列表与`Application.Inspectors`集合匹配并相应地添加或删除新的或孤立的包装对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-06T09:05:33.743

我现在发现比较`Inspector.CurrentItem.CreationTime`对我来说足够可靠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-07T18:41:05.560

您还可以使用**Is**运算符来查看两个对象引用是否指向同一个对象。

前任：

```
Debug.Print InspectorObj1 Is InspectorObj2 
```

如果两个引用都引用同一个 Inspector，这将在立即窗口中打印**True 。**

# c# - 如何在我的应用程序中使用 Windows 键

> ID：325636
> 
> 赞同：4
> 
> 时间：2008-11-28T12:19:34.867
> 
> 标签：c#, .net, vb.net

像：

```
 Windows Key + E 
Opens a new Explorer Window 
```

和：

```
 Windows Key + R 
Displays the Run command 
```

如何在我的应用程序的 KeyDown 事件中使用 Windows 键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T12:29:50.230

如果要在事件处理程序中处理这些键，请使用 Keys.LWin 和 Keys.RWin

一般来说，我不建议使用这些，因为未来版本的 Windows 可能会引入新的快捷方式，这些快捷方式会干扰您的组合。

# java - 安全 Java SOAP Web 服务 - Active Directory 身份验证信任

> ID：325637
> 
> 赞同：2
> 
> 时间：2008-11-28T12:19:58.063
> 
> 标签：java, soap, active-directory, trust

我想在 Java 生产者和 Java 消费者之间构建一个安全的 Web 服务。我想使用生产者和消费者正在运行的域帐户使用 Active Directory 进行身份验证。

你能给我举个例子吗？

（即：手动密钥库的 AD 可信自动化替代方案。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-16T11:16:10.200

这是一个开源库[http://spnego.sourceforge.net/protected_soap_service.html](http://spnego.sourceforge.net/protected_soap_service.html)，其中包含您正在寻找的示例。

这个开源项目有一个关于如何通过 servlet 过滤器要求身份验证（基本身份验证或 Kerberos/集成 Windows 身份验证）的示例。

该项目还有一个示例，说明如何创建需要连接到受保护的肥皂服务的肥皂客户端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-30T05:05:48.703

查看[Spring WS](http://static.springframework.org/spring-ws/sites/1.5/)和[安全证书身份验证](http://static.springframework.org/spring-ws/sites/1.5/reference/html/security.html#security-certificate-authentication)、[7.2.2.1.3 JaasPlainTextPasswordValidationCallbackHandler](http://static.springframework.org/spring-ws/sites/1.5/reference/html/security.html#d0e4049)和[7.2.2.3.3 JaasCertificateValidationCallbackHandler](http://static.springframework.org/spring-ws/sites/1.5/reference/html/security.html#d0e4049)。

有一些例子通过额外的研究将其联系在一起。

# java - Java中的面向方面编程

> ID：325640
> 
> 赞同：7
> 
> 时间：2008-11-28T12:20:30.340
> 
> 标签：java, aop

面向方面编程的最佳 Java 工具是什么？

对工具的要求当然是 IDE 支持、表达能力和适当的文档。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-28T12:32:02.253

JBossAOP 和 AspectJ 是两个常用的、成熟的 AOP 框架。另一个流行的选择是 Spring AOP，但它缺少其他两个的一些特性。

JBossAOP 和 AspectJ 都具有相似的特性，一个很大的区别是 AspectJ 依赖于 Java 语言的扩展，而 JBoss AOP 没有。

如果您的 AOP 要求相当简单，那么还值得考虑字节码操作库，例如[ASM](http://asm.objectweb.org/)。我使用 ASM 来实现简单的“around-advice”（即，在方法调用之前和之后注入的代码），它被证明是 JBossAOP 的更轻量级的替代方案。ASM 设计简洁且文档齐全。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T12:24:49.083

我会说AspectJ。据我所知，IDE 部分是缺乏的，但文档和表达能力是我见过的最好的 AOP 框架之一。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-28T12:32:37.930

如果您已经在使用 Spring，则托管对象已经具有[AOP 支持](http://static.springframework.org/spring/docs/2.5.x/reference/aop.html)。虽然不如 AspectJ 灵活，但它不需要 AspectJ 所做的预编译步骤。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T14:40:53.193

关于 Spring AOP 支持。默认情况下，它仅与 Spring 可管理对象和基于 AspectJ 的 AFAIK 相关。

我还没有自己检查它，但看起来它允许使用 AOP 和其他对象（例如 Tomcat 下的加载时间编织）。详情在[这里](http://miloszikic.blogspot.com/2008/03/spring-aop-and-tomcat-load-time-weaving.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T12:46:19.853

AOP 与春季休闲这个链接[http://rajkrrsingh.blogspot.com/2012/10/spring-aop-tutorial.html](http://rajkrrsingh.blogspot.com/2012/10/spring-aop-tutorial.html)

# java - 文本字段“元音变音”未在 linux 上显示

> ID：325648
> 
> 赞同：2
> 
> 时间：2008-11-28T12:24:01.160
> 
> 标签：java, linux, unix, unicode, encoding

Java 1.5，Linux

我确实有一个包含不同文本区域和文本字段的屏幕。我确实可以访问应用程序框架，但不能访问框架内的组件，因为我只获得了接口的实现。

当我尝试添加德语变音符号时，我在文本组件中看到一个矩形，因为不支持该字符。我必须设置哪种字体或哪个系统属性以支持 linux 下的“元音变音”。在 Windows 上，字符显示正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T13:13:25.257

这听起来像是字符编码问题或字体问题……就像在 Linux 环境中使用“windows”编码一样。您应该检查以下内容：

*   你能在你的 Linux 发行版中用普通的文本编辑器写这些字符吗？
*   这些字符是来自您的 java 应用程序中的输入文件还是来自源代码，如果是的话，您使用什么操作系统来编写源代码？
*   如果它们来自源文件或资源文件，您是否检查过这些字符在 Linux 的源文件中实际上是可读的？
*   如果您在例如 vim 中打开源文件，它使用什么编码？（通常在您打开文件后屏幕下方显示）

如果您告诉执行此操作时会发生什么，我们可能会更好地了解问题所在。:)

**更新：** 我希望您检查这一点的原因是我知道所谓的“Windows 编码”会在其他操作系统中产生问题。你说你可以在控制台上写变音符号，但不能在 vi 中，你会得到什么，方块？

用户不应该查看 ini 文件并不重要，如果您在 Linux 中手动创建 ini 文件，我想您那时可以编写变音符号。您应该找出这些文件和 TCP 连接使用的字符编码。它应该是 UTF-8，“Western”或“Windows”或“Latin-1”等可能会导致问题。

如果一切都是 UTF-8，除了在您的应用程序中之外的任何地方都可读，我会开始怀疑缺少字体问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T13:31:16.267

我的猜测是桌面（KDE 或 Gnome）被配置为使用不包含变音符号的字体（今天有点奇怪，但它确实发生了）。Java 通常尝试使用系统字体作为计算“Dialog”字体的基础（即使未安装也始终可用；“Dialog”是 Java 用来表示“Default sans-serif font”的虚拟字体名称）。

*   检查使用 xlsfonts 安装了哪些字体
*   检查是否可以在控制台中输入变音符号
*   尝试不同的 Java 应用程序
*   检查 $JAVA_HOME/jre/lib/fonts (IIRC)。我想你可以在那里找到字体映射。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T13:08:08.733

方形框是 unicode 符号，用于当有问题的字符由于字体不包含它而无法显示时。

您要么需要将文本框切换为包含德语字符的字体，要么找到其他方法来替换该字符（这在 Java 中可能无法实现）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T14:05:53.093

*   你能在你的 Linux 发行版中用普通的文本编辑器写这些字符吗？

"vi" 不显示 äöü

*   这些字符是来自您的 java 应用程序中的输入文件还是来自源代码，如果是的话，您使用什么操作系统来编写源代码？

字符串由 tcp 连接发送或从操作系统上创建的 ini 文件中读取

*   如果它们来自源文件或资源文件，您是否检查过这些字符在 Linux 的源文件中实际上是可读的？

不会发生，不重要

*   如果您在例如 vim 中打开源文件，它使用什么编码？（通常在您打开文件后屏幕下方显示）

我现在可以不测试吗

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T14:17:12.197

*   检查是否可以在控制台中输入变音符号

在控制台上我可以给 äöü 小费

```
echo $TERM --> vt100 
```

*   检查使用 xlsfonts 安装了哪些字体

命令：

```
'find / | grep font' 
```

结果：

```
/etc/字体
/etc/fonts/conf.d
/etc/fonts/conf.d/unhinted.conf
/etc/fonts/conf.d/autohint.conf
/etc/fonts/conf.d/sub-pixel.conf
/etc/fonts/conf.d/yes-bitmaps.conf
/etc/fonts/conf.d/no-sub-pixel.conf
/etc/fonts/conf.d/no-bitmaps.conf
/etc/fonts/fonts.dtd
/etc/fonts/fonts.conf
/opt/jdk/j2re1.4.2_16/lib/fonts
/opt/jdk/j2re1.4.2_16/lib/fonts/LucidaBrightDemiBold.ttf
/opt/jdk/j2re1.4.2_16/lib/fonts/LucidaBrightDemiItalic.ttf
/opt/jdk/j2re1.4.2_16/lib/fonts/LucidaBrightItalic.ttf
/opt/jdk/j2re1.4.2_16/lib/fonts/LucidaBrightRegular.ttf
/opt/jdk/j2re1.4.2_16/lib/fonts/LucidaSansDemiBold.ttf
/opt/jdk/j2re1.4.2_16/lib/fonts/LucidaSansDemiOblique.ttf
/opt/jdk/j2re1.4.2_16/lib/fonts/LucidaSansOblique.ttf
/opt/jdk/j2re1.4.2_16/lib/fonts/LucidaSansRegular.ttf
/opt/jdk/j2re1.4.2_16/lib/fonts/LucidaTypewriterBold.ttf
/opt/jdk/j2re1.4.2_16/lib/fonts/LucidaTypewriterBoldOblique.ttf
/opt/jdk/j2re1.4.2_16/lib/fonts/LucidaTypewriterOblique.ttf
/opt/jdk/j2re1.4.2_16/lib/fonts/LucidaTypewriterRegular.ttf
/opt/jdk/j2re1.4.2_16/lib/fonts/fonts.dir
/opt/jdk/j2re1.4.2_16/lib/font.properties
/opt/jdk/j2re1.4.2_16/lib/font.properties.Redhat6.1
/opt/jdk/j2re1.4.2_16/lib/font.properties.Redhat8.0
/opt/jdk/j2re1.4.2_16/lib/font.properties.SuSE8.0
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja.Redhat3
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja.Redhat4
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja.Redhat6.1
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja.Redhat6.2
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja.Redhat7.2
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja.Redhat7.3
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja.Redhat8.0
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja.Turbo
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja.Turbo6.0
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja_JP.Sun
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja_JP.Sun2003
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja_JP_UTF8.Sun
/opt/jdk/j2re1.4.2_16/lib/font.properties.ja_JP_UTF8.Sun2003
/opt/jdk/j2re1.4.2_16/lib/font.properties.ko.Redhat
/opt/jdk/j2re1.4.2_16/lib/font.properties.ko.Redhat2.1
/opt/jdk/j2re1.4.2_16/lib/font.properties.ko_KR.Sun
/opt/jdk/j2re1.4.2_16/lib/font.properties.ko_KR_UTF8.Sun
/opt/jdk/j2re1.4.2_16/lib/font.properties.ko_KR_UTF8.Sun2003
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh.Turbo
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh_CN.Redhat
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh_CN.Redhat2.1
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh_CN.Redhat4
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh_CN.Sun
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh_CN_UTF8.Sun
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh_HK.Sun
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh_HK_UTF8.Sun
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh_HK_UTF8.Sun2003
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh_TW.Redhat
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh_TW.Redhat2.1
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh_TW.Sun
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh_TW_UTF8.Sun
/opt/jdk/j2re1.4.2_16/lib/font.properties.zh_TW_UTF8.Sun2003
/opt/jdk/j2re1.4.2_16/lib/i386/libfontmanager.so
/opt/jdk/j2re1.4.2_16/lib/psfont.properties.ja
/opt/jdk/j2re1.4.2_16/lib/psfontj2d.properties
/tmp/fonts.txt
/usr/bin/splitfont
/usr/bin/setfont
/usr/bin/showcfont
/usr/bin/font2psf
/usr/lib/libXfont.so.1
/usr/lib/libfontconfig.so.1.0.4
/usr/lib/libfontenc.so.1
/usr/lib/xorg/modules/字体
/usr/lib/xorg/modules/fonts/libfreetype.so
/usr/lib/xorg/modules/fonts/libbitmap.so
/usr/lib/xorg/modules/fonts/libtype1.so
/usr/lib/libfontmanager.so
/usr/lib/libcfont.so.0.0.0
/usr/lib/libfontenc.so.1.0.0
/usr/lib/libXfont.so.1.4.1
/usr/lib/libcfont.so.0
/usr/lib/libfontconfig.so.1
/usr/share/字体
/usr/share/fonts/X11
/usr/share/fonts/X11/Type1
/usr/share/fonts/X11/Type1/n021023l.pfb
/usr/share/fonts/X11/Type1/n019003l.pfb
/usr/share/fonts/X11/Type1/fonts.alias
/usr/share/fonts/X11/Type1/n021024l.pfb
/usr/share/fonts/X11/Type1/n019004l.pfb
/usr/share/fonts/X11/Type1/fonts.scale
/usr/share/fonts/X11/Type1/c0648bt_.afm
/usr/share/fonts/X11/Type1/c0648bt_.pfb
/usr/share/fonts/X11/Type1/c0583bt_.afm
/usr/share/fonts/X11/Type1/c0583bt_.pfb
/usr/share/fonts/X11/Type1/fonts.dir
/usr/share/fonts/X11/Type1/c0611bt_.afm
/usr/share/fonts/X11/Type1/c0611bt_.pfb
/usr/share/fonts/X11/Type1/n022003l.pfb
/usr/share/fonts/X11/Type1/n022004l.pfb
/usr/share/fonts/X11/Type1/n019023l.pfb
/usr/share/fonts/X11/Type1/n019024l.pfb
/usr/share/fonts/X11/Type1/cursor.pfa
/usr/share/fonts/X11/Type1/c0419bt_.afm
/usr/share/fonts/X11/Type1/c0419bt_.pfb
/usr/share/fonts/X11/Type1/c0582bt_.afm
/usr/share/fonts/X11/Type1/c0582bt_.pfb
/usr/share/fonts/X11/Type1/c0633bt_.afm
/usr/share/fonts/X11/Type1/c0633bt_.pfb
/usr/share/fonts/X11/Type1/n022023l.pfb
/usr/share/fonts/X11/Type1/n022024l.pfb
/usr/share/fonts/X11/Type1/n019043l.pfb
/usr/share/fonts/X11/Type1/n019044l.pfb
/usr/share/fonts/X11/Type1/c0649bt_.afm
/usr/share/fonts/X11/Type1/c0649bt_.pfb
/usr/share/fonts/X11/Type1/n021003l.pfb
/usr/share/fonts/X11/Type1/n021004l.pfb
/usr/share/fonts/X11/Type1/n019063l.pfb
/usr/share/fonts/X11/Type1/n019064l.pfb
/usr/share/fonts/X11/Type1/c0632bt_.afm
/usr/share/fonts/X11/Type1/c0632bt_.pfb
/usr/share/fonts/X11/misc
/usr/share/fonts/X11/misc/fonts.dir
/usr/share/fonts/X11/misc/clR5x6.pcf.gz
/usr/share/fonts/X11/misc/9x18-ISO8859-11.pcf.gz
/usr/share/fonts/X11/misc/cudevnag12.pcf.gz
/usr/share/fonts/X11/misc/gb16st.pcf.gz
/usr/share/fonts/X11/misc/7x13O-ISO8859-11.pcf.gz
/usr/share/fonts/X11/misc/8x13B-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/encodings.dir
/usr/share/fonts/X11/misc/6x13O-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/6x12.pcf.gz
/usr/share/fonts/X11/misc/jiskan16.pcf.gz
/usr/share/fonts/X11/misc/6x12-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/clR4x6.pcf.gz
/usr/share/fonts/X11/misc/cu12.pcf.gz
/usr/share/fonts/X11/misc/hanglg16.pcf.gz
/usr/share/fonts/X11/misc/7x14B-ISO8859-11.pcf.gz
/usr/share/fonts/X11/misc/4x6-ISO8859-2.pcf.gz
/usr/share/fonts/X11/misc/cuarabic12.pcf.gz
/usr/share/fonts/X11/misc/4x6-ISO8859-3.pcf.gz
/usr/share/fonts/X11/misc/micro.pcf.gz
/usr/share/fonts/X11/misc/9x18B-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/k14.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/clR8x16.pcf.gz
/usr/share/fonts/X11/misc/clR8x13.pcf.gz
/usr/share/fonts/X11/misc/clR7x10.pcf.gz
/usr/share/fonts/X11/misc/5x7.pcf.gz
/usr/share/fonts/X11/misc/4x6-KOI8-R.pcf.gz
/usr/share/fonts/X11/misc/9x15B-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/4x6-ISO8859-13.pcf.gz
/usr/share/fonts/X11/misc/olgl14.pcf.gz
/usr/share/fonts/X11/misc/6x12-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/6x13-ISO8859-11.pcf.gz
/usr/share/fonts/X11/misc/clB8x12.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-ISO8859-8.pcf.gz
/usr/share/fonts/X11/misc/6x13O.pcf.gz
/usr/share/fonts/X11/misc/4x6-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/clR6x12.pcf.gz
/usr/share/fonts/X11/misc/5x8.pcf.gz
/usr/share/fonts/X11/misc/7x13-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/5x7-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/7x13-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/4x6-ISO8859-4.pcf.gz
/usr/share/fonts/X11/misc/6x10-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/6x9-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/4x6-ISO8859-7.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-ISO8859-2.pcf.gz
/usr/share/fonts/X11/misc/clR7x12.pcf.gz
/usr/share/fonts/X11/misc/6x13B.pcf.gz
/usr/share/fonts/X11/misc/9x15-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/clB9x15.pcf.gz
/usr/share/fonts/X11/misc/4x6.pcf.gz
/usr/share/fonts/X11/misc/6x13.pcf.gz
/usr/share/fonts/X11/misc/7x14-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/clR7x14.pcf.gz
/usr/share/fonts/X11/misc/8x13-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/4x6-ISO8859-10.pcf.gz
/usr/share/fonts/X11/misc/8x13O-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/5x7-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/10x20-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/7x14-JISX0201.1976-0.pcf.gz
/usr/share/fonts/X11/misc/4x6-ISO8859-14.pcf.gz
/usr/share/fonts/X11/misc/clR7x8.pcf.gz
/usr/share/fonts/X11/misc/olgl19.pcf.gz
/usr/share/fonts/X11/misc/clB6x12.pcf.gz
/usr/share/fonts/X11/misc/4x6-ISO8859-9.pcf.gz
/usr/share/fonts/X11/misc/9x15.pcf.gz
/usr/share/fonts/X11/misc/7x13-ISO8859-11.pcf.gz
/usr/share/fonts/X11/misc/7x13O-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/decsess.pcf.gz
/usr/share/fonts/X11/misc/clB8x8.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-ISO8859-10.pcf.gz
/usr/share/fonts/X11/misc/5x8-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/olgl10.pcf.gz
/usr/share/fonts/X11/misc/clB8x13.pcf.gz
/usr/share/fonts/X11/misc/6x9-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-ISO8859-15.pcf.gz
/usr/share/fonts/X11/misc/4x6-ISO8859-15.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/fonts.alias
/usr/share/fonts/X11/misc/9x15-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/7x14B-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/7x13B-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/10x20-ISO8859-11.pcf.gz
/usr/share/fonts/X11/misc/clR5x8.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-ISO8859-7.pcf.gz
/usr/share/fonts/X11/misc/8x16.pcf.gz
/usr/share/fonts/X11/misc/6x10-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/clR8x8.pcf.gz
/usr/share/fonts/X11/misc/8x13-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/nil2.pcf.gz
/usr/share/fonts/X11/misc/clB8x10.pcf.gz
/usr/share/fonts/X11/misc/7x14-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/clB6x10.pcf.gz
/usr/share/fonts/X11/misc/clR8x10.pcf.gz
/usr/share/fonts/X11/misc/clI8x8.pcf.gz
/usr/share/fonts/X11/misc/cursor.pcf.gz
/usr/share/fonts/X11/misc/8x13.pcf.gz
/usr/share/fonts/X11/misc/7x14-ISO8859-11.pcf.gz
/usr/share/fonts/X11/misc/clR6x13.pcf.gz
/usr/share/fonts/X11/misc/olgl12.pcf.gz
/usr/share/fonts/X11/misc/4x6-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/clR6x10.pcf.gz
/usr/share/fonts/X11/misc/8x16rk.pcf.gz
/usr/share/fonts/X11/misc/9x15-ISO8859-11.pcf.gz
/usr/share/fonts/X11/misc/6x13O-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/7x13O.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-ISO8859-5.pcf.gz
/usr/share/fonts/X11/misc/7x14.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-KOI8-R.pcf.gz
/usr/share/fonts/X11/misc/hanglm16.pcf.gz
/usr/share/fonts/X11/misc/6x13B-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-ISO8859-3.pcf.gz
/usr/share/fonts/X11/misc/8x13O.pcf.gz
/usr/share/fonts/X11/misc/4x6-ISO8859-8.pcf.gz
/usr/share/fonts/X11/misc/gb16fs.pcf.gz
/usr/share/fonts/X11/misc/jiskan24.pcf.gz
/usr/share/fonts/X11/misc/7x13B-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/deccurs.pcf.gz
/usr/share/fonts/X11/misc/clB8x16.pcf.gz
/usr/share/fonts/X11/misc/6x9.pcf.gz
/usr/share/fonts/X11/misc/8x13O-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/arabic24.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-ISO8859-4.pcf.gz
/usr/share/fonts/X11/misc/7x13B-ISO8859-11.pcf.gz
/usr/share/fonts/X11/misc/hanglm24.pcf.gz
/usr/share/fonts/X11/misc/9x15B.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-ISO8859-9.pcf.gz
/usr/share/fonts/X11/misc/8x13B.pcf.gz
/usr/share/fonts/X11/misc/clR6x8.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-ISO8859-13.pcf.gz
/usr/share/fonts/X11/misc/cu-lig12.pcf.gz
/usr/share/fonts/X11/misc/gb24st.pcf.gz
/usr/share/fonts/X11/misc/clR5x10.pcf.gz
/usr/share/fonts/X11/misc/7x14B-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/cu-devnag12.pcf.gz
/usr/share/fonts/X11/misc/7x14B.pcf.gz
/usr/share/fonts/X11/misc/9x15B-ISO8859-11.pcf.gz
/usr/share/fonts/X11/misc/10x20-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/6x13B-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/clR9x15.pcf.gz
/usr/share/fonts/X11/misc/9x18.pcf.gz
/usr/share/fonts/X11/misc/8x13B-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/clR6x12-ISO8859-14.pcf.gz
/usr/share/fonts/X11/misc/9x18-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/7x13O-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/clR6x6.pcf.gz
/usr/share/fonts/X11/misc/cu-alt12.pcf.gz
/usr/share/fonts/X11/misc/5x8-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/9x15B-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/9x18B.pcf.gz
/usr/share/fonts/X11/misc/6x10.pcf.gz
/usr/share/fonts/X11/misc/clB8x14.pcf.gz
/usr/share/fonts/X11/misc/olcursor.pcf.gz
/usr/share/fonts/X11/misc/clR8x12.pcf.gz

/usr/share/fonts/X11/misc/clI6x12.pcf.gz
/usr/share/fonts/X11/misc/10x20.pcf.gz
/usr/share/fonts/X11/misc/6x13-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/6x13-ISO8859-1.pcf.gz
/usr/share/fonts/X11/misc/7x13.pcf.gz
/usr/share/fonts/X11/misc/7x13B.pcf.gz
/usr/share/fonts/X11/misc/4x6-ISO8859-5.pcf.gz
/usr/share/fonts/X11/misc/9x18B-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/cu-pua12.pcf.gz
/usr/share/fonts/X11/misc/9x18-ISO8859-16.pcf.gz
/usr/share/fonts/X11/misc/clR8x14.pcf.gz
/usr/share/fonts/X11/misc/cu-arabic12.pcf.gz
/usr/share/fonts/X11/encodings
/usr/share/fonts/X11/encodings/encodings.dir
/usr/share/fonts/X11/encodings/iso8859-11.enc.gz
/usr/share/fonts/X11/TTF
/usr/share/fonts/X11/TTF/CO1251B.TTF
/usr/share/fonts/X11/TTF/CO1251N.TTF
/usr/share/fonts/X11/TTF/UN1251B.TTF
/usr/share/fonts/X11/TTF/UN1251N.TTF
/usr/share/fonts/X11/TTF/arial1250.ttf
/usr/share/fonts/X11/TTF/fonts.dir
/usr/share/fonts/X11/TTF/xserce.ttf

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-01T10:16:44.160

我编写了一个摇摆测试，在其中我选择了我可以在 Java 中使用的所有可用字体。

```
Font[] fonts = GraphicsEnvironment.getLocalGraphicsEnvironment().getAllFonts(); 
```

有了这些字体，当我将 jpanel 的字体设置为给定的字体时，我可以将变音符号写入 jpanel。它们都正确显示。

我读了一个我认为是在另一台电脑上创建的文件。我必须询问以确定该文件的来源。我从 tcp 连接获得的字符串可以正确显示。我从文件中读取的字符串是我无法显示的字符串。谢谢你的回答。我会检查文件的格式是否错误。

# silverlight - 在 Silverlight 中更改 Datagrid Header 的背景颜色

> ID：325654
> 
> 赞同：8
> 
> 时间：2008-11-28T12:26:40.953
> 
> 标签：silverlight, datagrid, silverlight-2.0

我想在 Silverlight 中更改 Datagrid 标头的背景颜色。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-01T12:35:07.797

尽管 DataGrid 没有公开 Header Background 属性，但它确实具有 ColumnHeaderStyle 的属性。使用 DaniCE 之前为单个列建议的技术，我们可以替换所有标题列的标题模板，包括右侧的空白区域。将整个模板替换为标题的缺点是我们丢失了默认标题模板中存在的排序箭头和分隔符。幸运的是，我们可以使用[模板浏览器](http://jesseliberty.com/2008/10/03/template-browser-%E2%80%93-an-indispensible-tool/)来提取正在使用的默认模板，然后修改它的副本。

在这里，我整理了一个快速示例，它将列标题的背景更改为 LightBlue，同时保留分隔符和排序。[在模板浏览器](http://jesseliberty.com/2008/10/03/template-browser-%E2%80%93-an-indispensible-tool/)中查看默认的 DataGridColumnHeader 模板，了解当鼠标悬停在 ColumnHeader 上时如何处理修改背景。

[![数据网格标题背景](https://i.stack.imgur.com/XIkKV.jpg)](https://i.stack.imgur.com/XIkKV.jpg)

```
<data:DataGrid x:Name="grid">
    <data:DataGrid.ColumnHeaderStyle>
        <Style 
            xmlns:primitives="clr-namespace:System.Windows.Controls.Primitives;assembly=System.Windows.Controls.Data" 
            xmlns:vsm="clr-namespace:System.Windows;assembly=System.Windows"
            TargetType="primitives:DataGridColumnHeader" >
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="primitives:DataGridColumnHeader">
                        <Grid Name="Root">
                            <vsm:VisualStateManager.VisualStateGroups>
                                <vsm:VisualStateGroup x:Name="SortStates" >
                                    <vsm:VisualStateGroup.Transitions>
                                        <vsm:VisualTransition GeneratedDuration="00:00:0.1" />
                                    </vsm:VisualStateGroup.Transitions>
                                    <vsm:VisualState x:Name="Unsorted" />
                                    <vsm:VisualState x:Name="SortAscending">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="SortIcon" Storyboard.TargetProperty="Opacity" Duration="0" To="1.0" />
                                        </Storyboard>
                                    </vsm:VisualState>
                                    <vsm:VisualState x:Name="SortDescending">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="SortIcon" Storyboard.TargetProperty="Opacity" Duration="0" To="1.0" />
                                            <DoubleAnimation Storyboard.TargetName="SortIconTransform" Storyboard.TargetProperty="ScaleY" Duration="0" To="-.9" />
                                        </Storyboard>
                                    </vsm:VisualState>
                                </vsm:VisualStateGroup>
                            </vsm:VisualStateManager.VisualStateGroups>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Rectangle x:Name="BackgroundRectangle" Stretch="Fill" Fill="LightBlue" Grid.ColumnSpan="2" Grid.RowSpan="2"  />
                            <ContentPresenter Grid.RowSpan="2" Content="{TemplateBinding Content}" Cursor="{TemplateBinding Cursor}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" Margin="{TemplateBinding Padding}" />
                            <Rectangle Name="VerticalSeparator" Grid.RowSpan="2" Grid.Column="2" Width="1" VerticalAlignment="Stretch" Fill="{TemplateBinding SeparatorBrush}" Visibility="{TemplateBinding SeparatorVisibility}" />
                            <Path Grid.RowSpan="2" Name="SortIcon" RenderTransformOrigin=".5,.5" HorizontalAlignment="Left" VerticalAlignment="Center" Opacity="0" Grid.Column="1" Stretch="Uniform" Width="8" Data="F1 M -5.215,6.099L 5.215,6.099L 0,0L -5.215,6.099 Z ">
                                <Path.Fill>
                                    <SolidColorBrush Color="#FF444444" />
                                </Path.Fill>
                                <Path.RenderTransform>
                                    <TransformGroup>
                                        <ScaleTransform x:Name="SortIconTransform" ScaleX=".9" ScaleY=".9"  />
                                    </TransformGroup>
                                </Path.RenderTransform>
                            </Path>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </data:DataGrid.ColumnHeaderStyle>
</data:DataGrid> 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T17:15:57.213

我想出了一个“干净”的解决方案。希望它对你有用。我只是重写了 DataGrid 并公开了 GetTemplateChild 方法。使用它，您可以访问 DataGridColumnHeaderPresenter 和其中包含的 DataGridColumnHeaders...

1) 覆盖数据网格

```
/// <summary>
/// Extends the DataGrid so that it's possible to access the template objects
/// </summary>
public class DataGridEx : System.Windows.Controls.DataGrid
{
    /// <summary>
    /// Exposes Template items
    /// </summary>
    public Object GetTemplateObject(String name)
    {
        return this.GetTemplateChild(name);
    }
} 
```

2) 改变背景

DataGridEx 网格 = 新 DataGridEx();

...应用模板后...

DataGridColumnHeadersPresenter obj = DataGrid.GetTemplateObject("ColumnHeadersPresenter") as DataGridColumnHeadersPresenter;

DataGridColumnHeader h = obj.Children[0] as DataGridColumnHeader;

h.Background = new SolidColorBrush(Colors.Red);

# ssl - 如何检查服务器是否启用了 ssl

> ID：325667
> 
> 赞同：16
> 
> 时间：2008-11-28T12:30:19.463
> 
> 标签：ssl

你们有谁知道，如果有的话，我如何使用我的应用程序代码检查服务器是否启用了 ssl？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-28T14:05:24.217

[“请求宽恕比许可更容易”](http://mail.python.org/pipermail/python-list/2003-May/203039.html)

例如，`stackoverflow.com`通过 SSL 读取，不要问是否`stackoverflow.com`支持，直接去做。在 Python 中：

```
>>> import urllib2
>>> urllib2.urlopen('https://stackoverflow.com')
Traceback (most recent call last):
...
urllib2.URLError: <urlopen error (10060, 'Operation timed out')>
>>> html = urllib2.urlopen('http://stackoverflow.com').read()
>>> len(html)
146271
>>> 
```

它表明`stackoverflow.com`不支持 SSL (2008)。

* * *

**更新：** `stackoverflow.com`现在支持 https。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-09-08T08:49:14.993

您无需指定编程语言，但可以从命令行执行此操作。

```
bash-3.2$ echo ^D | telnet www.google.com https
Trying 66.102.11.104...
Connected to www.l.google.com.
Escape character is '^]'.
Connection closed by foreign host.
bash-3.2$ echo ^D | telnet www.stackoverflow.com https
Trying 69.59.196.211...
telnet: connect to address 69.59.196.211: Connection refused
telnet: Unable to connect to remote host 
```

你去吧......谷歌有，StackOverflow没有。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-07-12T00:36:42.467

这是一个 C# 单元测试，无需在正确的 HTTPContext 上即可执行检测：

```
 [TestMethod]
    public void DetectSslSupport()
    {
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create("https://www.someinsecuresite.com");
        try
        {
            using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
            {
                //some sites like stackoverflow will perform a service side redirect to the http site before the browser/request can throw an errror.
                Assert.IsTrue(response.ResponseUri.Scheme == "https");
            }
        }
        catch (WebException)//"The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel."}
        {
            Assert.IsTrue(false);
        }
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-28T12:33:59.550

不确定您的偏好语言，但这里是 c#

```
public bool IsSecureConnection()
{
    return HttpContext.Current.Request.IsSecureConnection || 
           HttpContext.Current.Request.Headers["HTTP_X_SSL_REQUEST"].Equals("1");
} 
```

请注意这个标题是自定义的，但我想你明白了。我见过人们简单地查询“https”请求，除了看起来很脏之外，它可能是可以接受的，这取决于你的安全模型。

或者您是在问它是否完全可用？

一世

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-11-07T17:55:42.853

**11年后...**

我最终来到这里，因为我有同样的问题（在终端内）。

我想最简单的解决方案是[`s_client`](https://www.openssl.org/docs/man1.0.2/man1/openssl-s_client.html)使用[`openssl`](https://www.openssl.org)：

```
openssl s_client -quiet -connect google.com:443 
```

如果这返回退出状态`0`（使用检查`echo "$?"`），则主机在给定端口（此处`443`）上支持 SSL/TLS。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T12:42:34.807

您需要指定您使用的协议——有 HTTP、IMAP、POP 等的 SSL 版本。

假设您感兴趣的是 HTTPS，您可以检查服务器上的 443 端口是否有东西在监听，然后从那里开始...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-12T10:03:56.067

如果您在服务器上运行 PHP 或 ASP 代码，简短的回答是您没有。您可以尝试与非 ssl IP 地址建立套接字连接，并查看您是否获得了 ssl 证书，并枚举其 Common Name 和 SubjectAlternativeNames，但一般来说，简单的答案是您没有。apache 的一个常见（错误）配置是在没有 SSL 证书的情况下侦听端口 443，因此能够建立连接并不能保证那里有 SSL。无法建立连接可能意味着您的应用程序没有网络权限。因为设置 SSL 很痛苦，所以您知道自己是否有 SSL，这是一个配置决定。这就像想知道你有多少孩子——你应该知道。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-18T09:54:50.020

批量 SSL/TLS 测试`http.parsed`表单中的输入文件

```
10.31.11.5:443
10.31.11.25:443
10.31.11.37:55000
10.31.11.116:80 
```

使用 GNU 并行

```
parallel -j10 'curl -k https://{} 1> /dev/null 2> /dev/null && echo https://{}' :::: http.parsed 
```

我们得到输出

```
https://10.31.11.5:443
https://10.31.11.25:443
https://10.31.11.37:55000 
```

# php - Codeigniter - 如何重用代码来生成 HTML 块

> ID：325669
> 
> 赞同：7
> 
> 时间：2008-11-28T12:30:37.653
> 
> 标签：php, codeigniter

我想我可能会以错误的方式处理这个问题，所以我将不胜感激任何评论/指导。希望我能足够连贯地解释我想要实现的目标：

*   我想创建一个 HTML 块（例如，一个包含用户配置文件的框），我将在我生成的大多数页面上加载它作为我的布局的一部分。

*   我还希望能够从单独的 URL 自行重新生成此框中的内容。这样我就可以使用 AJAX 调用更新该框。

*   我不想复制创建此 HTML 的代码。

我很感激我可以使用 AJAX 调用来加载这个盒子，但在我看来这似乎是向服务器添加了不必要的调用？

我认为我可以做到的方法是在我的控制器中有一个方法，它只呈现这个 HTML 块，但是我如何在另一个控制器/视图中请求这个方法的输出？

你会如何处理这个问题？

提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-28T12:45:36.297

创建一个视图以生成用户配置文件的 HTML 块，并使用以下命令从控制器调用它：

```
$user_html = $this->load->view('user_view', $user_data, true); 
```

第三个参数将视图作为字符串返回，而不是显示它。然后可以以通常的方式将其传递到另一个视图。

```
$data['user_block'] = $user_html;
$this->load->view('page_view', $data); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-28T22:01:33.443

就数据而言，您不需要使用 PHP 生成 HTML。您可以使用[jQuery](http://jquery.com/ "jQuery")从页面源中的 JSON 对象输出生成必要的元素。然后，您可以在元素上显示一个漂亮的小“加载”动画，同时它会达到“domready”状态。

就重新填充 div 而言，请执行以下操作：

为您的个人资料制作一个 div 并给它一个 id。将数据的每个“元素”放入它自己的 p 元素中，并将实际数据包装在 span 元素中。例如 <p>Name: <span>Joe Bloggs</span></p> 然后简单地使用[jQuery](http://jquery.com/ "jQuery")遍历 dom 并用数据重新填充 span。只要确保以正确的“顺序”输出数据。

有任何问题，请随时反馈。

# java - Eclipse 编码样式检查为 Ant 任务？

> ID：325671
> 
> 赞同：1
> 
> 时间：2008-11-28T12:31:14.313
> 
> 标签：java, eclipse, ant, coding-style, break

在 Eclipse 中，我可以为编码风格设置各种偏好。我希望能够将这些作为蚂蚁任务强制执行，以使构建中断。

谁能给我一个如何在 Ant 任务中强制执行 Eclipse 编码样式的示例？

（我知道 PMD、checkstyle 等 - 这些都不完全符合 eclipse 的编码风格偏好。我想要一个与 eclipse 编码风格完全匹配的 ant 任务）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T12:36:19.233

试试 checkstyle（有一个 eclipse 插件和一个生成报告的 ant 任务。如果需要，您可以“中断”构建）。

[http://checkstyle.sourceforge.net/](http://checkstyle.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-29T10:27:44.000

我想将 eclipse 插入 checkstyle - 并使用 eclipse 样式首选项 - 而不是 eclipse 中的 checkstyle 首选项。

# sql-server - 在 SQL Server Management Studio 中测试 TRY...CATCH

> ID：325673
> 
> 赞同：0
> 
> 时间：2008-11-28T12:31:58.867
> 
> 标签：sql-server, tsql

## **解决方案：**

> **我误解了 SQL 联机丛书中的示例。是的，在**不受 TRY...CATCH 构造影响的错误部分下方**...我很抱歉 :(**

* * *

我只是想在 SQL Server Management Studio 中执行这个简单的示例：

```
USE AdventureWorks;
GO

BEGIN TRY
    -- Table does not exist; object name resolution
    -- error not caught.
    SELECT * FROM NonexistentTable;
END TRY
BEGIN CATCH
    SELECT 
        ERROR_NUMBER() as ErrorNumber,
        ERROR_MESSAGE() as ErrorMessage;
END CATCH 
```

但我发现的唯一输出是：

> 消息 208，级别 16，状态 1，第 5 行无效的对象名称“NonexistentTable”。

因此，错误似乎是由 SQL Server Management Studio 而不是 catch 块捕获的，这显然不是我所期望的。我错过了什么吗？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T12:44:39.170

您的第一个示例在 SQL 联机丛书中使用，您是从那里复制的吗？如果是这样，请阅读整个主题，您会发现这确实行不通。Management Studio 不会引发该错误，它是名称解析错误，不会被 TRY/CATCH 块捕获。

# .net - 如何从 DataGridView 数据单元格中获取 keypressed、keydown 事件

> ID：325677
> 
> 赞同：7
> 
> 时间：2008-11-28T12:33:03.310
> 
> 标签：.net, datagridview, keyboard-events

我需要在控制单元格编辑期间接收按键事件`DataGridView`。

从我在网上找到的内容来看，`DataGridView`它旨在将所有关键事件传递`DataGridView`给单元格编辑控件，您无法轻松获取这些事件。

我发现这段[代码](http://www.codeproject.com/KB/grid/DataGridCellEvents.aspx)可以捕获这些事件以进行`DataGrid`控制，但这不适用于`DataGridView`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-29T21:49:27.947

试试这个：

```
class KeyPressAwareDataGridView : DataGridView
{
    protected override void OnControlAdded(ControlEventArgs e)
    {
        SubscribeEvents(e.Control);
        base.OnControlAdded(e);
    }

    protected override void OnControlRemoved(ControlEventArgs e)
    {
        UnsubscribeEvents(e.Control);
        base.OnControlRemoved(e);
    }

    private void SubscribeEvents(Control control)
    { 
        control.KeyPress += new KeyPressEventHandler(control_KeyPress);
        control.ControlAdded += new ControlEventHandler(control_ControlAdded);
        control.ControlRemoved += new ControlEventHandler(control_ControlRemoved);

        foreach (Control innerControl in control.Controls)
        {
            SubscribeEvents(innerControl);
        }
    }

    private void UnsubscribeEvents(Control control)
    {
        control.KeyPress -= new KeyPressEventHandler(control_KeyPress);
        control.ControlAdded -= new ControlEventHandler(control_ControlAdded);
        control.ControlRemoved -= new ControlEventHandler(control_ControlRemoved);

        foreach (Control innerControl in control.Controls)
        {
            UnsubscribeEvents(innerControl);
        }
    }

    private void control_ControlAdded(object sender, ControlEventArgs e)
    {
        SubscribeEvents(e.Control);
    }

    private void control_ControlRemoved(object sender, ControlEventArgs e)
    {
        UnsubscribeEvents(e.Control);
    }

    private void control_KeyPress(object sender, KeyPressEventArgs e)
    {
        // Apply your logic here whether this is the key pressed event you need.
        // (e.g. "if(SelectedCells != null)")
        MessageBox.Show(e.KeyChar.ToString());
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T14:27:29.943

终于想通了。这个难题有两个部分 - 从单元格编辑控件获取键和从 DataGridView 本身获取键。这是我的代码。要使用它，您只需要订阅自定义事件：**keyPressHook**。

```
class KeyPressAwareDataGridView : DataGridView
{

    protected override void OnControlAdded(ControlEventArgs e)
    {
        this.subscribeEvents(e.Control);
        base.OnControlAdded(e);
    }

    protected override void OnControlRemoved(ControlEventArgs e)
    {
        this.unsubscribeEvents(e.Control);
        base.OnControlRemoved(e);
    }

    protected override bool ProcessDataGridViewKey(KeyEventArgs e)
    {
        bool procesedInternally = false;

        if (this.keyPressHook != null)
        {
            this.keyPressHook(this, e);
            procesedInternally = e.SuppressKeyPress;
        }

        if (procesedInternally)
        {
            return true;
        }
        else
        {
            return base.ProcessDataGridViewKey(e);
        }
    }

    private void subscribeEvents(Control control)
    {
        control.KeyDown += new KeyEventHandler(this.control_KeyDown);
        control.ControlAdded += new ControlEventHandler(this.control_ControlAdded);
        control.ControlRemoved += new ControlEventHandler(this.control_ControlRemoved);

        foreach (Control innerControl in control.Controls)
        {
            this.subscribeEvents(innerControl);
        }
    }

    private void unsubscribeEvents(Control control)
    {
        control.KeyDown -= new KeyEventHandler(this.control_KeyDown);
        control.ControlAdded -= new ControlEventHandler(this.control_ControlAdded);
        control.ControlRemoved -= new ControlEventHandler(this.control_ControlRemoved);

        foreach (Control innerControl in control.Controls)
        {
            this.unsubscribeEvents(innerControl);
        }
    }

    private void control_ControlAdded(object sender, ControlEventArgs e)
    {
        this.subscribeEvents(e.Control);
    }

    private void control_ControlRemoved(object sender, ControlEventArgs e)
    {
        this.unsubscribeEvents(e.Control);
    }

    private void control_KeyDown(object sender, KeyEventArgs e)
    {
        if (this.keyPressHook != null)
        {
            this.keyPressHook(this, e);
        }
    }

    public event KeyEventHandler keyPressHook;

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-27T22:18:29.413

或者，对于那些不想在这种情况下创建我们自己的 DataGridView 的用户；有这个方法（在 C++ 中）：它使用 DataGridView 的 EditingControlShowing 事件。

```
private: System::Boolean fIsNonNumeric;
private: static System::Windows::Forms::KeyEventHandler^ EventKeyDown = nullptr;
private: static System::Windows::Forms::KeyPressEventHandler^ EventKeyPress = nullptr;
private: System::Void dataGridView_KeyDown(System::Object^  sender, System::Windows::Forms::KeyEventArgs^  e) 
{
  fIsNonNumeric= false;

  // Determine whether the keystroke is a number from the top of the keyboard.
  if ( e->KeyCode < Keys::D0 || e->KeyCode > Keys::D9 )
  {
    // Determine whether the keystroke is a number from the keypad.
    if ( e->KeyCode < Keys::NumPad0 || e->KeyCode > Keys::NumPad9 )
    {
      // Determine whether the keystroke is a backspace.
      if ( e->KeyCode != Keys::Back )
      {
        // A non-numerical keystroke was pressed.
        // Set the flag to true and evaluate in KeyPress event.
        fIsNonNumeric = true;
      }
    }
  }
}

private: System::Void dataGridView_KeyPress(System::Object^  sender, System::Windows::Forms::KeyPressEventArgs^  e) 
{
  // Should we stop the character from being entered...?
  if ( fIsNonNumeric == true )
    e->Handled = true;
}

private: System::Void dataGridView_Machines_EditingControlShowing(System::Object^  sender, System::Windows::Forms::DataGridViewEditingControlShowingEventArgs^  e) 
{
  if (nullptr == EventKeyDown)
    EventKeyDown = (gcnew System::Windows::Forms::KeyEventHandler( this, &ProjectForm::dataGridView_KeyDown ));

  if (nullptr == EventKeyPress)
    EventKeyPress = (gcnew System::Windows::Forms::KeyPressEventHandler( this, &ProjectForm::dataGridView_KeyPress ));

  e->Control->KeyDown -= EventKeyDown;
  e->Control->KeyPress -= EventKeyPress;

  e->Control->KeyDown += EventKeyDown;
  e->Control->KeyPress += EventKeyPress;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-28T13:39:07.267

也许不如上面 Mladen Prajdic 的回答那么好，但可能会更容易一些，具体取决于您的情况。您可以覆盖表单或控件本身的 ProcessCmdKey 方法，在那里处理击键，并检查当前单元格。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T12:41:20.487

您必须覆盖 DataGridViewCell/DataGridViewTextBoxCell/otherTypes 并处理派生类中的 key* 事件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T08:03:46.317

通过收听 EditingControlShowing 并向每个新的编辑控件添加关键侦听器，我找到了部分解决方案。

这使我可以访问大多数键，但我仍然没有箭头键。

我会试试 Eren Aygunes 的建议。

# regex - RegExp 匹配引号中的一个单词或多个单词

> ID：325682
> 
> 赞同：7
> 
> 时间：2008-11-28T12:34:18.347
> 
> 标签：regex

我需要一个匹配引号中的一个或多个单词的正则表达式。

[\w]* 匹配一个单词

"[\w\W&&[^"]]*" 匹配引号中的多个单词。

（顺便说一句，不知道为什么 \w\W 有效，但不是一个简单的 . （应该匹配所有字符）

那么我如何结合这两个正则表达式呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-28T12:40:48.147

做`"[^"]+"`你想做的事吗？（匹配一个双引号，匹配一个或多个不是双引号的字符，然后匹配第二个双引号。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-28T13:05:03.263

首先感谢。

你的回答真的很有帮助——但我注意到我的问题可能不够清楚。

无论如何，从你的回答我最终得到了这个正则表达式：

> "[^"]+"|[\w]+

匹配单词和引号中的多个单词。

例如：what is "this thing" 将给出 3 个匹配项：第一个匹配项：what 第二个匹配项：是第三个匹配项："this thing"

这正是我所需要的。再次感谢。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-28T12:48:25.620

我会比较喜欢：

```
"\s*((?:\w(?!\s+")+|\s(?!\s*"))+\w)\s*" 
```

而不是`"[^"]+"`因为`^"`匹配所有内容，而不仅仅是`\w`（**字母数字**）字符`[a-zA-Z_0-9]`

这样，您只匹配`\w`引号内的字符，而没有尾随空格。

```
" ee eee e ee  " 
```

给你分组（1）：

```
ee eee e ee 
```

负前瞻`(?!\s+")`是为了确保我不包括双引号之前的最后一个空格；

# ajax.net - Ajax POST 方法

> ID：325685
> 
> 赞同：1
> 
> 时间：2008-11-28T12:35:28.890
> 
> 标签：ajax.net

我是 Ajax.Net 的新手。

我想知道如何访问从 Ajax POST 方法发送的数据。(ie)AjaxObject.send("一些数据")

如何访问表单中的“某些数据”？

当我使用 GET 方法并在 Querystring 中传递数据时，我可以访问相同的内容。像 ASP 中的 Request.Querystring("name")。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T12:43:24.663

您需要在服务器上定义一个 Web 服务 (asmx)。[您可以在http://www.asp.net](http://www.asp.net)上找到好的文档

特别是围绕网络服务： [http ://www.asp.net/AJAX/Documentation/Live/tutorials/ASPNETAJAXWebServicesTutorials.aspx](http://www.asp.net/AJAX/Documentation/Live/tutorials/ASPNETAJAXWebServicesTutorials.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-09T06:03:22.107

在服务器端，您访问 POST 的 ajax 数据的方式与访问任何 POST 表单数据的方式相同：

```
Request.Form("name") 
```

# asp.net-mvc - 二进制 .dat 文件

> ID：325690
> 
> 赞同：-2
> 
> 时间：2008-11-28T12:38:17.637
> 
> 标签：asp.net-mvc

如何访问二进制数据文件（.DAT）。我正在使用地名 API。谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-29T04:57:57.737

如果您指的是 MaxMinds GeoLocation 数据库使用的二进制平面文件格式，它们提供了一些方便的 C# 和 Java 实用程序类来访问它。

[http://www.maxmind.com/app/api](http://www.maxmind.com/app/api)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-29T04:50:33.230

假设您使用的是 C#（来自标签），您可以使用[`BinaryReader`类](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.aspx)来读取二进制数据。请参阅[如何读取和写入二进制文件](http://www.tanguay.info/web/codeExample.php?id=817)：

```
FileStream fs = File.Open(Environment.CurrentDirectory + @"\settings.bin", FileMode.Open);
BinaryReader reader = new BinaryReader(fs);

long number = reader.ReadInt64();
byte[] bytes = reader.ReadBytes(3);
string s = reader.ReadString();

reader.Close();
fs.Close();

Console.WriteLine(number);
foreach (byte b in bytes)
{
    Console.Write("[{0}]", b);
}
Console.WriteLine();
Console.WriteLine(s); 
```

# delphi - 抽象方法的默认实现

> ID：325692
> 
> 赞同：2
> 
> 时间：2008-11-28T12:39:28.227
> 
> 标签：delphi, oop, abstract-methods

我正在处理一个大型代码库，其中有很多类和这些类上的很多抽象方法。我对人们对我在以下情况下应该做什么的看法感兴趣。

如果我有一个带有抽象方法的类 Parent-A。将只有2个孩子。如果 Child-B 实现 AbstractMethodA 但 Child-B 没有实现，因为它不适用。

我是不是该

1.  从 parent 中删除 abstract 关键字并使用 virtual 或 dynamic？
2.  提供该方法的空实现。
3.  提供一个在调用时会引发错误的实现。
4.  忽略警告。

编辑：感谢所有答案。它证实了我的怀疑，这不应该发生。经过进一步调查，结果发现这些方法根本没有使用，所以我完全删除了它们。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-28T12:44:09.340

如果 AbstractMethodA 不适用于 Child-B，则 Child-B 不应继承自 Parent-A。

或者相反，如果 Child-B 继承自 Parent-A，并且 AbstractMethodA 不适用于孩子，那么它也不应该在父母中。

通过在 Parent-A 中放置一个方法，您是说该方法适用于 Parent-A 及其所有子级。这就是继承的*意思*，如果你用它来表示不同的东西，你最终会和你的编译器发生严重的争论。

[编辑-也就是说，如果该方法确实适用，则 Mladen Prajdic 的回答很好，但对于所涉及的一个或多个类不应该做任何事情。什么都不做的方法在 IMO 与不适用的方法不同，但也许我们所说的“不适用”并不是指同一件事]

另一种技术是无论如何在 Child-B 中实现该方法，但让它做一些极端的事情，比如总是返回失败，或者抛出异常，或者其他什么。它可以工作，但应该被视为有点笨拙而不是干净的设计，因为这意味着调用者需要知道他们所拥有的被视为 Parent-A 的东西*真的是*一个child-B，因此他们不应该调用AbstractMethodA。基本上，您已经放弃了多态性，这是 OO 继承的主要好处。就我个人而言，我更喜欢这样做而不是在基类中实现抛出异常，因为这样子类就不会因为“忘记”实现该方法而“意外地”表现得不好。它必须实现它，如果它实现它不起作用，那么它会明确地这样做。糟糕的情况应该是嘈杂的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-28T12:47:11.707

如果后代中的实现不是强制性的，那么您应该选择 1+2（即祖先中的空虚方法）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T13:24:25.750

我认为，一般来说，如果您一开始就无法实现所有抽象方法，则不应该从抽象类继承，但我知道在某些情况下这样做仍然有意义，（请参阅Stream 类及其实现）。

我认为您应该只创建这些抛出 NotImplementedException 的抽象方法的实现。

您还可以尝试使用 ObsoleteAttribute 以便调用该特定方法将是编译时错误（当然除了抛出 NotImplementedException 之外）。请注意，ObsoleteAttribute 并不完全适用于此，但我想如果您使用带有注释的有意义的错误消息，没关系。

强制代码示例：

```
[Obsolete("This class does not implement this method", true)]
public override string MyReallyImportantMethod()
{
    throw new NotImplementedException("This class does not implement this method.");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T12:43:21.527

在基类中使其为虚拟空并在子类中覆盖它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T12:46:28.137

你可以使用接口。然后 Child-A 和 Child-B 都可以实现不同的方法，并且仍然从 Parent-A 继承。接口像抽象方法一样工作，因为它们强制类实现它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T13:01:37.123

如果 A 的某些子类 (B1, B2, ...) 与其他子类 (C1, C2, ...) 用于其方法的不同子集，则可能会说 A 可以分为 B 和 C。

我不太了解Delphi（一点也不了解:)），但我认为就像在Java 和COM 中一样，一个类可以“实现”多个接口。在 C++ 中，这只能通过多重继承抽象类来实现。

更具体：我将创建两个抽象类（带有抽象方法），并更改继承树。

如果这不可能，解决方法可能是“适配器”：一个中间类 A_nonB_，所有 B 方法都实现为空（并在调用它们时产生警告）和 A_nonC_。然后更改继承树以解决您的问题：B1，B2，...从 A_nonC_ 继承，C1，C2，...从 A_NonB_ 继承。

# c++ - Installer::OpenDatabase() 使用 msiOpenDatabaseModeTransact 产生类型错误

> ID：325706
> 
> 赞同：1
> 
> 时间：2008-11-28T12:44:47.467
> 
> 标签：c++, com, windows-installer

以下代码产生错误 hr=0x80020005（错误类型）。

```
#import <msi.dll>
using namespace WindowsInstaller;
main()
{
   ::CoInitialize(NULL);
   InstallerPtr pInstaller("WindowsInstaller.Installer");
   DatabasePtr pDB = pInstaller->OpenDatabase(
                "c:\\foo\\bar.msi", 
                msiOpenDatabaseModeTransact);
} 
```

我认为原因是在幕后，有 MsiOpenDatabase()，它将 LPCTSTR 作为第二个参数。第二个参数可以是 MSIDBOPEN_TRANSACT，其定义为

```
#define MSIDBOPEN_TRANSACT     (LPCTSTR)1 
```

我不知道是否可以提供具有良好内部类型的变体作为第二个参数。构造`_variant_t`函数做了很多检查，所以我不能轻易地将 int 伪装成 char* 。

有没有人尝试在 C++ 中使用这种方法？

**编辑：**

我的 msi.dll 版本是 3.1.4000.2805，我的系统是 XP SP 2，并且代码应该可以在任何装有 XP 或 Vista 的机器上运行。

欢迎使用 MSDN 文章的网址。

在同一台机器上，对低级等价物的调用：

```
MsiOpenDatabase("c:\\foo\\bar.msi", MSIDBOPEN_TRANSACT); 
```

完美运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T16:14:23.437

我终于在[msdn论坛上得到了答案](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/225c2a86-aa2e-4eab-b2be-0897c695eb7f/?ppud=4&ffpr=0)

```
DatabasePtr pDB = pInstaller->OpenDatabase(
                            "c:\\foo\\bar.msi", 
                            (long)msiOpenDatabaseModeTransact); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T08:20:20.617

MSDN 说[OpenDatabase](http://msdn.microsoft.com/en-us/library/aa370338(VS.85).aspx)从 MSI 4.0 版本开始可用，[事务](http://msdn.microsoft.com/en-us/library/bb736312(VS.85).aspx)一般从 MSI 4.5 开始。只是预感，但可能是您的 MSI 已过时？我曾经在过时的 MSI 版本上遇到过一些神秘的问题。

# debugging - 断点可以在 ISR 中使用吗？

> ID：325718
> 
> 赞同：4
> 
> 时间：2008-11-28T12:49:35.743
> 
> 标签：debugging, breakpoints, interrupt, isr

断点可以在中断服务例程 (ISR) 中使用吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-29T09:12:19.903

是的 -**在模拟器**中。

否则，没有。这很难实现，无论如何都是个坏主意。ISR（通常）应该与硬件一起使用，当您在每条指令之间留出半秒的间隙时，硬件的行为很容易就大不相同。

而是设置某种日志记录系统。

ISR 还从其他进程中不优雅地“窃取” CPU，因此许多操作系统建议将 ISR 保持在极短的时间内，并且只执行*严格*必要的操作（例如处理任何**紧急**的硬件问题，并安排一个能够正确处理事件的任务）。所以理论上，ISR 应该非常简单，不需要调试。

如果问题出在硬件行为上，请按照我的建议使用某种日志记录。如果硬件真的不介意指令之间的时间间隔很长，那么您可以在用户空间中编写大部分驱动程序 - 您*可以*使用调试器！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T23:33:17.877

根据您的平台，您可以通过访问处理器的调试端口来执行此操作，通常使用 JTAG 接口。请记住，您正在彻底改变与该方法的计时有关的所有内容，因此您的调试会话可能毫无用处。但是话又说回来，许多错误都可以通过这种方式捕获。还要注意基于 MMU 的内存映射，因为 JTAG 调试器通常不会考虑它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T23:53:52.830

在 Windows 中，通过附加[内核调试器](http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx)，您确实可以在中断处理程序中放置断点。

# integration - 流程设计真的是声明式编程吗？

> ID：325721
> 
> 赞同：1
> 
> 时间：2008-11-28T12:50:14.320
> 
> 标签：integration, weblogic, declarative, business-process

我从某人那里听说他们正在使用业务流程自动化工具（如 Weblogic 集成）作为一种编程语言（听起来有点愚蠢）来使事情具有声明性。然后他们将所有逻辑放入一个流程中，每一个`if`和`while`.

但是，过程不是一个如何一步一步地实现目标的实体吗？

对我来说，它使一个过程完全必要。你怎么看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T13:23:55.237

编排语言实际上是具有条件、循环和其他传统命令式结构的[命令式脚本语言](http://en.wikipedia.org/wiki/Imperative_programming)，通常通过基于流程图的用户界面来表示。他们当然不会（根据我的经验）实现尾递归函数式编程、反向链接或任何其他在普遍接受的意义上可能被合理地描述为声明性的范式。

MS Workflow Foundation 被宣传为具有规则引擎，但这相当简单，并没有真正进行前向链接，除非以某种迂回的方式。ILOG 实际上为他们的规则引擎制作了一个适配器，专门用于将其放入 MS 工作流基础。

其他工作流工具具有更好的规则引擎和适当的前向链接系统，可以被视为声明性的。但是，一旦您使用循环和条件分支进入工作流本身，您就绝对处于命令式编程的领域。

然而，一些系统也为工作流实现了基于 petri-net 或状态变化的标记系统，这可能被合理地描述为声明性的，但它们仍然具有与底层系统交互的命令式模式。它们仍然会更新变量并具有副作用。

我见过一两个应用程序（例如[用于数据分析的 TOAD](http://www.quest.com/toad-for-data-analysts/)）实际上使用 MS Workflow Foundation 作为脚本语言。因此，它允许您向应用程序添加一个脚本工具，该工具（至少出于营销目的）不需要使用编程技能。

在实践中，为编写、编辑和运行 SQL 查询而设计的工具配备了面向“非程序员”的脚本框架，这让人们想知道它的真正目标受众是什么。作为一种脚本语言，工作流建模工具相当笨拙，提供的抽象机会非常有限；在实践中，基于 .Net 的脚本语言（例如 IronPython 或 Boo），特别是与体面的模板机制相结合，将是对此类工具的非常强大的补充。

关于这种图形语言的一点是它们不能很好地适应复杂性。类似的问题也适用于 ETL 工具。我看到了一个使用 Crossworlds（现在称为 Websphere Integrator）（讽刺地）完成的配置应用程序（见下文）。在应用程序启动后的一个月内，很明显图形工作流语言无法随着应用程序的复杂性而扩展，并且基于用 Java 编写的自定义规则引擎和相当大的定制程序重新构建了它爪哇代码。

这种类型的问题在 EAI 和编排系统中并不少见，也是[SOA](http://en.wikipedia.org/wiki/Service-oriented_architecture)在实践中难以实施的原因之一。您正在做的实际上是将业务逻辑推入一个非常笨拙的编程环境中，而该环境并未得到官方认可。这将在一个简单的情况下工作，但很难在一个复杂的系统上工作——这在 SOA 圈子中是一个有罪的秘密。

**Coda：** 配置应用程序是一个系统，它为电信服务合同（在本例中为移动电话网络）制定计划，并根据规则将配置信息推送到各种交换机、计费应用程序和其他应用程序。它们往往相当复杂。当您购买一个每月有这么多分钟和这么多文本的手机计划时，配置应用程序会将有关您的访问和计费规则的配置信息推送到系统的其余部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T13:24:24.643

这绝对不是人们谈论[声明式编程](http://en.wikipedia.org/wiki/Declarative_programming)时通常所说的意思，即使在某种意义上可以称为声明式编程。

# .net - 选择性地从 LINQ 表达式树中的 where 子句中删除

> ID：325725
> 
> 赞同：2
> 
> 时间：2008-11-28T12:51:34.397
> 
> 标签：.net, linq

从以下 LINQ 查询开始：

```
from a in things  
where a.Id == b.Id &&  
a.Name == b.Name &&  
a.Value1 == b.Value1 &&  
a.Value2 == b.Value2 &&  
a.Value3 == b.Value3  
select a; 
```

如何（在运行时）删除 where 子句中的一个或多个条件以获得类似于以下查询的查询：

```
from a in things  
where a.Id == b.Id &&  
a.Name == b.Name &&  
a.Value2 == b.Value2 &&  
a.Value3 == b.Value3  
select a; 
```

或者

```
from a in things  
where 
a.Name == b.Name &&  
a.Value3 == b.Value3  
select a; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-28T13:01:46.060

我不会尝试更改现有的 where 子句，而是将其重构为：

```
from a in things  
where a.Id == b.Id 
where a.Name == b.Name 
where a.Value1 == b.Value1
where a.Value2 == b.Value2
where a.Value3 == b.Value3  
select a; 
```

然后变成：

```
things.Where(a => a.Id == b.Id)
      .Where(a => a.Name == b.Name)
      .Where(a => a.Value1 == b.Value1)
      .Where(a => a.Value2 == b.Value2)
      .Where(a => a.Value1 == b.Value3); 
```

现在应该相当清楚如何进行 - 对 Where 的调用有条件：

```
IQueryable<Whatever> query = things;
if (useId) {
    query = query.Where(a => a.Id == b.Id);
}
query = query.Where(a => a.Name == b.Name);
if (checkValue1) {
    query = query.Where(a => a.Value1 == b.Value1);
}
// etc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T13:15:31.837

这也可能是另一种方法；

```
bool executeValue1Condition = true;
bool executeValue2Condition = true;
bool executeValue3Condition = true;

var q = from a in things  
where a.Id == b.Id &&  
a.Name == b.Name &&  
(a.Value1 == b.Value1 || executeValue1Condition) &&  
(a.Value2 == b.Value2 || executeValue2Condition) &&  
(a.Value3 == b.Value3 || executeValue3Condition) 
select a;

executeValue1Condition = false;
q = q.Select(i => i); 
```

而且通过使用这种方法，您可以在执行查询后更改您的条件，当然也可以通过新的执行来更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T13:21:45.943

尝试将事物分开。首先将 where 条件与查询的其余部分隔离，然后对其进行处理并使用标准查询方法而不是内置的语法糖。例如。：

```
 IQueryable<MyClass> things = null;
     MyClass b = new MyClass();

     Expression<Func<MyClass, bool>> whereExp = a => a.Id == b.Id && a.Name == b.Name;
     // process where expression here. it's just an expression tree. traverse it and
     // remove nodes as desired.
     var result = things.Where(whereExp).Select(a => a); 
```

实现这一点的另一种更简单的模式不是从完整的表达式开始并删除事物，而是从部分组成一个。例如。：

```
IQueryable<MyClass> things = null;
MyClass b = new MyClass();

Expression<Func<MyClass, bool>> whereExp;
Expression<Func<MyClass, bool>> exp1 = a => a.Id == b.Id;
Expression<Func<MyClass, bool>> exp2 = a => a.Name == b.Name;
whereExp = Expression.Lambda<Func<MyClass, bool>>(Expression.And(exp1, exp2), Expression.Parameter(typeof(MyClass), "a"));

var result = things.Where(whereExp).Select(a => a); 
```

# objective-c - -(void)dealloc 中的 NSZoneFree 是怎么回事？

> ID：325733
> 
> 赞同：4
> 
> 时间：2008-11-28T12:58:51.840
> 
> 标签：objective-c, cocoa, memory

在 Apple 的 NSObject 文档中，在 - (void)dealloc 示例代码中调用了 NSZoneFree：

```
- (void)dealloc {
    [companion release];
    NSZoneFree(private, [self zone])
    [super dealloc];
} 
```

[您可以在此处](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html#//apple_ref/doc/uid/20000050-dealloc)的上下文中找到它。

我从来没有想过我应该在我自己的 NSObject 子类（或什么 NS_WhateverClass_ 子类）中调用 NSZoneFree，并且在文档中的任何地方都找不到关于该主题的任何结论。

关于使用 NSZoneFree，我所能找到的只是[内存管理编程指南中的一个简短提及，以及](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/Concepts/Zones.html)[Foundation Functions Reference](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/c/func/NSZoneFree)中对该函数的解释，但是这些文档都没有让我清楚我是否应该在上下文中担心它一个dealloc方法。

谁能澄清我什么时候应该在我自己的类的 dealloc 实现中调用 NSZoneFree ？

编辑：感谢您的回复，我现在更清楚了 :) — Dirk

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-29T03:26:19.233

`NSZoneFree()`平衡对 的调用`NSZoneMalloc()`，就像`-release`平衡对`-alloc`or的调用`-copy`和`CFRelease()`平衡对 or 的调用`CFRetain()`一样`CF*Create*()`，平衡对or`free()`的调用。`malloc()``calloc()`

鉴于 C 库在 Mac OS X 上使用的分配器，其中大部分是学术性的，但最佳实践表明您释放内存的方式与获得它的方式相同，在该类的情况下，实例变量`private`之前已分配给`NSZoneMalloc()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T13:34:54.357

根据[基金会参考](https://developer.apple.com/iphone/library/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Foundation_Functions.pdf)：

> 将内存返回到分配它的区域。标准 C 函数 free 的作用相同，但会花时间查找内存属于哪个区域。

因此，在清理 malloc'd 和 calloc'd 内存时，您基本上使用 NSZoneFree() 而不是 free()。但是，您通常不需要调用它。

# c++ - 将相似类型的成员变量分组在一起

> ID：325734
> 
> 赞同：1
> 
> 时间：2008-11-28T12:59:02.667
> 
> 标签：c++

在编写类时，您是否将相同类型的成员变量分组在一起？这样做有什么好处吗？例如：

```
class Foo
{
private:
    bool a_;
    bool b_;
    int c_;
    int d_;
    std::string e_;
    std::string f_;
    ...
}; 
```

相对于：

```
class Bar
{
private:
    std::string e_;    
    bool a_;
    int d_;
    bool b_;
    std::string f_;
    int c_;    
    . 
```

.. };

还是您只是按照添加的顺序拥有它们？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-28T13:02:55.903

我根据语义对它们进行分组，即

```
class Foo
{
private:
    std::string peach;
    bool banana;
    int apple;

    int red;
    std::string green;
    std::string blue;
    ...
}; 
```

越可读越好。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-28T13:00:25.597

您应该按照您希望它们初始化的顺序来设置它们，因为这是它们将被初始化的顺序，无论您在构造函数中的初始化程序列表如何。也不是所有的编译器都会警告你不一致的地方。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-28T13:09:01.070

如果您关心对象的大小，并且如果编译器不对类中的成员重新排序（如果成员之间没有访问说明符，则不得重新排序），那么如果出现以下情况，对象可能会变小你从大到小排列你的成员。原因是不太可能需要填充来满足对齐要求。这种排序将导致相同类型的成员更接近。

与代码清晰度相比，这通常会失败。与初始化顺序相比，它当然总是失败（尽管您可以添加访问说明符并希望最好）。但你确实问过是否有*任何*好处。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-28T14:06:31.377

1.  在语义上分组。
2.  如果您需要在语义上进行分组，那就是代码异味。提取一个类。幸运的是，相关成员已经在一个组中，因此很容易选择合适的成员进行移动。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-28T15:27:51.990

来自史蒂夫麦康奈尔的代码完成，p762：-

> **合理地对声明**进行排序： ... 按类型分组通常是明智的，因为相同类型的变量往往会在相关操作中使用... 如果您的变量列表太长以至于按字母顺序排序会有所帮助，那么您的例程可能太大了。

此外，在上一页中，他采用了我之前回答的风格，显示多个声明“拥挤”在一行中......

```
bool a_, b_, c_; 
```

...带有“编码恐怖”图标。所以我正在重新考虑这种方法。感谢评论者让我重新评估这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T14:09:40.433

在大多数情况下，结构中的成员不应过多。

如果你这样做，也许你应该考虑子结构......

我知道有例外，但作为一般经验法则，尽量保持你的结构小。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-28T14:27:03.143

按有效优先级顺序：

0）如果成员之间在构造上存在依赖关系，或者如果成员需要按特定顺序构造：按照您希望执行的构造顺序声明它们。在构造上，成员构造的唯一顺序是类中声明的成员顺序。

0.5）如果类实例对象大小很重要（您想要这种类型的最小大小 - 但不要进行早期优化！），对于某些编译器，最好按大小顺序排列您的成员，第一个越大，用于字节对齐或其他类似的编译行为。

1）首先优先考虑清晰度：首先为读者​​编写（明确，按主题/目的组排序等），然后为编译器编写（可能遵循之前的建议）。

在几乎所有情况下，只有 1) 是重要的。更喜欢主题、目的和“同一系统的组合”来对成员进行分组，而不是按类型分组。

注意：如果您按系统对成员进行分组并且您看到有很多组，那么您应该将这些系统封装在类中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-28T15:11:13.820

关于排序变量的一些原因，我同意其他人的观点，但除此之外，我喜欢看到对类在开始附近运行最重要的变量，以及在结尾附近不太重要的变量。如果您有其他理由来覆盖它，那很好，但是当其他事情失败时，这就是我所做的。

当然，这通常是通过按照我出现的顺序声明变量来结束的。最重要的变量是我首先想到的变量，以及我在实际编写类实现时遇到的其他变量。

# continuous-integration - 如何在提交之前自动化或促进多平台构建/测试？

> ID：325743
> 
> 赞同：5
> 
> 时间：2008-11-28T13:06:40.777
> 
> 标签：continuous-integration, build-automation, cruisecontrol, pre-commit

我们的软件建立在 linux 和 windows 平台上。根据开发人员的偏好，在任一平台上开发和测试贡献，然后提交到我们的 subversion 存储库。然后事实证明，该贡献并未建立在其他平台上，因此必须进行修复。其他平台上的修复可能会再次破坏原始平台上的构建，依此类推。

我宁愿看到在提交之前也在另一个平台上构建了一个贡献（并进行了回归测试）。我们有一个持续构建服务器 (CruiseControl)，但该服务器是从存储库构建的。我正在寻找一种解决方案，其中连续构建服务器在另一个平台上构建作为预提交检查，然后在构建和测试成功时提交内容。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-28T13:15:35.893

Teamcity 处理预先测试的提交，您可以使用 4.0 中的新构建链接功能做一些事情（[http://www.jetbrains.com/teamcity/features/newfeatures.html](http://www.jetbrains.com/teamcity/features/newfeatures.html)）。代理是跨平台的，可以配置为仅运行构建的特定位，因此可以配置为仅运行一部分测试。

请注意，我实际上并没有这样做:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T13:09:44.627

拥有两个分支可能更容易，一个是人们签入的地方，另一个是他们在通过持续集成后将更改合并到的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T13:18:21.830

我们使用了一个定制的构建和测试平台，可以远程部署到多个操作系统（以及多个操作系统上的多个数据库产品）。这是作为夜间构建完成的，规则是您在第二天早上修复错误。

那时不是完全连续的，但这可能需要在预提交挂钩上做很多工作。特别是如果您的源代码控制存储库在预提交挂钩执行期间锁定受影响的文件。

我认为在白天运行的持续集成测试（每次提交）和每晚运行的系统集成测试是有区别的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T20:46:49.663

Matheiu Godlewski 在[CruiseControl wiki上提出了一个很好的建议](http://confluence.public.thoughtworks.org/display/CC/MultiplePlatforms)

如果你将他的建议与[否决](http://cruisecontrol.sourceforge.net/main/configxml.html#veto)元素结合起来，我认为你应该被设置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T21:00:27.373

Douglas Leeder 提出了一个“集成”分支——它的好处是可以实现自动化。如果测试通过 - 合并到“主干”。

一些版本控制系统（例如 bzr/hg/git）比其他系统更容易做到这一点，但在大多数情况下都是可能的。

# .net - 如何将 GUID 作为属性参数？

> ID：325756
> 
> 赞同：8
> 
> 时间：2008-11-28T13:13:28.563
> 
> 标签：.net, attributes, guid

我需要一些属性类中的 Guid 属性，如下所示：

```
public class SomeAttribute : Attribute {
    private Guid foreignIdentificator;
    public Guid ForeignIdentificator {
        get { return this.foreignIdentificator; }
        set { this.foreignIdentificator = value; }
    }
} 
```

但是在属性定义中，我只能使用原始类型，它们是常量（我理解为什么，这让我很有意义）。解决方法可以将“ForeignIdentificator”定义为字符串，并在运行时创建 Guid：

```
public class SomeAttribute : Attribute {
    private string foreignIdentificator;
    public string ForeignIdentificator {
        get { return this.foreignIdentificator; }
        set { this.foreignIdentificator = value; }
    }
    public Guid ForeignIdentificatorGuid {
        get { return new Guid( ForeignIdentificator ); }
    }
} 
```

Unahppily 我放松检查类型安全。“ForeignIdentificator”属性可以包含任何字符串值，并且在创建 Guid 期间将在运行时抛出异常，而不是在编译时。

我知道编译器会检查“System.Runtime.InteropServices.GuidAttribute”的字符串值以获取“Guid 兼容性”。这个检查正是我需要的，但我不知道这个检查是我在编译器中硬编码还是我可以明确定义（以及如何）。

您是否知道某种方式，如何确保“Guid 兼容性”检查属性？或者其他方式，如何在属性中达到类型安全的 Guid 定义？谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-28T13:26:37.617

我过去遇到过你的确切问题。我们只是要求他们将 GUID 作为字符串传递...这是 VS GUID 生成器工具提供给我们的默认方式 (*F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4)。我们基本上做了你所做的。我们在插件架构中使用它，因此我们的客户一直是使用该接口的人。如果你看看微软在他们需要做同样的事情时做了什么，他们就会这样做。

这样做没有问题。不止一次，我们是否将其视为该领域的问题。

不过，您可能希望将该字符串字段命名为 GUID，以免混淆您的消费者。添加一些文档以防他们不知道它需要采用什么格式。

当我看到这个时，我有同样的反应......但后来我继续前进，因为似乎没有类型安全的解决方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-28T13:46:20.323

属性参数必须是常量。如果我违反规则，我的 C# 编译器会给出以下错误：

> 属性参数必须是属性参数类型的常量表达式、typeof 表达式或数组创建表达式

由于 C# 中没有 GUID 文字，因此您必须将 GUID 编码为另一种格式，例如字符串。但是，您并不完全在海上：您可以使您的属性具有采用您想要的格式的 ctor。这是一个与 ctors 相同的示例`System.Guid`：

```
[AttributeUsage(AttributeTargets.All, Inherited = false, AllowMultiple = true)]
sealed class MyGuidAttribute : Attribute
{
    public Guid Guid { get; private set; }

    //
    // Summary:
    //     Initializes a new instance of the System.Guid class using the specified array
    //     of bytes.
    //
    // Parameters:
    //   b:
    //     A 16 element byte array containing values with which to initialize the GUID.
    //
    // Exceptions:
    //   System.ArgumentNullException:
    //     b is null.
    //
    //   System.ArgumentException:
    //     b is not 16 bytes long.
    public MyGuidAttribute(byte[] b)
    {
        this.Guid = new Guid(b);
    }
    //
    // Summary:
    //     Initializes a new instance of the System.Guid class using the value represented
    //     by the specified string.
    //
    // Parameters:
    //   g:
    //     A System.String that contains a GUID in one of the following formats ('d'
    //     represents a hexadecimal digit whose case is ignored): 32 contiguous digits:
    //     dddddddddddddddddddddddddddddddd -or- Groups of 8, 4, 4, 4, and 12 digits
    //     with hyphens between the groups. The entire GUID can optionally be enclosed
    //     in matching braces or parentheses: dddddddd-dddd-dddd-dddd-dddddddddddd -or-
    //     {dddddddd-dddd-dddd-dddd-dddddddddddd} -or- (dddddddd-dddd-dddd-dddd-dddddddddddd)
    //     -or- Groups of 8, 4, and 4 digits, and a subset of eight groups of 2 digits,
    //     with each group prefixed by "0x" or "0X", and separated by commas. The entire
    //     GUID, as well as the subset, is enclosed in matching braces: {0xdddddddd,
    //     0xdddd, 0xdddd,{0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd}} All braces, commas,
    //     and "0x" prefixes are required. All embedded spaces are ignored. All leading
    //     zeroes in a group are ignored.  The digits shown in a group are the maximum
    //     number of meaningful digits that can appear in that group. You can specify
    //     from 1 to the number of digits shown for a group. The specified digits are
    //     assumed to be the low order digits of the group.
    //
    // Exceptions:
    //   System.ArgumentNullException:
    //     g is null.
    //
    //   System.FormatException:
    //     The format of g is invalid.
    //
    //   System.OverflowException:
    //     The format of g is invalid.
    public MyGuidAttribute(string g)
    {
        this.Guid = new Guid(g);
    }
    //
    // Summary:
    //     Initializes a new instance of the System.Guid class using the specified integers
    //     and byte array.
    //
    // Parameters:
    //   a:
    //     The first 4 bytes of the GUID.
    //
    //   b:
    //     The next 2 bytes of the GUID.
    //
    //   c:
    //     The next 2 bytes of the GUID.
    //
    //   d:
    //     The remaining 8 bytes of the GUID.
    //
    // Exceptions:
    //   System.ArgumentNullException:
    //     d is null.
    //
    //   System.ArgumentException:
    //     d is not 8 bytes long.
    public MyGuidAttribute(int a, short b, short c, byte[] d)
    {
        this.Guid = new Guid(a, b, c, d);
    }
    //
    // Summary:
    //     Initializes a new instance of the System.Guid class using the specified integers
    //     and bytes.
    //
    // Parameters:
    //   a:
    //     The first 4 bytes of the GUID.
    //
    //   b:
    //     The next 2 bytes of the GUID.
    //
    //   c:
    //     The next 2 bytes of the GUID.
    //
    //   d:
    //     The next byte of the GUID.
    //
    //   e:
    //     The next byte of the GUID.
    //
    //   f:
    //     The next byte of the GUID.
    //
    //   g:
    //     The next byte of the GUID.
    //
    //   h:
    //     The next byte of the GUID.
    //
    //   i:
    //     The next byte of the GUID.
    //
    //   j:
    //     The next byte of the GUID.
    //
    //   k:
    //     The next byte of the GUID.
    public MyGuidAttribute(int a, short b, short c, byte d, byte e, byte f, byte g, byte h, byte i, byte j, byte k)
    {
        this.Guid = new Guid(a, b, c, d, e, f, g, h, i, j, k);
    }
    //
    // Summary:
    //     Initializes a new instance of the System.Guid class using the specified unsigned
    //     integers and bytes.
    //
    // Parameters:
    //   a:
    //     The first 4 bytes of the GUID.
    //
    //   b:
    //     The next 2 bytes of the GUID.
    //
    //   c:
    //     The next 2 bytes of the GUID.
    //
    //   d:
    //     The next byte of the GUID.
    //
    //   e:
    //     The next byte of the GUID.
    //
    //   f:
    //     The next byte of the GUID.
    //
    //   g:
    //     The next byte of the GUID.
    //
    //   h:
    //     The next byte of the GUID.
    //
    //   i:
    //     The next byte of the GUID.
    //
    //   j:
    //     The next byte of the GUID.
    //
    //   k:
    //     The next byte of the GUID.
    [CLSCompliant(false)]
    public MyGuidAttribute(uint a, ushort b, ushort c, byte d, byte e, byte f, byte g, byte h, byte i, byte j, byte k)
    {
        this.Guid = new Guid(a, b, c, d, e, f, g, h, i, j, k);
    }
} 
```

# sharepoint - Sharepoint 搜索，从 OSSSearchResults.aspx 重定向到搜索中心

> ID：325757
> 
> 赞同：1
> 
> 时间：2008-11-28T13:15:00.433
> 
> 标签：sharepoint, search

我对 Sharepoint 中搜索页面的配置有疑问。有两种类型的搜索：

1.  仅在当前页面或列表中搜索的上下文（它们被标记为：此站点：站点名称或此列表：列表名称），它们指向 OSSSearchResults.aspx 页面
2.  可以用户定义的自定义搜索，它们指向搜索中心

自定义搜索不是问题，因为可以轻松修改搜索中心，但是使用上下文搜索存在问题。

那么，有没有办法配置共享点，即使使用上下文搜索，它也会将用户发送到搜索中心？

我知道我可以在 OSSSearchResults.aspx 中插入一些 javascript 或创建 HttpHandler 来自动重定向他，但我想知道是否有更多的本地解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T16:13:10.840

我写[了一篇文章](http://www.sharepointusecases.com/index.php/2008/11/configuring-scopes-dropdown/)，可以帮助您配置它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-28T09:54:09.313

在 SharePOint 2013 - 转到站点设置-> 搜索设置-> 输入搜索中心 url-> 勾选 -> 使用与我的父级相同的结果页面设置。

*   配置搜索导航：

*   一切-> /sites/searchcenter/Pages/results.aspx

希望这有帮助

# jquery - jQuery AJAX - 使浏览器在重定向标头中请求新位置

> ID：325765
> 
> 赞同：3
> 
> 时间：2008-11-28T13:21:15.040
> 
> 标签：jquery, ajax

jQuery ajax 可以让浏览器在服务器发送的重定向标头中请求一个新位置吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-28T15:31:39.723

您应该解析代码并使用 Javascript 来设置 document.location

```
$.get('page.php', { GETvar : 'redirectUrl' }, function(data, textString){  
 if (textString == "succes") { //Succes!
  document.location = data;
 }
 else{ // failure }
}); 
```

如果您的 PHP 脚本返回一个有效的 url，这会将位置设置为该 url。

**编辑**
您也可以像这样使用隐藏的 iFrame：
html：

```
     <iframe src="blank.html" name='hiddenframe' id='hiddenframe' onload='readyLoad()'>

```

然后像这样使用一些Javascript

```
var first = true;
function setRedirect (url) {
 hiddenframe.location = url;
}
function readyLoad() {
 if( first == true ) { first = false; return false; }
 else {
 alert( 'ready loading, was redireced too:' + myFrame.location.href );
 //Use new location code
}
} 
```

您应该使用 jQuerys 内置函数将这些函数包装到漂亮的小事件处理程序中（它们很棒）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T16:08:53.280

jQuery 做了它应该做的事情：自动跟随重定向并去获取最终页面。

你可以去[http://jigsaw.w3.org/HTTP/300/](http://jigsaw.w3.org/HTTP/300/)测试一下。在那里打开firebug并通过编辑HTMLhead并添加在页面中注入jquery

```
<script type="text/javascript" src="http://jqueryjs.googlecode.com/files/jquery-1.2.6.js"/> 
```

给它。然后去控制台运行

```
$.get("http://jigsaw.w3.org/HTTP/300/301.html", function(r){
    alert(r);
}); 
```

并且警报显示重定向页面的 HTML（与您所在的页面相同）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T13:46:21.993

没有尝试过 jQuery，快速浏览一下文档并不能真正告诉我重定向响应的处理方式。但是在 Prototype JS 中，除了 2xx "Success" 之外的任何响应代码都是 onFailure 事件，因此重定向是失败的。您可能可以（以某种方式）解析错误块中的响应以查看它是什么代码并获取地址，您可以将 document.location 设置为...但这听起来不太安全或不实用。

打印某种错误更为常见。或者，如果请求需要登录用户，则假定会话已超时并重定向到登录页面。

# delphi - 调试时，Delphi ADO 与 DBF 文件的连接挂起

> ID：325774
> 
> 赞同：2
> 
> 时间：2008-11-28T13:27:40.160
> 
> 标签：delphi, odbc, ado, dbf, dbase

我正在使用 Delphi 2009 ADO 组件和此连接字符串连接到 DBF 文件：

```
Driver={Microsoft dBASE Driver (*.dbf)};DriverID=277;Dbq=c:\mypath; 
```

如果 c:\mypath 不存在，并且我在调试器中运行应用程序，我的应用程序将挂起。没有引发异常。

如果我在没有调试的情况下运行应用程序，则会正确引发异常。

为了重现，我只是创建了一个新应用程序，在表单上放置了一个 TADOConnection，设置连接字符串并将此代码添加到表单的 OnCreate 中：

```
ADOConnection1.Connected := True; 
```

有任何想法吗？

# c# - 如何在运行时更新配置文件中的 assemblyBinding 部分？

> ID：325788
> 
> 赞同：12
> 
> 时间：2008-11-28T13:35:38.707
> 
> 标签：c#, .net, configuration

我正在尝试动态更改程序集绑定（从一个版本到另一个版本）。

我试过这段代码，但它不起作用：

```
 Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
      ConfigurationSection assemblyBindingSection = config.Sections["assemblyBinding"];

      assemblyBindingSection.SectionInformation.ConfigSource = "bindingConf.xml";
      config.Save(ConfigurationSaveMode.Modified);

      ConfigurationManager.RefreshSection("assemblyBinding"); 
```

包含`bindingConf.xml`assemblyBinding 部分配置。

那么可以在运行时更改此部分吗？怎么做？我有什么选择？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-28T15:19:31.713

我发现动态绑定到不同版本的程序集的最佳方法是挂钩`AppDomain.AssemblyResolve`事件。每当运行时无法找到链接应用程序的确切程序集时，就会触发此事件，并且它允许您提供另一个您自己加载的程序集（只要它兼容）。

例如，您可以在应用程序的主类上放置一个静态构造函数，该构造函数像这样挂钩事件：

```
using System.Reflection;

static Program()
{
    AppDomain.CurrentDomain.AssemblyResolve += delegate(object sender, ResolveEventArgs e)
    {
        AssemblyName requestedName = new AssemblyName(e.Name);

        if (requestedName.Name == "AssemblyNameToRedirect")
        {
            // Put code here to load whatever version of the assembly you actually have

            return Assembly.LoadFrom("RedirectedAssembly.DLL");
        }
        else
        {
            return null;
        }
    };
} 
```

这种方法避免了处理配置文件中的程序集绑定的需要，并且在您可以用它做什么方面更加灵活。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T08:33:19.970

使用以下代码在运行时更新配置文件的 RuntimeSection：

```
private void ModifyRuntimeAppConfig()
{
  XmlDocument modifiedRuntimeSection = GetResource("Framework35Rebinding");

  if(modifiedRuntimeSection != null)
  {
    Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
    ConfigurationSection assemblyBindingSection = config.Sections["runtime"];

    assemblyBindingSection.SectionInformation.SetRawXml(modifiedRuntimeSection.InnerXml);
    config.Save(ConfigurationSaveMode.Modified);
    ConfigurationManager.RefreshSection("runtime");
  }
} 
```

使用 Framework35Rebinding 包含：

```
<runtime>
  <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
    <dependentAssembly>
      <assemblyIdentity name="Microsoft.Build.Framework" publicKeyToken="b03f5f7f11d50a3a" culture="neutral"/>
      <bindingRedirect oldVersion="0.0.0.0-99.9.9.9" newVersion="3.5.0.0"/>
    </dependentAssembly>
    <dependentAssembly>
      <assemblyIdentity name="Microsoft.CompactFramework.Build.Tasks" publicKeyToken="b03f5f7f11d50a3a" culture="neutral"/>
      <bindingRedirect oldVersion="0.0.0.0-99.9.9.9" newVersion="9.0.0.0"/>
    </dependentAssembly>
  </assemblyBinding>
</runtime> 
```

和一个 app.config 包含（在程序执行之前）：

```
<?xml version="1.0"?>
<configuration>
  <startup>
    <supportedRuntime version="v2.0.50727"/>
  </startup>
  <runtime>
  </runtime>
</configuration> 
```

尽管如此，它并不适用于我想做的事情，因为 assemblyBinding 仅在应用程序启动时读取，而`RefreshSection("runtime")`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-03-19T16:48:12.983

我喜欢埃里克的回答。在尝试将新的有缺陷的 NuGet PackageReference 模型与 Web 应用程序一起使用时，它是救命稻草。问题是您可以让 msbuild 自动生成绑定，但是它们会生成与 Assembly.dll.config 的绑定，而不是与 web.config 的绑定。所以这个解决方法很棒。

我对 Eric 的代码进行了一些修改，使其更通用并与 ASP.Net Core 应用程序一起使用：

```
AppDomain.CurrentDomain.AssemblyResolve += delegate (object sender2, ResolveEventArgs e2)
            {
                var requestedNameAssembly = new AssemblyName(e2.Name);
                var requestedName = requestedNameAssembly.Name;
                if (requestedName.EndsWith(".resources")) return null;
                var binFolder = System.Web.Hosting.HostingEnvironment.MapPath("~/bin");
                var fullPath = Path.Combine(binFolder, requestedName) + ".dll";
                if (File.Exists(fullPath))
                {
                    return Assembly.LoadFrom(fullPath);
                }

                return null;
            }; 
```

# php - 哪个是使用mysql实时双向同步动态数据的最佳方法

> ID：325791
> 
> 赞同：11
> 
> 时间：2008-11-28T13:37:40.577
> 
> 标签：php, mysql, database, synchronization, data-synchronization

这是场景。两个不同位置的 2 个 Web 服务器，具有两个具有相同表的 mysql 数据库。表中的数据也应该是实时相同的。

这是问题所在。如果任一位置的用户同时将新记录输入到相同的表中，如下面的前两个表所示，其中每个表中的第三个记录已由不同的人同时输入。表中的数据不再相同。如下表第三张所示，无论更新发生在何处，保持数据实时保持一致的最佳方法是什么？这样在下面的插图中，而不是在每个表中以 3 行结束，新记录被双向复制，并且它们被插入到两个表中以再次创建 2 个相同的表，这次有 4 列？

```
Server A in Location A
==============

Table Names
| ID| NAME  |
|-----------|
| 1 | Tom   |
| 2 | Scott |
|-----------|
| 3 | John  |
|-----------|

Server B in Location B
==============
Table Names
| ID| NAME  |
|-----------|
| 1 | Tom   |
| 2 | Scott |
|-----------|
| 3 | Peter |
|-----------|

Expected Scenario
===========
Table Names
| ID| NAME  |
|-----------|
| 1 | Tom   |
| 2 | Scott |
| 3 | Peter |
| 4 | John  |
|-----------| 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-28T14:13:53.997

在两个主服务器上复制数据库不会获得太多性能。但是，如果您对应用程序进行正确编码，则会有一些非常好的故障转移。

Master-Master 设置本质上与 Slave-Master 设置相同，但都启动了 Slaves，并对每个盒子上的配置文件进行了重要更改。

掌握 MySQL 1：

```
auto_increment_increment = 2
auto_increment_offset = 1 
```

掌握 MySQL 2：

```
auto_increment_increment = 2
auto_increment_offset = 2 
```

这两个参数确保当两台服务器出于某种原因争夺主键时，它们不会复制并终止复制。默认情况下，任何自动增量字段都不会递增 1，而是默认递增 2。在一个盒子上，它将从 1 开始偏移并运行序列 1 3 5 7 9 11 13 等。在第二个盒子上，它将从 2 开始偏移并沿着 2 4 6 8 10 12 等运行。从当前测试来看，自动增量似乎采用下一个空闲数字，而不是之前留下的数字。
例如，如果服务器 2 插入第 4 条记录时，服务器 1 插入前 3 条记录（1 3 和 5），它将被赋予 6 的键（不是 2，未使用）。

设置完成后，将它们都作为奴隶启动。
然后检查两者是否正常工作，连接到两台机器并执行命令`SHOW SLAVE STATUS`，你应该注意两者`Slave_IO_Running`并且`Slave_SQL_Running`都应该在每个框上都说“是”。

然后，当然，在表中创建几条记录，并确保一个框只插入奇数主键，另一个只增加偶数主键。

然后进行所有测试以确保您可以在每个盒子上执行所有标准应用程序，并将其复制到另一个盒子。

一旦它开始，它就相对简单。
但正如已经提到的，MySQL 确实不鼓励这样做，并建议您确保在编写应用程序代码时注意此功能。

**编辑：**我想如果你确保偏移量是正确的等等，理论上可以添加更多的主人。不过，您可能会更现实地添加一些额外的奴隶。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-28T13:57:32.203

MySQL 不支持同步复制，但是，即使支持，您也可能不想使用它（不能承受等待其他服务器在每次事务提交时同步的性能损失）。

您将不得不考虑更合适的架构解决方案 - 有第三方产品将以预定方式进行合并和解决冲突 - 这是唯一的方法。

期望您的架构以这种方式运行是天真的 - 任何数据库都没有“简单的修复”，而不仅仅是 MySQL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T13:49:40.677

UID 相同是否重要？或者您是否会考虑将远程 UID 映射到本地 UID 的表或列，并为您希望复制的对象编写自定义同步代码，从而对外键列的 UID 进行任何必要的映射等？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T13:45:45.707

确保表同步的唯一方法是在数据库之间设置双向复制。

但是，MySQL 只允许单向复制，因此您不能简单地解决此配置中的问题。

需要明确的是，您可以“设置”双向复制，但 MySQL AB[不鼓励这样做](http://dev.mysql.com/doc/refman/5.0/en/replication-faq.html#qandaitem-17-3-4-5)。

# performance - 使用存储过程是否有很大的性能提升？

> ID：325803
> 
> 赞同：7
> 
> 时间：2008-11-28T13:49:04.703
> 
> 标签：performance, stored-procedures

使用存储过程还是使用连接字符串和所有好东西的旧方法更好？我们的系统最近运行缓慢，我们的经理希望我们尝试看看是否可以加快速度，我们正在考虑将一些旧的数据库调用更改为存储过程。这值得么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-28T13:52:14.773

首先要做的是检查数据库是否设置了所有必要的索引。分析您的代码慢的地方，并检查相关的 SQL 语句和与之相关的索引。看看是否可以重写 SQL 语句以提高效率。检查您是否没有为循环中的每个迭代重新编译 SQL（准备好的）语句，而不是在它之外一次。

将 SQL 语句移动到存储过程中，如果执行效率非常低下，将无济于事。但是，数据库将知道如何最好地优化 SQL，并且不需要重复执行此操作。它还可以通过将复杂的 SQL 语句转换为简单的过程调用来使客户端代码更简洁。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-28T13:58:04.310

我会快速看一下[Stored Procedures are EVIL](http://www.tonymarston.net/php-mysql/stored-procedures-are-evil.html)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-28T13:53:20.560

只要您的调用是一致的，数据库就会存储执行计划（无论如何是 MS SQL）。使用存储过程的最强烈的剩余原因是为了简单而可靠的安全管理。

如果我是你，我首先会在需要的地方寻找添加**索引**。还运行一个**分析**工具来检查什么需要很长时间以及是否需要更改该 sql，例如添加更多 Where 子句或限制结果集。

您应该考虑尽可能**缓存**。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-28T13:59:16.553

存储过程不会让事情变得更快。

然而，重新安排你的逻辑会产生巨大的影响。您在考虑存储过程时设计的整洁、集中的事务非常有益。

此外，存储过程倾向于使用绑定变量，而其他编程语言有时依赖于即时构建 SQL 语句。一小部分固定的 SQL 语句和绑定变量很快。动态 SQL 语句很慢。

“最近运行缓慢”的应用程序不需要更改编码。

1.  措施。措施。措施。在性能调优方面，“慢”并没有多大意义。什么是慢？哪个确切的交易很慢？哪个表慢？重点。

2.  控制所有变化。全部。发生了什么变化？操作系统补丁？关系型数据库改变？申请变更？有些东西改变了，让事情慢了下来。

3.  检查规模的约束。表格是否会因为 80% 的数据是您每年用于报告一次的历史记录而变慢？

存储过程永远不是性能问题的解决方案，除非您可以绝对指向一个特定的代码块，该代码块被证明比存储过程更快。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-28T15:01:37.707

如果存储过程避免发送大量数据和/或避免与服务器进行往返，那么存储过程会非常有用，因此如果您的应用程序遇到这些问题之一，它们可能会很有价值。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-28T14:43:06.480

如果您的服务器在繁忙的季节变得明显变慢，那可能是因为饱和，而不是数据库中的任何低效。基本[排队理论](http://en.wikipedia.org/wiki/Queueing_theory)告诉我们，服务器在接近饱和时会变得双曲线地变慢。

基本关系是`1/(1-X)`其中 X 是负载的比例。这描述了平均队列长度或服务前等待的时间。因此，当负载达到峰值时，饱和的服务器将非常迅速地减速。

负载为 25% 的服务器对于某个常数 K 的平均服务时间为 1.333K（粗略地说，K 是机器执行一个事务的时间）。负载为 50% 的服务器的平均服务时间为 2K，负载为 90% 的服务器的平均服务时间为 10K。 *鉴于减速本质上是双曲线的，因此通常不需要对整体负载进行大的更改即可显着降低响应时间。*

显然这有点简单，因为服务器将同时处理多个请求（对于这种情况有更复杂的排队模型），但大原则仍然适用。

因此，如果您的服务器正在经历使其饱和的瞬态负载，您将遇到明显减速的补丁。请注意，这些减速只需要出现在系统的一个瓶颈区域即可减慢整个过程。如果您现在只是在繁忙的季节遇到这种情况，那么您的服务器可能只是遇到了资源限制，而不是特别慢或效率低下。

*请注意，这种可能性与代码效率低下的可能性并不矛盾。您可能会发现缓解瓶颈的方法是调整您的一些查询。*

为了判断系统是否存在瓶颈，请开始收集分析信息。如果您可以找到具有大量等待的资源，这应该给您一个很好的起点。

最后一种可能性是您需要升级您的服务器。如果代码中没有严重的低效率（如果分析没有表明任何不成比例的大瓶颈，这很可能就是这种情况），您可能只需要更大的硬件。我不知道您的数量是多少，但不要忽视您可能已经超出服务器的可能性。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-28T15:51:23.940

完成研究后，您会意识到在光谱的另一端有两种极端观点。从历史上看，由于 hibernate 等框架的可用性，Java 社区一直反对存储 proc，相反，.NET 社区使用了更多的存储 proc，而且这种遗产一直持续到 vb5/6 天。将所有这些信息放在上下文中，并远离硬币两边的极端意见。

速度不应该是决定反对或支持存储过程的主要因素。您可以使用带有 hibernate 和其他框架的内联 SQL 来实现 sp 性能。考虑维护以及哪些其他程序（例如报告、脚本）可以使用您的应用程序使用的相同存储过程。如果您的场景需要多个消费者使用相同的 SQL 代码，则存储过程是一个很好的选择，维护会更容易。如果不是这种情况，并且您决定使用内联 sql，请考虑将其外部化到配置文件中以方便维护。

归根结底，重要的是什么能让您的特定场景为您的利益相关者取得成功。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-28T14:03:24.267

是的，存储过程是朝着实现良好性能迈出的一步。主要原因是存储过程可以预编译并缓存它们的执行计划。

但是，您需要首先分析性能瓶颈的真正位置——以便您以结构化的方式进行此练习。

正如其中一个响应中所建议的那样，尝试使用分析器工具分析问题所在 - 例如，您是否需要创建索引...

干杯

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-03T15:28:21.347

就像上述所有帖子所建议的那样，您首先要清理 SQL 语句，拥有适当的索引。缓存可能很棘手，除非我对您要完成的工作有更多详细信息，否则我无法发表评论。

但是关于 sprocs 的一件事，确保你不要让它生成**动态 SQL 语句**

因为一方面，这将毫无意义，并且可能受到**SQL 注入**攻击……这发生在我研究的一个项目中。

我会推荐 sprocs 主要用于更新，然后选择语句。祝你好运 ：）

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-11-28T13:54:22.320

你永远不能提前说。您必须这样做并衡量差异，因为在十分之九的情况下，瓶颈不在您认为的位置。

如果使用存储过程，则不必传输数据。DB 通常在执行 [EDIT] 复杂 [/EDIT] 存储过程 [EDIT] 与循环、高等数学等 [/EDIT] 时很慢。所以这真的取决于你需要做多少工作，你的网络有多慢，数据库执行这个特定代码的速度等等。

# php - 在php中获得锁定的最佳方法

> ID：325806
> 
> 赞同：18
> 
> 时间：2008-11-28T13:50:34.497
> 
> 标签：php, locking, apc

我正在尝试更新 APC 中的变量，并且将有许多进程尝试这样做。

APC 不提供锁定功能，所以我正在考虑使用其他机制……我目前发现的是mysql 的GET_LOCK() 和php 的flock()。还有什么值得考虑的吗？

更新：我找到了 sem_acquire，但它似乎是一个阻塞锁。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-10-13T10:37:50.527

```
/*
CLASS ExclusiveLock
Description
==================================================================
This is a pseudo implementation of mutex since php does not have
any thread synchronization objects
This class uses flock() as a base to provide locking functionality.
Lock will be released in following cases
1 - user calls unlock
2 - when this lock object gets deleted
3 - when request or script ends
==================================================================
Usage:

//get the lock
$lock = new ExclusiveLock( "mylock" );

//lock
if( $lock->lock( ) == FALSE )
    error("Locking failed");
//--
//Do your work here
//--

//unlock
$lock->unlock();
===================================================================
*/
class ExclusiveLock
{
    protected $key   = null;  //user given value
    protected $file  = null;  //resource to lock
    protected $own   = FALSE; //have we locked resource

    function __construct( $key ) 
    {
        $this->key = $key;
        //create a new resource or get exisitng with same key
        $this->file = fopen("$key.lockfile", 'w+');
    }

    function __destruct() 
    {
        if( $this->own == TRUE )
            $this->unlock( );
    }

    function lock( ) 
    {
        if( !flock($this->file, LOCK_EX | LOCK_NB)) 
        { //failed
            $key = $this->key;
            error_log("ExclusiveLock::acquire_lock FAILED to acquire lock [$key]");
            return FALSE;
        }
        ftruncate($this->file, 0); // truncate file
        //write something to just help debugging
        fwrite( $this->file, "Locked\n");
        fflush( $this->file );

        $this->own = TRUE;
        return TRUE; // success
    }

    function unlock( ) 
    {
        $key = $this->key;
        if( $this->own == TRUE ) 
        {
            if( !flock($this->file, LOCK_UN) )
            { //failed
                error_log("ExclusiveLock::lock FAILED to release lock [$key]");
                return FALSE;
            }
            ftruncate($this->file, 0); // truncate file
            //write something to just help debugging
            fwrite( $this->file, "Unlocked\n");
            fflush( $this->file );
            $this->own = FALSE;
        }
        else
        {
            error_log("ExclusiveLock::unlock called on [$key] but its not acquired by caller");
        }
        return TRUE; // success
    }
}; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-07T03:57:52.493

您可以使用[apc_add](http://www.php.net/manual/en/function.apc-add.php)函数来实现此目的，而无需借助文件系统或 mysql。 `apc_add`仅当变量尚未存储时才成功；因此，提供了一种锁定机制。TTL 可用于确保失败的锁持有者不会永远持有锁。

原因`apc_add`是正确的解决方案是因为它避免了在检查锁和将其设置为“由您锁定”之间存在的竞争条件。由于`apc_add`仅在*尚未*设置的情况下设置值（将其“添加”到缓存中），因此它确保了两个调用不能同时获取锁，无论它们在时间上是否接近。没有同时检查*和*设置锁的解决方案天生就会受到这种竞争条件的影响；需要一个原子操作才能在没有竞争条件的情况下成功锁定。

由于 APC 锁只存在于该 php 执行的上下文中，因此它可能不是一般锁定的最佳解决方案，因为它不支持主机之间的锁。 `Memcache`还提供了原子添加功能，因此也可以与这种技术一起使用——这是主机之间锁定的一种方法。 `Redis`还支持原子 'SETNX' 函数和 TTL，是主机之间锁定和同步的一种非常常用的方法。但是，OP 特别要求为 APC 提供解决方案。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-02T19:53:50.173

如果锁定的目的是防止多个进程尝试填充一个空的缓存键，那么为什么不想要一个阻塞锁呢？

```
 $value = apc_fetch($KEY);

  if ($value === FALSE) {
      shm_acquire($SEMAPHORE);

      $recheck_value = apc_fetch($KEY);
      if ($recheck_value !== FALSE) {
        $new_value = expensive_operation();
        apc_store($KEY, $new_value);
        $value = $new_value;
      } else {
        $value = $recheck_value;
      }

      shm_release($SEMAPHORE);
   } 
```

如果缓存很好，你只需滚动它。如果缓存中没有任何内容，您将获得锁。获得锁后，您需要仔细检查缓存，以确保在等待获得锁时，缓存没有重新填充。如果缓存被重新填充，则使用该值并释放锁，否则，您进行计算，填充缓存然后释放锁。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-30T23:22:56.540

如果您不介意将锁定基于文件系统，那么您可以将 fopen() 与模式“x”一起使用。这是一个例子：

```
$f = fopen("lockFile.txt", 'x');
if($f) {
    $me = getmypid();
    $now = date('Y-m-d H:i:s');
    fwrite($f, "Locked by $me at $now\n");
    fclose($f);
    doStuffInLock();
    unlink("lockFile.txt"); // unlock        
}
else {
    echo "File is locked: " . file_get_contents("lockFile.txt");
    exit;
} 
```

见 www.php.net/fopen

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-02T19:26:35.160

实际上，检查一下这是否会比彼得的建议更好。

[http://us2.php.net/flock](http://us2.php.net/flock)

使用排他锁，如果你觉得舒服，把试图锁定文件的所有其他东西都放在 2-3 秒的睡眠中。如果操作正确，您的网站将遇到锁定资源的挂起，但不会有大量脚本争夺缓存相同的内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-29T22:06:49.960

我意识到这已经有一年了，但我只是在自己做一些关于锁定 PHP 的研究时偶然发现了这个问题。

我突然想到，使用 APC 本身可能有一个解决方案。叫我疯了，但这可能是一种可行的方法：

```
function acquire_lock($key, $expire=60) {
    if (is_locked($key)) {
        return null;
    }
    return apc_store($key, true, $expire);
}

function release_lock($key) {
    if (!is_locked($key)) {
        return null;
    }
    return apc_delete($key);
}

function is_locked($key) {
    return apc_fetch($key);
}

// example use
if (acquire_lock("foo")) {
    do_something_that_requires_a_lock();
    release_lock("foo");
} 
```

在实践中，我可能会在其中添加另一个函数来生成要在此处使用的密钥，以防止与现有 APC 密钥发生冲突，例如：

```
function key_for_lock($str) {
    return md5($str."locked");
} 
```

该`$expire`参数是 APC 的一个很好的功能，因为它可以防止您的锁在您的脚本死亡或类似情况下被永久持有。

希望这个答案对一年后在这里绊倒的其他人有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-02T11:14:03.340

[EAccelerator](http://eaccelerator.net/)有它的方法；`eaccelerator_lock`和`eaccelerator_unlock`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-05T09:18:13.067

APC 现在被认为是[无人维护和死机](http://php.net/manual/en/intro.apc.php)。它的继任者[APCu](http://php.net/manual/en/book.apcu.php)通过[`apcu_entry`](http://php.net/manual/en/function.apcu-entry.php). 但请注意，它还禁止同时执行任何其他 APCu 功能。根据您的用例，这对您来说可能没问题。

从手册：

> **注意：**当控制进入时`apcu_entry()`，缓存的锁是独占获得的，当控制离开时释放`apcu_entry()`：实际上，这会将主体`generator`变成临界区，不允许两个进程同时执行相同的代码路径。此外，它禁止任何其他 APCu 函数的并发执行，因为它们将获取相同的锁。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-16T05:54:24.530

APCu 从 5.1.0 开始就有 apcu_entry，现在可以用它实现锁机制：

```
/** get a lock, will wait until the lock is available,
 * make sure handle deadlock yourself :p
 * 
 * useage : $lock = lock('THE_LOCK_KEY', uniqid(), 50);
 * 
 * @param $lock_key : the lock you want to get it
 * @param $lock_value : the unique value to specify lock owner
 * @param $retry_millis : wait befor retry
 * @return ['lock_key'=>$lock_key, 'lock_value'=>$lock_value]
 */
function lock($lock_key, $lock_value, $retry_millis) {
    $got_lock = false;
    while (!$got_lock) {
        $fetched_lock_value = apcu_entry($lock_key, function ($key) use ($lock_value) {
            return $lock_value;
        }, 100);
        $got_lock = ($fetched_lock_value == $lock_value);
        if (!$got_lock) usleep($retry_millis*1000);
    }
    return ['lock_key'=>$lock_key, 'lock_value'=>$lock_value];
}

/** release a lock
 * 
 * usage : unlock($lock);
 * 
 * @param $lock : return value of function lock
 */
function unlock($lock) {
    apcu_delete($lock['lock_key']);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-27T08:14:16.283

不能说这是否是处理工作的最佳方式，但至少它很方便。

```
function WhileLocked($pathname, callable $function, $proj = ' ')
{
    // create a semaphore for a given pathname and optional project id
    $semaphore = sem_get(ftok($pathname, $proj)); // see ftok for details
    sem_acquire($semaphore);
    try {
        // capture result
        $result = call_user_func($function);
    } catch (Exception $e) {
        // release lock and pass on all errors
        sem_release($semaphore);
        throw $e;
    }

    // also release lock if all is good
    sem_release($semaphore);
    return $result;
} 
```

用法就是这么简单。

```
$result = WhileLocked(__FILE__, function () use ($that) {
    $this->doSomethingNonsimultaneously($that->getFoo());
}); 
```

如果您在每个文件中多次使用此函数，则第三个可选参数会派上用场。

最后但同样重要的是，修改这个函数（同时保留其签名）以在以后使用任何其他类型的锁定机制并不难，例如，如果您碰巧发现自己在使用多个服务器。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-12-03T17:29:49.653

实际上，我发现我根本不需要任何锁定...鉴于我要创建的是所有类 => 用于自动加载的路径关联的映射，如果一个进程会覆盖另一个进程发现的内容（如果编码正确，这是极不可能的），因为无论如何数据最终都会到达那里。因此，解决方案原来是“无锁”。

# c# - 当我提交到控制器时，MVC ASP.NET 在我的视图中取回我的 ViewData.Model

> ID：325809
> 
> 赞同：0
> 
> 时间：2008-11-28T13:51:47.973
> 
> 标签：c#, asp.net-mvc

所以我已经返回 View(object);'d，然后在该页面上按下提交，我如何将该对象返回到控制器中？有任何想法吗？

我的浏览量是

```
public partial class Index : ViewPage<List<Models.Pricing>> 
```

和

```
 public ActionResult Index(int id, FormCollection datesForm,
                             [Bind(Prefix="")]List<Pricing> model)
    {

        return View("Index", new{id});
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T14:08:43.070

因为您实际上是在尝试检索模型列表（定价类型），所以您将需要开发自定义 IModelBinder 并使用它，或者遍历表单集合并将每个定价模型的数据从表单参数中提取出来并重新构建他们。但是，鉴于您的代码，我不明白您为什么需要这样做。

您是否真的想要获取与给定 id 关联的模型数据？还是有比您显示的更多的代码？在前一种情况下，最好的办法可能是使用 id 重新运行查询，而不用担心控制器操作的额外参数。

# .net - 通缉：审查馆藏功能/问题/性能

> ID：325810
> 
> 赞同：1
> 
> 时间：2008-11-28T13:52:11.000
> 
> 标签：.net, collections, review

我知道那里有几个 3rd 方集合库（C5、PowerCollections，我猜想加载更多其他不那么完整的库）以及 System.Collections.Generics 类。但是，我不确定何时使用哪个库。我已经尝试过 C5 集合，但一些消息来源声称它们比默认集合慢。

您使用哪些库，为什么？您是否曾经偏离默认设置（有些集合类型不受支持 - 所以有时它可能是必要的）。

您知道此类第 3 方图书馆评论的任何链接吗？

基本上，我正在寻找任何可以阐明何时使用哪些集合库的信息。

PS：我不是在寻找何时使用链表和何时使用字典的解释。我正在寻找收藏图书馆世界中的选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T14:59:20.677

我认为图书馆的选择取决于您对特定类型馆藏的需求。仅仅因为一个库有一个很棒的链表，并不意味着它有一个很棒的字典。

但是，话虽如此，我通常发现 PowerCollections 可以作为我选择的起始集合库，因为它们的工作方式与内置集合的工作方式相似。不过我喜欢看 C5 的源代码，它们提供了更多的抽象和有趣的算法。

# erlang - Erlang - 代码分析

> ID：325818
> 
> 赞同：4
> 
> 时间：2008-11-28T13:56:13.673
> 
> 标签：erlang, code-analysis

我必须分析一些现有的 Erlang 代码。

有人知道能够以可视/图形方式跟踪模块调用的工具吗？

行为应该是：给出一个包含源代码的目录，并获得一个调用的 gui/picture/ 文件（module1->module2->module3....）。

类似于 UML 逆向工程，但又是*Erlang*吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-28T16:03:54.820

[`xref`](http://www.erlang.org/doc/man/xref.html)在 OTP 中是这样工作的。它为您提供有关应用程序和模块之间存在哪些依赖关系的数据，并生成调用图。[以下是`xref`](http://www.erlang.org/doc/apps/tools/xref_chapter.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-29T17:29:13.040

[Erlang 程序的渐进式输入：牧马人体验](http://www.google.com/url?sa=t&source=web&ct=res&cd=6&url=http%3A%2F%2Fwww.erlang.org%2Fworkshop%2F2008%2FSess42.pdf&ei=t3sxSc34IJW20gWZ7ojJCw&usg=AFQjCNFWACgyfEYAnffqgrQO0qclPJGPJw&sig2=BNVd1WMrsnkWFnM6BdSCGA)

# oracle - ORACLE 10.2 Pro*C 预编译器不读取头文件

> ID：325826
> 
> 赞同：9
> 
> 时间：2008-11-28T13:59:21.703
> 
> 标签：oracle, oracle-pro-c

我正在使用 Oracle 10.2 和 AIX 5.2 预编译包含 Pro*C 代码的 C 程序

Oracle 预编译器读取`$ORACLE_HOME/precomp/admin/pcscfg.cfg file`包含 sys_include 变量定义的 （设置为`/usr/include`）。

Pro*C 编译器抱怨它不知道`size_t`类型是什么，并且使用该类型的 Oracle 头文件`size_t`正在报告错误。

这是文件上报告的示例错误`sqlcpr.h`：

```
extern void sqlglm( char*, size_t*, size_t* );
...........................1
PCC-S-02201, Encountered the symbol "size_t" when expecting one of the following 
```

`size_t``stdio.h`在目录的头文件中定义`/usr/include`。在包含标题之前，我将标题包含`stdio.h`在我的文件中。`example.pc``sqlcpr.h`

我发出 proc 命令如下：

```
proc iname=example parse=full 
```

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-28T16:33:16.463

来自[Metalink](https://metalink2.oracle.com/metalink/plsql/f?p=130:3:9328216730994661370::::p3_database_id,p3_docid,p3_show_header,p3_show_help,p3_black_frame,p3_font:NOT,102288.1,1,1,1,helvetica)

```
PCC-S-02201, Encountered the symbol "size_t" when expecting one of the 
following
:
   ... auto, char, const, double, enum,  float, int, long,
   ulong_varchar, OCIBFileLocator OCIBlobLocator,
   OCIClobLocator, OCIDateTime, OCIExtProcContext, OCIInterval,
   OCIRowid, OCIDate, OCINumber, OCIRaw, OCIString, register,
   short, signed, sql_context, sql_cursor, static, struct,
   union, unsigned, utext, uvarchar, varchar, void, volatile,
   a typedef name, exec oracle, exec oracle begin, exec,
   exec sql, exec sql begin, exec sql type, exec sql var,
The symbol "enum," was substituted for "size_t" to continue.
Syntax error at line 88, column 7, file /usr/include/gconv.h:
Error at line 88, column 7 in file /usr/include/gconv.h
                                  size_t *); 
```

> ## 解决方案说明
> 
> **'sys_include' 和 'include' 预编译器选项设置不正确。** 在位于 $ORACLE_HOME/precomp/admin 的 pcscfg.cfg 文件中设置“sys_include”和“include”预编译器选项，或者在调用“proc”时在命令行中包含。
> 
> 例如，以下是正确设置变量的推荐方法：
> 
> **运行以下命令以获取编译器位置：**
> 
> gcc -v
> 
> 从 /usr/lib/gcc-lib/i386-redhat-linux7/2.96/specs 读取规范 gcc 版本 2.96 20000731 (Red Hat Linux 7.3 2.96-128)
> 
> **使用上面返回的路径（删除规范并替换为包含）**

```
sys_include=($ORACLE_HOME/precomp/public,
             /usr/lib/gcc-lib/i386-redhat-linux7/2.96/include, 
             /usr/include)

include=(/u02/app/oracle/product/8.1.5/precomp/public)
include=(/u02/app/oracle/product/8.1.5/rdbms/demo)
include=(/u02/app/oracle/product/8.1.5/network/public)
include=(/u02/app/oracle/product/8.1.5/plsql/public) 
```

我猜想同时拥有 sysinclude 和 include 是你的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-01T19:22:30.683

您必须确保设置了包含搜索路径，以便 Pro*C 以正确的顺序包含所有需要的目录。

例如，在 CentOS 6.5 上，我指定以下顺序（在 中`pcscfg.cf`）：

```
sys_include=$ORACLE_HOME/sdk/include
sys_include=/usr/include
sys_include=/usr/lib/gcc/x86_64-redhat-linux/4.4.7/include
sys_include=/usr/include/linux
ltype=short
define=__x86_64__ 
```

此配置文件由`proc`from读取`$ORACLE_HOME/precomp/admin/pcscfg.cfg`。

显然，Oracle 安装程序编写的默认文件通常不是最理想的，因为它例如列出了不存在的 GCC 路径和/或使用有问题的包含路径顺序。

使用不同的顺序，我会收到相同的`size_t`相关错误消息（将前 4 行排列为 (1,2,4,3) 时）。

当将前 4 行置换为 (1,3,2,4) 并包括`<limits.h>`时，`proc`甚至会进入内存分配无限循环，直到它被 OOM 杀手杀死。

作为一种解决方法，您还可以`sys_include`在命令行上指定选项`proc`，例如：

```
lines=yes \
code=ANSI_C \
sqlcheck=full \
parse=full \
sys_include=$(ORACLE_HOME)/precomp/public \
sys_include=/usr/include \
sys_include=/usr/lib/gcc/x86_64-redhat-linux/4.4.7/include \
sys_include=/usr/include/linux 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-25T09:21:32.960

当我玩我的 pcscfg.cfg 文件时，有两件事值得注意。

1 请记住它不支持“空格”，因此任何包含空格的路径都应以“短”样式书写。例如：`SYS_INCLUDE=D:\Progra~1\Micros~1.0\VC\include` 您可以在 Windows 中使用 dir /x 来获取名称的简短版本

2 至少在我看来，INCLUDE 应该写在所有这些选项之前。即如果

```
define=(WIN32_LEAN_AND_MEAN)
parse=full
SYS_INCLUDE=D:\Progra~1\Micros~1.0\VC\include 
```

不行，试试

```
define=(WIN32_LEAN_AND_MEAN)
SYS_INCLUDE=D:\Progra~1\Micros~1.0\VC\include
parse=full 
```

反而。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-07T06:15:30.913

我遇到了类似的问题（“PCC-S-02201，遇到符号 ...”）。我听了上面的两条建议。

*   检查`sys_include`并确保目录路径是编译器实际设置使用的目录路径。Pro*C 使用的默认值通常不存在。编译一个“Hello World”程序`gcc -v -c <prog.c>`并检查`COMPILER_PATH`
*   我调整了选项`sys_include`的顺序并按顺序提出（不确定是否重要，但仍然如此。）

所以 PCC-S-02201 消失了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-06T04:42:30.560

我修改了将 /usr/include/linux 放在其他所有内容之前。这清除了找不到 stddef.h 和不知道 size_t 是什么的问题。将它放在 /usr/include 旁边只能修复前者。

修改后的 pcscfg.cfg：

sys_include=( **/usr/include/linux,** $ORACLE_HOME/precomp/public,/usr/include,/usr/lib/gcc/i386-redhat-linux/4.1.1/include,/usr/lib/gcc/i386- redhat-linux/3.4.5/include,/usr/lib/gcc-lib/i386-redhat-linux/3.2.3/include,/usr/lib/gcc/i586-suse-linux/4.1.2/include, /usr/lib/gcc/i586-suse-linux/4.3/include) ltype=short

(CentOS 6.3, oracle 11g)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-24T22:44:47.303

将 sys_include 用于包含环境变量或 Visual Studio 变量的路径。如果路径是简单路径，使用“include”，否则使用“sys_include”

我在 Visual Studio 2013 上遇到了这个问题，用于编译 .pc 文件，通过上述更改，一切正常。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-01T20:21:13.713

添加一个编译标志行以`pcscfg.cfg`使Oracle的预编译器编译没有系统头文件语法错误：

```
define=_POSIX_C_SOURCE 
```

就是这样。它现在应该没有错误地进行预编译。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-06-06T23:02:35.667

我遇到过同样的问题：

```
[me@somesys:~/proC]$ proc sys_include='(/usr/include,/usr/include/linux,/usr/include/c++/4.8.2/x86_64-redhat-linux,/usr/include/c++/4.8.2/tr1,/usr/include/c++/4.8.2)' copy.pc

Pro*C/C++: Release 12.1.0.2.0 - Production on Thu Jun 6 17:47:11 2019

Copyright (c) 1982, 2014, Oracle and/or its affiliates.  All rights reserved.

System default option values taken from: /oracle/app/oracle/product/12.1.0.2/precomp/admin/pcscfg.cfg

Syntax error at line 307, column 3, file /usr/include/libio.h:
Error at line 307, column 3 in file /usr/include/libio.h
  size_t __pad5;
..1
PCC-S-02201, Encountered the symbol "size_t" when expecting one of the following
:

   } char, const, double, enum, float, int, long, ulong_varchar,
   OCIBFileLocator OCIBlobLocator, OCIClobLocator, OCIDateTime,
   OCIExtProcContext, OCIInterval, OCIRowid, OCIDate, OCINumber,
... 
```

我按照 yogmk 的建议做了：

```
[me@somesys:~/proC]$ gcc -v -c borrame.c
Using built-in specs.
COLLECT_GCC=gcc
Target: x86_64-redhat-linux
Configured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-linker-hash-style=gnu --enable-languages=c,c++,objc,obj-c++,java,fortran,ada,go,lto --enable-plugin --enable-initfini-array --disable-libgcj --with-isl=/builddir/build/BUILD/gcc-4.8.5-20150702/obj-x86_64-redhat-linux/isl-install --with-cloog=/builddir/build/BUILD/gcc-4.8.5-20150702/obj-x86_64-redhat-linux/cloog-install --enable-gnu-indirect-function --with-tune=generic --with-arch_32=x86-64 --build=x86_64-redhat-linux
Thread model: posix
gcc version 4.8.5 20150623 (Red Hat 4.8.5-36) (GCC)
COLLECT_GCC_OPTIONS='-v' '-c' '-mtune=generic' '-march=x86-64'
 /usr/libexec/gcc/x86_64-redhat-linux/4.8.5/cc1 -quiet -v borrame.c -quiet -dumpbase borrame.c -mtune=generic -march=x86-64 -auxbase borrame -version -o /tmp/cc2WTuu6.s
GNU C (GCC) version 4.8.5 20150623 (Red Hat 4.8.5-36) (x86_64-redhat-linux)
        compiled by GNU C version 4.8.5 20150623 (Red Hat 4.8.5-36), GMP version 6.0.0, MPFR version 3.1.1, MPC version 1.0.1
GGC heuristics: --param ggc-min-expand=100 --param ggc-min-heapsize=131072
ignoring nonexistent directory "/usr/lib/gcc/x86_64-redhat-linux/4.8.5/include-fixed"
ignoring nonexistent directory "/usr/lib/gcc/x86_64-redhat-linux/4.8.5/../../../../x86_64-redhat-linux/include"
#include "..." search starts here:
#include <...> search starts here:
 /usr/lib/gcc/x86_64-redhat-linux/4.8.5/include
 /usr/local/include
 /usr/include
End of search list.
GNU C (GCC) version 4.8.5 20150623 (Red Hat 4.8.5-36) (x86_64-redhat-linux)
... 
```

但是`COMPILER_PATH`，我按顺序复制了 之后的非空目录`#include <...> search starts here:`，而不是 ，它起作用了！

```
[me@somesys:~/proC]$ proc sys_include='(/usr/lib/gcc/x86_64-redhat-linux/4.8.5/include,/usr/include)' copy.pc

Pro*C/C++: Release 12.1.0.2.0 - Production on Thu Jun 6 17:54:50 2019

Copyright (c) 1982, 2014, Oracle and/or its affiliates.  All rights reserved.

System default option values taken from: /oracle/app/oracle/product/12.1.0.2/precomp/admin/pcscfg.cfg

[me@somesys:~/proC]$ 
```

希望它可以帮助任何人。

# math - 服务器日志的统计分析——外推的正确性

> ID：325828
> 
> 赞同：1
> 
> 时间：2008-11-28T14:02:22.210
> 
> 标签：math, statistics

一天，我们遇到了大约 10 分钟的 ISP 故障，不幸的是，这发生在从多个地点进行的托管考试期间。

不幸的是，这导致候选人当前页面的回发数据丢失。

我可以从服务器日志中重建事件流。但是，在 317 名候选人中，有 175 名使用本地代理，这意味着他们似乎都来自同一个 IP。我分析了其余 142 个（45%）的数据，并得出了一些很好的数字来说明它们发生了什么。

问题：将我所有的数字乘以 317/142 以获得整个集合的可能结果有多正确？我的（非）确定性区域是什么？

请不要猜测。我需要一个在统计课上没有睡着的人来回答。

编辑：按数字，我指的是受影响个人的数量。例如，5/142 在会话期间显示了浏览器崩溃的证据。11/317 浏览器崩溃的推断有多正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-29T08:46:28.540

我不确定我们到底在谈论什么测量，但现在让我们假设你想要平均分之类的东西。估计总体（317 名候选人）的平均分数不需要调整。只需使用样本的平均值（您分析的 142 个数据）。

[要找到您的不确定区域，您可以使用NIST 统计手册](http://www.itl.nist.gov/div898/handbook/eda/section3/eda352.htm)中给出的公式。你必须首先决定你愿意有多不确定。假设您希望真实总体均值位于区间内的置信度为 95%。然后，真实总体均值的置信区间为：

（样本平均值）+/- 1.960*（样本标准差）/sqrt（样本大小）

您可以进行进一步的更正，以将相对于总体的大量样本归功于自己。他们会将置信区间收紧约 1/4，但有很多假设认为上述计算已经使它不那么保守了。一种假设是分数大致呈正态分布。另一个假设是样本代表总体。您提到缺失的数据都来自使用相同代理的候选人。使用该代理的人口子集可能与其他人口有很大不同。

编辑：由于我们正在讨论具有属性的样本的一部分，例如“浏览器崩溃”，所以事情有点不同。我们需要对一个比例使用置信区间，并通过乘以人口规模将其转换回成功次数。这意味着我们对崩溃浏览器数量的最佳估计是 5*317/142 ~= 11，正如您所建议的那样。

如果我们再次忽略我们的样本几乎是总体一半的事实，我们可以使用[一个比例的威尔逊置信区间](http://www.itl.nist.gov/div898/handbook/prc/section2/prc241.htm)。[可以在线](http://faculty.vassar.edu/lowry/prop1.html)使用计算器为您处理公式。计算器和公式的输出是总体分数的上限和下限。要获得崩溃次数的范围，只需将上限和下限乘以（总体大小 - 样本大小），然后再加回样本中的崩溃次数。虽然我们可以简单地乘以总体规模来获得区间，但这会忽略我们已经知道的样本。

基于 142 个样本点中的 5 次崩溃，使用上述程序得出 317 总体中浏览器崩溃总数的 95% CI 为 7.6 到 19.0。

# iis-7 - 证书信任列表和 IIS7

> ID：325829
> 
> 赞同：4
> 
> 时间：2008-11-28T14:03:18.263
> 
> 标签：iis-7, ssl, ctl

我需要生成一个用于 IIS7 的 CTL。

我使用 MakeCTL（在 Win2k3 SDK 上）生成了一个 CTL 文件，并且只将我自己的 RootCA 证书放在 CTL 中。

但是，当我随后使用 adsutil.vbs 将我的网站设置为使用此 CTL 时，我得到：

ErrNumber：-2147023584 (0x80070520) 尝试设置属性时出错：SslCtlIdentifier

我正在像这样使用 adsutil.vbs：

cscript adsutil.vbs set w3svc/2/SslCtlIdentifier CTL 的友好名称在哪里

问题是，我无法设置友好名称。在向导结束时，它会显示“友好名称：”。

在 IIS6 中，我可以创建一个具有友好名称的 CTL（显示在证书 MMC 中），但如果我从那里导出它，当我导入它时，它不再具有友好名称。

谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-02-05T00:34:06.520

这应该适用于 IIS 7.0，但可能不适用于 IIS 7.5。
请让我们知道此页面是否有帮助 - [http://www.rethinker.net/Blog/Post/14/How-to-Create-and-Use-a-CTL-for-IIS-7-0](http://www.rethinker.net/Blog/Post/14/How-to-Create-and-Use-a-CTL-for-IIS-7-0)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T16:52:50.723

我遇到了完全相同的问题，并且在寻找答案时遇到了同样的麻烦。

似乎没有记录的方法可以使用 MakeCTL 为证书信任列表创建友好名称。唯一记录在案的将 CTL 添加到 IIS7 的方法是使用上面 Neil 引用的 adsutil 脚本，但它需要一个友好的名称。我认为我们可以深入研究一种编程方式来做到这一点，但我并不打算深入。

这个问题的核心是 IIS7 似乎已经失去了对 CTL 的青睐，否则它会对它们有一些 UI 支持。人们是否将 CTL 的替代品与客户端证书结合使用？

我觉得奇怪这对 IIS7 来说不是一个更大的问题。

**更新：** 我终于回到了这个问题，并解决了友好名称问题。要获得指定的友好名称，您必须将 CTL 存储在证书存储中而不是文件中（我以前一直使用文件方法）。因此，在向导模式下使用 MakeCTL（无参数）并在“证书信任列表存储”页面上选择“证书存储”会导致一个新页面，让您指定一个友好名称。

所以我现在在 LocalMachine 的“中级证书颁发机构”证书库中有一个 CTL。现在我正在尝试使用“netsh http add sslcert”将 CTL 分配给我的站点。

在我可以使用此命令之前，我必须删除分配给我的站点以进行服务器身份验证的现有 SSL 证书。然后在我的 netsh 命令中，我指定了我删除的同一个 SSL 证书的指纹，加上一个组成的 appid，再加上“sslctlidentifier=MyCTL sslctlstorename=CA”。结果命令是：

**netsh http 添加 sslcert ipport=10.10.10.10:443 certash=adfdffa988bb50736b8e58a54c1eac26ed005050 appid={ffc3e181-e14b-4a21-b022-59fc669b09ff} sslctlidentifier=MyCTL sslctlstorename=CA**

（IP 地址已被修改），但我收到此错误：

**SSL 证书添加失败，错误：1312 指定的登录会话不存在。它可能已经被终止。**

我确信该错误与 CTL 选项有关，因为如果我删除它们，它会起作用（尽管当然没有分配 CTL）。

谁能帮我迈出最后一步并完成这项工作？

**2010 年 1 月 7日更新：**我从未使用 IIS 7.0 解决此问题，并且已将我们的应用程序迁移到 IIS 7.5，并再次尝试。我在我的测试服务器上安装了 IIS6 兼容性，并使用 adsutil.vbs尝试了[此处记录的步骤。](http://learn.iis.net/page.aspx/131/compatibility-and-feature-requirements-for-windows-vista/#NoWizard)我立即遇到了 Niel 在上面所做的同样的错误：

ErrNumber：-2147023584 尝试设置属性时出错：SslCtlIdentifier

运行此命令时：

adsutil.vbs 设置 w3svc/1/SslCtlIdentifier MyFriendlyName

然后我继续尝试记录的下一个 adsutil.vbs 命令，但它失败并出现同样的错误。

我已验证我创建的 CTL 具有 MyFriendlyName 的友好名称，并且它存在于 LocalComputer 的“中间证书颁发机构\证书信任列表”存储中。

所以我又一次陷入了僵局。我不知道还能尝试什么。有没有人让 CTL 与 IIS7 或 7.5 一起工作？曾经？我在打败一匹死马吗？谷歌只找到我自己的帖子和其他类似的故事。

**2010 年 6 月8 日更新**- 我现在可以确认 KB981506 解决了这个问题。有一个与此 KB 相关的补丁，必须将其应用于 Server 2008 R2 机器才能启用此功能。一旦安装好，对我来说一切都完美无缺。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-08T17:03:07.263

问题是关于 IIS7，但对于任何寻找此信息的人 - 从**IIS8 开始**，您不再需要使用 CTL，而是在证书存储中使用“客户端身份验证颁发者”。

对此进行了更详细的记录：[http ://technet.microsoft.com/en-us/library/hh831771.aspx](http://technet.microsoft.com/en-us/library/hh831771.aspx)

# php - 如何在 PHP 中重新初始化会话？

> ID：325836
> 
> 赞同：3
> 
> 时间：2008-11-28T14:07:16.320
> 
> 标签：php, session

我正在尝试将现有的支付平台集成到我的网上商店。交易成功后，支付平台向我的应用程序中的 URL 发送请求，其中交易 ID 包含在查询参数中。

但是，我需要做一些后处理，比如发送订单确认等。为此，我需要访问用户的会话，因为那里存储了很多与订单相关的信息。为此，我在初始请求 XML 中包含 session_id，并在事务完成后执行以下操作：

```
$sessionId = 'foo'; // the sessionId is succesfully retrieved from the XML response
session_id($sessionId);
session_start(); 
```

上面的代码工作正常，但`$_SESSION`仍然是空的。我是否忽略了某些东西，或者这根本不可能？

**编辑：**

感谢所有的答案。问题还没有解决。如前所述，奇怪的是我可以使用属于下订单的用户的 session_id 成功启动一个新会话。还有其他想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T14:46:54.867

不是您真正要求的，但是在将客户发送到支付服务之前，您不需要将订单保存到数据库中吗？当您收到付款确认时，最好在订单后处理中依赖持久数据。

依赖会话是不可靠的，因为您不知道此确认需要多长时间（通常是即时的，但在极少数情况下会延迟）。

此外，如果您的网络服务器在此时间段内重新启动，将使您丢失相关数据。

第三个问题是，如果您有一个负载平衡解决方案，带有单独的会话管理（非常常见），那么您将无法保证支付服务器和您的客户端将访问同一个网络服务器（因为粘性通常基于源 IP ）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T23:48:50.203

我冒昧地猜测，由于域与会话设置到您尝试读取它的位置不同，因此 php 正在安全地使用它，而不是检索由不同域设置的会话数据。这样做是为了保护安全，以防有人猜测会话 ID 并劫持数据。

解决方法是，假设交换发生在同一个物理磁盘上，将订单数据临时写入序列化（并且可能加密取决于是否跟踪完整的信用卡号，这是另一回事）文件，一旦接收端读取的内容被及时删除。

本质上，所做的只是复制您试图退出会话的功能，而不会产生烦人的安全副作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-30T15:58:04.847

非常感谢所有的回复。

[Smazurov 的回答](https://stackoverflow.com/questions/325836/how-to-re-initialize-a-session-in-php#326915)让我开始思考，让我再次忽略了我的 PHP 配置。

PHP 的默认行为是不加密会话相关数据，这*应该*可以在从另一个客户端重新启动旧会话后读取会话数据。但是，我使用[Suhosin](http://www.hardened-php.net/suhosin/index.html)来修补和防止一些安全问题。Suhosin 的默认行为是[基于 User Agent 加密会话数据](http://www.hardened-php.net/suhosin/configuration.html#suhosin.session.encrypt)，这使得读取其他人的会话变得更加困难。

这也是我的问题的原因；禁用此行为已解决该问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-29T02:20:20.303

确保在尝试开始新会话之前关闭当前会话。所以你应该这样做：

```
$id = 'abc123';
session_write_close();
session_id($id);
session_start(); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-28T14:24:25.647

很脏，但对我有用：

告诉支付网关使用

```
http://yourdomain.com/callbackurl.php?PHPSESSID=SESSIONIDHERE 
```

如果您设置某些配置变量 (session.use_trans_sid)，PHP 会使用该方法在自身周围传递会话，即使 PHP 被告知不要这样做，它似乎也可以工作。它当然总是对我有用。

编辑：

您的问题可能是您将 session.auto_start 设置为 true - 因此在您的代码运行之前，会话会使用它生成的任何 ID 自动启动。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-28T16:00:36.730

如何在另一个 PHP 页面中执行此操作，然后执行 iframe 包含 / 将用户重定向到第二个页面？

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-28T22:56:15.597

我不确定您的交易和支票之间的确切时间长度；但您的会话 cookie 似乎已过期。默认情况下，会话通常在 45 分钟左右后过期。这是为了释放更多的 uniqid 供 php 使用并防止潜在的会话劫持。

我不确定您是否有自定义会话处理程序以及它是否存储在数据库中，但从您在此页面上的帖子和评论中猜测，我会假设它存储在服务器端 cookie 中。

现在解决您的问题的方法是咬紧牙关，将必要的数据存储在数据库中并通过会话 ID 访问它，即使这意味着创建另一个表与您的订单表并排。

但是，如果您立即执行该操作，则另一种解释是用户注销或提交了破坏其会话的操作（删除服务器端 cookie）。

您将在您的服务器/tmp 文件夹中看到这些 cookie，尝试查看您的 cookie，它应该命名为 'sess' + $session_id。

# php - 从 html，而不是文件创建弹出窗口

> ID：325838
> 
> 赞同：0
> 
> 时间：2008-11-28T14:07:52.090
> 
> 标签：php, javascript, ajax

我有一个 php 页面，它将 mysql db 中的行显示为表。其中一个字段包含 HTML 标记，我想使这一行可点击，并且 html 将在新的弹出窗口中打开。最好的方法是什么，有没有办法在不将 html 写入文件的情况下做到这一点？

编辑：这个 php 页面实际上是 ajax 应用程序的一部分，所以这不是问题。我不想使用 jquery，因为我必须重写应用程序。

编辑：

我使用下面的示例再次尝试了此操作，但失败了。我知道我的脚本标签是错误的，但我现在只是在回应 row2，所以我认为我的逻辑在它到达 javascript 之前是错误的。

```
$sql="SELECT * FROM Auctions WHERE ARTICLE_NO ='$pk'";
$sql2="SELECT ARTICLE_DESC FROM Auctions WHERE ARTICLE_NO ='$pk'";
$htmlset = mysql_query($sql2);
$row2 = mysql_fetch_array($htmlset);
echo $row2;
/*echo '<script> child1 = window.open ("about:blank")
child1.document.write("$row2['ARTICLE_DESC']");
child1.document.close()*/ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T14:19:18.103

```
child1 = window.open ("about:blank")
child1.document.write("Moo!");
child1.document.close() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T14:31:55.083

如果您不需要浏览器窗口（此建议涉及 css 模态框），您可能需要考虑其中一种“灯箱”变体。

[Thickbox](http://jquery.com/demo/thickbox/)可用于将页面中的内联内容加载到模式窗口中。该链接提供了有关如何实现内联内容以及其他变体的演示/详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T14:32:50.510

我建议使用像 jQuery 这样的 Javascript 库，因为它简化了这种类型的代码并且是跨浏览器兼容的。

```
$(document).ready( function() {

$('#clicker').click( function() {
    myWindow=window.open('','','width=200,height=100')
    myWindow.document.write($("#content"));
    return false;
});

}); 
```

html 将是：

```
 <table>
    <tr>
       <td><div id="clicker">Click Here</div></td>
       <td><div id="content">This is the content</div></td>
     </tr>
 </table> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T14:40:27.610

如果它有很多数据，值得考虑在查看时通过 ajax 加载它以保存选择它并在每次页面加载时将其发送给用户 - 这对于已经建议的 jquery 之类的东西相当容易。

# java - Java中下划线字体的常量值是多少？

> ID：325840
> 
> 赞同：13
> 
> 时间：2008-11-28T14:08:30.747
> 
> 标签：java, class, fonts, bold, underline

Java中下划线字体的常量值是多少？

Font.BOLD粗体 **字**

Font.ITALIC *斜体*字体

什么是 UNDERLINE 字体常量？我尝试了所有可用的常量，但没有奏效。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-13T07:30:18.600

假设您想要一个带下划线和粗体的 Serif 样式字体，大小 = 12。

```
Map<TextAttribute, Integer> fontAttributes = new HashMap<TextAttribute, Integer>();
fontAttributes.put(TextAttribute.UNDERLINE, TextAttribute.UNDERLINE_ON);
Font boldUnderline = new Font("Serif",Font.BOLD, 12).deriveFont(fontAttributes); 
```

如果您不希望它加粗，请使用 Font.PLAIN 而不是 Font.BOLD。不要使用 Font 类的 getAttributes() 方法。它会给你一个疯狂的通配符参数化类型`Map<TextAttribute,?>`，你将无法调用 put() 方法。有时Java会像那样令人讨厌。如果您对原因感兴趣，可以查看此网站：[http ://www.angelikalanger.com/GenericsFAQ/FAQSections/ParameterizedTypes.html](http://www.angelikalanger.com/GenericsFAQ/FAQSections/ParameterizedTypes.html)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-28T14:29:42.843

查看[Java API 规范](http://java.sun.com/javase/6/docs/api/)，[`Font`该类](http://java.sun.com/javase/6/docs/api/java/awt/Font.html)似乎没有用于下划线的常量。

但是，使用[`Font(Map<? extends AttributedCharacterIterator.Attribute,?> attributes)`](http://java.sun.com/javase/6/docs/api/java/awt/Font.html#Font(java.util.Map))构造函数，可以给它一个`Map`包含[`TextAttribute`](http://java.sun.com/javase/6/docs/api/java/awt/font/TextAttribute.html)和要使用的值，以指定字体属性。（请注意，`TextAttribute`该类是 的子类`AttributedCharacterIterator.Attribute`）

[`TextAttribute.UNDERLINE`](http://java.sun.com/javase/6/docs/api/java/awt/font/TextAttribute.html#UNDERLINE)似乎很`TextAttribute`有趣。

**编辑：在**[Java Tutorials](http://java.sun.com/docs/books/tutorial/index.html)`TextAttribute`的[Using Text Attributes to Style Text](http://java.sun.com/docs/books/tutorial/2d/text/textattributes.html)部分中有一个使用示例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-28T14:18:06.937

下划线不是字体的属性，而是文本段的属性。呈现时，文本以指定的字体呈现，然后在其下绘制一条线。根据您使用的框架，这可能会使用属性为您完成，或者您可能必须自己完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T14:23:59.687

对于 SWT，您可以使用：

```
StyledText text = new StyledText(shell, SWT.BORDER);
text.setText("0123456789 ABCDEFGHIJKLM NOPQRSTUVWXYZ");
// make 0123456789 appear underlined
StyleRange style1 = new StyleRange();
style1.start = 0;
style1.length = 10;
style1.underline = true;
text.setStyleRange(style1); 
```

# .net - 我在哪里可以获得 VB.net - WPF - 趋势图控件

> ID：325843
> 
> 赞同：0
> 
> 时间：2008-11-28T14:09:05.660
> 
> 标签：.net, graph, controls, trending

我们正在尝试显示 4 个趋势图，并将以每秒大约 1 个点的速度向它们添加数据。最后，每个趋势需要显示在 600 点左右。

目前我们正在使用 Syncfusion 的绘图工具，但它们无法以我们需要的速度重绘图表。我相信这个问题是由于我们使用的是“绘图”工具而不是“趋势”工具，所以每次刷新都会重新绘制整条线。

该应用程序在一个野兽般的机器上运行：Dell 2950，带有：双处理器（Intel Xeon's），四核，2.99GHZ，和 8gig 的 ram。

你知道我们在哪里可以获得高速趋势控制吗？首选 WPF 控件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T13:29:09.887

别再看了，使用[visifire](http://visifire.com/silverlight_chart_designer.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T10:02:38.940

您可以使用[Graphit](https://graphit.codeplex.com/)。
我们使用它，它仍然很平滑，有 10 条曲线，每条曲线大约有 5000 个数据点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T14:19:48.150

我不确定它是否能满足您的需求，但您可以查看[http://www.visifire.com/](http://www.visifire.com/)
Visifire 是 Silverlight 和 WPF 的开源图形控件。

# sql - Oracle 连接运算符

> ID：325852
> 
> 赞同：2
> 
> 时间：2008-11-28T14:16:12.870
> 
> 标签：sql, oracle, outer-join

如何重写这个：

```
select tab1.id, tab2.id, tab3.id 
from tab1, tab2, tab3 
where tab1.col1 = tab2.col1(+) and tab2.col2 = tab3.col2(+); 
```

使用 OUTER JOIN 语法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-28T14:21:17.647

```
select tab1.id, tab2.id, tab3.id 
from tab1
left outer join tab2 on tab1.col1 = tab2.col1
left outer join tab3 on tab2.col2 = tab3.col2; 
```

# c#-3.0 - 是否可以将 C# 对象初始化器与工厂一起使用

> ID：325859
> 
> 赞同：3
> 
> 时间：2008-11-28T14:19:45.343
> 
> 标签：c#-3.0, factory

我正在查看 C# 3.0 中的新对象初始值设定项并希望使用它们。但是，我看不到如何将它们与 Microsoft Unity 之类的东西一起使用。我可能遗漏了一些东西，但如果我想保留强类型的属性名称，那么我不确定我能不能。例如我可以这样做（伪代码）

```
Dictionary<string,object> parms = new Dictionary<string,object>();
parms.Add("Id", "100");

IThing thing = Factory.Create<IThing>(parms)(); 
```

然后通过反射在 Create 中做一些事情来初始化参数...但是如果我希望它在 Create 级别强类型化，就像新的对象 intitalisers 一样，那么我看不出我能做什么。

有没有更好的办法？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-28T15:30:06.933

考虑花时间学习 Unity 或 Castle 或任何其他可用于 .net 的 IOC 框架。IOC 将允许您将对象初始化的复杂性从代码转移到配置文件。在您的应用程序中，您将使用接口来访问由 IOC 容器初始化的对象。IOC 为您提供的另一项服务是控制对象（单例等）的生命周期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-19T00:03:18.753

这在这个问题中得到了更好的回答：[Is it possible to use ac# object initializer with a factory method?](https://stackoverflow.com/questions/675545/is-it-possible-to-use-a-c-object-initializer-with-a-factory-method) .

有四种可能性：

*   接受一个 lambda 作为参数
*   而是返回一个构建器
*   使用默认构造函数，传入一个初始化的对象
*   使用匿名对象

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T16:22:24.470

Graham，IoC/DI 背后的想法是，您的组件将它们的依赖关系声明为构造函数参数或特定类型（通常是接口）的公共属性。然后容器构建一个依赖关系图并满足那些（如果是成熟的 IoC，如温莎城堡，则考虑组件的生活方式）。

所以基本上你写你的组件，状态依赖，然后在 IoC 容器中注册合约和实现，不再关心构造对象了。您只需进行一次类似于 Application.Start() 的调用 :)

不好的是有些框架很难集成。与 ASP.NET WebForms 一样，您无法控制 IHttpHandler 的创建，也无法设置使用 IoC 实例化它们的工厂。您可以查看 Ayende 的“Rhino Igloo”，它最好在这样的环境中使用 IoC。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T03:46:30.393

也许这会有所帮助...您查看过这篇博文吗？

[http://www.cookcomputing.com/blog/archives/000578.html](http://www.cookcomputing.com/blog/archives/000578.html)

作者提出了一种从工厂构建对象并将对象注册到 IoC 容器中的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T14:32:18.797

AFAIK，这是不可能的。如果我是你，在这种情况下我会远离反射，因为反射真的很慢，很容易成为你应用程序的瓶颈。我认为为此使用反射实际上是在滥用反射。

不要因为你想模仿一些语法糖而在腿上开枪。只需一一设置实例的字段/属性，经典方式。它会比反射快得多。

记住：没有设计模式是灵丹妙药。工厂方法和对象初始值设定项很好，但尽量使用常识，并且仅在它们真正有意义时才使用它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T14:32:30.870

我对 Unity 不是很熟悉，但是 IoC/DI 背后的想法是你不自己构造对象，所以当然你不能使用对象初始化语法。

我猜您可以在示例中使用 C# 3.0 中的匿名类型而不是 Dictionary。不知道 Unity 是否可以使用它。

无论如何，如果您进行像 Factory.Create() 这样的调用，您可能以错误的方式使用 IoC。

# excel - Excel 条件格式自参考

> ID：325865
> 
> 赞同：4
> 
> 时间：2008-11-28T14:22:57.567
> 
> 标签：excel, worksheet-function, conditional-formatting

我正在尝试在 Excel 2003 中进行一些条件格式设置，如果下一个单元格为“是”，我想做的是让一个单元格变为红色，如果它本身包含“是”，则变为粗体。因此，如果两个单元格都是“是”，则当前单元格将是红色和粗体。我想对一组单元格执行此操作，因此我没有使用对单元格的直接引用，但我想出了以下内容。

```
=AND(INDIRECT(ADDRESS(ROW(),COLUMN()))="Yes",INDIRECT(ADDRESS(ROW(),COLUMN()+1))="Yes") 
```

但这总是失败。但是，如果我单独使用其中任何一个（`INDIRECT(ADDRESS(ROW(),COLUMN()))="Yes"`使当前的销售变粗），它就可以工作。

有谁知道我如何在 excel 2003 条件格式中一般地自我引用一个单元格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T14:52:12.983

我没有要测试的 Excel 2003，只有 2007。但是，我认为您可以使用以下规则解决您的问题。假设您的第一列是 A，第二列是 B，第一个数据值在 A1 中。

A1 的第一条规则是使用公式突出显示`=and(A1="Yes",B1="Yes")`，格式为粗体文本和红色背景。

A1 上的第二条规则是使用公式突出显示`=B1="Yes"`，格式仅为红色背景。

A1 上的第三条规则是当单元格等于“是”并且格式仅为粗体文本时突出显示。

然后使用格式刷将此格式复制到 A 列中的所有其他单元格。Excel 会自动为您调整单元格引用，以便在 A2 中公式引用 B2，在 A3 中引用 B3，等等。请注意，规则的顺序很重要，因为 Excel 2003 将在第一个匹配的规则之后停止。这就是为什么你不能只用两条规则得到你想要的行为。

您也可以将相同的格式复制到 B 列，假设这是您想要的。否则，当单元格等于“是”时，使用规则将 B1 格式化为粗体，并将其复制到 B 列的其余部分。

# sql - 在 sql 查询的 where 子句中检查当前日期的最佳方法

> ID：325871
> 
> 赞同：6
> 
> 时间：2008-11-28T14:25:24.770
> 
> 标签：sql, tsql, stored-procedures, performance

我试图找出最有效（最佳性能）的方式来检查当前日期的日期字段。目前我们正在使用：

```
SELECT     COUNT(Job) AS Jobs
FROM         dbo.Job
WHERE     (Received BETWEEN DATEADD(d, DATEDIFF(d, 0, GETDATE()), 0)
                        AND DATEADD(d, DATEDIFF(d, 0, GETDATE()), 1)) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-28T14:36:50.237

```
WHERE
  DateDiff(d, Received, GETDATE()) = 0 
```

编辑：正如对此答案的评论中所述，这不是一个理想的解决方案。检查此线程中的其他答案。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-28T14:36:00.567

如果您只想找到今天收到日期的所有记录，并且有未来收到日期的记录，那么您所做的是（非常非常轻微）错误......因为 Between 运算符允许相等的值到结束边界，所以你可以得到 Received date = to 明天午夜的记录......

如果不需要在 Received 上使用索引，那么您需要做的就是检查与当前日期时间的日期差异是否为 0...

```
Where DateDiff(day, received, getdate()) = 0 
```

这个谓词当然不是 SARGable，所以它不能使用索引......如果这是这个查询的问题，那么假设你将来不能有 Received 日期，我会使用它来代替......

```
Where Received >= DateAdd(day, DateDiff(Day, 0, getDate()), 0) 
```

如果收到的日期可能在将来，那么您可能会尽可能地接近最有效的日期......（除了将 Between 更改为 >= AND < ）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-01T05:36:31.950

如果你想要性能，你想要*直接*命中索引，每行没有任何 CPU 等；*因此，我会先*计算范围，然后使用简单的 WHERE 查询。我不知道您使用的是什么数据库，但在 SQL Server 中，以下工作：

```
// ... where @When is the date-and-time we have (perhaps from GETDATE())
DECLARE @DayStart datetime, @DayEnd datetime
SET @DayStart = CAST(FLOOR(CAST(@When as float)) as datetime) -- get day only
SET @DayEnd = DATEADD(d, 1, @DayStart)

SELECT     COUNT(Job) AS Jobs
FROM         dbo.Job
WHERE     (Received >= @DayStart AND Received < @DayEnd) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T14:35:32.317

这几乎是最好的方法。您可以将 DATEADD(d, DATEDIFF(d, 0, GETDATE()), 0) 和 DATEADD(d, DATEDIFF(d, 0, GETDATE()), 1) 放入变量中并改用这些变量，但我没有认为这将提高性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T14:57:50.117

我不确定您如何定义“最佳”，但这会很好。

但是，如果这个查询是你要重复运行的东西，你应该去掉 get_date() 函数，并通过你运行它的任何编程语言在其中粘贴一个文字日期值。尽管它们的输出只改变一次每 24 小时，get_date()、current_date() 等都*是非确定性*函数，这意味着您的 RDMS 可能会使作为存储在其查询缓存中的候选者的查询无效（如果有的话）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T15:04:07.063

怎么样

```
 WHERE
      DATEDIFF(d, Received, GETDATE()) = 0 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-28T15:28:40.710

我通常会使用[Tomalak 建议的解决方案](https://stackoverflow.com/questions/325871/best-way-to-check-for-current-date-in-where-clause-of-sql-query#325907)，但如果您真的非常渴望性能，最好的选择可能是添加一个额外的索引字段 ReceivedDataPartOnly - 它可以存储没有时间部分的数据，然后使用查询

```
declare @today as datetime
set @today = datediff(d, 0, getdate())

select     
    count(job) as jobs
from         
    dbo.job
where     
    received_DatePartOnly = @today 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-02-14T07:48:38.700

转换为相同格式后比较两个日期，如下所示。

```
where CONVERT(varchar, createddate, 1) = CONVERT(varchar, getdate(), 1); 
```

# delphi - 使用 Delphi 检测 Internet 连接激活

> ID：325872
> 
> 赞同：12
> 
> 时间：2008-11-28T14:25:43.740
> 
> 标签：delphi, winapi, wininet, internet-connection

我使用 3G 无线网卡已经有一段时间了，每次连接时，我的防病毒软件都会启动更新。

我想知道我可以使用哪些 Win32 API 函数集来获取有关 Internet 连接事件的通知或查询？

并且是否已经有一组用于 Delphi 的移植标头？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-01T16:53:18.480

我参与了一个项目，只要他们通过 VPN 连接我们的网络，就可以运行用户的登录脚本。为此，我编写了一个辅助单元来检索适配器信息并将其存储到一个简单的记录中。

然后我设置了一个注册表通知，[请参阅此处了解如何在 Delphi 中执行此操作](http://delphi.about.com/od/kbwinshell/l/aa052003a.htm)

注册表通知已打开`HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces`。每次 Windows 获得新的 IP 地址或对适配器连接信息进行任何类型的更改时，都会触发此通知事件。当此事件触发时，我调用了该函数（在下面的代码中）以检索有关适配器的更新信息。我将这个新信息与我之前记录的信息进行了比较……这意味着我必须保存之前的适配器信息查询才能知道是否发生了变化。

无论如何，这是我的助手单元：

```
unit uAdapterInfo;

interface

uses
  Classes,
  SysUtils;

const
  MAX_INTERFACE_NAME_LEN = $100;
  ERROR_SUCCESS   = 0;
  MAXLEN_IFDESCR  = $100;
  MAXLEN_PHYSADDR = 8;

  MIB_IF_OPER_STATUS_NON_OPERATIONAL = 0;
  MIB_IF_OPER_STATUS_UNREACHABLE = 1;
  MIB_IF_OPER_STATUS_DISCONNECTED = 2;
  MIB_IF_OPER_STATUS_CONNECTING  = 3;
  MIB_IF_OPER_STATUS_CONNECTED   = 4;
  MIB_IF_OPER_STATUS_OPERATIONAL = 5;

  MIB_IF_TYPE_OTHER    = 1;
  MIB_IF_TYPE_ETHERNET = 6;
  MIB_IF_TYPE_TOKENRING = 9;
  MIB_IF_TYPE_FDDI     = 15;
  MIB_IF_TYPE_PPP      = 23;
  MIB_IF_TYPE_LOOPBACK = 24;
  MIB_IF_TYPE_SLIP     = 28;

  MIB_IF_ADMIN_STATUS_UP      = 1;
  MIB_IF_ADMIN_STATUS_DOWN    = 2;
  MIB_IF_ADMIN_STATUS_TESTING = 3;

  _MAX_ROWS_ = 20;
  ANY_SIZE   = 1;

type
  MIB_IFROW = record
    wszName:    array[0 .. (MAX_INTERFACE_NAME_LEN * 2 - 1)] of ansichar;
    dwIndex:    longint;
    dwType:     longint;
    dwMtu:      longint;
    dwSpeed:    longint;
    dwPhysAddrLen: longint;
    bPhysAddr:  array[0 .. (MAXLEN_PHYSADDR - 1)] of byte;
    dwAdminStatus: longint;
    dwOperStatus: longint;
    dwLastChange: longint;
    dwInOctets: longint;
    dwInUcastPkts: longint;
    dwInNUcastPkts: longint;
    dwInDiscards: longint;
    dwInErrors: longint;
    dwInUnknownProtos: longint;
    dwOutOctets: longint;
    dwOutUcastPkts: longint;
    dwOutNUcastPkts: longint;
    dwOutDiscards: longint;
    dwOutErrors: longint;
    dwOutQLen:  longint;
    dwDescrLen: longint;
    bDescr:     array[0 .. (MAXLEN_IFDESCR - 1)] of ansichar;
  end;

type
  MIB_IPADDRROW = record
    dwAddr:      longint;
    dwIndex:     longint;
    dwMask:      longint;
    dwBCastAddr: longint;
    dwReasmSize: longint;
    unused1:     word;
    unused2:     word;
  end;

type
  _IfTable = record
    nRows: longint;
    ifRow: array[1.._MAX_ROWS_] of MIB_IFROW;
  end;

type
  _IpAddrTable = record
    dwNumEntries: longint;
    table: array[1..ANY_SIZE] of MIB_IPADDRROW;
  end;

function GetIfTable(pIfTable: Pointer; var pdwSize: longint; bOrder: longint): longint;
  stdcall;
function GetIpAddrTable(pIpAddrTable: Pointer; var pdwSize: longint;
  bOrder: longint): longint; stdcall;

function Get_if_type(iType: integer): string;
function Get_if_admin_status(iStatus: integer): string;
function Get_if_oper_status(iStatus: integer): string;

implementation

function GetIfTable; stdcall; external 'IPHLPAPI.DLL';
function GetIpAddrTable; stdcall; external 'IPHLPAPI.DLL';

function Get_if_type(iType: integer): string;
var
  sResult: string;
begin
  sResult := 'UNKNOWN';
  case iType of
    1: sResult   := 'Other';
    6: sResult   := 'Ethernet';
    9: sResult   := 'Tokenring';
    15: sResult  := 'FDDI';
    23: sResult  := 'PPP';
    24: sResult  := 'Local loopback';
    28: sResult  := 'SLIP';
    37: sResult  := 'ATM';
    71: sResult  := 'IEEE 802.11';
    131: sResult := 'Tunnel';
    144: sResult := 'IEEE 1394 (Firewire)';
  end;

  Result := sResult;
end;

function Get_if_admin_status(iStatus: integer): string;
var
  sResult: string;
begin
  sResult := 'UNKNOWN';

  case iStatus of
    1: sResult := 'UP';
    2: sResult := 'DOWN';
    3: sResult := 'TESTING';
  end;

  Result := sResult;
end;

function Get_if_oper_status(iStatus: integer): string;
var
  sResult: string;
begin
  sResult := 'UNKNOWN';

  case iStatus of
    0: sResult := 'NON_OPERATIONAL';
    1: sResult := 'UNREACHABLE';
    2: sResult := 'DISCONNECTED';
    3: sResult := 'CONNECTING';
    4: sResult := 'CONNECTED';
    5: sResult := 'OPERATIONAL';
  end;

  Result := sResult;
end;

end. 
```

为了从另一个单元使用这个单元，我创建了以下函数，它填充了一个名为`TAdapterInfo`（在我的主单元中声明）的自定义类型：

```
type
  TAdapterInfo = array of record
    dwIndex:    longint;
    dwType:     longint;
    dwMtu:      longint;
    dwSpeed:    extended;
    dwPhysAddrLen: longint;
    bPhysAddr:  string;
    dwAdminStatus: longint;
    dwOperStatus: longint;
    dwLastChange: longint;
    dwInOctets: longint;
    dwInUcastPkts: longint;
    dwInNUcastPkts: longint;
    dwInDiscards: longint;
    dwInErrors: longint;
    dwInUnknownProtos: longint;
    dwOutOctets: longint;
    dwOutUcastPkts: longint;
    dwOutNUcastPkts: longint;
    dwOutDiscards: longint;
    dwOutErrors: longint;
    dwOutQLen:  longint;
    dwDescrLen: longint;
    bDescr:     string;
    sIpAddress: string;
    sIpMask:    string;
  end; 
```

//////////

```
function Get_EthernetAdapterDetail(var AdapterDataFound: TAdapterInfo): boolean;
var
  pIfTable: ^_IfTable;
  pIpTable: ^_IpAddrTable;
  ifTableSize, ipTableSize: longint;
  tmp:      string;
  i, j, k, m: integer;
  ErrCode:  longint;
  sAddr, sMask: in_addr;
  IPAddresses, IPMasks: TStringList;
  sIPAddressLine, sIPMaskLine: string;
  bResult:  boolean;
begin
  bResult  := True; //default return value
  pIfTable := nil;
  pIpTable := nil;

  IPAddresses := TStringList.Create;
  IPMasks     := TStringList.Create;

  try
    // First: just get the buffer size.
    // TableSize returns the size needed.
    ifTableSize := 0; // Set to zero so the GetIfTabel function
    // won't try to fill the buffer yet,
    // but only return the actual size it needs.
    GetIfTable(pIfTable, ifTableSize, 1);
    if (ifTableSize < SizeOf(MIB_IFROW) + Sizeof(longint)) then
    begin
      bResult := False;
      Result  := bResult;
      Exit; // less than 1 table entry?!
    end;

    ipTableSize := 0;
    GetIpAddrTable(pIpTable, ipTableSize, 1);
    if (ipTableSize < SizeOf(MIB_IPADDRROW) + Sizeof(longint)) then
    begin
      bResult := False;
      Result  := bResult;
      Exit; // less than 1 table entry?!
    end;

    // Second:
    // allocate memory for the buffer and retrieve the
    // entire table.
    GetMem(pIfTable, ifTableSize);
    ErrCode := GetIfTable(pIfTable, ifTableSize, 1);

    if ErrCode <> ERROR_SUCCESS then
    begin
      bResult := False;
      Result  := bResult;
      Exit; // OK, that did not work. 
      // Not enough memory i guess.
    end;

    GetMem(pIpTable, ipTableSize);
    ErrCode := GetIpAddrTable(pIpTable, ipTableSize, 1);

    if ErrCode <> ERROR_SUCCESS then
    begin
      bResult := False;
      Result  := bResult;
      Exit;
    end;

    for k := 1 to pIpTable^.dwNumEntries do
    begin
      sAddr.S_addr := pIpTable^.table[k].dwAddr;
      sMask.S_addr := pIpTable^.table[k].dwMask;

      sIPAddressLine := Format('0x%8.8x', [(pIpTable^.table[k].dwIndex)]) +
        '=' + Format('%s', [inet_ntoa(sAddr)]);
      sIPMaskLine    := Format('0x%8.8x', [(pIpTable^.table[k].dwIndex)]) +
        '=' + Format('%s', [inet_ntoa(sMask)]);

      IPAddresses.Add(sIPAddressLine);
      IPMasks.Add(sIPMaskLine);
    end;

    SetLength(AdapterDataFound, pIfTable^.nRows); //initialize the array or records
    for i := 1 to pIfTable^.nRows do
      try
        //if pIfTable^.ifRow[i].dwType=MIB_IF_TYPE_ETHERNET then
        //begin
        m := i - 1;
        AdapterDataFound[m].dwIndex := 4;//(pIfTable^.ifRow[i].dwIndex);
        AdapterDataFound[m].dwType := (pIfTable^.ifRow[i].dwType);
        AdapterDataFound[m].dwIndex := (pIfTable^.ifRow[i].dwIndex);
        AdapterDataFound[m].sIpAddress :=
          IPAddresses.Values[Format('0x%8.8x', [(pIfTable^.ifRow[i].dwIndex)])];
        AdapterDataFound[m].sIpMask :=
          IPMasks.Values[Format('0x%8.8x', [(pIfTable^.ifRow[i].dwIndex)])];
        AdapterDataFound[m].dwMtu := (pIfTable^.ifRow[i].dwMtu);
        AdapterDataFound[m].dwSpeed := (pIfTable^.ifRow[i].dwSpeed);
        AdapterDataFound[m].dwAdminStatus := (pIfTable^.ifRow[i].dwAdminStatus);
        AdapterDataFound[m].dwOperStatus := (pIfTable^.ifRow[i].dwOperStatus);
        AdapterDataFound[m].dwInUcastPkts := (pIfTable^.ifRow[i].dwInUcastPkts);
        AdapterDataFound[m].dwInNUcastPkts := (pIfTable^.ifRow[i].dwInNUcastPkts);
        AdapterDataFound[m].dwInDiscards := (pIfTable^.ifRow[i].dwInDiscards);
        AdapterDataFound[m].dwInErrors := (pIfTable^.ifRow[i].dwInErrors);
        AdapterDataFound[m].dwInUnknownProtos := (pIfTable^.ifRow[i].dwInUnknownProtos);
        AdapterDataFound[m].dwOutNUcastPkts := (pIfTable^.ifRow[i].dwOutNUcastPkts);
        AdapterDataFound[m].dwOutUcastPkts := (pIfTable^.ifRow[i].dwOutUcastPkts);
        AdapterDataFound[m].dwOutDiscards := (pIfTable^.ifRow[i].dwOutDiscards);
        AdapterDataFound[m].dwOutErrors := (pIfTable^.ifRow[i].dwOutErrors);
        AdapterDataFound[m].dwOutQLen := (pIfTable^.ifRow[i].dwOutQLen);
        AdapterDataFound[m].bDescr := (pIfTable^.ifRow[i].bDescr);

        tmp := '';
        for j := 0 to pIfTable^.ifRow[i].dwPhysAddrLen - 1 do
        begin
          if Length(tmp) > 0 then
            tmp := tmp + '-' + format('%.2x', [pIfTable^.ifRow[i].bPhysAddr[j]])
          else
            tmp := tmp + format('%.2x', [pIfTable^.ifRow[i].bPhysAddr[j]]);
        end;

        if Length(tmp) > 0 then
        begin
          AdapterDataFound[m].bPhysAddr := tmp;
        end;
      except
        bResult := False;
        Result  := bResult;
        Exit;
      end;
  finally
    if Assigned(pIfTable) then
    begin
      FreeMem(pIfTable, ifTableSize);
    end;

    FreeAndNil(IPMasks);
    FreeAndNil(IPAddresses);
  end;

  Result := bResult;
end; 
```

顺便说一句，我还使用这个单元和几乎完全相同的代码来创建 的副本`ifconfig -a`，[可以在 github 上找到](https://github.com/MicksMix/ifconfig)。我主要是作为一个练习来教自己如何完成这项任务。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-29T04:58:49.407

```
uses WinInet;

function IsConnected: boolean;
const
  // local system uses a modem to connect to the Internet.
  INTERNET_CONNECTION_MODEM      = 1;
  // local system uses a local area network to connect to the Internet.
  INTERNET_CONNECTION_LAN        = 2;
  // local system uses a proxy server to connect to the Internet.
  INTERNET_CONNECTION_PROXY      = 4;
  // local system's modem is busy with a non-Internet connection.
  INTERNET_CONNECTION_MODEM_BUSY = 8;

var
  dwConnectionTypes : DWORD;
begin
  dwConnectionTypes := INTERNET_CONNECTION_MODEM +
                       INTERNET_CONNECTION_LAN +
                       INTERNET_CONNECTION_PROXY;
  Result := InternetGetConnectedState(@dwConnectionTypes,0);
end; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-28T15:03:08.157

查看 WinINet 中的 InternetGetConnectedState。

一些应用程序还可能轮询已知服务器，并且在获得有效连接之前不执行任何操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-02T13:14:19.200

这是一个如何使用辅助单元的工作示例。它来自我为模拟“ifconfig -a”而编写的一个小项目。这是一个控制台应用程序项目。

```
program ifconfig;

{$APPTYPE CONSOLE}

uses
  SysUtils,
  Classes,
  Winsock,
  uAdapterInfo in 'uAdapterInfo.pas';

type
  TAdapterInfo = array of record
    dwIndex:    longint;
    dwType:     longint;
    dwMtu:      longint;
    dwSpeed:    extended;
    dwPhysAddrLen: longint;
    bPhysAddr:  string;
    dwAdminStatus: longint;
    dwOperStatus: longint;
    dwLastChange: longint;
    dwInOctets: longint;
    dwInUcastPkts: longint;
    dwInNUcastPkts: longint;
    dwInDiscards: longint;
    dwInErrors: longint;
    dwInUnknownProtos: longint;
    dwOutOctets: longint;
    dwOutUcastPkts: longint;
    dwOutNUcastPkts: longint;
    dwOutDiscards: longint;
    dwOutErrors: longint;
    dwOutQLen:  longint;
    dwDescrLen: longint;
    bDescr:     string;
    sIpAddress: string;
    sIpMask:    string;
  end;

  function Get_EthernetAdapterDetail(var AdapterDataFound: TAdapterInfo): boolean;
  var
    pIfTable: ^_IfTable;
    pIpTable: ^_IpAddrTable;
    ifTableSize, ipTableSize: longint;
    tmp:      string;
    i, j, k, m: integer;
    ErrCode:  longint;
    sAddr, sMask: in_addr;
    IPAddresses, IPMasks: TStringList;
    sIPAddressLine, sIPMaskLine: string;
    bResult:  boolean;
  begin
    bResult  := True; //default return value
    pIfTable := nil;
    pIpTable := nil;

    IPAddresses := TStringList.Create;
    IPMasks     := TStringList.Create;

    try
      // First: just get the buffer size.
      // TableSize returns the size needed.
      ifTableSize := 0; // Set to zero so the GetIfTabel function
      // won't try to fill the buffer yet, 
      // but only return the actual size it needs.
      GetIfTable(pIfTable, ifTableSize, 1);
      if (ifTableSize < SizeOf(MIB_IFROW) + Sizeof(longint)) then
      begin
        bResult := False;
        Result := bResult;
        Exit; // less than 1 table entry?!
      end;

      ipTableSize := 0;
      GetIpAddrTable(pIpTable, ipTableSize, 1);
      if (ipTableSize < SizeOf(MIB_IPADDRROW) + Sizeof(longint)) then
      begin
        bResult := False;
        Result := bResult;
        Exit; // less than 1 table entry?!
      end;

      // Second:
      // allocate memory for the buffer and retrieve the 
      // entire table.
      GetMem(pIfTable, ifTableSize);
      ErrCode := GetIfTable(pIfTable, ifTableSize, 1);

      if ErrCode <> ERROR_SUCCESS then
      begin
        bResult := False;
        Result := bResult;
        Exit; // OK, that did not work. 
        // Not enough memory i guess.
      end;

      GetMem(pIpTable, ipTableSize);
      ErrCode := GetIpAddrTable(pIpTable, ipTableSize, 1);

      if ErrCode <> ERROR_SUCCESS then
      begin
        bResult := False;
        Result := bResult;
        Exit;
      end;

      for k := 1 to pIpTable^.dwNumEntries do
      begin
        sAddr.S_addr := pIpTable^.table[k].dwAddr;
        sMask.S_addr := pIpTable^.table[k].dwMask;

        sIPAddressLine := Format('0x%8.8x', [(pIpTable^.table[k].dwIndex)]) +
          '=' + Format('%s', [inet_ntoa(sAddr)]);
        sIPMaskLine    := Format('0x%8.8x', [(pIpTable^.table[k].dwIndex)]) +
          '=' + Format('%s', [inet_ntoa(sMask)]);

        IPAddresses.Add(sIPAddressLine);
        IPMasks.Add(sIPMaskLine);
      end;

      SetLength(AdapterDataFound, pIfTable^.nRows); //initialize the array or records
      for i := 1 to pIfTable^.nRows do
        try
          //if pIfTable^.ifRow[i].dwType=MIB_IF_TYPE_ETHERNET then
          //begin
          m := i - 1;
          AdapterDataFound[m].dwIndex := 4;//(pIfTable^.ifRow[i].dwIndex);
          AdapterDataFound[m].dwType := (pIfTable^.ifRow[i].dwType);
          AdapterDataFound[m].dwIndex := (pIfTable^.ifRow[i].dwIndex);
          AdapterDataFound[m].sIpAddress :=
            IPAddresses.Values[Format('0x%8.8x', [(pIfTable^.ifRow[i].dwIndex)])];
          AdapterDataFound[m].sIpMask :=
            IPMasks.Values[Format('0x%8.8x', [(pIfTable^.ifRow[i].dwIndex)])];
          AdapterDataFound[m].dwMtu := (pIfTable^.ifRow[i].dwMtu);
          AdapterDataFound[m].dwSpeed := (pIfTable^.ifRow[i].dwSpeed);
          AdapterDataFound[m].dwAdminStatus := (pIfTable^.ifRow[i].dwAdminStatus);
          AdapterDataFound[m].dwOperStatus := (pIfTable^.ifRow[i].dwOperStatus);
          AdapterDataFound[m].dwInUcastPkts := (pIfTable^.ifRow[i].dwInUcastPkts);
          AdapterDataFound[m].dwInNUcastPkts := (pIfTable^.ifRow[i].dwInNUcastPkts);
          AdapterDataFound[m].dwInDiscards := (pIfTable^.ifRow[i].dwInDiscards);
          AdapterDataFound[m].dwInErrors := (pIfTable^.ifRow[i].dwInErrors);
          AdapterDataFound[m].dwInUnknownProtos := (pIfTable^.ifRow[i].dwInUnknownProtos);
          AdapterDataFound[m].dwOutNUcastPkts := (pIfTable^.ifRow[i].dwOutNUcastPkts);
          AdapterDataFound[m].dwOutUcastPkts := (pIfTable^.ifRow[i].dwOutUcastPkts);
          AdapterDataFound[m].dwOutDiscards := (pIfTable^.ifRow[i].dwOutDiscards);
          AdapterDataFound[m].dwOutErrors := (pIfTable^.ifRow[i].dwOutErrors);
          AdapterDataFound[m].dwOutQLen := (pIfTable^.ifRow[i].dwOutQLen);
          AdapterDataFound[m].bDescr := (pIfTable^.ifRow[i].bDescr);

          tmp := '';
          for j := 0 to pIfTable^.ifRow[i].dwPhysAddrLen - 1 do
          begin
            if Length(tmp) > 0 then
              tmp := tmp + '-' + format('%.2x', [pIfTable^.ifRow[i].bPhysAddr[j]])
            else
              tmp := tmp + format('%.2x', [pIfTable^.ifRow[i].bPhysAddr[j]]);
          end;

          if Length(tmp) > 0 then
          begin
            AdapterDataFound[m].bPhysAddr := tmp;
          end;
        except
          bResult := False;
          Result := bResult;
          Exit;
        end;
    finally
      if Assigned(pIfTable) then
      begin
        FreeMem(pIfTable, ifTableSize);
      end;

      FreeAndNil(IPMasks);
      FreeAndNil(IPAddresses);
    end;

    Result := bResult;
  end;

var
  AdapterData: TAdapterInfo;
  i: integer;
begin
  try
    WriteLn('');
    if Get_EthernetAdapterDetail(AdapterData) then
    begin
      for i := 0 to Length(AdapterData) - 1 do
      begin
        WriteLn(Format('0x%8.8x', [AdapterData[i].dwIndex]));
        WriteLn('"' + AdapterData[i].bDescr + '"');
        Write(Format(#9 + 'Link encap: %s ', [Get_if_type(AdapterData[i].dwType)]));

        if Length(AdapterData[i].bPhysAddr) > 0 then
          Write('HWaddr: ' + AdapterData[i].bPhysAddr);

        Write(#13 + #10 + #9 + 'inet addr:' + AdapterData[i].sIpAddress);
        WriteLn(' Mask: ' + AdapterData[i].sIpMask);
        WriteLn(Format(#9 + 'MTU: %d Speed:%.2f Mbps', [AdapterData[i].dwMtu,
          (AdapterData[i].dwSpeed) / 1000 / 1000]));
        Write(#9 + 'Admin status:' + Get_if_admin_status(AdapterData[i].dwAdminStatus));
        WriteLn(' Oper status:' + Get_if_oper_status(AdapterData[i].dwOperStatus));
        WriteLn(#9 + Format('RX packets:%d dropped:%d errors:%d unkown:%d',
          [AdapterData[i].dwInUcastPkts + AdapterData[i].dwInNUcastPkts,
          AdapterData[i].dwInDiscards, AdapterData[i].dwInErrors,
          AdapterData[i].dwInUnknownProtos]));
        WriteLn(#9 + Format('TX packets:%d dropped:%d errors:%d txqueuelen:%d',
          [AdapterData[i].dwOutUcastPkts + AdapterData[i].dwOutNUcastPkts,
          AdapterData[i].dwOutDiscards, AdapterData[i].dwOutErrors,
          AdapterData[i].dwOutQLen]));

        WriteLn('');
      end;
    end
    else
    begin
      WriteLn(#13+#10+'*** Error retrieving adapter information');
    end;
  except
    on E: Exception do
      Writeln(E.ClassName, ': ', E.Message);
  end;
end. 
```

# sql - 提高运行 3 分钟以上的 asp 脚本性能

> ID：325873
> 
> 赞同：0
> 
> 时间：2008-11-28T14:26:08.043
> 
> 标签：sql, asp-classic

我使用 SQL 语句删除另一个数据库中存在的记录，但这需要很长时间。

下面的代码是否有其他替代方法可以更快？数据库是Access。

email_DB.mdb 是我要删除其他数据库（表 Newsletter_Subscribers）上存在的电子邮件地址的位置，customers.mdb 是其他数据库（表客户）

```
SQLRemoveDupes = "DELETE FROM Newsletter_Subscribers WHERE EXISTS (select * from [" & strDBPath & "Customers].Customers " _
      & "where Subscriber_Email = Email or Subscriber_Email = EmailO)"

NewsletterConn = "Driver={Microsoft Access Driver (*.mdb)};DBQ=" & strDBPath & "email_DB.mdb"

Set MM_editCmd = Server.CreateObject("ADODB.Command")
MM_editCmd.ActiveConnection = NewsletterConn
MM_editCmd.CommandText = SQLRemoveDupes
MM_editCmd.Execute
MM_editCmd.ActiveConnection.Close
Set MM_editCmd = Nothing 
```

编辑：从答案之一尝试了下面的 SQL，但在运行它时我不断收到错误消息：

SQL: DELETE FROM Newsletter_Subscribers WHERE CustID IN (从 [" & strDBPath & "Customers].Customers where Subscriber_Email = Email 或 Subscriber_Email = EmailO 中选择 CustID)

我得到一个“参数太少。预期为 1”。执行行上的错误消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-28T14:34:06.030

假设客户表中存在 ID 列，SQL 中的以下更改应该会提供更好的性能：

“从 Newsletter_Subscribers WHERE ID IN 中删除（从 [” & strDBPath & “Customers] 中选择 ID。Subscriber_Email = Email 或 Subscriber_Email = EmailO 的客户）”

PS。理想的解决方案（从列名来看）是首先重新设计插入电子邮件的表格和代码逻辑。DS

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-29T17:05:14.930

尝试添加一个 Access Querydef 并调用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-29T18:08:23.727

听起来您在subscriber_enail 字段上没有索引。这会强制进行表扫描（或多次）。在此字段上添加索引，您应该会看到显着的改进。

我会对查询进行编码

```
DELETE FROM Newsletter_Subscribers where (Subscriber_Email = Email or Subscriber_Email = EMail0) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T09:13:38.813

我会使用**WHERE Subscriber_Email IN (Email, Email0)**作为 WHERE 子句

```
SQLRemoveDupes = "DELETE FROM Newsletter_Subscribers WHERE EXISTS " & _ 
(select * from [" & strDBPath & "Customers].Customers where Subscriber_Email IN (Email, EmailO)" 
```

我从经验中发现，在 WHERE 子句中使用 OR 谓词可能会损害性能，因为 SQL 必须单独评估每个子句，并且它可能决定忽略索引并使用表扫描。有时最好将其拆分为两个单独的语句。（我不得不承认我在这里考虑的是 SQL Server，但同样可能适用于 Access）

```
"DELETE FROM Newsletter_Subscribers WHERE EXISTS " & _ 
    (select * from [" & strDBPath & "Customers].Customers where Subscriber_Email = Email)"

"DELETE FROM Newsletter_Subscribers WHERE EXISTS " & _ 
    (select * from [" & strDBPath & "Customers].Customers where Subscriber_Email = EmailO)" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T04:00:54.330

我会尝试将其拆分为两个具有单独数据库连接的单独语句。

首先，获取第一个数据库中的电子邮件地址或 ID 列表（作为字符串）。

其次，构造一个 WHERE NOT IN 语句并在第二个数据库上运行它。

我想这会快得多，因为它不必在两个数据库之间进行互操作。唯一可能的问题是，如果第一个数据库中有数千条记录，并且您达到了 sql 查询字符串的最大长度（无论是什么）。

以下是一些有用的功能：

```
function GetDelimitedRecordString(sql, recordDelimiter)
    dim rs, str
    set rs = db.execute(sql)
    if rs.eof then
        str = ""
  else
        str = rs.GetString(,,,recordDelimiter)
      str = mid(str, 1, len(str)-len(recordDelimiter))
    end if
    rs.close
    set rs = nothing
    GetDelimitedRecordString = str
end function

function FmtSqlList(commaDelimitedStringOrArray)
    ' converts a string of the format "red, yellow, blue" to "'red', 'yellow', 'blue'"
    ' useful for taking input from an html form post (eg a multi-select box or checkbox group) and using it in a SQL WHERE IN clause
    ' prevents sql injection
    dim result:result = ""
    dim arr, str
    if isArray(commaDelimitedStringOrArray) then
        arr = commaDelimitedStringOrArray
    else
        arr = split(commaDelimitedStringOrArray, ",")
    end if
    for each str in arr
        if result<>"" then result = result & ", "
        result = result & "'" & trim(replace(str&"","'","''")) & "'"
    next
    FmtSqlList = result
end function 
```

# delphi - 如何在 dbx 中执行带有 blob 参数的 sql 命令？

> ID：325874
> 
> 赞同：2
> 
> 时间：2008-11-28T14:26:38.573
> 
> 标签：delphi, dbx

我有一个 TSqlDataSet 有一个 blob 字段，我需要在提供者的 BeforeUpdateRecord 事件中获取这个 blob 字段的数据并执行更新命令，我试过这个：

```
Cmd := TSQLQuery.Create(nil);
try
  Cmd.SQLConnection := SQLConnection;
  Cmd.CommandText := 'UPDATE MYTABLE SET IMAGE = :PIMAGE WHERE ID = :PID';
  Cmd.Params.CreateParam(ftBlob, 'PIMAGE ', ptInput).Value := DeltaDS.FieldByName('IMAGE').NewValue; //blob field
  Cmd.Params.CreateParam(ftString, 'PID', ptInput).Value := DeltaDS.FieldByName('ID').NewValue;
  Cmd.ExecSQL;
finally
  Cmd.Free;
end; 
```

当我执行时，我得到一个带有消息的 EDatabaseError：'参数 PIMAGE 没有值。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T12:16:33.857

回答我自己的问题，正确的方法如下：

```
const
  SQL = 'UPDATE MYTABLE SET IMAGE = :PIMAGE WHERE ID = :PID;';
var
  Params: TParams;
begin
  Params := TParams.Create(nil);
  try
    Params.CreateParam(ftBlob, 'PIMAGE', ptInput).AsBlob := DeltaDS.FieldByName('IMAGE').NewValue;
    Params.CreateParam(ftString, 'PID', ptInput).Value := DeltaDS.FieldByName('ID').NewValue;
    SQLConnection.Execute(SQL, Params);
  finally
    Params.Free;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-29T02:56:54.270

您是否尝试过使用其他驱动程序（例如 ODBC）进行测试？错误可能不在您的代码中。这种方法（更改数据提供者/驱动程序）帮助我解决了一些令人困惑的问题，这些问题最终证明不是我的问题。

# xml-rpc - 使用 html 浏览器显示 xml 数据有什么区别？

> ID：325875
> 
> 赞同：0
> 
> 时间：2008-11-28T14:26:54.440
> 
> 标签：xml-rpc

就文本、图像等在计算机屏幕上的显示方式而言，使用 html 浏览器（如 firefox、internet exporer、netscape navigator 等）显示 xml 数据有什么区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T14:50:28.527

这个问题有点令人困惑，因为 XML 是一种基础技术，它没有定义如何表示任何东西，所以这个问题本身没有多大意义。

纯 xml 文件将显示为可折叠的文本数据树，因为任何 xml 文件都是遵循一些基本和简单规则（例如标记语法、特殊字符等）的结构化文本文件。

正如 divo 所说，如果您在 xml 中定义样式表，IExplorer 将呈现的内容将是应用该样式表的结果。这适用于 CSS 样式表和 XSLT 转换样式表。

此外，如果您的 xml 实际上是 xhtml，它将被呈现为普通的 HTML 页面。这是因为 IExplorer 支持 XHTML 规范，该规范是通过 XML 语法定义的标准。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T14:41:03.240

Internet Explorer 的一些特性（与简单的文本编辑器相比）是您应该注意的，例如删除空格和将空标签替换为单个元素（变成）。

IE 还将执行 XML 中包含的任何 XSL 样式表。

# math - 您将数学用于哪些特定的软件开发任务？你使用了哪个数学分支？

> ID：325879
> 
> 赞同：4
> 
> 时间：2008-11-28T14:30:24.043
> 
> 标签：math

我不是在寻找关于[数学对编程是否重要](https://stackoverflow.com/questions/157354/is-mathematics-necessary-for-programming)的​​一般性讨论。

相反，我正在寻找现实世界的场景，在这些场景中，您在作为软件开发人员的职业生涯中实际使用了一些数学分支来解决某些特定问题。

特别是，我正在寻找具体的例子。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-28T14:34:01.693

我经常发现自己在尝试简化条件时使用[德摩根定理](http://en.wikipedia.org/wiki/De_Morgan's_laws)以及一般布尔代数

我偶尔也会写出真值表来验证更改，如下例所示（在最近的代码审查中发现）

（`showAll`并且`s.ShowToUser`都是类型`bool`。）

```
// Before
(showAll ? (s.ShowToUser || s.ShowToUser == false) : s.ShowToUser)

// After!
showAll || s.ShowToUser 
```

几年前，在处理一些简单的图形时，我还使用了一些基本的直角三角法——我必须沿着一条可以有任何角度的线旋转和居中文本字符串。

不是革命性的……但肯定是数学。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T14:33:41.883

用于 3D 渲染和金融工具的线性代数。相同金融工具的回归分析，例如金融工具和指数之间的相关性等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-28T14:45:58.237

统计，我必须编写几种方法来获得统计值，例如[F 概率分布](http://en.wikipedia.org/wiki/F-distribution)、皮尔逊积矩系数，以及一些线性代数相关性、插值和外推，以实现资产定价和股票的[套利定价理论](http://en.wikipedia.org/wiki/Arbitrage_pricing_theory)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-28T14:32:33.383

一切的离散数学，3D的线性代数，物理分析，尤其是计算质量属性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-28T14:53:37.927

*   [一切的线性代数]
*   用于相机校准的投影几何
*   时间序列识别/声音和图像处理的统计过滤
*   （我猜）游戏编程的基本机制和微积分

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-28T14:33:32.693

计算缓存大小以优化性能。当这是您的关键路径时，这并不像听起来那么简单，您必须返回并计算出使用缓存相对于其大小所节省的时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-28T14:41:59.603

我在高中的爱好项目中使用解析几何在opengl中的简单3d引擎。我用于动态打印报告的一些几何计算，比其他 90° 角布局。一年前，我使用一些导数和积分进行商店分析（商店中的产品项目移动）。

Bot 所有的计算都可以在互联网或高中书籍上找到。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-28T14:45:28.987

我从事医学成像，我主要使用线性代数和基本几何来处理与 3D 显示、解剖测量等相关的任何事情......

我还使用数值分析来处理现实世界中的嘈杂数据，并使用大量统计数据来证明算法，为临床试验设计支持工具等……

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-28T14:46:36.957

在我的例子中，三角学和人工智能与图论的游戏。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-28T14:54:11.920

图论创建一个加权图来表示两点之间的所有可能路径，然后找到最短或最有效的路径。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-28T14:56:06.440

还有用于绘制图表和风险计算的统计数据。我使用了正态分布和累积正态分布计算。我猜是 Excel 中非常常用的函数，但实际上我不得不自己编写它们，因为 .NET 库中没有内置支持。遗憾的是，.NET 中内置的数学支持似乎非常基础。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-28T14:57:17.047

我最常使用三角学，也使用过少量微积分，用于 GIS（地图）软件的叠加，比较 3D 空间中的对象，以及在坐标系之间进行转换。

如果您使用 3rd 方库为您进行计算，一般的数学理解非常有用，因为您通常需要了解它们的局限性。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-28T15:10:38.063

我经常一起使用数学和编程，但我的工作目标是数学，所以使用软件来实现。至于我使用的数学；主要是微积分（FFT 分析连续和离散信号），使用斜线线性代数（CORDIC）在没有浮点芯片的 MCU 上进行触发。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-28T16:17:32.547

对于我们的分析师来说，统计数据意味着标准差。

线性代数 - 特别是高斯-乔丹消元法和

微积分 - 差分表形式的导数，用于从 (x, f(x)) 的表中生成多项式

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-28T16:22:20.633

电子工程中的线性代数和复分析。

统计分析数据并将其转换为其他单位（不同的项目）。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-11-28T20:22:49.773

我使用概率和对数几率（两个概率之比的对数）将收到的电子邮件分类为多个类别。大部分繁重的工作都是由我的同事 Fidelis Assis 完成的。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-11-30T00:08:33.860

真实世界场景：更好的员工排班、更有效的航班安排、道路网络中的最短路径、最佳设施/资源位置。

数学分支：[运筹学](http://en.wikipedia.org/wiki/Operations_research)。模糊的定义：构建一个（通常很复杂的）现实世界商业问题的数学模型，然后使用数学工具（例如优化、统计/概率、排队论、图论）来询问这个模型以帮助做出有效的决策（例如最小化成本、最大化效率、预测结果等）。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-11-30T00:15:11.927

科学数据分析的统计数据，例如：

*   分布计算，z-标准化
*   费舍尔 Z
*   可靠性（Alpha、Kappa、Cohen）
*   判别分析
*   规模聚合、极化等

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-12-01T10:44:08.460

在实际的软件开发中，我只真正使用了非常琐碎的线性代数、几何和三角函数。当然，没有什么比每个学科的第一门大学课程更先进的了。

然而，我编写了很多程序来解决非常困难的数学问题，使用一些非常高级的数学。但我不会称之为任何软件开发，因为我实际上并没有开发软件。我的意思是最终结果不是程序本身，而是一个答案。基本上有人会问我什么是本质上的数学问题，我会编写一个程序来回答这个问题。当然，当我再次被问到问题时，我会保留代码，有时我会将代码发送给某人，以便他们自己回答问题，但这在我看来仍然不算软件开发。有时有人会获取该代码并在应用程序中重新实现它，但随后他们是进行软件开发的人，而我是做数学的人。

（希望我开始的这份新工作实际上会让我两者兼得，所以我们会看看结果如何）

# php - 无法在php中的表外显示数据库中的图像

> ID：325887
> 
> 赞同：0
> 
> 时间：2008-11-28T14:32:16.783
> 
> 标签：php, html

我有这个代码

```
<?php
session_start();
if (isset($_GET["cmd"]))
  $cmd = $_GET["cmd"];
else
  die("You should have a 'cmd' parameter in your URL");
 $pk = $_GET["pk"];
$con = mysql_connect("localhost","root","geheim");
if(!$con)
{
die('Connection failed because of' .mysql_error());
}
mysql_select_db("ebay",$con);
if($cmd=="GetAuctionData")
{
echo "<table border='1' width='100%'>
<tr>
<th>Username</th>
<th>Start Date</th>
<th>Description</th>
</tr>";
$sql="SELECT * FROM Auctions WHERE ARTICLE_NO ='$pk'";
$result = mysql_query($sql);
while ($row = mysql_fetch_array($result))
{
echo "<tr>
<td>".$row['USERNAME']."</td>
<td>".$row['ARTICLE_NO']."</td>
<td>".$row['ARTICLE_NAME']."</td>
<td>".$row['SUBTITLE']."</td>
<td>".$row['CURRENT_BID']."</td>
<td>".$row['START_PRICE']."</td>
<td>".$row['BID_COUNT']."</td>
<td>".$row['QUANT_TOTAL']."</td>
<td>".$row['QUANT_SOLD']."</td>
<td>".$row['ACCESSSTARTS']."</td>
<td>".$row['ACCESSENDS']."</td>
<td>".$row['ACCESSORIGIN_END']."</td>
<td>".$row['USERNAME']."</td>
<td>".$row['BEST_BIDDER_ID']."</td>
<td>".$row['FINISHED']."</td>
<td>".$row['WATCH']."</td>
<td>".$row['BUYITNOW_PRICE']."</td>
<td>".$row['PIC_URL']."</td>
<td>".$row['PRIVATE_AUCTION']."</td>
<td>".$row['AUCTION_TYPE']."</td>
<td>".$row['ACCESSINSERT_DATE']."</td>
<td>".$row['ACCESSUPDATE_DATE']."</td>
<td>".$row['CAT_1_ID']."</td>
<td>".$row['CAT_2_ID']."</td>
<td>".$row['ARTICLE_DESC']."</td>
<td>".$row['COUNTRYCODE']."</td>
<td>".$row['LOCATION']."</td>
<td>".$row['CONDITIONS']."</td>
<td>".$row['REVISED']."</td>
<td>".$row['PAYPAL_ACCEPT']."</td>
<td>".$row['PRE_TERMINATED']."</td>
<td>".$row['SHIPPING_TO']."</td>
<td>".$row['FEE_INSERTION']."</td>
<td>".$row['FEE_FINAL']."</td>
<td>".$row['FEE_LISTING']."</td>
<td>".$row['PIC_XXL']."</td>
<td>".$row['PIC_DIASHOW']."</td>
<td>".$row['PIC_COUNT']."</td>
<td>".$row['ITEM_SITE_ID']."</td>
<td>".$row['STARTS']."</td>
<td>".$row['ENDS']."</td>
<td>".$row['ORIGIN_END']."</td>
</tr>
<tr><td></td></tr>";

}
echo "</table>";
echo "<img src=".$row['PIC_URL'].">";
}
mysql_close($con);
?> 
```

这是生成的html：

```
<table border='1' width='100%'>
<tr>
<th>Username</th>
<th>Start Date</th>
<th>Description</th>
</tr><tr>
<td>fashionticker1</td>
<td>220288560247</td>
<td>Ed Hardy Herren Shirt Rock & Roll Weiss XXL Neu & OVP</td>
<td></td>
<td>0.00</td>
<td>49.00</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1.10.2008 16:22:09</td>
<td>6.10.2008 16:22:09</td>
<td>6.10.2008 16:22:09</td>
<td>fashionticker1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>59.00</td>
<td>http://storage.supremeauction.com/flash/ebay2/10/49/76/10497654/13895964e.jpg</td>
<td>0</td>
<td>1</td>
<td>6.10.2008 16:21:47</td>
<td>6.10.2008 16:28:31</td>
<td>32315</td>
<td>0</td>
<td><!-- +++++++++++++++++++++++++ Bitte ändern Sie im eigenen Interesse nichts an diesem Code! ++++++++++++++++++++++++ -->
<!-- +++++++++++++++++++++++++ Das kann massive Fehldarstellungen ihrer Auktion zur Folge haben! +++++++++++++++++++ -->
<!-- +++++++++++++++++++++++++ ++++++++++++++++++++++++++ Ihr Supreme Team +++++++++++++++++++++++++++++++++++++++++ -->
</td>
<td>
<br>
<br>
<style ty</td>
<td>float: right;
</td>
<td>margin: 0px;
</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>padding:5px; 
</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0</td>
<td>0</td>
<td>font-size: 12px;
</td>
<td>color: #333333;
}
#h</td>
<td>0000-00-00 00:00:00</td>
<td>0000-00-00 00:00:00</td>
<td>0000-00-00 00:00:00</td>
</tr>
<tr><td></td></tr></table><img src=> 
```

无论我做什么，我都无法显示图像，当 PIC_URL 为空时，它只在表格上方显示一个占位符图像，我想要它在下面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T14:48:40.917

它应该是：

```
echo "<img src=\"".$row['PIC_URL']."\">"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T14:51:42.097

`<style ty</td>`对我来说似乎是个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T14:55:29.250

您在 while 循环*之外*生成该 img 标记，当 $row 为 false 时结束。换句话说，只有当 $row 不包含任何信息时，您才能访问该代码，因为您已经完成了对行的读取！

要么为图像输出一个单元格，要么为跨越整行的图像输出一个包含单个单元格的新行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T15:33:32.713

```
while ($row = mysql_fetch_array($result))
{
*snip*
}
echo "</table>";
echo "<img src=".$row['PIC_URL'].">"; 
```

因为循环结束了，$row 是假的。你需要把它改成类似的东西。

```
while ($row = mysql_fetch_array($result))
{
*snip*
$lastImg = $row['PIC_URL'];
}
echo "</table>";
echo "<img src=\"$lastImg\">"; 
```

我开始怀疑您的数据库查询返回了有效的 PIC_URL。你应该试试这个，看看你是否从 url 中得到任何有效的图片，尤其是列表中的最后一个 url 是否有效。

```
while ($row = mysql_fetch_array($result))
{
    *snip*
    $images[] = $row['PIC_URL'];
}
echo "</table>";
?><p>Are these valid urls you can open in yer browser?</p><pre><?php
    print_r($images);
?></pre><?php 
```

# biztalk - 绑定文件中的 BizTalk SOAP 端口密码

> ID：325892
> 
> 赞同：1
> 
> 时间：2008-11-28T14:32:34.723
> 
> 标签：biztalk

我继承了一个 BizTalk 2006 应用程序，该应用程序使用多个 SOAP 端口从第 3 方 Web 服务请求数据。Web 服务由“基本”身份验证 - 用户名/密码保护。在对应用程序进行了一些改进后，我将其部署到了一个集成测试服务器，该服务器可以访问第 3 方 Web 服务。BizTalk 应用程序无法检索数据，我很快意识到我忘记在 SOAP 发送端口上设置用户名/密码。我希望 BizTalk 应用程序的部署尽可能自动化，因为当它部署到实时服务器时我可能不在场。我打开绑定文件，找到问题 SOAP 发送端口的第一个并查找*** BizTalk 用来替换密码的 - 除了它没有！似乎 SOAP 端口的密码设置为 NULL 而不是 ***，请参阅此处了解更多详细信息：http: [//msdn.microsoft.com/en-us/library/aa547319.aspx](http://msdn.microsoft.com/en-us/library/aa547319.aspx)

我继续更新绑定，但是当我来测试时，在导入修改后的绑定文件后，我发现我遇到了和以前一样的问题。我已经仔细检查并可以确认绑定文件中现在存在正确的密码，但是，虽然 BizTalk 在导入过程中没有抱怨，但当我运行应用程序时，我得到以下异常：

*详细信息：“ArgumentNullException：字符串引用未设置为字符串的实例。参数名称：s”。*

如果我随后通过 BizTalk 管理控制台手动修改密码，一切正常。

是否有其他人对 SOAP 端口的绑定有类似的问题 - 有没有人有解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-01T03:15:45.447

我过去曾被类似的事情所困扰。密码输入为“****”。还行吧。我不希望我的所有秘密都与绑定文件一起导出。当您导出绑定并将密码保留为 NULL 时，您会得到什么。密码的 XML 元素上的变量类型 (vt) 属性设置为 vt="1"，这与 NULL 相同。输入什么密码都没有关系。它甚至可能导致您描述的错误。我建议您包含一份绑定 XML 的副本以供审核。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-29T01:00:19.807

我以前从未见过这个问题——我正在做你想做的事情，而且效果很好。

我已经从我的一个有效的 BizTalk 绑定中包含了 <TransportTypeData> 元素。希望有一些可以比较的东西会有所帮助。

```
<TransportTypeData>
&lt;CustomProps&gt;
&lt;AuthenticationScheme vt="8"&gt;Basic&lt;/AuthenticationScheme&gt;
&lt;AssemblyName vt="8"&gt;WebService.ProxyClass, Version=1.0.0.0, 
Culture=neutral, PublicKeyToken=xyz&lt;/AssemblyName&gt;
&lt;Username vt="8"&gt;soapUser&lt;/Username&gt;
&lt;UseProxy vt="11"&gt;0&lt;/UseProxy&gt;
&lt;UseSoap12 vt="11"&gt;0&lt;/UseSoap12&gt;&lt;UsingOrchestration vt="11"&gt;0&lt;/UsingOrchestration&gt;
&lt;UseSSO vt="11"&gt;0&lt;/UseSSO&gt;
&lt;Password vt="8"&gt;MYPASSWORD&lt;/Password&gt;
&lt;ProxyPort vt="3"&gt;80&lt;/ProxyPort&gt;&lt;AssemblyPath
vt="8"&gt;C:\ProxyClass\bin\Debug\ProxyClass.dll&lt;/AssemblyPath&gt;
&lt;TypeName vt="8"&gt;ProxyClass.Webservice.servicesService&lt;/TypeName&gt;
&lt;MethodName vt="8"&gt;PickupRequest&lt;/MethodName&gt;
&lt;UseHandlerSetting vt="11"&gt;-1&lt;/UseHandlerSetting&gt;
&lt;/CustomProps&gt;
</TransportTypeData> 
```

# c - 是否有在 Apache C 模块上运行单元测试的框架？

> ID：325894
> 
> 赞同：5
> 
> 时间：2008-11-28T14:32:52.040
> 
> 标签：c, unit-testing, apache, testing, cunit

我即将对现有的 Apache C 模块进行一些更改，以修复一些可能的安全漏洞和一般的不良做法。但是，代码的功能必须保持不变（修复错误的情况除外）。标准回归测试的东西似乎是有序的。我想知道是否有人知道针对代码运行一些回归单元测试的好方法。我正在考虑使用[C-Unit](http://cunit.sourceforge.net.)的方式，但是与 Apache APR 和状态结构的所有联系，我想知道是否有一个很好的方法来测试它。例如，是否有任何可与 C-unit 一起使用的预构建框架？

谢谢

彼得

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-16T11:58:12.673

我一直在考虑回答这个问题，但认为其他人可能会想出更好的答案，因为我的答案相当不令人满意：不，我不知道有任何这样的单元测试框架。

我认为您最好的选择是尝试重构您的 C 模块，使其对 httpd 代码库的依赖项包含在一个非常薄的粘合层中。我不会太担心对 APR 的依赖，它可以很容易地链接到您的单元测试代码中。像使用请求记录这样的事情，你应该试着抽象一下。

如果怀疑代码包含安全漏洞和不良做法，我会建议这样的重构是一个好主意。这通常是一项相当大的工作。

您可能还会考虑运行集成测试而不是单元测试（理想情况下两者都是），即从服务器提出一组请求和预期响应，并运行一个程序来比较实际响应和预期响应。

因此，不是您一直在寻找的响应，您可能自己也想到了这一点。但至少我可以根据经验告诉你，如果由于业务原因不能用新的模块替换模块，那么从长远来看，重构它以提高可测试性可能会有所回报。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T12:07:48.323

花了一些时间为您浏览互联网，因为这是我自己很好奇的一个问题。偶然发现一篇 wiki 文章指出

[http://cutest.sourceforge.net/](http://cutest.sourceforge.net/)

用于 apache 便携式 c 运行时测试。可能值得一试。

# javascript - Visual Studio 2005 Javascript 调试

> ID：325903
> 
> 赞同：2
> 
> 时间：2008-11-28T14:35:24.937
> 
> 标签：javascript, visual-studio-2005

是否可以阻止 Visual Studio 调试外部 JavaScript？我们有一个显示外部网页的窗口。如果页面包含错误的 javascript，那么我的整个会话就会停止并中断。点击继续不会解决问题。

真的很烦很乏味，有没有“只调试我的代码”的等效设置？

编辑：我不想完全禁用javascript调试，只是阻止它调试其他人的蹩脚代码..

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-28T14:38:05.663

检查这篇文章：

[在 Visual Studio 2005 中调试客户端 JavaScript](http://geekswithblogs.net/lazydeveloper/archive/2006/07/10/84552.aspx)

调试 JavaScript 的另一个替代方法是[Firebug](http://getfirebug.com)。我认为它是最好和最完整的 JS 调试器之一。

# c++ - Boost最常用的部分

> ID：325906
> 
> 赞同：117
> 
> 时间：2008-11-28T14:36:29.897
> 
> 标签：c++, boost

当我发现时，[`boost::lexical_cast`](http://www.boost.org/doc/libs/1_47_0/libs/conversion/lexical_cast.htm)我心想“为什么我不早点知道这件事！” - 我讨厌不得不编写类似的代码

```
stringstream ss;
ss << anIntVal;
mystring = ss.str(); 
```

现在我写

```
mystring = boost::lexical_cast<string>(anIntVal); 
```

昨天，在 stackoverflow 上，我遇到了 boost split（另一个可以帮助我编写代码的 gem）。

```
string stringtobesplit = "AA/BB-CC")
vector<string> tokens;

boost::split(tokens, stringtobesplit, boost::is_any_of("/-")); 
// tokens now holds 3 items: AA BB CC 
```

我将开始查看 boost 文档，寻找我可以经常使用的其他功能，但我觉得很容易错过一些东西。

您最常使用/不想拥有哪些增强功能？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-11-28T14:38:56.427

对我来说，boost 最常用的部分可能是[boost::shared_ptr](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/shared_ptr.htm)。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-08-07T17:19:51.077

[BOOST_FOREACH](http://www.boost.org/doc/libs/1_39_0/doc/html/foreach.html)让生活再次变得有价值。

（为什么没有人提到这个？这个问题是8个月前提出的！）

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-11-28T16:01:19.273

我最喜欢的是，没有特别的顺序：

*   正则表达式
*   [文件系统](http://www.boost.org/doc/libs/1_60_0/libs/filesystem/doc/index.htm)
*   线
*   [lexical_cast](http://www.boost.org/doc/libs/1_60_0/doc/html/boost_lexical_cast.html)
*   程序选项（太棒了！）
*   测试（满足我所有的单元测试需求）。
*   字符串算法
*   字符串分词器
*   格式（类型安全的 printf 样式字符串格式）
*   智能指针

当我编写我的第一个跨平台应用程序时，Boost 提供了巨大的帮助——如果没有它，我真的会很挣扎。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2010-03-05T03:46:14.560

我喜欢你如何为`shared_ptr`.
这意味着，例如，您可以使用它`FILE*`并让它为您关闭文件。
例如

```
void safeclose(FILE*fp) {
    if(fp) {
        fclose(fp);
    }
}
void some_fn() {
    boost::shared_ptr<FILE> fp( fopen(myfilename, "a+t"), safeclose );
    //body of the function, and when ever it exits the file gets closed
    fprintf( fp.get(), "a message\n" );
} 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-02-10T17:45:16.457

没有人提到[多索引容器](http://www.boost.org/doc/libs/1_37_0/libs/multi_index/doc/index.html)，所以我会晚点说。您并不经常需要它们，但如果没有提升，创建等效数据结构是一件非常痛苦的事情，而且效率较低。我最近一直在使用它们来创建查找 2 个键的容器。

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2008-11-30T02:01:01.480

我很惊讶没有人提到`boost::optional`. 我发现自己比 Boost 的任何部分都更频繁地使用它，除了`shared_ptr`和`scoped_ptr`.

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2008-11-28T16:05:37.470

没有人提到 boost::tuple？耻辱！

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2008-11-28T23:14:39.850

[`BOOST_STATIC_ASSERT`](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_staticassert.html)

**更新**（2011 年 10 月）：C++11 (C++0x) 有`static_assert` [http://www2.research.att.com/~bs/C++0xFAQ.html#static_assert](http://www2.research.att.com/~bs/C++0xFAQ.html#static_assert)

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2010-03-05T04:05:00.443

我最常用的一个不是 Boost 本身，而是构建在 Boost 之上的[Adob​​e Source Libraries (ASL)](http://stlab.adobe.com/asl_toc.html) — 特别是标准算法的扩展，它接受 boost::range 代替单独的开始/结束迭代器。然后，而不是打电话，说，

```
std::for_each(some_container.begin(), some_container.end(), do_something()); 
```

我可以简单地说

```
adobe::for_each(some_container, do_something()); 
```

（我确实希望 ASL 的这些部分最终迁移到 Boost。）

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2008-11-28T15:18:16.487

我经常使用：

*   升压::信号
*   boost::shared_ptr
*   boost::lexical_cast
*   提升::绑定
*   提升::随机
*   提升::线程
*   提升::不可复制

如果您正在编写一个将在各种平台上使用的库，其他像 Tuple、Static Assert 和 Integer 将非常有用。

Graphs 和 Lambda 之类的东西更具体。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2008-11-29T21:39:09.573

`boost::shared_ptr`是现代 C++ 编程恕我直言的要求。这就是为什么他们将其添加到 TR1 的标准中。`boost::program_options`, `boost::bind`,`boost::signal`如果您知道它们的用途以及如何使用它们，它们真的很棒。最后两个往往会吓到新手。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2008-12-04T15:17:43.163

我已经使用 shared_ptr 多年了。它非常有用，一个项目没有理由没有它。

最重要的是，我还将 Bind/Function/Lambda 用于通用回调机制——在测试时特别有用——以及用于我的通用 sprintf 替换的 Format。

最后，就在前几天，我愤怒地使用 Variant 来解决一个问题（一个解析器可以用一小部分固定的不相关标记类型进行响应）。该解决方案非常优雅，我对此感到非常满意。

* * *

几年过去了，时代变了，所以是时候更新了。SharedPtr 和 Function 现在是标准的一部分，而 Bind 和 Lambda 已被实际的语言级 lambda 功能所淘汰。

我仍然使用 Variant（也已标准化，但我还没有）， Format 很大程度上被 fmtlib （也已标准化）取代。

我使用的 Boost 的很大一部分是 Boost.Asio。正在标准化的过程中。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2010-03-09T18:17:29.837

我们发现 boost::spirit 对于解析 ECMAScript 的业务解决方案非常有用。复杂，但非常好！

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2010-04-20T15:49:15.353

[我很惊讶在答案Boost.Thread](http://www.boost.org/doc/libs/1_42_0/doc/html/thread.html)之间还没有看到。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2012-01-15T08:06:52.733

使用元组迭代地图，如下所示：

```
string key, value;
BOOST_FOREACH(tie(key, value), my_map) { ... } 
```

使用 boost assign，我可以像这样初始化一个地图：

```
map<string, string> my_map = map_list_of("key1", "value1")("key2", "value2")("key3", "value3"); 
```

并且使用范围适配器和 pipe("|") 运算符，我可以向后迭代地图的值（例如）：

```
BOOST_FOREACH(string value, my_multimap.equal_range("X") | map_values | reversed) { ... } 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2010-03-05T04:45:36.060

你应该检查 boost::program_options。它使命令行解析变得更加容易。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2010-06-24T08:34:52.473

我使用 Boost Pointer Containers 而不是`shared_ptr`s 的 STL 容器。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2008-11-28T14:48:46.627

我经常使用[boost::numeric::ublas::matrix](http://www.boost.org/doc/libs/1_37_0/libs/numeric/ublas/doc/matrix.htm)。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2008-11-28T14:41:04.083

我使用最多的现在在 TR1 中可用：

*   共享指针
*   数组类

现在我还使用池类和其他一些更具体的东西。

你现在明白了 Boost 对大多数程序员都是有用的，这就是为什么它是未来标准库的测试平台。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2008-11-28T14:42:20.477

我喜欢 boost::random 和 boost::asio 和 boost::filesystem，但是 boost::bind 、 boost::circular_buffer 和 boost::thread 非常实用，智能指针还可以，但我更喜欢 RAII 作为内存管理

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2009-02-10T17:17:14.247

好的，这是我发现的一个新方法：我可以使用 boost 的*equals*函数并传入 is_iequal 谓词，而不是
使用*stricmp* ， 例如： 而不是

 *```
stricmp( "avalue", mystr.c_str() ) == 0 
```

我可以用

```
equals( "avalue", mystr, is_iequal() ) 
```

给定：

```
#include <boost/algorithm/string.hpp>
using namespace boost::algorithm; 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2011-07-13T09:04:43.453

这是我的两分钱：

*   boost::scope_exit - 无需为一种用途定义 RAII 类
*   提升::任何
*   提升::变体
*   Boost 指针容器库 (ptr_vector)
*   Boost 池库
*   boost::unordered_map / boost::unordered_set

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2012-09-05T19:53:02.493

我`boost::icl`在文本后处理中使用了很多。为我节省了很多时间，否则我必须自己实现文本分割......

`BOOST_FOREACH`在我的代码中无处不在:)

`boost::function`并且`boost::bind`是绝对必须的。虽然现在他们是`std::function`和`std::bind`。这些确实有助于减少不必要的代码量，并且通常对我的设计（或我的妄想）有好处。

我最近开始使用`boost::interprocess::message_queue`，这也是一个很棒的工具。

我会使用更多，但 Qt 有本地方式来做 Boost 所做的很多事情。如果我必须编写纯 C++ 编程，我想我会成为`boost::junkie`:)

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-11-28T15:23:34.463

谈到 boost::lexical_cast，为什么 std::string 库中没有像“格式”这样的静态成员？
几乎所有的 gui 库都有类似 CString::Format("%i") 或 QString::Number("%i") 的东西，它们返回一个初始化的字符串。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2010-11-19T00:16:42.480

我认为这个问题应该反过来。*你不想*使用你的哪一部分？

以我的经验，几乎所有这些在每个问题领域都是有趣和有用的。

您应该花时间查看 boost 文档，以找到您感兴趣的领域。

一个例外可能是`boost::numeric::ublas`它完成了它的工作，但[Eigen](http://eigen.tuxfamily.org/)做得非常好。

# c# - 这种映射可以用（流利的）NHibernate 完成吗？

> ID：325908
> 
> 赞同：1
> 
> 时间：2008-11-28T14:37:24.013
> 
> 标签：c#, nhibernate, fluent-nhibernate, nhibernate-mapping, domain-driven-design

我有一个事件表，其目标是存储网站用户所做的操作。一个动作基本上改变或在表 X 中创建一个新行。这将允许我存储用户完成的所有动作的历史记录。因此，事件包含：

*   主键列
*   描述事件的文本（例如：“发表评论”）
*   如果需要，一个鉴别器列
*   另一个表 A 的外键列
*   另一个表 B 的外键列
*   ……
*   另一个表的外键列 N

Events 表中的一行将只设置一个外键列，所有其他列都将为空（因此它们都可以为空）。该表的行为类似于事件所涉及的实际表的间接表。我不知道是否需要鉴别器，因为所有信息都包含在外键列中。表 A 到 N 可以是任何东西。如果需要，它们的域模型类可以有一个公共接口（IEventRecordable）。

我的问题是：Events 表和 Event 类之间是否可以映射？使用流利的 nhibernate 是否特别可行？可以不用创建很多 Event 的派生类（我不想创建那么多空的子类）就可以做到吗？理想情况下，Event 类如下所示：

```
public class Event
{
    public virtual int Id { get; set; }
    public virtual IEventRecordable ActualEvent { get; set; }
    public virtual string EventDescription { get; set; }
    DateTime EventDateTime { get; set; }
} 
```

领域模型类中的很多类都可以实现 IEventRecordable（主要是一个空接口）。它可以是 User 表或 BlogComment 表...

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T21:17:40.393

如果您忘记了多个外键列，则可以将其设为[<any> 映射](http://www.hibernate.org/hib_docs/nhibernate/html/mapping.html#mapping-types-anymapping)。

# .net - 如何找出可执行文件需要运行的 .NET Framework 版本？

> ID：325918
> 
> 赞同：107
> 
> 时间：2008-11-28T14:42:55.110
> 
> 标签：.net, version, executable

我有一个可执行文件，我想知道该文件需要启动哪个版本的 Microsoft .NET Framework。

有没有一种简单的方法可以在某处找到这些信息？

（到目前为止，我尝试了[ILDASM](https://en.wikipedia.org/wiki/ILDASM#Metadata_storage)和[DUMPBIN](https://support.microsoft.com/kb/177429)，但没有任何运气。）

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2016-10-24T05:41:40.827

使用[记事本](https://en.wikipedia.org/wiki/Microsoft_Notepad)，三个十年前，大小为 200kb，预装工具：

*   打开应用程序`notepad appname.exe`，
*   搜索单词“框架”，
*   重复最后一次搜索，`F3`直到`.NET Framework,version=vX.Y`出现
*   如果没有找到（低于 3.0 的版本）搜索`v2.`... 仍然容易 100 倍，然后安装千兆字节的点网分析器工具和垃圾工作室。

任何其他编辑器/查看器也可以打开二进制文件，例如 Notepad++ 或 totalCommander 的出色文本/十六进制查看器[列表器](http://www.ghisler.com/lister/)。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-11-28T15:00:46.943

我认为您可以可靠地获得的最接近的是确定所需的**CLR**版本。您可以通过使用 ILDASM 并查看“MANIFEST”节点或 Reflector 并将“Application.exe”节点的分解视图作为 IL 来执行此操作。在这两种情况下，都会有一条注释指示 CLR 版本。在 ILDASM 中，注释是“// 元数据版本”，而在 Reflector 中，注释是“目标运行时版本”。

以下是名为 WindowsFormsApplication1.exe 的 .NET WinForms 应用程序的示例：

伊尔达斯姆：

```
// Metadata version: v2.0.50727
.assembly extern mscorlib
{
  .publickeytoken = (B7 7A 5C 56 19 34 E0 89 )                         // .z\V.4..
  .ver 2:0:0:0
}
.assembly extern System
{
  .publickeytoken = (B7 7A 5C 56 19 34 E0 89 )                         // .z\V.4..
  .ver 2:0:0:0
} 
```

反射器：

```
.module WindowsFormsApplication1.exe
.subsystem 0x0002
// MVID: {CA3D2090-16C5-4899-953E-4736D6BC0FA8}
// Target Runtime Version: v2.0.50727 
```

您还可以查看引用程序集的列表并查找具有最高版本号的引用。

同样，使用 ILDASM 查看“MANIFEST”节点数据：

```
.assembly extern System.Drawing
{
  .publickeytoken = (B0 3F 5F 7F 11 D5 0A 3A )                         // .?_....:
  .ver 2:0:0:0
}
.assembly extern System.Core
{
  .publickeytoken = (B7 7A 5C 56 19 34 E0 89 )                         // .z\V.4..
  .ver 3:5:0:0
} 
```

并使用 Reflector，查看列出的每个参考的 dissambly（仍为 IL）：

```
.assembly extern System.Core
{
    .ver 3:5:0:0
    .publickeytoken = (B7 7A 5C 56 19 34 E0 89)
} 
```

通过查找具有最高版本元数据的引用，您可以确定该引用来自哪个版本的框架，这表明您需要安装相同版本的框架才能运行应用程序。话虽如此，我不会将其视为 100% 可靠，但我认为它不会很快改变。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2011-10-25T13:05:21.203

更简化的方法是使用[dotPeek](http://www.jetbrains.com/decompiler/)并查看树中显示的内容。

查看属性面板： [![在此处输入图像描述](https://i.stack.imgur.com/TBsLt.png)](https://i.stack.imgur.com/TBsLt.png)

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2013-06-11T12:54:33.727

您现在可以使用[ILSpy](http://ilspy.net/)检查程序集的目标框架。加载程序集后，点击程序集节点的根，可以在TargetFramework声明下找到信息：

```
[assembly: TargetFramework(".NETFramework,Version=v4.5", FrameworkDisplayName = ".NET Framework 4.5")] 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-11-24T19:03:54.733

从您可以使用的代码中，[`Assembly.ImageRuntimeVersion`](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.imageruntimeversion.aspx)但通过查看文件，最好的办法可能是使用反射器并查看`mscorlib`引用的是哪个版本。

**编辑：** 更好的是使用[ildasm](http://msdn.microsoft.com/en-us/library/aa309387(VS.71).aspx)，打开您的程序集，然后查看程序集的清单。清单的第一行将告诉您构建程序集的*确切*CLR 版本。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2017-02-03T22:42:01.983

从命令行：`find "Framework" MyApp.exe`

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2012-04-06T21:13:44.307

您可以使用名为 CorFlags.exe 的工具。它从 .NET 2.0 开始就存在，我确信它包含在 Windows SDK 7.0 中。默认情况下（在 Windows XP Pro 上）它安装到 C:\Program Files\Microsoft SDKs\Windows\v7.0A\bin\CorFlags.exe。向它提供托管模块的文件路径（没有任何其他命令行标志）以显示其标头信息，其中包括版本。

请记住，此实用程序旨在修改模块的 PE32 标头，因此在仔细阅读[文档](http://msdn.microsoft.com/en-us/library/ms164699%28v=vs.80%29.aspx)之前不要使用任何标志。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-03-27T17:57:28.763

您可以使用 Powershell 在 Windows 中获取文件的 .NET 版本。以下脚本；

```
$path=’.\’
$ErrorActionPreference = "SilentlyContinue"
$files=Get-ChildItem -Path $path -Recurse -include *.dll,*.exe
foreach($file in $files)
{
    $filename = $file.BaseName
    $version = $([System.Reflection.Assembly]::ReflectionOnlyLoadFrom($file.FullName).GetCustomAttributesData() |
                 select-object -ExpandProperty ConstructorArguments | 
                 select-object -ExpandProperty Value | 
                 select-string -Pattern '.NET')
    Write-Output "$filename,$version"
} 
```

提供以下结果； [![在此处输入图像描述](https://i.stack.imgur.com/IG7Lt.png)](https://i.stack.imgur.com/IG7Lt.png)

请注意，结果为该文件夹中的 exe 文件提取了 .NET 版本，但它也会对 dll 执行相同的操作。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-01-18T18:39:57.243

或者你可以找出它有哪个 System.Core 引用。这将告诉您此应用程序正在使用的 .NET Framework 版本。对于 2.0，System.Core 的版本将为 2.0.xxx.xxx。对于 3.5，版本将为 3.5.xxx.xxx 等。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-11-02T12:49:48.920

在 Linux/OSX/unix 上，您可以使用：

```
strings that_app.exe | grep 'v2.\|Framework' 
```

# html - 是通过表单在 HTML 中传递 POST 参数的唯一方法吗？

> ID：325929
> 
> 赞同：24
> 
> 时间：2008-11-28T14:46:49.703
> 
> 标签：html, http, post, get

在 HTML 中，您可以通过以下几种方式使用 GET 请求将数据从一个页面发送到另一个页面：

```
http://www.example.com/somepage.php?data=1 
```

...或者...

```
<form action="somepage.php" method="get">
  <input type="hidden" name="data" value="1" />
  <input type="submit" value="Submit">
</form> 
```

但是，对于 POST 请求，我只看到通过如下表单元素发送的数据：

```
<form action="somepage.php" method="post">
  <input type="hidden" name="data" value="1" />
  <input type="submit" value="Submit">
</form> 
```

如果我只想使用 POST 将一个参数发送到另一个页面，有没有比将其包装在表单中更简单的方法？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-11-28T14:49:46.233

从浏览器只有两种 POST 方式 - 表单或[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)请求。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-28T14:51:01.393

仅使用 HTML，表单是生成 POST 请求的唯一方法。您可以使用服务器端脚本/Javascript 以其他方式生成 POST 请求，但没有其他方式仅用于纯 HTML。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-28T15:47:21.983

正如您已经发现的那样，通过 http 协议传输数据有两种方式：`GET`或`POST`. 还有第三种类型的 HTTP 消息称为`HEAD`，但它实际上只用于获取资源周围的元数据而不下载它，并且没有被广泛实施。

显然，两者`GET`都`POST`可以通过使用`<form>`标签轻松访问。`GET`也可以通过手动将查询参数以名称-值对 ( ) 的形式添加到 URL 来轻松访问`foo.html?a=1&b=2`。

然而，名称-值对的优点和复杂性在于`POST`，名称-值对是从浏览器传递到包含在 HTTP 请求标头中的 Web 服务器，这并不容易访问。`POST`在不使用标记的情况下完成此操作的唯一方法`<form>`是手动更改 HTTP 请求标头并自己添加名称-值对。

还要记住，HTTP 服务器本质上并不知道请求（`GET`或`POST`）是来自主浏览器窗口还是来自 AJAX 调用。无论如何，Web 服务器将读取请求，将破译它是否是`GET`请求`POST`，查找适当的名称-值对，并生成响应。

如果您想了解有关如何正确格式化`POST`请求的更多详细信息，您可以访问[jmarshall.com/easy/http/](http://www.jmarshall.com/easy/http/)或[tcpipguide.com/free/t_HTTPRequestMessageFormat.htm](http://www.tcpipguide.com/free/t_HTTPRequestMessageFormat.htm)。权威资源始终是[W3C](http://www.w3.org/Protocols/HTTP/1.0/spec.html)，但有时 RFC 可能会让我们这些凡人难以阅读。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-28T14:55:35.333

只有在 HTML 中它带有一个表单。

但是，如果您使用服务器端，您可以做到这一点。这是一篇很好的文章，向您展示了如何通过 PHP操作[Get 以将其更改为 Post 。](http://www.zend.com/zend/spotlight/mimocsumissions.php#Heading6)这将需要您使用 fsockopen... 这种方式将使用您的参数 ?id=1¶m=2 ... 并将在服务器端创建一个 POST 请求。您可以使其通用，一旦设置它就可以工作，但是首先设置所有东西需要一点工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T15:51:50.367

您当然可以始终对包含服务器端（或 AJAX）逻辑的页面执行 GET，该逻辑将创建 POST 请求（例如 GET /pageWhichCreatesAPost.py）。当然非常混乱，但在某些情况下，这种解决方法可能有用。

# .net - 使用 .NET 在 Windows 上获取实际文件名（使用正确的大小写）

> ID：325931
> 
> 赞同：38
> 
> 时间：2008-11-28T14:47:02.463
> 
> 标签：.net, windows

[我想做与这个问题](https://stackoverflow.com/questions/74451/getting-actual-file-name-with-proper-casing-on-windows)完全相同的事情：

> Windows 文件系统不区分大小写。给定文件/文件夹名称（例如“somefile”），我如何获得该文件/文件夹的实际名称（例如，如果资源管理器显示它，它应该返回“SomeFile”）？

但我需要在 .NET 中完成，我想要完整的路径（`D:/Temp/Foobar.xml`而不仅仅是`Foobar.xml`）。

我看到`FullName`在`FileInfo`课堂上并不能解决问题。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-28T16:18:06.990

我似乎因为 NTFS 不区分大小写，所以无论名称大小写是否正确，它都会始终正确接受您的输入。

获得正确路径名的唯一方法似乎是像 John Sibly 建议的那样找到文件。

我创建了一个方法，它将采用路径（文件夹或文件）并返回它的正确大小写版本（对于整个路径）：

```
 public static string GetExactPathName(string pathName)
    {
        if (!(File.Exists(pathName) || Directory.Exists(pathName)))
            return pathName;

        var di = new DirectoryInfo(pathName);

        if (di.Parent != null) {
            return Path.Combine(
                GetExactPathName(di.Parent.FullName), 
                di.Parent.GetFileSystemInfos(di.Name)[0].Name);
        } else {
            return di.Name.ToUpper();
        }
    } 
```

以下是在我的机器上运行的一些测试用例：

```
 static void Main(string[] args)
    {
        string file1 = @"c:\documents and settings\administrator\ntuser.dat";
        string file2 = @"c:\pagefile.sys";
        string file3 = @"c:\windows\system32\cmd.exe";
        string file4 = @"c:\program files\common files";
        string file5 = @"ddd";

        Console.WriteLine(GetExactPathName(file1));
        Console.WriteLine(GetExactPathName(file2));
        Console.WriteLine(GetExactPathName(file3));
        Console.WriteLine(GetExactPathName(file4));
        Console.WriteLine(GetExactPathName(file5));

        Console.ReadLine();
    } 
```

如果文件不存在，该方法将返回提供的值。

可能有更快的方法（这使用递归），但我不确定是否有任何明显的方法可以做到这一点。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-04-11T13:16:09.553

我喜欢[Yona 的回答](https://stackoverflow.com/a/326153/1882616)，但我希望它：

*   支持 UNC 路径
*   告诉我路径是否不存在
*   使用迭代而不是递归（因为它只使用尾递归）
*   最小化对 Path.Combine 的调用次数（以最小化字符串连接）。

```
/// <summary>
/// Gets the exact case used on the file system for an existing file or directory.
/// </summary>
/// <param name="path">A relative or absolute path.</param>
/// <param name="exactPath">The full path using the correct case if the path exists.  Otherwise, null.</param>
/// <returns>True if the exact path was found.  False otherwise.</returns>
/// <remarks>
/// This supports drive-lettered paths and UNC paths, but a UNC root
/// will be returned in title case (e.g., \\Server\Share).
/// </remarks>
public static bool TryGetExactPath(string path, out string exactPath)
{
    bool result = false;
    exactPath = null;

    // DirectoryInfo accepts either a file path or a directory path, and most of its properties work for either.
    // However, its Exists property only works for a directory path.
    DirectoryInfo directory = new DirectoryInfo(path);
    if (File.Exists(path) || directory.Exists)
    {
        List<string> parts = new List<string>();

        DirectoryInfo parentDirectory = directory.Parent;
        while (parentDirectory != null)
        {
            FileSystemInfo entry = parentDirectory.EnumerateFileSystemInfos(directory.Name).First();
            parts.Add(entry.Name);

            directory = parentDirectory;
            parentDirectory = directory.Parent;
        }

        // Handle the root part (i.e., drive letter or UNC \\server\share).
        string root = directory.FullName;
        if (root.Contains(':'))
        {
            root = root.ToUpper();
        }
        else
        {
            string[] rootParts = root.Split('\\');
            root = string.Join("\\", rootParts.Select(part => CultureInfo.CurrentCulture.TextInfo.ToTitleCase(part)));
        }

        parts.Add(root);
        parts.Reverse();
        exactPath = Path.Combine(parts.ToArray());
        result = true;
    }

    return result;
} 
```

对于 UNC 路径，这会将根 (\\Server\Share) 以标题大小写而不是精确大小写，因为尝试确定远程服务器的精确大小写名称和共享的精确大小写名称需要**做更多的工作。**如果您有兴趣添加该支持，则必须使用 P/Invoke 方法，例如[NetServerEnum](http://www.pinvoke.net/default.aspx/netapi32.netserverenum)和[NetShareEnum](http://www.pinvoke.net/default.aspx/netapi32/netshareenum.html)。但是这些可能很慢，而且它们不支持预先过滤到您关心的服务器和共享名称。

这是 TryGetExactPath 的单元测试方法（使用[Visual Studio 测试扩展](http://vstestingextensions.codeplex.com/)）：

```
[TestMethod]
public void TryGetExactPathNameTest()
{
    string machineName = CultureInfo.CurrentCulture.TextInfo.ToTitleCase(Environment.MachineName.ToLower());
    string[] testPaths = new[]
        {
            @"C:\Users\Public\desktop.ini",
            @"C:\pagefile.sys",
            @"C:\Windows\System32\cmd.exe",
            @"C:\Users\Default\NTUSER.DAT",
            @"C:\Program Files (x86)\Microsoft.NET\Primary Interop Assemblies",
            @"C:\Program Files (x86)",
            @"Does not exist",
            @"\\Nas\Main\Setups",
            @"\\Nas\Main\Setups\Microsoft\Visual Studio\VS 2015\vssdk_full.exe",
            @"\\" + machineName + @"\C$\Windows\System32\ActionCenter.dll",
            @"..",
        };
    Dictionary<string, string> expectedExactPaths = new Dictionary<string, string>()
        {
            { @"..", Path.GetDirectoryName(Environment.CurrentDirectory) },
        };

    foreach (string testPath in testPaths)
    {
        string lowercasePath = testPath.ToLower();
        bool expected = File.Exists(lowercasePath) || Directory.Exists(lowercasePath);
        string exactPath;
        bool actual = FileUtility.TryGetExactPath(lowercasePath, out exactPath);
        actual.ShouldEqual(expected);
        if (actual)
        {
            string expectedExactPath;
            if (expectedExactPaths.TryGetValue(testPath, out expectedExactPath))
            {
                exactPath.ShouldEqual(expectedExactPath);
            }
            else
            {
                exactPath.ShouldEqual(testPath);
            }
        }
        else
        {
            exactPath.ShouldBeNull();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-03-07T20:29:50.417

受 Ivan 回答的启发，这是一种也处理驱动器号大小写的方法：

```
public string FixFilePathCasing(string filePath)
{
    string fullFilePath = Path.GetFullPath(filePath);

    string fixedPath = "";
    foreach(string token in fullFilePath.Split('\\'))
    {
        //first token should be drive token
        if(fixedPath == "")
        {
            //fix drive casing
            string drive = string.Concat(token, "\\");
            drive = DriveInfo.GetDrives()
                .First(driveInfo => driveInfo.Name.Equals(drive, StringComparison.OrdinalIgnoreCase)).Name;

            fixedPath = drive;
        }
        else
        {
            fixedPath = Directory.GetFileSystemEntries(fixedPath, token).First();
        }
    }

    return fixedPath;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-11T15:40:20.537

我的第二个答案是使用非递归方法。它接受文件和目录。
这次从VB翻译成C#：

```
private string fnRealCAPS(string sDirOrFile)
{
    string sTmp = "";
    foreach (string sPth in sDirOrFile.Split("\\")) {
        if (string.IsNullOrEmpty(sTmp)) {
            sTmp = sPth + "\\";
            continue;
        }
        sTmp = System.IO.Directory.GetFileSystemEntries(sTmp, sPth)[0];
    }
    return sTmp;
}
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T15:21:54.983

我认为您能够做到这一点的唯一方法是使用相同的 Win32 API，即 SHGetFileInfo 方法，在您引用的问题的接受答案中提到。为此，您需要使用一些互操作 p/invoke 调用。查看[pinvoke.net](http://pinvoke.net/search.aspx?search=shgetfileinfo&namespace=[All])以获取有关如何执行此操作以及您将需要哪些其他结构的示例。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-03-19T03:35:29.520

看起来最好的方法是遍历路径中的所有文件夹并获得正确的上限：

```
 Public Function gfnProperPath(ByVal sPath As String) As String
    If Not IO.File.Exists(sPath) AndAlso Not IO.Directory.Exists(sPath) Then Return sPath
    Dim sarSplitPath() As String = sPath.Split("\")
    Dim sAddPath As String = sarSplitPath(0).ToUpper & "\"
    For i = 1 To sarSplitPath.Length - 1
        sPath = sAddPath & "\" & sarSplitPath(i)
        If IO.File.Exists(sPath) Then
            Return IO.Directory.GetFiles(sAddPath, sarSplitPath(i), IO.SearchOption.TopDirectoryOnly)(0)
        ElseIf IO.Directory.Exists(sPath) Then
            sAddPath = IO.Directory.GetDirectories(sAddPath, sarSplitPath(i), IO.SearchOption.TopDirectoryOnly)(0)
        End If
    Next
    Return sPath
End Function 
```

# datetime - 确定两个日期范围是否重叠

> ID：325933
> 
> 赞同：1447
> 
> 时间：2008-11-28T14:48:35.643
> 
> 标签：datetime, math, language-agnostic

给定两个日期范围，确定两个日期范围是否重叠的最简单或最有效的方法是什么？

例如，假设我们有由 DateTime 变量`StartDate1`to`EndDate1` *和* `StartDate2`to表示的范围`EndDate2`。

* * *

## 回答 #1

> 赞同：2668
> 
> 时间：2008-11-28T15:00:40.423

**(StartA <= EndB) 和 (EndA >= StartB)**

*证明：*
令 ConditionA 表示 DateRange A 完全在 DateRange B 之后

```
_                        |---- DateRange A ------|
|---Date Range B -----|                          _ 
```

（如果 为真`StartA > EndB`）

让 ConditionB 表示 DateRange A 完全在 DateRange B 之前

```
|---- DateRange A -----|                        _ 
_                          |---Date Range B ----| 
```

（如果 为真`EndA < StartB`）

如果 A 和 B 都不为真，则存在重叠 -
（如果一个范围既不完全在另一个之后，
也不完全在另一个之前，那么它们必须重叠。）

现在，[德摩根的一条定律](https://en.wikipedia.org/wiki/De_Morgan%27s_laws)说：

`Not (A Or B)` <=> `Not A And Not B`

翻译为：`(StartA <= EndB) and (EndA >= StartB)`

* * *

注意：这包括边缘完全重叠的情况。如果您希望排除它，请将运算符
更改 为, 和`>=``>``<=``<`

* * *

笔记2。感谢@Baodad，看到[这个博客](http://baodad.blogspot.com/2014/06/date-range-overlap.html)，实际重叠最少：
{ `endA-startA`, `endA - startB`, `endB-startA`, `endB - startB`}

`(StartA <= EndB) and (EndA >= StartB)` `(StartA <= EndB) and (StartB <= EndA)`

* * *

注3。感谢@tomosius，一个较短的版本如下：
`DateRangesOverlap = max(start1, start2) < min(end1, end2)`
这实际上是一个较长实现的语法快捷方式，其中包括额外的检查以验证开始日期是否在结束日期之前或之前。从上面得出：

如果开始日期和结束日期可能是无序的，即，如果可能是`startA > endA`or `startB > endB`，那么您还必须检查它们是否有序，这意味着您必须添加两个额外的有效性规则：
`(StartA <= EndB) and (StartB <= EndA) and (StartA <= EndA) and (StartB <= EndB)` or:
`(StartA <= EndB) and (StartA <= EndA) and (StartB <= EndA) and (StartB <= EndB)` or,
`(StartA <= Min(EndA, EndB) and (StartB <= Min(EndA, EndB))` or:
`(Max(StartA, StartB) <= Min(EndA, EndB)`

但是要实现`Min()`and `Max()`，您必须编写代码（为了简洁起见，使用 C 三元）：
`(StartA > StartB? Start A: StartB) <= (EndA < EndB? EndA: EndB)`

* * *

## 回答 #2

> 赞同：471
> 
> 时间：2008-11-28T14:49:57.793

我相信，如果两个范围重叠就足够了：

```
(StartDate1 <= EndDate2) and (StartDate2 <= EndDate1) 
```

* * *

## 回答 #3

> 赞同：151
> 
> 时间：2011-04-08T22:42:14.027

这篇文章[Time Period Library for .NET通过枚举](http://www.codeproject.com/KB/datetime/TimePeriod.aspx)**PeriodRelation**描述了两个时间段的关系：

```
// ------------------------------------------------------------------------
public enum PeriodRelation
{
    After,
    StartTouching,
    StartInside,
    InsideStartTouching,
    EnclosingStartTouching,
    Enclosing,
    EnclosingEndTouching,
    ExactMatch,
    Inside,
    InsideEndTouching,
    EndInside,
    EndTouching,
    Before,
} // enum PeriodRelation 
```

![在此处输入图像描述](https://i.stack.imgur.com/0c6q0.png)

* * *

## 回答 #4

> 赞同：89
> 
> 时间：2008-11-30T06:54:50.373

为了推理时间关系（或任何其他区间关系），请考虑[艾伦的区间代数](http://en.wikipedia.org/wiki/Allen%27s_Interval_Algebra)。它描述了两个区间相互之间可能存在的 13 种可能关系。您可以找到其他参考资料——“艾伦间隔”似乎是一个有效的搜索词。[您还可以在 Snodgrass 的Developing Time-Oriented Applications in SQL](http://www.cs.arizona.edu/~rts/publications.html)（URL 在线提供 PDF）以及 Date、Darwen and Lorentzos [Temporal Data and the Relational Model](https://rads.stackoverflow.com/amzn/click/com/B005UY0W0E) (2002) 或 [Time and Relational Theory: Temporal Databases 中](https://rads.stackoverflow.com/amzn/click/com/B00N2SNSUG)找到有关这些操作的信息[关系模型和 SQL](https://rads.stackoverflow.com/amzn/click/com/B00N2SNSUG)（2014 年；实际上是 TD&RM 的第二版）。

* * *

简短（ish）的答案是：给定两个日期间隔`A`和`B`组件`.start`和`.end`和约束`.start <= .end`，那么两个间隔重叠，如果：

```
A.end >= B.start AND A.start <= B.end 
```

您可以调整`>=`vs`>`和`<=`vs的使用`<`以满足您对重叠程度的要求。

* * *

埃里克评论：

> 如果你把事情数得有趣，你只能得到 13……当我发疯的时候，我可以得到“两个间隔可以有的 15 种可能的关系”。通过合理的计数，我只得到了六个，如果你不关心 A 或 B 先出现，我只得到三个（没有相交，部分相交，一个完全在另一个中）。15 是这样的：[before:before, start, inside, end, after], [start:start, inside, end, after], [within:within, end, after], [end:end, after], [之后：之后]。

我认为您不能计算“之前：之前”和“之后：之后”这两个条目。如果您将某些关系与它们的倒数等同起来，我可以看到 7 个条目（参见引用的 Wikipedia URL 中的图表；它有 7 个条目，其中 6 个具有不同的逆，等于没有不同的逆）。而三个是否明智取决于您的要求。

```
----------------------|-------A-------|----------------------
    |----B1----|
           |----B2----|
               |----B3----|
               |----------B4----------|
               |----------------B5----------------|
                      |----B6----|
----------------------|-------A-------|----------------------
                      |------B7-------|
                      |----------B8-----------|
                         |----B9----|
                         |----B10-----|
                         |--------B11--------|
                                      |----B12----|
                                         |----B13----|
----------------------|-------A-------|---------------------- 
```

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2012-09-06T02:07:10.977

如果还应计算重叠本身，则可以使用以下公式：

```
overlap = max(0, min(EndDate1, EndDate2) - max(StartDate1, StartDate2))
if (overlap > 0) { 
    ...
} 
```

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2010-08-06T02:39:42.670

所有根据范围相互关联的位置检查多种条件的解决方案都可以通过*确保特定范围更早开始而大大简化！*您可以通过在必要时预先交换范围来确保第一个范围更早（或同时）开始。

然后，如果另一个范围开始小于或等于第一个范围结束（如果包括范围，则包含开始和结束时间）或小于（如果范围包括开始但不包括结束），则可以检测重叠.

假设两端都包含，只有四种可能性，其中一种是不重叠的：

```
|----------------------|        range 1
|--->                           range 2 overlap
 |--->                          range 2 overlap
                       |--->    range 2 overlap
                        |--->   range 2 no overlap 
```

范围 2 的端点不进入其中。所以，在伪代码中：

```
def doesOverlap (r1, r2):
    if r1.s > r2.s:
        swap r1, r2
    if r2.s > r1.e:
        return false
    return true 
```

这可以进一步简化为：

```
def doesOverlap (r1, r2):
    if r1.s > r2.s:
        swap r1, r2
    return r2.s <= r1.e 
```

如果范围在开头包含而在结尾不包含，则只需在第二个语句中替换`>`with （对于第一个代码段：在第二个代码段中，您将使用而不是）：`>=``if``<``<=`

```
|----------------------|        range 1
|--->                           range 2 overlap
 |--->                          range 2 overlap
                       |--->    range 2 no overlap
                        |--->   range 2 no overlap 
```

您大大限制了您必须进行的检查次数，因为您通过确保范围 1 永远不会在范围 2 之后开始，提前删除了一半的问题空间。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2015-03-13T13:19:48.973

这是另一个使用 JavaScript 的解决方案。我的解决方案的特点：

*   将空值处理为无穷大
*   假设下限是包容性的，而上限是排斥性的。
*   附带一堆测试

测试基于整数，但由于 JavaScript 中的日期对象具有可比性，您也可以只输入两个日期对象。或者您可以输入毫秒时间戳。

# 代码：

```
/**
 * Compares to comparable objects to find out whether they overlap.
 * It is assumed that the interval is in the format [from,to) (read: from is inclusive, to is exclusive).
 * A null value is interpreted as infinity
 */
function intervalsOverlap(from1, to1, from2, to2) {
    return (to2 === null || from1 < to2) && (to1 === null || to1 > from2);
} 
```

# 测试：

```
describe('', function() {
    function generateTest(firstRange, secondRange, expected) {
        it(JSON.stringify(firstRange) + ' and ' + JSON.stringify(secondRange), function() {
            expect(intervalsOverlap(firstRange[0], firstRange[1], secondRange[0], secondRange[1])).toBe(expected);
        });
    }

    describe('no overlap (touching ends)', function() {
        generateTest([10,20], [20,30], false);
        generateTest([20,30], [10,20], false);

        generateTest([10,20], [20,null], false);
        generateTest([20,null], [10,20], false);

        generateTest([null,20], [20,30], false);
        generateTest([20,30], [null,20], false);
    });

    describe('do overlap (one end overlaps)', function() {
        generateTest([10,20], [19,30], true);
        generateTest([19,30], [10,20], true);

        generateTest([10,20], [null,30], true);
        generateTest([10,20], [19,null], true);
        generateTest([null,30], [10,20], true);
        generateTest([19,null], [10,20], true);
    });

    describe('do overlap (one range included in other range)', function() {
        generateTest([10,40], [20,30], true);
        generateTest([20,30], [10,40], true);

        generateTest([10,40], [null,null], true);
        generateTest([null,null], [10,40], true);
    });

    describe('do overlap (both ranges equal)', function() {
        generateTest([10,20], [10,20], true);

        generateTest([null,20], [null,20], true);
        generateTest([10,null], [10,null], true);
        generateTest([null,null], [null,null], true);
    });
}); 
```

使用 karma&jasmine&PhantomJS 运行时的结果：

> PhantomJS 1.9.8 (Linux)：20 次成功执行 20 次（0.003 秒 / 0.004 秒）

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2017-10-28T16:41:15.730

[![在此处输入图像描述](https://i.stack.imgur.com/bDVe1.png)](https://i.stack.imgur.com/bDVe1.png)

这是执行魔术的代码：

```
 var isOverlapping =  ((A == null || D == null || A <= D) 
            && (C == null || B == null || C <= B)
            && (A == null || B == null || A <= B)
            && (C == null || D == null || C <= D)); 
```

在哪里..

*   A -> 1开始
*   B -> 1结束
*   C -> 2开始
*   D -> 2结束

证明？查看此测试[控制台代码要点](https://gist.github.com/sandeeptalabathula/3b469065251eb1992dd92b168fea0b61)。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2019-01-08T19:45:26.663

记住解决方案的一种简单方法是
`min(ends)>max(starts)`

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2017-02-21T07:53:08.573

这是我在*Java*中的解决方案，它也适用于无限间隔

```
private Boolean overlap (Timestamp startA, Timestamp endA,
                         Timestamp startB, Timestamp endB)
{
    return (endB == null || startA == null || !startA.after(endB))
        && (endA == null || startB == null || !endA.before(startB));
} 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2008-11-28T14:51:58.943

我会做

```
StartDate1.IsBetween(StartDate2, EndDate2) || EndDate1.IsBetween(StartDate2, EndDate2) 
```

`IsBetween`类似的东西在哪里

```
 public static bool IsBetween(this DateTime value, DateTime left, DateTime right) {
        return (value > left && value < right) || (value < left && value > right);
    } 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2013-11-05T08:24:53.787

此处发布的解决方案不适用于所有重叠范围...

```
----------------------|--------A--------|------------ ------------
    |----B1----|
           |----B2----|
               |----B3----|
               |---------B4----------|
               |----------------B5----------------|
                      |----B6----|
----------------------|--------A--------|------------ ------------
                      |--------B7--------|
                      |---------B8------------|
                         |----B9----|
                         |----B10-----|
                         |--------B11--------|
                                      |----B12----|
                                         |----B13----|
----------------------|--------A--------|------------ ------------
```

我的工作解决方案是：

```
和 （
  ('start_date' BETWEEN STARTDATE AND ENDDATE) -- 满足内部和结束日期外部
  或者
  ('end_date' BETWEEN STARTDATE AND ENDDATE) -- 满足内部和外部开始日期
  或者
  (STARTDATE BETWEEN 'start_date' AND 'end_date') -- 日期在内部的外部范围只需要一个。
)

```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2013-09-12T20:28:36.153

这是我使用 moment.js 的 javascript 解决方案：

```
// Current row dates
var dateStart = moment("2014-08-01", "YYYY-MM-DD");
var dateEnd = moment("2014-08-30", "YYYY-MM-DD");

// Check with dates above
var rangeUsedStart = moment("2014-08-02", "YYYY-MM-DD");
var rangeUsedEnd = moment("2014-08-015", "YYYY-MM-DD");

// Range covers other ?
if((dateStart <= rangeUsedStart) && (rangeUsedEnd <= dateEnd)) {
    return false;
}
// Range intersects with other start ?
if((dateStart <= rangeUsedStart) && (rangeUsedStart <= dateEnd)) {
    return false;
}
// Range intersects with other end ?
if((dateStart <= rangeUsedEnd) && (rangeUsedEnd <= dateEnd)) {
    return false;
}

// All good
return true; 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2018-07-18T17:43:40.837

**使用 momentjs 的简短回答**：

```
function isOverlapping(startDate1, endDate1, startDate2, endDate2){ 
    return moment(startDate1).isSameOrBefore(endDate2) && 
    moment(startDate2).isSameOrBefore(endDate1);
} 
```

答案基于上述答案，但缩短了。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2021-02-08T13:50:03.037

由于针对不同的语言和环境有多种答案，这里有一个针对标准 ANSI SQL 的答案。

在标准 SQL 中，它就像

```
(StartDate1, EndDate1) overlaps (StartDate2, EndDate2) 
```

假设所有四列都是`DATE`或`TIMESTAMP`列。如果两个范围至少有一天相同，则返回 true（假设`DATE`值）

（但并非所有 DBMS 产品都支持）

* * *

在 PostgreSQL 中，使用[日期范围](https://www.postgresql.org/docs/current/rangetypes.html)也很容易测试是否*包含*

```
daterange(StartDate1, EndDate1) @> daterange(StartDate2, EndDate2) 
```

如果第二个范围完全包含在第一个范围内（与“重叠”不同），则上述返回 true

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2014-07-05T13:44:37.613

在 Microsoft SQL SERVER 中 - SQL 函数

```
CREATE FUNCTION IsOverlapDates 
(
    @startDate1 as datetime,
    @endDate1 as datetime,
    @startDate2 as datetime,
    @endDate2 as datetime
)
RETURNS int
AS
BEGIN
DECLARE @Overlap as int
SET @Overlap = (SELECT CASE WHEN  (
        (@startDate1 BETWEEN @startDate2 AND @endDate2) -- caters for inner and end date outer
        OR
        (@endDate1 BETWEEN @startDate2 AND @endDate2) -- caters for inner and start date outer
        OR
        (@startDate2 BETWEEN @startDate1 AND @endDate1) -- only one needed for outer range where dates are inside.
        ) THEN 1 ELSE 0 END
    )
    RETURN @Overlap

END
GO

--Execution of the above code
DECLARE @startDate1 as datetime
DECLARE @endDate1 as datetime
DECLARE @startDate2 as datetime
DECLARE @endDate2 as datetime
DECLARE @Overlap as int
SET @startDate1 = '2014-06-01 01:00:00' 
SET @endDate1 =   '2014-06-01 02:00:00'
SET @startDate2 = '2014-06-01 01:00:00' 
SET @endDate2 =   '2014-06-01 01:30:00'

SET @Overlap = [dbo].[IsOverlapDates]  (@startDate1, @endDate1, @startDate2, @endDate2)

SELECT Overlap = @Overlap 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2016-11-04T23:30:07.810

> 最简单的

最简单的方法是使用精心设计的专用库进行日期时间工作。

```
someInterval.overlaps( anotherInterval ) 
```

# java.time & ThreeTen-Extra

业内最好的是[`java.time`](https://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)内置于 Java 8 及更高版本的框架。再加上[ThreeTen-Extra](http://www.threeten.org/threeten-extra/)项目，它用额外的类补充 java.time，特别是[`Interval`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Interval.html)我们在这里需要的类。

至于`language-agnostic`这个问题上的标签，这两个项目的源代码都可以在其他语言中使用（注意他们的许可证）。

## `Interval`

该类[`org.threeten.extra.Interval`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Interval.html)很方便，但需要日期时间时刻（`java.time.Instant`对象）而不是仅日期值。因此，我们继续使用 UTC 中的第一刻来表示日期。

```
Instant start = Instant.parse( "2016-01-01T00:00:00Z" );
Instant stop = Instant.parse( "2016-02-01T00:00:00Z" ); 
```

创建一个`Interval`来表示该时间跨度。

```
Interval interval_A = Interval.of( start , stop ); 
```

我们也可以`Interval`用一个起始时刻加上一个来定义一个[`Duration`](http://docs.oracle.com/javase/8/docs/api/java/time/Duration.html)。

```
Instant start_B = Instant.parse( "2016-01-03T00:00:00Z" );
Interval interval_B = Interval.of( start_B , Duration.of( 3 , ChronoUnit.DAYS ) ); 
```

比较测试重叠很容易。

```
Boolean overlaps = interval_A.overlaps( interval_B ); 
```

您可以将 a[`Interval`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Interval.html)与另一个[`Interval`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Interval.html)或进行比较[`Instant`](http://docs.oracle.com/javase/8/docs/api/java/time/Instant.html?is-external=true)：

*   [`abuts`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Interval.html#abuts-org.threeten.extra.Interval-)
*   [`contains`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Interval.html#contains-java.time.Instant-)
*   [`encloses`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Interval.html#encloses-org.threeten.extra.Interval-)
*   [`equals`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Interval.html#equals-java.lang.Object-)
*   [`isAfter`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Interval.html#isAfter-org.threeten.extra.Interval-)
*   [`isBefore`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Interval.html#isBefore-org.threeten.extra.Interval-)
*   [`overlaps`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Interval.html#overlaps-org.threeten.extra.Interval-)

所有这些都使用`Half-Open`定义时间跨度的方法，其中开始是*包容*的，结束是*排斥*的。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2017-01-18T14:06:06.460

我有一种情况，我们有日期而不是日期时间，并且日期只能在开始/结束时重叠。下面的例子：

[![在此处输入图像描述](https://i.stack.imgur.com/qzRBx.png)](https://i.stack.imgur.com/qzRBx.png)

（绿色是当前区间，蓝色块是有效区间，红色是重叠区间）。

我将 Ian Nelson 的答案改编为以下解决方案：

```
 (startB <= startA && endB > startA)
|| (startB >= startA && startB < endA) 
```

这匹配所有重叠情况，但忽略允许的重叠情况。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2017-04-10T05:56:52.833

@Bretana 给出的数学解决方案很好，但忽略了两个具体细节：

1.  封闭或半开区间的方面
2.  空区间

* * *

关于区间边界的封闭或开放状态，@Bretana 的解决方案**对封闭区间有效**

> (StartA <= EndB) 和 (EndA >= StartB)

可以将**半开区间重写为**：

> (StartA < EndB) 和 (EndA > StartB)

这种修正是必要的，因为根据定义，开区间边界不属于区间的取值范围。

* * *

关于**空区间**，好吧，这里上面显示的关系不成立。根据定义不包含任何有效值的空区间必须作为特殊情况处理。我通过这个例子通过我的 Java 时间库[Time4J来演示它：](https://github.com/MenoData/Time4J)

```
MomentInterval a = MomentInterval.between(Instant.now(), Instant.now().plusSeconds(2));
MomentInterval b = a.collapse(); // make b an empty interval out of a

System.out.println(a); // [2017-04-10T05:28:11,909000000Z/2017-04-10T05:28:13,909000000Z)
System.out.println(b); // [2017-04-10T05:28:11,909000000Z/2017-04-10T05:28:11,909000000Z) 
```

前面的方括号“[”表示封闭的开始，而最后一个方括号“)”表示开放的结束。

```
System.out.println(
      "startA < endB: " + a.getStartAsInstant().isBefore(b.getEndAsInstant())); // false
System.out.println(
      "endA > startB: " + a.getEndAsInstant().isAfter(b.getStartAsInstant())); // true

System.out.println("a overlaps b: " + a.intersects(b)); // a overlaps b: false 
```

如上所示，空区间违反了上面的重叠条件（尤其是 startA < endB），因此 Time4J（和其他库也一样）必须将其作为特殊边缘情况处理，以保证任意区间与空区间的重叠不存在。当然，日期间隔（在 Time4J 中默认是关闭的，但也可以是半开的，就像空日期间隔一样）以类似的方式处理。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2017-06-14T18:57:56.667

这是对@charles-bretana[出色答案的扩展。](https://stackoverflow.com/a/325964/2314737)

然而，答案并没有区分开放、封闭和半开放（或半封闭）区间。

**案例1**：A，B是闭区间

```
A = [StartA, EndA]
B = [StartB, EndB]

                         [---- DateRange A ------]   (True if StartA > EndB)
[--- Date Range B -----]                           

[---- DateRange A -----]                             (True if EndA < StartB)
                         [--- Date Range B ----] 
```

重叠当先：`(StartA <= EndB) and (EndA >= StartB)`

**情况2**：A，B是开区间

```
A = (StartA, EndA)
B = (StartB, EndB)

                         (---- DateRange A ------)   (True if StartA >= EndB)
(--- Date Range B -----)                           

(---- DateRange A -----)                             (True if EndA <= StartB)
                         (--- Date Range B ----) 
```

重叠当先：`(StartA < EndB) and (EndA > StartB)`

**案例3**：A、B全开

```
A = [StartA, EndA)
B = [StartB, EndB)

                         [---- DateRange A ------)   (True if StartA >= EndB) 
[--- Date Range B -----)                           

[---- DateRange A -----)                             (True if EndA <= StartB)
                         [--- Date Range B ----) 
```

重叠条件：`(StartA < EndB) and (EndA > StartB)`

**案例 4**：A、B 保持打开状态

```
A = (StartA, EndA]
B = (StartB, EndB]

                         (---- DateRange A ------]   (True if StartA >= EndB)
(--- Date Range B -----]                           

(---- DateRange A -----]                             (True if EndA <= StartB)
                         (--- Date Range B ----] 
```

重叠条件：`(StartA < EndB) and (EndA > StartB)`

**案例5**：A右开，B关

```
A = [StartA, EndA)
B = [StartB, EndB]

                         [---- DateRange A ------)    (True if StartA > EndB)
[--- Date Range B -----]                           

[---- DateRange A -----)                              (True if EndA <= StartB)  
                         [--- Date Range B ----] 
```

重叠条件：`(StartA <= EndB) and (EndA > StartB)`

**ETC...**

最后，两个区间重叠的一般条件是

**(StartA < EndB) 和 (EndA > StartB)**

每当在两个包含的端点之间进行比较时，其中将严格的不等式变为非严格的不等式。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2014-03-27T16:47:49.643

如果您使用的日期范围尚未结束（仍在进行中），例如未设置 endDate = '0000-00-00' 您不能使用 BETWEEN 因为 0000-00-00 不是有效日期！

我使用了这个解决方案：

```
(Startdate BETWEEN '".$startdate2."' AND '".$enddate2."')  //overlap: starts between start2/end2
OR (Startdate < '".$startdate2."' 
  AND (enddate = '0000-00-00' OR enddate >= '".$startdate2."')
) //overlap: starts before start2 and enddate not set 0000-00-00 (still on going) or if enddate is set but higher then startdate2 
```

如果 startdate2 高于 enddate 则没有重叠！

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2016-12-09T16:16:33.277

答案对我来说太简单了，所以我创建了一个更通用的动态 SQL 语句来检查一个人是否有任何重叠的日期。

```
SELECT DISTINCT T1.EmpID
FROM Table1 T1
INNER JOIN Table2 T2 ON T1.EmpID = T2.EmpID 
    AND T1.JobID <> T2.JobID
    AND (
        (T1.DateFrom >= T2.DateFrom AND T1.dateFrom <= T2.DateTo) 
        OR (T1.DateTo >= T2.DateFrom AND T1.DateTo <= T2.DateTo)
        OR (T1.DateFrom < T2.DateFrom AND T1.DateTo IS NULL)
    )
    AND NOT (T1.DateFrom = T2.DateFrom) 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-11-28T14:52:48.177

在我看来，最简单的方法是比较 EndDate1 是否在 StartDate2 之前，而 EndDate2 是否在 StartDate1 之前。

当然，如果您正在考虑 StartDate 总是在 EndDate 之前的时间间隔。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2015-02-06T05:21:51.353

使用 Java util.Date，这就是我所做的。

```
 public static boolean checkTimeOverlaps(Date startDate1, Date endDate1, Date startDate2, Date endDate2)
    {
        if (startDate1 == null || endDate1 == null || startDate2 == null || endDate2 == null)
           return false;

        if ((startDate1.getTime() <= endDate2.getTime()) && (startDate2.getTime() <= endDate1.getTime()))
           return true;

        return false;
    } 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-10-24T23:40:45.597

对于红宝石，我还发现了这个：

```
class Interval < ActiveRecord::Base

  validates_presence_of :start_date, :end_date

  # Check if a given interval overlaps this interval    
  def overlaps?(other)
    (start_date - other.end_date) * (other.start_date - end_date) >= 0
  end

  # Return a scope for all interval overlapping the given interval, including the given interval itself
  named_scope :overlapping, lambda { |interval| {
    :conditions => ["id <> ? AND (DATEDIFF(start_date, ?) * DATEDIFF(?, end_date)) >= 0", interval.id, interval.end_date, interval.start_date]
  }}

end 
```

在这里找到了很好的解释-> [http://makandracards.com/makandra/984-test-if-two-date-ranges-overlap-in-ruby-or-rails](http://makandracards.com/makandra/984-test-if-two-date-ranges-overlap-in-ruby-or-rails)

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2017-10-05T07:50:54.270

如果您提供一个日期范围作为输入，并想找出它是否与数据库中现有的日期范围重叠，则以下条件可以成功满足您的需求

> 假设您从表单输入中提供`@StartDate`and 。`@EndDate`

**条件是：**

如果`@StartDate`是提前`existingStartDate`和落后，`existingEndDate`那么我们可以说`@StartDate`是在现有日期范围的中间，因此我们可以得出结论它会重叠

```
@StartDate >=existing.StartDate And @StartDate <= existing.EndDate) 
```

如果`@StartDate`落后`existingStartDate`但`@EndDate`领先`existingStartDate`我们可以说它会重叠

```
 (@StartDate <= existing.StartDate And @EndDate >= existing.StartDate) 
```

如果`@StartDate`落后`existingStartDate`并且`@EndDate`领先`existingEndDate`我们可以得出结论，提供的日期范围会吞噬现有的日期范围，因此重叠

```
 (@StartDate <= existing.StartDate And @EndDate >= existing.EndDate)) 
```

如果任何条件成立，则您提供的日期范围与数据库中的现有日期范围重叠。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2012-10-12T23:17:53.217

**将问题拆分为案例，然后处理每个案例**。

“两个日期范围相交”的情况包含两种情况 - 第一个日期范围在第二个日期范围内开始，或者第二个日期范围在第一个日期范围内开始。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2014-03-25T13:42:01.070

你可以试试这个：

```
//custom date for example
$d1 = new DateTime("2012-07-08");
$d2 = new DateTime("2012-07-11");
$d3 = new DateTime("2012-07-08");
$d4 = new DateTime("2012-07-15");

//create a date period object
$interval = new DateInterval('P1D');
$daterange = iterator_to_array(new DatePeriod($d1, $interval, $d2));
$daterange1 = iterator_to_array(new DatePeriod($d3, $interval, $d4));
array_map(function($v) use ($daterange1) { if(in_array($v, $daterange1)) print "Bingo!";}, $daterange); 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2014-07-18T17:12:05.373

```
public static class NumberExtensionMethods
    {
        public static Boolean IsBetween(this Int64 value, Int64 Min, Int64 Max)
        {
            if (value >= Min && value <= Max) return true;
            else return false;
        }

        public static Boolean IsBetween(this DateTime value, DateTime Min, DateTime Max)
        {
            Int64 numricValue = value.Ticks;
            Int64 numericStartDate = Min.Ticks;
            Int64 numericEndDate = Max.Ticks;

            if (numricValue.IsBetween(numericStartDate, numericEndDate) )
            {
                return true;
            }

            return false;
        }
    }

public static Boolean IsOverlap(DateTime startDate1, DateTime endDate1, DateTime startDate2, DateTime endDate2)
        {
            Int64 numericStartDate1 = startDate1.Ticks;
            Int64 numericEndDate1 = endDate1.Ticks;
            Int64 numericStartDate2 = startDate2.Ticks;
            Int64 numericEndDate2 = endDate2.Ticks;

            if (numericStartDate2.IsBetween(numericStartDate1, numericEndDate1) ||
                numericEndDate2.IsBetween(numericStartDate1, numericEndDate1) ||
                numericStartDate1.IsBetween(numericStartDate2, numericEndDate2) ||
                numericEndDate1.IsBetween(numericStartDate2, numericEndDate2))
            {
                return true;
            }

            return false;
        } 

if (IsOverlap(startdate1, enddate1, startdate2, enddate2))
            {
                Console.WriteLine("IsOverlap");
            } 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2014-11-27T15:26:41.717

这是我的解决方案，当值不重叠时它返回 true：

X 开始 1 Y 结束 1

A 开始 2 B 结束 2

```
TEST1: (X <= A || X >= B)
        &&
TEST2: (Y >= B || Y <= A) 
        && 
TEST3: (X >= B || Y <= A)

X-------------Y
    A-----B

TEST1:  TRUE
TEST2:  TRUE
TEST3:  FALSE
RESULT: FALSE

---------------------------------------

X---Y
      A---B

TEST1:  TRUE
TEST2:  TRUE
TEST3:  TRUE
RESULT: TRUE

---------------------------------------

      X---Y
A---B

TEST1:  TRUE
TEST2:  TRUE
TEST3:  TRUE
RESULT: TRUE

---------------------------------------

     X----Y
A---------------B

TEST1:  FALSE
TEST2:  FALSE
TEST3:  FALSE
RESULT: FALSE 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2016-01-19T21:57:31.493

下面的查询给了我提供的日期范围（开始和结束日期与我的 table_name 中的任何日期（开始和结束日期）重叠的 ID

```
select id from table_name where (START_DT_TM >= 'END_DATE_TIME'  OR   
(END_DT_TM BETWEEN 'START_DATE_TIME' AND 'END_DATE_TIME')) 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2020-07-05T11:06:43.240

我发现了另一种非常简单的方法。如果 daterange1 的开始和结束日期在 daterange2 的开始日期之前或 daterange1 的开始和结束日期在 daterange2 的结束日期之后，这意味着它们不会相互交叉。

```
public boolean doesIntersect(DateRangeModel daterange1, DateRangeModel  daterange2) {
    return !(
            (daterange1.getStartDate().isBefore(daterange2.getStartDate())
                    && daterange1.getEndDate().isBefore(daterange2.getStartDate())) ||
                    (daterange1.getStartDate().isAfter(daterange2.getStartDate())
                            && daterange1.getEndDate().isAfter(daterange2.getEndDate())));
} 
```

* * *

## 回答 #33

> 赞同：-1
> 
> 时间：2009-04-13T05:14:50.460

这是一个在本地很有用的通用方法。

```
 // Takes a list and returns all records that have overlapping time ranges.
    public static IEnumerable<T> GetOverlappedTimes<T>(IEnumerable<T> list, Func<T, bool> filter, Func<T,DateTime> start, Func<T, DateTime> end)
    {
        // Selects all records that match filter() on left side and returns all records on right side that overlap.
        var overlap = from t1 in list
                      where filter(t1)
                      from t2 in list
                      where !object.Equals(t1, t2) // Don't match the same record on right side.
                      let in1 = start(t1)
                      let out1 = end(t1)
                      let in2 = start(t2)
                      let out2 = end(t2)
                      where in1 <= out2 && out1 >= in2
                      let totover = GetMins(in1, out1, in2, out2)
                      select t2;

        return overlap;
    }

    public static void TestOverlap()
    {
        var tl1 = new TempTimeEntry() { ID = 1, Name = "Bill", In = "1/1/08 1:00pm".ToDate(), Out = "1/1/08 4:00pm".ToDate() };
        var tl2 = new TempTimeEntry() { ID = 2, Name = "John", In = "1/1/08 5:00pm".ToDate(), Out = "1/1/08 6:00pm".ToDate() };
        var tl3 = new TempTimeEntry() { ID = 3, Name = "Lisa", In = "1/1/08 7:00pm".ToDate(), Out = "1/1/08 9:00pm".ToDate() };
        var tl4 = new TempTimeEntry() { ID = 4, Name = "Joe", In = "1/1/08 3:00pm".ToDate(), Out = "1/1/08 8:00pm".ToDate() };
        var tl5 = new TempTimeEntry() { ID = 1, Name = "Bill", In = "1/1/08 8:01pm".ToDate(), Out = "1/1/08 8:00pm".ToDate() };
        var list = new List<TempTimeEntry>() { tl1, tl2, tl3, tl4, tl5 };
        var overlap = GetOverlappedTimes(list, (TempTimeEntry t1)=>t1.ID==1, (TempTimeEntry tIn) => tIn.In, (TempTimeEntry tOut) => tOut.Out);

        Console.WriteLine("\nRecords overlap:");
        foreach (var tl in overlap)
            Console.WriteLine("Name:{0} T1In:{1} T1Out:{2}", tl.Name, tl.In, tl.Out);
        Console.WriteLine("Done");

        /*  Output:
            Records overlap:
            Name:Joe T1In:1/1/2008 3:00:00 PM T1Out:1/1/2008 8:00:00 PM
            Name:Lisa T1In:1/1/2008 7:00:00 PM T1Out:1/1/2008 9:00:00 PM
            Done
         */
    } 
```

* * *

## 回答 #34

> 赞同：-1
> 
> 时间：2012-01-23T07:02:37.807

```
if (StartDate1 > StartDate2) swap(StartDate, EndDate);

(StartDate1 <= EndDate2) and (StartDate2 <= EndDate1); 
```

* * *

## 回答 #35

> 赞同：-1
> 
> 时间：2017-01-20T06:17:18.860

简单的解决方案：

```
compare the two dates: 
    A = the one with smaller start date, B = the one with bigger start date
if(A.end < B.start)
    return false
return true 
```

* * *

## 回答 #36

> 赞同：-1
> 
> 时间：2019-04-12T12:27:31.877

一个适合我的紧凑公式

```
class ValidityRuleRange {
        private final Date from;
        private final Date to;
    ...
    private boolean isOverlap(ValidityRuleRange vrr) {
        int c1 = from.compareTo(vrr.getTo());
        int c2 = to.compareTo(vrr.getFrom());
        return c1 == 0 || c2 == 0 || c1 + c2 == 0;
    } 
```

# java - Java/Swing 是否有任何（真正的）Office 2007 外观和感觉？

> ID：325945
> 
> 赞同：4
> 
> 时间：2008-11-28T14:52:38.210
> 
> 标签：java, swing, office-2007, look-and-feel

我知道 Substance 的外观和感觉，并且它们具有类似于 Office 2007 的外观和感觉。但是这种外观和感觉根本不像 Office 2007 的设计，例如颜色有很大不同。

还有其他更准确地模仿 Office 2007 的外观和感觉吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T09:16:08.977

看！

[http://www.pushing-pixels.org/?p=1010](http://www.pushing-pixels.org/?p=1010)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-07T15:37:39.593

[我建议在http://www.jidesoft.com/](http://www.jidesoft.com/)上查看 jide 软件组件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T06:32:18.217

Substance 的作者也在开发包含 Ribbon 组件的“Flamingo”。据我了解，Flamingo 不依赖于 Substance，并且使用安装的任何 LAF（因此系统 LAF 应该可以工作）。

你可能想试一试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T16:04:37.637

随着 Windows 7/VS2010/.NET4 的浪潮，ribbon 将成为 Win32 的标准组件，也是我认为的 .NET 框架。

# artificial-intelligence - 您可以在哪些领域对人工智能进行编程？

> ID：325950
> 
> 赞同：7
> 
> 时间：2008-11-28T14:54:06.787
> 
> 标签：artificial-intelligence, neural-network

欢迎！我非常喜欢在学习中对人工智能进行编程——神经网络、专家机器等。但在工作中，我主要开发 Web 应用程序。

现在我考虑回到这样的编程，也许是出于爱好，也许是在工作中。是否有人工智能在应用程序开发中常用的领域，具有这种技能的程序员可以搜索工作？

或者，也许我可以将一些想法卖给我的老板，并使用 AI 来扩展我们的一些应用程序。

您对在应用程序中使用 AI 有什么经验和想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-28T16:36:14.910

我最近开始阅读[Programming Collective Intelligence](https://rads.stackoverflow.com/amzn/click/com/0596529325)一书。这是一本很好的书，它准确地讨论了你在寻找什么——在 Web 应用程序中使用 AI 技术。

这本书写得很清楚，很容易理解，从实际应用的角度解释了一切（它涵盖了一些常用技术的工作原理：谷歌Pagerank、亚马逊推荐系统、婚介网站、链接推荐系统、贝叶斯垃圾邮件过滤器等等）。使用使用真实数据的实际有用示例（ebay API、facebook API 等用于收集数据）。在一章中，它甚至解释了如何以最佳方式绘制图形（我的意思是数据结构，而不是条形/线/等图）（以便没有节点靠得太近，最小重叠线等），这可能对以下方面有用，例如，映射社交网络。

我建议你看看它，看看人工智能可以应用于 Web 应用程序的不同方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T15:17:59.483

作为一个反例，解析从水质检测设备获取的数据可能不是使用人工智能的好地方：

[The Daily WTF：不，我们需要神经网络](http://thedailywtf.com/Articles/No,_We_Need_a_Neural_Network.aspx)

只是提醒我们所有人为正确的工作选择正确的工具。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-28T15:38:05.433

您可能可以分析您的 Web 应用程序**的访问者的行为；**他们如何在网站内部导航以提供更好、优化的界面。现在，这取决于您正在处理的 Web 应用程序类型。对于在线购物，您可以提供根据客户习惯推断的建议。

您还可以检测“异常”行为和欺诈行为。**欺诈和机器人检测**可以利用人工智能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-28T16:05:51.197

神经网络非常适合处理图像，因此您可以使用 AI 的 Web 应用程序的一个领域是识别和/或处理大量数据中图像中的模式。例如，像 Flickr 或 Facebook 这样的网站可能有一些有趣的培训材料，可以根据面部或将像素分组（即您使用的特征）与标题或标签中提到的某些项目相关联来识别人。

在文本操作方面，有很多东西，但它通常为其他网络应用程序锦上添花。我说的主要是搜索栏中的自动完成和用户通常看不到的后端内容，例如自动机器翻译或改进的搜索功能。

将 AI 放在应用程序产品前面的问题在于，通常，人工智能本身并不是一项功能，而是一种在没有设计人员定期提示的情况下有效协商大型数据集的方式。一般来说，用户会与应用程序进行一对一的关联，因此仅根据相对较少的响应数量来判断它的质量。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-28T16:09:23.017

电子邮件垃圾邮件过滤系统 - 绝对。

任何其他需要发现恶意内容模式的安全应用程序。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-06T14:47:21.677

**预测**，当然。

它对**企业具有巨大价值**（即：库存优化），在全球危机时期尤其有价值。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-28T15:03:02.620

游戏确实需要人工智能。
专家系统也是如此。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-28T15:12:36.843

在游戏之外，我很少看到人工智能的商业用途。

从理论上讲，它可能在工业机器人和成像中非常有用，但这些领域也往往非常保守，并且对非确定性算法感到不舒服。

您可能想研究 iRobot 的功能，但即使他们在其商业机器人中使用相当简单的算法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-28T15:27:46.283

在[认知架构](http://en.wikipedia.org/wiki/Cognitive_architecture)领域（例如 Soar、ACT-R 等），研究人员并没有专注于 A* 和游戏等算法，而是研究人类行为模型，包括决策制定、文化交流和学习。他们通常关注认知的合理性，即模型跟踪人类会做什么的接近程度，包括时间等。

这些系统往往严格以研究为基础，商业应用有限。反正到目前为止。不过，军事应用，尤其是训练应用相当普遍。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-06T14:50:10.423

风险评估是神经网络的一个很好的例子，主要是因为它们非常擅长模式匹配。保险公司和信贷公司在一定程度上使用它们来确定客户的风险。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-06T14:52:42.773

用于检测癌症的图像处理！（我们实际上编写了关于它的 IEEE 论文，创建算法比编写它们更难，所以我们写了关于其他论文性能的论文）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-27T21:19:00.470

我对使用人工神经网络进行水下声源分类进行了广泛的研究。该算法似乎工作得很好，尤其是我花了很大一部分工作来确定傅里叶变换系数的组合构成了分类的最佳集合（使用主成分分析）。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-11-18T12:57:56.247

任何事情（认真）：

[http://highlevellogic.blogspot.com/2010/09/high-level-logic-rethinking-software.html](http://highlevellogic.blogspot.com/2010/09/high-level-logic-rethinking-software.html)

高级逻辑（HLL）开源项目是关于寻找和编码所有其他人工智能（实际上是所有编程）都适合的高级逻辑。有严肃的具体想法和代码。HLL 已经是一个应用程序框架。

# regex - 正则表达式匹配文本和括号

> ID：325952
> 
> 赞同：0
> 
> 时间：2008-11-28T14:54:28.330
> 
> 标签：regex, vb.net

我需要遍历以下字符串中的所有匹配项：

`<a href='/Product/Show/{ProductRowID}'>{ProductName}</a>`

我希望捕获 {} 中的值，包括它们，所以我想要 {ProductRowID} 和 {ProductName}

到目前为止，这是我的代码：

```
Dim r As Regex = New Regex("{\w*}", RegexOptions.IgnoreCase)
Dim m As Match = r.Match("<a href='/Product/Show/{ProductRowID}'>{ProductName}</a>") 
```

我的 RegEx 模式是否正确？如何遍历匹配的值？我觉得这应该非常容易，但今天早上我被难住了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-28T15:01:15.460

您的模式缺少一个小细节：

```
\{\w*?\} 
```

花括号必须被转义，并且你想要非贪婪的明星，否则你的第一个（也是唯一的）匹配将是这样`"{ProductRowID}'>{ProductName}"`的：

```
Dim r As Regex = New Regex("\{\w*?\}")
Dim input As String = "<a href='/Product/Show/{ProductRowID}'>{ProductName}</a>"
Dim mc As MatchCollection = Regex.Matches(input, r)
For Each m As Match In mc
  MsgBox.Show(m.ToString())
Next m 
```

`RegexOptions.IgnoreCase`不需要，因为这个特定的正则表达式无论如何都不区分大小写。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-28T15:03:33.490

您可以使用如下正则表达式对匹配项进行分组：

```
<a href='/Product/Show/(.+)'\>(.+)</a> 
```

通过这种方式，您有 $1 和 $2 匹配您想要获得的值。

您还可以给您的匹配名称，以便它们不是匿名/面向位置的检索：

```
<a href='/Product/Show/(?<rowid>.+)'\>(?<name>.+)</a> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T15:00:48.177

将您的 RegEx 模式更改为`\{\w*\}`它将按照您的预期匹配。

您可以使用[在线 .net RegEx 测试器对其进行测试](http://www.dotnetcoders.com/web/Learning/Regex/RegexTester.aspx)。

# powershell - 如何使用 PowerShell 替换换行符？

> ID：325953
> 
> 赞同：50
> 
> 时间：2008-11-28T14:54:53.057
> 
> 标签：powershell

给定*test.txt*包含：

```
test
message 
```

我想结束：

```
testing
a message 
```

我认为以下应该有效，但它没有：

```
Get-Content test.txt |% {$_-replace "t`r`n", "ting`r`na "} 
```

如何查找并替换我发现的内容包含 CRLF？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-11-28T15:49:19.797

一个 CRLF 是两个字符，当然是 CR 和 LF。但是，``n`由两者组成。例如：

```
PS C:\> $x = "Hello
>> World"

PS C:\> $x
Hello
World
PS C:\> $x.contains("`n")
True
PS C:\> $x.contains("`r")
False
PS C:\> $x.replace("o`nW","o There`nThe W")
Hello There
The World
PS C:\> 
```

我认为您在使用``r`. 我能够``r`从您的示例中删除，仅使用``n`，并且它有效。当然，我不确切知道你是如何生成原始字符串的，所以我不知道里面有什么。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-12-01T22:22:02.717

据我了解，[Get-Content](http://technet.microsoft.com/en-us/library/hh849787.aspx)在通过管道滚动文本文件时消除了所有换行符/回车符。要执行多行正则表达式，您必须将字符串数组重新组合成一个巨大的字符串。我做类似的事情：

```
$text = [string]::Join("`n", (Get-Content test.txt))
[regex]::Replace($text, "t`n", "ting`na ", "Singleline") 
```

澄清：小文件只有人！请不要在您的 40 GB 日志文件上尝试此操作 :)

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-05-28T23:06:09.830

有了`-Raw`你应该得到你所期望的

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-09-03T05:29:07.310

如果要删除所有换行符并将它们替换为某个字符（例如逗号），则可以使用以下命令。

```
(Get-Content test.txt) -join "," 
```

这是有效的，因为 Get-Content 返回行数组。您可以将其视为可用于多种语言的标记化功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-25T17:37:39.967

`"\\r\\n"`您也可以使用`powershell`. 我在 servicenow 工具中使用了这个。

就我而言`"\r\n"`，它不起作用，所以我尝试将此符号`"\\r\\n"`用作.`"\"``powershell`

# vb.net - 正确使用 List.Exists 和 Predicates

> ID：325965
> 
> 赞同：11
> 
> 时间：2008-11-28T15:00:41.813
> 
> 标签：vb.net

全部

我目前正在尝试按照以下方式实现一些东西

```
dim l_stuff as List(of Stuff)

dim m_stuff as new Stuff

m_stuff.property1 = 1
m_stuff.property2 = "This"

if not l_stuff.exists(m_stuff) then
     l_stuff.add(m_stuff)
end if 
```

这显然失败了，因为 Exist 方法正在寻找 Stuff 的谓词。

谁能完全解释谓词以及我如何才能在这里实现我想要做的事情。

我试过用

```
if not l_stuff.contains(m_stuff) then
   l_stuff.add(m_stuff)
end if 
```

但是，这不会检测到相同的条目并将重复项输入到列表中

谢谢

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-28T15:03:28.733

`List(Of T).Contains`是您应该使用的方法。正如您所说，存在需要一个谓词。当然，要使 .Contains 按预期工作，您需要覆盖该`Equals()`方法以及.Contains `GetHashCode()`。

`List(Of T).Exists`期望一个函数在传递一个 T 类型的项目时返回一个布尔值，在你的例子中，T 是 Stuff 类型。因此，您可以编写如下所示的方法：

```
If Not l_stuff.Exists(Function(x) x.property1 = m_stuff.property1 And _
x.property2 = m_stuff.property2) Then 
```

等等。

# asp.net - HTML & CSS 编码指南

> ID：325979
> 
> 赞同：4
> 
> 时间：2008-11-28T15:04:37.593
> 
> 标签：asp.net, html, css, coding-style

我们正在与一名外部顾问签订合同，为我们目前正在处理的一个新项目的大部分主要页面生成 XHTML（过渡）和 CSS。

我被要求为他们整理一份指南清单，以便我们可以确定可以预期达到一定的质量水平。作为一点技术背景，我们将把它们提供的原始 HTML 合并到一个 ASP.NET Web 表单应用程序中（使用通常的母版页/外部样式表/jquery）。Javascript 不应该是一个考虑因素，但 CSS 的格式和组织应该是。

我已经开始了，但很快意识到这可能不是一个独特的情况，并且经过验证的列表可能存在于某个地方，我至少可以将其用作模板！有没有人有这方面的经验？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-28T15:06:59.273

从技术角度来看，页面必须[通过验证](http://validator.w3.org/)可能是我要做的第一个测试。

我希望该网站能够被禁用 JavaScript 的人和使用屏幕阅读器的人使用（这是一个很好的选择，因为它还应该突出显示不恰当使用的表格和其他问题，例如缺少图像 alt 标签，标题标签的使用不一致等）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-28T15:42:02.323

我总是为自己做的一个很好的测试是打开页面和 ctrl+scroll。缩放让您立即了解设计的灵活性和流动性。

在 IE 中这无论如何都会失败，但你也可以尝试使字体更大，看看会发生什么（例如，注意垂直拉伸的按钮）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-28T16:01:32.860

向他们提供您希望他们支持的浏览器列表（浏览器版本和操作系统）。

是否应该遵守无障碍指南？您可以同意支持[Web 内容可访问性指南清单](http://www.w3.org/TR/WCAG10/full-checklist.html)中的一些要点。该列表实际上非常有用，因为它不仅可以确保您的网站适用于残障人士，还适用于没有 JavaScript、CSS、图像的浏览器。该列表还包含一些建立合理网站的一般良好做法。

由于您使用的是 ASP.NET，因此请确保`<form>`每个网页只包含一个。或者至少，如果您允许他们使用更多，请准备好做一些变通方法。

如果您打算使用 AJAX，请向他们展示[ASP.NET AJAX Control Toolkit](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/)，这样他们就不会花时间在已经构建的东西上。

我会坚持他们使用一些经过验证的框架，例如[YUI css reset](http://developer.yahoo.com/yui/reset/)和[jQuery](http://jquery.com/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-30T05:54:47.217

在多个前端开发人员之间传递 HTML / CSS 模板的一件事是标记的正确结构和缩进。就像书籍被分解成卷、章节、段落、句子、单词、空格和句号一样，有一个层次结构使 HTML 和 CSS 易于阅读（另一方面，一种编码方式使事情变得一团糟）

根据经验：

```
 <body>
          <div id="first">
               <p>
                    Some text goes in here...
               <p>

               <ul>
                    <li>A list item</li>
                    <li>A list item</li>
                    <li>A list item</li>
                    <li>
                         <ul>
                             <li>
                                  <a href="#">A link</a>
                             </li>
                         </ul>
                    </li>
               </ul>
          </div> <!-- #first ends -->
     </body> 
```

这种对结构的坚持可以真正减少时间，因为无论他们是否编写代码，扫描代码对工作人员来说都非常容易。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-28T15:16:34.010

除了验证之外，还应牢记以下几点 - 可访问性（受众是谁） - 基于 CSS 的设计（语义设计良好） - 与您的命名约定（css 和 id 命名）保持一致。这将在长期内受益在需要进行任何更改、必须应用新的 CSS 等时运行）。

从 yahoo 开发人员库中查看以下最佳实践... [http://developer.yahoo.com/performance/rules.html](http://developer.yahoo.com/performance/rules.html)

此外，由于您使用的是 ASP.net，因此在将用户控件命名为客户端 ID 时要小心，生成的客户端 ID 可能会很长且出乎意料（asp.net 在运行时生成 id）；

可以在 [http://woork.blogspot.com/2008/11/useful-guidelines-to-improve-css-coding.html找到一些好的信息](http://woork.blogspot.com/2008/11/useful-guidelines-to-improve-css-coding.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-28T15:18:09.233

实际上，请确保页面通过验证。

还要注意语义，禁用 CSS 时页面应该按逻辑顺序排列（某些浏览器和屏幕阅读器就是这种情况）。确保标题实际上是 <h#> 标记，并且所有图像都有适当的 alt 标记。还要确保表格仅用于显示信息而不用于格式化。菜单应构造为列表而不是 div（语义）。

# asp.net-mvc - ASP.NET MVC AjaxHelper 是否处理降级？

> ID：325981
> 
> 赞同：4
> 
> 时间：2008-11-28T15:05:29.853
> 
> 标签：asp.net-mvc, ajax, deprecated

有谁知道 ASP.NET MVC 框架中的 AjaxHelper 是否处理降级？

例如，如果您有一个更新 div 内容的 ActionLink，如果 JavaScript 不可用，页面是否会通过 renderubg 页面（通过控制器上的操作）并调用 ActionLink 中指定的操作来执行完整的回发？

如果不是，您如何建议为启用了 JavaScript 的浏览器和在 MVC 应用程序上下文中禁用它的浏览器正确设置页面功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-29T20:59:34.130

您可以尝试的一件事是在您的控制器中，覆盖 OnActionExecuted 方法并为非 JavaScript 启用的浏览器更改 filerContext.ActionResult。您还可以将自己的 ActionFilters 添加到控制器中的不同操作中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-13T18:34:24.867

您可以为调用的对象指定一个`Url`参数：`AjaxOptions``Ajax.ActionLink`

```
@Ajax.ActionLink(role, "GetPeopleData",
    new { selectedRole = role },
    new AjaxOptions
    {
        UpdateTargetId = "tbody",
        Url = Url.Action("GetPeopleData", new { selectedRole = role })
    }) 
```

# c# - 服务层和存储库

> ID：325984
> 
> 赞同：47
> 
> 时间：2008-11-28T15:06:26.230
> 
> 标签：c#, model-view-controller, repository-pattern, castle-monorail

我使用 MVC 框架已经有一段时间了，我真的很喜欢如何分离关注点。我养成了让控制器做大量工作的坏习惯。所以我真的在寻求一些建议。

当我第一次开始使用 MVC 时，我经常在数据库工作完成后让控制器对模型进行操作。我知道这很糟糕，所以将这项工作转移到模型中。但是我对此并不满意，因为我希望我的模型非常好学。

我做了一些阅读，我看到人们通过服务层来保持他们的控制器和模型的精简，我喜欢它的外观。

我只是想了解服务层和存储库应该如何协同工作。这是我的假设，请告诉我这是否是一种好的工作方式？

1.  如果不需要对数据进行任何操作，控制器可以直接调用存储库，因此服务层不需要参与
2.  一旦需要对数据（业务逻辑）进行任何工作，则应在服务层中完成，控制器将在需要时对服务层进行简单调用
3.  一旦服务完成了它的业务逻辑，它将根据需要使用存储库（如果需要持久化数据）。
4.  理想情况下，模型应该保持精简，理想情况下只是充当 DTO
5.  数据验证将在模型内完成（使用 MonoRail 验证属性）。我很欣赏甚至没有人喜欢用很多属性污染他们的模型，但这是一个不同的讨论。我喜欢 MonoRail 的验证属性在 UI 中自动 jQuery 验证的好处。

我试图将我的所有代码都转向单一责任原则，因此试图整理我的编码实践。

谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-28T15:53:21.037

首先，没有一套适用于所有情况的规则。您如何为应用程序建模很大程度上取决于项目的类型和复杂性。话虽如此，这里有一些想法：

1.  从控制器调用存储库没有错。只要确保控制器不包含业务逻辑。
2.  该服务负责（一些）业务逻辑并使用其他服务来完成。存储库是一种服务，从服务中调用它并没有错。
3.  模型**应该**包含业务逻辑，实际上您应该始终尝试将其放在模型中。如果您需要外部数据来执行该业务逻辑（来自另一个模型或来自存储库），那么您应该创建一个服务。
4.  模型中的验证没有错。是否使用属性是一个品味问题（如果你喜欢它就很好）。如果太复杂，将验证移到模型之外（创建一组外部规则）。

最重要的是，做正确的事（这通常是正确的答案）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-01T21:31:14.473

[该](http://channel9.msdn.com/Events/aspConf/aspConf/ASP-NET-MVC-Solution-Best-Practices)视频对如何组织您的 asp.net MVC 解决方案和解决关注点分离以及更好的可测试性提供了深刻的见解。希望它也会对其他人有所帮助。我从中学到了一些好东西。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-04T14:57:45.653

Ian Cooper 刚刚就这个主题写了一篇名为[The Fat Controller的博文。](http://codebetter.com/blogs/ian_cooper/archive/2008/12/03/the-fat-controller.aspx)

# c++ - 作为程序员进行开发

> ID：325988
> 
> 赞同：12
> 
> 时间：2008-11-28T15:08:59.220
> 
> 标签：c++, mfc, stl

我已经学习 C++ 三个月了，在那段时间为我的公司创建了许多应用程序。我认为自己对 C++/MFC 和 STL 相当满意，但是我不只是想成为一名优秀的程序员，我还想成为一名优秀的程序员。我有几本关于最佳实践的书，但我想知道是否有人可以建议阅读对他们有帮助的材料以及应该鼓励的任何学科？

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-28T15:12:29.010

我将从[实用程序员](http://www.pragprog.com/the-pragmatic-programmer)、[代码完成](http://cc2e.com/)、[重构](http://www.refactoring.com/)和[设计模式](http://www.dofactory.com/Patterns/Patterns.aspx)开始。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-28T15:11:54.503

对于 C++，[Scott Meyers 的书籍](http://www.aristeia.com/books.html)非常好，将帮助您更上一层楼。

如果你还没有[C++，Bjarne Stroustrup，第 3 版](https://rads.stackoverflow.com/amzn/click/com/0201700735)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-28T15:34:34.537

嗯……[十年后自学编程 (Peter Norvig)](http://norvig.com/21-days.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-28T15:14:08.353

使用 c++ 3 个月，你已经习惯了吗？Sheesh，我学习 c# 已经一年多了，并且参加了许多 Microsoft 课程，但我对它还很不适应。

话虽如此，您会听到[Code Complete](https://rads.stackoverflow.com/amzn/click/com/0735619670)被认为是一本非常好的书。我现在正在阅读它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-28T15:14:54.217

*   Marshall Cline 的[C++ FAQ Lite](http://www.parashift.com/c++-faq-lite/)。
*   Herb Sutter[出色的 C++](https://rads.stackoverflow.com/amzn/click/com/0201615622)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-28T15:54:12.187

John Lakos 的《Large Scale C++ Software Design》提供了有关设计方法的指导，这些方法将使您的 C++ 更易于维护。这是相当大的，但你可以浸入并仍然获得一些好处。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-28T16:18:22.793

有点离题：与其建议要学习的书籍，我想提一些要考虑的广泛主题。

*   穿线。如果你使用 MFC，这个需求并不多，但在许多其他领域它是不可或缺的。线程 API 的机制很容易掌握，但学习所有极端情况需要大量时间和练习。

*   闭包、Map-Reduce 和其他类似 lisp 的技术。找出它们是什么，为什么它们在 C++ 中不受支持，以及它们是如何在 C++ 中被模仿的（函子，以及许多其他有状态回调对象的情况）。为此，我实际上有一本书：“计算机程序的结构和解释”。

*   命令行。这让您了解何时不编写自己的程序。命令行将是 Unix 命令行 - 我不知道 MS 在这方面的最新实验，但 cmd.exe 很糟糕。获取 Cygwin 并开始试验。

*   脚本语言。这让您了解何时不使用 C++ 编程。我最喜欢的是 Perl，但很多人说 Python、Ruby 等等。嘿，如果您愿意，请学习 XSLT！

我确定我遗漏了其他领域。我会将其标记为社区 Wiki - 随时添加。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-28T15:23:55.977

好博客： [本周大师](http://www.gotw.ca/publications/index.htm)，以及[Herb Sutter 的所有书籍](http://www.gotw.ca/publications/index.htm)。那些已经给你很多咀嚼了。

如果你想很好地了解你还不知道的东西，并且可能不想知道，那么 Alexandrescu 的[现代 C++ 设计。](https://rads.stackoverflow.com/amzn/click/com/0201704315)

[Code Kata](http://codekata.pragprog.com/)用于练习！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-28T15:55:37.553

我在 VB.net 上阅读了几本（不完整，但有部分）oreilly 书籍，它们非常好，但如果你想成为专业人士并有时间......你可以尝试 MSDN 论坛，帮助其他人并与他们困难和复杂的问题，我认为这是最好的方法..

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-28T16:07:35.437

学习另一种语言。即使你不会使用它，它也非常适合开脑洞。

我建议 Lua、Scheme 和 Python。但几乎任何其他事情都会做。（与C最不同，最好）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-28T16:40:58.070

Josuttis 和 Vandevoorde - 模板：完整指南

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-28T16:41:54.790

正如我所看到的，没有人提到 Bruce Eckel 的精彩书籍“Thinking in C++”。恕我直言，它是您开始 C++ 开发的最佳书籍之一。在我看来，第一卷比第二卷更有帮助，但都值得一读。
[http://www.amazon.com/Thinking-C-Introduction-Standard-One/dp/0139798099/ref=pd_bbs_sr_1?ie=UTF8&s=books&qid=1227890306&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/0139798099)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-28T18:46:55.273

我很多人可以推荐更现代、最新的书籍。但我仍然推荐Margaret A. Ellis 和 Bjarne Stroustrup[的 The Annotated C++ Reference Manual](https://rads.stackoverflow.com/amzn/click/com/0201514591)。

ARM 于 90 年发布。它在模板方面已经有些过时了。STL（显然）不存在。（[虽然 sgi.com 的网站很好地涵盖了 STL！](http://www.sgi.com/tech/stl/table_of_contents.html)）

但是，ARM 非常便宜（使用过）。（运费将超过这本书的成本。）它的信噪比仍然超出规模。它非常擅长挖掘 C++ 的肮脏领域，解释做了什么以及为什么。

我仍然用它作为参考。[我用K&R](https://rads.stackoverflow.com/amzn/click/com/0131103628)把它排在那里。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-28T21:12:10.160

Dietel/Dietel “如何编程 C++”...我的办公桌上仍然有这本书（10 年了）。每隔一段时间我都会重读一章。
正如其他人所建议的那样，我肯定会完成代码。事实上，首先阅读。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-28T21:25:12.783

为了更好地理解面向对象，花一些时间在 Smalltalk 中。Squeak 可免费下载。然后阅读 Richard P. Gabriel 的软件模式，然后阅读他的 Objects has Failed。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-11-28T22:32:09.187

用 C++ 思考 - Bruce Eckel Symfonia C++ 标准 - Jerzy Grębosz

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-11-28T22:42:54.093

如果你什么都不做，就编程。

当您不阅读有关编程的内容时，并且当某些事情让您感到有趣时，请使用这些知识来实现​​某些东西。我发现这是真正设置原则的唯一方法。

在博客上保持最新可能很有趣，但这是零散的知识。它似乎分散注意力而不是帮助。但结合谷歌和研究特定事物的愿望真的可以咳出大量信息。但不要只是订阅大量的 rss 提要并期望变得更好。

我认为真正学习特定主题有助于扩展你的能力。研究让你感兴趣的主题，结识像你一样做事的人（会议、用户组、irc、facebook、stackoverflow 等），最重要的是练习你的艺术。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-10-18T16:41:48.943

您可以查看 Boost 库和一些关于它的书籍。虽然这可能不是您的想法，但 IMO，Boost 库是精心设计的现代 C++ 库的示例，它们以几乎应使用的方式使用语言的特性来创建最有效的解决方案他们的问题域。当然，有一些奇怪的库，比如预处理器和 MPL，它们会让你怀疑你是否会对它们有用，但它们都非常好。根据我自己的经验，探索该库及其文献让我深入了解了如何有效地使用 C++。

[超越 C++ 标准库的 Boost：Boost](https://rads.stackoverflow.com/amzn/click/com/0321133544)[简介](http://www.boost.org/)

# nhibernate - 如何使用 NHibernate 插入或更新（或覆盖）记录？

> ID：325990
> 
> 赞同：12
> 
> 时间：2008-11-28T15:10:49.343
> 
> 标签：nhibernate, insert-update, overwrite, upsert

无论它是否已经存在，我都需要向数据库写入一行。在使用 NHibernate 之前，这是通过存储过程完成的。该过程将尝试更新，如果没有行被修改，它将回退到插入。这很有效，因为应用程序并不关心记录是否存在。

使用 NHibernate，我发现的解决方案需要加载实体并对其进行修改，或者删除实体以便插入新实体。应用程序必须关心记录是否已经存在。有办法解决吗？

## 身份证重要吗？

### 分配的 ID

该对象有一个关键字作为分配的 id，并且是表中的主键。

我了解 SaveOrUpdate() 将根据 Id 适当调用 Save() 或 Update() 方法。使用分配的 id，这将不起作用，因为 id 不是未保存的值。但是，可以将版本或时间戳字段用作指示符。实际上，这无关紧要，因为这仅反映内存中的对象是否与数据库中的记录相关联；它不指示该记录是否存在于数据库中。

### 生成的 ID

如果分配的 id 确实是问题的原因，我可以使用生成的 id 而不是关键字作为主键。这将避免 NHibernate 插入/更新问题，因为它总是会有效地插入。但是，我仍然需要防止重复的关键字。使用关键字列上的唯一索引，即使主键不同，它仍然会为重复关键字抛出异常。

## 另一种方法？

也许问题不在于 NHibernate，而在于建模的方式。与应用程序的其他领域不同，这更以数据为中心，而不是以对象为中心。很高兴 NHibernate 使其易于读/写并消除了存储过程。但是，不考虑现有值而简单地编写的愿望与对象身份模型的模型不太吻合。有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T08:50:27.727

我正在使用

```
 public IList<T> GetByExample<T>(T exampleInstance)
    {
        return _session.CreateCriteria(typeof(T))
                    .Add(Example.Create(exampleInstance))
                    .List<T>();
    }

    public void InsertOrUpdate<T>(T target)
    {
        ITransaction transaction = _session.BeginTransaction();
        try
        {
            var res=GetByExample<T>(target);
            if( res!=null && res.Count>0 )
                _session.SaveOrUpdate(target);
            else
               _session.Save(target); 
            transaction.Commit();
        }
        catch (Exception)
        {
            transaction.Rollback();
            throw;
        }
        finally
        {
            transaction.Dispose();
        }
    } 
```

但是 FindByExample 方法返回所有对象，而不是具有确切 ID 的对象，您有什么建议？因为我只有对象作为参数我无权访问其特定的 ID 字段所以我不能使用`session.get(Object.class(), id);`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T22:17:57.210

通常，NHibernate 可以依赖未保存的值来确定是否应该插入或创建实体。但是，由于您正在分配 ID，因此 NHibernate 看起来您的实体已经被持久化了。因此，您需要依靠版本控制您的对象来让 NHibernate 知道它是一个新对象。请参阅以下链接了解如何对您的实体进行版本控制：

[http://web.archive.org/web/20090831032934/http://devlicio.us/blogs/mike_nichols/archive/2008/07/29/when-flushing-goes-bad-assigned-ids-in-nhibernate。 aspx](http://web.archive.org/web/20090831032934/http://devlicio.us/blogs/mike_nichols/archive/2008/07/29/when-flushing-goes-bad-assigned-ids-in-nhibernate.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T15:17:07.363

使用 session.SaveOrUpdate(object) 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T16:41:38.003

你可以做

```
Obj j = session.get(Object.class(), id);
if (j != null)
   session.merge(myObj);
else
   session.saveOrUpdate(myObj); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-27T17:31:36.837

查询keyword = x的对象，取FirstOrDefault。如果为空，则添加新对象，如果存在，则更新您获得的对象并在其上调用 saveOrUpdate。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-29T14:40:36.737

这对我有用：

# 执行

```
 public void InsertOrUpdate<TEntity, TId>(TEntity entity) where TEntity : IIdentificableNh<TId>
    {
        var anyy = session.Get<TEntity>(entity.Id);
        if (anyy != null)
        {
            session.Evict(anyy); //dispatch all data loaded, to allow updating 'entity' object.
            session.Update(entity);
        } 
        else
        {
            session.Save(entity);
        }

        session.Flush();
    } 
```

## 实体

```
public class Caracteristica : IIdentificableNh<int>
{
    public virtual int Id { get; set; }

    public virtual string Descripcion { get; set; }
} 
```

我必须创建一个允许我访问 Id 属性值的接口 (IIdentificableNh)。

## 使用示例：

```
session.InsertOrUpdate<Caracteristica, int>(new Caracteristica { Id = 2, Descripcion = "Caracteristica2" }); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-28T15:15:48.537

调用 hibernate.saveOrUpdate() 它将检查对象是否在数据库中，如果是则更新它，如果不是则保存（即插入）它。

# open-source - 分布式文件系统完整性检查

> ID：325993
> 
> 赞同：3
> 
> 时间：2008-11-28T15:12:17.077
> 
> 标签：open-source, filesystems, distributed

我需要一个分布式文件系统，它必须扩展到非常大的大小（大约 100TB 实际最大值）。文件大小大多在 10-1500KB 范围内，但有些文件的峰值可能约为 250MB。

我非常喜欢像 GFS 这样具有内置备份冗余的系统的想法，从统计上讲，这将使文件丢失成为过去。

我有几个要求：

*   开源
*   没有 SPOF
*   自动文件复制（即不需要RAID）
*   托管客户端访问
*   文件的平面命名空间 - 最好
*   内置版本控制/延迟删除
*   经过验证的部署

我认真研究过 MogileFS，因为它确实满足了大部分要求。它没有任何托管客户端，但它应该相当直接地做一个 Java 客户端的移植。但是，没有内置版本控制。没有版本控制，除了 MogileFS 中内置的文件复制之外，我将不得不进行正常备份。

基本上，我需要防止突然清除大量不应该拥有的文件的编程错误。虽然 MogileFS 确实通过在 X 台设备上复制我的文件来保护我免受磁盘和机器错误的影响，但如果我进行了无根据的删除，它并不能拯救我。

我希望能够指定删除操作直到 Y 天后才真正生效。删除逻辑上会发生，但我可以将文件状态恢复 Y 天，直到它被实际删除。此外，MogileFS 没有能力在写入期间检查磁盘损坏 - 尽管同样可以添加。

由于我们是一家 Microsoft 商店（Windows、.NET、MSSQL），我最希望核心部分在 Windows 上运行以便于维护，而存储节点由于许可而运行 *nix（或组合）。

在我考虑自己动手之前，你有什么建议让我看看吗？我还检查了 HadoopFS、OpenAFS、Lustre 和 GFS——但似乎都不符合我的要求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T16:12:40.293

你绝对需要在你自己的服务器上托管它吗？您需要的大部分内容都可以由 Amazon S3 提供。延迟删除功能可以通过将删除记录到 SimpleDB 表并定期运行垃圾收集传递以在必要时删除文件来实现。

如果您依赖单个 Internet 连接，仍然存在单点故障。当然，你可以认为亚马逊本身就是一个失败点，但由于规模的原因，失败率总是要低得多。

并希望您意识到其他好处，即扩展到任何容量的能力。IT 人员无需更换故障磁盘或系统。随着磁盘容量和带宽变得更便宜（而您购买的磁盘贬值），使用成本将不断下降。

也可以采用混合方法，将 S3 用作安全的后端存档并在本地缓存“热”数据，并找到最适合您的使用模型的缓存策略。这可以大大减少带宽使用并改善 I/O，尤其是在数据不经常更改的情况下。

缺点：

*   S3 上的文件是不可变的，它们只能被完全替换或删除。这对于缓存非常有用，但在对大文件进行小幅更改时对效率来说不是那么好。
*   延迟和带宽取决于您的网络连接。缓存可以帮助改善这一点，但您永远无法获得相同水平的性能。

版本控制也是一种自定义解决方案，但可以使用 SimpleDB 和 S3 来实现，以跟踪文件的修订集。总的来说，这真的取决于你的用例是否合适。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T15:52:15.123

您可以尝试在可靠的文件系统之上运行源代码控制系统。然后问题就变成了如何在超时后删除旧的签到。您可以使用 DAV_SVN 设置 Apache 服务器，它将提交通过 DAV 接口所做的每项更改。我不确定在您描述的大文件大小下这将如何扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T16:46:47.090

@tweakt
我也广泛考虑过 S3，但我认为从长远来看它不会让我们满意。我们有很多必须安全存储的文件——不是通过文件 ACL，而是通过我们的应用层。虽然这也可以通过 S3 完成，但我们对文件存储的控制确实少了一点。此外，当我们进行文件操作时，延迟形式也会有一个主要的缺点 - 包括初始保存（虽然可以异步完成），而且当我们稍后读取文件并必须对它们执行操作时。

至于 SPOF，这不是一个真正的问题。我们确实与我们的数据中心有冗余连接，虽然我不想要任何 SPOF，但 S3 的短暂停机时间是可以接受的。

无限的可扩展性和无需维护绝对是一个优势。

关于混合方法。如果我们直接从 S3 托管 - 除非我们想在本地存储所有内容（并且只使用 S3 作为备份），否则当我们添加 S3 + CloudFront 时带宽价格太高了（CloudFront 是必要的，因为我们有来自各地的客户）。目前，我们在欧洲的数据中心托管所有内容，并且我们在美国有自己的反向鱿鱼设置，用于低预算的 CDN 功能。

虽然它非常依赖于域，但不可变性对我们来说不是问题。我们可能会替换文件（即密钥 X 获取新内容），但我们绝不会对文件进行细微修改。我们所有的文件都是 blob。**``