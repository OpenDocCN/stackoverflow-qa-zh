# StackOverflow 问答 12096000-12096999

# ios - 服务器如何通知移动应用程序状态变化

> ID：12096000
> 
> 赞同：0
> 
> 时间：2012-08-23T16:16:53.847
> 
> 标签：ios, client-server, state

假设我有一个 PHP Web 服务，并且我有一个与之通信的 iphone 应用程序。如果 iPhone 需要来自 Web 服务的信息，它会向服务器发出 http 调用并检索信息。但是你如何反过来做到这一点，当某些状态发生变化时，服务器如何通知应用程序，最有效的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:23:05.627

您正在寻找的是推送通知。您将需要创建一个推送通知服务器来向您的用户发送通知。[http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html)

# javascript - 如何让我的条件语句不那么难看

> ID：12096001
> 
> 赞同：3
> 
> 时间：2012-08-23T16:16:55.967
> 
> 标签：javascript, jquery, dom, refactoring

我正在尝试使以下代码不那么难看，并且不知道该怎么做。你们有什么建议吗？非常感谢。

```
 if($element.is('builder') || $element.is('#options') ){
     tooltipYPos=yPos + 35; 
    }

  if($element.is('#button')){
     tooltipXPos=xPos - 240; 
    }
  if($element.is('#addn')){
     tooltipXPos=xPos - 295; 
     tooltipYPos=yPos - 80; 
    }  

   if($element.is('#count')){
     tooltipXPos=xPos + 180; 
     tooltipYPos=yPos - 90; 
    } 
   if($element.is('label')){
       tooltipXPos=xPos + 80; 
     tooltipYPos=yPos - 90; 
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:34:18.057

一般的解决方法是*将问题从代码转移到数据*。一种解决方案（如下所示）是设置一个以各种 ID 标签为键的 JavaScript 关联数组，其值是值对 X 和 Y 偏移量（在某些情况下，一个或另一个为 0）。在使用时，循环遍历关联数组的键，寻找匹配项。如果是这样，将关联数组的 X 和 Y 偏移添加到 toolTipXPos 和 toolTipYPos。

这将使您的偏移量保持在一个位置，不碍事，并且操作它们的代码简短而简单。

（未经测试，自然）

```
// This can be stashed away anywhere.
var a = {
    '#te_classbuilder':              { X: 0,    Y: 35  },
    '#te_options':                   { X: 0,    Y: 35  },
    '#lesson-details-extend-button': { X: -240, Y: 0   },
    '#asset-list-asset-add-button':  { X: 295,  Y: -80 },
    '#asmnt_option_label_q_count':   { X: 180,  Y: -90 },
    "label":                         { X: 80,   Y: -90 }
}

// Put this where you need the actual evaluation to happen  
jQuery.each(data, function(key, value) {
    if ( $element.is(key) ) {
        tooltipXPos = xPos + value.X;
        tooltipYPos = yPos + value.Y;
    }
}); 
```

编辑：更改为循环，以便`label`可以测试，而不是`#label`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T17:01:40.423

另一种选择是利用 jQuery 的`.data`函数在元素本身上存储适当的 X 和 Y 值，如下所示：

```
$('label').data({ x: 80, y: -90 });
$('#te_classbuilder, #te_options').data({ x: 0, y: 35 });
$('#lesson-details-extend-button').data({ x: -240, y: 0 });
$('#asset-list-asset-add-button').data({ x: -295, y: -80 });
$('#asmnt_option_label_q_count').data({ x: 180, y: -90 }); 
```

然后，当需要修改工具提示位置值时，不需要条件语句。只需从 中检索`x`和`y`数据属性`$element`。

```
tooltipXPos = xPos + $element.data('x');
tooltipYPos = yPos + $element.data('y'); 
```

当然，这假设任何可能被分配的元素`$element`之前已经用适当的和值`.data`调用过它。`x``y`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T16:21:30.783

你能计算出 $element 的高度/宽度，然后相应地更改 tooltipXPos/tooltipYPos，而不是硬编码增量吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T16:22:05.737

首先，如果您可以结合条件：

```
if ($element.is('#te_classbuilder, #te_options')) {
  tooltipYPos = yPos + 35; 
} 
```

如果我们不能做一些大的改变，那么我会这样写：

```
if ($element.is('#te_classbuilder, #te_options')) tooltip = { x: 0,          y: yPos + 35 };
if ($element.is('#lesson-details-extend-button')) tooltip = { x: xPos - 240, y: 0 };
if ($element.is('#asset-list-asset-add-button'))  tooltip = { x: xPos - 295, y: yPos - 80 };
if ($element.is('#asmnt_option_label_q_count'))   tooltip = { x: xPos + 180, y: yPos - 90 };
if ($element.is('label'))                         tooltip = { x: xPos + 80;  y: yPos - 90 }; 
```

# java - 关闭使用 FileOutputStream 创建的文件，以便下次删除

> ID：12096002
> 
> 赞同：6
> 
> 时间：2012-08-23T16:17:02.520
> 
> 标签：java, delete-file, fileoutputstream

我目前在我的 Java 代码中遇到 FileOutputStream 的一些问题。

实际上我正在使用 FileOutputStream 来创建文件，但是一旦创建了文件，就无法删除它。据我了解，这可能来自 FileOutputstream 未关闭的事实。

在下面我总结的代码：

```
 outFile = new FileOutputStream(dir+"\\"+fileName);
     outFile.write("Test");
     outFile.flush();
     outFile.close();
     outFile = null;
     System.gc(); 
```

那么就没有办法删除文件，即使是“手动”。当我的程序启动时，我无法通过简单的 del 在 Windows 上删除它。我还尝试使用以下代码删除文件夹*目录*的内容，但也没有用：

```
static public void delDir( String place )

{
    File path = new File( place );
    System.out.println(path.exists());//return true
    if( path.exists() )
        {
        File[] f = path.listFiles();
        for( int j = 0 ; j < f.length ; j++ )
            {
            if( f[ j ].isDirectory() )
                {
                deleteDirectory( path+"\\"+f[ j ] );
                }
            f[ j ].delete();
            }
        }
} 
```

**所以我的问题是：** 如何关闭此文件以进行下一次删除（或者如果我们无法关闭它，如何正确删除它）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-23T16:24:20.533

这是Java中的一个错误。是的，它很少，但它们存在；）你能在之后添加吗`outFile.close()`

```
outFile = null;
System.gc(); 
```

然后尝试删除它。如果这不起作用，还有更多的可能性。让我知道。

**更新**

对我来说它有效：

```
public class FileDeleteExample {
    public static void main(String[] args) throws Exception {
        File f = new File("test.txt");

        FileOutputStream outFile = null;

        try {
            outFile = new FileOutputStream(f);
            outFile.write("Test".getBytes());
        } finally {
            outFile.flush();
            outFile.close();
            outFile = null;
            System.gc();
        }

        f.delete();
    }
} 
```

**更新**

我通过删除行提到的示例 Sumit Singh 进行了尝试，`outFile=null; System.gc;`这对我也有效。所以应该没有问题`FileOutputStream`。你能试试上面的小例子，说它是否有效吗？

**更新**

```
void closeQuietly(FileOutputStream out) {
    try { out.flush(); out.close(); } catch(Exception e) {} 
} 
```

现在只需调用`finally`块中的方法！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-27T10:44:14.077

我有同样的问题，delete() 方法为我的文件返回 false。

在我的情况下，在创建文件、写入其 FileOutputStream 和删除文件之间的某个地方，我正在使用 FileInputStream 并忘记为它调用 close() 。

所以，也许在你的代码中的某个地方，你将另一个流附加到这个文件，并让它保持打开状态。

在找到问题的真正根源之前，我使用了一个简单的技巧来临时解决这个问题：

```
FileOutputStream fos = new FileOutputStream(myFile);
fos.close();
myFile.delete(); 
```

在对我的文件调用 delete 之前，我在其上创建了另一个 FileOutputStream，然后调用了 close()。

这将解锁该文件上所有先前的锁，并允许您调用 delete()。

这样做仍然不是一个好习惯。您应该找出谁在使用您的文件并以正确的方式解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-30T11:00:15.667

不是真的相关，但是：

这种关闭文件的解决方案帮助我解决了另一个问题。当从 java 6 运行程序时，新进程被挂起，直到我关闭我的应用程序（在 java 7 中它没问题）。基于此答案的解决方案有帮助：

```
 String[] com = new String[]{javaRun, arg1, arg2, arg3, arg4};

    Process proc = Runtime.getRuntime().exec(com, null, dir);

    proc = null;
    System.gc(); 
```

这适用于 java 6。感谢您的启发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T16:23:05.580

那么，关闭文件输出和输入流的方法是：

```
name.close() 
```

并且您的删除代码看起来不错。我的建议是使用 FileIO 而不是 FileOutputStream，除非您有充分的理由使用 FileOutputStream。程序关闭后可以删除文件吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T16:31:02.263

最好使用来自 Apache Commons IO 的[FileUtils.deleteDirectory 。](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#deleteDirectory%28java.io.File%29)克服了 Java 删除错误，减少了使用的代码量，最重要的是，它可以工作。

而不是打电话

```
delDir(place); 
```

打电话

```
FileUtils.deleteDirectory(new File(place)); 
```

**更新：** 在您的`delDir`方法中，您调用：

```
deleteDirectory(new File(path + "\\" + f[j])); 
```

但结果

```
File[] f = path.listFiles(); 
```

将**已经包含**文件中的路径，因此您可以使用：

```
deleteDirectory( f[j].getPath() ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T16:27:49.447

你可以试试这个代码..

```
 File file = new File(dir+"\\"+fileName);
    FileOutputStream outFile;
    try {
        outFile = new FileOutputStream(file);
        outFile.write("Test".getBytes());
        outFile.flush();
        outFile.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
   file.delete(); 
```

您可以检查以下这些链接..

1.  [我无法在java中删除文件](https://stackoverflow.com/questions/991489/i-cant-delete-a-file-in-java)
2.  [Java 'file.delete()' 没有删除指定的文件！](https://stackoverflow.com/questions/4485716/java-file-delete-is-not-deleting-specified-file)
3.  [Java 6 文件删除](https://stackoverflow.com/questions/8097067/java-6-file-deletion)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-12-01T19:55:18.607

问题可能出在第一行：outFile = new FileOutputStream(dir+"\"+fileName);

1.  不确定是否需要新的。
2.  不要相信目录应该包含在路径中。AFAIK FileOutputStream 的目录被定义为应用程序内部目录。

高温高压

# php - 提要中要保存在数据库中的最重要项目

> ID：12096009
> 
> 赞同：0
> 
> 时间：2012-08-23T16:17:41.713
> 
> 标签：php, feed, simplepie

我正在构建一个提要聚合器。我有很多博客地址，我想将所有帖子保存在数据库中。我正在使用 Simplepie 获取提要，然后使用 php 将它们插入数据库。Simplepie 的 API 很大，不知道帖子的哪些部分应该保存。到目前为止，我正在保存：

*   ID
*   标题
*   日期
*   永久链接
*   作者
*   描述
*   内容

我想知道我应该在数据库中保存哪些其他内容。我不知道整个 API，而且很长。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:42:33.320

您可以采取逆向工程方法。

选择一些您已经拥有的提要并查看 url 源以查看提要中的标签。在检查了一些之后，您应该能够确定大多数提要包含什么并决定如何设置您的数据库。

例如，这是一个提要网址：

feeds.feedburner.com/webresourcesdepot?format=xml

您可以将其放在浏览器中，查看源代码，然后找到包含提要内容的部分并确定它们具有哪些标签。

您还可以浏览 RSS 规范并查看有效 RSS 提要的所有有效选项。

[http://cyber.law.harvard.edu/rss/rss.html](http://cyber.law.harvard.edu/rss/rss.html)

# gradle - Gradle - 如何在预定义任务上设置最新参数？

> ID：12096012
> 
> 赞同：1
> 
> 时间：2012-08-23T16:17:45.697
> 
> 标签：gradle

我真的可以在这方面使用一些帮助！

gradle 文档说要使最新的逻辑起作用，只需执行以下操作：

```
task transform {
    ext.srcFile = file('mountains.xml')
    ext.destDir = new File(buildDir, 'generated')
    inputs.file srcFile
    outputs.dir destDir 
```

这对于您正在定义的任务来说都很好。但是，我正在使用 eclipse 插件对 .classpath 文件进行一些修改。最新的不起作用。也就是说，它开箱即用地一遍又一遍地运行任务（至少对我而言）。这是我所拥有的：

```
eclipse {
    classpath {
        //eclipseClasspath.inputs.file // something like this??? but what to set it to?
        //eclipseClasspath.outputs.file //  here too
        file {
            withXml {

                def node = it.asNode()
                // rest of my stuff here 
```

我尝试了几件事，其中有两条注释掉的行。由于这些不起作用，我意识到我并没有真正的线索并且可以使用一些帮助！提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:37:02.967

根据我的经验，Eclipse 任务不应该每次都重新运行。这让我觉得你正在做一些事情来改变输入或输出。如果您在 Gradle 生成之后修改 Eclipse 项目或更改依赖项等，您自然会触发 upToDate 检查。

如果您确实需要每次都强制它运行，那么您也许可以让它与它一起工作。我不确定在已经定义了其他输出的情况下是否尝试过使用它。

```
eclipseClasspath {
  outputs.upToDateWhen { true } //there isn't an equivalent for inputs
} 
```

一个重要的注意事项是，您使用的是描述项目的 Eclipse 模型，而不是实际任务本身：

```
eclipse {  //this is the eclipse model
  classpath {

  }
}

eclipseClasspath {
  //this is a task
}

eclipseProject {
  //this is a task
} 
```

# database - 如何更好地组织数据库以考虑用户状态的变化

> ID：12096015
> 
> 赞同：4
> 
> 时间：2012-08-23T16:17:57.293
> 
> 标签：database, database-design

我关心的用户可以是“未确认”或“已确认”。后者意味着他们可以获得完全访问权限，而前者意味着他们正在等待主持人的批准。我不确定如何设计数据库来解释这种结构。

我的一个想法是有 2 个不同的表：confirmedUser 和 unconfirmedUser，它们非常相似，只是 unconfirmedUser 有额外的字段（例如“emailConfirmed”或“confirmationCode”）。这有点不切实际，因为当用户确实被接受时，我必须复制所有信息（尽管我想它不会那么糟糕 - 不期望交通繁忙）。

我想象的第二种方法是将所有用户实际放在同一个表中，并在需要时拥有一个指向带有额外“未确认”数据的表的键（也许还在用户表中添加一个“已确认”标志）。

每种方法的优缺点是什么，是否有更好的方法来设计数据库？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T16:32:53.203

第一种方法意味着您需要为两个表编写每个查询 - 为所有常见的。坏（tm）。第二种选择肯定更好。这样，您可以`where confirmed = True`根据需要添加一个简单的（或 False）特定访问权限。

您实际上可以考虑的是确认的数据（不是用户，只是数据）是否存储在同一个表中。也许将所有确认数据放在一个单独的表中会更清晰+规范化，这样您`left join confirmation on confirmation.userid = users.id where users.id is not null` *（或类似的，或内部联接，或在服务器端脚本中获取所有+过滤器等）*以仅获取已确认的用户。确认电子邮件、日期等附加数据可以存储在这里。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T16:37:11.987

就我个人而言，我会选择您的第二个选项：1 个用户表，其中包含布尔类型的已确认/待定列。将数据从一个表复制到另一个相同的表是不切实际的。

然后，您可以创建组并将特定访问权限附加到每个组，并在需要时将每个用户分配到特定组。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-23T19:02:03.290

从逻辑上讲，这是继承（又名类别、子类、子类型、泛化层次结构等）。

从物理上讲，继承可以通过 3 种方式实现，如此[处](https://stackoverflow.com/questions/12050849/connecting-supertype-subtype/12052088#12052088)、[此处](https://stackoverflow.com/questions/12032348/interpreting-er-diagram/12037398#12037398)、[此处](https://stackoverflow.com/questions/9174200/how-to-create-multiple-one-to-ones/9178524#9178524)以及可能在 SO 上的许多其他地方所提到的。

在这种特殊情况下，所有类型在同一个表中的策略似乎最合适¹，因为层次结构很简单，不太可能获得新的子类，子类只有几个字段不同，您需要维护父级键（即未确认和确认的用户不应该有重叠的键）。

* * *

*¹即您的问题中提到的“第二种方式”。是否也将确认数据放在同一个表中取决于所需的基数 - 即那里是否存在 1:N 关系？*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T16:31:42.207

做到这一点的最佳方法是为用户提供一个表，其中状态 ID 作为外键，状态表将包含所有不同类型的确认以及您可能拥有的所有不同组合。在我看来，这是构建规范化数据库和满足您的编程需求的最佳方式。

所以你的状态表看起来像这样

```
StatusID | Description
=============================================
1        | confirmed
2        | unconfirmed
3        | CC confirmed
4        | CC unconfirmed
5        | acct confirmed CC unconfirmed
6        | all confirmed 
```

用户表

```
userID | StatusID
=================
456    |    1
457    |    2
458    |    2
459    |    1 
```

如果您需要确认码，可以将其存储在用户表中。并对其进行编程以在使用后进行更改，以便在他们需要重置密码或其他任何情况时可以使用相同的字段。

也许我假设太多了？

# java - Java找不到主类

> ID：12096016
> 
> 赞同：22
> 
> 时间：2012-08-23T16:18:03.070
> 
> 标签：java, main, classnotfoundexception

我编写了以下 Java 源文件 ( `Hello.java`)：

```
package com;

public class Hello {
    public static void main(String[] args) {
        System.out.println("Hello!");
    }
} 
```

我把这个保存到`C:/tmpjava/Hello.java`.

从命令行，我导航到该目录并运行`javac Hello.java`. 然后我运行`dir`：

*   `Hello.class`
*   `Hello.java`

然后，从我刚刚运行的同一个目录中`javac`，我运行`java Hello.class`并得到：

```
Exception in thread "main" java.lang.NoClassDefFoundError: Hello/class
Caused by: java.lang.ClassNotFoundException: Hello.class
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Could not find the main class: Hello.class.  Program will exit. 
```

这里发生了什么？！？怎么`javac`能跑得好，但不行`java`？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-08-23T16:29:31.037

你的类`Hello`属于包`com`。因此，您的班级的完全限定名称是`com.Hello`. 当您在命令行上使用 java 调用程序时，您应该提供包含您的`main`方法的类的完全限定类名并省略*.class*，如下所示：

```
java com.Hello 
```

java 程序需要这个完全限定的类名来理解你指的是哪个类。

但是你还有另一个问题。java 程序使用文件系统定位包、子包和属于它们的类。因此，如果您有一个类似的包结构`com.Hello`，java 程序期望在名为*com*的目录中找到一个名为*Hello.class*的类文件，如下所示：*com/Hello.class*。事实上，你可以在你所看到的中观察到这种行为；您错误地使用了*Hello.class*，java 将其解释为名为 的包*和*名为的*类*，并且正在寻找目录结构*Hello/class*：**`Exception`**`Hello`*`class`*****

 ***> java.lang.NoClassDefFoundError: 你好/类

但是编译器 javac默认**不**设置这个目录结构。请参阅[javac 的文档](http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/javac.html)，但重要的是：当您进行编译时，您可以使用`-d`标志指定目标目录：

> -d 目录
> 
> 设置类文件的目标目录。目标目录必须已经存在；javac 不会创建目标目录。如果类是包的一部分，javac 会将类文件放在反映包名称的子目录中，并根据需要创建目录。例如，如果您指定 -dc:\myclasses 并且类名为 com.mypackage.MyClass，则类文件名为 c:\myclasses\com\mypackage\MyClass.class。
> 
> **如果未指定 -d，javac 会将类文件放在与源文件相同的目录中。**

粗体字的最后一点对于初学者来说是很多困惑的根源，并且是您自己问题的一部分。

所以你有两种选择：

1.  在您的情况下，如果您提供当前目录作为目标目录就可以了，就像这样（句点`.`表示*当前目录*）：

    ```
    javac -d . Hello.java 
    ```

    如果您像这样调用编译器，它将为您创建*com*目录，并将您编译的类文件放入其中，这是 java 程序期望找到它的方式。然后，当您从*c:\tmpJava*像上面那样运行 java 时，您的程序应该执行。

2.  您可以使用反映包结构的目录结构设置源代码：将源文件*Hello.java*放在名为*com*的目录中，在您的情况下为：*c:\tmpJava\com\Hello.java*。现在，从*c:\tmpJava*你可以像这样运行你的 javac 编译：

    ```
    javac com\Hello.java 
    ```

    您没有提供`-d`标志，但这很好，因为您自己创建了目录结构，并再次引用上面的文档：

    > 如果未指定 -d，javac 会将类文件放在与源文件相同的目录中。

    同样，当您像上面那样运行 java 时，您的程序应该执行。

    请注意，第二种选择是 java 程序员常用的一种选择：源代码文件组织在一个目录结构中，该目录结构反映了包结构。

在这个解释中，我们忽略了*类路径*的概念。您还需要了解编写 java 程序，但是在您只是在当前目录中编译程序的情况下 - 如果您在编译类时遵循上述两种选择之一 - 您可以在不设置类路径的情况下逃脱，因为，默认情况下，java 程序将当前目录作为类路径。另一个引用，这是来自[java 文档的](http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/java.html)引用：

> -cp 类路径
> 
> 指定目录、JAR 档案和 ZIP 档案的列表以搜索类文件。类路径条目由分号 (;) 分隔。指定 -classpath 或 -cp 会覆盖 CLASSPATH 环境变量的任何设置。
> 
> **如果未使用 -classpath 和 -cp 且未设置 CLASSPATH，则用户类路径由当前目录 (.) 组成。**

请注意，当您使用像 Eclipse 这样的 IDE 来运行您的 java 代码时，这主要是为您处理的，但您仍然会遇到类路径问题。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-23T16:24:43.630

Java 命令的语法是：

```
java [classname] 
```

*不是*

```
java [filename] 
```

Java 在其*类路径*中查找您提供的名称的类。通常类路径包括当前目录，所以：

```
java Hello 
```

... 将在当前目录中找到 Hello.class，并运行其 main() 方法。

但是，如果该类位于其他位置（例如 .jar 或文件系统中的其他位置），您可以使用 CLASSPATH 环境变量或在命令行中指定它：

```
java -cp build/classes Hello
java -cp build/jars/myjar.jar Hello 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-23T16:19:28.003

该类应该在`C:\tmpjava\com\Hello.class`
并且您应该从以下位置运行`C:\tmpjava`：`java -cp . com.Hello`
当您将一个类放入包中时，它定义了该类的文件结构。即你的包中的类`com`应该在文件夹中`com`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-23T16:20:25.207

运行以下命令

```
java -cp . com.Hello 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T16:22:27.217

java -classpath c:\tmpjava com.Hello***

# java - 我可以在 Spring MVC 控制器中获取当前的 webflow 状态吗？

> ID：12096018
> 
> 赞同：5
> 
> 时间：2012-08-23T16:18:06.707
> 
> 标签：java, spring, spring-mvc, spring-webflow-2

表面上，有点奇怪的问题！但我正在创建一个同时使用 webflow 和传统 Spring MVC 控制器的 Web 应用程序。

从其中一个 webflow 视图中，从客户端向 spring 控制器发出一个 http 请求 (ajax)。当它最初被编码时，它与 webflow 没有太多的逻辑连接，但现在事情已经发生了，控制器真的可以知道请求来自哪个屏幕（视图状态）。

我的控制器方法签名如下所示：

```
@RequestMapping(value="/AjaxStuff", method=RequestMethod.POST)
public String ajaxStuff(@ModelAttribute("quote") QB2MotorQuote p_quote, BindingResult p_bindingResult, 
        HttpServletRequest p_req, Model p_model, DefaultMessageContext p_messages) { 
```

我从我的一些 webflow 操作类中知道，我可以从 RequestContext 对象中获取当前状态：

```
public Event checkDeclines(RequestContext p_ctx) throws Exception {
    // get the current state
    StateDefinition state = p_ctx.getCurrentState(); 
```

我从来没有真正理解过 Spring 所做的“巫毒”：）它可以通过在方法签名上指定参数来自动注入参数（当然它只能注入它知道的东西？？）。我尝试简单地更改控制器方法的方法签名以注入 RequestContext（徒劳地希望它会被注入），但事实并非如此。它抱怨 RequestContext 是一个接口。

那么，有谁知道我如何让我的控制器知道当前的 webflow 状态 - 要么通过向控制器方法签名中注入一些东西，要么我可以以某种方式从 http 请求（或会话，我可以从请求中获取）获取它）。

非常感谢您对此的任何帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T12:37:05.900

在您的 webflow 视图中，您应该可以访问`${flowRequestContext}`可以在 ajax 调用中使用的变量。

您可以从中获取所需的信息`${flowRequestContext.currentState}`并将其添加为参数。

您不能直接注入 requestContext，因为您不在 webflow 环境中。如果你是，你可以直接使用`RequestContext.getRequestContext()`. 尝试从您的 MVC 控制器调用它，您将得到空值。从一个流程中尝试，你会得到它。

# php - 使用 PHP 填充文件的问题

> ID：12096021
> 
> 赞同：0
> 
> 时间：2012-08-23T16:18:16.983
> 
> 标签：php

基本上我的问题是下一个......下面的脚本连接数据库并创建一个文件......一切正常......除了它填充文件时......它没有将变量`$username`,`$password`和放入文件。创建的文件看起来像这样`$server``$dbname`

```
<?php

    // Database Constants
    $DB_SERVER ="";
    $DB_USER ="";
    $DB_PASS ="";
    $DB_NAME ="";
    ?> 
```

但它应该在引号内有一些东西：S

我的脚本如下

```
<?php 
//DB Config File
$dbFile = 'dbconfig.php';

function createfile ($dbFile) {
        //Creates File and populates it.
        $fOpen = fopen($dbFile, 'w');

            $fString .= "<?php\n";
            $fString .= "// Database Constants\n";
            $fString .= "\$DB_SERVER =" . "\"" . $server . "\";\n";
            $fString .= "\$DB_USER =" . "\"" . $username . "\";\n";
            $fString .= "\$DB_PASS =" . "\"" . $password . "\";\n";
            $fString .= "\$DB_NAME =". "\"" . $dbname . "\";\n";
            $fString .= "?>";

        fwrite($fOpen, $fString);
        fclose($fOpen);
return true;
}

if (isset($_POST['submit'])) {

$username = $_POST['username'];
$password = $_POST['password'];
$server = $_POST['server'];
$dbname = $_POST['dbname'];

try {
$db = new PDO ('mysql:host=' .$server.';dbname='.$dbname,$username,$password);

if ($db) { //if succesful at connecting to the DB

if (file_exists($dbFile)){
    if (is_readable($dbFile) && is_writable($dbFile)){ 

        //Creates File, populates it and redirects the user

    if (createfile($dbFile)) { 
    header("Location: http://http://localhost/proj11/install2.php");
    exit ();
            }

        } else { 

        $msg = "2The file {$dbFile} cannot be accessed. Please configure the file manualy or grant Write and Read permission.";  }

    } else {

        //Creates File, populates it and redirects the user

    if (createfile($dbFile)) {

    header("Location: http://http://localhost/proj11/install2.php");
    exit ();
            }

        }

}

} catch (PDOException $e) { //Catchs error if can't connect to the db.
    $msg = 'Connection failed: ' . $e->getMessage();
}

}

?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
</head>

<body>
<form id="iForm" method="post" action="install.php">
<label id="username" >Username</label>
<input id="username" name="username"/>
<label id="password">Password</label>
<input id="password" name="password" />
<label id="server" >Server</label>
<input id="server" name="server"/>
<label id="dbName" >dbName</label>
<input id="dbName" name="dbname"/>

<input type="submit" name="submit" value="submit" />
</form>
<p id="error"><?php echo $msg ?></p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:20:47.157

您的变量`$username`, `$password`, ... 不是全局变量。它们不在函数的范围内。您需要将这些变量传递给函数。

或使用`global`关键字：

```
function createfile ($dbFile) {
  global $server;
  global $username;
  global $password;
  global $dbname;
  ... 
```

但请注意，过度使用`global`是非常糟糕的做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:22:07.517

你没有传递`$server, $username, $password, $dbname`给函数。

尝试做

```
function createfile($dbfile,$params)
{
   list($server,$username,$password,$dbname) = $params;
   /* ... */
}

/* ... */

if (createfile($dbFile,array($server,$username,$pasword,$dbname))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T16:22:52.563

你需要转换：

```
function createfile ($dbFile) {
        //Creates File and populates it. 
```

对此：

```
function createfile ($dbFile) {
        global $username, $password, $server, $dbname; 
        //Creates File and populates it. 
```

或这个 ：

```
function createfile ($dbFile, $username, $password, $server, $dbname) {
        //Creates File and populates it. 
```

在最后一种情况下，您的电话自然会变成：

```
createfile ($dbFile, $username, $password, $server, $dbname); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T16:22:53.753

您要么需要使用`global`关键字引用全局变量：

```
function createfile ($dbFile) {
    global $username, $password, $server, $dbname; 
```

或将它们`createfile`显式传递给：

```
function createfile ($dbFile, $username, $password, $server, $dbname) {

/* ... */

if (createfile($dbFile, $username, $password, $server, $dbname)) { 
```

# iphone - 自定义 mapView:viewForAnnotation 生成无限循环

> ID：12096031
> 
> 赞同：0
> 
> 时间：2012-08-23T16:18:53.053
> 
> 标签：iphone, ios, mkannotationview

我的第一个问题。

我正在尝试为用户位置自定义默认的蓝色圆圈，但是当我重新定义方法 mapView:viewForAnnotation 时，我以某种方式生成了一个无限循环：

重新定义的方法：

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id )annotation {

MKPinAnnotationView *annotationView = [[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:@"Pin"];

if (annotation == mapView.userLocation) {
   annotationView.image = [UIImage imageNamed:@"user_pin.png"];
   annotationView.canShowCallout = YES;
   annotationView.animatesDrop = NO;

   return annotationView; // was return nil
}

annotationView.image = [UIImage imageNamed:@"other_pin.png"];
annotationView.canShowCallout = YES;
annotationView.animatesDrop = NO;
return annotationView;

} 
```

一些想法？可能的原因？

提前致谢

# database - 在 Web 应用程序中有效地处理数据

> ID：12096032
> 
> 赞同：0
> 
> 时间：2012-08-23T16:18:55.337
> 
> 标签：database, web-applications

我正在寻找一些有关如何在 Web 应用程序中有效处理模型数据的材料。目前，我使用基本的 CRUD 操作来访问数据库，执行一些业务逻辑，并将这些数据传递给视图，用户可以通过 Web 界面对其进行操作。我想了解更多关于优化 Web 应用程序中的数据检索和数据更新的信息……关于在哪里阅读这方面的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:24:09.937

首先，它取决于您的数据库。您使用哪个数据库和哪个引擎？

然后，这取决于您的数据复杂性；你有很多相互关联的数据吗？你使用很多索引表吗？

然后是数据存储结构：您希望它的执行时间更快还是占用内存更少？

因为没有不好的技术，只有 1 个问题的 1 个解决方案 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:33:03.580

你应该学习的是[DAO](http://en.wikipedia.org/wiki/Data_access_object)设计模式。
对于小型数据库，这是要走的路。阅读它，然后阅读您使用的语言的示例。

# java - do-while loop not continuing

> ID：12096033
> 
> 赞同：1
> 
> 时间：2012-08-23T16:18:59.017
> 
> 标签：java, loops, do-while

I'm having an issue with the code below. It's all working fine, except I want the program to restart if the user types in "Y" at the end, and end if anything else is pressed.

However, whenever I type anything at the "Restart Calculator" prompt, it will stop running, regardless of whether I type in "Y" or "N". Validation with the Y/N is not too important here, I just want it to restart if Y is typed and end if anything else is typed.

Apologies for the noob code, Java beginner here.

```
import java.util.Scanner;
import java.text.*;

public class Savings {

public static void main(String[] args)
{

//Imports scanner, to read user's input
Scanner input = new Scanner(System.in);
Scanner scan = new Scanner(System.in);

do {
    //Asks for and receives user's initial deposit
    int initial_Deposit;
    do {
        System.out.print("Enter initial deposit in dollars (Between $1 - $50000: ");
        while (!scan.hasNextInt()) {
            System.out.println("Please enter a valid number between '1-50000'");
            scan.next();
        }
        initial_Deposit = scan.nextInt();
    } while (initial_Deposit <= 0 || initial_Deposit >= 50001);

    //Asks for and receives user's interest rate
    double interest_Rate;
    do {
        System.out.print("Enter interest rate as a percentage between '0.1-100.0' (e.g. 4.0):");
        while (!scan.hasNextDouble()) {
            System.out.println("Enter interest rate as a percentage between '0.1-100.0' (e.g. 4.0):");
            scan.next();
        }
        interest_Rate = scan.nextDouble();
    } while (interest_Rate <= 0.0 || interest_Rate >= 100.1);

    //Asks for and receives user's monthly deposit
    int monthly_Deposit;
    do {
        System.out.print("Enter monthly deposit in dollars between '$1 - $5000: ");
        while (!scan.hasNextDouble()) {
            System.out.println("Enter monthly deposit in dollars between '$1 - $5000: ");
            scan.next();
        }
        monthly_Deposit = scan.nextInt();
    } while (monthly_Deposit <= 0 || monthly_Deposit >= 5001);

    //Asks for and receives user's investment duration  
    int monthly_Duration;
    do {
        System.out.print("Enter investment duration (Between 1 and 12): ");
        while (!scan.hasNextDouble()) {
            System.out.println("Enter investment duration (Between 1 and 12): ");
            scan.next();
        }
        monthly_Duration = scan.nextInt();
    } while (monthly_Duration <= 0 || monthly_Duration >= 13);

    //Asks for and receives user's first name
    String first_Name;
    System.out.print("Enter first name: ");
    first_Name = input.next();

    //Asks for and receives user's surname
    String last_Name;
    System.out.print("Enter surname: ");
    last_Name = input.next();

    //Formats first name to only first letter
    char firstLetter = first_Name.charAt(0);

    //Changes name to correct format
    String formatted_Name;
    formatted_Name = "Savings growth over the next six months for " + last_Name + ", " + firstLetter;
    System.out.println(formatted_Name);

    //Calculates the first balance
    double balanceCurrent;
    balanceCurrent = initial_Deposit + monthly_Deposit;

    //Prepares to format currency
    DecimalFormat df = new DecimalFormat("#.##");

    //Defining variables
    double balanceNew;
    double interestEarned;

    //Defining counter for while loop
    int counter;
    counter = monthly_Duration;
    int month_Counter;
    month_Counter = 1;

    //While loop to calculate savings
    while (counter > 0) {
        balanceNew = balanceCurrent + (balanceCurrent *((interest_Rate /12)/100));
        interestEarned = balanceCurrent *((interest_Rate /12)/100);
        balanceCurrent = balanceNew + monthly_Deposit;
        System.out.println("Balance after month " + month_Counter + ": $" + df.format((balanceNew)));
        System.out.println("Interest earned for this month: $" + df.format(interestEarned));
        counter = counter - 1;
        month_Counter = month_Counter + 1;

    }
    //Formats data into a table
    balanceCurrent = initial_Deposit + monthly_Deposit; 
    counter = monthly_Duration;
    int month;
    month = 0;
    String dollarSign = "$";

    String stringHeadingOne = "Month";
    String stringHeadingTwo = "New Balance";
    String stringHeadingThree = "Interest Earned";
    String dividerOne = "-----     -----------     ---------------";
    System.out.println("");
    System.out.printf("%-9s %s %19s \n", stringHeadingOne, stringHeadingTwo, stringHeadingThree);
    System.out.println(dividerOne);

    while (counter > 0) {
        balanceNew = balanceCurrent + (balanceCurrent *((interest_Rate /12)/100));
        interestEarned = balanceCurrent *((interest_Rate /12)/100);
        balanceCurrent = balanceNew + monthly_Deposit;
        month = month + 1;
        System.out.printf("%-11s %s %s %13s %s \n", month, dollarSign, df.format((balanceNew)), dollarSign, df.format(interestEarned));
        counter = counter - 1;
    }
System.out.print("Restart Calculator? Y/N);");
} while (scan.next() == "Y"); 
```

} }

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:27:29.023

```
while (scan.next() == "Y");      // Is checking for reference equality 
```

When doing object comparisons in Java, use `equals()`

```
while (scan.next().equals("Y")); 
```

Or, as the previous answer pointed out you can compare characters with the `==` operator

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:24:11.400

Try this:

```
scan.nextLine().charAt(0) == 'Y' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T16:30:04.623

When comparing Strings or anyother object for that matter you need to use the .equals(Object other) method. You can only use == with primatives ( boolean, int, double,...)

```
scan.nextLine().equals("Y");
//or
scan.next().equals("Y"); 
```

There is also an method to take the string to Uppercase that would allow the user to enter "y" or "Y"

```
scan.next().toUpperCase().equals("Y"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T16:28:12.810

You should be using the [Equals](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#equals%28java.lang.Object%29) method for Strings:

```
while ("Y".equals(scan.next())); 
```

# linux - 在 Vim 中将键重新映射到 Escape（德语键盘）

> ID：12096039
> 
> 赞同：2
> 
> 时间：2012-08-23T16:19:18.097
> 
> 标签：linux, vim, keyboard, console

好的，所以我一直在尝试 Vim（标准控制台版本；我的操作系统是 Linux Mint 13），我想摆脱必须使用 Escape 键来更改模式。最好，我想交换 Capslock 和 Escape 键，但据我所知，这在 Vim 本身内是不可能的。我发现的大多数“解决方案”都涉及在全局级别（使用`xmodmap`或其他）更改密钥，但我真的不想要那样。**如果只有在 Vim**中交换 Capslock 和 Escape 的简单方法，请告诉我。

我听说的另一个常见的事情是使用“Ctrl-[”作为 Escape 的等价物。但是，因为我使用的是具有不同布局的德语键盘，所以这不是一个选择。所以，我想我会`noremap <C-ü> <Esc>`在 Vim 中使用（德语键盘上的“ü”键与美国键盘上的“[”键在同一个位置），但这也不起作用。我假设那是因为“ü”不是 ASCII 字符。有没有办法让这些选项中的任何一个起作用？

**更新**：嗯，这很奇怪。在进行了更多实验之后，似乎“Ctrl-ü”确实有效。我不确定发生了什么——也许我在尝试不同的事情时弄乱了一些与编码相关的设置？如果没有重新映射大写锁定的好的解决方案，我想我会坚持使用“Ctrl-ü”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T15:45:04.797

所以，是的，最终我决定使用它，`<C-ü>`因为它不会与其他任何东西发生冲突，而且它与`<C-[>`美国键盘上的相同。

但是，因为我已经厌倦了使用德语键盘布局进行编程（例如，要获得“{”，你需要输入“Alt Gr-7”），我将我的键盘切换到美国国际，本质上就 Vim 而言，具有类似的效果。如果您想养成触摸打字的习惯，这也会有所帮助；您实际上无法查看键盘，因为键未标记为“正确”；-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:10:03.250

很多人使用`jk`：

```
inoremap jk <Esc> 
```

你也可以简单地做`<C-c>`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-10T01:50:13.600

这是另一种可能对您有用的选择！它涉及更改与 VIM 相关的键盘文件。[我在这个 youtube 视频上](https://www.youtube.com/watch?v=HskQMorxboY)找到了这个建议

```
$ cd /usr/share/X11/xkb/symbols/
sudo vim pc 
```

要编辑 capslock 键以进行转义，请将 capslock 行更改为如下所示：

```
key <CAPS> { [ Escape ] }; 
```

`:wq`# 写入和关闭文件

注销并重新登录机器，它应该被更新！

# ruby-on-rails - 从 Rails 中的对象哈希中获取值

> ID：12096040
> 
> 赞同：0
> 
> 时间：2012-08-23T16:19:18.100
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有以下代码：

```
def analytics 
    @user_registrations = User.count(:conditions => ["created_at >= ?", 30.days.ago.to_date], group: "date(created_at)")
    @daily_count = []
    30.times do |day|
      @daily_count << [Date.today - day, @user_registrations['#{Date.today - day}']]
    end
  end 
```

当运行时：`<%= simple_format @user_registrations.to_yaml %>`产生：

```
--- !omap 
- '2012-08-23': 11 
```

我想取出`11`值并将其放入我的 daily_count 数组中。

我怎样才能做到这一点？

更新：

```
<%= simple_format @user_registrations.to_yaml %>
<%= simple_format @daily_count.to_yaml %> 
```

结果图像：

![**在此处输入图片描述**](../Images/699d067c2c45de806ece5257840e6c20.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:45:13.887

只需更换：

```
@daily_count << [Date.today - day, @user_registrations['#{Date.today - day}']] 
```

和：

```
@daily_count << [Date.today - day, @user_registrations["#{Date.today - day}"] || 0] 
```

单引号将导致 #{} 转义语法被视为文字，双引号导致它被评估。

# jquery - DataTables ServerSide 排序不起作用 - mDataProp

> ID：12096041
> 
> 赞同：2
> 
> 时间：2012-08-23T16:19:19.313
> 
> 标签：jquery, ajax, sorting, datatables, server-side

我在启用服务器端处理的情况下创建了以下数据表：

```
$(document).ready(function() {
    oTable = $('#example').dataTable( {
        "bServerSide": True,
        "sAjaxSource": "source.php",
        "aaSorting": [[0,"asc"]],
        "aoColumns": [
            { "mDataProp" : "Name",
               "sType": "string-case" },
            { "mDataProp" : "Priority",
               "sType": "string-case" },
            { "mDataProp" : "Action",
               "sType": "string-case" }
        ]
    } );
} ); 
```

Name、Priority 和 Action 都是我想要排序的字符串。每当我单击列标题时，它只会重新加载表格。可能是一个愚蠢的问题，但我是否需要在服务器端进行所有排序（使用 iSortCol_0 和 sSortDir_0 作为我的标识符）？是否可以在不刷新这样的表的情况下对客户端进行排序并实际上根据名称对其进行排序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T16:34:22.097

使用`bServerSide: true`DataTables 时只会询问适合当前页面的数据。例如，当您进入下一页时，它将询问接下来的 10 条记录。DataTables 无法在客户端进行排序，因为它不知道整个数据集。

如果您只是想从 ajax 源中提取整个数据集，您可以使用该`sAjaxSource`选项。

```
$(document).ready(function() {
    $('#example').dataTable( {
        "bProcessing": true,
        "sAjaxSource": '../ajax/sources/arrays.txt'
    } );
} ); 
```

示例：[http ://datatables.net/release-datatables/examples/data_sources/ajax.html](http://datatables.net/release-datatables/examples/data_sources/ajax.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T16:29:56.417

不幸的是，您必须自己处理服务器端的所有排序、分页、过滤。

我不知道您使用的是哪种服务器端技术，但数据表[主页](http://datatables.net/)有一些 PHP 示例。此外，还有一些用于在服务器端使用 ASP.NET MVC 的数据表的包装器

# css - ColdFusion cfdocument CSS 计数器增量计数器

> ID：12096043
> 
> 赞同：2
> 
> 时间：2012-08-23T16:19:30.570
> 
> 标签：css, coldfusion, cfdocument

下面的 HTML/CSS 适用于最近的浏览器，但不适用于 CF9 的 cfdocument。有想法的人吗？

**我知道什么？** 是的！我知道 CF 的 cfdocument 支持一组有限的 CSS 属性。CF 文档说支持 counter-reset、counter-increment 和 counter。

**预期**
产出杂货：
1) 苹果
2) 香蕉
3) 甜瓜

**示例代码**

```
<cfdocument format="PDF" pagetype="letter" 
    margintop="0.5" marginbottom="0.5" 
    marginleft="0.5" marginright="0.5">
<html>
<head>
    <style type="text/css">
        li { list-style-type: none; }
        ol { counter-reset: ordered; 
          padding-left: 0.5em; 
          border: solid 1px #F00; 
        }
        li:before { counter-increment: ordered; 
          content: counter(ordered) ") "; 
        }
    </style>
</head>
<body>
    <strong>GROCERIES:</strong><br>
    <ol>
      <li>Apples</li>
      <li>Bananas</li>
      <li>Cantelopes</li>
    </ol>
</body>
</html>
</cfdocument> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:11:42.853

我认为指定列表样式类型可能会有所帮助，下面的内容应该让您更接近。数字后面有小数点：

杂货：

1.  ） 苹果
2.  ） 香蕉
3.  ) 甜瓜

* * *

```
<cfdocument format="PDF" pagetype="letter" 
    margintop="0.5" marginbottom="0.5" 
    marginleft="0.5" marginright="0.5">
<html>
<head>
    <style type="text/css">
        ol {list-style-type: none;}
        li:before {content: counter(section, decimal) ") ";}
        li { counter-increment: section;}
    </style>
</head>
<body>
    <strong>GROCERIES:</strong><br>
    <ol>
        <li>Apples</li>
        <li>Bananas</li>
        <li>Cantelopes</li>
    </ol>
</body>
</html>
</cfdocument> 
```

# php - 使用 htaccess 在 HTML 文件中包含 PHP

> ID：12096044
> 
> 赞同：0
> 
> 时间：2012-08-23T16:19:30.923
> 
> 标签：php, html, .htaccess

使用 htaccess 在 HTML 文件中呈现 PHP 以用于导航/菜单之类的东西仍然被认为是一种好的做法吗？

我过去常常为不需要 CMS 的小型网站做这件事，但现在我不确定这是否是失礼。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:21:56.220

这完全取决于你。它不会对您的网站构成任何威胁或暴露任何漏洞，因此无论哪种方式都无关紧要。渲染带有 HTML 扩展名的 PHP 文件与渲染带有 PHP 扩展名的 PHP 文件没有什么不同。

事实上，如果您将静态站点迁移到动态站点，这实际上是保留页面 URL 的好方法。

# javascript - 在使用函数 document.write() 打印最终结果后，如何使用 Javascript 滚动到页面顶部

> ID：12096051
> 
> 赞同：0
> 
> 时间：2012-08-23T16:19:50.830
> 
> 标签：javascript, scroll, reload

对不起我的经验不足

基本上我的 JS 代码由一个带有输入的表单、一个按钮和使用函数 document.write() 打印的最终结果组成

```
<form>
<input type="text" name="lavagens" size="3" MAXLENGTH="3" value="30"> INPUT<br>
<INPUT TYPE="submit" VALUE="Calc" onClick="calcula_custos_auto()"><br> 
</form>

function calcula_custos_auto(){    
a+b+c*d; //some calculations with inputs
document.write("a lot of results"); //print results on screen
window.scrollTo(0,0); //doesn't work
} 
```

问题是在打印完所有这些占据很多行的结果后，屏幕没有转到顶部。scrollTo(0,0) 方法似乎不起作用。我该如何解决这个问题？

顺便说一句，我怎样才能创建一个按钮，再次重新加载页面，以便用户可以再次输入值？

非常感谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:22:20.580

a+b+c*d 抛出异常：

```
ReferenceError: a is not define 
```

所以它永远不会到达该函数中的其余代码，因此它不会滚动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:33:08.650

尝试这个：

```
<form>
<input type="text" name="lavagens" size="3" MAXLENGTH="3" value="30"> INPUT<br>
<INPUT TYPE="submit" VALUE="Calc" onClick="calcula_custos_auto()"><br> 
<div id'resultDiv'></div>
</form>

function calcula_custos_auto(){    
a+b+c*d; //some calculations with inputs
var div = document.getElementById('resultDiv');
div.innerHTML= 'Put Your Result here';
window.scroll(0,1);
} 
```

我们您的结果显示在当前表单上而无需重新加载，您无需再次添加输入框和按钮。

# r - 如何将数组转换为xts

> ID：12096052
> 
> 赞同：1
> 
> 时间：2012-08-23T16:19:53.670
> 
> 标签：r, xts

```
library(quantmod)
getSymbols('AAPL')
n <- nrow(AAPL)
a <- runif(n) 
```

我想转换`a`为日期等于`AAPL`.

到目前为止，我无法以任何方式做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:24:10.493

这很简单：

```
a <- xts(runif(nrow(AAPL)), index(AAPL)) 
```

# scala - 如何使用 Scala 导入子句从方法参数导入

> ID：12096053
> 
> 赞同：0
> 
> 时间：2012-08-23T16:19:53.883
> 
> 标签：scala, object, traits

我编写了一个名为 Vegetables.scala 的 Scala 源文件。我试图从下面的代码中完成的是了解导入子句的工作原理。我在 Eclipse 中输入了这个程序并启动了基于 Eclipse 的 REPL。我想做的是创建一个名为 Spinach 的新对象，它扩展了蔬菜，将其分配给一个 val 并最终调用对象蔬菜的 showColor 方法，将菠菜对象传递给它。我知道这些例子听起来很荒谬，但我现在只是试图理解 Scala 的概念/机制。为此，我在 REPL 中做了以下工作：

所以这就是我在 REPL 上所做的并得到一个错误。

```
import com.att.scala.Vegetables._
import java.awt.Color
val obj = object Spinach extends Vegetable { val name = "Spinach" val color = Color.GREEN }

<console>:1: error: illegal start of simple expression
       val obj = object Spinach extends Vegetable { val name = "Spinach" val color = Color.GREEN }
                 ^ 
```

Vegetable.scala 的代码如下：

```
 package com.att.scala
 import java.awt.Color

 trait Vegetable {
  val name: String
  val color: Color
}

  object Vegetables {
    object Asparagus extends Vegetable { 
      val name = "Asparagus"
      val color = Color.GREEN  
  } 

object Carrot extends Vegetable { 
  val name = "Carrot"
  val color = Color.ORANGE 
 }
val veggiePlatter = List(Asparagus, Carrot)

 def showColor(veggie: Vegetable) {
   import veggie._
   println("Entered showColor")
   import veggie._
   println("veggie color is " + color)
  }
} 
```

* * *

什么可以解释这个错误？首先，我试图了解在 REPL 上创建对象然后将其分配给 val 的正确方法是什么。一旦解决了问题，我希望将该 val 传递给参数。然后，我想测试 showColor 中的 import 子句，看看它是否确实导入了 veggie 参数的成员。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:27:44.467

定义一个对象就像定义一个静态成员或一个类。您不能同时声明它并将其分配给变量。（事实上​​你并不需要，因为对象在定义之后就可以通过它的名字访问了。）

因此，您的示例将在 REPL 中作为：

```
import com.att.scala.Vegetables._
import java.awt.Color
object Spinach extends Vegetable { val name = "Spinach" val color = Color.GREEN } 
```

这将定义一个名为`Spinach`. 之后，您可以打电话`Vegetables.showColor(Spinach)`来实现您的初始目标。

如果您真的想将它分配给一个变量，您可以`val obj = Spinach`在声明对象后调用，这将是有效的（尽管不是特别有用 -`Spinach`已经是该事物的明确名称，`obj`实际上只是一个别名。）。*在声明*对象的同一行上执行此操作是非法的语法。

# css - Richfaces：如何完全控制 CSS

> ID：12096055
> 
> 赞同：0
> 
> 时间：2012-08-23T16:20:01.647
> 
> 标签：css, jsf, jsf-2, richfaces

我正在从事的项目聘请了一位设计师来创建 HTML/CSS。我想将 CSS 文件放到我们的项目中，稍微操作一下 HTML，让应用程序看起来像设计师设计的那样。

我的问题是，richfaces 包含它自己的 CSS 文件，这会影响设计师制作的内容。

我已经使用 org.richfaces.enableControlSkinning 上下文参数关闭了蒙皮，这很有帮助。但是，我仍然收到诸如 datatable.ecss.jsf 之类的 css 文件，这会影响我的数据表的样式。

我真的不想为richfaces css 设置的每个属性添加到我们的自定义 css 覆盖。我当然不想做[这里](https://stackoverflow.com/questions/4455018/how-can-i-remove-the-css-classes-from-a-richfaces-component)建议的事情。我原以为这是一个常见的用例，但我找不到任何答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:54:13.123

正如 RichFaces 论坛中所述，您可以通过将皮肤设置为“plain”或“null”来禁用项目的所有 RichFaces CSS。

```
<context-param>
    <param-name>org.richfaces.skin</param-name>
    <param-value>plain</param-value>
</context-param> 
```

信息链接：[删除默认 CSS - 对于特定组件](https://community.jboss.org/message/40945)

# gwt - 部署到 Tomcat 服务器时，GWT 应用程序无法正常工作

> ID：12096056
> 
> 赞同：1
> 
> 时间：2012-08-23T16:20:09.287
> 
> 标签：gwt

我有一个小型网络应用程序，在 Eclipse 中部署到 App Engine 时可以正常工作。但是，当我想将我的应用程序部署到我的 Tomcat 服务器时出现错误。

我将war文件夹的内容直接复制到Tomcat的默认ROOT文件夹中。然后我在 Eclipse 内部的外部服务器上运行我的应用程序。

到那时一切正常——应用程序直接从浏览器的缓存中加载。

**问题来了：**

当我点击我的应用程序的一些通过 GWT 端的 JSNI 实现的功能时，谷歌浏览器开发控制台显示***“未捕获的 ReferenceError：函数未定义” 。***我知道错误来自外部 JS 代码中的 JS 调用者。调用者调用一个 GWT 客户端方法/函数（这就是它没有在 ext.JS 代码中定义的原因）。

关于如何解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:15:57.743

您是否有任何需要外部 js 文件的额外模块？某些模块要求将 js 文件包含在 war 中并包含在您的根 .html 文件中。可能是您使用的库没有基本的 js 函数。

您可以将其添加到您的 .gwt.xml 文件中以打开堆栈跟踪。

```
<set-property name="compiler.stackMode" value="emulated"/>
<set-configuration-property name="compiler.emulatedStack.recordLineNumbers" value="true"/> 
<set-configuration-property name="compiler.emulatedStack.recordFileNames" value="true"/> 
```

您还可以尝试使用 setUncaughtException 处理程序来查看在生产模式下引发的异常。打开模拟堆栈跟踪后，您应该能够获得包含代码行号的回溯。它不如开发模式，但对调试非常有用。

```
GWT.setUncaughtExceptionHandler(new GWT.UncaughtExceptionHandler()) {
    @Override
    public void onUncaughtException(Throwable cause) {
        logger.log(Level.SEVERE, "OOPS", cause);
    }
} 
```

注意 确保您的记录器配置为使用您可以访问的内容。像萤火虫或远程日志记录 servlet。

我目前使用 eclipse 在生产和开发模式下使用 tomcat 7。您可以在 eclipse 中配置服务器的 tomcat 实例并使用“在外部服务器上作为 WebApplication 运行”。这将允许您在开发模式下查看异常。

如果您处于生产模式，还要确保您没有 ?gwt.codesvr=127.0.0.1:9997 。除非您正在运行开发代码服务器，否则这也会导致问题。

# ruby-on-rails - OmniAuth ruby on rails，强制 facebook 用户在当前登录 facebook 时重新进行身份验证

> ID：12096059
> 
> 赞同：3
> 
> 时间：2012-08-23T16:20:17.233
> 
> 标签：ruby-on-rails, facebook, facebook-graph-api, omniauth

我有一个用户已授权的 facebook 应用程序。我想在他们的令牌过期时重新进行身份验证。问题是当用户已经登录到 Facebook 并且他们已经授权了应用程序时，facebook 只是重定向回 redirect_url。我不希望这种行为，因为用户可能有多个 Facebook 帐户，而他们登录的帐户可能不是正确的帐户。初始 facebook 授权通过服务器端身份验证发生。

**我想要：**

*   选择使用哪个 [帐户] 进行身份验证（这是理想的）或
*   强制他们重新验证他们的 Facebook 凭据

如果可能，我想避免使用 javascript sdk 强制注销然后重新登录。出于维护原因，我想保留所有服务器端。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-06T04:24:15.030

您可以通过设置为来[配置omniauth-facebook](https://github.com/mkdynamic/omniauth-facebook#configuring)以强制重新认证。`auth_type``reauthenticate`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:12:50.940

我不知道如何强制重新验证用户。（那将是更好的解决方案）但这是我第一次听到想要令牌更快过期的人。（令牌持续 2 小时，[https://developers.facebook.com/blog/post/2011/05/13/how-to--handle-expired-access-tokens/](https://developers.facebook.com/blog/post/2011/05/13/how-to--handle-expired-access-tokens/)）。

你的用例真的很不寻常：

“*用户可能有多个 Facebook 帐户，而他们登录的帐户可能不是正确的帐户*”

谁有多个 Facebook 帐户？也许如果您是开发人员，您将需要一个额外的帐户，但最好使用这个： [https ://developers.facebook.com/docs/test_users/](https://developers.facebook.com/docs/test_users/)

问候

伊万格

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T09:36:05.787

> 强制他们重新验证他们的 Facebook 凭据

OAuth 对话框提供了一种[重新身份验证](https://developers.facebook.com/docs/authentication/reauthentication/)的方法——但我不太确定这是否符合您的需求，因此您必须尝试一下。

# android - 使用TextView的onClick进入下一页

> ID：12096064
> 
> 赞同：1
> 
> 时间：2012-08-23T16:20:32.057
> 
> 标签：android, android-layout, android-intent, android-emulator

为了更好的 UI，我想用 TextViews 代替 Buttons。单击 TextView 时，应显示应用程序的下一页。我在 XML 文件中定义了 onClick 函数，但它不起作用。

这是 XML 文件。

```
<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="16dp"
    android:onClick="serve"
    android:text="@string/Service"
    android:textSize="20dp" />

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/textView1"
    android:layout_below="@+id/textView1"
    android:layout_marginTop="87dp"
    android:onClick="complain"
    android:text="@string/Comp"
    android:textSize="20dp" />

<TextView
    android:id="@+id/textView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/textView2"
    android:layout_below="@+id/textView2"
    android:layout_marginTop="121dp"
    android:onClick="feed"
    android:text="@string/Feedback"
    android:textSize="20dp" /> 
```

Java 文件：

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void serve(View v)
    {
        Intent i=new Intent();
        i.setClass(this,Second.class);
        startActivity(i);
    }

    public void complain(View v)
    {
        Intent in=new Intent();
        in.setClass(this,Third.class);
        startActivity(in);
    }

    public void feed(View v)
    {
        Intent inn=new Intent();
        inn.setClass(this,Fourth.class);
        startActivity(inn);
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T16:45:52.573

默认情况下，TextView 不可点击，因此永远无法调用 onClick 操作...只需将：添加`android:clickable="true"`到您的每个 TextView：

```
<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="16dp"
    android:clickable="true"
    android:onClick="serve"
    android:text="@string/Service"
    android:textSize="20dp" /> 
```

按钮和许多其他视图需要用户交互，因此它们已经是可点击的，但不是 TextView。

* * *

此外，由于您的 onClick() 方法执行相同的基本操作，因此请考虑使用通用方法：

```
public void click(View v) {
    Intent intent;
    switch(v.getId()) {
    case R.id.serve: // R.id.textView1
        intent = new Intent(this, Second.class);
        break;
    case R.id.complain: // R.id.textView2
        intent = new Intent(this, Third.class);
        break;
    case R.id.feed: // R.id.textView3
        intent = new Intent();
    }
    startActivity(intent);
} 
```

您需要修改每个 TextView 中的`id`和属性，如下所示：`onClick`

```
<TextView
    android:id="@+id/serve"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="16dp"
    android:clickable="true"
    android:onClick="click"
    android:text="@string/Service"
    android:textSize="20dp" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:49:48.947

您的活动（基于您的代码没有任何`onClickListeners()`您需要获取对您的 textViews 的引用，然后添加一个事件处理程序，然后在您的事件处理程序内部是您将调用的地方`serve(), complain(), feed()`请参阅此 SO[问题](https://stackoverflow.com/questions/3328757/how-to-click-or-tap-on-a-textview-text)。以下是更改的示例你的活动课。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_main);

    TextView textView1 = (TextView) findViewById(R.id.TextView1);
    textView1.setOnClickListener(new View.OnClickListener() {

        @Override
        protected void onClick(View view) {

            serve(view);
        }

    });

    //Repeat for each text view...
} 
```

每个 TextView 都必须在 xml 中设置以下属性：

```
android:onClick="onClick"
android:clickable="true" 
```

**编辑：**

如果您打算这样做，我仍然看不到您 Activity 在哪里**实现 OnclickListener ...**

```
public class MainActivity extends Activity implements OnclickListener {

    protected void onClick(View view) {
        // borrowed from @Sam
        Intent intent;

        switch(v.getId()) {
            case R.id.serve: // R.id.textView1
                intent = new Intent(this, Second.class);
                break;
            case R.id.complain: // R.id.textView2
                intent = new Intent(this, Third.class);
                break;
            case R.id.feed: // R.id.textView3
                intent = new Intent();
            }

            startActivity(intent);
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T16:27:31.587

确保您的 Activity 中有以下方法（具有匹配的签名）。他们每个人都应该接受一个参数，即 a `View`。

```
public void serve(View v) { }
public void complain(View v) { }
public void feed(View v) { } 
```

# macos - 通过 Express 和 MongoDB 使用会话，为什么我只能连接一次路由，除非我更改会话密码？

> ID：12096068
> 
> 赞同：2
> 
> 时间：2012-08-23T16:20:44.207
> 
> 标签：macos, session, mongodb, express, mongoose

我在 Express.js 中有一个应用程序，我在端口 5000 上运行。我已经研究了一段时间，一切都很好。不过最近出了点问题，可能与升级到 Mountain Lion 有关。我不知道。

为了简化应用程序，我现在只设置了一个示例 GET 路由：

```
 app.get('/', function(req, res){
    console.log('made it here');
    res.end('Hey there');
  }); 
```

出于某种原因，当我尝试通过网络浏览器（chrome、safari）进行连接时，它不会多次连接。但是，如果我通过 telnet 直接连接到端口并发出 GET / ，我会得到我期望的响应（因为我假设没有会话在播放）。

此外，如果我更改我的会话密码，我可以通过浏览器再次连接到它，然后后续刷新永远不会命中路由（该路由永远不会记录 200），直到我再次更改密码。

这是我设置会话的方式：

```
app.use(express.cookieParser());
var mongoCon = require('connect-mongodb');
var session = express.session({
  store: new mongoCon({
      db: mongoose.connection.db
    , maxAge: 300000
  }), secret: 'donut' 
});
app.use(session); 
```

编辑：如果我使用 MemoryStore 而不是 Mongo 作为我的会话存储，它工作正常。

同样，这已经好几个星期了。我最近更新到山狮。我还重新安装了 npms，但验证我正在运行与以前相同版本的 connect-mongodb、mongoose、express 等。我在 Ubuntu 机器上运行了相同的代码库，看起来还不错。所以可能是Mac问题。

我意识到这是一个没有大量细节的疯狂问题，但我在这里有点不知所措。关于寻找什么的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:48:45.547

我发现它与我使用的 Mongoose 版本有关。我在 Mac 上使用最新版本的 mongoose (3.0.2)，在 Ubuntu 上使用 2.7.2。我猜`mongoose.connection.db`对象中的某些东西已经改变了。当我有机会时，我会验证。

以为我已经尝试过了，但我一定在某些时候混淆了版本。

希望 Mongoose 团队的某个人（也许是 aheckmann）会看到这个并让我知道这是我可以解决的问题，或者是 connect-mongodb 的问题等。

# c++ - 序列化日期时间

> ID：12096071
> 
> 赞同：2
> 
> 时间：2012-08-23T16:20:48.377
> 
> 标签：c++, time, c++11

执行日期/时间对二进制序列化的最佳方法是什么？

到目前为止，我最好的猜测是存储 POSIX time() 和 mktime() 函数返回的自纪元以来的秒数，然后在检索时使用 localtime() 将其转换回“人类可读”结构。

请注意，时间戳将由不同时区的计算机存储和检索。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:34:27.417

这取决于您对哪些数据感兴趣：

*   您需要亚秒级精度吗？显然， POSIX`time_t`通常不提供这一点，除非您使用某种浮点类型（这可能会引入自己的问题）。其他语言和库的时间格式（例如 JavaScript 和 Java）使用毫秒自固定日期而不是秒自固定纪元来解决此问题。
*   如果将跨时区存储和检索时间戳，那么使用定义为相对于时代的格式（如 POSIX`time_t`或[JavaScript Data](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date#Description)）可能比存储本地时间 + 时区更好。
*   如果您需要知道原始时区，那么您也需要存储它。
*   由于[2038 年的问题](http://en.wikipedia.org/wiki/Year_2038_problem)，如果您使用类似 POSIX 的东西`time_t`，您需要将其存储为 64 位数字，而不是 32 位数字。（即使您将其存储为 64 位数字，请记住您的 C 运行时`mktime`和`localtime`实现可能不支持 64 位`time_t`值。）

特别是关于 2038 年的问题：我不知道有任何 POSIX API 可以保证处理它。如果你想要一个可以保证处理它的库，你最好使用类似`boost::date_time`. [Project 2038 常见问题解答](http://maul.deepsky.com/~merovech/2038.html#What_operating_systems_and_platforms_are_affected_by_it)包含有关测试 C 运行时是否支持 2038 的信息。根据该页面，现代 64 位 Linux 系统不应受到影响。Visual C++ 的最新版本也不受影响。（[请参见此处](http://msdn.microsoft.com/en-us/library/1f4c8f33%28v=vs.80%29.aspx)。）即使您的库当前不支持 64 位`time_t`值，您也可以序列化 64 位 int 并将其转换为 32 位来处理它；这样，您的磁盘数据结构至少会兼容，并且您的库有望在 2038 年成为问题之前得到更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:23:42.780

> 请注意，时间戳将由不同时区的计算机存储和检索。

您是否也需要存储该时区？您对存储时的*本地*日期和时间感兴趣，还是只对时间*感兴趣*？

基本上，找出哪些信息对您很重要，并确保您存储了这些信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T16:29:37.037

你自己回答了。根据当地人的情况（即白天时间、时区、24 小时等），根据需要将计算机可理解的时间值转换为人类可读的格式是最好的。它的存储空间也很小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T16:40:48.770

这取决于您希望如何与二进制类型交互。如果总是使用 POSIX 函数，那么可以确定，一个 time_t 值就可以了。在 Windows 上，您需要将其转换为它们的格式以获取日期。当然，始终将二进制值保存为 UTC，不要对这个原始值应用任何偏移量。

另一种方法（不是最快的）是存储一个字符串而不是绑定到任何一个函数库。当然，如果您确定二进制值 1345739726 是使用 POSIX 调用创建的，那么如果将该值移动到 Windows 系统，您就可以进行转换。字符串格式只是消除了关于表示什么时间点的任何问题。字符串 sTime = "年：月：月日：工作日：小时：分钟：秒：日光：GMTOffset"

# android - 动态壁纸FPS问题

> ID：12096072
> 
> 赞同：0
> 
> 时间：2012-08-23T16:20:48.367
> 
> 标签：android, live-wallpaper, frame-rate

我正在开发一个动态壁纸，基本上我在旋转 80 帧（jpg 图像） - 每个图像大小约为 80KB（800 x 1200 尺寸） - 总图像文件夹大小约为 6 MB。

图像循环相当流畅，但是一旦我缩放图像（我这样做是为了在较小的屏幕上很好地显示图像） - FPS 会折腾 - 关于如何有效缩放图像的任何想法？

我最初想到了两件事——但这对我来说效果不佳：

1.  我想将所有缩放的图像放在位图的 ArrayList 中，但它给出了一个`VM Budget error`（也试图这样做`bitmap.recycle()`- 但它给出了另一个错误，例如，`trying to use recycle image`）。对此的任何想法将不胜感激。
2.  我虽然将缩放图像放入 SD 卡中 - 但同样，不知道为什么但 FPS 会受到影响 - 否则这可能是我可以检测手机大小并可以通过互联网下载图像并将其放入的最佳方法在 SD 卡中。但是，正如我所说，即使这样也效果不佳。

如果有人可以帮助这些方法中的任何一种，或者可以指出更好的方法 - 那应该很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T05:59:53.090

First of all try to sample down the image then scale it . this will reduce your memory size. Secondly store this image and use that image there after. you can find sampling and scaling of imager over [here](https://stackoverflow.com/questions/2641726/decoding-bitmaps-in-android-with-the-right-size/10868883#10868883). Let me know if you need more help.

# android - 从 byte[] 读取 EXIF 数据

> ID：12096074
> 
> 赞同：2
> 
> 时间：2012-08-23T16:20:57.780
> 
> 标签：android, bytearray, byte, jpeg, exif

我目前正在尝试以字节数组的形式从照片中获取 EXIF 数据。照片是直接从相机拍摄的，因此只能作为上述字节 [] 使用。

现在有许多 EXIF 提取库 - 然而，那些只使用 BufferReader，或者更糟糕的是，使用 FileStream。看到我碰壁了，我愿意使用 BufferReader 将 byte[] 提供给库。但不幸的是，我不知道有什么捷径，也不想实现我自己的 BufferReader 只是为了消耗字节 []。

此外，我不想将 byte[] 写入存储，然后再次读取它以获取 EXIF 信息，因为我想相应地旋转它并保存结果。因此，第一次保存文件是不合理的，因为无论如何我都会以方向校正的形式保存那个图像......

任何帮助都会很棒:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T14:33:00.783

我已经解决了上述问题。

进行图像旋转的最快方法是（恕我直言）在拍摄图像之前先让手机旋转，然后简单地旋转 PDF。这样，就不需要任何进一步的库或读取 EXIF 数据的开销。

步骤是这样的：

1.  获取旋转（通过加速度传感器）并将其保存在变量中
2.  拍照
3.  将图片旋转保存的数量
4.  存储图片

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-22T22:08:43.850

您可以通过`byte[]`用 a包装`ByteArrayInputStream`并将其传递给诸如我的[metadata-extractor](https://github.com/drewnoakes/metadata-extractor)之类的库来完成此操作。

# php - 客户邮箱为必填项

> ID：12096079
> 
> 赞同：4
> 
> 时间：2012-08-23T16:21:23.950
> 
> 标签：php, magento, magento-1.7

我浏览了许多论坛，但找不到解决我遇到的错误的方法。

当用户结帐并在结帐时选择注册时，他们将结束该过程并弹出错误消息“需要客户电子邮件”。

这是例外：

```
2012-08-23T14:35:06+00:00 ERR (3): 
exception 'Mage_Customer_Exception' with message 'Customer email is required' in /home/psc/public_html/app/Mage.php:579
Stack trace:
#0 /home/psc/public_html/app/code/core/Mage/Customer/Model/Resource/Customer.php(76): Mage::exception('Mage_Customer', 'Customer email ...')
#1 /home/psc/public_html/app/code/core/Mage/Eav/Model/Entity/Abstract.php(1122): Mage_Customer_Model_Resource_Customer->_beforeSave(Object(Mage_Customer_Model_Customer))
#2 /home/psc/public_html/app/code/core/Mage/Core/Model/Abstract.php(318): Mage_Eav_Model_Entity_Abstract->save(Object(Mage_Customer_Model_Customer))
#3 /home/psc/public_html/app/code/core/Mage/Core/Model/Resource/Transaction.php(151): Mage_Core_Model_Abstract->save()
#4 /home/psc/public_html/app/code/core/Mage/Sales/Model/Service/Quote.php(189): Mage_Core_Model_Resource_Transaction->save()
#5 /home/psc/public_html/app/code/core/Mage/Sales/Model/Service/Quote.php(249): Mage_Sales_Model_Service_Quote->submitOrder()
#6 /home/psc/public_html/app/code/core/Mage/Checkout/Model/Type/Onepage.php(774): Mage_Sales_Model_Service_Quote->submitAll()
#7 /home/psc/public_html/app/code/core/Mage/Checkout/controllers/OnepageController.php(511): Mage_Checkout_Model_Type_Onepage->saveOrder()
#8 /home/psc/public_html/app/code/core/Mage/Core/Controller/Varien/Action.php(419): Mage_Checkout_OnepageController->saveOrderAction()
#9 /home/psc/public_html/app/code/core/Mage/Core/Controller/Varien/Router/Standard.php(250): Mage_Core_Controller_Varien_Action->dispatch('saveOrder')
#10 /home/psc/public_html/app/code/core/Mage/Core/Controller/Varien/Front.php(176): Mage_Core_Controller_Varien_Router_Standard->match(Object(Mage_Core_Controller_Request_Http))
#11 /home/psc/public_html/app/code/core/Mage/Core/Model/App.php(354): Mage_Core_Controller_Varien_Front->dispatch()
#12 /home/psc/public_html/app/Mage.php(683): Mage_Core_Model_App->run(Array)
#13 /home/psc/public_html/index.php(90): Mage::run('', 'store')
#14 {main} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T14:32:21.970

事实证明，安装的运输扩展需要更新。更新后一切正常。

谢谢，

*   丹

# java - 如何生成从旧数据库迁移到新数据库的 SQL 脚本？

> ID：12096083
> 
> 赞同：1
> 
> 时间：2012-08-23T16:21:40.680
> 
> 标签：java, sql, oracle, oracle11g

我们正在为使用 java 和 oracle 11g 的客户开发基于 Web 的解决方案。该项目是为客户安装的，但其大部分功能正在开发中。每个月，我们都会发布一个新版本，应该在客户现场安装。问题是在每个版本中，数据库中都有很多变化（表、视图、SP、触发器等）。我无法从开发线上获取转储并将其带到客户站点。

问题是如何生成可以将客户数据库架构迁移到其新版本（开发版本）的 SQL 脚本？是否有用于生成此脚本的自动化工具？java中是否有任何开源代码可以做到这一点？这个问题的任何最佳实践？

**编辑**

根据答案，似乎最好的做法是禁止开发人员直接更改数据库方案，他们应该为每个数据库更新编写并提交一个更改脚本。但是使用这种方法，一段时间后，会出现大量的更改脚本，每个脚本都在数据库中保存一个特定的更新。那么我该如何管理这些大量的脚本呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T20:12:41.953

简短的回答是，鉴于您所描述的事态，您需要做大量工作才能在先前版本和下一个版本之间提出一个点对点迁移脚本。

数据库差异工具确实存在，但在这篇博文中最能描述的概念中存在一个普遍的缺陷：

[http://blog.liquibase.org/2007/06/the-problem-with-database-diffs.html](http://blog.liquibase.org/2007/06/the-problem-with-database-diffs.html)

TL；DR：差异工具无法确定特定更改的上下文。例如，如果在您的开发过程中，您更正了列名中的拼写错误，您可能希望在现有数据库上使用 RENAME COLUMN 命令，以保留表中已保存的所有数据。数据库差异工具只能看到新模式中不存在的旧列，以及旧模式中不存在的新列。因此该工具会删除旧列并添加新列，但结果是，该列中原来的所有数据现在都消失了。

作为最佳实践，我建议您在进行时主动跟踪数据库更改。较新的 Web 框架（例如 Django 和 Ruby on Rails）支持开箱即用的迁移跟踪，但 Java 世界也存在 Liquibase（上面的链接）等开源解决方案。我们在我现在的公司使用 Liquibase，到目前为止，我们已经取得了巨大的成功，最大限度地降低了这些迁移成本。在经历了您现在面临的这种迁移之后，我们做出了转换。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T20:23:28.403

数据库更改只能通过您放入源代码控制的脚本进行。如果你这样做了，那么你就不会遇到很多问题，知道将什么转移到 Qa 然后再进行刺激。另外，该脚本已经过测试，这与在最后创建脚本并在产品上首次运行它不同。此外，如果某些更改是针对不同项目的，则在它们未准备好时不会意外将它们放在 prod 上，因为它们将位于源代码控制的不同分支中。SQL 代码就是代码，就源代码控制而言，它应该与所有其他代码一样对待。

# c# - 使用 RegEx 解析 aspx 文件中的控件

> ID：12096084
> 
> 赞同：1
> 
> 时间：2012-08-23T16:21:47.727
> 
> 标签：c#, xml, regex

给定一个 aspx 文件，我想解析它的控件。我看到了关于相同主题的其他帖子，但它并不真正符合我的需求。

例子：

```
<Ctl:Label id="MyLabel" runat="server" Font-Bold="True">Text of My label</Ctl:Label> 
```

我想检索这些信息（形式无关紧要，只要信息是分开的）：

```
Tag = "Ctl"
Type = "Label"
id = "MyLabel"
runat = "server"
Font-Bold = "True"
Content = "Text of My label" 
```

[这篇文章](https://stackoverflow.com/questions/2972167/parse-controls-in-an-aspx-file-and-convert-it-to-xml)接近我想要的，但它不允许我检索例如“我的标签文本”。

注意：我不需要将这些信息放在 xml 文件中，但为什么不呢。

任何的想法？谢谢。

**编辑：**我需要使用用 C# 编写的桌面程序解析很多 aspx 页面，而不是使用 asp.net。

**编辑2：为什么？**因为我有很多 asp.net 页面，其中包含我维护的服务器控件。我需要检索有关在哪些页面中可以找到这些控件的信息，以及有关它们的大多数信息（名称、ID、它们最终拥有的内部控件等，仅此而已），但只关注主要问题，然后我会处理剩下的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:06:05.357

听起来您正在尝试实现自动化；对我来说，这建议寻找最可靠的解决方案，否则自动化并不值得，因为您将不得不假设它的任何部分都可能失败。

我可以想到几种方法来解决这个问题：

**1 -**
正则表达式 只要您不试图将整个事情变成结构完美的结果，正则表达式就可以正常工作。虽然典型的 ASCX 比纯 HTML 更结构化（否则它不会运行），但它仍然有可能出现格式错误。因此，它遭受了常见的 HTML 解析缺陷。

**2 - 解析器**
一个简单的状态机解析器可以帮助您识别特定的控件并解决正则表达式无法处理的场景。这可以像您想要的那样简单或复杂。高级解析器可以构建整个层次结构；一个简单的解析器可能只检索所有控件，可能还有内联代码块 (<%= %>) 和数据绑定信息。

**3 - 使用已编译的程序集**
您可能知道，ASP.Net 应用程序从标记转换为 c# 类，然后再转换为程序集。这些程序集在`%System%\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files`目录中可用。虽然它们的名字并不好（因为它们不适合直接使用），但它们*确实*包含了 .Net 如何查看页面/控件的极其准确的表示。您可以使用反射来访问这些数据。

其中一个文件的内容包含以下数据，例如 a 的声明`ValidationSummary`：

```
[System.Diagnostics.DebuggerNonUserCodeAttribute()]
private global::System.Web.UI.WebControls.ValidationSummary @__BuildControlvs() {
    global::System.Web.UI.WebControls.ValidationSummary @__ctrl;

    #line 6 "C:\Development\VS 2010\..."
    @__ctrl = new global::System.Web.UI.WebControls.ValidationSummary();

    #line default
    #line hidden
    this.vs = @__ctrl;
    @__ctrl.TemplateControl = this;
    @__ctrl.ApplyStyleSheetSkin(this.Page);

    #line 6 "C:\Development\VS 2010\..."
    @__ctrl.ID = "vs";

    #line default
    #line hidden

    #line 6 "C:\Development\VS 2010\..."
    @__ctrl.ValidationGroup = "Group1";

    return @__ctrl;
} 
```

如您所见，这些类包含页面或控件的完整数据。它们还包含原始代码的行号和文件名（可能对您有用）。

## 概括

选项 #1 对于简单场景来说是最快的。选项 #3 非常强大，但与应用程序的物理基础架构紧密耦合，并且与自动生成代码的结构方式有些耦合。选项 #2 将需要最多的工作。

最后，可能有一种方法可以以编程方式访问 markup-to-c# 转换器并自己编译程序集（就像第一次访问应用程序时所做的那样 - 类似于选项 #3）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:11:26.610

您可以使用[HTML Agility Pack](http://htmlagilitypack.codeplex.com/)解析文件，然后按元素名称定位控件。

# java - Java接口可以有构造函数吗？

> ID：12096087
> 
> 赞同：0
> 
> 时间：2012-08-23T16:22:00.573
> 
> 标签：java, interface

ActionListener 是一个接口，但为什么我可以创建实例对象？

```
 JButton button = new JButton("Button1");

   ActionListener me = new ActionListener(){
        public void actionPerformed(ActionEvent ae){
            JOptionPane.showMessageDialog(null,ae.getActionCommand());  
        }
    };
    button.addActionListener(me); 
```

或者还有什么？我不知道。请帮我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T16:23:23.723

您在这里看到的称为匿名类：`me`将分配一个实现`ActionListener`接口的匿名（未命名）类的实例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T16:23:55.697

与 C# 不同，Java 的接口不能规定构造函数。

您在代码中所做的是创建一个扩展的匿名类`java.lang.Object`（它确实有一个默认构造函数）并实现接口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T16:27:11.657

What you have instantiated is an [Anonymous Inner Class](http://docs.oracle.com/javase/tutorial/java/javaOO/anonymousclasses.html). In short, it's an in-line way to both define a class that has no name and instantiate an instance of that class in one statement. You'll only ever be able to refer to anonymous inner classes by the super class they implement or extend. In the case of this question, the super class is the ActionListener interface.

When you compile your code, there will be an extra .class file that exists with a name like this: `OuterClass$1.class`. That is the class file that represents the anonymous inner class you've defined.

If you want to learn more, check out this section in the JLS [http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.9.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.9.5)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T16:23:49.620

因为您正在使用匿名类实现接口

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T16:24:14.800

`ActionListener`确实，它本身就是一个接口。

但是，代码中的构造是匿名内部类，这意味着您的接口是由该内部类实现的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-23T16:24:15.393

实际上，您正在创建的是`Object.class`实现接口的匿名子类。因此，您是从 Object 而非接口“继承”构造函数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-23T16:24:37.203

您没有创建`ActionListener`. 您正在创建一个实现的匿名类，`ActionListener`并且您正在提供该实现。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-23T16:27:25.143

ActionListener is in fact an interface which can not be instantiated.

However, by defining public void actionPerformed() locally you are allowing the interface to act like a class.

This is legal:

```
 ActionListener me = new ActionListener(){
      public void actionPerformed(...){...};
 }; 
```

This is not:

```
ActionListener me = new ActionListener(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-23T17:08:41.687

**1.**你**不能**`constructor`在`Interface`java中拥有。

**2.**这里看到的是一个`Anonymous Class`，它**同时声明和初始化**，它必须**分别扩展或实现一个类或接口**。

# objective-c - MapKit：在滚动地图之前不会显示注释视图

> ID：12096091
> 
> 赞同：1
> 
> 时间：2012-08-23T16:22:15.907
> 
> 标签：objective-c, ios, mapkit

我希望一旦单击“咖啡馆”之类的工具栏按钮，咖啡馆将显示在可见的地图区域中。数据是从 Google Places API 获取的。一切正常，除了单击按钮后不显示引脚。

这里肯定会出现延迟。然而，我在后台队列中进行提取并在等待时放置一个纺车，当抓取和解析完成时纺车会隐藏起来。所以我很确定在纺车消失的那一刻数据就在那里。但是在我滚动地图之前，这些图钉不会出现。

我认为滚动地图只会触发`mapView:regionDidChangeAnimated:`。但我无法弄清楚它与问题的关系。任何人都可以帮忙吗？

的源代码`ViewController.m`，几乎所有事情都发生在这里。

```
#import "ViewController.h"
#import "MapPoint.h"
#import "MBProgressHUD.h"

#define kGOOGLE_API_KEY @"AIzaSyCHqbAoY7WCL3l7x188ZM4ciiTixejzQ4Y"
#define kBgQueue dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0)

@interface ViewController () <CLLocationManagerDelegate, MKMapViewDelegate>
@property (weak, nonatomic) IBOutlet MKMapView *mapView;
@property (strong, nonatomic) CLLocationManager *locationManager;
@property int currentDist;
@property CLLocationCoordinate2D currentCentre;
@end

@implementation ViewController
@synthesize mapView = _mapView;
@synthesize locationManager = _locationManager;
@synthesize currentDist = _currentDist;
@synthesize currentCentre = _currentCentre;

- (void)viewDidLoad{
    [super viewDidLoad];
}

- (void)viewDidUnload{
    [self setMapView:nil];
    [super viewDidUnload];
}

// set the map region after launching
-(void)viewWillAppear:(BOOL)animated
{
    //Instantiate a location object.
    self.locationManager = [[CLLocationManager alloc] init];

    //Make this controller the delegate for the location manager.
    self.locationManager.delegate = self;

    //Set some parameters for the location object.
    [self.locationManager setDistanceFilter:kCLDistanceFilterNone];
    [self.locationManager setDesiredAccuracy:kCLLocationAccuracyBest];

    // order: latitude(纬度), longitude（经度）
    CLLocationCoordinate2D center = self.locationManager.location.coordinate;

    // 单位是degree
    MKCoordinateSpan span = MKCoordinateSpanMake(0.03, 0.03);

    MKCoordinateRegion region = MKCoordinateRegionMake(center, span);

    [self.mapView setRegion:region animated:YES];

    // NSLog(@"currentCentre is (%f , %f)", self.currentCentre.latitude, self.currentCentre.longitude);
}

// Get place tpye from button title
// All buttons share this one method
- (IBAction)toolbarButtonPressed:(id)sender
{
    UIBarButtonItem *button = (UIBarButtonItem *)sender;
    NSString *buttonTitle = [button.title lowercaseString];

    //Use this title text to build the URL query and get the data from Google.
    [self queryGooglePlaces:buttonTitle];

}

// Parse response JSON data
-(void)parseData:(NSData *)responseData {

    NSError* error;
    NSDictionary* json = [NSJSONSerialization JSONObjectWithData:responseData
                                                         options:kNilOptions
                                                        error:&error];

    //The results from Google will be an array obtained from the NSDictionary object with the key "results".
    NSArray* places = [json objectForKey:@"results"];
    [self plotPositions:places];
    NSLog(@"Plot is done");
}

// Format query string
-(void) queryGooglePlaces: (NSString *) googleType {

    // query string
    NSString *url = [NSString stringWithFormat:@"https://maps.googleapis.com/maps/api/place/search/json?location=%f,%f&radius=%@&types=%@&sensor=true&key=%@", self.currentCentre.latitude, self.currentCentre.longitude, [NSString stringWithFormat:@"%i", _currentDist], googleType, kGOOGLE_API_KEY];

    //string to URL 
    NSURL *googleRequestURL=[NSURL URLWithString:url];

    // Retrieve data from the query URL by GCD
    dispatch_async(kBgQueue, ^{
        NSData* data = [NSData dataWithContentsOfURL: googleRequestURL];
        [self parseData:data];
        [MBProgressHUD hideHUDForView:self.view animated:YES];
    });

    MBProgressHUD *hud = [MBProgressHUD showHUDAddedTo:self.view animated:YES];
    hud.labelText = @"Please Wait..";
}

#pragma mark - Map View Delegate

// called many times when map scrolling or zooming
// Use this to get currentCentre and currentDist (radius)

-(void)mapView:(MKMapView *)mapView regionDidChangeAnimated:(BOOL)animated {
    //Get the east and west points on the map so you can calculate the distance (zoom level) of the current map view.
    MKMapRect mRect = self.mapView.visibleMapRect;
    MKMapPoint eastMapPoint = MKMapPointMake(MKMapRectGetMinX(mRect), MKMapRectGetMidY(mRect));
    MKMapPoint westMapPoint = MKMapPointMake(MKMapRectGetMaxX(mRect), MKMapRectGetMidY(mRect));

    //Set your current distance instance variable.
    self.currentDist = MKMetersBetweenMapPoints(eastMapPoint, westMapPoint);

    //Set your current center point on the map instance variable.
    self.currentCentre = self.mapView.centerCoordinate;

   // NSLog(@"currentCentre is (%f , %f)", self.currentCentre.latitude, self.currentCentre.longitude);

}

// Setup annotation objects
-(void)plotPositions:(NSArray *)data {
    // 1 - Remove any existing custom annotations but not the user location blue dot.

    for (id<MKAnnotation> annotation in self.mapView.annotations) {
        if ([annotation isKindOfClass:[MapPoint class]]) {
            [self.mapView removeAnnotation:annotation];
        }
    }
    // 2 - Loop through the array of places returned from the Google API.
    for (int i=0; i<[data count]; i++) {
        //Retrieve the NSDictionary object in each index of the array.
        NSDictionary* place = [data objectAtIndex:i];
        // 3 - There is a specific NSDictionary object that gives us the location info.
        NSDictionary *geo = [place objectForKey:@"geometry"];
        // Get the lat and long for the location.
        NSDictionary *loc = [geo objectForKey:@"location"];
        // 4 - Get your name and address info for adding to a pin.
        NSString *name=[place objectForKey:@"name"];
        NSString *vicinity=[place objectForKey:@"vicinity"];
        // Create a special variable to hold this coordinate info.
        CLLocationCoordinate2D placeCoord;
        // Set the lat and long.
        placeCoord.latitude=[[loc objectForKey:@"lat"] doubleValue];
        placeCoord.longitude=[[loc objectForKey:@"lng"] doubleValue];

        // 5 - Create a new annotation.
        MapPoint *placeObject = [[MapPoint alloc] initWithName:name address:vicinity coordinate:placeCoord];
        [self.mapView addAnnotation:placeObject];
    }
    NSLog(@"addAnnotation is done");

}

// Setup annotation view
-(MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation {
    // Define your reuse identifier.
    static NSString *identifier = @"MapPoint";

    if ([annotation isKindOfClass:[MapPoint class]]) {
        MKPinAnnotationView *annotationView = (MKPinAnnotationView *) [self.mapView dequeueReusableAnnotationViewWithIdentifier:identifier];

        if (annotationView == nil) {
            annotationView = [[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:identifier];
        } else {
            annotationView.annotation = annotation;
        }
        annotationView.enabled = YES;
        annotationView.canShowCallout = YES;
        annotationView.animatesDrop = YES;

        // NSLog(@"annotation view is added");

        return annotationView;

    }
    return nil;
}

@end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T16:38:47.387

有几件事：

移动您的 removeAnnotation 和 addAnnotation 代码以在 UI 线程上运行，例如：

```
dispatch_async (dispatch_get_main_queye(), ^
{
 [self.mapView addAnnotation:placeObject]; 
}); 
```

将您的 viewWillAppear 初始化代码移动到 viewDidLoad。viewWillAppear 可能在视图控制器的生命周期内被多次调用

# javascript - jPaginate - 帮助确定点击了哪个页面？

> ID：12096093
> 
> 赞同：1
> 
> 时间：2012-08-23T16:22:19.210
> 
> 标签：javascript, jquery

我正在使用 jQuery 的 jPaginate 插件对我的一个网站上的数据进行排序。我遇到的问题是确定哪个页面点击了 jPaginate。我在下面发布了我的代码。

此代码在 Document Ready 上加载插件。

```
$("#demo2").paginate({
                        count         : a,
                        start         : 1,
                        display     : 10,
                        border                    : false,
                        text_color              : '#888',
                        background_color        : '#EEE',    
                        text_hover_color          : 'black',
                        cookies : true,
                        onChange                : function(){alert(); console.log($(this))},
                        background_hover_color    : '#CFCFCF'
                }); 
```

见截图：[http ://screencast.com/t/SbxHjn7H](http://screencast.com/t/SbxHjn7H)

问题是我需要知道每当用户点击数字 1-5 时点击了哪个页面。任何帮助或对此的进一步理解将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T18:59:29.730

我实际上能够自己解决这个问题..

您需要通过编写一个函数来触发 jPaginate 插件中的“onChange”事件来获取当前页面。

```
$("#demo2").paginate({
                  count         : a,
                  start         : '<?=intval($page + 1);?>',
                  display     : 10,
                  border                    : false,
                  text_color              : '#888',
                  background_color        : '#EEE',    
                  text_hover_color          : 'black',
                  cookies : true,
                  onChange                : function(){

                            var getPage = $('.jPag-current').html();
                            var minusPage = getPage - 1;

                        },
                        background_hover_color    : '#CFCFCF'
                }); 
```

# wordpress - wordpress 永久链接重定向 https

> ID：12096096
> 
> 赞同：0
> 
> 时间：2012-08-23T16:22:24.880
> 
> 标签：wordpress, redirect, https, permalinks

我正在为我的网站使用 WordPress 永久链接。我正在为 SSL 设置 .htaccess 重定向。现在它只适用于主页。但不是其他人。我知道这是我为所有其他页面使用永久链接的问题

我想知道我是否可以简单地为永久链接设置 SSL 重定向？我已尝试将 .htaccess 重定向到特定页面，但它仍然无法正常工作。

任何帮助将不胜感激。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T11:15:25.760

检查您的 apache 配置并验证您存储 Wordpress 安装的目录是否启用了以下设置（可能您将为特定目录提供更多配置选项，但这些是 Wordpress 精美永久链接所需的最低要求）：

```
<Directory var/www/>
FollowSymLinks
AllowOverride All
</Directory> 
```

谢谢

# mysql - 将双重嵌套查询转换为 JOIN 语句，以及其他优化

> ID：12096098
> 
> 赞同：7
> 
> 时间：2012-08-23T16:22:32.890
> 
> 标签：mysql, sql, join, nested-queries

我得到了这个非常具体的查询，并准确地返回了我需要的内容。众所周知，mysql 中的嵌套查询在运行时可能非常糟糕。如果有人可以帮助我将以下代码转换为`JOIN`语句，我将不胜感激。

当然，欢迎和鼓励任何其他优化。

```
SELECT title 
FROM   exp_channel_titles 
WHERE  entry_id IN (SELECT rel_child_id 
                    FROM   exp_relationships 
                    WHERE  rel_id IN (SELECT field_id_202 
                                      FROM   exp_channel_data 
                                      WHERE  entry_id = 19971)); 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:25:51.383

```
SELECT DISTINCT
  titles.title
FROM
  exp_channel_titles  AS titles
INNER JOIN
  exp_relationships   AS rel
    ON titles.entry_id = rel.rel_child_id
INNER JOIN
  exp_channel_data    AS channel
    ON rel.rel_id = channel.field_id_202
WHERE
  channel.entry_id = 19971 
```

DISTINCT 存在，以防您有很多：很多关系等，否则可能会产生重复。

在优化方面，确保每个表都有您在 JOIN 和 WHERE 子句中使用的字段的索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T16:43:55.023

另一种选择：

```
SELECT t.title 
  FROM exp_channel_titles t
  JOIN ( SELECT r.rel_child_id 
           FROM exp_relationships r
           JOIN exp_channel_data d
             ON d.field_id_202 = r.rel_id
          WHERE d.entry_id = 19971
          GROUP BY r.rel_child_id 
       ) c
    ON c.rel_child_id = t.entry_id 
```

此查询仍然包含一个内联视图（或 MySQL 术语中的“派生表”），但此查询将返回与原始查询等效的结果集，而不会在 exp_channel_titles 表中引入或消除任何“重复”标题。

请注意，由于 JOIN 处理一对多关系的方式的性质，其他解决方案可能会引入重复。您可以避免返回使用 DISTINCT 关键字或 GROUP BY 子句引入的任何重复项，但这也将消除原始查询中返回的任何重复项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T16:28:05.633

```
select t.title
  from exp_channel_titles as t
  inner join exp_relationships as r
    on r.rel_child_id = t.entry_id
  inner join exp_channel_data as d
    on d.field_id_202 = r.rel_id
    and d.entry_id = 19971; 
```

# sql - 表字段已更新

> ID：12096102
> 
> 赞同：1
> 
> 时间：2012-08-23T16:22:53.203
> 
> 标签：sql, oracle

当表中的一个字段被更新，而另一个字段依赖于该字段的数据时会发生什么？

我有名字，中间名，姓氏，全名字段。为“最后、第一、中间”数据插入一次 Full_name 列。

如果我删除中间名，如何更新 full_name 字段以从那里删除中间名？

谢谢。欢迎推荐书籍。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:42:41.903

表中的一列依赖于其他列中的数据，这违反了基本规范化。可以使用触发器来尝试保持数据同步，但这通常相当麻烦。你通常会得到更好的服务

1.  `full_name`从表中完全删除列。创建一个计算 的函数，`full_name`并在您想要生成全名时从应用程序调用该函数，或者将函数调用添加到应用程序用于查询数据的视图中。如果您需要按全名搜索，您可以在此函数的结果上创建基于函数的索引。
2.  如果您使用的是 Oracle 11.1 或更高版本，您可以在表中定义一个[虚拟列](http://www.oracle-base.com/articles/11g/virtual-columns-11gr1.php)来计算`full_name`.

虚拟列方法看起来像

```
SQL> ed
Wrote file afiedt.buf

  1  create table foo (
  2    first_name varchar2(100),
  3    last_name  varchar2(100),
  4    middle_name varchar2(100),
  5    full_name   varchar2(304) generated always as (last_name || ', ' ||
  6                                                     first_name ||
  7                                                    (case when middle_name is not null
  8                                                          then ', ' || middle_name
  9                                                          else null
 10*                                                     end)) virtual )
SQL> /

Table created.

SQL> insert into foo(first_name, last_name, middle_name)
  2    values( 'Justin', 'Cave', 'O.J.' );

1 row created.

SQL> select full_name from foo;

FULL_NAME
--------------------------------------------------------------------------------
Cave, Justin, O.J. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T16:29:21.627

在 11.1 版本之前，Oracle 不支持计算列，但您可以使用 an[`AFTER UPDATE TRIGGER`](http://www.techonthenet.com/oracle/triggers/after_update.php)来代替：

```
CREATE OR REPLACE TRIGGER PERSON_MIDDLE_NAME_COMPUTE
AFTER UPDATE ON PERSON
FOR EACH ROW
BEGIN

SELECT (:NEW.LAST || ',' || :NEW.FIRST || NVL2(:NEW.MIDDLE, ',' || :NEW.MIDDLE, ''))
        INTO :NEW.FULL_NAME
FROM DUAL;

END; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T16:28:15.500

您在这里要做的是创建[一个触发器](http://docs.oracle.com/cd/B19306_01/appdev.102/b14251/adfns_triggers.htm)。
触发器的工作方式是：

您的数据库会注意到某些事情发生了变化，并会在这种情况下执行您的要求。

# ruby-on-rails-3.2 - 多态关联，has_one 和 HasManyThroughAssociationPolymorphicThroughError

> ID：12096104
> 
> 赞同：2
> 
> 时间：2012-08-23T16:22:57.077
> 
> 标签：ruby-on-rails-3.2, polymorphic-associations

我正在研究多态关联问题，但我不太确定该去哪里。

这是我当前的模型设置：

```
class Rfq < ActiveRecord::Base
    attr_accessible :name, :parts_attributes
    has_many :parts
    accepts_nested_attributes_for :parts
end

class Part < ActiveRecord::Base
    attr_accessible :name, :mailer_parts
    belongs_to :rfq
    belongs_to :partable, :polymorphic => true
    has_one :mailer, :through => :partable
    accepts_nested_attributes_for :mailer
end

class Mailer < ActiveRecord::Base
    attr_accessible :address
    has_one :part, :as => :partable  # Should/could this be belongs_to?
end 
```

当我在浏览器中转到 Rfq 的编辑页面时，我看到此错误：

```
ActiveRecord::HasManyThroughAssociationPolymorphicThroughError in Rfqs#edit
Cannot have a has_many :through association 'Part#mailer' which goes through the polymorphic association 'Part#partable'.
Extracted source (around line #5):

2:   <%= f.label :name, "Name" %>
3:   <%= f.text_field :name %><br>
4:   <p>Part Information: </p>
5:   <%= f.fields_for :mailer do |builder| %>
6:     <%= render 'mailer_fields', :f => builder %>
7:   <% end %>
8:   <%= link_to 'Add Mailer Part', '#', :class => "add_mailer_part" %> 
```

我不确定问题出在哪里，因为我不想在任何地方建立 has_many 关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T15:25:52.403

问题在于零件模型。你有你的`has_one`关联通过一个多态的`belongs_to`.

我还没有给你答案，但是……但这回答了你的问题。我认为这只是一个标签不佳的常量，或者他们为像我们这样试图做他们不想/不想要的事情的人重复使用的常量。

从表面上看，我认为这是因为 DB 没有`partable`列，但是`partable_id`和`partable_type`.

# c# - LINQ 查询 SelectMany() 返回 Null 值

> ID：12096108
> 
> 赞同：2
> 
> 时间：2012-08-23T16:23:04.910
> 
> 标签：c#

我有这些课。为了简单起见，我省略了与问题无关的成员。我想找到包含具有给定字符串值的 WWPN 成员的所有区域。下面的 LINQ 有效，但结果也包含不匹配区域的 null。我的其他尝试要么给了我区域成员本身，要么给了我一个布尔值。有没有办法在不获取空值的情况下做到这一点？我不需要使用 ContainsMemberWWPN() 类成员。

```
 public class Zone
     {  ....
      public List<ZoneMember> MembersList = new List<ZoneMember>();
     }

  public class ZoneMember
   {
    private string _WWPN = string.Empty;
    public string MemberWWPN {get{return _WWPN;} set{_WWPN = value; } }
    private bool _IsLoggedIn;
    public bool IsLoggedIn { get { return _IsLoggedIn; } set { _IsLoggedIn = value; } }

    }

 public class CiscoVSAN
    {
      ....
    public List<Zone> ActiveZoneset = new List<Zone>(); 
            ....
    }

public Zone ContainsMemberWWPN(string wwpn)
    { 
      var contained = 
          this.MembersList.FirstOrDefault(m => m.MemberWWPN.Contains(wwpn));

      if (contained != null) { return this }
      else { return null; }

    }

//find all the zones that contain the input string
// this returns the zones that match
// but selection3 also has null values for zones that don't match
var selection3 = VSANDictionary.SelectMany(vsan => vsan.Value.ActiveZoneset.ZoneList).Select(z => z.ContainsMemberWWPN(zonemember)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:28:49.113

过滤掉空项：

```
var selection3 = VSANDictionary
                 .SelectMany(vsan => vsan.Value.ActiveZoneset.ZoneList)
                 .Select(z => z.ContainsMemberWWPN(zonemember))
                 .Where(m=> m != null) 
```

# c# - 调用字符串 GenericMethod () 不指定 T

> ID：12096113
> 
> 赞同：3
> 
> 时间：2012-08-23T16:23:15.830
> 
> 标签：c#, generics, delegates

我有一个带有签名的方法

```
string GenericMethod<T>(); 
```

通常你会简单地调用它：

```
var result = GenericMethod<AType>(); 
```

但是，这不适用于我的情况，因为`AType`它作为`Type`.

下面的代码显示了我要去的地方。目前它错误为 //ERROR HERE。

在代码之前，快速解释一下：`TestClass`同时实现`ITestClass`和`INotTestClass`。这很重要，因为这里的重点是，如果我通过 a `TestClass`，我想用 调用该方法`ITestClass`，而不是`INotTestClass`。 `TestClass`有一个方法，它只是在其泛型括号中返回类型的名称。

好的，这是单元测试形式的代码。

```
using System;
using NUnit.Framework;

namespace Ian.Tests
{   
    [TestFixture]
    public class MiscTests
    {
        [Test]
        public void WhoWeCallingTest()
        {
            var i = new TestClass();
            i.TestGetTheType();
        }
    }

    public class TestClass : ITestClass, INotTestClass
    {
        public void TestGetTheType()
        {
            var t1 = typeof(ITestClass);
            var t2 = typeof(INotTestClass); 

            var t = GetType();

            // so I can make a delegate normally, but no use as I don't have this info usually.
            var dummyFunc = new MyDelegate<ITestClass>(GetTheType<ITestClass>);

            var methodInfo = t.GetMethod("GetTheType");
            var baseType = typeof(MyDelegate<>);
            var delType = baseType.MakeGenericType(t1);
            //ERROR HERE.
            var del = Delegate.CreateDelegate(delType, this, methodInfo);
            del.Method.Invoke(this, null);

        }

        public delegate string MyDelegate<T>();

        public string GetTheType<T>()
        {
            return typeof(T).Name;
        }
    }

    public interface ITestClass { }

    public interface INotTestClass { }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:28:15.173

您需要使用[MethodInfo.MakeGenericMethod](http://msdn.microsoft.com/en-us/library/system.reflection.methodinfo.makegenericmethod%28v=vs.100%29.aspx)来构造适当的方法：

```
var methodInfo = t.GetMethod("GetTheType");
var methodWithType = methodInfo.MakeGenericMethod(t1);
methodWithType.Invoke(this, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:53:17.813

我必须承认我不完全理解您的要求，但在这种特殊情况下，简单的检查还不够吗？

```
if(this is ITestClass)
    return this.GetTheType<ITestClass>();
else if(this is INotTestClass)
    return this.GetTheType<INotTestClass>();
else 
    throw new InvalidOperationException // or whatever
                ("unexpected type: " + this.GetType()); 
```

# android - Ant Android 失败：getType 标记

> ID：12096114
> 
> 赞同：0
> 
> 时间：2012-08-23T16:23:16.363
> 
> 标签：android, ant, build.xml

我正在使用 ant（在 Hudson 上）构建我的 Android 项目。我在 Android build.xml 文件第 388 行遇到错误：

```
<echo level="info">Project Name: ${ant.project.name}</echo>
<gettype projectTypeOut="project.type" /> 
```

这是以前运行的，但是一些更新破坏了它，我似乎无法弄清楚如何。AndroidManifest 已更新并添加了一个新包（实际上是在错误的位置）。

我从这个正确的输出出发：

```
[echo] Project Name: <Application Name>
[gettype] Project Type: Application 
```

对于这个错误

```
<filepath>/workspace/android_build_files/android-sdk-linux/tools/ant/build.xml:388: org.xml.sax.SAXParseException: The content of elements must consist of well-formed character data or markup.
at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:239)
at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:283)
at com.sun.org.apache.xpath.internal.jaxp.XPathImpl.evaluate(XPathImpl.java:468)
at com.sun.org.apache.xpath.internal.jaxp.XPathImpl.evaluate(XPathImpl.java:515)
at com.android.ant.GetTypeTask.execute(GetTypeTask.java:85)
at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
at org.apache.tools.ant.Task.perform(Task.java:348)
at org.apache.tools.ant.Target.execute(Target.java:392)
at org.apache.tools.ant.Target.performTasks(Target.java:413)
at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
at org.apache.tools.ant.Project.executeTarget(Project.java:1368)
at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
at org.apache.tools.ant.Main.runBuild(Main.java:811)
at org.apache.tools.ant.Main.startAnt(Main.java:217)
at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)
at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)
--------------- linked to ------------------
javax.xml.xpath.XPathExpressionException
at com.sun.org.apache.xpath.internal.jaxp.XPathImpl.evaluate(XPathImpl.java:473)
at com.sun.org.apache.xpath.internal.jaxp.XPathImpl.evaluate(XPathImpl.java:515)
at com.android.ant.GetTypeTask.execute(GetTypeTask.java:85)
at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
at org.apache.tools.ant.Task.perform(Task.java:348)
at org.apache.tools.ant.Target.execute(Target.java:392)
at org.apache.tools.ant.Target.performTasks(Target.java:413)
at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
at org.apache.tools.ant.Project.executeTarget(Project.java:1368)
at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
at org.apache.tools.ant.Main.runBuild(Main.java:811)
at org.apache.tools.ant.Main.startAnt(Main.java:217)
at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)
at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)
Caused by: org.xml.sax.SAXParseException: The content of elements must consist of well-formed character data or markup.
at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:239)
at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:283)
at com.sun.org.apache.xpath.internal.jaxp.XPathImpl.evaluate(XPathImpl.java:468)
... 18 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-26T15:23:36.827

更新`AndroidManifest.xml`中的错误导致它：`gettype`任务需要读取它，并且由于元素中的一些晦涩字符而失败（我猜是你最后更改的那个）。

# iphone - 点击 UITextField 时在 UIActionSheet 中显示 UIDatePicker

> ID：12096118
> 
> 赞同：8
> 
> 时间：2012-08-23T16:23:27.653
> 
> 标签：iphone, objective-c, ios, ios4

我正在创建警报应用程序。我想`UIDatePicker`在`UIActionSheet`点击时显示`UITextField`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T16:40:30.923

为此，您需要实施`UIActionShetDelegate`并`UITextFieldDelegate` 在其中`textFieldDidBeginEditing`显示操作表，例如：

```
-(void)textFieldDidBeginEditing:(UITextField *)sender
{
  [self showAction];
}
-(void) showAction
{
  UIActionSheet *asheet = [[UIActionSheet alloc] initWithTitle:@"Pick the date." delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:nil otherButtonTitles:@"Select", nil];
  [asheet showInView:[self.view superview]];
  [asheet setFrame:CGRectMake(0, 117, 320, 383)];
  [asheet release];
}

- (void)willPresentActionSheet:(UIActionSheet *)actionSheet
  {

    UIDatePicker *pickerView = [[UIDatePicker alloc] initWithFrame:CGRectMake(0, 40, 320, 216)];

   //Configure picker...
   [pickerView setMinuteInterval:5];
   [pickerView setTag: kDatePickerTag];

  //Add picker to action sheet
  [actionSheet addSubview:pickerView];

  [pickerView release];

  //Gets an array af all of the subviews of our actionSheet
  NSArray *subviews = [actionSheet subviews];

  [[subviews objectAtIndex:SelectButtonIndex] setFrame:CGRectMake(20, 266, 280, 46)];
  [[subviews objectAtIndex:CancelButtonIndex] setFrame:CGRectMake(20, 317, 280, 46)];

} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T16:41:50.157

我发现在使用带有选择器的文本字段时，最简单的方法是设置文本字段的输入视图并添加您自己的工具栏以方便使用。确保你有你的“UITextFieldDelegate”和选择器方法设置然后像这样连接它。

```
 yourtextfield.delegate = self;
 [yourtextfield setInputView:yourpickerview];
 [yourtextfield setInputAccessoryView:doneBar];

 doneBar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, 320, 44)];
 [doneBar setBarStyle:UIBarStyleBlackTranslucent];
 UIBarButtonItem *spacer2 = [[UIBarButtonItem alloc] 
                initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace
                target:nil
                action:nil];
 [doneBar setItems: [NSArray arrayWithObjects:spacer2, [[UIBarButtonItem alloc] 
                    initWithTitle:@"Done"
                    style:UIBarButtonItemStyleDone
                    target:yourtextfield 
                    action:@selector(resignFirstResponder)],nil ] animated:YES]; 
```

但是，如果您更喜欢使用操作表，那么这是基本设置：

[在操作表中添加 UIPickerView 和按钮 - 如何？](https://stackoverflow.com/questions/1262574/add-uipickerview-a-button-in-action-sheet-how)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T16:30:53.937

您可以设置`UIDatePicker`为`UITextField`输入视图 ( `@property inputView`)。ActionSheet 只能包含按钮。

# java - GAE 上的 JPA：find 不返回记录，但数据存储区的记录很少

> ID：12096121
> 
> 赞同：0
> 
> 时间：2012-08-23T16:23:47.227
> 
> 标签：java, google-app-engine, google-cloud-datastore

我有一对多拥有的关系。这是我的父类：

```
@XmlRootElement
@Entity
public class Strip {

@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
private Key key;

private long id;
private String filename = "";

@OneToMany(mappedBy = "strip", cascade = CascadeType.ALL)
private List<Quote> quotes = new ArrayList<Quote>();

public long getId() {
    return key.getId(); 
}

public void setId(long id) {
    this.id = id;
}

public String getFilename() {
    return filename;
}
public void setFilename(String filename) {
    this.filename = filename;
}

public List<Quote> getQuotes() {
    return quotes;
}

public void setQuotes(List<Quote> quotes) {
    this.quotes = quotes;
}

public Key getKey() {
    return key;
}
} 
```

和子班：

```
@XmlRootElement
@Entity
public class Quote {

@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
private Key key;

private long id;

private String quote = "";

@ManyToOne
private Strip strip;

public long getId() {
    return key.getId();
}

public void setId(long id) {
    this.id = id;
}

public String getQuote() {
    return quote;
}

public void setQuote(String quote) {
    this.quote = quote;
}

@XmlTransient
public Strip getStrip() {
    return strip;
}

public void setStrip(Strip strip) {
    this.strip = strip;
}

} 
```

还有一种在 Strip 中添加 Quote 的方法：

```
public JResponse<StripResult> putStripWithQuote(@PathParam("strip_id") long id,                                                     Quote quote) {
    StripResult result = new StripResult();
    EntityManager em = EMFService.get().createEntityManager();
    Strip strip = null;

    try {
        em.getTransaction().begin();

        strip = em.find(Strip.class, id);
        if (strip == null) {
            result.setCode("0");
            result.setMessage("Strip is not found.");
        } else {
            strip.getQuotes().add(quote);
        }

        em.getTransaction().commit();
    } catch (Exception e) {
        result.setCode("0");
        result.setMessage("Exception: " + e.getMessage());
    } finally {
        if (em.getTransaction().isActive()) {
            em.getTransaction().rollback();
        }
        em.close();
    }

    result.setStrip(strip);
    return JResponse.ok(result).build();
} 
```

执行此方法后，我可以在 Datastore Viewer 中看到我已经更新了现有的 Strip 实体和新的 Quote 实体。

即使我查询所有报价一切正常，我也能看到所有报价。

```
Query q = em.createQuery("select from " + Quote.class.getName());
list = new ArrayList<Quote>(q.getResultList()); 
```

m我的问题：`entityManager.find(Quote.class, "id of existing quote")`不返回任何东西。

我在这里做错了什么或错过了什么？持久性上下文有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-24T08:13:02.833

尝试这个

*   按键查询

`TypedQuery<Strip> query = em.createQuery("SELECT s FROM Strips WHERE s.key = ?1",Strip.class); strip = query.setParameter(1, key).getSingleResult();`

*   按ID查询

`TypedQuery<Strip> query = em.createQuery("SELECT s FROM Strips WHERE s.id=?1",Strip.class); strip = query.setParameter(1, id).getSingleResult();`

*   查询父条拥有的所有报价

`TypedQuery<Strip>query=em.createQuery("SELECT s FROM Strips WHERE s.Strip=1",Strip.class); List<Strip> strip = query.getResultList();`

*   查询数据库中的所有 QOUTES

`Query query = em.createQuery("SELECT s FROM Quote s, Quote.class"); List<Quote> ALLQuotes= query.getResultList();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:32:52.080

在您的`Quote`实体中，定义的主键`@Id`是`key`变量，而不是`id`变量。是您在您的

```
em.find(Quote.class,"key of existing quote"); 
```

?

# java - 带有 CONCAT 的 NamedQuery 返回错误

> ID：12096139
> 
> 赞同：4
> 
> 时间：2012-08-23T16:24:26.807
> 
> 标签：java, jpa, eclipselink, concatenation, named-query

我正在尝试执行如下选择查询：

```
SELECT *, CONCAT(TNUSERDATE, ' - ', TNUSERTIME) AS datetime 
  FROM TODONOTE WHERE TNTDKEY='TD00019148' ORDER BY datetime DESC; 
```

该查询有效；但是，当我尝试将其转移到命名查询中时：

```
@NamedQueries({
    @NamedQuery(name = "Todonote.findAll", query = "SELECT c FROM Todonote c"),
    @NamedQuery(name = "Todonote.findByTaskNumber", query = "SELECT c, CONCAT(c.userDate, ' - ', c.userTime) AS datetime FROM Todonote c WHERE c.todoTask = :taskNumber ORDER BY datetime DESC")
}) 
```

我收到一个错误

```
[EL Severe]: 2012-08-23 12:15:39.111--ServerSession(841933)--Local Exception Stack: 
Exception [EclipseLink-6168] (Eclipse Persistence Services - 2.3.0.v20110604-r9504): org.eclipse.persistence.exceptions.QueryException
Exception Description: Query failed to prepare, unexpected error occurred: [java.lang.ClassCastException: org.eclipse.persistence.internal.jpa.parsing.ConcatNode cannot be cast to org.eclipse.persistence.internal.jpa.parsing.AliasableNode].
Internal Exception: java.lang.ClassCastException: org.eclipse.persistence.internal.jpa.parsing.ConcatNode cannot be cast to org.eclipse.persistence.internal.jpa.parsing.AliasableNode
Query: JPAQuery(name="Todonote.findByTaskNumber" ) 
```

我不确定问题是什么或我将如何执行 concat 语句。我的目标是运行 namedQuery 并且返回给我的 ResultList 已经根据连接列中的值进行了排序。

谢谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T06:53:52.303

JPA 1.0 和 JPA 2.0 有所不同。在 JPA 2.0 中，选择项中包含 1.0 中缺少的“[AS] result_variable”。所以你可以这样尝试；

```
 SELECT c, CONCAT(c.userDate, ' - ', c.userTime) FROM Todonote c WHERE c.todoTask = :taskNumber ORDER BY CONCAT(c.userDate, ' - ', c.userTime) DESC 
```

# php - php 到 csv 和特殊字符

> ID：12096140
> 
> 赞同：2
> 
> 时间：2012-08-23T16:24:32.453
> 
> 标签：php, apache, csv, character-encoding

我在这家已经有一段时间了。我正在尝试从 php 脚本（从数据库中获取数据）创建一个 .csv 文件。我的问题是特殊字符显示不正确。

奇怪的是，来自数据库的特殊字符显示正确，但我需要在条目中添加某些字符。

例如，数据库返回“Humidité”（法语为湿度）。这在导出的 .csv 中正确显示。

但是可以说我从我的 php 脚本中添加了一个字符串

```
$member->humidity . ': 10% à 20%'; 
```

在 csv 我会看到

```
Humidité: 10% [weird characters] 20% 
```

所以 umité 中的“é”是可以的，但我没有看到我在 PHP 中添加的“à”。

我的标题看起来不错，因为正确显示了一些特殊字符

```
$data = the whole csv file in a string      

header('Content-Encoding: UTF-8');
header('Content-type: text/csv; charset=UTF-8');
header("Content-Disposition: attachment; filename=file.csv");
header('Content-Transfer-Encoding: binary');
header('Expires: 0');
header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
header('Pragma: public');
header("Content-Length: " . strlen($data));
echo "\xEF\xBB\xBF"; // UTF-8 BOM
echo $data; 
```

所以我的猜测是问题来自我的 Apache 服务器。

当我发现[这一点](http://blog.salientdigital.com/2009/06/06/special-characters-showing-up-as-a-question-mark-inside-of-a-black-diamond/)时，我更改`default_charset = "utf-8"`了我的 php.ini 并添加`AddDefaultCharset UTF-8`到我的 httpd.conf bu 中，但没有解决它。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:32:33.843

可能您的编辑器未设置为`UTF-8`. 检查编辑器的字符集设置。您还可以使用编辑器转换文件，例如`Notepad++`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:29:59.253

您需要告诉 PHP 和 MySQL 您的数据是 UTF-8，因为它们都默认为 ASCII（或者至少它们对我来说是这样的）。我这样做了：

```
setlocale(LC_ALL, 'en_US.utf8');
mysql_query("SET NAMES 'utf8'"); 
```

这似乎有效。

# browser - 无法使用代理应用程序从远程机器上访问 https（SSL 连接）请求

> ID：12096143
> 
> 赞同：1
> 
> 时间：2012-08-23T16:24:36.920
> 
> 标签：browser, ssl, https, proxy, firewall

我们在局域网的一台机器（服务器机器）上有一个代理应用程序（VB6 应用程序）。并且所有其他机器通过代理应用程序的浏览器设置访问该机器的代理。所有机器的 Http 调用都可以正常工作。如果我从本地的浏览器中点击任何 https 请求，它工作正常，但如果我从 LAN（远程机器）的其他机器点击它，它会在不同的时间给我一个不同的错误，比如

1.  安全连接失败 连接到 www.onlinesbi.com 期间发生错误。SSL 收到超过最大允许长度的记录。（错误代码：ssl_error_rx_record_too_long）

2.  连接中断 站点可能暂时不可用或太忙。请稍后再试。如果您无法加载任何页面，请检查您计算机的网络连接。如果您的计算机或网络受到防火墙或代理的保护，请确保允许 Firefox 访问 Web。

3\. 代理拒绝连接。

浏览器、Windows 防火墙或任何其他设置是否允许从远程机器访问 https 请求（或允许 SSL 连接）？

# javascript - 我怎样才能以正确的方式编写这个 jquery on() ？

> ID：12096145
> 
> 赞同：1
> 
> 时间：2012-08-23T16:24:43.550
> 
> 标签：javascript, jquery, syntax, jquery-on

这是我所拥有的

```
$('.test').on({
    'click', 'a', function(event) {
        event.stopPropagation();

        if( $(this).hasClass('selector') ) {
        }
        if( $(this).hasClass('prev') ) {
        }
        if( $(this).hasClass('next') ) {
        }
        return false;
    },
    mouseenter: function(){
    },
    mouseleave: function(){
    }
}); 
```

我知道这是错误的语法，那么正确的语法是什么？我知道如果我将单击和鼠标事件分开，我可以编写它。但是有没有办法将它们结合起来，还是我需要将它们分开？谢谢你的时间

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:27:12.497

您可以链接调用：

```
$('.test').on('click', 'a', function() { ... })
 .on('mouseenter', 'a', function() { ... })
 .on('mouseleave', 'a', function() { ... }); 
```

我想如果你愿意，你可以有一个检查事件类型的处理程序，但这似乎不那么奇怪。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T16:30:54.843

如果您不想在两者中使用相同的选择器，则必须进行 2 次单独的调用：

```
$('.test').on({
    mouseenter: function() {},
    mouseleave: function() {} //null selector/no selector here so these events only fire on `.test` itself
}).on("click", "a", function(event) { //Selector here so this event only fires for `a` descendants of `.test`
    event.stopPropagation();
    if ($(this).hasClass('selector')) {}
    if ($(this).hasClass('prev')) {}
    if ($(this).hasClass('next')) {}
    return false;
}); 
```

您还忘记指定事件参数，这会导致 IE 和 firefox 中的错误

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T16:30:48.383

`.on()`也接受*地图*：

```
$('.test').on({
    click: function() {
    },
    mouseenter: function() {
    },
    mouseleave: function() {
    }
}, 'a'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T16:41:06.993

如果您只需要包装元素上的悬停事件，那么您需要单独绑定其事件，因为它是一个单独的元素。

```
$('.test').on({
    click: function(event) {
        event.stopPropagation();
        if ($(this).hasClass('selector')) {}
        if ($(this).hasClass('prev')) {}
        if ($(this).hasClass('next')) {}
        return false;
    }
}, "a");

$('.test').hover( function(event){
        // This in the mouse enter handler  
    },
    function(event){
        // This is the mouse leave handler
    }
); 
```

# url - 获取带有变量的 URL

> ID：12096147
> 
> 赞同：0
> 
> 时间：2012-08-23T16:24:47.810
> 
> 标签：url, variables, coldfusion

我将如何获取请求页面的 URL 以及所有变量？我知道如何获取没有变量的 URL。

例如。/forums/index.cfm?id=10&cat=5

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T16:27:55.310

转储 cgi 变量，你会发现你正在寻找的东西等等。

```
<cfdump var="#cgi#"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:02:26.793

山姆是正确的使用：

```
<cfdump var="#cgi#"> 
```

但是，您可能感兴趣的是来自 CGI 范围的值。例如，CGI.HTTP_REFERER 和 CGI​​.HTTP_USER_AGENT。请注意 HTTP_REFERER 只会在 CGI.REQUEST_METHOD 为 POST 而不是在 GET 请求时填充。

# jaxb - 什么相当于 Simple 中的 @XmlElements？

> ID：12096148
> 
> 赞同：1
> 
> 时间：2012-08-23T16:24:48.060
> 
> 标签：jaxb, annotations, simple-framework

用什么替换`@XmlElements`Simple XML 框架中的 JAXB 注解？

```
@XmlElements({ 
    @XmlElement(name = "distance", type = DistanceCheck.class), 
    @XmlElement(name = "pattern", type = PatternCheck.class), 
    @XmlElement(name = "compare", type = ComparisonCheck.class),
    @XmlElement(name = "check", type = CustomCheck.class), 
    @XmlElement(name = "unique", type = UniquenessCheck.class) 
 }) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:31:02.213

等效的是：

```
@ElementUnion({
    @Element(name="distance", type=DistanceCheck.class),
    @Element(name="pattern", type=PatternCheck.class),
    @Element(name="compare", type=ComparisonCheck.class),
    @Element(name="check", type=CustomCheck.class),
    @Element(name="unique", type=UniquenessCheck.class)
}) 
```

# javascript - 在 Google App Engine 上使用 jQuery 处理 json 表单

> ID：12096150
> 
> 赞同：0
> 
> 时间：2012-08-23T16:24:53.597
> 
> 标签：javascript, jquery, python, json, google-app-engine

我在让 jQuery 在 GAE python 2.7 上工作时遇到了一些问题。**主要问题是jQuery无法捕获服务器返回的json数据。**

一个没有什么特别的简单评论表单：

```
<form action="/postcomment/" method="post" id="commentform">
  <input type="text" name="author" id="author"  onfocus="if(this.value=='Name: (required)') this.value='';" onblur="if(this.value=='') this.value='Name: (required)';" {% if name %}value="{{ name }}"{% else %}value="Name: (required)"{% endif %} size="22" tabindex="1" aria-required='true' />
  <input type="text" name="email" id="email"  onfocus="if(this.value=='E-Mail: (required)') this.value='';" onblur="if(this.value=='') this.value='E-Mail: (required)';" {% if email %}value="{{ email }}"{% else %}value="E-Mail: (required)"{% endif %} size="22" tabindex="2" aria-required='true' />
<textarea name="comment" id="comment" cols="100%" rows="10" tabindex="3"></textarea>
<input name="submit" type="submit" id="submit" tabindex="4" value="Submit" />
</form> 
```

我的 jQuery 代码（仅结构使其更简单）：

```
$("#submit").click(function() {
$.ajax({
 dataType: 'json',
 beforeSubmit: function() {
 },
 timeout: 60000,
 error: function(request,error) {
 },
  success: function(data) {
   var obj = jQuery.parseJSON(data);
   //blah blah...
   } // End success
}); // End ajax method
}); 
```

在服务器端：

```
class PostComment(BaseHandler):
  def post(self):
    self.response.headers['Content-Type'] = "application/json"
    response = {'errorcode': 0}
    self.response.out.write(json.dumps(response)) 
```

结果是：点击“提交”按钮后，我的 Firefox 3.6 浏览器提示：有“application/json”文件，你想用什么工具打开它？

我期待 jQuery 捕捉到这个 'json' 数据并处理它。但它没有发生。

我相信我快到了，但出了点问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:27:39.457

您需要取消表单的默认操作，即提交（取消任何正在运行的 JavaScript AJAX 查询）：

```
$("#submit").click(function() {
    $.ajax({
     dataType: 'json',
     beforeSubmit: function() {
     },
     timeout: 60000,
     error: function(request,error) {
     },
      success: function(data) {
       var obj = jQuery.parseJSON(data);
       //blah blah...
       } // End success
    }); // End ajax method
    return false; // Cancel default action.
}); 
```

通过`false`从单击处理程序返回，浏览器将数据提交到属性中指定的 URL 的*正常表单操作不会被执行。*`action`

# ssis - SSIS 条件拆分布尔结果

> ID：12096151
> 
> 赞同：7
> 
> 时间：2012-08-23T16:25:01.413
> 
> 标签：ssis, split, conditional, boolean-expression

在条件拆分组件中，我需要知道 Age 是否等于 -1 并使用以下语句。![在此处输入图像描述](../Images/65085c34d6c54dfe12ec182a36831911.png)

但是，运行时会出现错误。我应该如何修改我的陈述？谢谢！

```
Error: The expression "Age == -1" on "output "Unknown" (12743)" evaluated to NULL, but the "component "Age Conditional Split 1" (12740)" requires a Boolean results. Modify the error row disposition on the output to treat this result as False (Ignore Failure) or to redirect this row to the error output (Redirect Row).  The expression results must be Boolean for a Conditional Split.  A NULL expression result is an error. 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-23T16:43:12.607

我猜你的年龄有一些 NULL 值。如果要将 NULL 发送到相同的未知输出，则可以将表达式更改为：

```
ISNULL(Age) || Age == -1 
```

# r - 在 PDF 中绘制符号失败

> ID：12096152
> 
> 赞同：9
> 
> 时间：2012-08-23T16:25:04.930
> 
> 标签：r, pdf, plot, unicode, symbols

我有以下代码来创建一个`plot`. 在`x`-屏幕上出现了，`y-axes`当我以该格式保存我的情节时，但当我将情节另存为.`symbols``JPEG``PDF`

是否有替代符号`\u2030`可以打印在我的 PDF 中或我的问题的其他解决方案？请参阅以下正确（JPEG 格式）和不正确（PDF）图的示例。

```
plot(c(-1,1), c(-1,1), bty = "n", type= "n", las = 1, cex.lab = 1.5, cex.axis = 1.25, main = NULL, 
ylab=expression(paste("Correlation Coefficient (r) for ", delta ^{15},"N"," \u0028","\u2030","\u0029")), 
xlab=expression(paste("Correlation Coefficient (r) for ", delta ^{13},"C"," \u0028","\u2030","\u0029")))
axis(1, at = seq(-1.0, 1.0, by = 0.1), labels = F, pos = 0, cex.axis = 0.05, tcl = 0.25)
axis(2, at = seq(-1.0, 1.0, by = 0.1), labels = F, pos = 0, cex.axis = 0.05, tcl = 0.25) 
```

![在此处输入图像描述](../Images/3912362fc9af6272ce165cd0f82ba805.png) ![在此处输入图像描述](../Images/48027c092927c564eb4e979477327c72.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T17:42:09.993

问题是您的默认字体没有“‰”（我将其称为“per mil”）作为使用 \u0028 生成的字形。您需要更改为具有该字形的字体：

```
?pdfFonts 
```

这就是我在没有问题的情况下得到的设置（至少据我所知）。

```
> str(pdfFonts("sans"))
List of 1
 $ sans:List of 3
  ..$ family  : chr "Helvetica"
  ..$ metrics : chr [1:5] "Helvetica.afm" "Helvetica-Bold.afm" "Helvetica-Oblique.afm" "Helvetica-BoldOblique.afm" ...
  ..$ encoding: chr "default"
  ..- attr(*, "class")= chr "Type1Font" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T17:37:36.560

您可能必须更改编码。在我的 Mac 上，这让我得到了 ‰ 符号：

```
pdf('test.pdf',encoding="MacRoman")
plot.new()
text(0,labels="\u2030")
dev.off() 
```

在[包的“enc”目录中`grDevices`](https://github.com/wch/r-source/tree/trunk/src/library/grDevices/inst/enc)查找可用的编码并尝试一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-08-02T09:01:49.430

我在使用 MAC 以 PDF 格式保存时遇到了同样的问题。我正在使用 ggsave 和 MacRoman 进行储蓄。

```
ggsave("Name_of_your_file.pdf", #choose your own name
   encoding="MacRoman",
   width = 20, #size that you want
   height = 20, #size that you want
   units = "cm") 
```

它会将您的文件保存在您保存 R 文件的位置。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-09-16T21:14:38.703

根据您的系统是否具有所需的真正字体文件 [提示：安装 showtext 包并使用 View(font_files()] 您应该能够通过以下方式将可用的 unicode 字符转换为 pdf 文件

1.  首先导出到一个临时文件，比如“temp.png”
2.  使用 pdf() 或 cairo_pdf() 导出到 pdf 文件，比如“UnicodeToPDF.pdf”
3.  结合使用 grid.arrange（来自 gridExtra）、rasterGrob（来自 grid）和 readPNG（来自 png）将 temp.png 文件插入到 UnicodeToPDF.pdf 文件中
4.  删除“temp.png”文件

```
#--- A function to install missing packages and load them all
myfxLoadPackages = function (PACKAGES) {
  lapply(PACKAGES, FUN = function(x) {
    if (suppressWarnings(!require(x, character.only = TRUE))) {
      install.packages(x, dependencies = TRUE, repos = "https://cran.rstudio.com/")
    }
  })
  lapply(PACKAGES, FUN = function(x) library(x, character.only = TRUE))
}

packages = c("gridExtra","grid","png")
myfxLoadPackages(packages)

#--- The trick to get unicode characters being printed on pdf files:
#--- 1\. Create a temporary file, say "temp.png"
#--- 2\. Create the pdf file using pdf() or cairo_pdf(), say "UnicodeToPDF.pdf"
#--- 3\. Combine the use of grid.arrange (from gridExtra), rasterGrob (from grid), and readPNG (from png) to insert the
#       temp.png file into the UnicodeToPDF.pdf file
Corrvalues = data.frame(X=seq(-0.8,0.8,0.2),
                        Y=seq(-0.8,0.8,0.2),
                        PCH=-c(10122:10130)) #--- This is equivalent to using unicode characters 10122-10130 (note the use of -)
#--- Refer to http://xahlee.info/comp/unicode_index.html to see more unicode character integers

png("temp.png", width=11, height=11, units="in", res=300)
par(mar=c(4,5,3,1) + 0.1)
plot(c(-1,1), c(-1,1), bty = "n", type= "n", las = 1, cex.lab = 1.5, cex.axis = 1.25, main = NULL, 
     ylab=expression(paste("Correlation Coefficient (r) for ", delta ^{15},"N"," \u0028","\u2030","\u0029")), 
     xlab=expression(paste("Correlation Coefficient (r) for ", delta ^{13},"C"," \u0028","\u2030","\u0029")))
axis(1, at = seq(-1.0, 1.0, by = 0.1), labels = F, pos = 0, cex.axis = 0.05, tcl = 0.25)
axis(2, at = seq(-1.0, 1.0, by = 0.1), labels = F, pos = 0, cex.axis = 0.05, tcl = 0.25)
points(Corrvalues$X,Corrvalues$X,pch=Corrvalues$PCH,cex=2.75,col="#FF7F00")
dev.off()

pdf("UnicodeToPDF.pdf", width=11, height=11)
grid.arrange(
  rasterGrob(
    readPNG(
      "temp.png",
      native=F
    )
  )
)
dev.off()

file.remove("temp.png") 
```

添加了以下图片以跟进 Konrad Rudolph 的评论。 [![在此处输入图像描述](../Images/a54cd131110b143c04f9fa5495c89651.png)](https://i.stack.imgur.com/zJju6.png)

# c# - 无法识别的表达式节点：使用 DateTime.ParseExact 时的 ArrayIndex

> ID：12096156
> 
> 赞同：0
> 
> 时间：2012-08-23T16:25:12.687
> 
> 标签：c#, linq-to-sql

我有以下部分查询

```
var finalResults =

    (from o in outerJoin
    orderby o.timeKey.timeKey.Year_Num, o.timeKey.timeKey.Month, o.Key.Key.PlantId, o.timeKey.timeKey.PhysicalUnitId
    select new
    {
        IndicatorName = IndicatorName,
        LocationName = o.timeKey.timeKey.PlantId,
        GroupingName = o.timeKey.timeKey.PhysicalUnitId,
        Year = o.timeKey.timeKey.Year_Num,
        Month = o.timeKey.timeKey.Month, 
        Numerator = o.timeKey.Key.Derate_Hours != null ? o.timeKey.Key.Derate_Hours ?? 0 : 0,
        Denominator = o.timeKey.timeKey.Hours - o.timeKey.Key.Derate_Hours ?? 0,
        Weight = o.timeKey.timeKey.NetMaximumCapacity,                         
    }).ToList(); 
```

查询工作正常，除了 Month 给了我月份和年份的格式：

```
August 2012 
```

我需要这种格式：

```
08 
```

我更改了我的代码，如下所示：

```
var finalResults =

    (from o in outerJoin
    orderby o.timeKey.timeKey.Year_Num, o.timeKey.timeKey.Month, o.Key.Key.PlantId, o.timeKey.timeKey.PhysicalUnitId
    select new
    {
        IndicatorName = IndicatorName,
        LocationName = o.timeKey.timeKey.PlantId,
        GroupingName = o.timeKey.timeKey.PhysicalUnitId,
        Year = o.timeKey.timeKey.Year_Num,
        Month = DateTime.ParseExact(o.timeKey.timeKey.Month.Split(' ')[0], "MMMM", CultureInfo.CurrentCulture).Month,
        Numerator = o.timeKey.Key.Derate_Hours != null ? o.timeKey.Key.Derate_Hours ?? 0 : 0,
        Denominator = o.timeKey.timeKey.Hours - o.timeKey.Key.Derate_Hours ?? 0,
        Weight = o.timeKey.timeKey.NetMaximumCapacity,                         
    }).ToList(); 
```

但现在我收到以下错误：

```
Unrecognized expression node: ArrayIndex 
```

有没有办法做我想做的事？更改数据库中的格式不是一种选择。

这是整个查询：

```
protected IList<DataResults> QueryData(HarvestTargetTimeRangeUTC ranges)
{
    using (var context = new DataClassesDataContext(_connectionString))
    {
        context.CommandTimeout = 240;                
        const string IndicatorName = "{DFD88372-FB87-49AC-8576-68DCBE7B00E8}";

        List<string> typeCodes = new List<string>() { "D1", "D2", "D3", "DP", "PD", "DM", "D4" };
        DataResults endItem = new DataResults();
        List<DataResults> ListOfResults = new List<DataResults>();

        var results =

            (from v in context.vDimUnits
             join vf in context.vFactEnergyAllocations on v.UnitKey equals vf.UnitKey
             join vd in context.vDimGadsEvents on vf.GadsEventKey equals vd.GadsEventKey
             join vt in context.vDimTimes on vf.TimeKey equals vt.TimeKey
             where typeCodes.Contains(vd.GadsEventTypeCode) 
                && vt.Year_Num >= ranges.StartTimeUTC.Year 
                && vt.Year_Num <= ranges.EndTimeUTC.Year                        
                && v.PhysicalUnitId != "N/A"
                && v.PhysicalUnitId != "UNK"
                && v.PlantId != "UNK" 
                && v.NercUnitType != "WT"
             group vf by new { v.PlantId, v.PhysicalUnitId, v.NetDependableCapacity, vt.Year_Num, vt.Month } into groupItem
             select new
             {
                 groupItem.Key.Year_Num,
                 groupItem.Key.Month,
                 groupItem.Key.PhysicalUnitId,
                 groupItem.Key.NetDependableCapacity,
                 Derate_Hours = groupItem.Sum(x => (float?)x.AllocatedEnergyMwh / groupItem.Key.NetDependableCapacity),
                 groupItem.Key.PlantId,
                 Unit = groupItem.Count()
             });

        var resultHours =

            (from f in
            (from vt in context.vDimTimes
            from v in context.vDimUnits
            where vt.Year_Num >= ranges.StartTimeUTC.Year
                && vt.Year_Num <= ranges.EndTimeUTC.Year 
                && v.PhysicalUnitId != "N/A" 
                && v.PhysicalUnitId != "UNK" 
                && v.PlantId != "UNK" 
                && v.NercUnitType != "WT"
            select new { v.PlantId, v.PhysicalUnitId, vt.Year_Num, vt.Month, vt.TimeKey, v.NetMaximumCapacity }).Distinct()
             group f by new { f.PhysicalUnitId, f.Year_Num, f.Month, f.PlantId } into groupItem
            select new
            {
                 groupItem.Key.PhysicalUnitId,
                 groupItem.Key.Year_Num,
                 groupItem.Key.Month,
                 groupItem.Key.PlantId,
                 groupItem.First().NetMaximumCapacity,
                 Hours = groupItem.Count()
            });

        var serviceHrsResults =

            (from v in context.vDimUnits
             join vf in context.vFactEnergyAllocations on v.UnitKey equals vf.UnitKey
             join vt in context.vDimTimes on vf.TimeKey equals vt.TimeKey
             join vus in context.vDimUnitStates on vf.UnitStateKey equals vus.UnitStateKey

             where vus.UnitStateType != "Active" 
                && vt.Year_Num >= ranges.StartTimeUTC.Year 
                && vt.Year_Num <= ranges.EndTimeUTC.Year
                && v.NetDependableCapacity != 0 
                && v.PhysicalUnitId != "N/A" 
                && v.PhysicalUnitId != "UNK" 
                && v.PlantId != "UNK" 
                && v.NercUnitType != "WT"

             group vf by new { v.PlantId, vt.Year_Num, vt.Month, v.PhysicalUnitId, v.NetDependableCapacity } into groupItem

             select new
             {
                 groupItem.Key.Year_Num,
                 groupItem.Key.Month,
                 groupItem.Key.PhysicalUnitId,
                 groupItem.Key.NetDependableCapacity,
                 groupItem.Key.PlantId,
                 Unit = groupItem.Count()
             });

        var outerJoin1 =

            (from h in resultHours
             join u in results on new { h.PhysicalUnitId, h.Year_Num, h.Month } equals new { u.PhysicalUnitId, u.Year_Num, u.Month } into outer
             from grouping in outer.DefaultIfEmpty()
             select new { timeKey = h, Key = grouping });

        var outerJoin2 =

            (from h in resultHours
             join s in serviceHrsResults on new { h.PhysicalUnitId, h.Year_Num, h.Month } equals new { s.PhysicalUnitId, s.Year_Num, s.Month } into outer2
             from grouping in outer2.DefaultIfEmpty()
             select new { timeKey = h, Key = grouping });

        var outerJoin =

            (from a in outerJoin1
             join b in outerJoin2 on new { a.timeKey.PhysicalUnitId, a.timeKey.Year_Num, a.timeKey.Month } equals new
             {
                 b.timeKey.PhysicalUnitId,
                 b.timeKey.Year_Num,
                 b.timeKey.Month
             } into outer
             from grouping in outer.DefaultIfEmpty()
             select new { timeKey = a, Key = grouping }).Distinct();

        var finalResults =

            (from o in outerJoin
             orderby o.timeKey.timeKey.Year_Num, o.timeKey.timeKey.Month, o.Key.Key.PlantId, o.timeKey.timeKey.PhysicalUnitId
             select new
             {
                IndicatorName = IndicatorName,
                 LocationName = o.timeKey.timeKey.PlantId,
                 GroupingName = o.timeKey.timeKey.PhysicalUnitId,
                 Year = o.timeKey.timeKey.Year_Num,
                 Month = DateTime.ParseExact(o.timeKey.timeKey.Month.Split(' ')[0], "MMMM", CultureInfo.CurrentCulture).Month,
                 Numerator = o.timeKey.Key.Derate_Hours != null ? o.timeKey.Key.Derate_Hours ?? 0 : 0,
                 Denominator = o.timeKey.timeKey.Hours - o.timeKey.Key.Derate_Hours ?? 0,
                 Weight = o.timeKey.timeKey.NetMaximumCapacity,                         
                 }).ToList();

        for (int counter = 0; counter < finalResults.Count; counter++)
        {
            var item = finalResults[counter];
            endItem = new DataResults();
            ListOfResults.Add(endItem);
            endItem.IndicatorName = IndicatorName;
            endItem.LocationName = item.LocationName;
            endItem.GroupingName = item.GroupingName;
            endItem.Year = item.Year;
            endItem.Month = item.Month.ToString();
            endItem.Numerator = item.Numerator;
            endItem.Denominator = item.Denominator;
            endItem.Weight = item.Weight.Value;                    
        }
        return ListOfResults;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:37:36.020

我们仍然没有太多的上下文，但无论如何我都会猜测一个合适的答案:)

如果您尝试在要转换为 SQL 的查询表达式中做大量工作，您可能会发现最好将查询拆分为两部分：

*   用 SQL 完成的部分，尽可能多地过滤，只指定您需要的数据，但采用“原始”格式
*   在 LINQ to Objects 中完成的一部分，它可以使用您需要的任何 .NET 方法。

您`AsEnumerable`可以有效地从使用 in`Queryable`中的方法切换到`Enumerable`. 所以你可能有：

```
var sqlQuery = from ...
               orderby ...
               select ...;

var finalQuery = sqlQuery.AsEnumerable().Select(entry => new { 
                     // Call whatever methods you like in here
                 }); 
```

这避免了要求 LINQ 提供程序生成 SQL 来模拟这样的事情：

```
DateTime.ParseExact(o.timeKey.timeKey.Month.Split(' ')[0], "MMMM", 
                    CultureInfo.CurrentCulture).Month, 
```

这也意味着您可以编写可以在查询之外轻松测试的辅助方法：

```
var finalQuery = sqlQuery.AsEnumerable().Select(entry => new { 
                     Month = ConvertYearMonthToMonthNumber(entry.Month),
                     ...
                 }); 
```

请注意，这`CultureInfo.CurrentCulture`很可能是*错误*的文化，除非您真的知道存储在数据库中的数据与您的用户处于相同的文化中，这可能不是不变的文化。我认为你更有可能真的想使用不变的文化......或者只是使用`Calendar.MonthNames.IndexOf(month)`.

# progress-4gl - FOR EACH Commnad 中的 CONTAINS 参数有问题

> ID：12096160
> 
> 赞同：0
> 
> 时间：2012-08-23T16:25:43.527
> 
> 标签：progress-4gl, openedge

我有一个表 JobHead，我在该表的 PartDescription 字段中创建了一个 Word-Index，如下面的程序所示。我正在寻找在 PartDescription 字段中带有单词 NUCLEAR 的工作。我什么都得不到，我做错了什么？

```
DO:                      
OUTPUT TO VALUE("c:\Nuclear.txt").

    FOR EACH JobHead WHERE 
        JobHead.PartDescription CONTAINS "NUCLEAR" EXCLUSIVE-LOCK.

        DISPLAY JobHead.JobNum.
    END.

OUTPUT CLOSE.
END. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T23:23:22.757

单词索引适用于*完整的单词*，而不是部分单词。因此，如果您在 PartDescription 的记录中有“NUCLEARISSAFE”，则在您的代码中将找不到文本“NUCLEAR”。

请注意，如果您有“NUCLEAR-IS-SAFE”，它会起作用，因为幕后的进展是单独索引单词。

您可以使用 index 关键字，但不幸的是它没有被索引，因此会锁定比必要更多的记录：

```
FOR EACH JobHead WHERE 
         INDEX(JobHead.PartDescription, "NUCLEAR") GT 0 EXCLUSIVE-LOCK. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T04:51:05.947

确切地说，CONTAINS 运算符正在使用分词规则。根据您使用的代码页，这些可能会有所不同。请注意，对于 UTF-8，它们不是开箱即用定义的，因此除非您定义它，否则您将收到错误消息。

这篇知识库文章展示了如何查看哪些分词规则已到位 [知识库文章](http://knowledgebase.progress.com/articles/Article/P175105)

# .net - 如何用 Mono.Cecil 的 rethrow 替换 ILAsm throw？

> ID：12096164
> 
> 赞同：3
> 
> 时间：2012-08-23T16:26:00.743
> 
> 标签：.net, powershell, mono.cecil, ilasm

我有一个 C# dll，其成员类似于以下内容：

```
public void DoStuff(int i) {
    try {
        something.InnerDoStuff(i);
    }
    catch (Exception ex) {
        throw ex;
    }
} 
```

我想出了如何获得[throw 操作码](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.throw.aspx)：

```
Add-Type -Path 'c:\Program Files\ILSpy2\Mono.Cecil.dll'
Add-Type -Path 'c:\Program Files\ILSpy2\Mono.Cecil.pdb.dll'

$dll = 'c:\Program Files\ZippySoft\Something\foo.dll'
$assemblyDefinition = [Mono.Cecil.AssemblyDefinition]::ReadAssembly($dll);

$doThingsIlAsm = (
    (
        $assemblyDefinition.MainModule.Types `
            | where { $_.Name -eq 'DoerOfThings' } `
            | select -first 1 *
    ).Methods | where { $_.Name -eq 'DoStuff' }
).Body.Instructions 

$throwOp = ($doThingsIlAsm | where {
    $_.OpCode.Name -eq 'throw'
}) 
```

我的问题是如何将 throw opcode 替换为[rethrow opcode](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.rethrow.aspx)？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:03:50.973

我相信你可以得到一个[`ILProcessor`](http://www.inevitablesoftware.com/Help/Nova.CodeDOM/html/bcc83e37-b043-d81a-b959-89c58faf8a53.htm)for 你的方法，[`Create`](http://www.inevitablesoftware.com/Help/Nova.CodeDOM/html/436fe770-c90d-8344-cdc7-1f55a46befda.htm)一个`rethrow`操作码，然后使用处理器的[`Replace`](http://www.inevitablesoftware.com/Help/Nova.CodeDOM/html/3cdc16bf-e4b6-be30-67ac-a291a035486b.htm)方法来交换`throw`for a `rethrow`。

不要立即获取方法主体的说明，而是获取对方法主体的引用并使用它来获取`myMethod.Body.GetIlProcessor`以及`myMethod.Body.Instructions`. 然后你可以找到你已经存在的 throw 指令，并使用 Replace 方法将它们换出。

这是未经测试的，但我认为它的要点是：

```
$throw = # your existing stuff
$il = myMethod.Body.GetIlProcessor()
$rethrow = $il.Create(OpCodes.Rethrow) # not sure about the powershell syntax for enums
$il.Replace($throw, $rethrow) 
```

# regex - 搜索前的正则表达式字符

> ID：12096165
> 
> 赞同：0
> 
> 时间：2012-08-23T16:26:08.090
> 
> 标签：regex, datetime

我有一个在文本文件中查找日期的以下正则表达式：

```
(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2}) 
```

我想找到这个搜索字符串之前的字符。谁能指出我正确的方向。前面的字符是我要搜索和替换的 , （逗号）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:27:29.690

您需要使用[积极的前瞻](http://www.regular-expressions.info/lookaround.html)来完成此操作：

```
/,(?=(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2}))/ 
```

此模式将匹配逗号，但前提是它后面跟着与您在问题中提供的模式匹配的内容。（请注意，使用搜索/替换，它不会替换日期）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:27:34.093

只需添加`,`到您的正则表达式。然后它将仅匹配以逗号开头的日期实例：

```
/,((\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2}))/ 
```

原始的正则表达式被包装`()`并作为第一个子匹配可用。

# javascript - localStorage["something"] 与 localStorage.something

> ID：12096169
> 
> 赞同：2
> 
> 时间：2012-08-23T16:26:17.247
> 
> 标签：javascript, local-storage

> **可能重复：**
> [JavaScript 属性访问：点符号与括号？](https://stackoverflow.com/questions/4968406/javascript-property-access-dot-notation-vs-brackets)

我是 chrome 扩展的新手。我知道 Java，但 Javascript 是完全不同的东西。

我想问 和 有什么`localStorage["something"]`区别`localStorage.something`？

方括号与点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T16:35:09.163

没有区别。事实上，在 JavaScript 中这两种语法整体上并没有什么区别：

```
someObj.someProp === somObj["someProp"]; 
```

唯一的区别是某些字符在字符串中有效，在点属性名称中无效：

```
someObj["some-prop"] // valid
someObj.some-prop // this is actually the value of `someObj.some` minus the value of `prop` 
```

请注意，这两种存储值的方法`localStorage`也与使用`.getItem`and`.setItem`方法相同。根据[W3C 规范](http://www.w3.org/TR/webstorage/)：

> 每个 Storage 对象都提供对键/值对列表的访问，这些键/值对有时称为**items**。

这些*项目*可以通过同名的对象属性或通过使用`.getItem`和的名称引用它们来访问和可变`.setItem`。唯一的区别是可以覆盖函数以提供包装，例如，在存储之前对对象进行 JSON 化：

```
localStorage.setItem = function(key, val) {
    localStorage[key] = JSON.stringify(val);
} 
```

# apache - Tomcat email notification upon deployement

> ID：12096170
> 
> 赞同：3
> 
> 时间：2012-08-23T16:26:17.530
> 
> 标签：apache, deployment, notifications, tomcat6

Wondering is there is a way to generate notification when an application is deployed on Tomcat 6\. Right now we use Tomcat Manager web interface to deploy our applications. We have two tomcat instances working in a load balanced mode with Apache in front of them. Would highly appreciate if anyone can throw more light on the same.

# java - Java periodically returning the newest files in subdirectories into one array

> ID：12096171
> 
> 赞同：0
> 
> 时间：2012-08-23T16:26:20.520
> 
> 标签：java

I have a root folder, and it contains a number of sub-directories, and each sub-directory contains only xml files (no other directories).. I need to make a program that returns the newest files added in (in all of the sub-directories) to be able to send them to ftp subscribers..

what's the best way to do that ?

I am able to look through one directory and sort all its files but I don't know how to do it for multiple sub-directories..and I need only the newest files, if i return all the files it will slow down the program.

Also, I need this program to be executed periodically, do I have to include this in the method it self, or create an other class for that ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:43:41.880

这里有很多问题：

首先，关于目录树遍历。如果您能够阅读一个目录，那么您就可以阅读其中的任何一个。您将需要某种迭代或递归功能来读取文件的目录列表。对于作为目录本身的每个文件，您再次调用该函数并将其用作新根。为此，File 类中有一个 isDirectory() 方法。

至于新文件的识别，您需要保留（先前程序运行的）旧值并将它们与新值进行比较。或者您可以依赖文件修改时间并将它们与上次运行的时间进行比较。此日期之前的任何文件都将是新文件或上次运行后修改的旧文件。

至于让它定期运行，这取决于。您可以使用 serviceWrapper 将其设置为操作系统服务，或者您可以在容器中运行它，或者甚至将其作为独立运行，并在经过一段时间的延迟或等待或休眠后定期调用此函数。选项太多，信息太少，甚至无法建议什么是最好的。但它会是这样的，尽管如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:37:11.663

使用新的 nio Watch Service API，您可以在目录内容更改时收到通知，而不是定期检查。这是有效的，因为它使用低级系统通知 API。

Oracle 文档：[http ://docs.oracle.com/javase/tutorial/essential/io/notification.html](http://docs.oracle.com/javase/tutorial/essential/io/notification.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T16:38:58.303

那么我会怎么做...

首先将当前时间戳存储在一个文件中，您将在下次调用时读取该文件，这将使程序知道它最后一次执行的时间。

现在读取时间戳并仅包含具有

`file.lastModified() > lastTimeStampOfRun`并归还它们。

要扫描所有文件和目录，您可以简单地使用 java IO。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T17:03:17.933

**1.**获取文件列表的方式是使用`File.listFiles()`.

**2.**现在编写一个`Comparator`使用`File.lastModified()`并将其与文件数组一起传递给`Arrays.sort()`.

**3.**现在创建一个`Thread`在一定延迟后继续检查此更改....

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T17:03:22.637

我建议您使用 Apache Camel 实现您的应用程序。它完全是为像您这样的请求而制作的。有关概述，请参见[http://camel.apache.org/ 。](http://camel.apache.org/)

您基本上使用 Spring DSL 或纯 Java 定义路由，并将消息路由到一个或多个能够对这些消息进行操作的端点。例如，从本地文件夹中获取文件并在它们出现后立即将它们推送到 FTP 是一个单一的线路。不需要做线程、Java IO 摆弄或其他你真的不想关心的事情。

**例子**

```
from("file://inputdir/?recursive=true&delete=false").to("ftp://user@host../folder/?password=xyz"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T17:43:15.707

看起来需要[FileMonitor](http://commons.apache.org/io/api-release/index.html?org/apache/commons/io/monitor/package-summary.html) 或 jnotify。

# c# - code adherence to single responsibility principle & unit testing

> ID：12096172
> 
> 赞同：0
> 
> 时间：2012-08-23T16:26:22.373
> 
> 标签：c#, unit-testing, single-responsibility-principle

I have lately been reading on the `Single Responsibility Principle` concept, and in theory I agree a lot with it. I am having difficulty coming to terms on which code can be exactly classified as violating the principle. I would like to implement this principle, so as to gear towards Test-Driven Development.

Take for example the code below:

```
public void MarkAsSuccessful(PaymentMethodSpecific paymentMethod, bool requiresManualIntervention)
    {
            this.Paid = true;
            this.PaidOn = CS.General_v3.Util.Date.Now;
            this.PaidByPaymentMethod = paymentMethod;
            this.RequiresManualIntervention = requiresManualIntervention;

            this.Update();

        this.CreateAndSendNotificationRegardingImmediatePayment();

        this.SendPaymentSuccessfulEmails();

    } 
```

This is placed in a class called `PaymentRequest`, which basically is a class which handles logic related to payment in an e-commerce application. The method above marks the request as 'successful'. This must mark the columns paid, as well as other information, as well as send a notification that this was successful, and also send emails.

For example, when it comes to unit testing - It is very difficult to unit-test this method as I have no way to know that the notification was actually created and sent, as well as the payment emails have been sent. Would like to know how more experienced people on the SRP concept would approach such an example.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:42:16.413

我的猜测是你有一个类与你的`PaymentProcessor`类合并/嵌入`PaymentRequest`。

`PaymentProcessor`基本上是 a`PaymentRequest`穿过的有限状态机。

在构建它时`PaymentProcessor`，您将注入处理“即时付款通知”和一般电子邮件的对象。这样，您可以通过注入断言预期条件发生的模拟对象来独立测试所有状态和处理器。

单一责任本身是一个很棒的概念，但是当您开始整体投资 SOLID 时，力量真的来了。

# android - Why are Google Play installation stats so inaccurate?

> ID：12096174
> 
> 赞同：1
> 
> 时间：2012-08-23T16:26:27.493
> 
> 标签：android, google-play

I noticed a large discrepancy in the stats reported by Google Play. When I subtract totals for two consecutive days (Total User Installs). I almost never get the same answer when I compare it to the Daily User Installs column? Do you know why it happens? I posted my data [here](http://artymiak.com/can-you-trust-google-play-statistics/).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:32:59.760

众所周知，Google Play 的统计数据不准确。[使用Google Analytics for Mobile](http://www.google.com/analytics/features/mobile.html)或[Flurry 之](http://www.flurry.com/)类的服务来跟踪您的应用使用情况要好得多。这两者都比 Google Play 准确得多。Google Play 的统计数据非常糟糕，您可能会创建自己的分析并最终获得更好的数据。

# .net - ButtonRenderer uses different background colors than Button in 16-bits

> ID：12096176
> 
> 赞同：1
> 
> 时间：2012-08-23T16:26:38.247
> 
> 标签：.net, winforms, button, colors

In a custom control, deriving from Button, the ButtonRenderer.DrawButton() draws a button, in various states.

All is fine when the display settings in Windows are set to a color-depth of 32-bits, but once, it is set to 16-bits, the color does not match one of a regular WinForms button and it stands out in my UI, which I do not really want.

I've replicated this using a minimal example code like this.

```
 protected override void OnPaint(PaintEventArgs e)
    {
        base.OnPaint(e);

        Rectangle rect = new Rectangle(10, 10, 250, 120);
        ButtonRenderer.DrawButton(e.Graphics, rect, PushButtonState.Normal);

        rect = new Rectangle(300, 300, 250, 120);
        ControlPaint.DrawButton(e.Graphics, rect, ButtonState.Normal);
    } 
```

which gives this...

![Rendered Buttons](../Images/99674c6613f8a54591a1dd03d81007bd.png)

I'm sure you will all notice that the two "buttons" drawn by the DrawButton methods have a slightly lighter color than the standard button, and Form background (which I didn't change and left as the default which is "Control")... If you zoom enough, you can see that it is alternating pixels of the correct background color and another brighter color...

I spotted this issue because our users are using Remote Desktop (RDP) to connect to our applications. Forcing the remote desktop settings to 32-bits resolves the problem but I think it has a performance impact, and some of our users are working overseas over relatively slow broadband links... so enforcing 32-bits is an option I would prefer to avoid. It also happens in front of a PC, by setting the display settings to 16-bits colors.

Do you please have any ideas? Is it some kind of bug with ButtonRenderer and ControlPaint classes, or is there a way around this? (I'm using .Net 4.0).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:19:29.927

ControlPaint.DrawButton 是 Win32 的[DrawFrameControl](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162480%28v=vs.85%29.aspx)的包装器。

它呈现为位图，然后将位图绘制到您的 Graphics 显示上下文。颜色抖动/近似发生在该位图层。我没时间做进一步的实验了，但是......

如果您只是自己调用 DrawFrameControl，则一切正常：

```
[DllImport("user32.dll", CharSet=CharSet.Auto, ExactSpelling=true)]
public static extern bool DrawFrameControl(IntPtr hDC, ref RECT rect, int type, int state);

[StructLayout(LayoutKind.Sequential)]
public struct RECT
{
    public int left;
    public int top;
    public int right;
    public int bottom;

    public RECT(Rectangle r)
    {
        this.left = r.Left;
        this.top = r.Top;
        this.right = r.Right;
        this.bottom = r.Bottom;
    }
}

protected override void OnPaint(PaintEventArgs e)
{
    if (Application.RenderWithVisualStyles)
         ButtonRenderer.DrawButton(.....)
    else
    {
         var rect = new RECT(new Rectangle(10, 110, 100, 100));
         DrawFrameControl(e.Graphics.GetHdc(), ref rect, 4, 0x10 | (int)ButtonState.Normal);
    }

    base.OnPaint(e);
} 
```

编辑：添加了对主题的可选调用

# ios - 如何动态设置uibutton的标签颜色和对齐方式

> ID：12096178
> 
> 赞同：2
> 
> 时间：2012-08-23T16:26:41.240
> 
> 标签：ios, dynamic, colors, uibutton

在 xcode 中添加 ui 按钮时，我使用以下代码设置标题标签的文本颜色、对齐方式和字体大小。选择了字体大小，但没有选择文本颜色和对齐方式，为什么？谢谢。

```
toButton.titleLabel.textColor = [UIColor redColor];
toButton.titleLabel.textAlignment = UITextAlignmentRight;
toButton.titleLabel.font = [UIFont boldSystemFontOfSize:FONT_SIZE];
[toButton setTitle:fromButton.titleLabel.text forState:UIControlStateNormal]; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T17:15:22.420

您将颜色设置为，`titleLabel`而不是这个，使用：

```
[toButton setTitleColor:[UIColor redColor] forState:UIControlStateNormal]; 
```

对于文本对齐，此行将起作用：

```
toButton.titleLabel.textAlignment = UITextAlignmentRight; 
```

您还可以使用：

```
toButton.contentHorizontalAlignment = UIControlContentHorizontalAlignmentRight; 
```

# yii - Yii $form->textfield，如何设置默认值？

> ID：12096183
> 
> 赞同：22
> 
> 时间：2012-08-23T16:26:55.180
> 
> 标签：yii

所以我在摆弄 Yii 框架，在其中一个视图中，特别是创建表单，我试图给我的一个文本字段一个默认值。因此，当我进入我的创建页面时，值已经预加载在表单上。

**这是我当前的代码**

```
<div class="row">
    <?php echo $form->labelEx($model,'teamlead'); ?>
    <?php echo $form->textField($model,'teamlead',array('size'=>50,'maxlength'=>50,'value'=>Yii::app()->user->getUsername(),'disabled'=>'disabled')); ?>
    <?php echo $form->error($model,'teamlead'); ?>
</div> 
```

当我按创建时，Yii 给我一个错误，告诉我`textField`有空？不知道除了设置值我还能做什么。我是否也想设置模型属性？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2015-06-01T14:07:44.293

它适用于我：

```
<?= $form->field($model, 'some_field')->textInput(['readonly' => true, 'value' => $model->isNewRecord ? 'Your Value' : $model->some_field]) ?> 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-23T16:35:34.987

在字段描述之前添加：

```
<?php
$model->teamlead='my default value';
?> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-12-19T12:00:02.953

这是我将固定值发送到数据库并以只读方式显示该值的代码。

```
<?php echo $form->textField($model,'pp_status', array('value'=>'Open', 'readonly' => 'true')); ?> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-26T04:46:34.227

总是，在模型类上处理数据（默认值、发生某些事情后的更改、数据处理等）是一个好主意。

如果您在初始化模型后获取值，最好的方法是使用方法 init()。

但是，如果您想在从数据库加载数据后更改或定义默认值，您可以使用方法[afterFind()](http://www.yiiframework.com/doc/api/1.1/CActiveRecord#afterFind-detail)

例如：

```
public function afterFind(){
    $this->localdate = date("Y-m-d");
    parent::afterFind();
} 
```

这个链接有很多关于这些方法的有用信息：[http ://www.yiiframework.com/doc/guide/1.1/en/database.ar#customization](http://www.yiiframework.com/doc/guide/1.1/en/database.ar#customization)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-07-22T05:19:12.490

请使用`array('readonly' => true)`而不是`disabled`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-04-07T08:52:59.057

我相信执行此操作的 MVC 方法是将您的默认值放在您的模型中：

```
class MyModel extends \yii\db\ActiveRecord
{
    public $teamlead = 'my default value';
    ....
} 
```

或在您的控制器中：

```
class MyModelController extends Controller
{
    public function actionCreate()
    {
        $model = new MyModel ();
        $model->teamlead = 'my default value';
        ...
    }
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-05-04T06:14:50.117

```
<div class="row">
    <?php echo $form->labelEx($model,'teamlead'); ?>
    <?php echo $form->textField($model,'teamlead',array('readonly'=>'true',size'=>50,'maxlength'=>50,'value'=>Yii::app()->user->getUsername(),'disabled'=>'disabled')); ?>
    <?php echo $form->error($model,'teamlead'); ?>
</div> 
```

输入你的编码它会`array('readonly'=>'true')`起作用

# html - text rotation css in IE vs chrome and FF text is not visible

> ID：12096188
> 
> 赞同：0
> 
> 时间：2012-08-23T16:27:18.077
> 
> 标签：html, css

Hello all I am trying to setup a sidebar navigation with html CSS and jquery that allows the user to click on a button the buttons will disappear and the menu will slide out from the left side of the page.

You can view a working sample of this [here](http://jsfiddle.net/rlcrews/r5H9Z/)

I'm trying to figure out why the text does not appear within the div element visully in Chrome but it appears in IE. The desired effect is to have the text rotated -90 deg within the div tag. It appears to be there just not visible?

I'd appreciate any suggestions.

Thanks in advance

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:46:45.190

您必须使用该代码设置旋转元素的基本位置：

```
-ms-transform-origin:50% 50%;
-webkit-transform-origin:50% 50%;
-moz-transform-origin:50% 50%;
-o-transform-origin:50% 50%; 
```

我建议你把它写在一个新的类中，以应用于每个旋转的 div。

# scala - Akka zeromq 演员似乎对 REP/REQ 很慢

> ID：12096192
> 
> 赞同：5
> 
> 时间：2012-08-23T16:27:28.153
> 
> 标签：scala, request, akka, zeromq, reply

我正在使用 zeromq 构建 REQ/REP 服务，REP 部分在 Scala 中并使用 Akka 演员。

这里是演员

```
class ReplyActor extends Actor {

  println("Listening..")

  def receive = {
    case m: ZMQMessage =>
      sender ! ZMQMessage(Seq(Frame("world")))
    case _ =>
      sender ! ZMQMessage(Seq(Frame("didn't understand?")))
  }

} 
```

我的主要功能

```
object Replyer extends App {
  val system = ActorSystem("zmq")
  val serverSocket = ZeroMQExtension(system).newRepSocket(
    Array(
      Bind("tcp://127.0.0.1:1234"),
      Listener(system.actorOf(Props[ReplyActor]))
    )
  )
} 
```

我的 REQ 代码在 python 中

```
import zmq
import time
context = zmq.Context()
socket = context.socket(zmq.REQ)
socket.connect("tcp://127.0.0.1:1234")

startTime = time.time() 
for i in range(10):
    msg = "msg %s" % i
    socket.send("hello")
    msg_in = socket.recv()

print 'That took ', time.time()-startTime, 'seconds' 
```

10 条消息大约需要 1 秒，所以我的问题是为什么这么慢？如果我在 python 中构建 REP，它真的很快，所以我指责 Akka zeromq 绑定。

额外信息：我正在使用 Scala 2.9.2 和最新的 Akka 2.0.3（但也尝试使用 2.0.2）

# symfony - 从 symfony2 中的 Doctrine 实体 yml 或 Xml 创建或构建 UML 模式

> ID：12096203
> 
> 赞同：3
> 
> 时间：2012-08-23T16:27:44.387
> 
> 标签：symfony, uml

我在我的 symfony 项目中生成了所有实体，我可以有任何想法或解决方案或软件来从我的项目（xml 或 yml）上生成的学说实体创建或重新生成 UML 模式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-01-04T08:18:31.630

看看这个解决方案：[https ://packagist.org/packages/onurb/doctrine-yuml-bundle](https://packagist.org/packages/onurb/doctrine-yuml-bundle)

这是一个 symfony 包，它会为你提供控制台命令

```
bin/console yuml:mappings 
```

并会写一个图像`yuml-mapping.png`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T11:08:25.530

所以为了解决这个问题，我使用[uml 的可视化范例](http://www.visual-paradigm.com/product/vpuml/)，这个软件不是免费的，它需要激活密钥。但是它提供了直接到你的数据库的连接，只需按照“工具 => 数据库 => 反向数据库，然后你创建您的“实体关系图”，最后只需在ERD页面上用鼠标右键单击并选择“同步到类图”，您将自动拥有您的类图，最后您可以添加您的setter和getter，也您可以将其导出为多种格式（XML、Xls...）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T17:55:49.040

使用免费工具，一种方法是使用命令

```
phpuml -x 1 -o C:\symfony\httpfoundation.xmi C:\symfony\vendor\symfony\src\Symfony\Component\HttpFoundation 
```

（这是从 symfony 源代码生成模式的示例）

然后使用 BoUml Viewer 或 ArgoUML 查看生成的文件。

我尝试了其他方法来做到这一点，但没有一个能给出好的结果......

我发现（并且我使用的）最好的方法是使用 Sparx Systems - Enterprise Architect，但你必须为此付费:(

无论如何，如果你找到另一种工作方式来做到这一点，我很感兴趣:)

最好的问候，克里斯托夫

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-14T08:59:49.513

查看[ORM 设计器](http://www.orm-designer.com/)。如果您不介意它的付费软件，它可以完全满足您的需求。您可以使用它在可视化环境中为您的项目编辑架构，并从可视化架构生成您的 XML/YML 定义。

# php - Symfony2 和 Blueimp jQuery-File-Upload：在哪里设置“server/php”目录

> ID：12096204
> 
> 赞同：5
> 
> 时间：2012-08-23T16:27:46.513
> 
> 标签：php, jquery, file-upload, symfony, blueimp

我将使用[Blueimp jQuery-File-Upload](https://github.com/blueimp/jQuery-File-Upload/wiki/Basic-plugin)库的基本版本进行文件上传。在 PHP 框架中，这个 Javascript 库依赖于 PHP 类“index.php”的执行，该类位于“server/php”目录中。如[教程页面](https://github.com/blueimp/jQuery-File-Upload/wiki/Basic-plugin)所示，“动作”必须指向该目录。

在**Symfony2**应用程序中使用这个库时，**“server/php”目录应该放在**哪里？**我应该使用哪条路径**？在实践中如何让它工作？

PS：我知道有一些 Symfony2 捆绑包，比如*Punkave 的*“symfony2-file-uploader-bundle”，但是教程中有一些东西我遗漏了，我不想重复使用 Symfony2 表格-

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T11:50:36.660

我会将 jquery 插件内容放入`web/bundles/<your bundle name>/js/jquery-file-upload`. 然后我会配置脚本（检查[选项](https://github.com/blueimp/jQuery-File-Upload/wiki/Options)配置）以在以下位置查找 index.php 文件：`/bundles/<your bundle name>/js/jquery-file-upload/server/php/index.php`.

当然，您必须修改该 index.php 文件以检查用户是否已登录以及他是否具有正确的权限。

例如，这是我在测试环境中所做的：

我将此操作添加到控制器：

```
/**
 * @Route("/test/jquery-file-upload")
 * @Template("<your bundle name>:Default:test-jquery-file-upload.html.twig")
 */
public function testJqueryFileUploadAction()
{
    return array();
} 
```

我创建了这个模板：

```
<input id="fileupload" type="file" name="files[]" data-url="{{ asset('bundles/<your bundle name>/jquery-file-upload/server/php/index.php') }}" multiple>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<script src="{{ asset('bundles/<your bundle name>/jquery-file-upload/js/vendor/jquery.ui.widget.js') }}"></script>
<script src="{{ asset('bundles/<your bundle name>/jquery-file-upload/js/jquery.iframe-transport.js') }}"></script>
<script src="{{ asset('bundles/<your bundle name>/jquery-file-upload/js/jquery.fileupload.js') }}"></script>
<script>
$(function () {
    $('#fileupload').fileupload({
        dataType: 'json',
        done: function (e, data) {
            $.each(data.result, function (index, file) {
                $('<p/>').text(file.name).appendTo(document.body);
            });
        }
    });
});
</script> 
```

# java - JDBC 连接池的设置随一天中的时间而变化

> ID：12096210
> 
> 赞同：2
> 
> 时间：2012-08-23T16:28:05.510
> 
> 标签：java, jdbc, persistence, connection-pooling

在配置像 Apache Commons DBCP 这样的连接池库时，许多设置取决于预期的性能特征。许多 Java 应用程序（Web 前端或后端）具有不同的性能特征，具体取决于一天中的时间。是否有类似 DBCP 的 BasicDataSource 的实现，除了它可以根据一天中的时间有不同的配置文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:28:38.127

将其配置为最大连接数是最好的选择，但显然您不想这样做。

另一种选择是让您以编程方式“管理配置文件”。DBCP 可以通过编程方式进行配置，因此您可以根据一天中的时间创建/删除连接配置文件。

# java - Jackson - 将属性序列化/反序列化为 JSON 值

> ID：12096216
> 
> 赞同：8
> 
> 时间：2012-08-23T16:28:24.893
> 
> 标签：java, json, jackson

使用 Jackson 2，我正在寻找一种将对象序列化为单个值的**通用**方法（然后将它们序列化回稍后仅填充该单个字段），而不必重复创建 JsonSerializer / JsonDeserializer 来处理每种情况。@JsonIdentityInfo 注释非常接近，但有点错过标记，因为据我所知，它总是会在第一次出现时序列化完整的子对象。

这是我想做的一个例子。给定课程：

```
class Customer {

    Long id = 99;
    String name = "Joe"; 
    // Lots more properties
}

class Order {
    String orderNum = "11111"
    @WhateverAnnotationsINeedHereToDoWhatIWant
    Customer customer;
} 
```

我希望 Order 序列化为任一（我完全可以接受）：

```
{"orderNum":"11111", "customer":"99"}
{"orderNum":"11111", "customer":{"id":99}} 
```

@JsonIdentityInfo 所做的事情使得在客户端处理起来更加困难（我们可以假设客户端知道如何将客户 ID 映射回完整的客户信息）。

@JsonIgnoreProperties 对于显示的第二个 JSON 也可能非常接近，但这意味着我必须选择退出除我想要的那个之外的**所有内容。**

当我反序列化时，我只想使用“id”字段初始化客户。

有什么神奇的方法可以做到这一点，而无需深入杰克逊的汤底？据我所知，JsonDeserializer/JsonSerializer 没有关于父级的上下文信息，因此似乎没有一种简单的方法来创建 @JsonValueFromProperty("id") 类型的 Jackson Mix-in 然后只需查看该注释自定义序列化器/反序列化器。

任何想法将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T18:02:25.987

我曾经需要对每个不同类型的请求返回的 JSON 进行细粒度控制，恐怕我最终使用了自定义序列化器和反序列化器。

一个简单的替代方法是将@JsonIgnore 添加到 Order 的 Customer 字段，并将以下 getter 添加到 Order：

```
@JsonProperty("customer")
public Long getCustomerId(){
  if (customer != null){
    return customer.getId();
  }
  else {
    return null;
  }
} 
```

返回的 JSON 将是：

```
{"orderNum":"11111", "customer":"99"} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T18:57:17.253

另一种可能性是`@JsonValue`在 id 字段上使用 , 。

Jackson 2.1 将添加一项功能，以强制将强制引用序列化为 id（通过新属性“firstAsId” for `@JsonIdentityInfo`）。这可能不适用于所有情况的反序列化，但可能对您有用。

# cocoa - 带有 NSRegularExpression 的 OSX 10.6 Snow Leopard 上的 RestKit 部署问题

> ID：12096218
> 
> 赞同：0
> 
> 时间：2012-08-23T16:28:30.633
> 
> 标签：cocoa, restkit, nsregularexpression

我遇到了这个问题，我的基于 RestKit(master) 的应用程序无法在 OSX 10.6 上运行。我不断收到以下错误：

```
Dyld Error Message:
Symbol not found: _OBJC_CLASS_$_NSRegularExpression
Referenced from: something/something/../Frameworks/RestKit.framework/Versions/A/RestKit
Expected in: /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation
in /Users/something/something    Client.app/Contents/MacOS/../Frameworks/RestKit.framework/Versions/A/RestKit 
```

我的开发环境是 10.8 上的 Xcode 4.4，基础 SDK 设置为 10.8，并将目标部署到 10.6。我查看了引用 NSRegularExpression 的 Restkit（仅在 10.7 或更高版本上可用），它都包含有版本检查，例如：

```
#if __MAC_OS_X_VERSION_MAX_ALLOWED >= 1070 || __IPHONE_OS_VERSION_MAX_ALLOWED >= 40000
#endif 
```

我认为这应该处理版本问题？但结果是我的应用程序只能在 10.7 或更高版本上运行，而不能在 10.6 上运行。

我下载了 Xcode 4.3.3 并将 10.6 sdk 复制到我当前的 Xcode。我尝试将基础 SDK 的发布目标设置为 10.6，但它也无济于事。

有人可以对此有所了解吗？谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T07:09:59.237

NSRegularExpression[在 OS X v10.7 及更高版本中可用](https://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T01:09:56.970

好吧，我并没有真正得到解决方案。__MAC_OS_X_VERSION_MAX_ALLOWED 仅检查您的基础 SDK，因此在我的情况下，尽管我的部署目标设置为 10.6，但它始终使用 NSRegularExpression。

我最终对 if 语句进行了一些更改，以便它始终跳过 NSRegularExpression 调用。

你可以做这样的事情来解决它：

```
#if __MAC_OS_X_VERSION_MAX_ALLOWED < -1 || __IPHONE_OS_VERSION_MAX_ALLOWED >= 40000
#endif 
```

# ruby-on-rails - 使用 ckeditor rails gem 时，如何向 ckeditor_assets 表添加一个附加字段？

> ID：12096219
> 
> 赞同：1
> 
> 时间：2012-08-23T16:28:30.737
> 
> 标签：ruby-on-rails, ckeditor

根据[CKEditor gem 的自述文件](https://github.com/galetahub/ckeditor#default-scope)，我应该能够为图像和附件设置替代范围。我试图这样做，它只是将其转换为 ckeditor_assets 表中的一个字段。

我可以创建迁移以添加必填字段，但是如何配置 ckeditor（可能是通过自动生成的模型）以便在创建新记录时使用正确的数据填充该字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T11:14:17.530

解决了。

我使用 before_save 过滤器来设置我想要的字段。然后在应用程序控制器中更改方法以将该字段用作范围。

```
# models/ckeditor/asset.rb

before_save :set_company_id

def set_company_id
  self.company_id = assetable.try(:company_id)
end

# controllers/application_controller.rb

protected

def ckeditor_pictures_scope(options = { :company_id => "#{company_id}" })
  ckeditor_filebrowser_scope(options)
end

def ckeditor_attachment_files_scope(options = { :company_id => "#{company_id}" })
  ckeditor_filebrowser_scope(options)
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-23T10:45:45.963

我认为最简单的解决方案：

```
#controllers/application_controller.rb
protected

def ckeditor_pictures_scope(options = { :assetable_id => "#{current_page.id}" ,:assetable_type => "Page" })
  ckeditor_filebrowser_scope(options)
end

def ckeditor_attachment_files_scope(options = { :assetable_id => "#{current_page.id}" ,:assetable_type => "Page" })
  ckeditor_filebrowser_scope(options)
end

def ckeditor_before_create_asset(asset)
  asset.assetable = current_page if current_page
  return true
end 
```

# python - tdd 的第一步

> ID：12096221
> 
> 赞同：4
> 
> 时间：2012-08-23T16:28:52.530
> 
> 标签：python, unit-testing, tdd

我目前正在一个爱好项目上尝试测试驱动开发的过程，虽然我确实理解这个概念（首先编写你的单元测试，观察它失败，让它工作，重构你的代码）我仍然有一些问题。

我正在从事的项目是 Python 中的 MUD 客户端。现在我正忙于实现 telnet 协议。（我知道 Python 中已经有一个 telnetlib 或 Twisted 中的实现，但这不是重点）

现在我有一个 TelnetHandler 类，它实现了 Telnet 协议（或至少它的一部分）和各种单元测试。因为它们相当大，所以它们在 pastebin 上：[TelnetHandler](http://pastebin.com/DTBt1PYM)和[单元测试](http://pastebin.com/FdKyi6d6)

我现在的问题如下：

*   许多测试相互依赖：例如，如果`test_handle_read`测试失败，那么许多其他测试也会失败。
*   在`TelnetOptionsTests`我添加了我的类应该调用的方法以检查它们是否被调用（各种`local_option_enabled`方法）。现在，我的课堂上没有这些方法。我应该添加单元测试只是为了检查它们的存在吗？
*   当我开始编写测试时，我将`handle_read`方法更改为也解析 telnet 命令。之后，一旦我完成了我的测试，我就将它们分成了`handle_read`各种`_handle_do`,`_handle_dont`等等`handle_read`... 这是正确的方法，还是在将方法拆分为不同方法时编写单元测试也是一种好习惯？

基本上，我要问的是各种可以帮助我提高单元测试技能的提示和指针。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T15:13:32.980

> 许多测试相互依赖：例如，如果 test_handle_read 测试失败，那么许多其他测试也会失败。

不要这样做。在每个测试开始时，把世界扔掉，然后按照测试运行的方式重新创建它。

> 当我开始编写测试时，我更改了 handle_read 方法来解析 telnet 命令。之后，一旦我完成了测试，我将 handle_read 拆分为各种 _handle_do、_handle_dont 等……但是我没有对这些进行单元测试，因为它们正在原始的 handle_read 中进行测试。这是正确的方法，还是在将方法拆分为不同方法时编写单元测试也是一种好习惯？

这取决于。当您拆分时，您是拆分成不同的公共方法，还是它们是处理实现的私有方法。

# sql - 如何在 Rails 中通过关联设置此范围？

> ID：12096224
> 
> 赞同：0
> 
> 时间：2012-08-23T16:29:07.527
> 
> 标签：sql, ruby-on-rails-3, unit-testing, scope, associations

我在编写和测试涉及几个联接和关联的范围时遇到了麻烦。我会尽量保持我的解释简短但尽可能彻底。

我有以下关联：

`ExpertTopic > Topic > Articles > Posts`

和以下代码：

```
class Topic < ActiveRecord::Base
  has_many :articles, :order => "position", :dependent => :destroy
  has_many :posts, :through => :articles

  has_many :expert_topic, :dependent => :delete_all
  has_many :experts, :through => :expert_topic
end 
```

和：

```
class ExpertTopic < ActiveRecord::Base
  belongs_to :topic, :inverse_of => :expert_topic
  belongs_to :expert, :inverse_of => :expert_topic

  scope :live, joins(:topic => {:articles => :post})
    .where("topics.article_count > ? AND posts.live = ?", 0, true)
end 
```

**在 中的`live`范围内`ExpertTopic`，我试图缩小到与主题相关的那些专家，其中包含所有实时帖子（通过文章）。**

在 Rails 控制台`ExpertTopic.live.to_sql`中是：

```
"SELECT `experts_topics`.* FROM `experts_topics` INNER JOIN 
`topics` ON `topics`.`id` = `experts_topics`.`topic_id` INNER JOIN
`articles` ON `articles`.`topic_id` = `topics`.`id` INNER JOIN
`posts` ON `posts`.`id` = `articles`.`post_id` WHERE
(topics.article_count > 0 AND posts.live = 1)" 
```

我正在使用以下代码测试我的范围`expert_topic_spec.rb`：

```
describe ExpertTopic do
  before do
    @post1 = FactoryGirl.create(:pending_post)
    @post2 = FactoryGirl.create(:live_post)
    @post3 = FactoryGirl.create(:pending_post)
    @post4 = FactoryGirl.create(:live_post)
    @non_live_topic = FactoryGirl.create(:topic_with_posts, :posts => [@post1, @post2, @post3])
    @live_topic = FactoryGirl.create(:topic_with_posts, :posts => [@post2, @post4])
    FactoryGirl.create(:expert_topic, topic_id: @non_live_topic.id)
    FactoryGirl.create(:expert_topic, topic_id: @live_topic.id)
  end

  it 'finds and returns only expert with live topic' do
    ExpertTopic.all.count.should == 2
    ExpertTopic.live.uniq.count.should == 1
  end
end 
```

**逻辑是，由于`@non_live_topic`至少包含一个未发布的帖子，因此它不被视为实时发布，因此不应通过调用`ExpertTopic.live`. 但是，最后一个断言失败，因为`ExpertTopic.live.uniq.count`返回`2`而不是`1`.**

我不知道我的范围是写错了还是我的测试，我真的很感谢有人在调试方面的帮助！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:40:39.173

你写了：

> 逻辑是，由于@non_live_topic 至少包含一篇未发布的帖子，因此不被视为实时发布

这是不正确的。该`live`范围不排除`ExpertTopic`与非实时帖子相关联的 s。它仅包含`ExpertTopic`与一个或多个实时帖子相关联的 s。这意味着如果实时和非实时帖子都关联，它将被包括在内。

要将范围更改为您期望的逻辑，您需要使用排除子句，例如：

```
scope :live, lambda {
    non_live_sql = joins(:topic => {:articles => :post})
      .where("topics.article_count > ? AND posts.live = ?", 0, false)
      .select('expert_topics.id').to_sql
    joins(:topic).where("topics.article_count > ? AND expert_topics.id NOT IN (#{non_live_sql})", 0)
} 
```

SQL 中还有其他方法可以排除项目，但这可能是在 Rails 中构建的最简单的方法，无需涉及 Squeel 等 DSL 或手动编写大型查询。

# sql - 如何进行 sql 查询来构建树？

> ID：12096227
> 
> 赞同：2
> 
> 时间：2012-08-23T16:29:19.397
> 
> 标签：sql, ms-access, ado.net, treeview

> **可能重复：**
> [如何在数据库中存储目录/层次结构/树结构？](https://stackoverflow.com/questions/144344/how-to-store-directory-hierarchy-tree-structure-in-the-database)

我使用这个查询：

```
SELECT Id, Name, ParentId
FROM Table_1 
```

然后我使用所有元素构建树。

但是如果我想构建一个从 definite 开始的树怎么办`Id`，所以我需要做一个查询，只返回这个`Id`和这个的所有孩子`Id` 像这样：

```
SELECT Id, Name, ParentId
FROM Table_1
WHERE (Id = randomNumber) OR (all possible childs of Id = randomNumber) 
```

请帮我查询。

编辑：

这就是你如何在 Oracle 中实现它

```
SELECT Id, Name, ParentId
FROM table_1
Connect by prior Id = ParentId
Start with Id = randomNumber 
```

我需要 MS-Access

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T18:26:06.093

试试这个，我希望这是你要找的：

```
DECLARE @ID int

SET @ID = 1;

WITH CTE_Table_1
(
 ID,
 Name,
 ParentID,
 TreeLevel
)
AS(
  SELECT 
   ID,
   Name,
   ParentID,
   0 AS TreeLevel
  FROM Table_1
  WHERE ID = @ID

  UNION ALL

  SELECT 
   T.ID,
   T.Name,
   T.ParentID,
   TreeLevel + 1
  FROM Table_1 T
  INNER JOIN CTE_Table_1 ON CTE_Table_1.ID = T.ParentID
)

SELECT * FROM CTE_Table_1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:31:56.763

您可以加入表格本身，将父 ID 链接到子 ID

```
SELECT T1.Id, T1.Name, T2.Id, T2.Name
FROM   Table_1 as T1
JOIN   Table_1 as T2 on T1.Id = T2.ParentId 
```

鉴于数据

```
Id, Name       ParentId
1,  Top,        null
2,  ChildOne,   1
3,  ChildTwo,   1
4,  ChildThree, 1 
```

这会给你一个像

```
1,   Top,    2, ChildOne
1,   Top,    3, ChildTwo
1,   Top,    4, ChildFour 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T16:33:07.807

你快到了，这应该可以解决问题

```
SELECT Id, Name, ParentId 
FROM Table_1 
WHERE (Id = randomNumber) OR (ParentId = randomNumber) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T23:02:29.150

如相关文章所述，这不能单独使用 SQL 完成，但是可以使用 SQL 和 VBA 的组合相对容易地完成。

目标是指定`Id`返回该记录及其所有子项。因此，您只需要一个布尔函数，当该行`Id`是指定祖先的直接后代时返回 true。

您的 SQL 将是：

```
SELECT Id, Name, ParentId
FROM Table_1
WHERE IsDescendant(Id, randomNumber); 
```

Access 中的 VBA 函数为：

```
Public Function IsDescendant(id As Integer, relative As Integer) As Boolean
    Dim currentID As Variant
    currentID = id

    Do Until IsNull(currentID)
        If (currentID = relative) Then
            IsDescendant = True
            Exit Function
        End If
        currentID = DLookup("ParentId", "Table_1", "Id=" & currentID)
    Loop
    IsDescendant = False
End Function 
```

就性能而言，这可能不是最好的，因为我使用过，但如果要获得显着的性能提升，`DLookup`我们也可以使用对象。`RecordSet`这只是我能记下的最快的代码。

# python - 使用 python 图像库从网络打开图像

> ID：12096235
> 
> 赞同：0
> 
> 时间：2012-08-23T16:29:45.163
> 
> 标签：python

我是 python 新手，正在使用 python 图像库。我只想能够从网上打开一张图片并从这张图片中获取直方图。不幸的是，我得到了错误`File "new.py", line 1 from PIL import Image import urllib`并且它不起作用。知道如何让它工作吗？

```
from PIL
import Image
import urllib

im = Image.open(urllib.urlopen("http://fmforums.com/forum/uploads/profile/photo-thumb-57725.jpg"))
im = im.convert("P")

print im.histogram() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:36:09.663

错误出现在程序的前两行。

```
from PIL
import Image 
```

应该

```
from PIL import Image 
```

有关在 python 中导入的更多信息，请参见[此处](http://www.effbot.org/zone/import-confusion.htm)。

# c# - 雅虎老板 API 查询

> ID：12096239
> 
> 赞同：0
> 
> 时间：2012-08-23T16:30:03.403
> 
> 标签：c#, metadata, yahoo, yahoo-api, yahoo-boss-api

我正在使用 C# 调用 Yahoo Boss API 并检索元数据，例如从 url 打开图形信息。在考虑任何元标记之前，我只是在 url 中查询一个单词：

```
var uri = new Uri("http://yboss.yahooapis.com/ysearch/web?q=Besieged&format=json&url=http://www.nytimes.com/2012/08/24/business/global/chinas-economy-besieged-by-buildup-of-unsold-goods.html"); 
```

在上面的查询中，我在 url 引用的网页上查询 Besieged 这个词，但是它没有给出任何结果。

关于如何构建检索 url 元数据的 Yahoo Boss 查询的任何建议？

谢谢！

# amazon-ec2 - 通过 instance-id 获取实例

> ID：12096241
> 
> 赞同：10
> 
> 时间：2012-08-23T16:30:04.347
> 
> 标签：amazon-ec2, boto

我需要通过 instance-id 获取实例，是否可以在不请求所有实例列表的情况下做到这一点？

我试过了：

```
ec2_conn = boto.connect_ec2(aws_access_key_id=key, aws_secret_access_key=access)
c2.get_all_instances([instanceId]) 
```

它可以工作，但是还有其他方法可以获取实例吗？

我问的原因是我收到`UnauthorizedOperation`了`get_all_instances`请求，所以我更愿意更改请求，而不是安全设置。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-25T16:23:37.800

自 OP 提出问题以来，也许`boto`已经发展，但这值得在这里添加最新的答案：

```
reservations = ec2conn.get_all_instances(instance_ids=['i-12345678'])
instance = reservations[0].instances[0] 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-24T13:12:22.663

你可以试试

```
reservations = ec2_conn.get_all_instances(filters={'instance-id' : 'i-xxxxxxxx'})
new_instance = reservations[0].instances[0] 
```

它肯定会奏效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-16T20:35:19.193

```
instances = get_only_instances(instance_ids=['i-12345678']) 
```

关于使用上述答案

```
get_all_instances() 
```

，来自[BOTO API](http://boto.readthedocs.org/en/latest/ref/ec2.html#boto.ec2.connection.EC2Connection.get_all_instances) --

```
get_all_instances() is deprecated in favor of get_all_reservations(). 

A future major release will change get_all_instances() to return a list of 
boto.ec2.instance.Instance objects as its name suggests. 
To obtain that behavior today, use get_only_instances(). 
```

# php - PHP 嵌套 if/else 逻辑

> ID：12096244
> 
> 赞同：-3
> 
> 时间：2012-08-23T16:30:22.140
> 
> 标签：php, if-statement

> 解析错误：语法错误，意外的 T_ELSE

```
<?php
    require_once('config.php');

    //error_reporting(0);
    if (isset($_POST['submitted'])) {

        $username =$_POST['username'];
        $password=$_POST['password'];

        $ldap = ldap_connect("localserv1.local.local.edu", 389) or exit("Error connecting to LDAP server.");

        //Settings for AD
        ldap_set_option($ds, LDAP_OPT_PROTOCOL_VERSION, 3);
        ldap_set_option($ds, LDAP_OPT_REFERRALS, 0);

        //Check if user can access LDAP
        if ($bind = ldap_bind($ldap, 'local\\'.$username, $password)) {
            //Prep SQL statement
            if ($stmt = $mysqli->prepare("SELECT username FROM table WHERE username = ?")) {
                $stmt->bind_param('s', $username);
                $stmt->execute();
                $stmt->store_result();

                // Check if the username is in table
                if ($stmt->num_rows > 0) {

                    // Log them in
                    session_register("username");
                    session_register("password");
                    header("Location: https://" . $_SERVER['HTTP_HOST'] . substr($_SERVER['REQUEST_URI'], 0, -9) . "index.php" );
                    exit;

                } else {
                    //User is not in table
                    echo('<p class="error">You are not authorized to view this application.</p><div class="clear"></div>');
            } else {
                    // SQL syntax error
                    printf("Prep statment failed: %s\n", $mysqli->error);
        } else {
                    // Invalid LDAP user/pass
                    echo('<p class="error">Invalid username or password.</p><div class="clear"></div>');
                }
            }
        }
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:33:54.297

你应该更加小心你的括号。试试这个：

```
<?php

require_once('config.php');

//error_reporting(0);
if (isset($_POST['submitted'])) {

    $username = $_POST['username'];
    $password = $_POST['password'];

    $ldap = ldap_connect("localserv1.local.local.edu", 389) or exit("Error connecting to LDAP server.");

    //Settings for AD
    ldap_set_option($ds, LDAP_OPT_PROTOCOL_VERSION, 3);
    ldap_set_option($ds, LDAP_OPT_REFERRALS, 0);

    //Check if user can access LDAP
    if ($bind = ldap_bind($ldap, 'local\\' . $username, $password)) {
        //Prep SQL statement
        if ($stmt = $mysqli->prepare("SELECT username FROM table WHERE username = ?")) {
            $stmt->bind_param('s', $username);
            $stmt->execute();
            $stmt->store_result();

            // Check if the username is in table
            if ($stmt->num_rows > 0) {

                // Log them in
                session_register("username");
                session_register("password");
                header("Location: https://" . $_SERVER['HTTP_HOST'] . substr($_SERVER['REQUEST_URI'], 0, -9) . "index.php");
                exit;
            } else {
                //User is not in table
                echo('<p class="error">You are not authorized to view this application.</p><div class="clear"></div>');
            }
        } else {
            // SQL syntax error
            printf("Prep statment failed: %s\n", $mysqli->error);
        }
    } else {
        // Invalid LDAP user/pass
        echo('<p class="error">Invalid username or password.</p><div class="clear"></div>');
    }
}
?> 
```

**提示：**为避免将来发生这种情况，请先写括号*，*然后将代码放在括号内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:34:27.103

这里的`else`声明：

```
} else {
    //User is not in table
    echo('<p class="error">You are not authorized to view this application.</p><div class="clear"></div>'); 
```

它没有关闭 - 您需要一个额外的闭合支架。事实上，在下面的 else 中也是如此——你应该正确地缩进代码，这种事情更容易被发现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-17T13:45:16.847

部分问题可能是难以阅读夹在行首和行尾的花括号。我知道这被认为是一种有效的风格，毫无疑问，经验丰富的眼睛能够轻松阅读它，但下面的布局使事情更加明显——代价是增加了一些空白行。很容易看出哪个 if 和 which else 匹配并且很容易发现是否有一个错位或悬空的花括号 - 我记得 2013 年的安全问题。

```
if (some condition)    
   {    
   if (another condition)
      {
      if (yet another condition)
         {
         things to do if some condition, another condition, and yet another condition are met
         }
      else
         {
         things to do if if some condition and another condition are met and yet another condition is not met 
         }
      }    
   else
      {
      list of things to do if some condition is met but if another condition is not met
      } 
   }
else    
   {
   list of things to do if some condition is not met
   } 
```

# java - google checkout 退回商品不可用

> ID：12096245
> 
> 赞同：0
> 
> 时间：2012-08-23T16:30:44.813
> 
> 标签：java, android, google-checkout

我正在将 google checkout 与我的 android 应用程序集成。

我已经使用 android.test.purchased 成功测试了计费流程。

但是在上传apk（尚未发布但已签名）并创建产品列表（产品尚未发布）后，我在尝试购买商品时收到**“您请求的商品不可购买” 。**在日志中我可以看到响应代码 RESPONSE_ITEM_UNAVAILABLE。谷歌文档说这个错误代码

> “表示 Google Play 无法在应用程序的产品列表中找到请求的项目。如果产品 ID 在您的 REQUEST_PURCHASE 请求中拼写错误，或者某个项目未在应用程序的产品列表中发布，则可能会发生这种情况。”

我已经检查了两次 - 该项目已发布并且拼写正确。而且我在我的设备上运行相同版本的apk，提前上传感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T09:08:53.763

发布应用程序后，结帐开始工作。只是想知道为什么他们在文档中添加了不需要发布应用程序而是发布产品的文档。

# windows-8 - 试图获取 Horizo ntalOffset，总是返回 0

> ID：12096250
> 
> 赞同：0
> 
> 时间：2012-08-23T16:31:02.237
> 
> 标签：windows-8, windows-runtime, scroll, winrt-xaml, dependency-properties

我正在使用 C#/xaml 为 Windows8 Metro 编写应用程序。

我有一个 Scrollviewer，想获得水平偏移量。

我用这个试过：

```
private void ScrollViewer_ViewChanged_1(object sender, ScrollViewerViewChangedEventArgs e)
    {
        int i = Convert.ToInt32(GetValue(ScrollViewer.HorizontalOffsetProperty));
    } 
```

但我始终为 0，尽管在调试器中它显示我的偏移量为 221.09，我向下滚动！

迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:46:44.680

如果您向下滚动 - 除非您水平滚动，否则您的水平偏移不会改变。

也许您的事件处理程序不在 ScrollViewer 本身上，如果是这种情况 - 您需要在 SV 本身上调用 GetValue，例如

```
private void ScrollViewer_ViewChanged_1(object sender, ScrollViewerViewChangedEventArgs e)
{
    int i = Convert.ToInt32(myScrollViewer.GetValue(ScrollViewer.HorizontalOffsetProperty));
} 
```

或者更好的是这样做：

```
private void ScrollViewer_ViewChanged_1(object sender, ScrollViewerViewChangedEventArgs e)
{
    int i = Convert.ToInt32(myScrollViewer.HorizontalOffset);
} 
```

# python - 使用值列表从 Pandas 数据框中选择行

> ID：12096252
> 
> 赞同：1053
> 
> 时间：2012-08-23T16:31:12.237
> 
> 标签：python, pandas, dataframe

假设我有以下 Pandas 数据框：

```
df = DataFrame({'A' : [5,6,3,4], 'B' : [1,2,3, 5]})
df

     A   B
0    5   1
1    6   2
2    3   3
3    4   5 
```

我可以根据特定值进行子集化：

```
x = df[df['A'] == 3]
x

     A   B
2    3   3 
```

但是如何根据值列表进行子集化？- 像这样：

```
list_of_values = [3,6]

y = df[df['A'] in list_of_values] 
```

要得到：

```
 A    B
1    6    2
2    3    3 
```

* * *

## 回答 #1

> 赞同：1806
> 
> 时间：2012-08-23T19:20:12.243

您可以使用以下[`isin`](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.isin.html)方法：

```
In [1]: df = pd.DataFrame({'A': [5,6,3,4], 'B': [1,2,3,5]})

In [2]: df
Out[2]:
   A  B
0  5  1
1  6  2
2  3  3
3  4  5

In [3]: df[df['A'].isin([3, 6])]
Out[3]:
   A  B
1  6  2
2  3  3 
```

并获得相反的用途`~`：

```
In [4]: df[~df['A'].isin([3, 6])]
Out[4]:
   A  B
0  5  1
3  4  5 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2021-05-03T05:07:56.943

您可以使用方法[查询](http://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html#pandas.DataFrame.query)：

```
df.query('A in [6, 3]')
# df.query('A == [6, 3]') 
```

或者

```
lst = [6, 3]
df.query('A in @lst')
# df.query('A == @lst') 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2021-05-24T15:08:01.140

另一种方法；

```
df.loc[df.apply(lambda x: x.A in [3,6], axis=1)] 
```

与[isin](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.isin.html)方法不同，这在确定列表是否包含 column 的函数时特别有用`A`。例如，`f(A) = 2*A - 5`作为函数；

```
df.loc[df.apply(lambda x: 2*x.A-5 in [3,6], axis=1)] 
```

需要注意的是，这种方法比`isin`方法慢。

# c# - 如何将 .Net 对象存储到 SQL Server 中？

> ID：12096256
> 
> 赞同：0
> 
> 时间：2012-08-23T16:31:23.970
> 
> 标签：c#, asp.net, sql-server

我正在尝试存储一个充满属性和字段的 C# 类。如何将该类存储到 SQL Server 2008 中。

有人可以帮忙吗？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T16:36:05.653

有许多不同的方法，这取决于您想如何再次取出该对象。如果没有更多信息，我们将无能为力。

1.  您可以使用实体框架将对象映射到数据库表。然后，每个属性将对应一个表列。
2.  您可以序列化对象并存储在数据库表的单个列中 - 序列化为 xml、json 或二进制 blob。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T16:44:21.117

将对象表示为模式的正确方法：一个或多个表示对象及其对象图的相关表：属性、子类型和引用类型。这使您可以将存放的对象作为 SQL 数据进行查询，并将其用于其他目的（例如，报告）。

或者，您可以*序列化*对象实例。您可以通过`[Serializable]`属性以声明方式执行此操作。您可以通过实现`ISerializable`接口并将其序列化为二进制、JSON 或您选择的其他一些表示形式来实现自己的功能。

您可以通过使用 XML 序列化属性或实现`IXmlSerializable`.

或者您可以忽略对此类内容的内置支持并以您自己的方式对其进行序列化。

将其序列化为 a后，您可以根据其序列化方式将其`Stream`存放在适当类型（`varbinary(max)`或）列中。`varchar(max)`

第三种选择是创建[CLR 用户定义类型](http://technet.microsoft.com/en-us/library/ms131120.aspx)并将程序集安装在 SQL Server 中。我不确定我是否建议将其作为“最佳实践”

# javascript - 在表格单元格中查找超链接

> ID：12096257
> 
> 赞同：0
> 
> 时间：2012-08-23T16:31:34.220
> 
> 标签：javascript, jquery, jquery-ui

我有一个包含一些数据的表，最后一列有一个表中所有行的超链接。我需要在单击超链接时打开一个对话框。

```
<table id="tableId">
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td><a href="">edit</a></td>
</tr>
</table>

$("#tableId tr a[href]").on("click", function() {
   console.log("Hello World");
   $("<div></div>).dialog({});
}); 
```

我的控制台没有显示 hello world 可能是 jquery 代码中的一些错误

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:34:41.817

缺少结束语`"<div></div>"`

```
 $("<div></div>").dialog({}); 
```

**[现场演示](http://jsfiddle.net/rajaadil/Mh5hq/)**

`#`最好像这样在href中给出哈希，

```
<a href="#">edit</a> 
```

你的代码是

```
$("#tableId tr a[href]").on("click", function() {
   console.log("Hello World");
   $("<div></div>).dialog({});
   return false; 
}); 
```

# node.js - 如何保护 Mongoose/MongoDB 中的密码字段，以便在我填充集合时它不会在查询中返回？

> ID：12096262
> 
> 赞同：101
> 
> 时间：2012-08-23T16:31:43.493
> 
> 标签：node.js, mongodb, express, mongoose

假设我有两个集合/模式。一个是带有用户名和密码字段的用户架构，然后，我有一个博客架构，它在作者字段中引用了用户架构。如果我使用猫鼬做类似的事情

```
Blogs.findOne({...}).populate("user").exec() 
```

我也会填充博客文档和用户，但是如何防止 Mongoose/MongoDB 返回密码字段？密码字段经过哈希处理，但不应返回。

我知道我可以省略密码字段并在一个简单的查询中返回其余字段，但是我如何使用填充来做到这一点。另外，有什么优雅的方法可以做到这一点吗？

此外，在某些情况下，我确实需要获取密码字段，例如当用户想要登录或更改密码时。

* * *

## 回答 #1

> 赞同：345
> 
> 时间：2012-08-23T17:17:27.410

[`select`](http://mongoosejs.com/docs/api.html#schematype_SchemaType-select)您可以使用字段的属性在架构定义级别更改默认行为：

```
password: { type: String, select: false } 
```

然后您可以根据需要将其拉入`find`并`populate`通过字段选择调用`'+password'`. 例如：

```
Users.findOne({_id: id}).select('+password').exec(...); 
```

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2012-08-23T22:21:03.717

```
.populate('user' , '-password') 
```

[http://mongoosejs.com/docs/populate.html](http://mongoosejs.com/docs/populate.html)

JohnnyHKs 使用模式选项回答可能是这里的方法。

另请注意，`query.exclude()`仅存在于 2.x 分支中。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2012-08-23T18:27:04.827

编辑：

在尝试了这两种方法之后，我发现由于某种原因使用本地护照策略，总是排除方法对我不起作用，我真的不知道为什么。

所以，这就是我最终使用的：

```
Blogs.findOne({_id: id})
    .populate("user", "-password -someOtherField -AnotherField")
    .populate("comments.items.user")
    .exec(function(error, result) {
        if(error) handleError(error);
        callback(error, result);
    }); 
```

始终排除方法没有任何问题，只是由于某种原因它不适用于护照，我的测试告诉我，实际上密码在我想要的时候被排除/包含。include always 方法的唯一问题是，我基本上需要完成对数据库的每次调用并排除密码，这需要大量工作。

* * *

经过几个很好的答案后，我发现有两种方法可以做到这一点，“有时总是包含和排除”和“有时总是排除和包含”？

两者的一个例子：

**总是包含但有时排除的**例子：

```
Users.find().select("-password") 
```

或者

```
Users.find().exclude("password") 
```

**总是排除但有时包括**示例：

```
Users.find().select("+password") 
```

但您必须在架构中定义：

```
password: { type: String, select: false } 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2017-04-13T06:39:27.997

`User.find().select('-password')`是正确的答案。如果您想登录，您不能添加`select: false`Schema，因为它不起作用。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2018-05-27T13:45:28.700

您可以使用架构来实现这一点，例如：

```
const UserSchema = new Schema({/* */})

UserSchema.set('toJSON', {
    transform: function(doc, ret, opt) {
        delete ret['password']
        return ret
    }
})

const User = mongoose.model('User', UserSchema)
User.findOne() // This should return an object excluding the password field 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-12-05T19:37:34.423

我用于在我的 REST JSON 响应中隐藏密码字段

```
UserSchema.methods.toJSON = function() {
 var obj = this.toObject(); //or var obj = this;
 delete obj.password;
 return obj;
}

module.exports = mongoose.model('User', UserSchema); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-09-30T18:56:13.110

通过向架构配置添加一些设置，我找到了另一种方法。

```
const userSchema = new Schema({
    name: {type: String, required: false, minlength: 5},
    email: {type: String, required: true, minlength: 5},
    phone: String,
    password: String,
    password_reset: String,
}, { toJSON: { 
              virtuals: true,
              transform: function (doc, ret) {
                delete ret._id;
                delete ret.password;
                delete ret.password_reset;
                return ret;
              }

            }, timestamps: true }); 
```

通过向 toJSON 对象添加转换函数，并排除字段名称。正如在[文档中所说](https://mongoosejs.com/docs/api/document.html#document_Document-toJSON)：

> 我们可能需要根据某些标准对结果对象进行转换，比如删除一些敏感信息或返回自定义对象。在这种情况下，我们设置了可选`transform`功能。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-08-28T15:25:48.387

`Blogs.findOne({ _id: id }, { "password": 0 }).populate("user").exec()`

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-08-23T17:05:25.537

假设您的密码字段是“密码”，您可以这样做：

```
.exclude('password') 
```

[这里](http://nickfishman.com/post/19224752602/speeding-up-mongoose-queries-by-requesting-only-the)有一个更广泛的例子

这是专注于评论，但它是相同的原则在起作用。

这与在 MongoDB 中的查询中使用投影并传入`{"password" : 0}`投影字段相同。看[这里](http://www.mongodb.org/display/DOCS/Retrieving+a+Subset+of+Fields)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-07-22T05:51:30.823

使用`password: { type: String, select: false }`时请记住，当我们需要密码进行身份验证时，它也会排除密码。所以准备好随心所欲地处理它。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-10-31T04:31:49.193

```
router.get('/users',auth,(req,res)=>{
   User.findById(req.user.id)
    //skip password
    .select('-password')
    .then(user => {
        res.json(user)
    })
}) 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2020-09-09T15:02:12.543

```
const userSchema = new mongoose.Schema(
  {
    email: {
      type: String,
      required: true,
    },
    password: {
      type: String,
      required: true,
    },
  },
  {
    toJSON: {
      transform(doc, ret) {
        delete ret.password;
        delete ret.__v;
      },
    },
  }
);
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-06-30T22:10:17.310

解决方案是永远不要存储明文密码。您应该使用[bcrypt](https://www.npmjs.com/package/bcrypt)或[password-hash 之](https://www.npmjs.com/package/password-hash)类的包。

哈希密码的示例用法：

```
 var passwordHash = require('password-hash');

    var hashedPassword = passwordHash.generate('password123');

    console.log(hashedPassword); // sha1$3I7HRwy7$cbfdac6008f9cab4083784cbd1874f76618d2a97 
```

验证密码的示例用法：

```
var passwordHash = require('./lib/password-hash');

var hashedPassword = 'sha1$3I7HRwy7$cbfdac6008f9cab4083784cbd1874f76618d2a97';

console.log(passwordHash.verify('password123', hashedPassword)); // true
console.log(passwordHash.verify('Password0', hashedPassword)); // false 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-04-11T03:29:05.580

您可以将***DocumentToObjectOptions***对象传递给***schema.toJSON()***或***schema.toObject()***。

[请参阅@types/mongoose](https://www.npmjs.com/package/@types/mongoose)中的 TypeScript 定义

```
 /**
 * The return value of this method is used in calls to JSON.stringify(doc).
 * This method accepts the same options as Document#toObject. To apply the
 * options to every document of your schema by default, set your schemas
 * toJSON option to the same argument.
 */
toJSON(options?: DocumentToObjectOptions): any;

/**
 * Converts this document into a plain javascript object, ready for storage in MongoDB.
 * Buffers are converted to instances of mongodb.Binary for proper storage.
 */
toObject(options?: DocumentToObjectOptions): any; 
```

***DocumentToObjectOptions***有一个转换选项，它在将文档转换为 javascript 对象后运行自定义函数。在这里，您可以隐藏或修改属性以满足您的需求。

因此，假设您正在使用 schema.toObject() 并且您想从您的 User 架构中隐藏密码路径。您应该配置一个将在每次 toObject() 调用后执行的通用转换函数。

```
UserSchema.set('toObject', {
  transform: (doc, ret, opt) => {
   delete ret.password;
   return ret;
  }
}); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-07-26T21:44:12.600

这更像是原始问题的推论，但这是我试图解决我的问题时遇到的问题......

**即，如何在没有密码字段的 user.save() 回调中将用户发送回客户端。**

用例：应用程序用户从客户端更新他们的个人资料信息/设置（密码、联系信息、whatevs）。一旦成功保存到 mongoDB，您希望在响应中将更新的用户信息发送回客户端。

```
User.findById(userId, function (err, user) {
    // err handling

    user.propToUpdate = updateValue;

    user.save(function(err) {
         // err handling

         /**
          * convert the user document to a JavaScript object with the 
          * mongoose Document's toObject() method,
          * then create a new object without the password property...
          * easiest way is lodash's _.omit function if you're using lodash 
          */

         var sanitizedUser = _.omit(user.toObject(), 'password');
         return res.status(201).send(sanitizedUser);
    });
}); 
```

# git - 如何获得对 Bitbucket 或类似的部署密钥的写入权限？

> ID：12096263
> 
> 赞同：18
> 
> 时间：2012-08-23T16:31:48.087
> 
> 标签：git, ssh, bitbucket

我在 Bitbucket 中有多个私有存储库，有时需要在某些服务器上授予对其中一个存储库的读/写访问权限。

我可以将公钥添加到我的用户帐户，但我不希望该密钥能够访问我的所有存储库。

如果我制作了部署密钥，则它仅对指定的存储库具有读取权限。

有没有办法在特定 repo 上使用特定密钥进行写访问？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-27T08:11:45.073

对 Bitbucket 存储库的所有写入访问权限均基于 Bitbucket 用户进行管理。因此，如果您不想为普通的 Bitbucket 用户提供写入权限，那么您需要创建一个额外的 Bitbucket 用户。

由于 Bitbucket 按用户数量向您收费，因此我认为这样做没有任何问题 — 事实上，您创建多个用户符合他们的利益。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-07-26T07:43:03.010

我遇到了同样的问题，我在 bitbucket 公共问题跟踪器中发现了相关问题。 [https://bitbucket.org/site/master/issues/6887/additional-read-write-key-per-repository](https://bitbucket.org/site/master/issues/6887/additional-read-write-key-per-repository)

评论之一：

> 恐怕我们不会这样做。这会扰乱我们在网站上进行计费的方式。我们可以将用户作为对存储库具有写入权限的人。**有一些方法可以解决这个问题，使用该密钥设置另一个帐户，并且只允许该用户访问您需要的存储库。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-22T12:05:02.700

如果您只需要在登录时访问存储库，则可以使用`ForwardAgent`ssh 配置中的设置：

[如何在 SSH 会话中转发本地密钥对？](https://stackoverflow.com/questions/12257968/how-to-forward-local-keypair-in-a-ssh-session)

# java - 将多个字符转换为一个

> ID：12096264
> 
> 赞同：1
> 
> 时间：2012-08-23T16:31:53.760
> 
> 标签：java, character, translate

我需要帮助将摩尔斯电码转换为英语。我已经编写并测试了将英语翻译成莫尔斯语的代码。我的主要问题是将莫尔斯电码中的所有字符放在一起，然后再将其翻译成英文字符（如果有意义的话）。

例子： ”。” 翻译成 E 和 ... 翻译成 S，但我不希望翻译在到达 ...

很少有规则-空格用于分隔莫尔斯字母-| 用作分隔单词的分隔符 - 不能使用哈希图 :(

这是我的代码

```
import java.util.Arrays;
import javax.swing.JOptionPane;

public class test3
{
public static void main ( String [] args )
{

    String s1 = "Morse";

    // Decide whether Morse code or English
    String decide = JOptionPane.showInputDialog("Enter 'English' for Morse to English code translation and 'Morse' for English to Morse code translation. Pay attention to Caps.");

    // Enter String & decide whether to convert to Morse or English
    String phrase = JOptionPane.showInputDialog("Enter the words you wish to translate.");

    if ( decide.equals( s1 ))
        toMorse( phrase );

    else
        toEnglish( phrase );
}

// Translate to Morse
public static void toMorse( String preTranslation )
{

    String[] english = {"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","1","2","3","4","5","6","7","8","9","0"};

    String[] morse = {".-","-...","-.-.","-..",".","..-.","--.","....","..", ".---",
            "-.-",".-..","--","-.","---",".--.","--.-",".-.","...","-","..-", 
            "...-",".--","-..-","-.--","--..",".----","..---","...--","....-",".....","-....","--...","---..","----.","-----"};
    // Remove uppercase
    String preTrans = preTranslation.toLowerCase();

    // Deletes spaces
    String phraseWithDelimiter = preTrans.replace( " ", "|");

    String[] translation = new String[phraseWithDelimiter.length()];
    String[] delimiter = {"|"};

    // Translate 
    for ( int arrayVar = 0, transArrayVar = 0, subStringVarB = 0, subStringVarE = 1; transArrayVar < phraseWithDelimiter.length();)
    {
        if( phraseWithDelimiter.substring(subStringVarB, subStringVarE).equals( delimiter[0] ) )
        {
            translation[transArrayVar] = delimiter[0];
            transArrayVar++;
            subStringVarB++;
            subStringVarE++;
        }
        else if ( phraseWithDelimiter.substring(subStringVarB, subStringVarE).equals( english[arrayVar] ) )
            {
                translation[transArrayVar] = morse[arrayVar];
                transArrayVar++;
                subStringVarB++;
                subStringVarE++;
                arrayVar = 0;
            }
            else
            {
                arrayVar++;
                if ( arrayVar == 35 )
                {
                    arrayVar = 0;
                    subStringVarB++;
                    subStringVarE++;
                    transArrayVar++;
                }
            }
    }
String morseSeparator = new String( " " );
arrayToString ( translation, morseSeparator );

}

//Convert array to string and print translation
public static void arrayToString(String[] trans, String separator) 
{
    String result = "";
    if (trans.length > 0) 
    {
            result = trans[0];    // start with the first element
            for (int i = 1; i < trans.length; i++)
                result = result + separator + trans[i];
        }
    System.out.println( result );
}

    // unfinished
public static void toEnglish( String preTranslation)
{
    } 
```

我正在考虑制作一个 for 语句并将摩尔斯电码的每个字符分配给一个新字符串，直到我到达一个空格，然后使用它进行测试，但我不确定如何做到这一点。

任何帮助表示感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:47:56.250

创建一个包含所有摩尔斯电码序列的正则表达式，按从最长到最短的顺序排列。

```
 Pattern.compile("----\\.|-----|---\\.\\.|...") 
```

然后将其与字符串重复匹配以获得最长的有效摩尔斯电码序列。

* * *

或者，您可以使用像[JavaCC](http://www.engr.mun.ca/~theo/JavaCC-Tutorial/javacc-tutorial.pdf)这样的解析器编译器。

```
SKIP : { " " }
TOKEN : { < A : "-." > }
TOKEN : { < B : "-..." > }
TOKEN : { < C : "-.-." > }
...

String translate() :
{ StringBuilder sb; }
{
  { sb = new StringBuilder(); }

  (
    letter(sb)
  )*
  <EOF>

  { return sb.toString(); }
}

void letter(StringBuilder sb) :
{}
{
  ( <A>
    { sb.append('a'); }
  | <B>
    { sb.append('b'); }
  | <C>
    { sb.append('c'); }
  ...
  )
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:43:10.740

为了翻译文本，您可以先尝试在单词分隔符上拆分，然后在字符限制符上拆分。然后一一处理单词。与此类似：

```
String morseInput = //whatever, only delimiters or morse characters

String[] words = morseInput.split("-|");
for( String word : words ) {
  String[] characters = word.split("\\s");

  for( String c : characters ) {
    //look up the english character for c - I'd use a map here
  }
} 
```

几点注意事项：

*   为简洁起见，我省略了对空字符串和 null 的检查
*   我还省略了构建最终翻译字符串的任何代码，这对你来说是一个练习
*   我会使用 a`Map<String, String>`进行查找，如果不允许，请在源数组中查找字符的索引，然后从翻译数组中获取该索引处的翻译

# php - FuelPHP 对 ORM 的更新偶尔会导致“而不是”

> ID：12096268
> 
> 赞同：7
> 
> 时间：2012-08-23T16:32:00.520
> 
> 标签：php, mysql, orm, fuelphp

我正在使用 PHP 5.4.4，并且使用 FuelPHP ORM 保存和更新功能时出现了非常奇怪的行为。

我正在尝试将序列化或 JSON 数据保存到数据库中的字段中，例如`{"name":"michael"}`. 当我`model->save()`直接使用它时，`Model::forge()`它似乎 100% 的时间都可以正常工作，并且您看到的字符串是存储在 MySQL 数据库中的字符串。

但是，如果我立即更改诸如 model->property = 'new property' （不是 JSON 或序列化数据属性）之类的东西，然后再做另一个`model->save()`，它将 90% 的时间将我的全部`"`变为`&quot`;

似乎当我调试问题并逐行执行时，它不会重现此问题！它将贯穿整个脚本，并且仍然具有正确的`"`而不是`&quot`;

这个问题快把我逼疯了。我会假设它是一个配置问题，否则会有更多投诉，但我找不到合适的开关。我已经在我的 .htaccess 中设置了两者 `php_flag magic_quotes_gpc Off`（`php_flag magic_quotes_runtime Off`尽管在 PHP 5.4+ 中不需要它）并验证两者都是错误的。

我在这里没有想法。任何要调查的东西都会非常有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T15:58:05.367

您的 ORM 可能使用某种转义函数来保存您的 json 字符串。这是防止 sql 注入攻击的安全功能。如果需要存储 json，请使用 MongoDB 或 CouchDB 等 noSql 解决方案。否则，您需要在它们从 mysql 出来之后和解码它们之前清理您的 json 字符串。

[http://dev.mysql.com/doc/refman/5.0/en/string-literals.html](http://dev.mysql.com/doc/refman/5.0/en/string-literals.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T11:53:22.130

如果“在数据库中转换为”，那么它不是问题。它是为了安全。如果您在浏览器上呈现输出，它将再次显示为“。

如果您的浏览器显示“为”，那么您需要在打印前解码该值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-02T23:13:53.533

尝试添加一些“回声”语句来打印出你的变量，这样你就可以弄清楚它发生在哪里。这通常对找出原​​因大有帮助。

您也可以尝试为 html 实体添加类似 double_encode 的内容，以阻止它对其进行编码。

# javascript - 如何在函数内为jquery工具提示调用不同的var字符串

> ID：12096276
> 
> 赞同：1
> 
> 时间：2012-08-23T16:32:47.940
> 
> 标签：javascript, jquery, xhtml, tooltip

我想在同一个函数中创建多个字符串，并使这段代码在网站上更有用。

我的 JS 代码如下所示：

```
 function() {$(".tool-tip-wrapper").click(function () {
      $(".tool-tip",this).html("<img src='/images/ui-elements-sprite.png' class='top-arrow'><p>This is string one.</p><div class='close'></div>").toggle('fast');
    }); 
```

我的 html 代码如下所示：

```
<div class="tool-tip-wrapper"> click me
    <div class="tool-tip"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T12:57:27.753

下面的标记将解决这个问题。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js" language="javascript"></script>
<script type="text/javascript">

$(document).ready(function(){

    $(".tool-tip-wrapper").click(function(){
                                                $(".tool-tip",this).html("<p>"+this.title+"</p><div class='close'></div>").toggle('fast');
                                           });
});
</script>   
</head>

<body>
<div class="tool-tip-wrapper" title="This is string one.">
    click me
    <div class="tool-tip"></div>
</div>
</body>
</html> 
```

# c++ - WINAPI 代码中的链接器错误

> ID：12096279
> 
> 赞同：4
> 
> 时间：2012-08-23T16:32:53.640
> 
> 标签：c++, c, winapi

我正在尝试编译以下代码，但出现链接器错误。谢谢你告诉我我错过了什么。

```
#include <Windows.h>
#pragma comment(lib,"user32.dll")

int main()
{
    return MessageBoxA(0,"Message","Warn",0x01);
} 
```

`fatal error LNK1104: cannot open file 'user32.dll'`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:33:55.367

由于 LIB 文件用于在编译时链接到 DLL，因此 MessageBoxA 位于 user32.dll 中，并且需要 user32.lib 才能正确链接。
所以在#pragma 评论中更改`user32.dll`为`user32.lib`

`#pragma comment(lib,"user32.lib")`

# php - 如何获得一个学说循环来查找分组记录的数量

> ID：12096280
> 
> 赞同：0
> 
> 时间：2012-08-23T16:32:57.800
> 
> 标签：php, mysql, doctrine, symfony-1.4, doctrine-query

我正在处理一个返回所有已发布记录的查询，并按最新的 updated_version 对它们进行分组和排序。

然后我过滤该结果以显示在过去 24 小时、一周和一个月内更新的结果。

所有的作品花花公子。但是，我想添加一个条件，即如果这三个日期条件中的每一个都没有更新记录，则回显“没有更新记录”。

我很好奇我是否可以在查询中隔离这些组并对其进行检查，或者可能在循环中设置一个变量。循环的问题是，我可以在循环中获得 0 结果条件，但是因为它正在检查循环内部，所以我得到循环中每条记录的“未找到结果”的回声。

好的，这是查询：

```
//return all unpublished records
$draftEntries = Doctrine::getTable("foo")
    ->createQuery()
    ->where('published = 0')
    ->groupBy('updated_at')
    ->orderBy("updated_at DESC")
    ->execute(); 
```

和循环：

```
$message .= "These profiles were edited within the last 24 hours: \n";                      
    foreach ($draftEntries as $entry) {
        $currentDay = substr($entry['updated_at'], 0, 10);
        $condition = false;
        if($currentDay == $today) {
            $condition = true;
            $message .= $entry['last_name'] . ", " . $entry['first_name'] . "\n"; 
        else {
            $message .= "There were records updated yesterday";
            echo $condition;
        }
    } 
```

这只是三个循环中的一个，但我想你明白了我的意图。显然，这是返回的循环：

昨天更新了记录。昨天更新了记录。昨天更新了记录。...

这是不希望的。

那么，从查询中，我可以检查 groupBy 是否大于 0？当然，我可以在不设置三个查询来获得结果的情况下做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T19:17:45.990

这就是我解决这个问题的方法。如果有更好的答案，请告诉我。

我没有尝试在查询中隔离组，我只是在循环中使用了一些条件语句：

```
//Edited in the last 24 hours
    $message .= "<p>These profiles were edited within the last 24 hours: </p><ul>\n";
    $lineitem = "";                     
    foreach ($draftEntries as $draftentry) {
        $currentDay = substr($draftentry['updated_at'], 0, 10);
        if($currentDay == $today) { 
            $listpiece .= $draftentry['id'];
            $listpiece .= "&profile_type=faculty'>".$draftentry['last_name'] . ", " . $draftentry['first_name'] . "</a> / Edited by: ".$draftentry['last_updater']."</li> \n"; 
            $lineitem .= $listpiece;
        }
    }
    if ($lineitem == "") {
        $message .= "No edits were made.";
    }
    else {
        $message .= $lineitem;
    } 
```

我正在连接，但我需要为循环外部`$message`包含的内容制定条件。表示循环中的单个条目。它在循环外实例化，然后可以根据循环内的if语句传递数据。`$message``$lineitem`

到目前为止，它工作得很好。

# c++ - 如何让 Lua 迭代器返回 C 结构？

> ID：12096281
> 
> 赞同：3
> 
> 时间：2012-08-23T16:32:59.750
> 
> 标签：c++, lua

我有一个使用 Lua 5.2.1 的 Visual Studio 2008 C++03 项目，我希望迭代器返回一个对象，以便我可以获取参数值或调用相关函数。例如：

```
for f in foo.list() do
    if f:bar() then
        print("success")
    else
        print("failed")
    end
    print(string.format( "%d: %s", f.id, f.name))
end 
```

我正在使用以下 C++ 代码来实现这一点（省略了错误检查）：

```
struct Foo {
    int id;
    char name[ 256 ];
    HANDLE foo_handle;
}

int foo_list( lua_State* L )
{
    Foo* f = ( Foo* )lua_newuserdata( L, sizeof( Foo ) );
    ZeroMemory( f, sizeof( Foo ) );
    luaL_getmetatable( L, foo_metatable );
    lua_setmetatable( L, -2 );
    f->foo_handle = CreateFooHandle();
    lua_pushcclosure( L, foo_iter, 1 );
    return 1;
}

int foo_iter( lua_State* L )
{
    Foo* foo = ( Foo* )lua_touserdata( L, lua_upvalueindex( 1 ) );
    if( GetNextFoo( foo ) ) /*sets the id and name parameters*/
    {
        // is this correct? I need to return some object...
        luaL_getmetatable( L, foo_metatable );
        return 1;
    }
    return 0;
}

int foo_name( lua_State* L )
{
    Foo* f = ( Foo* )luaL_checkudata( L, 1, foo_metatable );
    lua_pushstring( L, f->name );
    return 1;
}

int foo_id( lua_State* L )
{
    Foo* f = ( Foo* )luaL_checkudata( L, 1, foo_metatable );
    lua_pushinteger( L, f->id );
    return 1;
}

int foo_bar( lua_State* L )
{
    Foo* f = ( Foo* )luaL_checkudata( L, 1, foo_metatable );
    if( FooBar( f ) )
        lua_pushboolean( L, true );
    else
        lua_pushboolean( L, false );
    return 1;
}

int foo_close( lua_State* L ) { /*omitted. this part works*/ }

extern "C" int luaopen_foo( lua_State* L )
{
    // how do I differentiate between a parameter get and a function call?
    const luaL_Reg foo_methods[] = { 
        { "name", foo_name },
        { "id", foo_id },
        { "bar", foo_bar },
        { "__gc", foo_close },
        { NULL, NULL }
    };
    luaL_newmetatable( L, foo_metatable );
    luaL_setfuncs( L, foo_methods, 0 );

    const luaL_Reg foo[] = { 
        { "list", foo_list }
        { NULL, NULL }
    };
    luaL_newlib( L, foo );

    return 1;
} 
```

但是，当我运行它时，我得到了 Lua 错误：`foo.lua:2: calling 'bar' on bad self`

我意识到有包装器可以做到这一点，但我更愿意在实现任何包装器之前了解底层的 Lua 机制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:10:57.960

您从迭代器返回元表，而不是`foo`实例。

更重要的是，您的元表包含方法，但没有元方法。特别是，如果您希望`foo`方法调用解析为元表中的方法，则需要设置元`__index`方法。

我建议在通过 C API 实现之前学习元表在 Lua 中是如何工作的。

当你说`foo.id`，如果`id`不存在`foo`（或者`foo`是用户数据）并且`foo`有一个带有`__index`集合的元表，这将解决以下两件事之一：

1.  如果`__index`是一个函数，该函数将使用字符串调用`id`并`foo.id`解析为该函数返回的任何内容。
2.  如果`__index`是一个表，那么存储的值`rawget(__index, 'id')`基本上`foo.id`解析为`rawget（getmetatable（foo）.__index，'id'）。

所以如果你想使用`foo:id()`，你可以创建一个泛型`id`方法 foo 的 metatable 来返回值`self.id`。

如果要使用`foo.id`，则需要更改`foo`为表并将`id`其存储为状态的一部分，或者实现`__index`为进行字符串比较并识别`id`应解析为的函数`self.id`。

* * *

这是您的代码的修改简化版本，它显示了`__index`元方法的工作：

```
static int nextFooId = 0;
struct Foo {
   int id;
   char name[ 256 ];
};

static const char* foo_metatable = "foo";

int foo_iter( lua_State* L )
{
   if (++nextFooId >= 10)
      return 0;

   // create and initialize foo
   Foo* foo = ( Foo* )lua_newuserdata( L, sizeof( Foo ) );
   foo->id = nextFooId;
   sprintf(foo->name, "Foo %d", foo->id);

   // set metatable for foo
   luaL_getmetatable( L, foo_metatable );
   lua_setmetatable( L, -2 );
   return 1;
}

int foo_list( lua_State* L )
{
   lua_pushcclosure( L, foo_iter, 1 );
   return 1;
}

int foo_name( lua_State* L )
{
   Foo* f = ( Foo* )luaL_checkudata( L, 1, foo_metatable );
   lua_pushstring( L, f->name );
   return 1;
}

int foo_id( lua_State* L )
{
   Foo* f = ( Foo* )luaL_checkudata( L, 1, foo_metatable );
   lua_pushinteger( L, f->id );
   return 1;
}

int foo_bar( lua_State* L )
{
   lua_pushboolean( L, rand()%2 );
   return 1;
}

int foo_close( lua_State* L ) { return 0;/*omitted. this part works*/ }

extern "C" int luaopen_foo( lua_State* L )
{
   const luaL_Reg foo_methods[] = { 
      { "name", foo_name },
      { "id", foo_id },
      { "bar", foo_bar },
      { "__gc", foo_close },
      { NULL, NULL }
   };
   luaL_newmetatable( L, foo_metatable );
   luaL_setfuncs( L, foo_methods, 0 );

   // copy the metatable to the top of the stack 
   // and set it as the __index value in the metatable
   lua_pushvalue(L, -1);
   lua_setfield( L, -2, "__index");

   const luaL_Reg foo[] = { 
      { "list", foo_list },
      { NULL, NULL },
   };
   luaL_newlib( L, foo );

   return 1;
} 
```

一个测试：

```
foo = require 'foo'

for f in foo.list() do
   if f:bar() then
      print("success")
   else
      print("failed")
   end
   print(string.format( "%d: %s", f:id(), f:name()))
end 
```

输出：

```
success
1: Foo 1
success
2: Foo 2
failed
3: Foo 3
failed
4: Foo 4
success
5: Foo 5
failed
6: Foo 6
failed
7: Foo 7
failed
8: Foo 8
failed
9: Foo 9
failed
10: Foo 10 
```

# python - 用于 selenium 网格的 Internet Explorer webdriver

> ID：12096287
> 
> 赞同：2
> 
> 时间：2012-08-23T16:33:23.237
> 
> 标签：python, internet-explorer, selenium-grid, selenium-webdriver

我需要有 IE 网络驱动程序吗？我正在使用 python，我可以通过 selenium grid 2 启动和运行 IE

```
 c = webdriver.DesiredCapabilities.INTERNETEXPLORER
        driver = webdriver.Remote(url, c) 
```

那么 webdriver 是什么（仅限 selenium 1？）

[我在 SO 上](https://stackoverflow.com/questions/11001974/running-selenium-tests-with-ie-using-python)发现了一个类似的问题，但我将使用 Selenium Grid 2，而不是在本地进行测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T13:48:19.353

任何宣传它可以运行 WebDriver IE 会话的节点都必须安装 IEDriver，是的。在最新版本中，这意味着 IE 驱动程序服务器可执行文件必须在 PATH 上。

# ruby-on-rails - 如何显示 Rails 嵌套表单静态文本

> ID：12096289
> 
> 赞同：0
> 
> 时间：2012-08-23T16:33:25.700
> 
> 标签：ruby-on-rails, nested-forms

在 rails 2.3.14 视图中，我有一个 fields_for 嵌套在 form_for 中，数据显示在 HTML 表中。在 field_for 中，我有几个模型属性，我想将它们显示为简单的静态文本，而不是表单字段。所有数据都在 text_field 中正确显示，但我无法将其显示为纯文本。我知道这一定是个愚蠢的问题，但我想不通，每个表单示例都只有表单字段。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T16:53:05.870

拥有一些视图代码会有所帮助，但这不是简单地用纯文本替换字段标签的问题吗？因此，例如，如果您有

```
<% fields_for :comment do |f| -%>
  <%= f.text_field :name %>
<% end -%> 
```

你会用

```
<% fields_for :comment do |f| -%>
  <%= f.object.name %>
<% end -%> 
```

当然，这反而违背了拥有表格的目的？可能我没看懂这个问题。

# javascript - 为线性同余生成器选择 A、C 和 M

> ID：12096294
> 
> 赞同：18
> 
> 时间：2012-08-23T16:33:40.013
> 
> 标签：javascript, algorithm, math, prng, number-theory

我希望实现一个简单的[伪随机数生成器](http://en.wikipedia.org/wiki/Pseudorandom_number_generator)(PRNG)，它具有指定的周期并保证在该周期内没有冲突。在做了一些研究之后，我遇到了非常有名的[LCG](http://en.wikipedia.org/wiki/Linear_congruential_generator)，它非常完美。问题是，我无法理解如何正确配置它。这是我当前的实现：

```
 function LCG (state)
    {
        var a = ?;
        var c = ?;
        var m = ?;

        return (a * state + c) % m;
    } 
```

它说，为了使所有种子值都有一个完整的周期，必须满足以下条件：

1.  **c**和**m**互质
2.  **a-1能被****m**的所有素因子整除
***   **如果**m**是4 的倍数，则**a-1是 4 的倍数******

 ******1**和**3**很容易理解和测试。但是**2**怎么样，我不太明白这意味着什么或如何检查它。那么C呢，它可以为零吗？如果它不为零怎么办？

*总的来说，我需要选择 A、C 和 M 以使我的周期为**48^5 - 1**。M等于周期，我不确定A和C。*

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-23T17:02:40.763

来自维基百科：

> 假设*c*不为零，当且仅当以下情况时，LCG 将具有所有种子值的完整周期：
> 
> 1.  *c*和*m*互质，
> 2.  *a -1 可以被**m*的所有素因子整除，
> 3.  **如果m是 4 的倍数，则**a* -1 是 4的倍数。*

 *你说你想要一个 48 ⁵ -1 的周期，所以你必须选择*m* ≥48 ⁵ -1。让我们尝试选择*m* =48 ⁵ -1 看看它会把我们带到哪里。如果您希望期间为*m*，则维基百科文章中的条件禁止您选择*c* =0 。

 *请注意，11、47、541 和 911 是 48 ⁵ -1 的质因数，因为它们都是质数并且 11*47*541*911 = 48 ⁵ -1。

让我们来看看这些条件中的每一个：

1.  为了使*c*和*m*互质，*c*和*m*必须没有共同的质因数。因此，选择除 11、47、541 和 911*以外的*任何素数，然后将它们相乘以选择您的*c*。
2.  您需要选择*a*使得*a -1 可以被**m*的所有主要因子整除，即对于您选择的任何*x ，* *a* = *x* *11*47*541*911 + 1 。
**   您的*m*不是 4 的倍数，因此您可以忽略第三个条件。*

 ***总之：**

*   m = 48 ⁵ -1,
*   c = 除 11、47、541 和 911 以外的任何素数乘积（同样，*c*必须小于*m*），
*   a = *x* *11*47*541*911 + 1，对于您选择的任何非负*x*（同样，*a*必须小于*m*）。

* * *

这是一个较小的测试用例（在 Python 中），使用周期为 48 ² -1 （其质因数为 7 和 47）：

```
def lcg(state):
    x = 1
    a = x*7*47 + 1
    c = 100
    m = 48**2 - 1
    return (a * state + c) % m

expected_period = 48**2 - 1
seeds = [5]
for i in range(expected_period):
    seeds.append(lcg(seeds[-1]))
print(len(set(seeds)) == expected_period) 
```

它应该输出`True`。（如果您在阅读 Python 时遇到任何问题，请告诉我，我可以将其翻译成 JavaScript。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-07-17T21:24:27.523

根据 Snowball 的回答和评论，我创建了一个完整的示例。您可以将`set == list`比较用于较小的数字。我无法适应`48^5-1`记忆。

为了规避这个`a < m`问题，我将目标增加了几次以找到一个可以出现的数字`a`（`< m`其中`m`重复的主要因素）。令人惊讶的是，+2 对于很多数字来说已经足够了。稍后在迭代时会跳过几个额外的数字。

```
import random

def __prime_factors(n):
    """
    https://stackoverflow.com/a/412942/6078370
    Returns all the prime factors of a positive integer
    """
    factors = []
    d = 2
    while n > 1:
        while n % d == 0:
            factors.append(d)
            n //= d
        d += 1
        if d * d > n:
            if n > 1: factors.append(n)
            break
    return factors

def __multiply_numbers(numbers):
    """multiply all numbers in array"""
    result = 1
    for n in numbers:
        result *= n
    return result

def __next_good_number(start):
    """
    https://en.wikipedia.org/wiki/Linear_congruential_generator#c%E2%89%A00
    some conditions apply for good/easy rotation
    """
    number = start
    factors = __prime_factors(number)
    while len(set(factors)) == len(factors) or number % 4 == 0:
        number += 1
        factors = __prime_factors(number)
    return number, set(factors)

# primes < 100 for coprime calculation. add more if your target is large
PRIMES = set([2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41,
        43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97])

def create_new_seed(target):
    """be aware, m might become > target"""
    m, factors = __next_good_number(target)
    a = __multiply_numbers(factors) + 1
    # https://en.wikipedia.org/wiki/Coprime_integers
    otherPrimes = [p for p in PRIMES if p not in factors]
    # the actual random part to get differnt results
    random.shuffle(otherPrimes)
    # I just used arbitary 3 of the other primes
    c = __multiply_numbers(otherPrimes[:3])
    # first number
    state = random.randint(0, target-1)
    return state, m, a, c

def next_number(state, m, a ,c, limit):
    newState = (a * state + c) % m
    # skip out of range (__next_good_number increases original target)
    while newState >= limit:
        newState = (a * newState + c) % m

    return newState

if __name__ == "__main__":
    target = 48**5-1
    state, m, a, c = create_new_seed(target)
    print(state, m, a, c, 'target', target)

    # list and set can't fit into 16GB of memory
    checkSum = sum(range(target))
    randomSum = 0
    for i in range(target):
        state = newState = next_number(state, m, a ,c, target)
        randomSum += newState
    print(checkSum == randomSum) # true 
```

LCG 在游戏之类的东西中非常迷人且可用。
您可以以确定性随机顺序迭代大量事物。不需要洗牌和保存整个列表：

```
def riter(alist):
    """ iterate list using LCG """
    target = len(alist)
    state, m, a, c = create_new_seed(target)
    for _ in range(target):
        yield alist[state]
        state = next_number(state, m, a ,c, target) 
```

在迭代步骤之间保存状态很容易：

```
savedState = '18:19:25:6:12047269:20'
print('loading:', savedState)
i, state, m, a, c, target = (int(i) for i in savedState.split(':'))
state = next_number(state, m, a, c, target)
i += 1
print('i:', i, 'is random number:', state, 'list done:', i+1 == target)
print('saving:', '{}:{}:{}:{}:{}:{}'.format(i, state, m, a, c, target)) 
```*******

# xml - xml解析期间的错误 - Perl

> ID：12096301
> 
> 赞同：0
> 
> 时间：2012-08-23T16:34:21.660
> 
> 标签：xml, perl

我正在尝试`XML::Tidy`在其他中使用缩进`XML`文件：

```
sub reformatXML {
    #
    # the only argument to this function is the file name
    #
    my $file = $_[ 0 ];
    #
    # create a new XML::Tidy object from $file
    #
    my $tidy = XML::Tidy->new( 'filename' => $file );
    #
    # Tidy up the indenting
    #
    $tidy->tidy();
    #
    # write out changes back to the file
    #
    $tidy->write();
    print "$file was reformated.\n";
    return
}

sub main(){
    #
    # get the current directory in which is the 
    # program running on
    #
    #my $current_dir = getcwd;
    #iterateDir( $current_dir );
    my $file = "/path/to/xml/file/autotest.xml";
    reformatXML( $file );
} 
```

就如此容易。但是，当我调用我的`main()`函数时，我得到：

```
501 Protocol scheme 'd' is not supported d:/UDU/r/tc10.0.0.2012080100_buildA/src/build/kits/tc.dtd
Handler couldn't resolve external entity at line 2, column 29, byte 73
error in processing external entity reference at line 2, column 29, byte 73:
<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE kit SYSTEM "tc.dtd">
============================^
<kit>
  <contact/>
 at C:/xampp/perl/site/lib/XML/Parser.pm line 187 
```

我是新手`Perl`，我不知道为什么会出现这个错误。有人可以帮我弄清楚吗？

文件的头部`XML`是：

```
 <?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE kit SYSTEM "tc.dtd">
<kit>
  <contact/>
  <description>autotest files</description>
  <history>
    <hist>06-May-2005                  Created</hist>
    <hist>17-Jun-2005            Add autotest.jar to rtkit</hist>
    <hist>29-Jun-2005            Remove bits picked up elsewhere</
hist>
    <hist>15-Jul-2005            Added acad_add_note_types.</hist>
    <hist>20-Sep-2005            Add ai stuff</hist>
    <hist>31-Oct-2005            DMS BnT fixes</hist>
    <hist>03-Nov-2005            Pander to kitting's obsession abo
ut unique filenames</hist>
    <hist>17-Nov-2005            Add ics schema and junit</hist>
    <hist>09-Dec-2005            add gdt_autotest</hist>
    <hist>11-Jan-2006            Merge in P10.0.1.5</hist>
    <hist>16-Jan-2006      Merge</hist>
    <hist>26-Jan-2006      Need inclass.plmxml to pass tceng
_util autotest</hist>
    <hist>06-Mar-2006      Add qdiff.pl</hist>
    <hist>09-Mar-2006      Kernel tests need a couple fms cl
ient files</hist>
    <hist>10-Mar-2006      Missing dependent library</hist>
    <hist>19-Jan-2006      Merged from timb_gmo</hist>
    <hist>17-Jan-2006      GMO Kernel Autotests Implementati 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:08:47.620

XML::Tidy（或者更确切地说，它使用的模块之一）似乎期望文件的绝对路径是有效的 URL，但事实并非如此。它认为指定的 URL 是

```
 d:/UDU/r/tc10.0.0.2012080100_buildA/src/build/kits/tc.dtd 
```

当它真的

```
 file:///d:/UDU/r/tc10.0.0.2012080100_buildA/src/build/kits/tc.dtd 
```

我不知道如何解决该错误。你可以尝试改变

```
my $file = "...";
reformatXML($file); 
```

至

```
my $file = "...";
my $url = URI::file->new($file);
reformatXML($url); 
```

* * *

这是直接的错误。除此之外，还存在向 DTD 提供相对 URL 的问题。这不一定是错误的，但有点奇怪。这意味着它`tc.dtd`必须与`autotest.xml`. 真的是这样吗？

* * *

一些解析器（例如 XML::LibXML）有一个选项来避免获取 DTD。这通常是不必要的，因此会浪费时间、金钱、CPU 和带宽。寻找这样的选择。它可能在 XML::Tidy 继承的类之一的构造函数中。

# javascript - javascript中未使用的事件处理程序的内存泄漏

> ID：12096307
> 
> 赞同：0
> 
> 时间：2012-08-23T16:34:34.063
> 
> 标签：javascript, jquery, ajax, javascript-events, event-handling

我处于一种情况，我进行了很多 ajax 调用来更改 html 的同一部分。这个 html 代表一个网格。在 ajax 调用中更改 html 后，我将事件处理程序附加到网格的事件。当用户单击刷新按钮时，我执行相同的 ajax 调用来设置新的 html 代码，并再次添加一个事件处理程序来侦听网格的事件。

我想知道每次刷新我的网格并添加一个新的事件处理程序是否前一个事件处理程序仍在内存中，如果是，在这种情况下的最佳做法是什么？（例如，如果在放置新 html 之前存在，则取消绑定事件处理程序）

这是我所做的一个例子：

```
$.get(this.config.actionLoggingUserListUrl, viewModel, function (data) {
    MyNamespace.ui.hideGridAnimation($("#LoggingActionUsersList"));

    if (data.success) {
        $("#validationSummary").html("");

        $("#usersList").html(data.result);

        $("#LoggingActionUsersList").click(function() {
            console.log("Here is my event handler attached multiple times!");
        });
    }
    else {
        $("#validationSummary").html(data.result);

        $("#usersList").html("");
    }
}); 
```

请注意，我在这种情况下所说的事件处理程序是：

```
$("#LoggingActionUsersList").click(function() {
   console.log("Here is my event handler attached multiple times!");
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:40:50.273

为什么每次打电话都要绑定？

您每次都在添加到堆栈中。你没有替换它。最好的解决方案是使用并执行一次。

其他解决方案是在添加点击事件之前取消绑定点击事件。这个解决方案的问题是，如果有其他任何东西添加了点击事件，你只是删除了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:48:08.167

事件处理程序堆栈，所以是的，这是一个内存泄漏。可能是一个相当微不足道的问题，但它更多的是原理而不是效果。除非出于某种原因您确实需要动态事件处理程序（很少使用，因为它没有太多实际用途），否则我强烈建议将事件处理程序分配从 ajax 调用中提取出来。

如果您确实需要更改事件处理程序，那么聪明的方法是让您的事件处理程序足够聪明，以便对分配给它的对象有一点了解。这样，您就可以让事件处理程序中的逻辑根据对象的当前身份做不同的事情，而不是每次都添加一个新事件。

# erlang - 当我尝试从 eshell 启动时，我的主管崩溃了？

> ID：12096308
> 
> 赞同：10
> 
> 时间：2012-08-23T16:34:35.497
> 
> 标签：erlang, erlang-otp, erlang-supervisor, gen-server

我对 OTP 很陌生，我正在尝试创建简单的示例来了解主管的行为：

这是简单的增量服务器

```
-module( inc_serv ).
-behaviour( gen_server ).
-export( [ start/0, inc/1, stop/0 ] ).
-export( [ init/1, handle_call/3, terminate/2 ] ).

start() ->
        gen_server:start_link( { local, ?MODULE }, ?MODULE, no_args, [] ).

stop() ->
        gen_server:call( ?MODULE, stop ).

inc( Num ) ->
        gen_server:call( ?MODULE, { num, Num } ).

init( no_args ) ->
        io:format( "~p~n", [ "Increment server started :)" ] ),
        { ok, no_state }.

handle_call( { num, Num }, _From, no_state ) ->
        { reply, Num + 1, no_state };
handle_call( stop, _From, no_state ) ->
        { stop, normal, ok, no_state }.

terminate( Reason, no_state ) ->
        io:format( "~p~n", [ "Increment server stopped" ] ). 
```

我想让它由这个模块监督：

```
-module( supervisor_inc ).
-behaviour( supervisor ).

-export( [ start/0 ] ).
-export( [ init/1 ] ).

start() ->
        supervisor:start_link( { local, ?MODULE }, ?MODULE, no_args ).

init( no_args ) ->
        process_flag( trap_exit, true ),
        Supervisor_Spec = { one_for_one, 1, 1 },
        IncServ_Spec = {
                inc_serv,
                { inc_serv, start, [] },
                permanent, 2000, worker, [ inc_serv ] },
        { ok, { Supervisor_Spec, [ IncServ_Spec ] } }. 
```

之后，我在 erlang shell 中执行了后续步骤：

```
1> 
1> c(inc_serv).
{ok,inc_serv}
2> 
2> c(supervisor_inc).
{ok,supervisor_inc}
3> 
3> supervisor_inc:start().
"Increment server started :)"
{ok,<0.43.0>}
4> 
4> inc_serv:inc( 7 ).
8
5> inc_serv:inc( 8 ).
9 
```

在此之后我尝试了下一个（正如我所料我有错误）：

```
6> inc_serv:inc( bad_arg ).
"Increment server stopped"
"Increment server started :)"

=ERROR REPORT==== 23-Aug-2012::19:32:06 ===
** Generic server inc_serv terminating 
** Last message in was {num,bad_arg}
** When Server state == no_state
** Reason for termination == 
** {badarith,[{inc_serv,handle_call,3,[{file,"inc_serv.erl"},{line,22}]},
              {gen_server,handle_msg,5,[{file,"gen_server.erl"},{line,588}]},
              {proc_lib,init_p_do_apply,3,
                        [{file,"proc_lib.erl"},{line,227}]}]}

=ERROR REPORT==== 23-Aug-2012::19:32:06 ===
** Generic server supervisor_inc terminating 
** Last message in was {'EXIT',<0.31.0>,
                           {{{badarith,
                                 [{inc_serv,handle_call,3,
                                      [{file,"inc_serv.erl"},{line,22}]},
                                  {gen_server,handle_msg,5,
                                      [{file,"gen_server.erl"},{line,588}]},
                                  {proc_lib,init_p_do_apply,3,
                                      [{file,"proc_lib.erl"},{line,227}]}]},
                             {gen_server,call,[inc_serv,{num,bad_arg}]}},
                            [{gen_server,call,2,
                                 [{file,"gen_server.erl"},{line,180}]},
                             {erl_eval,do_apply,6,
                                 [{file,"erl_eval.erl"},{line,576}]},
                             {shell,exprs,7,[{file,"shell.erl"},{line,668}]},
                             {shell,eval_exprs,7,
                                 [{file,"shell.erl"},{line,623}]},
                             {shell,eval_loop,3,
                                 [{file,"shell.erl"},{line,608}]}]}}
** When Server state == {state,
                            {local,supervisor_inc},
                            one_for_one,
                            [{child,<0.48.0>,inc_serv,
                                 {inc_serv,start,[]},
                                 permanent,2000,worker,
                                 [inc_serv]}],
                            undefined,1,1,
                            [{1345,739526,107495}],
                            supervisor_inc,no_args}
** Reason for termination == 
** {{{badarith,[{inc_serv,handle_call,3,[{file,"inc_serv.erl"},{line,22}]},
                {gen_server,handle_msg,5,[{file,"gen_server.erl"},{line,588}]},
                {proc_lib,init_p_do_apply,3,
                          [{file,"proc_lib.erl"},{line,227}]}]},
     {gen_server,call,[inc_serv,{num,bad_arg}]}},
    [{gen_server,call,2,[{file,"gen_server.erl"},{line,180}]},
     {erl_eval,do_apply,6,[{file,"erl_eval.erl"},{line,576}]},
     {shell,exprs,7,[{file,"shell.erl"},{line,668}]},
     {shell,eval_exprs,7,[{file,"shell.erl"},{line,623}]},
     {shell,eval_loop,3,[{file,"shell.erl"},{line,608}]}]}
** exception exit: {{badarith,[{inc_serv,handle_call,3,
                                         [{file,"inc_serv.erl"},{line,22}]},
                               {gen_server,handle_msg,5,
                                           [{file,"gen_server.erl"},{line,588}]},
                               {proc_lib,init_p_do_apply,3,
                                         [{file,"proc_lib.erl"},{line,227}]}]},
                    {gen_server,call,[inc_serv,{num,bad_arg}]}}
     in function  gen_server:call/2 (gen_server.erl, line 180) 
```

在此之后，我期望 - 我的主管重新启动`inc_serv`。但它没有：

```
7> inc_serv:inc( 8 ).      
** exception exit: {noproc,{gen_server,call,[inc_serv,{num,8}]}}
     in function  gen_server:call/2 (gen_server.erl, line 180) 
```

你能帮我理解发生了什么吗？我应该如何重写我的主管，使其能够重新启动`inc_serv`

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-23T19:55:10.417

这实际上是一种竞争条件。

你可能知道，Erlang shell 本身就是一个普通的 Erlang 进程。当您从外壳启动您的主管时，主管将链接到外壳（因为您使用`supervisor:start_link/3`）。

当您调用您的 gen_server 进程时，该进程崩溃（并且由主管正确重新启动，正如您在后续`"Increment server started :)"`输出中看到的那样）。

**但是**，与此同时，您的调用`gen_server:call/2`将导致相同的崩溃（调用期间崩溃的 gen_server 将通过`gen_server:call/2`函数发出相同的崩溃）。然后，这会导致与您的主管链接的 shell 进程崩溃，而后者又会以相同的原因（`badarith`）崩溃。

基本上，在你的 shell 进程忠实地重新启动你的 gen_server 之后，你的主管被你的 shell 进程背叛了。像这样：

```
 +---------(6)exit----------+    +---------(5)restart---------+
       |                          |    |                            |
       |                          v    |                            v
     Shell ---(1)start_link---> supervisor ---(2)start_link---> gen_server
     |  ^                         ^    |                         ^  |   ^
     |  |                         |    |                         |  |   |
     |  |                         |    +---------(7)exit---------+  |   |
     |  |                         |                                 |   |
     |  +-------------------------+--------------(4)exit------------+   |
     |                                                                  |
     +---------------------------(3)call--------------------------------+ 
```

`catch inc_serv:inc(bad_arg).`您可以通过调用shell来避免这种情况：

```
90> inc_serv:inc(7).        
8
91> catch inc_serv:inc(bad_arg).
"Increment server stopped"

=ERROR REPORT==== 23-Aug-2012::22:10:02 ===
** Generic server inc_serv terminating 
** Last message in was {num,bad_arg}
** When Server state == no_state
** Reason for termination == 
** {badarith,[{inc_serv,handle_call,3,[{file,"inc_serv.erl"},{line,20}]},
              {gen_server,handle_msg,5,[{file,"gen_server.erl"},{line,588}]},
              {proc_lib,init_p_do_apply,3,
                        [{file,"proc_lib.erl"},{line,227}]}]}
"Increment server started :)"
{'EXIT',{{badarith,[{inc_serv,handle_call,3,
                              [{file,"inc_serv.erl"},{line,20}]},
                    {gen_server,handle_msg,5,
                              [{file,"gen_server.erl"},{line,588}]},
                    {proc_lib,init_p_do_apply,3,
                              [{file,"proc_lib.erl"},{line,227}]}]},
                    {gen_server,call,[inc_serv,{num,bad_arg}]}}}
92> inc_serv:inc(7).            
8 
```

# dns - 亚马逊弹性 IP + EC2

> ID：12096312
> 
> 赞同：4
> 
> 时间：2012-08-23T16:34:42.877
> 
> 标签：dns, amazon-ec2

我已经设置了一个 EC2 实例和一个与该实例关联的弹性 IP。我还在我的 DNS 提供商的区域编辑器中设置了一条 A 记录，以便域名指向弹性 IP，例如 example.com = 123.123.123.123。

在阅读了很多帖子之后，这似乎应该足够了，但我的域名仍然没有解析。我什至无法ping通IP地址！奇怪的是，我可以通过弹性 IP SSH 进入 EC2 实例，一切似乎都很好，除了我的域名没有解析到 EC2 实例！

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T18:17:44.997

DNS 名称需要一段时间才能传播，因此这可能是您的第一个问题。

1.  转到[http://www.whatsmydns.net/](http://www.whatsmydns.net/)并输入您的域名。如果所有位置都返回正确的 ip，那么您可以放心地假设它不是 DNS 传播问题。
2.  在安全组中启用 ICMP 规则。如果使用 aws 控制台为“所有 ICMP”创建一个新规则，源为“0.0.0.0/0”。启用此功能会给您的服务器带来安全风险，因此请仅在测试时临时启用此功能。此时，您应该能够 ping 您的实例。
3.  如果使用 HTTP 或 HTTPS 在安全组上为这些协议启用正确的端口，并且只要使用 Apache 正确配置了实例，您就应该启动并运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-10T06:31:24.417

请检查您的 EC2 安全组并确保所需端口已打开

# python - Python fbx sdk dll 导入失败，依赖 walker 没有帮助

> ID：12096314
> 
> 赞同：1
> 
> 时间：2012-08-23T16:34:55.783
> 
> 标签：python, dll, importerror, fbx, depends

我正在尝试使用 FBX SDK 的 python 版本并不断遇到导入错误。我的第一次尝试是在 Python 3.2.3 下运行，导入 fbx 给了我

```
>>> import fbx
Traceback (most recent call last):
  File "<stdin>", line 1, in <module> 
ImportError: DLL load failed: The specified module could not be found 
```

我在dependency walker下检查，发现它正在寻找Python31.DLL但找不到它（连同MSVCR90.DLL、GPSVC.DLL和IESHIMS.DLL）

我的第一个想法是在 Python 3.1 下尝试它，因为它需要 Python31.DLL，所以我得到它并运行它，并在尝试导入 fbx 时出现此错误：

```
>>> import fbx
Traceback (most recent call last):
  File "<stdin>", line 1, in <module> 
ImportError: DLL load failed: %1 is not a valid Win32 application 
```

现在我已经去仔细检查了，但 Dependency Walker 仍然说我缺少所有这些 DLL，我去查看，我在 C:\Windows\system32 或 C:\Windows\winsxs 中都有它们。

有谁知道为什么 Dependancy Walker 会说找不到这些 DLL？是否有任何其他工具可以找出或修复我遇到的 dll 加载失败？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T14:59:02.343

我发现了问题。

我确实需要使用 Python 3.1，但我错误地安装了 64 位版本，这导致了您看到的第二个错误，即不是有效的 Win32 应用程序。我刚刚重新安装了 Python 3.1 32 位，现在工作正常。

# intellisense - CSS 编辑器中的 Visual Studio 2012 Intellisense 提示奇怪的事情

> ID：12096317
> 
> 赞同：4
> 
> 时间：2012-08-23T16:35:11.837
> 
> 标签：intellisense, visual-studio-2012

我有 VS 2012 的 RTM 版本，它很棒 - 但是 CSS 编辑器中的 VS11 中的智能感知并没有建议参数信息，但是......其他的东西，我不太确定那实际上是什么，它看起来像一些示例。

需要明确的是，这就是我得到的（在没有解决方案的情况下启动 VS11，文件 -> 新建 -> 文件，文件类型样式表）：

![VS11 中 CSS 编辑器中的 Intellisense](../Images/2d6fdc6a8b164aa44fb9442b12ba725c.png)

这就是我在 VS10 中得到的（以及我在 VS11 中真正想要的）：

![在此处输入图像描述](../Images/5b76c8efebd90992361f315ce00ab8e1.png)

这只是一个带有“边距”的样本；我尝试重置首选项、全新安装 VS11 等。无论有没有解决方案，它的行为方式都相同。

我怀疑问题出在键盘和椅子之间，但我没有在 VS11 偏好设置中找到任何线索，或者在谷歌上搜索“intellisense css visual studio 2012”等的任何组合。

谢谢，罗伯特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T13:47:31.997

那是正确的建议！.. 它基本上是给你一个例子，说明你可以把什么作为一个价值。

它对于值更复杂的其他 CSS3 属性非常有用。

# javascript - 为什么要使用 img 元素来请求非图像 URL？

> ID：12096322
> 
> 赞同：0
> 
> 时间：2012-08-23T16:35:25.277
> 
> 标签：javascript, jquery, html, json

在被要求调查缓慢的页面加载后，我在 HTML 中注意到了这一点：

```
<img src="/ajax?action=askedAboutCookies" style="display:none" width="0" height="0" alt="" /> 
```

当页面加载时，它显然会发出请求，但它不会返回，只是等到超时。

该 URL`/ajax?action=askedAboutCookies`实际上指向一个不返回图像的 servlet，它（当它工作时）返回 JSON（一个非常基本的对象，返回一个布尔值）。

为什么会有人这样做？我们所有的页面都使用 jQuery，所以我会认为使用他们的 Ajax 便捷方法来进行这样的调用是最简单的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:37:27.277

他们只是在 ping 服务器以跟踪用户。如果启用了 XMLHttpRequest 对象或启用了 JavaScript，则无需担心。只有当图像被禁用时，这种类型的调用才会失败。

# objective-c - 后台应用程序崩溃当前应用程序

> ID：12096323
> 
> 赞同：0
> 
> 时间：2012-08-23T16:35:27.013
> 
> 标签：objective-c, ios

我正在构建一个使用相机的应用程序。众所周知，相机会占用大量内存，并且经常会发出内存警告。

该应用程序运行良好且符合预期。但是，当在后台流式传输 Spotify 时，我的应用程序崩溃了。

有什么方法可以停止/暂停后台应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:38:19.740

在 iOS 中，每个应用程序都在自己的沙盒环境中运行，无法与正在运行的其他应用程序交互，因此您的应用程序无法将任何类型的指令（暂停/停止）传递给在后台运行的其他应用程序。

# sql - 使用 created_at 选择记录范围

> ID：12096325
> 
> 赞同：1
> 
> 时间：2012-08-23T16:35:44.187
> 
> 标签：sql, ruby-on-rails, ruby, activerecord

我想通过 created_at 属性选择一系列模型记录，我试过这个查询

```
Client.where('created_at BETWEEN ? AND ?', 30.days.from_now, DateTime.now.utc) 
```

但它返回一个空数组。

```
1.9.3-p125 :029 > Client.where('created_at BETWEEN ? AND ?', 30.days.from_now, DateTime.now.utc)
  Posting Load (1.0ms)  SELECT `clients`.* FROM `clients` WHERE (created_at BETWEEN '2012-09-22 16:30:04' AND '2012-08-23')
 => [] 
```

另外我想使用`.day`方法将这些记录分组到数组数组中，我的意思是如果我有 10 条记录，我想将在同一天创建的记录分组到单独的数组中！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T16:42:12.420

```
Client.
  where(created_at: 30.days.ago..Date.current).
  group_by{|u| u.created_at.to_date} 
```

您可以传递`where`一个您想要结果的值数组（对于包含范围与排除范围，请查找 和 之间的差异`..`）`...`。

此外，您可以通过调用来对结果进行分组`group_by`，这将采用一个方法来调用，即`.group_by(&:created_at)`或一个块，如我的示例所示。我使用了一个完整的块，因为您希望按日期而不是按特定时间戳对结果进行分组。如果您*实际上*想要一个月中的某一天而不是完整日期，您也可以调用`.group_by{ |u| u.created_at.day}`，但日期对我来说似乎更有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:38:12.640

我相信你想要的是（注意以前与现在）：

```
Client.where('created_at BETWEEN ? AND ?', 30.days.ago.utc, Time.now.utc) 
```

# codeigniter - 用于导航的 Codeigniter URL

> ID：12096333
> 
> 赞同：1
> 
> 时间：2012-08-23T16:36:39.240
> 
> 标签：codeigniter, url, views

我不知道如何做 url 链接。

基本上我有我的导航栏，我不知道要使用哪个 CodeIgniter URL 代码以及如何实现它。

我在这里做的对吗？：

```
<?php $this->load->helper('url'); ?>
<li><a href=" <?php echo site_url("views/about.html"); ?>">About Us</a></li> 
```

我试图做一个这样的锚，但是当我加载页面时它只是变成空白：

```
<?php echo anchor('views/about.html', 'About Us', title='About Us'); ?> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:41:35.343

如果您在 CI 中使用 URL 帮助程序，这是另一种处理 URL 的方法。你应该试试这个，将`base_url()`设为 的值`href`。试试这个，

`<a href="<?php echo base_url()?>/views/aboutus.html">About Us</a>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:52:11.987

建立链接有两种方法：

CodeIgniter 辅助样式：

```
<?php echo anchor('about', 'About us', 'title="About us link"'); ?> 
```

更常见的带有 URL 回显的 HTML：

```
<a href="<?php echo site_url('about');?>" title="About us link">About us</a> 
```

两者都会输出：

```
<a href="http://your_url/about" title="About us link">About us</a> 
```

尽管如果我了解您要达到的目标，那么您的错误就在其他地方。

1.  您不包括该`views`部分，因为您的 URL 应该指向控制器，而不是视图。唯一的情况是如果您有一个名为`views`.
2.  CodeIgniter 已设置为默认情况下不包含`.html`URL 中的文件扩展名。如果您已将它们设置在您的`config`文件 in 中`$config['url_suffix'] = '';`，它会执行此操作，默认情况下为 null。

看看你有没有犯过这些错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T05:59:09.677

你必须像这样尝试

```
<a href=" <?php echo site_url()."views/about.html"; ?>">About Us</a> 
```

或者你可以给喜欢

```
<a href=" <?php echo site_url(views/about); ?>">About Us</a> 
```

并在您放置的“关于”功能中

```
$this->load->view('about'); 
```

但我认为第一个对你有用。

# iphone - 来自文档异步的图像

> ID：12096338
> 
> 赞同：2
> 
> 时间：2012-08-23T16:36:52.597
> 
> 标签：iphone, ios

我需要从 NSDocumentDirectory 读取图像到多个 uiimageview 异步，这样它就不会阻塞 UI。我知道我可以在后台使用执行选择器来加载 uiimage，但是如何将它与动态 uiimageview 关联？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:56:32.360

一种方便的方法是使用块，例如：

```
[self loadFullImageAt:imagePath completion:^(UIIMage * image){
    self.imageView.image = image;
}]; 
```

您将图像作为数据加载的位置（因为`UIImage`否则会延迟加载图像数据 - 当您第一次访问它时）。在后台线程中解压图像也是一个好主意，这样我们第一次使用图像时主线程就不必这样做了。

```
- (void)loadFullImageAt:(NSString *)imageFilePath completion:(MBLoaderCompletion)completion {
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0), ^{
        NSData *imageData = [NSData dataWithContentsOfFile:imageFilePath];
        UIImage *image = nil;
        if (imageData) {
            image = [[[UIImage alloc] initWithData:imageData] decodedImage];
        }
        dispatch_async(dispatch_get_main_queue(), ^{
            completion(image);
        });
    });
} 
```

回调定义为：

```
typedef void (^MBLoaderCompletion)(UIImage *image); 
```

下面是一个`UIImage`实现解压代码的类：

**UIIMage+Decode.h**

```
#import <UIKit/UIKit.h>

@interface UIImage (Decode)

- (UIImage *)decodedImage;

@end 
```

**UIIMage+解码.m**

```
#import "UIImage+Decode.h"

@implementation UIImage (Decode)

- (UIImage *)decodedImage {
    CGImageRef imageRef = self.CGImage;
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef context = CGBitmapContextCreate(NULL,
                                                 CGImageGetWidth(imageRef),
                                                 CGImageGetHeight(imageRef),
                                                 8,
                                                 // Just always return width * 4 will be enough
                                                 CGImageGetWidth(imageRef) * 4,
                                                 // System only supports RGB, set explicitly
                                                 colorSpace,
                                                 // Makes system don't need to do extra conversion when displayed.
                                                 kCGImageAlphaPremultipliedFirst | kCGBitmapByteOrder32Little);
    CGColorSpaceRelease(colorSpace);
    if (!context) return nil;

    CGRect rect = (CGRect){CGPointZero,{CGImageGetWidth(imageRef), CGImageGetHeight(imageRef)}};
    CGContextDrawImage(context, rect, imageRef);
    CGImageRef decompressedImageRef = CGBitmapContextCreateImage(context);
    CGContextRelease(context);

    UIImage *decompressedImage = [[UIImage alloc] initWithCGImage:decompressedImageRef scale:self.scale orientation:self.imageOrientation];
    CGImageRelease(decompressedImageRef);
    return decompressedImage;
}

@end 
```

此处提供的示例代码假定我们正在使用**ARC**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T16:52:15.160

当您说“动态” UIImageView 时，这些是在 UIScrollView 上以编程方式创建的吗？在 UITableView 上？samfisher 在基本问题上是非常正确的，但是根据您创建 UIImageView 的方式，细节会有所不同（例如，如果是 UITableView，您需要确保单元格仍然可见并且没有出队；如果是 UIScrollView，即使那样如果图像在屏幕上仍然可见（尤其是图像很大或很多时），您可能只想加载 UIImageView）。

但基本的想法是你可能会做类似的事情：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

    UIImage *image = [self getTheImage];

    // ok, now that you have the image, dispatch the update of the UI back to the main queue

    dispatch_async(dispatch_get_main_queue(), ^{

        // if the image view is still visible, update it

    });

}); 
```

请注意，您在某些后台队列或线程上调用图像检索，但请确保在主线程上更新 UI！

如果您正在更新滚动视图，您可能需要检查该视图是否仍然可见，例如在[这里](https://stackoverflow.com/questions/11887327/program-crashes-when-loading-200-subview-images-in-the-uiscrollview/11888480#11888480)或[这里](https://stackoverflow.com/questions/11697240/existing-uitableview-photo-grid-not-rotating-correctly/11699240#11699240)考虑。如果你正在更新一个表格视图，也许像[这样](https://stackoverflow.com/questions/11511548/best-way-to-cache-images-on-ios-app/11511973#11511973)检查单元格是否仍然可见。这一切都取决于你想要做什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T16:40:43.043

您可以使用 NSThread/dispatch 队列来创建线程，这些线程可以创建您的 UIImageView-s 并在其中加载图像。

# windows - 在 Windows 中使用数百个子进程？

> ID：12096344
> 
> 赞同：0
> 
> 时间：2012-08-23T16:37:16.283
> 
> 标签：windows, process

我有一个 Windows 应用程序，它使用了许多可靠性有问题的第三方模块。我的应用程序必须从这些模块创建许多对象，一个坏对象可能会导致很多问题。

我在考虑一个多进程方案，其中对象是在一个单独的进程中创建的（接口基本上都是一样的，所以创建跨进程通信应该不那么困难）。在最极端的情况下，我正在考虑每个进程一个对象，因此我最终可能会从我的主应用程序启动 20 个进程到几百个进程之间的任何地方。

这会导致Windows出现任何问题吗？我使用的是 64 位 Windows 7，内存和 CPU 功率不会成为问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:43:10.400

只要你有足够的 CPU 能力和内存，就没有问题。具有分布式应用程序、多线程（是的，多线程）、死锁、原子操作等的一般规则。一切都应该没问题。

# jquery - Flexslider 粘在第一帧上

> ID：12096352
> 
> 赞同：2
> 
> 时间：2012-08-23T16:37:52.540
> 
> 标签：jquery, jquery-plugins, slideshow, flexslider

[http://dev.marramwines.com/](http://dev.marramwines.com/)

这是我正在开发的网站。我用过 Jquery Flexslider。当我使用动画：“淡入淡出”时，它会永远停留在第一张幻灯片上，然后再继续以正常速度旋转。
当我将它切换到幻灯片时它工作正常，但我不想在这种情况下使用幻灯片，因为一些图像在紫色圆圈所在的位置有空白。

这是我的脚本：

```
 <script>
//// Flexslider homepage slideshow
//

  $(window).load(function() {

 $('.flexslider').flexslider({
        animationSpeed: 1000,
        slideshowSpeed: 7000,
        animation: "fade",
        //direction: "vertical",
        controlNav: false,               
        directionNav: false,
        initDelay: 0
    });
 });

</script> 
```

有没有人见过这个，或者知道它可能是什么？我刚刚复制了一个新的 flexslider 文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T06:19:20.710

我有同样的问题。将此添加到我的 css 为我解决了它：

```
.slides li {
   display: none;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T17:06:32.163

这可能是一个错误。我只是将第一帧移到了起点，现在它可以工作了：

```
this.dom.find('.flexslider').flexslider({
    // your options
    startAt: -1
}); 
```

使用正数它不起作用，但是有了这个黑客它可以正确启动

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T21:24:53.890

我将 flexslider.css 注释掉了。还有一些灯箱 JS 有错误，我将其删除。现在可以了。

# sql-server-2008 - 使用 EF 更新行时出现 DateTime 错误

> ID：12096354
> 
> 赞同：0
> 
> 时间：2012-08-23T16:37:57.667
> 
> 标签：sql-server-2008, datetime, entity-framework-4, datetime2

我有一种方法可以从数据库中的表中获取现有行并更新其中的一些值，然后保存这些更改。question 中的表有以下几列：

![表中的列](../Images/9332722c78977de3ab3e36b6012a4b4e.png)

进行更新的代码在这里：

```
 public void Update(Accommodation accommodation, string code, int supplierId)
        {
            var existingAccommodation = Get(a => a.Code == code && a.SupplierId == supplierId);

            DateTime now = DateTime.Now;

            existingAccommodation.ModifiedDate = now;
            existingAccommodation.Description = accommodation.Description;
            existingAccommodation.Introduction = accommodation.Introduction;
            existingAccommodation.Name = accommodation.Name;
            existingAccommodation.Strapline = accommodation.Strapline;
            existingAccommodation.Type = accommodation.Type;
            existingAccommodation.Processed = true;

            DataContext.SaveChanges();
        } 
```

问题是该行`DataContext.SaveChanges();`导致异常，其内部异常说：

```
The conversion of a datetime2 data type to a datetime data type resulted in an out-of-range value 
```

这是调用上述代码的地方

```
 Accommodation existingAccommodation = GetByCode(code, supplierId);
            if (existingAccommodation != null)
            {
                _accommodationRepository.Update(
                    accommodation, code, existingAccommodation.SupplierId);
            } 
```

# mvvm - IoC 容器可访问性

> ID：12096356
> 
> 赞同：0
> 
> 时间：2012-08-23T16:38:01.283
> 
> 标签：mvvm, inversion-of-control, containers, service-locator

我想知道 IoC 容器是否应该仅由实例化和配置它的类引用，或者它是否可以注入其他类，例如 VM 和 VML。我问是因为我看到很多人通过 ViewModelLocator 的构造器传递它并从那里使用它。

这种方法是可以接受的还是应该避免的？

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:25:49.327

你是对的 - 传递容器是做错了，因为它违背了整个控制反转的想法。这里有几个链接给你：

这是[我如何使用 IoC](http://kozmic.pl/2010/06/20/how-i-use-inversion-of-control-containers/)容器（[和第 2 部分](http://kozmic.pl/2010/06/22/how-i-use-inversion-of-control-containers-ndash-pulling-from/)）

我还建议查看[Windsor 的文档](http://docs.castleproject.org/Windsor.MainPage.ashx)，尤其是相当通用的概念部分（即使您不使用 Windsor，也会对您有用）。

# c# - F# 赋值给重载的 C# 属性

> ID：12096357
> 
> 赞同：1
> 
> 时间：2012-08-23T16:38:03.973
> 
> 标签：c#, arrays, f#, c#-to-f#

我正在尝试在 F# 中使用第 3 方 C# 库。C# 作者重载了我试图设置的字段，以便对象本身接收值。对于速记和不完整的代码片段，C# 看起来像这样：

```
public class cls1 { public List<cls2> prop1; }
public class cls2 { private double[,] prop2;
                    public object this[int r,int c] 
                      {set {this.prop2[r,c]=value;} }
                  } 
```

要设置`cls2.prop2`，这在 C# 中有效：

`cls1.prop1[0][0, 0] = 0.0`

在 F# 中，这失败并出现错误`"Invalid expression on left of assignment"`：

`cls1.prop1[0][0, 0] <- 0.0`

有人可以提供关于前进道路的提示吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T19:18:51.887

正确的 F# 语法是：

```
 cls1.prop1.[0].[0, 0] <- 0.0 
```

从MSDN 上的[数组](http://msdn.microsoft.com/en-us/library/dd233214.aspx)页面：

```
You can access array elements by using a dot operator (.) and brackets ([ and ]). 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T17:32:15.563

您正在分配给[索引属性](http://msdn.microsoft.com/en-us/library/dd233202)。有两种方法可以引用索引属性：

```
x.[0, 0] //array syntax 
```

和

```
x.Item(0, 0) //method syntax 
```

前者仅在属性名为时才有效`Item`，C# 中定义的任何索引属性都是这种情况。但是，在 F# 中，名称可以是任意的。

# javascript - 交叉幻灯片插件

> ID：12096358
> 
> 赞同：0
> 
> 时间：2012-08-23T16:38:05.563
> 
> 标签：javascript, jquery

[我通过单击转到站点](http://tobia.github.com/CrossSlide/)上看到的代码使用了 Ken Burns 效果 它现在正在工作。但它的质量并不像你在这个网站上看到的那样。它不光滑，看起来有点振动。

谁能告诉我一种平滑动画的方法，就像我们在 Visual Slideshow 软件上看到的那样？

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:45:18.513

这是一篇详细介绍您自己的文章：http: [//jqueryfordesigners.com/image-cross-fade-transition/](http://jqueryfordesigners.com/image-cross-fade-transition/)

它还包括一个下载他们详细介绍[的插件的链接。](http://jqueryfordesigners.com/downloads/jquery.crossfade.js)

# xml - 复制的VB工作表中表数据的XML刷新刷新表的所有实例

> ID：12096359
> 
> 赞同：0
> 
> 时间：2012-08-23T16:38:05.563
> 
> 标签：xml, excel, salesforce, metadata, vba

感谢您的任何见解，（我提前为长篇道歉）

我经常需要根据 Salesforce.com 组织（云安装）中配置的元数据为客户创建配置工作簿。客户更喜欢此工作簿是 Excel 文件。

Salesforce.com 元数据 API 可用于为组织中的每个 Salesforce.com 对象创建方便的基于 xml 的“.object”文件，其中包含需要在 Excel 中结束的必要元数据。

我已经创建了一个 Excel 工作簿，其中包含一个工作表，该工作表用作我的“模板”，用于存储给定 .object 文件的元数据。

我在此工作表中创建了 3 个单独的表，用于存储对象的自定义字段、记录类型和验证元数据。

我创建了一个 .XSD 文件，该文件使用给定 .object 文件中的元数据填充此工作表中的所有三个表。

我想要一个 VB 宏来使用此工作表、表格和 .XSD 文件来循环执行以下任务的 .object 文件列表：

1.  复制现有模板工作表 - 已解决
2.  使用 .object 文件名的一部分重命名新副本 - 已解决
3.  ImportXML 使用 .XSD 文件和现有表（使用当前迭代的 .object 文件元数据填充新工作表表）
4.  迭代到下一个 .object 文件并重复，直到每个都有自己的选项卡

注意：我将为每个配置工作簿分别创建此 .object 列表，可能通过扫描目录

主要困难：我可以复制模板工作表并重命名它，但是当我为新工作表运行导入 XML 时，它会覆盖表的每个实例（跨所有工作表）中的数据。

这意味着我最终会得到我需要的所有工作表，但它们都将包含来自执行的最终导入的相同 .object 文件的元数据，而不是适用于每个工作表的 .object 特定元数据。

问题：

1.  这个架构适合这个问题吗？
2.  由于我正在复制原始工作表（它具有我想保留的非表格数据和格式）来创建每个附加表格，因此我假设它必须将同一个表格复制到每张表格中。

    1.  有没有办法将这些复制的表相互分离并仍然维护我的 .XSD 数据绑定？
    2.  我最好删除表格并在每个工作表中从头开始重新构建一个新表格吗？
    3.  我在这里吠错树了吗？

这是我的代码：

```
Sub newObject(fileName As String)
    Dim folderPath As String
    Dim myMap As XmlMap
    Dim schemaPath As String
    folderPath = "C:\...\objects - QA\"
    schemaPath = "mySchema.XSD"
    ActiveSheet.Copy After:=Sheets(Sheets.Count)
    'Name the new copied sheet
    ActiveSheet.Name = Left(fileName, Len(fileName) - 7) & ActiveWorkbook.XmlMaps.Count
    'Add a named XmlMap to the collection
    Set myMap = ActiveWorkbook.XmlMaps.Add(folderPath & schemaPath)
    Call ImportXmlFromFile(folderPath & schemaPath, folderPath, fileName)

End Sub

Sub ImportXmlFromFile(myMap As String, myFolder As String, myFile As String)
   ' buildFieldsListS (myMap)
     ThisWorkbook.XmlMaps(myMap).Import (myFolder + myFile)

    Exit Sub
MyErr:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbOKOnly

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T18:53:13.630

XmlMaps 是一个工作簿范围的资源，我怀疑当您打开一个新的对象文件，但给它相同的架构和根名称作为同一个工作簿中的现有 XmlMap 时，它认为您正在尝试更新先前/现有的地图，而不是创建并添加一个新的。

我认为您需要先将模板表复制到新工作簿，然后在该新工作簿中创建并导入新的 XmlMap。

* * *

或者，尝试进行以下更改：

```
Sub newObject(fileName As String)
    On Error Goto MyERR

    ' ... '

    'Add a named XmlMap to the collection'
    Set myMap = ActiveWorkbook.XmlMaps.Add(folderPath & schemaPath)
    Call ImportXmlFromFile(myMap, folderPath, fileName)

    Exit Sub
MyErr:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbOKOnly

End Sub

Sub ImportXmlFromFile(myMap As XmlMap, ByVal myFolder As String, myFile As String)
     myMap.Import myFolder & myFile

End Sub 
```

# visual-studio - 如何在 Visual Studio 2012 中更改解决方案资源管理器的背景颜色？

> ID：12096368
> 
> 赞同：8
> 
> 时间：2012-08-23T16:38:25.747
> 
> 标签：visual-studio, visual-studio-2012

我真的不喜欢 VS 2012 的“Light”主题。我已经设法改变了一些东西以使其更好，但有一件事仍然让我烦恼 - 解决方案资源管理器背景是浅灰色的事实。有没有办法把它改回白色？我在选项 > 环境 > 字体和颜色中看不到解决方案资源管理器的条目，那么我该如何更改呢？它是否存储在某个主题文件中？

*（请注意，我不希望以编程方式执行此操作，因此这不是对现有类似问题的欺骗）*

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-10T09:00:27.483

我发现最简单的解决方案是使用这个 Microsoft 开发的 Visual Studio 2012 颜色主题编辑器，只需选择蓝色主题即可有效地恢复 VS 2010 颜色：

[http://visualstudiogallery.msdn.microsoft.com/366ad100-0003-4c9a-81a8-337d4e7ace05](http://visualstudiogallery.msdn.microsoft.com/366ad100-0003-4c9a-81a8-337d4e7ace05)

节省了在长长的 UI 元素列表中挖掘数小时的时间。您只需选择另一个预设主题即可：)

**编辑：** 以下是使用 VS2012 颜色主题编辑器的步骤：

1.  工具 --> 自定义颜色
2.  新主题 --> 从一个现成的主题创建一个新主题，点击创建
3.  将鼠标悬停在您的新自定义主题上，点击编辑主题
4.  **神奇的步骤：**直接在主题选项卡下，单击第5个按钮“显示所有元素”，在这里您可以找到您要查找的内容
5.  TreeView --> 背景，这改变了解决方案资源管理器的颜色
6.  Environment --> ToolWindowBackground，Team Explorer 背景颜色

**更新**

[Visual Studio 2012 Update 3](http://support.microsoft.com/kb/2835600)现在默认包含旧的“蓝色”主题，因此如果您更新到此版本，您可以轻松选择旧的蓝色主题，而无需跳过上面的箍，如果这就是您想要实现的全部。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-31T19:10:23.430

项目经理 Cathy Sullivan 错了

使用此实用程序

[http://bchavez.bitarmory.com/archive/2012/08/27/modify-visual-studio-2012-dark-and-light-themes.aspx](http://bchavez.bitarmory.com/archive/2012/08/27/modify-visual-studio-2012-dark-and-light-themes.aspx)

使用类别树视图

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T17:35:07.113

**更新**：现在有一个主题编辑器，可以为您提供您正在寻找的确切控制（我注意到这是@Nick G 所建议的，所以对他+1，会让这个承认这一点。

[http://visualstudiogallery.msdn.microsoft.com/366ad100-0003-4c9a-81a8-337d4e7ace05](http://visualstudiogallery.msdn.microsoft.com/366ad100-0003-4c9a-81a8-337d4e7ace05)

（[hanselman 博客](http://www.hanselman.com/blog/YourColorfulVisualStudio2012WithTheColorThemeEditorVS2010ColorsToo.aspx?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed:%20ScottHanselman%20%28Scott%20Hanselman%20-%20ComputerZen.com%29)中的更多详细信息）

==================================================== =================================

前言：我知道你特别提到了白色，但经过一点调整后，我发现深色真的很好，特别是如果你有一个深色主题。我已经将我之前的黑暗主题 (wekeroad) 换成了一个名字相当大胆但看起来很微妙的[超级棒的有趣时光](http://studiostyl.es/schemes/super-awesome-fun-time)。

工具 | 选项 | 一般 | 然后将颜色主题更改为深色。

![在此处输入图像描述](../Images/f02504198a1331dc14d1c261360fa0b6.png)

您可以在上面的背景中看到解决方案资源管理器。我想这些选项将来可能会扩展或扩展。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-28T05:35:45.710

不幸的是，此时您无法更改解决方案资源管理器的背景颜色，超出 Light 和 Dark 主题提供的颜色。

谢谢，凯茜沙利文

项目经理，Visual Studio

# java - 有关创建/重构启用和/或查看实体之间关联的检票口组件的任何建议？

> ID：12096369
> 
> 赞同：0
> 
> 时间：2012-08-23T16:38:26.207
> 
> 标签：java, web-applications, refactoring, wicket

我的团队的任务是创建通常称为实体管理应用程序的东西。被管理的 3 个主要实体是：**Merchants**、**Organizations**和**Contacts**
为管理每个实体创建了单独的页面。但是，这些页面上的许多功能模式非常相似。特别是在我看到的任何地方都重复的两种模式是：

*   **模式 1**：*将 Y 类型的实体与 X 类型的实体相关联*
*   **模式 2**：*列出已与 X 类型实体关联的 Y 类型实体*

不幸的是，这些页面是由多个开发人员临时创建的。这导致了大杂烩的解决方案，没有一个是容易重复使用的。所以我想做的是将上面确定的两种模式抽象为可重用的组件，但我对 wicket 相当陌生，我不确定使用的最佳策略。

我的第一个想法是将模式封装在两个扩展面板的参数化组件类中。但我想听听那些有更多经验的人的意见。

有什么建议么？

**编辑**：
忘记提及，对于任何疑惑，这 3 个实体中的任何一个都可以与其他 2 个实体中的任何一个建立多对多关系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T07:14:55.963

对我来说听起来是个好主意。此外，我会检查是否可以通过依赖注入（想到 Google Guice）提供任何特定逻辑（如 DAO、验证器和其他东西），这样您就可以针对不同的用例使用具有不同处理程序/工作人员/数据提供程序的面板。

很难更具体，因为你的问题有点宽泛，有点模糊。

# python - 尝试将 *.pyc 作为模块导入

> ID：12096377
> 
> 赞同：3
> 
> 时间：2012-08-23T16:39:15.517
> 
> 标签：python, import, compiled, pyc

我有一个 python 脚本试图在文件系统的某个地方导入另一个脚本（路径仅在运行时知道）。据我了解，我需要使用 imp 模块，这可能会起作用，但是在加载模块时，我收到一个错误，即找不到导入模块使用的模块。

继承人的代码：

进口商.py：

```
import imp
imp.load_compiled("my_module","full_path_to_my_module\\my_module.pyc") 
```

我的模块.py：

```
import sys
import another_module 
```

当我运行 importer.py 时，我收到 htis 错误消息：

> ImportError：没有名为 another_module 的模块

这里出了什么问题？我怀疑当'importer.py'正在加载'my_module.pyc'时，他也在尝试加载'another_module'（这很好）但正在寻找错误的位置（例如不是'full_path_to_my_module'）

**编辑：** 我尝试将 'full_path_to_my_module' 添加到系统路径：

```
import imp
import sys

sys.path.append(full_path_to_my_module)
imp.load_compiled("my_module",full_path_to_my_module+my_module) 
```

但我仍然得到同样的错误

也许我做了一些不必要的事情——这是我的目标：我希望能够在“importer.py”中使用“my_module.pyc”的所有功能。但是“my_module.pyc”的位置作为“importer.py”的参数给出。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T16:43:37.160

`imp.load_compiled`返回已编译的模块对象，它`import`与将模块绑定到名称的语句不同

```
import imp
my_module = imp.load_compiled("my_module", "full_path_to_my_module/my_module.pyc") 
```

然后您可以执行以下操作：

```
my_module.yayfunctions('a') 
```

完整的示例会话：

```
$ cat /tmp/my_module.py
def yayfunctions(a):
    print a
$ python -m compileall /tmp/my_module.py
$ ls /tmp/my_module.py*
my_module.py   my_module.pyc
$ python
>>> import imp
>>> my_module = imp.load_compiled("my_module", "/tmp/my_module.pyc")
>>> my_module.yayfunctions('a')
a 
```

* * *

编辑关于注释（`ImportError: No module named another_module`），我假设错误是由代码引起的`my_module.pyc`，并且`another_module.py`生活在同一目录中

在这种情况下，正如其他人所建议的那样，只需添加目录并使用常规导入机制会更简单`my_module`，`sys.path`特别是[`__import__`](http://docs.python.org/library/functions.html#__import__)

这是一个应该做你想做的功能：

```
import os

def load_path(filepath):
    """Given a path like /path/to/my_module.pyc (or .py) imports the
    module and returns it
    """

    path, fname = os.path.split(filepath)
    modulename, _ = os.path.splitext(fname)

    if path not in sys.path:    
        sys.path.insert(0, path)

    return __import__(modulename)

if __name__ == '__main__':
    # Example usage
    my_module = load_path('/tmp/my_module.py')
    my_module.yayfunctions('test') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T16:43:27.083

这是因为在`import another_module`您的“full_path_to_my_module”范围内是未知的。

您是否尝试将路径添加到已知路径，即：

```
import sys
sys.path.append("full_path_to_my_module") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T16:43:06.430

您实际上不需要使用 imp 模块来加载 pyc 模块。

一个简单的尝试方法是制作两个 python 模块，一个从另一个导入并运行它。然后删除导入的 .py 文件，这样你就只剩下 .pyc 文件了：运行脚本时，导入会正常工作。

但是，对于从随机目录导入 py 文件，您可能需要先将该目录添加到 python 路径，然后再导入它。

例如：

```
import sys
sys.path.insert(0, "/home/user/myrandomdirectory") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T16:44:09.383

加载 pyc 文件的工作方式与加载 py 文件的方式完全相同，只是它不执行编译步骤。因此`import mymodule`，只要 pyc 的版本号与您正在运行的 python 相同，就可以使用。否则你会得到一个幻数错误。

如果您的模块不在您的路径中，您需要将其添加到 sys - 或者如果它是子目录，则将`__init__.py`文件添加到该目录..

# c++ - 如何设计一个主要运行 tcl 脚本的 C++ GUI 应用程序

> ID：12096379
> 
> 赞同：0
> 
> 时间：2012-08-23T16:39:23.723
> 
> 标签：c++, tcl

我正在寻找一种构建 C++ GUI 应用程序的好方法。它的核心是生成一大堆 tcl 代码并通过 Tcl C++ API ( `#include <tcl.h>`) 执行它。GUI 为用户提供了一种简单的方法来完成那些 tcl 脚本任务。

换句话说，在与 GUI 控件关联的每个回调函数内部，就像使用 ostringstream 填充 tcl 代码并将其传递给 tcl 解释器一样。例如：

```
bool execTclProc1(options) {
  ostringstream oss;
  oss << "package require MyPackage \n";
  string optionsForTcl = genOptionsForTcl(options);
  oss << "myTclProc1 " << optionsForTcl << endl;

  if(Tcl_Eval(interp, oss.c_str() == TCL_OK) {
    // print out some messages to the GUI message window
  }

  ...
} 
```

这种设计的缺点：

*   难以调试 tcl 代码错误。由于 tcl 代码的每一次更改都需要重新编译 C 代码。虽然一种快速的方法是在 tcl 交互式 shell 中编写和测试 tcl 代码。但是很多 tcl 代码是用 C++ 填充的，而不是硬编码的。所以不是那么可行。

*   一大堆 tcl 代码是用 C++ 例程编写的。这使得它很难维护。

我想从社区中寻求一些见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:07:53.633

你不能使用Tk 工具包作为C++[中的库函数吗？](http://www.gibmonks.com/practical-programming/ch47lev1sec2.html)

此外，还有[Tk/C++](http://cpptk.sourceforge.net/) - 不知道它有多好。他们重载了 operator- 并使用表达式模板，使 C++ 代码像 Tcl 一样。很酷！

# php - 使用 PHP 从 ScreenOS 设备复制文件

> ID：12096382
> 
> 赞同：1
> 
> 时间：2012-08-23T16:39:49.107
> 
> 标签：php, security, scp

我正在制作一个脚本来备份防火墙的配置。我想做的一件事是`scp`来自 ScreenOS 设备的文件，但我从 CLI 得到一个空行。

我需要做的是将此功能构建到现有的 Web 界面中，因此我需要能够从 PHP 中运行此命令。

我看过`shell_exec`,`system`等，但我在 CLI 级别运行命令时遇到问题。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:45:10.227

我已经在这个领域多年了。这实际上是版本 6.5 或更低版本的 ScreenOS 设备的错误。

有一篇文章[Gotcha - SCP Returns To Prompt](http://www.highonphp.com/scp-returns-to-prompt)记录了此错误并指导您配置单独安装的 OpenSSH，其中包括 SCP 修复以支持较旧的 ScreenOS 设备。

至于你的 Web 界面，一旦你修复了这个错误，将你的`shell_exec`命令映射到这个新的`scp`二进制文件，你就一切就绪了。

# c - 如何将用户在 C 中输入的字符传递给 printf？

> ID：12096384
> 
> 赞同：0
> 
> 时间：2012-08-23T16:39:54.840
> 
> 标签：c, pointers, printf

我刚刚从 C 开始并试图掌握指针的整个概念，我刚刚遇到了以下问题。

我正在尝试打印出用户输入的字符，并将其传递给单独的函数：

```
#define MAX_OPTION_INPUT 1
#define TRUE 1
#define FALSE 0

// print a menu
void getCharacter() {   
    char getNum[MAX_OPTION_INPUT+2];
    int finished = FALSE;

    // get character from user
    do {
        fgets(getNum, MAX_OPTION_INPUT+2, stdin);
        if (getNum[strlen(getNum) - 1] != '\n') {
            printf("Input one digit number please.\n");
            readRestOfLine();
      }
      else {
         getNum[strlen(getNum) - 1] = '\0';
         finished = TRUE;
      }
   } while (!finished);

    processChar(getNum);
}

// process menu
void processChar(char num) {
    printf("TADA: %c", num);
} 
```

当我编译这段代码时，我收到一个警告：*传递 'processChar' 的参数 1 从指针中生成整数而不进行强制转换*

当我运行它时，它会打印出一些奇怪的字符，而不是我应该通过的字符。

您能否向我解释一下我在哪里遗漏了这一点？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:42:04.590

更改函数以接受 a `char *`：

```
void processChar(const char *num)
{
    printf("TADA: %s", num); /* %s instead of %c */
} 
```

> 您能否向我解释一下我在哪里遗漏了这一点？

当它实际上是一个字符数组时，您正在传递和使用`num`它，就好像它是一个字符一样。

# html - aptana studio 插件有 Surround With 吗？

> ID：12096387
> 
> 赞同：1
> 
> 时间：2012-08-23T16:40:24.590
> 
> 标签：html, eclipse, code-snippets, aptana3, code-assist

是否有某种方法可以像在 Java 透视图中那样在 Eclipse 的 Aptana 透视图中获得“环绕”。我希望能够用 html 标签包围文本，例如：`<div></div>`使用键盘快捷键。有没有办法用片段卢布做到这一点？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-14T14:41:41.377

您可以使用 AutoHotKey 来做到这一点，它具有可在所有应用程序中使用的额外好处。我有一个脚本，当我选择一些文本并按 CTRL+SHIFT+C 时会启动“环绕”菜单

要使用它，请安装 AutoHotKey，并使用以下代码创建一个新的 .txt 文件，并将扩展名替换为 .ahk

[http://pastebin.com/48ipiXsG](http://pastebin.com/48ipiXsG)

在文件的顶部，您会发现许多项目组，格式如下

```
<h1>~<h1>@@</h1> 
```

~ 字符分隔函数的名称和函数的内容。~ 之前的位是出现在您的菜单上的内容，~ 之后的是代码。@@ 表示您选择的文本将去哪里。因此，如果您选择文本“AutoHotKey”并按 CTRL+SHIFT+C，然后`<h1>`从菜单中选择，它将替换为`<h1>AutoHotKey</h1>`

脚本中有几个菜单，设置为根据您在哪个应用程序中按下 CTRL+SHIFT+C 启动。例如，如果我在 Visual Studio 中与在 SQL Server 中，我会获得不同的快捷方式。您可以轻松地修改这些，但通用菜单应该适合您。随意更改和更改，但您必须将 GENERIC 留在脚本的顶部。

PS：我每天都用这个脚本，有一个小bug。该脚本将剪贴板中的所有内容保存在一个变量中，然后在完成后将其写回剪贴板。有时，它不是围绕文本，而是用剪贴板中的任何内容替换它。这可以使用 CTRL-Z 轻松撤消，并且通常在您第二次尝试时有效。我一直无法弄清楚是什么原因造成的，也许一些自动热键头可以提供帮助？

PPS：这个脚本是基于 AHK 论坛的一些其他脚本，包括这个 [http://www.autohotkey.com/docs/scripts/FavoriteFolders.htm](http://www.autohotkey.com/docs/scripts/FavoriteFolders.htm) 所以你可能会发现没有意义的评论。我已经看到了一些对中键的引用，因为上面的脚本使用鼠标中键而不是 CTRL+SHIFT+C。

# sql-server-2008-r2 - SQL Server 跳过 RAISERROR

> ID：12096393
> 
> 赞同：2
> 
> 时间：2012-08-23T16:40:43.733
> 
> 标签：sql-server-2008-r2, raiserror

简单的代码。非常奇怪的行为，三重检查了这一点。`@filePath`并且`@path`是`NVARCHAR(260)`并且`@exists`是`INT`。`dbo.WriteToFile`将文件写入磁盘，在本例中为空文件。

```
EXEC master..xp_fileexist @filePath, @exists OUTPUT
print @exists
IF @exists = 0
BEGIN
  EXEC dbo.WriteToFile N'', @path, @filename
  RAISERROR('A', 20, -1) WITH log
END
RAISERROR('B', 20, -1) WITH log 
```

当我第一次运行此代码并且`@exists`为 0 时，它会进入 if 块。文件按预期创建。证实了这一点。但是`RAISERROR` **在**if 块中**没有**被调用。而是只`RAISERROR`调用 if 块的外部。

但是，如果我将第一个替换`RAISERROR ('A')`为`PRINT 'blabla'`print 语句，则会按预期调用。

如果我`@exists = 0`用 1=1 替换并**保持**第一个不变，`RAISERROR ('A')`那么一切都会正常运行并`RAISERROR ('A')`调用第一个。

有人可以解释一下吗？

哦，是的，为什么

```
print 'bla'
raiserror('bla', 20, -1) with log 
```

在一个全新的查询窗口中给我这个：

```
bla
Meldung 2745, Ebene 16, Status 2, Zeile 3
Der Prozess mit der ID 54 hat den Benutzerfehler 50000, Schweregrad 20, ausgelöst. Dieser Prozess wird von SQL Server beendet.
bla
Meldung 2745, Ebene 16, Status 2, Zeile 3
Der Prozess mit der ID 54 hat den Benutzerfehler 50000, Schweregrad 20, ausgelöst. Dieser Prozess wird von SQL Server beendet. 
```

这是相同消息的 2 倍。也许我的 SQL 服务器配置不正确？

如果您有兴趣，我也会发布该`WriteToFile`程序，也许它会有所帮助，我从网上获得了这个程序，但它运行良好，但它可能会产生以下`RAISERROR`行为：

```
ALTER PROCEDURE dbo.WriteToFile
 (
@String Varchar(max), --8000 in SQL Server 2000
@Path VARCHAR(255),
@Filename VARCHAR(100)
)
AS
BEGIN
DECLARE  @objFileSystem int
                ,@objTextStream int,
        @objErrorObject int,
        @strErrorMessage Varchar(1000),
            @Command varchar(1000),
            @hr int,
        @fileAndPath varchar(80)

select @strErrorMessage='opening the File System Object'
EXECUTE @hr = sp_OACreate  'Scripting.FileSystemObject' , @objFileSystem OUT

Select @FileAndPath=@path+'\'+@filename
if @HR=0 Select @objErrorObject=@objFileSystem , @strErrorMessage='Creating file "'+@FileAndPath+'"'
if @HR=0 execute @hr = sp_OAMethod   @objFileSystem   , 'CreateTextFile'
    , @objTextStream OUT, @FileAndPath,2,True

if @HR=0 Select @objErrorObject=@objTextStream, 
    @strErrorMessage='writing to the file "'+@FileAndPath+'"'
if @HR=0 execute @hr = sp_OAMethod  @objTextStream, 'Write', Null, @String

if @HR=0 Select @objErrorObject=@objTextStream, @strErrorMessage='closing the file "'+@FileAndPath+'"'
if @HR=0 execute @hr = sp_OAMethod  @objTextStream, 'Close'

if @hr<>0
    begin
    Declare 
        @Source varchar(255),
        @Description Varchar(255),
        @Helpfile Varchar(255),
        @HelpID int

    EXECUTE sp_OAGetErrorInfo  @objErrorObject, 
        @source output,@Description output,@Helpfile output,@HelpID output
    Select @strErrorMessage='Error whilst '
            +coalesce(@strErrorMessage,'doing something')
            +', '+coalesce(@Description,'')
    raiserror (@strErrorMessage,16,1)
    end
EXECUTE  sp_OADestroy @objTextStream
EXECUTE sp_OADestroy @objTextStream
END 
```

编辑：运行 SQL Server 2008 R2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T07:11:10.753

我不知道您是否真的需要“20”错误级别，但请尝试：

```
RAISERROR('A', 16, -1) WITH log 
```

# python - Django：选择与任何 B 对象建立 m2m 关系的所有 A 对象（通过 B.m2mfield）

> ID：12096396
> 
> 赞同：1
> 
> 时间：2012-08-23T16:40:50.947
> 
> 标签：python, django, orm, manytomanyfield

我有以下模型：

```
class People(models.Model):
    name=models.CharField

class Recordings(models.Model):
    title=models.CharField
    performers=models.ManyToManyField(People) 
```

我需要得到所有的表演者，即至少一个录音的表演者列表中的人。

SQL 将是这样的：

```
SELECT * FROM people WHERE id IN (SELECT DISTINCT people_id FROM recordings_people) 
```

或者

```
SELECT DISTINCT * FROM recordings_people JOIN people ON recordings_people.people_id=people.id 
```

如何以优雅的方式对 Django ORM 做同样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:31:22.693

与排除一样简单 1,2,3：

```
People.objects.exclude(recordings=None) 
```

够优雅吗？;)

# java - Java - 因内存不足错误而关闭

> ID：12096403
> 
> 赞同：63
> 
> 时间：2012-08-23T16:41:07.280
> 
> 标签：java, out-of-memory

关于如何最好地处理这个问题，我听到了非常矛盾的事情，并且陷入了以下困境：

*   OOME 会关闭线程，但不会关闭整个应用程序
*   我需要关闭整个应用程序但不能因为线程没有任何内存

我一直理解最佳实践是让它们离开，这样 JVM 就会死掉，因为此时 JVM 处于不一致的状态，但这似乎在这里不起作用。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-08-23T16:58:31.993

[`OutOfMemoryError`](http://docs.oracle.com/javase/7/docs/api/java/lang/OutOfMemoryError.html)就像任何其他错误一样。如果它从中逃脱，`Thread.run()`将导致线程死亡。而已。此外，当线程死亡时，它不再是 GC 根，因此仅由该线程保留的所有引用都符合垃圾收集的条件。这意味着 JVM 很可能会从 OOME 中恢复。

如果你想杀死你的JVM，因为你怀疑它可能处于不一致的状态，把它添加到你的`java`选项中：

```
-XX:OnOutOfMemoryError="kill -9 %p" 
```

`%p`是当前的 Java 进程 PID 占位符。其余的不言自明。

当然你也可以尝试[`OutOfMemoryError`](http://docs.oracle.com/javase/7/docs/api/java/lang/OutOfMemoryError.html)以某种方式捕捉和处理它。但这很棘手。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2016-12-01T08:27:14.233

在 Java 版本 8u92 中，VM 参数

*   `-XX:+ExitOnOutOfMemoryError`
*   `-XX:+CrashOnOutOfMemoryError`

已添加，请参阅[发行说明](http://www.oracle.com/technetwork/java/javase/8u92-relnotes-2949471.html)。

> **ExitOnOutOfMemoryError**
> 启用此选项后，JVM 将在第一次出现内存不足错误时退出。如果您更喜欢重新启动 JVM 实例而不是处理内存不足错误，则可以使用它。
> 
> **CrashOnOutOfMemoryError**
> 如果启用此选项，当发生内存不足错误时，JVM 会崩溃并生成文本和二进制崩溃文件。

增强请求：[JDK-8138745](https://bugs.openjdk.java.net/browse/JDK-8138745)（参数命名错误，虽然 [JDK-8154713](https://bugs.openjdk.java.net/browse/JDK-8154713)，`ExitOnOutOfMemoryError`而不是`ExitOnOutOfMemory`）

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2016-04-28T10:09:13.127

在 8u92 版本中，Oracle JDK 中现在有一个 JVM 选项，可以在发生 OutOfMemoryError 时使 JVM 退出：

从[发行说明](http://www.oracle.com/technetwork/java/javase/8u92-relnotes-2949471.html)：

> **ExitOnOutOfMemoryError** - 启用此选项时，JVM 在第一次出现内存不足错误时退出。如果您更喜欢重新启动 JVM 实例而不是处理内存不足错误，则可以使用它。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-08-23T16:55:44.240

一旦发生错误，您可以通过多种方式强制您的程序终止。就像其他人建议的那样，如果需要，您可以捕获错误并在之后执行 System.exit。但我建议你也使用 -XX:+HeapDumpOnOutOfMemoryError，这样一旦事件产生，JVM 就会创建一个包含应用程序内容的内存转储文件。您将使用配置文件，我建议您使用 Eclipse MAT 来研究图像。这样，您将很快找到问题的原因，并做出适当的反应。如果您不使用 Eclipse，您可以将 Eclipse MAT 用作独立产品，请参阅：[http](http://wiki.eclipse.org/index.php/MemoryAnalyzer) ://wiki.eclipse.org/index.php/MemoryAnalyzer 。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-08-23T16:49:10.387

如果您想关闭您的程序，请查看命令行上的`-XX:OnOutOfMemoryError="<cmd args>;<cmd args>"`（[在此处记录](http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html)）选项。只需将其指向您的应用程序的终止脚本。

一般来说，我从来没有运气在不重新启动应用程序的情况下优雅地处理此错误。总会有某种特殊情况发生，所以我个人建议确实停止您的应用程序，但要调查问题的根源。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-05-06T06:58:45.220

我建议从应用程序中处理所有未捕获的异常，以确保它在终止之前尝试为您提供最佳数据。然后有一个外部脚本，当它崩溃时重新启动你的进程。

```
public class ExitProcessOnUncaughtException implements UncaughtExceptionHandler  
{
    static public void register()
    {
        Thread.setDefaultUncaughtExceptionHandler(new ExitProcessOnUncaughtException());
    }

    private ExitProcessOnUncaughtException() {}

    @Override
    public void uncaughtException(Thread t, Throwable e) 
    {
        try {
            StringWriter writer = new StringWriter();
            e.printStackTrace(new PrintWriter(writer));
            System.out.println("Uncaught exception caught"+ " in thread: "+t);
            System.out.flush();
            System.out.println();
            System.err.println(writer.getBuffer().toString());
            System.err.flush();
            printFullCoreDump();
        } finally {
            Runtime.getRuntime().halt(1);
        }
    }

    public static void printFullCoreDump()
    {
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        System.out.println("\n"+
            sdf.format(System.currentTimeMillis())+"\n"+
            "All Stack Trace:\n"+
            getAllStackTraces()+
            "\nHeap\n"+
            getHeapInfo()+
            "\n");
    }

    public static String getAllStackTraces()
    {
        String ret="";
        Map<Thread, StackTraceElement[]> allStackTraces = Thread.getAllStackTraces();

        for (Entry<Thread, StackTraceElement[]> entry : allStackTraces.entrySet())
            ret+=getThreadInfo(entry.getKey(),entry.getValue())+"\n";
        return ret;
    }

    public static String getHeapInfo()
    {
        String ret="";
        List<MemoryPoolMXBean> memBeans = ManagementFactory.getMemoryPoolMXBeans();               
        for (MemoryPoolMXBean mpool : memBeans) {
            MemoryUsage usage = mpool.getUsage();

            String name = mpool.getName();      
            long used = usage.getUsed();
            long max = usage.getMax();
            int pctUsed = (int) (used * 100 / max);
            ret+=" "+name+" total: "+(max/1000)+"K, "+pctUsed+"% used\n";
        }
        return ret;
    }

    public static String getThreadInfo(Thread thread, StackTraceElement[] stack)
    {
        String ret="";
        ret+="\n\""+thread.getName()+"\"";
        if (thread.isDaemon())
            ret+=" daemon";
        ret+=
                " prio="+thread.getPriority()+
                " tid="+String.format("0x%08x", thread.getId());
        if (stack.length>0)
            ret+=" in "+stack[0].getClassName()+"."+stack[0].getMethodName()+"()";
        ret+="\n   java.lang.Thread.State: "+thread.getState()+"\n";
        ret+=getStackTrace(stack);
        return ret;
    }

    public static String getStackTrace(StackTraceElement[] stack)
    {
        String ret="";
        for (StackTraceElement element : stack)
            ret+="\tat "+element+"\n";
        return ret;
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-23T17:32:30.783

一般来说，您永远不应该编写一个 catch 块来捕获`java.lang.Error`或其任何子类，包括`OutOfMemoryError`. 唯一的例外是，如果您使用的是第三方库，该库会抛出一个自定义子类，说明`Error`他们应该何时拥有 subclassed `RuntimeException`。不过，这实际上只是解决他们代码中的错误的方法。

来自[JavaDoc](http://docs.oracle.com/javase/7/docs/api/java/lang/Error.html)的`java.lang.Error`：

> Error 是 Throwable 的子类，表示合理的应用程序不应尝试捕获的严重问题。

如果您的应用程序在其中一个线程因 OOME 而死后仍继续运行时遇到问题，您有几个选择。

首先，您可能想检查是否可以将剩余线程标记为守护线程。如果在某个时刻只有守护线程保留在 JVM 中，它将运行所有关闭挂钩并尽可能有序地终止。为此，您需要`setDaemon(true)`在线程对象启动之前调用它。如果线程实际上是由框架或其他代码创建的，您可能必须使用不同的方法来设置该标志。

另一种选择是为有问题的线程分配一个未捕获的异常处理程序，并在`System.exit()`绝对必要时调用`Runtime.getRuntime().halt()`。调用停止是非常危险的，因为关闭挂钩甚至不会尝试运行，但在某些情况下，停止可能会在 System.exit 失败的情况下工作，如果已经抛出 OOME。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-07-16T10:30:54.137

由于 JVM 选项

`-XX:+ExitOnOutOfMemoryError`

`-XX:+CrashOnOutOfMemoryError`

`-XX:OnOutOfMemoryError=...`

`OutOfMemoryError`如果由于线程耗尽而发生这种情况（请参阅[相应的 JDK 错误报告](https://bugs.openjdk.java.net/browse/JDK-8138745)），则不工作，可能值得尝试工具[jkill](https://github.com/airlift/jvmkill)。它通过[JVMTI](http://docs.oracle.com/javase/8/docs/technotes/guides/jvmti/)注册并在内存或可用线程耗尽时退出 VM。

在我的测试中，它按预期工作（以及我期望 JVM 选项如何工作）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-23T16:51:42.273

您可以使用 OOME 的 try catch 包围您的线程代码，并在发生此类事件时进行一些手动清理。一个技巧是让你的线程函数只是对另一个函数的尝试捕获。发生内存错误时，它应该在堆栈上释放一些空间，以便您进行一些快速删除。如果您在捕获和/或设置垂死标志以告诉其他线程退出后立即对某些资源执行垃圾收集请求，这应该可以工作。

一旦带有 OOME 的线程死亡并且您对其元素进行了一些收集，您应该有足够的可用空间让其他线程以有序的方式退出。这是一个更优雅的退出，也有机会在死前记录问题。

# css - 将跨度定位在 href 之上并保留点击

> ID：12096409
> 
> 赞同：0
> 
> 时间：2012-08-23T16:41:52.733
> 
> 标签：css

我的 css 技能越来越生疏，我不知道如何处理这个问题。

我有一个包含文本“更多”的简单跨度，我需要将它放在 href 之上并保留 href 容量。

我试图将其定位为绝对位置，但它仍然会破坏点击能力。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:54:14.763

您可以将**跨度**放置在**a**标记中并称之为一天。否则，您要做的是使用该`z-index`属性。

通过将定位属性设置为**a**标签（`position:relative`可能），您可以有效地设置和使用`z-index: 2`来强制链接位于**span***之上*。它也可能有助于设置**跨度**。**`z-index: 1`**

# pdf - 如何以编程方式将 pdf 注释（例如用矩形包围的公式）导出为图像？

> ID：12096412
> 
> 赞同：1
> 
> 时间：2012-08-23T16:42:06.703
> 
> 标签：pdf

我想知道是否可以将一些注释导出为图像。我已经知道如何将突出显示的文本导出为文本，但这不适用于方程式。如果方程式由注释表示，例如围绕它们的框，我可以使用 pdf 快照工具将它们一次全部转换为图像吗？

使用 pdf 快照工具可以轻松地手动完成每一项操作。任何 pdf 库或程序是否有任何工具可以让您以编程方式制作图像快照，而不是整个页面，而是以某种方式用注释标记的单个方程？

就问题而言，它们不一定是免费程序。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T22:25:30.057

我在这里提出了一个完整的基于 ruby​​ 的解决方案，使用 ruby​​ gems pdf-reader 和 rmagick（以及安装 imagemagick）。

```
require 'pdf-reader'
require 'RMagick'

pdf_file_name='statmech' #without extension
doc = PDF::Reader.new(File.expand_path(pdf_file_name+".pdf"))
$objects = doc.objects

def convertpagetojpgandcrop(filename,pagenum,croprect,imgname)
   pagename = filename+".pdf[#{pagenum-1}]"
   #higher density used for quality purposes (otherwise fuzzy)
   pageim = Magick::Image.read(pagename){ |opts| opts.density = 216}.first
   #factors of 3 needed because higher density TODO: generalize to pdf density!=72
   #SouthWestGravity puts coordinate origin in bottom left to match pdf coords
   eqim =pageim.crop(Magick::SouthWestGravity,...    
   3*croprect[0],3*croprect[1],3*croprect[2]-3*croprect[0],3*croprect[3]-3*croprect[1])
   eqim.write(imgname)
end

def is_square?(object)
   object[:Type] == :Annot && object[:Subtype] == :Square
end
def is_highlight?(object)
   object[:Type] == :Annot && object[:Subtype] == :Highlight
end

def annots_on_page(page)
   references = (page.attributes[:Annots] || [])
   lookup_all(references).flatten
end

def lookup_all(refs)
   refs = *refs
   refs.map { |ref| lookup(ref) }
end

def lookup(ref)
   object = $objects[ref]
   return object unless object.is_a?(Array)
   lookup_all(object)
end

def highlights_on_page(page)
   all_annots = annots_on_page(page)
   all_annots.select { |a| is_highlight?(a) }
end

def squares_on_page(page)
   all_annots = annots_on_page(page)
   all_annots.select { |a| is_square?(a) }
end
def restricted_annots_on_page(page)
   all_annots = annots_on_page(page)
   all_annots.select { |a| is_square?(a)||is_highlight?(a) }
 end
#This block exports a jpg for each 'square' annotation in pdf
doc.pages.each do |page|
   eqnum=0
   all_squares = squares_on_page(page)
   all_squares.each do |annot|
  eqnum = eqnum+1
  puts "#{annot[:Rect]}"
  convertpagetojpgandcrop(pdf_file_name,page.number,annot[:Rect],...
      pdf_file_name+"page#{page.number}eq#{eqnum}.jpg")
   end
 end    

 #This block gives the text of the highlights and wikilinks to the images 
 #TODO:(needs to go in text file)
doc.pages.each do |page|
  eqnum = 0
  annots = restricted_annots_on_page(page)
  if annots.length>0
   puts "# Page #{page.number}"
  end
  annots.each do |annot|
if is_square?(annot)
   eqnum = eqnum+1
   puts "{{wiki:#{pdf_file_name}page#{page.number}eq#{eqnum}.jpg}}"
else
       puts "#{annot[:Contents]}"
end
  end
end 
```

此代码扩展了在线找到的 pdf-reader 和 rmagick gem 的示例代码。几行是原创的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T13:53:57.970

此代码示例使用[Amyuni PDF Creator .Net](http://www.amyuni.com/en/developer/pdfcreator/features/)，它将一次仅导出一个可见注释的页面：

```
using System.IO;
using Amyuni.PDFCreator;
using System.Collections;
//open a pdf document
FileStream testfile = new FileStream(filename, FileMode.Open, FileAccess.Read, FileShare.Read);
IacDocument document = new IacDocument(null);
document.SetLicenseKey("your license", "your code");
document.Open(testfile, "");

document.CurrentPageNumber = 1;
IacAttribute attribute = document.CurrentPage.AttributeByName("Objects");

// listobj is an array list of objects
ArrayList listobj = (System.Collections.ArrayList)attribute.Value;
ArrayList annotations = new ArrayList();
foreach (Amyuni.PDFCreator.IacObject iacObj in listobj)
{
    if ((bool)iacObj.AttributeByName("Annotation").Value)
    {
        annotations.Add(iacObj);
        // Put the annotation out of sight
        iacObj.Coordinates = Rectangle.FromLTRB(
                            -iacObj.Coordinates.Left,
                            -iacObj.Coordinates.Top,
                            -iacObj.Coordinates.Right,
                            -iacObj.Coordinates.Bottom);
    }
    else
        iacObj.Delete(false);
}

ArrayList images = new ArrayList();
int i = 0;
foreach (Amyuni.PDFCreator.IacObject iacObj in annotations)
{
    // Back on sight
    iacObj.Coordinates = Rectangle.FromLTRB(
                        -iacObj.Coordinates.Left,
                        -iacObj.Coordinates.Top,
                        -iacObj.Coordinates.Right,
                        -iacObj.Coordinates.Bottom);
    //Draw the page
    Bitmap bmp = new Bitmap(1000, 1000);
    Graphics gr = Graphics.FromImage(bmp);
    IntPtr hdc = gr.GetHdc();
    document.DrawCurrentPage(hdc.ToInt32(), true);
    gr.ReleaseHdc();
    images.Add(bmp);
    bmp.Save("c:\\temp\\image" + i + ".pdf");

    iacObj.Delete(false); // object not needed anymore
    i++;
} 
```

如果需要，您可以使用注释对象的坐标属性提取结果图像中与注释对应的部分。

如果要从矩形区域（注释或其他）中提取所有对象，可以通过调用[IacDocument.GetObjectsInRectangle方法来替换收集注释的循环](http://www.amyuni.com/WebHelp/Amyuni_PDF_Creator_for_NET/Amyuni_PDFCreator_IacDocument/Methods/GetObjectsInRectangle_Method.htm)

*通常的免责声明适用*

# iphone - 在一部手机上测试原生 iOS 应用程序有效，但在另一部手机上崩溃？

> ID：12096418
> 
> 赞同：0
> 
> 时间：2012-08-23T16:42:22.343
> 
> 标签：iphone, ios, xcode, ios5, sigabrt

我已经构建了一个可以在我的 iPhone 上打开但不会在我雇主的手机上打开的应用程序。

每次我尝试在雇主的手机上运行它时，XCode 都会报告“无法打开 [APP NAME]”。报告了 SIGABRT。

关于为什么它不会在一部手机上加载而在另一部手机上加载的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:44:08.077

您雇主的 iPhone 是否与您属于同一开发团队资料？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T23:42:04.603

尝试以下步骤：
1\. 登录开发中心
2\. 转到“iOS Provisioning Portal”（右侧链接）
3\. 单击左侧的“Provisioning”
4\. 编辑->修改您尝试使用的配置文件

你雇主的设备检查了吗？

# javascript - 如何使用javascript获得时间差？

> ID：12096420
> 
> 赞同：0
> 
> 时间：2012-08-23T16:42:27.770
> 
> 标签：javascript, timestamp

我试图`timeNow`在 javascript 中获取当前时间，并在 `timeEnd`脚本结束时获取脚本完成执行的时间，例如：

```
newDate = new Date();
timeNow = newDate.getTime();

for(i=0; i < 5; i ++){

    console.log("printing" + i);
}

timeEnd = timeNow - newDate.getTime();

console.log(timeEnd); 
```

我想以秒或毫秒为单位获取执行此脚本所需的时间，但结果为 0。我不明白为什么，您能帮我吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T16:44:22.077

对象一旦构建就不会一直滴答作响，`Date`它只代表一个瞬间。

您需要在脚本结束时重新评估时间，然后将该值与第一个值进行比较。

请注意，在现代 ES5 浏览器上，您可以使用“静态”[`Date.now()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/now)函数来获取当前时间。这比构建一个全新的`Date`对象更便宜。在较旧的浏览器上，您可以使用此 shim 模拟此功能：

```
Date.now = Date.now || function() {
    return +(new Date);
}; 
```

此时所需的代码变为：

```
var start = Date.now();

// do your stuff here
...

var end = Date.now();

var elapsed = end - start; 
```

FWIW，在我笔记本电脑的 Chrome 控制台上运行时，您的简单循环报告 2ms。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T16:45:23.543

发生这种情况是因为您只创建了一个`Date`对象。这些不会改变；你必须这样做：

```
timeEnd = timeNow - new Date().getTime(); 
```

`new`（注意和之间的空格`Date`）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T16:45:57.193

```
var t = new Date().getTime();
// code
console.log(new Date().getTime() - t); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T16:43:38.200

因为我可以想象执行 5 次迭代需要不到一毫秒的时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T16:45:13.190

您可以使用

开始时间 = 数字（新日期（））；

结束时间 = 数字（新日期（））；

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T16:45:43.430

我实际上认为它不会在不到一毫秒的时间内迭代。它认为问题在于，当您`newDate.getTime()`重复调用时，它每次都返回相同的值。对象一旦创建，就会在创建时设置。您需要创建一个新`Date()`对象来比较原始对象。

从我的 Firebug 控制台：

```
>>> d = new Date()
Date {Thu Aug 23 2012 10:45:52 GMT-0600 (Mountain Daylight Time)}
>>> d.getTime()
1345740352582
>>> d.getTime()
1345740352582
>>> d.getTime()
1345740352582
>>> d.getTime()
1345740352582 
```

我可以向您保证，我没有`d.getTime()`在不到一毫秒的时间内手动拨打电话。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-23T16:56:15.053

基本上，这样做

```
newDate = new Date();
timeNow = newDate.getTime();

for(i=0; i < 50; i++){
    console.log("printing" + i);
}

futureDate = new Date()
timeEnd =  futureDate.getTime();
timeLength = timeEnd - timeNow;

console.log(timeLength); 
```

# ios - 如何更改 UIWebView 的 window.navigator.userAgent 值

> ID：12096421
> 
> 赞同：0
> 
> 时间：2012-08-23T16:42:29.977
> 
> 标签：ios, ios5, uiwebview

有[几种方法](https://stackoverflow.com/questions/478387/change-user-agent-in-uiwebview-iphone-sdk)可以更改UIWebView 发送的用户代理**标头。**但是，JS 在任何页面上检索到的*window.navigator.userAgent*的值始终包含相同的值，例如“Mozilla/5.0 (iPad; U; CPU OS 4_2 like Mac OS X; en-us) AppleWebKit/533.17.9 ( KHTML，如 Gecko) Mobile/8C134"。

有什么方法可以更改该值而无需修改 HTML 响应（并插入一些 JS）？

提前致谢！

# delphi - 德尔福 BDE 发行 $2501

> ID：12096422
> 
> 赞同：0
> 
> 时间：2012-08-23T16:42:31.600
> 
> 标签：delphi, bde

> **可能重复：**
> [Vista 上的 BDE 初始化失败（错误 $2501）](https://stackoverflow.com/questions/866485/bde-initialization-failure-error-2501-on-vista)

这些天来，我们的客户在尝试打开共享相同别名的两个应用程序实例时不断遇到错误代码为 $2501 的 BDE 问题

> 尝试初始化 Borland 数据库引擎时出错（错误 $2501）

但是如果关闭其中一个，或者只打开一个实例，问题就消失了。

而且我尝试配置 SHAREMEMSIZE 和 SHAREMEMLOCATION，但没有运气问题仍然存在。

有什么办法绕过它吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T20:19:12.910

我们基于 Paradox/BDE 的软件正在运行，有数千个联网的、五个左右的用户/安装在不同的城市和公司

在过去的几年里，我们已经在其中几十个设备上看到了可怕的 2501 美元错误。

SHAREDMEMSIZE=4096 和 SHAREDMEMLOCATION=0x5BDE 一直帮助我们克服这个错误。

所以，振作起来！BDE*仍然*存在，距上次更新已有十多年了。

我们都应该转向更现代的平台吗？是的！

我们中的许多人是否对其 LocalSQL 等的缺点感到沮丧？是的！

我们中的许多人是否对它仍然有效而印象深刻？是的！

我们中的许多人是否坚持维护旧代码，这些代码对于迁移到新数据库来说太昂贵了？是的！（沉重的叹息）

# javascript - 使用异步 URL 请求更新打开的图层弹出窗口

> ID：12096427
> 
> 赞同：1
> 
> 时间：2012-08-23T16:42:51.523
> 
> 标签：javascript, xmlhttprequest, openlayers

我的 mapsApp 使用 openLayers 弹出窗口作为地图上的标记。当我创建弹出窗口时，我使用链接和 CSS 微调器预填充它。然后我启动一个异步 URL 请求。

然后我想要做的是删除微调器，然后添加我从 URL 请求中收到的信息。我不知道如何引用弹出窗口的 html 部分（finalString）。

这是我的代码。

```
function showPopUp (markerID,itemID) {

// **Tested** this creates a spinner and works with CSS

wxString =   "<div class=\"spinner\" style=\"width: 34px; height: 34px\"><div class=\"bar1\"></div><div class=\"bar2\"></div><div class=\"bar3\"></div><div class=\"bar4\"></div><div class=\"bar5\"></div><div class=\"bar6\"></div><div class=\"bar7\"></div><div class=\"bar8\"></div><div class=\"bar9\"></div><div class=\"bar10\"></div><div class=\"bar11\"></div><div class=\"bar12\"></div></div>";
}

var markerString =   "<a title=\""+itemID+"\" href=\"http://www.mywebsite.com/item/"+itemID+"\" target=\"_blank\">"+itemID+"</a>";
var finalString = markerString + "</br>"+ wxString;

popup = new OpenLayers.Popup.FramedCloud(icaoID,
                     markerID.lonlat,
                     new OpenLayers.Size(200, 200),
                     finalString,
                     null, true);

map.addPopup(popup);
getWX(itemID,popup);        //asynch request that will remove the popup
} 
```

我的 getWx 函数使用 XMLhttp 请求

```
function getWX (item) {

if (window.XMLHttpRequest) {    // code for IE7+, Firefox, Chrome, Opera, Safari
    xmlhttp=new XMLHttpRequest();
}
else {                          // code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}

xmlhttp.onreadystatechange=function() {

    if (xmlhttp.readyState==4 && xmlhttp.status==200) {     //If finished loading

        return xmlhttp.responseText; 
    }
}

xmlhttp.open("GET","getwx.php?q=" + item,true);
xmlhttp.send();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:03:58.680

我可以帮助您完成第一步 - 访问您的弹出对象。但是我还没有找到调用构造函数后如何更改文本的方法。

（**编辑** Popup 对象有一个`setContentHTML`函数，该函数将由`FramedCloud`类继承。）

您正在`getWX`使用两个参数调用该函数，但您只接受一个。首先添加弹出对象，如下所示：

```
function getWX (item, popup) 
```

然后当呼叫准备好（readyState == 4）时，更改弹出窗口文本：

```
if (xmlhttp.readyState==4 && xmlhttp.status==200) {     //If finished loading

    popup.setContentHTML(xmlhttp.responseText); 
} 
```

如果您在创建弹出窗口之前等待文本，也许会更容易？

然后它会是这样的：

传入对地图对象的引用：

```
function getWX (item, map) 
```

文本准备好后创建弹出窗口：

```
if (xmlhttp.readyState==4 && xmlhttp.status==200) {     //If finished loading
     popup = new OpenLayers.Popup.FramedCloud(icaoID,
                 markerID.lonlat,
                 new OpenLayers.Size(200, 200),
                 finalString,
                 null, true);

    map.addPopup(popup);
} 
```

# objective-c - NSXMLParser：如何提取标签和属性不变的字符串

> ID：12096436
> 
> 赞同：0
> 
> 时间：2012-08-23T16:43:13.887
> 
> 标签：objective-c, xcode, nsxmlparser

我正在做一些有点奇怪的事情。是否可以使用 XML 解析器提取部分 XML 文件而不对其进行解析，而是将其提取为字符串。

```
<root>
    <element>
      <don't parse>it amet, consectetur<tag> adipiscing</tah> elit. Vestibulum ac viverra nulla. Donec dapibus, eros dapibus eleifend aliquet, turpis nulla aliquam libero
      </don't parse> //resume parsing
    </element>
</root> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:59:33.077

您可以尝试使用 CDATA 标签

```
<root>
    <element>
      <![CDATA[
          <don't parse>it amet, consectetur<tag> adipiscing</tah> elit. Vestibulum ac viverra nulla. Donec dapibus, eros dapibus eleifend aliquet, turpis nulla aliquam libero
          </don't parse> //resume parsing
    ]]>
    </element>
</root> 
```

# jquery - 如何：从一个背景图像滑动到另一个 100% 的高度和宽度

> ID：12096438
> 
> 赞同：0
> 
> 时间：2012-08-23T16:43:34.470
> 
> 标签：jquery, css, background, slider, position

嘿伙计们（可能还有女孩！）

我正在寻找一种将背景图像向左滑动并让另一个背景图像替换从右侧滑入的第一个背景图像的方法。这需要进行设置，以便可以替换图像（因此，当您单击页面时，会出现唯一图像并替换前一个图像）。

我已经很好地尝试了一些东西，比如 jQuery`animate`函数：`animate("backgroundPosition: "-" + $(window).width() + " 0px");`

这与这个插件配合得很好：http: [//keith-wood.name/backgroundPos.html](http://keith-wood.name/backgroundPos.html)

目前，我在正文之后有一个 div 标签，高度和宽度为 100%，绝对位置和 z-index:-1。它的静态效果很好，但我无法找到一种平滑的方法来删除它（到侧面），同时从左侧加载另一个图像并滑过替换旧图像。

我已经尝试了大多数事情，但如果有人对如何正确解决这个问题有任何想法，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:54:13.980

与其使用背景位置，为什么不在相邻的绝对定位`div`的 s 中使用静态定位的背景？`div`与您要过渡到的背景保持第二个屏幕外，然后`div`将原始屏幕和屏幕上的新屏幕同时滑动。

`div`您可以通过随后销毁 offscreen并在屏幕外使用序列中的下一个背景在另一侧重新创建它来使效果持续。

# python - 在模板中使用 django 会话

> ID：12096440
> 
> 赞同：4
> 
> 时间：2012-08-23T16:43:36.670
> 
> 标签：python, django, django-templates, django-sessions

```
# views.py
def like(request,option="food",restaurant = 1):
    if request.is_ajax:
        like = '%s_like' % str(option)
        if 'restaurants' in request.session:
            if restaurant not in request.session['restaurants']:
                request.session['restaurants'][restaurant] = {}
            x = request.session['restaurants'][restaurant].get(str(like),False)
            if x:
                return HttpResponse(False)
            else:
                request.session['restaurants'][restaurant][str(like)] = True
                request.session.modified = True

        else:
            request.session['restaurants'] = {}
        request.session.modified = True 
```

我正在使用`context_instance = RequestContext(request)`该会话变量可用，同时呈现响应。我的模板：

```
{% if request.session.restaurants.rest.id.food_like %}
working
{% else %}
    failed
{% endif %} 
```

我的视图会话密钥如下所示：

```
request.session["restaurants"][restaurant][like] = True 
```

餐厅 ID在哪里`restaurant`，like 可以是“food_like”、“service_like”、“special_like”之一。

那么我应该如何在我的模板中访问它呢？例如，如果我使用

```
request.session.restaurants.rest.id.food_like 
```

它肯定行不通。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T17:22:01.543

你可能没有`django.core.context_processors.request`在你的`settings.TEMPLATE_CONTEXT_PROCESSORS`.

您可以尝试`{{ request }}`在模板中打印，如果它什么也没显示，那么您就没有它。

您也可以使用 ./manage.py shell 检查它：

```
from django.conf import settings
print settings.TEMPLATE_CONTEXT_PROCESSORS 
```

如果`django.core.context_processors.request`不存在，`TEMPLATE_CONTEXT_PROCESSORS`则从 shell 输出复制到您的 settings.py 中，并添加`django.core.context_processors.request`到此列表中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-09T14:41:50.700

补充@jpic 响应。
您可以执行以下操作，而不是从 shell 复制内容 TEMPLATE_CONTEXT_PROCESSORS：

```
from django.conf import global_settings
TEMPLATE_CONTEXT_PROCESSORS = global_settings.TEMPLATE_CONTEXT_PROCESSORS + (
    "django.core.context_processors.request",
) 
```

这样，您的全局设置将被保留。
确保保留尾随逗号，以便 python 可以将其视为元组

# javascript - twitter bootstrap 缩略图每行的元素数

> ID：12096446
> 
> 赞同：0
> 
> 时间：2012-08-23T16:43:59.003
> 
> 标签：javascript, jquery, twitter-bootstrap

使用 twitter bootstrap 的缩略图时，是否可以使用 jquery（或其他任何东西）确定每行呈现的元素数量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T10:31:39.803

可能有一种更简单的方法来做到这一点，但这是我想出的：

[http://jsfiddle.net/Ejynp/](http://jsfiddle.net/Ejynp/)

变量`thumbnailcount`包含数字。

# php - 如何使用 pdo 检查表是否存在

> ID：12096452
> 
> 赞同：-2
> 
> 时间：2012-08-23T16:44:10.843
> 
> 标签：php, mysql

> **可能重复：**
> [MySQL 检查表是否存在而不抛出异常](https://stackoverflow.com/questions/1525784/mysql-check-if-a-table-exists-without-throwing-an-exception)

基本上我有我的 MySQL dbname = test 和我的表名 = page。

我想使用 php PDO 创建一个查询来检查我的数据库“test”中是否存在表“page”

我试过这个，但它确实有效..它总是告诉我它不存在..即使它确实存在

```
if (array_search('pages',$db->query('show tables')->fetch()) !== false) { echo "the db exists";

    } else { echo "the db doesnt exists";
    // Create tableS
    //$IDB->execute();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:50:06.247

PDO 中的现有表没有预定义测试，您必须执行以下操作：

```
$pdo = new PDO($dsn,$user,$pass,$options);
$results = $pdo->query('SHOW TABLE LIKE \'page\'');
if(count($results)>0){echo 'table exists';} 
```

# javascript - jquery 无法处理附加内容（无限滚动后）

> ID：12096461
> 
> 赞同：0
> 
> 时间：2012-08-23T16:44:32.880
> 
> 标签：javascript, jquery, ruby-on-rails-3.2

我有一个 jquery 函数，它在元素循环中的每个元素上显示隐藏的内容。这完美地工作，但问题是当我将新元素附加到循环时它停止工作。它实际上适用于某些元素，但不适用于其他元素（奇怪的行为）。

```
 <script type="text/javascript">
  jQuery(document).ready(function($) {

  $(".see_all").click(function(){

  if ($(this).next().css('display') == 'none'){
  $(this).next().show();

  }
  else

  if($(this).next().is(':visible')){
  $(this).next().hide();
  }

  });
  })
  </script> 
```

html代码

```
 <div class="center_container">
   <%for users in @user%>
   <div class="see_all">

   <span style="color:#808080;cursor:pointer">See All Reviews(<%=@beep_count=           (@beep.opposes.count +  @beep.neutrals.count + @beep.supports.count)%>)</span>

   </div>

   <div style="display:none;" class="hidden">

    No reviews available 

    </div>
   <%end%>

   </div> 
```

我试过用这个解决它

```
 $("body").on("click", ".see_all", function() { 
   if ($(this).next().css('display') ==   'none')
    { 
    $(this).next().show(); 
    } 
    else 
    if($(this).next().is(':visible'))
    {                    
    $(this).next().hide(); 
    } 
    }); 
```

但它没有用。我在我的新 jquery 解决方案中犯了一个错误:(

**请帮忙**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T11:00:31.400

已解决....我发现我的 jquery 文件存在兼容性问题

# c# - foreach 语句不能对 Dars 类型的变量进行操作 不包含“GetEnumerator”的公共定义

> ID：12096462
> 
> 赞同：0
> 
> 时间：2012-08-23T16:44:40.573
> 
> 标签：c#, list, foreach, ienumerator

我有一个列表 Dars

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace PantaRei.Components
{
    public class Dars
    {
        public float OpBal      { get; set; }
        public float PlNeOrRec  { get; set; }
        public float MiCaCol    { get; set; }
        public float MiDeCol    { get; set; }
        public float MiWrOff    { get; set; }
        public float ClBal      { get; set; }

        public float Tot
        {
            get { return OpBal+ PlNeOrRec+ MiCaCol + MiDeCol + MiWrOff; }
        }
    }
} 
```

我创建了一个新的 dars

```
Dars secA1 = new Dars(); 
```

然后我用这段代码来填充它

```
public static void GetData(ref Dars secA1, Ddr ddr, Ddrs ddrs, Type pTypes)
    {
        Array typesEnum = Enum.GetValues(pTypes);

        foreach (Enum types in typesEnum)
        {
            string pType = StringEnum.GetStringValue(types);

            secA1.OpBal = ddrs.Out.Sum(o => o.Amount);

            secA1.MiDeCol += ddr.Dil.Where(dil => dil.ProductType == pType && dil.ToBeSold).Sum(dil => dil.Amount);

            secA1.PlNeOrRec += ddr.Rec.Where(rec => rec.ToBeSold).Sum(rec => rec.Amount);

            GetMiCaCol(ref secA1, ddr, pType);
            GetMiWrOff(ref secA1, ddr, pType);
        }
    } 
```

现在我想做这样的事情

```
int i = 11;
            foreach (float g in secA1)
            {
                daily.Cells[i, 4] = g;
                i++;
            } 
```

但我收到了这个错误

> foreach 语句不能对“PantaRei.Components.Dars”类型的变量进行操作，因为“PantaRei.Components.Dars”不包含“GetEnumerator”的公共定义

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T16:59:51.600

仅仅因为一个类有一个恰好是`float`s 的属性的集合，它并不能使它成为一个集合。您的代码似乎正在做一些使用某种数据绑定更合适的事情。您尝试做的事情*可以*通过标记`Dars`为实现`IEnumerable`接口，并添加`GetEnumerator`返回类中浮点属性值的方法的实现来完成，但我绝不会在代码审查中宽恕这种方法。话虽如此，试试这个（如果你必须）：

```
public class Dars : IEnumerable
{
    public float OpBal { get; set; }
    public float PlNeOrRec { get; set; }
    public float MiCaCol { get; set; }
    public float MiDeCol { get; set; }
    public float MiWrOff { get; set; }
    public float ClBal { get; set; }

    public float Tot
    {
        get { return OpBal + PlNeOrRec + MiCaCol + MiDeCol + MiWrOff; }
    }

    public IEnumerator GetEnumerator()
    {
        yield return this.OpBal;
        yield return this.PlNeOrRec;
        yield return this.MiCaCol;
        yield return this.MiDeCol;
        yield return this.MiWrOff;
        yield return this.ClBal;
        yield return this.Tot;
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T16:57:29.923

尚不*完全*清楚您要做什么，但您*可能*只想实现一个返回`IEnumerable<float>`使用迭代器块的方法：

```
public class Dars
{
    public float OpBal      { get; set; }
    public float PlNeOrRec  { get; set; }
    public float MiCaCol    { get; set; }
    public float MiDeCol    { get; set; }
    public float MiWrOff    { get; set; }
    public float ClBal      { get; set; }

    public IEnumerable<float> GetValues()
    {
        yield return OpBal;
        yield return PlNeOrRec;
        yield return MiCaCol;
        yield return MiDeCol;
        yield return MiWrOff;
        yield return ClBal;
    }

    public float Tot
    {
        get { return OpBal+ PlNeOrRec+ MiCaCol + MiDeCol + MiWrOff; }
    }
} 
```

...或者您可以创建 a`List<float>`或 a`float[]`并从方法中返回它：

```
public IEnumerable<float> GetValues()
{
    return new[] { OpBal, PlNeOrRec, MiCaCol, MiDeCol, MiWrOff, ClBal };
} 
```

当然，如果这不是您想要的，您应该调整顺序。

（顺便说一句，这些是非常可怕的属性名称。它们真的是您的代码公开的吗？）

# javascript - Facebook 应用程序在 Chrome 中失败

> ID：12096464
> 
> 赞同：0
> 
> 时间：2012-08-23T16:44:54.207
> 
> 标签：javascript, facebook, google-chrome

我正在尝试查看 FB 应用程序，但它失败并出现下一个错误：

```
Unsafe JavaScript attempt to access frame with URL https://www.facebook.com/dialog/ from frame with URL URL. Domains, protocols and ports must match. 
```

我能做些什么来解决它？这只发生**在 Chrome 中**。

我从错误中删除了一些信息，这不是必需的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:03:43.900

我想这是 SSL 的问题

请参阅：[https ://developers.facebook.com/blog/post/497/](https://developers.facebook.com/blog/post/497/)

为了

今天，我们宣布更新我们的开发者路线图，其中概述了一项计划，要求所有网站和应用程序迁移到 OAuth 2.0、处理 signed_request 参数并在 10 月 1 日之前获得 SSL 证书。

# python - db.Query.fetch(limit) 返回所有结果而不是 limit

> ID：12096465
> 
> 赞同：0
> 
> 时间：2012-08-23T16:45:06.053
> 
> 标签：python, google-app-engine

我在 python 2.7 上使用 appengine，并通过以下调用查询数据库实体：

```
query = Model.all().filter("profile =", p_key)
query.order('-created')
query.run(limit=10)
logging.debug('count is %i' % query.count()) #shows 35 instead of 10 
```

我也尝试过使用 query.fetch(10) 但仍然返回所有结果而不是限制。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:54:51.513

根据 GAE[文档](https://developers.google.com/appengine/docs/python/datastore/queryclass)- 你试过了吗

```
query.fetch(limit = 10) 
```

您是否还验证了您的过滤器是否有效（没有任何限制命令）-这是有关[过滤器的文档](https://developers.google.com/appengine/docs/python/datastore/queryclass#Query_filter)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-23T17:56:35.287

您没有更新`query`变量。

做这个：

```
query = Model.all().filter("profile =", p_key)
query = query.order('-created')
query = query.run(limit=10) 
```

现在结果被分配给你的`query`变量。
您正在查询但没有将其分配给任何东西。

# jquery - 忽略 JQuery 可视化中的表列

> ID：12096470
> 
> 赞同：0
> 
> 时间：2012-08-23T16:45:13.570
> 
> 标签：jquery, charts, visualize

我试图从这里使用 Jquery Visualize 从表中获取一些图表：http: [//filamentgroup.com/lab/update_to_jquery_visualize_accessible_charts_with_html5_from_designing_with/](http://filamentgroup.com/lab/update_to_jquery_visualize_accessible_charts_with_html5_from_designing_with/)

出于某种原因，我无法让它显示图表图例/关键哪些类别在第一列中，它只包含图表中的第一列值，它不显示任何内容，因为它们是文本（团队名称)，其余表格是那些团队的销售统计数据。

是否有选项或任何东西可以让它将第一列识别为系列名称？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T18:02:28.273

希望您已经找到了答案，但对于未来的搜索者，包含您的系列名称的列应该是`<th>`带有`scope='row'`. 可视化函数在构建图表时会查找这种类型的标签，以了解系列名称是什么，如果失败，则将它们设为所有数据集。

# c# - 错误：检测到 CallbackOnCollectedDelegate

> ID：12096472
> 
> 赞同：0
> 
> 时间：2012-08-23T16:45:18.767
> 
> 标签：c#, delegates, callback

我目前正在研究第三方 dll，并且在`OnReceive`调用委托时随机出现以下错误：

> 检测到 CallbackOnCollectedDelegate

我读到`GC.Collect()`可以使用静态解决问题，但也不能解决问题，我有几个小时并尝试各种方法`CallbackOnCollectedDelegate`得到错误，请帮助...

```
namespace Interfaz
{
    class TMPDlg:
    {
        public CTMIF m_objTMPInterface;

        public uint m_dwLocalIP;
        public ushort m_nPort;
        public byte m_nSubNet;
        public uint m_nRadioID;
        public uint m_nIndex;
        public uint m_dwMobileID;
        public int nLength;
        public string mensaje_destino;
        public string mensaje_recibido;        

        public TMPDlg()
        {
            m_objTMPInterface = null;
        }

        unsafe public void OnReceive(ushort wOpcode, System.IntPtr pbPayload, uint dwSize, uint dwLocalIP)
          {
              TMReceive(wOpcode, (byte*)pbPayload, dwSize, dwLocalIP);
          }

        unsafe public void TMReceive(ushort wOpcode, byte * pbPayload, uint dwSize, uint dwLocalIP)
          {
             // Some Work....
          }

        public void Send_PrivateMsg(string textBoxMensaje, string labelID)
        {
            m_nRadioID = uint.Parse(labelID);
            mensaje_destino = textBoxMensaje;
            nLength = textBoxMensaje.Length;

            m_objTMPInterface.SendPrivateMsg(m_nRadioID, mensaje_destino, nLength, 0);

        }

        public void conect_master(ushort port, string ip)
        {
            m_objTMPInterface = new CTMIF();
            m_dwLocalIP = (uint)IPAddressToNumber(ip);

            ADKCALLBACK myOnReceive = new ADKCALLBACK(OnReceive);
            m_objTMPInterface.SetCallBackFn(myOnReceive);

        //m_objTMPInterface.SetCallBackFn(OnReceive);        
            m_objTMPInterface.OpenSocket(m_dwLocalIP, port, m_dwMobileID, 10)<

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:50:17.883

想必这部分有问题？

```
ADKCALLBACK myOnReceive = new ADKCALLBACK(OnReceive);
m_objTMPInterface.SetCallBackFn(myOnReceive); 
```

如果你有一个type 的*实例*变量`ADKCALLBACK`，那么只要你的实例在回调函数执行之前（或同时）没有被垃圾收集，你应该没问题。是什么控制着您的实例的生命周期？

```
class TMPDlg
{
    // Instance variable to protect from garbage collection
    private readonly ADKCALLBACK receiveCallback;

    public TMPDlg()
    {
        receiveCallback = myOnReceive;
    }

    ...

    public void ConnectMaster(ushort port, string ip)
    {
        ...
        m_objTMPInterface.SetCallBackFn(receiveCallback);
        ...
    }
} 
```

（顺便说一句，您的命名可能会得到显着改进，并且您应该避免使用公共字段。）

# java - 将 Python 转换为 Java 以在 Android/iOS 上运行

> ID：12096477
> 
> 赞同：1
> 
> 时间：2012-08-23T16:45:44.243
> 
> 标签：java, python

我有一个我刚刚完善的 Python 脚本。

我曾希望在不必了解太多 Java 的情况下轻松将其转换为 Java，我的目标是让它在 Android 或 iOS 上轻松运行。

它本质上是一个农业机器人，用于我和一群朋友一起玩的游戏。它主要处理 Http 请求，但我对 Java 知之甚少，甚至开始都很难。我知道如何发出请求，但对 Java 了解不够，无法解码 JSON 返回。

有什么建议吗？我曾考虑过使用 Jython 进行编译，但我也不确定这是否对我有帮助。我试图保持这个非常简单，而不是使用设置起来很痛苦的 Android python 脚本。我真的很想引导每个人完成他们手机上的设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:59:45.647

# css - 试图选择一个 div，其父级的前一个兄弟包含一个具有特定类的 div

> ID：12096478
> 
> 赞同：0
> 
> 时间：2012-08-23T16:45:44.923
> 
> 标签：css, css-selectors

我有一些这样的标记：

```
<div class="field">
    <div class="selector" id="uniform-blablabla">
        [select tag markup]
    </div>
<div>
<div class="field">
    <input type="text" id="etcetc"
</div> 
```

我正在寻找一个 css 选择器，它将根据其包含的 .field div 前面是一个包含具有 .selector 类的 div 的 .field div 的事实来选择上面的输入标记，如上面的标记中所示。我试过了

```
div.field > .selector + div.field > input 
```

但这不起作用，我假设因为输入标签不是具有 .selector 类的 div 标签的兄弟姐妹，我真的需要他们的父母成为兄弟姐妹。

我已经阅读了 CSS 不支持任何类型的“父”选择器的一些有趣原因，我明白了原因。我想知道是否有另一种方法可以实现这一点，除了在选择器后面的每个输入标签上放置一个类。在那儿？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:47:21.980

> 我想知道是否有另一种方法可以实现这一点，除了在选择器后面的每个输入标签上放置一个类。在那儿？

不使用 CSS 选择器。`div`您将不得不根据前面的兄弟姐妹`div.selector`作为孩子添加一个额外的类。

# c - C 中的共享库和二进制文件

> ID：12096480
> 
> 赞同：1
> 
> 时间：2012-08-23T16:45:50.470
> 
> 标签：c, shared-libraries, freebsd

我接管了相当大的 C 代码。有很多遗留二进制文件需要旧版本的共享库。服务器从来没有这些确切库的版本。我可以重新编译或设置将旧版本连接到新版本的符号链接。设置符号链接需要一些时间 - 有没有标准或智能的方法来做到这一点？我对此很陌生，并会很感激任何提示。这全是 C 和 FreeBSD 环境。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:59:06.517

通常，在使用新库更新遗留代码时，最好通过针对新库及其包含重新编译源代码来执行检查。这将允许您使用编译器检查新旧库之间在数据类型、函数签名等方面的不一致。

通过重新编译，您还可以检查新库是否提供了您需要的所有依赖项。

最后，重新编译将帮助您检查您实际上是否能够重新编译和链接所有内容并拥有所有必要的组件。

走捷径，例如使用符号链接，我会感到不舒服。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-02T20:30:11.197

共享库版本号仅应在 ABI 更改时更改。（旧版本的 FreeBSD 并没有完全做到这一点，它在较新的版本中得到了修复，但仅适用于系统库！）所以使这些应用程序正常工作的唯一方法是重新编译它们，或者提供确切版本的他们链接的共享库。对于仅依赖于旧版本的 FreeBSD 系统库的程序，您可以安装 compat[45678]x 软件包，它提供了随指定操作系统版本提供的库的版本——但存在重大缺陷：

1）如果您的应用程序所依赖的某些库链接到的标准库版本比您的应用程序本身更新的版本，动态链接器将为您提供两个不兼容的标准库副本，并且事情不太可能工作。

2) 如果您的应用程序使用 dlopen() 加载外部模块或插件，那么所有的赌注都没有了，因为这些模块没有版本控制。

FreeBSD 8 和更新版本对 C 库和其他一些重要的系统库使用符号版本控制，因此这些库不应再次更改库版本，并且将保留 ABI 兼容性。很多第三方开发者就不是那么小心了，既会在不改库版本的情况下破解ABI，又在不破解ABI的情况下更改库版本，这样就无法取胜。（有些开发者不阅读文档，认为共享库版本号应该与产品的版本号相同。）

# c# - 将构造函数转换为方法

> ID：12096486
> 
> 赞同：0
> 
> 时间：2012-08-23T16:46:14.893
> 
> 标签：c#, dynamic, methods, constructor, runtime

由于糟糕的早期设计，我有很多控件（typeof（`MyControl`)) 通过调用构造函数填充数据（填充功能写在构造函数中，而不是在分离的方法中）。现在我需要更新这些控件中的数据，但我不想处理当前的控件实例，然后再次创建它只是为了填充新数据。由于有许多控件，我也不想将任何抽象方法 FillWithData 添加到 MyControl 中，然后在每个子控件中实现它。我的目标是动态创建与 Constructor 具有相同主体的方法（可能没有 InitializeComponents() 方法 - 但没关系）以及相同的参数 - 然后我将这个新方法“添加”到 MyControl 的运行实例中并填充此控件使用此新方法而不是构造函数使用新数据。如果可以制作类似的东西，那将是最好的：

```
MyControlTextBox mct = new MyControlTextBox();

MethodBuilder newMethod = new MethodBuilder("newMethod");
newMethod.SetParameters(constructorParameters
newMethod.CreateBody(mct.getType().GetMethodBody());

mct.AddMethod(newMethod); 
```

或者

```
mct.getType().GetMethod("methodWhichBodyIWannaChange") = newMethod; 
```

接着

```
mct.getType().GetMethod("newMethod").Invoke(newData...); 
```

有可能实现这样的目标吗？我可以轻松地将任何新的虚拟方法或委托添加到 MyType 中，然后如果可能的话，用我的新方法对其进行更改，并且它比将新方法添加到正在运行的实例中“更真实”。我在看 MethodBuilder 但它非常复杂，我必须指定许多其他选项，我不确定它是否能够做我想做的事。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:29:45.400

您是否尝试过使用 OpCodes.Call 来调用构造函数？我知道至少可以通过 OpCodes.Call 调用结构构造函数。

# c# - 如果要删除的当前节点子节点是最后一个子节点，则树视图删除父节点

> ID：12096489
> 
> 赞同：-1
> 
> 时间：2012-08-23T16:46:26.223
> 
> 标签：c#, winforms, treeview

我无法从树中删除“current_node”的父节点。这是我正在尝试的：我正在为 VSTO 使用 C# .NET 进行开发

```
TreeGridNode current_node = myTreeGrid.CurrentNode;
TreeGridNode parent_node = myTreeGrid.CurrentNode.Parent;
// this works
myTreeGrid.Nodes.Remove(current_node);

if (parent_node.Nodes.Count == 0) {
    // it never gets here, it doesn't detect that the lats child was just removed above
    myTreeGrid.Nodes.Remove(parent_node);
} 
```

使用此自定义结构 [http://blogs.msdn.com/b/markrideout/archive/2006/01/08/510700.aspx](http://blogs.msdn.com/b/markrideout/archive/2006/01/08/510700.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:04:22.340

我相信你的问题是你试图从而不是父母 中`current_node`删除。不包含对 的引用，因此调用基本上什么都不做。`myTreeGrid``current_node``myTreeGrid.Nodes``current_node``myTreeGrid.Nodes.Remove(current_node)`

由于没有删除任何内容，因此`parent_node.Nodes`仍然包含对`current_node`. 尝试`current_node`直接从中删除`parent_node.Nodes`，您的问题可能会得到解决：

**改变：**

```
myTreeGrid.Nodes.Remove(current_node); 
```

至

```
parent_node.Nodes.Remove(current_node); 
```

# jquery - 使用单选按钮触发多个 jQuery 切换

> ID：12096490
> 
> 赞同：0
> 
> 时间：2012-08-23T16:46:27.893
> 
> 标签：jquery, radio-button, toggle

我已经设法弄清楚当用户单击单选按钮时如何显示 div。

演示：http: [//jsfiddle.net/6Lwfc/](http://jsfiddle.net/6Lwfc/)

问题是，如果我在一个页面上有多个这样的测验，单击一个单选按钮将触发所有这些测验来显示他们的答案。

我尝试更改类（例如 selfTestAnswer2、selfTestAnswer3）以将它们分开，但这没有帮助。我的猜测是因为单击单选按钮对所有这些都是相同的。

我怎样才能将这些分开，以便我可以在一页上放 2 或 3？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:54:07.923

干得好：

[http://jsfiddle.net/6Lwfc/4/](http://jsfiddle.net/6Lwfc/4/)

```
$('.selfTestWrong', $(this).parent()).addClass('answerShown');
$('.selfTestAnswer', $(this).parent()).slideDown(300); 
```

你需要一个上下文。另外，我删除了你的欺骗 ID 标签。切勿在页面上重复 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:57:54.600

另一个在父元素上使用 id 的示例。[http://jsfiddle.net/sailorob/wHULM/](http://jsfiddle.net/sailorob/wHULM/)

# r - 删除 facet_wrap 图中的“浮动”轴标签？

> ID：12096492
> 
> 赞同：15
> 
> 时间：2012-08-23T16:46:36.380
> 
> 标签：r, ggplot2

在 ggplot2 中使用 facet_wrap 创建一个网格，但我的面板数量不均匀，所以最后一行不完整。在最后一个空白面板的底部是轴刻度和文本。是否可以将此轴向上移动（使每列中的最后一个方面看起来像是应用了 free_x）？如果没有，我可以完全删除它，如下所示？

为了举例说明，这就是我得到的： [http ://sape.inf.usi.ch/sites/default/files/ggplot2-facet-wrap.png](http://sape.inf.usi.ch/sites/default/files/ggplot2-facet-wrap.png)

![在此处输入图像描述](../Images/2af8e871cdefbb552b5bd7740ab64f23.png)

我希望在这里看到一些东西（不过，理想情况下，在第 4 列的刻面上使用轴标签）： [将刻面标签更改为 ggplot2 中的数学公式](https://stackoverflow.com/questions/11979017/changing-facet-label-to-math-formula-in-ggplot2)

![在此处输入图像描述](../Images/6f9b686184365208c4ce65c2a93ef2ac.png)

感谢您的任何想法或见解！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:47:13.160

使用 facet_wrap，当我在 0.9.1 中执行此操作时，ggplot 用空白隐藏列上的 x 轴，如下所示。

```
movies$decade <- round(movies$year, -1)
ggplot(movies) + geom_histogram(aes(x=rating)) + facet_wrap(~ decade, ncol=5) 
```

![在此处输入图像描述](../Images/c6f03fffe3e52c69e9c9760abfb36ea7.png)

# mysql - 如何输入文字“？” 在带有绑定变量的 Mysql 查询中

> ID：12096496
> 
> 赞同：0
> 
> 时间：2012-08-23T16:46:46.793
> 
> 标签：mysql, variables, bind

我有以下查询：

```
select subclasses.id,participants_subclasses.participant_id
               from subclasses
              left outer join participants_subclasses on
                participants_subclasses.participant_id = ?
                and subclasses.id = participants_subclasses.subclass_id
           where
             subclasses.classification_id = ?
             and subclasses.showhover
           order by subclasses.seq,
      IF(LEFT(subclasses.code, 1) = '<',
   Extractvalue(subclasses.code, "//texts/text/content"),
 subclasses.code) 
```

上面的查询正在处理一个表，其中代码列有时包含文本，有时在标记内包含带有文本的 XML。上述查询有效。副作用是代码值不能以“<”开头，这应该是可以接受的，但 order by 会将其误认为是 XML 内容。下面的查询将更加具体和准确：

```
select subclasses.id,participants_subclasses.participant_id
           from subclasses
           left outer join participants_subclasses on
                participants_subclasses.participant_id = ?
                and subclasses.id = participants_subclasses.subclass_id
           where
             subclasses.classification_id = ?
             and subclasses.showhover
           order by subclasses.seq,
      IF(LEFT(subclasses.code, 5) = '<?xml',
   Extractvalue(subclasses.code, "//texts/text/content"),
 subclasses.code) 
```

但是，这种检查内容中 XML 标头的变体失败并显示“NameInput Array 不匹配？” MySQL 中的错误。看来? 内部`<?xml`文字被误认为是绑定目标。我正在传递 2 个要绑定的值 - 这又是正确的。

所以我的问题是 - 我如何让`<?xml`文字不会被误认为是绑定值目标？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T14:42:38.087

**解决了**

事实证明，这是 phpLens 的 ADODB 界面中的错误，而不是 MySQL 本身中的错误。它存在于 PHP5 的当前版本 5.17 中。

# html - 使用未转义的 & 符号“&”

> ID：12096499
> 
> 赞同：1
> 
> 时间：2012-08-23T16:47:05.877
> 
> 标签：html

我有一个用户上传内容的网站，他们可以命名他们上传的内容。一些用户在他们的名字中包含了“&”，我得到一个 html 验证错误。有什么方法可以让“&”保留并验证页面？这将非常有帮助。如果没有，我还可以采取哪些其他措施来验证我的页面？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:57:22.913

不，没有办法让页面使用无效内容进行验证。

而且，**您不应该在没有正确编码的情况下显示内容！**

很抱歉大喊大叫，但您的网站对跨站点脚本攻击很开放。任何人都可以将有害内容放入名称中，并且它将在其他人的浏览器中运行。

您如何执行此操作取决于您使用的平台。例如，在 ASP.NET 网络表单中，您将使用该`Server.HtmlEncode`方法对字符串进行 HTML 编码。在 ASP.NET MVC 中，您将使用相同的，或者只是`<%: %>`自动执行此操作的服务器标记。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T17:04:32.777

在 php 中，您将需要使用[htmlentities](http://php.net/manual/en/function.htmlentities.php)方法：

```
<?= htmlentities($username, ENT_QUOTES) ?> 
```

如果用户输入了哪个将输出`me&amp;myself`（在 html 页面上显示值的正确方法）`me&myself`

总是总是清理用户输入。永远不要相信客户端浏览器发送给您的任何数据。如果有人在表单字段中输入了某些内容，切勿将其直接粘贴在数据库查询中（使用类似 的内容对其进行清理`my_real_escape_string($user_input)`）。如果文本最初是由客户端提交的，切勿直接将文本打印到浏览器，始终将其转义（使用`htmlentities`）。

您这样做的原因是因为恶意用户可以通过提交触发某些 javascript 的数据以及网络钓鱼或窃取其他客户的数据来对您的站点执行跨站点脚本攻击。如果我将我的名字设置为，`<script type='javascript' src='http://mysite.com/bad-js.js' />`那么任何加载该页面的人都会在他们的浏览器上执行那个未知的和潜在的恶意 javascript，并访问他们的 cookie 和他们的会话。

# php - 将链接放在使用 mysql 的 php/html 表中

> ID：12096510
> 
> 赞同：0
> 
> 时间：2012-08-23T16:47:43.910
> 
> 标签：php, mysql, html

谁能帮忙？

抱歉，如果我很愚蠢，但我对此很陌生，而且我真的不知道自己在做什么...

我已经生成了一个使用 php 从 mysql 数据库中获取数据的表，但是我想在（每一行的）末尾添加一个额外的列，其中包含一个链接。该链接将指向有关该条目的更多详细信息。

我拥有的显示表格的代码如下：

```
$result = mysql_query("SELECT * FROM orders");

echo "<table border='5'>
<tr>
<th>order_no</th>
<th>ord_date</th>
<th>est_completion_date</th>
<th>status</th>
<th>invoice_date</th>
<th>inv_amount</th>
<th>name</th>
<th>fName</th>
<th>lName</th>
</tr>";

// -- Use 'while' to check each row in $result in turn:
while($row = mysql_fetch_array($result))
  {
  echo "<tr>";
  echo "<td>" . $row['order_no'] . "</td>";
  echo "<td>" . $row['ord_date'] . "</td>";
  echo "<td>" . $row['est_completion_date'] . "</td>";
  echo "<td>" . $row['status'] . "</td>";
  echo "<td>" . $row['invoice_date'] . "</td>";
  echo "<td>" . $row['inv_amount'] . "</td>";
  echo "<td>" . $row['name'] . "</td>";
  echo "<td>" . $row['fName'] . "</td>";
  echo "<td>" . $row['lName'] . "</td>";
  echo "</tr>";
  }
echo "</table>"; 
```

就像我说的，我是初学者。基本上我很高兴（使用上面的代码）制作显示 mysql 查询结果的 html 表。但是，我需要用户能够单击行/单元格以链接到其他表。

非常感谢任何帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:52:43.163

```
echo "<table border='5'>
<tr>
<th>order_no</th>
<th>ord_date</th>
<th>est_completion_date</th>
<th>status</th>
<th>invoice_date</th>
<th>inv_amount</th>
<th>name</th>
<th>fName</th>
<th>lName</th>
<!-- extra column here -->
<th>&nbsp;</th>
</tr>";

while($row = mysql_fetch_array($result)) {
    echo "<tr>";
    echo "<td>" . $row['order_no'] . "</td>";
    echo "<td>" . $row['ord_date'] . "</td>";
    echo "<td>" . $row['est_completion_date'] . "</td>";
    echo "<td>" . $row['status'] . "</td>";
    echo "<td>" . $row['invoice_date'] . "</td>";
    echo "<td>" . $row['inv_amount'] . "</td>";
    echo "<td>" . $row['name'] . "</td>";
    echo "<td>" . $row['fName'] . "</td>";
    echo "<td>" . $row['lName'] . "</td>";
    // add link here
    echo "<td><a href=''>link</a></td>";
    echo "</tr>";
} 
```

**请注意：**您应该停止使用`mysql_*`函数。它们正在被弃用。而是使用[PDO](http://php.net/manual/en/book.pdo.php)（从 PHP 5.1 开始支持）或[mysqli](http://php.net/manual/en/book.mysqli.php)（从 PHP 4.1 开始支持）。如果您不确定要使用哪一个，[请阅读这篇文章](http://net.tutsplus.com/tutorials/php/pdo-vs-mysqli-which-should-you-use/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:14:38.433

尝试这个。添加一列。它将链接到另一个页面“view_more_details.php”。要唯一标识行，请使用此链接传递唯一 ID。在这里，我通过了 order_no。在“view_more_details.php”页面中，您可以使用 $_GET['key'] 选择此值

```
$result = mysql_query("SELECT * FROM orders");

echo "<table border='5'>
<tr>
<th>order_no</th>
<th>ord_date</th>
<th>est_completion_date</th>
<th>status</th>
<th>invoice_date</th>
<th>inv_amount</th>
<th>name</th>
<th>fName</th>
<th>lName</th>
<th>&nbsp;</th>
</tr>";

// -- Use 'while' to check each row in $result in turn:
while($row = mysql_fetch_array($result))
  {
  echo "<tr>";
  echo "<td>" . $row['order_no'] . "</td>";
  echo "<td>" . $row['ord_date'] . "</td>";
  echo "<td>" . $row['est_completion_date'] . "</td>";
  echo "<td>" . $row['status'] . "</td>";
  echo "<td>" . $row['invoice_date'] . "</td>";
  echo "<td>" . $row['inv_amount'] . "</td>";
  echo "<td>" . $row['name'] . "</td>";
  echo "<td>" . $row['fName'] . "</td>";
  echo "<td>" . $row['lName'] . "</td>";
  echo "<td>" . "<a href="view_more_details.php?key=$row['order_no']">View More</a>" . "</td>";
  echo "</tr>";
  }
echo "</table>"; 
```

# sql - 从多对多表查询中选择

> ID：12096511
> 
> 赞同：3
> 
> 时间：2012-08-23T16:47:44.813
> 
> 标签：sql, database, database-design

我有一些桌子：

**会话**
*SessionID* int PK
*Created* datetime
*SiteId* int FK

**Tracking_Parameters**
*ParamID* int PK
*ParamName* nvarchar

**Session_Custom_Tracking**
*SessionID* int FK
*ParamID* int FK
*ParamValue* nvarchar

**Site_Custom_Parameters**
*SiteID* int FK
*ParamID* int FK
*ParamKey* nvarchar

**会话**：包含访问者的唯一会话 ID 以及他们进入站点的时间。

**Tracking_Parameters**：包含您可能希望在网站上跟踪的内容列表（即电子邮件打开、电子邮件点击、文章查看等）

**Site_Custom_Parameters**：对于特定站点（表未显示），声明 Tracking_Parameter 的键值（即在查询字符串或路由中查找的键）

**Session_Custom_Tracking**：会话和跟踪参数之间的链接，还包含我的应用程序找到参数键时的值。

问题：

我想为这些特定会话选择会话 ID，在 Session_Custom_Tracking 中有两个不同 ParamID 的记录。我想查找用户同时打开电子邮件（参数 1）并单击（参数 3）该电子邮件中的链接的会话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:50:51.417

您可以加入同一张表两次：

```
SELECT S.SessionID
FROM Sessions AS S
JOIN Session_Custom_Tracking AS SCT1
ON SCT1.SessionID = S.SessionID
AND SCT1.ParamID = 1
JOIN Session_Custom_Tracking AS SCT2
ON SCT2.SessionID = S.SessionID
AND SCT2.ParamID = 3 
```

一个可能更容易阅读的替代方法（因为它更接近您描述问题的方式）是使用`WHERE EXISTS`：

```
SELECT S.SessionID
FROM Sessions AS S
WHERE EXISTS
(
    SELECT *
    FROM Session_Custom_Tracking AS SCT1
    WHERE SCT1.SessionID = S.SessionID
    AND SCT1.ParamID = 1
)
AND EXISTS
(
    SELECT *
    FROM Session_Custom_Tracking AS SCT2
    WHERE SCT2.SessionID = S.SessionID
    AND SCT2.ParamID = 3
) 
```

# visual-studio - VS 2012 .NET 4.5 中的实体框架构建问题

> ID：12096512
> 
> 赞同：2
> 
> 时间：2012-08-23T16:47:51.933
> 
> 标签：visual-studio, entity-framework, msbuild, .net-4.5, entity-framework-5

关于 Entity Framework 4 和 Visual Studio 2012 是否有任何技巧/解决方法/已知的“陷阱”？

我有一个项目可以在我的 Windows 7、VS 2010、.NET 4 机器上完美运行和编译。周末我安装了一台新机器，带有 Windows 8 Enterprise RTM 和 VS 2012 Ultimate RTM。EF 设计是开箱即用的，使用 ObjectContext 方法（EF 4.1 之前）。

我从源代码管理中检索了工作解决方案，完成了转换过程，并使其在针对 .NET 4 Framework 的 VS2012 中成功构建。

但是，当我运行应用程序或调试它时，我从第一个 EF 调用中得到**“无法加载元数据资源” 。**苏..

**第 1 步：处理 EF 错误**

好的，所以我使用dotPeek查看程序集，果然在VS2012中构建时，***EDMX元数据文件不在程序集中。***

**第二步：解决资源缺失问题**

*   我将元数据处理设置为“复制到输出”，然后返回“嵌入”以强制执行。没有。
*   我查看了 4.5 的 MSBUILD 文件，以查看 EntityDeploy 目标是否看起来已损坏。没有。
*   我对 VS 2012 进行了全面修复，看看是否有问题。没有。
*   将 MSBUILD VS 版本设置为“11.0”以避免 csproj 中的 2010 兼容性检查。没有。

**第 3 步：删除模型，使用 VS 2012 默认值重试**

好的，我想我只是无法完成这项工作。所以我删除了模型，并在 VS 2012 中读取为新模型，它使用 NuGet 的 EF 5.0，并使用 DbContext 方法重新构建。整理好所有这些，修复了一些 b/t EF 4.0 和 5.0 的语法问题，我们正在构建。

仍然得到同样的错误，*.DLL 中仍然没有资源*

我的一位同事可以在 VS 2012 中成功构建，但在没有安装 .NET 4.5 的 Windows 7 上。

.NET 4.5 或 MSBUILD 4.5 中是否存在错误或已知问题？必须缺少一些简单的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T19:23:43.480

弄清楚了。我在这个项目中没有 .resources 文件，而且 .NET 4.5 中的 CoreCompile 似乎没有嵌入任何不存在的 EF 资源文件。

试图研究这是预期的还是新的行为。

# node.js - Mongoose - 转到下一个元素

> ID：12096516
> 
> 赞同：5
> 
> 时间：2012-08-23T16:48:24.287
> 
> 标签：node.js, mongodb, mongoose

我正在尝试在 nodejs 中的集合上迭代不同的 ID。可以像以下代码一样工作的东西：

```
//Callbacks removed for readability

var thisPost = mongoose.model('Post').findOne({tags: 'Adventure'});
console.log(thisPost.title); // 'Post #1 - Adventure Part 1'

var nextPost = thisPost.next({tags: 'Adventure');
console.log(nextPost.title); // 'Post 354 - Adventure Part 2' 
```

到目前为止，最好的想法是在我的模式中添加一个链表，这样我就可以在下一个对特定 ID 的引用上调用 find()，但我希望有一些不那么“棘手”的东西，可以让我使用这个 Mongoose 引用 (thisPost)作为我的 find() 可以开始的光标。

谢谢

编辑：迭代旨在处理多个页面查询。更好的例子：

```
//Callbacks removed for readability

//User 'JohnDoe' visits the website for the first time
var thisQuote = mongoose.model('Quote').findOne().skip(Math.rand());
res.send(thisQuote); // On page output, JohnDoe will see the quote 42
//Saving the current quote cursor to user's metadatas
mongoose.model('User').update({user: 'JohnDoe'}, {$set: {lastQuote: thisQuote }});

//User 'JohnDoe' comes back to the website
var user = mongoose.model('User').findOne({user: 'JohnDoe});
var thisQuote = user.lastQuote.next();
res.send(thisQuote); // On page output, JohnDoe will see the quote 43
//Saving the current quote cursor to user's metadatas
mongoose.model('User').update({user: 'JohnDoe'}, {$set: {lastQuote: thisQuote }});

//And so on... 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-23T18:13:25.623

您可能会查看 Mongoose 的流媒体功能：

```
var stream = mongoose.model('Post').find({tags: 'Adventure'}).stream();

// Each `data` event has a Post document attached
stream.on('data', function (post) {
  console.log(post.title);
}); 
```

[返回的QueryStream](http://mongoosejs.com/docs/api.html#querystream_QueryStream)`stream()`继承自[Node.js 的 Stream](http://nodejs.org/api/stream.html)，因此您可以根据需要使用[`pause`](http://nodejs.org/api/stream.html#stream_stream_pause)和做一些有趣的事情。[`resume`](http://nodejs.org/api/stream.html#stream_stream_resume)

**[编辑]**

现在我对您的问题有了更多了解，我想说 QueryStream 可能*不是*您想要使用的。我今天做了一些工作，并在[https://gist.github.com/3453567](https://gist.github.com/3453567)获得了一个可行的解决方案；只需克隆 Gist ( `git://gist.github.com/3453567.git`)，然后运行`npm install`，然后`node index.js`您应该能够访问位于`http://localhost:3000`. 刷新页面应该会给你“下一个”报价，当你到达最后它应该环绕。

这之所以有效，是因为有几件事：

首先，我们在用户的数据中保存对用户“上次查看”报价的引用[：](http://mongoosejs.com/docs/populate.html)

```
var UserSchema = new mongoose.Schema({
  user: String,
  lastQuote: { type: mongoose.Schema.Types.ObjectId, ref: 'Quote' }
}); 
```

现在，当我们这样做时`User.findOne().populate('lastQuote')`，返回的 User 上的`lastQuote`属性将是一个实际的 Quote 对象，由存储在 MongoDB 中的字段的值（它是一个 ObjectId）引用。

`next()`由于以下代码，我们可以调用此 Quote 对象：

```
QuoteSchema.methods.next = function(cb) {
  var model = this.model("Quote");
  model.findOne().where('_id').gt(this._id).exec(function(err, quote) {
    if (err) throw err;

    if (quote) {
      cb(null, quote);
    } else {
      // If quote is null, we've wrapped around.
      model.findOne(cb);
    }
  });
}; 
```

这是找到下一个引号或环绕到第一个引号的部分。

查看代码，如果您有任何问题，请告诉我。

# python - 具有多个变量的 render_template

> ID：12096522
> 
> 赞同：46
> 
> 时间：2012-08-23T16:49:10.927
> 
> 标签：python, mongodb, flask

我正在使用 Flask（作为框架）和 MongoDB（作为数据库服务器）。现在，我能做的只是传递我从数据库中得到的一个参数：

```
@app.route('/im/', methods=['GET', 'POST'])
def im_research(user=None):
    error = None
    if request.method == 'POST':
        if request.form['user']:
            user = mongo.db.Users.find_one_or_404({'ticker':request.form['user']})
            return redirect(url_for('im_user',user= user) )
        else:
            flash('Enter a different user')
            return redirect(url_for('im'))
    if request.method == 'GET':
       return render_template('im.html', user= None) 
```

我如何从数据库中传递多个变量：例如：在我的 Mongo 数据库中：我的数据库中有这些东西，我想将它们全部传递给我的模板。

```
{
users:'xxx'
content:'xxx'
timestamp:'xxx'
} 
```

是否可以通过使用 Flask 来做到这一点？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-08-23T17:07:24.620

您可以将多个参数传递给视图。

您可以传递所有局部变量

```
@app.route('/')
def index():
  content = """
     teste
   """
  user = "Hero"
  return render_template('index.html', **locals()) 
```

或者只是传递您的数据

```
def index() :
    return render_template('index.html', obj = "object", data = "a223jsd" ); 
```

[api文档](http://flask.pocoo.org/docs/api/)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-08-23T16:55:01.480

```
return render_template('im.html', user= None, content = xxx, timestamp = xxx) 
```

您可以根据需要传递任意数量的变量。[api](http://flask.pocoo.org/docs/api/) _

摘抄：

> flask.render_template(template_name_or_list, **context) 从给定上下文的模板文件夹中渲染一个模板。
> 
> 参数： template_name_or_list – 要渲染的模板的名称，或者带有模板名称的迭代，第一个存在的模板将被渲染 context – 应该在模板上下文中可用的变量。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-06-30T20:56:44.053

也可以将一个列表传递给 render_template 的上下文变量，并在 HTML 中使用 Jinja 的语法来引用它的元素。

例子.py

```
mylist = [user, content, timestamp]
return render_template('exemple.html', mylist=l) 
```

例子.html

```
...
<body>
    {% for e in mylist %}
        {{e}}
    {% endfor %}
</body>
... 
```

# npapi - 如何实现异步 NPAPI 插件

> ID：12096525
> 
> 赞同：1
> 
> 时间：2012-08-23T16:49:39.577
> 
> 标签：npapi

我必须`HTML5 AsyncFileAPI`使用 plain来实现`NPAPI`。微软*游戏手柄*按键事件的*回调*机制。

 *我面临的问题是如何`threadcallasync`从普通的 NPAPI 插件实现并无缝地将数据发送到 javascript。一些有用的链接或工作代码将不胜感激。我是 NPAPI 插件的新手。*threadcallasync*我必须在 Linux 中实现，已经看到了一些在 windows 中实现的链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T05:09:18.833

我肯定会推荐使用[FireBreath](http://firebreath.org)来创建你的插件；它会为您解决大部分难题，您可以找到有关[如何进行异步调用的](http://colonelpanic.net/2010/12/firebreath-tips-asynchronous-javascript-calls/)教程。

如果你选择不这样做，基本上你只需要传入一个 javascript 函数，在 NPAPI 中它将是一个 NPObject，然后当你的操作完成时，在回调 NPObject 上使用 NPN_InvokeDefault。当然，您需要在主线程上执行此操作，这将需要某种方法向主线程发送消息以告诉它进行调用。

一般来说 NPN_PluginThreadAsyncCall 就是这样做的；你给它一个函数指针和一个 void* 以及你需要的数据，它会在主线程上调用你的函数。不幸的是，windows 和 mac 上的 Safari 5.1 似乎已经放弃了对这个功能的支持。Windows 上的替代方法是使用 LPARAM 中的不透明指针创建消息 HWND 和 PostMessage。在 Mac 上，您可以只使用 PerformSelectorOnMainThread 或 NSTimer。我不确定如何在linux上做到这一点。

当然，FireBreath 会为您处理所有这些，只需将回调包装在可以从任何线程调用的 JSObjectPtr 中……您调用它，firebreath 将为您在正确的线程上进行调用。它也可以在 IE 上运行......但这取决于你。我尝试给出其他选择，因为我写了 FireBreath 的大部分内容并且我有点偏见。

（仅仅因为我有偏见并不意味着我错了）

祝你好运！*

# node.js - Heroku 上带有 Node.js 的代理服务器

> ID：12096528
> 
> 赞同：8
> 
> 时间：2012-08-23T16:49:49.123
> 
> 标签：node.js, heroku, proxy

我正在尝试使用 http-proxy 在 Heroku 上使用 Node.js 构建代理服务器。在本地一切正常，但我在 Heroku 上遇到了一些麻烦。

```
var http = require('http');
var httpProxy = require('http-proxy');

settings = {
  "localhost": process.env.LOCALHOST,
  "devices":   process.env.DEVICES_URI
}

var options = { router: { } }
options.router[settings.localhost + '/devices']  = settings.devices + '/devices';

var port   = process.env.PORT || 8000;
var server = httpProxy.createServer(options).listen(port); 
```

正如您在示例中看到的那样，我设置了一个路由对象。我说的是：当请求匹配“/devices”时，将请求路由到设备服务。（由 DEVICES_URI 环境变量标识）

在开发中我设置

*   本地主机 = '本地主机'
*   DEVICES_URI = 'http://localhost:3000'

这意味着所有去往 localhost:8000/devices 的请求都被代理到 localhost:3000/devices 这正是我想要的。一切都完美无缺。

问题出在生产中。它给了我一个超时错误，每个请求重复多次。

```
2012-08-23T20:18:20+00:00 heroku[router]: Error H12 (Request timeout) -> GET lelylan-api.herokuapp.com/devices dyno=web.1 queue= wait= service=30000ms status=503 bytes=0 
```

在生产环境变量配置为应用程序名称。

*   本地主机 = 'lelylan-api.herokuapp.com'
*   DEVICES_URI = 'lelylan-devices.herokuapp.com/'

我想我错了一些配置，但一整天后我仍然无法弄清楚。

**更新**

我继续进行测试，发现代理无法访问代理服务，这完全阻止了我。

在开发中我设置：

*   本地主机 = '本地主机'
*   DEVICES_URI = 'lelylan-devices.herokuapp.com/'

如果我打电话给[http://lelylan-devices.herokuapp.com/devices](http://lelylan-devices.herokuapp.com/devices)一切正常。

如果我调用 localhost:8000/devices （指向[http://lelylan-devices.herokuapp.com/devices](http://lelylan-devices.herokuapp.com/devices)） Heroku 告诉我没有这样的应用程序。我想问题出在路由系统中。

在这里您可以访问[源代码](https://github.com/lelylan/api/)。这里是 Heroku 的配置变量。

```
NODE_ENV      => production
LOCALHOST     => lelylan-api.herokuapp.com
DEVICES_URI   => lelylan-devices.herokuapp.com
TYPES_URI     => lelylan-types.herokuapp.com
LOCATIONS_URI => lelylan-locations.herokuapp.com 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T11:01:04.093

[我终于使用稍微修改的版本proxy-by-url](https://github.com/dominictarr/proxy-by-url)使它工作。最终的代码看起来像这样并且工作正常。

```
var httpProxy = require('http-proxy');

var port = process.env.PORT || 8000;

var routing = {
  '/devices': { port: process.env.DEVICES_PORT || 80, host: process.env.DEVICES_URI }
}

var server = httpProxy.createServer(
  require('./lib/uri-middleware')(routing)
).listen(port); 
```

要记住的一个注意事项。该插件将标头 HOST 设置为目标应用程序 uri。如果你不这样做，Heroku 将无法识别应用程序并且找不到它，因为它的内部路由系统似乎基于 HOST 标头。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T18:40:30.667

我在 Heroku 上成功使用了 http-proxy。我在您的日志错误中注意到的第一件事是它正在获取的 url：GET lelylan-api.herokuapp.com/tdevices

有一个错字...而不是 '/devices' 它显示的是 '/tdevices'。在继续之前，您可以确认这是实际的日志消息吗？

# java - Ruby vs Java 和瓶颈

> ID：12096529
> 
> 赞同：0
> 
> 时间：2012-08-23T16:49:52.397
> 
> 标签：java, ruby, database, web-applications

我想创建一个新的网络计费应用程序，我猜该应用程序最密集的任务是将发票（如果用户愿意）转换为 PDF，这可能由外部服务器完成，其余的只是插入和从 PostgreSQL 数据库中选择纯文本数据，这个应用程序需要扩展到 10,000 个用户。

我的问题是，我会首先遇到语言性能实现问题（Java-JVM vs Ruby-default-implementation），还是在这种情况下，性能真的会首先受到其他问题（如 I/O、数据库等）的影响吗？因此在这种情况下，ruby 与 java 的性能无关紧要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:54:29.737

我怀疑你会受到数据库和 IO 性能的限制。Java 和 Ruby 被广泛使用，我从未见过语言*本身*是个问题。PDF 转换可能是 CPU 密集型的，但是：

1.  我不敢相信你会一直这样做
2.  这是一种可以轻松卸载到另一台服务器并并行执行的事情

与以往一样，*过早的优化是万恶之源*。我会拼凑一个原型，并尝试在解决方案中引起您关注的部分（例如 PDF）预先确定任何特定问题

# c++ - 哪个 Qt 库包含 QApplication

> ID：12096531
> 
> 赞同：1
> 
> 时间：2012-08-23T16:50:02.710
> 
> 标签：c++, qt, java-native-interface, swig

我正在使用 swig 用 java 包装一个 QT 应用程序（使用 JNI），所有程序都顺利进行，直到它引发了一个异常**未定义的 QApplication 异常。**
我的问题是，如果我加载 QApplication 的 *.so(Shared Object)，JVM 无法找到 QApplication 的库，我以某种方式设法消除了这个错误。
**请告诉我在哪里可以找到 QApplication 的 *.so（共享对象）**
提前谢谢。

```
 //mohan.cpp
 #include <QApplication>
 #include <QPushButton>
 int initQ()
 {
     char *argv[2];
     argv[0]="name";
     argv[1]="texteditapplication";
     int argc=2;
     QApplication app(argc, argv);

     QPushButton hello("Hello world!");
     hello.resize(100, 30);

     hello.show();
     return app.exec();
 }

//mohan.i
%module mohan

%{
/* Put headers and other declarations here */
 #include <QApplication>
 #include <QPushButton>
int initQ();
%}
extern int initQ();

//runme.java
public class runme {
  static {
System.out.println(System.getProperty("java.library.path"));
 System.loadLibrary("mohan");
  }

  public static void main(String argv[]) {
    System.out.println(mohan.initQ());  
    System.out.println();
  }
} 
```

//执行

```
[mohan@mohan mohan]$ g++ -fpic -c mohan.cpp mohan_wrap.cxx -pipe -O2 -Wall -W -D_REENTRANT -DQT_NO_DEBUG -DQT_GUI_LIB -DQT_CORE_LIB -I/media/mohan/QtSDK/Desktop/Qt/474/gcc/mkspecs/default -I. -I/media/mohan/QtSDK/Desktop/Qt/474/gcc/include/QtCore -I/media/mohan/QtSDK/Desktop/Qt/474/gcc/include/QtGui -I/media/mohan/QtSDK/Desktop/Qt/474/gcc/include -I. -I. -I/usr/java/jdk1.6.0_33/include/ -I/usr/java/jdk1.6.0_33/include/linux/

[mohan@mohan mohan]$  g++ -shared mohan.o mohan_wrap.o -o libmohan.so
[mohan@mohan mohan]$ javac runme.java
[mohan@mohan mohan]$ java -Djava.library.path=. runme
.
java: symbol lookup error: /home/mohan/Desktop/mohan/libmohan.so: undefined symbol: _ZN12QApplicationC1ERiPPci

_ZN12QApplicationC1ERiPPci -> **QApplication** 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T17:07:49.033

gui 应用程序几乎总是需要 QtMain 和 QtCore 以及 QtGui

# api - API服务器或客户端上的哈希密码？

> ID：12096534
> 
> 赞同：1
> 
> 时间：2012-08-23T16:50:08.483
> 
> 标签：api, rest, hash, passwords

对于为用户帐户创建发送密码，哪个 API 设计更好？

**在客户端散列原始密码，然后发送到服务器：**

```
// client code
$p = hash($p);
$api->save($p); 
```

或者

**将原始密码发送到服务器，然后在服务器上散列：**

```
// api server code
$p = hash($_POST['p']);
$db->save($p); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:03:59.047

从我的角度来看，最好在服务器上散列密码，因为您可以控制如何加密密码（算法等）并保持一致性。

我认为您不想在您可能拥有的所有客户端中实现密码加密逻辑，或者让您的用户实现自己的逻辑。哦，使用 SSL。

# image - 如何检测图像中的相似颜色区域？

> ID：12096536
> 
> 赞同：1
> 
> 时间：2012-08-23T16:50:13.073
> 
> 标签：image, image-processing

我创建了一个简单的程序来生成随机图像，为每个像素提供随机颜色。我知道生成可协调图像的机会非常低，但我想尝试一下。

我观察到工作中最长的部分是检查图像是否真的是东西。我还观察到，生成的大多数图像只是具有大量单个像素的彩色图像域。这就是为什么我想要求一种伪代码算法来检测图像中相似的颜色区域。我认为找到有意义的图像的最简单方法是过滤所有这些随机像素图像。这并不完美，但我认为它会有所帮助。如果有人可以提出另一种有助于完成这项任务的过滤算法，我也会很感激。

（已编辑）

为了澄清这一点，如果我的解释不够清楚，我将向您展示一些图像：

![](../Images/f59fc626862d1794910e924412dfa1f0.png)

这就是我得到的图像，基本上我会将其描述为“彩色噪声”。正如你所看到的，所有像素都是单独分布的，没有在相似的颜色区域中分组，以跳跃地创建对象的形状或任何可协调的东西。

![](../Images/3cc8d2bfa3821e97b7c5cf28b0ac2bda.png)

在这里你可以看到一个传统的图像，一个“reconocible”图片。我们可以清楚地看到一只狗躺在草地上，手里拿着一个网球。如果你仔细观察这张图片，它可以很明显地与另一张区别开来，因为它有相似的颜色，我们可以区分（如狗，白色区域，草，深绿色区域，网球球，光绿色区域）。

我真正想要的是在将它们保存在高清之前删除“像素”图像，并且只保存具有颜色 agrupations 的图像。正如我之前所说，这个想法是我必须过滤这些随机生成的图像的最佳方法，但如果有人提出另一种更有效的方法，我会非常感激它。

（已编辑）

好的，我认为这篇文章变得太长了......好吧，如果有人想看看这里是我编写的程序的代码。这真的很简单。我已经使用 Pygame 在 Python 中对其进行了编程。我知道这几乎不是最有效的方法，我知道这一点。问题是我在这个领域是个菜鸟，我真的不知道用其他语言或模块来做这件事的另一种方法。也许您也可以帮助我...我不知道，也许将代码翻译成C++？我觉得我在同一篇文章中提出了很多问题，但是正如我多次说过的那样，任何帮助都会非常感激。

```
import pygame, random
pygame.init()

#lots of printed text statements here

imageX = int(input("Enter the widht of the image you want to produce: "))
imageY = int(input("Enter the height of the image you want to produce: "))
maxImages = int(input("Enter the maximun image amoungt you want to produce: "))
maxMem = int(input("Enter the maximun data you want to produce (MB, only works with     800x600 images): "))
maxPPS = int(input("Enter the maximun image amoungt you want to produce each second: "))
firstSeed = int(input("Enter the first seed you want to use: "))

print("\n\n\n\n")

seed = firstSeed
clock = pygame.time.Clock()
images = 0
keepGoing = True

while keepGoing:

    #seed
    random.seed(seed)

    #PPS
    clock.tick(maxPPS)

    #surface
    image = pygame.Surface((imageX,imageY))

    #generation
    for x in range(imageX):
        for y in range(imageY):
            red = random.randint(0,255)
            green = random.randint(0,255)
            blue = random.randint(0,255)

            image.set_at((x,y),(red,green,blue))

    #save
    pygame.image.save(image,str(seed)+".png")

    #update parameters
    seed += 1
    images += 1

    #print seed
    print(seed - 1)

    #check end
    if images >= maxImages:
        keepGoing = False
    elif (images * 1.37) >= maxMem:
        keepGoing = False

    pygame.event.pump()

print("\n\nThis is the last seed that was used: " + str(seed - 1))
input("\nPress Enter to exit") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:37:26.803

这是一个供您尝试的屠宰算法（在 OpenCV 中尝试）：

1.  获取图像
2.  仅使用图像的一种颜色维度，即红色或绿色......或灰色......或分别对每个颜色执行以下操作
3.  将图像中的所有值相加，并将其保存为图像的“能量”值
4.  使用 OpenCV 的 Smooth 函数对图像进行模糊处理
5.  正确模糊图像的技巧是选择内核（也称为过滤器）的大小，使其小于重要特征的宽度，并大于不重要或嘈杂的特征。大小通过定义 param1 和 param2 来控制。见[http://opencv.willowgarage.com/documentation/python/imgproc_image_filtering.html](http://opencv.willowgarage.com/documentation/python/imgproc_image_filtering.html)
6.  现在对于输出，将所有值相加得到输出“能量”
7.  如果输出的能量至少是输入的一半，则保留图像。从技术上讲，数字 5 中的技巧与选择 50% 作为保留或丢弃图像的阈值相同。所以这里更改阈值与更改过滤器大小大致相同。
8.  可选的。不过无需考虑太多，只需为某些图像集获取这些能量值并通过肉眼选择阈值即可。

怎么了？您过滤掉高频，然后查看是否还有剩余的东西。大多数图像在较低空间频率下具有大量能量。事实上 jpeg 压缩使用这个事实来压缩图像。过滤器必须有一个能量才能正常工作，所以我假设这是真的。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T17:33:02.103

如果不确切知道您要达到的目标，就很难提供具体的帮助。但是，阅读您的帐户确实让我想起了我最近看到的一些东西，虽然在实现上完全不同，但有一个相似的最终目标：从随机性中生成可识别的图像。

查看Philip McCarthy 的[https://github.com/phl/pareidoloop](https://github.com/phl/pareidoloop)。

Philip 的项目从随机多边形开始，算法偏爱人脸图像。这里有两个关键点：多边形立即显着减少了随机噪声的数量，因此生成可识别事物的机会显着增加。其次，该算法有利于特定类型的可识别图像：我怀疑您将不得不针对特定类型的图像工作，以便您拥有一些参数来计算估计“可识别性”。

嗯！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T09:24:28.217

滤除噪声的最简单方法是寻找相关性。在大部分图像中，附近区域应该高度相关。有很多方法可以做到这一点。

您应该使用以下组合并进行一些调整以找到参数以获得可接受的命中/未命中率

颜色相关性：您会发现“正确”图像中附近区域的 U/V 存在大量相关性。

边缘检测：自然图像往往具有明确定义的边缘。从自然图像中检测噪声的最简单方法就是这样做。

可以做的还有很多： 频率分析：噪声图像将具有所有频率 自然图像通常具有巨大的峰值。缩放空间分析等取决于您想要获得的复杂程度..您愿意容忍多少命中率。通常，尝试获取可识别的图像是一个开放式主题，但如果您特别想要去除示例中给出的噪声图像，则应该能够获得非常高的命中率。

编辑：一般来说，这样的问题没有确切的算法。您必须对基础数据的属性做出假设。然后使用基本原语（相关性、频域数据、边缘等）并将其结合起来，为您提供解决问题的算法。这是因为此类问题的解决方案是非常特定于数据的。与解决计算机科学算法完全不同。这并不是说信号处理算法没有精确性。但是，您当前的问题和许多其他问题都涉及所谓的随机变量和随机过程。您可能必须搜索是否有人试图在文学或某所大学中解决这个问题。你可以用它作为你的起点。调整该算法以适合您。

# python - 在验证列表索引时，最好事先检查有效性还是捕获并处理 IndexError？

> ID：12096538
> 
> 赞同：2
> 
> 时间：2012-08-23T16:50:21.540
> 
> 标签：python, exception

检查用户提供的矢量索引的pythonic方法是什么？

```
def get_value(vector, index):
    try:
        return vector[index]
    except IndexError:
        raise ValueError('bad index') 
```

或者

```
def get_value(vector, index):
   if -1 < index < len(vector):
       return vector[index]
   else:
       raise ValueError('bad index') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:56:12.123

首先尝试更 Pythonic。从[词汇表](http://docs.python.org/glossary.html)：

> EAFP
> 
> 请求宽恕比请求许可更容易。这种常见的 Python 编码风格假设存在有效的键或属性，如果假设被证明是错误的，则捕获异常。这种干净快速的风格的特点是存在许多 try 和 except 语句。该技术与许多其他语言（如 C）常见的 LBYL 风格形成鲜明对比。

虽然我什至不会把它放在`try`...`except`因为你只是抛出一个 IndexError，它已经这样做了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T16:54:20.090

我认为只让`IndexError`传播给用户是合理的。用户正在将您传递给`index`某物。`IndexError`如果从您的界面合理地抛出超出范围。所以我会这样做：

```
def get_value(vector, index):
    """ gets value... throws IndexError() if index out of range"""
    return vector[index] 
```

这也允许您在界面中使用有效的负索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T16:56:59.827

一种方法是让它`IndexError`被抛出——这是一个无效的请求。另一种方法是`vector.get(index)`在失败时为您提供 None 类型（与 相同`try: return vector[index] except: return None`）。这实际上取决于您在失败时打算做什么。如果您想请求用户再试一次，那么 .get() 或 try except 可能是最好的。否则将异常提升到顶层表示程序无法处理请求。

请注意，“Pythonic”方式通常是一种尝试，但我重申它更多地取决于您的用例。

# c# - 从网站批量打印存储在服务器上的文件

> ID：12096545
> 
> 赞同：4
> 
> 时间：2012-08-23T16:51:01.520
> 
> 标签：c#, asp.net

我有一个托管在 AWS 上的 asp.net 网站。

在这个网站上，我需要能够从存储在 AWS 框中的列表中选择多个 PDF 文件，然后打印它们。

目前，我的过程只允许一次打印一个 PDF，方法是将它们重定向到浏览器中的 PDF 文件路径，然后用户从那里手动打印，但如果他们要打印很多，这个过程将变得乏味。

有人对我如何实现这一目标有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:31:14.287

在我看来，一个非常快速简单的方法就是将文件复制到打印机路径。
这适用于 word 文档和 pdf。
然而，这假设了几件事：

1.) 文档存储在您可以从中复制它们的某个位置。

2.) 您在 Web 服务器上安装了打印机驱动程序。

3.) 必须在网络服务器上安装 Adob​​e Reader。（否则打印机有时无法识别 PDF。）

所以我要做的是通过 ManagementObjectSearcher 查询服务器上的打印机，找到默认打印机或任何您想要获取打印机路径的打印机，然后将文件复制到该路径。这就对了。代码真的很简单。

```
 public static class PrinterHelper
    {

    public class PrinterSettings
    {
        public string Name { get; set; }
        public string ServerName { get; set; }

        public string DeviceId { get; set; }
        public string ShareName { get; set; }
        public string Comment { get; set; }
        public bool Default { get; set; }
    }

    /// <summary>
    /// Sends the file to printer.
    /// </summary>
    /// <param name="filePathAndName">Name of the file path and Name of File.</param>
    /// <param name="printerName">Name of the printer with Path. E.I. \\SFDPRINT2.raven.ravenind.net\P14401</param>
    public static void SendFileToPrinter(string filePathAndName, string printerName)
    {
        FileInfo file = new FileInfo(filePathAndName);
        file.CopyTo(printerName);
    }

    /// <summary>
    /// Gets all printers that have drivers installed on the calling machine.
    /// </summary>
    /// <returns></returns>
    public static List<PrinterSettings> GetAllPrinters()
    {
        ObjectQuery query = new ObjectQuery("SELECT * FROM Win32_Printer");
        ManagementObjectSearcher mos = new ManagementObjectSearcher(query);
        List<PrinterSettings> printers = new List<PrinterSettings>();

        foreach (ManagementObject mo in mos.Get())
        {
            PrinterSettings printer = new PrinterSettings();
            foreach (PropertyData property in mo.Properties)
            {
                if (property.Name == "Name")
                    printer.Name = property.Value == null ? "" : property.Value.ToString();

                if (property.Name == "ServerName")
                    printer.ServerName = property.Value == null ? "" : property.Value.ToString();

                if (property.Name == "DeviceId")
                    printer.DeviceId = property.Value == null ? "" : property.Value.ToString();

                if (property.Name == "ShareName")
                    printer.ShareName = property.Value == null ? "" : property.Value.ToString();

                if (property.Name == "Comment")
                    printer.Comment = property.Value == null ? "" : property.Value.ToString();

                if (property.Name == "Default")
                    printer.Default = (bool)property.Value;
            }
            printers.Add(printer);
        }

        return printers;
    }      
} 
```

这是如何使用助手。这就对了。

```
 var printer = PrinterHelper.GetAllPrinters().FirstOrDefault(p => p.Default);
            PrinterHelper.SendFileToPrinter(printer.Name, "C:\\Users\\Public\\Documents\\Form - Career Advancement Request.pdf"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T07:46:35.287

你犯了一个小错误，如何使用助手的参数颠倒了。首先传递文件名，然后传递打印机名称。

# visual-studio-2010 - CS1684 对 System.Windows.Input.ICommand 类型的引用声称它在“xxx”中定义，但找不到

> ID：12096547
> 
> 赞同：5
> 
> 时间：2012-08-23T16:51:11.940
> 
> 标签：visual-studio-2010, code-analysis, visual-studio-2012, .net-4.5, icommand

我正在尝试开始使用 VS 2012 而不是 VS 2010，但在安装 VS 2012 和 .Net 4.5 之后。我在 VS 2010 中收到代码分析错误，说读取模块“xxx_Accessor”时遇到以下错误：无法解析类型引用：[System，Version=4.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089] System.Windows。输入.ICommand。

我猜这与 .Net 4.5 已经移动了 ICommand 接口的位置有关，但是有没有解决方案可以再次运行代码分析？我尝试将 ignorestrongassemblynames 添加到测试项目和被测项目的项目文件中，但这没有奏效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T12:34:37.703

我遇到了同样的问题，但不是所有引用 ICommands 的程序集，只是一些。

我删除了对 PresentationCore 的引用，重建并重新添加了它。问题消失了。

# java - 如何在 Swing 中左右对齐组件？

> ID：12096548
> 
> 赞同：4
> 
> 时间：2012-08-23T16:51:22.633
> 
> 标签：java, swing, alignment

我有一个看起来很简单的问题。我有一些我想向左对齐的标签，但是当我调整大小时，它们开始向中间漂移。这会打乱我计划添加的其他组件的对齐方式。我该怎么做才能让它们保持在左侧？

![例子](../Images/02b47f5bc1d060c45491f9890fef9edc.png)

这是简短而简单的代码，不确定我的问题出在哪里：

```
package com.protocase.notes.views;

import com.protocase.notes.model.Note;
import com.protocase.notes.model.User;
import java.awt.Component;
import java.util.Date;
import javax.swing.BoxLayout;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.border.BevelBorder;

/**
 * @author dah01
 */
public class NotesPanel extends JPanel{

    public NotesPanel(Note note){
        this.setLayout(new BoxLayout(this,BoxLayout.Y_AXIS));
        JLabel creatorLabel = new JLabel("Note by "+note.getCreator()+ " @ "+note.getDateCreated());
        creatorLabel.setAlignmentX(JLabel.LEFT_ALIGNMENT);
        creatorLabel.setHorizontalAlignment(JLabel.LEFT);

        JTextArea notesContentsArea = new JTextArea(note.getContents());
        notesContentsArea.setEditable(false);
        JScrollPane scrollPane = new JScrollPane(notesContentsArea);

        JLabel editorLabel = new JLabel(" -- Last edited by "+note.getLastEdited() +" at "+note.getDateModified());
        editorLabel.setAlignmentX(Component.LEFT_ALIGNMENT);
        editorLabel.setHorizontalAlignment(JLabel.LEFT);

        this.add(creatorLabel);
        this.add(scrollPane);
        this.add(editorLabel);
        this.setBorder(new BevelBorder(BevelBorder.RAISED));
    }

    public static void main(String[] args) {
        JFrame frame = new JFrame("Notes Panel");
        Note note = new Note();
        User user = new User();
        user.setFirstName("d");
        user.setLastName("h");
        user.setUserID("dah01");
        note.setCreator(user);
        note.setLastEdited(user);
        note.setDateCreated(new Date());
        note.setDateModified(new Date());
        note.setContents("A TEST CONTENTS");
        NotesPanel np = new NotesPanel(note);

        JScrollPane scroll = new JScrollPane(np);
        frame.setContentPane(scroll);
        np.setVisible(true);
        frame.setVisible(true);
        frame.pack();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T17:58:25.133

如果要对齐面板中的内容，则必须对齐所有内容。你忘了对齐你的`JScrollPane`. 如果将此行添加到代码中，则应该为您修复对齐方式：

```
 scrollPane.setAlignmentX(JScrollPane.LEFT_ALIGNMENT); 
```

你的新构造函数会是什么样子：

```
public NotesPanel(Note note){
    this.setLayout(new BoxLayout(this,BoxLayout.Y_AXIS));
    JLabel creatorLabel = new JLabel("Note by "+note.getCreator()+ " @ "+note.getDateCreated());
    creatorLabel.setAlignmentX(JLabel.LEFT_ALIGNMENT);
    creatorLabel.setHorizontalAlignment(JLabel.LEFT);

    JTextArea notesContentsArea = new JTextArea(note.getContents());
    notesContentsArea.setEditable(false);
    JScrollPane scrollPane = new JScrollPane(notesContentsArea);
    scrollPane.setAlignmentX(JScrollPane.LEFT_ALIGNMENT);

    JLabel editorLabel = new JLabel(" -- Last edited by "+note.getLastEdited() +" at "+note.getDateModified());
    editorLabel.setAlignmentX(Component.LEFT_ALIGNMENT);
    editorLabel.setHorizontalAlignment(JLabel.LEFT);

    this.add(creatorLabel);
    this.add(scrollPane);
    this.add(editorLabel);
    this.setBorder(new BevelBorder(BevelBorder.RAISED));
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T16:58:48.280

根据您的**评论**，我建议您与其他人一起去`layout`，我会推荐[MigLayout](http://www.miglayout.com/)

在这里你去`MigLayout`：

```
import java.awt.EventQueue;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.border.EmptyBorder;
import net.miginfocom.swing.MigLayout;
import javax.swing.JLabel;
import javax.swing.JTextArea;

public class MigLayoutDemo {

    private JPanel contentPane;

    /**
     * Launch the application.
     */
    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    new MigLayoutDemo();
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

    /**
     * Create the frame.
     */
    public MigLayoutDemo() {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setBounds(100, 100, 450, 300);
        contentPane = new JPanel();
        contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
        frame.setContentPane(contentPane);
        contentPane.setLayout(new MigLayout("", "[grow]", "[][grow][]"));

        JLabel lblLabel = new JLabel("Label 1");
            lblLabel.setBorder(BorderFactory.createLineBorder(Color.red));
        contentPane.add(lblLabel, "cell 0 0,alignx left");

        JTextArea textArea = new JTextArea();
        contentPane.add(textArea, "cell 0 1,grow");

        JLabel lblLabel_1 = new JLabel("Label 2");
            lblLabel_1.setBorder(BorderFactory.createLineBorder(Color.red));
        contentPane.add(lblLabel_1, "cell 0 2,alignx left");
        frame.setVisible(true);
    }

} 
```

**输出 ：**

![在此处输入图像描述](../Images/6e98377b36c9fb82f2f41a77b45863f1.png)

如您所见`labels`，标有**红色边框**的没有拉伸到中间，它们是左对齐的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T17:57:32.010

使用`BorderLayout`绝对可以解决您的问题。

```
this.setLayout(new BorderLayout());

this.add(creatorLabel, BorderLayout.NORTH);
this.add(scrollPane);
this.add(editorLabel, BorderLayout.SOUTH); 
```

![JLabel 对齐](../Images/84c60fb819ba63a0f4558365de569e70.png)

或者，如果要在 UI 中显示的组件多于示例代码中显示的组件，您仍然可以使用`GridBagLayout`. 我知道没有多少人喜欢使用这个，因为它非常冗长，但在我看来，它是 Swing 中最强大的布局管理器。

# android - 根据Android中的用户移动位置标记左右

> ID：12096549
> 
> 赞同：0
> 
> 时间：2012-08-23T16:51:35.107
> 
> 标签：android, google-maps, google-maps-markers

我正在使用 Android 中的 Google 地图，我正在更新用户的位置并在地图上绘制路径。但是我没有什么问题，因为我想让标记位置根据用户位置而改变。

例如，如果用户左转，那么标记（即箭头（>））位置也应该左转。此功能在 Google 地图中可用。如果有人有任何想法，请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:09:07.240

您应该使用设备的硬件来确定用户面向的方向，然后相应地绘制箭头。

[这](http://android-coding.blogspot.com/2012/03/create-our-android-compass.html)是一个关于收集数据以在屏幕上显示指南针的精彩教程（基本上是您想要在用户位置执行的操作）。

# php - 并登录 POST var

> ID：12096553
> 
> 赞同：0
> 
> 时间：2012-08-23T16:52:07.237
> 
> 标签：php, ios, post

您好，我正在使用 PDO 和 apache 服务器从 iPhone 将帖子 var 发送到 php mysql，但是如果我`&`在 var 的内容中添加一个符号，它会将其解释为分隔符。我试过 \& 但它不起作用。有什么线索吗？谢谢

```
 @"myID=%@&asCreatorPresentation=%@&firstName=%@&lastName=%@&phoneNumber 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T16:53:30.433

你必须给`urlencode`你的 POST var 名称和值。

例如，`&`符号变为`%26`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T16:56:12.547

你必须`urlencode`你的字符串。

```
[NSString stringByAddingPercentEscapesUsingEncoding:NSASCIIStringEncoding]] 
```

# android - 如何将自己的设置添加到系统设置中？

> ID：12096555
> 
> 赞同：2
> 
> 时间：2012-08-23T16:52:13.530
> 
> 标签：android, system-setting

我见过一些应用程序设法将自己的复选框添加到系统设置中[，而无需](https://stackoverflow.com/a/2904967/636571) [root 访问权限](https://stackoverflow.com/a/5107414)。

例如，当安装了新的 TTS 引擎时，它会将自己的项目添加到`Voice input & output`>`Text-to-speech settings`屏幕：

![在此处输入图像描述](../Images/9a173c8a953e07388a0da1b4fff5a135.png)

他们是怎么做到的？

如果我想将自己的设置添加到该`Text-to-speech settings`屏幕，我应该寻找什么挂钩、API 和/或文档？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T17:14:34.417

> 他们是怎么做到的？

通过检查`TtsEngine`SDK 中的示例应用程序，看起来该过程是：

第 1 步：实施 TTS 服务。尝试使用此工具将任意其他内容挂接到设置的开发人员将被当场击毙。

步骤#2：在该服务的清单条目中，有一个`<meta-data>`元素 `android:name="android.speech.tts"`和一个`android:resource`指向 XML 资源的属性。

步骤 #3：创建上述 XML 资源，类似于以下内容：

```
<tts-engine xmlns:android="http://schemas.android.com/apk/res/android"
  android:settingsActivity="your.settings.activity.GoesHere" /> 
```

唉，这似乎没有记录。至少，当我搜索在线开发人员指南时，我没有找到任何对这些东西的引用。

# c# - 实体框架数据上下文问题 - 它是否在我的控制器中正确处理？

> ID：12096559
> 
> 赞同：3
> 
> 时间：2012-08-23T16:52:23.150
> 
> 标签：c#, asp.net-mvc, entity-framework

我已经收到了一些代码，并且在控制器类中有一个保存初始化数据库上下文的属性。

```
public class MyController: Controller
{
    protected AssetManagerContext db = new AssetManagerContext("ConnectionString");
    // Actions...etc.

    [HttpGet]
    public ActionResult Edit(int id)
    {
        MyAsset myAsset = db.Assets.Find(id); // Used and not disposed
        return View(myAsset);
    }
 } 
```

大多数操作都使用了这个 Context 而没有释放它，我担心的是这个上下文是打开的。

1.  我是否需要担心这个上下文没有被显式关闭（通过 .Dispose() 或 using {} 语句

2.  如果我担心，我应该如何处理这种情况，因为变量是类的一部分并且跨动作使用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T16:57:26.270

Controller 类有一个 dispose 方法。因此，在您的控制器中覆盖该方法并处理该上下文。

```
protected override void Dispose(bool disposing)
{
   base.Dispose(disposing);
   db.Dispose();
} 
```

上下文完成后将自动调用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T16:55:41.697

在对控制器的调用之间保持上下文打开绝不是一个好主意。

这会导致数据库连接一直保持到 MyController 实例被 GC 处理为止。

如果您的控制器完成与实体框架的所有交互（您的视图不需要延迟加载域对象），最简单的模式是

```
public class MyController : Controller
{
    public ActionResult MyAction(...)
    {
        using (AssetManagerContext db = new AssetManagerContext("ConnectionString"))
        {
            // Do stuff
        }
    }
} 
```

如果您的视图确实需要从上下文中延迟加载对象，您确实可以将上下文对象的引用作为类的属性并按照@Kundan 的建议实现 IDisposable。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T17:23:37.243

实际上，这并不重要。正如 Stephen Walter在评论中发布指向他的一个博客条目的链接时[指出](http://stephenwalther.com/archive/2008/08/20/asp-net-mvc-tip-34-dispose-of-your-datacontext-or-don-t.aspx)的那样，清理数据上下文并不是特别重要，因为最终，数据上下文在管理自己的连接和池化连接方面做得非常出色。

如果您不清理它，您分配的额外内存可能比它需要的时间更长，但它不会使连接保持打开的时间超过必要的时间。

然而，最好的做法是自己清理。即使您知道它（当前）并不重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T16:59:25.113

首先，您应该始终明确地释放昂贵的资源，例如数据库连接、流等。不要依赖框架为您执行此操作。即使它现在这样做，你也永远不知道微软将来是否会改变这一点，给你留下一个你可能找不到的巨大漏洞。

`using`您可以使用块在每个操作中创建和处置上下文。

但是为了节省一些代码并遵循[DRY](http://de.wikipedia.org/wiki/Don%E2%80%99t_repeat_yourself)[`OnActionExecuting`](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.onactionexecuting%28v=vs.108%29)原则，您可以通过分别覆盖and来实例化和处理每个操作之前和之后的上下文[`OnActionExecutedContext`](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.onactionexecuted%28v=vs.108%29)：

```
public class MyController: Controller
{
    protected AssetManagerContext db;

    [HttpGet]
    public ActionResult Edit(int id)
    {
        MyAsset myAsset = db.Assets.Find(id); // Used and not disposed
        return View(myAsset);
    }

    protected override void OnActionExecuting(ActionExecutingContext db) {
        base.OnActionExecuting(db);
        db = new AssetManagerContext("ConnectionString");
    }

    protected override void OnActionExecuted(ActionExecutedContext db) {
        base.OnActionExecuted(db);
        db.Dispose();
    }
} 
```

# facebook - 使用 wordpress 插件在粉丝页面上发布

> ID：12096562
> 
> 赞同：0
> 
> 时间：2012-08-23T16:52:29.857
> 
> 标签：facebook, wordpress

为 WordPress 设置 Facebook 插件，“启用”选项不显示。我该如何解决？

![截屏](../Images/b9bc6f9b1ed92b2c61830e14eee64b1d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T20:10:35.513

要启用此选项，您需要在您的 Facebook 帐户上有页面。当您的帐户上有页面时，您将在此列表中看到这些页面。

# ruby-on-rails - Rails，Mongoid和复杂查询

> ID：12096564
> 
> 赞同：0
> 
> 时间：2012-08-23T16:52:37.000
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongoid

用户 has_many items Item belongs_to Client

使用 mongoid（我不认为它是特定于 mongoid 的，但无论如何）我需要通过给定用户收集所有客户端。目前我使用：

```
@clients = current_user.items.map{|c| c.client} 
```

但可以肯定的是，它不好，也不可接受。最好的实施方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:13:08.873

为了不遇到 N+1 问题，我会做这样的事情。

```
# first you retrieve all client ids
ids = current_user.items.map(&:client_id)

# then you retrieve all clients at once
@clients = Client.in(id: ids) 
```

# html - 左侧子菜单仅在 Mac Safari 和 Mac Chrome 上损坏

> ID：12096565
> 
> 赞同：0
> 
> 时间：2012-08-23T16:52:40.037
> 
> 标签：html, css, submenu

[http://cypresshh2.cakuun.com/index.php?id=4](http://cypresshh2.cakuun.com/index.php?id=4)

我已经重建了几次，以适应客户的期望变化。（此时有些 CSS 是一团糟。）唯一的问题是左侧的子菜单在 Mac 版 Chrome 或 Mac 版 Safari 中不起作用。适用于所有 PC 浏览器版本，适用于 MAC 的 FF。

在损坏的浏览器上，您可以看到该框明显打开但落在较低的 LI 元素后面，而不是撞到 LI 元素。

如果用户在父页面或任何子页面上，则应该打开子菜单。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:33:24.447

正如您所说，CSS 有点乱，但是当我在 Firebug 中弄乱它时，这里有一些东西似乎对我有所帮助：

1.  将所有菜单和子菜单 'a'a 标签更改为 display:block 并给它们一些填充。

2.  从您的 LI 元素中删除高度

3.  从 LI 元素中删除 display:inline-block

4.  给你的 LI 元素 margin:0 0 10px

5.  从子菜单 LI 元素中删除 display:block

6.  将 LI 背景位置更改为 '0 0' 而不仅仅是定义 'center'

希望有帮助。

# makefile - 将所有库包含在一个目录中

> ID：12096568
> 
> 赞同：0
> 
> 时间：2012-08-23T16:52:45.363
> 
> 标签：makefile

如何在 Makefile 中包含目录中的所有库？

假设我想在目录中包含所有库，`/libdir`我该怎么做？

结果应该是这样的：

```
INCLUDES = -I/libdir/lib1 -I/libdir/lib2 -I/libdir/lib3 ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:23:02.583

```
LIBDIRS = $(wildcard /libdir/*)

INCLUDES = $(addprefix -I, $(LIBDIRS)) 
```

# tsql - dbo.sp_send_dbmail 和 HTML 当一封电子邮件 SPROC 调用现有 SPROC

> ID：12096572
> 
> 赞同：0
> 
> 时间：2012-08-23T16:53:05.660
> 
> 标签：tsql, sql-server-2008-r2, sp-send-dbmail

我想构建 HTML 并使用 sp_send_dbmail 发送它。此页面上的选项 C 说明了如何执行此操作。 [http://msdn.microsoft.com/en-us/library/ms190307.aspx](http://msdn.microsoft.com/en-us/library/ms190307.aspx)

但这是我的收获。我创建了一个名为 AbcStats 的存储过程。很多时候，我去 SSMS 并只是在没有电子邮件的情况下执行“exec ABCStats”，并且只想在屏幕上的数据网格中查看结果集。我已经设置了一些我自己的标准，将结果评定为“好”或“坏”，当任何东西都不好时，存储过程返回 1，当一切都好时返回 0。

然后我创建了一个运行 Sproc JobAbcAlert 的 SQL 代理作业，如下所示：

```
ALTER Procedure 
[dbo].[JobAbcAlert] 
(
   @SendEmailOnlyOnError bit = 1 
   )
as
begin

DECLARE @Status int 
DECLARE @BoolSendEmail bit = 0 
DECLARE @emailSubject varchar(100) = 'BizTalk Feed Status - Good' 

-- Call Stored Proc first time to find out if status is "GOOD" or "BAD"
-- which is used to determine if email is sent, and what is subject of email 

EXEC @status = AbcStats @report='short'  -- faster to run with "short" report option 

if @status = 1  -- (0=all good, 1=at least one "BAD" encountered)  
   Begin
      print 'BAD status, setting email subject' 
      SET @emailSubject = 'QT PRODUCTION ISSUE: BizTalk Feed Status - CRITICAL - contact BizTalk team ' 
   End 

if @status = 1 or @SendEmailOnlyOnError = 0  
   Begin
      SET @BoolSendEmail = 1 
   End 

if @BoolSendEmail = 1 
   Begin
        print 'sending email' 
        EXEC msdb.dbo.sp_send_dbmail 
            @profile_name = 'DoNotReply@SomeCompany.com',     
            @recipients = 'MyPeeps@SomeCompany.com',     
            @subject = @emailSubject,
            @query = 'exec abcStats @report=''full'';',
            @append_query_error = 1,
            @query_result_separator = ' ' 

        /* SMS not yet working */ 
        /*
       TODO Send a short text email that can be forwarded to SMS        
        */ 
    End 

end 
```

我试图不重写代码。abcStats 是 300 行代码，可能会增长到包含其他有用的警报。

如果我在 abcStats 中创建 HTML，那么运行它 SMS 将没有那么有用。我可以获取结果集并将其包装在 jobAbcStats 中的 HTML 中吗？如果我将 abcStats 重写为表函数，那么我可以将 HTML 放入 jobAbcStats 中吗？仅需要对电子邮件进行 HTML 格式设置。

我之前的帖子有些相关： [Alternative and Best ways to format SQL query for phone alert messages](https://stackoverflow.com/questions/12075592/alternative-and-best-ways-to-format-sql-query-for-phone-alert-messages)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:03:12.110

您可以在 abcStats 存储过程中创建一个 @RenderFormat 参数。然后你可以重写（并且可能不必重写）abcStats 以根据传入的@RenderFormat 调整结果。

这样，当您从 SSMS 调用 abcStats 时，它可以吐出基本的 SQL 结果，并且当您将其用作 sp_send_dbmail 的一部分时，它可以将结果包装在 HTML 中。

# excel - 从多个匹配行返回值

> ID：12096573
> 
> 赞同：2
> 
> 时间：2012-08-23T16:53:13.860
> 
> 标签：excel

首先，如果可能的话，我想在*没有*VB 的情况下执行此操作，这样我就不必经历教收件人如何启用宏的麻烦。

现在，我相信我想做的很简单，但答案可能是复杂的公式。我试图在新列中列出行中指定列中的值，这些值具有来自*其他*两列的匹配值。我敢肯定，这听起来很棘手，但一个例子应该会有很大帮助......

假设我有以下数据：

```
 ------------------
| sts | pos  | bye |
 ------------------
| 0   | QB   | 8   |
| 2   | WR   | 3   |
| 2   | QB   | 10  |
| 0   | QB   | 4   |
| 2   | QB   | 7   |
| 0   | WR   | 11  |
| 2   | WR   | 9   |
| 2   | QB   | 5   |
 ------------------ 
```

那是我的来源。我想为每个相应的 列出`bye`所有行中的值。换句话说，从上面的源数据中，我想看到以下结果集：`sts = 2``pos`

```
 --------------------------
| pos | byes               |
 --------------------------
| QB  | 10  | 7  | 5  |    |
| WR  | 3   | 9  |    |    |
 -------------------------- 
```

...因为这些是与结果表中对应`bye`的行中的值`sts = 2`相同的值。`pos``pos`

同样，如果可能的话，我想避免使用宏，只`bye`在结果表的单元格中使用公式。

希望这对您来说足够有意义，可以尝试一下。谢谢！

## 跟进：

@Richard-Morgan 我尝试使用您的公式，但无法使其正常工作。这是我的实际电子表格的屏幕截图，因此我们可以使用真实的单元格引用：

![电子表格快照](../Images/69a22aa83c9eada47c5598b2825f2afb.png)

所以`sts`是`B2:B303`，`pos`是`D2:D303`，`bye`是`E2:E303`。那么我想在`U`thru列中列出再见`Y`。看起来你的答案，如果我足够聪明来实现它，将会得到我需要的东西，所以你可以提供任何帮助让我到达终点线非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:31:31.973

可以使用以下内容：

```
{=INDEX(tbl, SMALL(IF(COUNTIF(G$3, $A$2:$A$9)
 *COUNTIF(G$4, $B$2:$B$9), ROW(tbl)-MIN(ROW(tbl))+1), ROW($C1)), COLUMN($C1))} 
```

其中A列是sts，B列是pos，C列是bye。变量 tbl 是数据范围（不是标题）。G$3 是 sts 过滤器， G$4 是 pos 过滤器。

复制数组公式DOWN查找所有匹配的byes；#NUM！找不到更多匹配项后将出现。如果这让您的用户感到困扰，您可以添加一个 ISERROR 或一个棘手的条件格式，使文本白底白字。

然后，您可以将公式复制到下一列并输入新的过滤器值。

```
 G   H
sts Search  2   2
pos Search  QB  WR

            10  3
            7   9
            5   #NUM!
            #NUM!#NUM! 
```

我认为，如果您的用户对数据透视表感到满意，那么使用它们会容易得多。

**编辑** 使公式“转置”有点棘手，我在如何解决这个问题上没有任何突破。但是，如果您想手动编辑列公式，这就是您想要的。

（我假设 S 是 sts 过滤器。也许您只是在那里进行计数，但我没有看到您在哪里输入 sts 过滤器。如果 S 不是 sts 过滤器，请更新公式以指向到 sts 为 2 或其他的地方。）

U2：

```
{=INDEX(tbl, SMALL(IF(COUNTIF($S2, $B$2:$B$303)*COUNTIF($R2, $D$2:$D$303), 
 ROW(tbl)-MIN(ROW(tbl))+1), ROW($D$1)), COLUMN($D$1))} 
```

V2：

```
{=INDEX(tbl, SMALL(IF(COUNTIF($S2, $B$2:$B$303)*COUNTIF($R2, $D$2:$D$303), 
ROW(tbl)-MIN(ROW(tbl))+1), ROW($D$2)), COLUMN($D$2))} 
```

等等

这允许向下复制单元格。

我确信有一种方法可以直接指向行/列，但我现在没时间看这个了。

**编辑 2** 如果您在某处放置一个简单的数字增量，假设 U1 有 1，V1 有 2，W1 有 3，等等，您可以使用以下内容：

```
{=INDEX(tbl, SMALL(IF(COUNTIF($S2, $B$2:$B$9)*COUNTIF($R2, $D$2:$D$9), 
ROW(tbl)-MIN(ROW(tbl))+1), U$1), COLUMN($D$1))} 
```

这将向下复制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T04:40:00.647

好的，我想出了一种方法来获得我想要的结果。这不是最干净或最好的方法，但它实现了我水平列出结果的目标，并且避免了宏或数据透视表。

我使用一个隐藏的工作表来列出所有的`pos`和`sts`值，并连接为一个值。所以...

```
sts   | pos   | bye
----------------------
2     | QB    | 8
2     | RB    | 5
2     | QB    | 11
0     | WR    | 7
. . . 
```

……变成……

```
 D   | E
    -----------
5  | 2QB | 8
6  | 2RB | 5
7  | 2QB | 11
8  | 0WR | 7
     . . . 
```

然后，我有一个模仿首页工作表上的结果区域的“阴影”结果区域。它看起来像这样：

```
 G   | H   | I   | J   | K
    -----------------------------
5  | QB  |     |     |     |     |
6  | RB  |     |     |     |     |
7  | WR  |     |     |     |     | . . . 
```

在**H5:H7**中，我有以下公式：

```
=IFERROR((ADDRESS(MATCH("2"&$G5,$D$5:$D$305,0)+4,COLUMN($E5),4)),"") 
```

**这将返回它在以2**开头并以**G**列中的值结尾的连接列中找到的第一个单元格引用（例如，第 5 行中的公式正在寻找**"2QB"**）。

然后，在**I5:** *n* **7**我有以下修改后的公式：

```
=IFERROR(ADDRESS(MATCH("2"&$G5,INDIRECT(ADDRESS(ROW(INDIRECT(H5))+1,4)&":$d$"&MAX(305,ROW(INDIRECT(H5))+1)),0)+ROW(INDIRECT(H5)),COLUMN($E5),4),"") 
```

我修改后续列的原因是更改公式在其中查找其值的范围，以便从先前找到的值*之后的下一行开始。*例如，对于上面的数据，**H5**中的公式将在 D5:D*n* 中查找“2QB”，并返回它找到的第一行并将其附加到 E 列，即**E5**。

**然后， I5**中的公式将查找从 D* *6* * 而不是 D5 开始的“2QB”，即 H5 结果中引用的行*之后的一行。*

希望这是有道理的。

所以我最终在我的隐藏工作表中得到的是：

```
 G   | H   | I   | J   | K
    -----------------------------
5  | QB  | E5  | E7  |     |     |
6  | RB  | E6  |     |     |     |
7  | WR  |     |     |     |     | . . . 
```

然后，在我的首页工作表上，我只需使用以下方法获取`bye`H5:*n*7 中的单元格引用的值（ ）：

```
=IFERROR(INDIRECT(lookups!H5),"") 
```

...这给了我最终的结果：

```
 G   | H   | I   | J   | K
    -----------------------------
5  | QB  | 8   | 11  |     |     |
6  | RB  | 5   |     |     |     |
7  | WR  |     |     |     |     | . . . 
```

就像我说的那样，它完全令人费解，但它确实有效，如果我知道如何改进它，我总是可以稍后改进它。:) 感谢您为我解决这个看似复杂的问题！我相信你的答案也很漂亮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:40:56.317

这听起来像是数据透视表的工作，而且很特别。不过，您需要添加一个 ID # 列。这是您可以做到的一种方法：

![数据透视表解决方案1](../Images/9f59c87c0912f331433647a17af2a045.png)

![数据透视表解决方案2](../Images/00a77baba2a39b459ce5660be564dcf4.png)

然后，一旦使用 go to special 选择了空白，您只需删除它们并将单元格向左移动。 ![数据透视表解决方案3](../Images/4dc372b1b74ebc03b4e35f866987ce5a.png)

祝你好运。

# winforms - 使 WinForm 控件出现在所有其他控件之上

> ID：12096577
> 
> 赞同：3
> 
> 时间：2012-08-23T16:53:33.060
> 
> 标签：winforms, label, rect

我有一个 WinFrom，我在其中隐藏了所有边框和控制框。在 WinForm 内部，我有一个 RECT()（不是 WinFrom 控件），RECT 填充了整个 WinForm。

我正在尝试将标签添加到 WinForm，但我希望标签出现在 RECT 的顶部。标签出现在 WinForm 上，但从未出现在 RECT 之上。我尝试过使用以下内容：

```
/*App Runs - Label does not show up*/
_label.Text = "This is the label";
_label.BackColor = Color.Cornsilk;
_form.Controls.Add(_label);
_form.Controls.SetChildIndex(_label, 0);

/*App Does Not Run*/
_label.Text = "This is the label";
_label.BackColor = Color.Cornsilk;
_form.Controls.SetChildIndex(_label, 0); //trying to set the index before I add the label to the form
_form.Controls.Add(_label);

/*App Runs - Label does not show up*/
_label.Text = "This is the label";
_label.BackColor = Color.Cornsilk;
_label.BringToFront();
_form.Controls.Add(_label);

/*App Runs - Label does not show up*/
_label.Text = "This is the label";
_label.BackColor = Color.Cornsilk;
_form.Controls.Add(_label);
_label.BringToFront(); 
```

如您所见，我尝试了很多不同的东西，但没有任何效果。我也尝试在添加 RECT 后添加标签，但无济于事。我在添加背景图像时遇到了类似的问题（尽管不是这里提出的问题）。有谁知道让标签出现在 RECT 顶部的更有效的方法？

另外，由于我正在使用 API 和 dll，我不能使用 RECT 或 WinForms 以外的其他东西。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T16:55:48.763

您可以在标签本身上使用[BringToFront ：](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.bringtofront%28v=vs.80%29.aspx)

```
_label.BringToFront(); 
```

这会将标签带到表单上 Z 顺序的前面，因此它应该显示在其他表单元素的顶部。

> 我有一个 RECT()（不是 WinFrom 控件），RECT 填充了整个 WinForm

“RECT”不是控件 - 它是定义大小和位置。根据您用于显示背景的内容，这可能不起作用。如果它绘制到整个表单中，它可能会覆盖您的其他控件，并“屏蔽”它们，无论您使用什么 z 顺序。如果没有更多信息，可能很难提供指导，但您必须确保在“RECT”之后重新绘制标签。

# android - 将阿拉伯语添加到模拟器语言设置android 2.2

> ID：12096578
> 
> 赞同：0
> 
> 时间：2012-08-23T16:53:58.747
> 
> 标签：android, emulation, multilingual

我的模拟器 android 2.2 只有英语和日语，我想在设置中添加阿拉伯语

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T18:17:42.827

不幸的是，从 2.3 开始支持阿拉伯语。所以你不能使用阿拉伯语。

以下是支持的语言列表：

> ```
> Language / Locale                 Supported since version
> 
> English, US (en_US)               1.1
> German, Germany (de_DE)           1.1
> Chinese, PRC (zh_CN)              1.5
> Chinese, Taiwan (zh_TW)           1.5
> Czech, Czech Republic (cs_CZ)     1.5
> Dutch, Belgium (nl_BE)            1.5
> Dutch, Netherlands (nl_NL)        1.5
> English, Australia (en_AU)        1.5
> English, Britain (en_GB)          1.5
> English, Canada (en_CA)           1.5
> English, New Zealand (en_NZ)      1.5
> English, Singapore(en_SG)         1.5
> French, Belgium (fr_BE)           1.5
> French, Canada (fr_CA)            1.5
> French, France (fr_FR)            1.5
> French, Switzerland (fr_CH)       1.5
> German, Austria (de_AT)           1.5
> German, Liechtenstein (de_LI)     1.5
> German, Switzerland (de_CH)       1.5
> Italian, Italy (it_IT)            1.5
> Italian, Switzerland (it_CH)      1.5
> Japanese (ja_JP)                  1.5
> Korean (ko_KR)                    1.5
> Polish (pl_PL)                    1.5
> Russian (ru_RU)                   1.5
> Spanish (es_ES)                   1.5
> Arabic, Egypt (ar_EG)             2.3
> Arabic, Israel (ar_IL)            2.3
> Bulgarian, Bulgaria (bg_BG)       2.3
> Catalan, Spain (ca_ES)            2.3
> Croatian, Croatia (hr_HR)         2.3
> Danish, Denmark(da_DK)            2.3
> English, India (en_IN)            2.3
> English, Ireland (en_IE)          2.3
> English, Zimbabwe (en_ZA)         2.3
> Finnish, Finland (fi_FI)          2.3
> Greek, Greece (el_GR)             2.3
> Hebrew, Israel (iw_IL)*           2.3
> Hindi, India (hi_IN)              2.3
> Hungarian, Hungary (hu_HU)        2.3
> Indonesian, Indonesia (in_ID)*    2.3
> Latvian, Latvia (lv_LV)           2.3
> Lithuanian, Lithuania (lt_LT)     2.3
> Norwegian-Bokmol, Norway(nb_NO)   2.3
> Portuguese, Brazil (pt_BR)        2.3
> Portuguese, Portugal (pt_PT)      2.3
> Romanian, Romania (ro_RO)         2.3
> Serbian (sr_RS)                   2.3
> Slovak, Slovakia (sk_SK)          2.3
> Slovenian, Slovenia (sl_SI)       2.3
> Spanish, US (es_US)               2.3
> Swedish, Sweden (sv_SE)           2.3
> Tagalog, Philippines (tl_PH)      2.3
> Thai, Thailand (th_TH)            2.3
> Turkish, Turkey (tr_TR)           2.3
> Ukrainian, Ukraine (uk_UA)        2.3
> Vietnamese, Vietnam (vi_VN)       2.3 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:15:30.177

阿拉伯语支持仅在 Android 3.0，AKA Honeycomb 中添加。在 Android 中支持它的最接近方法是找到兼容的[truetype 字体](http://en.wikipedia.org/wiki/TrueType)并使用它。

# wcf - 发送多条消息时的 wcf 回调超时

> ID：12096582
> 
> 赞同：1
> 
> 时间：2012-08-23T16:54:11.300
> 
> 标签：wcf, callback, timeout

我有一个 wcf 回调程序，它可以向客户端发送消息。

如果我尝试发送第二条消息，整个程序会冻结，我会收到超时异常。

这是服务器代码：

```
 public void SendMessageToClient(string computerName, string message)
    {
        foreach (var session in connectedClients.Values)
        {
            if (session.ComputerName == computerName)
            {
                var asyncResult = session.Callback.BeginOnMessageReceived(message, new AsyncCallback(OnPushMessageComplete), session.Callback);
                if (asyncResult.CompletedSynchronously)
                    CompletePushMessage(asyncResult);
            }
        }
    }
   void OnPushMessageComplete(IAsyncResult asyncResult)
    {
        CompletePushMessage(asyncResult);            
    }

    void CompletePushMessage(IAsyncResult asyncResult)
    {
        var callbackChannel = (IServiceCallback)asyncResult.AsyncState;
        try
        {
            callbackChannel.EndOnMessageReceived(asyncResult);
        }
        catch { }
    } 
```

这是回调接口：

```
 [OperationContract(IsOneWay = true, AsyncPattern = true)]
    IAsyncResult BeginOnMessageReceived(string message, AsyncCallback acb, object state);
    void EndOnMessageReceived(IAsyncResult iar); 
```

这是客户端代码：

```
[CallbackBehavior(ConcurrencyMode = ConcurrencyMode.Reentrant, UseSynchronizationContext = false)]
public class ServiceHandler : IServiceCallback
{
    public delegate void MessageReceivedHandler(string message);
    public event MessageReceivedHandler OnMessageReceivedEvent;

    public void OnMessageReceived(string message)
    {
        if (this.OnMessageReceivedEvent != null)
            this.OnMessageReceivedEvent(message);
    }
}    

void callback_OnMessageReceivedEvent(string message)
    {
       setlb_info(message)
    }
public void setlb_info(string wert)
    {
        if (this.lb_info.InvokeRequired)
        {
            setlb_infoCallback d = new setlb_infoCallback(setlb_info);
            this.Invoke(d, new object[] { wert });
        }
        else
        {
            this.lb_info.Text = wert;
        }

    } 
```

如果我试试这个：

```
Service.CurrentInstance.SendMessageToClient(client_name, message); 
```

客户端会收到消息，但如果我第二次调用相同的方法，我会收到超时异常（设置为 1 分钟）。

我正在使用这个项目的代码（德语）：

[http://www.flexbit.at/blog/wcf-duplex-zwischen-windows-service-und-gui-frontend/](http://www.flexbit.at/blog/wcf-duplex-zwischen-windows-sevice-und-gui-frontend/)

我希望有人可以帮助我，因为如果此功能不起作用，我将无法完成我的工作。

此致

编辑：我忘记了客户端的代码：

```
 var callback = new ServiceHandler();
                callback.OnMessageReceivedEvent += new ServiceHandler.MessageReceivedHandler(callback_OnMessageReceivedEvent);
                var callbackInstanceContext = new InstanceContext(callback);
                client = new ServiceClient(callbackInstanceContext);
                client.Subscribe(System.Environment.MachineName); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T18:33:31.413

尝试将 [CallbackBehavior(ConcurrencyMode = ConcurrencyMode. **Reentrant** , UseSynchronizationContext = false)] 更改为 [CallbackBehavior(ConcurrencyMode = ConcurrencyMode. **Multiple** , UseSynchronizationContext = false)]

# javascript - 针对数组脚本检查文本框中的值不起作用

> ID：12096588
> 
> 赞同：0
> 
> 时间：2012-08-23T16:54:29.397
> 
> 标签：javascript

我有一个脚本，我正在根据数组检查文本框中的值，该数组是下拉列表中的所有值。似乎无法让它工作。谢谢。

```
<script type = "text/javascript">

    function chkName() {

        var ddlArray = new Array();
        var ddl = document.getElementById('DropDownList1');
        for (i = 0; i < ddl.options.length; i++) {
            ddlArray[i] = ddl.options[i].value;
        }

        var str = document.getElementById("TextBox1").value;
        str = str.replace(/^\s+|\s+$/g, ""); // strip leading and trailing spaces
        str = str.toLowerCase().replace(/\b[a-z]/g, function (w) {
            return w.toUpperCase()
        }); // reformat to lower-case with initial capital

        var match = false;
        for (var i = 0; i < ddlArray.length; i++) {
            if (str == ddlArray[i]) {
                match = true;
            }
        }

        if (match) {
            alert("The name " + str + " does  match our list!");
            document.getElementById("TextBox1").value = "";
            return false;
        } else {

            return true;

        }

    }
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:05:44.233

尝试这个：

```
function chkName() {
    "use strict";
    var ddlArray = [],
        ddl = document.getElementById('DropDownList1'),
        str = document.getElementById("TextBox1").value,
        match = false;

    for (var i = 0; i < ddl.options.length; i++) {
        ddlArray[i] = ddl.options[i].value;
    }

    str = str.replace(/^\s+|\s+$/g, "");
    str = str.toLowerCase().replace(/\b[a-z]/g, function( w ) {
        return w.toUpperCase();
    });

    for (i = 0; i < ddlArray.length; i++) {
        if ( str === ddlArray[i] ) {
            alert("The name " + str + " does  match our list!");
            document.getElementById("TextBox1").value = "";
            return false;
        }
    }
    return true;
} 
```

# ruby-on-rails - Ruby 递归目录

> ID：12096592
> 
> 赞同：0
> 
> 时间：2012-08-23T16:54:53.137
> 
> 标签：ruby-on-rails, ruby, recursion

我正在尝试递归目录及其所有子目录。我不想使用“查找”或除此之外的任何其他方式：

```
task :locate do

    Dir.chdir(Dir.pwd+"/public/servers_info/config/deploy/")
    puts "Current Directory is: "+ Dir.pwd
    dir = Dir.pwd

    def get_information(dir)

        Dir.foreach(".") {|f|
            next if f == '.' or f == '..'

            if File.directory? f
                puts f
                #puts Dir.pwd+"/"+f
                get_information(Dir.pwd+"/"+f)
            else
                puts "Not Directory"
            end         
            }
    end

    get_information(dir)

end 
```

我很确定它会起作用，我只是不知道为什么它会卡在第一个目录中！它进入基本目录，检查文件是否为目录，然后再次运行 SAME 函数。但它没有！它卡在第一个文件夹上，我收到错误消息！有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T17:08:57.843

您的代码始终查看“当前”(.) 目录。您的 get_information 方法传入一个绑定到 的值`dir`，您从不使用该值。

由于您从不使用该参数，因此您永远不会更改目录。

使用 . 您尝试做的事情会更容易`Dir.glob`，但是如果您对自己的解决方案很执着，则需要更改`Dir.foreach(".")`为`Dir.foreach(dir)`.

**编辑添加**：如果您只想打印出子目录列表，我会这样做

```
puts Dir.glob('*/**').select { |f| File.directory? f} 
```

这仅包括目录。如果您想要非常接近现有代码的确切输出，我会执行以下操作：

```
puts Dir.glob('*/**').map { |f| File.directory?(f)? f : "Not a Directory" } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T17:00:59.157

退房`Dir.glob`。文档[在这里](http://www.ruby-doc.org/core-1.9.3/Dir.html#method-c-glob)

# ajax - 使用 jsonp 加载内容

> ID：12096598
> 
> 赞同：1
> 
> 时间：2012-08-23T16:55:10.440
> 
> 标签：ajax, jsonp, sencha-touch-2

我是sencha touch2的初学者。我正在尝试创建一个包含博客视图的应用程序。博客的代码如下。当我启动应用程序时，内容无法加载，出现这些错误。我正在使用 wamp 作为本地主机。

```
XMLHttpRequest cannot load "  http://secureclick-media-maynemyltf.netdna-ssl.com/Extensions/rjs/c2.js".  Origin< http://localhost> is not allowed by Access-Control-Allow-Origin.

XMLHttpRequest cannot load  " http://api.yontoo.com/GetClientData.ashx?key=null&id=47a8564d-d089-4195-9564-72f107ea1c56&loc=http%3A//localhost/GS/&apps=bestvideodownloader,ezLooker,pagerage,buzzdock,toprelatedtopics,twittube".  Origin <http://localhost> is not allowed by Access-Control-Allow-Origin. 
```

```
Ext.define('GS.view.blog',
{
        extend:'Ext.navigation.View',
    xtype: 'blogpanel',

    config:{
        title: 'Blog',
        iconCls: 'star',

        items:
        {
            xtype:'list',
            itemTpl:'{title}',
            store:
            {   
                autoLoad: true,
                fields:['title','author','content'],

                proxy:
                {
                    type:'jsonp',
                    url: 'https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&q=http://feeds.feedburner.com/SenchaBlog',
                reader:
                {
                        type:'json',
                    rootProperty:'responseData.feed.entries',
                }
                }
            }
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:59:31.010

您调用的不是[JSONP](http://en.wikipedia.org/wiki/JSONP)服务，而是 JSON 服务。您可以通过从浏览器调用[URL](https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&q=http://feeds.feedburner.com/SenchaBlog)来检测它，并查看内容不是通过方法调用开始的。

所以你没有绕过跨域保护。

您不能只告诉服务器您希望它在 JSONP 中回答：它必须准备好做出这样的回答。

而且您的浏览器不会让您从另一个域访问以 json 应答的服务器，并且没有设置一个标头来指定他接受这个跨域请求。读[这个](https://developer.mozilla.org/en-US/docs/HTTP_access_control)。

**编辑 ：**

您可以使用 JSONP 调用此服务：您只需在 URL 末尾指定一个回调。

> 除了这种响应格式，该协议还支持经典的 JSON-P 风格的回调，它通过指定回调参数触发，指示 API 将 JSON 对象作为参数传递给指定的回调。

[文档](https://developers.google.com/feed/v1/jsondevguide)中的示例：

```
'https://ajax.googleapis.com/ajax/services/feed/find?v=1.0&q=Official%20Google%20Blogs&callback=processResults' 
```

# c - GCC：两个相似循环之间的向量化差异

> ID：12096599
> 
> 赞同：34
> 
> 时间：2012-08-23T16:55:13.083
> 
> 标签：c, gcc, loops, compiler-optimization, vectorization

使用 编译时`gcc -O3`，为什么以下循环不矢量化（自动）：

```
#define SIZE (65536)

int a[SIZE], b[SIZE], c[SIZE];

int foo () {
  int i, j;

  for (i=0; i<SIZE; i++){
    for (j=i; j<SIZE; j++) {
      a[i] = b[i] > c[j] ? b[i] : c[j];
    }
  }
  return a[0];
} 
```

当下面一个呢？

```
#define SIZE (65536)

int a[SIZE], b[SIZE], c[SIZE];

int foov () {
  int i, j;

  for (i=0; i<SIZE; i++){
    for (j=i; j<SIZE; j++) {
      a[i] += b[i] > c[j] ? b[i] : c[j];
    }
  }
  return a[0];
} 
```

唯一的区别是内部循环中表达式的结果是**分配给 a[i]，还是添加到 a[i]**。

作为参考`-ftree-vectorizer-verbose=6`，给出了第一个（非矢量化）循环的以下输出。

```
v.c:8: note: not vectorized: inner-loop count not invariant.
v.c:9: note: Unknown alignment for access: c
v.c:9: note: Alignment of access forced using peeling.
v.c:9: note: not vectorized: live stmt not supported: D.2700_5 = c[j_20];

v.c:5: note: vectorized 0 loops in function. 
```

向量化循环的相同输出是：

```
v.c:8: note: not vectorized: inner-loop count not invariant.
v.c:9: note: Unknown alignment for access: c
v.c:9: note: Alignment of access forced using peeling.
v.c:9: note: vect_model_load_cost: aligned.
v.c:9: note: vect_model_load_cost: inside_cost = 1, outside_cost = 0 .
v.c:9: note: vect_model_simple_cost: inside_cost = 1, outside_cost = 1 .
v.c:9: note: vect_model_reduction_cost: inside_cost = 1, outside_cost = 6 .
v.c:9: note: cost model: prologue peel iters set to vf/2.
v.c:9: note: cost model: epilogue peel iters set to vf/2 because peeling for alignment is unknown .
v.c:9: note: Cost model analysis:
  Vector inside of loop cost: 3
  Vector outside of loop cost: 27
  Scalar iteration cost: 3
  Scalar outside cost: 7
  prologue iterations: 2
  epilogue iterations: 2
  Calculated minimum iters for profitability: 8

v.c:9: note:   Profitability threshold = 7

v.c:9: note: Profitability threshold is 7 loop iterations.
v.c:9: note: LOOP VECTORIZED.
v.c:5: note: vectorized 1 loops in function. 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-23T17:42:37.477

**在第一种情况下**`a[i]`：代码在每次迭代中覆盖相同的内存位置。由于循环迭代不是独立的，因此这固有地使循环顺序化。
（实际上，实际上只需要最后一次迭代。因此可以取出整个内循环。）

**在第二种情况下**：GCC 将循环识别为归约操作 - 为此它具有特殊情况处理来向量化。

编译器矢量化通常被实现为某种“模式匹配”。这意味着编译器会分析代码以查看它是否符合它能够矢量化的特定模式。如果是这样，它将被矢量化。如果没有，那就没有。

这似乎是第一个循环不适合 GCC 可以处理的任何预编码模式的极端情况。但第二种情况符合“矢量化减少”模式。

* * *

这是 GCC 源代码中吐出该`"not vectorized: live stmt not supported: "`消息的相关部分：

[http://svn.open64.net/svnroot/open64/trunk/osprey-gcc-4.2.0/gcc/tree-vect-analyze.c](http://svn.open64.net/svnroot/open64/trunk/osprey-gcc-4.2.0/gcc/tree-vect-analyze.c)

```
if (STMT_VINFO_LIVE_P (stmt_info))
{
    ok = vectorizable_reduction (stmt, NULL, NULL);

    if (ok)
        need_to_vectorize = true;
    else
        ok = vectorizable_live_operation (stmt, NULL, NULL);

    if (!ok)
    {
        if (vect_print_dump_info (REPORT_UNVECTORIZED_LOOPS))
        {
            fprintf (vect_dump, 
                "not vectorized: live stmt not supported: ");
            print_generic_expr (vect_dump, stmt, TDF_SLIM);
        }
        return false;
    }
} 
```

从这一行开始：

```
vectorizable_reduction (stmt, NULL, NULL); 
```

很明显，GCC 正在检查它是否匹配“矢量化缩减”模式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T17:29:24.327

GCC 矢量化器可能不够聪明，无法矢量化第一个循环。加法的情况更容易矢量化，因为`a + 0 == a`. 考虑`SIZE==4`：

```
 0 1 2 3 i
0 X
1 X X
2 X X X
3 X X X X
j 
```

`X`表示何时分配或增加`i`的组合。对于加法的情况，我们可以计算for 的结果，例如，并将其放入 vector中。然后我们只需要归零并将结果向量添加到. 对于分配的情况，它有点棘手。我们不仅要归零，而且还要归零，然后才能合并结果。我想这是矢量化器失败的地方。`j``a``b[i] > c[j] ? b[i] : c[j]``j==1``i==0..4``D``D[2..3]``a[0..3]``D[2..3]``A[0..1]`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-23T18:24:57.153

第一个循环相当于

```
#define SIZE (65536)

int a[SIZE], b[SIZE], c[SIZE];

int foo () {
  int i, j;

  for (i=0; i<SIZE; i++){
    a[i] = b[i] > c[SIZE - 1] ? b[i] : c[SIZE - 1];
  }
  return a[0];
} 
```

原始表达式的问题在于它真的没有那么大的意义，所以 gcc 不能向量化它也就不足为奇了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T17:12:17.423

第一个只是简单地更改 a[] 多次（临时）。第二个每次都使用 a[] 的最后一个值（不是临时的）。

在补丁版本之前，您可以使用“volatile”变量进行矢量化。

采用

```
int * c=malloc(sizeof(int)); 
```

使其对齐；

```
v.c:9: note: Unknown alignment for access: c 
```

显示“c”具有与 b 和 a 不同的存储区域。

我假设“矢量化”的类似“movaps”的指令（来自 SSE-AVX 指令列表）

这里： http: [//gcc.gnu.org/projects/tree-ssa/vectorization.html#using](http://gcc.gnu.org/projects/tree-ssa/vectorization.html#using)

第 6 和第 7 个例子显示了类似的困难。

# xamarin.ios - MonoTouch 中的 applicationWillBecomeActive

> ID：12096612
> 
> 赞同：0
> 
> 时间：2012-08-23T16:55:51.500
> 
> 标签：xamarin.ios

我正在尝试使用 applicationDidBecomeActive 方法（和类似的方法） - 我可以在 ObjC 中找到很多示例，但在 Monotouch 中没有。已在 AppDelegate 和 UIViewController 中尝试过覆盖，但编译器找不到合适的覆盖方法。那么，我该如何使用它呢？我想使用它（与计时器和 IdleTimerDisabled 结合使用）来阻止设备比平时更长时间地进入睡眠状态（它是一个秒表类型的应用程序）。也许我走错了路。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:42:44.087

在继承自 的应用程序委托中`UIApplicationDelegate`，您可以覆盖这些：

```
/// <summary>
/// Gets called by iOS if the app is started from scratch and is not resumed from background.
/// We have 17 seconds to leave this methos before iOS will kill the app.
/// </summary>
public override bool FinishedLaunching ( UIApplication application, NSDictionary launchOptions )

/// <summary>
/// Called if the app comes back from background or gets started. Triggered after FinishedLaunching().
/// </summary>
public override void OnActivated ( UIApplication application )

/// <summary>
/// Called if the application gets pushed to the background because the user hits the home button.
/// </summary>
public override void DidEnterBackground ( UIApplication application )

/// <summary>
/// Gets called if the app is resumed from background but NOT if the app starts first time.
/// </summary>
public override void WillEnterForeground ( UIApplication application ) 
```

# html - 如何在动态 URL 中使用 HTML # 锚点

> ID：12096614
> 
> 赞同：9
> 
> 时间：2012-08-23T16:55:55.557
> 
> 标签：html

我想使用`#`锚链接到动态页面的一部分。像这样的东西：

```
<a href=page.php?id=3#section-name>LINK</a> 
```

它没有用。正确的方法是什么？

我没有使用直接链接，而是使用`header("Location:page.php?id=3#section-name")`来自另一个脚本的重定向。

我有一个名为*page.php*`section-name`文件的部分。我猜*page.php*在确定要处理的 id 的值（或）时有问题。我被重定向到*page.php*，其内容垂直重复。**`3``3#section-name`**

 **** * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T17:02:30.950

你只展示了一半的代码，所以我只能给出一个正确方法的示例：

```
<body> 
    <a name="top"> </a>
    <a href="#top">
        Go To Top Of Page
    </a>     
</body> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T17:15:55.633

使用锚标记时，您可以通过其 ID 定位元素。`name`当链接引用此类时，浏览器将在查找属性之前查找 ID 。

`<a href="#section-name>LINK</a>``<div id="section-name">`如果存在将直接进入。

**[这是一个例子](http://jsfiddle.net/MPTJq/)**

阅读：[带有“名称”或“标识”的 HTML 锚点？](https://stackoverflow.com/questions/484719/html-anchors-with-name-or-id)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-02T02:56:09.380

### 一个典型的锚标签工作如下：

*href*链接标签是这样写的：

```
<a href="anchor_example2.html#a001">Jump to a001</a> 
```

看到上面的#a001 了吗？那是在 HTML 页面中引用一个 id，如果你点击这个链接，它会跳转到它。

要提供一个示例，说明我们将跳转到的这个 id 在页面上的外观，请看下面。

```
<li id="a001">text here</li> 
```

[参考](http://www.tagindex.net/html/link/a_name2.html)***

# jquery - Jquery.mobile $.ajax complete 被重复调用

> ID：12096623
> 
> 赞同：0
> 
> 时间：2012-08-23T16:56:15.160
> 
> 标签：jquery, jquery-mobile, cordova-2.0.0

我正在使用 jquery.mobile-1.1.1.min.js 和 cordova-2.0.0.js (phonegap)。

在我的 $.ajax 调用设置中，我将参数设置如下：

```
 success: onFetchOK,   // saves everything to the database
  complete: function(jqXHR, textStatus) {
      // show everything in the database
      showAllHeaders();
  },
  error: function(xhr, textStatus, errorThrown) {
      alert("onFetchFailure: There was an error retrieving messages: \n"
            +"xhr: " + xhr.statusText 
            +"\nstatus: " +textStatus 
            +"\nerror: " +errorThrown.message);
      $('#fetch-result').html(textStatus);
  }, 
```

onFetchOK 函数从服务器获取 18 个消息头，每个消息头都有一个主题和一个日期/时间，这些都使用 phonegap webdb 存储 API 存储在 webdb 中。

如果我删除并重新创建消息表并重新运行应用程序，那么对于我收到的 18 条消息中的每条消息都会调用一次 complete: 函数，因此会显示 342 个消息头（18x18+18）。

除了这个之外，我的代码中没有其他地方完整：showAllHeaders(); 被叫。

我在 showAllHeaders() 中放置了一个警报，该警报被触发了 18 次。

为了进一步缩小范围，我在我的成功中放置了一个循环计数器： onFetchOK() 像这样：

```
var loopCount = 0;
// process each message
$.each(json.messages, function(index, msg)
{        
    // save each alert before displaying it
    webdb.addAlert(msg.msg_id, msg.title, msg.when);
    loopCount++;
});
alert("loopCount = " +loopCount); 
```

调用此警报时，它会显示“loopCount = 18”，并且仅调用一次。

如果我退出应用程序，重新加载它并且没有从服务器中提取新消息，则会显示 18 个消息头，这正是它应该的样子。

所以，我的 complete: function() 似乎被重复调用......一次应该，然后再调用 18 次。

有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T12:03:52.910

没有实际代码很难提供帮助，但是您应该尝试一些事情......

*   `complete: function(jqXHR, textStatus) {`向函数添加警报。
    这将帮助您验证该`complete`函数是否已被调用 18 次或只是`showAllHeaders()`
*   通过 firefox 访问该页面，进入 firebug 屏幕，站在“net”选项卡上并选择 XHR
    在 XHR 下，您可以看到所有服务器响应，包括返回的数据。
    验证返回的数据是否符合预期
*   将以下行添加到您的`showAllHeaders()`函数中

> 尝试 { 抛出新错误（“虚拟”）；} 捕捉 (e) { 警报(e.stack); }

这一行将打印一个调用堆栈，并告诉你从哪里调用了这个函数

# c# - 如何创建一个 Windows 窗体以在开始时显示并在显示主窗体之前等待用户输入？

> ID：12096627
> 
> 赞同：1
> 
> 时间：2012-08-23T16:56:26.190
> 
> 标签：c#, .net, winforms

> **可能重复：**
> [C# 使用多个表单](https://stackoverflow.com/questions/10769193/c-sharp-working-with-mutliple-forms)

我有 ac# 程序，我希望能够拥有多个用户。每当启动程序时，我都想调出一个 Windows 窗体来显示一个框来选择用户。我想在显示主 Windows 窗体之前完成所有这些工作。我怎样才能做到这一点？我已经编写了主应用程序，只是希望现在能够添加多个用户，但不知道如何执行此操作。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:03:06.177

很简单，在您的 Main() 函数中，使用 Application.Run 来激活您的初步表格：

```
Application.Run(select_user_form);
selected_user = select_user_form.SelectedUser;
Application.Run(new MainForm(selected_user)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:33:29.097

在 Program.cs 文件中写下：

```
 frmUserSelection objUserSelectionForm = new frmUserSelection ();
 Application.Run(objUserSelectionForm);

 string userName = objUserSelectionForm.UserName;
 Application.Run(new MainForm(userName)); 
```

在 frmUserSelection 中声明一个字符串变量“UserName”，在关闭该用户选择表单之前，只需将选定的用户名分配给该变量并将其传递给 Mainform 构造函数，然后在 mainform 构造函数中获取其他变量中的该值并使用它！

希望能帮助你理解清楚！！

# php - 使用 preg_match 验证多种格式

> ID：12096630
> 
> 赞同：1
> 
> 时间：2012-08-23T16:56:41.057
> 
> 标签：php, regex, preg-match

我有一个电话号码字段设置为使用 preg_match 进行验证：

```
function ValidPhone($phone) {
    return preg_match('/^[0-9]{3}-[0-9]{3}-[0-9]{4}$/', trim($phone));
} 
```

这可确保以 xxx-xxx-xxxx 格式输入电话号码并且它是数字的。

我对正则表达式不是很熟悉；谁能告诉我如何扩展它以允许多种格式？即 xxx xxx xxxx 或 xxx.xxx.xxxx 或 (xxx) xxx-xxxx

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T16:59:17.937

我认为最简单的解决方案是先去掉所有不是数字的东西：

```
function ValidatePhone($phone) {
    $phone = preg_replace('/\D+/', '', $phone);
    return strlen($phone) == 10;
} 
```

由于您正在验证格式而不是内容，因此应该这样做：

```
function ValidatePhone($phone) {
    $patterns = array(
        '\d{3}([-\. ])\d{3}\g{-1}\d{4}',
        '\(\d{3}\) \d{3}-\d{4}'
        );

    $phone = trim($phone);

    foreach ($patterns as $pattern) {
        if (preg_match('/^' . $pattern . '$/', $phone))
            return true;
    }

    return false;                                                                                                                   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:02:46.943

对于美国号码：

```
\(?[2-9]\d\d)?[ -\.]?[2-9]\d\d[ -\.]?\d{4} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:24:50.930

```
(\d{3} \d{3} \w{4})|(\d{3}-\d{3}\-\d{4})|(\d{3}\.\d{3}\.\d{4}) 
```

`\d:`一位数字 [0-9]

`\d{3}:`三个一位数

`|:`逻辑或

# objective-c - 在 Xcode 中控制表格单元格行为的问题

> ID：12096637
> 
> 赞同：-1
> 
> 时间：2012-08-23T16:57:13.260
> 
> 标签：objective-c, ios, xcode, uitableview

我是 Objective C 的新手，我对正在处理的表非常迷茫。我想要的是，当我单击单元格时，它会展开并向我显示一个子视图，它是另一个标签，然后当我再次单击它时，它会隐藏子视图并显示原始文本。目前这一切都发生了可怕的错误，我真的不知道我应该如何编码。前提是我有一个问题可以扩展以揭示答案，我认为这很容易......这是我的代码：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];

// Deselect cell
[tableView deselectRowAtIndexPath:indexPath animated:TRUE];

// create the subview and apply it to the current cell selected
CGRect frame = CGRectMake(0, 0, 160, 50);
UILabel *label = [[UILabel alloc] initWithFrame:frame];
label.text = @"OH";
[cell.contentView addSubview:label];

// Toggle 'selected' state
BOOL isSelected = ![self cellIsSelected:indexPath];

// Store cell 'selected' state keyed on indexPath
NSNumber *selectedIndex = [NSNumber numberWithBool:isSelected];
[selectedIndexes setObject:selectedIndex forKey:indexPath];

// update the view that holds the table
[firstView beginUpdates];
[firstView endUpdates];

//Change cell contents
[tableView reloadRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationNone];

} 
```

如果有人可以提供一些帮助，甚至更好地更改代码以向我展示我应该如何去做，那将是非常棒的，因为我不知所措，需要在接下来的几个小时内完成这项工作！哎呀。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:33:09.430

**首先，每次**调用此方法时，您都会将标签添加到 contentView ，无论是选择还是取消选择单元格。只有当单元格原本未被选中时才需要添加标签，然后再次触摸时需要将其移除。您需要保留对标签的引用（或在其上设置标签），以便您可以调用`removeFromSuperview`：

```
[label removeFromSuperview]; 
```

我也不清楚如果单元格滚动到屏幕外并重新使用（在被选中时）会发生什么；标签是否添加回单元格中`cellForRowAtIndexPath`？如果是这样，为什么还要在这里添加它？

其次，请添加您的`cellForRowAtIndexPath`方法，因为这可能是您将文本设置为数组值的地方（这样我们就可以尝试解决您的实际问题）。

# php - 如何将下一个最大的数字插入数据库

> ID：12096642
> 
> 赞同：0
> 
> 时间：2012-08-23T16:57:24.207
> 
> 标签：php, mysql, database, mysqli

我有一段 mysqli 代码，我在其中将值插入到数据库中：

```
$insertsql = "
INSERT INTO Teacher
    (TeacherId, TeacherForename, TeacherSurname, TeacherEmail, TeacherAlias, TeacherUsername, TeacherPassword, Active, Code)
  VALUES
    (?, ?, ?, ?, ?, ?, ?, ?, ?)
";
if (!$insert = $mysqli->prepare($insertsql)) {
  // Handle errors with prepare operation here
}

$teacherid = ;

$insert->bind_param("sssssssss", $teacherid, $getfirstname, $getsurname,
             $getemail, $getteachid, $getuser,
             $password, $active, $code);

$insert->execute();

if ($insert->errno) {
  // Handle query error here
}

$insert->close(); 
```

但我有一个小问题。目前我将`$teacherid`变量留空，但我希望这个变量从数据库中找到最后一个“TeacherId”并通过插入下一个“TeacherId”来插入一个新的。

例如：

如果 TeacherId 的“Teacher”表如下所示：

```
TeacherId

T1
T2
T3
T4 
```

然后当我插入一个新的 TeacherId 值时，它应该插入`T5`，这是因为 T4 是当前最高的 T 编号，所以下一个编号应该是 T5。

有谁知道如何实现这一点。任何帮助将非常感激 ：）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T17:00:06.890

从`TeacherId`一个`varchar`变为一个`int`。创建表看起来有点像这样：

```
CREATE TABLE Teacher (
   TeacherId int unsigned not null auto_increment primary key 
```

`auto_increment`将从 1 开始，并在每次插入时自动增加 1 。

如果您*必须*在前面加上`T`，您可以随时使用`CONCAT`php 代码或在 php 代码中执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:34:16.263

你可以做这样的事情。它是一个带有格式化列的自动递增主键列。我没有机会对此进行测试。

```
CREATE TABLE Teacher (
  TeacherId mediumint UNSIGNED AUTO_INCREMENT PRIMARY_KEY,
  TeacherIdF varchar(6) AS 'T_' + CONVERT(varchar, TeacherId),
  ...
  CONSTRAINT Teacher_UKey01 UNIQUE (TeacherIdF)
) 
```

如果约束不起作用，您可以创建一个触发器，该触发器将在插入一行后更新列。

```
CREATE TABLE Teacher (
  TeacherId mediumint UNSIGNED AUTO_INCREMENT PRIMARY_KEY,
  TeacherIdF varchar(6) NULL
  ...
)

CREATE TRIGGER FormattedTeacherId
AFTER insert ON Teacher
BEGIN
UPDATE Teacher SET TeacherIdF = CONCAT('T', TeacherId)
END 
```

我没有测试过这段代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T18:33:18.577

那么你可以试试这个：

首先获取表中的总行数并将其增加 1 并将其放入您的新 id 例如：

```
$selectUsers = mysql_query ("SELECT * FROM `Teacher`") or die(mysql_error());
$num_rows = mysql_num_rows($selectUsers);

$next_id = $num_rows+1;

$new_id = 'T'.$next_id ; 
```

并将其插入表中后：

...

# ios - LandScape 模式下的 UIWebView 初始化在 iOS 4.1 的屏幕右侧有“黑色部分”

> ID：12096644
> 
> 赞同：1
> 
> 时间：2012-08-23T16:57:28.267
> 
> 标签：ios, uiwebview, landscape, ios4

我有一个 UIWebView，这里是初始化 webview 的代码：

```
webView=[[UIWebView alloc]init];
webView.scalesPageToFit = YES;
webView.multipleTouchEnabled = YES; 
```

之后，我有一个带有视图的 UIViewController 子类。这是该子类的初始化代码：（我们称之为**DetailViewController**）

```
//this is Init method of DetailViewController that contain UIWebView
//self mean DetailViewController

[self.view setBackgroundColor:[UIColor grayColor]];
    [self.view setUserInteractionEnabled:YES];

// some code to change view frame of view (view of DetailViewController) depend on rotation

// code init webView code here... and resize frame of webview to fill full parrentView

[self.view addSubview:webView]; 
```

我有tableView，当我选择单元格时-> 推送DetailViewController。当我在 Poitrant 模式下选择单元格时一切正常，但是当我在横向模式下选择单元格时——>我的 webView（只是 Init）看起来很奇怪。它在屏幕右侧有“黑色部分”，如下所述：

| webview的空白|| ***黑区***| <-- 我的横向网页视图。

重要的一件事是这个问题只发生在 iOS 4.1（真实设备）上，我在 iOS 4.3 和 5.0 上测试，一切都很好（风景和 poitrain）。

如何修复这个错误？我希望我的应用可以支持 iOS 4.1。预先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T17:33:53.723

解决方案确实非常非常简单。创建名为“mywebview”的 UIWebView 后，粘贴下面的代码

```
[mywebview loadHTMLString:@"<body style=\"width:100%;\"></body>" baseURL:nil]; 
```

:)

# jquery - 无法使用 jquery 填充 Telerik 下拉列表

> ID：12096649
> 
> 赞同：1
> 
> 时间：2012-08-23T16:58:44.940
> 
> 标签：jquery, asp.net-mvc, telerik, telerik-mvc

我正在尝试使用 jquery 填充 Telerk 下拉列表。以下是我被建议这样做的方式：

```
var dropDownList = $('#DropDownList').data('tDropDownList');

var dataSource = 
[
    { Text: "Product 1", Value: "1" },
    { Text: "Product 2", Value: "2" },
    { Text: "Product 3", Value: "3" }
];

dropDownList.dataBind(dataSource); 
```

在这里，我需要以下 JavaScript 文件才能使其工作：

1.  jquery-1.7.1.min.js
2.  Telerik.common.min.js
3.  Telerik.list.min.js

我在我的 Site.Master 中将它们与其他 CSS 和 JS 文件一起注册：

```
<head runat="server">
    <title><asp:ContentPlaceHolder ID="TitleContent" runat="server" /></title>
    <link href="/Content/Site.css" rel="stylesheet" type="text/css" />
    <link href="/Content/telerik.common.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="/Scripts/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="/Scripts/Students.js"></script>        
    <script type="text/javascript" src="/Scripts/telerik.common.min.js"></script>
    <script type="text/javascript" src="/Scripts/telerik.list.min.js"></script>
    <script type="text/javascript" src="/Scripts/telerik.combobox.min.js"></script>
</head> 
```

然后在 Site.Master 的最后我使用 ScriptRegistrar：

```
<%= Html.Telerik().ScriptRegistrar() %> 
```

但是，当我运行应用程序时，我收到以下“未定义”错误：

```
 'undefined' is null or not an object 
```

在线的：

```
dropDownList.dataBind(dataSource); 
```

这是我的 DDL：

```
<%= Html.Telerik().DropDownList()
.Name("DropDownList")
.HtmlAttributes(new {@id = "DropDownList"})
.Items(items => {
    items.Add().Text("Select").Value("Select");
        })                     
        %> 
```

我在这里错过了一些步骤吗？我是否还需要在我拥有 DDL 的页面上注册 java 脚本文件？“site.master”是我已经注册 JS 文件的“MasterPageFile”。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:30:57.653

尝试删除 jquery 的其他版本，只留下 jquery-1.7.1.min.js 并先注册它。希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:43:48.640

在您的页面中放置另一个 ScriptRegistrar 并将您的代码放入 OnDocumentReady 方法中。这将使用您的 site.master ScriptRegistrar 中的 ScriptRegistrar 注册您的函数，并且一切都应该正常工作，因为此时控件将被初始化。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:17:29.430

您应该在 Telerik DropDown 组件加载（初始化）后运行您的绑定代码。通过声明 OnLoad 事件处理程序来做到这一点的一种方法：

```
.ClientEvents(events => events.OnLoad("List_OnLoad"))

function List_OnLoad(){
  var dropDownList = $(this).data('tDropDownList');
  // the same as 
  //var dropDownList = $('#DropDownList').data('tDropDownList');
  dropDownList.dataBind(dataSource);
} 
```

# asp.net - Visual Studio 2012 ASP.NET 捆绑中途失败

> ID：12096655
> 
> 赞同：0
> 
> 时间：2012-08-23T16:59:16.943
> 
> 标签：asp.net, bundle, visual-studio-2012, minify, asp.net-optimization

我正在尝试设置 VS 2012 的新捆绑功能（通过 Microsoft.Web.Optimization 包 -[在此处](http://www.hanselman.com/blog/VisualStudio2012RCIsReleasedTheBigWebRollup.aspx)阅读更多内容），并且在大多数情况下，一切正常。问题是处理在大约 15000 个字符后就放弃了。

当我构建和运行页面时，我遇到了一堆失败，因为已加载的 JavaScript 文件在函数中间的一行中被截断......

有没有其他人经历过这种情况，或者有没有人对如何解决这个问题有任何见解？

### - 更新 -

我最初使用`foo.AddDirectory("~/scripts/", "*.js")`. 当我包含任何 jquery 插件时，仅使用`foo.AddFile("~/scripts/bar.js")`会导致 javascript 错误。服务器上没有抛出任何错误。

### --更新2--

问题是由于 Web 优化库不是最新的。我强烈建议任何尝试使用它的人通过 NuGet 命令行检索库：`Install-Package -IncludePrerelease Microsoft.AspNet.Web.Optimization`. 网上有各种版本的文档和示例，但可以使用上述方法找到最新的文档，最新的文档是在下面的答案中找到的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:41:51.777

你有小型复制品吗？我的猜测是捆绑中的 javascript 文件可能存在问题。

缩小器也可能会窒息和/或错误地缩小它们。

如果您使用的是 Scripts.Render 帮助程序，您是否尝试过使用 debug = true 运行以确保一切正常运行而无需捆绑或缩小？

这也是可能有用的最新文档：[http ://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)

# php - 如何使用 CURL 调用 API

> ID：12096657
> 
> 赞同：0
> 
> 时间：2012-08-23T16:59:21.537
> 
> 标签：php, api, curl

我正在使用 PHP 使用文本 api 发送消息。使用以下 CURL 代码。

```
 $curl_handle=curl_init();
 $url="";//url will be populated here
 curl_setopt($curl_handle, CURLOPT_SSL_VERIFYPEER, false);
 curl_setopt($curl_handle, CURLOPT_RETURNTRANSFER, true); 
 $resultcode = curl_exec($curl_handle);
 print($resultcode);
 curl_close($curl_handle); 
```

问题是，当我提交请求文本时，API 会接收我的计算机 IP 地址作为发件人，但实际上它应该是托管域的专用服务器 IP。

你能帮我找到我可以提交请求的代码，以便接收者获取服务器 IP 地址

更新：

文本 API 系统需要将请求进来的 IP 列入白名单，我已经给了专用服务器 IP。但是当我提交请求时，文本 API 系统会阻止我的请求，因为它们是从不同的 IP 接收的。这意味着它使用我的计算机 IP 而不是网站的 IP 地址。有点乱，但希望你们给我一个更好的澄清。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:04:25.023

我肯定会查看此页面以熟悉 cURL 的所有可能设置选项：

[http://php.net/manual/en/function.curl-setopt.php](http://php.net/manual/en/function.curl-setopt.php)

也就是说，向下滚动到“强制卷曲请求转到特定 IP 地址”

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:07:41.947

虽然可以“欺骗”发出请求的 IP 地址，但这并非微不足道 - 这就是为什么原始 IP 地址被用于识别和安全性的原因，这大概就是您所遇到的情况。

底线是，API 将始终看到您运行此代码的任何计算机的外部地址。

# extjs - 更改一系列 Ext.chart.series.Gauge 的 colorSet

> ID：12096660
> 
> 赞同：1
> 
> 时间：2012-08-23T16:59:31.950
> 
> 标签：extjs, extjs4, extjs4.1

我正在使用 extjs，但我对这个框架没有丰富的经验。我有一个仪表，我需要在初始化后更改它的颜色。在一个完美的世界里，我会改变这个使用

`this.myGauge.series.colorSet = ['#fff', '#ddd'];`

但是在这种情况下 colorSet 是未定义的。

创建一个新系列并将其分配给图表，如下所示：

```
this.myGauge.series.add(new Ext.chart.series.Series([{
        type: 'gauge',
        field: 'value',
        donut: 30,
        colorSet: ['#aaa', '#ddd']
     }])); 
```

这在尝试重绘图表时会引发错误

`TypeError: series.drawSeries is not a function`

即使我没有在任何地方明确调用 drawSeries() 。

在事件中修改仪表图的颜色集的最佳做法是什么？仪表的值可以改变，当它改变时，我需要更新它的颜色（十六进制代码只是测试值）。

```
 if (gaugeValue >= 95) {

     //Green         
     this.typicalGauge.series.colorSet = ['#fff', '#ddd'];

  } else if (gaugeValue < 95 && gaugeValue >= 85) {

     //Yellow
     this.typicalGauge.series.colorSet = ['#ccc', '#ddd'];

  } else if (gaugeValue < 85) {

     //Red
     this.typicalGauge.series.colorSet = ['#aaa', '#ddd'];

  } 
```

感谢 Eric Cook，我走上了正确的道路。更改 colorSet 中的第一项需要做的是利用传递给渲染器函数的索引变量，如下所示：

```
renderer: function (sprite, record, attr, index, store) {

                         var value = record.get("value");

                         var color = null;
                         if (value >= 95) {
                            color = "#1BE01B";
                         } else if (value < 85) {
                            color = "#DEE817";
                         } else {
                            color = "#E81717";
                         }
                         if (index == 0) {

                            return Ext.apply(attr, { fill: color });
                         } else {
                            return attr;
                         }

                      } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:27:21.083

我知道的最可靠的方法是通过`renderer`函数。在我看来，它没有很好的记录，所以它看起来像这样：

```
renderer: function(sprite, record, attr, index, store){
    // You'll probably want to set a breakpoint here just to see what values
    // you have to work with. I'm not completely sure myself.

    return Ext.apply(attr, {
        fill: "#f00" /* This is probably the property you're looking for */
    });
} 
```

在我看来，Ext JS 图表仍然有很多错误，所以如果它不能立即工作，请不要感到惊讶。但这应该有希望让你开始。

**编辑**：每次图表重绘时都会调用渲染器。您可以像这样从记录中获取值：

```
renderer: function(sprite, record, attr, index, store){
    var value = record.get("value"),
        color;
    if (value >= 95) {
        color = "#fff";
    } else if(value < 85) {
        color = "#aaa";
    } else {
        color = "#ccc";
    }
    return Ext.apply(attr, {fill: color});
} 
```

我不确定是否有不同的方法来设置实际的颜色集，但这基本上就是你要做的。然后你只需重新绘制图表，你的颜色应该会改变。

# teamcity - 使用嵌入式 RavenDB 的自动化测试在 TeamCity 上失败，但在通过 R# 或 NUnit 运行时失败

> ID：12096664
> 
> 赞同：0
> 
> 时间：2012-08-23T16:59:34.953
> 
> 标签：teamcity, ravendb

我正在使用 RavenDB 开发应用程序。我有针对嵌入式内存数据库的自动化测试。当我引用 Raven build 2033-Unstable 时，所有测试都运行良好。我升级到 build 2067-Unstable（现在是 2069），现在通过 TeamCity（7.1 build 23907）运行时，每个 NUnit 测试都出现异常。通过 R# 或 NUnit GUI 运行时，所有测试都运行良好。

我收到的例外似乎是`NullReferenceException`Raven 的内部人员`Raven.Bundles.Versioning.Triggers.VersioningPutTrigger.AllowPut(String key, RavenJObject document, RavenJObject metadata, TransactionInformation transactionInformation) in c:\Builds\RavenDB-Unstable-v1.2\Raven.Database\Bundles\Versioning\Triggers\VersioningPutTrigger.cs:line 22`。我什至没有使用`Versioning`捆绑包。

这是完整的堆栈跟踪：

```
Test(s) failed. Autofac.Core.DependencyResolutionException : An exception was thrown while executing a resolve operation. See the InnerException for details.
  ----> System.NullReferenceException : Object reference not set to an instance of an object.
   at Autofac.Core.Resolving.ResolveOperation.Execute(IComponentRegistration registration, IEnumerable`1 parameters)
   at Autofac.Core.Lifetime.LifetimeScope.ResolveComponent(IComponentRegistration registration, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.ResolveService(IComponentContext context, Service service, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve[TService](IComponentContext context, IEnumerable`1 parameters)
   at AppCenter.Tests.Fixture.Resolve[TService]() in c:\TeamCity\buildAgent\work\994e66c6c107022f\AppCenter.Tests\Fixture.cs:line 40
   at AppCenter.Tests.Fixture.get_Raven() in c:\TeamCity\buildAgent\work\994e66c6c107022f\AppCenter.Tests\Fixture.cs:line 22
   at AppCenter.Tests.Fixture.Store[T](T entity) in c:\TeamCity\buildAgent\work\994e66c6c107022f\AppCenter.Tests\Fixture.cs:line 50
   at AppCenter.Tests.AppAdmin.ApplicationEditTests.TestLoad() in c:\TeamCity\buildAgent\work\994e66c6c107022f\AppCenter.Tests\AppAdmin\ApplicationEditTests.cs:line 20
--NullReferenceException
   at Raven.Bundles.Versioning.Triggers.VersioningPutTrigger.AllowPut(String key, RavenJObject document, RavenJObject metadata, TransactionInformation transactionInformation) in c:\Builds\RavenDB-Unstable-v1.2\Raven.Database\Bundles\Versioning\Triggers\VersioningPutTrigger.cs:line 22
   at Raven.Database.DocumentDatabase.<>c__DisplayClass42.<AssertPutOperationNotVetoed>b__3f(AbstractPutTrigger trigger) in c:\Builds\RavenDB-Unstable-v1.2\Raven.Database\DocumentDatabase.cs:line 601
   at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source, Func`2 predicate)
   at Raven.Database.DocumentDatabase.AssertPutOperationNotVetoed(String key, RavenJObject metadata, RavenJObject document, TransactionInformation transactionInformation) in c:\Builds\RavenDB-Unstable-v1.2\Raven.Database\DocumentDatabase.cs:line 600
   at Raven.Database.DocumentDatabase.<>c__DisplayClass3a.<Put>b__33(IStorageActionsAccessor actions) in c:\Builds\RavenDB-Unstable-v1.2\Raven.Database\DocumentDatabase.cs:line 551
   at Raven.Storage.Managed.TransactionalStorage.ExecuteBatch(Action`1 action) in c:\Builds\RavenDB-Unstable-v1.2\Raven.Database\Storage\Managed\TransactionalStorage.cs:line 131
   at Raven.Storage.Managed.TransactionalStorage.Batch(Action`1 action) in c:\Builds\RavenDB-Unstable-v1.2\Raven.Database\Storage\Managed\TransactionalStorage.cs:line 112
   at Raven.Database.DocumentDatabase.Put(String key, Nullable`1 etag, RavenJObject document, RavenJObject metadata, TransactionInformation transactionInformation) in c:\Builds\RavenDB-Unstable-v1.2\Raven.Database\DocumentDatabase.cs:line 543
   at Raven.Bundles.Encryption.Settings.EncryptionSettingsManager.VerifyEncryptionKey(DocumentDatabase database, EncryptionSettings settings) in c:\Builds\RavenDB-Unstable-v1.2\Raven.Database\Bundles\Encryption\Settings\EncryptionSettingsManager.cs:line 114
   at Raven.Database.Extensions.EnumerableExtensions.Apply[T](IEnumerable`1 self, Action`1 action) in c:\Builds\RavenDB-Unstable-v1.2\Raven.Database\Extensions\EnumerableExtensions.cs:line 18
   at Raven.Database.DocumentDatabase.InitializeTriggersExceptIndexCodecs() in c:\Builds\RavenDB-Unstable-v1.2\Raven.Database\DocumentDatabase.cs:line 221
   at Raven.Database.DocumentDatabase..ctor(InMemoryRavenConfiguration configuration) in c:\Builds\RavenDB-Unstable-v1.2\Raven.Database\DocumentDatabase.cs:line 200
   at Raven.Client.Embedded.EmbeddableDocumentStore.InitializeInternal() in c:\Builds\RavenDB-Unstable-v1.2\Raven.Client.Embedded\EmbeddableDocumentStore.cs:line 208
   at Raven.Client.Document.DocumentStore.Initialize() in c:\Builds\RavenDB-Unstable-v1.2\Raven.Client.Lightweight\Document\DocumentStore.cs:line 431
   at AppCenter.Config.RavenModule.Initialize(DocumentStoreBase store) in c:\TeamCity\buildAgent\work\994e66c6c107022f\AppCenter.Framework\Config\RavenModule.cs:line 32
   at AppCenter.Tests.RavenInMemoryModule.<Load>b__1(IActivatingEventArgs`1 a) in c:\TeamCity\buildAgent\work\994e66c6c107022f\AppCenter.Tests\RavenInMemoryModule.cs:line 25
   at Autofac.Builder.RegistrationBuilder`3.<>c__DisplayClass6.<OnActivating>b__5(Object s, ActivatingEventArgs`1 e)
   at Autofac.Core.Registration.ComponentRegistration.RaiseActivating(IComponentContext context, IEnumerable`1 parameters, Object& instance)
   at Autofac.Core.Resolving.InstanceLookup.Activate(IEnumerable`1 parameters)
   at Autofac.Core.Lifetime.LifetimeScope.GetOrCreateAndShare(Guid id, Func`1 creator)
   at Autofac.Core.Resolving.InstanceLookup.Execute()
   at Autofac.Core.Resolving.ResolveOperation.GetOrCreateInstance(ISharingLifetimeScope currentOperationScope, IComponentRegistration registration, IEnumerable`1 parameters)
   at Autofac.Builder.RegistrationBuilder.<>c__DisplayClass1`1.<ForDelegate>b__0(IComponentContext c, IEnumerable`1 p)
   at Autofac.Core.Activators.Delegate.DelegateActivator.ActivateInstance(IComponentContext context, IEnumerable`1 parameters)
   at Autofac.Core.Resolving.InstanceLookup.Activate(IEnumerable`1 parameters)
   at Autofac.Core.Resolving.InstanceLookup.Execute()
   at Autofac.Core.Resolving.ResolveOperation.GetOrCreateInstance(ISharingLifetimeScope currentOperationScope, IComponentRegistration registration, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.ResolveService(IComponentContext context, Service service, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve[TService](IComponentContext context, IEnumerable`1 parameters)
   at AppCenter.Config.RavenModule.<Load>b__1(IComponentContext c) in c:\TeamCity\buildAgent\work\994e66c6c107022f\AppCenter.Framework\Config\RavenModule.cs:line 19
   at Autofac.Builder.RegistrationBuilder.<>c__DisplayClass1`1.<ForDelegate>b__0(IComponentContext c, IEnumerable`1 p)
   at Autofac.Core.Activators.Delegate.DelegateActivator.ActivateInstance(IComponentContext context, IEnumerable`1 parameters)
   at Autofac.Core.Resolving.InstanceLookup.Activate(IEnumerable`1 parameters)
   at Autofac.Core.Lifetime.LifetimeScope.GetOrCreateAndShare(Guid id, Func`1 creator)
   at Autofac.Core.Resolving.InstanceLookup.Execute()
   at Autofac.Core.Resolving.ResolveOperation.GetOrCreateInstance(ISharingLifetimeScope currentOperationScope, IComponentRegistration registration, IEnumerable`1 parameters)
   at Autofac.Builder.RegistrationBuilder.<>c__DisplayClass1`1.<ForDelegate>b__0(IComponentContext c, IEnumerable`1 p)
   at Autofac.Core.Activators.Delegate.DelegateActivator.ActivateInstance(IComponentContext context, IEnumerable`1 parameters)
   at Autofac.Core.Resolving.InstanceLookup.Activate(IEnumerable`1 parameters)
   at Autofac.Core.Resolving.InstanceLookup.Execute()
   at Autofac.Core.Resolving.ResolveOperation.GetOrCreateInstance(ISharingLifetimeScope currentOperationScope, IComponentRegistration registration, IEnumerable`1 parameters)
   at Autofac.Core.Resolving.ResolveOperation.Execute(IComponentRegistration registration, IEnumerable`1 parameters) 
```

我正在使用 Autofac 将其连接起来，该代码如下所示：

```
 protected override void Load(ContainerBuilder builder)
    {
        builder.Register(c => new EmbeddableDocumentStore
                              {
                                  RunInMemory = true,
                                  Configuration =
                                      {
                                          PluginsDirectory = GetPluginsDirectory()
                                      }
                              })
            .OnActivating(a => RavenModule.Initialize(a.Instance))
            .As<IDocumentStore>()
            .Named<IDocumentStore>("test")
            .InstancePerLifetimeScope();
    }

    private static string GetPluginsDirectory()
    {
        return Path.GetDirectoryName(typeof (UniqueConstraintsPutTrigger).Assembly.Location);
    }

    public static void Initialize(DocumentStoreBase store)
    {
        store.RegisterListener(new UniqueConstraintsStoreListener());
        store.Initialize();
        IndexCreation.CreateIndexes(typeof (RavenModule).Assembly, store);
        RequireTrigger(store, typeof (UniqueConstraintsPutTrigger));
    }

    private static void RequireTrigger(IDocumentStore store, Type triggerType)
    {
        var installedTriggerNames = store.DatabaseCommands.GetStatistics().Triggers.Select(t => t.Name);

        if (!installedTriggerNames.Contains(triggerType.ToString()))
        {
            throw new Exception(string.Format(
                "The required trigger '{0}' was not detected. Verify the bundle '{1}' been installed into the" +
                " server's plugins directory.",
                triggerType, Path.GetFileName(triggerType.Assembly.Location)));
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T14:35:57.910

解决了。将 设置为`PluginsDirectory`与所有其他 DLL 相同的文件夹，尤其是`Raven.Database.dll`，会导致该 DLL 中嵌入的所有插件也被无意加载。并非所有的 Raven 插件都可以一起工作，因此加载它们都会导致异常。通过创建一个单独的`Plugins`目录并将其复制`Raven.Bundles.UniqueConstraints.dll`到该目录中，可以使异常停止发生。

我仍然不明白为什么它只是从构建服务器失败；似乎它也应该在本地失败。

# jquery - 将变量/参数传递给 Phonegap 中的文件

> ID：12096665
> 
> 赞同：0
> 
> 时间：2012-08-23T16:59:37.460
> 
> 标签：jquery, html, jquery-mobile, cordova

我目前正在开发一个 phonegap 应用程序，它是完全动态的，所以它从暴露的 JSON api 中提取数据，其中一些数据非常具体，例如 /page.html/25/，其中 25 是页面的 id我需要得到。我的问题是，传递数据的正确方法是什么，以及在传递数据的页面上检索这些数据的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:27:31.400

如果您`JSON`从 API 请求数据，那么您可能是自己发起了该 AJAX 请求，在这种情况下，我将只使用该方法的`data`选项`$.ajax()`来传递您的 id：

```
$.ajax({
    url  : "http://www.someurl.com/",
    type : "post",
    data : { id : 25 },
    ...
}); 
```

或者，如果您必须使用`/page.html/25/`语法，那么您可以炮制您的 URL：

```
$.ajax({
    url  : "http://www.someurl.com/page.html/25/",
    ...
}); 
```

# .net - 单个或多个锁对象

> ID：12096666
> 
> 赞同：3
> 
> 时间：2012-08-23T16:59:39.637
> 
> 标签：.net, multithreading, locking

我一直在研究嵌套锁和多重锁，但我还没有找到解决这个特定场景的地方。

```
class x
{
Method1()
    {
    Lock (object)
        {
        Method2();
        }
    }

Method2()
    {
    Lock (object)
        {
        //do stuff
        }
    }

}//close class x 
```

锁定对象可以相同还是必须不同？

一种方法比另一种方法有优势吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T17:09:23.813

它们可以相同，因为`lock`(Monitor)在 .NET 中是[可重入的。](http://en.wikipedia.org/wiki/Reentrant_mutex)

[Monitor.Enter](http://msdn.microsoft.com/en-us/library/de0542zz.aspx)的文档中提到了这一点：

> 同一个线程在没有阻塞的情况下多次调用 Enter 是合法的；但是，在等待对象的其他线程解除阻塞之前，必须调用相同数量的 Exit 调用。

由于同一个线程可以多次使用同一个对象进入锁，所以上面的代码可以很好地共享同一个同步对象。

# html - 有效的 XHTML 错误 - 不允许进入

> ID：12096667
> 
> 赞同：1
> 
> 时间：2012-08-23T16:59:39.800
> 
> 标签：html, css, xhtml, html-validation

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T17:05:15.320

该链接不可点击，因为它是内联的并且是空的。这意味着它的宽度和高度为零，因此它基本上是不可见的。你应该把它`<a>`变成一个块元素（所以它会自动调整到父级的宽度），并将其调整到它的父级（`div`的）固定高度：

```
.download a { display: block; height: 100%; } 
```

当然这是为了有效的标记：

```
<td><div class="download"><a href="download.php?f='.$file.'"></a></div></td> 
```

[jsFiddle Demo](http://jsfiddle.net/bazmegakapa/aRNKV/)（简单的彩色背景，但没有区别）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T17:04:12.933

为什么不像使用 .download 类那样设置标签的样式并去掉 div。例如，将其从

```
<td><div class="download"><a href="download.php?f='.$file.'"></a></div></td> 
```

至

```
<td><a class="download" href="download.php?f='.$file.'"></a></td> 
```

# java - Java EE、Eclipse、Tomcat 简单 Servlet 启动错误

> ID：12096668
> 
> 赞同：-2
> 
> 时间：2012-08-23T16:59:41.200
> 
> 标签：java, eclipse, apache, tomcat, servlets

尝试启动简单的 Servlet 程序 (Hello Servelt) 在声明 tomcat 服务器时抛出以下异常。

我通过转到 Window->Preferences->Server->Runtime Environment->Apache Tomcatv7.0->Edit-> 并查看 Tomcat 安装目录字段来检查以确保我位于正确的根目录中。

帮助表示赞赏。

```
INFO: Starting Servlet Engine: Apache Tomcat/7.0.29
Aug 23, 2012 10:23:56 PM org.apache.catalina.core.ContainerBase startInternal
SEVERE: A child container failed during start
java.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/FirstServlet]]
    at java.util.concurrent.FutureTask$Sync.innerGet(Unknown Source)
    at java.util.concurrent.FutureTask.get(Unknown Source)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1123)
    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:785)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/FirstServlet]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    ... 7 more
Caused by: java.lang.IllegalArgumentException: Invalid <url-pattern> xmlservletpath in servlet mapping
    at org.apache.catalina.core.StandardContext.addServletMapping(StandardContext.java:3217)
    at org.apache.catalina.core.StandardContext.addServletMapping(StandardContext.java:3192)
    at org.apache.catalina.deploy.WebXml.configureContext(WebXml.java:1302)
    at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1323)
    at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:855)
    at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:346)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5173)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more

Aug 23, 2012 10:23:56 PM org.apache.catalina.core.ContainerBase startInternal
SEVERE: A child container failed during start
java.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost]]
    at java.util.concurrent.FutureTask$Sync.innerGet(Unknown Source)
    at java.util.concurrent.FutureTask.get(Unknown Source)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1123)
    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:732)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:675)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:451)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: org.apache.catalina.LifecycleException: A child container failed during start
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1131)
    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:785)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more

Aug 23, 2012 10:23:56 PM org.apache.catalina.startup.Catalina start
SEVERE: Catalina.start: 
org.apache.catalina.LifecycleException: Failed to start component [StandardServer[8005]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:675)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:451)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardService[Catalina]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:732)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 9 more
Caused by: org.apache.catalina.LifecycleException: A child container failed during start
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1131)
    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 11 more

Aug 23, 2012 10:23:56 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 1316 ms 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:11:24.967

从错误堆栈来看，servlet 映射似乎是错误的。您不应该将此发布到 SO。

```
Caused by: java.lang.IllegalArgumentException: Invalid <url-pattern> xmlservletpath in servlet mapping 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T17:05:31.403

看起来您的 web.xml 中存在错误，正如以下异常行所建议的那样：

```
Caused by: java.lang.IllegalArgumentException: Invalid <url-pattern> xmlservletpath in servlet mapping 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T17:06:49.470

你的问题很糟糕。没有关于您尝试做什么的文字提示，您尝试显示的应用程序上没有数据等。

无论如何，请检查您尝试部署的应用程序的 web.xml。显然，您在那里声明了一个 servlet，其中 url 模式的值无效，正如您的错误消息所声明的那样：

“servlet 映射中的 xmlservletpath 无效”

# c# - gridview 行更新索引

> ID：12096671
> 
> 赞同：0
> 
> 时间：2012-08-23T16:59:51.430
> 
> 标签：c#, asp.net, gridview

将项目添加到 gridview 时，我希望用户能够在将文件（从 gridview 条目）写入 csv 格式之前选择和编辑/删除项目。当我单击“编辑”并更新信息时，出现错误。位置 0 处没有行。（或您选择编辑的任何行）。这是我的代码。

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        SetFocus(parttxtbox);
        table = new DataTable();
        MakeDataTable();
    }
    else
        table = (DataTable)ViewState["table"];

    ViewState["table"] = table;
}

protected void MakeDataTable()
{
    table.Columns.Add("Part", typeof(string));
    table.Columns.Add("Quantity", typeof(Int32));
    table.Columns.Add("Ship-To", typeof(string));
    table.Columns.Add("Requested Date", typeof(string));
    table.Columns.Add("Shipping Method", typeof(string));

    //Persist the table in the Session object.
    Session["table"] = table;

    //Bind data to the GridView control.
    BindData();
}

protected void addbtn_Click(object sender, EventArgs e)
{
    part = parttxtbox.Text.ToUpper();
    shipto = shiptotxtbox.Text;
    reqdate = reqdatecal.SelectedDate.ToShortDateString();
    shipmthd = shipddl.SelectedItem.ToString();
    CreateTable();
 }

public void CreateTable()
{
    DataRow row = table.NewRow();
    row["Part"] = part;
    row["Quantity"] = qty;
    row["Ship-To"] = shipto;
    row["Requested Date"] = reqdate;
    row["Shipping Method"] = shipmthd;
    table.Rows.Add(row);

    griditems.DataSource = table.DefaultView;
    griditems.DataBind();
}

private void BindData()
{
    griditems.DataSource = table;
    griditems.DataBind();
}

protected void griditems_RowUpdating(object sender, GridViewUpdateEventArgs e)
{
    //Retrieve the table from the session object.
    DataTable dt = (DataTable)Session["table"];

    //Update the values.           
    GridViewRow row = griditems.Rows[e.RowIndex];
    dt.Rows[row.DataItemIndex]["Part"] = ((TextBox)(row.Cells[1].Controls[0])).Text;
    dt.Rows[row.DataItemIndex]["Quantity"] = ((TextBox)(row.Cells[2].Controls[0])).Text;
    dt.Rows[row.DataItemIndex]["Ship-To"] = ((TextBox)(row.Cells[3].Controls[0])).Text;
    dt.Rows[row.DataItemIndex]["Requested Date"] = ((TextBox)(row.Cells[4].Controls[0])).Text;
    dt.Rows[row.DataItemIndex]["Shipping Method"] = ((DropDownList)(row.Cells[5].Controls[0])).SelectedItem.ToString();

    //Reset the edit index.
    griditems.EditIndex = -1;
    //Bind data to the GridView control.
    BindData();

    ////Somewhat works, doesn't update the part field with the text entered
    //TextBox partedit = (TextBox)griditems.Rows[e.RowIndex].FindControl("Part");
    //DataRow row = table.NewRow();
    //row["Part"] = partedit;
    //row["Quantity"] = qty;
    //row["Ship-To"] = shipto;
    //row["Requested Date"] = reqdate;
    //row["Shipping Method"] = shipmthd;
    //table.Rows.Add(row);
} 
```

当您单击更新时，注释掉的“有些工作”部分将在更新的字段中写入空白。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:10:20.280

在 Session 中添加数据表的时间`there is no row in it`，这就是你得到错误的原因`"There is no row at position 0."`

您正在将表从视图状态分配到表，它将是会话。

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        SetFocus(parttxtbox);
        table = new DataTable();
        MakeDataTable();
    }
    else
    if(Session["table"] != null)
        table = (DataTable)ViewState["table"];
}

protected void MakeDataTable()
{
    table.Columns.Add("Part", typeof(string));
    table.Columns.Add("Quantity", typeof(Int32));
    table.Columns.Add("Ship-To", typeof(string));
    table.Columns.Add("Requested Date", typeof(string));
    table.Columns.Add("Shipping Method", typeof(string));

    //Persist the table in the Session object.
    Session["table"] = table; //This adds table without any record in it. 

    //Bind data to the GridView control.
    BindData();
} 
```

在数据表中添加记录后，将数据表添加到会话。

```
protected void addbtn_Click(object sender, EventArgs e)
{
    part = parttxtbox.Text.ToUpper();
    shipto = shiptotxtbox.Text;
    reqdate = reqdatecal.SelectedDate.ToShortDateString();
    shipmthd = shipddl.SelectedItem.ToString();
    CreateTable();
    Session["table"] = table;
 } 
```

更新后更新 griditems_RowUpdating 中的 Session["table"]。

```
protected void griditems_RowUpdating(object sender, GridViewUpdateEventArgs e)
{
    //Retrieve the table from the session object.
    DataTable dt = (DataTable)Session["table"];

    //Update the values.           
    GridViewRow row = griditems.Rows[e.RowIndex];
    dt.Rows[row.DataItemIndex]["Part"] = ((TextBox)(row.Cells[1].Controls[0])).Text;
    dt.Rows[row.DataItemIndex]["Quantity"] = ((TextBox)(row.Cells[2].Controls[0])).Text;
    dt.Rows[row.DataItemIndex]["Ship-To"] = ((TextBox)(row.Cells[3].Controls[0])).Text;
    dt.Rows[row.DataItemIndex]["Requested Date"] = ((TextBox)(row.Cells[4].Controls[0])).Text;
    dt.Rows[row.DataItemIndex]["Shipping Method"] = ((DropDownList)(row.Cells[5].Controls[0])).SelectedItem.ToString();

    //Reset the edit index.
    griditems.EditIndex = -1;
    //Bind data to the GridView control.
    BindData();

    Session["table"] = dt; 
} 
```

注意：您尝试获取更新记录的方式不合适，您应该阅读有关如何访问行更新数据的更多信息。

# android - 连续运行一个android应用程序以进行测试

> ID：12096672
> 
> 赞同：0
> 
> 时间：2012-08-23T16:59:55.703
> 
> 标签：android

我正在尝试连续运行一个 android 应用程序以进行测试，并注意到该应用程序在几个小时后停止。所以我实现了一个 AlarmManager 每隔几个小时启动一次活动，即使这样我也无法不停地运行应用程序。

我看到 AlarmManger 重新启动了几次活动，甚至它与应用程序一起死亡。有人可以建议我如何实现该功能。

我真的很感谢你的帮助！谢谢。

PS。我正在使用 android 测试手机功能，例如：cameraTest、ModemTest（播放音频、视频文件）、拨打电话、蓝牙等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:03:51.000

您可以创建一个服务，每隔 x 分钟或其他时间重新启动应用程序。从文档：

“服务是一个应用程序组件，代表应用程序希望在不与用户交互的情况下执行更长时间运行的操作，或提供功能供其他应用程序使用。”

更多[在这里](http://developer.android.com/reference/android/app/Service.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:29:05.297

您可以创建一个带有持续监控应用程序状态（无论是否运行）的线程的服务，并且它可以向您的应用程序发送广播消息以防它未运行。

# c - Cocoa：最轻量级的双同步访问方式？

> ID：12096673
> 
> 赞同：3
> 
> 时间：2012-08-23T17:00:03.663
> 
> 标签：c, cocoa, thread-safety

在我的 Cocoa/iOS 应用程序中，我有一个静态`double`变量（我们称之为`foo`），它必须是：

1.  由我的应用程序的一部分在后台线程上更新
2.  由我的应用程序的另一部分在主线程上读取

我正在寻找最轻量级的方式来同步对`foo`.

***注意**：我知道在这些情况下最简单的解决方案通常是调整代码，以便只有一个线程访问变量，因此不需要同步。假设我已经确定`foo`在这种情况下限制对单个线程的访问是不可能的（可能在步骤**1**中采取的操作发生得太快/经常发生，以至于线程切换是不可取的）。请不要回答“限制`foo`访问一个线程”的答案。我正在寻找替代方案。*

* * *

我目前的理解是，使用`volatile`变量是同步访问`foo`. 所以`foo`声明如下：

```
static volatile double foo = 60.0; 
```

后台线程编写代码是这样的：

```
foo = 90.0; 
```

主线程读取代码是这样的：

```
double bar = 0.0;
bar = foo;
// use bar here … 
```

* * *

一些问题：

1.  是否保证主线程`foo`在将其写入后台线程之后看到更新的值（假设`foo`已声明`volatile`）？IOW，我是否已经做了足够的工作来确保两个线程将看到彼此的读/写操作的结果？
2.  我假设在这种情况下使用`volatile`for`double`值更快/更轻量/更可取，而不是像`@synchronized`块或`NSLock`. 真的吗？IOW，是`volatile`这种特殊情况的最佳解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T17:09:39.850

1)**没有**。`volatile`不是这里的原子原语的替代品。关闭，但不完全。

2）问题`volatile`是，它不*正确*，正如您现在所知道的。

理想：您可以访问最新的原子语言功能，例如`_Atomic`C11 和/或`<atomic>`C++11。

如果不是，那么您可以使用 64 位整数和原子函数，按值读取，然后转移到 a `double`，或者您可以使用简单的`pthread_mutex_t`甚至是自旋锁（请注意自旋锁）。

但是……如果您只是将值的更改发布到主线程的运行循环，如果这是一个选项，它可能会更好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T19:29:30.057

Cocoa 对此有内置的原语。查看[OSAtomic.h的内容](http://developer.apple.com/library/ios/DOCUMENTATION/Cocoa/Conceptual/Multithreading/ThreadSafety/ThreadSafety.html#//apple_ref/doc/uid/10000057i-CH8-SW14)

您可以使用`OSAtomicCompareAndSwap64Barrier`以原子方式编写（正确对齐和易失的）双精度数。您可能还需`OSMemoryBarrier`要先阅读以确保您也看到最新值。我相信这只适用于 64 位架构，因为 32 位架构可能不会以原子方式读取 64 位双精度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T18:15:40.333

我会为此使用 GCD，创建一个并发调度队列来管理对变量的访问。读者可以简单

```
__block double bar;
dispatch_async(foo_queue, ^{ bar = foo; }); 
```

并且写入可以使用调度屏障：

```
dispatch_barrier_async(foo_queue, ^{ foo = someOtherFoo; }); 
```

调用`dispatch_barrier_async`确保所有待处理的读取器块都被完全执行，然后写入块将被执行并在任何更多的读取器块可以执行之前更新值。

这是 Apple 在 WWDC 的一些 GCD 视频中推荐的模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T17:11:56.207

GCC 有可能是你需要的[原子原语。](http://gcc.gnu.org/onlinedocs/gcc-4.1.1/gcc/Atomic-Builtins.html)我不知道在为 iOS 构建时对这些的支持有多好，它可能会根据您使用`gcc`、`llvm-gcc`或`clang`.

# oracle - 用于将 table_name 的表中的列数生成到 CSV 文件中的 PL/SQL 过程

> ID：12096675
> 
> 赞同：0
> 
> 时间：2012-08-23T17:00:17.923
> 
> 标签：oracle, plsql

```
select table_name,count(column_name) from all_tab_columns where owner ='HR' 
```

此查询检索结果，但我希望使用 PL/SQL 过程对表中的列数进行相同的计算，并且该输出应进入 CSV 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:32:52.200

[在此处](https://stackoverflow.com/questions/643137/how-do-i-spool-to-a-csv-formatted-file-using-sqlplus)的帮助下创建 CSV 版本 1（不使用 PL/SQL，但仍创建 CSV 文件）

```
set colsep ,     
set pagesize 0   
set trimspool on 
set headsep off  
set linesize 100   
set numw 10      

spool myfile.csv

select table_name,count(column_name) as cnt 
from all_tab_columns where owner ='HR' 
group by table_name); 
```

带有一点 PL/SQL 的版本 2

```
set serveroutput on
begin
  for  c in (select table_name,count(column_name) as cnt 
             from all_tab_columns where owner ='HR' group by table_name)  
  loop
    dbms_output.put_line(c.table_name||';'||c.cnt);
  end loop;
end;
/ 
```

如果您想要文件服务器端，版本 3 将使用 utl_file 包，但我现在假设您在 SQLplus 或 SQLdeveloper 中运行它。

# android - Android获取首选项复选框

> ID：12096676
> 
> 赞同：1
> 
> 时间：2012-08-23T17:00:19.590
> 
> 标签：android, preferences

> **可能重复：**
> [PreferenceActivity 中的正确 RadioGroup](https://stackoverflow.com/questions/6087550/proper-radiogroup-in-preferenceactivity)

我有一个这样定义的首选项文件：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >      
        <PreferenceCategory android:title="Group One" >
            <CheckBoxPreference
                android:defaultValue="false"
                android:key="optionA"
                android:title="Option A" />
            <CheckBoxPreference
                android:defaultValue="false"
                android:key="optionB"
                android:title="Option B" />
            <CheckBoxPreference
                android:defaultValue="false"
                android:key="optionC"
                android:title="Option C" />
        </PreferenceCategory>
        <PreferenceCategory android:title="Group Two" >
            <CheckBoxPreference
                android:defaultValue="false"
                android:key="optionD"
                android:title="Option D" />
            <CheckBoxPreference
                android:defaultValue="false"
                android:key="optionE"
                android:title="Option E" />
            <CheckBoxPreference
                android:defaultValue="false"
                android:key="optionF"
                android:title="Option F" />
        </PreferenceCategory>
        <PreferenceCategory android:title="Group Tree" >
            <CheckBoxPreference
                android:defaultValue="false"
                android:key="optionG"
                android:title="Option G" />
            <CheckBoxPreference
                android:defaultValue="false"
                android:key="optionH"
                android:title="Option H" />
            <CheckBoxPreference
                android:defaultValue="false"
                android:key="optionI"
                android:title="Option I" />
        </PreferenceCategory>
</PreferenceScreen> 
```

这个想法是让用户只选择选项。如果用户检查`Option I`，则选中此选项，但如果他随后检查`Option D`，`Option I`则变为未选中`Option D`并被选中。

我想知道是否可以不使用`ListPreferences`

如果它是一个对话框，我会使用`public void onClick(DialogInterface dialog, int which)`并遍历项目以完成我想要的，但我不知道如何在偏好中执行此操作。

有什么建议么？

**更新

按照 Gatekeeper 的建议，这是代码：

```
public class Preferences extends PreferenceActivity implements OnPreferenceClickListener {

    final CheckBoxPreference optionA = (CheckBoxPreference) findPreference("optionA");
    final CheckBoxPreference optionB = (CheckBoxPreference) findPreference("optionB");
    final CheckBoxPreference optionC = (CheckBoxPreference) findPreference("optionC");
    final CheckBoxPreference optionD = (CheckBoxPreference) findPreference("optionD");
    final CheckBoxPreference optionE = (CheckBoxPreference) findPreference("optionE");
    final CheckBoxPreference optionF = (CheckBoxPreference) findPreference("optionF");
    final CheckBoxPreference optionG = (CheckBoxPreference) findPreference("optionG");
    final CheckBoxPreference optionH = (CheckBoxPreference) findPreference("optionH");
    final CheckBoxPreference optionI = (CheckBoxPreference) findPreference("optionI");

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.prefs);
        System.out.println("It gets here");

    }

    @Override
    public boolean onPreferenceClick(Preference preference) {
        // TODO Auto-generated method stub
        System.out.println("This text is not printed on logcat");
        optionA.setOnPreferenceClickListener(new OnPreferenceClickListener() {
            public boolean onPreferenceClick(Preference preference) {
                unCheckAll();
                optionA.setChecked(true);
                return true;
            }
        });
        optionB.setOnPreferenceClickListener(new OnPreferenceClickListener() {
            public boolean onPreferenceClick(Preference preference) {
                unCheckAll();
                optionB.setChecked(true);
                return true;
            }
        });
        optionC.setOnPreferenceClickListener(new OnPreferenceClickListener() {
            public boolean onPreferenceClick(Preference preference) {
                unCheckAll();
                optionC.setChecked(true);
                return true;
            }
        });
        optionD.setOnPreferenceClickListener(new OnPreferenceClickListener() {
            public boolean onPreferenceClick(Preference preference) {
                unCheckAll();
                optionD.setChecked(true);
                return true;
            }
        });
        optionE.setOnPreferenceClickListener(new OnPreferenceClickListener() {
            public boolean onPreferenceClick(Preference preference) {
                unCheckAll();
                optionE.setChecked(true);
                return true;
            }
        });
        optionF.setOnPreferenceClickListener(new OnPreferenceClickListener() {
            public boolean onPreferenceClick(Preference preference) {
                unCheckAll();
                optionF.setChecked(true);
                return true;
            }
        });
        optionG.setOnPreferenceClickListener(new OnPreferenceClickListener() {
            public boolean onPreferenceClick(Preference preference) {
                unCheckAll();
                optionG.setChecked(true);
                return true;
            }
        });
        optionH.setOnPreferenceClickListener(new OnPreferenceClickListener() {
            public boolean onPreferenceClick(Preference preference) {
                unCheckAll();
                optionH.setChecked(true);
                return true;
            }
        });
        optionI.setOnPreferenceClickListener(new OnPreferenceClickListener() {
            public boolean onPreferenceClick(Preference preference) {
                unCheckAll();
                optionI.setChecked(true);
                return true;
            }
        });

        return true;
    }

    private void unCheckAll() {
        optionA.setChecked(false);
        optionB.setChecked(false);
        optionC.setChecked(false);
        optionD.setChecked(false);
        optionE.setChecked(false);
        optionF.setChecked(false);
        optionG.setChecked(false);
        optionH.setChecked(false);
        optionI.setChecked(false);

    }
} 
```

显示了我的偏好，但是在我单击一个选项后，它被认为是所有其他人都不会被选中的。这没有发生。建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:30:05.237

你可以使用代码来做到这一点。实现 onPreferenceChangedListener() 并使用状态来获得所需的响应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T17:26:44.460

我不太清楚为什么你不想使用 ListPreference，但无论哪种方式，你需要做的是，当你通过你偏好的 onClick() 方法时，你需要取消选中所有复选框，然后只选中复选框你要。

就像是

```
optionD.setOnPreferenceClickListener(new OnPreferenceClickListener() {
    public boolean onPreferenceClick(Preference preference) {
        unCheckAll();
        optionD.setChecked(true);
        return true;
    }
});

private void unCheckAll() {
    optionA.setChecked(false);
    optionB.setChecked(false);
    optionC.setChecked(false);
    // Rest of Options go here
} 
```

**更新#2**

```
private CheckBoxPreference optionA;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    addPreferencesFromResource(R.xml.prefs);
    System.out.println("It gets here");

    optionA = (CheckBoxPreference) findPreference("optionA");
    optionA.setOnPreferenceClickListener(new OnPreferenceClickListener() {
        public boolean onPreferenceClick(Preference preference) {
            unCheckAll();
            optionA.setChecked(true);
            return true;
        }
    });

} 
```

为您的所有选项执行此示例。您正在尝试在调用 addPreferencesFromResource(R.xml.prefs); 之前从首选项文件中找到您的选项；

# linq - 实体框架：任何或全部 - 无法创建类型为“System.Collections.Generic.List`1”的常量值

> ID：12096677
> 
> 赞同：0
> 
> 时间：2012-08-23T17:00:25.343
> 
> 标签：linq, entity-framework

我正在尝试做这样的事情：

```
from t in ent.myEntities
where SelectedProperties == null || SelectedProperties.Any(le => le == t.Entity)
select t 
```

基本上试图涵盖2个案例。接受一个空列表，应该返回所有实体，或者过滤列表（如果提供）。

当我提供列表时，上面实际上确实有效，但是在它为空的情况下，我得到：

> 无法创建类型为“System.Collections.Generic.List`1”的常量值。此上下文仅支持原始类型（“例如 Int32、String 和 Guid”）

还尝试将其与字符串数组一起使用：

```
where arr == null || arr.Contains(t.Entity) 
```

是否有可能在不必建立谓词的情况下拥有这样的条件（这是一个更大的努力）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:05:17.037

您可能想*尝试*以更简单的方式使用该列表：

```
where SelectedProperties == null || SelectedProperties.Contains(t.Entity) 
```

它可能不起作用，但值得一试。否则，如果这*确实是*您的全部查询，我将其写为：

```
var query = SelectedProperties == null 
            ? ent.myEntities
            : ent.myEntities.Where(t => SelectedProperties.Contains(t.Entity)); 
```

编辑：好的，如果你必须使用`Any`，并且有很多这些要组成，你可以这样做：

```
var query = ent.myEntities;
if (SelectedProperties != null)
{
    query = query.Where(t => SelectedProperties.Any(x => x == t.Entity));
}
if (SomethingElse)
{
    query = query.Where(...);
}
// etc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-26T09:21:09.697

I'm using EF5, something like this will fix the issue:

```
ent.myEntities.ToList().Where(t => SelectedProperties == null || SelectedProperties.Contains(t.Entity)); 
```

# workflow - 停止 Oozie 工作流执行

> ID：12096678
> 
> 赞同：7
> 
> 时间：2012-08-23T17:00:26.613
> 
> 标签：workflow, oozie

昨天我开始了一个 oozie 工作流程。它开始了两个整天停滞不前的工作。我今天早上杀了他们，做了一个我现在想测试的改变。在杀死这两个工作之后，就像工作流程变得不顺畅，现在正在继续。我想终止工作流程，这样它就不会继续开始新的工作来取代我杀死的工作。我怎样才能在 oozie 命令行中做到这一点？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2014-07-03T11:41:13.117

Oozie 命令
--------------
注意：将 oozie 服务器和端口替换为特定于集群的。

**1）提交作业：**
`$ oozie job -oozie http://localhost:11000/oozie -config oozieProject/workflowHdfsAndEmailActions/job.properties -submit job: 0000001-130712212133144-oozie-oozi-W`

**2）运行作业：**
`$ oozie job -oozie http://localhost:11000/oozie -start 0000001-130712212133144-oozie-oozi-W`

**3）检查状态：**
`$ oozie job -oozie http://localhost:11000/oozie -info 0000001-130712212133144-oozie-oozi-W`

**4）暂停工作流程：**
`$ oozie job -oozie http://localhost:11000/oozie -suspend 0000001-130712212133144-oozie-oozi-W`

**5）恢复工作流程：**
`$ oozie job -oozie http://localhost:11000/oozie -resume 0000001-130712212133144-oozie-oozi-W`

**6）重新运行工作流程：**
`$ oozie job -oozie http://localhost:11000/oozie -config oozieProject/workflowHdfsAndEmailActions/job.properties -rerun 0000001-130712212133144-oozie-oozi-W`

**7）是否需要终止作业：**
`$ oozie job -oozie http://localhost:11000/oozie -kill 0000001-130712212133144-oozie-oozi-W`

**8）查看服务器日志：**
`$ oozie job -oozie http://localhost:11000/oozie -logs 0000001-130712212133144-oozie-oozi-W`

**日志可在：**
`/var/log/oozie on the Oozie server`。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-23T17:59:57.117

您可以通过以下方式查看正在运行的作业：

```
oozie jobs 
```

或者如果它是协调器，而不是工作流：

```
oozie jobs -jobtype coordinator 
```

并从那里获取作业 ID，然后执行：

```
oozie job -kill [id] 
```

这是命令行工具参考页面：http: [//incubator.apache.org/oozie/docs/3.1.3/docs/DG_CommandLineTool.html](http://incubator.apache.org/oozie/docs/3.1.3/docs/DG_CommandLineTool.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-31T18:41:36.190

我认为您会发现如何使用 bash 同时杀死、重新运行等多个（例如 200 个）作业很有帮助。

在一行中：

```
$for jobid in `oozie jobs -filter status=SUSPENDED | cut -d" " -f1`; do echo "Killed job ${jobid}"; job -kill ${jobid}; done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-13T10:06:11.907

除了与 Oozie 命令相关的帖子之外，有时我们不必访问相应的工作流 id 来挂起/终止等，我们会收到以下错误：

```
Error: E0508 : E0508: User [?] not authorized for WF job [0001304-190209190348229-oozie-mapr-W] 
```

为此，要执行诸如终止/挂起等任何操作，我们需要为我们的用户 ID 生成身份验证令牌。为此，首先，我们需要使用以下命令从文件中清除现有令牌，然后对给定的工作流 id 执行挂起/终止等操作：

```
rm .oozie-auth-token 
```

来自 Apache Oozie 文档：

> 成功执行身份验证后，接收到的身份验证令牌将缓存在 .oozie-auth-token 文件中的用户主目录中，并具有仅所有者权限。后续请求在有效时重用缓存的令牌。

更多细节，Apache Oozie 文档的链接（参考认证部分）： [官方文档](https://oozie.apache.org/docs/3.2.0-incubating/DG_CommandLineTool.html#Authentication)

# python - 快速 numpy addnan

> ID：12096684
> 
> 赞同：8
> 
> 时间：2012-08-23T17:01:05.827
> 
> 标签：python, optimization, numpy, nan, scientific-computing

我想明智地添加数千个 4D 数组元素并考虑 nans。使用一维数组的简单示例是：

```
X = array([4,7,89,nan,89,65, nan])
Y = array([0,5,4, 9,  8, 100,nan])
z = X+Y
print z = array([4,12,93,9,97,165,nan]) 
```

我为此编写了一个简单的 for 循环，但它需要很长时间 - 这不是一个聪明的解决方案。另一种解决方案可能是创建一个更大的数组并使用bottleneck nansum，但这会占用我的笔记本电脑太多的内存。我需要超过 11000 个案例的总和。

有没有人有一个聪明而快速的方法来做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T17:20:55.850

这是一种可能性：

```
>>> x = np.array([1, 2, np.nan, 3, np.nan, 4])
... y = np.array([1, np.nan, 2, 5, np.nan, 8])
>>> x = np.ma.masked_array(np.nan_to_num(x), mask=np.isnan(x) & np.isnan(y))
>>> y = np.ma.masked_array(np.nan_to_num(y), mask=x.mask)
>>> (x+y).filled(np.nan)
array([  2.,   2.,   2.,   8.,  nan,  12.]) 
```

真正的困难是您似乎希望`nan`被解释为零，除非特定位置的所有值都是`nan`. 这意味着您必须同时查看 x 和 y 以确定要替换的 nan。如果您可以替换所有 nan 值，那么您可以简单地执行`np.nan_to_num(x) + np.nan_to_num(y)`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-24T12:29:18.747

```
import numpy as np
z=np.nansum([X,Y],axis=0) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-23T17:23:28.843

您可以执行以下操作：

```
arr1 = np.array([1.0, 1.0, np.nan, 1.0, 1.0, np.nan])
arr2 = np.array([1.0, 1.0, 1.0, 1.0, 1.0, np.nan])
flags = np.isnan(arr1) & np.isnan(arr2)
copy1 = arr1.copy()
copy2 = arr2.copy()
copy1[np.isnan(copy1)] = 0.0
copy2[np.isnan(copy2)] = 0.0
out = copy1 + copy2
out[flags] = np.NaN
print out
array([  2.,   2.,   1.,   2.,   2.,  NaN]) 
```

`NaN`查找数组中在该索引中都有 a 的位置。然后，基本上按照@mgilson 的建议进行操作，例如制作副本并将`NaN`s 替换为 0.0，将两个数组相加，然后将上面的标记索引替换为`np.NaN`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T17:12:12.553

不知道这会如何执行，但值得一试:)

```
def nan_to_zero(array):
    new_arr = array.copy()
    new_arr[np.isnan(array)] = 0.
    return new_arr

sum( nan_to_zero(arr) for arr in array_generator ) 
```

但是，这不会导致`NaN`数组的最后一个位置。结果是0 ...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-24T20:42:42.663

我看到了几个更简单的解决方案：

*   （**已编辑**）使用`np.ma`

    ```
    mX = np.ma.masked_array(X, mask=np.isnan(X))
    mY = np.ma.masked_array(Y, mask=np.isnan(Y))
    mZ = np.ma.masked_array(mX.filled(0) + mY.filled(0),
                            mask=mX.mask * mY.mask)
    Z = mZ.filled(np.nan) 
    ```

*   （**已编辑**）不使用`np.ma`

    ```
    mx = np.isnan(x)
    my = np.isnan(y)
    z = np.where(mx,0,x) + np.where(my,0,y)
    z[mx&my] = np.nan 
    ```

# python - python中的战争纸牌游戏模拟

> ID：12096689
> 
> 赞同：0
> 
> 时间：2012-08-23T17:01:39.057
> 
> 标签：python, simulation, game-engine

嗨，如果您是这里的常客，您可能会记得这个程序。我已经解决了许多错误，但被一个难住了。错误是：

```
File "/Users/administrator/Desktop/war.py", line 62, in <module>
    player1.extend(player1[range(warcardvalue1)])
TypeError: list indices must be integers, not list 
```

代码是：

```
import random

cards = ['ace', 'ace', 'ace', 'ace', '1', '1', '1', '1', '2', '2', '2', '2', '3', '3', '3', '3', '4', '4', '4', '4', '5', '5', '5', '5', '6', '6', '6', '6', '7', '7', '7', '7', '8', '8', '8', '8', '9', '9', '9', '9', '10', '10', '10', '10', 'jack', 'jack', 'jack', 'jack', 'queen', 'queen', 'queen', 'queen', 'king', 'king', 'king', 'king']

order = ['ace', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'jack', 'queen', 'king'] 
warcardvalue0 = 0
warcardvalue1 = 0
print "shuffling cards" 
random.shuffle(cards)
print "lets play"

player0 = cards[1::2]

player1 = cards[::2]

while (len(player0) > 0 or len(player1) > 0):

    nextcard0 = player0[0]
    nextcard1 = player1[0]

    cardplayed0 = order.index(nextcard0)

    cardplayed1 = order.index(nextcard1)

    if cardplayed0 > cardplayed1:

        player0.append(nextcard0)
        player0.append(nextcard1)
        player0.remove(nextcard0)
        player1.remove(nextcard1)

    elif cardplayed0 < cardplayed1:

        player1.append(nextcard1)
        player1.append(nextcard0)
        player1.remove(nextcard1)
        player0.remove(nextcard0)

    elif cardplayed0 == cardplayed1:
        while warcardvalue0 == warcardvalue1:
            if len(player0) >= 3:
                        warcard0 = player0[3]
                elif len(player0) < 3:
                    warcard0 = player0[len(player0)-1]

            if len(player1) >= 3:
                        warcard1 = player1[3]
                elif len(player1) < 3:
                    warcard1 = player1[len(player1)-1]

            warcardvalue0 = order.index(warcard0)
            warcardvalue1 = order.index(warcard1)

            if warcardvalue0 > warcardvalue1:
                player0.extend(player0[range(warcardvalue0)])
                player0.extend(player1[range(warcardvalue1)])
                player0.extend(player0[range(warcardvalue0)])
                player1.extend(player1[range(warcardvalue1)]) 

            elif warcardvalue0 < warcardvalue1:
                player1.extend(player1[range(warcardvalue1)])
                player1.extend(player0[range(warcardvalue0)])
                player1.extend(player1[range(warcardvalue1)])
                player0.extend(player0[range(warcardvalue0)]) 
            else:
                print "another war!" 

if len(player1) == 0:
    print "player1 won!"
elif len(player0) == 0:
    print "player0 won!" 
```

我认为问题在于您不能在列表中使用范围，但我不确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:05:11.670

> 我认为问题在于您不能在列表中使用范围，但我不确定。

问题是你不能用一个列表来索引一个列表。

试试这个：

```
player1.extend(player1[:warcardvalue1]) 
```

想这样做似乎有点奇怪....

# extjs - Extjs 类系统静态

> ID：12096691
> 
> 赞同：2
> 
> 时间：2012-08-23T17:01:44.080
> 
> 标签：extjs, extjs4

我想定义一个具有实用功能的类。我正在使用 Extjs 类系统。

我正在通过以下方式执行此操作：

```
Ext.ns('Controls.Plugins.Nzok')

Ext.define('Controls.Plugins.Nzok.XUtility', {
     statics : {
         getTest : function(test) { return test }
     }
}) 
```

现在，当我想使用 getTest 方法时，我必须要求该类并编写完整的类名

```
Ext.define('Controls.Plugins.Nzok', {
    requires : ['Controls.Plugins.Nzok.XUtility'],

    useTest : function() {
        var testResult = Controls.Plugins.Nzok.XUtility.getTest(2);
    }
}) 
```

我的问题是符号太长了。每次写Controls.Plugins.Nzok.XUtility 很不方便。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T17:15:13.153

配置`alternateClassName`可以解决问题。

```
Ext.define('Controls.Plugins.Nzok.XUtility', {
    alternateClassName: 'Controls.XUtil',  // <--- this is your shorthand
    statics : {
        getTest : function(test) { return test }
    }
}); 
```

作为旁注，`Ext.define`将根据您的类名自动创建命名空间，因此`Ext.define('Controls.Plugins.Nzok.XUtility'`将为您生成`Controls.Plugins.Nzok`命名空间。

# c# - GetOriginalTypeParameterType 抛出对象引用未设置为对象异常的实例

> ID：12096695
> 
> 赞同：7
> 
> 时间：2012-08-23T17:02:10.820
> 
> 标签：c#, asp.net-mvc-3, generics, dynamic

参考：[动态如何用作泛型？](https://stackoverflow.com/q/10132760/1026459)

```
public void CheckEntity(int entityId, string entityType = null)
{
 dynamic AnyObject = Activator.CreateInstance("Assembly","Assembly.Models.DbModels." + entityType).Unwrap();
 CheckWithInference(AnyObject, entityId);
}

private static void CheckWithInference<T>(T ignored, int entityId) where T : class
{
 Check<T>(entityId);
}

private static void Check<T>(int entityId) where T : class
{
 using (var gr = new GenericRepository<T>())
 {
 }
} 
```

这与`CheckEntity(16,"Container");`. 第一行运行后，用调试器检查时`AnyObject`变为空白。`Assembly.Models.DbModels.Container`如果`var AnyType = AnyObject.GetType();`使用，则`AnyType`显示为`Assembly.Models.DbModels.Container`。但是，当调用到时`CheckWithInference(AnyObject, entityId);`会引发异常。

*   外部：对象引用未设置为对象的实例。*   内部：Microsoft.CSharp.RuntimeBinder.SymbolTable.GetOriginalTypeParameterType(Type t) +10

    我在这里做了一个独立的例子 - 但它运行没有错误:(

    注意，这是在 asp.net mvc 3 c#

    HomeController.cs：

    ```
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Web;
    using System.Web.Mvc;

    namespace InferenceExample.Controllers
    {
    public class HomeController : Controller
    {
        //
        // GET: /Home/

        public ActionResult Index()
        {
            return View();
        }

        public void CheckEntity(int entityId, string entityType = null)
        {
            dynamic AnyObject = Activator.CreateInstance("InferenceExample", "InferenceExample.Models." + entityType).Unwrap();
            CheckWithInference(AnyObject, entityId);
        }

        private static void CheckWithInference<T>(T ignored, int entityId) where T : class
        {
            Check<T>(entityId);
        }

        private static void Check<T>(int entityId) where T : class
        {
            var repo = new List<T>();
        }

    }
    } 
    ```

    Example.cs

    ```
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Web;

    namespace InferenceExample.Models
    {
    public class Example
    {
        public int ExampleId { get; set; }
        public string Name { get; set; }
    }
    } 
    ```

    索引.cshtml

    ```
    @{
    ViewBag.Title = "Index";
    }

    <h2>Index</h2>

    @Html.ActionLink("Start", "CheckEntity", new { entityId = 16, entityType = "Example" }) 
    ```

    我很茫然。为什么会出现这个异常？我无法轻松地复制它。我不确定该示例还包括什么，因为这就是实际代码中包含的所有内容。

    真正令人困惑的部分是，在应用程序中，当发生此异常时，操作将失败。但是，在重新访问该页面并再次尝试时，没有抛出异常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:53:47.973

正如 C# 聊天室中所讨论的，这里的解决方案是完全绕过动态并使用反射来调用泛型方法。Dynamic 有一些不错的特性，但有时会带来比其价值更多的麻烦，尤其是当它可以在运行时获取 Type 对象时。

```
var modelType = Type.GetType("InferenceExample.Models." + entityType + ",InferenceExample");

var checkMethod = typeof(HomeController).GetMethod("CheckWithInference", BindingFlags.NonPublic | BindingFlags.Static);
checkMethod.MakeGenericMethod(modelType).Invoke(null, new object[] { entityId }); 
```

乐意效劳 ：）

# php - 另一个eregi替换问题，用于网页导航

> ID：12096701
> 
> 赞同：0
> 
> 时间：2012-08-23T17:02:43.753
> 
> 标签：php, html, preg-match, eregi

我的主机最近将他们的 PHP 更新到 5.3（没有警告），我现在必须在我的索引页面上替换我的页面导航代码。这是我目前正在使用的：

```
<? if (eregi(".shtml", $load)) {if (!@readfile("$load")) { readfile("error.shtml"); }  } if (!eregi(".shtml", $load)) {if (!@readfile(include("/home/content/j/p/l/jplegacy/html/coranto/news.txt") )) ;}?> 
```

这是我在链接中用作导航的示例：

```
<a href="?load=archive/archive.shtml">Archive</a>
<a href="?load=about.shtml">About Us</a> 
```

我研究了两种不同的技术，preg_match() 和 stristr()。

preg_match() 从 Coranto 输出我的错误页面和 news.txt 文件，但不会将我导航到上面链接中的页面。我可以在这里做些什么来完成这项工作？

stristr() 没有给我警告，但它不导航页面，只输出我的 Coranto 新闻页面。如果这会更好，我该怎么做才能完成这项工作？

我需要做什么来解决这个问题？我完全迷路了。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:17:50.873

ereg(i) 被认为已被弃用。您应该将 preg_match 用于正则表达式，因为 preg 比其他引擎更快。另外，如果你想以“.shtml”结尾，那正则表达式是错误的，你不需要求助于正则表达式。以 .shtml 结尾的是“^*.shtml$”。如果您确实选择使用 preg_match，所有 preg_match 正则表达式，如 perl，都被“/”（斜杠）包围，因此正确的正则表达式如下所示：

```
 preg_match("/^.*\.shtml$/", $load) 
```

但是对于“以 .shtml 结尾”的更好解决方案。通常你不应该使用正则表达式，除非情况确实需要它们（它们比使用 substr 和匹配字符串的最后一部分要慢得多），像这样的简单匹配不符合条件。

```
 if (substr($test, sizeof($load) - 7, 6 )) == '.shtml') { ... } 
```

# java - 显示大于 599 的状态码的自定义错误页面

> ID：12096703
> 
> 赞同：0
> 
> 时间：2012-08-23T17:02:48.277
> 
> 标签：java, http, struts

我们在 struts 1.1 应用程序中使用自定义 http 状态代码。它们在定义下的 web.xml 中`<error-page>`定义。我遇到的问题是我们的错误页面（也在 web.xml 中为这些状态代码定义）没有显示这些状态代码。但是，它将显示正常的 400 和 500 状态代码。我需要做一些特别的事情来获取自定义 http 状态代码来调用我们的自定义错误页面吗？目前我正在使用

```
response.sendError(601, "custom message") 
```

触发错误状态，但它总是转到默认的 tomcat 错误页面。如果需要，我可以显示更多代码。

这是错误页面定义：

```
<error-page>
   <error-code>601</error-code>
   <location>/jsp/Error.jsp?errorCode=601</location>
</error-page> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:54:11.410

HTTP 中不允许超过 599 的状态码。所以：不要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T21:10:07.980

在示例 webapp 的 web.xml 中使用错误页面定义也适用于 Tomcat 5.0.28 和 Struts 1.1。刚检查。作为一种解决方法，您可以在请求中设置错误代码/消息总是转发到错误页面

# cocoa - 将 NSView 渲染到图像：cacheDisplayInRect 绘制透明区域与通常的 drawRect 调用不同

> ID：12096705
> 
> 赞同：3
> 
> 时间：2012-08-23T17:02:57.643
> 
> 标签：cocoa, nsview, drawrect, nsimage, image-capture

**问候！**我有一个问题，谷歌搜索没有带来任何结果......

我为我的 NSView（子类）实现了 drawRect 方法来绘制一些阴影和半透明填充。一切看起来都很棒！但现在我需要从我的 NSView （制作快照）创建一个 NSImage 用于拖放目的。

它可以工作，但以某种不同的方式绘制：更暗并且没有应有的对比度。
**为什么？也许是因为 NSGraphicContext 不同的选项？需要帮助和/或建议！**

下面是从 NSView 获取 NSImage 的代码：

```
- (NSImage *)makeImageSnapshot {

    NSSize imgSize = self.bounds.size;

    NSBitmapImageRep * bir = [self bitmapImageRepForCachingDisplayInRect:[self bounds]];
    [bir setSize:imgSize];

    [self cacheDisplayInRect:[self bounds] toBitmapImageRep:bir];

    NSImage* image = [[[NSImage alloc] initWithSize:imgSize] autorelease];
    [image addRepresentation:bir];

    return image;
} 
```

以下是视觉比较的图像：

1.  正常 - 由 drawRect 通常调用绘制：[http ://cl.ly/image/213C1Y1V0v2H](http://cl.ly/image/213C1Y1V0v2H)
2.  不好 - 捕获到 NSImage：[http ://cl.ly/image/183q442S2J14](http://cl.ly/image/183q442S2J14)

认为差异可能看起来很小，相信我 - 在使用应用程序时很明显。我不明白为什么会这样。并希望有人可以帮助...

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T18:53:53.667

我相信透明度问题是由于没有其他东西来混合它自己缓存时造成的。

尝试 -dataWithPDFInsideRect: 或 -dataWithEPSInsideRect: 并从那里获取您的图像代表。

# java - 在primefaces，JSF webapp中显示嵌套bean

> ID：12096707
> 
> 赞同：0
> 
> 时间：2012-08-23T17:03:12.930
> 
> 标签：java, spring, jsf, primefaces

在我的 JSF 页面中，我有以下内容：

```
<h:outputText value="#{entity[column.key]}" /> 
```

我的实体豆（简单版）：

```
public class Entity implements Serializable {
private int id;
private Entity entity;

public int getId() {
    return id;
}
public void setId(int id) {
    this.id = id;
}

public Entity getEntity() {
    return this.entity;
}
public void setEntity(Entity entity) {
    this.entity = entity;
}
} 
```

当我的 [column.key] 变量保存为值“id”时，将显示实体的 id 属性。当我的 [column.key] 变量保存为值“entity.id”时，我收到一个错误：

> /WEB-INF/flows/parametersPage/parametersPage.xhtml @51,66 value="#{entity[column.key]}"：在 eu.acsone.agc.db.entity 类型上找不到属性“entity.id”。实体

调试的时候看到实体是在bean中设置的，所以不为null。

希望大家帮忙，谢谢！

我正在使用：* Mojarra 2.1.7 * Primefaces 3.3.1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:32:20.230

它的原因是您没有属性（这实际上在 java 中是非法的 - 不允许使用点分隔符）

```
private int entity.id; //its not even legal 
```

在你的豆子里

当您尝试像这样访问您的bean时`value="#{entity[variableThatHoldSomeString]}":`

JSF 将在你的 bean 中寻找一个属性`SomeString`......这就是你得到这个错误的原因尝试这样的事情

```
value="#{entity.entity[column.key]}": 
```

其中`[column.key]`变量将保存一个值“id”，

（顺便说一句，相同类型的嵌套属性对我来说看起来很奇怪）

# android - 自动完成功能不起作用

> ID：12096711
> 
> 赞同：1
> 
> 时间：2012-08-23T17:03:21.980
> 
> 标签：android, autocompletetextview

我有一个包含名称和 AutoCompleteTextView 的列表。我需要 AutoCompleteTextView 来按用户输入的字符串过滤名称，但我不知道我做错了什么，因为 AutoCompleteTextView 不起作用。你能帮助我吗？

这是我的代码：

```
cursor = socioData.getAllSocios();
adapter = new SimpleCursorAdapter(
        this,
        android.R.layout.simple_dropdown_item_1line,
        cursor,
        new String[]{Socio.C_NOME},
        new int[]{android.R.id.text1}
        );

filterText = (AutoCompleteTextView)findViewById(R.id.search);
filterText.setThreshold(1);
filterText.setAdapter(adapter);
adapter.setCursorToStringConverter(new CursorToStringConverter() {
    @Override
    public String convertToString(Cursor cursor) {
        //return cursor.getString(1);
        final int colIndex = cursor.getColumnIndexOrThrow(Socio.C_NOME);
        return cursor.getString(colIndex);
    }
});

adapter.setFilterQueryProvider(new FilterQueryProvider() {
    @Override
    public Cursor runQuery(CharSequence constraint){
        return getContentResolver().query(Data.CONTENT_URI,
                Socio.ALL_COLUMNS,
                Socio.C_NOME + " like '%"+constraint+"%'",
                null,
                Socio.C_NOME +" ASC");
    }
});  

filterListener = new TextWatcher() {
    @Override
    public void onTextChanged(CharSequence s, int arg1, int arg2, int arg3) {
        if ("".equals(s))
            adapter.getFilter().filter(null);
        else
            adapter.getFilter().filter(s.toString());   
    }

    @Override
    public void beforeTextChanged(CharSequence arg0, int arg1, int arg2, int arg3) {}

    @Override
    public void afterTextChanged(Editable arg0) {}
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:32:47.060

您似乎试图做太多事情......这里有一些简化：

*   我看不到您在哪里使用 TextWatcher，但这不是必需的。事实上，它可能会阻止 AutoCompleteTextView 工作。所以你应该删除它。

*   在您的 FilterQueryProvider 和 getAllSocios() 中，您应该只询问列`_id`，`Socio.C_NOME`因为这些是您使用的唯一两列。

*   只需使用`setStringConversionColumn()`而不是 CursorToStringConverter：

总之，你只需要：

```
cursor = socioData.getAllSocios();
adapter = new SimpleCursorAdapter(
        this,
        android.R.layout.simple_dropdown_item_1line,
        cursor,
        new String[]{Socio.C_NOME},
        new int[]{android.R.id.text1} );

adapter.setFilterQueryProvider(new FilterQueryProvider() {
    @Override
    public Cursor runQuery(CharSequence constraint){
        // Stop the FQP from looking for nothing
        if(constraint == null)
            return null;

        return getContentResolver().query(Data.CONTENT_URI,
            new String[] {"_id", Socio.C_NOME},
            Socio.C_NOME + " like ?", 
            "'%"+constraint+"%'",
            Socio.C_NOME);
    }
});
adapter.setStringConversionColumn(cursor.getColumnIndex(Socio.C_NOME));

filterText = (AutoCompleteTextView)findViewById(R.id.search);
filterText.setThreshold(1);
filterText.setAdapter(adapter); 
```

希望有帮助！

# asp.net - 如何合并2个mvc2项目

> ID：12096712
> 
> 赞同：1
> 
> 时间：2012-08-23T17:03:21.700
> 
> 标签：asp.net, asp.net-mvc-2

有没有办法合并 2 mvc 2 项目。？

我已经尝试过区域，但这不起作用。

这两个项目没有相同的结构树并且不在同一个命名空间中。这是由 2 个不同的人制作的 2 个不同的项目。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:28:50.213

合并 2 个 mvc 项目并不像 MVC 和 webforms 那样直接，这里的问题是 MVC 运行时使用其控制器、操作和视图名称的默认命名约定，并且它在不同的位置查找（查看视图/共享等文件夹) 通过这些名称...因此具有不同的名称空间也无济于事...如果您有具有相同名称的控制器，那么您必须将其中一个设置为部分，并且您必须确保没有重复动作方法...

# php - 如何使用 PHP 套接字通过 TOR 发送 http 请求

> ID：12096714
> 
> 赞同：0
> 
> 时间：2012-08-23T17:03:21.863
> 
> 标签：php, sockets, networking, socks, tor

我只想使用 PHP 套接字（不是 cURL）连接到 TOR 并使用 SOCKS5 协议通过 TOR 将 HTTP 内容发送到 Web，或者获取一些这样做的 php 类。

**新版本

当我触发以下内容时：

fputs($Socket, "AUTHENTICATE $auth_code\r\n");

其中 $auth_code 是 NULL 值我得到了这个“ *250 OK* ”

但是当我发送这个时：

fputs($Socket, "GET /index.php HTTP/1.1\r\n");

我收到以下错误“ *无法识别的命令”GET“510* ”

所以我的问题是，`How can i send http raw data to TOR to forward it?`**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:16:32.770

据我所知，没有可以使用 SOCKS 转发数据的 PHP 库。你可以自己动手，但你必须学习 SOCKS 协议，用 PHP 打开与服务器的连接，然后用指令向它发送数据。SOCKS 不是 HTTP-only 协议，它可以转发任何 TCP 连接并返回响应。

这是一项不平凡的任务，**除非**您正在做一些非常简单的事情。如果您不关心响应，或者您的过程是一个明确定义且简单的请求-响应过程，您可以立即编写代码。请记住，您是在 OSI 模型的第 4 层运行的，您下面没有太多架构可以让您的生活更轻松。

# c# - LINQ 检查 FirstOrDefault 是否为空并使用它

> ID：12096720
> 
> 赞同：1
> 
> 时间：2012-08-23T17:03:50.943
> 
> 标签：c#, linq, entity-framework

我正在编写一个在查询`FirstOrDefault`之后使用的`OrderBy`查询，它应该首先检查它是否不为空，然后在其中使用一些数据。有没有比这样写更好的方法：

```
int count = db.Items.Count(i => 
          i.Assignments.OrderByDescending(a => 
                a.DateAssigned).FirstOrDefault() != null
          && 
          i.Assignments.OrderByDescending(a =>
                a.DateAssigned).FirstOrDefault().DateReturned == null) 
```

这段代码的作用是有些项目有很多分配，我按日期获取最新的分配，然后检查它是否存在，然后对属性（`DateReturned`）运行条件。如您所见，此查询很长，我的大多数查询看起来像这样，我首先检查 null 然后使用它们的属性对其运行第二个查询。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T17:07:51.403

只需打电话`.Any(a => a.DateReturned == null)`检查是否有符合条件的物品。

如果您只想查看最新的作业，请`.Take(1)`在`.Any()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T17:12:06.040

我的看法：

```
int count = 
itemsQuery.Select(i => i.Assignments.OrderByDescending(a => a.DateAssigned))
          .Count(i => i.FirstOrDefault() != null &&  
                      i.First().DateReturned == null); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T17:13:53.357

您可以将结果放入变量中以避免重复执行相同的操作：

```
int count = itemsQuery.Count(i => {
  var f = i.Assignments.OrderByDescending(a => a.DateAssigned).FirstOrDefault();
  return f != null && f.DateReturned == null;
}); 
```

# wcf - RIA Services Intellisense 坏了？

> ID：12096724
> 
> 赞同：0
> 
> 时间：2012-08-23T17:03:58.877
> 
> 标签：wcf, entity-framework, ria

我是 RIA 服务的新手。我下载了一个名为 IssueVision 的示例应用程序，它在类库中具有服务器端元数据类，在 Silverlight 类库中具有这些类的客户端版本。

Silverlight 类库不（也不能）引用服务器端库，但它将类声明为“部分”并且项目编译良好。但是，Intellisense 无法识别部分关系，并且会在客户端代码文件中引发大量错误，例如“找不到类型或命名空间名称”等。

1.  这些部分类是如何工作的？当两个程序集都不引用另一个时，如何跨多个程序集声明部分类？

2.  如何修复对 RIA 服务的 Intellisense 支持？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T08:10:35.383

这是我想出的：

1.  部分类是使用项目属性页面中的 RIA 服务链接在客户端项目中创建的。它们就像 XAML .g.cs 生成的文件一样被隐藏。

2.  通过安装 RIA Services Toolkit，我似乎能够在我的家庭和工作 PC 上解决 Intellisense 错误。

# ios - 报亭注册推送通知问题

> ID：12096729
> 
> 赞同：1
> 
> 时间：2012-08-23T17:04:23.097
> 
> 标签：ios

我使用以下代码注册 Newsstand 应用程序的推送通知。

```
[application registerForRemoteNotificationTypes:UIRemoteNotificationTypeNewsstandContentAvailability]; 
```

它调用 didRegisterForRemoteNotificationsWithDeviceToken 并且我得到一个设备令牌。当我登录 enabledRemoteNotificationTypes 它返回 0 并且 didReceiveRemoteNotification 永远不会被调用。

如果我注册 UIRemoteNotificationTypeAlert enabledRemoteNotificationTypes 返回 4 并且我收到通知，它工作正常。

我在 plist 中添加了所需的背景模式。

有任何想法吗？

谢谢。

# javascript - 滚动到动态突出显示的表格行

> ID：12096730
> 
> 赞同：0
> 
> 时间：2012-08-23T17:04:23.953
> 
> 标签：javascript, scroll

当您到达当月的页面时，源代码中的 javascript 会突出显示代表今天的行。如何让页面自动向下滚动到该行？页面是[http://www.itsmyturnnow.com/HWC/BRP/08.htm](http://www.itsmyturnnow.com/HWC/BRP/08.htm)，我得到的脚本是源代码。谢谢。

```
var INTENDED_MONTH = 7 //August
// INTENDED_MONTH is zero-relative
now = new Date().getDate(),
rows = document.getElementById('scripture').rows;
if (new Date().getMonth() != INTENDED_MONTH) {
    // need a value here less than 1, or the box for the first of the month will be in Gold
    now = 0.5
};
for (var i = 0, rl = rows.length; i < rl; i++) {
    var cells = rows[i].childNodes;
    for (j = 0, cl = cells.length; j < cl; j++) {
        if (cells[j].nodeName == 'TD'
  && cells[j].firstChild.nodeValue != ''
  && cells[j].firstChild.nodeValue == now) {
            rows[i].style.backgroundColor = 'red' // 'ffff99' // '#ffd700' // TODAY - gold
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:21:28.953

在突出当前诗篇的函数中使用 JQuery：

```
var INTENDED_MONTH = 7 //August
// INTENDED_MONTH is zero-relative
now = new Date().getDate(),
rows = document.getElementById('scripture').rows;
if (new Date().getMonth() != INTENDED_MONTH) {
    // need a value here less than 1, or the box for the first of the month will be in Gold
    now = 0.5
};
for (var i = 0, rl = rows.length; i < rl; i++) {
    var cells = rows[i].childNodes;
    for (j = 0, cl = cells.length; j < cl; j++) {
        if (cells[j].nodeName == 'TD'
  && cells[j].firstChild.nodeValue != ''
  && cells[j].firstChild.nodeValue == now) {
            rows[i].style.backgroundColor = 'red' // 'ffff99' // '#ffd700' // TODAY - gold
            $('html,body').delay(1000).animate({scrollTop:rows[i].offsetTop}, 500);

        }

    }
} 
```

JSFiddle： http: [//jsfiddle.net/QT3v5/22/](http://jsfiddle.net/QT3v5/22/) ​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T02:26:16.820

以下代码不需要 jQuery。它将 ID 应用于当前行，以像素为单位计算行的位置，然后滚动到该位置。

```
var INTENDED_MONTH = 7 //August
// INTENDED_MONTH is zero-relative
now = new Date().getDate(),
rows = document.getElementById('scripture').rows;
if (new Date().getMonth() != INTENDED_MONTH) {
    // need a value here less than 1, or the box for the first of the month will be in Gold
    now = 0.5
};
for (var i = 0, rl = rows.length; i < rl; i++) {
    var cells = rows[i].childNodes;
    for (j = 0, cl = cells.length; j < cl; j++) {
        if (cells[j].nodeName == 'TD'
  && cells[j].firstChild.nodeValue != ''
  && cells[j].firstChild.nodeValue == now) {
            rows[i].style.backgroundColor = 'red' // 'ffff99' // '#ffd700' // TODAY - gold
            rows[i].setAttribute('id', 'currentRow');
            function findPos(obj) {
                var curtop = 0;
                if (obj.offsetParent) {
                    do {
                        curtop += obj.offsetTop;
                    } while (obj = obj.offsetParent);
                return [curtop];
                }
            }
            window.scroll(0,findPos(document.getElementById('currentRow')));
        }
    }
} 
```

它目前正在为我工​​作。

[演示](http://jsfiddle.net/54mhv/)

# javascript - jQuery Validator：运行时的自定义错误消息

> ID：12096732
> 
> 赞同：0
> 
> 时间：2012-08-23T17:04:25.053
> 
> 标签：javascript, jquery, validation

我正在尝试根据页面上其他位置设置的值获取自定义错误消息。我可以将该值合并到我的验证逻辑中，但我想不出改变消息的方法。因此，我在下面的示例中需要一种将“电话号码无效（接受国际格式）”更改为更合适的消息的方法，基于 dailing 代码。因此，如果拨号代码是“+1”，我希望消息是“电话号码无效（接受北美格式）”。

```
$(document).ready(function () {
    $.validator.addMethod("jqphone", function (value, element, params) {
        value = value.replace(/\s+/g, "");
        var ddlName = "ddl" + element.id.slice(element.id.lastIndexOf("___")+3);
        var dialingCode = getDialingCode($("#" + ddlName).val());

        if(dialingCode == "+1") {
            return this.optional(element) || (value.match(... for NA);
        } else if(dialingCode == "+61") { //-- AU 
            return this.optional(element) || value.match(... for AU);
        } else if(dialingCode == "+64") { //-- NZ
            return this.optional(element) || value.match(... for NZ);
        } else { //-- all the rest
            return this.optional(element) || value.match(... for the rest);
        }
     }, "Phone number is invalid (International format accepted)");
}); 
```

# php - NodeJS AMQP客户端无法连接

> ID：12096735
> 
> 赞同：3
> 
> 时间：2012-08-23T17:04:58.690
> 
> 标签：php, node.js, rabbitmq, amqp

最近两天我快疯了，我无法通过持久交换和持久队列在 NodeJS 客户端上建立连接。

所以 PHP 代码创建并发送消息：

```
<?php 
$connection = new AMQPConnection(array(
'host' => 'localhost',
'vhost' => 'bvh',
'port' => 5672,
'login' => 'bizneus',
'password' => 'lozinkus'
));
    //$connection = new AMQPConnection();
    $connection->connect();
    if (!$connection->isConnected()) {
        die('Not connected :(' . PHP_EOL);
    }
    // Open Channel
    $channel    = new AMQPChannel($connection);
    // Declare exchange
    $exchange   = new AMQPExchange($channel);
    $exchange->setName('biznea_e_1');       
    $exchange->setType('fanout');
    $exchange->setFlags(AMQP_DURABLE);

    $exchange->declare();
    // Create Queue
    $queue      = new AMQPQueue($channel);
    $queue->setName('notify');
    $queue->setFlags(AMQP_DURABLE);
    $queue->declare();

    $message    = $exchange->publish(json_encode($s), 'kljuc');
    if (!$message) {
        echo 'Message not sent', PHP_EOL;
    } else {
        echo 'Message sent!', PHP_EOL;
    }

    if ($connection->isConnected()) {
       $connection->disconnect();
    } 
```

屏幕上显示消息已发送。

接下来是 NodeJS 客户端，它应该获取消息，但它不能：

```
var amqp = require('amqp');

var conParam = { 
  host: 'localhost', 
  port: 5672,  
  login: 'bizneus',   
  password: 'lozinkus',    
  vhost: 'bvh'  
}
var connection = amqp.createConnection(conParam);
connection.on('ready', function(){

     var exchange = connection.exchange('biznea_e_1');
      var queue = connection.queue('notify');
      queue.bind('biznea_e_1', 'kljuc');

                queue.subscribe( {ack:true}, function(message){

                    var dj = JSON.parse(message.data.toString());

                    console.log(JSON.stringify(dj));

                    queue.shift();
            });
}); 
```

但我得到这个错误

```
events.js:66
        throw arguments[1]; // Unhandled 'error' event
                       ^
Error: PRECONDITION_FAILED - cannot redeclare exchange 'biznea_e_1' in vhost 'bvh' with different type, durable, internal or autodelete value
    at Exchange._onMethod (/home/zijad/node_modules/amqp/amqp.js:1824:15)
    at Exchange.Channel._onChannelMethod (/home/zijad/node_modules/amqp/amqp.js:1365:14)
    at Connection._onMethod (/home/zijad/node_modules/amqp/amqp.js:922:28)
    at AMQPParser.self.addListener.parser.onMethod (/home/zijad/node_modules/amqp/amqp.js:797:12)
    at AMQPParser._parseMethodFrame (/home/zijad/node_modules/amqp/amqp.js:442:10)
    at frameEnd (/home/zijad/node_modules/amqp/amqp.js:187:16)
    at frame (/home/zijad/node_modules/amqp/amqp.js:172:14)
    at AMQPParser.header [as parse] (/home/zijad/node_modules/amqp/amqp.js:159:14)
    at AMQPParser.execute (/home/zijad/node_modules/amqp/amqp.js:231:21)
    at Connection.<anonymous> (/home/zijad/node_modules/amqp/amqp.js:837:12) 
```

我试图删除 var exchange = connection.exchange('biznea_e_1'); 那条线，但它不能声明队列。

我只想将消息从 PHP 发送到 NodeJS 守护进程，仅此而已！

帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T18:05:36.710

试试这个：在 node.js 代码中，使用与 PHP 代码中完全相同的参数声明交换和*队列*。例如耐用。这可能会解决您的问题。

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-22T11:57:46.137

看起来您正试图在 node.js 代码中再次创建交换“biznea_e_1”。它已经由 php 代码创建。仅尝试订阅。

# ruby-on-rails-3 - Rails 奇怪：使用 twitter-bootstrap-rails 删除行为

> ID：12096738
> 
> 赞同：2
> 
> 时间：2012-08-23T17:05:12.067
> 
> 标签：ruby-on-rails-3, twitter-bootstrap

我遇到了奇怪的 :delete 链接方法行为问题。我配置了一个设计 sign_out 路由，该路由链接在一个下拉框中。单击该链接时，会导致路由错误（没有路由匹配 [GET] "/users/sign_out"）。

奇怪的是，当我将该链接复制到导航栏中的另一个位置时，它可以完美运行。

RoR 导航栏代码为：

```
<div class="container nav-collapse">
<ul class="nav">
  <li class="active">
    <%= link_to t('activeview.navigation.home'), home_index_path %>
  </li>
  <li>
    <%= link_to t('activeview.navigation.sign_in'), new_user_session_path %>
  </li>
  <li>
    <%= link_to t('activeview.navigation.sign_up'), new_user_registration_path %>
  </li>
  <li><%= link_to t('activeview.navigation.sign_out'), destroy_user_session_path, :method => :delete %></li>
  <li class="dropdown">
    <% if user_signed_in? %>
      <%= link_to (current_user.email + ' <span class="caret"></span>').html_safe, '#', {
        :class => 'dropdown-toggle',
        'data-toggle' => 'dropdown' } %>
      <ul class="dropdown-menu">
        <li><%= link_to t('activeview.navigation.settings'), edit_user_registration_path(current_user) %></li>
        <li class="divider"></li>
        <li><%= link_to t('activeview.navigation.sign_out'), destroy_user_session_path, :method => :delete %></li>
    <% else %>
      <%= link_to (t('activeview.navigation.not_connected') + ' <span class="caret"></span>').html_safe, '#', {
        :class => 'dropdown-toggle',
        'data-toggle' => 'dropdown' } %>
    <% end %>
    </ul>
  </li>
</ul>
</div><!--/.nav-collapse --> 
```

我的 application.js 如下所示：

```
//= require jquery
//= require jquery_ujs
//= require twitter/bootstrap
//= require_tree . 
```

下面是我的导航栏。案例是 sign_out_1 完美运行，但 sign_out_2 使用 GET 方法而不是 DELETE。

```
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
    <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    </a>
    <a class="brand" href="#">Brand</a>
    <div class="container nav-collapse">
    <ul class="nav">
      <li><a href="/users/sign_out" data-method="delete" rel="nofollow">sign_out_1</a></li>
      <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">mail@hotmail.com <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/users/edit.2">Configuración</a></li>
            <li class="divider"></li>
            <li><a href="/users/sign_out" data-method="delete" rel="nofollow">sign_out_2</a></li>
        </ul>
      </li>
    </ul>
    </div><!--/.nav-collapse -->
    </div>
  </div>
</div> 
```

我的销毁路线是：

```
destroy_user_session     DELETE /users/sign_out(.:format)    devise/sessions#destroy 
```

最后，.js 加载部分是：

```
<script src="/assets/jquery.js?body=1" type="text/javascript"></script>
<script src="/assets/jquery_ujs.js?body=1" type="text/javascript"></script>
<script src="/assets/twitter/bootstrap/bootstrap-transition.js?body=1" type="text/javascript"></script>
<script src="/assets/twitter/bootstrap/bootstrap-alert.js?body=1" type="text/javascript"></script>
<script src="/assets/twitter/bootstrap/bootstrap-modal.js?body=1" type="text/javascript"></script>
<script src="/assets/twitter/bootstrap/bootstrap-dropdown.js?body=1" type="text/javascript"></script>
<script src="/assets/twitter/bootstrap/bootstrap-scrollspy.js?body=1" type="text/javascript"></script>
<script src="/assets/twitter/bootstrap/bootstrap-tab.js?body=1" type="text/javascript"></script>
<script src="/assets/twitter/bootstrap/bootstrap-tooltip.js?body=1" type="text/javascript"></script>
<script src="/assets/twitter/bootstrap/bootstrap-popover.js?body=1" type="text/javascript"></script>
<script src="/assets/twitter/bootstrap/bootstrap-button.js?body=1" type="text/javascript"></script>
<script src="/assets/twitter/bootstrap/bootstrap-collapse.js?body=1" type="text/javascript"></script>
<script src="/assets/twitter/bootstrap/bootstrap-carousel.js?body=1" type="text/javascript"></script>
<script src="/assets/twitter/bootstrap/bootstrap-typeahead.js?body=1" type="text/javascript"></script>
<script src="/assets/twitter/bootstrap/bootstrap-affix.js?body=1" type="text/javascript"></script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T11:27:41.530

一个快速的解决方法是在 ./config/initializers/devise.rb 中将 sign_out 更改为使用 HTTP GET 而不是 HTTP DELETE

```
# The default HTTP method used to sign out a resource. Default is :delete.
config.sign_out_via = :get 
```

然后更改对 sign_out 的调用以发送 GET：

```
<%= link_to t('activeview.navigation.sign_out'), destroy_user_session_path, :method => :get %></li> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T08:47:58.250

这是twitter bootstrap的js bug，在[https://github.com/twitter/bootstrap/commit/3568146b28e3eb22e4347062b1e4f923f87daeb8修复](https://github.com/twitter/bootstrap/commit/3568146b28e3eb22e4347062b1e4f923f87daeb8)

另见[https://github.com/trimentor/foundation/commit/f5ab92cdcc536032f7f6bd7abf991efc92781005](https://github.com/trimentor/foundation/commit/f5ab92cdcc536032f7f6bd7abf991efc92781005)

# asp.net-mvc - IIS 7.5。无法禁用 URL 重写规则（我删除了规则，但它们仍然影响）

> ID：12096749
> 
> 赞同：5
> 
> 时间：2012-08-23T17:05:40.523
> 
> 标签：asp.net-mvc, iis

我开发 ASP.NET MVC 3 应用程序。我已经下载了 UrlRewriting 模块并在本地为我的网站创建了一些规​​则。接下来我在互联网上发布了这个网站来检查性能。没关系。然后我再次在本地继续我的工作。我在 web.config 文件中评论了有关这些规则的代码块。所以 IIS 管理器中也没有规则。问题是规则仍然有影响！例如，我定义了“规范主机名规则”以将浏览器重定向到“www.*”站点名称。所以这个规则仍然有影响，即本地 IIS 服务器将我本地运行的网站重定向到 Internet 上的真实网站。我也安装了 IIS Express 来尝试一下。结果是一样的。我无法弄清楚问题出在哪里。因此，在 IIS 服务器和 IIS Express 上没有重写规则，但它们仍然有影响。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-03-20T14:02:50.577

迟到的答案是迟到的。重定向很可能是“永久”的，因此是 301，然后它将被缓存在浏览器中。如果您希望它使用代码 307 进行临时重定向。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T17:50:44.607

当配置更改时，URL Rewrite 模块与我的一个小问题接缝，因为加载的配置在 IIS 未重新启动之前不会刷新。

# xcode - Xcode 3.2.6 和 Xcode 4 的代码相同但结果不同

> ID：12096750
> 
> 赞同：0
> 
> 时间：2012-08-23T17:05:41.267
> 
> 标签：xcode, search, header

使用 Xcode 3.26 和 SDK 4.3 进行编译，我有一个带有搜索字段的表格，在该表格下方有一个在搜索后出现的部分标题。表明它是一个搜索表。标题是绿色的，只是说“结果”。如果不搜索它是不可见的。

现在使用 Xcode 4.1.1 和 SDK 5.1 编译相同的代码，搜索后标题的工作方式相同，但即使不搜索也始终可见。变为灰色并一直漂浮在导航栏下方的表格顶部。

我能做些什么呢？更喜欢以前的样子。

代码是这样的。

```
 -(UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:    (NSInteger)section{if(tableView == self.searchDisplayController.searchResultsTableView)
{   UILabel *tempHeaderLabel=[[UILabel  alloc]initWithFrame:CGRectMake(0,0,320,30)];
    tempHeaderLabel.backgroundColor=[UIColor colorWithRed:67.0/255.0 green:126.0/255.0 blue:71.0/255.0 alpha:1.0];
    tempHeaderLabel.textColor=[UIColor colorWithRed:227.0/255.0 green:227.0/255.0 blue:227.0/255.0 alpha:1.0];
    tempHeaderLabel.font = [UIFont fontWithName:@"Georgia-BoldItalic" size:16];
    tempHeaderLabel.text=@"                          Result";

    return tempHeaderLabel;
}
else

    return nil; 
```

}

# gwt - 将外部图像添加到自定义 GWT 单元

> ID：12096752
> 
> 赞同：2
> 
> 时间：2012-08-23T17:05:50.110
> 
> 标签：gwt, uibinder

我正在为一个单元格列表创建一个自定义单元格，该单元格显示产品信息，包括一个图像和几个文本字段，类似于 CellList 示例中的那个。这些图像不是与我的应用程序一起打包的资源，它们位于外部图像服务器上。我想将 UiBinder 用于单元格的布局。最终单元格会变得更加复杂，但现在这里是我的模板，它只显示产品描述和图像：

```
<ui:UiBinder
  xmlns:ui="urn:ui:com.google.gwt.uibinder"
  xmlns:g="urn:import:com.google.gwt.user.client.ui">

<ui:style>
</ui:style>

<ui:with field="imageSource" type="java.lang.String"/>
<ui:with field="product" type="com.mydomain.ProductProxy" />

<div ui:field="root">
  <span><ui:text from="{product.getDescription}" /></span>
  <ui:image url="{imageSource}" />
</div> 
```

CellList 显示描述列表，但没有产品。如果我用 Chrome 检查元素，我可以看到 ui:image 没有被编译成 img 元素：

```
<div onclick="" __idx="0" class="GPROKKBAB" style="outline:none;" tabindex="0">
<div gwtuirendered="gwt-uid-17">
    <span>E03351 </span> 
    <ui:image url="http://images.mydomain.com/image/product_id.jpg"></ui:image>                        </div></div> 
```

有什么建议么？我确信这很明显，但我已经做了一段时间了，我尝试了很多没有运气的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:44:12.667

简单地使用 HTML`img`怎么样？

```
<img src="{imageSource}" /> 
```

# android - 合并叠加层以在 MKMapView (iOS) 或 MapView (android) 上显示

> ID：12096756
> 
> 赞同：0
> 
> 时间：2012-08-23T17:05:58.913
> 
> 标签：android, ios, google-maps, mkmapview, android-mapview

我正在创建一个将图像覆盖在谷歌地图上的移动应用程序。

我有大量的图像叠加层（KML 语言中的“GroundOverlay”对象）。滚动或缩放地图时遇到了几个问题（主要是性能）

尝试了几个选项后，我认为我的下一个方法是预先将所有图像叠加层组合成一个图像，然后将该图像简单地显示为地图上的单个叠加层。问题是，我不知道从哪里开始。

有没有人有组合叠加图像的经验？

我认为有两个问题需要解决 1）计算将包含最终图像的较大的“边界框”。我有每个叠加层的边界框（KML 语言中的“LatLngBox”），我认为可以通过简单地检查每个 LatLngBox 的值并根据最小/最大值生成最终框来计算最终框。任何人都知道这是否可行？

2) 将所有叠加图像合并为一个最终图像。我不知道从哪里开始，比如这里。生成实际图像不是问题，而是每个叠加层（即像素级别）的放置位置，以便生成的图像准确。

任何提示/提示将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:21:42.590

静态叠加图像可以组合和绘制。但是，如果您仍然想将它们合并并作为一个发布，那么移动（定期更新）的叠加图像将是一个问题。我认为最好的选择是结合静态覆盖资源并将它们保存在一组中，而其他动态图像则分开绘制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T18:40:59.757

我自己设法解决了这个问题。

对 (1) 的回答：我在问题中概述的技术非常有效 对 (2) 的回答：您可以在图像的 lat/lng 和 x/y 像素之间进行转换，如下所述：[将 Lat/Longs 转换为 X/Y Co-纵坐标](https://stackoverflow.com/questions/4953150/convert-lat-longs-to-x-y-co-ordinates?rq=1)

# php - 如何使用授权帐户重新绑定到 LDAP？

> ID：12096758
> 
> 赞同：0
> 
> 时间：2012-08-23T17:06:05.543
> 
> 标签：php, authentication, ldap

我正在为一所大学做一个项目。大学要求所有使用登录名/信息都存储在 LDAP 中并通过 PHP 检索。通常我只会将 LDAP 连接与用户输入的凭据绑定（因此个人用户的用户名和密码），但是现在我需要使用 LDAP 验证他们的用户名/密码，然后使用“授权帐户”重新绑定连接" 部门提供的用户名和密码，然后从经过身份验证的帐户执行 LDAP 搜索。

基本上我需要使用用户的登录名/密码来确保它们存在于 LDAP 中。如果是，那么我们必须切换到不同的帐户用户名/密码来执行用户信息的 LDAP 搜索。

我该怎么做？我不知道如何以这种方式重新绑定，但仍然对用户执行正确的搜索。

**编辑：重新绑定 LDAP 帐户是否像在第一个绑定语句之后包含第二个绑定语句一样简单？前任;**

```
if (!($bind=@ldap_bind($connect, "uid=".$username.",ou=*****,dc=***,dc=edu", "$password")))
{
    ldap_close($connect);
    echo "there was an error binding your LDAP account.";
}
else // else we have binded to the ldap connection as the user, we must re-bind as the authorized account
{
    if (!($bind=@ldap_bind($connect, "uid=".$authUN.",ou=******,dc=***,dc=edu", "$authPW")))
    {
            ldap_close($connect);
            echo "There was a problem binding to the authorized account.";
    }
    else // now we have binded with the authenticated account
    {
        echo "success!";
    }
} 
```

..然后我会通过正常执行搜索`ldap_search()`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:06:47.907

*   没有“重新绑定”之类的东西。只有 BIND
*   连接以匿名身份验证状态开始
*   每个 BIND 请求都会将连接状态重置为匿名状态
*   每个成功的 BIND 都将连接状态设置为与身份验证 ID 关联的授权状态
*   失败的 BIND 请求导致连接保持匿名状态

BIND 的语义在[RFC4513](https://www.rfc-editor.org/rfc/rfc4513)中有完整的描述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:17:33.513

为什么不直接用授权账户搜索用户信息，如果存在则返回，如果不直接忽略呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-13T17:42:06.753

我对这些答案中的任何一个都不满意。可以在同一连接上重新绑定，但它仍然是 BIND。python-ldap3 模块有一个专门用于此的方法，称为“重新绑定”。此外，在校园或公司环境中，通常需要（如我的情况）首先通过管理员凭据绑定，然后重新绑定或再次绑定以使用提供的用户凭据对用户进行身份验证。

# vb.net - 在 VB.Net 中使用 OpenXML 修改单元格

> ID：12096760
> 
> 赞同：2
> 
> 时间：2012-08-23T17:06:07.207
> 
> 标签：vb.net, excel, ssis, openxml

我不知道为什么我很难为这个简单的任务找到示例，但是根据我的 Google-Fu 技能，没有任何显示。我正在寻找使用 OpenXML 和 VB.Net 修改现有电子表格单元格的示例。

我想将现有值更改为新值，不涉及任何公式。

这是我所拥有的：

```
Public Sub Main()
    Dim strSource, strSheetName As String
    Dim dtPeriod As DateTime

    strSource = Dts.Variables("sFilePath").Value

    'set period to previous month. We only care about the year in this period as the data will be reloaded
    'from the file each month
    dtPeriod = DateAdd(DateInterval.Month, -1, Today)
    Dts.Variables("dtPeriod").Value = dtPeriod

    Using mySpreadSheet As SpreadsheetDocument = SpreadsheetDocument.Open(strSource, True)
        Dim WorkbookSheets As Sheets

        WorkbookSheets = mySpreadSheet.WorkbookPart.Workbook.GetFirstChild(Of Sheets)()

        For Each childSheet As Sheet In WorkbookSheets
            strSheetName = childSheet.Name
            strSheetName = strSheetName.ToLower.Trim

            If strSheetName = "sheet1" Then     'process sheet

                SetCellValue("A1", "Last Name")
                SetCellValue("B1", "First Name")
                SetCellValue("C1", "RegionID")
                SetCellValue("D1", "RegionName")

                'rename sheet for loading
                childSheet.Name = "RegionData"
            End If
        Next

        mySpreadSheet.WorkbookPart.Workbook.Save()
        mySpreadSheet.Close()
    End Using
End Sub

Private Sub SetCellValue(ByVal loc As String, ByVal Val As String)
    Dim cell As Cell = New Cell

    cell.CellReference = loc
    cell.DataType = CellValues.String
    cell.CellValue = New CellValue(Val)

End Sub 
```

我确信这很简单，例如确保单元格引用正确的工作表，但我发现的所有示例都是用于创建新工作表。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T15:08:52.163

这是我如何让它工作的：

```
Private Sub ProcessFile(ByVal fileName As String)
    Dim value As String = Nothing
    Dim worksheetID As String 

    Using document As SpreadsheetDocument = SpreadsheetDocument.Open(fileName, True)
        worksheetID = GetWorksheetID(document)

        If worksheetID = String.Empty Then
            MsgBox("Failure!")
        End If

        SetStrCellValue(document, worksheetID, 1, 1, "Last Name")

        document.WorkbookPart.Workbook.Save()
        document.Close()

    End Using
End Sub

Private Overloads Function GetWorksheetID(ByRef document As SpreadsheetDocument) As String 
    Dim sSheetName As String
    Dim sheetID As String = String.Empty
    Dim WorkbookSheets As Sheets = document.WorkbookPart.Workbook.GetFirstChild(Of Sheets)()

    For Each childSheet As Sheet In WorkbookSheets
        sSheetName = childSheet.Name
        sSheetName = sSheetName.ToLower.Trim

        'rename worksheet
        If sSheetName = "sheet1" Then
            childSheet.Name = "MySheet"

            sheetID = childSheet.Id
        End If
    Next

    Return sheetID
End Function

Private Overloads Sub SetStrCellValue(ByRef document As SpreadsheetDocument, ByVal sheetID As String, ByVal iRow As Integer, ByVal col As Integer, ByVal newCellValue As String)
    Dim Location As String = GetColumnLetter(col) & iRow.ToString

    SetStrCellValue(document, sheetID, Location, newCellValue)
End Sub

Private Overloads Sub SetStrCellValue(ByRef document As SpreadsheetDocument, ByVal sheetID As String, ByVal location As String, ByVal newCellValue As String)
    Dim wsPart As WorksheetPart = CType(document.WorkbookPart.GetPartById(sheetID), WorksheetPart)
    Dim Cell As Cell = wsPart.Worksheet.Descendants(Of Cell).Where(Function(c) c.CellReference = location).FirstOrDefault

    Cell.CellValue = New CellValue(newCellValue.ToString)
    Cell.DataType = CellValues.String
End Sub

'Returns column letter based on the column number
Private Function GetColumnLetter(ByVal colNumber As Integer) As String
    Dim columnLetter As String = String.Empty
    Dim abc As String = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"

    If colNumber > 26 Then
        columnLetter = abc.Substring(CInt(colNumber / 26) - 1, 1)
    End If

    columnLetter += abc.Substring(((colNumber - 1) Mod 26), 1)

    Return columnLetter
End Function 
```

# python-2.7 - 使用 Python 中的 Net-SNMP 和 snmpV3 访问交换机数据

> ID：12096763
> 
> 赞同：1
> 
> 时间：2012-08-23T17:06:17.270
> 
> 标签：python-2.7, net-snmp

我试图在 python 中使用 net-snmp 制作一个 snmpV3 管理器 porgram，代码是

```
#!/usr/bin/env python
import netsnmp 

session = netsnmp.Session(DestHost='192.168.1.1', Version=3, SecLevel='authNoPriv',         AuthProto='MD5', AuthPass='password', SecName='user')
vars = netsnmp.VarList(netsnmp.Varbind('ifDescr'))
result = session.get(vars)

print result 
```

但结果是一个元组（无，）

谁能帮我解决这个问题？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T15:01:56.380

我找到了解决我的问题的方法。SNMPv3 的 Python 绑定可用于 net-snmp 5.7.1。安装它然后转到`python/`目录并执行以下命令：

```
python setup.py build
python setup.py install (as a root user) 
```

# c# - 从模板构建 Word 文档

> ID：12096764
> 
> 赞同：1
> 
> 时间：2012-08-23T17:06:20.827
> 
> 标签：c#, ms-word, openxml

我请求根据提供给我的模板即时创建 Word 文档。我做了一些研究，一切似乎都指向 OpenXML。我已经调查过了，但是创建的 cs 文件超过 15k 行并且正在破坏我的 VS 2010（导致它在我每次进行更改时都没有响应）。

我一直在看这个关于 Open XML 的教程系列 [http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2011/10/13/getting-started-with-open-xml-development.aspx](http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2011/10/13/getting-started-with-open-xml-development.aspx)

过去我用文本文件和正则表达式做过一些事情，但是由于 Word 加密了所有内容，这不起作用。是否有任何其他相当轻量级的选项可用于从模板创建 word 文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T14:56:28.323

//嗨，这很简单。

```
 //First, you should copy your Template file into another location.
            string SourcePath = "C:\\MyTemplate.dotx";
            string DestPath = "C:\\MyDocument.docx";
            System.IO.File.Copy(SourcePath, DestPath);

            //After copying the file, you can open a WordprocessingDocument using your Destination Path.

            WordprocessingDocument Mydoc = WordprocessingDocument.Open(DestPath, true);

            //After openning your document, you can change type of your document after adding additional parts into your document.
            mydoc.ChangeDocumentType(WordprocessingDocumentType.Document);

            //If you wish, you can edit your document 
            AttachedTemplate attachedTemplate1 = new AttachedTemplate() { Id = "MyRelationID" };

            MainDocumentPart mainPart = mydoc.MainDocumentPart;
            MySettingsPart = mainPart.DocumentSettingsPart;

            MySettingsPart.Settings.Append(attachedTemplate1);

            MySettingsPart.AddExternalRelationship("http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate", new Uri(CopyPath, UriKind.Absolute), "MyRelationID");

            //Finally you can save your document.
            mainPart.Document.Save(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T21:12:25.483

我目前正在从事这些方面的工作，并且一直在使用[Open XML SDK](http://www.microsoft.com/en-us/download/details.aspx?id=5124)和[OpenXmlPowerTools](http://powertools.codeplex.com/)所采取的方法是将实际模板文件打开并将文本放入模板文档中的各种占位符中。我一直在使用内容控件作为位置标记。

用于打开文档的 SDK 工具在比较文档并查看其构造方式方面非常宝贵。但是，从该工具生成的代码我一直在大量重构并删除根本不使用的部分。

我不能谈论 doc 文件，但是对于 docx 文件，它们没有加密，它们只是包含 xml 文件的 zip 文件

[Eric White 的博客](http://blogs.msdn.com/b/ericwhite/)有大量非常有用的示例和代码示例

# actionscript-3 - 从相机获取图片（使用 Adob e Flash？）

> ID：12096766
> 
> 赞同：0
> 
> 时间：2012-08-23T17:06:30.310
> 
> 标签：actionscript-3, flash, browser, actionscript, camera

我想知道是否有人知道任何用于从相机获取所有图片的 Adob​​e Flash 解决方案，以便我可以自动将它们上传到我的网站（当他们访问我的网页时）。

最好这一切都在网络浏览器中，但我不确定这是否可能。如果不是，有没有好的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:38:08.033

您可以使用 AIR 或生成桌面/移动软件的 MDM Zinc 之类的闪存扩展器来做到这一点。但是出于非常好的安全原因，您不能使用网络上的 flash 来执行此操作。但是，您可以以正确的方式打开 FileReference 框并让用户选择要给您的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T23:20:17.293

实际上，从桌面网络摄像头做这样的事情是没有问题的。

您必须请求使用相机的权限，并且用户将看到一个对话框，指示该站点希望使用相机，但只要他们接受，您就可以从相机中抓取图像。

首先，您需要初始化并连接相机

```
var cam:Camera = Camera.getCamera();
var video:Video = new Video(320,240);
video.attachCamera(cam);
addChild(video); 
```

然后你需要创建一个位图数据对象：

```
var bitmapData:BitmapData = new BitmapData(video.width,video.height); 
```

然后，当您需要捕获相机时，您可以使用绘图功能：

```
bitmapData.draw(video); 
```

我建议您从[as3corelib](https://github.com/mikechambers/as3corelib)中获取 jpg 编码器，以便将其编码为 jpg，然后将其发送到您的服务器。通过使用[UploadPostHelper](http://marstonstudio.com/2007/10/19/how-to-take-a-snapshot-of-a-flash-movie-and-automatically-upload-the-jpg-to-a-server-in-three-easy-steps/) ，上传过程变得更加容易，这是一个创建多部分数据表单的好类：

```
ByteArray byteArray = JPGEncoder.encode( bitmapData );

var urlRequest : URLRequest = new URLRequest();
urlRequest.url = 'http://your.server.com/destination';
urlRequest.contentType = 'multipart/form-data; boundary=' + UploadPostHelper.getBoundary();
urlRequest.method = URLRequestMethod.POST;
urlRequest.data = UploadPostHelper.getPostData( 'image.jpg', byteArray );
urlRequest.requestHeaders.push( new URLRequestHeader( 'Cache-Control', 'no-cache' ) );

// create the image loader & send the image to the server;
var urlLoader : URLLoader = new URLLoader();
urlLoader.dataFormat = URLLoaderDataFormat.BINARY;
urlLoader.load( urlRequest ); 
```

当然，您可以收听完整的事件并从您的服务器传回任何信息。希望有帮助。

# solr - 我如何向 Solr 询问一个为空或具有不同值的字段

> ID：12096768
> 
> 赞同：0
> 
> 时间：2012-08-23T17:06:38.227
> 
> 标签：solr, lucene

我需要获取字段“状态”为空或值为“活动”的所有文档

我试过了

```
status:active OR (NOT status:*)
status:active OR (NOT status:[* TO *])
status:(active OR NOT *) 
```

所有这些变体都不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:12:41.883

试试这个

```
-status:[* TO *] OR status:active 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T06:34:08.290

尝试以下查询。

```
-(status:['' TO *] OR -status:active) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-26T08:54:49.367

这应该可以解决问题（参考[https://stackoverflow.com/a/35633038/13365](https://stackoverflow.com/a/35633038/13365)）：

```
status:active OR (*:* NOT status:["" TO *]) 
```

我从来没有让这些`-status`版本工作。

# php - sql server 2008查询php

> ID：12096769
> 
> 赞同：0
> 
> 时间：2012-08-23T17:06:42.930
> 
> 标签：php, sql-server-2008

```
<?php
    $serverName = "brandobti";
    $usr="sl";
    $pwd="";
    $db="SimpleLabel";

    $connectionInfo = array("UID" => $usr, "PWD" => $pwd, "Database" => $db);

    $conn = sqlsrv_connect($serverName, $connectionInfo);
    if($conn === false)
    {
        die(print_r(sqlsrv_errors(), true));
    }

    $sql="update products set Nr_Label=0";

    $query=sqlsrv_query($conn, $sql);
    $result=sqlsrv_fetch_array($query);
    print_r($result); 
    sqlsrv_close( $conn); 
```

我试图弄清楚我在这段代码中做错了什么。我知道连接工作正常；我找到了一个脚本并对其进行了测试。

当我加载 PHP 页面时，它什么都不做。

```
<?php
$serverName = "brandobti";
$usr="sl";
$pwd="";
$db="SimpleLabel";

$connectionInfo = array("UID" => $usr, "PWD" => $pwd, "Database" => $db);

$conn = sqlsrv_connect($serverName, $connectionInfo);
if ($conn === false)

{

print_r( sqlsrv_errors());

}

$sql="Update products set Nr_Labels=0";

$query = sqlsrv_query($conn, $sql) or die(sqlsrv_errors());
$result=sqlsrv_fetch_array($query);
print_r($result); 
sqlsrv_close( $conn);
?> 
```

这是任何遇到麻烦的人的完整和工作代码，比如我正在让 sql 连接，感谢 marc b，因为我一直试图让这个工作一整天的搜索表单，所以我希望其他搜索的人可以使用这个

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:08:52.470

您假设查询成功，并且没有任何错误处理。如果这些 DB 调用中的任何一个有问题，它们通常会返回 false：

```
$query = sqlsrv_query($conn, $sql) or die(sqlsrv_errors());
                                   ^^^^^^^^^^^^^^^^^^^^^^^^--- add this 
```

# jpa - 查询数据表 jsf2 和 primefaces 中其他颜色未读取的行的颜色

> ID：12096772
> 
> 赞同：1
> 
> 时间：2012-08-23T17:06:54.787
> 
> 标签：jpa, jsf-2, datatable, primefaces

我有这个方法可以返回一个加载我的数据表的列表：

```
public List<Message> getMessagesRecues(Integer idUser) {
    List<Message> cs = null;
    try {

        org.hibernate.Transaction tx = session.beginTransaction();
        System.out.println("alors : "+idUser);
        Query q = session.createQuery("select c.message from Destinataire c where c.utilisateur.id='"+idUser+"'");

        if(q.list().size() > 0)
        cs = q.list();

        session.clear();
        session.flush();
    } catch (Exception e) {

        e.printStackTrace();

    }
    return cs;
} 
```

这种方法在数据库中效果很好，表是这样的：![数据库中的表](../Images/86428dc0ef16e83c5d0ebcb82bc9262d.png)

我使用netbeans和hibernate，我的目标是我想用红色为具有c.lu = false的行着色或将文字以粗体显示，但我不知道如何从数据库中获取信息并加载在数据表中（我使用 jsf2 和 primefaces）

这是我的数据表：

```
 <p:dataTable id="carsTables" var="car1" value="#{histMessagesController.lm_r}" rowKey="#{car.id}"  rowStyleClass="#{(car.lu == false) ? 'red' : null}"   >

                                <f:facet name="header">
                                    Historique des messages recus
                                </f:facet>

                                <p:column style="width:48%">
                                    <f:facet name="header">
                                        Titre
                                    </f:facet>
                                    <h:outputText value="#{car1.titre}" escape="false" />
                                </p:column>

                                <p:column style="width:48%">
                                    <f:facet name="header">
                                        Date de Création
                                    </f:facet>
                                    <h:outputText value="#{car1.dateEnvoi}" />
                                </p:column>

                                <p:column >                              
                                    <p:commandButton id="selectButton" update=":myform:carDlg" oncomplete="carDialog.show()" icon="ui-icon-search" title="View">  
                                        <f:setPropertyActionListener value="#{car1}" target="#{histMessagesController.selectedMessage}" />  
                                    </p:commandButton>                              
                                </p:column>  

                            </p:dataTable> 
```

我怎么能做到这一点，非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T02:31:00.567

尝试在数据表上设置`rowStyleClass`属性的结果以解析为字符串结果而不是布尔值`rowStyleClass=#{car1.lu}`，然后在单独的 css 样式表中有 `.true td:nth-child(1) input { background-color: green; }

.false td:nth-child(1) 输入 { 背景颜色：红色；}`

见[https://stackoverflow.com/a/11743258/1530938](https://stackoverflow.com/a/11743258/1530938)

为了更清楚

# c++ - switch 语句中的本地范围 - 我们在哪里中断？

> ID：12096773
> 
> 赞同：7
> 
> 时间：2012-08-23T17:06:56.380
> 
> 标签：c++, switch-statement

> **可能重复：**
> [在 switch-case 中使用花括号时的“break”语句](https://stackoverflow.com/questions/7374486/break-statement-when-using-curly-braces-in-switch-case)

在合并一个包时，我遇到了这个声明

```
switch (a)
{

case 1:
    {
        string str = "a is 1";
        cout << str << endl;
    }
    break;
case 2: ...
...

} 
```

我的问题是，在案例 1 中，我将中断放在范围内还是范围外是否重要？ [他们放在](http://msdn.microsoft.com/en-us/library/aa278223(v=vs.60).aspx)外面。我试过[这个](http://ideone.com/Tfp0c)，没有看到任何区别。对我来说没有区别是有道理的，但是我团队的博士说他记得可能有区别，但他不记得那是什么了..

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-23T17:08:32.327

将中断放在范围内还是范围外都没有区别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T17:11:52.310

块内的`break`到达`switch`会导致执行该块外的下一条语句`switch`。因此，无论您将 放置`break`在范围内还是范围外都没有关系。

# php - PEAR 电子表格 Excel Writer 的文件大小问题？

> ID：12096779
> 
> 赞同：0
> 
> 时间：2012-08-23T17:07:38.660
> 
> 标签：php, excel, pear

我有这个代码：

```
$book = new Spreadsheet_Excel_Writer();
$book->send('book.xls');
$report =& $book->addWorksheet('sheet');

$i = 0; 
while ($i<145){
    $report->write($i, 0, 'dsbajk_'.$i);
    $i++;
}

$book->close(); 
```

这会生成一个 6 KB 的文件，但是当我尝试在 Excel 中打开它时，文件出现错误，例如： Excel 发现无法读取的内容，并且可能丢失了某些数据。（我无法写出确切的信息，因为是西班牙语）。

如果我在循环中将 145 更改为 144（或更少），则不会显示任何消息，所以我认为是缓冲区或文本大小的问题。我需要用带有更多数据的 db 查询替换 while 循环，所以这很重要。

我在其他服务器上试过这个，我没有这个问题，所以可能是配置的问题。

我感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T18:24:52.213

正如 Marc B 所说，如果您开始一个新项目，切换到 PHPExcel 是一个不错的决定。它支持 xlsx 和其他现代格式以及传统的 xls。它还具有更多选项，并且易于安装和使用。

我在我的项目中使用了 PHPExcel，我很高兴。:)

# python - 自定义模板过滤器不起作用

> ID：12096780
> 
> 赞同：2
> 
> 时间：2012-08-23T17:07:40.360
> 
> 标签：python, django, django-templates, django-template-filters

# 视图.py

```
from django import template
register = template.Library()

@register.filter
def truncatesmart(value, limit=80):
    """
    Truncates a string after a given number of chars keeping whole words.

    Usage:
        {{ string|truncatesmart }}
        {{ string|truncatesmart:50 }}
    """

    try:
        limit = int(limit)
    # invalid literal for int()
    except ValueError:
        # Fail silently.
        return value

    # Make sure it's unicode
    value = unicode(value)

    # Return the string itself if length is smaller or equal to the limit
    if len(value) <= limit:
        return value

    # Cut the string
    value = value[:limit]

    # Break into words and remove the last
    words = value.split(' ')[:-1]

    # Join the words and return
    return ' '.join(words) + '...' 
```

# html

```
{% block content %}

<div class="container-fluid">
    <div class="container" id="content">
        <div class="span3">
            <div class="dashboard">
                <div class="well smooth-edge2 shadow">
                    <div class="mini-info">
                        <div class="username">
                            <h2 class="text-center">{{rest.name|truncatesmart}}</h2>

{% endblock %} 
```

# 错误

```
TemplateSyntaxError at /rprofile/info
Invalid filter: 'truncatesmart' 
```

# 怀疑

我无法理解为什么这个自定义过滤器不起作用。虽然所有其他预定义过滤器（如标题）都在工作，但此自定义过滤器根本不起作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T17:17:42.420

根据[文档](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#code-layout)：

> 例如，如果您的自定义标签/过滤器位于名为 poll_extras.py 的文件中，您的应用布局可能如下所示：

```
polls/
    models.py
    templatetags/
        __init__.py
        poll_extras.py
    views.py 
```

* * *

你已经在views.py 中定义了你的模板过滤器。它应该在那里：

```
yourapp/templatetags/__init__.py
yourapp/templatetags/yourapp_tags.py 
```

**首先**，创建`yourapp/templatetags/`文件夹和`yourapp/templatetags/__init__.py`空文件。将您的模板标签定义放在该文件夹中的 yourapp_tags.py 中。

* * *

> 在您的模板中，您将使用以下内容：

```
{% load poll_extras %} 
```

* * *

**最后**，在您的模板中，输入 {% load yourapp_tags %} 以启用模板标签。

# c - 是否有适用于 char * bufs 而不是文件描述符的 readv / writev 等效项？

> ID：12096786
> 
> 赞同：0
> 
> 时间：2012-08-23T17:07:58.367
> 
> 标签：c

是否有适用于 char * bufs 而不是文件描述符的 readv / writev 等效项？

例如，如果我有一个 char * buf[] 数组，并且我想将其全部复制到一个 char buf * 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:21:07.467

试试这个：

```
for (i=0; i<cnt; dest+=iov[i++].iov_len)
    memcpy(dest, iov[i].iov_base, iov[i].iov_len); 
```

C 不是一种充满用于简单单语句体 for 循环的库函数的语言。

# mysql - 为什么要使用外键而不执行删除或更新操作

> ID：12096790
> 
> 赞同：27
> 
> 时间：2012-08-23T17:08:13.297
> 
> 标签：mysql, innodb, myisam, mysql, foreign-keys, innodb, myisam

我有一个感兴趣的问题：

我在[mysql](/questions/tagged/mysql "显示标记为“mysql”的问题")中有2 个表`InnoDb`。
表`tbl_a`有一个主键，名为`a_id`;
表`tbl_b`有一个主`b_id`键和一个外键，`tbl_a.a_id`带有“ `ON DELETE NO ACTION`”。

```
+-------------+---------------+---------------+
|  Table Name |  Primary Key  |  Foreign Key  |
+-------------+---------------+---------------+
|    tbl_a    |     a_id      |               |
|    tbl_b    |     b_id      |     a_id      |
+-------------+---------------+---------------+ 
```

如果我最终没有真正使用外键的魔力，我为什么还要使用 InnoDb 和外键？
使用
*[innodb](/questions/tagged/innodb "显示标记为“innodb”的问题")和外键*
代替
*[myisam](/questions/tagged/myisam "显示标记为“myisam”的问题")和没有外键*是否还有意义。
如果我只是`NO ACTION`对删除或更新执行“”？

我希望你能得到我的兴趣点:)

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-08-23T17:14:03.327

我想你误解了什么`ON DELETE NO ACTION`意思。这并不*意味着*抑制外键约束。

当您删除由外键引用的记录时，InnoDB 能够采取自动操作来纠正这种情况：

*   它可以`CASCADE`，意思是，删除引用记录。（这对于类似的东西是有意义的`user_address.user_id`。如果你硬删除一个用户，你可能也想硬删除所有用户的地址。）
*   它可以`SET NULL`，意思是，清除引用键。（这可能对类似`file.last_modified_by`.

如果您指定`NO ACTION`，则您是在告诉 InnoDB 您不希望它采取这些操作中的任何一个。所以 InnoDB 无法为你解决问题；它所能做的就是拒绝`DELETE`并返回错误。

结果，`ON DELETE NO ACTION`实际上与`ON DELETE RESTRICT`（默认）相同。

（注意：在某些 DBMS 和标准 SQL 中，`ON DELETE NO ACTION`有点不同于`ON DELETE RESTRICT`: 在那些中，`ON DELETE NO ACTION`表示“接受`DELETE`当前事务，但如果我在纠正问题之前尝试提交它，则拒绝整个事务”。但 InnoDB 没有'不支持延迟检查，因此它的处理`ON DELETE NO ACTION`方式与 完全相同，并且总是*立即*`ON DELETE RESTRICT`拒绝。）`DELETE`

 *请参阅MySQL 5.6 参考手册中的 §§ [14.2.2.5 “外键约束”](http://dev.mysql.com/doc/refman/5.6/en/innodb-foreign-key-constraints.html)和[13.1.17.2 “使用外键约束”](http://dev.mysql.com/doc/refman/5.6/en/create-table-foreign-keys.html)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-23T17:10:57.957

即使没有外键约束，也`ON DELETE / UPDATE CASCADE`可以确保在将值插入子表时，它在父表中具有正确匹配的值（或者`NULL`如果 FK 列可以为空）。尝试在子表的 FK 列中插入无效值会在约束失败时导致错误，从而保护您的数据完整性。

> ERROR 1452 (23000)：无法添加或更新子行：外键约束失败

定义外键约束还隐式定义了子表中 FK 列上的索引，尽管您可以手动定义索引，但这将提高连接性能。

`ON DELETE NO ACTION`（与省略该`ON DELETE`子句相同）如果父行被任何子表引用，将主动*阻止删除它，而不是被动地允许它被删除而不影响子行。**

# php - 在教义中使用列值作为数组索引

> ID：12096792
> 
> 赞同：21
> 
> 时间：2012-08-23T17:08:23.860
> 
> 标签：php, multidimensional-array, doctrine-orm, doctrine

我正在使用学说 2.1 为`settings`表创建模型：

```
id |  arg  |  value  |  category
1  |  name |  foo    |  general_settings 
2  |  desc |  bar    |  general_settings 
```

假设我有很多不同类别的设置。为了获得特定类别的所有设置，我执行以下操作：

```
$q = Doctrine_Query::create()
    ->from('Setting p')
    ->where('p.category = ?', $category_name); 
```

此时一切正常。嗯.. 64,000 美元的问题是：是否存在允许我读取如下结果的数据访问替代方案？

```
$resultSet = $q->execute(); 

//the magic here could be use the -arg- column as index
$requested_setting = $resulSet['name']  

//print the setting value
echo $requested_setting['value'];  //should prints "foo"

//another way
echo $resulSet['desc']['value']; //should prints "bar" 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-08-23T18:05:02.833

我明白了：这里的诀窍是使用这个`INDEX BY`词。

### 查询类

导入查询类（不总是可选的）：

```
use \Doctrine\ORM\Query; 
```

创建查询：

```
$query = $this->data->em->createQuery('
    SELECT s 
    FROM models\Setting s 
    INDEX BY s.arg //to set array custom key
    WHERE s.category = :category');
$query->setParameter('category', 'general'); 
```

设置隐藏模式以使用只读数组

```
$settings = $query->getResult(Query::HYDRATE_ARRAY); 
```

显示值：

```
echo $settings['desc']['value'];  // prints "bar" 
```

### 查询生成器

使用该对象，您可以在语句`QueryBuilder`中设置索引：`from`

```
$qb = $em->createQueryBuilder();
$qb->select('s');
$qb->from('models\Settings', 's', 's.arg');  // here the magic
$result = $qb->getQuery()->getResult(); 
```

然后，您可以通过以下方式访问该对象：

```
$description = $result['desc'];
$value = $description->getValue(); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2017-03-29T21:45:46.063

仅供参考，在您的 EntityRepository 中使用 createQueryBuilder 时，您可以直接指定 INDEX BY 以及别名：

```
$this->createQueryBuilder('p', 'p.id') 
```

这避免了手动处理 EntityRepositories 中自动处理的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-26T11:53:29.673

使用 Doctrine IndexBy 函数，将列值显示为数组索引

```
$this
// database table alias
->createQueryBuilder( 'app_settings' )
// first parameter should be alias and second parameter will be column name, which you want to show as array index
->indexBy('app_settings','app_settings.name')
// get query
->getQuery()
// get doctrine result in array format
->getArrayResult(); 
```

提及查询的结果将采用以下格式： [提及查询的结果](https://i.stack.imgur.com/QT5sM.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-17T08:15:47.127

为了完整起见，使用 时`NativeQuery`，可以在`ResultSetMapping`对象中定义结果数组的索引。例如，通过使用`addIndexByScalar`方法。

```
$rsm = new ResultSetMapping();

$rsm->addScalarResult('ctime', 'ctime', 'datetime');
$rsm->addScalarResult('id', 'id', 'integer');
$rsm->addIndexByScalar('id'); // ← 

$stm = $this->getEntityManager()->createNativeQuery("SELECT ctime, id FROM table", $rsm);
$stm->getArrayResult(); 
```

# css - 有没有办法使用 CSS3 增加一个数字？

> ID：12096795
> 
> 赞同：0
> 
> 时间：2012-08-23T17:08:32.687
> 
> 标签：css, stylesheet, css-transitions

我对 JavaScript 非常熟悉，我意识到我可以用 JS 做到这一点，但我不想——我宁愿能够在 CSS 中做到这一点，或者根本不这样做，因为我坚持CSS 用于展示的规则。

不过，我想知道是否有办法逐步增加 DIV 中的数字。因此，如果我将 DIV 的整数值从例如 1 更新为 5，那么它将在最终停止在 5 之前显示 2、3 和 4。

在伪代码中，我想它会类似于以下内容：

```
div.number
{
    // Increment by 1 step every 0.1 seconds.
    transition: increment(1) 0.1s
} 
```

我认为在 CSS3 中没有办法做到这一点，但我很好奇 CSS 到底有多强大。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:13:24.347

制作一个包含大量`display:none`项目的有序列表，后跟一个可见项目（将编号为 1）

要增加数字，请将 1 更改`<li>`为`display: block`，但使用`position: absolute`使其不可见。这将增加显示项目的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:13:14.120

Webkit 最近添加了对 CSS 变量的支持：http: [//dev.w3.org/csswg/css-variables/](http://dev.w3.org/csswg/css-variables/) 和 [http://www.webmonkey.com/2012/06/css-variables-webkit-brings-the-css -jackalope-to-life/](http://www.webmonkey.com/2012/06/css-variables-webkit-brings-the-css-jackalope-to-life/)

这可能正在走向解决方案。

将其与伪选择器配对，例如

```
div:clicked {
   webkit-var-transformlen: 1
} 
```

它的工作方式可能与您想要的方式相似。

# sql - sql查询以获取具有时间间隔的数据

> ID：12096801
> 
> 赞同：0
> 
> 时间：2012-08-23T17:09:14.540
> 
> 标签：sql, sql-server-2008

我得到了一个包含日期时间类型字段的数据表，我每分钟得到 3-5 个条目的数据，即，

```
23/08/2012 18:05:01,
23/08/2012 18:05:15,
23/08/2012 18:05:26,
23/08/2012 18:05:44,
23/08/2012 18:05:59 
```

现在我需要每 5 分钟获取一条记录

任何人都可以帮我吗 我该怎么做

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T17:26:40.417

我不确定我是否完全理解您的要求，但是对于分钟为 5 的倍数的任何值，以下内容将返回一条记录：

```
select *
from
(
    select *, 
       datepart(minute, yourDate) mn, 
       row_number() over(partition by datepart(minute, yourDate) order by yourDate) rn
    from yourTable
) x
where (mn % 5) = 0
    and rn = 1 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/114a2/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:21:18.793

给定一个看起来像这样的表：

```
create table some_event_log_table
(
  id             int      not null identity(1,1) primary key clustered ,
  dateTimeLogged datetime not null ,
  ... some more columns here --
) 
```

然后像下面这样的查询（[http://sqlfiddle.com/#!3/5ad56/1/0](http://sqlfiddle.com/#!3/5ad56/1/0)上的SqlFiddle ）应该可以解决问题：

```
select dateLogged    = convert(date,dateTimeLogged),
       periodID      = datediff(minute,
                         convert(date,dateTimeLogged) ,
                         dateTimeLogged
                         ) / 5   ,
       period_start  = convert(time,
                         dateadd(minute,
                           datediff(minute,
                             convert(date,dateTimeLogged),
                             dateTimeLogged
                             ) ,
                           convert(datetime,convert(date,dateTimeLogged))
                           )
                         ) ,
       events_logged = count(*)
from some_event_log_table
group by convert(date,dateTimeLogged),
         datediff(minute,
           convert(date,dateTimeLogged) ,
           dateTimeLogged
           ) / 5   ,
         convert(time,
           dateadd(minute,
             datediff(minute,
               convert(date,dateTimeLogged),
               dateTimeLogged
               ) ,
             convert(datetime,convert(date,dateTimeLogged))
             )
           ) 
```

我们9在这里做的是以下。

*   首先，我们将一天划分为每个 5 分钟的时段。每天有 288 个这样的 5 分钟时段。

*   然后，对于表中的每一行，我们

    *   计算列`dateLogged`，行的报告日期（*无*时间）。

    *   计算 column `periodID`，一个从 0 到 287 的值，指示该行属于每天 288 个 5 分钟周期中的哪一个。

    *   计算 column `periodStart`，该行所在时段的开始时间。

*   最后，我们

    *   用 总结`group by`，为一天内的每个时间段创建 1 个组，对我们刚刚为每一行计算的 3 个值进行分组。
    *   用和对结果集进行`order by`排序。`dateLogged``periodID`

这就是它的全部内容。真的很简单，一旦你分解它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-11T15:47:06.243

问题是你有 2 个 periodid 218 行，平均周期 218 怎么样？

# java - 列表视图中的EditText？

> ID：12096804
> 
> 赞同：2
> 
> 时间：2012-08-23T17:09:27.227
> 
> 标签：java, android, android-layout, android-listview

我有一个包含 EditText 视图的 ListView。当触摸这些 EditText 视图时，软键盘会出现（根据需要）。

当使用 android:windowSoftInputMode="adjustPan" 时，触摸板隐藏了 ListView 的底部，因此可能是 EditText 视图的焦点（刚刚触摸）。我知道这可以通过使用 android:windowSoftInputMode="adjustResize"> 来解决。但是，在这种情况下，由于调整 EditText 视图的大小而失去焦点。

我现在想知道是否可以让键盘既不隐藏 EditText 视图又不失去焦点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:14:13.077

**已编辑**

试试这个代码

```
editText.setFocusable(true);
editText.setFocusableInTouchMode(true);
editText.setClickable(true);
editText.requestFocus(); 
```

当然前三行可以放在xml布局中

```
android:focusable="true"
android:focusableInTouchMode="true"
android:clickable="true" 
```

然后只需调用 editText.requestFoxus(); 键盘进入视野后

# iphone - NSFetchedResultsController，指定返回实体的数量？

> ID：12096805
> 
> 赞同：0
> 
> 时间：2012-08-23T17:09:35.240
> 
> 标签：iphone, cocoa-touch, uitableview, core-data, nsfetchedresultscontroller

在创建时有没有办法`NSFetchRequest`指定要返回的实体数量。在下面的示例中，我只想要拥有最多镜头的前 3 个 Zombie 作品，我认为`fetchBatchSize`可能会这样做，但它会返回 3 个批次，直到检索到所有 Zombie 作品。有谁知道你会怎么做？

```
- (void)setupFetchedResultsController {

    // CREATE FETCH REQUEST
    NSFetchRequest *fRequest = [[NSFetchRequest alloc] initWithEntityName:@"Production"];
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name contains %@", @"Zombie"];
    NSSortDescriptor *descriptor = [NSSortDescriptor sortDescriptorWithKey:@"shots" ascending:NO];
    [fRequest setPredicate:predicate];
    [fRequest setSortDescriptors:[NSArray arrayWithObject:descriptor]];
    [fRequest setFetchBatchSize:3];

    // FETCH RESULTS CONTROLLER
    NSManagedObjectContext *moc = [[self managedDocument] managedObjectContext];
    [self setFetchedResultsController:[[NSFetchedResultsController alloc] initWithFetchRequest:fRequest
                                                                          managedObjectContext:moc
                                                                            sectionNameKeyPath:nil
                                                                                cacheName:nil]];
    [[self fetchedResultsController] setDelegate:nil]; // NO UPDATES
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:24:02.563

使用 的[`setFetchLimit`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSFetchRequest_Class/NSFetchRequest.html#//apple_ref/occ/instm/NSFetchRequest/setFetchLimit%3a)属性`NSFetchRequest`。

**摘自 Apple Docs：** *获取限制指定请求在执行时应返回的最大对象数。*

# javascript - 如何使用 HTML5、javascript 从 exif 中提取缩略图

> ID：12096811
> 
> 赞同：0
> 
> 时间：2012-08-23T17:09:53.477
> 
> 标签：javascript, jquery, html, exif

我正在尝试使用 html5 实现拖放。所以在上传到服务器之前，我想显示丢弃图像的缩略图。应该采取什么方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T01:24:10.647

对于来自 EXIF 的缩略图，我认为这是不可能的，除非您拥有/编写自己的 JavaScript 中的 EXIF 库以在浏览器上运行。但是，如果您只需要缩略图，则要容易得多：

```
 document.querySelector('#fileInputForImage').addEventListener('change', function() {
      if (this.files && this.files[0]) {
          var reader = new FileReader();
          reader.onload = function(e) {
              document.querySelector('#previewImage').src = e.target.result;
          };
          reader.readAsDataURL(this.files[0]);
      }
   }, false); 
```

注意现在浏览器支持不是很好：[http ://caniuse.com/filereader](http://caniuse.com/filereader)

# javascript - 旋转图像 javascript--图像不旋转--MVC3

> ID：12096812
> 
> 赞同：1
> 
> 时间：2012-08-23T17:09:58.663
> 
> 标签：javascript, html, asp.net-mvc-3

所以这段代码应该工作......如果我使用文本编辑器和纯 html 文档，完全相同的工作。也许我需要在视觉工作室中配置一些东西？

我正在尝试每五秒旋转以下四个图像。这是 JScript1.js 文件：

```
var imageArray = ["http://localhost:53734/Content/themes/base/images/oly1.jpg",   "http://localhost:53734/Content/themes/base/images/oly2.jpg", "http://localhost:53734/Content/themes/base/images/oly3.jpg", "http://localhost:53734/Content/themes/base/images/oly4.jpg"];
var imageIndex = 0;
var myImage = document.getElementById("rotatingBanner");

function changeImage() {
myImage.setAttribute("src", imageArray[imageIndex]);
imageIndex++;
if (imageIndex >= imageArray.length) {
    imageIndex = 0;
}
}

var intervalHandle = setInterval(changeImage, 5000); 
```

这是它运行的视图：

```
@{
ViewBag.Title = "Home Page";
}

<h2>@ViewBag.Message</h2>

<h4>View results by:</h4>
<ul id="friend">
    <li>@Html.ActionLink("Countries", "Countries", "Home")</li>
    <li>@Html.ActionLink("Events", "Events", "Home")</li>
</ul>
<div>
<img id="rotatingBanner" src="http://localhost:53734/Content/themes/base/images/oly1.jpg" />
</div>
<script src="http://localhost:53734/Scripts/JScript1.js"/> 
```

我们在视图中请求的图像出现了，但 5 秒后它没有像应有的那样旋转。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:21:03.520

我没有适当地关闭脚本标签：它应该被关闭

```
</script> 
```

不是

```
script.js/> 
```

# c# - Caliburn.micro Mouseclick 更新 TextBlock

> ID：12096814
> 
> 赞同：0
> 
> 时间：2012-08-23T17:10:15.180
> 
> 标签：c#, wpf, caliburn.micro

我还在学习 Caliburn.micro，所以这可能是一个愚蠢的问题。我有一个 ListView，里面有一个 GridView。我希望能够单击一行并让它更改 ListView 之外的 TextBlock 的文本。

```
<TextBlock x:Name="titleText" Grid.Row="6" Grid.Column="4" Text="View a report of all current applications" TextWrapping="Wrap" Margin="5" VerticalAlignment="Center" FontWeight="Bold" />

    <ListView VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Name="listView1" SelectedItem="{Binding Key}" ItemContainerStyle="{DynamicResource CustomListViewItemStyle}" AlternationCount="2" 
              ItemsSource="{Binding}" DataContext="{StaticResource OrderGroup}" Grid.Column="2" Grid.Row="10" Grid.ColumnSpan="5" Height="200"  cal:Message.Attach="[Event MouseLeftButtonUp]=[Action HandleClick($eventArgs)]">
        <ListView.View>
            <GridView AllowsColumnReorder="False" x:Name="GridView1">
                <GridViewColumn Header="Client Name" DisplayMemberBinding="{Binding Path=ClientName}" ></GridViewColumn>
                <GridViewColumn Header="Application ID" DisplayMemberBinding="{Binding Path=ID}" ></GridViewColumn>
            </GridView>
        </ListView.View>
    </ListView> 
```

如您所见，我正在调用 cal:Message.Attach 来处理 MountLeftButtonUp 事件。

这将调用以下代码：

```
public void HandleClick(RoutedEventArgs e)
    {
        titleText= "SOME TEST HERE"; 
    } 
```

并且titleText（我要更新的TextBlock）定义如下：

```
String _titleText = "";
    public string titleText
    {
        get { return _titleText; }
        set
        {
            if (_titleText != value)
            {
                _titleText = value;
                NotifyOfPropertyChange(() => _titleText);
            }
        }
    } 
```

但是，这不会更新 TextBlock。单步进入代码，看到代码中titleText发生了变化，但是没有显示出来。我也将其更改为在单击图像时执行相同的操作，并且成功运行。

那么我可能会在这里遗漏一些东西吗？任何有 Caliburn.micro 经验的人。

谢谢。

泥泞的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T05:54:24.197

解决方案由 Coding Gorilla 提供 - 我在 titleText 声明中错过了它。它应该调用属性而不是私有成员 - 像这样：

```
String _titleText = "";
    public string titleText
    {
        get { return _titleText; }
        set
        {
            if (_titleText != value)
            {
                _titleText = value;
                NotifyOfPropertyChange(() => titleText);
            }
        }
    } 
```

改变了这一点，它奏效了——所以只是我没有看到问题的一个例子。谢谢。

# python - 根据概率权重随机返回一个值

> ID：12096819
> 
> 赞同：0
> 
> 时间：2012-08-23T17:10:45.930
> 
> 标签：python, probability

> **可能重复：**
> [random.choice 的加权版本](https://stackoverflow.com/questions/3679694/a-weighted-version-of-random-choice)

为简单起见，假设一个函数接受 4 个输入：2 个名称及其各自的“偏差/权重”，我如何编写一个函数，使其返回`a`或`b`随机返回，但仍将这些权重视为随机结果。

```
a = 'x'
b = 'y'
p_a = 10
p_b = 90

def myRand(a, p_a, b, p_b):
    return 'x' 10% of the time, 'y' 90% of time 
```

**到目前为止我所做的**

```
import random

def myRand(a, p_a, b, p_b):
    probs = [a]*p_a + [b]*p_b
    return random.choice(probs) 
```

有人可以指出为什么这是不正确或不是最佳答案吗？我的理由是我假设每个元素都有相同的被选中的概率，所以结果应该仍然有利于 10:90。或者也许我们可以在使用之前对数组进行洗牌`random.choice()`？

有一个更好的方法吗？也许我在这里遗漏了一些明显的东西，或者这是正确的吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:15:32.640

这将完成你想要做的事情：

```
#assumes p_a and p_b are both positive numbers that sum to 100
def myRand(a, p_a, b, p_b):
   return a if random.uniform(0,100) < p_a else b 
```

请注意，在只有 2 个权重的特殊情况下， p_b 变得不必要，因为`p_b == 100-p_a`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T18:42:38.393

我已经修改了函数以接受任意数量的输入和加权概率，所以如果稍后您决定要使用两个以上的输入，您可以。

```
import random

def myRand(i, w):
    r = random.uniform(0, sum(w))

    # loop through a list of inputs and max cutoff values, returning
    # the first value for which the random num r is less than the cutoff value
    for n,v in map(None, i,[sum(w[:x+1]) for x in range(len(w))]):
        if r < v:
            return n 
```

示例用法：

```
inputs = ['e', 'f', 'g', 'h']
weights = [10, 30, 50, 10]

print myRand(inputs, weights) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T17:16:24.870

a = 'x';b = 'y';p_a = 10;p_b = 90

比率 = p_a+pb = 100

生成一个介于 0 到 100 之间的随机数，如果数字小于 10，则使用 a=>x 否则使用 b=>y

# sql - 在 SQL 中将 Any 转换为字符串

> ID：12096824
> 
> 赞同：-1
> 
> 时间：2012-08-23T17:11:17.437
> 
> 标签：sql, sql-server-2005

我必须将一些参数值记录到日志文件（SQL Server 2005）

SQL 中是否有一种*通用* **`.ToString()`**方法可以将任何类型转换为`object`以`string`可视化对象值？

通过例如。如果我使用`STR(@param)`它，它期望 @param 是一个浮点或整数值。当@param 是 varchar 时它会失败...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T17:14:33.863

您应该能够使用[`CONVERT()`or`CAST()`](http://msdn.microsoft.com/en-us/library/ms187928.aspx)将任何参数转换为字符串：

```
SELECT CONVERT(NVARCHAR(MAX), @param);
SELECT CAST(@param AS NVARCHAR(MAX)); 
```

转换是否有意义是另一回事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:13:59.793

查看`CAST()`和`CONVERT()`功能。

# c - 使用 openssl 在标准输出 RSA 公钥上打印

> ID：12096825
> 
> 赞同：-1
> 
> 时间：2012-08-23T17:11:23.200
> 
> 标签：c, unix, openssl, rsa

如何在使用 i2d_RSAPublicKey 提取后打印存储在 const unsigned char * 中的公钥？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:23:47.077

你的问题相当广泛。但是，假设公钥是 的数组`unsigned char`，您需要将每个字符（每个字节）转换为可读的内容，例如十六进制或 base-64 编码。

像以十六进制打印整个密钥这样简单的事情可能会起作用：

```
for (int i = 0;  i < pubkey_len;  i++)
    printf("%02X", pubkey[i]); 
```

# c# - RazorViewEngine.FindPartialView 使用缓存。它有什么作用？

> ID：12096827
> 
> 赞同：3
> 
> 时间：2012-08-23T17:11:36.173
> 
> 标签：c#, caching, razor, asp.net-mvc-4

我需要将部分视图呈现为字符串，因此我可以将 Razor 语法部分视图呈现到 Asp.net 视图中。该过程的一部分涉及让视图引擎找到视图：

```
var engine = 
    ViewEngines.Engines
        .OfType<RazorViewEngine>()
        .SingleOrDefault();
if(engine == null)throw new Exception("no razor viewengine");
//useCache is the last parameter in the invocation below
var viewResult = engine
    .FindPartialView(htmlHelper.ViewContext, viewName, false); 
```

如果我将`useCache`参数设置为`true`（即我不希望虚拟路径提供程序在我每次请求时都搜索它），则不再找到该视图。我原以为如果没有通过缓存找到它，我们会退回到非缓存方法。

我的期望错了吗？这与混合 ViewEngines 有关吗？

让我更困惑的是，如果我们只是要求`ViewEngine.Engines`集合找到视图，我们没有得到一个`useCache`参数：

```
var viewResult = 
    ViewEngines
         .Engines
         .FindPartialView(htmlHelper.ViewContext, viewName); 
```

我想我会选择这个 FTTB，但它引出了一个问题……为什么会出现差异？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T17:31:55.290

`FindView`和`FindPartialView`方法由 ASP.NET MVC 框架首先在内部调用，`useCache=true`然后`useCache=false`如果没有找到。你可以尝试做同样的事情。

> 更让我困惑的是，如果我们只是要求 ViewEngine.Engines 集合来查找视图，我们没有得到 useCache 参数：

那是因为这个方法做了我之前解释过的事情。

# jquery - 使用 jquery 按类别过滤 Wordpress 帖子

> ID：12096828
> 
> 赞同：1
> 
> 时间：2012-08-23T17:11:44.653
> 
> 标签：jquery, wordpress, filter, toggle, categories

我正在尝试显示可以过滤的新闻提要。

假设 wordpress 类别“新闻”具有“体育”“商业”和“Region1”、“Region2”、“Region3”等子类别

所以页面将如下所示：

```
 ** ALL NEWS | Sports | Business  ** 
```

**区域1**

**区域2**

**区域3**

这是我在 Wordpress 循环中的帖子：

```
 //Get all posts with a category of "NEWS"
                    query_posts('cat=1' );
                while (have_posts()) : the_post();
                echo '<li class="';

                        //Display the categories
                        $categories = get_the_category();
                        $output = '';

                        if($categories){
                            foreach((get_the_category()) as $category) { 
                            $output = $category->cat_name .'-';
                            echo $output;
                            } 
                    } 
```

这显示：

```
<li class="news-sports-region1">Article1</li>
<li class="news-business-region2">Article2</li>
<li class="news-sports-region3-">Article3</li> 
```

因此，在我的 jquery 脚本中，我试图找出处理用户单击每个类别时的最佳方法。如果您有比我尝试做的更简单的解决方案，请告诉我。

**我需要以下代码：**

如果用户点击“体育”，则隐藏 CLASS 中所有没有“体育”一词的帖子。我还需要知道如何记住单击了哪个区域并按所选区域进行过滤。

我的代码现在一团糟，有一堆我无法工作的不同解决方案。我试图通过将类别应用为“数据类别”属性进行过滤，但在某处遇到了障碍。

请帮忙，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T20:57:40.157

首先，如果您不将不同的类连接在一起（即，只需在“新闻体育区”之间放置一个空格），将会有所帮助。这样，您可以将一个类应用于一个特定的类（“新闻”或“体育”），而不必做一些复杂的事情来选择类的一部分（如 div[class*='news-']）。如果你完成了它，那么它将如下所示：

```
<li class="news sports region1">Article1</li>
<li class="news business region2">Article2</li>
<li class="news sports region3-">Article3</li> 
```

然后，您需要 jquery 做的就是为这些类别的显示/隐藏设置动画。就像是：

```
$('.news').hide(600)
$('.sports').show(600) 
```

我自己对 JQuery 不太擅长，所以这只是对如何做的概述。希望它能让你开始。

# java - 如何将运行时数据注入使用 JAXB 解析 XML 时创建的对象

> ID：12096829
> 
> 赞同：3
> 
> 时间：2012-08-23T17:11:49.800
> 
> 标签：java, xml, jaxb

我必须解析一个复杂的 XML 文档。我的模型中的一些类实现了接口`HasDate`：

```
interface HasDate {
    public void setDate(Date date);
} 
```

创建解组器的日期是已知的：

```
// here I know the date.
JAXBContext ctx = JAXBContext.newInstance("com.mycompany.mymodel");
Unmarshaller unmarshaller = ctx.createUnmarshaller();
unmarshaller.unmarshal(input); 
```

我想调用在 JAXB 解析文档时`setDate()`实现的每个类实例。`HasDate`

这是我自己知道的 2 个解决方案：我可以将每个相关类注释如下：

```
@XmlType(factoryClass = ObjectFactory.class, factoryMethod = "createMyObject") 
```

该方法`createMyObject()`将调用`setDate()`. 这个解决方案的问题是它`createMyObject()`必须是静态的。将信息设置为静态成员会使解决方案不是线程安全的。

作为此解决方案的一种变体，我可以将日期放在`ThreadLocal`解析之前。`createMyObject()`将从中读取日期 `ThreadLocal`并调用`setDate()`. 这个解决方案是线程安全的，但看起来像一个补丁。

其他解决方案是使用反射发现由 JAXB 创建的对象图，递归遍历它并`setDate()`在需要时调用。该解决方案是线程安全的，但需要一些实施工作并且需要在未来进行维护。

我想知道 JAXB 是否有针对此问题的其他内置解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:52:25.220

您可以实现一个`Unmarshaller.Listener`并将其设置在`Unmarshaller`. 然后在`afterUnmarshal`方法上，如果目标类是一个实例，`HasDate`那么你可以`setDate`在它上面调用方法。

*   [http://docs.oracle.com/javase/6/docs/api/javax/xml/bind/Unmarshaller.Listener.html](http://docs.oracle.com/javase/6/docs/api/javax/xml/bind/Unmarshaller.Listener.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T17:29:54.347

我建议`@XmlAdapter`对所有实现`HasDate`接口的类使用。这使您的用例明确且类型安全。您可以拥有一个能够从 ThreadLocal 中查找日期的基本适配器。

[XmlAdapter：JAXB 的秘密武器](http://blog.bdoughan.com/2010/07/xmladapter-jaxbs-secret-weapon.html)

如果此选项不起作用，那么我喜欢在[afterUnmarshall](http://docs.oracle.com/javase/6/docs/api/javax/xml/bind/Unmarshaller.Listener.html#afterUnmarshal%28java.lang.Object,%20java.lang.Object%29)生命周期方法中调用反射方法。

# php - PHP PDO 检查 mySQL 表中的多个列并创建不存在的列

> ID：12096830
> 
> 赞同：3
> 
> 时间：2012-08-23T17:11:51.030
> 
> 标签：php, mysql, foreach, pdo, alter-table

寻找一种方法来检查数据库中的表是否已与其所需的列组合在一起。

我建立了这个功能：

```
function verifydbtable($table,$fields){
    global $fsdbh;
    foreach($fields as $field => $type){
        $verify = $fsdbh->prepare("ALTER TABLE `$table` ADD `$field` $type;");
        $verify->execute();
    }
    return 1;
} 
```

`$table`要更新的表在哪里，并且`$fields`包含要检查的所有字段的数组。`$type`包含字段的类型，例如。`VACHAR(20)`.

该函数适用于每个字段，直到遇到已经存在的字段。然后它返回假。

**问题是它不会检查数组中的剩余列。我们如何让它继续检查剩余的字段。**

由于如果一个列已经存在，它将返回一个错误`#1060 - Duplicate column name 'subtitle'`，这是它应该做的。然后，如果返回此错误，我们需要跳到数组中的下一项。

用外行的话来说，我们需要这个，但当然这不是一个 mySQL 语句。

```
prepare("ALTER TABLE `$table` ADD IF NOT EXIST `$field` $type"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:23:19.257

您可以尝试`IGNORE`为查询指定：

```
$fsdbh->prepare("ALTER IGNORE TABLE `$table` ADD `$field` $type;"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T17:57:32.420

使用尝试捕获：

```
function verifydbtable($table,$fields){
    global $fsdbh;
    $errors = array();
    foreach($fields as $field => $type){
        $verify = $fsdbh->prepare("ALTER TABLE `$table` ADD `$field` $type;");
        try {
          $verify->execute();
        } catch (PDOException $e) {
           // you might want to check and make sure its actually the right error
           // but you can figure that out if when you need to do so
           // we'll also store the field name in an array jsut in case we want to use it
           $errors[] = $field;
        }
    }

     return 1;
} 
```

# ios - Retina vs 常规图像分辨率：两个图像都有 1 个高 rez，还是每个图像有 2 个图像，每个图像都有各自的 rez？

> ID：12096837
> 
> 赞同：0
> 
> 时间：2012-08-23T17:12:18.483
> 
> 标签：ios, documentation, retina-display

任何经验丰富的开发人员都会在开发周期中达到这一点：图形和成像。是的，视网膜显示器很棒！但它们肯定在开发人员（和他们的设计师）中引起了很多骚动。现在似乎一直没有好的答案的问题是：

*“在为 Retina 和常规显示器设计时，我们是否需要为每种分辨率创建一个图像，或者我们可以在 Retina 上创建一个缩放到两者的图像？”*

我阅读了许多主张任何一方的答案，并且三分之二的答案他们主张为两种分辨率制作图像。*我个人认为*您应该为视网膜设计一个，并将其用于两者（当然，在较低分辨率的设备上进行 UD UX 测试，以确保为较高 rez 设计的内容适用于较低分辨率）。我支持这一点，因为当我设计一个为视网膜分辨率创建图像的应用程序时，它是否成功地缩小到不支持视网膜显示的设备上的正常 rez？（我确实使用过 IB .. 我不知道这是否与它有关..）

但是，如果您是提倡为两种分辨率制作图像的人，请采取以下措施：

例如，假设您同意每个分辨率大小都需要有自己的图像（当然还有正确的文件命名约定“@2x”“~ipad”等），并且您的应用在这种情况下是通用应用。这是否意味着对于每张图像，您实际上需要 4 张图像？这不会显着增加应用程序包的大小吗？

提供每个图像大小（带有适当的命名约定）是否可能不是必需的，而仅仅是一种可能性？

这场辩论的真正答案是什么？

**任何人都可以找到有关此问题的苹果*官方文档的链接吗？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:38:17.600

Eli，我在 Quartz 列表上发布了同样的问题（或参与了讨论）关于这个确切的主题，但我现在似乎找不到它。

压倒性的共识是制作两个图像。虽然仅使用 @2x 图像似乎确实有效，但与以下相比，闪存占用空间被视为性能低下：

*   操作系统必须使用更多的马力来渲染图像，影响性能

*   在首先具有较少 RAM 的设备上，内存消耗增加了 4 倍

所以，我决定只支持两者。您拥有 iPad 特定图像的唯一原因是尺寸，因此您当然需要两个。

如果您只是创建@2x 图像，您可以使用“sips”（或 imageMagik）编写一个小 shell 程序来获取这些 2x 图像并制作 1x 版本（通过缩小）。

如果到目前为止还没有苹果工程师站出来明确表示只做 2x 图像就可以了，而且不是书面的，我想这告诉你官方的立场是什么。

PS：假设苹果要设计一款更小的 iPad，它的像素密集型显示屏与非 Retina iPad 的像素宽度相同。并且假设为了使其真正便宜，他们使用了较慢的处理器并且没有给它很多内存。那么我想你会更好地使用两种尺寸的图像，不是吗？

# sql - 将 ParameterDirection 设置为函数的 ReturnValue

> ID：12096838
> 
> 赞同：0
> 
> 时间：2012-08-23T17:12:27.087
> 
> 标签：sql, sql-server, ado.net

[关于 ADO.NET 命令和参数](http://msdn.microsoft.com/en-us/library/yy6y35y8%28v=vs.110%29.aspx)的MSDN 文档指出：

> ReturnValue：该参数表示存储过程、**内置函数**或**用户定义函数**等操作的返回值。

这可以在 SQL Server 中完成吗？或者任何关系数据库管理系统？

我尝试将 CommandText 设置为函数的名称：

```
using (var conn = new SqlConnection(connectionString)) {
    conn.Open();
    var cmd = conn.CreateCommand();
    cmd.CommandText = "RAND";

    var parameter = new SqlParameter();
    parameter.Direction=ParameterDirection.ReturnValue;
    cmd.Parameters.Add(parameter);

    cmd.ExecuteNonQuery();

    Console.WriteLine(
        "Random number from SQL Server: {0}",
        parameter.Value
    );
} 
```

并收到以下 SqlException：

> 找不到存储过程“RAND”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T16:32:30.713

AFAIK，您不能像那样调用“语法”内置函数，因为它们不是真正的 sql 对象，并且不会出现在任何对象列表中（它们是由编译器在语法上实现的）。

其他函数也可以这样调用，但不建议这样做，因为这是一种过时的用法，而且因为它将它们视为过程，并且过程只能有一个`integer`返回值。因此，如果您的函数返回一个非整数，它很可能会变成乱码，无法识别。

# java - 如何读取具有特定字符编码的 Java 文件？

> ID：12096844
> 
> 赞同：28
> 
> 时间：2012-08-23T17:12:47.413
> 
> 标签：java, file-io, utf-8, character-encoding, windows-1252

我正在尝试根据此方法的输出以 UTF-8 或 Windows-1252 格式读取文件：

```
public Charset getCorrectCharsetToApply() {
    // Returns a Charset for either UTF-8 or Windows-1252.
} 
```

到目前为止，我有：

```
String fileName = getFileNameToReadFromUserInput();
InputStream is = new ByteArrayInputStream(fileName.getBytes());
InputStreamReader isr = new InputStreamReader(is, getCorrectCharsetToApply());
BufferedReader buffReader = new BufferedReader(isr); 
```

我遇到的问题是将`BufferedReader`实例转换为`FileReader`.

此外：

*   文件本身的名称 ( `fileName`) 不能被认为是特定的`Charset`；有时文件名将包含 UTF-8 字符，有时包含 Windows-1252。文件内容也是如此（但是，如果文件名和文件内容*始终*具有匹配的字符集）。
*   只有内部的逻辑`getCorrectCharsetToApply()`可以选择要应用的字符集，因此在调用此方法*之前*尝试按文件名读取文件很可能会导致 Java 尝试使用错误的编码读取文件名......这会导致文件死亡！

提前致谢！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-23T17:30:02.303

所以，首先，作为一个提醒，要意识到`fileName.getBytes()`你在那里得到的是文件名的字节，而不是文件本身。

其次，阅读[FileReader](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/FileReader.html)的文档：

> 此类的构造函数假定默认字符编码和默认字节缓冲区大小是适当的。要自己指定这些值，请在 FileInputStream 上构造 InputStreamReader。

所以，听起来像 FileReader 实际上不是要走的路。如果我们接受文档中的建议，那么您只需将代码更改为：

```
String fileName = getFileNameToReadFromUserInput();
FileInputStream is = new FileInputStream(fileName);
InputStreamReader isr = new InputStreamReader(is, getCorrectCharsetToApply());
BufferedReader buffReader = new BufferedReader(isr); 
```

并且根本不尝试制作 FileReader。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-10-25T21:05:47.890

使用 Java 7+，您可以在一行中创建 Reader：

`BufferedReader buffReader = Files.newBufferedReader(Paths.get(fileName), getCorrectCharsetToApply());`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-07-15T00:40:03.310

请注意，如果您使用的是[Google Guava](https://code.google.com/p/guava-libraries/)，您可以使用[`Files.newReader`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/Files.html#newReader(java.io.File,%20java.nio.charset.Charset))：

```
final BufferedReader reader =
        Files.newReader(new File(filename), getCorrectCharsetToApply()); 
```

# java - 如何在 Bean Validation 1.0 中构造 ConstraintViolationException？

> ID：12096846
> 
> 赞同：20
> 
> 时间：2012-08-23T17:13:11.190
> 
> 标签：java, generics, bean-validation

我对 javax.validation API 感到困惑。我正在编写一个简单的测试来理解它：

```
Sample sample = new Sample();
Set<ConstraintViolation<Sample>> violations = validator.validate(sample);
if (!violations.isEmpty()) {
    // Eclipse refuses to let me use my violations variable
    throw new ConstraintViolationException(violations);
} 
```

我应该如何声明一组违规，以便我可以在我的异常构造函数中使用它？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-23T20:09:19.593

您可以像这样解决这个问题：

```
throw new ConstraintViolationException(
    new HashSet<ConstraintViolation<?>>(violations)); 
```

您可能对跟踪解决此问题的[BVAL-198感兴趣。](https://hibernate.atlassian.net/browse/BVAL-198)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-02-02T19:49:45.317

这是 Bean Validation 1.0 中的一个已知可用性问题。此问题已在[Bean Validation 1.1](https://beanvalidation.org/1.1/changes/)中的问题[BVAL-198](https://hibernate.atlassian.net/browse/BVAL-198) “简化 ConstraintViolationExceptions 的创建”中得到解决。升级到 Bean Validation 1.1 或更高版本将允许您的代码按照编写的方式编译。

具体问题是[`ConstraintViolationException`](https://javadoc.io/static/javax.validation/validation-api/1.0.0.GA/javax/validation/ConstraintViolationException.html#ConstraintViolationException(java.util.Set))构造函数接受`Set<ConstraintViolation<?>>`了他们的`constraintViolations`参数。由于`Set<ConstraintViolation<Sample>>`不是 的子类型`Set<ConstraintViolation<?>>`，因此无法将其传递给构造函数，尝试这样做时会发生编译错误。

Bean 验证 1.1.0[将构造函数更改](https://javadoc.io/static/javax.validation/validation-api/1.1.0.Final/javax/validation/ConstraintViolationException.html#ConstraintViolationException(java.util.Set))为 accept `Set<? extends ConstraintViolation<?>>`。由于这是 的超类型`Set<ConstraintViolation<Sample>>`，因此可以直接将其传递给构造函数。

如[另一个答案](https://stackoverflow.com/a/12099192/1108305)中所述，仍在 Bean Validation 1.0 上的修复是传入 a`Set<ConstraintViolation<?>>`而不是`Set<ConstraintViolation<Sample>>`：

```
throw new ConstraintViolationException(
    new HashSet<ConstraintViolation<?>>(violations)); 
```

# git - 我怎样才能在本地“清理”分支，而不会破坏其他人的一切？

> ID：12096848
> 
> 赞同：2
> 
> 时间：2012-08-23T17:13:15.987
> 
> 标签：git, branch

我正在从其他人的存储库中提取更改（出于宣泄的原因，我们称它们为“gitnoob”），其中所有内容都混合在一起。他们最初显然是在他们的主要分支中工作，然后才了解分支。它看起来有点像这样：

```
 d - f <--- stuff
                 /   /
A - b - 1 - c - 2 - E <--- dev 
```

这些数字是应该在另一个分支中的提交，如果我将它们合并到我自己的`dev`分支中，可能会破坏事情。（我将在稍后将它们拉出来`upstream/dev`——`upstream`作为我们共享的父存储库——一旦它们被合并到那里。）小写字母是应该是一部分的提交，`stuff`大写字母是合法合并到的提交`dev`。

理想情况下，我想在我的最后清理这个 - 在本地有这样的东西：

```
 b - c - d - f <--- stuff
 /           /
A --------- E <--- dev 
```

现在，无论如何都会发生`stuff`所有与`stuff`- 相关的更改，因为`gitnoob/stuff`还将包括`upstream/dev`与`gitnoob/dev`该点之间的所有差异（并且合法`dev`的差异已经在我的`dev`分支中）。问题是，这意味着`stuff`也会有提交`1`和`2`，这很可能会破坏事情。

我需要能够在`gitnoob/stuff`没有大量麻烦的情况下进行更改（并且，如果可能的话，不要让 1 和 2 回到那里直到它们出现在上游），并让他们从我这里拉出更改，而他们最终没有得到任何东西还原或删除。

我该怎么做呢？还是我只是坚持使用 1 和 2 in `stuff`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T18:39:47.497

在这种情况下，我建议保留过去并尝试在未来做得更好。

`b`取出和`c`取出`dev`并只放入它们有什么好处`stuff`？由于是在之后`stuff`分支的，因此无论如何都包含提交。`dev``c``stuff`

我也很想偶尔做这样的事情，但通常我最终会想那又*怎样？*当我学习 Git 并从 SVN 切换到这些提交时，情况尤其如此。出问题了。好的。但它有效。所以不要碰它。

版本控制本身是一种工具，而不是目的。你在你的仓库里放了一些代码。那是珍贵的东西。不是——也许——回购的*混合*历史。

您可以在本地修复分支，但是当涉及从上游合并内容或将更改推送到那里时，您会遇到麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:03:09.550

所以基本上，你想要一个私人版本的`stuff`恢复`1`和`2`，但你自己的公共版本`stuff`仍然包含它，以便 gitnoob 从中提取。没有无缝的方法可以做到这一点，但实现它的一种方法是引入几个新分支：

```
...d-f <---stuff-upstream
      \
       g <---reverted-stuff
        \
         h <---my-stuff 
```

您所做的是创建一个`reverted-stuff`恢复`1`和`2`. 当您想要进行与 gitnoob 共享的更改时，您可以从`reverted-stuff`make分支`my-stuff`。在`my-stuff`. 您也应该能够合并您`dev`的`my-stuff`。

当您准备好共享更改时，请`my-stuff`重新`stuff-upstream`使用`git rebase --onto stuff-upstream reverted-stuff my-stuff`. 这将删除您的还原`g`并使其看起来像是`my-stuff`直接从 分支出来的`stuff-upstream`，从而使 gitnoob 可以毫无恐惧地拉动。

当你从 gitnoob 拉取时，拉入`stuff-upstream`，然后将其合并到`reverted-stuff`. 该合并将自动重新应用`g`，您恢复`1`和`2`。然后你可以分支一个新`my-stuff`的`reverted-stuff`.

话虽这么说，如果`1`真的`2`像你说的那样有问题，你也会帮 gitnoob 帮个忙，把它从他的分支中拿出来。如果不是那么糟糕，那真的没有理由经历这一切。

# c++ - C++ 警告 typedef void (* somename) (arg1, arg2);

> ID：12096851
> 
> 赞同：0
> 
> 时间：2012-08-23T17:13:34.260
> 
> 标签：c++, typedef, void-pointers

首先...我在名为 core_ns.h 的文件中有以下代码

```
/*
 * the prototype for the function that will be called when a connection
 * is made to a listen connection.  
 * Arguments:
 *    Server_Connection - ID of the listen connection that received the request
 *    New_Connection    - ID of the data connection that was created.
 */
typedef void (* CORE_NS_Connect_Callback)
                (CORE_NS_Connection_Type  Server_Connection,
                 CORE_NS_Connection_Type  New_Connection); 
```

然后我在名为 ParameterServerCSC.h 的文件中有以下内容

```
class ParameterServer{
public:
    //-------------------------------------------------------------------------------
    //FUNCTION: sendCallback
    //
    //PURPOSE: This method will be performed upon a connection with the client. The 
    //Display Parameter Server will be sent following a connection.
    //-------------------------------------------------------------------------------
    void sendCallback (CORE_NS_Connection_Type serverConnection, CORE_NS_Connection_Type newConnection);
}; // end class ParameterServer 
```

最后...我在名为 ParameterServer.cpp 的文件中有以下用法

```
 //-------------------------------------------------------------------------------
      //FUNCTION: setup 
      //
      //PURPOSE: This method will perform any initialization that needs to be performed
      //at startup, such as initialization and registration of the server. 
      //-------------------------------------------------------------------------------
      void ParameterServer::setup(bool isCopilotMfd){

            CORE_NS_Connect_Callback newConnCallback; 
            newConnCallback = &ParameterServer::sendCallback;//point to local function to handle established connection.
      } 
```

我收到以下警告：

> 警告：从`void (ParameterServer::*)(CORE_NS_Connection_Type, CORE_NS_Connection_Type)' to`void (*)(CORE_NS_Connection_Type, CORE_NS_Connection_Type)'
> MY_PROJECT/DisplayParameterServer
> ParameterServerCSC.cpp 转换

我正在使用 LynxOS178-2.2.2/GCC C++ 编译器。我的解决方案是用这个警告构建的。我试图理解警告的含义。对此的任何见解表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T17:16:08.260

`ParameterServer::sendCallback`是成员函数或方法（其类型为`void (ParameterServer::*)(CORE_NS_Connection_Type, CORE_NS_Connection_Type)`），因此不能用作函数（类型`void (*)(CORE_NS_Connection_Type, CORE_NS_Connection_Type)`）。

您需要使其成为静态成员函数：

```
static void sendCallback (CORE_NS_Connection_Type serverConnection, CORE_NS_Connection_Type newConnection); 
```

否则（取决于调用约定）API调用时`sendCallback`参数设置错误，会出现错误；至少隐藏`this`参数将是垃圾。

# c++ - 双 C++ 的精度损失

> ID：12096852
> 
> 赞同：9
> 
> 时间：2012-08-23T17:13:34.200
> 
> 标签：c++

我正在开发一个在 linux 环境下运行的 C++ 应用程序。我需要存储一个小数点后 6 位的大值。我为此使用了双精度，但是在分配它之后，它不包含确切的值。它被四舍五入。

前任：

```
double dValue = 79447461534242.913072; //Assignement of value 
```

但在这样做之后，每当我看到 dValue 的值时，它就像 79447461534242.906

有人可以让我知道为什么会发生这种情况并建议我正确的数据类型，它可以保持精确值而不会丢失任何精度。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T17:15:44.920

在典型的实现中， a的*总*`double`精度大约为 15 位。小数点之前还是之后都没有关系，总共只有15位。

 *在您的情况下，原始号码约为 20 位，因此立即丢失了 5 位。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T17:16:45.590

C++ 使用 IEEE 浮点类型，这些浮点类型只能在**设计**上达到一定程度。如果您需要任意精度，请查看例如[GNU MP Bignum](http://gmplib.org/)或任何其他任意精度库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T17:21:39.677

在 linux 上，您可以使用 __float128 ，它是一种四精度浮点类型。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-23T17:19:01.250

最[常用的双精度格式](http://en.wikipedia.org/wiki/Double-precision_floating-point_format)以 53 位精度存储数字。这给出了大约 16 位十进制数字的精度。

您可能会发现它`long double`提供了更高的精度，但不能保证它大于`double`.

如果您需要比从本机机器类型获得的精度更高的精度，您将需要一个高精度数值库，例如[GMP](http://gmplib.org/)。*

# c# - 将枚举绑定组合框选定值设置为枚举值

> ID：12096855
> 
> 赞同：-1
> 
> 时间：2012-08-23T17:13:49.470
> 
> 标签：c#, winforms, binding, combobox, enums

我的项目中有一个这样的枚举：

```
public enum UserFrienlyEnum
{
    [Description("it need spec training")]
    SPECIAL_TRAINING = 1,
    [Description("it need normal training")]
    NORMAL_TRAINING = 2,
    [Description("it need simple training")]
    SIMPLE_TRAINING = 3
} 
```

我使用此方法将此枚举绑定到组合框：

```
public static void setEnumValues(ComboBox cxbx, Type typ)
{
    if (!typ.IsEnum)
    {
        throw new ArgumentException("Only Enum types can be set");
    }

    List<KeyValuePair<string, int>> list = new List<KeyValuePair<string, int>>();

    foreach (int i in Enum.GetValues(typ))
    {
        string name = Enum.GetName(typ, i);
        string desc = name;
        FieldInfo fi = typ.GetField(name);

        // Get description for enum element
        DescriptionAttribute[] attributes = (DescriptionAttribute[])fi.GetCustomAttributes(typeof(DescriptionAttribute), false);

        if (attributes.Length > 0)
        {
            string s = attributes[0].Description;

            if (!string.IsNullOrEmpty(s))
            {
                desc = s;
            }
        }

        list.Add(new KeyValuePair<string, int>(desc, i));
    }
    // NOTE: It is very important that DisplayMember and ValueMember are set before DataSource.
    //       If you do, this works fine, and the SelectedValue of the ComboBox will be an int
    //       version of the Enum.
    //       If you don't, it will be a KeyValuePair.
    cxbx.DisplayMember = "Key";
    cxbx.ValueMember = "Value";
    cxbx.DataSource = list;
} 
```

并使用上述方法以这种方式将组合框绑定到 myEnum：

```
setEnumValues(comboBox, typeof(myEnum)); 
```

现在的问题是如何将我的组合框项目或值设置为特定的，如下所示：

```
combobox.SelectedValue = myEnum.value; 
```

我的项目是 Visual Studio 2010 环境中的 C# windows 项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:33:54.657

我复制了你的代码，我认为这就是你所拥有的，这对我来说非常好。

```
namespace WindowsFormsApplication1
{
    public class MyClass
    {
        public string Something { get; set; }
        public UserFrienlyEnum foo { get; set; }
    }
    public enum UserFrienlyEnum
    {
        [Description("it need spec training")]
        SPECIAL_TRAINING = 1,
        [Description("it need normal training")]
        NORMAL_TRAINING = 2,
        [Description("it need simple training")]
        SIMPLE_TRAINING = 3
    }
    public partial class Form1 : Form
    {

        private void Form1_Load(object sender, EventArgs e)
        {
            setEnumValues(this.comboBox1, typeof(UserFrienlyEnum));
            MyClass variable = new MyClass();
            variable.foo = UserFrienlyEnum.NORMAL_TRAINING;
            this.comboBox1.SelectedValue = (int)variable.foo;

        }

        public static void setEnumValues(ComboBox cxbx, Type typ)
        {
            if (!typ.IsEnum)
            {
                throw new ArgumentException("Only Enum types can be set");
            }

            List<KeyValuePair<string, int>> list = new List<KeyValuePair<string, int>>();

            foreach (int i in Enum.GetValues(typ))
            {
                string name = Enum.GetName(typ, i);
                string desc = name;
                FieldInfo fi = typ.GetField(name);

                // Get description for enum element
                DescriptionAttribute[] attributes = (DescriptionAttribute[])fi.GetCustomAttributes(typeof(DescriptionAttribute), false);
                if (attributes.Length > 0)
                {
                    string s = attributes[0].Description;
                    if (!string.IsNullOrEmpty(s))
                    {
                        desc = s;
                    }
                }

                list.Add(new KeyValuePair<string, int>(desc, i));
            }
            // NOTE: It is very important that DisplayMember and ValueMember are set before DataSource.
            //       If you do, this works fine, and the SelectedValue of the ComboBox will be an int
            //       version of the Enum.
            //       If you don't, it will be a KeyValuePair.
            cxbx.DisplayMember = "Key";
            cxbx.ValueMember = "Value";
            cxbx.DataSource = list;
        }

        public Form1()
        {
            InitializeComponent();
        }

    }
} 
```

结果：

![在此处输入图像描述](../Images/585a3d6b0485f4d6819abc394980aa13.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:05:54.027

感谢我的朋友 Hanlet，这是最简单的答案：

```
combobox.SelectedValue = (int) myEnum.value; 
```

将其转换为 int 是关键。

# ruby-on-rails - 在 Rails 页面上添加时间显示栏

> ID：12096858
> 
> 赞同：1
> 
> 时间：2012-08-23T17:14:01.857
> 
> 标签：ruby-on-rails

我需要显示基于访问我页面的用户的本地时区的本地时间。最近我将此代码添加到我的`application_controller.rb`文件中：

```
class ApplicationController < ActionController::Base
  protect_from_forgery
  helper_method :date_loaded
  def date_loaded
    Time.now
  end
end 
```

我对 Rails 很陌生，不知道下一步该做什么。我应该将`<%= @date_loader %>`字符串添加到我`application.html.erb`的然后创建一个栏，其中将使用我的`application.css.scss`文件显示时间吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:37:22.520

这似乎是合理的。不过，尚不清楚为什么您需要当前日期的辅助方法。

# c# - 使用正则表达式替换 MS Outlook html 源字符串？

> ID：12096866
> 
> 赞同：6
> 
> 时间：2012-08-23T17:14:20.440
> 
> 标签：c#, .net, html, regex, replace

我有一个应用程序可以读取源 html 并下载电子邮件的所有附件。这很好用，除了 Microsoft Outlook 有一些奇怪的源值，例如......

`<img width="163" height="39" id="Picture_x0020_1" src="cid:image001.png@01CD7F6C.70CD2320" alt="Description: Description: Description: cid:image001.png@01CC6D59.AEF6D270">`

首先，我想将其更改为仅 Attachments\image001.png 作为源。此外，alt 应该只是 image001.png，而不是这么长的奇怪 alt。不知道该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T17:48:06.957

您应该使用正则表达式（我更新了您问题中的标签以反映这一点）：

```
Regex.Replace(text, @"src=""cid:(?<FileName>[^@]+)@[^""]*""", @"src=""Attachments\${FileName}""",
    RegexOptions.IgnoreCase | RegexOptions.CultureInvariant);
Regex.Replace(x, @"alt=""[^.]*cid:(?<FileName>[^@]+)@[^""]*""", @"alt=""${FileName}""",
    RegexOptions.IgnoreCase | RegexOptions.CultureInvariant); 
```

我确信有更有效的方法可以做到这一点，但这就是我能想到的。

# javascript - 同域策略 jQuery

> ID：12096867
> 
> 赞同：2
> 
> 时间：2012-08-23T17:14:22.263
> 
> 标签：javascript, jquery, ajax

我曾问过一个问题，为什么大多数 ajax 解决方案都涉及一些后端语言，如 PHP。

有人告诉我这是因为由于相同的域策略，Web 浏览器不允许完整的 javascript/jquery 解决方案。然而下面的代码绝对运行良好：

```
<script type="text/javascript">
        $(document).ready(function () {
            $("#1").click(function () {

                $.ajax({
                    type: "GET",
                    url: "http://api.wunderground.com/api/ac7e64a2f6e2d440/geolookup/conditions/q/IA/Cedar_Rapids.json",
                    dataType: "jsonp",
                    success: function (parsed_json) {
                        $('div').html("Current temperature in " + parsed_json.current_observation.temp_f);
                        alert(parsed_json.location.city);
                        var location = parsed_json['location']['city'];
                        var temp_f = parsed_json['current_observation']['temp_f'];
                        alert("Current temperature in " + location + " is: " + temp_f);
                    }
                });

            });

        });
</script> 
```

那么这段代码不应该运行吗？我不明白。

谢谢，吉姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:15:47.403

`dataType: "jsonp",`

JSONP 用于绕过同源策略。

这是更多信息的链接 - [http://www.ibm.com/developerworks/library/wa-aj-jsonp1/](http://www.ibm.com/developerworks/library/wa-aj-jsonp1/)

另外，请注意服务器也可以简单地允许访问。这是大多数 3rd 方 API 供应商所做的。- [http://enable-cors.org/](http://enable-cors.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T17:25:14.313

只有 jsonp 请求可以跨域工作。你的做法是对的！

1）您无法访问其他域（例如在 iframe 中）上的 DOM 元素或 JavaScript 对象，请在此处查看我的答案： [如何在另一个框架中创建函数？](https://stackoverflow.com/questions/7617429/how-can-i-create-a-function-in-another-frame/7657264#7657264)

2）我们曾经做过这样的事情（见我的回答）从 JS 到 PHP 并返回。 [JavaScript：如何创建 JSONP？](https://stackoverflow.com/questions/1678214/javascript-how-do-i-create-jsonp/5435042#5435042)

# python - 自动转义 Django 表单错误

> ID：12096868
> 
> 赞同：2
> 
> 时间：2012-08-23T17:14:29.097
> 
> 标签：python, django, django-forms, django-templates

所以我有一个这样的模型：

```
class RegistrationForm(ModelForm):
    username = forms.CharField(error_messages={'required': 'Please enter a <b>username</b>.'}) 
```

在我的模板文件中：

```
{% if registration_form.username.errors %}<li>{{ registration_form.username.errors|escape }}</li>{% endif %} 
```

但它显示如下：

```
Please enter a <b>username</b>. 
```

无论我尝试什么，我都无法关闭自动转义。我试过`{% autoescape off %}{% endautoescape %}`标签，以及`|safe|escape`.

我已经阅读了有关此问题的文档和无数网站，但我尝试的任何方法都没有任何效果。任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:27:22.883

代替：

```
class RegistrationForm(ModelForm):
username = forms.CharField(error_messages={'required': 'Please enter a <b>username</b>.'}) 
```

尝试[mark_safe](https://docs.djangoproject.com/en/dev/ref/utils/#django.utils.safestring.mark_safe)：

```
from django.utils.safestring import mark_safe

class RegistrationForm(ModelForm):
    username = forms.CharField(error_messages={'required': mark_safe('Please enter a <b>username</b>.')}) 
```

# sql - SQL 去掉多余的空格

> ID：12096875
> 
> 赞同：1
> 
> 时间：2012-08-23T17:14:48.807
> 
> 标签：sql

我这里有一些数据是这样的：

```
'US     ' -- (5 spaces) 
```

我有超过 300 条这样的记录，有没有办法摆脱这 5 个空格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T17:18:02.423

您可以使用`RTRIM`and`LTRIM`删除尾随或前导空格。

如果您只是选择记录：

```
SELECT RTRIM(State) AS State
FROM YourTable 
```

如果要更新表以删除空格：

```
UPDATE YourTable 
SET State = RTRIM(State) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:25:09.403

大多数数据库都支持 RTRIM() 或 TRIM() 函数。

您还可以用空字符串替换空格：

```
select replace('abcde   ', ' ', '') 
```

（replace 函数在不同的数据库中可能被称为不同的东西。）

另一种可能性是基础类型是 CHAR 而不是 VARCHAR。在您的示例中，该列可能被声明为`char(7)`而不是`varchar(7)`. 如果是这种情况，则无法删除空格，因为该值被填充为七个字符。

在这种情况下，最好的办法是将定义更改为 varchar(7)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T17:26:50.747

用于`RTRIM`删除字符串后的任何尾随空格。

从 tbl1 中选择 RTRIM(col1)

此外，您可以使用`LTRIM`删除任何前导空白。

据我所知，此功能适用于 SQL Server、Oracle、MySQL 和 PL/SQL。

# php - 如何在代码前后将英尺和英寸添加到小数点？

> ID：12096876
> 
> 赞同：0
> 
> 时间：2012-08-23T17:14:48.963
> 
> 标签：php

我正在使用下面的代码将米转换为英尺。它就像一个魅力，但我想在小数点后添加英寸部分。

**当前输出**

```
6.2 feet 
```

**期望的输出**

```
6 feet 2 inches 
```

或者

```
6'2" 
```

这是代码：

```
<?php
$meters=$dis[height];
$inches_per_meter = 39.3700787;
$inches_total = round($meters * $inches_per_meter); /* round to integer */
$feet = $inches_total / 12 ; /* assumes division truncates result; if not use floor() */
$inches = $inches_total % 12; /* modulus */
echo "(". round($feet,1) .")"; 
?> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T17:20:43.777

小数点后的数字*不是*英寸，因为一英尺有 12 英寸。您要做的是将厘米转换为英寸，然后将英寸转换为英尺和英寸。我这样做如下：

```
<?php

// this is the value you want to convert
$centimetres = $_POST['height']; // 180

// convert centimetres to inches
$inches = round($centimetres/2.54);

// now find the number of feet...
$feet = floor($inches/12);

// ..and then inches
$inches = ($inches%12);

// you now have feet and inches, and can display it however you wish
printf('You are %d feet %d inches tall', $feet, $inches); 
```

# c# - 如何将列表重新附加到 DbSet？

> ID：12096878
> 
> 赞同：1
> 
> 时间：2012-08-23T17:15:00.760
> 
> 标签：c#, .net, entity-framework, ef-code-first, dbcontext

在处理 Code First (EF 4.3) 时，有没有办法使用 a `List<T>`from a `DbSet<T>`，然后将更改保留到列表中？

例如...

```
class Program {
    static void Main(string[] args) {
        Database.SetInitializer(new DropCreateDatabaseAlways<Context>());
        Database.DefaultConnectionFactory = new SqlCeConnectionFactory("System.Data.SqlServerCe.4.0");

        using (Context c = new Context()) {

            // Works
            c.Entities.Add(new Entity());

            // Doesn't work
            List<Entity> entities = c.Entities.ToList();
            entities.Add(new Entity());

            // Somehow attach the new unattached elements?

            c.SaveChanges();

            Console.WriteLine(c.Entities.Count()); // Prints 1
            Console.ReadLine();
        }
    }
}

class Context : DbContext {
    public DbSet<Entity> Entities { get; set; }
}

class Entity {
    public int Id { get; set; }
    public int Foo { get; set; }
} 
```

有没有办法我可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T18:17:23.913

在这个简单的例子中，你可以做这样的事情。

```
foreach(Entity entity in entities)
{
     var entry = c.Entry(entity);

     if (entry.State == EntityState.Detached)
     {
         c.Entities.Add(entry);
     }
} 
```

但是，这可能不适用于更复杂的场景。有几种不同的方法可以解决这个问题。

1.  如果 Id 是从数据库自动分配的，您可以检查 if `Entity.Id == 0`，假设 Id 从 1 开始。
2.  如果您手动分配 Id，则可以查询表以查看 Id 是否不存在。
3.  以某种方式，您决定跟踪哪些记录是事后添加的。这可以通过第二个列表。您可以拥有自己的不映射到数据库的 State 属性。如果您将实体投影到特定于应用程序的模型上，这会更容易。
4.  或者您可以同时将其添加到您的列表和上下文中。

# windows-phone-7 - 如何在 LongListSelector 中禁用 VirtualizingStackPanel？

> ID：12096888
> 
> 赞同：0
> 
> 时间：2012-08-23T17:15:38.590
> 
> 标签：windows-phone-7, windows-phone-7.1

我想在 LongListSelector 中禁用 VirtualizingStackPanel。我试试这个：

```
VirtualizingStackPanel.IsVirtualizing="False" 
```

但不起作用（应用程序崩溃）...

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T10:20:30.173

```
VirtualizingStackPanel.IsVirtualizing="False" 
```

是只读属性。

利用

```
 <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <StackPanel>
            </StackPanel>
        </ItemsPanelTemplate>
    </ListBox.ItemsPanel> 
```

# javascript - 500 错误：没有开启器的关闭标签：/content hogan.js

> ID：12096889
> 
> 赞同：0
> 
> 时间：2012-08-23T17:15:42.710
> 
> 标签：javascript, node.js, mustache, hogan.js

使用此代码段： [https](https://gist.github.com/1854699) ://gist.github.com/1854699 。

我写了这段代码

Base.html：[https ://gist.github.com/3438843](https://gist.github.com/3438843)

index.html：[https ://gist.github.com/3438868](https://gist.github.com/3438868)

但是我得到一个 500 错误，我已经清楚地打开了内容标签。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T23:51:20.487

霍根目前似乎在继承方面遇到了麻烦。

# xcode - 在 xcode 中启用/禁用菜单项

> ID：12096890
> 
> 赞同：0
> 
> 时间：2012-08-23T17:15:42.827
> 
> 标签：xcode, menu

我的应用程序有一个带有一些图形的主窗口和一个用于调整主窗口内容的 hud 面板。我使用一个名为“调整”的菜单标题来调出 hud，并在不再需要时将其隐藏起来。这一切都很好。现在到“简单”的部分。我在“调整”标题下有 2 个项目（这是顶部的第二个标题，索引 = 1）：“显示调整”打开带有所有滑块的（hud）调整面板，“隐藏调整”关闭窗口. 我认为我应该在面板打开之前将“隐藏调整”项变暗，然后在面板关闭之前隐藏“显示调整”项。即使在阅读了所有关于 NSMenu、NSMenuItem 等的信息后，我仍然很难做到这一点。在我的 awakeFromNib 文件中，我有：

```
rootMenu = [NSApp mainMenu];  
[rootMenu setAutoenablesItems:NO];  
[[rootMenu itemWithTag:11] setEnabled:YES];// I set the Tag for "Show .." in IB to 11  
[[rootMenu itemWithTag:12] setEnabled:NO];//  I set the tag for "Hide .." in IB to 12 
```

什么都不做！

在连接到“显示调整”项目的 IBAction“功能”中，我有：

```
[self orderFront:nil]; // which opens the hud 
```

// 但是这个东西不会使第一个下拉菜单项变暗：

```
[[rootMenu itemWithTag:11]  setEnabled:NO];// doesn't do anything  
[[rootMenu itemWithTag:12]  setEnabled:YES];// doesn't do anything  
[[rootMenu itemAtIndex:0]  setEnabled:NO];// dims the "quit" menu - un-guideline-like, I know, I know ! 
```

如果我添加这个：

```
[[rootMenu itemAtIndex:1]  setEnabled:NO]; // both items dim, so I think I'm close ! 
```

我可以调暗两个下拉项目，但当然我只想调暗其中一个！如何引用单个项目？我认为“itemWithTag”会起作用，但到目前为止还没有。

如果有帮助，我需要在 Futurebasic 中执行相当于 MENU 2,1,0 和 MENU 2,2,1 的操作。

（顺便说一句，如果你不知道，我还没有跟上所有这些对象的速度！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T11:59:00.590

我不明白菜单层次结构。我现在意识到下拉菜单是一个子菜单，其中的项目可以这样控制：

```
menuItem = [rootMenu itemAtIndex:1];  
subMenu = [menuItem submenu];  
[[subMenu itemWithTag:11] setEnabled:YES];  
[[subMenu itemWithTag:12] setEnabled:NO]; 
```

# opencpu - 调用opencpu自定义函数返回错误

> ID：12096894
> 
> 赞同：0
> 
> 时间：2012-08-23T17:15:48.380
> 
> 标签：opencpu

我将一个函数 ( `apistatus5`) 上传到一个 opencpu 存储 ( `ropensci_dash`) 中：

[https://public.opencpu.org/R/user/SChamberlain/ropensci_dash/apistatus5/ascii](https://public.opencpu.org/R/user/SChamberlain/ropensci_dash/apistatus5/ascii)

我将函数放入我的用户名 () 下的 opencpu 中的存储中`SChamberlain`，但我不断收到错误消息：

STRING_ELT() 只能应用于“字符向量”，而不是“原始”

opencpu 是否有某种错误检测？该代码在我自己的 R 机器上运行良好，因此我不确定尝试运行时错误在哪里：

[https://public.opencpu.org/R/user/SChamberlain/ropensci_dash/apistatus5/png](https://public.opencpu.org/R/user/SChamberlain/ropensci_dash/apistatus5/png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T18:53:05.370

谢谢，这很有趣。我在本地 R 上遇到了同样的错误：

```
Error in rjson::fromJSON(httr::content(httr::GET("http://api.plos.org/search?q=id:10.1371/journal.pbio.0000012&wt=json"))) : 
STRING_ELT() can only be applied to a 'character vector', not a 'raw' 
```

该`httr::content`函数默认返回一个不喜欢的`raw`向量。`fromJSON`如果您没有收到此错误，这很可能是由于服务器上的 R 包（rjson 或 httr）版本与本地计算机上的不同。我认为您需要更新`httr`并替换`content`为`text_content`. 包装也`RJSONIO`比`rjson`我想象的要好一些。

但是，我意识到这很难调试。我必须考虑一下如何改进这一点。

# java - java中的Matlab相关系数等效函数

> ID：12096895
> 
> 赞同：0
> 
> 时间：2012-08-23T17:15:53.297
> 
> 标签：java, matlab, math

是否有等效于 Matlab 的二维相关系数的函数？我想在 2 个一维数组上使用它。 [http://www.mathworks.com/help/toolbox/images/ref/corr2.html](http://www.mathworks.com/help/toolbox/images/ref/corr2.html)

编辑：我自己的实现

```
//Assume we have the length and averages of both arrays
//double a_average, b_average
double a_val =0;
double b_val = 0;
double a_sum = 0 ;
double b_sum = 0;
double a_stdev = 0;
double b_stdev  = 0;
int size = a.length; // same as b's length
for (int i = 0 ; i < size ; i ++) {
    a_val =(a[i]- a_average);
    b_val =(b[i] -b_average);
    a_sum += a_val;
    b_sum += b_val;
    a_stdev += Math.pow(a_val,2);
    b_stdev += Math.pow(b_val,2);
}

double coefficient = ((a_sum *b_sum)/(a_stdev*b_stdev)) 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T00:28:23.490

假设您的所有数据都已加载到两个数组`A and B`中，您要做的是以下内容。此外，假设您的两个数组长度相等并且没有 NaN 和 Infinity 值。

此外，由于您只有两个数据点，因此您的相关矩阵仅包含一个非对角线值，因此我将其存储为单个双精度值。

```
int i;
int len = A.length;
double correlation;
double XX = 0; //normally would be an outer-product matrix
double[] runningSum = new double[2]; //since you have two variables (A and B)
double[] x2 = new double[2];
double[] stdev = new double[2];

for (i = 0; i < length; ++i)
{
   XX += A[i] * B[i];
   x2[0] += Math.Pow(A[i], 2.0);
   x2[1] += Math.Pow(B[i], 2.0);
   runningSum[0] += A[i];
   runningSum[1] += B[i];
}

// Compute mu
runningSum[0] = runningSum[0] / len;
runningSum[1] = runningSum[1] / len;

// Compute std deviation (bias-corrected)
stdev[0] = Math.Sqrt(x2[0] - len * Math.Pow(runningSum[0], 2)) / (len - 1);
stdev[1] = Math.Sqrt(x2[1] - len * Math.Pow(runningSum[1], 2)) / (len - 1);

// now compute correlation coefficient
correlation = (XX - (len * runningSum[0] * runningSum[1])) / (nobs - 1);
correlation = correlation / (stdev[0] * stdev[1]); 
```

这应该会给你你正在寻找的答案。

# python - Tkinter 多重操作

> ID：12096898
> 
> 赞同：1
> 
> 时间：2012-08-23T17:16:01.083
> 
> 标签：python, user-interface, button, tkinter, frame

我的问题与此类似：[Python TKinter multiple operations](https://stackoverflow.com/questions/8545478/python-tkinter-multiple-operations)。但是，提供的答案对我没有帮助，因为它指向了一篇包含可能使用的功能列表的文章。我想看看解决方案的实际实现。

我的问题：我的框架上有两个按钮。只要将切换变量设置为true，一个按钮就会调用“执行”功能。第二个按钮将切换值设置为 False。我希望“执行”功能在按下执行按钮后继续运行，但在按下第二个（切换为假）按钮时停止。但是，一旦我按“执行”，框架就会卡住。我理解它是因为回调。我怎样才能解决这个问题？这是我的示例代码：

```
from Tkinter import *
from time import sleep

class App:

    def __init__(self, master):

        self.toggle = False
        frame = Frame(master)
        frame.pack()

        self.exeButton = Button(frame, text="Execute", fg="blue", command=self.execute)
        self.exeButton.pack(side=LEFT)

        self.tOffButton = Button(frame, text="Toggle Off", command=self.toggleOff)
        self.tOffButton.pack(side=LEFT)

    def execute(self):
        self.toggle = True
        while(self.toggle):
            print "hi there, everyone!"
            sleep(2)

    def toggleOff(self):
    self.toggle = False

root = Tk()
app = App(root)
root.mainloop() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T17:31:17.990

简短的回答，你不能完全按照你的意愿去做。Tkinter 是单线程的——当你调用`sleep(2)`它时，它会完全按照你的要求去做：它会休眠。

如果您的目标是在布尔标志设置为 True 的情况下每 2 秒执行一次，您可以使用[after](http://effbot.org/tkinterbook/widget.htm#Tkinter.Widget.after-method)来安排将来运行的作业。如果该作业还使用 after 来（重新）调度自身，那么您实际上创建了一个无限循环，其中实际的循环机制是事件循环本身。

我已经获取了您的代码并进行了一些细微的修改，以向您展示如何连续执行某些操作，直到一个标志告诉它停止。我冒昧地将“切换”重命名为“运行”以使其更容易理解。我也只使用一种方法来打开和关闭执行。

```
from Tkinter import *
from time import sleep

class App:

    def __init__(self, master):

        self.master = master
        self.running = False
        frame = Frame(master)
        frame.pack()

        self.exeButton = Button(frame, text="Execute", fg="blue", 
            command=lambda: self.execute(True))
        self.exeButton.pack(side=LEFT)

        self.tOffButton = Button(frame, text="Toggle Off", 
            command=lambda: self.execute(False))
        self.tOffButton.pack(side=LEFT)

    def execute(self, running=None):
        if running is not None:
            self.running = running
        if self.running:
            print "hi there, everyone!"
            self.master.after(2000, self.execute)

root = Tk()
app = App(root)
root.mainloop() 
```

# oop - 糟糕的 OOP 有很多只有 1 或 2 个方法的类

> ID：12096899
> 
> 赞同：9
> 
> 时间：2012-08-23T17:16:03.373
> 
> 标签：oop, design-patterns

如果你有很多类，其中只有 1 或 2 个方法，这是否是糟糕设计的标志？

我正在尝试学习 OOP 设计并创建了一个小型应用程序（很小）。

它最终得到了很多实现接口的类，这些接口只包含 1 或 2 个方法。

分离的感觉很好，但是类的方法太少似乎很糟糕。

我知道每种情况都会有所不同，但从一般角度来看这很糟糕吗？

应用程序的一小部分决定了喂狗的时间表（我知道跛脚）：

所以我试图在这里实现策略模式：

```
class DogFeedController
{
    protected $strategy = null;

    public function __construct(iDogFeedStrategy $strategy) {
        $this->strategy = $strategy;
    }

    public function getFeedingSchedule() {
        $morningFeeds = $this->strategy->generateMorningFeeds();
        $eveningFeeds = $this->strategy->generateEveningFeeds();       
    }

}

class GeneralFeedStrategy implements iDogFeedStrategy
{
    public function generateMorningFeeds() {
        //do stuff here
    }

    public function generateEveningFeeds() {
        //do stuff here
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T17:29:16.820

如果太多，您必须自己衡量。OOP 是一种以有意义且真实的方式分离逻辑的好方法，但它也可能达到对可维护性产生负面影响的程度，并且在那时它被错误地应用。

想想应用程序的去向。它总是会是一个小应用程序吗？如果是这样，您不需要创建很多非常通用的接口。尝试将它们结合起来，如果只有一个类实现了接口，你也许可以完全删除接口。

如果您预计您的应用程序将大幅增长，那么这些接口实际上可能会帮助您在未来维护和添加功能。例如，如果您创建了一个应用程序来管理一个只有汽车停车位的停车场，如果您预计会增长到不同类型的车辆（例如摩托车只占用一半停车位），您可能希望创建一个通用汽车界面。也就是说，您不应该试图在项目开始时涵盖所有可能的需求变化，并使代码过于抽象。衡量需求变化的风险可以帮助您预测需要抽象哪些代码。

如果您是团队中的软件工程师，请将您的设计绘制成图表并将其展示给您的同事，以征求他们的意见。

最后，小心[代码异味](http://www.codinghorror.com/blog/2006/05/code-smells.html)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-23T18:22:16.230

从一般的角度来看，具有太大或相反太小的类都被认为是一种不好的做法，并被称为所谓的**Code Smells**。我指的两个是**大型类**（又名*God Object*）和**懒惰类**（又名*Freeloader*）。

以下是来自[Wikipedia](http://en.wikipedia.org/wiki/Code_smell)和[Coding Horror](http://www.codinghorror.com/blog/2006/05/code-smells.html)的定义：

> 大类：一个已经变得太大的类。
> 
> 大型类，如长方法，难以阅读、理解和排除故障。类是否包含太多职责？大班可以重组或分成小班吗？

和

> 懒惰类：做得太少的类。
> 
> 课程应该发挥作用。每增加一个类都会增加项目的复杂性。如果您有一个班级没有为自己付出足够的努力，是否可以将其折叠或合并到另一个班级中？

另一方面，面向对象设计有一个原则，称为**接口隔离原则**，它指出“不应强迫客户依赖他们不使用的方法”。在您的情况下，具有较少方法的接口实际上确实符合此原则。

综上所述，您的设计非常正确。具有较少方法的接口是好的，因此实现这些接口的类不必实现所有方法以及它们不使用的方法。至于类，我相信最终它们会变得更大。请记住，实现接口并不意味着您不能拥有比已实现接口中定义的方法更多的方法。也就是说，尝试在那里放置更多逻辑。

更多关于**SOLID**（面向对象的设计原则）的信息，可以在[Wikipedia](http://en.wikipedia.org/wiki/SOLID_(object-oriented_design))上找到。

PS。Code Smells 是糟糕设计的症状，而 SOLID 是治疗方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-23T17:25:20.850

我认为你应该问自己的问题是。这个类是否对它正在做的事情负责？能够识别和分离职责是 OOP 的基石。例如，您可以拥有一个`Security`只有一种方法来创建随机密码的类。

我认为（这是我的观点）如果随机密码仅在寄存器中使用，而不是创建该类的私有方法，我会将该方法分成一个新类`Security`，因为我不认为那是`Register`班级的责任。

此外，由于您的应用程序很小，每个类的方法很少是完全正常的。

* * *

**编辑：**看到你的代码我可以提出一些建议，但请记住，我看不到整个画面。

如果你没有，你应该阅读[MVC 模式](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)，你的应用程序中可能没有视图，但是将控制器与模型分离是一个很好的做法。

你`DogFeedController`似乎是一个控制器和`GeneralFeedStrategy`模型。我喜欢用他们的名字来结束我的班级的名字。例如`UserController`，`UserView`和`UserModel`。我认为这使事情变得清楚，但同样，这是我的观点。

我看不到拥有的意义，`iDogFeedStrategy`但我没有看到整个图片。接口的基本用途是保证一组类，无论它们有多么不同，都具有相同的*API*，并封装了实现接口的每个类的细节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T17:41:29.087

除了关注点分离之外，OOP 的另一个重要方面是类内聚。班级应该“自力更生”，而不是让许多其他东西称之为“吸气剂”，并对信息做一些事情。如果您想要多态行为，或者如果您计划在未来扩展您的应用程序，请创建接口。不要仅仅为了分离而创建接口。如果接口没有被两个或多个子类实现，请摆脱它们。（你也可以使用接口来应用依赖倒置原则，打破依赖循环）

OOP 中的设计决策应始终有意识地解决特定问题。否则，保持简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-19T15:48:28.047

更喜欢大量具有复杂关系的小对象，而不是少数具有简单关系的大对象，因为这有利于可维护性，并且为将来的变化做好准备。

你的设计在我看来非常好，更何况考虑到你现在开始编程，而初学者总是反过来做。

# c++ - 虚拟表真正存储在哪里，为什么我们不能修改它们？

> ID：12096902
> 
> 赞同：0
> 
> 时间：2012-08-23T17:16:10.190
> 
> 标签：c++, security, vtable

我知道 vtables 以只读方式存储在内存中以防止修改。哪个部分恰好存储 vtables？

另一个问题，根据vtables的只读权限，它们是如何在exploit编写过程中被修改的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T17:25:44.450

您从哪里得到 vtable 存储在只读内存中的想法？vtable 实现完全是编译器定义的，不能保证它们是只读的。我会想象在许多实现中它们可能存储在可写内存中，例如如果写保护不可用。

即使 vtable 本身是写保护的，也没有理由不能更改对象实例中的 vtable 指针以指向您选择的看起来像真正 vtable 的内存，并利用它跳转到不同的函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T17:25:29.897

首先，虚方法表是大多数 C++ 编译器的实现细节。*此外，标准没有强制*编译器将虚拟表存储在只读内存中（这很清楚，考虑到 C++ 根本不需要目标硬件架构*具有*只读内存）。因此，并非所有编译器都这样做；其中一些可能会，有些可能不会——即使只读内存可用。

接下来，假设在*某些*系统上，*某些*C++ 编译器使用 vtables 并声明它们以供可执行加载器加载到只读内存中：如果加载器能够将内存状态更改为只读，则在某些体系结构上，程序具有足够的权限也许可以把它改回来。但是，如果内存在物理上是只读的，那么即使是可执行加载程序也无法修改它，因此程序必须存在于 ROM 的某个变体中。这绝对是可能的，在这种情况下（受硬件保护的只读存储器）没有办法恶意覆盖它。

# windows-xp - 将 jre7 更改为 jre5 Windows XP + Java 控制面板

> ID：12096903
> 
> 赞同：1
> 
> 时间：2012-08-23T17:16:10.380
> 
> 标签：windows-xp, version, java

我知道最简单的方法是手动更改`PATH`变量，但如果此更改没有任何区别，可能是什么原因？这是我的系统变量路径：

> C:\Program Files\RSA SecurID Token Common;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;C:\Program Files\Windows Imaging\;C:\Program Files\Rational\ClearCase\bin ;C:\Program Files\Rational\common;C:\WINDOWS\system32\WindowsPowerShell\v1.0;C:\Program Files\QuickTime\QTSystem\;c:\maven-2.0.11\bin\;c:\ jboss\5\bin\;c:\Program Files\Java\jre1.5.0_21\bin\

这是我在 java -version 之后的控制台输出

```
java version "1.7.0_04"
Java(TM) SE Runtime Environment (build 1.7.0_04-b22)
Java HotSpot(TM) Client VM (build 23.0-b21, mixed mode, sharing) 
```

我不知道变量`%SystemRoot%`将这个值存储在哪里，但我没有在系统变量中看到它。

我已经准备好安装了 jre7 和 jre5，但出于可比性的原因，我必须为 jre5 进行更改。这该怎么做？我必须卸载 jre7 并安装 jre5 吗？[Java 控制面板](http://imageshack.us/photo/my-images/820/javacontrolpanel.png)是如何工作的？

我如何使用这个工具，如果我取消选中某些产品会有什么影响？这应该是我网站上的一些简单故障，但我找不到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:16:08.013

在 Java 的更高版本（我认为是 6+）上，Java 安装程序会将名为“java.exe”的可执行文件复制到 Windows 系统文件夹中（例如，c:\windows\system32）。据我所知，可执行文件只是调用它安装的 java 版本。因为它在 Windows 系统文件夹中，所以“java.exe”是在路径上找到的第一件事。Windows 永远不会搜索到足以检查您添加的任何 Java 安装路径。

因此，您可以从 Windows 文件夹中删除可执行文件，或者尝试将 Java 安装文件夹移动到路径上文件夹列表的开头，如下所示：

> **c:\Program Files\Java\jre1.5.0_21\bin\;** C:\Program Files\RSA SecurID Token Common；**%SystemRoot%\system32** ;%SystemRoot%;%SystemRoot%\System32\Wbem;C:\Program Files\Windows Imaging\;C:\Program Files\Rational\ClearCase\bin;C:\Program Files\Rational\common; C:\WINDOWS\system32\WindowsPowerShell\v1.0;C:\Program Files\QuickTime\QTSystem\;c:\maven-2.0.11\bin\;c:\jboss\5\bin\;

我猜在 64 位版本上，可执行文件的位置会有所不同，但搜索“java.exe”应该可以帮助您找到隐藏它们的位置。

# objective-c - PDF编码问题？（目标-c）

> ID：12096904
> 
> 赞同：1
> 
> 时间：2012-08-23T17:16:11.720
> 
> 标签：objective-c, pdf, encoding, character-encoding, annotations

我正在开发一个工具来注释 PDF 并遇到了我认为是编码问题：当用户尝试将日语/阿拉伯语/俄语/等文本保存到文本注释中时，我不确定如何保存它。我一直将它编码为 utf8 并且适用于简单的英文文本，但如果我尝试保存

日本语注釈のテスト</p>

它最终是这样的：

æŠ¥æœ¬èªžæ³¨é⁄‹ã†®ã…ƒã‡¹ã…‹</p>

有没有人遇到过这样的问题？我一直在为此苦苦挣扎，并尝试了几天不同的编码，但无法真正找到解决方案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:09:12.413

您可能需要检查 NSString 编码的类型。这些是可用的[日语编码](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/doc/c_ref/NSJapaneseEUCStringEncoding)

您应该检查源 PDF 包含的编码类型，并相应地对其进行操作（编码/解码）。

# c# - 以横向模式打印当前活动窗口

> ID：12096905
> 
> 赞同：2
> 
> 时间：2012-08-23T17:16:21.110
> 
> 标签：c#, winforms, printing, landscape, powerpacks

我想`WinForm`在 C# 中打印当前活动的。这是我所拥有的：

```
using Microsoft.VisualBasic.PowerPacks.Printing;

PrintForm p = new PrintForm(this);
p.Print(); 
```

这适用于**纵向**模式。如何以**横向**模式打印？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:44:33.210

这行得通吗？

```
PrintForm p = new PrintForm(this);
p.PrinterSettings.DefaultPageSettings.Landscape = true;
p.Print(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:19:44.837

如果您在 VB 中执行此操作，那么您想以 Orientation 为例

如果是 C#，我相信你可以进行转换

```
If p.Height > p.Width 
{
    p.Orientation = 1;//vbPRORPortrait
}
Else
{
    p.Orientation = 2; //vbPRORLandscape
}
p.Print(); 
```

# actionscript-3 - Flex FileReference：在默认位置打开对话框

> ID：12096906
> 
> 赞同：0
> 
> 时间：2012-08-23T17:16:20.820
> 
> 标签：actionscript-3, flash

如何将 FileReference 设置为在默认位置打开浏览？如果默认位置在 C:/test，那么我总是想从 C:/test 打开浏览。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:42:30.317

在纯 AS3.0 中，没有办法，因为由于 Flash 安全沙箱，这是不可能的。

但是，如果您使用的是 Air `File`Class。这是可能的。

在 Adob​​e 论坛中，这里有同样的问题：[FileReference set directory?](http://forums.adobe.com/thread/856695)

[File_Class Adob​​e 文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/filesystem/File.html)

> File.applicationStorageDirectory — 每个已安装的 AIR 应用程序唯一的存储目录
> 
> File.applicationDirectory——安装应用程序的只读目录（连同任何已安装的资产）
> 
> File.desktopDirectory——用户的桌面目录
> 
> File.documentsDirectory——用户的文档目录
> 
> File.userDirectory——用户目录

# r - fitdist 列表问题

> ID：12096907
> 
> 赞同：0
> 
> 时间：2012-08-23T17:16:22.017
> 
> 标签：r, list, extract

我有一个矩阵

结果[i]

带有一些数据（分布参数）：

```
list(structure(c(0.005, 0.004),
.Names = c("mean", "sd"))) 
```

例如。我想使用 fdist 并使用 results[i] 中包含的值作为分布参数的种子：

```
params = fitdist( data, dist,method="mle",
                    start=list(mean =mapply("[", results[1], 1),
                               sd=mapply("[", results[1], 2))) 
```

我收到以下错误：

```
the function mle failed to estimate the parameters, 
            with the error code 100 
```

因为开始列表是：

```
structure(list(mean = structure(0.005, .Names = "mean"), 
sd = structure(0.004, .Names = "sd")), .Names = c("mean","sd")) 
```

它应该是：

```
structure(list(mean = 0.005, sd = 0.004), .Names = c("mean","sd")) 
```

最后的输出来自：

```
params = fitdist( data, dist,method="mle",
                    start=list(mean=0.005,
                               sd=0.004)) 
```

任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:31:08.867

尝试使用“[[”而不是“[”，原因是“[[”将值拉到列表节点，而“[”将值留在列表中。

```
res =list(structure(c(0.005, 0.004),
          .Names = c("mean", "sd")))
list(mean =mapply("[[", res, 1),
                                sd=mapply("[[", res, 2))
$mean
[1] 0.005

$sd
[1] 0.004 
```

（虽然我会使用 sapply。）

```
> list(mean =sapply( res,"[[", 1),
+                                sd=sapply(res,"[[", 2))
$mean
[1] 0.005

$sd
[1] 0.004

> dput( list(mean =sapply( res,"[[", 1),
+                                sd=sapply(res,"[[", 2)) )
structure(list(mean = 0.005, sd = 0.004), .Names = c("mean", 
"sd")) 
```

# actionscript-3 - Flash AS3 键盘事件未触发

> ID：12096909
> 
> 赞同：0
> 
> 时间：2012-08-23T17:16:29.207
> 
> 标签：actionscript-3, flash, events, keylistener, dismiss

我有这样的课：

```
public class GameOverScreen extends MovieClip {
    public function GameOverScreen(useMouseControl:Boolean) {
        if(useMouseControl){
            Mouse.show();
            restartButton.addEventListener(MouseEvent.CLICK, onClickRestart);
        }
        else{
            this.addEventListener(KeyboardEvent.KEY_DOWN, onPushSpace);
        }
    }

    public function onClickRestart(mouseEvent:MouseEvent):void{
        dispatchEvent(new NavigationEvent(NavigationEvent.RESTART));
    }

    public function onPushSpace(keyboardEvent:KeyboardEvent):void{
        trace(keyboardEvent);
        dispatchEvent(new NavigationEvent(NavigationEvent.RESTART));
    }... 
```

这是一个游戏的结束画面。（惊喜！）如果我按下空格键或点击屏幕上的restartButton，我希望它重新开始我的游戏。如您所见，屏幕在构造函数中获得了一个布尔值，它决定我们使用键盘或鼠标来控制游戏。它适用于鼠标，但是使用键，我必须单击**重新启动按钮**（在屏幕上），直到它什么也不做，然后单击它，然后我按下一个按钮，我得到了 playScreen，但是我的 keylistener不知何故仍在工作，如果我按任何键，它会重新启动游戏。

我的主类的重点是：如果玩家死了，他会得到一个gameOverScreen，并且playscreen会被关闭，gameOverScreen也会得到一个监听器，它监听一个名为RESTART的事件，如果该事件被调度，一个新的playScreen是创建，游戏结束。

```
public class Avoider extends MovieClip { ....
     public function onAvatarDeath(avatarEvent:AvatarEvent):void {

        var finalScore:Number = playScreen.getFinalScore();
        var finalTime:Number = playScreen.getFinalTime();

        gameOverScreen = new GameOverScreen(useMouseControl);
        gameOverScreen.addEventListener(NavigationEvent.RESTART, onRequestRestart);
        gameOverScreen.setFinalScore(finalScore);
        gameOverScreen.setFinalTime(finalTime);
        addChild(gameOverScreen);

        playScreen = null;
    }

    public function restartGame():void {
        playScreen = new PlayScreen(useMouseControl);
        playScreen.addEventListener(AvatarEvent.DEAD, onAvatarDeath);
        addChild(playScreen);

        gameOverScreen = null;
    }

    public function onRequestRestart(navigationEvent:NavigationEvent):void {
        restartGame();
    } 
```

我希望它是可以理解的，如果不是，请注意它不干净的地方。谢谢

**更新**

我的 onAddToStage 函数

```
public function onAddToStage(event: Event):void{
    stage.focus = this;
this.addEventListener(KeyboardEvent.KEY_DOWN, onPushSpace);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:28:06.337

尝试将您的关键听众添加到舞台：

```
stage.addEventListener(KeyboardEvent.KEY_DOWN, onPushSpace); 
```

否则，您当前的课程需要成为焦点，这就是为什么只有在您单击它之前才有效。不过，当您的游戏结束屏幕完成时，请务必删除该侦听器。

或者，您可以在加载时（在构造函数中）通过代码为您的游戏提供屏幕焦点：

```
public function GameOverScreen(useMouseControl:Boolean) {
    this.addEventListener(Event.ADDED_TO_STAGE,addedToStage,false,0,true);

    if(useMouseControl){
        Mouse.show();
        restartButton.addEventListener(MouseEvent.CLICK, onClickRestart, false, 0, true);
    }
    else{
        this.addEventListener(KeyboardEvent.KEY_DOWN, onPushSpace, false, 0, true);
    }
}

private function addedToStage(e:Event):void {
    stage.focus = this;
    stage.stageFocusRect = false;  //make sure there's no dumb yellow rectangle
} 
```

还有一个小提示 - 我注意到您在完成后不会从显示列表中删除您的游戏。您将希望这样做以使其真正消失（并删除您的重新启动事件侦听器）。

```
public function restartGame():void {
    playScreen = new PlayScreen(useMouseControl);
    playScreen.addEventListener(AvatarEvent.DEAD, onAvatarDeath);
    addChild(playScreen);

    gameOverScreen.removeEventListener(NavigationEvent.RESTART, onRequestRestart);
    removeChild(gameOverScreen);
    gameOverScreen = null;
} 
```

# maven - 从 Eclipse 将 Artifact 部署到 Nexus

> ID：12096915
> 
> 赞同：4
> 
> 时间：2012-08-23T17:16:46.200
> 
> 标签：maven, maven-2, maven-plugin, m2eclipse, m2e

是否可以使用 M2E 从 Eclipse 运行 mvn deploy？我的 pom.xml 中有 distributionManagement 部分，我的 settings.xml 中配置了服务器，但我无法终生看到我可以在哪里实现该特定目标。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T17:37:03.677

如果你的 pom 的 distributionManagement 部分设置正确并指向你的 Nexus，你只需要运行 Maven

```
deploy 
```

目标。

假设您安装了 m2eclipse Maven Eclipse 插件，右键单击您的项目或 pom，运行方式>Maven 构建并在目标行输入目标“部署”。

如果您没有安装 Maven Eclipse 插件，请添加一个指向您的 Maven 安装的外部工具配置作为它的“位置”和您的项目目录作为它的“工作目录”，并使用“部署”作为它的参数。

# javascript - $.get() 函数中的变量：无法再次访问该函数？

> ID：12096917
> 
> 赞同：0
> 
> 时间：2012-08-23T17:17:08.637
> 
> 标签：javascript, jquery

我还有另一个 javascript/jQuery 的变量范围问题要问...

假设我声明了一个名为 Container 的对象。其中有一个名为 myimage 的变量，它将从某个 xml 文件中读取地址。

```
 Container = function()
 {
   var myimage;
 }

 Container.prototype.readXML = function()
 {
   $.get("assest/xml/images.xml",function(xml)
{
    //Read in URL path from XML file, and store them into memeber variables
    myimage = $(xml).find('background').text();
    //Apply background image into body, and apply css styple into it
    $("body").css('background-image','url(' + myimage + ')');
            //This alert will work
            alert(myimage);
});
            //This alert gives not defined variable
    alert(myimage);
  } 
```

请看两个警报部分。看来我在 Container 对象中定义的这个变量只能在 readXML 函数中工作。但不出来。我不明白为什么会这样。

我确实使用了其他一些符号，比如用 this.myimage 声明并在执行 $.get 函数之前通过将 this 的名称更改为 self 来访问它 var self= this;

但它变得更糟。有时在 get 函数中甚至无法再访问它。

你能帮我解决这个问题吗？我的最终目标是该对象中的一个数组，并从 XML 中读取大量数据，而不是将它们显示为 HTML。如果无法达到我在 Object 中设置的变量，我就无法做到这一点。

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:21:51.263

```
 Container = function()
 {
   var myimage;
 } 
```

应该很可能定义如下。更重要的是，`$.get`它是**异步**的，因此*您不能假设它按照编写的顺序完成每一行代码*。

```
 var Container = function()
 {
   this.myimage = '';
 }

Container.prototype.readXML = function(callback) {
    $.get("assest/xml/images.xml", function(xml) {
        //Read in URL path from XML file, and store them into memeber variables
        this.myimage = $(xml).find('background').text();
        //Apply background image into body, and apply css styple into it
        $("body").css('background-image', 'url(' + this.myimage + ')');
        //This alert will work
        callback(this.myimage);
    });
}​

var instance = new Container();
instance.readXML(function (copy) {
    alert(copy);
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:22:14.187

Javascript 中未在全局范围内声明的所有变量对于声明它们的函数都是局部的。

由于函数是 Javascript 中的对象，因此您可以为它们分配属性。所以，你可以做

```
Container.myimage = $(xml).find('background').text();
//...
alert(Container.myimage); 
```

# mybatis - MyBatis 选择查询

> ID：12096918
> 
> 赞同：1
> 
> 时间：2012-08-23T17:17:14.683
> 
> 标签：mybatis

假设我有一个包含两列的 db 表：first_name 和 last_name 有 50 行，并且我已经在 MyBatis 中创建了所有映射

```
 @Select("SELECT * FROM users")
@Results({
    @Result(property = "firstName", column = "first_name"),
    @Result(property = "lastName", column = "last_name")
})
List<User> findUsers(); 
```

现在，如果我想从 first_name 列中获取第 5 个名称，我该如何迭代 List 并得到它。

预先感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:28:57.727

好吧，一旦您有了用户列表，就很容易了。

```
List<User> users = myService.findUsers();

String my5thName = users.get(4).getFirstName(); 
```

我理解你的问题了吗？

# javascript - 带有子节点的元素的 Javascript 委托

> ID：12096919
> 
> 赞同：1
> 
> 时间：2012-08-23T17:17:15.960
> 
> 标签：javascript, javascript-events

在一个简单的[示例](http://jsfiddle.net/Asvhj/)中，我尝试为元素的一级子级设置委托。当子元素有子元素时，问题就来了。鼠标事件考虑单击的元素（无论级别如何）。

我的解决方案是循环直到到达第一级孩子；但我想知道这是否是最好的方法。

***没有委托点击直接返回一级子级的方法吗？***

**JS**

```
window.onload=function(){
document.getElementById('test').addEventListener('click', function(e){
console.log(e.target);alert(e.target.id);
   }, false);
} 
```

**HTML**

```
<div id="test">
<a href="#" id="first">First</a>
<a href="#" id="second"><b>Second</b></a>
<a href="#" id="third">Third</a>
<a href="#" id="fourth">Fourth</a>
<div id="div">Division</div>
<div id="div2"><span>Division</span></div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T17:30:43.500

如果它只是您之后的第一级元素，您可以检查单击元素的 parentNode 是否为根，无需进一步遍历。否则，您需要遍历根的第一个孩子。就像是：

```
// level0 is the root
level0.addEventListener('click', function(e) {
    var from = e.target || e.srcElement;
    from = from.parentNode === level0 ? from : findFirst(level0,from);
    /** do things **/
}, false);

// traverse up to first child of [root] 
function findFirst(root,el){
  while(true){
   el = el.parentNode;
   if (el && el.parentNode === root){
     return el;
   }
  }
  return null;  
} 
```

这是你的[jsfiddle](http://jsfiddle.net/KooiInc/NMsFk/)的一个分支，使用上面的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T17:28:43.460

仅使用 javascript，您可以使用递归函数来查找具有 id 的第一个父元素：

```
function findParentWithId(element){
    if(element.id){
        return element;
    }

    return findParentWithId(element.parentNode);
} 
```

然后，将它与事件的目标元素一起使用

```
document.getElementById('test').addEventListener('click', function(e){
    console.log(findParentWithId(e.target));alert(findParentWithId(e.target).id);
}, false); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T17:26:31.020

我不确定这里在问什么。默认情况下，事件会*冒泡*（实际上并非如此，默认情况下它们会自上而下遍历），因为它最常作为第三个参数调用`.addEventListener`。`false`

`eventObject.stopPropagation()`您可以通过调用要停止它的节点来阻止大多数事件进一步冒泡。

如果您只想“预过滤”第一级子级，则根本不应该使用委托，而是使用`.querySelectorAll`like查询

```
[].forEach.call( document.querySelectorAll('#test > *'), function( node ) {
    node.addEventListener('click', function( event ) {
        alert( this.id );
    }, false);
}); 
```

这会将 click 事件侦听器绑定到来自`#test`.

看看实际情况：http: [//jsfiddle.net/8Xmn4/](http://jsfiddle.net/8Xmn4/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T17:54:15.913

获取对节点的所有第一级子节点的引用很简单：

```
window.onload=function(){
    document.getElementById('test').addEventListener('click', function(e){
        return document.getElementById('test').children;
    }, false);
} 
```

这以 Firebug 格式输出：

```
[a#first #, a#second #, a#third #, a#fourth #, div#div, div#div] 
```

显然，它返回了孩子和他们各自的孩子，但第一级参考仍然存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T17:27:10.193

```
jQuery(':first-child') use this jquery to get the first child 
```

# database - 使用 Oracle 数据库更改通知检测更改

> ID：12096923
> 
> 赞同：0
> 
> 时间：2012-08-23T17:17:32.350
> 
> 标签：database, oracle, jdbc, change-notification

我正在使用`oracle.jdbc.dcn.DatabaseChangeListener`将插入/更新/删除记录到表中。对于插入，我可以跟踪 rowid。但是，我在更新和删除方面遇到了问题。

对于更新，我正在寻找一种方法来在更新之前找出行/列的值。

对于删除，我得到了被删除的 rowid，但这就是我得到的全部。我想要某种能力来跟踪删除了哪一行。

我正在使用`oracle.jdbc.OracleConnection`.

```
Properties changeNotifProps = new Properties();
changeNotifProps.put(OracleConnection.DCN_IGNORE_DELETEOP,"false");             
changeNotifProps.put(OracleConnection.DCN_IGNORE_INSERTOP, "false");
changeNotifProps.put(OracleConnection.DCN_IGNORE_UPDATEOP , "false");
changeNotifProps.put(OracleConnection.DCN_NOTIFY_CHANGELAG , "0");
changeNotifProps.put(OracleConnection.DCN_NOTIFY_ROWIDS , "true");
changeNotifProps.put(OracleConnection.NTF_LOCAL_HOST , <hostname>);
changeNotifProps.put(OracleConnection.NTF_LOCAL_TCP_PORT , "7115");
return changeNotifProps; 
```

我可以设置某种属性来检测行的先前值吗？

编辑：我忘了提到我在数百张桌子上这样做。我无法添加触发器/表来记录更改。我需要记录 JVM 中的所有更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:32:23.567

创建一个审计表并使用 AFTER INSERT UPDATE DELETE 触发器来填充它。我喜欢记录密钥（您可以在此处记录 ROWID）、时间和日期、用户、SQL 动词（INSERT、UPDATE、DELETE）和适当的值（在 INSERT 和 UPDATE 上使用 NEW 值，使用 OLD记录 DELETE 时的值）。鉴于此，您应该能够从审计表中检索您的值。

分享和享受。

# vb.net - 税收计算器 - Vb.net

> ID：12096925
> 
> 赞同：0
> 
> 时间：2012-08-23T17:17:35.933
> 
> 标签：vb.net

所以我正在制作一个程序，用户输入他的姓名、工作时间、他的工资率和点击次数。然后它将退还以下税款：

总工资 - 税前支付。

FICA - 总工资的 8%。

FTW - 通过将总工资乘以 20% 计算得出。

州所得税 - 工资总额的 2%。

净工资 - 税后总工资。

我试过这个，但它不适合我。Private Sub cmdSubmit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 处理 cmdSubmit.Click

```
 Dim add, add2, add3, add4 As Integer

    add = Val(txtPrice1.Text)
    add2 = Val(txtPrice2.Text)
    add3 = Val(txtPrice3.Text)
    add4 = Val(txtPrice4.Text)

    lblTest.Text = Format(add + add2 + add3 + add4, "currency")
    lblTest2.Text = Format(lblTest.Text * 0.06 + lblTest.Text, "currency")
End Sub 
```

我知道你会使用 .txt 和 Val，但我对如何编程感到困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:22:07.353

您应该尝试使用小数而不是整数。

您应该尝试使用 Decimal.TryParse 而不是 Val()。

您应该尝试使用变量作为总和。

您应该尝试使用变量来计算 0.06 乘数。

```
Dim add, add2, add3, add4 As Decimal

If Not Decimal.TryParse(txtPrice1.Text, add) Then
  MessageBox.Show("Bad Number")
End If
etc...

Dim total As Decimal = add + add2 + add3 + add4
Dim amount As Decimal = (total * 0.06) + total

lblTest.Text = String.Format("{0:C}", total)
lblTest2.Text = String.Format("{0:C}", amount) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-03T15:53:25.537

我建议使用一些常量来帮助清理事情，如果将来它们发生变化，它会更容易改变税率。

```
Const cdecFICA as Decimal = 0.08D
Const cdecFTW as Decimal = 0.20D
Const cdecState as Decimal = 0.02D
Dim decFICA as Decimal
Dim decFTW as Decimal
Dim decState as Decimal
Dim decNetPay as Decimal
Dim decGrossIncome as Decimal

'Use your tryparse statement here'

decGrossIncome = txtHours.text * txtPayRate.text
decFICA = decGrossIncome* cdecFICA
decFTW = decGrossIncome* cdecFTW
decState = decGrossIncome* cdecState
decNetPay = decGrossIncome - decFICA - decFTW - decState 
```

这一切都可以在一条线上完成，但以这种方式设置将允许您显示每个税款总额并以您认为合适的方式使用它们。

我必须创建需要我在其受人尊敬的标签旁边显示所有税值的程序，然后计算税后净收入。

使用小数进行计算很好，因为它包含更多重要的数字来计算，当你显示这个总数时你可以做的就是将最终的十进制数字转换为一个字符串，以使其对最终用户更有意义。如：

```
lblName.text = decNetPay.ToString("C2") 
```

因此它将显示为具有 2 个有效数字的货币值。

编辑：

提交后，我发现这是一个非常古老的线程。=/

# google-app-engine - GAE/JPA/DataNucleus：尝试持久化实体时出现奇怪的异常（IllegalArgumentException：超出字段索引：-1）

> ID：12096928
> 
> 赞同：1
> 
> 时间：2012-08-23T17:17:49.647
> 
> 标签：google-app-engine, jpa, google-cloud-datastore, datanucleus

在我的实体中添加这个嵌入字段后，我遇到了一个异常：

```
@Entity
public class Team extends DataObject
{
    @Embedded
    private TeamEvolution teamEvolution = new TeamEvolution();

    // NEW FIELD:
    @Embedded
    // @AttributeOverrides({ @AttributeOverride(name = "buffer", column = @Column) })
    // @Enumerated
    private ScoutBuffer scoutBuffer;
 ... 
```

这个人很简单：

```
@Embeddable
public class ScoutBuffer 
{
    private static final int BUFFER_SIZE = 150;

    @Basic
    private List<String> buffer;
   ... // from here on there are only methods... 
```

当我尝试合并我的修改时，出现以下异常：

```
java.lang.IllegalArgumentException: out of field index :-1
    at com.olympya.futweb.datamodel.model.ScoutBuffer.jdoProvideField(ScoutBuffer.java)
    at org.datanucleus.state.JDOStateManagerImpl.provideField(JDOStateManagerImpl.java:2585)
    at org.datanucleus.state.JDOStateManagerImpl.provideField(JDOStateManagerImpl.java:2555)
    at org.datanucleus.store.mapped.mapping.CollectionMapping.postUpdate(CollectionMapping.java:185)
    at org.datanucleus.store.mapped.mapping.EmbeddedPCMapping.postUpdate(EmbeddedPCMapping.java:133)
    // etc, etc... 
```

我不认为有什么可做的，但我必须`JDOHelper.makeDirty`在合并实体之前使用它才能感知我修改了`scoutBuffer`：

```
 team.getScoutBuffer().add(playerIds);
   JDOHelper.makeDirty(team, "scoutBuffer");
   em.merge(team); 
```

正如您在代码中看到的那样，我尝试了[此处](http://code.google.com/p/datanucleus-appengine/issues/detail?id=55)描述的解决方法，但没有成功。奇怪的是，那是从 2009 年开始的……顺便说一下，我使用的是 GAE 1.7.0。另外，我尝试清理/重新增强数据模型。

# mysql - 如何从查询本身获取行数（即没有 mysql_num_rows() 或 FOUND_ROWS()）

> ID：12096930
> 
> 赞同：1
> 
> 时间：2012-08-23T17:17:50.253
> 
> 标签：mysql, sql

在 MySQL 中，我需要获取由某些列聚合的行数。这是子查询的一部分，所以我需要查询自己返回结果。

在此示例查询中：

```
mysql> select count(*) from data_cst where target_name_id=208082 and
wafer_id=425845 group by target_name_id,wafer_id,lot_id,data_file_id;

+----------+
| count(*) |
+----------+
|       12 |
|       12 |
|       12 |
|       12 |
+----------+
4 rows in set (0.00 sec) 
```

我需要的结果是 4（即有 4 个不同的 target_name_id、wafer_id、lot_id、data_file_id 组）。我怎么能得到那个？

为了清楚起见，这将是一个子查询，所以事后我不能使用 mysql_num_rows() 或 FOUND_ROWS() 。我需要从查询返回的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:29:11.600

```
select count(distinct lot_id,data_file_id) 
  from data_cst 
 where target_name_id=208082 
   and wafer_id=425845; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:25:11.340

使用嵌套查询。

```
SELECT
  COUNT(*)
FROM
(
  select count(*) AS cnt from data_cst
  where target_name_id=208082 and wafer_id=425845
  group by target_name_id,wafer_id,lot_id,data_file_id
)
  AS data; 
```

# objective-c - NSMutableArray 中的字典数量

> ID：12096935
> 
> 赞同：0
> 
> 时间：2012-08-23T17:18:08.240
> 
> 标签：objective-c, xcode, uitableview

我有一个`NSMutableArray *objectsArray;`包含字典，每个字典`NSDictionary`都有一个`"Name"`以对象名称作为值的字符串（不足为奇）。`UITableView`已按`NSSortDescriptor`名称按升序排序。

现在我需要使用**名称的第一个字母**`section`来访问 TableView ，但我找不到所需的代码：

 **```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {

    /*Return: How many letters from a-z are represented
    as the first letter of the objects name? 
    I.e. If there is no object in the dictionary with name starting with letter B, 
    the number of sections are now 25 if all the other letters are included.*/
    }

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {

   //Return: How many objects are starting with each letter 
```

所以我需要知道如何返回正确的部分和行数？

附言。我还需要做些什么才能使其正常工作，例如在单元格创建过程中`cellForRowAtIndexPath`或在将 传递`objectsArray`给`segue`时`DetailViewController`？

有关应用程序结构的其他信息：

objectsArray 来自带有字典的 plist 数组。使用自定义原型单元格填充表格视图。带有故事板的 Xcode 4.2。适用于 iPhone 5.1 的应用程序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:21:59.960

`NSMutableSet`在排序之前创建一个。让您的比较器在您的集合中存储它在排序时遇到的每个名称的第一个字母。那么部分的数量就是你的集合的大小。这样，您只需支付很少的成本，因为您的比较器无论如何都必须遍历数组。**

# php - Egopay支付网关api回调url没有得到响应

> ID：12096936
> 
> 赞同：2
> 
> 时间：2012-08-23T17:18:30.737
> 
> 标签：php, payment, gateway

我在回调成功 url 中收到此消息**“此参数是必需的 - 'product_id'” 。**

```
<?php
require('EgoPaySci.php');
try {
    $oEgopay = new EgoPaySci(array(
        'store_id'          => 'STORE ID',
        'store_password'    => 'STORE PASSWORD'
    ));
    $sPaymentHash = $oEgopay->createHash(array(
        'amount'    => '3.00',
        'currency'  => 'USD',
        'description' => 'My payment',
        'cf_1' => 'My custom data'
    ));
} catch (EgoPayException $e) {
    die($e->getMessage());
}
?>
<form action="<?php echo EgoPaySci::EGOPAY_PAYMENT_URL; ?>" method="post">    
    <input type="hidden" name="hash" value="<?php echo $sPaymentHash ?>" />
    <input type="submit" value="Confirm Payment" />
</form> 
```

有关详细信息，请查看此[https://www.egopay.com/developers.html](https://www.egopay.com/developers.html)

谢谢

# performance - 确定 PostgreSQL 查询是从磁盘运行还是从内存缓存运行？

> ID：12096937
> 
> 赞同：5
> 
> 时间：2012-08-23T17:18:36.417
> 
> 标签：performance, postgresql, caching, postgresql-9.1

在 Postgres 命令行客户端 psql 中，有没有办法判断查询是从磁盘运行还是从内存缓存运行？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T17:42:52.040

查询永远不会“从磁盘”或“从缓存”运行。查询本身总是在内存中。

但是如果你的意思是你想知道数据是从共享缓冲区还是直接从文件系统中检索的，那么你可以使用

```
explain (analyze on, buffers on, verbose on) 
select .... 
```

然后，执行计划将显示从共享缓冲区中提取了多少块以及从文件系统中提取了多少块。请注意，文件系统的“读取”实际上可能是从缓存返回的，并且文件系统管理自己的缓存（Postgres 依赖的东西）。

# jquery - 如何使用 XMLHttpRequest 将数组发送到服务器

> ID：12096941
> 
> 赞同：11
> 
> 时间：2012-08-23T17:19:16.567
> 
> 标签：jquery, ajax, xmlhttprequest

正如我所知道的，使用 ajax 您可以将数据发送到服务器，但我对发送数组进行发布感到困惑，而`XMLHttpRequest`不是使用任何像 jQuery 这样的库。我的问题是，是否可以发送一个数组来`php`使用`XMLHttpRequest`以及如何`jQuery`将一个数组发送到 php，我的意思是 jQuery 是否做任何额外的工作来将一个数组发送到服务器（php $_POST）？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-23T17:33:45.547

好吧，您只能发送一串字节。“发送数组”是通过序列化（制作对象的字符串表示）数组并发送来完成的。然后，服务器将解析字符串并从中重新构建内存中的对象。

所以发送`[1,2,3]`到 PHP 可能会像这样发生：

```
var a = [1,2,3],
    xmlhttp = new XMLHttpRequest;

xmlhttp.open( "POST", "test.php" );
xmlhttp.setRequestHeader( "Content-Type", "application/json" );
xmlhttp.send( '[1,2,3]' ); //Note that it's a string. 
                          //This manual step could have been replaced with JSON.stringify(a) 
```

测试.php：

```
$data = file_get_contents( "php://input" ); //$data is now the string '[1,2,3]';

$data = json_decode( $data ); //$data is now a php array array(1,2,3) 
```

顺便说一句，使用 jQuery，您只需执行以下操作：

```
$.post( "test.php", JSON.stringify(a) ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T17:26:57.343

这取决于您选择打包数据结构的协议。最常用的两种是 XML 和 JSON。两者都有声明数组的方法：

JSON：`['one thing', 'another thing']`

XML:`<things><thing name='one thing' /><thing name='another thing' /></things>`

并且两者都不需要服务器进行任何重大的额外工作。在许多情况下，它实际上会减少工作量，因为您不需要使用命名约定来区分它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T17:22:07.363

您想发送一个 JSON 对象（可以是一个数组）。[如果您正在使用 php使用 XMLHttpRequest w/o jQuery 将 JSON 数据发送到 PHP，](https://stackoverflow.com/questions/9516019/send-json-data-to-php-using-xmlhttprequest-w-o-jquery)请检查这一点。

更多关于 JSON：http: [//json.org/](http://json.org/)

jQuery JSON 示例：[JQuery 和 JSON](https://stackoverflow.com/questions/1550716/jquery-and-json)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-07T11:18:27.363

另一种方式，如果你想使用*x-www-form-urlencoded*内容类型通过 AJAX 向 PHP 发送数据，你必须这样做：

```
var array = [1, 2, 3];

//variable to concat POST parameters
var params = "";

for(var i = 0; i < array.length; i++){

  params += "array[]=" + array[i] + "&";

}

//Remove the last char which is '&'
params = params.substring(0, params.length -1);

var http = new XMLHttpRequest();

http.open("POST", "http://localhost/your_script.php");

http.onload = function (){

    //if response status is OK
    if(http.status === 200){

        console.log(JSON.parse(http.response));

    }else{

        //handle response if status is not OK

    }

};

//set content type as x-www-form-urlencoded
http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
//send the request with parameters
http.send(params);//params = "array[]=1&array[]=2&array[]=3" 
```

your_script.php：

```
<?php
//check if index "array" on POST is defined
if(isset($_POST["array"])){

    //write a JSON body
    echo json_encode(["message" => "Received"], JSON_FORCE_OBJECT);

} 
```

# java - 使用 Bitbucket 配置 Jenkins

> ID：12096942
> 
> 赞同：3
> 
> 时间：2012-08-23T17:19:30.087
> 
> 标签：java, git, jenkins, bitbucket

我似乎一直试图将 Jenkins（Ubuntu 的 EC2 AWS 实例）与 Bitbucket 链接起来。

每当我尝试构建我的项目（我已经在 J​​enkins 上安装了 git 插件）时，我都会得到......

```
Building in workspace /var/lib/jenkins/jobs/Google adwords/workspace
Checkout:workspace / /var/lib/jenkins/jobs/Google adwords/workspace - hudson.remoting.LocalChannel@2c473996
Using strategy: Default
Cloning the remote Git repository
Cloning repository origin
ERROR: Error cloning remote repo 'origin' : Could not clone git@bitbucket.org:DAVID99WORLD/assessme.git
hudson.plugins.git.GitException: Could not clone git@bitbucket.org:DAVID99WORLD/assessme.git
    at hudson.plugins.git.GitAPI.clone(GitAPI.java:268)
    at hudson.plugins.git.GitSCM$2.invoke(GitSCM.java:1122)
    at hudson.plugins.git.GitSCM$2.invoke(GitSCM.java:1064)
    at hudson.FilePath.act(FilePath.java:842)
    at hudson.FilePath.act(FilePath.java:824)
    at hudson.plugins.git.GitSCM.checkout(GitSCM.java:1064)
    at hudson.model.AbstractProject.checkout(AbstractProject.java:1256)
    at hudson.model.AbstractBuild$AbstractBuildExecution.defaultCheckout(AbstractBuild.java:589)
    at jenkins.scm.SCMCheckoutStrategy.checkout(SCMCheckoutStrategy.java:88)
    at hudson.model.AbstractBuild$AbstractBuildExecution.run(AbstractBuild.java:494)
    at hudson.model.Run.execute(Run.java:1502)
    at hudson.maven.MavenModuleSetBuild.run(MavenModuleSetBuild.java:477)
    at hudson.model.ResourceController.execute(ResourceController.java:88)
    at hudson.model.Executor.run(Executor.java:236)
Caused by: hudson.plugins.git.GitException: Command "git clone --progress -o origin git@bitbucket.org:DAVID99WORLD/assessme.git /var/lib/jenkins/jobs/Google adwords/workspace" returned status code 128:
stdout: Cloning into '/var/lib/jenkins/jobs/Google adwords/workspace'...

stderr: Host key verification failed.
fatal: The remote end hung up unexpectedly 
```

很好 - 看起来它正在尝试通过 ssh 但找不到密钥。所以我正在尝试生成密钥，在`~/.ssh`我有文件的情况下`authorized_keys`，`known_hosts`但根据这里的文档......

[https://confluence.atlassian.com/display/BITBUCKET/How+to+install+a+public+key+on+your+bitbucket+account](https://confluence.atlassian.com/display/BITBUCKET/How+to+install+a+public+key+on+your+bitbucket+account)

我应该在 ~/.ssh 下有一个名为 id_rsa 的文件

我一直在关注文档...

[https://confluence.atlassian.com/display/BITBUCKET/Using+the+SSH+protocol+with+bitbucket](https://confluence.atlassian.com/display/BITBUCKET/Using+the+SSH+protocol+with+bitbucket)

但它看起来几乎完成了一半，或者我错过了将密钥放入正确文件的位置。

首先 - 我的假设是否正确这是一个 ssh 问题？其次，如果是的话，有谁知道如何让密钥匹配，以便詹金斯可以进行拉动和构建？

编辑：我认为这是一个 ssh 问题，因为[Jenkins Build Using Git with Deploy Key](https://stackoverflow.com/questions/11040881/jenkins-build-using-git-with-deploy-key)是相关的，但我使用的是 bitbucket 而不是 github。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T17:27:53.523

您需要生成密钥文件以上传到您的 BitBucket 帐户。从运行 Jenkins 的用户中，执行以下操作：

```
ssh-keygen -t rsa 
```

采用默认密钥文件位置并将密码留空。然后，您将拥有要上传到 BitBucket 的 ~/.ssh/id_rsa.pub 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-06T22:44:58.930

我正在阅读这篇文章，因为我遇到了同样的问题，并且我现在发现了一些有用的东西。

我的配置我有一个从属构建服务器（Win7-64 机器），我在其中安装了标准 Git（在安装过程中，我选择了第三个选项：“从 Window 命令提示符运行 Git 并包含 Unix 工具”。）Jenkins 配置了 Java网络开始。

我注意到如果我从 Git shell 执行命令

ssh -vT git@bitbucket.org

我可以向接收消息的服务器进行身份验证

您可以使用 git 或 hg 连接到 Bitbucket。外壳访问被禁用。

但是如果我从 cmd 执行相同的命令，我会得到

权限被拒绝（公钥）

我不确定，但我认为 Git 插件从窗口 shell 执行命令，而不是使用 git shell（如我所料），所以这可以确定构建中的身份验证问题。

在[Git Plugin 文档](https://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin)中有一个名为“Some windows fun”的小部分，建议将 .ssh 用户的文件夹复制到 Git 文件夹下（在我的情况下为 C:\Program Files (x86)\Git）。

这样做之后，我从 windows shell 运行 ssh -vT git@bitbucket.org 并且它工作（如果它不工作，尝试重新启动 shell 或整个机器）。然后我从 Jenkins 运行构建，终于成功了。

我希望这会有所帮助。

祝你好运。

# django - 渲染时捕获 ImportError：没有名为 urls 的模块

> ID：12096943
> 
> 赞同：1
> 
> 时间：2012-08-23T17:19:34.663
> 
> 标签：django, importerror

我得到这个错误。

```
Caught ImportError while rendering: No module named urls 
```

它指向他的线。

```
<a href="{% url auth_login %}">{% trans "Log in" %}</a> 
```

我正在使用 django 注册。

我的网址.py

```
urlpatterns = patterns('',
    url(r'^$', direct_to_template, {"template": "home.html",}, name="home"),
    url(r'^accounts/', include('registration.urls')),
) 
```

我已经在 INSTALLED_APPS 中添加了它。

# c# - 可以使用表参数插入，还可以检索标识值吗？

> ID：12096944
> 
> 赞同：2
> 
> 时间：2012-08-23T17:19:38.860
> 
> 标签：c#, sql-server, performance

我正在尝试使用高性能表参数方法（[http://www.altdevblogaday.com/2012/05/16/sql-server-high-performance-inserts/](http://www.altdevblogaday.com/2012/05/16/sql-server-high-performance-inserts/)）插入记录，我很好奇它是否是可以检索我插入的每条记录的标识值。

目前，答案似乎是否定的——我插入数据，然后检索身份值，但它们不匹配。具体来说，它们大约有 75% 的时间不匹配，并且它们不会以不可预知的方式匹配。这是一些复制此问题的代码：

```
// Create a datatable with 100k rows
DataTable dt = new DataTable();
dt.Columns.Add(new DataColumn("item_id", typeof(int)));
dt.Columns.Add(new DataColumn("comment", typeof(string)));
for (int i = 0; i < 100000; i++) {
    dt.Rows.Add(new object[] { 0, i.ToString() });
}

// Insert these records and retrieve back the identity
using (SqlConnection conn = new SqlConnection("Data Source=localhost;Initial Catalog=testdb;Integrated Security=True")) {
    conn.Open();
    using (SqlCommand cmd = new SqlCommand("proc_bulk_insert_test", conn)) {
        cmd.CommandType = CommandType.StoredProcedure;

        // Adding a "structured" parameter allows you to insert tons of data with low overhead
        SqlParameter param = new SqlParameter("@mytable", SqlDbType.Structured);
        param.Value = dt;
        cmd.Parameters.Add(param);
        SqlDataReader dr = cmd.ExecuteReader();

        // Set all the records' identity values
        int i = 0;
        while (dr.Read()) {
            dt.Rows[i].ItemArray = new object[] { dr.GetInt32(0), dt.Rows[i].ItemArray[1] };
            i++;
        }
        dr.Close();
    }

    // Do all the records' ID numbers match what I received back from the database?
    using (SqlCommand cmd = new SqlCommand("SELECT * FROM bulk_insert_test WHERE item_id >= @base_identity ORDER BY item_id ASC", conn)) {
        cmd.Parameters.AddWithValue("@base_identity", (int)dt.Rows[0].ItemArray[0]);
        SqlDataReader dr = cmd.ExecuteReader();
        DataTable dtresult = new DataTable();
        dtresult.Load(dr);
    }
} 
```

使用此 SQL 服务器脚本定义数据库：

```
CREATE TABLE bulk_insert_test (
    item_id int IDENTITY (1, 1) NOT NULL PRIMARY KEY,
    comment varchar(20)
)
GO

CREATE TYPE bulk_insert_table_type AS TABLE ( item_id int, comment varchar(20) )
GO

CREATE PROCEDURE proc_bulk_insert_test
    @mytable bulk_insert_table_type READONLY
AS

DECLARE @TableOfIdentities TABLE (IdentValue INT)

INSERT INTO bulk_insert_test (comment)
OUTPUT Inserted.item_id INTO @TableOfIdentities(IdentValue)
SELECT comment FROM @mytable

SELECT * FROM @TableOfIdentities 
```

这就是问题所在：从返回的值`proc_bulk_insert_test`与插入原始记录的顺序不同。因此，我不能以编程方式为每条记录分配`item_id`我从`OUTPUT`语句中收到的值。

似乎唯一有效的解决方案是`SELECT`支持我刚刚插入的整个记录​​列表，但坦率地说，我更喜欢任何能够减少通过 SQL Server 网卡传输的数据量的解决方案。有没有人在检索身份值的同时对大型插入有更好的解决方案？

编辑：让我尝试进一步澄清这个问题。问题是我希望我的 C# 程序了解 SQL Server 分配给我刚刚插入的数据的标识值。顺序不是必需的；但我希望能够在 C# 中获取任意记录集，使用快速表参数方法插入它们，然后在 C# 中分配它们自动生成的 ID 号，而无需将整个表重新查询回内存。

鉴于这是一个人工测试集，我试图将其压缩成尽可能小的可读代码。让我描述一下我用来解决这个问题的方法：

1.  在我的原始代码中，在这个示例来自的应用程序中，我将使用 1500 万条单独的插入语句插入大约 1500 万行，并在每次插入后取回标识值。这工作但很慢。
2.  我使用高性能表参数修改了代码进行插入。然后我将在 C# 中处理所有对象，并从数据库中读回整个对象。然而，原始记录有几十列，其中包含大量的 varchar 和十进制值，因此这种方法非常耗费网络流量，尽管它速度快且有效。
3.  我现在开始研究以确定是否可以使用表参数插入，同时要求 SQL Server 只报告标识值。我尝试过`scope_identity()`，`OUTPUT`但到目前为止都没有成功。

基本上，如果 SQL Server 总是按照我提供的顺序插入记录，这个问题就会得到解决。是否可以按照表值参数插入中提供的顺序使 SQL 服务器插入记录？

EDIT2：这种方法似乎与 Cade Roux 在下面引用的非常相似：

[http://www.sqlteam.com/article/using-the-output-clause-to-capture-identity-values-on-multi-row-inserts](http://www.sqlteam.com/article/using-the-output-clause-to-capture-identity-values-on-multi-row-inserts)

但是，在文章中，作者使用了一个神奇的唯一值“ProductNumber”，将插入的信息从“输出”值连接到原始表值参数。如果我的表没有神奇的独特价值，我正在尝试弄清楚如何做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T17:32:41.780

你的 TVP 是一个无序集，就像一张普通的桌子一样。只有当您这样指定时，它才有顺序。您不仅无法在此处指示实际订单，而且您还只是在最后执行了 SELECT *，没有 ORDER BY。你期望这里的顺序是什么？您已经有效地告诉 SQL Server，您不在乎。也就是说，我实现了您的代码，并且以正确的顺序恢复行没有问题。我稍微修改了该过程，以便您实际上可以分辨哪个标识值属于哪个注释：

```
DECLARE @TableOfIdentities TABLE (IdentValue INT, comment varchar(20))

INSERT INTO bulk_insert_test (comment)
OUTPUT Inserted.item_id, Inserted.comment 
INTO @TableOfIdentities(IdentValue, comment)
SELECT comment FROM @mytable

SELECT * FROM @TableOfIdentities 
```

然后我使用这段代码调用它（我们不需要所有的 C#）：

```
DECLARE @t bulk_insert_table_type;
INSERT @t VALUES(5,'foo'),(2,'bar'),(3,'zzz');
SELECT * FROM @t;

EXEC dbo.proc_bulk_insert_test @t; 
```

结果：

```
1   foo
2   bar
3   zzz 
```

如果您想确保输出按照身份分配的顺序（不一定与您的无序 TVP 具有相同的“顺序”），您可以添加`ORDER BY item_id`到过程中的最后一个选择。

如果您想插入到目标表中，以便您的身份值按照对您很重要的顺序排列，那么您有几个选择：

*   向您的 TVP 添加一列并将顺序插入该列，然后使用游标以该顺序遍历行，并一次插入一个。恕我直言，仍然比为每一行调用整个过程更有效。

*   在您的 TVP 中添加一个指示顺序的列，并在插入时使用 ORDER BY。这不能保证，但相对可靠，特别是如果您使用 MAXDOP 1 消除并行性问题。

无论如何，您似乎在 ORDER 上放置了很多相关性。您的订单实际上意味着什么？如果您想为订单添加一些含义，则不应使用 IDENTITY 列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T17:28:28.810

您对此指定 no `ORDER BY`：`SELECT * FROM @TableOfIdentities`因此无法保证订单。如果您希望它们以相同的顺序发送，请对`INNER JOIN`插入的数据执行一个`ORDER BY`与发送行的顺序相匹配的数据。

# android - 在 Android 中使用 ContactsContract 时出现“SQLiteException：没有这样的列：mimetype”

> ID：12096946
> 
> 赞同：2
> 
> 时间：2012-08-23T17:19:46.243
> 
> 标签：android, android-contentprovider, android-contacts, sqlexception, android-contentresolver

我想从 Android 的内部数据库表中删除一个条目`ContactsContract`，即应该从联系人的条目中删除诸如生日之类的事件。

以下代码运行良好，但一些用户（约 1%）会因`SQLException`. 那么我的代码有什么问题，还是只是他们的设备不`ContactsContract`正确支持Android？

```
try {
    ArrayList<Long> rawContactIDs = getRawContactID(o.getID());
    int rawContactCount = rawContactIDs.size();
    for (int r = 0; r < rawContactCount; r++) {
        long rawContactID = rawContactIDs.get(r);
        String where = ContactsContract.Data.MIMETYPE+" = ? AND "+ContactsContract.Data.RAW_CONTACT_ID+" = ? AND "+ContactsContract.CommonDataKinds.Event.TYPE+" = ?";
        String[] selection = new String[] { ContactsContract.CommonDataKinds.Event.CONTENT_ITEM_TYPE, String.valueOf(MY_RAW_CONTACT_ID), String.valueOf(ContactsContract.CommonDataKinds.Event.TYPE_BIRTHDAY) };
        getContentResolver().delete(ContactsContract.Data.CONTENT_URI, where, selection);
    }
}
catch (Exception e) {} 
```

抛出的异常是：

```
android.database.sqlite.SQLiteException: no such column: mimetype: , while
compiling: DELETE FROM data WHERE mimetype = ? AND raw_contact_id = ? AND
data2 = ?
at
android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:158)
at
android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:114)
at
android.content.ContentProviderProxy.delete(ContentProviderNative.java:472)
at android.content.ContentResolver.delete(ContentResolver.java:700)
at ... MY_ACTIVITY ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T11:17:18.643

设备制造商可以更改`ContentProvider`AOSP 随附的 a 的实现。理论上，兼容性测试套件 (CTS) 会捕获这些更改，因此只有不破坏 API 的设备才能在通过 Play 商店交付时运行您的应用程序。

话虽如此...

*   CTS 远未完成
*   如果您故意将您的应用分发到 Play 商店之外，并且有人使用不兼容的设备运行您的应用，则 CTS 不会保护您
*   *如果您无意中*将您的应用程序分发到 Play 商店之外（即您的应用程序已被盗版），并且有人使用不兼容的设备运行您的应用程序，CTS 不会为您提供保护
*   各种设备制造商盗版 Play Store 应用程序本身

因此，当您看到似乎源自操作系统提供`ContentProvider`的问题，但这些问题并不常见和/或出现在无法识别的设备上时，请不要惊慌。在这种情况下，您仍然可以选择以某种方式优雅地失败（通过将失败的调用包装在您自己的异常处理程序中），但您的代码不太可能真的是困难的根源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T17:33:10.377

[ContactsContract API](http://developer.android.com/reference/android/provider/ContactsContract.html)从第5 级开始可用。报告此问题的用户是否可能低于第 5 级（甜甜圈、纸杯蛋糕）？

# mysql - Rails 3 ORDER BY FIELD 和最后

> ID：12096948
> 
> 赞同：4
> 
> 时间：2012-08-23T17:19:52.267
> 
> 标签：mysql, ruby-on-rails, activerecord, sql-order-by, ruby-on-rails-3.2

您好，我对 Rails 3.2 和订购有疑问。

当想按字段排序集合时，调用`.last` `ActiveRecord`行为很奇怪......

```
 >> User.order("FIELD(id, '1')")
   User Load (0.4ms)  SELECT `users`.* FROM `users` ORDER BY FIELD(id, '1')
   => []
   >> User.order("FIELD(id, '1')").first
   User Load (0.4ms)  SELECT `users`.* FROM `users` ORDER BY FIELD(id, '1') LIMIT 1
   => nil
   >> User.order("FIELD(id, '1')").last
   User Load (0.3ms)  SELECT `users`.* FROM `users` ORDER BY FIELD(id DESC, '1') DESC LIMIT 1
   Mysql2::Error: You have an error in your SQL syntax; 
```

如您所见，在关系上调用 last`DESC`两次 add ，但它应该只将其放在整个 之后`ORDER BY FIELD`，而不是放在括号内。

有谁知道怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:34:56.687

这是因为ActiveRecord方法`FIELD`不支持该功能。`order`使用 order 方法会将逗号解析为字段分隔符，并`DESC`在您调用`last`.

作为替代方案，您可以避免使用 FIELD()，或者避免使用`last`并仅提供正向和反向范围

```
scope :forward_order, order("FIELD(id, '1') ASC")
scope :reverse_order, order("FIELD(id, '1') DESC") 
```

然后你可以使用`User.reverse_order.first`代替`User.order(...).last`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-04T18:17:30.670

这很旧，但我今天遇到了这个问题，并找到了一种不需要使用额外范围的解决方法。

创建一个 SQL 函数来包装对 的调用`FIELD`，这样在对 的调用中将没有逗号`order`。这是 PostgreSQL，但翻译很简单：

```
CREATE FUNCTION field1(value text) RETURNS text AS $$
BEGIN
  RETURN FIELD(value, 1);
END;
$$ LANGUAGE plpgsql IMMUTABLE 
```

现在调用`last`ActiveRecord 可以：

```
User.order('field1(id)').last 
```

# php - 变量不会排列

> ID：12096951
> 
> 赞同：0
> 
> 时间：2012-08-23T17:19:59.787
> 
> 标签：php, arrays

我遇到了数组问题，这是我的代码：

```
$random_string = array();
for($i=0;$i<10;$i++)
{
$zmienna = generatePassword();
//echo $zmienna;
if (in_array($zmienna, $random_string))
$random_string[$i] = $zmienna;
}

var_dump($random_string); 
```

在屏幕上我看到了 olny

```
array(0) { } 
```

怎么了？因为我确信`generatePassword();`工作得很好

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T17:21:40.363

这条线失败了。

```
if (in_array($zmienna, $random_string)) 
```

`$random_string`是空的，所以`$zmienna`永远不会“进入”它。

我认为您可能打算在其中放置一个 NOT 运算符？如果它不在数组中，添加它？如果是这样：

```
if (!in_array($zmienna, $random_string)) 
```

此外，您的数组将跳过一些键。你最终会得到类似的东西

```
array(3) {
  [0]=>
  string(1) "a"
  [2]=>
  string(1) "b"
  [4]=>
  string(1) "c"
} 
```

如果您不使用`$i`(just do `$random_string[] = $zmienna;`) 指定索引，它将自动执行键，因此您得到

```
array(3) {
  [0]=>
  string(1) "a"
  [1]=>
  string(1) "b"
  [2]=>
  string(1) "c"
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T17:21:52.387

这段代码：

```
if (in_array($zmienna, $random_string)) 
    $random_string[$i] = $zmienna; 
```

如果它已经在那里，`$zmienna`将添加；`$random_string`由于它在代码开头是一个空白数组，因此永远不会添加它，因此该数组将保持为空。

你的意思是：

```
if (! in_array($zmienna, $random_string)) { 
```

如果它还没有，哪个会添加它？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T17:24:21.323

In_array 函数始终返回 false 在此代码语句中 - 它不添加到数组中，只是检查。这就是为什么他是错误的。

# php - 使用 joomla.2.5 在 ubuntu 12.04 上新安装 php、mysql、apache 的错误消息

> ID：12096955
> 
> 赞同：0
> 
> 时间：2012-08-23T17:20:09.083
> 
> 标签：php, ubuntu, joomla, joomla2.5, ubuntu-12.04

我已经在 ubuntu 12.04 系统上安装了 apache、php 和 mysql，并且我设法运行了一个 helloworld.php。该文件位于 /var/www 并且程序运行正确。然后我将一个 joomla 2.5 应用程序从 windows 7 wamp 转移到 ubuntu 12.04，当我运行该应用程序时，我收到以下消息：

> 警告：未知：无法打开流：第 0 行未知中的权限被拒绝致命错误：未知：打开失败所需的“/var/www/offer_e_shop_1/index.php”（include_path='.:/usr/share/php:/ usr/share/pear') 在第 0 行的 Unknown

我还需要提到 mysql 已正确安装在 mysql 中。我需要在这里做什么？哦，我忘了提到这是我阅读的教程 [http://www.howtoforge.com/installing-apache2-with-php5-and-mysql-support-on-ubuntu-12.04-lts-lamp](http://www.howtoforge.com/installing-apache2-with-php5-and-mysql-support-on-ubuntu-12.04-lts-lamp)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:29:52.283

`/var/www`及其子文件夹的默认所有者是用户`root`将其更改为`apache`使用以下命令：

```
sudo chown -R apache /var/www/offer_e_shop_1 
```

如果这不起作用，请尝试完全访问您的代码：

```
sudo chmod -R 777 /var/www/offer_e_shop_1 
```

我个人总是将文件夹位置重置到我的桌面。这是一个有用的教程： [http ://blip.tv/step4wd/ubuntu-apache2-name-hosting_en-5922406](http://blip.tv/step4wd/ubuntu-apache2-name-hosting_en-5922406)

# java - Maven -Dtest=* 测试，似乎没有运行所有测试

> ID：12096960
> 
> 赞同：1
> 
> 时间：2012-08-23T17:20:20.287
> 
> 标签：java, maven, selenium, continuous-integration, maven-surefire-plugin

我有一个 Jenkins CI 服务器，它设置了一个使用 maven-surefire 运行的 Selenium 测试项目。我需要将项目作为参数化构建，以便我可以通过带有 Dtest 作为参数的 URL 触发构建（并且只运行我在 url 中指定的测试）。这很好用。

不幸的是，在这个参数化配置中，我一直无法弄清楚如何运行所有测试。由于它处于参数化构建模式，我必须始终指定 -Dtest 参数。

根据[Surefire 文档](http://maven.apache.org/plugins/maven-surefire-plugin/examples/single-test.html)，似乎我应该能够对测试名称进行通配符，并且一切都会运行：

```
-Dtest=* or -Dtest=Test* 
```

运行这些参数的奇怪结果是来自所有`6`测试的打印语句（我创建的）（表示它们都已启动）：

```
"Test <test_name> started, click here to see the SauceLabs video" 
```

然后是仅 4/6 测试的标准测试结果（下）

```
Running <test_class_path>
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.048 sec 
```

接下来是总结：

```
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0 
```

如果重要的话，测试是使用surefire并行运行的，另外一件奇怪的事情是，在打印出单个测试结果时，在第4个结果之后，第5个结果开始打印，但从未显示结果，并且包括1美元在最后：

```
Running <test_class_path>$1 
```

如果我能澄清任何事情或回答任何问题，请告诉我。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:54:07.727

我认为这是一个常规的表达：

`mvn -Dtest=.*`

为我工作。

# objective-c - 我应该如何为 CATiledLayer 平铺图像？

> ID：12096962
> 
> 赞同：0
> 
> 时间：2012-08-23T17:20:37.980
> 
> 标签：objective-c, ios, image, cocoa-touch, catiledlayer

我知道**如何**平铺图像，我只是不知道图像应该如何显示，大小和东西..

名称应为 Image_size_row_colum，其中一张 Apple 平铺图像为：Lake_125_0_0.png

我使用 TileCutter 平铺图像，但我不知道是否应该将原始图像平铺到 512x512px，然后将原始图像的分辨率从 ≈7000x6000 缩小到 ≈5000x4000，然后将该图像平铺到 512x512px 或其他任何尺寸。 .我只是不明白整个设置..

该类读取如下图像：

```
NSString *tileName = [NSString stringWithFormat:@"%@_%d_%d_%d", 
                                     imageName, (int)(scale * 1000), row, col]; 
```

第一个苹果瓷砖被命名为 Lake_125_0_0.png，这没有给我任何东西..我只是不明白..有人吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:47:10.653

默认情况下，图块始终为 256 到 256 像素（尽管在苹果示例中，图像边界的一些图块被裁剪了）。

Lake_1000_1_2：比例为 1、第 1 行、第 2 列的全分辨率图块。

Lake_500_1_2：半分辨率：图块也是 256 到 256 像素，但您显示的图像区域实际上是 512 到 512 像素（因此您会降低质量）

Lake_250_1_2：四分之一分辨率

Lake_125_1_2：在 256 到 256 像素的瓦片内显示 8*256 到 8*256 像素的原始图像

我希望这有帮助。

# linux - 跟踪命令在 UNIX/LINUX 中花费的时间？

> ID：12096966
> 
> 赞同：117
> 
> 时间：2012-08-23T17:21:15.653
> 
> 标签：linux, unix, command-line, terminal

在 UNIX/LINUX 中，是否有一种简单的方法来跟踪命令所用的时间？

* * *

## 回答 #1

> 赞同：164
> 
> 时间：2012-08-23T17:22:44.397

是的，使用`time <command>`，例如

```
time ls 
```

咨询`man time`更多选项。[链接](http://linux.die.net/man/1/time)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-03-17T10:26:05.423

采用

```
/usr/bin/time 
```

而不是 bash 中内置的时间：它是更可配置的 AFAIK。

```
e.g. /usr/bin/time --format=' \n---- \nelapsed time is %e'ls 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-08-07T18:58:43.493

这是`sleep`一秒的样子，时间为`time`：

```
$ time sleep 1

real    0m1.001s
user    0m0.000s
sys 0m0.000s 
```

# android - 如何通过 selenium webdriver 在 android 上访问基于 webkit 的站点

> ID：12096967
> 
> 赞同：2
> 
> 时间：2012-08-23T17:21:25.420
> 
> 标签：android, sqlite, selenium, webkit, selenium-webdriver

我正在为一个使用 webkit，特别是 sqlite 的网站编写一个自动化测试用例。当我尝试在 Android 设备上使用 Selenium webdriver 执行此操作时，它只会加载一个空白屏幕。

我已将desiredCapabilities 中的“databaseEnabled”设置为True。

我已经能够从同一个 Android 设备的普通 Web 浏览器访问该站点，并在基于 iOS 的设备上使用 webdriver。

如果导航到这个页面可以看到问题：[Database Test Page](http://zdiles.chaosnet.org/dbTest.html "数据库测试页")，来自：[mobilehtml5](http://www.mobilehtml5.com/post/401111526/tutorial-your-first-mobile-html5-app-offline-storage)

当您从普通的 Android 浏览器访问它时，您可以按预期添加分数。如果您尝试对以下 python 代码执行相同操作，则不会对页面进行任何更改：

```
import selenium
from selenium import webdriver

phoneAddress = "http://172.28.0.79:8080/wd/hub"
dbTest = "http://zdiles.chaosnet.org/dbTest.html"

androidDes = webdriver.common.desired_capabilities.DesiredCapabilities.ANDROID
androidDes['databaseEnabled'] = True

driver = webdriver.remote.webdriver.WebDriver(phoneAddress, androidDes)

driver.get(dbTest)

driver.find_element_by_id("email").send_keys("test")
driver.find_element_by_id("upload").click() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T17:52:46.057

这似乎是 android 的 WebDriver 中的错误的结果。有关错误状态的更多详细信息，请参阅：[问题 4494](http://code.google.com/p/selenium/issues/detail?id=4494&thanks=4494&ts=1346429477 "第 4494 期")

# uiviewcontroller - 如何在MainViewController中间添加一个SubViewController

> ID：12096968
> 
> 赞同：3
> 
> 时间：2012-08-23T17:21:26.240
> 
> 标签：uiviewcontroller, modalviewcontroller

我想在主视图控制器中添加一个子视图控制器，但我只想覆盖一个部分，而不是整个屏幕。我想要它在屏幕中间。而且，想知道我是否可以让这个 subviewcontroller 透明，所以我仍然可以看到我的主 viewcontroller 的图像背景。目前，我有我的主视图控制器，并使用这种方式添加另一个视图控制器：

```
MenuAllEntriesViewController *menuAE = [[MenuAllEntriesViewController alloc] init];
[menuAE setModalTransitionStyle:UIModalTransitionStyleCrossDissolve];
[self presentModalViewController:menuAE animated:YES]; 
```

但是我的 subviewcontroller 覆盖了所有屏幕...谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T14:29:44.847

以编程方式执行此操作：首先`UIView`在主视图中添加一个空白。`MainWindowController`还要从您的视图创建一个 IBOutlet 。这将是您的子视图控制器的容器视图。只需将其大小和位置设置为您要显示子视图的位置。

然后在您的`MainWindowController.m`您可以使用以下代码添加一个子视图控制器，其视图显示在您的主视图中的指定视图中：

```
//keep a strong reference to the view controller
self.otherViewController = [[OtherViewController alloc] init]; 
[self addChildViewController:otherViewController];
//set the frame
CGFloat width = containerView.frame.size.width;
CGFloat height = containerView.frame.size.height;
self.otherViewController.view.frame = CGRectMake(0, 0, width, height);
[containerView addSubview:self.otherViewController.view];
[self.otherViewController didMoveToParentViewController:self]; 
```

* * *

如果您使用 Storyboards 并以 iOS 6 为目标，您甚至不需要进行任何编程。在 Storyboard 视图（以前称为 Interface Builder）中，您可以将 a`Container View`从 Objects Library 拖放到您的主视图中。Interface Builder 将自动创建一个子视图控制器，但您也可以将包含 segue 指向任何其他视图控制器。

# php - PHP isnull 第一遍/第二遍标志

> ID：12096986
> 
> 赞同：0
> 
> 时间：2012-08-23T17:22:09.990
> 
> 标签：php, session, reload, isnull

我有一个 PHP 结果页面，它从“第一遍”开始，返回所有行。这是该县所有披萨店的搜索列表。

```
SELECT * from pizzeria; 
```

然后用户可以深入了解更多细节......该页面还有一个 CSS 下拉菜单，用户可以在其中选择特定社区（带有 URL）：

```
href="samepage.php?neighborhood=HELLSKITCHEN" 
```

然后在我拿起后更改查询`$_GET[]`

```
SELECT * from pizzaria WHERE nbh=(the $_GET[] variable sent in the URL); 
```

但我希望页面能够自行调用，并且我`header("Cache-Control:no-cache");`在顶部。

我正在尝试使用该`isnull()`函数创建一个首次通过或首次访问标志变量：

```
if (is_null($firstpass)) {
    $query = SELECT all the records from the pizzaria table
} else {
    $query = SELECT only the records WHERE I $_GET[] the value from the reloaded URL
} 
```

似乎该`$firstpass`变量不会坚持重新加载。我应该 SESSION 那个变量吗？（虽然仍然有不断重置它的问题）

或者也许实施其他一些方法？

我知道我可以重定向到单独的第二页并将 javascript 重定向回此页面以避免“标头已发送”，但我想避免往返返回客户端。

是否有使用新信息重新加载的已知最佳实践？有点新的 PHP 在这里。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:27:17.087

也许我不太了解您的问题，但您为什么不这样做：

```
if (!isset($_GET['example'])) {
    $query = 'SELECT * FROM pizzerias';
} else {
    $query = 'SELECT * FROM pizzerias WHERE pizzeria = \'.mysql_real_escape_string($_GET['example']).\' LIMIT 1';
} 
```

在第一次通过时，似乎 $_GET 变量仅在用户选择比萨店时设置？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:40:16.780

这是一个更有针对性的答案。

**注意：** `mysql_*`功能正在贬值，因此请改用 PDO。在我的示例中，我是半懒惰的，不使用 PDO。

```
//Connect to database and define table up here
...
if(!isset($_GET['neighborhood')){
    $q = "SELECT * FROM pizzeria;";
}else{
    $q = sprintf("SELECT * FROM pizzeria WHERE nbh=%s",mysql_real_escape_string($_GET['neighborhood']));
}
$query = mysql_query($q);
foreach($row = mysql_fetch_array($query,MYSQL_ASSOC){
    //display the updated view of restaurants.
} 
```

我还建议您使用[jQuery](http://jquery.com)来实现 Web 2.0 效果。当您从下拉菜单中选择并且无需重新加载页面的情况下神奇地移动时，这真的很棒。

# c++ - 从受保护的嵌套类继承的公共嵌套类？

> ID：12096990
> 
> 赞同：0
> 
> 时间：2012-08-23T17:22:39.983
> 
> 标签：c++, public, protected, nested-class

为了实现我自己的迭代器，我想实现这样的东西：

```
class MyClass :
{
    public:
        class MyIterator1 {;};
        class MyIterator2 {;};
        class MyIterator3 {;};
}; 
```

由于这些迭代器将共享一些共同的行为，因此如果它们继承自一个名为 的基本迭代器会更好`MyBaseIterator`。但我认为`MyBaseIterator`是实现的一个细节：用户不应该`MyClass::MyBaseIterator`直接使用。以下是否正常：

```
class MyClass :
{
    protected:
        class MyBaseIterator;
    public:
        class MyIterator1 : public MyBaseIterator {;};
        class MyIterator2 : public MyBaseIterator {;};
        class MyIterator3 : public MyBaseIterator {;};
}; 
```

`MyBaseIterator`即使受保护，派生的成员是否对用户可用`MyBaseIterator`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:24:39.450

是的，除非用户扩展`MyClass`. 要完全拒绝访问，请将其设为私有。另外，并不是说你只能`MyBaseIterator`在课堂上做任何有意义的事情（猜你已经知道了）。

此外，要完全隐藏实现细节，您应该查看**pimpl idiom**。

# opencv - OpenCV 无法在其他计算机上打开视频

> ID：12096992
> 
> 赞同：1
> 
> 时间：2012-08-23T17:22:52.890
> 
> 标签：opencv, video-capture, windows-7-x64

我的 x64 项目在我的 Windows 7 机器上运行良好，无论是运行已部署版本还是在 Visual Studio 10 中运行。现在，我使用了另外 4 台具有 x64 Windows 7 平台的机器并尝试在它们上安装，但是那些那些工作正常，除了必须捕获视频的代码总是无法加载。

该位是典型的 openCV 视频捕获位：

```
cap = VideoCapture(file);
if (!cap.isOpened ())
{
  cerr << "I have failed!" << endl;
  return 0;
} 
```

当用户使用文件对话框选择要加载的文件时，会生成文件变量，如果文件是例如图片，它在所有机器上都可以正常工作，因此这不是原因。

也许生成的安装程序不包含必要的库或类似的东西。我真的不知道。

干杯，维利乌斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T12:39:22.267

好的，因为我怀疑安装程序包中缺少一些库，所以一旦我将编译后的 OpenCV 复制到另一台计算机并添加了找到它的路径，我就设法加载了视频文件。

由于许多人在未配置 ffmpeg 时加载视频时遇到问题，我手动将此库添加到部署的软件中并解决了问题。因此，问题在于 Visual Studio 没有将 opencv_ffmpeg241_64.dll 库添加到安装程序中。

干杯，维利乌斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T00:28:48.250

在其他机器上，您在安装 OpenCV 时是否配置了 ffmpeg 选项？如果可能，请检查 Cmake 配置列表并在此处打印出来。此外，如果您是直接捕获帧而不是从文件中捕获帧，那么检查您是否为这些计算机正确安装了相应的相机驱动程序也没有什么坏处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T18:32:02.477

如果安装程序正确打包了所有内容，您仍然需要自己处理**编解码器**。

尝试在这些机器上安装编解码器包（K-Lite 编解码器包或其他东西）。

# android - Android 创建浏览器书签

> ID：12096993
> 
> 赞同：2
> 
> 时间：2012-08-23T17:22:52.947
> 
> 标签：android, android-intent, bookmarks

> **可能重复：**
> [从应用程序创建浏览器书签](https://stackoverflow.com/questions/4589062/create-browser-bookmark-from-app)

我尝试使用以下代码为 android 网络浏览器创建书签。

```
public static final void saveBookmark(Context c, String title, String url) {
    Intent i = new Intent(Intent.ACTION_INSERT,
                  android.provider.Browser.BOOKMARKS_URI);
    i.putExtra("title", title);
    i.putExtra("url", url);
    c.startActivity(i);
} 
```

问题是代码不直接保存书签，而是通过一个屏幕提醒用户，他们可以在其中取消或保存书签。如何在不使用“警报屏幕”询问用户的情况下创建书签？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T17:50:59.890

`android.provider.Browser.saveBookmark(c,title,url);`是执行此操作的默认方式，但如果用户启用了这些警报，它可能会显示警报。

Android 框架没有直接的 API 调用来规避这一点。但是，浏览器的书签可以使用 content uri: 的内容提供程序获得`android.provider.Browser.BOOKMARKS_URI`。您可以使用查询对其进行操作，包括向其中添加书签。

要完成这项工作，您需要拥有`com.android.browser.permission.READ_HISTORY_BOOKMARKS`和`com.android.browser.permission.WRITE_HISTORY_BOOKMARKS`权限。

如果你不熟悉内容提供者，你可以在这里阅读他们的介绍：http: [//developer.android.com/guide/topics/providers/content-provider-basics.html](http://developer.android.com/guide/topics/providers/content-provider-basics.html)

# javascript - Javascript 在某些类中更改 HTML

> ID：12096994
> 
> 赞同：0
> 
> 时间：2012-08-23T17:22:54.250
> 
> 标签：javascript, html, css, class, addclass

我正在研究一个当前站点并将其变成一个 drupal 站点。我正在使用之前编写的 Javascript，所以我试图稍微修改它以使其工作。

目前，只要有段落标签，它就会插入一个类。我想对其进行微调，使其仅将类添加到某个 div 类“子菜单”中的段落标记中。有什么建议可以实现吗？

这是当前网站功能： http: [//gattimorrison.com/manufacturers.php](http://gattimorrison.com/manufacturers.php)

JS

```
<script type="text/javascript">
    $(document).ready(function() {
        $(document).find("p").each(function(i) {
            $(this).addClass("imgMa"+i);
            $(this).hover(function() {
                $("#nameMa"+i).addClass("red");
                $("#nameMa"+i).append("<span class='dot'>&nbsp;&nbsp;</span>");
                $(this).removeClass("imgMa"+i);
                $(this).addClass("imgMa"+i+"_on");
            }, function() {
                $("#nameMa"+i).removeClass("red");
                $("span.dot").remove();
                $(this).removeClass("imgMa"+i+"_on");
                $(this).addClass("imgMa"+i);
            });

        });

        $(document).find("li").each(function(i) {
            $(this).hover(function() {
                $(this).addClass("red");
                $(this).append("<span class='dot'>&nbsp;&nbsp;</span>");
                $("#imgMa"+i).removeClass("imgMa"+i);
                $("#imgMa"+i).addClass("imgMa"+i+"_on");
            }, function() {
                $(this).removeClass("red");
                $("span.dot").remove();
                $("#imgMa"+i).removeClass("imgMa"+i+"_on");
                $("#imgMa"+i).addClass("imgMa"+i);
            });

        });

    });
</script> 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:24:39.997

只需更改针对 p 的选择器。

```
$(document).find(".submenu p").each(function(i) { 
```

# javascript - 使用 Fancybox 显示每个 div 的特定内容，

> ID：12096998
> 
> 赞同：0
> 
> 时间：2012-08-23T17:23:22.470
> 
> 标签：javascript, jquery, fancybox

我正在尝试使用 fancybox 为每个 div 加载一个特定的兄弟姐妹。

例如：

```
<div id ="content">
<div class="item1">
<div class="pop-ups"><span>click</span></div>
<div class="hidden"><span>content for item 1</span></div>
</div>
<div class="item2">
<div class="pop-ups"><span>click</span></div>
<div class="hidden"><span>content for item 2</span></div>
</div>
<div class="item3">
<div class="pop-ups"><span>click</span></div>
<div class="hidden"><span>content for item 3</span></div>
</div>
<div class="item4">
<div class="pop-ups"><span>click</span></div>
<div class="hidden"><span>content for item 4</span></div>
</div>
</div> 
```

我尝试使用属性 Content 进行配置，但没有得到它，是否可以为每个特定项目隐藏每个项目？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T17:31:14.563

您可以使用以下代码：

```
$(function(){
   $("div.pop-ups span").click(function(){
      $.fancybox({ content: $(this).parent().next().html() });
   });
}); 
```

这将在fancybox 中显示相关div 的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T06:12:00.517

你可以调用这个函数在fancybox中打开一些特定的div内容。

```
 function OpenDiv(divIDtoopen) //eg. divIDtoopen= #divID //# is must to be prepended to divID for selection 
    {
        $(document).ready(function ()
        {
            $.fancybox.open(
                {
                    href: divtoopen
                }
                );
        }
        );
    } 
```