# StackOverflow 问答 10405000-10405999

# python - Sqlite 2 python 使用 python 临时文件

> ID：10405001
> 
> 赞同：2
> 
> 时间：2012-05-01T22:01:08.187
> 
> 标签：python, sqlite, temporary-files, pysqlite

我在使用存储为 python 临时文件的数据库时遇到了一些来自 sqlite 的奇怪行为。本质上，查询 sqlite_master 表工作正常，但查询另一个表返回：

```
DatabaseError: database disk image is malformed 
```

源数据库存储为 python 临时文件：

```
ntf=tempfile.NamedTemporaryFile(suffix='.gdb') 
```

下面是一个查询函数。

```
def sqliteQ(string,filename):
'''                                                                                                                                                                                                                              
    string= query string                                                                                                                                                                                                             
    filename= string file name                                                                                                                                                                                                       
    '''
    con=sqlite.connect(filename)
    c= con.cursor()
    c.execute(string)
    out=c.fetchall()
    c.close()
    return out 
```

我能够像这样成功地查询数据库：

```
sq=db.sqliteQ("select sql from sqlite_master where type='table' and name='managements'", gdb.name)
In [13]: sq
Out[13]: 'CREATE TABLE managements (path varchar(255), name varchar(255), data varchar(50000), date date, owner varchar(64), password varchar(64), prot text)' 
```

但是以下返回错误：

```
 In[14]: m=db.sqliteQ('select * from managements', gdb.name)
    41     con=sqlite.connect(filename)
     42     c= con.cursor()
---> 43     c.execute(string)
     44     out=c.fetchall()
     45     c.close()

/usr/lib/python2.7/dist-packages/sqlite/main.pyc in execute(self, SQL, *parms)
    242         if len(parms) == 0:
    243             # If there are no paramters, just execute the query.

--> 244             self.rs = self.con.db.execute(SQL)
    245         else:
    246             if len(parms) == 1 and \

DatabaseError: database disk image is malformed 
```

我可以使用 sqlite 命令行工具成功运行这两个查询。任何建议都是最有帮助的。

彼得

更新

好像只有在使用的时候才会遇到这个问题`tempfile`。我正在下载一个 .zip 文件并将随附的 sqlite 数据库读取到并使用此函数`cStringIO`写入：`tempfile`

```
def tGDB (URLo):
    mem=io.StringIO(URLo.read())
    zf=zp.ZipFile(mem)
    ntf=tempfile.NamedTemporaryFile(suffix='.gdb')
    ntf.write(zf.read(zf.namelist()[0]))
    return ntf 
```

我想这可能表明从 zip 到 tempfile 的转换管道存在问题，但很奇怪第一个查询有效而第二个查询无效。

# xcode - 成功检出 svn 文件，但在导航器和源代码控制实用程序区域中均未显示 SCM 状态

> ID：10405005
> 
> 赞同：4
> 
> 时间：2012-05-01T22:01:37.417
> 
> 标签：xcode, xcode4.3

我在本地网络上有一个 Subversion 存储库，其中包含一组文件（我使用版本添加）。

使用 Xcode，我选择了 Checkout 或 Clone Repository，文件成功传输到我的桌面。

但是，当我从签出的文件中打开 Xcode 项目时，Xcode 导航器中的任何文件都没有显示 SCM 状态，实用程序区域中的任何文件也没有源代码控制条目。

如何使 SCM 状态出现？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T22:39:03.450

您必须从 XCode 首选项 -> 下载 -> 组件安装“命令行工具”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-25T15:42:34.610

选择项目根并单击文件->源代码管理->显示工作副本状态

# php - 排序多维数组，大写在小写之前排序

> ID：10405008
> 
> 赞同：1
> 
> 时间：2012-05-01T22:01:51.823
> 
> 标签：php

使用以下内容按屏幕名称对多维数组进行排序：

```
$sortArray = array();

foreach($members as $member){
    foreach($member as $key=>$value){
        if(!isset($sortArray[$key])){
            $sortArray[$key] = array();
        }
        $sortArray[$key][] = $value;
    }
}

$orderby = "screen_name";

array_multisort($sortArray[$orderby],SORT_ASC,$members); 
```

但是大写在小写之前被排序：

**艾伦·布伦达·格雷格**作品

但**弗兰克**先于**丹**

有很多关于排序数组的内容，但我终于使用上面的方法完成了这项工作，想看看是否有一种简单的方法来修复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:08:27.233

[uasort()](http://www.php.net/manual/en/function.uasort.php)应该适合你

```
<?php

// custom sort function
function sort_by_screen_name($a, $b) {

    // compare using lowercase strings only
    $a = strtolower($a['screen_name']);
    $b = strtolower($b['screen_name']);

    if ($a == $b) {
        return 0;
    }

    return ($a < $b) ? -1 : 1;
}

$members = array(
    array('screen_name'=>'Greg'),
    array('screen_name'=>'Allen'),
    array('screen_name'=>'dan'),
    array('screen_name'=>'Brenda'),
);

// uasort() like a boss!
uasort($members, 'sort_by_screen_name');

print_r($members); 
```

输出

```
Array
(
    [1] => Array
        (
            [screen_name] => Allen
        )

    [3] => Array
        (
            [screen_name] => Brenda
        )

    [2] => Array
        (
            [screen_name] => dan
        )

    [0] => Array
        (
            [screen_name] => Greg
        )

) 
```

注意：使用此方法保留原始数组键。如果您想重写密钥，您可以简单地使用`usort()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:10:18.260

您可以`usort()`使用自定义排序功能对其进行排序。如果您想查看它如何适合您自己的自定义详细信息，您可以修改此数据：http: [//codepad.org/b89HwmbM](http://codepad.org/b89HwmbM)

```
$members = array(
  array( "loc" => "Ontario",   "first" => "Bob",  "screen_name" => "fooArt" ),
  array( "loc" => "Atlanta",   "first" => "Sal",  "screen_name" => "TIMMY!" ),
  array( "loc" => "Panama",    "first" => "Mick", "screen_name" => "Analog" ),
  array( "loc" => "Pensacola", "first" => "A",    "screen_name" => "Franky" ),
  array( "loc" => "McPherson", "first" => "Anna", "screen_name" => "annie9" )
);

usort( $members, 'custom_sort' );

function custom_sort( $m1, $m2 ){
  return strtolower( $m1['screen_name'] ) > strtolower( $m2['screen_name'] );
}; 
```

此排序方法的输出如下：

```
Array
(
    [0] => Array
        (
            [loc] => Panama
            [first] => Mick
            [screen_name] => Analog
        )

    [1] => Array
        (
            [loc] => McPherson
            [first] => Anna
            [screen_name] => annie_23
        )

    [2] => Array
        (
            [loc] => Ontario
            [first] => Bob
            [screen_name] => fooArt
        )

    [3] => Array
        (
            [loc] => Pensacola
            [first] => A
            [screen_name] => Franky
        )

    [4] => Array
        (
            [loc] => Atlanta
            [first] => Sal
            [screen_name] => TIMMY!
        )

) 
```

# php - 动态检查 iFrame 是否会损坏？

> ID：10405013
> 
> 赞同：2
> 
> 时间：2012-05-01T22:02:39.147
> 
> 标签：php, javascript, iframe, break

我正在创建一个网站，用户可以在其中输入 URL 并在 iFrame 中显示，简而言之。我知道很多网站都有代码可以突破 iFrames（流行的例子，谷歌）。

有什么方法可以使用**JavaScript 或 PHP**检查给定的 URL 是否会超出 iFrame？

作为旁注，我不介意拍摄网站快照，但我还没有找到现有的足够网站，而且我似乎无法安装 wkhtmltoimage/pdf ......但这是一个不同的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T10:15:10.803

只要 iframe 的 URL 与父级（您的网站）的 URL 不同，iframe 的 JavaScript 就无法访问其父级中的任何内容。

为了使跨域 iframe 通信正常工作，可以使用 HTML5 的**PostMessage**（目前已获得不错的支持）或通过**iframe 的 URL**传递参数。这两种方法都需要父（您的网站）显式拦截来自 iframe 的“调用”并执行任何操作......

总而言之，出于安全原因，来自未知来源的 iframe 不能简单地更改持有 iframe 的父站点。

# ruby-on-rails-3 - 使用 JRuby 和 warbler 构建 .war

> ID：10405018
> 
> 赞同：0
> 
> 时间：2012-05-01T22:03:30.203
> 
> 标签：ruby-on-rails-3, jrubyonrails, jruby-rack

我已经尝试了几个小时将 JRuby Rails 应用程序打包为实际有效的战争，但没有成功......（JRuby 1.6.7，warbler 1.3.5，Rails 3.2.2）

问题 #1：Warbler 似乎喜欢将所有库集中在一个根文件夹中，而不是尊重它们最初来自的子目录。例如，Rails 应用程序本身运行良好，但是当库被引用为

```
require "lib/foo/bar.jar"
require "lib/baz.rb" 
```

请注意， foo/bar.jar 和 baz.rb 实际上存在于 WEB-INF/lib 中，我只是不知道如何配置 Warbler 以将其连接起来，因此需要正常工作。

问题 #2：如果我屈尊将所有要求更改为

```
require "bar.jar"
require "baz.rb" 
```

，如果我构建一个可执行的war文件，一切都很好，但是如果我尝试将war放入Tomcat 6.0.20安装中，应用程序无法初始化：

```
SEVERE: Error: application initialization failed
java.lang.NullPointerException
at org.jruby.RubyInstanceConfig$ArgumentProcessor.processArguments(RubyInstanceConfig.java:711) 
```

再多的谷歌搜索也无法说明问题所在。据推测，战争遗漏了一些东西或以某种方式错误配置，但它是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:28:37.387

我不能肯定这会导致你的错误——但是我记得在 Jruby 和 Rails 3.2.x 之间有一个已知的错误——这显然在 Jruby 1.7 中得到了修复。

我之前曾尝试将 Rails 3.2 与 Jruby 1.6.7 一起使用，但遇到了这个问题： [JIRA-Ticket-JRUBY-3986](https://jira.codehaus.org/browse/JRUBY-3986)

希望这至少能有所帮助

# sql - 数据库连接查询

> ID：10405019
> 
> 赞同：0
> 
> 时间：2012-05-01T22:03:46.187
> 
> 标签：sql, sql-server, sql-server-2005

我遇到了数据库连接查询的问题，我正在寻找帮助我的人。

基本上我有两张表，发票和收据。

发票

```
Invoice ID
Amount
Date_Added 
```

收据

```
ReceiptID
InvoiceID
Amount
Date_Added 
```

问题是我需要生成一个如下所示的表格，但我在 Receipts 中有多个记录，我很确定数据以一种好的方式存储，只是不确定查询是什么。

```
InvoiceID   RecieptID    Amount     Balance     Date_Added
1           0            100.00     100.00      01.05.2012
1           1            100.00     0.00        02.05.2012
2           0            250.00     250.00      03.05.2012
3           0            100.00     350.00      04.05.2012
2           2            100.00     250.00      05.05.2012 
```

这有意义吗？所以它应该按日期顺序排列。如此有效，我可以逐行查看每个日期的情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:34:58.717

设置：

```
USE tempdb;
GO

CREATE TABLE dbo.Invoices
(
  InvoiceID INT,
  Amount DECIMAL(12,2),
  DateAdded SMALLDATETIME
);

CREATE TABLE dbo.Receipts
(
  ReceiptID INT,
  InvoiceID INT,
  Amount DECIMAL(12,2),
  DateAdded SMALLDATETIME
);

SET NOCOUNT ON;

INSERT dbo.Invoices SELECT 1, 100, '20120501'
UNION ALL SELECT 2, 250, '20120503'
UNION ALL SELECT 3, 100, '20120504';

INSERT dbo.Receipts SELECT 1, 1, 100, '20120502'
UNION ALL SELECT 2, 2, 100, '20120505'; 
```

询问：

```
;WITH x AS 
(
  SELECT InvoiceID, ReceiptID, Amount, DateAdded, 
   rn = ROW_NUMBER() OVER (ORDER BY DateAdded)
  FROM
  (
    SELECT InvoiceID, ReceiptID = 0, Amount, DateAdded
    FROM dbo.Invoices -- where clause?
    UNION ALL 
    SELECT InvoiceID, ReceiptID, Amount, DateAdded
    FROM dbo.Receipts -- where clause?
  ) AS y
),
z AS
(
  SELECT xrn = x.rn, x.InvoiceID, x.ReceiptID, x.Amount, x.DateAdded, 
    PlusMinus = CASE WHEN x.ReceiptID > 0 THEN -x.Amount ELSE x.Amount END
    FROM x LEFT OUTER JOIN x AS x2
    ON x.rn = x2.rn + 1
)
SELECT InvoiceID, ReceiptID, Balance = (
  SELECT SUM(COALESCE(PlusMinus, Amount)) 
  FROM z AS z2 
  WHERE z2.xrn <= z.xrn
), Amount, DateAdded
FROM z
ORDER BY DateAdded; 
```

清理：

```
DROP TABLE dbo.Invoices, dbo.Receipts; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-01T22:16:28.307

如果数据库是 oracle，您可以创建一个从 2 个表中选择数据的视图：

```
CREATE VIEW INVOICE_RECPT_VIEW as 
select a.InvoiceID, b.RecieptID, b.Amount, b.Date_Added 
from invoices a, receipts b 
where a.InvoiceID = b.InvoiceID 
order by Date_Added 
```

# java - Java中命令模式的接口

> ID：10405022
> 
> 赞同：6
> 
> 时间：2012-05-01T22:03:55.183
> 
> 标签：java, design-patterns, command-pattern

是否有一个库已经提供了我们在 Java 中的命令模式所需的接口？

例如：

```
 public interface Func1<T,R> { public R execute(T input); }

 public interface Func2<T1,T2,R> { public R execute(T1 input1, T2 input2); }

 public interface Predicate1<T> { public boolean execute(T input); }

 .... 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T22:10:07.420

[Guava](http://code.google.com/p/guava-libraries/)有你的第一个和第三个接口（称为`Function`and `Predicate`）。您的第二个，恕我直言，没有用，因为您只需将 T1 和 T2 组合在一个对象中，并改用第一个接口。

更有趣的是，Guava 还有很多*使用*这两个接口的方法，比如`Iterables.any(Iterable, Predicate)`,`Iterables.transform(Iterable, Function)`等。

# javascript - 从 ajax 响应创建的 div（javascript/mootools）直到整个响应处理完毕后才显示

> ID：10405026
> 
> 赞同：0
> 
> 时间：2012-05-01T22:04:10.627
> 
> 标签：javascript, ajax, mootools

Chrome 18.0.1025.162m Struts 1.x

这是我使用 js/mootools 创建的 div 的基本结构：

```
<div class="track">
 <table>
  <tr>
   <td style="white-space:nowrap; width:1%;">
   <td style="white-space:nowrap; width:1%;">
   <td>
  </tr>
 </table>
 <div>
  <table>
   <tr>
    <td style="width:50%;">
     <fieldset style="height: 244px; ">
      <legend></legend>
       <table>
        <tr>
         <td>
          <img>
         </td>
         <td>
          <table>
           <tr>
            <td class="label"></td>
            <td class="comparable"></td>
           </tr>
           <tr>
            <td class="label"></td>
            <td class="comparable"></td>
           </tr>
           ... 8 more of same
          </table>
         </td>
        </tr>
       </table>
       <table>
        <tr>
         <td style="text-align: center; ">
          <button type="button"></button>
         </td>
        </tr>
       </table>
      </fieldset>
     </td>
     <td>
     ...essentially same as prior td
     </td>
    </tr>
   </table>
 </div>
</div> 
```

相关的CSS：

```
div.track {
 outline:solid thin;
 margin-bottom:10px;
 background-color:#DCEDEA;    
}

td.label {
 text-align:right; 
 white-space:nowrap;
} 
```

'comparable' 只是一个标志，所以我可以在以后找到并可能重新设计它们。

这些结构是在 onreadystatechange 函数中从单个 JSON 响应创建的。其中有 100 多个正在创建，但在它们都准备好然后它们都同时出现之前我什么都看不到。我希望（并且更希望用户看到进度）每个 div 在准备好并添加（使用 mootools Element.inject）到 DOM 后立即显示。如果我逐步使用 Chrome 的开发工具，我会在注入后立即看到 div 的预期行为。

我对 Web 开发还很陌生，所以如果你觉得有必要批评我的方法，我愿意倾听你的想法，但我真的很想对我所看到的行为做出解释。

谢谢。

*编辑*

页面html的基本思想：

```
<body>
 <div id='foo'></ div>
</body> 
```

js的基本思想（onreadystatechange之内）：

```
var jsonObj = JSON.decode(req.responseText);
for (var i = 0; i < jsonObj.objects.length; ++i) {
   getStructure(jsonObj.objects[i]).inject('foo'); //getStructure builds the div above and returns the div element
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:32:27.740

我怀疑 DIV一次显示一个，但*它们*都显示得如此之快，以至于它看起来像是一次发生的。添加`console.log(i);`到该 for 循环并在 DIV 加载时观察您的控制台。您可以使用 Google Chrome 使用 Ctrl+Shift+J 调出控制台，或者在 Firefox 下安装 Firebug 扩展。

* * *

编辑：

在这种情况下，我猜它与浏览器中的显示循环有关。可能类似于（在非常粗略的伪代码中）：

```
while (1) {
    executeJavascript(); // blocks until all javascript is executed, including your loop
    displayPage();
} 
```

因此，您可能会发现此讨论很有用：[如何在我的脚本进行繁重处理时强制浏览器重绘？](https://stackoverflow.com/questions/1209689/how-can-i-force-the-browser-to-redraw-while-my-script-is-doing-some-heavy-proces)

# c++ - 当使用向量作为键时，C++ unordered_map 失败

> ID：10405030
> 
> 赞同：23
> 
> 时间：2012-05-01T22:04:39.807
> 
> 标签：c++, qt, vector, c++11, unordered-map

背景：我来自 Java 世界，对 C++ 或 Qt 还很陌生。

为了使用 unordered_map，我编写了以下简单程序：

```
#include <QtCore/QCoreApplication>
#include <QtCore>
#include <iostream>
#include <stdio.h>
#include <string>
#include <unordered_map>

using std::string;
using std::cout;
using std::endl;
typedef std::vector<float> floatVector;

int main(int argc, char *argv[]) {
    QCoreApplication a(argc, argv);

    floatVector c(10);
    floatVector b(10);

    for (int i = 0; i < 10; i++) {
        c[i] = i + 1;
        b[i] = i * 2;
    }

    std::unordered_map<floatVector, int> map;

    map[b] = 135;
    map[c] = 40;
    map[c] = 32;

    std::cout << "b -> " << map[b] << std::endl;
    std::cout << "c -> " << map[c] << std::endl;
    std::cout << "Contains? -> " << map.size() << std::endl;

    return a.exec();
} 
```

不幸的是，我遇到了以下不鼓舞人心的错误。甚至没有行号。

> :-1: 错误: collect2: ld 返回 1 退出状态

知道问题的根源吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-01T22:13:25.297

§23.2.5，第 3 段说：

> 每个无序关联容器由满足哈希要求 (17.6.3.4) 并充当类型参数值的哈希函数`Key`的函数对象类型以及在类型值上引发等价关系的二元谓词参数化。`Hash``Key``Pred``Key`

使用`vector<float>`as`Key`而不提供显式哈希和等价谓词类型意味着默认值`std::hash<vector<float>>`并将`std::equal_to<vector<float>>`被使用。

`std::equal_to`for 等价关系很好，因为有一个向量的运算符，`==`这就是`std::equal_to`使用的。

但是，没有`std::hash<vector<float>>`专业化，这可能就是您没有向我们展示的链接器错误所说的。您需要提供自己的哈希才能使其正常工作。

编写这种哈希器的一种简单方法是使用[`boost::hash_range`](http://www.boost.org/doc/html/hash/reference.html#boost.hash_range)：

```
template <typename Container> // we can make this generic for any container [1]
struct container_hash {
    std::size_t operator()(Container const& c) const {
        return boost::hash_range(c.begin(), c.end());
    }
}; 
```

然后你可以使用：

```
std::unordered_map<floatVector, int, container_hash<floaVector>> map; 
```

当然，如果您需要在映射中使用不同的相等语义，您需要适当地定义散列和等价关系。

* * *

[1\. 但是，对于无序容器的哈希，请避免这种情况，因为不同的订单会产生不同的哈希，并且无序容器中的顺序不能保证。]

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2018-11-13T15:11:25.643

我发现 R. Martinho Fernandes 的答案不适合竞争性编程，因为大多数时候您必须处理提供的 IDE 并且不能使用外部库，例如`boost`. 如果您想充分利用 STL，可以使用以下方法。

如上所述，您只需要编写一个哈希函数。它应该专门用于存储在向量中的数据类型。以下散列函数假定`int`类型数据：

```
struct VectorHasher {
    int operator()(const vector<int> &V) const {
        int hash = V.size();
        for(auto &i : V) {
            hash ^= i + 0x9e3779b9 + (hash << 6) + (hash >> 2);
        }
        return hash;
    }
}; 
```

请注意，您可以使用任何类型的操作来生成哈希。您只需要发挥创造力，就可以最大限度地减少冲突。例如，`hash^=V[i]`, `hash|=V[i]`,`hash+=V[i]*V[i]`甚至`hash+=(V[i]<<i)*(V[i]<<i)*(V[i]<<i)`都是有效的，直到你的哈希当然不会溢出。

最后要将此哈希函数与您的 一起使用，请`unordered_map`按如下方式对其进行初始化：

```
unordered_map<vector<int>,string,VectorHasher> hashMap; 
```

# javascript - 自定义 ngModel 指令以支持 jquery 插件中的模型->视图绑定

> ID：10405032
> 
> 赞同：4
> 
> 时间：2012-05-01T22:04:58.310
> 
> 标签：javascript, jquery, angularjs

我正在使用用于标签输入的 jquery 插件装饰标准文本输入，它实质上将我的 HTML 中的文本输入替换为一个文本区域，用户可以在该文本区域中编写标签名称并按 Enter 以将它们转换为离散的图形标签。（参见[http://xoxco.com/projects/code/tagsinput/](http://xoxco.com/projects/code/tagsinput/)上的演示）

我在原始文本输入中放置了一个 ngModel 指令。

通过侦听插件中的更改处理程序、从原始文本输入 html 标记解析 ngModel 属性并直接更新范围，我可以通过在标签输入字段中所做的更改来更新范围。

但是，问题是当 Angular 检测到模型中的更改并使用绑定更新视图时，它会在原始文本输入上设置值，这不会导致我可以绑定到知道何时更新插件的任何类型的事件值，因为“更改”仅因用户输入而触发。

有没有办法修改默认的 ngModel 指令行为，让它在处理绑定时触发事件或运行我指定的函数，特别是从模型到视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T22:54:25.070

您需要覆盖 ngModel.$render 函数

```
指令.tabbable = function() {
  返回 {
    要求：'ng-model'，
    链接：功能（范围，元素，属性，ngModel）{
      // 注册 jQuery 小部件
      ngModel.$render = function() {
        // 读取 ngModel.$viewValue 并用它更新 jQuery 小部件。
      }
    }
  };
};

```

# android - 2d 到伪 3d 图形

> ID：10405039
> 
> 赞同：1
> 
> 时间：2012-05-01T22:05:39.857
> 
> 标签：android, graphics, 3d, 2d

我制作了一个简单的程序，它绘制一系列平行线以在画布上制作一个矩形。我想做的是从第一人称样式视图中获取那个矩形并将其转换为看起来像它的 3d。我可以使用 graphics.camera 类 rotateX 来完成此操作，但我更愿意手动完成。

我已经看到了很多获取已知 3d 点并将其转换为屏幕上的 2d 点的示例，但我不确定如何将其应用于我正在做的事情。由于线条是在 2d 中绘制的，因此没有 3d 点可供我转换。

因此，如果线是在 2d 中绘制的：

```
canvas.drawLine(Xstart, Ystart, Xend, Yend, paint); 
```

如何找到新的 Xend 和 Yend 使其看起来像 3d？

# linux - 如何在 Perl 或 shell 脚本中修改 shebang 行？

> ID：10405043
> 
> 赞同：2
> 
> 时间：2012-05-01T22:05:53.550
> 
> 标签：linux, perl, search, scripting, replace

我有很多 Perl 脚本需要更新到所需的一致版本，并且目前有各种版本和标志。所有这些语句都位于脚本的第一行。我在这里运气不佳，显然尝试使用 sed 但有更好的方法吗？

需要编辑的示例行

```
 #!/opt/local/bin/perl5 
```

我尝试了如下的 bash 脚本，但它对我不起作用。

```
#!/bin/bash
echo "Changing Perl headers in the following..." 
for file in $(ls $1*.pl)
do
    echo $file
    sed 's/#!\/opt\/local/bin\/perl5/#![PERL5]/' $file > /dev/null
# Perl Version: PERL5
done 
```

任何有 sed 经验的人的帮助都会很棒！谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T22:19:48.437

使用 Perl 修复您的 Perl 脚本。您可以为正则表达式使用大括号，以避免[倾斜牙签综合症](http://en.wikipedia.org/wiki/Leaning_toothpick_syndrome)。

```
perl -i -pe 's{^#!/opt/local/bin/perl5}{#!/some/new/path}' *.pl 
```

`-i`并`-p`用于就地编辑文件，有点像 sed。有关详细信息，请参阅[perlrun](http://perldoc.perl.org/perlrun.html#Command-Switches)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-06T13:51:21.523

假设你想把 perl5 改成 perl6 试试这个： perl -pi -e 's/perl5/perl6/' $file

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T22:16:21.283

我不确定你想要什么。如果您想编辑所有文件，`$DIR`以便它们的第一行是`#![PERL5]`而不是`#!/opt/local/bin/perl5`，这将做到这一点：

```
sed --in-place '1s:^#!/opt/local/bin/perl5:#![PERL5]:' "$DIR"/*.pl 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T22:35:15.893

要使用 perl 编辑文件，您将使用`-pi`开关。由于您只想更改第一行，因此我正在考虑一种方法来这样做，而不会导致正则表达式更改文件中的任何其他内容。这个小技巧将允许这样做。不确定是否值得付出努力，因为在其他地方不应该真正找到类似 shebang 的字符串。

```
perl -pi.bak -e '
    $x //= s|^#!/opt/local/bin/perl5|#![PERL5]|; 
    undef $x if eof;' *.pl 
```

如果已定义，`//=`操作员将不会尝试执行 RHS `$x`，因此这实际上只会执行一次更改。添加`undef $x`at`eof`将重置下一个文件的变量，导致参数列表中的每个文件都被更改一次。

您可能不需要备份，在这种情况下，您`.bak`将从`-i`交换机中删除。

# c++ - 封装类外的数据

> ID：10405044
> 
> 赞同：2
> 
> 时间：2012-05-01T22:05:58.687
> 
> 标签：c++

我正在编写一些 C++ 函数，这些函数将生成这些函数以后可能会或可能不会处理的数据（但不会在其他任何地方处理）。这些功能是一些更高级别的 GUI 更改的“低级别”。

我目前将这些函数包装在一个单独的命名空间中，并声明了一个静态（内部链接）向量以在向量中包含这些对象（这些对象被定义为一个结构，也包含在命名空间中）。因此，一般结构：

```
namespace Foo
{
    struct Bar
    {
        string data;
    };

    void func1();
    void func2();
    static std::vector<Bar> cachedBars;
} 
```

我真的不需要为此上课，并且对求助于单身人士不感兴趣。这个解决方案是否足够？具体来说，内部链接命名空间范围集合是限制对该集合的访问以及避免所有全局变量陷阱的最佳方法，还是有更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:44:12.457

实际上，我只是将函数的声明放在 .h 中

```
void func1();
void func2(); 
```

以及匿名命名空间下 .cpp 中的隐藏内容。

```
namespace
{
    struct Bar
    {
        string data;
    };

    static std::vector<Bar> cachedBars;
}

void func1() { /* do something */ }
void func2() { /* do something else */ } 
```

这样，func1 和 func2 将可以从任何地方访问，但 Bar 和 cachedBars 只能由 .cpp 中定义的函数访问，因此 func1 和 func2。如果 .cpp 中没有其他内容，则只有 func1 和 func2 能够修改 cachedBars。

以防万一您不知道，匿名命名空间在用于修改可见性时与 static 关键字具有相同的效果。但是，它更强大，因为您几乎可以用它隐藏任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:30:52.960

行。在这种情况下，我通常做的是将`func1()`and`func2()`函数放入`.h`文件中。而静态向量`.cpp`与函数体一起进入内部。

我怀疑您将需要显示`struct Bar`in`.h`文件，因为通常函数会返回或将该结构作为参数。但是如果没有人需要知道这个结构——那么也将它隐藏起来`.cpp`。（也有可能只有指针或引用被传递/返回。然后你可以前向声明它。）

# iphone - 通过动画在 iPhone 中交换文本

> ID：10405045
> 
> 赞同：0
> 
> 时间：2012-05-01T22:06:02.187
> 
> 标签：iphone, objective-c, ios, animation, caanimation

我想在 IOS 应用程序中交换文本以指定帮助文本，我的意思是，我需要显示

```
 for a Xsec - "Touch me"
 and then 
    for Xsec - "double tap". 
```

是否可以使用 CABasicAnimation？文本需要以闪烁模式显示，在我绘制后立即绘制一个正方形。所以我需要让一个文本闪烁 60 秒，每个文本显示 10 秒

```
The CAAnimation will take 60sec
0-10sec - "Touch me"  
11-20sec - "double tap"
21-30sec - "Touch me"
....
51-60sec - "Double Tap" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:14:12.470

据我所知，文本不是任何对象（UILabel、UITextView 等）的动画属性，但有许多控件可用于子类化这些对象并允许动画文本（以及其他属性）。例如，[AUIAnimateableText](http://cocoacontrols.com/platforms/ios/controls/auianimatedtext)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:14:52.807

不确定我是否理解你的问题，但我会尝试一下。

要更改用户看到的内容的文本，您需要先将其连接为 iboutlet。要更改文本，只需执行以下操作：

```
if ([myTextOutlet.text isEqualToString:@"Touch me"])
{
    myTextOutlet.text = @"double tap";
}
else
{
    myTextOutlet.text = @"Touch me";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T23:01:48.897

为了实现接近实际为文本设置动画的效果，您可以在 2 `UILabel`s 中包含所需的文本并为其`hidden`属性设置动画。你可以做很多事情，只是淡入淡出，甚至翻转标签或向左/向右滑动等。如果你想要打字机效果，你可以`UILabel`在代码中创建适当的 s 并让它们出现等。

至于时间，只需使用易于使用且有据可查的`NSTimer`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T04:56:38.167

试试这个。，。

在这里，我正在更改标签文本，..，

在 viewdidload 中有一个计时器。,.,

```
 - (void)viewDidLoad
  {
  label =[[UILabel alloc]initWithFrame:CGRectMake(367, 664, 220, 21)];
  [label setText:@"Touch me"];
  [label setBackgroundColor:[UIColor redColor]];
  [label setTextColor:[UIColor blueColor]];
  [self.view addSubview:label];
 timer=[NSTimer scheduledTimerWithTimeInterval:5.0 target:self selector:@selector(loadtimer:) userInfo:nil repeats:YES];
   }

  int k=0;
  -(void)loadtimer:(id)sender
   {
   label.text=(k%2) ? @"Touch me" : @"double tap";
   [label setTextColor:( k% 2) ?[UIColor blueColor ]:[UIColor redColor]];
   [label setBackgroundColor:( k% 2) ?[UIColor redColor ]:[UIColor blueColor]];
   CATransition *transition1 = [CATransition animation];
   transition1.duration = 1.0f;
   transition1.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
   transition1.type = kCATransitionFade;
   [label.layer addAnimation:transition1 forKey:nil];
   k++;
  } 
```

调用此 Loadtimer 方法。，取决于计时周期。每 5 秒调用 LoadTimer 方法，该方法更改标签的文本，..，

我在学习。，。，

# c# - 多线程 RPC 超时并使用 RabbitMQ 重新发送

> ID：10405047
> 
> 赞同：1
> 
> 时间：2012-05-01T22:06:05.437
> 
> 标签：c#, mapreduce, rabbitmq

我想做的是一个 Map/Reduce 系统，它使用 RabbitMQ 作为往返于工作代理的传输，这是为了允许一个简单的扩展路线图，但也允许一个用于开发和测试的服务器实现。

我已经看过一些关于使用 RPC 和 RabbitMQ 超时的单条消息的文章，但这些似乎是阻塞的。我需要能够触发一批请求，每个请求都可能由不同的代理服务。然后，我需要能够整理所有的回复，这样我才能得到一个单一的答案。

如果我要使用 RPC，我相信我最终会得到一个非常复杂的任务串行处理，而不是并行处理。

我还希望能够在某些情况下重新发送请求（例如代理报告暂时错误），但这不是必需的。

我猜我将需要在主应用程序中生成线程，并且每个线程都有一个 RPC 调用，但由于它是一个 Web 应用程序，并且可能有 20 个任务由代理服务，我不热衷于这种方法，并怀疑它很快就会成为瓶颈。

# groovy - 从项目中读取 gradle 路径

> ID：10405049
> 
> 赞同：1
> 
> 时间：2012-05-01T22:06:13.053
> 
> 标签：groovy, gradle

有什么方法可以从我的 Gradle 构建的 Groovy 项目中访问 Gradle groovy 插件 sourceSets 目录？我正在寻找默认的 gradle src 和资源目录。

我需要它来避免在我的项目中硬编码资源目录，但使用默认的 Groovy 插件资源目录（resources/main）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:41:44.040

你能解释一下这个用例吗？在您的 gradle 构建中，您可以访问 Gradles groovy 插件引入的 groovy sourceSets 目录，如下所示：

```
apply plugin:'groovy'

task printGroovySourceDirs << {
    sourceSets.main.groovy.srcDirs.each{
        println it.absolutePath
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:20:51.057

您不应将生产代码与测试源和测试资源混为一谈。我建议您项目中 src 目录的以下布局（groovy 插件的默认布局）：

*   “src/main/groovy”中的 groovy 生产代码
*   在“src/test/groovy”*.groovy 资源中用 java 或 groovy 编写的单元测试，用于在“src/test/resources”中测试你的 DSL

现在您可以通过以下方式从您的测试中引用 .groovy dsl 测试文件

```
URL url = this.getClass().getResource("/testDsl.groovy");
File testDslFile = new File(url.getFile()); 
```

# java - 将日期从 m/d/yy 转换为 mm/dd/yyyy

> ID：10405052
> 
> 赞同：-5
> 
> 时间：2012-05-01T22:06:15.797
> 
> 标签：java

> **可能重复：**
> [日期转换](https://stackoverflow.com/questions/8742830/conversion-of-date)
> [如何将日期从 m/d/yy 转换为 mm/dd/yyyy？](https://stackoverflow.com/questions/10404824/how-to-convert-date-from-m-d-yy-to-mm-dd-yyyy)

我得到一个字符串中的日期：5/1/12。我需要将其转换为 05/01/2012。请建议。

我使用了以下代码：

```
SimpleDateFormat dateFormat = new SimpleDateFormat("MM/dd/yyyy");

d_date = dateFormat.parse("5/1/12"); 

strDate = dateFormat.format(d_date);

Result:
05/01/0012 
```

预期结果：2012 年 5 月 1 日

谢谢普拉萨德

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T22:11:27.427

尝试以下操作：

```
DateFormat formatter = new SimpleDateFormat("MM/dd/yy");
Date date = (Date)formatter.parse("5/1/12");

formatter = new SimpleDateFormat("MM/dd/yyyy");
date = (Date)formatter.format(date); 
```

以下链接应该有助于更复杂的任务：

[Oracle SimpleDateFormat 文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html "简单日期格式")

[示例代码](http://www.exampledepot.com/egs/java.text/parsedate.html)

# zend-framework - Zend_Application 扩展 Frontcontroller 和使用扩展 Frontcontroller 应用程序资源的问题

> ID：10405055
> 
> 赞同：0
> 
> 时间：2012-05-01T22:06:38.317
> 
> 标签：zend-framework, zend-controller, zend-application

我用个人前端控制器扩展了 Zend Frontcontroller，还扩展了前端控制器应用程序资源以使用我的个人前端控制器。目前它基本上所做的就是将应用程序资源方法中的前端变量分配`getFrontController`给我的个人前端控制器。最后，我在其中添加了 pluginpaths 变量`application.ini`以使用我的个人应用程序资源。无论如何，我得到的是`Zend Frontcontroller`退还给我的，而不是我个人的。有人知道为什么我的个人应用程序前端控制器资源没有被使用吗？`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:10:01.187

由于`Zend_Controller_Front`是单例，您还需要重写 getInstance() 方法以确保它创建您的类的实例而不是基类。您可以剪切并粘贴该方法来执行此操作：

```
public static function getInstance()
{
    if (null === self::$_instance) {
        self::$_instance = new self();
    }

    return self::$_instance;
} 
```

# jquery - codeigniter ajax表单提交

> ID：10405059
> 
> 赞同：2
> 
> 时间：2012-05-01T22:07:02.010
> 
> 标签：jquery, ajax, codeigniter, form-submit, preventdefault

我有一个表单（通过codeigniter 制作），我想用ajax onClick 提交。没有 Ajax 的表单提交并且不让我做`event.preventDefault();`

**jQuery 文件**

```
$('#register_submit').click(function(e){//
   e.preventDefault();
    var first_name = $('#register_form1').val();

    $.ajax({
        type: "POST", 
        async: false, 
        url: base_url+"register/registration_val",   
        data: "register_first_name="+first_name,
        success: function(data){
            $('#inferiz').html(data);
        },
        error: function(){alert('error');}
    }); 

}); 
```

// 控制器工作得很好。名称寄存器，我发布到的功能是registration_val

**HTML 文件**

```
 <form method="POST" action='<?php echo site_url('/register/registration_val'); ?>' id='register_form' >
   <input type="login" name="register_first_name" id="register_form1">
   <input type='submit' value="Register" id='register_submit'>
 </form> 
```

问题是，当我单击 SUBMIT 按钮时，jQuery 不做它的工作，而是将自己提交给控制器并发出错误消息。
我无法阻止表单提交（我认为这可以解决问题），Click 事件被完全忽略。提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T22:09:29.603

试试你的运气，`submit`而不是`click`：

```
$('form').submit(function(e){//
   e.preventDefault();
    var first_name = $('#register_form1').val();

    $.ajax({
        type: "POST", 
        async: false, 
        url: base_url+"register/registration_val",   
        data: "register_first_name="+first_name,
        success: function(data){
            $('#inferiz').html(data);
        },
        error: function(){alert('error');}
    });     
}); 
```

如果 from`id`替换`'form'`为`'#{formId}'`.

**笔记：**

*   代码应该在 DOM 就绪事件回调中。
*   如果 DOM 上不存在表单，则应使用委托事件。

像这样：

```
$('body').on('submit', 'form', function(e){
   e.preventDefault();
    var first_name = $('#register_form1').val();    

    $.ajax({
        type: "POST", 
        async: false, 
        url: base_url+"register/registration_val",   
        data: "register_first_name="+first_name,
        success: function(data){
            $('#inferiz').html(data);
        },
        error: function(){alert('error');}
    });     
}); 
```

只需`body`用更接近的**静态**元素（如果有的话）替换以提高性能。

**祝你好运！**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T09:25:39.680

如果您将`return false;`点击事件结束，它不应该将您的表单提交给控制器..

# html - HTML5 动画 - 滚动到时播放

> ID：10405062
> 
> 赞同：1
> 
> 时间：2012-05-01T22:07:11.397
> 
> 标签：html, animation, css

我想在一页上有一些 HTML5 动画，但不希望它们全部在页面加载时立即播放。相反，我希望每个动画在用户滚动到每个动画所在的部分时自动播放。什么是适当的标签、代码等来实现这一点？

其他地方的几个例子：nest.com/living-with-nest/ - 当你向下滚动到第 2 天时，蓝色和橙色箭头会动画

apple.com/ipad/features/ - 当您向下滚动到相机部分时，会播放镜头视频/vr - 与 Smart Cover、Airplay 和其他部分相同

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T10:36:02.730

您问题中的不同部分：

*   有 html5 动画：使用`video`元素

*   不立即开始动画：根本不指定`autoplay`

*   开始视频：

    ```
    document.getElementById('myVideo').play(); 
    ```

*   检查元素是否可见：使用 jquery，您可以简单地使用 offset().top、window.innerHeight 和 scrollTop：

    ```
    var visible = 
        $(window).scrollTop()+window.innerHeight>$e.offset().top
        &&$(window).scrollTop()<$e.offset().top+$e.height(); // $e is the video element 
    ```

*   检测滚动：使用jquery`scroll`函数

我做了一个小提琴来说明如何检测滚动何时显示或隐藏元素：http: [//jsfiddle.net/dystroy/zj5Sz/](http://jsfiddle.net/dystroy/zj5Sz/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-23T11:53:15.123

*注意：此答案特定于您在评论中提到的 Animate CC(Flash) 生成的 HTML5 项目*

现在有一种使用 Animate CC & Muse 2017 控制此类设置的快速简便的方法。

1.  将您的动画导出为 OAM 文件或将动画上传到 CC Libraries。
2.  在 Muse 中打开您的网站。
3.  导入 OAM 文件或使用 Muse 中 CC 库中的动画。将其放置在适当的位置。
4.  在 Muse 中打开滚动效果面板 -> 转到动画选项卡 -> 选择动画复选框并选择自动播放。

    [![在此处输入图像描述](../Images/8f7080cb990d66808ba3f98cf6907c06.png)](https://i.stack.imgur.com/DuEro.png)

5.  在浏览器中预览网页，它应该仅在您向下滚动并显示画布时播放。

# notation - 求解 Big Theta 表示法

> ID：10405068
> 
> 赞同：3
> 
> 时间：2012-05-01T22:08:15.760
> 
> 标签：notation, asymptotic-complexity

我在解决大 theta 表示法时遇到问题。我知道大 O 表示法表示最坏情况和上限，而 Omega 表示法表示最佳情况和下限。

如果给我一个在 O(nlogn) 时间和 Omega(n) 中运行的算法，我将如何推断 Theta 等于什么？我开始假设当且仅当 O 和 Omega 相等时才存在 theta 符号，这是真的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T22:25:32.820

假设您的算法在`f(x)`.

*   *`f(x) = O(n*log(n))`意味着对于`x`足够高，有一些常数`c1 > 0`，所以`f(x)`总是小于`c1*n*log(n)`。**   *`f(x) = Omega(n)`意味着对于`x`足够高，有一些常数`c2 > 0`，因此`f(x)`将大于`c2*n`*

所以你现在所知道的是，从某个点开始（`x`足够大）你的算法将运行得比 快`c2*n`和慢`c1*n*log(n)`。

*   *`f(x) = Theta(g(x))`意味着对于`x`足够大有一些`c3 > 0`等等`c4 > 0`，`c3*g(x) <= f(x) <= c4*g(x)`这意味着`f(x)`只会比 更快或更慢地运行一个常数因子`g(x)`。确实如此，`f(x) = O(g(x))`并且`f(x) = Omega(g(x))`。*

    **结论：**仅给出 O 和 Omega，如果它们不相同，您将无法得出 Theta 是什么。如果您有算法，您可以尝试查看是否可能选择了 O 太高，或者可能选择了 Omega 太低。

# javascript - Socket.io 客户端：用一个处理程序响应所有事件？

> ID：10405070
> 
> 赞同：87
> 
> 时间：2012-05-01T22:08:22.327
> 
> 标签：javascript, events, socket.io

是否可以让 socket.io 客户端响应所有事件而无需单独指定每个事件？

例如，像这样的东西（显然现在不起作用）：

```
var socket = io.connect("http://myserver");

socket.on("*", function(){
  // listen to any and all events that are emitted from the
  // socket.io back-end server, and handle them here.

  // is this possible? how can i do this?
}); 
```

我希望在客户端 socket.io 代码收到任何/所有事件时调用此回调函数。

这可能吗？如何？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2015-11-27T14:58:03.520

**socket.io-client 1.3.7**的更新解决方案

 **```
var onevent = socket.onevent;
socket.onevent = function (packet) {
    var args = packet.data || [];
    onevent.call (this, packet);    // original call
    packet.data = ["*"].concat(args);
    onevent.call(this, packet);      // additional call to catch-all
}; 
```

像这样使用：

```
socket.on("*",function(event,data) {
    console.log(event);
    console.log(data);
}); 
```

尽管 Mathias Hopf 和 Maros Pixel 的答案很接近，但没有一个答案对我有用，这是我调整后的版本。

**注意：**这只捕获自定义事件，而不是连接/断开等

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-05-01T22:18:14.123

看起来 socket.io 库将这些存储在字典中。因此，不要认为在不修改源代码的情况下这是可能的。

从[来源](https://github.com/LearnBoost/socket.io-client/blob/master/lib/events.js)：

```
EventEmitter.prototype.on = function (name, fn) {
    if (!this.$events) {
      this.$events = {};
    }

    if (!this.$events[name]) {
      this.$events[name] = fn;
    } else if (io.util.isArray(this.$events[name])) {
      this.$events[name].push(fn);
    } else {
      this.$events[name] = [this.$events[name], fn];
    }

    return this;
  }; 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2016-05-11T10:07:05.687

**最后**，还有一个名为[socket.io-wildcard](https://github.com/hden/socketio-wildcard)的模块，它允许在客户端和服务器端使用通配符

```
var io         = require('socket.io')();
var middleware = require('socketio-wildcard')();

io.use(middleware);

io.on('connection', function(socket) {
  socket.on('*', function(){ /* … */ });
});

io.listen(8000); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-10-14T17:41:08.443

干得好 ...

```
var socket = io.connect();
var globalEvent = "*";
socket.$emit = function (name) {
    if(!this.$events) return false;
    for(var i=0;i<2;++i){
        if(i==0 && name==globalEvent) continue;
        var args = Array.prototype.slice.call(arguments, 1-i);
        var handler = this.$events[i==0?name:globalEvent];
        if(!handler) handler = [];
        if ('function' == typeof handler) handler.apply(this, args);
        else if (io.util.isArray(handler)) {
            var listeners = handler.slice();
            for (var i=0, l=listeners.length; i<l; i++)
                listeners[i].apply(this, args);
        } else return false;
    }
    return true;
};
socket.on(globalEvent,function(event){
    var args = Array.prototype.slice.call(arguments, 1);
    console.log("Global Event = "+event+"; Arguments = "+JSON.stringify(args));
}); 
```

这也会捕获像`connecting`, `connect`, `disconnect`,之类的事件`reconnecting`，所以要小心。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-10-01T16:10:12.073

**注意：此答案仅对 socket.io 0.x 有效**

您可以覆盖**socket.$emit**

使用以下代码，您有两个新功能：

*   捕获所有事件
*   仅捕获旧方法未捕获的事件（它是默认侦听器）

```
var original_$emit = socket.$emit;
socket.$emit = function() {
    var args = Array.prototype.slice.call(arguments);
    original_$emit.apply(socket, ['*'].concat(args));
    if(!original_$emit.apply(socket, arguments)) {
        original_$emit.apply(socket, ['default'].concat(args));
    }
}

socket.on('default',function(event, data) {
    console.log('Event not trapped: ' + event + ' - data:' + JSON.stringify(data));
});

socket.on('*',function(event, data) {
    console.log('Event received: ' + event + ' - data:' + JSON.stringify(data));
}); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-04-20T11:53:08.180

当前（2013 年 4 月）[关于暴露事件的 GitHub 文档](https://github.com/LearnBoost/socket.io/wiki/Exposed-events)提到了一个`socket.on('anything')`. 'anything' 似乎是自定义事件名称的占位符，而不是可以捕获任何事件的实际关键字。

我刚刚开始使用 Web 套接字和 Node.JS，并且立即需要处理任何事件，以及发现发送了哪些事件。不敢相信 socket.io 缺少这个功能。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2020-11-27T11:42:01.690

就像在[v3.0 文档](https://socket.io/docs/v3/client-api/index.html#socket-onAny-callback)中一样：

```
socket.onAny((event, ...args) => {
  console.log(`got ${event}`);
}); 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-05-16T22:38:09.033

**socket.io 客户端 1.7.3**

截至 2017 年 5 月，无法让任何其他解决方案完全按照我的意愿工作 - 制作了一个拦截器，仅在 Node.js 上用于测试目的：

```
var socket1 = require('socket.io-client')(socketUrl)
socket1.on('connect', function () {
  console.log('socket1 did connect!')
  var oldOnevent = socket1.onevent
  socket1.onevent = function (packet) {
    if (packet.data) {
      console.log('>>>', {name: packet.data[0], payload: packet.data[1]})
    }
    oldOnevent.apply(socket1, arguments)
  }
}) 
```

参考：

*   [https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply)
*   [https://github.com/socketio/socket.io-client/blob/ff4cb3eed04a95c9725b8aaba8b64fa9fa1ca413/lib/socket.js#L257](https://github.com/socketio/socket.io-client/blob/ff4cb3eed04a95c9725b8aaba8b64fa9fa1ca413/lib/socket.js#L257)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-05-27T22:04:23.690

因为您的问题在寻求解决方案时非常笼统，所以我将介绍这个不需要破解代码的问题，只需更改您使用套接字的方式即可。

我刚刚决定让我的客户端应用程序发送完全相同的事件，但使用不同的有效负载。

```
socket.emit("ev", { "name" : "miscEvent1"} );
socket.emit("ev", { "name" : "miscEvent2"} ); 
```

在服务器上，类似...

```
socket.on("ev", function(eventPayload) {
   myGenericHandler(eventPayload.name);
}); 
```

我不知道是否总是使用相同的事件会导致任何问题，也许是某种规模的碰撞，但这很好地满足了我的目的。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-06-23T08:30:11.987

在Socket.IO 存储库问题页面上[对此主题进行了长时间的讨论。](https://github.com/LearnBoost/socket.io/issues/434)那里发布了各种解决方案（例如，用 EventEmitter2 覆盖 EventEmitter）。lmjabreu 几周前发布了另一个解决方案：一个名为[socket.io-wildcard](https://npmjs.org/package/socket.io-wildcard)的 npm 模块，它将通配符事件修补到 Socket.IO（适用于当前的 Socket.IO，~0.9.14）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-01-24T13:48:06.547

尽管这是一个老问题，但我也遇到了同样的问题，并使用 in 中的本机套接字解决了这个问题`Node.js`，它有一个 .on('data') 事件，每次数据到来时都会触发。所以这就是我到目前为止所做的：

```
const net = require('net')

const server = net.createServer((socket) => {
    // 'connection' listener.
    console.log('client connected')

    // The stuff I was looking for
    socket.on('data', (data) => {
        console.log(data.toString())
    })

    socket.on('end', () => {
        console.log('client disconnected')
    })
})

server.on('error', (err) => {
    throw err;
})

server.listen(8124, () => {
    console.log('server bound');
}) 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-04-30T01:04:38.620

我发现的所有方法（包括 socket.io-wildcard 和 socketio-wildcard）都不适合我。显然 socket.io 1.3.5 中没有 $emit ......

阅读 socket.io 代码后，我修补了以下 DID 工作：

```
var Emitter = require('events').EventEmitter;
var emit = Emitter.prototype.emit;
[...]
var onevent = socket.onevent;
socket.onevent = function (packet) {
    var args = ["*"].concat (packet.data || []);
    onevent.call (this, packet);    // original call
    emit.apply   (this, args);      // additional call to catch-all
}; 
```

这也可能是其他人的解决方案。但是，ATM 我不完全理解为什么其他人似乎对现有的“解决方案”没有问题？！？有任何想法吗？也许这是我的旧节点版本（0.10.31）......

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-06-24T15:15:43.433

@Matthias Hopf 回答

更新了 v1.3.5 的答案。如果您想`*`一起收听旧事件和事件，则 args 存在错误。

```
var Emitter = require('events').EventEmitter;
var emit = Emitter.prototype.emit;
// [...]
var onevent = socket.onevent;
socket.onevent = function (packet) {
    var args = packet.data || [];
    onevent.call (this, packet);    // original call
    emit.apply   (this, ["*"].concat(args));      // additional call to catch-all
}; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-09-21T01:30:44.257

我正在使用**Angular 6**和 npm 包：**ngx-socket-io**

```
import { Socket } from "ngx-socket-io"; 
```

...

```
constructor(private socket: Socket) { } 
```

...

连接套接字后，我使用此代码，这是处理所有自定义事件...

```
const onevent = this.socket.ioSocket.onevent;
this.socket.ioSocket.onevent = function (packet: any) {
  const args = packet.data || [];
  onevent.call(this, packet);    // original call
  packet.data = ["*"].concat(args);
  onevent.call(this, packet);      // additional call to catch-all
};
this.socket.on("*", (eventName: string, data: any) => {
  if (typeof data === 'object') {
    console.log(`socket.io event: [${eventName}] -> data: [${JSON.stringify(data)}]`);
  } else {
    console.log(`socket.io event: [${eventName}] -> data: [${data}]`);
  }
}); 
```**

# ruby-on-rails - Rails - CSV导入中行尾的换行符导致错误

> ID：10405077
> 
> 赞同：0
> 
> 时间：2012-05-01T22:09:23.370
> 
> 标签：ruby-on-rails, csv, rake

我正在运行一个 rake 任务来导入一些文件属性，我收到一个错误，让我相信为每一行创建的字符串包含某种换行符（例如`/n`）。

**编辑**- 已确认换行符是问题。

以下是我的 CSV 文件的示例：

```
1|type1,type2|category1
2|type2|category1,category2,category3
3|type2,type4|category3,category8 
```

这是我处理它的代码：

```
namespace :data do
  desc "import"
  task :import => :environment do
    file = File.open(Rails.root.join('lib/assets/data.csv'), 'r')
    file.each do |line|
      attrs = line.split("|")
      foo = Model.find(attrs[0])

      attrs[1].split(",").each do |type|
        foo.add_type!(ModelType.find_by_name(type))
      end

      attrs[2].split(",").each do |category|
        foo.categorize!(ModelCategory.find_by_name(category))
      end
    end
  end
end 
```

`ModelType`和`ModelCategory`都是独立的模型，其`:through`关系`Model`是用函数`Model.add_type!`和构建的`Model.categorize!`。

当我运行时`rake data:import`，一切正常，直到`category`在第一行结束时达到决赛。不管它是哪个类别，也不管有多少类别`attrs[2]`——它只会在最后一个失败。这是我收到的错误：

```
Called id for nil, which would mistakenly be 4 -- if you really wanted the id of nil, use object_id 
```

有关如何解决此问题或避免此错误的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:44:19.320

您可以使用 chomp：

```
attrs = line.chomp.split("|") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:26:19.777

```
attrs = line.split("|")
if attrs.length > 0
  foo = Model.find(attrs[0])
  ...
end 
```

您的 CSV 末尾可能有一个空行

更新

```
file = File.open(Rails.root.join('lib/assets/data.csv'), 'r')
file.split("\r\n").each do |line| 
```

或者

```
file = File.open(Rails.root.join('lib/assets/data.csv'), 'r')
file.split("\r").each do |line| 
```

或者

```
file = File.open(Rails.root.join('lib/assets/data.csv'), 'r')
file.split("\n").each do |line| 
```

取决于最初生成 CSV 的方式！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-31T07:39:57.267

改用`String.encode(universal_newline: true)`gsub。它将 CRLF 和 CR 转换为 LF # 总是用 \n 换行

# jquery - CSRF 验证失败。请求以 Django 表单中止

> ID：10405082
> 
> 赞同：1
> 
> 时间：2012-05-01T22:09:59.393
> 
> 标签：jquery, python, ajax, django

我正在处理图片上传表单。当用户上传图片时。在预览区域中使用 ajax 显示该图像...表单重新加载，但似乎不想显示新头像。我得到一个`CSRF verification failed. Request aborted`错误。

`Reason given for failure: CSRF is missing or incorrect.`

我在表单中有一个 csrf_token。

***模板：***

```
<form class="nice inline-form" enctype="multipart/form-data" method="POST" action="/profile/edit/" id="avatarLoadForm">
      <input type="hidden" name="next" value="/account/settings/">
      {% csrf_token %}
      <div>
      <label for="avatar">Avatar</label>
      <div id="preview" class="frame">  
           <img src="{% if profile.user %}{% thumbnail profile.avatar 120x120 crop %}{% else %}{{ DEFAULT_AVATAR }}{% endif %}" alt="" alt="sample-pic" id="thumb" />
      </div>
      <input type="file" size="20" id="imageUpload">
      and other form info...
</form> 
```

***阿贾克斯/jQuery：***

```
$(document).ready(function(){

        var thumb = $('img#thumb'); 

        new AjaxUpload('imageUpload', {
            action: $('#avatarLoadForm').attr('action'),
            name: 'avatar',
            csrfmiddlewaretoken: $( "#csrfmiddlewaretoken" ).val(),

            onSubmit: function(file, extension) {
                $('#preview').addClass('loading');
            },
            onComplete: function(file, response) {
                thumb.load(function(){
                    $('#preview').removeClass('loading');
                    thumb.unbind();
                });
                thumb.attr('src', response);

            } 

        }); 
```

也许我的***Views.py***中缺少一些东西？

```
@login_required        
def edit_profile(request):
    context = base_context(request)
    if request.method == 'POST':
        notify = "You have successfully updated your profile."
        user_info_form = UserInfoForm(request.POST, request.FILES)
        if user_info_form.is_valid():
            if request.is_ajax():
                response = simplejson.dumps({"status": "Upload Success"})
                return HttpResponse (response, mimetype='application/json')
            messages.success(request, 'You have successfully updated your profile.')
            user_info_form.save(request.user, profile_type)
            return HttpResponseRedirect(request.POST.get('next', '/profile/' + request.user.username + '/'))
    else:
        initial = {}
        initial['first_name'] = request.user.first_name
        initial['last_name'] = request.user.last_name
        initial['email'] = request.user.email
        initial['about'] = profile.about
        initial['country'] = profile.country
        initial['about'] = profile.about
        user_info_form = UserInfoForm(initial=initial)
    context['user_info_form'] = user_info_form
    context['profile'] = profile
    return render_to_response('settings/profile.html', context, context_instance=RequestContext(request)) 
```

***设置.py：***

```
MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.middleware.csrf.CsrfResponseMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'pagination.middleware.PaginationMiddleware',
) 
```

文件上传工作没有 ajax 废话。也就是说，它实际上保存了图像，只是没有在预览中显示它。我真的不知道出了什么问题，也不知道为什么会这样。有很多关于 csrf 失败的帖子。但我找不到适合这种情况的。任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:19:55.260

是什么让您认为 csrf 令牌具有 id `#csrfmiddlewaretoken`？快速查看您呈现的 html 会发现模板标签不会生成 id 属性。

试试`$("input[name=csrfmiddlewaretoken]").val()`吧

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:15:26.130

```
csrfmiddlewaretoken: $( "#csrfmiddlewaretoken" ).val(), 
```

这可能行不通。CSRF 字段的名称/id 是动态生成的，而不是像这样的静态字符串。

请参阅[https://docs.djangoproject.com/en/1.3/ref/contrib/csrf/#ajax](https://docs.djangoproject.com/en/1.3/ref/contrib/csrf/#ajax)了解如何正确使用带有 AJAX 请求的 CSRF 中间件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T07:02:02.093

看到这个[http://djangolinks.com/detail/ajax-post-requests-csrf-fix-69/](http://djangolinks.com/detail/ajax-post-requests-csrf-fix-69/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T00:06:27.117

这对我有用：

```
beforeSend: function(jqXHR, settings) {
    jqXHR.setRequestHeader('X-CSRFToken', $('input[name=csrfmiddlewaretoken]').val());
}, 
```

或者，您可以像这样从 dom 中提取 cookie，如果您的表单是通过 ajax 生成的，并且由于其呈现方式而无法发送 {{ csrf_token }}，那就太好了：

```
beforeSend: function(xhr, settings) {
        console.log('-------------before send--');
        function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie != '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = jQuery.trim(cookies[i]);
                    // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
        }
        if (!(/^http:.*/.test(settings.url) || /^https:.*/.test(settings.url))) {
            // Only send the token to relative URLs i.e. locally.
            xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
        }
} 
```

# php - 使用ajax获取结果值

> ID：10405084
> 
> 赞同：0
> 
> 时间：2012-05-01T22:10:03.970
> 
> 标签：php, ajax

我正在使用 Codeigniter 平台。

这是ajax

```
$.ajax({
            type: 'POST',
            url: '/account/findpassword/exec',
            data: {
                'user_email': val
            },
            cache: false,
            async: false,
            success: function(result){
                if(result == 'FALSE')
                    alert('Email does not exist.');
                else if(result == 'TRUE')
                    alert('We sent a new password to your email.');                 
                else
                    alert('There is an error.');
            }
        }); 
```

这是控制器

```
 function exec()
    {
        $email = $this->input->post('user_email');

        $this->load->model('account/findpassword_model', 'findpass');
        $u_data = $this->findpass->get_user_data($email);
        if($u_data == FALSE)
        {
            $result = 'FALSE';
            echo $result;
            exit;
        }
        else
        {
        $this->findpass->set_user_newpass($u_data['u_id'], $new_pass);
        echo 'TRUE';
        }
    } 
```

这是模型

```
function get_user_data($email)
    {
        $query = 'SELECT u_id, u_name FROM '.T_USER_ACCOUNT.' WHERE u_email = "'.$email.'"';
        $result = $this->db->query($query)->result_array();
        if(count($result) > 0)
            return $result[0];
        else
            return FALSE;
    } 
```

它应该说“电子邮件不存在”。如果没有电子邮件地址，请发送消息。

如果存在电子邮件地址，则应该说第二条消息。

当我检查数据库服务器时，这个控制器和模型命令起作用了。

但是，它只显示“有错误”。所有类型的消息。

我检查了百万次，但不知道为什么它没有说正确的话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:23:07.360

据我所知，您只打算将 TRUE 或 FALSE 返回给客户端。如果您不匹配其中任何一个，问题是，您的成功处理程序中 result 的值是什么？

`console.log(result);`

在您的成功函数中应该向您显示您从服务器返回的内容，并且从那里应该很容易找出您不匹配 TRUE 或 FALSE 的原因。

# java - 可绘制到位图，可绘制未知大小/尺寸

> ID：10405088
> 
> 赞同：3
> 
> 时间：2012-05-01T22:10:18.920
> 
> 标签：java, android, bitmap, drawable

我有一个可绘制的对象，它是一个向量。由于您无法裁剪（或由于 ICS 强制硬件加速而剪辑）可绘制对象，因此它使精灵动画无用。

我正在尝试将drawable转换为具有特定大小的位图（最低屏幕尺寸的百分比以获得最佳效果）。

当然，该版本需要具有超强的内存效率。

我需要帮助的是创建具有特定大小的位图，这是我到目前为止得到的：

```
public Bitmap svgTObitmap(String name, int percentage, int screen_width, int screen_height)
{
    _resID = _context.getResources().getIdentifier( name , "raw" , _context.getPackageName());
    SVG svg = SVGParser.getSVGFromResource(_context.getResources(), _resID);

    Drawable drawable = svg.createPictureDrawable();

    Bitmap bmp = ((BitmapDrawable)drawable).getBitmap();

    return bmp;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T22:20:55.843

来自一个向量，显然你`Drawable`实际上不是一个`BitmapDrawable`. 您需要改为`Drawable`在`Bitmap`. 请参阅我给另一个问题的[答案：](https://stackoverflow.com/questions/3035692/how-to-convert-a-drawable-to-a-bitmap/9390776#9390776)

```
Bitmap bmp = Bitmap.createBitmap(drawable.getIntrinsicWidth(), drawable.getIntrinsicHeight(), Config.ARGB_8888);
Canvas canvas = new Canvas(bmp); 
drawable.setBounds(0, 0, canvas.getWidth(), canvas.getHeight());
drawable.draw(canvas); 
```

显然，在您的情况下，您将明确指定所需的大小，而不是尝试获取可绘制对象的固有高度/宽度。

# jquery - Jquery 循环插件 containerResize 选项

> ID：10405089
> 
> 赞同：0
> 
> 时间：2012-05-01T22:10:22.757
> 
> 标签：jquery, slideshow, cycle

我使用 jquery 循环有一个像这样的淡入淡出幻灯片......

```
$('.pics').cycle({
    fx: 'fade',
    timeout:5000,
    random: 1,
    containerResize: false
}); 
```

它以前工作正常，但自从我添加了`containerResize: false`我的图像就不会再显示了......有人知道它在做什么吗？...... [http://willruppelglass.com/index.php上的示例](http://willruppelglass.com/index.php)

这是其他一些代码，可能会有所帮助，永远不知道....

```
.pics {  

    padding: 0;  
    margin:  0;
} 

.pics img {    
    background-color: #eee;  
    height: 200px; 
    text-align:center;
    top:  0; 
    left: 0;
}

.contentImages{
    border:1px solid #CCC; 
    padding:10px; 
    margin:20px auto 0; 
    position:relative;
    width: 600px;
    overflow:hidden;
}

<div class="contentImages">

<div class="pics">

<img src="upload/<?php echo $array['image'] ?>" height="200" />

<img src="upload/<?php echo $array['image2'] ?>" height="200" />

<img src="upload/<?php echo $array['image3'] ?>" height="200" />

</div>

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T03:12:39.777

您需要保留`containerResize: true`或设置 a `height`or `min-height`on `.contentImages`。您将所有溢出隐藏在高度为 0 的元素上，它的子元素将永远不会显示。检查你的 DOM 会告诉你。

# java - 在绘制后取消选择 DrawLine

> ID：10405097
> 
> 赞同：0
> 
> 时间：2012-05-01T22:10:52.143
> 
> 标签：java, teechart

绘制 DrawLine 后，它保持选中状态。我希望它们在绘制后不被选中。

如何在绘制后取消选择 DrawLine？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:17:27.820

[`DrawLine.setEnableSelect(false)`](http://www.steema.com/files/public/teechart/java/v1/docs/JavaDoc/com/steema/teechart/tools/DrawLine.html#setEnableSelect%28boolean%29) （WAG 来自检查我以前从未听说过的 API 的 JavaDocs）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T06:46:06.220

如果您有此方法可用，请使用此方法：`DrawLine.setSelectNewLines`或者您可以使用[`setSelected(null)`](http://www.steema.com/files/public/teechart/java/v1/docs/JavaDoc/com/steema/teechart/tools/DrawLine.html#setSelected%28com.steema.teechart.tools.DrawLineItem%29)取消选择新绘制的项目。您还需要添加[`DrawLineListener`](http://www.steema.com/files/public/teechart/java/v1/docs/JavaDoc/com/steema/teechart/tools/DrawLine.DrawLineListener.html)，以便您可以收听新线路以使用此功能。示例代码行将是：

```
 drawLine.addDrawLineListener(new DrawLineListener() {
        @Override
        public void lineSelected(ChangeEvent ce) {}
        @Override
        public void lineNew(ChangeEvent ce) {
            drawLine.setSelected(null);
        }
    }); 
```

# iphone - 为什么我的 UITableView 无法滚动，除非我告诉它为滚动设置动画？

> ID：10405104
> 
> 赞同：6
> 
> 时间：2012-05-01T22:11:22.970
> 
> 标签：iphone, objective-c, ios, uitableview

我已经设置了一个表格视图，以便在其视图控制器加载时它会滚动到某一行。我将此代码放入 viewDidLoad 方法中，它按我的预期工作：

`[thisTableView scrollToRowAtIndexPath:[NSIndexPath indexPathForRow:16 inSection:0] atScrollPosition:UITableViewScrollPositionTop animated:YES];`

但是，如果我将最后一位更改为`animated:NO`，它根本不会滚动。我可以让它动画化，但我想知道：如果动画设置为 NO，为什么它不滚动？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T22:29:15.020

在 viewDidLoad 中，您的 tableView 是空的，因此无法滚动到第 16 行。立即评估调用，因为不需要动画

当您使用动画：YES 时，动画会延迟到显示视图，然后填充您的表格。

当您的表已经填充了数据时，您可能希望在 viewDidAppear（或 viewWillAppear）中使用这种代码。这将在每次呈现视图时调用它（除非您添加一些逻辑），但不确定这是否满足您的要求......

# java - JLayeredPane 格式问题

> ID：10405109
> 
> 赞同：2
> 
> 时间：2012-05-01T22:11:59.900
> 
> 标签：java, swing, jlayeredpane

我有一个问题`JLayeredPane`，我可能正在做一些非常简单的事情，但我无法绕过它。我遇到的问题是所有组件都合并在一起并且没有顺序。你能否纠正这个问题，因为我不知道。我想做的顺序是这样的布局

* * *

输出

* * *

label1（后面）
输入（前面）

* * *

```
import java.awt.BorderLayout;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.io.IOException;

import javax.swing.ImageIcon;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JTextArea;
import javax.swing.JTextField;

public class window extends JFrame implements KeyListener {
/**
 * 
 */
private static final long serialVersionUID = 7092006413113558324L;
private static int NewSize;
public static String MainInput;
public static JLabel label1 = new JLabel();
public static JTextField input = new JTextField(10);
public static JTextArea output = new JTextArea(main.Winx, NewSize);

public window() {
    super("Satine. /InDev-01/");
    JLabel label1;
    NewSize = main.Winy - 20;
    setLayout(new BorderLayout());
    output.setToolTipText("");
    add(input, BorderLayout.PAGE_END);
    add(output, BorderLayout.CENTER);
    input.addKeyListener(this);
    input.requestFocus();
    ImageIcon icon = new ImageIcon("C:\\Users\\" + System.getProperty("user.name") + "\\AppData\\Roaming\\.Satine\\img\\textbox.png", "This is the desc");
    label1 = new JLabel(icon);
    add(label1, BorderLayout.PAGE_END);
}  
public void keyPressed(KeyEvent e) {
    int key = e.getKeyCode();
    if (key == KeyEvent.VK_ENTER) {
        try {
            MainMenu.start();
        } catch (IOException e1) {
            System.out.print(e1.getCause());
        }
    }
}

@Override
public void keyReleased(KeyEvent e) {
}

@Override
public void keyTyped(KeyEvent e) {
}

 } 
```

和主班。

```
import java.awt.Container;
import java.io.IOException;

import javax.swing.JFrame;
import javax.swing.JLayeredPane;

public class main {
public static int Winx, Winy;
private static JLayeredPane lpane = new JLayeredPane();
public static void main(String[] args) throws IOException{  
    Winx = window.WIDTH;
    Winy = window.HEIGHT;
    window Mth= new window();
    Mth.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    Mth.setSize(1280,720);
    Mth.setVisible(true);
    lpane.add(window.label1);
    lpane.add(window.input);
    lpane.add(window.output);
    lpane.setLayer(window.label1, 2, -1);
    lpane.setLayer(window.input, 1, 0);
    lpane.setLayer(window.output, 3, 0);
    Mth.pack();
}
  } 
```

感谢您抽出宝贵时间，我不希望为我编写代码，我想要的只是提示我哪里出错了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T22:20:06.180

我建议您不要使用 JLayeredPane 作为 GUI 的整体布局。使用 BoxLayout 或 BorderLayout，然后只在需要分层的地方使用 JLayeredPane。此外，在将组件添加到 JLayeredPane 时，请使用带有 Component 和 Integer 的 add 方法。不要打电话`add(...)`then `setLayer(...)`。

编辑：可以`setLayer(...)`按照您的方式使用。我以前从未使用过它，但根据 API，这是设置层的一种方法。

例如，

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.GridBagLayout;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.net.MalformedURLException;
import java.net.URL;

import javax.imageio.ImageIO;
import javax.swing.*;

public class LayeredPaneFun extends JPanel {
   public static final String IMAGE_PATH = "http://duke.kenai.com/" +
        "misc/Bullfight.jpg";

   public LayeredPaneFun() {
      try {
         BufferedImage img = ImageIO.read(new URL(IMAGE_PATH));
         ImageIcon icon = new ImageIcon(img);
         JLabel backgrndLabel = new JLabel(icon);
         backgrndLabel.setSize(backgrndLabel.getPreferredSize());

         JPanel forgroundPanel = new JPanel(new GridBagLayout());
         forgroundPanel.setOpaque(false);

         JLabel fooLabel = new JLabel("Foo");
         fooLabel.setFont(fooLabel.getFont().deriveFont(Font.BOLD, 32));
         fooLabel.setForeground(Color.cyan);
         forgroundPanel.add(fooLabel);
         forgroundPanel.add(Box.createRigidArea(new Dimension(50, 50)));
         forgroundPanel.add(new JButton("bar"));
         forgroundPanel.add(Box.createRigidArea(new Dimension(50, 50)));
         forgroundPanel.add(new JTextField(10));
         forgroundPanel.setSize(backgrndLabel.getPreferredSize());

         JLayeredPane layeredPane = new JLayeredPane();
         layeredPane.setPreferredSize(backgrndLabel.getPreferredSize());
         layeredPane.add(backgrndLabel, JLayeredPane.DEFAULT_LAYER);
         layeredPane.add(forgroundPanel, JLayeredPane.PALETTE_LAYER);

         setLayout(new BoxLayout(this, BoxLayout.PAGE_AXIS));
         add(new JScrollPane(new JTextArea("Output", 10, 40)));
         add(layeredPane);

      } catch (MalformedURLException e) {
         e.printStackTrace();
         System.exit(1);
      } catch (IOException e) {
         e.printStackTrace();
         System.exit(1);
      }
   }

   private static void createAndShowGui() {
      JFrame frame = new JFrame("LayeredPaneFun");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(new LayeredPaneFun());
      frame.pack();
      frame.setLocationRelativeTo(null);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
} 
```

# java - 检查一个 url 中的更新而不下载整个文件

> ID：10405110
> 
> 赞同：0
> 
> 时间：2012-05-01T22:12:04.063
> 
> 标签：java, android, caching

我已经实现了一个将 url 缓存到文件系统（Android java）中的系统，以这种方式工作：

*   给定一个 url，文件被下载到 /one_folder/hash(url).file

*   该 url 的下一个请求首先检查文件是否存在。如果是，则返回文件，否则重复下载。

问题是，如果没有执行额外的逻辑并且更改了 url 处的文件，则永远不会检测到它（导致缓存总是成功）。

我该如何改进呢？是否有更好的系统可以为缓存文件分配到期日期并在到期时重新下载？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:17:37.423

下载文件时，请检查 HTTP 标头。在那里你可能会找到缓存规则、内容过期日期等。

或者您可以发出 HEAD 请求而不是 GET 请求，并且只获取 http 标头（不是内容/文件）并比较上次修改或文件大小（内容长度）。

# python - 具有与 json 库类似功能的 python xml 库

> ID：10405111
> 
> 赞同：0
> 
> 时间：2012-05-01T22:12:06.980
> 
> 标签：python, xml, json

Python 有一个 json 库，您可以在其中将`json.loads(s)`json 加载到由列表和映射组成的 python 数据结构中。xml有没有等价的东西？我见过的所有 xml 库都映射到一个 DOM，你必须知道特殊的 API 函数，这在 IMO 中不太容易使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:14:22.147

不，简单来说，JSON 对象直接转换为 Python 对象。如何将 XML 转换为 Python - 答案是 DOM。

然而，使用 XML 有更简单的方法。在我看来，为了易于使用，最好的方法是[`xml.etree.ElementTree`](http://docs.python.org/library/xml.etree.elementtree.html)，它允许您遍历 XML 的元素并创建一棵树，与其他获取 XML 数据的方法相比，这很容易使用。

# api - 如何通过 Amazon EC2 API 修改实例的“名称”属性？

> ID：10405117
> 
> 赞同：1
> 
> 时间：2012-05-01T22:12:25.530
> 
> 标签：api, amazon-ec2, amazon-web-services

我希望能够创建/修改 EC2 实例的“名称”属性，即 Web UI 中“名称”显示的字段。

![亚马逊 EC2 网络用户界面](../Images/dfdacbad05ae4687013bc4f15f07f3fc.png)

我很乐意通过 Amazon API 生成实例，但是[我在 API 参考中找不到任何对实例命名的参考](https://i.stack.imgur.com/xryq0.png)。如何创建具有 Name 属性集的实例，或修改现有实例的 Name？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:35:04.443

*Name*属性只是一个常规标签，它恰好可用于/默认用于许多资源，包括Amazon [EC2](http://aws.amazon.com/ec2/)实例。

因此，您可以更改它，例如通过[Amazon EC2 API 工具](http://aws.amazon.com/developertools/351)（ec2-create-tags、ec2-describe-tags、ec2-delete-tags），它们依次促进相应的 API，请参阅[使用标签](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/Using_Tags.html)中的[API](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/Using_Tags.html#Using_Tags_API)部分了解更多详细信息：

> 可用 API 操作摘要：
> 
> *   **CreateTags** — 将一组标签添加到一组资源。**您还可以使用它来更新标签的值（覆盖现有值）。** *[强调我的]*
>     
>     
> *   **DeleteTags** — 从一组资源中删除一组标签。
>     
>     
> *   **DescribeTags** — 列出您的标签，或仅列出您指定的某些标签。

与往常一样，这些操作在[Amazon Elastic Compute Cloud API 参考中进一步详细说明：](http://docs.amazonwebservices.com/AWSEC2/latest/APIReference/Welcome.html?r=7437)

*   [创建标签](http://docs.amazonwebservices.com/AWSEC2/latest/APIReference/ApiReference-query-CreateTags.html)
*   [描述标签](http://docs.amazonwebservices.com/AWSEC2/latest/APIReference/ApiReference-query-DescribeTags.html)
*   [删除标签](http://docs.amazonwebservices.com/AWSEC2/latest/APIReference/ApiReference-query-DeleteTags.html)

# php - 如何从字符串和选定的字母中只提取整数？

> ID：10405118
> 
> 赞同：0
> 
> 时间：2012-05-01T22:12:32.173
> 
> 标签：php, regex, ereg-replace

我成功地从字符串中提取整数。

怎么做，但包括字符串：“k”、“m”和“b”？

*此代码采用给定的网站代码并提取数字，我需要数字和“k”、“m”和“b”*

```
$objectId = 15259;
$lines = file('http://testwebsite.com?obj=' . $objectId);
foreach ($lines as $line_num => $line) {
    $lineCrawl = htmlspecialchars($line);
    $stringSum = "$stringSum$lineCrawl";
}

function get_string_between($string, $start, $end){
    $string = " ".$string;
    $ini = strpos($string,$start);
    if ($ini == 0) return "";
    $ini += strlen($start);
    $len = strpos($string,$end,$ini) - $ini;
    return substr($string,$ini,$len);
}

$parsed = get_string_between($stringSum, "Current guide price", "Today");

$guideprice = ereg_replace("[^0-9]", "", $parsed); 

echo $guideprice; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:26:48.263

更改`0-9`为`0-9kmb`应该工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T04:41:02.557

更改代码以更好地使用正则表达式：

```
<? //PHP 5.4+
$matches = [];
\preg_match(
    <<<'REGEX'
`(?x)
    Current \s guide \s price
    \D* (?<price> \d+ [kmb] \s )
    Today
`u
REGEX
,   \file_get_contents('http://testwebsite.com?obj=' . 15259),
    $matches
);
echo $matches['price'];
?> 
```

# php - 使用 LIKE 从表 phpmyadmin 中选择（关键字）

> ID：10405122
> 
> 赞同：1
> 
> 时间：2012-05-01T22:12:52.500
> 
> 标签：php, mysql, select, phpmyadmin, sql-like

继我的上一个问题之后：

我现在使用的语句：

```
 if (isset($_GET['url'])) {
        $url = $_GET['url'];
    }

      SELECT name, url FROM table WHERE species LIKE '%$url%' 
```

`species`可能有内容喜欢`"Brown & Rainbow Trout, Pike"`

但是我说褐鳟的网址是：`/fishing/browntrout/`

这基本上可以防止上面的语句返回任何结果。

显然它适用于 say ：`/fishing/pike/`只是不适用于有 2 个名字的鱼。

解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:19:43.527

尝试制作网址`/fishing/brown_trout/`。然后尝试这样的事情：

```
if (isset($_GET['url'])) { // "brown_trout"
    $url = str_replace('_', '%', $_GET['url']); // "brown%trout"
}

SELECT name, url FROM table WHERE species LIKE '%$url%' 
```

这将使查询：

```
SELECT name, url FROM table WHERE species LIKE '%brown%trout%' 
```

哪个应该工作。

# php - PHP foreach 成功循环在循环开始时重新分配一个变量

> ID：10405124
> 
> 赞同：1
> 
> 时间：2012-05-01T22:13:04.030
> 
> 标签：php, mysql

我有一个循环，它查询 mysql 进行搜索，但搜索将在查询结束时更改。我发现我的编码是我现在没有的是我无法将变量重新分配给新的搜索查询，或者无论如何都不正确。

我添加了 echo 来看看它在做什么。

假设 John 被分配到 $preg_split

我想要做的是将一个字符与数据库匹配，如果数据库中的第一个字符（例如 J 匹配）然后从 $pre_split 分配第二个字符，它是 o 所以 $char 将是 jo

所以开头的变量 $char 应该用 jo 更新

相反，出于某种原因，我确信我只是没有正确编写代码，因为它回显不是 jo ..

所以我有点困惑为什么它是第二个字符而不是第一个字符。

```
$NG_implode = implode("", $preg_split);

$NG_split = str_split($NG_implode, 1);
$i = '0';
$ia = '1';
$ib = '0';
$ic = '1';
$char = $NG_split[$ib];

foreach ($NG_split as $char)
{

    $NG_select_like = "SELECT word FROM checklist_filter WHERE word LIKE '".$char."%'";
    $NG_query = mysql_query($NG_select_like) or die(mysql_error());
    $NG_row = mysql_fetch_row($NG_query);
    $chars = str_split($char, 1);
    $row = str_split($NG_row[0], 1);
        if ($chars[$i] == $row[$i])
        {

            $char = $char.$NG_split[$ia];

            $ia++;
            $i++;
            if ($char == $NG_row[0]){break;}
            }else{$ib++; $char = $NG_split[$ib];}

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:26:51.853

`$char``$NG_split`在循环的每次新迭代中都设置为下一个值，因此您在循环`foreach`中分配的值将不再存在。你不能简单地这样做吗？`$char``foreach`

```
<?php
$str = "John";
$len = strlen($str);

$arr = array();
$i = 0;
while($i < $len) { 
    $arr[] = substr($str,0,$len-$i);
    $i++;
} 

var_dump($arr);
?> 
```

现在，如果您进行迭代，`$arr`您应该能够构建您感兴趣的查询。在 MySQL 中使用正则表达式可能有一种更有效的方法来获得您正在寻找的结果，但如果您可以分享一个更多关于你的用例。

# ajax - Yii，如何在 cactiveform 中自定义提交按钮

> ID：10405130
> 
> 赞同：0
> 
> 时间：2012-05-01T22:13:28.743
> 
> 标签：ajax, widget, yii

我正在使用 CJuidialog 小部件来包装视图文件，并且我不想要默认的“保存”按钮，因为我想使用 javascript 对服务器进行 ajax 调用以进行数据验证，然后保存它。我在下面试过：

```
<?php
    if($model->isNewRecord)
         echo CHtml::submitButton('Create');
    else
         echo '<button onClick="javascript: _updatedata('.$model->id.');">Save</button>';
?> 
```

单击保存按钮时。它仍然会转到 actionUpdate 来保存表单数据，但是我创建了一个操作来保存我的数据。

```
function updatedata(id)
{
    var url = '<?php echo Yii::app()->request->baseUrl ?>' + '/index.php?r=user/profileupdate&id='+id;

    ......
    $.ajax({

        url: url,
        type: 'POST',
        dataType: "html",
        data:
        {
         ...
        },
        success: function(data, textStatus, XMLHttpRequest) {
                     if (data != null && data == "success")
                     {
                      //$('#xccdfgrid').trigger('reloadGrid');
                      $('#userprofile').dialog('close');
                     }
                     else
                       alert(data);
                  },
        ...... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T06:59:44.047

如果您的问题正确，那么您在说什么，而不是默认按钮，您需要一些可以执行 Ajax Things 仪式的东西？如果是，那么您需要拥有`Ajax Submit Button`. Yii 让您可以更轻松地使用 ajax。请参阅[CJuiDialog 和 AjaxSubmitButton](http://www.yiiframework.com/wiki/72/cjuidialog-and-ajaxsubmitbutton)

# django - 我需要在将数据从数据库放入模型之前拦截数据，反之亦然

> ID：10405131
> 
> 赞同：1
> 
> 时间：2012-05-01T22:13:30.273
> 
> 标签：django, django-models, django-admin

存储在数据库中的数据是 HTML。我无法改变这个事实，但我想将它隐藏在我的 django 管理站点中。

在数据库填充模型之前，我想捕获它并将 html 实体转换为 unicode。当模型保存到数据库时，我想反转这个过程。

我可以进行从 HTML 实体到 unicode 的实际转换，反之亦然，但我不太了解 Django 来完成这个。

我已经查看了管理员的模型表单，但是当数据显示在 list_display 或站点上的其他位置时，这将不起作用。

在哪里/如何最好的方式来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:31:10.700

[`custom field`](https://docs.djangoproject.com/en/dev/howto/custom-model-fields/#converting-database-values-to-python-objects)如果您想要自动调用/保存此字段的任何内容，请考虑制作一个。具体来说，在 中设置数据库到模型的转换，在 中设置`to_python`模型到数据库的转换`get_prep_value`。

如果这是专门针对管理员某个区域的行为，您也可以将其全部设置在`ModelAdmin`. `list_display`可以指向可以对输出做任何事情的只读字段。

纯管理员：

```
class ModelAdmin(admin.ModelAdmin):
    list_display = ('_myfield',)
    readonly_fields = ('_myfield', )
    form = MyModelForm # modelform with overriden save() and init
    # converting values to / from db.

    def _myfield(self, obj):
        return whatever_conversion_here(obj.myfield) 
```

# c++ - 错误 C3861：“strcpy”：找不到标识符

> ID：10405133
> 
> 赞同：-1
> 
> 时间：2012-05-01T22:13:38.657
> 
> 标签：c++, visual-studio-2010, visual-c++

为什么我会收到此错误？

*编辑我在底部发布了我的解决方案。事实证明，我无法在程序的特定部分使用 strcpy()。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T22:14:30.680

你的意思是`strcpy()`？`strcopy()`我所知道的没有标准函数。此外，如果您使用的是 C++，那么如果可能，请改用它，`std::string`因为这将为您处理复制和其他字符串操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T18:06:57.383

我想出了一个对我有用的解决方案。如果您遇到像我对 strcpy 所做的问题，您可以使用 size() 来计算字符串的大小，然后使用 while 循环遍历并将其添加到 char 数组中。这最终对我有用：

假设我们有一个带有 char 数组 data.name[30] 的数据结构成员，并且文件中有两个单词组成名称（第一个和最后一个），我们不能只使用 strcpy 将它添加到 char 数组中. 我们也不能使用字符串流，因为它会在过程中丢失姓氏。文件中的文本包括由分隔符 # 分隔的字段（以换行符结尾的最后一个字段除外。对于我使用的名称字段：

```
/* we already declared an ifstream inputFile and opened it. */
while(!inputFile.eof())
{
    string temp;
    getline(inputFile, temp, '#');
    int size=temp.size();
    int i=0;
    while (i<size)
    {
       data.name[i]=temp[i];
       i++;
    }      
}

data.name[i]=0;
inputFile.close(); 
```

# hadoop - 把东西从猪的袋子里拿出来

> ID：10405134
> 
> 赞同：3
> 
> 时间：2012-05-01T22:13:44.950
> 
> 标签：hadoop, group-by, apache-pig, bag

## 在猪的例子中：

```
A = LOAD 'student.txt' AS (name:chararray, term:chararray, gpa:float);

DUMP A;
(John,fl,3.9F)
(John,wt,3.7F)
(John,sp,4.0F)
(John,sm,3.8F)
(Mary,fl,3.8F)
(Mary,wt,3.9F)
(Mary,sp,4.0F)
(Mary,sm,4.0F)

B = GROUP A BY name;

DUMP B;
(John,{(John,fl,3.9F),(John,wt,3.7F),(John,sp,4.0F),(John,sm,3.8F)})
(Mary,{(Mary,fl,3.8F),(Mary,wt,3.9F),(Mary,sp,4.0F),(Mary,sm,4.0F)})

C = FOREACH B GENERATE A.name, AVG(A.gpa);

DUMP C;
({(John),(John),(John),(John)},3.850000023841858)
({(Mary),(Mary),(Mary),(Mary)},3.925000011920929) 
```

* * *

最后一个输出 A.name 是一个包。我怎样才能把东西从包里拿出来：

```
(John, 3.850000023841858)
(Mary, 3.925000011920929) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T03:10:31.713

`GROUP`创建一个名为 的魔法物品`group`，这是您分组的内容。这正是为此目的而制作的。

```
B = GROUP A BY name;

C = FOREACH B GENERATE group AS name, AVG(A.gpa); 
```

看看`DESCRIBE B;`，你会看到它`group`在里面。它是一个单一的值，`BY ...`代表`GROUP`.

# visual-studio-2010 - Visual Studio 的内置 Web 服务器是否支持 HTTP PUT？

> ID：10405137
> 
> 赞同：1
> 
> 时间：2012-05-01T22:14:20.443
> 
> 标签：visual-studio-2010, http-put, webdev.webserver

Visual Studio 2010（以及更早版本，尤其是 2010）中内置的 Web 服务器是否`WebDev.WebServer.exe`支持 HTTP 动词 PUT？如果是这样，它是默认支持还是需要配置？如果需要配置，请描述如何配置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:55:04.307

至少在 Visual Studio 2010 中，Visual Studio Development Server Web 服务器似乎*确实*支持 HTTP PUT 方法。

我之前回答说不是，但是我使用 PUT 方法提交请求的 URL 不正确。一旦我更正了 URL，请求就会被接受，而无需对 Visual Studio 或内置 Web 服务器设置进行任何其他更改。

# php - 使用 sprintf 进行排序、限制和查询

> ID：10405140
> 
> 赞同：0
> 
> 时间：2012-05-01T22:14:21.757
> 
> 标签：php, mysql

我在 SQL 查询中包含 ORDER 和 LIMIT 时遇到问题。

```
$STH_1 = $DBH_R->query("SELECT table_name                        
                         FROM information_schema.tables                        
                        WHERE table_name                        
                         LIKE 'v_c_ei\_9%'
                         ");
$stmts_1 = array();

//echo "date = ".       $date."<br>";                                 // $date is today date
$date_60 = date('Y-m-d', strtotime('-60 day', strtotime($date)));     // $date_60 = today - 60 days

while (($row_1 = $STH_1 -> fetch_assoc()) !== null){

$table_name = $row_1['table_name'];
$stmts_1[] = sprintf("SELECT *  
                        FROM $table_name
                       WHERE (date_time >= '$date_60') AND (ei_code = '1117')     
                     ");     
} 

// at this place I need help, I think. I have few data from every query but I want to reduce the number of solutions to 1 per table

$stmt_1 = implode("\nUNION\n", $stmts_1);  
$stmt_1 .= "\nORDER BY date_time ASC";      
$STH_5_2 = $DBH_R->query($stmt_1);        
while (($row_5_2 = $STH_5_2 -> fetch_assoc()) !== null){ 
```

上面的脚本工作正常。但我想限制数据的数量（我只需要每个表中的最后一个）。我尝试通过

```
ORDER BY date_time DESC LIMIT 0,1 
```

在 sprintf 查询中，但它不想工作。当我添加 ORDER 等。我有答案

> 致命错误：在“while (($row_5_2 ...”

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:20:04.187

查看您的代码，您可能会收到以下错误（但请检查以确保）：

```
UNION 和 ORDER BY 的错误使用

```

如果是这样，那是因为您缺少括号。请参阅[UNION](http://dev.mysql.com/doc/refman/5.6/en/union.html)的手册：

> 要将 ORDER BY 或 LIMIT 应用于单个 SELECT，请将子句放在括 SELECT 的括号内：
> 
> ```
> (SELECT a FROM t1 WHERE a=10 AND B=1 ORDER BY a LIMIT 10)
> UNION
> (SELECT a FROM t2 WHERE a=11 AND B=2 ORDER BY a LIMIT 10); 
> ```

# windows-server-2003 - Windows 2003 Server 上没有可用的 MediaTypeFormatter

> ID：10405148
> 
> 赞同：3
> 
> 时间：2012-05-01T22:14:54.950
> 
> 标签：windows-server-2003, asp.net-web-api

我有一个非常简单的 ApiController，它在 Win7 上运行良好，但在 Windows 2003 Server 上出现错误。

获取请求（来自浏览器或 $.getJson）：

[https://site.com:61656/AD/Authenticate?UserName=xxxx&Password=xxxxx&AuthKey=xxxxxx](https://site.com:61656/AD/Authenticate?UserName=xxxx&Password=xxxxx&AuthKey=xxxxxx)

我收到以下错误：

```
<Exception xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.datacontract.org/2004/07/System.Web.Http.Dispatcher">
<ExceptionType>System.InvalidOperationException</ExceptionType>
<Message>
No MediaTypeFormatter is available to read an object of type 'InputModel' from content with media type ''undefined''.
</Message>
<StackTrace>
at System.Net.Http.HttpContentExtensions.ReadAsAsync[T](HttpContent content, Type type, IEnumerable`1 formatters, IFormatterLogger formatterLogger) at System.Web.Http.ModelBinding.FormatterParameterBinding.ReadContentAsync(HttpRequestMessage request, Type type, IEnumerable`1 formatters, IFormatterLogger formatterLogger) at System.Web.Http.ModelBinding.FormatterParameterBinding.ExecuteBindingAsync(ModelMetadataProvider metadataProvider, HttpActionContext actionContext, CancellationToken cancellationToken) at System.Web.Http.Controllers.HttpActionBinding.<>c__DisplayClass1.<ExecuteBindingAsync>b__0(HttpParameterBinding parameterBinder) at System.Linq.Enumerable.WhereSelectArrayIterator`2.MoveNext() at System.Threading.Tasks.TaskHelpers.IterateImpl(IEnumerator`1 enumerator, CancellationToken cancellationToken)
</StackTrace>
</Exception> 
```

我正在使用 2012 年 5 月 1 日的 nuget 每晚构建包。在 HttpContentExtensions.cs 的以下行中，objectContent.Value 似乎在 Windows 2003 Server 上通过 null 而不是在 Windows 7 上：

```
 if (objectContent != null && objectContent.Value != null && type.IsAssignableFrom(objectContent.Value.GetType()))
        {
            return TaskHelpers.FromResult((T)objectContent.Value);
        } 
```

控制器动作：

```
 [AcceptVerbs("GET", "POST")]
    public ResultModel Authenticate(InputModel inputModel)
    {
        var test = ControllerContext.Request.Content.Headers.ContentType;
        //Console.WriteLine(test.MediaType);
        try
        {
            Console.WriteLine("AD Authorize request received: " + inputModel.UserName);
            var ldap = new LdapAuthentication();
            return ldap.Authenticate(inputModel);
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
            return new ResultModel();
        }
    } 
```

MediaType 在 Win7 上通过 null 出现，但在 Windows 2003 服务器上，请求永远不会到达控制器操作。

有没有办法指定一个默认的媒体格式化程序来处理“'undefined'”媒体类型？

编辑：

这是输入模型：

```
public class InputModel {

    public string UserName { get; set; }
    public string Password { get; set; }
    public string AuthKey { get; set; }
} 
```

这是（自主机）配置：

```
 var config = new HttpsSelfHostConfiguration(ConfigurationManager.AppSettings["serviceUrl"]);

        config.IncludeErrorDetailPolicy = IncludeErrorDetailPolicy.Always;
        config.Routes.MapHttpRoute("default", "{controller}/{action}");

        var server = new HttpSelfHostServer(config);

        try
        {
            server.OpenAsync().Wait();
            Console.WriteLine("Waiting..."); 
```

编辑＃2：

我注意到 Win7 与 Windows 2003 Server 的行为更有趣。如果我删除控制器操作上的 InputModel 参数，则在 Win7 和 Windows 2003 Server 上运行时都会调用该操作。但是在 Win7 上，它会从 GET 和 POST 请求中返回 JSON。在 Windows 2003 Server 上，它从 GET 返回 XML，从 POST 返回 JSON。

这导致我使用 POST 测试 InputModel 参数。我已验证正确调用了该操作，并且 InputModel 参数绑定在 Windows 2003 Server 上，但仅在使用 POST 时绑定。所以解决方法是在 GET 上手动获取参数。这允许 jQuery 的 $.getJSON 对 Windows 2003 Server 下的自托管服务器工作：

```
[AcceptVerbs("GET")]
public ResultModel Authenticate()
{

    try
    {
        var inputModel = new InputModel();
        var query = ControllerContext.Request.RequestUri.ParseQueryString();
        inputModel.UserName = query.GetValues("UserName") != null ? query.GetValues("UserName")[0] : null;
        inputModel.Password = query.GetValues("Password") != null ? query.GetValues("Password")[0] : null;
        inputModel.AuthKey = query.GetValues("AuthKey") != null ? query.GetValues("AuthKey")[0] : null;
        Console.WriteLine("AD Authorize request received: " + inputModel.UserName);
        var ldap = new LdapAuthentication();
        return ldap.Authenticate(inputModel);
    }
    catch (Exception ex)
    {
        Console.WriteLine(ex.Message);
        return new ResultModel();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T12:58:35.910

您可以显示配置的格式化程序以及您的 InputModel 类吗？看起来序列化程序无法处理您的课程。您是否在任何属性上使用接口？

# html - 如何底部居中网页？

> ID：10405149
> 
> 赞同：1
> 
> 时间：2012-05-01T22:15:07.867
> 
> 标签：html, css

如果屏幕足够大，可以在没有任何滚动条的情况下显示我的网页，我希望网页内容从屏幕底部向上呈现。这意味着没有被内容覆盖的额外屏幕空间的浏览器空白显示在网页内容的顶部，而不是底部。

这是通过将主体设置为如下样式来实现的（[示例](http://dl.dropbox.com/u/23278095/bottom_centered.html)）：

```
<body style="position:absolute; bottom:0; width:980px;"> 
```

鉴于页面的宽度应该是 980px，我如何将网页居中？通常这是通过以下方式实现的：

```
<body style="position:RELATIVE; width:980px; margin-left:auto; margin-right:auto;"> 
```

如何同时实现底部位置和居中页面？

我不想为左右边距设置显式值。我希望页面相对于屏幕居中（如“自动”）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:18:33.847

设置为 50% 并添加一个等于宽度一半的`left`负数。`margin-left`

```
<body style="position: absolute; bottom: 0; width: 980px; left: 50%; margin-left: -490px;"> 
```

# c++ - ＃包括 在 C++ 文件中的 iOS 中找不到文件

> ID：10405153
> 
> 赞同：12
> 
> 时间：2012-05-01T22:15:35.510
> 
> 标签：c++, ios, xcode

我在 iOS 下有一个客观的 c/c++ 项目，将其从 OS/X 移出，但出现“找不到文件”错误

```
#include <string> 
```

这是一个干净的项目，我刚刚添加了旧项目中的文件。STL 是否包含在 XCode 中设置？一次发现会产生多种可能性，例如

```
/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.0.sdk/usr/include/c++/4.2.1/debug/ 
```

但是将其添加到搜索路径只会引发更多错误。有什么建议么？（除了不要使用字符串 - 这是我正在移植的内部代码）

xcode 4.2.1, ios5.0 在 OS/X 10.7.3 上运行，它位于 .cpp 文件中，代码在 OS/X 上运行良好

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-01T22:33:49.577

你真的确定`<string>`只包含在 .cpp 文件中吗？

我刚刚在一个新项目上进行了测试，添加了一个 .cpp 文件并包含了 .cpp 文件`<string>`，它可以正常工作，就像预期的那样（相同的 Xcode 版本，相同的 SDK 版本）。

但是如果我包含`<string>`在一个 .m 文件中，那么我当然会得到一个“找不到文件”编译器错误。

所以仔细检查一下，因为错误可能来自这里。

您`<string>`是仅从 .cpp 文件中包含，还是从 .h 文件中包含旨在供 .cpp 实现使用的文件？
然后也许它也包含在 .m 文件中，因此出现错误。

还要检查你的预编译头文件，如果有的话，看看你是否在里面包含了一些 C++ 的东西......

还要记住，在后一种情况下，您可以在需要时依赖`__cplusplus`宏。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-23T20:55:46.407

如果您在 ObjC 文件中包含标题并且它包含，`<string>`那么您会遇到这样的错误。对于所有 .m 文件，XCode 使用 C 编译器（clang 或 llvm-gcc）。对于所有 .mm 文件，它将使用（clang++ 或 llvm-g++）。

我建议检查并将所有 .m 文件重命名为 .mm。包括 main.m 到 main.mm。

# git - 拆分存储库时是否可以保留移动文件的 git 版本历史记录？

> ID：10405162
> 
> 赞同：4
> 
> 时间：2012-05-01T22:16:14.423
> 
> 标签：git

我看到了这个[问题](https://stackoverflow.com/questions/2797191/how-to-split-a-git-repository-while-preserving-subdirectories)，但答案没有讨论保留在第一个存储库拆分之前移动的文件的历史记录。

我感兴趣的是以下场景：最初有一个 repo，由于重构，一些文件在不同时间在这个 repo 中移动。现在，我们通过从这个 repo 中选择文件的一个子集来创建另一个 repo 来拆分这个初始 repo。如果我们`filter-branch`使用`--subdirectory-filter`参数执行，我们可以将新 repo 限制为仅与剩余文件相关的历史记录。
但是，经过一些实验后，这似乎会破坏上次移动文件之前创建的文件中的历史记录（即，`git log --follow`不再有任何文件重命名记录要遵循）。

有没有办法解决这个问题，以便`git blame`在`git log`执行命令时仍然可以跟踪文件的完整历史记录`filter-branch`，或者有没有其他方法可以保留已移动或重命名的文件的历史记录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T12:01:53.143

保持大（原始）存储库原样，创建两个包含所需内容的新存储库，然后使用 git 移植将它们粘合到原始存储库。

这样你就不需要整个历史的两个单独的副本，那些根本不需要历史的人也不必克隆它。

# objective-c - 正/负按钮未正确显示

> ID：10405165
> 
> 赞同：1
> 
> 时间：2012-05-01T22:16:21.470
> 
> 标签：objective-c, uitextfield, ibaction

我正在尝试在 UItextfield 中的数字输入上添加一个正/负按钮，但我无法让它正常工作。我想要它做的只是从数字输入的前面添加或删除一个负号。我能够做到这一点，但是我找不到保持原始小数位数的方法。这是我尝试过的：

```
- (IBAction) negsign
{
    float input = [userinput.text floatValue];
    float result = ((input * (-1)));
    negstring = [NSString stringWithFormat:
                          @"%f", result];
    userinput.text = negstring;
} 
```

有了这个，我只得到一串零，比如-23.0000000。我尝试通过更改为 @"%.2f" 来限制小数位，但我不希望整个整数有额外的零，或者舍入超过 2 个小数位。我只是想让它取 34.658939 或 23 之类的值，然后设为 -3​​4.658939 或 -23。有没有人有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:57:10.997

真的，处理这个问题的最好方法是从一开始就永远不要将它从字符串转换。只需根据需要替换第一个字符，如下所示：

```
- (IBAction) negsign
{
    unichar firstCharacter = [userinput.text characterAtIndex:0];
    if (firstCharacter == '-') {
        // Change the first character to a + sign.
        userinput.text = [userinput.text stringByReplacingCharactersInRange:NSMakeRange(0, 1) 
                                                                 withString:@"+"];
    } else if (firstCharacter == '+') {
        // Change the first character to a - sign.
        userinput.text = [userinput.text stringByReplacingCharactersInRange:NSMakeRange(0, 1) 
                                                                 withString:@"-"];
    } else {
        // There is no sign so we assume that it is positive.  
        // Insert the - at the beginning.
        userinput.text = [userinput.text stringByReplacingCharactersInRange:NSMakeRange(0, 0) 
                                                                 withString:@"-"];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:31:02.773

在您的情况下最有效的是以下代码：

```
float input = [userinput.text floatValue];
float result = ((input * (-1)));
NSNumber *resultNum = [NSNumber numberWithFloat:result];
NSString *resultString = [resultObj stringValue];
userinput.text = resultString; 
```

如果您尝试将数字设为负数而不是反转符号，则最好替换`float result = ((input * (-1)));`为`float result = -ABS(input);`

# python - 使用 kerberos 进行结构身份验证

> ID：10405169
> 
> 赞同：1
> 
> 时间：2012-05-01T22:16:37.667
> 
> 标签：python, kerberos, fabric

我正在尝试编写一个将脚本放在远程主机上并以 root 身份运行的结构函数。我没有登录机器的root密码，也不是sudoer，但我在kerberos中确实有root原则。通常，我可以使用以下命令以 root 身份连接到计算机：

```
kinit username/root
(enter root principle pass)

ssh root@host 
```

以这种方式连接到主机时，不会提示我输入密码。

所以我想用织物来模拟这个过程。为此，我假设以下内容，

> 启动用户/root
> 
> fab task1 task2 --user=root

不幸的是，fabric 提示我输入密码，虽然我没有 root 密码，但我无法提供。据我所知，Fabric 不会让我为密码传递空值。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T05:41:30.457

看起来 Fabric 不支持 Kerberos 身份验证。如果我没记错 paramiko 库也不支持它，Fabric 使用 paramiko（不确定），所以它没有相应的支持。

你应该去这里问：http: [//docs.fabfile.org/en/1.4.1/index.html#getting-help](http://docs.fabfile.org/en/1.4.1/index.html#getting-help)

可以使用 IRC 频道以获得快速响应。

问候，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-10T10:19:17.353

有一个开放的请求请求支持 Fabric 中的 Kerberos，它看起来正在工作并且几乎可以合并：

[https://github.com/fabric/fabric/pull/1261](https://github.com/fabric/fabric/pull/1261)

# prolog - 什么是学习prolog的好网站？

> ID：10405177
> 
> 赞同：17
> 
> 时间：2012-05-01T22:17:21.260
> 
> 标签：prolog

我需要在 Prolog 中为课堂做一个项目，但他们根本没有用它自己的语言给我们任何指导。我正在阅读[http://kti.mff.cuni.cz/~bartak/prolog/contents.html](http://kti.mff.cuni.cz/~bartak/prolog/contents.html)但我对我正在阅读的内容一无所知。

有没有更好的资源可以分享？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-02T14:56:02.750

Bratko 的“Prolog Programming for AI”非常出色、清晰、生动、易于理解。Sterling 和 Shapiro 的“The Art of Prolog”也非常好，对基本/基础内容非常透彻。

布拉特科是我“点击”的那个人。我从他那里得到了这个口号（不记得是他写的还是我从他的书中提炼出来的）——*在 Prolog 中，理解问题就是得到你的答案*。正确地写下问题可以或多或少地为您提供一个可运行的程序。我记得读过关于 AVL 树的一页，他在其中写下了定义，我翻了页期待看到“解决方案”。但这已经是关于别的事情了。翻开这一页，我意识到，关于 AVL 树是什么的声明，已经是程序本身了。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-02T05:06:27.327

许多个月前，我喜欢 William F. Clocksin 和 Christopher S. Mellish 所著的《Prolog 编程》一书。它还有助于完成练习并了解语言的工作原理。您可以从这个站点[Werner Hett 的 P-99：九十九个 Prolog 问题](https://sites.google.com/site/prologsite/home)中解决一些问题，这里[SWI Prolog](http://www.swi-prolog.org/)是一个很好的实现。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-01T22:41:18.463

我喜欢[Prolog 中的 Adventures](http://www.amzi.com/AdventureInProlog/advtop.php)，但自学一门逻辑语言可能非常困难。通过导师或参加大学课程，你真的可以更快、更正确地学习。

# java - Netbeans Java 项目的自定义 BuildFile 失败

> ID：10405182
> 
> 赞同：0
> 
> 时间：2012-05-01T22:17:46.663
> 
> 标签：java, ant

我有一个 Netbeans 项目，它有一个源文件夹（在 Netbeans 项目文件夹之外）。现在，当我从 IDE 编译源代码时，一切正常。但是，当我使用自己的构建脚本时，它会在运行时出错。

该应用程序依赖于我使用`path`元素和标签中的相应`refid`属性指定的几个外部库`classpath`（参见下面的代码）

这是我的构建文件

```
<project name="XX" default="dist" basedir=".">

    <property name="dir.src" location="E:/XX git/xx/src"/>
    <property name="nbproj" location="E:/Netbeans Project"/>

    <property name="dir.dist" value="dist"/>

    <path id="libs">
        <fileset dir="${nbproj}/dist/lib">
            <include name="*.jar"/>
        </fileset>
    </path>

    <target name="clean">
        <delete dir="dist"/>
        <delete dir="release"/>
        <delete dir="build"/>
    </target>

    <target name="compile">
        <mkdir dir="build/classes"/>
        <javac srcdir="${dir.src}" destdir="build/classes" includeantruntime="false">
            <classpath refid="libs"/>
        </javac>
    </target>

</project> 
```

当我使用 编译它时`ant compile`，它会编译所有源文件而没有任何错误。但是，当我使用命令执行它时

```
java -cp "E:\Netbeans Project\dist\lib\*;." controller.CZSaw 
```

它很好地创建了应用程序 GUI，然后当我执行某些操作时，它失败并出现以下错误：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
        at javax.swing.ImageIcon.<init>(ImageIcon.java:167)
        at controller.viewsynchronizer.CZViewManager.getIcon(Unknown Source)
        at view.script.CZScriptView.<init>(Unknown Source)
        at controller.script.CZScriptProcessor.<init>(Unknown Source)
        at controller.script.CZScriptProcessor.getInstance(Unknown Source)
        ... 
```

我知道仅仅看源代码就很难指出一些错误。但是，由于相同的代码在 IDE 中编译并运行良好，我认为我的编译方式有问题。构建文件中是否有任何明显的错误。

如果我在这里错过了一些有用的信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:23:50.327

经典错误：假设因为在一个环境中“一切正常”意味着你做的每件事都是正确的，并且对随后出现的任何错误都无可指责。

这意味着您的 IDE 处理了一些您不知道的事情。

看看你的第一堂课：

```
controller.viewsynchronizer.CZViewManager.getIcon(Unknown Source) 
```

看起来您的控制器正在寻找不在 CLASSPATH 中的图标图像。

# php - 动态调整图片大小的最佳方法

> ID：10405183
> 
> 赞同：3
> 
> 时间：2012-05-01T22:17:47.397
> 
> 标签：php, image, image-scaling

这是一个模糊的问题，但我正在寻找建议，也许是有过这个问题经验的人的建议。我有一个 PHP 数组，包含不同大小的产品图像，我想在我的网页上显示四到一行。问题是因为它们的尺寸不同，我不知道如何在没有它们都非常“偏离”的情况下显示它们。

下面是一个看起来很奇怪的例子：

![奇怪的情况](../Images/edf875031f79d77fe5adde51a696ddd4.png)

我不知道放置这些图像的最佳方式，以免它们看起来“奇怪”。再说一次，我知道这有点含糊，但也许有人有过这方面的经验？其他购物网站如何处理这个问题？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:21:43.033

你考虑过神奇的[砌体 jQuery](http://masonry.desandro.com/)插件吗？

编辑：也可以不使用 jQuery：http: [//vanilla-masonry.desandro.com/](http://vanilla-masonry.desandro.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T14:33:47.373

如果可以的话，我建议您看看[我们的服务](http://cloudinary.com)，其中包括云中的图像转换（以及通过快速 CDN 交付）。

您可以使用基于重力的裁剪，同时保持纵横比或基于面部检测的裁剪以获得所需的图像。为名为“face_top”的上传图片生成 100x100 JPG 的一些示例：

[http://res.cloudinary.com/demo/image/upload/w_100,h_100,c_fill,g_north/face_top.jpg](http://res.cloudinary.com/demo/image/upload/w_100,h_100,c_fill,g_north/face_top.jpg)

![100x100，填充，北](../Images/73ebef68570c33f51f8486e6016214af.png)

[http://res.cloudinary.com/demo/image/upload/w_100,h_100,c_fill,g_south/face_top.jpg](http://res.cloudinary.com/demo/image/upload/w_100,h_100,c_fill,g_south/face_top.jpg)

![100x100，填充，南](../Images/d0b8aa48d39e3b91ec2f33cbd8f9c291.png)

[http://res.cloudinary.com/demo/image/upload/w_100,h_100,c_fill,g_face/face_top.jpg](http://res.cloudinary.com/demo/image/upload/w_100,h_100,c_fill,g_face/face_top.jpg)

![100x100，填充，面部](../Images/3d946084dd9672d5cc8e94060eef1e0a.png)

[http://res.cloudinary.com/demo/image/upload/w_100,h_100,c_thumb,g_face/face_top.jpg](http://res.cloudinary.com/demo/image/upload/w_100,h_100,c_thumb,g_face/face_top.jpg)

![100x100，拇指，脸部](../Images/34d8c51221452539535eff059594ea7a.png)

更多可用的[转换选项](http://cloudinary.com/documentation/image_transformations)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T22:26:31.560

我在另一个问题中[回答了类似](https://stackoverflow.com/questions/8674856/php-uploading-images-in-the-correct-dimensions)的问题，在那里我继续添加了一个示例，说明如何将图像调整为固定的缩略图尺寸，可选择保持纵横比（和信箱）或裁剪所有缩略图的内容一致。

请查看[http://pastebin.com/STzAxrZA](http://pastebin.com/STzAxrZA)并注意 image_resize_jpg() 中的 $maximize 参数

我想您需要决定是要更改 HTML（并保留奇数大小的图像）还是更改缩略图的生成方式

# java - 数据库多表和 ICS

> ID：10405188
> 
> 赞同：3
> 
> 时间：2012-05-01T22:18:24.210
> 
> 标签：java, android, sqlite

我有一个代码可以创建一个包含 2 个表的数据库。

```
private static final String tablecommandes="CREATE TABLE Commandes (no INTEGER NOT NULL PRIMARY KEY,equipe TEXT NULL,nom TEXT  NULL,adresse TEXT  NULL,ville TEXT  NULL,tel TEXT  NULL,frequence INTEGER NULL,datelastserv TIMESTAMP NULL,priorite INTEGER NULL);";
private static final String tabletravaux="CREATE TABLE Travaux (notrav INTEGER  NOT NULL PRIMARY KEY AUTOINCREMENT, travid TEXT NULL, notravlogiciel INTEGER  NULL, nocom INTEGER  NULL, debut TIMESTAMP  NULL,fin TIMESTAMP  NULL,temps INTEGER  NULL);";
private static final String DATABASE_CREATE = tablecommandes+" "+tabletravaux; 

    @Override
public void onCreate(SQLiteDatabase database) {
    database.execSQL(DATABASE_CREATE);
} 
```

当我尝试对两个表进行查询时，我得到“没有这样的表 Travaux”

```
public Cursor fc() throws SQLException {
Cursor mCursor = database.query(true, "Commandes , Travaux", new String[] {
            Fieldno,FieldNom,FieldAdresse,Fieldville,Fieldtel,Fieldfreq,Fieldlastserv,Fieldequipe},
            "Commande.NoCommande=Travaux.NoCommande",null, null, null, null,null);
    if (mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;

} 
```

这适用于我的 HC 平板电脑，但不适用于我的 ICS 平板电脑。任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:25:18.347

从 SQLiteDatabase.execSQL() 文档：

> 执行单个 SQL 语句...

因此，即使您的代码可以在某些设备上运行，也请尝试将构建语句分解为两个命令：

```
@Override
public void onCreate(SQLiteDatabase database) {
    database.execSQL(tablecommandes);
    database.execSQL(tabletravaux);
} 
```

# vb.net - Windows 窗体不会将变量传递给另一个？

> ID：10405189
> 
> 赞同：0
> 
> 时间：2012-05-01T22:18:30.067
> 
> 标签：vb.net

我的问题是有 4 个表格，其中 3 个表格允许我在它们之间传递变量。但是，预订表格的一个表格不允许我将 txtTotal 变量传递给确认表格。

所有其他表格都是我来做的，我没有做任何我能看到的不同的事情......我想也许表格的另一部分禁止我将 txtTotal 传递给 Confirmatin 表格。

以下是 Confirmation 表单，它应该显示 Booking 表单中 lblprice 中的 txtTotal 但什么也不显示

```
Public Class Confirmation

    Private Sub btnBack_Click(sender As System.Object, e As System.EventArgs) Handles btnBack.Click
        Dim FrmPayment As New Payment
        FrmPayment.Show()

        Me.Hide()
    End Sub

    Private Sub btnHome_Click(sender As System.Object, e As System.EventArgs) Handles btnHome.Click
        Dim FrmSelection As New Selection
        FrmSelection.Show()

        Me.Hide()
    End Sub

    Private Sub Label1_Click(sender As System.Object, e As System.EventArgs) Handles lblshow.Click, lbltime.Click, lbldate.Click, lblcust.Click, lblprice.Click

    End Sub

    Private Sub Confirmation_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        'lblprice displays nothing and the rest of the labels display the correct values
        lblprice.Text = Booking.txtTotal.Text

        lblshow.Text = Selection.cboShowSelect.Text
        lbldate.Text = Selection.cboDateSelect.Text
        lbltime.Text = Selection.cboTimeSelect.Text

    End Sub

End Class 
```

如果有帮助，这是预订表格中的所有代码

```
Public Class Booking

    Private Sub Booking_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
        'labels 1,4,6 display information from the comboboxes on the Selection Form
        Label1.Text = Selection.cboShowSelect.Text
        Label4.Text = Selection.cboDateSelect.Text
        Label6.Text = Selection.cboTimeSelect.Text

        Dim i As Integer
        For i = 1 To 4
            cboAdult.Items.Add(i)
            cboChild.Items.Add(i)
            cboSenior.Items.Add(i)
            cboStudent.Items.Add(i)
        Next i

    End Sub

    Public Sub ComboBoxes_SelectedIndexChanged(sender As System.Object, e As System.EventArgs) Handles cboAdult.SelectedIndexChanged, cboChild.SelectedIndexChanged, cboSenior.SelectedIndexChanged, cboStudent.SelectedIndexChanged
        'Assigned an evet handler to all of the comboboxes then calculates the price and puts in total box

        Dim Totalcombo1, Totalcombo2, Totalcombo3, Totalcombo4, Price As Decimal

        Dim valuecombo1 = (cboAdult.SelectedIndex + 1)  'finds position of option selected & adds one to get number of tickets
        Dim valuecombo2 = (cboChild.SelectedIndex + 1)
        Dim valuecombo3 = (cboSenior.SelectedIndex + 1)
        Dim valuecombo4 = (cboStudent.SelectedIndex + 1)

        'if the submit button is selected without there being a value selected from any combobox then error should appear, saying at least 1 ticket should be purchased.
        If (cboChild.SelectedIndex = -1) Then
            Totalcombo2 = 0
        Else
            Price = 6.5
            Totalcombo2 = valuecombo2 * Price
        End If

        'determines the ticketprice of combobox 1

        If (cboAdult.SelectedIndex = -1) Then
            Totalcombo1 = 0
        Else
            Price = 9
            Totalcombo1 = valuecombo1 * Price
        End If
        'determines the ticketprice of combobox 2

        If (cboSenior.SelectedIndex = -1) Then
            Totalcombo3 = 0
        Else
            Price = 6.5
            Totalcombo3 = valuecombo3 * Price
        End If
        'determines the ticketprice of combobox 3

        If (cboStudent.SelectedIndex = -1) Then
            Totalcombo4 = 0
        Else
            Price = 6.5
            Totalcombo4 = valuecombo4 * Price
        End If
        'determines the ticketprice of combobox 4

        If (cboAdult.SelectedIndex = -1 And cboChild.SelectedIndex = -1 And cboSenior.SelectedIndex = -1 And cboStudent.SelectedIndex = -1) Then
            MessageBox.Show("Please make at least one ticket selection before continuing. ")
        End If

        txtTotal.Text = Totalcombo1 + Totalcombo2 + Totalcombo3 + Totalcombo4
        'adds the totals of the ticketprices and then inserts into the Total label

    End Sub

    Private Sub ComboBox2_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cboChild.SelectedIndexChanged

    End Sub

    Private Sub btnBack_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnBack.Click
        Dim FrmSelection As New Selection
        FrmSelection.Show()

        Me.Hide()
    End Sub

    Sub Form_OpenBooking(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSubmit.Click
        If (cboChild.SelectedIndex >= 0 And (cboSenior.SelectedIndex = -1 And cboAdult.SelectedIndex = -1)) Then
            MessageBox.Show("A child must be accompanied by at least one adult", "Invalid Selection")

        ElseIf (txtTotal.Text > 0) Then         'if the total label is greater than zero then this means at least one ticket selection has been made

            Dim Form3 As New Payment     ' if above is true open Booking Form
            Form3.Show()

            Me.Hide()
        End If

    End Sub

    Private Sub Resetbtn_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnReset.Click
        cboAdult.SelectedIndex = -1

        cboChild.SelectedIndex = -1

        cboSenior.SelectedIndex = -1

        cboStudent.SelectedIndex = -1

        txtTotal.Text = 0
    End Sub

End Class 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T04:04:07.800

尝试这个

```
Public frm as new frmBooking
frm.txtTotal.Text= 
```

它应该工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:43:04.370

您需要使用您创建的 Form 的实际实例，而不是 Class 名称。您还应该确保打开[Option Strict](http://msdn.microsoft.com/en-US/library/zcd4xwzs.aspx)。

尝试`frmBooking.txtTotal.Text`代替`Booking.txtTotal.Text`

# javascript - 单击按钮时如何更改此输入的值？

> ID：10405191
> 
> 赞同：3
> 
> 时间：2012-05-01T22:18:46.103
> 
> 标签：javascript

我正在尝试编写一个具有多个文本框和 1 个按钮的程序。当用户单击按钮时，文本框的值变为`how are you`。

我不确定如何引用 `i`表达式的值`document.getElementById('text'+i).value= 'how are you'`

```
 <input name="text1" type="text" id="text1" value="textbox 1"                 
 onFocus="this.style.background ='yellow'" onBlur="this.style.background='white'">
 <input name="text2" type="text" id="text2" value="textbox 2"                             
 onFocus="this.style.background = 'yellow'" onBlur="this.style.background='white'"> 
```

```
function popup() {
    for( int i; i <2, i++) {      
      document.getElementById('text'+i).value= 'how are you'      
    }
} 
```

```
<input type="button" value="Click Me!" onclick="popup()"><br /> 
```

我已经更改了 for 循环部分，但它仍然无法正常工作：

```
function popup() {
    for( var i = 1, i <= 2, i++) {
      document.getElementById('text'+i).value= 'how are you'
    }
} 
```

该程序是否可以像 C++ 那样使用 foreach 循环？首先它将计算您拥有的文本框的数量，然后创建一个从 1 到文本框总数的列表，然后编写一个 for 循环来计算文本框。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T22:22:28.207

```
for(var i = 1; i <=2; i++) {
    document.getElementById('text'+i).value= 'how are you'      
} 
```

* * *

**说明：**

*   `i`你需要初始化`1`
*   您需要将中断条件更改为`i<=2`

`JavaScript`是动态类型语言，因此变量声明中没有类型。

**@esailija 遇到的错误：**

*   `i`未初始化为数字。
*   `,`代替`;`
*   `int i`代替`var i`
*   因一个错误而关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:22:34.650

在 JS 中使用这个词`var`来声明变量。不要忘记你的分号。

```
function popup() 
{  
  for(var i=1; i <= 2; i++) {     
    document.getElementById('text'+i).value = 'how are you';        
  }  
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T22:41:42.987

为简单起见，我将指出`for`只有两次迭代和循环内一行代码的循环有点浪费打字。你也可以这样做：

```
var str = 'how are you';
document.getElementById('text1').value = str;   
document.getElementById('text2').value = str; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T22:22:35.607

*   var用于在javascript中声明变量
*   变量应该在for循环中初始化
*   for-loop 条件应该是正确的，以确保它循环正确的次数。`< 2`会让它停在1。

据我了解，您希望 i 变量也显示在您的文本中。只需`+ i`在字符串末尾添加即可。否则，只需删除该部分。

这将循环通过“text1”和“text2”

```
for( var i=1; i <= 2; i++) {
  document.getElementById('text'+i).value = 'how are you' + i;
} 
```

# .net - VB.NET HID：SetupDiGetDeviceInterfaceDetail GetLastError() 显示 1784 (ERROR_INVALID_USER_BUFFER) 两次调用

> ID：10405193
> 
> 赞同：0
> 
> 时间：2012-05-01T22:19:02.947
> 
> 标签：.net, interop, usb, vb.net-2010, hid

我已经为此苦苦挣扎了一段时间，尝试了各种方法来使其正常工作。据我了解，SetupDiGetDeviceInterfaceDetail 应该第一次给出 1784 错误，因为第一次调用它的唯一目的是将 RequiredSize 设置为正确的值。第二次调用它时，它应该实际工作并给我一个有效的 DeviceInterfaceDetailData 结构。我不确定是什么导致第二次通话失败。

结构定义：

```
<StructLayout(LayoutKind.Sequential)> _
Public Structure SP_DEVICE_INTERFACE_DETAIL_DATA
    Public cbSize As UInt32
    <MarshalAs(UnmanagedType.ByValTStr, SizeConst:=256)> _
    Public DevicePath As String
End Structure

Public Structure SP_DEVICE_INTERFACE_DATA
    Public cbSize As Integer
    Public InterfaceClassGuid As System.Guid
    Public Flags As Integer
    Public Reserved As UIntPtr
End Structure

Public Structure SP_DEVINFO_DATA
    Public cbSize As Integer
    Public ClassGuid As System.Guid
    Public DevInst As Integer
    Public Reserved As UIntPtr
End Structure 
```

函数声明：

```
Public Declare Auto Function SetupDiGetClassDevs Lib "setupapi.dll" (ByRef ClassGuid As System.Guid, ByVal Enumerator As Integer, ByVal hwndParent As IntPtr, ByVal Flags As Integer) As IntPtr

Public Declare Auto Function SetupDiEnumDeviceInfo Lib "setupapi.dll" (ByVal DeviceInfoSet As Integer, ByVal MemberIndex As Integer, ByRef DeviceInfoData As SP_DEVINFO_DATA) As Boolean

Public Declare Auto Function SetupDiEnumDeviceInterfaces Lib "setupapi.dll" (ByVal DeviceInfoSet As IntPtr, ByRef DeviceInfoData As SP_DEVINFO_DATA, ByRef InterfaceClassGuid As System.Guid, ByVal MemberIndex As UInteger, ByRef DeviceInterfaceData As SP_DEVICE_INTERFACE_DATA) As Boolean

//For the first call
Public Declare Auto Function SetupDiGetDeviceInterfaceDetail Lib "setupapi.dll" (ByVal DeviceInfoSet As IntPtr, ByRef DeviceInterfaceData As SP_DEVICE_INTERFACE_DATA, ByVal DeviceInterfaceDetailData As IntPtr, ByVal DeviceInterfaceDetailDataSize As Integer, ByRef RequiredSize As Integer, ByRef DeviceInfoData As IntPtr) As Boolean

//For the second call
Public Declare Auto Function SetupDiGetDeviceInterfaceDetail Lib "setupapi.dll" (ByVal DeviceInfoSet As IntPtr, ByRef DeviceInterfaceData As SP_DEVICE_INTERFACE_DATA, ByRef DeviceInterfaceDetailData As SP_DEVICE_INTERFACE_DETAIL_DATA, ByVal DeviceInterfaceDetailDataSize As Integer, ByRef RequiredSize As Integer, ByRef DeviceInfoData As SP_DEVINFO_DATA) As Boolean 
```

函数调用：

```
 Dim DeviceInterfaceData As SP_DEVICE_INTERFACE_DATA
    Dim DeviceInterfaceDetailDataSize As Integer
    Dim DeviceInterfaceDetailData As SP_DEVICE_INTERFACE_DETAIL_DATA = Nothing
    Dim DeviceInfoSet As IntPtr
    Dim RequiredSize As Integer
    Dim HidGuid As System.Guid
    HidD_GetHidGuid(HidGuid)
    Dim LastError As Integer

    DeviceInterfaceData.cbSize = Marshal.SizeOf(DeviceInterfaceData)
    DeviceInterfaceDetailData.cbSize = Marshal.SizeOf(DeviceInterfaceDetailData
    DeviceInfoData.cbSize = Marshal.SizeOf(DeviceInfoData)

    DeviceInfoSet = SetupDiGetClassDevs(HidGuid, 0, IntPtr.Zero, DIGCF_PRESENT + DIGCF_DEVICEINTERFACE)

    success = SetupDiEnumDeviceInfo(DeviceInfoSet, 0, DeviceInfoData)
    LastError = GetLastError()

    success = SetupDiEnumDeviceInterfaces(DeviceInfoSet, DeviceInfoData, HidGuid, 0, DeviceInterfaceData)

    success = SetupDiGetDeviceInterfaceDetail(DeviceInfoSet, DeviceInterfaceData, IntPtr.Zero, 0, RequiredSize, IntPtr.Zero)
    //Success is false. GetLastError() shows 1784, but RequiredSize gets set to 166

    DeviceInterfaceDetailDataSize = RequiredSize + 16

    success = SetupDiGetDeviceInterfaceDetail(DeviceInfoSet, DeviceInterfaceData, DeviceInterfaceDetailData, DeviceInterfaceDetailDataSize, RequiredSize, DeviceInfoData)
    //Success is false. GetLastError() shows 1784, and DeviceInterfaceDetailData does not get set, so I can't get DeviceInterfaceDetailData.DevicePath 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T20:42:12.067

```
Private Structure SP_DEVICE_INTERFACE_DETAIL_DATA
    Dim cbSize As UInteger
    Dim DevicePath() As Char
End Structure

For target CPU x86: DetailedInterfaceDataStructure.cbSize = 6
For target CPU x64: DetailedInterfaceDataStructure.cbSize = 8 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T22:27:51.820

You have to set

```
DeviceInterfaceDetailData.cbSize = Marshal.SizeOf(UInt32) + Marshal.SizeOf(Char) 
```

and ignore the first result code returned from SetupDiGetDeviceInterfaceDetail.

The structure DeviceInterfaceDetailData is declared as

```
typedef struct _SP_DEVICE_INTERFACE_DETAIL_DATA {
  DWORD cbSize;
  TCHAR DevicePath[ANYSIZE_ARRAY];
} SP_DEVICE_INTERFACE_DETAIL_DATA, *PSP_DEVICE_INTERFACE_DETAIL_DATA; 
```

with ANYSIZE_ARRAY is ONE!

# nuget - nuget包里面

> ID：10405195
> 
> 赞同：0
> 
> 时间：2012-05-01T22:19:10.710
> 
> 标签：nuget, nuget-package

我了解[如何构建 dll nuget 包](http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package) 我想构建自己的 JavaScript nuget 包。我想了解 nuget 如何构建/安装 jQuery nuget 包。

我怎么知道如何构造 jQuery（或类似的 nuget 包）nuget 包？特别是我想知道如何将这些 *.js 复制/安装到 ASP.net MVC 项目的特定文件夹（脚本）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T05:06:05.280

NuGet 使用约定优于配置的方法。这使得将一些文件（图像、代码、javascript 等）注入目标 Visual Studio 项目的特定文件夹变得容易。

您可以简单地使用任何 zip 实用程序（例如 7zip）打开一个 .nupkg 文件，然后提取存档以查看其内容。

一个 NuGet 包可以有 3 个文件夹：lib、content 和 tools。内容文件夹中的任何内容都将使用与项目根目录相同的相对路径注入到目标项目中，与 nuget 包的内容文件夹相同。

更多信息在这里：[http ://docs.nuget.org/docs/creating-packages/package-conventions](http://docs.nuget.org/docs/creating-packages/package-conventions)

另外关于 jQuery 或其他类似的 Javascript 库是如何打包的，这里有一些提示。

已经“NuGetified”的公共 jQuery/jQuery 插件列表可以在这里查看[http://nuget.org/packages?q=jquery](http://nuget.org/packages?q=jquery) jQuery NuGet 包页面[http://nuget.org/packages/jQuery](http://nuget.org/packages/jQuery)有注释说它由 NuGet 社区包项目维护。

如果您访问[http://nugetpackages.codeplex.com/](http://nugetpackages.codeplex.com/)上的 CodePlex 项目并浏览源代码，您会发现它包含几个子项目。这些是各自开源（主要是 Javascript）项目的 NuGet 包项目。

您会注意到它们只是在 Content/Scripts 路径中包含相关的纯 Javascript 包，例如 jquery-1.8.3.js、jquery-1.8.3.min.js 等。

# c# - 反应式框架流切换

> ID：10405197
> 
> 赞同：1
> 
> 时间：2012-05-01T22:19:31.847
> 
> 标签：c#, .net, system.reactive

我正在寻找诸如 Switch 之类的扩展，但不是默认为最新的流，而是需要一个带有额外变量的开关，该变量可以根据另一个外部事件来回切换。

例如。我们有 observable，它是 2 个流的合并`A`，`B`当检测到事件`C`时，我希望 observable`A`通过，并且流`B`被忽略（丢失）。当检测到事件时，我希望删除并传递`D`可观察的流。`A``B`

什么是最好的 linq 运算符？我想我可以结合使用 where 和一些自定义解决方案，但确实在寻找更优雅的解决方案。

此外，我想尽可能避免从流中订阅/重新订阅。我只是发现订阅/重新订阅通常很难跟踪，而且很难链接运营商。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T00:32:50.240

有很多方法可以解决这个问题，让我们看一个简单的方法。在此示例中，我假设事件`A`和`B`属于同一类型。我还假设事件`C`(tied to `A`) 和`D`(tied to `D`) 也是可观察的，没有任何重要信息。

```
var streamA = new Subject<string>();
var streamB = new Subject<string>();

var switchToA = new Subject<Unit>();
var switchToB = new Subject<Unit>(); 
```

现在在这里我们在触发时打开一个`streamA`窗口，并在触发`switchToA`时关闭它`switchToB`，并对 执行相反的操作`streamB`，然后将它们合并：

```
public IObservable<string> SwitchingWindows(IObservable<string> streamA, IObservable<string> streamB, IObservable<Unit> switchToA, IObservable<Unit> switchToB)
{                                       
    var switchedA = streamA.Window(switchToA, _ => switchToB).Concat();
    var switchedB = streamB.Window(switchToB, _ => switchToA).Concat();

    return switchedA.Merge(switchedB);
} 
```

订阅：

```
 var all = SwitchingWindows(streamA, streamB, switchToA, switchToB);
    all.Subscribe(x => Console.WriteLine(x)); 
```

测试：

```
streamA.OnNext("a1");           // skip
switchToA.OnNext(Unit.Default); // switch A
streamA.OnNext("a2");           // shown
streamB.OnNext("b1");           // skip
streamA.OnNext("a3");           // shown
switchToB.OnNext(Unit.Default); // switch B
streamB.OnNext("b2");           // shown
streamB.OnNext("b3");           // shown
streamA.OnNext("a4");           // skip
switchToA.OnNext(Unit.Default); // switch A
streamA.OnNext("a5");           // shown
streamB.OnNext("b4");           // skip
streamB.OnNext("b5");           // skip
switchToB.OnNext(Unit.Default); // switch B
streamB.OnNext("b6");           // shown
streamA.OnNext("a6");           // skip 
```

输出如预期：

```
a2
a3
b2
b3
a5
b6 
```

最终流`all`是 100% 干净的。

# python - VirtualBox Python SDK, closeMachineSession -> XPCOM component has no attribute 'close'

> ID：10405208
> 
> 赞同：1
> 
> 时间：2012-05-01T22:20:14.823
> 
> 标签：python, virtualbox

I am trying to run a VirtualBox machine using the python sdk.

I ran the following commands (based on the [documentation](http://download.virtualbox.org/virtualbox/SDKRef.pdf) page 32):

```
from vboxapi import VirtualBoxManager
manager = VirtualBoxManager(None, None)
vbox = manager.vbox
name = "myVM"
mach = vbox.findMachine(name)
session = manager.mgr.getSessionObject(vbox)
progress = mach.launchVMProcess(session, "gui", "")

progress.waitForCompletion(-1) #successfully fires up myVM w/ GUI

manager.closeMachineSession(session) #error, see below 
```

The error I get is:

> raise AttributeError, "XPCOM component '%s' has no attribute '%s'" % (self._object_name_, attr) AttributeError: XPCOM component '@virtualbox.org/Session;1' has no attribute 'close'

I am trying to shutdown and close the VM from python.

Question:
How can I resolve this error and shut down the VM using python?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T14:13:14.787

`session.console.powerDown()` did the trick (I had to rtfm). I am still interested in knowing what the intention of that line is from the docs.

# javascript - 多组下拉菜单

> ID：10405209
> 
> 赞同：0
> 
> 时间：2012-05-01T22:20:24.463
> 
> 标签：javascript, jquery

在 jQuery 中，如何为每组手机获取多个下拉列表，例如：

客户可选择多于一部手机下单。首先，客户需要从下拉列表中选择一些手机（1 到 15）。

如果他们从下拉列表中选择了数字 5，则 5 组下拉菜单应如下所示：

**第一组：**

```
Select Phone [Dropdown / load entries via ajax] 

Select Contract Length [Dropdown / load entries via ajax]

Select Contract Plan [Dropdown / load entries via ajax]

Select Additional Addon [Dropdown  / load entries via ajax] 
```

**第二组：**

`Same dropdowns as above`

另一个问题是，如果由于未正确填写表单而出现错误（来自 PHP 的验证） - 它将重定向回同一页面，但需要再次重新选择下拉菜单。如何使它也起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:32:12.897

可以肯定的是，您必须将一些指示表单完成失败的变量带入会话或 html 中的某些隐藏元素，然后在文档加载时 - 检查该变量并手动调用这些下拉菜单。

或者

不允许单击提交按钮并检查 javascript 中的验证。然而，它不会那么安全，但它会为您和用户节省麻烦。我自己更喜欢在点击提交之前检查表单，等待几秒钟，直到页面重新加载，我面对我选择/写错东西的事实。

或者

使用 xmlhttprequest 或类似的方式自动验证提交点击，js 访问 php 文件，验证，返回结果并允许提交数据。不会超级安全，但是...您可以再次使用相同的 php 文件重新检查（如果有人试图非法传递一些数据而不是通过表单并且 xmlhttprequest 未能捕获它，则会被捕获）。对用户来说将是最安全和最好的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:38:22.553

假设这个标记：

```
<select id="qty">
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>5</option>
</select>
<div id="placeholder"></div> 
```

使用这个 JavaScript：

```
$('#qty').change(function() {
    var qty = $('#qty').val() * 1;

    $('#placeholder').html(''); //Clear existing.

    for (var i = 0; i < qty; i++)
    {
        $('#placeholder').append(
            '<select id="phone_' + i + '"></select>');
    }
}); 
```

在您的 PHP 脚本中，您需要检查每个可能的字段名称 - 可能会很费力，最好在提交之前将它们组合到隐藏字段中。

看起来@AndriusNaruševičius 已经回答了你问题的另一半。

# python - 创建和流式传输大型存档，而不将其存储在内存或磁盘中

> ID：10405210
> 
> 赞同：18
> 
> 时间：2012-05-01T22:20:40.290
> 
> 标签：python, http

我想允许用户一次下载多个大文件的存档。但是，文件和存档可能太大而无法存储在我的服务器上的内存或磁盘中（它们是从其他服务器即时流式传输的）。我想在将存档流式传输给用户时生成存档。

我可以使用 Tar 或 Zip 或任何最简单的方法。我正在使用 django，它允许我在响应中返回生成器或类似文件的对象。该对象可用于推动该过程。但是，我很难弄清楚如何围绕 zipfile 或 tarfile 库构建这种东西，而且我担心它们可能不支持在运行时读取文件，或者在构建存档时读取它。

[这个关于将迭代器转换为类文件对象的](https://stackoverflow.com/questions/6657820/python-convert-an-iterable-to-a-stream)答案可能会有所帮助。 `tarfile#addfile`需要一个可迭代的，但它似乎立即将它传递给`shutil.copyfileobj`，所以这可能不像我希望的那样对生成器友好。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-10T01:42:52.173

我最终使用了[SpiderOak ZipStream](https://github.com/gourneau/SpiderOak-zipstream)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-06-11T23:03:02.293

您可以将 ZipFile 流式传输到 Pylons 或 Django 响应 fileobj，方法是将 fileobj 包装在实现`tell()`. 这将在内存中缓冲 zip 中的每个单独文件，但流式传输 zip 本身。我们使用它来流式下载一个充满图像的 zip 文件，因此我们永远不会在内存中缓冲超过一个图像。

此示例流向`sys.stdout`. 对于 Pylons 使用`response.body_file`，对于 Django，您可以将其`HttpResponse`本身用作文件。

```
import zipfile
import sys

class StreamFile(object):
    def __init__(self, fileobj):
        self.fileobj = fileobj
        self.pos = 0

    def write(self, str):
        self.fileobj.write(str)
        self.pos += len(str)

    def tell(self):
        return self.pos

    def flush(self):
        self.fileobj.flush()

# Wrap a stream so ZipFile can use it
out = StreamFile(sys.stdout)
z = zipfile.ZipFile(out, 'w', zipfile.ZIP_DEFLATED)

for i in range(5):
    z.writestr("hello{0}.txt".format(i), "this is hello{0} contents\n".format(i) * 3)

z.close() 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-02T02:48:42.110

您可以通过生成和流式传输没有压缩的 zip 文件来做到这一点，这基本上只是在每个文件的内容之前添加标题。你是对的，图书馆不支持这一点，但你可以绕过它们来让它工作。

此代码使用一个类包装 zipfile.ZipFile，该类管理流并在文件到来时为文件创建 zipfile.ZipInfo 的实例。最后可以设置CRC和大小。您可以使用 put_file()、write() 和 flush() 将输入流中的数据推送到其中，并使用 read() 将数据从中读取到输出流中。

```
import struct      
import zipfile
import time

from StringIO import StringIO

class ZipStreamer(object):
    def __init__(self):
        self.out_stream = StringIO()

        # write to the stringIO with no compression
        self.zipfile = zipfile.ZipFile(self.out_stream, 'w', zipfile.ZIP_STORED)

        self.current_file = None

        self._last_streamed = 0

    def put_file(self, name, date_time=None):
        if date_time is None:
            date_time = time.localtime(time.time())[:6]

        zinfo = zipfile.ZipInfo(name, date_time)
        zinfo.compress_type = zipfile.ZIP_STORED
        zinfo.flag_bits = 0x08
        zinfo.external_attr = 0600 << 16
        zinfo.header_offset = self.out_stream.pos

        # write right values later
        zinfo.CRC = 0
        zinfo.file_size = 0
        zinfo.compress_size = 0

        self.zipfile._writecheck(zinfo)

        # write header to stream
        self.out_stream.write(zinfo.FileHeader())

        self.current_file = zinfo

    def flush(self):
        zinfo = self.current_file
        self.out_stream.write(struct.pack("<LLL", zinfo.CRC, zinfo.compress_size, zinfo.file_size))
        self.zipfile.filelist.append(zinfo)
        self.zipfile.NameToInfo[zinfo.filename] = zinfo
        self.current_file = None

    def write(self, bytes):
        self.out_stream.write(bytes)
        self.out_stream.flush()
        zinfo = self.current_file
        # update these...
        zinfo.CRC = zipfile.crc32(bytes, zinfo.CRC) & 0xffffffff
        zinfo.file_size += len(bytes)
        zinfo.compress_size += len(bytes)

    def read(self):
        i = self.out_stream.pos

        self.out_stream.seek(self._last_streamed)
        bytes = self.out_stream.read()

        self.out_stream.seek(i)
        self._last_streamed = i

        return bytes

    def close(self):
        self.zipfile.close() 
```

请记住，这段代码只是概念的快速证明，一旦我决定让 http 服务器自己处理这个问题，我就没有做进一步的开发或测试。如果您决定使用它，您应该检查的几件事是检查嵌套文件夹是否正确存档，以及文件名编码（无论如何，这对于 zip 文件来说总是很痛苦）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-10-11T19:41:06.077

这是 Pedro Werneck 的解决方案（从上面），但有一个修复程序以避免收集内存中的所有数据（`read`方法有点固定）：

```
class ZipStreamer(object):
    def __init__(self):
        self.out_stream = StringIO.StringIO()

        # write to the stringIO with no compression
        self.zipfile = zipfile.ZipFile(self.out_stream, 'w', zipfile.ZIP_STORED)

        self.current_file = None

        self._last_streamed = 0

    def put_file(self, name, date_time=None):
        if date_time is None:
            date_time = time.localtime(time.time())[:6]

        zinfo = zipfile.ZipInfo(name, date_time)
        zinfo.compress_type = zipfile.ZIP_STORED
        zinfo.flag_bits = 0x08
        zinfo.external_attr = 0600 << 16
        zinfo.header_offset = self.out_stream.pos

        # write right values later
        zinfo.CRC = 0
        zinfo.file_size = 0
        zinfo.compress_size = 0

        self.zipfile._writecheck(zinfo)

        # write header to mega_streamer
        self.out_stream.write(zinfo.FileHeader())

        self.current_file = zinfo

    def flush(self):
        zinfo = self.current_file
        self.out_stream.write(
            struct.pack("<LLL", zinfo.CRC, zinfo.compress_size,
                        zinfo.file_size))
        self.zipfile.filelist.append(zinfo)
        self.zipfile.NameToInfo[zinfo.filename] = zinfo
        self.current_file = None

    def write(self, bytes):
        self.out_stream.write(bytes)
        self.out_stream.flush()
        zinfo = self.current_file
        # update these...
        zinfo.CRC = zipfile.crc32(bytes, zinfo.CRC) & 0xffffffff
        zinfo.file_size += len(bytes)
        zinfo.compress_size += len(bytes)

    def read(self):
        self.out_stream.seek(self._last_streamed)
        bytes = self.out_stream.read()
        self._last_streamed = 0

        # cleaning up memory in each iteration
        self.out_stream.seek(0) 
        self.out_stream.truncate()
        self.out_stream.flush()

        return bytes

    def close(self):
        self.zipfile.close() 
```

然后您可以将`stream_generator`函数用作 zip 文件的流

```
def stream_generator(files_paths):
    s = ZipStreamer()
    for f in files_paths:
        s.put_file(f)
        with open(f) as _f:
            s.write(_f.read())
        s.flush()
        yield s.read()
    s.close() 
```

[猎鹰](https://falconframework.org)的例子：

```
class StreamZipEndpoint(object):
    def on_get(self, req, resp):
        files_pathes = [
            '/path/to/file/1',
            '/path/to/file/2',
        ]
        zip_filename = 'output_filename.zip'
        resp.content_type = 'application/zip'
        resp.set_headers([
            ('Content-Disposition', 'attachment; filename="%s"' % (
                zip_filename,))
        ])

        resp.stream = stream_generator(files_pathes) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-29T18:09:10.890

一个选项是使用[stream-zip](https://github.com/uktrade/stream-zip)（完全披露：由我编写）

稍微修改其示例：

```
from datetime import datetime
from stream_zip import stream_zip, ZIP_64

def non_zipped_files():
    modified_at = datetime.now()
    perms = 0o600

    # Hard coded in this example, but in real cases could
    # for example yield data from a remote source
    def file_1_data():
        for i in range(0, 1000):
            yield b'Some bytes'

    def file_2_data():
        for i in range(0, 1000):
            yield b'Some bytes'

    yield 'my-file-1.txt', modified_at, perms, ZIP64, file_1_data()
    yield 'my-file-2.txt', modified_at, perms, ZIP64, file_2_data()

zipped_chunks = stream_zip(non_zipped_files())

# Can print each chunk, or return them to a client,
# say using Django's StreamingHttpResponse
for zipped_chunk in zipped_chunks:
    print(zipped_chunk) 
```

# wordpress - WooThemes + 自定义侧边栏和存档模板问题

> ID：10405214
> 
> 赞同：0
> 
> 时间：2012-05-01T22:21:29.800
> 
> 标签：wordpress, wordpress-theming

好奇是否有人可以帮助我。我正在使用 WooThemes 创建这个网站。

简而言之： - Wordpress + Woo 主题 - 自定义帖子类型 + 分类法 - Woo 主题侧边栏

目前我有一个 CPT，“Broadcast”，它的分类是“Broadcast_Categories”。我添加了一个新的广播“项目”，在左侧我有自定义侧边栏，使用 WooThemes 侧边栏管理器作为“模板”。

当我从 Broadcast_categories 过滤时，据我了解，我得到“分类”页面。但我似乎无法在此页面上显示我的自定义侧边栏。

所以我的想法是使用一个基本的Wordpress“页面”并应用一个“模板”。但我似乎无法将两者联系在一起。

我知道这可能会令人困惑，所以这里有一个“示例链接”。 [http://tech.stickystudios.ca/products/broadcast/](http://tech.stickystudios.ca/products/broadcast/)

如果您单击左侧的类别之一，您会注意到侧边栏消失并且背景更改 b/c 它没有使用正确的“模板”。

有什么想法或方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T19:20:45.933

WooThemes 推出了一个新的侧边栏管理器来解决这个问题！

# c# - 检测图像的背景颜色

> ID：10405216
> 
> 赞同：0
> 
> 时间：2012-05-01T22:21:50.143
> 
> 标签：c#, system.drawing

我想获得一些关于检测 jpg 图像的背景颜色的帮助。

我在源目录中有很多图像，我想在我的 ASP.NET 应用程序中逐个读取它们，并检测它们是否具有白色背景。

如何检测背景颜色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:34:58.217

您不能只读取边框像素，这会给边框周围有框的图标带来误导性结果，例如，当答案应该是白色时，LoveFilm 徽标会返回红色。

计算重复次数最多的颜色也会产生误导，例如，在 MSDN 徽标的情况下，背景是透明的（边框也是如此），但重复次数最多的颜色可能是深蓝色（我没有计算过）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:40:57.757

您应该尝试使用 GetPixel 函数，您可以在此处找到一些文档：

[GetPixel Function](http://msdn.microsoft.com/en-us/library/dd144909%28v=vs.85%29.aspx)

您只需选择坐标即可获得 RGB 值。

然后，您可以尝试使用尽可能多的坐标来获得很多价值。

只需检查您的值以了解它是否为白色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T22:50:47.057

尝试这样的事情：

```
public bool IsBackgroundWhite(Bitmap theImageBitmap)
{
    Bitmap bmp = new Bitmap(theImageBitmap);
    int weight = 0;

    for (int x=0;x<bmp.Width;x++) {
        weight += GetWeight(bmp.GetPixel(x,0));
        weight += GetWeight(bmp.GetPixel(x,bmp.Height-1));
    }

    for (int y=0;y<bmp.Height;y++) {
        weight += GetWeight(bmp.GetPixel(0,y));
        weight += GetWeight(bmp.GetPixel(bmp.Width-1,y));
    }

    if (weight > 255)
        return true;
    return false;
}

private int GetWeight(Color c)
{
    if (c.R >= 200 && c.B >= 200 && C.G >= 200)
    {
        int n1 = 255 - c.R;
        int n2 = 255 - c.G;
        int n3 = 255 - c.B;

        return (int)((n1+n2+n3) / 3)
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T22:34:15.037

我猜您的意思是靠近图像边框的像素的颜色是否为白色。否则你的表述太模糊了。

你可以检查一下，边界周围的像素是白色的（你可以考虑先做一些平滑来消除噪音）

# asp.net - 当数据来自多个表时，GridView 不更新

> ID：10405218
> 
> 赞同：0
> 
> 时间：2012-05-01T22:22:06.473
> 
> 标签：asp.net, gridview

我有一个**GridView**控件，它从两个表中获取数据，第一个包含一个主键、一个名称（字符串）和第二个表的外键，第二个表包含一个主键“由提到的外键引用”和一个名称（字符串），我能够使用内部连接显示 id、名称（第一个表）和名称（第二个表），但我无法使用 GridView 更新表中的数据（按下更新时没有任何反应根本，或没有发生变化）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:28:42.757

根据我对您的问题的理解，您所遇到的情况是您必须应用嵌套的网格视图。

网格视图显示表（数据表或集合）的内容。如果要显示主网格视图的每一行内的其他集合，则需要构建第二个 Gridview 或列表视图或中继器来显示该信息。

使用主 griview，您可以使用 OnItemDataBound 来分配嵌套 gridview 的数据源，或者您选择根据行的主键显示该信息的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:41:09.810

不要打扰我在 Microsoft 网站上找到了问题的解决方案，很抱歉我没有把我的问题说得很清楚，这里是我正在寻找的链接：[使用模板字段编辑](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.templatefield.edititemtemplate.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T00:52:32.253

也许在单击更新后，您需要再次调用您的读取方法来刷新您的网格视图。

就像是：

```
 UpdateMethod()
  {

  //YOUR UPDATE STUFF

  //REBIND DATA WITH UPDATED RECORDS
  RefreshMethod(); //YOUR BINDING METHOD TO DATAGRID STUFF

 } 
```

# javascript - jqTree - 从 json 创建树数据

> ID：10405222
> 
> 赞同：2
> 
> 时间：2012-05-01T22:22:31.943
> 
> 标签：javascript, jquery, tree

我正在尝试使用 jqTree 显示一棵树 - [http://mbraak.github.com/jqTree](http://mbraak.github.com/jqTree)

我需要从 JSON 创建树数据的帮助。

我的 JSON 数据如下所示：

```
 {
"d" : {
"results": [
    {
        "Title": "Committee A", 
        "ReportsToId": null, 
        "Rank": 1, 
        "Id": 5
    }, 
    {   
        "Title": "Committee B", 
        "ReportsToId": 5, 
        "Rank": 2, 
        "Id": 7
    }, 
    {
        "Title": "Committee C",
        "ReportsToId": 7, 
        "Rank": 3, 
        "Id": 13
    }, 
    {   
        "Title": "Committee D",
        "ReportsToId": 13, 
        "Rank": 4, 
        "Id": 1
    }, 
    {
        "Title": "Committee E",
        "ReportsToId": 13, 
        "Rank": 4, 
        "Id": 3
    }
]
}
} 
```

我想结束这个：

```
 var treeData = [
    {
        label: 'Committee A',
        children: [
            {
                label: 'Committee B',
                children: [
                {
                    label: 'Committee C',
                    children: [
                        { label: 'Committee D' },
                        { label: 'Committee E' }
                    ]
                }]
            }
            ]
    }
    ]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T00:04:42.067

这是改编自[http://www.jqwidgets.com/populating-jquery-tree-with-json-data/](http://www.jqwidgets.com/populating-jquery-tree-with-json-data/)的解决方案：

```
var jqTreeData = function (data) {
        var source = [];
        var items = [];
        // build hierarchical source.
        for (i = 0; i < data.length; i++) {
            var item = data[i];
            var title = item["Title"];
            var reportsToId = item["ReportsToId"];
            var id = item["Id"];

            if (items[reportsToId]) {
                var item =
                {
                    label: title
                };

                if (!items[reportsToId].children) {
                    items[reportsToId].children = [];
                }

                items[reportsToId].children[items[reportsToId].children.length] = item;
                items[id] = item;
            }
            else {
                items[id] =
                {
                    label: title
                };

                source[0] = items[id];
            }
        }
        return source;
    } 
```

# lua - Lua 是否允许带有奇怪数量的参数的元方法？

> ID：10405225
> 
> 赞同：0
> 
> 时间：2012-05-01T22:22:38.840
> 
> 标签：lua, operators, metatable, lua-userdata

例如，我可以声明一个带有`__index`两个参数的元方法，然后执行类似的操作`myuserdata[somearg1, somearg2]`吗？并不是说我想使用它，或者我知道它为什么有用，我只是想知道在我处理将 c++ 绑定到 Lua 的库中我是否可以并且应该强制执行一项权利（`__call`当然元方法除外）绑定为元方法的函数的参数数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:06:27.623

Lua 函数*可以*接收任意数量的函数。您的元方法也是如此。

但是，元表不允许您更改运算符的数量。一元运算符（not、# 等）的元方法只会在一个参数上*传递。*二元运算符（+、%、==、^、.. 等）的元方法只会*传递*两个参数。

表索引操作在 Lua 语法中被定义为接受一个参数，所以这就是您可以使用的所有内容，并且您的所有索引元方法都将收到。

唯一可以接收任意数量参数的元方法是`call`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:24:48.043

Lua 通常不对函数强制执行参数计数：http: [//ideone.com/kAynR](http://ideone.com/kAynR)

也就是说，映射到*语法*的元方法受语法约束——例如，Lua 语法不允许`,`在索引中使用 -separated 值`[]`：

```
luac: ']' expected near ',' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T22:24:02.060

不，索引运算符只能接受一个参数，就像在 C++ 中一样。虽然索引运算符的函数可以有任意多的参数，但如果您实际上尝试在内部使用多个参数，则会`[]`出现错误。

这取决于运营商。所以你既不能也不需要“强制”它。

# web-services - 访问 Delphi SOAP 服务器中的原始 TWebRequest 对象

> ID：10405227
> 
> 赞同：9
> 
> 时间：2012-05-01T22:22:48.060
> 
> 标签：web-services, delphi, soap, httpwebrequest

摘要：如何在 Delphi Soap 服务器应用程序中访问原始[TWebRequest对象？](http://docs.embarcadero.com/products/rad_studio/delphiAndcpp2009/HelpUpdate2/EN/html/delphivclwin32/HTTPApp_TWebRequest.html)

我的网络服务`ITest`使用方法发布服务`CallMe`：

```
ITest = interface(IInvokable)
['{AA226176-FFAD-488F-8768-99E706450F31}']
  function CallMe: string; stdcall;
end;
...
initialization
InvRegistry.RegisterInterface(TypeInfo(ITest)); 
```

这个接口在一个类中实现：

```
TTest = class(TInvokableClass, ITest)
public
  function CallMe: string; stdcall;
end;
...
initialization
InvRegistry.RegisterInvokableClass(TTest, TestFactory); 
```

如何访问`TWebRequest`此方法实现内部的原始对象？例如，如果我想检查设置了哪些 cookie，或者读取请求中的其他属性：

```
function TTest.CallMe: string;
begin
  // how to access TWebRequest object
  ...
end; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T08:03:32.837

```
uses
  System.SysUtils,
  Web.HTTPApp,
  Soap.WebBrokerSOAP;

function TTest.CallMe: string;
var
  WebDispatcher: IWebDispatcherAccess;
begin
  Result := '';
  if Supports(GetSOAPWebModule, IWebDispatcherAccess, WebDispatcher) then
    Result := Format('You are calling me from: %s', [WebDispatcher.Request.RemoteIP]);
end; 
```

# sql-server - 创建从 Access 到 SQL Server 的 ODBC 连接

> ID：10405228
> 
> 赞同：1
> 
> 时间：2012-05-01T22:22:54.050
> 
> 标签：sql-server, ms-access, odbc, windows-server-2008

我需要帮助从空白访问 2010 数据库连接到我的远程 SQL Server 2005 数据库。这是因为我将在 Access 中编写所有客户端应用程序，并使用 SQL Server 将所有内容存储在服务器上。我正在使用向导，并尝试创建一个新的 DSN。我要做什么：

```
Which SQL Server do you want to connect to?
Server: 
```

服务器是windows server 2008，它是远程的。我一直在使用 .RDP 文件连接到它，但我不确定如何设置链接。

请让我澄清任何没有意义的事情。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:30:56.910

输入装有 SQL Server 的服务器的 IP 地址或 Windows 主机名。

您需要确保您的服务器在其内部软件防火墙中打开了端口 1433。如果您通过任何类型的路由器，该路由器还需要进行端口转发，并且可能防火墙为端口 1433 打开。

此外，您需要确保您的 SQL Server 实例设置为使用端口 1433 侦听 TCP/IP（除非您选择不同的端口）。

您最好先尝试从 SQL Server Management Studio 连接到它。一旦你完成了这项工作，你应该可以更轻松地设置你的 DSN。

有关故障排除，请参阅：http:
[//blogs.msdn.com/b/sql_protocols/archive/2005/10/22/sql-server-2005-connectivity-issue-troubleshoot-part-i.aspx](http://blogs.msdn.com/b/sql_protocols/archive/2005/10/22/sql-server-2005-connectivity-issue-troubleshoot-part-i.aspx)
[http://blogs .msdn.com/b/sql_protocols/archive/2006/09/30/sql-server-2005-remote-connectivity-issue-troubleshooting.aspx](http://blogs.msdn.com/b/sql_protocols/archive/2006/09/30/sql-server-2005-remote-connectivity-issue-troubleshooting.aspx)

# javascript - 为不同线程的 Disqus 评论创建动态弹出窗口

> ID：10405230
> 
> 赞同：1
> 
> 时间：2012-05-01T22:23:02.590
> 
> 标签：javascript, jquery, dynamic, uniqueidentifier, disqus

编辑：似乎 Disqus 使用当前页面 URL 作为评论线程标识符，尽管我明确指出：

```
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_identifier = "@Model.UniqueThreadIdentifier"; <--- HERE
    var disqus_shortname = 'foo';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script> 
```

阅读下文了解更多详情。

* * *

Disqus 说我可以用唯一标识符识别“页面”。

现在在这个特定页面中大约有 10 个项目，我希望每个项目都有一个个人 Disqus 讨论线程。

所以这是加载的实际页面：

```
@foreach (var strong in Model.StrongAgainst)
{
    <div class="pick">        
            <div class="actions">
                <a href="#modalDialogue" data-toggle="modal" 
                   id="@strong.UniqueThreadIdentifier" class="btn btn-comment">
                    <i class="icon-comment"></i>
                    999
                </a>
            </div>
        </div>

    </div>
} 
```

这`@UniqueThreadIdentifier`就是我用来让 Disqus 加载适当线程的方法。

接下来，在同一个 HTML 视图中，我有这个 Javascript 行，它使用 UniqueIdentifier 返回一个带有适当 Disqus 配置和 HTML 的 PartialView：

```
<script type="text/javascript" language="javascript">
    $(document).ready(function () {
        $(document).on("click", "#strong-against .pick .data .actions .btn-comment", function () {
            var commentUniqueVar = $(this).attr("id");
            $.ajax({
                url: '/Counterpicks/GetCommentThread',
                data: { uniqueidentifier: commentUniqueVar },
                success: function (data) {
                    $('#strongAgainstCommentModal').html(data);
                    alert("Finished loading.");
                }
            });
        });
    });
</script> 
```

到这里为止，100% 确认正确的值被加载到 HTML 中。

这是部分视图：

```
<div class="modal-body">    
    <div id="disqus_thread">
    </div>
    <script type="text/javascript">
        var disqus_developer = 1;
        var disqus_identifier = "@Model.UniqueThreadIdentifier";
        var disqus_shortname = 'foobar';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>
        Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments
            powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">
        Disqus</span></a>    
</div> 
```

请注意我如何设置`disqus_identifier`使用具有正确值的强类型模型。

我唯一的猜测是，当声明这样的变量时，它是全局创建的吗？（我认为？）Disque javascript 库总是会使用我分配给它的第一个值。正确的？

如何将正确的标识符正确加载到 Disqus javascript 库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T20:09:10.230

标识符允许您在多个 URL 上显示同一个线程，但您不能单独使用新标识符在同一个 URL 上显示多个线程（这是一个常见的误解）。我们开发了一种使用 AJAX 重新加载线程的方法，称为 Disqus.Reset，记录在这里：[http ://docs.disqus.com/help/85/](http://docs.disqus.com/help/85/)

你也可以在没有 Disqus.Reset 的情况下破解它，这在这篇文章中得到了证明：http: [//collaborable.com/blog/disqus-jquery-hack-awesome-ux](http://collaborable.com/blog/disqus-jquery-hack-awesome-ux)

# python - 检查跨周期边界的欧几里得距离

> ID：10405231
> 
> 赞同：2
> 
> 时间：2012-05-01T22:23:14.377
> 
> 标签：python, math, geometry

当边界条件是周期性的时，检查两点之间欧几里得距离的最佳方法是什么？我尝试取距离和（范围 - 距离）的最小值，但我认为由于我构建程序的方式，这会产生奇怪的输出。我希望有另一种我可以采用的好方法来解决这个问题，而不是重新评估函数的其余部分。

这是在 Python 中。目前使用 numpy.linalg.norm 查找欧几里德距离，尽管有 SciPy pdist 例程可以做我猜想的相同事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T22:28:31.680

您应该在每个维度上分别检查 dx 和 range-dx 之间的较小值。

```
def distance(p1, p2):
    total = 0
    for i, (a, b) in enumerate(zip(p1, p2)):
        delta = abs(b - a)
        if delta > dimension[i] - delta:
            delta = dimension[i] - delta
        total += delta ** 2
    return total ** 0.5 
```

# jax-rs - CDI 在 JAX-RS MessageBodyWriter 中有效，但在 MessageBodyReader 中无效

> ID：10405233
> 
> 赞同：0
> 
> 时间：2012-05-01T22:23:38.480
> 
> 标签：jax-rs, cdi, jboss-weld

我正在使用 CDI 将内容注入到我的 JAX-RS MessageBodyWriters 和 MessageBodyReaders 中。这适用于 MessageBodyWriters 但不适用于 MessageBodyReaders。此外，拦截器对作者起作用，而不对读者起作用。

谁能解释这是期望的行为还是我可能做错了什么？

我使用的是 JBOSS 6，所以 Weld 是我的 CDI 实现。

简

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T07:19:08.897

哈！没关系 - 我完全忘记了我是在我的测试代码中直接实例化阅读器。当我通过 CDI 获得 e 参考时，注入工作正常 - > [http://facepalm.org](http://facepalm.org)

# ruby-on-rails - 在 resque 队列中查找特定作业

> ID：10405235
> 
> 赞同：9
> 
> 时间：2012-05-01T22:23:53.833
> 
> 标签：ruby-on-rails, ruby, redis, resque

在我的应用程序中，我使用 Resque 来调整图像大小。如果图像在调整大小队列中，我想显示一个“调整大小图像”图标。

这意味着我需要能够在队列中找到与特定模型 ID 相关的所有当前作业。现在我这样做：

```
Resque.peek(:resize, 0, 100).find_all { |job| /#{model.id}/.match(job["args"][0]) } 
```

这是愚蠢的。但是有没有办法查询 Resque 队列以找到**第一个参数**等于**[id]**的所有作业？

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-22T21:56:15.827

试试resque [-status 。](https://github.com/quirkey/resque-status)它是 Resque 的扩展，添加了作业跟踪。

> resque-status 提供了一组简单的类，这些类扩展了 resque 的默认功能（使用 0% 的猴子补丁），为应用程序提供了一种跟踪特定作业实例及其状态的方法。它通过为作业实例提供 UUID 并允许作业实例在其迭代中报告其状态来实现这一点。

注意：[d11wtq](https://stackoverflow.com/users/322122/d11wtq)在上面提到了这一点作为评论，但实际上是迄今为止最好的**答案。**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-02T07:36:04.607

您应该将图像元数据与模型一起存储，而不是查询 resque 队列。

假设您正在存储产品图像。您可能正在使用 Redis 哈希来存储产品详细信息。只需添加另一个这样的标志 -

`hset product:123 is_resizing true`

您可以让他们执行简单的查找以显示调整大小的图像图标。在您的 resque 作业结束时，删除`is_resizing`密钥，然后添加`resized_image_url`密钥。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T13:23:27.493

我认为最简单的方法可能是使用 redis 集来缓存这些信息。

当您将图像添加到“调整大小”队列时，还要使用 SADD 将图像 ID 添加到“resize_in_progress”集。（我假设您有某种唯一键或名称来引用图像，即使没有存储在数据库中。也许是文件名的完整路径。）

在“调整大小”过程中，作为成功调整图像大小后的最终操作之一，使用 SREM 命令将其从集合中删除。

当您想要所有图像的列表时，您可以使用 SMEMBERS 获取它。如果您只需要特定模型 id 的成员，您可能需要为每个模型存储一个单独的集合，命名为“resize_in_progress_3451”，其中 3451 是调整图像大小的模型的 id。

有关更多设置命令，请参见[http://redis.io/commands#set](http://redis.io/commands#set)。

# database - 当您知道列名时查找表？

> ID：10405237
> 
> 赞同：7
> 
> 时间：2012-05-01T22:24:08.227
> 
> 标签：database, ms-access

我在 Access 中有一个带有大量表的数据库。不幸的是，创建者使用了非常不具描述性的名称，因此基本上不可能仅通过查看表的名称来猜测表的用途。我需要紧急找到一个包含某些数据的表，并且我很确定我知道它的某些列的名称，或者至少知道列名称中包含的单词。基本上，我需要的是某种“在整个数据库中的每个表中按列名搜索”，它显示包含某些列名的所有表。

在我开始像猴子一样一个接一个之前，有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T23:36:07.410

此过程将列出名称包含您提供的文本的任何列的表名和列名。结果打印在立即窗口中（用`Ctrl`+去那里`g`）

```
Public Sub ListTablesWithColumnNamesContaining(ByVal pText As String)
Dim db As DAO.Database
Dim tdf As DAO.TableDef
Dim fld As DAO.Field
Set db = CurrentDb
For Each tdf In db.TableDefs
    For Each fld In tdf.Fields
        If InStr(1, fld.Name, pText, vbTextCompare) > 0 Then
            Debug.Print tdf.Name & ":", fld.Name
        End If
    Next fld
Next tdf
Set fld = Nothing
Set tdf = Nothing
Set db = Nothing
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T22:40:01.400

有一种方法可以找到所有具有特定列名的表，但它需要一些代码（而不是仅仅能够运行查询）。

首先，您需要使系统表在数据库中“可见”。您没有提及正在使用哪个版本的 MS Access，但“选项”对话框应该允许[这些内容](http://www.techonthenet.com/access/database/view_systables.php)。

这会公开`MSysObjects`包含所有用户表名称的表。

您可能希望遍历所有用户表，将名称传递到一些代码中，这些代码将表作为`DAO.TableDef`对象打开并检查相应`Fields`集合的属性。

Allen Browne 有[一些显示这些属性的 VBA 代码](http://allenbrowne.com/func-06.html)。您可以根据自己的需要对此进行自定义。

# binding - 使用版本解析 osgi 服务

> ID：10405238
> 
> 赞同：1
> 
> 时间：2012-05-01T22:24:10.550
> 
> 标签：binding, service, osgi, versioning

我目前正在评估 osgi（使用 felix 4.3 实现）来管理服务的版本控制。

我一直在创建以下捆绑包：

定义接口 xyzSomeService 的 bundle-api（版本 1.0.0）：它在版本 1.0.0 中导出 xyz

实现 SomeService (v 1.0.0)、在规范版本 1.0.0 中导入包 xyz 并注册服务的 bundle-impl (版本 1.0.0)

定义接口 xyzSomeService 的 bundle-api（2.0.0 版）：它在 2.0.0 版中导出 xyz

实现 SomeService (v 2.0.0)、在规范版本 2.0.0 中导入包 xyz 并注册服务的 bundle-impl (版本 2.0.0)

现在，我有一个客户端，bundle-client（版本 1.0.0），它在版本规范 1.0.0 中导入 bundle-api 的 xyz。

如何在 1.0.0 版中获得 xyzSomeService 的服务？

目前，安装/激活时： bundle-api 1.0.0 bundle-impl 1.0.0 bundle-api 2.0.0 bundle-impl 2.0.0 bundle-client 1.0.0

当启动 bundle-client 时，它会查询可用的 xyySomeService。我得到了可用服务的答案：bundle-impl 1.0.0 和 bundle-impl 2.0.0

我只想获得与 1.0.0 版匹配的服务实现。

我应该如何进行？

ps：目前，我将 null 设置为过滤器值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T00:44:55.267

您使用什么代码或机制来查询服务？OSGi 自动提供服务兼容性过滤，这意味着如果您的客户端导入 API 的 1.0 版本，那么它只会看到实现 1.0 版本的服务，如果您的客户端导入 API 的 2.0 版本，那么它只会看到实现 2.0 版本的服务.... ETC。

但是有一个方法调用`getAllServiceReferences()`会显式关闭这个兼容性检查，并且可以用来获取所有版本的所有服务。在 99% 的情况下，这不是您想要做的。如果您使用过，请`getAllServiceReferences()`尝试更改为`getServiceReferences()`.

如果您正在以其他方式查找服务，那么我需要更多详细信息来进一步帮助您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T12:52:35.123

您可以做的是使用诸如 version=1.0.0 和 version=2.0.0 之类的属性发布服务。然后您可以使用 (version=1.0.0) 过滤服务。

我不知道服务应该被 Neil 提到的包版本过滤。由于尼尔确实是该领域的专家，我相信他是对的。那么也许 felix 实现中存在错误？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-03T07:26:23.307

服务由其接口的 Java 包进行版本控制。如果您根据 OSGi 语义版本控制模型正确地对该包进行版本控制并执行相应的包导入，那么 OSGi 框架将自动为您进行选择。所有 OSGi 服务都以这种方式进行版本控制。

手动维护它就像手动将你的 java 代码编译为字节码，有一些工具可以做到这一点。bnd(tools) 具有广泛的支持，可以最大限度地减少对这些版本的处理和验证。

OSGi 的整体理念是您只接触到兼容的包。

# image - 点击jquery图像边框

> ID：10405240
> 
> 赞同：1
> 
> 时间：2012-05-01T22:24:35.390
> 
> 标签：image, border

为什么这不起作用？

```
$(".char").click(function() {
   $(this).css('border', "solid 2px red");  
   });

<img class=char src=1.gif>
<img class=char src=2.gif> 
```

当我单击其中一张图像时，我希望它通过边框突出显示。

此外，我希望一次只突出显示一个，但我想我会在以后看看。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:32:41.207

使用 $(document).ready() - 您当前的 jquery 代码在目标 html 元素在 dom 中可用之前执行

```
<script type="text/javascript">
$(document).ready(function() {
    $(".char").click(function() {
        $(this).css('border', "solid 2px red");
    });
});
</script> 
```

# django - 是否有可重用的便利功能来更新 ManyToManyField 的值而不先清除它？

> ID：10405241
> 
> 赞同：1
> 
> 时间：2012-05-01T22:24:46.500
> 
> 标签：django

查看 Django 源代码，我看到在分配给 ManyToManyField 时，在添加新值之前删除了所有现有值：

[https://github.com/django/django/blob/master/django/db/models/fields/related.py#L776](https://github.com/django/django/blob/master/django/db/models/fields/related.py#L776)

当我的应用程序运行时，这种幼稚的算法将引入巨大的数据库流失——它一次更新数十万个这样的关系。

因为，在我的例子中，这些更新中的大多数将是 noops（即，当前值和新值将是相同的），我可以通过使用我首先检查哪些对象需要添加的算法更新 M2M 字段来轻松减少流失，然后检查哪些需要删除。

这似乎是一种常见的模式，我想知道是否已经存在可重用的功能来做到这一点？

# uilabel - 如何使用 UIPopoverController 编辑 UIlabel

> ID：10405246
> 
> 赞同：1
> 
> 时间：2012-05-01T22:25:08.360
> 
> 标签：uilabel, selector, uipopovercontroller

我在我的视图控制器中创建了一个 UIPopover 控制器，它会打开一个包含项目列表的弹出窗口。我想要它，以便如果我在列表中选择一个项目，主视图上的标签会更新以显示此选择。到目前为止，我已经尝试使用下面的代码，但是当我单击列表中的某个项目时，出现以下错误：-[ASHAppDelegate portfolioLabel]: unrecognized selector sent to instance 0x6e4fe80

我用于 UIPopOverController 的代码如下所示：

-(IBAction) portFoliosButtonPress:(id)sender {

```
if (self.portfolioPopoverController == nil) {
    ASHPortfolioViewController *portfoliosTableViewController = [[ASHPortfolioViewController alloc] initWithStyle:UITableViewStylePlain];
    //CGSize frame = {portfoliosTableViewController.view.frame.size.width, 200.0};
    UIPopoverController *popover = [[UIPopoverController alloc] initWithContentViewController:portfoliosTableViewController]; 
     CGSize frame = {300.0, 230.0};
    [popover setPopoverContentSize:frame];
    popover.delegate = self;

    self.portfolioPopoverController = popover;
    //self.contentSizeForViewInPopover.height = CGSizeMake(150.0, 140.0);
}

if ([self.portfolioPopoverController isPopoverVisible]) {
    [self.portfolioPopoverController dismissPopoverAnimated:YES];    
}
else {
    [self.portfolioPopoverController presentPopoverFromBarButtonItem:sender 
                                            permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];
}
self.portfolioLabel.text = @"hi";

}
#pragma mark - Popover lifecycle

//---called when the user clicks outside the popover view---
- (BOOL)popoverControllerShouldDismissPopover:(UIPopoverController *)popoverController {

NSLog(@"popover about to be dismissed");
return YES;
}

//---called when the popover view is dismissed---
- (void)popoverControllerDidDismissPopover:
(UIPopoverController *)popoverController {

    NSLog(@"popover dismissed");    
} 
```

弹出框控制器包含的 UITableView 中使用的代码如下所示：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath   *)indexPath
{

    ASHFirstViewController *appDelegate =(ASHFirstViewController *)[[UIApplication sharedApplication] delegate];    
    appDelegate.portfolioLabel.text = @"Test"; 
} 
```

'portfolioLabel' 是我的视图控制器中的一个 IBOutlet UIlabel。

# html - 如何使用 CSS 隐藏滚动条？

> ID：10405251
> 
> 赞同：0
> 
> 时间：2012-05-01T22:25:41.413
> 
> 标签：html, css

我有一个 div 有很多内容，因此滚动..如何隐藏滚动条使其不可见。编辑：我确实想要滚动工作！所以..滚动没有滚动条？

例如

```
.scrolling_div {

     overflow:auto;
     /*something else to hide the scrollbar?*/

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T22:27:55.020

好的，我花了一些时间编写最少的代码。

检查[**演示**](http://jsfiddle.net/y9kDN/2/)。将鼠标悬停在 div 上并滚动以查看滚动条。

**注意**这里使用了一个外部插件来监听[鼠标滚轮事件](https://raw.github.com/brandonaaron/jquery-mousewheel/master/jquery.mousewheel.js)。

[插件的演示页面](http://brandonaaron.net/code/mousewheel/demos)

* * *

`overflow:hidden`应该隐藏滚动条。

```
.scrolling_div {
     overflow: hidden;
} 
```

溢出可以采用以下任何一个值，

> **可见** 默认值。内容没有被剪裁，它可能会呈现在内容框之外。
> 
> **hidden** 内容被剪裁，不提供滚动条。
> 
> **scroll** 内容被剪裁，桌面浏览器使用滚动条，无论是否剪裁任何内容。这避免了滚动条在动态环境中出现和消失的任何问题。打印机可能会打印溢出的内容。
> 
> **auto** 如果内容溢出，提供滚动条。

[参考](https://developer.mozilla.org/en/CSS/overflow)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T22:28:04.740

`overflow: auto;`意思是“如果需要，显示一个滚动条”。将其更改`overflow: hidden;`为禁用滚动。

编辑：好的，你想制作一个自定义滚动条。然后查看[这个示例 jsFiddle](http://jsfiddle.net/minitech/e32pn/)以了解如何开始 - 它包括鼠标滚轮和滚动条的拖动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T22:33:42.667

你可以试试这个：

```
html {
        overflow: hidden;
    } 
```

它将从所有窗口中删除滚动条。

否则，如果您仅在特定 div 上需要它：

```
.scrolling_div {

     overflow: hidden;

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T22:28:39.777

这真的取决于你要做什么。 [看这里](http://www.w3schools.com/cssref/pr_pos_overflow.asp)

`overflow:hidden;`可能是你想要的。

如果您想深入研究 css3，您可以使用`overflow-x`并`overflow-y`获得更多选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T22:33:11.010

隐藏滚动条的唯一方法是使内容不可滚动，如果超过高度 ( ) 则将其截断`overflow: hidden`。老实说，您为什么想要一个没有滚动条的可滚动页面？这会让任何访客感到困惑。你无法用 CSS 做到这一点。

至于*自定义*滚动条，有 JavaScripts 可以做到这一点。但是请确保如果用户禁用它，他们仍然可以在没有它的情况下正确滚动页面。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-01T22:49:18.410

使用一个包装器来覆盖您希望在没有滚动条的情况下可滚动的元素，并让包装器在水平方向上比要滚动的元素更窄。这就是我的意思：http: [//jsfiddle.net/FlagelloDiDio/EdgTt/](http://jsfiddle.net/FlagelloDiDio/EdgTt/)

# libsvm - libsvm 输入数据？

> ID：10405253
> 
> 赞同：0
> 
> 时间：2012-05-01T22:26:07.177
> 
> 标签：libsvm

例如，我有一个这样的 n 人的数据集

```
userID 1 (or 2,3.....up to n)
gender male (or female)
working yes (or No)
income >$5000/month (or <$5000)
have_car yes (or no) 
```

我想根据其他属性（性别、工作和收入）来预测一个人是否拥有汽车。我应该使用什么格式进行培训，我应该投入多少人进行培训，如果假设我有 10,000 人的数据来测试有多少人

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T12:04:36.190

格式：您必须使用数字数据。因此使用可以使用 0 和 1 进行二进制判定。

培训/测试：没有确切的公式。您似乎没有很多用于分类的功能 - 这意味着您不一定需要大量的训练数据。您可以一开始就将其拆分为 50:50，然后检查您是否获得了合理的结果。

# ruby-on-rails - proxy_association 查找未关联记录的解释

> ID：10405261
> 
> 赞同：4
> 
> 时间：2012-05-01T22:27:07.920
> 
> 标签：ruby-on-rails, activerecord

我今天遇到了一些魔法，我希望能帮助我理解它，这样我就可以编写明智的代码。

在我的应用程序中，我有三个类：

```
class Person < ActiveRecord::Base
  has_many :selected_apps
  has_many :app_profiles, through: :selected_apps do
    def unselected(reload=false)
      @unselected_app_profiles = nil if reload
      @unselected_app_profiles ||= proxy_association.owner.app_profile_ids.empty? ?
        AppProfile.all :
        AppProfile.where("id NOT IN (?)", proxy_association.owner.app_profile_ids)
    end
  end
end

class AppProfile < ActiveRecord::Base
end

class SelectedApp < ActiveRecord::Base
  belongs_to :person
  belongs_to :app_profile
end 
```

上面的代码让我无需做大量的 SQL 工作就可以完成`person.app_profiles.unselected`并取回所有`AppProfiles`当前不相关的内容。`Person`杰出的！

我的问题是我不*理解*代码——这总是让我感到不安。我尝试浏览 proxy_association 文档，但它相当不透明。

任何人都可以提供合理直接的解释和/或了解更多信息的好地方吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-02T02:07:11.953

基本上，当您`self`在扩展时调用`association`它不会返回`Association`实例，而是委托给`to_a`.

尝试一下：

```
class Person < ActiveRecord::Base
  has_many :app_profiles, through: :selected_apps do
    def test_me
      self
    end
  end
end 
```

`association`有时我们需要在扩展关联本身时到达实际对象。输入[`proxy_association`方法](https://github.com/rails/rails/blob/83e42d52e37a33682fcac856330fd5d06e5a529c/activerecord/lib/active_record/associations/collection_proxy.rb#L60)，它将为我们`association`提供包含[`owner`、、`target`和`reflection`属性](https://github.com/rails/rails/blob/90d96353e6dcd962b182e03f53f2214acde00907/activerecord/lib/active_record/associations/association.rb#L21)的方法。

此处参考[文档](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#label-Association+extensions)。

[这个问题](https://stackoverflow.com/questions/8997266/custom-association-method-can-this-be-done/9087086#9087086)提供了一个更简单的`proxy_association.owner`.

# c++ - Visual Studio 中包含的传递库

> ID：10405263
> 
> 赞同：1
> 
> 时间：2012-05-01T22:27:33.583
> 
> 标签：c++, visual-studio, dependencies

假设我有一个静态库 A，它使用静态库 B。然后假设我有一个可执行 C，它使用库 A 和 B 中的东西。

我应该让 C 显式链接与库 A 和 B，还是只链接库 A，因为 A 与 B 链接？

附言。我正在使用 Visual Studio 2008。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T23:41:35.830

C 必须与 A 和 B 链接，静态库无法“使用”另一个静态库。为 A 构建 .lib 文件时，它将仅包含对 B 的外部引用，它不会引入 B 库中的实际代码。

# linux - 如何计算我的 GPIO 端口地址

> ID：10405270
> 
> 赞同：0
> 
> 时间：2012-05-01T22:28:19.280
> 
> 标签：linux, linux-device-driver, gpio

我有一块 Jetway NF81-T56 主板，它有一个提供 8 条 I/O 线的接头，标有 GPIO30-GPIO37。我的 CentOS6 安装中没有 GPIO 驱动程序，我正在尝试编写驱动程序。Fintek F71869 Super IO 芯片提供 GPIO 和其他 I/O 功能。我可以通过 0x2e/0x2f 端口访问和修改 GPIO3 寄存器，但无法使用 F71869 GPIO 寄存器中设置的 GPIO BASE_ADDR 访问数据端口。我已经阅读了这些寄存器，并且 GPIO BASE_ADDR 设置为 0x0a00。该芯片的手册页指出：

索引端口为 BASE_ADDR[15:2] + 5，数据端口为 BASE_ADDR[15:2] + 6

我已将数据端口设置为 0x0f（由连接的 LED 显示）并尝试读取端口 0x0a00-0x0a7f。全部返回 0xff，而不是 0x0f。有谁知道如何解释“BASE_ADDR[15:2]”符号语法？我曾尝试在互联网上搜索并尝试联系制造商，但无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:19:19.793

这是硬件风格的向量（位域）表示法，基本上你右移两个位置。

如果我在脑海中正确地做，0x0a00 就会变成 0x0280。

```
To draw it out here are the bits [15:0]
0x0a00 = 0000 1010 0000 0000
now select bits [15:2]
         0000 1010 0000 00
which we re-format as [13:0] of a new vector
           00 0010 1000 0000 = 0x0280 
```

所以看起来你应该在 0x0285 和 0x0286 访问。但是，您需要确保正确配置了电路板，更重要的是，您需要确保在这些地址上没有其他任何东西。

# c# - c#中可以在哪里使用关键字class？

> ID：10405272
> 
> 赞同：1
> 
> 时间：2012-05-01T22:28:26.520
> 
> 标签：c#

我知道在 c# 中使用 class 关键字的两个地方。

1.  在类声明中
2.  在泛型约束中（类 GenericClass，其中 T：类）

但是有什么我错过的吗？这对我很重要，因为我正在编写一个程序来计算文件中的类。在 msdn 或 C# 规范中找不到任何信息。

## 编辑

```
#if class
partial class C<T> where T : class
{
    // class!
    int @class = 123;
    string c = "class";
}
partial class C<T> where T : class {}
#else
partial class D {}
partial class D {}
partial class D {}
#endif 
```

这是几个答案的积累。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-01T22:54:25.557

仅计算“类”的出现次数并不能告诉您文件中有多少类：

```
#if FOO
partial class C 
{
    // class!
    int @class = 123;
    string c = "class";
}
partial class C {}
#else
partial class D {}
partial class D {}
partial class D {}
#endif 
```

字符串“class”在那里出现了八次，但该文件只定义了一个类。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T22:36:34.517

您可能想要使用 ANTLR ( [http://www.antlr.org/](http://www.antlr.org/) ) 之类的东西，并使用类似于这个 SO post [Partial grammar for count class count](https://stackoverflow.com/questions/4914073/partial-grammar-for-counting-class-count)的东西。我认为这比尝试编写自己的解析器更安全。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-01T22:30:42.637

也可以`class`通过在它前面加上一个“at”符号来用作标识符。

```
int @class = 1; 
```

我并不是说写这个是*可取*的，但如果你想计算课程，你可能想考虑一下。

**有关的**

*   [C# 中变量名中 @ 字符的用途/含义是什么？](https://stackoverflow.com/questions/91817/whats-the-use-meaning-of-the-character-in-variable-names-in-c)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T23:00:21.343

似乎您可以将`class`其定义为编译条件符号，例如

```
#if class
#else
#endif 
```

...如果您在项目属性/构建中定义它，它就会编译。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T22:32:48.757

想不出任何其他用法，但请记住，如果关键字以 @ 为前缀，则可以将其用作标识符

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-01T22:38:18.230

可以在泛型方法定义中使用关键字 class：

```
foo<T>(T object) where T:class 
```

如果您希望能够`y`作为任何东西传递，请使用对象：

```
foo(string x, class y) { } 
```

# java - requestSingleUpdate(...) 不会自动获取 GPS 位置

> ID：10405277
> 
> 赞同：1
> 
> 时间：2012-05-01T22:28:55.767
> 
> 标签：java, android, gps, location

如果我们想在 Android 中获得单个 GPS 定位，我们实际上使用已知函数 requestSingleUpdate() 和 LocationManager.GPS_PROVIDER，对吧？

现在我在打开 GPS 的情况下在我的函数 getLocation() 中执行此操作，但设备不会自动建立连接，除非我手动关闭 GPS 然后再次打开。网络提供商的 requestSingleUpdate() 工作完美，我只是不知道为什么这不适用于 GPS 修复。

这是我的源代码的一部分：

getLocation() 由另一个带有计时器的对象每 2 分钟运行一次。在 getLocation() 中，如果 GPS 和网络已打开，它会在第一分钟尝试获取 GPS 定位，然后如果没有则获取网络位置GPS 定位可用。

```
public boolean getLocation() {
    // DEBUG
    Log.d("GPS Connection", "Entering getLocation()");
    gpsEnabled = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER);
    networkEnabled = locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER);

    if(!gpsEnabled && !networkEnabled)
        return false;

    if(gpsEnabled && networkEnabled) {
        // DEBUG
        Log.d("GPS Connection", "Request GPS Data");
        locationManager.requestSingleUpdate(LocationManager.GPS_PROVIDER, gpsLocationListener, Looper.getMainLooper());
        gpsGetLocationTimeout = new Timer();
        gpsGetLocationTimeout.schedule(new GetNetworkLocation(), GPS_MAX_CONNECTION_TIME_MS);
    }

    ... 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T14:05:13.117

来自[Android 文档：](http://developer.android.com/reference/android/location/LocationManager.html#requestSingleUpdate%28java.lang.String,%20android.location.LocationListener,%20android.os.Looper%29)

> 接收最新位置可能需要一段时间。如果需要即时位置，应用程序可以使用 getLastKnownLocation(String) 方法。如果提供者被用户禁用，将不会收到更新，并且会调用 onProviderDisabled(String) 方法。再次启用提供程序后，将调用 onProviderEnabled(String) 方法并重新开始位置更新。

GPS 可能需要很长时间才能从冷启动中恢复。如果你在室内、在停车场、被高楼包围、手机很烂，或者 GPS 卫星神有一种有趣的心情，你可能永远也得不到 GPS。

在某些应用程序中，我们会执行诸如请求 GPS 位置之类的操作，如果 60 秒后仍未到达，则取消请求，这样我们就不会在 GPS RX 半永久开启的情况下耗尽手机电池。

您可以请求最后一个已知位置并检查其年龄并确定它是否足够新以供使用。网络定位既快速又便宜（就电池使用而言），一个好的策略是在获得 GPS 之前使用网络定位。

我在 Android 中编码 GPS 的经验是，GPS 会做它想做的事情，这在很多方面都不是文档引导您所期望的。GPS 需要被视为可能可用也可能不可用的东西，并且可以设计程序的逻辑来处理它。

# qt - 找不到 VLC 头文件

> ID：10405285
> 
> 赞同：1
> 
> 时间：2012-05-01T22:29:57.997
> 
> 标签：qt, vlc, libvlc

我正在尝试编译一个 VLC-QT 程序，但我的编译器说它找不到`vlc.h`，即使我已经在我的`.pro`文件中包含了路径。谁能告诉以下有什么问题？

```
QT += core gui
TARGET = vlc
TEMPLATE = app
SOURCES += main.cpp\
vlc_on_qt.cpp
HEADERS  += vlc_on_qt.h
INCLUDEPATH += C:\Qt\QT Project\libvlc-qt_0.5.1_win32_sdk\include\
LIBS += -LC:\Qt\QT Project\vlc\libvlc-qt_0.5.1_win32_sdk\lib
LIBS += -lvlc 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:36:27.643

您需要使用`#include <vlc/vlc.h>`库将其头文件存储在一个单独的目录中，就像大多数库一样。

# cocos2d-iphone - cocos2d/cocos2dx 传统的 update-render-loop 方法是不是矫枉过正？

> ID：10405286
> 
> 赞同：3
> 
> 时间：2012-05-01T22:30:31.640
> 
> 标签：cocos2d-iphone, cocos2d-x

所以可以说我正在制作棋盘游戏。我有一个游戏板阵列，我的逻辑需要检查位置和碰撞检测，没关系。

传统上使用像directX这样的东西，你会有一个游戏循环，测试一些逻辑，更新游戏板数组，最后绘制屏幕，​​但是使用cocos2dx我们不直接在屏幕上绘制，我们将精灵添加到图层中，其余的由cocos完成！

例如..

*   初始化一个代表游戏板的游戏数组
*   初始化一个游戏对象
*   将对象添加到数组
*   更新屏幕（将数组渲染到屏幕）
*   开始游戏循环
*   测试一些逻辑条件
*   从数组中删除对象
*   更多 测试一些逻辑条件，更新对象位置
*   将对象添加到数组
*   再次更新屏幕
*   环形

前一个可以正常工作，但我不需要从图层中删除对象，只需更新其位置并重新渲染到屏幕，如果我保留对该对象的引用，我可以使用 cocos2d/cocos2dx 移动它，并且更新数组。

我可以继续这种方法，但我想知道我是否遗漏了什么。

游戏阵列有助于游戏逻辑并模仿实际的可玩区域，但我不禁觉得它有点石器时代。

有人可以帮忙吗，我完全错过了情节吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T20:06:09.223

所有游戏引擎都使用更新循环。没有它，您将不会渲染任何内容。

也就是说，如果您的游戏完全由用户输入驱动，您可以对用户输入事件（触摸）做出反应，然后才执行游戏逻辑（移动或移除棋子、检查获胜条件、更新分数、下一回合）。

如果您想要“新派”，那么您将看到的是游戏设计工具，而不是游戏引擎。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:16:47.003

这对我来说看起来不错。要记住的是，在您的游戏循环期间，您将能够处理使棋盘游戏保持有趣的动画。我认为这并不过分，你总能找到动画的东西。

# resources - JavaFX 2.0 FXML 资源加载错误

> ID：10405288
> 
> 赞同：0
> 
> 时间：2012-05-01T22:30:35.857
> 
> 标签：resources, javafx-2, fxml

```
@Override public void start(Stage primaryStage) {
        try {
            stage = primaryStage;
            gotoLogin();
            primaryStage.show();
        } catch (Exception ex) {
            Logger.getLogger(App.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    enter code here
    public User getLoggedUser() {
        return loggedUser;
    }

    public boolean userLogging(String userId, String password){
        if (Authenticator.validate(userId, password)) {
            loggedUser = User.of(userId);
            gotoProfile();
            return true;
        } else {
            return false;
        }
    }

    public void userLogout(){
        loggedUser = null;
        gotoLogin();
    }

    private void gotoProfile() {
        try {
            replaceSceneContent("../skinFolder/fxml/profile.fxml");
        } catch (Exception ex) {
            Logger.getLogger(App.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    private void gotoLogin() {
        try {
            replaceSceneContent("../skinFolder/fxml/login.fxml");
        } catch (Exception ex) {
            Logger.getLogger(App.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    private Parent replaceSceneContent(String fxml) throws Exception {
        Parent page = (Parent) FXMLLoader.load(App.class.getResource(fxml), null, new JavaFXBuilderFactory());
        Scene scene = stage.getScene();
        if (scene == null) {
            scene = new Scene(page, 700, 450);
            scene.getStylesheets().add(App.class.getResource("../skinFolder/css/defaultSkin.css").toExternalForm());
            stage.setScene(scene);
        } else {
            stage.getScene().setRoot(page);
        }
        stage.sizeToScene();
        return page;
    }} 
```

所以我正在尝试使用 FXML 登录示例的示例，只有我为 fxml 提供了其他方式。在 fxml 文件中，我为控制器让路。

```
The log shows those errors:

at java.lang.ClassLoader.defineClass1(Native Method)
at java.lang.ClassLoader.defineClass(ClassLoader.java:791)
at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
at java.net.URLClassLoader.defineClass(URLClassLoader.java:449)
at java.net.URLClassLoader.access$100(URLClassLoader.java:71)
at java.net.URLClassLoader$1.run(URLClassLoader.java:361)
at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Class.java:264)
at javafx.fxml.FXMLLoader.loadType(Unknown Source)
at javafx.fxml.FXMLLoader$ValueElement.processAttribute(Unknown Source)
at javafx.fxml.FXMLLoader$InstanceDeclarationElement.processAttribute(Unknown Source)
at javafx.fxml.FXMLLoader$Element.processStartElement(Unknown Source)
at javafx.fxml.FXMLLoader$ValueElement.processStartElement(Unknown Source)
at javafx.fxml.FXMLLoader.processStartElement(Unknown Source)
at javafx.fxml.FXMLLoader.load(Unknown Source)
at javafx.fxml.FXMLLoader.load(Unknown Source)
at Main.App.replaceSceneContent(App.java:115)
at Main.App.gotoProfile(App.java:100)
at Main.App.userLogging(App.java:86)
at skinFolder.controllers.LoginController.processLogin(LoginController.java:28) 
```

登录控制器类

```
public class LoginController {
    @FXML private TextField userId;
    @FXML private PasswordField password;
    @FXML private Label errorMessage;

    @FXML protected void processLogin() {
        if(!App.getInstance().userLogging(userId.getText(), password.getText())){
            errorMessage.setText("Username/password combination is invalid.");
        }
    }
} 
```

第 28 行是：

```
if(!App.getInstance().userLogging(userId.getText(), password.getText())){ 
```

我提到 fxml 文件位于主文件夹的另一个文件夹中。当我使用 Oracle 给出的示例时，我不明白为什么会出现此错误，而是使用另一个文件夹结构！

我的应用程序文件夹结构：

*   主要的
*   模型
*   安全
*   皮肤文件夹 - css
*   皮肤文件夹 - fxml
*   skinFolder - 控制器

这是 profile.fxml 代码：

```
<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import java.net.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.*?>
<?import javafx.scene.text.*?>

<AnchorPane id="Profile" styleClass="profile" xmlns:fx="http://javafx.com/fxml" fx:controller="skinFolder.controllers.ProfileController">
   <children>
    <Button maxHeight="2.0" text="Update" AnchorPane.bottomAnchor="15.0" AnchorPane.rightAnchor="168.0" fx:id="update" onAction="#processUpdate"/>
    <Label layoutX="56.0" layoutY="77.0" text="Please review your profile data." fx:id="message" />
    <Label layoutX="56.0" layoutY="123.0" text="User:" />
    <Label layoutX="56.0" layoutY="224.0" text="Phone:" />
    <Label layoutX="56.0" layoutY="173.0" text="Email:" />
    <TextField editable="false" layoutX="149.0" layoutY="120.0" maxWidth="2.0" minHeight="30.0" minWidth="215.0" prefHeight="30.0" prefWidth="215.0" fx:id="user" />
    <TextField editable="true" layoutX="149.0" layoutY="171" maxWidth="2.0" minHeight="30.0" minWidth="215.0" prefHeight="30.0" prefWidth="215.0" fx:id="email" />
    <TextField layoutX="149.0" layoutY="224" maxWidth="2.0" minHeight="30.0" minWidth="215.0" prefHeight="30.0" prefWidth="215.0" fx:id="phone" />
    <CheckBox layoutX="402" layoutY="120.0" text="Subscribed to NewsLetter" fx:id="subscribed" />
    <Separator layoutX="380" layoutY="110" prefHeight="155" orientation="vertical"/>
    <Hyperlink layoutY="24.0" text="logout" AnchorPane.rightAnchor="52.0" fx:id="logout" onAction="#processLogout"/>
    <Button disable="true" maxHeight="2" maxWidth="2.0" text="Continue" defaultButton="true" AnchorPane.bottomAnchor="15.0" AnchorPane.rightAnchor="52.0" fx:id="Button" onAction="#processLogout"/>
    <Label layoutX="150.0" layoutY="401.0" opacity="0.0" text="Profile  successfully updated!" fx:id="success" />
    <Label layoutX="56.0" layoutY="284.0" text="Address:" />
    <TextArea maxHeight="2.0" maxWidth="2.0" minHeight="85.0" minWidth="448.0" prefHeight="85.0" prefWidth="448.0" AnchorPane.bottomAnchor="69.0" AnchorPane.leftAnchor="149.0" AnchorPane.rightAnchor="52.0" AnchorPane.topAnchor="289.0" fx:id="address" />
  </children>
  <styleClass>
    <String fx:value="profile" />
  </styleClass>
  <properties>
    <elementLockSel>
      <Boolean fx:value="true" />
    </elementLockSel>
  </properties>
</AnchorPane> 
```

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T11:12:52.450

我认为这与[您之前的问题有关（JavaFX 2.0 load fxml files from subfolder failed）](https://stackoverflow.com/q/10411164/682495)。看到[这个答案](https://stackoverflow.com/a/10412508/682495)。同样在这里`processUpdate`采取行动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T09:33:22.663

`profile.fxml`你的文件有问题。您没有在堆栈跟踪中包含错误描述，但很可能您在那里有错误或拼写错误的属性标记。

`profile.fxml`如果您需要更多帮助，请在帖子中添加完整的堆栈跟踪。

# xml - HTTP GET POST -> 如何同时使用两者？（.Net环境）

> ID：10405291
> 
> 赞同：0
> 
> 时间：2012-05-01T22:30:42.883
> 
> 标签：xml, vb.net, httpwebrequest, http-post, http-get

我在 web 服务方面不是最好的......让我用那个来作为这个问题的序言。

无论如何，我正在尝试编写一些可以联系供应商服务器的东西，并且我一直在阅读他们的文档。

他们说我需要提交一个 HTTP POST 请求，但我还必须通过 HTTP GET 提交一些配置。

当他们这么说时我很困惑，因为我不认为这些在技术上可以同时完成。

本质上，我需要为 Post 提供所需的 XML。：

```
<?xml version='1.0' encoding='UTF-8' standalone='yes' ?>
<!DOCTYPE VendorZ>
<VendorZ Service='Info::Customers'>
<Addr>
        <City>toronto</City>
        <Country>ca</Country>
        <Region>on</Region>
        <Street>133 king st east</Street>
</Addr>
</VendorZ> 
```

但随后我的 url 和密码设置通过 http get 中的 url 进行。：

```
http://service.megaupload.com/mega/?Config=pwConfigSettings 
```

我已经查看了该网站上的几个链接。：

[https://stackoverflow.com/questions/92522/http-get-in-vb-net](https://stackoverflow.com/questions/4071988/httpwebrequest-with-post-and-get-at-the-same-time)

和

[同时使用 POST 和 GET 的 HttpWebRequest](https://stackoverflow.com/questions/4071988/httpwebrequest-with-post-and-get-at-the-same-time)

但我仍然对如何去做这件事感到相当困惑。

我知道这并不难，但希望有人能对此有所了解。正如我所说，我已经在网上阅读了很多帖子，但今天对我来说并没有点击。

非常感谢任何建议/方向。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:38:42.170

在某些情况下，一组相关的网络可访问服务称为“API”。例如，谷歌有一个“地图 API”，必应有一个“搜索 API”。Facebook 公开了他们的“Graph API”。

> **旁白：**
> 
> 在我看来，这些不是传统定义的 API：*应用程序编程接口*。传统上，API 是由库模块公开的一组相关函数调用（或 OO 环境中的类库）。程序员会将他的代码链接到库，以便能够调用这些 API。
> 
> 在我看来，这些网络可访问的功能是不同的。它们是应用程序*网络*接口，而不是应用程序*编程*接口。也许没有人想用 ANI 这个绰号来描述这些东西。但是让我们明确一点，我们在这里谈论的是网络接口。

在每个 ANI/API 中，无论是来自 Google、Bing、Facebook 还是其他人，通常都有许多可用的功能。这些功能中的每一个都可以通过某些网络协议独立使用。换句话说，远程应用程序发送符合特定数据格式的消息，以便“使用”或“调用”该功能。每个网络消息都是不同的。每个都有独立的约束和要求。

在我看来，您正在使用的 API 中的某些功能需要 POST。有些需要 GET。当您想使用功能 A 时，请使用 HTTP POST 并发送这样格式的*消息*；如果您想使用函数 B，请使用 HTTP GET 并以*这种方式*格式化您的请求。

可能就这么简单。

你不会同时使用*它们*。你会在不同的时间从同一个应用程序中使用它们。

# javascript - 纯javascript下拉DIV动画

> ID：10405295
> 
> 赞同：0
> 
> 时间：2012-05-01T22:31:05.363
> 
> 标签：javascript, animation, drop-down-menu

我厌倦了在谷歌上搜索这个，所以我决定在这里问专业人士。是否有可能以及如何创建下拉 DIV 的效果，如这里[http://137pillarshouse.com/accommodation](http://137pillarshouse.com/accommodation) - 使用纯 JavaScript 的 BOOK NOW 块，没有 jQuery 或任何库。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:44:06.940

好吧，他们没有混淆 javascript 代码，您可以从他们的代码中学习。

# 1\. [http://137pillarshouse.com/js/script.js](http://137pillarshouse.com/js/script.js)

```
// show/hide booking form
        $('#bookingpanel #booknow').click(function(){
            $('#quickbookingform').slideToggle(750,'easeOutQuart');
            $('#bookingpanel').toggleClass('open');
            $(this).html($(this).html() == 'Book <em>Now</em>' ? 'Close' : 'Book <em>Now</em>');
            return false;
        });
// Quick Booking Form
    $('#StartDateString').datepicker({dateFormat:'dd/mm/yy',firstDay:1,minDate:1,maxDate:'+18m'}); 
```

# 2.

```
 <div id="bookingpanel" class="">
 <form action="https://www.luxuryroomreservations.com/en-GB/IBE/115/Landing/Index" method="post" id="quickbookingform" class="booking" style="display: none; ">
    <fieldset>
    <label for="StartDateString">Arrival Date</label>
    <input class="text hasDatepicker" id="StartDateString" name="CurrentBooking.CurrentUserSearch.StartDateString" type="text" value="">
     <label for="NoOfNights">Nights</label>
     <select id="CurrentBooking_CurrentUserSearch_NoOfNights" name="CurrentBooking.CurrentUserSearch.NoOfNights">
        <option selected="selected" value="1">1</option>
        .....
    </select>
    <div class="left">
    <label for="NoOfAdults">Adults</label>
    <select id="NoOfAdults" name="CurrentBooking.CurrentUserSearch.NoOfAdults">
        <option value="1">1</option>
        <option selected="selected" value="2">2</option>
        <option value="3">3</option>
    </select>
    </div><!-- /.left -->
    <div class="right">
    <label for="NoOfChildren">Children</label>
    <select id="NoOfChildren" name="CurrentBooking.CurrentUserSearch.NoOfChildren">
            <option selected="selected" value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
        </select>
    </div><!-- /.right -->
    <input id="CurrentBooking_CurrentUserSearch_AccountId" name="CurrentBooking.CurrentUserSearch.AccountId" type="hidden" value="">
    <input id="CurrentBooking_CurrentUserSearch_SpecialRateCode" name="CurrentBooking.CurrentUserSearch.SpecialRateCode" type="hidden" value="">
    <input id="CurrentBooking_CurrentUserSearch_IataCode" name="CurrentBooking.CurrentUserSearch.IataCode" type="hidden" value="">
    <input id="CurrentBooking_CurrentUserSearch_HotelCode" name="CurrentBooking.CurrentUserSearch.HotelCode" type="hidden" value="HUCNXPH">
    <p><input type="submit" value="Check Availability" id="booking_submit"></p>
</fieldset>
</form><a href="#bookingpanel" id="booknow">Book <em>Now</em></a>
</div> 
```

# 3\. 还有一点 CSS

## 移动的

```
@media only screen and (min-width: 768px)
#bookingpanel {
top: -10px;
right: 60px;
} 
```

## 桌面

```
#bookingpanel {
position: absolute;
top: -10px;
right: 20px;
z-index: 100;
width: 15em;
-moz-transition-duration: .25s;
-webkit-transition-duration: .25s;
-o-transition-duration: .25s;
-ms-transition-duration: .25s;
transition-duration: .25s;
} 
```

剩下的由你决定......稍微设计一下，你会到达那里的，我敢肯定:)

# collect - 收集有关互联网的使用数据

> ID：10405296
> 
> 赞同：3
> 
> 时间：2012-05-01T22:31:08.107
> 
> 标签：collect, alexa

alexa、competition 等来源从哪里收集数据以建立互联网统计数据，例如顶级网站和网站访问量最大的国家/地区列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:39:45.380

这些网站通过跟踪用户的数据收集行为来收集原始数据，并执行一些统计捏造来获得流量估计。

就 Alexa 而言，它从[Alexa 工具栏用户的数据](http://www.alexa.com/faqs/?cat=4)中收集。[Compete 也是如此，但用户“小组”的](http://www.compete.com/us/about/our-data/)规模更大、定义更广泛。

# ios - iOS 性能调优：获取大图像像素颜色的最快方法

> ID：10405298
> 
> 赞同：11
> 
> 时间：2012-05-01T22:31:38.000
> 
> 标签：ios, performance, uiimage, core-graphics

关于如何获取给定点的图像像素颜色有许多问题/答案。但是，对于大图像（例如，即使小到 1000 x 1300），所有这些答案都*非常*慢（100-500 毫秒）。

那里的大多数代码示例都绘制到图像上下文。当实际抽签发生时，所有这些都需要时间：

```
CGContextDrawImage(context, CGRectMake(0.0f, 0.0f, (CGFloat)width, (CGFloat)height), cgImage) 
```

在 Instruments 中检查这一点会发现，绘制是通过从源图像中复制数据来完成的：

![在此处输入图像描述](../Images/cc4d78a7e7eb70e2e96504e6395b1943.png)

我什至尝试了另一种获取数据的方法，希望获取字节本身实际上会更有效。

```
NSInteger pointX = trunc(point.x);
NSInteger pointY = trunc(point.y);
CGImageRef cgImage = CGImageCreateWithImageInRect(self.CGImage, 
                           CGRectMake(pointX * self.scale, 
                                      pointY * self.scale, 
                                      1.0f, 
                                      1.0f));

CGDataProviderRef provider = CGImageGetDataProvider(cgImage);
CFDataRef data = CGDataProviderCopyData(provider);

CGImageRelease(cgImage);

UInt8* buffer = (UInt8*)CFDataGetBytePtr(data);

CGFloat red   = (float)buffer[0] / 255.0f;
CGFloat green = (float)buffer[1] / 255.0f;
CGFloat blue  = (float)buffer[2] / 255.0f;
CGFloat alpha = (float)buffer[3] / 255.0f;

CFRelease(data);

UIColor *pixelColor = [UIColor colorWithRed:red green:green blue:blue alpha:alpha];

return pixelColor; 
```

此方法在数据复制上花费时间：

```
CFDataRef data = CGDataProviderCopyData(provider); 
```

它似乎也在从磁盘读取数据，而不是`CGImage`我正在创建的实例：

![在此处输入图像描述](../Images/d99955bc01d5d8de11f6b5df47ebcc47.png)

现在，这种方法在一些非正式的测试中确实表现得更好，但它仍然没有我想要的那么快。 **有谁知道获取底层像素数据的更快方法？？？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T04:11:35.237

如果您可以通过 OpenGL ES 将此图像绘制到屏幕上，那么您可以通过该版本中引入的纹理缓存获得对 iOS 5.0 中底层像素的极快随机访问。它们允许对存储在 OpenGL ES 纹理（图像所在的位置）中的底层 BGRA 像素数据进行直接内存访问，并且您几乎可以立即从该纹理中挑选出任何像素。

我用它来读回甚至是大（2048x2048）图像的原始像素数据，读取时间最差是在 10-20 毫秒的范围内，以拉低所有这些像素。同样，随机访问单个像素几乎不需要时间，因为您只是从字节数组中的位置读取。

当然，这意味着您必须解析您的特定图像并将其上传到 OpenGL ES，这将涉及从磁盘读取和与 Core Graphics 的交互（如果通过 UIImage），您会看到如果您尝试从磁盘上的随机 PNG 读取像素数据，但听起来您只需要渲染一次并从中多次采样。如果是这样，OpenGL ES 和 iOS 5.0 上的纹理缓存将是读取此像素数据以获取屏幕上显示的内容的绝对最快方法。

我将这些过程封装在我的开源[GPUImage](https://github.com/BradLarson/GPUImage)框架内的 GPUImagePicture（图像上传）和 GPUImageRawData（快速原始数据访问）类中，如果你想看看类似的东西是如何工作的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-11T17:24:08.070

我还没有找到一种方法来访问绘制的（在帧缓冲区中）像素。我测量过的最快的方法是：

1.  通过在创建图像时指定 kCGImageSourceShouldCache 来指示您希望图像被缓存。
2.  （可选）通过强制渲染来预缓存图像。
3.  将图像绘制为 1x1 位图上下文。

这种方法的代价是缓存的位图，它的生命周期可能与它关联的 CGImage 一样长。代码最终看起来像这样：

1.  创建带有 ShouldCache 标志的图像

    ```
    NSDictionary *options = @{ (id)kCGImageSourceShouldCache: @(YES) };
    CGImageSourceRef imageSource = CGImageSourceCreateWithData((__bridge CFDataRef)imageData, NULL);
    CGImageRef cgimage = CGImageSourceCreateImageAtIndex(imageSource, 0, (__bridge CFDictionaryRef)options);
    UIImage *image = [UIImage imageWithCGImage:cgimage];
    CGImageRelease(cgimage); 
    ```

2.  预缓存图像

    ```
    UIGraphicsBeginImageContext(CGSizeMake(1, 1));
    [image drawAtPoint:CGPointZero];
    UIGraphicsEndImageContext(); 
    ```

3.  将图像绘制到 1x1 位图上下文

    ```
    unsigned char pixelData[] = { 0, 0, 0, 0 };
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef context = CGBitmapContextCreate(pixelData, 1, 1, 8, 4, colorSpace, kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);
    CGImageRef cgimage = image.CGImage;
    int imageWidth = CGImageGetWidth(cgimage);
    int imageHeight = CGImageGetHeight(cgimage);
    CGContextDrawImage(context, CGRectMake(-testPoint.x, testPoint.y - imageHeight, imageWidth, imageHeight), cgimage);
    CGColorSpaceRelease(colorSpace);
    CGContextRelease(context); 
    ```

pixelData 具有 testPoint 处像素的 R、G、B 和 A 值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T00:08:26.320

CGImage 上下文可能几乎是空的，并且在您尝试读取第一个像素或绘制它之前不包含实际的像素数据，因此尝试加快从图像中获取像素的速度可能无法让您到达任何地方。还没有什么可以得到的。

您是否尝试从 PNG 文件中读取像素？您可以尝试直接跟踪文件并对其进行映射并自己解码PNG格式。从存储中提取数据仍需要一段时间。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-14T06:10:49.713

```
- (BOOL)isWallPixel: (UIImage *)image: (int) x :(int) y {

CFDataRef pixelData = CGDataProviderCopyData(CGImageGetDataProvider(image.CGImage));
const UInt8* data = CFDataGetBytePtr(pixelData);

int pixelInfo = ((image.size.width  * y) + x ) * 4; // The image is png

//UInt8 red = data[pixelInfo];         // If you need this info, enable it
//UInt8 green = data[(pixelInfo + 1)]; // If you need this info, enable it
//UInt8 blue = data[pixelInfo + 2];    // If you need this info, enable it
UInt8 alpha = data[pixelInfo + 3];     // I need only this info for my maze game
CFRelease(pixelData);

//UIColor* color = [UIColor colorWithRed:red/255.0f green:green/255.0f blue:blue/255.0f alpha:alpha/255.0f]; // The pixel color info

if (alpha) return YES;
else return NO;
} 
```

# javascript - Keypress or keydown event handling in grid

> ID：10405301
> 
> 赞同：3
> 
> 时间：2012-05-01T22:31:59.170
> 
> 标签：javascript, extjs, extjs4.1

How to handle those events in grid?

Obvious solutions like

```
grid.on('keypress', handler); 
```

or

```
listeners: { keypress: handler } 
```

don't work - handler is not being triggered.

What am I missing?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:38:09.697

Got it:

```
grid.view.addElListener('keypress', function() {
    ...
}); 
```

PS: also formed it as a separated grid plugin: [https://gist.github.com/2572486](https://gist.github.com/2572486)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T13:35:04.360

You can try the [itemkeydown](http://docs.sencha.com/ext-js/4-2/#!/api/Ext.grid.View-event-itemkeydown) event of Ext.grid.View.

# javascript - KnockoutJS 数据绑定从 IE7 和 IE8 中删除元素

> ID：10405302
> 
> 赞同：0
> 
> 时间：2012-05-01T22:32:04.287
> 
> 标签：javascript, internet-explorer-8, internet-explorer-7, knockout.js

我试图将四个属性绑定到一个相当简单的 HTML 结构。FF11、Chrome18 和 IE9 中的一切都是桃子，直到我在 IE7/IE8 中加载页面（通过更改 IE9 版本的开发人员工具中的浏览器和 Coument 模式）。

简单的 HTML 结构 - 仅输出四行绑定数据。一个标签和绑定的数据。

```
<div id="loyaltyProgramSummary" class="content-block clearfix" data-bind="with: CustomerPoints">
    <div class="form-row">
        <div>PricingGroup:</div>
        <div><span data-bind="text:PricingGroupName"></div>
    </div>
    <div class="form-row">
        <div>LifetimePointsToDate:</div>
        <div><span data-bind="text:LifetimePoints"></div>
    </div>
    <div class="form-row">
        <div>PointsUsed:</div>
        <div><span data-bind="text:RedeemedPoints"></div>
    </div>
    <div class="form-row">
        <div>AvailablePoints:</div>
        <div><span data-bind="text:AvailablePoints"></div>
    </div>
</div> 
```

第一行“PricingGroupName”是一个 ko.computed 字段，是最终被删除的字段。当我在 IE9 开发工具中查看呈现的 HTML 时，它已被完全省略。

```
 <div id="loyaltyProgramSummary" class="content-block clearfix" data-bind="with:CustomerPoints" __ko__1335910690335="ko3">            
       <div class="form-row" __ko__1335910690335="ko4">
            <div>LifetimePointsToDate:</div>
            <div><span data-bind="text:LifetimePoints" __ko__1335910690335="ko5">1000</div>
        </div>
        <div class="form-row" __ko__1335910690335="ko8">
            <div>PointsUsed:</div>
            <div><span data-bind="text:RedeemedPoints" __ko__1335910690335="ko6">1550</div>
        </div>
        <div class="form-row" __ko__1335910690335="ko9">
            <div>AvailablePoints:</div>
            <div><span data-bind="text:AvailablePoints" __ko__1335910690335="ko7">8450</div>
        </div>
    </div> 
```

我认为它可能与计算列有关，但“可用点”也是一个计算字段，它运行良好。

我创建了一个“小提琴”来说明这个问题，可以在[这里](http://jsfiddle.net/gary_stenstrom/UXA4Q/12/)找到......

任何帮助将不胜感激！

谢谢你，加里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:53:26.013

不要使用空的自闭合标签，改为 . [http://jsfiddle.net/UXA4Q/13/](http://jsfiddle.net/UXA4Q/13/)

# java - 此 jar 包含签名证书将在六个月内到期的条目

> ID：10405307
> 
> 赞同：7
> 
> 时间：2012-05-01T22:32:33.750
> 
> 标签：java, security, applet, code-signing

我已经以各种方式签署了我的 jar，但是当我使用命令时，我不断收到上述错误消息：

```
jarsigner -verify -verbose [my jar] 
```

有没有办法摆脱这个错误？如果没有重新认证，我的代码会在六个月后停止工作吗？

以下是用于生成密钥并对 Jar 签名的整套命令：

```
keytool -genkey -keystore [keystore] -alias [alias] -validity 2000
keytool -selfcert -keystore [keystore] -alias [alias] -validity 2000
jarsigner -keystore [keystore] [jar] [alias] 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-01T22:45:23.780

> 有没有办法摆脱这个错误？

这不是错误，而是警告。至于如何避免，请确保证书的有效期超过 6 个月。对于自签名证书，这是在生成密钥时提供正确参数的问题。这是[`keytool`示例](http://docs.oracle.com/javase/7/docs/technotes/tools/windows/keytool.html#EXAMPLES)。

```
keytool -genkeypair -dname "cn=Mark Jones, ou=Java, o=Oracle, c=US"
  -alias business -keypass <new password for private key> -keystore /working/mykeystore
  -storepass <new password for keystore> -validity 180 
```

重要的部分是`-validity 180`。例如，180 天或大约 6 个月。使用 1800 大约 5 年。

> 如果没有重新认证，我的代码会在六个月后停止工作吗？

不完全是。

*   某些系统上的用户将收到证书已过期的警告，并可以选择接受它。如果他们这样做，它将正常工作。例如“签名已过期”：
    ![](../Images/81d22010148df7139940c0d093c2a1b1.png)
*   其他系统可能被配置为自动拒绝过期的证书。在这些机器上，代码很可能永远不会启动，或者在极少数情况下会加载但应用了沙盒。

* * *

> 我以为我已经关闭了所有的 java 缓存，因为它在尝试开发时很烦人。

测试期间的小程序缓存是一个大问题。在绝对必要之前，我尽量避免在浏览器中测试小程序。我知道有两种方法可以测试不会缓存类的小程序。

1.  使用小程序查看器
2.  混合小程序/应用程序

# c++ - C++ - ostream、朋友和命名空间

> ID：10405312
> 
> 赞同：11
> 
> 时间：2012-05-01T22:33:02.790
> 
> 标签：c++, overloading, ostream

一切都很好，直到我将对象移动到命名空间。现在编译器声称我的 Color 属性是私有的。

我认为朋友的全部意义在于与班级的朋友分享封装的信息。

颜色.h

```
friend ostream & operator << (ostream& output, const st::Color& color); 
```

颜色.cpp：

```
 ostream & operator <<(ostream& output, const st::Color& color) {

    output << "Colors:\nalpha\t: " << color.a << "\nred\t: "  << color.r << "\ngreen\t: " << color.g
            << "\nblue\t: " << color.b <<  "\nvalue\t: " << color.color();

    return output;
} 
```

错误：

```
Color.h||In function 'std::ostream& operator<<(std::ostream&, const st::Color&)':|
Color.h|52|error: 'unsigned char st::Color::a' is private|
Color.cpp|15|error: within this context|
Color.h|49|error: 'unsigned char st::Color::r' is private|
Color.cpp|15|error: within this context|
Color.h|51|error: 'unsigned char st::Color::g' is private|
Color.cpp|15|error: within this context|
Color.h|50|error: 'unsigned char st::Color::b' is private|
Color.cpp|16|error: within this context|
||=== Build finished: 8 errors, 0 warnings (0 minutes, 1 seconds) ===| 
```

那么交易是什么？我使用 Code::Blocks 作为我的 IDE。当我在“颜色”参数上使用点运算符时，它甚至不会显示任何属性或方法。这显然是出现问题的迹象……某处。

我已经将朋友运算符重载出来，它编译得很好。其他地方没有错误。是什么赋予了？

它声明如下：

```
namespace st{

class Color {

    friend ostream & operator << (ostream& output, const st::Color& color);
 public:
     ....
 private:
    .....

};
}; 
```

编辑：

在我的 CPP 中，我现在已经这样做了：

```
namespace st{
ostream & st::operator <<(ostream& output, const st::Color& color) {

    output << "Colors:\nalpha\t: " << color.a << "\nred\t: "  << color.r << "\ngreen\t: " << color.g
            << "\nblue\t: " << color.b <<  "\nvalue\t: " << color.color();

    return output;
}
}

st::Color::Color() {

    reset();
}

st::Color::Color(const Color& orig) {

    a = orig.a;
    r = orig.r;
    g = orig.g;
    b = orig.b;
}

void st::Color::reset() {
    a = 0;
    r = 0;
    g = 0;
    b = 0;
}
... etc
} 
```

没有编译错误，但是这种情况在头文件中再次使用命名空间是否正常？或者这完全偏离了我应该做的事情？

编辑：@Rob 也感谢您的意见！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-01T22:34:37.627

您还需要在与对象相同的命名空间中声明和定义运算符。它们仍然可以通过 Argument-Dependent-Lookup 找到。

通常的实现如下所示：

```
/// header file
namespace foo {
   class A
   {
    public:
    A();

    private:
    int x_;
    friend std::ostream& operator<<(std::ostream& o, const A& a);
    };

    std::ostream& operator<<(std::ostream& o, const A& a);
} // foo

// cpp file
namespace foo {
     A::A() : x_(23) {}

     std::ostream& operator<<(std::ostream& o, const A& a){
     return o << "A: " << a.x_;
    }
} // foo

int main()
{
  foo::A a;
  std::cout << a << std::endl;
  return 0;
} 
```

**编辑**

似乎您没有在命名空间中声明您`operator<<`，并且还在命名空间之外定义它。我已经调整了代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:49:56.583

您还需要使用命名空间来限定您的运算符。它是在名称空间中声明的函数签名，因此要访问其符号，您需要在其前面加上名称空间。

试试这样：

```
namespace st {

    ostream & operator <<(ostream& output, const Color & color) {

        output << "Colors:\nalpha\t: " << color.a
               << "\nred\t: "   << color.r 
               << "\ngreen\t: " << color.g
               << "\nblue\t: "  << color.b
               << "\nvalue\t: " << color.color();

        return output;
    }
} 
```

# javascript - 用于 Rails 后端的基于主干的 Web 应用程序：单独的项目还是在 Rails 之上？

> ID：10405314
> 
> 赞同：4
> 
> 时间：2012-05-01T22:33:13.890
> 
> 标签：javascript, ruby-on-rails-3, backbone.js

我目前有一个用**rails3**编写的网络应用程序。我想编写一个基于主干的 js 应用程序，它将使用**rails3**服务；虽然有很多带有**rails的****骨干**示例，但我更愿意在不同的项目中构建它。该项目将是**纯**的，然后将指向其他项目的服务。 ****`html+css+js`****

 *****   这种方法的优点或障碍是什么？
*   还有其他方法吗？

我注意到 github 上的大多数 rails3-backbone projs 在幕后做了很多神奇的事情（例如：预编译车把资产，自动包含 js 文件），这使得理解所有部分如何协同工作变得更加困难。另外，如果我想使用 phonegap/trigger.io/etc 打包一个应用程序，这不是更难吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T19:12:14.073

在编写 Backbone 应用程序时，单独开发它实际上很有意义。换句话说，如你所说，将其开发为**纯**html+css+js 应用程序。

这样做有很好的理由：

1.  部署

    考虑何时部署应用程序。在某些时候，您肯定会想要部署应用程序的一些模块化组件。这可能是负责为您的客户提供 json 的后端服务，也可能是对 UI 的调整。无论是哪种情况，最好能够独立部署它们中的每一个。

2.  模块化

    能够在幕后使用一些 Rails 魔法来帮助开发您的 UI，这听起来很有吸引力。但是，请考虑项目的模块化。

    IMO，Backbone（或任何 AJAX 应用程序）很漂亮。美妙之处在于 UI 代码实际上与后端的实现无关。它可以与 PHP/JAVA/RAILS/PYTHON/YOU-NAME-IT 服务器通信，但它仍然无关紧要。也就是说，如果您正在实现一个 RESTFUL 服务器。事实上，UI 代码可以放在只提供静态内容的 NGINX 服务器上，它仍然可以完美运行。这实际上是你想要的。您的 UI 代码在任何时候（在开发或生产期间）都不应了解后端的框架或后端支持的任何工具。在 Backbone 项目中引入不必要的依赖是犯罪行为。

    想象有一天，当您认为适合迁移到不是 Rails 的不同架构时。如果有任何依赖关系，那将是一场噩梦。而是拥有一个完全独立于后端实现的 UI。

3.  包装

    您提到您将使用 PhoneGap 来打包您的应用程序。这可能是您的项目应该独立的最大原因。如果您打算将应用程序提交给 Apple，那么您将无法从服务器加载 js。所有脚本必须打包到必须是独立的应用程序中。

最后但并非最不重要的一点是，回答您有关“其他方法”建议的问题。这是相当模糊的，所以我不确定这个建议是否会有所帮助，但我想向您指出一些有助于组织 Backbone 项目并让您的生活更轻松的资源。

[使用 RequireJS 的骨干网](http://backbonetutorials.com/organizing-backbone-using-modules/)

我认为这是使用 Backbone 的最佳方式。[RequireJS](http://requirejs.org/)让您可以在 js 文件中指定依赖项，就像在编译语言中导入一样，这在组织 Backbone 项目并将代码分解为更小的模块时有很大帮助。requireJS 提供的优化工具还可以让您将所有 javascript 文件压缩到一个文件中。如果您想将项目打包到 PhoneGap 中，我相信这会派上用场。

[下划线](http://documentcloud.github.com/underscore/)

您提到使用 HandleBar。但是，我建议您查看下划线的模板引擎，该引擎的灵感来自 RoR 的模板。并且假设您对使用 Rails 非常满意，那么下划线模板引擎可能正是您正在寻找的。****

# java - java.lang.IllegalStateException：提交响应后无法转发

> ID：10405315
> 
> 赞同：1
> 
> 时间：2012-05-01T22:33:18.967
> 
> 标签：java, jsp, servlets

我知道这已经在这里讨论了至少一百万次，但是每个 servlet 在调用 forward() 之前都会重定向或刷新输出。我有同样的问题，但我没有对输出做任何事情。我的 servlet 只接受请求参数并提交到数据库并在请求上设置一个属性。然后，它将请求转发给他们显示属性的 jsp。我在 Tomcat 7 上使用 Servlet 3.0。这是我的 servlet doPost 方法，后面是要转发到的 jsp：

```
@Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp)
            throws ServletException, IOException {
        super.doPost(req, resp);

        DAOFactory daoFactory = DAOFactory.getFactory();
        daoFactory.getCompanyDAO().beginTransaction();

        Company company = new Company();
        company.setName(req.getParameter("companyName"));
        company.setContactEmail(req.getParameter("companyEmail"));
        company.setContactPhone(new Long(req.getParameter("companyMobile")));
        company.setAddressLine1(req.getParameter("companyAddressLine1"));
        company.setAddressLine2(req.getParameter("companyAddressLine2"));
        company.setCity(req.getParameter("companyCity"));
        company.setZipcode(Integer.parseInt(req.getParameter("companyZip")));
        company.setState(req.getParameter("companyState"));     
        company = daoFactory.getCompanyDAO().save(company);
        daoFactory.getCompanyDAO().commitTransaction();

        Employee owner = new Employee();
        owner.setFirstname(req.getParameter("ownerFirstName"));
        owner.setLastname(req.getParameter("ownerLastName"));
        owner.setEmail(req.getParameter("ownerEmail"));
        owner.setMobileNum(new Long(req.getParameter("ownerCellPhone")));
        owner.setZipcode(Integer.parseInt(req.getParameter("ownerZip")));
        owner.setRole("Employer");
        owner.setCompany(company);
        daoFactory.getEmployeeDAO().beginTransaction();
        owner = daoFactory.getEmployeeDAO().save(owner);
        daoFactory.getEmployeeDAO().commitTransaction();

        company.addEmployee(owner);
        company.setOwnerId(owner.getId());

        daoFactory.getCompanyDAO().beginTransaction();
        company = daoFactory.getCompanyDAO().save(company);
        daoFactory.getCompanyDAO().commitTransaction();

        req.setAttribute("company", company);
        RequestDispatcher rd = getServletConfig().getServletContext().getRequestDispatcher("/jsp/companyConfirmation.jsp");
        rd.forward(req, resp);

    } 
```

JSP：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
<h3>The Company was saved successfully</h3>
<p>
Company name: ${company.name}
</p>
</body>
</html> 
```

我确信我可能错过了一些非常微不足道的事情。我无法弄清楚它是什么，尤其是当我在转发请求之前没有向输出写入任何内容时。

PS：我也尝试`return;`在转发之后添加一个声明，但没有改变。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T23:35:21.980

您应该删除`super.doPost(req, resp)`方法调用。HTTPServlet 的 doPost 方法的默认实现返回 HTTP 405 状态代码，意思是“方法不支持”，这就是已提交的响应。因此，您不能将您的请求转发给其他 jsp。

这是`RequestDispatcher.forward(ServletRequest req, ServletResponse resp)`方法描述的一部分：“应该在响应提交给客户端之前（在刷新响应主体输出之前）调用 forward。如果响应已经提交，则此方法抛出 IllegalStateException。未提交的输出在响应缓冲区在转发之前自动清除”。

# android - Android：使用 .setShader() 损坏的 TextView

> ID：10405319
> 
> 赞同：4
> 
> 时间：2012-05-01T22:34:05.730
> 
> 标签：android, shader, textview

我正在尝试使用以下代码在某些 Android 文本视图上创建旧式 8 位效果：

```
 private static Shader InversetextShader = new LinearGradient(0, 0, 0, 22,
                                          new int[] { Color.RED, Color.BLUE },
                                          new float[] { 0, 1 }, TileMode.CLAMP);

 TextView t1 = (TextView) findViewById(R.id.textView2);
    t1.setText(getApplicationContext().getString(R.string.app_name_mele));
    t1.getPaint().setShader(InversetextShader);
    t1.setTypeface(font);
    t1.setShadowLayer(4f, 2.0f, 2.0f, Color.BLACK); 
```

该代码在 Android < 3 上运行，但自从我开始以 ICS（API 级别 14）为目标时就给我带来了问题。

TextView 非常简单：

```
 <TextView
        android:id="@+id/textViewRecords1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:gravity="center_horizontal"
        android:textAppearance="?android:attr/textAppearanceLarge" >
    </TextView> 
```

这是显示缺陷的图像，一些不应该存在的黑线：

（对不起，我不能发布图片）

[http://i.stack.imgur.com/xRWOM.png](http://i.stack.imgur.com/xRWOM.png)

如果我关闭显示器（即锁定手机）然后再次打开，缺陷就会消失。我已经尝试调用 .invalidate() 并再次绘制视图，但没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:22:20.237

听起来像是 UI 工具包 OpenGL 渲染器中的错误。这究竟发生在哪个版本的 ICS 上？您是否有我可以用来重现问题并可能修复它（如果它仍然存在）的 APK？**作为一种解决方法**，您可以使用

```
yourLayout.setLayerType(View.LAYER_TYPE_SOFTWARE,yourLayout.getPaint); 
```

在您的 TextViews 上强制软件渲染。

# macos - 如何为 OS X 应用程序符号化 PLCrashReports

> ID：10405320
> 
> 赞同：2
> 
> 时间：2012-05-01T22:34:06.973
> 
> 标签：macos, symbolicate, plcrashreporter

我已将 PLCrashReporter 添加到我的 OS X 应用程序中，并成功地将故障转储保存到服务器。但是，即使 .app 和 .dSYM 与 plcrashutil 和崩溃文件位于同一目录中，plcrashutil 似乎也没有符号化。

我还尝试按照 TN 2123 中的说明使用 gdb 获取地址，但它无法为崩溃文件中报告的符号提供源行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T08:53:15.383

plcrashutil 没有符号化，它只是以标准格式创建一个崩溃文件。您需要使用 Xcode 中的 symbolicatecrash.pl 来对报告进行符号化。

symbolicatecrash.pl 有一个补丁版本，它修复了一些错误，可在此处获得：[https ://github.com/TheRealKerni/QuincyKit/tree/develop/server/local](https://github.com/TheRealKerni/QuincyKit/tree/develop/server/local)

请注意，PLCrashReporter 目前无法在 Intel 64Bit 架构上正常工作！

但是，PLCrashReporter 开发人员正在与 HockeyApp 合作开发支持 64 位的新版本。见[http://www.mikeash.com/pyblog/friday-qa-2012-04-27-plcrashreporter-and-unwinding-the-stack-with-dwarf.html](http://www.mikeash.com/pyblog/friday-qa-2012-04-27-plcrashreporter-and-unwinding-the-stack-with-dwarf.html)和[http://www.hockeyapp.net/blog /2012/4/27/mac-os-x-sandbox-support-is-coming.html](http://www.hockeyapp.net/blog/2012/4/27/mac-os-x-sandbox-support-is-coming.html)

# php - MySQL语句选择列不是数字的地方

> ID：10405323
> 
> 赞同：5
> 
> 时间：2012-05-01T22:34:16.500
> 
> 标签：php, mysql, sql

我有一个运行的有问题的脚本，所以我需要选择所有包含不是直向上整数的值的行。我该怎么做呢？ISSTRING 在 Google 搜索中，但我收到一条错误消息，提示 ISSTRING 不存在。:(

到目前为止，我一直很困惑：

```
SELECT id, area, city FROM `homes` WHERE ISSTRING(`area`) OR ISSTRING(`city`) 
```

没有任何运气...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T23:17:33.343

RegExp 有效，但我要做的是检查 abs() 是否等于零并且该字段不为零。我认为这会比 RegExp 更快。

```
SELECT id, area, city FROM `homes` WHERE (abs(area) = 0 AND area != '0') OR (abs(city) = 0 AND city != '0') 
```

# java - 保存和删除按钮不起作用

> ID：10405325
> 
> 赞同：0
> 
> 时间：2012-05-01T22:34:31.050
> 
> 标签：java, save

我想保存我在文本字段中写的任何内容，并删除程序在单击搜索按钮后找到的行。为什么它不起作用？这是我的两个按钮：

```
private class dDelete implements ActionListener {
    public void actionPerformed (ActionEvent e) {
        HM.remove((String)result.getText());
    }
}

private class sSave implements ActionListener {
  public void actionPerformed (ActionEvent e) {    
     Set <String> ISet = HM.keySet();
     Iterator itr = ISet.iterator();
     String tuple = "";

     java.io.File iwrite = new java.io.File("c:\\temp\\savetest.txt");
     if (iwrite.exists()){
         System.out.println("The file exists");
         System.exit(0);
     }
     java.io.PrintWriter output = null;
     try {
         output = new java.io.PrintWriter(iwrite);
     } catch(Exception ex) {
         ex.printStackTrace();
     }

     while (itr.hasNext()) {
         String Keys = (String)itr.next();
         String val = HM.get(Keys);
         tuple = Keys + " " + val;

         output.print(tuple);
     }
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:42:31.343

您应该关闭输出编写器`output.close()`，这可能就是原因。

您没有显示要添加到集合 HM 中的内容，因此很难判断删除是否有效。检查对 HM.remove 的调用的返回值，您将查看它是否成功，否则您使用了错误的键（添加为删除时不使用相同/相等的键）。

`HM.entrySet()`除此之外，当您同时需要键和值（ ）时，我建议您遍历 entrySet 。

还要根据 Java 命名约定重命名您的类和变量（类以大写字母开头，实例变量不应该等）。了解更多信息。请参阅[Java 命名约定](http://java.sun.com/docs/books/jls/second_edition/html/names.doc.html#73307)。

# operator-precedence - 操作数评估顺序和关联性

> ID：10405326
> 
> 赞同：1
> 
> 时间：2012-05-01T22:34:35.323
> 
> 标签：operator-precedence

我很难弄清楚两者之间的区别。假设你有这些给定：

```
a[0] = 10
a[1] = 13
a[2] = 17
a[3] = 19
x = 0
y = 3 
```

运算符优先级：

```
++, --  
*, /, % Left Associative  
+, - Left Associative 
```

操作数求值顺序：
从右到左

鉴于上述规则，我将如何评估下面的表达式？

```
a[++x] + ++x % 7 % y 
```

根据我的教授的说法，答案是 18，但我不知道为什么。据我了解，关联性是评估相同优先级运算符的顺序，而操作数评估顺序是评估操作数的顺序，因此 2 % 7 将是 2 与从左到右的操作数评估顺序和 1 与操作评估顺序。谁能解释一下我的教授是如何得到 18 的答案的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:53:12.733

优先级和关联性告诉您表达式是如何（隐式）括起来的。然后评估顺序确定子表达式的评估顺序。

让我们看一下这个例子：

```
a[++x] + ++x % 7 % y 
```

在顶层，有`+`and `%`as 运算符。`+`优先级较低，所以

```
a[++x] + (++x % 7 % y) 
```

右子表达式有两个`%`，那是左结合的，因此

```
a[++x] + ((++x % 7) % y) 
```

现在使用从右到左的评估顺序，`((++x % 7) % y)`首先评估。再次使用从右到左的评估顺序，`y`首先评估，结果为 3。然后`++x % 7`评估。前 7 个，然后`++x`. 后者的结果是 1。所以这是`1 % 7 = 1`。我会把剩下的留给你，因为这是家庭作业。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:53:37.927

你有`() + () % 7 % y`. 根据规则，对 before和 that before`() % 7`进行评估。`... % y``() + ...`

在`++x % 7`您首先评估`++x`并获得 1 和`x=1`. `1 % 7 = 1`.
然后你做`1 % y`或`1 % 3`得到1。
现在你做`a[++x] + 1`。记住这一点`x=1`，你就明白了`a[2] + 1 = 17 + 1 = 18`。

# android - Android服务器-客户端应用程序会话问题

> ID：10405328
> 
> 赞同：1
> 
> 时间：2012-05-01T22:34:54.083
> 
> 标签：android, session, https, client-server, sessionid

我正在android上开发服务器客户端应用程序，我在应用程序的服务器端使用会话，但有时我在服务器上丢失了会话。Ps：我在服务器上使用 https 连接。

我正在使用这些来举行会议：

*   我正在使用单实例 DefaultHttpClient 并将其用于所有 http 请求。
*   我只使用 httpPost 方法
*   我只使用 https 证书：

    schemeRegistry.register(new Scheme("https", sslSocketFactory, 443)); ClientConnectionManager cm = new ThreadSafeClientConnManager(params, schemeRegistry);

*   我在所有 http 请求后保存我的 cookie：

    私人无效createSessionCookie（）{

    ```
    List<Cookie> cookies = httpclient.getCookieStore().getCookies();

    if (! cookies.isEmpty()){

        CookieSyncManager.createInstance(ctx);
        CookieManager cookieManager = CookieManager.getInstance();

        //sync all the cookies in the httpclient with the webview by generating cookie string
        for (Cookie cookie : cookies){

            Cookie sessionInfo = cookie;

            String cookieString = sessionInfo.getName() + "=" + sessionInfo.getValue() + "; domain=" + sessionInfo.getDomain();
            cookieManager.setCookie(UrlConstants.SERVICE_PRE_URL, cookieString);
            CookieSyncManager.getInstance().sync();
        }
    } 
    ```

    }

即使我正在做这些，我也会失去会话。请帮我解决这个问题，感谢您的任何建议最好的问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T09:45:44.140

您不应该手动对 cookie 进行任何操作，只需在`CookieStore`某处创建静态，将其分配给`HttpContext`，然后在您的请求中使用该上下文。Cookie 将自动保存和恢复。

这些是您的班级成员：

```
private static CookieStore cookieStore = new BasicCookieStore();
private HttpClient httpclient = new DefaultHttpClient();
private HttpPost post = new HttpPost("your url here"); 
```

这部分进入成员函数，它执行请求：

```
HttpContext ctx = new BasicHttpContext();
ctx.setAttribute(ClientContext.COOKIE_STORE, cookieStore);

HttpResponse result = httpclient.execute(post,ctx); 
```

# windows - 在 .bat 文件中执行程序后如何写入程序？

> ID：10405334
> 
> 赞同：0
> 
> 时间：2012-05-01T22:35:14.193
> 
> 标签：windows, batch-file, runas

我需要构建一个 bat 文件来运行该`Runas`命令。

这是我的命令

```
Runas /user:Administrator "psexec \\\\***.***.***.*** -accepteula -i -u **** -p **** \"C:\\Program Files\\****\\setup.bat\"" 
```

运行此命令时，我会在命令行中提示输入密码。

`Enter the password for Administrator:`

如何将输入密码的bat文件写入`password`提示：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:47:52.560

从[为什么 RunAs 程序不接受命令行上的密码？](http://blogs.msdn.com/b/oldnewthing/archive/2004/11/29/271551.aspx)

> RunAs 程序要求您手动键入密码。为什么它不接受命令行上的密码？
> 
> 这是一个有意识的决定。如果可以在命令行上传递密码，人们就会开始将密码嵌入到批处理文件和登录脚本中，这是可笑的不安全。
> 
> 换句话说，缺少该功能以消除不安全地使用该功能的诱惑。

简而言之，您的批处理程序将无法轻松完成。有第三方实用程序实际上会声称自己具有更高级别的身份验证，然后调用您的脚本，本质上是以管理员身份运行它们。

有些是花钱的，有些是免费的，我没有足够的经验来告诉你它们的质量。

# java - 椭圆不响应控件

> ID：10405336
> 
> 赞同：0
> 
> 时间：2012-05-01T22:35:25.910
> 
> 标签：java, swing, ellipse

我有一个游戏，其中两个椭圆出现在 JFrame 上，一个由 a - s - d - w 键控制，另一个由箭头键控制。这是我的运行方法：

```
public void run() {
        while (animator != null) {
            repaint();

            player1.move(player1.direction);
            player2.move(player2.direction);
            try {  
                Thread.sleep(100);  
            } catch (InterruptedException e) {  
                break;  
            }  
        }
} 
```

这是我的个人球员课程。这是玩家 1 类的paintComponent 方法。（玩家 1 和玩家 2 相同）变量 shape、xPos、yPos、size 和 Color 都很好。（它们依附于值）

```
public void paintComponent(Graphics g) { 
    Graphics2D g2 = (Graphics2D)g;

    switch(Shape) {
    case 1: Ellipse2D.Double ball = new Ellipse2D.Double(xPos, yPos, size, size);         
    g2.setPaint(Color);
    g2.draw(ball);
    g2.fill(ball);
    break;

    case 2: Rectangle2D.Double rectangle = new Rectangle2D.Double(xPos, yPos, size, size);
    g2.setPaint(Color);
    g2.draw(rectangle);
    g2.fill(rectangle);
    break;
    }   
} 
```

我通过使用一个名为 KeyController 的类来控制椭圆的方向。这是该程序的示例部分；其余的都是一样的（记住这只是一个摘录）：

```
public void keyPressed(KeyEvent e) {
    // Player 1 Left
    if(e.getKeyCode() == KeyEvent.VK_A){
        Player1.setDirection(270);
        System.out.println("A pressed");
    }

    // Player 1 Down
    if(e.getKeyCode() == KeyEvent.VK_S){
        Player1.setDirection(180);
        System.out.println("S pressed");
    }

    if(e.getKeyCode() == KeyEvent.VK_LEFT){
        Player2.setDirection(270);
        System.out.println("LEFT pressed");
    }

    if(e.getKeyCode() == KeyEvent.VK_DOWN){
        Player2.setDirection(180);
        System.out.println("DOWN pressed");
    } 
```

程序的其余部分运行良好。（它有一个 keyTyped 和一个 keyPressed）

现在我的问题是，当我运行我的程序时，我看到一个椭圆并且所有键都可以控制它，包括 a - s - d - w 键和箭头键。

如果您需要更多代码，请询问我。（我有一个主要方法，它工作正常。）

如何让 Ellipse 响应控件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T08:56:00.747

这是一个用键移动圆圈的小例子：

```
public static void main ( String[] args )
{
    JFrame controls = new JFrame ();

    controls.add ( new JComponent ()
    {
        private Point location = new Point ( 250, 250 );
        private int speed = 5;

        {
            setFocusable ( true );
            requestFocusInWindow ();
            addKeyListener ( new KeyAdapter ()
            {
                public void keyPressed ( KeyEvent e )
                {
                    boolean changed = false;
                    if ( e.getKeyCode () == KeyEvent.VK_W || e.getKeyCode () == KeyEvent.VK_UP )
                    {
                        location.y -= speed;
                        changed = true;
                    }
                    else if ( e.getKeyCode () == KeyEvent.VK_A ||
                            e.getKeyCode () == KeyEvent.VK_LEFT )
                    {
                        location.x -= speed;
                        changed = true;
                    }
                    else if ( e.getKeyCode () == KeyEvent.VK_S ||
                            e.getKeyCode () == KeyEvent.VK_DOWN )
                    {
                        location.y += speed;
                        changed = true;
                    }
                    else if ( e.getKeyCode () == KeyEvent.VK_D ||
                            e.getKeyCode () == KeyEvent.VK_RIGHT )
                    {
                        location.x += speed;
                        changed = true;
                    }
                    if ( changed )
                    {
                        repaint ();
                    }
                }
            } );
        }

        protected void paintComponent ( Graphics g )
        {
            Graphics2D g2d = ( Graphics2D ) g;
            g2d.setRenderingHint ( RenderingHints.KEY_ANTIALIASING,
                    RenderingHints.VALUE_ANTIALIAS_ON );

            g2d.setPaint ( Color.BLACK );
            g2d.drawOval ( location.x - 10, location.y - 10, 20, 20 );
        }
    } );

    controls.setSize ( 500, 500 );
    controls.setLocationRelativeTo ( null );
    controls.setDefaultCloseOperation ( JFrame.EXIT_ON_CLOSE );
    controls.setVisible ( true );
} 
```

使用简单的 Key 侦听器时，请确保该组件具有焦点 - 否则它根本不会收到任何键事件。因此，有时您必须强制更改焦点组件：

```
component.requestFocusInWindow (); 
```

# c - 无法编译哈希表 ADT - C

> ID：10405337
> 
> 赞同：0
> 
> 时间：2012-05-01T22:35:36.677
> 
> 标签：c, hash

我不断收到错误：

1.  赋值从没有强制转换的指针生成整数

尝试使用以下命令编译我的哈希表 ADT 时：

```
gcc hash_NEW.c -c 
```

该错误是在较大的 .c 文件中的 1 个函数中遇到的。我在这里先向您的帮助表示感谢

错误 1 ​​发生在行 (index = table->hash_func;)

```
void insert_hash(Phash_table table, char *key, void *data){
    Phash_entry new;   //pointer to a new node of type hash_entry
    int index;

    new = (Phash_entry)malloc(sizeof(hash_entry));
    new->key = (char *)malloc(sizeof(char)*strlen(key));  //creates the key array based on the length of the string-based key
    new->data = data;              //stores the user's data into the node
    strcpy(new->key,key);          //copies the key into the node

                                   //calling the hash function in the user's program
    index = table->hash_func;      //index will hold the hash table value for where the new 
    table->buckets[index] = new;   //Assigns the pointer at the index value to the new node
    table->total++;                //increment the total (total # of buckets)
} 
```

部分头文件：

```
typedef struct hash_table_ {
    hash_entry **buckets;           //Pointer to a pointer to a Linked List of type hash_entry
    int (*hash_func)(char *);
    int (*cmp_func)(void *, void *);
    int size;
    void **sorted_array;      //Array used to sort each hash entry
    int index;//=0
    int total; //=0
    int sort_num; //=0  
} hash_table, *Phash_table; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:47:44.597

查看类型定义，您可以看到它`Phash_table`是一个指向结构的指针，该结构的字段`hash_func`是一个接受 a`char *`并返回a 的函数`int`。

很可能你想要：

```
 index = table->hash_func(key); 
```

就目前而言，您正在尝试将“指向函数的指针”分配给“int”，这不太可能成为您所需要的。

# c# - 在 WPF 应用程序中以编程方式从 XAML 文件加载矢量图形

> ID：10405339
> 
> 赞同：12
> 
> 时间：2012-05-01T22:35:40.727
> 
> 标签：c#, wpf, xaml, vector-graphics, xamlreader

我想加载存储为 XAML 文件（单独的文件，而不是字典）的矢量图形，嵌入到我的应用程序中，我有几个问题要这样做：

1.  XAML 看起来有点模棱两可，因为它既可用于表示静态资源（如矢量图像），也可用于表示动态构建的接口（如 WPF 中的接口）。因此，我不清楚 XAML 矢量图像的格式：根元素应该是什么，例如 svg 矢量图像的“svg”标签？目前，我使用 Canvas 作为顶部元素，因为我想在另一个 Canvas 中绘制我的图形。

2.  以编程方式加载这些文件的最佳方法是什么（我的意思是，从 xaml 文件创建画布）？我已经看到（并尝试过）使用 XamlReader 的不同解决方案，但没有任何效果：应用程序崩溃并且调试器无济于事（我遇到的大多数问题似乎都发生在解析过程中，并且错误消息不清楚）。

我已阅读[http://learnwpf.com/post/2006/06/04/How-do-I-Include-Vector-Based-Image-Resources-in-my-WPF-Application.aspx](http://learnwpf.com/post/2006/06/04/How-do-I-Include-Vector-Based-Image-Resources-in-my-WPF-Application.aspx)，但链接到处理资源文件加载的文章已死，并且图像不是使用 C# 代码创建的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-14T21:36:30.437

好的，我自己找到了解决方案，这里是：

我的项目名为“Editor”，我已将要读取的 XAML 文件放在“Graphics”文件夹中。此文件名为“Image.xaml”。项目树如下所示：

![在此处输入图像描述](../Images/5528f648edc29a2ff1caa31be9aa2604.png)

XAML 文件本身包含以下代码：

```
<Canvas xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        Width="40" Height="40">
    <Rectangle Canvas.Left="0" Canvas.Top="0" Fill="White" Stroke="Black" StrokeThickness="1" Height="40" Width="40" />
    <!-- ... -->
</Canvas> 
```

（需要 xaml 命名空间“xmlns”引用）

用于加载文件的代码是：

```
StreamResourceInfo sr = Application.GetResourceStream(new Uri("Editor;component/Graphics/Image.xaml", UriKind.Relative));
Canvas result = (Canvas)XamlReader.Load(new XmlTextReader(sr.Stream));
layoutRoot.Children.Add(result); 
```

'layoutRoot' 是我的应用程序主 Canvas 的名称。

最后一点：*.xaml 文件的属性“BuildAction”必须设置为“Resource”，否则您将遇到十六进制值为 0x0C 的 XamlParseException（要更改此属性，请在项目树视图中右键单击文件）。

希望这能有所帮助。

# iphone - 我可以从照片中选择要使用的元数据，以便能够在关闭位置服务的情况下使用 ALAssetsLibrary？

> ID：10405340
> 
> 赞同：1
> 
> 时间：2012-05-01T22:35:45.410
> 
> 标签：iphone, ios, xcode, location, alassetslibrary

我发现当位置服务被禁用或未授予我的应用程序时，使用 ALAssetsLibrary 会出错。

我正在使用*enumerateGroupsWithTypes:usingBlock:failureBlock:*并且[文档](http://developer.apple.com/library/ios/#DOCUMENTATION/AssetsLibrary/Reference/ALAssetsLibrary_Class/Reference/Reference.html)说：

> **特别注意事项**
> 
> 如果用户未启用定位服务（在设置 > 常规中），此方法将失败并出现错误[ALAssetsLibraryAccessGloballyDeniedError 。](http://developer.apple.com/library/ios/DOCUMENTATION/AssetsLibrary/Reference/ALAssetsLibrary_Class/Reference/Reference.html#//apple_ref/c/econst/ALAssetsLibraryAccessGloballyDeniedError)

是否可以从照片中细化我要使用的元数据，所以我仍然可以从图书馆中获取它们？我实际上不需要拍摄照片的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:06:22.417

我们发现iOS 6中没有位置权限请求。可能iOS 6对Photos有其他的隐私控制。所以你不需要询问位置许可。我们的解决方案是检查 [[UIDevice currentDevice]systemVersion] 并且仅在 iOS >= 6 时使用 ALAssetsLibrary。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:00:06.503

不，这是不可能的（但是？这在 iOS 5.1 中是不可能的）

在没有位置警告的情况下访问库中的照片的唯一方法是呈现 UIImagePickerController，但显然这对于​​需要显示自定义画廊或一次访问多张图片的大多数项目没有多大帮助。

# opencv - OpenCV 的 DescriptorMatchers 中的匹配阈值

> ID：10405343
> 
> 赞同：1
> 
> 时间：2012-05-01T22:36:04.767
> 
> 标签：opencv

有没有办法为 OpenCV 的 features2d 中由 DescriptorMatcher 计算的潜在匹配的图像描述符对设置阈值？

详细地说，我有一个 Bruteforce-Matcher，我想用它计算两个图像的描述符对，并且只有具有最小*阈值*距离的对才应该匹配。

```
BFMatcher matcher(NORM_L2, true);
vector<DMatch> matches;
matcher.match(descriptors1, descriptors2, matches); 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T20:23:46.023

好的，所以我做了更多的阅读，发现了一些有趣的帖子，比如[如何使用基于 flann 的匹配器，或者通常在 opencv 中使用 flann？](https://stackoverflow.com/questions/5695034/how-to-use-flann-based-matcher-or-generally-flann-in-opencv)并想出了我自己的方式;-)

首先，我使用 FlannBasedMatcher 来匹配计算的描述符。之后，我对匹配项进行了排序（默认情况下，它们按距离升序排序）。创建了第二个 DMatch 向量，并添加了距离低于我选择的距离阈值的匹配项。就是这样。这样我也可以选择前 N 个匹配它的阈值被选择为坏。

可能不是最好/最干净的方式，但它是一个快速的解决方案，适用于原型情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T10:19:42.013

使用**radiusMatch**而不是**match**

```
matcher.radiusMatch(descriptors1, descriptors2, matches, your-threshold); 
```

# iteration - 在 Dart 中获取集合/列表中数字总和的最简洁方法是什么？

> ID：10405348
> 
> 赞同：76
> 
> 时间：2012-05-01T22:36:38.857
> 
> 标签：iteration, dart

我不喜欢使用索引数组，除了我认为它看起来很丑之外。有没有一种用匿名函数求和的干净方法？是否可以在不使用任何外部变量的情况下做到这一点？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2013-10-27T17:57:44.770

Dart iterables 现在有一个 reduce 函数（[https://code.google.com/p/dart/issues/detail?id=1649](https://code.google.com/p/dart/issues/detail?id=1649)），所以你可以在不定义自己的 fold 函数的情况下简单地做一个总结：

```
var sum = [1, 2, 3].reduce((a, b) => a + b); 
```

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2012-11-28T18:10:20.087

```
int sum = [1, 2, 3].fold(0, (previous, current) => previous + current); 
```

或使用更短的变量名称以使其占用更少的空间：

```
int sum = [1, 2, 3].fold(0, (p, c) => p + c); 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2021-07-31T15:05:43.863

这是一个非常古老的问题，但是

## **2021年其实有内置包**。

只需导入

```
import 'package:collection/collection.dart'; 
```

并调用`.sum`.`Iterable`

**完整示例**

```
import 'package:collection/collection.dart';

void main() {
  final list = [1, 2, 3, 4];
  final sum = list.sum;
  print(sum); // prints 10
} 
```

如果列表为空，则`.sum`返回`0`。

您可能还对`list.average`...感兴趣

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-05-03T17:48:24.673

对于这个特定问题，我仍然认为这更清晰，更容易理解。

```
num sum = 0;
[1, 2, 3].forEach((num e){sum += e;});
print(sum); 
```

或者

```
num sum = 0;
for (num e in [1,2,3]) {
  sum += e;
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-05-01T22:55:48.333

没有像现在这样使用核心库的干净方法，但是如果你滚动你自己的**foldLeft**那么有

```
main() {
  var sum = foldLeft([1,2,3], 0, (val, entry) => val + entry);
  print(sum);
}

Dynamic foldLeft(Collection collection, Dynamic val, func) {
  collection.forEach((entry) => val = func(val, entry));
  return val;
} 
```

我与 Dart 团队讨论了将**foldLeft**添加到核心集合中，我希望它很快就会出现。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-10-25T04:28:33.557

从 Dart 2.6 开始，您可以使用扩展在 List 上定义实用方法。这适用于数字（示例 1），也适用于通用对象（示例 2）。

```
extension ListUtils<T> on List<T> {
  num sumBy(num f(T element)) {
    num sum = 0;
    for(var item in this) {
      sum += f(item);
    }
    return sum;
  }
} 
```

示例 1（将列表中的所有数字相加）：

```
var numbers = [1, 2, 3];
var sum = numbers.sumBy((number) => number); 
```

示例 2（对所有 Point.x 字段求和）：

```
var points = [Point(1, 2), Point(3, 4)];
var sum = points.sumBy((point) => point.x); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-12-18T09:37:14.780

我建议您在任何常见的实用程序文件中创建此函数。

`T sum<T extends num>(T lhs, T rhs) => lhs + rhs;`

int、double、float 扩展了 num 类，因此您可以使用该函数对任何数字求和。

例如，

```
List<int> a = [1,2,3];
int result = a.reduce(sum);
print(result); // result will be 6 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-09-25T16:39:40.927

在此分享我的方法：

```
void main() {
  int value = sumTwo([1, 4, 3, 43]);
  print(value);
}

int sumTwo(List < int > numbers) {
  int sum = 0;

  for (var i in numbers) {
    sum = sum + i;
  }
  return sum;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-09-02T00:15:16.223

如果使用 fold 时出现`double`TypeError，则可以使用 reduce：

```
var sum = [0.0, 4.5, 6.9].reduce((a, b) => a + b); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-01-15T16:29:24.457

如果您计划对列表进行一些数学运算，通过扩展 ListBase 创建另一个包含 .sum() 和其他操作的列表类型可能会有所帮助。部分内容受到此响应的[启发，并通过此响应](https://stackoverflow.com/a/16839714/3050664)进行了[性能调整](https://stackoverflow.com/a/16247102/3050664)。

```
import 'dart:collection';
import 'dart:core';

class Vector<num> extends ListBase<num> {

  List<num> _list;
  Vector() : _list = new List<num>();
  Vector.fromList(List<num> lst): _list = lst;

  void set length(int l) {
    this._list.length=l;
  }

  int get length => _list.length;

  num operator [](int index) => _list[index];

  void operator []=(int index, num value) {
    _list[index]=value;
  }
  // Though not strictly necessary, for performance reasons
  // you should implement add and addAll.

  void add(num value) => _list.add(value);

  void addAll(Iterable<num> all) => _list.addAll(all);

  num sum() => _list.fold(0.0, (a, b) => a + b) as num;
  /// add additional vector functions here like min, max, mean, factorial, normalize etc

} 
```

并像这样使用它：

```
Vector vec1 = Vector();
vec1.add(1); 
print(vec1); // => [1]
vec1.addAll([2,3,4,5]); 
print(vec1); // => [1,2,3,4,5]
print(vec1.sum().toString()); // => 15
Vector vec = Vector.fromList([1.0,2.0,3.0,4.0,5.0]); // works for double too.
print(vec.sum().toString()); // => 15 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-21T09:09:53.163

查找所有飞镖列表元素总和的不同方法，

方法1：使用循环：这是最常用的方法。使用循环遍历列表并将列表的所有元素添加到最终的总和变量。我们在这里使用一个 for 循环：

```
main(List<String> args) {
  var sum = 0;
  var given_list = [1, 2, 3, 4, 5];

  for (var i = 0; i < given_list.length; i++) {
    sum += given_list[i];
  }

  print("Sum : ${sum}");
} 
```

方法 2：使用 forEach ： forEach 是另一种遍历列表的方法。我们也可以使用这种方法来找出 dart 列表中所有值的总和。它与上述方法类似。唯一的区别是我们不必初始化另一个变量 i 并且 list.length 不是必需的。

```
main(List<String> args) {
  var sum = 0;
  var given_list = [1, 2, 3, 4, 5];

  given_list.forEach((e) => sum += e);

  print("Sum : ${sum}");
} 
```

方法 3：使用 reduce ：reduce 方法使用给定函数迭代地将列表的所有元素组合为一个值。我们可以使用这种方法来找出所有元素的总和，如下所示：

```
main(List<String> args) {
  var given_list = [1, 2, 3, 4, 5];

  var sum = given_list.reduce((value, element) => value + element);

  print("Sum : ${sum}");
} 
```

方法 4：使用 fold ： fold() 类似于 reduce。它使用函数将列表的所有元素迭代地组合成一个值。它采用一个初始值并根据前一个值计算最终值。

```
main(List<String> args) {
  var sum = 0;
  var given_list = [1,2,3,4,5];

  sum = given_list.fold(0, (previous, current) => previous + current);

  print("Sum : ${sum}");
} 
```

更多详情：[https ://www.codevscolor.com/dart-find-sum-list-elements](https://www.codevscolor.com/dart-find-sum-list-elements)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-06-28T22:42:12.377

对我来说干净的解决方案是：

```
var total => [1,2,3,4].fold(0, (e, t) => e + t); // result 10 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-02-07T23:55:49.910

我只想在@tmaihoff 的回答中添加一些小细节（关于使用[collection.dart](https://pub.dev/packages/collection)包）：

`sum`他谈到的getter 仅适用于`num`值的可迭代对象，例如`List<int>`or `Set<double>`。

如果您有代表值的其他对象类型的列表（如`Money`、`Decimal`、`Rational`或任何其他），则必须将其映射到数字。例如，要计算字符串列表中的字符数，您可以执行以下操作：

```
// Returns 15.
['a', 'ab', 'abc', 'abcd', 'abcde'].map((e) => e.length).sum; 
```

截至 2022 年，另一种方法是使用[fast_immutable_collections](https://pub.dev/packages/fast_immutable_collections)包的`sumBy()`方法：

```
// Returns 15.
['a', 'ab', 'abc', 'abcd', 'abcde'].sumBy((e) => e.length), 15); 
```

注意：我是包作者。

# java - 为什么我的聊天应用程序在路由器后面不起作用？

> ID：10405352
> 
> 赞同：0
> 
> 时间：2012-05-01T22:36:57.617
> 
> 标签：java, sockets, router

我开发了一个聊天应用程序 Java/Socket(TCP)，它可以在我的本地网络上完美运行，但是当我将它放在路由器后面时它不起作用......我已经在我的路由器上测试了开放端口： [http：/ /www.yougetsignal.com/tools/open-ports/](http://www.yougetsignal.com/tools/open-ports/) 结果如下

```
80 (HTTP)is open
21 (FTP)is open
22 (SSH)22 is open 
23 (TELNET)is open
25 (SMTP)25 is open
.
.
. 
```

我用这个端口列表（`java -jar server.jar 23`）启动了我的服务器：

```
 int port=Integer.parseInt(args[0]);

    ServerSocket serverSocket = null;

        serverSocket = new ServerSocket(port);

    System.out.println("server started at " + port);
    Socket clientSocket = null ;

    // repeatedly wait for connections, and process
    while (true) {

        try {
            clientSocket = serverSocket.accept();
        } catch (IOException ex) {
            System.out.Println("error");
        }
        System.err.println("new client connected!");

        in = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
        out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(clientSocket.getOutputStream())),true);

        String s;
        while ((s = in.readLine()) != null) {
            out.println("from server: "+s);
        }

        // colse all
        out.close();
        in.close();
        clientSocket.close(); 
```

然后然后使用一个简单的客户端我尝试连接=>收到的任何内容....

问题出在哪里？那么 Skype、Msn 和其他聊天应用程序如何正常工作？有解决办法吗？

PS：我放了一个简单的代码（回显服务器）来代表我的真实服务器，这样你就可以快速理解我的代码:)。

致以我的问候 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:41:41.093

这只是一个猜测，您是否进入路由器的配置实用程序并将其设置为代理（通常称为端口转发）对客户端的 telnet 请求？您的路由器可能正在监听 23，但除非您在路由器的固件上运行聊天客户端，否则我怀疑它知道如何处理该流量。也许我误解了你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:47:14.877

仅仅让服务器在路由器后面运行不足以让外部客户端建立连接。无论服务器正在侦听哪个端口，路由器都需要在其上配置一个端口转发规则，该规则将该端口的入站流量转发到服务器正在运行的机器上。然后，客户端需要连接到路由器公共 IP 上的端口，以便路由器可以将该流量转发到服务器。

# ruby-on-rails - 是否有使用 openid 进行 Google 登录的omniauth 策略？

> ID：10405356
> 
> 赞同：0
> 
> 时间：2012-05-01T22:38:01.377
> 
> 标签：ruby-on-rails, ruby, openid, omniauth

我知道有一种`google-apps`使用 openid 的策略。而且我知道可以配置 Omniauth 的通用 openid 策略以使用常规（非应用程序）谷歌帐户。

我也知道有一个 google oauth 策略。但是对于基本身份验证，无需向 Google 注册应用程序，因为 openid 允许您在没有任何此类先决条件的情况下进行身份验证。（谷歌注册应用程序的表格现在对我来说是 500 英镑。）

所以我正在寻找的是一种omniauth 策略，它可以为非应用程序帐户执行google openid 登录。应该非常简单，我可能只是构建它。但我想我会在这里问是否有人首先知道。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T00:09:46.903

不需要为此定制策略。如果您希望能够拥有一键式 Google 登录按钮，则有两种选择：

首先，您可以通过预先提供 OpenID 标识符来链接到它。设置一个普通的 OmniAuth OpenID 策略，然后在你的视图中添加如下内容：

```
<a href='/auth/open_id?openid_url=https://www.google.com/accounts/o8/id'>Sign in with Google</a> 
```

或者，您可以使用 OmniAuth::OpenID 配置特定于 Google 的 OpenID 策略。这实际上是自述文件中的一个示例：

```
use OmniAuth::Builder do
  provider :open_id, :name => 'google', :identifier => 'https://www.google.com/accounts/o8/id'
end 
```

在这种情况下，只需将用户发送到`/auth/google`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:39:57.187

我个人使用设计和omniauth。查看[设计 OmniAuth 概述](https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview)，它展示了如何使用omniauth 为google 和yahoo 设置openID。

# api - 使用 REST API 创建具有嵌套关系的 Salesforce 案例对象

> ID：10405357
> 
> 赞同：7
> 
> 时间：2012-05-01T22:38:06.520
> 
> 标签：api, rest, salesforce

我正在尝试使用 REST API 创建一个新的 Case 对象，但需要了解如何格式化 JSON 主体以传入嵌套的 SObject。

这在文档中并不明显，我似乎找不到任何示例。有人有任何指示或以前做过吗？

SF Web UI 使用文本查找字段来设置（相关）联系人和帐户，我需要弄清楚如何绕过查找的需要或将相关记录的 SObjects 嵌入 JSON 中。

```
[{"message":"The value provided for foreign key reference Contact is not a nested SObject","errorCode":"INVALID_FIELD"}] 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T23:12:01.557

只需在新 Case 对象上设置 AccountId 和 ContactId 属性即可解决。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-06T21:29:41.957

我也没有看到任何有关此的文档，但是如果您查看 REST API 返回的任何标准对象的对象元数据，似乎后缀“Id”被附加到任何类型为“reference”的字段中。例如，Case 有 OwnerId、LastModifiedById、CreatedById 等。浏览器界面中显示的字段名称中不存在此后缀。SOAP API 的 WSDL 包括作为“ID”类型的简单元素的 ID，以及用于嵌套实际记录的复杂子元素。

# objective-c - 如何使用目标 c 更改两个视图的高度（一个视图缩小，另一个视图扩展）？

> ID：10405359
> 
> 赞同：0
> 
> 时间：2012-05-01T22:38:12.510
> 
> 标签：objective-c, uiview, uiviewcontroller

我在同一个视图控制器（popOver 窗口）中有两个视图（A&B）并且想要在它们之间切换，视图 A 大于视图 B，当 popOver 窗口第一次加载时我希望视图 A 只出现并且当我按下某个按钮时在它里面，它应该缩小让视图B出现在它上面，我尝试设置视图B的高度以在窗口第一次加载时适合所有窗口（内部viewDidLoad）然后降低它的高度并增加另一个的高度单击按钮时查看，我尝试了该代码，但它没有改变视图的高度！

```
-(void)viewDidLoad
{
[super viewDidLoad];
UIView *contactsView=[self.view viewWithTag:2];// is this a correct initialization of a  uiView from a view in a storyBoard ?
CGRect frame=contactsView.frame;
frame.size.height+=100;
contactsView.frame=frame;
} 
```

任何关于此的想法都会有所帮助，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T23:21:32.883

作为一般性答案（我没有时间了解更多细节），我将总体使用 3 个视图：

1）视图控制器拥有的视图。2) 视图 A 3) 视图 B

可以在视图控制器的 viewDidLoad 中创建视图 A 和 B。然后设置每个框架的位置和大小。将它们都添加到视图中：

// 在你的 .h 文件中创建这些变量：

```
UIView* m_vA;
UIView* m_vB;

- (void)viewDidLoad
{
    m_vA = [[[UIView alloc] initWithFrame:CGRectMake(0, 0, 50.0, 50.0)] autorelease];
    m_vB = [[[UIView alloc] initWithFrame:<your rect for View B>] autorelease];

    // The views will automatically be retained. 
    [self.view addSubview:vA];
    [self.view addSubview:vB];

    m_vB.hidden = YES;
}

// In your button callback, toggle the visibility of views
- (IBAction)buttonPressed:(id)sender
{
    // Toggle the visibility of views
    m_vA.hidden = !m_vA.hidden;
    m_vB.hidden = !m_vB.hidden;
} 
```

// 不要忘记在 dealloc 和 viewDidUnload 中清理这些视图的内存。

# sql-server - 连接多个表中的多行

> ID：10405362
> 
> 赞同：2
> 
> 时间：2012-05-01T22:38:20.543
> 
> 标签：sql-server, sql-server-2008, tsql, coalesce

我在这里查看了[许多](https://stackoverflow.com/questions/273238/how-to-use-group-by-to-concatenate-strings-in-sql-server) [其他](https://stackoverflow.com/questions/6038574/merge-two-tables-concatenate-values-into-single-column)帖子，并且对 Coalesce 功能非常熟悉，但我无法弄清楚如何执行此特定任务。

所以，我有一个佣金表和一个类别表。我在[这里创建了一个要点，](https://gist.github.com/2571879 "github gist 上的示例代码")因此您可以通过一些示例数据查看确切的数据结构。基本上，Commission 表有一个 SalesRepID、LocationID、CategoryID、SurgeonID 和 CommissionPercent 列。

[使用 Coalesce 函数](https://gist.github.com/2571968 "当前合并函数")，我可以通过传入 SalesRepID、LocationID 和 SurgeonID 来获得类似的结果：

```
.05 (Shirts), .05 (Shoes), .05 (Dresses), .10 (Hats), .15 (Pants) 
```

**但是，我试图让它看起来像：**

```
.05 (Shirts, Shoes, Dresses), .10 (Hats), .15 (Pants) 
```

我确实用 STUFF 尝试了几次，但我从来没有得到我想要的结果。

这让我想问这在 MsSQL 2008 R2 中是否可行？如果是这样，任何帮助获得我正在寻找的结果将不胜感激。

非常感谢您的时间和精力，

安德鲁

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:54:18.067

谢谢你的要点！比拔牙获取模式和数据要好得多。:-) 如果您将其插入到您的 gist 查询中，您应该会看到您所追求的结果（嗯，非常接近 - 见下文）。

```
DECLARE @SalesRepID int = 2, 
        @SurgeonID  int = 1, 
        @LocationID int = 1;

;WITH x AS 
(
  SELECT CommissionPercent, Categories = STUFF((SELECT N', ' 
      + tCat.Category FROM #tCategories AS tCat 
      INNER JOIN #tCommissions AS tCom 
      ON tCat.CategoryID = tCom.CategoryID
      WHERE tCom.CommissionPercent = com.CommissionPercent
      FOR XML PATH, 
      TYPE).value(N'./text()[1]', N'nvarchar(max)'), 1, 2, N'') 
 FROM #tCommissions AS com
 WHERE SalesRepID = @SalesRepID
   AND SurgeonID  = @SurgeonID
   AND LocationID = @LocationID
),
y AS
(
  SELECT s = RTRIM(CommissionPercent) + N' (' + Categories + N')' 
  FROM x GROUP BY CommissionPercent, Categories
)
SELECT Result = STUFF((SELECT N', ' + s FROM y 
  FOR XML PATH, 
  TYPE).value(N'./text()[1]', N'nvarchar(max)'), 1, 2, N''); 
```

结果与您要求的略有不同，但您可以通过在提取 CommissionPercent 时应用字符串格式来解决此问题。

```
Result
--------------------------------------------------------
0.05 (Shirts, Shoes, Dresses), 0.10 (Hats), 0.15 (Pants) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:49:05.543

我之前遇到过类似的问题 - 我可以解决这个问题（不使用游标）的唯一方法是创建一个 CLR 聚合函数。这是 C#（和 VB）中的一个示例：[http ://technet.microsoft.com/en-us/library/ms131056(v=SQL.90).aspx](http://technet.microsoft.com/en-us/library/ms131056(v=SQL.90).aspx)

我相信它只是做你需要的：连接。

结合您的示例和 CLR，以实现您想要的 - SQL 将如下所示：

```
SELECT
  c.CommissionPercent
  , dbo.MyAgg(cat.Category)
FROM #tCommissions AS c
JOIN #tCategories AS cat ON c.CategoryID = cat.CategoryID
group by c.CommissionPercent 
```

# java - Eclipse 是否有办法向我展示 Java 类的完整实现的“合并”？

> ID：10405365
> 
> 赞同：1
> 
> 时间：2012-05-01T22:38:29.987
> 
> 标签：java, eclipse, class-hierarchy

我目前正在使用具有相当长的类层次结构的 Java 框架。当爬过一个类的代码路径时，我必须在这个层次结构中的不同类之间来回跳转。

我正在寻找一种工具或 Eclipse 视图，它提供一个类的完整实现与其所有最具体的方法的“合成合并”。有这样的事情吗？

例如，我必须使用此类实现层次结构：InternalResourceViewResolver extends UrlBasedViewResolver extends AbstractCachingViewResolver。

现在，当在 InternalResourceViewResolver 中读取代码时，会调用其超类型的方法。来回浏览（使用 "Open Declaration" (F3) 和后退按钮 (Alt+Left) ）可能会让人感到困惑：我开始失去焦点并且碰巧错误地读取了实际上被我调查的子类覆盖的超类的方法实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:26:06.367

如果在将鼠标悬停在方法或类名上时按住 SHIFT 键，它会显示内联的源代码！你不必跳过去。

当我看到一个 super.doFoo() 方法时，我会移动鼠标悬停以查看它的作用！如果有趣，我可以 CTRL+单击或 F3 跳转到源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:40:26.130

可能有帮助的一件事是 Eclipse 中提供的（相对鲜为人知的）“书签”功能：

[http://www.luisdelarosa.com/2005/02/16/eclipse-tip-use-bookmarks-to-track-important-places-in-your-code/](http://www.luisdelarosa.com/2005/02/16/eclipse-tip-use-bookmarks-to-track-important-places-in-your-code/)

# c# - 业务层与服务层的服务引用

> ID：10405367
> 
> 赞同：1
> 
> 时间：2012-05-01T22:38:35.690
> 
> 标签：c#, wcf, n-tier-architecture, service-layer, business-logic-layer

我查看了标题相似的问题，但没有成功。我可以从业务层创建服务引用以从另一个业务实体中提取数据吗？还是应该从服务层完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T00:15:58.730

这并不容易回答，因为它可能会演变成一场巨大的哲学讨论。但是，我认为您的业务逻辑层不应该回到您的服务层来获取其他业务实体。

这种场景的典型方法是在业务逻辑之上有一个外观层。当需要检索多个业务实体时，该层负责协调响应。所以：

服务 -> 业务外观 -> 业务逻辑 -> 数据

**编辑：**对于小型、简单的应用程序，这是矫枉过正的。去掉门面层，简单的让服务调用一个逻辑方法，或者让服务调用多个逻辑方法。

服务层实际上只是一个传递，您最好在其中尽可能少地使用逻辑。这样就可以替换服务层，或者在不需要进行服务调用时让受信任的应用程序/服务直接（在本地机器上）调用外观层。

这种方法还允许您在外观级别放置“信任线”，并在那里实现安全性。如果要进行安全检查，并可能在此“信任线”上进行其他操作，那么我们只希望对业务外观进行一次服务调用，因此我们不会为每个需要检索的实体重复此逻辑。

外观层只是调用逻辑层上的方法的一层方法。外观方法可以像在逻辑层调用一个方法一样简单，也可以像在逻辑层调用多个方法并编排适当域实体甚至 DTO 的连贯响应一样复杂。

我可以继续。确实有整本书专门讨论这个问题。希望这至少有助于进行广泛的概述。

# javascript - Javascript regex - 删除除分号以外的所有特殊字符

> ID：10405368
> 
> 赞同：5
> 
> 时间：2012-05-01T22:38:39.203
> 
> 标签：javascript, regex

在javascript中，如何从字符串中删除除分号之外的所有特殊字符？

示例字符串：`ABC/D A.b.c.;Qwerty`

应该返回：`ABCDAbc;Qwerty`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-01T22:43:32.910

```
var str = "ABC/D A.b.c.;Qwerty";
var result = str.replace(/[^A-Za-z;]/g, ""); 
```

工作演示：http: [//jsfiddle.net/jfriend00/S9RU8/](http://jsfiddle.net/jfriend00/S9RU8/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-01T22:44:07.593

```
var str = "ABC/D A.b.c.;Qwerty";
var result = str.replace(/[^A-Za-z;]/g, "");​​ // 21ABCDAbc;Qwerty 
```

[**现场演示**](http://jsfiddle.net/HkBfU/1)

# ruby-on-rails-3.2 - 地图显示不好

> ID：10405370
> 
> 赞同：0
> 
> 时间：2012-05-01T22:38:58.130
> 
> 标签：ruby-on-rails-3.2, gmaps4rails

在索引操作中工作时一切正常，但是当我尝试在显示视图中显示地图时，它不能很好地显示。

控制器.rb：

```
def show
  @person = Person.find(params[:id])
  @json = Person.find(params[:id]).to_gmaps4rails

  respond_to do |format|
    format.html # show.html.erb
    format.json { render json: @person }
  end
end 
```

显示.html.erb：

```
<div class="tabbable">
  <ul class="nav nav-tabs">
    <li class="active"><a href="#profile" data-toggle="tab">Profile</a></li>
    <li><a href="#places" data-toggle="tab">Places</a></li>
  </ul>

  <div class="tab-content">
    <div class="tab-pane fade active in" id="profile">
      Some text here...
    </div>
    <div class="tab-pane fade" id="places">
      <%= gmaps(:map_options => {:type => "ROADMAP"},
                :markers => {:data => @json,
                             :options => {"list_container" => "markers_list" }}) %>
    </div>
  </div>
</div> 
```

模型.rb：

```
acts_as_gmappable

def gmaps4rails_address
  address 
end

def gmaps4rails_infowindow
  "<h3><img src=\"#{self.avatar(:thumb)}\"> #{ERB::Util.json_escape name.humanize}</h3>
   <hr/>
   <h4>#{ERB::Util.json_escape address.humanize}</h4>"
end

def gmaps4rails_sidebar
  "<span>#{name.humanize}</span>" #put whatever you want here
end 
```

有任何想法吗？这是屏幕截图的链接： http: [//cl.ly/2x2H002e3O0P1w0R0b3K](http://cl.ly/2x2H002e3O0P1w0R0b3K)

# mysql - 使用字符串函数显示特定数据

> ID：10405372
> 
> 赞同：1
> 
> 时间：2012-05-01T22:39:33.800
> 
> 标签：mysql, sql

我正在寻找一个字符串函数，它将显示我的表中的数据，其中 2 个值以 1 结尾。

例如

```
int_id     int2_id
101        302
201        301 
```

这里我想展示的数据是 201/301，因为它们都以 1 结尾。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:47:40.910

使用[模运算](http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_mod)：

```
SELECT * FROM `table` WHERE int_id % 10 = 1 AND int2_id % 10 = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:49:15.797

```
SELECT * FROM myTable WHERE RIGHT(int_id, 1) = 1 AND RIGHT(int2_id, 1) = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T22:57:06.770

```
SELECT * FROM `myTable` WHERE `int_id` LIKE '%1' and `int2_id` LIKE '%1'; 
```

该`%`字符是匹配任何内容的通配符。

# c# - 一次将整个 DataTable 插入数据库而不是逐行插入数据库？

> ID：10405373
> 
> 赞同：32
> 
> 时间：2012-05-01T22:39:40.450
> 
> 标签：c#, sql, sql-server

我有一个 DataTable，需要将整个东西推送到一个数据库表中。

我可以用一个 foreach 把它全部放在那里，一次插入每一行。由于有几千行，这很慢。

有什么方法可以一次完成整个数据表可能更快？

DataTable 的列数少于 SQL 表。其余的应该留空。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-11-20T22:55:39.157

我发现 SqlBulkCopy 是一种简单的方法，并且不需要在 SQL Server 中编写存储过程。

这是我如何实现它的示例：

```
// take note of SqlBulkCopyOptions.KeepIdentity , you may or may not want to use this for your situation.  

using (var bulkCopy = new SqlBulkCopy(_connection.ConnectionString, SqlBulkCopyOptions.KeepIdentity))
{
      // my DataTable column names match my SQL Column names, so I simply made this loop. However if your column names don't match, just pass in which datatable name matches the SQL column name in Column Mappings
      foreach (DataColumn col in table.Columns)
      {
          bulkCopy.ColumnMappings.Add(col.ColumnName, col.ColumnName);
      }

      bulkCopy.BulkCopyTimeout = 600;
      bulkCopy.DestinationTableName = destinationTableName;
      bulkCopy.WriteToServer(table);
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-05-01T23:08:59.807

由于您已经有一个 DataTable，而且我假设您使用的是 SQL Server 2008 或更高版本，因此这可能是最直接的方法。首先，在您的数据库中，创建以下两个对象：

```
CREATE TYPE dbo.MyDataTable -- you can be more speciifc here
AS TABLE
(
  col1 INT,
  col2 DATETIME
  -- etc etc. The columns you have in your data table.
);
GO

CREATE PROCEDURE dbo.InsertMyDataTable
  @dt AS dbo.MyDataTable READONLY
AS
BEGIN
  SET NOCOUNT ON;

  INSERT dbo.RealTable(column list) SELECT column list FROM @dt;
END
GO 
```

现在在您的 C# 代码中：

```
DataTable tvp = new DataTable();
// define / populate DataTable

using (connectionObject)
{
    SqlCommand cmd = new SqlCommand("dbo.InsertMyDataTable", connectionObject);
    cmd.CommandType = CommandType.StoredProcedure;
    SqlParameter tvparam = cmd.Parameters.AddWithValue("@dt", tvp);
    tvparam.SqlDbType = SqlDbType.Structured;
    cmd.ExecuteNonQuery();
} 
```

如果您在问题中提供了更具体的细节，我会给出更具体的答案。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-03-04T09:43:33.693

考虑[这种方法](https://msdn.microsoft.com/en-us/library/ex21zs8x(v=vs.110).aspx)，您不需要 for 循环：

```
using (SqlBulkCopy bulkCopy = new SqlBulkCopy(connection))
{
    bulkCopy.DestinationTableName = 
        "dbo.BulkCopyDemoMatchingColumns";

    try
    {
        // Write from the source to the destination.
        bulkCopy.WriteToServer(ExistingSqlTableName);
    }
    catch (Exception ex)
    {
        Console.WriteLine(ex.Message);
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-01-15T21:13:40.857

如果可以稍微偏离 DataTable -> SQL table 的直线路径，也可以通过对象列表来完成：

**1) DataTable -> 对象的通用列表**

```
public static DataTable ConvertTo<T>(IList<T> list)
{
    DataTable table = CreateTable<T>();
    Type entityType = typeof(T);
    PropertyDescriptorCollection properties = TypeDescriptor.GetProperties(entityType);

    foreach (T item in list)
    {
        DataRow row = table.NewRow();

        foreach (PropertyDescriptor prop in properties)
        {
            row[prop.Name] = prop.GetValue(item);
        }

        table.Rows.Add(row);
    }

    return table;
} 
```

来源和更多细节可以在[这里](http://vault.lozanotek.com/archive/2007/05/09/Converting_Custom_Collections_To_and_From_DataTable.aspx)找到。缺少的属性将保持其默认值（`int`s 为 0，引用类型为 null 等）

**2）将对象推送到数据库中**

一种方法是使用`EntityFramework.BulkInsert`扩展。但是，需要 EF 数据上下文。

它生成快速插入所需的 BULK INSERT 命令（用户定义的表类型解决方案比这慢得多）。

虽然不是直接的方法，但它有助于构建使用对象列表而不是`DataTable`s 的基础，这[似乎更节省内存](https://stackoverflow.com/questions/275269/does-a-datatable-consume-more-memory-than-a-listt)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-11T14:51:56.080

我更喜欢用户定义的数据类型：它超级快。

> 第 1 步：在 Sql Server DB 中创建用户定义表

```
CREATE TYPE [dbo].[udtProduct] AS TABLE(
  [ProductID] [int] NULL,
  [ProductName] [varchar](50) NULL,
  [ProductCode] [varchar](10) NULL
)
GO 
```

> 第 2 步：创建具有用户定义类型的存储过程

```
CREATE PROCEDURE ProductBulkInsertion 
@product udtProduct readonly
AS
BEGIN
    INSERT INTO Product
    (ProductID,ProductName,ProductCode)
    SELECT ProductID,ProductName,ProductCode
    FROM @product
END 
```

> 第 3 步：从 c# 执行存储过程

```
SqlCommand sqlcmd = new SqlCommand("ProductBulkInsertion", sqlcon);
sqlcmd.CommandType = CommandType.StoredProcedure;
sqlcmd.Parameters.AddWithValue("@product", productTable);
sqlcmd.ExecuteNonQuery(); 
```

**可能的问题：更改用户定义的表**

实际上没有 sql server 命令来更改用户定义的类型但是在管理工作室中，您可以通过以下步骤实现这一点

1.为该类型生成脚本。（在新的查询窗口或作为文件） 2.删除用户定义的表。3.修改创建脚本，然后执行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-01T22:43:07.200

您可以使用表值参数来执行此操作。

看看下面的文章：

[http://www.codeproject.com/Articles/39161/C-and-Table-Value-Parameters](http://www.codeproject.com/Articles/39161/C-and-Table-Value-Parameters)

# ios - iOS：读写Plist

> ID：10405376
> 
> 赞同：0
> 
> 时间：2012-05-01T22:39:50.580
> 
> 标签：ios, ios4, plist

我想将令牌从服务器保存到 plist 中。我不确定是否必须创建一个 plist firs 或者它可以在我的 Document 目录中使用以下代码自动创建。但是，我无法创建一个 plist 并将我的字典写入其中。这是我的代码

```
-(void)writeToPlist:(NSString*)value  forkey:(NSString *)key

{
    NSLog(@"Write plist here");

    //NSError *error;

    NSArray *paths=NSSearchPathForDirectoriesInDomains( NSDocumentDirectory, NSUserDomainMask, YES);

    NSString *documentDirectory=[paths objectAtIndex:0];

    NSString* path=[documentDirectory stringByAppendingFormat:@"Util.plist"];

    NSLog(@"The path is %@",path);

    NSFileManager *fileManager=[NSFileManager defaultManager];

    NSMutableDictionary *data;

    if(![fileManager fileExistsAtPath:path])
    {
        path=[[NSBundle mainBundle]pathForResource:@"Util" ofType:@"plist"];
    }

    [data setObject:value forKey:key];

    [data writeToFile:path atomically:YES];//will it create the plist?

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:46:20.483

为什么不使用 NSUserDefaults 保存它？

这是一个示例代码：

```
NSUserDefaults *standardUserDefaults = [NSUserDefaults standardUserDefaults];
if([standardUserDefaults objectForKey:@"your-key-goes-here"] == nil) //this means you don't have that key
{[standardUserDefaults setValue:@"your-value-goes-here" forKey:@"your-key-goes-here"];}
[standardUserDefaults synchronize]; 
```

不要忘记在决赛中同步。

当你需要数据时，你需要调用`standartUserDefaults`'s`:valueForKey`方法。

希望这可以帮助..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:16:27.203

我找到了一种以编程方式轻松创建 plist 文件的方法，这对我有用：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *path = [documentsDirectory stringByAppendingString:@"/myFile.plist"];
if (![[NSFileManager defaultManager] fileExistsAtPath:path]){
   NSDictionary *emptyDic = [NSDictionary dictionary];
   [emptyDic writeToFile:path atomically:YES];
} 
```

更改 if 语句中的内容，它将起作用。

# html - 居中的导航栏和链接

> ID：10405380
> 
> 赞同：1
> 
> 时间：2012-05-01T22:40:13.130
> 
> 标签：html, css, navigationbar

我一直在寻找一种方法来制作与页面一样宽的导航栏，并且链接均匀分布。我看过这两个地方：

[http://www.w3schools.com/css/tryit.asp?filename=trycss_navbar_horizo](http://www.w3schools.com/css/tryit.asp?filename=trycss_navbar_horizontal_float_advanced) [​​ntal_float_advanced http://www.cssnewbie.com/full-width-centered-navigation-bar/](http://www.cssnewbie.com/full-width-centered-navigation-bar/)

他们有点帮助，但没有解释均匀分布的链接。它们要么都向左浮动，要么向右浮动。对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:48:32.520

如果我理解你的问题，你必须使用百分比。

这是一个快速的例子：

```
ul {
  width: 100%;
  display: inline-block;
  background: green;
}

ul li {
  float: left;
  width: 25%;
  text-align: center;
}
```

```
<ul>
  <li><a href="">LINK 1</a></li>
  <li><a href="">LINK 2</a></li>
  <li><a href="">LINK 3</a></li>
  <li><a href="">LINK 4</a></li>
</ul>
```

列表中有 4 个项目，您需要将每个`LI`宽度设置为 25%，如果有 5 个项目，宽度将为 20%，依此类推...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:51:54.870

据我所知，使元素均匀分布的唯一方法是使用`<table>`宽度为 100% 的 a 。每个其他解决方案都需要您以百分比指定宽度，您可能不知道，因为链接的数量可能会有所不同。

除此之外，您仍然可以使用javascript来找出broser的视口有多大来指定宽度。[看到这个博客条目](http://andylangton.co.uk/articles/javascript/get-viewport-size-javascript/)

# php - 检查变量是否存在或重写值。哪个更快？

> ID：10405383
> 
> 赞同：0
> 
> 时间：2012-05-01T22:40:45.417
> 
> 标签：php, performance

我有一个定期运行的脚本，我只是好奇应该以哪种方式对其进行编码以最大限度地提高速度......

检查变量的值是否存在并跳过设置它，或者只是再次设置值是否更快？

例如，是否更快：

```
if($variable=="") { $variable = "blah"; } 
```

或者只是有

```
$variable = "blah"; 
```

或者这不是问题吗？一天结束时的速度差异可以忽略不计吗？

感谢您的帮助...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T22:43:08.120

我认为速度差异可以忽略不计，但是您的两个示例的逻辑根本不同（无条件设置值，而不是仅在当前值为空时设置值）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:43:46.803

再次设置变量，否则php必须检查

# javascript - 在 Javascript 中创建函数的 foo: function() 风格的正确名称是什么？

> ID：10405386
> 
> 赞同：2
> 
> 时间：2012-05-01T22:41:06.670
> 
> 标签：javascript

我遇到了这两种在 Javascript 中声明函数的方式。

一种是*[赋值表达式](http://kangax.github.com/nfe/)*，它声明`foo`函数返回的任何内容，即

```
var foo = function(){

//do something
}; 
```

声明函数的另一种方式似乎使它成为更大对象的属性：

> foo: function() { //做某事 }

我假设当您需要在对象上下文中访问该函数时，您会使用第二种形式，即：

```
myobject.foo(); 
```

第二种形式的正确名称是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:45:29.350

两者都是匿名函数，第一个分配给变量，第二个分配给对象文字中的属性。

请注意，*赋值表达式*只是：

```
foo = something 
```

在这种情况下，*事物*恰好是一个匿名函数，但术语*赋值表达式*用于所有赋值，而不仅仅是函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:50:58.230

以下：

```
var foo = function(){
  //do something
}; 
```

右侧是[FunctionExpression](http://es5.github.com/#x13)，它与 FunctionDeclaration 的不同之处在于，在执行代码之前不会创建函数，这是在处理函数声明并发生变量实例化之后。

它**不是**函数声明。

```
> foo: function() {
>  //do something
> } 
```

这也是一个函数表达式，将其与第一个形式相同：

```
var obj = {};
obj.foo = function(){...}; 
```

它也仅在执行代码时创建。以上两者之间没有实际区别，使用任何看起来最好的东西。

### 编辑

哦，在函数表达式中，名称是可选的（由于 IE 和命名函数表达式的问题，通常建议不要使用）。

# jsf - 为什么是 不工作？

> ID：10405389
> 
> 赞同：0
> 
> 时间：2012-05-01T22:41:26.920
> 
> 标签：jsf, file-upload, tomahawk

我正在使用 JSF 2.0，需要允许用户上传图片。我想使用 `<t:inputFileUpload>`和阅读它的行为类似于但是我在使用的**任何**`<input type="file">`浏览器中都看不到“浏览”选项。

 **我已经正确配置了我的 web.xml 并`<h:form enctype="multipart/form-data">`作为我的表单开始。表单内也只有一个标签。我也有我能收集到的所有必要的罐子。

还有人经历过这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T19:49:13.080

如果您`<t:inputFileUpload>`在生成的 HTML 输出中看到未解析的内容，而不是`<input type="file">`应该生成的内容，则表示该`t:xxx`名称空间未注册，或者包含它的 JAR 文件不在 webapp 的运行时类路径中。这样 JSF/Facelets 只会将其视为纯文本而不是真正的 JSF 标记，并且最终将在 HTML 输出中未解析。webbrowser 只理解 HTML 标签，因此它不会对未解析的 JSF 标签做任何事情，因此您在 webbrowser 的 UI 演示中什么也看不到。

确保 Tomahawk JAR 文件都在`/WEB-INF/lib`webapp 的文件夹中，并确保您已`t:xxx`在视图中声明命名空间，如下所示：

```
xmlns:t="http://myfaces.apache.org/tomahawk" 
```**

# javascript - 结合 Google Maps MarkerClusterer v3 和 Viewport Marker Management

> ID：10405394
> 
> 赞同：3
> 
> 时间：2012-05-01T22:41:48.620
> 
> 标签：javascript, jquery, google-maps-api-3, viewport, markerclusterer

我已经成功地设置了 MarkerClusterer v3 和视口标记管理（执行 ajax 调用以仅收集视口可见的标记并在地图“空闲”时渲染这些标记）。

但是，当我将它们组合在一起时，它们似乎只在页面第一次加载而不是之后一起工作。

缩放或平移时，保留初始集群，并且整个地图的标记呈现为非集群状态，但保留先前集群的标记。

当您放大/缩小时，原始的聚集标记仍然可以正常运行，但是在更改视口边界时提供的新标记不会添加到它们或聚集在一起。

下面的代码：

```
function drawMap(swLat, swLng, neLat, neLng){
    //Load the map data
     $.ajax({
            type: "POST",
            url: "readMapInfo.php",
            cache: false,
            data:{S:swLat, W:swLng, N:neLat, E:neLng},
            dataType: "xml",
            success: function(data) {
            if(markerArray.length >0){
                for (i in markerArray) {
                    markerArray[i].setMap(null);
                }
                drawMarker(data);   //takes the info provided and performs "markerArray.push(marker);"
                mc = new MarkerClusterer(map, markerArray, clusterOptions);
            } else {
                drawMarker(data);   //takes the info provided and performs "markerArray.push(marker);"
                mc = new MarkerClusterer(map, markerArray, clusterOptions);
            }
    });
}

google.maps.event.addListener(map, 'idle', function() {
    bounds = map.getBounds();
    sw = bounds.getSouthWest();
    ne = bounds.getNorthEast();
    swLat = sw.lat();
    swLng = sw.lng();
    neLat = ne.lat();
    neLng = ne.lng();

    drawMap(swLat, swLng, neLat, neLng);
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T03:05:46.223

您对问题的描述详细而透彻，但如果还有一个指向显示问题的页面的 URL 会更容易。当然，在这种特定情况下，这可能是不可能的。也就是说，我会尽力帮助：

我相信您在 ajax 成功回调开始时需要一些额外的清理代码：

```
if( markerArray.length > 0 ) {
    // For loop logic is unchanged
    // It removes the markers from the Map, but leaves them in markerArray
    for (i in markerArray) {
        markerArray[i].setMap( null );    
    }

    // New code to truncate the Array; the markers should be removed
    markerArray.length = 0;

    // New code to clear the clusterer; the markers should be removed
    mc.clearMarkers();        

    // Original line of code unchanged
    drawMarker(data);   //takes the data and performs markerArray.push(marker)

    // Commented out, because the cluster is cleared each time, not recreated
    //mc = new MarkerClusterer(map, markerArray, clusterOptions);

    // New code to refill the cluster, rather than recreate the cluster
    // The original clusterOptions are retained
    mc.addMarkers( markerArray );

} else {
    // Original line of code unchanged
    drawMarker(data);   //takes the data and performs markerArray.push(marker)

    // Original line of code unchanged
    // Necessary here, because the clusterer does not yet exist
    mc = new MarkerClusterer(map, markerArray, clusterOptions);
} 
```

我相信这将有助于您前进。请让我知道这是否可以解决问题或至少有帮助。

在你解决了眼前的挑战之后，我还建议你看看[MarkerClustererPlus](http://code.google.com/p/google-maps-utility-library-v3/wiki/Libraries#MarkerClustererPlus)；问题中对此进行了描述：[是否有任何方法可以在少于定义的标记计数时禁用标记聚类器？](https://stackoverflow.com/q/10266725/1314132).

# ruby - Rspec：模拟嵌套/依赖注入对象

> ID：10405396
> 
> 赞同：1
> 
> 时间：2012-05-01T22:41:57.377
> 
> 标签：ruby, dependency-injection, rspec, mocking

我无法模拟注入的对象。例如：

```
class Foo
  def initialize(bar = Bar.new)
    @bar = bar
  end

  def run
    @bar.do_something_cool
  end
end

# Rspec
describe Foo do
  it "should do something cool" do
    mock_bar = mock("bar")
    mock_bar.stub(:do_something_cool).and_return(nil)

    real_foo = Foo.new(mock_bar)
    real_foo.run

    mock_bar.should_receive(:do_something_cool).once
  end
end 
```

如果我运行它，规范会失败，因为它说永远不会调用“do_something_cool”。

```
 expected: 1 time
 received: 0 times 
```

但是，如果我不存根“do_something_cool”，我会收到以下错误

```
Mock "bar" received unexpected message :do_something_cool with (no args) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T22:46:12.347

```
mock_bar.should_receive(:do_something_cool).once 
```

应该是之前

```
real_foo.run 
```

# mysql - 在 MYSQL 选择语句中使用 '%' 和列名？

> ID：10405397
> 
> 赞同：0
> 
> 时间：2012-05-01T22:42:01.883
> 
> 标签：mysql

我有一个查询，它查看两个 mysql 表中的部分匹配以进行连接：

```
SELECT table1.column, table2.column FROM table1, table2 WHERE table1.val LIKE table2.val 
```

这可以作为连接正常工作，但是...... table2 中的一些值实际上是表 1 中值的子字符串 - 特别是它们是 url。因此，table1.val 可能等于[http://google.com](http://google.com)而 table2.val = google.com。

如何使用 table2 val 周围的 '%' 运算符进行比较。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T22:45:51.413

像这样：

```
... WHERE table1.val LIKE CONCAT('%', table2.val, '%') 
```

请注意，它的性能不如`table1.val = table2.val`，因为它现在必须搜索`table2`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:45:06.223

> 问：如何使用 table2 val 周围的 '%' 运算符进行比较。

答：你没有:)

您可以按名称（例如“mycolumn”）、完全限定名称（例如“mytable.myname”）或序号（例如“1”）指定列。

# php - php - 会话，检查管理员

> ID：10405398
> 
> 赞同：0
> 
> 时间：2012-05-01T22:42:04.647
> 
> 标签：php

除了管理员用户之外，我的所有登录都可以正常工作。

当我尝试导航到我的 admin.php 时，即使我已经以管理员身份登录，我也会收到“必须登录”。

当我单击管理链接时，我首先转到下面的代码 checkAdmin.php。

```
<?php
if($_SESSION['userEmail'] != 'admin@hotmail.com') {
    echo "<center><font face='Verdana' size='2' color=red>Must be logged in</font> <br><a href=index.php>Login Here</a></center>";
    exit;
}
?> 
```

我在这方面做错了吗？谢谢。

我有 session_start(); 在我的 admin.php 页面的顶部。我用 print_r($_SESSION); 并得到了这条线，所以它具有正确的价值。

```
Array ( [userEmail] => admin@hotmail.com ) 
```

另外，如果我添加 session_start(); 到 checkAdmin.php 然后屏幕就在 checkAdmin，当我点击进入管理页面时。

admin.php 在顶部有这个

```
session_start();
require "checkAdmin.php";
include("db_info.php"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:43:28.890

`session_start()`确保在检查会话变量之前已调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T22:43:37.317

*   `$_SESSION['userEmail']`您可能在登录过程中没有设置
*   也`session_start()`必须调用。
*   我会检查你的会话中真正的内容`print_r($_SESSION);`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T22:48:09.907

您是否尝试添加`session_start()`？您必须在查找会话变量之前执行此操作。

试试看：

```
<?php
session_start();
if($_SESSION['userEmail'] != 'admin@hotmail.com') {
    echo "<center><font face='Verdana' size='2' color=red>Must be logged in</font> <br><a href=index.php>Login Here</a></center>";
    exit;
}
?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T23:08:03.427

使用 var_dump() 而不是 print_r。请注意报告的字符串长度，因为某些字符不可见，但显然会导致字符串比较失败。

你可能有一个杂散的空白字符

# scripting - 需要帮助创建批处理文件以调用联网服务器列表并在每个服务器中查找文件

> ID：10405404
> 
> 赞同：0
> 
> 时间：2012-05-01T22:42:53.317
> 
> 标签：scripting, batch-file

所以我想弄清楚这一点，但我认为我的脚本技能达不到标准。:(

基本上我想做的就是这个。

有一个脚本调用一个文件，该文件有一个我想要查看的成员服务器列表。我想在每台服务器上搜索一个文件，然后吐出一个列出该文件路径的日志。

所以..例如，要引用的文件是`text.txt`并且在该文件中列出了服务器 1、2、3。

我想扫描此路径中的每个服务器的`c:\temp\`所有子目录并查找`file.exe`

然后吐出一个日志，显示服务器及其路径位置`file.exe`

```
server1 c:\temp\dir1\file.exe
server2 c:\temp\dir3\dir5\file.exe 
```

有人？？？:(

提前致谢！

这就是我到目前为止所做的......

```
@ECHO OFF
SET FLNM=file.exe
SET DRV=c
SET DIRS=temp
IF NOT DEFINED FLNM GOTO NAME
IF /I "%FLNM%"=="/Q" GOTO :EOF
SET FLNM=%FLNM: =.%
:DV
IF NOT DEFINED DRV GOTO DV
IF EXIST RESULTS.TXT DEL RESULTS.TXT
IF DEFINED DIRS SET DIRS=%DIRS: =.%
FOR %%D IN (%DRV%) DO (
    FOR %%G IN (%FLNM%) DO (
        IF DEFINED DIRS (
            FOR %%C IN (%DIRS%) DO (
                DIR %%D:\ /L /B /S|FINDSTR /I /E \%%C.\%%G>>RESULTS.TXT
            )
        ) ELSE (
            DIR %%D:\ /L /B /S|FINDSTR /I /E \%%G>>RESULTS.TXT
        )
    )
)
CALL :ZEROBYTE RESULTS.TXT
IF NOT EXIST RESULTS.TXT ECHO:"FILES NOT FOUND">>RESULTS.TXT
START NOTEPAD RESULTS.TXT
EXIT /B
:ZEROBYTE
IF %~Z1==0 DEL RESULTS.TXT
GOTO :EOF 
```

我可以让它在每个本地运行，但我宁愿集中运行它。我似乎也无法让它查看所有目录。如果我列出一个目录，它只会在该根目录中扫描。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:26:26.533

如果`test.txt`格式如下：

```
server1
server2
server3 
```

那么你可以这样做：

```
for /f %s in (test.txt) do dir/s/b \\%s\c$\temp\file.exe 
```

请注意，您需要成为域管理员才能对远程 Windows Vista/7/Server 2008/R2 计算机执行此操作，但对于 Windows 2000/XP/Server 2003，您只需对每台 PC 具有本地管理员权限。

或者，您可以在每台 PC 上共享临时文件夹，例如使用`net share temp$=C:\temp`，然后您可以使用`\\%s\temp$\file.exe`，然后您只需要正常的共享和文件权限。

# ruby-on-rails - 为什么 simple_format 助手似乎忽略了 ruby on rails 中的双新行？

> ID：10405424
> 
> 赞同：0
> 
> 时间：2012-05-01T22:44:20.360
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我有一个 micropost 功能，并且正在测试它在显示给用户时对已发布的文本进行格式化的方式。

**我像这样粘贴了以下文本**：

![在此处输入图像描述](../Images/2082721a96cb56946fbcec87eb783e22.png)

**这显示给我：**

![在此处输入图像描述](../Images/fff77049ae499e91c64860b13788da2b.png)

我正在使用“simple_format h（内容）”。当我删除助手时，显示的文本中没有“In”一词的新行。它显示为一个大段落，所以我假设助手正在工作，但由于某种原因，我的双新行被忽略了。

知道发生了什么吗？我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:04:50.847

通过查看它，您是指在文本区域内还是在页面上？如果它在页面上，则所有空格都被压缩为一个空格。如果是后者，只需使用 css 规则：

```
white-space:pre; 
```

在正确的选择器上。

但是，如果它位于 textarea 中（默认情况下保留空白），那么当您将其保存到数据库中时，一定有一些东西会剥离额外的空间。你可能想在模型和控制器中调试你的堆栈，看看这可能发生在哪里。我不得不承认我没有使用 simple_format 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T11:18:42.613

像往常一样感谢chrome开发人员工具。我意识到由 2 个新行分隔的每个文本都用 p 标签包裹，所以我只是使用 css 为 p 添加了 5px 的底部边距。完美运行。

# java - 我的类型非法扩展 DeleteResourceAction

> ID：10405425
> 
> 赞同：2
> 
> 时间：2012-05-01T22:44:27.020
> 
> 标签：java, eclipse

我有一个扩展的类型`DeleteResourceAction`。Eclipse 给了我以下警告：

```
An anonymous type defined in mishanesterenko.changevisualizer.command.handler.DeleteResourceCommandHandler.execute(ExecutionEvent) illegally extends DeleteResourceAction 
```

这个警告的原因是什么？

**UPD**

我有以下生成警告的代码：

```
DeleteResourceAction deleteAction = new org.eclipse.ui.actions.DeleteResourceAction(new CustomShellProvider(activeWindow)) {
            @Override
            public IStructuredSelection getStructuredSelection() {
                IStructuredSelection selection = (IStructuredSelection) selectionService.getSelection();
                Object element = selection.getFirstElement();
                if (element instanceof CustomProject) {
                    return new StructuredSelection(((CustomProject) element).getProject());
                }
                return selection;
            }
        }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:13:05.110

看一下[API](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fui%2Factions%2FDeleteResourceAction.html)就会发现这`DeleteResourceAction`并不意味着要被子类化。匿名类是子类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T23:13:20.830

在 DeleteResourceAction javadoc 中有一个明确的请求不要扩展该类。

[http://download.eclipse.org/eclipse/downloads/drops/S-3.8M3-201110271800/testresults/reports/org.eclipse.ui.ide_3.8.0.v20111007-1312/org.eclipse.ui.ide/org .eclipse.ui.actions/DeleteResourceAction.java.html](http://download.eclipse.org/eclipse/downloads/drops/S-3.8M3-201110271800/testresults/reports/org.eclipse.ui.ide_3.8.0.v20111007-1312/org.eclipse.ui.ide/org.eclipse.ui.actions/DeleteResourceAction.java.html)

# azure - Azure ServiceBus 队列——需要很长时间才能获取本地消息？

> ID：10405429
> 
> 赞同：0
> 
> 时间：2012-05-01T22:45:03.603
> 
> 标签：azure, message-queue, servicebus

我正在学习关于 ServiceBus 的基本教程。Web 角色将对象添加到 ServiceBus 队列，而工作角色从队列中读取这些消息并将它们标记为完成。这一切都在本地环境中（计算模拟器）。

看起来它应该非常简单，但我看到了以下行为：

1.  通话`QueueClient.Receive()`总是超时。
2.  有些消息只是挂在队列中，并没有被工作人员接收。

会发生什么？如何调试这些消息的状态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T06:21:49.990

您可以检查队列的长度（从门户网站或查看[MessageCount](http://msdn.microsoft.com/en-us/library/microsoft.servicebus.messaging.queuedescription.messagecount.aspx)属性）。

另一种可能性是消息是[DeadLettered](http://msdn.microsoft.com/en-us/library/microsoft.servicebus.messaging.brokeredmessage.deadletter.aspx)。[您可以使用此示例](http://code.msdn.microsoft.com/windowsazure/Brokered-Messaging-Dead-22536dd8)代码从 DeadLettered 子队列中读取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T03:59:26.043

首先，请确保队列中确实有一些消息。我想建议您运行本教程的最终解决方案：http: [//msdn.microsoft.com/en-us/WAZPlatformTrainingCourse_ServiceBusMessaging](http://msdn.microsoft.com/en-us/WAZPlatformTrainingCourse_ServiceBusMessaging)。如果一切正常，请将您的代码与示例代码进行比较。如果这不起作用，则可能是配置问题或网络问题。然后我建议您检查您是否已正确配置服务总线帐户，并检查您是否能够从您的计算机访问互联网。

此致，

明旭。

# php - 我网站上的表单域有问题

> ID：10405431
> 
> 赞同：0
> 
> 时间：2012-05-01T22:45:05.170
> 
> 标签：php, jquery, ajax, forms

我的网站上有一个基本表格，并一直在尝试添加电话号码字段。

**标头验证是：**

```
//process the contact form
    $('#submit-form').click(function(){
        var reg = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
        var names  = $('#contact-form [name="contact-names"]').val();  
        var email_address = $('#contact-form [name="contact-email"]').val();
        var phone = $('#contact-form [name="phone"]').val();
        var comment  = $.trim($('#contact-form #message').val());
        var data_html ='' ;

        if(names == ""){
            $('.name-required').html('Please enter your name.');
        }else{
            $('.name-required').html('');
        }
        if(phone == ""){
            $('.phone-required').html('Please enter your phone number.');
        }else{
            $('.phone-required').html('');
        }
        if(email_address == ""){
            $('.email-required').html('Your email is required.');
        }else if(reg.test(email_address) == false){
            $('.email-required').html('Invalid Email Address.');
        }else{
            $('.email-required').html('');
        }

        if(comment == ""){
            $('.comment-required').html('Comment is required.');
        }else{
            $('.comment-required').html('');
        }

        if(comment != "" && names != "" && reg.test(email_address) != false) {
            data_html = "names="+ names + "&phone" + phone + "&comment=" + comment + "&email_address="+ email_address;
            //alert(data_html);
            $.ajax({
                type: 'POST',
                url: 'php-includes/contact_send.php',
                data: data_html,
                success: function(msg){
                    if (msg == 'sent'){

                        $('#contact-form [name="contact-names"]').val('');  
                        $('#contact-form [name="contact-email"]').val('');
                        $('#contact-form #contact-phone').val('');
                        $('#contact-form #message').val('');
                        $(window.location = "http://theauroraclinic.com/thank-you.html");
                    }else{
                        $('#success').html('<div class="error">Mail Error. Please Try Again!</div>')  ; 
                    }
                }
            });

        }
        return false;
    });

});
</script> 
```

**实际形式为：**

```
<form id="contact-form" method="post" name="contact-form" class="infield rounded-fields form-preset">
<h3>We respect your privacy. </h3>
<h5> Please be assured that we will not share any information without your prior consent.</h5>
<p><span class="note">All fields are required!</span>
<p><label for="name">Name</label>
<input class="text" name="contact-names" type="text" id="name" />
<span class="name-required"></span></p>
<p><label for="email">Email</label>
<input class="text" name="contact-email" type="text" id="email" />
<span class="email-required"></span></p>
<p><label for="phone">Phone</label>
<input class="text" name="contact-phone" type="text" id="phone" />
<span class="phone-required"></span></p>
<p><label for="message" class="message-label">Message</label>
<textarea class="text-area" name="contact-comment" id="message"></textarea>
<span class="comment-required"></span></p>
<p><input class="send" id="submit-form" name="submit" type="submit" value="Send" /></p>                       
</form> 
```

**而表单处理php文件为：**

```
<?php
 $names = $_POST['names'];
 $email = $_POST['email_address'];
 $phone = $_POST['phone'];
 $comment = $_POST['comment'];
 $to ='name@email.com';

 $message = "";
 $message .= "*Name: " . htmlspecialchars($names, ENT_QUOTES) . "<br>\n";
 $message .= "*Email: " . htmlspecialchars($email, ENT_QUOTES) . "<br>\n";
 $message .= "*Phone: " . htmlspecialchars($phone, ENT_QUOTES) . "<br>\n";
 $message .= "Comment: " . htmlspecialchars($comment, ENT_QUOTES) . "<br>\n";
 $lowmsg = strtolower($message);

 $headers = "MIME-Version: 1.0\r\nContent-type: text/html; charset=iso-8859-1\r\n";
 $headers .= "From: \"" . $names . "\" <" . $email . ">\r\n";
 $headers .= "Reply-To: " .  $email . "\r\n";
 $message = utf8_decode($message);  mail($to, "Note from the Contact Form", $message, $headers);

 if ($message){
   echo 'sent';
 }else{
    echo 'failed';
 }
?> 
```

该表单仍然可以正常工作，但不会将任何输入传递到电话号码字段。我确实在提交时添加了重定向。奇怪的是，这只会影响 1 个字段。任何帮助都会很棒，我不擅长 js a& php！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:48:30.590

`contact-phone`电话字段未命名`phone`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:59:23.960

在 javascript 中，`[name="phone"]`应更改为`[name="contact-phone"]`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T09:18:45.547

```
data_html = "names="+ names + "&phone" + phone + "&comment=" + comment + "&email_address="+ email_address; 
```

改变这个... &phone= 不见了

```
data_html = "names="+ names + "&phone=" + phone + "&comment=" + comment + "&email_address="+ email_address; 
```

# mysql - MySQL NDB Cluster 是否考虑节点距离？如果它们更接近，它会使用复制品吗？

> ID：10405433
> 
> 赞同：0
> 
> 时间：2012-05-01T22:45:20.797
> 
> 标签：mysql, replication, mysql-management

我正在构建一个只有 3 台机器的非常小的 NDB 集群。这意味着机器 1 将同时作为 MGM 服务器、MySQL 服务器和 NDB 数据节点。数据库只有 7 GB，所以我计划至少复制每个节点一次。现在，由于查询可能最终使用缓存在机器一上 NDB 节点中的数据，即使它不是该数据的主要来源节点，访问也会快得多（原因很明显）。

NDB 集群是这样工作的吗？我看到的每个示例都至少有 5 台机器。该手册似乎没有提到如何处理像这样的节点差异。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T12:47:46.220

这里有几个问题：

可用性 / NoOfReplicas

当跨 2 个或更多数据节点进程复制数据时，MySQL Cluster 可以提供高可用性。这要求将 NoOfReplicas 配置参数设置为 2 或更大。NoOfReplicas=1 时，每一行只存储在一个数据节点中，数据节点故障意味着部分数据不可用，因此整个数据库不可用。

机器/主机数量

对于 NoOfReplicas=2 的 HA 配置，应该至少有 3 个独立的主机。每个数据节点进程都需要 1，它具有所有数据的副本。当两个数据节点进程之间的通信失败时，需要第三个充当“仲裁者”。这确保只有一个数据节点继续接受写入事务，并避免数据分歧（脑裂）。只有两台主机，集群只能对其中一台主机的故障有弹性，如果另一台主机发生故障，整个集群都会失败。仲裁角色非常轻量级，因此这第三台机器也可以用于几乎任何其他任务。

数据局部性

在 NoOfReplicas=2 的 2 节点配置中，每个数据节点进程存储所有数据。但是，这并不意味着只使用一个数据节点进程来读取/写入数据。两个进程都涉及写入（因为它们必须维护副本），通常，任何一个进程都可能涉及读取。

正在考虑在 2 节点配置中改进读取局部性的一些工作，但没有什么是具体的。

这意味着当 MySQLD（或另一个 NdbApi 客户端）与两个数据节点之一位于同一位置时，仍然会与另一个数据节点进行大量通信。

# c - 使用 GCC 语句表达式的匿名函数

> ID：10405436
> 
> 赞同：55
> 
> 时间：2012-05-01T22:45:35.763
> 
> 标签：c, gcc, lambda, anonymous-function

这个问题不是很具体。**这真的是为了我自己的 C 丰富，我希望其他人也能发现它有用。**

免责声明：我知道很多人会冲动地回应“如果你正在尝试做 FP，那么就使用函数式语言”。我在需要链接到许多其他 C 库的嵌入式环境中工作，并且没有太多空间容纳更多大型共享库，并且不支持许多语言运行时。此外，动态内存分配是不可能的。我也只是很好奇。

我们中的许多人都看过这个用于 lambda 表达式的漂亮 C 宏：

```
#define lambda(return_type, function_body) \
({ \
      return_type __fn__ function_body \
          __fn__; \
}) 
```

一个示例用法是：

```
int (*max)(int, int) = lambda (int, (int x, int y) { return x > y ? x : y; });
max(4, 5); // Example 
```

使用`gcc -std=c89 -E test.c`，lambda 扩展为：

```
int (*max)(int, int) = ({ int __fn__ (int x, int y) { return x > y ? x : y; } __fn__; }); 
```

所以，这些是我的问题：

1.  *行int (*X);*究竟是什么？宣布？当然，*int * X；*是指向整数的指针，但这两者有何不同？

2.  看看扩展的宏，final到底是`__fn__`做什么的？如果我编写一个测试函数`void test() { printf("hello"); } test;`- 会立即引发错误。我不明白那种语法。

3.  这对调试意味着什么？（我打算用这个和gdb来试验自己，但其他人的经验或意见会很棒）。这会搞砸静态分析仪吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-01T23:04:24.323

此声明（在块范围内）：

```
int (*max)(int, int) =
    ({
    int __fn__ (int x, int y) { return x > y ? x : y; }
    __fn__;
    }); 
```

不是 C，而是有效的 GNU C。

它使用了两个`gcc`扩展：

1.  [嵌套函数](http://gcc.gnu.org/onlinedocs/gcc/Nested-Functions.html)
2.  [语句表达式](http://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html)

嵌套*函数*（在复合语句中定义函数）和*语句表达式*（`({})`，基本上是一个产生值的块）在 C 中都是不允许的，它们来自 GNU C。

在语句表达式中，最后一个表达式语句是构造的值。这就是嵌套函数`__fn__`出现在语句表达式末尾的表达式语句的原因。表达式中的函数指示符（`__fn__`在最后一个表达式语句中）通过通常的转换转换为指向函数的指针。这是用于初始化函数指针的值`max`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-01T23:23:29.157

您的 lambda 宏利用了两个时髦的功能。首先，它使用嵌套函数来实际*定义*函数的主体（因此您的 lambda 并不是真正匿名的，它只是使用一个隐式`__fn__`变量（应该将其重命名为其他东西，因为双前导下划线名称是为编译器保留的，所以也许类似的东西`yourapp__fn__`会更好）。

所有这些都是在 GCC 复合语句中执行的（参见[http://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html#Statement-Exprs](http://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html#Statement-Exprs)），其基本格式类似于：

```
({ ...; retval; }) 
```

复合语句的最后一条语句是刚刚声明的函数的地址。现在，`int (*max)(int,int)`只需分配复合语句的值，它现在是指向刚刚声明的“匿名”函数的指针。

调试宏当然是一件非常痛苦的事情。

至于为什么`test;`..至少在这里，我得到'测试重新声明为不同类型的符号'，我认为这意味着GCC将其视为声明而不是（无用的）表达式。因为无类型变量默认为`int`并且因为你已经声明`test`为一个函数（本质上，`void (*)(void)`）你明白了..但我可能错了。

无论如何，这都不是可移植的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T22:51:50.377

部分答案：您感兴趣的不是 int(*X)。它是 int (*X)(y,z)。那是一个指向名为 X 的函数的函数指针，它接受 (y,z) 并返回 int。

对于调试，这将非常困难。大多数调试器无法通过宏进行跟踪。您很可能必须调试程序集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T22:50:18.633

1.  `int (*max)(int, int)`是您要声明的变量的类型。它被定义为一个名为 max 的函数指针，它返回 int，并以两个 int 作为参数。

2.  `__fn__`指函数名，在本例中为 max。

3.  我在那里没有答案。我想如果您通过预处理器运行它，您可以逐步完成它。

# c# - IF 语句的自定义验证问题

> ID：10405437
> 
> 赞同：0
> 
> 时间：2012-05-01T22:45:41.087
> 
> 标签：c#

这是代码：

```
 if (roomGender == "M")
            {
                if (gender == "F")
                {
                    row.Cells[5].BackColor = Color.FromName("#FF0000");
                    args.IsValid = false;
                    vldGender.ErrorMessage = building +" " + room + ": You cannot place a female in this space";
                }
                else
                {
                    vldGender.ErrorMessage = "";
                }
            }
            //end male gender check
            //Female gender check
            if (roomGender == "F")
            {
                if (gender == "M")
                {
                    row.Cells[5].BackColor = Color.FromName("#FF0000");
                    args.IsValid = false;
                    vldGender.ErrorMessage = building +" " + room + ": You cannot place a male in this space";
                }
                else
                {
                    vldGender.ErrorMessage = "";
                }
            }
            //end female gender check
            //Validate Names
            string last = ((TextBox)row.FindControl("txtLast")).Text;
            string first = ((TextBox)row.FindControl("txtFirst")).Text;

            if (last == "" && first != "")
            {
                row.Cells[3].BackColor = Color.FromName("#FF0000");
                args.IsValid = false;
                vldLast.ErrorMessage = building +" " + room + ": The last name cannot be blank";
            }
            else
            {
                vldLast.ErrorMessage = "";
            }
            if (last != "" && first == "")
            {
                row.Cells[4].BackColor = Color.FromName("#FF0000");
                args.IsValid = false;
                vldFirst.ErrorMessage = building +" " + room + ": The first name cannot be blank";
            }
            else
            {
                vldFirst.ErrorMessage = "";
            }

            if (last != "" && first != "" && gender == "")
            {
                row.Cells[5].BackColor = Color.FromName("#FF0000");
                args.IsValid = false;
                vldGender2.ErrorMessage = building +" " + room + ": A gender must be selected";
            }
            else
            {
                vldGender2.ErrorMessage = "";
            }
            if (!(regLast.IsValid))
            {
                row.Cells[3].BackColor = Color.FromName("#FF0000");
                regLast.ErrorMessage = building +" " + room + ": The last name is incorrect, please check the name";
            }
            if (!(regFirst.IsValid))
            {
                row.Cells[4].BackColor = Color.FromName("#FF0000");
                regFirst.ErrorMessage = building +" " + room + ": The first name is incorrect, please check the name";
            }
        }
    }
} 
```

**我的问题** 因为这是在 if 语句之一无法验证时使用 if 语句，所以 if 语句停止在该行上。因此，该行的其余字段未经过验证。

我有字段名，姓氏和性别。

如果我忘记添加名字和姓氏，但没有添加性别。

此验证只会显示我缺少名字，直到名字被固定后才会检查姓氏。

他们有什么方法可以解决这个问题，以便同时检查两个字段吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T23:16:00.657

这是一个经典案例，代码对于一个函数来说太复杂了。

如果您将每个字段作为一个独立的步骤进行验证，它将变得更具可读性和可维护性。

```
void ValidateRoomGender() 
{
     if(string.IsNullOrEmpty(roomGender))
     {
         vldRoomGender = "Please enter a room gender";
     }
     else if ((roomGender != 'M') && (roomGender != 'F'))
     {
         vldRoomGender = "Invalid Value";
     }
     else
     {
         vldRoomGender = string.Empty;
     }
}

void ValidateGender() 
{
     if( ((vldGender == 'F') && (vldRoomGender == 'M')) || ((vldGender == 'M') && (vldRoomGender == 'F'))
     {
          vldGender = "The gender must match the room"
     }
     else if (string.IsNullOrEmpty(vldGender))
     {
        // etc
     }
}

void Validate()
{
      ValidateRoomGender();
      ValidateGender();
      ValidateFirstName();
      ValidateSurname();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:04:13.237

我不确定它会在验证失败的地方返回，但我已经重新组织了您的代码以更高效和更易于维护。vldGender 和 vldGender2 有原因吗？regFirst 和 regLast 做什么？

此外，在比较字符串值时应避免使用 == 和 !=。检查 "" 或 null 时，应使用 string.Equals 或 string.IsNullOrEmpty。我还可以为您的一些错误消息推荐 String.Format 吗？

```
if (roomGender.Equals("M"))
{
    if (gender.Equals("F"))
    {
        row.Cells[5].BackColor = Color.FromName("#FF0000");
        args.IsValid = false;
        vldGender.ErrorMessage = building + " " + room + ": You cannot place a female in this space";
    }
    else
    {
        vldGender.ErrorMessage = "";
        vldGender2.ErrorMessage = "";
    }

}
//end male gender check
//Female gender check
else if (roomGender.Equals("F"))
{
    if (gender.Equals("M"))
    {
        row.Cells[5].BackColor = Color.FromName("#FF0000");
        args.IsValid = false;
        vldGender.ErrorMessage = building + " " + room + ": You cannot place a male in this space";
    }
    else
    {
        vldGender.ErrorMessage = "";
        vldGender2.ErrorMessage = "";
    }
}
//end female gender check
// No gender selected
else
{
    row.Cells[5].BackColor = Color.FromName("#FF0000");
    args.IsValid = false;
    vldGender2.ErrorMessage = building + " " + room + ": A gender must be selected";
}

//Validate Names
string last = ((TextBox)row.FindControl("txtLast")).Text;
string first = ((TextBox)row.FindControl("txtFirst")).Text;

if (string.IsNullOrEmpty(last))
{
    row.Cells[3].BackColor = Color.FromName("#FF0000");
    args.IsValid = false;
    vldLast.ErrorMessage = building + " " + room + ": The last name cannot be blank";
}
else            
    vldLast.ErrorMessage = "";

if (string.IsNullOrEmpty(first))
{
    row.Cells[4].BackColor = Color.FromName("#FF0000");
    args.IsValid = false;
    vldFirst.ErrorMessage = building + " " + room + ": The first name cannot be blank";
}
else
    vldFirst.ErrorMessage = "";

if (!(regLast.IsValid))
{
    row.Cells[3].BackColor = Color.FromName("#FF0000");
    regLast.ErrorMessage = building + " " + room + ": The last name is incorrect, please check the name";
}

if (!(regFirst.IsValid))
{
    row.Cells[4].BackColor = Color.FromName("#FF0000");
    regFirst.ErrorMessage = building + " " + room + ": The first name is incorrect, please check the name";
} 
```

# json - 一般捕获 500 内部服务器错误并返回 json

> ID：10405439
> 
> 赞同：1
> 
> 时间：2012-05-01T22:46:06.053
> 
> 标签：json, spring, rest, jackson

我正在使用 Spring MVC 编写一些 Spring REST 服务。我要求将任何 500（内部服务器错误）打包为带有 Http Status = 500 的 json 和带有 json 字符串 [“Internal Server Error”] 的 Http Body。为此，我正在扩展 OncePerRequestFilter 并检查 Http Response 的状态。然后，我正在使用所需的 json 响应构建主体。尽管这达到了目的，但它很混乱。是否有更好的设计原则或 spring/json 类可以使用 Spring 配置以达到相同的目的？

-戈茨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:03:22.813

我相信您可以使用以下结构：

1) 将 HTTP 500 错误映射到某个视图：

```
 <error-page>
        <error-code>500</error-code>
        <location>/errorView.htm</location>
    </error-page> 
```

2）在您的控制器中创建视图，它将返回您需要的任何 Json 信息。

```
@RequestMapping(value="/errorView.htm",method = RequestMethod.GET)
public String handleGet(HttpServletRequest req) {
     res.setStatus(HttpServletResponse.SC_METHOD_NOT_ALLOWED);
     res.setContentType("application/json");
     res.getWriter().print("{\Error"\:\"Internal Server Error\"}");
} 
```

希望能帮助到你。

# distance - 使用 Levenshtein 距离匹配的匹配百分比排名

> ID：10405440
> 
> 赞同：28
> 
> 时间：2012-05-01T22:46:09.487
> 
> 标签：distance, percentage, ranking, levenshtein-distance

我正在尝试使用 Levenshtein 距离算法将单个搜索词与可能匹配的字典进行匹配。该算法返回一个距离，表示为将搜索字符串转换为匹配字符串所需的操作数。我想在排名前“N”（比如 10 个）匹配的百分比列表中显示结果。

由于搜索字符串可以比单个字典字符串更长或更短，将距离表示为百分比的适当逻辑是什么，这将定性地反映每个结果与查询字符串的“百分比”有多接近，100 % 表示完全匹配。

我考虑了以下选项：

```
Q = query string
M = matched string
PM = Percentage Match
Option 1\. PMi = (1 - Lev_distance(Q, Mi)/Strlen(Q)) * 100
Option 2\. PMi = (1 - Lev_distance(Q, Mi)/max(Strlen(Q), strlen(Mi))) * 100 
```

如果距离大于搜索字符串长度（匹配字符串很长），选项 1 可能会出现负百分比。例如查询“ABC”与“ABC Corp.”匹配。将导致负匹配百分比。

选项 2 似乎没有在一组 Mi 中给出一致的百分比，因为每次计算可能会使用不同的分母，因此得到的百分比值不会被标准化。

我能想到的唯一其他方法是放弃 lev_distance 与任一字符串长度的比较，而是将前“N”个匹配的比较距离呈现为反向百分位数排名（100-percentile-rank）。

有什么想法吗？有更好的方法吗？我一定遗漏了一些东西，因为 Levenshtein 距离可能是最常见的模糊匹配算法，这一定是一个非常常见的问题。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2014-02-11T14:49:52.013

我有一个类似的问题，这个线程帮助我找到了解决方案。希望它也可以帮助其他人。

```
int levDis = Lev_distance(Q, Mi)
int bigger = max(strlen(Q), strlen(Mi))
double pct = (bigger - levDis) / bigger 
```

如果两个字符串完全相同，它应该返回 100%，如果它们完全不同，它应该返回 0%。

（对不起，如果我的英语不是那么好）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-14T23:11:45.060

我解决这个问题的方法是计算最大允许操作，这就是 Levenshtein 距离。我使用的公式是：

```
percent = 0.75; // at least 75% of string must match
maxOperationsFirst = s1.length() - s1.length() * percent;
maxOperationsSecond = s2.length() - s2.length() * percent;
maxOperations = round(min(maxOperationsFirst, maxOperationsSecond)); 
```

它计算每个字符串的最大操作数，相信计算容易理解。我使用两个结果的最小值并将其四舍五入到最接近的整数。您可以跳过这部分并仅使用任一字符串的最大操作值，这实际上取决于您的数据。

获得最大操作数后，您可以将其与 levenshtein 结果进行比较，并确定该字符串是否可以接受。这样，您可以使用任何扩展的 levenshtein 方法，例如[Damerau–Levenshtein distance](http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance)，它计算拼写错误，*例如 test -> tset*，仅作为 1 次操作，这在检查这些拼写错误经常发生的用户输入时非常有用。

我希望这可以帮助您了解如何解决此问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-05-29T21:09:42.287

```
Max = Lev_distance(Q,''); //max operations to transform query string to empty string
PM = (Max - Lev_distance(Q, Mi)) / Max * 100%; 
```

我认为这足以满足您的需求。它对于极值是正确的（完全满足相同和完全不同的字符串）并且是合理的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-11T01:01:45.557

这本质上是我的问题中提到的选项 2。但是，让我演示一下这种方法的一个问题。

```
Q = "ABC Corp" (len = 8)
M1 = "ABC"
M2 = "ABC Corporati"
M3 = "ABC Corp" 
```

我选择了 M1 和 M2，使它们的 Lev 距离相同（每个 5）。使用选项 2，匹配百分比将是

```
M1 = (1 - 5/8)*100  = 37.5%
M2 = (1 - 5/13)*100 = 61.5%
M3 = 100% 
```

正如您所看到的，如果我按此顺序显示比赛，M1 和 M2 之间的排名差异很大，即使它们具有完全相同的 lev 距离。你看到问题了吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T14:51:50.137

```
(1 - (levNum / Math.max(s.length,t.length) ) ) *100 
```

应该是正确的

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-26T20:14:02.663

我认为更简单的方法可能是：

```
from nltk import edit_distance

str1 = 'abc'
str2 = 'abd'
edit_dist  = edit_distance(str1,str2)
len_total = len(str1)+len(str2)
pct_edit_dist = ((len_total-edit_dist)/len_total)*100
print(pct_edit_dist) 
```

pct_edit_dist 为 100 表示完全匹配，0 表示不匹配。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-08T09:06:52.137

这个如何：

```
100 - ( ((2*Lev_distance(Q, Mi)) / (Q.length + Mi.length)) * 100 ) 
```

`(Q, M1)`它给出了相同的距离`(Q,M2)`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-06-20T20:08:57.710

levenshtein 距离的最大数量是`[l1, l2].max`。我认为这是真的。但我们不应该除此之外。

```
gem install levenshtein diff-lcs

Diff::LCS.lcs "abc", "qwer"
=> []
Levenshtein.distance("abc", "qwer").to_f / [3, 4].max
=> 1.0

Diff::LCS.lcs "abc", "cdef"
=> ["c"]
Levenshtein.distance("abc", "cdef").to_f / [3, 4].max
=> 1.0

Diff::LCS.lcs "1234", "34567890"
=> ["3", "4"]
Levenshtein.distance("1234", "34567890").to_f / [4, 8].max
=> 1.0 
```

Levenshtein 看起来不像是比较字符串的可靠方法**percents**。我不想将相似的字符串视为**100% 不同**。

我可以建议只分析每个序列和 LCS 之间的差异。

```
def get_similarity(sequence_1, sequence_2)
  lcs_length = Diff::LCS::Internals.lcs(sequence_1, sequence_2).compact.length
  lcs_length.to_f * 2 / (sequence_1.length + sequence_2.length)
end 
```

# excel - VBA 自动化 Outlook 邮件错误：将 2 个字符串放入 HTMLBody

> ID：10405441
> 
> 赞同：1
> 
> 时间：2012-05-01T22:46:10.950
> 
> 标签：excel, vba, outlook

运行以下代码后，我将看到第一部分显示在我的新电子邮件弹出窗口中，但不是第二部分。但是，如果我只是单击发送并接收它，我会看到 2 个部分正确显示。

为什么？为什么在发送之前我在新电子邮件弹出窗口中没有看到第二部分？

谢谢！！

代码

```
 Dim OutApp As Object
Dim OutMail As Object

With Application
    .EnableEvents = False
    .ScreenUpdating = False
End With

Set OutApp = CreateObject("Outlook.Application")
Set OutMail = OutApp.CreateItem(0)

On Error Resume Next
With OutMail
    .To = getConfig("MailTarget")
    .CC = ""
    .BCC = ""
    .Subject = "TEST"
    .HTMLBody = p1 & "<br><br>" & p2
    .Display   
End With
On Error GoTo 0

With Application
    .EnableEvents = True
    .ScreenUpdating = True
End With

Set OutMail = Nothing
Set OutApp = Nothing 
```

在旁边：

```
p1 = RangetoHTML(someRangeFromWorkBook1)
p2 = RangetoHTML(someRangeFromWorkBook2) 
```

更多代码：

```
Function RangetoHTML(rng As Range)

Dim fso As Object
Dim ts As Object
Dim TempFile As String
Dim TempWB As Workbook

TempFile = Environ$("temp") & "/" & Format(Now, "dd-mm-yy h-mm-ss") & ".htm"

'Copy the range and create a new workbook to past the data in
rng.Copy
Set TempWB = Workbooks.Add(1)
With TempWB.Sheets(1)
    .Cells(1).PasteSpecial Paste:=8
    .Cells(1).PasteSpecial xlPasteValues, , False, False
    .Cells(1).PasteSpecial xlPasteFormats, , False, False
    .Cells(1).Select
    Application.CutCopyMode = False
    On Error Resume Next
    .DrawingObjects.Visible = True
    .DrawingObjects.Delete
    On Error GoTo 0
End With

'Publish the sheet to a htm file
With TempWB.PublishObjects.Add( _
     SourceType:=xlSourceRange, _
     Filename:=TempFile, _
     Sheet:=TempWB.Sheets(1).Name, _
     Source:=TempWB.Sheets(1).UsedRange.Address, _
     HtmlType:=xlHtmlStatic)
    .Publish (True)
End With

'Read all data from the htm file into RangetoHTML
Set fso = CreateObject("Scripting.FileSystemObject")
Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)
RangetoHTML = ts.ReadAll
ts.Close
RangetoHTML = Replace(RangetoHTML, "align=center x:publishsource=", _
                      "align=left x:publishsource=")

'Close TempWB
TempWB.Close savechanges:=False

'Delete the htm file we used in this function
Kill TempFile

Set ts = Nothing
Set fso = Nothing
Set TempWB = Nothing
End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T06:49:39.400

我同意以前的海报，因为它似乎为我展示了两者！

最初，我会注释掉 With OutMail 块周围的错误陷阱，以防万一发生了一些您没有看到的错误。

过去我发现了几件事对 Outlook 问题有帮助：

*   保存每个邮件项目。

所以改变也许尝试以下方法：

```
With OutMail 
.To = getConfig("MailTarget") 
.CC = "" 
.BCC = "" 
.Subject = "TEST" 
.HTMLBody = p1 & "<br><br>" & p2 
.Save   '<<<<<<<<<<<
.Display    
End With 
```

*   当我过去处理大量电子邮件时，我会创建一个动态的对象数组，当电子邮件被创建时，我会添加到数组中，然后在程序的最后我会清空内容并显示它们或发送它们。不确定确切的语法。

# sql - 为什么这个 Oracle 10g XE 脚本不生成带有外键的表？

> ID：10405446
> 
> 赞同：0
> 
> 时间：2012-05-01T22:46:20.937
> 
> 标签：sql, oracle10g

我正在尝试运行一个脚本，它只是一系列删除表和创建表。它可以编译，但运行时出现以下错误：ORA-00942 表或视图不存在。它们不应该存在我正在尝试创建它们！任何人都知道为什么会发生这种情况？我使用的是 Oracle 界面，而不是命令行。我在 Notepad++ 中创建了代码并将其上传到 Oracle。然后我在 Oracle 中保存并运行该脚本。当我单击查看结果时，会出现错误。

编辑：我现在注意到只有没有创建外键的表！

这是我的代码的摘录：

```
CREATE TABLE PricePlans (
plan_id NUMBER(3) NOT NULL,
plan_name VARCHAR2(15) NOT NULL,
plan_desc VARCHAR2(30) NOT NULL,
plan_duration_months NUMBER(2) NOT NULL,
plan_cost NUMBER(4) NOT NULL,
CONSTRAINT pk_planid PRIMARY KEY (plan_id)
);

DROP TABLE Classes;
CREATE TABLE Classes (
class_id NUMBER(3) NOT NULL,
class_name VARCHAR2(30) NOT NULL,
class_desc VARCHAR2(30) NOT NULL,
class_facility NUMBER(2) NOT NULL,
class_instructor NUMBER(5) NOT NULL,
class_cost NUMBER(2) NOT NULL,
CONSTRAINT pk_classid PRIMARY KEY (class_id),
CONSTRAINT fk_classfacility 
    FOREIGN KEY (class_facility) 
    REFERENCES Facilities(facility_id),
CONSTRAINT fk_classinstructor 
    FOREIGN KEY (class_instructor) 
    REFERENCES Employees(emp_id)
);

DROP TABLE Facilities;
CREATE TABLE Facilities (
facility_id NUMBER(2) NOT NULL,
facility_name VARCHAR(15) NOT NULL,
facility_manager NUMBER(4) NOT NULL,
CONSTRAINT pk_facilityid PRIMARY KEY (facility_id);
CONSTRAINT fk_facilitymanager 
    FOREIGN KEY (facility_manager) 
    REFERENCES Manager(manager_id)
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:50:31.770

我相信`DROP TABLE`您查询中的语句正试图删除不存在的表。

从脚本中删除以下行。

```
DROP TABLE Classes;

DROP TABLE Facilities; 
```

`DROP TABLE`您可以在执行语句之前检查表是否存在。以下是一些可能对您有所帮助的答案。

[Oracle：如果表存在](https://stackoverflow.com/questions/1799128/oracle-if-table-exists)

[检查数据库中是否存在表 - PL SQL](https://stackoverflow.com/questions/3525448/check-if-table-exists-in-the-database-pl-sql)

# 更新

在*Classes的**CREATE TABLE*语句中，外键*fk_classfacility* 引用了稍后创建的表*facility*。尝试切换*CREATE TABLE*语句。先建表，再建表。****`Facilities``Classes`****

 ***我假设约束中引用的所有其他表都已经存在。***

# javascript - 鼠标光标跳到 IE 文本输入字段中的字符串开头

> ID：10405450
> 
> 赞同：1
> 
> 时间：2012-05-01T22:46:48.693
> 
> 标签：javascript, jquery, html, model-view-controller

当我单击其中包含文本的文本字段并将焦点设置到字符串的末尾（大多数人通常会这样做）时，光标的焦点会跳转到字符串的开头。

这只发生在 IE 中。该应用程序是带有 jquery 和 javascript 的 MVC 2。

如何调试这种行为？我不能使用 firebug，因为这是 IE 唯一的行为。IE 开发人员工具“脚本”选项卡几乎没有显示有助于我调试的信息。

我已经梳理了我们的 jquery，但没有任何原因作为原因跳出来。

您将采取哪些步骤来调试此问题。CSS会导致这种行为吗？我不这么认为。

可能，它可能是 LABEL/INPUT 元素布局......这肯定是一个因素。

这是表单 HTML。javascript 非常有限，不会导致此问题，因此为了简洁起见，我将仅显示此表单片段：

```
<div>
                        <span class="field">
                            <div><label for="Input_Sku" style="width: 130px;">SKU:</label><span class="field"><input id="Input_Sku" name="Input.Sku" type="text" value="" /><span></span></span><p class="message"></p></div>
                        </span>
                    </div>
                    <div>
                        <span class="field">
                            <div><label for="Input_ProductName" style="width: 130px;">Product Name:</label><span class="field"><input id="Input_ProductName" name="Input.ProductName" type="text" value="professional" /><span></span></span><p class="message"></p></div>
                        </span>
                    </div> 
```

编辑：

这是相当有限的Javascript代码：

```
 <script>
    $(document).ready(function() {  

         $('#reset').bind('click', function() {$('form').clearForm();});
        $(".tbl").tablesorter({ debug: false }); 
        $(".boxname").bind('click', function () {
            $('.tog').toggle();$('.a').toggle();$('.b').toggle();
        });
        $.fn.clearForm = function() {location.reload();};
</script> 
```

脚本参考：

```
<script src="/Scripts/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/Scripts/jquery-ui-1.8.6.custom.min.js" type="text/javascript"></script> 
```

我应该首先做的一个可能的解决方案是通过 JS Lint 运行页面，然后一次删除一个脚本引用，以查看行为是否消失 - 但我在这里采用“建设性惰性”方法。

编辑#2

我使用以下代码块尝试了 [this post][1] 中的解决方案：

```
 var el = $("#Input_Sku");
        el[0].onfocus = el[0].onblur = null;
        $(el).on("focus blur", function(e) {
            this.value = $.trim(this.value);    
            if ((e.type === "focus") && this.createTextRange) {
                var r = this.createTextRange();
                r.moveStart("character", this.value.length);
                r.select();
            }
        }); 
```

但它只工作了一半。它会将光标定位到 INITIAL FOCUS 上的字符串末尾，但在那之后，页面中任何文本字段中的任何类型的单击或光标移动都会导致光标跳回前面！令人沮丧。

我需要开始消除我猜可能导致这种情况的脚本；这将是一个巨大的痛苦，但这个错误已经成为一个阻碍 - 所以我越来越绝望。

# android - 在 Android 中使用自定义适配器和 SoftReference 时的性能建议

> ID：10405455
> 
> 赞同：1
> 
> 时间：2012-05-01T22:47:21.240
> 
> 标签：android, performance, memory, android-arrayadapter, soft-references

我实现了一个自定义适配器来创建一个显示与位置相关的信息的对话框（对话框的每个条目由一个图像、一个显示地址的文本字段和一个显示城市和国家的文本字段组成。）在 getView ( ...) 适配器的方法除了使用 ViewHolder 模式之外，我使用 SoftReference 类来保存对创建的视图的引用，以便在 OutOfMemoryError 发生之前消除 GC 中的任何一个。我的目标是构建一个更快、更高效的缓存。在我的自定义适配器的代码下方：

```
public class LocationsAdapter extends ArrayAdapter<LocationInfo> {

Context context;
int layourResourceId;
List<LocationInfo> locations;

public LocationsAdapter(Context context, int layourResourceId,
        List<LocationInfo> locations) {
    super(context, layourResourceId, locations);

    this.context = context;
    this.layourResourceId = layourResourceId;
    this.locations = locations;
}

@Override
public View getView(int position, View row, ViewGroup parent) {

    LocationItemHolder holder = null;

    if (row != null && ((SoftReference<LocationItemHolder>) row.getTag()).get() != null) {

        holder = (LocationItemHolder) ((SoftReference<LocationItemHolder>) row.getTag()).get();

    } else {

        LayoutInflater inflater = ((Activity) context).getLayoutInflater();
        row = inflater.inflate(layourResourceId, parent, false);

        holder = new LocationItemHolder();
        holder.imgMarker = (ImageView) row.findViewById(R.id.imgMarker);
        holder.txtNameStreet = (TextView) row
                .findViewById(R.id.txtNameStreet);
        holder.txtRegion = (TextView) row.findViewById(R.id.txtRegion);

        row.setTag(new SoftReference<LocationItemHolder>(holder));
    }

    LocationInfo location = locations.get(position);
    holder.imgMarker.setImageResource(location.getMarkerId());
    holder.txtNameStreet.setText(location.getNameStreet());
    holder.txtRegion.setText(location.getRegion());

    return row;
}

class LocationItemHolder {
    ImageView imgMarker;
    TextView txtNameStreet;
    TextView txtRegion;
}
} 
```

我对使事情尽可能高效非常感兴趣。虽然代码可以满足我的需求，但我不确定我是否能很好地使用 SoftReference 类。例如句子**(LocationItemHolder) ((SoftReference ) row.getTag ()).get()**我认为它使缓存无效，因为每次调用方法 getView 时要调用的方法数来检索所需对象，还需要多次铸件。那句话可以使缓存效率低下吗？是否建议在 Android 的适配器上下文中使用 SoftReference？

提前感谢您的回答：D

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:54:23.293

据我所知，在`SoftReference`这里使用 s 毫无意义。如果您正确地回收视图（看起来像），您将只有几个实例`LocationItemHolder`，它们总是相同的（在同一个适配器中）。它们失效的唯一时间是适配器停止使用时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T23:12:09.270

如前所述，没有必要使用`SoftReferences`.

您的应用程序是否存在导致 OutOfMemory 错误的问题？如果不是，那么尝试修复没有损坏的东西是没有意义的。

> “我们应该忘记小的效率，比如大约 97% 的时间：过早的优化是万恶之源”

# java - 游戏编程 - 无限循环的 CPU 使用率

> ID：10405456
> 
> 赞同：2
> 
> 时间：2012-05-01T22:47:21.313
> 
> 标签：java, software-design, 2d-games

我想创建一个简单的 2D 游戏。我不想使用线程。编程语言将是 Java（但可以是任何语言，并不重要......）。

`while(true)...`如果我使用像（无限循环）这样的主循环，是否可以避免高 CPU 使用率？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T23:01:35.910

在游戏中，您通常有一个运行所有内容的主循环。但是，为了避免做不必要的事情，通常只以一定的帧速率（例如每秒 60 帧 (FPS)）更新游戏。

大多数游戏通过使 CPU 休眠直到需要计算/绘制新帧来实现这一点。在 python 游戏库 pygame 中，这是使用[pygame.time.wait](http://www.pygame.org/docs/ref/time.html#pygame.time.wait)完成的：

> 将暂停给定的毫秒数。此函数使进程休眠以与其他程序共享处理器。等待几毫秒的程序将消耗很少的处理器时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T23:32:19.080

为了说明 Darthfett 的回答，主机游戏的主循环通常如下所示：

```
#define FRAMELENGTH (1.0 / 60.0) // 60hz = 16.6ms per NTSC frame. Different for PAL. 
while ( !QuitSignalled() ) 
{
   double frameStartTime = GetTime(); // imagine microsecond precision
   HandleUserInput( PollController() );
   SimulateEntities(); 
   Physics();
   Render();
   Sound();
   etc();

   double timeUntilNextFrameShouldStart = GetTime() - frameStartTime + FRAMELENGTH;
   sleep( timeUntilNextFrameShouldStart  );   
}
// if down here, we got the 'quit' signal 
ExitToDesktop(); 
```

当然，如果一个帧的执行时间超过 16.6 毫秒，上面的循环就会中断，所以我们有特殊的代码来检测它并赶上或丢帧，但这是基本思想。此外，直到最近，我们实际上并没有使用浮点数来表示时间，而是使用定点微秒计数器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T22:57:33.653

您所要做的就是“阻止输入”......并且您的CPU 使用率*为零。*无论如何，直到有事情发生。

几乎任何套接字程序都会有一个类似这样的循环：

```
 while (true) {
    select ()
    ... 
```

您可以轻松地等待“ `getchar()`”或“ `WaitOnSingleEvent()`”

有人可能会争辩说，“阻塞 I/O”实际上是一种*最佳*设计策略。它击败了替代方案 - “轮询”（轮询是邪恶的）。

恕我直言..

# emacs - org-babel 新语言

> ID：10405461
> 
> 赞同：5
> 
> 时间：2012-05-01T22:47:47.560
> 
> 标签：emacs, org-mode, org-babel

我想通过标准输入通过二进制文件运行一些代码并粘贴输出。语言是[foma](http://code.google.com/p/foma/)，有没有一种快速的方法或者我必须编写自己的定义？我试过[http://sprunge.us/DjOV](http://sprunge.us/DjOV)，但这给了我一个`if: Wrong type argument: stringp, (:colname-names)`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T17:30:52.877

如果 foma 可以运行一个文件（而不是 STDIN），那么简单地评估以下函数定义应该可以工作。这将写入`body`一个临时文件，调用`foma`该文件并返回输出（从 STDOUT 收集）。

```
(defun org-babel-execute:foma (body params)
  "Execute a block of Foma code with org-babel."
  (message "executing Foma source code block")
  (org-babel-eval "foma" body)) 
```

如果`foma`坚持通过 STDIN 获取输入，那么您可以将`foma`上面的内容替换为类似于`foma-helper`where `foma-helper`is a shell script 的内容

```
#!/bin/sh
cat $1|foma 
```

希望这可以帮助

# c++ - 是否可以从 Windows 服务中知道最后的用户活动？

> ID：10405465
> 
> 赞同：1
> 
> 时间：2012-05-01T22:48:10.500
> 
> 标签：c++, winapi, service, user-activity

我有一个 Windows 服务程序（使用 C++ 编写），需要在一天中的某个时间执行节能电源操作。我需要查明用户在执行电源操作时是否可能在终端，如果他/她在，则将其推迟。所以我的问题是，你怎么知道来自 Windows 服务（作为本地系统运行）的最后一次用户活动的时刻？

PS。用户活动是指键盘和鼠标活动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:31:13.920

每个用户会话都必须在其会话中运行一个与服务通信的后台应用程序，然后应用程序可以报告上次活动时间，以便服务可以根据该时间做出决策。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T04:11:53.473

根据它的确定性，您可以使用任务调度程序。它可以在计算机空闲时触发任务，等待一段时间等。您可以手动添加任务开始，然后[使用API](http://msdn.microsoft.com/en-us/library/windows/desktop/aa446861%28v=vs.85%29.aspx) ​​。

![任务计划程序电源设置](../Images/3e0c5742a71271c94eebcf81163efc6c.png)

# mysql - 学说和 symfony2 中的多个更新查询

> ID：10405467
> 
> 赞同：2
> 
> 时间：2012-05-01T22:48:21.253
> 
> 标签：mysql, symfony, doctrine

我尝试以多种方式做到这一点，但我找不到它工作的确切语法。我最近的尝试如下（在 Symfony2 Entity Repository 类中）：

```
public function updateOrdering($new_order, $evaluation_id)
{
    $qb = $this->createQueryBuilder('IddpRplusBundle:Answer');
    foreach($new_order as $item){
        $id = $item['id'];
        $answernr = $item['answernr'];
        $q = $qb->update('IddpRplusBundle:Answer a')
                ->set('a.answernr', $answernr)
                ->where('a.id = :id')
                ->getQuery()
                ->execute()
                ;
    }
} 
```

错误是“**无效的参数号：绑定变量的数量与标记的数量不匹配**”..我还想添加第二个 where 子句

```
->where('a.evaluation_id = :evaluation_id') 
```

这是 mysql 表中的外键，但随后错误变为“找不到评估 ID 字段”，即使它存在于表本身中（评估和答案实体之间的关系是一对多的，并且它被映射为实体）

有任何想法吗？

[更新]

下面的解决方案中有一个问题。我还必须添加对刷新的调用，否则它将开始累积更新字段，例如“更新答案集 answernr=1，answernr=2 where id=2”。所以最终的解决方案是：

```
->set('a.answernr', (int)$answernr + (int)$start)
->where('a.id = :id AND a.evaluation = :evaluation_id ')
                ->setParameters(array('id' => $id,'evaluation_id' => $evaluation_id))
                ->getQuery()
                ->execute()
                ;
        $this->_em->flush(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T23:28:52.730

您正在为 id 设置一个变量，但在执行查询之前没有将其绑定到一个值。

固定代码：

```
public function updateOrdering($new_order, $evaluation_id)
{
    $qb = $this->createQueryBuilder('IddpRplusBundle:Answer');
    foreach($new_order as $item){
        $id = $item['id'];
        $answernr = $item['answernr'];
        $q = $qb->update('IddpRplusBundle:Answer a')
            ->set('a.answernr', $answernr)
            ->where('a.id = :id')
            ->setParameter('id', $id)
            ->getQuery()
            ->execute();
    }
} 
```

至于您的“evaluation_id”字段，请检查实体类中的名称，在 DQL 中编写查询时需要使用字段名称，而不是列名称。

# java - 获取 Java 中方法的 @param 注释

> ID：10405474
> 
> 赞同：0
> 
> 时间：2012-05-01T22:49:00.303
> 
> 标签：java, parsing

有没有办法获取 Java 中方法的 @param 注释？我知道它可以通过解析每个 java 文件来轻松实现。然而，这似乎应该已经在像 JavaCC 这样的工具中可用。

示例 - 我希望能够阅读 ch 和观察者：

```
* @param ch        the character to be tested
* @param observer  the image observer to be notified 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T23:44:49.253

如果您有源代码，您可能想考虑使用[QDox](http://qdox.codehaus.org/)，它被描述为一种高速、占用空间小的解析器，用于从带有 JavaDoc @tags 的源文件中提取类/接口/方法定义。它旨在供活动代码生成器或文档工具使用。

[文档中的](http://qdox.codehaus.org/model.html)示例代码：

```
JavaMethod mth = cls.getMethods()[0];

// Access the JavaDoc comment
String comment = mth.getComment();
  // "This method does nothing at all."

// Access a single doclet tag
DocletTag returns = mth.getTagByName("returns");
returns.getName(); // "returns";
returns.getValue(); // "A boolean of whether we care or not."

// Access multiple doclet tags with the same name
DocletTag[] params = mth.getTagsByName("param");
params[0].getValue(); // "Someone's email address."
params[1].getValue(); // "Date of birth."

// Access specific parameters of a doclet tag by index
DocletTag permission = mth.getTagByName("permission");
permission.getParameter[0]; // "administrator"
permission.getParameter[1]; // "full-access"

// Access specific parameters of a doclet tag by name
DocletTag webservice = mth.getTagByName("webservice");
webservice.getNamedParameter("type"); // "rpc"
webservice.getNamedParameter("name"); // "myservice" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T23:06:00.380

您指的是 javadoc 注释中的 @param 吗？Javac（或者您真的是指 JavaCC 编译器编译器？）忽略它们，因为它们只是注释。不过，您可以使用 javadoc 工具，即使现在有记忆，也可以编写自己的 doclet。

还是您指的是方法注释？如果在注解声明中将保留设置为运行时，则可以在 java 代码中检索这些内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T00:03:37.960

简短的回答是“否”：在运行时无法访问注释，因为注释*没有*编译到`.class`文件中。

您可以使用各种方法解析源（如果可用），但这似乎与您的问题无关。

# java - 将 Collection 作为请求对象从 JSP 传递

> ID：10405479
> 
> 赞同：0
> 
> 时间：2012-05-01T22:49:39.113
> 
> 标签：java, jsp, servlets, request, jstl

在基于对象的状态构造 JSP 页面之前，我有一个对象（集合）。

```
 Map<Integer, QuestionBO> questionsIdsMap = new TreeMap<Integer, QuestionBO>();

        for (QuestionBO question : questionsForSubject) {
            questionsIdsMap.put(question.getQuestionId(), question);                
        } 

        request.setAttribute("questionsForSubject", questionsIdsMap); 
```

然后我对表单进行一些操作并将整个页面提交回 servlet 进行处理。

```
 <jsp:useBean id="questionsForSubject" class="java.util.Map" scope="request"/>

    <c:if test="${not empty questionsForSubject}">
    <form  action="/TutorWebApp/controller" method="POST" name="addQuestionForm">
        <input type="hidden" name="command" value="add_question_list" />
        <input type="hidden" name="testName" value="${testName}"/> 
        <input type="hidden" name="questionsForSubject" value="${questionsForSubject}"/>
        <table border ="1">
            <tbody>
                <c:forEach items="${questionsForSubject.keySet()}" var="questionID">
                    <tr>
                        <td>
                            <input type="checkbox" name ="choosen_question" value="${questionID}">
                            ${questionsForSubject.get(questionID).getQuestion()}
                            <br />
                        </td>
                    </tr>
                </c:forEach>
            </tbody>
        </table>
        <input type="submit" value="Add questions"/>              
    </form> 
    </c:if> 
```

传递前面提到的集合以使其在 servlet 端可用的传统方法是什么？

我应该在没有任何框架的情况下做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T01:59:06.897

既然你用过

```
request.setAttribute("questionsForSubject", questionsIdsMap); 
```

您不需要使用 jsp:useBean 标记。
对于显示，请尝试

```
<c:forEach items="${questionsForSubject}" var="current">
                <tr>
                    <td>
                        <input type="checkbox" name ="choosen_question" value="${current.key}">
                        ${current.value}
                        <br />
                    </td>
                </tr>
</c:forEach> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T05:22:13.517

创建 JSP 的请求和提交 JSP 时生成的请求是完全不同的请求，并且在调用 servlet 时放置在 JSP 上的任何属性都将不可用。

检查详细答案： [将对象从 JSP 页面传递回 Servlet](https://stackoverflow.com/questions/4253660/passing-object-from-jsp-to-servlet)

# google-maps - Google Maps API V3：搜索标记

> ID：10405484
> 
> 赞同：16
> 
> 时间：2012-05-01T22:50:18.290
> 
> 标签：google-maps, search

我正在为客户构建谷歌地图，他们希望能够搜索我已经添加到地图中的标记。

我已经构建了 V3 API 映射，该映射从 MySQL 表中获取标记并将它们推送到标记数组中，但我正在努力设置一个搜索框来列出与搜索查询匹配的任何匹配项。

有人有这方面的经验或能够帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-09-26T15:28:58.640

通过维护自己的从数据库中提取的引脚数据集并在自己的代码中处理它们的搜索，您会得到最好的服务。要实施，您需要保存对您为该数据集中的每个位置创建的引脚的引用。因此，从数据库中获取位置，在本地保存，将它们添加到地图中，使用对创建的 pin 的引用更新本地数据存储，然后将您的搜索连接到您的数据集，最后居中或您希望在地图 pin 上发生的任何事情您为该结果保存的参考。

这个谷歌演练很好地概述了这种类型的解决方案。 [https://developers.google.com/maps/articles/phpsqlsearch_v3?csw=1#creating-the-table](https://developers.google.com/maps/articles/phpsqlsearch_v3?csw=1#creating-the-table)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T05:39:05.970

我认为您需要访问以下链接

[https://developers.google.com/maps/documentation/javascript/places#place_search_requests](https://developers.google.com/maps/documentation/javascript/places#place_search_requests)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-30T22:18:39.940

对于 node.js 后端服务器，如果您已经将数据注册到数据库中，这里是查找元素的解决方案。

1.  首先，我们为带有后缀 /query 的 URL 创建了一个新的 POST 请求处理程序。此处理程序需要一个 JSON 或 mysql 数据库请求正文的数组，它指定三个参数：纬度、经度和距离。然后将这些参数转换并作为变量存储在处理程序中。

2.  然后，我们使用查询生成器格式创建了一个通用的 Mongoose 查询。这种格式首先建立一个通用查询对象，该对象等于我们数据库中所有用户的未过滤搜索。

3.  如果提供了距离，则查询构建器将添加一个新的搜索条件，该条件过滤掉落在查询坐标（纬度、经度）提供的距离内的所有用户。*

*这里我们还可以使用 MongoDB 搜索参数 $near 及其关联属性 maxDistance 和spherical 来指定我们要覆盖的范围。我们将查询主体的距离乘以 1609.34，因为我们希望获取用户的输入（以英里为单位）并将其转换为 MongoDB 期望的单位（以米为单位）。（对于 mongoDB 用户）

4.  最后，我们指定应该在假设球面的情况下确定距离。这很重要，因为我们将评估全球的距离，而不是平坦的欧几里得表面。

5.  最后，我们使用 query.exec 来指示 Mongoose 运行最终查询。如果查询没有遇到错误，它将提供符合条件的所有用户的 JSON 输出。

    // 获取满足某组查询条件的所有用户的 JSON 或数组记录 app.post('/query/', function(req, res){

    ```
    // Grab all of the query parameters from the body.
    var lat             = req.body.latitude;
    var long            = req.body.longitude;
    var distance        = req.body.distance;

    // Opens a generic Mongoose Query. Depending on the post body we will...
    var query = User.find({});

    // ...include filter by Max Distance (converting miles to meters)
    if(distance){

        // (optional)Using MongoDB's geospatial querying features. (Note how coordinates are set [long, lat]
        query = query.where('location').near({ center: {type: 'Point', coordinates: [long, lat]}, OR Your own query to be specified here.

            // Converting meters to miles(For mongoDB users). Specifying spherical geometry (for globe)
            maxDistance: distance * 1609.34, spherical: true});
    }

    // ... Other queries will go here ... 

    // Execute Query and Return the Query Results
    query.exec(function(err, users){
        if(err)
            res.send(err);

        // If no errors, respond with a JSON of all users that meet the criteria or you can also enter the array number you want to pass.
        res.json(users);
    }); 
    ```

    });

您还可以阅读有关[geojson](http://docs.mongodb.org/manual/reference/geojson/)的信息或使用 MEAN 堆栈参考此 Google Map 项目。

# javascript - 在 D3.js 中绘制实时时间序列时出现奇怪的 x 值

> ID：10405495
> 
> 赞同：1
> 
> 时间：2012-05-01T22:51:22.950
> 
> 标签：javascript, d3.js

我正在尝试绘制过去 2 小时的时间序列，只是一堆带有时间戳和值的点。例如`{time: 1234234553, value: 34}`

当一个新点到达时，我将它推到列表的末尾`data`

并重新绘制列表中的所有内容：

```
function redraw() 
{
    var TS = new Date().getTime(); // current time stamp
    var T = (60*60*2*1000); // last two hours

    chart.selectAll("rect")
     .data(data)
   .enter().append("rect")
     .attr("x", function(d, i)   { return x(d.time - TS + T); })
     .attr("y", function(d)      { return H - y(d.value); })
     .attr("width", function(d)  { return 2; })
     .attr("height", function(d) { return y(d.value); });
} 
```

但不幸的是，该点出现在绘图的左侧而不是右侧，当我在 Firebug 中查看 SVG 的源时，该条目有一个奇怪的 x 值：

```
<rect x="function (){}" y="354.9553019925952" width="2" height="45.044698007404804"/> 
```

任何人都可以帮忙吗？我需要删除所有绘制的数据并重新绘制吗？

附录：

如果您需要查看 x() 和 y()

```
var T = (60*60*2*1000); // 1 hurs

var x = d3.scale.linear()
        .domain([0, T])
        .range([0, W]);

var y = d3.scale.linear()
        .domain([d3.min(data, function(d) { return d.value; }), 10])
        .range([0, H]); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T05:08:44.340

这是如何制作情节的分步教程的链接。

**[Part I](http://mbostock.github.com/d3/tutorial/bar-1.html)** , **[Part II](http://mbostock.github.com/d3/tutorial/bar-2.html)**（我猜你读过）

我认为只有当你给出错误的“x”位置时，新的矩形才能在左边。

这`return x(d.time - TS + T);`看起来不错。`d.time`所以我认为，在&某处有问题`TS`。

你确定你有相同 TZ 的时间戳吗？2小时的差异会产生这样的效果。或者可能是“新点”不是很新。

# java - 在 Java 中获取友好 url 后面的文件名

> ID：10405499
> 
> 赞同：3
> 
> 时间：2012-05-01T22:51:42.123
> 
> 标签：java, android, http

我如何知道 url 后面的文件名（不解析 url 及其“/”）。例如：

如果您使用浏览器访问此网址：

```
http://www.ubuntu.com/start-download?distro=desktop&bits=32&release=lts 
```

它解析为**"ubuntu-12.04-desktop-i386.iso"**。如何在 java 中检索此文件名以下载具有原始名称的文件？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:57:38.067

您可以使用`HEAD`请求动词来尝试发现数据；对于这个特定的文件（并使用优秀的基于 Perl 的 HTTP 工具的 LWP 系列），您可以找到如下文件名：

```
$ HEAD -S 'http://www.ubuntu.com/start-download?distro=desktop&bits=32&release=lts'
HEAD http://www.ubuntu.com/start-download?distro=desktop&bits=32&release=lts
302 Moved Temporarily
HEAD http://ubuntu.virginmedia.com/releases//precise/ubuntu-12.04-desktop-i386.iso
200 OK
Connection: close
Date: Tue, 01 May 2012 22:54:56 GMT
Accept-Ranges: bytes
ETag: "1f83678-2bd4b000-c175d600"
Server: Apache
Content-Length: 735358976
Content-Type: application/octet-stream
Last-Modified: Mon, 23 Apr 2012 12:27:04 GMT
Client-Date: Tue, 01 May 2012 22:54:54 GMT
Client-Peer: 194.117.143.72:80
Client-Response-Num: 1 
```

标`302`头显示对象已移动，并且流提供了要检索的新 URL。大多数工具都会透明地处理此重定向，如果您正在手写 HTTP，那么您还必须处理此重定向。在这种情况下，您很幸运提供了一个名称——可能没有*文件*名，因为数据不需要来自文件。但如果你的工具的上下文相对受限，这可能不是问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T22:57:53.550

# *更有效*的方法：

您可以简单地连接到 URL，然后通过执行以下操作检索您被重定向到的 URL：

```
URL foo = new URL("http://www.ubuntu.com/start-download?distro=desktop&bits=32&release=lts");
HttpURLConnection fooConnection = (HttpURLConnection) foo.openConnection();
URL secondFoo = new URL(fooConnection.getHeaderField("Location"));
fooConnection.setInstanceFollowRedirects(false);
URLConnection fooURL = secondFoo.openConnection(); 
```

# file-upload - 自定义按钮的问题 零件

> ID：10405508
> 
> 赞同：2
> 
> 时间：2012-05-01T22:52:30.170
> 
> 标签：file-upload, richfaces

我正在做的项目目前使用的是richfaces 3.3.3。我禁用了除“添加”按钮之外的所有按钮，或者在我们的例子中，我们将其称为“浏览”并为此使用了 addControlLabel。

```
<rich:fileUpload fileUploadListener="#{fileUploadBean.listener}" maxFilesQuantity="#{fileUploadBean.uploadsAvailable}"
    addControlLabel="Browse" immediateUpload="#{fileUploadBean.autoUpload}" listHeight="0" listWidth="auto"
    allowFlash="#{fileUploadBean.useFlash}" styleClass="float-left">
    <a4j:support event="onuploadcomplete" reRender="mainMsgPanel,upload,homeTable,errorPanelImage,panelErrorMessage,imageSuccessMessage"  />
    <a4j:support event="onsizerejected" reRender="mainMsgPanel,upload,homeTable,uploadMessage,panelErrorMessage,imageSuccessMessage,errorPanelImage"
        action="#{fileUploadBean.uploadRejected}" />
</rich:fileUpload> 
```

选择文件并在“文件上传”对话框窗口中按下“打开”按钮后，文件将自动上传所选文件。问题是，一旦按下“打开”按钮，按钮的图像就会被按下，几乎是按钮本身的整个高度，但是“浏览”文本被推到右侧并且文本的颜色会发生变化从白色到黑色。

我有截图，但我还不能在这里发布，所以，这里有指向我的公共 Dropbox 的链接，其中包含每张图片。

在上传任何文件之前，此屏幕截图应该是这样的：http: [//dl.dropbox.com/u/74251265/fileupload-start.jpg](http://dl.dropbox.com/u/74251265/fileupload-start.jpg)

此屏幕截图是在“文件上传”对话框窗口中选择文件并按下“打开”按钮后的样子：http: [//dl.dropbox.com/u/74251265/fileupload-during.jpg](http://dl.dropbox.com/u/74251265/fileupload-during.jpg)

完成上传后，UI 会回到正确的布局，如第一个屏幕截图所示。

这是我的按钮 CSS 和渲染组件时生成的大多数 RichFaces 类：

```
.rich-fileupload-toolbar-decor {
    border: none;
}

.rich-fileupload-list-decor {
    border: none;
}

.rich-fileupload-button-border {
    border: none;
    margin: 0;
    width: 100%;
}

.rich-fileupload-button-press,
.rich-fileupload-ico-add {
    background-image: none;
    padding: 2px 0 0 0;
}

.rich-fileupload-ico-start,
.rich-fileupload-ico-stop,
.rich-fileupload-ico-clear {
    display: none;
    background-image: none;
}

.rich-fileupload-ico {
    padding: 2px 0 0 0;
    background-image: none;
}

.rich-fileupload-button,
.rich-fileupload-button-light,
.rich-fileupload-button-press {
    border: none;
    position: relative;
    color: white;
    text-decoration: none;
    padding: 0;
    width: 93px;
    height: 24px;
    cursor: pointer;
    background-image: none;
    background: url("/img/layout/button_browe-blue-93x24.png") no-repeat;
}

.rich-fileupload-button-content {
    padding: 4px 0;
    text-align: center;
    text-shadow: 1px 1px #000;
} 
```

我不知道可能导致这种情况发生的原因。有没有人有任何想法，意见，建议？任何事情都会有所帮助。谢谢

# python - 通过 Python 子进程模块在 shell 中管道

> ID：10405515
> 
> 赞同：8
> 
> 时间：2012-05-01T22:53:29.067
> 
> 标签：python, shell, subprocess, pipe

所以我试图查询给定机器上前 3 个 CPU “密集型”进程，我发现这个 shell 命令可以做到这一点：`ps -eo pcpu,pid,user,args | sort -k 1 -r | head -3`

我想在 Python 脚本中使用这些数据，所以我需要能够通过`subprocess`模块捕获上述命令的输出。以下工作，但只返回一个巨大的字符串，因为我没有将它限制在前 3 位：

`psResult = subprocess.check_output(['ps', '-eo', 'pcpu,user,args'])`

我不太确定这是如何`subprocess.check_output`工作的..我尝试了一次微不足道的尝试：

`subprocess.check_output(['ps', '-eo', 'pcpu,user,args', '|', 'sort', '-k', '1', '-r', '|', 'head', '-3'])`

这给了我一个错误：`ps: illegal argument: |`

如何`|`在 Python 中使用管道符号，或使用其他方式进行排序，而无需对返回的巨大字符串进行大量解析`psResult = subprocess.check_output(['ps', '-eo', 'pcpu,user,args'])`？

谢谢！问候，-kstruct

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-01T22:59:26.147

您可以传递`shell=True`参数来执行普通的 shell 命令：

```
import subprocess
subprocess.check_output('ps -eo pcpu,pid,user,args | sort -k 1 -r | head -3',
                        shell=True) 
```

或者，使用 ps 的排序选项和 Python 的内置字符串函数，如下所示：

```
raw = subprocess.check_output('ps -eo pcpu,pid,user,args --sort -pcpu')
first_three_lines = list(raw.split('\n'))[:3] 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-26T22:29:40.180

其他一些人建议使用`shell=True`，如果您将受信任的输入传递给 shell ，[这个答案很好。](https://stackoverflow.com/a/10405562/577088)但是，`shell=True`引入了一些不安全感。为了安全起见，[文档](http://docs.python.org/2/library/subprocess.html#replacing-shell-pipeline)建议以下内容：

```
output=`dmesg | grep hda`
# becomes
p1 = Popen(["dmesg"], stdout=PIPE)
p2 = Popen(["grep", "hda"], stdin=p1.stdout, stdout=PIPE)
p1.stdout.close()  # Allow p1 to receive a SIGPIPE if p2 exits.
output = p2.communicate()[0] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T22:58:37.567

如果您使用它应该可以工作：

```
subprocess.check_output("ps -eo pcpu,pid,user,args | sort -k 1 -r | head -3", shell=True) 
```

然后使用 完全像这样运行命令`/bin/sh`，因此管道将起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-03T20:19:04.510

为什么要使用外部命令？使用[psutil](http://code.google.com/p/psutil/wiki/Documentation)：

```
import psutil
def cpu_percentage(proc):
    try:
        return proc.get_cpu_percent()
    except psutil.AccessDenied:
        return float('-inf')

top3 = sorted(psutil.process_iter(), key=cpu_percentage, reverse=True)[:3]
for proc in top3:
    # do whatever 
```

# javascript - jQuery - jQuery自动完成选择事件后文本字段值更改

> ID：10405521
> 
> 赞同：3
> 
> 时间：2012-05-01T22:54:21.810
> 
> 标签：javascript, jquery

jquery 自动完成选择事件后的简单文本字段更改。我想拆分数据并将其显示在其他文本字段中。我正在尝试这个。这根本不会改变任何值。我需要在这里改变什么？

```
$(function() {
  $("#term").autocomplete({
    source: function (request, response) {
      $.post("/users/search", request, response);
    },
    minLength: 2,
    select: function(event, ui){
        $('#div2').html(ui.item.value); #doesn't populate with new text. 
        document.getElementById('#found').value="test"; #for test
        } #doesn't populate with new text. 
          #I want selected data to go here in the 'found' element id
  });
}); 
```

红宝石/html -

```
<%= text_field_tag :found, nil, :maxlength => 11, :size => 20%>
<input id="found" maxlength="11" name="found" size="20" type="text" /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T23:06:33.047

更改此行：

```
document.getElementById('#found').value="test"; #for test 
```

到：

```
$('#found').val('test'); 
```

# php - 用 php 设置的 cookie 在浏览器关闭时被清除

> ID：10405526
> 
> 赞同：1
> 
> 时间：2012-05-01T22:55:10.440
> 
> 标签：php, cookies

使用 PHP 5.3.10 我在登录时设置了一些 cookie。但是，无论我尝试设置的浏览器、url 还是其他参数，当我关闭浏览器并返回时，cookie 总是消失了。

在 php 中：

```
setcookie( $key, $value, time()+2592000, '/' ); 
```

我已经尝试设置域、安全/http 参数，但它们似乎不会影响这一点。

我已经在 Firefox 12、Safari、Chrome 上试过这个。没有设置为在退出/重新启动时清除 cookie。

http 标头的示例：

```
Set-Cookie: authentication_key=24...b6; expires=Thu, 31-May-2012 22:49:26 GMT; path=/ 
```

当我关闭浏览器并返回完全相同的地址（http/s 或 www 没有变化）时，cookie 就消失了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:56:34.783

即使您将它们设置为不过期，浏览器或操作系统仍然可以出于多种原因删除它们，最常见的是用户设置。

# ruby-on-rails - rails 3.2.1 有 has_secure_password 方法吗？

> ID：10405527
> 
> 赞同：0
> 
> 时间：2012-05-01T22:55:15.603
> 
> 标签：ruby-on-rails, ruby

我想知道rails 3.2.1是否有方法`has_secure_password`？

我在哪里可以找到这个？谷歌给了我通用链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:57:56.957

[是](https://github.com/rails/rails/blob/v3.2.1/activemodel/lib/active_model/secure_password.rb#L34)的 https://github.com/rails/rails/blob/v3.2.1/activemodel/lib/active_model/secure_password.rb#L34

以后可以使用 api.rubyonrails.org 来查找方法。然后点击“在 Github 上显示”。然后从 Rails 的 Github 标签菜单中选择您想要的标签。

# css - 如何去除图像周围出现的边框？

> ID：10405528
> 
> 赞同：0
> 
> 时间：2012-05-01T22:55:31.767
> 
> 标签：css

我不确定这是否甚至是一个边框，但是当我在中间图像上使用 CSS Sprites 时，我正在努力找出为什么会出现在图像周围？

![在此处输入图像描述](../Images/a8c7219e175936cad6e3a6c7ebcfacb2.png)

我确实尝试设置边框 = 0

```
#twitter-big {background-position: -0px -503px; width:32px; height:32px; border:0px;}

<a href='http://twitter.com/TwitterID; ?>'><img class="sprites1" id="twitter-big"/></a> 
```

这可以以某种方式来自`a`标签吗？或者它到底是什么以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:00:08.100

它被称为轮廓而不是边框​​。您可以将锚的大纲属性设置为 none 以将其删除。

[资源](http://www.w3schools.com/cssref/pr_outline.asp)

# twitter-bootstrap - Twitter Bootstrap：模态弹出窗口不会消失

> ID：10405531
> 
> 赞同：2
> 
> 时间：2012-05-01T22:55:53.840
> 
> 标签：twitter-bootstrap, modal-dialog, fade

我使用 twitter bootstrap modal 插件有以下标记：

```
 <div class="tabbable">
        <ul class="nav nav-tabs">
            <li class="active"><a href="#tabPeople" data-toggle="tab">People</a></li>
            <li><a href="#tabRoles" data-toggle="tab">Roles</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane active fade in" id="tabPeople">
                <a data-toggle="modal" href="#modalEditPerson1">Name</a>
                <div class="modal hide fade in" id="modalEditPerson1">
                    <div class="modal-header">
                        <button class="close" data-dismiss="modal">
                            ×</button>
                        <h3>
                            Name</h3>
                    </div>
                    <div class="modal-body">
                        <p>
                            One fine body…&lt;/p>
                    </div>
                    <div class="modal-footer">
                        <a href="#" class="btn" data-dismiss="modal">Close</a> <a href="#" class="btn btn-primary">
                            Save changes</a>
                    </div>
                </div>                   
            </div>
            <div class="tab-pane fade" id="tabRoles">
                <p>
                    Role stuff here.</p>
            </div>
        </div>
    </div> 
```

这会调出一个模态，但不会像此页面上的演示那样淡化它：http: [//twitter.github.com/bootstrap/javascript.html#modals](http://twitter.github.com/bootstrap/javascript.html#modals)

**更新** 我意识到问题在于它嵌套在一个 .tabbable div 中，该 div 也使用 .fade 我已经更新了上面的 html。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-01T23:54:53.237

您可能忘记包含动画的 javascript

```
<script src="assets/js/bootstrap-transition.js"></script>
<script src="assets/js/bootstrap-modal.js"></script> 
```

transitions.js 需要首先包含在内！

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2016-03-23T12:06:49.553

首先将您的模态弹出框放在正文标记之外。在该注释之后或从 bootstrap.css 中的模态背景类中删除显示属性，如下所示

.

```
modal-backdrop {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1040;
  background-color: #000;
  /*display:none;*/
```

```
now write some jquery as i have mentioned below: 
```

```
$("#Yourid").click(function() {

  $('.modal-backdrop fade in').attr("display", "block");
});
```

# html - 边框或图像未显示在 iPhone 的水平滚动条上

> ID：10405532
> 
> 赞同：0
> 
> 时间：2012-05-01T22:56:07.240
> 
> 标签：html, css

![在此处输入图像描述](../Images/585bb6e7be9247e348e808d2f845fb66.png)

当我水平滚动页面时，顶部的 div 边框不显示。这是CSS和HTML。

也请检查所附图片。

```
.top {
    height:28px;
    padding-top:7px;
    border-bottom:5px solid #f7931d;
}

<div class="top"></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T23:27:09.960

div 宽度跟随屏幕宽度，因为里面有一些浮动对象（可能只是猜测）。

你可以做

```
.top {
  ...
  display: inline-block;
} 
```

或设置预期宽度

# haskell - 对元组列表进行排序的函数 - Haskell

> ID：10405533
> 
> 赞同：3
> 
> 时间：2012-05-01T22:56:10.610
> 
> 标签：haskell

对不起，这个简单的问题只是我对haskell非常陌生..

我正在尝试编写一个函数“order”，它将对另一个函数“frequency”产生的元组列表进行排序（频率计算列表中不同元素的数量a给出一个这样的结果，比如>频率“aabbbccc”，会将结果 [(2,a),(3,b),(3,c)]) 升序排列。我不知道怎么写。

如果我在前奏中写入 >sort（频率分数），它将对其进行排序（分数是一个等级列表，即 [“a”，“b”，“c”，“c”]。

但是当我尝试编写一个函数时..

```
results :: [a] -> [(Int, a)]
results = sort (frequency score) 
```

遗憾的是，说排序应用于太多参数是行不通的。

很抱歉这个明显的问题，并在此先感谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T23:00:41.490

你忘了让你的函数接受一个参数。

```
results :: [a] -> [(Int, a)]
results score = sort (frequency score) 
```

没有它，编译器会看到您的类型签名并推断出为了返回某种类型的东西`[a] -> [(Int, a)]`，`sort`必须采用另一个参数，但它没有。

但是，下一个问题是您无法对具有任意组件类型的元组列表进行排序。请参阅@luqui 的答案以了解如何处理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T23:01:51.730

你确定它说`sort`应用了太多参数吗？对我来说，您似乎给出了错误的类型签名。这可能很容易工作：

```
results :: (Ord a) => [a] -> [(Int, a)] 
```

（即，您不能对`[(Int, a)]`除非`a`是具有`Ord`ering 的类型的列表进行排序，也就是说您可以比较元素）。

然而，这个签名并不是真正必要的，你也可以`sortBy (\x y -> compare (fst x) (fst y))`，它有许多惯用的简洁方式，但对于新手来说，我认为最好是明确的。这种方式不需要比较`a`s，因为它只看`Int`s。

**编辑**：哦，是的，我明白为什么它会说`sort`应用了太多参数。请参阅@hammar 的答案。

# php - 显示自定义错误 404 页面时出现问题

> ID：10405539
> 
> 赞同：0
> 
> 时间：2012-05-01T22:57:12.917
> 
> 标签：php, .htaccess, http-status-code-404

我正在尝试实现自定义的 404 错误页面，但这就是我得到的

```
**The requested URL /about/hdhdhdh.php was not found on this server.
  Additionally , a 404 Not Found error was encountered while trying to use an ErrorDocument to handle the request** 
```

在我的 .htaccess 里面我有这个

```
 ErrorDocument 404 /404.php 
```

.htaccess 和 404.php 都在同一个目录中。请问可能是什么问题。

**更新**

删除 404.php 前面的初始正斜杠后。现在看起来像这样

```
 ErrorDocument 404 404.php 
```

现在，当我输入无效链接时，屏幕上会显示 404.php，同时我有一个格式正确的 404.php 页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:57:49.790

不要在 404.php 前面加上斜线

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T19:43:23.113

我通过在 404.php 前面硬编码[http://yourdomain.tld解决了这个问题。](http://yourdomain.tld)

否则它不起作用的原因是由于您的主机使用了默认的错误处理，但您的域名优先于此。所以这样做：

```
ErrorDocucument 404 http://yourdomain.tld/about/404.php 
```

然后，404.php 页面可以位于您喜欢和定义的任何位置（在此示例中位于文件夹 about。您`.htaccess`可以留在原处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T12:30:12.417

好吧，根据[手册](http://httpd.apache.org/docs/2.2/mod/core.html#errordocument)，您必须以 404.php 前面的斜杠开头，并使用从您的 webroot 开始的完整路径。

因此，如果您的*404.php*文件在您的*about*文件夹中，请使用以下命令：

```
ErrorDocument /about/404.php 
```

# qt - Qt 上的库加载错误

> ID：10405547
> 
> 赞同：0
> 
> 时间：2012-05-01T22:58:14.447
> 
> 标签：qt

我在 OSX 上启动应用程序时看到此错误

```
dyld: Library not loaded: @executable_path/../Frameworks/QtDeclarative.framework/Versions/4/QtDeclarative
  Referenced from: /test/TestApp
  Reason: Incompatible library version: TestApp requires version 4.8.0 or later, but QtDeclarative provides version 4.7.0
The program has unexpectedly finished. 
```

在项目中，我选择构建配置为 Qt 4.8.0 和 Qt 版本为 Qt 4.8.0？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T08:23:08.560

您的 QtDeclarative (Qt Quick) 库似乎不是最新的。使用 SDK 维护工具（通常位于 Qt 安装的根目录中）安装 4.8.0 版本的库。

# regex - 命令行：在“x”字符后创建换行符，加上空格

> ID：10405550
> 
> 赞同：1
> 
> 时间：2012-05-01T22:58:35.600
> 
> 标签：regex, text, command

我正在创建不同长度的文本的测试样本，其中每个样本由换行符分隔。目前我有 3mb+ 的文本文件，没有换行符，只有空格。我希望获得有关正确 reg 表达式的帮助，以确保没有换行符将单词减半。

我对使用 reg 表达式**很陌生。**但我假设对于 300 个字符长度的行，它会在以下范围内的某个地方：

```
/.{300,}\s+/&\n/g 
```

*（抱歉，我知道这不起作用！）*

* * *

**注意：**我知道有关于这个主题的类似帖子，但我相对肯定没有什么专门针对这种情况的。

* * *

**更新**：解决了！使用此命令： `perl -lpe's/\b(.{80,300})\b/\1\n/g' file`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T23:19:08.310

您确定数据中已经没有新行吗？（如果有，`.`点字符将不匹配它们）如果没有换行符，那么简单的事情可能会起作用：

```
s/\s(.{80,300})\s/$1\n/g 
```

80 下限只是一个任意选择，如果没有换行符，它很少会影响结果。如果你想要更短的线条，你可以降低 300。

**编辑**：更改`\b`为`\s`可能是更好的选择，以避免在非单词字符周围出现意外的换行符，正如@tchrist 所指出的那样。此外，OP 没有说他需要 Perl 反向引用，所以 tchrist 更改`\1`为`$1`，这对 Perl 更有意义。

# git - 我可以使用 .gitignore_global 忽略多个存储库中所有用户的文件吗？

> ID：10405552
> 
> 赞同：3
> 
> 时间：2012-05-01T22:58:39.317
> 
> 标签：git, gitignore

在我的开发团队中，我们有多个项目跨越多个 git 存储库。这些项目实际上共享一些常见的配置元素。我们最近对我们的一个共享配置文件进行了本地更改，我们都不希望将其提交到生产环境。

```
/www/
|
|-- git repo 1 (containing shared config files)
|-- git repo 2 uses files from 1
|-- git repo 3 uses files from 1
|-- git repo n uses files from 1 
```

当我们为每个 repo 设置一个`.gitignore`文件时，我遇到了`~/.gitignore_global`

既然`.gitignore_global`是 in `~/`，它的每个用户，对吧？

我应该让每个开发人员实现他们自己的 .gitignore_global 文件，还是可以将常规 .gitignore 应用于所有开发人员，以便可以在全球范围内提交？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T07:05:48.277

假设您定义了，如[`gitignore`手册页](http://schacon.github.com/git/gitignore.html)中所述，属性`core.excludesfile`：

> 放置模式的文件取决于模式的使用方式：
> 
> *   应该受版本控制并通过克隆分发到其他存储库的模式（即所有开发人员都希望忽略的文件）应该进入一个`.gitignore`文件。
> *   特定于特定存储库但不需要与其他相关存储库共享的模式（例如，存在于存储库内但特定于一个用户的工作流程的辅助文件）应该进入该`$GIT_DIR/info/exclude`文件。
> *   用户希望 git 在所有情况下都忽略的模式（例如，由用户选择的编辑器生成的备份或临时文件）通常进入**`core.excludesfile`**用户的`~/.gitconfig`.

所以是的，它是每个用户的。

That being said, for configuration files with variable content (depending on the environment), I would rather prefer version in the repository a `.gitattributes` file with a content filter driver in it.
See forinstance "[How to keep different content of one file in my local and github repository?](https://stackoverflow.com/a/6031981/6309)"

* * *

[zerocog](https://stackoverflow.com/users/1480918/zerocog) mentions [in the comments](https://stackoverflow.com/questions/10405552/can-i-use-gitignore-global-to-ignore-file-for-all-users-over-multiple-repos/10409186#comment39603974_10409186) the [tutorial yakiloo.com](http://yakiloo.com/getting-started-git/).

# c# - 十进制到字节数组并写入偏移量

> ID：10405553
> 
> 赞同：0
> 
> 时间：2012-05-01T22:58:40.827
> 
> 标签：c#, hex, bytearray, decimal, binarywriter

我想知道如何将文本框中的十进制数转换为十六进制，然后转换为字节数组，然后使用 BinaryWriter 将此数组写入我想要的偏移量。

我的 textBox11 十进制值为“101200001”，我需要将它的十六进制值“06 08 30 81”写入特定偏移量的文件中。

这就是我所拥有的，但我错过了从 textBox11.Text 到 byteArray 的转换。

```
 int index = listBox1.SelectedIndex;
    int startOffset = 0x00000008;
    int itemIDDiff = 0x00000328;

    BinaryWriter bw = new BinaryWriter(File.Open(_FileName, FileMode.Open));
    bw.BaseStream.Seek(startOffset + itemIDDiff * index, SeekOrigin.Begin);
    bw.Write( /* textBox11.Text converted to HEX then to byte array? */ );
    bw.Close(); 
```

这是我需要写入的文件的一部分：

```
00000330h: 02 00 00 00 00 00 00 00 4A 61 64 65 20 45 61 72 ; ........Jade Ear
00000340h: 72 69 6E 67 00 00 00 00 00 00 00 00 00 00 00 00 ; ring............ 
```

假设我想将“02 00 00 00”更改为“06 08 30 81”。我将如何使用 BinaryWriter 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T23:06:35.820

您不能将十进制转换为十六进制（您将如何处理小数部分？）。但是您可以使用`Int64`(a `long`) 代替：

```
var text = "101200001";
var asLong = Convert.ToInt64(text);
var asHex = asDecimal.ToString("X"); 
```

`asHex`现在有你要的十六进制字符串。

**但是**您遇到的问题是“十六进制”实际上只是一种查看磁盘上一组原始字节的方式。数字以原始字节表示的方式取决于程序本身。如果你有一个二进制写入器，你只需要知道你试图写入的数字的字节表示。这本身可能就足够了（无需转换为字符串）：

```
bw.Write(asLong); 
```

* * *

再看这个，似乎你在寻找 4 字节的数字，所以 ints 不是 longs。**很好，但是它以与您可能**想要`BitConverter`的相反的顺序写入所有内容。因此，请记住这些并查看以下内容：

 **```
var text = "101200001";
var asInt = Convert.ToInt32(text);                    // 4 byte number
var asBytes = BitConverter.GetBytes(asInt).Reverse(); // same hex representation as a byte array (same order) 
```

所以在你的例子中添加这个：

```
bw.Write(asBytes); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T23:19:23.297

目前尚不清楚是否需要小端或大端。小端很简单：

```
bw.Write(int.Parse(textBox11.Text)); 
```

对于问题中建议但不寻常的大端序，您必须颠倒字节顺序：

```
var bytes = BitConverter.GetBytes(int.Parse(textBox11.Text));
Array.Reverse(bytes);
bw.Write(bytes); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T23:10:51.693

您*可以*将数字转换为十六进制表示，然后对其进行解析，但这完全没有意义。

您使用该`Int32.Parse`方法将字符串解析为一个数字，然后`BitConverter.GetBytes`将该数字作为字节数组获取：

```
byte[] data = BitConverter.GetBytes(Int32.Parse(textBox11.Text)); 
```

然后将字节写入流：

```
bw.Write(data, 0, data.Length); 
```

请注意，这会将字节写入`81, 30, 08 06`具有小端数字表示的系统上的流，例如基于 Intel（或兼容）CPU 的计算机。如果您想要文件中的大端表示，则必须在写入之前反转数组：

```
Array.Reverse(data); 
```**

# java - 跳过 Apache POI 中的空白 Excel 单元格

> ID：10405557
> 
> 赞同：4
> 
> 时间：2012-05-01T22:59:12.090
> 
> 标签：java, apache-poi

我是 Apache POI 的新手，但我想做的是通过 Excel 文件 (.xls) 读取并将其放入 ArrayList 中进行存储，以便以后进行操作。我可以得到整张纸，但我的问题是：我得到了整张纸（~54183 行）。

我想跳过类型为 3 的空白单元格。出于某种原因，当我 system.out.print ArrayList 时，其中包含所有空白单元格。

有没有办法跳过这些而不将它们添加到我要创建的 ArrayList 中？

我有以下代码：

```
public ArrayList readExcelFile(String filePath) throws IOException {
    ArrayList cellVectorHolder = new ArrayList();
    try {
        FileInputStream inputFile = new FileInputStream(filePath);
        POIFSFileSystem myFileSystem = new POIFSFileSystem(inputFile);
        HSSFWorkbook wkbk = new HSSFWorkbook(myFileSystem);
        wb = wkbk;
        for (int i = 0; i < wb.getNumberOfSheets(); i++) {
            HSSFSheet wkSheet = wkbk.getSheetAt(i);
            for (Row row : wkSheet) {
                ArrayList cellVector = new ArrayList();
                for (Cell cell : row) {
                    if(cell.getCellType() != 3){
                        cellVector.add(cell);
                    }
                }
                cellVectorHolder.add(cellVector);
            }
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
    return cellVectorHolder;
} 
```

不要介意 ArrayList 的名称……我一直在使用 Vectors，直到我最终发现它们自 1.2 或类似的东西以来就已经贬值了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T23:26:19.440

在将单元格添加到列表之前，您可以检查单元格值。就像是：

```
if (cell.getStringCellValue() != null &&  cell.getStringCellValue().length() != 0) {   
    cellVector.add(cell); 
} 
```

如果有一些内容，您只添加单元格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T23:31:54.450

我认为你应该遍历行和单元格，这样 POI 甚至不会给你空单元格。

签出`HSSFSheet.iterator()`遍历工作表中所有行的。然后`Row.cellIterator()`遍历该行中的单元格。

你基本上完成了。

如果您打算保留旧的结果变量，那么您的两个内部循环将变为：

```
for (Iterator<Row> rit = wkSheet.iterator();rit.hasNext();) {
    ArrayList cellVector = new ArrayList();
    for(Iterator<Cell> cit = rit.next().cellIterator(); cit.hasNext(); ) { 
            cellVector.add(cit.next());
    }
    cellVectorHolder.add(cellVector);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-10-20T19:30:08.043

```
Try the following code with excel as 
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
public class excelDataReader {
public static void main(String[] args) {
    List<Info> infoList = extractInfo();
    for (Info info : infoList) {
        System.out.println(info);
    }
}
public static List<Info> extractInfo() {
    List<Info> infoList = new ArrayList<Info>();
    Workbook wb = null;
    try {
        wb = new XSSFWorkbook(new FileInputStream(new         
 File("C:\\Users\\rrr\\Downloads\\contacts.xlsx")));
        Sheet sheet = wb.getSheetAt(0);
        boolean skipHeader = true;
        for (Row row : sheet) {
            if (skipHeader) {
                skipHeader = false;
                continue;
            }
            List<Cell> cells = new ArrayList<Cell>();
            int lastColumn = Math.max(row.getLastCellNum(), 5);// because my
                                                                // excel
                                                                // sheet has
                                                                // max 5
                                                                // columns,
                                                                // in case
                                                                // last
                                                                // column is
                                                                // empty
                                                                // then
                                                                // row.getLastCellNum()
                                                                // will
                                                                // return 4
            for (int cn = 0; cn < lastColumn; cn++) {
                Cell c = row.getCell(cn, Row.RETURN_BLANK_AS_NULL);
                cells.add(c);
            }
            Info info = extractInfoFromCell(cells);
            infoList.add(info);
        }
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        if (wb != null) {
            try {
                wb.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
    return infoList;
}
private static Info extractInfoFromCell(List<Cell> cells) {
    Info info = new Info();
    Cell nameCell = cells.get(0);
    if (nameCell != null) {
        nameCell.setCellType(Cell.CELL_TYPE_STRING);
        info.setName(nameCell.getStringCellValue());
    }
    Cell mobileCell = cells.get(1);
    if (mobileCell != null) {
        mobileCell.setCellType(Cell.CELL_TYPE_STRING);
        info.setMobile(mobileCell.getStringCellValue());
    }
    Cell phoneCell = cells.get(2);
    if (phoneCell != null) {
        phoneCell.setCellType(Cell.CELL_TYPE_STRING);
        info.setPhone(phoneCell.getStringCellValue());
    }
    Cell permAddressCell = cells.get(3);
    if (permAddressCell != null) {
        permAddressCell.setCellType(Cell.CELL_TYPE_STRING);
        info.setPermAddress(permAddressCell.getStringCellValue());
    }
    Cell commAddressCell = cells.get(4);
    if (commAddressCell != null) {
        commAddressCell.setCellType(Cell.CELL_TYPE_STRING);
        info.setCommAddress(commAddressCell.getStringCellValue());
    }
    return info;
} 
```

} 包 cmprocesser.cmprocesser；

```
import java.io.File; 
import java.io.FileInputStream;  
import java.io.IOException;  
import org.apache.poi.xssf.usermodel.XSSFCell;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.List;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Comment;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;

public class Info {
    private String name;
    private String mobile;
    private String phone;
    private String permAddress;
    private String commAddress;
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getMobile() {
        return mobile;
    }
    public void setMobile(String mobile) {
        this.mobile = mobile;
    }
    public String getPhone() {
        return phone;
    }
    public void setPhone(String phone) {
        this.phone = phone;
    }
    public String getPermAddress() {
        return permAddress;
    }
    public void setPermAddress(String permAddress) {
        this.permAddress = permAddress;
    }
    public String getCommAddress() {
        return commAddress;
    }
    public void setCommAddress(String commAddress) {
        this.commAddress = commAddress;
    }
    @Override
    public String toString() {
        return "Info [Name=" + name + ", Mobile=" + mobile + ", Phone=" + phone + ", Permanent Address=" + permAddress
                + ", Communication Address=" + commAddress + "]";
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T06:57:22.900

尝试这个

```
List cellDataList = new ArrayList
HSSFWorkbook workBook = new HSSFWorkbook(fsFileSystem);
                            HSSFSheet hssfSheet = workBook.getSheetAt(0);
                            Iterator rowIterator = hssfSheet.rowIterator();

                            int lineNumber = 0;
                            while (rowIterator.hasNext())
                            {
                                HSSFRow hssfRow = (HSSFRow) rowIterator.next();

                                lineNumber++;
                                if(lineNumber==1){continue;}

                                Iterator iterator = hssfRow.cellIterator();
                                List cellTempList = new ArrayList();
                                int current = 0, next = 1;
                                while (iterator.hasNext())
                                {
                                    HSSFCell hssfCell = (HSSFCell) iterator.next();

                                    current = hssfCell.getColumnIndex();

                                    if(current<next){                                   

                                    }
                                    else{

                                        int loop = current-next;

                                        for(int k=0;k<loop+1;k++){

                                            cellTempList.add(null);
                                            next = next + 1;
                                        }
                                    }

                                    cellTempList.add(hssfCell);

                                    next = next + 1;

                                }
                                cellDataList.add(cellTempList);
                            } 
```

# c# - 页面无法正确滚动

> ID：10405560
> 
> 赞同：1
> 
> 时间：2012-05-01T22:59:24.943
> 
> 标签：c#, windows-phone-7, xaml

如果用户希望查看该声明，我正在尝试在我的 WP7 应用程序（隐私声明）中加载本地文本文件以供快速参考。我尝试了几种不同的方法来加载文本文件，这两种方法都有效，除了页面不会向下滚动，因为它应该基于默认行为。在尝试向下滚动时，页面模仿了页面功能上向上滚动的结束，因此它的行为就像已经到达页面顶部一样。

尝试 1 - 将文本文件加载到滚动查看器中

XAML

```
<Grid x:Name="ContentPanel" Grid.Row="0" Margin="12,0,12,0">
        <ScrollViewer x:Name="PrivacyStatementScrollViewer">

        </ScrollViewer>            
    </Grid> 
```

C＃

```
var resourceStream = Application.GetResourceStream(new Uri  ("Content/About/license.txt", UriKind.Relative));
        if (resourceStream != null)
        {
            StreamReader sr = new StreamReader(resourceStream.Stream);
            string x = sr.ReadToEnd();
            PrivacyStatementScrollViewer.Content = x;
        } 
```

尝试 2 - 将文本文件加载到文本块中

XAML

```
<Grid x:Name="ContentPanel" Grid.Row="0" Margin="12,0,12,0">
        <ScrollViewer x:Name="PrivacyStatementScrollViewer">
            <TextBlock x:Name="PrivacyStatementTextBlock" Margin="12,0,12,0" TextWrapping="Wrap"/>
        </ScrollViewer>            
    </Grid> 
```

C＃

```
var resourceStream = Application.GetResourceStream(new Uri("Content/About/license.txt", UriKind.Relative));
        if (resourceStream != null)
        {
            StreamReader sr = new StreamReader(resourceStream.Stream);
            string x = sr.ReadToEnd();
            PrivacyStatementTextBlock.Text = x;
        } 
```

我以前从未遇到过这样的功能，希望有人遇到同样的问题，或者对如何解决这个滚动问题有建议！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T06:35:13.217

我复制了您的第二个代码并通过修改 xaml 来工作。这是我的代码：

```
<Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
    <ScrollViewer x:Name="PrivacyStatementScrollViewer" Margin="-4,4,4,8">
        <TextBlock x:Name="PrivacyStatementTextBlock" Margin="12,0,12,0" TextWrapping="Wrap" ScrollViewer.HorizontalScrollBarVisibility="Auto"/>
    </ScrollViewer>
</Grid> 
```

如您所见，我只是将 ScrollViewer.Horizo​​ntalScrollBarVisibility 属性设置为 Auto 并且它可以完美地向下滚动。

试试看，让我们知道....

问候，

# ios - 如何更改 Core Plot 中的 y 轴增量？

> ID：10405567
> 
> 赞同：1
> 
> 时间：2012-05-01T23:00:08.017
> 
> 标签：ios, core-plot

我在我的 iOS 应用程序的 Core Plot 中为我的图表指定 y 范围

```
plotSpace.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromDouble(yAxisStart)
                                                length:CPTDecimalFromDouble(yAxisLength)]; 
```

如何更改 y 轴上每个刻度的增量？默认情况下，Core Plot 使用 0.5 我相信。

一般来说，Core Plot 的系统文档在哪里？我在 Wiki 中找不到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:37:16.970

使用默认轴标签策略（固定间隔），更改`majorIntervalLength`以调整主要刻度之间的间距。

该文档可在[Google Code](http://core-plot.googlecode.com/hg/documentation/html/iOS/index.html)上在线获取，也可作为 Core Plot 包中的 Xcode 文档集获取。文档有两个版本——一个用于 iOS，另一个用于 Mac OS X。这两个版本非常相似。差异主要与 Mac 上的 UIKit 与 AppKit 问题和绑定有关。

# xcode4 - 将值从 ModalViewController 传递到主机 ViewController

> ID：10405570
> 
> 赞同：1
> 
> 时间：2012-05-01T23:00:23.427
> 
> 标签：xcode4

我有一个屏幕 (Client_Info)，它调用具有三个切换按钮的模式视图控制器 (ModalClient)。一旦用户循环通过每个按钮的三个可能选择，我希望 ModalClient 屏幕将所述按钮的值发送到“主机”屏幕，即调用模式视图控制器的屏幕。除非我感到困惑，否则我相信这将以将值从一个视图控制器发送到另一个视图控制器的相同方式完成。以下是我的代码：

**模态客户端**

Client_Info *NewView = [[Client_Info alloc] initWithNibName:nil bundle:nil];

```
NewView.PropP1 = buttonD1;
NewView.PropP2 = buttonD2;
NewView.PropP3 = buttonD3;

[self dismissModalViewControllerAnimated:YES]; 
```

**Client_Info (Host)** PropP1 到 PropP3 都已在 Client_Info.h 中成为属性，并已在 Client_Info.m 文件中综合。如果需要，我可以总结代码。

提前致谢。

# uitableview - Monotouch UITableView 水平滚动

> ID：10405574
> 
> 赞同：0
> 
> 时间：2012-05-01T23:00:53.447
> 
> 标签：uitableview, xamarin.ios

我正在创建一个与 Roambi 演示应用程序中显示的“网格”非常相似的控件，该应用程序包含一个外观类似于网格的控件（或带有数据但没有编辑功能的 Excel 工作表），我认为它基于带有自定义单元格的 TableView，但我不知道如何在该表上获得水平滚动行为以查看宽度为的自定义单元格（因为它们包含代表多列数据的标签）。我不知道您是否可以帮助我开始开发此控件的最佳方法，确切地说是滚动问题（每列使用一个 tableview，或者只使用一个，包括额外的滚动视图等），谢谢进步。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-05T02:32:18.327

每列都有一个 TableView 不会很有趣，因为您必须在列之间同步滚动位置。所以我会尝试摆脱水平滚动的 TableView。但是，如果您需要确保网格即使非常宽也能正常工作，我会考虑在滚动时添加/删除/重用单元格视图，就像 TableView 本身对垂直部分所做的那样。如果您无论如何都实现了动态视图，那么将单元格放置在滚动视图中并为整个二维进行添加/删除不会有更多的努力。

# jpeg - 如何在源图像文件（如JPEG、TIFF、PSD）中写入修改后的exif？

> ID：10405576
> 
> 赞同：6
> 
> 时间：2012-05-01T23:01:12.883
> 
> 标签：jpeg, exif, libjpeg, libexif, libjpeg-turbo

我使用 libexif 来读取和修改 JPEG 文件中的 exif 元数据。我不确定如何在原始源图像文件中写入/保存修改后的内容？

有任何想法吗？？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-10-27T12:41:23.060

对于 JPEG，您可以[`libjpeg`](https://github.com/libexif/exif/tree/master/libjpeg)从`libexif/exif`repo 中使用。

# java - 即使 X 应该匹配 T，也无法将 X 转换为 T？

> ID：10405583
> 
> 赞同：4
> 
> 时间：2012-05-01T23:02:11.163
> 
> 标签：java, generics

我通常是 C# 开发人员，刚接触 Java，我正在尝试使用泛型设置一些代码。我的演示代码如下所示：

```
// Main.java
public static void main(String[] args) {
    MyBase my = getMeStuff();
    System.out.println(my.getSomething());
}

private static <T extends MyBase> T getMeStuff(){
     return new MyDerived(123);
}

// MyBase/MyDerived.java
public class MyBase {
    private final int something;

    protected MyBase(int something) { this.something = something; }

    public int getSomething() { return something; }
}

public class MyDerived extends MyBase {
    public MyDerived(int something) { super(something); }
} 
```

这无法编译：

```
Exception in thread "main" java.lang.Error: Unresolved compilation problem: 
Type mismatch: cannot convert from x.MyDerived to T

at x.Main.getMeStuff(Main.java:14)
at x.Main.main(Main.java:9) 
```

如前所述，我通常是 C# 开发人员，因此代码乍一看还不错。我可以通过更改 getMeStuff 以向 (T) 添加强制转换来“解决”这个错误，但是这种强制转换真的有必要吗？有点味道，好像忘记了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T23:07:42.050

问题是返回类型可以是从 MyBase 派生的任何内容，并且您已专门将其键入到 MyDerived，这在没有强制转换的情况下甚至在 C# 中都不起作用。调用者可以指定 SomeOtherDerived，它也派生自 MyBase，但与 MyDerived 无关。

```
public class MyBase{}
public class MyDerived extends MyBase{}
public class SomeOtherDerived extends MyBase{}
public static <T extends MyBase> T getAnything(){ return (T)new MyDerived(); }

public static void main(String[] args) {
    SomeOtherDerived instance = getAnything(); //This is legal and bad
} 
```

同样重要的是要注意，即使使用强制转换，这也是一件非常糟糕的事情，并且在使用任何未显式提供的类型调用时很容易导致运行时异常。这也违反了泛型的概念，因为它在应该是一般化的情况下确定了非常具体的类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T23:47:34.903

Java 泛型希望帮助您实现类型安全。

让我用一个平行线：让我们假设你写了`<T extends MyUIControl>`，并且在某一时刻你使用`MyButton`s 和它在其他地方使用`MyPanel`s - 这不能安全地转换。

编译器在代码中识别出这种情况。

# sql - 如何根据月份/日期执行脚本？

> ID：10405584
> 
> 赞同：0
> 
> 时间：2012-05-01T23:02:36.730
> 
> 标签：sql, tsql, datediff, getdate

好的，我觉得我应该能够做到这一点，但我搜索无济于事。

我需要根据一年中的哪一天显示两个不同的数据集之一。具体来说，如果今天是 10 月 31 日（或更早），我想提取从去年 10 月 1 日到今年年底的所有条目。如果今天是 10 月 31 日之后，我希望我的数据集显示从当年 10 月 1 日到明年年底的条目。

下面的代码创建了一个简单的“日历”表变量，用于存储特定数据集中存在的所有月份。现在我只是把它限制在当年的日期。我想用代码替换它，以允许它像我上面所说的那样运行。我想过使用 IF 语句，但我无法弄清楚如何仅与 getdate() 日期和月份进行比较。

```
DECLARE @calendar TABLE 
(       mon_name    VARCHAR(10)
    ,   mon_number  INT
    ,   yr          INT
)

INSERT INTO @calendar
SELECT      DATENAME(m,departure_date)
        ,   MONTH(departure_date)
        ,   YEAR(departure_date)
FROM        trip_mission
WHERE       departure_date          <>'1/1/1900' 
AND         YEAR(departure_date)    = YEAR(getdate())
GROUP BY    DATENAME(m,departure_date)
        ,   MONTH(departure_date)
        ,   YEAR(departure_date) 
```

问题的简化形式可能是只有在今天 <= 10 月 31 日时我才能运行一些代码。如果我可以说 <= 2012 年 10 月 31 日，那将非常容易，但我需要它是动态的，以便它会每年翻一次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:45:00.310

该查询仅过滤当年的记录，然后如果出发日期在*11 月*和*12 月，则使用 CASE 表达式将值赋值为***1** ，而对于所有其他月份，则赋值为**0 。**相同的逻辑用于分配今天的日期。然后比较两个 CASE 表达式值以获取匹配记录。

 ****如果要切换到不同的月份，例如从*10 月 31 日*到3 月*31 日*，则 CASE 表达式中的值**10**必须更改为**03**。

[**单击此处查看 SQL Fiddle 中的演示。**](http://sqlfiddle.com/#!6/7ec5f/4)

*脚本*：

```
CREATE TABLE trip_mission 
(
    departure_date  DATETIME NOT NULL
);

INSERT INTO trip_mission (departure_date) VALUES
    ('2012-04-30'),
    ('2011-01-01'),
    ('2012-01-30'),
    ('2012-04-30'),
    ('2013-01-01'),
    ('2012-11-01'),
    ('2012-12-01'),
    ('2012-11-12'),
    ('1900-01-01'),
    ('2012-10-31');

SELECT  departure_date
FROM    trip_mission tm
WHERE   YEAR(departure_date)    = YEAR(GETDATE()) 
AND     (CASE WHEN MONTH(departure_date) > 10 THEN 1 ELSE 0 END) =
        (CASE WHEN MONTH(GETDATE())      > 10 THEN 1 ELSE 0 END) 
```

*输出*：

```
DEPARTURE_DATE
-----------------------
2012-04-30 00:00:00.000
2012-01-30 00:00:00.000
2012-04-30 00:00:00.000
2012-10-31 00:00:00.000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T11:29:55.213

以下小技巧将允许您根据月份选择不同的子集：

```
WHERE departure_date >= DATEADD(
  YEAR,
  MONTH(GETDATE()) / 11 - 1,
  CAST(YEAR(GETDATE()) AS char(4)) + '1001'
) 
```

最后一个参数形成当年 10 月 1 日的日期。第二个参数控制我们是否减去 1 年。假设当前年份是 2012 年，这就是我们根据当前月份得到的结果

```
Current month  MONTH(GETDATE())  MONTH(…) / 11  MONTH(…) / 11 - 1  DATEADD(…)
-------------  ----------------  -------------  -----------------  ----------
January        1                 0              -1                 2011-10-01
February       2                 0              -1                 2011-10-01
March          3                 0              -1                 2011-10-01
April          4                 0              -1                 2011-10-01
May            5                 0              -1                 2011-10-01
June           6                 0              -1                 2011-10-01
July           7                 0              -1                 2011-10-01
August         8                 0              -1                 2011-10-01
September      9                 0              -1                 2011-10-01
October        10                0              -1                 2011-10-01
November       11                1              0                  2012-10-01
December       12                1              0                  2012-10-01 
```****

# javascript - 如何从 jQuery 选择器访问 javascript 方法

> ID：10405591
> 
> 赞同：2
> 
> 时间：2012-05-01T23:03:51.930
> 
> 标签：javascript, jquery

我有这个简单的js：

```
var innerText  = document.getElementById("TaskId").options[0].text; 
```

我想知道如何将其转换为 jQuery：

```
var innerS = $("#TaskId");
var innerText = innerS.options[0].text; 
```

这会引发错误：

```
innerS.options is undefined 
```

**编辑**

根据一些辩论，我一起进行了快速速度测试：

js：

```
var startDat = Date.now();
for (var c = 0; c < 100000; c++) {
    var com = $("#TaskId").get(0);
}
var endDat = Date.now();
alert("jQ.get(0) took " + (endDat - startDat) + "ms");

var startD = Date.now();
for (var co = 0; co < 100000; co++) {
    var com = $("#TaskId")[0];
}
var endD = Date.now();
alert("jQ[0] took " + (endD - startD) + "ms");

var startDa = Date.now();
for (var comp = 0; comp < 100000; comp++) {
    var compa = document.getElementById("TaskId");
}
var endDa = Date.now();
alert("js took " + (endDa - startDa) + "ms"); 
```

结果：

```
jQ.get(0) took 1042ms
jQ[0] took 1057ms
js took 136ms 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T23:07:37.233

一个 jQuery 对象包含一个 DOM 元素数组。如果你想直接访问 DOM 元素，有很多方法可以直接访问。例如，您可以通过以下方式直接获取第一个 DOM 元素：

```
var innerS = $("#TaskId").get(0); 
```

现在`innerS`是实际的 DOM 元素，不再是 jQuery 对象。

要获得最快的执行时间，请使用：

```
var innerS = document.getElementById("TaskId"); 
```

jQuery 可以快速编写代码，但并不总是最快的执行时间，因为 jQuery 对象会带来一些开销（构造它们、排序 DOM 元素等）。

你可以像这样得到整个 DOM 数组：

```
var optionElements = $("option").get(); 
```

当然，使用 jQuery 对象的一个​​原因是它们有一组跨浏览器的方法，在某些情况下可以很容易地只使用它们的方法而不是直接的 DOM 方法。在您的特定情况下，您可以像这样获得 innerText：

```
var text = $("#TaskId").text(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T23:14:37.863

jQuery 对象本质上只是一个 DOM 元素的包装器，因此为了访问 DOM 元素本身，您可以使用 .get(0) 或 [0]：

```
$('#TaskId').get(0).options[0].text;

// OR

$('#TaskId')[0].options[0].text; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T23:06:08.530

两种可能的解决方案：

```
var innerText = innerS[0].options[0].text; 
// Are you sure about .text? I never used it. 
```

或者

```
var innerText = $("#TaskId option:first").text(); 
```

# android - 解析 kSoap 对对象数组的响应

> ID：10405592
> 
> 赞同：1
> 
> 时间：2012-05-01T23:03:52.167
> 
> 标签：android, arraylist

我的问题是：我有一个 SoapObject。我已经成功地遍历它以找到不同的嵌套元素并将它们保存在一个对象中（我认为？）......

我的代码是这样的：

```
 if(sResult != null)
        {
            SoapObject soapresults = (SoapObject)sResult.getProperty(0);

            int count = soapresults.getPropertyCount();

            ChildStatus[] children = new ChildStatus[count];

            for (int i = 0; i < count; i++)
            {
                SoapObject kid = (SoapObject)soapresults.getProperty(i);
                ChildStatus childStatus = new ChildStatus();
                SoapObject value = (SoapObject)kid.getProperty("Value");
                SoapObject info = (SoapObject)value.getProperty("Info");

                childStatus.CheckOutPlanned = value.getPropertyAsString("CheckOutPlannedTime");
                childStatus.CurrentStatus = value.getPropertyAsString("CurrentStatus");
                childStatus.FullName = info.getPropertyAsString("FullName");
                childStatus.ID = info.getPropertyAsString("Id");
                childStatus.KindergardenID = info.getPropertyAsString("KindergardenId");
                childStatus.URL = info.getPropertyAsString("ThumbnailUrl");

                String pickUpBy = value.getPropertyAsString("PickUpBy");

                if(pickUpBy.equalsIgnoreCase("anyType{}"))
                {
                    System.out.println("Ja");
                    pickUpBy = "none";
                } else if(pickUpBy.equalsIgnoreCase("En anden forælder"))
                {
                    childStatus.PickUpWithKidID = value.getPropertyAsString("PickUpWithKidId");
                    childStatus.PickUpWithKidName = value.getPropertyAsString("PickUpWithKidName");
                }

                childStatus.PickUpBy = value.getPropertyAsString("PickUpBy");

                children[i] = childStatus;
            }

            System.out.println("Size: " + children.length); 
```

我的对象是这样的：

```
public class ChildStatus implements KvmSerializable 
{
    public String CheckOutPlanned;
    public String CurrentStatus;
    public String FullName;
    public String ID;
    public String KindergardenID;
    public String URL;
    public String PickUpBy;
    public String PickUpWithKidID;
    public String PickUpWithKidName;

    public ChildStatus(){}

    public ChildStatus(String checkOutPlanned, String currentStatus, String fullName, String id, String kindergardenID, String url, String pickUpBy, String pickUpWithKidID, String pickUpWithKidName)
    {
        CheckOutPlanned = checkOutPlanned;
        CurrentStatus = currentStatus;
        FullName = fullName;
        ID = id;
        KindergardenID = kindergardenID;
        URL = url;
        PickUpBy = pickUpBy;
        PickUpWithKidID = pickUpWithKidID;
        PickUpWithKidName = pickUpWithKidName;
    }

    public Object getProperty(int arg0) {
        // TODO Auto-generated method stub
        switch(arg0)
        {
        case 0:
            return CheckOutPlanned;
        case 1:
            return CurrentStatus;
        case 2:
            return FullName;
        case 3:
            return ID;
        case 4:
            return KindergardenID;
        case 5:
            return URL;
        case 6:
            return PickUpBy;
        case 7:
            return PickUpWithKidID;
        case 8:
            return PickUpWithKidName;
        }

        return null;
    }

    public int getPropertyCount() {
        // TODO Auto-generated method stub
        return 9;
    }

    public void getPropertyInfo(int index, Hashtable arg1, PropertyInfo info) {
        // TODO Auto-generated method stub
        switch(index)
        {
        case 0:
            info.type = PropertyInfo.STRING_CLASS;
            info.name = "CheckOutPlanned";
            break;
        case 1:
            info.type = PropertyInfo.STRING_CLASS;
            info.name = "CurrentStatus";
            break;
        case 2:
            info.type = PropertyInfo.STRING_CLASS;
            info.name = "FullName";
            break;
        case 3:
            info.type = PropertyInfo.STRING_CLASS;
            info.name = "ID";
            break;
        case 4:
            info.type = PropertyInfo.STRING_CLASS;
            info.name = "KindergardenID";
            break;
        case 5:
            info.type = PropertyInfo.STRING_CLASS;
            info.name = "URL";
            break;
        case 6:
            info.type = PropertyInfo.STRING_CLASS;
            info.name = "PickUpBy";
            break;
        case 7:
            info.type = PropertyInfo.STRING_CLASS;
            info.name = "PickUpWithKidID";
            break;
        case 8:
            info.type = PropertyInfo.STRING_CLASS;
            info.name = "PickUpWithKidName";
            break;
        default:
            break;
        }
    }

    public void setProperty(int index, Object value) {
        // TODO Auto-generated method stub
        switch(index)
        {
        case 0:
            CheckOutPlanned = value.toString();
            break;
        case 1:
            CurrentStatus = value.toString();
            break;
        case 2:
            FullName = value.toString();
            break;
        case 3:
            ID = value.toString();
            break;
        case 4:
            KindergardenID = value.toString();
            break;
        case 5:
            URL = value.toString();
            break;
        case 6:
            PickUpBy = value.toString();
            break;
        case 7:
            PickUpWithKidID = value.toString();
            break;
        case 8:
            PickUpWithKidName = value.toString();
            break;
        default:
            break;
        }
    }

} 
```

现在我如何在一个类中使用对象数组？

我在某处看到，我需要做这样的事情：

```
ArrayList<MyClass> myList = new ArrayList<MyClass>();

myList.add( new MyClass() );

myList.get( 0 ).myMethodFromMyClass(); 
```

所以在我的情况下：

```
ArrayList<ChildStatus> myChild = new ArrayList<ChildStatus>();
myChild.add( new ChildStatus() );
myChild.get(0).?? 
```

但我想我可能会在这里走错方向，因为使用 .add 听起来我正在添加一个新对象，而没有得到我在网络通话中检索到的对象......

在 iOS 中，我通常使用：

```
Status *theStatus = [statusConnection.statusArray objectAtIndex:i]; 
```

从一组对象中获取一个对象，但我对 Android 还是很陌生...

我真的很感激你能给我的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T09:56:52.517

我很难理解你真正想要做什么。

```
// Get rid of the table
REMOVE ChildStatus[] children = new ChildStatus[count]; 

// Create the ArrayList
ArrayList<ChildStatus> myChild = new ArrayList<ChildStatus>();  

for (int i = 0; i < count; i++) 
{   
    ChildStatus childStatus = new ChildStatus(); 

    ...
    HERE YOU POPULATE YOUR childStatus OBJECT WITH THE SOAPOBJECT
    ...

    // Add objects built from SOAPObject to the ArrayList
    myChild.add(childStatus);

    // The table is of no matter here 
    REMOVE children[i] = childStatus; 
} 

// Use inner methods from an element of the ArrayList (here the number of properties for the first element)
myChild.get(0).getPropertyCount() 
```

我可能被你问的问题误导了，如果这不是你想要的，对不起。

# php - 如何在 Zend Framework 中的两个模块之间重用和覆盖控制器操作

> ID：10405599
> 
> 赞同：1
> 
> 时间：2012-05-01T23:05:10.840
> 
> 标签：php, model-view-controller, zend-framework

我有一个 Zend Framework 的模块化设置，目前只有 2 个模块：

```
web
mobile 
```

设置如下：

```
applications
--modules
----**web**
------controllers
--------IndexController.php
-----------function indexAction(){.......}
-----------function pageAction(){......}
------models
--------Model.php
------views
--------scripts
----------index.phtml
----**mobile**
------controllers
--------IndexController.php
------views
--------scripts
----------index.phtml 
```

我想通过重用模块的和`IndexController`在模块中实现代码重用，并在模块中添加另一个方法，该方法仅对模块可用。有没有办法做到这一点，而无需将代码复制到模块中的模块中？`mobile``indexAction()``pageAction()``IndexController`**`web`****`paperAction()`**`**mobile**``mobile``IndexController.php``web``mobile`

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:32:15.460

根据适合您需要的方法，您可以创建一个基本控制器，每个模型的索引控制器将从该控制器扩展。在基本控制器中，定义您希望在两者之间共享的最小功能。

或者，通过让另一个模块控制器从它扩展来使其中一个模块控制器成为主控制器。

在第一个示例中，您将执行以下操作：

## 应用程序/控制器/IndexBaseController.php

```
<?php
class IndexBaseController extends Zend_Controller_Action {
    public function indexAction() {
        // shared code for both modules' indexaction here...
    }

    public function pageAction() {
        // shared code for both modules' pageaction here...
    }
} 
```

然后，从这里扩展两个模块控制器：

## 应用程序/模块/web/controllers/IndexController.php

```
<?php
require_once APPLICATION_PATH . '/controllers/IndexBaseController.php';

class Web_IndexController extends IndexBaseController {
    // other actions here, this already contains indexAction and pageAction()
} 
```

然后对`mobile/controllers/IndexController.php`.

另一种选择是使其中一个控制器（网络或移动）成为另一个扩展的控制器。有关如何执行此操作的示例，请参阅此答案[Share zend module controllers for use in another module 。](https://stackoverflow.com/questions/10075283/share-zend-module-controllers-for-use-in-another-module/10081200#10081200)它是相似的，你只需要正确的控制器文件，你就可以从它扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-10T19:25:52.910

实际上，您唯一需要的是这个（确保您在 application.ini 中设置了 controllerDirectory）：

```
<?php
class App_Controller_Action_Helper_RequestForward extends Zend_Controller_Action_Helper_Abstract
{
    /**
     * @return null
     */
    public function direct($moduleName)
    {
        //this is basically the application.ini parsed & saved in Zend Registry
        $config = Zend_Registry::get('config');

        $controllersPath = $config->resources->frontController->controllerDirectory->$moduleName;

        $dispatcher = Zend_Controller_Front::getInstance()->getDispatcher();
        return $dispatcher->setControllerDirectory($controllersPath)->dispatch($this->getRequest(), $this->getResponse());
    }
} 
```

然后在另一个模块的控制器中：

```
public function editAccountAction()
{
    return $this->_helper->RequestForward('default');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T23:33:31.217

是的，您可以随时实例化您的控制器并调用他们的方法

```
$web_ctlr=new Web_IndexController();
$web_ctlr->indexAction();
$web_ctlr->pageAction(); 
```

但问题是你在你的动作中做了什么，因为这些动作是为了准备渲染。所以我猜你最终会有多个输出，特别是如果你在控制器构造函数中进行一些 html 渲染。如果您从可重用操作中返回有效数据，那么您现在应该没问题。但是我建议您查看 zend 部分概念并确定哪一个适合您的情况

# java - 将字符串“000000001”表示为整数“000000001”

> ID：10405601
> 
> 赞同：-5
> 
> 时间：2012-05-01T23:05:21.613
> 
> 标签：java

```
String s = 000000001;
String e = 009999999; 
```

将字符串转换`000000001`为整数`000000001`。

我试着用 Integer.parseInt 做这个

```
int n = Integer.parseInt(s); 
```

我得到 n = 1，但我希望 n 应该有 000000001

```
for (int ind = Integer.valueOf(s); ind < Integer.valueOf(e); ind++)  {

  String pp = "ggg" + ind; // I want pp should be like this- ggg000000001 and it keep on increasing like   ggg000000002, then ggg000000003 and etc etc.   
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T23:09:03.180

整数`000000001` *是* `1`。我只能假设您想*显示* `1`为`000000001`. 这就是你的做法：

```
System.out.format("%09d", n); 
```

这是一个小测试：

```
public static void main(String[] args) throws Exception {
    String s = "000000001";
    int n = Integer.parseInt(s);
    System.out.format("%09d", n);
} 
```

输出：

```
000000001 
```

FYI[`System.out.format()`](http://docs.oracle.com/javase/6/docs/api/java/io/PrintStream.html#format%28java.lang.String,%20java.lang.Object...%29)是一个方便的外观`System.out.println(String.format())`，所以如果你在你的代码中需要字符串（并且不想输出它）使用：

```
String s = String.format("%09d", n); 
```

### 由于问题更新而更新：

```
String pp = String.format("ggg%09d", ind); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T23:08:51.487

您可以使用[DecimalFormat](http://docs.oracle.com/javase/1.5.0/docs/api/java/text/DecimalFormat.html)类来[执行此操作](http://docs.oracle.com/javase/tutorial/i18n/format/decimalFormat.html)：

```
DecimalFormat myFormatter = new DecimalFormat(pattern); 
String output= myFormatter.format(value); 
System.out.println(value + " " + pattern + " " + output); 
```

也看到这个问题：[在 Java 中给数字添加前导零？](https://stackoverflow.com/questions/275711/add-leading-zeroes-to-number-in-java)

# java - 在java中设置文件的附加信息

> ID：10405605
> 
> 赞同：1
> 
> 时间：2012-05-01T23:06:12.897
> 
> 标签：java, android, http

当我在 java 中下载文件时，我想保存**getDate**值

```
URL url = new URL("http://theurl.com");
URLConnection conn = url.openConnection();
conn.getDate() 
```

这样，下次需要文件时，我会检查**lastModified()** VS **getDate()**，如果文件更改，请重新下载。

我的问题是，是否有一些地方或技术可以用来保存下载时刻的 getDate() 而无需使用数据库（可能在文件中使用一些特殊位置来获取附加信息或类似信息）

注意：我不能使用文件名，因为它必须是原始文件名

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:11:59.223

好吧，听起来您确实可以从元数据存储和文件存储中受益……

但是一个技巧可能是使用`java.io.File`方法设置文件的修改时间`setLastModified`，尽管其他人也可以更改（例如通过在文件的编辑器中打开文件），这对您不利。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T23:18:44.037

[Java API for File](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/File.html)表明`setLastModified(long time)`您可以调用一个函数来设置上次修改日期。当您将文件保存在本地时，您可以将上次修改设置为下载时进行的 getDate() 调用。然后，当您下次检查时，将下载的 getDate() 与文件的 lastModified 进行比较，就像您想要的那样。

# objective-c - 我该怎么做“char *bufferData = new char[charSize];”

> ID：10405610
> 
> 赞同：1
> 
> 时间：2012-05-01T23:06:44.937
> 
> 标签：objective-c, cocoa

我需要变量 charSize。我如何在objective-c中做到这一点：

```
char *bufferData = new char[charSize]; //c++ notation 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T23:09:48.323

您使用`malloc`：

```
char *bufferData = malloc(charSize * sizeof(char)); 
```

（从技术上讲，这`sizeof(char)`不是必需的，因为 chars 总是大小为 1，但我还是喜欢包含它，这样如果我不小心做了一个没有大小的 malloc，它看起来“错误”。）

但是根据您正在做什么，您可能需要研究[NSString](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)或[NSData](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSData_Class/Reference/Reference.html)，分别用于处理文本和二进制数据的 Cocoa 类。Cocoa 框架的其余部分通常使用这些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T23:08:43.397

```
char *bufferData = malloc(charSize); 
```

我想？

# magento - Magento 类别页面未包含属性过滤器中的所有产品

> ID：10405611
> 
> 赞同：1
> 
> 时间：2012-05-01T23:07:09.490
> 
> 标签：magento, magento-1.6

我发现产品并不总是包含在顶级类别列表页面的属性过滤器中。

我有一个分层类别设置，如下所示：

```
 - bedroom
     - beds
     - wardrobes
     - storage
 - office
     - desks
     - filing
etc... 
```

每个子类别中都有多个可配置产品，例如卧室父类别中有 5 张床、2 个衣柜和 4 个储物箱。每个产品都有 2 个自定义属性（材质和颜色），这些属性设置为在分层导航中使用。因此，例如，每个可配置的床都由至少 8 种不同颜色的简单产品组成。

问题是查看卧室类别列表时，侧面的滑动导航仅显示来自两个可配置产品的值。如果我点击床子类别列表页面，滑动导航会正确填充所有五张床的所有颜色变化。此外，如果我选择其中一个过滤器，则会显示正确的产品数量，并且剩余过滤器旁边的数字也会正确显示。如果我再次清除过滤器，显示屏将返回仅显示实际产品的一小部分。

我已经检查过我的所有产品都分配到卧室类别以及床/衣柜/其他类别，它们都有库存，并且缓存和索引都已清除/重建。在分类管理页面中，我一共展示了卧室分类中的 22 个产品，那么为什么滑动导航中只显示了 2 个呢？

是否有可能导致产品不包含在父类别列表中的单独设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T15:47:15.163

这似乎是未正确配置 Cron 的结果。

我无法解释原因，但在访问之后`http://my-site.com/cron.php`，顶级类别页面上的过滤器已正确填充。因为命令行 PHP 版本只有 4.4.5，所以我使用 wget 在 crontab 中设置了一个作业来访问我的 cron 脚本。

# java - 将没有特定标准结构的 JSON 解析为 Map 或 Java 对象

> ID：10405612
> 
> 赞同：0
> 
> 时间：2012-05-01T23:07:25.997
> 
> 标签：java, json

如果我可以将 json 映射到 Java 对象，那就太好了，但是结构很奇怪，对于我要解析的所有 json，它都是不同的。例如类别和主题可以有不同。我如何将它映射到 Java 对象或任何其他建议？

`"name":"url",` `"categories":` `{` `"249":{"catID":"249","score":33.43533451973102},` `"34":{"catID":"34","score":3.0000000447034836},` `.,.,so on` `},` `"topics":{` `"DSLR":{"weight":1.6690950917579026,"noun":1},` `"illuminated":{"weight":7.6470197510265105,"noun":0},` `.` `.so on` `}}`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:18:41.690

您至少可以指望 JSON 表示对于每种类型的响应/对象映射是一致的吗？如果是这样，您可以使用 Google GSON 库，并创建一个自定义反序列化器来处理非标准 JSON 表示。这是该项目的链接：

[http://code.google.com/p/google-gson/](http://code.google.com/p/google-gson/)

以及有关如何创建自定义序列化器/反序列化器的用户指南：

[https://sites.google.com/site/gson/gson-user-guide#TOC-Custom-Serialization-and-Deserialization](https://sites.google.com/site/gson/gson-user-guide#TOC-Custom-Serialization-and-Deserialization)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:14:11.020

有一个库： org.json 。要从字符串解析 JSONObject，您可以说：

```
JSONObject jo = new JSONObject(string); 
```

但是，如果字符串表示数组而不是映射，请使用：

```
JSONArray ja = new JSONArray(string); 
```

# windows - 传递包含连字符的命令行参数

> ID：10405617
> 
> 赞同：7
> 
> 时间：2012-05-01T23:08:15.497
> 
> 标签：windows, command-line, batch-file

我正在尝试将命令行参数传递给控制台应用程序（计算机语言编译器）。

**我的问题：**我传递的参数包含一个*连*字符，它导致错误“-是意外的命令/字符”。

这是我正在使用的命令行参数（12d.exe 是应用程序/编译器）：

```
12d.exe "C:/Staff - Name/abc.4dm" 
```

似乎它将“-”视为命令而不是目录/字符串的一部分。也许我可以使用批处理文件来执行此命令行并重新格式化目录路径？你知道在 HTTP POST 中我可以使用 urlencode 来格式化 post 命令，也许我可以在批处理文件中对命令行进行编码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T08:57:51.760

似乎 12d.exe 不理解一些有效的文件名，对 12d.exe 感到羞耻。

你可以做几个动作，

1.  尝试传递**短文件名**。`-`在连字符不在字符串右侧的某些情况下，它可能会起作用。但是，您的情况并非如此，因为它可能会翻译为`STAFF-~1`或类似的东西。

    ```
    call :invoke12d "Staff - Name\abc.4dm"
    goto :eof
    :invoke12d
    12d %~s1
    goto :eof 
    ```

2.  或创建一个**junction**，一个符号链接，以使用不包含连字符的另一个名称调用目录。请参阅此[http://technet.microsoft.com/en-us/sysinternals/bb896768](http://technet.microsoft.com/en-us/sysinternals/bb896768)了解更多信息并下载简单工具。

    ```
    junction staffnam "Staff - Name"
    12d.exe "staffnam/abc.4dm" 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T13:47:42.097

您可以尝试在批处理中添加一个`^`以“转义”连字符，从而使批处理忽略它。

```
12d.exe "C:/Staff ^- Name/abc.4dm" 
```

# android - 从 samsung s2 skyrocket 2.3.5 升级到 2.3.6 时出现 java.lang.SecurityException

> ID：10405632
> 
> 赞同：1
> 
> 时间：2012-05-01T23:10:11.223
> 
> 标签：android, securityexception

嗨，我在三星 skyrocket s2 (SGH-I727) 上从 Android 版本 2.3.5 升级到 2.3.6 时在 addTab 上收到此错误。但是，我的朋友有 2.3.6 版的三星 s2 (SGH-I777)，它工作正常。模拟器工作正常。关于这个问题的任何想法？

```
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297): java.lang.SecurityException: Requesting code from com.ifs.s.activity (with uid 10179)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.app.ActivityThread.getPackageInfo(ActivityThread.java:1296)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1546)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.app.ActivityThread.startActivityNow(ActivityThread.java:1491)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:127)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.app.LocalActivityManager.startActivity(LocalActivityManager.java:339)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.widget.TabHost$IntentContentStrategy.getContentView(TabHost.java:691)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.widget.TabHost.setCurrentTab(TabHost.java:341)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.widget.TabHost.addTab(TabHost.java:226)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at com.ifs.s.view.MainTabView.populateTabs(MainTabView.java:79)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at com.ifs.s.view.MainTabView.onAttachedToWindow(MainTabView.java:73)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.view.View.dispatchAttachedToWindow(View.java:6309)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.view.ViewGroup.dispatchAttachedToWindow(ViewGroup.java:1122)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.view.ViewGroup.dispatchAttachedToWindow(ViewGroup.java:1127)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.view.ViewGroup.dispatchAttachedToWindow(ViewGroup.java:1127)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.view.ViewRoot.performTraversals(ViewRoot.java:854)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.view.ViewRoot.handleMessage(ViewRoot.java:1949)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.os.Handler.dispatchMessage(Handler.java:99)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.os.Looper.loop(Looper.java:130)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at android.app.ActivityThread.main(ActivityThread.java:3691)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at java.lang.reflect.Method.invokeNative(Native Method)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at java.lang.reflect.Method.invoke(Method.java:507)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:907)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:665)
05-01 15:24:34.625: E/com.ifs.s.view.MainTabView(21297):    at dalvik.system.NativeStart.main(Native Method)
05-01 15:24:34.665: D/CLIPBOARD(21297): Hide Clipboard dialog at Starting input: finished by someone else... ! 
```

我们将其缩小到 DefaultHttpClient() 给出的问题。下面的代码，有什么想法吗？

```
 protected HttpClient createClient() {
       return new DefaultHttpClient();
   }

    HttpClient createHttpClient() {
    try {
        KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());
        trustStore.load(null, null);

        SSLSocketFactory sf = new AllowAllSSLSocketFactory(trustStore);
        sf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);

        HttpParams params = new BasicHttpParams();
        HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);
        HttpProtocolParams.setContentCharset(params, HTTP.UTF_8);

        SchemeRegistry registry = new SchemeRegistry();
        registry.register(new Scheme(HTTP_PROTOCOL, PlainSocketFactory.getSocketFactory(), 80));
        registry.register(new Scheme(HTTPS_PROTOCOL, sf, 443));

        ClientConnectionManager ccm = new ThreadSafeClientConnManager(params, registry);

        return createClient(params, ccm);
    }
    catch (Exception e) {
        return createClient();
    }
} 
```

# r - 使用外部而不是 expand.grid

> ID：10405637
> 
> 赞同：22
> 
> 时间：2012-05-01T23:10:49.367
> 
> 标签：r

我正在寻找尽可能快的速度并留在基地做任何事情`expand.grid`。我过去曾`outer`用于类似目的来创建矢量；像这样的东西：

```
v <- outer(letters, LETTERS, paste0)
unlist(v[lower.tri(v)]) 
```

基准测试向我展示了它`outer`可以比这要快得多，`expand.grid`但是这次我想创建两列，就像`expand.grid`（2个向量的所有可能组合）但是我的方法`outer`这次没有用外部进行基准测试。

我希望采用 2 个向量并尽可能快地将每个可能的组合创建为两列（我认为这`outer`可能是路线，但对任何基本方法都持开放态度。

这是`expand.grid`方法和`outer`方法。

```
dat <- cbind(mtcars, mtcars, mtcars)

expand.grid(seq_len(nrow(dat)), seq_len(ncol(dat)))

FOO <- function(x, y) paste(x, y, sep=":")
x <- outer(seq_len(nrow(dat)), seq_len(ncol(dat)), FOO)
apply(do.call("rbind", strsplit(x, ":")), 2, as.integer) 
```

微基准测试显示`outer`速度较慢：

```
#     expr      min        lq    median        uq      max
# EXPAND.G  812.743  838.6375  894.6245  927.7505 27029.54
#    OUTER 5107.871 5198.3835 5329.4860 5605.2215 27559.08 
```

我认为我的`outer`使用速度很慢，因为我不知道如何使用`outer`来直接创建我可以`do.call('rbind'`一起使用的长度为 2 的向量。我要慢`paste`而慢的分裂。如何以比 更快的方式使用`outer`（或 中的其他方法）执行此操作？`base``expand grid`

**编辑：添加微基准测试结果。**

**

```
Unit: microseconds
      expr     min       lq  median      uq       max
1   ERNEST  34.993  39.1920  52.255  57.854 29170.705
2     JOHN  13.997  16.3300  19.130  23.329   266.872
3 ORIGINAL 352.720 372.7815 392.377 418.738 36519.952
4    TOMMY  16.330  19.5960  23.795  27.061  6217.374
5  VINCENT 377.447 400.3090 418.505 451.864 43567.334 
```

**

![在此处输入图像描述](../Images/b4f8b3ed60f7e141f70c2bac850d37f8.png)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-02T03:49:05.077

的文档`rep.int`并不完整。它不仅在最常见的情况下是最快的，因为您可以为 times 参数传递向量，就像使用`rep`. 您可以直接将它用于两个序列，比 Tommy 的时间再减少 40% 左右。

```
expand.grid.jc <- function(seq1,seq2) {
    cbind(Var1 = rep.int(seq1, length(seq2)), 
    Var2 = rep.int(seq2, rep.int(length(seq1),length(seq2))))
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-02T00:01:25.640

使用`rep.int`：

```
expand.grid.alt <- function(seq1,seq2) {
  cbind(rep.int(seq1, length(seq2)),
        c(t(matrix(rep.int(seq2, length(seq1)), nrow=length(seq2)))))
}

expand.grid.alt(seq_len(nrow(dat)), seq_len(ncol(dat))) 
```

在我的电脑上是 6 倍于`expand.grid`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-02T01:33:23.393

@ErnestA 有一个很好的解决方案，非常值得回答！

...虽然它可能会稍微快一点：

```
expand.grid.alt2 <- function(seq1,seq2) {
  cbind(Var1=rep.int(seq1, length(seq2)), Var2=rep(seq2, each=length(seq1)))
}

s1=seq_len(2000); s2=seq_len(2000)
system.time( for(i in 1:10) expand.grid.alt2(s1, s2) ) # 1.58
system.time( for(i in 1:10) expand.grid.alt(s1, s2) )  # 1.75
system.time( for(i in 1:10) expand.grid(s1, s2) )      # 2.46 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-01T23:34:58.970

您可以分别创建两列。

```
library(microbenchmark)
n <- nrow(dat)
m <- ncol(dat)
f1 <- function()   expand.grid(1:n, 1:m)
f2 <- function()   
  data.frame( 
    Var1 = as.vector(outer( 1:n, rep(1,m) )),
    Var2 = as.vector(outer( rep(1,n), 1:m ))
  )
microbenchmark( f1, f2, times=1e6 )
# Unit: nanoseconds
#   expr min  lq median  uq    max
# 1   f1  70 489    490 559 168458
# 2   f2  70 489    490 559 168597 
```

# c++ - 为什么命名空间中的某些函数可以在没有命名空间范围前缀的情况下访问？

> ID：10405638
> 
> 赞同：9
> 
> 时间：2012-05-01T23:10:50.737
> 
> 标签：c++

命名空间中的函数不应该只能通过使用命名空间范围或使用指令来访问吗？

我遇到了一个问题，即在命名空间内定义的某些函数可以在该命名空间之外访问。我相信应该有一个编译器错误，但我没有在我尝试过的三种不同编译器（VS.NET 2003、VS2010 和 GCC 4）中得到一个。

这是代码：

```
namespace N{
  typedef struct _some_type *some_type;
  struct some_struct { int x; };
  void A(void);
  void B(int);
  void C(some_type*);
  void D(some_type);
  void E(struct some_struct);
}

using N::some_type;
using N::some_struct;

void TestFunction()
{
  some_type foo;
  some_struct s;

  N::A();         //should compile (and does on VS2003, VS2010, and GCC 4.1.2)
  ::A();          //shouldn't compile (and doesn't on VS2003, VS2010, and GCC 4.1.2)
  A();            //shouldn't compile (and doesn't on VS2003, VS2010, and GCC 4.1.2)

  N::B(0);        //should compile (and does on VS2003, VS2010, and GCC 4.1.2)
  ::B(0);         //shouldn't compile (and doesn't on VS2003, VS2010, and GCC 4.1.2)
  B(0);           //shouldn't compile (and doesn't on VS2003, VS2010, and GCC 4.1.2)

  N::C(&foo);     //should compile (and does on VS2003, VS2010, and GCC 4.1.2)
  ::C(&foo);      //shouldn't compile (and doesn't on VS2003, VS2010, and GCC 4.1.2)
  C(&foo);        //shouldn't compile (but does on VS2003, VS2010, and GCC 4.1.2) -- problem!

  N::D(foo);      //should compile (and does on VS2003, VS2010, and GCC 4.1.2)
  ::D(foo);       //shouldn't compile (and doesn't on VS2003, VS2010, and GCC 4.1.2)
  D(foo);         //shouldn't compile (but does on VS2003, VS2010, and GCC 4.1.2) -- problem!

  N::E(s);        //should compile (and does on VS2003, VS2010, and GCC 4.1.2)
  ::E(s);         //shouldn't compile (and doesn't on VS2003, VS2010, and GCC 4.1.2)
  E(s);           //shouldn't compile (but does on VS2003, VS2010, and GCC 4.1.2) -- problem!
} 
```

如果不使用 N:: 前缀，任何函数都不能访问，但 C、D 和 E 出于某种未知原因。我最初认为这是一个编译器错误，但因为我在多个编译器中看到了这一点，这让我质疑发生了什么。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-01T23:20:45.737

我想你看到了[Koenig lookup](http://en.wikipedia.org/wiki/Argument-dependent_name_lookup)的效果。在您的示例中，`foo`并且`s`是在 namespace 中定义的类型`N`。您对routines `C`、`D`和`E`使用这些类型的参数的调用，因此`N`搜索命名空间以解析这些函数调用。

# python - python numpy recarray 堆叠

> ID：10405640
> 
> 赞同：0
> 
> 时间：2012-05-01T23:11:10.457
> 
> 标签：python, numpy, recarray

如何堆叠或加入 numpy recarrays 而不会出现以下错误：

```
 self.data = numpy.lib.recfunctions.stack_arrays((self.data, data))# , asrecarray=True) # works
  File "/usr/local/lib/python3.2/site-packages/numpy/lib/recfunctions.py", line 747, in stack_arrays
    (dict(newdescr)[name], descr[1]))
TypeError: Incompatible type '<U72' <> '<U56' 
```

我从 dtype=object 开始，所以我不明白为什么它会把一些东西归结为 '

# php - Yii - 从控制器动态更改规则

> ID：10405649
> 
> 赞同：7
> 
> 时间：2012-05-01T23:12:27.533
> 
> 标签：php, yii

假设我有一个可以有颜色的产品。根据产品类型，可能需要也可能不需要颜色字段。

如果总是需要颜色，我会在产品模型中包含以下内容

```
public function rules()
{
    return array(
        array('colour', 'required')
    );
} 
```

但是，我希望这取决于产品类型是动态的。

这应该在控制器中完成吗？我想在控制器中有如下内容：

```
public function actionOrder() {
    // ....
    if ($product->HasColour) {
        // set the colour validation to be required
    } else {
        // set the colour validation to be not required
    }
} 
```

解决这个问题的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-02T02:06:56.103

您可以使用场景。在模型中：

```
class Model extends CActiveRecord {
    // ....
    public function rules() {
        return array(
            array('colour', 'required', 'on' => 'hasColour')
        );
    }
    // ....
} 
```

在控制器中：

```
public function actionOrder() {
    // ....
    $model = new Product();
    if ($product->HasColour) {
        $model->setScenario('hasColour');
    }
} 
```

因此，当模型的场景是时，将验证所需的颜色`hasColour`

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-12T09:13:25.480

```
class LoginForm extends CFormModel
{
    public $username;
    public $password;
}

$form = new LoginForm();
$form->validatorList->add(
    CValidator::createValidator('required', $form, 'username, password')
); 
```

现在 $form 有两个必填字段。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-02T02:21:19.917

一种方法是使用自定义验证规则。例如，规则：

```
array('colour', 'requiredOnHasColour'), 
```

然后是同一个模型类中的验证器方法：

```
public function requiredOnHasColour($attribute, $params) {
    if ($this->hasColour && $this->$attribute == null)
        $this->addError($attribute, 'Colour is required.');
} 
```

更多信息：[创建您自己的验证规则](http://www.yiiframework.com/wiki/168/create-your-own-validation-rule/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-26T10:25:35.560

如果您想做更复杂的逻辑，那么场景可能无法满足您的需求。然后您可以覆盖方法 init 并在那里执行所有定义验证规则的逻辑，将结果添加到 $validationRules 数组。而在 rules() 方法中，您只需返回该数组。像这样的东西：

```
 class Person extends CActiveRecord
{
    public function init(){
        if( TRUE){
            $this->validationRules[] = array('first_name','required');
            $this->validationRules[] = array('last_name','required');
        }

    }

    public $validationRules = array(
        array('email', 'required'),
        array('email, email1, email2, email3', 'email', 'message'=>'Email format is invalid'),
        array('email, address, email1, email2, email3', 'length', 'max'=>255),

    );

    public function rules()
    {
        return $this->validationRules;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-20T12:28:41.877

在您的 ActiveRecord 中，您可以在任何地方添加动态验证器。例如，我覆盖父方法 setAttributes 并添加 $this->validatorList->add() 取决于 $this->type 属性中的选定值。官方文档：[https ://www.yiiframework.com/doc/api/1.1/CValidator](https://www.yiiframework.com/doc/api/1.1/CValidator)

```
public function setAttributes($values, $safeOnly = true)
{
    $result = parent::setAttributes($values, $safeOnly);

    if (self::TYPE_PHONE == $this->type) {
        $this->validatorList->add(CValidator::createValidator('required', $this, ['phone', 'phonePrefix']));
    } elseif (self::TYPE_EMAIL == $this->type) {
        $this->validatorList->add(CValidator::createValidator('required', $this, ['email']));
    }

    return $result;
} 
```

# java - 如何让惊人的 Hibernate 框架从其会话中提供一个连接对象？

> ID：10405650
> 
> 赞同：0
> 
> 时间：2012-05-01T23:12:35.623
> 
> 标签：java, hibernate, jdbc, hibernate3

Hibernate 已经弃用了 connection() ，因为他们认为这个框架太棒了，没有人会需要这个连接。不，[这与提供连接不同](https://stackoverflow.com/questions/9482731/how-to-get-jdbc-connection-from-hibernate-session)，除非您来自 Haskell。无论如何，我有一个更好的想法来摆脱休眠：一个连接包装器围绕休眠会话，因此我可以将会话作为连接传递。我听说有一种方法可以与反射建立联系。有谁知道我在哪里可以买到这样的包装纸？

```
public class SessionConnection implements Connection {

   private final Session session;
   private final Connection conn;

   public SessionConnection(Session session) {
       this.session = session;
       this.conn = getConnectionFromStupidHibernate(session);
   }

   // delegate methods go here
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T00:00:21.793

如果您使用的是 spring，只需使用与 SessionFactory 相同的 DataSource - 不要围绕 hibernate 设计您的应用程序，让 hibernate 适合您的设计

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:28:33.137

您需要一个[SessionFactory](http://www.kodejava.org/examples/245.html)和一个 ConnectionProvider - 请参阅 [Hibernate：提供连接](http://www.javalobby.org/java/forums/t18406.html)。

# apache - 目标 URL 包含查询字符串的 Apache RedirectMatch？

> ID：10405654
> 
> 赞同：1
> 
> 时间：2012-05-01T23:13:30.350
> 
> 标签：apache, mod-rewrite

我还没有找到解决方案，因为当您从带有查询字符串的文件转到另一个 URL 时，我的所有搜索和研究都指向与查询字符串相关的问题。就我而言，我只是想从常规文件夹/文件等转到带有查询字符串的 URL。

我有一个有效的 .conf 文件，其中包含我网站的各种规则。我想添加另一个看起来像这样的：

`RedirectMatch ^/webinar$ https://company.webex.com/company/onstage/g.php?t=a&d=123456`

`RedirectMatch ^/webinar/$ https://company.webex.com/company/onstage/g.php?t=a&d=123456`

我已将 URL 修改为更通用。当我输入 www.company.com/webinar 时，这会正确重定向，但是它不会转到上面的 URL。当我直接在浏览器中输入上述 URL 时，它会正常加载。

重定向将我带到通用 Webex 页面。这可能是重定向的问题，但我认为这与 RedirectMatch 如何处理此 URL 上的查询字符串有关。我不知所措。

*编辑*

我现在如何进行 3 次重定向可能存在问题。第一个是 /webinar，第二个是上面的 URL，第三个是上面的 URL 重定向到另一个页面，坦率地说，webex 可能正在处理 iframe。不是100%确定。那么第二个重定向是否会影响第三个重定向等？如果需要，我可以提供有关 webex URL 的更多细节。

**解决方案**

这里的问题是 Webex 无法处理正在发生的双重重定向。相反，我必须在 TLD 的单独文件夹中利用带有标头重定向的 PHP 页面。上面的 RedirectMatch 语法是正确的，但由于某种原因，Webex 搞砸了。

# html - 为什么我的红色背景没有显示在我的表格中？

> ID：10405655
> 
> 赞同：0
> 
> 时间：2012-05-01T23:13:43.893
> 
> 标签：html, css, twitter-bootstrap

我这里有一个模型

[http://jsfiddle.net/Q77RZ/](http://jsfiddle.net/Q77RZ/)

没有引导程序一切正常。如何覆盖引导设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T23:16:23.173

你只需要让它更具体一点：

```
table.table tbody td.red-background {
    color: black;
    background-color: red;
    font-size: 30px; 
}​ 
```

[演示在这里。](http://jsfiddle.net/minitech/Q77RZ/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T23:27:21.597

只需更改该 css 规则的重要性，使其不会被覆盖。

```
.red-background {
  color: black;
  background-color: red !important;
  font-size: 30px;
} 
```

演示：http: [//jsfiddle.net/Q77RZ/4/](http://jsfiddle.net/Q77RZ/4/)

# favicon - 网站图标应该使用什么分辨率和颜色深度？

> ID：10405657
> 
> 赞同：2
> 
> 时间：2012-05-01T23:13:49.650
> 
> 标签：favicon

这涉及 .ico 格式的图标。

我的想法是：

```
16x16x8bpp (256 colors) - Legacy support.
32x32x8bpp (256 colors) - Legacy support.
16x16x32bpp (16M colors with alpha) - Natively supported on XP and up.
32x32x32bpp (16M colors with alpha) - Natively supported on XP and up.
48x48x32bpp (16M colors with alpha) - Natively supported on XP and up. Important for Windows Vista / Windows 7 desktop icons. 
```

对于非 alpha 通道图像，如果较低的颜色深度可以正确容纳图像，我将替换为较低的深度。例如，`16x16x4bpp`（16 种颜色）可以容纳非常简单的徽标。

（特别是我将省略`256x256x32bpp`带宽问题。）

IE7 及更高版本的大多数浏览器都可以使用它吗？还有其他建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:38:45.707

是的，大多数 IE7 及更高版本的浏览器都可以使用它。你的想法似乎是正确的。使用 .ico 格式而不是 .png 格式也更有可能适用于任何版本的 IE。

# windows-phone-7 - 是否可以让移动网站作为 Windows Phone 中的原生应用程序运行？

> ID：10405660
> 
> 赞同：1
> 
> 时间：2012-05-01T23:14:05.430
> 
> 标签：windows-phone-7, single-page-application

我看到使用 iPhone 或 Android，可以将网站添加到桌面或开始屏幕，这将使该网站作为本机应用程序运行，无需浏览器框架即可打开。

是否可以使用 Windows Phone 以及如何实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T08:39:00.190

不。

您可以将网站固定到您的屏幕上，但 htis 将在 Internet Explorer 启动时打开

# c++ - 处理文件时出现奇怪的分段错误

> ID：10405661
> 
> 赞同：0
> 
> 时间：2012-05-01T23:14:10.680
> 
> 标签：c++, file-io, segmentation-fault, variable-declaration

我正在尝试解析文件，但遇到了一个奇怪的分段错误。这是我正在使用的代码：

```
#include <iostream>

using namespace std;

int main ()
{
    FILE *the_file;
    the_file = fopen("the_file.txt","r");

    if (the_file == NULL)
    {
        cout << "Error opening file.\n";
        return 1;
    }

    int position = 0;
    while (!feof(the_file))
    {
        unsigned char *byte1;
        unsigned char *byte2;
        unsigned char *byte3;
        int current_position = position;

        fread(byte1, 1, 1, the_file);
    }
} 
```

我用命令编译它

```
g++ -Wall -o parse_file parse_file.cpp 
```

如果我删除声明 current_position 的 while 循环中的行，则代码将毫无问题地运行。我还可以将该声明移到 unsigned char 指针的声明之上，代码将毫无问题地运行。为什么它与那里的声明有错误？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T23:16:48.503

`byte1`是一个未初始化的指针；您需要分配一些存储空间。

```
unsigned char *byte1 = malloc(sizeof(*byte1));

fread(&byte1, 1, 1, the_file);

...

free(byte1); 
```

或者更好的是，根本不使用指针：

```
unsigned char byte1;

fread(&byte1, 1, 1, the_file); 
```

# wpf - 显示不同的用户控件 - WPF MVVM

> ID：10405666
> 
> 赞同：0
> 
> 时间：2012-05-01T23:14:41.827
> 
> 标签：wpf, user-controls, triggers, datatemplate, itemscontrol

我创建了一个 dbml 文件，它自动创建了 Designer.cs

在 Designer.cs（MVVM 中的模型）中，数据库中有两个不同的类：ElementA 和 ElementB。

我有两个用户控件： Element_A_UserControl - 显示 ElementA 的单个实例 Element_B_UserControl - 显示 ElementB 的单个实例

还有另一个具有两个堆栈面板的用户控件。第一个堆栈面板显示 Element_A_UserControl 列表 第二个堆栈面板显示 Element_B_UserControl 列表

这是堆栈面板 #1 XAML：

```
<StackPanel>
    <ItemsControl ItemsSource="{Binding AllElements_A}">
         <ItemsControl.ItemTemplate>
                <DataTemplate>
                     <vw:Element_A_UserControl x:Name="elementA">                            
                     </vw:Element_A_UserControl>
                 </DataTemplate>
          </ItemsControl.ItemTemplate>
     </ItemsControl>
</StackPanel> 
```

这是堆栈面板#2 XAML：

```
<StackPanel>
    <ItemsControl ItemsSource="{Binding AllElements_B}">
         <ItemsControl.ItemTemplate>
                <DataTemplate>
                     <vw:Element_B_UserControl x:Name="elementB">                            
                     </vw:Element_B_UserControl>
                 </DataTemplate>
          </ItemsControl.ItemTemplate>
     </ItemsControl>
</StackPanel> 
```

到目前为止，一切正常。

我想要**一个堆栈面板**，它根据条件显示 ElementA 列表或 ElementB 列表。

注意：获取元素列表的属性不同。IE

```
ItemsSource="{Binding AllElements_A}
ItemsSource="{Binding AllElements_B} 
```

我希望我的问题足够清楚。

头晕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:44:37.980

一种方法是您可以尝试使用有条件的 DataTemplate。像这样的东西：

```
<ItemsControl.Resources>
    <DataTemplate DataType="{x:Type local:ElementAType}">
         <vw:Element_A_UserControl x:Name="elementA">                            
         </vw:Element_A_UserControl>
    </DataTemplate>

    <DataTemplate DataType="{x:Type local:ElementBType}">
         <vw:Element_B_UserControl x:Name="elementB">                            
         </vw:Element_B_UserControl>
    </DataTemplate>
</ItemsControl.Resources> 
```

然后，在您的视图模型中，创建：

```
public ObservableCollection<object> CombinedCollection {get; set;} 
```

并有条件地使用您的任何一个集合加载它。

或者，将这两个 ItemsControls 都保留在 XAML 中，并使用 和 有条件地隐藏/显示`Visibility`它们`BooleanToVisibilityConverter`。鉴于这两种选择，我可能会选择这一种，因为它在代码中更清晰，并且比上面的条件 DataTemplate 更易于维护。但是，您似乎表明您不想这样做，所以我提出了第一个选项。

# antlr - 如何解析带括号的层次结构根？

> ID：10405668
> 
> 赞同：3
> 
> 时间：2012-05-01T23:15:05.517
> 
> 标签：antlr

我正在尝试使用 ANTLR 解析值。这是我语法的相关部分：

```
root : IDENTIFIER | SELF | literal | constructor | call | indexer;

hierarchy : root (SUB^ (IDENTIFIER | call | indexer))*;

factor  : hierarchy ((MULT^ | DIV^ | MODULO^) hierarchy)*;

sum : factor ((PLUS^ | MINUS^) factor)*;

comparison  : sum (comparison_operator^ sum)*;

value   : comparison | '(' value ')'; 
```

我不会描述每个标记或规则，因为它们的名称可以很好地解释它们的作用。该语法运行良好且可以编译，允许我解析、使用`value`以下内容：

```
a.b[c(5).d[3] * e()] < e("f") 
```

![解释](../Images/3c6734f556d021072f6e02fd26db7587.png)

价值识别剩下的唯一事情就是能够有括号中的层次结构根。例如：

```
(a.b).c
(3 < d()).e
... 
```

天真地，没有太多期望，我尝试在我的`root`规则中添加以下替代方案：

```
root : ... | '(' value ')'; 
```

然而，`value`由于非 LL(*) 主义，这违反了规则：

```
rule value has non-LL(*) decision due to recursive rule invocations reachable
from alts 1,2\.  Resolve by left-factoring or using syntactic predicates or using 
backtrack=true option. 
```

![休息](../Images/dca2cdf3030e7b9e0d8646eb671c1271.png)

即使在阅读了大部分*The Definitive ANTLR Reference*之后，我仍然不明白这些错误。但是，我所理解的是，在看到括号打开时，ANTLR 无法知道它是在查看括号值的开头还是括号根的开头。

如何清楚地定义带括号的层次结构根的行为？

**编辑**：根据要求，附加规则：

```
parameter : type IDENTIFIER -> ^(PARAMETER ^(type IDENTIFIER));

constructor : NEW type PAREN_OPEN (arguments+=value (SEPARATOR arguments+=value)*)? PAREN_CLOSE -> ^(CONSTRUCTOR type ^(ARGUMENTS $arguments*)?);

call : IDENTIFIER PAREN_OPEN (values+=value (SEPARATOR values+=value)*)? PAREN_CLOSE -> ^(CALL IDENTIFIER ^(ARGUMENTS $values*)?);

indexer : IDENTIFIER INDEX_START (values+=value (SEPARATOR values+=value)*)? INDEX_END -> ^(INDEXER IDENTIFIER ^(ARGUMENTS $values*)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T06:06:06.500

`'(' value ')'`从中取出`value`并将其放入`root`：

```
root : IDENTIFIER | SELF | literal | constructor | call | indexer | '(' value ')';

...

value : comparison; 
```

现在`(a.b).c`将产生以下解析：

![在此处输入图像描述](../Images/c39565891ee4f52be9c964f024447bc8.png)

在`(3 < d()).e`：

![在此处输入图像描述](../Images/b277e80741df0dafa45d8cc1ff7c0a45.png)

当然，您可能希望省略 AST 中的括号：

```
root : IDENTIFIER | SELF | literal | constructor | call | indexer | '('! value ')'!; 
```

此外，您不需要在解析器规则中的`List`using中附加标记。`+=`以下：

```
call 
 : IDENTIFIER PAREN_OPEN (values+=value (SEPARATOR values+=value)*)? PAREN_CLOSE 
   -> ^(CALL IDENTIFIER ^(ARGUMENTS $values*)?)
 ; 
```

可以改写为：

```
call 
 : IDENTIFIER PAREN_OPEN (value (SEPARATOR value)*)? PAREN_CLOSE 
   -> ^(CALL IDENTIFIER ^(ARGUMENTS value*)?)
 ; 
```

## 编辑

您的主要问题是某些输入可以以两种（或更多！）方式解析。例如，输入`(a)`可以由`value`规则的替代 1 和 2 解析：

```
value 
 : comparison    // alternative 1
 | '(' value ')' // alternative 2
 ; 
```

运行您的解析器规则：a `comparison`(alternative 1) 可以匹配`(a)`，因为它匹配`root`规则，而规则又匹配`'(' value ')'`. 但这也是另类2的比赛！你就知道了：解析器“看到”一个输入，两个不同的解析并报告这种歧义。

# c# - 带有 ß 字符的字符串的 UrlEncoding 问题

> ID：10405671
> 
> 赞同：0
> 
> 时间：2012-05-01T23:15:28.153
> 
> 标签：c#, encoding, urlencode

我有一个必须作为 url 的一部分传递的参数。参数包含这个字符：ß

当我编码这个字符串时，我期待这个：%DF 但我得到的是：%c3%9f

这是我用来测试的一行 C#

```
 string test = HttpUtility.UrlEncode("ß"); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T23:56:59.397

这是因为 UrlEncode 的默认实现是基于 UTF8 字符编码的。实际上，这完全在您的控制范围内。

例如，下面的代码：

```
string sample = new string((char)0x0DF, 1);
string test = HttpUtility.UrlEncode(sample);
Console.WriteLine("UTF8 Ecoded: {0}", test);
test = HttpUtility.UrlEncode(sample, Encoding.GetEncoding(1252));
Console.WriteLine("1252 Ecoded: {0}", test); 
```

输出以下内容：

```
UTF8 Ecoded: %c3%9f
1252 Ecoded: %df 
```

当然，在 URI 上使用另一种编码的危险在于某些字符根本无法表示......

例如，这段代码：

```
string sample = new string((char) 312, 1);
Encoding encoding = Encoding.GetEncoding(1252);
string test = HttpUtility.UrlEncode(sample);
Console.WriteLine("UTF8 Ecoded: {0}, round-trip = {1}", test, sample == HttpUtility.UrlDecode(test));
test = HttpUtility.UrlEncode(sample, encoding);
Console.WriteLine("1252 Ecoded: {0}, round-trip = {1}", test, sample == HttpUtility.UrlDecode(test, encoding));
Console.ReadLine(); 
```

将输出以下内容：

```
UTF8 Ecoded: %c4%b8, round-trip = True
1252 Ecoded: %3f, round-trip = False 
```

您可以在后面的示例中看到编码是“%3f”，它在未编码时等于问号“？”，而不是输入字符 312 (0x138)。

简而言之，将“ß”编码为“%c3%9f”并没有错，相反，它是正确的表示。但是，如果您必须具有编码“%DF”才能使远程服务器正确解码，请使用所示的 1252 代码页。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T23:48:35.883

`ß`字符的编码方式与使用`%c3%9f`UTF-8 编码时一样。如果可能的话，这是你*应该*使用的。

如果您的目标网络服务器使用其他编码，您需要确切地知道那是什么编码。因为您想将该字符编码为`%df`可能是[Windows-1252](http://en.wikipedia.org/wiki/Windows-1252)或[Windows-1250](http://en.wikipedia.org/wiki/Windows-1250)（或可能其他）的字符。

如果您确定这是您想要做的，您可以使用（假设 Windows-1252）：

```
HttpUtility.UrlEncode("ß", Encoding.GetEncoding(1252)) 
```

# python - 内部服务器错误 - Google 应用服务器（需要属性内容）

> ID：10405675
> 
> 赞同：0
> 
> 时间：2012-05-01T23:16:12.573
> 
> 标签：python, google-app-engine, google-cloud-datastore

我不断收到内部服务器错误 - 'BadValueError: 需要属性内容。当我将 blog_table 传递给模板进行渲染时，似乎会发生这种情况。这是代码：

主要.py：

```
import os
import webapp2
import jinja2

from google.appengine.ext import db

jinja_env = jinja2.Environment(loader = jinja2.FileSystemLoader(os.path.join(os.path.dirname(__file__),'templates')), autoescape = True)

class Handler(webapp2.RequestHandler):
    def write(self,*a,**kw):
        self.response.out.write(*a,**kw)

    def render_str(self,template,**params):
        t = jinja_env.get_template(template)
        return t.render(params)

    def render(self,template,**kw):
        self.write(self.render_str(template,**kw))

class Blog(db.Model):
    subject = db.StringProperty(required = True)
    content = db.TextProperty(required = True)
    created = db.DateTimeProperty(auto_now_add = True)

class MainPage(Handler):
    def render_front(self, subject="", content="", error=""):
        blog_table = db.GqlQuery("SELECT * FROM Blog ORDER BY created DESC")
        self.render("blog.html",subject = subject,content = content,error = error,blog_table = blog_table)

    def get(self):
        self.render_front()

    def post(self):
        subject = self.request.get("subject")
        content = self.request.get("content")

        if subject and content:
            b = Blog(subject = subject, content = content)
            b.put()
            self.redirect("/")

        else:
            error = "we need both a subject and some content"
            self.render_front(subject,content,error)

app = webapp2.WSGIApplication([('/', MainPage)],debug=True) 
```

HTML：

```
<!DOCTYPE html>

<html>
    <head>
        <title>Blog</title>
    </head>
    <body>
        <h1>Blog</h1>

        <form method="post">
            <label>
                <div>Subject</div>
                <input type="text" name="subject" value="{{subject}}">
            </label>
            <label>
                <div>Content</div>
                <textarea name="content" value="{{content}}"></textarea>
            </label>
            <div class="error">{{error}}</div>
            <input type="submit">
        </form>

        <hr>
    {% for post in blog_table %}
        <div class="post">
            <div class="subject">{{post.subject}}</div>
            <pre class="content">{{post.content}}</pre>
        </div>
    {% endfor %}

    </body>
</html> 
```

要查看错误，请访问[http://udacity-cs253-a31.appspot.com/](http://udacity-cs253-a31.appspot.com/)

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T00:01:45.217

这只是一个猜测 - 最近更改了您的博客模型并添加了 Content 属性。

您的数据存储中有一些旧的 Blog 模型实例没有内容。如果您尝试加载这些，您的代码将失败。如果你加载一个带有内容的博客实例，一切都很好。

您必须通过您的数据存储并确保您的博客的所有实例都有内容。

# android - Android Layout 如何设置特定的固定布局高度

> ID：10405676
> 
> 赞同：2
> 
> 时间：2012-05-01T23:16:12.420
> 
> 标签：android

如何将布局的高度设置为特定数量的 dp。这是我的确切情况：

我有一个相对的布局。在里面我做了一个包含标题布局的内容。这个标题布局需要正好是 35dp。如何设置准确的高度。其次，我在标题内有一个垂直分隔图像视图，它有几个 1 dp 宽，并且必须正好是 15 dp 高。如何将标题内的图像视图设置为精确高度？我想我可以通过设置填充或边距来间接做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:17:37.870

你试过这个吗？

```
android:layout_height="35dp" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T23:18:00.010

通过设置高度？：

```
<include
  ...
  android:layout_height="35dp" 
```

[在此处](http://developer.android.com/reference/android/view/ViewGroup.LayoutParams.html#attr_android%3alayout_height)阅读有关包含的更多信息和[此处](http://developer.android.com/training/improving-layouts/reusing-layouts.html#Include)的基本布局参数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T23:19:25.390

将 layout_height 参数设置为 35dp

# compiler-errors - 使用 ROSE 编译器框架的 g++ 编译器错误

> ID：10405685
> 
> 赞同：0
> 
> 时间：2012-05-01T23:16:55.647
> 
> 标签：compiler-errors, g++, rose-compiler-framework

我成功编译了 Rose Compiler 框架。

但是，由于 g++ 内部头文件问题，我很难将 Rose 编译器用于 C++ 代码。我尝试在没有运气的情况下使用谷歌搜索解决方案。

我有一个非常简单的 C++ 文件`foo.cc`：

```
#include <iostream>

int main()
{

return 0;

} 
```

当我运行玫瑰编译器工具时：

```
rose_install/bin/astTraversalTest foo.cc 
```

我得到的错误是：

```
starting frontend
"/home/user/klall/tools/rose_install/include/g++_HEADERS/hdrs3/bits/c++config.h", line 1608: error: 
          expected a ";"
    using namespace__debug__attribute__ ((strong)); 
```

知道为什么我会遇到这个问题吗？是否有`#define`我必须设置或其他什么？

我对像 <\stdio.h> 这样的 C 头文件没有问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-05T00:12:25.743

关于这个问题，我相信这是由于： [http](http://www.rosecompiler.org/FAQ.html) ://www.rosecompiler.org/FAQ.html 我得到一个“可见性”错误使用 ROSE 使用 ROSE 解析代码形式为：**属性**（（可见性（“默认"))) 现在无法工作，因为我们目前支持 EDG 3.3，并且没有简单的方法来支持它。我们目前正在移植到 EDG 4.0，这个问题将得到解决。我能做些什么？如果您尝试包含 mpi.h，请尝试将 OMPI_DECLSPEC 定义为空白：“#ifndef OMPI_DECLSPEC”。这应该有助于暂时解决这个问题。

# arm - Sourcery G++（ARM 的交叉编译器）安装失败

> ID：10405688
> 
> 赞同：4
> 
> 时间：2012-05-01T23:17:25.000
> 
> 标签：arm, cross-compiling, codesourcery

我试图通过以下链接在 Ubuntu 10.04 LTS 上安装 Sourcery G++ ARM 交叉编译器 -> http://www.codesourcery.com/sgpp/lite/arm/portal/release644 我没有使用图形界面，因为我得到 java.awt 错误。在使用控制台模式安装时，我提供了程序要求的所有详细信息。（更改了默认安装位置）

安装一段时间后，我收到了这个错误：

## 无法创建文件链接

运行内部程序时发生错误。请从“/home//cross_compiler”中删除工具链。退出代码=-1

我不确定是什么原因。我以 root 用户身份重新执行了此过程，但仍然遇到相同的错误。我正在尝试将其安装在 64 位计算机上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T13:27:06.833

我认为检查您的系统要求很重要。

您可能正在运行 64 位版本的 Ubuntu。

Sourcery G++ 需要 32 位主机库。确保已安装这些。

在我看来，在 VM 中运行 32 位安装可能更容易。

如果这不可能，安装尝试目录的“卸载”目录中有安装日志。这可能会帮助您解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T23:57:50.847

您必须安装 32 位兼容性库才能安装 Sourcery CodeBench。

来自常见问题解答：“我需要做什么才能在 x86 64 位 Linux 主机系统上安装和运行 Sourcery CodeBench？” [https://sourcery.mentor.com/sgpp/lite/arm/portal/kbentry62](https://sourcery.mentor.com/sgpp/lite/arm/portal/kbentry62)

完整的常见问题解答： [https ://sourcery.mentor.com/sgpp/lite/arm/portal/target_arch?@action=faq&target_arch=arm](https://sourcery.mentor.com/sgpp/lite/arm/portal/target_arch?@action=faq&target_arch=arm)

ARM Lite 版工具有自己的邮件列表，您可以在其中提出此类问题。访问 sourcerytools.com 并使用“arm-gnu”邮件列表来解答 ARM Lite 版本的问题。

干杯!

# c++ - 将整数放入字符串

> ID：10405691
> 
> 赞同：1
> 
> 时间：2012-05-01T23:17:43.380
> 
> 标签：c++, string, integer

我试图通过分隔其数字并将它们按顺序放入大小为 3 的字符串中来将整数放入字符串中

这是我的代码：

```
char pont[4];
void convertInteger(int number){
int temp100=0;
int temp10=0;
int ascii100=0;
int ascii10=0;
if (number>=100) {
    temp100=number%100;
    ascii100=temp100;
    pont[0]=ascii100+48;
    number-=temp100*100;
    temp10=number%10;
    ascii10=temp10;
    pont[1]=ascii10+48;
    number-=temp10*10;
    pont[2]=number+48;
}
if (number>=10) {
    pont[0]=48;
    temp10=number%10;
    ascii10=temp10;
    pont[1]=ascii10+48;
    number-=temp10*10;
    pont[2]=number+48;
}
else{
    pont[0]=48;
    pont[1]=48;
    pont[2]=number+48;
}
} 
```

这是假设发生的示例：

```
number = 356

temp100 = 356%100 = 3

ascii100 = 3

pont[0]= ascii100 = 3

temp100 = 3*100 = 300

number = 365 - 300 = 56

temp10 = 56%10 = 5

ascii10 = 5

pont[1]= ascii10 = 5

temp10 = 5*10 = 50

number = 56 - 50 = 6

pont[2]=6 
```

我可能在某处出现错误而没有看到它（不知道为什么）......顺便说一句，这应该是 C++。我可能会将其与 C 语言混为一谈...在此先感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:23:34.137

可能是您现在忽略的错误：

```
 pont[2]=number+48;
}
if (number>=10) {    /* should be else if */
    pont[0]=48; 
```

但是，我想提出一种不同的方法；您*不在乎*该值是否高于`100`,`10`等，因为`0`它仍然是一个有用的值 - 如果您不介意零填充您的答案。

考虑以下数字：

```
int hundreds = (number % 1000) / 100;
int tens = (number % 100) / 10;
int units = (number % 10); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T11:31:47.487

所有内置类型都知道如何将自己表示为`std::ostream`. 它们可以被格式化以提高精度，转换为不同的表示等。

这种统一处理允许我们将内置函数写入标准输出：

```
#include <iostream>

int main()
{
    std::cout << 356 << std::endl; // outputting an integer
    return 0;
} 
```

输出：

```
356 
```

我们可以流式传输的不仅仅是`cout`. 有一个名为 的标准类`std::ostringstream`，我们可以像使用它一样使用`cout`它，但它为我们提供了一个可以转换为字符串的对象，而不是将所有内容发送到标准输出：

```
#include <sstream>
#include <iostream>

int main()
{
    std::ostringstream oss;
    oss << 356;

    std::string number = oss.str(); // convert the stream to a string

    std::cout << "Length: " << number.size() << std::endl;
    std::cout << number << std::endl; // outputting a string
    return 0;
} 
```

输出：

```
Length: 3
356 
```

# google-bigquery - 使用 BigQuery 进行日志分析

> ID：10405704
> 
> 赞同：5
> 
> 时间：2012-05-01T23:19:31.633
> 
> 标签：google-bigquery

我正在尝试使用 BigQuery 进行日志分析。具体来说，我有一个 appengine 应用程序和一个 javascript 客户端，它们会将日志数据发送到 BigQuery。在 bigquery 中，我会将完整的日志文本存储在一列中，但也会将重要字段提取到其他列中。然后我希望能够对这些列进行临时查询。

两个问题：

1) BigQuery 在这个用例中是特别好还是特别坏？2) 如何设置循环日志？即我只想存储最后 N 个日志或最后 X GB 的日志数据。我看到不支持删除。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T23:37:07.563

1.  如您所知，有一个通过 App Engine MapReduce 将 App Engine 日志数据移动到 BigQuery 的出色演示，称为 log2bq (http://code.google.com/p/log2bq/)

2.  回复：“用例”- Stack Overflow 不是判断最佳或最差的好地方，但 Google 内部使用 BigQuery 来分析非常大的日志数据。

3.  我看不到将完整日志文本存储在单个列中的优势。如果您决定必须设置循环“日志”，则可以通过创建单独的 BigQuery 表（可能每天一个）来提取每日日志转储，然后在表变旧时将其删除。有关 Table.delete 方法的更多信息，请参阅[https://developers.google.com/bigquery/docs/reference/v2/tables/delete](https://developers.google.com/bigquery/docs/reference/v2/tables/delete)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T18:36:17.120

在实现这一点之后——我们决定开源我们为它构建的框架。您可以在此处查看框架的详细信息：http: [//blog.streak.com/2012/07/export-your-google-app-engine-logs-to.html](http://blog.streak.com/2012/07/export-your-google-app-engine-logs-to.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-06T16:03:04.790

如果您希望 Google App Engine (Google Cloud) 项目的日志包含在 BigQuery 中，Google 已将此功能添加到新的 Cloud Logging 系统中。这是一项称为“日志导出”的测试版功能 [https://cloud.google.com/logging/docs/install/logs_export](https://cloud.google.com/logging/docs/install/logs_export)

他们将其总结为：

> 将您的 Google Compute Engine 日志和 Google App Engine 日志导出到 Google Cloud Storage 存储桶、Google BigQuery 数据集、Google Cloud Pub/Sub 主题或三者的任意组合。

我们在 Python GAE 项目中使用“将 App Engine 日志流式传输到 BigQuery”功能。这会将我们应用的日志直接发送到 BigQuery，因为它们正在发生，以便在 BigQuery 数据集中提供近乎实时的日志记录。

还有一个页面描述了如何使用导出的日志。 [https://cloud.google.com/logging/docs/export/using_exported_logs](https://cloud.google.com/logging/docs/export/using_exported_logs)

当我们想要查询多天（例如上周）导出到 BigQuery 的日志时，您可以使用带有`FROM`如下子句的 SQL 查询：

```
FROM
    (TABLE_DATE_RANGE(my_bq_dataset.myapplog_,
      DATE_ADD(CURRENT_TIMESTAMP(), -7, 'DAY'), CURRENT_TIMESTAMP())) 
```

# c++ - 指向私有成员函数数组的指针

> ID：10405705
> 
> 赞同：3
> 
> 时间：2012-05-01T23:19:43.117
> 
> 标签：c++, function-pointers

我正在尝试创建一个指向私有成员函数的指针数组。数组本身是私有的，所以我不明白为什么它说：

> 错误：'void Foo::foo1(int)' 是私有的

这有效：

```
class Foo {
    public:
        Foo();
        void foo1(int);
        void foo2(int);

    private:
        void (Foo::*someMethods[])(int);
        void foo3(int);

};

Foo::Foo() {}

void (Foo::*someMethods[])(int) = {&Foo::foo1, &Foo::foo2};

void Foo::foo1(int) {}
void Foo::foo2(int) {}
void Foo::foo3(int) {} 
```

这不起作用：

```
class Foo {
    public:
        Foo();

    private:
        void (Foo::*someMethods[])(int);
        void foo1(int);
        void foo2(int);
        void foo3(int);

};

Foo::Foo() {}

void (Foo::*someMethods[])(int) = {&Foo::foo1, &Foo::foo2};

void Foo::foo1(int) {}
void Foo::foo2(int) {}
void Foo::foo3(int) {} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T00:14:53.093

您的声明

```
void (Foo::*someMethods[])(int); 
```

课内`Foo`和

```
void (Foo::*someMethods[])(int) = {&Foo::foo1, &Foo::foo2}; 
```

是完全不相关的数组。后者是一个全局变量。此外，零长度数组在 C++ 中是非法的，如果您使用 gcc，请使用它进行编译，`-pedantic`它应该会给您一个警告。

如果您要访问声明的数组，`Foo`您将使用以下内容：

```
void (Foo::*(Foo::someMethods)[])(int) = {&Foo::foo1, &Foo::foo2}; 
```

但是，您只能初始化`static`类外部的成员，因此以下代码将起作用：

```
class Foo {
    public:
        Foo();

    private:
        static void (Foo::*someMethods[])(int);
        void foo3(int);
        void foo1(int);
        void foo2(int);

};

Foo::Foo() {}

void (Foo::*(Foo::someMethods)[])(int) = {&Foo::foo1, &Foo::foo2};

void Foo::foo1(int) {}
void Foo::foo2(int) {}
void Foo::foo3(int) {}

int main(){} 
```

Or your other option is to move the non-static member in the constructor as you said in the comments. But, you should add the size of the array to be conforming.

# node.js - nodejs的版本控制工具

> ID：10405707
> 
> 赞同：2
> 
> 时间：2012-05-01T23:20:07.127
> 
> 标签：node.js, versioning, maven-release-plugin, agvtool

有一些解决方案可以在不同的应用程序中增加版本号。Cocoa 应用程序有 agvtool，而 maven 有[maven-release-plugin](http://maven.apache.org/plugins/maven-release-plugin/) ，它会在发布时增加版本号。nodejs有类似的工具吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:32:33.393

我认为这样的工具似乎过于笨拙了，当您需要做的唯一事情是增加 Node.js 中的版本号时，就像这样简单：

```
sed -i 's/0.1.2/0.2.4/' package.json 
```

会更改您的 Node.js 包的版本吗？

如果您谈论的是在明确标记新版本时将部署代码的东西，我更倾向于使用[git 挂钩](http://book.git-scm.com/5_git_hooks.html)并编写脚本来检测何时创建 git 标签，然后开始部署过程。

您可以使用`pre-applypatch`钩子来检测何时创建标签以运行`sed`上面列出的脚本并`npm publish`自动为您运行，但同样，当它是一个简单的脚本时，我没有看到让重量级工具处理所有这些的意义（并且说脚本也可以用 Node.js 编写！）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-30T15:24:39.390

我认为最正确的答案是使用[`npm version`](https://docs.npmjs.com/cli/version).

例如，要增加包的主要版本：

```
npm version major 
```

这将增加你的包的主要版本，如果它是一个 git 存储库，它还将提交该更改并创建一个与该版本同名的标签。

跟进：

```
git push
git push --tags 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-21T00:51:56.707

[grunt-bump](https://github.com/vojtajina/grunt-bump)提供版本碰撞，以及 git tagging/commit/push。其他构建工具也有类似的包，例如`gulp-bump`.

类似的功能现在也可用于[`npm version`](https://docs.npmjs.com/cli/version)，但配置选项更少。

# python - Python 的垃圾收集器会损害我的应用程序吗？

> ID：10405708
> 
> 赞同：1
> 
> 时间：2012-05-01T23:20:44.160
> 
> 标签：python, multithreading, reference, garbage-collection

当我没有使用我创建的线程的引用时，它在 Python 中是否不好：`threading.Thread(target=worker_method)`？垃圾收集器是否有可能对它做任何事情，这会影响我的应用程序的稳定性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:23:02.007

无论如何，线程将继续运行，但缺点是您不再拥有线程句柄以与其通信。

一个简单的测试表明，即使线程对象超出范围，它仍然在运行：

```
from threading import Thread
from time import sleep

def t_func():
    print "Sleeping"
    sleep(5)
    print "Done Sleeping"

def test():
    t = Thread(target=t_func)
    t.start()

>>> test()
Sleeping
Done Sleeping 
```

即使您`t`在启动线程对象后立即删除它，它也会继续运行。但是您确实应该跟踪您启动的线程，以确保它们完成或监视它们是否还活着。而且，如果需要的话，可以干净地关闭它们。

# twitter-bootstrap - 如何通过 blueimp 更改 Bootstrap Image Gallery 的动画？

> ID：10405712
> 
> 赞同：5
> 
> 时间：2012-05-01T23:21:23.083
> 
> 标签：twitter-bootstrap

这个完全把我难住了。我调整了我的 css，因此通过将开始和结束位置更改为相同，常规引导模式只是淡入而不滑动：

```
.modal.fade.in {
    top: 50%;
}
.modal {
    top: 50%;
} 
```

这导致了一个很好的渐进外观。

我想为 Bootstrap Image Gallery 创建的图像库模态实现相同的效果，它扩展了 bootstrap 的 modal.js。可以在[这里](https://github.com/blueimp/Bootstrap-Image-Gallery)找到。虽然它在功能方面非常吸引人，但在一周的时间里，我使用 js 和 css 都无济于事来简化转换。对于我的生活，我无法弄清楚如何让每张图像淡入，而是在适当的位置而不是向下或滑过，这真的很让人分心。

我所能做的就是删除“淡入淡出”类以完全消除过渡。我原以为我为其他模态所做的 css 更改也将应用于画廊模态，但事实并非如此。我也浏览了 bootstrap.js 的源代码，无法弄清楚。我不是一个完整的 nube，但远非 js/css 专家，需要帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T02:32:07.493

我会从 Chrome 开发者工具或 Firebug 开始，看看为什么你的 CSS 规则被覆盖了。在带有 Chrome 的 Mac 上，当您位于要检查的元素顶部时，按住控件并单击鼠标/滚动框（这将打开一个对话框，您将在其中单击“检查元素”）。这将打开开发人员工具，该工具将以蓝色突出显示您单击的元素，在本例中为`.modal-gallery`.

我刚刚检查了这个 modal-gallery 上的源代码，并在 CSS 中注意到 bootstrap.min.css:682 中的这段代码：

```
.modal.fade.in {
   top: 50%;
} 
```

可以通过 bootstrap.responsive.css:10 中的以下代码在调整屏幕大小时覆盖：

```
modal.fade.in {
  top: auto;
} 
```

另一个建议是检查 bootstrap-image-gallery.css 文件，因为画廊`.modal-gallery`应用了一个在 Twitter Bootstrap 本身中不存在的类。

# solr - 如何在lucene中查询整数、浮点数以及如何存储（NumericComparator）？

> ID：10405715
> 
> 赞同：5
> 
> 时间：2012-05-01T23:21:37.497
> 
> 标签：solr, lucene

更大的问题是 solr 甚至能够支持这一点吗？我知道我已经看到 lucene 能够做到这一点，并且 solr 是建立在 lucene 之上的。

我在某处使用 google 看到了一个示例，但似乎无法再次找到它，并且该示例并不完整，因为我认为它没有关于我如何为 lucene 编写查询语句的查询部分。我记得看到一个 NumericField 并且有这个 NumericComparator。

基本上，我正在尝试提供索引（在 github 上）的 noSQL orm 解决方案（尽管客户端决定每个表有多少索引和分区方法，但是您将实体添加到索引中并自己删除它们，并且可以使用 namedQueries 虽然您必须得到在查询之前首先按名称索引，因为一个表可能有数百万个索引）。我想要实现的两个主要目标是它都可以与内存中的 nosql 假数据库和内存中的索引（lucene 的 RAMDirectory）一起使用，然后我想将它们切换为插入 cassandra 和 SOLR。

我基本上需要

1.  弄清楚如何存储整数、浮点数等。
2.  弄清楚当目标是字符串、浮点数、整数等时如何编写 lucene 查询。

现在，如果您需要更多详细信息，可以在 [https://github.com/deanhiller/nosqlORM/blob/master/input/javasrc/com/alvazan/orm/layer3/spi/index/找到项目的主要查询代码内存/MemoryIndexWriter.java](https://github.com/deanhiller/nosqlORM/blob/master/input/javasrc/com/alvazan/orm/layer3/spi/index/inmemory/MemoryIndexWriter.java)

在第 172 行，您可以看到我每次都添加一个新字段，但不幸的是其中一些可能是整数。

大问题：SOLR 甚至可以支持 int 与 string 吗？（如果不是，我将不得不在整数、长整数等的前面填充 0，因此所有整数的长度都相同）。

如果 SOLR 可以支持它，那么在 lucene 中最好的方法是什么，或者有一个很好的例子吗？

从 NoSqlEntityManager.getIndex(Class clazz, String indexPartitionName) 检索到的主索引接口是（虽然不确定它是否重要）.. [https://github.com/deanhiller/nosqlORM/blob/master/input/javasrc/com/alvazan/ orm/api/Index.java](https://github.com/deanhiller/nosqlORM/blob/master/input/javasrc/com/alvazan/orm/api/Index.java)

谢谢，院长

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-02T00:13:37.233

从[示例 SOLR schema.xml](http://svn.apache.org/viewvc/lucene/dev/trunk/solr/example/solr/conf/schema.xml?view=markup)文件中：

```
<!--
      Default numeric field types. For faster range queries, consider the tint/tfloat/tlong/tdouble types.
    -->
<fieldType name="int" class="solr.TrieIntField" precisionStep="0" positionIncrementGap="0"/>
<fieldType name="float" class="solr.TrieFloatField" precisionStep="0" positionIncrementGap="0"/>
<fieldType name="long" class="solr.TrieLongField" precisionStep="0" positionIncrementGap="0"/>
<fieldType name="double" class="solr.TrieDoubleField" precisionStep="0" positionIncrementGap="0"/>
<!--
     Numeric field types that index each value at various levels of precision
     to accelerate range queries when the number of values between the range
     endpoints is large. See the javadoc for NumericRangeQuery for internal
     implementation details.

     Smaller precisionStep values (specified in bits) will lead to more tokens
     indexed per value, slightly larger index size, and faster range queries.
     A precisionStep of 0 disables indexing at different precision levels.
    -->
<fieldType name="tint" class="solr.TrieIntField" precisionStep="8" positionIncrementGap="0"/>
<fieldType name="tfloat" class="solr.TrieFloatField" precisionStep="8" positionIncrementGap="0"/>
<fieldType name="tlong" class="solr.TrieLongField" precisionStep="8" positionIncrementGap="0"/>
<fieldType name="tdouble" class="solr.TrieDoubleField" precisionStep="8" positionIncrementGap="0"/> 
```

因此，如果您将字段索引为上述字段类型之一，然后通过其字段名（例如`myIntField:1234`）查询它，它将做“正确的事情”，您还可以对它进行范围搜索（`myIntField:[1200 TO 1300]`）。花车等也是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T14:27:34.663

我认为我们可以利用 org.apache.lucene.document.NumericField 类。在这个类中，我们可以调用set方法，它可以支持int、log、float和double。对于其他数据类型（例如 bool、datetime），我们可以进行特殊转换，将它们转换为 int 或 long 类型。

BTW，我看到了lucene最新的源码，涉及新的类：FloatField、IntField、LongField和DoubleField。它将包含在下一个版本中。 [http://svn.apache.org/repos/asf/lucene/dev/trunk/lucene/core/src/java/org/apache/lucene/document/](http://svn.apache.org/repos/asf/lucene/dev/trunk/lucene/core/src/java/org/apache/lucene/document/)

# python - python中的urllib2等效于ruby

> ID：10405717
> 
> 赞同：2
> 
> 时间：2012-05-01T23:22:03.170
> 
> 标签：python, ruby-on-rails, ruby

我在 python 中有一些代码可以在 python 中发送一个 http 请求，但是我试图弄清楚如何在 ruby​​ 中执行它，因为我的服务器是 rails。

```
import urllib2, sys, json

url = "http://new.openbms.org/backend/api/query"
query = "select *"
fp = urllib2.urlopen(url, data=query)
obj = json.load(fp)
json.dump(obj, sys.stdout, sort_keys=True, indent=2) 
```

这个 python 代码实际上确实返回了我所期望的，但是当我尝试在 ruby​​ 中做同样的事情时，我收到了一个错误的请求

```
require 'net/http'

query = "select *"
url = "http://new.openbms.org/backend/api/query"
uri = URI(url)
p Net::HTTP.post_form(uri, { "data" => query }) 
```

上面这张打印出来`#<Net::HTTPBadRequest 400 Bad Request readbody=true>`的。请帮忙，谢谢。

Python 版本 2.7.1 Ruby 版本 1.9.2p318

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T23:48:32.453

尽管您调用远程服务器就好像它响应 application/x-www-form-urlencoded 数据一样，但实际上它只是响应帖子正文中的命令。

在 Python 中，urllib2.urlopen 的数据参数需要一个字符串，即`application/x-www-form-urlencoded`.

`select *`可以说并不是真正的形式编码，但无论如何它都对你有用，因为服务器将其解释为`select *`以`None`值命名的查询参数，或者更准确地说，服务器看到一个帖子正文`select *`并说“我知道如何响应到那个命令”。

因此，与您正在做的事情等效的 Ruby 就在这里。

```
require 'net/http'
require 'json'

query = "select *"
url = "http://new.openbms.org/backend/api/query"
uri = URI(url)
response = Net::HTTP.post_form(uri, { query => nil })
puts JSON.parse(response.body) 
```

# ruby-on-rails - 查找给定类的文件路径

> ID：10405718
> 
> 赞同：19
> 
> 时间：2012-05-01T23:22:11.793
> 
> 标签：ruby-on-rails, ruby

我有一个给定类的 Class 对象的引用。我需要找出类的文件路径。如果有任何帮助，该类继承自 ActiveRecord。

有什么简单的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-05-02T02:58:35.153

`source_location`在其方法上使用：

```
YourClass.instance_methods(false).map { |m| 
  YourClass.instance_method(m).source_location.first
}.uniq 
```

您可能会获得多个位置，因为方法可能定义在不同的位置。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-08-11T07:38:37.713

没有办法适用于所有类定义。有一些直接的方法适用于某些情况，也有一些复杂的方法适用于其他情况。

在 Ruby 中，可以多次重新打开类和模块以进行附加定义（猴子补丁）。没有内置的类或模块的主要定义概念。也没有内置的方法来列出所有有助于类定义的文件。但是，有一种内置方法可以列出定义类中方法的文件。要找到有助于其他组件（常量、声明等）的静态定义，可以遵循已知约定（如果适用）或应用静态源代码分析。

# 1\. 检查方法位置

Ruby 方法在一个位置只有一个定义，可以通过`Method#source_location`. 类或模块的实例方法可以通过`Class#instance_methods`及其作用域（`public_`、、`protected_`和`private_`）变体列出（作为符号）。单例方法（又名类方法）可以通过`Class#singleton_methods`. 作为第一个参数传递`false`给这些方法会导致它们省略从祖先继承的方法。从这些符号之一可以得到对应的`Method`via `Class#instance_method`，然后`Method#source_location`用来获取方法的文件和行号。这适用于静态（使用`def`）或动态（使用各种方式，例如`Module#class_eval`结合`Module#define_method`）定义的方法。

例如，考虑这些定义模块`M`和类的文件`C`：

`/tmp/m.rb`

```
module M
  def self.extended(klass)
    klass.class_eval do
      define_method(:ifoo) do
        'ifoo'
      end

      define_singleton_method(:cfoo) do
        'cfoo'
      end
    end
  end

  def has_ibar
    self.class_eval do
      define_method(:ibar) do
        'ibar'
      end
    end
  end

  def has_cbar
    self.class_eval do
      define_singleton_method(:cbar) do
        'cbar'
      end
    end
  end
end 
```

`/tmp/c.rb`

```
require_relative 'm'

class C
  extend M

  has_ibar
  has_cbar

  def im
    'm'
  end

  def self.cm
    'cm'
  end
end 
```

`/tmp/c_ext.rb`

```
class C
  def iext
    'iext'
  end

  def self.cext
    'cext'
  end
end 
```

鉴于这些定义，可以检查该类并找到其源文件，如下面的 Pry 会话所示。

```
2.4.0 (main):0 > require '/tmp/c'; require '/tmp/c_ext';
2.4.0 (main):0 > instance_methods_syms = C.instance_methods(false)
=> [:im, :ifoo, :ibar, :iext]
2.4.0 (main):0 > class_methods_syms = C.singleton_methods(false)
=> [:cm, :cfoo, :cbar, :cext]
2.4.0 (main):0 > instance_methods_locs = instance_methods_syms.map { |method_sym| C.instance_method(method_sym).source_location }
=> [["/tmp/c.rb", 9], ["/tmp/m.rb", 4], ["/tmp/m.rb", 16], ["/tmp/c_ext.rb", 2]]
2.4.0 (main):0 > class_methods_locs = class_methods_syms.map { |method_sym| C.singleton_class.instance_method(method_sym).source_location }
=> [["/tmp/c.rb", 13], ["/tmp/m.rb", 8], ["/tmp/m.rb", 24], ["/tmp/c_ext.rb", 6]]
2.4.0 (main):0 > methods_locs = instance_methods_locs + class_methods_locs;
2.4.0 (main):0 > class_files = methods_locs.map(&:first).uniq
=> ["/tmp/c.rb", "/tmp/m.rb", "/tmp/c_ext.rb"] 
```

`Module#instance_methods`文档中未指定返回值的顺序，并且在 Ruby 版本之间有所不同。

## 1.1 识别主文件

在通过`Module#instance_methods`和获得的多个候选文件中识别一个类的主文件`Method#source_location`不是一个简单的问题。在一般情况下，这是不可能的。

在上面的例子中，`/tmp/c.rb`直观上是主文件，因为它是第一个`require`定义`C`. 也许这就是为什么在 Ruby 2.3.3 和 2.4.0`Module#instance_methods`中首先列出其方法的原因。但是，如上所述，该顺序是未记录的，并且在 Ruby 版本之间有所不同。`C`请注意，按执行顺序，在 中定义的第一个方法是`#ifoo`。顺便说一句，在 Ruby 1.9.3 到 2.2.6 中，第一项`instance_methods_syms`是.`:ifoo``class_files``/tmp/m.rb``C`

此外，考虑如果我们从 中删除方法定义`/tmp/c.rb`，只留下声明式调用`extend M`、`has_ibar`和会发生什么`has_cbar`。在这种情况下，`/tmp/c.rb`完全没有`class_files`。这不是一个不现实的场景。例如，在 Active Record 中，简单模型类的主要定义可能只包含验证和其他声明，而其他一切都由框架决定。通过检查类的方法位置永远不会找到这个定义。

## 1.2\. 撬动命令`show-source`

Pry 的`show-source`（aka `$`）命令使用这种方法的一种变体，将其自己的逻辑应用于方法和类定义文件的检查和排序。看看[`Pry::WrappedModule`](https://github.com/pry/pry/blob/master/lib/pry/wrapped_module.rb)，[`Pry::Method`](https://github.com/pry/pry/blob/master/lib/pry/method.rb)如果你很好奇。它在实践中工作得相当好，但是因为它依赖于`Method#source_location`，所以它无法找到没有定义方法的类定义。

# 2\. 遵循约定

此方法仅适用于根据某些明确定义的约定定义要检查的类的场景。如果您知道您正在检查的类遵循这样的约定，那么您可以使用它确定地找到它的主要定义。

即使方法定位方法失败，即当主定义不包含任何方法定义时，这种方法仍然有效。但是，它仅限于遵循明确约定的类定义。

## 2.1。约定：Rails 模型类

在一个简单的 Rails 应用程序中，应用程序的模型类在其`app/models`目录中定义，文件路径可以从类名确定派生。给定这样一个模型类`klass`，包含其主要定义的文件位于以下位置：

```
Rails.root.join('app', 'models', "#{klass.name.underscore}.rb").to_s 
```

例如，模型类`ProductWidget`将在 中定义`APP_ROOT/app/models/product_widget.rb`，其中`APP_ROOT`是应用程序的根目录路径。

为了概括这一点，必须考虑简单 Rails 配置的扩展。在为模型定义定义自定义路径的 Rails 应用程序中，必须考虑所有这些路径。此外，由于可以在应用程序加载的任何 Rails 引擎中定义任意模型类，因此还必须查看所有加载的引擎，并考虑到它们的自定义路径。以下代码结合了这些注意事项。

```
candidates = Rails.application.config.paths['app/models'].map do |model_root|
  Rails.root.join(model_root, "#{klass.name.underscore}.rb").to_s
end
candidates += Rails::Engine::Railties.engines.flat_map do |engine|
  engine.paths['app/models'].map do |model_root|
    engine.root.join(model_root, "#{klass.name.underscore}.rb").to_s
  end
end
candidates.find { |path| File.exist?(path) } 
```

这个例子特别适用于 Rails 模型，但它可以很容易地适应控制器和其他定义位置受 Rails 约定和配置约束的类。

## 2.2\. 约定：通用 Rails 自动加载解析

某些类在 Rails 应用程序中自动加载，但无法确定地识别为属于其路径已在 Rails 路径配置中注册的标准类别之一（模型、控制器等）。尽管如此，仍然可以确定性地识别包含此类的主要定义的文件。解决方案是实现[Rails 使用的通用自动加载解析算法](http://guides.rubyonrails.org/autoloading_and_reloading_constants.html#generic-procedure)。这种实现的一个例子超出了这个答案的范围。

# 3.静态源码分析

如果其他方法不适用或不充分，可以尝试使用蛮力方法：在所有加载的 Ruby 源文件中查找给定类的定义。不幸的是，这既有限又复杂。

加载的文件`Kernel#require`列在 中`$LOADED_FEATURES`，因此可以在路径数组中搜索包含类定义的 Ruby 文件。但是，使用加载的文件`Kernel#load`不一定会在任何地方列出，因此无法搜索它们。一个例外是在`config.cache_classes`为 false 时通过 Rails 自动加载机制加载的文件（开发模式下的默认值）。在这种情况下，有一个解决方法：在 Rails 自动加载路径中搜索。有效的搜索将遵循[Rails 自动加载解析算法](http://guides.rubyonrails.org/autoloading_and_reloading_constants.html#generic-procedure)，但搜索所有自动加载路径也足够了，可以通过`Rails.application.send(:_all_autoload_paths)`.

即使对于可以列出的类定义文件，识别给定类的定义也并非易事。对于使用根命名空间中的语句定义的类`class`，这很容易：找到匹配的行`/^\s*class\s+#{klass}[\s$]/`。但是，对于定义嵌套在`module`主体中的类，或者对于使用动态定义的类`Class::new`，这需要将每个文件解析为抽象语法树 (AST) 并在树中搜索此类定义。对于使用任何其他类生成器定义的类，AST 搜索需要知道该生成器。考虑到任何这样的实现都需要从磁盘读取许多文件，如果意图执行多个类定义查找，缓存所有发现的类定义将是谨慎的。任何这样的实现都超出了这个答案的范围。

对于不遵循明确约定的文件中的类定义，这种方法是最彻底的方法。但是，实现很复杂，需要读取和解析所有加载的源文件，并且从根本上仍然受到限制。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-05-01T23:35:38.470

如果您指的是 rails 模型并采用默认配置，它应该位于 app models 文件夹中，您可以获得如下路径

```
File.join Rails.root,"app","models", "#{self.class.name.to_s.underscore}.rb" 
```

# mongodb - 使用 ObjectId 而不是纯字符串有什么好处？

> ID：10405720
> 
> 赞同：12
> 
> 时间：2012-05-01T23:22:20.790
> 
> 标签：mongodb

使用 ObjectId 而不是 UUID 作为纯字符串有什么好处？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-02T01:43:50.700

ObjectId 是二进制的，因此占用的空间更少。ObjectIds 也有排序因素——它们最终会按照插入顺序（或非常接近），同时保持唯一。排序可能对某些事情有好处，但对其他事情（如分片键）则不需要。您还可以从 ObjectId 中提取时间戳（第二分辨率），这很方便。

除此之外，我想说没有太大区别。

# php - PHP中的注册页面

> ID：10405721
> 
> 赞同：0
> 
> 时间：2012-05-01T23:22:30.497
> 
> 标签：php, html, mysql, sql, registration

我正在创建一个 PHP 注册页面，但我完全不知道下一步该做什么。

每当正确验证并提交表单时，唯一更新的表是 USERS 表，它还需要更新 SecInfo 和 Shipping。

这是一项课堂作业，我正在努力解决问题。如果 mysql_query 中的一个在 3 个中起作用，我会觉得我很接近。

```
<?php
            ...                     
if($errorCount == 0){

$userSQL = "INSERT INTO Users(UserID, FName, LName, Email, Phone, Address, City, UserState, Zip) VALUES ('{$uName}', '{$fName}', '{$lName}', '{$email}', '{$phone}', '{$add}', '{$city}', '{$uState}', '{$zip}')";

$secSQL = "INSERT INTO SecInfo(UserID, Password, SQuestion, SAnswer) VALUES ('{$uName}', '{$sec_pwd}', '{$sQues}', '{$sAns}')";

$shipSQL = "INSERT INTO Shipping(ShipAdd, ShipCity, ShipState, ShipZip)VALUES ('{$shipAdd}', '{$shipCity}', '{$sState}', '{$shipZip}')";

mysql_query($userSQL);
mysql_query($secSQL);
mysql_query($shipSQL);

echo "Successfully submitted!";
}
}
}
else
echo "Form data missing for specific fields!";
}
?> 
```

问题：（如果你需要 HTML，你可以问）代码没有插入到 SecInfo 和 Shipping，因为我最后调用了 mysql_query 方法太多次了吗？

这是一个包含的项目，因为 sql_injection 不会成为问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:30:14.653

你有一个*具体*的问题吗？我很困惑你到底需要什么帮助。但我注意到你已经放弃了一些 SQL/PHP 混乱成一长串任务。我的建议是从小处着手，测试您的代码，然后仔细添加新代码并不断对其进行测试，这样您将了解错误*所在*，以及为什么 SecInfo 和 Shipping 表没有更新。

此外，您的代码中似乎有很多不必要的东西，如果您所做的只是更新/添加到 3 个表，那么您不需要那么多代码行。希望这可以帮助。

# iphone - 在 UITableViewCell 子类中旋转 UIImageView

> ID：10405722
> 
> 赞同：0
> 
> 时间：2012-05-01T23:22:57.530
> 
> 标签：iphone, objective-c, ios, ipad, uiimageview

所以我有以下代码：

```
#define degreesToRadians(x) (M_PI * x / 180.0)

@implementation NewsFeedSubCell
@synthesize imageView_;

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {

        CGRect frame = self.frame;
        frame.size.width = 20;
        frame.size.height = 20;
        self.frame = frame;
        self.contentView.frame = frame;

        UIImageView *imageView = [[UIImageView alloc] initWithFrame:self.frame];
        imageView.transform = CGAffineTransformRotate(self.contentView.transform, degreesToRadians(90));
        [imageView setAutoresizingMask:UIViewAutoresizingNone];
        [self.contentView addSubview:imageView];
        self.imageView_ = imageView;
        [imageView release];

    }
    return self;
} 
```

知道为什么这不旋转吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:06:27.517

为什么要对 contentView 进行转换？尝试使用`CGAffineTransformMakeRotation`而不是`CGAffineTransformRotate`

# php - 使用文件获取内容读取xml

> ID：10405725
> 
> 赞同：1
> 
> 时间：2012-05-01T23:23:19.460
> 
> 标签：php

我 hv 一个 xml 文件，如何使用获取文件内容方法获取标题字段中的值..我只想获取值“TomTom XXL 550M - 美国、加拿大和墨西哥汽车 GPS。（全新）”

```
<Title>
TomTom XXL 550M - US, Canada & Mexico Automotive GPS. (Brand New)
</Title> 
```

我的代码

```
$xmlstr = file_get_contents($source);
$parseXML = new SimpleXMLElement($xmlstr);
print($parseXML);

// load as file
$parseXMLFile = new SimpleXMLElement($source,null,true); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T23:32:44.487

你只需要阅读你的文件`simplexml_load_file`：[Doc for this one](http://www.php.net/manual/en/function.simplexml-load-file.php)

然后，您将获得 class 的对象`SimpleXMLElement`。

然后，你可以用它来得到你想要的！这里有一些例子：[SimpleXML 例子](http://php.net/manual/en/simplexml.examples-basic.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T00:03:34.747

如果您对 javascript 感到满意，还有另一种称为[DOMDocument的解决方案](http://www.php.net/manual/en/class.domdocument.php)

您可以加载 XML 文件，也可以使用 getElementsByTagName 等函数。例如，如果您有一个这样的 books.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<books>
 <book><title>Patterns of Enterprise Application Architecture</title></book>
 <book><title>Design Patterns: Elements of Reusable Software Design</title></book>
 <book><title>Clean Code</title></book>
</books> 
```

您可以这样提取标题：

```
$dom = new DOMDocument;
$dom->load('books.xml');
$books = $dom->getElementsByTagName('title');
foreach ($books as $book) {
    echo $book->nodeValue.'<br>';
} 
```

# ffmpeg - FFMPEG API：如何使用无损 h264 编码？

> ID：10405728
> 
> 赞同：1
> 
> 时间：2012-05-01T23:23:38.373
> 
> 标签：ffmpeg, h.264

使用 h264 无损编码需要哪些设置？我不是在谈论 ffmpeg 命令行工具，而是在谈论 c api。

我设法用有损h264对视频进行编码，但我不知道如何将编码器设置为无损。？

我在 MSVC++ 中编码并使用预编译库。在网上我发现了一些 .ffpreset 文件（例如 libx264-lossless_max.ffpreset），它们似乎不是我使用的预编译版本的一部分（至少它们不在预设文件夹中）。我不确定 ffpreset 文件是否以某种方式编译到库中，或者它们是否可以以某种方式加载到编码器中？如果是这样，我将如何使用这样的预设文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T12:24:25.373

您需要设置恒定质量模式，并将所需质量设置为 0。在 x264 命令行中，这是 x264 --crf 0。

> --crf 基于质量的 VBR (0-51, 0=无损) [23.0]

在 ffmpeg 命令行中，这类似地完成

> 要获得恒定的质量（但比特率可变），请在“n”介于 1（优秀质量）和 31（最差质量）之间时使用选项“-qscale n”。

如果您想以编程方式执行此操作，只需阅读源代码即可查看我列出的特定选项如何影响 AVCodecContext 结构

# css - CSS Floats 没有按计划进行

> ID：10405729
> 
> 赞同：0
> 
> 时间：2012-05-01T23:24:03.577
> 
> 标签：css, css-float

所以我对 css 和 html 都很陌生，但这不是我第一次使用浮动来实现 2 个彼此相邻的 div。这次它不能正常工作，我已经修补了大约 3 个小时，我想我应该寻求帮助。

我在 jsFiddle 中编辑了我的网站部分，以帮助描述我的问题：

[http://jsfiddle.net/9QRcP/10/](http://jsfiddle.net/9QRcP/10/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:46:57.413

问题不在于您没有将`div`s 分配给`float: right`，而是您`div`的 s 足够小，可以在页面宽度内容纳多个，因此他们正在做他们应该做的事情。

但是，为了解决这个问题，[我们将添加`clear:right`](http://jsfiddle.net/9QRcP/16/)到`#about_side`and `#about_side_footer`，**但这不会强制它们为 level**，因此它并不能完全解决问题。

为了解决这个问题，而不是分别浮动你`#greeting_wrapper`和`#about_wrapper`左右的每个单独的部分，而是浮动[包装器左右](http://jsfiddle.net/9QRcP/18/)。

```
#greeting_wrapper {
  float: left;
}

#about_wrapper {
  float: right;
}

#greeting_header, #greeting, #greeting_footer, #about_side_header, #about_side, #about_side_footer {
  float: none;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T23:44:07.480

我发现你需要浮动`#greeting_wrapper`和`#about_wrapper`. 这些包装器是重要的元素。据我所知，这些`div`s 的孩子也不需要浮动。

目前，这些`div`s 正在采用 960px 的主体宽度，因此迫使两个`div`s 进入新行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T23:40:03.043

我对你的代码有兴趣：http: [//jsfiddle.net/9QRcP/15/](http://jsfiddle.net/9QRcP/15/)

我没有费心纠正对齐方式，但左边现在在左边，右边现在在右边。

我自己承认，这不是一个很好的方法。几点建议：

1.  您可以使用'clear：left'强制左侧的元素移动到新行[http://www.w3schools.com/cssref/pr_class_clear.asp](http://www.w3schools.com/cssref/pr_class_clear.asp)
2.  您可能应该将左右元素包含在 2 个单独的容器中（例如 class="container left" 和 class="container-right" ）。为左容器中要移动到下一个垂直级别的任何子元素清除 left，对于右容器中的元素也是如此。这将使您可以轻松地将页面分成几列。这是我之前从[http://www.quirksmode.org/css/clearing.html准备的](http://www.quirksmode.org/css/clearing.html)[http://jsfiddle.net/9QRcP/19/](http://jsfiddle.net/9QRcP/19/)
3.  您可能可以通过使用网格系统为自己节省大量工作，例如[http://960.gs/](http://960.gs/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-01T23:30:41.887

问题在于包装器的宽度。如果你增加宽度，浮动的 div 将在右侧占据它的位置。

# c# - 基于瓷砖的平台游戏中的水物理

> ID：10405731
> 
> 赞同：1
> 
> 时间：2012-05-01T23:24:39.903
> 
> 标签：c#, .net, xna, physics

我在我的 XNA C# 游戏中添加了水物理，它是基于 Tile（网格系统）的。

我之前问过一个关于这个的问题。但我实际上尝试了它，它似乎比我想象的要容易，我已经有一些水可以流动。但我的问题是，当它撞到墙上时，我需要它上升。我需要一种方法来获取列/行上最后一个图块的位置所以我可以检查它是空的还是填充的

```
 [W]
   [W][W][W][B]
[B][B][B][B][B]
Should be...

[W][W][W][W][B]
[B][B][B][B][B] 
```

等等，我需要得到一个列的结尾，以便我可以添加到它，例如：

```
 [W]
   [W]
   [W]

[B]   [B]
[B]   [B]
[B][W][B]
[B][W][B]
[B][B][B]
Should be

   [W]
[B][W][B]
[B][W][B]
[B][W][B]
[B][W][B]
[B][B][B] 
```

现在我的方法不能像那样堆叠它们

到目前为止我所做的是...

```
 private void UpdateWater()
    { // Calculate the visible range of tiles.
        int left = (int)Math.Floor(cameraPosition / 16);
        int right = left + 1024 / 16;
        right = Math.Min(right, Width - 1);

        int top = (int)Math.Floor(cameraPositionYAxis / 16);
        int bottom = top + 768 / 16;
        bottom = Math.Min(bottom, Height - 1);

        //For Each tile on screen ///WATER CODE IS BELOW///
        for (int y = top; y < bottom; ++y)
        {
            for (int x = left; x < right; ++x)
            {
                if (tiles[x, y].blockType.Name == "Water")
                {
                    if (tiles[x, y + 1].blockType.Name == "Blank")
                    {  
                        tiles[x, y ] = new Tile(BlockType.Blank, null, x,y );

                        tiles[x, y + 1] = new Tile(BlockType.Water, null, x, y + 1);
                    }
                    else if ((tiles[x + 1, y].blockType.Name != "Blank") && (tiles[x + 1, y].blockType.Name != "Water"))
                    {

                    }
                    else if ((tiles[x - 1, y].blockType.Name != "Blank") && (tiles[x - 1, y].blockType.Name != "Water"))
                    {

                    }

                    else
                    { 

                           tiles[x, y] = new Tile(BlockType.Blank, null, x, y);
                           tiles[x - 1, y] = new Tile(BlockType.Water, null, x - 1, y);

                    }
                }
            }
        }
    } 
```

我仍然可能被认为是一个“新手”编码器，任何帮助表示赞赏！如果您需要更多信息或澄清，请告诉！

编辑：也许我需要水砖的压力参数？或者不......现在试图解决这个问题......仍然在堆叠方面遇到了一些麻烦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:35:43.790

您是在尝试模拟类似于真实物理的东西，还是更像“Boulderdash”物理的东西？如果是后者，我建议您可能想尝试不同的方法来查看“感觉”正确的方法；我建议不要考虑“压力”，而是考虑体积，为每个单元分配一个值，例如从 1/8 满到完全满。然后在每个运动帧上执行以下两个操作：

1.  从下到上，如果一个包含水的单元在一个可能包含水但未满的单元之上，则将尽可能多的水从上部单元移动到下部单元。
2.  从下到上，对于每个包含水的单元格，如果下面的单元格不能容纳更多的水，如果有空间，则将“起始量”的水的 1/4 转移到每一侧。

我猜想每帧执行这两个步骤可能会产生一些看起来合理的水效果。它们不会代表任何与真实物理非常相似的东西，但对于很多平台游戏来说，可玩性比真实感更重要。

# c++ - 在 Qt 中发送信号时的 const-ref

> ID：10405739
> 
> 赞同：33
> 
> 时间：2012-05-01T23:25:45.103
> 
> 标签：c++, qt, signals-slots, const-reference, pass-by-const-reference

这是我在 const-ref 中从未得到过的东西，我真的希望有人可以向我解释。

在另一个函数内部调用一个函数时，我知道 const-ref 是传递我不打算篡改的堆栈对象时的最佳方式。例如：

```
void someInnerFunction(const QString& text) {
    qDebug() << text;
}

void someFunction() {
    QString test = "lala";
    ....
    someInnerFunction(test);
} 
```

到目前为止一切顺利，我猜。但是信号呢？传递参考是否有任何风险？尽管它是`const`. 感觉就像我一直在阅读所有关于 const-ref 的文档，但我仍然觉得有点冒险，因为我将其理解为“发送对对象的引用并保留它`const`”。如果它所指的对象超出范围怎么办？

例如：

```
void someFunction() {
    connect(this, SIGNAL(someSignal(const QString&)), this, SLOT(someSlot(const QString&)));

    QString test = "lala";
    emit someSignal(test);

    // doesnt test go out of scope here? and since im not using queued connection the QString object doesnt get copied. 
}

void someSlot(const QString& test) {
    qDebug() << test; // will this work?
} 
```

这里到底发生了什么？我经常在函数调用中使用 const-ref，我只想访问对象但不更改它。但是信号呢？大多数信号似乎在 Qt 文档中都有 const-ref parm，但它是如何工作的？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-01T23:44:08.323

根据[这个答案](https://stackoverflow.com/questions/1935147/argument-type-for-qt-signal-and-slot-does-const-reference-qualifiers-matters)，Qt 只是用副本替换 const 引用。

编辑：显然并非总是如此......我只是用一个线程做了一个基本的测试程序，并且引用被正确传递。它的 const-ness 也保持不变。无论如何，是的，您确实需要警惕变量超出范围，而且您不能以这种方式跨线程发送引用。如果这样做，则只会传递副本。

要回答您示例评论中的问题，是的，无论是直接连接还是排队连接，它都会起作用。如果是直接连接，它将工作，因为`someSlot()`将在`someFunction()`完成之前执行；如果它是排队连接，它将起作用，因为`test`它将被复制而不是通过引用传递。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-29T13:48:12.267

这是一个很好的演示，展示了 Qt 信号/插槽如何管理复制：[http ://www.embeddeduse.com/2013/06/29/copied-or-not-copied-arguments-signals-slots/](http://www.embeddeduse.com/2013/06/29/copied-or-not-copied-arguments-signals-slots/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T01:23:07.957

在 Qt 中，当发出连接到一个或多个插槽的信号时，它等同于同步函数调用......除非您已将信号和插槽配置为使用排队连接，否则它是一个异步调用，您应该传递堆栈数据时要小心，并且应该像传递数据到另一个线程一样传递副本。

# android - 运行方式的键盘快捷键 -> Eclipse 中的 Android JUnit 测试

> ID：10405740
> 
> 赞同：5
> 
> 时间：2012-05-01T23:25:50.473
> 
> 标签：android, eclipse, shortcut, robotium

有人想出这个菜单的键盘等效项吗？

![我想有一个键盘快捷键的菜单](../Images/bc5d42c6cb3e8581f78799bd3ebb6ef8.png)

我一直在使用带有类签名的 Robotium 测试用例中使用此菜单，例如：

```
public class AccountTest extends ActivityInstrumentationTestCase2<MainActivity> { ... } 
```

不知何故，`Alt`- `Shift`-即使您在弹出的对话框中选择 Android JUnit Runner 也不会做同样的事情`X`......`T`

类似的 Run As -> Android Application 有一个棘手的快捷方式`Alt`- `Shift`- `A`，`R`当启动所有其他可能的可运行类型以`Alt`- `Shift`-开头时`X`，所以有希望。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T17:55:38.023

*`Window -> Preferences -> Run/Debug -> Launching -> Always launch the previously launched application.`*

运行测试用例，无论是整个事情，还是特定的测试方法，一次。然后它可以在历史记录中再次运行。按运行或调试按钮的下拉菜单。选择要运行的配置。从那时起，`F11`或`Ctrl`+ `F11`（调试或运行）冲洗并再次重复完全相同的事情。

type type type, `F11`, 观察结果， type type type。没有鼠标。非常有成效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-29T21:10:16.397

在我的 macbook 上，我使用的是 Shift-Command-Fn-F11。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-02T10:14:43.583

我正在使用类似的快捷方式，但对于 TestNG，就我而言，快捷方式是`SHIFT + ALT + X, G`

所以当我按下时`SHIFT + ALT + X`，我在右下角得到一个小窗口：

![在此处输入图像描述](../Images/881102418ce9743b864c49b64fb99887.png)

一旦我在右下角看到这个窗口，当我按下 键`G`时，它会按预期启动 TestNG Suite。

# php - PHP“魔术”方法获取/设置

> ID：10405743
> 
> 赞同：1
> 
> 时间：2012-05-01T23:26:03.110
> 
> 标签：php, methods

> **可能重复：**
> [PHP __get 和 __set 魔术方法](https://stackoverflow.com/questions/4713680/php-get-and-set-magic-methods)

我有一个关于 Get/Set 方法的考试问题，但我找不到任何直接的定义。有人可以为我解释/定义它还是回答这个问题；

> 识别并描述 PHP 中用于检索和更新私有类/对象属性的两个内置“魔术”方法。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T23:30:08.060

基本思想是这样的：如果你调用`$foo->bar`， where`bar`从未定义为该类的属性，它将被发送到 get/set 魔术方法。如果您实现这些方法，您将能够看到被调用的名称，以及在“set”的情况下，传递了什么值。然后你可以用它做任何你想做的事

例子：

```
public function __set($name, $value)
{
    if ($name === "bar")
    {
        $this->privateProperty = $value;
    }
}

public function __get($name)
{
    if ($name === "bar")
    {
        return $this->privateProperty;
    }
} 
```

# jquery - 如何强制关闭 jQuery UI 手风琴 和?

> ID：10405746
> 
> 赞同：3
> 
> 时间：2012-05-01T23:26:46.720
> 
> 标签：jquery, asp.net, vb.net, visual-studio-2010, jquery-ui

我正在使用带有两个 div 的 jQuery UI 手风琴。第一个显示表单，第二个显示基于表单输入的数据。当用户单击表单中的提交按钮时，如何自动关闭第一个 div 并显示第二个？我假设我需要在按钮中使用“onclick”，但我不确定如何将它与手风琴联系起来。

```
<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
<script type="text/jscript">
$(document).ready(function () {
$("#accordion").accordion();
});
</script>
</asp:Content>
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
<div id="accordion">
<a href="#">Criteria</a>
<div>
<asp:Button ID="Button_GetReport" runat="server" Text="View Report" />
</div>
<a href="#">Report</a>
<div>
A databound grid goes here.
</div>
</div>
</asp:Content> 
```

如果我遗漏了什么，请告诉我。提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:47:47.837

单击提交按钮将往返于服务器，因此 onclick 不会帮助您。您可能想要输出手风琴是打开还是关闭。

一种方法是更改​​您的手风琴 div 以使类显示状态：

```
<div id="accordion" class="accordion-<%= accordion_state %>"> //open or closed 
```

那么您的选择器将是：

```
$(document).ready(function () {
  $(".accordion_open").accordion();
  $(".accordion_closed").hide();
}); 
```

有关同时使用 ASP.NET 和手风琴控件的一些示例，请参阅[本文](http://www.dotnetsteve.com/index.php/2010/02/simple-accordion-menu-with-jquery-asp-net/)。

# mysql - mysql - 请使用正确的正则表达式语法提供建议

> ID：10405747
> 
> 赞同：0
> 
> 时间：2012-05-01T23:26:53.403
> 
> 标签：mysql, regex

我正在 mysql db 中寻找正确的查询。让我们考虑一下我有表：

用户：

```
id | user_name | desc
--------------------------
1  | john      | tall
2  | john      | fat
3  | maria     | pretty 
```

项目：

```
id | item_name | color
--------------------------
1  | trousers  | red
2  | shoes     | blue
3  | shoes     | red 
```

我的搜索引擎搜索数据库以选择带有查询的结果：

```
SELECT i.item_name, i.color, u.user_name, u.desc 
FROM users u, items i 
WHERE u.id = i.id 
   AND item_name REGEXP $keywords 
   AND user_name REGEXP $keywords 
```

变量 $keywords 是这样的：

```
$keywords = explode(' ', $_POST['keywords']);
$keywords = implode('|', $keywords); 
```

现在，当 $keywords = 'john trousers' 一切正常 - 我得到 id = 1 的用户。没关系。但是当我设置 $keywords = 'john' 它返回空字符串。我什至知道为什么 - item_name 中没有“john”，所以我的 AND 条件返回 false。问题是：什么是正确的正则表达式返回 user = 1 和 $keywords = "john trousers" 并且如果 $keyword = 'john' 得到两行 - id = 1 和 id = 2？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:10:18.673

您可以反转比较，使用列值作为搜索值（并使用`LIKE`代替`REGEXP`）：

```
SELECT i.item_name, i.color, u.user_name, u.desc 
FROM users u, items i 
WHERE u.id = i.id 
AND $keywords like concat('%', item_name, '%')
AND $keywords like concat('%', user_name, '%') 
```

请注意，尽管这是一种简洁的方法，但它仅在`keywords`包含列的*整个*值时才有效。要进行更复杂的比较，您需要尝试拆分值等（您必须自己进行调查）

# tsql - 非数字数据的 SQL WHERE 条件中的 CASE WHEN

> ID：10405752
> 
> 赞同：0
> 
> 时间：2012-05-01T23:27:33.807
> 
> 标签：tsql, conditional, case-when

我有这个查询，但我需要第二个`WHERE`条件依赖于集合中的一个值：

```
SELECT TABLE1.*, TABLE2.*
FROM TABLE1, TABLE2
WHERE TABLE1.ID = TABLE2.ID
AND TABLE1.TIMESTAMP > DATEADD(D,-5,GETDATE()) 
```

所以我想要这样的东西不起作用（因为'>'）：

```
SELECT TABLE1.*, TABLE2.*
FROM TABLE1, TABLE2
WHERE TABLE1.ID = TABLE2.ID
AND CASE WHEN TABLE1.TRIGGER = 'TRUE' THEN TABLE1.TIMESTAMP > DATEADD(D,-5,GETDATE()) END 
```

我环顾四周，但只能找到意图操纵数字信息的示例。有没有人有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:30:14.940

改变这个：

```
AND TABLE1.TIMESTAMP > DATEADD(D,-5,GETDATE()) 
```

到：

```
AND (TABLE1.TRIGGER <> 'TRUE' or (TABLE1.TRIGGER = 'TRUE' AND TABLE1.TIMESTAMP > DATEADD(D,-5,GETDATE())) 
```

`TABLE1.TRIGGER`如果不等于，这将是“和真” ，或者如果*等于*，`TRUE`它将执行额外的条件检查 ( `TABLE1.TIMESTAMP > ...`) 。*`TRUE`*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:55:46.660

`CASE`结果是一个值，所以你需要对它做一些事情，例如将它与另一个值进行比较：

```
SELECT TABLE1.*, TABLE2.* 
  FROM TABLE1, TABLE2 
  WHERE TABLE1.ID = TABLE2.ID AND
    CASE
      WHEN TABLE1.TRIGGER = 'TRUE' THEN 1
      WHEN TABLE1.TIMESTAMP > DATEADD(D,-5,GETDATE()) THEN 1
      ELSE 0
      END = 1 
```*

# javascript - 如何在正确的行而不是所有行中显示消息？

> ID：10405753
> 
> 赞同：0
> 
> 时间：2012-05-01T23:27:42.960
> 
> 标签：javascript, jquery

下面是一个函数，它控制文件在其自己的表行中完成上传后发生的任何事情。每个表行都包含一个文件输入，用户可以在其中上传文件，然后将文件名附加到它自己的表行中。

如果文件成功，则显示一条成功消息，如果上传不成功，则显示一条消息，说明存在错误。但是我在该功能中还有另一个功能，用户可以通过单击“删除”按钮来删除文件。我唯一的问题是这行代码：

```
$(".imagemsg").html(data); 
```

假设我有 2 个表行，我在第一行删除了一个文件，.imagemsg 中的消息应该只显示在第一行，因为那是发生删除的行，它不应该在第一排和第二排。

所以我的问题是我需要添加什么，`$(".imagemsg").html(data);`以便消息仅显示在文件删除发生的行中，而不是`.imagemsg`每一行中的所有内容？

以下是完整代码：

```
function stopImageUpload(success, imagefilename){

      var result = '';

      if (success == 1){
         result = '<span class="imagemsg">The file was uploaded successfully!</span><br/><br/>';      
         $('.listImage').eq(window.lastUploadImageIndex).append('<div>' + htmlEncode(imagefilename) + '<button type="button" class="deletefileimage" image_file_name="' + imagefilename + '">Remove</button><br/><hr/></div>'); 
      }
      else {
         result = '<span class="imageemsg">There was an error during file upload!</span><br/><br/>';
      }

      $(".deletefileimage").on("click", function(event) {

         var image_file_name = $(this).attr('image_file_name');

        $(this).parent().remove();

    jQuery.ajax("deleteimage.php?imagefilename=" + image_file_name)
      .done(function(data) {
        $(".imagemsg").html(data);
       });

    });

      return true;   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T23:29:56.593

将相关元素传递给回调函数。您已经有了`$(this)`，因此您可能可以从中获取正确的行并将其放入变量中，然后在回调中访问它以将结果放在正确的位置。

# assembly - x86 中断表修改

> ID：10405754
> 
> 赞同：2
> 
> 时间：2012-05-01T23:27:56.107
> 
> 标签：assembly, x86, x86-64, interrupt

我正在编写自己的保护模式操作系统，需要知道如何修改中断表，以便将某些（打印字符串等）重定向到命令提示符应用程序或其他应用程序。如何修改表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:42:54.983

首先，使用中断进行系统调用实际上不再是实际实现它们的“好”方式。如果您的目标是 x64，那么您绝对应该研究`SYSCALL`and `SYSRET`，它可以非常方便地（从用户的角度）调用内核代码，前提是您愿意处理使用这两个所需的一些设置例程。如果这不是一个选项，请考虑将一些内核代码映射到进程的虚拟内存空间。谷歌`linux-gate.so.1`阅读有关该示例实现的信息。

但是，如果您仍想通过中断实现系统调用，请继续阅读。当然，您可能需要以任何一种方式修改中断表，以便与硬件进行实际交互。

在 x86 的保护模式下，中断被放置在 IDT 中，它是中断描述符表的缩写。该表可以包含任务门描述符、中断门描述符或陷阱门描述符。该表的索引方式与实模式中断向量表类似——例如，表的`n`第一个条目包含将用于服务中断的描述符`n`。中断和陷阱门实际上只是指向带有一些额外数据的中断例程代码的指针，而任务门包含一个任务状态段选择器，它是应该处理该中断的任务的选择器。在 64 位模式下，由于硬件任务处理的弃用，仅支持中断/陷阱门。

我真的不明白简单地改写英特尔手册的意义，它非常清楚地解释了这些问题，所以我建议你[读一读](http://download.intel.com/products/processor/manual/325384.pdf)（尽管你现在应该有这些手册）。该文档的第 6 章描述了中断处理。

# objective-c - 最新的 Xcode 构建仅在运行两次后传输到 iPad（设备或模拟器）

> ID：10405758
> 
> 赞同：1
> 
> 时间：2012-05-01T23:28:22.647
> 
> 标签：objective-c, ios, xcode, cocoa-touch, ipad

运行 Xcode 4.3 并遇到以下问题：

当我更改代码并单击“运行”将其部署到 iPad 模拟器或设备上时，我看不到设备上反映的最新更改。再次单击“运行”将导致再次部署它，然后我会看到更改。

在建造之前尝试清洁并没有帮助。从 iPad/模拟器中删除应用程序将起作用。

我相信这个问题可能是基于项目的。我做了一个简单的辅助项目来测试，我没有看到这个问题。

当我每小时构建和部署 30 次时，这是一个巨大的时间同步 :)

# javascript - 客户端 JavaScript 和/或 JavaScript 代码使用 jquery 调用 WCF 服务检索 System.IO.Stream 的集合？

> ID：10405762
> 
> 赞同：3
> 
> 时间：2012-05-01T23:28:43.250
> 
> 标签：javascript, jquery, wcf, collections, stream

我正在创建一个 WCF 服务，该服务将由客户端的纯 JavaScript 和客户端的一些 jQuery JavaScript 使用。

1) 我怎样才能实现普通的客户端 JavaScript，以便它以这样的方式调用 WCF 服务，以便立即检索 System.IO.Stream 的集合？此外，我将如何遍历在纯 JavaScript 端接收到的集合，以便可以将集合中的每个 System.IO.Stream 对象与 HTML 图像元素相关联？

2) 是否有可能实现使用 jquery 的 JavaScript 代码，以便它以这样的方式调用 WCF 服务，即一次检索 System.IO.Stream 的集合？此外，我将如何遍历使用 jQuery 的 JavaScript 接收的集合，以便可以将集合中的每个 System.IO.Stream 对象与 HTML 图像元素相关联？

```
 /*********Start of Excerpt from the Interface Code of a WCF Service

 Contract*****************/

 using System;

 using System.Collections.Generic;

 using System.Linq;

 using System.Runtime.Serialization;

 using System.ServiceModel;

 using System.ServiceModel.Activation;

 using System.Text;

 using System.ServiceModel.Web;

 using System.IO;

 using ConsoleForWCFServiceTutorial.PerlsDataContracts;

 using ConsoleForWCFServiceTutorial.DataAccessObjectsDAO;

 namespace ConsoleForWCFServiceTutorial

 {

    [ServiceContract(Namespace =

 "http://ConsoleForWCFServiceTutorial.CarService")]

    public interface ICarService

    {

   [OperationContract]

   [WebInvoke(Method = "GET",

                   BodyStyle = WebMessageBodyStyle.WrappedRequest)]

        Stream[] getImagesList();

    }

 }

 /*********End of Excerpt from the Interface Code of a WCF Service
 Contract*****************/

 /*********Start of Excerpt of the code associated with the Class that
 implements the WCF Service Contract*****************/

 using System;
 using System.Collections.Generic;
 using System.Linq;
 using System.Text;
 using System.Collections;
 using System.ServiceModel.Activation;
 using System.Configuration;
 using System.Data;
 using System.IO;
 using System.ComponentModel;
 using ConsoleForWCFServiceTutorial.PerlsDataContracts;
 using ConsoleForWCFServiceTutorial.DataAccessObjectsDAO;

 namespace ConsoleForWCFServiceTutorial
 {
      [AspNetCompatibilityRequirements(RequirementsMode =
      AspNetCompatibilityRequirementsMode.NotAllowed)]
 class CarService : ICarService
 {

       public Stream[] getImagesList()
        {

            List<Stream> myImagesList = new List<Stream>();

            string fileName = Path.Combine("BMWpicture.jpg");

            FileStream fileStream =
              new FileStream(fileName, FileMode.Open, FileAccess.Read);
            // Set the content type as image/ jpeg
            System.ServiceModel.Web.WebOperationContext.
              Current.OutgoingResponse.ContentType = "image/jpeg";

            myImagesList.Add(fileStream);

            string fileName2 = Path.Combine("MercedesBenzpicture.jpg");

            FileStream fileStream2 =
              new FileStream(fileName2, FileMode.Open, FileAccess.Read);
            // Set the content type as image/ jpeg
            System.ServiceModel.Web.WebOperationContext.
              Current.OutgoingResponse.ContentType = "image/jpeg";

            myImagesList.Add(fileStream2);

            return myImagesList.ToArray();
        }
    }
 }
 /*********End of Excerpt of the code associated with the Class that
 implements the WCF Service Contract*****************/

 <!--Start of Excerpt of the plain JavaScript client code that
 invokes one of the Methods in the WCF Service
 Contract-->

 <script type="text/javascript">

 function getImagesList2() {

   var listOfStreams =
 'http://localhost:8732/Design_Time_Addresses/ConsoleForWCFServiceTutorial/carService     /getImagesList'

   document.getElementById("image11").onload = function () {
     }; // img.onload = function()

      document.getElementById("image11").src = listOfStreams[0];

   document.getElementById("image12").onload = function () {
        }; // img.onload = function()

      document.getElementById("image12").src = listOfStreams[1];

 }
 </script>
 <!--End of Excerpt of the plain JavaScript client code that
 invokes one of the Methods in the WCF Service
 Contract-->

 <!--Start of Excerpt of the HTML code that is affected by the
 JavaScript client and WCF Service interaction-->
 <body>
    <form id="form1" runat="server">
    <div>

                 <img src=""  id="image11" alt="Smiley face" />     

               <img src=""  id="image12" alt="Smiley face" />

         <br />
         <a class="large blue button" id="A7"
 onClick="getImagesList2()">getImagesList2</a>

        </div>
    </form>
 </body>
 </html>

 <!--End of Excerpt of the HTML code that is affected by the
 JavaScript client and WCF Service interaction--> 
```

1) 我怎样才能实现普通的客户端 JavaScript，以便它以这样的方式调用 WCF 服务，以便立即检索 System.IO.Stream 的集合？此外，我将如何遍历在纯 JavaScript 端接收到的集合，以便可以将集合中的每个 System.IO.Stream 对象与 HTML 图像元素相关联？

2) 是否有可能实现使用 jquery 的 JavaScript 代码，以便它以这样的方式调用 WCF 服务，即一次检索 System.IO.Stream 的集合？此外，我将如何遍历使用 jQuery 的 JavaScript 接收的集合，以便可以将集合中的每个 System.IO.Stream 对象与 HTML 图像元素相关联？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T20:11:21.843

您需要创建一个启用 CORS 的 WCF 服务，该服务将返回 Base64String 的列表（从您想要接收的图像的字节数组转换而来）。然后通过这个答案-> [https://stackoverflow.com/a/9464137/1488207](https://stackoverflow.com/a/9464137/1488207)您可以将它们逐个设置为 img 标签，遍历您在 jquery 中收到的列表。我不会为您提供您想要的（我想您可以将图像转换为字节数组，然后返回 Base64Strings ），但我可以复制我的 WCF 服务的配置和代码文件以节省您的时间（花了我花了很多时间从 jquery 成功使用我的 WCF）。

```
<?xml version="1.0"?> 
```

```
<system.web>
    <compilation debug="true" targetFramework="4.0" />
</system.web>
<system.serviceModel>
    <services>
        <service  name="EmployeeService.EmployeeSearchService/*Your service name replaces EmployeeService.EmployeeSearchService */" behaviorConfiguration="DefaultServiceBehavior">
            <endpoint binding="webHttpBinding" contract="EmployeeService.IEmployeeSearchService"      behaviorConfiguration="DefaultEPBehavior" />
        </service>
    </services>
    <behaviors>
        <endpointBehaviors>
            <behavior name="DefaultEPBehavior">
                <webHttp />
            </behavior>
        </endpointBehaviors>
        <serviceBehaviors>
            <behavior name="DefaultServiceBehavior">
                <serviceMetadata httpGetEnabled="true" />
                <serviceDebug includeExceptionDetailInFaults="true" />
            </behavior>
        </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
</system.serviceModel>
<system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
    <!--
    To browse web app root directory during debugging, set the value below to true.
    Set to false before deployment to avoid disclosing web app folder information.
  -->
    <directoryBrowse enabled="true"/>
</system.webServer>
<connectionStrings>
    <add name="myConnString" connectionString=""/>
</connectionStrings> 
```

执行

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.ServiceModel.Web;
using System.Text;
using System.Web.Script.Serialization;

namespace EmployeeService
{
    // NOTE: You can use the "Rename" command on the "Refactor" menu to change the             class name "Service1" in code, svc and config file together.
// NOTE: In order to launch WCF Test Client for testing this service, please select Service1.svc or Service1.svc.cs at the Solution Explorer and start debugging.
public class EmployeeSearchService : IEmployeeSearchService
{
    public List<Customer> GetAllImages()
    {
        WebOperationContext.Current.OutgoingResponse.Headers.Add(
            "Access-Control-Allow-Origin", "*"); WebOperationContext.Current.OutgoingResponse.Headers.Add(
            "Access-Control-Allow-Methods", "POST"); WebOperationContext.Current.OutgoingResponse.Headers.Add(
            "Access-Control-Allow-Headers", "Content-Type, Accept");
        List<Base64String> s = new List<Base64String>();
        //DO YOUR IMAGE CONVERSION TO BYTE ARRAY AND THEN TO BASE64STRINGS AND ADD THEM TO THE LIST ABOVE
        var jsonData = new
        {
            totalImages = s.Count,
            Images = (
                from row in s
                select new
                {
                    imgString = row
                }
         ).ToArray()
        };
        return (new JavaScriptSerializer()).Serialize(jsonData);
    }
}
} 
```

界面

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.ServiceModel.Web;
using System.Text;
using EmployeeSearchService.BE;
namespace EmployeeService
{
// NOTE: You can use the "Rename" command on the "Refactor" menu to change the interface name "IService1" in both code and config file together.
[ServiceContract]
public interface IEmployeeSearchService
{
    [OperationContract]
    [WebInvoke(Method = "GET",
       ResponseFormat = WebMessageFormat.Json,
       RequestFormat = WebMessageFormat.Json,
       BodyStyle = WebMessageBodyStyle.Bare)]
    object GetAllImages();
}
} 
```

现在您可以通过以下代码从 jquery 调用此服务，如果成功，您将获得一个包含计数和属性 Image 的对象，您必须通过“result.Image [0]”遍历数组

```
$.support.cors = true;
var methodName = '/GetAllImages';
var urlService = 'some http service url';
$.ajax({
    type: "GET",
    url: urlService + methodName,
    data: {},
    dataType: "Json",
    processdata: "false",
    success: function (result) {
        if (result != null) {
            images = $.parseJSON(result);
            for(var i = 0 ; i < result.totalImages ; i++)
               $('<img>').src('data:image/png;base64,' + result.Image[i]).insertAfter('#myDiv');
        }
        else { }
    },
    error: function (msg) {
        alert(msg);
    }
}); 
```

告诉您是否需要更多帮助。

# javascript - 调整弹出窗口的大小以缩放级别

> ID：10405764
> 
> 赞同：1
> 
> 时间：2012-05-01T23:28:59.750
> 
> 标签：javascript, html, css

我们构建了一个广播播放器，它会弹出 window.open 脚本：

onclick="window.open('Media-player.html','player','scrollbars=0,width=360,height=655')"

问题是，当有人放大播放器（或就此而言的父框架）时，弹出窗口不会随之调整大小，播放器在窗口内重叠并且某些部分会被隐藏。

当用户放大时，有没有办法调整窗口大小以适应其内容？希望避免启用滚动条或只是使尺寸变大。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T01:09:34.943

没有办法知道用户是否缩放了浏览器，但有一些技巧可以尝试检测它。

请参阅此线程：[在 JavaScript 中捕获浏览器的“缩放”事件](https://stackoverflow.com/questions/995914/catch-browsers-zoom-event-in-javascript)

# glkit - GLKMatrix4Translate 是否正确？

> ID：10405766
> 
> 赞同：0
> 
> 时间：2012-05-01T23:29:34.960
> 
> 标签：glkit

我不确定我是否误解了一些事情，或者我只是累了。考虑下面的两行代码。

```
GLKMatrix4 projection = GLKMatrix4Translate(_perspective, 0, 0, -5);
GLKMatrix4 projection = GLKMatrix4Multiply(_perspective, GLKMatrix4MakeTranslation(0, 0, -5)); 
```

我希望它们是等价的。但他们不是。GLKMatrix4Translate 的来源是：

```
static __inline__ GLKMatrix4 GLKMatrix4Translate(GLKMatrix4 matrix, float tx, float ty, float tz)
{
    GLKMatrix4 m = { matrix.m[0], matrix.m[1], matrix.m[2], matrix.m[3],
                     matrix.m[4], matrix.m[5], matrix.m[6], matrix.m[7],
                     matrix.m[8], matrix.m[9], matrix.m[10], matrix.m[11],
                     matrix.m[0] * tx + matrix.m[4] * ty + matrix.m[8] * tz + matrix.m[12],
                     matrix.m[1] * tx + matrix.m[5] * ty + matrix.m[9] * tz + matrix.m[13],
                     matrix.m[2] * tx + matrix.m[6] * ty + matrix.m[10] * tz + matrix.m[14],
                     matrix.m[15] };
    return m;
} 
```

但是我希望最后一行是：

```
matrix.m[3] * tx + matrix.m[7] * ty + matrix.m[11] * tz + m[15]; 
```

我是正确的，还是在疲倦的迷雾中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T14:51:29.040

我认为你是对的，翻译中一定有一个错误。我使用 MakeTranslation+Multiply 而不是 Translate 函数，因为 m[15] 始终保持不变。

# android - Google Maps V 3.8 和可拖动标记的触摸灵敏度

> ID：10405767
> 
> 赞同：0
> 
> 时间：2012-05-01T23:29:54.243
> 
> 标签：android, ios5, google-maps-api-3, google-maps-markers

由于我的 api 注册中仅对 V3 有限制：

解决方案默认为最新。今天 Google Maps API 更新到了 3.8 版。现在我的 iPAD 2 上的标记触摸灵敏度要低得多。在它识别出具有可拖动：true 的自定义标记之前，我必须准确。

当我将库设置为 V3.7 时，一切都很好。

我需要在 V3.8 中进行更改以放松标记对象对触摸识别的敏感度吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T20:28:50.100

这个问题也在 V3.9 中。当`draggable=true`设置在标记上时会发生这种情况。它发生在 iOS 5.1 和 Android 3.2

请参阅 Bugs 中的相关帖子。

# string - 使用Case匹配sql server中的字符串？

> ID：10405769
> 
> 赞同：7
> 
> 时间：2012-05-01T23:30:07.770
> 
> 标签：string, tsql

我正在尝试`CASE`在 SQL Select 语句中使用，该语句将允许我获得可以利用一个字符串的长度来生成另一个字符串的结果的结果。这些用于来自两个数据集的不匹配记录，这些数据集共享一个公共 ID，但数据源不同。

案例陈述如下：

```
Select Column1, Column2, 
Case
When Column1 = 'Something" and Len(Column2) = '35' Then Column1 = "Something Else" and substring(Column2, 1, 35)
End as Column3
From  dbo.xxx 
```

当我运行它时，我收到以下错误：

> 消息 102，级别 15，状态 1，第 5 行 '=' 附近的语法不正确。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-02T02:52:34.573

您需要为 each 设置一个值`WHEN`，并且应该有一个`ELSE`:

```
Select Data_Source, CustomerID,
  CASE
    WHEN Data_Source = 'Test1' and Len(CustomerName) = 35 THEN 'First Value'
    WHEN Data_Source = 'Test2' THEN substring(CustomerName, 1, 35)
    ELSE 'Sorry, no match.'
    END AS CustomerName
  From dbo.xx 
```

仅供参考：`Len()`不返回字符串。

**编辑：** 解决一些评论的 SQL Server 答案可能是：

```
declare @DataSource as Table ( Id Int Identity, CustomerName VarChar(64) )
declare @VariantDataSource as Table ( Id Int Identity, CostumerName VarChar(64) )
insert into @DataSource ( CustomerName ) values ( 'Alice B.' ), ( 'Bob C.' ), ( 'Charles D.' )
insert into @VariantDataSource ( CostumerName ) values ( 'Blush' ), ( 'Dye' ), ( 'Pancake Base' )

select *,
  -- Output the CostumerName padded or trimmed to the same length as CustomerName.  NULLs are not handled gracefully.
  Substring( CostumerName + Replicate( '.', Len( CustomerName ) ), 1, Len( CustomerName ) ) as Clustermere,
  -- Output the CostumerName padded or trimmed to the same length as CustomerName.  NULLs in CustomerName are explicitly handled.
  case
    when CustomerName is NULL then ''
    when Len( CustomerName ) > Len( CostumerName ) then Substring( CostumerName, 1, Len( CustomerName ) )
    else Substring( CostumerName + Replicate( '.', Len( CustomerName ) ), 1, Len( CustomerName ) )
    end as 'Crustymore'
  from @DataSource as DS inner join
    @VariantDataSource as VDS on VDS.Id = DS.Id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T23:54:09.123

```
Select 
    Column1, 
    Column2, 
    Case 
      When Column1 = 'Something' and Len(Column2) = 35 
      Then 'Something Else' + substring(Column2, 1, 35) 
    End as Column3 
From dbo.xxx 
```

更新您的查询

1.  使用 '+' 进行字符串连接
2.  len() 返回 int，不需要使用 ''
3.  在条件时删除“Column1 =”
4.  用。。。来代替 ''

希望这有帮助。

# android - 如何使用 PreferenceFragment？

> ID：10405773
> 
> 赞同：4
> 
> 时间：2012-05-01T23:30:22.757
> 
> 标签：android, android-fragments, preferences

当我单击 ActionBar 中的图标时，我试图使用 PreferenceFragment 从 Activity 调用它，我只是调用 FragmentPreferences whit Intent：

```
case R.id.settings:
    Intent prefs = new Intent(this, LogicAnalizerPrefs.class);
    startActivity(prefs);
    break; 
```

这样，当我单击我的图标时，应用程序简单卡住，我的意思是它不会崩溃，LogCat 简单卡住没有什么奇怪的，如果我再次点击，我会得到 ANR。如果我改用：

```
getFragmentManager().beginTransaction().replace(android.R.id.content, new LogicAnalizerPrefs()).commit(); 
```

我可以看到 Fragment 但背景是透明的，我看到一些用户问同样的问题，但答案是调用 whit Intent 但我的应用程序卡住了。这是我的片段代码：

```
public class LogicAnalizerPrefs extends PreferenceFragment {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.logicanalizerprefs);
    }

} 
```

还有我的 logicanalizerprefs.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >

    <EditTextPreference
        android:defaultValue="128"
        android:key="buffer1"
        android:summary="Buffer canal 1"
        android:title="Buffer" />
    <EditTextPreference
        android:defaultValue="128"
        android:key="buffer2"
        android:summary="Buffer canal 2"
        android:title="Buffer" />
    <EditTextPreference
        android:defaultValue="128"
        android:key="buffer3"
        android:summary="Buffer canal 3"
        android:title="Buffer" />
    <EditTextPreference
        android:defaultValue="128"
        android:key="buffer4"
        android:summary="Buffer canal 4"
        android:title="Buffer" />

</PreferenceScreen> 
```

希望你能帮助我，我不知道它是什么：/

**--EDIT--** 这是我调用我的 Preference Activity/Fragment 的 Activity，它使用 achartengine 并实现一个可运行线程来刷新处理程序上的图表。

```
public class LogicAnalizerView extends Activity implements Runnable{

    /** Debugging */
    private static final boolean DEBUG = false;     String TAG;
    /** Varios */
    static ActionBar actionBar;         // ActionBar
    static Thread myThread = null;      // Thread para el metodo run() de Runnable
    static boolean Running;             // Ejecuta o no el while dentro de run()
    static Random crazy = new Random(); // Clase Random para generar numeros aleatorios
    /** Tiempo en el eje X */
    static float time = (float) 0.0;    // Tiempo transcurrido (eje X del grafico)
    static final float TimeIncrement = (float) 0.4;     // Tiempo que transcurre por muestreo (duracion de un 1-0)
    static final int XMax = 10;         // Valor maximo de X inicial
    static final int XMin = 0;          // Valor minimo de X inicial
    static int Ticks = 0;               // Veces que el grafico se actualiza
    static final int maxTicks = (int) (XMax/TimeIncrement);     // Cantidad de '1' y '0' que entran en el intervalo [XMin,XMax]
    /** Buffers */
    static int BufferSize;              // Tamaño del buffer de recepcion
    static byte[] ReceptionBuffer;      // Buffer de recepcion
    static byte[] Channel1;             // Buffers para cada canal
    static byte[] Channel2;
    static byte[] Channel3;
    static byte[] Channel4;

    //Lineas en el grafico
    TimeSeries[] input = new TimeSeries[4]; // Cada TimeSeries representa una funcion en el grafico
    XYMultipleSeriesDataset dataset;        // Agrupa todas las TimeSeries en el grafico
    //Renderers
    XYSeriesRenderer renderer;              // Opciones de renderizado para cada TimeSeries
    XYSeriesRenderer renderer1;
    XYSeriesRenderer renderer2;
    XYSeriesRenderer renderer3;
    XYMultipleSeriesRenderer mRenderer;     // Agrupa todas las opciones de renderizado del grafico
    //GraphicalView
    GraphicalView mChartView;               // View del grafico (el grafico en si)

    /**
     * Creacion de la Activity
     */
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        /**
         * ActionBar
         */
        actionBar = getActionBar();                     // Obtengo el ActionBar
        actionBar.setDisplayHomeAsUpEnabled(true);      // El icono de la aplicacion funciona como boton HOME

        /**
         * Preferencias
         */
        SharedPreferences getPrefs = PreferenceManager.getDefaultSharedPreferences(getBaseContext());
        Channel1 = new byte[Integer.decode(getPrefs.getString("buffer1", "128")) + 1];      // Tamaño de los buffers de cada canal basado en 
        Channel2 = new byte[Integer.decode(getPrefs.getString("buffer2", "128")) + 1];      // la configuracion +1 porque en el buffer[0] se coloca
        Channel3 = new byte[Integer.decode(getPrefs.getString("buffer3", "128")) + 1];      // el tipo de protocolo (I2C, SPI, UART, etc)
        Channel4 = new byte[Integer.decode(getPrefs.getString("buffer4", "128")) + 1];
        ReceptionBuffer = new byte[64];     // Buffer de recepcion general de 64 bytes

        /**
         * Configuro el grafico
         */
        //Crea una "Serie" que es una linea en el grafico llamado "Linea1"
        input[0] = new TimeSeries("Entrada 1");
        input[1] = new TimeSeries("Entrada 2");
        input[2] = new TimeSeries("Entrada 3");
        input[3] = new TimeSeries("Entrada 4");

        //XYMultipleSeriesDataset contiene todas las series, es decir todas las lineas del grafico en esta clase
        dataset = new XYMultipleSeriesDataset();
        dataset.addSeries(input[0]);    // Agregamos la serie que creamos a XYMultipleSeriesDataset que contiene todas las series
        dataset.addSeries(input[1]);
        dataset.addSeries(input[2]);
        dataset.addSeries(input[3]);

        //XYMultipleSeriesRenderer contiene todos los renderer de las diferentes series
        //XYSeriesRenderer le da las propiedades a las Series (lineas) como color y esas cosas
        mRenderer = new XYMultipleSeriesRenderer();
        renderer = new XYSeriesRenderer();
        renderer1 = new XYSeriesRenderer();
        renderer2 = new XYSeriesRenderer();
        renderer3 = new XYSeriesRenderer();

        //Renderers
        mRenderer.addSeriesRenderer(renderer);      // Agrego el XYSeriesRenderer al grupo XYMultipleSeriesRenderer
        mRenderer.addSeriesRenderer(renderer1);
        mRenderer.addSeriesRenderer(renderer2);
        mRenderer.addSeriesRenderer(renderer3);
        mRenderer.setShowGrid(true);                // Muestra una grilla en X e Y en el grafico
        mRenderer.setYTitle("Canales");             // Titulo del eje Y
        mRenderer.setYLabelsAlign(Align.CENTER);    // Alineacion del titulo
        mRenderer.setXTitle("Tiempo x100nS");       // Titulos del eje X
        mRenderer.setXLabelsAlign(Align.CENTER);    // Alineacion del titulo
        mRenderer.setZoomButtonsVisible(true);      // Botones de Zoom visibles
        mRenderer.setZoomEnabled(true, false);      // Zoom sobre el eje X solamente
        mRenderer.setAntialiasing(true);            // Usa antialising para dibujar
        mRenderer.setXAxisMin(XMin);                // Valor minimo del eje X
        mRenderer.setXAxisMax(XMax);                // Valor maximo del eje X

        //Colores de lineas
        renderer.setColor(Color.WHITE);     
        renderer1.setColor(Color.RED);
        renderer2.setColor(Color.GREEN);
        renderer3.setColor(Color.YELLOW);

        //Grosores de lineas
        renderer.setLineWidth(2);
        renderer1.setLineWidth(3);
        renderer2.setLineWidth(4);
        renderer3.setLineWidth(5);

        mChartView = ChartFactory.getLineChartView(this, dataset, mRenderer);
        setContentView(mChartView);

    }

    /**
     * Crea el ActionBar
     */
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        if(DEBUG) Log.i(TAG, "onCreateOptionsMenu() -> LogicAnalizerView");
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.actionbarmain, menu);
        return true;
    }

    /**
     * Listener de los iconos en el ActionBar
     */
    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        if(DEBUG) Log.i(TAG, "onOptionsItemSelected() -> LogicAnalizerView - Item: " + item.getItemId());

        switch(item.getItemId()){
        case android.R.id.home:
            Intent intent = new Intent(this, MainMenu.class);
            intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); //si la aplicacion ya esta abierta ir a ella no abrir otra nueva
            startActivity(intent);
        case R.id.settings:
            Intent a = new Intent(this, MainMenu.class);
            a.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
            startActivity(a);
            //Intent prefs = new Intent(getApplicationContext(), LogicAnalizerPrefs.class);
            //startActivity(prefs);
            break;
        case R.id.save:
            createDialog();
            break;
        }
        return true;
    }

    /**
     * Crea una ventana perguntando al usuario el nombre con el que desea guardar la imagen del grafico
     */
    private void createDialog() {
        Running = false;    //Detengo el Thread run()
        AlertDialog.Builder alert = new AlertDialog.Builder(this);
        alert.setTitle("Guardar");
        alert.setMessage("Nombre de archivo");

        // Creamos un EditView para que el usuario escriba
        final EditText input = new EditText(this);
        alert.setView(input);

        // Creamos el boton OK y su onClickListener
        alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int whichButton) {
                Editable text = input.getText();        // Obtengo el texto que escribio el usuario
                Bitmap bitmap = mChartView.toBitmap();  // Creo un nuevo BitMap

                try {   //Creo un nuevo archivo con el nombre del usuario y extension .jpeg
                    File image = new File(Environment.getExternalStorageDirectory(), "Multi\\" + text.toString() + ".jpeg");
                    if(image.exists()){
                        createDialogConfirm();
                    }
                    FileOutputStream output = new FileOutputStream(image);
                    bitmap.compress(CompressFormat.JPEG, 100, output);
                } catch (FileNotFoundException e) { e.printStackTrace(); }
                Running = true;
            }

        });

        // Boton cancelar
        alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
          public void onClick(DialogInterface dialog, int whichButton) {
              dialog.dismiss();
              Running = true;         
          }
        });
        alert.show();
    }

    private boolean createDialogConfirm() {
        AlertDialog.Builder confirm = new AlertDialog.Builder(this);
        confirm.setTitle("Guardar");
        confirm.setMessage("El archivo existe, sobreescribir ?");

        // Boton cancelar
        confirm.setPositiveButton("Si", new DialogInterface.OnClickListener() {
          public void onClick(DialogInterface dialog, int whichButton) {      
          }
        });

        // Boton cancelar
        confirm.setNegativeButton("No", new DialogInterface.OnClickListener() {
          public void onClick(DialogInterface dialog, int whichButton) {
              dialog.dismiss();   
          }
        });

        confirm.show();
        return true;
    }

    /**
     * Prueba de byte
     * @param a: byte para testear
     * @param bit: numero de bit a testear 0-7
     */
    public boolean bitTest (byte a, int bit) {
        return (a & (1 << bit)) != 0;
    }

    /**
     * @author Andres
     * Se llama al crear la Activity y al volver a ella si se ha salido, aqui creamos el Thread run() y lo iniciamos, a su vez seteamos
     * el item del DropDown menu del ActionBar a la aplicacion actual.
     * @see http://developer.android.com/reference/android/app/Activity.html
     */
    @Override
    protected void onResume() {
        super.onResume();
        //Creo el Thread y lo inicio
        Running = true;
        myThread = new Thread(this);
        myThread.start();
    }

    /**
     * @author Andres
     * Cuando se pausa la Activity se elimina el Thread run() para liberar recursos ya que no sera usado y se lo iguala a null para
     * no provocar un error si por accidente se intenta usarlo
     */
    @Override
    protected void onPause() {
        super.onPause();
        //destruyo el Thread
        Running = false;
        try {
            myThread.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        myThread = null;    //pongo el Thread como null para no provocar errores
    }

    /**
     * @author Andres
     * Lee cada aproximadamente 500mS los datos que se tienen del analizador logico y los muestra en el grafico llamando a un Handler
     * debido a que el grafico debe ser actualizado desde el Main Thread.
     * @see "private Handler uiCallback = new Handler ()" debajo.
     */
    @Override
    public void run() {

        while(true){
            while(Running){

                if(DEBUG) Log.i(TAG, "run() -> LogicAnalizerView");
                uiCallback.sendEmptyMessage(0);
                if(DEBUG) Log.i(TAG, "run() -> LogicAnalizerView - Thread.sleep()");

                try { Thread.sleep(500); }
                catch (InterruptedException e) { e.printStackTrace(); }
            }

        try { Thread.sleep(500); }
        catch (InterruptedException e) { e.printStackTrace(); }

        }

    }

    /** 
     * @author Andres
     * Los Handlers ejecutan sus operaciones en el Thread de la UI haciendo posible la modificacion de la misma desde Threads no UI.
     * @see http://developer.android.com/guide/topics/fundamentals/processes-and-threads.html
     * @see http://developer.android.com/reference/android/os/Handler.html
     */
    private Handler uiCallback = new Handler () {
        public void handleMessage (Message msg) {
            Running = false;
            if(DEBUG) Log.i(TAG, "XAxisMax: " + mRenderer.getXAxisMax() + " Time: " + time + " Ticks: " + Ticks);
            if(DEBUG) Log.i(TAG, "XAxisMin: " + mRenderer.getXAxisMin());
            final int[] factor = {0, 2, 4, 6};  // Valores tomados como 0 logicos

            // Si hay datos listos
            if(USBMulti.isLogicAnalizerDataRdy()){
                ReceptionBuffer = USBMulti.getLogicAnalizerData();      // Obtengo los datos desde el USB
            }

            // Si los bit son 1 le sumo 1 a los valores tomados como 0 logicos
            for(int n=0; n < ReceptionBuffer.length; ++n){              // Voy a traves de los bytes recibidos
                for(int bit=0; bit < 4; ++bit){     // Voy a traves de los 4 bits de cada byte
                    if(bitTest(ReceptionBuffer[n],bit)){
                        input[bit].add(time, factor[bit]+1);    
                    }
                    else{
                        input[bit].add(time, factor[bit]);
                    }
                }
                time += TimeIncrement;              // Incremento el tiempo
                ++Ticks;                            // Incremento ticks
                //Si llego al maximo del cuadro (borde derecho) aumento el maximo y el minimo para dibujar un tiempo mas
                //(desplazamiento del cuadro) de esta manera si deslizamos el cuadro horizontalmente tendremos los datos
                if(Ticks >= maxTicks){
                    mRenderer.setXAxisMax(mRenderer.getXAxisMax()+TimeIncrement);
                    mRenderer.setXAxisMin(mRenderer.getXAxisMin()+TimeIncrement);
                }
            }

            if(DEBUG) Log.i(TAG, "uiCallback -> LogicAnalizerView - mChartView.repaint()");
            if(mChartView != null) mChartView.repaint();    // Redibujo el grafico
            Running = true;
        }
    }; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T23:41:32.143

我正在使用一种相当简单的方法，所以这里基本上是我的一个项目的复制/粘贴 - 希望你可以使用它。你显然需要用你自己的东西替换一些部分，即首选项、字符串、命名空间等:-)

**显示偏好屏幕：**

```
startActivity(new Intent(getApplicationContext(), Preferences.class)); 
```

**偏好类：**

```
import java.util.List;

import android.os.Bundle;
import android.preference.PreferenceActivity;

public class Preferences extends PreferenceActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }

    @Override
    public void onBuildHeaders(List<Header> target) {       
        loadHeadersFromResource(R.xml.preference_headers, target);
    }

} 
```

**偏好类：**

```
import android.os.Bundle;
import android.preference.PreferenceFragment;

public class Prefs extends PreferenceFragment {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        int res=getActivity().getResources().getIdentifier(getArguments().getString("resource"), "xml", getActivity().getPackageName());
        addPreferencesFromResource(res);
    }

} 
```

**preference_headers.xml（在 res/xml 中）：**

> 您需要每个首选项屏幕（片段）的标题列表。

```
<preference-headers xmlns:android="http://schemas.android.com/apk/res/android" >

    <header
        android:fragment="com.miz.mizuu.Prefs"
        android:icon="@drawable/search"
        android:title="@string/prefsIdentificationAndSearch" >
        <extra
            android:name="resource"
            android:value="preferences" />
    </header>
    <header
        android:fragment="com.miz.mizuu.Prefs"
        android:icon="@drawable/apptheme"
        android:title="@string/prefsUI" >
        <extra
            android:name="resource"
            android:value="preferences2" />
    </header>

</preference-headers> 
```

**preferences.xml、preferences2.xml 等（在 /res/xml 中）：**

> 对于preference_headers.xml 中引用的每个“附加”，您需要单独的首选项xml 文件。这意味着上面的代码依赖于preferences.xml 和preferences2.xml。

```
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >

    <PreferenceCategory android:title="@string/prefsIdentification" >
        <CheckBoxPreference
            android:defaultValue="false"
            android:icon="@drawable/localizedinfo"
            android:key="prefsUseLocalData"
            android:summary="@string/prefsUseLocalDataDescription"
            android:title="@string/prefsUseLocalDataTitle" >
        </CheckBoxPreference>
    </PreferenceCategory>

</PreferenceScreen> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:34:42.853

您不能从`Intent`. 需要将片段添加到现有活动中，例如使用 FragmentTransaction。

听起来您实际上并不希望它成为 Fragment ，因此我建议您将其更改为 a `PreferenceActivity`，然后使用您的意图和 startActivity 加载它。

# javascript - 将 Excel 文件发送到 ASP.NET Web API

> ID：10405785
> 
> 赞同：2
> 
> 时间：2012-05-01T23:32:46.393
> 
> 标签：javascript, json, file-upload, webforms, asp.net-web-api

如何将来自文件上传输入的 excel 文件发送到我的 ASP.NET WebAPI，然后保存该 excel 文件以便我可以读取其数据？

这是我所拥有的（按钮单击调用upload（）） - 只是基础知识，效果很好：

```
 function upload() {
        $.getJSON("api/uploads/uploadfile",
            function (data) {
                $("#mydiv").append("Success: " + data.Success + " Failed: " + data.Failed);
            });
    } 
```

还有我的 ASP.NET WebAPI 方法：

```
 public DBResult UploadFile()
    {
        DBResult result = new DBResult();
        result.Success = 0;
        result.Failed = 0; 

        return result;
    } 
```

任何帮助是极大的赞赏。

TIA

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T23:13:31.300

我能够在这两篇文章之间弄清楚这一点：

[如何接受文件 POST](https://stackoverflow.com/questions/10320232/how-to-accept-a-file-post-asp-net-mvc-4-webapi/10327789#10327789)

[http://www.strathweb.com/2012/04/html5-drag-and-drop-asynchronous-multi-file-upload-with-asp-net-webapi/](http://www.strathweb.com/2012/04/html5-drag-and-drop-asynchronous-multi-file-upload-with-asp-net-webapi/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-17T21:16:21.453

我在另一个问题上发布了类似的解决方案，但使用 c# 发布到 webapi：
[如何接受文件 POST](https://stackoverflow.com/questions/10320232/how-to-accept-a-file-post-asp-net-mvc-4-webapi/17710285#17710285)

# c - qsort 函数 - 尝试使用比较器

> ID：10405786
> 
> 赞同：1
> 
> 时间：2012-05-01T23:32:47.583
> 
> 标签：c

我为一个更大的程序制作了一个 qsort 函数。就是按时间排序。我有一个正在使用的课程表，并且发现需要将时间与上午和下午进行比较。即如果选择A，则选择上午的所有课程，如果选择P，则选择下午的所有课程。我的问题是，有没有办法使用大于或小于比较器的排序函数？如果是这样，有人可以告诉我如果不是很麻烦怎么办？

```
int sortFunction(const void *p, const void *q) {
    return ((sched_record *) p)->start.hour -
                   ((sched_record *) q)->start.hour;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:40:28.080

### 编写比较器

在 C 中，比较器函数 from`qsort()`根据第一个参数表示的数据结构是否应该在第二个参数之前、等于或之后排序，返回一个小于、等于或大于零的数字。

排序上午和下午时间是痛苦的；即使从[上午/下午转换为 24 小时制](https://stackoverflow.com/questions/440061/convert-12-hour-date-time-to-24-hour-date-time)也不是一件容易的事。以 24 小时表示法存储时间值要好得多（甚至是自大纪元以来的秒数）。表示层应处理以 am/pm 表示法表示时间；模型层和控制器层通常应该避免混淆上午/下午。不要忘记：

```
12:01 am happens 1 hour   before  1:01 am
11:59 am happens 1 minute before 12:00 pm
12:00 pm happens 1 hour   before  1:00 pm 
```

假设您不受限于每小时开始的事件并且您已决定在内部使用 24 小时时间，那么您可以编写如下代码：

```
int SchedRecordTimeComparator(void const *v1, void const *v2)
{
    sched_record const *r1 = v1;  /* I don't mind a cast; there are those who do */
    sched_record const *r2 = v2;
    if (r1->start.hour < r2->start.hour)
        return -1;
    else if (r1->start.hour > r2->start.hour)
        return +1;
    else if (r1->start.minute < r2->start.minute)
        return -1;
    else if (r1->start.minute > r2->start.minute)
        return +1;
    else
        return  0;
} 
```

如何扩展它以管理秒数或其他匹配标准是相当明显的。请注意，此代码不会冒整数溢出的风险，而减去两个数字通常会遇到溢出问题。

如果您决定继续使用 12 小时制，那么您必须有办法区分早上 6 点和下午 6 点。基本上，您将在函数中将 12 小时表示法转换为 24 小时表示法，然后在此基础上进行比较（我假设 AM 和 PM 是枚举常量）：

```
int SchedRecordTimeComparator(void const *v1, void const *v2)
{
    sched_record const *r1 = v1;  /* I don't mind a cast; there are those who do */
    sched_record const *r2 = v2;
    int hhmm1 = ((r1->start.hour % 12) + (r1->start.am_pm == AM ? 0 : 12)) * 60 +
                  r1->start.minute;
    int hhmm2 = ((r2->start.hour % 12) + (r2->start.am_pm == PM ? 0 : 12)) * 60 +
                  r2->start.minute;
    if (hhmm1 < hhmm2)
        return -1;
    else if (hhmm1 > hhmm2)
        return +1;
    else
        return  0;
} 
```

* * *

### 这个怎么用？

> 我不确定如何使用它？

用法相当简单。在你的程序的某个地方，你有一个`sched_record`s 数组：

```
sched_record *array = malloc(num_records * sizeof(*array));
...
...fill up array with data...
...
qsort(array, num_records, sizeof(*array), SchedRecordTimeComparator);
... 
```

这里的所有都是它的。它可以是一个固定大小的数组：

```
sched_record array[NUM_RECORDS]; 
```

然后，假设您仍然有一个变量`size_t num_records`来指示正在使用的记录数，您使用相同的`qsort()`调用。使用`qsort()`非常简单。使用`bsearch()`稍微复杂一些，因为您通常必须伪造记录才能找到：

```
sched_record *SchedRecordSearch(int hour, int minute, sched_record *array, size_t num_records)
{
    sched_record key = { .start.hour = hour, .start.minute = minute };
    return bsearch(&key, array, num_records, sizeof(*array), SchedRecordTimeComparator);
} 
```

使用 C99 和指定的初始化程序使其更容易。您必须确保您的关键记录在比较器将使用的每个字段中都有适当的值。当然，在`qsort()`使用数组之前，您已经对数组进行了排序`bsearch()`——或者确保数据按照相同的排序顺序“就好像”您`qsort()`使用相同的比较器对其进行了 a 一样。

编写一个函数来检查数组的排序顺序也是值得的——它是直截了当的，并且作为“读者练习”。例如，您可以在断言中使用它。

* * *

### 不要自己写`qsort()`

我注意到我们所有回答这个问题的人都假设您正在使用标准 C 库排序功能，但您的问题表明您已经编写了自己的功能。一般来说，你必须非常好才能比系统提供的更好`qsort()`；除非我能证明系统功能太慢，否则我不会费心自己写。

*   使用系统提供的，`qsort()`直到你不需要问如何为自己写一个。

如果您仍然必须编写代码，那么您需要决定接口。您可以模仿标准接口（但使用不同的名称），也可以编写与一种特定类型绑定的自定义接口（如果需要对不同类型进行排序，则必须重新参数化）。后者大致是 C++ 对模板所做的。

编写自己的通用比较器的问题之一是在您事先不知道元素有多大时交换元素。如果您可以使用 C99 和 VLA，那还不算太糟糕，但如果一个元素的大小超出了您的堆栈，那么您就完蛋了。

在函数内部，你必须小心使用`char *`，而不是`void *`因为你不能合法地在 上进行指针运算`void *`，尽管 GCC 确实允许你作为非标准扩展这样做。

您需要确保清楚地了解数据的布局方式以及排序代码将对其执行的操作。您将使用各种答案中描述的比较器，当您需要进行比较时，您将执行以下操作：

```
 int cmp = (*Comparator)(char_base + (i * element_size), char_base + (j * element_size)); 
```

然后你可以这样做：

```
 if (cmp < 0)
     act on "element i smaller than element j"
 else if (cmp > 0)
     act on "element i greater than element j"
 else
     act on "elements i and j are equal" 
```

* * *

### 显示不同的范围

> 我不确定它会做我想要的。我必须更仔细地看。我最初发布的排序功能确实按时间从最早到最晚排序。我的问题可能不是很清楚。在我的程序的菜单部分，我有一个按 AM、PM 或 Don't care 排序的选项行。A 表示下午 12:00 之前开始的课程，P 表示中午或更晚开始的课程，D 表示不关心。如果用户选择 A，则列出截至 12:00 的课程，等等。如果您这样做，那么我该如何区分？

您混淆了两件事：对数据进行排序并显示正确的数据子集。您按照讨论/显示的方式对数据进行排序。这为您提供了一个排序数组。然后您扫描数组以显示您感兴趣的时间范围内的条目。这将是一个单独的函数；您可能仍然使用比较器功能，但是您会为时间范围的开始和结束创建一对虚拟键（每个键都有点像`bsearch()`我的答案示例中的键），然后查找所有开始时间之后和结束时间之前的排序数组中的记录。

我将做一些简化的假设。您`start.hour`将时间明确记录为自午夜以来的分钟数，并且它是一个整数。

1.  对数组进行排序：

    ```
    qsort(array, num_records, sizeof(*array), SchedRecordTimeComparator); 
    ```

2.  生成正确的密钥 -`lo`和`hi`：

    ```
    typedef struct sched_range
    {
        sched_record *lo;
        sched_record *hi;
    } sched_range;

    sched_record lo, hi;
    if (choice == 'A')
    {
        lo.start.hour = 0;        /* Midnight (am) */
        hi.start.hour = 12 * 60;  /* Midday */
    }
    else if (choice == 'D')
    {
        lo.start.hour = 12 * 60;  /* Midday */
        hi.start.hour = 24 * 60;  /* Midnight (pm) */
    }
    else
    {
        lo.start.hour = 0;        /* Midnight (am) */
        hi.start.hour = 24 * 60;  /* Midnight (pm) */
    } 
    ```

3.  编写`SchedRangeSearch()`函数：

    ```
    sched_range SchedRangeSearch(sched_record const *array, size_t num_records,
                    sched_record *lo, sched_record *hi,
                    int (*comparator)(void const *v1, void const *v2))
    {
         sched_range r = { 0, 0 };
         sched_record const *ptr = array;
         sched_record const *end = array + num_records;

         /* Skip records before start time */
         while (ptr < end && (*comparator)(lo, ptr) < 0)
             ptr++;
         if (ptr >= end)
             return r;  /* No matching records */

         r.lo = ptr;  /* First record in range */

         /* Find first record after finish time - if any */
         while (ptr < end && (*comparator)(ptr, hi) < 0)
             ptr++;

         r.hi = ptr;
         return r;
    } 
    ```

4.  使用搜索功能查找所需的范围：

    ```
    sched_range r = SchedRangeSearch(array, num_records, &lo, &hi, SchedRecordTimeComparator); 
    ```

5.  显示相关记录：

    ```
    if (r.lo != 0)
    {
        assert(r.hi != 0);
        sched_record *ptr;

        for (ptr = r.lo; ptr < r.hi; ptr++)
            show_sched_record(ptr);
    }
    else
        show_empty_schedule(); 
    ```

*未经测试的代码*：当心崩溃、越界访问等。

目的是搜索函数提供两个指针，指向范围的开始（范围中的第一个有效项）和结束，其中结束指针指向最后一个有效项之外。因此`for`，显示有效数据的循环从开始到严格小于结束。（这与 C++ 中使用 STL 迭代器的约定相同。重用好的想法是值得的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T23:36:30.637

假设你有一个函数`greaterThan`，你可以实现`sortFunction`如下：

```
int sortFunction(const void *p, const void *q) {
    if (greaterThan(p, q)) { // p > q
        return +1;
    } else if (greaterThan(q, p)) { // p < q
        return -1;
    } else { // p == q
        return  0;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T00:11:08.840

只需为 AM 与 PM 添加单独的检查，并使任何 AM 时间小于 PM 时间：

```
int sortFunction(const void *p, const void *q) {
  return
    (sched_record *) p)->am_pm < (sched_record *) q)->am_pm ?
      -1 :
    (sched_record *) p)->am_pm > (sched_record *) q)->am_pm ?
       1 :
       ((sched_record *) p)->start.hour -
               ((sched_record *) q)->start.hour;
} 
```

大概在您`sched_record`的`am_pm`领域中，上午为 1，下午为 2，或类似的东西。

***编辑：***原来 OP 在其结构中没有 am_pm 指示符，因此可能必须使用 24 小时时间表示，显然用整数表示小时和分钟：

```
int sortFunction(const void *p, const void *q) {
  return
    (sched_record *) p)->start.hour < (sched_record *) q)->start.hour ?
      -1 :
    (sched_record *) p)->start.hour > (sched_record *) q)->start.hour ?
       1 :
       ((sched_record *) p)->start.minutes -
               ((sched_record *) q)->start.minutes;
} 
```

# c# - 正则表达式“追加”或“替换”只有每个单词的第一个字母？

> ID：10405789
> 
> 赞同：0
> 
> 时间：2012-05-01T23:33:07.600
> 
> 标签：c#, regex

如果我有两个词，例如“ga ?abg”

如果它们与“？a”匹配，我想删除第二个单词中的前两个字符并取后面的“b”并将其附加到第一个单词？

我怎样才能做到这一点？请帮忙

```
string five ="ga ?abg";
string T = Regex.Replace(five, "?a", " "); 
```

但是如何附加第一个“b”？

结果应该是“gab g”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:49:54.963

我猜你想要这样的东西，虽然我不使用 c#，所以语法可能是错误的。（另外，你的描述很混乱，所以我可能不明白你想要什么）

```
Regex.Replace(five, "([^ ]+) \\?a([^ ])", "$1$2") 
```

在哪里：

*   “(...)”是匹配组，$n复制第n个匹配组的内容
*   “[^]”表示“除空格外的任何字符
*   “[^ ]+”表示“一个或多个非空格字符”
*   “\？” 表示“文字问号”，因为问号在正则表达式中是特殊的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:53:04.573

我认为您正在寻找的正则表达式是这样的：

```
/ \?a./ 
```

因为我不知道任何 C#，所以这是一个[jsfiddle](http://jsfiddle.net/8MsqW/1/)（我保持简单，以防你不知道任何 js）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T00:11:15.023

这必须是正则表达式有什么特别的原因吗？

```
string answer;
string[] split = five.Split(' ');
if (split.Length == 2 && split[0].Length > 0 && split[1].StartsWith("?a") && split[1].Length > 3)
{
    answer = string.Format("{0}{1} {2}", split[0], split[1].Substring(2, 1), split[1].Substring(3));
}
else
{
    answer = five;
} 
```

或者，您可以使用[MatchEvaluator Delegate](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.matchevaluator%28v=vs.110%29.aspx)，但这仍然需要自定义代码。我认为您无法通过简单的`Regex.Replace`.

# mongodb - mongoDB在索引字段上不同

> ID：10405790
> 
> 赞同：0
> 
> 时间：2012-05-01T23:33:11.463
> 
> 标签：mongodb, mongodb-query, nosql

我正在尝试对包含在唯一索引中的字段使用 distinct。没有一个索引字段将起作用。任何其他领域都很好。这是我运行以下命令时的统计信息输出：

（非索引字段）

```
db.runCommand( { distinct: 'businesses', key: 'website' } )

"values" : [
    blah blah blah
],
"stats" : {
        "n" : 36,
        "nscanned" : 36,
        "nscannedObjects" : 36,
        "timems" : 0,
        "cursor" : "BasicCursor"
},
"ok" : 1 
```

（索引字段）

```
db.runCommand( { distinct: 'businesses', key: 'state' } );

{
        "values" : [ ],
        "stats" : {
                "n" : 0,
                "nscanned" : 0,
                "nscannedObjects" : 0,
                "timems" : 0,
                "cursor" : "BtreeCursor address_1_unit_1_city_1_state_1_zip_1"
        },
        "ok" : 1
} 
```

如何在索引中涉及的那些字段上使用 distinct？

# c# - 将 Html 表格发送到多个 Excel 工作表

> ID：10405792
> 
> 赞同：1
> 
> 时间：2012-05-01T23:33:17.573
> 
> 标签：c#, html, excel

我有两个 html 表，我想将它们放入同一个 excel 文件的 2 个不同工作表中。我正在使用 ASP.net MVC3 并将 FileResult 发送到我的页面。

FileResult 包含以下内容（减去字符串生成器）：

```
 StringBuilder sb = new StringBuilder();
        sb.Append("<html xmlns:x=\"urn:schemas-microsoft-com:office:excel\">");
        sb.Append("<head>");
        sb.Append("<meta http-equiv=\"Content-Type\" content=\"text/html;charset=windows-1252\">");
        sb.Append("<!--[if gte mso 9]>");
        sb.Append("<xml>");
        sb.Append("<x:ExcelWorkbook>");
        sb.Append("<x:ExcelWorksheets>");
        sb.Append("<x:ExcelWorksheet>");
        sb.Append(String.Format("<x:Name>{0}</x:Name>", ExcelSheetName));
        sb.Append("<x:WorksheetOptions>");
        sb.Append("<x:Panes></x:Panes>");
        sb.Append("</x:WorksheetOptions>");
        sb.Append("</x:ExcelWorksheet>");

        // sheet 2
        sb.Append("<x:ExcelWorksheet>");
        //sb.Append("<x:Table/>");
        //sb.Append("<x:Column x:Width=\"500\" />");
        //sb.Append("<x:Column x:Width=\"500\" />");
        //sb.Append("</x:Table/>");
        sb.Append(String.Format("<x:Name>Sheet2_Test</x:Name>"));
        //sb.Append("<Table ss:ExpandedColumnCount=\"2\" ss:ExpandedRowCount=\"5\" x:FullColumns=\"1\" x:FullRows=\"1\">");
        //sb.Append("<Row><Cell><Data ss:Type=\"String\">Text in cell A1</Data></Cell></Row>");
        //sb.Append("<Row><Cell ss:StyleID=\"s21\"><Data ss:Type=\"String\">Bold text in A2</Data></Cell></Row>");
        //sb.Append("<Row ss:Index=\"4\"><Cell ss:Index=\"2\"><Data ss:Type=\"Number\">43</Data></Cell></Row>");
        //sb.Append("<Row><Cell ss:Index=\"2\" ss:Formula=\"=R[-1]C/2\"><Data ss:Type=\"Number\">21.5</Data></Cell></Row>");
        //sb.Append("</Table>");
        sb.Append("<x:WorksheetOptions>");
        sb.Append("<x:Panes></x:Panes>");
        sb.Append("</x:WorksheetOptions>");
        sb.Append("</x:ExcelWorksheet>");

        sb.Append("</x:ExcelWorksheets>");
        sb.Append("</x:ExcelWorkbook>");
        sb.Append("</xml>");
        sb.Append("<![endif]-->"); 
```

然后我添加我的 html 表并返回结果。它工作得很好，我得到了第二张纸，但我不知道如何写第二张纸。有谁知道如何使用这种方法写入第二张纸？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T21:50:55.343

每张纸都应该有自己的`<Worksheet>`元素。然后每个`<Worksheet>`节点都有自己的`<Table>`元素，该元素具有一个或多个`<Row>`元素，该元素具有一个或多个`<Cell>`元素。

# ruby-on-rails - Heroku 在自定义域上提供错误的主页

> ID：10405795
> 
> 赞同：1
> 
> 时间：2012-05-01T23:33:38.503
> 
> 标签：ruby-on-rails, heroku

什么可能导致托管在 heroku 上的应用程序提供不同的主页？

这会正确呈现 [http://ninezoom.herokuapp.com/](http://ninezoom.herokuapp.com/)

这不是 [http://9zoom.com/](http://9zoom.com/)

这很好，虽然 [http://9zoom.com/features](http://9zoom.com/features)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T13:35:20.417

它是内存缓存的。我忘了清除缓存 Rails.cache.clear

# c++ - '>>>' Java 到 C++

> ID：10405796
> 
> 赞同：3
> 
> 时间：2012-05-01T23:34:14.787
> 
> 标签：c++, shift

> **可能重复：**
> [什么是 C++ 中的 >>> 操作](https://stackoverflow.com/questions/5529443/what-is-operation-in-c)

我需要将Java的这一小部分转换为C ++，但不知道'>>>'是什么......搜索过，但没有找到参考，只有在班次。有没有人有任何想法？

```
int x1;

x1 = text1[i1++] & 0xff;

text2[i2++] = (char) (x1 >>> 8); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T23:39:04.103

无符号右移 ( `>>>`) 在 C++ 中不存在，因为它不是必需的——C++ 具有不同的有符号和无符号整数类型。如果您希望右移是无符号的，请将要移动的变量设为无符号：

```
unsigned int x1 = text1[i1++] & 0xff;
text2[i2++] = (char) (x1 >> 8); 
```

话虽如此，您正在翻译的代码很愚蠢。在 Java 中，第二个操作的结果将始终为零，因此您可以轻松地将其转换为：

```
i1++;
text2[i2++] = 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:38:39.997

C中的等价物是：

```
unsigned int x1;

x1 = text1[i1++] & 0xff;

text2[i2++] = (unsigned char)(x1 >> 8) 
```

在 C 中，如果它正在操作的变量是有符号的，则移位运算符将从符号位拖动 1，否则它将像 java 无符号移位一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T23:44:08.437

`>>>`Java 中的运算符是与 C++ 中的类型运算符等效的[逻辑移位。](http://en.wikipedia.org/wiki/Logical_shift)它将零移到左侧的空位位置。在有符号类型上，右移是逻辑还是[算术](http://en.wikipedia.org/wiki/Arithmetic_shift)是实现定义的，因此您需要从一开始（或强制转换）使用无符号类型：`>>``unsigned`

```
unsigned int x1;
x1 = text1[i1++] & 0xff;
text2[i2++] = static_cast<char>(x1 >> 8); 
```

当然，这段代码似乎没有多大意义——<code>x1 只有 8 个非零位，因为它被 屏蔽了`0xff`，因此将其右移 8 位结果为零。

# jquery - 在文档准备好之前显示 html 页面

> ID：10405797
> 
> 赞同：1
> 
> 时间：2012-05-01T23:34:18.237
> 
> 标签：jquery, html, ajax

我在准备好填充表格的文档中有一些 ajax 调用。不幸的是，只有在填充表格后才会显示该页面。

```
$(document).ready(function() {
    // alert('Why');
    var jsondata2a;
    turl = "/rims/tab1/get_data?abc=123";
    $.ajax({
    url: turl+"",
    cache: false,
    async: false,
    success: function(data){
            jsondata2a = data;
    },
    error: function(){
            $("#gerror").html("<p>An error has occurred!</p>");
        }
    }); 
```

但是，如果我在 ready 函数中放置一个警报语句，页面会立即显示警报，然后在接受警报后填充表格。

整页显示在警报语句上，但如果警报不存在，则在完成所有 ajax 调用之前不会显示该页面。我试图将就绪功能移动到页面的不同部分，但没有成功。我尝试过使用 IE 和 Chrome。

任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:40:52.553

您无需等待`$(document).ready()`执行 ajax 请求。你只需要在与 dom 交互之前等待。因此，在 ready 函数之外执行您的请求，并在您的成功回调中侦听 dom ready。

这不会阻止您的页面呈现。

```
$.ajax({
  ...
  success: function() {
    $(document).ready(function() {
      /* manipulate DOM here */
    });
  }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T23:50:51.253

如果你想防止你的[jQuery ajax](http://api.jquery.com/jQuery.ajax/)调用阻塞，你必须将 async 设置为 true （默认）。

```
 $.ajax({
            type: 'POST',
            url: 'YourURLHere.html',
            data: '{}',
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            async: true,
            success: function (data, text) {
                // Do Something
            },
            error:function (request, status, error){
                // Alert Somebody
            } 
        }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T23:38:24.037

这应该有效。我敢肯定，您还有其他知道如何绘制该表的 scipt prt。只需在成功回调中添加该代码

```
$(document).ready(function() {
    // alert('Why');
    var jsondata2a;
    turl = "/rims/tab1/get_data?abc=123";
    $.ajax({
    url: turl+"",
    cache: false,
    // async: false,
    success: function(data){
            jsondata2a = data;
            for(var i=0; i< data.length; i++){
               $("#table_id").append("<tr>" ...boud data here data[i].someAttribute... "</tr>");
            }
    },
    error: function(){
            $("#gerror").html("<p>An error has occurred!</p>");
        }
    }); 
```

# mysql - 此查询会按预期工作吗？

> ID：10405800
> 
> 赞同：2
> 
> 时间：2012-05-01T23:34:52.270
> 
> 标签：mysql, database

我有一个只有一列的 mysql 表，该列有一些 3 个字母的单词和一些 4 个字母的单词，以及一些 5 和 6 个字母的单词。

我想要一个查询首先从所有 3 个字母的单词中随机选择，当它们都消失时，然后转到 4 个字母的单词，依此类推。

这是我的查询：

```
SELECT `word` FROM `words` ORDER BY LENGTH(`word`) ASC, RAND() LIMIT 1 
```

到目前为止，这在我尝试过的几次中都按预期工作，但我想确保它总是这样工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:19:25.640

您的查询对我来说看起来不错，但我希望表很小，因为 MySQL 每次都会扫描所有行，然后使用 filesort，全部返回一行。

添加一`wordlength`列并为其编制索引不会改进查询，因为该`ORDER BY RAND()`函数会使索引的使用无效。

考虑根据它们的长度将单词分成单独的表，至少您只会扫描所有行以查找相同长度的单词。先从three_letter_words 表中选择，如果没有结果，再从four_letter_words 表中选择，以此类推。

# ios - 在 webViewDidStartLoad 期间注入 javascript 无法重新加载

> ID：10405804
> 
> 赞同：5
> 
> 时间：2012-05-01T23:35:35.873
> 
> 标签：ios, ios5

我正在重新加载我的 UIWebView 并且由于某种原因 stringByEvaluatingJavaScriptFromString 中的代码似乎没有效果。它在初始视图加载时工作正常，但在重新加载时似乎不起作用。通过调试器，我看到重新加载后调用了 webViewDidStartLoad，所以肯定还有另一个问题。

```
- (void)webViewDidStartLoad:(UIWebView *)webView
{
    //pass in our default variables into the web view here
    [mainWebView stringByEvaluatingJavaScriptFromString:@"var model = {taskId:'xyz', foo:'bar'};"];

} 
```

和我的重新加载方法

```
- (void)refreshView{
    [mainWebView reload];   
} 
```

# mongodb - 通过 SSH 隧道的 MongoDB 连接

> ID：10405809
> 
> 赞同：0
> 
> 时间：2012-05-01T23:36:13.500
> 
> 标签：mongodb, ssh, ssh-tunnel

我在 Linode 上有两台服务器，它们可以通过本地 Linode 区域网络相互连接。问题是该地区的任何其他 Linode 也可以使用该 IP 进行连接。一台服务器托管 python 应用程序，另一台托管 MongoDB。

使用 SSH 隧道连接到数据库是个好主意吗？如果隧道发生故障会怎样？已知 SSH 隧道会失败吗？

还是我以错误的方式解决问题？我能想到的另一种选择是将 iptables 设置为仅接受来自特定源 IP 的连接。

我在想一个更假设的情况，也许我只需要一个数据库密码。我一直在学习计算机安全课程，它让一切看起来比实际更容易受到攻击。

# cocoa - 为什么我的内部成员变量的名称会破坏数据绑定？

> ID：10405816
> 
> 赞同：0
> 
> 时间：2012-05-01T23:37:45.887
> 
> 标签：cocoa, cocoa-bindings

所以我对可可编程真的很陌生。事实上，我对 Mac 平台也很陌生。仍然试图习惯控制+左箭头将我带到行首的事实。

好的：所以我正在学习 Hillegass 的“Cocoa Programming (4th edition)”一书中的教程。所以我到了第 9 章，它介绍了如何创建一个文档视图应用程序，它使用 NSArrayControler 绑定到 Person 的 NSMutableArray。

本教程引导我创建了一个文档子类，并添加了一个 NSMutableArray 指针。所以我冒昧地把它命名为 mEmployee's 而不仅仅是雇员。

```
@interface RMDocument : NSDocument
{
    NSMutableArray* mEmployees;
}
-(void) setmEmployees:(NSMutableArray*)a;

-(void) insertObject:(Person*)p inEmployeesAtIndex:(NSUInteger)index;
-(void) removeObjectFromEmployeesAtIndex:(NSUInteger)index;

-(void) startObservingPerson:(Person*) person;
-(void) stopObservingPerson:(Person*) person;

@end 
```

现在，当我这样做时，似乎 NSArrayController 上的绑定中断了。因此从未调用过 setEmployee、insertObject 和 removeObject 等方法。

现在我对 Objective-C 还是很陌生，但我认为 mEmployee's 是我的“RMDocument”接口的内部成员变量，我可以随意命名它。我想在名称前加上“m”，以便将其与其他变量名称区分开来（类似于 C++ 中的成员变量）。显然，这是一个很大的不，不。

那么为什么变量名会产生如此大的影响呢？

我已将项目的整个源代码放在： [https ://www.dropbox.com/sh/fq166ap3xzlw5xc/EZJXqIZPRY/RaiseMan](https://www.dropbox.com/sh/fq166ap3xzlw5xc/EZJXqIZPRY/RaiseMan)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:48:21.253

访问器方法的名称需要遵循命名约定：对于属性“foo”，setter 是“setFoo”（注意大写）。所以，你需要有`setMEmployees`，而不是`setmEmployees`。

附带说明一下，您使用“m”作为成员变量前缀的想法不是典型的 Cocoa 风格；它可能会使您的代码更难被其他人阅读。

# jquery - 用 jquery click 事件替换 CSS3 悬停过渡

> ID：10405817
> 
> 赞同：1
> 
> 时间：2012-05-01T23:37:54.113
> 
> 标签：jquery, css, click, hover

我有一系列使用 css3 实现悬停效果的图像。当用户将鼠标悬停在图像上时，标题会滑过。这是一个非常好的效果。在移动设备上，用户看不到这种悬停效果，因为移动设备上没有悬停。理想情况下，我希望移动用户在“点击”（与单击相同）图像时看到标题。将 CSS 悬停选择器转换为点击事件的最佳方法是什么？我认为最好的方法是使用 jquery。但是如果我做了类似下面的事情，我不确定这将如何与 CSS3 一起工作：

```
$("img").click(function(){
     perform css3 hover transitions now
}); 
```

我会将它放在一个条件中，因此它仅适用于 480 像素以下的屏幕（移动设备）。我的问题是，如何将这些 CSS3 悬停转换作为移动屏幕上的 jquery 点击事件触发？有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T23:45:13.950

根据这个，你想要的是不可能的。建议的修复是在另一个非伪 css 类中复制 css。

[http://forum.jquery.com/topic/jquery-triggering-css-pseudo-selectors-like-hover](http://forum.jquery.com/topic/jquery-triggering-css-pseudo-selectors-like-hover)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:03:11.240

说真的，我还没有尝试过 jQuery Mobile，但是这个库为鼠标事件提供了伪事件，例如[`vmouseover`](http://jquerymobile.com/demos/1.1.0/docs/api/events.html)，你可以使用这个事件，将 CSS`:hover`属性放在另一个类中，然后通过触发事件将类添加到元素中：

```
$('img').live('vmouseover', function() {
      $(this).addClass("hover");
}); 
```

# curl - 为什么这个 curl 命令返回 rss 而不是 HTML？

> ID：10405819
> 
> 赞同：0
> 
> 时间：2012-05-01T23:37:57.947
> 
> 标签：curl, rss

如果您使用浏览器访问 www.sketchfemme.com，您将获得（查看源代码）：

```
<!doctype html>
   <html>

     <head>
      <meta charset="utf-8"/>
      <title>SketchFemme Feature of the Day</title>
              .....
               <link href="/featured.rss" rel="alternate" title="SketchFemme Feature of the Day" type="application/rss+xml" />  
     </head> 
```

但是如果我执行此命令，则从 mac 终端：

```
 curl sketchfemme.com -A "Mozilla/4.0" --trace-ascii - -L 
```

我取回了 rss 文件的 xml 内容。

我期待使用 curl 命令查看 HTML，为什么我要返回 XML？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:46:13.013

卷曲正在添加`Accept: */*`标题。这会导致您的网站返回 RSS。（我不知道它*为什么*这样做）。如果您在没有 Accept 标头的情况下尝试它，那么它会按预期工作。

# syntax - := 运算符是什么？

> ID：10405820
> 
> 赞同：23
> 
> 时间：2012-05-01T23:38:08.763
> 
> 标签：syntax, programming-languages, operator-keyword, colon-equals

在某些编程语言中，我看到（例如）：

```
x := y 
```

这个`:=`操作符一般叫什么，它有什么作用？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-01T23:40:47.410

在所有支持运算符的语言中，`:=`这意味着赋值。

*   在支持运算符`:=`的语言中，`=`运算符通常表示相等比较。
*   在`=`意味着赋值的语言中，`==`通常用于相等比较。

> 是什么`:=`意思`=`？

我不记得任何与 .`:=`含义相同的语言`=`。

* * *

在 MySQL中`:=`，`=`两者都用于[赋值](http://dev.mysql.com/doc/refman/5.6/en/assignment-operators.html)，但是它们不可互换，选择正确的取决于上下文。为了使事情更加混乱，`=`运算符也用于[比较](http://dev.mysql.com/doc/refman/5.6/en/comparison-operators.html#operator_equal)。赋值或比较的解释`=`也取决于上下文。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2019-05-03T14:03:21.920

这是 Python 3.8 中的一个新运算符，实际上在 BDFL Guido van Rossum 的提前退休中发挥了作用。

形式上，运算符允许所谓的“赋值表达式”。非正式地，算子被称为“海象算子”。

它允许在评估表达式的同时进行赋值。

所以这：

```
env_base = os.environ.get("PYTHONUSERBASE", None)
if env_base:
    return env_base 
```

可以缩短为：

```
if env_base := os.environ.get("PYTHONUSERBASE", None):
    return env_base 
```

[https://www.python.org/dev/peps/pep-0572/#examples-from-the-python-standard-library](https://www.python.org/dev/peps/pep-0572/#examples-from-the-python-standard-library)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-01T23:40:47.663

我通常在伪代码中更多地看到它，这意味着分配。因此 x := y 表示“将 x 的值设置为 y 的值”，而 x = y 表示“x 的值是否等于 y 的值？”

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-04-28T21:50:33.540

The symbol is called "becomes" and was introduced with IAL (later called Algol 58) and Algol 60\. It is the symbol for assigning a value to a variable. One reads `x := y;` as "x becomes y".

Using ":=" rather than "=" for assignment is mathematical fastidiousness; to such a viewpoint, "x = x + 1" is nonsensical. Other contemporary languages might have used a left arrow for assignment, but that was not common (as a single character) in many character sets.

Algol 68 further distinguished identification and assignment; `INT the answer = 42;` says that "the answer" is declared identically equal to 42 (i.e., is a constant value). In `INT the answer := 42;` "the answer" is declared as a variable and is initially assigned the value 42.

There are other assigning symbols, like `+:=`, pronounced plus-and-becomes; `x +:= y` adds y to the current value of x, storing the result in x.

(Spaces have no significance, so can be inserted "into" identifiers rather than having to mess with underscores)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-02T14:11:26.543

许多语言使用通用运算符。通常，它`=`是为变量赋值保留的，如果它是单独的，则不应在数学上下文中查看。尽管测试了 Java 和 Bash 等某些语言中的平等性`==`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-02T20:09:15.140

PL/I 有（有？）`=`和`:=`。`=`用于赋值和比较——编译器试图根据上下文找出你的意思。当/如果它决定在你真正意味着分配的地方进行比较，你可以使用`:=`强制分配。

例如，考虑`x=y=0;`在 C 中（例如），这意味着“将 0 分配给 y，然后将结果（也是 0）分配给 x”。

在 PL/I 中，这意味着将 y 与 0 进行比较，然后将该比较的布尔结果分配给 x（即，相当于`x = y == 0;`在 C 中）。如果你（理智，不像 PL/I 的设计者）想要表示“将 0 分配给 x 和 y”，你会使用`x = y := 0;`(或`x := y := 0;`)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-12T04:39:22.897

:= 意思是“设置等于”一个有语法的赋值

v := expr 将变量 «v» 的值设置为从表达式 «expr» 获得的值。

示例： X := B 将 X 的定义设置为 B 的值

# ruby-on-rails - 设计身份验证。宝石退出不像我预期的那样工作

> ID：10405821
> 
> 赞同：0
> 
> 时间：2012-05-01T23:38:16.923
> 
> 标签：ruby-on-rails, web-applications, login, devise

我将设计集成到我的应用程序中，这里是我认为对问题很重要的当前代码。

这是我的退出链接

```
<nav class="round">
        <ul>
            <li>
                <%= link_to "Home", root_path%>
            </li>
            <li>
                <%= link_to "Help (learn Bunch-It)", help_path %>
            </li>
            <% if signed_in? %>
            <li>
                <%= link_to "Sign out", destroy_user_session_path, :method => :delete %>
            </li>
            <li>
                <%= link_to "Profile "+current_user.user_name, user_path(current_user), :method => :delete %>
            </li>
            <%else%>
            <li>
                <%= link_to "Sign in", new_user_session_path %>
            </li>
            <%end%>
        </ul>
    </nav> 
```

然后路由.rb

```
devise_for :users

  #get "sessions/new"

  #get "session/new"

  resources :users
  #resources :sessions, :only => [:new, :create, :destroy]

  #get "users/new"

  get "pages/home"

  get "pages/contact"

  get "pages/about"

  get "pages/help"

  get "results/result"

  get 'tree/insertResult' => 'tree#insertResult'

  get "tree/deleteFolder" => 'tree#deleteFolder'

  get "tree/createFolder" => 'tree#createFolder'

  get "tree/deleteResult" => 'tree#deleteResult'

  match '/results' , :to => 'results#result'
  match '/contact' , :to => 'pages#contact'
  match '/about' , :to => 'pages#about'
  match '/help' , :to => 'pages#help'
  match '/home_index', :to => 'pages#home'
  #match '/signin', :to => 'sessions#new'
  #match '/signout', :to => 'sessions#destroy'
  root :to => 'pages#home' 
```

这是我的控制器功能。主页

```
class PagesController < ApplicationController

  def home
    @title = "Home"
    session[:return_to] = request.fullpath
    @page = request.path
    puts "Welcome home page"
  end
... 
```

最后这是我的个人资料网站控制器

```
class UsersController < ApplicationController
  before_filter :authenticate_user!, :only => :token

  def index

  end
  def token

  end
  def show
    @title = current_user.user_name
    @haveQuery = false
    if @newest_query = findNewestQuery
      @common_query = commonQuery
      @haveQuery = true
    else
      @haveQuery = false
    end
  end 
```

问题是，当我按下退出我的应用程序时，只需刷新个人资料网站或将我定向到个人资料网站，如果我目前在不同的网站上。但是我想被定向到我的应用程序的主页而不是个人资料页面。我做了我能想到但无法解决的任何事情。有什么小想法是送给我的礼物吗？:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T23:50:11.977

我的 rails 3.2 应用程序也遇到了同样的问题。我发现问题出在我的路由文件上。如果您仍然遇到问题，我建议您打开设计宝石并四处寻找。

```
 devise_for :users, :controllers => {:sessions => "user/sessions", :registrations => "user/registrations"}
  devise_scope :user do
    get '/login' => 'devise/sessions#new'
    get '/logout' => 'devise/sessions#destroy'
  end
  resources :user, :controller => "user"
  root :to => "home#index" 
```

在视图中是这样的

```
<%= link_to 'Logout', logout_path, :method => :delete %> 
```

用户模型看起来像这样

```
 class User
      # Include default devise modules. Others available are:
      # :token_authenticatable, :encryptable, :confirmable, :lockable, :timeoutable and :omniauthable
      devise :database_authenticatable, :registerable,
             :recoverable, :rememberable, :trackable, :validatable

      # Validations.
      validates_presence_of :email, :first_name, :last_name, :password
      validates_uniqueness_of :email, :case_sensitive => false
      attr_accessible :first_name, :last_name, :email, :password, :password_confirmation, :remember_me

     end 
```

编辑：检查这些东西的好方法

```
$ rake routes
DEPRECATION WARNING: ActiveSupport::Memoizable is deprecated and will be removed in future releases,simply use Ruby memoization pattern instead. (called from <top (required)> at /Users/telmate/Documents/tmp_H/hucker/config/application.rb:20)
MongoDB logging. Please note that logging negatively impacts performance and should be disabled for high-performance production apps.
MONGODB admin['$cmd'].find({:ismaster=>1}).limit(-1)
        new_user_session GET    /users/sign_in(.:format)       user/sessions#new
            user_session POST   /users/sign_in(.:format)       user/sessions#create
    destroy_user_session DELETE /users/sign_out(.:format)      user/sessions#destroy
           user_password POST   /users/password(.:format)      devise/passwords#create
       new_user_password GET    /users/password/new(.:format)  devise/passwords#new
      edit_user_password GET    /users/password/edit(.:format) devise/passwords#edit
                         PUT    /users/password(.:format)      devise/passwords#update
cancel_user_registration GET    /users/cancel(.:format)        user/registrations#cancel
       user_registration POST   /users(.:format)               user/registrations#create
   new_user_registration GET    /users/sign_up(.:format)       user/registrations#new
  edit_user_registration GET    /users/edit(.:format)          user/registrations#edit
                         PUT    /users(.:format)               user/registrations#update
                         DELETE /users(.:format)               user/registrations#destroy
                   login GET    /login(.:format)               devise/sessions#new
                  logout GET    /logout(.:format)              devise/sessions#destroy
              user_index GET    /user(.:format)                user#index
                         POST   /user(.:format)                user#create
                new_user GET    /user/new(.:format)            user#new
               edit_user GET    /user/:id/edit(.:format)       user#edit
                    user GET    /user/:id(.:format)            user#show
                         PUT    /user/:id(.:format)            user#update
                         DELETE /user/:id(.:format)            user#destroy
                    root        /                              home#index 
```

这也是我的控制器，所以我们大部分时间都在同一页面上。

```
class User::SessionsController < Devise::SessionsController

  def new
    super
  end

  def create
     resource = warden.authenticate!(:scope => resource_name, :recall => "#{controller_path}#new")
     if is_navigational_format?
       if resource.sign_in_count == 1
         set_flash_message(:notice, :signed_in_first_time)
       else
         set_flash_message(:notice, :signed_in)
       end
     end
     sign_in(resource_name, resource)
     respond_with resource, :location => redirect_location(resource_name, resource)
   end  
end

class User::RegistrationsController < Devise::RegistrationsController

  def new
      super # no customization, simply call the devise implementation
    end

    def create
      begin
        super # this calls Devise::RegistrationsController#create
      rescue MyApp::Error => e
        e.errors.each { |error| resource.errors.add :base, error }
        clean_up_passwords(resource)
        respond_with_navigational(resource) { render_with_scope :new }
      end
    end

    def update
      super # no customization, simply call the devise implementation 
    end

    protected

    def after_sign_up_path_for(resource)
      new_user_session_path
    end

    def after_inactive_sign_up_path_for(resource)
      new_user_session_path
    end
end 
```

# r - 在ggplot2中更改图例键中的符号

> ID：10405823
> 
> 赞同：13
> 
> 时间：2012-05-01T23:38:22.230
> 
> 标签：r, ggplot2, legend

如何更改 geom_text 图例键符号？在下面的示例中，我想将图例键中的符号从小写“a”更改为大写“N”。我已经查看了一个在[此处执行类似](https://stackoverflow.com/questions/7634276/replacing-ggplot2-legend-key-for-geom-line-with-symbol)操作的示例，但无法使该示例正常工作。

```
# Some toy data
df <- expand.grid(x = factor(seq(1:5)), y = factor(seq(1:5)), KEEP.OUT.ATTRS = FALSE)
df$Count = seq(1:25)

# An example plot
library(ggplot2)
ggplot(data = df, aes( x = x, y = y, label = Count, size = Count)) + 
   geom_text() +
   scale_size(range = c(2, 10)) 
```

![在此处输入图像描述](../Images/8c90567715a62adf90325e1f1f0cd420.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-02T06:49:27.053

**编辑：更新 ggplot 版本 0.9.2**

最初的答案（见下文）在大约 0.9.0 或 0.9.1 版本时中断。以下适用于 0.9.2

```
# Some toy data
df <- expand.grid(x = factor(seq(1:5)), y = factor(seq(1:5)), KEEP.OUT.ATTRS = FALSE)
df$Count = seq(1:25)

# A plot
library(ggplot2)
p = ggplot(data = df, aes( x = x, y = y, label = Count, size = Count)) + 
   geom_point(colour = NA) +
   geom_text(show.legend = FALSE) +  
   guides(size = guide_legend(override.aes = list(colour = "black", shape = utf8ToInt("N")))) +
   scale_size(range = c(2, 10))

p 
```

**原始答案** 回答我自己的问题并使用上面@kohske 评论中的代码片段：

```
# Some toy data
df <- expand.grid(x = factor(seq(1:5)), y = factor(seq(1:5)), KEEP.OUT.ATTRS = FALSE)
df$Count = seq(1:25)

# A plot
library(ggplot2)
p = ggplot(data = df, aes( x = x, y = y, label = Count, size = Count)) + 
    geom_text() +
    scale_size(range = c(2, 10))
p

library(grid)
grid.gedit("^key-[-0-9]+$", label = "N") 
```

![在此处输入图像描述](../Images/723c0552dd007cdc2610e68c7ab4fb62.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-21T06:49:43.303

`gtable`安装0.2.0 ( v 2.1.0) 版本后，可以使Kohske`ggplot2`的原始解决方案（见评论）工作。

```
# Some toy data
df <- expand.grid(x = factor(seq(1:5)), y = factor(seq(1:5)), KEEP.OUT.ATTRS = FALSE)
df$Count = seq(1:25)

# Load packages
library(ggplot2)
library(grid)

# A plot
p = ggplot(data = df, aes( x = x, y = y, label = Count, size = Count)) + 
    geom_text() +
    scale_size(range = c(2, 10))
p

grid.ls(grid.force()) 
grid.gedit("key-[-0-9]-1-1", label = "N") 
```

或者，要处理 grob 对象：

```
# Get the ggplot grob
gp = ggplotGrob(p)
grid.ls(grid.force(gp)) 

# Edit the grob
gp = editGrob(grid.force(gp), gPath("key-[1-9]-1-1"), grep = TRUE, global = TRUE,  
         label = "N")

# Draw it
grid.newpage()
grid.draw(gp) 
```

**另外一个选项**

修改几何

```
# Some toy data
df <- expand.grid(x = factor(seq(1:5)), y = factor(seq(1:5)), KEEP.OUT.ATTRS = FALSE)
df$Count = seq(1:25)

# Load packages
library(ggplot2)
library(grid)

# A plot
p = ggplot(data = df, aes( x = x, y = y, label = Count, size = Count)) + 
    geom_text() +
    scale_size(range = c(2, 10))
p

GeomText$draw_key <- function (data, params, size) { 
   pointsGrob(0.5, 0.5, pch = "N", 
   gp = gpar(col = alpha(data$colour, data$alpha), 
   fontsize = data$size * .pt)) }

p 
```

# windows - 如何检查文件在回收站中的时间？

> ID：10405832
> 
> 赞同：0
> 
> 时间：2012-05-01T23:38:57.860
> 
> 标签：windows, windows-7, recycle-bin

作为测试，我编写了一个递归查找的.NET 脚本，`C:\$Recycle.Bin`并且我想在文件存在 X 天后删除它们。

我决定检查访问时间，但访问时间不会在移动中更新。我如何检查文件是否已在那里存在 X 段时间？（我使用的是 Windows 7）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T13:49:05.860

这个 c# 版本可能会有所帮助：

```
var Shl = new Shell(); Folder Recycler = Shl.NameSpace(10); 
FI = Recycler.Items().Item(0);   
string FileName = Recycler.GetDetailsOf(FI, 0); 
string FilePath = Recycler.GetDetailsOf(FI, 1); 
string RecyleDate = Recycler.GetDetailsOf(FI, 2); 
```

# python - 与排序时间对应的递增数组

> ID：10405834
> 
> 赞同：0
> 
> 时间：2012-05-01T23:39:06.630
> 
> 标签：python

我想创建一个具有与该特定时间相对应的特定数组增量的表。例如：

```
n     sec
100    0.2
200    0.4
etc.. 
```

Y是特定数组的尝试次数，n是数组大小，增量是特定增量

```
if sortfunction==1:
            i=0
            while i<y:
                dt=0
                for i in range(n):
                    i=i+increment
                    dt+=sort_timehelp(x,quick_sort)
                    output="%d %f\n" %(i,dt)
                    print output 
```

例如，如果我将 N 设为 1000 并增加 100，那么它看起来就像上表。

现在我得到：

```
n    sec
100  0.001
101  0.0012
102  0.0014 
```

等等它按1而不是增量大小

编辑：我有另一个问题：为什么这个 while 循环不会更多次？

```
 i=0
   while i<y:
        i=i+1
        dt=0
        for i in xrange(increment, n+increment, increment):
                dt+=sort_timehelp(x, quick_sort)
                output="%d %f\n" %(i,dt)
                print output 
```

i 是数组测试的数量。为什么它不去，例如 2 次

编辑：没关系我用 for 循环代替。我有最后一个问题。如果我有很多这样的 if 语句怎么办，唯一的区别是排序函数，那么我如何将所有这些东西保存到文件中，因为当我尝试时它只会保存最后一个打印的语句

```
#
 saving=input("You want to save data ? type 0 to continue or 1 to save " )
 if saving == 0:
        continue
 if saving == 1:
        ask=raw_input("Type the name file: ")
        fileout=open(ask+".csv","a")
        fileout.write(output)
        fileout.close() 
```

“保存”的缩进与sortfunction相同

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:56:54.313

range(n) 函数返回一个列表 [0,1,2,...]，然后 for 循环对其进行迭代。因此，当 i 为 0 并且您的 do 时`i=i+increment`，您的 i (100) 值被丢弃，并替换为列表的下一个元素 - 即 1。

您可以改为尝试`for i in range(increment,n+increment,increment)`，然后删除 for 块中的第一行。range 函数本身将添加`increment`循环的每次迭代 - 即 i 将是 100,200,300,...,1000

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:49:30.100

```
for i in xrange(increment, (n+1)*increment, increment):
    dt+=sort_timehelp(x,quick_sort)
    output="%d %f\n" %(i,dt)
    print output 
```

# c++ - static_assert 不能将 const char* 模板参数识别为 constexpr: g++ 错误？

> ID：10405835
> 
> 赞同：8
> 
> 时间：2012-05-01T23:39:07.567
> 
> 标签：c++, templates, c++11, constexpr, static-assert

考虑下面的定义。

```
char right_string[]="::right_one.";
char wrong_string[]="::wrong_one.";

template<const char* str>
void f(){
    static_assert(str==::right_string, "Pass me ::right_string!");
}

struct Test{

    static constexpr char right_string[]="template_struct::right_one";
    static constexpr char wrong_string[]="template_struct::wrong_one";

    template<const char* str>
    static void f(){
        static_assert(str==right_string, "Pass me template_struct::right_string!");
    }

};

int main(){
    f< ::right_string>();           //compiles, as expected
    f< ::wrong_string>();           //does not compile, as expected
    Test::f<Test::right_string>();  //compiles, as expected
    Test::f<Test::wrong_string>();  //error in Test::f: non-constant condition for static assertion
} 
```

完整的错误是

> ../main.cpp:16:3：错误：静态断言的非常量条件
> 
> ../main.cpp:16:3: 错误：'(((const char*)(& Test::wrong_string)) == ((const char*)(& Test::right_string)))' 不是常量表达式

我相信这是一个编译器错误，因为根据我作为模板参数传递的内容（无论是还是）`constexpr`，表达式的内在变化是没有意义的。`static_assert``Test::right_string``Test::right_string`

我已经发现 g++ 4.6在将地址作为模板参数处理时[有些缺陷。](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=53009)这是同一错误的实例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T17:14:37.777

这是一个 g++ 错误，（至少）在 4.7 中修复。

# objective-c - 方法调用的参数太多

> ID：10405837
> 
> 赞同：1
> 
> 时间：2012-05-01T23:39:30.990
> 
> 标签：objective-c, iphone, xcode, compiler-errors, arguments

我正在尝试使用我的 appDelegate 中的 NSString 为我的应用程序中的 twitter 消息应该说的内容设置初始文本。在此处查看代码：

```
 NSString *tweet;
tweet=[MyWebFunction tweet:appDelegate.stadium_id];

if([deviceType hasPrefix:@"5."]){

    // Create the view controller
    TWTweetComposeViewController *twitter = [[TWTweetComposeViewController alloc] init];

    [twitter setInitialText:@"@%",tweet]; 
```

问题是，twitter setInitialText 是否存在错误，即方法调用的参数太多，预期为 1，有 2。？！？！？

任何帮助是极大的赞赏。:)

![截屏](../Images/ce386151bbc1bc7475ae2a20429407cf.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T23:47:06.527

该`TWTweetComposeViewController`方法`setInitialText`只接受一个参数，类型为`NSString*`。您不能像使用方法那样简单地格式化传递给方法的任何和所有变量`NSString`（我想，您已经看到了语法）。`NSString``stringWithFormat``[NSString stringWithFormat:@"%@", myString]`

在您的情况下，您需要简单地调用：

```
[twitter setInitialText:tweet]; 
```

或致电：

```
[twitter setInitialText:[NSString stringWithFormat:@"%@", tweet]] 
```

**编辑**
我觉得有必要补充一点，以加深您的理解，当方法`stringWithFormat`的声明以`...`

例如，在文档中寻找这样声明的`NSString`揭示：`stringWithFormat`

```
+(id) stringWithFormat:(NSString *)format, ...; 
```

同样，`arrayWithObjects`in`NSArray`被声明为：

```
+(id) arrayWithObjects:(id)firstObj, ...; 
```

哪个会使用：

```
NSString* myString1 = @"foo";
NSString* myString2 = @"bar";
NSNumber* myNumber = [NSNumber numberWithInt:42];
NSArray* myArray = [NSArray arrayWithObjects:myString1, myString2, myNumber, nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:44:55.623

尝试`[twitter setInitialText:tweet];`

如果您确实需要格式化文本来处理更复杂的情况，请尝试

`[twitter setInitialText:[NSString stringWithFormat:@"%@", tweet]];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T15:17:58.633

```
"[twitter setInitialText:@"@%",tweet];" 
```

你只是把你的“@”和你的“%”弄错了

```
[twitter setInitialText:@"**%@**",tweet]; 
```

# c++ - 使用“double”输出带两位小数的值

> ID：10405841
> 
> 赞同：0
> 
> 时间：2012-05-01T23:40:07.190
> 
> 标签：c++, double

我正在开发一个程序，该程序根据用户输入的值输出花费在汽油上的总金额。我希望它输出一个小数点后 2 位的值，但程序会舍入总数，而不是输出总数应该是多少。我是初学者，不知道为什么它不能正常工作。

```
double gasPrice = 3.87;
double gallonsPumped = 0;

cout<<"How many gallons of gasoline (Diesel) were purchased today:"<<endl;
cin>>gallonsPumped;
int finalGasPrice = gasPrice*gallonsPumped;

cout<<endl;

if (gallonsPumped >= 1)
{
    cout<<endl<<"The total cost for gasoline today was $"<<finalGasPrice<<"."<<endl;
}
else
{
    cout<<"No money spent on gasoline today.";
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T23:46:27.640

int 类型是一个整数——即没有小数位，因此乘法向下舍入到最接近的整数。

您想使用浮点数或双精度数： `double finalGasPrice = gasPrice*gallonsPumped;`

要使输出格式在小数点后精确显示两位数，您可能需要使用以下内容： `cout << setiosflags(ios::fixed) << setprecision(2) << finalGasPrice;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T23:49:17.777

整数只能包含整数：没有小数或分数。因此，当您设置 finalgasprice 时，结果将被截断为整数。将 finalgasprice 初始化为 double 将解决此问题。您还应该将“>= 1”更改为“>= 0”，除非您希望不到一美元的付款不被注意。

# php - 在 ubuntu 服务器 5.3.6-13ubuntu3.6 上安装 xdebug 2.1.4

> ID：10405848
> 
> 赞同：2
> 
> 时间：2012-05-01T23:40:53.523
> 
> 标签：php, ubuntu, xdebug

我试图在我的 ubuntu 服务器机器上安装 xdebug，但它不工作。我知道它不起作用的原因是 var_dump 的输出没有着色，我也无法使用 netbeans 连接到它。

我遵循了关于如何安装 xdebug 的定制说明

```
http://xdebug.org/wizard.php 
```

这是我的 phpinfo 分析的输出：

```
Xdebug installed: no
Server API: Apache 2.0 Handler
Windows: no
Zend Server: no
PHP Version: 5.3.6-13
Zend API nr: 220090626
PHP API nr: 20090626
Debug Build: no
Thread Safe Build: no
Configuration File Path: /etc/php5/apache2
Configuration File: /etc/php5/apache2/php.ini
Extensions directory: /usr/lib/php5/20090626 
```

向导推荐的文件名是 xdebug-2.1.4.tgz

phpize 的输出是

```
Configuring for:
PHP Api Version:         20090626
Zend Module Api No:      20090626
Zend Extension Api No:   220090626 
```

我的 phpinfo 现在确实显示已安装 xdebug，如下所示：

![在此处输入图像描述](../Images/4c56c045b1abaccc590df9ccf0a6bc69.png)

这是我的 php.ini 中的内容

```
zend_extension = /usr/lib/php5/20090626/xdebug.so
xdebug.profiler_output_dir = "/var/log/apache2/xdebug"
xdebug.profiler_output_name = "cachegrind.out.%p"
xdebug.profiler_enable =1
xdebug.profiler_append=1
xdebug.extended_info=1
xdebug.remote_enable=1
xdebug.remote_handler="dbgp"
xdebug.remote_mode=req
xdebug.remote_host=192.168.2.13
xdebug.remote_port=9000
;xdebug.idekey=xdebug
xdebug.idekey=netbeans-xdebug
xdebug.remote_connect_back=1
xdebug.remote_log="/var/log/apache2/xdebug_remote.log"
xdebug.show_exception_trace=0
xdebug.show_local_vars=9
xdebug.show_mem_delta=0 
```

lsb_release -a 在我的电脑上的输出是

```
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 11.10
Release:        11.10
Codename:       oneiric 
```

phpinfo 上显示的 PHP 版本是 5.3.6-13ubuntu3.6

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T09:14:47.797

对于颜色，您可能还想`html_errors=1`在 php.ini 中进行设置。

至于 netbeans 问题（你真的不应该将问题组合在一个问题中！），你的机器运行 PHP 有哪些 IP 地址，运行 netbeans 的机器有哪些 IP 地址？xdebug.remote_host 设置应该包含正在运行的 netbeans 的 IP 地址。您正在生成的远程日志文件中也应该有连接尝试。

# perl - =~ 在 Perl 中是什么意思？

> ID：10405868
> 
> 赞同：12
> 
> 时间：2012-05-01T23:43:54.407
> 
> 标签：perl, operators

> **可能重复：**
> [=~ 在 Perl 中做什么？](https://stackoverflow.com/questions/10019049/what-does-this-do-in-perl)

在我正在检查的一个 Perl 程序（名称为[plutil.pl](http://scw.us/iPhone/plutil/plutil.pl)`=~` ）中，我在 XML 解析器部分看到了很多内容。例如，这里是函数`UnfixXMLString`（`159`到`167`1.7 的行（`$VERSION`错误地声明为“1.5”））：

```
sub UnfixXMLString {
    my ($s) = @_;

    $s =~ s/&lt;/</g;
    $s =~ s/&gt;/>/g;
    $s =~ s/&amp;/&/g;

    return $s;
} 
```

据我所知，它的 C 原型是 (C-like) `string UnfixXMLString(string s)`，它`=~`在参数 ( `s`) 上使用运算符，然后返回修改后的字符串，但它在做什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-01T23:47:10.590

`=~`是 Perl[绑定运算符](http://perldoc.perl.org/perlop.html#Binding-Operators)。它通常用于将正则表达式应用于字符串；例如，测试一个字符串是否匹配一个模式：

```
if ($string =~ m/pattern/) { 
```

或者从字符串中提取组件：

```
my ($first, $rest) = $string =~ m{^(\w+):(.*)$}; 
```

或应用替换：

```
$string =~ s/foo/bar/; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T23:57:48.490

`=~`是 Perl 绑定运算符，可用于确定是否发生正则表达式匹配（真或假）

```
$sentence = "The river flows slowly.";
if ($sentence =~ /river/)
{
    print "Matched river.\n";
}
else
{
    print "Did not match river.\n";
} 
```

# java - 如何停止 Android 中另一个应用程序的服务？

> ID：10405876
> 
> 赞同：6
> 
> 时间：2012-05-01T23:44:39.007
> 
> 标签：java, android, service, android-service, scheduler

在我的设备上运行一个应用程序中的服务（它不是我的应用程序，我无法卸载它并且我的设备没有植根），它总是在消耗电量。我可以在我的设备应用程序设置中停止该服务，但有没有办法以编程方式停止它，所以我不必一直手动执行此操作？

可能类似于**stopService(...);** 工作 ？

有没有办法更改调度程序以防止服务重新启动？

```
"W/ActivityManager(178): Scheduling restart of crashed service xxxx in 5000ms 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:01:46.740

获取该特定应用程序的进程 ID，然后

android.os.Process.killProcess(processIdKillService)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:39:12.267

这是一个长镜头（我从未尝试过）：

1.  `Context`使用为该应用程序创建一个实例[`Context.createPackageContext()`](http://developer.android.com/reference/android/content/Context.html#createPackageContext%28java.lang.String,%20int%29)
2.  用它来停止服务[`Context.stopService()`](http://developer.android.com/reference/android/content/Context.html#stopService%28android.content.Intent%29)

# jquery - 改变输入值

> ID：10405877
> 
> 赞同：0
> 
> 时间：2012-05-01T23:44:41.253
> 
> 标签：jquery, html

好的，我有这个代码

```
<input id=a value=test />
<textarea id=b></textarea>
<script>
$(function () {
var value = $('input#a').val();
$('textarea#b').val(value);
});
</script> 
```

所以问题是当有人更改输入值时如何更改文本区域的值？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:49:26.510

**HTML**

```
<input id="txt" value="" />
<textarea id="txtA"></textarea>​ 
```

**JS**

```
$(function(){
    $('#txt').on('keyup', function(e){
        $('#txtA').val($(this).val());
    });
});​ 
```

[**演示。**](http://jsfiddle.net/heera/5pnRn/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:47:33.640

```
$('#a').change(function() { $('#b').val($(this).val()); }); 
```

（编辑：id 选择器而不是标签选择器）

# javascript - 将焦点设置到 jQuery UI 多选小部件中的过滤器输入

> ID：10405881
> 
> 赞同：3
> 
> 时间：2012-05-01T23:45:12.263
> 
> 标签：javascript, jquery, html, multi-select

我正在编写一个小脚本，它将焦点设置到多选 jquery 小部件的过滤器文本输入字段。根据文档，我可以像这样订阅小部件的点击事件：

```
// bind to event
$("#multiselect").bind("multiselectopen", function(event, ui){
    // event handler here
}); 
```

所以我尝试了这个：

```
$("#MyStatusWidget").bind("multiselectopen", function(event, ui){
            // event handler here
            $(this).$(".ui-multiselect-filter").contents('input :text').focus());
        }); 
```

这是小部件的链接： [http ://www.erichynds.com/jquery/jquery-ui-multiselect-widget/](http://www.erichynds.com/jquery/jquery-ui-multiselect-widget/)

我还尝试了其他几种方法（$('').is(':text'); 等），但无法解决问题。

这是HTML：

```
<div class="ui-widget-header ui-corner-all ui-multiselect-header ui-helper-clearfix ui-multiselect-hasfilter">
<div class="ui-multiselect-filter">
Filter:
<input type="search" placeholder="Enter keywords">
</div>
<ul class="ui-helper-reset">
</div> 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T19:42:01.457

我知道这有点旧，但就我而言，我在页面上有很多这些小部件。所以我做了一些不同的东西，效果很好。

```
$("#MyStatusWidget").multiselect({
    open: function () {
        $(this).multiselect("widget").find("input[type='search']:first").focus();               
    }
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-07T20:04:10.867

创建多选小部件时，只需添加以下“打开”方法。

```
$("#MyStatusWidget").multiselect({
    open: function () {
        $("input[type='search']:first").focus();                   
    }
}); 
```

对于 IE10 浏览器：

```
$("#MyStatusWidget").multiselect({
    open: function () {
        $("input[type='text']:first").focus();                   
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-04T17:52:37.457

我还没有尝试过前两种解决方案来查看 rrusnak 的问题是否存在。我的解决方案没有任何 rrusnak 提到的其他问题。这个可以在页面上使用无限数量的选择器，并使用简单的 jQuery 以及 Eric Hynds 建议将他的多选过滤器系统实现到多选小部件：

```
$("#MyStatusWidget").multiselect({
open: function () {
  $(this).multiselectfilter("widget").find('input').focus();
  }
  }).multiselectfilter({
  label: '',
  autoReset: true
}); 
```

它干净，可以与其他小部件选项链接，并立即允许文本输入，而无需先单击输入过滤器。

IMO Eric 应该在他的过滤器脚本中包含一个自动焦点 - 因为在小部件上使用过滤器意味着无论如何都要使用它。因此，必须手动关注输入字段对于用户来说是不必要的点击。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-08T16:36:15.450

以上两个答案对我有用，但是当过滤器聚焦时，插件会发生一些令人讨厌的事情。最值得注意的是，您不能再使用箭头键来选择一个选项，这确实会剥夺键盘控制权。

我已经实现了一些更改，您可以在下面的 github 链接中找到这些更改。

1.  修复表单的选项卡问题
2.  允许在选择过滤器时使用箭头键选择选项
3.  我已将遍历功能更改为对过滤列表友好。
4.  我已更改遍历功能，以便在使用向上箭头时一次向上移动一个选择（而不是转到列表顶部）
5.  按“f”（或“ctrl-f”）将重新聚焦在过滤器框上

希望这可以帮助任何与我有相同问题的人。更改在常规多选以及过滤器 src 文件中。

[https://github.com/rrusnak1/jquery-ui-multiselect-widget](https://github.com/rrusnak1/jquery-ui-multiselect-widget)

# c#-4.0 - MongoDb 中的继承：如何请求已定义类型的实例

> ID：10405887
> 
> 赞同：4
> 
> 时间：2012-05-01T23:46:20.180
> 
> 标签：c#-4.0, mongodb, polymorphism, mongodb-.net-driver, mongodb-query

这就是我过去在实体框架 (POCO) 中利用继承的方式：

```
ctx.Animals // base class instances (all instances)
ctx.Animals.OfType<Cat>  // inherited class Cat's instances only
ctx.Animals.OfType<Dog> // inherited class Dog's instances only 
```

这是我在 MongoDb（[MongoDb 参考](http://www.mongodb.org/display/DOCS/CSharp+Driver+Serialization+Tutorial)）中找到的唯一类似方式：

```
var query = Query.EQ("_t", "Cat");
var cursor = collection.FindAs<Animal>(query); 
```

请注意，在后一种情况下，我必须处理鉴别器（“_t”）并对我的类名进行硬编码，这不太方便而且看起来很糟糕。如果我错过了查询，我会在枚举尝试时遇到异常。我错过了什么吗？我的建议是“按原样”存储对象的文档 Db 应该轻松处理继承。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-03-17T18:18:41.080

假设您的鉴别器正在运行（_t 为每个文档正确存储），那么我认为这就是您正在寻找的。

```
var results = collection.AsQueryable<Animal>().OfType<Cat> 
```

仅返回那些类型为“Cat”的文档。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-02T07:06:43.787

好吧，文档数据库实际上确实“按原样”存储对象——即没有属于某个特定类的对象的概念。这就是为什么`_t`当您希望反序列化器知道要实例化哪个子类时需要。

在您的情况下，我建议您为每个子类提出一个*鉴别*器，而不是依赖于类名。这样，您可以重命名类等，而不必担心某处的硬编码字符串。

你可以这样做：

```
public abstract class SomeBaseClass
{
    public const string FirstSubClass = "first";
    public const string SecondSubClass = "second";
}

[BsonDiscriminator(SomeBaseClass.FirstSubClass)]
public class FirstSubClass { ... } 
```

接着

```
var entireCollection = db.GetCollection<FirstSubClass>("coll");

var subs = entireCollection.Find(Query.Eq("_t", SomeBaseClass.FirstSubClass)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T16:22:56.423

From [your link](http://docs.mongodb.org/ecosystem/tutorial/serialize-documents-with-the-csharp-driver/):

> The one case where you must call RegisterClassMap yourself (even without arguments) is when you are using a polymorphic class hierarchy: in this case you must register all the known subclasses to guarantee that the discriminators get registered.

Register class maps for your base class and each one of your derived classes:

```
BsonClassMap.RegisterClassMap<Animal>();
BsonClassMap.RegisterClassMap<Cat>();
BsonClassMap.RegisterClassMap<Dog>(); 
```

Make sure that your collection is of type of your base class:

```
collection = db.GetCollection<Animal>("Animals"); 
```

Find using your query. The conversion to the corresponding child class is done automatically:

```
var query = Query.EQ("_t", "Cat");
var cursor = collection.Find(query); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-03T10:00:44.110

如果唯一关心的是硬编码类名，您可以执行以下操作：

```
collection = db.GetCollection<Animal>("Animals");
var query = Query.EQ("_t", typeof(Cat).Name);
var cursor = collection.Find(query); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-19T09:55:38.800

查看文档 [http://docs.mongodb.org/ecosystem/tutorial/serialize-documents-with-the-csharp-driver/#scalar-and-hierarchical-discriminators](http://docs.mongodb.org/ecosystem/tutorial/serialize-documents-with-the-csharp-driver/#scalar-and-hierarchical-discriminators)

您可能选择使用分层鉴别器的主要原因是因为它可以查询层次结构中任何类的所有实例。例如，要读取我们可以编写的所有 Cat 文档：

```
var query = Query.EQ("_t", "Cat");
var cursor = collection.FindAs<Animal>(query);
foreach (var cat in cursor) {
    // process cat
} 
```

# c++ - Connect 4 Board 中的不均匀圆圈

> ID：10405890
> 
> 赞同：0
> 
> 时间：2012-05-01T23:46:35.347
> 
> 标签：c++, winapi, math, gdi+

我正在创建一个 2P Connect 4 游戏，但我似乎无法让圆形区域均匀地放置令牌。

这是初始化每个圆的位置的代码：

```
POINT tilePos;

for (int i = 0; i < Board::Dims::MAXX; ++i) 
{
    tileXY.push_back (std::vector<POINT> (Board::Dims::MAXY)); //add column

    for (int j = 0; j < Board::Dims::MAXY; ++j)
    {
        tilePos.x = boardPixelDims.left + (i + 1./2) * (boardPixelDims.width / Board::Dims::MAXX);
            tilePos.y = boardPixelDims.top + (j + 1./2) * (boardPixelDims.height / Board::Dims::MAXY);

        tileXY.at (i).push_back (tilePos); //add circle in column
    }
} 
```

我使用`POINT`s,的 2D 向量`tileXY`来存储位置。回想一下，棋盘宽 7 圈，高 6 圈。

我的逻辑是，第一个圆圈（对于 X）从以下位置开始：

```
left + width / #circles * 0 + width / #circles / 2 
```

`width / #circles`并且每次都增加，这对于较小数量的圆圈很容易描绘。

后来，我画了这样的圆圈：

```
for (const std::vector<POINT> &col : _tileXY)
{
    for (const POINT pos : col)
    {
        if (g.FillEllipse (&red, (int)(pos.x - CIRCLE_RADIUS), pos.y - CIRCLE_RADIUS, CIRCLE_RADIUS, CIRCLE_RADIUS) != Gdiplus::Status::Ok)
            MessageBox (_windows.gameWindow, "FillEllipse failed.", 0, MB_SYSTEMMODAL);
    }
} 
```

这些循环遍历向量的每个元素，并用红色绘制每个圆圈（此时突出）。int 转换是为了消除函数调用的歧义。刷后的前两个参数是左上角，`CIRCLE_RADIUS`是50。

问题是我的电路板看起来像这样（对不起，如果它有点伤害你的眼睛）：

![圆圈离得太远了。](../Images/06d51ec40c6a6a9d6b5637cbd9c3e4f0.png)

正如你所看到的，这些圆圈太左太高了。它们也太小了，但这很容易解决。我尝试将一些整数更改为双精度数，但最终以这是我最接近真实模式的结果。位置的扩展公式（扩展 (i + 1./2)）看起来也一样。

我错过了一个小细节，还是我背后的整个逻辑都没有？

**编辑：** 根据要求，类型：

`tilePos.x`: POINT (windows API一，使用的类型是LONG)
`boardPixelDims.*`: double
`Board::Dims::MAXX/MAXY`: 枚举值(整数，分别包含7和6)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:33:22.970

根据 CIRCLE_SIZE 是打算用作半径还是直径，您的两个参数在 FillEllipse 调用中似乎是错误的。如果它是一个直径，那么您应该将位置设置为`pos.x - CIRCLE_SIZE/2`and `pos.y - CIRCLE_SIZE/2`。如果是半径，则高度和宽度参数应分别为 2*CIRCLE_SIZE 而不是 CIRCLE_SIZE。

更新 - 由于您将变量名称更改为 CIRCLE_RADIUS，后一种解决方案现在显然是正确的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T05:09:10.373

我记得形状相关函数采用什么参数的最简单方法是始终以矩形思考。FillEllipse 只会绘制一个椭圆来填充您给它的矩形。x、y、宽度和高度。

一个简单的练习实验是，如果您将调用更改为 FillRect，让所有位置都正常，然后将它们更改为 FillEllipse。

# php - 按键的值对数组排序

> ID：10405895
> 
> 赞同：0
> 
> 时间：2012-05-01T23:47:14.093
> 
> 标签：php

这是我当前要添加到数组中的代码：

```
foreach ($query->result() as $exp) {
    $activities[] = array('type' => 'level', 'exp' => $exp->exp, 'timestamp' => $badge->timestamp);
} 
```

我将如何根据“时间戳”键的值对该数组进行排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:50:13.107

您需要使用`usort`which 可以让您使用用户定义的函数对数组进行排序。

[http://www.php.net/manual/en/function.usort.php](http://www.php.net/manual/en/function.usort.php)

例子：

```
<?php
function cmp($a, $b)
{
    if ($a == $b) {
        return 0;
    }
    return ($a < $b) ? -1 : 1;
}

$a = array(3, 2, 5, 6, 1);

usort($a, "cmp"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:56:08.430

我会使用函数 array-multisort 进行实际排序，我也会以不同的方式存储值：

```
foreach ($query->result() as $exp) {
  $activities[$badge->timestamp] = array('type' => 'level',... );
}
array_multisort($activities, SORT_ASC, $array); 
```

[http://php.net/manual/en/function.array-multisort.php](http://php.net/manual/en/function.array-multisort.php)

# database - 数据库支持按功能更新而不是按值更新

> ID：10405903
> 
> 赞同：1
> 
> 时间：2012-05-01T23:47:49.020
> 
> 标签：database

期望的行为：

在 Clojure 的代理实现中，要更新代理，不会发送新值。发送一个函数，在旧值上调用，返回值设置为Agent的新值。

这使某些事情变得容易：例如，如果我有一个队列，并且我有两个并发线程都想追加到队列中（而且我不在乎它们追加的顺序），每个线程都可以触发一个 ( fn [x] (cons x new_value)) ... 它就可以工作。然而，如果它是按值更新的，我必须进行某种比较和交换。

问题：

有没有支持这种更新的数据库？例如，我最近在看 MongoDB。但是，MongoDB 仅支持 $inc/$dec，不支持用于更新文档的任意函数。

谢谢！

PS——我不需要事务/ACID/BASE/……我真正想要的只是一个简单的文档存储，它支持通过函数而不是值进行更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T10:27:46.753

MongoDB 实际上支持多种不同的修饰符操作（[此处](http://www.mongodb.org/display/DOCS/Updating#Updating-ModifierOperations)为完整列表），虽然我可以看到单独的 $inc/$dec 可能会受到限制，但您给出的添加到队列的特定示例的简单变体可以使用 $push 或 $addToSet 来处理（取决于您是否希望重复项出现在队列中，因为 $addToSet 只会在它不存在的情况下添加一个值）。

对于更复杂的情况（支持比较和交换语义类型），如果您没有找到完全符合您需求的简单内容，您可以查看 MongoDB中的[findAndModify 命令。](http://www.mongodb.org/display/DOCS/findAndModify+Command)

# c++ - gsl中的matlab mvrnd

> ID：10405905
> 
> 赞同：0
> 
> 时间：2012-05-01T23:48:00.397
> 
> 标签：c++, c, matlab, gsl

嗨，我不确定我的算法是否正确我正在尝试复制 matlab 的[mvnrnd](http://www.mathworks.com/help/toolbox/stats/mvnrnd.html)函数，但在 gsl 中。我在一些期刊文章中发现了一种算法，它产生了一个多元正态向量，但我需要一个多元正态随机数矩阵

假设分布是 Z~(mu,sigma);

假设 sigma 是一个已经是正定的矩阵。

**我在网上找到的一个算法说**

```
1\. cholskey(sigma) = A
2\. generate uniform gaussian vector r
3\. matrix vector triangular product with gsl_blas_dtrmv A * r
4\. add mu to Ar and that will be a vector of multivariate normal random numbers 
```

**我的方法如下**

**以下更改是否正确生成随机变量矩阵**

```
 1\. cholskey(sigma) = A
    2\. generate uniform gaussian matrix R
    3\. matrix matrix scalar product AR
    4\. add mu to AR and that will be a matrix of multivariate normal random numbers 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:24:24.377

对，那是正确的。参见例如[这个 Wikipedia entry on multivariate normal RNGs](http://en.wikipedia.org/wiki/Multivariate_normal_distribution)，它有这个部分：

> 从分布中提取值
> 
> 一种广泛使用的从 N 维多元正态分布中绘制随机向量 x 的方法，其中均值向量 μ 和协方差矩阵 Σ 工作如下：
> 
> 1.  找到任何实矩阵 A 使得 A AT = Σ。当 Σ 为正定时，通常使用 Cholesky 分解。[...]
>     
>     
> 2.  令 z = (z1, ..., zN)T 是一个向量，其分量是 N 个独立的标准正态变量（例如，可以使用 Box–Muller 变换生成）。
>     
>     
> 3.  令 x 为 μ + Az。由于仿射变换特性，这具有所需的分布。

它描述了相同的算法。

[R](http://www.r-project.org)也有几个实现，例如`mvrnorm`在每个 R 安装附带的[MASS包中。](http://cran.r-project.org/package=MASS)

# bash - bash 脚本数组

> ID：10405910
> 
> 赞同：1
> 
> 时间：2012-05-01T23:48:21.217
> 
> 标签：bash

```
array=('org.battery.plist' 'org.disk.plist' 'org.memory.plist');

echo "1) org.battery.plist"
echo "2) org.disk.plist"
echo "3) org.memory.plist"

echo "Enter selection(s) to load, separated by commas: "
read var

sudo launchctl load -w ${array[$var]} 
```

我在正确的轨道上吗？我有点卡住了。有人可以帮忙吗？

如果用户输入 1、2，我希望脚本在下面执行此操作 -

```
sudo launchctl load -w org.disk.plist
sudo launchctl load -w org.memory.plist 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:00:58.487

试试这个，

```
IFS=","
for i in $var
do
    sudo launchctl load -w ${array[$i - 1]}
done 
```

您还需要检查输入是否超出数组范围以及抛出和错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:04:54.360

令人惊讶的是，bash 中有一个用于此类选择的内置函数，称为“选择”：

```
select entry in ${array[@]}; 
do  
    sudo launchctl load -w $entry
done 
```

试试`help select`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T11:28:21.650

这个更好：

```
array=('org.battery.plist' 'org.disk.plist' 'org.memory.plist');

for (( i=0;i<"${#array[@]}";i++ )) ; do
    let n=i+1
    printf '%d) %s\n' $n "${array[$i]}"
done

IFS=, read -r -p 'Enter selection(s) to load, separated by commas: ' -a selections

for selection in "${selections[@]}" ; do
    let selection=selection-1
    sudo launchctl load -w "${array[$selection]}"
done 
```

# python - 如何获得母语的语言名称？

> ID：10405915
> 
> 赞同：6
> 
> 时间：2012-05-01T23:49:06.033
> 
> 标签：python, icu

这是我第一次使用 ICU API，我很难找到一些我认为非常简单的东西：以*母语*（而不是英语）获取给定的语言环境/语言名称

例子：

```
fr    -> Français
en    -> English
pt_BR -> Português Brasileiro, or "Português (Brasil)"
es_ES -> Español Iberico, or "Español (España)" 
```

作为参考，`babel`我可以获得*任何*语言的给定语言环境名称，默认为原生：

```
>>> import babel
>>> locale = babel.Locale.parse('pt_BR')
>>> locale.get_display_name()
português (Brasil)
>>> locale.get_display_name('fr')
portugais (Brésil)
>>> locale.get_display_name('en')
Portuguese (Brazil) 
```

那么，在ICU中如何做同样的事情呢？python 中的示例非常受欢迎，因为我使用的是 PyICU，但 Java/C/C++ 也很好，因为我的问题在于 API，而不是语言。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T00:32:00.020

我刚刚发现：最好的方法是`getDisplayName()`，但是，我必须传递一个 Locale 实例，而不是传递一个字符串作为参数！

完整的代码如下：

```
>>> import icu
>>> locale = icu.Locale("pt_BR")
>>> print icu.getDisplayName()
u'portuguese (Brazil)'
>>> print icu.getDisplayName(locale)
u'portugu\xeas (Brasil)' 
```

因此，与 babel 不同的是，Locale 方法默认返回用户当前语言环境中的名称。我必须通过实例本身以获取本地语言的名称。因此，如果您想要使用*您的*语言（在我的情况下是英语）的名称，这很容易，但是如果我想要使用法语，例如，我将不得不创建一个新的 Locale 实例“fr_FR”。奇怪的API，但仍然......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T23:55:00.443

有一个 function `getDisplayLanguage`，它可以选择使用另一个语言环境的名称。我不知道 C-api 如何转换为 Python，但相关的 C 文档在[这里](http://icu-project.org/apiref/icu4c/uloc_8h.html#a3bf3527de225342853d1fe97503590f7)。

* * *

浏览 PyICU-docs，它似乎是这样的：

```
locale = Locale("pt_BR")
name = locale.getDisplayLanguage("en") 
```

* * *

查看[包装器 source](http://svn.osafoundation.org/pyicu/trunk/locale.cpp)，似乎`getDisplayLanguage`需要一个零、一或二元组。怎么样`getDisplayLanguage(("en",))`？我不熟悉 PyICU 代码库，所以我在这里猜测。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-25T20:33:32.597

```
#include <unicode/locid.h>
#include <unicode/ustream.h>
#include <iostream>

int main()
{
  Locale l("pt_BR");
  UnicodeString result;
  std::cout <<   l.getDisplayName(l, result) << std::endl;
} 
```

☛`português (Brasil)`

很抱歉您在使用 ICU API 时遇到了问题。你有什么澄清的建议吗？

# c# - 使用具有多个版本的 .Net 互操作

> ID：10405916
> 
> 赞同：0
> 
> 时间：2012-05-01T23:49:07.760
> 
> 标签：c#

我正在创建一个与公开 com 组件的应用程序交互的 C# 应用程序。我通过右键单击项目并添加对 COM 组件的引用来添加对该组件的引用。

它公开了一个类型库 1.13。

我的应用程序与组件的通信很好，直到我想用另一个版本的组件进行测试，我卸载了 COM 应用程序并安装了旧版本的 COM 应用程序。

现在我的项目没有构建，抱怨组件未注册等。

如果我删除具有版本 1.13 的旧互操作引用并为我的新安装（即 1.10）重新添加 COM 引用，它可以工作，但会扼杀我想要执行的多个版本使用一个互操作的想法。

我可以将我的应用程序限制为仅支持一系列 COM 应用程序版本，但我只想发布一个支持通用功能的互操作。

请告知如何在不添加多个互操作的引用的情况下将其合并到我的项目中。

谢谢，

# linq - Linq - 连接来自同一个表的 2 列的结果

> ID：10405928
> 
> 赞同：-1
> 
> 时间：2012-05-01T23:50:32.560
> 
> 标签：linq, linq-to-sql, entity-framework-4

我想加入表中的结果，以总结 2 个不同行的 where 条件的结果，如下代码：

```
 var a = (from o in _DB.Services
                where (o.description.Contains(searchText) || o.nom.Contains(searchText))
                orderby o.date
                select new { results = ?????, id = ?????? }).Take(maxResults).ToList(); 
```

我可以放什么，以考虑到结果=???? 和身份证=？？？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T08:43:52.693

根据您的评论，您不能只执行以下操作吗？

```
var a = (from o in _DB.Services
            where (o.description.Contains(searchText) || o.nom.Contains(searchText))
            orderby o.date
            select new  
                   { 
                       results = o.description,
                       id = o.nom
                   })
            .Take(maxResults)
            .ToList(); 
```

# php - 有没有更快的方法在客户端和服务器端查找所有图像、音频和视频文件类型

> ID：10405930
> 
> 赞同：0
> 
> 时间：2012-05-01T23:50:56.583
> 
> 标签：php, javascript

下面我有 3 个 javascript 函数，它们检查其文件的合法文件扩展名。问题是，如果我按照我实现它的方式进行操作，我将为每个函数提供一个非常大的 case 语句，说明哪些文件扩展名是合法使用的。所以我的问题是除了做

```
`case:jpeg: 
case:jpg:
case:png` 
```

等等。有没有一种快速的方法来创建一个案例陈述来检查所有合法的图像文件扩展名类型、所有合法的视频文件扩展名类型和所有合法的音频文件扩展名类型？

以下是我目前用于验证图像、视频和音频的文件扩展名类型的 3 个 javascript 函数：

图片：

```
 function imageValidation(imageuploadform) {

        var val = $(imageuploadform).find(".fileImage").val();
        switch(val.substring(val.lastIndexOf('.') + 1).toLowerCase()){
            case 'gif':
            case 'jpg': 
            case 'jpeg':
            case 'pjpeg':
            case 'png':
                 return true;

            case '':
                $(imageuploadform).find(".fileImage").val();
                alert("To upload an image, please select an Image File");
                return false;

            default:
                alert("To upload an image, please select a valild file extension.");
                return false;

        }

        return false;

} 
```

视频：

```
function videoValidation(videouploadform) {

    var val = $(videouploadform).find(".fileVideo").val();
    switch(val.substring(val.lastIndexOf('.') + 1).toLowerCase()){
        case 'mpg':
        case 'mov': 
        case 'wmv':
        case 'rm':
        case '3g2':
        case '3gp':
        case 'm2v':
        case 'm4v':
             return true;

        case '':
            $(videouploadform).find(".fileVideo").val();
            alert("To upload an video, please select an Video File");
            return false;

        default:
            alert("To upload an video, please select a valild file extension.");
            return false;

    }

    return false;

} 
```

声音的：

```
 function audioValidation(audiouploadform) {

        var val = $(audiouploadform).find(".fileAudio").val();
        switch(val.substring(val.lastIndexOf('.') + 1).toLowerCase()){
            case 'wav':
            case 'aif': 
            case 'mp3':
            case 'mid':
                 return true;

            case '':
                $(audiouploadform).find(".fileAudio").val();
                alert("To upload an audio, please select an Audio File");
                return false;

            default:
                alert("To upload an audio, please select a valild file extension.");
                return false;

        }

        return false;

} 
```

还有谁知道能够检查所有图像文件类型、视频文件类型和音频文件类型的 php 等效项是什么，因为我还需要对文件类型进行服务器端验证。我只想知道是否有比列出所有可能的图像、视频和音频文件类型更快的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:02:53.343

```
function checkFileExtension(AcceptableFileNamesRegex, fileName){
  var pattern = AcceptableFileNamesRegex;
  return pattern.test(fileName);
}

var regex = /wav|aif|mp3|mid/

checkFileExtension(regex, "myWav.wav") 
```

# java - Eclipse RCP 首选项对话框

> ID：10405931
> 
> 赞同：1
> 
> 时间：2012-05-01T23:51:27.587
> 
> 标签：java, eclipse, eclipse-rcp

## 问题

是否可以创建第二个 Preference Dialog 可以接受一些`PreferencePage`，就像标准的 eclipse Preference（Eclipse > Preferences 或 Window > Preferences）？

## 当前方法

到目前为止，我的解决方案是`PreferenceEditorDialog`通过扩展`Dialog`和实现我自己的首选项对话框样式布局来创建我自己的。

```
/**
 * A preference dialog is a hierarchical presentation of preference pages. Each
 * page is represented by a node in the tree shown on the left hand side of the
 * dialog; when a node is selected, the corresponding page is shown on the right
 * hand side.
 */
public class PreferenceEditorDialog extends Dialog implements IPageChangeProvider {

} 
```

我宁愿重用 Eclipse 实现，因为我不必自己维护代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T06:45:50.853

[`PreferenceDialog`](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/jface/preference/PreferenceDialog.html)就是你要找的。

# jquery - 当用户未从下拉列表中选择选项时，jQuery ui 自动完成

> ID：10405932
> 
> 赞同：30
> 
> 时间：2012-05-01T23:51:36.660
> 
> 标签：jquery, jquery-ui, jquery-ui-autocomplete

在使用[jquery 自动完成插件](http://jqueryui.com/demos/autocomplete/)时，如果用户没有选择列表中的项目，而是键入了一个有效的值并使用制表符离开，你会怎么做？

例如，当自动完成列表包含：

```
Cat
Dog
Fish 
```

并且用户键入`cat`，但没有`Cat`从自动完成的下拉列表中选择，而是选择了选项卡。因为他们没有从列表中选择任何项目，所以不会触发自动完成选择事件，我们失去了响应它的机会：

```
$('#Animal').autocomplete({
    source: url,
    minlength: 1,
    select: function (event, ui) {
        $("#Animal").val(ui.item.value);
        changeUsersAnimal(ui.item.id);
    }
}); 
```

我该如何处理这种情况？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-02T00:06:53.403

您可能正在寻找[Scott González 的`autoSelect`扩展名](https://github.com/scottgonzalez/jquery-ui-extensions/blob/master/src/autocomplete/jquery.ui.autocomplete.autoSelect.js)。如果用户输入了一个有效的值，只要在页面上包含这个扩展，就可以`select`触发事件，并且不需要您进行任何更改：

```
/*
 * jQuery UI Autocomplete Auto Select Extension
 *
 * Copyright 2010, Scott González (http://scottgonzalez.com)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * http://github.com/scottgonzalez/jquery-ui-extensions
 */
(function( $ ) {

$.ui.autocomplete.prototype.options.autoSelect = true;
$( ".ui-autocomplete-input" ).live( "blur", function( event ) {
    var autocomplete = $( this ).data( "autocomplete" );
    if ( !autocomplete.options.autoSelect || autocomplete.selectedItem ) { return; }

    var matcher = new RegExp( "^" + $.ui.autocomplete.escapeRegex( $(this).val() ) + "$", "i" );
    autocomplete.widget().children( ".ui-menu-item" ).each(function() {
        var item = $( this ).data( "item.autocomplete" );
        if ( matcher.test( item.label || item.value || item ) ) {
            autocomplete.selectedItem = item;
            return false;
        }
    });
    if ( autocomplete.selectedItem ) {
        autocomplete._trigger( "select", event, { item: autocomplete.selectedItem } );
    }
});

}( jQuery )); 
```

**这是使用扩展的示例**：http : [//jsfiddle.net/vFWUt/226/](http://jsfiddle.net/vFWUt/226/)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-07-30T16:24:59.840

使用 jQuery 版本 >= 1.8.11 使用 autoFocus 选项设置为 true

```
$( ".selector" ).autocomplete({ autoFocus: true }); 
```

这具有自动选择列表中的第一个项目的额外优势，因此用户只需按 Enter 或 Tab 即可选择它，而无需键入所有名称。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-01T23:57:11.463

添加 onchange 的自定义事件

```
$('#Animal').change(function(){
    var selectedValue = this.value;
    // Do what you want here:
    ...
}); 
```

**或者使用小部件的内置`change`事件：**

```
$('#Animal').autocomplete({
    source: url,
    minlength: 1,
    select: function (event, ui) {
        $("#Animal").val(ui.item.value);
        changeUsersAnimal(ui.item.id);
    }
   change: function(event, ui) { // <=======
       // ... 
       // ...
   }
}); 
```

[资源](http://jqueryui.com/demos/autocomplete/#event-change)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-01-04T16:04:51.487

对于 jQuery UI 1.9.2，我不得不在 Andrew Whitaker 的回答中更改一点 Scott González 的 autoSelect 扩展：

```
var item = $( this ).data( "item.autocomplete" ); 
```

成为

```
var item = $( this ).data( "uiAutocompleteItem" ); 
```

然后它完美地工作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-09-27T10:26:18.210

你可以这样使用

```
$("#inputbox").autocomplete({
    source : reuesturl,
    minLength : 1,
    select : function(event, ui) {
        $("#inputbox").attr('rel',ui.item.label);
    },
    open : function() {
        $("#inputbox").attr('rel', 0);
    },
    close : function() {                    
        if ($("#inputbox").attr('rel')=='0')
            $("#inputbox").val('');
    }
}); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-07-25T14:05:12.767

因为`jQuery UI - v1.11.0`我不得不改变一点[Scott González 的 autoSelect 扩展](https://github.com/scottgonzalez/jquery-ui-extensions/blob/master/src/autocomplete/jquery.ui.autocomplete.autoSelect.js)，如下所示。

```
/*
 * jQuery UI Autocomplete Auto Select Extension
 *
 * Copyright 2010, Scott González (http://scottgonzalez.com)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * http://github.com/scottgonzalez/jquery-ui-extensions
 */
$().ready(function () {
    $.ui.autocomplete.prototype.options.autoSelect = true;
    $(".ui-autocomplete-input").change(function (event) {
        var autocomplete = $(this).data("uiAutocomplete");

        if (!autocomplete.options.autoSelect || autocomplete.selectedItem) { return; }

        var matcher = new RegExp("^" + $.ui.autocomplete.escapeRegex($(this).val()) + "$", "i");
        autocomplete.widget().children(".ui-menu-item").each(function () {
            var item = $(this).data("uiAutocompleteItem");
            if (matcher.test(item.label || item.value || item)) {
                autocomplete.selectedItem = item;
                return false;
            }
        });

        if (autocomplete.selectedItem) {
            autocomplete._trigger("select", event, { item: autocomplete.selectedItem });
        }
    });
}); 
```

`autoSelect: true`并且必须在我的自动完成定义中应用扩展的自动完成选项。

我从这些答案中提取了一些代码。

1.  [特鲁什凯维奇](https://stackoverflow.com/a/14160546/1184435)
2.  [格多伦](https://stackoverflow.com/a/10405974/1184435)和
3.  [卡加泰卡兰](https://stackoverflow.com/a/14468953/1184435)

## 编辑

这是我的自动完成定义，以防有人感兴趣。

```
$("your selector").autocomplete({
    // Below filter looks for the values that start with the passed in string
    source: function (request, response) {
        var matches = $.map(yourSourceArray, function (acItem) {
            if (acItem.toUpperCase().indexOf(request.term.toUpperCase()) === 0) {
                return acItem;
            }
        });
        response(matches);
    },
    // one can directly pass the source array instead like,
    // source: yourSourceArray
    autoSelect: true,
    autoFocus: true,
    minLength: 3,
    change: function (event, ui) {
        if (ui.item) {
            // do whatever you want to when the item is found
        }
        else {
            // do whatever you want to when the item is not found
        }
    }
}) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-06-19T06:54:45.317

以下代码是对 Scott 的扩展以使用 jquery ui 1.10.3 版本进行的一些调整，我仅使用 1.10.3 版本测试了以下代码。

```
(function($) {

$.ui.autocomplete.prototype.options.autoSelect = true;
$( ".ui-autocomplete-input" ).live( "blur", function( event ) {
    var autocomplete = $( this ).data( "ui-autocomplete" );
    if ( ! autocomplete.options.autoSelect || autocomplete.selectedItem ) { return; }

    var matcher = new RegExp( "^" + $.ui.autocomplete.escapeRegex( $(this).val() ) + "$", "i" );
    autocomplete.widget().children( ".ui-menu-item" ).each(function() {
        var item = $( this ).data( "ui-autocomplete-item" );
        if ( matcher.test( item.label || item.value || item ) ) {
            autocomplete.selectedItem = item;
            return false;
        }
    });
    if ( autocomplete.selectedItem ) {
        autocomplete._trigger( "select", event, { item: autocomplete.selectedItem } );
    }
});
}(jQuery)); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-05-04T10:41:56.543

另一个简单的技巧是使用`.autocomplete({ focus: and change: })`. 在`focus`将数据放入元素数据属性中时，`change`请使用它：

```
return $(element).autocomplete({
            source: get_db_cities,
            select: function (event, ui) {
                $(this).attr('tz',ui.item.tz);
            },
            autoFocus: true,
            focus: function (event, ui) {
                $(this).attr('tz',ui.item.tz);
                $(this).attr('label',ui.item.label); // put data in attribute
            },
            change: function () {
                $(this).val($(this).attr('label')); // take from attribute and insert as value
            }
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-13T17:24:03.847

此代码仅自动选择一次。之后的所有其他人什么都不做。有任何想法吗？

编辑：我注释掉了这一行，它现在可以工作了。不知道为什么。

```
if ( !autocomplete.options.autoSelect || autocomplete.selectedItem ) { return; } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-11-11T20:17:59.270

我在使用 jquery 1.9.1 和 jquery-ui 1.10.3 的页面中遇到了这个功能的问题。基于 Scott Gonzalez 的代码和这里的建议以及几个小时的反复思考，我想出了以下内容。请注意，我想要一个解决方案，其中只允许用户输入自动完成建议的值之一——但我想允许用户只输入一个允许的值而不从下拉列表中选择它的情况：

```
/*
 * jQuery UI Autocomplete Auto Select Extension
 *
 * v 1.10
 * Jomo Frodo (jomofrodo@gmail.com)
 * 
 * This version requires an autoSelect parameter to be set on the autocomplete widget
 * 
 * e.g.,
 *      $("#autoCompleteID").autocomplete({
            source:url,
            minLength:1,
            autoSelect: true
        });
 * 
 * Based on an extension by Scott GonzÃ¡lez (http://scottgonzalez.com) 
 * http://blog.jqueryui.com/2010/08/extensible-autocomplete/
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * http://github.com/scottgonzalez/jquery-ui-extensions
 */

$(window).load(
        function() {

            //$.ui.autocomplete.prototype.options.autoSelect = true; 
            // Doesn't appear to work in ui 1.10.3
            // Must set the 'autoSelect' param on the autocomplete widget to get this to work.

            $(".ui-autocomplete-input").bind('autocompleteresponse',
                    function(event, ui) {
                        $(this).data('menuItems', ui.content);
                    });

            $(".ui-autocomplete-input").on(
                    "blur",
                    null,
                    function(event) {
                        var autocomplete = $(this).data("uiAutocomplete");
                        if (!autocomplete.options.autoSelect
                                || autocomplete.selectedItem) {
                            return;
                        }

                        var matcher = new RegExp("^"
                                + $.ui.autocomplete.escapeRegex($(this).val())
                                + "$", "i");
                        var menuItems = $(this).data('menuItems');
                        for (idx in menuItems) {
                            var item = menuItems[idx];
                            if (matcher.test(item.value)) {
                                autocomplete.selectedItem = item;
                                break;
                                // return false;
                            }
                        }
                        if (autocomplete.selectedItem) {
                            autocomplete._trigger("select", event, {
                                item : autocomplete.selectedItem
                            });
                        } else {
                            this.value = '';
                        }
                    });

        }); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-06-21T22:35:31.253

更新了 Scott Gonzalez 的代码以使用 Jquery-UI 1.12

```
(function($) {

    $.ui.autocomplete.prototype.options.autoSelect = true;
    $('body').on('blur', '.ui-autocomplete-input', function(event) {
        var autocomplete = $(this).data('ui-autocomplete');
        if (!autocomplete.options.autoSelect || autocomplete.selectedItem) { return; }

        var matcher = new RegExp($.ui.autocomplete.escapeRegex($(this).val()), 'i');
        autocomplete.widget().children('.ui-menu-item').each(function(index, item) {
            var item = $( this ).data('uiAutocompleteItem');
            if (matcher.test(item.label || item.value || item)) {
                autocomplete.selectedItem = item;
                return false;
            }
        });

        if (autocomplete.selectedItem) {
            autocomplete
            ._trigger('select', event, {item: autocomplete.selectedItem});
        }
    });

}(jQuery)); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-09-19T09:58:52.427

我已经尝试了所有这些响应，如果引入的值不在列表中，我的最终解决方案是将 select 设为空：

```
 $( "#input" ).autocomplete({
                source: source,
                minLength: 0,
                change: function(event, ui) {
                    if(!ui.item) {
                        $(this).val("")
                    }
                }
            }).focus(function(){            
                $(this).data("uiAutocomplete").search($(this).val());
            }); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-09-24T09:41:02.057

利用`autoFocus: true`

```
$('#Animal').autocomplete({
    source: url,
    **autoFocus: true,**
    minlength: 1,
    select: function (event, ui) {
        $("#Animal").val(ui.item.value);
        changeUsersAnimal(ui.item.id);
    }
}); 
```

# php - PHP在保存文件时捕获错误

> ID：10405943
> 
> 赞同：2
> 
> 时间：2012-05-01T23:53:05.227
> 
> 标签：php, file-io, exception-handling, error-handling

所以....我正在编写一个小函数，它返回文件是否已被写入，以及不写入的原因....类似于：

```
array (
    'success' => false,               // easy, by checking function result
    'reason' => 'Permission denied'   // how am I supposed to find this???
) 
```

也许我遗漏了一些东西，*但我似乎无法找到一种方法来捕获保存文件失败时的任何**错误消息***。

我的第一个想法是使用输出缓冲来捕获错误，但它超出了范围，容易出错并且是一个巨大的 hack（即，不同类型的错误可能会干扰）。

通常，这对于 OOP 风格的异常处理来说是一项很好的工作，except`file_put_contents`和`f*`函数不会抛出任何异常。

似乎`SplFileObject`可以完成这项工作……但有一个例外；它是一个基于行的类，[不适合读取二进制文件](https://bugs.php.net/bug.php?id=36289)。

有什么建议么？

**PS：**叫我懒惰，但我不相信我的代码应该检查所有异常情况（写权限、无法访问的驱动器、错误的路径等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:19:17.490

您提出的建议在表面上听起来是正确的，有一个总体 API，它将执行将文件写入文件系统的基本操作。然而，我认为 PHP 开发人员让我们自己来组合一个满足我们应用程序需求的 API，因为他们确实为我们提供了自己做的基本组件。

下面是`File::write`我用于文件写入操作的方法片段：

```
$fileInfo = new SplFileInfo($fileUri);

if (!is_dir($fileInfo->getPath())) {
    // I have some proprietary stuff here but you get the idea        
}

$file = new SplFileObject($fileUri, $mode);

if (!$file->flock(LOCK_EX | LOCK_NB)) {
    throw new Exception(sprintf('Unable to obtain lock on file: (%s)', $fileUri));
} 

elseif (!$file->fwrite($content)) {
    throw new Exception(sprintf('Unable to write content to file: (%s)... to (%s)', substr($content,0,25), $fileUri));
}

elseif (!$file->flock(LOCK_UN)) {
    throw new Exception(sprintf('Unable to remove lock on file: (%s)', $fileUri));
}

elseif (!@chmod($fileUri, $filePerms)) {
    throw new Exception(sprintf('Unable to chmod: (%s) to (%s)', $fileUri, $filePerms));
} 
```

这些只是您可以测试的边缘案例的几个示例，如果您需要测试“驱动器是否已连接”，您可以调用[is_writable](http://us2.php.net/manual/en/function.is-writable.php)。因此，您只需将其添加到检查列表中，并以对您的应用程序有意义的消息进行响应。

然后，如果您想记录所述错误，只需将调用代码包装在 try/catch 块中：

```
try {
    File::write($fileUri);
} catch (Exception $e) {
    error_log($e->getMessage);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:31:11.167

## 更新

@hakre 刚刚给了我一个好主意。与我的系统不一致的是默认的FS实现。

解决它的一种方法是取消注册`file://`协议的默认流包装器并注册我自己的，这实际上会引发异常。有了这些，我可以同时自由地使用`file_put_contents()`和捕获异常。

哦，我还可以确保自定义流包装器也是原子的（通过强制锁定）。

* * *

到目前为止，这是我想出的。当然，它需要真正的 FS 检查（驱动器/路径存在、权限等）。

```
 /**
     * Save file to source DSN.
     * @return boolean True on success, false on failure (see last_error for details). 
     */
    public function save(){
        $file = fopen($this->source, 'wb');
        if(!$file){
            $this->_last_error = 'Could not open file stream';
            return false;
        }
        if(!flock($file, LOCK_EX)){
            $this->_last_error = 'Could not lock file for writing';
            return false;
        }
        if(!ftruncate($file, 0)){
            $this->_last_error = 'Could not clear file';
            return false;
        }
        if(fwrite($file, $this->contents)===null){
            $this->_last_error = 'Could not write to file';
            return false;
        }
        if(!fflush($file)){
            $this->_last_error = 'Could not flush to file';
            return false;
        }
        if(!flock($file, LOCK_UN)){
            $this->_last_error = 'Could not unlock file';
            return false;
        }
        if(!fclose($file)){
            $this->_last_error = 'Could not close file';
            return false;
        }
        return true;
    } 
```

它*非常*冗长，并且与我想要的完全不同。通过 FS 检查，这可能会增加很多。

如果一开始就正确编码，那么所有这些代码都可以实现，这是一种耻辱`file_get_contents()`。

# google-app-engine - Google App Engine 上的焊接 CDI：servlet 中的注入未发生

> ID：10405944
> 
> 赞同：2
> 
> 时间：2012-05-01T23:53:07.167
> 
> 标签：google-app-engine, jakarta-ee, cdi, jboss-weld

这是我第一次与 GAE 合作，我正在尝试让 CDI 工作。**长话短说：`@Inject`我的 servlet 中的字段没有被注入（它总是`null`）。**

我在 Eclipse 中工作并在 GAE SDK 中包含的本地测试服务器上调试应用程序（它也由 Eclipse 启动）。当我在 上访问 servlet 时`localhost`，我得到一个空指针异常`someService`。我还输出了 的值`someService`来验证它是真的`null`，它是。

**编辑：**当我向`@Named("skldjfx")`注入点添加限定符时，Weld 抱怨依赖项不满足（在验证阶段），所以这是一个好兆头。但是，该字段仍然是`null`.

小服务程序：

```
public class BlogServlet extends HttpServlet {

    @Inject private SomeService someService;

    public void doGet(HttpServletRequest req, HttpServletResponse resp)
        throws IOException {

        resp.setContentType("text/plain");
        resp.getWriter().println("Hello. " + someService.getSomeValue());
        //                                      \
        //                                  always null
    }
} 
```

`SomeService`班级：

```
@ApplicationScoped
public class SomeService {

    private String someValue = "some value";

    public String getSomeValue() {
        return someValue;
    }
} 
```

我已经在以下位置配置`Listener`了Weld `web.xml`：

```
<listener>
    <listener-class>org.jboss.weld.environment.servlet.Listener</listener-class>
</listener> 
```

侦听器已正确加载，因为它记录了其初始化消息：`org.jboss.weld.environment.servlet.Listener contextInitialized`.

我在和`beans.xml`中都包含（一个空的） 。我也试过没有. **可能****没有处理？**文件夹中的其他内容（如）*已*正确处理。`war/WEB-INF``war/META-INF``META-INF`**`beans.xml`**`WEB-INF``web.xml`

 *如何验证是否`beans.xml`已处理和/或修复`SomeService`未注入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T03:55:13.233

看起来不可能将 CDI 与 GAE 一起使用，因为 GAE 的 Jetty fork 忽略`jetty-web.xml`了`BeanManager`. 请参阅[此链接](http://code.google.com/p/googleappengine/issues/detail?id=2943)和[此链接](http://code.google.com/p/googleappengine/issues/detail?id=3548)。真奇怪GAE不支持使用CDI。

*请注意，这些链接确实很旧，但到目前为止我还没有找到任何相反的证据。*

无论如何，我的下一步将是使用谷歌自己的依赖注入框架 Guice。[此处](http://code.google.com/p/google-guice/wiki/GoogleAppEngine)描述了将它与 GAE 一起使用。不过我更喜欢CDI。*

# html - Html 有序列表 1.1、1.2（嵌套计数器和范围）不起作用

> ID：10405945
> 
> 赞同：109
> 
> 时间：2012-05-01T23:53:39.800
> 
> 标签：html, css, html-lists

我使用嵌套计数器和范围来创建有序列表：

```
ol {
    counter-reset: item;
    padding-left: 10px;
}
li {
    display: block
}
li:before {
    content: counters(item, ".") " ";
    counter-increment: item
}
```

```
<ol>
    <li>one</li>
    <li>two</li>
    <ol>
        <li>two.one</li>
        <li>two.two</li>
        <li>two.three</li>
    </ol>
    <li>three</li>
    <ol>
        <li>three.one</li>
        <li>three.two</li>
        <ol>
            <li>three.two.one</li>
            <li>three.two.two</li>
        </ol>
    </ol>
    <li>four</li>
</ol>
```

我期待以下结果：

```
1\. one
2\. two
  2.1\. two.one
  2.2\. two.two
  2.3\. two.three
3\. three
  3.1 three.one
  3.2 three.two
    3.2.1 three.two.one
    3.2.2 three.two.two
4\. four 
```

相反，这是我看到的**（错误编号）**：

```
1\. one
2\. two
  2.1\. two.one
  2.2\. two.two
  2.3\. two.three
2.4 three <!-- this is where it goes wrong, when going back to the parent -->
  2.1 three.one
  2.2 three.two
    2.2.1 three.two.one
    2.2.2 three.two.two
2.3 four 
```

我不知道，有没有人看到哪里出错了？

这是一个 JSFiddle：http: [//jsfiddle.net/qGCUk/2/](http://jsfiddle.net/qGCUk/2/)

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2012-05-01T23:55:36.417

取消选中“规范化 CSS” - [http://jsfiddle.net/qGCUk/3/](http://jsfiddle.net/qGCUk/3/) 使用的 CSS 重置默认所有列表边距和填充为 0

**更新** [http://jsfiddle.net/qGCUk/4/](http://jsfiddle.net/qGCUk/4/) - 你必须在你的主列表中包含你的子列表`<li>`

```
ol {
  counter-reset: item
}
li {
  display: block
}
li:before {
  content: counters(item, ".") " ";
  counter-increment: item
}
```

```
<ol>
  <li>one</li>
  <li>two
    <ol>
      <li>two.one</li>
      <li>two.two</li>
      <li>two.three</li>
    </ol>
  </li>
  <li>three
    <ol>
      <li>three.one</li>
      <li>three.two
        <ol>
          <li>three.two.one</li>
          <li>three.two.two</li>
        </ol>
      </li>
    </ol>
  </li>
  <li>four</li>
</ol>
```

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2015-05-19T13:18:26.650

使用此样式仅更改嵌套列表：

```
ol {
    counter-reset: item;
}

ol > li {
    counter-increment: item;
}

ol ol > li {
    display: block;
}

ol ol > li:before {
    content: counters(item, ".") ". ";
    margin-left: -20px;
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-05-02T00:00:50.987

**看一下这个 ：**

[http://jsfiddle.net/PTbGc/](http://jsfiddle.net/PTbGc/)

您的问题似乎已解决。

* * *

我看到了什么（在 Chrome 和 Mac OS X 下）

```
1\. one
2\. two
  2.1\. two.one
  2.2\. two.two
  2.3\. two.three
3\. three
  3.1 three.one
  3.2 three.two
    3.2.1 three.two.one
    3.2.2 three.two.two
4\. four 
```

* * *

### 我是怎么做到的

* * *

**代替 ：**

```
<li>Item 1</li>
<li>Item 2</li>
   <ol>
        <li>Subitem 1</li>
        <li>Subitem 2</li>
   </ol> 
```

**做 ：**

```
<li>Item 1</li>
<li>Item 2
   <ol>
        <li>Subitem 1</li>
        <li>Subitem 2</li>
   </ol>
</li> 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-07-11T17:23:54.277

这是一个很好的解决方案！使用一些额外的 CSS 规则，您可以像 MS Word 大纲列表一样格式化它，并带有悬挂的第一行缩进：

```
OL { 
  counter-reset: item; 
}
LI { 
  display: block; 
}
LI:before { 
  content: counters(item, ".") "."; 
  counter-increment: item; 
  padding-right:10px; 
  margin-left:-20px;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-11-17T03:32:57.903

# 把事情简单化！

增加数字并在末尾保留点的更简单和标准的解决方案。即使您的 css 正确，如果您的 HTML 不正确，它也将无法工作。见下文。

## CSS

```
ol {
  counter-reset: item;
}
ol li {
  display: block;
}
ol li:before {
  content: counters(item, ". ") ". ";
  counter-increment: item;
} 
```

## SASS

```
ol {
    counter-reset: item;
    li {
        display: block;
        &:before {
            content: counters(item, ". ") ". ";
            counter-increment: item
        }
    }
} 
```

## HTML 父子

如果添加孩子，请确保它在 parent 之下`li`。

### 不会工作✘</h3>

请注意，父母`li`和孩子`ol li`在这里是独立的，这是行不通的。

```
<ol>
    <li>Parent 1</li> <!-- Parent has open and close li tags -->
    <ol> 
        <li>Child</li>
    </ol>
    <li>Parent 2</li>
</ol> 
```

### 会工作✔</h3>

您需要将`ol li`子元素放在 parent 内`li`。注意父母`li`正在拥抱孩子。

```
<ol>

    <li>Parent 1 <!-- Parent open li tag -->
        <ol> 
            <li>Child</li>
        </ol>
    </li> <!-- Parent close li tag -->

    <li>Parent 2</li>
</ol> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-02-08T23:37:04.873

我最近遇到了类似的问题。解决方法是将有序列表中的li项的显示属性设置为list-item，而不是显示块，并确保ol的显示属性不是list-item。IE

```
li { display: list-item;} 
```

这样，html 解析器将所有 li 视为列表项并为其分配适当的值，并将 ol 视为基于您的设置的 inline-block 或块元素，并且不会尝试分配任何计数值它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-05-13T11:49:15.043

Moshe 的解决方案很棒，但是如果您需要将列表放入`div`. （阅读：[嵌套列表上的 CSS 计数器重置](https://stackoverflow.com/questions/31539617/css-counter-reset-on-nested-list)）

这种风格可以防止这个问题：

```
ol > li {
    counter-increment: item;
}

ol > li:first-child {
  counter-reset: item;
}

ol ol > li {
    display: block;
}

ol ol > li:before {
    content: counters(item, ".") ". ";
    margin-left: -20px;
}
```

```
<ol>
  <li>list not nested in div</li>
</ol>

<hr>

<div>
  <ol>
  <li>nested in div</li>
  <li>two
    <ol>
      <li>two.one</li>
      <li>two.two</li>
      <li>two.three</li>
    </ol>
  </li>
  <li>three
    <ol>
      <li>three.one</li>
      <li>three.two
        <ol>
          <li>three.two.one</li>
          <li>three.two.two</li>
        </ol>
      </li>
    </ol>
  </li>
  <li>four</li>
  </ol>
</div>
```

您还可以将计数器重置设置为 on `li:before`。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-07-16T16:58:54.140

在经历了其他答案后，我想出了这个，只需将类`nested-counter-list`应用于根`ol`标签：

**萨斯代码：**

```
ol.nested-counter-list {
  counter-reset: item;

  li {
    display: block;

    &::before {
      content: counters(item, ".") ". ";
      counter-increment: item;
      font-weight: bold;
    }
  }

  ol {
    counter-reset: item;

    & > li {
      display: block;

      &::before {
        content: counters(item, ".") " ";
        counter-increment: item;
        font-weight: bold;
      }
    }
  }
} 
```

**CSS代码**：

```
ol.nested-counter-list {
  counter-reset: item;
}
ol.nested-counter-list li {
  display: block;
}
ol.nested-counter-list li::before {
  content: counters(item, ".") ". ";
  counter-increment: item;
  font-weight: bold;
}
ol.nested-counter-list ol {
  counter-reset: item;
}
ol.nested-counter-list ol > li {
  display: block;
}
ol.nested-counter-list ol > li::before {
  content: counters(item, ".") " ";
  counter-increment: item;
  font-weight: bold;
} 
```

```
ol.nested-counter-list {
  counter-reset: item;
}

ol.nested-counter-list li {
  display: block;
}

ol.nested-counter-list li::before {
  content: counters(item, ".") ". ";
  counter-increment: item;
  font-weight: bold;
}

ol.nested-counter-list ol {
  counter-reset: item;
}

ol.nested-counter-list ol>li {
  display: block;
}

ol.nested-counter-list ol>li::before {
  content: counters(item, ".") " ";
  counter-increment: item;
  font-weight: bold;
}
```

```
<ol class="nested-counter-list">
  <li>one</li>
  <li>two
    <ol>
      <li>two.one</li>
      <li>two.two</li>
      <li>two.three</li>
    </ol>
  </li>
  <li>three
    <ol>
      <li>three.one</li>
      <li>three.two
        <ol>
          <li>three.two.one</li>
          <li>three.two.two</li>
        </ol>
      </li>
    </ol>
  </li>
  <li>four</li>
</ol>
```

如果您需要`.`在嵌套列表的计数器末尾添加尾随，请使用以下命令：

```
ol.nested-counter-list {
  counter-reset: item;
}

ol.nested-counter-list li {
  display: block;
}

ol.nested-counter-list li::before {
  content: counters(item, ".") ". ";
  counter-increment: item;
  font-weight: bold;
}

ol.nested-counter-list ol {
  counter-reset: item;
}
```

```
<ol class="nested-counter-list">
  <li>one</li>
  <li>two
    <ol>
      <li>two.one</li>
      <li>two.two</li>
      <li>two.three</li>
    </ol>
  </li>
  <li>three
    <ol>
      <li>three.one</li>
      <li>three.two
        <ol>
          <li>three.two.one</li>
          <li>three.two.two</li>
        </ol>
      </li>
    </ol>
  </li>
  <li>four</li>
</ol>
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-01-23T17:49:59.527

谢谢楼上各位的解答！

由于我需要 RTL 解决方案，我发现这可以解决它：

```
ol.nested-counter-list li {
  display: block;
  unicode-bidi: bidi-override;
} 
```

因此，您可以使用上述任何解决方案，但也要为 RTL 案例更新特定的 CSS 选择器。

# ajax - ajax 形式 is_valid 返回 false (django)

> ID：10405950
> 
> 赞同：0
> 
> 时间：2012-05-01T23:54:23.803
> 
> 标签：ajax, django, forms, submit

我无法弄清楚为什么我的表单返回 false 到 is_valid

我有一个名为 account 的页面，它有一个 ajax 函数来提交表单

我在我的帐户视图和我的 createform 视图中传递我的表单

createform 视图：这是处理我的 ajax 的地方

```
def createrecipe(request):
    print "entering createrecipeview"
    if request.method == 'POST':
        print "form is a post"
        form = RecipeForm(request.POST)
        print form.errors
        if form.is_valid():
            print "form is valid"
            form = RecipeForm(initial = {'original_cookbook' : request.user.cookbooks.all()[0]})
            form = form.save()
            if form.cleaned_data['reset_recipe'] == "True":
                print "reset recipe"
                form = RecipeForm(initial = {"original_cookbook": request.user.cookbooks.all()[0]})
                t = loader.get_template('cookbook/create_form.html')
                c = RequestContext(request, {
                'form': form,
                })

                data = {
                'replace': True,
                'form': t.render(c),
                'success': False,
                }

                json = simplejson.dumps(data)
                return HttpResponse(json,mimetype='text/plain')
            t = loader.get_template('cookbook/create_form.html')
            c = RequestContext(request, {
            'form': form,
            })

            data = {
            'replace': True,
            'form': t.render(c),
            'success': True,
            }

            json = simplejson.dumps(data)
            return HttpResponse(json, mimetype='text/plain')
        else:
            print "form is invalid"
            form = RecipeForm(request.POST)
            t = loader.get_template('cookbook/create_form.html')
            c = RequestContext(request, {
                'form':form,
            })

            data ={
                'form': t.render(c),
                'success': False,
            }

            json = simplejson.dumps(data)
            return HttpResponse(json, mimetype='text/plain') 
```

帐户视图：这是我在表单中传递 ajax 视图的地方

```
def account(request):
    user = request.user
    if request.user.is_authenticated():
        cookbooks = user.cookbooks
        if cookbooks.all().exists():
            cookbook = cookbooks.all()[0]
            form = RecipeForm(request.POST)
            recipe_list = cookbook.recipes.all()
        else:
            raise Http404
    else:
        return HttpResponseRedirect('/accounts/login')
    t = loader.get_template('cookbook/account.html')
    c = RequestContext(request, {
        'form': form,
        'recipe_list': recipe_list
    })
    return HttpResponse(t.render(c)) 
```

所以我的问题是，当将 ajax 与 django 一起使用时，我需要在具有 ajax js 的页面或具有该表单的页面上传递什么视图

抱歉，如果这令人困惑-如果没有意义，请告诉我，我会详细说明

这是我的表格。错误打印

```
<ul class="errorlist"><li>name<ul class="errorlist"><li>This field is required.</li></ul></li><li>ingredients<ul class="errorlist"><li>This field cannot be null.</li></ul></li><li>author<ul class="errorlist"><li>This field is required.</li></ul></li><li>steps<ul class="errorlist"><li>This field cannot be null.</li></ul></li><li>prep_time<ul class="errorlist"><li>This field is required.</li></ul></li><li>type<ul class="errorlist"><li>This field is required.</li></ul></li></ul> 
```

这实际上是有道理的，因为我没有向它没有验证的表单添加任何输入

抱歉，但我认为这是一场虚惊

这是我的js

```
<script type="text/javascript"> 
$(document).ready(function(){
    var form = $('form#createrecipeform');
    form.submit(function(e) {
    e.preventDefault();
    console.log('ajax form submission function called successfully.');
    form = $(this);
    console.log(form)
    var serialized_form = form.serialize();
        $.ajax({ type: "POST", 
            url: $(this).attr('action'),
            data: serialized_form, 
            success: (function(data) { 
                console.log('ajax success function called successfully.');
                data = $.parseJSON(data);
                if (data.success) {
                    console.log('success');//i dont know what to do here
                    var newForm = data.form;
                    form.replaceWith(newForm);
                } else {
                    console.log('failure');// i also don't know what to do here
                    var newForm = data.form;
                    form.replaceWith(newForm);  
                }
            })
        });
        return false;
    });
});
</script> 
```

凯蒂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:08:09.180

检查您是否发送每个非空字段。有时您发送的数据属性名称不正确，或者您缺少必填字段。要检查发生了什么，我建议使用 shell 输入数据并访问表单的错误列表。要做到这一点

```
$python manage.py shell 
>>> from yourapp.models import yourClass 
>>> data = {'name':'Jefrey','age':27,'home':'NYC'}
>>> f = yourClass(data)
>>> f.is_valid() 
```

如果您得到 False ，请执行此操作

```
>>>f.errors 
```

这样你就会看到发生了什么。更多关于 Django 文档 [https://docs.djangoproject.com/en/dev/ref/forms/api/](https://docs.djangoproject.com/en/dev/ref/forms/api/)

我希望这有帮助

# ruby-on-rails - Ruby 日期方程未返回预期的真值

> ID：10405954
> 
> 赞同：5
> 
> 时间：2012-05-01T23:54:54.700
> 
> 标签：ruby-on-rails, ruby, date

为什么以下不同？

```
Time.now.end_of_day      == Time.now.end_of_day - 0.days      # false
Time.now.end_of_day.to_s == Time.now.end_of_day - 0.days.to_s # true 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T00:07:21.947

因为纳秒数不同：

```
ruby-1.9.2-p180 :014 > (Time.now.end_of_day - 0.days).nsec
 => 999999000 
ruby-1.9.2-p180 :015 > Time.now.end_of_day.nsec
 => 999999998 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T00:09:28.497

就像米沙所说，时间相差纳秒。[这](http://blog.tddium.com/2011/08/07/rails-time-comparisons-devil-details-etc/)是一篇关于在 Rails 中执行此操作的解决方法和修复的文章，特别是针对您正在做的测试。

给出的看似最直接的方法是通过附加将时间四舍五入到秒`.to_i`，但还有其他选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-02T00:10:22.617

扩展米沙的答案：

来自[Time 对象的文档](http://www.ruby-doc.org/core-1.9.3/Time.html)：“所有时间都可能有分数。在相互比较时间时请注意这一事实 - 显示时明显相等的时间在比较时可能不同。”

因此，您的第一个计算比较了两个 Time 对象，它们在纳秒级别上是不同的，但是您的第二个计算将两个 Time 对象都转换为字符串，它忽略了纳秒并返回 true，因为两个字符串表示都匹配。

# gwt - CellTree 建议 - AsyncDataProvider 添加/删除/更新

> ID：10405957
> 
> 赞同：2
> 
> 时间：2012-05-01T23:55:01.027
> 
> 标签：gwt

我对 GWT CellTree 有疑问，此时，我想知道它是否真的准备好迎接黄金时段了。也许我没有得到默认用例？

到目前为止，在 Web 上看到的大多数问题都与使用 CellTree 的 CRUD 操作有关，但使用的是简单的[ListDataProvider](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/view/client/ListDataProvider.html)，例如[GWT - 在 celltree 中添加和删除节点](https://stackoverflow.com/questions/9044688/gwt-add-and-remove-nodes-in-celltree)。

就我而言，我正在使用[AsyncDataProvider 填充](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/view/client/AsyncDataProvider.html)CellTree 的节点。[使用RequestFactory](https://developers.google.com/web-toolkit/doc/latest/DevGuideRequestFactory)服务按需获取节点。

给定一个选择，我想添加子节点，删除/更新当前选择。在我看来，GWT TreeViewModel 接口太基础了。

根据我目前的理解，要走的路是使用 DataProviders 的映射，保留远程调用返回的基础列表的引用，并可能引用父[NodeInfo](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/view/client/TreeViewModel.NodeInfo.html)对象。

例如，要删除当前选择，我可能会执行以下操作：

```
TreeViewModel model = cellTree.getTreeViewModel();
TreeViewModel.NodeInfo nodeInfo = model.getNodeInfo(selectionFromChangeListener);
CustomNodeInfo parent = ((CustomNodeInfo) nodeInfo).getParent();
parent.getUnderLyingNodeListFromDataProvider().remove(selectionFromChangeListener);
// maybe force refresh using dataProvider???
parent.getDataProvider().refreshDisplayAsInRepopulateData() 
```

有更好的建议吗？看起来这将是一项具有挑战性的任务，除非我弄错了……不过这似乎有点矫枉过正。在 Swing 中很容易实现，甚至在大多数其他提供 Tree 小部件的 Web 框架中也是如此。

使用默认的[Tree](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/Tree.html)小部件并用“正在加载”图像替换我自己的图标会更直接吗？看起来基本 Tree 允许对节点进行更多操作，如[TreeItems](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/TreeItem.html)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T11:27:18.647

CellTree 小部件似乎基于[FastTree](http://code.google.com/p/google-web-toolkit-incubator/wiki/FastTree)的原始代码。

FastTree 已经或多或少有我需要的东西，没有像 Swing [DefaultMutableTreeNode那样的某种](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/tree/DefaultMutableTreeNode.html#setUserObject%28java.lang.Object%29)*setUserObject方法*

对于旋转图标，过去[已经有人研究](http://markmacumber.net/2009/05/gwt-fasttree-and-a-spinner-icon.html)过。

我想现在，我将从 CellTree 切换到 FastTree 和[FastTreeItem](http://code.google.com/p/google-web-toolkit-incubator/source/browse/branches/dflorey/tableAddons/src/com/google/gwt/widgetideas/client/FastTreeItem.java?spec=svn1211&r=1211)的定制版本。

开箱即用的能力，例如 getParentItem、remove（当前节点或特定子节点）？先生非常感谢您...

# iphone - 使用 MPMoviePlayerController 播放 iTunes 预览视频

> ID：10405958
> 
> 赞同：0
> 
> 时间：2012-05-01T23:55:02.003
> 
> 标签：iphone, ios, video, mpmovieplayercontroller, itunes

我正在尝试从 URL 播放视频，我想要播放的视频是这样的 iTunes 预览视频：http: [//a236.v.phobos.apple.com/us/r1000/051/Video/ec/1d/ 7f/mzm.hwbfvfdq..640x480.h264lc.d2.p.m4v](http://a236.v.phobos.apple.com/us/r1000/051/Video/ec/1d/7f/mzm.hwbfvfdq..640x480.h264lc.d2.p.m4v) 我在 iPhone 上试过，打开播放器，我看到缓冲区已加载，但如果我播放它我什么都看不到，我怎么能做什么？...这是代码：

```
- (void) moviePlayBackDidFinish:(NSNotification*)notification {

MPMoviePlayerController *moviePlayer = [notification object];

[[NSNotificationCenter defaultCenter] removeObserver:self      
                                                name:MPMoviePlayerPlaybackDidFinishNotification
                                              object:moviePlayer];

if ([moviePlayer 
     respondsToSelector:@selector(setFullscreen:animated:)])
{
    [moviePlayer.view removeFromSuperview];
}
[moviePlayer release];
}

- (IBAction)playVideo:(id)sender {

NSURL *url = [NSURL URLWithString:@"http://a236.v.phobos.apple.com/us/r1000/051/Video/ec/1d/7f/mzm.hwbfvfdq..640x480.h264lc.d2.p.m4v"];

MPMoviePlayerController *moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:url];

[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(moviePlayBackDidFinish:)
                                             name:MPMoviePlayerPlaybackDidFinishNotification
                                           object:moviePlayer];

moviePlayer.controlStyle = MPMovieControlStyleDefault;
moviePlayer.shouldAutoplay = YES;

[self.view addSubview:moviePlayer.view];
[moviePlayer setFullscreen:YES animated:YES];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:22:44.497

由于您尝试从 iTunes 访问 .m4v 文件。DRM 保护是问题所在。

编辑：您的链接在 Quicktime 中有效，但在浏览器中无效。

**Apple 不允许在 MPMoviePlayerConroller（包括预览）中播放来自 iTunes 的受 DRM 保护的音乐或视频。**

另请参阅[Stackoverflow上的以下链接](https://stackoverflow.com/questions/5724052/playing-m4v-protected-content-with-mpmovieplayercontroller-or-avplayer-ios)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:22:31.247

当我将链接（http://a236.v.phobos.apple.com/us/r1000/051/Video/ec/1d/7f/mzm.hwbfvfdq..640x480.h264lc.d2.p.m4v）复制并粘贴到浏览器，我也没有看到/听到视频/音频..

首先 hwbfvfdq 和 640x480 之间似乎有超过 1 个点，可能有一些字符您没有复制或没有看到。

而且，由于这是来自 iTunes 的 url，它们可能是使用令牌来避免用户永久访问此类 url 链接的视频。

希望这可以帮助 ..

ps：你用你知道的电影的直接网址试过你的代码吗？

# bash - 如何将变量内容发送到文件

> ID：10405959
> 
> 赞同：0
> 
> 时间：2012-05-01T23:55:04.403
> 
> 标签：bash

基本上，我想做的是从文件中删除一行。用户输入一个搜索字符串，然后程序搜索除搜索字符串之外的所有内容，然后将其存储在文件中。这是我的代码：

```
elif [ $res -eq "2" ] 
then
     echo "Enter phrase to delete: "
     read -e deletestr
     d=`cat phonebook | grep -v $deletestr`
     echo $d > phonebook 
```

当我运行脚本时，它总是清空电话簿文件。为什么是这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T00:07:42.167

我建议要么创建一个*新*文件，然后在完成删除后替换旧文件，要么使用诸如`sed -i`可以*就地*编辑文件的工具。

就像是：

```
grep -v "foo" phonebook > phonebook.new
mv phonebook.new phonebook 
```

或者

```
sed -i '/foo/d' phonebook 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:28:14.060

如果要编辑文件，可以使用编辑器

```
ex phonebook << DONE
g/$delstring/d
x
DONE 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T23:58:46.870

使用`>>`而不是`>`将标准输出附加到文件中。

如果您想了解有关 I/O 重定向的更多信息，这是一个很好的指南：[http ://tldp.org/LDP/abs/html/io-redirection.html](http://tldp.org/LDP/abs/html/io-redirection.html)

# matlab - 带有 MEX 和 MATLAB 参数问题的 FFTW

> ID：10405960
> 
> 赞同：1
> 
> 时间：2012-05-01T23:55:06.347
> 
> 标签：matlab, mex, fftw

我使用 FFTW 库编写了以下 C/MEX 代码，以控制用于从 MATLAB 进行 FFT 计算的线程数。`FFTW_ESTIMATE`尽管它比 MATLAB 慢，但该代码与规划器中的参数一起工作得很好（复杂的 FFT 向前和向后） 。但是，当我切换到`FFTW_MEASURE`参数来调整 FFTW 规划器时，事实证明，向前应用一个 FFT 然后向后应用一个 FFT 不会返回初始图像。相反，图像按一个因子缩放。使用`FFTW_PATIENT`空矩阵给我一个更糟糕的结果。

我的代码如下：

**Matlab函数：**

*FFT 前向：*

```
function Y = fftNmx(X,NumCPU)   

if nargin < 2
    NumCPU = maxNumCompThreads;
    disp('Warning: Use the max maxNumCompThreads');
end
Y = FFTN_mx(X,NumCPU)./numel(X); 
```

*向后 FFT：*

```
function Y = ifftNmx(X,NumCPU)

if nargin < 2
    NumCPU = maxNumCompThreads;
    disp('Warning: Use the max maxNumCompThreads');
end

Y = iFFTN_mx(X,NumCPU); 
```

**墨西哥功能：**

*FFT 前向：*

```
# include <string.h>
# include <stdlib.h>
# include <stdio.h>
# include <mex.h>
# include <matrix.h>
# include <math.h>
# include </home/nicolas/Code/C/lib/include/fftw3.h>

char *Wisfile = NULL;
char *Wistemplate = "%s/.fftwis";
#define WISLEN 8

void set_wisfile(void)
{
    char *home;
    if (Wisfile) return;
    home = getenv("HOME");
    Wisfile = (char *)malloc(strlen(home) + WISLEN + 1);
    sprintf(Wisfile, Wistemplate, home);
}

fftw_plan CreatePlan(int NumDims, int N[], double *XReal, double *XImag, double *YReal, double *YImag)
{
  fftw_plan Plan;
  fftw_iodim Dim[NumDims];
  int k, NumEl;
  FILE *wisdom;

  for(k = 0, NumEl = 1; k < NumDims; k++)
  {
    Dim[NumDims - k - 1].n = N[k];
    Dim[NumDims - k - 1].is = Dim[NumDims - k - 1].os = (k == 0) ? 1 : (N[k-1] * Dim[NumDims-k].is);
    NumEl *= N[k];
  }

/* Import the wisdom. */
  set_wisfile();
  wisdom = fopen(Wisfile, "r");
  if (wisdom) {
    fftw_import_wisdom_from_file(wisdom);
    fclose(wisdom);
  }

  if(!(Plan = fftw_plan_guru_split_dft(NumDims, Dim, 0, NULL, XReal, XImag, YReal, YImag, FFTW_MEASURE *(or FFTW_ESTIMATE respectively)* )))
    mexErrMsgTxt("FFTW3 failed to create plan.");

/* Save the wisdom.  */
  wisdom = fopen(Wisfile, "w");
  if (wisdom) {
    fftw_export_wisdom_to_file(wisdom);
    fclose(wisdom);
  }

  return Plan;
}

void mexFunction( int nlhs, mxArray *plhs[],
              int nrhs, const mxArray *prhs[] )
{
  #define B_OUT     plhs[0]

  int k, numCPU, NumDims;
  const mwSize *N;
  double *pr, *pi, *pr2, *pi2;
  static long MatLeng = 0;
  fftw_iodim Dim[NumDims];
  fftw_plan PlanForward;
  int NumEl = 1;
  int *N2;

  if (nrhs != 2) {
      mexErrMsgIdAndTxt( "MATLAB:FFT2mx:invalidNumInputs",
                "Two input argument required.");
  }

  if (!mxIsDouble(prhs[0])) {
      mexErrMsgIdAndTxt( "MATLAB:FFT2mx:invalidNumInputs",
                "Array must be double");
  }

  numCPU = (int) mxGetScalar(prhs[1]);
  if (numCPU > 8) {
      mexErrMsgIdAndTxt( "MATLAB:FFT2mx:invalidNumInputs",
                "NumOfThreads < 8 requested");
  }

  if (!mxIsComplex(prhs[0])) {
      mexErrMsgIdAndTxt( "MATLAB:FFT2mx:invalidNumInputs",
                "Array must be complex");
  }

  NumDims = mxGetNumberOfDimensions(prhs[0]);
  N = mxGetDimensions(prhs[0]);
  N2 = (int*) mxMalloc( sizeof(int) * NumDims);
  for(k=0;k<NumDims;k++) {
    NumEl *= NumEl * N[k];
    N2[k] = N[k];
  }

  pr = (double *) mxGetPr(prhs[0]);
  pi = (double *) mxGetPi(prhs[0]);

  //B_OUT = mxCreateNumericArray(NumDims, N, mxDOUBLE_CLASS, mxCOMPLEX);
  B_OUT  = mxCreateNumericMatrix(0, 0, mxDOUBLE_CLASS, mxCOMPLEX);
  mxSetDimensions(B_OUT , N, NumDims);
  mxSetData(B_OUT , (double* ) mxMalloc( sizeof(double) * mxGetNumberOfElements(prhs[0]) ));
  mxSetImagData(B_OUT , (double* ) mxMalloc( sizeof(double) * mxGetNumberOfElements(prhs[0]) ));

  pr2 = (double* ) mxGetPr(B_OUT);
  pi2 = (double* ) mxGetPi(B_OUT);

  fftw_init_threads();
  fftw_plan_with_nthreads(numCPU);  
  PlanForward = CreatePlan(NumDims, N2, pr, pi, pr2, pi2);
  fftw_execute_split_dft(PlanForward, pr, pi, pr2, pi2);
  fftw_destroy_plan(PlanForward);
  fftw_cleanup_threads();

} 
```

*FFT 向后*：

正如 FFTW 文档中所建议的，此 MEX 函数与上述函数的不同之处仅在于切换指针`pr <-> pi`、函数和计划`pr2 <-> pi2`的`CreatePlan`执行。

如果我跑

```
A = imread('cameraman.tif');
>> A = double(A) + i*double(A);
>> B = fftNmx(A,8);
>> C = ifftNmx(B,8);
>> figure,imagesc(real(C)) 
```

分别使用`FFTW_MEASURE`和`FFTW_ESTIMATE`参数我得到[了这个结果](http://upload.the9day.com/?di=D1FL)。

我想知道这是否是由于我的代码或库中的错误造成的。我围绕智慧尝试了不同的东西，储蓄而不是储蓄。使用 FFTW 独立工具产生的智慧来产生智慧。我没有看到任何改善。谁能建议为什么会这样？

*附加信息：*

我使用静态库编译 MEX 代码：

```
mex FFTN_Meas_mx.cpp /home/nicolas/Code/C/lib/lib/libfftw3.a /home/nicolas/Code/C/lib/lib/libfftw3_threads.a -lm 
```

FFTW 库尚未编译：

```
./configure  CFLAGS="-fPIC" --prefix=/home/nicolas/Code/C/lib --enable-sse2 --enable-threads --&& make && make install 
```

我尝试了不同的标志但没有成功。我在 Linux 64 位站（AMD opteron 四核）上使用 MATLAB 2011b。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T16:55:16.027

FFTW 计算非标准化变换，请参见此处： [http ://www.fftw.org/doc/What-FFTW-Really-Computes.html](http://www.fftw.org/doc/What-FFTW-Really-Computes.html)

粗略地说，当您执行直接变换然后执行逆变换时，您会得到输入（加上舍入误差）乘以数据长度。

当您使用 FFTW_ESTIMATE 以外的标志创建计划时，您的输入将被覆盖： [http ://www.fftw.org/doc/Planner-Flags.html](http://www.fftw.org/doc/Planner-Flags.html)

# arrays - AS3：基于数组值的 AddChild

> ID：10405961
> 
> 赞同：2
> 
> 时间：2012-05-01T23:55:21.650
> 
> 标签：arrays, actionscript-3, addchild

假设我有一个数组，数组中的每个项目都有一个对应的库项目。

我想做类似的事情：

```
var rando = Math.round(Math.random()*3)
var myArray = new Array ["ball", "wall", "fall"]
var i:myArray[rando] = myArray[rando] new myArray[rando]()
addChild(i) 
```

但是，这行不通。秘诀是什么？

谢谢你，

维克多·雨果

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T04:46:41.453

令这里没有人感到惊讶[`getDefinitionByName()`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/package.html#getDefinitionByName%28%29)。

这是一些完整的代码，可以让您的示例正常工作：

```
var myArray = ["ball", "wall", "fall"];

/**
 * Creates a random instance based on an input array containing class names as Strings.
 * @param The input array containing aforementioned Strings.
 * @return The newly created instance.
 */
function createRandom(typeArray:Array):*
{
    // Select random String from typeArray.
    var selection:String = typeArray[ int(Math.random() * typeArray.length) ];

    // Create instance of relevant class.
    var Type:Class = getDefinitionByName(selection) as Class;

    // Return created instance.
    return new Type();
}

// Randomly create and add instance.
var instance:DisplayObject = createRandom(myArray);
addChild(instance); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:05:20.513

好的，所以这有很多问题。

一个很大的人`var i:myArray[rando] = myArray[rando] new myArray[rando]()`不太确定你在这里要做什么。

无论如何，我将假设 ball、wall 和 fall 是您库中的 MovieClip 的实例名称。我想你会想要这样的东西

```
 var rando:int = Math.floor(Math.random()*3); //As the comments point out this should give you a random 
//int between 0 and 2, arrays are 0 indexed so this is what we want if we have 3 items 
```

现在对于您的数组，您当前正在将字符串放在那里。Flash 不知道什么是“球”等。

尝试这样的事情

```
var myArray:Array = new Array [new ball(), new wall(), new fall()]; //this creates a new instance of your library object and stores it in your array 
```

现在将其中之一添加到您的阶段：

```
addChild(myArray[rando]); //this uses the random number to pull one of the items out of your array 
```

你试图做什么`var i:myArray[rando]`并没有真正的意义。没有 myArray[rando] 的类型，这个插槽应该包含一个 MovieClip

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T00:02:28.927

如果您只有几个选择，使用 switch-case 会更容易。

```
switch (rando) {
   case 0:
       i = new ball();
       break;
   case 1:
       i = new wall();
       break;
   case 2:
       i = new fall();
       break;
}
addChild(i); 
```

我建议您将变量定义`i`为 a `MovieClip`，在这种情况下，它可以同时实例化为 ball、wall、fall。

鉴于 ball、wall 和 fall 都在导出到 actionscript 的库中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T00:06:47.320

只是猜测您有限的信息，但试一试。

```
private function myFunction():void{
    var rando = Math.round(Math.random()*3);
    var myArray= new Array ["ball", "wall", "fall"];

}
private function generateItem(item:String):void{
    switch(item){
        case "ball" : generateBall(); break;
        case "wall" : generateWall(); break;
        case "fall" : generateFall(); break;
}

private function generateBall():void{
//code to generate ball
addChild(ball);
}

private function generateFall():void{
//code to generate fall
addChild(fall);
}

private function generateWall():void{
//code to generate wall
addChild(wall);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-09T08:26:06.490

将您的 arary 行更改为：

```
 var myArray = new Array [ball, wall, fall]; 
```

这应该有效。:)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-03T04:35:19.987

Marty Wallace 因引导我走上 getDefinitionByName() 的道路而备受赞誉。他发布的例子很好，但这个例子正是我想要的。

[http://www.emanueleferonato.com/2011/03/31/understanding-as3-getdefinitionbyname-for-all-eval-maniacs/](http://www.emanueleferonato.com/2011/03/31/understanding-as3-getdefinitionbyname-for-all-eval-maniacs/)

# backbone.js - 如何访问部分 localStorage 数据并在 Backbone 应用程序中呈现它们？

> ID：10405963
> 
> 赞同：0
> 
> 时间：2012-05-01T23:55:56.510
> 
> 标签：backbone.js, local-storage

我使用 localStorage 来保存我的 Backbone 应用程序的应用程序数据。在我的路由器中，我用来`this.collection.fetch()`从 localStorage 获取数据并渲染它们。但`this.collection.fetch()`实际上会在我的 localStorage 空间中获取所有数据并将它们全部呈现在 View 中。我要做的是先获取localStorage数据并过滤它们，然后使用这些过滤的部分来渲染视图。可以这样做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T10:12:16.847

这是因为您可能对集合事件的`bind`看法。`reset`

```
this.collection.on('reset', this.render, this) 
```

如果您想更好地控制要渲染的内容（手动渲染未绑定到事件），则应避免绑定该事件并`render`在对集合进行适当过滤后需要时调用方法。

# r - R中循环中的条形图

> ID：10405967
> 
> 赞同：3
> 
> 时间：2012-05-01T23:56:50.690
> 
> 标签：r, graphics, bar-chart, base

这是我的问题：

```
#data 1:
lab1 <- 1:10
group <- rep(1:3, each = length (lab1))
label <- rep(lab1, 3)
avar <-  rep(c(0, 1, 4, 5, 6, 8, 10,  11, 12,  13), 3)
myd <- data.frame (group, label, avar)

# data 2
fillcol <- rep(rnorm(length(lab1)-1, 0.5, 0.2), 3)
group1 <- rep(1:3, each = length(fillcol)/3)
 # this variable will be used to fill color in bars
 filld <- data.frame(group1, fillcol)

# now plotting
par(mfrow = c(3, 1))
 par(mar = c(2.5, 1, 2.5, 1))

#plot1
myd1 <- myd[myd$group ==1,]
filld1 <- filld[filld$group1 ==1,]
blues <- colorRampPalette(c("yellow", "blue"))
barplot(as.matrix(diff(myd1$avar)), horiz=T, col=blues(10)[10* filld1$fillcol], 
 axes=F, xlab="Mark")
axis(1, labels=myd$label, at=myd$avar)
axis(3, labels=myd$avar, at=myd$avar) 
```

虽然这个示例数据集，我有很多变量，我想自动化这个过程。

```
for (i in 1:length(unique(myd$group))){
         par(mfrow = c(i, 1))
        par(mar = c(2.5, 1, 2.5, 1))
                myd[i] <- myd[myd$group ==i,]
        filld[i] <- filld[filld$group1 ==i,]
      blues <- colorRampPalette(c("yellow", "blue"))
      barplot(as.matrix(diff(myd[i]$avar)), horiz=T, 
   col=blues(10)[10* filld1$fillcol], axes=F, xlab="Mark")
      axis(1, labels=myd[i]$label, at=myd[i]$avar)
        axis(3, labels=myd[i]$avar, at=myd[i]$avar)
        }
 Error in dim(data) <- dim : attempt to set an attribute on NULL
In addition: Warning messages:
1: In `[<-.data.frame`(`*tmp*`, i, value = list(group = c(1L, 1L, 1L,  :
  provided 3 variables to replace 1 variables
2: In `[<-.data.frame`(`*tmp*`, i, value = list(group1 = c(1L, 1L,  :
  provided 2 variables to replace 1 variables 
```

编辑：我想创建一个循环，以便在循环内创建多个图表：

![在此处输入图像描述](../Images/4d7ff60e6fe96ab6ab26b85928173e11.png)

PS：我是 R 和 stackoverflow 的新手。如果问题不合适，请原谅，尽管我阅读了指南并尝试遵守它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:21:50.830

如果你将它包装在这样的函数中，你应该能够让它工作并被多次调用。

```
colbarplot <- function(group) {

    myd1 <- myd[myd$group == group,]
    filld1 <- filld[filld$group1 == group,]
    blues <- colorRampPalette(c("yellow", "blue"))
    barplot(as.matrix(diff(myd1$avar)), horiz=T,
            col=blues(10)[10* filld1$fillcol], 
            axes=F, xlab="Mark")
    axis(1, labels=myd$label, at=myd$avar)
    axis(3, labels=myd$avar, at=myd$avar)
}

par(mfrow = c(3, 1))
par(mar = c(2.5, 1, 2.5, 1))
sapply(unique(myd$group),function(x) colbarplot(x)) 
```

这将在您所追求的一页上提供多个图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T01:59:21.690

这里有两个问题。您无意中覆盖了循环中的“myd”和“filld”。其次，您应该在开始时指定 mfrow，然后生成绘图（本例中为 3）。您正在中间重置 mfrow 。不是你想要的。

试试这个：

```
opar <- par(mfrow = c(length(unique(myd$group)), 1), mar = c(2.5, 1, 2.5, 1))

for (i in 1:length(unique(myd$group))){
    myd1 <- myd[myd$group ==i,]
    filld1 <- filld[filld$group1 ==i,]
    blues <- colorRampPalette(c("yellow", "blue"))
    barplot(as.matrix(diff(myd1$avar)), horiz=T, 
       col=blues(10)[10* filld1$fillcol], axes=F, xlab="Mark")
    axis(1, labels=myd1$label, at=myd1$avar)
    axis(3, labels=myd1$avar, at=myd1$avar)
 }

 par(opar); 
```

# compilation - 如何在 Gradle 中定义编译时 *only* 类路径？

> ID：10405970
> 
> 赞同：63
> 
> 时间：2012-05-01T23:56:55.933
> 
> 标签：compilation, classpath, gradle

有人可以给我一个简单的 build.gradle 示例，说明如何指定不包含在运行时部署（war）中的仅编译时类。

由于“运行时”继承自“编译”，Gradle 似乎以错误的方式解决了这个问题。我无法想象在运行时我想要在编译时不想要的类的情况。但是，在许多情况下，我需要类在编译时生成我不希望在运行时部署的代码！

我已经浏览了臃肿的 gradle 文档，但找不到任何明确的说明或示例。我怀疑这可以通过定义“配置”并将其设置为 CompileJava 插件的类路径来实现 - 但文档不足以解释如何实现这一点。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-05-02T00:23:24.540

关于这个话题已经有很多讨论了，主要是[这里](http://issues.gradle.org/browse/GRADLE-784)，但没有明确的结论。

您走在正确的轨道上：目前最好的解决方案是声明您自己的`provided`配置，这将包括仅编译依赖项并添加到您的编译类路径中：

```
configurations{
  provided
}

dependencies{
  //Add libraries like lombok, findbugs etc
  provided '...'
}

//Include provided for compilation
sourceSets.main.compileClasspath += [configurations.provided]

// optional: if using 'idea' plugin
idea {
  module{
    scopes.PROVIDED.plus += [configurations.provided]
  }
}

// optional: if using 'eclipse' plugin
eclipse {
  classpath {
    plusConfigurations += [configurations.provided]
  }
} 
```

通常这很好用。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-09-12T13:54:15.730

如果你使用*战争*插件，`providedCompile`应该做的伎俩。但是，如果您需要将依赖项排除在**jar**中，则必须扩展该`jar`任务。下面是一个构建“fat jar”或“uber jar”（包含其依赖项的所有类的单个 jar）的示例，不包括标记的依赖项`provided`：

```
configurations {
    provided
    compile.extendsFrom provided
}

dependencies {
    provided "group.artifact:version"
    compile "group.artifact:version"
}

jar {
    dependsOn configurations.runtime
    from {
        (configurations.runtime - configurations.provided).collect {
            it.isDirectory() ? it : zipTree(it)
        }
    } 
} 
```

信用： http: [//kennethjorgensen.com/blog/2014/fat-jars-with-excluded-dependencies-in-gradle/](http://kennethjorgensen.com/blog/2014/fat-jars-with-excluded-dependencies-in-gradle/)

**更新：**

从**Gradle 2.12**开始，定义仅编译依赖项的问题最终通过新的“copmpileOnly”配置以简单自然的方式解决：

```
dependencies {
    compileOnly 'javax.servlet:servlet-api:2.5'
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-06-11T08:07:26.900

我为我的项目设置解决了这个问题。我使用运行 gradle 插件 0.9.+ 和 gradle 1.11 的 Android Studio 主项目使用亚马逊广告和亚马逊应用内购买。它依赖于使用亚马逊设备消息（ADM）的库项目。

我的主要问题是我得到“RuntimeException：Stub！”的 ADM。错误。

1.）图书馆项目：正如他所说，Lukas 提出的“提供的配置”不起作用，所以我使用了 Richards 的方法，但是开箱即用的效果并不好。由于在 aar 文件的 ext_libs 文件夹中找不到该库，因此我不得不对其进行一些更改。Gradle 似乎将所有库打包在最终 aar 文件中的 libs 文件夹中。

```
android.libraryVariants.all { variant ->
variant.packageLibrary.exclude( 'libs/amazon-device-messaging-1.0.1.jar' )
} 
```

2.) 应用项目：在这里，使用“提供的配置”的方法有效。

```
configurations{
    provided
} 
dependencies {
    compile 'fr.avianey:facebook-android-api:+@aar'
    compile files('ext_libs/amazon-ads-5.3.22.jar')
    compile files('ext_libs/in-app-purchasing-1.0.3.jar' )
    provided files('ext_libs/amazon-device-messaging-1.0.1.jar')
}

android.applicationVariants.all {
    variant -> variant.javaCompile.classpath += configurations.provided
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-05-02T16:53:14.517

运行时依赖项不是编译时依赖项是很常见的。另一种方式是一种相当特殊的情况，因此需要在 Gradle 中进行几行配置。我建议在[Gradle 论坛](http://forums.gradle.org)中搜索`provided`.

听起来您真正追求的是为您的*构建*声明依赖项，而不是为编译类路径。这如何完成取决于如何调用所需的功能（Ant 任务、Gradle 任务/插件、构建脚本中的临时使用）。如果您提供有关您尝试做什么的更详细信息，我可以提供更具体的答案。

以下是 Gradle 用户指南中相关信息的一些链接：

*   [构建脚本的外部依赖项](http://gradle.org/docs/current/userguide/userguide_single.html#sec:external_dependencies)
*   [为自定义 Ant 任务声明类路径](http://gradle.org/docs/current/userguide/userguide_single.html#useExternalAntTaskWithConfig)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-09-09T13:36:49.257

如果你使用 WAR 插件，你可以`providedCompile`像这个[例子一样使用](http://www.gradle.org/docs/current/userguide/war_plugin.html#sec%3acustomizing)

```
dependencies {
    compile module(":compile:1.0") {
        dependency ":compile-transitive-1.0@jar"
        dependency ":providedCompile-transitive:1.0@jar"
    }
    providedCompile "javax.servlet:servlet-api:2.5"
    providedCompile module(":providedCompile:1.0") {
        dependency ":providedCompile-transitive:1.0@jar"
    }
    runtime ":runtime:1.0"
    providedRuntime ":providedRuntime:1.0@jar"
    testCompile "junit:junit:4.11"
    moreLibs ":otherLib:1.0"
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-03-30T08:28:41.040

在 Gradle 2.12`compileOnly`中引入了配置。可以在此处找到介绍此功能的博客文章：

[Gradle 最新特性：仅编译依赖项](https://gradle.org/compile-only-dependencies/)

请注意一个重要的副作用：

> 由于添加了“compileOnly”配置，“compile”配置不再代表所有编译时依赖项的完整图景。当需要在构建脚本或自定义插件中引用编译类路径时，应使用适当的源集的 compileClasspath 属性。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-07-10T21:39:47.760

事实证明，他们在 gradle android 插件 0.8.0 中添加了“提供的”配置，但它并不完全有效。它确实将提供的库自动添加到编译路径，但它也将它们包含在最终的 aar/apk 中。

对我有用的是@lukas-hanaceck 提供的解决方案，但通过将名称从“提供”更改为任何其他自定义名称。就我而言，这是一个库项目，它是我最终的 android 应用程序项目的依赖项。这是对我有用的要点。

```
configurations {
   providedlibs
}

dependencies {
   providedlibs files('provided/library.jar')
}

libraryVariants.all {
    variant -> variant.javaCompile.classpath += configurations.providedlibs
} 
```

它编译完美，并且提供的/library.jar 不包含在最终的 apk 中。我遇到的唯一问题是通知 Android Studio library.jar 的存在。这个想法插件似乎不适用于 Android 工作室。我猜他们有另一个用于将 gradle 与工作室同步的自定义插件。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-03-12T09:08:16.067

我没有找到适用于 Android Studio 的解决方案，但这是我尝试过的：

在 android studio 中，我必须更新到 0.5.+ 版

在 gradle/gradle-wrapper.properties 中替换

```
distributionUrl=http\://services.gradle.org/distributions/gradle-1.9-rc-3-bin.zip 
```

经过

```
distributionUrl=http\://services.gradle.org/distributions/gradle-1.11-all.zip 
```

在我所有的 build.gradle 替换

```
buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:0.7.+'
    }
} 
```

经过

```
buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:0.9.+'
    }
} 
```

在我想使用的图书馆中提供

```
configurations {
    provided
}

//put applicationVariants in case it is apply plugin: 'android' and not apply plugin: 'android-library'
android.libraryVariants.all {
    variant -> variant.javaCompile.classpath += configurations.provided
}

dependencies {
    provided files('ext_libs/amazon-device-messaging-1.0.1.jar')
} 
```

最后它不起作用，它似乎适用于 jar 但不适用于 aar 或 apk，如此处所述[https://groups.google.com/forum/#!topic/adt-dev/WIjtHjgoGwA](https://groups.google.com/forum/#!topic/adt-dev/WIjtHjgoGwA)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-12-09T07:22:24.177

在 Android Studio 1.0 中执行以下操作：

```
android.libraryVariants.all { variant ->
    variant.outputs.each { output ->
        output.packageLibrary.exclude('libs/someLib.jar')
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-03T11:33:45.063

OP 显然没有寻找 Android 的答案，但有些答案是针对 Android 的。所以我建议你看看这个页面：[http ://tools.android.com/tech-docs/new-build-system](http://tools.android.com/tech-docs/new-build-system)

0.9.0 版引入了提供的范围。所以，只需使用

```
dependencies {
    provided "groupId:artifcatId:version"
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-04-24T22:31:43.490

我们不需要“提供”，尝试添加这个：

```
android.libraryVariants.all { variant ->
    variant.packageLibrary.exclude( 'ext_libs/amazon-device-messaging-1.0.1.jar' )
} 
```

享受！

# javascript - 用 Javascript 检查 2 个互斥条件的最佳方法？

> ID：10405972
> 
> 赞同：0
> 
> 时间：2012-05-01T23:57:11.203
> 
> 标签：javascript, ajax, setinterval, states

嗨，我有以下代码，用于检查 Rails 模型状态

```
var intervalCall = setInterval(function(){
  $.post("getstatus", {id:id});
  var finished = "<%= @sentence.finished%>";
     //THIS IS CONDITION ONE, IT IS LIKELY TO HAPPEN LATER AND I WANT TO STOP THE SETINTERVAL
  if ("<%= @sentence.result %>"){
        clearInterval(intervalCall);
        state_2();
  }
     //THIS IS CONDITION TWO, IT IS LIKELY TO HAPPEN EARLIER AND I WANT 
    // TO KEEP THE SETINTERVAL RUNNING AFTER IT"S MET
   else if (String(finished)== "true"){
        state_1();
    }
},3000);

intervalCall; 
```

组织这种流程的最佳方式是什么？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T00:44:15.670

```
// setInterval/ setTimeout return the timer id
var intervalCall;
function updateStatus (){
    // post need a callback to process the data response by server
    $.post("getstatus", {id:id}, function  ( data ) {
        data = $.parseJSON ( data ) // asume you use jQuery and the data is a json string
        if ( data.result ){
            state_2(); // if you want the result as a arg, do state_2( data.result )
            return;
        } else {
            // no need to use finished flag, when there is a response and no result, call again
            // anything when no success resulte you want to do could write here

            state_1();
            intervalCall = setTimeout ( updateStatus, 3000 );
        }
    });
},3000);
intervalCall = setTimeout ( updateStatus, 3000 ); 
```

一些更新

# android - ListView 完整按钮消失

> ID：10405975
> 
> 赞同：3
> 
> 时间：2012-05-01T23:57:15.867
> 
> 标签：android, xml, button

我在布局文件中有一个列表视图和一个按钮，看起来不错，但是如果列表视图填满屏幕，按钮就会丢失，请有人告诉我。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:orientation="vertical" >

<ListView
 android:id="@+id/myListView"
 android:layout_width = "fill_parent"
 android:layout_height = "wrap_content"/>

 <Button 
    android:id="@+id/back_button"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_margin="20dip"
    android:text="@string/backButton_label" />

 </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:11:16.427

尝试将`ListView`和包装`Button`在它们自己`LinearLayout`的高度为 0dp 和重量作为总布局高度的一小部分。

例如，下面将给出`ListView`90% 的布局和`Button`10% 的布局。相应地调整值。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="match_parent"
  android:layout_height="wrap_content"
  android:orientation="vertical" >

  <LinearLayout 
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:layout_weight="0.9"
    android:orientation="vertical" >
    <ListView
      android:id="@+id/myListView"
      android:layout_width = "fill_parent"
      android:layout_height = "fill_parent"/>
  </LinearLayout>

  <LinearLayout 
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:layout_weight="0.1"
    android:orientation="vertical" >
    <Button 
      android:id="@+id/back_button"
      android:layout_width="fill_parent"
      android:layout_height="wrap_content"
      android:layout_margin="20dip"
      android:text="@string/backButton_label" />
  </LinearLayout>

</LinearLayout> 
```

# c# - 使用 - User.Identity.Name 在同一控制器中为同一视图使用两个查询

> ID：10405976
> 
> 赞同：0
> 
> 时间：2012-05-01T23:57:17.057
> 
> 标签：c#, asp.net-mvc-3, linq

有问题；在同一个控制器中为同一个视图使用两个查询。

第一次查询

```
var results = from b in db.tbl_Rough
                   .Where(c => c.tbl_Assoc.Username == User.Identity.Name)
                   select b; 
```

第二次查询

```
 var results1 = from  c in db.tbl_Rough
                    .Where(c => c.tbl_Cous.UserName == User.Identity.Name)
                       select c; 
```

上述两个查询都可以正常工作。我想要做的是将它们结合起来，以便它们在同一个视图中工作。需要检查两个查询以查看用户是否有数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T03:05:02.430

我带你

> “需要检查两个查询以查看用户是否有数据”

出来

```
var resultAll = from all in db.tbl_Rough
                .Where(c => c.tbl_Assoc.Username == User.Identify.Name && c.tbl_Cous.UserName == User.Identify.Name)
                select all; 
```

# django - 转储数据，参数太多？

> ID：10405978
> 
> 赞同：3
> 
> 时间：2012-05-01T23:57:39.970
> 
> 标签：django

我们刚刚迁移到新服务器，并通过此命令转储数据（modernpolitcs 是应用程序名称）：

# python manage.py dumpdata modernpolitics > /dump/backup.json

在旧服务器上工作，但现在不在新服务器上工作（在重新安装所有依赖项之后）。

我得到的错误是，“错误：无法序列化数据库：get_db_prep_value() 需要至少 3 个参数（给定 2 个）”

谷歌搜索错误，刚刚找到了一些关于旧 django 开发的“已解决”票证。任何想法可能是什么问题？

蟒蛇 2.7.2 Django 1.4

我可以转储一个模型，例如modernpolitics.question .. 嗯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T00:04:51.667

> get_db_prep_value() 至少需要 3 个参数（给定 2 个）

这个错误听起来很熟悉：支持多数据库的 django`connection`为模型字段采用了一个新参数。

如果您使用任何第三方字段或子类`Field`，则需要更新它们以接受/传递此新参数。

回溯将揭示哪个字段正在中断。

# php - JUser::_load：尽管用户存在于所有 3 个主要 joomla 表中，但无法加载用户

> ID：10405981
> 
> 赞同：0
> 
> 时间：2012-05-01T23:57:51.843
> 
> 标签：php, mysql, joomla

我已经有这个用户了..还活着并踢了 3 个主表，即 jos_user 和其他 2 个 acro_ 和 acro_map ......当我使用来自组件的联系按钮时，我得到了这个错误。

以下是错误：

```
JUser::_load: Unable to load user with id: 160529
Error loading Modules:MySQL server has gone away SQL=SELECT m.*, am.params as adv_params FROM jos_modules as m LEFT JOIN jos_advancedmodules as am ON am.moduleid = m.id WHERE m.published = 1 AND m.access <= 1 AND m.client_id = 0 ORDER BY m.ordering, m.id 
```

请不要担心其他错误（因为我试图为该 frm 托管服务提供商找到解决方案），但目前我对使用“联系我们”按钮时无法在此 joomla 组件中加载用户一无所知

组件的“视图”代码::

```
defined('_JEXEC') or die('Restricted access'); 

$to = "";
$subject = "";
$message = "";
$Itemid = JRequest::getInt('Itemid');

$to = $this->msgSendInfo[0];
$subject = $this->msgSendInfo[1];
$message = $this->msgSendInfo[2];

$document =& JFactory::getDocument();
$document->addScriptDeclaration($this->script);
$document->addScriptDeclaration($this->users);
?>

<!-- Title -->
<div class="fsl_h3title"><b><?php echo JText::_('JBJOBS_NEWMESSAGE'); ?></b></div>
<!--<div runat="server" ID="divContent" class="border" contenteditable="true"> 
    <?php echo $message; ?>
</div>-->
<!-- Begin Form for message -->
<form action="index.php" method="post" name="adminForm" id="adminForm" >
<div class="col100">
    <table class="admintable jbj_tblborder" width="100%">
        <tr>
            <td width="100" align="right" class="key">
                <label for="to">
                    <?php echo JText::_( 'JBJOBS_TO' ); ?>:
                </label>
            </td>
            <td>
                <input class="text_area" type="text" name="to" id="to" size="32" maxlength="100" value="<?php echo $to; ?>" onkeyup="return getUser()"  readonly />
                <!--<select id="toList" style="width: 200px; float: left; margin-left: 8px; vertical-align: middle;" onchange="return setUser()" size="2">
                    <option><?php echo JText::_( 'JBJOBS_NOSUGGESTIONS' ); ?></option>
                </select>-->
            </td>
        </tr>
        <tr>
            <td width="100" align="right" class="key">
                <label for="subject">
                    <?php echo JText::_( 'JBJOBS_SUBJECT' ); ?>:
                </label>
            </td>
            <td>
                <input class="text_area" type="text" name="subject" id="subject" size="48" maxlength="100" value="<?php echo $subject; ?>" />
            </td>
        </tr>
        <tr>
            <td width="100" align="right" class="key">
                <label for="message">
                    <?php echo JText::_( 'JBJOBS_MESSAGE' ); ?>:
                </label>
            </td>
            <td>
                <?php 
                    $editor =& JFactory::getEditor();
                    echo $editor->display('message', $message, '500', '300', '60', '10', true);
                ?>
            </td>

        <!-- Do NOT remove these two input boxes -->
        <input type='hidden' id='temp' />
        <input type='hidden' id='temp2' />

        </tr>

        <tr>
            <td width="100" align="right" class="key">
                <label for="submit">

                </label>
            </td>
            <td>
                <input class="button" type="submit" name="submit" id="submit" size="32" maxlength="100" value="<?php echo JText::_( 'JBJOBS_SEND' ); ?>" />
            </td>
        </tr>
    </table>
</div>
<div class="clr"></div> <!-- Clears the float -->

    <!-- Do not edit after this point, it does not change the visual style -->
    <input type="hidden" name="option" value="com_jbjobs" />
    <input type="hidden" name="task" value="savemessage" />
    <input type="hidden" name="controller" value="jbmessaging" />
    <input type="hidden" name="Itemid" id="Itemid" value="<?php echo $Itemid; ?>" />
    <?php
    jimport('joomla.utilities.date');
    $now = new JDate();
    $date = $now->toMySQL();
    $user =& JFactory::getUser();
    ?>
    <input type="hidden" name="date" value="<?php echo $date; ?>" />
    <input type="hidden" name="idFrom" value="<?php echo $user->id; ?>" />
    <input type="hidden" name="<?php echo JUtility::getToken(); ?>" value="1" />
</form>
<script type='text/javascript'>
    <!--
    getUser();
    //-->
</script> 
```

编辑：我的主人提供的一条说明（对过去 6 个月的辛勤工作的最后一击）

感谢您的联系。问题似乎出在巨大的 joomla 用户表上：

```
# 1267920 users in jos users"
ls -laSh /var/lib/mysql/_final1
total 868M
-rw-rw---- 1 mysql mysql 452M May 2 04:51 jos_jbjobs_jobseeker.MYD
-rw-rw---- 1 mysql mysql 155M May 2 16:47 jos_users.MYD
-rw-rw---- 1 mysql mysql 120M May 2 16:47 jos_users.MYI
-rw-rw---- 1 mysql mysql 45M May 2 04:51 jos_core_acl_aro.MYD
-rw-rw---- 1 mysql mysql 36M May 2 08:30 jos_core_acl_aro.MYI
-rw-rw---- 1 mysql mysql 25M May 2 04:51 jos_core_acl_groups_aro_map.MYD
-rw-rw---- 1 mysql mysql 13M May 2 08:30 jos_jbjobs_jobseeker.MYI 
```

joomla 本身是每 64M 内存限制的限制

当您单击下面的此表单时：

成分 ？联系方式？新联系人

由于大量的用户：

关联用户。此联系人链接到的用户名（如果适用）。

抛出以下 64M 限制的错误

```
Fatal error: Allowed memory size of 67108864 bytes exhausted (tried to allocate 76 bytes) in /home/ink/public_html/libraries/joomla/database/database/mysql.php on line 462 
```

这种情况下实际消耗的内存远不止1G。所以它不像服务器问题更像是一个 joomla 问题本身，显然 joomla 不是为这么多用户设计的。如果您有任何其他问题或疑虑，请告诉我们。

所以我猜 joomla 可能无法处理 100 万或 500 万用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:09:50.153

错误消息暗示 MySQL 尚未从您的查询中返回

```
Error loading Modules:MySQL server has gone away 
```

*   这可能是查询执行超时
*   PHP 没时间了
*   或者内存不足。

您的用户 ID 表明有大量用户 - 您的服务器能胜任这项工作吗？

**[编辑]** 您刚刚添加的错误是 PHP 错误，表示您已经用尽了 PHP*允许*使用的内存，而不是 Joomla!。顺便问一下Joomla 的什么版本！你正在用吗？有了这么多用户，我会倾向于使用 MySQLi，它应该会稍微快一点，效率更高。查看错误消息中指示的行，您似乎在 1.5.x

检查您在 Joomla 中的 PHP 设置！转到`Help->System Info->PHP Information`然后查找`memory_limit`以找出您的服务器 PHP 配置是什么。继续显示错误消息，它是 64 Mbs。顺便说一句，您的主人应该知道这一点...

**[编辑 2]** 顺便说一句，Joomla 中没有！代码库是否执行`ini_set('memory_limit', '64M')`或类似操作，实际上除了几次调用来检查`memory_limit`使用情况之外，`ini_get('memory_limit')`我在 Joomla 核心中找不到任何设置内存限制的内容。

# ios - 如何根据用户选择场景（UIStoryBoard）？

> ID：10405982
> 
> 赞同：0
> 
> 时间：2012-05-01T23:58:17.687
> 
> 标签：ios, ios5, uistoryboard

我正在使用故事板。
基本上我的应用程序是关于

在第一次启动时
- 你得到一个导航控制器 + 视图控制器（我们称之为 View A）
- 你被要求登录 在

其他启动时
- 你仍然得到一个导航控制器但是 -
如果你已登录，我想立即进入新视图（我们称之为视图 B） -
如果您没有登录，我想显示视图 A

如果（登录）显示视图 B否则我该怎么做如果（未登录
）显示视图 A

使用 .xib，这并不太难，但是使用 Storyboards，我真的不知道如何使它工作？
谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:17:55.690

这是您可以做的事情，我不确定这是否是最好的方法，但是，您可以将 viewB 作为您的主要视图，并且在您打开时，最初只需从 B->A 创建一个 segue。这将使您有机会控制您的 2 个视图，然后检查用户是否已登录，如果用户已经登录，则只需弹出 viewA 如果不让用户登录然后弹出。

或者您可以采用不同的方法，您可以创建另一个视图，例如 viewC，并从该视图创建 2 个连接到另一个 2 以控制视图加载操作。

希望这可以帮助 ..

# ruby-on-rails - capistrano 和 rake 在部署的服务器上使用 ext/multistage 和 rake 0.9.2.2 vs 0.9.2 的问题

> ID：10405983
> 
> 赞同：1
> 
> 时间：2012-05-01T23:58:18.043
> 
> 标签：ruby-on-rails, capistrano

我想在服务器上建立一个登台环境。我目前正在使用 capistrano 进行部署。

我对 ext/multistage 扩展进行了更改，但出现以下错误：

```
# Add RVM's lib directory to the load path.
  * executing "cd /data/sites/staging.domain.com/apps/app/releases/20120501225426 && rake RAILS_ENV=production  db:migrate"
    servers: ["173.111.158.135"]
    [173.111.158.135] executing command
*** [err :: 173.111.158.135] rake aborted!
*** [err :: 173.111.158.135] Could not find rake-0.9.2.2 in any of the sources
*** [err :: 173.111.158.135] 
*** [err :: 173.111.158.135] (See full trace by running task with --trace)
*** [err :: 173.111.158.135] 
    command finished in 1332ms
failed: "rvm_path=/usr/local/rvm /usr/local/rvm/bin/rvm-shell '1.9.2' -c 'cd /data/sites/staging.domain.com/apps/app/releases/20120501225426 && rake RAILS_ENV=production  db:migrate'" on 173.111.158.135 
```

在我的 gemfile 中，我有：

```
gem 'rake', '0.9.2.2' 
```

在我的本地机器上，我得到：

```
Tue May 01$ rake -V
rake, version 0.9.2.2
Tue May 01$ 
```

在服务器上，我有：

```
#rake -V
rake, version 0.9.2

#rake
Could not find rake-0.9.2.2 in any of the sources
Run `bundle install` to install missing gems. 
```

如果我运行以下命令：

```
# which ruby
/usr/local/rvm/rubies/ruby-1.9.2-p290/bin/ruby
# which rake
/usr/local/rvm/gems/ruby-1.9.2-p290/bin/rake
# /usr/local/rvm/gems/ruby-1.9.2-p290/bin/rake -V
rake, version 0.9.2 
```

上限错误似乎有点神秘。谁能帮我解决这个问题？如果我指定了 0.9.2.2 并且它只有 9.2，为什么我的其他 cap 脚本会起作用？有没有一种方法可以强制 capistrano 安装我目前没有安装的 rake 0.9.2.2，我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:00:30.723

`bundle exec rails something`例如，当您忘记时，通常会出现该错误。capistrano 是否要求/想要一个捆绑命令来捆绑安装这些宝石？

编辑：是的，我敢打赌你的项目没有预料到这一点：`rake RAILS_ENV=production db:migrate`但也许`bundle exec rake RAILS_ENV=production db:migrate`.

但是，我不确定您如何设置上限。

这是一个rails 3项目是吗？

# java - 用于 HTTP 绑定的 SAML

> ID：10405986
> 
> 赞同：0
> 
> 时间：2012-05-01T23:58:41.333
> 
> 标签：java, web-services, security, http, saml

我有一个带有 SOAP 绑定和 SAML 令牌的 Web 服务被传递给它。是否也有任何**标准**做法将 SAML 应用于 HTTP 绑定？你能提出任何替代方案吗？

（我需要 HTTP 绑定，因为我想使用 KVP 请求和 image/jpg mime 类型）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:36:50.557

如果您询问如何使用 SAML 令牌对 http 请求进行身份验证，一般的答案是您不需要。您使用 SAML 令牌对服务进行身份验证，然后为 http 请求分发 cookie。至少，这是为最终用户完成的。

如果您使用 API（例如 REST API）做某事，那么您会做类似但没有 cookie 的事情。您进行 API 调用以进行身份​​验证，将有效的 SAML 令牌交给它，这将为您提供一个密钥，然后您使用这些密钥对整个请求进行签名 (HMAC)。这可以在授权标头中完成（这是正确的方法）或作为参数附加。服务器检查消息上签名/HMAC 的有效性，如果有效，则执行 API 调用。

[这](http://www.thebuzzmedia.com/designing-a-secure-rest-api-without-oauth-authentication/)是对技术的长期讨论。[这](http://msdn.microsoft.com/en-us/library/dd203052.aspx)是有关这样做的 MSDN 文章。虽然它适用于 C#，而不是 java，但安全注意事项部分是直接适用的，并且是我在一些简短的谷歌搜索中发现的最好的部分。

# xml - XML XSLT %0A%09%09 ? 使固定？

> ID：10405988
> 
> 赞同：2
> 
> 时间：2012-05-01T23:58:42.757
> 
> 标签：xml, eclipse, xslt

我的哈希 (#) "%0A%09%09#2" 前面附加了奇怪的字符，我使用的是 Eclipse 和 java 处理器 Xalan 2.7.1

```
 <xsl:for-each select="fps-photo-atlas/portion">
<a>
<xsl:attribute name="href" >
    #<xsl:value-of select="normalize-space(food-number)" />
</xsl:attribute>
<xsl:value-of select="food-description" />
</a>
</xsl:for-each> 
```

首选输出是...

```
 <body><a href="#1">Rice </a></body> 
```

实际输出是..

```
 <body><a href="%0A%09%09#1">Rice </a></body> 
```

已修复解决方案（感谢 Ign）

```
<xsl:attribute name="href" >#<xsl:value-of select="normalize-space(food-number)" /></xsl:attribute> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:36:19.003

样式表中的文本节点会[被去除空格](http://www.w3.org/TR/xslt#strip)，除非以下情况之一适用：

*   它直接位于“xsl:text”元素内
*   它包含一个非空白字符
*   它通过使用 'xml:space' 属性来保留

不需要的空格与您的 # 字符位于同一文本节点中，因此会被保留。

有几种方法可以排除不需要的空格。

使用[属性值模板](http://www.w3.org/TR/xslt#attribute-value-templates)而不是“xsl:attribute”。

```
<a href="#{normalize-space(food-number)}">
    <xsl:value-of select="food-description" />
</a> 
```

将 # 字符移动到“xsl:text”元素中。

```
<a>
    <xsl:attribute name="href" >
        <xsl:text>#</xsl:text>
        <xsl:value-of select="normalize-space(food-number)" />
    </xsl:attribute>
    <xsl:value-of select="food-description" />
</a> 
```

将 # 字符移动到“value-of”表达式中。

```
<a>
    <xsl:attribute name="href" >
        <xsl:value-of select="concat('#',normalize-space(food-number))" />
    </xsl:attribute>
    <xsl:value-of select="food-description" />
</a> 
```

从样式表中删除空格。

```
<a>
    <xsl:attribute name="href" >#<xsl:value-of select="normalize-space(food-number)></xsl:attribute>
    <xsl:value-of select="food-description" />
</a> 
```

# c++ - 在 Delphi 中从 c++ DLL 调用函数

> ID：10405991
> 
> 赞同：12
> 
> 时间：2012-05-01T23:58:54.250
> 
> 标签：c++, delphi, dll, delphi-7

我在 VS2010 中创建了一个新的 c++ DLL 项目，它公开了 1 个函数

```
#include "stdafx.h"    
#define DllImport   extern "C" __declspec( dllimport )
#define DllExport   extern "C" __declspec( dllexport )    
DllExport int DoMath( int a, int b) {
    return a + b ; 
} 
```

然后我用 VS2010 创建了一个 C++ 应用程序来测试这个 DLL。在VS2010中构建的测试应用程序可以调用c++ DLL并获得预期的结果。

```
#include "stdafx.h"
#include <windows.h>

typedef int (*DoMath)(int, int) ; 
int _tmain(int argc, _TCHAR* argv[])
{
    HMODULE hMod = LoadLibrary ("exampleDLL.dll");
    if (NULL != hMod) {
        DoMath mf1 = (DoMath) GetProcAddress(hMod,"DoMath");
        if( mf1 != NULL ) {
            printf ("DoMath(8,7)==%d \n", mf1(8,7) );   
        } else {
            printf ("GetProcAddress Failed \n");
        }
        FreeLibrary(hMod);
    } else { 
        printf ("LoadLibrary failed\n");
        return 1;
    }
    return 0;
} 
```

接下来我尝试在 Delphi 7 中构建一个新项目来调用这个 C++ DLL。我使用[本教程](http://www.drbob42.com/delphi/headconv.htm)来帮助我构建新项目。

```
unit Unit1;
interface
uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls;

type
  TmyFunction = function(X,Y: Integer):Integer;

  TForm1 = class(TForm)
    Button1: TButton;
    Edit1: TEdit;
    procedure FormShow(Sender: TObject);
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
    hDll: THandle;
  end;

var
  Form1: TForm1;
  fDoMath : TmyFunction;

implementation
{$R *.dfm}

procedure TForm1.FormShow(Sender: TObject);
begin
  hDll := LoadLibrary('exampleDLL.dll');
   if HDll >= 32 then { success }
   begin
     fDoMath := GetProcAddress(hDll, 'DoMath');
   end
   else
     MessageDlg('Error: could not find exampleDLL.DLL', mtError, [mbOk], 0)
end;

procedure TForm1.Button1Click(Sender: TObject);
 var i: Integer;
begin
 i := fDoMath(2,3);
 edit1.Text := IntToStr(i);
end;
end. 
```

Delphi 7 项目的结果是*6155731*当我期望*5*时。我检查了结果的二进制文件，认为它可能与数据类型有关，但在我看来它是随机的。当我重新编译/重新运行应用程序时，每次都会得到相同的结果。

我对 Delphi 了解不多，这是我第一次处理它，我觉得它很混乱。

关于下一步检查什么的任何建议？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-02T00:01:46.857

您需要指定调用约定，在本例中为`cdecl`：

```
TMyFunction = function(X, Y: Integer): Integer; cdecl; 
```

您的代码使用默认的 Delphi 调用约定，即`register`通过寄存器传递参数。调用约定在`cdecl`堆栈上传递参数，因此这种不匹配解释了为什么两个模块之间的通信失败。

* * *

还有一些评论：

的失败模式`LoadLibrary`是返回`NULL`，即`0`。检查，而不是返回值是`>=32`.

使用隐式链接来导入这个函数更简单。用这个简单的声明替换所有的`LoadLibrary`和代码：`GetProcAddress`

```
function DoMath(X, Y: Integer): Integer; cdecl; external 'exampleDLL.dll'; 
```

系统加载器将在您的可执行文件启动时解析此导入，因此您不必担心链接的细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-30T10:56:54.577

在 RAD Studio Berlin 中，对于 C++ 部分使用 CLANG 编译器，作为 extern "C" 的 cdecl 函数将在其名称前加上下划线、传统的 unix "C" 样式。上面的代码在这种情况下不起作用，但是使用外部声明的 name 属性来解决问题：

函数DoMath（X，Y：整数）：整数；cdecl; 外部“exampleDLL.dll”名称“_DoMath”；

没有用其他编译器尝试过，所以它可能是 cdecl 的一个普遍问题。Windows API 不使用 cdecl，但使用与 Delphi 相同的调用约定，例如，DLL 函数的 Winapi.Windows 声明没有添加下划线。

如果使用 GetProcAddress 也是如此，正确的调用是 GetProcAddress(hDLL, '_DoMath'); 否则返回 nil。

希望这可以帮助任何努力让 Delphi 与 C++ 对话的人。

# java - 从 JTable 中删除列

> ID：10405994
> 
> 赞同：2
> 
> 时间：2012-05-01T23:59:27.280
> 
> 标签：java, swing, jtable

我正在制作一个与图形相关的程序，因此我需要从 JTable 中动态创建/删除列来模拟邻接表。我已经可以在需要时创建列，但我无法删除它们，因为如果我删除一列然后我创建另一列，则以前的数据（来自已删除的列）显示在最新列中。

我读过这是因为列数据没有从表模型中删除。我已经看到了隐藏或显示列的示例，但我确实需要删除它们，所以当我得到二维数据矩阵时，我没有交叉引用也没有坏数据。

第一次更正：

```
private DefaultTableModel removeCol(int id){
        DefaultTableModel tmp = new DefaultTableModel();
        int columnas = modelo.getColumnCount();
        for(int i=0;i<columnas;i++){
            if(i!=id)
                tmp.addColumn(modelo.getColumnName(i));
        }
        int rows = modelo.getRowCount();
        String datos[] = new String[columnas-1];
        for(int row=0;row<rows;row++){
            for(int col=0,sel=0;col<columnas;col++,sel++){
                if(col!=id)
                    datos[sel] = (String) modelo.getValueAt(row, col);
                else
                    sel--;
            }
            tmp.addRow(datos);
        }
        return tmp;

    } 
```

调用时：

```
 DefaultTableModel mo = removeCol(i);
    tblTrans = new JTable(mo); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T04:44:59.803

邻接[*矩阵*](http://en.wikipedia.org/wiki/Adjacency_matrix)在 中可能更容易操作`AbstractTableModel`，您可以在其中显式操作行以省略一列。概括地说，

```
class MatrixModel extends AbstractTableModel {

    private int rows;
    private int cols;
    private Boolean[][] matrix;

    MatrixModel(int rows, int cols) {
        this.rows = rows;
        this.cols = cols;
        matrix = new Boolean[rows][cols];
    }

    public void deleteColumn(int col) {
        for (Boolean[] row : matrix) {
            Boolean[] newRow = new Boolean[row.length - 1];
            // TODO: copy remaining values
            row = newRow;
        }
        this.fireTableStructureChanged();
    }
    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T13:57:32.870

例如

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Stack;
import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.table.TableColumn;

public class MyDialog extends JDialog {

    private static final long serialVersionUID = 1L;
    private String[] columnNames = {"First Name", "Last Name", "Sport", "# of Years", "Vegetarian"};
    private Stack<TableColumn> colDeleted = new Stack<TableColumn>();

    public MyDialog() {
        Object[][] data = {{"Mary", "Campione", "Snowboarding", new Integer(5), false},
            {"Alison", "Huml", "Rowing", new Integer(3), true},
            {"Kathy", "Walrath", "Knitting", new Integer(2), false},
            {"Sharon", "Zakhour", "Speed reading", new Integer(20), true},
            {"Philip", "Milne", "Pool", new Integer(10), false}};
        final JTable table = new javax.swing.JTable(data, columnNames);
        table.setPreferredScrollableViewportSize(table.getPreferredSize());
        add(new JScrollPane(table));
        final JButton button1 = new JButton("Add Col");
        final JButton button = new JButton("Remove Last Col");
        button.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent arg0) {
                if (table.getColumnCount() > 0) {
                    TableColumn colToDelete = table.getColumnModel().getColumn(table.getColumnCount() - 1);
                    table.removeColumn(colToDelete);
                    table.validate();
                    colDeleted.push(colToDelete);
                    button1.setEnabled(true);
                } else {
                    button.setEnabled(false);
                }
            }
        });
        button1.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent arg0) {
                if (colDeleted.size() > 0) {
                    table.addColumn(colDeleted.pop());
                    table.validate();
                    button.setEnabled(true);
                } else {
                    button1.setEnabled(false);
                }
            }
        });
        JPanel southPanel = new JPanel();
        southPanel.add(button);
        southPanel.add(button1);
        add(southPanel, BorderLayout.SOUTH);
        setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);
        pack();
        setLocation(150, 150);
        setVisible(true);
    }

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                MyDialog myDialog = new MyDialog();
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T12:02:00.500

因为 DefaultModelTable 没有 removeColumn 可以使用此代码：

```
private String[] getRemainingIdentifiers(int columnIndex) {

    String[] identifiers = new String[table.getColumnCount() - 1];
    int k = 0;

    for(int i = 0; i < table.getColumnCount(); i++) {
        if(i != columnIndex) {
            identifiers[k++] = table.getColumnName(i);
        }
    }

    return identifiers;
}

private void removeColumn(int columnIndex) {

    String[][] data = new String[table.getRowCount()][table.getColumnCount() - 1];

    for(int i = 0; i < table.getRowCount(); i++) {
        for(int j = 0; j < table.getColumnCount(); j++) {

            if(j != columnIndex) {
                if(table.getValueAt(i, j) == null) {
                    table.setValueAt("", i, j);
                }
                if(j < columnIndex) {
                    data[i][j] = table.getValueAt(i, j).toString();
                } else {
                    data[i][j - 1] = table.getValueAt(i, j).toString();
                }
            }
        }
    }

    modeltable = new DefaultTableModel(data, getRemainingIdentifiers(columnIndex));
    table.setModel(modeltable);

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-06T01:48:50.383

DefaultDataModel并没有真正的removeColumn()函数，所以我自己写了一个函数，实际上可以解决问题。

```
private void removeColumn(int index, JTable myTable){
    int nRow= myTable.getRowCount();
    int nCol= myTable.getColumnCount()-1;
    Object[][] cells= new Object[nRow][nCol];
    String[] names= new String[nCol];

    for(int j=0; j<nCol; j++){
        if(j<index){
            names[j]= myTable.getColumnName(j);
            for(int i=0; i<nRow; i++){
                cells[i][j]= myTable.getValueAt(i, j);
            }
        }else{
            names[j]= myTable.getColumnName(j+1);
            for(int i=0; i<nRow; i++){
                cells[i][j]= myTable.getValueAt(i, j+1);
            }
        }
    }

    DefaultTableModel newModel= new DefaultTableModel(cells, names);
    myTable.setModel(newModel);       
} 
```