# StackOverflow 问答 000587000-000587999

# asp.net - LINQ to Objects 自动递增编号

> ID：587012
> 
> 赞同：7
> 
> 时间：2009-02-25T17:34:55.893
> 
> 标签：asp.net, vb.net, linq-to-objects

这感觉像是一个完全基本的问题，但是，就我的一生而言，我似乎无法找到一个优雅的解决方案。

基本上，我正在做一个 LINQ 查询，从查询中创建一个新对象。在新对象中，我想生成一个自动递增的数字，以允许我保留选择顺序以供以后使用（`Iter`在我的示例中命名）。

这是我当前的解决方案，可以满足我的需要：

```
 Dim query2 = From x As DictionaryEntry In MasterCalendarInstance _
                 Order By x.Key _
                 Select New With {.CalendarId = x.Key, .Iter = 0}

    For i = 0 To query2.Count - 1
        query2(i).Iter = i
    Next 
```

有没有办法在 LINQ 查询的上下文中执行此操作（这样我就不必在查询后循环集合）？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-25T17:41:03.833

请原谅我在 C# 中执行此操作，不确定 VB.NET 中的语法：

```
MasterCalendarInstance
    .OrderBy(x => x.Key)
    .Select((x, ixc) => new { CalendarId = x.Key, Iter = ixc }); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-25T17:40:02.230

我不知道这在 VB 中是否可行，但在 C# 中使用闭包：

```
int count = 0
var res = from x in MasterCalendarInstance
          order by x.Key
          select new {
            CalendarId = x.Key,
            Iter = count++
          }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-05T18:54:53.133

上述解决方案可以在 VB.NET 中总结如下：

```
MasterCalendarInstance _
    .OrderBy(Function (x) x.Key) _
    .Select(Function (x, ixc) New With { .CalendarId = x.Key,
                                         .Iter = ixc }) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-11T18:45:56.977

我在尝试使用 List(of String) 解决类似问题时遇到了这篇文章。

我发布了我的解决方法，希望它可以被用来解决您的问题，但对于遇到此问题的任何其他人来说更多的是 List(Of T)。

```
Dim list As New List(Of String)
list.Add("Test1")
list.Add("Test2")
list.Add("Test3")

Dim var = list.Select(Function(s) New With {.Name = s, .RecordID = list.IndexOf(s)}) 
```

希望这可以帮助！

# delphi - 如何在带有 BlackFish 的 DBx4 中使用整数自动增量字段？

> ID：587018
> 
> 赞同：1
> 
> 时间：2009-02-25T17:36:18.043
> 
> 标签：delphi, auto-increment, dbexpress, blackfish

我正在尝试将 dbx4 中的自动增量字段与黑鱼数据库一起使用我有一个简单的表结构：

```
 CREATE TABLE tblTABname (
    ID int AUTOINCREMENT Primary Key,
    Description varchar(100) NOT NULL ); 
```

在打开之前我正在做：

```
qryTAB.FieldByName( ‘ID’).AutoGenerateValue := arAutoInc;
cdsTAB.FieldByName( ‘ID’).AutoGenerateValue := arAutoInc; 
```

打开后：

```
qryTab.FieldByName('ID').ProviderFlags := [pfInWhere, pfInKey];
cdsTab.FieldByName('ID').ProviderFlags := [pfInWhere, pfInKey]; 
```

如果我做：

```
cdsTAB.Edit;
cdsTAB.FieldByName(‘Description’).value := ‘Test’;
cdsTAB.Post; 
```

或者，如果我在 DBGRID 中使用它，它会失败并出现错误：

> “字段‘ID’必须有值”</p>

女巫应该已经生成了。

如果我运行 INSERT 查询，不管有没有“AutoGenerateValue := arAutoInc”行，它都可以正常工作。

我该如何克服这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T16:06:13.413

不要调用 CDSTab.EDIT，而是调用 CDSTab.INSERT 添加新行，仅当光标位于记录上时才调用 CDSTab.EDIT，并编辑该记录的值。

# database - 客户端应用程序立即对数据库中的更新做出反应的最佳方式是什么？

> ID：587027
> 
> 赞同：10
> 
> 时间：2009-02-25T17:37:30.893
> 
> 标签：database, ajax, triggers, rfc

对数据库中的数据更新立即做出反应的最佳方式是什么？

我能想到的最简单的方法是一个线程，它检查数据库中某些数据的特定更改，并在某个预定义的时间长度内不断等待再次检查它。这个解决方案对我来说似乎是浪费和次优的，所以我想知道是否有更好的方法。

我想肯定有某种方法，毕竟像 gmail 这样的网络应用程序似乎能够在向我发送新电子邮件后几乎立即更新我的收件箱。当然，我的客户并不是一直在不断检查更新。我认为他们这样做的方式是使用 AJAX，但是我不知道 AJAX 如何表现得像一个远程函数调用。我很想知道gmail是如何做到这一点的，但我最想知道的是如何在一般情况下使用数据库来做到这一点。

编辑：请注意我想立即对客户端代码中的更新做出反应，而不是在数据库本身中，所以据我所知触发器不能这样做。基本上我希望用户在数据库发生更改后收到通知或更新他的屏幕。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T01:39:07.617

您在这里基本上有两个问题：

1.  您希望浏览器能够从 Web 应用程序服务器接收异步事件，而无需在紧密循环中进行轮询。

2.  您希望 Web 应用程序能够从数据库接收异步事件，而无需在紧密循环中进行轮询。

**对于问题 #1**

请参阅这些维基百科链接，了解我认为您正在寻找的技术类型：

*   [彗星](http://en.wikipedia.org/wiki/Comet_%28programming%29)
*   [反向 AJAX](http://en.wikipedia.org/wiki/Reverse_Ajax)
*   [HTTP 服务器推送](http://en.wikipedia.org/wiki/Push_technology#HTTP_server_push)

编辑：2009 年 3 月 19 日 - 刚刚遇到[ReverseHTTP](http://www.reversehttp.net/)，这可能对问题 #1 感兴趣。

**对于问题 #2**

该解决方案将特定于您正在使用的数据库，并且可能还针对您的服务器使用的数据库驱动程序。例如，对于[PostgreSQL](http://www.postgresql.org/) ，您将使用[LISTEN](http://www.postgresql.org/docs/8.3/interactive/sql-listen.html)和[NOTIFY](http://www.postgresql.org/docs/8.3/interactive/sql-notify.html)。（并且冒着被否决的风险，您可能会使用数据库触发器在更改表数据时调用 NOTIFY 命令。）

另一种可能的方法是，如果数据库有[一个接口](http://www.postgresql.org/docs/8.3/interactive/spi.html)来创建链接到动态库（即，DLL 或.so 文件）的存储过程或触发器。[然后你可以用C 或其他语言](http://www.postgresql.org/docs/8.3/interactive/triggers.html)编写服务器信号代码。

在同一主题上，一些数据库允许您使用[Java](http://www.postgresql.org/docs/8.3/interactive/external-pl.html) [、Ruby](http://www.postgresql.org/docs/8.3/interactive/external-pl.html)、[Python](http://www.postgresql.org/docs/8.3/interactive/plpython.html)等语言编写存储过程。您可能可以使用其中之一（而不是像 C 那样编译为机器代码 DLL 的东西）作为信号机制。

希望这能给你足够的想法来开始。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-25T17:47:38.280

> 我想肯定有某种方式，毕竟像 gmail 这样的网络应用程序似乎在向我发送新电子邮件后几乎立即更新我的收件箱。当然，我的客户并不是一直在不断检查更新。我认为他们这样做的方式是使用 AJAX，但是我不知道 AJAX 如何表现得像一个远程函数调用。我很想知道gmail是如何做到这一点的，但我最想知道的是如何在一般情况下使用数据库来做到这一点。

找个时间看一下wireshark……似乎那里经常有一些谷歌流量。

根据您的数据库，触发器可能会有所帮助。我编写的一个应用程序依赖于触发器，但我使用轮询机制来真正“知道”某些事情发生了变化。我会说，除非您可以将更改从数据库中传达出来，否则某些轮询机制是必要的。

只是我的两分钱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T17:39:49.577

好吧，*最好*的方法是数据库[触发器](http://en.wikipedia.org/wiki/Database_trigger)。取决于您未指定的 DBMS 支持它们的能力。

重新编辑：Gmail 等应用程序的做法实际上是使用 AJAX 轮询。安装[Tamper Data](https://addons.mozilla.org/en-US/firefox/addon/966) Firefox 扩展以查看它的运行情况。诀窍是在“没有消息”的情况下保持您的投票查询速度极快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T18:01:30.663

不幸的是，没有办法将数据推送到 Web 浏览器——你只能发送数据作为对请求的响应——这正是 HTTP 的工作方式。

不过 AJAX 是您想要使用的：每秒调用一次 Web 服务并不过分，只要您设计 Web 服务以确保它接收少量数据、发送回少量数据并且可以非常快速地运行以生成那个回应。

# php - 如何在其他地方的 WordPress 帖子或页面点上制作预览链接？

> ID：587028
> 
> 赞同：4
> 
> 时间：2009-02-25T17:38:14.340
> 
> 标签：php, wordpress, content-management-system

我最近做了很多小项目，客户希望网站的大部分内容保持不变，他们只是希望能够编辑网站的特定“区域”。即，某处某个框中的某些文本。

我发现 WordPress 可以很好地解决这个问题。界面很好，使用起来很友好，它背后有很多工作，所以我不必重新发明轮子，修复错误等。

所以我最终要做的是制作看起来像客户想要的 PHP 页面，然后让内容可编辑区域包含特定的帖子或页面，这在 WordPress 中是可编辑的。

我正在使用这样的代码在页面上显示特定页面的内容

```
<?php echo apply_filters('the_content', $page_Contact->post_content); ?> 
```

where`$page_Contact`是在别处定义的变量。

但是，每个页面/帖子上的“预览”或“查看页面”/“查看帖子”功能会转到逻辑 WordPress 位置，这不是我在这种情况下想要的效果。

所以例如我有这样的页面

```
www.site.com/index.php
www.site.com/about.php
www.site.com/contact.php 
```

等等。

WordPress 希望将“查看页面”和“预览更改”链接放在类似的地方

```
www.site.com/?page_id=2
www.site.com/?page_id=8&preview=true&preview_id=8&preview_nonce=45522671f5 
```

这是一个问题，因为在上面的永久链接结构中，这两个都转到 index.php 页面，除了我用来构建 index.php 的页面之外，它不是我希望用户/编辑器去的地方。以上所有情况都不允许进行任何形式的预览（考虑到我的做法，这是我愿意做出的让步）

有没有办法，**最好使用插件**来安装 WordPress，以便仪表板中页面的预览转到将容纳内容的 non-index.php 页面的预览？因此，例如 WordPress 仪表板中“联系”页面的链接会转到`contact.php`而不是`?page_id=2`? 这是一个我试图*在编辑界面中*完成的交易，我不关心网站本身的链接。

显然，我需要维护每个页面，这将是新页面不会出现的情况，除非我把它们放在那里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T18:21:59.680

看看`preview_post_link`WordPress 中的钩子——它应该在生成该链接时调用，您可以将它与自定义字段（或某些逻辑）结合使用，以构建您喜欢的任何预览链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T18:01:21.523

您是否考虑过指向 wordpress 插件的[页面链接？](http://txfx.net/code/wordpress/page-links-to/)还更改永久链接？

# javascript - IE 与 Firefox 中的 Javascript

> ID：587029
> 
> 赞同：0
> 
> 时间：2009-02-25T17:38:24.747
> 
> 标签：javascript, dom

以下脚本在 IE7 中运行良好，但在 Firefox 3 中无法执行。显示的 div 标签：无；在 IE 中显示，但在 FF 中从未显示。我不是客户/ javascript 人...谢谢。

```
<script type="text/javascript">
//<![CDATA[
document.getElementById("Fred1_Panel").style.setAttribute("display","inline");//]]>

</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T17:43:25.357

试试这个：

```
document.getElementById("Fred1_Panel").style.display = ''; 
```

或者

```
document.getElementById("Fred1_Panel").style.display = 'inline'; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T17:43:11.537

这将适用于两种浏览器：

```
document.getElementById("Fred1_Panel").style.display = 'inline'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T17:46:33.807

在 FF 中，从 Tools | 错误控制台或 FireBug 的控制台是查看正在发生的错误的好方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T17:51:43.030

此代码应该可以工作：

```
document.getElementById("Fred1_Panel").style.display = "inline";

```

一般来说，如果您在 Firefox 中遇到问题，您可以使用 Firebug 插件或简单地查看错误控制台轻松发现确切的问题（并可能找到解决方案）。

# .net - 如何在 .Net 中获得类似 Excel 的公式？

> ID：587033
> 
> 赞同：0
> 
> 时间：2009-02-25T17:38:42.997
> 
> 标签：.net, dynamic

*   我应该使用商业组件吗？
*   我应该滚动自己的表达式评估器吗？
*   我应该推出自己的动态语言吗？

我知道程序员因想要编写自己的语言而臭名昭著，但这里并非如此。工作越少越好。让我们假设与 Excel 公式的兼容性不是严格要求；如果有一个可捕捉组件使用的公式与 Excel 公式不完全相同，那很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T17:46:17.237

Luca Bolognese 发布了一个 .NET 库，该库提供了 Excel 的全套财务功能。该库的主要目标是通过提供相同的功能与 Excel 兼容

[http://blogs.msdn.com/lucabol/archive/2008/12/04/financial-functions-for-net-released.aspx](http://blogs.msdn.com/lucabol/archive/2008/12/04/financial-functions-for-net-released.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T17:42:09.777

如果您不需要网格格式，您可以使用[此处](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)发布的 .net 3.5 动态表达式，它们将允许您将文本评估为 lambda 表达式并编译和运行。它们可以服务于某个目的，不需要严格用于 linq。

如果您确实需要网格格式，您可能仍然可以使用动态表达式，但网格组件本身就是另一种野兽。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T17:46:41.980

[Infragistics](http://www.infragistics.com/dotnet/netadvantage/aspnet/webcalcmanager.aspx)尽管我讨厌他们的控件套件，但它有一个功能齐全的 C# 公式解释器运行时评估引擎，可以很好地与他们的网格控件配合使用。他们的部分许可证允许您访问源代码。我很好奇他们是如何构建它的，发现他们使用了一个名为[Grammatica](http://grammatica.percederberg.net/)的开源项目作为他们的起点（非常酷）。

# oracleinternals - Oracle 数据文件自动扩展问题

> ID：587035
> 
> 赞同：3
> 
> 时间：2009-02-25T17:39:25.070
> 
> 标签：oracleinternals

如果我有 2 个数据文件附加到一个表空间，并且 BOTH 都设置为 AUTOEXTEND 并且 BOTH 都设置为无限制，那么 Oracle 会知道扩展这两个数据文件，还是只扩展其中一个。我已经阅读了许多手册，但没有一个能回答这个问题。至于为什么这样设置，嗯，这是我开始调整的继承系统。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T18:31:43.633

这取决于您有多少磁盘空间（除其他外）。在这种情况下，“无限”是指“到您平台上支持的最大表大小”，而不是“即使您无法使用它，也要占用所有磁盘空间”。如果您有足够的磁盘空间容纳两个最大大小的数据文件，那应该没问题。

另外（可能是愚蠢的问题）因为这是一个现有的应用程序，为什么你不能看看它做了什么？

——马库斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-14T22:35:29.147

如果您在同一个表空间中有 2 个数据文件，则当第一个数据文件填充到其最大大小时，oracle 只会填充/扩展第二个数据文件。

如果您在第一个上没有限制，那么当 oracle 本身填充/使用/扩展第二个数据文件时，就没有理由（至少我现在能想到的）。

即使您在第一个数据文件的文件系统/ASM/其他文件上的空间已用完，我很确定，Oracle 仍会尝试扩展第一个数据文件（至少这是我认为我在几个小时前看到的内容：P） .

请任何人，如果我错了，请纠正我。

# virtual-earth - VirtualEarth：确定最小/最大可见纬度/经度

> ID：587047
> 
> 赞同：1
> 
> 时间：2009-02-25T17:41:05.893
> 
> 标签：virtual-earth

有没有一种简单的方法来确定 VirtualEarth 地图中的最大和最小可见纬度和经度？鉴于它不是一个平面（看起来像 VE 使用墨卡托投影），我可以看到数学变得相当复杂，我想有人可能知道一个片段来完成这个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T18:14:43.190

找到了！VEMap.GetMapView() 返回边界矩形，甚至适用于 3D 模式（边界甚至不是矩形）。

```
var view = map.GetMapView();

latMin = view.BottomRightLatLong.Latitude;
lonMin = view.TopLeftLatLong.Longitude;
latMax = view.TopLeftLatLong.Latitude;
lonMax = view.BottomRightLatLong.Longitude; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T17:48:29.980

使用 Virtual Earth Interactive SDK，您可以了解如何将像素点转换为 LatLong 对象：

```
function GetMap()
{
  map = new VEMap('myMap');
  map.LoadMap();
}

function DoPixelToLL(x, y)
{
  var ll = map.PixelToLatLong(new VEPixel(x, y)).toString()
  alert("The latitude,longitude of the pixel at (" + x + "," + y + ") is: " + ll)
} 
```

在此处进一步查看：http: [//dev.live.com/virtualearth/sdk/](http://dev.live.com/virtualearth/sdk/)在菜单中转到：获取地图信息 --> 将像素转换为 LatLong

要获得最大/最小可见 LatLong，您可以为地图的每个角调用 DoPixelToLL 方法。

# c - 哪些项目不能用 C 完成？

> ID：587049
> 
> 赞同：6
> 
> 时间：2009-02-25T17:41:10.823
> 
> 标签：c

我想知道哪些项目不能在 C 中完成。

我知道用其他语言编程可以更快、更直观。但我想知道 C 语言中缺少哪些功能会妨碍项目顺利完成。

例如，C 语言中几乎没有 web 框架。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-25T17:44:53.497

C 与许多其他语言一样，是[图灵完备](http://en.wikipedia.org/wiki/Turing_complete)的。

如此简单的答案是：没有。

但是，C++ 模板元编程符合相同的标准，因此“有可能”并不是选择工具的好标准。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-25T17:45:31.203

第一个 C 编译器？

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-25T19:03:49.580

[停止问题](http://en.wikipedia.org/wiki/Halting_problem)的有效解决方案

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-25T17:57:15.510

好的，这是一个：您不能用 C 语言编写 x86 引导扇区。这是**必须用**ASM 编写的内容之一。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T17:48:37.560

没有了。

不同的语言给你不同的表达方式。对于某些类别的问题，给定的语言可能更具表现力和/或简洁。除了 C 之外，还有哪些项目需要您选择？是的当然。但是说你不能在 C 中做得很好是一种误导。最好问一下哪种语言是解决手头问题的最佳选择，是否值得使用不熟悉的东西？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-25T18:03:34.310

几乎可以用任何语言完成任何事情。

也就是说，有一定程度的实用性。随着系统复杂性的增加，您需要更好的工具来管理它。

这些问题仍然可以解决，但是您开始需要更多的人，并且在设计上付出更多的努力。我并不是说其他​​语言不能从设计中受益，我是说可能不需要同样的水平和对细节的关注。

由于我们程序员是人类（至少我是），我们在某个领域或另一个领域遇到了麻烦。我最大的是记忆。如果我可以将我的代码可视化为对象，那么在我的脑海中操作大型模块会变得更容易，我的大脑也可以处理更大的项目。

当然，甚至可以用 C 编写好的 OO 代码，这些模式是在 C 中通过手动管理调度表（指针表，其中一些指针被更新以指向不同的方法）开发的，这对于来自更高层的所有编程结构都是如此语言——它们可以用任何语言完成，但是......

如果您要在 C 中实现对象，那么您编写的每个类都会有大量的样板开销。如果你做了某种形式的异常处理，你会暴露更多的样板。

更高级的语言将这个样板从你的代码中抽象出来并进入系统，简化你必须考虑和调试的事情（C 中的调度表可能需要大量调试，但在 C++ 中它不会失败，因为代码由工作编译器生成的将是无错误和隐藏的，你永远看不到它）。

我想我会说这是低级语言和高级语言之间最大的（唯一的？）区别，你隐藏了多少样板。在最新一批的动态语言中，他们真的在语言中隐藏了循环结构，所以更多的东西看起来像：

directory.forEachFile(打印文件名); // 不是任何真正的语言

在 C 语言中，即使您在函数内部隔离了部分循环，设置函数指针和其他内容仍然需要几行不明显的代码，这些代码无法解决您的主要问题的一部分。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T17:47:55.597

没有一个算法不能用 C 编写。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T17:50:20.987

取决于你想投入多少（时间/金钱/精力）来实现它。否则，我会说没有。有时使用其他东西更容易。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T18:53:51.630

操作系统内核是用 C 编写的，一切都在它上面运行，所以你可以用C编写*一切。*

需要 ASM 的引导扇区 :-)，我认为您不是这个意思。

# code-generation - 生成代码时，应该生成什么语言？

> ID：587059
> 
> 赞同：7
> 
> 时间：2009-02-25T17:43:14.327
> 
> 标签：code-generation

我从事过许多使用代码生成的产品。它似乎是同时实现高度用户可定制性和高执行速度的唯一方法。

缺点是我们要求用户安装编译器（主要在 MS Windows 上）。

这一直是一个令人头疼的问题，因为像 MS 这样的供应商一直在淘汰编译器，而且一些用户往往安装了多个编译器。

我们正在考虑使用 GNU C，可能还有 C++，但即便如此，仍然存在版本问题。

我考虑过可能生成汇编语言，以摆脱编译器版本的跑步机，但汇编语言都是特定于机器的。

理想情况下，应该有某种方法可以生成灵活、运行速度快且不会让我们受到第三方提供商的异想天开的生成代码。

也许我忽略了一些简单的东西，比如 Java。任何想法，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T17:58:58.923

如果您正在考虑 C 甚至汇编程序，请先查看 LLVM：http: [//llvm.org](http://llvm.org)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T17:48:20.103

我可能在这里遗漏了一些上下文，但是您可以将自己固定到特定版本吗？例如，.NET 2.0 可以与 .NET 1.1 和 .NET 3.5 以及将来出现的其他版本一起安装。因此，只要您的代码使用特定版本的编译器，有什么问题？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T17:49:54.983

> 我考虑过可能生成汇编语言，以摆脱编译器版本的跑步机，但汇编语言都是特定于机器的。

那将被称为编译器:)

为什么不坚持`C90`？

`gcc`如果您不使用扩展，我还没有听到太多严重违反标准的事情。

`gcc`并且您始终可以随您的产品分发某个版本，例如，`4.3.2`为用户提供使用自己的编译器的选项，风险自负。

只要所有代码都是由你生成的（即你没有将你的指令嵌入到其他人的代码中），在针对这个版本进行测试并使用它来编译你的库时应该没有任何问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T05:51:53.037

如果你想生成汇编语言代码，你可以看看[asmjit](http://code.google.com/p/asmjit/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T17:47:19.950

从这里开始：[代码生成会议](http://codegeneration.net/cg2014/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-25T17:49:29.680

一种选择是使用一种语言/环境来提供对代码中编译器的访问；例如，[这是一个 C# 示例](http://support.microsoft.com/kb/304655)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-25T18:02:35.623

为什么不随代码生成器一起提供 GNU C 编译器？这样您就没有版本问题，并且客户端可以不断生成可用的代码。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-25T18:09:08.243

听起来您正在寻找 LLVM。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-25T18:04:15.790

我会坚持使用您用于生成该语言的语言。您可以在 Java 中生成和编译 Java 代码，在 Python 中生成和编译 Python 代码，在 C# 中生成和编译 C#，甚至在 Lisp 中生成和编译 Lisp 等。

但尚不清楚这些语言对您来说是否足够快。为了获得最高速度，我会选择生成 C++ 并使用 GCC 进行编译。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-25T18:45:43.570

为什么不使用 SpiderMonkey 或 Rhino 之类的东西（Java 或 C++ 中的 JavaScript 支持）。您可以将对象导出到 JavaScript 命名空间，而您的用户无需编译任何内容。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-10-08T17:35:18.393

[将Lua](http://en.wikipedia.org/wiki/Lua_%28programming_language%29) / [Scheme](http://en.wikipedia.org/wiki/Scheme_%28programming_language%29)等语言的解释器嵌入到您的程序中，并以该语言生成代码。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-11-21T07:06:18.357

就像@Alvin 的回答一样，本着“加我的 2 美分”的精神，这是我要考虑的事情：如果您的应用程序打算持续几年，*它将面临一些变化在应用程序和系统如何工作*。

例如，假设您在 10 年前就在考虑这个问题。那时我在看德克斯特，但我想你实际上对当时的情况有记忆。据我所知，多线程对于 2000 年的开发人员来说并不是什么大问题，而现在是。所以摩尔定律打破了他们。在此之前，人们甚至不关心《千年虫》会发生什么。

说到摩尔定律，处理器确实变得相当快，所以也许某些优化甚至没有那么必要。并且可能优化的数组会更大，*[一些处理器](http://en.wikipedia.org/wiki/PowerPC_A2)*正在对几个以服务器为中心的东西（XML、密码学、压缩和正则表达式）进行优化！我很惊讶这些事情可以在芯片上完成）并且消耗更少的能量（这对于战争硬件来说可能非常重要......）。

我的观点是，专注于今天存在的东西作为明天的平台并不是一个好主意。让它今天工作，明天它肯定会工作（微软特别重视向后兼容性，Apple 看起来不错，Linux 非常自由地让它随心所欲地工作）。

是的，你可以做一件事。将您的技术附加到不会（可能）死掉的东西上，例如 Javascript。我是认真的，Javascript VM 现在变得非常高效，并且会变得更好，而且每个人都喜欢它，所以它不会突然消失。如果需要更多的效率/功能，可能针对 CRL 或 JVM？

我也相信多线程将成为越来越多的问题。我有一种直觉，处理器内核的数量将有自己的摩尔定律。从云嗡嗡声的外观来看，架构很可能会发生变化。

PS：无论如何，我相信过去的 C 优化在现代编译器下仍然非常有效！

# excel - 报告的 Excel 版本中的额外行，SSRS

> ID：587066
> 
> 赞同：0
> 
> 时间：2009-02-25T17:45:13.030
> 
> 标签：excel, reporting-services

您好，我有一份报告服务报告。我在报告中使用分组。我的报告在 HTML 渲染中看起来很棒，但在 excel 版本中，第一列和最后一列有额外的行，而这些行不在 html 版本中。

谁能给我一个提示，为什么会这样。

谢谢，孙尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T22:32:52.747

如果任何控件在设计器中重叠，甚至比设计器高或低一个像素，Excel 渲染引擎会将它们解释为新行。使用属性表验证没有控件重叠，并且控件的顶部和高度属性相同。

希望这可以帮助，

账单

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T22:39:14.917

我在使用报表标题时经常遇到这个问题，其中公司徽标或报表标题比报表的任何字段都长得多，从而导致合并单元格。您可以在报表服务器的配置中设置一个选项以使用简单的标题，并限制 Bill Mueller 提到的未对齐单元格问题的一些影响。这是如何实现此目的的一个很好的示例：http: [//mysqlserverblog.com/2008/01/03/changeing-export-options-for-reporting-services.aspx](http://mysqlserverblog.com/2008/01/03/changing-export-options-for-reporting-services.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T22:39:49.953

我已经看到了很多，如果人们倾向于大量导出报告，我会从中删除所有格式，限制您可以深入研究的组数量并按照比尔所说的去做，并确保您没有重叠的控件。

# javascript - 为什么我的广告没有出现在 Internet Explorer 中？

> ID：587067
> 
> 赞同：2
> 
> 时间：2009-02-25T17:45:17.943
> 
> 标签：javascript, html, internet-explorer, dom

我制作了一个带有`thead`（标题）的表格；在 Mac 上，在 Firefox 中一切都很好，但在 Internet Explorer 6 上，头部就消失了……

知道为什么吗？

这是测试它的链接：[http](http://www.acecrodeo.com/new/05-rodeos.php) ://www.acecrodeo.com/new/05-rodeos.php ...该表的构造`tablerize.js`：

```
jQuery.fn.tablerize = function() {
    return this.each(function() {
        var table;
        $(this).find('li').each(function(i) {
            var values = $(this).html().split('*');
            if(i == 0) {
                table = $('<table>');
                var thead = $('<thead>');
                $.each(values, function(y) {
                    thead.append($('<th>').html(values[y]));
                });
                table.append(thead);
            } else {
               var tr = $('<tr>');
               $.each(values, function(y) {
                   tr.append($('<td>').html(values[y]));
               });
               table.append(tr);
            }
        });
        $(this).after(table).remove();
    });
}; 
```

...来自页面上的列表：

```
<ul>

<li>&nbsp; Date*Endroit*Sanction</li>
<li>&nbsp; 29 Mars &amp; 5 Avril*St-&Eacute;variste, Beauce&nbsp; # 1*&Eacute;quipe Rod&eacute;o du Qc.</li>
<li>&nbsp; 12 &amp; 19 Avril*St-&Eacute;variste, Beauce&nbsp; # 2*&Eacute;quipe Rod&eacute;o du Qc.</li>
<!-- ... -->
</ul> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T17:50:43.280

您将`<th>`元素直接包含在`<thead>`组中；这实际上是不合法的。您必须将它们包含在一个`<tr>`元素中，并将*其*放在`<thead>`...

请参阅：[11.2.3 行组：THEAD、TFOOT 和 TBODY 元素](http://www.w3.org/TR/html401/struct/tables.html#h-11.2.3)

所以修改以在添加元素之前`jQuery.fn.tablerize()`插入 a ：`<tr>``<thead>``<th>`

```
table = $('<table>');
var thead = $('<thead>');
var headRow = $('<tr>');
$.each(values, function(y) {
      headRow.append($('<th>').html(values[y]));
   });
thead.append(headRow);
table.append(thead); 
```

请注意，您也省略了该`<tbody>`元素；您可能也应该将其余行放在其中之一中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T20:03:53.647

好吧，既然我是 tablerize 的作者，我不妨修复它。

```
jQuery.fn.tablerize = function() {
    return this.each(function() {
        var table = $('<table>');
        var tbody = $('<tbody>');
        $(this).find('li').each(function(i) {
            var values = $(this).html().split('*');
            if(i == 0) {
                var thead = $('<thead>');
                var tr = $('<tr>');
                $.each(values, function(y) {
                    tr.append($('<th>').html(values[y]));
                });
                table.append(thead.append(tr));
            } else {
               var tr = $('<tr>');
               $.each(values, function(y) {
                   tr.append($('<td>').html(values[y]));
               });
               tbody.append(tr);
            }
        });
        $(this).after(table.append(tbody)).remove();
    });
}; 
```

那应该这样做。

# c++ - C++ 构造函数语法

> ID：587070
> 
> 赞同：13
> 
> 时间：2009-02-25T17:45:41.640
> 
> 标签：c++, constructor

简单的问题：以下陈述是否等效？还是第二个在幕后做更多隐含的事情（如果是，那是什么？）

```
myClass x(3);
myClass x = myClass(3); 
```

谢谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-25T17:56:22.457

它们并不完全相同。第一个称为“直接初始化”，而第二个称为“复制初始化”。

现在，该标准构成了两条规则。第一个用于直接初始化和复制初始化，其中初始化器是已初始化对象的类型。第二条规则适用于其他情况下的复制初始化。

因此，从这个角度来看，两者都被称为第一条规则。在您使用相同类型进行副本初始化的情况下，编译器可以省略副本，因此它可以将您创建的临时对象直接构造到初始化对象中。所以你可以很好地生成相同的代码。但是，即使副本被省略（优化），复制构造函数也必须仍然可用。即，如果您有一个私有复制构造函数，那么如果它出现的代码无法访问它，那么该代码是无效的。

第二种称为复制初始化，因为如果初始化器的类型是不同的类型，则会创建一个临时对象以尝试将右侧隐式转换为左侧：

```
myclass c = 3; 
```

编译器创建一个 myclass 类型的临时对象，然后当有一个采用 int 的构造函数时。然后它用该临时对象初始化对象。同样在这种情况下，可以直接在初始化对象中创建临时创建的。您可以通过在类的构造函数/析构函数中打印消息并使用`-fno-elide-constructors`GCC 选项来遵循这些步骤。它不会尝试删除副本。

附带说明一下，上面的代码与赋值运算符无关。在这两种情况下，都会发生初始化。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-25T17:52:12.717

`myclass`如果您的编译器未实现复制省略，则第二个可能会或可能不会要求额外的对象构造。但是，即使没有任何优化开关，大多数构造函数也会默认打开复制省略。

**注意**初始化，而构造永远不会调用赋值运算符。

永远记住：

> **赋值：** 已经存在的对象获得一个新值
> 
> **初始化：** 一个新对象在它诞生的那一刻得到一个值。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-25T17:53:12.557

在第二个中，首先创建一个临时对象，然后使用 myClass 的复制构造函数将其复制到对象 x 中。因此两者并不相同。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-25T18:40:44.860

我写了以下内容来尝试~~说明~~了解发生了什么：

```
#include <iostream>

using namespace std;

class myClass
{
public:
    myClass(int x)
    {
        this -> x = x;
        cout << "int constructor called with value x = " << x << endl;
    }

    myClass(const myClass& mc)
    {
        cout << "copy constructor called with value = " << mc.x << endl;
        x = mc.x;
    }

    myClass & operator = (const myClass & that)
    {
        cout << "assignment called" << endl;
        if(this != &that)
        {
            x = that.x;
        }
        return *this;
    }

private:
    int x;
};

int main()
{
    myClass x(3);
    myClass y = myClass(3);
} 
```

当我编译并运行此代码时，我得到以下输出：

```
$ ./a.out
int constructor called with value x = 3
int constructor called with value x = 3 
```

这**似乎**表明在 main 函数中进行的两次调用之间没有区别，但这是错误的。正如[litb](https://stackoverflow.com/questions/587070/c-constructor-syntax/587116#587116)指出的那样，复制构造函数*必须*可用于此代码才能工作，即使在这种情况下它被省略了。为了证明这一点，只需将上面代码中的复制构造函数移动到类定义的私有部分即可。您应该看到以下错误：

```
$ g++ myClass.cpp 
myClass.cpp: In function ‘int main()’:
myClass.cpp:27: error: ‘myClass::myClass(const myClass&)’ is private
myClass.cpp:37: error: within this context 
```

另请注意，*从不*调用赋值运算符。

# c# - 如何从线程中停止 Windows 服务应用程序？

> ID：587077
> 
> 赞同：8
> 
> 时间：2009-02-25T17:47:30.277
> 
> 标签：c#, .net, multithreading, windows-services

我有一个 Windows 服务，它在 OnStart 方法中启动一个线程。

基本上，如果出现问题（例如未处理的异常），我希望能够停止服务。

目前我正在使用`ServiceBase.Stop()`，但这涉及`ServiceBase`在线程可见的某个地方有一个实例，这反过来又涉及将我的实例声明为`public static`在主程序中。

有没有“更好的方法”来停止服务？如果不是……这样做安全吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T18:07:59.307

在我看来，最简单且最干净的方法是使用服务类的公共静态属性。唯一不起作用的情况是，如果您使用同一个服务类在同一个进程中运行多个服务，这种情况非常罕见。

```
private static MyService m_ServiceInstance;

public static MyService ServiceInstance
{
    get { return m_ServiceInstance; }
}

public MyService()
{
    InitializeComponents();
    //Other initialization
    m_ServiceInstance = this;
} 
```

将服务实例注入每个可能需要它的方法是一种替代方法，但它很快就会变得混乱，并且与仅使用静态属性相比没有真正的优势。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T18:04:40.190

[在此处查看](http://msdn.microsoft.com/en-us/library/aa331790(VS.71).aspx)有关如何使用 ServiceController 类启动和停止服务的示例。

或者，您可以在创建服务实例时将其传递给线程（或将其设置为线程类中的实例变量等），而不必使您的服务类成为静态的。

完整性的简短示例：

```
ServiceController sc = new ServiceController("MyService");
sc.Stop(); 
```

# c# - 应用程序可以在 Mesh 中存储哪些类型的数据（以及如何存储）

> ID：587080
> 
> 赞同：3
> 
> 时间：2009-02-25T17:47:54.597
> 
> 标签：c#, .net, live-mesh

目前，我们的一个应用程序正在使用 ClickOnce 进行部署，它在用户配置文件应用程序目录（漫游）中创建了一个 SQL Server Compact 3.5 数据库。

我想知道 Live Mesh 是否能让我们将这些数据存储在 Mesh 中？通过直接在网格中/从网格中存储和访问数据库文件，或者将原始数据存储在网格中。

这是可以做的事情以及如何做，还是不应该做的事情？我正试图了解整个 Live Mesh 的事情（除了同步文件）。

任何建议、反馈等......将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T08:52:52.317

如果您愿意，您当前可以使用 Live Mesh (www.mesh.com) 同步文件，包括数据库文件。但是，请注意，如果同时在两个不同位置更改数据库，则同步可能会导致冲突。我不认为你希望你的冲突解决发生在整个数据库级别......

您还可以尝试 Live Framework CTP（developer.mesh-ctp.com - 需要注册）并更改应用程序的数据访问逻辑以将您的数据存储为提要中的条目。基于提要的数据模型与关系数据库有很大不同，因此这将是一项不平凡的工作。没有参照完整性，并且您拥有指向资源的超链接而不是外键。自定义用户数据存储为 DataContract 序列化 XML。有查询支持，但仅适用于某些通用字段，不适用于任意用户数据。同步冲突仍可能发生在单个条目级别，但会保留所有冲突的详细历史记录，您可以将其显示给用户，让他们选择使用哪个条目来解决冲突。

您的应用程序可以选择直接针对云 API 进行编程，或者您可以安装 Live Framework 客户端并针对相同的本地 API 进行编程。

以下博客文章详细介绍了在 Live Framework 中存储数据的各种选项[http://nmackenzie.spaces.live.com/blog/cns!B863FF075995D18A!163.entry](http://nmackenzie.spaces.live.com/blog/cns!B863FF075995D18A!163.entry)

您可以查看 Live Framework 的文档[http://msdn.microsoft.com/en-us/library/dd156996.aspx](http://msdn.microsoft.com/en-us/library/dd156996.aspx)

[Live Framework 论坛http://social.msdn.microsoft.com/Forums](http://social.msdn.microsoft.com/Forums/en-US/liveframework/threads/)上的粘性线程中还有许多其他好的资源（培训视频、截屏视频、演练、动手实验室、博客文章等）[/zh-CN/liveframework/threads/](http://social.msdn.microsoft.com/Forums/en-US/liveframework/threads/)

# .net - .NET 第三方 Active Directory API？

> ID：587086
> 
> 赞同：0
> 
> 时间：2009-02-25T17:49:10.023
> 
> 标签：.net, active-directory

想知道是否有人对 .NET 库周围的 .NET（最好是 3.5）Active Directory API 包装器有任何建议？

从本质上讲，我正在寻找一个可以放入项目中的类库，甚至可以在公司范围内的大部分框架中公开，这需要您自己编写很多麻烦。

此外，理想情况下，使用第三方组件将需要大量的维护工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T18:13:14.520

有一个名为 .NET 的库

```
System.DirectoryServices 
```

它与 .net 框架一起安装。默认情况下，它不包含在项目中。只需“添加参考”即可。然后是 .NET 选项卡，然后是 System.DirectoryServices。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T18:27:09.747

请注意，Active Directory 是一种 LDAP 实现。除了 System.DirectoryServices，已经提到过。Novel 开发了一个 LDAP 提供程序，它应该可以与 AD 一起正常工作。[这是有关Novell.Directory.Ldap](http://developer.novell.com/wiki/index.php/Ldapcsharp)的更多信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-19T00:33:03.703

我还没有使用它，但我正在寻找同样的东西并跑过这个网站。似乎它具有轻松完成企业应用程序所需的常见任务所需的所有功能。

[http://dotnetactivedirectory.com/](http://dotnetactivedirectory.com/)

# java - 如果抛出未经检查的 Java 异常，则停止 bash 脚本

> ID：587099
> 
> 赞同：6
> 
> 时间：2009-02-25T17:51:35.447
> 
> 标签：java, bash, exception

我正在从 Bash 脚本中运行一个 java 程序。如果 java 程序抛出未经检查的异常，我想停止 bash 脚本而不是脚本继续执行下一个命令。

这该怎么做？我的脚本如下所示：

```
#!/bin/bash

javac *.java

java -ea HelloWorld > HelloWorld.txt

mv HelloWorld.txt ./HelloWorldDir 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-25T19:54:41.547

与汤姆·霍廷达成一致，

要检查 Java 程序的退出代码，请在 Bash 脚本中：

```
#!/bin/bash 

javac *.java 

java -ea HelloWorld > HelloWorld.txt 

exitValue=$? 

if [ $exitValue != 0 ] 
then 
exit $exitValue 
fi 

mv HelloWorld.txt ./HelloWorldDir 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-25T17:53:38.750

捕获异常，然后调用 System.exit。检查 shell 脚本中的返回码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T17:59:26.317

```
#!/bin/bash

function failure()
{
    echo "$@" >&2
    exit 1
}

javac *.java || failure "Failed to compile"

java -ea HelloWorld > HelloWorld.txt || failure "Failed to run"

mv HelloWorld.txt ./HelloWorldDir || failure "Failed to move" 
```

此外，您必须确保`java`以非零退出代码退出，但这很可能是未捕获的异常。

如果命令失败，基本上退出 shell 脚本。

# asp.net-mvc - ASP.NET RC1 中的 Html.DropDownList 问题

> ID：587107
> 
> 赞同：0
> 
> 时间：2009-02-25T17:53:32.960
> 
> 标签：asp.net-mvc

出于某种原因，我的下拉列表没有保留它的选定值 - 我知道我在这里遗漏了一些简单的东西。感谢您的任何评论！

控制器

```
 public ActionResult Test()
    {
        ViewData["MonitoringType"] = new SelectList(myModel.GetMonitoringType(), "Category", "Category");
        return View();
    }

    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Test(FormCollection formValues)
    {
        ViewData["MonitoringType"] = new SelectList(myModel.GetMonitoringType(), "Category", "Category", formValues["MonitoringType"]);
        return View();
    } 
```

并查看：

这不起作用

```
<%= Html.DropDownList("MonitoringType", (SelectList)ViewData["MonitoringType"],new {style = "width: 300px;"})%> 
```

这有效

```
<%= Html.DropDownList("MonitoringType")%> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T18:31:11.950

来自控制器的报价：

```
 var projects = from project in DB.Projects
                   orderby project.Name
                   select new { project.Id, project.FullName };
    ViewData["ProjectId"] = new SelectList(projects, "Id", "FullName", selectedProjectId); 
```

从页面引用：

```
<%= Html.DropDownList("ProjectId", "-- All Projects --")%> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T17:36:02.183

看看我对类似问题的回答。使用 DropDownList(name) 以外的方法时，DropDownList 扩展方法中似乎存在错误。

[ASP.NET MVC RC（刷新）中的 Html.DropDownList 未预选项目](https://stackoverflow.com/questions/589935/html-dropdownlist-in-asp-net-mvc-rc-refresh-not-pre-selecting-item)

# asp.net - SMTPClient 一半工作\一半不工作

> ID：587117
> 
> 赞同：2
> 
> 时间：2009-02-25T17:56:32.127
> 
> 标签：asp.net, smtp, trust

我在一个网站上使用微软的会员框架。我能够发送密码检索电子邮件，但无法使用 SMTPClient 自己发送电子邮件。

当您在网站管理工具中配置 SMTP 设置时，此应用程序为其 SMTP 客户端提供的设置是什么？

如果我知道这一点，我可以复制它并希望发送电子邮件。

我已经排除了一些项目。- 我正在使用端口 25，（这是中等信任下唯一允许的端口）。- 此代码适用于我的本地系统。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T18:49:16.753

我试图通过构造函数传递 SMTPClient 的值。我没有意识到 SMTPClient 显然会自动从 web.config 中提取值并使用它们。

通过尝试传递我自己的价值观（即使它们相同）；我无意中违反了导致安全异常的信任级别。

构造函数中不要传入smtp info，使用web.config来设置，中等信任应该没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T18:24:54.960

可能是很多事情，从凭证问题、DNS 问题，或者......谁知道呢。是否无法发送，因为您收到错误或它们似乎已发送但从未到达？

您确定 WSA 工具正在通过 SMTPClient，还是您只是假设它（我不认识自己）？

——马库斯

> 我的邮件出现安全异常

这听起来像是一个凭证问题，或者一个信任问题。您确定您以中等（或更高）的信任度运行吗？其余的错误是什么？

——马库斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T12:56:43.853

尝试检查您的 web.config 文件：WSA 工具是否更新了这些设置？

该元素在配置元素下

```
<system.net>
<mailSettings>
  <smtp deliveryMethod="Network" from="you@email.com">
    <network
         host="your.gateway.com"
         userName="your@email.com"
         password="your_password"
         port="25" />
  </smtp>
</mailSettings>
</system.net> 
```

# asp.net - 好的 ASP.NET 类似 excel 的网格控件？

> ID：587120
> 
> 赞同：43
> 
> 时间：2009-02-25T17:57:58.503
> 
> 标签：asp.net, javascript, grid

我们正在寻找一种与 ASP.NET 兼容的数据网格，它允许类似于 Excel 或 WinForms 数据网格的多行编辑。它还必须支持非常基本的键盘输入（tab、箭头键、return）。请注意，我们**不是**在寻找 Excel 功能（函数、格式、公式）……只是用于快速输入数据的网格。

我查看了 Telerik、Infragistics、ComponentOne、DevExpress 和许多其他公司……他们所有的支持团队都表示，这些控件要么不支持多线，要么以笨拙的方式支持，以至于无法使用。

有没有人使用过他们可以推荐的类似 Excel 的网格？客户端网格似乎更接近我们所需要的，而 Sigma Widgets ( [example](http://www.sigmawidgets.com/products/sigma_grid2/demos/example_column_editor.html) ) 是我迄今为止发现的最接近的。Extjs 的网格太不灵活，而 jQuery 的网格太有问题。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-25T18:06:40.713

它今天不存在。有一些产品，比如你提到的那些已经尝试过，但根据我的经验，它们都不会让有经验的 Excel 用户满意。

我的公司生产与 Excel 兼容的电子表格组件，用于 Windows 窗体和 ASP.NET。多年来，我们一直在收到这个问题，所以我们当然考虑过建立一个，因为它看起来像是一项不错的业务。但是 HTML / JavaScript 并不是一个合适的平台来构建那些希望它像 Excel - IMO 一样工作的用户“感觉正确”的东西。

我们已经确定了为 Silverlight 构建电子表格控件的想法。我相信这将为您提供两全其美的优势 - 浏览器中的跨平台丰富的交互式电子表格，任何 Excel 用户都可以使用。不幸的是，这不会在本月或下个月发生……

在我以前的公司，我们实际上将电子表格组件构建为 Netscape 插件、ActiveX 控件和 Java Applet。他们取得了一些成功，但由于各种原因，这些技术都没有在企业中普及。我相信微软终于在 Silverlight 上做对了，Silverlight 将成为企业中基于浏览器的业务线应用程序的黄金标准。

编辑：

我应该提到我上面提到的产品是 Formula One / NET（Netscape 插件于 1995 年发布）、Formula One / ActiveX 和 Formula One for Java - 现在由 Actuate 作为 e.Spreadsheet 出售。我于 2002 年离开，但 AFAIK 他们仍然维护 Java Applet，这可能是浏览器中类似 Excel 的 UI 的最佳示例（我不再对该产品感兴趣 - 事实上，我们在某种程度上与 e.Spreadsheet 和打算在未来通过 Silverlight 控件获得更好的答案）。我在最初的答案中没有提到它的名称，因为它是 Java 产品 - 不是 .NET 产品 - 但即使对于 ASP.NET 网站，它也是一个潜在的答案。

Lloyd Cotten 正确评论说 Google Docs 是使用 HTML / JavaScript 构建的电子表格示例。Lloyd 表示，Google Docs“在与 Excel 的相似性方面绝对‘感觉不错’”。虽然我尊重 Lloyd 的意见，但根据我的经验，Google Docs 并不“感觉正确”。也许这是因为我是一个电子表格的人。我确实知道我们几乎每天都在与试图解决 OP 问题的潜在客户交谈，他们都看过但找不到他们满意的人 - 但如果他们有的话当然不会打电话给我们我们正在处理有偏见的样本，我理解这一点。

所以我只想澄清一下，实际上有很多可用的 HTML/JavaScript 网格和电子表格示例。只是我不想使用它们，因为我希望某些键可以做某些事情和特定级别的响应能力，而今天我尝试过的任何 HTML / JavaScript 解决方案都不存在（我看看定期他们，因为如果可以制造出我们可以引以为豪的产品，我的公司肯定可以销售这样的产品）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T18:56:21.560

我们最终使用了[Sigma Grid](http://www.sigmawidgets.com/) ...感谢所有其他回复！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T22:49:33.030

[FarPoint Spread](http://www.fpoint.com/netproducts/spreadweb/spread.aspx)怎么样？我正在为 ASP.NET 评估 FarPoint Spread，到目前为止，我对结果很满意。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T00:07:44.857

嗯..不确定，但我正在寻找类似的东西，我发现：

[尼托比](http://www.nitobi.com/products/completeui/demos/explorer/index.html)

不确定它是否完全符合您的要求，尽管您绝对可以使用光标键四处移动，并进行内联编辑....

编辑 Essential Objects 也有一个很好的编辑器......看起来很像 excel...... [http://demo.essentialobjects.com/Default.aspx?path=Grid_i1_i20](http://demo.essentialobjects.com/Default.aspx?path=Grid_i1_i20)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T18:24:00.843

[RealWorld Grid](http://blogs.msdn.com/mattdotson/articles/490868.aspx)可能是您正在寻找的。我在我的项目中使用它，并且效果很好。

这是他们的[CooglePlex 页面](http://www.codeplex.com/ASPNetRealWorldContr)

我认为它不支持箭头键，但它使多行编辑变得轻而易举。

ps 似乎您正在寻找客户端网格......这个是服务器端的。我会在那里留下评论，有人可能会觉得它有用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-25T20:55:00.827

我已经成功使用了 Infragistics 网格。但是，学习曲线很大（几乎没有支持），我不知道是否有多行编辑。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-25T21:20:02.170

我使用过[Syncfusion 的](http://samples.syncfusion.com/ASPNET/7.1.0.21/Web/Grid.grouping.web/samples/3.5/CRUDOperations/ExcelLikeEdit/CS/ExcelLikeEdit.aspx)组件，它们非常好，它们拥有“类似 Excel”的编辑器，尽管我没有看到多行提到。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-28T19:54:51.630

对于 Intranet 和 IE 用户，可以选择 Office Web 组件。一个好的 Web 应用程序在面对所有事物的同时，它们让用户在 Web 上的办公室有宾至如归的感觉。

几年前，我将数据透视表控件与 MS OLAP 结合使用取得了巨大成功。用户喜欢它，不需要重新发明轮子。

[http://www.microsoft.com/downloads/details.aspx?FamilyID=982B0359-0A86-4FB2-A7EE-5F3A499515DD&displaylang=EN](http://www.microsoft.com/downloads/details.aspx?FamilyID=982B0359-0A86-4FB2-A7EE-5F3A499515DD&displaylang=EN)

[http://msdn.microsoft.com/en-us/magazine/cc164070.aspx](http://msdn.microsoft.com/en-us/magazine/cc164070.aspx)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-04-28T09:35:19.430

[Excel Like GridView](https://web.archive.org/web/20090428090017/http://www.aspboy.com/Categories/GridArticles/Excel_Like_GridView.aspx)允许使用箭头键进行多行编辑和导航，以及调整列和行的大小。

[http://darkroastjava.wordpress.com/2010/04/28/creating-an-excel-like-grid-for-asp-net/](http://darkroastjava.wordpress.com/2010/04/28/creating-an-excel-like-grid-for-asp-net/)是它的扩展，它还支持从剪贴板粘贴多单元格值。

不幸的是，到目前为止，两者都只在 IE 中工作，但这满足了我目前的个人需求。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-07-31T19:56:00.347

我认为[http://codethat.com/grid/](http://codethat.com/grid/)相当不错！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-01-24T15:29:32.380

[dhtmlxGrid](http://dhtmlx.com/docs/products/dhtmlxGrid/index.shtml) (client-side, JavaScript grid) supports multiline feature ([demo](http://dhtmlx.com/docs/products/dhtmlxGrid/samples/16_rows_columns_manipulations/03_grid_multiline_col.html)), keyboard navigation and comes with server-side connector for ASP.NET. In case, someone is still looking for such a grid. Disclosure: I'm a part of the DHTMLX team.

# c++ - va_end 到底是做什么用的？是否总是需要调用它？

> ID：587128
> 
> 赞同：65
> 
> 时间：2009-02-25T18:01:16.453
> 
> 标签：c++, c, variadic-functions

> `va_end`- 宏重置`arg_ptr`。

访问变量参数列表后，`arg_ptr`指针通常用 重置`va_end()`。我知道如果您想重新迭代列表，它是必需的，但如果您不打算这样做，真的需要它吗？这只是一种好的做法，比如“`default:`你的总是有一个”的规则`switch`吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-02-25T18:03:54.060

`va_end`用于进行清理。你不想破坏堆栈，是吗？

来自`man va_start`：

> va_end()
> 
> va_start() 的每次调用都必须与同一函数中相应的 va_end() 调用相匹配。在调用 va_end(ap) 之后，变量 ap 未定义。可以对列表进行多次遍历，每次都由 va_start() 和 va_end() 括起来。va_end() 可以是宏或函数。

注意单词**must**的存在。

堆栈可能会损坏，因为*您不知道`va_start()`在做什么*。`va_*`宏被视为黑盒子。每个平台上的每个编译器都可以在那里为所欲为。它可能什么都不做，也可能做很多事情。

一些 ABI 将前几个参数传递到寄存器中，其余的传递到堆栈中。A`va_arg()`那里可能更复杂。您可以查看给定实现如何执行可变参数，这可能很有趣，但在编写可移植代码时，您应该将它们视为不透明操作。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-03T21:00:46.780

在 Linux x86-64 上，只能对`va_list`变量进行一次遍历。要进行更多遍历，必须首先使用复制它`va_copy`。`man va_copy`解释细节：

> va_copy()
> 
> 一个明显的实现将有一个 va_list 是指向可变参数函数的堆栈帧的指针。在这样的设置中（迄今为止最常见的），似乎没有什么反对分配
> 
> ```
>  va_list aq = ap; 
> ```
> 
> 不幸的是，还有一些系统使它成为一个指针数组（长度为 1），并且需要
> 
> ```
>  va_list aq;
>    *aq = *ap; 
> ```
> 
> 最后，在参数在寄存器中传递的系统上，va_start() 可能需要分配内存，将参数存储在那里，并指示下一个参数，以便 va_arg() 可以遍历列表。现在 va_end() 可以再次释放分配的内存。为了适应这种情况，C99 增加了一个宏 va_copy()，这样上面的赋值就可以替换为
> 
> ```
>  va_list aq;
>    va_copy(aq, ap);
>    ...
>    va_end(aq); 
> ```
> 
> va_copy() 的每次调用都必须与同一函数中相应的 va_end() 调用相匹配。一些不提供 va_copy() 的系统改为使用 __va_copy，因为这是提案草案中使用的名称。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-25T18:08:52.223

在常见的“堆栈上传递的参数”实现中，我相信 va_end() 通常是空/空/空。但是，在传统方案较少的平台上，它变得很有必要。包含它以保持平台中立是一种“良好做法”。

# c# - Outlook 运行时 MAPISendMail 不起作用

> ID：587136
> 
> 赞同：1
> 
> 时间：2009-02-25T18:03:38.710
> 
> 标签：c#, mapi, mapisendmail

一段时间以来，我一直在使用 Winforms 应用程序中的 Mapi32 发送带有附件的新邮件消息，并且效果非常好。（是的，我知道不支持从 C# 调用 MAPI32。）

在过去的几天内，当 Outlook 运行时，它已停止工作。但是，如果 Outlook 未运行，它将按预期工作。这在 Vista 和 XP 中都会发生。

有没有 SOer 遇到过这个问题？你是怎么解决的？

这是我一直在使用的代码：

```
public class EmailController
{
    [DllImport("MAPI32.DLL", CharSet = CharSet.Ansi)]
    public static extern int MAPISendMail(IntPtr lhSession, IntPtr ulUIParam,
        MapiMessage lpMessage, int flFlags, int ulReserved);
    public const int MAPI_LOGON_UI = 0x00000001;
    private const int MAPI_DIALOG = 0x00000008;

    public static int SendMail(string strAttachmentFileName, string strSubject,string to)
    {

        IntPtr session = new IntPtr(0);
        IntPtr winhandle = new IntPtr(0);

        MapiMessage msg = new MapiMessage();
        msg.subject = strSubject;

        int sizeofMapiDesc = Marshal.SizeOf(typeof(MapiFileDesc));
        IntPtr pMapiDesc = Marshal.AllocHGlobal(sizeofMapiDesc);

        MapiFileDesc fileDesc = new MapiFileDesc();
        fileDesc.position = -1;
        int ptr = (int)pMapiDesc;

        string path = strAttachmentFileName;
        fileDesc.name = Path.GetFileName(path);
        fileDesc.path = path;
        Marshal.StructureToPtr(fileDesc, (IntPtr)ptr, false);

        msg.files = pMapiDesc;
        msg.fileCount = 1;

        List<MapiRecipDesc> recipsList = new List<MapiRecipDesc>();
        MapiRecipDesc recipient = new MapiRecipDesc();

        recipient.recipClass = 1;
        recipient.name = to;
        recipsList.Add(recipient);

        int size = Marshal.SizeOf(typeof(MapiRecipDesc));
        IntPtr intPtr = Marshal.AllocHGlobal(recipsList.Count * size);

        int recipPtr = (int)intPtr;
        foreach (MapiRecipDesc mapiDesc in recipsList)
        {
            Marshal.StructureToPtr(mapiDesc, (IntPtr)recipPtr, false);
            recipPtr += size;
        }

        msg.recips = intPtr;
        msg.recipCount = 1;
        int result = MAPISendMail(session, winhandle, msg, MAPI_LOGON_UI | MAPI_DIALOG, 0);

        return result;
    }
}

[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
public class MapiMessage
{
    public int reserved;
    public string subject;
    public string noteText;
    public string messageType;
    public string dateReceived;
    public string conversationID;
    public int flags;
    public IntPtr originator;
    public int recipCount;
    public IntPtr recips;
    public int fileCount;
    public IntPtr files;
}

[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
public class MapiFileDesc
{
    public int reserved;
    public int flags;
    public int position;
    public string path;
    public string name;
    public IntPtr type;
}

[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
public class MapiRecipDesc
{
    public int reserved;
    public int recipClass;
    public string name;
    public string address;
    public int eIDSize;
    public IntPtr entryID;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-19T04:10:09.670

如果您的应用程序以提升的权限（即作为管理员）运行而 Outlook 不是，则发送将失败。您必须告诉用户关闭所有正在运行的 Outlook 实例并重试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-12T14:07:15.010

> int 结果 = MAPISendMail（会话，winhandle，味精，MAPI_LOGON_UI | MAPI_DIALOG，0）；
> 
> ```
>  return result; 
> ```

它返回什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T19:10:36.070

好吧，除了明显的“使用支持的 C# 邮件发送方法”注释之外，我想知道 mapi32.dll 文件是否发生了问题 - 您是否尝试过 Outlook 中的“检测和修复”？

[我还在这里（ http://office.microsoft.com/en-us/outlook/HP011164781033.aspx](http://office.microsoft.com/en-us/outlook/HP011164781033.aspx) ）读到，您可以执行一些步骤（帖子和评论）来让 Outlook 修复或替换 dll。

# weblogic - Weblogic 10.3 是否支持 EJB2.0 规范？

> ID：587137
> 
> 赞同：0
> 
> 时间：2009-02-25T18:03:45.793
> 
> 标签：weblogic, ejb

Weblogic 10.3 是否支持 EJB2.0 规范？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T18:30:31.000

EJB3.0 规范应该向后兼容 1.x 和 2.x，而 Weblogic 10.3 声称完全兼容 EJB3.0。
因此，无需实际测试自己，它确实应该有效。

# javascript - 是否可以在列表中的背景图像上触发 jQuery 单击事件？

> ID：587147
> 
> 赞同：3
> 
> 时间：2009-02-25T18:05:38.627
> 
> 标签：javascript, jquery, list, html-lists

我有一个无序列表的项目，像这样，为了简洁而缩短：

```
<div id="elementsContainer">
  <ul>
    <li><a>One</a></li>
    <li><a>Two</a></li>
  </ul>
</div> 
```

我已经对列表进行了样式化，但是这 3 种样式处理列表项的背景图像：

```
#elementsContainer ul li {
    list-style:none;
}
#elementsContainer a {
    background: transparent url(/images/icons/bullet_delete.png) no-repeat 5px 50%;
}

#elementsContainer a:hover,
#elementsContainer a:focus,
#elementsContainer a:active {
    background:#fff url(/images/icons/delete.png) no-repeat 5px 50%;
} 
```

该列表看起来很棒 - 它在每个列表项的文本左侧放置了一个小删除图标。但是，我希望使用 jQuery (1.3) 来处理每个项目的单击事件，并且我希望列表项的背景图像和列表项的文本之间具有单独的功能。如果我单击图像，我想删除该项目。如果我单击文本，我想编辑该项目。

我开始使用这样的东西：

```
$("a").live("click", function(event){
  alert( $(this).text() );
}); 
```

但是我在 $(this) 或“事件”中看不到任何可以确定我是单击文本还是图像的内容。

是的，我知道我可以有一个单独的“img”标签并单独处理点击。如果这是唯一的选择，我会走那条路。我只想知道是否有某种方法可以使它在背景图像上工作。

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T18:14:13.363

使用 IMG 标签。你能做的最好的事情就是检测到对 LI 元素本身的点击，这最终会变得混乱。一个 IMG 标记（甚至是一个围绕它的 A 标记，用于语义上的好处和很好的降级页面）效果最好。

在 LI 中使用 IMG 将其设置为相同的样式应该不会有太多问题，我在需要删除/编辑图标的列表中一直在做类似的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T18:15:03.813

您无法区分对背景图像的单击，因为就 DOM 而言，它并不真正存在。您所拥有的只是`a`元素本身（恰好与您的背景图像一起呈现），只要您单击标签内的任何位置，无论是否是文本，它的 onclick 处理程序都会触发。

`img`正如您在文章中总结的那样，最好使用标签（或其他一些单独的标签）并单独处理点击。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T18:25:01.450

您可以为所需效果做的事情是在删除图像最终出现的区域中放置一个带有一些空格的跨度，然后将事件挂钩到该跨度的单击。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-25T03:32:15.170

在它上面放一个元素，然后用它窃取注册事件。

# nhibernate - 有人在 Mono 中使用过任何 .Net 代码生成框架吗？（亚音速、.netTiers 等）

> ID：587159
> 
> 赞同：0
> 
> 时间：2009-02-25T18:09:23.890
> 
> 标签：nhibernate, subsonic, mono, code-generation, .nettiers

自从我上次真正使用它以来，Mono 似乎真的是一种日志方式。我对使用 Mono 进行一些 ASP.Net 开发很感兴趣。我在工作中使用过 .netTiers/CodeSmith，并且非常享受代码生成为您提供干净的工作数据访问层的速度。问题是有人用 Mono 生成代码吗？我愿意学习 SubSonic 或 NHibernate 之类的东西，如果它们与 Mono 一起工作得更好。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T04:43:58.323

我用过单声道的亚音速。我在单声道 2.0 上使用过它，在该版本上 SubStage（subsonic 的 GUI 前端）不起作用，但您可以使用命令行选项生成代码。它适用于单声道。在单声道中使用 SubSonic 生成的代码时我没有发现任何问题。

我没有在单声道上使用 NHibernate。NHibernate 很复杂，我尝试学习它，但放弃了。虽然 SubSonic 很简单，但我用不到 1 小时的时间来学习 SubSonic。

如果您对 Linq 感兴趣，我建议您尝试一下[DBLinq](http://code.google.com/p/dblinq2007/)，DBLinq 团队正在与 Mono 团队合作，在 Mono 中实现 Linq to Sql。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T23:44:04.750

这个链接很好地描述了它。不完全确定我理解它，但最终结果是良好的性能。 [http://www.mono-project.com/Linear_IL](http://www.mono-project.com/Linear_IL)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-22T17:33:59.837

我们确实有人使用[CodeSmith](http://www.codesmithtools.com/)来生成在 Mono 下运行的代码。我与一位正在使用 CodeSmith 创建 Mono 框架的人交谈。

谢谢-布莱克·涅米斯基

# .net - 从 ADO.Net 数据服务中执行实体框架中的存储过程

> ID：587173
> 
> 赞同：0
> 
> 时间：2009-02-25T18:13:32.697
> 
> 标签：.net, entity-framework, .net-3.5, ado.net

我正在使用 ADO.Net DataServices 向 Silverlight 公开实体数据模型。该模型有一个返回 void 的存储过程。我想从 Silverlight 客户端调用此过程。

我的理解是我应该在DataService类中添加一个[WebInvoke]方法，并使用[DbCommand](http://msdn.microsoft.com/en-us/library/system.data.common.dbcommand.aspx)调用存储过程。

到目前为止，这是我的代码：

```
using System.Data.Common;
using System.Data.Services;
using System.ServiceModel.Web;

namespace Foo.Web
{
    public class PayrollDataService : DataService<Foo.Web.PayrollEntities>
    {
        public static void InitializeService(IDataServiceConfiguration config)
        {
            config.SetEntitySetAccessRule("*", EntitySetRights.AllRead);
            config.UseVerboseErrors = true;
        }
        [WebInvoke]
        public void RunMyProcedure()
        {
            DbConnection conn = this.CurrentDataSource.Connection;
            DbCommand cmd = conn.CreateCommand();

            // TODO: Call the stored procedure in the EF Data Model.
        }
    }
} 
```

有人可以确认这是正确的方法并展示在这种情况下使用 DbCommand 的示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T18:26:45.177

我的问题是为什么你在实体框架中运行它，因为你没有返回任何东西，这表明你实际上并没有填充对象。如果这只是一些清理并且不影响数据，我不会在 EF 中使用它。

如果这是您的问题，那么使用 DBCommand 触发查询没有任何问题。而且，如果您实际上正在影响 EF 对象，我不会担心将过程存储在那里。如果该过程不影响 EF 对象，我会将其与 EF 分开，而不是将所有内容视为钉子，将 EF 视为锤子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T10:59:45.910

您必须在您的 edmx 模型中导入您的存储过程，导入函数将返回 None，并从您的代码中调用它。像这样：

```
[WebInvoke][WebGet]
public void RunMyProcedure(int Param1, string Param2)
{
    this.CurrentDataSource.ImportedFunction(Param1,Param2);
} 
```

然后你可以从浏览器调用它：http://urltoservice/serviceName.svc/RunMyProcedure?Param1=666&Param2='stringvalue'

# asp.net-mvc - 如何使用 rhino 模拟在 MVC RC1 中存根 HttpSessionState？

> ID：587179
> 
> 赞同：4
> 
> 时间：2009-02-25T18:15:10.523
> 
> 标签：asp.net-mvc, unit-testing, rhino-mocks, controllercontext

我正在尝试利用 asp.net mvc rc1 中[最近的 ControllerContext 重构](http://weblogs.asp.net/scottgu/archive/2009/01/27/asp-net-mvc-1-0-release-candidate-now-available.aspx)。我应该能够相当简单地存根会话，但是在运行以下代码时，我不断在第 2 行收到 System.NullReferenceException：

```
var mockContext = MockRepository.GenerateStub<ControllerContext>();
mockContext.Stub(x => x.HttpContext.Session["MyKey"]).Return("MyValue"); 
```

我究竟做错了什么？

编辑：我刚刚验证我在这篇文章中拥有最新版本的 rhino。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-14T01:48:52.063

您也需要模拟 HttpContext 才能使其正常工作。我为此使用了 HttpContext 的模拟：

```
public class HttpContextMock
{
    private readonly HttpContextBase _contextBase;
    private readonly HttpRequestBase _requestBase;
    private readonly HttpResponseBase _responseBase;
    private readonly HttpSessionStateBase _sessionStateBase;
    private readonly HttpServerUtilityBase _serverUtilityBase;

    public HttpContextBase Context { get { return _contextBase; } }
    public HttpRequestBase Request { get { return _requestBase; } }
    public HttpResponseBase Response { get { return _responseBase; } }
    public HttpSessionStateBase Session { get { return _sessionStateBase; } }
    public HttpServerUtilityBase Server { get { return _serverUtilityBase; } }

    public HttpContextMock()
    {
        _contextBase = MockRepository.GenerateStub<HttpContextBase>();
        _requestBase = MockRepository.GenerateStub<HttpRequestBase>();
        _responseBase = MockRepository.GenerateStub<HttpResponseBase>();
        _sessionStateBase = MockRepository.GenerateStub<HttpSessionStateBase>();
        _serverUtilityBase = MockRepository.GenerateStub<HttpServerUtilityBase>();

        _contextBase.Stub(x => x.Request).Return(_requestBase);
        _contextBase.Stub(x => x.Response).Return(_responseBase);
        _contextBase.Stub(x => x.Session).Return(_sessionStateBase);
        _contextBase.Stub(x => x.Server).Return(_serverUtilityBase);

        _requestBase.Stub(x => x.IsAuthenticated).Return(true);

        _contextBase.User = new GenericPrincipal(new GenericIdentity("a@a.a"),
                                                 new string[] {"Admin"});

    }
} 
```

在测试设置中，我创建了一个控制器实例：

```
 [SetUp]
    public override void TestSetUp()
    {
        base.TestSetUp();

        repository = MockRepository.GenerateMock<IFooRepository>();
        controller = new FooController()
                         {
                             FooRepository = repository,
                             UserRepository = userMockRepository
                         };

        controller.ControllerContext = new ControllerContext(context.Context, new RouteData(), controller);
    } 
```

一切正常，我可以向会话和许多其他东西添加参数。希望这可以帮助。

# .net - VB.NET 和 OOP - 共享方法和基本属性

> ID：587183
> 
> 赞同：1
> 
> 时间：2009-02-25T18:15:51.643
> 
> 标签：.net, vb.net, oop

如果您不能`Me.`在非实例方法中使用，您将如何在方法中使用基类中的属性/函数`Shared`？

例如，`ClassB`继承自有`ClassA`
`ClassB`一个`Shared Method DoWork()`； `ClassA`有一个`ReadOnly Property SecurityKey`

我怎么……</p>

```
Public Sub DoWork()
  Dim test as String = Me.SecurityKey 
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T18:19:34.570

> 如果你不能使用“我”。在非实例方法中，您将如何在共享方法中使用基类中的属性/函数？

你不能。共享方法（以及`static`在 C# 中）不能很好地与 OOP 一起使用。这（即静态/共享方法不能是虚拟/可覆盖的事实）[可以说](http://www.jwz.org/doc/java.html)是 .NET 系统中的一个设计缺陷，它是从 Java“继承”的。共享方法实际上不是对象方法，而是具有名称范围的全局方法。

此外，也许与您的问题更相关的是，您总是需要一个实例来访问非共享方法（该方法被共享，不属于任何特定实例）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T18:18:08.783

您通过类​​名而不是实例标识符访问共享成员。 IE：`ClassA.DoWork()` 您不能从共享方法/成员访问实例成员，因为它们是不同的范围。但是，您可以在不使用实例标识符的情况下从实例范围访问共享成员。

尝试将类的实例传递给您的方法或在共享方法中实例化该类。

```
Public Shared Sub DoWork(instance As ClassB)
    Dim test As String = instance.WhateverProperty;
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T18:25:37.767

使用您的示例：

共享对象在尝试引用属性时应该获取哪个`ClassA`实例？`ClassB.DoWork()``Me.SecurityKey`

如果你让`ClassA.SecurityKey`属性也共享，那会更有意义，但继承关系不再重要。你也可以`ClassA.SecurityKey`在那个方法里面说，因为你必须已经知道 ClassA 才能知道它的继承属性。

如果您`ClassB.DoWork()`作为实例方法而不是共享方法，则可以使用`MyBase`VB.Net 中的关键字来引用继承的 ClassA 属性，即使 ClassB 重载或隐藏它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T18:18:06.287

如果您处于静态上下文中，则需要实例化此类以访问其实例成员。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T18:29:04.047

```
Dim s as SecKey = ClassA.SecurityKey 
```

这来自共享方法。请记住，共享方法由类的所有实例共享，因此您使用类名来提取它们。

# android - Android网络浏览器中的缩放按钮

> ID：587185
> 
> 赞同：7
> 
> 时间：2009-02-25T18:16:54.060
> 
> 标签：android, web

我正在开发的网站是专为 Android 设计的。用户不会从 Android 内置缩放按钮中受益。相反，他们把事情弄得一团糟。我怎样才能关闭它们？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T07:41:28.950

以下代码施展魔法

```
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0"/> 
```

# asp-classic - 如何从 ASP 页运行 sqlcmd.exe？

> ID：587189
> 
> 赞同：4
> 
> 时间：2009-02-25T18:18:15.850
> 
> 标签：asp-classic, windows-server-2003, sqlcmd

作为我们的数据库修订控制（和自动安装）过程的一部分，我们需要能够在 ASP 页面中对各种 .sql 文件运行 sqlcmd.exe。我用来执行此操作的代码是：

```
Dim cmd : cmd = "sqlcmd -S " & DATABASE_SERVER & " -U " & DATABASE_UID & " -P " & DATABASE_PWD & " -d " & DATABASE_NAME & " -i """ & scriptPath & """ -b"
Dim wshShell : Set wshShell = Server.CreateObject("WScript.Shell")
Dim return : return = wshShell.Run(cmd, 0, True) 
```

我的代码在我的开发机器（运行 XP）上工作，但现在我已经将它部署到我们的 Windows 2003 服务器，它遇到了问题。问题是 return 的值始终为 1。如果我尝试让它运行批处理文件或我能想到的任何其他东西，也会发生这种情况（如果我将 cmd 的值更改为不存在的文件，它就会爆炸正如我所料）

我尝试添加 I_USR 和 I_WAM 以对 sqlcmd.exe 和 cmd.exe 都具有执行权限，但它仍然返回 1。如果我在服务器上打开命令提示符并执行“runas /user:servername\i_usr sqlcmd.exe " 工作正常，但从 ASP 页面运行仍然无法正常工作。

此外，当手动运行 .sql 脚本时，一切都运行顺利，因此它们没有问题。

服务器上是否有任何我忘记在 IIS 或 Windows 中更改以使其正常工作的安全设置？

提前感谢互联网。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-26T14:46:58.920

通过将第一行更改为：

```
Dim cmd : cmd = "%COMSPEC% /C sqlcmd -S " & DATABASE_SERVER & " -U " & DATABASE_UID & " -P " & DATABASE_PWD & " -d " & DATABASE_NAME & " -i """ & scriptPath & """ -b" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T23:06:33.090

你应该改变

```
cmd = "sqlcmd -S ... 
```

到

```
cmd = "\windows\sqlcmd.exe -S .. 
```

（或者 sqlcmd.exe 的完整路径没有空格）

只是为了排除路径问题。

# compact-framework - 自更新 .net CF 应用程序

> ID：587191
> 
> 赞同：3
> 
> 时间：2009-02-25T18:21:38.400
> 
> 标签：compact-framework

我需要通过网络服务使我的 CF 应用程序自我更新。我在 2003 年的 MSDN 上找到了一篇文章很好地解释了它。但是，我想在这里谈谈练习。以前真的有人做过，还是每个人都依赖第三方解决方案？

我被特别要求这样做，所以如果您知道任何提示/警告，任何信息都将受到赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-08T15:28:28.500

不久前我问了同样的问题： [如何自动更新 Windows Mobile 应用程序](https://stackoverflow.com/questions/753851/how-to-auto-update-windows-mobile-application)

基本上你需要两个应用程序。

App1：启动实际应用程序，但也检查 CAB 文件（安装程序）。如果 cab 文件在那里，它会执行 CAB 文件。

App2：实际应用。它将调用 Web 服务，将版本号传递给服务并在存在新版本时检索 URL ()。下载后，您可以选择安装 cab 文件并关闭。

一个潜在的问题：如果您有一个安装放在文件系统上但不能覆盖的文件（数据库文件、日志等），您将需要两个单独的安装。

要安装出租车：查找 wceload.exe [http://msdn.microsoft.com/en-us/library/bb158700.aspx](http://msdn.microsoft.com/en-us/library/bb158700.aspx)

```
 private static bool LaunchInstaller(string cabFile)
    {
        // Info on WceLoad.exe
        //http://msdn.microsoft.com/en-us/library/bb158700.aspx
        const string installerExe = "\\windows\\wceload.exe";

        const string processOptions = ""; 
        try
        {
            ProcessStartInfo processInfo = new ProcessStartInfo();
            processInfo.FileName = installerExe;
            processInfo.Arguments = processOptions + " \"" + cabFile + "\"";

            var process = Process.Start(processInfo);
            if (process != null)
            {
                process.WaitForExit();
            }

            return InstallationSuccessCheck(cabFile);
        }
        catch (Exception e)
        {
            MessageBox.Show("Sorry, for some reason this installation failed.\n" + e.Message);
            Console.WriteLine(e);
            throw;
        }
    }

    private static bool InstallationSuccessCheck(string cabFile)
    {
        if (File.Exists(cabFile))
        {
            MessageBox.Show("Something in the install went wrong.  Please contact support.");

            return false;
        }
        return true;
    } 
```

获取版本号：Assembly.GetExecutingAssembly().GetName().Version.ToString()

要下载出租车：

```
 public void DownloadUpdatedVersion(string updateUrl)
    {
        var request = WebRequest.Create(updateUrl);
        request.Credentials = CredentialCache.DefaultCredentials;
        var response = request.GetResponse();

        try
        {
            var dataStream = response.GetResponseStream();
            string fileName = GetFileName();
            var fileStream = new FileStream(fileName, FileMode.CreateNew);

            ReadWriteStream(dataStream, fileStream);
        }
        finally
        {
            response.Close();
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-08T15:14:21.790

这相对容易做到。基本上，您的应用程序调用 Web 服务以将其版本与服务器上可用的版本进行比较。如果服务器版本较新，您的应用程序会将新的 EXE 作为 byte[] 数组下载。

接下来，因为您无法删除或覆盖正在运行的 EXE 文件，您的应用程序将其原始 EXE 文件重命名为“MyApplication.old”之类的名称（幸运的是，操作系统允许这样做）。然后，您的应用程序将下载的 byte[] 数组保存在与原始 EXE 文件相同的文件夹中，并使用相同的原始名称（例如“MyApplication.exe”）。然后您向用户显示一条消息（例如“检测到新版本，请重新启动”）并关闭。

当用户重新启动应用程序时，它将是他们正在启动的新版本。新版本删除旧文件（“MyApplication.old”），更新完成。

在不需要用户重新启动的情况下自行更新应用程序是一个巨大的痛苦（您必须启动一个单独的进程来进行更新，这意味着一个单独的更新程序应用程序本身不能自动更新）而且我已经永远无法使其 100% 可靠地工作。我从来没有客户抱怨过需要重启。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T18:28:02.957

“自我更新”到底是什么意思？如果您指的是配置或数据，那么 Web 服务应该可以很好地工作。如果您谈论的是自动下载和安装其自身的新版本，那就另当别论了。

从 Microsoft找到[了这个](http://www.microsoft.com/downloads/details.aspx?FamilyID=8FC47C2C-FC61-4D82-ABAE-F34DC1BFCD3F&displaylang=en)可下载的示例 - 看起来应该有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-08T15:32:23.407

如果您想使用第三方组件，请查看MoDaCo 开发的[AppToDate](http://www.modaco.com/category/332/apptodate/)。

# asp.net - 有哪些 ASP.NET GridView 性能改进机会？

> ID：587204
> 
> 赞同：4
> 
> 时间：2009-02-25T18:25:25.227
> 
> 标签：asp.net, jquery, css, gridview

我有一个相当基本的 ASP.NET 应用程序。它查询一些数据并在 GridView 中显示数据（可能有 0 - 2000 条左右的记录）。我一直在尝试找到一些方法来使其更流畅、最佳实践等，因为在渲染 GridView 时它似乎有点迟钝。我已经看到了一些关于使用 CSS 与直接在 GridView 上设置所有样式的线程，但我不确定这会是什么样子。

这就是 GridView 现在的样子......

```
<asp:GridView ID="gvResults" runat="server" DataKeyNames="ORDNO" AutoGenerateColumns="False"
    CellPadding="4" ForeColor="#333333" OnSelectedIndexChanged="gvResults_SelectedIndexChanged"
    Width="100%" OnRowDataBound="gvResults_RowDataBound" meta:resourcekey="gvResultsResource1">
    <AlternatingRowStyle BackColor="White" ForeColor="#284775" />
    <Columns>
        <asp:BoundField DataField="CSTNO" HeaderText="CUST" meta:resourcekey="BoundFieldResource1" />
        <asp:BoundField DataField="ORDNO" HeaderText="RMA NUMBER" meta:resourcekey="BoundFieldResource2" />
        <asp:BoundField DataField="CSTORD" HeaderText="CUST PO NUMBER" meta:resourcekey="BoundFieldResource3" />
        <asp:BoundField DataField="ORDDTE" HeaderText="ORDER DATE" meta:resourcekey="BoundFieldResource4" />
        <asp:BoundField DataField="INVDTE" HeaderText="INVOICE DATE" HtmlEncode="False" meta:resourcekey="BoundFieldResource5" />
        <asp:CommandField ShowSelectButton="true" ButtonType="Link" meta:resourcekey="CommandFieldResource1"  />
    </Columns>
    <EditRowStyle BackColor="#999999" />
    <EmptyDataTemplate>
        <span style="color: Red;">
            <asp:Literal ID="litErrorNoRMAFound" runat="server" EnableViewState="False" meta:resourcekey="litErrorNoRMATagsFoundResource1"
                OnInit="litErrorNoRMAFound_Init"></asp:Literal>
        </span>
    </EmptyDataTemplate>
    <FooterStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />
    <HeaderStyle BackColor="#3494CC" Font-Bold="True" ForeColor="White" HorizontalAlign="Left" />
    <PagerStyle BackColor="#284775" ForeColor="White" HorizontalAlign="Center" />
    <RowStyle BackColor="#F7F6F3" ForeColor="#333333" />
    <SelectedRowStyle BackColor="#E2DED6" Font-Bold="True" ForeColor="#333333" />
</asp:GridView> 
```

提前感谢您的任何想法/评论。

**编辑**
要求不允许对数据进行分页。我也在寻找有关 CSS 利用率和 GridView 的特定信息...

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-25T18:32:19.763

一些想法：

*   如果可能，消除视图状态。
*   如果您使用的是 IIS6 或更高版本，请考虑启用[压缩](http://weblogs.asp.net/owscott/archive/2004/01/12/57916.aspx)。
*   在 GridView 上启用分页以减少请求时间。
*   确保您部署的生产解决方案是发布编译的，没有恶意调试或跟踪指令

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-25T22:22:16.607

不要使用 GridView。如果要控制，请使用中继器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T18:38:20.047

如果您不使用分页（如评论中所述），请考虑使用 DataList 甚至是 Repeater 以减少对象本身的开销。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T18:26:51.587

启用分页将起作用；）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T18:28:19.400

是否启用了视图状态？那可能是很多隐藏的数据。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T18:36:59.910

您可以尝试使用[服务器端 viewstates](http://aspalliance.com/articleViewer.aspx?aId=72&vId=1&pId)。它在服务器上增加了一点负载，但页面加载/更新应该更快。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-25T18:49:18.273

您需要启用分页以避免将数百条记录呈现到页面的情况。实质上，您将使用页面控件来移动记录而不是滚动条。

*一个很有帮助*的相关选项是使用 ObjectDataSource，它只检索网格想要显示的那些记录。这使用 SQL Server 中的新 ROW_NUMBER() 构造。下面是检索特定记录范围的 ObjectDataSource 方法的示例。它使用了我的 DAL，但你应该能够得到一个非常清晰的想法：

```
 [DataObjectMethodAttribute(DataObjectMethodType.Select, true)]
    public List<SelectClassData> GetList(string sortType, int startRowIndex, int maximumRows)
    {
        if (!BusinessUtilities.SQLSafe(sortType))
            throw new Exception("Illegal value in request (unsafe).");
        startRowIndex++;
        int EndRow = startRowIndex + maximumRows;
        using (BSDIQuery qry = new BSDIQuery())
        {
            if (sortType.Length == 0)
                sortType = "Title";
            return
                qry.Command(
                    "With OrderedClassEvent as (Select ClassID, Title, StartDate, EndDate, ROW_NUMBER() OVER (ORDER BY " + sortType + ") as RowNum From ClassEvent)")
                    .Append(" Select ClassID, Title, StartDate, EndDate From OrderedClassEvent Where RowNum Between @StartRow AND ").ParamVal(startRowIndex)
                    .Append("@EndRow ").ParamVal(EndRow)
                    .Append("Order By RowNum")
                    .ReturnList<SelectClassData>();
        }
   } 
```

关于使用 CSS 等不会使网格更简洁，但它允许您在“皮肤”文件中定义网格属性（例如 FooterStyle、HeaderStyle 等），您将隐藏在主题目录中. 它是可选的，但您也可以使用 CSS 为每个属性定义样式。皮肤文件将显示一个“模板”GridView，其中每个属性都有 CssClass。当您参考创建网格时，您将参考皮肤文件，然后*忽略*该文件中找到的所有属性定义（gridview 不需要它们，因为它知道根据皮肤做什么）。如果您想让所有网格看起来都一样，这尤其有用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-25T18:57:49.657

使用 CSS 应该可以减小标记的大小。

[http://www.jigar.net/howdoi/viewhtmlcontent197.aspx](http://www.jigar.net/howdoi/viewhtmlcontent197.aspx)展示了如何使用 CSS 设置 gridview 的样式。

[您可以使用CSS Control Adapters](http://www.asp.net/cssadapters/gridview.aspx)替换整个网格呈现方式，这将有助于进一步减小标记大小。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T18:28:42.533

您自己回答了 - 将其拉上拉链以使其更拉链。使用压缩 http 处理程序。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-25T18:49:16.977

您可以输出前 X 个项目，然后在页面加载后获取下一个 X 项目，依此类推。这可能会使最终用户的页面看起来更快捷。

您还应该调查究竟是什么让页面变慢，还要检查数据库查询是否可以使用索引或其他东西进行优化。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-25T20:10:04.723

由于不允许分页，我肯定会探索减少此网格的总有效负载：

1.  使用转发器控件并构建本机 TABLE 来呈现此网格而不是数据网格控件 - 这样我将完全控制有效负载。就像是：
2.  使用 100% CSS 样式而不是控件属性。
3.  禁用视图状态 (?)

请注意，性能问题在这里与 asp.net 的关系较小，而与从服务器到客户端计算机的数据传输量更多。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-25T22:08:55.780

*   如果可能，禁用视图状态。
*   使用Repeater而不是网格并使用您自己的html，这会减少渲染标记
*   尝试使用**存储过程**
*   如果您有任何方法可以从数据库中的其他表中获取一些数据。尝试使用视图

# svn - 管理 VSS 到 SVN 的迁移

> ID：587215
> 
> 赞同：1
> 
> 时间：2009-02-25T18:27:59.930
> 
> 标签：svn, visual-sourcesafe

我们的组织正在从 VSS 迁移到 SVN。

现在，由于 VSS 上没有分支，有一个文件夹，其中包含上一个生产环境代码的源代码，它被用作一个队列，其中新代码被推送到队列的顶部，然后它基本上取决于一个非常手动的事情并且这是全有或全无的情况。

要迁移，使用 C# 迁移工具将 VSS 的当前代码上传到 SVN，它工作正常，并保留了文件更改历史记录。

如何处理这种情况？当前VSS代码上传到主干的地方，这是因为它需要保留文件历史记录，而生产环境的代码将是一个分支，但具有以前版本的文件和比主干更少的功能，然后是能够合并这两个根。

感谢您的意见。

PD。生产代码现在有需求更改，我无法使用当前主干制作新的生产代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T18:40:04.580

你在VSS中标注了吗？如果是这样，最好从 svn 主干中的相应修订版创建生产分支，以便存储库知道有共享历史记录。

无论哪种方式，您都应该能够将主干更改合并到生产分支中。

我建议也阅读SVN Book 中的[Branching and Merging](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.html)。它写得很好，可以提供很多帮助。

**编辑：**如果您需要与主干分开更改生产，您应该仍然能够稍后合并更改，但您可能还需要考虑将生产更改放入主干的需要。这可能有助于防止以后出现一些合并问题，此外，主干也将更新错误修复等。

# vb6 - 用户取消时如何从嵌套子程序的中间优雅退出？

> ID：587218
> 
> 赞同：0
> 
> 时间：2009-02-25T18:28:23.097
> 
> 标签：vb6

（我使用的是 VB6，但我想这会出现在大多数其他语言中。）

我有一个 GUI 按钮，它调用一个需要一两分钟才能完成的例程。我希望不耐烦的用户能够再次单击该按钮，让它在任何时候优雅地退出例程。

我使用了一个静态变量来使它工作得很好（见下面的代码），但我正在清理项目，我想把 For/Next 循环放到它自己的函数中，因为它在项目的几个不同地方都需要.

但是这样做会破坏我嵌入在 for/next 中的静态标志，所以我需要进行一些更改。在我用公共（全局）变量做一些笨拙的事情之前，我想我会问其他人（更聪明，也许实际上受过 CS 教育）的人在面对这个问题时做了什么。

所以基本上我的问题是我如何复制这个：

```
Private Sub DoSomething_Click()

  Static ExitThisSub As Boolean ' Needed for graceful exit

  If DoSomething.Caption = "Click To Stop Doing Something" Then
    ExitThisSub = False ' this is the first time we've entered this sub
  Else ' We've re-entered this routine (user clicked on button to stop it)
    ExitThisSub = True ' Set this so we'll see it when we exit this re-entry
    Exit Sub '
  End If

  DoSomething.Caption = "Click To Stop Doing Something"

  For i = 0 To ReallyBigNumber
    Call DoingSomethingSomewhatTimeConsuming
    If ExitThisSub = True Then GoTo ExitThisSubNow
    DoEvents
  Next

  ' The next line was missing from my original example,
  ' prompting appropriate comments
  DoSomething.Caption = "Click To Do Something"

  Exit Sub

ExitThisSubNow:

  ExitThisSub = False ' clear this so we can reenter later
  DoSomething.Caption = "Click To Do Something"

End Sub 
```

当我将 for/next 循环移动到它自己的函数时？

我想我会将 ExitThisSub 更改为一个公共变量 QuitDoingSoManyLongCalculations ，它将以相同的方式退出新的 for/next sub 然后 DoSomething_Click 。

但是当我使用全局变量时，我总是觉得自己像个业余爱好者（我就是这样）——有没有更优雅的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T18:54:27.120

好吧，您可以在表单中将模块级别的变量声明为私有。这不是一个全局变量，而是一个模块级变量。然后你可以将它传递给你创建的函数并在函数中检查它。

但要小心 DoEvents。它基本上意味着允许 Windows 消息循环处理消息。这意味着用户不仅可以再次单击您的按钮，还可以关闭表单并执行其他操作。因此，当您处于此循环中时，无论如何您都需要设置一个模块级变量，因为您需要在表单的 QueryUnload 和任何事件处理程序中检查它。

您还可以使用控件本身的 Tag 属性来存储各种标志。但我不认为这更优雅。

我也更喜欢使用两个不同的按钮。只需隐藏一个并显示另一个。这样，您的取消代码和运行代码在不同的事件处理程序中是分开的。

为了扩展我的答案，这里有一些处理卸载方面的示例代码。在这里，如果您通过 x 停止，它会提示您。如果您通过任务管理器杀死，它会优雅地死去。

```
Option Explicit

Private Enum StopFlag
   NotSet = 0
   StopNow = 1
   StopExit = 2
End Enum

Private m_lngStopFlag As StopFlag
Private m_blnProcessing As Boolean

Private Sub cmdGo_Click()

   Dim lngIndex As Long
   Dim strTemp As String

   m_lngStopFlag = StopFlag.NotSet
   m_blnProcessing = True

   cmdStop.Visible = True
   cmdGo.Visible = False

   For lngIndex = 1 To 99999999

      ' check stop flag
      Select Case m_lngStopFlag

         Case StopFlag.StopNow

            MsgBox "Stopping - Last Number Was " & strTemp
            Exit For

         Case StopFlag.StopExit

            m_blnProcessing = False
            End

      End Select

      ' do your processing
      strTemp = CStr(lngIndex)

      ' let message loop process messages
      DoEvents

   Next lngIndex

   m_lngStopFlag = StopFlag.NotSet
   m_blnProcessing = False
   cmdGo.Visible = True
   cmdStop.Visible = False

End Sub

Private Sub cmdStop_Click()

   m_lngStopFlag = StopFlag.StopNow

End Sub

Private Sub Form_Load()

   m_blnProcessing = False

End Sub

Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)

   Select Case UnloadMode

      Case vbFormControlMenu, vbFormCode

         If m_blnProcessing Then

            Cancel = True

            If MsgBox("Unload Attempted - Cancel Running Process?", vbOKCancel + vbDefaultButton1 + vbQuestion, "Test") = vbOK Then

               m_lngStopFlag = StopFlag.StopExit

            End If

         End If

      Case Else

         m_lngStopFlag = StopFlag.StopExit
         Cancel = True

   End Select

End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T18:39:44.363

您需要某种共享变量，以便您的 for 循环和按钮可以通信。我将 for 循环（及其相关代码）放在命令对象中。我的 VB 生锈了，但我认为您可以使用自己的“全局”变量和函数声明模块。您可以将所有代码移动到一个模块中，然后像现在一样检查全局变量。

我对您发布的代码示例的主要关注与用户取消无关，而是与其他所有内容有关：您通过阅读按钮文本而不是相反的方式检查您的运行状态（设置按钮文本，因为运行状态，应存储在变量中）；您使用 GOTO 退出您的 for 循环而不是中断（VB 是否有中断？）并且您将清理代码置于正常流程之外，而在我看来，无论用户是否取消，它都可以运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T18:41:49.383

一种可能的替代方法是将繁重的工作功能卸载到新线程。然后，如果用户想要取消，您可以直接终止该线程，或者您可以向该线程发送消息。

正如您在上面所做的那样，通过按钮名称进行切换是一种非常常见的技巧，如果您只有几个按钮状态，则非常安全。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T18:53:08.480

我一直在循环中使用像 bUserPressedCancel 这样的全局布尔变量以及 DoEvents。优雅，有气味，它起作用了。

我同意 Shiny 先生的观点，即针对字幕的价值进行测试并不是一个好主意。如果您在设计器中更改按钮上的文本，您将破坏代码。最好不要依赖文本的措辞来让您的代码正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-28T05:34:50.467

在您需要进行本地化或任何其他需要独立于逻辑更改 UI 的事情之前一直有效。我会使用 Tag 属性或私有模块级变量。然后，您可以独立于逻辑改变标题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-28T05:51:55.650

如果是我，我会使用 2 个按钮——一个是 GO，一个是 STOP。单击 GO 时，STOP 按钮可见。STOP 的 Click 事件只是隐藏自身 - 就是这样。

然后，您的循环可以简单地检查 STOP 按钮是否仍然可见。如果不是，这意味着它被点击了，你应该突破。

您的控件是具有表单范围的静态对象...

# java - 软件公司如何支持开发者社区？

> ID：587226
> 
> 赞同：1
> 
> 时间：2009-02-25T18:29:51.063
> 
> 标签：java

我只是准备在我的雇主提供的会议室举行一次本地 Java 用户组会议，所以这就是这个问题的产生方式......

我知道有些公司赞助会议，有些公司聘请开源开发人员等。但是，软件公司还有其他方式可以支持其（本地）开发人员社区吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T18:35:36.980

提供你雇主的会议室并花时间组织你的用户组对我来说是一个好的开始。我参加过的用户组让咨询公司和招聘人员赞助会议，并提供免费的披萨和抽奖奖品，以换取在每次会议开始时向与会者推销几分钟的时间。除此之外，发挥创意。建立一个带有论坛的网站，邀请演讲者谈论新技术等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T18:35:25.450

[在当地，一家公司为BJUG](http://www.boulderjug.org/)支付房租，另一家公司在会议期间支付披萨费用。

# actionscript-3 - 用 AS3 中的对应物替换口音

> ID：587242
> 
> 赞同：2
> 
> 时间：2009-02-25T18:32:47.923
> 
> 标签：actionscript-3, diacritics

我将如何继续将 éëíïñÑ （等）更改为他们的同行？即，eeinN。

我正在考虑对 é -> é 进行正则表达式匹配 并替换 & 和急性/严重; 使用空字符串，但我似乎找不到将重音编码为其非数字实体（ê 等）的 AS3 函数。我已经尝试过使用关联数组，即实体 ["À"] = "A";，但 AS3 似乎不喜欢 unicode 键。

任何建议将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T18:47:44.360

这被称为“unicode 分解”，因此您可能需要谷歌搜索。但是，如果您处理的不是您自己的语言，请不要这样做。

我知道这个想法对于不懂其他语言的以英语为母语的人来说似乎是合理的，但对于那些字符是字母的人来说，它与将“W”替换为“VV”、将“d”替换为“cl”和“Q”一样有意义" 与 "O" 对讲英语的人来说。

PS既然你问：

您可以遍历字符串`charCodeAt()`并在整数上执行关联数组。但我仍然不推荐它。

“Doña”的意思是“女士”，而“dona”的意思是“甜甜圈”。“de”的意思是“来自”，“dé”的意思是“给予”。等等等等。

它们不仅仅是带有恼人的飞斑的普通字母，它们实际上与“E”和“F”或“P”和“R”一样不同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-01T21:20:23.943

为德语修复了此问题，因为您将“Ae”用于“Ä”，“Oe”用于“Ö”等。

```
 /**
     * Helper arrays for unicode decomposition
     */
     var pattern:Array = new Array();
        pattern.push(new RegExp("Š", "g") );
        pattern.push( new RegExp("[ŒÖ]", "g"));
        pattern.push( new RegExp("Ž", "g"));
        pattern.push( new RegExp("š", "g"));
        pattern.push(new RegExp("[œö]", "g"));
        pattern.push( new RegExp("ž", "g"));
        pattern.push(new RegExp("[ÀÁÂÃÅ]","g"));
        pattern.push( new RegExp("[ÆÄ]","g"));
        pattern.push( new RegExp("Ç","g"));
        pattern.push( new RegExp("[ÈÉÊË]","g"));
        pattern.push(new RegExp("[ÌÍÎÏ]", "g"));
        pattern.push( new RegExp("Ð", "g"));
        pattern.push( new RegExp("Ñ","g"));
        pattern.push( new RegExp("[ÒÓÔÕØ]", "g"));
        pattern.push( new RegExp("Ü","g"));
        pattern.push( new RegExp("[ÙÚÛ]","g"));
        pattern.push( new RegExp("[ŸÝ]", "g"));
        pattern.push( new RegExp("Þ", "g"));
        pattern.push( new RegExp("ß", "g"));
        pattern.push( new RegExp("[àáâãå]","g"));       
        pattern.push( new RegExp("[æä]","g"));
        pattern.push( new RegExp("ç","g"));
        pattern.push( new RegExp("[èéêë]","g"));
        pattern.push( new RegExp("[ìíîï]","g"));
        pattern.push( new RegExp("ð", "g"));
        pattern.push( new RegExp("ñ","g"));
        pattern.push( new RegExp("[òóôõø]", "g"));
        pattern.push( new RegExp("ü","g"));
        pattern.push( new RegExp("[ùúû]","g"));
        pattern.push( new RegExp("[ýÿ]","g"));
        pattern.push( new RegExp("þ", "g"));

         var patternReplace:Array = [
            "S",
            "Oe",
            "Z",
            "s",
            "oe",
            "z",
            "A",
            "Ae",
            "C",
            "E",
            "I",
            "D",
            "N",
            "O",
            "Ue",
            "U",
            "Y",
            "Th",
            "ss",
            "a",
            "ae",
            "c",
            "e",
            "i",
            "d",
            "n",
            "o",
            "ue",
            "u",
            "y",
            "th"];

    /**
     * Returns the Unicode decomposition of a given run of accented text. 
     * @param value The original string
     * @return The string without accents
     */     
    private static function decomposeUnicode(str:String):String
    {
        for (var i:int = 0; i < pattern.length; i++)
        {
            str = str.replace(pattern[i], patternReplace[i]);
        }
        return str;
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-07-05T17:52:12.677

感谢您的答复。

我来自阿根廷，我们说西班牙语，就像 MarkusQ 所说，去除口音可以改变单词的整个含义。但我还想说，在某些情况下，去除重音会更好。

我正在为搜索功能编写脚本，您可以在其中通过名字找到人。数据来自登记表，人们可以按照自己喜欢的方式写名字，例如：Lopez/Lópes、Matias/Matías 等。

因此，对于 AS3，“Lopez”和“López”是不同的词，当用户搜索“lopez”时，我希望它们都出现在搜索结果中。

这样，我的解决方案是删除所有重音符号，并在搜索框的文本字段中使用掩码来避免使用重音符号。我认为是最好的解决方案，有人有更好的主意吗？谢谢你！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-09-23T13:32:35.213

```
 private var sdiakA:Array;
    private var bdiakA:Array;
    private function initReplaceDiacritic(){
        var sdiak = "áäčďéěíĺľňóôöŕšťúůüýřžÁÄČĎÉĚÍĹĽŇÓÔÖŔŠŤÚŮÜÝŘŽ";
        var bdiak = "aacdeeillnooorstuuuyrzAACDEEILLNOOORSTUUUYRZ";
        sdiakA = new Array();
        bdiakA = new Array();

        for (var i=0;i<sdiak.length;i++)
            sdiakA.push(new RegExp(sdiak.charAt(i), "g"))
        for (i=0;i<sdiak.length;i++)
            bdiakA.push(bdiak.charAt(i))
    }
    private function replaceDiacritic(string:String){               
        for (var i:int = 0; i < sdiakA.length; i++)
            string = string.replace(sdiakA[i], bdiakA[i]);
        return (string)
    }
initReplaceDiacritic();
var str = replaceDiacritic("šžřáíéééíčšřčš"); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-19T05:07:48.680

我希望这对任何人都有用： [https ://github.com/infralabs/DiacriticsRemove](https://github.com/infralabs/DiacriticsRemove)

此类从包含 Latin-1 Supplement、Latin Extended-A 和 Latin Extended-B 特殊字符的字符串中删除变音符号。

**用法：**

```
var specialCharacters:String = "";
specialCharacters+="Latin-1 Supplement\n";
specialCharacters+="ÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖ×ØÙÚÛÜÝÞßàáâãäåæçèéêëìíîïðñòóôõö÷øùúûüýþÿ\n";
specialCharacters+="Latin Extended-A\n";
specialCharacters+="ĀāĂăĄąĆćĈĉĊċČčĎďĐđĒēĔĕĖėĘęĚěĜĝĞğĠġĢģĤĥĦħĨĩĪīĬĭĮįİıĲĳĴĵĶķĸĹĺĻļĽľĿŀŁłŃńŅņŇňŉŊŋŌōŎŏŐőŒœŔŕŖŗŘřŚśŜŝŞşŠšŢţŤťŦŧŨũŪūŬŭŮůŰűŲųŴŵŶŷŸŹźŻżŽžſ\n";
specialCharacters+="Latin Extended-B\n";
specialCharacters+="ƒǺǻǼǽǾǿ\n";
specialCharacters+="Latin Extended Additional\n";
specialCharacters+="ẀẁẂẃẄẅỲỳ\n";

trace(new DiacriticsRemove().Parse(specialCharacters)); 
```

**来源：**

> *拉丁语 1 补充*
> 
> > ÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖ×ØÙÚÛÜÝÞßàáâãääåæçèéêëìíîïïðñòóôõö÷øùúûüýþÿ
> 
> *拉丁语扩展-A*
> 
> > ĀāĂăĄąĆćĈĉĊċČčĎďĐđĒēĔĕĖėĘęĚěĜĝĞğĠġĢģĤĥĦħĨĩĪīĬĭĮįİıĲĳĴĵĶķĸĹĺĻļĽľĿŀŁłŃńŅņŇňŉŊŋŌōŎŏŐőŒœŔŕŖŗŘřŚśŜŝŞşŠšŢţŤťŦŧŨũŪūŬŭŮůŰűŲųŴŵŶŷŸŹźŻżŽžs
> 
> *拉丁语扩展-B*
> 
> > ƒǺǻǼǽǾǿ
> 
> 拉丁扩展附加
> 
> > ẀẁẂẃẄẅỲỳ</p>

**结果：**

> *拉丁语 1 补充*
> 
> > AAAAAAAECEEEEIIIIDNOOOOO×OUUUUYTHssaaaaaaaaeeeiiiidnooooo÷ouuuuythy
> 
> *拉丁语扩展-A*
> 
> > 啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊
> 
> *拉丁语扩展-B*
> 
> > 呸呸呸呸
> 
> 拉丁扩展附加
> 
> > 万维网

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-27T14:21:20.443

另一种选择：

```
 public static function noAccent(source:String):String
    {
        source = source.replace(/[àáâãäå]/g, "a");
        source = source.replace(/[ÀÁÂÃÄÅ]/g, "A");
        source = source.replace(/[èéêë]/g, "e");
        source = source.replace(/[ËÉÊÈ]/g, "E");
        source = source.replace(/[ìíîï]/g, "i");
        source = source.replace(/[ÌÍÎÏ]/g, "I");
        source = source.replace(/[ðòóôõöø]/g, "o");
        source = source.replace(/[ÐÒÓÔÕÖØ]/g, "O");
        source = source.replace(/[ùúûü]/g, "u");
        source = source.replace(/[ÙÚÛÜ]/g, "U");
        source = source.replace(/[ýýÿ]/g, "y");
        source = source.replace(/[ÝÝŸ]/g, "Y");
        source = source.replace(/[ç]/g, "c");
        source = source.replace(/[Ç]/g, "C");
        source = source.replace(/[ñ]/g, "n");
        source = source.replace(/[Ñ]/g, "N");
        source = source.replace(/[š]/g, "s");
        source = source.replace(/[Š]/g, "S");
        source = source.replace(/[ž]/g, "z");
        source = source.replace(/[Ž]/g, "Z");
        source = source.replace(/[æ]/g, "ae");
        source = source.replace(/[Æ]/g, "AE");
        source = source.replace(/[œ]/g, "oe");
        source = source.replace(/[Œ]/g, "OE");
        return source;
    } 
```

资料来源： http: [//blog.geturl.net/post/2010/01/31/[AS3 ]-Supprimer-tous-les-accents-d-une-chaine-de-caract%C3%A8re](http://blog.geturl.net/post/2010/01/31/[AS3]-Supprimer-tous-les-accents-d-une-chaine-de-caract%C3%A8re)

# email - 如何通过邮件向自己发送使用 maven 的项目备份？

> ID：587246
> 
> 赞同：-2
> 
> 时间：2009-02-25T18:33:05.737
> 
> 标签：email, maven-2

在我的宠物项目变得足够严肃以至于值得真正的版本控制（及其令人头疼的问题）之前，我喜欢在工作一段时间后通过电子邮件给自己发送源代码。如何使用 maven 轻松完成此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T04:13:35.373

您将使用使用[描述符的](http://maven.apache.org/plugins/maven-assembly-plugin/descriptor-refs.html#src)[程序集`src`](http://maven.apache.org/plugins/maven-assembly-plugin/descriptor-refs.html#src)来完成将所有源代码和 pom.xml 打包到一个漂亮的 zip 中，然后您可以手动通过电子邮件发送给自己。如果你想变得非常花哨，你可以使用 Maven Ant 插件来调用[可以发送电子邮件的任务](http://ant.apache.org/manual/Tasks/mail.html)。

您将从命令行运行的核心命令是：

```
mvn assembly:assembly 
```

[程序集插件使用页面](http://maven.apache.org/plugins/maven-assembly-plugin/usage.html)提供了有关使用此插件将所有内容聚合到包 (zip) 中的一些详细信息。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-25T19:30:49.967

我不知道你为什么不设置版本控制，它[非常简单](https://blog.codinghorror.com/setting-up-subversion-on-windows/)。

# flash - 避免光标更改 Flash CS3 中的动态文本字段

> ID：587252
> 
> 赞同：9
> 
> 时间：2009-02-25T18:33:54.800
> 
> 标签：flash, actionscript-3, textfield, cs3

我在 MovieClip 符号中有一个动态文本字段。每当鼠标指针悬停在符号上时，光标就会变为 I 形文本编辑光标。这可能是一个非常愚蠢的问题，但有什么办法可以避免这种情况吗？即使不使用也`mouse.hide()`不会出现“I”光标。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T18:37:58.563

您是否尝试过将 TextField 的 selectable 属性设置为 false？这将防止用户拖动鼠标来选择文本（因此他们无法将其复制到剪贴板），但我相信这也应该防止光标发生变化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T18:52:25.380

mc.selectable = false;

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-01T17:13:55.100

对于 CS4：属性框中有一个图标（小按钮），当您选择文本字段时可用，您可以打开和关闭该图标以确定文本是否可选。此按钮位于属性框中的消除锯齿下方。

# api - 为什么 lseek 返回 0？

> ID：587254
> 
> 赞同：4
> 
> 时间：2009-02-25T18:33:55.127
> 
> 标签：api, macos, darwin

`lseek()`应该返回文件描述符的位置。

[文档](http://developer.apple.com/DOCUMENTATION/DARWIN/Reference/ManPages/man2/lseek.2.html#//apple_ref/doc/man/2/lseek)说：

> 成功完成后，lseek() 返回从文件开头开始以字节为单位测量的结果偏移位置。否则，返回值 -1 并设置 errno 以指示错误。

麻烦的是，即使这样也行不通：

```
#include <fcntl.h>
#include <stdio.h>
#include <errno.h>
printf("size off_t: %i\n", sizeof(off_t));

off_t pos;
pos = lseek(file, (off_t)0, SEEK_CUR);
printf("pos: %lli\n", pos);

// same result for SEEK_SET and SEEK_END
pos = lseek(file, (off_t)2352, SEEK_CUR);
printf("pos: %lli\n", pos); 
```

这给了我：

```
尺寸off_t：8
位置：0
位置：0

```

为什么是这样？是否有使用原始 I/O 函数查找当前偏移量的替代方法？( `read`, `open`, `lseek`, ...)

**编辑1：**

我试图让这个例子更简单。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T20:35:46.753

尝试将 #include <unistd.h> 添加到顶部。

见：[http ://forums.macosxhints.com/archive/index.php/t-35508.html](http://forums.macosxhints.com/archive/index.php/t-35508.html)

基本上，因为你没有`#include <unistd.h>`，编译器是“猜测”`lseek()`返回一个 int。

可能一个 int 是 4 字节长，并且由于 PPC 是“大端”字节顺序，因此您将获得“顶部”4 个字节，它们都为零。

包含 unistd.h 让编译器意识到它`lseek()`正在返回一个`off_t`，所以你不会丢失一半的字节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T19:56:21.607

有其他事情发生了，可能是一些愚蠢的事情。我试过你的代码，如下所示：

```
#include <fcntl.h>
#include <stdio.h>
#include <errno.h>
#include <stdlib.h>

int main(int argc, char *argv[]){
    off_t pos;
    int file ;
    if((file = open("/Users/chasrmartin/.bash_history",O_RDONLY)) == -1){
        perror(argv[0]);
        exit(1);
    }
    printf("size off_t: %i\n", sizeof(off_t));

    pos = lseek(file, (off_t)0, SEEK_CUR);
    printf("pos: %lli\n", pos);

    // same result for SEEK_SET and SEEK_END
    pos = lseek(file, (off_t)2352, SEEK_CUR);
    printf("pos: %lli\n", pos);

    exit(0);
} 
```

并得到这个结果：

```
bash $ gcc foo.c
重击 $ ./a.out
尺寸off_t：8
位置：0
位置：2352

```

（确切地说，这是在 Intel 的 Mac OS/X 10.5.6 上。）

### 更新。

或者，也许这并不傻。我刚刚在 PPC G5 上试了一下，得到了你做的结果。

### 更新 2

好的，这是 PPC 上的结果：

```
$ gcc foo.c
$ ./a.out
尺寸off_t：8
位置：0
位置：0

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T19:15:17.523

它是什么样的文件？它是一个管道吗？因为如果它不是普通文件，它很可能不支持查找：

> lseek() 在无法搜索的设备上的行为是实现定义的。与此类设备关联的文件偏移值未定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T18:37:39.550

您可能希望将测试更改为：

```
if ( (pos = lseek(file, (off_t)i, SEEK_CUR)) != -1 ) { 
```

您可能在某处打了 -1，但您在这里测试的是 0。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T18:39:23.273

我不确定我是否理解您的问题，但这里有一些想法可能会有所帮助。

*   偏移量 0 有效；这意味着你在文件的开头
*   根据您的平台，off_t 可能会被限制为 32 位无符号。
*   您是否打算寻求相对于您当前的职位？

——马库斯

# ruby - 我应该升级到 Ruby 1.9 吗？

> ID：587271
> 
> 赞同：2
> 
> 时间：2009-02-25T18:39:21.103
> 
> 标签：ruby, ruby-1.9

是时候升级到 Ruby 1.9 了吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T18:42:29.880

我的简短回答是：

“不”。

我的长答案是：

1.9.1 版仍然是一个开发分支。玩起来很有趣，如果你有兴趣，你应该玩一下，但仍然有很多震动正在进行。许多 gem 和库仍在适应它。

所以可以探索，不可以用于生产。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T02:08:01.760

有一个很好的网站，详细介绍了各种 gem 与 Ruby 1.9 的兼容性，名为[http://isitruby19.com](http://isitruby19.com)。

我为您可能感兴趣的 Ruby 1.9.1 相关内容编写了[指南。它向您展示了如何编辑库以使它们在您的系统上工作。](http://frozenplague.net/2009/01/ruby-191-rubygems-rails/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-15T22:51:51.140

几个月来我一直在生产中使用 1.9.2 并且喜欢它。它快速且非常稳定。是的，有一些 1.8 -> 1.9 的问题，但如果你有任何测试，它们通常很快就会消失，而如果你正在编写新代码，它们就无关紧要了。

此外，Heroku 在 1.9.2 个月前落后。

[http://blog.heroku.com/archives/2011/2/9/the-path-forward-192/](http://blog.heroku.com/archives/2011/2/9/the-path-forward-192/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T22:01:00.853

在家里，我正在编写同时在 1.8 和 1.9 下运行的代码（例如，声明编码并避免使用 strings.each），并在速度更快时使用 1.9，如果我使用不喜欢 1.9 的 gem，则切换回 1.8。

但是要使用雪地克隆，“不要在工作中尝试这个”。

# excel - 识别不同的 Excel 文件格式

> ID：587272
> 
> 赞同：0
> 
> 时间：2009-02-25T18:39:21.837
> 
> 标签：excel, file-format

有没有人熟悉可以确定 excel 文件格式的库或工具？或者，如果做不到这一点，关于允许我自己编写的不同格式的文档？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T21:00:49.500

Excel 97-2003 工作簿称为 Biff8。它们实际上是 OLE 复合文档，本质上是文件中的文件系统。它们将主工作簿存储在一个名为“Workbook”的流中，并且它们还有其他用于 VBA 模块、OLE 对象、文档属性等的流......

Win32 包括用于读取 OLE 复合文档的 API。它们远非微不足道。获得“工作簿”流后，第一个 Biff 记录将文件标识为 Excel 文件。

[您可以在Microsoft Office 二进制文件格式](http://www.microsoft.com/interop/docs/OfficeBinaryFormats.mspx)页面上找到来自 Microsoft 的有关 Biff8 文件格式的优秀文档。

新的 Excel 2007 Open XML (xlsx) 格式实际上是一个带有工作簿部分的 zip 文件，并记录在[OpenXmlDeveloper.org 上](http://openxmldeveloper.org/default.aspx)。

我不知道有一种工具可以简单地告诉您工作簿的格式。您可以采用简单但不太可靠的方法，即仅查看 99% 以上正确的扩展 - 如果准确性不是问题。

有许多工具可以读取 xls 和 xlsx 工作簿，包括[用于 .NET 的 SpreadsheetGear，](http://www.spreadsheetgear.com/)它可以同时读取两者。

免责声明：我拥有 SpreadsheetGear LLC

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T20:46:41.313

Excel 文件格式称为二进制交换文件格式 (BIFF)，有不同版本的 Excel 使用相同版本的 BIFF。

打开[Excel 文件格式](http://sc.openoffice.org/excelfileformat.pdf)的 Office 文档。

看看[Open Office API](http://api.openoffice.org/)，这应该会对你有所帮助。

# printing - 基于网络的打印解决方案

> ID：587277
> 
> 赞同：4
> 
> 时间：2009-02-25T18:40:26.360
> 
> 标签：printing

我正在构建一个新的基于 Web 的产品。问题是许多客户都有特定的打印机来打印特定的文档。想想报告、条形码、发票等。所有这些都在一个特殊的打印机上用正确的纸张等......

通常从 Web 打印时，您无法让软件选择打印机或更改设置。然而，这只是我想做的。

*我想在没有对话框的情况下打印。并用我的软件输入打印机+设置*

我现在知道的唯一解决方案是商业版的 acrobat，它有一些 javascript 打印支持。

有谁知道任何其他选择？

提前致谢 ！

*   中小型企业
*   没有繁重的安装，但常见的东西是可以的，即。闪光灯/silverlight/acrobat/任何可能
*   我生成打印所需的内容（PDF/Tiff 等）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T18:46:19.043

你的客户是谁——企业还是SOHO？你在生成 PDF 吗？或者，原始的tiffs？如果您要生成 PDF，则有一个称为[JDF](http://www.cip4.org/overview/what_is_jdf.html)文件的文件，您可以在其中指定打印设置以符合您的要求。另一方面是设备需要能够理解 JDF。然后，您可以将带有 PDF 的 JDF 作为 mime 包附加。如果您正在生成 tiff，我认为除了要安装正确的设备配置文件外，不需要太多打印机设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T07:06:38.470

您的简单选择是 PDF 或 Microsoft 的报告/报告查看器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T18:54:45.997

由于安全原因，您无法从浏览器中控制它。

如果我在你的鞋子里，我会创建一个小程序供我的客户安装，为这个程序注册一个特定的文件扩展名，并在网站上创建这种格式的文件，然后让程序为我打印。

# installation - Inno Setup 作为 .msi 的引导程序

> ID：587279
> 
> 赞同：2
> 
> 时间：2009-02-25T18:41:05.547
> 
> 标签：installation, windows-installer, inno-setup

我正在尝试使用 Inno Setup 来引导我的 Windows 安装程序安装包的一些先决条件，并且我对此非常幸运。

**现在我想知道是否可以制作 Inno Setup 包，使其不会出现在“添加/删除程序 (ARP)”窗口选项中？**

我希望将单独的安装一起安装（每个都是有条件的）但单独删除。

我将安装包安装到 Inno Setup 生成的临时文件夹中，因此实际文件在安装序列结束时被删除，但 ARP 仍然显示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T07:04:04.450

你试过“可卸载=假”吗

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T18:56:35.167

我想我明白了！

ARP 的注册表项是在安装完成之前添加的，因此我可以在 [run] 部分删除注册表项，并且没有留下引导安装的痕迹。

# java - 为什么这段代码会导致“非法开始表达式”异常？

> ID：587280
> 
> 赞同：1
> 
> 时间：2009-02-25T18:41:21.863
> 
> 标签：java, boolean, return-value, static-methods

这些是我的问题：

1.  我在 "public static boolean validNumCheck(String num){" - "illegal start of expression", "';' 预期”和“')'预期”。

2.  我怎样才能为每个号码给用户 3 次尝试？我相信现在程序要求用户输入 3 个数字，并总共给他们 3 次尝试以使数字正确（我的解释很糟糕……阅读代码以更好地理解我的意思）。

这是我的代码：

```
import javax.swing.JOptionPane;

public class Assignment3 {
    public static void main (String[] args){
        final int MAX_TRIES = 3;
        int[] attempts= new int[2];
        String[] getNumber= new String [2];

        //Ask the user for 3 integers.
        while(attempts[0]<MAX_TRIES){
            getNumber[0]= JOptionPane.showInputDialog(null,"Please enter an integer between 0-200.");

            //Pass the value to validNumChek
            validNumCheck (getNumber);

            //If it is not a valid number give the user 3 more tries.
            if (getNumber== false){
                while(attempts[1]<MAX_TRIES){
                    getNumber[1]= JOptionPane.showInputDialog(null,"Please enter an integer between 0-200.");
                    attempts[1]++;}
                }
            attempts[0]++;
        }

    //Parse the string to an integer and check if it is a valid number.
    public static boolean validNumCheck(String num){
        int number;

        try {
            number = Integer.parseInt(num);
            return number >= 0 && number <= 200;                
        }catch(NumberFormatException e){
            //If it is not a valid number return false.
            return false;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T20:39:58.367

我认为首先创建问题的伪代码或算法很重要**，然后如果它有效，则****稍后**处理编程。否则，您将同时解决两件事 1\. 问题逻辑和 2\. 实施细节。

我就是这样做的。

```
//The three numbers should be entered by a user in the main method. 

MAIN PROGRAM starts 
declare a , b , c as numbers

//The numbers should be positive and less than 200\. 
// see validNumCheck below.

//part 1.If not, the program asks the user to renter the number.
//part 2.The user will have three chances to enter a valid number for each number. 
//part 3\. If the number is still invalid after the three trials, the program displays an error message to the user and ends.

 // ok then read a number and validate it. 
 attempts = 0;
 maxAttempts = 3;

 //part 2\. three chances... .           
 loop_while (  attemtps < maxAttempts ) do  // or 3 directly.

      number = readUserInput();  // part 1\. reenter the number...
      if( numcheck( number ) == false ) then 
           attempts = attempts + 1;
           // one failure.. try again. 
      else 
           break the loop.
      end 

 end 

 // part 3:. out of the loop. 
 // either because the attempts where exhausted 
 // or because the user input was correct.  
 if( attempts == maxAttemtps ) then 
     displayError("The input is invalid due to ... ")
     die();
 else  
     a = number 
 end 

// Now I have to repeat this for the other two numbers, b and c.
// see the notes below... 
MAIN PROGRAM ENDS 
```

这将是“validNumCheck”的功能

```
 // You are encouraged to write a separate method for this part of program – for example: validNumCheck

bool validNumCheck( num )  begin
     if( num < 0 and num > 200 ) then 
         // invalid number 
         return false;
     else 
         return true;
     end
end 
```

所以，我们已经到了可以验证数字“a”但我们需要对“b”和“c”做同样的事情的地步

而不是“复制/粘贴”您的代码，并尝试调整代码以适应您的需求，您可以创建一个函数并将该工作委托给新函数，而不是让您的生活复杂化。

所以新的伪代码将是这样的：

```
MAIN PROGRAM STARTS 
declare a , b , c as numbers
     a = giveMeValidUserInput();
     b = giveMeValidUserInput();
     c = giveMeValidUserInput();

     print( a, b , c ) 

MAIN PROGRAM ENDS 
```

并将逻辑移至新函数（或方法）

函数 giveMeValidUserInput 将是这样的（注意它与第一个伪代码几乎相同）

```
function giveMeValidUserInput() starts 
    maxAttempts = 3;
    attempts = 0;

     loop_while (  attemtps < maxAttempts ) do  // or 3 directly.

          number = readUserInput();
          if( numcheck( number ) == false ) then 
               attempts = attempts + 1;
               // one failure.. try again. 
          else 
               return number 
          end 

     end 

     // out of the loop. 
    // if we reach this line is because the attempts were exhausted.
     displayError("The input is invalid due to ... ")
   function ends 
```

validNumCheck 不会改变。

从那个 do 代码中传递会很简单。因为你已经明白了你想做什么（分析），以及你想怎么做（设计）。

当然，如果有经验，这会更容易。

概括

[从问题传递到代码](https://stackoverflow.com/questions/137375/process-to-pass-from-problem-to-code-how-did-you-learn)的步骤是：

1.  阅读问题并理解它（当然）。

2.  识别可能的“功能”和变量。

3.  写下我将如何一步一步做（算法）

4.  把它翻译成代码，如果有什么你不能做的，创建一个为你做的函数并继续前进。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T18:46:05.753

在[方法签名](http://en.wikipedia.org/wiki/Method_signature)（即“ `public static int validNumCheck(num1,num2,num3)`”）中，您必须声明[形参](http://en.wikipedia.org/wiki/Parameter_(computer_science)#Parameters_and_arguments)的类型。“ `public static int validNumCheck(int num1, int num2, int num3)`”应该可以解决问题。

然而，一个更好的设计是`validNumCheck`只取一个参数，然后你可以用三个数字中的每一个来调用它。

* * *

我的下一个建议（看到你更新的代码）是你得到一个像样的 IDE。我刚刚在 NetBeans 中加载它并发现了许多错误。特别是，“表达式的非法开始”是因为您`}`在 while 循环中忘记了一个，IDE 会立即标记它。在您通过“Hello world”之后，记事本就不再剪切它了。

我不会列出每个错误的更正，但请记住，`int[]`、`int`、`String[]`和`String`都是不同的。您似乎可以互换使用它们（可能是由于您对代码所做的更改量）。同样，IDE 会标记所有这些问题。

* * *

响应您的最新代码（修订版 12）：您越来越近了。您似乎使用`MAX_TRIES`了两个不同的目的：输入三个数字，以及每个数字的三个机会。虽然这两个数字相同，但最好不要对两者使用相同的常数。`NUM_INPUTS`并且`MAX_TRIES`是我所说的。

而且您还没有`}`为 while 循环添加缺失的内容。

修复这些之后要做的下一件事就是查看`if (getNumber == false)`. `getNumber`是 a `String[]`，所以这种比较是非法的。您应该将 的返回值`validNumCheck`放入变量中，例如：

```
boolean isValidNum = validNumCheck(getNumber[0]); 
```

而且，没有理由`getNumber`成为一个数组。你一次只需要一个`String`，对吧？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T18:49:33.483

方法定义中的每个参数都需要一个类型：

```
public static int validNumCheck(int num1, int num2, int num3){ 
```

但是我想知道为什么您一次只检查一个数字，而将所有三个数字都输入。如果数字为真，你想返回，所以返回值应该是一个布尔值：

```
public static boolean validNumCheck(int num){
    // test and return true or false 
```

此外，如果用户输入“abc”，您将从“Intger.pareInt(String)”方法中得到一个异常。也许您想将输入的文本存储为字符串并将其提供给 validNumCheck，尝试对其进行转换并检查它是否在 0 到 200 之间。

```
public static boolean isValidNumber(String num){
try {
    int number = Integer.parseInt(num);
    return number >= 0 && number <= 200;        
}catch(NumberFormatException e){
    return false;
}
} 
```

**编辑1：** 对于三次尝试，您需要一个循环，该循环一直运行到数字有效或进行三次尝试。只需用 int 计算尝试次数。

顺便问一下，您确定必须使用 JOptionPane 和 JMessageDialog 吗？这是 GUI 的东西，只是使那个洞的事情复杂化了。您还可以使用 System.out 和 System.in 在控制台中读取和写入文本

**编辑 2：** 还有一个提示，当您创建一个具有给定长度的 int 数组时，数组中的每个位置都用 0 填充，因此您可以编写：

```
int[] count= new int [3]; 
```

并且不需要：

```
count[0]=0;
count[1]=0;
count[2]=0; 
```

如果你想使用 0 以外的其他值，你可以使用更短的形式，如下所示：

```
int[] count = {1, 5, 2} 
```

**编辑3：** 你应该做/学习的一件事是：不要写整个事情，最终会出现很多错误并且程序没有运行。**一点代码，一点测试**。做它的一部分，看到它运行，你很高兴。

这东西跑过吗？我的意思是，您是否已经看到您尝试使用的 JOptionPane-InputDialog ？如果没有，请先执行此操作：（并运行它！）

```
public class Assignment3 {

    public static void main (String[] args){

        int[] numbers = new int[3];

        for (int i = 0; i < numbers.length; i++) {
            JOptionPane.showInputDialog("enter something");
        }
    }
} 
```

跑起来了吗？伟大的！现在，尝试用 JOptionPane 将该行包装在一个循环中，直到用户输入一个有效数字（使用您已经获得的 checkValidNum 方法）或使用他的三次尝试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T19:08:29.660

[该线程](https://stackoverflow.com/questions/137375/process-to-pass-from-problem-to-code-how-did-you-learn)可能会有所帮助。这些是从“问题描述”到“实际编码”的提示

根据您的具体问题：

> *如何让用户有三次机会为每个号码输入有效号码？（我不想要“答案”只是一些想法/提示。*

如果你是现实生活中的收银员（记性不好），你会怎么做？我的意思是非常非常糟糕的记忆力，以至于你不记得你是第一次还是第二次拒绝客户？

我会把它写在一张纸上，每次我拒绝客户时，我都会添加一个“|”

“|||”

当纸上有三行时，我会报警。.. :)

这里也是类似的。如果您没有一些可能会**有所不同****的东西**， 您将陷入无限**循环**；）

 ****> *validNumCheck 是否假设返回一个值，然后在 void main 方法中退出*

不

> *...或者我可以让它在那个主要方法中退出程序吗？*

是的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T19:54:23.077

当您计数（在现实生活中）时，您不需要将数字存储在盒子中，您只需更改计数的值并设置限制。

例如，您可以替换它：

```
 int[] count= new int[2]; 
```

有了这个：

```
 int attemtps = 0 ; // or count 
        int maxTries = 3; 
```

您不能将整数数组分配给字符串数组。

```
 String[] getNumber= new int [2]; 
```

使用字符串数组可能有效，但您必须分配字符串数组

```
 String[] numbers = new String[2]; 
```

或者您可以使用 int 数组：

```
 int [] numbers = new int [2]; 
```

选一个。

请记住，数组就像可以存储值的盒子。

# asp.net - SQL：选择每个用户的 TOP N 标记（在用户列表中）

> ID：587282
> 
> 赞同：1
> 
> 时间：2009-02-25T18:42:18.150
> 
> 标签：asp.net, sql, sql-server, stored-procedures

我很难编写一个存储过程，它将用他们的关联标记查询学生列表。

检索学生列表 - 琐碎 检索每个学生的前五名 - 琐碎...SELECT TOP (5) * WHERE StudentID = X

结合这两个，我有点困惑。

我希望存储过程返回两个表：

*   第一个按标准列出学生的表格
*   第二张表：成绩列表（第一张表中每个学生各 5 个）

第二张桌子很棘手。我可以在 First Table 中获得每个学生的所有分数，但不确定如何将其限制在前 5 名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T18:52:52.710

尽量避免返回 2 个结果集的存储过程。进行这 2 个单独的程序。

如果您未指定排序顺序，TOP 5 将返回随机行。我假设您想按年级排序。如果最高等级都相同，您将需要一些额外的排序标准。例如，您可以返回最近的前 5 个成绩。

对于返回每个学生前 5 名的第二个过程，请查看 RANK 子句的语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T19:23:37.270

如果您使用的是 SQL 2005 或更高版本，这应该可以工作。如果没有，还有其他稍微混乱的方法可以做到这一点。

```
WITH Student_Grades AS
(
    SELECT
        S.student_id,
        G.grade,
        RANK() OVER (PARTITION BY S.student_id, ORDER BY G.exam_date DESC) AS grade_rank
    FROM
        Students S
    LEFT OUTER JOIN Grades G ON
        G.student_id = S.student_id
)
SELECT
    student_id,
    grade
FROM
    Student_Grades
WHERE
    grade_rank <= 5 
```

# iphone - 我要在 iPhone 上释放这个实例变量吗？

> ID：587284
> 
> 赞同：4
> 
> 时间：2009-02-25T18:42:18.883
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我有一个负责构建模型对象的班级和所有者。它为模型分配内存并保留它们，并负责在 dealloc 发生时释放它们。

现在我有一个相应的 UIViewController 在这种情况下充当客户端。它将有几个实例变量，指向它需要的模型。它不需要为它们分配内存，因为负责这样做的类已经完成了。我还需要从客户端释放内存吗？这是一个例子

ModelHolder.m 会有类似的东西

```
- (NSArray *)modelA
{
   if (modelA == nil) {
       modelA = [[ModelClassA alloc] init];
   }

   return modelA

}

- (void)dealloc { [super dealloc]; [modelA release]; } 
```

现在 ClientViewController 将有类似的东西：

```
 @class myModelA;
 @interface ClientViewController : UIViewController {
     ModelClassA myModelA;
 }

 // more code
 @end
 #import "ModelHolder.h"
 @implementation ClientViewcontroller ...... etc
 - (void)viewDidLoad
 {  
     self.myModelA = [instanceOfModelHolder modelA];
 }
 - (void)dealloc {
     // am I responsible to release here?
 } 
```

请不要介意任何语法错误，因为我只是在这里即时写的。我认为我的观点在代码中得到了很好的说明。

谢谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T18:49:39.473

假设您将 ClientviewController 的`modelA`属性声明为`@property(retain)`、`@property(copy)`或`@property(mutableCopy)`，您将保留该属性的值，因此您必须释放它。

从 2013 年开始编辑：假设您没有使用 ARC。ARC 会为你做这件事，所以*通常*不需要`dealloc`在 ARC 下实现。当不使用 ARC 时，你需要释放你拥有的一切。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T18:45:42.273

你应该把`[super dealloc];`最后一个放在你自己的dealloc中。

```
- (void)dealloc
{
    [modelA release];
    [super dealloc];
} 
```

至于您关于在最后一个 dealloc 中释放的问题，这取决于您如何指定@property myModelA，它是“保留”还是“复制”属性，您应该进行释放。它是一个“副本”吗？您实际上是在负责一个新对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-17T09:51:19.457

你应该这样做的谎言

```
 - (void)viewDidLoad
 {  
     ModelClassA *myModelA = [instanceOfModelHolder modelA];
     self.myModelA = myModelA;
     [myModelA release];
 } 
```

因为在其他任何地方释放它都可能导致内存泄漏，如果引用计数没有得到正确处理，有时甚至会导致应用程序崩溃。

另请注意，您还没有创建`ModelClassA myModelA;`一个属性，因此您应该避免在 dealloc 中释放它，直到您确定它的引用计数大于 1。

# c# - 从 c# 调用 Powershell Pretty Console 输出

> ID：587287
> 
> 赞同：3
> 
> 时间：2009-02-25T18:43:20.457
> 
> 标签：c#, .net, powershell

Powershell 有一些非常漂亮的格式化模块，用于显示对象、数组、集合、字典和表格数据。

由于 Powershell 都是 .NET，我假设有一个包含此逻辑的程序集。

**谁能想出一种方法来从 .NET 调用这些 powershell 格式：**

我会想象这样的事情：

```
Console.WriteLine(Powershell.DisplayObject(obj)) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T03:47:14.627

这就是您在 V2 中的操作方式：

```
PowerShell.Create().AddScript("get-Process |Out-String").Invoke() 
```

关键是调用 OUT-STRING。

实验！享受！从事！

Jeffrey Snover [MSFT] Windows 管理合作伙伴架构师

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T07:20:45.033

您可能想用 | 控制输出的宽度 例如，out-string -width 120。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T15:54:52.457

这可能不是您要去的地方，但请查看扩展类型系统。

这是一个很好的起点： [msdn](http://msdn.microsoft.com/en-us/library/ms714419(VS.85).aspx) [PS blog](http://blogs.msdn.com/powershell/archive/2008/09/06/hate-add-member-powershell-s-adaptive-type-system.aspx) [blog](http://jtruher.spaces.live.com/Blog/cns!7143DA6E51A2628D!148.entry)

# regex - 如何使用正则表达式 (glob) 搜索文件树

> ID：587288
> 
> 赞同：5
> 
> 时间：2009-02-25T18:44:56.333
> 
> 标签：regex, search, tree, glob

如何调整搜索树以处理有限的正则表达式？

给定一个文件名，我需要找到与该文件名匹配的所有节点。节点可能包含通常的文件名 glob（* 和？）。由于这是一棵搜索树，因此速度至关重要。

我应该补充一点，速度最重要的情况是排除比赛的平均时间。在大多数情况下，匹配会失败。

如果树包含以下节点：

```
foo, bar, foo*, *bar, foo?bar 
```

*   搜索“foo”将返回节点 1 和 3。
*   搜索“bar”将返回节点 2 和 4。
*   搜索“fob”将不返回任何节点。
*   搜索“fooxbar”将返回节点 5。
*   搜索“foobar”将返回节点 3 和 4。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-25T19:03:30.687

一个[Aho-Corasick](http://en.wikipedia.org/wiki/Aho-Corasick_algorithm)搜索树将符合要求。“ [Tries](http://jeffreystedfast.blogspot.com/2008/12/fun-with-tries.html) ” 是一篇关于这类事情的非常好的文章，以及Evolution 中用于替换正则表达式搜索的[Etrie实现。](http://svn.gnome.org/viewvc/evolution-data-server/trunk/libedataserver/e-trie.c?revision=9011&view=markup)

要进行整个字符串匹配，您可以添加开始和结束锚状态。如果扫描多行数据，您可以在开头和结尾添加换行符。您还可以删除为部分匹配添加交叉链接的部分，以开始不同的匹配。这也允许更快的排除。

另一种检查字符串集中成员资格的算法是[CritBit](http://github.com/agl/critbit)。这没有正则表达式，但它很简单并且可以测试完整的字符串。

# vb.net - 如何在设计时在用户控件中显示文本字符串？

> ID：587298
> 
> 赞同：0
> 
> 时间：2009-02-25T18:46:07.843
> 
> 标签：vb.net, user-controls

我正在创建一个包含面板以及 4 个字符串和整数属性的用户控件。我想在设计时在用户控件中显示属性的文本。我该怎么做呢？我很难找到例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T18:57:34.993

奇怪的问题，通常的问题是隐藏属性。让它看起来像这样：

```
Imports System.ComponentModel

Public Class UserControl1

    Private mAardvark As Integer

    <DefaultValue(0)> _
    Public Property Aardvark() As Integer
        Get
            Return mAardvark
        End Get
        Set(ByVal value As Integer)
            mAardvark = value
        End Set
    End Property
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T12:06:14.833

艾米，很难确切地说出你在追求什么。

当您在用户控件中有属性时，您可以在设计视图的属性窗口中查看和编辑这些属性。

因此，如果您在属性窗口中选择 nobugz 答案，您将能够为属性 Aardvark 设置一个值。

你问的是你想在文本框之类的东西中查看属性的值吗？

如果是这种情况，您需要确保从属性返回的值是一个值，即不是什么都没有！并且该属性是在诸如 Load 之类的事件中设置的。

同样在设计时，用户控件视图不会绘制值，如果您将控件放在窗体上，您将能够在文本框中看到属性的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T01:58:17.873

我不确定你在问什么，但我假设你想在设计时在控件中显示属性文本并在运行时隐藏它。

如果是这种情况，您将需要在属性值更改时更新 Label.Text 值。

我假设您的控件包含一个名为 lblPageNum 的标签和一个属性 PageNum。

```
Public Class TheUserControl

Private myPageNum As String

Public Property PageNum() As String
    Get
        PageNum = myPageNum
    End Get
    Set(ByVal value As String)
        myPageNum = value
        ' This is where we set the value of the label at design-time
        lblPageNum.Text = myPageNum
    End Set
End Property

Public Sub New()

    ' This call is required by the Windows Form Designer.
    InitializeComponent()

    ' Add any initialization after the InitializeComponent() call.

End Sub

Private Sub UserControl1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    If Me.DesignMode Then
        Me.lblPageNum.Visible = True
    Else
        Me.lblPageNum.Visible = False
    End If
End Sub 
```

结束类

# encryption - AES 加密 16 字节无盐

> ID：587301
> 
> 赞同：11
> 
> 时间：2009-02-25T18:47:21.180
> 
> 标签：encryption, cryptography, aes

使用 AES 将 16 个字节的数据加密为单个块的安全性如何？没有盐/IV，没有操作模式，数百万个不同的 16 字节块被加密。我对加密的了解不够，但这对我来说很陌生。

编辑：为了提供更多细节，这不是关于加密消息，而是关于纯文本长度恰好为 16 个字节的数据库表列。数据不是完全随机的（前 8 个字节通常是相同的），并且有一个校验和来识别成功的解密。

下周我将与提出这个建议的人开会，如果有问题，我将非常感谢一些参考材料的指针，我可以用它们来证明设计是不安全的。我对该系统并不完全熟悉，但我认为这可能需要进行重大的重新设计才能解决，因此可能会遇到很多阻力。所涉及的大多数人（和权力）都在业务方面，其动机是获得一个工作系统......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T19:10:28.533

欧洲央行对于一般用途来说并不安全。给定的纯文本总是加密为相同的密文，因此可以揭示模式。但是，在某些特殊情况下它是安全的，此应用程序可能就是其中之一。

引用*应用密码学，*第二版 pg。190，关于分组密码的 ECB 模式：

> 从好的方面来说，用相同的密钥加密多条消息没有安全风险。实际上，每个块都可以看作是使用相同密钥加密的单独消息。

后来（第 208 页），施奈尔说：

> 如果简单和速度是您主要关心的问题，ECB 是使用分组密码的最简单和最快的模式。也是最弱的。除了容易受到重放攻击外，ECB 模式下的算法最容易进行密码分析。我不推荐 ECB 进行消息加密。
> 
> 对于加密随机数据，例如其他密钥，ECB 是一个很好的模式。 *由于数据简短且随机，因此 ECB 的任何缺点都与此应用无关。*

您的情况下的通用前缀和校验位不会产生通用密文。仅当复制*整个*明文块时才会发生这种情况。根据您的描述，您的应用程序可能非常适合 ECB — 特别是如果每​​个纯文本值作为一个整体都是唯一的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T18:53:21.227

如果没有盐（也称为初始化向量或 IV），密文（以及我相信密钥）的安全性会大大降低。潜在的攻击者将更容易识别加密文本中的重复模式。IIRC 这与微软在升级 MS Office 加密方案时犯的基本错误相同。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T19:25:55.750

AES 对纯密文攻击非常强大。但是，使用相同的密钥加密大量明文会使您的系统更容易受到已知明文和选择明文攻击。

话虽如此，如果加密密钥是随机的，并且明文看似随机，那么您可能仍然是安全的。但我肯定会考虑使用不同的键。

另一方面，如果明文彼此相关和/或看起来不是随机的，则 ECB 根本不安全。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T23:22:01.253

我不知道 AES 在短消息方面的任何弱点。该算法应该很高兴。

要参加您的会议，您确实需要：

1) 威胁模型（当他们离开或成为“坏人”时，他们可能会看到发生了什么、何时以及发生了什么）。

2) 来自您的威胁模型的一些用例。

有了这个，你应该能够确定你是否真的需要加盐 AES，如果你可以在其他地方得到它，那么加密是否真的保护了列中的值，这使得使用 AES 有点毫无意义。最后，问一个问题，“密钥真的比数据更安全吗？” 我见过这样的方案，其中密钥与数据大小相同（其中 size = “有点小”），并且与它所保护的数据一样可访问。是的，当攻击者弄清楚你到底做了什么时，它会为你争取几个小时，但它并没有给你带来太多可靠的安全性。

希望对您有所帮助，并为您提供一些值得咀嚼的东西。不知道你的具体职位，很难定制答案。:)

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2009-02-25T18:53:35.250

在密码学术语中，只有当攻击者知道特定的算法和 IV 时，这才是不安全的。

做了一个特定的假设：一旦解密，攻击者会知道数据是什么样子就知道解密尝试成功了吗？例如，是否有可以验证成功解密尝试的 MD5、CRC 或某种形式的校验和？如果是这样，您就为攻击者提供了一种验证尝试的方法。

但是在黑客攻击方面，仍然有 2^128 种密钥组合（对于 128 位密码），这与在 TB 数据上使用相同的密钥一样安全。操作模式无关紧要，因为 16 个字节的数据只是一个块，因此您的密码块链接 (CBC) 不适用。

但是，盐 IV 确实适用，并且该值应该与密钥本身一样保密。彩虹表可用于加速对不使用盐的密码的暴力攻击；这是你的薄弱环节。

# dynamics-crm - 在 Dynamics CRM 4.0 中同步地址更改

> ID：587304
> 
> 赞同：2
> 
> 时间：2009-02-25T18:48:02.957
> 
> 标签：dynamics-crm

我的帐户地址有问题，在我看来很明显，但我遗漏了一些东西。

在 CRM 中，有一个具有主地址的帐户。它还有一个“其他”地址列表。它还可以有一个或多个相关联的联系人，每个联系人也有一个主要地址和“其他”地址列表。

问题是，同一个地址通常在不止一个这些地方，当账户更改地址时，保持所有地址同步是一个真正的问题。对我们来说，当账户移动时，查找和更新所有出现的地址是一个非常耗时的手动过程。

我的问题是其他人如何处理地址更改的问题？我想写一个插件，它可以通过并找到地址实例并更新它们，但这真的是解决问题的唯一方法吗？在 CRM 系统中管理像这样的许多地址会如此困难，这似乎很奇怪，但就像有人说我可能遗漏了一些东西一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T15:45:38.353

不幸的是，我认为您没有遗漏任何东西：这正是 Dynamics CRM 中的方式。我能想到的只有两种解决方法： - 第一种方法根本不在联系人级别存储基于公司的地址。当然，这种方法可能不适合您的场景。- 第二种是使用某种约定：address_name 以“account_”开头的地址应该是从 Account 记录“继承”的。然后，在帐户表单上添加一个“级联地址”按钮，以启动联系人记录上 account_xxx 地址的更新。

希望能帮助到你

丹尼尔

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T02:12:20.197

简单的选项是在联系人实体（组织范围）上创建按需工作流。该工作流仅使用主要客户（帐户）地址字段更新联系人主要地址字段。然后，用户可以从帐户实体中导航到联系人关联视图，单击工作流工具栏按钮并为所有现有联系人选择级联地址工作流。使用这种方法的缺点是您依赖于用户交互。

像丹尼尔建议的那样决定一个大会是正确的方法。我会简单地禁用联系人主地址字段，以便它们只能通过您的插件进行更改，并教用户在需要输入个人联系人地址时使用更多地址功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-13T12:41:02.367

我喜欢@user95081 的工作流程理念，但我们的用户很懒惰。他们不会点击工作流按钮。

我们为帐户上的主要联系人所做的是在两者之间同步电话/电子邮件。因此，如果他们更新主要联系人，则会更新帐户。如果他们更新了帐户，则更新了联系人。我们使用一个有点棘手的插件来做到这一点，因为您不想让自己陷入无休止的循环。我正在考虑对地址做同样的事情，所以当用户在 Outlook 中查看他的联系人时，他们将拥有他们需要的所有信息。

# sql - 帮助！- SQL - IF Else IF 逻辑用于返回 Containstable 选择

> ID：587305
> 
> 赞同：2
> 
> 时间：2009-02-25T18:48:10.053
> 
> 标签：sql, linq-to-sql, full-text-search, user-defined-functions

我正在尝试在 SQL 的内联表值函数中使用 IF else If 逻辑，并根据该逻辑返回一个包含表。但我遇到了 IF Else IF 块的语法问题。谢谢您的帮助。因为我无法对包含表中的列进行参数化，所以我不得不求助于使用 if else 语句。这是代码。谢谢。

我越来越

消息 156，级别 15，状态 1，过程 FullTextSearch，第 17 行关键字“IF”附近的语法不正确。

```
ALTER FUNCTION [dbo].[FullTextSearch] 
(       
    @Columns nvarchar(100), @SearchPhrase nvarchar(100)
)

RETURNS TABLE 
AS    
RETURN 

IF (@Columns='Title')
   BEGIN
   SELECT * 
        from projects as P inner join
        containstable(PROJECTS, Title, @SearchPhrase) as K 
        on P.project_id = K.[KEY]
   END

ELSE IF (@Columns='Project_Details')
   BEGIN
   SELECT * 
    from projects as P inner join
    containstable(PROJECTS, Project_Details, @SearchPhrase) as K 
    on P.project_id = K.[KEY]
   END

ELSE IF (@Columns='Contact_Info')
   BEGIN
   SELECT * 
    from projects as P inner join
    containstable(PROJECTS, Contact_Info, @SearchPhrase) as K 
    on P.project_id = K.[KEY]
   END

ELSE IF (@Columns='Project_Description')
   BEGIN
   SELECT * 
        from projects as P inner join
        containstable(PROJECTS, Project_Description, @SearchPhrase) as K 
        on P.project_id = K.[KEY]
   END

ELSE -- (@Columns='All')
   BEGIN
   SELECT * 
        from projects as P inner join
        containstable(PROJECTS, (Title, Project_Details, Contact_Info,     Project_Description), @SearchPhrase) as K 
        on P.project_id = K.[KEY]
   END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T20:21:56.443

您收到此错误是因为您尝试在内联表值函数中使用多个语句。

内联表值函数必须包含单个`SELECT`语句，类似于：

```
CREATE FUNCTION dbo.MyInlineFunction (@MyParam INT)
RETURNS TABLE
AS
RETURN 
(
    SELECT first_column, second_column FROM ...
) 
```

您的函数需要声明为多语句函数，语法类似于：

```
CREATE FUNCTION dbo.MyMultiStatementFunction (@MyParam INT)
RETURNS @MyTable TABLE 
(
    first_column INT, second_column VARCHAR(100)  -- etc
)
AS
BEGIN
    IF (@MyParam = 1)
        INSERT INTO @MyTable (...)
        SELECT ... FROM ...
    ELSE
        INSERT INTO @MyTable (...)
        SELECT ... FROM ...

    RETURN
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T19:00:50.663

首先，您在第一个 IF 上有 == 而不是 =

哦，是的，我注意到在 ELSE 的 CONTAINSTABLE 参数中，您列出了两次 ProjectDetails

如果您正在搜索特定字段，您可以使用以下语法：

```
WHERE Title LIKE '%'+ @Search +'%'
      OR ProjectDetails LIKE '%' + @Search + '%'
      OR ContactInfo LIKE '%' + @Search + '%') 
```

（警告）此语法忽略任何索引。

您可以查看此[博客](http://sqlblogcasts.com/blogs/simons/archive/2008/12/18/LINQ-to-SQL---Enabling-Fulltext-searching.aspx)以获取适用于索引的解决方案。它似乎有一个很好的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T19:05:47.017

查看sql management studio的多语句函数模板ie on menu：View->Template Explorer-Create Multi-Statement Table-valued Function。

问题是多语句函数的语法不同。另请注意，正如 jmein 所说，第一个 if 有一个 ==。

# asp.net - 打开 Windows 身份验证时使用 ajax 调用 Web 服务？

> ID：587309
> 
> 赞同：5
> 
> 时间：2009-02-25T18:49:33.297
> 
> 标签：asp.net, ajax, web-services

我正在尝试从 javascript 调用 Web 服务方法：

```
function Search() {

        var context = new Object;
        context.Filter = "Test";

        SearchService.GetSearch(context, onSuccess, onFailed);
    }

    function onSuccess(result) {
        // userContext contains symbol passed into method
        var res = document.getElementById("resultsDiv");
        res.innerHTML = result;
    }

    function onFailed(result) {
        var res = document.getElementById("resultsDiv");
        res.innerHTML = result.get_message();
    } 
```

这是 Web 服务签名：

```
[WebMethod]
    public SearchComboBoxItemData[] GetSearch(object context)
    { 
```

当我使用表单身份验证并允许匿名访问 Web 服务时，一切正常。

但是，当我对应用程序使用 windows 身份验证，但只允许匿名访问 web 服务时，从 javascript 调用 web 服务会引发以下错误：

无效的 Web 服务调用，缺少参数值：“上下文”。

我注意到的另一件事是它在 Firefox 中都可以正常工作。我在 IE7 上看到错误。

对可能的解决方案有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-22T10:35:29.123

听起来您正在使用集成身份验证，并且 IE 已经登录，但 Firefox 没有。您可能需要检查登录 IE 的用户名。

此外，类似于以下内容：

```
var temp = "";
for(prop in context){
    temp +=prop+"= "+context[prop]+"\n";
}
alert(temp); 
```

查看上下文包含的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T21:53:09.673

我假设您使用的是 ASP.NET Ajax。

您可以尝试添加：

```
preCondition="integratedMode" 
```

属性到 web.config 文件的 Modules 部分。

希望这可以帮助

# xslt - 关于选择节点集的 xpath 问题

> ID：587312
> 
> 赞同：1
> 
> 时间：2009-02-25T18:49:58.600
> 
> 标签：xslt, xpath

这是我的源 xml 文档的简化版本：

```
<eml> 
<additionalMetadata>
    <describes>sbclter.380</describes>
    <access authSystem="knb" order="denyFirst">
      <allow>
        <principal>public</principal>
        <permission>all</permission>
      </allow>
    </access>
  </additionalMetadata>

  <additionalMetadata>
    <describes>sbclter.415</describes>
    <describes>sbclter.380</describes>
      <access authSystem="knb" order="allowFirst">
        <allow>
          <principal>public</principal>
          <permission>all</permission>
        </allow>
      </access>
  </additionalMetadata>

  <additionalMetadata>
        <describes>sbclter.415</describes>
        <access authSystem="knb" order="allowFirst">
            <allow>
              <principal>public</principal>
              <permission>all</permission>
            </allow>
          </access>
    </additionalMetadata>
 <eml> 
```

我想选择元素“描述”的节点集 - 它的值显示在多个附加元数据块中，并且它的“访问”兄弟有不同的顺序：“denyFirst”和“allowFirst”。

在上面的示例中，值为 sbclter.380 的“描述”就是这种情况。由于它显示在两个附加元数据块中，第一个在访问兄弟中具有“denyFirst”，但第二个在访问兄弟中具有“allowFirst”。sbclter.415 不会是这样。因为它出现在两个附加元数据块中，但两个访问兄弟在属性“order”处具有相同的值“allowFirst”。

改造后，我想得到：

```
<eml> 
    <additionalMetadata>
        <describes>sbclter.380</describes>
        <access authSystem="knb" order="denyFirst">
          <allow>
            <principal>public</principal>
            <permission>all</permission>
          </allow>
        </access>
      </additionalMetadata>

      <additionalMetadata>
        <describes>sbclter.380</describes>
          <access authSystem="knb" order="allowFirst">
            <allow>
              <principal>public</principal>
              <permission>all</permission>
            </allow>
          </access>
      </additionalMetadata>

      <additionalMetadata>
            <access authSystem="knb" order="allowFirst">
                <allow>
                  <principal>public</principal>
                  <permission>all</permission>
                </allow>
              </access>
        </additionalMetadata>
     <eml> 
```

这是我的节点：

```
 <xsl:for-each select="/*/*">
        <xsl:choose>
           <xsl:when test="name()='additionalMetadata'">
            <xsl:call-template name="handle-describe-access-in-additional-metadata">
                <xsl:with-param name="describes-list" select="./describes[//additionalMetadata[describes = . and access[@order='allowFirst']] and //additionalMetadata[describes = . and access[@order='denyFirst']]]"
          ></xsl:with-param>
              ></xsl:with-param>
            </xsl:call-template>
          </xsl:when>
        </xsl:choose>
      </xsl:for-each> 
```

但是，它不起作用。"xsl:with-param" 中的 xpath 什么也没找到——没有 sbclter.415 也没有 sbclter.380。你有什么建议吗？太感谢了！

注意：这是代码的简化版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T19:44:07.127

**这是产生所需结果的一种转换**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes"/>
<!--                                                --> 
 <xsl:key name="kDescrByVal" match="describes"
  use="."/>
<!--                                                --> 
    <xsl:template match="node()|@*" name="identity">
      <xsl:copy>
         <xsl:apply-templates select="node()|@*"/>
      </xsl:copy>
    </xsl:template>
<!--                                                --> 
    <xsl:template match="describes">
      <xsl:if test=
       "count(key('kDescrByVal', .)) > 1
       and
        following-sibling::access/@order
       !=
        key('kDescrByVal', .)/following-sibling::access/@order
       ">
       <xsl:call-template name="identity"/>
      </xsl:if>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于提供的 XML 文档时（更正为格式正确）：**

```
<eml>
    <additionalMetadata>
        <describes>sbclter.380</describes>
        <access authSystem="knb" order="denyFirst">
            <allow>
                <principal>public</principal>
                <permission>all</permission>
            </allow>
        </access>
    </additionalMetadata>
    <additionalMetadata>
        <describes>sbclter.415</describes>
        <describes>sbclter.380</describes>
        <access authSystem="knb" order="allowFirst">
            <allow>
                <principal>public</principal>
                <permission>all</permission>
            </allow>
        </access>
    </additionalMetadata>
    <additionalMetadata>
        <describes>sbclter.415</describes>
        <access authSystem="knb" order="allowFirst">
            <allow>
                <principal>public</principal>
                <permission>all</permission>
            </allow>
        </access>
    </additionalMetadata>
</eml> 
```

**产生了想要的结果**：

```
<eml>
    <additionalMetadata>
        <describes>sbclter.380</describes>
        <access authSystem="knb" order="denyFirst">
            <allow>
                <principal>public</principal>
                <permission>all</permission>
            </allow>
        </access>
    </additionalMetadata>
    <additionalMetadata>

        <describes>sbclter.380</describes>
        <access authSystem="knb" order="allowFirst">
            <allow>
                <principal>public</principal>
                <permission>all</permission>
            </allow>
        </access>
    </additionalMetadata>
    <additionalMetadata>

        <access authSystem="knb" order="allowFirst">
            <allow>
                <principal>public</principal>
                <permission>all</permission>
            </allow>
        </access>
    </additionalMetadata>
</eml> 
```

**请注意使用**：

1.  钥匙。

2.  Xpath`"!="`运算符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T19:45:08.450

详细说明我在对您的回答的评论中所说的话，这里有一个例子来说明我的意思：

使用此 XML 文件作为源，

```
<Header>
  <thing>
    <child>5</child>
  </thing>
  <thing>
    <child>6</child>
  </thing>
  <thing>
    <child>7</child>
  </thing>
  <thang>
    <children>5</children>
  </thang>
</Header> 
```

使用此 XSLT 文件：

```
<xsl:template match="/Header">
    <xsl:value-of select="./thing[//thang[children = ./child]]"/>
</xsl:template> 
```

如果在此示例中`.`引用`thing`，则输出将为`5`，但由于 。指的是`thang`，没有输出。如果有一个包含 的变量`thing`，那么它将起作用：

```
 <xsl:template match="/Header">
    <xsl:variable name="thing" select="./thing"/>
    <xsl:value-of select="./thing[//thang[children = $thing/child]]"/>
  </xsl:template> 
```

你处于同样的情况。你`.`引用的东西不是你认为的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T19:09:36.693

我会尝试创建当前描述节点的变量并使用它而不是`.`在您的 XPath 子表达式中引用。

因为，例如，在语句`[//additionalMetadata[describes = .`中，`.`引用的是附加元数据节点，而不是描述节点。

# java - 在哪里可以找到 JDK 中的本机代码？

> ID：587317
> 
> 赞同：12
> 
> 时间：2009-02-25T18:52:10.357
> 
> 标签：java

我正在查看 FileInputStream 的 Java 代码，并对 open 和 close 方法的作用感兴趣。这些功能或其中的一部分是本机实现的。你知道我在哪里可以找到这个代码吗？此代码是 JDK 开源许可证的一部分吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-25T19:04:30.233

```
http://java.sun.com/j2se/1.5.0/source_license.html
http://download.java.net/jdk6/source/
http://openjdk.java.net/
http://www.gnu.org/software/classpath/

```

这是 FileInputStream 代码的链接......还有特定于 Windows 的代码，并且可能是其他平台的相应目录中的代码。

[http://hg.openjdk.java.net/jdk8/jdk8/jdk/file/0a5b87833562/src/share/native/java/io/FileInputStream.c](http://hg.openjdk.java.net/jdk8/jdk8/jdk/file/0a5b87833562/src/share/native/java/io/FileInputStream.c)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T19:00:35.517

[OpenJDK](http://openjdk.java.net/)应该包含您搜索的所有内容，例如[Java 7 mercurial (hg) 存储库](http://hg.openjdk.java.net/jdk7/jdk7)。包含 2 月 21 日所有内容的[zip 文件](http://www.java.net/download/openjdk/jdk7/promoted/b48/openjdk-7-ea-src-b48-19_feb_2009.zip)也可用。

如果您不想要来自 Java 7 的全新开发人员的东西，那么众所周知的 Java 6 也应有尽有。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T19:06:33.100

Sun 源代码可从[java.net](https://jdk6.dev.java.net/)获得。

对于文件输入流，`j2se/src/share/native/java/io/FileInputStream.c`. 如果替换`native`为`windows`,`solaris`或者`linux`在这些目录中会有特定于平台的代码。JDK7 的结构略有不同。

# jquery - jQuery 水平手风琴 CSS

> ID：587329
> 
> 赞同：1
> 
> 时间：2009-02-25T18:55:06.793
> 
> 标签：jquery, css, accordion

我正在尝试在 Jquery 中构建一个简单的多级 UL 水平手风琴（或幻灯片菜单）。Hunter Daley 慷慨地提供了 Jquery 代码，但我似乎无法弄清楚 css。我知道这是新手，但我真的被困住了。

当 Ul li Ul 滑出时，它会创建一个换行符，我希望所有内容都内联显示，没有中断。我试过空格：nowrap，显示内联等它似乎不会这样做。有任何想法吗？

根据 Glavic 的回答：我试图使用浮点数，但如果我在动画期间执行 Safari 错误并刷新子级别 UL：

**使用浮点数：**

对，我试图在没有花车的情况下做到这一点。我试图坚持使用动画功能。

Safari 在动画期间出现错误并闪烁 sub ul。

```
<style type="text/css">
<!--
body {
  font-size: 1em;
  line-height: 1em;
}
ul {
  background-color: yellow;
  list-style: none;
  margin: 0;
  padding: 0;
  height: 1em;
  float: left;
}
ul li {
  background-color: aqua;
  float: left;
}
ul li ul {
  background-color: blue;
}
ul li ul li {
  background-color: green;
}
a, a:link, a:hover, a:visited, a:active {
  color: black;
  text-decoration: none;
  float: left;
}
-->
</style> 
```

**原帖：**

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>

    <title>untitled</title>
       <style type="text/css">
    <!--
    ul{ 
        list-style: none;
        background-color: yellow;
        margin: 0;
        padding: 0;
                white-space: nowrap;
            }

    ul li {
        background-color: aqua;
        display: inline;

    }

    ul li ul { 
        background-color: blue;
              }

    ul li ul li {
        background-color: green;    
    }

    a, a:link, a:hover, a:visited, a:active {
            color: black;
            text-decoration: none;

    }
    -->
    </style>

    <script type="text/javascript">
           var $current = null;
        $(document).ready(function(){
           $("ul li ul").hide(); // hide submenus by default on load

           $("ul li a").click(function(){
              var $sub = $(this).next(); 
              if ($sub.css("display") == "none")
              {
                 if ($current != null)
                    $current.animate({ width: 'hide' }); // if you want to only show one sub at a time
                 $sub.animate({ width: 'show' }); 
                 $current = $sub;
              }
              else
              {
                 $sub.animate({ width: 'hide' });
                 $current = null;
              }
           });
        });

    </script>

</head>

<body>
    <ul>
            <li>
                    <a href="#">Top-level 1</a>
            </li>
            <li>
                    <a href="#">Top-level 2</a>

                    <ul>
                            <li><a href="#">Bottom Level A1</a></li>
                            <li><a href="#">Bottom Level A2</a></li>
                            <li><a href="#">Bottom Level A3</a></li>
                            <li><a href="#">Bottom Level A4</a></li>
                    </ul>
            </li>

            <li>
                    <a href="#">Top-level 3</a>
                    <ul>
                            <li><a href="#">Bottom Level B1</a></li>
                            <li><a href="#">Bottom Level B2</a></li>
                    </ul>
            </li>

            <li>
                    <a href="#">Top-level 4</a>
            </li>
    </ul>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T19:08:45.060

如果我对您的理解正确，您希望在一行中拥有第一级和第二级菜单（水平）？

试试这个：

```
<style type="text/css">
    ul{
        list-style: none;
        background-color: yellow;
        margin: 0;
        padding: 0;
        float: left;
    }
    ul li {
        background-color: aqua;
        float: left;
    }
    ul li ul {
        background-color: blue;
    }
    ul li ul li {
        background-color: green;
    }
    a, a:link, a:hover, a:visited, a:active {
        color: black;
        text-decoration: none;
        float: left;
    }
</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T19:36:43.680

我认为“显示：内联”可以解决问题 - 但动画功能将显示设置为“块”而不是“内联”。

如果可以“捕捉”到位而不是动画，则可以改为执行此操作。

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>

    <title>untitled</title>
    <style type="text/css">
        ul{list-style:none;background-color:yellow;margin:0;padding:0;white-space:nowrap;display:inline;}
        li ul{display:inline;}
        ul li{background-color:aqua;display:inline;}
        ul li ul{background-color: blue;}
        ul li ul li{background-color: green;}
        a, a:link, a:hover, a:visited, a:active{color: black;text-decoration: none;}
    </style>

    <script type="text/javascript">
        var $current = null;
        $(document).ready(function() {
            $("ul li ul").hide(); // hide submenus by default on load

            $("ul li a").click(function() {
                var $sub = $(this).next();
                if ($sub.css("display") == "none") {
                    if ($current != null)
                        //$current.animate({ width: 'hide' }); // if you want to only show one sub at a time
                    $current.removeAttr("display").attr({ style: "display:none;" });
                    $sub.removeAttr("style").attr({ display: "inline" });
                    $current = $sub;
                }
                else {
                    $sub.removeAttr("display").attr({ style: "display:none;" });
                    $current = null;
                }
            });
        });
    </script>
</head>

<body>
    <ul>
            <li>
                    <a href="#">Top-level 1</a>
            </li>
            <li>
                    <a href="#">Top-level 2</a>

                    <ul>
                            <li><a href="#">Bottom Level A1</a></li>
                            <li><a href="#">Bottom Level A2</a></li>
                            <li><a href="#">Bottom Level A3</a></li>
                            <li><a href="#">Bottom Level A4</a></li>
                    </ul>
            </li>

            <li>
                    <a href="#">Top-level 3</a>
                    <ul>
                            <li><a href="#">Bottom Level B1</a></li>
                            <li><a href="#">Bottom Level B2</a></li>
                    </ul>
            </li>

            <li>
                    <a href="#">Top-level 4</a>
            </li>
    </ul>

</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T20:33:33.357

建立自己很有趣。使用这种令人敬畏的东西也很有趣：http: [//jqueryui.com/demos/accordion/](http://jqueryui.com/demos/accordion/)

# jquery - 邮政 带有操作链接的值（asp.net MVC JQuery）

> ID：587339
> 
> 赞同：1
> 
> 时间：2009-02-25T18:59:22.977
> 
> 标签：jquery, asp.net-mvc, drop-down-menu, dynamic-data

我的 MVC 视图页面上有一个。当所选索引更改时，我使用 JQuery 过滤网格。

在页面底部，我有一个操作链接。我想将此值发布到操作链接指向的控制器。

问题是，显然盒子的价值是可以改变的。

如何使用操作链接发布动态变化的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T19:11:45.100

我想我会做的是使用表单而不是操作链接。然后，您的 jQuery 将更新表单内与查询参数相对应的一些隐藏字段。然后，您的“链接”（可能是一个按钮）将有一个提交表单的 onclick 处理程序。如果您关心 url - 我可以看到您可能在哪里 - 只需使用正确的路由参数将您的控制器操作重定向到自身。

或者，您可以在选择更改时构造和替换 ActionLink 上的 href。这将涉及在视图中维护代码，以了解您的路线是如何构建的。

注意：下面的示例可能会更好地使用包裹在下拉列表本身的表单并简单地在选择更改时提交，但模式是我感兴趣的描述。

```
 <script type="text/javascript">
     $(document).ready( function() {
         $('#formLink').click( function() {
            $(this).parent('form').submit();
            return false;
         });
         $('#PageSizeMenu').change( function() {
             $('#PageSize').val( $(this).val() );
         })
     });
 </script>

 <%= Html.DropDownList("PageSizeMenu", ... ) %>
 <% using (Html.BeginForm( "List" )) { %>
    <a id="formLink" href="some-reasonable-link-for-non-javascript">Go</a>
    <%= Html.Hidden("PageSize") %>
 <% } %> 
```

# language-agnostic - 良好的命名空间命名约定

> ID：587341
> 
> 赞同：3
> 
> 时间：2009-02-25T18:59:42.193
> 
> 标签：language-agnostic, namespaces, theory

我正在为 CRUD 业务应用程序创建一个类库。业务对象（以及相关的数据访问层对象）的主要“类别”是：

*   维护（用于处理数据库中的主表（主列表）
*   事件（大多数对象与现实世界的事件有关）
*   搜索（明显）

截至目前，我的命名空间设置如下：

*   BusinessObjects.Maintenance.Contacts
*   BusinessObjects.Maintenance.Products
*   BusinessObjects.Maintenance.Classifications
*   .
*   BusinessObjects.Incidents.Contacts
*   业务对象.事件.产品
*   业务对象.事件.分类
*   .
*   BusinessObjects.Search.Contacts
*   BusinessObjects.Search.Products
*   BusinessObjects.Search.Classifications
*   .
*   Dal.Maintenance.Contacts
*   Dal.Maintenance.Products
*   Dal.维护.分类
*   .
*   Dal.Incidents.Contacts
*   Dal.事件.产品
*   达尔事件分类
*   .
*   Dal.Search.Contacts
*   Dal.Search.产品

请注意，每个类都以相同的名称结束。

**这是好形式吗？**

**此命名空间约定是否会引起任何问题？对查看/使用此代码的其他人有任何可能的混淆吗？**

我确实意识到，在表单代码中，一个缺点是我必须使用名称空间限定所有对象。对我来说，这没什么大不了的。如果那是一个词，我通常更喜欢一点明确性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T21:56:34.873

反正我觉得没问题。不过，我会远离缩写词，这会让人感到困惑并迫使人们必须知道缩写词或查找它们。它们也变得不可读和不可言说。

```
"Lets take a look at the BusObjConfIntContYYYYmmdd package now..." 
```

您可能会遇到的一个问题是名称有细微的差别。由于名字的长度可能是一个问题，你的眼睛可能会掩盖整个事情，只看到其中的一部分。会不会有这样的情况发生？：

```
BusinessObjects.Incidents.Classifications
BusinessObjects.Classifications.Incidents 
```

或者

```
BusinessObjects.Forms.ProjectManager.Exportable.Windows.XP
BusinessObjects.Forms.ProductManager.Exportable.Windows.XP 
```

这个人为的例子可能会成为一个问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T22:46:58.060

通常最好不要以实现的任何特定模式命名您的包，而是以它们所属的业务或功能域命名。

IE：

```
Org.MyCompany.BusinessObjects.Maintenance.Contacts
Org.MyCompany.BusinessObjects.Incidents.Contacts
Org.MyCompany.BusinessObjects.Search.Contacts 
```

反而：

```
Org.MyCompany.Contacts 
```

其中将包含对“联系人”执行操作的类/接口/对象/任何内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T19:54:30.080

我认为该项目将受益于一些缩写。当我过去遇到这样的问题时，我通常会花一些文档来解释一些用作命名空间的缩写。我通常将这些缩短的名称限制为 3-5 个字符。这不仅增加了表单代码中的一般代码可读性，而且我还发现较短的名称可以减少其他编码人员的混淆。

我希望这会有所帮助。归根结底，这真的取决于您团队的偏好......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T22:02:29.913

在经历了很多之后，我们尝试保持命名空间的数量很少（对于一个非常大的项目来说少于几十个），并且命名空间的深度很短（少于 5 个左右）。从消费的角度来看（开发人员使用我们的代码库），必须跟踪大量名称空间中的类很少，这是一种开销，几乎没有什么好处。

我们还根据使用情况将like 与like 分组。如果开发人员很可能总是将某些类与其他类一起使用，即使（在您的示例中）一个可能与维护相关而另一个不相关，如果它们在逻辑上、操作上或程序上相关，我们将它们放在同一个命名空间中. 使用提供者模型将独立的功能（例如，特定于维护的逻辑）分解到另一个命名空间中。由于开发人员不太可能需要修改提供程序包含的功能，因此它位于更深、独立的命名空间中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T22:40:18.733

您的命名空间层次结构看起来类似于称为嵌套泛化的条件。这是当您拥有派生多种不同方式的类时。

想象一个类层次结构如下：

```
class Vehicle 

class Car : Vehicle
class CarRed : Car 
class CarBlue : Car 

class Truck : Vehicle 
class TruckRed : Truck 
class TruckBlue : Truck 
```

请注意，车辆可以是轿车或卡车。此外，车辆可以是红色或蓝色。这工作得非常好，但是当您想要添加新颜色或车辆类型时会出现问题，因为修改的负担会以二次方增长。

GOF 设计模式一书描述了这个问题——特别是桥接模式。

尽管它没有具体解决有关名称空间的问题，但我的直觉告诉我情况是相似的。我想说，如果你能避免这种情况，那么你应该这样做。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-07T08:47:55.243

另请查看此 MSDN 文章以获取命名空间的指南

> 命名空间的名称：http: [//msdn.microsoft.com/en-us/library/ms229026.aspx](http://msdn.microsoft.com/en-us/library/ms229026.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T22:13:53.257

我每个库使用一个命名空间，每个可执行源代码集使用一个命名空间。名字总是很短。例如，在我目前正在处理的可执行文件中，我有：

*   ALib - 我的通用实用程序库
*   Mongo - 我的迷你 Web 服务器库
*   DBLite - 我的 SQLite3 包装器和简单的持久层
*   Track1 - 可执行文件（实际上是几个可执行文件）

这似乎工作得很好。我发现应该避免非常复杂的命名空间方案，就像非常复杂、深层次的类层次结构一样。

# python - 匹配多行文本块的正则表达式

> ID：587345
> 
> 赞同：131
> 
> 时间：2009-02-25T19:00:49.697
> 
> 标签：python, regex, multiline

在匹配跨多行的文本时，我在让 Python 正则表达式工作时遇到了一些麻烦。示例文本是（'\n' 是换行符）

```
some Varying TEXT\n
\n
DSJFKDAFJKDAFJDSAKFJADSFLKDLAFKDSAF\n
[more of the above, ending with a newline]\n
[yep, there is a variable number of lines here]\n
\n
(repeat the above a few hundred times). 
```

我想捕获两件事：“some_Varying_TEXT”部分，以及一次捕获中位于其下方两行的所有大写文本行（我可以稍后去掉换行符）。我尝试了几种方法：

```
re.compile(r"^>(\w+)$$([.$]+)^$", re.MULTILINE) # try to capture both parts
re.compile(r"(^[^>][\w\s]+)$", re.MULTILINE|re.DOTALL) # just textlines 
```

以及许多没有运气的变化。最后一个似乎与文本的行一一匹配，这不是我真正想要的。我可以捕捉第一部分，没问题，但我似乎无法捕捉 4-5 行大写文本。我希望 match.group(1) 成为 some_Varying_Text 和 group(2) 成为 line1+line2+line3+etc 直到遇到空行。

如果有人好奇，它应该是构成蛋白质的氨基酸序列。

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2009-02-25T20:06:01.973

试试这个：

```
re.compile(r"^(.+)\n((?:\n.+)+)", re.MULTILINE) 
```

我认为您最大的问题是您希望`^`and`$`锚点匹配换行符，但事实并非如此。在多行模式下，`^`匹配紧跟*在*换行符之后的位置并`$`匹配紧接*在*换行符之前的位置。

还要注意，换行符可以由换行符 ( `\n`)、回车符 ( `\r`) 或回车符+换行符 ( `\r\n`) 组成。如果您不确定您的目标文本是否只使用换行符，您应该使用这个更具包容性的正则表达式版本：

```
re.compile(r"^(.+)(?:\n|\r\n?)((?:(?:\n|\r\n?).+)+)", re.MULTILINE) 
```

顺便说一句，您不想在这里使用 DOTALL 修饰符；您依赖于点匹配*除*换行符之外的所有内容这一事实。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-02-25T19:47:22.970

这将起作用：

```
>>> import re
>>> rx_sequence=re.compile(r"^(.+?)\n\n((?:[A-Z]+\n)+)",re.MULTILINE)
>>> rx_blanks=re.compile(r"\W+") # to remove blanks and newlines
>>> text="""Some varying text1
...
... AAABBBBBBCCCCCCDDDDDDD
... EEEEEEEFFFFFFFFGGGGGGG
... HHHHHHIIIIIJJJJJJJKKKK
...
... Some varying text 2
...
... LLLLLMMMMMMNNNNNNNOOOO
... PPPPPPPQQQQQQRRRRRRSSS
... TTTTTUUUUUVVVVVVWWWWWW
... """
>>> for match in rx_sequence.finditer(text):
...   title, sequence = match.groups()
...   title = title.strip()
...   sequence = rx_blanks.sub("",sequence)
...   print "Title:",title
...   print "Sequence:",sequence
...   print
...
Title: Some varying text1
Sequence: AAABBBBBBCCCCCCDDDDDDDEEEEEEEFFFFFFFFGGGGGGGHHHHHHIIIIIJJJJJJJKKKK

Title: Some varying text 2
Sequence: LLLLLMMMMMMNNNNNNNOOOOPPPPPPPQQQQQQRRRRRRSSSTTTTTUUUUUVVVVVVWWWWWW 
```

* * *

关于这个正则表达式的一些解释可能有用：`^(.+?)\n\n((?:[A-Z]+\n)+)`

*   第一个字符 ( `^`) 表示“从行首开始”。请注意，它与换行符本身不匹配（对于 $: 它表示“就在换行符之前”，但它与换行符本身不匹配）。
*   然后`(.+?)\n\n`表示“匹配尽可能少的字符（允许所有字符），直到达到两个换行符”。结果（没有换行符）放在第一组中。
*   `[A-Z]+\n`意思是“匹配尽可能多的大写字母，直到你到达换行符。这定义了我将称之为*textline*的内容。
*   `((?:`*textline*`)+)`表示匹配一个或多个*文本*行，但不要将每一行放在一个组中。相反，将**所有***文本行*放在一组中。
*   `\n`如果要在末尾强制使用双换行符，可以在正则表达式中添加 final 。
*   此外，如果您不确定将获得哪种类型的换行符（`\n`或`\r`或），那么只需通过替换每个出现的by`\r\n`来修复正则表达式。`\n``(?:\n|\r\n?)`

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2018-09-15T18:57:56.147

以下是匹配多行文本块的正则表达式：

```
import re
result = re.findall('(startText)(.+)((?:\n.+)+)(endText)',input) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-25T20:59:59.067

如果每个文件只有一个氨基酸序列，我根本不会使用正则表达式。就像这样：

```
def read_amino_acid_sequence(path):
    with open(path) as sequence_file:
        title = sequence_file.readline() # read 1st line
        aminoacid_sequence = sequence_file.read() # read the rest

    # some cleanup, if necessary
    title = title.strip() # remove trailing white spaces and newline
    aminoacid_sequence = aminoacid_sequence.replace(" ","").replace("\n","")
    return title, aminoacid_sequence 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-25T19:11:53.943

寻找：

```
^>([^\n\r]+)[\n\r]([A-Z\n\r]+) 
```

\1 = some_variing_text

\2 = 所有大写字母的行

**编辑（证明这有效）：**

```
text = """> some_Varying_TEXT

DSJFKDAFJKDAFJDSAKFJADSFLKDLAFKDSAF
GATACAACATAGGATACA
GGGGGAAAAAAAATTTTTTTTT
CCCCAAAA

> some_Varying_TEXT2

DJASDFHKJFHKSDHF
HHASGDFTERYTERE
GAGAGAGAGAG
PPPPPAAAAAAAAAAAAAAAP
"""

import re

regex = re.compile(r'^>([^\n\r]+)[\n\r]([A-Z\n\r]+)', re.MULTILINE)
matches = [m.groups() for m in regex.finditer(text)]

for m in matches:
    print 'Name: %s\nSequence:%s' % (m[0], m[1]) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T20:58:28.837

我的偏好。

```
lineIter= iter(aFile)
for line in lineIter:
    if line.startswith( ">" ):
         someVaryingText= line
         break
assert len( lineIter.next().strip() ) == 0
acids= []
for line in lineIter:
    if len(line.strip()) == 0:
        break
    acids.append( line ) 
```

此时，您将 someVaryingText 作为字符串，将酸作为字符串列表。你可以做`"".join( acids )`一个单一的字符串。

我发现这比多行正则表达式不那么令人沮丧（而且更灵活）。

# c - 在 C 中使用位域的正确方法是什么？

> ID：587348
> 
> 赞同：8
> 
> 时间：2009-02-25T19:01:14.530
> 
> 标签：c, bit-fields, unions

我正在使用位域来轻松访问我正在尝试为没有 FPU 的微控制器制作的浮点库。

问题是我似乎无法使其与位域一起使用。看一看：

```
typedef struct
{
   union{
    unsigned long mantissa: 23;
    unsigned long exponent: 8;
    unsigned long sign: 1;
    float all;

      };

}_float __attribute__((__packed__)); 
```

问题是，当我尝试访问或更改任何内容时，它会将位域分别视为从末尾开始的 1、8、23 位。虽然它应该是从末尾开始的 23 位，然后是 8 位，然后是最后一位。除非我完全误解了位域的使用。我认为使用**打包**可以解决问题，但正如您所见，它没有。

任何帮助将非常感激。我不止一次在谷歌搜索时被引导到这个网站，所以我寄予厚望。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-25T19:05:15.223

您可能在工会中缺少一个结构。

```
typedef struct
{
    union{
       struct {
           unsigned long mantissa: 23;
           unsigned long exponent: 8;
           unsigned long sign: 1;
       } float_parts;
       float all;
    };
}_float __attribute__((__packed__)); 
```

请注意，尾数/指数和符号的顺序取决于 CPU 的字节序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T19:05:42.337

问题是它是一个工会。它应该是“结构”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T21:39:45.273

如果您在 glibc 平台上，您可以查看 ieee754.h 头文件。它关心字节序的东西。如果没有，它仍然可能值得一看。

# windows - Windows的桌面闪存日志查看器？

> ID：587349
> 
> 赞同：0
> 
> 时间：2009-02-25T19:01:19.210
> 
> 标签：windows, flash, logging

我想知道是否有人知道会在更新时实时显示 Flash 日志的应用程序，我在 VB 中制作了一个简单的应用程序，它是一个 Web 浏览器控件，它映射到我的 flashlog.txt 的位置，但我总是必须点击F5 并且由于某种原因最近它已经停止工作......所以，有人知道一个运行良好的 Windows 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T19:14:38.883

我使用免费的[BareTail](http://www.baremetalsoft.com/baretail/)应用程序来监控日志文件。您可以将其指向 flashlog.txt 并观看它。

请务必查看“突出显示”功能 - 它会自动突出显示与可自定义模式匹配的行，这使得在日志文件中找到那些感兴趣的行变得非常容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T01:54:30.620

也许检查您是否拥有[播放器的调试版本，](http://www.adobe.com/support/flashplayer/downloads.html)并以调试模式导出 swf。

这可能与上下文无关，因为您可能有特定的原因来跟踪 flashlog.txt。但是，如果您想简单地监控您的 SWF 活动，那么有很多可能性，这里有一些：

**Firebug** - 在 FireFox 中

[https://addons.mozilla.org/en-US/firefox/addon/1843](https://addons.mozilla.org/en-US/firefox/addon/1843)

例子 ：`ExternalInterface.call("console.log", "Hello");`

**ThunderBolt** - 外部空气应用程序

[http://code.google.com/p/flash-thunderbolt/](http://code.google.com/p/flash-thunderbolt/)

例子 ：`Logger.error("Hello");`

**FDB（随 FLEX SDK 提供）** - 终端

[教程](http://installingcats.com/2007/12/07/how-to-use-command-line-debugger-fdb-to-debug-flex-flash-on-mac-os-x/)

例子 ：`trace("Hello");`

# javascript - 如何获得 WCF Ajax 服务的智能感知？

> ID：587350
> 
> 赞同：3
> 
> 时间：2009-02-25T19:02:06.197
> 
> 标签：javascript, ajax, visual-studio-2008, wcf, intellisense

通过将补丁 KB958502 应用于 Visual Studio 2008 并包括以下行，我终于让 Intellisense 为 JQuery 工作：

```
/// <reference path="JQuery\jquery-1.3.2.js"/> 
```

在我的 .js 文件的顶部。现在我试图弄清楚如何为 ScriptManager 的 ScriptReference 元素生成的客户端代理获取 JavaScript 智能感知（如下所示）：

```
 <asp:ScriptManager ID="ScriptManager1" runat="Server" EnablePartialRendering="false" AsyncPostBackTimeout="999999">
        <Services>
            <asp:ServiceReference path="../Services/DocLookups.svc" />
        </Services>
    </asp:ScriptManager> 
```

客户端代理正在工作——即我可以通过它们拨打电话，但我没有得到智能感知。

我的服务是用 .svc 文件定义的：

```
<%@ ServiceHost Language="C#" Debug="true" Service="Documents.Services.DocLookups" CodeBehind="~/App_Code/DocLookups.cs" %> 
```

文件后面的代码如下所示：

```
[ServiceContract(Namespace = "Documents.Services", Name = "DocLookups")]
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
[ServiceBehavior(IncludeExceptionDetailInFaults = true)]
public class DocLookups {
... 
```

此类中的示例方法是：

```
 //Called at the begining of the page to fill in the category list
    [OperationContract]
    public SelectOption[] GetCategoriesForSelectList()
    {
        SelectOption[] Result;
        IDocumentRepository repository = new DocumentEntityRepository(ConnectionString);
        Result = (from cat in repository.GetDocCategories()
                  select new SelectOption(cat.Category_ID.ToString(), cat.CategoryName)).ToArray();
        if (Result.Length > 0)
            Result[0].Selected = true;  //Select first item 
        return Result;
    } 
```

它使用如下定义的数据合约：

```
namespace Documents.Services {

[DataContract]
public class SelectOption
{
    //A useful DTO to use when filling a <select> element with options
    public SelectOption(string optionValue, string optionText) {
        OptionValue = optionValue;
        OptionText = optionText;
        Selected = false;
    }
    public SelectOption(string optionValue, string optionText, bool selected) {
        OptionValue = optionValue;
        OptionText = optionText;
        Selected = selected;
    }

    [DataMember]
    public string OptionValue { get; set; }
    [DataMember]
    public string OptionText { get; set; }
    [DataMember]
    public bool Selected { get; set; }
} 
```

}

在我的 javascript 文件中，对该服务的调用如下所示：

```
Documents.Services.DocLookups.GetCategoriesForSelectList(... 
```

但我没有得到 Intellisense（例如，如果我键入 Documents。没有弹出）。对于生成的方法或方法使用的 [DataContract] 类型，我都没有获得智能感知。

我相信我**应该**为这些代理和类型获得 Intellisense，但无法弄清楚我可能做错了什么。TIA。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T06:01:54.800

没有 `/// <reference path="../Services/DocLookups.svc" />` 工作？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T17:31:31.727

感谢 Scott 指出我需要添加

```
///<reference path... 
```

线。我不知道它在哪里记录，但我不知何故错过了这是 WCF 生成的客户端代理所必需的——尽管现在它是有意义的，因为使用相同的习语来获取 JQuery 的 Intellisense。

作为记录，我最终不得不使用的线路与斯科特根据我的项目结构提出的建议略有不同。我试过：

```
/// <reference path="../Documents/Services/DocLookups.svc" /> 
```

然后我保存了文件并从 VS Edit 菜单中选择了**Intellisense** ... **Update JScript Intellisense** ...

不幸的是，这不起作用，更新 Intellisense 时出现以下错误：

```
Error updating JScript IntelliSense: 
C:\TFSSource\LitigationPortal\Version 1.0\LitigationPortal\Documents\Services\DocLookups.svc:
'Type' is undefined @ 0:0 
```

所以我已经取得了一些进展，但我还没有完全做到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T17:07:29.937

我遇到了同样的问题，发现有一个适用于 Visual Studio 2008 的修补程序可以解决我的问题：

[http://support.microsoft.com/kb/958502](http://support.microsoft.com/kb/958502)

# c# - 如何从 Collection 中检索第一个项目？

> ID：587351
> 
> 赞同：6
> 
> 时间：2009-02-25T19:02:36.710
> 
> 标签：c#, collections, c#-3.0

我不知道如何从这个集合中检索第一个项目：

```
IGrouping<string, Plantilla> groupCast = group as System.Linq.IGrouping<string, Plantilla>; 
```

我也试过：

```
IGrouping<string, Plantilla> firstFromGroup = groupCast.FirstOrDefault(); 
```

但不起作用的原因和显式转换已经存在

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-25T19:07:51.910

为什么不直接使用`var`？

```
var firstFromGroup = group.First(); 
```

至于您收到错误的原因，我猜 Key 或 Element 与您认为的不同。查看错误消息的其余部分，了解编译器抱怨的类型。请注意，如果涉及匿名类型，则获取它的唯一方法是使用`var`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T19:46:37.497

试试这个（基于你的部分解决方案）：

```
foreach (var group in dlstPlantillas.SelectedItems)
{
    var groupCast = groupCast = group as System.Linq.IGrouping<string, Plantilla>
    if(groupCast == null) return;

    item = groupCast.FirstOrDefault<Plantilla>();  
    if(item == null) return;

    // do stuff with item
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T19:23:35.413

这是我的部分解决方案：

```
foreach (var group in dlstPlantillas.SelectedItems)
                {
                    IGrouping<string, Plantilla> groupCast = group as System.Linq.IGrouping<string, Plantilla>;

                    if (null == groupCast) return;
                    foreach (Plantilla item in groupCast.Take<Plantilla>(1)) //works for me
                    {
                        template.codigoestudio = item.codigoestudio;
                        template.codigoequipo = item.codigoequipo;
                        template.codigoplantilla = item.codigoplantilla;
                        template.conclusion = item.conclusion;
                        template.hallazgo = item.hallazgo;
                        template.nombreequipo = item.nombreequipo;
                        template.nombreexamen = item.nombreexamen;
                        template.tecnica = item.tecnica;
                    }
                } 
```

# local - J2ME 移动词典的本地数据库

> ID：587352
> 
> 赞同：0
> 
> 时间：2009-02-25T19:03:24.213
> 
> 标签：local, embedded-database

我现在正在为我的最后一年项目开发一个用于手机的英语到阿拉伯语短语翻译器。我正在使用 Eclipse (J2ME) IDE。但是，我的项目的要求之一是使用本地数据库。我想我会使用 MySQL，因为我以前使用过它。但是这个应用程序还必须与服务器连接。因此，我不知道什么数据库适合这个项目的 J2ME（不包括 RDMS）。任何人都可以提供建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T19:12:02.447

您正在寻找的是所谓的“嵌入式”数据库。基本上，它是您通过库访问的数据库，它没有单独的服务器组件。SQLLite 和 MySQL Embedded 就是两个例子。由于您使用的是 Java，因此您可能想研究一下 Apache Derby，我相信它随 JDK 6 一起提供。

# java - Java 中的 Rijndael 支持

> ID：587357
> 
> 赞同：16
> 
> 时间：2009-02-25T19:05:06.410
> 
> 标签：java, cryptography, rijndael

我们需要用 Java 进行一些 Rijndael 开发。

对我们有帮助的文章、图书馆等有什么建议吗？

任何指向密钥库维护以及如何安全存储密钥的指针？

编辑：

它需要是开源的。本质上，它只是使用 Rijndael 对数据进行标准加密/解密。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-19T21:51:11.690

Java 包括开箱即用的 AES。Rijndael 是 AES。您不需要任何外部库。你只需要这样的东西：

```
byte[] sessionKey = null; //Where you get this from is beyond the scope of this post
byte[] iv = null ; //Ditto
byte[] plaintext = null; //Whatever you want to encrypt/decrypt
Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
//You can use ENCRYPT_MODE or DECRYPT_MODE
cipher.init(Cipher.ENCRYPT_MODE, new SecretKeySpec(sessionKey, "AES"), new IvParameterSpec(iv));
byte[] ciphertext = cipher.doFinal(plaintext); 
```

就是这样，用于加密/解密。如果您正在处理大量数据，那么您最好读取 16 字节的倍数的块并调用 update 而不是 doFinal （您只需在最后一个块上调用 doFinal ）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T19:15:30.237

对于一个很棒的免费图书馆，我强烈推荐[BouncyCastle。](http://www.bouncycastle.org/)它是积极维护的，高质量的，并且有一系列很好的代码示例。对于参考文档，您将不得不更多地依赖通用[JCE 文档。](http://java.sun.com/j2se/1.5.0/docs/guide/security/jce/JCERefGuide.html)

我不能说我们使用什么库来满足 FIPS 认证要求。但是 CryptoJ 的替代品要便宜得多。

一般来说，我建议为您使用 Rijndael 等对称密码加密的每条消息生成一个新密钥，然后使用 RSA 等非对称算法加密该密钥。这些私钥可以存储在受密码保护的基于软件的密钥存储中，例如 PKCS #12 或 Java 的“JKS”，或者为了更好的安全性，存储在“智能卡”硬件令牌或其他加密硬件模块上。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-01-18T22:41:22.413

正如我的公司最近发现的那样，AES 并不完全是 Rijndael。AES 具有密钥必须为 128、192 或 256 位的限制 - 但是，Rijndael 也允许密钥为 160 和 224。

正如上面的 erickson 所指出的，BouncyCastle 提供了一个 Rijndael 对象，它支持额外的密钥长度：128/160/192/224/256 位。具体来说，看一下轻量级 API。

Gnu-crypto 是另一个开源库 - 但是，它也不支持 160 位和 224 位密钥。

因此，如果您正在寻找完整的 Rijndael 支持，那么 BouncyCastle 是我迄今为止找到的唯一一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T19:07:25.623

javax.crypto 支持 AES：http: [//java.sun.com/developer/technicalArticles/Security/AES/AES_v1.html](http://java.sun.com/developer/technicalArticles/Security/AES/AES_v1.html)

对于安全密钥存储，通常的方法是使用加密散列函数从用户输入（密码）中导出加密密钥，并使用导出的密钥对钥匙串进行加密。或者，如果您只需要一个密钥，您可以使用派生密钥本身。

请始终牢记，系统的安全性与所使用的散列函数的强度直接相关。使用加密安全的散列函数，如果可能的话加上盐，并且散列不止一次（例如数百次）。

话虽如此，这个问题非常模糊。

# .net - .NET 部署到网络共享

> ID：587358
> 
> 赞同：4
> 
> 时间：2009-02-25T19:05:13.943
> 
> 标签：.net, deployment, network-share

我有一个 .NET 3.5 应用程序，我希望将它安装在客户端的服务器上，并让工作站直接从网络共享运行它。我读过一些似乎表明这不像简单地将应用程序复制到网络共享那样简单，就像我对本机 exe 所做的那样。不幸的是，似乎缺乏关于正确/最佳方式的文档（通过 ClickOnce 或其他方式）。

那么，我将如何进行这种类型的部署？我只是复制程序集吗？ClickOnce 有什么东西可以让我的生活更轻松并促进未来的更新吗？（请记住，每个客户端在其本地服务器上都有不同的安装点。）

到目前为止我所知道的：

显然，每个工作站都必须安装 .NET 框架。我在想通过组策略安装它是这里的方法。

我还阅读了一些关于从需要完全信任的网络共享运行的内容，但后来我读到这在 3.5 中可能不是问题。有人知道这里的最终答案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T19:09:30.033

从 3.5 **SP1**开始，从网络共享运行应用程序不再是问题。默认情况下，它们将在完全信任的情况下运行。

万斯的帖子：http: [//blogs.msdn.com/vancem/archive/2008/08/13/net-framework-3-5-sp1-allows-managed-code-to-be-launched-from-a-network -share.aspx](http://blogs.msdn.com/vancem/archive/2008/08/13/net-framework-3-5-sp1-allows-managed-code-to-be-launched-from-a-network-share.aspx)

我相信实际的变化是在 CLR 2.0 SP2 中，你可以在 3.5 SP1 中获得，但我还没有找到任何关于这个主题的具体文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T19:27:52.050

您还可以使用 ClickOnce 部署来允许普通受限用户在本地安装应用程序。此部署仍允许您将更新发布到网络共享并让用户自动获取它们。如果您坚持使用 3.5sp1 之前的 .Net 版本，它将起作用。

它还绕过了其他一些问题。例如，如果您需要部署更新并且用户当前在其本地计算机上运行该应用程序，则文件系统可能已锁定您需要更改的文件。ClickOnce 会跳过它。

# php - 如何避免或修复 PHP 警告：打开的文件过多

> ID：587360
> 
> 赞同：3
> 
> 时间：2009-02-25T19:05:24.753
> 
> 标签：php, linux

我在 Fedora 上运行 PHP 5.2，在循环大约 1000 次迭代后不断收到此警告，这意味着程序已停止工作，需要重新启动。我可以将其设置为在 1000 次迭代后退出并在此后不久通过 cron 重新启动，但这感觉就像是懦夫的出路。循环如下；我应该补充一点，这会导致`get_load()`通话`file_get_contents()`。

```
while ($row = select_row($sql))
{
    while (($load = get_load()) > 10)
    {
        echo "Going to sleep (load: ".$load.")\n";
        sleep(60*3);
    }
    $id = $row['id'];
    foreach ($sizes as $abbr=>$size)
    {
        if($row[$size] != "yes")
        {
            continue;
        }
        $filename = "/images/".$abbr."/".$id.".jpg";
        $tmp_file = "/tmp/".$id.".jpg";
        if ($size == "large")
        {
            //We want to progressively interlace our large bookcovers because it saves on filesave above 10K.
            $cmd = "convert -strip -interlace Plane ".$filename." ".$tmp_file;
        }
        else
        {
            $cmd = "convert -strip ".$filename." ".$tmp_file;
        }
        $convert = popen($cmd." 2>&1", "r");
        if (is_resource($convert))
        {
            echo fgets($convert);
            if(pclose($convert) == 0)
            {
                 //Upload converted file to remote server
            }
            unlink($tmp_file);
        }
    } 
```

编辑：阅读前两个答案后，我意识到在取出与我的问题无关的文件上传代码时，我取出了我的`pclose()`陈述。放入`pclose()`我的代码中显示的内容。

进一步编辑：`get_load()`按要求发布

```
function get_load()
{
    $load = explode(" ", file_get_contents("/proc/loadavg"));
    return $load[0];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T19:10:07.973

与 .一起使用后，您应该关闭指针[`pclose`](http://docs.php.net/pclose)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T19:08:42.423

每次使用 pclose() 写入后尝试关闭进程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-21T10:32:35.217

我最近在使用 Xdebug 和 PhpStorm（在 Mac 上）时遇到了这个问题。这里有一个开放的错误：

[http://bugs.xdebug.org/view.php?id=1070](http://bugs.xdebug.org/view.php?id=1070)

和

[https://youtrack.jetbrains.com/issue/WI-25307](https://youtrack.jetbrains.com/issue/WI-25307)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T19:37:30.543

我知道你说`get_load()`uses `file_get_contents()`，但要确保......它是否正确关闭了它打开的所有文件？你能发布那个函数的代码吗？

编辑：即使它是一个内置函数，也请尝试使用除`file_get_contents()`读取文件之外的其他方法，看看会发生什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T19:15:41.110

popen 只能返回两个东西，要么是资源，要么是 FALSE。也许您应该针对 FALSE 而不是 is_resource 进行测试？您正在泄漏文件句柄，因此要检查的显而易见的事情是确保在打开文件后始终关闭文件，而打开文件句柄的明显位置是 popen 调用。跟踪您的逻辑并确保您不会以某种方式跳过关闭这些管道，无论是通过逻辑错误还是异常。

# linux - 是“killall -r -9”。保证工作？

> ID：587381
> 
> 赞同：3
> 
> 时间：2009-02-25T19:09:52.280
> 
> 标签：linux

`killall -r -9 .`将信号发送到与正则表达式`9`匹配的所有进程（即它杀死所有进程）。`.`当它杀死自己时，问题是，它会不会最后杀死自己，因此会按照文档记录去做，或者它会在完成工作之前杀死自己，让进程保持活力。

按照@David 的回答，这意味着如果你运行`killall`两次，它的工作机会比你运行一次的机会*少*`killall`——因为每个人都可以在完成工作之前杀死另一个人。

这是一个新的悖论，类似于停机问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T19:17:14.413

手册页说这`killall`永远不会自杀。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T20:44:16.997

为什么不

```
kill -9 -1 
```

一口气杀死所有进程？

好吧，实际上它会杀死除 init 和自身之外的所有人，当然，如果您以非特权用户身份运行它，您只能杀死自己的进程。但是您不必担心它杀死的“顺序”：它运行单个`kill(-1, SIGKILL)`系统调用而不是迭代各种 PID。

# asp.net-mvc - ASP .Net 和会话状态

> ID：587386
> 
> 赞同：3
> 
> 时间：2009-02-25T19:11:02.010
> 
> 标签：asp.net-mvc

今天看MVC源码：

公共类 MvcHandler : IHttpHandler, IRequiresSessionState

为什么需要 SessionState？MVC 不是在尝试做一些 RESTful 的事情吗？

我知道在 MVC 中使用会话状态的原因是为了传输一些数据（不记得这个术语，但会话状态可以用其他媒介代替）。我认为我真正的问题是：

为什么我不能编写 MVC 应用程序并指定并选择完全关闭会话状态？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T19:15:23.217

由于 TempData，它需要它。TempData 与 ViewData 类似，不同之处在于它会返回视图并返回一次。为此，它需要一个 cookie。

有一种方法可以通过创建一个虚拟对象来解决它，我只是不记得如何了。

找到了，感谢[Kigg](http://www.codeplex.com/Kigg)。

```
public class EmptyTempDataProvider : ITempDataProvider
{
    public IDictionary<string, object> LoadTempData(ControllerContext controllerContext)
    {
        return new Dictionary<string, object>();
    }

    public void SaveTempData(ControllerContext controllerContext, IDictionary<string, object> values)
    {
    }
} 
```

然后，您必须创建一个基本控制器并在创建其他控制器时从它派生。

```
protected BaseController()
{
    TempDataProvider = new EmptyTempDataProvider();
} 
```

这应该允许您禁用会话状态。

# .net - ADO.NET Entity Framework 是否支持 Compact Framework

> ID：587387
> 
> 赞同：0
> 
> 时间：2009-02-25T19:11:14.647
> 
> 标签：.net, compact-framework

好吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T20:23:45.520

SQL Server Compact Edition 3.5 SP1[支持实体框架](http://technet.microsoft.com/en-us/library/cc835494.aspx)。此外，这篇博文声称[Entity Framework 在 Visual Studio Entity Designer 中支持](http://jmayo.spaces.live.com/blog/cns!5F243997972597CE!568.entry?sa=96108136)CF。

但是，我找不到任何方法来创建新的 .edmx 文件。虽然我可以在从另一个项目复制和 .edmx 后打开实体设计器，并获取我的数据库模型，但我无法编译它。

所以，我想说实体框架还不支持 CF。

# java - 关于Java枚举的问题

> ID：587392
> 
> 赞同：4
> 
> 时间：2009-02-25T19:12:52.770
> 
> 标签：java, enums

我有 2 个相互交互的文件。我想定义一个枚举以使代码更具可读性，但如果我在文件 1 中定义它，文件 2 会抱怨不知道所述枚举。如果我在文件 2 中定义 ii，文件 1 也会这样做。我也将其定义为公开的。

解决方案是在两个文件中定义枚举，但这对我来说似乎不正确。它不仅是多余的，而且我担心它可能会导致一些冲突，即使类型具有相同的项目。

对此有何判决？我做错了什么或担心太多了吗？

编辑

好吧，鉴于这里的评论，我找到了一个替代方案，它似乎可以做我想做的事，而无需创建新文件。我有：

文件 1

```
class myClass1
{
    public enum MyEnum
    {
        ...
    }
    ...
} 
```

文件 2

```
class myClass2
{
    public enum MyEnum
    {
        ...
    }
    ....
} 
```

我现在有：

文件 1

```
enum myEnum
{
    ...
}

...

class myClass1
{
     ...
} 
```

文件 2

```
class myClass2
{
     ...
} 
```

我不想仅为枚举创建另一个文件，所以这对我有用。好吧，只要它没有任何问题，我认为没有。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-25T19:15:09.943

您绝对不应该在两个位置都定义枚举。我建议在具有公共可访问性的自己的文件中定义枚举。那么每个人都应该可以毫无问题地访问它。但是，假设您想在两个类之一中定义枚举，我将继续......

您必须`import`枚举或使用其完全限定名称。假设您在 package`com.stackoverflow`中，您的类在第一个文件中应该如下所示：

```
package com.stackoverflow;

public class A {
    public enum MyEnum {
      ONE,TWO,THREE;
    }

    ...
} 
```

在另一个文件中：

```
package com.stackoverflow;

import com.stackoverflow.A.MyEnum;

public class B {

  public void test(MyEnum mine) {
    ...
  }

  ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T19:15:26.027

不——这是错误的。`enum`可以声明为静态内部类并使用完全限定名称进行引用

```
public class MyClass {
    public static enum MyEnum { BOOK, DVD }

    public void myMethod() {
        MyEnum e = MyEnum.DVD;
    }
}

public class B {
    public void someMethod() {
        MyClass.MyEnum enumVal = MyClass.MyEnum.BOOK;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T20:19:15.687

还请记住，当您将枚举放入另一个类的文件时，您可能会因默认访问权限而面临无法从另一个包访问枚举的问题。...因此将枚举放在具有公共访问权限的单独文件中或作为可以使用类名访问的类的公共静态成员中总是明智的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T19:19:30.027

您定义枚举的方式与定义类的方式相同 - 在它们自己的文件中，或者作为静态内部类（它们必须是静态的，而不是绑定到它们的封闭类）。

在 2 个文件中定义你的枚举被破坏了，因为它有点违背目的 - 你将有 2 个单独的枚举，虽然你想在 Enum.A 上测试相等性，但实际上你会拥有 Enum1.A !=Enum2。一种。很混乱。

对他们来说并没有什么神秘之处，它只是一种定义常量的方式，它比 public static final 更安全、更有能力。

# c - 使用函数指针从线程调用回调

> ID：587393
> 
> 赞同：5
> 
> 时间：2009-02-25T19:13:14.020
> 
> 标签：c, function, pointers, pthreads, callback

c程序编译器gcc

我有 3 个文件。main.c stop_watch.h 和 stop_watch.c

这个程序确实有效。我打电话给 start_stopwatch。并且它会在时间到期后在 main.c timeout_cb() 中回调。我也在一个单独的线程中运行它，因为我不想在 main 中阻塞，因为我将有其他需要运行的代码。

1) g_start_timer 中的秒数总是垃圾。我想我可能已经通过在堆上创建结构来解决这个问题。无论如何我可以解决这个问题。我正在考虑在堆上创建秒元素。但认为这已经结束了

2）这个程序工作正常，但如果我注释掉 main printf("=== timeout_cb: %p\n", timeout_cb); 中的行 它将堆栈转储。

3) 什么时候是释放内存的最佳时间。我主要释放它。但我担心如果在线程完成之前释放内存。这可能会导致非常意想不到的结果。我想我可以在调用后使用 thread_join() 来释放内存。但是，我需要返回在 stop_watch.c 中创建的 thead_id，有没有办法返回在 stop_watch.c 中创建的 thread_id

非常感谢您的任何建议，

**主程序**

```
/* main.c */
    #include <pthread.h>
    #include <stdio.h>
    #include <stdlib.h>

#include "stop_watch.h"

/* call this when the time expires */
void timeout_cb()
{
    printf("=== your time is up run some job here ===\n");
}

int main()
{
    struct data_struct *g_data_struct =
        (struct data_struct*) calloc(1, sizeof(*g_data_struct));

    if(!g_data_struct)
    {
        printf("=== failed to allocate memory ===\n");
        return 0;
    }

    g_data_struct->seconds = 3;
    g_data_struct->func_ptr = timeout_cb;

    //  printf("=== timeout_cb: %p\n", timeout_cb);

    start_stopwatch(g_data_struct);

    // free(g_data_struct);
    printf("=== End of Program - all threads in ===\n");

    pthread_exit(NULL);

    return 0;
} 
```

**stop_watch.h**

```
/* stop_watch.h */
struct data_struct
{
    int seconds;
    void (*func_ptr)(void);
};
void start_stopwatch(struct data_struct *g_data_struct); 
```

**stop_watch.c**

```
#include <stdio.h>
#include <pthread.h>

#include "stop_watch.h"

static void* g_start_timer(void *args)
{
    void (*function_pointer)();

    int seconds = ((struct data_struct*) args)->seconds;
    function_pointer = ((struct data_struct*) args)->func_ptr;

    printf("=== go to sleep for %d\n", seconds);

    sleep(seconds);

    (void) (*function_pointer)();

    pthread_exit(NULL);

    return 0;
}

void start_stopwatch(struct data_struct *g_data_struct)
{
    pthread_t thread_id;
    int rc;

    int seconds = g_data_struct->seconds;
    printf("=== start_stopwatch(): %d\n", seconds);

    rc =  pthread_create(&thread_id, NULL, g_start_timer, (void *) &g_data_struct);

    if(rc)
        printf("=== Failed to create thread\n");
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T19:26:14.283

中的行`start_stopwatch()`：

```
rc =  pthread_create(&thread_id, NULL, g_start_timer, (void *) &g_data_struct); 
```

应该：

```
rc =  pthread_create(&thread_id, NULL, g_start_timer, (void *) g_data_struct); 
```

在第一种情况下，当您真的只想将指针作为线程参数传递时，您传递的是“指向指针的指针”。

至于何时释放数据，有很多选择。如果您*总是*在堆分配的块中传递线程数据，那么`g_start_timer()`线程 proc 可以在完成提取数据时释放它。请注意，如果您这样做，则启动线程的部分协议是线程参数块必须是堆分配的。

# asp.net - 对于想要将一切都变成 .NET 控件的人，您会说些什么？

> ID：587395
> 
> 赞同：3
> 
> 时间：2009-02-25T19:14:15.437
> 
> 标签：asp.net, custom-controls

例如，我们有一些 CSS 规则来定义我们的表单布局。我们使用以下标记：

```
<div class="foo">
    <label class="bar req">Name<em>*</em></label>
    <span>
        <asp:TextBox runat="server"/>
            <label>First</label>
    </span>
    <span>
        <asp:TextBox runat="server"/>
            <label>Last</label>
    </span>
    <div class="clear"></div>
</div> 
```

在我看来，这是非常好的标记。遵循这些规则并不是一种负担，因为无论如何你都应该担心干净、正确的标记。有人建议我们使用如下所示的控件“强制执行”这些规则：

```
<x:FormField runat="server" Label="Name" Required="True">
    <x:TextBox runat="server" hint="First"/>
    <x:TextBox runat="server" hint="Last"/>
</x:FormField> 
```

我的直觉告诉我，XHTML 标记是我们的朋友，而不是我们的敌人。两个问题：

1.  我是否完全反对制作所有这些自定义控件只是为了发出标记？
2.  如果你同意我的观点，你会给出什么理由？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-25T19:17:16.130

我投票选择使用控件，因为如果该标记曾经更改（例如，您想向框添加一些漂亮的 jQueryUI 效果或添加 RequiredFieldValidator 控件），您可以在一个地方进行更改并完成它。干燥。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-25T19:24:24.490

反对控制：

*   性能数字。测量一个基线 XHTML 页面和具有 20 个发出相同标记的控件的同一页面。这会给你一个估计。
*   附加费用。您需要考虑开发、测试和维护这些控制的成本。

对于控件：

*   一致性。现在，您可以在一个地方使用您需要的所有元素来控制 XHTML 结构，并且它将在所有页面中保持一致。
*   回归。您可以进行适当的单元和场景测试，以确保您的 XHTML 结构符合您的要求。
*   重复使用。您将来可以在其他项目中重复使用相同的控件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-25T19:41:14.467

我会说“不要成为抽象宇航员”又名“建筑宇航员”

进一步阅读：[http ://www.joelonsoftware.com/articles/fog0000000018.html](http://www.joelonsoftware.com/articles/fog0000000018.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T19:20:12.880

根据这个确切例子的个人经验，我可以支持你。它可能不适用于其他场景，但标签+文本框应该分开。通常一切都很好，直到你完成项目的 2/3 并且其他人开始批判性地审查它。我的经验是，用户/经理/ui 设计师在很多地方都需要例外——不同的间距、标签和文本框之间的额外内容等。还要记住验证例程，一个验证器并不适合 ASP.NET 中的所有大小。当您获得这样的工作控件来处理所有不同的场景时，在表单上保留标签+文本框可能会减少工作量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T19:19:39.370

通过 CSS “实施”外观在时间、支持、维护和白发方面的成本要少得多。关于复合控件（这是您的第二个片段的样子）本质上没有什么比“强制”更多的了。但是，自定义控件涉及更多的工作。

底线：自定义控件是关于重用和重新分配，而不是布局。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T19:21:54.917

我做类似的事情。把它发挥到极致，一个页面上有 30-40 个这样的控件。拥有为您处理标签、验证器等的控件使您的生活变得更加轻松。

我们还有自动化的表单助手，可以将表单值加载到对象上，反之亦然，以减轻所有

`lefthand = righthand`到处都是代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T19:31:10.870

如果您打算重用代码，或者如果您希望在代码上定义自定义属性或属性，则使用自定义控件可能是一个不错的选择，但否则没有什么意义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T19:44:41.603

我同意弗朗西的观点……使用这样的控件是有充分理由的。但是，不要走极端。如果你被告知**一切都**应该是一个控件并编译在一个单独的文件中，那么有人在盲目地执行策略并且没有使用常识。政策只有在适用的情况下才是好的。在不适用的情况下应用策略（或编码模式）通常会导致噩梦。

其他人已经说过了，但是我在这里费心回答的原因是要指出一件特别的事情。如果您是初级开发人员，并且有一位资深人士告诉您以某种方式做事 - 您就那样做。他们可能知道您不知道的需求，或者他们没有告诉您的环境。有很多次我告诉初级开发人员“就这样做”，但没有太多解释原因——因为我们只需要完成它，给他们上编程课是我没有时间做的事情. 我通常会稍后回去向他们解释，但是当一个项目落后于计划时（而且他们总是如此），你会按照你被告知的去做，然后再争论。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T19:48:23.107

我想说这取决于控件的使用量，它只是在一个项目中还是您需要在其他项目中分发它？用户控件有什么问题？你得到了可重用性 + 你仍然有标记

# java - 查找集合中具有给定属性的所有对象

> ID：587404
> 
> 赞同：90
> 
> 时间：2009-02-25T19:15:27.837
> 
> 标签：java, collections

我有一些复杂的对象，比如猫，它有很多属性，比如年龄、最喜欢的猫食等等。

一堆 Cats 存储在一个 Java Collection 中，我需要找到所有 3 岁的 Cats，或者那些最喜欢的猫粮是 Whiskas 的 Cats。当然，我可以编写一个自定义方法来查找具有特定属性的那些猫，但是这对于许多属性来说变得很麻烦；有一些通用的方法吗？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-02-25T23:45:13.227

尝试公共集合 API：

```
List<Cat> bigList = ....; // master list

Collection<Cat> smallList = CollectionUtils.select(bigList, new Predicate() {
    public boolean evaluate(Object o) {
        Cat c = (Cat)o;
        return c.getFavoriteFood().equals("Wiskas") 
            && c.getWhateverElse().equals(Something);
    }
}); 
```

当然你不必*每次*都使用匿名类，你可以`Predicate`为常用的搜索创建接口的实现。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2013-05-24T04:18:53.190

使用 Java 8 lambda 表达式，您可以执行类似的操作

```
cats.stream()
    .filter( c -> c.getAge() == 3 && c.getFavoriteFood() == WHISKAS )
    .collect(Collectors.toList()); 
```

在概念上与 Guava Predicate 方法相同，但使用 lambda 看起来更清晰

对于 OP 来说可能不是一个有效的答案，但对于有类似需求的人来说值得注意。:)

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2009-02-25T23:40:42.470

我一直在使用 Google Collections（现在称为[Guava](http://code.google.com/p/guava-libraries/)）来解决这类问题。有一个名为 Iterables 的类，它可以将一个名为 Predicate 的接口作为方法的参数，这非常有用。

```
Cat theOne = Iterables.find(cats, new Predicate<Cat>() {
    public boolean apply(Cat arg) { return arg.age() == 3; }
}); 
```

[在这里](http://code.google.com/p/guava-libraries/)检查！

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2009-02-25T19:19:17.140

您可以编写一个方法，该方法采用定义`check(Cat)`方法的接口实例，该方法可以通过您想要的任何属性检查来实现。

更好的是，让它通用：

```
public interface Checker<T> {
    public boolean check(T obj);
}

public class CatChecker implements Checker<Cat> {
    public boolean check(Cat cat) {
        return (cat.age == 3); // or whatever, implement your comparison here
    }
}

// put this in some class
public static <T> Collection<T> findAll(Collection<T> coll, Checker<T> chk) {
    LinkedList<T> l = new LinkedList<T>();
    for (T obj : coll) {
         if (chk.check(obj))
             l.add(obj);
    }
    return l;
} 
```

当然，就像其他人所说，这就是关系数据库的用途......

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-02-25T19:41:11.800

我建议使用[Jxpath](http://commons.apache.org/jxpath/)，它允许您对对象图进行查询，就好像它在 xpath 喜欢的地方一样

```
JXPathContext.newContext(cats).
     getValue("//*[@drinks='milk']") 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-03-10T12:00:20.647

再次使用公共集合 API：当您分别实现谓词时，您将获得“检查器”类型代码：-

```
public class CatPredicate implements Predicate {

    private int age; 

    public CatPredicate(int age) {
        super();
        this.age = age;
    }

    @Override
    public boolean evaluate(Object o) {
        Cat c (Cat)o;
        return c.getAge()==this.age;
    }

} 
```

它被用作：-

```
CollectionUtils.filter(catCollectionToFilter, new CatPredicate(3)) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-12-06T11:12:14.337

您可以使用[lambdaj](https://code.google.com/p/lambdaj/)。像这样的事情是微不足道的，语法真的很流畅：

```
Person me = new Person("Mario", "Fusco", 35);
Person luca = new Person("Luca", "Marrocco", 29);
Person biagio = new Person("Biagio", "Beatrice", 39);
Person celestino = new Person("Celestino", "Bellone", 29);
List<Person> meAndMyFriends = asList(me, luca, biagio, celestino);
List<Person> oldFriends = filter(having(on(Person.class).getAge(), greaterThan(30)), meAndMyFriends); 
```

你可以做更复杂的事情。它使用[hamcrest](https://code.google.com/p/hamcrest/)作为 Matchers。有些人会争辩说这不是 Java 风格的，但有趣的是，这个家伙如何扭曲 Java 以进行一些函数式编程。也看看源代码，它很科幻。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-08-29T11:37:42.163

使用 Commons 集合：

```
EqualPredicate nameEqlPredicate = new EqualPredicate(3);
BeanPredicate beanPredicate = new BeanPredicate("age", nameEqlPredicate);
return CollectionUtils.filter(cats, beanPredicate); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-07-31T16:19:28.983

仅供参考，这个问题还有其他 3 个使用番石榴的答案，但没有一个回答这个问题。提问者说他​​希望找到所有具有匹配属性的猫，例如年龄为 3 岁的猫`Iterables.find`。如果存在的话，他只会匹配一只猫。如果使用 Guava，则需要使用`Iterables.filter`来实现此目的，例如：

```
Iterable<Cat> matches = Iterables.filter(cats, new Predicate<Cat>() {
    @Override
    public boolean apply(Cat input) {
        return input.getAge() == 3;
    }
}); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-25T19:25:01.260

听起来很像在 .NET 中使用 LINQ 的东西

虽然还没有针对 java 的“真正的”LINQ 实现，但您可能想看看[Quaere](http://andersnoras.com/blogs/anoras/archive/2007/09/11/introducing-quaere-language-integrated-queryies-for-java.aspx)，它可以很容易地完成您所描述的事情。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-25T19:28:19.863

您可以使用 JoSQL 之类的东西，并针对您的集合编写“SQL”：http: [//josql.sourceforge.net/](http://josql.sourceforge.net/)

这听起来像您想要的，并且能够执行更复杂的查询。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-25T19:30:09.000

您可以尝试 Apache Commons 项目中的一些通用代码。[Collections](http://commons.apache.org/collections/)子项目提供了用于查找匹配特定谓词以及大量谓词（equals、null、instanceof 等）的对象的代码。[BeanUtils](http://commons.apache.org/beanutils/)子项目允许您创建谓词来测试 bean的属性。

使用[CollectionUtils](http://commons.apache.org/collections/api-release/org/apache/commons/collections/CollectionUtils.html)类在集合中进行搜索。有一些方法可以做到这一点，但请特别检查 select() 方法。使用以下类来构造谓词，或编写您自己的：[Predicate](http://commons.apache.org/collections/api-release/org/apache/commons/collections/Predicate.html)、[PredicateUtils](http://commons.apache.org/collections/api-release/org/apache/commons/collections/PredicateUtils.html)、[BeanPredicate](http://commons.apache.org/beanutils/v1.8.0/apidocs/org/apache/commons/beanutils/BeanPredicate.html)。

这有时有点麻烦，但至少它是通用的！:-)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-05-06T12:13:16.887

基于谓词、过滤器和自定义迭代器/比较器的解决方案很好，但它们不提供数据库索引的模拟。例如：我想以不同的方式搜索猫的集合：按性别和年龄以及按年龄，所以它看起来像两个索引：1）[性别，年龄] 2）[年龄]。通过该索引访问的值可以被散列，以实现快速查找，而无需迭代整个集合。哪里有这样的解决方案？

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-05-24T02:08:19.937

使用谷歌番石榴。

```
final int lastSeq = myCollections.size();
Clazz target = Iterables.find(myCollections, new Predicate<Clazz>() {
    @Override
    public boolean apply(@Nullable Clazz input) {
      return input.getSeq() == lastSeq;
    }
}); 
```

我想用这个方法。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-25T19:23:03.620

您可以将这些对象存储在数据库中。如果您不想要一个完整的数据库服务器的开销，您可以使用像 HSQLDB 这样的嵌入式服务器。然后可以使用 Hibernate 或 BeanKeeper（使用更简单）或其他 ORM 将对象映射到表。您继续使用 OO 模型并从数据库中获得高级存储和查询优势。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-25T19:33:42.067

这是一个搜索器类的想法，您可以使用要查找的特定值进行参数化。

您还可以进一步存储属性的名称，可能在具有所需值的 Map 中。在这种情况下，您将使用 Cat 类的反射来调用给定属性名称的适当方法。

```
public class CatSearcher {

  private Integer ageToFind = null;
  private String  foodToFind = null;

  public CatSearcher( Integer age, String food ) {
    this.ageToFind = age;
    this.foodToFind = food;
  }

  private boolean isMatch(Cat cat) {
    if ( this.ageToFind != null && !cat.getAge().equals(this.ageToFind) ) {
       return false;
    }
    if ( this.foodToFind != null && !cat.getFood().equals(this.foodToFind) {
       return false;
    }
    return true;
  }

  public Collection<Cat> search( Collection<Cat> listToSearch ) {
    // details left to the imagination, but basically iterate over
    // the input list, call isMatch on each element, and if true
    // add it to a local collection which is returned at the end.
  }

} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-04-05T10:39:32.070

JFilter [http://code.google.com/p/jfilter/](http://code.google.com/p/jfilter/)适合您的要求。

JFilter 是一个用于查询 Java bean 集合的简单且高性能的开源库。

主要特点

*   支持集合（java.util.Collection、java.util.Map 和 Array）属性。
*   支持任意深度的集合内集合。
*   支持内部查询。
*   支持参数化查询。
*   可以在 100 毫秒内过滤 100 万条记录。
*   过滤器（查询）以简单的 json 格式给出，类似于 Mangodb 查询。以下是一些例子。
    *   { "id":{"$le":"10"}
        *   其中对象 id 属性小于等于 10。
    *   { "id": {"$in":["0", "100"]}}
        *   其中对象 id 属性为 0 或 100。
    *   {"lineItems":{"lineAmount":"1"}}
        *   其中参数化类型的 lineItems 集合属性的 lineAmount 等于 1。
    *   { "$and":[{"id":"0"}, {"billingAddress":{"city":"DEL"}}]}
        *   其中 id 属性为 0，而 billingAddress.city 属性为 DEL。
    *   {"lineItems":{"taxes":{ "key":{"code":"GST"}, "value":{"$gt":"1.01"}}}}
        *   其中参数化类型的 lineItems 集合属性具有参数化类型的税收地图类型属性的代码等于大于 1.01 的 GST 值。
    *   {'$or':[{'code':'10'},{'skus': {'$and':[{'price':{'$in':['20', '40']} }, {'code':'RedApple'}]}}]}
        *   选择产品代码为 10 或 sku 价格为 20 和 40 且 sku 代码为“RedApple”的所有产品。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-09-24T12:54:31.653

当涉及到此类问题时，Guava 具有非常强大的搜索能力。例如，如果您所在的区域根据其中一个属性搜索对象，您可以考虑：

```
Iterables.tryFind(listOfCats, new Predicate<Cat>(){
    @Override
    boolean apply(@Nullable Cat input) {
        return "tom".equalsIgnoreCase(input.name());
    }
}).or(new Cat("Tom")); 
```

如果汤姆猫可能不在 listOfCats 中，它将被返回，从而使您可以避免 NPE。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-05-14T14:58:02.907

一个非常常见的问题，我使用了谷歌收藏，这是我的代码

```
public class FindByIdPredicate implements Predicate<IDObject> {

private Long entityId;

public FindByIdPredicate(final Long entityId) {
    this.entityId = entityId;

}

@Override
public boolean apply(final IDObject input) {
    return input.getId().equals(this.entityId);
}

/**
     * Pass in the Collection
 * @param Collection
 * @return IdObject if present or null
 */
public IDObject getEntity(final Collection<? extends IDObject> collection) {

    for (IDObject idObject : collection) {
        if (this.apply(idObject)) {
            return idObject;
        }
    }
    return null;

}

/**
 * @param Set
 * @return IdObject if present or null
 */
@SuppressWarnings("unchecked")
public <T> T getEntity(final Set<? extends IDObject> set) {

    for (IDObject idObject : set) {
        if (this.apply(idObject)) {
            return (T) idObject;
        }
    }
    return null;

} 
```

}

希望这可以帮助

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2013-06-27T04:05:36.193

您可以按以下功能从列表中搜索项目。祝你好运！

```
int _searchList(List<T> list,T item) {
int idx = -1;
idx = Collections.binarySearch(list,item,
        new Comparator<T>() {
            public int compare(Titm1,
                    Titm2) {

                // key1
                if (itm1.key1.compareTo(itm2.key1) != 0) {
                    return itm1.key2.compareTo(itm2.key2);
                }

                // key2
                return itm1.key2
                        .compareTo(itm2.key2);
            }
        });

return idx; 
```

}

# windows - Hrez.exe 在哪里可以找到它？

> ID：587412
> 
> 赞同：0
> 
> 时间：2009-02-25T19:18:04.070
> 
> 标签：windows, resources

我有一个 Dmake 文件，它使用：

REZCOMPILE = C:/hrez/hrez.exe

我用谷歌搜索，我在任何地方都找不到 HREZ。

从哪里得到它？

-杰森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T21:18:46.400

您从哪个项目获得 Dmake 文件？与作者核实获得它。如果没有任何关于您正在尝试做的事情的背景，就很难提供帮助。

# iphone - NSString @property，使用复制而不是保留

> ID：587414
> 
> 赞同：16
> 
> 时间：2009-02-25T19:18:56.000
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我正在查看 Apple 的示例应用程序 EditableDetailView，并注意到在他们的一个控制器中，他们正在使用（非原子，副本）设置 NSString 属性的实例。什么时候会使用副本而不是保留？这样他们就可以在不影响现有数据的情况下制作唯一的副本吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-25T19:28:47.163

是的，它可以在不影响现有数据的情况下制作唯一副本。合成的 setter 基本上如下所示：

```
// For @synthesize(nonatomic, retain) foo:
- (void) setFoo(NSFoo *theFoo)
{
    [theFoo retain];  // retain new value
    [foo release];    // release old value, if any
    foo = theFoo;     // assign new value
}

// For @synthesize(nonatomic, copy) foo:
- (void) setFoo(NSFoo *theFoo)
{
    NSFoo* newFoo = [theFoo copy];  // make copy
    [foo release];  // release old value, if any
    foo = newFoo;   // assign new value
} 
```

注意这里的操作顺序很重要——新值必须在旧值被释放之前保留/复制，以防自赋值。如果您先释放然后将属性分配给自身，则可能会意外释放该值。另请注意，如果旧值为`nil`，则可以向其发送`release`消息，因为`nil`明确允许向对象发送消息并且什么也不做。

选择保留还是复制只是决定了对象的属性是否与您设置的值相同。考虑以下代码：

```
// suppose the 'foo' property is declared 'retain' and the 'bar' property is
// declared 'copy'
NSFoo *foo = ...;
NSBar *bar = ...;
someObject.foo = foo;
someObject.bar = bar;
[foo changeInternalState];  // someObject.foo also changes, since it's the same object
[bar changeInternalState];  // someObject.bar does NOT change, since it's a copy 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T20:08:30.890

请记住，有一个 NS*可变*字符串。能够改变某个其他对象拥有的字符串的内容（例如，通过删除其一半字符）真的很糟糕，特别是如果您没有意识到您正在影响另一个对象。因此，其他对象制作自己的副本是件好事。

你可能会说“好吧，我为什么不在分配字符串之前复制它呢？”。也许对象想要一个可变字符串，而你的字符串是不可变的。如果您必须先复制字符串，那么您必须在其文档或标题中查找它想要的字符串类型，然后制作正确的副本（每次）。这样，您只需说出`other.string = myString`它想要的任何类型的副本，您就不必担心它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-02T18:02:15.967

（出于某种原因，这篇文章出现在我试图回答的后续问题之上）回复：

> 你的意思是我必须在释放'foo'之前复制'foo'对象吗？但是如果我在复制'foo'之前释放'foo'会有什么问题？因为它们是两个不同的对象，我不明白为什么释放一个影响另一个！！！！

大多数时候，你是对的。事实上，如果它们是两个独立的对象，那就没关系了。问题在于您将相同的对象分配回自身的可能性。如果你说

```
[myObject setFoo: moof];
[myObject setFoo: moof]; 
```

然后你第二次这样做，你会在复制之前释放 moof。在此期间，如果 moof 的保留计数变为零，则可能会删除 moof，并且在接下来的步骤中您将没有任何内容可复制。Foo 现在为零。

这有可能发生吗？可能比你想象的要多。例如，有时用户可能会点击两次“更新”按钮。

我希望这是可以理解和有帮助的。

# iis - IIS7 - 一次只提供一页。这让我发疯！

> ID：587420
> 
> 赞同：18
> 
> 时间：2009-02-25T19:20:15.467
> 
> 标签：iis, iis-7, asp-classic

情况：经典的 ASP 应用程序，使用自定义的应用程序池。默认设置。

在*某些*IIS7 机器上，IIS 决定一次只提供一个页面。因此，如果多个从一个站点加载任何页面，每个页面都必须连续加载。

例如，如果我从一个浏览器加载[http://foo.com/default.asp](http://foo.com/default.asp)，而从另一台机器加载[http://foo.com/differenturl.asp](http://foo.com/differenturl.asp)，则第一个必须在另一个加载之前完成。这几乎就像 w3p 进程是单线程的。

请注意，在 IIS 的高级设置中有一个名为 MaxProcesses 的设置，上面写着“将此设置为大于 1 以创建 Web Garden”（无论是什么）。这并不能解决问题，因为这会产生具有自己会话状态等的多个进程，并且当您加载[http://foo.com/default.asp](http://foo.com/default.asp)时，无法保证您被分配到同一个进程。

问题本身就暴露出来了，因为我们有一个用 ASP 编写的诊断页面，它创建和 ActiveX 控件，它在网站上加载一个 url 并返回结果。

因此，diagnostics.asp 加载并在服务器端的代码中创建一个小型 Web 控件，该控件在同一服务器上加载（想想 XMLHTTP 控件）default.asp。

此页面永远不会完成加载，因为服务器在为 default.asp 页面提供服务之前正在等待 diagnostics.asp 页面完成。僵局！

这在每台 IIS6 机器上都可以正常工作，而且我相信有些 IIS7 服务器也可以正常工作。

我已经证实这也不是我们古怪诊断的结果。从一台机器或什至单独的机器加载多个选项卡将显示 Web 进程一次处理一个。

* * *

**AnthonyWJones 的正确答案**：在 IIS7 中打开了服务器端调试。这将 IIS 置于单线程模式。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-10T19:39:12.147

在 IIS 管理器中单击树中的应用程序。

双击 IIS 部分下的 ASP。

展开“调试属性”

确保“启用客户端调试”和“启用服务器端调试”都设置为 false。

启用调试后，ASP 仅限于以单线程方式一次处理一个请求。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-06T18:57:03.733

首先：确保您使用多个客户端进行测试。一台计算机同时向同一服务器（IP 地址）发出 2 个 HTTP 请求。（这是一个 RFC 规范。）

如果这不能解决您的问题，请查看 IIS7 -> ASP -> 服务 -> COM Plus 属性 -> 在 MTA 中执行。尝试将此设置设置为“真”。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T23:45:26.527

您确定您的代码中没有导致死锁的依赖项。我之前在日志记录、sql 连接等创建依赖项的地方已经看到了这一点。使用 perfmon 并检查硬盘读/写队列、内存读/写队列以查看是否正在备份。

我强烈推荐[Tess Ferrandez 的（ASP.NET Escalation Engineer - Microsoft）](http://blogs.msdn.com/tess/archive/2008/05/21/the-21-most-popular-blog-posts.aspx) 博客，以获得很多见解和找出正在发生的事情的方法。苔丝对这些东西的遗忘比大多数人所知道的还要多。

我认为您的问题与 IIS 无关，而是您的应用程序中的某些问题，可能在您的 ActiveX 组件中。确保在 ActiveX 组件之后进行清理。这是我在使用 Excel（另一个 Com 组件）后用来清理的一段代码。记住 Com 不受管理。

```
 Private Sub ShutDownExcel()
    If objExcel IsNot Nothing Then
        objExcel.DisplayAlerts = True
        objExcel.Quit()
        System.Runtime.InteropServices.Marshal.ReleaseComObject(objExcel)
        objExcel = Nothing
    End If

    ' Clean up memory so Excel can shut down. 
    GC.Collect()
    GC.WaitForPendingFinalizers()

    ' The GC needs to be called twice in order to get the 
    ' Finalizers called - the first time in, it simply makes 
    ' a list of what is to be finalized, the second time in, 
    ' it actually the finalizing. Only then will the 
    ' object do its automatic ReleaseComObject. 
    GC.Collect()
    GC.WaitForPendingFinalizers()
End Sub 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T22:15:40.820

IIS7 肯定是多线程的，所以我猜你的应用程序有问题。

您提到 ActiveX 从同一服务器加载页面 - 也许这个 ActiveX 不是免费线程的，这会导致使用它的每个页面都运行单个实例？

顺便说一句：Web Garden - 使用多个进程的同一服务器 - 不能使用进程内会话 Web Farm - 多个 Web 服务器

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T15:00:29.543

确保将 asp.net 配置为使用超过 1 个工作线程。[这篇 msdn 文章](http://msdn.microsoft.com/en-us/library/7w2sway1(VS.71).aspx)介绍了如何设置此配置选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T01:03:43.147

您是否已将应用程序池上的“托管流水线模式”更改为“经典”（默认为“集成”）？如果没有，请尝试经典。

我不知道它是否会有所帮助。我很久以前就不再为让经典的 ASP 应用程序与 IIS7 一起工作而奋斗了。（我不能说，这些应用程序真的很好而且正确，但它们在早期版本中工作。）

并尝试关闭测试页面的缓冲，并让它们在每次迭代中吐出一些东西。缓冲（和缓存）在 IIS7 中可能已经改变。也许它们毕竟是同时处理的，只是缓冲区太大而看不到差异。

这就是我现在想到的。

* * *

我假设您正在使用非常简单的案例进行测试。您的应用程序（无论是测试页面还是 global.asa）都没有使用任何两个请求共有的奇怪对象，因此需要锁定。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T11:49:48.477

只是一个想法，但是如果您在 IIS 中访问该网站，单击左侧的*“限制...”链接，连接限制设置为多少？*那里有最大带宽和最大并发连接选项。

我还会去应用程序池并单击*高级设置...*并检查 CPU 和内存限制。甚至可能从头开始创建一个新的应用程序池，并选择*无托管代码*来消除它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-08T19:15:11.293

如果调试设置没有问题，我发现在 IIS 8 中的 ASP 中使用会话变量时会遇到类似的行为。

我不知道这是 IIS 8 特定的，但“ASP 保证任何时候都只会执行来自 Session 的一个请求。” [http://msdn.microsoft.com/en-us/library/ms972335.aspx](http://msdn.microsoft.com/en-us/library/ms972335.aspx)

# objective-c - 在 Windows 上使用 GNUstep 编译 Objective-C 时无法找到标准库

> ID：587421
> 
> 赞同：11
> 
> 时间：2009-02-25T19:20:18.587
> 
> 标签：objective-c, windows, gnustep

我刚刚在我的 Windows XP 机器上安装了 GNUstep，我正在尝试从命令行编译以下 Objective-C Hello World 程序：

```
#import <Foundation/Foundation.h>

int main(int argc, const char *argv[]) {
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

    NSLog(@"Hello world\n");

    [pool drain];
    return 0;
} 
```

当我尝试像这样从命令行编译程序时

```
gcc hello.m -o hello 
```

我最终收到以下错误

```
hello.m:1:34: Foundation/Foundation.h: No such file or directory 
```

我需要做些什么来通知编译器标准 Objective-C 库的位置吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T19:26:38.683

看看[这里](http://web.archive.org/web/20131207013855/http://blog.lyxite.com/2008/01/compile-objective-c-programs-using-gcc.html)。似乎需要一堆参数来编译命令。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-02-02T13:59:42.240

尝试在您的命令中运行此命令行。它对我有用。

```
gcc -I"c:/GNUstep/GNUstep/System/Library/Headers" -L "c:/GNUstep/GNUstep/System/Library/Libraries" -o hello helloWorld.m -lobjc -lgnustep-base -fconstant-string-class=NSConstantString 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-04T07:17:48.473

我刚刚制作了一个名为“GNUmakefile”的文件并将其放入其中：

```
include ${GNUSTEP_MAKEFILES}/common.make

TOOL_NAME = MyApp
MyApp_OBJC_FILES = code.m

include ${GNUSTEP_MAKEFILES}/tool.make 
```

然后我继续在提示符下输入“make”。输出写入到 obj\MyApp.exe

那是为我做的。用 gcc 命令行拧馅。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-21T10:02:05.733

Windows 的 GNUstep 安装过程

1.  访问网址： http: [//ftpmain.gnustep.org/pub/gnustep/binaries/windows/](http://ftpmain.gnustep.org/pub/gnustep/binaries/windows/)
2.  下载exe文件gnustep-system-0.19.2-setup.exe
3.  然后下载 gnustep-core-0.19.2-setup.exe 记住一件事，如果你正在下载任何版本的 gnustep-system，你必须为 gnustep-core 下载相同的版本。例如，如果您下载了 gnustep-setup-0.22.1-setup.exe，那么您必须下载 gustep-core-0.22.1-setup.exe，否则您的代码将无法运行。
4.  首先安装 gnustep-system-0.19.2-setup.exe，然后安装 gnustep-core-0.19.2setup.exe。不要试图以相反的顺序安装。
5.  现在你得到了 Windows 的 gnustep 然后去开始>所有程序> GNUstep> shell
6.  现在打开记事本编辑器并在记事本中编写以下代码：

.

```
#import 'Foundation/Foundation.h'

int main (int argc, const char * argv[])
{
    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
    NSLog (@"Anil Kumar Yadav has Run the First Objective C program!");
    [pool drain];

    return 0;
} 
```

将它保存为 hello.m 在您的 C:/GNUstep/home/foldername 记住文件夹名称是您第一次启动 shell 时的名称，它会创建环境并在 C:/GNUstep/home 中以您的计算机名称创建一个文件夹文件夹。所以不要惊慌。好吧

7.  转到您的外壳并键入以下命令 gcc -o hello hello.m -I /GNUstep/System/Library/Headers -L /GNUstep/System/Library/Libraries -lobjc -lgnustep-base -constant-string-class=NSConstantString
8.  此命令将在您的文件夹名称文件夹中创建一个 hello.exe 文件。
9.  再次在 shell 中键入命令 ./hello.exe 最后，您将能够在 shell 中看到输出。

恭喜你成功编写了你的​​第一个 Objective C 程序。需要任何澄清给我写信：ayadav00009@gmail.com

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T20:03:03.027

您需要告诉编译器 GNUstep 头文件和框架的位置。最简单的方法（至少在 Unix 系统上，老实说我没有在 Windows 上使用过 GNUstep）是使用 gnustep-make。你可以有一个简单的 GNUstep-make 文件

```
include $(GNUSTEP_MAKEFILES)/common.make

TOOL_NAME = hello
hello_OBJC_FILES = hello.m

include $(GNUSTEP_MAKEFILES)/tool.make 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T19:32:25.220

我的 GNUstep 安装在 c:\GNUstep\GNUstep\System 中。如果你的不同，你应该相应地更改 Foundation.h 的导入。

我这样做了：

1.  创建如下所示的 c:\myprogs\obj-c\hello\hello.m：

//------------ 你好.m

```
#import <../../GNUstep/System/Library/Headers/Foundation/Foundation.h>

int main(int argc, const char* argv[])
{
    NSAutoreleasePool* pool = [[NSAutoreleasePool alloc] init];
    NSLog(@"Hello from Hello.m!");

    [pool release];
    return 0;
} 
```

//------------

2.  启动 MinGW 外壳。（往上看。）

3.  在 shell 命令行上，切换到程序代码所在的目录。（请注意，由于这不是 Unix，因此必须包含 Windows 驱动器号。）：

    cd /c/myprogs/obj-c/hello

4.  编译程序：

    gcc -o hello hello.m -I/c/GNUstep/GNUstep/System/Library/Headers \

    -L /c/GNUstep/GNUstep/系统/库/库 -lobjc -lgnustep-base \

    -fconstant-string-class=NSConstantString

（请注意，“\”字符允许我们将命令扩展到多行。）

我在编译时收到以下信息性消息：

```
Info: resolving ___objc_class_name_NSAutoreleasePool by linking to __imp____objc_class_name_NSAutoreleasePool (auto-import)
Info: resolving ___objc_class_name_NSConstantString by linking to __imp____objc_class_name_NSConstantString (auto-import) 
```

运行产生的 hello.exe 给了我这个：

```
2009-06-03 14:44:59.483 hello[1240] Hello from Hello.m! 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-10-14T15:52:12.847

好的，我刚刚意识到整个 minw32、环境和 gnustep 核心开发的问题，以及为什么我的 make 文件无法在 Windows 环境中运行。因为我在安装软件包时没有使用该位置的默认选项。

根据默认选项，确保所有 3 个包都安装在文件夹结构中。我相信它始于 c:\GNUstep\

这解决了所有环境问题，例如：

Foundation/Foundation.h：没有这样的文件或目录

objc/Object.h：没有这样的文件或目录

希望能在那种糟糕的冗长情况下帮助其他人。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-04-27T16:25:34.417

对于我的问题，决定性信息是

```
-fconstant-string-class=NSConstantString 
```

从上面的buggieboy...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-02-23T15:53:31.463

我知道这是一个迟到的回应，但以下网站非常适合让您开始使用 GNUstep，并回答了上述问题和许多其他问题：

[http://www.gnustep.it/nicola/Tutorials/index.html](http://www.gnustep.it/nicola/Tutorials/index.html)

它帮助了我很多。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-04-29T00:22:40.247

我一直在用 Windows 下的 GNUStep 来解决这个问题。最简单的教程让你编写一个 C 程序并用 GCC 编译它——如果我想这样做，那么我就不会为 GNUStep 烦恼。下一个级别的教程做了一个 hello world，包括 Foundation 头文件和一个简单的 GNUmakefile 脚本，然后在 Windows 安装下它不起作用，因为您最终要遵循 GNUStep 说明。我知道打开它已安装的外壳，但是按照使用 GNUmakefile 文件的在线教程仍然无法正常工作。尝试包含通用 makefile 时，您会遇到一系列错误。

事实证明解决方案非常简单，只是没有告诉你这样做。安装程序尚未设置 GNUSTEP_MAKEFILES。如果您添加一个名为 GNUSTEP_MAKEFILES 的环境变量，其值为 /GNUstep/System/Library/Makefiles，然后重新打开 shell，则使用 GNUmakefile 脚本在源文件夹中运行 make 可以成功包含通用 makefile 等。

这足以让 makefile 构建一个包含 Foundation/Foundation.h 标头的简单控制台应用程序，这是个好兆头，尽管我必须进一步调查以查看是否还有其他尚未设置的设置会影响，比如说，GUI 方面的事情。

# php - 如何清理此 SELECT 查询？

> ID：587422
> 
> 赞同：2
> 
> 时间：2009-02-25T19:20:54.280
> 
> 标签：php, sql, mysql, user-defined-functions

我在具有完全根访问权限的专用服务器（Ubuntu Server 8.10）上运行 PHP 5 和 MySQL 5。我正在清理我继承的一些 LAMP 代码，并且我有大量使用这种构造的 SQL 选择：

```
SELECT ... FROM table WHERE
  LCASE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
    strSomeField, ' ', '-'), ',', ''), '/', '-'), '&', ''), '+', '')
  ) = $somevalue 
```

忽略这样一个事实，即数据库不应该被构造为首先需要这样的选择，并且需要参数化 $somevalue 字段以堵塞巨大的安全漏洞，我将 WHERE 条件修复为某事的最佳选择是什么不那么冒犯？如果我使用的是 MSSQL 或 Oracle，我会简单地组合一个用户定义的函数，但我对 MySQL 的经验比较有限，而且我以前没有用它构建过 UDF，尽管我很高兴编写 C 代码。

*更新：*对于所有已经在原始代码中对此感到惊讶的人来说，$somevalue 实际上类似于 $GET['product']——在主题上有一些变化。在这种情况下，选择是通过产品名称从数据库中拉回产品——在去除字符之后，它与之前可以作为 URI 参数传递的内容相匹配。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T19:37:06.160

> 将 WHERE 条件修复为不那么冒犯的最佳选择是什么？

在应用程序层进行替换，不需要将该逻辑放在数据库中。使它成为一个普通的旧 PHP 函数。

ETA：啊，我明白你的意思了。然后你就被塞满了，剩下的就是“数据库不应该被构建为首先需要这样的选择”！:-) 您*可以*将 REPLACE 移出存储产品（[CREATE FUNCTION](http://dev.mysql.com/doc/refman/5.0/en/create-procedure.html)）...这肯定会使查询看起来更好，但它确实将问题扫到了地毯下，因为它仍然需要扫描整个表并处理以进行 SELECT 查询。我不认为你可以在不改变架构的情况下做得更好，抱歉。

（我猜这是一个从文本标题中获取“已清理”ID 样式标记的函数？通常您确实会在普通的旧 PHP 函数中执行此操作，并将其存储为与“真实”不同的列标题。然后您可以轻松地选择它，并为性能编制索引。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T19:34:26.370

查看正则表达式库：

*   [http://forge.mysql.com/projects/project.php?id=86](http://forge.mysql.com/projects/project.php?id=86)
*   [http://udf-regexp.php-baustelle.de/trac/](http://udf-regexp.php-baustelle.de/trac/)

具体来说：

```
REGEXP_REPLACE?(text, pattern, replace ...) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T20:08:21.610

哦，亲爱的，这是一个有趣的。以下是它对 strSomeField 所做的事情的总结：

*   空格和正斜杠变成连字符
*   逗号、& 和加号被删除
*   转换为小写

如果不添加 MarkusQ 链接的 regexp_replace 用户定义函数，这在 MySQL 中是不容易做到的，我相信这需要重新编译 MySQL。

您是否可以选择简单地处理表中的所有数据，这样就没有必要了？创建一个 PHP 脚本来选择 strSomeField 中的所有值，执行与我上面总结的相同的处理，并使用新值更新行。或者这会破坏应用程序的其他部分吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T11:57:09.753

如果您确实使用预处理的 strSomeField 列创建了一个新字段，则应添加一个触发器，该触发器会在 strSomeField 更改时自动更新它。可能会消除一些头痛。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-31T05:13:19.393

> 去掉字符后，它匹配之前可以作为 URI 参数传递的内容。

哦。同样的陷阱一次又一次。

**不要使用产品名称作为关键字！**

你不觉得 SO 的作者没有你那么有经验吗？
但是看看 SO 问题的 url：stackoverflow.com/questions/587422/how-can-i-clean-up-this-select-query**他们**
使用 数字键，其余的只是为了装饰。 因此，可以随时编辑名称，但页面将保持不变。当然，没有像你这样的问题。

 **不是数据库问题。是设计问题。我想说的错。

# php - 使用 CURL 隐藏 IP 地址

> ID：587427
> 
> 赞同：2
> 
> 时间：2009-02-25T19:22:48.083
> 
> 标签：php, curl, libcurl

**类似**：[可以为每个 http 请求分配一个新的 IP 地址吗？](https://stackoverflow.com/questions/584272/possible-to-assign-a-new-ip-address-on-every-http-request)

* * *

当您向服务器发出请求时，是否可以使用 CURL 显示不同/欺骗的 IP 地址？如果没有，有没有其他方法可以使用 PHP 来欺骗您的 IP 地址？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T19:25:22.633

不。当然，除非您使用代理并通过它们路由您的流量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T19:25:30.493

如果您发出 TCP/IP 请求，另一端需要知道您的真实地址，否则您将永远不会收到回复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T19:26:35.890

如果您使用的是 TCP，则不会 - 在每个连接开始时使用 TCP 握手以确保双方都是他们所说的，所以除非您能够拦截服务器和欺骗主机之间的网络流量， 这是不可能的。

有关详细信息，请参阅[TCP 序列预测](http://en.wikipedia.org/wiki/TCP_Sequence_Prediction_Attack)。

# wpf - WPF 中的主窗口

> ID：587428
> 
> 赞同：1
> 
> 时间：2009-02-25T19:22:58.550
> 
> 标签：wpf, windows-client

我习惯于开发 ASP.net Web 应用程序，现在在 WPF Windows 客户端应用程序中进行一些探索。

我一直在广泛使用 MasterPage 和 Themes 来使我的应用程序具有统一的外观。

如何在 WPF 中完成相同的任务？这方面的最佳做法是什么？

对于初学者，我正在开发一个非常简单的应用程序，它有两个窗口，窗口顶部有一个菜单。由于此菜单将出现在每个窗口上，因此将菜单代码复制到每个窗口是没有意义的。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T19:33:54.623

ASP.NET 主题是关于视觉效果的样式。MasterPage 是关于控制可视化树的公共部分。这些是通过[样式和模板](http://msdn.microsoft.com/en-us/library/bb613570.aspx)在 WPF 中实现的。样式将使您能够控制所有视觉效果的统一外观。模板将允许您构建通用的视觉树并在不同的视觉元素中重用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T19:57:47.577

我在今年早些时候发现了这篇文章，它处理的问题与我的类似。 [模板窗口](https://stackoverflow.com/questions/420538/how-to-make-a-template-window-in-wpf)

# gps - 滚动您自己的 NMEA 解析器或使用开源 GPS 解析器？

> ID：587441
> 
> 赞同：12
> 
> 时间：2009-02-25T19:25:59.247
> 
> 标签：gps, parsing, nmea

我做了很多位置感知计算，通常包含 GPS。我有自己的小型简单 NMEA 解析器，它没有做任何特别的事情 - 只是将 GPS 特定的句子转换为可用的数字、标志等。

但是，在 GPSD 和 Gypsy 等项目上进行了很多积极的开发。如果 GPS 是一件简单的事情，这些项目早就完成了，只是进入了维护模式。

*   他们知道/做什么我不知道，因此我的代码不考虑？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-25T19:26:24.237

来自GPSD 负责人的[一篇优秀文章](http://esr.ibiblio.org/?p=801)：

*   NMEA 标准不提供带有误差、大地水准面和磁变化等的完整 TPV（时间、位置、速度）元组
*   由于不同的值在不同的句子中，并且没有定义的顺序，您无法轻易知道哪个速度与哪个位置报告对应
*   某些值未完整给出（即，年份是更常见和可用的句子中的两位数）
*   没有确定供应商、型号、固件的标准化方法
*   没有标准化的方法来更改设置（通信速度、报告的句子、每秒样本数等）
*   用于高级使用和更快报告的不兼容二进制协议
*   由于 USB 到串行桥接器和蓝牙到串行桥接器的有趣竞争条件，改变速度是一个非常棘手的问题

-亚当

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-03-18T11:59:24.150

我曾在 NMEA 工作过，我的经验是：

NMEA 格式设计得不好。可以直接访问 GPS 接收器的专业应用程序应避免使用 NMEA。他们应该考虑 GPS 设备的特定二进制格式。

除了上面亚当戴维斯提到的主题：

*   它没有定义如何处理无效属性：例如，如果车辆静止不动，特别是如果它在启动 GPS 接收器后没有移动，则航向/航向属性无效；大多数接收器将输出一个空属性“，”。但这是未定义的。
*   时间字段：一些供应商在秒后使用小数部分。如果允许的话，它没有完全指定（？）；有些设备会这样做，有些则不会。（进一步：GGA语句定义秒后两位数，RMC语句使用整数秒）
*   RMC、GSV 等句子的顺序从一个接收器到另一个接收器是不同的。这导致了知道定位何时完成的问题。要么你检查一个新的时间戳到达，然后你知道位置是完整的，但是你会失去一秒钟，就实时行为而言。或者你知道你的接收者，并且知道哪个是修复的最后一句话。或者你做一些“人工智能”来分析前十秒的顺序，然后你知道哪个是最后一个。

你可以查看 SIRF 和[UBLOX 协议规范](http://www.u-blox.com/images/downloads/Product_Docs/u-blox5_Protocol_Specifications%28GPS.G5-X-07036%29.pdf)，看看它们有哪些巨大的章节，来描述它们如何解释 NMEA 协议。

如果有人知道一个用 java 或 Objective-C 编写的非常好的 NMEA 解析器/编写器，它是开源的，并且不受 GPL 许可，请告诉我。

# compression - 有没有一种安全的方法来对两个 zip 压缩文件运行差异？

> ID：587442
> 
> 赞同：19
> 
> 时间：2009-02-25T19:26:11.680
> 
> 标签：compression, diff

似乎这不是确定性的事情，还是有办法可靠地做到这一点？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-25T19:29:56.350

如果您使用的是 gzip，则可以执行以下操作：

```
# diff <(zcat file1.gz) <(zcat file2.gz) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-25T19:28:36.027

可靠：解压缩两者，差异。

我不知道该答案是否足以供您使用，但它有效。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-26T16:07:07.000

通常，您无法避免解压缩然后进行比较。不同的压缩器会产生不同的 DEFLATEd 字节流，当 INFLATEd 产生相同的原始文本时。您不能简单地将 DEFLATEd 数据相互比较。在某些情况下这将失败。

*但在 ZIP 场景中*，每个条目都会计算并存储一个 CRC32。因此，如果您想检查文件，您可以简单地将存储的与每个 DEFLATEd 流相关联的 CRC32 与 CRC32 哈希的唯一性属性进行比较。比较 FileName 和 CRC 可能符合您的需要。

您需要一个 ZIP 库来读取 zip 文件并将这些内容作为“ZipEntry”对象的属性公开。DotNetZip 将为 .NET 应用程序做到这一点。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-01-18T15:53:41.783

**zipcmp**比较 zip 档案 zip1 和 zip2 并检查它们是否包含相同的文件，比较它们的名称、未压缩的大小和 CRC。文件顺序和压缩大小差异被忽略。

**sudo apt-get install zipcmp**

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-12-19T12:07:51.840

实际上 gzip 和 bzip2 都带有专门的工具来做到这一点。

使用 gzip：

```
$ zdiff file1.gz file2.gz 
```

使用 bzip2：

```
$ bzdiff file1.bz2 file2.bz2 
```

但请记住，对于非常大的文件，您可能会遇到内存问题（我最初来这里是为了了解如何解决它们，所以我还没有答案）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-25T19:30:50.857

[Beyond compare](http://www.scootersoftware.com/)对此没有任何问题。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-12-13T13:17:23.607

这不是特别优雅，但您可以使用 Mac OS X 开发人员工具附带的 FileMerge 应用程序，使用自定义过滤器比较 zip 文件的内容。

创建一个`~/bin/zip_filemerge_filter.bash`包含内容的脚本：

```
#!/bin/bash
##
#  List the size, CR-32 checksum, and file path of each file in a zip archive,
#  sorted in order by file path.
##
unzip -v -l "${1}" | cut -c 1-9,59-,49-57 | sort -k3
exit $? 
```

使脚本可执行 ( `chmod +x ~/bin/zip_filemerge_filter.bash`)。

打开 FileMerge，打开首选项，然后转到“过滤器”选项卡。将一个项目添加到列表中：扩展名：“zip”，过滤器：“~/bin/zip_filemerge_filter.bash $(FILE)”，显示：过滤，应用*：否。（我还添加了 .jar 的文件管理器和 .war 文件。）

然后使用 FileMerge（或命令行“opendiff”包装器）比较两个 .zip 文件。

这不会让您区分 zip 存档中文件的内容，但可以让您快速查看哪些文件出现在一个唯一的存档中，哪些文件存在于两个存档中但具有不同的内容（即不同的大小和/或校验和）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-12-23T12:16:29.427

这个简单的 Perl 脚本让我感到宽慰：[diffzips.pl](http://zarb.org/~gc/html/diffzips.html)

它递归地比较原始 zip 中的每个 zip 文件，这对于不同的 Java 包格式特别有用：jar、war 和 ear。

[zipcmp](http://www.nih.at/libzip/zipcmp.html)使用更简单的方法，它不会递归到存档的 zip 中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-09-12T15:32:02.583

zip文件的python解决方案：

```
import difflib
import zipfile

def diff(filename1, filename2):
    differs = False

    z1 = zipfile.ZipFile(open(filename1))
    z2 = zipfile.ZipFile(open(filename2))
    if len(z1.infolist()) != len(z2.infolist()):
        print "number of archive elements differ: {} in {} vs {} in {}".format(
            len(z1.infolist()), z1.filename, len(z2.infolist()), z2.filename)
        return 1
    for zipentry in z1.infolist():
        if zipentry.filename not in z2.namelist():
            print "no file named {} found in {}".format(zipentry.filename,
                                                        z2.filename)
            differs = True
        else:
            diff = difflib.ndiff(z1.open(zipentry.filename),
                                 z2.open(zipentry.filename))
            delta = ''.join(x[2:] for x in diff
                            if x.startswith('- ') or x.startswith('+ '))
            if delta:
                differs = True
                print "content for {} differs:\n{}".format(
                    zipentry.filename, delta)
    if not differs:
        print "all files are the same"
        return 0
    return 1 
```

用于

```
diff(filename1, filename2) 
```

它逐行比较内存中的文件并显示更改。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-25T19:48:08.380

[WinMerge](http://winmerge.org/)（仅限 Windows）具有许多[功能](http://winmerge.org/about/)，其中之一是：

> *   使用 7-Zip 归档文件支持

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-06-04T02:46:40.103

我放弃了尝试使用现有工具并编写了一个适合我的小 bash 脚本：

```
#!/bin/bash
# Author: Onno Benschop, onno@itmaze.com.au
# Note: This requires enough space for both archives to be extracted in the tempdir

if [ $# -ne 2 ] ; then
  echo Usage: $(basename "$0") zip1 zip2
  exit
fi

# Make temporary directories
archive_1=$(mktemp -d)
archive_2=$(mktemp -d)

# Unzip the archives
unzip -qqd"${archive_1}" "$1"
unzip -qqd"${archive_2}" "$2"

# Compare them
diff -r "${archive_1}" "${archive_2}"

# Remove the temporary directories
rm -rf "${archive_1}" "${archive_2}" 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-01-21T09:45:41.093

这里的许多解决方案要么仅检查 CRC 以查看是否*存在*差异，要么是复杂的脚本，要么需要解压缩到磁盘，使用外部程序，要么需要特定的压缩格式，而不是您所询问的格式（[zcat 不适用于邮编](https://superuser.com/a/1237855/241800)）。

这是一个简单，易于阅读，并且应该可以在任何你有 bash 的地方工作，它显示文件内容之间的差异，[如果像我一样，这是你遇到这个问题时需要的]：

```
diff \
    <(zipinfo -1 "$zip1" '*' \
    | grep '[^/]$' \
    | sort \
    | while IFS= read -r file; do unzip -c "$zip1" "$file"; done \
    ) \
    <(zipinfo -1 "$zip2" '*' \
    | grep '[^/]$' \
    | sort \
    | while IFS= read -r file; do unzip -c "$zip2" "$file"; done \
    ) 
```

这会在内存中解压缩，而不是在磁盘上解压缩，在管道发生差异时从管道中释放数据（它不会解压缩*然后*比较，因此不应该使用太多内存）。
想要更改忽略空格或并排使用的差异选项？更改`diff`为`diff -w`或`gvimdiff`（此选项会将所有文件保存在内存中）等等。
假设您只想区分`.js`文件？更改`*`为`*.js`。
只想查看其中一个或另一个缺少的文件名？删除`while`线，它不会打扰解压缩。

简单的。

它甚至可以安全地*处理*（跳过并将其记录到`stderr`）带有“非法”字符（如换行符和反斜杠）的文件名。
没有比这更“安全”的了。

slm 的答案非常适合返回不同的文件（没有显示差异），甚至根本不解压缩，这很好。如果由于某种原因您想要它但比 CRC 高出一步，那么在此答案中您可以在示例`| sha512sum`之前添加`; done`并获得“两全其美”：P

* * *

同样，比较存档和真实目录也相对容易：

```
diff \
    <(zipinfo -1 "$zip" '*' \
    | grep '[^/]$' \
    | sort \
    | while IFS= read -r file; do unzip -c "$zip" "$file"; done \
    ) \
    <(find "$directory" -type f -name '*' \
    | sort \
    | while IFS= read -r file
      do
          printf 'Archive:  %s\n  inflating: %s\n' "$directory" `echo $file | sed "s|$directory/||"`
          cat "$file"
          echo
      done \
    ) 
```

或者，仅忽略目录中的文件，基本上是一个方便的试运行`unzip -o -d "$directory"`：

```
diff \
    <(zipinfo -1 "$zip" '*' \
    | grep '[^/]$' \
    | sort \
    | while IFS= read -r file; do unzip -c "$zip" "$file"; done \
    ) \
    <(zipinfo -1 "$zip" '*' \
    | grep '[^/]$' \
    | sort \
    | while IFS= read -r file
      do
          printf 'Archive:  %s\n  inflating: %s\n' "$directory" "$file"
          cat "$directory/$file"
          echo
      done \
    ) 
```

* * *

视窗？对不起。虽然脚本很简单，并且可以轻松移植到 [语法上] 出色的 powershell，但它不起作用。本机 cmdlet[仅提取到磁盘](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/expand-archive?view=powershell-7)，MS*仍未*修复[PS 中损坏的二进制数据管道，](https://github.com/PowerShell/PowerShell/issues/1908)因此您也不能“安全地”以这种方式使用外部`zip.exe`。

[显然其他人直接使用 .NET API](https://stackoverflow.com/a/25154506/2518317)做了类似的事情，但它不再是一个优雅的端口，而更像是在 .NET 中的重新实现：|

* * *

[关于前面提到的“非法文件名”的注释：
如果您希望它*与*这些一起使用，实际上并不太难；你只需要交换`$file`.`$(echo "$file" | sed 's/\\/\\\\/g;s/\^J/\n/g;s/\^M/\r/g')`]

[当您遇到它们时添加其他[ctrl 字符。](https://en.wikipedia.org/wiki/Control_character#In_ASCII)]

[原因是，由于某种原因，即使在其中`zipinfo`显示一个文件名`\n`as `^J`，它也不会接受这些安全名称`unzip`，只接受原始名称！即使它可以提取到那些非法文件名，[`unzip -^`](https://linux.die.net/man/1/unzip)但根本无法通过这些原始文件名`zipinfo`。因此，您需要从安全的、不可用的文件名中构建原始的非法文件名，以便为 diff 引用它们 :(
如果这样做，请注意，无法区分`^J`字面意思和`\n`显示为`^J`，并且 zip 不支持`/`或`^@`在文件名中。]

* * *

作为奖励；您可以将所有这些差异直接写入存档，并将它们全部保存在与原始文件匹配的文件夹层次结构中，而不是试图一次全部读取。

```
(zipinfo -1 "$zip1"; zipinfo -1 "$zip2") \
    | grep '[^/]$' \
    | sort \
    | uniq \
    | while IFS= read -r file; do
        (diff <(unzip -p "$zip1" "$file") <(unzip -p "$zip2" "$file") | zip 'diff.zip' - \
        && zipinfo -s 'diff.zip' - | awk '{ print $4; }' | grep '[^0]' \
        && printf "@ -\n@=$file\n" | zipnote -w 'diff.zip' \
        || zip -d 'diff.zip' -
        ) >/dev/null
      done 
```

不是一个漂亮的脚本，但现在您可以在您选择的 gui 存档器中打开它`unzip -p diff.zip some/dir/some.file`，或者专门查看与该文件的差异，或者如果没有差异，则显示“未找到”，这在实践中更漂亮.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-07-12T19:00:09.610

我通常使用@mrabbit 之类的方法，但运行 2 个解压缩命令并根据需要区分输出。例如，我需要比较 2 个 Java WAR 文件。

```
$ sdiff --width 160 \
   <(unzip -l -v my_num1.war | cut -c 1-9,59-,49-57 | sort -k3) \
   <(unzip -l -v my_num2.war | cut -c 1-9,59-,49-57 | sort -k3) 
```

导致输出如下：

```
--------          -------                                                       --------          -------
Archive:                                                                        Archive:
-------- -------- ----                                                          -------- -------- ----
48619281          130 files                                                   | 51043693          130 files
    1116 060ccc56 index.jsp                                                         1116 060ccc56 index.jsp
       0 00000000 META-INF/                                                            0 00000000 META-INF/
     155 b50f41aa META-INF/MANIFEST.MF                                        |      155 701f1623 META-INF/MANIFEST.MF
 Length   CRC-32  Name                                                           Length   CRC-32  Name
    1179 b42096f1 version.jsp                                                       1179 b42096f1 version.jsp
       0 00000000 WEB-INF/                                                             0 00000000 WEB-INF/
       0 00000000 WEB-INF/classes/                                                     0 00000000 WEB-INF/classes/
       0 00000000 WEB-INF/classes/com/                                                 0 00000000 WEB-INF/classes/com/
...
... 
```

# php - 如何使用 PHP 获取表单身份验证票的内容

> ID：587450
> 
> 赞同：1
> 
> 时间：2009-02-25T19:27:51.847
> 
> 标签：php, .net, forms-authentication

我需要撤消 PHP 中的以下 ASP.Net 进程，以便我可以获取票证中的用户名和到期日期。我已经解密了 3DES 加密（下面的第 3 步），但我不确定接下来需要做什么。解密产生的字符串是字节数组吗？我应该能够将其转换为ascii吗？（因为它没有）。

ASP.Net 为创建票证所做的工作：

1.  序列化用户名、过期时间、其他数据（我不关心）。创建一个字节数组。
2.  使用 SHA1 签署票证（sig 是最后 20 个字节）
3.  使用 3DES（我未加密）加密票证。

我回来的东西看起来像这样：

> 6E 85 A4 39 71 31 46 BB A3 F6 BE 1A 07 EE A4 CE 5F 03 C8 D1 4C 97 5D 6A 52 D1 C4 82 75 5E 53 06 7B 1D D2 4D BF 22 40 F7 F4 B8 8D B0 C3 EC E5 BE F7 52 C2 DF 00 7A D1 CB BC 76 4B 10 33 2D 1A B4 15 A7 BB D6 9D BF 41 69 D2 C4 43 4A 26 95 01 F2 06 AA 46 2C 96 CC AD DC 08 59 C0 64 B6 EE 2C 5F CA ED 8B 92 1C 80 FD FF DC 61 67 28 59 CB E6 71 C6 C3 72 0E D0 32 69 22 57 4E 40 2B DA 67 BA 7F F1 C5 78 BC DF 80 8C D8 F2 8B 19 E2 A4 4F 7C 8C D9 97 37 BD B5 5 0A 66 9B DD E7 直流 7B 78 F4 F8

它不映射到ascii，接下来我该怎么办？我有 SHA1 验证密钥。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T20:48:36.817

我不认为这是可能的...

**几个前置问题：**

*   您确定使用正确的`MachineKey`值和解密算法正确解密了字符串吗？我知道 ASP.NET 1.0 使用 3DES，但较新的版本通常默认使用 AES。
*   你为什么首先访问这些数据？`FormsAuthenticationTicket`并不是要“破坏”，如果您打算从不同的语言访问这些值，您可以考虑推出自己的方案。

**一些值得注意的观察结果：**

Buried`in FormsAuthentication.Decrypt()`是对`UnsafeNativeMethods.CookieAuthParseTicket(...)`. 这是签名：

```
[DllImport("webengine.dll", CharSet=CharSet.Unicode)]
internal static extern int CookieAuthParseTicket(byte[] pData, int iDataLen, StringBuilder szName, int iNameLen, StringBuilder szData, int iUserDataLen, StringBuilder szPath, int iPathLen, byte[] pBytes, long[] pDates); 
```

`MachineKeySection.HexStringToByteArray()`这会将看起来像是从（显然是使用 UTF-8 解码字符串的函数）返回的字节数组解析为`FormsAuthenticationTicket`.

我只能假设，无论您使用哪种解码方法（ASCII、UTF-16 等），除非您知道 Microsoft 的实现隐藏在此本机方法中，否则您不会取回数据。

[MSDN](http://msdn.microsoft.com/en-us/library/ms998288.aspx#paght000007_formsauthenticationtickets)也可能提供一些帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T13:27:13.340

我一直在努力，我已经设法在 PHP 中获取表单身份验证票的内容。

1.  使用用于在 .Net 端加密票证的相同密钥解密票证。为此，我正在使用[http://www.navioo.com/php/docs/function.mcrypt-encrypt.php](http://www.navioo.com/php/docs/function.mcrypt-encrypt.php)。

2.  解密将填充添加到字符串的末尾，我将其删除。

3.  最后我留下了一个带有 20 字节 SHA1 哈希的字符串。最后 20 个字节（应该）匹配字符串第一部分的 SHA1 哈希（字符串长度 - 20 个字节）。我仍在研究这部分，试图弄清楚 .NET 如何将字节数组转换为可以进行 SHA1 哈希处理的单个数据块（所以我可以在 PHP 端做同样的事情）。

这就是它的全部。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-18T13:10:48.430

对于其他想要这样做的人，请注意 ASP.NET 使用的 AES 加密始终为 16 字节块大小，即 PHP mcrypt 术语中的 MCRYPT_RIJNDAEL_128，并使用 CBC 模式。密钥长度（ASP.NET 默认为 32 字节/256 位）由 PHP 根据提供的实际密钥确定。此外，除非IV全为零（即“\0\0\0\0\0\0\0\0\0\0\0\0\0\0\ 0\0")。

有关解码数据的更多信息，请参阅： http: [//www.codeproject.com/KB/aspnet/Forms_Auth_Internals.aspx](http://www.codeproject.com/KB/aspnet/Forms_Auth_Internals.aspx)

# .net - 如何使用代码协定指示方法永远不会返回 null？

> ID：587452
> 
> 赞同：1
> 
> 时间：2009-02-25T19:28:07.167
> 
> 标签：.net, .net-4.0, code-contracts, microsoft-contracts

如何指示方法从不返回 null？目前这是我的代码。

第 19 行得到一条 Ensures notroved 消息，即使 CreateFunction 假定结果不是空的。

```
1         <Pure()> Public Function CreateFunction(Of TArg1, TArg2, TResult)(ByVal body As Func(Of Expression, Expression, BinaryExpression)) As Func(Of TArg1, TArg2, TResult)   
2             Contract.RequiresAlways(body IsNot Nothing)   
3             Contract.Assume(Contract.Result(Of Func(Of TArg1, TArg2, TResult))() IsNot Nothing)   
4   
5             Dim arg1 = Expression.Parameter(GetType(Integer), "arg1")   
6             Dim arg2 = Expression.Parameter(GetType(Integer), "arg2")   
7   
8   
9             Dim temp = Expression.Lambda(body(arg1, arg2), arg1, arg2)   
10             Contract.Assume(temp IsNot Nothing)   
11             Return DirectCast(temp.Compile, Global.System.Func(Of TArg1, TArg2, TResult))   
12         End Function  
13   
14         <Pure()> Public Function Add() As Func(Of T, T, T)   
15             Contract.Ensures(Contract.Result(Of Func(Of T, T, T))() IsNot Nothing)   
16   
17             Dim temp = CreateFunction(Of T, T, T)(AddressOf Expression.AddChecked)   
18             Return temp   
19         End Function 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T19:54:46.213

做

```
Contract.Ensures(Contract.Result() != null); 
```

工作？基本上，我会尝试减少它，直到你找到最简单的情况，它不能像你期望的那样工作，然后从那里开始。

——马库斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T22:01:05.510

您需要将`Assume`in更改`CreateFunction`为`Ensures`. 在那之后你应该没事。请记住，`Assume`是为了在本地帮助静态检查器进行内部假设。它们在其他方法中是不可见的。只有`Requires`和`Ensures`是跨方法合约。

# android - 按文件名显示图像

> ID：587454
> 
> 赞同：3
> 
> 时间：2009-02-25T19:28:22.797
> 
> 标签：android, imageview

我需要通过指定文件名而不是使用资源来显示图像。例如`showImage("background.png")`，而不是`showImage(R.drawable.background)`.

有谁知道怎么做？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T19:36:57.160

阅读此[Android 图像教程](http://www.developer.com/java/j2me/article.php/10934_3748281_1)。有一个使用 FileOutputStream 写入图像的示例，我确定也有 FileInputStream。这是[另一个下载图像并将其转换为已解码的 Inputstream 的代码示例](http://getablogger.blogspot.com/2008/01/android-download-image-from-server-and.html)：

```
bmImg = BitmapFactory.decodeStream(is);
imView.setImageBitmap(bmImg); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-12T08:05:52.917

> public static Bitmap decodeFile (String pathName, BitmapFactory.Options opts)

这些选项不是强制性的，但如果您想显示大图像，您也应该提供它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-19T10:08:45.847

您可以使用以下方法从资源文件夹中使用其名称获取图像。

```
public int getImage(String imageName) {
    return this.getResources().getIdentifier(imageName, "drawable", this.getPackageName());
} 
```

# regex - 如何扩展 Perl 字符串中的变量？

> ID：587457
> 
> 赞同：-2
> 
> 时间：2009-02-25T19:28:50.860
> 
> 标签：regex, perl, string

我正在尝试`$searchCriteria`在 if 条件下扩展字符串。有什么线索吗？

```
use strict;

my $argNum;
my $searchCriteria = "";
foreach $argNum (0 .. $#ARGV) {
    $searchCriteria = $searchCriteria . "(\$_ =~ \/" . $ARGV[$argNum] . "\/i) && ";
}
$searchCriteria =~ s/&& $//; 
#print $searchCriteria;

open IP, "<vm.txt" or die $!;

my @fileContents = <IP>;
foreach (@fileContents) {
    if (${$searchCriteria}) {
        print $_;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T20:11:51.040

如果您的搜索条件是正则表达式，您应该准备自己的编译正则表达式。还要注意使用 while 循环（读取文件时）以避免过多的内存使用。如果您想要包含任何参数的行：

```
use strict;
use warnings;

my $searchRe = do {
  my $searchCriteria = join '|', map "(?:$_)", @ARGV;
  qr/$searchCriteria/i;
};

open my $fh, '<', 'vm.txt' or die $!;

while (<$fh>) {
  print if m/$searchRe/;
}

close $fh; 
```

或者如果您想要包含所有行的行：

```
use strict;
use warnings;

my $searcher = do {
  my @searchCriteria = map qr/$_/i, @ARGV;
  sub {
    # study; # study can help for long lines or lot of regular expressions
    for my $re (@searchCriteria) {
      return unless m/$re/;
    }
    return 1
  }
};

open my $fh, '<', 'vm.txt' or die $!;

while (<$fh>) {
  print if $searcher->();
}

close $fh; 
```

（请注意，如果命令行参数是字符串而不是正则表达式，您可能需要一个`\Q`和`\E`周围。）`$_`

最后，如果您想提高许多搜索条件的速度，请使用[Regexp::Optimizer](http://search.cpan.org/perldoc?Regexp::Optimizer)。

```
use Regexp::Optimizer;

my $searchRe = do {
  my $searchCriteria = join '|', map "(?:$_)", @ARGV;
  Regexp::Optimizer->new->optimize(qr($searchCriteria)i);
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T19:31:11.073

嗯......我不确定问题是什么......但不知何故我怀疑你需要 qr// 表达式（引用的正则表达式）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T20:32:17.167

看起来您想评估该行是否包含`@ARGV`.

我认为这可能更符合您正在寻找的内容，并且也更适合 perl 人群。

```
use FileHandle;
use List::MoreUtil qw<all>;

my @regexes = map { qr/\L$_\E/i } @ARGV;

my $fh = FileHandle->new( '<vm.txt' );
die "Err: $!" unless $fh;

foreach my $line ( <$fh> ) { 
    print $line if all { $line =~ m/$_/i } @regexes;
} 
```

当然，如果您想要一些压缩，因为您将在一次执行中一次又一次地执行测试，您可以为此创建一个子。

```
sub create_compound_test { 
    my $test_sub_text = "sub (_) {\n    local \$_ = shift;";

    foreach my $arg ( map { lc; } @_ ) { 
        $test_sub_text .= "\n    return unless m/$arg/i;";
    }
    $test_sub_text .= "\n    return 1;\n}";

    my $test_sub = eval $test_sub_text;
    Carp::croak "Could not create test:\n $test_sub_text - $@" if $@;
    return $test_sub;
} 
```

它做同样的事情`$_ =~ /blah/i && $_ =~ /blah2/ ...`

那么它将是：

```
my $match_all = create_compound_test( @ARGV );
foreach ( <$fh> ) { 
    print if $match_all->();
} 
```

但我可能更有可能这样做：

```
my $match_all = create_compound_test( @ARGV );
foreach ( grep { $match_all->(); } <$fh> ) { 
    print;
} 
```

...甚至...

```
print foreach grep { $match_all->(); } <$fh>; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T19:44:57.017

你有什么问题？也许您正在寻找[ack](http://search.cpan.org/dist/ack)？似乎您正在尝试[评估](http://perldoc.perl.org/functions/eval.html)字符串（通常是一个坏主意）。您至少应该使用 qr//。也许是这样的：

```
my @regexs = map qr/(?i)$_/, @ARGV;
my $search = sub {
  for my $re (@regexes) {
    return unless /$re/;
  }
  return 1;
}
open IP, "<", "vm.txt" or die "Err: $!";
while (<IP>) {
  print $_ if $search->();
} 
```

这很容易得到改善。而且它没有经过测试。YMMV。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T22:18:17.710

如果参数不是正则表达式，您可以构造一个可以工作的正则表达式。

这个想法是以下顺序：

1.  交替`(one|two|...)`
2.  其次是非贪婪的任何东西`(.*?)`
3.  其次是匹配交替#1的负前瞻`(?!\1)`
4.  接着是反复交替`(one|two|...)`
5.  其次是非贪婪的任何东西`(.*?)`
6.  然后是与最后一个交替匹配的交替的负前瞻`(?!\1|\2)`

重复 4-6，直到我们找到所有术语的匹配项。

所以构造它的代码是：

```
sub create_compound_match { 

    my @args          = @_;
    my $arg_limit     = $#args; 
    my $expr          = join( '|', map { lc; } @args );
    my $neg_lookahead = join( '|', map { "\\$_" } 1..$arg_limit );

    my $test = join( '.*?'
                   , "($expr)"
                   , ( map { '(?!' 
                           . substr( $neg_lookahead, 0, 3 * $_ - 1 ) 
                           . ")($expr)" 
                           } 1..$arg_limit 
                      )
                   );

    return qr/$test/i;
} 
```

将以这种方式进行测试：

```
my $test = create_compound_match( @ARGV );
print foreach grep { /$test/i } <$fh>; 
```

然而，这缺乏在命令行上传递正则表达式的能力`@ARGV`可以等于 qw，并且生成的正则表达式会很高兴地匹配 'a aa aaa aaaa' 而不需要匹配`b*`，因为 "aa" != "a"，所以满足负前瞻。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T07:49:05.887

在查看了[Hynek -Pichi- Vychodil 的回答](https://stackoverflow.com/questions/587457/expand-string-inline-in-perl/587642#587642)后，我意识到您可以使用 List::MoreUtil 的子例程大大简化整个任务`all`。我强烈推荐这个包。

```
use strict;
use warinings;
use List::MoreUtil qw/all/; # if installed (not a bad idea to get it if not)

my @regexen = map { qr/$_/i } @ARGV;

open my $fh, '<', 'vm.txt' or die $!;

foreach my $line (<$fh>) { 
    print $line if all { $line =~ $_ } @regexen;
};

close $fh; 
```

替换`all`为`any`基于“或”的匹配。

编辑：该死，看起来 Axeman 发布了与此非常相似的内容。伟大的思想都一样，是吗？:)

# java - 在 Java 中实现 Mixin？

> ID：587458
> 
> 赞同：57
> 
> 时间：2009-02-25T19:29:22.560
> 
> 标签：java, mixins

使用 Java 6，如何实现[mixin](https://en.wikipedia.org/wiki/Mixin)？这在 Ruby 中非常简单且可行。我怎样才能在 Java 中得到类似的东西？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-26T18:36:33.163

您可以为此使用[CGLIB](http://cglib.sourceforge.net/)。[Mixin](http://cglib.sourceforge.net/apidocs/net/sf/cglib/Mixin.html)类能够从多个接口/对象委托生成动态类：

```
static Mixin    create(java.lang.Class[] interfaces,
                        java.lang.Object[] delegates)
static Mixin    create(java.lang.Object[] delegates)
static Mixin    createBean(java.lang.Object[] beans) 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-12-21T15:19:10.930

# 默认方法

我知道 Java 6 的问题，但在 Java 8 中我们将有一个相当不错的选择：[默认方法](https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html)。

我们将能够添加接口方法的“默认”实现，因此我们可以添加新方法而不会破坏实现接口的每个类。

只要你的 mixin 不需要状态，你就可以在接口中编写代码。然后你的类可以实现任意数量的这些接口，并且繁荣，[你有 mixins](http://kerflyn.wordpress.com/2012/07/09/java-8-now-you-have-mixins/)。

这是滥用系统吗？一点点，但它不会涉及任何多重继承问题，因为没有状态。

当然，这也是这种方法最大的缺点。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-25T23:16:06.727

我想说只使用对象组合。每次你想加入新功能时，将另一个对象作为成员组合到类中。如果你想让你的所有混合类都具有相同的类型，你可以使用一个数组作为成员对象，其中每个元素都由所有其他元素组成，并且你可以分派到一个特定的元素。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-25T19:37:26.737

由于 Java 只支持单继承，这是不可能的。看看[WP: Mixin](http://en.wikipedia.org/wiki/Mixin)。

**编辑**：由于关于接口的评论：mixins 的酷之处在于您可以组合它们而无需编写组合代码。使用接口，您必须自己实现组合的功能（除了一个可以扩展的类）！

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-08-12T16:39:23.730

最简单的方法是使用静态导入。它允许代码重用“看起来”像是类的一部分，但实际上是在其他地方定义的。

优点：

*   真的很容易
*   您可以“混合”任意数量的静态导入

缺点：

*   静态方法无法访问“this”，因此您必须手动传递它
*   无状态：您的静态方法不能有自己的实例字段。他们只能定义自己的静态字段，然后由调用静态方法的任何对象共享。
*   无法在客户端类上定义公共方法（其中混入了代码）。在 Ruby 中，导入 mixin 实际上会将这些公共方法定义为类上的公共方法。在 Java 中，在这种情况下继承会是更好的解决方案（假设您不需要扩展多个类）

例子：

```
import static my.package.MyHelperUtility.methodDefinedInAnotherClass;

public class MyNormalCode {
    public void example() {
        methodDefinedInAnotherClass();
    }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-25T19:40:42.673

从某种意义上说，Ruby mix-in 等同于 Java 抽象类，不，您不能在 Java 中实现 mix-in。您可以通过使用接口来接近并因此在您的混入中绝对不定义任何代码，但是您不能直接实现与在 Ruby 混入中相同的行为。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-11-03T11:41:19.057

## 更新：Qi4j 现在是 Apache Polygene，[https ://polygene.apache.org](https://polygene.apache.org)

Qi4j 对 Mixins 的定义可能非常独特，因为它不是从基类开始的。通过走向这个极端，一个全新的应用程序构建范式出现了，我们称之为面向复合编程。Composite 是“对象”等价物，不仅将 Mixins 连接在一起，而且还有 Constraints（验证）、Concerns（围绕建议）和 SideEffects（不能改变方法结果）。

所以我认为 Qi4j 有一个非常强大的 Mixin 故事要讲。Mixin 可以是“类型化的”或“通用的”，它们可以是公共的（可在组合外访问）或纯私有的（在组合内）。Qi4j 强烈定义了属性是什么，并继续具有内置的持久性，它不会将存储实现泄漏到您的域中（警告；Qi4j 泄漏到您的域）。并且一旦持久实体进入图片，还需要对关联的强定义（并包含在 Qi4j 中）。

请参阅[http://www.qi4j.org/state-modeling.html](http://www.qi4j.org/state-modeling.html)以获得良好的概述。

在 Qi4j 中，只有 Mixins 有状态。Constraints/Concerns/SideEffects 不能有状态（如果有的话，他们需要引用私有 mixin）。

要在 Qi4j 中定义组合，可以在类型本身的结构上进行，或者在创建运行时模型时在引导时进行。

结构上；

```
`@Mixins({PetrolEngfineMixin.class, FourWheelsMixin.class})
public interface Car extends HasEngine, HasWheels, EntityComposite
{}` 
```

`在启动时；`

```
``public interface Car
{}

public class CarModuleAssembler 
    implements Assembler
{
    public void assemble( ModuleAssembly module )
    {
        module.entities( Car.class )
           .withMixins( PetronEngineMixin.class, FourWheelsMixin.class );
    }
}`` 
```

``然而，这只是触及 Qi4j 中特征的表面。``

 ``* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-25T21:52:50.483

看看[http://code.google.com/p/javadude/wiki/AnnotationsMixinExample](http://code.google.com/p/javadude/wiki/AnnotationsMixinExample)

它使用了我创建的一组注释。

注意：我正在对注释进行重大更新，其中包括一些 API 损坏。我计划在接下来的几周内发布一个新版本。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-08-17T00:08:18.233

刚刚遇到：[https](https://blog.berniesumption.com/software/mixins-for-java/) ://blog.berniesumption.com/software/mixins-for-java/（Borken 链接已更新）

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-02-01T16:07:44.027

您现在可以[**使用 AspectJ ITDs 使用 Java（即 5、6、7）进行 Mixins**](https://stackoverflow.com/questions/7403321/what-is-a-short-example-of-inter-type-declarations-in-aspectj-which-demonstrates/7403617#7403617)。Java 8 当然会通过其防御方法添加更好的功能。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-25T19:39:45.390

在 Java 中伪造 mixins：http: [//jonaquino.blogspot.com/2005/07/java-mixin-pattern-or-faking-multiple.html](http://jonaquino.blogspot.com/2005/07/java-mixin-pattern-or-faking-multiple.html)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-05-14T17:23:21.660

不确定您正在寻找 mixins 的哪些功能，但其中大部分功能都可以使用装饰器模式来完成。

[http://en.wikipedia.org/wiki/Decorator_pattern#Java](http://en.wikipedia.org/wiki/Decorator_pattern#Java)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-05-28T23:03:16.987

我正在探索为 Java 7 提供此功能。我的第一个切入点是使用本文中显示的示例：

*   [**纯 java 中的 Mixins**](http://java.dzone.com/articles/mixins-pure-java)

它应该适用于 java 6，它类似于上面的其他注入选项。根据我在 C# 和 Ruby 中使用 Mixins 的经验，您应该致力于实现 mixins，而不仅仅是模拟或伪造它。

另一种模型是与[Jackson](http://wiki.fasterxml.com/JacksonHome)一起使用的模型：

*   [Jackson MixIn 注释](http://wiki.fasterxml.com/JacksonMixInAnnotations)

如果您可以使用新的 Java 8 版本，比如说您处于预发布模式，那可能会有所帮助。

*   [**Java 8：你现在有 mixin 了吗？**](http://kerflyn.wordpress.com/2012/07/09/java-8-now-you-have-mixins/)

使用 Virtual Extension 方法，这需要努力 ' *be-a* ' mixin。所以在我看来，这还为时尚早，我更喜欢第一个链接提供的更简洁的方法（或类似方法）。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-08-19T09:35:52.253

是的，在 Java 中实现 mixins 方法最简单、最方便的方法是从包含静态方法的某个类中使用静态导入。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-01-13T09:25:41.593

在面向方面的编程运动中，术语“混合”不等同于 Java 术语“方面”吗？AspectJ 可能值得一看。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-02-09T18:36:09.573

一个老问题的答案。

我看了看 Apache Zest。也许只有我一个人，但我发现这些例子有点麻烦。我不能完全理解这一点。另一种选择可能是对象团队。

但我建议你可以看看这个 repo：

[https://github.com/Mashashi/javaroles/](https://github.com/Mashashi/javaroles/)

它可能部分涵盖了您想要做的事情。看起来很简单。

这是一个例子：

定义角色的接口：

```
public interface Human {
String hello(); 
String die(String age);  
String eat();
String dance();
}

public interface Monkey {String hello(); String eat();} 
```

定义刚性类型 AnimalRoles...

```
public class AnimalRoles implements Human, Monkey{

public static final String HALLO = "Default hallo";
public static final String DIE = "Default they kill me...";
public static final String EAT = "Default eat...";

@ObjectForRole public Human human;

@ObjectForRole public Monkey monkey;

public AnimalRoles(Human human, Monkey monkey){
    this.human = human;
    this.monkey = monkey;
    if(this.human!=null){
        ((Portuguese)this.human).core = this;
    }
}

@Override
public String hello() {
    return HALLO;
}

@Override
public String die(String age) {
    return DIE+age;
}

@Override
@TurnOffRole
public String eat() {
    return EAT;
}

@Override
public String dance() {
    return "Just dance";
}

public String notInRole(){
    return "Oh oh";
}
} 
```

定义类角色 Bonobo...

```
public class Bonobo implements Monkey{
public Bonobo() {}

@Override
public String hello(){
    return "Ugauga";
}

@Override
public String eat() {
    return "Nhamnham";
}

} 
```

定义阶级角色葡萄牙语...

```
@RoleObject(types = { AnimalRoles.class })
public class Portuguese implements Human{

public static final String HALLO = "Hey there";
public static final String DIE = "They killed me";
public static final String EAT = "Eating boiled pork now";

public AnimalRoles core;

public Portuguese() {}

@Override
public String hello() {
    return HALLO;
}

@Override
public String die(String age) {
    return DIE+age;
}

@Override
public String eat() {
    return EAT;
}

@Override
public String dance() {
    return core.dance()+" modified!";
}

} 
```

运行测试...

```
new RoleRegisterComposition().registerRools();
AnimalRoles a = new AnimalRoles(new Portuguese(), new Bonobo());
System.out.println(a.hello());
System.out.println(a.dance()); 
```

会打印...

```
"Hey there"
"Dance modified!" 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-02-29T09:55:56.897

请看一下我的小型演示项目如何使用 cglib 在纯 java 中创建 mixins。主要它只是对代理生成器的调用。这是盟友。该示例包含一个 junit 测试用例，演示如何实例化代理。

[https://github.com/literadix/JavaMixins](https://github.com/literadix/JavaMixins)

# sharepoint - 开发人员文档：Sharepoint 文档管理与ScrewTurn Wiki

> ID：587481
> 
> 赞同：17
> 
> 时间：2009-02-25T19:35:41.093
> 
> 标签：sharepoint, documentation, moss, wiki

### 背景信息

我正在为我公司的开发人员建立一种方法来共享有关我们各种内部系统的文档和信息。范围从有助于使新员工加快速度的信息，到用户对系统及其解决方案的常见问题的描述。

对我来说，这似乎是 wiki 的理想工作，而且由于我们公司只能托管 ASP.NET 应用程序，因此我着手研究可用的 ASP.NET wiki。[ScrewTurn Wiki](http://www.screwturn.eu/)似乎是最合适的一个，它功能非常齐全，并且有几个可用的插件对我的情况很有用，包括语法突出显示和 AD 集成。

然而，在开始将ScrewTurn 部署到我们的Intranet 的过程时，突然想起，嘿，Sharepoint 2007 有一个wiki，既然我们已经设置了Sharepoint，我们就不能使用它吗？我对 Sharepoint “wiki” 做了一些评估（在引号中，因为它几乎不合格），并且能够证明它不适合由于它的许多缺陷，我不会在这里列出。

现在，有人建议我可能根本不需要 wiki，我们不能只在 Word 文档中做所有事情并使用 Sharepoint 的文档管理功能吗？

### 实际问题

所以我要找的是一些额外的弹药，最好是有经验的人。在内部开发人员文档的上下文中，使用 Sharepoint 会遇到哪些困难或不可能的事情有哪些示例？wiki 擅长什么？嘿，我思想开放，Sharepoint 擅长什么？

**是什么让部署 wiki 而不是简单地使用我们已有的东西值得？**

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-04T15:27:53.237

我希望这会有一些用处 - 加分与否:)

如果您正在处理办公文档，SharePoint Server (SPS) 或 Windows SharePoint Services (WSS) 非常好 - 您可以版本、签入/签出、共享、搜索等。我认为市场上没有任何东西可以接近该功能（它还可以很好地完成自定义列表和东西）。

但是正如您所指出的，WIKI 功能是不合标准的。

对于开发人员文档，wiki 更好，因为您可以轻松地链接文档，即使开发人员倾向于喜欢 wiki 标记的唯一原因！让人感觉他们在写代码，而不是文档。嗯，好的，我喜欢。Word文档？无尽的挫败感，尤其是对于代码片段和 API 之类的东西。Wiki 通常非常非常好地处理代码和结构化格式。

但这是我发帖的重点：

如果您可以托管 ASP.NET - 如果您有 SPS，那么您已经可以了！- 然后只需安装它们。制作一个新的 IIS 虚拟主机，将 STW 放入其中（'cos SPS 将在它自己的虚拟主机中）*。稍微按摩一下DNS（这样你就可以点击`http://wiki`或其他东西），然后就去做。

由于这都是您公司内部的，而且 STW 具有 Windows 安全性和版本，因此安全性不是一个大问题。每个页面都可以从任何地方链接到 - 毕竟它是一个 HTML 页面 - 所以如果你真的想要的话，你可以从 SPS wiki 链接到它。我猜有一些锁定，但不是很多。

在 BBC Worldwide，我们使用了多种技术：

*   Atlassian Confluence (WIKI) 用于某些项目。我喜欢这个 wiki，但它是一个大型企业系统。
*   拧转一些部门内的东西。
*   Trac 其他一些东西（其他人在我们的源代码库上使用 SVN 设置它，所以它使用了一点 - 很好，我更喜欢它，但它是 aa*se 设置）
*   用于文档管理的 SPS/WSS。

STW、Trac 和 SPS 之间存在链接 - 例如，我们尽量不将文档作为附件存储在 trac 中，而是在 SPS 中链接到它们等。

效果很好。

至于弹药：如果 SPS 适合您想要做的事情（或者您可以适合 IT 做的事情），它会很好地工作。如果没有，你要么搞砸了，要么需要做很多开发，这真的是一回事:)

但是除了管理层对此感到很有趣之外，我看不出同时安装两者有什么问题。STW毕竟是免费的。您有服务器。

并且它得到了开发者的写作文档，这很少是一件坏事。好吧，如果真人必须阅读它是一件坏事，但是其他开发人员的文档呢？都好。

*注：虚拟主机。不是虚拟目录。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-25T19:45:44.020

我都做过。经历了这些之后，我的建议是：

*   如果您需要 WYSIWYG 并且不关心 Sharepoint 的臃肿和缺乏功能（wiki 很简单，但具有您在 wiki 中需要的主要功能），那就去吧。它作为一个 wiki 工作，并在业务人员需要访问 wiki 时提供帮助——教他们使用它等的时间要少得多。
*   如果您可以使用准系统并且只想要一个快速灵活的简单 wiki，那么您将无法击败螺旋式。

至于为什么要使用 wiki，无论是螺丝转还是 sharepoint——它都胜过 Sharepoint 中的 word 文档。要使用 Sharepoint，首先您必须下载文档、编辑、上传或使用最好的 Office 集成。Wiki 消除了所有的摩擦并使更新变得非常简单。消除摩擦是关键，因为当您必须使用 word 文档时，您最终只是没有像应有的那样经常更新它们。使用 wiki，这是一个 2 秒的弹出/编辑/保存事务。使用 word doc，加载 word、打开 doc、编辑、担心格式、保存等需要几分钟。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-10T20:29:13.103

嘿，我在这里有经验。我们开始在工作中使用ScrewTurn，但由于公司已经购买了SharePoint，我们被要求更换。文档质量下降是因为 Word 文档无法与 wiki 匹敌，而且正如其他人所指出的，SharePoint 的文档不符合标准。

在我看来，没有什么比 wiki 更适合文档了。我认为这主要是创建指向尚不存在的页面的链接的能力。这样我就可以删除文档，其余的根据需要填写。它使文档更加简洁和可读。

对于 Word 文档，不太可能使用超链接，但它对文档的可读性非常有帮助。我可以继续...

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-04T16:06:42.910

概括地说，对于技术文档来说，word 是相当糟糕的。因为它对于大型的结构化文档的效果很差，所以它鼓励了小文档的扩散，而文档之间没有交叉引用。将其放大到任何显着大小，您将很难找到与您正在尝试调查的问题相关的文档。随着时间的推移，您会发​​现人们浪费越来越多的时间在一堆乱七八糟的 word 文档、电子表格、visio 图表甚至是 powerpoint 演示文稿中寻找可能会或可能不会记录的信息。

将它们放入共享点只会迫使您通过浏览器路由搜索。

任何技术文档工具都必须支持文档之间的交叉引用以避免丢失这些引用。wiki 比 word 更能做到这一点。此外，将生成的内容（如数据字典或 API 文档）合并到 wiki 中要容易得多，并且您可以使外部参照目标稳定。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-25T22:51:27.147

这是 SharePoint 的开源扩展 wiki，可能更适合：

[http://www.codeplex.com/CKS/Wiki/View.aspx?title=Enhanced%20Wiki%20Edition&referringTitle=Home](http://www.codeplex.com/CKS/Wiki/View.aspx?title=Enhanced%20Wiki%20Edition&referringTitle=Home)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-05T02:27:01.827

首先，查看[这个 StackOverflow 线程](https://stackoverflow.com/questions/11462/sharepoint-wikis)。一个类似的问题被问到了关于 Sharepoint wiki 的问题，赞成和反对的答案都非常有用，并概述了您问题的“在 Sharepoint 中不可能”部分。

在将 Sharepoint 用于团队文档几年之后，我现在正试图在 Sharepoint 中实现一个团队 wiki，因为他几乎和你一样。我的观察：

## Sharepoint 文档库

我的经验是用于文档的 Sharepoint 是不错的。它可能很不稳定，有时您会丢失编辑或出现性能问题，尽管优秀的 Sharepoint 支持团队可以帮助解决其中的一些问题。我确实发现 Sharepoint 文档库比在网络上存储东西更好。它使文档和库易于链接。明智地使用元数据属性可以使 Sharepoint 列表视图对于查看文档的内容、用途和状态非常有用，因此我们的分析师、PM、开发人员等都一眼就知道谁拥有球和什么时候等着他们。那是几年前开始的一个项目。今天，Sharepoint 2007 的工作流程可能会提供通知。

还有文档的版本控制。但正如其他一些人所指出的那样，在文档中做事在撰写、下载和共享方面存在开销和缺陷。签出文档会有所帮助，但松散的大炮开发人员可以下载文档、编辑它们，然后将它们存储在其他地方，从而破坏版本控制。这发生在我们身上，尽管这是一个纪律问题，而不是 Sharepoint 的错。

## 共享点维基

根据 Chris Hynes 的回答，摩擦是描述问题的好词。为了快速参考团队内部基础设施的详细信息，wiki 似乎对我们更有效。wiki 使数据几乎立即可见，无需先单击链接并等待 Word 加载。编辑也更快更容易......虽然我仍在尝试它，但 Sharepoint wiki 具有版本控制并允许“签出”wiki 文章。

正如您和其他 SO 线程所指出的，与其他 wiki 引擎相比，Sharepoint 是轻量级的。它更擅长什么？好吧，我使用它是因为它就在那里，不需要任何特殊设置，总比没有好，坦率地说，它适用于不需要强大或面向客户的内部东西。卖给老板很容易，因为它的成本不会超过我们已经花费的成本。wiki 也不容易被我前面提到的松散大炮类型所破坏，我们可以在必要时查看审计跟踪或回滚。

添加和交叉链接条目很容易，但如果要嵌入图形，则必须先将它们上传到 Sharepoint 库。您也可以在 wiki 中编辑 HTML，尽管我不确定这样做有什么限制，并且如果没有安全访问和 Sharepoint Designer，我认为无法控制 CSS。所以除了文本（比如表格）之外的任何东西都不是很健壮。

到目前为止，我比将所有内容都存储为文档更喜欢它。查看和编辑数据的即时性为 wiki 提供了真正的优势。这肯定比拉下文档并重新签入要容易。对于一般厌恶文档的开发人员来说，它有助于消除保持信息更新的障碍。

还有其他要考虑的。您希望您的开发人员热情并积极参与编辑 wiki 吗？如果是这样，您可能需要不同 wiki 引擎的讨论功能。我的开发人员和大多数人一样；他们最讨厌的两件事是测试和文档。所以我是创建文章的人，解释构建过程、数据库环境使用、应用程序实例、服务器映射、SOX 文档清单等。其他开发人员将主要参考它并发布小的更新。我们的版本控制和并发支持并没有受到太大压力。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-10T02:53:57.260

wiki 比一堆 word 文档更容易被使用，因为它比一堆 word 文档更快更容易找到编辑或创建新页面的条目！

然后问题变成了哪个wiki

几乎所有的 wiki 都比 SharePoint wiki 好，这是一个笑话

Screwturn 非常棒，在 v3 中具有 ACL 和所见即所得，并且非常容易扩展

例如，使用 XSLT 插件非常适合嵌入服务器进程、CI 构建、测试、源代码控制统计等的输出

例如，我们有一个 OLEDB 插件，它可以从各种公司数据库中读取关键值，并将它们嵌入到描述数据是什么以及它应该具有什么值的页面中。我们有一个母版页，其中列出了所有数据超出规定范围的页面。FIT 和系统监控工具的混合体

如果您对“所有内容”的管理职位必须在 SharePoint 中，那么有螺丝转插件可以将螺丝转页面呈现为 PDF、HTML、xml 等（然后您可以转换为 docx）并有一个脚本来转储更改的螺丝转每晚将页面发送到 SharePoint 以进行搜索和“管理”目的

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-10T13:47:11.073

您可能想查看[Confluence](http://www.atlassian.com/software/confluence/default2.jsp)，因为它可能是市场上领先的企业 wiki。该 wiki也有一个[SharePoint 连接器](http://www.atlassian.com/sharepoint/)。作为 SharePoint 连接器的贡献者之一，我有点偏颇，但如果您不检查现有的一些选项，您可能会对自己造成伤害。Wiki 可以强大且具有传染性，但如果 wiki 低于标准，则不会发生这种情况。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-11T03:30:04.433

通过将 SharePoint wiki 与任何其他 wiki 系统进行比较，没有人会对它感到满意。

所以，不要比较。它具有 wiki 有用所必需的基本功能：您可以输入（有点）格式丰富的文本，以及指向其他页面的链接，无论它们是否存在。单击指向不存在页面的链接会将您带到新的空白页面的编辑页面，允许您保存页面。

是的，图片支持很烂。您必须先创建图片，然后粘贴图片的 URL。因此，请花两分钟时间创建一个图片库以在其中发布 wiki 图片。

记住 wiki 的主要目标 - 不是与其他 wiki 工具竞争，而是快速将想法写下来，并且不停止构建它们。结构可以稍后添加，如果有的话。

正如其他人所说，telerik 提供了富文本编辑器的替代品，有一个 CodePlex 项目正在（缓慢地）进行改进，而且，人们，它是 SharePoint——如果你不喜欢它，你可以自定义它。它是 ASP.NET、Web 服务和 Windows Workflow Foundation。

我不建议任何人出去购买 MOSS 许可证只是为了实现一个 wiki（或博客，就此而言）。但是，如果您已经拥有 SharePoint 基础结构（可能是 Visual Studio Team System Team Foundation Server 的一部分），那么就去做吧。我已经看到几个 SharePoint wiki 库用于**极大**地提高大型软件开发组织中的多个组可用的开发人员文档的数量和质量。一旦我们停止了关于其他 wiki 有多棒的讨论，就会有很多文档本身就发生了，就像它应该做的那样。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-04T15:37:04.573

我经常使用 Sharepoint，我发现它有点慢而且很烦人。如果一切都已经是 Office 文档，并且如果您的公司愿意让每个人的计算机都与 Office 版本保持同步，那么 Sharepoint 可以正常工作。如果您有各种 Office 版本（就像我们一样），那么它就没有那么好了。我的机器有一些旧版本的办公组件，集成并不总是正常工作。我已经学会了根本不尝试使用集成。

这两种解决方案最重要的是确保您的员工知道如何使用它。我们在早期遇到了一些问题（不同名称的文件版本，而不是使用 sharepoint 中内置的版本控制），这实际上只是人们培训中的空白。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-10T11:21:19.457

我们目前正在使用两者的组合，用于规范和正式文档的共享点以及用于“隐性知识”的 Wiki。我们的每个解决方案在 wiki 中都有一个页面，由于易于添加内容，这非常有效。

# sql - 处理数据库中的层次结构数据

> ID：587488
> 
> 赞同：7
> 
> 时间：2009-02-25T19:38:19.137
> 
> 标签：sql, hierarchical-data

我很想知道在数据库设计方面处理层次结构的最佳方法（最佳实践）是什么。这是我通常如何处理它们的一个小例子。

**节点表**

```
NodeId int PRIMARY KEY
NodeParentId int NULL
DisplaySeq int NOT NULL
Title nvarchar(255) 
```

**祖先表**

```
NodeId int
AncestorId int
Hops int 
```

在 NodeId、AncestorId、Hops 上有索引

表如下所示：

**节点表**

```
NodeId    NodeParentId    DisplaySeq    Title
1         NULL            1             'Root'
2         1               1             'Child 1'
3         1               2             'Child 2'
4         2               1             'Grandchild 1'
5         2               2             'Grandchild 2' 
```

**祖先表**

```
NodeId    AncestorId    Hops
1         NULL          0
1         1             0
2         1             1
2         2             0
3         1             1
3         3             0
4         1             2
4         2             1
4         4             0
5         1             2
5         2             1
5         5             0 
```

通过这种设计，我发现对于大型层次结构，通过加入 AncestorId = 目标 NodeId 的祖先表，我可以非常快速地获得整个层次结构部分，例如：

```
SELECT *
FROM Node n
INNER JOIN Ancestor a on a.NodeId=n.NodeId
WHERE a.AncestorId = @TargetNodeId 
```

获得直子也很容易

```
SELECT *
FROM Node n
INNER JOIN Ancestor a on a.NodeId=n.NodeId
WHERE a.AncestorId = @TargetNodeId
AND Hops = 1 
```

我很想知道您可能为此类事情使用了哪些其他解决方案。以我的经验，层次结构可能会变得非常复杂，任何优化它们的检索的方法都非常重要。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T19:43:37.253

有一些特定于供应商的扩展可以做到这一点，但我最喜欢的 db-neutral 方式来自 Joe Celko - google 'Joe Celko Trees and Hierarchies' 或购买这本书：[链接文本](https://rads.stackoverflow.com/amzn/click/com/1558609202)

这是一个非常聪明的基于集合的方法。易于查询层次结构。我添加了您拥有的“parentID”字段，因为我问了很多“直接孩子”和“父母”问题，这加快了速度。但这是获取“祖先”或“后代”查询的好方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-25T19:44:05.287

您可能还想查看“嵌套集”模式：

> [http://www.intelligententerprise.com/001020/celko.jhtml](http://www.intelligententerprise.com/001020/celko.jhtml) （断开的链接）

或者你可以谷歌了解更多。

PS：诅咒，[n8wrl](https://stackoverflow.com/users/37710/n8wrl)，你打字比我快！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-25T19:48:17.337

正如 MarkusQ 和 n8wrl 已经指出的那样，Joe Celko 在这方面有一些好东西。我只想补充一点，有多种方法可以对层次结构进行建模（Joe 的书中包含我相信的几种方法，而不仅仅是他认为“最好的”一种）。希望您的最终决定会考虑到您自己的具体需求。一些不同的建模方法更适合写入密集型操作，而另一些更适合频繁或快速读取层次结构。请记住您的系统将使用它做什么。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T19:47:20.410

SQL Server 2008 引入了[hierarchyid 数据类型](http://technet.microsoft.com/en-us/library/bb677290.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T19:44:42.367

在 Oracle 中，您可以使用 CONNECT BY/START WITH 来查询层次结构数据。在 SQL Server 中，您可以使用递归调用自身的存储过程。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T20:34:56.553

我肯定会推荐嵌套集。他们都是伟大的。

[http://threebit.net/tutorials/nestedset/tutorial1.html](http://threebit.net/tutorials/nestedset/tutorial1.html) [http://www.dbmsmag.com/9603d06.html](http://www.dbmsmag.com/9603d06.html)

# javascript - Javascript 函数和可选参数

> ID：587496
> 
> 赞同：36
> 
> 时间：2009-02-25T19:41:19.397
> 
> 标签：javascript, jquery, arguments

我有两个几乎相同的 javascript 函数用于启动 jquery $.get 调用。函数的参数被传递给被调用的脚本。

问题是一组调用需要一个额外的参数，而另一组不需要。

为了实现这一点，我使用了我提到的两个几乎相同的 javascript 函数。他们来了：

```
function process(url, domid, domain, scan_id)
{
    $.get(url,
    {
        domain: domain,
        scan_id: scan_id
    },

    function(data)
    {
        $(domid).html(data);
    });
}

function process_type(url, domid, type, domain, scan_id)
{
    $.get(url,
    {
        domain: domain,
        type: type,
        scan_id: scan_id
    },

    function(data)
    {
        $(domid).html(data);
    });
} 
```

如您所见，第二个函数仅接受一个名为“type”的附加参数，然后通过 $.get 调用传递该参数。

我想将这两个函数结合起来，但我不确定如何在 $.get 中传递的第三个参数（数组/对象/它在 {}（是的，javascript noob）中的任何内容）中可选地包含在内。

编辑只是说....该死的，你们很好。:D

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-25T19:43:44.367

javascript 中的所有参数都是可选的，您可以使用函数内部的参数数组来访问按顺序传递的参数，如下所示：

```
function myFunction(option1)
{
   var option2 = arguments[1];
   if(arguments[0] == option1)
      alert("Happy Day, Option1 = " + option1 + ", Option2 = " + option2);
}

myFunction("Hello", "World"); 
```

产生：Happy Day, Option1 = Hello, Option2 = World

希望这说明了如何使用参数数组来改进一些代码。

```
 function process_type(url, domid, domain, scan_id)
    {
            var myOptions = {
               domain: domain,
               scan_id: scan_id
            };

            if(arguments[4])
                myOptions["type"] = arguments[4];

            $.get(url, myOptions,

            function(data)
            {
                    $(domid).html(data);
            });
    } 
```

然后你可以调用它，最后一个参数是可选的类型，如果传递了参数，则使用它，否则省略它。

此外，由于实际参数首先是可选的，因此您还可以将名称添加到函数定义的末尾并使用相同的 if 但不是`arguments[4]`您会这样做`if(type) myOptions["type"] = type;`

```
 function process_type(url, domid, domain, scan_id, type)
    {
            var myOptions = {
               domain: domain,
               scan_id: scan_id
            };

            if(type)
                myOptions["type"] = type;

            $.get(url, myOptions,

            function(data)
            {
                    $(domid).html(data);
            });
    } 
```

此调用将包括类型

```
 process_type("xxx", "xxx", "xxx", "xxx", "xxx"); 
```

这个电话不会

```
 process_type("xxx", "xxx", "xxx", "xxx"); 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-02-25T19:50:16.923

既然除了 url 和 domid 之外，你所做的一切都是将它传递给`$.get`，为什么不这样做呢？

```
function process_type(url, domid, args) {
    $.get(url, args, function(data) {
        $(domid).html(data);
    });
}

// call it without type
process_type('myurl', 'domid', {domain:'..', scanid:'...'});
// call it with type
process_type('myurl', 'domid', {type: '..', domain:'..', scanid:'..'}); 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-11-05T18:42:38.203

一些简单的方法来做到这一点

```
// 'b' is optional
// the 'null' value would be the default value

function Example1(a,b){
    b = b || null;

    // Some code here
}

function Example2(a,b){
    if(typeof b == 'undefined') b = null;

    // Some code here
}

function Example3(a,b){
    if(b === undefined) b=null;

    // Some code here
}

function Example4(a,b){
    if(!b) b=null;

    // Some code here
} 
```

对于无限参数，您可以使用数组“参数”，例如：

```
function ExampleArguments(){
    for(var i=0; i<arguments.length; i++){
            // Alert the current argument
            alert(arguments[i]);
    }
}

ExampleArguments('arg1',2,someVar); 
```

# cross-platform - 跨平台开发

> ID：587497
> 
> 赞同：8
> 
> 时间：2009-02-25T19:41:45.510
> 
> 标签：cross-platform

我对真正的跨平台开发以及是否可以使用 ONE 平台开发软件有疑问。

我编写了一些在 OS X、Windows 和 Linux 上运行的应用程序。他们都使用本机平台工具包和一些跨平台的共享源。我必须启动到每个平台、结帐、编译等。

我过去曾尝试过 QT 之类的 GUI 工具包（我购买了 Win、mac、Linus 的商业许可证，但非常昂贵，而且年复一年地支付变得困难）。我已经尝试过 WxWidgets，开发进展缓慢。

所以我在想的是有一种方法可以运行单一平台并为其他平台交叉编译，这样我就可以从单一平台构建我的产品。

我喜欢 OS X，有没有办法从 OS X 为 OS X、Windows、Linux 编写应用程序，我只需要分别在每个平台上进行测试。我找到了有关交叉编译器、存根编译等的信息。

有人有想法吗？这甚至可能吗？有人会为了创造这样的野兽而杀人吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T22:32:23.427

在我公司，我们使用**Mozilla 框架**开发跨平台词典产品。这些应用程序基于 Gecko/Necko 浏览器，大部分开发是通过**Javascript、HTML、CSS、XSL、XUL**完成的......当然，我们的自制搜索引擎必须交叉编译到三个平台（有一些其他代码首先在 JS 中完成，然后出于速度原因移植到 moz' C++）。

最后，我们有一个合理的跨平台解决方案：我们的开发人员大多像强大的 Web 开发人员一样工作（同时考虑客户端和服务器端）。因为 Gecko 在三个平台上是相同的，所以我们知道它的外观和行为方式是可以预见的（除了存在错误时，但从这个角度来看，该平台现在已经相当成熟了）。

我们的研发人员知道如何将慢速 javascript 代码移植到相当快的可移植 C++ 代码（您使用跨平台库 NSPR 库编写 Mozilla 代码）。测试总是要在三个平台上进行，但是，尽管随着时间和经验，你会知道什么会在哪里中断（字体支持、音频支持、Flash 支持）......

今天，您可能应该看看**XULRunner**，它是真正的 Mozilla，没有任何真正的浏览器界面（*在 2002 年，我们不得不拆除 Mozilla 浏览器以将其重新涂上我们的第一个产品颜色*）。当然，它适用于简单的应用程序，但如果你想制作 OpenGL、3D 音频和其他漂亮的东西，XULRunner 会显得太有限了。

我相信暴雪有一些用于这种事情的跨平台框架...... :)

祝你好运！

皮埃尔。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T19:55:42.763

尝试在单一平台上开发将在多个平台上使用的应用程序并不是一个好方法。充其量，您将制作的应用程序对于您没有开发的平台的用户来说是陌生的。

更有可能的是，您会在从未预料到的领域遇到微妙的兼容性问题。如果您想走这条路，Java 可能是最好的选择。交叉编译将导致自动生成的代码，这将是调试和维护的噩梦。

当然，在某些情况下，您也许可以使用工具进行移植，但我不认为这是一个您可以提供自动化解决方案的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T19:51:31.447

好吧，老实说，一次性构建跨平台应用程序的唯一保证方法是使用 Java，但它需要首先安装相当大的运行时。

但是，如果这不是一个选项，我建议您关注 Qt 的最新发展——它现在可以（或应该很快）在 LGPL 下可用，这大概意味着您不再需要为此付费。我发现将 GCC 与 Qt 一起使用，在不同平台上进行交叉编译时效果很好，只要您只使用 Qt 的类/代码/对象并确保您创建或使用的任何非 Qt 代码都能够被编译跨平台。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T19:58:21.227

您没有提及任何特定的编程语言（但由于 GUI 工具包，我猜测是 C 或 C++），因此很难对您实际提出的问题给出一个好的答案。

如果您想要“真正的”跨平台，我会首先考虑是否可以使用一种不受平台限制的语言来解决您的问题。Python、Java 和许多其他工具允许您在一个平台上编写并在多个平台上运行。

如果您仍想使用 C/C++，GCC 为您提供了交叉编译的选项，如果您将其与 QT（即将在 LGPL 下可用）结合使用，您应该能够得到一些工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T19:47:52.517

Java 尝试过一次编写，随处运行。它在某些情况下运行良好，但操作系统中有太多“独特”的东西。GCC 提供了交叉编译应用程序的能力，但您也会遇到同样的问题。该代码将具有更好的性能。RIA 方法似乎有效，但感觉不像是原生应用程序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T19:59:49.197

即使使用跨平台 GUI 工具包也不会消除所有跨平台问题。毕竟，应用程序不仅仅是 GUI。交叉编译也永远无法捕捉到原生构建会捕捉到的所有问题。如果要支持多个平台，则*至少*必须在每个平台上进行测试。但希望您可以在打开所有警告的情况下执行本机构建，**除了测试**。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-08-09T17:32:41.167

对于跨平台开发，您可以使用Phone Gap、Appcelerator (Titanium)、Corona...这些都提供了一个基于JavaScript 的框架，最终能够在不同的平台上运行。我正在使用的是 Titanium for Mobile Development，它允许我们使用本机代码开发应用程序......（这是非常好的优势）。Phone Gap 提供了一个一般不是原生的网络应用程序...该软件用于开发跨平台支持...支持 Windows、Linux 和 Mac OS。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-27T22:56:10.570

在过去的几个月里，我发现了一些关于跨平台开发主题的精彩视频。我希望你也觉得它们有用。

**QTC创作者**

[http://www.youtube.com/watch?v=aYiPvM7ZRHA&feature=channel](http://www.youtube.com/watch?v=aYiPvM7ZRHA&feature=channel)

**FlexBuilder**

[http://www.youtube.com/watch?v=_O_xDXRsh3Y&feature=channel](http://www.youtube.com/watch?v=_O_xDXRsh3Y&feature=channel)

**单声道/单声道开发**

[http://www.youtube.com/watch?v=U6VG_Z0aRek](http://www.youtube.com/watch?v=U6VG_Z0aRek)

我个人使用 Silverlight / MacOS X 取得了成功

*   [http://screencast.com/t/if8xenkt](http://screencast.com/t/if8xenkt)

**真实基础**

[http://www.youtube.com/watch?v=GWipoBeKSRk](http://www.youtube.com/watch?v=GWipoBeKSRk)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-01-17T23:51:03.610

根据我个人的经验，我认为你应该采用 Java：你会避免很多麻烦。

正如您所提到的，您可以在您喜欢的任何平台上进行开发，并在所有其他平台上进行部署，而无需为每个目标平台进行编译。

例如，我在 linux 下开发，我只点击“编译”一次，生成的文件就可以在任何地方运行（windows、mac、solaris、z/OS 等等）。双击将在任何平台上运行它（我必须安装 Java 运行时，但大多数用户已经安装了它，如果没有，那就是下载、安装、“Next>”、“Next>”、“OK”的问题）。

如果您选择“Java Web Start”部署方法，它会变得更加容易：用户只需单击网页上的启动按钮并运行应用程序（如果根据 JNLP 描述符中指定的内容安装了正确的 JVM）或用户被重定向到 Java 下载页面（如果没有找到合适的 JVM）。

GUI 开发（使用 Swing 工具包）既简单又强大，特别是如果您使用正确的工具（即 Netbeans IDE）。

# wmi - Hyper-V/WMI 编程问题

> ID：587498
> 
> 赞同：3
> 
> 时间：2009-02-25T19:41:51.080
> 
> 标签：wmi, hyper-v, wmi-query

我查看了“root\virtualization”名称空间中的几个对象，但我无法找到 Hyper-V 存储给定虚拟机配置文件路径的位置。我需要以编程方式获取此文件路径，或者至少只是给定虚拟机的主路径也可以。什么 WMI 对象和字段存储给定虚拟机的路径（提示它不是 Msvm_ComputerSystem）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T20:31:39.193

获取 Msvm_VirtualSystemManagementServiceSettingData 的 DefaultExternalDataRoot 属性以获取 vm 根，并附加 Msvm_ComputerSystem (guid) 的 Name 属性和“.xml”。即使 VM 是在非默认位置创建的，您也会在默认外部数据根目录中看到引用配置文件的符号链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T16:51:48.713

这并不完全正确。在`WSS2008R2`中，更改默认 VM 数据根时，系统数据根中不会写入任何内容。要查找单个 VM 的数据根，您需要查找`Msvm_VirtualSystemGlobalSettingData`、搜索`SystemName`与您匹配的属性`VM GUID`，然后查找`ExternalDataRoot`和`SnapshotDataRoot`属性以查看与 VM 相关的文件夹。

# .net - 暂停重绘 Windows 窗体

> ID：587508
> 
> 赞同：5
> 
> 时间：2009-02-25T19:44:43.007
> 
> 标签：.net, winforms, datagridview, refresh

我有一个窗体。它包含几个数据网格视图。在某些时候，用户可以按下更新数据网格视图的按钮。当他们这样做时，他们通常可以坐下来观看 datagridview 自己重绘，一次一行。我希望控件在“完成”之前不绘制，也就是说，我想要一种方法来告诉控件

```
Control.SuspendRedraw()
this.doStuff()
this.doOtherStuff()
this.doSomeReallyCoolStuff()
Control.ResumeRedaw() 
```

我见过 SuspendLayout / ResumeLayout 函数，但它们什么都不做（它们似乎与调整大小/移动控件更相关，而不仅仅是编辑它们的数据值？）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T21:07:46.083

您可以尝试以下几件事：

首先，尝试将 DataGridView 的 DoubleBuffer 属性设置为 true。这是实际 DataGridView 实例上的属性，而不是 Form。它是一个受保护的属性，因此您必须对网格进行子类化才能设置它。

```
class CustomDataGridView: DataGridView
{
    public CustomDataGridView()
    {
        DoubleBuffered = true;
    } 
} 
```

我已经看到一些视频卡上的 DataGridView 进行了很多小的绘制更新需要一段时间，这可以通过在发送显示之前将它们分批处理来解决您的问题。

* * *

您可以尝试的另一件事是 Win32 消息 WM_SETREDRAW

```
// ... this would be defined in some reasonable location ...

[DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = false)]
static extern IntPtr SendMessage(HandleRef hWnd, Int32 Msg, IntPtr wParam, IntPtr lParam);

static void EnableRepaint(HandleRef handle, bool enable)
{
    const int WM_SETREDRAW = 0x000B;
    SendMessage(handle, WM_SETREDRAW, new IntPtr(enable ? 1 : 0), IntPtr.Zero);
} 
```

在你的代码的其他地方你有

```
HandleRef gh = new HandleRef(this.Grid, this.Grid.Handle);
EnableRepaint(gh, false);
try
{
    this.doStuff();
    this.doOtherStuff();
    this.doSomeReallyCoolStuff();
}
finally
{
    EnableRepaint(gh, true);
    this.Grid.Invalidate(); // we need at least one repaint to happen...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T19:55:03.793

您可以尝试将表单设置为使用 DoubleBuffer。将 Form.DoubleBuffer 属性设置为 true，这应该可以解决您的问题。

# .net - 如何检测是否从 Server.Execute 调用了 aspx 页面？

> ID：587510
> 
> 赞同：4
> 
> 时间：2009-02-25T19:45:05.550
> 
> 标签：.net, asp.net, .net-3.5

我有以下示例页面结构：

*   网页.aspx
*   脚本.aspx

如果我`Server.Execute("Script.aspx")`从 Webpage.aspx 调用，如何在 Script.aspx 中检测到它是从 Webpage.aspx 而不是直接从 Web 浏览器调用的？

*我试过检查推荐人，但这似乎只返回域而不是脚本。*

*我在 .NET 3.5 上使用 ASP.NET Web 窗体*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-25T20:25:56.450

由于 Server.Execute 以与原始页面相同的上下文运行新页面，因此 Request 的所有属性仍应反映对 Webpage.aspx 的原始请求（CurrentExecutionFilePath 除外，它希望包含“/Script.aspx”）。Request.Path 应该包含“/Webpage.aspx”，而如果您需要查看域或查询字符串，Request.Url 将提供完整的 Uri 对象。

您还可以在调用 Server.Execute 之前向 Context.Items 添加值并在 Script.aspx 中读取它们

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T23:40:02.470

在 Script.aspx.cs 中，您可以简单地检查 Request.Path 与当前执行路径的比较。

```
if ( Request.CurrentExecutionFilePath == Request.Path ) 
{
   //This has been called from a web browser
} else {
   //This has been executed from the file Request.Path
} 
```

为什么？

当您调用 Server.Execute 时，请求的一部分会原封不动地传递。因此，如果您在 Webpage.aspx.cs 中使用 Server.Execute 后从 Script.aspx.cs 中查看 Request.Path 的值，您会看到它的值为“/Webpage.aspx”。

但是，如果 Web 浏览器直接访问 Script.aspx，则 Script.aspx.cs 中的 Request.Path 的值将导致“/Script.aspx”。currentExecutionPath 将始终产生当前执行的脚本，因此比较两者将得到所需的结果。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T19:51:33.317

至少您可以通过 Request.IsLocal 判断请求是否是本地的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T20:05:29.180

您可以将查询字符串参数传递给 Script.aspx（这将帮助您识别它是从 WebPage.aspx 调用的）。

`Server.Execute("script.aspx?xFrom=webPage.aspx")`

编辑：我认为请求应该有一些价值让你知道它正在运行webpage.aspx。

EDIT2：Request.Url？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T23:17:18.250

`HttpRequest.FilePath`将返回请求页面的 URL，然后您可以对“Script.aspx”进行子字符串匹配。

（尽管我的 .Net 很差，但请用大量的盐来回答这个问题。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-08T21:16:00.870

假设您没有任何 IHttpHandler 有趣，您可以检查[HttpContext.PreviousHandler](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.previoushandler.aspx)是否不为空。但是，由于可以设置 PreviousHandler 有一百万个（嗯，几个）原因，我会接受 stevemegson 的建议，即在调用 Server.Execute 之前使用 HttpContext.Items。

# javascript - Javascript 可以强制隐藏的 div 等待加载其内容吗？(HTML/Javascript)

> ID：587532
> 
> 赞同：1
> 
> 时间：2009-02-25T19:49:00.983
> 
> 标签：javascript, html, load, hide, show

我有一个相当基本的缩略图和视图页面。单击每个缩略图时，中央窗格将显示全尺寸图像。这一点效果很好 - 我正在使用 Javascript 来显示和隐藏包含大图像的 div，但是当页面首次加载时，它会同时开始加载所有图像。这会导致用户看到的第一张图像被非常缓慢地引入。

我已经尝试过动态创建 div，但后来我陷入了不得不等待加载每个图像的不良影响。理想情况下，我想使用我当前的设置——只显示和隐藏 div——并让隐藏的 div 在第一个窗格完成后立即开始加载它们的内容。有没有办法在可见 div 上设置加载优先级，这样隐藏的 div 在呈现所有可见 div 之前不会获得网络时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T19:57:22.447

我认为您想要的是将“动态创建 div”（对于不可见的 div）与[图像预加载](http://www.pageresource.com/jscript/jpreload.htm)相结合。应该能得到你想要的东西。

# c# - DAL设计问题

> ID：587533
> 
> 赞同：3
> 
> 时间：2009-02-25T19:49:06.880
> 
> 标签：c#, data-access-layer

我需要设计一个数据访问层 DAL .Net 企业库版本 3.5 数据访问应用程序块 (DAAB) 在我的应用程序中，我有各种逻辑模块，如注册、计费、订单管理、用户管理等我使用 C# 业务实体来将模块对象映射到数据库表，然后将 List 集合返回给客户端。

我想以这样一种方式设计我的 DAL，如果明天我们决定使用其他一些数据访问框架，我们应该对代码进行最少的更改。鉴于此，我如何设计我的班级结构？我以为我会有一个 DbManagerBase 类，它将是现有 .net DAAB 的包装器。此类 DbManagerBase 将实现一个名为 IDbManagerBase 的接口，该接口将具有 ExecuteReader、ExecuteNonQuery 等公共方法。

客户端类，即。RegistrationDAL,UserManagermentDAL 在其每个方法中都会包含以下代码： IDbManagerBase obj= new DbManagerBase() obj.ExecuteReader(myStoredProcName) 。. . 这是一个好的 OOPS 设计吗？请问我有什么更好的方法吗？或者我需要在这里使用继承吗？我可以将 DbManagerBase 类和 RegistrationDAL、UserManagermentDAL 类中的所有方法都设为静态吗？我想，如果我将方法设为静态，那么上面的接口代码将没有任何意义……对吗？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T19:53:02.957

要真正抽象 DAL，我会使用[存储库模式](http://martinfowler.com/eaaCatalog/repository.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T21:58:14.403

回答几个问题：

> 我可以将 DbManagerBase 类和 RegistrationDAL、UserManagermentDAL 类中的所有方法都设为静态吗？

我可能会采用非静态方法，因为它可以灵活地更好地控制 DAL 的实例化（例如，您可以从工厂创建它们的实例），它还将允许您有两个正在通话的 DAL以更清洁的方式连接到不同的数据库。此外，您不需要在每个对象中创建 DbManagerBase 的实例，因为它将是实例成员。

> 关于具有 ExecuteReader、ExecuteNonQuery 和 obj.ExecuteReader(myStoredProcName) 的 IDbManagerBase

我会小心在太多地方烘焙有关数据库特定概念的知识。请记住，某些数据库不支持存储过程。

另一点是，在我开始实施某种 DAL 之前，我一定会通读其他开源 DAL 中的一些代码，例如 NHibernate 或 Subsonic。他们完全有可能解决您的业务问题并显着减少您的开发时间。

如果你正在寻找一个分层 DAL 架构的小例子，我[在 github 上有我的小项目](http://github.com/sambo99/simplestorageengine/tree/fd8b769a7c55d66c135cc02b481d87bb3c7904ff/SimpleStorageEngine/Persistance)（它非常基础，但展示了如何构建接口来支持许多深奥的数据库）

# iis - 虚拟目录中的 IIS 配置文件

> ID：587537
> 
> 赞同：3
> 
> 时间：2009-02-25T19:49:45.523
> 
> 标签：iis, app-config, virtual-directory

我有多个网站都具有相同的代码，但不同的应用程序设置。我想将我的应用程序设置放在位于虚拟目录中的单独配置文件中。这将允许我拥有跨所有站点共享的所有代码的单个副本，每个站点具有不同的虚拟目录。

不幸的是，当我尝试配置它时，IIS 在虚拟目录中时不会处理配置文件。

如果您对此有解决方案，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-10-15T11:23:50.810

不能使用虚拟目录（甚至是当前网站之外的文件；只能使用当前文件夹或子文件夹）。

跨项目共享设置的一种可能方法是在构建时进行 - 通过将其复制或使用 VS 中的链接文件将其复制到发布时的文件夹中。

如果你真的需要服务器上的这个功能，你可以尝试（虽然我不能说它有多好用）一个[Junction](http://en.wikipedia.org/wiki/NTFS_junction_point)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-02T17:35:09.130

也许在您的网络服务器上使用 machine.config 文件是一个合适的选择？否则，您可以在某个全局文件夹中创建一个 web.config 文件，然后使用 WebConfigurationManager.OpenMappedWebConfiguration() 方法打开它。

# java - 您知道将强制执行休眠最佳实践的 PMD 或 Checkstyle 规则吗？

> ID：587538
> 
> 赞同：6
> 
> 时间：2009-02-25T19:50:03.710
> 
> 标签：java, hibernate, checkstyle, pmd

例如，不通过字符串操作等来构建查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T08:11:23.240

当您考虑[Hibernate 最佳实践](http://www.hibernate.org/hib_docs/reference/en/html/best-practices.html)（或那些[最佳实践](http://hibernatebp.blogspot.com/)）时，您会注意到它们与 Hibernate 配置（xml 文件）或查询相关。

这意味着您最好的选择是编写[自定义的 Chectyle 检查](http://checkstyle.sourceforge.net/writingchecks.html)。
（因此社区 Wiki 状态，因为这不是一个实际的直接答案）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T01:15:52.103

我不知道有任何此类检查，但是如果您想走那条路，您可以选择 VonC 上面提供的选项，或者您可以采取不同的方式并查看 AspectJ 声明错误和/或声明警告。主要区别在于使用 AspectJ 您将能够在编译时强加这些规则。无论如何，如果您对 PMD 更熟悉，也许留在那片土地上会更好。

./亚历克斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T09:10:40.700

好像没有这样的文件...

# c# - 检查查询字符串是否为 int 的最佳方法？

> ID：587543
> 
> 赞同：4
> 
> 时间：2009-02-25T19:50:19.123
> 
> 标签：c#, asp.net

我的一位同事想到的一个问题是，检查查询字符串是否为 int 的最佳方法是什么。我建议使用经典的 Int.Parse 并尝试捕获，也建议使用 TryParse。其实我想不出别的办法。有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-25T19:53:53.640

[`Int32.TryParse`](http://msdn.microsoft.com/en-us/library/system.int32.tryparse.aspx)将是你最好的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T19:53:58.600

TryParse 可能是您最好的选择，因为它允许字符串的不同格式，并通过布尔值告诉您它是否有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T19:54:36.603

我喜欢 Int32.TryParse。我想你可以使用正则表达式，但我不确定是否有任何意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T19:55:16.787

可能不太有用，因为您可能想要实际的 int （尽管它可以扩展来做到这一点）。注意：我不会这样做，但这是他没有想到的另一种方式**。**

```
bool isNumeric = true;
foreach (char c in queryString) {
    if (!char.IsDigit(c)) {
       isNumeric = false;
       break;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T19:55:34.633

我更喜欢 TryParse 方法。两者几乎相等，我相信 TryParse 在方法内部做了一个 try{}catch{}，所以我怀疑执行上有很大差异。

# c# - 使用 XElement 时如何输入文本

> ID：587547
> 
> 赞同：15
> 
> 时间：2009-02-25T19:51:00.980
> 
> 标签：c#, html, linq

我正在使用新的 System.Xml.Linq 创建 HTML 文档（是的，我知道 HtmlDocument，但更喜欢 XDocument/XElement 类）。我在插入`&nbsp;`（或任何其他 HTML 实体）时遇到问题。我已经尝试过的：

1.  直接输入文本是行不通的，因为 & 变成了 &。 `new XElement("h1", "Text&nbsp;to&nbsp;keep&nbsp;together.");`

2.  我尝试使用以下方法解析原始 XML，但它会出现此错误：

    XElement.Parse("要保持在一起的文本。");

    --> 引用未声明的实体'nbsp'。`

3.  尝试第三个如下所示。如果我保存到文件中，只有一个空间，`&#160;`就会丢失。

* * *

```
var X = new XDocument(new XElement("Name", KeepTogether("Hi Mom!")));
private static XNode KeepTogether(string p)`
{
    return XElement.Parse("<xml>" + p.Replace(" ", "&#160;") + "</xml>").FirstNode;
} 
```

我找不到一种方法来将原始文本推过而不会逃脱。我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-25T22:49:26.370

> 我找不到一种方法来将原始文本推过而不会逃脱。

只需将 Unicode 字符放入该   直接在一个文本节点中引用(U+00A0 NO-BREAK SPACE)，然后让序列化器操心是否需要转义到  或不。（可能不是：如果您使用 UTF-8 或 ISO-8859-1 作为页面编码，则可以直接包含字符，而不必担心将其编码为实体引用或字符引用）。

```
new XElement("h1", "Text\u00A0to\u00A0keep\u00A0together"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-20T10:46:35.003

用 ##AMP## 之类的标记替换 & 解决了我的问题。也许不是最漂亮的解决方案，但我在 10 分钟内得到了一个客户的演示，所以......我不在乎 :)

谢谢你的想法

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-26T16:11:55.637

我知道这是旧的，但我发现了一些东西，我很惊讶！

```
XElement element = new XElement("name",new XCData("<br /> & etc")); 
```

你去吧！CDATA 文本！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T20:03:42.587

您也可以尝试使用编号实体，它们不需要声明。编号实体等同于命名实体   是  

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T20:34:58.690

与 amp (&)、lt (<) 等不同，nbsp 不是 XML 已知的实体，因此您需要声明它。在 XML 中，例如 &xyz; 被视为一个实体，解析器将引用它的值来产生输出。

```
// the xml, plz remove '.' within xml
string xml = "<xml>test&.n.b.s.p;test</xml>";

// declare nbsp as xml entity and its value is " " in this case.
string declareEntity = "<!DOCTYPE xml [<!ENTITY nbsp \" \">]>";

XElement x = XElement.Parse( declareEntity  + xml );
// output with a space between tests
// <xml>test test</xml> 
```

或者

```
 // plz remove '.' in the string 
 XElement.Parse("<xml>" + HttpUtility.HtmlEncode("Text&.n.b.s.p;keep everything") + "</xml>"); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-15T09:29:32.393

如果您将其复制到其他地方，您可以粘贴您希望看到的字符。Viusal 工作室允许这样做。虽然如果你需要这很难做到，但如果你需要任何符号就很容易，例如：

&bull ...只需粘贴 •</p>

↔ ...只需粘贴 ↔</p>

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-28T18:15:36.847

我想出了适合我的这种有点愚蠢的方法：当您存储数据时，将所有 & 替换为 ##AMP## ......并在输出上反转该操作。我将它与 XElement SQL 列结合使用，效果很好。

问候

尼尔

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-25T22:52:21.137

```
&amp;nbsp; 
```

# f# - F#中方法的多个参数

> ID：587551
> 
> 赞同：1
> 
> 时间：2009-02-25T19:51:48.230
> 
> 标签：f#

我有一个用 F# 编写的类，我在 C# 中使用它，它定义了一个方法`Render`：

```
member this.Render template (context: IContext) =
    let tokens = Lexer.tokenize template
    let parser = new DefaultParser([for filter in _filters -> filter])

    let resp = new StringBuilder()
    for node in parser.Parse tokens None do
        ignore <| resp.Append(node.render context)

    resp.ToString() 
```

这个方法的签名是`template:string -> (IContext -> string)`，当然读作“成员`Render`接受一个`string`参数，然后返回一个接受一个`IContext`并产生一个字符串的函数。

如果我将声明从“成员”更改为 let 绑定，将其定义为类定义的本地函数：

```
let Render template (context: IContext) = ... 
```

然后签名变成你所期望的 - `string -> IContext -> string`，它读作“`Render`接受一个字符串，然后是一个`IContext`并产生一个字符串”。

有没有办法让成员表现得像 let 绑定？这会导致从 C# 使用此成员的问题，因为签名变为`Render(string, FastFunc<IContext, string>)`，这不是过度使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T20:37:31.180

如果你想暴露给 C#，你应该把它写成 tupled 样式：

```
> type Foo =
-   member this.Bar (param1, param2) =  param1 + param2;;

type Foo =
  class
    member Bar : param1:int * param2:int -> int
  end 
```

这将公开一个正常的 .NET 样式方法。

# resharper - 如何关闭 ReSharper 的“查找所有用法”

> ID：587555
> 
> 赞同：25
> 
> 时间：2009-02-25T19:52:09.823
> 
> 标签：resharper

我正在试一试 ReSharper for C#。我发现我更喜欢 Visual Studio 更简单的“查找所有引用”而不是 ReSharper 更详细的“查找所有用法”。“查找所有参考资料”在 95+% 的时间里都能找到我需要的一切。有谁知道关闭“查找所有用法”并恢复 VS 实现的方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-27T17:47:02.093

不幸的是，如果不关闭整个系统，就无法关闭它。

抱歉，需要一点时间来适应。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-12-10T14:03:03.883

要恢复原始 VS 'Find All References' 命令：

1.  转到 ReSharper 选项 > 环境 > 键盘和菜单
2.  清除“隐藏覆盖的 Visual Studio 菜单项”

“查找所有引用”命令将在类型的上下文菜单中可用

要恢复原来的“Shift+F12”快捷键：

1.  转到 Visual Studio 选项 > 环境 > 键盘
2.  在搜索框中输入“Edit.FindAllReferences”
3.  将光标设置在“按快捷键”字段中，按 Shift+F12 并单击“分配”
4.  在“使用新快捷键”选择器中选择“文本编辑器”，然后将光标设置在“按下快捷键”字段中，按 Shift+F12 并单击“分配”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-31T23:55:10.697

“然而，在 Find Usages 窗口的 Group By 组合框中选择“None”会给出一个类似于 VS 的 Find All References 的列表。”

不幸的是，这仍然是一个回归，因为文件名没有列在行项目中。*具有讽刺意味的是，*仍然显示行/列坐标，如果没有文件名的上下文，这似乎有点毫无意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-06T09:29:34.210

我正在使用 ReSharper 8，当我有很多用途时，我更喜欢 VS 的 Find All References 列表，因为它更紧凑。然而，在 Find Usages 窗口的 Group By 组合框中选择“None”会给出一个类似于 VS 的 Find All References 的列表。

# ruby - 如何使用修改后的标头制作 HTTP GET？

> ID：587559
> 
> 赞同：15
> 
> 时间：2009-02-25T19:53:48.540
> 
> 标签：ruby, http, http-headers

在 Ruby 中使用修改后的标头发出 HTTP GET 请求的最佳方法是什么？

我想从日志文件的末尾获取一系列字节并且一直在玩弄以下代码，但是服务器正在返回一个响应，说“这是一个服务器无法理解的请求”（服务器是阿帕奇）。

```
require 'net/http'
require 'uri'

#with @address, @port, @path all defined elsewhere

httpcall = Net::HTTP.new(@address, @port)

headers = {
  'Range' => 'bytes=1000-'
}

resp, data = httpcall.get2(@path, headers) 
```

1.  有没有更好的方法在 Ruby 中定义标头？
2.  有谁知道为什么这会对 Apache 失败？如果我在浏览器中进行`http://[address]:[port]/[path]`获取，我将毫无问题地获得我正在寻找的数据。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-16T05:40:16.320

创建了一个对我有用的解决方案（效果很好）——这个例子得到了一个范围偏移：

```
require 'uri'
require 'net/http'

size = 1000 #the last offset (for the range header)
uri = URI("http://localhost:80/index.html")
http = Net::HTTP.new(uri.host, uri.port)
headers = {
    'Range' => "bytes=#{size}-"
}
path = uri.path.empty? ? "/" : uri.path

#test to ensure that the request will be valid - first get the head
code = http.head(path, headers).code.to_i
if (code >= 200 && code < 300) then

    #the data is available...
    http.get(uri.path, headers) do |chunk|
        #provided the data is good, print it...
        print chunk unless chunk =~ />416.+Range/
    end
end 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-25T20:07:44.387

如果您有权访问服务器日志，请尝试将来自浏览器的请求与来自 Ruby 的请求进行比较，看看是否能告诉您任何信息。如果这不切实际，请启动 Webrick 作为文件服务器的模拟。不要担心结果，只需比较请求以查看它们的不同之处。

至于 Ruby 样式，您可以内联移动标题，如下所示：

```
httpcall = Net::HTTP.new(@address, @port)

resp, data = httpcall.get2(@path, 'Range' => 'bytes=1000-') 
```

另外，请注意，在 Ruby 1.8+ 中，您几乎可以肯定正在运行的内容`Net::HTTP#get2`返回单个`HTTPResponse`对象，而不是一`resp, data`对。

# c# - 如何使用 C# 登录 Active Directory？

> ID：587580
> 
> 赞同：2
> 
> 时间：2009-02-25T19:56:37.270
> 
> 标签：c#, .net, authentication, active-directory

如何在不退出当前用户的情况下登录 AD 并获得新登录用户的权限。（操作系统：Windows XP）

### 笔记：

不要修改 AD 或类似的东西。只想从 C# 与另一个用户一起登录并获得新登录的权限/权限。（我想不仅在当前线程中而且在整个资源管理器中都使用此权限。比如删除文件、创建目录、更改网络选项。）

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T20:07:31.767

给定有效的用户名和密码，您可以使用模拟将线程身份更改为不同的用户。除了手动以不同用户身份登录外，没有其他方法可以更改整个 shell 的用户身份，但是在您模拟的线程上执行的任何操作都将获得新权限。

.NET 1.1 方式，使用 P/Invoke：

*   [使用 C# 进行 Windows 模拟](http://www.codeproject.com/KB/cs/cpimpersonation1.aspx)
*   [一个用于模拟用户的小型 C# 类](http://www.codeproject.com/KB/cs/zetaimpersonator.aspx)

.NET 2+ 方式，使用 Thread.CurrentPrincipal：

*   [如何在给定令牌的情况下冒充用户](http://alt.pluralsight.com/wiki/default.aspx/Keith.GuideBook/HowToImpersonateAUserGivenHerToken.html)
*   [直接访问主体对象](http://msdn.microsoft.com/en-us/library/wefzhcez.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T20:04:16.907

也许[这篇文章](http://alt.pluralsight.com/wiki/default.aspx/Keith.GuideBook/HowToImpersonateAUserGivenHerToken.html)可能会有所帮助。这是一个关于[`WindowsImpersonationContext`](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsimpersonationcontext.aspx).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T20:05:09.073

查看使用[LogonUser](http://support.microsoft.com/kb/306158#4)进行模拟。这将要求您提供他们的密码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T20:05:11.147

您将通过 P/Invoke 层调用 LogonUser API 函数，然后将返回的句柄传递给 WindowsIdentity 类的 Impersonate 方法。有关如何执行此操作的详细信息，请参阅 WindowsIdentity 类的 Impersonate 方法的文档，位于此处：

[http://msdn.microsoft.com/en-us/library/chf6fbt4.aspx](http://msdn.microsoft.com/en-us/library/chf6fbt4.aspx)

# java - 声明 Java 数组的首选方式是什么？

> ID：587584
> 
> 赞同：0
> 
> 时间：2009-02-25T19:57:22.633
> 
> 标签：java, arrays, declaration

> **可能重复：**
> [int[] 数组和 int 数组 [] 之间的区别](https://stackoverflow.com/questions/129178/difference-between-int-array-and-int-array)

Java中本机类型数组的这两个声明有什么区别？

```
double items[] = new double[10];

double[] items = new double[10]; 
```

如果它们相同，是否有任何理由更喜欢其中一个？

# php - PHP 和 MySQL 安全性

> ID：587588
> 
> 赞同：0
> 
> 时间：2009-02-25T19:59:36.480
> 
> 标签：php, mysql

我已经使用 PHP 连接到 MYSQL。我有一个包含我放置数据库信息，连接信息等的地方，我包含它是必要的。

是什么阻止了某人爬取我的网站，找到这个包含并连接到我的数据库？我通常会限制 MySQL 中的少数权限，例如只能插入/更新数据的用户。但我确实有一个可以完全控制的管理员用户。

保护我的连接信息的最佳做法是什么？

谢谢，

-杰森

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-25T20:02:19.937

将包含保存在不在 webroot 中的文件夹中。如果有人确实获得了对您网站的 Web 服务器访问权限并且可以在文件系统中看到 PHP，则包含的敏感详细信息不在 Web 根目录中。许多黑客只能访问网站所在的位置。确保您的 PHP 源目录不存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T20:02:26.910

你用什么做网络服务器？如果它是 Apache 或类似的，您可以将数据库信息放在文档根目录之外。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T20:03:05.473

如果您的服务器配置正确，PHP 代码将由 PHP 执行，并且仅将输出发送到浏览器，而不是源代码本身。因此浏览/抓取您的网站永远不会泄露 PHP 文件的内容，即数据库凭据。

当然，如果您的服务器配置*不*正确，则不必如此。（但在这种情况下你应该修复它！）

# xml - 如何使用泛型编写 XML 格式的 JSP？

> ID：587593
> 
> 赞同：1
> 
> 时间：2009-02-25T20:00:46.290
> 
> 标签：xml, jsp, jetty

我正在使用 JSP 编写一个 Web 应用程序，并且我真的很喜欢使用“XML 样式”JSP 指令（即 <jsp:scriptlet> 而不是 <% ）。但是，如果我在代码中使用泛型，则代码内容不是有效的 XML，并且当服务器（我使用 Jetty 6）尝试将文件解析为 XML 时会出现编译错误。

例如，我想写：

```
<jsp:scriptlet> 
List<String> myText = new List<String>();  
</jsp:scriptlet> 
```

然而，这段代码显然无法编译。我尝试在代码周围添加 CDATA 包装器（立即在 jsp:scriptlet 标记内），但它看起来没有任何区别。

是否可以在 JSP scriptlet 中使用泛型？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T23:02:20.007

```
<jsp:scriptlet> 
    List&lt;String> myText = new List&lt;String>();  
</jsp:scriptlet> 
```

> 我尝试在代码周围添加 CDATA 包装器（立即在 jsp:scriptlet 标记内），但它看起来没有任何区别。

真的吗？这也应该有效。当然，这很丑陋，但是没有人指责 JSP XML 格式方便或其他什么...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T20:12:47.433

如果您真的想编写 JSP，我的目标是创建标签（或使用[标准标签库](http://jakarta.apache.org/taglibs/doc/standard-doc/intro.html)（或[this](http://java.sun.com/products/jsp/jstl/)））并让页面远离 scriptlet - 使用或不使用泛型。通过适当的 MVC 分离（或至少将视图与其余部分分离），您通常可以仅使用标准标记库，生成更易于维护并自动验证为 xml 的 jsps。

您是否打算在您的 jsp 中使用任何框架，或者您想在 jsp 中处理请求处理？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T21:29:54.347

这个关于jetty [jsp配置](http://docs.codehaus.org/display/JETTY/Jsp+Configuration)的页面有帮助吗？

您的源语言和目标语言级别是否设置为 1.5？

# svn - 在 Subversion 中用分支替换主干

> ID：587603
> 
> 赞同：30
> 
> 时间：2009-02-25T20:02:53.667
> 
> 标签：svn

假设人们一直在开发主干和 Subversion 存储库的一个分支。我想丢弃主干上的任何更改，并将其替换为分支的副本。

正如[另一个问题](https://stackoverflow.com/questions/331388/svn-replace-trunk-with-branch)所建议的，我可以移动或移除主干，然后将分支复制到主干。但是随后主干的历史被分支的历史所取代。如果我想保留主干的历史怎么办？

我认为我想要的是类似于合并的东西，但是目标的更改被忽略，而只是替换为源。我将如何在 Subversion 中执行此操作？这被认为是好的做法吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-13T11:07:32.790

**虽然它是一个相当古老的线程，但仍然分享我的经验**

我们最近为我们的一个项目执行了此操作，并遵循以下准则：

```
svn copy <repos/trunk> <repos/tag/old_trunk> -m "copied old trunk as tag"

svn delete <repos/trunk> -m "deleted trunk temporarily"

svn copy <repos/branch/new_fetaure_branch> <repos/trunk> -m "placed new trunk with features" 
```

按照这些步骤保持主干历史完整，并将新功能分支替换为主干。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T20:17:56.063

合并从分支到主干的所有更改，然后解决所有冲突

```
svn resolve path --accept theirs-full 
```

或者，您可以告诉合并这样做：

```
svn merge -rX:HEAD url/of/branch trunk\wc --accept theirs-full 
```

在这样的合并之后，你有一个看起来像分支上的工作副本。您所要做的就是提交该主干的工作副本。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-25T20:28:02.933

Pre-1.5 这很简单：确保您的工作副本指向主干，然后执行“svn merge url-of-trunk url-of-branch”。您收到的更改是主干和分支之间的增量，有效地“为我提供使主干看起来像分支所需的一切”。

我不知道 1.5 的新合并功能是否会改变这种情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T20:20:30.987

我不太确定我理解你想要做什么。您希望在创建分支后对主干上所做的所有更改发生什么？当您在合并后查看文件的历史记录时，您是否希望它们不出现在日志中？如果是这样，这就是您删除主干并将分支复制到其位置时所得到的结果 - 分支在分支之前与主干共享历史记录，因此除了在分支之后进行的修订外，它是相同的。

如果你想保留主干的历史，但只是踩在分支和合并之间所做的所有更改，这是一个稍微棘手的问题。我认为，如果您进行忽略祖先的合并（有一个选项`--ignore-ancestry`），它将用分支替换主干的内容。您可能还想尝试`--force`使用合并选项（代替和结合使用`--ignore-ancestry`）。尝试几种不同的方法，看看你是否得到你想要的结果......

如果失败，您总是可以反向合并自分支点以来主干上的所有更改，然后合并到分支中。这似乎可能会导致一些冲突，您当然希望使用分支中的版本来解决这些冲突。我不知道这些想法是否是最佳的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-07-12T14:24:28.540

```
trunk       remplace (trunk with your branch)
*----x      * ---->
 \          |
  \         |
   *--------|
     branch 
```

这个分支是从主干创建的，所以要小心不要粗暴地删除主干（祖先的问题）。首先用你的后备箱做一个标签，你的备份，无论如何......

我建议这样做：

**使用 Eclipse SVN**

1.  单击右键 > 团队分支/标签（创建标签 - 您的备份）

2.  团队 > 切换另一个分支/标签...选择您的分支，确保该分支已正确加载。

3.  在分支中：团队 > 断开连接。删除 SVN 信息。

4.  团队>共享项目...选择您的主干。

5.  团队 > 在您的后备箱中提交。

6.  单击右键...选择比较...分支/标签->查找您的分支。如果一切正常，您将看到：“所选输入之间没有差异。”

我希望它有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-17T20:29:31.910

我认为您要做的是合并两棵树。下面我引用了 tortoisesvn 的文档（[https://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-merge.html](https://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-merge.html)）

“....您要求 Subversion 做的是：”计算获取 [From] 主干头修订版 [To] 主干头修订版分支所需的更改，并将它们应用到我的工作副本（主干） . **最终结果是主干现在看起来与分支完全一样。**"

在你的情况下，主干是从，到是分支

我希望这是有帮助的

# asp.net - 具有相对路径的 Asp.net 自托管 WCF 服务 WSDL

> ID：587609
> 
> 赞同：3
> 
> 时间：2009-02-25T20:03:16.753
> 
> 标签：asp.net, wcf, wsdl

我正在开发一个 WCF 应用程序，该应用程序将在此过程中部署到各种服务器，并且我希望不必记住每次进行部署时都更改 app.config。起初，我的 app.config serviceModel 部分如下所示：

```
<system.serviceModel>  
<serviceHostingEnvironment aspNetCompatibilityEnabled="false" />  
<behaviors>  
    <serviceBehaviors>  
        <behavior name="MyDefaultServiceBehavior">   
            <serviceMetadata httpGetEnabled="true" httpGetUrl="http://localhost:8888/MyService" />  
            <serviceDebug includeExceptionDetailInFaults="true" />  
        </behavior>  
    </serviceBehaviors>  
</behaviors>  
<services>  
    <service behaviorConfiguration="MyDefaultServiceBehavior" name="MyService">   
        <endpoint address="net.tcp://localhost:9001/MyService" binding="netTcpBinding" contract="IMyService" name="NetTcpBinding_IMyService" />  
    </service>  
</services> 
```

当我访问本地机器上运行的服务时，这在开发中运行良好。当我部署它时，WSDL 包含仍然指向 localhost 的绝对路径：

```
<xsd:import schemaLocation=http://localhost:8888/MyService?xsd=xsd0 namespace="http://tempuri.org/" /> 
```

因此，我可以像这样更改 app.config 中的 httpGetUrl：

```
<serviceMetadata httpGetEnabled="true" httpGetUrl=http://devserver1:8888/MyService /> 
```

现在 wsdl 可以在该服务器上正常工作。问题是我必须在每个部署的 app.config 中手动设置地址。

有没有办法：
1\. wsdl 是否已经包含所有内容以便没有导入？
或者
2\. 在 wsdl 导入语句中使用相对路径？

或任何其他建议将不胜感激。如果不是因为这个 wsdl 问题，我有两个开发服务器可以自动部署。

由于这只是为了生成代理，我想我可以自己生成代理并分发它，但我宁愿让用户自己生成代理。

谢谢！丹尼尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T22:08:55.833

您可以以编程方式设置[httpGetUrl](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.servicemetadatabehavior.httpgeturl.aspx)的值，并将其设置为包含托管服务的服务器的机器名称的绝对地址。然后，生成的 WSDL 中的导入语句也将使用服务器的机器名称。

如果正在为您创建 WCF 主机（例如，您在 IIS 下托管），那么您将需要创建自定义[ServiceHostFactory](http://msdn.microsoft.com/en-us/library/system.servicemodel.activation.servicehostfactory.aspx)以访问[ServiceHost](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicehost.aspx)。例如：

```
using System;
using System.ServiceModel;
using System.ServiceModel.Activation;
using System.ServiceModel.Description;

namespace WebApplication
{
  public class TestServiceHostFactory : ServiceHostFactory
  {
     protected override ServiceHost CreateServiceHost(Type serviceType, 
                                                      Uri[] baseAddresses)
      {
        ServiceHost host = base.CreateServiceHost(serviceType, 
                                                  baseAddresses);
        ServiceMetadataBehavior metadataBehavior = 
                                new ServiceMetadataBehavior();
        metadataBehavior.HttpGetEnabled = true;
        metadataBehavior.HttpGetUrl = new Uri(string.Format(
                              "http://{0}/WebApplication/TestService.svc", 
                              Environment.MachineName));
        host.Description.Behaviors.Add(metadataBehavior);
        return host;
      }
  }
} 
```

然后在服务的 .svc 文件中指定这个工厂：

```
<%@ ServiceHost Language="C#" 
                Service="WebApplication.TestService" 
                CodeBehind="TestService.svc.cs" 
                Factory="WebApplication.TestServiceHostFactory" %> 
```

如果您自己创建 WCF 主机，那么您的代码将如下所示：

```
ServiceHost host = new ServiceHost(typeof(WebApplication.TestService));
ServiceMetadataBehavior metadataBehavior = new ServiceMetadataBehavior();
metadataBehavior.HttpGetEnabled = true;
metadataBehavior.HttpGetUrl = new Uri(string.Format(
                              "http://{0}/WebApplication/TestService.svc", 
                              Environment.MachineName));
host.Description.Behaviors.Add(metadataBehavior); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T18:39:18.730

Daniel Richardson 上面留下的答案是一个很好的答案，我认为对于大多数人来说，这将是首选的解决方案。然而，由于我们的网络布局和需要访问我们服务器的少数人，我正在做一些不同的事情。

我已将 app.config 更改为包含“myServiceServer”的 httpGetUrl：

```
<serviceMetadata httpGetEnabled="true" httpGetUrl=http://myServiceServer:8888/MyService /> 
```

要使用我的服务，必须先添加一个主机文件条目，将“myServiceServer”映射到正确的 IP 地址。这对我们的问题很有效，因为无法从任何常见的机器名称或 IP 地址解析 IP 地址。这是因为分离的网络仅通过具有某种 NAT 的 VPN 连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-13T06:09:42.200

WCF 中显然有一个非常隐藏的选项，它支持使用与传入请求相同的主机名，这通常是正确的。（我认为它不是默认设置的唯一原因是为了向后兼容，尽管如果他们将其设为默认设置可能会更好。）

在我找到这颗特殊的宝石之前，我花了很多时间寻找和拉扯头发（虽然现在我知道了这个神奇的词，但我找到了另一个来自与我的类似旅程的[答案）。](https://stackoverflow.com/a/26854361/43534)

要启用它，请在添加的相同位置添加以下代码`ServiceMetadataBehavior`：

```
host.Description.Behaviors.Remove<UseRequestHeadersForMetadataAddressBehavior>();
host.Description.Behaviors.Add(new UseRequestHeadersForMetadataAddressBehavior()); 
```

# java - 在 Eclipse IDE 中调试 Java 时将异常捕获为表达式

> ID：587612
> 
> 赞同：21
> 
> 时间：2009-02-25T20:04:15.940
> 
> 标签：java, eclipse, debugging, exception

Java 开发人员的日常调试情况是抛出异常，然后您需要深入调试器以找出抛出异常的原因。通常您会尝试在抛出异常之前设置一些断点，并希望您能够确定导致该异常的情况。

在 Eclipse 中，断点可以定义一个表达式，仅当变量 x 等于值 y 时才会触发它。我的问题是，是否可以定义某种全局表达式，一旦抛出异常，它就会被调试器捕获，从而允许程序员立即检查所有变量？理想情况下，您还没有遇到 catch 块，Eclipse 会捕获引发的异常并停止执行，而不会更改堆栈内容。

这是可能的还是受到JVM的限制？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-25T20:40:31.623

另一个例子：**[Eclipse 提示：异常断点](http://blogs.bytecode.com.au/glen/2007/04/06/eclipse-tip--breakpoint-on-exception.html)**

Eclipse 允许您根据发生异常的位置设置断点。
您可以通过**“j！”访问该选项** **调试窗口中的**![http://help.eclipse.org/juno/topic/org.eclipse.jdt.doc.user/images/org.eclipse.jdt.debug.ui/elcl16/exc_catch.png](https://i.stack.imgur.com/ruAFi.png)图标（即，在“**[断点视图](http://publib.boulder.ibm.com/infocenter/rsahelp/v7r0m0/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/views/breakpoints/ref-breakpoints_view.htm)**”中）。

 **![添加 Java 异常窗口](https://i.stack.imgur.com/XzjEe.png)

官方帮助主题“**[添加 Java 异常断点](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/views/breakpoints/ref-addexception_viewaction.htm)**”对此有更多说明。

*   Uncaught Exception 选项是在未捕获位置抛出与断点相同类型的异常时暂停执行。
*   Caught Exception 选项是在捕获位置抛出与断点相同类型的异常时暂停执行。
*   不要忘记此**[异常的子类上的异常断点暂停](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/breakpoints/ref-suspendsubclass_option.htm)**：
    在遇到异常类型的子类时暂停执行。
    例如，如果一个异常断点`RuntimeException`被配置为在子类上挂起，它也会被`NullPointerException`.

![替代文字](https://i.stack.imgur.com/bjzDS.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T20:14:19.393

[http://agile.csc.ncsu.edu/SEMaterials/tutorials/eclipse-debugger/](http://agile.csc.ncsu.edu/SEMaterials/tutorials/eclipse-debugger/#section5_0)

特别是“5.0 特殊断点和观察表达式”部分。

# asp.net - 我可以使用 HTML 和 javascript 代理选择字段吗？

> ID：587628
> 
> 赞同：0
> 
> 时间：2009-02-25T20:07:44.450
> 
> 标签：asp.net, javascript, css

由于`<select>`元素的样式无法以可预测的方式进行，因此我正在考虑设置一个 javascript/html 代理元素来操作隐藏`<asp:dropdownlist>`字段。填充选择的代码超出了我的控制范围，但我不想呈现实际字段。

有没有人有这样的经验或指示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T20:37:59.853

这是 jQuery 的工作。你想要做的大致如下：

1.  使用css隐藏选择下拉菜单
2.  将选择元素的选项/值读出到 javascript 数组中。jQuery 擅长于此。
3.  使用 jQuery 为每个选项生成一个带有 li 元素的 ul 元素
4.  使用周围的许多方法将 ul 元素设置为下拉列表

这是一个这样做的人的例子：[http](http://www.brainfault.com/jquery-plugins/jquery-selectbox-replacement/) ://www.brainfault.com/jquery-plugins/jquery-selectbox-replacement/ 。您可能几乎可以按原样使用他的代码。该示例有点令人困惑，因为他将下拉列表样式设置为与选择元素完全一样。但是，如果您开始编辑 css，您可以让它看起来像您想要的任何方式。

# java - 对象/关系映射

> ID：587634
> 
> 赞同：1
> 
> 时间：2009-02-25T20:10:01.917
> 
> 标签：java, orm

在我们的 java 项目中，我们决定在对象的持久化中使用 ORM 对象/关系映射技术。

但是我们犹豫要不要使用特定的框架来做这个。那么，什么是最好的java框架可以完成这个任务呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T20:11:37.140

[休眠](http://www.hibernate.org/)是一个很好的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T20:18:16.890

正如[Chris](https://stackoverflow.com/questions/587634/object-relational-mapping/587640#587640)所说，Hibernate 是一个绝佳的选择。

可以在[维基百科上找到一个（非详尽的）列表](http://en.wikipedia.org/wiki/List_of_object-relational_mapping_software#Java)

Hibernate 是[JPA](http://en.wikipedia.org/wiki/Java_Persistence_API)的超集。如果您保持在 JPA 的范围内，那么理论上您可以稍后切换到不同的 JPA 实现......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T17:06:46.493

正如[toolkit](https://stackoverflow.com/users/3295/toolkit)所说的[Chris](https://stackoverflow.com/users/1551/chris-ballance)所说的，[Hibernate](https://stackoverflow.com/questions/587634/object-relational-mapping/587640#587640)是不二之选。

:D :D :D :D

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-11T11:02:19.563

当然是 Hibernate，但如果您寻求标准化，那么 JPA 或 JDO

# math - 矩阵运算枚举通过 n 部图的所有路径

> ID：587636
> 
> 赞同：5
> 
> 时间：2009-02-25T20:10:34.067
> 
> 标签：math, matrix, graph-theory

我有一个 n 部分（无向）图，作为邻接矩阵给出，例如这里的这个：

```
  A B C D
一个 0 1 1 0
b 0 0 0 1
c 0 0 0 1
d 0 0 0 0

```

我想知道是否有一组矩阵运算可以应用于这个矩阵，这将导致一个矩阵“列出”这个图中的所有路径（长度为 n，即通过所有分区）。对于上面的示例，有路径 a->b->d 和 a->c->d。因此，我想得到以下矩阵作为结果：

```
A B C D
1 1 0 1
1 0 1 1

```

第一条路径包含节点 a、b、d，第二条路径包含节点 a、c、d。如有必要，结果矩阵可能有一些全为 0 的行，如下所示：

```
A B C D
1 1 0 1
0 0 0 0
1 0 1 1
0 0 0 0

```

谢谢！

PS我看过计算传递闭包的算法，但这些通常只告诉两个节点之间是否存在路径，而不是直接告诉哪些节点在该路径上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T21:14:51.543

您可以做的一件事是计算矩阵 A 的 n 次方。结果将告诉您从任何一个顶点到任何另一个顶点的长度为 n 的路径有多少。

现在，如果您有兴趣了解路径上的所有顶点，我不认为使用纯矩阵运算是要走的路。请记住，您有一个 n 部图，我将按如下方式设置数据结构：（请记住，除了小值之外，所有空间成本都是昂贵的。）

每一列将有我们图中每个节点的一个条目。如果该节点在从我们指定的起始顶点或起始集的第 n 次迭代中可到达，则第 n 列将包含 1，否则为零。每个列条目还将包含指向第 n-1 列中顶点的反向指针列表，这些顶点指向第 n 列中的该顶点。（这类似于维特比算法，只是我们必须为每个条目维护一个反向指针列表，而不仅仅是一个。）这样做的复杂性是 (m^2)*n，其中 m 是图，n 是所需路径的长度。

我对您的顶部矩阵有点困惑：对于无向图，我希望邻接矩阵是对称的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-05-25T09:45:58.403

不，没有纯矩阵方式来生成所有路径。请使用纯组合算法。

“你可以做的一件事是计算矩阵 A 的 n 次方。结果将告诉你从任何一个顶点到任何另一个顶点的长度为 n 的路径有多少。”

矩阵的力量产生的是步行而不是路径。

# c - 什么是向量数组？

> ID：587637
> 
> 赞同：-1
> 
> 时间：2009-02-25T20:10:45.940
> 
> 标签：c, arrays, vector

我想在 C 中创建一个向量数组以在我的项目中使用。我以前没有使用过这样的数据结构，而且似乎找不到关于它的好信息。

您能否提供信息链接或发布描述此数据结构的有关其用途、优点和功能的信息。

实现文件也是有用的参考。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T20:22:11.013

“……好像找不到关于它的好资料。” 笏？

[谷](http://en.wikipedia.org/wiki/Vector_(STL))[歌](http://www.codeguru.com/cpp/cpp/cpp_mfc/arrays/article.php/c4071)[几乎](http://www.cplusplus.com/reference/stl/vector/)[是](http://www.csci.csusb.edu/dick/cs201/vectors.html) [王者](http://www.cprogramming.com/tutorial/stl/vector.html)。

首先了解它**是**什么。然后根据您的**研究**实施。您不仅需要了解向量是什么，还需要了解指针和结构。向你的导师寻求帮助，或者找一个同行来解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T20:26:59.300

这取决于您所说的条款是什么意思。“向量”有一个非常具体的数学定义，但不幸的是，在不知道你的目标是什么的情况下，“向量数组”有点模棱两可，因为向量在某种意义上是一个数组。

如果你在你的软件中做数学，你可能实际上想要一个向量数组，而不是一个数组又名向量。但是，这取决于您要完成的工作。（在我的工作中，我需要处理向量数据数组，其中向量是 3D 空间中的“位置”。）

最短的路径可能是键入：

`Vector my_array[4];`

...看看是否可以编译。如果没有，则您的代码库中没有可用的 Vector 对象/结构数组。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T20:18:47.997

查看`struct`：[C/C++ 结构和类](http://en.wikipedia.org/wiki/Composite_type#C.2FC.2B.2B_structures_and_classes)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T20:20:16.400

简单的谷歌搜索向量数组 c [http://www.codecogs.com/d-ox/array/vector.php](http://www.codecogs.com/d-ox/array/vector.php)

# sql-server - 设置报告服务器以从网络服务器中释放资源

> ID：587638
> 
> 赞同：4
> 
> 时间：2009-02-25T20:10:46.547
> 
> 标签：sql-server, security, coldfusion, report

耶，第一次发帖！（杰夫等人干得好。）

当我们开始允许用户按需生成报告时，我们正在尝试解决其中一个 Web 应用程序中的瓶颈问题。

我们的基础架构如下： 1 台服务器充当 Webserver/DBServer（ColdFusion 7 和 MSSQL 2005）

它为我们的后端用户和前端网站提供 Web 应用程序。报告由用户从后端生成，因此用户必须登录（基于 Web）具有一定的安全级别。

在生成报告的高峰时段，由于 SQL Server 将资源用于大量查询以及随后的 ColdFusion 生成多页 PDF，因此 Web 应用程序和前端网站的速度令人无法接受。

我们不确定消除一些负载的最佳做法是什么，但目前还不能选择限制对报告的访问。

我们已经考虑将数据非规范化到其他表以简化最常见的查询，但这似乎只会进一步推动问题。

因此，我们正在考虑获得第二台服务器并将其用作“报告服务器”，其中包含将运行查询的数据库的复制副本。这将解决一个问题，但第二个问题仍然存在：生成 PDF 是资源密集型的。

我们也想将该任务卸载到报告服务器，但是在安全的 Web 应用程序中，我们不能只触发 HTTP GET 来创建 PDF，用户从服务器 1 登录 Web 应用程序并将其显示在web-application 但在服务器 2 上生成/获取它而不验证用户的凭据...

有人有这方面的经验吗？提前感谢堆栈溢出！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T20:55:13.087

最基本的最佳实践是不要将 Web 服务器和数据库服务器放在同一硬件上。我会从那开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T13:33:22.097

“我们也希望将该任务卸载到报告服务器，但是在安全的 Web 应用程序中，我们不能只触发 HTTP GET 来创建 PDF，用户从服务器 1 登录 Web 应用程序并在其中显示它Web 应用程序但在服务器 2 上生成/获取它而不验证用户的凭据..."

为什么你不能？您正在使用世界上最简单的语言来编写 Web 服务。这是我的建议。

首先，将数据库移动到它自己的服务器上，从而将 cf 和 sql 服务器放在不同的服务器上。这样做的第一个原因是性能。如前所述，在同一台服务器上同时拥有 cf 和 sql 并不是一个理想的设置。第二个原因是为了安全。如果有人能够破解您的网络服务器，那么就在那里获取您的数据。您应该在 cf 和 sql 服务器之间安装防火墙，以提供更高的安全性。最后一个原因是可扩展性。如果您需要投入更多资源或集群您的数据库，则在它自己的服务器上会更容易。

现在用于网络服务。您可以做的是在另一台服务器上安装 cf 并编写 web 服务来处理报告的生成。只需锁定新的 cf 服务器以仅接受 ssl 连接并将用户的登录凭据传递给 web 服务。在您的网络服务中，在调用生成报告的方法之前对用户进行身份验证。

现在是pdf本身。我在传递中完成的方法之一是根据传递的一些参数（用户凭据和生成的用于运行查询的 sql）生成哈希，然后在生成 pdf 后，将哈希分配给 pdf 的名称并将其保存在磁盘上。现在您有了一个简单的缓存系统，您可以在其中查看 pdf 是否已经存在，如果存在，则返回它，否则生成并缓存它。

最后，您的问题不是大多数人以前从未见过的。你只需要做一些工作，你的应用程序就会更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T19:42:14.867

您必须区分生成 PDF 和进行计算之间的感知。两者都是单独的步骤。

你能做的是

1) 创建一个每天运行的报告计算表，并用所有报告的所有计算值填充它。

2) 当有人请求 PDF 报告时，让报告对预先计算的值进行简单的选择查询。与动态计算相比，它的数据库工作量要少得多。如果它使用精美的 pdf 设置，您可以使用 Coldfusion 生成 PDF。否则，您可能能够以文本形式使用原始 PDF 格式（类似于 html 标记），或者使用另一个库（cfx_pdf、合适的 java 库等）来生成它们。

如果用户不需要下载，只需要查看/打印报告，你能用闪纸逃脱吗？

另一种方法是建立一个报告队列。不管你是否把它放在第二台服务器上，如果你能摆脱它，CF 可以做什么，你可以将报告请求放入队列，并在处理时将它们通过电子邮件发送给用户。

然后，您可以通过计划的流程控制队列，以根据需要定期运行，并且一次只创建几个报告。我不确定这是否适合您的情况。

如上所述，执行存储过程也可能会有所帮助，并确保您在 MySQL 中正确设置了索引。我曾经有一个 3 分钟的查询，我把它缩短到 15 秒，因为我忘记在每个表中声明被大量使用的附加索引。

让我们知道怎么回事！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T21:13:04.743

除了建议分离网络和数据库服务器之外，我还尝试过：

a) 将查询移动到存储过程中，如果您还没有使用它们；

b) 通过调度程序生成报告，并将它们缓存在特殊表中，处于随时可用的状态，因此客户只需通过很少的快速查询来选择它们——这也应该减少客户的报告构建时间。

希望这可以帮助。

# database - 仅当对象不存在时才使用休眠将对象插入数据库

> ID：587641
> 
> 赞同：1
> 
> 时间：2009-02-25T20:11:40.710
> 
> 标签：database, hibernate, insert, exists

假设我有一个以 user_id 作为主键的映射用户对象，以及一个具有唯一约束的邮件列。我希望我的程序仅在用户表不存在时才将用户对象保存到用户表中。

我可以在我的插入函数中执行以下操作：

1.  开始交易
2.  使用给定邮件查询用户
3.  如果它不存在，创建一个新用户并使用会话保存它
4.  如果失败则提交或回滚

有两个问题：

1.  执行两个查询很昂贵。如果我使用纯 SQL，我可能会使用“INSERT IGNORE”语法，但在我的情况下，我想使用休眠保存方法，并且我想最后保存用户对象。有解决办法吗？
2.  并发。我的应用程序的两个实例是否有可能同时运行。两者都将使用具有相同“mail”参数的“addUser”函​​数。第一个将经历第 2 阶段，并且找不到使用该邮件的用户。第二个也将通过第 2 阶段而没有找到用户，因为第一个实例仍然没有保存他的用户并提交。然后第一个实例将保存并提交用户，然后第二个实例将保存并提交用户，该用户与第一个实例的邮件具有相同的邮件。当然它会失败，因为约束。我错过了什么吗？

如果我是对的，我应该怎么做：

1.  希望它不会发生。
2.  在事务开始时锁定用户表以进行读写。
3.  将 try...except 添加到函数中，这将排除唯一约束异常，如果抛出异常，将仅根据其邮件从数据库中选择用户。
4.  其他解决方案...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T20:16:55.097

你几乎总是有可能出现这样的情况，除非你引入了太多的锁定，你的系统变得无法使用。除非您知道这是一个问题，否则您应该只专注于优雅地处理违反唯一约束的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T01:11:28.900

> 您应该只专注于优雅地处理唯一约束违规。

您可以通过捕获将被抛出的 ConstraintViolationException 来做到这一点。如果您想要更细化，如果可能会发生多个约束破坏，您可以执行以下操作：

```
...
} catch (ConstraintViolationException e) {
    if (e.getConstraintName() != null && e.getConstraintName().toLowerCase().equals("the_name_of_your_contraint")) {
        // do something, like add an error to be displayed on the UI
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-22T10:11:26.693

现在我可以做到的独特方式是：

```
<sql-insert check="none" callable="true">
            {call saveOrUpdate (?, ?, ?, ?, ?)}
 </sql-insert> 
```

[http://forum.springsource.org/showthread.php?65265-Hibernate-insert-problem](http://forum.springsource.org/showthread.php?65265-Hibernate-insert-problem)

我无法使其工作的其他选项：

也许您可以使用@SQLInsert Hibernate 注释进行“插入不存在的位置”

下一个选项仅适用于编辑实例：

另一种选择是使用“带有版本列的乐观锁定”并在并发异常的情况下处理异常。

链接：[http ://docs.jboss.org/hibernate/core/3.3/reference/en/html/transactions.html#transactions-optimistic](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/transactions.html#transactions-optimistic)

# sql-server - 部署 WCF 服务

> ID：587644
> 
> 赞同：2
> 
> 时间：2009-02-25T20:12:39.303
> 
> 标签：sql-server, wcf, service

在接下来的几天里，我将在测试服务器（MS Server 2003 O/S）上部署我的第一个 WCF 服务。这个特定的服务只会对 SQL Server 2005 运行一些查询（很可能在同一个盒子上）并将值返回给调用者。

我的问题是，与“经典”Web 服务不同，使用 WCF，我现在可以选择部署/绑定。使用 IIS 托管这个东西与将其设置为 Windows 服务有优缺点吗？一个比另一个快吗？对此（至少现在）的调用者将是内部的，在 Intranet 上。如果他们使用 HTTP 或 TCP 有区别吗？同样，有速度差异吗？

希望我的问题是有道理的。就在过去的几天里，我一直在研究 WCF 服务。如果需要，我很乐意澄清。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T20:16:00.450

如果调用者在 Intranet 上，最好的办法是托管在 Windows 服务（或 Server 2008 上的 WAS）中并使用 TCP 传输协议。TCP 比使用 IIS 受限的基于 HTTP 的协议更快、更安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T02:05:46.833

有一种[解决方法](http://www.codeplex.com/CustomBasicAuth)，但如果将其托管在 IIS 上，[则不能使用自定义基本身份验证。](http://www.leastprivilege.com/WCFUsernamesOverTransportAndIISHosting.aspx)

# python - 如何用前导零增加一个值？

> ID：587647
> 
> 赞同：11
> 
> 时间：2009-02-25T20:13:22.673
> 
> 标签：python

增加包含前导零的值的最佳方法是什么？例如，我想增加“00000001”。但需要注意的是，前导零的个数不会超过 30 个。因此可能会出现“0000012”、“00000000000000099”或“000000000000045”等情况。

我可以想到几种方法，但我想看看是否有人想出了一些巧妙的方法。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-25T20:50:12.040

使用被忽视的 str.zfill()：

```
str(int(x) + 1).zfill(len(x)) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-25T20:15:43.430

```
int('00000001') + 1 
```

如果你想要前导零回来：

```
"%08g" % (int('000000001') + 1) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-25T20:23:18.360

"%%0%ii" % 长度 (x) % (int(x)+1)

——马库斯

PS 对于 x = "0000034" 它展开如下：

```
"%%0%ii" % len("0000034") % (int("0000034")+1)
"%%0%ii" % 7 % (34+1)
"%07i" % 35
"0000035" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T20:23:10.200

据推测，您的具体意思是一个整数，表示为带有前导零的字符串？

如果是这样的话，我会这样做：

```
>>> a
'00000000000000099'
>>> l = len(a)
>>> b = int(a)+1
>>> b
100
>>> ("%0"+"%dd" % l) % b
'00000000000000100' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T20:15:29.580

确定长度，将其转换为整数，递增，然后将其转换回带有前导零的字符串，使其具有与以前相同的长度。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T20:26:57.930

将您的号码存储为整数。当你想打印它时，添加前导零。这样，您无需转换即可轻松进行数学运算，并且简化了思考过程。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-01-24T05:27:22.170

“我的代码在 c 中” `int a[6]={0,0,0,0,0,0},i=5,k,p; while(a[0]!=10) { do { for(p=0;p<=i;p++) printf("%d",a[p]); printf("\n"); delay(100); a[i]++; }while(a[i]!=10); for(k=0;k<=i;k++) if(a[i-k]==10) { a[i-(k+1)]++; a[i-k]=0; } }`

# xml - 从 wsdl 中提取对象模式

> ID：587650
> 
> 赞同：2
> 
> 时间：2009-02-25T20:13:50.957
> 
> 标签：xml, xsd, wsdl

我有一个描述一组对象的 wsdl 文件，但我想仅从它们的一个子集中提取定义，这可能吗？如果可以，实现这一目标的最佳方法是什么？我的目标是为该子集生成 XSD 架构。

如果您不使用 .NET 中的 WSDL 生成工具怎么办？有没有使用其他工具完成此任务的好方法？我正在使用 Java，试图与 Web 服务交互。我有一个用于操作 xml 文档的库，它需要一个 xsd。我还有一个用于简单 SOAP 交互的库，这使得使用 Axis 过大了。如果我可以轻松地从 WSDL 中提取 XSD，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T17:31:21.487

如果您确切地知道要从模式中提取哪些对象，您可以获取 wsdl 文件，通过 XSL 转换运行它以保留您想要的部分（或删除您不需要的部分）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T19:45:35.723

我假设您正在谈论 ASP.NET 中的 wsdl 生成

在 ASP.NET 中，通过反射自动生成一个 wsdl 文件。这意味着当您使用时，程序集的每个 Web 方法都将被映射：

```
http://mysite/myservices.asmx?wsdl 
```

规避此限制的解决方法是：

1.禁用web.config中的默认文档生成

```
<webServices>
  <protocols >
    <remove name="Documentation"/>
  </protocols>
</webServices> 
```

2.使用 .net wsdl.exe 工具创建您自己的 wsdl 文件，并为您需要的子集编辑生成的 wsdl。

```
wsdl.exe http://mysite/myservices.asmx?wsdl 
```

3.发布修改后的wsdl：

```
http://mysite/myservices.wsdl 
```

作为最后的建议。如果可能的话，迁移到 WCF，它可以更好地控制 Web 服务。

警察 替我向马里奥问好 ;-)

# asp.net - ASP.NET 用户控件继承

> ID：587658
> 
> 赞同：0
> 
> 时间：2009-02-25T20:15:55.037
> 
> 标签：asp.net, inheritance, user-controls

我有一个运行良好的 UserControl。它是这样声明的。

```
public partial class DynamicList : System.Web.UI.UserControl
{
        protected static BaseListController m_GenericListController = null;

        public DynamicList()
        {
            m_GenericListController = new GenericListController(this);
        }
} 
```

现在我想覆盖这个控件，这样我就可以更改一些属性。我创建了一个这样的类。

```
public partial class JobRunningList : DynamicList
{
    public JobRunningList()
    {
        m_GenericListController = new JobListController(this);
        (m_GenericListController as GenericListController).ModuleId = 14;
    }
} 
```

看起来 DynamicList 中的控件没有被创建，尽管当我使用 JobRunningList 控件时，现在会导致可预见的坏结果。DynamicList UserControl 上有一个 ListView 和一些其他控件。使用 JobRunningList 时似乎没有创建这些。这有什么秘密吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T21:24:57.617

无聊的解决方法是将 JobRunningList 制作为普通的旧用户控件，其中包含一个 DynamicList 并仅在其 OnLoad 中设置内部控件的属性。但是，如果 DynamicList 有许多您想从页面访问的其他属性，那就很尴尬了，因为 JobRunningList 必须定义自己的匹配属性。回到继承方法，然后......

DynamicList 类只包含逻辑背后的代码，因此如果您希望第二个控件重用第一个控件背后的逻辑但提供自己的新 UI，那么您正在做的工作很好。

.ascx 文件中的标记被编译到另一个继承 DynamicList 的类中，因此如果您可以让 JobRunningList 类继承该类而不是 DynamicList，您将获得所需的结果。此类从文件名中获取默认名称，但您可以通过在控制指令中设置 ClassName 来代替自动名称来避免猜测。

采取一个简单的基本控制，如

```
<%@ Control Language="C#" AutoEventWireup="true"
            CodeFile="HelloControl.ascx.cs" Inherits="HelloControlBase"
            ClassName="MyControls.HelloControl" %>

Hello <%= Name %> 
```

带有令人兴奋的代码隐藏，例如

```
public partial class HelloControlBase : System.Web.UI.UserControl
{
    public string Name
    {
       get;
       set;
   }
} 
```

现在我们要覆盖新控件中的 Name 属性。首先我们需要 HelloAlice.ascx

```
<%@ Control Language="C#" AutoEventWireup="true"
            CodeFile="HelloAliceControl.ascx.cs"
            Inherits="HelloAliceControl" %> 
```

这里没什么可看的，因为我们把所有的工作都留给了原始的 ascx。现在在代码隐藏中，

```
public partial class HelloAliceControl : MyControls.HelloControl
{
    protected void Page_Load(object sender, EventArgs e)
    {
        this.Name = "Alice";
    }
} 
```

我们只是继承 MyControls.HelloControl 并设置 Name 属性，看起来我们已经完成了。

问题是知道 MyControls.HelloControl 何时可见。只要您的派生控件与父控件位于同一目录中，您可能就可以了，否则很容易遇到构建错误，抱怨该类不存在，因为父控件尚未编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T05:38:41.970

如果我理解正确，您希望界面相同。在这种情况下，我会创建一些属性。也许只是一个简单的枚举，即 ListType。

# asp.net - 使用 Web 服务进行 DotNetNuke 模块开发

> ID：587660
> 
> 赞同：5
> 
> 时间：2009-02-25T20:16:05.287
> 
> 标签：asp.net, web-services, dotnetnuke, module-packaging

我需要将 web 服务部署为我正在创建的 DotNetNuke 4.x 模块的一部分 - 但我不确定我该如何做到这一点，并且知道它会始终保持在同一个地方。如何将 asmx 文件添加到我的模块项目中，并在创建 .DNN 文件时指定 Web 服务的结束位置？我想使用“~/webservices/webservice.asmx”格式从模块的 ascx 文件中引用 web 服务。

DotNetNuke 是否有办法在 .DNN 文件中指定 Web 服务最终在站点上的位置？如果是这样，我是否仍然可以使用 ~/myservice.asmx 之类的根锚定标签来引用它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T20:38:26.310

您可以通过在部分中包含一个元素来包含 ASMX 文件`<files>`：

```
<files>
 <file>
  <name>YourWebService.asmx</name>
  <path></path>
 </file>
</files> 
```

通常，您不需要指定路径。

或者，您可以在包中包含 Resources.zip 文件，该文件将包含 DNN 在安装期间需要处理的文件以外的任何文件（例如，程序集和 SqlDataProvider 文件）。

这样做的好处是可维护性。使用 Resources.zip 将使您不必一遍又一遍地编辑清单文件......

zip 文件的内容将简单地解压缩到根模块目录（例如/DesktopModules/YourModule/*）。如果您的 zip 文件中有文件结构，它将被维护。

您需要将 TheNameOfYourFile.zip 添加到清单文件中的元素下。

`[snip]`

```
<folder>
  <name>Your Module</name>
  <friendlyname>Your Module</friendlyname>
  <foldername>YourModule</foldername>
  <modulename>YourModule</modulename>
  <description>A module for DotNetNuke websites.</description>
  <version>01.00.00</version>
  <resourcefile>Resources.zip</resourcefile>
  <businesscontrollerclass></businesscontrollerclass>
  <modules>
    <module> 
```

`[/snip]`

至于在您的模块中引用它 - 我建议使用：

```
<%=ResolveUrl("~/DesktopModules/YourModule/Services.asmx")%> 
```

# http - 为什么 haproxy 不能捕获我的 cookie？

> ID：587671
> 
> 赞同：0
> 
> 时间：2009-02-25T20:18:53.033
> 
> 标签：http, load-balancing, haproxy

我无法让前端 cookie 捕获在 haproxy 中工作。我的配置中有这个：

```
frontend frontend 0.0.0.0:9999
[snip]
capture cookie foo len 10 
```

然后我使用 nc 直接与服务器对话并发送它：

```
GET / HTTP/1.1
Cookie: foo=bar 
```

我得到一个日志行，但是捕获的 cookie 应该在哪里有一个“-”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T23:24:39.640

您使用的是 1.3.15.2 版本，但有一个 cookie 捕获错误直到 1.3.15.6 才修复。

# msbuild - 南安特 自定义输出目录

> ID：587672
> 
> 赞同：7
> 
> 时间：2009-02-25T20:19:00.180
> 
> 标签：msbuild, nant

我是 NAnt 的新手，并且能够创建一个`<target>`which

1) 从当前文件夹中删除任何代码

2) 从 SVN 导出新代码

3) 在 PrecompiledWeb 文件夹（它是一个 web 应用程序）的默认目录中构建代码

这里是：

```
<target name="export" description="export code from svn">
    <delete dir="${Delete.Dir}"></delete>
    <exec program="svn" commandline="export ${MySVN.Repos} ${MySVN.Dest}" />
    <msbuild project="${Solution.Filename}">
        <property name="Configuration" value="Release"/>
    </msbuild>
</target> 
```

我想指定一个自定义输出目录（“PrecompiledWeb”除外）。这是可能的吗？你能告诉我必要的标签/属性吗？

谢谢！

**编辑**

感谢 Scott 和 Si，我离解决方案越来越近了，但我仍然没有任何可行的方法。有评论让我看到了这篇关于[MSBuild 的输出路径属性的](http://www.markhneedham.com/blog/2008/08/14/msbuild-use-outputpath-instead-of-outdir/)文章。使用他们的代码：

```
<?xml version="1.0"?>
<project name="test" default="build" basedir="." xmlns="http://nant.sf.net/schemas/nant-0.84.win32.net-1.0.xsd">
    <target name="build">
        <exec program="${framework::get-framework-directory('net-3.5')}/msbuild.exe">
          <arg value="${Full.Path}\Code\MySolution.sln" />
          <arg value="/p:OutputPath=${Full.Path}\Output\" />
        </exec>
    </target>
</project> 
```

这将成功运行；但是，在我的包含网站和类库的解决方案中，它将类库 dll 发布到指定的输出路径，但*仍将*实际网站发布到默认的 PrecompiledWeb 文件夹。

有人对如何从 NAnt 更改 PrecompiledWeb 文件夹路径有任何建议吗？

再次感谢所有帮助过的人！

**编辑 2 最终解决方案**

这是我最终能够开始工作的内容（针对 .net 4 更新）：

```
<exec program="${framework::get-framework-directory('net-4.0')}/msbuild.exe">
    <arg value="${Full.Path}\Code\MySolution.sln" />
    <arg value="/t:Rebuild" />
    <arg value="/t:ResolveReferences" />
    <arg value="/t:_CopyWebApplication" />
    <arg value="/p:OutDir=${Build.Output}bin\" />
    <arg value="/p:WebProjectOutputDir=${Build.Output}" />
    <arg value="/p:Configuration=Release" />
</exec> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-25T21:56:16.997

可以为 msbuild 指定和覆盖某些属性。为了指定输出目录，覆盖**OutputDir**属性。

```
<target name="export" description="export code from svn">
        <delete dir="${Delete.Dir}" />
        <exec program="svn" commandline="export ${MySVN.Repos} ${MySVN.Dest}" />
        <msbuild project="${Solution.Filename}">
            <property name="Configuration" value="Release"/>
            <property name="OutputDir" value="${Output.Dir}"/>
        </msbuild>
</target> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-27T02:49:19.483

刚刚快速浏览了一个项目，**OutputPath**而不是 OutputDir 有帮助吗？

另一种选择可能是一个 Web 部署项目，我喜欢它，因为它调用 aspnet_compiler 以及 C# 编译器，因此它会发现您在部署之前可能会错过的问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-14T10:45:17.797

我们其中一个项目的构建脚本使用此命令发布 Web 应用程序：

```
msbuild.exe /t:_CopyWebApplication /p:Configuration=Release /p:OutDir=.\..\published\ /p:WebProjectOutputDir=.\..\published 
```

（此时当前目录设置为 web 应用程序的项目目录，这就是为什么没有指定 .csproj 文件的原因。整个解决方案已经在脚本的前面重新构建。）

听上去，**WebProjectOutputDir**可能是您需要的属性。

**/t:_CopyWebApplication**也可能很重要。我没有使用过 NAnt，所以我不知道您是否可以将此参数与 msbuild 任务一起传递。您可能需要使用 exec 任务，例如在此示例中：http: [//www.netomatix.com/development/wapwithnant.aspx](http://www.netomatix.com/development/wapwithnant.aspx)。此示例似乎可以一次性重建和复制所有内容。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-13T19:33:57.517

使用任务时，正确的属性名称是 OutDir，而不是 OutputDir：

```
 <msbuild project="${Solution.Filename}">
        <property name="Configuration" value="Release"/>
        <property name="OutDir" value="${Output.Dir}"/>
    </msbuild> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-14T12:38:52.777

混淆的来源是您正在混合两个不同的构建系统。您的 NAnt 目标正在委派所有工作，以找出如何将您的 Web 应用程序发布到解决方案文件，因此通过扩展它引用的 csproj 文件。

csproj 文件是 MsBuild 文件，因此您可能应该在那里寻找如何指导您的项目输出。[dave^2 的这篇文章](http://davesquared.blogspot.com/2007/08/example-of-deploying-web-apps-using.html)可能对这个问题有所帮助。

您可以使用 NAnt 在任何您想要的地方发布您的 Web 应用程序，前提是它正在执行发布。您可以对 MsBuild 执行相同的操作。您感到困惑的原因是 NAnt在这种情况下*没有*进行发布，并且您让 csproj 文件确定您的 Web 目录的位置。所以要么绕过 csproj 文件，让 NAnt（或 MsBuild）发布代码；或者修改csproj文件，把web应用发布到你想要的地方；或者为您的 Web 应用程序创建第二个位置并使用您的构建工具将其发布到那里。

AFAIK，这些选项很详尽。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T08:07:55.593

嗯，不知道如何在 Nant 中使用 MSBuild，但是使用 NAnt，我以前是这样完成的：

```
<solution solutionfile="${build.dir}\solution.sln">
    <webmap>
       <map url="http://localhost/somdir/project.csproj"
            path="c:\inetpub\wwwroot\somelocaldir" />
    <webmap>
</solution> 
```

但是，您正在使用 NAnt 的“解决方案”任务，而不是直接使用 MSBuild。

编辑：我也在看一些 msbuild 选项；如果将 OutDir & OutputPath 设置为相同的值，会发生什么？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-24T13:32:43.280

尝试这样的事情：

```
<property name="nant.settings.currentframework" value="net-3.5"/>    
<msbuild project="${Solution.Filename}">
    <property name="Configuration" value="Release"/>
    <property name="OutDir" value="${Full.Path}\Output\\"/>
    <property name="WebProjectOutputDir" value="${Full.Path}\Output\Web\\"/>
</msbuild> 
```

# sql - Database Disk Queue 太高，怎么办？

> ID：587675
> 
> 赞同：1
> 
> 时间：2009-02-25T20:19:24.373
> 
> 标签：sql, performance, sql-server-2000, ado

我正在使用的大型数据库存在一个问题，该数据库驻留在一个驱动器上 - 该数据库包含大约十几个表，其中两个主要的表大约为 1GB，不能更小。我的问题是，即使使用数据库的网站空闲，数据库驱动器的磁盘队列也在 96% 到 100% 左右。可以进行哪些优化或问题的根源是什么 磁盘上的数据库总共为 16GB，几乎所有数据都是必需的——交易数据、客户信息和库存详细信息。
无论网站流量如何，磁盘队列总是很高的原因是什么？
可以做些什么来帮助提高这种大小的数据库的性能？

任何建议，将不胜感激！

该数据库是在 Windows Server 2003 上运行的 MS SQL 2000 数据库，如所述大小为 16GB（磁盘上的数据文件大小）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T20:24:38.793

那么，你的机器上有多少内存？如果你不能将页面存储在内存中，SQL Server 将不得不去磁盘获取它的信息。如果您的内存不足，您可能需要考虑升级它。

由于数据库如此之大，您可能需要考虑添加两个单独的物理驱动器，然后将事务日志放在一个驱动器上，并将其他一些表分区到另一个驱动器上（您必须进行一些分析以查看最佳拆分表之间是）。

在这样做时，您允许 IO 访问并行发生，而不是串行发生，这应该会给您的数据库带来更多性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T20:38:36.077

在购买更多磁盘和转移之前，您还可以更新统计信息并检查您的查询 - 如果您正在执行大量表扫描等，您将为硬件创建不必要的工作。

毕竟你的数据库并没有那么大——我会先看看调整你的查询。您是否分析过哪些类型的查询正在访问数据库？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T21:09:13.037

如果您的站点空闲时磁盘活动如此之高，我会寻找可能正在运行的其他可能影响它的进程。例如，您确定没有任何计划的备份正在运行吗？特别是对于大型数据库，这些可能会运行很长时间。

As Mike W pointed out, there is usually a lot you can do with query optimization with existing hardware. Isolate your slow-running queries and find ways to optimize them first. In one of our applications, we spent literally 2 months doing this and managed to improve the performance of the application, and the hardware utilization, dramatically.

# unix - 为什么类 Unix 环境中的程序名称后有数字？

> ID：587676
> 
> 赞同：25
> 
> 时间：2009-02-25T20:19:56.150
> 
> 标签：unix, manpage

例如，当我运行`man ioctl`页面`IOCTL(2)`时，顶部显示。这意味着什么？有`IOCTL(1)`吗？以及如何在这些之间导航？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-25T20:21:13.277

这是手册页部分。从内存中，第 1 节是用户程序，第 2 节是系统调用，第 3 节是标准 C 库调用，第 5 节是文件格式。

[维基百科在这里](http://en.wikipedia.org/wiki/Man_page)有完整的解释。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-25T20:22:20.000

那是手册页的节号。例如

```
 man printf 
```

（应该）给你第 1 节，`printf`bash 命令，而

```
 man 3 printf 
```

给你 C 函数`printf`。

# json - 通过 JSON 加载 ASP.Net 用户控件的最佳方式是什么？

> ID：587678
> 
> 赞同：0
> 
> 时间：2009-02-25T20:20:12.377
> 
> 标签：json, asp.net-ajax

根据 JSON 请求将 asp.net 用户控件发送回浏览器的最佳方法是什么？

到目前为止，我有一个 Web 服务，它创建用户控件并将其发送回浏览器。但是，当我发回整个页面时，我收到一条错误消息“状态信息对此页面无效并且可能已损坏”。

考虑到我是 Json 的新手，我猜我做错了。最好的方法是什么？

我应该关闭视图状态验证吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-09-13T14:57:13.477

答：关闭视图状态验证。

# ios - 如何使用 presentModalViewController 创建透明视图

> ID：587681
> 
> 赞同：80
> 
> 时间：2009-02-25T20:20:42.077
> 
> 标签：ios, iphone, uiviewcontroller

我正在显示一个模态视图

```
[self presentModalViewController:controller animated:YES]; 
```

当视图在屏幕上移动时，根据创建它的 xib 文件中的设置，它是透明的，但是一旦它填满屏幕，它就会变得不透明。

无论如何保持视图透明？

我怀疑它被放置的视图没有被渲染，而不是模态视图变得不透明。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2011-04-07T09:49:57.193

在 iOS 3.2 之后，有一种方法可以做到这一点而无需任何“技巧”——[请参阅 modalPresentationStyle 属性的文档](https://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instp/UIViewController/modalPresentationStyle)。您有一个 rootViewController，它将显示 viewController。所以这是成功的代码：

```
viewController.view.backgroundColor = [UIColor clearColor];
rootViewController.modalPresentationStyle = UIModalPresentationCurrentContext;
[rootViewController presentModalViewController:viewController animated:YES]; 
```

使用此方法，viewController 的背景将是透明的，并且底层的 rootViewController 将是可见的。*请注意，这似乎只适用于 iPad，*请参阅下面的评论。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-02-25T21:22:55.407

您的视图仍然是透明的，但是一旦您的模态控制器位于堆栈的顶部，它后面的视图就会被隐藏（就像任何最顶层的视图控制器一样）。解决方案是自己手动为视图设置动画；那么后面的viewController就不会被隐藏（因为你不会'离开'它）。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2013-01-19T16:19:34.087

我需要让它工作：

```
self.window.rootViewController.modalPresentationStyle = UIModalPresentationCurrentContext; 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-08-30T15:55:14.807

对于那些想要查看一些代码的人，这是我添加到透明视图控制器中的内容：

```
// Add this view to superview, and slide it in from the bottom
- (void)presentWithSuperview:(UIView *)superview {
    // Set initial location at bottom of superview
    CGRect frame = self.view.frame;
    frame.origin = CGPointMake(0.0, superview.bounds.size.height);
    self.view.frame = frame;
    [superview addSubview:self.view];            

    // Animate to new location
    [UIView beginAnimations:@"presentWithSuperview" context:nil];
    frame.origin = CGPointZero;
    self.view.frame = frame;
    [UIView commitAnimations];
}

// Method called when removeFromSuperviewWithAnimation's animation completes
- (void)animationDidStop:(NSString *)animationID
                finished:(NSNumber *)finished
                 context:(void *)context {
    if ([animationID isEqualToString:@"removeFromSuperviewWithAnimation"]) {
        [self.view removeFromSuperview];
    }
}

// Slide this view to bottom of superview, then remove from superview
- (void)removeFromSuperviewWithAnimation {
    [UIView beginAnimations:@"removeFromSuperviewWithAnimation" context:nil];

    // Set delegate and selector to remove from superview when animation completes
    [UIView setAnimationDelegate:self];
    [UIView setAnimationDidStopSelector:@selector(animationDidStop:finished:context:)];

    // Move this view to bottom of superview
    CGRect frame = self.view.frame;
    frame.origin = CGPointMake(0.0, self.view.superview.bounds.size.height);
    self.view.frame = frame;

    [UIView commitAnimations];    
} 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2014-09-23T08:12:56.533

在 iOS 8 中，Apple 批准的方法是将 modalPresentationStyle 设置为 'UIModalPresentationOverCurrentContext'。

从 UIViewController 文档：

> **UIModalPresentationOverCurrentContext**
> 
> 仅在父视图控制器的内容上显示内容的演示样式。演示结束时，所呈现内容下方的视图不会从视图层次结构中删除。因此，如果呈现的视图控制器没有用不透明的内容填充屏幕，则底层内容会显示出来。
> 
> 在弹出窗口中呈现视图控制器时，仅当过渡样式为 UIModalTransitionStyleCoverVertical 时才支持此呈现样式。尝试使用不同的转换样式会触发异常。但是，如果父视图控制器不在弹出窗口中，您可以使用其他转换样式（部分卷曲转换除外）。
> 
> 在 iOS 8.0 及更高版本中可用。

[https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIViewController_Class/](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIViewController_Class/)

WWDC 2014 中的“iOS 8 中的视图控制器改进”视频对此进行了详细介绍。

确保为您呈现的视图控制器提供清晰的背景颜色（否则，它仍然会显得不透明）。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2011-03-26T00:04:42.223

还有另一种选择：在显示模态控制器之前，捕获整个窗口的屏幕截图。将捕获的图像插入 UIImageView 并将图像视图添加到您将要显示的控制器视图中。然后送回去。在图像视图上方插入另一个视图（背景黑色，alpha 0.7）。显示您的模态控制器，它看起来像是透明的。刚刚在运行 iOS 4.3.1 的 iPhone 4 上尝试过。喜欢魅力。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2014-03-08T16:23:51.167

这已经很老了，但我解决了以下相同的问题：由于我需要在 iPhone 中显示导航控制器，因此添加子视图不是一个可行的解决方案。

所以我做了什么：

1) 在展示视图控制器之前，对当前屏幕进行截图：

```
UIGraphicsBeginImageContextWithOptions(self.view.bounds.size, self.view.opaque, 0.0);
[self.view.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage * backgroundImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

2）创建您要呈现的视图控制器，并将背景添加为子视图，将其发送到后面。

```
UIViewController * presentingVC = [UIViewController new];
UIImageView * backgroundImageOfPreviousScreen = [[UIImageView alloc] initWithImage:backgroundImage];
[presentingVC.view addSubview:backgroundImageOfPreviousScreen];
[presentingVC.view sendSubviewToBack:backgroundImageOfPreviousScreen]; 
```

3) 展示您的视图控制器，但在此之前在新视图控制器中，在 viewDidLoad 中添加一个透明视图（我使用了 ILTranslucentView）

```
-(void)viewDidLoad
{
    [super viewDidLoad];
    ILTranslucentView * translucentView = [[ILTranslucentView alloc] initWithFrame:self.view.frame];
    [self.view addSubview:translucentView];
    [self.view sendSubviewToBack:translucentView];
} 
```

就这样！

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-10-26T10:14:14.523

[我在另一个问题](https://stackoverflow.com/a/13079501/588253)中写下了我的发现，但要点是你必须调用`modalPresentationStyle = UIModalPresentationCurrentContext`目前拥有全屏的任何东西。大多数时候，它是 [UIApplication sharedApplication].delegate.window 的 rootViewController。它也可能是一个新的 UIViewController，它带有`modalPresentationStyle = UIModalPresentationFullScreen`.

如果您想知道我是如何专门解决这个问题的，请阅读我的其他更详细的帖子。祝你好运！

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-09-15T17:44:14.810

这似乎在 IOS 8 中被破坏了，我正在使用导航控制器，并且正在显示的上下文是导航菜单上下文，在我们的例子中是滑动菜单控制器。

我们正在使用 pod 'TWTsideMenuViewController', '0.3' 尚未检查这是否是库或上述方法的问题。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2015-10-24T06:42:11.973

这在 iOS 8-9 中对我有用：

1- 使用 alpha 设置视图控制器的背景

2-添加此代码：

```
TranslucentViewController *tvc = [[TranslucentViewController alloc] init];
self.providesPresentationContextTransitionStyle = YES;
self.definesPresentationContext = YES;
[tvc setModalPresentationStyle:UIModalPresentationOverCurrentContext];

[self.navigationController presentViewController:tvc animated:YES completion:nil]; 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-05-06T15:10:59.353

我知道这是一个很老的问题。我被困在这个问题上，我能够从这个线程中获得线索。所以把我的工作原理放在这里:)。我正在使用情节提要，并且已经转到要呈现的 ViewController。视图控制器具有透明的背景颜色。现在在 segue 的属性检查器中，我将演示文稿设置为“在当前上下文中”。它对我有用。我正在为 iPhone 开发。

[![segue的属性检查器](https://i.stack.imgur.com/q0DS8.png)](https://i.stack.imgur.com/q0DS8.png)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2011-07-15T07:27:08.060

在我的情况下，我在同一个 viewController 上有视图。所以制作一个新的视图控制器来保存 UIView。通过设置它的 alpha 属性使该视图透明。然后在一个按钮上单击我写了这段代码。这看起来不错的样子。

```
UIGraphicsBeginImageContext(objAppDelegate.window.frame.size);
    [objAppDelegate.window.layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    UIViewController *controllerForBlackTransparentView=[[[UIViewController alloc] init] autorelease];
    [controllerForBlackTransparentView setView:viewForProfanity];

    UIImageView *imageForBackgroundView=[[UIImageView alloc] initWithFrame:CGRectMake(0, -20, 320, 480)];
    [imageForBackgroundView setImage:viewImage];

    [viewForProfanity insertSubview:imageForBackgroundView atIndex:0];

    [self.navigationController presentModalViewController:controllerForBlackTransparentView animated:YES]; 
```

它显示了我想要的。希望对某人有所帮助。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-08-10T17:57:29.250

我创建了开放源库[MZFormSheetController](https://github.com/m1entus/MZFormSheetController)以在其他 UIWindow 上呈现模态表单。您可以使用它来呈现透明度模态视图控制器，甚至可以调整呈现的视图控制器的大小。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2012-01-17T12:15:51.130

这是我创建的一个可以解决问题的类别。

```
 //
    //  UIViewController+Alerts.h
    //

    #import <UIKit/UIKit.h>

    @interface UIViewController (Alerts)

    - (void)presentAlertViewController:(UIViewController *)alertViewController animated:(BOOL)animated;
    - (void)dismissAlertViewControllerAnimated:(BOOL)animated;

    @end

    //
    //  UIViewController+Alerts.m
    //

    #import "UIViewController+Alerts.h"

    @implementation UIViewController (Alerts)

    - (void)presentAlertViewController:(UIViewController *)alertViewController animated:(BOOL)animated
    {
            // Setup frame of alert view we're about to display to just off the bottom of the view
            [alertViewController.view setFrame:CGRectMake(0, self.view.frame.size.height, alertViewController.view.frame.size.width, alertViewController.view.frame.size.height)];

            // Tag this view so we can find it again later to dismiss
            alertViewController.view.tag = 253;

            // Add new view to our view stack
            [self.view addSubview:alertViewController.view];

            // animate into position
            [UIView animateWithDuration:(animated ? 0.5 : 0.0) animations:^{
                    [alertViewController.view setFrame:CGRectMake(0, (self.view.frame.size.height - alertViewController.view.frame.size.height) / 2, alertViewController.view.frame.size.width, alertViewController.view.frame.size.height)];
            }];      
    }

    - (void)dismissAlertViewControllerAnimated:(BOOL)animated
    {
            UIView *alertView = nil;

            // find our tagged view
            for (UIView *tempView in self.view.subviews)
            {
                    if (tempView.tag == 253)
                    {
                            alertView = tempView;
                            break;
                    }
            }

            if (alertView)
            {
                    // clear tag
                    alertView.tag = 0;

                    // animate out of position
                    [UIView animateWithDuration:(animated ? 0.5 : 0.0) animations:^{
                            [alertView setFrame:CGRectMake(0, self.view.frame.size.height, alertView.frame.size.width, alertView.frame.size.height)];
                    }];      
            }
    }

    @end 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-06-17T01:58:23.100

经过大量研究后，看起来这将解决我们的问题并达到我们的目的。

使用标识符创建从源 VC 到目标 VC 的 segue。

例如“goToDestinationViewController”可以让生活变得轻松让我们考虑当前的视图控制器，即你想要在透明视图后面的那个作为源，目的地作为目的地

现在在 viewDidLoad: 或视图中的源 VC

```
performSegueWithIdentifier("goToDestinationViewController", sender: nil) 
```

很好，我们已经完成了一半。现在去你的故事板。点击转场。应该是这样的： [segue](http://i.stack.imgur.com/vwkOn.png)

将选项更改为显示的内容。

现在是真正的解决方案。

在您的目标视图控制器的 viewDidLoad 中添加此代码。

```
self.modalPresentationStyle = .Custom 
```

..................................................... ........................这很容易............ .........................................................

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-08-14T09:29:17.040

另一种方法是使用“容器视图”。只需将 alpha 设为 1 以下并嵌入 sequ。XCode 5，针对 iOS7。

无法显示图像，没有足够的声誉）））

iOS6 提供的容器视图。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-09-22T23:20:57.383

此代码在 iOS6 和 iOS7 下的 iPhone 上运行良好：

```
presentedVC.view.backgroundColor = YOUR_COLOR; // can be with 'alpha'
presentingVC.modalPresentationStyle = UIModalPresentationCurrentContext;
[presentingVC presentViewController:presentedVC animated:YES completion:NULL]; 
```

但是沿着这种方式，您会失去“从底部滑动”的动画。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-06-09T14:28:34.750

我为 iOS 7 及更高版本找到了这个优雅而简单的解决方案！

对于 iOS 8，Apple 添加了 UIModalPresentationOverCurrentContext，但它不适用于 iOS 7 及之前的版本，因此我无法将其用于我的案例。

请创建类别并输入以下代码。

.h 文件

```
typedef void(^DismissBlock)(void);

@interface UIViewController (Ext)

- (DismissBlock)presentController:(UIViewController *)controller
              withBackgroundColor:(UIColor *)color
                         andAlpha:(CGFloat)alpha
                presentCompletion:(void(^)(void))presentCompletion;

@end 
```

.m 文件

```
#import "UIViewController+Ext.h"

@implementation UIViewController (Ext)

- (DismissBlock)presentController:(UIViewController *)controller
              withBackgroundColor:(UIColor *)color
                         andAlpha:(CGFloat)alpha
                presentCompletion:(void(^)(void))presentCompletion
{
    controller.modalPresentationStyle = UIModalPresentationCustom;

    UIWindow *keyWindow = [UIApplication sharedApplication].keyWindow;
    __block UIView *overlay = [[UIView alloc] initWithFrame:keyWindow.bounds];
    if (color == nil) {
        color = [UIColor blackColor];
    }
    overlay.backgroundColor = color;
    overlay.alpha = alpha;

    if (self.navigationController != nil) {
        [self.navigationController.view addSubview:overlay];
    }
    else if (self.tabBarController != nil) {
        [self.tabBarController.view addSubview:overlay];
    }
    else {
        [self.view addSubview:overlay];
    }

    self.modalPresentationStyle = UIModalPresentationCurrentContext;
    [self presentViewController:controller
                       animated:true
                     completion:presentCompletion];

    DismissBlock dismissBlock = ^(void) {
        [self dismissViewControllerAnimated:YES completion:nil];
        [UIView animateWithDuration:0.25
                         animations:^{
                             overlay.alpha = 0;
                         } completion:^(BOOL finished) {
                             [overlay removeFromSuperview];
                         }];
    };
    return dismissBlock;
}

@end 
```

注意：它也适用于 navigationContoller、tabBarController。

使用示例：

```
 // Please, insure that your controller has clear background
       ViewController *controller = [ViewController instance];
        __block DismissBlock dismissBlock = [self presentController:controller
                                                withBackgroundColor:[UIColor blackColor]
                                                           andAlpha:0.5
                                                  presentCompletion:nil];
        // Supposed to be your controller's closing callback
        controller.dismissed = ^(void) {
            dismissBlock();
        }; 
```

好好享受！请留下一些反馈。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-09-11T17:24:06.120

这是迄今为止我发现的最好和最干净的方法：

```
@protocol EditLoginDelegate <NSObject>

- (void)dissmissEditLogin;

@end

- (IBAction)showtTransparentView:(id)sender {

    UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:@"foo bar"
                                                         delegate:self
                                                cancelButtonTitle:@"cancel"
                                           destructiveButtonTitle:@"destructive"
                                                otherButtonTitles:@"ok", nil];

    [actionSheet showInView:self.view];

}

- (void)willPresentActionSheet:(UIActionSheet *)actionSheet{

    UIStoryboard *loginStoryboard     = [UIStoryboard storyboardWithName:@"Login" bundle:nil];
    self.editLoginViewController      = [loginStoryboard instantiateViewControllerWithIdentifier:@"EditLoginViewController"];

    self.editLoginViewController.delegate = self;

    [self.editLoginViewController viewWillAppear:NO];
    [actionSheet addSubview:self.editLoginViewController.view];
    [self.editLoginViewController viewDidAppear:NO];
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-08-01T13:31:03.427

我遇到的最佳解决方案是使用 addChildViewController 方法。这是一个很好的例子：[将子视图控制器的视图添加到父视图控制器的子视图中](https://stackoverflow.com/questions/17011579/add-a-child-view-controllers-view-to-a-subview-of-the-parent-view-controller)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-09-02T06:54:25.640

我尝试使用多种方法解决但仍然失败，最终实现以下代码。

斯威夫特的决议：

```
// A.swift init method
modalPresentationStyle = .currentContext // or overCurrentContent
modalTransitionStyle = .crossDissolve // dissolve means overlay 
```

然后在 B 视图控制器中：</p>

```
// B.swift
let a = A()
self.present(a, animated: true, completion: nil) 
```

# macos - 是否有可能以更容易解析的格式获得 ioreg 的输出？

> ID：587693
> 
> 赞同：3
> 
> 时间：2009-02-25T20:25:27.153
> 
> 标签：macos

我需要`ioreg`在 Mac OS X 中获取输出以进行进一步处理，但是它使用的树状结构很难解析？有没有办法以 XML 或更容易解析的方式获取输出（如`system_profiler`）？

```
+-o Root  <class IORegistryEntry, retain 12>
  | {
  |   ...
  | }
  | 
  +-o MacBookPro5,1  <class IOPlatformExpertDevice, registered, matched, active, busy 0, retain 25>
    | {
    |   ...
    | }
    | 
    +-o AppleACPIPlatformExpert  <class AppleACPIPlatformExpert, registered, matched, active, busy 0, retain 51>
    | | {
    | |   ... 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T20:29:45.830

路漫漫其修远兮，可将源码抓取到ioreg并修改...

[https://opensource.apple.com/source/IOKitTools/IOKitTools-108/ioreg.tproj/](https://opensource.apple.com/source/IOKitTools/IOKitTools-108/ioreg.tproj/)

下载：

*   [ioreg.c](https://opensource.apple.com/source/IOKitTools/IOKitTools-108/ioreg.tproj/ioreg.c)
*   [IOKitLibPrivate.h](https://opensource.apple.com/source/IOKitUser/IOKitUser-1445.40.1/IOKitLibPrivate.h)
*   [IOKitKeysPrivate.h](https://opensource.apple.com/source/xnu/xnu-4570.41.2/iokit/IOKit/IOKitKeysPrivate.h)

`#include <IOKit/IOKitLibPrivate.h>`将and更改`#include <IOKit/IOKitKeysPrivate.h >`为`#include "IOKitLibPrivate.h"`，`#include "IOKitKeysPrivate.h"`这样您就可以在两个文件位于同一目录中时进行编译，然后使用

```
cc -o ioreg ioreg.c -framework Foundation -framework IOKit -lcurses 
```

# oop - 这个二传手是“邪恶的”吗

> ID：587695
> 
> 赞同：3
> 
> 时间：2009-02-25T20:26:31.753
> 
> 标签：oop, setter

有很多关于 getter 和 setter 是“邪恶”的讨论。

我的问题是：下面的二传手是邪恶的吗？（为简洁起见，其余课程省略）

```
int balance

public void deposit(int amount)  
{  
    this.balance += amount;  
} 
```

此类正在模拟 ATM。在英国，有一些 ATM 可以让您存款和取款，因此该对象需要一种更改其状态（余额）的方法。这个二传手是“邪恶的”吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T20:28:14.027

除了没有处理异常情况这一事实之外，它看起来是一个非常好的 OO 方法——它被称为它所做的，它做你所期望的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-25T20:32:23.797

我不认为这是人们谈论 getter 和 setter 的意思，因为这不仅仅是将成员设置为给定值。

我不关心 setter 和 getter，但主要是因为我认为我的“对象”是代码库中更高级别的实体。例如（IMO）在课堂外进行操作会“更错误”：

```
account.SetBalance(account.GetBalance() + depositAmount) 
```

相反，您已经在对象中实现了更高级别的功能；你存了一笔钱，然后让对象找出处理它的正确方法。与我上面给出的 getter/setter 示例相比，这允许对异常条件进行更集中的处理。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-25T20:46:27.897

这是一个技巧问题吗？我问是因为提供的方法甚至不是“setter”方法。这是一个操作，而不是一个属性。Setter 和 Getter 通常是私有变量（属性）的访问器方法。所以我想你的问题的答案是：

这不是 setter，但作为对对象执行操作的通用方法，它一点也不邪恶。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-25T20:28:39.657

对于一个类来说，通过 setter 设置值并没有什么坏处，但这更像是一个函数而不是直接的 setter。是的，它设置属性的值，但它通过添加而不是替换先前的值来实现，并且名称不对齐。

真正的“二传手”看起来更像这样：

```
int balance

private void setBalance(int amount)
{
    this.balance = amount;
}

public void deposit(int amount)  
{  
    setBalance(this.balance + amount);  
} 
```

但是，对于您的特定 ATM 问题，我非常怀疑 ATM 是否会立即为您的余额添加存款。它可能需要通过单独的机制收集和发布。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T20:36:53.257

就个人而言，我将其称为方法，而不是设置器。刻板的二传手将是

```
public void deposit(int new_balance)
{
    this.balance = new_balance;
} 
```

它所做的只是让您直接访问类的内部，从而破坏通过封装它们和限制访问而获得的任何价值。这就是人们不喜欢它们的原因。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T20:29:37.470

好吧，您可能想检查负数、零数等……但给出要求就可以了。

遵循这个经验法则，你创建的每个变量都应该是最终的，除非它必须更改，并且永远不要为实例变量设置方法，除非你真的希望它们在类之外进行更改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T21:19:51.093

那不是二传手，它是一种正常的方法

即使是二传手，也不是邪恶的

这是一个邪恶的二传手

```
int _balance = 0;  
public int Balance()  
{  
    get { return _balance; }  
    set { }    //now that's evil!  
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T20:40:53.403

IMO，ATM不应将“余额”作为字段。

（此外，您的“存款”方法不是二传手）

您可能应该有一个带有“余额”字段的 Account 对象，并且可能有一个方便的方法“modifyBalance”，它采用正值来增加余额或负值来减少余额。

然后，当执行这些类型的交易时，您的 ATM 方法将在 Account 对象上调用“modifyBalance”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T20:46:15.417

您无法判断单个方法是否邪恶，这取决于上下文以及谁可以访问该对象。

如果您对所有字段都有 getter 和 setter，并且每个人和他的狗都可以访问该对象，那么这是非常糟糕的，因为基本上没有数据封装。

另一方面，如果您只为需要它的字段设置了设置器，并且该对象只为少数需要与之通信的其他对象所知，那么这将是完全可以的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-25T20:49:44.643

那不是二传手。这是一个普通的方法（或成员函数，或其他）。

setter 是将给定变量设置为给定值的函数，通常是一个坏主意。方法是执行给定类操作的函数。就班级而言，这是有意义的。

如果你有一个奇怪的数据结构，你可能实际上没有一个“平衡”变量。无论你的数据结构是什么，你都必须有一个“存款”功能。有一部分的不同。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-25T20:30:19.700

不必要; 您提到您想模仿 ATM（自动取款机）的行为。而且您担心自动取款机可以让您存款和取款。但是这些操作，存款和取款，必须是序列化的。你需要你的所有动作都是原子的，所以这种方法比你尝试做更多事情的方法要好。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-25T20:35:47.783

我看到的一个问题是您在处理金钱时使用的是整数类型。如果这是一个定点数，则不是问题，但没有迹象表明确实如此。

# wpf - WPF：在网格和列表框中调整图像大小

> ID：587698
> 
> 赞同：1
> 
> 时间：2009-02-25T20:27:17.227
> 
> 标签：wpf, image, listbox, grid

我有一个水平滚动的 ListBox，每个项目由一个两行网格组成。第一行包含一个图像，第二行是一个边框，用于渲染第一行的反射。
（是的，是的。我知道。又一次封面流尝试......）

我需要一些关于图像大小的帮助。如果我没有指定任何尺寸，它将以全尺寸呈现图像，但我希望它受到网格行高度的限制。如果窗口调整大小，图像应该调整大小。

有什么线索吗？

**更新：**
我现在稍微更改了代码。首先，我删除了一个不必要的触发器，但重要的部分是

*   禁用列表框上的垂直滚动条。
*   移除了coverImage上的高度
*   从 layoutTransformation 更改为 RenderTransformation
*   缩小非选定项目而不是缩放选定项目。

这给了我几乎我想要的东西。在coverImage 和coverReflection 之间有一个我找不到原因的差距。任何线索，也许我应该发布一个新问题......？

**第二次更新：**
我想我现在有一个解决反射差距的方法。不过感觉有点尴尬。我想有更好的方法来做到这一点。

我所做的是 - 我不再翻转边框，而是翻转视觉画笔。- 我为视觉画笔添加了 TileMode="Tile"

现在，我不确定为什么会这样，但它已经接近我想要的了，所以......

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    mc:Ignorable="d" 
    x:Class="UntitledProject1.Window1"
    x:Name="Window"
    Title="Window1"
    Width="801" Height="786">
    <Window.Resources>
        <XmlDataProvider x:Key="dataProvider" XPath="Bilder">
            <x:XData>
                <Bilder xmlns="">
                    <Bilde>75760-1_-8589666289339775808.jpg</Bilde>
                    <Bilde>73255-3_-8589662994232744558.jpg</Bilde>
                    <Bilde>75760-1_-8589666289339775808.jpg</Bilde>
                    <Bilde>73255-3_-8589662994232744558.jpg</Bilde>
                    <Bilde>75760-1_-8589666289339775808.jpg</Bilde>
                    <Bilde>73255-3_-8589662994232744558.jpg</Bilde>
                </Bilder>
            </x:XData>
        </XmlDataProvider>

        <ControlTemplate x:Key="listControlTemplate" TargetType="{x:Type ListBoxItem}">
            <Grid x:Name="listItemGrid">
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>      
                <Image x:Name="coverImage" 
                       Source="{Binding Path=InnerText}"  
                       Stretch="Uniform" 
                       HorizontalAlignment="Stretch" 
                       VerticalAlignment="Bottom"  
                       Grid.Row="0" 
                       RenderTransformOrigin="0.5,1">
                    <Image.RenderTransform>
                        <TransformGroup>
                            <ScaleTransform ScaleX="0.7" ScaleY="0.7"/>
                            <SkewTransform AngleX="0" AngleY="0"/>
                            <RotateTransform Angle="0"/>
                            <TranslateTransform X="0" Y="0"/>
                        </TransformGroup>
                    </Image.RenderTransform>
                </Image>
                <Border x:Name="coverReflection" 
                        RenderTransformOrigin="0.5,0" 
                        Height="{Binding Path=ActualHeight, ElementName=coverImage, Mode= Default}" 
                        VerticalAlignment="Top" 
                        Grid.Row="1"
                        >
                    <Border.OpacityMask>
                        <LinearGradientBrush EndPoint="0.0,1" StartPoint="0.0,0">
                            <GradientStop Color="#00000000" Offset="0.6"/>
                            <GradientStop Color="#BBFFFFFF" Offset="0"/>
                        </LinearGradientBrush>
                    </Border.OpacityMask>
                    <Border.RenderTransform>
                        <TransformGroup>
                            <ScaleTransform ScaleX="0.7" ScaleY="0.7"/>
                            <SkewTransform AngleX="0" AngleY="0"/>
                            <RotateTransform Angle="0"/>
                            <TranslateTransform X="0" Y="0"/>
                        </TransformGroup>
                    </Border.RenderTransform>
                    <Border.Background>
                        <VisualBrush Visual="{Binding ElementName=coverImage}" TileMode="Tile">
                            <VisualBrush.Transform>
                                <TransformGroup>
                                    <ScaleTransform ScaleX="1" ScaleY="-1"/>
                                    <SkewTransform AngleX="0" AngleY="0"/>
                                    <RotateTransform Angle="0"/>
                                    <TranslateTransform X="0" Y="0"/>
                                </TransformGroup>                               
                            </VisualBrush.Transform>
                        </VisualBrush>
                    </Border.Background>
                </Border>               
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsSelected" Value="True">                    
                    <Setter Property="RenderTransform" TargetName="coverImage">
                        <Setter.Value>
                            <TransformGroup>
                                <ScaleTransform ScaleX="1" ScaleY="1"/>
                                <SkewTransform AngleX="0" AngleY="0"/>
                                <RotateTransform Angle="0"/>
                                <TranslateTransform X="0" Y="0"/>
                            </TransformGroup>
                        </Setter.Value>
                    </Setter>                   
                    <Setter Property="RenderTransform" TargetName="coverReflection">
                        <Setter.Value>
                            <TransformGroup>
                                <ScaleTransform ScaleX="1" ScaleY="1"/>
                                <SkewTransform AngleX="0" AngleY="0"/>
                                <RotateTransform Angle="0"/>
                                <TranslateTransform X="0" Y="0"/>
                            </TransformGroup>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <Style TargetType="{x:Type ListBoxItem}" x:Key="listStyle">
            <Setter Property="Template" Value="{StaticResource listControlTemplate}" />
        </Style>
    </Window.Resources>
    <Window.BindingGroup>
        <BindingGroup/>
    </Window.BindingGroup>

    <Grid x:Name="LayoutRoot" DataContext="{Binding Source={StaticResource dataProvider}, XPath=/Bilder/Bilde}">
        <ListBox ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                 ScrollViewer.VerticalScrollBarVisibility="Disabled"
                 ItemsSource="{Binding }" 
                 IsSynchronizedWithCurrentItem="True" 
                 Background="#FF000000"
                 ItemContainerStyle="{StaticResource listStyle}" 
                 VerticalAlignment="Stretch"
                 >
            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <VirtualizingStackPanel IsItemsHost="True" Orientation="Horizontal" />
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>
        </ListBox>
    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T22:09:49.507

修改 的样式`ListBoxItem`以包含`Height`绑定到`ListBox.ActualHeight`属性的属性的设置器：

```
 <Style TargetType="{x:Type ListBoxItem}" x:Key="listStyle">
        <Setter Property="Template" Value="{StaticResource listControlTemplate}" />
        <Setter Property="Height" Value="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListBox}}, Path=ActualHeight}" />
    </Style> 
```

这将使您的物品与其容器一样高。从那里开始，您可以将控件模板中的 Grid 绑定到其模板化父级的 ActualHeight 并调整图像大小。你必须玩一点才能达到高度差。例如，您可以在包含图像的行上方创建行，并为选定的图像更改其 Row 和 RowSpan 属性，并使用 setter。

# php - 模板和while循环

> ID：587701
> 
> 赞同：2
> 
> 时间：2009-02-25T20:28:19.347
> 
> 标签：php

我正在制作一个简单的模板系统。不能将代码保留在 PHP 文件中并将其输出到 html 文件中，这很烦人......在模板中包含这个并不好：

```
<?php 
while ($row = mysql_fetch_array($query)) { 
$name = $row['forum_name'];
$date = $row['forum_date'];
$desc = $row['forum_description'];
$lastpost = $row['forum_lastpost'];
?>

<h1><?php echo $name ?></h1>
<p><?php echo $desc ?></p>

<?php } ?> 
```

有什么方法可以将代码保留在 PHP 文件中吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T20:48:06.240

我建议在 php 文件中进行查询和处理，而不是在模板中。在 php 文件中构建一个数组，然后让模板显示它。

这就是我通常的做法：

PHP 文件：

```
for ($i = 0; $row = mysql_fetch_array($query); $i++)
{
    $forums[$i]['name'] = $row['forum_name'];
    $forums[$i]['date'] = $row['forum_name'];
    $forums[$i]['desc'] = $row['forum_description'];
    $forums[$i]['lastpost'] = $row['forum_lastpost'];
} 
```

模板文件：

```
<?php foreach ($forums as $forum) { ?>
    <h1><?=$forum['name']?></h1>
    <p><?=$forum['desc']?></p>
<?php } // foreach ($forums as $forum) ?> 
```

正如 glavić 所示，另一种语法是使用“endwhile”：

```
<?php foreach ($forums as $forum): ?>
    <h1><?=$forum['name']?></h1>
    <p><?=$forum['desc']?></p>
<?php endforeach; ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T22:20:07.237

我喜欢使用 PHP 作为模板引擎并使用 MVC 模式。为了保持视图和业务逻辑分离，视图中只允许使用几种 PHP 代码，即 HTML 代码。允许的代码是：

```
* Single functions
* Alternate format If / Else / ElseIf blocks
* Alternate format For loops
* Alternate format Foreach loops
* Alternate format Switch statements 
```

PHP 为它的一些控制结构提供了另一种语法；即 if、while、for、foreach 和 switch。在每种情况下，备用语法的基本形式是将左大括号更改为冒号 (:)，将右大括号更改为 endif;、endwhile;、endfor;、endforeach; 或 endswitch;。这些替代格式是应在视图中使用的唯一格式。

我承认替代的 PHP 语法更慢（因为解释器正在跳入和跳出 PHP 标记）。但是，这通常相当于几毫秒的处理时间，与当今大多数环境中的服务器几乎没有区别。

最后，我更喜欢在视图中使用速记 PHP 标记。这通常被认为是一个坏主意，因为服务器支持较少。但是，我相信它稍微提高了可读性（特别是在使用 PHP 作为模板引擎时），我通常会避免使用我无法控制这些事情的网络主机。

我对此进行了更详细的描述，并在我的网页上提供了一些关于我为基于 Web 的 PHP 应用程序创建的模板的示例。您可以在下面的 URL 中找到它。

[http://www.joeldare.com/wiki/applate](http://www.joeldare.com/wiki/applate)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T20:37:53.970

您可以使用[http://dwoo.org/ 之类的模板引擎](http://dwoo.org/)

或使用替代语法，如：

```
<?php while ($row = mysql_fetch_array($query)): ?>
    <h1><?=$row['forum_name']?></h1>
    <p><?=$row['forum_description']?></p>
<?php endwhile; ?> 
```

# c++ - Windows API：检测驱动程序安装何时完成

> ID：587703
> 
> 赞同：4
> 
> 时间：2009-02-25T20:28:28.363
> 
> 标签：c++, windows, bluetooth, driver

我正在编写一些使用 Windows[蓝牙 API](http://msdn.microsoft.com/en-us/library/aa362932(VS.85).aspx)自动连接蓝牙设备的软件。当它连接时，Windows 会自动开始安装蓝牙 HID 设备驱动程序，如预期的那样：

![安装蓝牙 HID 驱动程序](https://i.stack.imgur.com/aZuTq.gif)

这大约需要 10-15 秒，之后 Windows 会显示熟悉的“准备使用”消息：

![硬件已安装并可以使用](https://i.stack.imgur.com/Vb5Ex.gif)

问题是`BluetoothSetServiceState()`驱动程序安装*开始*后立即返回，而不是在设备实际准备好使用时返回。这会给我的代码带来一些问题，因为它在“连接”后立即调用一个单独的库进行设备通信。前几个调用失败是因为驱动程序尚未完成安装，并且进行这些连接尝试似乎会干扰驱动程序安装，因为如果我在驱动程序安装完成之前尝试使用通信库 Windows 想要在设备可以之前重新启动使用。

我正在寻找的是一种在驱动程序安装实际完成时挂钩“准备使用”事件的方法，因此我不会过早地调用我的通信库。是否有一些 Windows API 调用可用于注册函数回调或直接轮询驱动程序安装的状态？

我正在用普通的 C/C++ 编写这个，而不是 .NET。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T21:25:00.127

您可能想查看 [此示例代码](http://msdn.microsoft.com/en-us/library/aa363432(VS.85).aspx)和[RegisterDeviceNotification](http://msdn.microsoft.com/en-us/library/aa363431(VS.85).aspx)函数。我不确定 100%，但如果您为设备类指定正确的 guid，它似乎可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T05:50:13.783

这是我要做的：

1.  下载[Winspector](http://www.windows-spy.com/)（或使用 Spy++）
2.  启动 Winspector，并[开始观察窗口消息](http://www.windows-spy.com/features/messagefilter.shtml)
3.  安装您的驱动程序
4.  注意 WM 指示已完成驱动程序安装

我希望我可以在#4 上更具描述性，但我不熟悉您需要的特定窗口消息。[在这里查看可能的 Window Messages to expect](http://msdn.microsoft.com/en-us/library/aa363480(VS.85).aspx)。

但是，一旦您确定要查找的正确窗口消息，然后以编程方式让您的程序等待（并处理）此 WM。[CodeProject 有一篇关于如何在 C++ 中执行此操作的出色文章](http://www.codeproject.com/KB/dialog/messagehandling.aspx)。就个人而言，[我更喜欢在 Delphi 中进行](http://delphi.about.com/od/windowsshellapi/a/aa020800a.htm)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T04:58:29.370

如果是网络绑定，则 RNDIS 在完成安装时会根据[RNDIS 驱动程序实施指南](http://msdn.microsoft.com/en-us/library/aa447606.aspx) 和[RNDIS定义发送消息](http://msdn.microsoft.com/en-us/library/aa938280.aspx)

或者

您可以通过 Devcon 实用程序（源代码可通过 MSDN 获得）以编程方式安装或查询设备列表，如[示例中所示](http://msdn.microsoft.com/en-us/library/ms792832.aspx)

# entity-framework - 实体框架：使用其他集合中的数据更新集合中的多行

> ID：587710
> 
> 赞同：2
> 
> 时间：2009-02-25T20:30:09.497
> 
> 标签：entity-framework

我只是想实现这行SQL：

```
UPDATE table1
SET table1.col = table2.col
FROM table2 INNER JOIN
     table1 ON table2.id = table1.id 
```

如何使用实体框架以最少的往返次数来做到这一点？我能想到的只是使用 foreach 循环遍历我的`table2`并更新它的相关条目`table1`，但这会导致大量往返，不是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T18:08:07.193

遗憾的是，目前[Entity SQL 中没有 UPDATE](http://msdn.microsoft.com/en-us/library/bb387145.aspx)。一种解决方法是[使用常规 SQL](http://blogs.msdn.com/alexj/archive/2007/12/07/rolling-your-own-sql-update-on-top-of-the-entity-framework-part-1.aspx)。没有这个，通过一次从两个表中加载所有需要的行并尽可能少地调用 SaveChanges 来将往返次数保持在最低限度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-28T17:09:20.627

正如 Craig 所说，EF 中没有对多个对象的内置支持，但您可以构建自己的对象或使用以下链接作为参考。

[http://geeks.ms/blogs/unai/archive/2008/07/17/multiple-entity-updates-with-entity-framework-ef-fetch-updates.aspx](http://geeks.ms/blogs/unai/archive/2008/07/17/multiple-entity-updates-with-entity-framework-ef-fetch-updates.aspx)

[http://efe.codeplex.com/](http://efe.codeplex.com/)

两者都使用相同的逻辑，但 efe 提供了一个包装器和更多功能。基本上干净的代码。（像那样！）。我希望这将有所帮助。

桑杰·扎尔克

# ipc - 在 posix 的命名管道上让许多进程写入单个读取器是否会产生影响？

> ID：587727
> 
> 赞同：8
> 
> 时间：2009-02-25T20:34:29.503
> 
> 标签：ipc, posix, named-pipes, fifo

我正在为 POSIX (OSX) 编写一个程序，其中我将有许多进程向一个侦听器发送消息，该侦听器本质上是一个日志记录线程。所有进程都在单独的程序中运行，并且使用许多进程写入但只有一个进程读取的单个命名管道 (FIFO) 非常诱人。

# 问题：

1）这会工作吗？- 我可以使用 bash 设置一个具有多个写入它的进程的 fifo 来完成这项工作，所以我知道理论上这是可行的。但在实践中，有没有我在掩饰的问题？

外壳 #1

```
$ mkfifo /tmp/fifo
$ cat /tmp/fifo 
```

贝壳 #2 和 #3

```
$ cat > /tmp/fifo
"Type stuff here, after hitting enter, it is read by shell #1" 
```

2）如果每个作者只写相对较短的消息（< 100 字节？），那么我可以假设每个对 write() 的调用都会完整地发送给读者吗？或者，一条消息的一半是否会与来自不同作者的另一条消息的一半存在混淆？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-25T20:43:28.827

FIFO 写入应该是原子的，只要它在页面大小之下。所以 100 字节的消息应该没有问题。在linux上，最大尺寸曾经是4K，我相信现在更大了。我已经在一些系统上使用了这种技术来传递消息，因为写入最终是原子的。

如果您使用一系列写入操作，您最终可能会遇到问题，因为输出缓冲可能会导致同步问题。因此，请确保一次写入整条消息。例如。构建一个字符串，然后打印，不要一次打印多个。

```
s="This is a message"
echo $s 
```

不是

```
echo "This "
echo "is "
echo " a message" 
```

# c# - $.ajax 没有 JSON

> ID：587747
> 
> 赞同：1
> 
> 时间：2009-02-25T20:38:39.197
> 
> 标签：c#, jquery, ajax

为什么回调函数接收的是 XMLHttpRequest 对象而不是 JSON 对象？

```
<%@ Page language='C#' %>
<% 
   if (Request.RequestType == "POST") {
      System.Threading.Thread.Sleep(1000);
      int c;
      if (Session["c"] == null)
         c = 1;
      else
         c = (int)Session["c"] + 1;
      Session["c"] = c;
      Response.ContentType = "application/json";
      Response.Write("{\"mike\": " + c.ToString() + "}");
      Response.End();
   }
%>
<html>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript">
function callback(data,s) {
   if (s=="success")
      $("h1").text(data.responseText);
   else
      $("h1").text(s);
   setTimeout(updateUI,0);
}
function updateUI () {
   $.ajax({ url: "timer.aspx",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            timeout: 5000,
            type: "POST",
            data: "{}",
            complete: callback});
}
$(function() {
   setTimeout(updateUI,0);
});
</script>
<body>
<h1/>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T20:52:29.863

如果您阅读 jQuery API，它会说第一个参数是`XMLHttpRequest`对象。

您可能想使用`success`$.call 中的回调选项。`ajax`相反，如果你想要 JSON 对象。

# jquery - 小部件中的 jQuery

> ID：587751
> 
> 赞同：5
> 
> 时间：2009-02-25T20:39:09.973
> 
> 标签：jquery, widget

我想在可以添加到随机网站的 JS 库中使用 jQuery。这些网站可能已经使用也可能不使用 jQuery。

我实际上有3个问题：

1.  我可能会从我自己的 js 脚本（而不是从文档头中的脚本标签）动态加载 jQuery。jquery会以这种方式工作吗？在主文档中没有标准 $(document).ready(function(){} 的情况下，如何确保它能够及时运行？

2.  我应该怎么做才能避免与网站代码中现有的 jQuery（如果有）发生冲突。

3.  是否有推荐的方法将包含 jQuery 的小部件添加到随机网站，同时提供最少的代码和最简单的集成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T21:01:50.013

这是相当松散和不完整的——实际上是一个起点：

```
if (typeof $ != 'undefined') {
    var msg = 'This page already using jQuery v' + $.fn.jquery;
} else {
    var s = document.createElement('script');
    s.setAttribute('src', 'http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js');
    document.getElementsByTagName('head')[0].appendChild(s);
    var msg = 'This page is now jQuerified';
} 
```

然后在运行 ready() 函数之前通过一个简短的 setTimeout() 等待

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T15:07:46.413

如果它适合您，您可以尝试以下链接中的解决方案。基本上，有一个插件可以即时创建小部件，然后异步请求另一个页面 url，并将返回的内容设置为小部件的内部 html。

[http://sites.google.com/site/spyderhoodcommunity/tech-stuff/jquerydashboardwidgetplugin](http://sites.google.com/site/spyderhoodcommunity/tech-stuff/jquerydashboardwidgetplugin)

# testing - 为测试生成有效的信用卡 Track2 数据

> ID：587754
> 
> 赞同：0
> 
> 时间：2009-02-25T20:39:29.507
> 
> 标签：testing, credit-card, load-testing

我有来自我的支付处理器的测试卡，但我没有足够的能力进行负载测试，因此我需要生成卡号并跟踪我可以通过他们的测试网关使用的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-12-03T03:21:33.150

您想查看第 1 和第 2 代的[ISO 7813](http://en.wikipedia.org/wiki/ISO/IEC_7813)。

但是，根据您的网关，他们可能会拒绝他们给您的测试卡以外的其他卡。您可能还想警告他们您将要进行负载测试；我让许多卡处理商非常生气，因为我们没有提前告诉他们我们将敲打他们的测试系统。

如果您在实时系统上进行负载测试，请准备好付出高昂的代价。=) 我曾经通过处理无效授权而支付了相当多的费用（1 万美元？）。（我试图找到一个仅在生产中看到的极其难以捉摸的错误，需要进行端到端测试。事实证明，该错误是由于有人购买了 BigIP 负载均衡器的更便宜的替代品；所以他们预先存了钱，但花了反正以后再说。）

# .net - 如何从 RGB 初始化 48bpp 位图？

> ID：587761
> 
> 赞同：0
> 
> 时间：2009-02-25T20:43:03.507
> 
> 标签：.net, visual-c++, bitmap, bpp

我正在用托管 C++ 编写一个解释器，用于 PPM 图像格式等。图像规范允许每个通道每像素最多两个字节的图像，或每像素 48 位彩色图像。我正在尝试读取这种格式并将其转换为 .Net 位图，但我无法使其正常工作。当我有每像素 24 位的图像时，我像这样初始化它们：

```
bmp = gcnew Bitmap(width, height);
<for each pixel>
    bmp->SetPixel(x, y, Drawing::Color::FromArgb(Convert::ToInt32(fileData[offset]),
        Convert::ToInt32(fileData[offset + 1]), 
            Convert::ToInt32(fileData[offset + 2])));
    offset += 3; 
```

对于每像素 48 位的图像，我将 bmp 初始化如下：

```
bmp = gcnew Bitmap(widht, height, Imaging::PixelFormat::Format48bppRgb); 
```

但是，当尝试填充像素数据时，我无法使用 'Color::FromArgb()' 指定任何颜色值，R、G 和 B 的值大于 255。有没有办法绕过这个限制?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T20:59:19.550

System.Drawing 可以处理 48 位和 64 位图像文件格式，但它将像素值转换为 24 位。我知道没有办法保持全彩色保真度。

参见备注部分：[PixelFormat Enumeration](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.pixelformat(VS.80).aspx)

# javascript - 如何从 JavaScript 中止加载外部 HTML 资源？

> ID：587766
> 
> 赞同：2
> 
> 时间：2009-02-25T20:43:47.873
> 
> 标签：javascript, browser, dynamic-loading

我正在编写一个 JavaScript 小部件，它旨在用于其他网站并从我自己的网站加载其他脚本文件（由于跨域限制，这基本上意味着没有 XHR）。现在我想优雅地处理故障 - 如果一个脚本无法加载，我想从备用服务器加载脚本。

我设法处理了第一台服务器返回错误的服务器故障，但我也想处理超时 - 如果第一台服务器响应时间过长，我想中止负载并切换到备用服务器。

我遇到的问题是我可以设置超时来触发切换到备用服务器的方法，但是在浏览器本身对原始请求超时之前，来自备用服务器的脚本不会成功加载 - 这也是渴望我的需要。

我希望能够 - 当第一个 <script> 标记正在加载时 - 中止加载，并添加第二个 <script> 指向备用服务器的标记。

我尝试将原始脚本的 src 属性设置为 null，甚至使用 removeNode() 从 HEAD 元素中删除标签，但没有效果。

这一切都在 Firefox 上尝试过——我还没有尝试过 IE，但解决方案必须在两者上都有效。我很想听听任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T22:14:41.910

不幸的是，无法取消对标签的请求。从历史上看，浏览器只允许同时向一个主机名发出 2 个请求，因此应该可以从另一台服务器加载第二个脚本。

您是否在 body.onload 之前启动脚本加载？对于正常的页面加载，浏览器在继续之前等待每个脚本加载，因为脚本可以更改文档。如果脚本没有修改文档，您可以使用 defer 属性，以便浏览器在脚本加载时继续呈现文档。

jQuery 有一些关于类似功能的开放请求：http: [//dev.jquery.com/ticket/1863](http://dev.jquery.com/ticket/1863) [http://dev.jquery.com/ticket/3442](http://dev.jquery.com/ticket/3442)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T20:53:51.703

我在想你可能想要构建你的小部件以使用 XMLHttpRequest，它可以通过 window.setTimeout() 中止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T07:34:16.323

如果您可以修改正在加载的脚本，则可以在那里添加回调。只需在页面顶部设置一个计时器，然后在脚本文件底部清除它。这样，如果您的脚本没有正确加载，备份请求将在计时器用完时执行。

在页面顶部的内联脚本块中运行以下命令：

```
doneLoading = function() {
  clearTimeout(timeout);
}

timeout = setTimeout(function() {
             ... change the .src on the old inline script element here ...
                     }, 15000); 
```

在外部 JavaScript 文件的底部，只需调用`doneLoading()`. 如果您的初始请求花费的时间超过 15 秒，则会运行对备份服务器的新请求。我认为您不能中止初始请求，但备份请求将按预期执行。

# c++ - 如何在 C++/Windows 中输出到控制台

> ID：587767
> 
> 赞同：20
> 
> 时间：2009-02-25T20:43:51.600
> 
> 标签：c++, windows, console, sdl, iostream

在 Linux 上使用 C++ 中的 iostream 时，它会在终端中显示程序输出，但在 Windows 中，它只是将输出保存到 stdout.txt 文件中。在 Windows 中，如何使输出显示在控制台中？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-25T21:08:12.900

既然你提到了stdout.txt，我用谷歌搜索看看究竟是什么会创建一个stdout.txt；通常，即使使用 Windows 应用程序，控制台输出也会发送到分配的控制台，如果没有分配控制台，则不会发送到任何地方。

因此，假设您使用的是 SDL（这是唯一出现 stdout.txt 的内容），您应该遵循[此处](http://wiki.libsdl.org/FAQWindows#How_do_I_avoid_creating_stdout.txt_and_stderr.txt.3F)的建议。使用“CON”打开标准输出和标准错误，或者在那里执行其他链接器/编译解决方法。

如果链接再次断开，这正是从 libSDL 中引用的内容：

> 如何避免创建 stdout.txt 和 stderr.txt？
> 
> “我相信在 SDL 附带的 Visual C++ 项目中，有一个 SDL_nostdio 目标 > 你可以构建它做你想要的（TM）。”
> 
> “如果你定义“NO_STDIO_REDIRECT”并重新编译SDL，我认为它会解决问题。” > > （答案由比尔·肯德里克提供）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-06-21T01:10:19.353

对于 Visual Studio 中的调试，您可以打印到调试控制台：

```
OutputDebugStringW(L"My output string."); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-25T20:52:31.720

如果您使用的是 Visual Studio，则需要修改*项目属性*： *配置属性*->*链接器*->*系统*->*子系统*。

这应该设置为：**控制台 (/SUBSYSTEM:CONSOLE)**

此外，您应该将 WinMain 更改为此签名：

```
int main(int argc, char **argv)
{
    //...
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-25T20:56:23.613

如果您有一个非控制台的 Windows 应用程序，您可以使用**AllocConsole**函数创建一个控制台。创建后，您可以使用普通的 std::cout 方法对其进行写入。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-25T20:54:54.883

如果您使用的是 Visual Studio，它应该可以正常工作！

这是一个代码示例：

```
#include <iostream>

using namespace std;

int main (int) {
    cout << "This will print to the console!" << endl;
} 
```

确保在创建新项目时选择了 Win32 控制台应用程序。您仍然可以使用控制台开关 (>>) 将项目的输出重定向到文件。这实际上会将控制台管道从标准输出重定向到您的文件。（例如，`myprog.exe >> myfile.txt`）。

我希望我没有记错！

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-25T21:00:28.533

[AllocConsole](http://msdn.microsoft.com/en-us/library/ms681944(VS.85).aspx) Windows API 函数将为您的应用程序创建一个控制台窗口。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-11-11T21:06:00.740

是否使用子系统：控制台或子系统：窗口取决于您是否要启动应用程序：

*   如果您使用子系统：控制台，那么您会将所有标准输出写入终端。问题在于，如果您从开始菜单/桌面启动应用程序，您（默认情况下）会出现一个控制台以及应用程序窗口（可能看起来很丑）。
*   如果您使用subsystem:windows，即使您从[DOS](http://en.wikipedia.org/wiki/DOS)窗口、[Cygwin](http://en.wikipedia.org/wiki/Cygwin)或其他终端运行应用程序，您也不会获得stdout/stderr。

如果您想要中间方式，即如果应用程序在终端中启动，则输出到终端，然后按照 Luke 在他的解决方案中提供的链接（[http://dslweb.nwnexus.com/~ast/dload/guicon。 .htm](http://dslweb.nwnexus.com/~ast/dload/guicon.htm) )

作为参考，我遇到了这个问题，我想根据命令行开关在正常 Windows 模式或批处理模式（即作为脚本的一部分）下运行该应用程序。控制台和 Windows 应用程序之间的整个区别对于 Unix 人来说有点奇怪！

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-25T20:47:44.790

首先，您使用的是什么编译器或开发环境？如果是 Visual Studio，则需要制作控制台应用程序项目以获取控制台输出。

第二，

`std::cout << "Hello World" << std::endl;`

应该在任何 C++ 控制台应用程序中工作。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-25T20:47:16.523

您的应用程序必须编译为 Windows 控制台应用程序。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-04-29T14:20:24.980

[有一个很好的解决方案](https://smacdo.com/programming/redirecting-standard-output-to-console-in-windows/)

```
if (AllocConsole() == 0)
{
    // Handle error here. Use ::GetLastError() to get the error.
}

// Redirect CRT standard input, output and error handles to the console window.
FILE * pNewStdout = nullptr;
FILE * pNewStderr = nullptr;
FILE * pNewStdin = nullptr;

::freopen_s(&pNewStdout, "CONOUT$", "w", stdout);
::freopen_s(&pNewStderr, "CONOUT$", "w", stderr);
::freopen_s(&pNewStdin, "CONIN$", "r", stdin);

// Clear the error state for all of the C++ standard streams. Attempting to accessing the streams before they refer
// to a valid target causes the stream to enter an error state. Clearing the error state will fix this problem,
// which seems to occur in newer version of Visual Studio even when the console has not been read from or written
// to yet.
std::cout.clear();
std::cerr.clear();
std::cin.clear();

std::wcout.clear();
std::wcerr.clear();
std::wcin.clear(); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-25T20:47:33.183

我假设您使用的是某个版本的 Visual Studio？在 Windows 中，`std::cout << "something";`如果您的程序在项目设置中设置为控制台程序，则应将内容写入控制台窗口。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-06-17T08:24:09.517

如果使用[MinGW](http://en.wikipedia.org/wiki/MinGW)，请添加一个选项，`-Wl,subsystem,console`或者`-mconsole`.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-08-05T18:49:10.040

您不一定需要对代码进行任何更改（也不需要更改`SUBSYSTEM`类型）。如果您愿意，您也可以简单地将[*stdout*和 stderr 传送到控制台应用程序](https://stackoverflow.com/a/2628025/179715)（Windows 版本`cat`运行良好）。

# c# - 在子类中强制使用单例模式

> ID：587771
> 
> 赞同：8
> 
> 时间：2009-02-25T20:45:40.100
> 
> 标签：c#, design-patterns

我想强制子类实现单例模式。

我最初想在父类中有一个抽象的静态属性，但仔细一看，这没有意义（抽象要求和实例）。

接下来，我想到了一个具有静态属性的接口，但这也没有意义（接口也需要一个实例）。

这是可能的事情，还是我应该放弃这种思路并实现一个抽象工厂？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T17:17:27.993

请重新考虑。你不想在这里使用单例。您正在为从您的类派生的用户提供一些功能。没关系。但是您还指定了一种必须始终使用它的特定方式，而且绝对没有理由。这是不好的。

大多数时候只实例化这个类的一个对象可能是有意义的，但在这种情况下，*只需实例化对象一次*。您不太可能在不注意的情况下意外实例化十几个对象。此外，你怎么能说拥有两个实例*永远不会*有用？即使是现在，我也能想到几个案例。

单元测试：您可能希望每个测试都实例化该对象，然后再将其拆除。而且由于大多数人都有不止一个单元测试，因此您需要多次实例化它。

或者您可能在某个时候决定在您的游戏中拥有多个相同/相似的关卡，这意味着创建多个实例。

单例给你两件事：

*   保证不会实例化超过一个对象实例，并且
*   对该实例的全局访问

如果你不需要这两样东西，还有更好的选择。您当然不需要全局访问。（全局变量很糟糕，通常是糟糕设计的征兆，尤其是在可变数据中，比如你的游戏状态）

但是您也不需要保证不会实例化多个实例。如果我实例化对象两次，是不是世界末日？应用程序会崩溃吗？如果是这样，您需要该保证。但在你的情况下，不会发生任何不好的事情。实例化对象的人只是使用了不必要的内存。但他可能是有原因的。

只需在类文档中说明这是一个非常大且昂贵的类，您不应该过于频繁地实例化它。问题解决了。您不会删除以后可能会变得有用的灵活性，您不会无缘无故地授予对数据的全局访问权限。因为您可以控制谁可以看到该对象，所以您不需要将它淹没在将成为多线程应用程序瓶颈的锁中。您的代码中没有分散的隐藏依赖项，这使得测试和重用变得更加困难。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T20:49:02.807

尝试使用 IOC 容器。大多数优秀的 IOC 容器都可以使用单例模式，而无需自己实现（即：spring 框架）——我更喜欢这种方式，而不是强制使用静态 GetInstance() 方法。

此外，这在 java 中是不可能的，但它可以在带有模板的 C++ 中工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T21:20:45.380

为什么？如果有人想使用您的类的子类的多个实例，他们可能有充分的理由这样做。

如果你想做一些只应该为你的类的子类的每个类做一次的事情（为什么，我不知道，但你可能有理由这样做），请在基类中使用 Dictionary。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T21:15:13.023

我将定义一个*密封*类，它从传递给构造函数的委托中获取其功能，如下所示：

```
public sealed class Shape {
  private readonly Func<int> areaFunction;

  public Shape(Func<int> areaFunction) { this.areaFunction = areaFunction; }

  public int Area { get { return areaFunction(); } }
} 
```

**这个**例子没有多大意义，它只是说明了一个模式。这种模式不能在任何地方都使用，但有时它会有所帮助。

此外，它可以扩展为公开有限数量的静态字段：

```
public sealed class Shape {
  private readonly Func<int> areaFunction;

  private Shape(Func<int> areaFunction) { this.areaFunction = areaFunction; }

  public int Area { get { return areaFunction(); } }

  public static readonly Shape Rectangle = new Shape(() => 2 * 3);
  public static readonly Shape Circle = new Shape(() => Math.Pi * 3 * 3);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T22:54:54.127

老实说，我认为在这里使用工厂模式会更好。或者使用 Brian Dilley 推荐的 IoC 工具。在 c# 世界中有很多负载，这里是最流行的：Castle/windsor、StructureMap、Unity、Ninject。

除此之外，我认为尝试实际解决您的问题会很有趣！看看这个：

```
//abstract, no one can create me
public abstract class Room
{
    protected static List<Room> createdRooms = new List<Room>();
    private static List<Type> createdTypes = new List<Type>();

    //bass class ctor will throw an exception if the type is already created
    protected Room(Type RoomCreated)
    {
        //confirm this type has not been created already
        if (createdTypes.Exists(x => x == RoomCreated))
            throw new Exception("Can't create another type of " + RoomCreated.Name);
        createdTypes.Add(RoomCreated);
    }

    //returns a room if a room of its type is already created
    protected static T GetAlreadyCreatedRoom<T>() where T : Room
    {
        return createdRooms.Find(x => x.GetType() == typeof (T)) as T;
    }
}

public class WickedRoom : Room
{
    //private ctor, no-one can create me, but me!
    private WickedRoom()
        : base(typeof(WickedRoom)) //forced to call down to the abstract ctor
    {

    }

    public static WickedRoom GetWickedRoom()
    {
        WickedRoom result = GetAlreadyCreatedRoom<WickedRoom>();

        if (result == null)
        {
            //create a room, and store
            result = new WickedRoom();
            createdRooms.Add(result);
        }

        return result;
    }
}

public class NaughtyRoom :Room
{
    //allows direct creation but forced to call down anyway
    public NaughtyRoom() : base(typeof(NaughtyRoom))
    {

    }
}

internal class Program
{
    private static void Main(string[] args)
    {
        //Can't do this as wont compile
        //WickedRoom room = new WickedRoom();

        //have to use the factory method:
        WickedRoom room1 = WickedRoom.GetWickedRoom();
        WickedRoom room2 = WickedRoom.GetWickedRoom();

        //actually the same room
        Debug.Assert(room1 == room2);

        NaughtyRoom room3 = new NaughtyRoom(); //Allowed, just this once!
        NaughtyRoom room4 = new NaughtyRoom(); //exception, can't create another
    }
} 
```

WickedRoom 是一个正确实现系统的类。任何客户端代码都将获取单例 WickedRoom 类。NaughtyRoom 没有正确实现系统，但即使是这个类也不能实例化两次。第二次实例化导致异常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-22T15:02:45.587

尽管这不会强制用户拥有一个单例子类，但您可以强制用户只创建一个类（或其子类）的实例，如下所示。如果创建任何子类的第二个实例，这将引发错误。

```
public abstract class SuperClass {
private static SuperClass superClassInst = null;

public SuperClass () {
    if(superClassInst == null) {
        superClassInst = this;
    }
    else {
        throw new Error("You can only create one instance of this SuperClass or its sub-classes");
    }
}

public final static SuperClass getInstance() {
    return superClassInst;
}

public abstract int Method1();
public abstract void Method2();
} 
```

# string - 在 Delphi 中使用字符串中的引号

> ID：587772
> 
> 赞同：20
> 
> 时间：2009-02-25T20:45:51.753
> 
> 标签：string, delphi, escaping, quotes

> **可能重复：**
> [如何在 Delphi 字符串中转义字符](https://stackoverflow.com/questions/302409/how-does-one-escape-characters-in-delphi-string)

在 Delphi 中，一个字符串包含在一对字符串中，`'`但我需要`'`在我的字符串中使用......当我使用一个字符串时，它会结束整个字符串识别。

```
'inside string ' but this bit is outside' inside again' and the end 
```

是否有一些符号可以消除下一个字符的编码影响？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-02-25T20:48:44.880

您需要另一个报价来转义报价：

```
Writeln('I''m in your head'); //prints: I'm in your head
Writeln(''''); //prints: ' 
```

另请参阅[此问题](https://stackoverflow.com/questions/302409/how-does-one-escape-characters-in-delphi-string)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-25T21:01:44.693

Delphi 具有`QuotedStr()`在字符串周围添加引号并自动转义字符串中的撇号的功能。

```
procedure MyForm.MyProc;
var str : string;
begin
  str = QuotedStr(MyForm.Edit1);
  ...
end; 
```

`QuotedStr()`会将编辑字段的内容放入撇号。如果编辑字段包含撇号，它们将被正确转义。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-25T20:53:08.473

类似的问题在这里：

[如何在 Delphi 字符串中转义字符](https://stackoverflow.com/questions/302409/how-does-one-escape-characters-in-delphi-string/302431#302431)

涵盖单引号和转义字符

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T23:37:16.707

我通常使用该`QuotedStr`函数来修复带有引号的字符串。此外，我经常发现定义常量如`CRLF`和分别`TAB`表示`#13#10`和是很有帮助的`#9`。有时，用引号做类似的事情似乎更清楚（至少对我来说）。

# asp.net - 如何使用带有参数的“Like”

> ID：587797
> 
> 赞同：2
> 
> 时间：2009-02-25T20:53:13.060
> 
> 标签：asp.net, sql, parameters, sql-like

我想使用参数搜索日志表中字段中字符串中嵌入的数字。

从 vwLogs 中选择 *，其中 log_time >'02/24/2009' 和消息（'%2009022508241446%'）

我知道当 where 子句是等号时如何使用参数，但不确定如何使用“Like”

这似乎不对

```
 WHERE message like ('%@ErrorMessage%') 
```

* * *

我刚试过这个，它没有用。唯一新的是消息搜索部分

```
protected void btnRunQuery_Click(object sender, EventArgs e)
    {
        string strConn, strSQL;
        strConn = @";";
        strSQL = @"SELECT * FROM weblogs.dbo.vwlogs WHERE Log_time >= @BeginDate AND Log_Time < @EndDate AND (client_user=@UserName OR @UserName IS NULL) AND (message like '%' + @ErrorNumber + '%' OR @ErrorNumber IS NULL) ORDER BY Log_time DESC";

        using (SqlConnection cn = new SqlConnection(strConn))
        {
            SqlCommand cmd = new SqlCommand(strSQL, cn);

            cmd.Parameters.AddWithValue("@UserName", txtUserName.Text);
            cmd.Parameters.AddWithValue("@ErrorNumber", txtErrorNumber.Text);

            cmd.Parameters.Add("@BeginDate", SqlDbType.DateTime).Value =
                DateTime.Parse(txtBeginDate.Text).Date;
            cmd.Parameters.Add("@EndDAte", SqlDbType.DateTime).Value =
                // add one to make search inclusive
                DateTime.Parse(txtEndDate.Text).Date.AddDays(1);

            cn.Open();
            SqlDataReader rdr = cmd.ExecuteReader();

            GridView1.DataSource = rdr;
            GridView1.DataBind();

            cn.Close();
        }
    } 
```

* * *

谢谢您的帮助

我得到了这个工作

```
 if (string.IsNullOrEmpty(txtUserName.Text))
   {
       cmd.Parameters.Add("@UserName", SqlDbType.VarChar, 50).Value = DBNull.Value; 
   }
   else
   {
       cmd.Parameters.Add("@UserName", SqlDbType.VarChar, 50).Value = txtUserName.Text;
   }

   if (string.IsNullOrEmpty(txtErrorNumber.Text))
   {
       cmd.Parameters.Add("@ErrorNumber", SqlDbType.VarChar, 50).Value = DBNull.Value;
   }
   else
   {
       cmd.Parameters.Add("@ErrorNumber", SqlDbType.VarChar, 50).Value = txtErrorNumber.Text;
   } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T20:54:31.293

```
WHERE message like '%' + @ErrorMessage + '%' 
```

根据您的编辑，我没有立即看到导致您的错误的原因，但我确实发现了两个潜在问题：

1.  它没有正确处理 null ErrorNumbers。我不认为是这样，因为空字符串仍应匹配该查询的所有内容。但是修复空值将提高这种情况下的性能。
2.  它将其视为数字类型而不是 varchar。这也有性能影响，实际上可能会破坏 LIKE 查询：我不记得我的头顶上的行为是什么。

尝试这个：

```
protected void btnRunQuery_Click(object sender, EventArgs e)
{
    string strConn = @";";
    string strSQL =
         "SELECT * "
      + " FROM weblogs.dbo.vwlogs"
      + " WHERE Log_time >= @BeginDate AND Log_Time < @EndDate"
          + " AND (client_user=@UserName OR @UserName IS NULL)" 
          + " AND (message like '%' + @ErrorNumber + '%' OR @ErrorNumber IS NULL)"
      + " ORDER BY Log_time DESC";

    using (SqlConnection cn = new SqlConnection(strConn))
    using (SqlCommand cmd = new SqlCommand(strSQL, cn))
    {
        cmd.Parameters.Add("@BeginDate", SqlDbType.DateTime).Value =
            DateTime.Parse(txtBeginDate.Text).Date;
        cmd.Parameters.Add("@EndDAte", SqlDbType.DateTime).Value =
            // add one to make search inclusive
            DateTime.Parse(txtEndDate.Text).Date.AddDays(1);
        cmd.Parameters.Add("@UserName", SqlDbType.VarChar, 50).Value = 
            string.IsNullOrEmpty(txtUserName.Text) ? DBNull.Value : txtUserName.Text;
        cmd.Parameters.Add("@ErrorNumber", SqlDbType.VarChar, 50).Value =
            string.IsNullOrEmpty(txtErrorNumber.Text) ? DBNull.Value : txtErrorNumber.Text;

        cn.Open();
        SqlDataReader rdr = cmd.ExecuteReader();

        GridView1.DataSource = rdr;
        GridView1.DataBind();
    }
} 
```

顺便说一句：我不是一开始就给了你那个代码吗？:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T20:58:05.653

您走在正确的道路上，但请以这种方式使用它：

```
SET @ErrorMessage = '%' + @ErrorMessage + '%'

SELECT messageId FROM [yourTable]
WHERE message like @ErrorMessage 
```

否则服务器将无法缓存执行计划

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T20:57:44.500

或者如果@ErrorMessage 已经包含 %，例如 @ErrorMessage = 'ABCD%' 那么这也可以

```
... WHERE message like @ErrorMessage 
```

# html - 如何防止图像溢出圆角框？

> ID：587814
> 
> 赞同：44
> 
> 时间：2009-02-25T20:57:11.430
> 
> 标签：html, css

如果我使用此代码，图像不会被 div 的圆角剪裁（导致图像的方角覆盖 div 的圆角）：

```
<div style="border-radius: 1em; -moz-border-radius: 1em; -webkit-border-radius: 1em; overflow:hidden;">
    <img src="big-image.jpg" />
</div> 
```

有谁知道如何获得一个圆形的 corder div 以防止子图像溢出？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2011-06-30T00:53:09.070

我最新的 Chrome、Firefox 和 Safari 将图像剪辑到容器的边界半径（如预期的那样）。

[http://jsfiddle.net/RQYnA/12/embedded/result/](http://jsfiddle.net/RQYnA/12/embedded/result/)

在 Firefox 15 中，当容器具有`{overflow: hidden}`. [（ Gecko 2.0 中](https://developer.mozilla.org/en-US/docs/CSS/border-radius#Gecko_notes)似乎添加了对子内容的剪辑。 ）

在 Chrome 23 和 Safari 5 中，**仅**当容器具有`{position: static; overflow: hidden}`且图像具有`{position: static}`.

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-25T21:08:26.627

这可能适用于您的情况，也可能不适用，但请考虑将图像设置为 CSS 背景。在 FF3 中，以下工作正常：

```
<div 样式="
  背景图片：网址（大图片.jpg）；
  边界半径：1em；
  高度：100px；
  -moz-边界半径：1em；
  宽度：100px；"
></div>

```

我不确定是否有另一种解决方法——如果你对图像本身应用边框（比如，`1em`深），你会遇到同样的方角问题。

**编辑：**虽然，在“为图像添加边框”的情况下，图像插图是正确的，只是图像没有与`div`元素齐平。要查看结果，请添加`style="border:1em solid black;border-radius:1em;-moz-border-radius:1em;"`到`img`标签（如有必要，请适当设置）`width`。`height`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-26T00:29:02.323

即使`overflow`设置为`hidden`，`border-radius`也不会剪辑其内容。这是设计使然。

一种解决方案是设置`border-radius`图像及其容器。

```
<div style="border-radius: 16px; ...">
    <img src="big-image.jpg" style="border-radius: 16px; ..." />
</div> 
```

`background-image`另一种方法是使用;将图像设置为容器的背景。但是在版本 3 之前的 Firefox 中，这种方法存在一些问题（请参阅[这个 bug](https://bugzilla.mozilla.org/show_bug.cgi?id=24998)）——这并不需要过多地打扰你。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-29T05:01:34.303

现在 css3 中也有背景剪辑。它适用于所有主要浏览器。选项是边框框、填充框和内容框。在你的情况下，我认为你会想要使用填充框。

```
-webkit-background-clip: padding-box;
-moz-background-clip:    padding; 
background-clip:         padding-box; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-11T20:14:59.263

试试这个解决方法：

1.  标签中的图像`img`存在，您可以在其中设置宽度和高度。
2.  然后用 隐藏它`visibility:hidden`。宽度和高度保持不变。
3.  之后，您将设置与背景图像相同的源，它将被剪裁。

```
<a class="thumb" href="#" style="background-image: url('./img/pic1.jpg');" title="Picture">
  <img border="0" src="./img/pic1.jpg" alt="Pic" height="100" width="150" />
</a>

#page .thumb {
background-repeat: no-repeat;
background-position: left top;
border: 3px #e5dacf solid;
display: block;
float: left;}

#page .thumb img {
display: block;
visibility: hidden;} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T21:12:45.540

如果您将图像设置为背景图像而不是内容，则图像不会剪切圆角（至少在 FF3 中）。

您还可以向 div 或图像的边距添加填充，以在圆角边框和图像之间添加额外的填充。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-01-31T21:46:12.663

一个简单`border-radius`的`img`标签在当前版本的 Safari 5、Chrome 16、Firefox 9 中运行良好：

```
<div>
    <img src="big-image.jpg" style="border-radius: 1em;" />
</div> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-09T11:44:52.030

我认为当图像或图像`parent`是`position:absolute`. 这是可以理解的，因为设置 absolute 会将元素从文档流中取出。

我 90% 确定我已经看到了解决此问题的方法，当我这样做时我会更新这篇文章：D

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-26T19:17:50.137

额外的裁剪通常只在边框粗细的误差范围内。只是让内半径稍微小一点，这样误差范围就会落在边界之下而不是 next to is

```
<div style='border-radius:5px;border:thin solid 1px;'>
   <img style='border-radius:4px' />
</div> 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-02-25T22:03:35.153

如果您希望您的 div 剪辑您的图像，您需要使用溢出指定精确的宽度和高度：隐藏

# asp.net-mvc - ASP.NET MVC - 将两个存储库返回到视图

> ID：587832
> 
> 赞同：4
> 
> 时间：2009-02-25T21:01:55.787
> 
> 标签：asp.net-mvc

我目前正在学习 ASP.NET MVC，所以请原谅我的问题，如果它被问过或看起来很简单，但如果我能得到一些帮助，我将不胜感激。

我正在尝试将两个不同的存储库返回给视图。我正在阅读 ASP.NET MVC 的教程，我想我会尝试更进一步。我可以很好地显示数据库中 Movie 表中的电影，但我也想显示 Actors 表中的数据，但我不知道该怎么做。为了显示电影，我遵循存储库模式。

我希望这是有道理的。

谢谢，

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T21:10:01.243

创建一个新类，其中包含电影和演员列表：

```
public class MoviesAndActorsModel
{
    public IList<Movie> Movies { get; set; }
    public IList<Actor> Actors { get; set; }
} 
```

然后，在您的控制器操作中，实例化从您的存储库填充的 MoviesAndActorsModel 类型的对象：

```
public ActionResult List()
{
    MoviesAndActorsModel model = new MoviesAndActorsModel();

    model.Movies = _repository.GetMovies();
    model.Actors = _repository.GetActors();

    return View(model);
} 
```

现在确保您的视图继承自 ViewPage`<MoviesAndActorsModel>`并且您应该能够像这样访问电影和演员：

```
<% foreach (Movie movie in Model.Movies) { %>
    <%= movie.Title %>
<% } %>

<% foreach (Actor actor in Model.Actors) { %>
    <%= actor.Name %>
<% } %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T21:05:32.830

```
ViewData["Movies"] = //Function to get Movies;
ViewData["Actors"] = //Function to get Actors;

return View(); 
```

这就是我在我的应用程序中将多组数据传递给视图的方法。

编辑：

或者，如果您在数据库中设置了关系，您可以执行以下操作：

```
var movies = /*Function to get Movies*/ as Movies;
movies.Actors.Load(); 
```

假设您在表中设置了外键，这将完成同样的事情。

然后在您看来，您会这样做：

```
<%
   var movies = ViewData["Movies"] as Movies;
   var actors = ViewData["Actors"] as Actors;
%> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-26T23:29:37.460

http://asp.net/mvc 上有一个[教程](http://www.asp.net/learn/mvc/tutorial-13-cs.aspx)，它演示了 dhulk 解决方案的变体，解决了一个稍微不同的问题：如何从每个操作方法返回每个视图（例如母版页）使用的一些公共数据没有大量重复的代码。

本教程介绍了一个所谓的应用程序控制器（只是所有控制器的基类），它处理将公共/共享数据返回到视图。

# c# - LINQ - 将属性添加到结果

> ID：587836
> 
> 赞同：13
> 
> 时间：2009-02-25T21:02:49.793
> 
> 标签：c#, .net, linq, linq-to-sql

除了以下之外，还有其他方法可以向 Linq 查询结果的对象添加属性吗？

```
var query = from x in db.Courses
                select new
                {
                    x.OldProperty1,
                    x.OldProperty2,
                    x.OldProperty3,
                    NewProperty = true
                }; 
```

我想在不列出对象的所有当前属性的情况下执行此操作。有很多属性，我不想在更改课程时更新此代码。

我仍在学习 LINQ，感谢您的建议。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T21:08:48.623

我想您可以返回一个由新属性和选定对象组成的新对象，如下所示：

```
var query = from x in db.Courses
                select new
                {
                    Course = x,
                    NewProperty = true
                }; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-26T10:44:24.437

添加部分类：

```
public partial class Courses
{
    public String NewProperty { get; set; }
} 
```

然后，您可以在创建对象后分配它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-25T21:16:30.477

eking 的回答将是最直接的方法。

如果这对您不起作用（因为您需要传递结果或其他），并且假设您正在处理的类已经定义了您要设置的属性，您可以创建一个复制构造函数或工厂方法现有实例加上您要设置的属性的值：

```
var query = from x in db.Courses
            select new Course(x, valueOfNewProperty); 
```

或者，如果`Course` *没有*定义属性，您可以将其子类化并使用相同的方法：

```
var query = from x in db.Courses
            select new CourseWithExtraProperty(x, valueOfNewProperty); 
```

（显然，为您的子类选择一个更好的名称）

不过，除非您真的需要这样做，否则请再次使用 eking 的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-06T15:51:46.557

*   ServiceStack 有一个[内置的方法](https://github.com/ServiceStack/ServiceStack/wiki/Auto-mapping)来处理这个`PopulateWith`方法。

    *   这是一个[代码示例](https://stackoverflow.com/a/21539313/109941)。

        ```
        foreach (var item in results)
        {
            var test1 = new ItemDto().PopulateWith(item);
            test1.extraField1 = "extra";
            response.Add(test1);
        }` 
        ```

*   如果你不使用 ServiceStack，你总是可以使用[AutoMapper](https://stackoverflow.com/a/4988159/109941)。

    `CreateMap<Foo, Bar>().ForMember(x => x.ExtraBarProperty, opt => opt.Ignore());`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-17T20:11:35.010

如果您希望为对象动态添加属性，这可能是一个解决方案。

这对我有用，*我也有一个担忧，那些具有许多属性的域对象发生了什么，对象中任何更改的可维护性是荒谬的*，我设法使用**LINQ - ExpandObject - Reflection**构建了一个实现，这有助于保持我的对象动态，并且只添加我的视图逻辑所需的其他属性。

```
var expandedModel = db.Courses.Select(x =>
                    {
                        dynamic expandObject = new ExpandoObject();
                        expandObject.NewProperty= $"PropertyValue";
                        foreach (var property in x.GetType().GetProperties())
                        {
                            ((IDictionary<string, object>)expandObject).Add(property.Name, property.GetValue(x));
                        }
                        return expandObject;
                    }).ToList(); 
```

# c# - C#中如何区分多个输入设备

> ID：587840
> 
> 赞同：26
> 
> 时间：2009-02-25T21:04:44.563
> 
> 标签：c#, barcode-scanner

我有一个条形码扫描仪（它就像一个键盘），当然我的键盘也连接到了电脑上。该软件正在接受来自扫描仪和键盘的输入。我只需要接受扫描仪的输入。代码是用 C# 编写的。有没有办法“禁用”键盘输入并且只接受来自扫描仪的输入？

注意：键盘是笔记本电脑的一部分……因此无法拔下。另外，我尝试将以下代码保护覆盖 Boolean ProcessDialogKey(System.Windows.Forms.Keys keyData) { return true; 但是随着忽略键盘的击键，条形码扫描仪的输入也被忽略了。

我不能让扫描仪发送前哨字符，因为扫描仪正被其他应用程序使用，添加前哨字符流将意味着修改其他代码。

此外，我不能使用计时方法来确定输入是否来自条形码扫描仪（如果它是一堆字符，然后是暂停），因为扫描的条形码可能是单字符条形码。

是的，我正在从流中读取数据。

我正在尝试阅读文章：在 WinForms 中将条码扫描仪与键盘区分开来。但是我有以下问题：

1.  我收到一个错误 NativeMethods 由于其保护级别而无法访问。好像我需要导入一个dll；它是否正确？如果是这样，我该怎么做？
2.  我应该使用哪个受保护的覆盖 void WndProc(ref Message m) 定义，文章中有两种实现？
3.  收到与 [SecurityPermission(SecurityAction.LinkDemand, Flags = SecurityPermissionFlag.UnmanagedCode)] 相关的错误错误 CS0246：找不到类型或命名空间名称“SecurityPermission”（您是否缺少 using 指令或程序集引用？）。如何解决此错误？
4.  包含以下内容的行上还有一个错误：if ((from hardwareIds in hardwareIds where deviceName.Contains(hardwareId) select hardwareId).Count() > 0) Error is error CS1026: ) 预期。
5.  我应该将文章中的所有代码放在一个名为 BarcodeScannerListener.cs 的 .cs 文件中吗？

Nicholas Piasecki 在[http://nicholas.piasecki.name/blog/2009/02/distinguishing-barcode-scanners-from-the-keyboard-in-winforms/](http://nicholas.piasecki.name/blog/2009/02/distinguishing-barcode-scanners-from-the-keyboard-in-winforms/)上发布的有关 C# 解决方案源代码的后续问题：

1.  我无法在 VS 2005 中打开解决方案，所以我下载了 Visual C# 2008 Express Edition，并且代码运行了。但是，在连接我的条形码扫描仪并扫描条形码后，程序无法识别扫描。我在 OnBarcodeScanned 方法中设置了一个断点，但它从未被击中。我确实使用设备管理器获得的条形码扫描仪的 ID 更改了 App.config。似乎有 2 个带有 HID#Vid_0536&Pid_01c1 的设备名称（连接扫描仪时从设备管理器中获得）。我不知道这是否导致扫描不起作用。遍历 deviceNames 时，这里是我找到的设备列表（使用调试器）：

“\??\HID#Vid_0536&Pid_01c1&MI_01#9&25ca5370&0&0000#{4d1e55b2-f16f-11cf-88cb-001111000030}”

“\??\HID#Vid_0536&Pid_01c1&MI_00#9&38e10b9&0&0000#{884b96c3-56ef-11d1-bc8c-00a0c91405dd}”

“\??\HID#Vid_413c&Pid_2101&MI_00#8&1966e83d&0&0000#{884b96c3-56ef-11d1-bc8c-00a0c91405dd}”

"\??\HID#Vid_413c&Pid_3012#7&960fae0&0&0000#{378de44c-56ef-11d1-bc8c-00a0c91405dd}"
"\??\Root#RDP_KBD#0000#{884b96c3-56ef-11d1-bc8c-00a?0c914dd50? \ACPI#PNP0303#4&2f94427b&0#{884b96c3-56ef-11d1-bc8c-00a0c91405dd}" "\??\Root#RDP_MOU#0000#{378de44c-56ef-11d1-bc8c-00a0c91405dd}" "\??\ACPI#PNP0F #4&2f94427b&0#{378de44c-56ef-11d1-bc8c-00a0c91405dd}"

所以 HID#Vid_0536&Pid_01c1 有 2 个条目；这会导致扫描不起作用吗？

好的，看来我必须想办法不依赖扫描仪发送的 ASCII 0x04 字符……因为我的扫描仪不发送该字符。之后，触发条形码扫描事件并显示带有条形码的弹出窗口。所以感谢尼古拉斯的帮助。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-26T06:13:54.820

[您可以像我最近所做的那样使用原始输入 API 来区分键盘和扫描仪。](https://web.archive.org/web/20150108213851/http://nicholas.piasecki.name/blog/2009/02/distinguishing-barcode-scanners-from-the-keyboard-in-winforms)您连接了多少键盘或类似键盘的设备并不重要。`WM_INPUT`在击键映射到通常在`KeyDown`事件中看到的与设备无关的虚拟键之前，您会看到一个。

更容易的是按照其他人的建议进行操作，并将扫描仪配置为在条形码之前和之后发送标记字符。（您通常通过扫描扫描仪用户手册背面的特殊条形码来做到这一点。）然后，您的主窗体的`KeyPreview`事件可以观察那些滚动结束并吞下任何子控件的关键事件（如果它处于条形码读取的中间）。或者，如果你想变得更漂亮，你可以使用一个低级的键盘钩子`SetWindowsHookEx()`来监视那些哨兵并将它们吞下（这样做的好处是即使你的应用程序没有焦点，你仍然可以获得事件）。

我无法更改条形码扫描仪上的标记值，所以我不得不走复杂的路线。绝对是痛苦的。如果可以的话，保持简单！

--

**七年后您的更新：**如果您的用例是从 USB 条形码扫描仪读取，Windows 10 有一个很好、友好的 API 用于这个内置的`Windows.Devices.PointOfService.BarcodeScanner`. 它是一个 UWP/WinRT API，但您也可以从常规桌面应用程序中使用它；这就是我现在正在做的事情。下面是一些示例代码，直接来自我的应用程序，为您提供要点：

```
{
    using System;
    using System.Linq;
    using System.Threading.Tasks;
    using System.Windows;
    using Windows.Devices.Enumeration;
    using Windows.Devices.PointOfService;
    using Windows.Storage.Streams;
    using PosBarcodeScanner = Windows.Devices.PointOfService.BarcodeScanner;

    public class BarcodeScanner : IBarcodeScanner, IDisposable
    {
        private ClaimedBarcodeScanner scanner;

        public event EventHandler<BarcodeScannedEventArgs> BarcodeScanned;

        ~BarcodeScanner()
        {
            this.Dispose(false);
        }

        public bool Exists
        {
            get
            {
                return this.scanner != null;
            }
        }

        public void Dispose()
        {
            this.Dispose(true);
            GC.SuppressFinalize(this);
        }

        public async Task StartAsync()
        {
            if (this.scanner == null)
            {
                var collection = await DeviceInformation.FindAllAsync(PosBarcodeScanner.GetDeviceSelector());
                if (collection != null && collection.Count > 0)
                {
                    var identity = collection.First().Id;
                    var device = await PosBarcodeScanner.FromIdAsync(identity);
                    if (device != null)
                    {
                        this.scanner = await device.ClaimScannerAsync();
                        if (this.scanner != null)
                        {
                            this.scanner.IsDecodeDataEnabled = true;
                            this.scanner.ReleaseDeviceRequested += WhenScannerReleaseDeviceRequested;
                            this.scanner.DataReceived += WhenScannerDataReceived;

                            await this.scanner.EnableAsync();
                        }
                    }
                }
            }
        }

        private void WhenScannerDataReceived(object sender, BarcodeScannerDataReceivedEventArgs args)
        {
            var data = args.Report.ScanDataLabel;

            using (var reader = DataReader.FromBuffer(data))
            {
                var text = reader.ReadString(data.Length);
                var bsea = new BarcodeScannedEventArgs(text);
                this.BarcodeScanned?.Invoke(this, bsea);
            }
        }

        private void WhenScannerReleaseDeviceRequested(object sender, ClaimedBarcodeScanner args)
        {
            args.RetainDevice();
        }

        private void Dispose(bool disposing)
        {
            if (disposing)
            {
                this.scanner = null;
            }
        }
    }
} 
```

当然，您需要一个支持 USB HID POS 的条形码扫描仪，而不仅仅是一个键盘楔。如果您的扫描仪只是一个键盘楔子，我建议您从 eBay 上以 25 美元的价格购买二手霍尼韦尔 4600G 之类的东西。相信我，你的理智是值得的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T21:21:51.197

我在类似情况下所做的是通过查看输入速度来区分扫描和用户打字。

许多字符非常靠近，然后暂停是扫描。其他任何东西都是键盘输入。

我不确切知道您的要求，所以也许这对您不起作用，但这是我所拥有的最好的:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T21:10:37.513

这取决于您与设备交互的方式。无论如何，它不会是 C# 解决方案，而是其他一些库。您是否正在从流中读取数据？如果您只是敲击键盘，您可能无能为力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-15T12:01:17.097

看看这个：~~[http](http://nate.dynalias.net/dev/keyboardredirector.rails)~~ **: //nate.dynalias.net/dev/keyboardredirector.rails**（不再可用）效果很好！

指定要阻止的键盘和键，它就像一个魅力！

也看看这个：[http](http://www.oblita.com/interception.html) ://www.oblita.com/interception.html 你可以为它创建一个 C# 包装器 - 它也像一个魅力..

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-10-29T18:30:54.353

我知道这是一个旧线程，通过在WIN10中搜索条形码扫描找到它。只是一些笔记，以防有人需要它。

霍尼韦尔的这些扫描仪具有多个 USB 接口。一种是键盘+Hid Point of sale（复合设备）。还有 CDC-ACM（ComPort 仿真）和 Hid 销售点（单独）+ 更多。

默认情况下，扫描仪会公开一个序列号，因此主机可以区分许多设备（我曾经连接过 +20）。有一个命令可以禁用序列号！

较新的模型在这方面表现相同。如果你想现场观看，试试我的终端程序 yat3（在[我的网站](http://dieter-fauth.bplaced.net)上免费）。它可以打开上面提到的所有接口，并且是为此类设备量身定制的。

使用键盘界面的一句话：
仅将它们用作最后​​的手段。当涉及到异国情调的角色时，它们很慢，不太可靠。唯一的好用处是如果您想将数据输入到现有应用程序中。如果您仍然编码，那么从 ComPort/HidPos-Device 读取会更容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T23:24:38.593

我认为您可能能够通过 DirectX API 区分多个键盘，或者如果这不起作用，则通过原始输入 API。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-01T18:47:46.060

我已经成功地完成了你们在这里寻找的东西。我有一个从 Honeywell/Metrologic 条码扫描仪接收所有条码字符数据的应用程序。系统上没有其他应用程序接收到来自扫描仪的数据，键盘继续正常工作。

我的应用程序结合使用原始输入和可怕的低级键盘挂钩系统。与这里写的相反，我发现在调用键盘钩子函数之前收到了 wm_input 消息。我处理 wm_input 消息的代码基本上设置了一个布尔变量来指定接收到的字符是否来自扫描仪。处理 wm_input 后​​立即调用的键盘挂钩函数吞下扫描仪的伪键盘数据，防止数据被其他应用程序接收。

键盘钩子函数必须放在一个 dll 中，因为您想拦截所有系统键盘消息。此外，内存映射文件必须用于 wm_input 处理代码与 dll 通信。

# apache-flex - FLEX：以编程方式删除警报？

> ID：587848
> 
> 赞同：4
> 
> 时间：2009-02-25T21:08:02.293
> 
> 标签：apache-flex, actionscript-3, alert, deep-linking

我需要以编程方式删除警报。

这就是原因：我的应用程序使用 BrowserManager 根据 url 的 #hash 部分中的内容启用深度链接。如果当前出现警报，并且用户点击后退按钮，应用程序将恢复到之前的状态。但是警报仍然会出现，并且在许多情况下与那时无关。

那么有没有办法以编程方式删除警报？因此，当哈希片段发生变化时，我可以将其删除。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-25T21:42:26.203

事实证明 Alert.show 函数返回一个 Alert 引用，然后只使用 PopUpManager 将其添加到显示列表中。因此，如果您在调用*Alert.show*时捕获返回引用，则可以告诉 PopUpManager 将其删除。:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T21:43:09.807

为此，您可以将`Alert`对象保留为成员数据，然后`visible`在完成后将其属性设置为 false。下次您需要显示警报时，不要创建新警报 - 获取您已经创建的警报并设置其属性，然后`visible`再次设置为 true。

```
private var myAlert : Alert;

public void showAlert( message: String, title : String ) : void
{
    hideAlert();

    myAlert = Alert.show( message, title, Alert.OK | Alert.NONMODAL );
}

public void hideAlert() : void
{
    if( myAlert != null && myAlert.visible ) {
        myAlert.visible = false;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T21:16:52.020

我不认为这是可能的。

您可以创建自己的警报组件子类化`TitleWindow`，然后用于`PopupManager`显示/隐藏它们。

# html - 如何将 Flash 应用程序嵌入到应用程序文件位于远程服务器上的网站中

> ID：587852
> 
> 赞同：1
> 
> 时间：2009-02-25T21:08:54.507
> 
> 标签：html, apache-flex, flash

我开发了一个 Adob​​e Flex (v. 2) 应用程序。该应用程序以 .swf 文件的形式存在于 Web 服务器上。我有一个托管在完全不同的 Web 服务器上的 html 页面（它独立于 .swf 文件所在的 Web 服务器）。

我的问题是我如何能够从 html 页面中调用 .swf 文件（位于单独的 Web 服务器上）并将 flex 应用程序嵌入到 html 页面中？我尝试从 html 页面中调用 .swf 文件的 url。

不幸的是，我没有收到错误消息。我的 html 页面中没有任何内容。我期待看到我的 swf 应用程序嵌入其中。

这是我在 html 页面中用于调用和嵌入 swf 文件的代码示例。

```
AC_FL_RunContent(
        "src", "http://www.url/swfName.swf",
        "width", "580",
        "height", "472",
        "align", "middle",
        "id", "swfName",
        "quality", "high",
        "bgcolor", "#869ca7",
        "name", "swfName",
        "flashvars",'historyUrl=history.htm%3F&lconid=' + lc_id + '',
        "allowScriptAccess","sameDomain",
        "type", "application/x-shockwave-flash",
        "pluginspage", "http://www.adobe.com/go/getflashplayer"
); 
```

我在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T19:03:56.660

也许这是某种跨域问题（意味着闪存在不同的域上？）所以你需要一个 crossdomain.xml 文件。[在此处](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_14213)查看更多信息，希望对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T21:20:47.707

AFAIK，它应该工作。当你加载页面时你得到了什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T09:30:06.510

您是否尝试将 Flash 应用程序嵌入您的网站，但内容位于远程服务器/站点上？如果是这样，您可能需要更改标签和标题以在此处覆盖更广泛的受众。

# c# - 超慢C#自定义控件

> ID：587856
> 
> 赞同：2
> 
> 时间：2009-02-25T21:09:30.633
> 
> 标签：c#, optimization, user-controls

我制作了一个自定义控件，它是一个 FlowLayoutPanel，我在其中放入了一堆其他自定义控件（只是按钮，每个都有三个标签和一个图片框覆盖）

它适用于大约 100 个按钮，但将其增加到 1000 个时就会遇到麻烦。将其提高到 5000，它会在 20 秒后死亡。

我的自定义代码很少，并且我明智地使用了暂停和恢复布局。

那么我做错了什么？我确信我的（相当快速的）计算机应该能够处理几千个按钮和标签。

（我对 C# GUI 的东西还很陌生，所以也许我应该做一些完全不同的事情。）

编辑1：

这几乎是目前唯一的自定义代码：

```
flowLayoutPanel1.SuspendLayout();
foreach (DataRow row in dt.Rows) // dt is from a DB query
{
    flowLayoutPanel1.Controls.Add(new PersonButton(row));
}
flowLayoutPanel1.ResumeLayout(); 
```

在 PersonButton 构造函数中：

```
this.label1.Text = row["FirstName"].ToString().Trim() + " "
    + row["Surname"].ToString().Trim(); 
```

（还应该附上一张图片，但我不确定是否有人能看到。）

编辑2：

我想我真的应该使用 DataGridView 或 ListView，但我想要的不仅仅是一行文本和每行一个小图标；我希望它看起来类似于 Firefox 中的下载视图（Ctrl + J）。（见截图）

非常感谢您的所有意见，顺便说一句。我想我得重新考虑...

[替代文字 http://img156.imageshack.us/img156/1057/capture.png](http://img156.imageshack.us/img156/1057/capture.png)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-25T21:18:22.017

C# WinForm 应用程序可以处理 1000 个任何类型控件的实例吗？我不是 WinForm Guru，但您对您的应用程序的期望可能是不合理的。

您想要显示 1000 多个任何类型的控件这一事实可能表明您正在从错误的方向接近您的软件设计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T21:12:08.850

您必须发布一些布局代码，否则我们将无能为力/根本无法提供帮助。

此外，您最好的第一选择是分析您的代码。分析是找出代码中究竟是什么执行缓慢的唯一可靠方法。根据我的经验，UI 代码尤其如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T21:59:51.560

如果有 1000 多个按钮，您的应用程序的 GDI 资源和/或原始句柄可能会非常低。

不确定您的应用程序应该做什么，但网格或组合框可能是这里更好的选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T22:16:20.833

听起来你真的需要重新考虑你的界面。

就像其他人提到的那样，表单上的控件数量将不可用。

然而，我做了一些实验，以查看在代码中创建新控件的时间，甚至使用反射，并发现在流布局面板中动态创建的数百个数据绑定控件应该在 1 到 2 秒内创建。

发布更多代码示例可能有助于获得更好的答案。

更多信息：我刚刚再次重新运行计时测试，300 个控件用时 0.5 秒，400 个用时 1.9 秒，600 个用时 3 秒，1000 个用时 6 秒。
似乎在 300 到 400 之间有一个限制，资源开始被过度利用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T22:18:13.963

5k 控件所需的布局逻辑对于任何类型的包装面板来说都太多了。您可能想研究一种不同类型的控件，该控件设计了可容纳数千个条目的控件，例如[DataGridView](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.aspx)。

DataGridView 有几种不同的[列类型](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcolumn.aspx)可用，它们应该适用于您正在显示的数据类型（图像、按钮、标签）。由于您的数据库查询看起来返回一个 DataTable，您可以简单地[将其直接绑定到您的 DataGridView](http://www.switchonthecode.com/tutorials/csharp-tutorial-binding-a-datagridview-to-a-database)并删除循环。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-25T12:10:16.850

[死灵模式=开启]

您有 1000 行数据，但您只能显示其中的一些，因此只创建将可见的控件，并在滚动时重用它们以使用新数据更改其内容。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-07-28T04:57:21.183

试试这个; 将此方法放入您的代码中。

受保护的覆盖 CreateParams CreateParams { get { CreateParams cp = base.CreateParams; cp.ExStyle |= 0x02000000; 返回cp；} }

# project-management - 在 AccuRev 中布置多个项目的最佳方式

> ID：587860
> 
> 赞同：3
> 
> 时间：2009-02-25T21:10:40.587
> 
> 标签：project-management, version-control, accurev

我正在从另一个 SCM 切换到 AccuRev。我有很多项目，并且正在努力如何在 AccuRev 中正确布置它们。

我有很多相关的项目并希望将它们保存在一个仓库中，但我还没有找到如何将它们分开以便您可以跟踪各个项目的方法。换句话说，我不想一次拉*每个*项目。

我现在的项目布局是

```
-Project Group
  - Sub project 1
  - Sub project 2
-Project 2
-Project etc... 
```

有没有人建议如何在单个仓库中管理这些项目，或者我应该只使用多个仓库（每个项目一个）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T22:11:11.017

Accurev 中的概念是您的软件仓库的根代表您的所有源代码。

然后，您创建执行工作的每个项目流（分支），并且它们本身可能会拆分为更多流（补丁、修订等）。

然后，用户将他们的个人工作区附加到这些流中，并通过他们的工作促进更改。然后根据需要将这些更改向上传播。

每个流都有能力从其父级过滤我们的内容。此过滤后的内容将在所有子流或工作区中不可见。

因此，在您的示例中，从事“项目 2”的用户将从仓库创建一个“项目 2”流，该流将过滤掉“项目等”等等。

我为 Accurev 找到的最佳层次结构类似于；

*   项目
    *   项目A
    *   项目 B
*   常见的
*   中间件

然后每个项目都有自己的流，可以过滤掉其他项目，但仍保留公共文件。

Accurev 与许多其他 SCM 软件包非常不同，但它确实是一款非常出色的产品，因此请坚持使用。

# oracle - 在 Oracle Spatial (SDO) 中，有没有办法获取多边形表面所包含的多边形的质心点？

> ID：587863
> 
> 赞同：0
> 
> 时间：2009-02-25T21:11:36.480
> 
> 标签：oracle, gis, geospatial, oracle-spatial

我需要在多边形本身内部的 Oracle Spatial 中找到多边形的质心。我不能使用 sdo_geom.sdo_centroid 方法，因为如果形状类似于马蹄形，这将返回形状之外的一个点。

我找到了 sdo_geom.sdo_pointonsurface 方法，但它返回的点*恰好*位于多边形的边缘。虽然这在数学上可行，但在我们的环境中并不安全，因为所有多边形都与其他多边形共享一个边界，有时数据中会有轻微的重叠。此重叠不能包括计算点。

是否有另一种方法可以在不编写自定义代码的情况下找到这一点？我不反对为此编写自定义代码，但如果它已经存在，我想使用一些预先构建的东西。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T01:36:17.670

Simon Greener 有一个用于“para-centroid”的包：`codesys.geom.sdo_centroid`.

您可以下载它，但我不知道是否有任何类型的许可附加到源代码。

以下是链接：

*   [Oracle Locator 与 Oracle Spatial：对 SDO_GEOM 包的 Oracle 许可的思考](http://www.spatialdbadvisor.com/oracle_spatial_tips_tricks/55/oracle-locator-vs-enterprise-licensing-the-sdogeom-package)
*   [适用于 Oracle 10gR2 的 Shapefile 导出器包](http://www.spatialdbadvisor.com/source_code)

# c# - xpath 和 c#

> ID：587864
> 
> 赞同：8
> 
> 时间：2009-02-25T21:11:45.247
> 
> 标签：c#, xpath

我正在尝试创建一个通过 XML 文档进行搜索的 winform 应用程序。对于我的搜索，我需要使用 lower-case() xpath 函数将 xpath 条件中的 XML 属性转换为小写。这会导致与函数命名空间相关的问题。

我试图手动添加命名空间：

```
 XmlNamespaceManager nsMgr = new XmlNamespaceManager(prs.Doc.NameTable);
        nsMgr.AddNamespace("fn", "http://www.w3.org/2005/02/xpath-functions");
        XmlNodeList results = prs.Doc.SelectNodes("//function[starts-with(fn:lower-case(@name),'" + txtSearch.Text + "')]",nsMgr); 
```

但我仍然得到异常：由于未知函数，此查询需要 XsltContext。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T01:54:07.580

**该[`lower-case()`](http://www.w3.org/TR/xpath-functions/#func-lower-case)函数是为[XPath 2.0](http://www.w3.org/TR/xpath20/)**定义的。

**在[XPath 1.0](http://www.w3.org/TR/xpath)**中将字母转换为小写**仍然可以使用 [`translate()`](http://www.w3.org/TR/xpath#function-translate)**如下所示的**函数：**

**`translate(@attrName, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',`**                                       **`'abcdefghijklmnopqrstuvwxyz')`**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T21:22:26.453

fn:lower-case 在[XQuery 1.0 和 XPath 2.0](http://www.w3.org/TR/xpath-functions)中定义。XSLT 2.0 与 XPATH 2.0 一起工作。

AFAIK，.NET 还不支持 XPATH 2.0。.NET 的 XSLT 版本是 1.0，还不是 2.0。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T22:09:17.683

我认为 CodeMelt 是[正确](http://msdn.microsoft.com/en-us/library/ms256138.aspx)的并且得到了我的 +1，但也许 Microsoft [ms:string-compare](http://msdn.microsoft.com/en-us/library/ms256114.aspx)扩展功能（带有不区分大小写选项）可能有助于解决您的问题？

# php - string slicing, php

> ID：587872
> 
> 赞同：1
> 
> 时间：2009-02-25T21:14:09.080
> 
> 标签：php, string, tokenize

is there a way to slice a string lets say i have this variable

```
$output=Country=UNITED STATES (US) &City=Scottsdale, AZ &Latitude=33.686 &Longitude=-111.87 
```

i want to slice it in a way i want to pull latitude and longitude values in to seperate variables, subtok is not serving the purpose

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T21:19:18.100

You don't need a regular expression for this; use `explode()` to split up the string, first by `&`, and then by `=`, which you can use to effectively parse it into a nice little array mapping names to values.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T21:23:42.737

```
$output='Country=UNITED STATES (US) &City=Scottsdale, AZ &Latitude=33.686 &Longitude=-111.87';
parse_str($output, $array);
$latitude = $array['latitude']; 
```

You could also just do

```
parse_str($output);
echo $latitude; 
```

I think using an array is better as you are not creating variables all over the place, which could potentially be dangerous (like register_globals) if you don't trust the input string.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T21:28:35.270

It looks likes it's coming from an URL, although the URL encoding is gone.

I second the suggestions of using [`explode()`](http://www.php.net/explode) or [`preg_split()`](http://www.php.net/preg_split) but you might also be interested in [`parse_str()`](http://www.php.net/parse_str).

```
$output = "City=Scottsdale, AZ &Latitude=33.686 &Longitude=-111.87";
parse_str($output, $results);
$lat = $results['Latitude'];
$lon = $results['Longitude']; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T21:19:44.433

I'm not sure exactly what you're demonstrating in your code, maybe it's just some typos, is the "$output" the name of the variable, or part of the string?

Assuming it's the name of the variable, and you just forgot to put the quotes on the string, you have a couple options:

* * *

```
$sliced = explode('&', $output) 
```

This will create an array with values: "Country=UNITED STATES(US) ", "City=Scottsdale, AZ ", etc.

* * *

```
$sliced = preg_split('/[&=]/', $output); 
```

This will create an array with alternating elements being the "variables" and their values: "Country", "UNITED STATES(US) ", "City", "Scottsdale, AZ ", etc.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T21:21:55.723

You could do the following:

```
$output = 'Country=UNITED STATES (US) &City=Scottsdale, AZ &Latitude=33.686 &Longitude=-111.87';

$strs = explode('&', $output);
foreach ($strs as $str) {

   list($var, $val) = explode('=',$str);
   $$var = trim($val);

} 
```

This would give you variables such as $Latitude and $Longitude that are set to the value in the key/value pair.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-14T02:22:49.760

All of the other Answers are Insufficient. This Should Work Every Time!

```
function slice($string, $start){
  $st = $string; $s = $start; $l = strlen($st); $a = func_get_args();
  $e = isset($a[2]) ? $a[2] : $l;
  $f = $e-$s;
  $p = $e < 0 && $s > 0 ? $l+$f : $f;
  return substr($st, $s, $p);
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-25T21:15:55.877

I suggest you read about regular expressions in the PHP help.

# c# - 在表示层使用多态性的简洁方式 - ASP.NET

> ID：587877
> 
> 赞同：1
> 
> 时间：2009-02-25T21:15:21.120
> 
> 标签：c#, asp.net

很多时候，我发现自己在后面的代码中进行 UI 控件操作，并希望找到一种干净的方式来执行此操作。

用例：下拉列表具有 CSS1 样式，在编辑模式下可编辑，但具有 CSS2 样式，仅在查看模式下查看

我可以通过简单的一组 switch case 语句来实现这一点。我可以使用多态性并创建一个 EditMode 和 ViewMode 类，但这需要我对要传递给这些类的 UI 控件的引用。这将 UI 和我想要避免的逻辑层紧密结合在一起。

有任何想法吗？

**编辑：任何人都可以举一个从后面的代码外部化 UI 逻辑的例子吗？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T16:16:30.690

通过控制不一定紧密结合，但我可以理解其中的推理并同意它，作为一般规则。

一种选择是将类创建为 UI 类。这并不意味着它必须嵌入到 ASP.NET Web 应用程序中，而是将库设置为 Web UI 库。我通过命名来做到这一点：

company.application.UI.{libraryName}

您的命名可能不同。

在架构中，拥有具有多态辅助类的 UI 库并没有错。我不会将这些类下移到业务层。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T02:28:58.137

看看[动态数据 Web 应用程序](http://quickstarts.asp.net/previews/dynamicdata/)。在那里，您可以找到一种将视图控件与编辑控件完全分开的方法。

# asp.net - ASP.NET 母版页添加脚本的顺序

> ID：587880
> 
> 赞同：2
> 
> 时间：2009-02-25T21:15:40.510
> 
> 标签：asp.net, master-pages, clientscriptmanager

我有一个母版页，通过 registerclientscriptinclude 添加 jquery 库：

```
Page.ClientScript.RegisterClientScriptInclude(this.GetType(), 
    "JQuery", 
    Page.ResolveUrl("~/Scripts/jquery-1.2.6.min.js")); 
```

在使用该母版页的页面中，我想包含一个依赖于 jquery 的脚本：

```
Page.ClientScript.RegisterClientScriptInclude(this.GetType(), 
    "jqplugin1", 
    Page.ResolveUrl("~/Scripts/jquery.plugin1.compressed.js")); 
```

这会导致问题，因为首先编写页面的客户端脚本，然后是母版页客户端脚本（导致插件抱怨“jquery”未定义）。

有没有办法控制客户端脚本包含的顺序？或者，关于如何最好地控制这一点的任何建议（母版页暂时只包括所有内容......但这不会长期有效）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T21:19:08.117

您可以在页面中重新包含 jQuery 库，如果它已经存在，它将简单地覆盖它，如果没有，它将被添加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T22:21:27.170

由于母版页就像嵌入在页面中的控件，您可以在页面循环结束时添加这些脚本，控件会先触发然后页面，因此您的页面会很好。

# javascript - 使用原型迭代javascript中对象的每个属性？

> ID：587881
> 
> 赞同：89
> 
> 时间：2009-02-25T21:15:42.820
> 
> 标签：javascript, prototypejs

有没有办法使用 Prototype JavaScript 框架迭代对象的每个属性？

情况如下：我在 JSON 中得到一个 AJAX 响应，看起来像这样：

```
{foo: 1, bar: 2, barobj: {75: true, 76: false, 85: true}} 
```

如果我将该 json 响应评估为一个变量`response`，我希望能够遍历`response.barobj`对象中的每个属性以查看哪些索引为真，哪些为假。

Prototype 两者都有`Object.keys()`，`Object.values()`但奇怪的是似乎没有简单的`Object.each()`功能！我可以获取 Object.keys() 和 Object.values() 的结果，并在遍历其中一个时交叉引用另一个，但这是一种技巧，我确信有一种正确的方法可以做到这一点！

* * *

## 回答 #1

> 赞同：553
> 
> 时间：2009-02-25T22:52:11.417

这里不需要原型：JavaScript 有[`for..in`](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Statements/for...in)循环。如果您不确定没有人弄乱`Object.prototype`，请检查一下`hasOwnProperty()`，即

```
for(var prop in obj) {
    if(obj.hasOwnProperty(prop))
        doSomethingWith(obj[prop]);
} 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-02-25T21:34:30.963

您必须首先[将对象文字转换为 Prototype Hash](http://prototypejs.org/doc/latest/language/Hash/)：

```
// Store your object literal
var obj = {foo: 1, bar: 2, barobj: {75: true, 76: false, 85: true}}

// Iterate like so.  The $H() construct creates a prototype-extended Hash.
$H(obj).each(function(pair){
  alert(pair.key);
  alert(pair.value);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T21:32:54.043

您应该遍历键并使用方括号获取值。

请参阅：[如何枚举 javascript 对象的属性？](https://stackoverflow.com/questions/85992/how-do-i-enumerate-the-properties-of-a-javascript-object)

**编辑：**显然，这使问题重复。

# java - Jenkins 的 Hash 的 Java 端口

> ID：587884
> 
> 赞同：3
> 
> 时间：2009-02-25T21:16:41.337
> 
> 标签：java, hash

我正在寻找这个文件的 java 端口， [Jenkins Hash in C](http://burtleburtle.net/bob/c/lookup2.c)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T21:21:31.697

[这](http://256stuff.com/sources/jenkins_hash_java/)看起来像一个。

不过，从 Wikipedia 文章上的描述来看，您可以自己移植它而不会遇到太多麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-12T21:47:25.857

[Hsieh的哈希](http://www.azillionmonkeys.com/qed/hash.html)甚至更好。我不知道 java 实现 - 我现在正在写一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-04T01:55:28.250

在 Github 上有[g414-hash](https://github.com/sunnygleason/g414-hash)项目，其中包括您可能想要使用的哈希函数，包括 jenkins、murmur、hsieh 和 cwow。它还具有可以使用散列的布隆过滤器实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-14T16:45:16.563

一只鸭鸭去搜索揭示了这一点：[http ://www.java2s.com/Code/Java/Development-Class/JenkinsHash.htm](http://www.java2s.com/Code/Java/Development-Class/JenkinsHash.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-03T22:07:50.073

Apache 许可 - [http://people.apache.org/~yonik/code/hash/Hash.html](http://people.apache.org/~yonik/code/hash/Hash.html)

# asp.net - 从 GridView 控件继承的自定义 ASP.NET 控件不呈现样式（例如 AlternatingRowStyle.BackColor）

> ID：587886
> 
> 赞同：0
> 
> 时间：2009-02-25T21:17:11.053
> 
> 标签：asp.net, gridview, custom-controls

我正在使用的 ASP.NET [GridView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.alternatingrowstyle.aspx)控件的扩展版本遇到了一些不寻常的问题。它正在渲染应用到它的所有文本，但没有渲染任何设置的样式属性。例如，如果我将[AlternatingRowStyle](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.alternatingrowstyle.aspx)设置为使用灰色背景，则不会呈现灰色背景。但是，如果我将相同的数据集和属性传递给 vanilla GridView 控件，则背景会正确呈现。

有什么想法我可能做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T00:31:04.190

疯狂猜测：您的风格是否被定义为主题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T13:22:20.220

好吧，我敢肯定这一开始应该很明显，但是在使用“评论内容直到它开始工作”的类调试技术之后，我设法将问题隔离为由于在[RenderContents](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webcontrol.rendercontents.aspx)中具有数据绑定列生成代码。这让我相信我错过了该代码中的一个调用，但[OnPreRender](http://msdn.microsoft.com/en-us/library/system.web.ui.control.onprerender.aspx)的代码纠正了这个问题。

# wpf - WPF ControlTemplate 如何

> ID：587892
> 
> 赞同：0
> 
> 时间：2009-02-25T21:18:31.020
> 
> 标签：wpf, architecture, controltemplates

我对 WPF 很陌生，大约 4 小时新。我来自 ASP.net 和 Masterpages。

我正在查看可用于模板化窗口的控制模板示例，因此所有窗口看起来都一样。 [其他帖子](https://stackoverflow.com/questions/420538/how-to-make-a-template-window-in-wpf)

有人可以指导我如何完成它的示例或从头到尾的示例代码吗？

第二部分：

ControlTemplate 是构建 WPF Windows 客户端应用程序的最佳方式吗？构建 WPF Windows 应用程序的最佳实践是什么。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T19:35:11.923

There really isn't a "best" way to architect WPF UIs. It all depends on the user experience your application will have.

If you want a very web-like experience you are probably better of using the pages constructs. Otherwise if you have windows, but want a common header, you may just want to make a control template for that. Maybe you need separate windows or maybe you just need to have a sub part of a grid panel change content depending on state... There are different ways to do things that are more or less suited to the type of client experience you want.

Although there are some best practices in relation to using MVC/MVVM design patterns, there isn't a "best" way to style and theme your controls. I don't consider WPF as friendly to newcomers as WinForms were, but at the same time it seems a lot more powerful in the long run. What might help you out are some basic levels of theming:

*   **Styles**: these are mainly aesthetic changes to the look and feel of basic controls and elements with some very basic support for triggering things like mouse cursor roll over. They are similar to CSS on webpages.
*   **Control Templates**: these are the more heavyweight versions of styles where you actually reconstitute a control so that, say a button can have a textbox inside of it. Where styles work on a logical level where something like a button is the most atomic element, control templates can drill down further into controls so that the border, background, text, etc of a button are seen as separate elements instead of one atomic part.
*   **Data Templates**: A more focused version of control templates meant to customize how data items in lists are drawn. If you have a bunch of pictures you don't want the file name to show up in the listbox, you'd rather have the image itself. A data template lets you accomplish this kind of thing.

So you have to ask yourself when you say, "Make all windows look the same," do you mean changes are merely aesthetic/looks (styles), customizing how a collection of items are displayed (data/item templates) or altogether changing how a standard control looks and behaves or making sure the layout of controls on a page are the same across multiple windows/pages (control templates)?

Finally, the "end to end" of the other post you linked to is pretty simple. You take the control template there, and under your tag you simply add Template={StaticResource MyTemplateName} and the template is applied. [This article on MSDN](http://msdn.microsoft.com/en-ca/magazine/cc163497.aspx) is a decent intro to control templating.

# security - 如何在不阻止行为良好的机器人的情况下阻止 Web 抓取？

> ID：587896
> 
> 赞同：1
> 
> 时间：2009-02-25T21:19:12.827
> 
> 标签：security, seo, screen-scraping, bots

我正在建立一个包含大型产品数据库的电子商务网站。当然，当 Goggle 索引网站的所有产品时也很好。但是，如果某个竞争对手想要[Web 抓取](http://en.wikipedia.org/wiki/Web_scraping)网站并获取所有图像和产品描述怎么办？

我正在观察一些具有类似产品列表的网站，它们放置了验证码，因此“只有人类”才能阅读产品列表。缺点是……它对 Google、Yahoo 或其他“行为良好”的机器人是不可见的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T21:28:41.277

您可以通过使用 whois（在命令行或网站上）检查访问者 IP 来发现 Google 和其他人正在使用的 IP 地址。然后，一旦你积累了一些合法的搜索引擎，就允许它们进入你的产品列表，而不需要验证码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T21:30:16.093

由于潜在的屏幕截图应用程序可以在标头中欺骗用户代理和 HTTP 引荐来源网址（用于图像）并使用类似于人类浏览器的时间表，因此不可能完全阻止专业刮板。但是您仍然可以检查这些东西并防止随意刮擦。除了在网站上注册之外，我个人觉得验证码很烦人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T21:42:01.213

如果您担心竞争对手使用您的文本或图像，那么水印或自定义文本怎么样？

让他们拍摄您的照片，您的网站上就会有您的徽标！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-16T23:38:27.827

您可以尝试的一种技术是“蜜罐”方法：可以通过一些简单的脚本挖掘日志文件来完成。

基本过程是您通过查找在很短的时间内查看 2+ 不相关产品的 IP 地址来建立自己的爬虫 IP 的“黑名单”。这些 IP 很可能属于机器。然后，您可以对它们进行反向查找以确定它们是好（如 GoogleBot 或 Slurp）还是坏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-24T08:54:25.707

阻止网络爬虫并不容易，而避免误报则更加困难。

无论如何，您可以将一些网络范围添加到白名单中，并且不要向他们提供任何验证码。所有那些众所周知的爬虫：Bing、Googlebot、Yahoo 等。在爬取时总是使用特定的网络范围，并且所有这些 IP 地址都会解析为特定的反向查找。

几个例子：

**Google** IP 66.249.65.32 解析为 crawl-66-249-65-32.googlebot.com

**必**应 IP 157.55.39.139 解析为 msnbot-157-55-39-139.search.msn.com

**雅虎**IP 74.6.254.109 解析为 h049.crawl.yahoo.net

因此，假设“ **.googlebot.com* ”、“ *** .search.msn.com ”和“ **.crawl.yahoo.net* ”地址应列入白名单。

您可以在互联网上实施大量白名单。

话虽如此，我不认为验证码是针对高级爬虫的解决方案，因为诸如**deathbycaptcha.com**或**2captcha.com**之类的服务承诺在几秒钟内解决任何类型的验证码。

请查看我们的 wiki [http://www.scrapesentry.com/scraping-wiki/](http://www.scrapesentry.com/scraping-wiki/)我们写了很多关于如何预防、检测和阻止网络爬虫的文章。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-09-17T02:17:37.990

也许我过于简化了，但如果您担心服务器性能，那么提供 API 将减少对爬虫的需求，并为您节省带宽/带宽处理器时间。

此处列出的其他想法：

[http://blog.screen-scraper.com/2009/08/17/further-thoughts-on-hindering-screen-scraping/](http://blog.screen-scraper.com/2009/08/17/further-thoughts-on-hindering-screen-scraping/)

# java - JMS 消息传递性能：大量主题/队列与广泛过滤（消息选择器）

> ID：587899
> 
> 赞同：23
> 
> 时间：2009-02-25T21:19:23.060
> 
> 标签：java, performance, jboss, jms, messaging

我正在开发一个将大量使用 JBoss Messaging (JMS) 的项目。我的任务是为其他开发人员围绕消息构建一个易于使用的包装器，并且正在考虑使用 JMS 的消息选择器来提供一种过滤技术，以将不必要的消息发送降至最低。我很好奇是否有人在性能方面有这样做的经验？我担心 JMS 提供者可能会陷入消息选择器的困境，从而有效地破坏了整个目的。但是，这比为每种消息类型创建一长串主题/队列要好得多。

最终，毫无疑问，我最终会使用两者的某种组合，但无论我更倾向于哪种方式，我都会担心对性能的影响。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-23T14:22:12.750

正如 Martin 所提到的，默认情况下，大多数 JMS 实现将在客户端处理消息选择器，*除非*它们是持久订阅的一部分，此时*大多数*JMS 实现也会在服务器上处理它们，以避免在显着减少时保留太多消息通过选择器的消息数量。某些系统（如 SonicMQ）允许您指定应在服务器上处理消息选择器，这在您的消息代理上可用 CPU 过多但消费者上没有可用 CPU 的情况下是一个不错的选择。

请记住，虽然基于主题的选择通常更快，但它可能相当麻烦，因为如果你想听 5 个不同的东西，你必须有 5 个不同的 MessageConsumer。幼稚驱动程序实现中的每一个都是不同的线程，并且可以开始累加。出于这个原因，从发布中支持两者通常很有用，这样一些客户端可以只收听他们想要的主题，而其他客户端可以使用消息选择器（或代码-基于选择器）。

但是，**您应该始终针对您的应用程序和您的代理进行测试**。每个代理处理情况的方式不同，每个应用程序的功能也不同。您不能只说“始终使用技术 X”，因为用于客户端导向消息处理的每种技术都有不同的权衡。基准，基准，基准。

使用消息选择器要记住的一件事是它们不能动态更改，因此您可能会丢失消息或必须手动管理复杂的切换场景。想象以下用例：

1.  您正在收听表单的消息选择器（Ticker in ('CSCO', 'MSFT')）
2.  用户想开始收听 AAPL
3.  您必须关闭旧的 MessageConsumer 并使用表单中的选择器启动一个新的 (Ticker in ('CSCO, 'MSFT', 'AAPL'))
4.  在切换期间，您要么丢失消息（因为您在启动新消息之前关闭了旧消息），要么您必须手动删除重复消息（因为您在旧消息之前启动了新消息）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-26T10:52:51.230

我的两分钱：

我问过自己关于 ActiveMQ 的完全相同的问题。

*   首先，我没有使用选择器并创建了很多主题。性能很糟糕，因为没有大量资源，经纪人无法处理 100 个主题。
*   然后我使用了主题/选择器的组合。我现在有少量主题。选择效果很好。但是负载不是很重，不超过10 msg/s

我确实开发了一个抽象层，允许开发人员在不问问题的情况下编写代码，我们通过切换实现来进行测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T22:22:25.797

不同的实现，但我将传递我与 BEA 的 JMS 产品的高级架构师的对话。我提到了使用选择器，他评论了一些类似“很好，如果你不希望它执行”的内容。

我们的应用每秒发送 10 条消息。他可能已经习惯了看到每秒 100-1000 次的棘手问题。除非您处于更高的范围或硬件非常慢，否则许多队列/主题或选择器可能会正常工作。

关于 Don 关于 JMS 易于使用的观点……我们使用包装器来抽象事物。一旦遇到诸如健壮的重新连接和正确处理多线程/异步侦听器之类的问题，就会有许多错误的方法来编写代码。对我们来说，包装细节是非常值得的，这样客户就可以对大部分细节保持无辜。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-25T23:13:31.553

根据我对 JBoss MQ 实现的经验，**客户端**使用消息选择器来过滤消息。显然，这意味着主题中的每条消息仍然会发送给每个收件人，即使他们忽略它。另一方面，服务器上不同的队列和主题会影响服务器性能。

我想说选择器的扩散会影响客户端和网络负载，而主题和队列的扩散会影响服务器负载。显然，网络负载、消息消费者负载和消息生产者负载的规模都不同。

除了简单的情况外，包装器变得棘手；我建议您将错误处理和 JMS API 包装到一个简单的消息传递 API 中，该 API 的概念结构可以满足您的特定需求。然后，在幕后，您可以毫不费力地更改为上述任何不同的设计。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T21:25:11.877

嗯，我有疑问。JMS 非常易于使用。我已经看到这种尝试，并且更易于使用的解决方案更难使用和错误。

# javascript - 将 jQuery 事件作为变量传递

> ID：587905
> 
> 赞同：1
> 
> 时间：2009-02-25T21:20:39.063
> 
> 标签：javascript, jquery

您可以使用 JavaScript 执行此操作：

```
function bar(test) {
    alert(test);
}
var foo = bar;
foo('hi'); 
```

我希望能够用 jQuery 事件做类似的事情：

```
var foo = $('#bork').click;
foo(function() { alert('I was just clicked.'); }); 
```

但是，页面加载时出现错误：`this.bind is not a function`. 我对这里的事件做错了吗？有没有更好的方法来获得相同的效果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T21:44:43.483

其他答案似乎没有解决技术问题：

为什么会这样：

```
$('#bork').click(function() { alert('I was just clicked.'); }); 
```

但不是这个：

```
var foo = $('#bork').click;
foo(function() { alert('I was just clicked.'); }); 
```

两者看起来是一样的，但问题是函数`this`实现中的“”在`click`第一个示例中指的是jQuery对象，但`foo`在第二个示例中指的是jQuery对象。由于您尚未定义，因此执行中`foo.bind`对“”的调用失败。`this.bind``click`

这是[一篇关于 Javascript 中绑定/作用域的来龙去脉的精彩文章](http://www.alistapart.com/articles/getoutbindingsituations)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T21:25:31.300

```
$('#bork').bind('click', foo);
function foo() { alert('i was just clicked'); } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T21:23:26.077

我认为您正在寻找该[`bind`](http://docs.jquery.com/Events/bind#typedatafn)功能。

```
$('#bork').bind("click", function() { 
    alert('I was just clicked.'); 
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T21:24:43.220

尝试以下操作：

```
$("#bork").bind("click", function() { alert("I was just clicked"); }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T21:39:40.703

您需要将 foo 定义为使您的示例工作的函数。如果您稍微更改 foo 的定义，它将起作用：

```
var foo = function(f) {$('#bork').click(f);};
foo(function() { alert('I was just clicked.'); }); 
```

# android - 尝试将文件从 SD 卡附加到电子邮件

> ID：587917
> 
> 赞同：69
> 
> 时间：2009-02-25T21:23:04.610
> 
> 标签：android, email, attachment, android-intent

我正在尝试启动发送电子邮件的意图。所有这些都有效，但是当我尝试实际发送电子邮件时，会发生一些“奇怪”的事情。

这是代码

```
Intent sendIntent = new Intent(Intent.ACTION_SEND);
sendIntent.setType("image/jpeg");
sendIntent.putExtra(Intent.EXTRA_SUBJECT, "Photo");
sendIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("file://sdcard/dcim/Camera/filename.jpg"));
sendIntent.putExtra(Intent.EXTRA_TEXT, "Enjoy the photo");
startActivity(Intent.createChooser(sendIntent, "Email:")); 
```

因此，如果我使用 Gmail 菜单上下文启动它会显示附件，让我输入电子邮件的收件人，并编辑正文和主题。没什么大不了的。我点击发送，它发送。唯一的问题是附件没有发送。

所以。我想，为什么不尝试使用电子邮件菜单上下文（用于我手机上的备用电子邮件帐户）。它显示附件，但正文或主题中根本没有文本。当我发送它时，附件会正确发送。那会让我相信有些事情是完全错误的。我是否需要在 Manifest 中获得新权限才能发送带有附件的电子邮件？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-08-14T18:57:32.117

也遇到同样的问题

代码：

```
Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND); 
    emailIntent.setType("image/jpeg");
    emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, new String[] 
    {"me@gmail.com"}); 
    emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, 
    "Test Subject"); 
    emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, 
    "go on read the emails"); 
    Log.v(getClass().getSimpleName(), "sPhotoUri=" + Uri.parse("file:/"+ sPhotoFileName));
    emailIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("file:/"+ sPhotoFileName));
    startActivity(Intent.createChooser(emailIntent, "Send mail...")); 
```

从亚行日志猫：

```
V/DumbDumpersMain( 3972):   sPhotoUri=file://sdcard/DumbDumpers/DumbDumper.jpg
I/ActivityManager(   56):   Starting activity: Intent { action=android.intent.action.CHOOSER comp={android/com.android.internal.app.ChooserActivity} (has extras) }
I/ActivityManager(   56):   Starting activity: Intent { action=android.intent.action.SEND type=jpeg/image flags=0x3000000 comp={com.google.android.gm/com.google.android.gm.ComposeActivityGmail} (has extras) }
I/ActivityManager(   56):   Starting activity: Intent { action=android.intent.action.SEND type=jpeg/image flags=0x2800000 comp={com.google.android.gm/com.google.android.gm.ComposeActivity} (has extras) }
D/gmail-ls(  120):      MailProvider.query: content://gmail-ls/labels/me@gmail.com(null, null)
D/Gmail   ( 2507):      URI FOUND:file://sdcard/DumbDumpers/DumbDumper.jpg 
```

看起来电子邮件提供商正在附加一个长度为 0 的文件。当我检查文件系统时，文件在那里并且正确。创建图像文件的代码在尝试通过电子邮件发送之前已经完成。

有人在没有魔法重启的情况下解决了这个问题（我已经尝试过了）？

问候，
鳍

**更新**

我的道路应该是

`file:///sdcard/DumbDumpers/DumbDumper.jpg`

你需要额外的`/`，因为它指向根目录，即：

`file://` **+** `/sdcard/DumbDumpers/DumbDumper.jpg`

结合为

`file:///sdcard/DumbDumpers/DumbDumper.jpg`

在上面的代码片段中，您需要：

```
emailIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("file://"+ sPhotoFileName)); 
```

我希望这有帮助。我花了很长时间来调试。

问候，
芬利

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-07-20T12:54:47.373

只是我这边的一点评论。我在使用 GMail 时遇到了同样的问题，但是当我首先将有问题的文件存储在 SD 卡上并从那里而不是从资产中检索它时，它似乎可以工作。所以我的代码如下：

```
Intent i = new Intent(Intent.ACTION_SEND);
i.putExtra(Intent.EXTRA_SUBJECT, "Title");
i.putExtra(Intent.EXTRA_TEXT, "Content");
i.putExtra(Intent.EXTRA_STREAM, uri);
i.setType("text/plain");
startActivity(Intent.createChooser(i, "Send mail")); 
```

和这里，

```
uri = Uri.fromFile(new File(context.getFilesDir(), FILENAME)); 
```

不起作用，*而*

```
uri = Uri.fromFile(new File(Environment.getExternalStorageDirectory(), FILENAME)); 
```

做。

问候，迈克尔

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-07-07T13:09:58.703

而不是 "Uri.parse" 使用 "Uri.fromFile(new File(Environment.getExternalStorageDirectory(),"file name"))"

Environment.getExternalStorageDirectory() - SD 卡或任何其他外部存储的路径

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-25T23:10:25.227

看来这实际上是正确的，不确定发生了什么，但是重新启动后它开始工作：/

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-06-18T14:16:53.497

```
 Intent i = new Intent(Intent.ACTION_SEND);
    i.setType("message/rfc822");
    i.putExtra(Intent.EXTRA_EMAIL  , new String[]{"example@mail.com"});
    i.putExtra(Intent.EXTRA_SUBJECT, "Data from app");
    i.putExtra(Intent.EXTRA_TEXT   , "experience number x");
    i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 

    Uri uri = Uri.fromFile(new File(Environment.getExternalStorageDirectory(), "filename.txt"));
    i.putExtra(Intent.EXTRA_STREAM, uri);
    startActivity(Intent.createChooser(i, "Send email...")); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-11-26T21:54:36.337

我遇到了同样的问题，到处寻找解决方案。最后，我通过找到一个开箱即用的开源应用程序解决了这个问题，并研究了他们是如何做到的。代码比较长，所以我不会在这里引用它，而是发布一个链接。查看第 449 行的 sendEmail 函数

[http://rehearsalassist.svn.sourceforge.net/viewvc/rehearsalassist/android/trunk/src/urbanstew/RehearsalAssistant/SessionPlayback.java?revision=94&view=markup](http://rehearsalassist.svn.sourceforge.net/viewvc/rehearsalassist/android/trunk/src/urbanstew/RehearsalAssistant/SessionPlayback.java?revision=94&view=markup)

我将我的代码重构为相似，现在它可以工作了。我希望这将帮助其他处于相同情况的人。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-01-17T12:30:44.730

从[RFC 1738](http://www.ietf.org/rfc/rfc1738.txt)第 3.10 节：

文件 URL 采用以下形式：

```
 file://<host>/<path> 
```

其中*host*是可以访问路径的系统的完全限定域名，*path是**目录/目录/.../name*形式的分层目录路径。

所以它是 file:///path/from/root 就像[http://host/path/from/root](http://host/path/from/root)一样，因为在第二个和第三个斜杠之间有一个隐式的“localhost”。但是如上所述，使用 Uri.FromFile() 来构建它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-02T22:47:09.807

我有同样的症状。就我而言，这是因为我最初是使用权限保存附件`MODE_PRIVATE`。一旦我将其更改为`MODE_WORLD_READABLE`似乎 GMail 就能够访问该文件并正确发送附件。

[看更多](http://developer.android.com/reference/android/content/Context.html#MODE_WORLD_READABLE)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-01T03:39:30.107

这对我来说非常有用：在这个解决方案中，Nicolas 在 Cache 文件夹中创建了一个副本，在这里 gmail 意图可以访问！ [http://stephendnicholas.com/archives/974](http://stephendnicholas.com/archives/974)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-12-19T14:03:32.980

```
public void sendMail(String path) {
        Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
        emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL,
        new String[] {AppConstant.server_mail});
        emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT,
        "IBPS ERROR Mail");
        emailIntent.putExtra(android.content.Intent.EXTRA_TEXT,
        "This is an autogenerated mail from IBPS app");
        emailIntent.setType("image/png");
        Uri myUri = Uri.parse("file://" + path);
        emailIntent.putExtra(Intent.EXTRA_STREAM, myUri);
        startActivity(Intent.createChooser(emailIntent, "Send mail..."));
        } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-01-01T19:39:15.367

也尝试添加 Intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION); 这有助于解决我的问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-09-12T07:11:06.997

我在 4 天后得到了解决方案，请在 Android(Java) 中给出 File 类的路径时注意以下几点：

1) 内部存储使用路径 String path="/storage/sdcard0/myfile.txt";

2) path="/storage/sdcard1/myfile.txt";

3）在清单文件中提及权限。

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" /> 
```

4) 首先检查文件长度以确认。

5) 检查 ES File Explorer 中关于 sdcard0 和 sdcard1 的路径是否相同，否则......

例如

```
File file=new File(path); 
long=file.length();//in Bytes 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-11-07T06:34:47.710

发送带有附件的电子邮件：（按文档）

> 意图 emailIntent = new Intent(Intent.ACTION_SEND); emailIntent.setType(HTTP.PLAIN_TEXT_TYPE);
> 
> emailIntent.putExtra(Intent.EXTRA_EMAIL, new String[] {"jon@example.com"});
> 
> emailIntent.putExtra(Intent.EXTRA_SUBJECT, "电子邮件主题"); emailIntent.putExtra(Intent.EXTRA_TEXT, "电子邮件信息文本"); emailIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("content://path/to/email/attachment"));

// 你也可以通过传递一个 Uris 的 ArrayList 来附加多个项目

# zend-framework - 如何将电子邮件标记为重要？

> ID：587931
> 
> 赞同：3
> 
> 时间：2009-02-25T21:24:47.900
> 
> 标签：zend-framework, email, zend-mail

我正在使用 PHP 和 Zend-Framework 来创建电子邮件。如何将电子邮件标记为重要？Outlook 将显示一个红色的“！” 如果它被标记为正确。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T21:29:33.100

我不熟悉 Zend，但您正在寻找这些标头：

```
X-Priority: 1 
X-MSMail-Priority: High
Importance: High 
```

根据[此页面](http://www.chilkatsoft.com/p/p_471.asp)Outlook 在您发送重要电子邮件时会设置所有这些标题，但我怀疑第一个就足够了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-05-21T14:13:56.240

Zend Framework 的使用方法是：

```
$mail = new Zend_Mail('UTF-8');
$mail->addHeader('X-Priority', '1');
$mail->addHeader('X-MSMail-Priority', 'High');
$mail->addHeader('Importance', 'High');
... 
```

# ruby - 以编程方式在 Qt (Ruby) 中移动 ListView

> ID：587941
> 
> 赞同：1
> 
> 时间：2009-02-25T21:27:52.137
> 
> 标签：ruby, qt, listview, qt4

我正在制作一个供我自己使用的小型文件浏览器，在 Ruby 中，并使用 Qt 作为视图。这个想法是它最终会出现在我的电视上，在那里我可以使用遥控器上下移动并启动文件。

一切正常，直到我要使用遥控器移动选择。我设法建立了一个 D-Bus 服务，所以我将使用 LIRC 调用这些方法。

我用于设置视图的代码如下所示：

```
@dm = Qt::DirModel.new
@sm = Qt::ItemSelectionModel.new(@dm)

@lv = Qt::ListView.new
@lv.model = @dm
@lv.selectionModel = @sm

cwd = @dm.index(@dir)
@lv.rootIndex = cwd 
```

然后我不确定如何更改选择。我想我一定已经尝试过 DirModel、ItemSelectionModel 和 ListView 上的每个 setIndex、setSelection 和每个听起来相似的方法，但没有任何运气。我一直在谷歌搜索和阅读 API，但没有找到任何东西。

理想情况下，我会有类似“moveSelectionDown”和“moveSelectionUp”之类的东西来处理它，并确保它正确环绕。但我似乎找不到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-28T11:02:25.560

设法通过每个视图显然具有的 ItemSelectionModel 修复它。

向上：

```
curIndex = @lv.currentIndex
@lv.selectionModel.setCurrentIndex(curIndex.sibling(curIndex.row-1, 0), Qt::ItemSelectionModel::ClearAndSelect) 
```

或添加一个向下移动

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T21:46:28.627

我认为您忘记了必须通过模型创建 ModelIndex ：

```
@dm.index(3, 0, None) 
```

我会尝试这种方法（虽然我不太确定，但这会取消选择其他单元格。）

```
@lv.setCurrentIndex(@dm.index(3, 0, None)) 
```

我已经很久没有使用 Ruby 了，所以我不确定是否有`None`.

# javascript - 在 jquery 就绪函数中声明函数的最佳实践

> ID：587954
> 
> 赞同：32
> 
> 时间：2009-02-25T21:29:55.033
> 
> 标签：javascript, jquery

我还没有找到一个很好的参考来在里面声明我自己的函数

```
jquery.ready(function(){}); 
```

我想声明它们，以便它们在准备好的闭包的同一范围内。我不想弄乱全局 js 命名空间，所以我不希望它们在 ready 闭包之外声明，因为它们只针对内部的代码。

那么如何声明这样一个函数......我不是指一个自定义的jquery扩展方法/函数......只是一个普通的'ol函数，它做一些微不足道的事情，比如：

```
function multiple( a, b ){ 
    return a * b; 
} 
```

我想遵循 jquery 推荐和函数声明语法。我可以通过声明一个像上面的乘法这样的函数来让它工作......但由于某种原因它对我来说看起来不正确，所以我想我只需要一些指导。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-02-25T21:36:33.410

我相信您只需在 ready() 闭包中声明该函数就可以了，但在这里您可以更明确地了解本地范围：

```
jQuery.ready(function() {

     var myFunc = function() {

           // do some stuff here

     };

     myFunc();

}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-25T21:36:11.740

听起来可能很简单，但您只需……声明函数。Javascript 允许函数具有内部函数。

```
$(document).ready( function() {
   alert("hello! document is ready!");

   function multiply(a, b) {
       return a * b;
   }

   alert("3 times 5 is " + multiply(3, 5));
}); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-25T22:04:11.300

我有一个 StartUp 功能，我用它来打印如下：

```
function StartUp(runnable)
{
    $(document).ready(runnable.run);
}

var ExternalLinks =
{
    run: function()
    {
        $('a[rel="external"]').bind('click', ExternalLinks.click);
    },
    click: function(event)
    {
        open(this.href);
        return false;
    }
}
StartUp(ExternalLinks);

var ConfirmLinks =
{
    run: function()
    {
        $('a.confirm').bind('click', ConfirmLinks.click);
    },
    click: function(event)
    {
        if (!confirm(this.title)) {
            return false;
        }
    }
}
StartUp(ConfirmLinks); 
```

我的网站是模块化的，所以每个模块都有 N 个动作，每个动作都可以有一个 .js 文件，所以我只写函数并用 StartUp(...functionName...) 调用它

# .net - 是否可以确定程序集是否已加载到 Web 服务中？

> ID：587956
> 
> 赞同：0
> 
> 时间：2009-02-25T21:30:25.560
> 
> 标签：.net, web-services

在 .Net Web 服务中是否可以确定程序集是否加载到 Web 服务中？如果是，如何进行这样的检查？从这样的检查中是否可以确定组件的原始位置？

这是一个很长的故事，涉及在服务器上的应用程序的多个入口点之间共享程序集，其中一些通过 Web 服务公开，另一些通过托管在普通 Windows 服务内的更传统的 TCP 套接字公开。也可能有其他 Windows 服务使用相同的共享程序集运行。每个的配置需求略有不同，像 System.Windows.Forms.Application.ExecutablePath 这样的调用会产生不同的结果，具体取决于“托管”程序集的内容。我需要能够可靠地计算程序集的位置来计算配置文件的位置。

Web.config / app.config 在这种情况下不是选项。

可以将一个条目放入注册表中，该条目可用于确定应用程序和所有程序集的位置。但这并不像让应用程序自己计算位置那样可取。

编辑：

让我们可以从 MyApp.asmx（Web 服务）和 MyService.exe（Windows 服务）调用 foo.dll。无论如何确定 MyApp.asmx 是否是从代码隐藏（MyApp.dll）加载 foo.dll 的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T21:34:54.130

这会将所有程序集加载到当前执行上下文中：

```
Assembly[] loadedAssemblies = AppDomain.CurrentDomain.GetAssemblies(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T02:24:32.220

如果您拥有该代码，最好添加某种可以通过调用代码来*告诉*程序集它在哪里运行的初始化方法或属性。事实上，您可以添加一个静态属性，即配置文件的位置。

这也会在其他场景中为您提供帮助，例如在测试期间，您可能希望明确指定应该使用哪个配置文件，而不是嵌入逻辑来猜测要使用哪个配置文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T18:05:08.143

在研究 Web 服务的另一个方面时，我偶然发现了这一点：

```
string path = Context.Request.ServerVariables["APPL_PHYSICAL_PATH"]; 
```

这将返回类似“C:\inetpub\wwwroot\MyWebApp\”的内容，指示是否安装了应用程序。具体路径取决于应用程序的安装位置。

如问题中所述，这不会直接帮助 foo.dll 确定它是否是从 Web 服务调用的，因为 foo.dll 通常无法访问 Context.Request。通过对 foo.dll 进行一些更改，它将允许 Web 服务告诉 foo.dll 应用程序根目录是什么。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-25T21:36:57.043

您可以拨打以下电话：

```
Assembly.GetExecutingAssembly().CodeBase 
```

在您的代码中，这将告诉您当前正在执行的程序集在哪里。

# delphi - Delphi 5：如何暂停锚布局？

> ID：587957
> 
> 赞同：4
> 
> 时间：2009-02-25T21:30:35.060
> 
> 标签：delphi, layout, user-interface, fonts

有没有办法暂停窗体上的所有锚定控件暂时移动或调整自身大小？IE：

```
procedure ScaleFormBy(AForm: TForm; n, d: Integer);
begin
    AForm.SuspendAnchors();
    try
       AForm.ScaleBy(n, d);
    finally
       AForm.ResumeAnchors();
    end;
end; 
```

我需要这样做，因为我在打电话

```
AForm.ScaleBy(m, d); 
```

哪个不能正确处理锚定控件。（它将左+右或上+下锚定控件推离表单边缘。

**注意：**我想禁用锚点，而不是对齐。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T23:29:51.267

SuspendAnchors 听起来像一个基本方法，但我不认为它是基本 Delphi 语言的一部分 :) 下面是一些可以解决问题的代码：

* * *

```
var aAnchorStorage: Array of TAnchors;
procedure AnchorsDisable(AForm: TForm);
var
  iCounter: integer;
begin
  SetLength(aAnchorStorage, AForm.ControlCount);
  for iCounter := 0 to AForm.ControlCount - 1 do begin
    aAnchorStorage[iCounter] := AForm.Controls[iCounter].Anchors;
    AForm.Controls[iCounter].Anchors := [];
  end;
end;

procedure AnchorsEnable(AForm: TForm);
var
  iCounter: integer;
begin
  SetLength(aAnchorStorage, AForm.ControlCount);
  for iCounter := 0 to AForm.ControlCount - 1 do
    AForm.Controls[iCounter].Anchors := aAnchorStorage[iCounter];
end;

procedure TForm1.btnAnchorsDisableClick(Sender: TObject);
begin
  AnchorsDisable(Self);
end;

procedure TForm1.btnAnchorsEnableClick(Sender: TObject);
begin
  AnchorsEnable(Self);
end; 
```

* * *

享受

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T19:44:05.700

Guy 有一个好主意，但它没有处理子控件（即 TPanel、TPageControl 等）

这是一个使用递归的变体。另外，请注意，我实际上并没有禁用锚点 - 结果表明 ScaleBy 在没有锚点的情况下也不起作用。

所以现在您可以使用以下方法缩放表单：

```
procedure ScaleFormBy(AForm: TForm; M, D: Integer);
var
   StoredAnchors: TAnchorsArray;
begin
   StoredAnchors := DisableAnchors(AForm);
   try
       AForm.ScaleBy(M, D);
   finally
       EnableAnchors(AForm, StoredAnchors);
   end;
end; 
```

使用支持库函数：

```
TAnchorsArray = array of TAnchors;

function DisableAnchors(ParentControl: TWinControl): TAnchorsArray;
var
   StartingIndex: Integer;
begin
   StartingIndex := 0;
   DisableAnchors_Core(ParentControl, Result, StartingIndex);
end;

procedure EnableAnchors(ParentControl: TWinControl; aAnchorStorage: TAnchorsArray);
var
   StartingIndex: Integer;
begin
   StartingIndex := 0;
   EnableAnchors_Core(ParentControl, aAnchorStorage, StartingIndex);
end;

procedure DisableAnchors_Core(ParentControl: TWinControl; var aAnchorStorage: TAnchorsArray; var StartingIndex: Integer);
var
   iCounter: integer;
   ChildControl: TControl;
begin
   if (StartingIndex+ParentControl.ControlCount+1) > (Length(aAnchorStorage)) then
      SetLength(aAnchorStorage, StartingIndex+ParentControl.ControlCount+1);

   for iCounter := 0 to ParentControl.ControlCount - 1 do
   begin
      ChildControl := ParentControl.Controls[iCounter];
      aAnchorStorage[StartingIndex] := ChildControl.Anchors;

      if ([akLeft, akRight ] * ChildControl.Anchors) = [akLeft, akRight] then
         ChildControl.Anchors := ChildControl.Anchors - [akRight];

      if ([akTop, akBottom] * ChildControl.Anchors) = [akTop, akBottom] then
         ChildControl.Anchors := ChildControl.Anchors - [akBottom];

      Inc(StartingIndex);
   end;

   //Add children
   for iCounter := 0 to ParentControl.ControlCount - 1 do
   begin
      ChildControl := ParentControl.Controls[iCounter];
      if ChildControl is TWinControl then
         DisableAnchors_Core(TWinControl(ChildControl), aAnchorStorage, StartingIndex);
   end;
end;

procedure EnableAnchors_Core(ParentControl: TWinControl; aAnchorStorage: TAnchorsArray; var StartingIndex: Integer);
var
   iCounter: integer;
   ChildControl: TControl;
begin
   for iCounter := 0 to ParentControl.ControlCount - 1 do
   begin
      ChildControl := ParentControl.Controls[iCounter];
      ChildControl.Anchors := aAnchorStorage[StartingIndex];

      Inc(StartingIndex);
   end;

   //Restore children
   for iCounter := 0 to ParentControl.ControlCount - 1 do
   begin
      ChildControl := ParentControl.Controls[iCounter];
      if ChildControl is TWinControl then
         EnableAnchors_Core(TWinControl(ChildControl), aAnchorStorage, StartingIndex);
   end;
end;

end; 
```

# asp.net - ASP.NET、Visual Studio、C# 和 Javascript

> ID：587958
> 
> 赞同：0
> 
> 时间：2009-02-25T21:30:49.227
> 
> 标签：asp.net, javascript, visual-studio

我有一个基于母版页的简单 ASPX 页面。在 ASPX 页面上，我有两个下拉菜单和一个按钮。按下按钮时，我想执行一些javascript。为此，我使用了 Button 的属性集合（Add("onclick", script)）。

我的脚本如下所示：

```
string script = "return confirm ('You have selected' + document.getelementbyid(DropDownList1).value + document.getelementbyid(DropDownList2).value)");

Button1.Attributes.Add("onclick", script); 
```

下拉框元素名称是正确的，但为什么 javascript 不触发？当我单击事件时，按钮的单击事件（显然）被触发，但没有任何反应。

这是在 C# 中完成的。如果我使用 ASPX 并在 ASPX 标记中编写一个基本的 javascript 函数，智能感知甚至没有为 documentgetelementbyid 提供值属性。为什么？我的浏览器完全启用了 js（Firefox），因为我之前也有这个功能，但是当我添加母版页并基于我的 ASPX 页面时，一切都变成了梨形。

为什么上面的脚本不起作用？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T21:40:13.353

您尝试添加客户端 ID

```
string script = "javascript:return confirm ('You have selected' + document.getelementbyid('"+DropDownList1.ClientID+"').value + document.getElementByid('"+DropDownList2.ClienID+"').value)"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T21:40:46.970

我不完全确定您的环境，但您可能想看看您的 ASP 页面生成的源代码。母版页添加一个前缀来控制名称“破坏”getElementById 调用。查看以下内容：[http](http://west-wind.com/weblog/posts/4605.aspx) ://west-wind.com/weblog/posts/4605.aspx看看是否可以解决您的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T21:36:52.190

区分大小写：document.getElementById？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T21:36:55.653

DropDownList1 和 DropDownList2 不应该用引号引起来吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T21:38:07.167

当某些 JavaScript 代码似乎不起作用时，可能是因为语法无效。

为了防止这种情况，您可以：

*   验证您当前的声明（我认为下拉列表的 id 可能应该用单引号括起来）。
*   首先尝试一个简单的警报，看看它是否有效 - alert('Hello world'); --

如果没有，请尝试使用按钮的 OnClientClick 属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T21:39:28.847

您还应该在属性中包含“javascript”：

string script = "javascript:confirm ('你已选择' + document.getElementById(DropDownList1).value + document.getElementById(DropDownList2).value)");

Button1.Attributes.Add("onclick", script);

# sockets - TIME-WAIT暗杀和SO_REUSEADDR有什么区别

> ID：587961
> 
> 赞同：1
> 
> 时间：2009-02-25T21:31:06.603
> 
> 标签：sockets, time-wait

我正在阅读有关使用 SO_LINGER 套接字选项通过将逗留时间设置为零来故意“暗杀”时间等待状态的信息。这本书的作者接着说我们永远不应该这样做，而且一般来说我们永远不应该干预时间等待状态。然后他立即建议使用 SO_REUSEADDR 选项绕过时间等待状态。

我的问题是，有什么区别？在这两种情况下，您都过早地终止了时间等待状态并冒着接收重复段的风险。为什么一个好一个坏？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T21:45:27.490

TIME_WAIT 是绝对正常的。它发生在本地端的 TCP FIN 后跟来自远程位置的 TCP FIN ACK 之后。在 TIME_WAIT 中，您只是在等待任何杂散数据包到达本地地址。但是，如果有一个丢失或杂散的数据包，则 TIME_WAIT 确保 TTL 或“生存时间”在再次使用该地址之前到期。

如果您使用 SO_REUSEADDR 那么您基本上是在说，我会假设没有杂散数据包。现代、可靠的 TCP 网络越来越有可能发生这种情况。虽然仍有可能，但不太可能。

将 SO_LINGER 设置为零会导致您启动异常关闭，也称为“猛烈关闭连接”。在这里，您不尊重 TIME_WAIT 并忽略流浪数据包的可能性。

如果您看到 FIN_WAIT_1，那么这可能会导致问题，因为远程位置没有发送 TCP FIN ACK 来响应您的 FIN。因此，进程要么被杀死，要么 TCP FIN ACK 由于网络分区或路由错误而丢失。

当您看到 CLOSE_WAIT 时，您遇到了问题，这里您正在泄漏连接，因为在给定 TCP FIN 时您没有发送 TCP FIN ACK。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-28T21:26:00.447

我做了更多阅读，这是我对发生的事情的理解（希望是正确的）：

当您在设置了 SO_REUSEADDR 的套接字上调用 close （或您的应用程序崩溃）时，会发生以下序列：

1.  TCP 发送发送缓冲区中的任何剩余数据和一个 FIN
2.  如果 close 被调用，它会立即返回，如果任何剩余的数据已成功传递，则不会指示。
3.  如果发送了数据，则对等方发送数据 ACK
4.  对端发送 FIN 的 ACK 并发送自己的 FIN 包
5.  对等方的 FIN 被确认并释放套接字资源。
6.  套接字没有进入 TIME-WAIT。

当您关闭 SO_LINGER 时间设置为零的套接字时：

1.  TCP 丢弃发送缓冲区中的所有数据
2.  TCP 向对端发送 RST 数据包
3.  套接字资源被释放。
4.  套接字没有进入 TIME-WAIT

因此，除了将 linger 设置为零是一种黑客和不良风格之外，它也是一种不礼貌的做法，因为它不会完全关闭连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-08T17:35:44.797

我已经使用 SO_REUSEADDR 到通配符 bind() 到某个其他程序已经打开连接的本地端口。事实证明，只要没有两个套接字同时尝试在同一个地址/端口组合上侦听（），这种特殊用途就不会导致问题。

# sql - 什么是“失控查询”？

> ID：587965
> 
> 赞同：7
> 
> 时间：2009-02-25T21:32:35.180
> 
> 标签：sql, terminology, definition

在 SQL 的上下文中，***失控查询***是什么意思？

这是否意味着任何查询在花费太长时间时都会疯狂运行？或者这是否意味着由于触发器而产生一些副作用？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T21:35:05.380

失控查询是执行时间比优化器估计的执行时间长的查询。失控查询可能导致在执行期间耗尽所有处理器周期或其他资源。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T21:35:23.397

这是一个开始运行并且永远不会返回的查询（对于“从不”的某些值）。

通常这意味着查询没有使用它应该使用的索引，或者使用了错误的连接方法，或者错误的连接顺序，或者进行了一堆字符串转换/比较。

可以编写需要数周/数年才能执行的 SQL 查询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T21:37:06.980

我将此术语专门应用于通常意外触发具有意外复杂性的运行时行为的查询。如果您希望查询采用 O(n * m)（即两个表之间的单个连接）并且它需要 O(n * n * m)，那么我会称之为失控，即使 n * n * m 是在本案中可以接受的小。更常见的情况是，查询预计需要 O(log(n) * log(m)) 需要 O(n * n * m * m)，结果证明是不可接受的复杂。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T21:38:36.027

失控查询具有许多特征 - 从以下选项中选择一些：

*   他们产生巨大的结果集
*   他们锁了很多桌子
*   它们导致事务日志中有大量条目
*   它们消耗大量的 I/O 和 CPU 资源

在所有情况下，它们都倾向于阻止其他用户做任何有用的工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T21:34:06.770

我相信这意味着你执行并且永远不会返回。例如，执行一个永远不会返回结果的 select 语句（或者需要很长时间才能这样做）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T21:36:32.910

当查询连接的行数超过了所需的数量时。

来自[Wikipedia](http://en.wikipedia.org/wiki/SQL)：该语言使得进行笛卡尔连接（连接所有可能的组合）变得太容易了，当 WHERE 子句输入错误时，这会导致“失控”结果集。笛卡尔连接在实践中很少使用，因此可能需要明确的笛卡尔关键字。SQL 1992 引入了 CROSS JOIN 关键字，该关键字允许用户明确表示要进行笛卡尔连接，但不带谓词的速记“逗号连接”仍然是可接受的语法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-25T21:38:41.127

失控查询通常是需要很长时间和/或大量系统资源（CPU、内存等）才能完成的查询。

常见的原因可能是：

*   未能使用索引列
*   未能正确连接表（因此您至少得到一个交叉产品）
*   已使用索引列的错误表统计信息
*   许多字符串比较或操作

一个“失控”的查询最终可能会回来，它只需要太长或太多的系统资源才值得。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T21:52:22.887

只是提到如果涉及编写不佳的触发器，可能会发生失控查询。触发器必须能够处理多记录插入/更新或删除，并且已知有些人通过使用游标而不是通过使用基于集合的语言来做到这一点。这可能会导致更新大量记录的查询失控。最近能够通过替换一个这样的触发器将大量正在更新的记录的查询时间从 40 多分钟减少到 40 秒。

其他原因包括意外的交叉连接（用 distinct 修复）、不可分割的 where 子句、使用子查询或使用定义的函数、不正确的索引、尚未更新的统计信息、使用游标、连接或 where 中的定义不足。不断地。

# asp.net - 鬼删除了我的文件？

> ID：587968
> 
> 赞同：1
> 
> 时间：2009-02-25T21:33:25.243
> 
> 标签：asp.net, iis

我在这里遇到了一个非常奇怪的情况，我得出了一个非常奇怪的结论，这让我认为我完全错了，我已经用 hcl 或其他东西治愈了划痕！

无论如何，两天前我发现我工作的网络应用程序上某个目录中的所有页面都停止工作了；

当我尝试调试时，iis 在我面前喊出一个异常，异常有点奇怪（对我来说非常模棱两可），它说

> “类型 Global 在此处未引用的程序集中声明”

并且光标指向生成的 asp.net 临时文件中的一行代码，所以我检查了我的 bin 目录并将实时版本（损坏的版本）与我自己的本地版本（工作版本）进行比较，发现了几个实时版本中缺少 dll

我将这些 dll 从本地复制到现场，一切顺利！

问题是，文件首先去了哪里，如果临时 asp.net 文件损坏了，是否有任何方法可以修复它们而无需重新安装框架或重建应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T21:44:07.400

每当您的 web asp.net 应用程序必须编译时，都会创建临时 ASP.Net 文件。（如果你搜索这个网站或谷歌，你会发现很多关于它是如何工作的描述和信息。）只要原始文件可以重新编译，它们就可以随时被安全地删除。无需重新安装 .NET 框架。

我怀疑有人能告诉你他们去了哪里。您最好的选择是对文件进行一些审核并将删除记录到事件日志中。

它有可能...

*   有权访问服务器的其他人意外或故意删除了文件。
*   你不小心删除了它们
*   你被黑了
*   您的文件被视为病毒并被防病毒软件隔离。

可能还有其他一些我想不出来的原因......

# delphi - 将表单和框架添加到包中

> ID：587979
> 
> 赞同：2
> 
> 时间：2009-02-25T21:35:25.503
> 
> 标签：delphi, ide, packages, custom-component

我正在开发一个 IDE 注册组件包，其中大部分是从 TFrame 基类派生的。包中还包含由这些组件调用的各种自定义对话框表单。我在德尔福 2007 年工作。

我注意到有时通常具有关联 DFM 文件的框架和表单单元并不总是在它们下方显示 DFM 文件“下方”（可通过​​小 [+] 树视图节点扩展器访问）。如果我添加一个现有的基于表单的 PAS 文件，例如，通过右键单击 BPL 项目（在项目管理器中）-> 添加，它不会在列表中显示 DFM 文件。

但是，如果我添加新的并在项目中创建一个新的窗体或框架单元，它会在项目管理器中显示为典型的嵌套两个文件项。如果我将现有表单从项目组中的另一个项目拖到有问题的这个 BPL 项目中，它也会显示这种方式。

似乎这应该是一致的，我更喜欢两个文件显示单位是框架还是表单。

这是否表明项目文件中有问题？我是否错误地将现有表单/框架添加到此包中？如果是这样，我应该如何添加现有的表单/框架单元，以便两个文件都显示在项目管理器列表中？

*** 更新 ***

来自艾伦的以下建议：

我尝试将 {$R *.dfm} 指令添加到表单的单元中，并且在将 DFM 文件添加到我的 BPL 包/项目时它不会强制显示它。将 {$R *.dfm} 添加到项目文件本身（我认为这不是您的意思，但我想我会尝试）也不起作用。这种技术是否只适用于 EXE 项目？

可能（可能）相关，尝试在某些地方使用该指令进行构建给了我这个：

[DCC 错误] E2161 警告：重复资源：类型 10 (RCDATA)，ID TTESTTREEVIEW；文件 E:\Projects\MyApp\Components\TTestTreeViewFrame.dfm 资源保留；文件 E:\Projects\MyApp\Components\TTestTreeViewFrame.dfm 资源被丢弃。

“保留”和“丢弃”同一个文件？？

* * *

后来：看起来这个“重复资源”问题可能与 [此](https://stackoverflow.com/questions/589523/delphi-ide-treating-tframe-as-if-it-were-a-form)有关。不确定，但至少在一种情况下，两者同时发生。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T23:56:28.300

Vegar 走在正确的轨道上。为了让项目经理显示 .dfm 节点，它需要知道一个 form/frame/datamodule 与 pas 文件相关联。它会查看 .dpk 或 .dpr 文件中的 {Form1} 注释以获取此信息。如果在将文件添加到项目时，IDE 无法识别出与之关联的 .dfm，请确保 .pas 文件具有明确的 {$R *.dfm} 指令。这样一来，我不应该被 IFDEF 所掩盖，或者被文件中潜在的语法错误所掩盖。IDE 使用此指令的存在来决定是否应尝试在设计器中打开 .dfm。

IDE 并不仅仅理所当然地认为如果有 Unit1.pas 和 Unit1.dfm，它们确实应该在一起。假设您创建了一个新的表单单元，它被称为 Unit1。现在您只删除了 Unit1.pas，然后创建了一个名为 Unit1.pas 的新单元。这个新的、同名的 Unit1.pas 中没有对磁盘上旧的、陈旧的 Unit1.dfm 的引用。如果 IDE 只是盲目地打开该 .dfm，那将会很奇怪和令人困惑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T23:06:44.770

如果您查看包的项目源代码，您会发现包含部分的不同之处：

```
contains
  Unit2 in 'unit2.pas',
  Unit1 in 'Unit1.pas' {Form1}; 
```

Unit2 将显示为单个单元，而 unit1 将显示为带有表格的单元。如您所见，unit1 有一个 unit2 缺少的 {Form1} 注释。

我不知道是否可以添加现有单元以便自动生成此评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-20T20:38:59.027

寻找其他解决方案的其他人的另一个原因是，当您重命名 pas 文件时，关闭所有文件并重新打开。以前的版本将重新打开并且必须删除以前命名的添加到项目

# flash - 当有例如 PHP/cURL 时，crossdomain.xml 和 clientaccesspolicy.xml 是什么意思？

> ID：587981
> 
> 赞同：7
> 
> 时间：2009-02-25T21:35:54.707
> 
> 标签：flash, silverlight, crossdomain.xml

因此，假设我有一个站点，但上面没有 crossdomain.xml 或 clientaccesspolicy.xml。

这意味着人们无法通过 Silverlight 或 Flash 应用程序访问我的网站。

但他们可以使用，比如 PHP 中的 cURL（或其他语言中的等价物）从我的站点获取信息，并通过 REST 或 WebService 等将其提供给他们的 Silverlight 和 Flash 应用程序。

*   有人可以准确解释这些限制如何保护我的网站，例如跨域脚本吗？

*   他们用 PHP/cURL 和可以通过脚本访问我的网站的等价物无法做到这一点的保护措施是什么*？*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-25T23:18:30.403

PHP 是一种服务器端技术，代码在服务器上执行，而不是在用户的机器上。Silverlight 是一种在用户机器上运行的客户端技术。

如果 Silverlight 代码可以向任何域发出任意 Web 请求，它将为大量跨站点脚本攻击打开大门。

想象这个场景：
Bob 访问 www.OnlineBanking.com 并登录以查看他的帐户余额。他通过导航到另一个地址离开了这个站点。他没有单击“注销”，所以他仍然登录（或者，他打开一个新的浏览器窗口/选项卡，使银行站点仍然打开）。
Bob 浏览到 evil.com，其中包含一个 Silverlight 应用程序。
Silverlight 应用程序已下载并在 Bob 的机器上运行。
此应用程序向 www.OnlineBanking.com/secretaccountdetails.html 发出 Web 请求。此文件需要身份验证才能读取（evil.com 未经过身份验证，因此无法访问）。
鲍勃然而**是**验证通过，请求成功。silverlight 应用程序可以读取此文件的内容并对其进行任何操作（包括将其发送到 evil.com）。

Silverlight 中的跨域请求限制阻止了上述情况的发生。当 silverlight 应用程序向 OnlineBanking.com 发出请求时，它将检查跨域策略文件，因为该应用程序是从不同的域提供的。由于 OnlineBanking.com 没有允许跨域请求的策略文件，因此请求失败并且 Silverlight 应用程序无法下载 secretaccountdetails.html。

# .net - .NET Compact Framework 中的 OCR 图像

> ID：587994
> 
> 赞同：1
> 
> 时间：2009-02-25T21:37:23.390
> 
> 标签：.net, windows-mobile, compact-framework, image-manipulation, ocr

.net compact 框架中是否有任何库或代码示例可以将图像转换为文本？我在手机上看到了一个应用程序，你可以拍一张名片的照片，它会自动填写联系人记录，所以我知道这是可能的，但我想知道怎么做。我搜索了谷歌，似乎找不到任何特定于紧凑框架的东西，有没有人有任何想法？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T21:24:02.720

OCR 是一头棘手的野兽，这就是为什么您可能找不到很多免费、高质量的 OCR 引擎的原因。您手机上的 OCR 应用程序（我猜它是带有 WorldCard Mobile 的 HTC 手机？）可能有一个保护得非常好的 OCR 引擎，或者它通过网络服务将工作外包出去。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-08T18:11:12.500

仅作记录，一种选择可能是将 Tesserac 项目 (http://code.google.com/p/tesseract-ocr) 编译为目标设备的本机 dll，并将此 dll 与 .NetCF 中的 p/Invoke 一起使用.

# c# - DSL/流利的接口有什么意义

> ID：587995
> 
> 赞同：27
> 
> 时间：2009-02-25T21:37:40.363
> 
> 标签：c#, dsl, fluent-interface, api-design

我最近正在观看有关[如何创建流畅的 DSL](http://www.dimecasts.net/Casts/CastFeedDetails/84)的网络广播，我不得不承认，我不明白为什么要使用这种方法（至少对于给定的示例）。

网络广播展示了一个图像大小调整类，它允许您使用以下语法（使用 C#）指定输入图像、调整大小并将其保存到输出文件：

```
Sizer sizer = new Sizer();
sizer.FromImage(inputImage)
     .ToLocation(outputImage)
     .ReduceByPercent(50)
     .OutputImageFormat(ImageFormat.Jpeg)
     .Save(); 
```

我不明白这比采用一些参数的“传统”方法更好：

```
sizer.ResizeImage(inputImage, outputImage, 0.5, ImageFormat.Jpeg); 
```

从可用性的角度来看，这似乎更容易使用，因为它清楚地告诉您方法期望作为输入的内容。相比之下，使用流畅的界面，没有什么能阻止您省略/忘记参数/方法调用，例如：

```
sizer.ToLocation(outputImage).Save(); 
```

那么关于我的问题：

**1 -**有什么方法可以提高流畅界面的可用性（即告诉用户他应该做什么）？

**2 -**这种流畅的接口方法是否只是 C# 中不存在的命名方法参数的替代品？命名参数是否会使流利的接口过时，例如类似的objective-C提供的东西：

```
sizer.Resize(from:input, to:output, resizeBy:0.5, ..) 
```

**3 -**流畅的界面是否仅仅因为它们目前很流行而被过度使用？

**4 -**或者它只是为网络广播选择的一个坏例子？在这种情况下，请告诉我这种方法的优点是什么，在哪里使用它有意义。

顺便说一句：我知道 jquery，并且看到它使事情变得多么容易，所以我不是在寻找关于那个或其他现有示例的评论。

我更多的是寻找一些（一般的）评论来帮助我理解（例如）何时实现一个流畅的接口（而不是一个经典的类库），以及在实现一个时要注意什么。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-25T22:24:13.577

> 2 - 这种流畅的接口方法是否只是 C# 中不存在的命名方法参数的替代品？命名参数是否会使流利的接口过时，例如类似的objective-C提供的东西：

好吧，是的，不是的。流畅的界面为您提供了更大的灵活性。使用命名参数无法实现的是：

```
sizer.FromImage(i)
 .ReduceByPercent(x)
 .Pixalize()
 .ReduceByPercent(x)
 .OutputImageFormat(ImageFormat.Jpeg)
 .ToLocation(o)
 .Save(); 
```

流体界面中的 FromImage、ToLocation 和 OutputImageFormat 对我来说有点味道。相反，我会按照这些思路做一些事情，我认为这要清楚得多。

```
 new Sizer("bob.jpeg") 
 .ReduceByPercent(x)
 .Pixalize()
 .ReduceByPercent(x)
 .Save("file.jpeg",ImageFormat.Jpeg); 
```

Fluent 接口与许多编程技术有相同的问题，它们可能被误用、过度使用或未充分使用。我认为当这种技术被有效地使用时，它可以创建一个更丰富、更简洁的编程模型。甚至 StringBuilder 也支持它。

```
var sb = new StringBuilder(); 
sb.AppendLine("Hello")
 .AppendLine("World"); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-25T22:34:14.877

我会说流利的界面有点过头了，我认为你只选择了一个这样的例子。

当你用它构建一个复杂的模型时，我发现流利的接口特别强大。对于模型，我的意思是例如实例化对象的复杂关系。流利的接口是指导开发人员正确构建语义模型实例的一种方式。这样一个流畅的界面是将模型的机制和关系与用于构建模型的“语法”分开的极好方法，从本质上屏蔽了最终用户的细节，并将可用的动词减少到可能只是那些相关的动词。特定场景。

你的例子似乎有点矫枉过正。

我最近在 Windows Forms 的 SplitterContainer 上做了一些流畅的界面。可以说，控制层次结构的语义模型很难正确构建。通过提供一个小的 fluent API，开发人员现在可以声明式地表达他的 SplitterContainer 应该如何工作。用法就像

```
var s = new SplitBoxSetup();
s.AddVerticalSplit()
 .PanelOne().PlaceControl(()=> new Label())
 .PanelTwo()
 .AddHorizontalSplit()
 .PanelOne().PlaceControl(()=> new Label())
 .PanelTwo().PlaceControl(()=> new Panel());
form.Controls.Add(s.TopControl); 
```

我现在已将控制层次结构的复杂机制简化为与手头问题相关的几个动词。

希望这可以帮助

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-25T21:53:12.760

考虑：

```
sizer.ResizeImage(inputImage, outputImage, 0.5, ImageFormat.Jpeg); 
```

如果您使用不太清晰的变量名称怎么办：

```
sizer.ResizeImage(i, o, x, ImageFormat.Jpeg); 
```

想象一下，您已经打印了这段代码。很难推断这些参数是什么，因为您无权访问方法签名。

使用流畅的界面，这更清楚：

```
 sizer.FromImage(i)
 .ToLocation(o)
 .ReduceByPercent(x)
 .OutputImageFormat(ImageFormat.Jpeg)
 .Save(); 
```

此外，方法的顺序并不重要。这是等价的：

```
 sizer.FromImage(i)
 .ReduceByPercent(x)
 .OutputImageFormat(ImageFormat.Jpeg)
 .ToLocation(o)
 .Save(); 
```

此外，也许您可​​能对输出图像格式和缩减有默认值，所以这可能变成：

```
 sizer.FromImage(i)
 .ToLocation(o)
 .Save(); 
```

这将需要重载的构造函数来实现相同的效果。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T21:52:37.647

这是实现事物的一种方式。

对于除了一遍又一遍地操作同一个项目之外什么都不做的对象，它并没有什么真正的问题。考虑 C++ Streams：它们是这个接口的终极。每个操作都会再次返回流，因此您可以将另一个流操作链接在一起。

如果您正在执行 LINQ，并且一遍又一遍地操作对象，那么这是有道理的。

但是，在您的设计中，您必须小心。如果您想中途偏离，应该采取什么行为？（IE，

```
var obj1 = object.Shrink(0.50); // obj1 is now 50% of obj2
var obj2 = object.Shrink(0.75); // is ojb2 now 75% of ojb1 or is it 75% of the original? 
```

如果 obj2 是原始对象的 75%，那么这意味着您每次都在制作该对象的完整副本（并且在许多情况下都有其优势，例如，如果您尝试制作同一事物的两个实例，但是略有不同）。

如果这些方法只是简单地操纵原始对象，那么这种语法就有些虚伪了。这些是对对象的操作，而不是创建更改对象的操作。

不是所有的类都是这样工作的，做这种设计也没有意义。例如，这种设计风格在硬件驱动程序或 GUI 应用程序的核心设计中几乎没有用处。只要设计只涉及操作一些数据，这种模式就不错。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-01T23:11:25.520

您应该阅读[`Domain Driven Design`](http://domaindrivendesign.org/books/index.html)Eric Evans 的文章，以了解为什么 DSL 被认为是好的设计选择。

这本书充满了很好的例子、最佳实践建议和设计模式。强烈推荐。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-25T18:21:12.350

可以使用 Fluent 接口的变体来强制执行某些可选参数的组合（例如，要求至少存在一组参数，并要求如果指定了某个参数，则必须省略某些其他参数）。例如，可以提供类似于 Enumerable.Range 的功能，但语法类似于 IntRange.From(5).Upto(19) 或 IntRange.From(5).LessThan(10).Stepby(2) 或 IntRange( 3).Count(19).StepBy(17)。过于复杂的参数要求的编译时强制执行可能需要定义数量繁多的中间值结构或类，但这种方法在某些情况下可以证明在更简单的情况下有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-06T14:40:20.720

继[@sam-saffron](https://stackoverflow.com/a/588198/951994)关于在添加新操作时流畅界面的灵活性的建议：

如果我们需要添加一个新的操作，例如 Pixalize()，那么，在“多参数方法”场景中，这将需要在方法签名中添加一个新参数。然后，这可能需要修改整个代码库中此方法的每次调用，以便为这个新参数添加一个值（除非使用的语言允许可选参数）。

因此，Fluent Interface 的一个可能好处是限制未来变化的影响。

# erlang - Erlang 编译器如何处理模式匹配？它输出什么？

> ID：587996
> 
> 赞同：19
> 
> 时间：2009-02-25T21:37:46.153
> 
> 标签：erlang, bytecode, bytecode-manipulation, beam

我刚刚问了一个关于 Erlang 编译器如何实现模式匹配的问题，我得到了一些很好的回应，其中之一是编译后的字节码（通过传递给`c()`指令的参数获得）：

```
{function, match, 1, 2}.
  {label,1}.
    {func_info,{atom,match},{atom,match},1}.
  {label,2}.
    {test,is_tuple,{f,3},[{x,0}]}.
    {test,test_arity,{f,3},[{x,0},2]}.
    {get_tuple_element,{x,0},0,{x,1}}.
    {test,is_eq_exact,{f,3},[{x,1},{atom,a}]}.
    return.
  {label,3}.
    {badmatch,{x,0}} 
```

它只是简单的 Erlang 元组。我期待一些神秘的二进制东西，你猜不是。我在这里一时冲动地问这个问题（我可以查看编译器源代码，但通过额外的洞察力提出问题总是会更好），这个输出是如何在二进制级别翻译的？

比如说`{test,is_tuple,{f,3},[{x,0}]}`。我假设这是一条指令，称为“测试”......无论如何，所以这个输出本质上是字节码级语言的 AST，二进制编码只是 1-1 翻译？

这一切都太令人兴奋了，我不知道我可以这么容易地看到 Erlang 编译器把事情分解成什么。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-25T23:47:04.517

好的，所以我研究了编译器源代码以找到答案，令我惊讶的是，使用 compile:file() 函数的“S”参数生成的 asm 文件实际上是按原样查询的 (file:consult()) 和然后逐一检查元组以进行进一步操作（第 661 行 - beam_consult_asm(St) -> - compile.erl）。然后那里有一个生成的映射表（erlang源的编译文件夹），显示每个字节码标签的序列号是什么，我猜这是用来生成字节码的实际二进制签名。好东西。但是你只需要喜欢consult()函数，你几乎可以有一个随机语言的lispy类型语法，并且完全不需要解析器/词法分析器，只需在编译器中查阅源代码并用它做一些事情......代码作为数据数据作为代码...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-01-08T14:49:43.803

编译器有一个所谓的*模式匹配编译器*，它将采用一个模式并将其编译成本质上是一系列分支、开关等。Erlang 的代码`v3_kernel.erl`在编译器中。它使用 Simon Peyton Jones，“函数式编程语言的实现”，可在线获取

[http://research.microsoft.com/en-us/um/people/simonpj/papers/slpj-book-1987/](http://research.microsoft.com/en-us/um/people/simonpj/papers/slpj-book-1987/)

另一篇有价值的论文是 Peter Sestoft 的论文，

[http://www.itu.dk/~sestoft/papers/match.ps.gz](http://www.itu.dk/~sestoft/papers/match.ps.gz)

它通过检查更简单系统的部分评估来派生模式匹配编译器。它可能更容易阅读，尤其是如果您了解 ML。

基本思想是，如果您有，请说：

```
% 1
f(a, b) ->
% 2
f(a, c) ->
% 3
f(b, b) ->
% 4
f(b, c) -> 
```

假设现在我们有一个电话`f(X, Y)`。说`X = a`。那么只有1和2适用。所以我们检查`Y = b`然后`Y = c`。另一方面，如果`X /= a`我们知道我们可以*跳过*1 和 2 并开始测试 3 和 4。关键是，如果某些内容不*匹配*，它会告诉我们匹配可以在哪里继续以及何时匹配。这是一组我们可以通过测试解决的约束。

模式匹配编译器寻求优化测试的数量，因此在我们得出结论之前尽可能少。静态类型语言在这里有一些优势，因为他们可能知道：

```
-type foo() :: a | b | c. 
```

然后如果我们有

```
-spec f(foo() -> any().
f(a) ->
f(b) ->
f(c) -> 
```

我们不匹配`f(a), f(b)`，那么 f(c)*必须*匹配。Erlang 必须检查，如果不匹配则失败。

# windows - 使我们的应用程序显示在访问和默认值中

> ID：587999
> 
> 赞同：1
> 
> 时间：2009-02-25T21:38:13.157
> 
> 标签：windows, registry, default-programs

我们正在将我们的应用程序开发为默认电子邮件程序，并希望它成为控制面板-> 添加或删除程序-> 访问和默认值-> 自定义-> 选择默认电子邮件中的选项之一程序：区域。这是怎么做到的？

将应用程序添加到 IExplore-> 工具 -> Internet 选项 -> 程序 -> 电子邮件的列表中是一个相当简单的注册表更改：但显然这不是“访问和默认值”区域中显示的列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T22:00:16.050

[这是使用客户端类型注册程序](http://msdn.microsoft.com/en-us/library/cc144109(VS.85).aspx)的 msdn 页面，这是您需要做的。它是几个注册表项，甚至还有[一个邮件客户端示例](http://msdn.microsoft.com/en-us/library/cc144109(VS.85).aspx#sample_mail_program)。**``******