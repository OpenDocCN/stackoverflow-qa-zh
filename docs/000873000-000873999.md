# StackOverflow 问答 000873000-000873999

# ruby-on-rails - 使用 Rails 生成器修改现有文件？

> ID：873008
> 
> 赞同：2
> 
> 时间：2009-05-16T18:33:03.310
> 
> 标签：ruby-on-rails

我正在编写一个生成器，它添加了一些我的服务器将使用的文件。我还想在 environment.rb 文件中添加一行。这可以用生成器完成还是我应该使用应用程序模板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T18:58:28.333

与其修改 environment.rb，不如看看你可以用[Rails 初始化器](http://ryandaigle.com/articles/2007/2/23/what-s-new-in-edge-rails-stop-littering-your-evnrionment-rb-with-custom-initializations)做什么。基本上，您只需在 config/initializers 中创建一个新的 Ruby .rb 文件，并将配置加载代码保存在其中。如果您需要每个环境的配置，最好在 config/ 中创建另一个（通常是 YAML）文件，该文件将存储每个环境的配置变量并将该 YAML 加载到您的初始化程序中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T19:13:02.980

您可以将[初始化程序](http://ryandaigle.com/articles/2007/2/23/what-s-new-in-edge-rails-stop-littering-your-evnrionment-rb-with-custom-initializations)用于自定义初始化代码，但如果您发现使用生成器添加到现有文件是合适的，那么内置生成器是如何做到的：

```
# Excerpted from template_runner.rb

# Make an entry in Rails routing file config/routes.rb 
def route(routing_code)
  log 'route', routing_code
  sentinel = 'ActionController::Routing::Routes.draw do |map|'

  in_root do
    gsub_file 'config/routes.rb', /(#{Regexp.escape(sentinel)})/mi do |match|
      "#{match}\n  #{routing_code}\n"
    end
  end
end 
```

正如你所看到的，它只是弄清楚他们想要代码去哪里（`sentinal`行）并在它之后填充新行。

# java - 动态着色

> ID：873015
> 
> 赞同：0
> 
> 时间：2009-05-16T18:35:45.720
> 
> 标签：java, gwt, colors

有动态更改小部件（背景）颜色的经验吗？afaik 我只能更改 CSS 样式名称，但是随着颜色的计算，我在这里没有机会吗？

我发现了类似的东西， `DOM.setStyleAttribute(mywidget.getElement(), "background", "#FF0000");`但这看起来很讨厌。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T13:15:37.613

这几乎是执行此操作的标准方法。如果您只需要更改背景颜色，您可以创建一个函数来为您执行此操作：

```
public void setBgColor(String color)
{
    setStyleAttribute(this.getElement(), "background", color)
} 
```

或者，如果您希望它与所有小部件一起使用：

```
public void setBgColor(UIObject object, String color)
{
    setStyleAttribute(object.getElement(), "background", color);
} 
```

# php - poedit动态gettext的解决方法

> ID：873017
> 
> 赞同：7
> 
> 时间：2009-05-16T18:36:01.353
> 
> 标签：php, internationalization, gettext, poedit

我已经开始使用 gettext 来翻译我发送给用户的文本和消息。我正在使用 poedit 作为编辑器，但我正在努力处理动态消息。

例如，我有像登录这样的东西，我有一个告诉错误类型的变量。

```
$this->translate('page-error-' . $error); 
```

当我从 poedit 自动更新时，它会被读取为“page-error-”。我所做的是有一个文件，我在其中对 translate 方法进行虚拟调用，其中包含所有可能的键，以便在自动更新时将它们添加到我的 poedit 中。

我不是特别喜欢这种情况。你们是怎么做到的。

谢谢你的想法

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T12:17:36.530

不——这是不可能的，因为编辑器（和`gettext`工具）正在读取您的源代码，而不是执行您的程序。您必须自己保留虚拟调用或将密钥添加到翻译文件中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T11:44:10.947

你在尝试类似的东西

```
$this->translate(sprintf('page-error-%s', $error)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T08:55:51.557

我遇到了同样的问题。

例如我有

在php中

```
//Gives FORM_HEADER_ADD or FORM_HEADER_EDIT
echo $this->translate('FORM_HEADER_' . strtoupper($this->data)); 
```

当我与 poedit 同步时，它会选择“FORM_HEADER_”，这不是我在代码中（生成）的标识符。

所以我必须解决我给 Poedit 完整标识符的问题，我通过在 php 中执行以下操作解决了这个问题

```
echo ($this->data === 'add') ? $this->translate('FORM_HEADER_ADD') : $this->translate('FORM_HEADER_EDIT'); 
```

更新！

我一直在研究这个问题。我目前放弃了从源头导入。这就是我如何继续，直到我找到更好的解决方案

1.  构建应用程序并使用尽可能多的静态标识符。
2.  启用未翻译（动态）标识符的日志记录

    ```
    protected function _initMyTranslate(){

        $date = new Zend_Date();
        $fileName = sprintf('/../logs/translation_%1$s.log', $date->toString('dd-MM'));

        $writer = new Zend_Log_Writer_Stream(APPLICATION_PATH . $fileName);
        $log    = new Zend_Log($writer);

        // get the translate resource from the ini file and fire it up
        $resource = $this->getPluginResource('translate');
        $translate = $resource->getTranslate();

        // add the log to the translate
        $translate->setOptions(
                array(
                    'log'             => $log,
                    'logUntranslated' => true
                )
            );

        // return the translate to get it in the registry and so on
        return $translate;
    } 
    ```

3.  使用 Poedit 与源同步并翻译找到的字符串。

4.  在测试/调试阶段检查未翻译字符串的日志。
5.  将未翻译的字符串添加到 .po 文件中。

    ```
    msgid "IDENTIFIER"
    msgstr "TRANSLATION STRING" 
    ```

6.  打开 po 文件并保存以创建 mo 文件（不要与 SOURCE 同步或全部丢失）。

更新 2。

我现在使用文本编辑器（gedit/notepad）为我的手动标识符使用单独的文件。现在我有两个文件：

1.  由 poedit 自动生成，名为 <language>.po
2.  手动编辑的文件名为 <language>_manual.po

我在 application.ini 中配置了我的翻译以扫描语言目录中的所有文件

```
resources.translate.adapter = gettext
resources.translate.content = APPLICATION_PATH "/../library/languages/"
resources.translate.locale = auto ;use en to force english or nl for dutch..etc
resources.translate.scan = directory
resources.translate.options.disableNotices = false 
```

如果您想在 poedit do file -> new catalog from POT 文件中翻译成另一种语言，然后开始翻译您手动添加的字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-08T14:47:32.567

如果您有有限数量的错误，您可以在`if (false)`条件中添加一些虚拟代码，其唯一目的是让 PoEdit 获取翻译。

例如：

```
if (false) {
  _('role_visitor');
  _('role_hiker_reader');
  _('role_hiker');
  _('role_translator');
  _('role_proofreader');
  _('role_moderator');
  _('role_moderator_2');
  _('role_moderator_3');
  _('role_admin');
} 
```

然后你可以翻译：

```
$translated_role = _('role_' . $role); 
```

致谢：[http ://eng.marksw.com/2012/12/05/how-to-expose-dynamic-translatable-text-to-translation-tools-like-poedit/](http://eng.marksw.com/2012/12/05/how-to-expose-dynamic-translatable-text-to-translation-tools-like-poedit/)

# apache - 在 RewriteCond 文件中使用更改的 %{REQUEST_URI} 存在检查

> ID：873022
> 
> 赞同：9
> 
> 时间：2009-05-16T18:36:47.013
> 
> 标签：apache, .htaccess

我想获取一个 URL，例如[http://localhost/universe/networks/o2/o2_logo.gif](http://localhost/universe/networks/o2/o2_logo.gif)并执行以下操作：

```
如果它以 /universe/ 开头
从中剥离 /universe/ 成为 /networks/o2/o2_logo.gif
检查这是否存在于 %{DOCUMENT_ROOT}/networks/o2/o2_logo.gif
如果是这样，静默地将请求重写到该文件。

```

如果我使用以下规则：

```
RewriteCond %{REQUEST_URI} ^/universe/
重写规则 ^(.*)$ http://www.example.org/$1 [L]

```

[http://localhost/universe/networks/o2/o2_logo.gif](http://localhost/universe/networks/o2/o2_logo.gif)被重写为[http://www.example.org/networks/o2/o2_logo.gif](http://www.example.org/networks/o2/o2_logo.gif)这很棒，但我似乎无法使用

我怎样才能继续使用这个“更改的” %{REQUEST_URI} ，比如 $1 或其他什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-23T10:46:43.787

我无法完全使用 .htaccess 来解决这个问题，但使用了以下文件：

```
RewriteEngine On

# Does the file exist in the content folder?
RewriteCond %{REQUEST_URI} !^/content.*
RewriteCond %{DOCUMENT_ROOT}/universe/%{REQUEST_URI} -f

# File Exists
RewriteRule ^ %{DOCUMENT_ROOT}/universe/%{REQUEST_URI} [L]

# If the request is not a file, link or directory then send to index.php
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L] # Item exists so don't rewrite

# Nothing exists for the request so append a trailing / if needed
RewriteCond %{REQUEST_URI} !/$
RewriteRule ^ %{REQUEST_URI}/ [R=301,L]

RewriteRule ^.*$ index.php [NC,L] # Send off as-is to index.php 
```

然后我进入我的 document_root 文件夹并执行以下操作：

```
cd /var/www/journal
ln -s journal/public universe
cd /var/www/journal/public
ln -s content/ universe 
```

这与 htaccess 相结合意味着一切正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T18:50:11.910

试试这个规则：

```
RewriteCond %{DOCUMENT_ROOT}$1 -f
RewriteRule ^universe/(.*) $1 [L] 
```

# cakephp - cakephp - 会话变量一直表现得很奇怪

> ID：873031
> 
> 赞同：1
> 
> 时间：2009-05-16T18:43:08.590
> 
> 标签：cakephp, session-variables

出于我无法理解的原因，包含客户姓名的会话变量会出现一小会儿，然后消失。

在 app_controller.php 中： beforeFilter()

```
if (isset($_SESSION['customer_name']) == false  || 
    strlen($_SESSION['customer_name']) == 0)
{
  $customer = $this->Customer->read(null, $auth['User']['customer_id']);
  $name = $customer['Customer']['fname'] . " " . $customer['Customer']['lname'];
  $this->Session->write('customer_name', $name);
  $this->set('name', $this->Session->read('customer_name'));
}
else
{
  $this->set('name', $this->Session->read('customer_name'));
} 
```

我尝试过检查会话是否设置的变体，例如

```
if ($this->Session->check('customer_name') == false) 
```

一切都以同样奇怪的方式表现，它会在视图中显示一会儿，然后消失。关闭浏览器或再次登录时不会回来。对该代码的随机小改动似乎可以在短时间内使其恢复活力。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T20:06:30.853

使用[$this->Session->read()](http://book.cakephp.org/view/398/Methods#read-401)而不是直接调用 $_SESSION ，因为 cakephp 可以将会话存储在原生 PHP 所期望的其他地方。

另外，我真的不明白您所说的“消失一会儿”是什么意思，如果您停留在同一页面上并继续点击刷新，它会随机显示/消失吗？

关闭浏览器很可能是您的会话被破坏的原因，您是否在不同的浏览器上也遇到过这种行为？

你`Session.*`在 app/config/core.php 中的 sessings 是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T12:23:04.273

这解决了我们的问题：

`if($this->Session->check('customer_name'))`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T19:11:34.123

不太确定问题出在哪里，但我会从删除 $_SESSION 调用开始。我也会改变

```
strlen($_SESSION['customer_name']) == 0 
```

到

```
empty($_SESSION['customer_name']) 
```

我能想到的唯一另一件事是降低 /config/core.php 中的安全级别，也许你完全失去了会话？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T20:13:03.693

这一行：

```
$name = $customer['Customer']['fname'] . " " . $customer['Customer']['lname']; 
```

允许 $name 等于 " "，这意味着它的 strlen 为 1，并且不为空。不知道为什么它没有获取客户数据，但现在我可以检查该值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T01:53:16.530

通常会话将在蛋糕几分钟后到期。在 config/core.php 文件中查找这一行：

> 配置::write('Session.timeout'

并将其设置为 999999999。这应该可以解决问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-03T23:44:19.807

请注意，有时 FireFox 扩展可能会导致会话重置。任何时候 User-Agent 改变，Session 都会被重置。

我最近使用名为 FirePHP 的 FireBug 扩展遇到了这个问题：
[http ://blog.kevburnsjr.com/cakephp-session-error-user-agent-must-be-consistent](http://blog.kevburnsjr.com/cakephp-session-error-user-agent-must-be-consistent)

# c# - 执行此 LINQ to XML 查询的更好方法？

> ID：873037
> 
> 赞同：1
> 
> 时间：2009-05-16T18:45:55.587
> 
> 标签：c#, .net, linq-to-xml

所以说我有这个 XML 文件：

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<Root>
  <Category Name="Tasties">
    <Category Name="Pasta">
      <Category Name="Chicken">
        <Recipe Name="Chicken and Shrimp Scampi" />
        <Recipe Name="Chicken Fettucini Alfredo" />
      </Category>
      <Category Name="Beef">
        <Recipe Name="Spaghetti and Meatballs" />
        <Recipe Name="Lasagna" />
      </Category>
      <Category Name="Pork">
        <Recipe Name="Lasagna" />
      </Category>
      <Category Name="Seafood">
        <Recipe Name="Chicken and Shrimp Scampi" />
      </Category>
    </Category>
  </Category>
</Root> 
```

我想返回 Tasties\Pasta\Chicken 中所有食谱的名称，我该怎么做？

我目前拥有的是：

```
var q = from chk in
            (from c in doc.Descendants("Category")
             where c.Attribute("Name").Value == "Chicken"
             select c)
        select from r in chk.Descendants("Recipe")
               select r.Attribute("Name").Value;

foreach (var recipes in q)
{
    foreach (var recipe in recipes)
    {
        Console.WriteLine("Recipe name = {0}", recipe);
    }
} 
```

哪种方法有效，尽管它不检查路径，仅适用于名为 Chicken 的第一个类别。我可以递归地挖掘路径中的每个元素，但似乎我可能缺少更好的解决方案。当我`IEnumerable<IEnumerable<String>>`想要的只是一个`IEnumerable<String>`.

基本上我可以让它工作，但它看起来很乱，我想看看任何 LINQ 建议或技术来做更好的查询。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T19:26:19.767

就个人而言，我会使用`XmlDocument`熟悉的`SelectNodes`：

```
foreach(XmlElement el in doc.DocumentElement.SelectNodes(
   "Category[@Name='Tasties']/Category[@Name='Pasta']/Category[@Name='Chicken']/Recipe")) {
    Console.WriteLine(el.GetAttribute("Name"));
} 
```

对于 LINQ-to-XML，我猜（未经测试）类似：

```
var q = from c1 in doc.Root.Elements("Category")
        where c1.Attribute("Name").Value == "Tasties"
        from c2 in c1.Elements("Category")
        where c2.Attribute("Name").Value == "Pasta"
        from c3 in c2.Elements("Category")
        where c3.Attribute("Name").Value == "Chicken"
        from recipe in c3.Elements("Recipe")
        select recipe.Attribute("Name").Value;
foreach (string name in q) {
    Console.WriteLine(name);
} 
```

* * *

编辑：如果您希望类别选择更灵活：

```
 string[] categories = { "Tasties", "Pasta", "Chicken" };
    XDocument doc = XDocument.Parse(xml);
    IEnumerable<XElement> query = doc.Elements();
    foreach (string category in categories) {
        string tmp = category;
        query = query.Elements("Category")
            .Where(c => c.Attribute("Name").Value == tmp);
    }
    foreach (string name in query.Descendants("Recipe")
        .Select(r => r.Attribute("Name").Value)) {
        Console.WriteLine(name);
    } 
```

这现在应该适用于任意数量的级别，选择所选级别或更低级别的所有配方。

* * *

编辑讨论（评论）为什么`Where`有一个局部`tmp`变量：

这可能会有点复杂，但我正在努力解决这个问题；-p

基本上，`foreach`（迭代器左值“捕获”）看起来像：

```
class SomeWrapper {
    public string category;
    public bool AnonMethod(XElement c) {
        return c.Attribute("Name").Value == category;
    }
}
...
SomeWrapper wrapper = new SomeWrapper(); // note only 1 of these
using(var iter = categories.GetEnumerator()) {
    while(iter.MoveNext()) {
        wrapper.category = iter.Current;
        query = query.Elements("Category")
             .Where(wrapper.AnonMethod);
    }
} 
```

这可能并不明显，但由于`Where`没有立即评估，所以`category`（通过 predicate `AnonMethod`）的值直到很久以后才会检查。这是 C# 规范的精确细节造成的不幸结果。引入`tmp`（**范围在**foreach 内）意味着捕获在每次迭代中发生：

```
class SecondWrapper {
    public string tmp;
    public bool AnonMethod(XElement c) {
        return c.Attribute("Name").Value == tmp;
    }
}
...
string category;
using(var iter = categories.GetEnumerator()) {
    while(iter.MoveNext()) {
        category = iter.Current;
        SecondWrapper wrapper = new SecondWrapper(); // note 1 per iteration
        wrapper.tmp = category;
        query = query.Elements("Category")
             .Where(wrapper.AnonMethod);
    }
} 
```

因此，我们现在或以后评估都没有关系。复杂而混乱。您可以看到为什么我赞成更改规范！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T19:42:28.633

这是类似于 Marc 的第二个示例的代码，但它已经过测试和验证。

```
var q = from t in doc.Root.Elements("Category")
        where t.Attribute("Name").Value == "Tasties"
        from p in t.Elements("Category")
        where p.Attribute("Name").Value == "Pasta"
        from c in p.Elements("Category")
        where c.Attribute("Name").Value == "Chicken"
        from r in c.Elements("Recipe")
        select r.Attribute("Name").Value;

foreach (string recipe in q)
{
    Console.WriteLine("Recipe name = {0}", recipe);
} 
```

一般来说，我想说您`select`的 LINQ 查询中只需要一条语句。`IEnumerable<IEnumerable<String>>`由于嵌套的选择语句，您得到了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T20:59:27.733

如果为 System.Xml.XPath[添加 using 语句](http://blogs.msdn.com/xmlteam/archive/2007/03/03/the-new-linq-to-xml-bridge-classes-to-system-xml.aspx)，则会将 XPathSelectElements() 扩展方法添加到 XDocument。如果您对它更满意，这将允许您选择带有 XPath 语句的节点。

否则，您可以使用 SelectMany将您的 IEnumerable `<`IEnumerable`<`字符串展平`>>`为一个 IEnumerable`<`字符串：`>`

```
IEnumerable<IEnumerable<String>> foo = myLinqResults;
IEnumerable<string> bar = foo.SelectMany(x => x); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-05T05:17:57.823

有点晚了，但扩展方法确实可以帮助清理看起来凌乱的 LINQ to XML 查询。对于您的场景，您可以使用如下代码：

```
var query = xml.Root
               .Category("Tasties")
               .Category("Pasta")
               .Category("Chicken")
               .Recipes(); 
```

...使用我在[From LINQ To XPath And Back Again中展示的一些技术](http://odetocode.com/Blogs/scott/archive/2009/06/05/12881.aspx)

# c# - 从 C# 中的字符串末尾删除回车符和换行符

> ID：873043
> 
> 赞同：128
> 
> 时间：2009-05-16T18:50:59.727
> 
> 标签：c#, string, newline, carriage-return

如何从字符串末尾删除回车符`(\r)`和换行符`(\n)`？

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2009-05-16T18:55:18.950

这将从以下结尾删除任何回车符和换行符的组合`s`：

```
s = s.TrimEnd(new char[] { '\r', '\n' }); 
```

**编辑**：或者正如JP好心指出的那样，您可以更简洁地拼写为：

```
s = s.TrimEnd('\r', '\n'); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-05-16T18:57:43.423

这应该工作...

```
var tst = "12345\n\n\r\n\r\r";
var res = tst.TrimEnd( '\r', '\n' ); 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-05-16T19:05:58.957

```
String temp = s.Replace("\r\n","").Trim(); 
```

`s`是原始字符串。（注意大写）

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2013-02-20T06:11:11.987

如果您使用多个平台，则使用此方法会更安全。

```
value.TrimEnd(System.Environment.NewLine.ToCharArray()); 
```

它将考虑不同的换行符和回车符。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-04-22T22:49:04.437

```
s.TrimEnd(); 
```

以上是我从字符串末尾删除 '\r\n' 所需的全部内容。

赞成的答案对我来说似乎是错误的。首先，当我尝试时它不起作用，其次，如果它确实起作用，我希望 s.TrimEnd('\r', '\n') 只会删除'\r'*或*'\n' ，所以我必须在我的字符串上运行两次 - 一次是在 '\n' 结束时，第二次是在 '\r' 结束时（现在 '\n' 已删除） .

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-16T18:57:46.353

如果总是有一个 CRLF，那么：

```
myString = myString.Substring(0, myString.Length - 2); 
```

如果它可能有也可能没有，那么：

```
Regex re = new Regex("\r\n$");
re.Replace(myString, ""); 
```

这两个（按设计）将最多删除一个 CRLF。缓存正则表达式以提高性能。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-10-01T15:28:51.030

对于我们 VBers：

```
TrimEnd(New Char() {ControlChars.Cr, ControlChars.Lf}) 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-03-24T20:17:45.027

```
string k = "This is my\r\nugly string. I want\r\nto change this. Please \r\n help!";
k = System.Text.RegularExpressions.Regex.Replace(k, @"\r\n+", " "); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-01-12T19:11:55.580

这太容易了——对我来说，我正在过滤掉某些电子邮件项目。我正在编写自己的自定义电子邮件垃圾过滤器。在字符串中使用 \r 和/或 \n 时，它会清除所有项目而不是过滤。

所以，我只是做了 filter = filter.Remove('\n') 和 filter = filter.Remove('\r')。我正在制作我的过滤器，以便最终用户可以使用记事本直接编辑文件，因此不知道这些字符可能在哪里嵌入——可能不是在字符串的开头或结尾。因此，将它们全部删除即可。

其他条目都有效，但删除可能是最简单的？

我从这篇文章中学到了更多关于 Regex 的知识——在这里使用它非常酷。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-11-14T22:40:30.233

我使用了很多擦除级别

```
String donen = "lots of stupid whitespaces and new lines and others..."

//Remove multilines
donen = Regex.Replace(donen, @"^\s+$[\r\n]*", "", RegexOptions.Multiline);
//remove multi whitespaces
RegexOptions options = RegexOptions.None;
Regex regex = new Regex("[ ]{2,}", options);
donen = regex.Replace(donen, " ");
//remove tabs
char tab = '\u0009';
donen = donen.Replace(tab.ToString(), "");
//remove endoffile newlines
donen = donen.TrimEnd('\r', '\n');
//to be sure erase new lines again from another perspective
donen.Replace(Environment.NewLine, ""); 
```

现在我们有一个干净的一排

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-06-03T14:52:26.807

这就是我必须为我工作的。

```
s.Replace("\r","").Replace("\n","") 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-10-17T14:57:23.313

```
varName.replace(/[\r\n]/mg, '') 
```

# c# - 如何使用 LINQ 将 long 的枚举转换为单个字符串

> ID：873044
> 
> 赞同：0
> 
> 时间：2009-05-16T18:51:00.787
> 
> 标签：c#, linq, ienumerable

我想知道是否有一种简单而干净的方法（一行）用LINQ将long（IEnumerable）的枚举转换为单个字符串（string）？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T18:57:34.250

如果您希望长（整数？）以逗号分隔，请尝试：

```
string str = string.Join(", ", myLongs.Select(l => l.ToString()).ToArray()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T19:00:20.467

听起来像是聚合/折叠的工作：

```
var longs = new long[] {3, 2, 1, 0};
var str = longs.Aggregate("", (s, l) => s + l);
// str = "3210" 
```

虽然我不太确定问题是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T18:55:34.753

```
String.Join(yourIEnumerable, yourDelimiter) 
```

# visual-studio - Visual Studio 2008 Pro 不打开 DMP 文件。有什么问题？

> ID：873046
> 
> 赞同：2
> 
> 时间：2009-05-16T18:52:42.437
> 
> 标签：visual-studio, visual-studio-2008, debugging, memory-dump

Visual Studio 上的 Microsoft 文档指出，为了打开转储文件，您需要执行“文件 -> 打开 -> 项目”例程。

但是，出于某种原因，在我的情况下，VS 2008 看不到转储文件 - 文件过滤器中没有转储文件 (.dmp; .mdmp) 选项。Dmp 扩展名也与 VS 2008 无关。

有什么问题？

操作系统：Windows 7 64 位 VS 2008 SP1 专业版。转储已在 64 位机器上创建。

PS：我用谷歌搜索了所有网络，但没有找到很多关于这个问题的信息。显然，遇到它的人并不多。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T19:52:02.450

**解决了。**

在为 Visual Studio 2008 安装 C++ 支持后，我能够为 .NET 应用程序打开一个转储文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T18:56:54.297

您可以使用[64 位 NTSD 工具](http://www.microsoft.com/whdc/devtools/debugging/install64bit.mspx#)加载它吗？命令行是：

```
c:\> ntsd /z dumpfile.dmp 
```

如果您无法以这种方式加载它，则它可能以某种方式损坏。

# java - Java 和 Apache Commons Logging 的 Simple Logging Facade 之间的区别

> ID：873051
> 
> 赞同：35
> 
> 时间：2009-05-16T18:56:35.173
> 
> 标签：java, logging, slf4j, apache-commons-logging

[Java 的 Simple Logging Facade](http://www.slf4j.org/)和[Apache Commons Logging](http://commons.apache.org/logging/)有什么区别？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-16T19:04:05.420

从[SLF4J 常见问题解答](http://www.slf4j.org/faq.html)：

> SLF4J 在概念上与 JCL 非常相似。因此，它可以被认为是另一个日志外观。然而，SLF4J 在设计上要简单得多，并且可以说更健壮。简而言之，SLF4J 避免了困扰 JCL 的类加载器问题。

为“JCL 类加载器问题”做一个谷歌以了解更多关于这个......

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-16T19:34:12.553

虽然 SLF4J 可以用作 Log4j 或 JUL 等库的外观，但它也可以用作实现本机日志记录库的 API，就像[Logback](http://logback.qos.ch/)一样。原生 SLF4J 库不需要像 Log4j 或 JUL 的外观那样在中间使用适配器胶水，因此它也应该更高效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-30T08:44:14.413

**Logging Facade|Framework|AbstractionLayer**
（facade-这个词来自法语，字面意思是“正面”或“面子”。）

**定义- Logging Facade**
Logging Facade 是各种日志框架的抽象，例如 java.util.logging、log4j 和 logback，允许最终用户在部署时插入所需的日志框架。

Simple Logging Facade(SLF4J) 是一个类似于 JCL(jakarta-commons-logging) 的抽象日志框架。JCL 也称为 Apache Commons Logging

另请注意，commons-io(apache io -utilities) 与 commons-logging(logging facade) 不同

# asp.net-mvc - ASP.net MVC：这种模式是合理的还是概念上不正确？

> ID：873053
> 
> 赞同：2
> 
> 时间：2009-05-16T18:57:01.613
> 
> 标签：asp.net-mvc, model-view-controller, design-patterns

我的控制器将请求移交给适当的服务。然后服务调用各种存储库。存储库将 Linq to Sql 实体纯粹用于 DataAccess，然后映射并作为域对象返回。服务然后决定控制器将呈现什么并用返回给控制器以在视图中显示的呈现对象替换 DO。

所以我有服务-存储库-域对象-表示对象

我问是因为似乎我有很多对象，有些对象除了传递数据之外什么都不做。这是一个合理的场景还是我没有遵循正确的 MVC 模式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T19:04:41.830

如果您的应用程序足够大，那么您的模式就有意义。否则，我闻到过度工程的味道......

问问自己：如果这一层不存在怎么办，你会发现它是否真实。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T19:07:30.857

是的，你有正确的想法。它可以是很多类和接口（甚至不包括单元测试和模拟/测试类），但如果你有一个相当大的应用程序，那么你无论如何都可以拥有很多。但一开始，需要做很多工作，但最初的收获并不多。

我已经看到项目跳过了一些基本服务的服务实现，这些服务只是通过存储库而没有任何服务增加的价值。他们从控制器直接进入存储库，似乎并没有损失太多。

还有其他方法可以通过在可能的情况下使用工具来减轻某些课程的负担。例如，像[AutoMapper](http://www.codeplex.com/AutoMapper/)这样的项目可以帮助简化您的域对象以查看模型映射。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T19:29:12.300

我有一个非常相似的场景。最初我的项目有 UI、控制器、服务层和存储库。我的单元测试涵盖了服务层和存储库（过滤器），在某些情况下，单元测试做同样的事情（因为服务层有时是到存储库的传递）。

由于进行了大型重构，我删除了服务层，这给了我很大的灵活性，控制器直接处理存储库并应用过滤器来获得我想要的东西。

我遇到的一个问题是您无法序列化 Linq2Sql 对象，因此有时不得不将这些对象转换为表示对象。

# css - 是否可以在 Adob e AIR CSS 中使用 @import？

> ID：873060
> 
> 赞同：1
> 
> 时间：2009-05-16T18:58:44.713
> 
> 标签：css, import, air

尝试使用 @import url('myfile.css'); 在我的 Adob​​e AIR 中的 css 文件中，但它不起作用。

我尝试了诸如 url('file:///myfile.css') 和 url('file:///abs/path/myfile.css') 之类的变体，但似乎都不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T10:01:33.493

它对我有用，简单地说：

```
@import 'myfile.css'; 
```

如果这不起作用（请记住，路径是相对于 CSS 文件或 HTML 文档（如果它在`style`标签中）），请尝试使用`app://`前缀，因为这是项目文档根目录的正确路径。

# javascript - Firefox 3 扩展 JavaScript 加载时重复的事件侦听器

> ID：873071
> 
> 赞同：1
> 
> 时间：2009-05-16T19:04:50.800
> 
> 标签：javascript, firefox

我正在修复为 Firefox 2 编写的扩展以与 Firefox 3一起使用。
其中一项更改是使用：

```
window.getBrowser().addEventListener("load", checkURL, true); 
```

而不是仅仅通过窗口。

唯一的问题是该`load`事件似乎在每次页面加载时发生不止一次。我也尝试过听，`DOMContentLoaded`但结果相似。

有没有办法确保每次页面加载只执行一次脚本？如果重要的话，我正在加载的页面是来自[https://forums.somethingawful.com](https://forums.somethingawful.com)的论坛页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T20:32:13.993

好吧，事实证明，加载事件可以通过加载像 favicon 这样的图像来触发。因此，必须确保目标确实是文档：

```
aEvent.originalTarget.nodeName == "#document" 
```

可以在片段页面上获得更多信息： [https ://developer.mozilla.org/En/Code_snippets/On_page_load](https://developer.mozilla.org/En/Code_snippets/On_page_load)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T19:22:09.103

尝试：

```
window.getBrowser().addProgressListener(
  checkURL,
  Components.interfaces.nsIWebProgress.NOTIFY_STATE_DOCUMENT
); 
```

并且 checkLink 需要是具有此签名的 onStateChange 函数的对象：

```
onStateChange: function(aProgress, request, stateFlags, status); 
```

查看[nsiWebProgress](https://developer.mozilla.org/en/NsIWebProgress)上的文档。

# c# - 使用 AutoResetEvent 的调用异常

> ID：873073
> 
> 赞同：0
> 
> 时间：2009-05-16T19:06:30.827
> 
> 标签：c#, multithreading, autoresetevent

C# 2005

我正在使用后台工作人员来处理一些登录信息。但是，后台工作人员必须停止并等待 2 个事件发生。一旦这些完成，后台工作人员就可以完成它的工作。它们是调用 AutoResetEvent 的 Set() 方法的回调。

所以我使用 AutoResetEvent 来设置这两个事件何时完成。但是，我似乎收到了这条错误消息：“调用的目标已抛出异常。”

并且内部异常索引超出范围。必须是非负数且小于集合的大小。参数名称：索引”。

当注册成功离开范围时，通常会触发异常。

非常感谢您的任何建议

后台工作人员的代码。

```
// Waiting for 'Account in use' and 'Register success or failure'
AutoResetEvent[] loginWaitEvents = new AutoResetEvent[]
{
        new AutoResetEvent(false), 
        new AutoResetEvent(false)
};

private void bgwProcessLogin_DoWork(object sender, DoWorkEventArgs e)
{
      Console.WriteLine("Wait until event is set or timeout");
      loginWaitEvents[0].WaitOne(3000, true);

      if (this.accountInUseFlag)
      {
                if (this.lblRegistering.InvokeRequired)
                {
                    ///this.lblRegistering.Invoke(new UpdateRegisterLabelDelegate(this.UpdateRegisterLabel), "Account in use");
                }
                else
                {
                    ///this.lblRegistering.Text = "Account in use";
                }
                // Failed attemp
                e.Cancel = true;
                // Reset flag
                //this.accountInUseFlag = false;
                return;
       }
       else
       {
                // Report current progress
                //this.bgwProcessLogin.ReportProgress(7, "Account accepted");
       }

        Console.WriteLine("Just Wait the result of successfull login or not");
        loginWaitEvents[1].WaitOne();
        Console.WriteLine("Results for login registionSuccess: [ " + registerSuccess + " ]");

        if (this.registerSuccess)
        {
                // Report current progress
                //this.bgwProcessLogin.ReportProgress(7, "Register Succesfull");  
                // Reset flag
                //this.registerSuccess = false;
        }
        else
        {
                if (this.lblRegistering.InvokeRequired)
                {
                    //this.lblRegistering.Invoke(new UpdateRegisterLabelDelegate(this.UpdateRegisterLabel), "Failed to register");
                }
                else
                {
                   // this.lblRegistering.Text = "Failed to register";
                }
                // Failed attemp
                e.Cancel = true;               
                return;   
        }
}

// Wait for the callback to set the AutoResetEvent

// Error sometimes happens when the function leaves scope.
private void VaxSIPUserAgentOCX_OnSuccessToRegister(object sender, EventArgs e)
{
        Console.WriteLine("OnSuccessToRegister() [ Registered successfully ]");
        this.registerSuccess = true;
        this.loginWaitEvents[1].Set();
} 

// If the flag is not set, then just time out after 3 seconds for the first LoginWaitEvent.waitOne(3000, true)
 private void VaxSIPUserAgentOCX_OnIncomingDiagnostic(object sender, AxVAXSIPUSERAGENTOCXLib._DVaxSIPUserAgentOCXEvents_OnIncomingDiagnosticEvent e)
{
        string messageSip = e.msgSIP;

        //Indicates that a user is already logged on (Accout in use).
        string sipErrorCode = "600 User Found"; 
        if (messageSip.Contains(sipErrorCode))
        {
            // Set flag for account in use
            this.accountInUseFlag = true;
            Console.WriteLine("OnIncomingDiagnostic() WaitEvent.Set() accountInUseFlag: " + this.accountInUseFlag);
            loginWaitEvents[0].Set();   
        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T22:27:02.997

UpdateRegisterLabel 方法中很可能存在索引错误。

从内部异常中获取堆栈跟踪，它应该更接近地指向它所在的位置。

# asp.net-mvc - 我可以从 url 获取 ASP.MVC 路由吗？

> ID：873076
> 
> 赞同：3
> 
> 时间：2009-05-16T19:10:02.487
> 
> 标签：asp.net-mvc

我在 global.asax 中定义路由，如下所示：

```
routes.MapRoute(
    "Default",
    "{controller}/{action}/{id}",
    new { controller = "Home", action = "Index", id = "" }
); 
```

给定一个网址：

```
/somecontroller/someaction/3 
```

是否可以确定这将映射到哪个路由，并获取相应的路由对象，包括名称、url 模板和默认值？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T19:17:07.947

Phil Haack 有一篇博客文章，其中包含[ASP.NET 路由调试器](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)，可让您调试任何和所有路由。

# c# - 枚举DLL函数？

> ID：873078
> 
> 赞同：2
> 
> 时间：2009-05-16T19:11:52.233
> 
> 标签：c#, dll, function, enums, dllimport

是否可以枚举 DLL 中存在的每个函数？得到它的签名怎么样？我可以在 C# 中执行此操作吗？还是我必须降低水平才能做到这一点？

问候和 tks， 何塞

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T19:13:52.917

如果是 .NET DLL [，RedGate 的 Reflector](http://www.red-gate.com/products/reflector/index.htm)可以列出方法，甚至尝试反汇编代码。对于任何开发人员的工具箱来说，它都是一个很棒的项目，而且它是免费的

**编辑：**如果您尝试在运行时读取类型和方法，您将需要使用反射。您将不得不加载`Assembly`and `GetExportedTypes`。然后，迭代`Members`到`Methods`and `Properties`。这是来自 MSDN 的一篇文章，其中有一个迭代[`MemberInfo`](http://msdn.microsoft.com/en-us/library/system.reflection.memberinfo.aspx)信息的示例。此外，还有一篇 MSDN 杂志文章，[从 .NET 程序集中提取数据](http://msdn.microsoft.com/en-us/magazine/cc164006.aspx)。

最后，这是我为在加载的对象上执行方法而编写的一个小测试方法。

在这个例子中 ClassLibrary1 有一个 Class1 类：

```
public class Class1
{
    public bool WasWorkDone { get; set; }

    public void DoWork()
    {
        WasWorkDone = true;
    }
} 
```

这是测试：

```
[TestMethod]
public void CanExecute_On_LoadedClass1()
{
    // Load Assembly and Types
    var assm = Assembly.LoadFile(@"C:\Lib\ClassLibrary1.dll");
    var types = assm.GetExportedTypes();

    // Get object type informaiton
    var class1 = types.FirstOrDefault(t => t.Name == "Class1");
    Assert.IsNotNull(class1);

    var wasWorkDone = class1.GetProperty("WasWorkDone");
    Assert.IsNotNull(wasWorkDone);

    var doWork = class1.GetMethod("DoWork");
    Assert.IsNotNull(doWork);

    // Create Object
    var class1Instance = Activator.CreateInstance(class1.UnderlyingSystemType);

    // Do Work
    bool wasDoneBeforeInvoking = 
          (bool)wasWorkDone.GetValue(class1Instance, null);
    doWork.Invoke(class1Instance, null);
    bool wasDoneAfterInvoking = 
          (bool)wasWorkDone.GetValue(class1Instance, null);

    // Assert
    Assert.IsFalse(wasDoneBeforeInvoking);
    Assert.IsTrue(wasDoneAfterInvoking);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T19:42:53.533

如果它是托管 dll：使用反射

如果它是非托管的：您需要枚举 DLL 导出表

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T19:20:06.783

您可以使用 Dependency Walker 来查看 dll 中的所有导出，这是 Microsoft 的免费程序：[http ://en.wikipedia.org/wiki/Dependency_walker](http://en.wikipedia.org/wiki/Dependency_walker)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T19:36:56.167

对于常规 win32 DLL，请参阅[Dumpbin 实用程序](http://support.microsoft.com/kb/177429)。它包含在 Visual-C++ 中（包括我相信的免费“快速”版本）。

例子：

```
c:\vc9\bin\dumpbin.exe /exports c:\windows\system32\kernel32.dll 
```

# python - 如何将脚本参数传递给 pdb (Python)？

> ID：873089
> 
> 赞同：22
> 
> 时间：2009-05-16T19:17:41.720
> 
> 标签：python, debugging, arguments, pdb

我有 python 脚本（ala #!/usr/bin/python），我想用 pdb 调试它。如何将参数传递给脚本？

我有一个 python 脚本，想用 pdb 调试它。有没有办法可以将参数传递给脚本？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-16T19:39:12.620

```
python -m pdb myscript.py arg1 arg2 ... 
```

`pdb`这作为脚本调用以调试另一个脚本。您可以在脚本名称之后传递命令行参数。有关更多详细信息，请参阅[pdb 文档页面](http://docs.python.org/library/pdb.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-03-20T08:07:02.227

通常我使用 ipython

```
 -i
    If running code from the command line, become interactive afterwards.
    It is often useful to follow this with `--` to treat remaining flags as
    script arguments.

ipython --pdb -i -- test.py -a 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-06-08T13:15:59.487

`python3 -m pdb myscript.py -a val`如果使用带有标志“a”和值“val”的 argparse

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-29T14:41:07.587

如果像我一样，您更喜欢图形化的[pudb](https://pypi.python.org/pypi/pudb)调试器，您可以通过执行以下操作直接传递脚本的参数：

```
pudb myscript.py arg1 arg2 ... 
```

确实，调用：

```
 python -m pudb myscript.py arg1 arg2 ... 
```

将不起作用将返回以下错误：

```
No module named pudb.__main__; 'pudb' is a package and cannot be directly executed 
```

# c++ - DeleteFile() 或 CopyFile() 会抛出异常吗？

> ID：873090
> 
> 赞同：3
> 
> 时间：2009-05-16T19:18:13.263
> 
> 标签：c++, file

我使用`DeleteFile`and`CopyFile`方法。这些函数是抛出异常还是只是设置`errno`and `lastError`？我需要用`try`and包围这段代码`catch`吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-16T19:19:53.883

如果您指的是 Win32 API 函数，答案是否定的。没有 Win32 函数抛出，因为它是 C API。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T19:33:32.493

正如@jeffamaphone 所说，它们不会抛出异常，因为它们是 C 函数。

对于错误，它们返回 0 并设置一个错误代码，您可以通过`GetLastError()`. 两者都不设置`errno`，因为它们是 Windows API。

# asp.net - 编码实践：如何避免硬编码？

> ID：873098
> 
> 赞同：2
> 
> 时间：2009-05-16T19:22:12.397
> 
> 标签：asp.net, database, webforms

我在数据库中有一个存储4个类别的表，表的结构是ID（GUID），描述。我将类别加载到下拉列表（asp.net webform）中，以允许人们根据他们选择的内容来选择一个类别。然后，我将显示与他们的选择相关的信息并隐藏其他信息。

目前，我根据我在代码中硬编码的 GUID 执行“选择案例”以显示相关信息。有没有更好的方法来做到这一点，而无需在 GUID 中的代码后面使用硬代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T19:26:12.043

`Guid`与/关联的数据是什么`Description`...

您硬编码的数据听起来像是要添加到数据库本身的候选对象。

`Category`如果它是每个/的一条信息`Guid`，那么请考虑扩展您的数据库表以存储该信息。

`Categor`如果它是每个y/的多条信息`Guid`，那么考虑创建一个带有 a 的新表，以及表和表`CategoryID`之间的外键关系`Category``ExtraInfo`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T19:28:55.657

您可以在应用程序启动时查询数据库中的 GUID，并将它们缓存在静态`Dictionary`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T19:29:18.090

您可以将 GUID 存储在您的网络配置中并在运行时加载它。然后，您可以轻松地将该 GUID 替换为另一个无需重新编译的 GUID。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T19:31:31.623

您应该有一个`Categories`表格和一个`Posts`表格（或者任何您将使用类别标记的表格）。在`Posts`表中，您有一列`CategoryID`（假设每个帖子只能属于一个类别），因此您只有一个位置的类别名称（规范化您的数据）。

呈现下拉列表时，您从数据库中选择 GUID:s。没有硬编码，如果您添加另一个类别（或删除一个类别），下拉列表将自动反映可用类别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T19:32:22.387

如果您将下拉列表绑定到类别行或包含类别名称和值的元组，则可以使用该属性`Guid`在代码隐藏中加载。`SelectedValue`然后，您将在下拉列表中设置`DataTextField`和`DataValueField`。

# php - 除以零警告

> ID：873099
> 
> 赞同：0
> 
> 时间：2009-05-16T19:22:54.453
> 
> 标签：php, mysql

我一直在编写一个包含三个字段的搜索表单，给我带来麻烦的是在 sql 中使用“LIKE”子句的那个。

这是代码：

```
 <form method="post" action="<?php $_SERVER['PHP_SELF']?>">
             <p>

             <label for="nome">Nome Empresa:</label>
             <input type="text" name="nome"  id="nome"/>

             <label for="concelho">Concelho:</label>
                <select name="concelho">
                        <option id="" selected="selected" value="">Seleccione o Concelho</option>
                          <option value="1" id="1">Um</option>
                          <option value="2" id="1">Dois</option> 
                 </select>

             <label for="actividade">Actividade:</label>
                <select name="actividade">
                        <option id="" selected="selected" value="">Seleccione a actividade</option>
                          <option value="1" id="1">Actividade Um</option>
                          <option value="2" id="1">Actividade Dois</option>    
                 </select>   
             </p>
             <p>
             <input type="submit" name="pesquisar" value="Pesquisar"/>
             </p>
            </form> 
```

// sql（不是全部）

```
 $nome = mysql_real_escape_string($_POST['nome']);

                // Pesquisa a partir da form
                if (isset($_POST['pesquisar'])) {

                $queryStr = 'SELECT * FROM ';
                if(!empty($nome)){
                    $queryStr .= 'tbl_clientes  WHERE nome LIKE '%'$nome'%'';
                } 
```

为什么它给我这个错误两次？

```
Warning: Division by zero in .. on line ..

Warning: Division by zero in .. on line .. 
```

我不是在做一个部门……是吗？

提前致谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-16T19:25:43.760

是的你是。使用的`%`符号`LIKE`在字符串*之外*，因此被解释为模运算符。删除额外的 ' 符号。

```
$queryStr .= "tbl_clientes WHERE nome LIKE '%$nome%'"; 
```

（这里我混合使用了单引号和双引号来解决问题。Eoin [Campbell 的](https://stackoverflow.com/questions/873099/warning-division-by-zero-in/873110#873110)转义内部单引号的解决方案同样有效。您会经常发现在编程时需要使用（组合）这些技术PHP。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T19:29:01.600

您的错误在于这段 SQL

```
'tbl_clientes  WHERE nome LIKE '%'$nome'%'' 
```

您需要转义字符串中多余的撇号。

我假设这个的 PHP 语法是`\`字符

例如

```
'tbl_clientes  WHERE nome LIKE \'%'$nome'%\'' 
```

# c++ - C++ 类 - 每 N 毫秒递增和递减属性

> ID：873101
> 
> 赞同：1
> 
> 时间：2009-05-16T19:24:12.673
> 
> 标签：c++, visual-studio, timer

这一定是一个简单的问题，但我找不到正确的答案。

我在 VS-C++ 上编码。我有一个具有属性“高度”的自定义类“人”。我想调用类方法 Grow() 来启动一个计时器，该计时器将每 0.5 秒增加一次“高度”属性。

我将有一个停止计时器的 StopGrow() 和一个递减而不是递增的 Shrink()。

我真的需要一点点推动使用哪个计时器以及如何在 Grow() 方法中使用它。知道这一点后，其他方法必须直截了当。

这是我在这里的第一个问题，所以请善待（如果我做错了，请警告我:) 请原谅我的英语，而不是我的母语。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T20:06:45.813

你真的需要每半秒调用一次代码来重新计算一个值吗？对于大多数情况，还有另一种更简单、更快、更有效的方法。

不要暴露高度成员，而是使用诸如 GetHeight() 之类的方法，它会在您需要它的确切时刻计算高度。

您的 Grow() 方法将设置基本高度值和开始时间，仅此而已。然后，当您需要时，您的 GetHeight() 方法将从当前时间中减去开始时间以计算“现在”的高度。

不需要计时器！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T19:32:31.217

由于您使用的是 Windows，因此最简单的解决方案可能是使用 Windows 提供的 GetTickCount() 函数。

C++ 语言中没有一个很好的计时器函数，其精度保证小于一秒。

因此，改为包含`windows.h`标题，然后调用`GetTickCount()`以获取毫秒数。下次调用它时，您只需将两个值相减，如果结果超过 500，则已经过了半秒。

或者，如果您想将线程阻塞半秒，请使用该`Sleep(n)`函数，其中`n`是您希望线程休眠的毫秒数。（在您的情况下为 500）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T19:43:27.930

您可能想看看[`CreateTimerQueue()`](http://msdn.microsoft.com/en-us/library/ms682483(VS.85).aspx)and [`CreateTimerQueueTimer()`](http://msdn.microsoft.com/en-us/library/ms682485(VS.85).aspx)。我从未亲自使用过它们，但它们可能符合要求。

我目前产生了一个负责执行基于计时器的操作的线程。它调用`WaitForSingleObject()`具有 10 毫秒超时的手动重置事件。它以指向方法的指针和调用回调的对象的形式保存回调的内部集合。这一切都隐藏在一个提供*调度程序*接口的单例后面，让调用者调度方法在计时器到期后或定期在间隔内调用对象。看起来我提到的两个函数应该为您提供几乎相同的功能......嗯......可能是时候重新审视调度程序代码......;-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T19:36:06.077

Sleep() 一个正常的定时器事件运行一个 10 毫秒的时钟。
对于 Windows 上的高分辨率计时器事件，请使用 [高分辨率计时器](http://technet.microsoft.com/en-us/sysinternals/bb897569.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T19:39:00.407

根本不是一个简单的问题！你至少有两种可能：

*   创建一个将执行循环的线程：sleep 0.5s，增加高度，sleep 0.5s，增加高度等。
*   反转控制流并将其传递给诸如 Boost::Asio 之类的框架，该框架将在每 0.5 秒内调用您的计时器处理程序。

为了做出正确的决定，您必须考虑整个应用程序。它是否计算某些东西（然后可能是线程）？它是否与用户交互（然后可能是事件驱动的）？每种方法都有一些陷阱：

*   当您使用线程时，您必须处理锁定，这可能很棘手。
*   当你做事件驱动的事情时，你必须编写异步处理程序，这可能很棘手。

# ruby-on-rails - 在 Ruby on Rails 中冻结 gem 有什么好处？

> ID：873102
> 
> 赞同：1
> 
> 时间：2009-05-16T19:24:28.850
> 
> 标签：ruby-on-rails, rubygems, freeze

正如标题所说：Ruby on Rails 中冻结 gem 有什么好处？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T19:29:04.580

当您冻结 gem 时，它会将其复制到应用程序的 /vendor 目录中，并且应用程序将在加载安装在正常 ruby​​gems 路径中的 gem 版本之前加载它。

优点是，这意味着当您将应用程序源代码放在另一台机器上时，您已经可以使用该应用程序的 gem，而无需在机器上单独安装它，并且您还知道您所依赖的 gem 版本是可用的。这种方法的一个缺点是，对于具有需要在安装时编译的 C 组件的 gem，您无法真正做到这一点。

现在有其他机制可以帮助管理您的应用程序所依赖的 gem 的安装，例如[geminstaller](http://geminstaller.rubyforge.org/)，它可用于半自动化地安装您的应用程序所依赖的 gem。

# c# - 编程模块化软件

> ID：873116
> 
> 赞同：0
> 
> 时间：2009-05-16T19:29:40.973
> 
> 标签：c#

我站在一个小问题面前；*我想创建一个模块化软件。*

让我们让它更笼统，而不是针对我的情况。我想要创建的是一个加载 dll 的软件，这些 dll 为软件添加了功能。

将 dll 视为 xvid、divx 或任何其他编解码器，为您最喜欢的视频播放器提供功能。不过，我想要一个更自定义的模块化程序，就我而言，我正在创建一个软件来处理客户、发票和产品，不同的用户可能有不同的需求，因此我需要以某种方式处理这个问题！

但是，重新编译软件并专门将新文件发送给每个不同的用户是“愚蠢的”我宁愿创建一个模块化软件（实际上不知道这是否是正确的术语）。

所以我在想的是我开始创建我的 DLL 应该遵循的模式。

然后我在我的软件中创建了一个模块处理程序，它加载实际的 DLL 并调用其中的方法（这就是模式的用武之地！）。

我想知道的是；我在正确的轨道上吗？

你们能给我一些关于这个问题的指示或例子吗？

这全都在 C# 中，但如果看看它在 Java、Python 或 C++ 中的不同之处当然会很有趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T19:35:31.910

为您的类创建一个通用接口 IMyInterface，其中应包括所有模块之间通用的所有内容。您应该查看[Managed Extensibility Framework](http://www.google.com/search?q=C%23+MEF)我相信您可以从[Codeplex](http://www.codeplex.com/MEF)获得它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T19:46:56.533

你必须有一个目标。您要么需要模块符合某种接口，要么需要应用程序可以处理的东西（例如通过反射找到的具有已知属性的方法）。然后该界面执行已知功能，如发票创建、发票打印等。

或者，您的应用程序必须符合某些接口并使用模块的[钩子](http://en.wikipedia.org/wiki/Hooking)来将自己注入到您的应用程序中。

插件适用于可以轻松分割的东西（媒体编解码器）。Hooks 适用于具有明确定义的事件模型（如 Web 服务器）的东西。您使用哪种取决于您希望客户、发票等的模块化如何工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T19:44:46.570

这是一个[类似的 SO 线程](https://stackoverflow.com/questions/323202/designing-extensible-software-plugin-architecture/861538)。这是一个[依赖注入框架](http://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx)的列表，微软的是[Unity](http://codeplex.com/unity)。此外，您可以查看[Enterprise Library 代码库](http://msdn.microsoft.com/en-us/library/dd203099.aspx)以了解它们如何实现其提供程序架构，例如在[缓存应用程序块](http://msdn.microsoft.com/en-us/library/dd203226.aspx)中，您可以在其中插入自己的缓存提供程序。

# algorithm - 找到具有最大最小权重的路径

> ID：873126
> 
> 赞同：6
> 
> 时间：2009-05-16T19:35:16.407
> 
> 标签：algorithm, graph, graph-theory, path-finding, directed-graph

我正在尝试制定一种算法来找到穿过有向图的路径。这不是一条传统的道路，我找不到任何关于已经完成的类似事情的参考。

我想找到具有最大最小权重的路径。

即如果有两条路径的权重为 10->1->10 和 2->2->2，那么第二条路径被认为比第一条路径更好，因为最小权重 (2) 大于第一条的最小权重 ( 1）。

如果有人能想出办法做到这一点，或者只是向我指出一些参考材料的方向，那将非常有用:)

编辑:: 似乎我忘了提到我正试图从一个特定的顶点到另一个特定的顶点。那里很重要：/

EDIT2:: 正如下面有人指出的那样，我应该强调边缘权重是非负的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-04-06T05:15:25.143

我正在复制[这个](https://stackoverflow.com/questions/18552964/finding-path-with-maximum-minimum-capacity-in-graph/18553217#18553217)答案并添加我的算法正确性证明：

我会使用[Dijkstra 的](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm#Pseudocode)一些变体。我直接从维基百科获取了下面的伪代码，只改变了 5 个小东西：

1.  重命名`dist`为`width`（从第 3 行开始）
2.  将每个初始化`width`为`-infinity`（第 3 行）
3.  将源的宽度初始化为`infinity`（第 8 行）
4.  将完成标准设置为`-infinity`（第 14 行）
5.  修改了更新函数和符号（第 20 + 21 行）

```
1  function Dijkstra(Graph, source):
2      for each vertex v in Graph:                                 // Initializations
3          width[v] := -infinity  ;                                // Unknown width function from 
4                                                                  // source to v
5          previous[v] := undefined ;                              // Previous node in optimal path
6      end for                                                     // from source
7      
8      width[source] := infinity ;                                 // Width from source to source
9      Q := the set of all nodes in Graph ;                        // All nodes in the graph are
10                                                                 // unoptimized – thus are in Q
11      while Q is not empty:                                      // The main loop
12          u := vertex in Q with largest width in width[] ;       // Source node in first case
13          remove u from Q ;
14          if width[u] = -infinity:
15              break ;                                            // all remaining vertices are
16          end if                                                 // inaccessible from source
17          
18          for each neighbor v of u:                              // where v has not yet been 
19                                                                 // removed from Q.
20              alt := max(width[v], min(width[u], width_between(u, v))) ;
21              if alt > width[v]:                                 // Relax (u,v,a)
22                  width[v] := alt ;
23                  previous[v] := u ;
24                  decrease-key v in Q;                           // Reorder v in the Queue
25              end if
26          end for
27      end while
28      return width;
29  endfunction 
```

一些（挥手）解释为什么这样做：你从源头开始。从那里，你对自己拥有无限的能力。现在您检查源的所有邻居。假设边缘并不都具有相同的容量（在您的示例中，例如`(s, a) = 300`）。那么，没有比`b`via更好的到达方式了`(s, b)`，所以你知道 的最佳案例容量`b`。您继续前往已知顶点集的最佳邻居，直到到达所有顶点。

**算法正确性证明：**

在算法中的任何一点，都会有**2 组顶点 A 和 B**。A 中的顶点将是找到正确的最大最小容量路径的顶点。并且集合 B 有我们还没有找到答案的顶点。

**归纳假设**：在任何步骤中，集合 A 中的所有顶点都具有正确的最大最小容量路径值。即，所有先前的迭代都是正确的。

**基本情况的正确性**：当集合 A 仅具有顶点 S 时。那么 S 的值为无穷大，这是正确的。

在当前迭代中，我们设置

> val[W] = max(val[W], min(val[V], width_between(VW)))

**归纳步骤**：假设 W 是集合 B 中 val[W] 最大的顶点。并且 W 从队列中出列并且 W 已被设置为答案 val[W]。

现在，我们需要证明每个其他 SW 路径的宽度 <= val[W]。这总是正确的，因为到达 W 的所有其他方式都将通过集合 B 中的某个其他顶点（称为 X）。

对于集合 B 中的所有其他顶点 X，val[X] <= val[W]

因此到 W 的任何其他路径都将受到 val[X] 的约束，它永远不会大于 val[W]。

因此，当前对 val[W] 的估计是最优的，因此算法计算所有顶点的正确值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T19:57:41.203

您还可以使用“对答案的二进制搜索”范例。也就是说，对权重进行二分搜索，测试每个权重`w`是否可以仅使用权重大于 的边在图中找到路径`w`。

你能找到的最大`w`的（通过二分搜索找到）给出了答案。请注意，您只需要检查路径是否存在，因此只需 O(|E|) 广度优先/深度优先搜索，而不是最短路径。所以`O(|E|*log(max W))`总的来说，它可以与 Dijkstra/Kruskal/Prim 相媲美`O(|E|log |V|)`（我也无法立即看到这些证据）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-16T19:50:53.293

使用[Prim](http://en.wikipedia.org/wiki/Prim_algorithm)或[Kruskal](http://en.wikipedia.org/wiki/Kruskal%27s_algorithm)算法。只需修改它们，以便它们在发现您询问的顶点已连接时停止。

编辑：您要求最大最小值，但您的示例看起来像您想要最小最大值。在最大最小值的情况下，克鲁斯卡尔算法将不起作用。

编辑：这个例子没问题，我的错。只有 Prim 的算法会起作用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-23T18:29:50.977

我不确定 Prim 是否可以在这里工作。举个反例：

```
V = {1, 2, 3, 4}

E = {(1, 2), (2, 3), (1, 4), (4, 2)}

weight function w:
  w((1,2)) = .1, 
  w((2,3)) = .3
  w((1,4)) = .2
  w((4,2)) = .25 
```

如果应用 Prim 求从 1 到 3 的最大最小路径，则从 1 开始将选择`1 --> 2 --> 3`路径，而通过 4 的路径获得最大最小距离。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T20:12:47.673

这可以使用 BFS 风格的算法来解决，但是您需要两种变体：

*   不是将每个节点标记为“已访问”，而是在到达它的路径上用最小权重标记它。

例如，如果 I 和 J 是邻居，I 的值为 w1，它们之间的边的权重为 w2，则 J=min(w1, w2)。

*   如果你到达一个值为 w1 的标记节点，你可能需要重新标记并再次处理它，如果分配一个新值 w2（并且 w2>w1）。这是确保您获得所有最小值中的最大值所必需的。

例如，如果 I 和 J 是邻居，I 的值为 w1，J 的值为 w2，它们之间的边的权重为 w3，那么如果 min(w2, w3) > w1 你必须重新标记 J 并处理它的所有邻居再次。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-16T20:50:13.887

好的，在这里回答我自己的问题只是为了尝试获得一些关于我在此处发布之前制定的暂定解决方案的反馈：

每个节点都存储一个“路径片段”，这是迄今为止到其自身的完整路径。

0) 将当前顶点设置为起始顶点
1) 从该顶点生成所有路径片段并将它们添加到优先级队列
2) 从优先级队列的顶部取出片段，并将当前顶点设置为该路径的结束顶点
3) 如果当前顶点是目标顶点，则返回路径
4) goto 1

我不确定这是否会找到最佳路径，但我认为第三步中的退出条件有点雄心勃勃。我想不出更好的退出条件，因为这个算法不会关闭顶点（一个顶点可以在尽可能多的路径片段中引用）你不能等到所有顶点都关闭（比如 Dijkstra 的 for例子）

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-16T21:48:43.400

你仍然可以使用 Dijkstra 的！

不要使用 +，而是使用 min() 运算符。
此外，您需要确定 heap/priority_queue 的方向，以便最大的东西在上面。

像这样的东西应该可以工作：（我可能错过了一些实现细节）

```
let pq = priority queue of <node, minimum edge>, sorted by min. edge descending
push (start, infinity) on queue
mark start as visited
while !queue.empty:
   current = pq.top()
   pq.pop()
   for all neighbors of current.node:
      if neighbor has not been visited
          pq.decrease_key(neighbor, min(current.weight, edge.weight)) 
```

保证每当您到达一个节点时，您都​​会遵循一条最佳路径（因为您发现所有可能性都按降序排列，并且您永远无法通过添加边来改善您的路径）

时间界限与 Dijkstra 的相同 - O(Vlog(E))。

编辑：哦等等，这基本上就是你发布的内容。哈哈。

# c# - C# 树/集合算法

> ID：873140
> 
> 赞同：2
> 
> 时间：2009-05-16T19:41:31.867
> 
> 标签：c#, algorithm, tree, collections

我需要用一些项目（当然在 parent-child1-child2-...childN 关系中）填充树状 UI 控件，在继续之前，我想确保包含内容的我的集合按如下顺序正确排序：

我的集合（未排序的 ObservableCollection）中的每个对象（在这种情况下是我的 Category 类的实例）都有一个公共属性（ParentCategoryID 作为字符串），它指向另一个“Category”，它将成为我树中的父级。树中的一个节点可以有 0 个或任意数量的子节点。

因此，在填充树时，要显示的每个“类别”对象在集合中已经有其“父类别”（基于 ParentCategoryID）。

在添加树中的元素之前，我应该使用什么算法来确保我的集合以这种方式排序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T23:08:26.610

我不确定这是否是您正在寻找的，但希望它会有所帮助：

```
using System;
using System.Linq;
using System.Collections;
using System.Collections.Generic;
public class Program
{
   public static void Main(string[] args)
   {
      /* Tree Structure

         a
          d
           e   
         b
          f
          i
           j
         c
          g
           h
      */

      var a = new Category("a", null);
      var b = new Category("b", null);
      var c = new Category("c", null);
      var d = new Category("d", "a");
      var e = new Category("e", "d");
      var f = new Category("f", "b");
      var g = new Category("g", "c");
      var h = new Category("h", "g");
      var i = new Category("i", "b");
      var j = new Category("j", "i");
      var k = new Category("k", "z");

      var list = new CategoryCollection { k, j, i, h, g, f, e, d, c, b, a };
      foreach (var category in list.SortForTree())
      {
         Console.WriteLine("Name: {0}; Parent: {1}", category.Name, category.ParentCategoryID);
      }
   }
}

class Category
{
   public string ParentCategoryID { get; set; }
   public string Name { get; set; }
   public Category(string name, string parentCategoryID)
   {
      Name = name;
      ParentCategoryID = parentCategoryID;
   }
}

class CategoryCollection : IEnumerable<Category>
{
   private List<Category> list = new List<Category>();

   public void Add(Category category)
   {
      list.Add(category);
   }

   public IEnumerable<Category> SortForTree()
   {
      var target = new Dictionary<string, Category>();

      SortForTree(list, target);

      return target.Values;
   }

   private void SortForTree(List<Category> source, Dictionary<string, Category> target)
   {
      var temp = new List<Category>();

      foreach (var c in source)
      {
         if (c.ParentCategoryID == null || (target.ContainsKey(c.ParentCategoryID) && !target.ContainsKey(c.Name)))
         {
            target.Add(c.Name, c);
         }
         else
         {
            if (source.Exists(o => o.Name == c.ParentCategoryID))
            {
               temp.Add(c);
            }
         }
      }

      if (temp.Count > 0) SortForTree(temp, target);
   }

   #region IEnumerable<Category> Members

   public IEnumerator<Category> GetEnumerator()
   {
      return list.GetEnumerator();
   }

   #endregion

   #region IEnumerable Members

   IEnumerator IEnumerable.GetEnumerator()
   {
      return list.GetEnumerator();
   }

   #endregion
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T21:32:52.457

也许子节点不应该知道它的父节点，在我看来它应该反之亦然。当每个父节点都持有一个子节点的集合，并且这个集合可以在添加一个新节点后进行排序。也许这可以解决您的问题。

问候。

# asp.net-mvc - Asp.net MVC 弹簧引导程序

> ID：873149
> 
> 赞同：1
> 
> 时间：2009-05-16T19:44:50.877
> 
> 标签：asp.net-mvc, spring.net

我正在尝试使用在 Spring.Net 容器中定义的任务（现在是 RegisterRoutes 和 RegisterControllerFactory）创建一个引导程序。引导程序代码如下：

```
 public static void Run()
    {
        IApplicationContext applicationContext = WebApplicationContext.GetRootContext();
        IDictionary bootstrapperTasks = applicationContext.GetObjectsOfType(typeof(IBootstrapperTask));
        foreach (IBootstrapperTask bootstrapperTask in bootstrapperTasks.Values)
            bootstrapperTask.Execute();
    } 
```

问题是，如果我想在 Application_Start 方法中运行引导程序，则 WebApplicationContext 尚不可用 - 可用的最早阶段是 Init 方法。

但据我所知，Init 方法不是注册路由的好地方（请阅读：[http](http://aspnet.codeplex.com/WorkItem/View.aspx?WorkItemId=3325) ://aspnet.codeplex.com/WorkItem/View.aspx?WorkItemId=3325 ）

有什么解决方法还是我应该手动创建一个引导程序（没有弹簧）？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T23:18:52.797

由于我没有将 Spring IOC 与 MVC 一起使用（使用 Ninject），这可能无济于事，但您可以尝试

```
IApplicationContext ctx = ContextRegistry.GetContext(); 
```

并在 web.config 中注册您的引导程序对象

[http://www.springframework.net/doc-latest/reference/html/objects.html#objects-factory-instantiation](http://www.springframework.net/doc-latest/reference/html/objects.html#objects-factory-instantiation)

# c# - 在不同的程序集中访问私有方法c#

> ID：873150
> 
> 赞同：2
> 
> 时间：2009-05-16T19:45:05.493
> 
> 标签：c#, namespaces, private

这可能是一个愚蠢的问题，因为我可以看到它以这种方式发生的安全原因......

我有一个许可 c# 项目，它有一个类，它有一个生成我的许可证密钥的方法。我已将此方法设为私有，因为我不希望其他人能够出于明显的原因调用我的方法

我想做的下一件事是拥有我的用户界面，它位于另一个 c# 项目中，该项目引用许可 dll 是唯一可以在自身之外访问此方法的其他“事物”，这可能还是我需要将它移动到同一个项目中，以便它全部编译到同一个 dll 并且我可以访问它的成员？

> LicensingProject
> -LicensingClass
> --Private MethodX (GeneratesLicenseKeys)
> 
> LicensingProject.UI
> -LicensingUiClass
> --我希望能够成为唯一能够访问 MethodX 的类

许可证密钥生成器不只是在 UI 中是有原因的，因为许可通过在自身上生成哈希并将其与许可证生成器生成的哈希进行比较来工作。

我不希望全部编译为 dll，因为我的最终用户不需要 UI 代码。

我知道根据常识，一种私有方法就是这样。我难住了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T19:48:24.970

您可以将其设为内部方法，并用于[`InternalsVisibleToAttribute`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)为 LicensingProject.UI 提供对 LicensingProject 的额外访问权限。

Merhdad 关于执法的观点是对的，也是错的。如果你没有[ReflectionPermission](http://msdn.microsoft.com/en-us/library/system.security.permissions.reflectionpermission.aspx)，CLR 会阻止你调用你不应该调用的东西——但如果你使用来自完全受信任的程序集的反射，你可以调用任何东西。你应该假设一个潜在的黑客能够在他自己的机器上运行一个完全受信任的程序集:)

这些都不会阻止某人使用[Reflector](http://www.red-gate.com/products/reflector/)反编译您的代码。换句话说，将其设为私有并不会*真正*为您的许可方案增加大量安全性。如果有人真的付出任何努力来打破它，他们可能能够做到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T19:48:15.343

`public`, `private`, ... 东西只是由编译器强制执行的。您可以使用反射很容易地访问它们（假设代码具有所需的权限，这是一个合理的假设，因为他可以完全控制机器）。不要依赖于假设没有人可以调用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T20:13:49.090

**这确实是一条评论**，以回应 Mehrdad 关于运行时不执行访问检查的观点；在这里，您可以看到 JIT（它发生）执行访问检查 - 不是反射，也不是 C# 编译器。

要修复代码，请`Foo.Bar`公开。有趣的是，它还验证了它`Foo`是可访问的——所以让`Foo`internal 看到更多的烟花：

```
using System;
using System.Reflection;
using System.Reflection.Emit;
static class Program {
    static void Main() {
        MethodInfo bar = typeof(Foo).GetMethod("Bar",
            BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic);
        var method = new DynamicMethod("FooBar", null, new[] {typeof(Foo)});
        var il = method.GetILGenerator();
        il.Emit(OpCodes.Ldarg_0);
        il.EmitCall(OpCodes.Callvirt, bar, null);
        il.Emit(OpCodes.Ret);

        Action<Foo> action = (Action<Foo>) method.CreateDelegate(typeof(Action<Foo>));
        Foo foo = new Foo();
        Console.WriteLine("Created method etc");
        action(foo); // MethodAccessException
    }
}

public class Foo {
    private void Bar() {
        Console.WriteLine("hi");
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-08T07:37:02.513

Foo.Bar 可能保持私有...要修复上面的代码，请在 DynamicMethod 构造函数的末尾添加一个参数：

```
var method = new DynamicMethod("FooBar", null, new[] {typeof(Foo)}, true); 
```

添加 true 以跳过对动态方法的 MSIL 访问的类型和成员的 JIT 可见性检查。

# dependency-injection - 温莎城堡 1.0 RC3 和温莎城堡 2.0 有什么区别？

> ID：873159
> 
> 赞同：2
> 
> 时间：2009-05-16T19:48:43.270
> 
> 标签：dependency-injection, castle-windsor, ioc-container

最近，我一直在阅读大量内容并使用 Castle Windsor 1.0 RC3，并且非常喜欢它提供的功能。最近 2.0 发布了，但在接下来的一段时间里，我几乎被 RC3 卡住了。那么考虑到这一点，这两个版本之间有哪些明显的区别，以及在 2.0 上使用 1.0 RC3 时存在哪些缺陷和各自的解决方法？此外，这些差异/陷阱是否会直接影响与 MonoRail 1.0 RC3 的集成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T22:07:27.820

自 RC3 以来，Windsor 得到了很大改进，您可以在此处查看整个[变更日志](http://svn.castleproject.org:8080/svn/castle/InversionOfControl/trunk/src/Changes.txt)。

我在几个应用程序中将 Windsor 本身从 RC3 升级到 2.0 并没有遇到太多麻烦。

但是在其他一些使用 RC3 的项目中，我还有很多其他 Castle 依赖项（MonoRail、ActiveRecord、ActiveRecord 设施、AutomaticTransactionManagement 设施），所以我必须升级所有这些（尚未发布），而且我必须升级 NHibernate （RC3 使用 NHibernate 1.2，主干使用 NHibernate 2.1，它还没有发布）。我什至使用了现在已经失效的 AspectSharp，所以我必须更换它。有些是相当大的项目，升级所有这些依赖项需要我很多时间，我现在没有时间......

因此，我将等待所有这些依赖项发布，然后升级所有内容。与此同时，RC3 工作得很好......

# c# - 对象处理异常

> ID：873163
> 
> 赞同：1
> 
> 时间：2009-05-16T19:51:42.857
> 
> 标签：c#, objectdisposedexception

好的，伙计们，我的代码中突然出现了这个以前没有出现过的问题。

```
 public void StartUdpListener(Object state)
    {

       /* sock1 = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);

        sock1.Bind(receiveEndPoint);

        EndPoint ep = (EndPoint)receiveEndPoint;*/

       recv = sock1.ReceiveFrom(receivedNotification, ref ep);

       notificationReceived = Encoding.ASCII.GetString(receivedNotification, 0, recv);

       //sock1.Close();

       if (listBox1.InvokeRequired)
       {
           this.Invoke((MethodInvoker)delegate { listBox = new StringBuilder(this.listBox1.Text); });
       }
       listBox.AppendLine(notificationReceived);

       if (listBox1.InvokeRequired)
       {
           pos = listBox1.FindString(notificationReceived);
           if (pos >= 0)
           {
           }
           else
           {
               this.Invoke((MethodInvoker)delegate { this.listBox1.Items.Add(listBox.ToString()); });
           }
       }

    } 
```

我收到一个 ObjectDisposedException 说该行：

```
 this.Invoke((MethodInvoker)delegate { listBox = new StringBuilder(this.listBox1.Text); }); 
```

由于 listBox1 已处置，因此无法执行。这怎么可能，有什么需要做的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-29T11:53:07.283

我做出以下假设：

1.  此代码是 Form (System.Windows.Forms.Form) 中的一个方法。
2.  变量“listBox1”是窗体上的一个 ListBox 控件。
3.  当表单关闭时，您将收到 ObjectDisposedException。
4.  您在单独的线程上运行此方法（代码中未显示，但问题暗示）。

我猜想您的代码在表单关闭时阻塞了套接字上的 receiveFrom() 调用。从网络到达的下一条消息会导致 receiveFrom 返回，之后您将收到的消息放入不再存在的列表框中。第一次访问此列表框是创建 StringBuilder 时的代码行“this.listBox1.Text”，这是引发 ObjectDisposeException 的行。listBox 是可能被释放的对象，尽管此时它也可能是 Form，这取决于消息进入的速度。

似乎有很多事情需要做，但我不确定什么是正确的建议。我将首先验证我上面的假设 1-4，然后考虑重构您的应用程序，使其不使用多个线程。我提出这个建议是因为我必须假设这不是您的应用程序可能遇到的唯一“线程”问题。我在那个假设中肯定是不正确的，在这种情况下你可以忽略答案。

如果我将您问题的“需要做什么”部分限制在更有限的范围内，那么我建议在允许窗口关闭之前正确关闭您的 UDP 接收器，再次假设我的假设是正确的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-21T12:53:03.623

对此块的评论：

```
if (listBox1.InvokeRequired)
{
    this.Invoke((MethodInvoker)delegate { listBox = new
        StringBuilder(this.listBox1.Text); });
}
listBox.AppendLine(notificationReceived); 
```

在您执行 .AppendLine 时，StringBuilder（列表框）可能为空。这是因为您在与使用它的位置不同的线程中创建列表框。此外，仅当此代码在非 UI 线程上运行时（这就是 listBox1.InvokeRequired）正在检查的，才会创建一个新的 StringBuilder 对象。

# java - 线程同步

> ID：873164
> 
> 赞同：0
> 
> 时间：2009-05-16T19:51:47.880
> 
> 标签：java, multithreading

我创建了两个线程，第一个线程调用应用程序，第二个线程用于读取文件，这是在第一个线程上调用应用程序产生的。调用应用程序工作正常，但读取文件不起作用。

这是我的代码：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package reciverwindow;

import java.util.logging.Level;
import java.util.logging.Logger;

/**
 *
 * 
 */
public class NewClass1 implements Runnable {

    public static void main(String[] args) {

        CallMatlab c = new CallMatlab();
        CUI m = new CUI();
        Thread t1 = new Thread(c);
         t1.start();
        Thread t2 = new Thread(m);

        t2.start();
       /* try {
            t2.sleep(3);
        } catch (InterruptedException ex) {
            Logger.getLogger(NewClass1.class.getName()).log(Level.SEVERE, null, ex);
        }
    }*/

   synchronized (t2) {
            try {
                t2.wait(3);
                  t2.notifyAll();
            } catch (InterruptedException ex) {
                Logger.getLogger(NewClass1.class.getName()).log(Level.SEVERE, null, ex);
            }
            }

    }

    public void run() {
        throw new UnsupportedOperationException("Not supported yet.");
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T19:59:02.650

您可能想要发布更多代码，因为您确实不清楚您要做什么以及您的同步要求是什么。

奇怪的是你的 t2.wait(3)。为什么要等三毫秒？也许您的意思是三秒（3000），这仍然有风险，但可能适用于您的情况？

# delphi - TWebModule 中的会话管理

> ID：873170
> 
> 赞同：2
> 
> 时间：2009-05-16T19:55:20.630
> 
> 标签：delphi, apache

我正在使用带有 Apache 的 TWebModule。如果我理解正确，如果所有先前创建的对象都忙于处理请求，Apache 将生成我的 TWebModule 对象的另一个实例。它是否正确？

我创建了自己的 SessionObject 并创建了一个 TStringList 来存储它们。StringList 是在包含 TWebModule 对象的源代码文件底部的初始化部分中创建的。我发现可以多次调用初始化（大概是当 Apache 必须生成另一个进程时）。

有没有办法让我拥有一个全局“会话”TStringlist 来保存我的所有会话对象？或者是将会话信息存储在数据库中并根据每个请求的 cookie 检索它的“安全”、正确的方法？

我想要这样做的原因是减少数据库访问，而是将会话信息保存在内存中。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T02:37:47.873

正如 Stijn 建议的那样，使用单独的存储来保存会话数据确实是最好的方法。更好的是尝试编写您的应用程序，以便 Web 浏览器包含设计中固有的状态。这将大大提高将应用程序扩展到数千或数万并发用户的能力，而硬件却少得多。

Intraweb 是一个很好的选择，但在更大的并发用户（甚至是空闲用户）需要更多硬件支持的意义上存在规模问题。最好从一开始就设计一种让服务器尽可能在内部无状态运行的方法。当然，如果您有固定数量的用户并且不期望任何增长，那么这不是一个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T21:51:55.343

这很奇怪。如果多次调用初始化部分，可能是因为 DLL 是在单独的进程空间中加载的。我能想到的一种选择是在初始化时检查“Sessions”对象是否已经存在。如果 DLL 确实是在单独的进程中加载​​的，这将无济于事，然后我建议编写一个中央 Session 存储进程并在 TWebModule 中使用进程间通信（有几种方法：消息、命名管道、COM. ..)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T23:59:53.633

[应用程序模式下的Intraweb](http://www.atozed.com/IntraWeb)处理会话管理和数据库访问确实非常流畅，并且扩展性很好。 [我之前评论过它](https://stackoverflow.com/questions/268363/is-intraweb-worth-the-money/268470#268470)。虽然这并不能直接回答您提出的问题，但当我遇到同样的问题时，Intraweb 为我解决了这些问题。

# release-management - 有哪些策略可用于管理跨多个子产品和多个版本的更新？

> ID：873174
> 
> 赞同：1
> 
> 时间：2009-05-16T20:03:15.993
> 
> 标签：release-management

我们的产品附带多个扩展，每个扩展都有自己的版本号。（具体来说，我们有一个带有多个扩展的 xulrunner 应用程序）。xulrunner 的扩展管理器提供了更新功能，以便在该扩展的版本号增加时它会调用一个函数。这给了我们一个钩子来对更新进行任何必要的清理。

但是，很难想出一个好的方法来跟踪哪些扩展需要增加版本号，哪些基本保持不变。我们可以想象的最佳过程是 1) 在关闭工单时添加前期工作（每张工单都可以有一系列标志来指定需要修改哪些扩展）
2) 编写查询以搜索自上次以来哪些工单对扩展进行了更改为特定客户发布和 3) 更新整个产品的扩展版本号

在开发和发布时，这一切似乎都很乏味——而且容易出错。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T16:26:37.493

听起来您倾向于使用工作票来识别扩展的更改。我想知道您是否应该反过来看待它并使用您的版本控制系统来确定更改的位置。

您的版本历史记录应该根据实际进行和发布的更改为您提供有关已更改内容的所有见解。它还将提供一定数量的审核，以确保预期的变更范围与已完成的变更范围相匹配。

根据该信息，您可以实施版本更改决策。

# c# - 在文本的鼠标悬停时显示工具提示

> ID：873175
> 
> 赞同：20
> 
> 时间：2009-05-16T20:05:39.937
> 
> 标签：c#, .net, winforms, tooltip, richtextbox

当鼠标悬停在自定义富编辑控件中的链接上时，我想显示工具提示。考虑以下文本：

> 我们都在晚上**睡觉。**

就我而言，***睡眠***这个词是一个链接。

当用户在链接下移动鼠标时，在本例中为“睡眠”，我想显示链接的工具提示。

我想到了以下内容，但它们不起作用

1) 捕获 OnMouseHover

```
if(this.Cursor == Cursors.Hand)
   tooltip.Show(textbox,"My tooltip");
else
   tooltip.Hide(textbox); 
```

但这行不通。

**更新**

提到的链接**不是**URL，即这些是自定义链接，所以 Regex 在这里不会有太大帮助，它可以是任何文本。用户可以选择创建一个链接。

虽然我没有尝试过`GetPosition`方法，但我认为它在设计和维护方面不会那么优雅。

让我说我在我的richedit框中有以下行

> 我们晚上***睡觉***。但蝙蝠保持***清醒***。蟑螂在晚上变得***活跃。***

在上面的句子中，当鼠标悬停在它们上方时，我想要三个不同的工具提示。

```
sleep -> Human beings
awake -> Nightwatchman here
active -> My day begins 
```

我被困`OnMouseMove`如下：

**使用消息框**

```
OnMouseMove( )
{

   // check to see if the cursor is over a link
   // though this is not the correct approach, I am worried why does not a tooltip show up
   if(this.Cursor.current == Cursors.hand )
   {
     Messagebox.show("you are under a link");
   }
} 
```

**不工作 - 使用工具提示 - 工具提示不显示**

```
OnMouseMove( MouseventArgs e )
{

   if(cursor.current == cursors.hand )
   {
     tooltip.show(richeditbox,e.x,e.y,1000);
   }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2015-03-11T13:17:42.067

只需将 ToolTip 工具从工具箱添加到表单，然后将此代码添加到任何控件的 mousemove 事件中，以使工具提示在其 mousemove 时开始

```
private void textBox3_MouseMove(object sender, MouseEventArgs e)
    {
      toolTip1.SetToolTip(textBox3,"Tooltip text"); // you can change the first parameter (textbox3) on any control you wanna focus
    } 
```

希望能帮助到你

和平

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-17T05:15:54.220

好吧，看看，这行得通，如果你有问题，请告诉我：

```
using System.Drawing;
using System.Windows.Forms;
namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1() { InitializeComponent(); }

        ToolTip tip = new ToolTip();
        void richTextBox1_MouseMove(object sender, MouseEventArgs e)
        {
            if (!timer1.Enabled)
            {
                string link = GetWord(richTextBox1.Text, richTextBox1.GetCharIndexFromPosition(e.Location));
                //Checks whether the current word i a URL, change the regex to whatever you want, I found it on www.regexlib.com.
//you could also check if current word is bold, underlined etc. but I didn't dig into it.
                if (System.Text.RegularExpressions.Regex.IsMatch(link, @"^(http|https|ftp)\://[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(:[a-zA-Z0-9]*)?/?([a-zA-Z0-9\-\._\?\,\'/\\\+&amp;%\$#\=~])*$"))
                {
                    tip.ToolTipTitle = link;
                    Point p = richTextBox1.Location;
                    tip.Show(link, this, p.X + e.X,
                        p.Y + e.Y + 32, //You can change it (the 35) to the tooltip's height - controls the tooltips position.
                        1000);
                    timer1.Enabled = true;
                }
            }
        }

        private void timer1_Tick(object sender, EventArgs e) //The timer is to control the tooltip, it shouldn't redraw on each mouse move.
        {
            timer1.Enabled = false;
        }

        public static string GetWord(string input, int position) //Extracts the whole word the mouse is currently focused on.
        {
            char s = input[position];
            int sp1 = 0, sp2 = input.Length;
            for (int i = position; i > 0; i--)
            {
                char ch = input[i];
                if (ch == ' ' || ch == '\n')
                {
                    sp1 = i;
                    break;
                }
            }

            for (int i = position; i < input.Length; i++)
            {
                char ch = input[i];
                if (ch == ' ' || ch == '\n')
                {
                    sp2 = i;
                    break;
                }
            }

            return input.Substring(sp1, sp2 - sp1).Replace("\n", "");
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-11-30T10:32:48.733

您不应该使用*control private tooltip*，而是使用*form one*。这个例子效果很好：

```
public partial class Form1 : Form
{
    private System.Windows.Forms.ToolTip toolTip1;

    public Form1()
    {
        InitializeComponent();
        this.components = new System.ComponentModel.Container();
        this.toolTip1 = new System.Windows.Forms.ToolTip(this.components);

        MyRitchTextBox myRTB = new MyRitchTextBox();
        this.Controls.Add(myRTB);

        myRTB.Location = new Point(10, 10);
        myRTB.MouseEnter += new EventHandler(myRTB_MouseEnter);
        myRTB.MouseLeave += new EventHandler(myRTB_MouseLeave);
    }

    void myRTB_MouseEnter(object sender, EventArgs e)
    {
        MyRitchTextBox rtb = (sender as MyRitchTextBox);
        if (rtb != null)
        {
            this.toolTip1.Show("Hello!!!", rtb);
        }
    }

    void myRTB_MouseLeave(object sender, EventArgs e)
    {
        MyRitchTextBox rtb = (sender as MyRitchTextBox);
        if (rtb != null)
        {
            this.toolTip1.Hide(rtb);
        }
    }

    public class MyRitchTextBox : RichTextBox
    {
    }

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T20:30:40.423

这并不优雅，但您可以使用 RichTextBox.GetCharIndexFromPosition 方法将鼠标当前所在字符的索引返回给您，然后使用该索引确定它是否位于链接、热点或任何其他特殊区域。如果是，请显示您的工具提示（并且您可能希望将鼠标坐标传递给工具提示的 Show 方法，而不是仅传递文本框，以便工具提示可以定位在链接旁边）。

此处示例：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.getcharindexfromposition (VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.getcharindexfromposition(VS.80).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-09T11:27:20.277

我还想在这里添加一些内容，如果您在程序运行之前加载包含工具提示控件的所需表单，那么该表单上的工具提示控件将无法按如下所述工作......

```
 [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        objfrmmain = new Frm_Main();
        Showtop();//this is procedure in program.cs to load an other form, so if that contain's tool tip control then it will not work
        Application.Run(objfrmmain);

    } 
```

所以我通过在 Fram_main_load 事件过程中添加以下代码来解决这个问题

```
 private void Frm_Main_Load(object sender, EventArgs e)
    {
        Program.Showtop();
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T11:13:40.730

利用：

```
ToolTip tip = new ToolTip();
private void richTextBox1_MouseMove(object sender, MouseEventArgs e)
{
    Cursor a = System.Windows.Forms.Cursor.Current;
    if (a == Cursors.Hand)
    {
        Point p = richTextBox1.Location;
        tip.Show(
            GetWord(richTextBox1.Text,
                richTextBox1.GetCharIndexFromPosition(e.Location)),
            this,
            p.X + e.X,
            p.Y + e.Y + 32,
            1000);
    }
} 
```

使用我其他答案中的 GetWord 函数来获取悬停的单词。使用计时器逻辑禁用重新显示工具提示，如上一页所示。例子。

在上面的这个例子中，工具提示通过检查鼠标指针来显示悬停的单词。

如果这个答案仍然不是您想要的，请指定描述您想要使用工具提示的单词的条件。如果你想要粗体字，请告诉我。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-05T20:25:31.340

为了便于使用和理解。

您可以简单地将工具提示放在表单上的任何位置（来自工具箱）。然后，您将在表单中其他所有内容的属性中获得一个选项，以确定该工具提示中显示的内容（其内容类似于“ToolTip on toolTip1”）。每当您将鼠标悬停在对象上时，该属性中的文本都会显示为工具提示。

这**不**包括原始问题所要求的自定义即时工具提示。但我把这个留给其他不需要的人

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-11-20T09:49:22.653

如果您使用的是 RichTextBox 控件。您可以简单地定义 ToolTip 对象，并通过在 RichTextBox 控件内移动鼠标来在选择文本时显示工具提示。

```
 ToolTip m_ttInput = new ToolTip(); // define as member variable

    private void rtbInput_SelectionChanged(object sender, EventArgs e)
    {
        if (rtbInput.SelectedText.Length > 0) 
        {
            m_ttInput.Show(rtbInput.SelectedText.Length.ToString(), rtbInput, 1000);
        }
    } 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-04-08T23:21:47.823

由于这个问题（但它的年龄）中没有任何内容需要解决方案`Windows.Forms`，因此这是一种`WPF`在代码隐藏中执行此操作的方法。

```
TextBlock tb = new TextBlock();
tb.Inlines.Add(new Run("Background indicates packet repeat status:"));
tb.Inlines.Add(new LineBreak());
tb.Inlines.Add(new LineBreak());
Run r = new Run("White");
r.Background = Brushes.White;
r.ToolTip = "This word has a White background";
tb.Inlines.Add(r);
tb.Inlines.Add(new Run("\t= Identical Packet received at this time."));
tb.Inlines.Add(new LineBreak());
r = new Run("SkyBlue");
r.ToolTip = "This word has a SkyBlue background";
r.Background = new SolidColorBrush(Colors.SkyBlue);
tb.Inlines.Add(r);
tb.Inlines.Add(new Run("\t= Original Packet received at this time."));

myControl.Content = tb; 
```

# c# - 双精度

> ID：873178
> 
> 赞同：1
> 
> 时间：2009-05-16T20:08:08.510
> 
> 标签：c#, double, precision

我有一个代码，但我不明白。我正在开发一个精度非常重要的应用程序。但它对 .NET 并不重要，为什么？我不知道。

```
double value = 3.5;
MessageBox.Show((value + 1 * Math.Pow(10, -20)).ToString()); 
```

但消息框显示：3.5 请帮帮我，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T21:13:29.697

如果您正在做任何对精度非常重要的事情，您需要了解浮点的局限性。一个很好的参考是[David Goldberg 的“What Every Computer Scientist Should Know About Floating-Point Arithmetic”](http://docs.sun.com/source/806-3568/ncg_goldberg.html)。

您可能会发现浮点数无法提供足够的精度，您需要使用小数类型。然而，这些总是比浮点慢得多——这是准确性和速度之间的权衡。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T20:16:36.150

a 的精度`Double`为 15 位（内部为 17 位）。您计算的值`Math.Pow`是正确的，但是当您将它添加到`value`它时，它太小而无法产生影响。

编辑：
Decimal 可以处理该精度，但不能处理计算。如果您想要该精度，则需要进行计算，然后将每个值转换为 a ，然后再将`Decimal`它们相加：

```
double value = 3.5;
double small = Math.Pow(10, -20);

Decimal result = (Decimal)value + (Decimal)small;

MessageBox.Show(result.ToString()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T20:15:24.780

或者使用[Decimal](http://msdn.microsoft.com/en-us/library/system.decimal(VS.71).aspx)类型而不是 double。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T20:29:50.923

您可以拥有精确度，但这取决于您还想做什么。如果您将以下内容放在控制台应用程序中：

```
double a = 1e-20;
Console.WriteLine(" a  = {0}", a);
Console.WriteLine("1+a = {0}", 1+a);

decimal b = 1e-20M;
Console.WriteLine(" b  = {0}", b);
Console.WriteLine("1+b = {0}", 1+b); 
```

你会得到

```
 a  = 1E-20
1+a = 1
 b  = 0,00000000000000000001
1+b = 1,00000000000000000001 
```

但请注意，该`Pow`函数与 Math 类中的几乎所有内容一样，只需要双精度数：

```
double Pow(double x, double y); 
```

所以你不能取小数的正弦（然后将其转换为双精度）

另请参阅[此问题](https://stackoverflow.com/questions/803225/when-should-i-use-double-instead-of-decimal)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T20:18:18.160

双精度意味着它可以容纳 15-16 位数字。3.5 + 1e-20 = 21 位数。它不能以双精度表示。您可以使用其他类型，例如十进制。

# java - 将二进制数据从 URL 复制到 Java 中的文件，无需中间副本

> ID：873179
> 
> 赞同：4
> 
> 时间：2009-05-16T20:08:37.823
> 
> 标签：java, file, url, copy

我正在更新一些旧代码以从 URL 而不是从数据库中获取一些二进制数据（数据即将从数据库中移出，而是可以通过 HTTP 访问）。数据库 API 似乎直接以原始字节数组的形式提供数据，并且有问题的代码使用 BufferedOutputStream 将该数组写入文件。

我对 Java 一点也不熟悉，但是通过谷歌搜索找到了这段代码：

```
URL u = new URL("my-url-string");
URLConnection uc = u.openConnection();
uc.connect();
InputStream in = uc.getInputStream();
ByteArrayOutputStream out = new ByteArrayOutputStream();
final int BUF_SIZE = 1 << 8;
byte[] buffer = new byte[BUF_SIZE];
int bytesRead = -1;
while((bytesRead = in.read(buffer)) > -1) {
    out.write(buffer, 0, bytesRead);
}
in.close();
fileBytes = out.toByteArray(); 
```

这似乎在大多数情况下都有效，但是当被复制的数据很大时我遇到了一个问题——我得到了一个 OutOfMemoryError 数据项，这些数据项在旧代码中运行良好。

我猜这是因为这个版本的代码同时在内存中有多个数据副本，而原始代码没有。

有没有一种简单的方法可以从 URL 中获取二进制数据并将其保存在文件中，而不会在内存中产生多个副本的成本？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-16T20:15:30.973

无需将数据写入字节数组，然后将其转储到文件中，您可以通过替换以下内容直接将其写入文件：

```
ByteArrayOutputStream out = new ByteArrayOutputStream(); 
```

和：

```
FileOutputStream out = new FileOutputStream("filename"); 
```

如果您这样做，则无需`out.toByteArray()`在最后调用。只需确保`FileOutputStream`在完成后关闭对象，如下所示：

```
out.close(); 
```

有关详细信息，请参阅[FileOutputStream](http://java.sun.com/j2se/1.4.2/docs/api/java/io/FileOutputStream.html)的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T20:18:15.333

我不知道“大”数据是什么意思，但请尝试使用 JVM 参数

java -Xmx 256m ...

它将最大堆大小设置为 256 MB（或您喜欢的任何值）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T10:25:01.107

如果您需要 Content-Length 并且您的 Web 服务器有点符合标准，那么它应该为您提供“Content-Length”标头。

URLConnection#getContentLength() 应该预先为您提供该信息，以便您能够创建文件。（请注意，如果您的 HTTP 服务器配置错误或受到邪恶实体的控制，则该标头可能与接收的字节数不匹配。在这种情况下，为什么不先流式传输到临时文件，然后再复制该文件？）

除此之外：ByteArrayInputStream 是一个可怕的内存分配器。它总是将缓冲区大小加倍，因此如果您读取一个 32MB + 1 字节的文件，那么您最终会得到一个 64MB 的缓冲区。实现一个自己的、更智能的字节数组流可能会更好，如下所示：

[http://source.pentaho.org/pentaho-reporting/engines/classic/trunk/core/source/org/pentaho/reporting/engine/classic/core/util/MemoryByteArrayOutputStream.java](http://source.pentaho.org/pentaho-reporting/engines/classic/trunk/core/source/org/pentaho/reporting/engine/classic/core/util/MemoryByteArrayOutputStream.java)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T20:16:28.537

子类化 ByteArrayOutputStream 使您可以访问缓冲区和其中的字节数。

但是，当然，如果您只想将数据存储到文件中，则最好使用 FileOutputStream。

# javascript - javascript图像覆盖在指定的div上

> ID：873184
> 
> 赞同：2
> 
> 时间：2009-05-16T20:11:49.907
> 
> 标签：javascript, css, dom

我是 javascript 的新手。实际上很新，这应该是我的第一个脚本。谁能向我解释如何在任何指定的固定宽度区域（例如 700x300 像素）上进行透明覆盖。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T20:29:52.343

您可以定义叠加层，例如

```
<div id="myoverlay" class="myoverlay">...contents...</div> 
```

并在 CSS 中定义尺寸和位置以及 z-index 等...

```
.myoverlay {
   position: absolute;
   display: none;
   ...
} 
```

我还没有完全看到对 JavaScript 的需求，但我想你会想要使用 JS 来打开/关闭覆盖的显示属性。

```
<script type="text/javascript">
function showOverlay(){
  document.getElementById("myoverlay").style.display = "block";
}
</script> 
```

这大致是你所追求的吗？很抱歉无意的语法错误，因为这是未经测试的代码，纯粹是在我的脑海中。只是给你一个想法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T20:37:33.480

您可以创建一个具有透明度的 div 并将其绝对定位在指定区域上。

```
var shimDiv = document.createElement('div');  
shimDiv.id = 'shim';  
shimDiv.style.position = 'absolute';  
shimDiv.style.top = 0;  
shimDiv.style.left = 0;  
shimDiv.style.width = "700px";  
shimDiv.style.height = "300px";  
shimDiv.style.backgroundColor = '#000'; 
shimDiv.style.zIndex = 3; 
```

对于非 IE 浏览器设置不透明度：

```
shimDiv.style.opacity = '0.75'; 
```

由于 IE 本身不支持透明度，因此您应该像这样使用过滤器：

```
shimDiv.style.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=75)'; 
```

并将这个新的 div 添加到文档正文的末尾：

```
document.body.appendChild(shimDiv); 
```

要支持较旧的 IE 版本，您必须将 IFrame 元素放在透明 DIV 下。

要从 JavaScript 动态创建 IFrame，请尝试以下代码：

```
var iframe = document.createElement('iframe');
iframe.setAttribute("src", "javascript:false"); 
```

不要忘记使用无用的 'javascript:false' 语句设置 IFrame src 属性，以防止 IFrame 尝试加载页面（您不会注意到它这样做，但这将是触发“Unsecured Items”消息的原因如果您在 HTTPS 页面上使用它）。

通过给它一个较低的 z-index 属性值，将此 IFrame 放置在 div 下。

```
iframe.style.zIndex = 2; 
```

所有的样式都可以用 CSS 完成。我只是想展示它是如何使用 JavaScript 完成的。

# xslt - xslt 和 xpath：匹配两个节点属性

> ID：873185
> 
> 赞同：1
> 
> 时间：2009-05-16T20:11:54.180
> 
> 标签：xslt

给定以下xml：

```
<student studentID="001"> 
    <dateOfBirth> 1-1-1990 </dateOfBirth>
    <name> Ayse Ozer </name>
    <sex> F </sex>
    <takes> CMPE351 </takes>
    <takes> CMPE111 </takes>
<takes> CMPE418 </takes>
 </student>

 <student studentID="002"> 
    <dateOfBirth> 2-2-1992 </dateOfBirth>
    <name> Bircan Korkmaz </name>
    <sex> F </sex>
    <takes> CMPE418 </takes>
    <takes> CMPE111 </takes>
<takes> CMPE352 </takes>
    </student>

<course courseCode="CMPE351">
     <courseName>
           Database systems I
     </courseName>
     <description>
         First course in databases
     </description>       
 </course>

 <course courseCode="CMPE111">
     <courseName>
           Introduction to C
     </courseName>
     <description>
         First course in programming
     </description>       
 </course>

 <course courseCode="CMPE352">
     <courseName>
           Database systems II
     </courseName>
     <description>
         Second course in databases
     </description>       
 </course>

 <course courseCode="CMPE418">
     <courseName>
           Internet Programming
     </courseName>
     <description>
         Programming for the Internet.
     </description>       
 </course> 
```

我想要这样的输出

学生参加的课程：

```
* Ayse Ozer
      o CMPE351 Database systems I
      o CMPE111 Introduction to C
* Bircan Korkmaz
      o CMPE418 Internet Programming
      o CMPE111 Introduction to C 
```

我写了这个 xsl 代码：

```
<xsl:template match = "school">
<head>
<title>Student</title>    
 </head>
 <body>
 <p>Courses Taken By Students:</p>
   <xsl:for-each select = "student">
 <ul>
 <li><xsl:value-of select = "name"/> </li>    
 <xsl:for-each select = "takes">
 <ul>
 <li><xsl:value-of select="text()" />
<xsl:value-of select = "../../course[@courseCode=text()]/courseName"/> </li>
 </ul> 
</xsl:for-each>
 </ul>  
    </xsl:for-each>
 </body>
 </xsl:template> 
```

* * *

```
 <xsl:value-of select = "../../course[@courseCode=text()]/courseName"/>
 Problem about above line about text() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T20:18:50.433

问题是空格：

```
<takes> CMPE351 </takes> 
```

应该：

```
<takes>CMPE351</takes> 
```

我会尝试补偿......路上的例子......为了避免很多问题（并提高性能），我还将使用 xsl 索引......

* * *

已修复（警告 - 它不适用于**中间**有多个空格的课程代码，但这似乎不太可能）：

```
<xsl:variable name="code" select="normalize-space()"/>
<ul>
  <li>
    <xsl:value-of select="$code"/>
    <xsl:value-of select="key('courses',$code)/courseName"/>
  </li>
</ul> 
```

与（在顶部）xsl 索引：

```
<xsl:key name="courses" match="/school/course" use="@courseCode"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T21:10:25.413

在你已经有了一个很好的答案之前，我设计了这个例子。由于这只是一种稍微不同的方法，我想我还是会发布它。

```
 <?xml version="1.0" encoding="utf-8"?>

<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output method="html" indent="no" encoding="UTF-8" omit-xml-declaration="yes" />

  <xsl:key name="courses" match="course" use="@courseCode"/>

  <xsl:template match="school">
      <html>
        <body>
          <p>Courses taken by:</p>
          <ul>
            <xsl:apply-templates select="student"/>
          </ul>
        </body>
      </html>
  </xsl:template>

  <xsl:template match="student">
    <li>
      <xsl:value-of select="name"/>
      <ul>
        <xsl:apply-templates select="takes"/>
      </ul>
    </li>
  </xsl:template>

  <xsl:template match="takes">
    <li>
      <xsl:value-of select="."/>
      <xsl:value-of select="key('courses', normalize-space(.))/courseName"/>
    </li>
  </xsl:template>

</xsl:stylesheet> 
```

# php - 为什么在 php 上使用 web 框架（如 rails）？

> ID：873195
> 
> 赞同：9
> 
> 时间：2009-05-16T20:15:35.793
> 
> 标签：php, ruby-on-rails, django, frameworks, models

这不是关于使用什么框架的问题。我已经学习了 Rails 和 Django，并且我用 PHP 编写了所有的 web 应用程序。我的问题是为什么要打扰框架？使用框架总是比重用旧的 MySQL 代码和使用 phpMyAdmin 构建“模型”要花更长的时间。我也喜欢自己写一切，因为我知道发生了什么。我仍然可以重用函数等并按照我的意愿做事，而大多数框架似乎都缺少这种自由。

我并不是说我的方法是对的；事实上，我正试图找出我的逻辑失败的地方。炒作不能只是凭空而来。我错过了什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-16T22:59:45.337

框架的基本思想是允许您在更高级别的抽象上工作，并且只编写您必须编写的代码来实现您的特定需求。所有其他重复的东西都由框架为您处理，并且可能比您自己做的错误和安全漏洞少得多。

学习一个框架可能比使用基本语言特性和标准 API 自己动手学习框架需要更长的时间，但这根本不是真的——如果框架很好并且应用程序不是微不足道的，尤其是当*你*已经了解了框架（为每个新项目使用不同的框架当然是愚蠢的），并考虑了查找和消除所有错误以及纠正所有早就发现、消除和纠正的设计错误所需的时间在其开发者社区的框架中。

几乎每个开发人员都有牛仔编码员的直觉告诉他“自己做事情比使用其他人编写的代码有趣得多，而且我确信我已经足够优秀了，可以在第一时间把它做好，所以它甚至会更快，并且更好的！”。这些直觉几乎总是错误的。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-16T20:22:20.690

框架允许您专注于应用程序本身，而不必担心您必须为每个应用程序编写的样板代码。它们允许您使用经过试验和测试的设计模式（例如模型-视图-控制器）以更合乎逻辑（主要是面向对象）的方式构建您的站点。框架中的代码通常比您自己为一次性项目编写的代码更成熟且标准更高，因为框架有一个庞大的开发人员社区，他们在一年中不断完善代码。这意味着框架驱动的站点通常性能更好并且更安全。

你还提到你喜欢自己写东西——我知道你来自哪里。我对此的解决方案是编写自己的框架——我可以在我所做的每个项目中重用和改进我的代码，并且我对整个代码库了如指掌。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-16T21:18:30.243

自己编写可能会让您更容易理解自己的事情，但不幸的是，它会使其他开发人员更难理解正在发生的事情。框架通常会有更好的文档记录，并拥有一个更大的社区，可以支持正在开发您编写的应用程序的新开发人员。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-16T20:22:23.000

我认为其中很大一部分是你所关注的。框架标准化了您不应该重复访问的部分，这有助于您将注意力集中在整个应用程序上。如果您一直重复使用自己的代码，那么您已经在使用自己的临时框架。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-16T21:07:16.683

您将框架（Rails）与语言（PHP）进行比较。框架将为您提供预先构建的组件，以便您可以花时间在使您的项目与众不同的地方。

您可能已经有一个代码库可以帮助您完成这项工作。查看一些 PHP 框架，因为那是您更舒服的地方。看看[CakePHP](http://cakephp.org)、[CodeIgnitor](http://codeigniter.com/)和/或[Zend Framework](http://framework.zend.com/)。

如果您正在构建许多小型应用程序/网站，使用框架可能会让您的生活更轻松。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-16T21:05:21.977

**我认为对您来说一个很好的步骤是使用您迄今为止编写的代码创建自己的框架。;)**

尝试使您的代码参数化，换句话说：创建可以在网站的不同部分（例如：样式化的容器）或不同的网站（表单生成器/验证器）中重用的组件。

您甚至可以更进一步创建基类，从中扩展新类以构建您的网站。（例如：具有通用选择/插入/更新/删除方法的数据对象）。

我敢打赌，这可以让您更好地了解为什么框架如此方便；）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-17T06:12:28.250

首先，PHP 也有框架，所以上述问题没有抓住重点。

是的，您可以编写自己的框架，正如 Kris 所说，这并不丢人。然而，代码重用的部分优势是许多人努力的集体价值。这不仅仅是重用您自己的代码。框架封装了我们都共享的常见任务和模式，并提供了经过良好测试的解决方案以及来自社区的许多迭代改进。无论你是谁，任何个人的努力都无法达到这一点。

如果你自己动手，它只会因为世界级的人的集体努力而成为世界级，而且只有当你的想法值得关注时才会发生。现有的顶级框架已经在这些标准上得到证明。

DHH 是个聪明人，但我们今天所拥有的 Rails 不可能仅靠他一个人实现。差远了。

如果你喜欢如你所说的“自己写一切”，那么选择一个核心理念与你相匹配的框架，并开始在你认为有改进空间的领域做出核心贡献。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-17T06:35:42.937

根据您的 Web 应用程序的功能，在没有框架的情况下可以更快地进行开发。例如，当 Webapp 只是某种数据查看器时。

但是，一旦您开始实现更高级的功能，使用框架的效率就会大大提高。

尝试从头开始： - 正确的表单验证 - 处理多种语言和日期/时间格式 - 身份验证

将框架视为免费工具和稳定的实现功能供您使用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-17T02:08:11.360

您还应该只使用基于 PHP 的框架，例如 Symfony 或 CakePHP，使用它们应该会大大减少您的生产时间。

使用框架的一个原因是代码分离。以 symfony 为例。该模型全部使用推进或学说库完成。只需要很少的 SQL。您实例化一个新对象和用户 getter 和 setter，以存储您的数据，而不是在页面代码中编写 SQL，而是在与查询相关的对象中创建函数。当您需要在不同页面上访问相同类型的数据时，您是在向模型询问它，将业务逻辑与模型保持在应有的位置，因此永远不会有任何区别。所有工作都在“动作控制器功能”中完成。你得到你需要的所有数据，然后把尽可能少的 php 放在显示中，基本上只是回显你在动作控制器中得到的变量，（除了一些 for 循环和条件语句的 if 语句。

你不需要为了使用一个伟大的框架而学习一门新的语言 python/ruby，只需要找到一个适合你的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-16T21:25:16.500

最初使用框架会花费您更长的时间，原因与 PHP 开发人员最初使用 Ruby 需要更长的时间的原因相同——您不熟悉它。

一旦你熟悉了它们，框架就可以提供跳过平凡而专注于实际编写应用程序重要部分的能力。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-16T22:57:44.437

听起来你已经用 php 编写了自己的框架，因为你确实提到了代码重用。

我可以想象使用自己的轮组比适应别人的轮组更容易。没有什么可耻的。

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2009-05-16T21:06:25.720

框架的存在主要是为了帮助那些对 PHP（或它所构建的特定语言）半新的人能够构建一个网站，使其安全且易于在网站上添加额外的部分，而无需必须对安全性、MySQL（或其他数据库类型）等细节有很多了解。在我看来，这是一种帮助将编码器分解为一种语言的相当好的方法，同时考虑到框架当然不是太复杂的事实。

*编辑*我之所以说它们是为初学者准备的，是因为我自己，作为一个初学者，已经使用框架更好地将自己分解成语言。

# objective-c - 内存管理和 performSelectorInBackground：

> ID：873200
> 
> 赞同：12
> 
> 时间：2009-05-16T20:18:02.170
> 
> 标签：objective-c, iphone, cocoa-touch

哪个是对的？这：

```
NSArray* foo = [[NSArray alloc] initWithObjects:@"a", @"b", nil];
[bar performSelectorInBackground:@selector(baz:) withObject:foo];

- (void)baz:(NSArray*)foo {
    ...
    [foo release];
} 
```

或者：

```
NSArray* foo = [[[NSArray alloc] initWithObjects:@"a", @"b", nil] autorelease];
[bar performSelectorInBackground:@selector(baz:) withObject:foo];

- (void)baz:(NSArray*)foo {
    NSAutoreleasePool* pool = [[NSAutoreleasePool alloc] init];
    ...
    [pool release];
} 
```

我知道第一个有效，但 Clang 抱怨它，所以我想知道是否有更好的模式可以使用。

我会“尝试”第二个，但是使用自动发布，谁知道缺少是否`EXC_BAD_ACCESS`意味着您做对了，或者您只是幸运...

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-16T20:52:14.800

首先是错误的。

performSelectorInBackground:withObject: 保留 bar 和 foo 直到任务执行。因此，您应该在创建 foo 时自动释放它，并让 performSelectorInBackground:withObject 处理其余的事情。查看[文档](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html#//apple_ref/occ/instm/NSObject/performSelectorInBackground:withObject:)

后者是正确的，因为您在创建 foo 时会自动释放它。您在 baz 中创建的自动释放池与 foo 的内存管理的正确性无关。**池分配中**的自动释放对象需要该自动释放池，并在 baz 中释放，它根本不会触及 foo 的保留计数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-29T10:01:54.830

现在正确的方法实际上是：

```
NSArray* foo = [[[NSArray alloc] initWithObjects:@"a", @"b", nil] autorelease];
[bar performSelectorInBackground:@selector(baz:) withObject:foo];

- (void)baz:(NSArray*)foo {
    @autoreleasepool {
        ...
    }
} 
```

# redirect - 将一堆旧的动态 URL 重定向到一个新的索引页面会完全破坏我的页面排名吗？

> ID：873204
> 
> 赞同：0
> 
> 时间：2009-05-16T20:18:30.280
> 
> 标签：redirect, seo

我有六个旧版动态 URL，结果表明重定向它们都需要在我的 .htaccess 文件中使用 18 个 Rewrite 指令——这对我来说似乎很乱。

但是，我可以做的是使用单个重定向指令将所有这些重定向到我的新起始页面。这是一个很小的网站，人们可能通过谷歌搜索进入的所有页面都可以从起始页很容易找到，所以我想这样做但是......

我担心这可能会破坏该网站的适度（但值得维护）页面排名，因为随后几个 URL 将解析为相同的 URL 和内容。

有谁知道这是否会是这种情况，如果是这样，是否有其他策略可以避免这种情况，然后不执行上述操作？

谢谢！

罗杰。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T20:23:37.647

只要您执行 301 重定向（永久移动）与 302 重定向（暂时移动），那么从您的十几个旧 URL 中累积的所有页面排名都将转移到您要重定向到的新 URL。

所以你不会“丢失”页面排名，它只会被转移到新的 URL。

重要的是确保它是 301 重定向。

# c# - 强制在 Web 服务器上下载文件 - ASP .NET C#

> ID：873207
> 
> 赞同：18
> 
> 时间：2009-05-16T20:19:05.863
> 
> 标签：c#, asp.net, download

当用户单击基于 ASP .NET (C#) 的 Web 应用程序中的按钮时，我需要强制启动 .sql 文件的下载。

例如，当单击按钮时，应在客户端打开一个另存为对话框...

我该怎么做呢？

**编辑**

这是我正在使用的代码

```
 string sql = "";
        using (System.IO.StreamReader rdr = System.IO.File.OpenText(fileName))
        {
            sql = rdr.ReadToEnd();
        }
        Response.ContentType = "text/plain";
        Response.AddHeader("Content-Disposition", "attachment; filename=Backup.sql");
        Response.Write(sql);
        Response.End(); 
```

这是我得到的错误......

[替代文字 http://img40.imageshack.us/img40/2103/erroro.gif](http://img40.imageshack.us/img40/2103/erroro.gif)

怎么了？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-16T20:29:08.133

创建一个单独的 HTTP 处理程序（DownloadSqlFile.ashx）：

```
<%@ WebHandler Language="C#" Class="DownloadHandler" %>

using System;
using System.Web;

public class DownloadHandler : IHttpHandler {
    public void ProcessRequest(HttpContext context) {
        var fileName = "myfile.sql";
        var r = context.Response;
        r.AddHeader("Content-Disposition", "attachment; filename=" + fileName);
        r.ContentType = "text/plain";
        r.WriteFile(context.Server.MapPath(fileName));
    }
    public bool IsReusable { get { return false; } }
} 
```

然后让 ASP.NET 页面中的按钮导航到`DownloadSqlFile.ashx`.

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-16T20:24:47.410

您需要告诉浏览器您发送的不是 html 并且不应该在浏览器中显示。以下代码可用于在您的服务器端代码中返回一些文本，它会根据您的需要向用户显示保存对话框：

```
Response.Clear(); //eliminates issues where some response has already been sent
Response.ContentType = "text/plain";
Response.AddHeader("Content-Disposition", string.Format("attachment; filename={0}.sql", filename));
Response.Write(yourSQL);
Response.End(); 
```

`filename`: 你想给它起的名字

`yourSQL`: sql文件的内容

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-16T21:23:37.673

**问题是您在浏览器中当前加载的同一页面上使用代码。您正在尝试修改当前加载页面的响应流和处置。**相反，按照 Mehrdad 的建议，创建一个单独的 HttpHandler。然后单击按钮，您将调用处理程序的 URL。该按钮甚至可以是一个简单的超链接，其源 URL 如下：

```
<a href="DownloadSqlFile.ashx">Download SQL</a> 
```

有道理？关键是，**您不能修改已加载页面的响应**。使用处理程序启动新请求以完成工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T21:11:04.490

如果在 Chrome 对话框中正确说明，`Response.Clear`请在修复错误之前添加一个。`Response.Write`

所以要整合到其他答案的片段中......

```
//add this
Reponse.Clear(); 

//from other answer
Response.ContentType = "text/plain";
Response.AddHeader("Content-Disposition", string.Format("attachment; filename={0}.sql", filename));
Response.Write(yourSQL);
Response.End; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-19T12:07:44.373

下面的解决方案对我有用

```
string fileNameAndExtension = "thisFile.pdf";     
string fullPath = "../folder/files/" + fileNameAndExtension;       
Response.Clear();
Response.AppendHeader("Content-Disposition", "attachment; filename=" + fileNameAndExtension );
Response.TransmitFile(fullPath);
Response.End(); 
```

# c++ - 由于后期构建步骤，未加载本机 dll 的符号 (pdb)

> ID：873210
> 
> 赞同：6
> 
> 时间：2009-05-16T20:19:48.437
> 
> 标签：c++, windows, visual-studio, windbg, minidump

我有一个用符号构建的本机发布 dll。有一个后期构建步骤可以修改 dll。后期构建步骤会进行一些压缩，并且可能会附加一些数据。pdb 文件仍然有效，但是 WinDbg 和 Visual Studio 2008 都不会在构建后步骤之后加载 dll 的符号。我们需要修改 pdb 文件或 dll 中的哪些位，以使 WinDbg 或 Visual Studio 在加载引用了我们的发布 dll 的转储时加载符号？

文件大小重要吗？校验和或哈希？时间戳？

修改转储？或修改pdb？发货前修改dll？

（我们知道 pdb 是有效的，因为我们能够使用它来手动获取引用已发布 dll 的转储调用堆栈中地址的符号名称。*ss 对调用堆栈中的每个地址手动执行它只是一个完全的痛苦所有线程。）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-16T20:50:21.687

[这篇文章](https://stackoverflow.com/questions/134866/windbg-dr-watson-minidump-requires-pdb-dll-originally-built-for-installed-vers)使我进入了[chkmatch](http://www.debuginfo.com/tools/chkmatch.html)。在已处理的 dll 上，chkmatch 显示以下信息：

```
可执行文件：
时间日期戳：4a086937
调试信息：2 ( CodeView )
时间戳：4a086937 特征：0 MajorVer：0 MinorVer：0
大小：123 RVA：00380460 文件偏移：00380460
CodeView 签名：sUar

调试信息文件：
格式：PDB 7.00
结果：不匹配（原因：调试信息格式不兼容）

```

对预处理的 dll 使用相同的 pdb，它会报告以下内容：

```
可执行文件：
时间日期戳：4a086937
调试信息：2 ( CodeView )
时间戳：4a086937 特征：0 MajorVer：0 MinorVer：0
大小：123 RVA：00380460 文件偏移：00380460
CodeView 格式：RSDS
签名：（我的向导）年龄：19
PdbFile：（我的路径）

调试信息文件：
格式：PDB 7.00
签名：（我的匹配向导）年龄：19

```

我打开了两个版本的 dll 并转到偏移量 00380460。在原始版本中，很清楚我看到了 pdb 的名称，但在后处理版本中，该偏移量处没有 pdb 信息。我搜索了 pdb 路径并找到了完全相同的块 - 只是在不同的偏移量处。然后我对原始dll中的字节“38 00 60 04”进行了bin搜索。查看处理后的 dll 中的相同偏移量，我发现相同的字节。所以我调整了 RVA 和偏移量（通过匹配字节定位）。答对了！现在 chkmatch 报告已处理 dll 与原始文件完全相同的结果（除了我更改的 RVA 和 FileOffset）。

**编辑**：已确认，现在 Visual Studio 会加载引用已处理 dll 的转储符号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T20:38:39.950

在 Windbg 中尝试使用[.symopt +40](http://msdn.microsoft.com/en-us/library/ff558827.aspx)，这将强制加载 pdb。

# java - 转换和促销

> ID：873213
> 
> 赞同：2
> 
> 时间：2009-05-16T20:20:31.523
> 
> 标签：java

我只是想知道为什么这有效（在Java中）：

```
byte b = 27; 
```

但是像这样声明的方法：

```
public void method(byte b){
    System.out.println(b);
} 
```

这不起作用：

```
a.method(27); 
```

给出如下编译器错误：

```
`The method method(byte) in the type App is not applicable for the arguments (int)` 
```

阅读[这篇](http://java.sun.com/docs/books/jls/second_edition/html/conversions.doc.html)文章并没有给我任何线索（可能我误解了一些东西）。

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-16T20:30:36.240

任务的原因

```
byte b = 27; 
```

工作是由于[Java 语言规范](http://java.sun.com/docs/books/jls/third_edition/html/conversions.html#5.2)（赋值转换）的第 5.2 节，其中包括：

> 此外，如果表达式是 、`byte`或类型的常量表达式（第 15.28 节） ：`short``char``int`
> 
> `byte`如果变量的类型是、`short`或`char`，并且常量表达式的值可以在变量的类型中表示，则可以使用缩小原语转换 。

换句话说，该语言对这种情况有特殊的规定。通常，没有从`int`to的隐式转换`byte`。

有趣的是，C# 在这方面的工作方式不同（尽管在核心功能的许多其他方面与 Java 类似）——方法调用在 C# 中是有效的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T20:23:28.880

简单的答案 - 一个字节是 1 个字节的内存，一个整数通常是 4 个字节。

如果没有明确地尝试将 int 转换为字节，则没有隐含的强制转换，因为如果将大小为 10790 的整数截断为一个字节，则会丢失信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T20:32:32.383

在没有您帮助的情况下获取一个数值并将其转换为另一个数值的过程称为提升 - 例如，您将一个 1 字节的数字，并通过填充零将其变为 4 字节的数字。这（通常）是安全的，因为目标类型中可能值的范围大于源类型中的范围。

当相反的情况发生时，例如取一个 int 并转换为一个字节，这是一个“降级”广告，它不是自动的，你必须强制它，因为它会失去价值。

这里发生的是 27 被解释为 int。表达式本身是一个 int，然后它被发送到一个需要一个字节的方法。换句话说，您将它放在对采用一个字节的方法的调用中这一事实并没有改变 Java 认为它一开始就有点困难的事实。

我不记得究竟如何在 Java 中定义字节常量，但一般来说，像 27 这样的数字是一个神奇的数字。你可能想写一个

```
final byte MY_CONSTANT_THAT_MEANS_27_BUT_WITH_MEANINGFUL_NAME = 27; 
```

然后使用该常量而不是 27 调用您的函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T20:39:11.213

默认情况下，Java 会将诸如 27 之类的数值视为整数类型。以类似的方式考虑这一点，如果你说 123.45，它会将其视为一个浮点数，而“hello”是一个字符串。这些是*静态*值，而不是变量，因此您需要*将*其转换为一个字节，如下所示：

```
a.method((byte)27); 
```

# c++ - unistd.h read() 正在读取更多数据然后被写入

> ID：873214
> 
> 赞同：0
> 
> 时间：2009-05-16T20:21:13.487
> 
> 标签：c++, unix, named-pipes, memset, unistd.h

我正在从命名管道读取/写入数据。在写入方面，它说它正在写入一个恒定的 110 字节。在阅读方面，大部分时间它说它正在读取 110 个字节，这是正确的，但其他时候它说它正在读取 220 个字节或 330 个字节。事实上，当我打印它时，它会在同一个 read() 中连续打印两到三遍相同的消息。在下面的阅读代码中，我是否对 memset 做错了什么来清除字符？我想不出任何其他方式，它读取的内容比写入的内容多，除非缓冲区中剩下一些东西。

```
int fd1, numread;
char bufpipe[5000];

    while(1)
    {
        fd1 = open("/tmp/testPipe", O_RDONLY);
        numread = read(fd1,bufpipe, 5000);//->this should always be 110
        if(numread > 1)
        {
            printf("READ: %i", numread); 
            bufpipe[numread+1] = '\0';
            memset(bufpipe,'\0',5001);
            close(fd1);
        }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T20:38:44.223

这：

```
memset(bufpipe,'\0',5001); 
```

被一个字节覆盖，因为你只有 5000 个字节。

但主要的“问题”是它`read(..., 5000)`总是会尽可能多地读取最多 5000 个字节 - 你似乎假设它只会读取作者一次性写入的内容，这是不正确的。如果写入器在两次读取之间写入两个 110 字节的数据包，那么读取器读取 220 字节是完全正确的。

如果您一次只需要读取一个数据包，则必须使数据包具有自描述性。例如，前四个字节包含后面的字节数。然后您可以通过读取四个字节来读取单个数据包，将其转换为整数，然后读取该数量的数据字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T20:38:17.067

您认为 a`read`将在 a 之后立即执行的假设`write`是不正确的。在遇到读取之前，写入器进程可能会多次写入管道。写入的数据将被添加到缓冲区的末尾。换句话说，读写不是面向数据包的。它们是面向流的。这意味着`write`只需将数据添加到缓冲区并`read`获取可用的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T20:40:41.520

你是如何与作者同步的？您只需阅读您的期望（指定 110 为 read()）

# c++ - 类的 += 运算符的规范形式

> ID：873216
> 
> 赞同：4
> 
> 时间：2009-05-16T20:22:11.410
> 
> 标签：c++, operators, canonical-form

我知道尽可能多地利用类非成员非朋友的接口是个好主意，而且我刚刚意识到对于我的 3D 矢量类“Vector3”，我可以移动 +=， -= 等运算符在类之外，只留下构造函数和复制赋值运算符。

问题是：这个操作符应该是什么样的？我见过许多其他运算符的规范形式并遵循了他们的建议，但我还没有看到这些运算符的规范形式。我已经给出了我认为应该在下面的内容。

第二个问题是：这些运算符到底叫什么？算术赋值运算符？

之前的（相关）代码：

```
class Vector3 {
public:
    Vector3& operator+=(const Vector3& rhs);
    float x, y, z;
};

Vector3& Vector3::operator+=(const Vector3 &rhs) {
    x += rhs.x;
    y += rhs.y;
    z += rhs.z;

    return *this;
} 
```

到目前为止，我已将其更改为：

```
class Vector3 {
public:
    float x, y, z;
};

Vector3& operator+=(Vector3& lhs, const Vector3& rhs) {
    lhs.x += rhs.x;
    lhs.y += rhs.y;
    lhs.z += rhs.z;

    return lhs;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T20:41:21.940

你所拥有的对我来说看起来不错。

顺便说一下，当你谈到 operator+ 时，通常用 += 来实现它。（创建一个lhs的副本，然后调用lhs += rhs并返回结果）

不知道您是否已经知道这个技巧，但是由于您关心实现这些运算符的规范方法，因此提及它并没有什么坏处。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T20:44:01.780

你所拥有的看起来不错。

直观地考虑这一点的基本方法是在编写代码时考虑您希望代码的外观。如果，在这种情况下，你可以写

```
Vector v, w;

v += w;
w += v; 
```

等等，你在正确的轨道上。

有很多好的经验法则可以提供帮助；请参阅C++ 常见问题解答中的[此条目](http://www.parashift.com/c++-faq/operator-overloading.html)以获取更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T20:43:40.703

我不会说“尽可能多的界面”。`operator+=`让等`operator-=`成为非朋友非会员并没有什么好处。

有些人更喜欢让每个函数都成为非成员非友元函数，以抵制使用私有成员变量的诱惑。但是你是个成年人：你可以把函数写成公共成员，而不是使用私有成员变量。我更愿意知道该函数与类相关联，并将其设为公共成员使其显式。

*旁注：
就个人而言，我发现使用私有成员而不是公共访问器通常是可以的（我知道——我会在地狱中燃烧）。不总是！——但经常。
事实上，如果您决定需要它，在少数情况下您无法在几分钟内切换到公共访问器。但我承认这不是一个流行的观点，我不要求人们遵循这种哲学。*

*确定*函数和运算符“非朋友、非成员”是有具体原因的。例如，当用作“流插入运算符”*时，不能*将 operator<<() 设为成员，因为您必须更改 lhs 类（流）。

# c# - 列表框数据

> ID：873222
> 
> 赞同：0
> 
> 时间：2009-05-16T20:23:56.727
> 
> 标签：c#, listbox

现在，在我的模拟 lan-messenger 工作的 c# 程序中，我需要向当前在线的人展示每行一个远程主机名。但是这里的问题是，为了做到这一点，我正在使用该功能

```
//edited this line out, can't find a .Append for listBox or .AppendLine
//listBox.Append(String );

listBox.Items.Add(new ListItem(String)); 
```

这样做时，回车符和换行符（即.. \r 和 \n）将显示为主机名末尾的小矩形框。我该如何摆脱它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T20:28:09.303

你可以使用：

```
listBox.Append(String.Replace("\r\n", "")); 
```

摆脱那些角色

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T04:43:09.807

另一种选择是考虑为您尝试实现的自定义修剪创建扩展方法。

```
/// <summary>
/// Summary description for Helper
/// </summary>
public static class Helper
{
    /// <summary>
    /// Extension Method For Returning Custom Trim
    /// No Carriage Return or New Lines Allowed
    /// </summary>
    /// <param name="str">Current String Object</param>
    /// <returns></returns>
    public static string CustomTrim(this String str)
    {
        return str.Replace("\r\n", "");
    }
} 
```

您的代码行如下所示：

```
listBox.Items.Add(new ListItem(myString.CustomTrim()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T21:34:31.720

您可以使用字符串的[Trim](http://msdn.microsoft.com/en-us/library/system.string.trim.aspx)方法从字符串的开头和结尾删除不需要的字符。要么在不带参数的情况下调用它以删除所有空格（包括像中断），要么传递一个包含要删除的字符的字符数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T21:58:08.653

听起来您在单行模式下使用某种 TextBox。如果是这样，请激活[TextBox.Multiline](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.multiline.aspx)。

# ruby-on-rails - nginx未设置过期Rails静态资产的标头

> ID：873235
> 
> 赞同：7
> 
> 时间：2009-05-16T20:31:09.047
> 
> 标签：ruby-on-rails, nginx

我似乎无法让 nginx 在我的 Rails 应用程序中的静态资产上设置过期标头。

我的应用程序是使用 Phusion Passenger 和 nginx 部署的。

下面是我的 nginx 配置文件的相关部分

```
server {
        listen  80;
        server_name my.domain.tld;
        root /home/deploy/my.domain.tld/current/public;
        passenger_enabled on;
        access_log off;

        location ~* \.(ico|css|js|gif|jp?g|png)\?[0-9]+$ {
                expires max;
                break;
        }

        if (-f $document_root/system/maintenance.html) {
                rewrite ^(.*)$ /system/maintenance.html break;
        }
} 
```

我不确定为什么它没有设置过期我的静态资产上的标题（例如 /images/foo.png?123456 ）

我不确定它是否与乘客有关，或者我的位置正则表达式是否没有捕捉到它

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-08-25T23:15:18.013

Just wanted to point out that making the timestamp optional is a bad idea – if it's not included, then setting `expires max` is wrong as there would be no way of refreshing the file.

Also, the `location` directive in Nginx can't see the query string, so the solution posted here never matches the 'optional' timestamp.

A proper solution (ie one that sends the maximum expires only when the file was requested with a timestamp) would be:

```
location ~* \.(js|css|png|jpg)$ {
  if ($query_string ~ "^[0-9]+$") {
    expires max;
    break;
  }
} 
```

If the timestamp is not specified, then you rely on `Last-Modified` and `ETag`, which are handled automatically by Nginx.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-20T18:51:55.370

所以我最终找到了解决方案。我的正则表达式有点偏离，因为我没有考虑 ?timestamp 不存在的可能性。

这个正则表达式对我有用。

```
location ~* \.(ico|css|js|gif|jp?g|png)(\?[0-9]+)?$ { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-03T05:43:19.577

无需使用“break”指令，但 access_log 关闭；会有用：

```
 location ~* \.(png|gif|jpg|jpeg|css|js|swf|ico)(\?[0-9]+)?$ {
      access_log off;
      expires max;
      add_header Cache-Control public;
  } 
```

你可以在 github 上看到完整的配置文件：[https ://gist.github.com/711913](https://gist.github.com/711913)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T20:52:12.103

也许这会有所帮助：

```
location ~* ^.*\.(ico|css|js|gif|jp?g|png)\?[0-9]+$ { 
```

另请阅读[Nginx 如何评估 location](http://wiki.nginx.org/NginxHttpCoreModule#location)。您确定在您的正则表达式之前，您的配置文件中没有任何其他字符串`location`与您的静态资源匹配`location`吗？

顺便说一句，考虑使用[try_files](http://wiki.nginx.org/NginxHttpCoreModule#try_files)而不是`if (-f $document_root/...)`.

# java - 同步两个线程

> ID：873237
> 
> 赞同：1
> 
> 时间：2009-05-16T20:31:48.920
> 
> 标签：java, multithreading, synchronization

我有两个线程，我希望第二个线程等到第一个线程完成。我怎样才能做到这一点？

这是我的代码：

```
public class NewClass1 implements Runnable {

    // in main
    CallMatlab c = new CallMatlab();
    CUI m = new CUI();
    Thread t1 = new Thread(c);
    t1.start();
    Thread t2 = new Thread(m);
    try {
      t1.join();
    } catch (InterruptedException ex) { 
      Logger.getLogger(NewClass1.class.getName()).log(Level.SEVERE, null, ex);
    }
    t2.start();

  //
  public void run() {
    throw new UnsupportedOperationException("Not su..");
  }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-16T20:33:47.293

使用[`Thread.join()`](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#join())方法。从第二个线程，调用

```
firstThread.join(); 
```

还有一些可选的重载也会超时。`InterruptedException`如果您的第二个线程在第一个线程完成之前被中断，您需要处理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T20:34:25.903

您需要致电：

```
first_thread.join(); 
```

从第二个线程。

请参阅[Thread.join 文档](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.html#join())。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T21:22:52.043

只是为了涵盖所有基础知识，您也可以使用信号量。

在服务员

```
/* spawn thread */
/* Do interesting stuff */
sem.acquire(); 
```

在服务员

```
/* wake up in the world */
/* do intersting stuff */
sem.release(); 
```

如果服务员只是要终止，这种方法绝不是优越的，但信号量很有趣，所以我认为值得一提。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T20:39:54.347

除非您的第一个线程与第二个线程同时做一些有用的事情，否则使用一个线程可能会更好。如果他们都在做一些有用的事情，请按照建议使用 join() 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T10:43:32.560

您也可以考虑使用[java.util.concurrent](http://java.sun.com/javase/6/docs/api/java/util/concurrent/package-summary.html)包。CountDownLatch 或 CyclicBarrier 可用于协调线程，而 Executors 非常适合管理并发任务。

# java - 如何在 Java 中将 DOM 节点从一个文档复制到另一个文档？

> ID：873247
> 
> 赞同：34
> 
> 时间：2009-05-16T20:35:58.693
> 
> 标签：java, api, dom, copy

我在将节点从一个文档复制到另一个文档时遇到问题。我已经使用了 Node 中的 adaptNode 和 importNode 方法，但它们不起作用。我也试过 appendChild 但这会引发异常。我正在使用 Xerces。这不是在那里实施的吗？还有另一种方法可以做到这一点吗？

```
List<Node> nodesToCopy = ...;
Document newDoc = ...;
for(Node n : nodesToCopy) {
    // this doesn't work
    newDoc.adoptChild(n);
    // neither does this
    //newDoc.importNode(n, true);
} 
```

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-05-17T00:12:25.007

问题是 Node 包含很多关于其上下文的内部状态，包括他们的父母身份和拥有他们的文档。既不`adoptChild()`也不`importNode()`将新节点放在目标文档中的任何位置，这就是您的代码失败的原因。

由于您想要复制节点而不是将其从一个文档移动到另一个文档，因此您需要采取三个不同的步骤......

1.  创建副本
2.  将复制的节点导入目标文档
3.  将副本放在新文档中的正确位置

```
for(Node n : nodesToCopy) {
    // Create a duplicate node
    Node newNode = n.cloneNode(true);
    // Transfer ownership of the new node into the destination document
    newDoc.adoptNode(newNode);
    // Make the new node an actual item in the target document
    newDoc.getDocumentElement().appendChild(newNode);
} 
```

Java 文档 API 允许您使用`importNode()`.

```
for(Node n : nodesToCopy) {
    // Create a duplicate node and transfer ownership of the
    // new node into the destination document
    Node newNode = newDoc.importNode(n, true);
    // Make the new node an actual item in the target document
    newDoc.getDocumentElement().appendChild(newNode);
} 
```

`true`参数 on`cloneNode()`并`importNode()`指定您是否需要深拷贝，即复制节点及其所有子节点。由于 99% 的时间你想要复制整个子树，你几乎总是希望这是真的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T20:40:06.890

采用Child 不会创建副本，它只是将节点移动到另一个父节点。

您可能需要 cloneNode() 方法。

# c# - 如何检查数据库是否存在？

> ID：873254
> 
> 赞同：5
> 
> 时间：2009-05-16T20:38:31.153
> 
> 标签：c#, sql, sql-server, database, connection-string

我想知道是否有一种优雅的方式来检查数据库是否存在？简而言之，如何测试数据库连接字符串的连接？

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-16T20:41:51.363

在连接字符串中设置`Initial Catalog=master`并执行：

```
select count(*) from sysdatabases where name = @name 
```

设置`@name`为数据库的名称。

如果您想检查整个连接字符串（而不是独立数据库的存在），请尝试在一个`try/catch`块中连接到它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-16T20:45:06.690

为了涵盖各种可能性（服务器不存在，数据库不存在，没有登录，没有权限，服务器关闭等） - 最简单的想法是简单地尝试正常连接，并执行一些微不足道的事情 -`SELECT GETDATE()`例如. 如果遇到异常，那就有问题了！

有时（尤其是在处理进程外系统时）`try/catch`是最实用的选择。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-16T20:44:17.643

您可以尝试连接到它。如果它抛出异常，那么连接字符串在某种程度上是错误的，或者数据库不存在，密码错误，或者其他什么。

```
DbConnection db = new SqlConnection(connection_string);
try
{
    db.Open();
}
catch ( SqlException e )
{
    // Cannot connect to database
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T20:43:35.133

只需尝试将 DBConnection.Open() 包裹在捕获 DBException 的 try 块中。

与您将找到的一样优雅的解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T21:08:58.800

尝试

```
IF NOT EXISTS(SELECT * FROM sys.databases WHERE [name] = @name)
   CREATE DATABASE @name;
GO 
```

或者

```
IF db_id(@name) IS NOT NULL
   CREATE DATABASE @name;
GO 
```

或[SqlConnection.ChangeDatabase(String)](http://msdn.microsoft.com/ru-ru/library/system.data.sqlclient.sqlconnection.changedatabase.aspx)。我认为它可以使用更少的 sql server 资源然后新的连接尝试。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-03-07T16:20:28.467

如果您正在使用实体框架或有它可供您使用，您可以简单地调用[Database.Exists()](https://msdn.microsoft.com/en-us/library/gg696588(v=vs.113).aspx)：

```
if (Database.Exists(connectionString))
{
    // do something
}
else
{
    // do something else
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-02-02T20:42:06.803

这就是我用 C# 验证是否存在任何 Postgres 数据库的方法：

```
private bool chkDBExists(string connectionStr, string dbname)
{
    using (NpgsqlConnection conn = new NpgsqlConnection(connectionStr))
    {
        using (NpgsqlCommand command = new NpgsqlCommand
            ($"SELECT DATNAME FROM pg_catalog.pg_database WHERE DATNAME = '{dbname}'", conn))
        {
            try
            {
                conn.Open();
                var i = command.ExecuteScalar();
                conn.Close();
                if (i.ToString().Equals(dbname)) //always 'true' (if it exists) or 'null' (if it doesn't)
                    return true;
                else return false;
            }
            catch (Exception e) { return false; }
        }
    }
} 
```

** try-catch 语句中使用的 if 可以简单地检查 ExecuteScalar 的返回对于不存在的 DB 是否为空，如果存在则不为空。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-02-16T04:30:54.487

您可以获取以下数据库列表并检查您的数据库名称：

```
USE master
GO  
SELECT name, database_id, create_date  
FROM sys.databases ;  
GO 
```

# sql - SQL Server：索引重建和索引重组有什么区别？

> ID：873263
> 
> 赞同：23
> 
> 时间：2009-05-16T20:41:08.120
> 
> 标签：sql, sql-server

索引重建和索引重组有什么区别？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-16T20:51:33.430

想想索引是如何实现的。它通常是某种树，例如 B+ 树或 B- 树。索引本身是通过查看数据中的键创建的，并构建树以便可以有效地搜索表。

当您*重组*索引时，您会遍历现有索引，清理已删除记录的块等。这*可以*在您进行删除时完成（并且在某些数据库中），但这会带来一些性能损失。相反，您单独执行它以便或多或少地执行批处理模式。

*重建*索引时，删除现有树并读取所有记录，直接从数据中构建新树。这为您提供了一个新的并且有望优化的树，它*可能*比重组表的结果更好；如果它以某种方式被损坏，它还可以让您重新生成树。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-16T21:20:36.543

`REBUILD`在整个操作期间锁定表（如果表很大，可能是几小时和几天）。

`REORGANIZE`不锁定表。

出色地。实际上，它在当前使用的页面上放置了一些临时锁，但是一旦操作完成，它们就会被删除（对于任何给定的锁来说，这只是几分之一秒）。

如前所述`@Andomar`，有`REBUILD`一个在线索引选项，它创建新索引，当操作完成时，只需用新索引替换旧索引。

这当然意味着您应该有足够的空间来保存索引的旧副本和新副本。

`REBUILD`也是一种`DML`更改系统表、影响统计信息、启用禁用索引等的操作。

`REORGANIZE`是一个纯粹的清理操作，它使所有系统状态保持原样。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-16T20:48:35.013

有许多不同之处。基本上，重建是对索引的完全重建——它将建立一个新的索引，然后删除现有的索引，而重新组织它会很简单，嗯……它会*重新组织*它。

[我不久前看到的这篇](http://decipherinfosys.wordpress.com/2008/02/07/index-rebuilding-vs-index-reorganizing-in-sql-server-2005/)博文将比我能更好地解释它。:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-26T22:34:32.993

重建它删除当前索引并重新创建新索引。

重组就像用你已经拥有的东西来整理房子。

使用 30% 的碎片来确定重建与重组是一个很好的做法。

<30% 重组 vs. >30% 重建

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T21:01:37.523

“重组索引”是对 B 树（实际上是数据页）的“叶级”进行清理、组织和碎片整理的过程。

重建索引是改变整个 B 树，重建索引。

建议在索引碎片从 10% 到 40% 时进行索引重组；如果索引碎片大于 40%，最好重建它。

重建索引会占用更多资源、产生锁并降低性能（如果您选择保持表在线）。因此，您需要为该过程找到合适的时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-14T19:40:23.073

除了上述差异（基本上，rebuild 将重新创建索引，然后将其“交换”为现有索引，而不是尝试修复现有索引），一个重要的考虑因素是重建 - 甚至是 Enterprise ONLINE 重建- 会干扰快照隔离事务。

TX1 启动快照事务
TX1 从 T 读取

TX2 在 T 上重建索引
TX2 重建完成

TX1 再次从 T 中读取：

> 错误 3961，数据库中的快照隔离事务失败，因为自该事务开始以来，该语句访问的对象已被另一个并发事务中的 DDL 语句修改。这是不允许的，因为元数据没有版本化。如果与快照隔离混合，对元数据的并发更新可能会导致不一致。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-10-22T06:51:23.987

重建索引 - 为指定数据库中的表重建一个或多个索引。

Reorganize index - 对指定表的聚集索引和二级索引进行碎片整理

# c# - 有没有办法在 C# 中对 2 个 IEnumerable 中的每个元素对进行 foreach？

> ID：873267
> 
> 赞同：2
> 
> 时间：2009-05-16T20:43:13.497
> 
> 标签：c#, foreach, ienumerable

我可以将它们转换为列表并使用带有索引的常规 for 循环，但我想知道是否有办法将它们保持为 IEnumerables。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T20:47:23.067

我认为您想要 .NET 4.0 的新 Zip 功能。Eric Lippert[最近发表了一篇关于它的博客，](http://blogs.msdn.com/ericlippert/archive/2009/05/07/zip-me-up.aspx)并包含了一个简单的实现形式。

它也在[MoreLINQ](http://code.google.com/p/morelinq)的[Zip.cs](http://code.google.com/p/morelinq/source/browse/trunk/MoreLinq/Zip.cs)中，如果序列的长度不同，它允许使用不同的选项。“默认”是像 .NET 4.0 一样，当任一序列用完元素时停止。替代方法是填充较短的序列或抛出异常。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-16T20:48:03.720

默认情况下没有办法，但添加扩展方法使其更容易一点并不难。为了简洁起见，我排除了一些错误检查以确保它们的长度相同。

```
public static void ForEachPair<T1,T2>(
  this IEnumerable<T1> source1, 
  IEnumerable<T2> source2,
  Action<T1,T2> del) {
  using ( var e1 = source1.GetEnumerator() )
  using ( var e2 = source2.GetEnumerator() ) {
    while ( e1.MoveNext() && e2.MoveNext() ) {
      del(e1.Current, e2.Current);
    }
  }
} 
```

现在您可以执行以下操作

```
var list = GetSomeList();
var otherList = GetSomeOtherList();
list.ForEachPair(otherList, (x,y) => 
{
   // Loop code here
}); 
```

# wpf - 设计器拒绝 DataTemplate.DataType

> ID：873270
> 
> 赞同：1
> 
> 时间：2009-05-16T20:43:56.117
> 
> 标签：wpf, datatemplate

我正在尝试将一些 WPF 安装到我当前的 Windows 窗体应用程序中。当我使用这个简单的用户控件时，该控件的设计器不会重新加载。

这只发生在此应用程序中。如果我创建一个干净的 Windows 窗体项目，添加这些文件，设计器工作正常。

我已经尝试重新加载 Visual Studio，并清理/重建应用程序。

有任何想法吗？（这些用于 ListBox 中的项目，因此 x:Key 不是一个选项。）

PS我如何摆脱代码清单中所有那些尾随的空白行？

细节：

我的类.cs

```
namespace MyNamespace {
  internal class MyClassInternal {}
  public class MyClassPublic {}
} 
```

MyUserControl.xaml

```
<UserControl x:Class="MyNamespace.MyUserControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:MyNamespace"         
    Height="300" Width="300">

    <UserControl.Resources>
        <DataTemplate DataType="{x:Type local:MyClassInternal}"/> <!--OK-->

        <ObjectDataProvider x:Key="ClassPublicKey" ObjectType="{x:Type local:MyClassPublic}"/> <!--OK--> 

        <!-- Type reference cannot find public type named 'MyClassPublic' -->
       <DataTemplate DataType="{x:Type local:MyClassPublic}"/> <!--FAILS-->
    </UserControl.Resources>

    <TextBlock>Hello World</TextBlock>
</UserControl> 
```

MyUserControl.xaml.cs

```
using System.Windows.Controls;

namespace MyNamespace {
    public partial class MyUserControl :UserControl {
        public MyUserControl() {
            InitializeComponent();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T18:41:22.923

这是由于程序集名称中有空格引起的。

# c# - IpEndPoint 问题

> ID：873274
> 
> 赞同：0
> 
> 时间：2009-05-16T20:44:51.947
> 
> 标签：c#, .net, sockets

c#中的程序：

```
 private void listBox1_Click(object sender, EventArgs e)
  {
        String data = (String)this.listBox1.SelectedItem;
        data = data.TrimEnd(new char[] { '\r', '\n' });

        try
        {
            ip = Dns.GetHostAddresses(data);
        }
        catch (SocketException ex)
        {
            MessageBox.Show(ex.ErrorCode.ToString());
        }

        clientIP = new IPEndPoint(ip[0], 6000);

        newSock.Bind(clientIP);
        newSock.Listen(100);

        resetEvent.Set();
    } 
```

在上面的代码中，我获得了列表框中显示的远程主机的 IP 地址，因此为了开始接受消息需要创建一个`IPEndPoint`( `clientIP`)。

`newSock`是一个套接字类型的变量，初始化为：

```
newSock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp); 
```

问题出在我将套接字 newSock 绑定到 IPEndPoint clientIP 的行中，我收到一个错误，说它是一个无效的地址。但是，为了进行交叉检查，我尝试在正确执行的消息框中显示 ip 地址。那么究竟出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T20:52:39.543

您不应该将套接字绑定到远程主机地址。它用于指示您应该监听哪个入站 IP 地址。您应该指定您自己的一个 IP 地址（如果您只想侦听单个 IP）或指定`IPAddress.Any`(0.0.0.0) 以侦听您拥有的所有 IP 地址。

顺便说一句，如果你想连接到远程地址，你根本不应该使用`Bind`。您只需使用该`Connect`方法

# c# - 图像处理技术——直接操纵目标图像还是虚拟化？

> ID：873278
> 
> 赞同：2
> 
> 时间：2009-05-16T20:47:20.193
> 
> 标签：c#, image-processing, gdi+

我需要将在地理坐标系中引用的一系列 ariel 图像重新投影到 UTM 投影中。我读过使用 getPixel 和 setPixel 可能会很慢 - 应该设置一系列二维数组以进行中间访问，然后在完成后将值刷新到目标图像。

这种图像处理通常是由专业人员完成的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T21:06:57.463

大多数图像处理是特征检测、场景分割、故障查找、分类和跟踪....

你可能想看看这本书：

1.  C 中的图像处理（也适用于其他语言）
2.  图像处理-原理与应用

其中描述了许多图像转换的许多快速有效的手段。这两本书在我处理图像时帮助了我:)

如果我理解您的问题......如果您正在重新对齐或组装许多图像，并且您没有方向和位置，您可以使用这些算法重新对齐边缘和共同特征。如果您是按位置拼接，那么这些算法将有助于重新采样/调整图像大小，以便更有效地组装。还有一些用于这类事情的开源库。（想到 OpenCV）

**编辑**：如果我基于位置转换将大图像重新投影到新的投影中（并且它是动态的，而不是静态的），我会考虑构建一个按需应用程序，该应用程序将根据所需的分辨率和所需的位置重构图像。然后，应用程序可以提取相关邻域图像的最接近分辨率并提供所需分辨率的结果。

没有更多背景，我希望这会有所帮助！

**编辑 2**：来自以下答案的评论：取决于图像。如果它们是固定大小的，那么数组可能会很好。如果它们有所不同，那么最好实现一个使用相对采样/平均来提供 get/setpixel 以匹配不同分辨率的图像的系统？

我不知道您正在使用的图像的来龙去脉以及您在做什么，但通常**抽象“像素”是什么**而不是访问数组中的值是有用的。通过这种方式，您可以在后端实现转换、采样、旋转、校正算法。像 GetVPixel() 或 SetVPixel()。这在处理多个不同的 res/format 图像时可能更有用。喜欢

```
SetVPixel(img1, coord1, GetVPixel(img2, coord2)) 
```

显然以 OOP/C# 方式。img1 和 img2 在大小、分辨率、地理位置、对齐方式或其他任何方面都可以不同，前提是您的后端能够同时理解这两者。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T21:28:24.667

如果您不介意使用不安全的代码，您可以将 Bitmap 的 BitmapData 包装在一个允许您有效获取和设置像素的对象中。下面的代码主要取自[gaussian blur filter](http://www.cnblogs.com/dah/archive/2007/03/30/694527.html)，我自己做了一些修改。如果您的位图格式不同，这不是最灵活的代码，但我希望它能说明如何更有效地操作位图。

```
public unsafe class RawBitmap : IDisposable
{
    private BitmapData _bitmapData;
    private byte* _begin;

    public RawBitmap(Bitmap originBitmap)
    {
        OriginBitmap = originBitmap;
        _bitmapData = OriginBitmap.LockBits(new Rectangle(0, 0, OriginBitmap.Width, OriginBitmap.Height), ImageLockMode.ReadWrite, PixelFormat.Format24bppRgb);
        _begin = (byte*)(void*)_bitmapData.Scan0;
    }

    #region IDisposable Members

    public void Dispose()
    {
        OriginBitmap.UnlockBits(_bitmapData);
    }

    #endregion

    public unsafe byte* Begin
    {
        get { return _begin; }
    }

    public unsafe byte* this[int x, int y]
    {
        get
        {
            return _begin + y * (_bitmapData.Stride) + x * 3;
        }
    }

    public unsafe byte* this[int x, int y, int offset]
    {
        get
        {
            return _begin + y * (_bitmapData.Stride) + x * 3 + offset;
        }
    }

    public unsafe void SetColor(int x, int y, Color color)
    {
        byte* p = this[x, y];
        p[0] = color.B;
        p[1] = color.G;
        p[2] = color.R;
    }

    public unsafe Color GetColor(int x, int y)
    {
        byte* p = this[x, y];

        return new Color
        (
            p[2],
            p[1],
            p[0]
        );
    }

    public int Stride
    {
        get { return _bitmapData.Stride; }
    }

    public int Width
    {
        get { return _bitmapData.Width; }
    }

    public int Height
    {
        get { return _bitmapData.Height; }
    }

    public int GetOffset()
    {
        return _bitmapData.Stride - _bitmapData.Width * 3;
    }

    public Bitmap OriginBitmap { get; private set; }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T00:26:51.680

FreeImage 库非常快，并提供了可能有用的剪切和粘贴功能。该发行版带有一个 C# 包装器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T21:10:52.167

AFAIK GetPixel/SetPixel 的开销是对它的调用，当访问数组时没有调用，因此开销更少。

您应该从 GetPixel/SetPixel 开始，您可以随时覆盖这些调用以使用直接数据访问。

# macos - 用于 NXT 的智能手机

> ID：873295
> 
> 赞同：1
> 
> 时间：2009-05-16T20:53:59.383
> 
> 标签：macos, java-me, bluetooth, smartphone

问候。

我将得到一部新的智能手机来工作。它需要[与 Telus 一起使用](http://www.tphones.ca/digital-pcs/blackberry-pdas/)，因此 iPhone 和基于 Android 的手机都已淘汰。可用的手机似乎包括许多黑莓手机、HTC 手机、摩托罗拉手机以及 LG、三星和中兴手机。

我有一个 LEGO Mindstorms NXT 机器人，我想要一部手机，我可以为它编写一个程序，通过蓝牙与它通信。（[乐高确实提供了一个手机应用程序](http://mindstorms.lego.com/Overview/Mobile%20Application.aspx)，但它只适用于一些诺基亚、索尼爱立信和明基西门子手机）。

从我目前的研究来看，听起来很多手机都支持 J2ME，我可以安装 NetBeans 来为它开发。（我已经很多年没有用 Java 编程了。）不幸的是，听起来即使手机确实具有蓝牙功能，也不一定可以从 J2ME 访问它们。

最后，我宁愿从我的 Mac 上进行开发。（我可以启动到另一个操作系统或启动一个 VM，但我不希望这样做。） [NetBean 的 IDE 下载页面](http://www.netbeans.org/downloads/index.html)说，“Java ME 仅适用于 Windows 和 Linux。” 似乎有一些变通方法——工作环境是否令人愉快？

所以，我的问题是，有谁知道这些手机中的任何一款是否适合开发一个简单的蓝牙应用程序，最好是从 Mac 上开发？

*- 编辑 -*

事实证明，我的合同还没有到期，我已经用我们身边的 Treo 700 替换了我的部分功能手机。我很感激所有的答案。我开始建立一个 J2ME 环境（直到我知道我也可以建立一个 Palm 环境，并且已经开始着手了。）不过，当我得到一部新手机时，我肯定在看 S60 手机——哎呀，它甚至可能胜过 iPhone 或 Android 手机，至少是为了便于创建爱好应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T21:20:24.233

诺基亚[将 python 移植](http://opensource.nokia.com/projects/pythonfors60/)到 S60 智能手机平台。这意味着您可以使用自己喜欢的文本编辑器编写 python 脚本，然后在[这些手机中的任何一款](http://www.s60.com/life/s60phones/browseDevices.do)上运行它们。python 端口包括用于相机、蓝牙、SMS、拨号、声音、文本到语音合成、定位服务的 API...

我发现在我的手机上安装 python 解释器和控制台并立即开始运行脚本非常容易，不需要其他工具。如果您有强壮的拇指并且喜欢挑战，那么您甚至可以直接在手机上编写脚本 :-)

如果您想在您的 PC 上运行 S60 手机仿真，那么您将需要 windows，即使这样设置起来也很复杂。不过，对于小型爱好项目，您可以在没有模拟器的情况下生活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T21:21:40.643

您可以尝试以下组合在 Mac OS X 上进行 J2ME 开发

1.  日食 - [http://www.eclipse.org/](http://www.eclipse.org/)
2.  EclipseME - [http://eclipseme.org/](http://eclipseme.org/)
3.  MPowerPlayer - [http://mpowerplayer.com/sdk](http://mpowerplayer.com/sdk)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-07T02:06:13.907

您可能对此应用程序[NXT Director](http://www.razix.com/nxtdirector.htm)感兴趣。作者说它已经用以下型号的 Palm 设备进行了测试，Treo 650、LifeDrive、Zire72、SONY TH55/E 和 Tungsten 系列。它也可能适用于您的 700。

# java - C 的 printf %g 格式说明符的 Java 等价物是什么？

> ID：873298
> 
> 赞同：9
> 
> 时间：2009-05-16T20:57:26.100
> 
> 标签：java, c, printf, formatter

我尝试使用 Formatter.format，但这似乎将尾数留在尾数为 0 的数字上，而 C 版本则没有。Java中是否有相当于C的 %g 格式说明符，如果没有，有没有办法伪造它？出于兼容性原因，我的意图是保留尾数与 C 完全相同。

foo.c

```
#include <stdio.h>

int main (int argc, char const *argv[])
{
    printf("%g\n", 1.0);
    return 0;
} 
```

主.java

```
class Main {
        public static void main(String[] args) {
                System.out.printf("%g\n", 1.0);
        }
} 
```

安慰：

```
$ javac Main.java && java Main
1.00000
$ gcc foo.c && ./a.out
1 
```

类似地，以 1.2 作为输入，尾数在 Java 版本中更长

```
$ javac Main.java && java Main
1.20000
$ gcc foo.c && ./a.out
1.2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T22:30:07.560

**编辑**：如果指数为 17 位，此代码会导致小数部分丢失，因为我误解了 String.format 如何格式化这些数字。所以请不要使用此代码：P

感谢您的输入，伙计们。我找不到配置 DecimalFormat 或 NumberFormat 以完全克隆功能的方法，但似乎这种方法有效（后面有一个示例）：

```
String.format("%.17g", x).replaceFirst("\\.?0+(e|$)", "$1"); 
```

主程序

```
#include <stdio.h>

int main (int argc, char const *argv[])
{
    printf("%.*g\n", 17, -0.0);
    printf("%.*g\n", 17, 0.0);
    printf("%.*g\n", 17, 1.0);
    printf("%.*g\n", 17, 1.2);
    printf("%.*g\n", 17, 0.0000000123456789);
    printf("%.*g\n", 17, 1234567890000000.0);
    printf("%.*g\n", 17, 0.0000000123456789012345678);
    printf("%.*g\n", 17, 1234567890123456780000000.0);
    return 0;
} 
```

主.java

```
class Main {
        public static String formatDouble(double x) {
                return String.format("%.17g", x).replaceFirst("\\.?0+(e|$)", "$1");
        }

        public static void main(String[] args) {
                System.out.println(formatDouble(-0.0));
                System.out.println(formatDouble(0.0));
                System.out.println(formatDouble(1.0));
                System.out.println(formatDouble(1.2));
                System.out.println(formatDouble(0.0000000123456789));
                System.out.println(formatDouble(1234567890000000.0));
                System.out.println(formatDouble(0.0000000123456789012345678));
                System.out.println(formatDouble(1234567890123456780000000.0));
        }
} 
```

及其输出：

```
$ gcc foo.c && ./a.out
-0
0
1
1.2
1.23456789e-08
1234567890000000
1.2345678901234567e-08
1.2345678901234568e+24
$ javac Main.java && java Main
-0
0
1
1.2
1.23456789e-08
1234567890000000
1.2345678901234567e-08
1.2345678901234568e+24

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T21:08:26.057

您是否尝试过[java.text.DecimalFormat](http://java.sun.com/javase/6/docs/api/java/text/DecimalFormat.html)类？

```
System.out.println(new DecimalFormat().format(1.0)); 
```

输出：

```
1 
```

然而：

```
System.out.println(new DecimalFormat().format(1.2)); 
```

输出：

```
1.2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T21:07:50.240

您可以使用[NumberFormat](http://java.sun.com/j2se/1.5.0/docs/api/java/text/NumberFormat.html)。通过将最小小数位数设置为 0，但让最大值更大，它应该可以满足您的要求。

它不像 printf 那样简单，但它应该可以工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T21:04:56.550

好吧，你可以指定你想要的位数：“%.2g”将 1.2 显示为 1.20

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-29T13:19:15.173

请注意，使用

```
String.format("%.17g", x).replaceFirst("\\.?0+(e|$)", "$1") 
```

1.2345e-20 失败（从末尾去掉零，产生 1.2345e-2）。这是我最终在代码中使用的内容：

```
String.format(Locale.US, "%.6g", x).replaceFirst("\\.0+(e|$)", "$1").replaceFirst("(\\.[0-9]*[1-9])(0+)(e|$)", "$1$3") 
```

基本上我修改了表达式以确保仅删除小数部分末尾的零并将其分为两种情况。但感谢您为我指明了正确的方向。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-12T02:00:54.103

以上解决方案都不是完美的。在某些情况下，这里和那里有很多问题。所以我创建了一个小型库 Double2String 来解决这个特定问题：

[https://github.com/coconut2015/double2string](https://github.com/coconut2015/double2string)

# coordinate-systems - 如何将（x，y）坐标归因于文本？

> ID：873312
> 
> 赞同：0
> 
> 时间：2009-05-16T21:08:10.130
> 
> 标签：coordinate-systems

问候，有没有人对我如何可以提出建议，a）在网格上映射文本（我想象的是一个笛卡尔系统，其中每个字符都有一个（x，y）坐标，或者 b）如果网格是不可能的，以某种方式测量文本的 i) 字符位置、一个文本位置与另一个 x2-x1 水平之间的差异 (delta) 或一个文本位置与另一个垂直 y2-y1 之间的差异？我在 PC 上，需要建议的编程方法或程序建议（是否有任何人都知道的具有此功能的基于 PC 的文本程序）？非常感谢，c~tea

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-02-28T21:13:17.890

在没有定义的编程语言的情况下，我建议[PostScript](http://en.wikipedia.org/wiki/PostScript)。

PostScript 是一种页面描述语言，具有您所要求的功能。许多印刷商直接理解它，其余的则有口译员。它也是PDF文件格式的基础。在维基百科页面上是一个演示坐标系使用的示例：

```
%!PS
/Courier             % name the desired font
20 selectfont        % choose the size in points and establish 
                     % the font as the current one
72 500 moveto        % position the current point at 
                     % coordinates 72, 500 (the origin is at the 
                     % lower-left corner of the page)
(Hello world!) show  % stroke the text in parentheses
showpage             % print all on the page 
```

坐标系的原点位于左下角，以点为单位（1/72 英寸）

# php - 徽章系统和存储条件作为变量？

> ID：873316
> 
> 赞同：2
> 
> 时间：2009-05-16T21:09:55.960
> 
> 标签：php, mysql, variables, conditional-statements, badge

我正在尝试编写一段代码来检查用户统计信息，无论是他们的积分、排名还是 num_friends，然后再授予他们类似于 SO 中使用的徽章。系统设置为当用户完成任务（投票、评论等）时，他们的 user_id 会被记录并排队等待 cron 作业以 5 分钟的间隔进行评估。这是最有效的方法吗？我看到了另一篇关于徽章的帖子，但不确定这是否是被选为首选方式的方法。

我的另一个问题是关于实际检查用户的这些变量（点数、排名、num_friends）。我有许多徽章，并希望允许管理员在他们选择变量、运算符（==、>= 等）及其设置的值的位置添加自己的徽章。如何在 IF 条件语句中评估它？我尝试将 SWITCH 用于运算符，但无法正确评估变量，例如：

```
function checkbadges($userid,$points,$rank,$friends){
    global $database;

    $q = $database->db_query("SELECT * FROM badges");
    while($bq = $database->db_fetch_assoc($q)) {
        switch($bq[badge_sign]) {
          case "1":
              if($bq[badge_var] == $bq[badge_value])
                  givebadge($userid, $bq[badge_id]);
            break;
          case "2":
              if($bq[badge_var] >= $bq[badge_value]))
                  givebadge($userid, $bq[badge_id]);
            break;
          case "3":
              if($bq[badge_var] <= $bq[badge_value]))
                  givebadge($userid, $bq[badge_id]);
            break;
          case "4":
              if($bq[badge_var] != $bq[badge_value]))
                  givebadge($userid, $bq[badge_id]);
            break;
        }
    }
} 
```

我想我必须使用 eval() 但我不确定如何，任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T17:42:44.473

如果`$bq['badge_var']`是一个字符串，它是当前范围内的有效变量名，您可以这样做：

```
$value = ${ $bq['badge_var'] }; 
```

如果您将数组传递给，它可能更安全、更容易扩展`checkbadges()`：

```
function checkbadges($userid,$userdata){
    global $database;
    $q = $database->db_query("SELECT * FROM badges");
    while($bq = $database->db_fetch_assoc($q)) {
        $currentValue = $userdata[ $db['badge_var'] ];
        $requiredValue = $db['badge_value'];
        $issueBadge = false;
        switch($bq['badge_sign']) {
          case "1":
              $issueBadge = ( $currentValue == $requiredValue );  
          break;
          case "2":
              $issueBadge = ( $currentValue >= $requiredValue );  
            break;
          case "3":
              $issueBadge = ( $currentValue <= $requiredValue );  
            break;
          case "4":
              $issueBadge = ( $currentValue != $requiredValue );  
          break;
        }

        if ($issueBadge) {
            givebadge($userid, $bq['badge_id']);
        }
    }
} 
```

`$userdata`像这样的东西在哪里：

```
array( 'points' => 1 , 'friends' => 10, 'rank' => 10 ); 
```

然后，您可以在不修改函数的情况下扩展可用变量

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T23:25:52.310

您没有得到正确值的变量的期望值和观察值是哪个？

此外，更好的做法是使用：

```
$arr['key'] 
```

代替

```
$arr[key] 
```

因为 PHP 将首先将其评估为常量，这是不好的做法，请参阅[PHP 参考：数组](http://us2.php.net/manual/en/language.types.array.php)

# web-services - 更改 asp.net 2 Web 服务地址

> ID：873317
> 
> 赞同：0
> 
> 时间：2009-05-16T21:10:19.873
> 
> 标签：web-services, asp.net-2.0

我正在开发一个包含 Web 服务的应用程序，在开发时我在我的电脑上本地运行该服务，而不是将服务发布到远程服务器，我想知道如何获取我获得的 Web 参考并进行更改远程服务器的服务地址，以检查一切是否正常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T21:12:51.380

右键单击您的 Web 引用，单击属性，然后选择 URL 行为：在属性窗口中动态。Web 服务的 URL 将自动映射到 `Web.config`文件中的配置选项，您可以轻松更改，无需重新编译：

[![截屏](https://i.stack.imgur.com/mAKOT.jpg)](https://i.stack.imgur.com/mAKOT.jpg)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T21:14:51.253

您可以使用 Url 属性设置服务 URL：

```
MyWebService.Service1 service = new MyWebService.Service1();
service.Url = NEWSERVICEURL; 
```

# iphone - 最近的搜索结果加入核心数据

> ID：873321
> 
> 赞同：0
> 
> 时间：2009-05-16T21:11:48.327
> 
> 标签：iphone, core-data

这是上一篇关于使用 Core Data[保存最近搜索](https://stackoverflow.com/questions/860253/recent-searches-with-core-data "保存最近的搜索")的帖子的后续问题。

为了对搜索结果进行分组，我有一个条目实体和历史实体。Entry.history 是与 History 的关系。History.entries 是与 Entry 的一对多关系（Entry.history 的逆）。历史有一个日期属性 createdAt。我试图弄清楚如何在 NSFetchedResultsController 中获取属于最新历史实体的所有条目实体。

我可以像这样获得最新的历史实体

```
 NSFetchRequest *request = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"History" inManagedObjectContext:context];
    [request setEntity:entity];
    NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"createdAt" ascending:NO];
    NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptor, nil];
    [request setSortDescriptors:sortDescriptors];
    [request setFetchLimit:1];
    NSArray *results = [context executeFetchRequest:request error:&error];
    History *history = (History *)[results objectAtIndex:0]; 
```

然后 NSFetchedResultsController 中的 Entry 实体就像这样

```
 NSPredicate *predicate = [NSPredicate predicateWithFormat:@"history == %@", history];
    request = [[NSFetchRequest alloc] init];
    entity = [NSEntityDescription entityForName:@"Entry" inManagedObjectContext:context];
    [request setEntity:entity];
    [request setPredicate:predicate];
    fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request managedObjectContext:context sectionNameKeyPath:nil cacheName:@"Root"];
```

但我想在一个请求中做到这一点。请注意，我只关心 fetchedResultsController 存储条目结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-20T06:51:26.890

您应该能够拥有一个遵循关系的排序描述符：

```
NSFetchRequest *request = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Entry" 
                                          inManagedObjectContext:context];
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] 
                                    initWithKey:@"history.createdAt"
                                      ascending:NO];
NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:&sortDescriptor
                                                      count:1];
[request setEntity:entity];
[request setSortDescriptors:sortDescriptors];
[request setFetchLimit:1];
fetchedResultsController = [[NSFetchedResultsController alloc]
                            initWithFetchRequest:request
                            managedObjectContext:context 
                              sectionNameKeyPath:nil 
                                       cacheName:@"Root"]; 
```

# python - Python在列表中选择最长字符串的最有效方法？

> ID：873327
> 
> 赞同：287
> 
> 时间：2009-05-16T21:15:30.987
> 
> 标签：python, list, list-comprehension

我有一个可变长度的列表，并试图找到一种方法来测试当前正在评估的列表项是否是列表中包含的最长字符串。我正在使用 Python 2.6.1

例如：

```
mylist = ['abc','abcdef','abcd']

for each in mylist:
    if condition1:
        do_something()
    elif ___________________: #else if each is the longest string contained in mylist:
        do_something_else() 
```

当然，我忽略了一个简短而优雅的简单列表理解？

* * *

## 回答 #1

> 赞同：707
> 
> 时间：2009-05-16T21:19:46.140

从[Python 文档](http://docs.python.org/whatsnew/2.5.html#other-language-changes)本身，您可以使用[`max`](http://docs.python.org/library/functions.html#max)：

```
>>> mylist = ['123','123456','1234']
>>> print max(mylist, key=len)
123456 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-12-14T23:26:45.433

```
def longestWord(some_list): 
    count = 0    #You set the count to 0
    for i in some_list: # Go through the whole list
        if len(i) > count: #Checking for the longest word(string)
            count = len(i)
            word = i
    return ("the longest string is " + word) 
```

或者更容易：

```
max(some_list , key = len) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-16T21:22:37.817

如果有超过 1 个最长的字符串（想想 '12' 和 '01'）会发生什么？

尝试获得最长的元素

```
max_length,longest_element = max([(len(x),x) for x in ('a','b','aa')]) 
```

然后定期 foreach

```
for st in mylist:
    if len(st)==max_length:... 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-16T21:20:36.993

`len(each) == max(len(x) for x in myList)`要不就`each == max(myList, key=len)`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-16T21:20:49.180

要获取列表中的最小或最大项目，请使用内置的 min 和 max 函数：

```
 lo = min(L)
 hi = max(L) 
```

与排序一样，您可以传入一个“键”参数，用于在比较列表项之前对其进行映射：

```
 lo = min(L, key=int)
 hi = max(L, key=int) 
```

[http://effbot.org/zone/python-list.htm](http://effbot.org/zone/python-list.htm)

如果您正确地将其映射为字符串并将其用作比较，则看起来您可以使用 max 函数。当然，我建议只找到最大值一次，而不是列表中的每个元素。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-21T23:21:47.587

```
def LongestEntry(lstName):
  totalEntries = len(lstName)
  currentEntry = 0
  longestLength = 0
  while currentEntry < totalEntries:
    thisEntry = len(str(lstName[currentEntry]))
    if int(thisEntry) > int(longestLength):
      longestLength = thisEntry
      longestEntry = currentEntry
    currentEntry += 1
  return longestLength 
```

# python - 如何在 gtk.ComboBoxEntry 中放置滚动条？

> ID：873328
> 
> 赞同：2
> 
> 时间：2009-05-16T21:15:53.277
> 
> 标签：python, user-interface, pygtk

我有一个包含超过一百个条目的组合框，如果没有滚动条，浏览起来非常尴尬。

[替代文字 http://img211.imageshack.us/img211/6972/screenshotprubapy.png](http://img211.imageshack.us/img211/6972/screenshotprubapy.png)

我想做的正是图片中的内容。使用右侧的滚动条，这样在条目中移动会更容易。我使用 gtk.Combo 来制作该示例，但问题是已弃用。

我需要一个例子来说明你将如何做这**正是**图片。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T12:06:32.093

```
import pygtk
import gtk
import gobject

def window_delete_event(*args):
    return False

def window_destroy(*args):
    gtk.main_quit()

if __name__ == '__main__':
    win = gtk.Window()

    # combo's model
    model = gtk.ListStore(gobject.TYPE_STRING)
    for n in xrange(100):
        model.append([str(n)])

    # combo
    combo = gtk.ComboBoxEntry(model)
    win.add(combo)

    # combo's style
    style = gtk.rc_parse_string('''
        style "my-style" { GtkComboBox::appears-as-list = 1 }
        widget "*.mycombo" style "my-style"
    ''')
    combo.set_name('mycombo')
    combo.set_style(style)

    win.show_all()
    win.connect('delete-event', window_delete_event)
    win.connect('destroy', window_destroy)
    gtk.main() 
```

# scalability - 规划可扩展的 Web 应用程序开发

> ID：873329
> 
> 赞同：8
> 
> 时间：2009-05-16T21:15:56.680
> 
> 标签：scalability, scaling, web-applications

在开始开发可扩展的 Web 应用程序之前，应该考虑哪些语言、框架和托管？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-16T23:54:49.183

最重要的考虑是不要过度设计，以至于它妨碍了构建和启动某些东西。分析瘫痪是生产力、进步和结果的最大阻碍。

是的，做一些计划。选择一个框架。完美的框架是不可能找到的，因为它不存在，部分原因是在构建它之前你不知道你需要什么。很有可能，如果你选择了一些东西，它会比什么都不选择要好。

是的，尝试选择灵活的、可互操作的工具来满足您的需求。

是的，在接下来的 6-18 个月内寻找一个好的内置功能集。无论如何，试图超越这一点并不现实，因为大多数项目在第一个版本之前都会发生很大变化。

所以，选择你喜欢的或熟悉的。不要随波逐流，做最好的结果，最快的，经常的。了解您将来可能必须做出改变。因此，无论您现在构建什么，都尝试使用单元测试，以便在需要时进行重构。

如果您正在构建的东西会非常成功，那么拥有它将是一个很大的问题，并且一旦赚钱就很容易工作，因为您将能够获得其他人才来帮助您。

分享您最终选择的内容以及您的情况的原因——这也有助于我们向您学习！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T23:46:46.643

不一定要将自己嫁给一种语言或框架。可能您网站的某些部分在不同的语言和框架下工作得比其他部分更好。例如，所有 37signals 的站点都基于 Ruby on Rails，但他们最近写了一篇博客文章，介绍现在如何用 Erlang 编写一个的底层技术，因为这样更容易实现并发性。

显然，事情会变得杂乱无章，但使用正确的工具来完成工作——即使这意味着不同的工具用于不同的工作——可以简化事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T21:30:30.107

首先在语言上，这在很大程度上无关紧要。PHP、Java 和 .Net 可能是最大的三个，它们都在 Web 上运行一些最大的站点，所以不要听任何人告诉你一个比其他任何一个更适合的人。

有些人可能还会将 Ruby 和 Django/Python 列入此列表。我没有反对他们，但我不知道有任何大型（比如前 50 个）网站使用它们。

托管注意事项取决于您想要启动多低，但基本上顺序是：

1.  共享;
2.  虚拟专用服务器；
3.  投入的。

与任何语言、框架或提供程序相比，可扩展性很大程度上与您的应用程序设计有关。高效的数据库模式、高效的 Javascript/CSS 交付和使用以及内存缓存都是任何语言或框架的共同问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T23:38:06.430

语言 - 我会推荐一些具有良好框架和良好测试库的东西，如 Perl 或 Java。

框架——这取决于你打算做什么。如果您从不允许 FastCGI 的主机开始，最好避免使用 Catalyst 或 Rails 等框架。这就是我喜欢 CGI::Application（主要是 Perl，但也移植到其他语言）的原因——它可以作为 CGI、FastCGI 或 mod_perl 运行。对于开发，它可以从它自己的 Web 服务器上运行。

托管 - 没有什么比您拥有服务器更好的了。它可以是您自己的服务器、租用的服务器或虚拟服务器。但是您可以从最便宜的托管开始，当您需要更多时，您应该能够负担得起。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T21:30:02.433

这取决于。

首先查看您的需求（功能性或用户定义）（非功能性 - 描述所需系统[链接文本](http://en.wikipedia.org/wiki/Non-functional_requirement)的方面）

接下来我将阐明拥有可扩展的 Web 应用程序意味着什么。将其定义为可以明确测试的测试用例（必须支持 X 页面浏览量/秒，响应时间 < Y 秒）。

一旦我有了这些部分，我会看看我的开发团队可以支持哪些类型的技能（对于初始项目和正在进行的维护）。然后找到一些使用类似语言或框架的野外应用程序案例研究。如果其他人已经制定了特定的语言/框架规模，那么您也很有可能也可以。

最后出去寻找一些支持您选择的语言、框架和要求的托管服务提供商。

# java - 建立预约网站的最简单方法是什么？

> ID：873330
> 
> 赞同：6
> 
> 时间：2009-05-16T21:16:05.087
> 
> 标签：java, web, calendar, google-calendar-api

我的妻子正在开展一项新业务，并希望我为她创建一个允许客户预约的网站。我显然可以继续从头开始构建一些东西，但鉴于这是一个相当标准的问题，我宁愿重用现有的解决方案（最好在 Java 中，但在这方面有一些灵活性）或构建在托管之上像谷歌日历这样的解决方案。你会推荐什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T21:21:23.530

[Google Calendar API](http://code.google.com/apis/calendar/)有大量工具。具体阅读[Google Calendar Developer's Guide](http://code.google.com/apis/calendar/docs/2.0/developers_guide_protocol.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T21:24:12.557

不要从头开始构建自己的；这是一个异常艰难的过程（如果您好奇，请查看 iCalendar 标准；其中涉及的复杂性惊人地大）。作为以前尝试从头开始开发此类东西的人，我强烈建议使用现有的托管解决方案，例如 Google 日历。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T05:51:49.700

在线预订系统比看起来要复杂得多。例如，您需要考虑防止双重预订。

您可以使用现有的在线预订系统，例如[www.EzyOnlineBookings.com](http://www.EzyOnlineBookings.com) ，而不是重新发明轮子。它价格便宜，足够灵活，可以处理大多数场景，而且看起来相当不错。此外，如果您的妻子更喜欢使用 Google 日历进行商务活动，它还可以直接与 Google 日历集成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-29T17:24:00.450

我刚刚制作了一个开源 Android 库来执行此操作，但转换为标准 Java 库非常简单。这是登陆页面： [https ://bitbucket.org/warwick/schedule_utils_demo/src/master/](https://bitbucket.org/warwick/schedule_utils_demo/src/master/)

该库支持根据计划项目、营业时间和给定时间计算实体下一次可用的时间。

它还有一种方法可以根据营业时间和日程安排项目获取给定时间之间的可用时段列表。您可以分叉存储库并将其重构为 JavaScript 或您想要的任何语言。

希望这可以帮助

# php - $_SESSION 问题

> ID：873339
> 
> 赞同：3
> 
> 时间：2009-05-16T21:21:11.767
> 
> 标签：php

我最近更改了我的编辑器以保存 int UTF-8。之后就开始跳出来了，不知道是什么意思。

```
Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at /home/sudancar/public_html/index.php:1) in /home/sudancar/public_html/index.php on line 1 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-16T21:25:18.607

您的编辑很可能写了一个 BOM（字节顺序标记）来表明该文件是 UTF-8。

因为该标记出现在任何`<?php`标记之前，PHP 会自动将其发送到浏览器，包括必要的标头。

除非您的 PHP 可以使用实验性 (--enable-zend-multibyte) 选项进行编译，否则无济于事。你只需要告诉你的编辑不要写那个标记。

供参考：[http ://bugs.php.net/bug.php?id=22108](http://bugs.php.net/bug.php?id=22108)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T21:24:42.617

您需要`session_start()`在任何输出发送到浏览器之前调用。

# c# - 如何在没有第三方库的情况下在 CF 2.0 中制作透明图像？

> ID：873343
> 
> 赞同：4
> 
> 时间：2009-05-16T21:22:04.213
> 
> 标签：c#, windows-mobile, compact-framework, bitmap, windows-ce

有没有办法让CF2.0中的图片透明？我必须在文本框上放置一个小图像，但它必须是透明的，以便用户无论如何都能看到文本。你有想法吗？

非常感谢你

twickl

编辑：

感谢您的回答，我会检查这些链接！为了完成我的帖子，这是我想要做的：

我想显示一个小图像（图像尚不存在，我必须制作 ist，所以我对所有格式完全开放），它是文本框右端的 X。通过单击 X，文本框内的文本将被删除……就像在 iPhone 上一样。但是我无法构建自己的控件，因为在我的项目中，有太多的 TextBoxes 已经是带有 windows TextBox 的自定义控件，因此将它们全部切换到自定义控件将需要大量的工作和测试。所以我想在文本框上方制作一个小面板、图片框等等。但它必须是透明的。操作系统是带有 CF 2.0 的 Windows CE 5.0。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T23:25:22.733

根据您需要的透明度，您可以选择以下任何选项：

1.) 如果您的图像具有应完全透明的特定部分，您可以使用[ImageAttributes.SetColorKey()](http://msdn.microsoft.com/en-us/library/b67599fw(VS.80).aspx)设置单个透明颜色，然后将其传递给 Graphics.DrawImage。您的图像需要有一种颜色（例如 Color.Cyan），该颜色将被绘制成完全透明的。

2.) 如果您希望整个图像部分透明，例如对于淡入/淡出效果，您可以 P/Invoke [AlphaBlend()](http://msdn.microsoft.com/en-us/library/aa920812.aspx)函数，如此[处所示](http://blogs.msdn.com/chrislorton/archive/2006/04/07/570649.aspx)。

3.) 如果你有一个内置了透明度信息的图片，例如一个透明的PNG图片，需要在各种背景颜色上渲染，这些之前的方法都行不通，你需要使用基于COM的[IImage](http://msdn.microsoft.com/en-us/library/aa915136.aspx)接口。.NETCF 的 COM 互操作记录在[此页面上](http://blogs.msdn.com/chrislorton/archive/2006/04/07/570649.aspx)（在该页面上搜索“IImage 接口”）。

选项 3 是最灵活的，但也涉及最多的实施工作。如果您跟进有关您想要透明绘制的图像类型和目标平台的更多信息，我们可能会提供更多帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T21:47:17.307

我通过从 PictureBox 派生一个类并处理 OnPaint 来做到这一点。关键是传递给 DrawImage 的 ImageAttributes 对象。我假设像素 0,0 是透明颜色，但您可以以不同的方式处理它。

```
public partial class TransparentPictureBox : PictureBox
{
    private Color tColor;

    public TransparentPictureBox()
    {
        InitializeComponent();
    }

    public new Image Image
    {
        get { return base.Image; }
        set
        {
            if (value == base.Image)
                return;

            if (value != null)
            {
                Bitmap bmp = new Bitmap(value);
                tColor = bmp.GetPixel(0, 0);
                this.Width = value.Width;
                this.Height = value.Height;
            }
            base.Image = value;
        }
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        e.Graphics.Clear(this.BackColor);

        if (Image == null)
            return;

        ImageAttributes attr = new ImageAttributes();

        // Set the transparency color.
        attr.SetColorKey(tColor, tColor);

        Rectangle dstRect = new Rectangle(0, 0, base.Image.Width, base.Image.Height);
        e.Graphics.DrawImage(base.Image, dstRect, 0, 0, base.Image.Width, base.Image.Height, GraphicsUnit.Pixel, attr);
    }
} 
```

# c++ - Qt Visual Studio 插件是 Qt Visual Studio 集成的子集吗？

> ID：873348
> 
> 赞同：3
> 
> 时间：2009-05-16T21:24:11.760
> 
> 标签：c++, visual-studio, qt

Qt 软件最近发布了 Qt Visual Studio Add-in。有谁知道，它是 Visual Studio 集成的一个子集，还是包含一些新的东西？有人尝试过吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T01:31:43.520

它是一个完整的替代品。

无需使用（商业）Visual Studio 集成。

我强烈建议切换到新的 Qt Visual Studio 插件，它最终以 1.0 版的形式提供。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T18:42:22.023

全面更换。

我注意到的唯一区别是 Qt 设计器在开源 (LGPL/GPL) 版本的新窗口中打开。在商业许可版本中，应该完全集成 Qt Designer。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T18:50:58.717

这是一个替代品，但有点不同。（它知道预编译的头文件！终于！）

# javascript - 如何从 iframe 访问主窗口元素

> ID：873350
> 
> 赞同：0
> 
> 时间：2009-05-16T21:24:18.797
> 
> 标签：javascript, jquery

我希望有人可以帮助解决这个问题。我有一个使用 lytebox 的弹出 iframe。我希望当我单击 iframe 中的链接时`mylink`，它会执行 AJAX 调用并`div`在我的主窗口中使用`id="mydiv"`. 我知道如何进行`onclick`事件和 ajax 调用，但我不知道如何`mydiv`从主窗口访问并使用内容更新它。对此的任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T21:27:03.953

您可以简单地使用`window.parent.document`从 iframe 访问父文档。

jQuery 允许您为搜索[指定上下文](http://docs.jquery.com/Core/jQuery#expressioncontext)，因此您可以执行以下操作：

```
$(myselector, window.parent.document); 
```

# asp.net-mvc - 如何使用 ASP.NET MVC 实现自定义缓存提供程序

> ID：873355
> 
> 赞同：15
> 
> 时间：2009-05-16T21:25:56.763
> 
> 标签：asp.net-mvc, caching, provider

我正在将[MonoRail](http://castleproject.org/monorail/index.html)应用程序迁移到[ASP.NET MVC 1.0](http://www.asp.net/mvc/)。在我的原始应用程序中，我编写了一个自定义缓存提供程序（使用[memcached](http://www.danga.com/memcached/)的分布式缓存提供程序）。在 MonoRail 中，这项任务非常简单，因为框架使用接口并且[ICacheProvider](http://api.castleproject.org/html/T_Castle_MonoRail_Framework_ICacheProvider.htm)看起来像这样：

```
public interface ICacheProvider : IProvider, IMRServiceEnabled
{
    void Delete(string key);
    object Get(string key);
    bool HasKey(string key);
    void Store(string key, object data);
} 
```

这个接口的一个实例在每个控制器动作中都可用。因此，我所要做的就是实现一个使用 memcached 的自定义缓存提供程序，并告诉 MonoRail 使用我的缓存提供程序而不是默认的提供程序。模拟和单元测试我的控制器也很容易。

在 ASP.NET MVC 1.0 中有 System.Web.Abstractions 程序集（名称看起来很有希望），它定义了这样的[HttpContextBase](http://msdn.microsoft.com/en-us/library/system.web.httpcontextbase.aspx)：

```
public abstract class HttpContextBase : IServiceProvider
{
    ... 
    public virtual System.Web.Caching.Cache Cache { get; }
    ...
} 
```

我不明白这里使用的 Cache 属性如何是缓存提供程序的抽象。它是传统的密封[缓存](http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx)类。似乎我不是唯一一个[努力模拟](http://www.lostechies.com/blogs/jimmy_bogard/archive/2008/10/29/testing-fun-with-asp-net-mvc.aspx)框架中的类的人。

我对 ASP.NET MVC 框架非常陌生，我一定在这里遗漏了一些东西。我可以编写一个使用我定义的 ICacheProvider 接口的 CustomBaseController，并且我的所有控制器都派生自这个基类，但是如果有更优雅的（ASP.NET MVCish）解决方案，我会很乐意实现它。我注意到 HttpContextBase 实现了[IServiceProvider](http://msdn.microsoft.com/en-us/library/system.iserviceprovider(VS.71).aspx)。[GetService](http://msdn.microsoft.com/en-us/library/system.iserviceprovider(VS.71).aspx)方法在哪里寻找服务？这很容易被嘲笑吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-17T18:58:02.320

缓存没有官方的抽象或提供者，但您可以轻松构建一个：

*   [http://weblogs.asp.net/zowens/archive/2008/08/04/cache-abstraction.aspx](http://weblogs.asp.net/zowens/archive/2008/08/04/cache-abstraction.aspx)
*   [http://memcachedproviders.codeplex.com/SourceControl/changeset/view/15983#58762](http://memcachedproviders.codeplex.com/SourceControl/changeset/view/15983#58762)

ASP.NET 4.0 包含一个[输出缓存提供程序抽象](http://weblogs.asp.net/scottgu/archive/2010/01/27/extensible-output-caching-with-asp-net-4-vs-2010-and-net-4-0-series.aspx)（AFAIK*不是*通用缓存抽象，但仅用于*输出*缓存）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T19:08:30.350

这个答案已经过时了。请参阅[ASP.NET 4.0：编写自定义输出缓存提供程序](http://weblogs.asp.net/gunnarpeipman/archive/2009/11/19/asp-net-4-0-writing-custom-output-cache-providers.aspx)。

# c++ - 为 C++ 函数编写包装器以使它们可以从 C 代码中使用的挑战

> ID：873356
> 
> 赞同：0
> 
> 时间：2009-05-16T21:26:09.960
> 
> 标签：c++, interface, unix

我现在正在为 C++ 函数编写包装器，以便可以从 C 代码中使用它们。

想法是使用 g++ 编译 cpp 文件，使用 gcc 编译 c 文件，然后将它们链接在一起（！），但仅将那些需要的函数公开给 C 程序，方法是使它们在头文件“test.txt”中可用。 h'（或者可能是 test.hpp？），像这样：

（注意我如何不公开函数'vector Tokenize(const string& str,const string& delimiters)'）

> 测试.h：

```
/* Header can be read by both C+ and C compilers, just the way we want! */
#ifndef TEST_H
#define TEST_H

#ifdef __cplusplus
extern "C" {
#endif

#if defined(__STDC__) || defined(__cplusplus)
 extern int TokenizeC(const char* text, const char* delim, char ***output);   /* ANSI C prototypes */
 extern void reclaim2D(char ***store, unsigned int itemCount);
#endif

#ifdef __cplusplus
}
#endif

#endif /* TEST_H */ 
```

> 测试.cpp：

```
#include <string>
#include <iostream>
#include <vector>

#include <assert.h>

#include "test.h"

using namespace std;

vector<string> Tokenize(const string& str,const string& delimiters)
{
 vector<string> tokens;

 string::size_type delimPos = 0, tokenPos = 0, pos = 0;

 if(str.length() < 1)  return tokens;

 while(1)
 {
   delimPos = str.find_first_of(delimiters, pos);
   tokenPos = str.find_first_not_of(delimiters, pos);

   if(string::npos != delimPos)
   {
     if(string::npos != tokenPos)
     {
       if(tokenPos < delimPos) tokens.push_back(str.substr(pos,delimPos-pos));
       else tokens.push_back("");
     }
     else tokens.push_back("");

     pos = delimPos + 1;
   }
   else
   {
     if(string::npos != tokenPos) tokens.push_back(str.substr(pos));
     else tokens.push_back("");
     break;
   }
 }

 return tokens;
}

int TokenizeC(const char* text, const char* delim, char ***output)
{
    if((*output) != NULL) return -1; /* I will allocate my own storage, and no one tells me how much. Free using reclaim2D */

    vector<string> s = Tokenize(text, delim);

    // There will always be a trailing element, that will be blank as we keep a trailing delimiter (correcting this issue would not be worth the time, so this is a quick workaround)
    assert(s.back().length() == 0); // This will be nop'ed in release build
    s.pop_back();

    (*output) = (char **)malloc(s.size() * sizeof(char *));

    for(vector <string>::size_type x = 0; x < s.size(); x++)
    {
        (*output)[x] = strdup(s[x].c_str());

        if(NULL == (*output)[x])
        {
            // Woops! Undo all
            // TODO : HOW to test this scenario?

            for(--x; x >= 0; --x)
            {
                free((*output)[x]);
                (*output)[x] = NULL;
            }

            return -2; 
        }
    }

    return x; /* Return the number of tokens if sucessful */
}

void reclaim2D(char ***store, unsigned int itemCount)
{
    for (int x = 0; itemCount < itemCount; ++x)
    {
        free((*store)[x]);
        (*store)[x] = NULL;
    }

    free((*store));
    (*store) = NULL;
} 
```

> poc.c:

```
#include <stdio.h>
#include "test.h"

int main()
{
    const char *text = "-2--4--6-7-8-9-10-11-", *delim = "-";

    char **output = NULL;

    int c = TokenizeC(text, delim, &output);

    printf("[*]%d\n", c);

    for (int x = 0; x < c; ++x)
    {
        printf("[*]%s\n", output[x]);
    }

    reclaim2D(&output, c);

    return 0;
} 
```

你注意到有什么不对吗？

对于初学者，当我运行这个程序时，我得到“不满意的代码符号'__gxx_personality_v0'”

值得庆幸的是，这里有一些东西：[__gxx_personality_v0 是做什么用的？](https://stackoverflow.com/questions/329059/what-is-gxxpersonalityv0-for)

一旦我使用选项“-fno-exceptions -fno-rtti”运行 g++，输出现在会失败，并显示“不满意的数据符号 '_ZNSs4_Rep20_S_empty_rep_storageE'”

当然，这两个环境（一个编译 - HP-UX B.11.23 ia64 和一个运行二进制文件 - HP-UX B.11.31 ia64）有不同的库版本（但相同的架构），这不应该是错误的原因。

我还想测试标记为“// TODO : HOW to test this scenario?”的案例，但现在可以等待。

任何指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T21:37:12.337

链接时避免未定义符号的最简单方法是使用 g++（不是 gcc）链接。不过，您仍然可以使用 gcc 编译 .c 文件。

也请一次使用系统。如果您在同一系统上运行所有 gcc 和 g++ 命令（无论是旧系统还是新系统），链接错误可能会消失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T22:45:22.783

要从 C 中调用 C++ 函数，您不能使用错位名称。`__cplusplus`删除你在哪里做的条件测试`extern "C"`。即使您的函数将由 C++ 编译器编译，使用`extern "C"`也会导致它避免名称修改。

这是一个例子：

C 文件。

```
/* a.c */
#include "test.h"

void call_cpp(void)
{
  cpp_func();
}

int main(void)
{
  call_cpp();
  return 0;
} 
```

头文件。

```
/* test.h */
#ifndef TEST_H
#define TEST_H
extern "C" void cpp_func(void);
#endif 
```

CPP 文件。

```
// test.cpp
#include <iostream>
#include "test.h"

extern "C" void cpp_func(void)
{
  std::cout << "cpp_func" << std::endl;
} 
```

编译器命令行。

```
g++ a.c test.cpp 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-26T10:40:48.257

您是否有理由不考虑修改 Swig 来做到这一点？我似乎记得有一个 Swig 的发展分支可以做到这一点......

# c# - 如何在强类型 ASP.NET MVC 创建和编辑视图的下拉列表中使用实体对象导航属性？

> ID：873358
> 
> 赞同：4
> 
> 时间：2009-05-16T21:27:00.787
> 
> 标签：c#, .net, asp.net, asp.net-mvc, entity-framework

我有一个包含 Product 和 Family 类型的实体数据模型。每个产品都有一个系列。

我将此模型与 ASP.NET MVC 网站一起使用。我想在我的产品控制器的创建和编辑视图上使用 Family DropDownLists。

如何在强类型 ASP.NET MVC 创建和编辑视图的下拉列表中使用实体对象导航属性？

以下代码失败...

产品控制器：

```
// POST: /Product/Create

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create(Product p)
{
    db.AddToProduct(p);
    db.SaveChanges();
    return RedirectToAction("Index");
} 
```

创建视图：

```
<p>
    <label for="Family">Family:</label>
    <%= Html.DropDownList("Family", new SelectList((IEnumerable)ViewData["Families"], "Id", "Name"))%>
    <%= Html.ValidationMessage("Family", "*")%>
</p> 
```

我可以在不使用 FormCollection 的情况下执行此操作吗？我宁愿将其保留为强类型产品。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T05:02:47.737

是的，因此您将需要实体对象以外的其他东西来获取引用列表。我看到您从 ViewData 收集包中获取了一个选择列表，但没有看到它进入。只要您将它放入 ViewData 或 ViewModel 对象中，就可以了。

关于你的外键的部分......正如亚历克斯所说，EF的当前版本不支持将外键作为简单属性直接公开。我相信这将在 2.0 中发生变化，但同时搜索伪造的外键属性（所以不允许我发布链接）。这个对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T07:24:52.260

目前，您不能使用外键进行绑定。您必须手动更新产品和系列之间的关系。为此，您应该`familyid`为您的操作添加一个参数`"post"`。并分配`product.family`给`families.Where(f=>f.id = famylyId)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:47:27.393

假设 Product 具有`Families`属性（或者是具有 Foreing Key 约束的 Linq 实体）

```
<%= Html.DropDownList("Family", new SelectList(model.Families, "Id", "Name"))%> 
```

# asp.net-mvc - asp.net mvc 数据库交互验证

> ID：873363
> 
> 赞同：7
> 
> 时间：2009-05-16T21:29:11.327
> 
> 标签：asp.net-mvc, validation

是否有人对如何连接需要在更新或添加到数据库之前与数据库交互的验证有任何链接或建议？我看到的每个示例都显示了如何验证属性，例如“Is Required”、“Is Email”、“Is Numeric”等，但是如何连接“Can't order out of stock item”的验证？[这篇 xVal 博客文章](http://blog.codeville.net/2008/09/08/thoughts-on-validation-in-aspnet-mvc-applications/)涉及到它，但没有提供示例。

我一直在关注使用存储库的 NerdDinner 教程，但这是我不太明白的一点......假设我们有一个带有 Create 方法的 OrderController，在创建订单之前，我们必须首先检查该项目有货。在 NerdDinner 风格中，**Controller 使用 Repository**与数据库通信，那么我们的 Order 对象（模型）如何能够执行此验证以及属性验证，因为它不能与数据库通信？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T21:46:25.700

在 NerdDinner 教程中，您可以检查 IsVaild 和 GetRuleViolation 方法。根据您的业务和数据库规则，您可以使用它们在插入数据之前检查您拥有的数据。您甚至可以创建一个 IsValidForInsert 方法来检查您需要强制执行的任何插入特定规则。

在 NerdDinner 中，GetRuleViolation 允许您检索违反的规则并将它们冒泡到您选择的界面。

```
 public bool IsValid
    {
        get { return (GetRuleViolations().Count() == 0); }
    }

    public IEnumerable<RuleViolation> GetRuleViolations()
    {

        if (CheckDbForViolation)
            yield return new RuleViolation("Database Violation", "SomeField");

        if (String.IsNullOrEmpty(Title))
            yield return new RuleViolation("Title is required", "Title");

        if (String.IsNullOrEmpty(Description))
            yield return new RuleViolation("Description is required", "Description");

        if (String.IsNullOrEmpty(HostedBy))
            yield return new RuleViolation("HostedBy is required", "HostedBy");

 ... etc ...

        yield break;
    }

    public bool CheckDbForViolation()

    {

    /// Do your database work here...

    } 
```

您可以更进一步，将数据库代码拆分到存储库中。CheckDbForViolation 将调用 repo 以获取信息，然后确定是否存在违规行为。事实上，如果您使用的是存储库，我认为这将是最好的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T21:58:59.710

您实际上并不需要示例中有关如何执行此操作的任何指导。最终，您必须能够自己创建此类应用程序，这意味着要有创造力。

我从一开始就决定不使用内置验证或会员 API，以免在某个时间点遇到其限制。

对于您的情况：这几乎是标准的。

想象一下执行流程如下：

1.  邮寄表格
2.  在不与数据库对话的情况下验证输入数据格式
3.  如果 (2) 通过，则从业务规则/数据完整性的角度验证输入。在这里你和数据库对话
4.  如果 (3) 通过了，那么无论它是什么都执行你的操作。如果它以某种方式失败（可能数据库中的数据完整性规则禁止该操作，例如，您从另一个浏览器窗口中删除了相关对象）然后取消它并通知用户操作错误。

尽量保持控制器方法为空。验证和操作逻辑应该驻留在您的模型和业务逻辑中。控制器应该基本上尝试一个预期的操作，并根据返回的状态只返回一个视图或另一个。也许还有更多选项，但不是对用户角色、访问权限、调用某些 Web 服务等的全部检查。保持简单。

PS 我有时会得到这样的印象，即旨在为大多数开发人员简化简单事情的内置功能往往会在已删除的功能上创建新的障碍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T21:43:38.593

我会使用方法 PlaceOrder(Order order) 创建一个 OrderService。OrderService 使用存储库来执行 CRUD 操作并执行业务规则（库存检查），并最终在违反规则时抛出异常，您可以捕获并报告给用户。

# javascript - 如何使用 onclick 使用 fancybox？

> ID：873378
> 
> 赞同：6
> 
> 时间：2009-05-16T21:38:57.590
> 
> 标签：javascript, jquery, fancybox

我正在尝试使用 JQuery 和 Fancybox。这是应该如何使用的：http: [//fancy.klade.lv/howto](http://fancy.klade.lv/howto)

但是，我不能为“a href”生成很多 id，我不想让很多 fancybox 实例做好准备。所以我希望能够为许多做同样事情的超链接使用一个精美的盒子实例。

每当单击这些链接中的任何一个时，都会弹出花式框。我以为我会为“ `<a href`”标签或任何其他标签使用 onclick 属性，我可以更改它，但是如何使用fancybox？我试过了，但什么也没出现：

```
<a href="#not-working" onclick="fancybox(hideOnContentClick);">Not Working?</a> 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T21:51:55.720

不要那样做。如果您不能生成唯一 ID（或者根本不想），您应该使用 CSS 类来代替：

```
<a href="image.jpg" class="fancy"><img src="image_thumbnail.jpg"></a> 
```

和：

```
$(function() {
  $("a.fancy").fancybox({
    'zoomSpeedIn': 300,
    'zoomSpeedOut': 300,
    'overlayShow': false
  }); 
}); 
```

（来自他们的使用页面）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-17T13:22:34.857

这演示了如何`<a href>`通过直接调用 fancybox 来使用 fancybox（1.3.4）而不需要链接元素。

**排队：**

```
<div id="menuitem" class="menuitems"></div>

<div style="display:none;">
    <div id="dialogContent">
    </div>
</div>

$('.menuitems').click(function() {
    $.fancybox({
        type: 'inline',
        content: '#dialogContent'
    });
}); 
```

**框架**：

```
<div id="menuitem" class="menuitems"></div>

$('.menuitems').click(function () {
    $.fancybox({
        type: 'iframe',
        href: 'http://www.abc123.com'
    });
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-12-16T10:43:28.670

HTML：

```
<a href="http://domain.com/bigimage.jpg" onclick="return fancybox(this);><img scr="http://domain.com/smallimage.jpg" /></a> 
```

代码：

```
function fancybox(elem) {
elem = $(elem);
if (!elem.data("fancybox")) {
    elem.data("fancybox", true);
    elem.fancybox({
        'overlayColor' : '#000',
        'overlayOpacity' : 0.5
    });
    elem.fancybox().trigger('click');
}
return false; 
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-06T04:12:09.047

万一，您想在页面内打开多个 div 的内容。即fancybox中同一页面的一部分，您可以通过以下代码完成：

```
<a href="#show-in-fancy1" class="popup">open_fancy1</a>
<a href="#show-in-fancy2" class="popup">open_fancy2</a>
<div style="display:none">
  <div id="show-in-fancy1">
    this content is shown in fancybox.
  </div>
  <div id="show-in-fancy2">
    this content is shown in fancybox.
  </div>
</div>
<script>
  $(document).ready(function(){
    $('.popup').fancybox({
          'zoomSpeedIn': 300,
          'zoomSpeedOut': 300,
          'overlayShow': false
      });
  });
</script> 
```

注意：确保你已经包含了 fancybox.js

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-12T15:47:44.143

Ronald 的回答在 fancyBox v2.1.5 中给了我字符串 #dialogContent 内容。尝试使用：

```
<div id="item"></div>

<div style="display:none"><div id="data">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</div></div>

<script type="text/javascript">
jQuery(document).ready(function() {
 jQuery("#item").fancybox({
       type: 'inline',
       content: jQuery('#data').html()
   });

});
</script> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-08-05T12:32:20.843

```
$(".btn_fancybox_messagerie").on("click", function(event) {
    //event.preventDefault();
    var to = $(this).text();
    $.fancybox.open({
        type: 'iframe',
        src: 'http://..../form-messagerie.php?to=' + to,
        toolbar  : false,
        smallBtn : true,
        iframe : {
            preload : false,
            scrolling: 'auto'
        }
    });
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-05T22:10:32.347

在 fancybox 3 中，可以使用以下代码来完成。

```
jQuery().fancybox({
    selector : 'your selector'
}); 
```

# wpf - 循环遍历 WPF 中的 UserControl

> ID：873384
> 
> 赞同：1
> 
> 时间：2009-05-16T21:45:07.140
> 
> 标签：wpf, xaml, controls

嘿，我想知道是否可以循环通过几个 WPF 控件。因此，假设我有一个控件，我想根据它的内容渲染（每次使用不同的数据）10-20 次。

我发现的唯一替代方法是手动创建 20 个这些用户控件并隐藏我不使用的那些。

可以循环它们吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T03:07:23.043

我假设您已经在使用数据模板，并且您正在询问如何遍历创建的对象以表示来自 DataTemplate 的数据。我对吗？为此，您需要使用[VisualTreeHelper](http://msdn.microsoft.com/en-us/library/system.windows.media.visualtreehelper.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T23:39:20.483

您可能需要完善您的问题。

“循环通过”是什么意思？

当您说要渲染控件“10-20 次”时，您的意思是您有一个控件需要更改 10-20 次或 10-20 个控件？

您可能有兴趣研究[DataTemplates 和 ItemsControls](http://www.wpftutorial.net/ListBoxDataTemplate.html)。您可以将 ItemsControl 绑定到包含不同类型对象的 ObservableCollection，然后为集合中包含的每种类型的对象定义不同的 DataTemplates。ItemsControl 将为 ObservableCollection 中包含的每个对象呈现适当的控件。

# c++ - 实现一个队列

> ID：873389
> 
> 赞同：3
> 
> 时间：2009-05-16T21:47:47.303
> 
> 标签：c++, queue

我有以下队列类（取自 wordpress）：

```
#include<iostream.h>

class Queue
    {
    private:
     int data;
     Queue*next;
    public:
     void Enque(int);
     int Deque();
    }*head,*tail;    

    void Queue::enque(int data)
    {
     Queue *temp;
    temp=new Queue;
    temp->data=data;
    temp->next=NULL;
    if(heads==NULL)
     heads=temp;
    else
    tail->next=temp;
    tail=temp;
    }

    int Queue::deque()
    {
    Queue* temp;//
    temp=heads;
    heads=heads->next;
    return temp->data;
    } 
```

我试图弄清楚为什么编译器告诉我我有“头”和“尾”的多重定义 - 没有成功。

编辑：当编译器给出错误消息时，它会从 I-don't-know-where 打开一个 locale_facets.tcc 文件，并在以下函数的第 2497 行显示错误：

```
bool
 __verify_grouping(const char* __grouping, size_t __grouping_size,
        const string& __grouping_tmp) 
```

有没有人有任何见解？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-16T22:06:04.063

由于这是家庭作业，这里有一些关于队列的信息以及如何实现一个。

队列是标准的抽象数据类型。它有几个与之相关的属性：

1.  它是一种线性数据结构——所有组件都排成一条直线。
2.  它有一个增长/衰减规则 - 队列从两端添加和删除。
3.  了解它们的构造方式不应成为使用它们的必要条件，因为它们具有可用的公共接口。

队列可以使用顺序数组或链表建模。
如果您使用的是数组，则需要考虑一些事项，因为您在一个方向上增长，因此您最终会用完数组。然后，您可以做出一些选择（转变与增长）。如果您选择移回数组的开头（环绕），则必须确保头部和尾部不重叠。如果您选择简单地增加队列，则会浪费大量内存。

如果您使用的是 Linked-List，则可以在任何位置插入，队列将从尾部增长并从头部收缩。您也不必担心填满您的列表并不得不包装/移动元素或增长。

不管你决定实现队列，记住队列应该提供一些通用接口来使用队列。这里有些例子：

1.  enqueue - 在队列的后面（尾部）插入一个元素
2.  dequeue - 从非空队列的前面（头部）移除一个元素。
3.  empty - 返回队列是否为空
4.  size - 返回队列的大小

您可能还想将其他操作添加到队列中（在 C++ 中，您可能需要一个迭代器到队列的前/后），但是您构建队列的方式不应该对其提供的操作产生影响。

However, depending on how you want to use your queue, there are better ways to build it. The usual tradeoff is insert/removal time versus search time. Here is [a decent reference](http://en.wikipedia.org/wiki/Linked_list#Linked_lists_vs._arrays).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-16T21:36:18.110

`std::queue`如果您的分配与队列实现没有直接关系，您可能希望使用C++ 中的内置类：

```
#include <queue>

void test() {
    std::queue<int> myQueue;
    myQueue.push(10);
    if (myQueue.size())
        myQueue.pop(); 
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-16T21:39:19.820

为什么不直接使用标准 C++ 库中的队列？

```
#include <queue>

using namespace std;

int main() {
    queue<int> Q;

    Q.push(1);
    Q.push(2);
    Q.push(3);

    Q.top(); // 1
    Q.top(); // 1 again, we need to pop
    Q.pop(); // void

    Q.top(); // 2
    Q.pop();

    Q.top(); // 3
    Q.pop();

    Q.empty(); // true
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T21:51:02.600

有几件事是错误的：

*   您的方法被声明为 Enqueue 和 Dequeue，但定义为 enqueue 和 dequeue：C++ 区分大小写。
*   您的方法指的是似乎不存在的“头”，您的意思是“头”吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T21:41:44.150

如果你需要这个用于 BFS ......只需使用双端队列。

```
#include <deque>

using namespace std;

void BFS() {
    deque<GraphNode*> to_visit;
    to_visit.push_back(start_node);
    while (!to_visit.empty()) {
        GraphNode* current = to_visit.front();
        current->visit(&to_visit);  // enqueues more nodes to visit with push_back
        to_visit.pop_front();
    }
} 
```

该`GraphNode::visit`方法应该完成所有“工作”并将更多节点添加到要访问的队列中。您应该需要的唯一方法是`push_back()`, `front()`, 和`pop_front()`

这就是我一直这样做的方式。希望这可以帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-16T22:04:23.833

看起来您的问题*可能*与以下事实有关：

```
class Queue {
  // blah
} *head, * tail; 
```

正在定义一个`Queue`类，并将 and 声明`head`为`tail`type `Queue*`。他们看起来不像班级的成员，他们应该是。

# sql-server - SQL Server 查询以查找所有当前数据库名称

> ID：873393
> 
> 赞同：63
> 
> 时间：2009-05-16T21:50:10.713
> 
> 标签：sql-server

我需要一个 SQL 查询来查找现有数据库的名称。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-05-16T21:51:40.867

这是在一个 Sql 引擎中显示所有数据库的查询

```
Select * from Sys.Databases 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-05-17T04:11:04.780

```
SELECT name  
FROM sys.databases 
```

> 您只会看到您有权查看的数据库。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-17T04:30:50.397

另一个添加到组合中：

```
EXEC sp_databases 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-17T04:36:27.950

我不推荐这种方法......但如果你想变得古怪和奇怪：

```
EXEC sp_MSForEachDB 'SELECT ''?'' AS DatabaseName' 
```

或者

```
EXEC sp_MSForEachDB 'Print ''?''' 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-07-02T05:26:46.197

您还可以使用以下方式：

```
EXEC sp_helpdb 
```

和：

```
SELECT name FROM sys.sysdatabases 
```

**推荐阅读：**

不要忘记看看[sysdatabases VS sys.sysdatabases](http://www.sqlservergeeks.com/blogs/AmitBansal/sql-server-bi/14/sql-server-sys-databases-vs-sys-sysdatabases)

一个类似的[线程](http://blog.sqlauthority.com/2007/05/12/sql-server-2005-list-all-the-database/)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-16T21:54:23.670

[该论坛](http://p2p.wrox.com/sql-server-2000/40098-select-all-database-names.html)还建议：

> ```
> SELECT CATALOG_NAME AS DataBaseName
> FROM INFORMATION_SCHEMA.SCHEMATA 
> ```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-08T23:01:20.023

对于“ *sys.databases* ”不起作用的人，您也可以使用它；

```
SELECT DISTINCT TABLE_SCHEMA from INFORMATION_SCHEMA.COLUMNS 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-15T02:33:32.983

```
SELECT datname FROM pg_database WHERE datistemplate = false 
```

#对于postgres

# .net - 我应该如何转置 .NET 程序？

> ID：873394
> 
> 赞同：0
> 
> 时间：2009-05-16T21:50:25.660
> 
> 标签：.net, transpose

通过修改现有代码将 Microsoft .NET 程序转换为独立程序会更好，还是仅使用现有代码作为参考？通过独立，我的意思是 .NET 框架（或任何其他框架）不必安装在机器上。最好，我更喜欢花费最少时间的选项，即使它有点错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T22:40:05.620

这取决于 .NET 在现有代码中的广泛使用程度。一些托管 C++ 看起来与本机 C++ 非常相似——在这种情况下，最好用等效的本机 C++ 库替换 .NET 部分。另一方面，一些托管 C++ 在整个代码中使用大量 .NET 主义，例如 ^ 引用，在这种情况下，可能需要重新编写。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T22:09:58.827

如果您的意思是“在没有 .NET 框架的情况下运行”......这不是一个好主意，并且不受支持。但是您可以尝试 Jon 在此处列出的选项：[是否必须安装框架才能运行我的 .NET 应用程序？](http://www.yoda.arachsys.com/csharp/faq/#framework.required)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T01:17:40.810

我知道您提到不使用任何框架，但是，为了您的理智，我建议使用类似于 Borland 的 VCL 的东西（我有一段时间没有使用它，所以我不确定它现在叫什么） . 不使用设计良好的框架，当有可用的选项时……嗯，很难不说这是对资源的巨大浪费。至少对于标准的 Windows 程序。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-16T22:06:27.790

使用本机图像生成器怎么样？

[http://msdn.microsoft.com/en-us/library/6t9t5wcf(VS.80).aspx](http://msdn.microsoft.com/en-us/library/6t9t5wcf(VS.80).aspx)

# .net - bcrypt 的 .net 实现

> ID：873403
> 
> 赞同：116
> 
> 时间：2009-05-16T21:56:49.047
> 
> 标签：.net, bcrypt, bcrypt.net

有谁知道 bcrypt 的一个很好的实现，我知道这个问题之前已经被问过，但它得到的回应很少。我有点不确定是否只是选择在 google 中出现的实现，并且我认为在 System.Security.Cryptography 命名空间中使用 sha256 可能会更好，至少那时我知道它是受支持的！你有什么想法？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-05-16T22:02:12.213

听起来您正在寻找[BCrypt.net](http://derekslager.com/blog/posts/2007/10/bcrypt-dotnet-strong-password-hashing-for-dotnet-and-mono.ashx)：

> BCrypt.net 是 OpenBSD 基于 Blowfish 的密码哈希代码的实现，Niels Provos 和 David Mazières 在“A Future-Adaptable Password Scheme”中进行了描述。它是 Damien Miller 对 jBCrypt 的直接移植，因此在相同的 BSD 风格许可下发布。该代码是完全托管的，应该可以与任何 little-endian CLI 实现一起使用——它已经过 Microsoft .NET 和 Mono 的测试。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-11-19T23:56:26.410

BCrypt.Net 似乎是目前最流行的库

[http://bcrypt.codeplex.com/](http://bcrypt.codeplex.com/)

这是一个如何将其用于哈希密码的示例：

```
[TestMethod]
    public void BCryptTest()
    {
        const string password = "PASSWORD";
        const int workFactor = 13;

        var start = DateTime.UtcNow;
        var hashed = BCrypt.Net.BCrypt.HashPassword(password, workFactor);
        var end = DateTime.UtcNow;

        Console.WriteLine("hash length is {0} chars", hashed.Length);
        Console.WriteLine("Processing time is {0} with workFactor {1}", end - start, workFactor);
        Console.WriteLine("Hashed password: {0} ", hashed);
        Console.WriteLine("correct password {0}", BCrypt.Net.BCrypt.Verify("PASSWORD", hashed));
        Console.WriteLine("incorrect password {0}", BCrypt.Net.BCrypt.Verify("PASSWORd", hashed));
    } 
```

样本输出：

```
hash length is 60 chars
Processing time is 00:00:01.0020000 with workFactor 13
Hashed password: $2a$13$iBqdG7ENBABEargiyzGlTexPsmviF/qrFxUZB2zce7HKF6MoBNhEq 
correct password True
incorrect password False 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2010-12-17T15:38:26.863

您可以在此处找到 BCrypt for .Net 的更新实现：http: [//bcrypt.codeplex.com/](http://bcrypt.codeplex.com/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-01-22T07:29:44.060

在将某些东西从 PostgreSQL（有 pg_crypto）移动到 SQLite（没有）时，我需要一个 BCrypt 实现，所以我自己写了。从这条消息中看到，我不是唯一需要这个的人，我决定在它上面贴一张许可证并发布它。网址是：

[http://zer7.com/software.php?page=cryptsharp](http://zer7.com/software.php?page=cryptsharp)

它背后的 Blowfish 实现是 Bruce Schneier 的公共域 C 实现的一个端口，并且在所有官方测试向量上都取得了成功。

我根据规范自己编写的 BCrypt 代码。我还创建了一个 PHP 脚本，它生成长度为 0 到 100 的随机密码和盐，加密它们，并将它们输出到测试文件。到目前为止，C# 代码匹配这些 100% 的时间。欢迎您使用该脚本并自行测试。

该库还包括适用于任何 HMAC 的 PBKDF2 代码，而不是 .Net 的仅 SHA-1 实现（今天添加——我打算很快在 C# 中执行 SCrypt，这需要带有 HMAC-SHA256 的 PBKDF2）。如果你愿意，你也可以在此基础上为自己制定一个计划。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-29T09:10:32.050

**错误答案，请看下文**

.Net 框架中的所有“Cng”（下一代密码学）后缀算法现在都使用 bcrypt。例如[SHA256Cng](https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.sha256cng?view=netframework-4.7.2)。

* * *

实际上，MS BCrypt（BestCrypt）并不是指基于 Blowfish 密码的那个——谢谢 RobbyD 的评论。
不会删除答案，以防万一其他人产生同样的困惑。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2015-08-26T20:04:03.800

您是否尝试过这个[MS BCryptCreateHash C++ 函数](https://msdn.microsoft.com/en-us/library/windows/desktop/aa375383(v=vs.85).aspx)？似乎存在于 Windows Server 2008 和 Windows Vista 中。

此外，您也可以检查以下[MS C# BCryptNative.cs](http://referencesource.microsoft.com/#System.Core/System/Security/Cryptography/BCryptNative.cs)类。

# asp.net - 我重命名了 aspx 文件名，但现在我无法从 cs 文件访问控件

> ID：873404
> 
> 赞同：1
> 
> 时间：2009-05-16T21:57:25.690
> 
> 标签：asp.net

我重命名了 aspx 文件名，但现在我无法从 cs 文件访问控件。我删除了 Designer.cs 文件并通过右键单击转换为 Web 应用程序的 aspx 文件创建。但是当我按下 Ctrl+Space 时仍然找不到控件（代码智能感知）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T22:03:19.293

检查指令中的`CodeBehind`属性是否`@Page`指向`.cs`文件，以及该`Inherits`属性是否指向文件中正确的类名`.cs`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T17:39:05.037

您需要检查代码隐藏属性以及必须是您在 .cs 文件中定义的类的继承属性

# model-view-controller - 表示层对象

> ID：873407
> 
> 赞同：0
> 
> 时间：2009-05-16T21:58:40.053
> 
> 标签：model-view-controller, design-patterns, presentation-layer

表示层应该拆分为表示和接收对象还是在两个方向上处理数据的单个对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T12:31:00.790

表示层应该位于处理呈现和接收的接口后面。主要原因是，如果您有两个接口，一个用于呈现，另一个用于接收，理论上可能会最终分配给每个不同的对象，从而导致测试异常。

但是，如果您的界面正在发展为数十种方法，您可能需要退后一步，将其划分为更小的单元，然后将它们聚合起来。不一定基于接收和呈现，而是基于您的呈现 UI 的更多逻辑划分。

例如，您可以有一个带有两个变量的 IPresentationUI，一个是 IPresentationDisplay 的接口，另一个是 IPresentationControl 的接口。您拥有的唯一注册例程将接受 IPresentationUI 对象。实现 Presentation 层的类将实现三个接口 IPresentationUI、IPresentationControl 和 IPresentationDisplay。

# c# - 阻止 Visual Studio 为新类添加默认引用和使用

> ID：873411
> 
> 赞同：13
> 
> 时间：2009-05-16T21:59:18.650
> 
> 标签：c#, .net, visual-studio, visual-studio-2008, default

每当我向 Visual Studio (C#) 项目添加新类时，我都会自动获得以下用法：

*   使用系统；
*   使用 System.Collections.Generic；
*   使用 System.Linq；
*   使用 System.Text；

此外，如果还没有以下 DLL 引用，则会添加它们：

*   系统核心
*   系统数据
*   系统文件

我想阻止 VS 这样做（当然“使用系统”除外）。有谁知道防止这种情况发生的方法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-21T19:48:16.153

Marc 和 Brian 都有一个好主意：创建一个新的自定义模板，其中只包含我想要的使用和引用。使用导出模板，这样做非常简单，我一定会为各种特定项目这样做。

对于通用的新类（即：您从 VS 中的“添加->类...”菜单项中获得的内容），这是我为实现目标所做的：

*   找到合适的模板 Zip。在我的系统上，它位于 C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class.zip
*   解压缩 zip 文件。这给出了两个文件：Class.cs 和 Class.vstemplate
*   编辑 Class.cs 以删除不需要的 using 语句。（当我在这里时，我还将默认的类访问修饰符更改为“public”）
*   编辑 Class.vstemplate 以删除不需要的`<reference>`元素。
*   将文件重新压缩到现有的 Class.zip 存档中
*   用更新的版本替换缓存的模板文件。在我的系统上，这些文件位于 C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplatesCache\CSharp\Code\1033\Class.zip（包含旧 Class.cs 和 Class.vstemplate 的目录）。
    *   我试着简单地删除这个目录，期望 VS 从“原始”源重建缓存。但这不起作用；我收到一条错误消息，说它在缓存目录中找不到文件。替换缓存的文件虽然效果很好。
*   重新启动 Visual Studio

现在，每当我添加一个新类时，我都会得到我想要的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-16T22:02:29.983

您可以更改您的模板文件...通过在安装位置编辑文件，或者通过编写*您*想要的类，然后选择[Export Template](http://msdn.microsoft.com/en-us/library/ms185318(VS.80).aspx)。某处还有一个模板加载项...

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-16T22:08:45.523

您可以创建自己的自定义项目模板，请参阅

[http://blogs.msdn.com/saraford/archive/2008/10/27/did-you-know-you-can-create-file-or-item-templates-343.aspx](http://blogs.msdn.com/saraford/archive/2008/10/27/did-you-know-you-can-create-file-or-item-templates-343.aspx)

了解一些细节。

# java - 非递归地从两个数组中生成元素的所有可能排列

> ID：873413
> 
> 赞同：0
> 
> 时间：2009-05-16T22:02:09.437
> 
> 标签：java, algorithm

我正在尝试生成所有可能的方程，给定一个字符串运算符数组（+、-、*、/）和一个变量字符串数组（a、b、c ...）。每个方程将由成对的变量和数字 (a+ b- c/ b) 组成，除了最后一个变量，它后面没有运算符。该算法必须生成可变长度的方程（2 项、6 项等）。在 Java 中生成此列表的最有效方法是什么？

请不要递归地这样做。:)

嗯，不，这不是家庭作业。这是一个个人项目，我试图利用遗传算法找到适合数据的最佳方程。如果您相信的话，笼统地描述算法就足够了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T23:25:52.327

既然你说这不是功课，而我是一个值得信赖的人……

1.  通过针对运算符数组运行每个变量来构建一个新的变量运算符组合数组 => ["a+", "a-", "a*", "a/", "b+" ... "d/"] . 我们称它为 BuiltArray1

2.  对运算符运行此数组，输出每个运算符并将每个运算符存储在一个新数组中 => ["a+a", "a+b", "a+c", "a+d", "aa" ... “d/d”]。我们称它为 BuiltArray2。如果我们愿意的话，我们现在可以删除原来的变量数组 ["a, "b", "c", "d"] - 我们不会再使用它了。

3.  现在事情变得更有趣了……现在我们正在构建 BuiltArray3。对 BuiltArray2 中的每一项运行 BuiltArray1 中的每一项，输出每一项并将每一项存储在 BuiltArray3 => ["a+a+a", "a-a+a", "a*a+a", "a/a+ a"、"b+a+a" ... "d/d/d"]。我们现在可以删除 BuiltArray2 以节省一些内存（这将开始快速消耗内存！）

4.  对于BuiltArray4，直到我们的计算机在它可以处理的最后一个BuiltArray_n 上尖叫为止，我们针对之前构建的数组运行BuiltArray1 中的每个项目，输出并将每个结果存储在一个新数组中，然后删除之前的数组。

这将消耗内存和处理能力，但我想不出任何更优雅的东西。

希望能帮助到你。

* * *

这是 Ruby 代码：

```
@arr1 = ["a", "b", "c", "d"]
arr2 = ["+", "-", "*", "/"]
@base = []
@arr1.each do |char|
  arr2.each do |op|
    @base << char + op
  end
end
@right_vals = @arr1
loop do
  @new_values = []
  @base.each do |left|
    @right_vals.each do |right|
      val = left + right
      puts val
      @new_values << val
    end
  end
  @right_vals = @new_values
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T00:15:23.207

所以这是我想出的代码。我使用单个 LinkedList 来存储我生成的方程。我生成所有可能的运算符和变量对，然后将它们附加到我已经生成的解决方案中以提出新的解决方案。有没有更好/更快的方法来做到这一点？

```
LinkedList<String> solutions = new LinkedList<String>();
//String[] vars and operators are initialized elsewhere.
int start = 0, end = solutions.size()-1;

//creating the first solutions
for(String s : vars)
    solutions.add(s);

//precompute pairs of operators and variables
String[] pairs = new String[operators.length * vars.length];
for(int i=0, j=0; j<operators.length; j++)
for(int k=0; k<vars.length; k++)
{
    pairs[i++]= operators[j]+vars[k];
}

//while the the terms in equations is under maximum
while(solutions.get(solutions.size()-1).split("[+/*-]").length<4)
{
    for(int i=start; i<end; i++)
    {
        String soln = solutions.get(i);
        for(int j=0; j<pairs.length; j++)
        {
            solutions.add(soln+pairs[j]);
        } 
    }
    start = end +1;
    end = solutions.size()-1;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T22:21:35.820

因为我也认为这可能是家庭作业，所以我不会给你任何语言的代码，但是......

您可以有两个嵌套循环，一个循环遍历数组一，另一个循环遍历数组二。

您将看到组合的每个索引都将通过内部循环，您可以在那里进行数学运算。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T12:41:12.807

这不是在 Java 中，它是递归的，但有趣的是，Haskell 解决方案看起来像这样：

```
permuteEquations :: Int -> [String] -> [String] -> [String]
permuteEquations 1 vars _ = vars
permuteEquations n vars ops = 
    [v ++ t1 | t1 <- [o ++ t2 | t2 <- permuteEquations (n-1) vars ops, o <- ops],
               v  <- vars] 
```

*这会生成包含n 个*变量的所有可能的方程。

或者，如果您想要一个从一个变量的方程（即变量列表）开始的版本，然后一直到*n 个*变量，那么它是：

```
permuteEquations1 :: Int -> [String] -> [String] -> [String]
permuteEquations1 0 _ _ = []
permuteEquations1 n vars ops = 
    [v ++ t1 | t1 <- "" : [o ++ t2 | t2 <- permuteEquations1 (n-1) vars ops, 
                                     o  <- ops], 
               v  <- vars] 
```

由于惰性计算，这些函数在恒定空间中运行，如果您要生成数十亿个方程，这很方便。有谁知道你会如何在Java中做到这一点？（我敢肯定它是可能的，我只是想看看它是什么样子的）。

实际上，由于惰性评估，您可以摆脱*n*项并生成一个无限列表，客户端将其截断为所需的任何长度。

```
permuteEquations2 :: [String] -> [String] -> [String]
permuteEquations2 vars ops = 
    [v ++ t1 | t1 <- "" : [o ++ t2 | t2 <- permuteEquations2 vars ops, o <- ops], 
               v  <- vars] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T13:29:02.083

运行时间随着变量的数量呈指数增长。这是另一种方法。

```
import java.util.List;
import java.util.ArrayList;

public class Equations {
    public static void main(String[] args) {
        String[] operators = "+ - * / %".split(" ");
        String[] variables = "a b c d e f g".split(" ");
        printAllPermutations(operators, variables);
    }

    private static void printAllPermutations(String[] operators, String[] variables) {
        if (variables.length >= 31)
            throw new IllegalArgumentException("Need to use BigInteger to support such a large number variables.length="+variables.length);

        int permuations = 1 << variables.length;
        for(int p=1;p<permuations;p++) {
            List<String> variableList = new ArrayList<String>();
            int p2 = p;
            for (String variable : variables) {
                if ((p2 & 1) != 0)
                    variableList.add(variable);
                p2 /= 2;
            }
            printPermutations(operators, variableList.toArray(new String[variableList.size()]));
        }
    }

    private static void printPermutations(String[] operators, String[] variables) {
        long permutations = 1;
        // more accurate than Math.pow.
        for (int i = 0; i < variables.length-1; i++) {
            String variable = variables[i];
            permutations *= operators.length;
        }
        for(long p = 0; p < permutations;p++) {
            long p2  = p;
            for (int i = 0; i < variables.length-1; i++) {
                System.out.print(variables[i]);
                int oper = (int) (p2 % operators.length);
                System.out.print(operators[oper]);
                p2 /= operators.length;
            }
            System.out.println(variables[variables.length-1]);
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-14T12:44:08.097

> 给集合的Javascript，第一个用于操作数，应应用于第二个数字集合，然后我们用目标值评估生成的表达式。

```
var targetValue=10;
var set=[2,4,8,16,64];
//var ops=['+','-', '/', '*'];

var retArray=new Array();

function permutateSigns(operand, numbers, pos, epx){

        var sum = 0;
        if (pos == numbers.length-1) {
            epx += numbers[pos];
            //console.log(epx);
            retArray.push(epx);
        } else {
            epx += (numbers[pos]) + operand;
            permutateSigns('+', numbers, pos + 1, epx);
            permutateSigns('-', numbers, pos + 1, epx);
            permutateSigns('*', numbers, pos + 1, epx);
            permutateSigns('/', numbers, pos + 1, epx);
        }
    }
permutateSigns('+',set,0,"");
var per=retArray;
console.log(per);

var validExpr;
for (var i = 0; i < retArray.length; i++) {
    var result=eval(retArray[i]);

    if(result===targetValue)
        validExpr= retArray[i];
    else
     console.log(retArray[i] + ":" + eval(retArray[i]));
}
console.log("valid expression is:" + validExpr + "; value:"+ eval(validExpr) + "number of permutations is:"+ retArray.length); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-16T22:06:14.780

我认为这与语言无关。这是作业吗？这听起来像是作业，所以我不会给你一个例子，但我会使用 3 个`while`循环（虽然你可以很容易地使用`for`循环，但我更喜欢使用`while`s）。

# python - 在 python 中转换为安全的 unicode

> ID：873419
> 
> 赞同：2
> 
> 时间：2009-05-16T22:04:14.207
> 
> 标签：python, django, unicode

我正在处理未知数据并尝试使用 Python/Django 插入 MySQL 数据库。我遇到了一些我不太理解的错误，正在寻求帮助。这是错误。

```
Incorrect string value: '\xEF\xBF\xBDs m...' 
```

我的猜测是字符串没有正确转换为 unicode？这是我的 unicode 转换代码。

```
s = unicode(content, "utf-8", errors="replace") 
```

没有上面的unicode转换，我得到的错误是

```
'utf8' codec can't decode byte 0x92 in position 31: unexpected code byte. You passed in 'Fabulous home on one of Decatur\x92s most 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T22:43:42.223

原始编码是什么？我假设“cp1252”来自[pixelbeat的](https://stackoverflow.com/questions/873419/converting-to-safe-unicode-in-python/873450#873450)回答。在这种情况下，你可以做

```
>>> orig # Byte string, encoded in cp1252
'Fabulous home on one of Decatur\x92s most' 

>>> uni = orig.decode('cp1252')
>>> uni # Unicode string
u'Fabulous home on one of Decatur\u2019s most'

>>> s = uni.encode('utf8')  
>>> s # Correct byte string encoded in utf-8
'Fabulous home on one of Decatur\xe2\x80\x99s most' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T22:25:18.010

0x92 是 windows cp1252 编码中的右单引号。

\xEF\xBF\xBD 是 unicode 替换字符的 UTF8 编码（插入而不是错误的 cp1252 字符）。

所以看起来您的数据库不接受有效的 UTF8 数据？

2 个选项： 1\. 也许你应该使用 unicode(content,"cp1252") 2\. 如果你想将 UTF-8 插入数据库，那么你需要适当地配置它。我会把这个答案留给其他知识渊博的人

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T22:17:27.950

“Fabulous...”字符串看起来不像 utf-8：0x92 高于 128，因此应该是多字节字符的延续。但是，在该字符串中，它单独出现（显然代表撇号）。

# ms-access - 运行 IIS 7 的 Windows 2008 Server 上的 ASP 访问数据库网站

> ID：873421
> 
> 赞同：1
> 
> 时间：2009-05-16T22:05:44.390
> 
> 标签：ms-access, iis-7, asp-classic, permissions, windows-server-2008

我正在将我的服务器从运行 Windows 2003 的 IIS 6 升级到 Windows 2008 Server。

我不确定访问 Access 数据库需要什么权限和帐户。

在 Windows 2003 中，我已授予 IUSR 帐户的写入权限，它在 Windows 2008 中的等效项是什么？

该数据库不在网站文件夹中。

我收到 500 - 内部服务器错误。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T01:13:45.437

您可以使用 ASP 的这个小片段来查看匿名用户的名称是什么：

```
<% 
Response.Write Request.ServerVariables("LOGON_USER") 
' or 
Response.Write Request.ServerVariables("AUTH_USER") 
%> 
```

此外，如果您看到的只是“500 - 内部服务器错误”，您需要配置 IE 以提供更多详细信息，而不是“友好”错误消息，或者使用其他浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T20:41:48.730

在 IIS7 下，这并没有什么不同。虽然用户帐户只是 IUSR（或更准确地说是“NT AUTHORITY\IUSR”），但没有机器名称后缀。

# sql - SQL Server 2005 恢复挂起

> ID：873427
> 
> 赞同：2
> 
> 时间：2009-05-16T22:09:27.970
> 
> 标签：sql, sql-server, sql-server-2005, restore

我有一个数据库在 SQL 企业管理器中显示为“（正在恢复...）”

如果我执行 SP_WHO，则没有恢复过程。

服务器上的磁盘和 CPU 活动非常低

我认为它根本没有恢复。

我怎样才能摆脱这个？

我尝试重命名底层 MDF 文件，但即使我执行“NET STOP MSSQLSERVER”，它也会告诉我文件已打开。

我尝试使用 PROCEXP 来查找打开文件的进程，但即使是最新的 PROCEXP 在 Windows Server 2003 R2 x64 上似乎也无法做到这一点。下部窗格视图为空白。

在 SQL Server 日志中，它说“数据库被标记为正在恢复，并且处于不允许运行恢复的状态”

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-16T22:23:17.110

Sql Server 有两种备份类型：

*   完全备份，包含整个数据库
*   事务日志备份，仅包含自上次完整备份以来的更改

还原时，Sql Server 会询问您是否要在完整备份后还原其他日志。如果您选择此选项，称为 WITH NORECOVERY，则数据库将处于正在恢复状态。它将等待更多的事务日志被恢复。

您可以使用以下命令强制它退出恢复模式：

```
RESTORE DATABASE <DATABASE_NAME> WITH RECOVERY 
```

如果此命令出错，请分离数据库，删除 MDF 文件，然后从头开始恢复。如果它一直失败，则您的备份文件可能已损坏。

这是恢复选项的屏幕截图，选择了默认选项。第二个选项将使数据库处于恢复状态。

[恢复选项图片 http://img193.imageshack.us/img193/8366/captureu.png](http://img193.imageshack.us/img193/8366/captureu.png)

PS1。您正在运行 64 位版本的进程资源管理器吗？验证您是否在任务管理器中看到 procexp64.exe。

PS2。这更像是[serverfault](http://serverfault.com)的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-10T19:53:37.627

执行 RESTORE DATABASE/RESTORE LOG 命令时，默认使用 WITH RECOVERY 选项。如果您陷入“恢复”过程，您可以通过执行以下命令使数据库恢复在线状态：

```
RESTORE DATABASE YourDB WITH RECOVERY
GO 
```

[您可以在此 SO 帖子https://stackoverflow.com/a/21192066/2808398](https://stackoverflow.com/a/21192066/2808398)上查找更多选项和一些第三方工具

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-16T23:09:49.417

如果您想摆脱文件上的锁定，我建议您获取 Unlocker [http://www.emptyloop.com/unlocker/](http://www.emptyloop.com/unlocker/)

它将为您提供解锁文件或终止锁定文件的进程的选项。在 mdf 和 ldf 文件上运行它。

另一种选择是尝试从 Enterprise Manager 或 Sql Management Studio 中分离文件，然后重新附加数据库。您可以在运行解锁器之前尝试此操作，以查看 sql server 是否只会释放 mdf 和 ldf 文件。

注意：如果您终止该进程，您可能会丢失数据或数据可能会损坏，因此只有在您尝试摆脱它并且您拥有经过测试的良好备份时才使用此选项。

# asp.net - 在 web.config 中添加 machinekey 后的性能问题

> ID：873428
> 
> 赞同：2
> 
> 时间：2009-05-16T22:09:41.807
> 
> 标签：asp.net, asp.net-mvc, web-config

在 web.config 的 system.web 中添加机器密钥会导致任何性能问题吗？

我在 web.config 中添加了类似的内容：

```
<system.web>
    <machineKey validationKey="aaa"
    decryptionKey="bbb" validation="SHA1" />
</system.web> 
```

现在它似乎运行得慢了很多。我正在使用 firebug 来查看页面的加载速度。

在这个问题之后我最终遇到了这个[问题](https://stackoverflow.com/questions/851557/figuring-out-why-asp-net-authentication-ticket-is-expiring/873418#873418)

注意：这不是我使用的实际机器密钥。我有一个合适的机器钥匙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T22:52:50.067

创建一个正确的机器密钥，看看是否效果更好：

[机器密钥生成器](http://aspnetresources.com/tools/keycreator.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-10T09:28:22.967

答案是否定的，它不会导致性能问题。

我发现我的问题出在其他地方

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T00:25:51.417

你试过这个吗？：

```
<machineKey validationKey="AutoGenerate,IsolateApps" decryptionKey="AutoGenerate,IsolateApps" validation="SHA1" /> 
```

这是 ASP.NET 2.0 中的默认设置，这些设置不应该有任何性能问题

# netbeans - 自己代码的 NetBeans PHP 代码完成

> ID：873432
> 
> 赞同：26
> 
> 时间：2009-05-16T22:12:14.110
> 
> 标签：netbeans, code-completion

最近我开始使用[NetBeans 6.7 beta](https://download.netbeans.org/netbeans/6.7/beta/)代替[Textmate](https://macromates.com/)和[MacGDBp](https://web.archive.org/web/20190331020751/https://www.bluestatic.org/software/macgdbp/)进行 PHP 开发。我对它的功能集感到相当惊讶，而且大多数东西都是开箱即用的，或者很容易按照我的喜好进行配置。

不过，我对代码完成功能有疑问；它们适用于内置函数、[SPL](https://www.php.net/spl "标准 PHP 库")和我的一些代码，但不是我的所有代码，特别是，无论 PHPDoc 注释如何，它都不适用于我的类中的任何方法。

我似乎找不到任何体面的问题，更不用说在任何地方回答这个特定主题了。看起来其他所有对代码完成有问题的人都没有启用自动弹出功能。

**所以最大的问题是：**

有*什么方法*可以影响代码完成缓存，或者我必须添加到我的代码中才能使其工作？我真的很想为我编写的方法完成代码。

**PS**：我尝试了几个旧版本的netbeans，它们都表现出同样的问题。

**编辑**：我已经把我当前的测试项目的 .zip 文件放在了一个 .zip 上。[在这里得到它](http://develop.theredhead.nl/~kris/stackoverflow/develop.theredhead.nl.zip)。这是一个非常年轻的项目，想想一天半。

**edit2**：下面是我正在查看的屏幕截图。如您所见，它几乎没有完成任何事情，也没有看到 PHPDoc 文档。

[![替代文字](https://i.stack.imgur.com/ubVyA.png)](https://i.stack.imgur.com/ubVyA.png)

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-17T14:56:55.727

我试过打开你的项目，完成对我来说似乎很好。

我唯一能想到的就是尝试删除整个 NB 缓存，它应该位于`$HOME/.netbeans/$VERSION/var/cache/`. 这是一个疯狂的猜测

**先备份**，我没试过！

如果失败了，也许你应该尝试创建一个新项目，也许这会踢 NB 的屁股。

请注意，在 NB 7.2 beta 中，缓存已移至 $HOME/.cache/netbeans/$VERSION。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-27T02:42:36.197

对我有用的是清除缓存，然后在全局包含路径中明确包含一些关键子目录。似乎由于某种原因 NB 6.7 没有递归目录。

包括在项目级别也有效 Project->Properties->Include Path Netbeans 7.01 + Windows 7

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-30T23:49:40.883

对我有用的是删除旧的 nbproject 文件夹（在 Windows 中创建）并从现有源重新创建 PHP 项目。这是在 NB 7.0.1 Mac OS X 上。清除缓存对我不起作用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-24T08:58:51.240

注意`@property something`语法。如果您的代码中不再存在对象，则 NetBeans*可能*无法正确完成代码。考虑示例：

```
/** in main file: **/

use ABC as _ ; 
```

* * *

```
/** in file ABC: **/

/** 
  *  @property \Something $something
  */ 
```

* * *

如果不再使用`$something`，NetBeans 很可能会生成异常，从而无法完成代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-24T14:19:50.270

例如，如果您使用 netbeans 打开一个 php 文件而不是项目的一部分，则代码完成根本不起作用。您需要做的是创建一个包含该文件的项目。

在 NetBeans 7.0.1 上对此进行了测试

# artificial-intelligence - 大脑建模

> ID：873448
> 
> 赞同：7
> 
> 时间：2009-05-16T22:24:33.190
> 
> 标签：artificial-intelligence, neural-network, large-scale, biological-neural-network, neuroscience

只是想知道，因为我们已经达到了每台 PC 1 teraflop，但我们仍然无法模拟昆虫的大脑。有没有人见过一个自学习、自开发的神经网络的体面实现？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-16T22:31:10.647

我看到一个有趣的实验，将大鼠大脑的物理神经布局映射到一个数字神经网络，该网络的权重基于使用 MRI 和其他方法获取的每个组件的神经元化学性质。很有趣。（新科学家或焦点，2 期前？）

**IBM Blue Brain**浮现在脑海中 [http://news.bbc.co.uk/1/hi/sci/tech/8012496.stm](http://news.bbc.co.uk/1/hi/sci/tech/8012496.stm)

正如您正确指出的那样，问题在于计算能力。但是对于神经网络的一系列刺激，计算范围往往是指数的，因为刺激遇到更深的嵌套节点。任何复杂的加权算法都意味着在每个节点上花费的时间会变得很昂贵。特定领域的神经图往往更快，因为它们是专门的。哺乳动物的大脑有许多一般路径，这使得教授它们变得更加困难，并且计算机在给定的空间/时间中模拟真实的哺乳动物大脑。

真正的大脑也有大量的静态串扰（有些人认为这是创造力或原创思想的来源）。大脑也不会使用“直接”刺激/奖励来学习……他们使用过去对无关事物的经验来创造自己的学习。在计算空间中重建神经元是一回事，创建准确的学习是另一回事。别介意多巴胺（昆虫中的章鱼胺）和其他神经化学物质。

**想象一下给数字大脑 LSD 或抗抑郁药。作为一个真实的模拟。惊人的。我怀疑那将是一个复杂的模拟。**

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-16T22:44:00.320

我认为你有点假设我们关于神经网络如何工作的想法是大规模大脑的一个很好的模型。我不确定这是一个好的假设。见鬼，就在几年前，我们并不认为神经胶质细胞对心理功能很重要，而且很长一段时间都认为大脑成熟后没有神经发生。

另一方面，神经网络似乎确实可以很好地处理一些看似复杂的功能。

所以，这里有一个小谜题：你认为人脑的计算代表了多少 teraflops 或 petaflops？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-16T23:14:41.993

[杰夫·霍金斯](http://www.onintelligence.org/)会说神经网络是大脑的一个很差的近似。他的《论情报》读起来很棒。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T02:39:42.407

是结构。即使我们今天的计算机性能与人脑相同或更高（有不同的预测何时到达那里，但还有几年的时间），我们仍然需要对其进行编程。虽然我们今天对大脑了解很多，但我们不知道的东西还有很多很多。这些不仅仅是细节，而是根本不了解的大范围。

只关注 Tera-/Peta-FLOPS 就像只用数码相机看百万像素：当涉及到许多因素时（大脑中的因素比相机中的多一些），它只关注一个值。我也相信，许多关于模拟大脑需要多少 FLOPS 的估计都还很遥远——但这完全是一个不同的讨论。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-16T22:54:12.060

是的： [OpenCog](http://opencog.org/wiki/Status)正在努力。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-17T03:14:46.783

> 只是想知道，我们已经达到每台 PC 1 teraflop，但我们仍然无法模拟昆虫的大脑。有没有人见过自学习自开发神经网络的体面实现？

我们已经可以为大脑建模。这些天来的问题是多快，多准确。

一开始，人们努力寻找具有最少物理特性的神经元的最抽象表示。

这导致康奈尔大学发明了[感知器](http://en.wikipedia.org/wiki/Perceptron)，这确实是一个非常简单的模型。事实上，这可能太简单了，就像麻省理工学院著名的人工智能教授马文·明斯基（Marvin Minsky）写的一篇论文**错误地**得出结论，这种模型不可能学习异或（一种基本的逻辑门，每个人都可以模拟）我们今天拥有的计算机）。不幸的是，他的论文使神经网络研究陷入了至少 10 年的黑暗时代。

虽然可能不像许多人想的那样令人印象深刻，但已经存在可以进行视觉和语音学习和识别的学习网络。

即使我们有更快的 CPU，它仍然与神经元不同。我们大脑中的神经元至少是并行的加法器单元。因此，想象一下 1000 亿个模拟人类神经元，每秒增加，将它们的输出发送到 100 万亿个连接，“时钟”约为 20hz。这里进行的计算量远远超过了我们拥有的处理能力的千万亿次，尤其是当我们的 cpu 主要是串行而不是并行时。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-16T23:10:07.263

2007 年，他们以实际速度的一半模拟了相当于半个老鼠大脑的 10 秒：http: [//news.bbc.co.uk/1/hi/technology/6600965.stm](http://news.bbc.co.uk/1/hi/technology/6600965.stm)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-08-24T14:53:38.130

有一种名为 C. Elegance 的蠕虫，我们完全了解它的解剖结构。每个细胞都被绘制出来，每个神经元都得到了很好的研究。这种蠕虫在出生时具有一个有趣的特性，那就是它只跟随或生长到它出生的那些温度区域。[这是论文的链接。](http://arxiv.org/abs/1410.7881)本文用神经元模型实现了该属性。并且有一些学生使用这种神经元模型构建了机器人，它只跟踪具有不同光度的区域中的黑暗区域。这项工作也可以使用其他方法完成，但正如我在上面给出链接的论文所证明的那样，这种方法更具抗噪性。

# asp.net - javascript 和 ASP.NET AJAX 中的 OO 编程问题

> ID：873449
> 
> 赞同：0
> 
> 时间：2009-05-16T22:25:06.670
> 
> 标签：asp.net, javascript, ajax, web-services, oop

我试图尽可能多地保留 OO，但是从服务器返回后 ASP.NET AJAX 似乎在做一些奇怪的事情......

```
function Person( personId ) {
var id = personId;
var firstName;
var lastName;

this.initializeStep1 = function() {
    PeopleServices.getFirstName(id, this.initializeStep2);
}

this.initializeStep2 = function(foundFirstName) {
    alert(foundFirstName);
    firstName = foundFirstName;
    PeopleServices.getLastName(id, this.initializeStep3);
}

this.initializeStep3 = function(foundLastName) {
    alert(foundLastName);
    alert(firstName);
    lastName= foundLastName;
} 

this.initializeStep1(); 
```

}

这是它的基础。所以基本上它是创建一个人并从服务器检索他们的名字和姓氏以初始化这个人。

当我创建一个新人时，它经过initializeStep1，调用服务器webmethod getFirstName，最终到达initializeStep2。警报（foundFirstName）；有效，它会提醒找到的名称并且它是正确的...现在在将私有变量 firstName 设置为找到的名称后，我再次调用服务器...

这一次，它没有达到initializeStep3，我知道它不应该在服务器端失败，因为即使我更换了线路

```
PeopleServices.getLastName(id, this.initializeStep3); 
```

和

```
PeopleServices.getFirstName(id, this.initializeStep3); 
```

它仍然不起作用。

我想知道在第一个服务器调用之后它是否丢失了对“this”的引用或类似于我无法以我的方式调用 initializeStep3 的情况。有人有想法么？

一些注意事项：

*   我知道服务器 webmethods 都在工作，我已经单独测试过它们。
*   我不确定我的 OO 是否在这里。
*   我也不确定我是否要使用 AJAX。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T03:23:10.307

你需要一个闭包

```
var that = this;
PeopleServices.getFirstName(id, function (x) { 
                                    that.initializeStep3(x);
                                } 
); 
```

# mysql - MySQL current_insert_id()？（不是 last_insert_id()）

> ID：873451
> 
> 赞同：3
> 
> 时间：2009-05-16T22:26:30.067
> 
> 标签：mysql, auto-increment, insert-id

我正在插入一个带有 char 列的行，用于基于（除其他外）行的自动 ID 的哈希。

我知道我可以插入它，获取 insert_id，计算哈希值并更新它。

有谁知道在单个查询中执行此操作的方法？您在插入时需要行 insert_id。这是完全不可能的，还是有类似 current_insert_id()...

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-16T22:43:10.837

不，MySQL 中没有任何功能可以为您提供`current_insert_id()`.

从 MySQL 中的字段获取生成的 ID 值的唯一方法`AUTO_INCREMENT`是执行 INSERT 然后调用`last_insert_id()`. 所以你计划做一个单独的更新来计算哈希可能是你必须做的。

我可以想到另外两个选择：

*   在 INSERT 之前使用除`AUTO_INCREMENT`. 例如，查看[`UUID()`](http://dev.mysql.com/doc/refman/5.1/en/miscellaneous-functions.html#function_uuid)函数。

    ```
    SET @id = SELECT UUID();
    INSERT INTO MyTable (id, hash) VALUES (@id, hash(@id...)); 
    ```

*   不要在哈希计算中包含 ID。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T22:48:01.293

我不知道在一个查询中在 MySQL 中执行此操作，但是您可以在您选择的服务器端脚本语言中执行类似的操作：

```
<?php

$query = mysql_query("SHOW TABLE STATUS LIKE 'MyTable'");
$row = mysql_fetch_assoc($query);
$next_id = $row['Auto_increment'];

?> 
```

...它为您提供了要合并到 SQL 中的 id。

编辑：我还发现[这个答案](https://stackoverflow.com/questions/469009/can-you-access-the-auto-increment-value-in-mysql-within-one-statement)可能会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T00:04:39.423

You can query the next-to-be-used value from the `information_schema`.`TABLES` table, the `AUTO_INCREMENT` column there. (You might be setting yourself up for a race condition?)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T23:34:12.430

当我做插入时，我会做这样的事情：

`INSERT INTO table (col1,col2) VALUES (data1,data2);SELECT LAST_INSERT_ID()`

就像我在获取数据一样运行查询。在 VB.NET 中，语法是（假设您有 MySql.Data.MySqlClient .dll）：

```
Dim sql As String = "[sql string above]"
Dim dr As MySqlDataReader = YourRetrieveDataFunction(sql)

dr.Read()
yourObjectInstance.ID = dr(0)
dr.Close 
```

从技术上讲，这是两个查询，但对数据库只有一次访问 :)

# c - 如何在C中截断文件？

> ID：873454
> 
> 赞同：58
> 
> 时间：2009-05-16T22:28:28.783
> 
> 标签：c, file

我正在使用 C 将一些数据写入文件。我想删除文件中以前写入的文本，以防它比我现在写的要长。我想减小文件的大小或截断到最后。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-05-17T00:52:28.983

如果您想将文件的先前内容保留到某个长度（长度大于零，其他答案提供），那么 POSIX 为该作业提供了[`truncate()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/truncate.html)和[`ftruncate()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/ftruncate.html)函数。

```
#include <unistd.h>
int ftruncate(int fildes, off_t length);
int truncate(const char *path, off_t length); 
```

该名称表示主要目的 - 缩短文件。但是如果指定的长度比之前的长度长，文件会增长（零填充）到新的大小。请注意，它`ftruncate()`适用于文件描述符，而不是`FILE *`; 你可以使用：

```
if (ftruncate(fileno(fp), new_length) != 0) ...error handling... 
```

但是，您应该知道混合文件流 ( `FILE *`) 和文件描述符 ( `int`) 访问单个文件很容易导致混淆 - 请参阅一些问题的评论。这应该是最后的手段。

但是，出于您的目的，打开时截断很可能是您所需要的，为此，其他人提供的选项就足够了。

* * *

对于 Windows，有一个函数[`SetEndOfFile()`](https://msdn.microsoft.com/en-us/library/windows/desktop/aa365531(v=vs.85).aspx)和一个相关函数[`SetFileValidData()`](https://msdn.microsoft.com/en-us/library/windows/desktop/aa365544(v=vs.85).aspx)函数可以完成类似的工作，但使用不同的界面。基本上，您寻找要设置文件结尾的位置，然后调用该函数。

[sofr](https://stackoverflow.com/users/103521/sofr)`_chsize()`的[答案](https://stackoverflow.com/a/874704/15168)中还记录了一个功能。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-05-17T14:18:40.733

在 Windows 系统中，没有标题`<unistd.h>`，但您可以使用以下方法截断文件

```
 _chsize( fileno(f), size); 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-16T22:31:54.827

这是您的操作系统的功能。标准的 POSIX 方法是：

```
open("file", O_TRUNC | O_WRONLY); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-17T00:54:41.643

如果这是在某种 UNIX 风格下运行，那么这些 API 应该可用：

```
 #include <unistd.h>
   #include <sys/types.h>

   int truncate(const char *path, off_t length);
   int ftruncate(int fd, off_t length); 
```

根据我的 Linux 机器上的“man truncate”，这些是符合 POSIX 的。请注意，如果您传递的长度大于当前长度，这些调用实际上会增加文件的大小（！）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-16T22:32:56.867

如果您想截断整个文件，打开文件进行写入即可。否则，您必须打开文件进行读取，并将文件中您要保留的部分读取到临时变量中，然后将其输出到您需要的任何地方。

截断整个文件：

```
FILE *file = fopen("filename.txt", "w"); //automatically clears the entire file for you. 
```

截断文件的一部分：

```
FILE *inFile("filename.txt", "r");
//read in the data you want to keep
fclose(inFile);
FILE *outFile("filename.txt", "w");
//output back the data you want to keep into the file, or what you want to output. 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-16T22:35:26.113

**<编辑>**

啊，你编辑了你的帖子，你正在使用 C。当你打开文件时，像这样以“w+”模式打开它，它会截断它以备写入：

```
FILE* f = fopen("C:\\gabehabe.txt", "w+");
fclose(file); 
```

**</编辑>**

要在 C++ 中截断文件，您可以简单地为文件创建一个 ofstream 对象，使用**ios_base::trunc**作为文件模式来截断它，如下所示：

```
ofstream x("C:\\gabehabe.txt", ios_base::trunc); 
```

# c# - C# .NET 3.5 WinForms 的部分透明度？

> ID：873470
> 
> 赞同：2
> 
> 时间：2009-05-16T22:38:00.960
> 
> 标签：c#, .net, winforms, drawing, transparency

我正在制作一个 .NET 3.5 应用程序，其表单绘制了部​​分透明的黑色背景。我正在重写 OnPaintBackground 来完成此操作：

```
protected override void OnPaintBackground( PaintEventArgs e )
{
    using ( Brush brush = new SolidBrush( Color.FromArgb( 155, Color.Black ) ) )
    {
        e.Graphics.FillRectangle( brush, e.ClipRectangle );
    } 
} 
```

它可以工作，但有时表单会在不清除屏幕的情况下自行绘制，从而使透明度比应有的更暗。我试过玩`Graphics.Flush()`and `Graphics.Clear()`，但它要么无济于事，要么完全消除了透明度。有什么建议么？

**编辑：** 这是它的样子，在左侧启动应用程序后，在表单重绘自身几次（以响应从一个控件到另一个控件的选项卡）之后：

[透明度问题 http://www.quicksnapper.com/files/5085/17725729384A10347269148_m.png](http://www.quicksnapper.com/files/5085/17725729384A10347269148_m.png)

**编辑2：** 我今天早上尝试了一些事情，并注意到当透明部分后面的桌面发生变化时，它实际上并没有被重绘。例如，如果我打开任务管理器并将其放在窗口后面，您不会看到它自行刷新。这与我在透明度级别上看到的情况是有道理的。是否有让 Windows 重绘窗口后面区域的功能？

**编辑 3：** 我尝试更改表单上的一些属性，但它们都导致表单绘制不透明的黑色：

```
this.AllowTransparency = true;
this.DoubleBuffered = true;
this.Opacity = .99; 
```

我将尝试为透明部分创建一个单独的窗口，正如提到的过度松弛，但仍然欢迎任何其他想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T01:42:32.327

实际上，我想我会称之为预期的行为。我要做的是将我的背景渲染到内存中的位图，并在绘制事件中将其复制到表单（基本双缓冲）。

如果我离基地很远，你能张贴截图吗？我不知道我在想象你所描述的正确。

编辑：

我想知道您使用 OnPaintBackground ... pre-.NET，如果您正在进行双缓冲，您会捕获并忽略 WM_ERASKBKGND 消息（以防止闪烁），将图像渲染到屏幕外缓冲区，然后从WM_PAINT 上的屏幕缓冲区。因此，尝试从 OnPaintBackground 更改为 OnPaint。

我在 .NET 中并没有做过太多此类事情，但我之前已经很好地处理了它；就是不知道翻译好不好！

编辑2：

马克，我越想你想做什么，问题就越多。我打算建议创建一个专门用于捕获屏幕并使其变暗的后台线程；但是，为了删除您自己的表单，您必须将可见性设置为 false，这会产生其他问题....

如果您不愿意放弃，我建议创建两个窗口并将它们“绑定”在一起。为您的背景窗口创建一个半透明窗口（通过设置不透明度），并为前景创建第二个“正常”窗口。在前景窗口上使用 SetWindowRgn 来切掉背景并将它们放在彼此的顶部。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T00:45:49.373

`Graphics.CompositingMode`设置`CompositingMode.SourceCopy`为? 这应该导致两次绘制背景等同于绘制一次，因为它将替换现有的 alpha/color 数据而不是在其上合成。

# c++ - 在任何情况下“双重链接”头文件是有用或必要的吗？(C++)

> ID：873473
> 
> 赞同：1
> 
> 时间：2009-05-16T22:42:40.043
> 
> 标签：c++, include, header, infinity

我使用术语“双链接”是因为我不知道实际的短语是什么，或者是否有一个，但假设您有两个标题，head1.h 和 head2.h，其中包含以下内容：

在 head1.h 中：

```
#include"head2.h"
//do stuff 
```

在 head2.h 中：

```
#include"head1.h"
//do stuff 
```

我把它想象成两个彼此相对放置的镜子，因为它并不是真正的无限循环，而是某种其他形式的无限进入有限的计算机（但我离题了）。关键是，在任何情况下使用这个概念或这个概念的变体是有用或必要的吗？（即：我想 goto 可以用作即兴休息）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T22:47:01.140

通常，标头具有预处理器语句，以防止这种事情导致无限递归：

```
#ifndef MY_FILE_H
#define MY_FILE_H

//do stuff

#endif 
```

即使有这种保护，相互包含通常也是一个坏主意。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T22:45:42.000

这是一个“循环包含”，不，这不是一件可取的事情。你的 goto 不会有帮助，因为 goto 是程序执行的一部分，而 #includes 在编译的预处理阶段被解释。

通常的做法是使您的头文件具有类似的结构

```
#ifndef FOO_H
#define FOO_H
... rest of the include file here
#endif 
```

所以他们不会尝试两次定义相同的东西。

如果您尝试一下，会发生以下情况：

> bash $ gcc crecursive.c 在
> 从 bh.h:1 包含的文件中，
> 
> > ```
> >  from ah.h:1,  
> >             from bh.h:1,  
> >             from ah.h:1, 
> > ```
> > 
> > *...省略了许多行*
> > 
> > ```
> >  from ah.h:1,   
> >             from crecursive.c:2: ah.h:1:16: error: #include nested too deeply 
> > ```
> > 
> > 重击 $

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T22:48:43.787

避免这种情况的常用方法是使用空类声明。

```
//head1.h

class Foo;

class Bar {
public:
   Bar(Foo* f) : foo(f) {}
private:
   Foo* foo;
};

// head2.h

class Bar;

class Foo {
public:
    void func(Bar* bar); 
}; 
```

当一个头文件创建了许多需要在另一个之前声明的类时，您通常会得到一个包含文件，例如 .

```
//fwd.h

class Bar;
class Foo;

// head1.h

#include "fwd.h"

class Foo { ....

// head2.h

#include "fwd.h"

class Bar { .... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T22:52:02.017

> 我把它想象成两个相互对置的镜子，因为它并不是一个无限循环

你想象错了。;) 请记住，#include 只不过是复制/粘贴，它发生在您的程序编译之前。所以你设置的是编译期间的无限循环。编译器读取head1.h，它以#include "head2.h" 开头。所以它插入了 head2.h 并继续解析它，但它以 #include "head1.h" 开头，所以我们必须包含它，依此类推。

你通常有包括警卫来防止编译器进入无限循环。

The key is that this happens as plain text processing *before* the program is compiled, and certainly before it is executed, so it's not really something you can use for anything constructive, unless copy/pasting an infinite number of times is your idea of a fun time.

# c# - Visual Studio 2008 的圈复杂度

> ID：873485
> 
> 赞同：6
> 
> 时间：2009-05-16T22:52:58.397
> 
> 标签：c#, .net, visual-studio, visual-studio-2008

是否有任何工具可以在调试符号所在的左侧栏中显示 Visual Studio 的圈复杂度？

我似乎记得 Resharper 有一个插件，但不认为它在 4.5 中有效

有没有人见过任何类似的工具，除了VS中的内置支持

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T23:14:01.667

具有大量指标（包括 cc）的独立工具是[ndepend](http://www.ndepend.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T12:37:40.093

McCabe IQ ( [www.mccabe.com/iq.htm](http://www.mccabe.com/iq.htm) ) 由 Cyclomatic Complexity 的作者 Tom McCabe 开发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T23:19:53.993

我相信 CodeRush 以“交互方式”拥有它。但见鬼，何必呢，网上有资源可以为您提供无商业化的想法和实施。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T23:24:43.063

Developer Express 的 Coderush 可以做到这一点，而且效果很好。我保证。（除长期客户外，与公司没有任何关系）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T14:32:58.923

[Code Metrics](http://reflectoraddins.codeplex.com/Wiki/View.aspx?title=CodeMetrics)是一款出色的免费反射器插件，用于分析代码大小和复杂性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T23:22:12.830

Visual Studio 2008 团队系统（或只是 VS 2008 开发人员版）具有代码度量。 [StudioTools](http://www.exactmagic.com/products/studiotools/)是 VS 2005 和 VS 2008 的免费插件。NDepend 也很好。

# c# - 在使用 WinForms (C#) 绘制字符串后确定字符串的位置

> ID：873501
> 
> 赞同：0
> 
> 时间：2009-05-16T23:11:16.073
> 
> 标签：c#, winforms

我在一个大边界框上绘制一个字符串，并使用 StringFormat 适当地对齐字符串。但是，一旦绘制字符串，我需要字符串的实际 (X, Y) 位置（不仅仅是 MeasureString 给出的大小）。

我正在使用下面的代码：

```
CharacterRange[] ranges = { new CharacterRange(0, this.Text.Length) };
format.SetMeasurableCharacterRanges(ranges);

//Measure character range
Region[] region = g.MeasureCharacterRanges(this.Text, this.Font, layoutRect, format);
RectangleF boundsF = region[0].GetBounds(g);
bounds = new Rectangle((int)boundsF.Left, (int)boundsF.Top,
                       (int)boundsF.Width, (int)boundsF.Height); 
```

这是一个代码段，所以忽略任何丢失的声明。关键是上面代码给出的矩形大小不正确，字符串的最后一个字符被删除，只绘制了第一行字符串。

任何人都知道为什么，或者可能有更好的方法来解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T04:46:07.503

确保您使用正确的格式来衡量您的文本。您还没有包含完整的源代码，所以我不知道您是否包含。

您可以使用两种“标准”格式值： `StringFormat.GenericTypographic`和`StringFormat.GenericDefault`. 如果没记错的话，默认选择的通常是`GenericDefault`，但您在渲染 UI 时想要的是`GenericTypographic`。

因此，`new StringFormat()`您不想做，`StringFormat.GenericTypographic.Clone()`而是想做。`Graphics`这应该更正边距/间距，并为您提供与您在表面上看到的内容相匹配的测量结果。

我通常使用的策略是构建单个`StringFormat`实例并将其用于文本渲染和测量以确保排列整齐 - 我避免使用任何让我省略的方法，`StringFormat`因为默认值可能不是我想要的。

希望这可以帮助。如果您仍然遇到问题，请尝试发布更完整的代码片段，以便我们了解您是如何绘制文本的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T23:58:03.480

采用：

```
TextBox tb = new TextBox { Text = "Test", Multiline = true };
Size size = System.Windows.Forms.TextRenderer.MeasureText(tb.Text, tb.Font);
Point location = new Point( //Is this what you were looking for?
    tb.Location.X + size.Width, 
    tb.Location.Y + size.Height); 
```

请注意，此方法还有其他重载，请查看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T23:01:02.427

我肯定使用相同的 StringFormat 对象来测量和绘制文本。

我最终做的是我使用上面的代码，然后用 TextRenderer 再次测量并相应地调整大小和位置

# shell - 禁用基于操作系统的“功能”是不好的做法吗？

> ID：873507
> 
> 赞同：0
> 
> 时间：2009-05-16T23:15:18.170
> 
> 标签：shell, user-interface, operating-system

我无法理解的一件事是这里和网络上其他地方的持续质疑，关于禁用基于操作系统的“功能”。人们一直在问如何禁用默认的操作系统快捷方式（如复制粘贴、Windows 键等），或以编程方式禁用功能。

当然，这是非常非常糟糕的做法？用你的程序修改用户的操作环境，除非它专门针对帮助用户修改他们自己的操作环境（在我见过的大多数情况下，我都非常怀疑）。我永远不希望程序修改我绑定的快捷方式，或更改我的环境的默认行为/功能集。这是普遍共识，还是只有我一个人？它几乎违反了我能想到的所有基本启发式和可用性/一致性理论——尤其是最不惊讶的原则。

**那么，问题是：** *有没有时候（除了帮助用户修改他们的环境）操作/更改/禁用操作系统或用户一般环境的功能是可以接受的做法吗？* 如果程序在没有用户明确许可的情况下尝试禁用 Windows 键、复制/粘贴快捷方式、调整“开始”按钮文本或任何类似的事情，并且更改对于执行目的而言不是根本必要的程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T23:29:57.823

我相信如果您正在构建一个“设备”，例如您在书店中找到的售货亭，这是完全可以接受的。在这种情况下，禁用大多数已知的快捷方式和功能确实有意义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T00:15:55.327

不。

对于普通应用程序，用户期望控制并可能运行其他应用程序，这种行为只会破坏用户的期望，可能会损坏操作系统的原生可访问性功能，并且通常会导致挫败感。

即使是[ocdecio](https://stackoverflow.com/questions/873507/disabling-os-based-features-bad-practice/873533#873533)和[overslacked](https://stackoverflow.com/questions/873507/disabling-os-based-features-bad-practice/873530#873530)指出的例外情况，虽然出于善意，但也可能落入这个陷阱（您玩过多少游戏会崩溃而导致禁用重要系统功能，或者禁用任务切换但忘记禁用系统通知的信息亭。 ..) 只要有可能，开发人员应首先查看操作系统本身，以获取实现全屏、受限或信息亭应用程序的支持。

顺便说一句 - 标记 CW，非常主观。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T23:15:52.320

**元回答：当且仅当您这样做的***真正*原因是为了用户的利益时，这可能是一个好主意。

并且不要试图欺骗用户为了“安全”而这样做。你可以指望被公开命名和羞辱。

如果您为了*您的*利益而不是他们的利益而限制用户，那么您确实处于危险境地。未经我的明确许可而瘫痪我的机器将使您永远被列入带有极端偏见的过滤器列表...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T23:28:19.060

是的，我想是的，尽管这种情况很少见，而且应该是非常暂时的。例如，禁用屏幕保护程序的 DVD 播放器，或禁用 Windows 键的演示文稿、游戏或“父软件”类型的应用程序。

避免做这些事情是非常好的建议，但有时它是适当的，甚至是必要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T23:37:32.250

我见过在密码文本框中禁用剪切和粘贴的应用程序（我认为包括 Windows 操作系统）。

我同意有罕见的原因，但一般来说这是不好的做法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T00:16:28.633

winblows 终端仿真器上的 Ctrl-C 是与正常界面行为的良好差异的一个示例。

一般来说，禁用“正常”的 O/S 接口功能显然是愚蠢的。你能想象不得不在租车中寻找刹车踏板吗？把它赶出停车场会有多安全？不得不寻找灯、雨刷、指示灯和手刹已经够糟糕了……刹车踏板应该在中间，或者在左边；-) 它有效。不要用它 Effin Eff！

话虽如此：[Neil Frasers 的博客](http://neil.fraser.name/news/2005/01/22/)系统地破坏了 UI 设计的许多“通用原则”，通过评估它们在古老的 TI80 可编程计算器上的应用。“这导致了一个劣质的计算器”这句话不知何故烙印在我的脑海里。

我相信界面的*一致性*是最重要的。例如，我使用一个名为 SOATest 的产品。它是一个基于 Eclipse 的 Java 应用程序，用于测试 SOAP（等）Web 服务。它有一个**非常**烦人的怪癖。Ctrl-Insert 和 Shift-Insert 在它的任何文本区域都不起作用，但它们在它的许多（不是全部）文本框中起作用。如果这些键始终不起作用，我会更容易适应。我觉得这个小怪癖非常烦人，因为（对我作为一名专业程序员而言）它代表“只是简单的 ole**邋遢**的工作”。

所以... Keith 的 UI 设计第一条规则：无论您做什么，FFS 始终如一地做！您的用户很聪明，他们会适应。

干杯。基思。

# virtualization - 在虚拟机下使用 Vista 测试应用程序

> ID：873508
> 
> 赞同：0
> 
> 时间：2009-05-16T23:16:19.853
> 
> 标签：virtualization, virtual-pc

有谁知道如何在虚拟机上安装 Vista UPGRADE 版本？我想用它来测试旧版本的 .NET，但它不会让我安装升级版本。我宁愿不必安装 XP 然后升级它。它是带有 CD-Key 和所有内容的许可合法副本。它只是不会安装到空的 VM，因为它是升级版本。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T00:00:18.500

**警告：以下内容确实违反了您的 EULA**

在不使用序列号的情况下安装 Vista 并选择基本版并取消选择自动激活。

安装后，重新安装，现在您可以使用您的序列号并执行升级。

有关更多深入信息，请参见[Paul Thurrot 的网站。](http://www.winsupersite.com/showcase/winvista_upgrade_clean.asp)

# javascript - 在javascript中如何检索实现子类名称

> ID：873509
> 
> 赞同：2
> 
> 时间：2009-05-16T23:16:25.047
> 
> 标签：javascript, inheritance

假设我有一个这样的“抽象类”：

```
function AbstractClass() {    
  this.getImplementingName = function() {
      return /* how do I get this? */;
  }    
} 
```

和一个像

```
function ImplmentingClass() {
}
ImplmentingClass.prototype = new AbstractClass();

var impl = new ImplmentingClass()
var name = impl.getImplementingName(); 
```

/* 我如何得到... (name == 'ImplementingClass') */

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-10T23:58:39.363

你看，两者都 -`AbstractClass`并且`ImplementingClass`只是函数。Javascript 中的函数（通常在 ECMAScript 中）没有任何与它们相关联的类似字符串的“名称”值。`AbstractClass`在这种情况下`ImplementingClass`是函数***标识符***；这些*标识符*只是每个**函数声明**的一部分（但并不总是函数表达式，这就是函数表达式可以是**匿名**的原因）。

在一些 ES3 实现中，这个*Identifier*的值在函数创建期间被自动分配给函数对象的**name属性。**当然，这是一个非标准扩展，目前由一些基于 Gecko 和 WebKit 的浏览器实现。ES 委员会也在讨论它，并且可能会进入 ECMAScript 的未来版本。

```
(function foo(){}).name; // "foo" in Safari 4.x and FF 3.x 
```

还有**toString 方法**，可通过以下方式在所有 Function 对象上使用`Function.prototype.toString`：

```
String(function foo(){}); // "function foo() {}" 
```

不幸的是，ECMAScript 指定这个方法来返回**依赖于实现的函数表示**，因此依赖解析这个值是相当脆弱的。这种解析被称为**函数反编译**，并且通常被推荐反对，因为它是非标准的和古怪的（我写了几次关于[这些](http://thinkweb2.com/projects/prototype/those-tricky-functions/) [怪癖的文章）。](http://thinkweb2.com/projects/prototype/detecting-built-in-host-methods/)请注意，下一版本的 ECMAScript（ES5，当前草案）也不会更改这些规则。

您最好的选择是手动分配财产或雇用某种类似工厂的助手。例如：

```
function initFn(name, fn) {
  fn.name = name;
  return fn;
}
// and then
var AbstractClass = initFn('AbstractClass', function(){
  // ...
});

// or directly

function foo(){}
foo.name = 'foo'; 
```

请注意这里的重复（“AbstractClass”字符串），不幸的是，只能通过使用`eval`或`Function`构造函数（两者都不是理想的解决方案）来避免重复。

如果您需要实例对象知道其构造函数的“名称”，那么通过某种抽象实现类似的“捎带”应该是微不足道的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T23:22:32.723

检查 .constructor 属性（和/或 instanceof 运算符）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T23:49:55.763

我认为没有直接的方法可以完成您要完成的工作，但这就是我的处理方式。我会在 implementationClass 中覆盖 toString()。

```
function AbstractClass() {
    this.getImplementingName = function() {
        return this.toString();
    }
}
function ImplmentingClass() {
  this.toString = function(){return "ImplementingClass";}
}
ImplmentingClass.prototype = new AbstractClass();

var impl = new ImplmentingClass()
var name = impl.getImplementingName(); /* name equals "ImplementingClass" */ 
```

# java - java.util.Properties 为什么要实现 Map而不是地图

> ID：873510
> 
> 赞同：55
> 
> 时间：2009-05-16T23:17:02.347
> 
> 标签：java, generics, collections

该类`java.util.Properties`旨在表示键和值都是字符串的映射。这是因为`Properties`对象用于读取`.properties`文件，即文本文件。

那么，为什么在 Java 5 中他们改造这个类来实现`Map<Object,Object>`而不是`Map<String,String>`？

[javadoc](http://java.sun.com/j2se/1.5.0/docs/api/)指出：

> 因为 Properties 继承自 Hashtable，所以 put 和 putAll 方法可以应用于 Properties 对象。强烈建议不要使用它们，因为它们允许调用者插入键或值不是字符串的条目。应该改用 setProperty 方法。如果在包含非字符串键或值的“受损”属性对象上调用存储或保存方法，则调用将失败。

既然键和值都应该是字符串，那么为什么不通过使用适当的泛型类型来静态地强制执行呢？

我猜`Properties`实现实现`Map<String,String>`不会完全向后兼容为 pre-Java 5 编写的代码。如果您有将非字符串粘贴到 Properties 对象中的旧代码，那么该代码将不再使用 Java 5 编译。但是......不是这不是一件好事吗？泛型的重点不是在编译时捕获此类类型错误吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-17T01:21:21.113

因为他们在 Java 的早期就匆匆忙忙地做了，并没有意识到四个版本之后会有什么影响。

泛型从一开始就应该是 Java 设计的一部分，但由于过于复杂并且在当时没有必要，该特性被放弃了。结果，标准库中的许多代码都是在假设非泛型集合的情况下编写的。Martin Odersky 的原型语言“Pizza”展示了如何在保持近乎完美的向后兼容性的同时很好地完成 Java 代码和字节码。原型导致了 Java 5，其中集合类被改造为泛型，以允许旧代码继续工作。

不幸的是，如果他们要追溯地`Properties`继承 from `Map<String, String>`，那么以下以前有效的代码将停止工作：

```
Map<Object, Object> x = new Properties()
x.put("flag", true) 
```

为什么有人会这样做，我无法理解，但是 Sun 对 Java 向后兼容性的承诺已经超越了英雄主义，变得毫无意义。

大多数受过教育的观察者现在赞赏的是，它`Properties`根本不应该继承`Map`。相反，它应该环绕`Map`，只暴露 Map 的那些有意义的特性。

自重新发明 Java 以来，Martin Odersky 继续创建新的 Scala 语言，该语言更简洁，继承的错误更少，并在许多领域开辟了新天地。如果您发现 Java 的琐事令人讨厌，请看一下。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-05-17T00:18:19.673

它最初的意图是`Properties`确实会扩展`Hashtable<String,String>`。不幸的是，桥接方法的实现引起了问题。`Properties`以这种方式定义会导致 javac 生成合成方法。`Properties`例如，应该定义一个`get`返回 a`String`但需要覆盖返回的方法`Object`。因此添加了合成桥接方法。

假设你有一个糟糕的 1.4 天写的课程。您已经覆盖了`Properties`. 但是你没有做的是覆盖新方法。这会导致意外行为。为了避免这些桥接方法，`Properties`请扩展`Hashtable<Object,Object>`。同样`Iterable`不返回 a (read-only) `SimpleIterable`，因为那会为`Collection`实现添加方法。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-03-18T11:59:37.323

用于从属性创建地图的单行（无警告的两行）：

```
@SuppressWarnings({ "unchecked", "rawtypes" })
Map<String, String> sysProps = new HashMap(System.getProperties()); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-16T23:58:35.663

向后兼容性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-16T23:36:29.367

原因：[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)和向后兼容性。`Properties`扩展`Hashtable`，因此必须接受所有可以接受的消息`Hashtable`——这意味着接受`put(Object, Object)`。而且它必须扩展普通`Hashtable`而不是`Hashtable<String, String>`因为泛型是通过[类型擦除](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)以向下兼容的方式实现的，所以一旦编译器完成了它的工作，就没有泛型了。

# list - 如何检查包含单词的短域的可用性？

> ID：873514
> 
> 赞同：0
> 
> 时间：2009-05-16T23:18:05.510
> 
> 标签：list, dns

我需要检查所有包含单词“hello”的短域的可用性。它可以是“hellohi”、“aahellokk”或“hellowhello”之类的任何内容。我知道有一些服务，例如[http://www.bluehost.com/cgi-bin/signup](http://www.bluehost.com/cgi-bin/signup)，您需要在其中一个接一个地键入域。但是，我想批量检查它们。然后，我需要生成一个单词列表。我错误地在 Zsh 中测试：

```
echo {1..10}hello{A..Z}{5} > test 
```

我不知道生成单词列表的最简单方法是什么。您将如何检查可用性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T23:36:03.300

这是我的 Python 解决方案。要生成域，请使用以下内容：

```
from itertools import product, permutations
import operator

chars = 'abcdefghijklmnopqrstuvwxyz0123456789'
l = 2    # Max prefix / suffix length
words = reduce(operator.add, [[''.join(p) for p in permutations(chars, i)] for i in range(1, l+1)])
domains = [w[0] + 'hello' + w[1] for w in product(words, words)] 
```

`l`如果大于 2 或 3，这将需要很长时间并使用大量内存。此外，某些`itertools`功能需要 Python 2.6。

要检查域是否可用，请使用：

```
import commands

for domain in domains:
    output = commands.getoutput('whois %s.com' % domain).lower()
    if 'not found' in output or 'no match' in output:
        print domain + '.com' 
```

为了加快速度，您可以使用线程进行 whois 检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T23:39:16.553

如果您真的想要 zsh 解决方案，请使用 eg`host`或`dig`执行`nslookup`DNS 查询，并假设失败意味着域仍然可用。注意性能：其中一些实用程序可能比其他实用程序更快。

如果我可以问：你需要这个做什么？你是域名抢注者吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-10T00:24:44.740

您可以使用此[域搜索 API](http://www.domainsearchguru.com/index.php/site/domain_search_api)来检查[域名可用性](http://www.domainsearchguru.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T23:39:26.710

除了最短的名称和大词之外，可能的域数量非常大；创建它们的列表是不可行的。例如，对于您想要检查 4 个字母单词的潜在 11 个字母的域名，您正在查看至少 20 亿个组合（粗略估计）。当然，如果您想检查 11 个字母的域名是否有 10 个字母的单词，那么您只需要查看 72 种可能性。

# macos - 核心动画代码结构/约定

> ID：873515
> 
> 赞同：2
> 
> 时间：2009-05-16T23:18:10.113
> 
> 标签：macos, cocoa, core-animation

在学习 Core Animation 的过程中，我很快就了解到，如果你做得不对，你会得到非常奇怪的未定义行为。为此，我有几个问题可以帮助我在概念上更好地理解它。

*   我的 NSView 子类在它的 init 中声明了以下内容。该视图是普通层支持视图的子视图。

    ```
    [self setLayer:[CALayer layer]];
    [self setWantsLayer:NO]; 
    ```

    在此之后，我应该在什么时候以及在什么情况下使用 self 而不是 [self layer]？我一直只使用显式和隐式动画来操作图层，远离 [self setFrame:] 等并使用 [[self layer] setPosition] 等。

*   这种方法的问题在于，视图的实际帧在任何和所有应用的动画中都停留在一个位置。如果我的视图应该接收鼠标事件怎么办？例如，我有一个使用核心动画的视图，它被鼠标拖动。有没有办法让视图框架与表示层的当前状态保持同步，以便接收正确的鼠标事件？

*   关于表示层，显然它仅在实际动画正在进行时才可用。是否有任何类型的图层属性可以告诉我它实际上在视觉上的位置，即使动画没有在进行中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T03:00:13.183

首先，您要使用`[self setWantsLayer: YES]`. 此外，如果您想提供特定的 CALayer 子类（例如 CAScrollLayer） ，则仅`-setLayer:`在之前调用很重要；`-setWantsLayer:`如果你只想要一个普通的 CALayer，你只需调用`-setWantsLayer:`它，它就会为你创建。更好的是，只需检查 Interface Builder 中的“wants layer”选项。

其次，使用 layer-backed view 的全部意义在于你可以继续使用常规的 NSView 方法并获得免费的 CoreAnimation 'tweening' 效果。如果您想使用 CoreAnimation 作为移动项目的唯一方法，那么正确的方法是创建一个*包含*纯 CALayer 表示层次结构的图层支持视图。

我没有看过任何免费提供的 CoreAnimation 教程，但我绝对可以推荐 Pragmatic Programmers[关于这个主题的书](http://www.pragprog.com/titles/bdcora/core-animation-for-mac-os-x-and-the-iphone)。他们还提供了本书作者提供[的截屏视频。](http://www.pragprog.com/screencasts/v-bdcora/creating-a-compelling-user-interface-with-core-animation)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-19T21:56:45.883

我认为你需要重新表述你的问题。似乎有一些潜在的误解，但你并没有真正表达得很清楚。您的问题标题表明您正在寻找更理论的东西，但您的实际问题表明您正在寻找更具体的东西。让我看看我是否可以澄清一些事情。

*   *PresentationLayer*在“飞行中”提供有关图层当前状态的信息。

*   当没有动画发生时，*presentationLayer*和*图层*信息将相同。查询*图层的*边界、框架或位置以找出它当前在其父坐标空间中的位置。

*   NSView 必须启用图层支持才能执行动画。

*   确保您不仅使用显式动画制作动画，也没有实际设置您正在制作动画的图层值。动画不会自动更改正在制作动画的图层的属性。您必须自己将属性更改为结束值，否则它只会“恢复”到起始值。

*   如果你想动画视图，而不是层，你可以使用动画代理，比如`[[view animator] setFrame:newFrame];`

*   在 CATrasaction 中包装对动画师的调用以更改动画持续时间等内容。

让我知道您是否需要通过更新您的问题进行澄清。提供一些相关的代码确实有助于识别您在解决问题时遇到的问题。

# objective-c - 在 Cocoa 中重命名文件？

> ID：873522
> 
> 赞同：24
> 
> 时间：2009-05-16T23:23:05.127
> 
> 标签：objective-c, cocoa, nsfilemanager, file-management

如何重命名文件，将文件保存在同一目录中？

我有一个包含文件完整路径的字符串，以及一个包含新文件名（并且没有路径）的字符串，例如：

```
NSString *old_filepath = @"/Volumes/blah/myfilewithrubbishname.avi";
NSString *new_filename = @"My Correctly Named File.avi"; 
```

我知道 NSFileManager 的[movePath:toPath:handler:](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSFileManager_Class/Reference/Reference.html#//apple_ref/occ/instm/NSFileManager/movePath:toPath:handler:)方法，但我无法锻炼如何构造新文件的路径..

基本上我正在寻找与以下 Python 代码等效的代码：

```
>>> import os
>>> old_filepath = "/Volumes/blah/myfilewithrubbishname.avi"
>>> new_filename = "My Correctly Named File.avi"
>>> dirname = os.path.split(old_filepath)[0]
>>> new_filepath = os.path.join(dirname, new_filename)
>>> print new_filepath
/Volumes/blah/My Correctly Named File.avi
>>> os.rename(old_filepath, new_filepath) 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-16T23:31:19.723

NSFileManager 和 NSWorkspace 都有文件操作方法，但 NSFileManager`- (BOOL)movePath:(NSString *)source toPath:(NSString *)destination handler:(id)handler`可能是你最好的选择。使用 NSString 的路径操作方法来获取正确的文件和文件夹名称。例如，

```
NSString *newPath = [[oldPath stringByDeletingLastPathComponent] stringByAppendingPathComponent:newFilename];
[[NSFileManager defaultManager] movePath:oldPath toPath:newPath handler:nil]; 
```

文档中对这两个类都进行了很好的解释，但是如果有任何您不明白的地方，请发表评论。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-06T02:03:40.910

值得注意的是，将文件移动到自身会失败。我有一个用下划线替换空格并将文件名设为小写并将文件重命名为新名称的方法。名称中只有一个单词的文件将无法重命名，因为新名称在不区分大小写的文件系统上将相同。

我解决此问题的方法是进行两步重命名，首先将文件重命名为临时名称，然后将其重命名为预期名称。

一些解释这一点的伪代码：

```
NSString *source = @"/FILE.txt";
NSString *newName = [[source lastPathComponent] lowercaseString];
NSString *target = [[oldPath stringByDeletingLastPathComponent] stringByAppendingPathComponent:newName];

[[NSFileManager defaultManager] movePath:source toPath:target error:nil]; // <-- FAILS 
```

解决方案：

```
NSString *source = @"/FILE.txt";
NSString *newName = [[source lastPathComponent] lowercaseString];

NSString *temp = [[oldPath stringByDeletingLastPathComponent] stringByAppendingPathComponent:[NSString stringWithFormat:@"%@-temp", newName]];
NSString *target = [[oldPath stringByDeletingLastPathComponent] stringByAppendingPathComponent:newName];

[[NSFileManager defaultManager] movePath:source toPath:temp error:nil];
[[NSFileManager defaultManager] movePath:temp toPath:target error:nil]; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-17T00:07:53.583

我只是想让新手更容易理解这一点。这是所有代码：

```
 NSString *oldPath = @"/Users/brock/Desktop/OriginalFile.png";
NSString *newFilename = @"NewFileName.png";

NSString *newPath = [[oldPath stringByDeletingLastPathComponent] stringByAppendingPathComponent:newFilename];
[[NSFileManager defaultManager] movePath:oldPath toPath:newPath handler:nil];

NSLog( @"File renamed to %@", newFilename ); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-06-05T03:17:52.887

这是 iOS 的最新示例， NSFileManager 方法有点不同：

```
NSString *newFilename = [NSString stringWithFormat:@"%@.m4a", newRecording.title];

NSString *newPath = [[newRecording.localPath stringByDeletingLastPathComponent] stringByAppendingPathComponent:newFilename];
[[NSFileManager defaultManager] moveItemAtPath:newRecording.localPath toPath:newPath error:nil]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-02T05:52:23.953

对于顶部的糖衣，NSFileManager 上的一个类别：

```
@implementation NSFileManager (FileManipulations)

- (void)changeFileNamesInDirectory:(NSString *)directory changeBlock:(NSString * (^) (NSString *fileName))block
{
    NSString *inputDirectory = directory;

    NSFileManager *fileManager = [NSFileManager new];

    NSArray *fileNames = [fileManager contentsOfDirectoryAtPath:inputDirectory error:nil];
    for (NSString *fileName in fileNames) {

        NSString *newFileName =  block(fileName);

        NSString *oldPath = [NSString stringWithFormat:@"%@/%@", inputDirectory, oldFileName];
        // move to temp path so case changes can happen
        NSString *tempPath = [NSString stringWithFormat:@"%@-tempName", oldPath];
        NSString *newPath = [[oldPath stringByDeletingLastPathComponent] stringByAppendingPathComponent:newFileName];

        NSError *error = nil;
        [fileManager moveItemAtPath:oldPath toPath:tempPath error:&error];
        if (error) {
            NSLog(@"%@", [error localizedDescription]);
            return;
        }
        [fileManager moveItemAtPath:tempPath toPath:newPath error:&error];
        if (error) {
            NSLog(@"%@", [error localizedDescription]);
        }
    }
}

@end 
```

# erlang - 如何将元组对列表转换为 Erlang 中的记录？

> ID：873532
> 
> 赞同：5
> 
> 时间：2009-05-16T23:29:56.373
> 
> 标签：erlang

假设我有这个：

```
-record(my_record, {foo, bar, baz})。

Keyvalpairs = [{foo, val1},
               {bar, val2},
               {baz，val3}]。

Foorecord = #my_record{foo=val1，bar=val2，baz=val3}。

```

如何将 Keyvalpairs 转换为 Foorecord？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-17T01:05:26.750

最简单的做法是：

```
Foorecord = #my_record{foo=proplists:get_value(foo, Keyvalpairs), 
      bar=proplists:get_value(bar, Keyvalpairs),
      baz=proplists:get_value(baz, Keyvalpairs)}. 
```

如果这太重复了，您可以执行以下操作：

```
Foorecord = list_to_tuple([my_record|[proplists:get_value(X, Keyvalpairs)
      || X <- record_info(fields, my_record)]]). 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-29T09:09:04.110

就像其他答案指出的那样，您需要推出自己的解决方案来实现这一点。然而，提出的解决方案是不完整的。例如，它不考虑记录条目的默认值。我使用以下代码片段来处理此转换：

```
%% @doc returns a "RECSPEC" that can be used by to_rec in order to 
%% perform conversions
-define(RECSPEC(R), {R, tuple_to_list(#R{}), record_info(fields, R)}).

%% @doc converts a property list into a record.
-spec to_rec(recspec(), proplist()) -> record().
to_rec({R, [_ | N], Spec}, P) when is_atom(R) and is_list(Spec) ->
    list_to_tuple(
      [R | lists:foldl(
         fun ({K,V}, A) ->
             case index_of(K, Spec) of
                 undefined -> 
                     A;
                 I -> 
                     {Head, Tail} = lists:split(I, A),
                      Rest = case Tail of
                                [_ | M] -> M;
                                []      -> []
                            end,
                     Head ++ [V | Rest]
             end
         end, N, P)]). 
```

现在可以简单地做：

```
-record(frob, {foo, bar="bar", baz}).

to_rec(?RECSPEC(frob), [{baz, "baz"}, {foo, "foo"}]) 
```

产生

```
#frob{foo="foo", bar="bar", baz="baz"} 
```

我将它放入我正在构建的一个小“工具箱”库中，以收集这些小“片段”，这些小“片段”只会让开发 Erlang 应用程序时的生活更轻松：[ETBX](https://github.com/erickg/etbx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-16T21:46:06.890

如果你的值与记录中的顺序相同，你可以直接转换成记录，你只需要在列表的第一个元素的记录名称之前，然后将列表转换为元组。

```
Foorecord = list_to_tuple([my_record]++[Val || {_,Val} <- [{foo, val1},{bar, val2},{baz, val3}] ]). 
```

# javascript - 如何在javascript中检索文本区域的值

> ID：873536
> 
> 赞同：1
> 
> 时间：2009-05-16T23:31:50.067
> 
> 标签：javascript, jquery, ajax, forms, dom

我有一个带有文本区域输入的表单。我正在使用 JQuery 通过 AJAX 请求提交表单以更新数据库。我的问题是我很难从文本区域输入中检索数据。如果输入的 id 为“txtBody”，我尝试过：

```
var body = $("#txtBody").val(); // This adds 'undefined' to the database  
var body = $("#txtBody").text(); // This adds nothing to the database  
var body = $("#txtBody").html(); // This adds 'NULL' to the database 
```

我想不出还有什么方法可以访问数据。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T23:43:38.540

你说添加到数据库中。您是否调试过实际代码以确保您不只是使用一个变量名发送数据并尝试将其与另一个变量名一起添加？因为如果您有这样的字段：

```
<input type='text' id='txtBody' value='test'> 
```

或者像这样：

```
<textarea id='txtBody'>test</textarea> 
```

执行`$('#txtBody').val();` *将*返回值“test”。没有如果或但是。

也许您应该发布更多代码，以便我们找出问题所在，因为我猜这不是您遇到的实际问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T23:54:58.903

[jQuery 文档](http://docs.jquery.com/Attributes/val)表明 val() 不可用是 jQuery 的旧版本。你的版本是最新的吗？

# objective-c - 在objective-c中进行子类化时处理类方法

> ID：873538
> 
> 赞同：1
> 
> 时间：2009-05-16T23:32:38.457
> 
> 标签：objective-c

在尝试我在 Objective-C 中的第一个子类时，我遇到了以下我似乎无法解决的警告。对 decimalNumberWithMantissa 的调用给出了“从不同的 Objective-C 类型初始化”的警告。

```
#import <Foundation/Foundation.h>

@interface NSDecimalNumberSub : NSDecimalNumber {
}
@end

@implementation NSDecimalNumberSub
@end

int main (int argc, char *argv[]) {
    NSDecimalNumberSub *ten = [NSDecimalNumberSub 
          decimalNumberWithMantissa:10
          exponent:0
          isNegative:NO];
} 
```

类方法是否必须与子类区别对待？我错过了一些简单的东西吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T23:39:10.033

NSDecimalNumber 定义了`decimalNumberWithMantissa:...`返回 NSDecimalNumber 的方法，因此您将返回基类的实例，而不是您的自定义子类。您必须创建自己的便捷方法来返回子类的实例，或者只是分配并以另一种方式初始化它。

如果您正在编写自己的类，您可以定义一个方便的方法来返回 type `id`，然后`[[self alloc] init]`在创建实例时使用以使您的类可以安全地进行子类化。

# compression - zlib 压缩的字符串可以包含空格吗？

> ID：873544
> 
> 赞同：3
> 
> 时间：2009-05-16T23:35:12.380
> 
> 标签：compression, zlib

zlib 压缩的字符串可以包含空格吗？空格我的意思是''，\ n，\ t。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-16T23:47:11.917

任何字节都可以出现在 zlib 压缩字符串中。

事实上，对于一个足够长的正确压缩的字符串，任何字节（从 0 到 255）应该具有或多或少相等的概率，否则字符串可以被进一步压缩。

您可以自己尝试一下——例如使用 Python：

```
>>> z = open('/dev/urandom').read(1000000).encode('zlib') # compress a long string of junk
>>> [z.count(chr(i)) for i in range(256)] # number of occurrences of each byte
[3936, 3861, 3978, 3951, 3858, 3937, 3945, 3828, 3984, 3871, 3985, 
 3961, 3879, 3924, 3817, 3984, 3963, 3858, 4029, 3903, 3884, 3817, 
 ... yada ... 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-16T23:36:46.963

是的; 它只是一个字节流。任何字节值都可以出现在其中（包括零，这比空白字符更可能给您带来问题！）

# svn - Tortoise SVN 可以在 FTP 服务器上工作吗？

> ID：873552
> 
> 赞同：1
> 
> 时间：2009-05-16T23:38:50.330
> 
> 标签：svn, ftp, tortoisesvn

我正在开发一个基于 FTP 用户和更多程序员的项目。我希望他们应该能够与 [1] 协作并能够管理修订：http: [//tortoisesvn.tigris.org/](http://tortoisesvn.tigris.org/) “Tortoise SVN”]。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T23:50:39.223

这不是 SVN 的工作原理。您应该考虑与 Assembla 或 Unfuddle 等人建立一个 SVN 存储库，然后每个人都可以在您的个人计算机上使用您自己的本地副本工作。[SVN Book](http://svnbook.red-bean.com/)可能会有所帮助，如果您不想付费，它也可以帮助您在某个地方建立自己的存储库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-30T12:41:14.740

您可以尝试使用[netdrive](http://www.netdrive.net/download.html)，[这是](http://www.ebswift.com/Wiki/wikka.php?wakka=SubversionFTP)一个教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-01T13:10:39.507

我认为http（或ssh）是要走的路：

*   [http://howtoforge.com/debian_subversion_websvn](http://howtoforge.com/debian_subversion_websvn) (Debian Linux)
*   [http://www.visualsvn.com/server/](http://www.visualsvn.com/server/) (Windows)

但如果你不想自己做，你可能会在那里找到一个主机：

*   [http://www.svnhostingcomparison.com/](http://www.svnhostingcomparison.com/)

/约翰

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-16T23:52:32.963

为什么不使用 SSH（腻子）？

如今，大多数托管公司都提供此服务。我已经将我机器上的 Tortoise 和服务器上的远程 Subversion 客户端结合起来，并且运行良好！

# security - 我应该为我的赌博网站实施哪些安全措施？

> ID：873562
> 
> 赞同：0
> 
> 时间：2009-05-16T23:44:27.040
> 
> 标签：security, owasp

1.  使用诸如 OWASP 前十名之类的安全编码实践就足够了吗？
2.  我应该使用什么技术来检测篡改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T00:26:51.663

**完全不相信任何用户输入**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T00:03:29.553

虽然我没有任何内幕消息，但如果顶级赌博网站不使用上述安全编码做法，我会感到非常惊讶，因为它们处理的是真钱，而且经常处理大笔金额。

我所知道的是，一些在线扑克网站使用经过深思熟虑的机制来检测机器人，例如统计数据和点击检测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-07T07:57:20.740

是的，正如 JPCosta 所提到的，在线赌博网站更大的安全问题来自玩家代表他们玩的机器人。这些机器人被编写用于抓取其他赌注、使用智能逻辑和下注。这实际上导致人类与机器人比赛/下注（但假设它是人类）。这破坏了公平竞争，如果他输得更频繁，它将离开现场。

有第三方服务可以与您的应用程序集成以智能地检测机器人。[ShieldSquare](http://www.shieldsquare.com)就是其中之一

免责声明：我是 ShieldSquare 的联合创始人之一 - 一种机器人检测解决方案。

# python - 跟踪工作天数/小时数的时间表计划？

> ID：873564
> 
> 赞同：1
> 
> 时间：2009-05-16T23:45:59.470
> 
> 标签：python

假设我制作了一个程序来记录我的工作天数和工作时间，我会使用字典吗？我如何区分第 1 周的星期一和第 2 周的星期一？关闭程序后如何让它存储这些信息？（Python 语言）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T00:12:15.897

字典是在程序运行时存储数据的好方法。

有很多方法可以添加一些数据持久性（所以在你关闭程序之后就可以使用它）。Python 模块 pickle 和[shelve](http://docs.python.org/library/shelve.html)非常有用且易于使用。这些问题的一个问题是您无法轻松地检查 Python 程序之外的数据。还有一些模块可以读取和写入[JSON](http://docs.python.org/library/json.html)和 XML 格式的文本文件，而且 JSON 在文本编辑器中特别容易阅读。如果您还不精通，那么 MySQL 之类的数据库远比您提到的个人程序所需的要多，除非您想花一些时间来学习如何使用它们，否则您应该使用更简单的解决方案。

至于第 1 周和第 2 周的星期一，你有很多选择。您可以使用实际日期（这对我来说似乎是个好主意），或者您可以使用元组作为字典的键，例如 ("Monday", 1)。主要规则是字典键必须是不可变的（整数、字符串、元组——仅包含不可变对象等），但不是（字典、列表等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T23:50:10.740

我可能会为每周或支付周期创建一个时间表对象。每个时间表对象可能有一组天数，包括工作小时数或打卡时间。

对于网站的持久存储，我会使用 mysql 之类的数据库。对于在单台机器上运行的应用程序，我可能会使用 pickle，或者可能是平面文件系统。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T21:25:07.517

在为我自己设计这个应用程序时，我采取了相反的方法。

根据我的经验，计时应用程序的最大问题是数据输入。所以我决定让我的应用程序使用最简单、最灵活的数据输入工具：文本编辑器。我将笔记保存在一个文本文件中，并将计时条目混合在其中，因此摘录如下所示：

```
Monday 5/10/09

release script ok this week
open a case on the whole code-table-foreign-key thing

- CUS1 2.0 Generate and release version 1.0.45.

need to get dma to spec out the RESPRB configuration, see case 810
MH section complete - one to go!

- CUS2 4.0 Configure and test Mental Health section.

Tuesday 5/11/09

... and so on 
```

我坚持以正确的标题开始每一天，并且如您所见，实际计时条目的格式非常简单。只需一个简单的扫描仪和状态机即可提取数据 - 基本上，我只查找以工作日或连字符开头的行，而忽略其他所有内容。

为了让程序在解析笔记文件时不会变得太慢，我每年都会创建一个新的笔记文件。（即使在 12 月底，解析过程也不会超过 1/16 秒。）

如果我必须处理数百人的计时条目，我不会这样做，因为用户确实必须有一点线索，并且解析时间会在一段时间后开始加起来。另一方面，将这些数据保存在一个人类可读的文本文件中，我可以在其中存储其他内容（并保持在版本控制和差异等之下）非常有用。

# python - 如何在 Mac OS X 上安装 cogen python 协程框架

> ID：873577
> 
> 赞同：0
> 
> 时间：2009-05-16T23:52:39.843
> 
> 标签：python

我做了

```
sudo easy_install cogen 
```

并得到：

```
Searching for cogen
Best match: cogen 0.2.1
Processing cogen-0.2.1-py2.5.egg
cogen 0.2.1 is already the active version in easy-install.pth

Using /Library/Python/2.5/site-packages/cogen-0.2.1-py2.5.egg
Processing dependencies for cogen
Searching for py-kqueue>=2.0
Reading http://pypi.python.org/simple/py-kqueue/
Best match: py-kqueue 2.0.1
Downloading http://pypi.python.org/packages/source/p/py-kqueue/py-kqueue-2.0.1.zip#md5=98d0c0d76c1ff827b3de33ac0073d2e7
Processing py-kqueue-2.0.1.zip
Running py-kqueue-2.0.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-M8cj_5/py-kqueue-2.0.1/egg-dist-tmp-lDR6ry
kqueuemodule.c: In function ‘kqueue_new_kevent’:
kqueuemodule.c:71: warning: assignment makes pointer from integer without a cast
kqueuemodule.c: In function ‘kqueue_keventType_setattr’:
kqueuemodule.c:217: warning: assignment makes pointer from integer without a cast
kqueuemodule.c: In function ‘kqueue_new_kevent’:
kqueuemodule.c:71: warning: assignment makes pointer from integer without a cast
kqueuemodule.c: In function ‘kqueue_keventType_setattr’:
kqueuemodule.c:217: warning: assignment makes pointer from integer without a cast
No eggs found in /tmp/easy_install-M8cj_5/py-kqueue-2.0.1/egg-dist-tmp-lDR6ry (setup script problem?)
error: Could not find required distribution py-kqueue>=2.0 
```

希望获得有关如何在 Mac OS X 上安装依赖项的任何指示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T00:02:48.430

setuptools 似乎有些问题——依赖项已成功编译但未安装。FWIW 它对我有用（OSX 10.5.6，MacPython 2.5）。

我会尝试重新安装 setuptools，如果无法`python setup.py install`手动下载和“”ing cogen 和 py-kqueue。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T00:43:15.930

尝试下载“pip”（[http://pypi.python.org/pypi/pip](http://pypi.python.org/pypi/pip)）并使用它而不是easy_install。它对我有用。

# css - CSS 和选择最后一个 td

> ID：873588
> 
> 赞同：-1
> 
> 时间：2009-05-17T00:01:13.410
> 
> 标签：css, detailsview

摘要：detailsview的每个字段行都有2个td，它们的第一个td可以应用左边框。但是第二个（所以字段 tr(row) 最右边的单元格）不能应用。即使我尝试过

```
.dvRowEven td:nth-last-child(even) 
```

或者

```
.dvRowOdd td:last-of-type 
```

*现在我的完整信息：*

我正在尝试为 DetailsView（asp.net 控件）编写 css。

我完成了页眉和页脚。第一个 td 单元格（使用它们进行标记）具有 1px 实心边框（带有背景图像），但下一个 td 单元格（用于放置文本框、下拉列表等控件）不能应用于相同的图像：

```
.dvRowEven td:nth-last-child(even)
{
    border-right: solid 1px #B4B4B2;
    padding-left: 5px;
    padding-bottom: 3px;

    background-position:right top;
    background-image: url('../images/dv/tdLeftBorder.gif');
    background-repeat: repeat-y;
}
.dvRowOdd td:last-of-type
{
    border-right: solid 1px #B4B4B2;
    padding-left: 5px;
    padding-bottom: 3px;

    background-position:right top;
    background-image: url('../images/dv/tdLeftBorder.gif');
    background-repeat: repeat-y;
    background-color:Yellow;
} 
```

CSS 样式。我添加了整个样式。

```
body
{
    background-attachment: scroll;
    background-repeat: no-repeat;
    background-image: url('../images/bkg_topleft.jpg');
    background-position: left top;
    padding: 10px 0 0 10px;
    background-color: #f8f7f2;
    text-align: left;
}
.dv
{
    font-family: Trebuchet MS;
    text-align: left;
    background-image: url('../images/dv/dvAll.gif');
    background-repeat: repeat-x;
    -moz-border-radius: 75px;
    background-color: white;
    width: 350px;
    margin: 0 10px;
}
.dvHeader
{
    /*---------- HEADER ---------------*/
    border: 0;
    vertical-align: top;
}
.dvHeaderLeft
{
    float: left;
    width: 8px;
    height: 50px;
    background-image: url('../images/dv/headerLeft_50.gif');
    background-repeat: no-repeat;
    background-position: left top;
    border: 0;
    vertical-align: top;
}
.dvHeaderCenter
{
    float: left;
    height: 30px;
    padding: 10px;
    text-indent: 5px;
    font-size: 15px;
}
.dvHeaderRight
{
    float: right;
    width: 8px;
    height: 50px;
    background-image: url('../images/dv/headerRight_50.gif');
    background-repeat: no-repeat;
    background-position: right top;
    border: 0;
    vertical-align: top; /*---------- BİTTİ HEADER ---------------*/
}
.dvCommandRow td
{
    border-right: solid 1px #B4B4B2;
    border-left: solid 1px #B4B4B2;
    text-align: right;
    padding: 5px;
    background-image: url('../images/dv/tdLeftBorder.gif');
    background-repeat: repeat-y;
}
.dvCommandRow td a
{
    color: #3e6d8e;
    background-color: #e0eaf1;
    border: 1px solid #7f9fb6;
    margin-top: 2px;
    margin-right: 2px;
    margin-bottom: 2px;
    margin-left: 0pt;
    padding-top: 3px;
    padding-right: 4px;
    padding-bottom: 3px;
    padding-left: 4px;
    text-decoration: none;
    font-size: 90%;
    line-height: 2.2;
    white-space: nowrap;
}
.dvCommandRow td a:hover
{
    background-color: #3e6d8e;
    color: #e0eaf1;
    border: 1px solid #33ccff;
    text-decoration: none;
}
.dvFooter
{
    /*---------- FOOTER ---------------*/
    background-image: url('../images/dv/dvFooterCenter.gif');
    background-repeat: repeat-x;
    background-color: transparent;
    background-position: left top;
    border: 0;
    height: 6px;
    vertical-align: top;
}
.dvFooterLeft
{
    float: left;
    width: 8px;
    height: 6px;
    background-image: url('../images/dv/dvFooterLeft.gif');
    background-repeat: no-repeat;
    background-position: left top;
    background-color: Transparent;
    border: 0;
    vertical-align: top;
}
.dvFooterCenter
{
    float: left;
    height: 6px;
    background-image: url('../images/dv/dvFooterCenter.gif');
    background-repeat: repeat-x;
    border: 0;
    vertical-align: top;
}
.dvFooterRight
{
    float: right;
    width: 8px;
    height: 6px;
    background-image: url('../images/dv/dvFooterRight.gif');
    background-repeat: no-repeat;
    background-position: right top;
    border: 0;
    vertical-align: top; /*---------- BİTTİ FOOTER ---------------*/
}
.dvEmptyDataRow
{
    border-right: solid 1px #B4B4B2;
}
.dvRowEven td:nth-last-child(even)
{
    border-right: solid 1px #B4B4B2;
    padding-left: 5px;
    padding-bottom: 3px;

    background-position:right top;
    background-image: url('../images/dv/tdLeftBorder.gif');
    background-repeat: repeat-y;
}
.dvRowOdd td:last-of-type
{
    border-right: solid 1px #B4B4B2;
    padding-left: 5px;
    padding-bottom: 3px;

    background-position:right top;
    background-image: url('../images/dv/tdLeftBorder.gif');
    background-repeat: repeat-y;
    background-color:Yellow;
}
.dvField
{
    border-left: 1px solid #B4B4B2;
    padding: 0 5px;
    font-weight: bold;
    font-style: normal;
    text-align: right;
    background-image: url('../images/dv/tdLeftBorder.gif');
    background-repeat: repeat-y;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T01:24:05.037

对第一个/最后一个元素 CSS 规则的支持是不稳定的，并且不是在所有浏览器中都标准化。我发现的最佳折衷方案是在 CSS 中添加一个额外的“.last”类，并使用服务器端代码将该类粘贴到最后一个 TD 中。

# java - 有没有办法在Java中复制一个双重LinkedList而不参考？

> ID：873593
> 
> 赞同：1
> 
> 时间：2009-05-17T00:03:02.377
> 
> 标签：java, copy, linked-list

我正在创建一些 Double 类型的双向链表，无论我如何声明另一个相同类型的链表，它总是引用第一个列表。

如：

```
LinkedList<LinkedList<Double>> trainingData = new LinkedList<LinkedList<Double>>();
LinkedList<LinkedList<Double>> newData = new LinkedList<LinkedList<Double>>(); 
```

在 trainingData 中添加一些内容...

```
newData = trainingData; 
```

然后在 newData 中更改此分配后我对 trainingData 所做的任何更改。我还尝试在 newData 的构造函数中传递 trainingData 并使用嵌套循环将 trainingData 的数据分配给 newData，但它仍然给我与 newData 引用 trainingData 相同的结果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T00:08:07.873

您需要在列表中进行迭代并将每个元素复制/克隆到新列表中。

您面临的问题是 LinkedList 仅保留对其包含的元素的内部**引用。**当您将列表*a*复制到列表*b*时，您真正要做的是将列表 a 中的引用复制到列表 b，因此原始列表上的任何更改都会反映到新复制的列表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T05:24:11.610

这只是复制对列表的引用，而不是其内容。

```
newData = trainingData; 
```

您似乎需要的是深层副本，例如

```
newData = new LinkedList();
for(LinkedList ll: trainingData)
  newData.add(ll.clone()); 
```

# java - 在设计软件设备控制台与传统 Web 应用程序时，UI 设计有何不同？

> ID：873602
> 
> 赞同：1
> 
> 时间：2009-05-17T00:12:10.797
> 
> 标签：java, user-interface, usability

*   是否有任何用于此目的的开源框架？
*   在设计软件设备控制台与传统 Web 应用程序时，UI 设计有何不同？
*   有什么特别精心设计的软件设备用户界面的例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T02:11:25.050

最近刚刚经历过这个。第一条规则是让它比你做一个 Web 应用程序更简单。设计更简单，因为您希望它尽可能可靠。功能更简单，因为设备往往会长时间使用；您不想受到新浏览器变幻莫测的影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T02:18:14.783

我想你会发现[Alan Coopers的](http://www.cooper.com/)[关于 Face](https://rads.stackoverflow.com/amzn/click/com/0470084111)的书非常有用。我有这个的第一版，它谈到了应用程序的各种*姿势*。

在您的情况下，软件设备控制台是*瞬态*状态应用程序的一个示例 - 您不能假设用户具有先验知识或经验。这导致了各种决策——从提供更少的选择到包括更多的屏幕指导。

这比我在这里描述的要多，去买、借或偷一本自己读。

# javascript - 如何在固定 div 中显示图像以制作可滚动的图像面板？

> ID：873610
> 
> 赞同：1
> 
> 时间：2009-05-17T00:21:40.943
> 
> 标签：javascript, html, css, dom

我正在制作一个照片库脚本，其中涉及在固定宽度/高度框中显示图像。现在我希望该图像以其完整尺寸显示。我的意思是，如果框是`700x300`px，则图像不应调整大小，`700x300`而应以其自身的全分辨率显示。另外，如果可能的话，我可以以某种方式让它在框中拖动以便可以完全查看吗？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T00:40:57.717

要制作一个可拖动的窗格，您需要两个元素，一个用作容器的外部 div，一个用作“画布”的内部 div。外部容器需要将其样式设置为`overflow: hidden`.

```
<div id="drag-container">
    <div id="drag-canvas"><img></div>
</div> 
```

接下来，您需要使您的内部画布可拖动。在`mouseDown`内部，调用一个设置变量的函数`dragging = true`。在`mouseUp`调用将其设置为`false`. 您还需要存储鼠标位置`mouseDown`并减去内部 div 的顶部和左侧位置，以便您可以将其用作偏移量。

然后`mouseMove`根据鼠标位置设置内部画布的顶部和左侧位置。不要忘记添加偏移量，以便内部画布从您抓住它的点拖动，否则 div 的左上角将捕捉到鼠标位置。

还有几个库，比如[JQuery UI](http://jqueryui.com/)，它有一个“可拖动”方法，您可以直接将其应用于 div，从而简化此过程。真正的关键是让外部容器设置一个隐藏的溢出。

# iphone - 在什么时候我可以安全地访问 UIImageView 子类中的框架？

> ID：873612
> 
> 赞同：0
> 
> 时间：2009-05-17T00:23:10.333
> 
> 标签：iphone, cocoa-touch, uikit

我已经继承了 UIImageView。后

```
self = [super initWithImage:image] 
```

我尝试访问 self.frame.origin.y 值。但它始终为 0.0。片刻之后，在一个从外部调用的方法中，该属性完全存在，并且有一个不错的 100.0.0。

我也尝试覆盖-(id)initWithFrame:(CGRect)aRect，但结果是一样的。将视图添加到某个超级视图后，该属性是否首先正确设置？我相信我试图在对象被分配和初始化之后直接获取框架矩形，但在它被添加到超级视图之前。这发生在一行之后。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T00:27:30.353

可以随时设置对象的框架。如果您希望监视框架的更改，请覆盖`setFrame:`并`setBounds:`

```
- (void)setFrame:(CGRect)frame
{
    [super setFrame:frame];
    // Your code here
}
- (void)setBounds:(CGRect)bounds
{
    [super setBounds:bounds];
    // Your code here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T01:14:29.680

我无法重现此问题，但我不得不进行一些插值以猜测您期望 100 来自何处。你在哪里设置？这似乎工作正常：

```
- (id)initWithImage:(UIImage*)image {
    self = [super initWithImage:image];
    if (self != nil)
    {
        CGRect frame = self.frame;
        frame.origin = CGPointMake(100.0, 100.0);
        self.frame = frame;
        NSLog(@"y=%d", self.frame.origin.y);
        NSLog(@"frame=%@", NSStringFromCGRect(self.frame));
    }
    return self;
} 
```

也许你可以提供一段更大的代码？

# c++ - 为 C++ 应用程序提供 HTTP Web 服务器功能

> ID：873615
> 
> 赞同：2
> 
> 时间：2009-05-17T00:24:08.207
> 
> 标签：c++, web-services, http

我有一个 C++ 应用程序，正在寻找一个库，使其成为能够提供静态文件以及执行非常简单任务的 HTTP 服务器。唯一的限制是它必须是跨平台的。

我有什么选择。

澄清：我的应用程序需要一个 Web 界面。此应用程序是执行其他任务的后台程序。我想提供一种方法，以便您可以访问[http://localhost:9999/performtask](http://localhost:9999/performtask)或[http://localhost:9999/viewstatus](http://localhost:9999/viewstatus)

澄清2：像这样[http://www.gnu.org/software/libmicrohttpd/](http://www.gnu.org/software/libmicrohttpd/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T01:51:32.477

在[一个已被删除的问题中](https://stackoverflow.com/questions/175507/c-c-web-server-library)，我问：

> 我正在寻找一个用 C 或 C++（我正在用 C++ 编写我的应用程序）编写良好、灵活的库，它可以用来将一个相对简单的 HTTP 服务器嵌入到我的应用程序中。最终，我将使用它来进行应用程序监视和控制。
> 
> 有许多很棒的客户端库（例如 libwww、neon、curl），但我正在努力为服务器端找到一个好的解决方案。我敢肯定其他人以前也这样做过，所以我很想听听人们做了什么，什么有效，什么无效。

我最终选择了[Mongoose](http://code.google.com/p/mongoose/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-06T17:59:58.683

[Wt 库](http://www.webtoolkit.eu/wt)正是这样做的。推荐，尤其是当您的用户界面变得更复杂时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-23T21:25:31.433

通过使用 boost::asio 的 HTTP 服务器示例，我完成了您想要完成的相同事情。

[http://www.boost.org/doc/libs/1_43_0/doc/html/boost_asio/examples.html](http://www.boost.org/doc/libs/1_43_0/doc/html/boost_asio/examples.html)

这对我来说是一个完美的解决方案，因为我的项目已经依赖于 boost::thread 和 boost::asio，所以 HTTP Server 示例代码适合我的应用程序，我可以轻松地完全控制它的线程行为。我只是将 HTTP Server 示例文件复制到我的项目中并自定义了请求-响应逻辑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-20T22:48:18.067

只是一个想法 ！

为什么不将您的 c++ 应用程序代码转换为以下任何 http 服务器的本机/扩展模块。

*   阿帕奇网络服务器
*   IIS 7.0 本机模块
*   Nginx
*   LightHttpd

除 IIS 外，以上所有服务器都是跨平台的。

也许构建一个扩展模块会产生更好的输出，并且上述服务器也非常可扩展。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T01:22:47.553

我偏爱[poco 库](http://pocoproject.org)作为起点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-27T11:59:47.980

看看 Snorkel，它是一个轻量级的快速跨平台嵌入式/应用服务器 SDK，允许您快速将 Web 界面添加到任何 C/C++ 应用程序。它是免费的，可以在[http://sites.google.com/site/snorkelembedded](http://sites.google.com/site/snorkelembedded)找到。它比猫鼬快。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-17T00:44:14.650

Qt 框架有内置的 webkit。看看那个。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-05-17T00:37:40.423

Java 将是跨平台解决方案的更好选择，而且它具有良好的 Web 服务 API。看看 Netbeans，这是一个很好的入门方法。

# sql - 为什么 SQL Server 默认没有强制设置 WHERE 子句？

> ID：873616
> 
> 赞同：11
> 
> 时间：2009-05-17T00:24:48.597
> 
> 标签：sql, sql-server, tsql

这对我来说似乎很简单。我听过无数关于人们忘记 UPDATE 或 DELETE 中的 WHERE 子句并破坏整个表的故事。我知道粗心的人不应该直接发出查询以及所有这些......并且在某些合法情况下您想要影响所有行，但是默认情况下有一个需要此类查询的选项是否有意义写成：

```
UPDATE MyTable SET MyColumn = 0 WHERE * 
```

或者不改变语言，

```
UPDATE MyTable SET MyColumn = 0 WHERE 1 = 1 -- tacky, I know 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-17T00:29:24.857

因为[规范](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)不需要它，所以无论如何您都不应该直接针对生产数据运行 ad hoc sql。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-17T00:45:10.340

为了安全起见，我们总是可以在事务中运行：

```
BEGIN TRAN

UPDATE MyTable SET MyColumn = 0 
```

然后，如果行数看起来不错：

```
COMMIT TRAN 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-17T01:20:53.283

是否可以在您的客户端会话中将自动提交设置为默认值？您必须发出“提交”才能以这种方式查看您的更改，几乎是“您确定要这样做吗？” 时尚。

我相信这是前雇主所有 Oracle TOAD 客户的默认设置。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-17T00:35:37.417

犯这个错误对程序员来说是一个根深蒂固的成年礼。我们都做到了——并且彻底搞砸了生产数据——在修复它的过程中学到了很多东西。你只会犯一次这个错误，所以当它发生时看着开发人员加入这个行列是很有趣的。

阻止它发生会破坏所有的乐趣！

:)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-17T00:38:20.500

乔尔，我认为乔什的问题的重点是为什么规范不需要它，或者至少有一个选项设置会使特定数据库需要它？

由于规范不需要您说的那样，因此错误查询（即席或只是程序错误）有机会更改您不打算更改的数据库中的行。

隐含的“ALL ROWS”似乎比隐含的“NO ROWS”更危险。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-17T01:16:34.760

从我的角度来看，这是一个反问的问题，我的意思是这是一种建议......

实际上，我发现它非常好，可能有一些设置，如“SAFE_UPDATE”或类似的东西......

我通常做的，除了罗宾的提示（总是打开一个事务），是用 select 运行查询，只是为了看看将要更新的记录，像这样

```
update mytable set column = xx
-- select * from mytable
where mycondition = mycondition 
```

在更新之前，我只是从选择中选择并查看它返回的内容...

无论如何，你应该总是有一个备份（我听说 sql 2005 快照也很酷）并在事务中工作......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-04-01T22:26:58.513

MySQL 确实为即席查询提供了该选项。它被称为 --safe-updates（或 --i-am-a-dummy）。正如其他人指出的那样，我们都犯过一次这个错误。我们这些一直在运行临时查询的人，有时是在凌晨 1 点，已经不止一次犯了这个错误。

虽然我通常讨厌“白痴证明”系统和“你确定”对话框，但我喜欢这个选项。您应该始终小心，但即使小心，您也可能每千小时犯一个错误。如果您每周花费 50 小时以 root 身份登录生产系统，那么每千小时一个错误就是每年 2 1/2 次重大故障。出于这个原因，以及另一个原因，我们发现 --safe-updates 非常有用。

它比大多数 MS 确认消息更有用的原因有两个。首先，它会捕获最有可能是错误的内容，这与“您确定要删除该文件吗？”不同。大多数文件删除确实是需要的，所以确认是一个烦恼。大多数“从用户中删除”，如果缺少 where 子句，确实是一个错误。其次，它准确地指出了可能的问题 - 缺少 where 子句。就好像文件删除确认足够聪明地说“那是全新的更新副本，而不是您认为要删除的旧副本。您是真的要删除新副本，还是打算删除旧副本反而？”

无论如何，通常我讨厌“白痴证明”，但我喜欢 --safe-updates，如果它是一个选项，那些不想要它的人不需要使用它。我的一个担忧是，如果您经常在一个确实具有该功能的系统上工作，那么当他们切换到没有该功能的系统时（例如从 MySQL 切换到 MSSQL）可能会变得草率并遇到麻烦。

最后一个警告 - 没有一个头脑正常的人会在熟悉开源之后转向 MS。:)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-17T00:40:11.757

我从经验中知道，你只做一次......在它发生一次之后，你总是确保永远不要让它再次发生！

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-18T15:43:53.803

Josh 实际上，想要删除或更新表中的所有行并不是那么不寻常。

# c - 如何在 C 中清除此数组指针？

> ID：873620
> 
> 赞同：2
> 
> 时间：2009-05-17T00:26:58.980
> 
> 标签：c, arrays, pointers

我正在尝试使用系统调用来做一个基本的 bash，但是我在使用指针数组时遇到了一些小问题。

为了恢复我的代码，我使用 read() 从标准输入读取命令到缓冲区，然后使用 strsep() 将命令与参数和所有参数分离到一个数组中。然后我使用 fork() 创建一个新进程，并使用 execvp() 使用相关参数执行该命令。

所有这些都进入一个无限循环，直到用户键入“退出”（尚未编码）。问题是在第一次迭代之后，我需要 *pArgs 为空，用于下一个命令和参数。而且我不知道该怎么做...

这是我的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main(int argc, char **argv) {
    char bBuffer[BUFSIZ], *pArgs[10], *aPtr = NULL, *sPtr;
    int aCount;
    pid_t pid;

    while(1) {
        write(1, "\e[1;31mmyBash \e[1;32m# \e[0m", 27);
        read(0, bBuffer, BUFSIZ);

        sPtr = bBuffer;
        aCount = 0;

        do {
            aPtr = strsep(&sPtr, " ");
            pArgs[aCount++] = aPtr;
        } while(aPtr);

        pArgs[aCount-2][strlen(pArgs[aCount-2])-1] = '\0';

        // Debug code to output pArgs content
        write(1, "|>", 2);
        write(1, pArgs[0], strlen(pArgs[0]));
        write(1, "<|", 2);

        if(strlen(pArgs[0]) > 1) {
            pid = fork();

            if(pid == -1) {
                perror("fork");
                exit(1);
            }

            if(pid == 0) {
                execvp(pArgs[0], pArgs);
                exit(0);
            }
        }
    }

    return 0;
} 
```

PS：抱歉，我目前无法提供输入和输出测试用例。希望这并不难理解和修复，你们不需要它。如果需要的话，我会在稍后发布它......

**只是为了澄清事情：**
我知道我问过如何清除数组并且我得到了答案。但现在对我来说似乎很明显我的问题不是那个，而是 litb 指出的缓冲区正在收集的垃圾。用空字符终止字符串比清除数组更有意义。这就是我将 litb 的答案标记为正确答案的原因。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-17T00:30:11.313

```
int i;
for (i = 0; i < 10; i++)
   pArgs[i] = NULL; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T01:06:53.720

您的问题是您没有在读取数据后添加空字符。所以`strsep`电话不知道在哪里停止。在 C 中，字符串必须以空字符（称为终止空字符）终止。

```
// don't forget to add error handling at some point (s == -1)
ssize_t s = read(0, bBuffer, BUFSIZ-1);
bBuffer[s] = '\0'; 
```

有了这个，我看不到现在应该清除哪个数组，因为`execvp`将读取参数直到第一个空指针。然而`do`，循环已经添加了该空指针，它是最后一次调用返回的空指针`strsep`。

这个问题当然也可以通过清除 bBuffer （`*pArgs`扫描第一个命令后指向的数据）来解决。请注意，您也必须在第一次扫描之前这样做，因为您不能假设`bBuffer`数组中的字符被初始化为任何合理的值。

```
memset(bBuffer, 0, sizeof bBuffer); 
```

将它放在`read`调用之前（但无论如何，只读 maximally `BUFSIZE-1`，因为终止的空字符也必须有空格！）。

但正如我上面所展示的，你不需要这个 memset 调用。只需手动添加终止空字符。

# javascript - 为网页实现类似“服务器推送”的行为的最简单方法是什么？

> ID：873624
> 
> 赞同：4
> 
> 时间：2009-05-17T00:28:16.153
> 
> 标签：javascript, ajax, comet, reverse-ajax

我正在尝试为我的 Django 网站制作一个非常简单的 2 人聊天室。我正在学习 AJAX 来做到这一点。我需要部分网页在没有用户交互的情况下更新：

*   当用户 1 发送消息时，它应该出现在用户 2 的屏幕上
*   当用户 1 注销时，他的状态应在用户 2 的屏幕上更改为“离线”

实现这一点的最简单方法是什么？是否只是使用 JavaScript 定期轮询服务器？如果是这样，这样做的最佳做法是什么？我找到了一些关于使用 setInterval 或 setTimeout 的解决方案，但不确定这是否是最好的方法。

（我读过关于反向 AJAX 的文章，但从我读到的内容来看，这实现起来更复杂。我不需要我的解决方案快速或可扩展；我只需要它工作。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T00:48:55.713

既然你说你不关心[Comet](http://en.wikipedia.org/wiki/Comet_(programming))，这当然不是很容易上手，那么 setInterval 就可以了。不过，你想对它聪明一点。您可能应该以 30 秒的间隔开始。如果用户开始聊天，你的时间间隔应该下降到 5。随着你注意到越来越少的动作，你的计时器应该再次下降到 30 秒，依此类推。它不会在可扩展性大会上赢得任何奖项，但它会为您的普通中型网站完成。

有关此技术的更多信息，[请查看此相关问题](https://stackoverflow.com/questions/676098/server-polling-intervals-for-a-javascript-chat-client)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T00:49:34.653

利用[Orbited](http://www.orbited.org/)。乍一看很容易让你的眼睛呆滞，开始抱怨太复杂了，但一旦你通过了它，你就会明白什么是“最佳实践”，以及为什么它既快速又可扩展。

您还会发现自己意识到这是一项出色的技术，可用于*许多*动态网页行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-11T19:39:59.313

另一种半途而废的选择是[WebSync On-Demand](http://www.frozenmountain.com/websync)（或任何其他托管彗星服务......不确定是否还有其他）。它可以让您实现服务器推送功能，但使用起来很简单，因为您需要做的就是包含 javascript 客户端。

# javascript - 如何在 10 秒左右后弹出一个 div（使用 javascript 或 php）？

> ID：873626
> 
> 赞同：0
> 
> 时间：2009-05-17T00:29:27.493
> 
> 标签：javascript

有没有办法在页面加载后 10 秒后在页面中心弹出一个 div？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T00:34:05.673

您可以使用 Javascript 的[`setTimeout`](https://developer.mozilla.org/en/DOM/window.setTimeout)函数来执行此操作。

第二个参数是 Javascript 将等待多长时间（以毫秒为单位）直到调用第一个参数。

```
window.onload = function() {
    setTimeout(function() {
        document.getElementById('mydiv').style.display = 'block';
    }, 10000);
} 
```

假设您的 DIV 必须`display: none;`启动并且 ID 为“mydiv”，则上述内容应该有效。

# legacy-code - 在大型项目中处理潜在可重用遗留代码的正确礼仪是什么？

> ID：873628
> 
> 赞同：1
> 
> 时间：2009-05-17T00:30:17.943
> 
> 标签：legacy-code

我一直想知道解决这种情况的最佳方法是什么。如果有人决定再次将该功能添加到项目中，将旧代码留在注释块中的最佳方法是，还是为了保持源代码的清洁和可读性而删除此代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T00:36:08.117

这是重复的，但我没有时间找到重复的。

这也不是特定于遗留代码。所有代码都是遗留代码，直到不再使用。

答案是：使用源代码控制。这就是它的用途。源文件中的文本应该是当前正在执行的内容。没有其他的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T01:16:44.633

只要您使用源代码管理，我认为最好删除未使用的代码。将注释掉的代码与活动代码混合“以防万一”会使文件难以维护。如果其余代码正在积极开发中，那么注释代码很可能很快就会被抛在后面。如果僵尸代码未被注释，它可能根本不起作用，或者复活的代码可能会导致难以检测的问题。

我从事过“不要删除”的项目。这就像在垃圾场工作。搜索代码让我想哭。有些方法包含比编译代码更多的注释代码。疯狂！

# c# - 为可变对象覆盖 GetHashCode？

> ID：873654
> 
> 赞同：61
> 
> 时间：2009-05-17T00:53:35.423
> 
> 标签：c#, .net, overriding, equals, gethashcode

我已经阅读了大约 10 个关于何时以及如何覆盖的不同问题，`GetHashCode`但仍有一些我不太明白的问题。的大多数实现`GetHashCode`都是基于对象字段的哈希码，但有人指出，`GetHashCode`在对象的生命周期内，值永远不会改变。如果它所基于的字段是可变的，那它是如何工作的？另外，如果我确实希望字典查找等基于引用相等而不是我的覆盖`Equals`怎么办？

我主要是`Equals`为了便于对我的序列化代码进行单元测试而重写，我假设序列化和反序列化（在我的情况下为 XML）会杀死引用相等，所以我想确保它至少通过值相等是正确的。`Equals`在这种情况下，这是一种不好的做法吗？基本上在大多数执行代码中，我想要引用相等，我总是使用`==`并且我没有覆盖它。我应该只创建一个新方法`ValueEquals`或其他东西而不是覆盖`Equals`吗？我曾经假设框架总是使用`==`而不是`Equals`比较事物，所以我认为重写它是安全的，`Equals`因为在我看来，它的目的是如果你想要一个不同于`==`操作员。从阅读其他几个问题来看，情况似乎并非如此。

**编辑：**

似乎我的意图不清楚，我的意思是 99% 的时间我想要简单的旧引用相等，默认行为，没有意外。对于非常罕见的情况，我想要值相等，并且我想通过使用`.Equals`而不是显式请求值相等`==`。

当我这样做时，编译器建议我也覆盖`GetHashCode`，这就是这个问题的出现方式。`GetHashCode`当应用于可变对象时，似乎存在矛盾的目标，这些目标是：

1.  如果`a.Equals(b)`那么`a.GetHashCode()`应该`== b.GetHashCode()`。
2.  的值在`a.GetHashCode()`的生命周期内永远不会改变`a`。

当一个可变对象时，这些看起来自然是矛盾的，因为如果对象的状态发生变化，我们期望 的值发生`.Equals()`变化，这意味着`GetHashCode`应该改变以匹配 的变化`.Equals()`，但`GetHashCode`不应该改变。

为什么会出现这种矛盾？这些建议是否不适用于可变对象？可能是假设的，但可能值得一提的是，我指的是类而不是结构。

**解析度：**

我将 JaredPar 标记为已接受，但主要用于评论交互。总结一下我从中学到的是，实现所有目标并避免极端情况下可能出现的古怪行为的唯一方法是仅覆盖`Equals`和`GetHashCode`基于不可变字段，或实现`IEquatable`. 这种似乎减少了覆盖`Equals`引用类型的用处，因为据我所见，大多数引用类型通常没有不可变字段，除非它们存储在关系数据库中以用它们的主键来识别它们。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-17T01:07:07.030

## 如果它所基于的字段是可变的，那它是如何工作的？

从某种意义上说，哈希码不会随着对象的变化而变化。由于您阅读的文章中列出的所有原因，这是一个问题。不幸的是，这种问题通常只出现在极端情况下。因此，开发人员倾向于逃避不良行为。

## 另外，如果我确实希望字典查找等基于引用相等而不是我重写的 Equals 怎么办？

只要你实现这样的接口`IEquatable<T>`应该不是问题。大多数字典实现将选择一个相等比较器，以使用`IEquatable<T>`Object.ReferenceEquals。即使没有`IEquatable<T>`，大多数人都会默认调用 Object.Equals() ，然后将其进入您的实现。

## 基本上在大多数执行代码中，我想要引用相等，我总是使用 == 并且我没有覆盖它。

如果您希望您的对象具有值相等的行为，您应该覆盖 == 和 != 以强制所有比较的值相等。如果用户确实想要引用相等，他们仍然可以使用 Object.ReferenceEquals。

## 我曾经假设框架总是使用 == 而不是 Equals 来比较事物

BCL 使用的内容随着时间的推移发生了一些变化。现在大多数使用相等的情况将采用一个`IEqualityComparer<T>`实例并将其用于相等。在未指定一个的情况下，他们将使用`EqualityComparer<T>.Default`查找一个。在最坏的情况下，这将默认调用 Object.Equals

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-17T01:21:55.433

如果您有一个可变对象，则重写 GetHashCode 方法没有多大意义，因为您不能真正使用它。例如，`Dictionary`and`HashSet`集合使用它来将每个项目放入存储桶中。如果在对象用作集合中的键时更改对象，则哈希码不再匹配对象所在的存储桶，因此集合无法正常工作，您可能再也找不到对象。

如果您希望查找不使用类的`GetHashCode`or`Equals`方法，您可以随时提供自己的`IEqualityComparer`实现以在创建`Dictionary`.

该`Equals`方法旨在实现价值平等，因此以这种方式实现它并没有错。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-17T01:13:39.463

哇，这实际上是一个问题:-)。于是一个接一个：

> 有人引用 GetHashCode 的值在对象的生命周期内永远不应该改变。如果它所基于的字段是可变的，那它是如何工作的？

此常见建议适用于您希望将对象用作哈希表/字典等中的键的情况。HashTables 通常要求哈希不要改变，因为他们使用它来决定如何存储和检索密钥。如果散列发生变化，HashTable 将可能不再找到您的对象。

引用 Java 的*Map*接口的文档：

*注意：如果将可变对象用作映射键，则必须非常小心。如果对象的值以影响等于比较的方式更改，而对象是映射中的键，则不指定映射的行为。*

一般来说，使用*任何*类型的可变对象作为哈希表中的键是一个坏主意：如果键在添加到哈希表后发生更改，甚至不清楚会发生什么。哈希表应该通过旧键，还是通过新键，或者两者都返回存储的对象？

所以真正的建议是：只使用不可变对象作为键，并确保它们的哈希码也永远不会改变（如果对象是不可变的，这通常是自动的）。

> 另外，如果我确实希望字典查找等基于引用相等而不是我重写的 Equals 怎么办？

好吧，找到一个像这样工作的字典实现。但是标准库字典使用 hashcode&Equals，没有办法改变它。

> 我主要重写 Equals 以便于对我的序列化代码进行单元测试，我假设序列化和反序列化（在我的情况下为 XML）会杀死引用相等，所以我想确保它至少通过值相等是正确的。在这种情况下覆盖 Equals 是不好的做法吗？

不，我觉得这完全可以接受。但是，您不应将此类对象用作字典/哈希表中的键，因为它们是可变的。往上看。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T06:57:17.377

我不知道 C#，它是一个相对的菜鸟，但在 Java 中，如果你覆盖 equals()，你还需要覆盖 hashCode() 以维护它们之间的合同（反之亦然）......而 java也有相同的捕获 22；基本上强迫你使用不可变的字段......但这仅适用于用作哈希键的类，并且Java对所有基于哈希的集合都有替代实现......这可能没有那么快，但它们确实有效允许您使用可变对象作为键......它只是（通常）被视为“糟糕的设计”而皱眉。

我很想指出这个基本问题是永恒的……自从亚当还是个小伙子以来，它就一直存在。

我已经研究过比我（我 36 岁）更老的 fortran 代码，它在更改用户名时会中断（例如当一个女孩结婚或离婚时;-) ...这就是工程，采用的解决方案是：GetHashCode“方法”记住之前计算的hashCode，重新计算hashCode（即一个虚拟的isDirty标记），如果keyfields已经改变它返回null。这会导致缓存删除“脏”用户（通过调用另一个 GetPreviousHashCode），然后缓存返回 null，导致用户重新从数据库中读取。一个有趣且有价值的 hack；即使我自己这么说;-)

我将为 O(1) 访问（在所有情况下都需要）权衡可变性（仅在极端情况下需要）。欢迎来到工程；知情妥协之地。

干杯。基思。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T01:35:10.300

这里的基本主题是如何最好地唯一标识对象。您提到序列化/反序列化很重要，因为在该过程中会丢失参照完整性。

简短的回答是，对象应该由可用于这样做的最小的不可变字段集唯一标识。这些是您在覆盖 GetHashCode 和 Equals 时应该使用的字段。

对于测试，定义您需要的任何断言是完全合理的，通常这些断言不是在类型本身上定义的，而是作为测试套件中的实用方法。也许是 TestSuite.AssertEquals(MyClass, MyClass) ？

请注意，GetHashCode 和 Equals 应该一起工作。如果两个对象相等，GetHashCode 应该返回相同的值。当且仅当两个对象具有相同的哈希码时，Equals 应该返回 true。（请注意，两个对象可能不相等但可能返回相同的哈希码）。有很多网页可以正面解决这个话题，只需谷歌即可。

# iphone - 触摸处理切换到子视图

> ID：873657
> 
> 赞同：0
> 
> 时间：2009-05-17T00:56:20.190
> 
> 标签：iphone, cocoa-touch

我有一个放置在滚动视图前面的表格视图。当用户垂直拖动时，我希望表格上下滚动，当他们水平拖动时，我希望后面的滚动视图滚动其图像。

我了解如何使用 UIResponder 委托方法检查触摸，以感知用户是水平滚动还是垂直滚动。

我正在寻找有关如何在水平滚动情况下将触摸处理移交给滚动视图的建议。如何让事件停止进入表格视图和滚动视图（即 nextResponder）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T01:20:37.650

我想你想要[“响应者对象和响应者链”](http://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/EventsiPhoneOS/EventsiPhoneOS.html#//apple_ref/doc/uid/TP40009541-CH2-SW5)

有关于如何将事件转发给下一个响应者的示例代码。你不会停止接受这些事件。您只需根据需要将它们沿链传递即可。显然，这意味着您需要在第一响应者中保持状态。

# c++ - 如何在 C/C++ 中挂钩 Windows 函数？

> ID：873658
> 
> 赞同：33
> 
> 时间：2009-05-17T00:57:19.750
> 
> 标签：c++, c, windows, hook

如果我有一个`foo()`windows在kernel32.dll中实现的函数并且它总是返回true，我可以让我的程序：“bar.exe”挂钩/绕行那个windows函数并让它为所有进程返回false吗？

因此，例如，如果我的 svchost 调用`foo()`，它将返回 false 而不是 true。当前运行的所有其他进程都应该执行相同的操作。

如果是这样，怎么做？我想我正在寻找一个系统范围的钩子或其他东西。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-17T00:59:24.113

看看[Detours](http://research.microsoft.com/en-us/projects/detours/ "弯路")，它非常适合这类东西。

* * *

对于系统范围的挂钩，请阅读MSDN 中的[这篇文章](http://web.archive.org/web/20091228193034/http://msdn.microsoft.com/en-us/library/ms997537.aspx "MSDN")。

* * *

首先，创建一个处理挂钩函数的 DLL。下面的这个例子挂钩了套接字发送和接收函数。

```
#include <windows.h>
#include <detours.h>

#pragma comment( lib, "Ws2_32.lib" )
#pragma comment( lib, "detours.lib" )
#pragma comment( lib, "detoured.lib" )

int ( WINAPI *Real_Send )( SOCKET s, const char *buf, int len, int flags ) = send;
int ( WINAPI *Real_Recv )( SOCKET s, char *buf, int len, int flags ) = recv;  
int WINAPI Mine_Send( SOCKET s, const char* buf, int len, int flags );
int WINAPI Mine_Recv( SOCKET s, char *buf, int len, int flags );

int WINAPI Mine_Send( SOCKET s, const char *buf, int len, int flags ) {
    // .. do stuff ..

    return Real_Send( s, buf, len, flags );
}

int WINAPI Mine_Recv( SOCKET s, char *buf, int len, int flags ) {
    // .. do stuff ..

    return Real_Recv( s, buf, len, flags );
}

BOOL WINAPI DllMain( HINSTANCE, DWORD dwReason, LPVOID ) {
    switch ( dwReason ) {
        case DLL_PROCESS_ATTACH:       
            DetourTransactionBegin();
            DetourUpdateThread( GetCurrentThread() );
            DetourAttach( &(PVOID &)Real_Send, Mine_Send );
            DetourAttach( &(PVOID &)Real_Recv, Mine_Recv );
            DetourTransactionCommit();
            break;

        case DLL_PROCESS_DETACH:
            DetourTransactionBegin();
            DetourUpdateThread( GetCurrentThread() );
            DetourDetach( &(PVOID &)Real_Send, Mine_Send );
            DetourDetach( &(PVOID &)Real_Recv, Mine_Recv );
            DetourTransactionCommit(); 
        break;
    }

    return TRUE;
} 
```

然后，创建一个程序以将 DLL 注入目标应用程序。

```
#include <cstdio>
#include <windows.h>
#include <tlhelp32.h>

void EnableDebugPriv() {
    HANDLE hToken;
    LUID luid;
    TOKEN_PRIVILEGES tkp;

    OpenProcessToken( GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &hToken );

    LookupPrivilegeValue( NULL, SE_DEBUG_NAME, &luid );

    tkp.PrivilegeCount = 1;
    tkp.Privileges[0].Luid = luid;
    tkp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;

    AdjustTokenPrivileges( hToken, false, &tkp, sizeof( tkp ), NULL, NULL );

    CloseHandle( hToken ); 
}

int main( int, char *[] ) {
    PROCESSENTRY32 entry;
    entry.dwSize = sizeof( PROCESSENTRY32 );

    HANDLE snapshot = CreateToolhelp32Snapshot( TH32CS_SNAPPROCESS, NULL );

    if ( Process32First( snapshot, &entry ) == TRUE ) {
        while ( Process32Next( snapshot, &entry ) == TRUE ) {
            if ( stricmp( entry.szExeFile, "target.exe" ) == 0 ) {
                EnableDebugPriv();

                char dirPath[MAX_PATH];
                char fullPath[MAX_PATH];

                GetCurrentDirectory( MAX_PATH, dirPath );

                sprintf_s( fullPath, MAX_PATH, "%s\\DllToInject.dll", dirPath );

                HANDLE hProcess = OpenProcess( PROCESS_CREATE_THREAD | PROCESS_VM_OPERATION | PROCESS_VM_WRITE, FALSE, entry.th32ProcessID );
                LPVOID libAddr = (LPVOID)GetProcAddress( GetModuleHandle( "kernel32.dll" ), "LoadLibraryA" );
                LPVOID llParam = (LPVOID)VirtualAllocEx( hProcess, NULL, strlen( fullPath ), MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE );

                WriteProcessMemory( hProcess, llParam, fullPath, strlen( fullPath ), NULL );
                CreateRemoteThread( hProcess, NULL, NULL, (LPTHREAD_START_ROUTINE)libAddr, llParam, NULL, NULL );
                CloseHandle( hProcess );
            }
        }
    }

    CloseHandle( snapshot );

    return 0;
} 
```

这应该足以让你开始！

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-17T01:21:15.810

[EASYHOOK](http://www.codeplex.com/easyhook) [http://www.codeplex.com/easyhook](http://www.codeplex.com/easyhook)

Dominate 在简单性、灵活性和功能性方面的所有上述技术。

之前也没有讨论过[Hook 进程](https://stackoverflow.com/questions/299261/hook-processes)。我已经阅读了该线程的所有内容，并且绝对确定，[EASYHOOK](http://www.codeplex.com/easyhook)非常优越。无论您使用的是 C、C++、CLR 等。

我将从 codeplex 主页粘贴一些内容，以确保支付足够的费用。

## 以下是不完整的功能列表：

1.  一个所谓的“线程死锁屏障”将在 hook 未知 API 时摆脱许多核心问题；该技术是 EasyHook 独有的
2.  您可以为非托管 API 编写托管钩子处理程序
3.  您可以使用所有便利的托管代码，例如 NET Remoting、WPF 和 WCF
4.  一个文档化的、纯非托管的挂钩 API
5.  支持 32 位和 64 位内核模式挂钩（还可以查看我的 PatchGuard 3 旁路驱动程序，它可以在发布列表中找到）
6.  目标中没有资源或内存泄漏
7.  不会引起任何当前 AV 软件关注的实验性隐形注入机制
8.  EasyHook32.dll 和 EasyHook64.dll 是纯非托管模块，无需安装任何 NET 框架即可使用！
9.  所有挂钩均以稳定的方式安装和自动移除
10.  通过利用完全未记录的 API 支持 Windows Vista SP1 x64 和 Windows Server 2008 SP1 x64，仍然允许连接到任何终端会话。
11.  挂钩处理程序内的托管/非托管模块堆栈跟踪
12.  在钩子处理程序中调用托管/非托管模块
13.  在钩子处理程序中创建自定义堆栈跟踪
14.  您将能够编写为 AnyCPU 编译的注入库和宿主进程，这将允许您在所有情况下都使用相同的程序集将代码从 64 位和 32 位进程注入到 32 位和 64 位进程中。
15.  EasyHook 支持 64 位目标的 RIP 相对寻址重定位。
16.  无需拆包/安装。
17.  不需要 Visual Studio Redistributable。

我很高兴我的妓女仍然知道一些让我保留他们的技巧。但可以肯定的是，当您需要一个 HOOK 时，100 次的 99 次，EASYHOOK'r 会让您更快地到达那里。它得到了非常积极的维护。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-17T01:08:40.580

请详细说明您要挂钩的功能！在这种情况下，有几种方法可以调用您自己的代码，例如：

*   您可以构建一个与包含要挂钩的函数的 DLL 同名的假 DLL（并将其复制到 的文件夹中`foo.exe`）。该库将公开与原始 DLL 完全相同的功能。每个公开的函数只是绕过对原始 DLL 的调用，但要挂钩的函数除外。

*   您可以在运行时更改函数指针表，例如使用“厨房”提到的（商业）Detour 包。但是，您可以自己轻松完成此类挂钩，请参阅[本文](http://www.codeproject.com/KB/DLL/hooks.aspx)了解如何操作。

*   您可以找出调用特定函数的位置`foo.exe`，只需将调用该函数的汇编代码替换为“返回`true`”的代码即可。基本上，您正在修补“ `foo.exe`”..

*   对于特定功能，Windows 提供自动挂钩，例如键和鼠标事件。为此检查函数[SetWindowsHook](http://msdn.microsoft.com/en-us/library/ms644990(VS.85).aspx)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-16T13:05:47.253

这在一定程度上取决于您要定位的 Windows 版本。尽管如此，如果您在 Pre-Vista 上玩，您可以简单地使用 SetWindowsHookEx 将您的 DLL 注入到每个正在运行的进程中。然后，您的 DLL 将需要使用 Detours 或类似方法来挂钩相应的函数。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2010-04-07T09:26:08.833

如果您在汇编中编写钩子而不使用 Detours（无论出于何种原因），那么您需要一些有关返回 FALSE 的关键信息：

*   Win32，将 EAX 设置为 0
*   Win64，将 RAX 设置为 0

您需要将 EAX 或 RAX（取决于平台）设置为零，作为您要挂钩的功能的最后一件事。这将导致调用代码接收 0 作为返回值（假设它们返回一个 int 或指针类型值）。

# vb6 - 检测 Vista Starter 三开应用限制

> ID：873662
> 
> 赞同：9
> 
> 时间：2009-05-17T01:01:52.890
> 
> 标签：vb6, windows-vista

我是一名开发人员，目前正在维护一个迫切需要在 Vista 下正常工作的 VB6 应用程序。但是，它必须在 Vista Starter Edition 下正常工作，因为这里是新计算机（阿根廷）附带的版本。

现在，到技术方面：我的应用程序使用[ImageMagick 的转换](http://www.imagemagick.org/script/command-line-tools.php)来处理图像（调整大小、黑白分割、旋转等），所以三个应用程序的限制是一个真正的痛苦......嗯，在某个地方。最糟糕的是：没有（当前？）检测到运行*转换*的失败，所以当这种情况发生时，程序会挂起。

谁能告诉我如何：

a_检测打开的应用程序的数量，所以我可以要求用户在重试之前关闭某些东西？一个 API 调用，也许吧？或者

b_ 检测到*转换*（当前使用“Shell”功能运行）未正确启动？

请，像“你应该将你的应用程序迁移到 x”这样的评论应该发送给我的老板（不是我），不受欢迎，并且会让我去你的地方并咬你的脚趾。不过，我需要一些时间才能获得签证，但我向你保证，有一天会有陌生人敲你的门，询问你的 StackOverflow 用户名，然后他会咬你的脚趾。

感谢您的考虑

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T17:26:51.903

为什么不使用 ImageMagickObject COM+ 接口？我从未使用过它，但文档声称它可以完成命令行实用程序所能做的所有事情，而无需运行额外的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T02:02:35.273

*叹*

忽略，我以后需要阅读主题行之外的内容！

通过 SM_STARTER (a Const = 88) 调用 GetSystemMetrics()。

```
Option Explicit

Private Const SM_STARTER = 88&

Private Declare Function GetSystemMetrics Lib "user32" ( _
    ByVal nIndex As Long) As Long

Private Sub Form_Load()
    MsgBox CStr(GetSystemMetrics(SM_STARTER)) 'Zero (0) means False.
End Sub 
```

这是为 XP 定义的，应该与 Vista 相同。很容易尝试，对吧？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T02:30:14.817

不是你想听到的，但我敢打赌，“启动器”很容易破解。

我敢打赌这样的工作：加载系统服务，使用 SE_DEBUG，遍历所有进程，修补 GetSystemMetrics(0x88) 以在 RAM 中返回 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T18:20:47.927

尝试从 createprocess 开始而不是通过 shell？或者让服务管理它，而应用程序与服务通信。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T18:59:08.840

您是否尝试过检查 Shell 函数的返回值？文档说如果外壳失败，它应该返回零。

* * *

*马丁在评论中说*：我试过了，但每次我检查返回值时，都是一些大于零的奇怪数字。

*MarkJ 再次*：返回值应该是进程 ID。可以进行 API 调用来检查它们是否是有效的进程 ID。你可以尝试这样的事情：这总是为我显示一个“成功”的 MsgBox，因为我没有 Vista Starter Edition :)

```
Private Declare Function OpenProcess Lib "kernel32" ( _
    ByVal dwDesiredAccess As Long, ByVal bInheritHandle As Long, _
    ByVal dwProcessId As Long) As Long
Private Declare Function CloseHandle Lib "kernel32" ( _
    ByVal hObject As Long) As Long

Sub StartProcess()
   Dim ProcessId&
   Dim hProcess&
   Const PROCESS_QUERY_INFORMATION = &H400&

   ProcessId = Shell("notepad.exe", vbNormalFocus)
   hProcess = OpenProcess(PROCESS_QUERY_INFORMATION, False, ProcessId)
   If hProcess = 0& Then
     MsgBox "Failed"
   Else
     MsgBox "Succeeded"
     CloseHandle hProcess
   End If

End Sub 
```

# code-generation - IronRuby 有 CodeDomProvider 吗？

> ID：873669
> 
> 赞同：2
> 
> 时间：2009-05-17T01:08:26.637
> 
> 标签：code-generation, ironruby, codedom

如果没有，是否有计划？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-19T07:39:14.453

我们目前不打算实现 CodeDom 提供程序。但是，其他人可以做到，如果其他人觉得它有用，我认为没有理由不将其合并。

这将帮助我具体了解您将使用它的目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-16T11:14:50.613

似乎在当前来源中找不到任何参考。然而，在几年前的[这篇文章中，John Lam 说这是他们希望在未来添加的东西](http://www.iunknown.com/2007/07/a-first-look-at.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T20:04:21.317

它有很多事情可以做一个 codedomprovider 会做的事情。从本质上讲，它是动态的，这意味着您可以使用一些强大的工具。其中包括诸如 eval 之类的东西，它允许您执行任意代码等。

# c++ - 在 Windows 中禁用文件夹虚拟化

> ID：873676
> 
> 赞同：2
> 
> 时间：2009-05-17T01:13:46.153
> 
> 标签：c++, windows, visual-studio-2005, windows-vista

我目前有一个基于 xp 和 windows vista/7 构建的 c++ 应用程序，它虚拟化了一些我不希望它执行的路径。

有些[网站说](http://www.codeproject.com/KB/vista-security/MakingAppsUACAware.aspx)要将此添加到清单文件中：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
    <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
        <security>
            <requestedPrivileges>
                <requestedExecutionLevel level="asInvoker" uiAccess="false"/>
            </requestedPrivileges>
        </security>
    </trustInfo>
</assembly> 
```

对于 .net 应用程序来说，这又如何。我如何在 c++ for Visual Studio 2005 下做到这一点？

.

编辑：我需要下载 vista sdk 并将其 bin 路径包含在 Visual Studio 中，然后才能使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T01:22:49.953

完全相同的。使用给定的上下文创建一个文件并将该文件添加到您的项目设置中：

*   *清单工具*>*输入和输出*>*附加清单文件*

完毕！

# asp.net - 您如何处理 JavaScript 对象中的 ASP.NET 服务器回调？

> ID：873685
> 
> 赞同：1
> 
> 时间：2009-05-17T01:17:41.450
> 
> 标签：asp.net, javascript, web-services, oop

我在使用服务器回调到 JavaScript 中的对象内的 Web 方法时遇到问题......

```
function myObject() {
     this.hello = "hello";
     var id = 1;
     var name;

     this.findName = function() {
          alert(this.hello); //Displays "hello"
          myServices.getName( id, this.sayHello );
     }

     this.sayHello = function(name) {
          alert(this.hello); //Displays null <-- This is where I'm confused...
          alert(name); //Displays the name retrieved from the server
     }

     this.findName();
} 
```

因此，当`myObject`创建一个新的时，它会找到名称，然后在找到名称后调用`sayHello`。

服务例程工作并返回正确的名称。

问题是，在从服务器返回名称并被`this.sayHello`调用后，它似乎不在同一个对象中（没有引用`myObject`我们在查找名称时所在的对象），因为`this.hello`给出了一个`null`...

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T10:22:24.887

这不是网络服务问题。这是标准的 javascript 功能。在回调函数中，对“this”的引用变成了对全局范围的“window”对象的引用。以下是您可以解决的方法：

```
function myObject() {
     this.hello = "hello";
     var id = 1;
     var name;
     var self = this; //reference to myObject
     this.findName = function() {
          alert(this.hello); /* Displays "hello" */
          myServices.getName( id, this.sayHello );
     }

     this.sayHello = function(name) {
          alert(self.hello); /* Displays "hello" instead of "undefined" */
          alert(name); /* Displays the name retrieved from the server */
     }

     this.findName();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T08:54:27.783

您必须在调用时以某种方式绑定`this`对象的范围，以便稍后在同一范围内执行回调。目前，您的回调函数按照编码在全局窗口范围内执行，因此`this == Window`. 如果您使用的是框架，它们通常会提供一些传递作用域的方法作为回调的一部分，以简化此操作。

您还可以围绕回调参数创建一个闭包，如下所述：[JavaScript Callback Scope](https://stackoverflow.com/questions/183214/javascript-callback-scope)

# comparison - Boost bjam 与 GNU make

> ID：873686
> 
> 赞同：8
> 
> 时间：2009-05-17T01:17:52.900
> 
> 标签：comparison, build-automation, makefile, bjam

我是 Boost C++ 库的新手。我想知道 Boost bjam 是否比 GNU make 有任何优势？如果我使用 make 来使用 Boost.Python 库构建 C++ 代码，有什么缺点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T19:21:01.900

到目前为止，对于构建 boost 本身，bjam 是要走的路。只需按照自述文件构建命令行即可。您可能（应该）在每个增强版本中只需要执行一次。

但是，没有必要将您自己的使用 boost 的项目绑定到 boost 的构建系统。

使用 gmake 构建使用 Boost.Python 的 C++ 代码并没有特别的缺点，优点是周围有很多使用 gmake 的示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T04:42:09.807

如果您打算使用其他 Boost 库，那么使用 bjam 可能是有意义的，但是从简单的角度来看，对于一个复杂的项目来说，使用 make 非常复杂，这就是开发 ant 的原因。

Bjam 扩展了其他开始尝试替换 make 的项目。

但是，不利的一面是，在每个 unix 操作系统上都可以找到 make，bjam 不是，但是，如果您必须为您的项目使用 Boost 库，那么您可以确定它被包含在内。

对于您的项目，我认为 bjam 可能是最佳选择，但如果您正在编写一个其他人需要使用 ANSI C++ 编译的可移植项目，那么我建议您也支持 GNU Make。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-12T16:11:59.167

我使用 Make 和 BJam 构建了团队共享的构建框架。我的最终意见是，一旦我了解了基本设置，bjam 实现就更容易维护。团队成员一开始可能会抗拒，但一旦他们使用它并看到它比 Make 简单得多（我的观点），他们就被说服了。有些人会继续反抗。您可以设置双重构建系统，但这是额外的努力。

当我被迫使用 Make 时，我使用中央规则集创建非递归 makefile 解决方案。BJam 内置了所有这些功能。

# java - 调用全局数组

> ID：873696
> 
> 赞同：1
> 
> 时间：2009-05-17T01:24:02.057
> 
> 标签：java, arrays, global-variables

我目前正在尝试使用 2D 数组绘制形状。在我的课堂上有一个全局数组定义为`public char canvas[][];`

到目前为止，我只声明了数组`char canvas[][] = new char[height][width];`

如果这个数组已经被声明了，并且我不应该修改给定的代码，我该如何调用该数组的一个实例以便我可以使用它？

谢谢。

（编辑）

```
class DrawingSystem {

    public char canvas[][];

       public static void makeNewCanvas(int tmpWidth, int tmpHeight) {

        canvas[][] = new char[tmpHeight][tmpWidth];

        for (int row=0; row<tmpHeight; row++) {
            for (int col=0; col<tmpWidth; col++) {
                canvas[row][col] = ' ';
            }
        }       
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T02:25:55.263

静态方法和实例变量之间不兼容。

这样想：实例变量与类的特定*实例*相关联；静态变量与*类*本身相关联。您通过类​​调用静态方法：

```
ClassI.callStaticMethod(); 
```

而您通过类的实例调用实例方法：

```
public ClassI classObj = new ClassI();
classObj.callInstanceMethod(); 
```

在您发布的代码中，在静态方法中设置了一个实例变量（“canvas”）（`main`与类相关联，而不是实例）。

因此，您需要创建实例方法来修改/更新您的“画布”，并在静态函数中创建类的实例。该对象（“实例”）可用于更新实例变量。

这是一个例子：

```
public class Foo {
    public char canvas[][];

    public static void main(String[] args) {
        Foo fooObj = new Foo(); //creates an instance of this class
        fooObj.createCanvas(2, 2);
        fooObj.modifyCanvas(0, 0, 'c');
    }

    public void createCanvas(int x, int y) {
        canvas = new char[x][y];
    }
    public void modifyCanvas(int x, int y, char c) {
        canvas[x][y] = c;
    }
} 
```

这显然不是与您的作业一对一的关联，但我相信您将能够使其适应您正在做的事情:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T03:37:11.600

您的问题是`makeNewCanvas(int tmpWidth, int tmpHeight)`静态的或`public char canvas[][]`不是静态的。

在 Java 中，静态类成员只能与其他静态类成员一起使用。静态成员属于类，非静态成员属于实例。类是用于创建对象的模板，这些对象称为类的实例。当你声明一些静态的东西时，它被类的所有实例共享。对于方法，这意味着静态方法在所有实例上的行为必须完全相同。

```
DrawingSystem a = new DrawingSystem();
DrawingSystem b = new DrawingSystem(); 
```

`a`并且`b`是类的实例，`DrawingSystem`这意味着它们每个都有自己的`canvas`数组。现在因为`makeNewCanvas`是静态的并且对于它不能使用的所有实例必须表现相同，`a.canvas`或者`b.canvas`因为它们是唯一的`a`并且`b`可以具有不同的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T02:23:49.340

我不确定你的问题是否正确，

但是看起来您需要一个单例模式，而不是将其声明`char canvas[][]`为公共字段，而是将画布数组封装为只读属性

```
public class MyDrawing 
{

private char canvas[][] = null;

public char[][] getCanvas()
{
   if (canvas!=null)
   {
      canvas =new char[height][width];
   }
   return canvas;
} 
```

当`getCanvas()`您在代码的其他部分使用时，您需要画布数组而不是以前使用的画布公共变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T01:27:41.567

有点困惑你的要求。

您可以随时重新声明全局数组，并将其用于您自己的需要......但这似乎相当可疑（意思是......为什么这是一个全局数组）。

看起来你的画布不应该改变大小......但是再一次，我对你的情况不太了解。

检查数组是否为空，如果是，请将其声明为您想要的大小并愉快地使用它？

# c# - 在 C# 中播放 DVD？

> ID：873698
> 
> 赞同：1
> 
> 时间：2009-05-17T01:25:38.107
> 
> 标签：c#, playback, dvd

我需要一个可以读取 DVD 并在当前窗口、另一个窗口或屏幕上的任意位置（以编程方式指示）播放 DVD 的组件或控件。它不需要任何用户可见的控件；该应用程序将单独处理。我需要转向哪里？

仅供参考，我在 winforms 应用程序中使用 .Net 3.5。

我觉得我可能错过了一些简单的东西，但它正在逃避我。;-)

——奖励

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T01:43:36.363

您可以使用 Windows Media Player 控件。该示例在 VB.NET 中，但您应该能够非常轻松地进行翻译。

[http://msdn.microsoft.com/en-us/library/dd562852(VS.85).aspx](http://msdn.microsoft.com/en-us/library/dd562852(VS.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T14:40:52.603

将 windows 媒体控件嵌入到您的窗口中。这是 c# 代码： http: [//msdn.microsoft.com/en-us/library/dd562851 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/dd562851(v=vs.85).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T03:34:12.103

使用嵌入式媒体播放器控件是一个非常好的主意。

您可能还想看看： [http ://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=3215&lngWId=10](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=3215&lngWId=10)

# smtp - 如何在windowx xp 中配置SMTP 服务器以向gmail 发送邮件？

> ID：873702
> 
> 赞同：1
> 
> 时间：2009-05-17T01:29:21.437
> 
> 标签：smtp, email, redmine, outgoing-mail

原谅我的无知，我以为这会很容易，但我还是想不通

我正在使用 redmine（是用 rails 制作的票务系统），它可以选择向您发送邮件以通知事件。

到目前为止，我无法配置 smtp 服务器来将邮件中继到我的 gmail 帐户。

我想配置一些本地客户端（例如，thunderbird）并能够使用我自己的 smtp 服务器向 xx@gmail.com 发送邮件，然后我将配置 redmine 来做同样的事情。

我遵循了本教程：

[http://www.ehow.com/how_4489548_set-up-smtp-server-windows.html](http://www.ehow.com/how_4489548_set-up-smtp-server-windows.html)

并将本地主机配置为雷鸟作为外发邮件...

我得到以下信息：

在 F:\Inetpub\mailroot\Badmail\0029d2423191605200900000001.BAD

最终收件人：rfc822;xxxx@gmail.com 操作：失败状态：5.0.0 诊断代码：smtp;550-5.7.1 [201.250.95.2] 您用于发送邮件的 IP 未授权 550- 5.7.1 直接向我们的服务器发送电子邮件。请改用 550-5.7.1 服务提供商处的 SMTP 中继。如需了解详情，请访问[http://mail.google](http://mail.google) 550 5.7.1 .com/support/bin/answer.py?answer=10336 6si8453947yxg.40

在[http://mail.google.com/support/bin/answer.py?answer=10336](http://mail.google.com/support/bin/answer.py?answer=10336)

'您用于发送电子邮件的 IP 未经授权...' 为了防止垃圾邮件，当发送 IP 地址与发送域不匹配时，Gmail 会拒绝邮件。要将邮件从您的服务器发送到 Gmail，我们建议使用您的 ISP 提供的 SMTP 中继。请注意，我们目前无法将 IP 地址列入白名单或以其他方式例外。

知道怎么做吗？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T06:24:20.060

谷歌的错误解释非常简单。如果您想向他们发送邮件，他们会检查以确保您没有使用虚假的发件人域。

不如直接使用 gmail 自己的 SMTP 服务器进行中继？您获得的好处是不必担心您随后可以交付给谁（因为您正在对他们的 SMTP 进行身份验证，他们会很乐意在任何地方交付）。

[这](http://blog.expandrive.com/2008/12/04/redminerails-email-through-gmail-smtp/)应该让你开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T06:31:55.237

简而言之，您是从“me@example.com”发送邮件，但“example.com”没有将您的 IP 地址指定为该域的允许发件人——默认情况下，只有该域的*目标*服务器（ MX) 被允许发送*来自*域的邮件。

如果 Google 是您的邮件提供商，您应该通过他们转发邮件，请使用 smtp.gmail.com（顺便说一下，这需要您登录）。

否则，您应该通过您的邮件提供商转发邮件。如果**您**是您的邮件提供商，那么您的 DNS 设置可能不正确。在这种情况下，我建议聘请技术专家来检查您的设置，并为您提供下一步操作的建议。

# asp.net - 在 Render 上渲染表单后渲染文本

> ID：873703
> 
> 赞同：0
> 
> 时间：2009-05-17T01:29:22.357
> 
> 标签：asp.net

我有一个页面，我想在该页面上插入“一些文本”，但在表单标签被呈现之后。

受保护的覆盖渲染在正文标签内呈现文本，但在表单标签外。

现在我有一个呈现如下的代码： <body>Some text<form>Rest of the page
我想要： <body><form>Some text, Rest of the page

有什么方法可以在表单标签呈现后立即呈现文本？

希望它更清楚。
谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T01:58:13.927

为什么不先在表单中添加一个控件？

```
Page.Form.Controls.AddAt(0, new LiteralControl("Hello world.")); 
```

# java - 线程本地；每次都创建一个变量的副本不一样吗？

> ID：873704
> 
> 赞同：3
> 
> 时间：2009-05-17T01:29:25.820
> 
> 标签：java, thread-local

我仍然对 ThreadLocal 的概念感到困惑。我已经阅读了 JavaDoc，以及此处发布的其他相关问题，但是所使用的行话并没有对我有太大帮助。

我有点理解 ThreadLocal，也就是说，每个线程都有自己的变量副本。那么……这与说……每次都构造新变量有何不同？

例如，以 DateFormatter 为例：

```
public void convertDate(String date) 
{ 
    // Contruct new date formatter for every invocation of the method.
    DateFormatter df = new SimpleDateFormatter(...);
    ....
}

public void convertDate(String date) 
{ 
    // Getting date formatter from threadlocal.
    DateFormatter df = threadLocal.get();
    ....
} 
```

如果第二个所做的只是返回变量的新副本，那么第一个与第二个有何不同？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-17T01:33:06.793

ThreadLocal 对象通常是静态的，这意味着它们在同一线程内的函数调用之间保留其值。

在您的第一个代码片段中，每次`convertDate`调用时，`SimpleDateFormatter`都会创建一个新对象。在第二个片段中，`SimpleDateFormatter`每个线程创建一个对象。`get()`每次`convertDate`在同一个线程中调用该方法都会返回同一个对象。

ThreadLocal 对象在实现[线程本地存储](http://en.wikipedia.org/wiki/Thread-Specific_Storage)方面很有用，这意味着为每个线程维护单独的变量实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T05:33:36.737

如果第二个方法每次都在不同的线程中调用，那么您的两个示例是相同的。在这种情况下，第一个示例更有效。

但是，如果您在同一个线程中多次调用同一个方法，它将缓存该线程的值，而不必每次都创建一个新对象。（大多数与日期相关的对象都相当昂贵，在这种情况下值得这样做）在这种情况下，在线程中重用同一个对象有一点性能优势。

注意：线程本地对象存储在附加到线程本身的映射中。如果线程死亡，则该线程本地的所有对象都将被 GC。这就是 ThreadLocal 可以比大多数缓存更简单的地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T02:01:22.967

有几种不同的用途`ThreadLocal`。

与您的示例一样，可以缓存构造成本高、线程不安全的对象。然后可以以安全的方式使用该对象，而无需每次使用的构造开销。这不一定是胜利（例如，使用更多非本地内存），但它可能是。

它还可以用于通过上下文参数“欺骗”到并非设计为具有上下文的回调中。或者只是为了让界面更简单。在这种情况下，对 的规范引用`ThreadLocal`可能不是静态的。该对象也可能是故意可变的。我不太喜欢鼓励这种技术，但有些人（比如“疯狂”的 Bob Lee）喜欢它。

`ThreadLocal`当您将任务分叉到多个线程时效果不佳。`InheritableThreadLocal`似乎没有什么好的用途。

# iphone - 如何在 Core Animation 的每一帧上获得通知？

> ID：873708
> 
> 赞同：1
> 
> 时间：2009-05-17T01:34:22.517
> 
> 标签：iphone, cocoa-touch, animation, core-animation

我有一个 iPhone 程序，它由许多位于`UIView`另一个之上的 s组成`UIView`，并且可以移动。我正在使用包含的方法在`UIView`s之间绘制连接。这一切都很好。`drawRect:``UIView`

唯一的问题是，当我使用动画移动视图时，背景不会刷新。我曾尝试对视图的属性使用键值观察，但在动画期间它们发生变化时我没有收到通知。

有什么方法可以`UIView`在动画运行时使我的包含重绘？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T01:57:26.673

我不相信 CAAnimation 存在这种情况。有一种方法可以在 Mac 上使用 NSAnimation 来做到这一点，但在 CAAnimation 中没有我所知道的等价物。那就是说……

一个更好的解决方案可能是将连接本身放在 CALayers 上，并完全按照您为 UIView 设置动画的方式为它们设置动画，让每个连接自行绘制而不是让超级视图全部绘制。即使使用 NSAnimation，我也可能会在 Mac 上这样做。

# iphone - 从内存中卸载 XIB

> ID：873710
> 
> 赞同：1
> 
> 时间：2009-05-17T01:35:27.147
> 
> 标签：iphone

所以这是我的设置：

*   用户旋转 PickerWheel，选择要导航到应用程序的哪个部分。
*   该应用程序从 XIB 文件加载 UIViewController 并将其推送到 navigationController 堆栈
*   用户可以随时弹出并选择要导航到的另一个部分 - viewController 被（应该）完全销毁并重新分配给新的 XIB 文件

看起来很简单，但是这些部分中的每一个都非常耗费资源。当 XIB 弹回时，我找不到完全清除内存的好方法 - 我尝试只调用 [viewController release]，虽然它工作并最终调用 UIViewController 子类的 -(void)dealloc 方法， XIB 文件中的一些内容仍然保留在内存中（我可以在 ObjectAllocations 中看到它们，并且我可以在 ActivityMonitor 中看到大量剩余内存）。

基本上我要问的是从内存中完全删除动态加载的 XIB 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T01:40:40.583

```
viewController.view = nil; 
```

如果`view`在 NIB 控制的 UIViewController 上为 nil，那么它将在下次请求时自动重新加载 NIB。这正是`-didReceiveMemoryWarning`工作原理。

当我更多地考虑这一点时，这不会立即放弃您的 IBOutlets，这在您的情况下可能很重要。因此，您还需要为[Nib 对象的内存管理中](http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmNibObjects.html#//apple_ref/doc/uid/TP40004998-SW4)描述的 IBOutlets 实现特殊的内存管理。

您需要`-setView:`按照描述实施。仔细阅读整个文档。[我已经在内存管理 IBOutlets](http://robnapier.net/blog/memory-managing-iboutlets-17)中快速总结了要点。

# xcode - 有没有办法让空白在 Xcode 编辑器中可见？

> ID：873712
> 
> 赞同：62
> 
> 时间：2009-05-17T01:37:10.450
> 
> 标签：xcode, editor, whitespace

我希望制表符和空格在 Xcode 中可见。这可能吗？我在首选项下找不到它。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2011-11-04T12:28:02.463

编辑器 -> 在 Xcode 4 中显示不可见

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2016-12-16T15:04:57.380

在 Xcode 7 及更高版本中，此命令已移至编辑器菜单：

编辑器 > 显示不可见

或者

编辑器 > 隐藏不可见

## 编辑

从 Xcode 12.1 开始，菜单项现在简称为“Invisibles”。当显示不可见时它被选中，当它们不显示时取消选中。

此外，看起来 Xcode 现在为空格使用了非常浅的蓝色圆点，而与您的制表符位置相对应的空格则使用了粗体的浅蓝色圆点，这非常好。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2015-01-29T00:09:04.620

您还可以使用[默认值](https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/defaults.1.html)来读取/写入 Xcode`plist`

这是在 Xcode 中使用/测试的`6.1`

# 图形用户界面

`Editor->Show Invisibles`

# 命令行界面

## 打开它

```
defaults write com.apple.dt.Xcode DVTTextShowInvisibleCharacters 1 
```

## 把它关掉

```
defaults write com.apple.dt.Xcode DVTTextShowInvisibleCharacters 0 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2020-01-23T09:47:59.087

从 Xcode 开始`11`：

在菜单中选中/取消选中： `Editor -> Invisibles`

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2020-08-22T06:43:44.740

它位于**Editor -> Invisibles**下。您可以**选中**它以显示或**取消选中**它以隐藏它们。

* * *

### 关于 macOS 的注意事项</h3>

**在 mac 环境下，你可以在Help**菜单下搜索任意菜单选项，然后它会打开你要找的确切的菜单路径。例如，搜索**invi** sibles 会导致：

[![演示](https://i.stack.imgur.com/TRGDL.png)](https://i.stack.imgur.com/TRGDL.png)

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-05-17T01:57:49.980

在 Xcode 6.x 及更早版本中：

查看 -> 文本 -> 显示空间

查看 -> 文本 -> 显示控制字符

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-05-23T14:51:38.957

您也可以在搜索字段中输入一个空白，这将暂时以黄色突出显示所有空白。我在这里偶然发现了这个，Marty 反过来问：[Xcode 中的这些黄色间隔是什么？](https://stackoverflow.com/questions/23638320/what-are-these-yellow-spacers-in-xcode)

# c++ - c++ 使用结构排序

> ID：873715
> 
> 赞同：18
> 
> 时间：2009-05-17T01:39:10.633
> 
> 标签：c++, arrays, sorting, struct, bubble-sort

我很难解决这个问题，它需要一种客户姓名、客户 ID 以及最后的应付金额。我已经计算了整个程序，但无法确定进行排序所需的最后一个原型。我有一个名为 Customers 的结构，我还将提供 int main() 部分。我只需要任何帮助来启动原型 SortData()。

```
struct Customers {
    string Name;
    string Id;
    float OrderAmount;
    float Tax;
    float AmountDue;
};

const int MAX_CUSTOMERS = 1000;
bool MoreCustomers(int);
Customers GetCustomerData();
void OutputResults(Customers [], int);
void SortData(const int, const int, Customers []);

int main() {
    Customers c[MAX_CUSTOMERS]; 
    int Count = 0;      
    do {
      c[Count++] = GetCustomerData();   
    } while (MoreCustomers(Count));     

    for (int i = 0; i < Count; i++) {
        c[i].Tax = 0.05f * c[i].OrderAmount;        
        c[i].AmountDue = c[i].OrderAmount + c[i].Tax;   
    }

    SortData(0, Count, c);     //0:Sorts by customer name       
    OutputResults(c, Count);            
    GeneralSort(1, Count, c);   //1:Sorts by ID     
    OutputResults(c, Count);        
    GeneralSort(2, Count, c);   //2: Sorts by amount due        
    OutputResults(c, Count);        

    return 0;                       
}

void SortData(const int SortItem, const int count, CustomerProfile c[]) {
     //0: Sort by name
    //1: Sort by ID
    //3: Sort by amount due
} 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-05-17T01:48:55.447

`std::sort`您应该使用标头中声明的C++ 标准排序函数`<algorithm>`。

当您使用自定义排序函数进行排序时，您必须提供一个*谓词函数*来说明左侧值是否*小于*右侧值。因此，如果您想首先按名称排序，然后按 ID 排序，然后按到期金额排序，所有这些都按升序排列，您可以这样做：

```
bool customer_sorter(Customer const& lhs, Customer const& rhs) {
    if (lhs.Name != rhs.Name)
        return lhs.Name < rhs.Name;
    if (lhs.Id != rhs.Id)
        return lhs.Id < rhs.Id;
    return lhs.AmountDue < rhs.AmountDue;
} 
```

现在，将该函数传递给您的`sort`调用：

```
std::sort(customers.begin(), customers.end(), &customer_sorter); 
```

`customers`这假设您有一个名为包含客户的 STL 容器（而不是数组，就像您在示例代码中使用的那样） 。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-17T10:47:45.373

它经常被忽略，您实际上可以将 STL 范围函数与基于 C 的数组一起使用，就像在您的示例中一样。因此，您实际上不必转而使用基于 STL 的容器（我不会在这里讨论这样做的优点 :-)）。

因此，基于 Chris 的回答，您可以调用 sort 如下：

```
std::sort( customers, customers+Count, &customer_sorter); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T02:05:02.990

您只需要编写一个比较两个 CustomerProfile 类型的比较函数。拥有此功能后，您可以使用 STL 排序（请参阅[http://www.sgi.com/tech/stl/sort.html](http://www.sgi.com/tech/stl/sort.html)或[http://msdn.microsoft.com/en-us/library/ecdecxh1 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/ecdecxh1(VS.80).aspx) ) 或旧的 C qsort：[http://en.wikipedia.org/wiki/Qsort_(C_Standard_Library)](http://en.wikipedia.org/wiki/Qsort_(C_Standard_Library))。我建议不要编写自己的排序算法，除非这是家庭作业。您的比较取决于您喜欢使用的技术，它可能看起来像这样：

```
int CompareCustomerProfile(
   const CustomerProfile* pC1,
   const CustomerProfile* pC2)
{
 int result = strcmp(pC1->name, pC2->name);
 if (0 != result) return result; 

  result = strcmp(pC1->ID, pC2->ID);
  if (0 != result) return result;

  if (pC1->amountDue < pC2->amountDue) return -1;
 if (pC1->amountDue > pC2->amountDue) return 1;

  return 0
} 
```

这假设您示例中的“字符串”类型是 char*。如果您使用 Unicode 或多字节类型，那么显然必须使用适当的 Unicode 或多字节比较。然后，您只需使用比较函数调用该算法。例如。使用 qsort：

```
qsort(c, Count, sizeof(CustomerProfile), CompareCustomerProfiler). 
```

现在，如果这*是*一个家庭作业，你不应该在这里问怎么做......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T01:47:15.043

您可以通过创造性的谷歌搜索在 C++ 中找到很多排序实现。唯一的区别是，您不是对数字进行排序，而是对结构进行排序。

因此，无论您将使用的算法中有什么类似的东西`if(a[i]<a[j])`，都可以调用 `if(isFirstCustomerLowerThanOther(a[i]

现在，创建一个具有以下结构的函数：

```
bool isFirstCustuomerLowerThanOther(const Customer& firstCustomer, const Customer& secondCustomer)
{
 // Implement based on your key preferences
} 
```

更好的是，如果你使用 C++，你可以使用 STL 的排序算法（同样，谷歌获取信息以及如何将排序传递给它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T11:52:03.067

我假设您是编程或 C++ 新手，因此您可能正在寻找以下内容：

```
#include <search.h> // for the qsort()

int
CompareByName( const void *elem1, const void *elem2 )
{
  return ((Customers*)elem1)->Name > ((Customers*)elem2)->Name? 1 : -1;
}

int
CompareByOrderAmount( const void *elem1, const void *elem2 )
{
  return ((Customers*)elem1)->OrderAmount > ((Customers*)elem2)->OrderAmount? 1 : -1;
}

void SortData( int SortItem, int count, Customers customers[] )
{
  switch (SortItem) {
  case 0:
    qsort(customers, count, sizeof(Customers), CompareByName);
    break;
  case 1:
    qsort(customers, count, sizeof(Customers), CompareByOrderAmount);
    break;
  // ...
  }
}

void test()
{
  Customers cust[10];

  cust[0].Name = "ten";
  cust[1].Name = "six";
  cust[2].Name = "five";
  SortData( 0, 3, cust );
  cout << cust[0].Name << endl;
  cout << cust[1].Name << endl;
  cout << cust[2].Name << endl;
} 
```

# c# - 在 .NET 进程中观看由本机进程创建的全局事件

> ID：873729
> 
> 赞同：3
> 
> 时间：2009-05-17T01:51:55.050
> 
> 标签：c#, .net, c++, winapi, events

我在本机 C++ 进程中创建了一个全局事件并设置/重置，如下所示：

```
HANDLE hGlobalEvent = CreateEvent(NULL, TRUE, FALSE, _T("Global\\MyEvent")); 
```

是否有任何方法（即使它使用不是由 MS 编写的库）在 .NET（C#）进程中注册这些事件之一，以便在全局事件更改时触发我的标准 .NET 事件处理程序？
而且我真的不只是想等待事件和循环，就像在 C++ 中使用 WaitForSingleObject 的方式一样......我真的希望它是一个完全异步的事件处理程序。

我必须想象有一种简单的方法可以做到这一点......只是找不到它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T02:06:22.050

[ThreadPool.RegisterWaitForSingleObject](http://msdn.microsoft.com/en-us/library/w9f75h7a.aspx)可用于在事件发出信号时执行回调。使用采用字符串名称的[EventWaitHandle 构造函数](http://msdn.microsoft.com/en-us/library/41acw8ct.aspx)获取命名事件对象的 WaitHandle 。

```
bool createdNew;
WaitHandle waitHandle = new EventWaitHandle(false,
    EventResetMode.ManualReset, @"Global\MyEvent", out createdNew);
// createdNew should be 'false' because event already exists
ThreadPool.RegisterWaitForSingleObject(waitHandle, MyCallback, null,
    -1, true);

void MyCallback(object state, bool timedOut) { /* ... */ } 
```

# c++ - 静态库中的对象注册

> ID：873731
> 
> 赞同：7
> 
> 时间：2009-05-17T01:57:46.003
> 
> 标签：c++, plugins, static-libraries

我已经实现了一个非常基本的“插件系统”作为*静态库*的一部分。每个“插件”都实现了对特定图像格式的支持，例如 GIF、JPEG 等。此外，我有一个 Singleton（一个名为 的类`PluginManager`），它保存所有可用插件的列表。

棘手的部分是我想通过在项目文件中添加或删除它们的源文件来禁用/启用插件。为了实现这一点，每个插件都会创建一个全局变量（具有不同的名称），并在该类的构造函数中将插件注册到`PluginManager`.

像这样的JPEG格式......

```
struct JPEGPlugin
{
  // constructor will register plugin
  JPEGPlugin()
  {
    PluginManager::Singleton().RegisterPlugin(this);
  }

  // plenty of other code
  ...
};

JPEGPlugin jpeg_instance;  // instantiate in global scope 
```

然而，虽然这在理论上可以完美运行，但在将此静态库链接到其他代码以构建可执行文件时它会失败。只要这个可执行文件不访问插件全局变量（如`jpeg_instance`），链接器就看不到连接（他完全忽略了构造函数的副作用）并且不包含最终可执行文件中的代码。换句话说，JPEG 插件在最终应用程序中不可用。

这些年来我遇到过几次问题，我总是在网上搜索解决方案。每次，我只找到基本上说这是一个已知问题并且我必须忍受它的页面。

但也许 SO 上的某个人知道如何使它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T02:28:02.623

由于它是一个静态库，您可以考虑让管理器注册插件（而不是插件自己注册）。头文件可以定义一些 preproc 符号（即 JPEG_PLUGIN）来控制管理器是否根据头文件的包含来注册插件：

```
#include "JpegPlugin.h"

void PluginManager::RegisterPlugins()
{
#idef JPEG_PLUGIN
    RegisterPlugin(&jpeg_instance);
＃万一
}

```

JpegPlugin.h 不一定需要包含 JpegPlugin 的定义。它可能是这样的：

```
#ifndef JPEG_PLUGIN_HEADER
#define JPEG_PLUGIN_HEADER

#if 0 // 将此更改为 1 以使用插件
#define JPEG_PLUGIN
#include "Jpeg_PluginCls.h"
＃万一

＃万一

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T02:49:52.867

我不知道这是否是您解决此问题的方式的解决方案，但是我们在对象工厂的静态注册方面遇到了类似的问题，在 Visual Studio 中，我们通过声明与 __declspec(dllexport) 相关的类来解决它，这是必要的即使涉及的库不是 dll。但如果没有这个，链接器将省略未引用的类。

我们工作的注册表解决方案有点不同，不涉及堆栈分配的对象。我从 CPP 单元中取出零件，这也是我发现 __declspec 方法 iirc 的地方。

[编辑] 我们还必须`#include`从代码的某些部分声明注册类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T10:15:57.023

这是[Harald Scheirich 的回答](https://stackoverflow.com/questions/873731/object-registration-in-static-library/873804#873804)的后续。

我做了一些实验，似乎 MSVC++ 2005 的发布模式（但不是调试模式）将打开`/OPT:REF`链接器的标志，根据[LINK 文档](http://msdn.microsoft.com/en-us/library/bxwfs976.aspx)，这将导致从最终 EXE 中删除任何未引用的符号。而且，[网页`__declspec(selectany)`](http://msdn.microsoft.com/en-us/library/5tkz6s71.aspx)似乎表明全局对象的构造函数不被视为对对象的引用（恕我直言，但你有它）。所以我的猜测是，这个问题在调试版本中“消失”了——对吗？

因此，我认为 Harald 的使用建议`__declspec(dllexport)`是将符号标记为“引用”的便捷方式，因为它是在源代码中指定的。如果出于某种原因您想避免导出符号，我怀疑您可以通过使用[`/INCLUDE:mysymbol`链接器标志](http://msdn.microsoft.com/en-us/library/2s3hwbhs.aspx)或关闭`/OPT:REF`标志来完成同样的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-26T16:40:26.547

请：

1.  添加静态库项目作为对 exe 项目的引用
2.  将“链接库依赖项”和“使用链接库依赖项作为输入”都设置为 true。

看到这个： [![配置](https://i.stack.imgur.com/arFJg.png)](https://i.stack.imgur.com/arFJg.png)

当“使用链接库依赖项作为输入”设置为“是”时，项目系统在 .obj 文件中为依赖项目生成的 .lib 链接。所以所有的符号都被保留了。

# php - PHP 扩展不会在 Apache 启动时加载

> ID：873734
> 
> 赞同：10
> 
> 时间：2009-05-17T02:00:29.910
> 
> 标签：php, windows, apache

我已将 php 添加为 Apache 2.2.11 的模块：

```
LoadModule php5_module "c:/php/php5apache2_2.dll" 
```

并且还添加了

```
AddType application/x-httpd-php .php 
```

在 PHP.ini 中，我的扩展目录设置为：`extension_dir = "C:\php\ext"`

**是**的，目录是正确的，所有文件都存在。

但是当我启动 apache 时，我得到了这些错误：

> PHP 警告：PHP 启动：无法加载动态库 'C:\php\ext\php_mysql.dll' - 找不到指定的模块。\r\n 在第 0 行的未知中
> PHP 警告：PHP 启动：无法加载动态库 'C:\php\ext\php_pdo_pgsql.dll' - 找不到指定的模块。\r\n 在 Unknown on line 0
> PHP 警告：PHP 启动：无法加载动态库 'C:\php\ext \php_pgsql.dll' - 找不到指定的模块。\r\n 在第 0 行的未知
> 
> [Sun May 17 03:46:01 2009] [notice] Apache/2.2.11 (Win32) PHP/5.2.9 -2 已配置 -- 恢复正常操作
> [Sun May 17 03:46:01 2009] [notice] 服务器构建：2008 年 12 月 10 日 00:10:06
> [Sun May 17 03:46:01 2009] [notice] Parent: Created子进程 4652
> 
> PHP 警告：PHP 启动：无法加载动态库 'C:\php\ext\php_mysql.dll' - 找不到指定的模块。\r\n 在第 0 行的未知中
> PHP 警告：PHP 启动：无法加载动态库 'C:\php\ext\php_pdo_pgsql.dll' - 找不到指定的模块。\r\n 在 Unknown on line 0
> PHP 警告：PHP 启动：无法加载动态库 'C:\php\ext \php_pgsql.dll' - 找不到指定的模块。\r\n 在第 0 行的未知
> 
> [Sun May 17 03:46:01 2009] [notice] Child 4652: Child process is running
> [Sun May 17 03: 2009 年 46:01] [通知] 孩子 4652：获得了启动互斥锁。
> [Sun May 17 03:46:01 2009] [notice] Child 4652：启动 64 个工作线程。
> [Sun May 17 03:46:01 2009] [notice] Child 4652：启动线程以侦听端口 80。

所以我可能在这里忘记了一些简单的事情，有人可以告诉我我忘记了什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T02:38:04.517

您不仅需要 PHP 扩展的 DLL 来为 PHP 添加 MySQL 和 PostgreSQL 支持。您还需要 MySQL 和 PostgreSQL 本机库。PHP 扩展的 DLL 可能找不到它们所依赖的某些 DLL，因此它们无法启动。

确保您已安装 MySQL 和 PostgreSQL 客户端，并将它们的 DLL 放入某个可定位的位置。

IE 示例：

*   php_mysql.dll 依赖于 libmysql.dll

因此，请确保 PHP 能够找到 libmysql.dll（我相信这是 Windows PHP 的二进制发行版附带的。但不确定）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T02:33:36.463

添加到 Pablo Santa Cruz 的建议。`PATH`在 Windows 上，您可以在环境中包含所需的库。（不必复制到 Windows 文件夹）。加载库时，寡妇也会在`PATH`目录中查找。

如果您使用 PHP5.2 的 php.net 的标准 Win32 二进制分发包，则该包应包含包根目录中的所有依赖项。因此，如果您已将 PHP5.2 安装到`C:\php`中，请将此目录添加到`PATH`envar。重新启动 Apache，我希望扩展能够正确加载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-30T17:47:17.407

我尝试了其中的几种解决方案，其中一种或多种有效……重新启动是这里的关键。我没有在这些更改之间重新启动，但在我重新启动后它正在工作：

*   将 postgres DLL 添加到 apache lib 目录
*   将 postgres 路径添加到系统 PATH
*   将 postgres DLL 添加到 system32

我相信只有 PATH 会起作用，但这里没有时间清洁，所以你去吧。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T09:58:03.870

这些扩展依赖于 MySQL 和 PostgreSQL 二进制发行版提供的本地库。例如，安装它们并将库放在 apache 的`bin`文件夹中。这些分别是`LIBMYSQL.DLL`和`LIBPQ.DLL`。

我通常这样做而不是`Windows/System32`用它们污染文件夹，因为在我的系统上只有 apache/php 是这些数据库的客户端，而且它也使我的 apache/php 设置更便携。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T10:09:43.733

我在 Windows 上遇到了特定版本的 PHP 问题。问题是libmysql。我在 php.net 网站上发现了一个有同样问题的人发布的错误。

我使用了以前的 php 版本并且 libmysql 工作。查看您正在使用的 php 发行版的注释。我认为在特定版本之后，他们提到了有关 libmysql 的新政策。

从你提到的 php 无法找到扩展。确保您在 php.ini 上设置了指定扩展所在位置、扩展存在以及可以访问文件夹（读取权限）的路径。

如果一切都失败了，请尝试将扩展移动到 windows/system32 以找出可能是真正的问题。

问候，

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-02T09:29:28.543

我有同样的问题。每次我尝试登录 phpmyadmin 时，都会遇到令人讨厌的窗口弹出错误之一。我输入了用户名和密码，然后会抛出错误。

为我解决的问题是将 libmysql.dl 复制到 apache bin 目录。奇怪的是显然包含正确的扩展，但我仍然需要这样做。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-17T10:56:34.103

以我的经验，Windows 上的 PHP 是背后的一大痛点。我通常最终会让它工作，但总是有很多谷歌搜索和反复试验——至少对我来说是这样。

所以我终于厌倦了它，只是在虚拟机中安装了 Ubuntu Server，并在几分钟内启动并运行。我不能说这是否适合您，但如果是的话，从长远来看，它肯定会为您省去很多麻烦。更不用说你总是可以移动你的虚拟机，创建快照并做虚拟机擅长的所有其他花哨的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-06-13T04:18:24.653

我也有这个问题，并将相关的（.dlls）复制到 systen 32，但它仍然对我不起作用。我正在运行 Windows 7 64 位。为了让它对我有用，我还必须将 libmysql.dll 复制到 ext 目录。错误消息留下了 Apache 日志，并且页面加载了有利的响应（已建立连接）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-06-08T09:44:20.893

我也有同样的问题，并通过将“PostgreSQL”bin 路径添加到系统环境变量中来解决

路径：C:\Program Files\PostgreSQL\8.4\bin 您也可以检查 phpinfo()。

当我安装 PostgreSQL 时，设置到系统路径错过了。我手动添加然后重新启动系统。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-17T04:18:50.690

这里的问题是 apache 已经加载了 PHP，但是 PHP 无法加载它的扩展（mysql、postgresql、...）。我认为您应该在 php.ini 文件中以 unix 格式输入路径值（不要使用反斜杠字符作为目录分隔符）。所以在你的 php.ini 文件中改变这个：

extension_dir="C:/php/ext"

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2010-04-14T14:42:49.383

我遇到了同样的问题，并尝试将 libmySQL.dll 复制到 apache bin 文件夹并解决了问题（我正在设置 PHP 5.2.5 x64）。非常感谢。

# html - 有写href的兼容方式吗？

> ID：873735
> 
> 赞同：1
> 
> 时间：2009-05-17T02:00:58.600
> 
> 标签：html, anchor, href

例如，在文件中`test.php`：

```
<a href="someting/?start=1">go</a>; 
```

这样无论在哪里`test.php`，无论是在`Document_Root/Test/`目录中还是在`Document_Root/Production/`目录中，锚点都会指向自己。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-17T02:07:19.910

要编写一个只会更改查询字符串的链接，只需使用

```
<a href="?foo=bar">whatever</a> 
```

因此，如果您在`http://the/current/url.php`，则转到`http://the/current/url.php?foo=bar`，或者如果您在`http://somewhere/else?entire=ly`，则转到`http://somewhere/else?foo=bar`。

# python - GitPython 和向 Git 对象发送命令

> ID：873740
> 
> 赞同：7
> 
> 时间：2009-05-17T02:04:40.447
> 
> 标签：python, git

[GitPython](http://gitorious.org/git-python)是一种从 python 与 git 交互的方式。我正在尝试`git commit -m "message"`从此模块访问基本的 git 命令（例如），据此[应该](http://pysync.googlecode.com/files/GitPython.pdf)通过 Git 模块访问。到目前为止，这是我为使这些命令正常工作所做的尝试：

```
>>> import git
>>> foo = git.Git("~/git/GitPython")
>>> bar = "git commit -m 'message'"
>>> beef = git.Git.execute(foo,bar) 
```

这会显示一个错误，指出没有这样的文件或目录。我还尝试了以下作为我的 git 目录的路径：

`~/git/GitPython/.git`
`/Users/bacon/git/gitclient/`

唯一的另一个选择是命令错误，所以我也尝试了： `commit -m "message"`仍然得到“没有这样的文件或目录”。

我需要做什么才能让这些 git 命令正常工作？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-17T04:27:46.020

我还没有尝试过验证，但似乎 git.Git.execute 需要一个命令行参数列表（如果你给它一个字符串，它会寻找一个与字符串、空格和所有内容完全匹配的可执行文件——这自然不会找不到），所以我认为这样的事情会起作用：

```
import git
import os, os.path
g = git.Git(os.path.expanduser("~/git/GitPython"))
result = g.execute(["git", "commit", "-m", "'message'"]) 
```

其他变化：

*   我希望使用带有 ~ 的路径不起作用，所以我使用 os.path.expanduser 将 ~ 扩展到您的主目录
*   通常首选使用 instance.method(*args) 而不是 Class.method(instance, *args) 所以我改变了它，尽管它仍然可以使用其他方式

虽然可能有比手动运行提交命令更明智的方法（我只是没有注意到任何快速浏览源代码）所以我建议在这样做之前确保没有更高级别的方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T07:43:54.393

一般来说， ~ 扩展是由你的 shell 完成的，不是文件系统的一个特性，所以你不应该期望它可以工作。

os.path.expanduser 可以为您应用扩展，但一般情况下，您最好写出完整路径（从那时起脚本可以运行它，只要他们可以访问您的文件）。

我怀疑你想要：

```
'/Users/bacon/git/GitPython' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T04:02:00.433

在教程中它说...

```
The first step is to create a ``Repo`` object to represent your repository.

    >>> from git import *
    >>> repo = Repo("/Users/mtrier/Development/git-python") 
```

我没有看到你的回购。

我正在查看 GitPython 的 doc 目录中名为 tutorial.rst 的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-26T06:14:11.203

该解决方案经过测试`gitPython 3.1.26`

```
import git
foo = git.Git("~/git/GitPython")
cmd1 = "git add -A"
bar = "git commit -m 'message'"
foo.execute(f"{cmd1}; {bar}", shell=True, istream=PIPE, with_stdout=True) 
```

正如它所看到的`gitPython`，不仅可以执行字符串形式的命令，还可以在一次调用中执行多个命令。

[这篇关于执行多个命令的帖子](https://stackoverflow.com/questions/9649355/how-to-run-multiple-commands-in-one-process-using-popen)给了我这个想法。`Popen`是 的基础`git.Git.execute`。

不幸的是，我搜索了官方`gitPython`文档和其他网站，找不到使用`git.Git.execute`.

# c++ - 为什么在 C++ 中将类声明和定义放在两个单独的文件中？

> ID：873745
> 
> 赞同：19
> 
> 时间：2009-05-17T02:09:55.973
> 
> 标签：c++

我只是想知道，将类分成 .h 和 .cpp 文件的全部意义是什么？它使编辑变得更加困难，并且如果您的类不会被编译成 .lib 或 .dll 供外部使用，那有什么意义呢？

编辑：我问的原因是 Boost 库将所有​​内容都放在一个 .hpp 文件中（无论如何大多数库），我想知道为什么它在我看到的大多数其他代码中是分开的。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-17T02:17:00.650

C++ 有一种叫做单一定义规则的东西。这意味着（不包括内联函数），定义只能出现在一个编译单元中。由于 C++ 头文件只是在每个包含文件中“复制和粘贴”，因此如果您只是将定义放在头文件中，那么现在您将定义放在多个位置。

当然，您可能会说，为什么不将所有内容都内联。好吧，如果编译器尊重您的内联建议，那么长函数的代码将在每个调用站点复制，从而使您的代码过大，并可能导致抖动、缓存问题和各种不愉快的事情。

另一方面，如果编译器不听你的，也不内联任何东西，现在你有两个问题：1）你不知道哪个翻译单元得到你的类定义，2）编译器仍然必须每次#include 时都要浏览你的定义。此外，没有简单的方法可以确保您没有意外地在 2 个不同的标头中以不同的方式定义了两次相同的方法。

您还会遇到循环依赖问题。对于一个类调用另一个类的方法，该类需要首先声明。因此，如果 2 个类需要调用彼此的方法，则必须先声明每个类，然后才能定义它们。没有办法在一个文件中使用声明和定义来做到这一点。

真的，这就是语言和解析器的构建方式。这是一种痛苦，但你只需要处理它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-17T02:15:42.323

好吧，以这种方式编写代码的好处之一是它减少了编译时间。

假设您的项目中有这些文件：

*   啊
*   a.cpp
*   b.cpp

如果您已经将 a.cpp 编译到目标文件**ao**中，那么如果您将**ah**包含在**b.cpp**中，编译应该会更快，因为解析器不必处理**a**的整个声明/定义。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-17T03:46:57.880

Boost 不会内联它的所有代码。它内联了它期望其使用者实例化的类的模板定义，例如 shared_ptr。许多库都有需要单独编译的部分，例如 boost::serialization 和 program_options。

随着代码库大小的增加，内联可能会产生严重的负面影响。它增加了组件之间的耦合，更不用说缩短编译时间了（boost 这样做有很多其他原因:)。实际上，您的所有翻译单元都将拥有该程序的几乎完整副本，并且微小的更改会导致您重新构建/重新测试所有内容。在某些项目中，这可能需要很多很多小时。

我从来没有真正注意到它更难编辑。以我的经验，由于接口和实现的明确分离，它变得更容易，而且我知道去哪个文件来找到我正在寻找的东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T02:17:13.210

因为即使在您的 DLL 中，其他类也会使用您的类。这些文件必须在编译时通过包含 .h 来查看类声明。他们一定不能看到定义，否则类函数会有多个定义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-17T03:35:36.847

您的编辑 re: Boost 做出了重要的区分。由于编译器和链接器在当前 C++ 标准中的工作方式，模板类几乎总是在头文件中定义。出于同样的原因，您会发现大多数模板库（不仅仅是 Boost）都是在头文件中实现的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T02:19:27.043

在 C++ 中，代码模块（.c 或 .cpp 文件）的单独编译需要在使用之前定义函数原型。如果要使用在其他地方定义的类或方法，则必须导入 .h 文件以获取它们的定义。最后，链接器确保所有在 .h 文件中做出的承诺都可以被所有 c/cpp 文件实现。

此外，它允许仅通过定义 .h 文件来创建完整的框架，例如 boost。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-17T02:14:59.253

因为在大多数情况下，您会希望在实现它的文件之外的某个地方使用该类。如果将整个程序放在一个文件中，则不需要分离。

你几乎不想在一个文件中编写一个 C++ 程序。

# floating-point - 在执行 $price = (int) ( (0.1+0.7) * 10 ) 之类的操作时要采取什么预防措施；并得到 7 作为答案

> ID：873747
> 
> 赞同：0
> 
> 时间：2009-05-17T02:10:29.623
> 
> 标签：floating-point, integer

在 PHP 中

```
echo (int) ( (0.1+0.7) * 10 ); 
```

或在红宝石中

```
p ((0.1+0.7) *10).to_i 
```

结果是 7 而不是 8。这样的陷阱可能真的很难被发现。我认为如果在北美，这不是问题，因为我们计算的价格是多少美分，所以 17.28 美元或 17.29 美元可能不是问题。但在中国或香港等国家/地区，价格可能只是一个整数。在这种情况下，如果我们的程序很慷慨，只是向客户询问价格的整数部分，那么如果 8 变成 7，就会出现问题。所以也许我们总是需要小心并使用 round() 来代替？还有其他方法可以避免这个陷阱吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T03:00:56.973

如果您想要准确的答案，请不要使用浮点数学。如果您要总结价格，请使用定点算法。如果您的最小值是美分，则将所有价格视为美分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T02:39:28.303

使用舍入而不是仅取数字的整数部分（ .to_i 或 (int) 正在执行的操作）。在 PHP 中，您可以使用：

```
echo round((0.1+0.7)*10); 
```

我确定Ruby有类似的功能，我只是不知道它叫什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T03:13:53.760

Ruby 版本的`round`方法是这样工作的：

```
((0.1+0.7)*10).round  #=> 8 
```

但正如 Steven 所指出的，浮点运算可能非常不准确。为了在 Ruby 中获得更好的准确性，您可以使用`BigDecimal`：

```
a = BigDecimal.new("0.1")
b = BigDecimal.new("0.7")
((a+b)*10)  #=> returns a BigDecimal with a value of 8.0 
```

BigDecimal 实例是从字符串初始化的，而不是浮点数。因此`.to_s`上面的调用。

# javascript - javascript选项选择问题

> ID：873752
> 
> 赞同：0
> 
> 时间：2009-05-17T02:12:34.920
> 
> 标签：javascript, drop-down-menu, options

我从互联网上得到了这个 javascript 代码。这是一个脚本，可以更改图片，并从选项下拉框中选择标题。该脚本工作正常。我唯一的问题是选项框中的值只能是数字。无论如何可以定制这个，而选项参数中的值可以是单词而不是数字？这是代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<style type="text/css">
img{
height:200px;
width:250px;
display:block;
margin-top:10px;
}
#caption{
font-family:Verdana,tahoma,arial;
font-size:10pt;
text-align:center;
display:block;
width:250px;
}
</style>
<script type="text/javascript">
/************************************************************
* Script by : Raymond Angana
* Title: Dropdown Based Picture w/ Captions
* First seen in AFHB2000.com
* rangana in AHFB2000.com
* Created June 5, 2008
* This notice must stay intact
/**********************************************************/
window.onload=function()
{
    var caption=['Default Image Caption',
                'Caption1',
                'Caption2',
                'Caption3',
                'Caption4',
                'Caption5',
                'Caption6',
                'Caption7',
                'Caption8',
                'Caption9'], // This will be your images caption
    bp='http://h1.ripway.com/rangana/images/', //base url of your images
    imgnum=14, //Number of your images. This should match on your comboboxes options.
    thumb=document.getElementById('thumb'), //id of your image that will be changing
    description=document.getElementById('caption'), //id of your caption
    combobox=document.getElementById('selection'); // id of your combobox.

    combobox.onchange=function()
    {
    thumb.src=bp+'Picture'+this.value+'.jpg';
    description.innerHTML=caption[this.value];
    }
}
</script>
</head>
<body>
<label>Please Change the default picture: </label>
<select id="selection">
<option>Change Picture</option>
<option value="1">Image 1</option>
<option value="2">Image 2</option>
<option value="3">Image 3</option>
<option value="4">Image 4</option>
<option value="5">Image 5</option>
<option value="6">Image 6</option>
<option value="7">Image 7</option>
<option value="8">Image 8</option>
<option value="9">Image 9</option>
</select>
<br>
<img src="http://h1.ripway.com/rangana/images/Picture1.png" alt="mypic" id="thumb">
<span id="caption">Caption for the default Image</span>
</body>
</html> 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T02:49:29.373

value 属性可以是文本，不一定是数字。上面代码中唯一会中断的是：

```
description.innerHTML=caption[this.value]; 
```

您可以将其替换为：

```
description.innerHTML = caption[this.selectedIndex] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T02:46:39.410

我不知道您为什么要在选项值中包含单词的原因，如果您在那里有单词，那么很难获得标题。

如果目标是获取特定于所选选项的图像，并且如果您想使用自己的图像名称而不是“图片”+id，我将进行如下修改。

在`onLoad`如下更改标题数组中（添加更多选项和相应图像）：

```
var appimages=[['Caption1','image1.gif'],['Caption2','image2.gif']]; 
```

并在`onChange`功能更改如下：

```
thumb.src=bp+appimages[this.value][1];
description.innerHTML=appimages[this.value][0]; 
```

希望这可以帮助。

# windows - 如何编写一个 Windows 应用程序来更改桌面壁纸？

> ID：873756
> 
> 赞同：1
> 
> 时间：2009-05-17T02:15:06.583
> 
> 标签：windows, desktop, desktop-wallpaper

我想编写一个小型 Windows 应用程序，它根据从 Web 服务检索到的照片更改桌面墙纸？我该怎么办？用哪种语言/技术编写代码最快？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T02:23:15.333

在网上找到了这个（vb）代码：

```
Private Const SPI_SETDESKWALLPAPER As Integer = &H14
Private Const SPIF_UPDATEINIFILE As Integer = &H1
Private Const SPIF_SENDWININICHANGE As Integer = &H2
Private Declare Auto Function SystemParametersInfo Lib "user32.dll" (ByVal uAction As Integer,_
 ByVal uParam As Integer, ByVal lpvParam As String, ByVal fuWinIni As Integer) As Integer

' change this to whatever filename you want to use'
Const WallpaperFile As String = "MovieCollectionImage.bmp"

''' <summary>
''' Sets the background of your Windows desktop. The image will be saved in MyPictures_
 and the background wallpaper updated.
''' </summary>
''' <param name="img">The image to be set as the background.</param>
''' <remarks></remarks>
Friend Sub SetWallpaper(ByVal img As Image)
     Dim imageLocation As String
     imageLocation = My.Computer.FileSystem.CombinePath_
(My.Computer.FileSystem.SpecialDirectories.MyPictures, WallpaperFile)
     Try
          img.Save(imageLocation, System.Drawing.Imaging.ImageFormat.Bmp)
          SystemParametersInfo(SPI_SETDESKWALLPAPER, 0, imageLocation,_
 SPIF_UPDATEINIFILE Or SPIF_SENDWININICHANGE)
     Catch Ex As Exception
          MsgBox("There was an error setting the wallpaper: " & Ex.Message)
     End Try
End Sub 
```

像这样调用：

```
SetWallpaper (Me.PictureBox1.Image) 
```

# c++ - C++ 字符串值作为另一个字符串名称

> ID：873758
> 
> 赞同：0
> 
> 时间：2009-05-17T02:15:51.777
> 
> 标签：c++

如何在 C++ 中将变量值转换为另一个名称？就像在这个 php 片段中一样。

```
$string = 'testVar';

${$string} = 'test';

echo $testVar; // test 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T02:32:02.720

使用地图怎么样？

```
#include <iostream>
#include <map>
#include <string>

using namespace std;

map<string, string> hitters;

hitters["leadoff"] = "Jeter";
hitters["second"] = "Damon";
hitters["third"] = "Teixiera";
hitters["cleanup"] = "Matsui";

string hitter = "cleanup";

cout << hitters[hitter] << endl; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T02:19:51.003

我不知道 PHP，但我认为你不能在 C++ 中做到这一点。变量名在编译的 C++ 程序中没有运行时表示，因此无法像那样在运行时加载其名称。

这似乎是您只能在原始源代码位于内存中或至少是语法树的某种表示形式的脚本语言中才能做到的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T02:21:35.867

这不是您在 C++ 中可以做的事情。当您编译 C++ 代码时，有关函数和变量名称的信息会丢失（从技术上讲，它可以存储在符号表中，但这些仅用于调试目的）。要完成这样的事情，您需要使用[地图](http://www.sgi.com/tech/stl/Map.html)或其他类似的数据结构，这很像 PHP 数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T02:22:34.367

听起来您可能想使用指针：

```
string testVar;
string *str = &testVar;
*str = "test";
cout << testVar << endl; // test 
```

编译后，C++ 编译器会丢弃变量的原始名称等信息，因此您必须使用较低级别的构造来执行相同类型的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-02T23:35:22.913

如果你用符号表编译你的程序，你可以使用“readelf -s yourexecutable”（linux）来获取符号表。然后使用变量名对输出进行 grep，并使用“cut”命令从输出中获取地址。

```
readelf -s a.out | grep ' var$' | tr -s ' '| cut -d' ' -f3 
```

# java - 在 Sun Java 5 中运行的应用程序上使用 hprof

> ID：873766
> 
> 赞同：0
> 
> 时间：2009-05-17T02:20:04.060
> 
> 标签：java, performance, hprof

我们在 weblogic 10 上部署了一个企业 java 应用程序（ear - 几个 ejb 和一个 webapp）并使用 Sun java 5。响应时间、CPU 和内存使用率在负载用户很少的情况下很好，但如果我们将并发用户增加到 > 100 我们在一段时间后看到巨大的 CPU 峰值（例如：- 100 个用户的负载测试，经过 30 多分钟的测试，CPU 变高）。我们想使用 hprof 来分析应用程序并收集统计信息，但只想在 CPU 较高时（即测试 3o 分钟后）才这样做，有没有办法做到这一点？

我不能使用 jmap，因为我们使用的是 Sun java 5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T06:11:48.563

CPU 中的巨大峰值可能表明 GC 正在运行。如果是这样，这将不会显示在分析器中。您可以使用 -verbosegc 运行以查看 GC 何时运行。（或使用 jconsole）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T04:19:41.763

如果不出意外，您可以尝试以下几个选项：

*   当 CPU 变高时，只需执行**CTRL+BREAK 几次，看看您是否可以“观察”线程所在的位置**（在 UNIX 上执行此操作，您可以在进程上调用 kill 并使用暂时忘记的信号编号);
*   **使用 hprof，无论如何都要对整个时间进行分析**，看看它是否提供了线索——如果你感兴趣的是 CPU 较高的那一点，那么即使你最初是在低 CPU 的情况下运行一段时间；
*   从您的程序本身，考虑使用一些通过[ThreadMXBean](http://www.javamex.com/tutorials/profiling/profiling_java5_threads_howto.shtml)可用的线程分析调用。

我很欣赏后者不是每个人的一杯茶，但它最终会让你做你想做的事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T04:07:20.407

这本质上是 JVM 特定的。因此，您需要指定您使用的 JVM（Sun/BEA/IBM 等）。

在弄清楚这一点的同时，考虑将 Web 容器中的会话超时设置为 60 秒，然后重新运行测试。

# windows - 如何从 dll 中获取应用程序名称？

> ID：873770
> 
> 赞同：1
> 
> 时间：2009-05-17T02:21:55.570
> 
> 标签：windows, dll

如果我有一个被 LoadLibrary 加载到应用程序 (bar.exe) 中的 dll (foo.dll)，我如何从 foo.dll 中获取字符串“bar.exe”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T02:26:27.587

将 NULL 作为第一个参数传递给[GetModuleFileName()](http://msdn.microsoft.com/en-us/library/ms683197(VS.85).aspx)。

# php - 如何显示存储在 Document_Root 上方的图像

> ID：873774
> 
> 赞同：0
> 
> 时间：2009-05-17T02:24:53.330
> 
> 标签：php, html, image

我按以下方式设置了 img 的 src 属性，但没有工作：

src="/../files/filenamee"

该图像未显示。

如何正确执行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T02:33:20.503

您将无法以`DocumentRoot`任何方式引用上面的图像。URL 由 Web 浏览器解释，因此它只会请求`/files/filename`. 您需要编写一个脚本，从所需目录读取文件并将它们写入用户（这是一个**坏主意**，因为这些脚本几乎总是会打开一个无意的安全漏洞），或者从您的目录中创建一个指向该目录的符号链接文档根目录。

# css - 如何使浮动的内部 div 与最高 div 的高度相同

> ID：873781
> 
> 赞同：9
> 
> 时间：2009-05-17T02:28:41.717
> 
> 标签：css, html, css-float, height

在下面的代码中，我希望带有 'y' 的 div 将 div 的高度与 3 个 'x' 匹配。

```
<div style="border: 0px solid red; margin: 0px 0px 5px; overflow: hidden;">
<div style="border: 1px solid rgb(129, 11, 0); margin: 0px; padding: 5px; background-color: rgb(30, 23, 22); width: 312px; float: left;">
    x<br/>x<br/>x
</div>
<div style="border: 1px solid rgb(129, 11, 0); margin: 0px; padding: 5px; width: 312px; background-color: rgb(30, 23, 22); float: right;">
    y
</div> 
```

需要注意的是内部 div 是浮动的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-17T11:16:02.870

我在 A List Apart 看到了一个解决方案（我认为），你给两个内列一个巨大的底部填充，但与负边距相同的巨大值。只要列不超过 32000px 高，这一切都有效，这很少见。就像是：

```
.col {
  float: left;
  padding-bottom: 32000px;
  margin-bottom: -32000px;
} 
```

...其中“col”是任何列的类名。然后，您可以使用单独的类为各个列设置您喜欢的样式。

```
<div class="col xxx">x<br />x<br />x</div>
<div class="col yyy">y</div> 
```

另一种选择是在外部 div 上使用背景图像，包​​括边框等。这种方法显然意味着一旦设置更改列（宽度、颜色）会有点困难。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-17T02:52:28.693

你有三个选择。

1.  使内部 div 都与外部 div 一样高。这并不难。
2.  将内部 div 放入另一个 div 并尝试使用 height 和/或 min-height 100% 使它们与包含 div 一样高，尽管我怀疑这不起作用，因为包含 div 可能会延伸到其包含的高度div 或页面。不过，这可能值得一试；或者，最简单的
3.  使用表格。这个问题对于表格来说是微不足道的。[这是纯 CSS 缺陷](http://www.cforcoding.com/2009/05/everything-old-is-new-again.html)的一个很好的例子。

两个 div “共享”高度没有简单的方法。像 100% 高度这样的技巧在您需要使用的 CSS 属性和您正在使用的边框方面都存在跨浏览器问题。边框通常是您使用的任何高度的补充。

有人可能会说使用 display: table-cell 但对它的支持相当有限（在 IE 上）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-17T10:58:25.380

如果你对 jQuery 的某个地方不反感，你可以使用[EqualHeight](http://www.filamentgroup.com/lab/setting_equal_heights_with_jquery/)，它应该做你想做的事

# java - 每个单词后打印空格

> ID：873790
> 
> 赞同：2
> 
> 时间：2009-05-17T02:37:28.793
> 
> 标签：java, python, ruby, string

将单词数组与中间的空格组合在一起但前后没有空格的简单/有效方法是什么？

我想可以在将所有内容组合成一个循环后删除空格（类似于 sum += (term + " ")）...不过我不喜欢它。

最好使用 Java、Python 或 Ruby 编写代码。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-17T02:47:08.207

**好吧，在 Python 中，使用join**会很简单：

```
values = ["this", "is", "your", "array"]
result = " ".join(values) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-17T03:19:03.233

是的，这就是`join`为之而生的。这是 Ruby 版本：

```
["word", "another", "word"].join(" ") 
```

`<flamebait>`如您所见，Ruby`join`使用 on`Array`而不是方法`String`，因此更加明智。`</flamebait>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T02:44:51.943

您想要的是 String.Join，但既然只是说这可能对您没有帮助，这里有一些[Java 中的 Join 实现](http://snippets.dzone.com/posts/show/91)。这是一个具有 Java 连接的[字符串实用程序。](http://commons.apache.org/lang/api/org/apache/commons/lang/StringUtils.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T03:50:02.617

直接来自我现有的 utilz 类之一

**C:\java\home\src\krc\utilz\Arrayz.java**

```
package krc.utilz;

/**
 * A bunch of static helper methods for arrays of String's.
 * @See also krc.utilz.IntArrays for arrays of int's.
 */
public abstract class Arrayz
{
  /**
   * Concetenates the values in the given array into a string, seperated by FS.
   * @param FS String - Field Seperator - Name borrowed from awk
   * @param Object[] a - array to be concatentated
   * @return a string representation of the given array.
   */
  public static String join(String FS, Object[] a) {
    if (a==null||a.length==0) return "";
    StringBuilder result = new StringBuilder(String.valueOf(a[0]));
    for(int i=1; i<a.length; i++) {
      result.append(FS);
      result.append(String.valueOf(a[i]));
    }
    return result.toString();
  }

  ....

} 
```

干杯。基思。

* * *

**编辑**

这是一个快速而肮脏的性能比较，使用 java.util.Arrays 作为基线。

请注意，热点成本在 100 次迭代中分摊，并且对于所有三种技术应该（或多或少）相同...... krc.utilz.RandomString 和 krc.utilz.Arrayz 都可根据要求提供，只需询问即可。

```
package forums;

import java.util.Arrays;
import krc.utilz.Arrayz;
import krc.utilz.RandomString;

class ArrayToStringPerformanceTest
{
  private static final int NS2MS = 1000000; // 1 millisecond (1/10^3) = 1,000,000 nanoseconds (1/10^9)

  public static void main(String[] args) {
    try {
      String[] array = randomStrings(100*1000, 16);
      long start, stop;
      String result;

      final int TIMES = 100;
      long time1=0L, time2=0L, time3=0L;

      for (int i=0; i<TIMES; i++) {

        start = System.nanoTime();
        result = Arrays.toString(array);
        stop = System.nanoTime();
        //System.out.println("Arrays.toString  took "+(stop-start)+" ns");
        time1 += (stop-start);

        start = System.nanoTime();
        result = Arrayz.join(", ", array);
        stop = System.nanoTime();
        //System.out.println("Arrayz.join      took "+(stop-start)+" ns");
        time2 += (stop-start);

        start = System.nanoTime();
        result = arrayToString(array, ", ");
        stop = System.nanoTime();
        //System.out.println("arrayToString    took "+(stop-start)+" ns");
        time3 += (stop-start);

      }
      System.out.format("java.util.Arrays.toString  took "+(time1/TIMES/NS2MS)+" ms");
      System.out.format("krc.utilz.Arrayz.join      took "+(time2/TIMES/NS2MS)+" ms");
      System.out.format("arrayToString              took "+(time3/TIMES/NS2MS)+" ms");

    } catch (Exception e) {
      e.printStackTrace();
    }
  }

  public static String arrayToString(String[] array, String spacer) {
    StringBuffer result = new StringBuffer();
    for ( int i=0; i<array.length; i++ ) {
      result.append( array[i] + ((i+1<array.length)?spacer:"") );
    }
    return result.toString();
  }

  private static String[] randomStrings(int howMany, int length) {
    RandomString random = new RandomString();
    String[] a = new String[howMany];
    for ( int i=0; i<howMany; i++) {
      a[i] = random.nextString(length);
    }
    return a;
  }

}

/*
C:\Java\home\src\forums>"C:\Program Files\Java\jdk1.6.0_12\bin\java.exe" -Xms512m -Xmx1536m -enableassertions -cp C:\Java\home\classes forums.ArrayToStringPerformanceTest

java.util.Arrays.toString  took 26 ms
krc.utilz.Arrayz.join      took 32 ms
arrayToString              took 59 ms
*/ 
```

另请参阅 Doomspork 的建议，以及我对此的评论。

干杯。基思。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T03:59:10.753

Java 可以通过以下方式完成：

```
public static String arrayToString(String[] array, String spacer) {
    StringBuffer result = new StringBuffer();
    for(int i = 0 ; i < array.length ; i++) {
        result.append(array[i] + ((i + 1 < array.length) ? spacer : ""));
    }
    return result.toString();
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T08:44:30.520

这也适用于 Ruby：

```
['a', 'list', 'of', 'words'] * " " 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-17T02:50:48.450

好吧，我知道 Python 有这样的功能，我假设 Ruby 有，Java 有。

join 函数接受一个字符串数组（取决于语言，它可以是其他类型）并将它们与您选择的字符（或另一个字符串）连接在一起。

Python代码：

```
wordString = " ".join(["word", "another", "word"]) 
```

否则，您可以遍历数组，添加单词和空格，并测试它是否是最后一个元素。如果是，只需添加单词，而不是空格。

再次使用 Python 代码：（感谢 PTBNL 的建议）

```
wordArray =  ["word", "another", "word"]
wordString = ""
for i in range(0, len(wordArray) - 1):
    wordString += wordArray[i] + " "
wordString += wordArray[len(wordArray) - 1] 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-17T08:15:10.577

在 Python 中，您要求[连接](http://www.python.org/doc/current/library/stdtypes.html#str.join)*字符串*连接一个可迭代的字符串：

```
alist= ["array", "of", "strings"]
output= " ".join(alist) 
```

如果你觉得这个符号很奇怪，你可以用不同的语法做同样的事情：

```
output= str.join(" ", alist) 
```

这适用于任何可迭代的（列表、元组、字典、生成器、生成器表达式……），只要项目都是字符串（或 unicode 字符串）。

如果您想要一个 unicode 结果，您可以替换(或`unicode`for )。`str``u' '``' '`

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-05-17T02:50:10.493

让我们不要忘记老式的好

```
 for s in strArray do
     print s
     print " " 
```

# java - 分配的变量引用在哪里，在堆栈中还是在堆中？

> ID：873792
> 
> 赞同：13
> 
> 时间：2009-05-17T02:39:13.423
> 
> 标签：java, concurrency, heap-memory, stack-memory

我有个问题

例如，当我在方法中声明变量时会发生什么。

```
无效我的方法（）{
    运送 myShip = new Ship();
}

```

myShip 引用在哪里分配，在堆栈中还是在堆中？

我认为在堆栈中，但我很困惑，因为我正在阅读 J2ME 游戏编程书“Java 类被实例化到 Java 堆上”

所有java类？

提前致谢

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-17T03:48:43.803

`myShip`是对一个`Ship`对象的引用，`myShip`是在方法调用栈上的，也就是所谓的“栈”。当一个方法被调用时，一块内存被压入栈顶，该内存块有空间用于该方法的所有基元（int、float、boolean 等）和对象引用，其中包括方法参数。堆是为实际对象分配内存的地方。

所以`myShip`在堆栈上，`Ship`对象在堆上。

请注意，每个线程都有自己的堆栈，但共享堆。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-17T02:41:50.263

Java 做的事情确实有点不同。*引用*基本上在堆栈上。对象的内存在堆中分配。但是，可分配内存的实现方式与 C/C++ 模型中堆的实现方式不太一样。

当您像这样创建一个新对象时，它会有效地将名称放入该范围的引用表中。这很像 C++ 中指向对象的指针。当它超出范围时，该引用将丢失；分配的内存不再被引用，并且可以被垃圾回收。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-17T02:42:13.243

目前，所有 Java 对象都在堆上分配。有传言说 Java 7 可能会进行逃逸分析并能够在堆栈上分配，但我不知道该提案是否最终确定。[这是 RFE](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6336351)。

**编辑：**显然，它[已经在 J​​DK 7 的早期版本中](http://blog.juma.me.uk/2008/12/17/objects-with-no-allocation-overhead/)。（文章说它也会在 JDK 6u14 中，但我找不到确认。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-17T03:44:16.920

从概念上讲，对象在“堆”上。然后，因为它是方法本地引用，所以实际引用将在堆栈上。“the”堆栈，我们指的是至少在 Sun 的 VM 的情况下，本机线程堆栈（即 C 中的局部变量将被分配的同一堆栈），但我认为这实际上不是一个要求（JVM只需要在每个方法调用上分配一些“堆栈帧”的抽象概念，无论是否来自本机堆栈）。

但是......在现代虚拟机上（公认的可能是更简单的嵌入式/mpbile 虚拟机除外），实际上没有“堆”之类的东西。在实践中，有各种堆区域。其中最简单的通常几乎就像一个“迷你堆栈”，旨在快速分配不会长时间徘徊并且可能几乎可以立即解除分配的对象。

正如另一张海报所提到的，高度优化的 JVM原则上*可以*在堆栈上分配对象数据，并且对此有明确的建议。虽然，正如其中一个参考文献中提到的那样，对此的批评是快速“伊甸园”堆几乎就像一个堆栈（只是不是“那个”堆栈）。

# wiki - 编写 Wiki 应用程序时存储版本控制的最佳方式是什么？

> ID：873801
> 
> 赞同：0
> 
> 时间：2009-05-17T02:47:18.113
> 
> 标签：wiki, data-modeling

我正在编写一个需要可搜索版本控制的 wiki 应用程序。什么是最好的数据模型？

我正在用 Django 编写它，这并不重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-08T20:18:10.533

我会将 svnwiki 添加到列表 en.wikipedia.org/wiki/Svnwiki

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T03:25:52.873

让我建议您不要实现版本控制，而是使用现有的实现之一。版本控制需要很多工作才能很好地实现，如果没有很好地实现，会给用户带来很多麻烦。

例如，看看[ikiwiki](http://ikiwiki.info)是如何做到的：它有插件来抽象版本控制系统并支持多个插件，因此用户可以选择。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-17T02:52:06.247

基本上，您要问的是“我如何实现版本控制”。有几个模型可以解决这个问题，但要问的第一个问题是“为什么要构建 wiki 而不是使用现有实现中的一个？”

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-17T03:20:55.693

如果您正在寻找一个用 python 编写的带有源代码版本控制的 wiki，我强烈推荐**trac**，

> [http://trac.edgewall.org/](http://trac.edgewall.org/)

不过，我不确定他们是否使用 django。

如果您正在寻找一个带有内置文档管理系统的 wiki，我已经为我的办公室设计并构建了一个（在 bash 中）。正如查理提到的，有很多方法可以实现这一点，您的实现可能主要取决于您办公室的运作方式。如果您想详细说明我们的系统如何工作，我很乐意详细说明 - 只需发表评论，我将编辑这篇文章。

# asp.net - RA-AJAX 在哪里下载？

> ID：873806
> 
> 赞同：0
> 
> 时间：2009-05-17T02:50:32.163
> 
> 标签：asp.net, ajax

我意识到 RA-AJAX 团队现在正在处理一些法律问题。虽然我很想尝试他们的 RA-AJAX 库的 1.0 版本...

我不确定我是否被允许/可以从其他地方（即另一个下载站点等）访问该库，或者此时它是否被完全禁止？我知道它是开源的……它实际上看起来真的很棒……

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T13:18:53.043

您好，该项目现在又开始运行了，您可以在[http://ra-ajax.org找到下载](http://ra-ajax.org)

在此处阅读详细信息；[http://ra-ajax.org/lawsuit-settled-the-war-is-over.blog](http://ra-ajax.org/lawsuit-settled-the-war-is-over.blog)

和这里; [http://ra-ajax.org/new-release-of-ra-ajax-version-2-0-out.blog](http://ra-ajax.org/new-release-of-ra-ajax-version-2-0-out.blog)

# c# - 如何从 C# 执行 Java 程序？

> ID：873809
> 
> 赞同：25
> 
> 时间：2009-05-17T02:51:06.327
> 
> 标签：c#, java

想知道是否有人知道在运行时从 C# 代码执行 Java 命令行程序的好方法？

它与执行本机 .EXE 文件相同吗？

它是同步运行还是异步运行（这意味着我可能必须等待线程完成才能找出结果）

具体来说，我想从服务器端的 Web 应用程序调用一个小实用程序（恰好是用 Java 编写的）来对文本文件进行一些处理。我想等待它完成，因为在 Java 程序处理完文本文件后，我想获取处理后的文本，并在 C# 应用程序中使用它。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-17T05:11:26.897

```
var processInfo = new ProcessStartInfo("java.exe", "-jar app.jar")
                      {
                          CreateNoWindow = true,
                          UseShellExecute = false
                      };
Process proc;

if ((proc = Process.Start(processInfo)) == null)
{
    throw new InvalidOperationException("??");
}

proc.WaitForExit();
int exitCode = proc.ExitCode;
proc.Close(); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-17T09:12:21.687

如果您需要比启动外部程序更好的控制，那么可以考虑 IKVM - [http://www.ikvm.net/](http://www.ikvm.net/) - 它提供了一种在 .NET 世界中运行 Java 程序的方法。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-17T02:54:12.590

这与执行本机 .EXE 文件相同，只是您必须执行的可执行文件是 JVM 本身（java.exe）。

因此，在您的 C# 代码调用中：

> java.exe -jar nameofyourjavaprogram.jar

你应该没事。

如果 JAR 库中没有 Java 程序，只需使用所需的所有参数启动 JVM。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-03-13T18:40:24.547

我在上述解决方案中添加了几行。我想从 Silverlight 应用程序调用 Web 服务，该应用程序使用服务器上的 java 处理一些文件。上面的解决方案很有帮助，但我做了一些修改，以便它可以工作，因为通过 Web 服务调用有点棘手。现在你有了适合这项工作的正确工具，合适的时候是 C#，当 C# 无法解决问题时是 Java。了解不止一种做事方式总是好的。现在我在 .Net 中创建的 Web 服务可以与 Java 通信。

```
private void Merge(string strPath)
{
  var processInfo = new ProcessStartInfo("C:\\Program Files\\Java\\jdk1.6.0_24\\binjava.exe", "-jar app.jar")
  {
     CreateNoWindow = true,
     UseShellExecute = false
  };

  processInfo.WorkingDirectory = strPath; // this is where your jar file is.
  Process proc;

  if ((proc = Process.Start(processInfo)) == null)
  {
    throw new InvalidOperationException("??");
  }

  proc.WaitForExit();
  int exitCode = proc.ExitCode;
  proc.Close();
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-17T06:16:07.227

> 它是同步运行还是异步运行

如果您有足够的内核，它将异步运行，否则它将独立运行，但您的线程必须进行上下文切换，以便其他程序运行。无论哪种方式，它都不是您应该担心的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-12-14T00:16:10.770

如果您使用[jni4net - C#/Java 桥，它可能会运行得更快](http://jni4net.sf.net)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-08-20T17:38:19.380

只是为了完整性：当从 C# 启动 Swing jar 时，我发现了这个细节：如果你没有在 ProcessStartInfo 对象中设置工作目录，你闪亮的 Swing 应用程序将启动......**但没有图标和图像**！

这是从这里和其他地方的答案复制的最小工作代码（适用于我：Win7 上的 Java 1.8，mi 图像和图标位于 workingDirectory 的子文件夹中）：

```
ProcessStartInfo psi = new ProcessStartInfo("java.exe", " -jar \"C:\\Program Files\\Installed Shiny Swing jar app\\Myjar.jar\"");
psi.WorkingDirectory = "C:\\Program Files\\Installed Shiny Swing jar app\\"; // Do not miss this line so you awesome Swing app will show default java icon and no images
psi.CreateNoWindow = true;
psi.UseShellExecute = false;
Process p = new Process();
p.StartInfo = psi;
p.Start(); 
```

# 64-bit - 如何为 64 位 Windows 编译现有的 posix 代码？

> ID：873812
> 
> 赞同：7
> 
> 时间：2009-05-17T02:52:14.263
> 
> 标签：64-bit, cygwin, mingw, win64

我可以使用 Cygwin 或 MinGW，但我需要以 64 位代码结束，而不是 32 位代码。这是因为我将从 64 位托管 C# 调用 DLL。对于设置这些工具来创建 64 位二进制文​​件，我似乎找不到很好的参考资料。此外，如果 GCC 是版本 4，而不是我的 Cygwin 安装附带的版本 3，那就太好了。

另一种选择是某种形式的进程间通信。我会对此进行研究，但我上面列出的是我真正想要的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T03:00:22.950

基于（刚刚发布的）gcc-4.4.0的[64 位 MinGW可能是您最好的选择。](http://sourceforge.net/projects/mingw-w64)（由于 sourceforge.net 上的 mingw-w64 项目正在迁移到 mingw-w64.org，最好使用[mingw-w64.org](http://mingw-w64.org)）

详细说明：
1\. 下载[存档](http://sourceforge.net/project/downloading.php?group_id=202880&filename=mingw-w64-bin_i686-cygwin-1.5.25-15_20090514.tar.bz2&a=93736319)
2\. 在 cygwin 下解压。在我的例子中，顶级 cygwin 目录是`C:\cygwin`，我将包解压缩到`mingw`目录中，并最终在（在 cygwin 下`C:\cygwin\mingw`可见：`/mingw`

```
$ ls -l /mingw
total 1
drwxr-xr-x+ 2 user None  0 May 10 08:32 bin
drwxr-xr-x+ 2 user None  0 May 10 05:45 include
drwxr-xr-x+ 2 user None  0 May 10 08:30 info
drwxr-xr-x+ 3 user None  0 May 10 08:30 lib
drwxr-xr-x+ 3 user None  0 May 10 05:45 libexec
drwxr-xr-x+ 4 user None  0 May 10 05:45 man
lrwxrwxrwx  1 user None 17 May 17 17:20 mingw -> x86_64-pc-mingw32
drwxr-xr-x+ 3 user None  0 May 10 04:16 share
drwxr-xr-x+ 5 user None  0 May 10 04:18 x86_64-pc-mingw32 
```

3\. 现在编译一些 C++ 代码。我用了：

```
// t.cc
#include <vector>
#include <string>

using namespace std;
int main()
{
    vector<string> vs;
    vs.push_back("abc");
} 
```

并像这样编译它：

```
$ /mingw/bin/x86_64-pc-mingw32-g++ t.cc 
```

4\. 最后，通过运行验证结果是 Windows/x 64 可执行文件`dumpbin /headers a.exe`：

```
Microsoft (R) COFF/PE Dumper Version 7.00.9466
Copyright (C) Microsoft Corporation.  All rights reserved.

Dump of file a.exe

PE signature found

File Type: EXECUTABLE IMAGE

FILE HEADER VALUES
            8664 machine (AMD64)
              10 number of sections
        4A10AF9F time date stamp Sun May 17 17:45:19 2009
           ABA00 file pointer to symbol table
             EC4 number of symbols
              F0 size of optional header
              27 characteristics
                   Relocations stripped
                   Executable
                   Line numbers stripped
                   Application can handle large (>2GB) addresses 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T03:03:14.037

[gcc 文档](http://gcc.gnu.org/onlinedocs/gcc-3.4.6/gcc/i386-and-x86_002d64-Options.html#i386-and-x86_002d64-Options)说：

> 除了上述之外，在 64 位环境中的 AMD x86-64 处理器上还支持这些“-m”开关。
> 
> -m32 -m64 为 32 位或 64 位环境生成代码。32 位环境将 int、long 和指针设置为 32 位，并生成可在任何 i386 系统上运行的代码。64 位环境将 int 设置为 32 位，将 long 和指针设置为 64 位，并为 AMD 的 x86-64 架构生成代码。

请注意，我认为，如果 mingw 真的这样做，那会让你发疯，因为通常在 Windows 64 上 long 是 32 位，而 long long 是 64 位指针大小的类型。

# windows-mobile - 保持 Windows Mobile App 在待机模式下运行

> ID：873816
> 
> 赞同：2
> 
> 时间：2009-05-17T02:56:36.063
> 
> 标签：windows-mobile

我有一个简单的 Windows Mobile 应用程序，它每 5 分钟记录一次 GPS 坐标。问题是只要屏幕打开，应用程序就可以正常工作，一旦手机进入待机模式，应用程序就会停止工作。当我打开设备时，应用程序再次开始工作。

即使在待机模式下，我该怎么做才能让应用程序正常工作？

桑迪普

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T20:29:55.457

我对 GPS 的体验是需要一段时间才能修复（至少在我的设备上），所以我认为你必须让手机始终处于暂停状态。当我一直在玩我的设备时，我注意到我必须在屏幕关闭时使用内置的音乐播放器来修复。正如 ratchetr 指出的那样， PowerPolicyNotify(PPN_UNATTENDEDMODE,TRUE) 似乎是防止“音乐播放器要求”的正确方法。

编辑：您似乎还必须在某些设备上使用 SetPowerRequirement / ReleasePowerRequirement。

这是一个 C# 示例：

```
 public const int PPN_UNATTENDEDMODE = 0x0003;
    public const int POWER_NAME = 0x00000001;
    public const int POWER_FORCE = 0x00001000;

    [DllImport("coredll.dll")]
    public static extern bool PowerPolicyNotify(int dwMessage, bool dwData);

    [DllImport("coredll.dll", SetLastError = true)]
    public static extern IntPtr SetPowerRequirement(string pvDevice, CedevicePowerStateState deviceState, uint deviceFlags, string pvSystemState, ulong stateFlags);

    [DllImport("coredll.dll", SetLastError = true)]
    public static extern int ReleasePowerRequirement(IntPtr hPowerReq);

    public enum CedevicePowerStateState : int
    {
        PwrDeviceUnspecified = -1,
        D0 = 0,
        D1,
        D2,
        D3,
        D4,
    }

    //Keep the GPS and device alive:
    PowerPolicyNotify(PPN_UNATTENDEDMODE, true)
    IntPtr gpsPowerHandle = SetPowerRequirement("gpd0:", CedevicePowerStateState.D0, POWER_NAME | POWER_FORCE, null, 0);

    //Call before exiting your app:
    ReleasePowerRequirement(gpsPowerHandle);
    PowerPolicyNotify(PPN_UNATTENDEDMODE, false); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T03:44:20.570

查看 CeRunAppAtTime 函数。传递给它一个命名事件和你想要运行的时间。等待线程中的事件。您需要在醒来时调用 PowerPolicyNotify，否则设备可能会在您完成之前再次挂起。

代码看起来像这样

```
CeRunAppAtTime(eventName,now + 5 minutes)
while(!quit)
 WaitForSingleObject(event,timeout)
 PowerPolicyNotify(PPN_UNATTENDEDMODE,TRUE)
 DoGpsStuff()
 CeRunAppAtTime(eventName,now + 5 minutes)
 PowerPolicyNotify(PPN_UNATTENDEDMODE,FALSE) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T19:56:45.440

也许这个 SO 问题的答案会有所帮助：[如何在被挂起的情况下在 Windows Mobile 上运行代码？](https://stackoverflow.com/questions/336771/how-can-i-run-code-on-windows-mobile-while-being-suspended)它使用“无人值守”模式来保持应用程序在屏幕关闭的情况下运行。

# licensing - 如何在不让我的软件看起来像在该许可证下的情况下将许可证归属于使用的库？

> ID：873823
> 
> 赞同：8
> 
> 时间：2009-05-17T03:03:00.290
> 
> 标签：licensing

在这种情况下，许可证问题是 Apache License v2，但基本上如果我只是在应用程序目录中包含一个带有许可证的文本文件，看起来我的应用程序是根据该许可证获得许可的，但事实并非如此。

您是否只是在许可证顶部添加一个小注释以表明 [图书馆名称] 在此许可证下？如何引用库？通过网站或主机的网址？

我没有找到任何受骗者，但如果存在受骗者的链接，请随时关闭。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T03:14:25.927

只需说“此软件包包含具有以下许可证的软件：”，然后列出任何其他许可证。我很确定您不必列出它是哪个特定部分（无论如何对于大多数开源许可证）。我为那个分布式开源库工作过的所有地方都是这样做的。它明确没有说明可以在这些许可的条件下使用整个作品。

**编辑：**当然，如果任何许可证需要源代码分发，那么您应该指出可以找到的位置，但 Apache 并非如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T03:32:53.450

是的，包括您自己的许可文件，其中说明了您的应用程序的完整许可条件......然后在底部列出每个开源组件，复制/使用每个组件的许可证名称，以及（为方便起见) 给出一个 URL，从中可以找到每个完整的许可证文档。

请注意不要影响开源许可证...通读每个条款和条件的声明...如果它“有点灰色”，请寻求法律建议。对于野蛮的律师来说，版权是一个**非常**有利可图的领域。

# sql - 从子选择向 DB2 中插入一行 - NULL 错误

> ID：873828
> 
> 赞同：7
> 
> 时间：2009-05-17T03:13:47.630
> 
> 标签：sql, db2

我正在尝试使用从另一个表派生的值将一行插入到表中。这是我尝试使用的 SQL 语句：

```
INSERT INTO NextKeyValue(KeyName, KeyValue) SELECT 'DisplayWorkItemId' AS KeyName, (MAX(work_item_display_id) + 1) AS KeyValue FROM work_item; 
```

所以，我试图在其中创建一个行，`NextKeyValue`其中的 'KeyName' 为 'DisplayWorkItemId' 和 'KeyValue' 比`work_item.work_item_display_id`.

上面查询中的 SELECT 语句在我自己运行时返回预期的结果。

但是，整个 SQL 查询给了我以下错误：

> 错误：DB2 SQL 错误：SQLCODE=-407，SQLSTATE=23502，SQLERRMC=TBSPACEID=2，TABLEID=75，COLNO=2，DRIVER=3.50.152 SQLState：23502 错误代码：-407

这是什么意思，我的查询有什么问题？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-17T05:12:49.063

最可能的解释是 NextKeyValue 表中有其他列不能接受 NULL 值，并且此 INSERT 语句正在“尝试”将 NULL 放入其中。

是这样吗？

# wolfram-mathematica - 评估 Mathematica

> ID：873841
> 
> 赞同：0
> 
> 时间：2009-05-17T03:25:50.893
> 
> 标签：wolfram-mathematica

我有一个 15 天的 Mathematica 试用版，需要对其进行评估，看看它是否可以用来帮助为我们正在开发的某些游戏创建算法。

有没有什么好的资源可以教我一些基础知识并让我探索应用程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T03:32:01.690

你当然可以自己用谷歌搜索这个吗？

*   [Mathematica 教程](http://library.wolfram.com/conferences/devconf99/withoff/index2.html)
*   [Mathematica 教程](http://serc.carleton.edu/quantskills/methods/tech/btitus.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-08-18T20:47:02.637

一些对专门的初学者有用的资源：

[http://www.wolfram.com/broadcast/](http://www.wolfram.com/broadcast/)

*   视频演示和简短教程

* * *

[http://blog.wolfram.com/](http://blog.wolfram.com/)

*   Wolfram 博客经常展示*Mathematica*的可能性，并包含代码。

* * *

[http://bmia.bmt.tue.nl/Software/Downloads/Campus/TrainingMathematicaEnglish.zip](http://bmia.bmt.tue.nl/Software/Downloads/Campus/TrainingMathematicaEnglish.zip)

*   .zip 文件中的训练笔记本。

* * *

[http://www.mathprogramming-intro.org/](http://www.mathprogramming-intro.org/)

[http://www.google.com/search?&q=site:www.mathprogramming-intro.org](http://www.google.com/search?&q=site:www.mathprogramming-intro.org)

*   Mathematica® 编程：[Leonid Shifrin](https://stackoverflow.com/users/565518)的高级介绍。

    一个非常高级的介绍，但仍然平易近人，可搜索（第二个链接）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-30T19:39:30.417

Mathematica 包含大量信息，可能会让您感到困惑。每个 Mathematica 新用户的目标应该是一个好的第一个参考，因为这可能会影响他们的体验。

第一站，虚拟书（在帮助菜单中找到）。它包含快速入门材料和基本原则，但我发现它很容易偏离主题，而且它对实际示例并不繁重。此外，Wolfram（作为一家营利性公司）将 Mathematica 推销为对所有人来说都是万能的，Virtual book 对它的缺点并不客观。

我使用 [学生手册](https://rads.stackoverflow.com/amzn/click/com/0521717892)作为数学未成年人的指南：绘图、多变量微积分、线性代数和处理数据。在这种情况下，它非常简洁。

听起来您需要浏览“真实世界”的示例，并且在试用期结束之前的时间有限。我推荐 O'Reilly 的[Mathematica Cookbook](http://oreilly.com/catalog/9780596521004)。您可以立即获得在线书籍，O'Reilly 的食谱风格将让您了解有效测试您的游戏创意所需的那种编程。

祝 Mathematica 好运

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-31T01:29:28.377

查看 Luc Barthelet（前 EA Games）关于他在游戏开发中使用 Mathematica 的演示：

[http://library.wolfram.com/infocenter/Conferences/5367/](http://library.wolfram.com/infocenter/Conferences/5367/)

# ruby-on-rails - 使用会话数据找出谁在线

> ID：873846
> 
> 赞同：0
> 
> 时间：2009-05-17T03:32:15.197
> 
> 标签：ruby-on-rails, session

我希望能够找出谁登录了我的网络应用程序并能够打印出登录用户列表。我还希望能够打印出谁正在查看应用程序的某个部分（例如聊天室，这样我就可以打印出聊天用户）。

目前，我只有：

```
session[:role_id] = @role_id 
```

当有人登录应用程序时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T07:09:13.697

每次用户向服务器发出请求时，您都可以使用**before_filter捕获用户。**使用**current_user的****updated_at**属性（或您所做的任何其他调用获取已**登录**用户）

 ****一个使用**before_filter**的简单示例：

```
class RubyDevelopersController < ChatRoomController

 # every time the request hits the server a call is sent to register the user
 before_filter :register_user

 private

 def register_user

    # the current_user's model is updated with the name  
    # of the chatroom he's hidding in.
    # remember that this call also updates updated_at field of the current_user
    current_user.update_attribute( :current_chatroom, 'ruby_developers' )
 end

 def ative_users_in_ruby_developers_chatroom
  # find all users in the current chatroom that has been updated_at in the last 5 minutes.
  Users.find( :all, {
   :conditions => ["current_chatroom = ? and updated_at > ?",'ruby_developers', 5.minutes.ago ],
   :sort => 'updated_at'
  })
 end
end 
```

另见：

[http://railsforum.com/viewtopic.php?pid=66001](http://railsforum.com/viewtopic.php?pid=66001)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-11T02:26:24.143

如果您将会话数据存储在数据库中，我想您可以创建一个映射到会话表的模型并查询该表以获取用户列表。如果所有会话数据都存储在 cookie 中，则前面的答案更理想。

# visual-studio - 远程桌面上的 VS 2008 SP1：不断重绘？

> ID：873849
> 
> 赞同：9
> 
> 时间：2009-05-17T03:33:16.553
> 
> 标签：visual-studio, visual-studio-2008, performance, remote-desktop

Visual Studio 2008 中的文本编辑器比远程桌面快得多。

Visual Studio 2008 SP1 中的文本编辑器在远程桌面上非常慢，导致重新绘制过多（并导致闪烁）。连接速度越慢，问题就越严重，但即使 RDP 连接到同一 LAN 上的机器上，问题也会变得更加严重。

问题似乎仅限于 Visual Studio。在另一个编辑器（如 Notepad 和 Notepad2）中执行相同的编辑操作非常快，无需完全编辑器重新绘制。

有谁知道是什么原因造成的，有什么办法可以解决吗？

有问题的机器正在运行 Windows Server 2008 Enterprise。我注意到它从各种操作系统中进行 RDPing，包括 Windows Vista、Windows Server 2008 和 Windows 7。

我尝试过的事情没有任何区别：

*   将字体更改为 Arial Black
*   使用非 TrueType 字体
*   关闭更改跟踪
*   关闭插件（我正在运行 TD.NET、Refactor! Pro 和 GhostDoc）
*   关闭动画工具（已经关闭，但我想我还是会列出它）
*   关闭导航栏

**更新：**目前，问题似乎已解决，因为在 VS2010 Beta 1 中，RDP 上的绘画问题现已消失。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-04T06:41:17.667

在连接之前尝试在 RDP 选项中禁用字体平滑。为我修好了。它使所有东西看起来都相当粗糙（将 VS 中的 Environment 字体更改为 Arial 10pt 有帮助），但现在至少没有闪烁。我会在那个烦人的闪烁上没有闪烁的颗粒感。它会让我癫痫发作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-11T19:23:13.163

在带有 的 linux 上`rdesktop`，我无法使用**Visual Studio 2008**（在**Win XP**上）。Visual Studio 窗口不响应`click`或`keyboard input`。它根本不刷新。

在 Windows 端尝试了各种操作，但它似乎特定于 rdesktop。

这些选项解决了问题：**强制 RDP4**，**位图更新**，**连接到控制台**

```
rdesktop xxx.xxx.xxx.xxx -g1680x960 -0 -b -4 
```

**（在 Ubuntu 11.04、rdesktop 1.6.0 上）**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-06T12:06:51.377

我没有看到这个问题。然而，Visual Studio 2008 似乎确实保留了它曾经创建的所有 Intellisense 窗口，只是让它们不可见。但是，当您使用 RDP 登录时，它们会立即出现。一旦他们都被画出来，他们会再次消失*- 叹息 -*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-06T10:03:14.027

确保远程桌面连接中的带宽设置适合您与远程 PC 的连接。关闭主题可以产生很大的不同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-29T14:33:05.937

如果您正在运行 Win7，请尝试关闭 ClearType。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T15:09:42.280

它是否发生在所有文件类型中，或者仅发生在 javascript 文件中？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-17T03:42:56.220

您是否记得：

1.  关闭导航栏
2.  关闭跟踪更改
3.  关闭 Animate 环境工具

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-17T04:09:18.013

关闭所有插件。将字体更改为 Arial Black（我发现 Consolas 会导致问题）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-03-30T18:01:21.490

这对我有用：

右键单击 devenv.exe -> 属性 -> 兼容性。

选中“禁用视觉场景”和“禁用显示合成”。按确定。

（好吧，实际上它只是将整页重绘的闪烁减少到较小程度，但我仍然对此感到茫然 - 该死！）

# c++ - C++ 中的平铺运动

> ID：873851
> 
> 赞同：0
> 
> 时间：2009-05-17T03:34:17.360
> 
> 标签：c++, collision-detection

这就是我现在正在使用的东西

```
if (osl_keys->held.down)
{
sprite_position = DOWN;
SpriteAnimate();
sceKernelDelayThread(20000);
sprite->y += 16;
SpriteAnimate();
sceKernelDelayThread(20000);
sprite->y += 16;
}
if (osl_keys->held.up)
{
sprite_position = UP;
SpriteAnimate();
sceKernelDelayThread(20000);
sprite->y -= 16;
SpriteAnimate();
sceKernelDelayThread(20000);
sprite->y -= 16;
}
if (osl_keys->held.right)
{
sprite_position = RIGHT;
SpriteAnimate();
sceKernelDelayThread(20000);
sprite->x += 16;
SpriteAnimate();
sceKernelDelayThread(20000);
sprite->x += 16;
}
if (osl_keys->held.left)
{
sprite_position = LEFT;
SpriteAnimate();
sceKernelDelayThread(20000);
sprite->x -= 16;
SpriteAnimate();
sceKernelDelayThread(20000);
sprite->x -= 16;
}
sceKernelDelayThread(750000); 
```

我已经决定让每个精灵都是 32x32，所以碰撞可能更适用

> 通过 lokiare1，您仍然需要检查与瓷砖的碰撞。进行碰撞的最彻底的方法是检查一个精灵的每个可见像素的位置与每个其他精灵的每个其他像素的位置，然后返回一个指向与之碰撞的精灵的指针。这会很慢。我描述的方法应该是一个缓慢而肮脏的工作碰撞检测。如果我错了，请告诉我我错了。

这是我难以想象的部分（我喜欢在我尝试之前确保事情在我的脑海中运作，这样我不会随意跳到一些东西上）我已经花了几个晚上坐在淋浴间试图想到一种检查是否有东西的方法

我在想一些预设瓷砖 x,y 是实心的东西，所以如果一个实心物体在它前面不要移动，否则移动我在我的帖子中工作>。>

```
if (osl_keys->held.down)
{
if (y+1 == bush=>y)
{
sprite_march = 4;
SpriteAnimate();
else
{
sprite_position = DOWN;
SpriteAnimate();
sceKernelDelayThread(20000);
sprite->y += 16;
SpriteAnimate();
sceKernelDelayThread(20000);
sprite->y += 16;
} 
```

但话又说回来，我怎么能通过问（y+1 ==solid）来缩短代码量，我不知道该怎么做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T06:30:06.787

这不是答案，而是一般风格说明。你注意到你的代码是重复的吗？因为它是。您的第一篇代码可以缩短很多：

```
int down_direction = 0, right_direction = 0;
if (osl_keys->held.down)
{
    down_direction = 16;
    sprite_position = DOWN;
}
else if (osl_keys->held.up)
{
    down_direction = -16;
    sprite_position = UP;
}
else if (osl_keys->held.right)
{
    right_direction = 16;
    sprite_position = RIGHT;
}
else if (osl_keys->held.left)
{
    right_direction = -16;
    sprite_position = LEFT;
}

for (int i = 0; i < 2; ++i)
{
    SpriteAnimate();
    sceKernelDelayThread(20000);
    sprite->x += right_direction;
    sprite->y += down_direction;
}
sceKernelDelayThread(750000); 
```

那里，不是更好吗？

要回答您的问题，您不想跟踪精灵的像素位置。您想要跟踪行和列的位置。如果目标瓷砖是实心的，那么在移动之前检查一下侧面。

# php - 重命名不支持多字节字符

> ID：873853
> 
> 赞同：5
> 
> 时间：2009-05-17T03:36:32.057
> 
> 标签：php, rename, multibyte

如果我写：

```
rename('php109.tmp','test.jpg'); 
```

然后它很好并且工作。

但如果我把它改成：

```
rename('php109.tmp','中文.jpg'); 
```

它会报告

> “没有这样的文件或目录...”。

但是如果多字节字符可以写入数据库然后可以读出，那么为什么它重命名时会失败？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-19T13:16:49.607

此示例应该有所帮助，您应该找到您的语言代码页并用它替换。我测试了 Bellow 代码，它在 Windows 中适用于阿拉伯/波斯名称：

```
$newname = iconv("utf-8", "cp1256","گچپژ");
echo rename("1.txt", $newname); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-19T09:20:28.750

文件系统不一定使用 UTF-8。例如，这就是 Wikipedia 关于[NTFS](http://en.wikipedia.org/wiki/Ntfs)的说法：

> NTFS 允许名称编码的任何 16 位值序列（文件名、流名称、索引名称等）。这意味着支持 UTF-16 代码点，但文件系统不检查序列是否是有效的 UTF-16（它允许任何短值序列，不限于 Unicode 标准中的序列）。

您可能需要使用[iconv()](http://www.php.net/iconv)在字符集之间进行转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-09T11:17:54.297

您是否尝试过使用`setlocale(LC_ALL, array("es_ES.utf-8","es_ES@euro",'es_ES'));`国家/地区代码或任何国家/地区代码，以确保正确设置区域设置？

如果此调用未返回包含“utf-8”的内容，则表示它失败，然后将返回当前语言环境。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-18T02:16:05.087

我几乎可以肯定 mbstring 与这个特定问题无关，我认为这里的问题取决于你的 .php 文件的编码。

尝试在代码编辑器中将文件的编码更改为 UTF-8（没有 BOM！）。

# ruby - Ruby Function with Unlimited Number of Parameters

> ID：873861
> 
> 赞同：24
> 
> 时间：2009-05-17T03:47:34.277
> 
> 标签：ruby, variadic-functions

How do I create a Ruby function that does not have an explicit number of parameters?

More clarification needed?

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-17T04:14:07.520

Use the splat operator `*`

```
def foo(a,b,c,*others)
   # this function has at least three arguments,
   # but might have more
   puts a
   puts b
   puts c
   puts others.join(',')
end
foo(1,2,3,4,5,6,7,8,9)
# prints:
# 1
# 2
# 3
# 4,5,6,7,8,9 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-17T03:51:36.747

Use `*rest`. here's a nice little [tutorial](http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_methods.html).

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-12-11T18:51:40.217

(If I could add a comment to the accepted answer, I would, but I don't have enough points.)

Warning: Be careful about doing this for methods processing general data. It's a great piece of syntax sugar, but there *are* limits to the number of arguments you can pass to a method before you get a SystemStackError. I've hit that limit using `redis.mapped_mget *keys`. Also, the limit will change depending on where you use the splat operator. For instance, running pry locally, I can splat arrays of over 130,000 elements to a method. Running within a Celluloid actor, though, that limit can be less than 16,000 elements.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-20T17:23:41.630

Here's another article on the subject:

[www.misuse.org/science/2008/01/30/passing-multiple-arguments-in-ruby-is-your-friend](http://www.misuse.org/science/2008/01/30/passing-multiple-arguments-in-ruby-is-your-friend)

Gives some nice examples rolling and unrolling your parameters using "*"

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-29T00:28:35.863

In addition, here is also an interesting "look-alike" technique to passing multiple *named* parameters. It's based on the fact that Ruby will convert a list of named parameters to a hash if given in a place where one positional parameter is expected:

```
def hashed_args_test(args = {})
  p args
end

hashed_args_test(arg1: "val1", arg2: "val2")
# => {:arg1=>"val1", :arg2=>"val2"}

hashed_args_test( {arg1: "val1", arg2: "val2"} )
# => {:arg1=>"val1", :arg2=>"val2"} 
```

So both ways of invoking the method supply a hash of (any number of) elements – whether using the hash syntax explicitly or something that looks exactly like passing named parameters. (Tested with Ruby 2.5.3.)

# apache-flex - Flex 上传器和有关 flex 的详细信息

> ID：873862
> 
> 赞同：0
> 
> 时间：2009-05-17T03:48:09.377
> 
> 标签：apache-flex, uploader

我为 3rd 方网站制作上传器，我不想通过我的主机上传（用户上传到主机，主机上传到 3rd 方网站），它浪费带宽，所以我决定选择 flex，但我想在我之前清楚地了解 flex试过了，它可以在上传后处理http响应吗（重定向头，html响应，json ...）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T06:11:04.210

是的，flex 将处理 http 响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-02T10:08:04.853

有点不清楚你在追求什么，但你可以试试这个**Flex/PHP 上传**器。它支持多上传和线程同时上传：

[http://bytearray.brixtonjunkies.com/2009/10/01/flex-multiple-file-uploader/](http://bytearray.brixtonjunkies.com/2009/10/01/flex-multiple-file-uploader/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T04:04:24.063

我不确定这是否正是您正在寻找的，但有一些基于 Flash 的文件上传器支持跨域（第 3 方）上传：

fancyupload 在其主页上专门解决了跨域支持：http: [//digitarald.de/project/fancyupload/1-0/](http://digitarald.de/project/fancyupload/1-0/)

您确实需要在第三方站点上有一个 crossdomain.xml 文件，有关于如何执行此操作的说明：

[http://forum.mootools.net/viewtopic.php?id=8312](http://forum.mootools.net/viewtopic.php?id=8312)

和

[http://livedocs.adobe.com/flash/8/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001590.html](http://livedocs.adobe.com/flash/8/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001590.html)

他们使用标准的 http 多部分表单发布，以便接收服务器可以处理它们将工作。在客户端提供javascript接口来获取上传的结果。

# c# - C# Func 和条件运算符

> ID：873864
> 
> 赞同：5
> 
> 时间：2009-05-17T03:49:24.537
> 
> 标签：c#

[复制](https://stackoverflow.com/questions/263151/lambdas-and-the-ternary-operator-weird-issue)

我可以做这个：

```
Func<CategorySummary, decimal> orderByFunc;
if (orderBy == OrderProductsByProperty.Speed)
     orderByFunc = x => x.Speed;
else
    orderByFunc = x => x.Price; 
```

为什么我不能这样做：

```
Func<CategorySummary, decimal> orderByFunc = (orderBy == OrderProductsByProperty.Speed) ? x => x.Speed : x => x.Price; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T03:59:49.003

条件运算符的“类型推断”不够好，我收到一条消息

> 无法确定条件表达式的类型，因为“lambda 表达式”和“lambda 表达式”之间没有隐式转换

你总是可以在右手边显式，a la

```
var o = true ? new Func<int,int>(x => 0) : new Func<int,int>(x => 1); 
```

无论如何，这只是关于 lambda 类型、类型推断和条件运算符如何交互的小麻烦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T04:00:05.197

只需将 lambda 转换为`Func<CategorySummary, decimal>`它就可以了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T07:26:16.450

到目前为止建议的替代方案 - 将条件移动到 lambda 表达式中：

```
Func<CategorySummary, decimal> orderByFunc = 
    x => (orderBy == OrderProductsByProperty.Speed) ? x.Speed : x.Price; 
```

它可能并不适用于所有情况（这确实意味着每次调用都会执行检查），但有时它可能很有用。

编辑：正如埃里克指出的那样，两者并不等同。这是它们如何不同的快速示例（使用显式转换来使条件在操作数为 lambda 的情况下工作）：

```
using System;

class Test
{   
    static void Main()
    {
        bool likesCheese = false;

        Action outerConditional = likesCheese 
            ? (Action) (() => Console.WriteLine("Outer: I like cheese"))
            : (Action) (() => Console.WriteLine("Outer: I hate cheese"));

        Action innerConditional = () => 
            Console.WriteLine (likesCheese ? "Inner: I like cheese" 
                                           : "Inner: I hate cheese");

        Console.WriteLine("Before change...");
        outerConditional();
        innerConditional();

        likesCheese = true;
        Console.WriteLine("After change...");
        outerConditional();
        innerConditional();
    }
} 
```

结果：

```
Before change...
Outer: I hate cheese
Inner: I hate cheese
After change...
Outer: I hate cheese
Inner: I like cheese 
```

如您所见，对 的值的更改仅影响*在*lambda 表达式`likesCheese`中具有条件运算符的版本。有时这是可取的，有时不是……但您绝对需要意识到这一点。

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-15T17:28:29.977

只需将一个结果操作数转换为目标类型就足够了：

```
Action showResult = true 
    ? (Action)(() => Console.Write("Hello!"))
    : () => Console.Write(""); 
```

这有点出乎意料，但这就是编译器的工作方式。当我想到它时，它现在是有道理的。

# java - 在 JAVA 中处理包含 XML 的字符串的最有效方法

> ID：873875
> 
> 赞同：3
> 
> 时间：2009-05-17T04:04:35.187
> 
> 标签：java, xml, jsp, dom, javabeans

我有一个字符串，其中包含 XML 节点，并且正在寻求使用 DOM 解析来处理此字符串以提取节点值并将它们存储在局部变量中。

存储在 String 变量中的 XML：

```
<carGarage>
   <car>
      <make>Chrysler</make>
      <color>Red</color>
   </car>
   <car>
      <make>Musano</make>
      <color>Blue</color>
   </car>
</carGarage> 
```

我想要提取 XML 值并将它们存储在本地属性中的 Java 类：

```
public class CarGarage
{   String make, color;

    public void setMake(String make)
    { this.make = make; }

    public void setColor(String color)
    { this.color = color; }

    public void DOMparsingMethod(Node thisNode)
    { int typeOfNode = thisNode.getNodeType();
      ...
    }
} 
```

解决这个问题的最佳方法是什么？我看过 StringBufferInputStream 但不推荐使用。我真的很迷茫。

谢谢你，卢卡斯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T04:10:22.300

查看使用[DocumentBuilder](http://java.sun.com/j2se/1.4.2/docs/api/javax/xml/parsers/DocumentBuilder.html)从任何类型的输入流中进行解析。这是一个从文件中读取像您这样的类的[示例。](http://www.java-tips.org/java-se-tips/javax.xml.parsers/how-to-read-xml-file-in-java.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T04:29:32.693

有很多 object-to-xml 绑定库可以完全满足您的需求，但它们往往是相当庞大的工具。

对于这个简单的例子，自己处理 dom 是有意义的。justinhj 对此的内置 java 库的建议是一个好的开始，尽管这有时也会变得丑陋，因为 jdk 通常不为您提供 xml 解析器，需要您在幕后神奇地插入自己的。

对于这类事情，我倾向于使用[jdom 。](http://www.jdom.org/)它实际上与 DocumentBuilder 路由相同，但相似且仅部分兼容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T04:34:15.520

为什么要使用 DOM？

如果您只是想读入并将 xml 转换为对象，那么我建议您使用 STAX，因为 SAX 比 DOM 快，但是编码太多，STAX 更好，您可以在下面了解更多信息。 [https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/programming-and-development/?p=639](https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/programming-and-development/?p=639)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T06:06:03.147

我建议你看看[XStream](http://xstream.codehaus.org/)。它支持将 XML 转换为对象。你可以给它 XML，它会给你一个你想要的对象列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T05:48:30.710

根据我的经验，DOM 对这类事情很有用，因为与 SAX / STAX 相比，它的学习曲线较低，尽管它的速度或内存效率不高。获得 DOM 文档后，您可以对文档使用 XPath 查询来获取单个元素内容并解析它们。

# asp.net-mvc - 使用 ASP.NET MVC 打印元标记时遇到问题

> ID：873880
> 
> 赞同：1
> 
> 时间：2009-05-17T04:09:47.653
> 
> 标签：asp.net-mvc

我正在尝试根据我的模型中的数据在我的视图中创建一个元标记......我的视图代码如下所示：

```
<meta name="description" content="<%=Html.Encode(Model.MetaDescription) %>" /> 
```

但我的输出如下所示：

```
meta name="description" content="&lt;%=Html.Encode(Model.MetaDescription) %>" /> 
```

我到底做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T04:57:34.730

您可能正在将此`meta`标签添加到标记为 的`<head>`标签中`runat="server"`。尝试：

```
<meta name="description" content='<%=Html.Encode(Model.MetaDescription) %>' /> 
```

我不清楚实际问题是什么，因为我没有完整的来源，但可以解决：

```
<meta name="description" content=<%= "\"" + Html.Encode(Model.MetaDescription) + "\"" %> /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-10T08:36:48.040

Mehrdad 的第二个解决方案可以正常工作并呈现有效的 XHTML，但会导致 VS IDE 抱怨语法无效（它在设计时没有“看到”双引号并认为它们丢失了）。

更好的（工作）语法是：

```
<meta name="description" content=<%= "" + Html.Encode(Model.MetaDescription) %> /> 
```

这似乎是MVC渲染引擎中的一个错误，开头的空字符串是一种解决方法......

# ruby - Ruby 的自我定义

> ID：873889
> 
> 赞同：13
> 
> 时间：2009-05-17T04:17:42.907
> 
> 标签：ruby, self

我正在阅读一本 Ruby 书籍，并遇到了伪变量 self 的这个定义：

> 当前方法的self-receiver对象

有人可以打破这个定义并解释它的含义吗？我一点都不明白。

编辑：我实际上对 self 是什么（及其应用程序）有一个很好的了解，并且我知道如何在 Google 上搜索。我只是想知道是否有人可以解释我引用的定义。具体就是这样。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-17T09:06:18.470

Ruby 和其他语言（例如 Smalltalk 和 Objective-C）更喜欢术语“消息传递”，而 Java 和 C++ 更喜欢“方法调用”。也就是说，“Java 方式”是调用对象上的方法——在对象的上下文中运行代码——而“Ruby 方式”是向对象发送消息，对象通过运行其方法来响应该消息。

Ruby 将该行描述为`my_string.length`“发送消息”。接收消息的，称为接收者；在方法的定义里面，会引用. 你可以得到同样的效果。`my_string``length``my_string``length``self``my_string``my_string.send(:length)`

从消息传递的角度考虑这个概念比从方法调用的角度考虑更灵活。要调用对象上的方法，该方法必须已预先定义，而您可以向对象发送可以选择动态处理的消息（使用`respond_to?`and `method_missing`）。这种灵活性是允许 Ruby 用作简洁的领域特定语言 (DSL) 的一个方面。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-17T04:35:50.650

`self`是一个特殊变量，根据上下文而变化。更具体地说，它是当前方法的接收器对象，正如您所提到的。要理解这一点，我们需要了解接收者的含义。

请参阅[Ruby 编程](http://www.ruby-doc.org/docs/ProgrammingRuby/)：[有关方法](http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_methods.html)、[类和对象](http://www.ruby-doc.org/docs/ProgrammingRuby/html/classes.html)的更多信息。

> 您可以通过指定接收者、方法名称以及可选的一些参数和关联块来调用方法。

```
connection.downloadMP3("jitterbug") { |p| showProgress(p) } 
```

> 在这个例子中，对象`connection` 是接收者，`downloadMP3`是方法的名称，`"jitterbug"`是参数，大括号之间的东西是关联的块。

```
foo = "hello"
bar = foo.dup
class <<foo
  def to_s
    "The value is '#{self}'"
  end
  def twoTimes
    self + self
  end
end

foo.to_s        »   "The value is 'hello'"
foo.twoTimes    »   "hellohello"
bar.to_s        »   "hello" 
```

在`foo.twoTimes`中，`foo`部分被称为方法调用的接收者。所以，在`twoTimes`方法内，`self`指的`foo`是上下文中的对象。

[这里也有很好的解释](http://rubylearning.com/satishtalim/ruby_self.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-17T09:07:32.103

> 当前方法的self-receiver对象

Ruby 中的“方法调用”是通过消息发送机制完成的。所以

```
some_object.some_method(args) 
```

是的简写

```
some_object.send(:some_method, args) 
```

我认为这就是引用的意思：“self”是消息（或方法）已发送到的对象：当前方法的接收者。

整个消息发送是 Ruby 如此动态的部分原因。它使对象可以很容易地定义`method_missing`它当前不处理的消息并决定如何处理它们。Rails 经常使用它：例如，ActiveRecord 有“find_by...”语法，它从被调用/发送的方法的名称中找出想要的东西。

# javascript - 为横向视图重新格式化

> ID：873895
> 
> 赞同：0
> 
> 时间：2009-05-17T04:27:20.543
> 
> 标签：javascript, iphone, uiwebview, viewport

我从基于导航的应用程序中的字符串加载 UIWebView。我在 UIWebView 的标题标签中使用它：

```
<meta name="viewport" content="width=320,height=420,user-scalable=yes,initial-scale=1.0"> 
```

我使用 1.0 的视口，因为不需要重新调整图像大小，没有视口的情况就是这样。当手机旋转到横向时，窗口宽度被严重剪裁，右侧出现黑色空白。我希望视图能够填充所有横向空间......并且要填充文本使用这个空间，而不是像纵向那样包装。有没有办法获得这种格式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T05:31:33.603

您对宽度为 320 的视口使用小于 1 的比例，这很奇怪，因为设备有足够的像素来显示整个视图。你到底想得到什么？你想让视图只占据屏幕的一部分吗？不确定这是否适用于元，您需要调整视图本身的大小。

此外，这是[语法](http://developer.apple.com/safari/library/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html)：

```
<meta name = "viewport" content = "width = 320,
   initial-scale = 2.3, user-scalable = no"> 
```

请注意，Apple 使用逗号，而您使用分号。

如果横向太大，并且您经常使用横向，只需将其全部缩小，并在纵向时偶尔放大:-)

# c++ - 使用 hash_map 失败 ，字符串>，为什么？

> ID：873899
> 
> 赞同：2
> 
> 时间：2009-05-17T04:29:21.787
> 
> 标签：c++, templates, stl

我已经实现了这段代码，但编译失败（VC2008 Express Ed.）：
现在所有代码都在这里。

```
 #include <stdio.h>
#include <vector>
#include <string>
#include <hash_map>

using namespace std;
using namespace stdext;

typedef vector type_key;

int main(int argc, char* argv[])
{
    type_key key;

    hash_map<type_key, string> map_segment;
    hash_map<type_key, string>::iterator iter_map_segment;

    iter_map_segment = map_segment.find(key);

    return 0;
} 
```

使用 unordered_map 也会发生同样的错误。

但不会发生用地图错误替换容器。
可以做些什么来纠正？
谢谢你。

[编辑]
错误信息：

```
 ------ Build started: Project: map_key_test, Configuration: Debug Win32 ------
Compiling...
map_key_test.cpp
c:\program files\microsoft visual studio 9.0\vc\include\xhash(75) : error C2440: 'type cast' : cannot convert from 'const type_key' to 'size_t'
        No user-defined-conversion operator available that can perform this conversion, or the operator cannot be called
        c:\program files\microsoft visual studio 9.0\vc\include\xhash(128) : see reference to function template instantiation 'size_t stdext::hash_value<_Kty>(const _Kty &)' being compiled
        with
        [
            _Kty=type_key
        ]
        c:\program files\microsoft visual studio 9.0\vc\include\xhash(127) : while compiling class template member function 'size_t stdext::hash_compare<_Kty,_Pr>::operator ()(const _Kty &) const'
        with
        [
            _Kty=type_key,
            _Pr=std::less<type_key>
        ]
        c:\program files\microsoft visual studio 9.0\vc\include\hash_map(78) : see reference to class template instantiation 'stdext::hash_compare<_Kty,_Pr>' being compiled
        with
        [
            _Kty=type_key,
            _Pr=std::less<type_key>
        ]
        c:\program files\microsoft visual studio 9.0\vc\include\xhash(191) : see reference to class template instantiation 'stdext::_Hmap_traits<_Kty,_Ty,_Tr,_Alloc,_Mfl>' being compiled
        with
        [
            _Kty=type_key,
            _Ty=std::string,
            _Tr=stdext::hash_compare<type_key,std::less<type_key>>,
            _Alloc=std::allocator<std::pair<const type_key,std::string>>,
            _Mfl=false
        ]
        c:\program files\microsoft visual studio 9.0\vc\include\hash_map(88) : see reference to class template instantiation 'stdext::_Hash<_Traits>' being compiled
        with
        [
            _Traits=stdext::_Hmap_traits<type_key,std::string,stdext::hash_compare<type_key,std::less<type_key>>,std::allocator<std::pair<const type_key,std::string>>,false>
        ]
        c:\users\salamon\documents\visual studio 2008\projects\map_key_test\map_key_test.cpp(17) : see reference to class template instantiation 'stdext::hash_map<_Kty,_Ty>' being compiled
        with
        [
            _Kty=type_key,
            _Ty=std::string
        ]
Build log was saved at "file://c:\Users\Salamon\Documents\Visual Studio 2008\Projects\map_key_test\Debug\BuildLog.htm"
map_key_test - 1 error(s), 0 warning(s)
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

[编辑]
完整的解决方案：

```
 #include <stdio.h>
#include <vector>
#include <string>
#include <hash_map>
using namespace std;
using namespace stdext;

class Vector : public vector<int>
{
public:
    operator size_t() const { return (*this).size(); };
};
typedef Vector type_key;

struct less_vector
{
    bool operator()(const Vector & x, const Vector & y) const
    {
        if ( x != y )
            return true;

        return false;
    }
};

struct greater_vector
{
    bool operator()(const Vector & x, const Vector & y) const
    {
        if ( x == y )
            return true;

        return false;
    }
};

int main(int argc, char* argv[])
{
    Vector key;
    string str;

    hash_map<Vector, string, hash_compare <Vector, less_vector > > map_segment;
    hash_map<Vector, string, hash_compare <Vector, greater_vector > >::iterator iter_map_segment;

    //
    key.push_back(0);
    key.push_back(1);
    key.push_back(2);
    str = "012";
    map_segment [key] = str;
    //
    key.clear();
    key.push_back(1);
    key.push_back(0);
    key.push_back(2);
    str = "102";
    map_segment [key] = str;
    //
    key.clear();
    key.push_back(2);
    key.push_back(1);
    key.push_back(0);
    str = "210";
    map_segment [key] = str;
    //
    key.clear();
    key.push_back(1);
    key.push_back(0);
    key.push_back(2);

    iter_map_segment = map_segment.find(key);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T04:43:10.803

首先，确保您包含的标头确实存在于您的安装中。

其次，hash_map 在`stdext`命名空间中，确保通过将其显式指定为`stdext::hash_map`或通过`using`指令使该名称可见。

第三，代码中 hash_map 的模板参数在哪里？我只看到`hash_map`而没有`hash_map<vector<int>,string>`。

第四，我不确定 std::vector 是否可以像这样用作哈希映射的哈希键。您需要为您的键定义一个哈希函数（通过实现一个`hash_compare`函数对象并将其`hash_map`作为第三个模板参数传递）。无论如何，按值存储这些向量并不是一个好主意，相反，您可能应该考虑使用指向这些向量的指针作为键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T05:31:35.960

即使它有效，我也闻到了鱼的味道......在什么情况下你想使用整数向量作为键来从哈希映射中检索字符串属性？

对我来说，这听起来像是糟糕的/没有设计......只需考虑一下计算所有这些哈希码的费用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T18:09:00.047

要比较键，应定义 <,==,> 运算符。这里的 find() 函数不知道如何比较键。

# .net - 确定应用程序是否在 azure 中运行

> ID：873901
> 
> 赞同：18
> 
> 时间：2009-05-17T04:29:38.620
> 
> 标签：.net, azure

我有一个 asp.net mvc 应用程序，它被构建为在 iis 或云中作为标准 web 应用程序运行。

我需要能够确定应用程序是否托管在 azure（开发结构或云）中，或者它是否在 iis 下作为标准 Web 应用程序运行。

如何判断它是否在云中运行？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-17T04:42:21.197

想我找到了：

```
Microsoft.WindowsAzure.ServiceRuntime.RoleEnvironment.IsAvailable 
```

谢谢

@Wheat：感谢您的快速响应，使 stackoverflow.com 成为一个很好的资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T04:35:32.413

你可以使用这个`StorageAccountInfo`类吗？：

在您的`StorageAccountInfo`对象中，属性“ `usePathStyleUris`”是`false`指指向云存储和`true`指向本地开发存储的时间。

# windows-mobile - 如何在 Windows Mobile CDMA 手机上获取手机信号塔信息

> ID：873902
> 
> 赞同：7
> 
> 时间：2009-05-17T04:30:20.163
> 
> 标签：windows-mobile

工具/环境：C++、VS2008、WM6.1

我目前只有 HTC Diamond Windows Mobile 可供测试和尝试，以我所有的黑客能力，我仍然无法完成获取 Cell ID 和 LAC 的剩余详细信息的任务，以完成我的基于蜂窝位置的程序.

我设法获得了**MCC**和**MNC**，但 Cell ID 和 LAC 号码仍然对我隐藏。***一定***有办法得到这些，因为手机本身无疑会将它们用于其他用途。 **：/**

重申我已经尝试过的内容，如下所示：

```
RIL_GetCellTowerInfo (g_hRIL);  // doesn't even signal the 'ResultCallback' function.

RIL_GetCurrentOperator (g_hRIL, RIL_OPFORMAT_NUM);  // calls the 'ResultCallback' function and only with this am I able to at least get the MCC and MNC. 
```

也尝试了以下测试代码，但没有任何效果。

```
//constants and structures for cell ID
#define RIL_DEVSPECIFICPARAM_ENABLECELLIDSUPPORT 26
#define RIL_DEVSPECIFICPARAM_DISABLECELLIDSUPPORT 27

bool mode = true;
DWORD dwFuncID=0;

if (mode)
  dwFuncID = RIL_DEVSPECIFICPARAM_ENABLECELLIDSUPPORT;
else
  dwFuncID = RIL_DEVSPECIFICPARAM_DISABLECELLIDSUPPORT;

m_hrCellIdRequest_ = RIL_DevSpecific (g_hRIL,(LPBYTE) &dwFuncID, sizeof(DWORD));

//  no 'ResultCallback' triggered either.

BYTE req[4]= {24, 0, 0, 0};
m_hrCellIdRequest_ = RIL_DevSpecific (g_hRIL, req, 4);
req[0]=26;
m_hrCellIdRequest_ = RIL_DevSpecific (g_hRIL, req, 4); 
```

我什至尝试发送串行 AT 命令来取回一些东西。例如。 `"AT+CCED=0\r"` 我只得到'4\r'的失败结果。

我读过最后一个选择是读取它的内部存储器。但这似乎不是适用于其他手机的通用方法。此外，我什至不知道从哪里开始。

所以我终于崩溃了，向这个神话般的社区寻求帮助，如果你以某种方式设法从这部手机中获取了这些信息，你能和我们分享一下吗？

或者如果不可能得到，你能详细解释为什么会这样吗？

我只想一劳永逸地关闭它。 **:)**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T03:55:12.587

因此，经过更多的挖掘和顽固的“谷歌搜索”，原来的 RIL_* 代码在我的手机上不起作用的原因似乎是我使用的是CDMA *(UMTS)*网络，而***不是****GSM*网络。

据我所知， **GSM 网络**为手机提供了 MCC、MNC、Cell ID 和 LAC 的值。

另一方面，CDMA 网络提供了一组不同的数字，它们是BID **、**[**NID 和 SID**](http://www.mail-archive.com/gears-users@googlegroups.com/msg00155.html)。

例如[**CID -> BID, LAC -> NID, MNC -> SID, MCC -> MCC**](http://code.google.com/p/gears/wiki/GeolocationAPI)

上面的 RIL_* 接口代码很受欢迎，因为世界上的 GSM 电话/网络比 CDMA 多（主要是北美）。

现在手头没有真正的 GSM 手机，我无法真正测试我拥有的 RIL_* 接口代码。WM6.1 SDK Cell Emulator 工具很简洁，但不足以用来发布产品。

这让我再次**向移动蜂窝专家寻求有关从我的 HTC Diamond 手机**中检索 BID、NID 和 SID 值的方法的任何帮助，希望它们确实可以转换为 Cell ID 和 LAC。

我手机上的谷歌手机地图以某种方式设法完成了这一奇观。我只能猜测他们一定是在 CDMA 网络上找到了获取手机信号塔信息的方法。

任何帮助表示赞赏。 **:)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T20:51:55.550

看起来 Google 确实使用您的移动 IP 进行定位，并且不支持 CDMA： [来源](http://groups.google.com/group/gears-users/browse_thread/thread/d5a6acfadd12480a)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T20:04:15.447

在这里查看第一个答案（我刚刚在 HTC Touch Diamond 上尝试过，效果很好）： [msdn 讨论板](http://social.msdn.microsoft.com/Forums/en-US/vssmartdevicesnative/thread/13c11146-8bda-40d3-bc07-a09b938639f2)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T15:43:42.003

将您的 CDMA 手机换成 GSM 版本 :)

# javascript - 如何为数组类创建方法？

> ID：873904
> 
> 赞同：0
> 
> 时间：2009-05-17T04:31:13.360
> 
> 标签：javascript, arrays, oop, object, methods

抱歉，我知道这是编程 101，但我找不到任何好的文档...

我有一个数组，我想将每个成员转换为一个对象，然后通过分配的名称调用它们（如果 javascript 允许非数字索引值，这将简单得多）。例如：

```
 var things = ['chair', 'tv', 'bed'];
 var costs = ['10', '100', '75'];

 for (var i = 0; i < things.length; i++) {
      thing.name = things[i];
      thing.cost = costs[i];
 }

 alert(thing.name('tv').cost); 
```

显然这不是这样做的方法，但预期的结果将是一个显示“100”的警报。

我已经创建了一个类，该类具有一个名为 name 的方法，该方法指向主对象，如下所示：

```
function thing(name, cost) {
         function name(thename) {
              return this;
         }
this.thingname = name;
this.name = name;
this.cost = cost;
} 
```

但这仍然要求每个对象都有一个唯一的变量名，这与整点背道而驰。我想要的是简单地将我的所有数组放入某个通用类中，并通过名称调用我需要的值。

我知道这可能很容易在这里问，但我被卡住了！

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T04:43:52.690

为什么不使用对象？

```
var things = {
  chair: 10,
  tv: 100,
  bed: 75
};
alert(things.chair); // 10
alert(things['tv']); // 100 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T04:44:33.920

```
var stuff = {
    chair: 10,
    tv: 100,
    bed: 75
};
alert(stuff.chair); // alerts '10'
alert(stuff['chair']); // alerts '10'

stuff.house = 100000;
stuff['car'] = 10000;
alert(stuff['house']); // you get the picture...
alert(stuff.car); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T04:44:52.623

只使用字典对象怎么样：

```
var things = {'chair':10, 'tv':100, 'bed':75};
alert(things['chair'])

// if you want to use things['chair'].cost, it'd look more like this:
var things = {'chair': {cost: 10}, 'tv': {cost: 100}, 'bed': {cost: 75}}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T04:46:15.867

使用为什么不将您的数组定义为像这样的对象

```
var things = {'chair':10, 'tv':100, 'bed':75} 
```

然后您可以访问价格，例如关联数组的属性

```
things.chair 
```

会给你10

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T05:00:09.217

你为什么不试试 JSON：

像

```
var myArray= {"things": [
                    {"name":"chair","price":"10"},
                    {"name":"tv","price":"100"},
                    {"name":"bed","price":"75"}
             ]};

//now you can use it like this
for(var i=0; i< myArray.things.length; i++)
{
    alert(myArray.things[i].name + " costs " + myArray.things[i].price);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T09:11:59.503

如果您需要使用原始数据格式执行此操作（因为您对其没有影响），请使用以下命令：

```
var things = ['chair', 'tv', 'bed'];
var costs = ['10', '100', '75'];

var associatedThings;

for(i=0,x=things.length;i<x;i++){
    associatedThings[things[i]] = {cost: costs[i]};
}

alert(associatedThings['tv'].cost); 
```

# debugging - 为什么获取使用 Moq 创建的模拟实例会引发 System.BadImageFormatException？

> ID：873913
> 
> 赞同：5
> 
> 时间：2009-05-17T04:38:53.153
> 
> 标签：debugging, moq, reflection.emit, castle-dynamicproxy

这个问题可能与[另一个](https://stackoverflow.com/questions/305345/moq-multi-interface-question)问题有关，它肯定会导致 System.BadImageFormatException。也许它是同一件事，但暴露方式不同？

我有以下代码：

```
public interface IFoo<T> where T : class, new() {
  T FooMethod(object o);
}

public interface IFooRepo {
  F GetFoo<T, F>() where T : class, new() where F : IFoo<T>;
} 
```

然后我有一个使用 Moq 模拟 IFooRepo 的测试，如下所示：

```
var instance = new Mock<IFooRepo>().Object; 
```

上面的代码运行良好，除非在使用 Visual Studio 2008 调试测试时。当我越过上面的行时，System.BadImageFormatException 会通过 Castle.DynamicProxy 从 System.Reflection.Emit 抛出。这可能类似于[Ayende](http://groups.google.com/group/RhinoMocks/msg/500daa19f20c9748) Rahien 发布的内容吗？

现在的解决方法是为 IFooRepo 实现一个假的，但我很好奇为什么会为这种场景生成一个糟糕的图像并且有解决办法吗？System.Reflection.Emit 有问题吗？还是我在自己的代码中遗漏了一些明显的东西？

**编辑**：为 GetFoo() 发布了不正确的签名。将签名更正为 GetFoo<T, F>()，从而正确重现了问题。安装 GDR 后，此问题仍然存在。

**编辑**：似乎如果对 F 的约束包括类型参数 T BadImageFormatException 就会引发。但是我将其更改为，例如`where F : class, new()`，然后一切都按预期工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-20T17:10:51.350

FWIW，我同意 Ayende 的帖子解释了这种行为，并且仅当一个通用参数的约束引用另一个通用参数时才会发生这种情况。我在 GDR 中也遇到过这种情况，并且采用了与手工编码假货相同的解决方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T08:37:16.887

您是否[安装了 .NET 3.5 SP1 GDR](http://www.hanselman.com/blog/NET35SP1GDRIsAvailableToDownload.aspx)？[这是一个已知问题](http://www.ayende.com/Blog/archive/2008/08/13/How-.Net-3.5-SP1-broke-Rhino-Mocks.aspx)

# sql - 无法连接到 SQL Server 2005

> ID：873924
> 
> 赞同：2
> 
> 时间：2009-05-17T04:48:21.773
> 
> 标签：sql, sql-server, database, connection

我已经在我的机器上安装了 SQL Server 2005，现在我正试图通过 SQuirrel SQL 连接到它，但不幸的是我遇到了问题。

在安装 SQL Server 2005 时，我选择了混合模式进行身份验证，并设置了一个新的用户帐户，我正在尝试使用该帐户进行连接。我还安装了 Microsoft SQL Server JDBC 驱动程序，并且之前我已经成功使用 SQuirrel SQL 连接到远程服务器。

目前我正在尝试通过指定连接到我的数据库

```
jdbc:sqlserver://localhost:1433 
```

URL 并选择 Microsoft SQL Server JDBC Driver。

输入我的用户名和密码后，我收到以下错误：

> 测试：与主机的 TCP/IP 连接失败。java.net.ConnectException：连接被拒绝：连接

使用以下堆栈跟踪：

```
com.microsoft.sqlserver.jdbc.SQLServerException: The TCP/IP connection to the host  has failed. java.net.ConnectException: Connection refused: connect
    at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDriverError(Unknown Source)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.connect(Unknown Source)
    at com.microsoft.sqlserver.jdbc.SQLServerDriver.connect(Unknown Source)
    at net.sourceforge.squirrel_sql.fw.sql.SQLDriverManager.getConnection(SQLDriverManager.java:133)
    at net.sourceforge.squirrel_sql.client.mainframe.action.OpenConnectionCommand.execute(OpenConnectionCommand.java:97)
    at net.sourceforge.squirrel_sql.client.mainframe.action.ConnectToAliasCommand$SheetHandler.run(ConnectToAliasCommand.java:279)
    at net.sourceforge.squirrel_sql.fw.util.TaskExecuter.run(TaskExecuter.java:82)
    at java.lang.Thread.run(Unknown Source) 
```

最后一件事，我已检查以确保在 SQL Server 配置管理器中启用了 TCP/IP 连接和命名管道。

如果有人对我的问题有任何想法，我将非常感激听到他们的声音。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T08:03:17.467

所以在做了更多的研究之后，事实证明我的 sql server 没有监听正确的端口。对于其他遇到此问题的人，我建议阅读以下非常有用的网页：

[http://www.databasejournal.com/features/mssql/article.php/3689846/Using-Non-Standard-Port-for-SQL-Server.htm](http://www.databasejournal.com/features/mssql/article.php/3689846/Using-Non-Standard-Port-for-SQL-Server.htm)

基本上，您需要将服务器配置为始终侦听某个端口（我选择 1433）并重新启动服务器。之后它应该像一个魅力一样工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T05:05:44.227

从以下位置运行表面积配置工具：

开始 > 所有程序 > Microsoft SQL Server 2005 > Contifuration Tools > Sql Server 外围应用配置

单击**服务和连接的表面区域配置**链接。

在下一个窗口中，单击要配置的服务器下的**远程连接项。**现在在右侧选择*“本地和远程连接”*，然后选择*“同时使用 TCP/IP 和命名管道”*。

希望这能解决您的问题。

[编辑：您可以在microsoft](http://support.microsoft.com/kb/914277)查看这些文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-07T15:00:21.490

我在带有 SQL 2005 的 Windows 2008 R2 机器上遇到了同样的问题，最终我需要在 Windows 防火墙中打开端口 1433。我还检查以确保启用了远程连接。

# math - 任何人都可以解释对立面吗

> ID：873927
> 
> 赞同：0
> 
> 时间：2009-05-17T04:56:16.077
> 
> 标签：math, logic, discrete-mathematics, truthtable

我正在尝试为以下语句构造一个反例：**如果 A 为 0 或 B 为 0，则 A*B 为 0。**

这是我的尝试：**如果 A*B 不是 0，那么 A 不是 0 或 B 不是 0。**

原始陈述是正确的，但是相反的陈述是错误的，因为 A**和**B 都必须非零才能使 A*B 非零......我做错了什么吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-17T05:01:56.610

是的。

“如果 P 那么 Q”的对立面是“如果不是 Q，那么不是 P”。

所以“如果 A 为 0 或 B 为 0，则 A `*`B 为 0”的反义词是“如果 A `*`B 不为 0，则不是（A 为 0 或 B 为 0）”。

而“not(A is 0 or B is 0)”就是“A is not 0 **and** B is not 0”，所以对立应该是“If A `*`B is not 0, then A is not 0 and B is not 0” . 正是你所期望的:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T05:02:15.500

您需要将主要的“或”更改为和。见[http://en.wikipedia.org/wiki/De_Morgan%27s_laws](http://en.wikipedia.org/wiki/De_Morgan%27s_laws)

所以：如果 A*B 不为 0，则 A 不为 0，B 不为 0。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T05:01:18.403

是的，你做错了什么。非（A 或 B）= 非（A）*和*非（B）。在分配“非”时，您忽略了将“或”更改为“和”。（[德摩根](http://en.wikipedia.org/wiki/De_Morgan%27s_laws)）

# java - JSF h:commandButton 的问题

> ID：873941
> 
> 赞同：0
> 
> 时间：2009-05-17T05:07:34.100
> 
> 标签：java, jsp, jsf, jsp-tags

我真的需要这方面的帮助。

我在 jsp 文件中有一个简单的登录表单，我尝试使用 JSF 和托管 bean。当我第一次触发页面时，它正在显示它的内容，但是当按下提交按钮（h：commandButton）时，我收到一个错误。

有人可以告诉我我的代码有什么问题吗？

错误：

```
javax.servlet.ServletException: javax.faces.FacesException: Expression Error: Named Object: Login not found.
    javax.faces.webapp.FacesServlet.service(FacesServlet.java:256) 
```

这是我的 JSP：

```
<%@page contentType="text/html"%>
<%@page pageEncoding="UTF-8"%>

<%@taglib prefix="f" uri="http://java.sun.com/jsf/core"%>
<%@taglib prefix="h" uri="http://java.sun.com/jsf/html"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<f:view>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>JSP Page</title>
    </head>
    <body>
        <h:form id="login">
            <h:messages tooltip="true" />
            <h:inputText id="userNaME" required="true" requiredMessage="User name is required" value="#{Login.userName}" >
                <f:validator validatorId="Login" />
            </h:inputText><br />
            <h:inputSecret id="userPassword" required="true" value="#{Login.userPassword}" requiredMessage="User Password is required" /><br />
            <h:commandButton id="Login" title="Login" type="submit" action="#{Login.LoginUser}" />
            <h:message for="Login" style="color: green;" />
        </h:form>
    </body>
</html>
</f:view> 
```

我的豆类：

```
package myvalidators;

public class Login {
    private String _userName;
    private String _userPassword;

    public void setUserName(String userName)
    {
        this._userName = userName;
    }

    public String getUserName()
    {
        return this._userName;
    }

    public void setUserPassword(String userPassword)
    {
        this._userPassword = userPassword;
    }

    public String getUserPassword()
    {
        return this._userPassword;
    }

    public String LoginUser()
    {
        return this._userName;
        //going to perform a login here
    }
 } 
```

还有我的 faces-config xml

```
<managed-bean>
        <managed-bean-name>Login</managed-bean-name>
        <managed-bean-class>myvalidators.Login</managed-bean-class>
        <managed-bean-scope>request</managed-bean-scope>
    </managed-bean> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T17:43:35.923

这大概就是问题所在：

```
<f:validator validatorId="Login" /> 
```

移除标签。

*[validatorId](http://java.sun.com/javaee/5/docs/tutorial/doc/bnaxd.html)*属性值必须对应于*faces-config.xml*中注册的[Validator](http://java.sun.com/javaee/5/docs/api/javax/faces/validator/Validator.html)的*validator-id*元素。

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T16:30:16.613

我对请求的 bean 不太了解。您是否尝试为会话 bean 更改它？我的猜测是这些 bean 需要一些您的代码缺少的初始化。

# asp.net - ASP.NET 在文本框中显示列表框中的选定项

> ID：873944
> 
> 赞同：4
> 
> 时间：2009-05-17T05:12:21.293
> 
> 标签：asp.net, visual-studio, textbox, listbox, loops

我正在尝试将列表框中的所有选定项目显示到文本框中。目前我正在执行以下操作但没有成功：

```
For i As Integer = 0 To lb_words.ListCount
    If lb_words.Selected(i) = True Then
        tb_text.Text &= " Presto"
    End If
Next 
```

应该发生的是，对于我的列表框（lb.words）中的每个选定项目，我希望它被附加到我的文本框中。假设我的列表框包含 Apple、Orange 和 Banana，我选择 Apple 和 Banana，我的文本框文本应为“Apple Banana”...

我刚刚向自己介绍了 ASP.NET，所以请保持简单 :D 谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T05:17:29.410

试试这个：

```
Dim s as String = ""

For each x as ListItem in lb_words.Items
     if x.Selected Then s &= x.Text & " "
Next 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-10-20T03:45:19.487

```
 foreach (ListItem Mail in ListBox1.Items)
        {
            if (Mail.Selected)
            {
                Mail.Selected = true+",";
                mail.To.Add(Mail.ToString());                                   
            } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T05:23:52.780

页面：

```
 <asp:ListBox ID="myList" runat="server" SelectionMode="Multiple">
        <asp:ListItem>Apple</asp:ListItem>
        <asp:ListItem>Orange</asp:ListItem>
        <asp:ListItem>Grapes</asp:ListItem>
   </asp:ListBox>
   <br/>
   <asp:TextBox id="myText" runat="server"></asp:TextBox> 
```

代码隐藏 (C#)

```
 StringBuilder sb=new StringBuilder();
        for (int i = 0; i < myList.Items.Count; i++)
            sb.Append(myList.Items[i].Selected ? myList.Items[i].Text + " " : "");
 myText.Text=sb.ToString(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-13T15:52:08.933

如果您使用的是数据绑定列表框，请使用按钮单击事件尝试此代码：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    For Each objDataRowView As DataRowView In Me.ListBox1.SelectedItems
        Me.TextBox1.Text &= (objDataRowView("ITEM LIST").ToString() & " ; ")
        'here "ITEM LIST" is the "column name" which is used as DATASOURCE for LISTBOX1
    Next
End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T05:17:43.730

一种解决方案是覆盖 .ToString() 方法以连接列表中的所有值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T06:52:57.917

您可以使用 lb_words.SelectedItems 而不是遍历所有记录并在其中查找所选项目。您可以使用以下代码：

```
 Dim s As New StringBuilder()

        For Each item As Object In Me.lb_words.SelectedItems
            s.Append(item)
            s.Append(" ")
        Next

        Me.TextBox1.Text = s.ToString() 
```

如果您选择 Apple & Banana，您的文本框将包含“Apple Banana”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-12T17:30:25.227

```
 protected void Button1_Click(object sender, EventArgs e)
{
    //to display multiple items
    String it =" ";
    foreach (ListItem item in listbox.Items)
    {
        if (item.Selected)
        {
            it = it + ", " + item.Text;
        }
        Label1.Text = it;
    }

} 
```

# python - Google App Engine：生产与开发设置

> ID：873949
> 
> 赞同：8
> 
> 时间：2009-05-17T05:16:37.650
> 
> 标签：python, google-app-engine

如何设置设置文件？一个用于您的本地开发服务器，另一组用于上传到 Google App Engine 时的设置值？

例如，我想设置一个存储绝对根 URL 的设置文件。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-17T12:11:06.047

如果您询问的是 Java 还是 Python 运行时，您的问题并不清楚。我现在假设使用 Python。

就像任何其他 Python webapp 一样，设置文件可以在任何地方和任何你想要的地方。我通常在我的应用程序的根目录中使用一个名为“settings.py”或“config.py”的 .py 文件。例如，请参阅[博客的设置文件](http://github.com/Arachnid/bloog/blob/241fc977d310a77833eb9c61362aaa3ff4e10fe6/config.py)。

就生产和开发的不同设置而言，您有两种选择：

1.  只需在源代码存储库中保留两个分支，一个用于 dev，一个用于 prod，并在您想要发布时定期从 dev 合并到 prod。在这种情况下，您只是不合并 config.py。
2.  自动检测您在哪个平台上运行，并根据需要应用设置。最简单的方法是检查 os.environ['SERVER_SOFTWARE'] 的值，如果它是开发服务器，它将以 'Dev' 开头。您可以使用它来设置一个标志，如下所示：

    DEBUG = os.environ['SERVER_SOFTWARE'].startswith('Dev')

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-10T15:22:31.560

您可以[从请求中找到根 URL](https://stackoverflow.com/questions/1015442/how-to-get-the-current-server-url-of-appengine-app)，并使用它而不是手动配置它。或者，如果您需要进一步配置，则使用它来决定使用哪个配置。

# ms-access - 以编程方式搜索基于文本框条目的访问列表框控件的项目

> ID：873954
> 
> 赞同：0
> 
> 时间：2009-05-17T05:19:55.987
> 
> 标签：ms-access, textbox, listbox, equals

我不知道这是否可能，但我正在尝试编写一个 Access 文本框，该文本框将充当数据库的搜索引擎条目控件。具体来说，我想在表单中添加多个不可见的列表框，并用表格或查询数据填充它们。当最终用户在文本框中输入搜索词并按下搜索时，我想编写一系列“if”语句来指定文本框中的条目是否与其中一个列表框中的值匹配，以执行自定义询问。例如：

if (Me.textbox.text = 列表框中的一个值) then etc ...

问题是到目前为止我看到的每个示例都只通过数字或索引搜索列表框值，例如 listbox.selected(0)。由于文本框采用字符串值，而不是数值，因此代码必须将文本框条目等同于列表框中的项目。我已经能够在搜索文本框中添加一个数字并以这种方式找到列表框项，但这是不切实际的，因为我的最终用户只会知道值。总之，我想知道是否有人知道如何以编程方式在列表框中搜索与文本框中输入的值相等的特定值。

谢谢，

DFM

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T14:35:32.673

有几种方法可以做到这一点，例如：

```
Function CheckForItem(strItem, ListB As ListBox) As Boolean
Dim rs As DAO.Recordset
Dim db As Database
Dim tdf As TableDef

  Set db = CurrentDb

  CheckForItem = False

  Select Case ListB.RowSourceType
      Case "Value List"
          CheckForItem = InStr(ListB.RowSource, strItem) > 0

      Case "Table/Query"
          Set rs = db.OpenRecordset(ListB.RowSource)

          For i = 0 To rs.Fields.Count - 1
              strList = strList & " & "","" & " & rs.Fields(i).Name
          Next

          rs.FindFirst "Instr(" & Mid(strList, 10) & ",'" & strItem & "')>0"

          If Not rs.EOF Then CheckForItem = True

      Case "Field List"

          Set tdf = db.TableDefs(ListB.RowSource)

          For Each itm In tdf.Fields
              If itm.Name = strItem Then CheckForItem = True
          Next

  End Select

End Function 
```

来自：[http ://wiki.lessthandot.com/index.php/Listbox:_Does_an_Item_Exist](http://wiki.lessthandot.com/index.php/Listbox:_Does_an_Item_Exist)

但是，我怀疑您可能从错误的方向处理问题，多个隐藏控件很少是一个好主意，最好更全面地解释您的需求。

**编辑重新评论**

这个例子并不快，但很容易。

```
Sub SearchTables(strFind As String)
''Reference: Microsoft DAO x.x Object Library
Dim db As Database
Dim tdf As TableDef
Dim fld As DAO.Field
Dim rs As DAO.Recordset
Dim strSQL As String
Dim strMessage As String

Set db = CurrentDb

For Each tdf In db.TableDefs

    strFieldList = ""

    For Each fld In tdf.Fields
        strFieldList = strFieldList & " & [" & fld.Name & "]"
    Next

    strSQL = "SELECT * FROM [" & tdf.Name & "] " _
    & "WHERE Instr(" & Mid(strFieldList, 4) & ",'" & strFind & "') > 0"

    Set rs = CurrentDb.OpenRecordset(strSQL)

    If Not rs.EOF Then
        rs.MoveLast '' Populate recordset, a little slower
        strMessage = strMessage & vbCrLf & tdf.Name & " : " & rs.RecordCount
    End If
Next

MsgBox "Found in - " & vbCrLf & IIf(strMessage = vbNullString, "None", strMessage)
End Sub 
```

# java - getResourceAsStream 不适用于每个班级？

> ID：873960
> 
> 赞同：6
> 
> 时间：2009-05-17T05:27:35.050
> 
> 标签：java, jar

我有一个使用一些 txt 文件的 jar 文件。为了得到它们，它使用`Class.getResourceAsStream`函数。

```
Class A
{
    public InputStream getInputStream(String path) throws Exception {
        try {
            return new FileInputStream(path);
        } catch (FileNotFoundException ex) {
            InputStream inputStream = getClass().getResourceAsStream(path);
            if (inputStream == null)
                throw new Exception("Failed to get input stream for file " + path);
            return inputStream;
        }
    }
} 
```

这段代码运行良好。

问题是，如果我将 A 类定义为`extends java.io.File`，我得到的 InputStream`getResourceAsStream`为空。

另外，如果我将 A 类保留为常规类（未继承），并将 B 类定义为：

```
Class B extends java.io.File
{
    public InputStream getInputStream(String path) throws Exception
    {
     return new A().getInputStream(path);
 }
} 
```

返回的 InputStream 仍然为空。

问题是什么？有没有办法从继承的类访问文件`File`？

谢谢，

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-17T07:20:11.783

我怀疑这更多地与包有关，而不是继承。

如果您的类在一个包中，那么`getResourceAsStream()`将相对于该包，除非您以“/”开头（这使其成为“绝对”资源）。另一种方法是使用`getClass().getClassLoader().getResourceAsStream()`它不知道路径是相对于包的。

只是子类`File`化根本不应该影响行为。如果你真的相信它，请发布一个简短但完整的程序来演示这个问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-01-08T23:39:05.197

以下是支持 Jon Skeet 解释的一些示例：

前提：你有一个依赖于 foo.txt 的类 my.package.A。

1.  如果您使用 my.package.A.class.getResourceAsStream("foo.txt") 并将 foo.txt 放在 jar 文件中的 my/package/foo.txt 中，那么当您运行 A 类时，它应该会找到 foo.txt .

2.  如果您使用 my.package.A.class.getClassLoader().getResourceAsStream("foo.txt") 然后将 foo.txt 放在类路径上的任何文件夹中，当您运行 A 类时，它应该会找到 foo.txt。

3.  如果您使用 my.package.A.class.getResourceAsStream("/foo.txt") 并将 foo.txt 放在我的 jar 文件中的 /foo.txt 中，那么当您运行项目 A 时，它应该会找到 foo.txt。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T10:22:40.597

恕我直言，使用它仍然更好，`getClass().getClassLoader().getResourceAsStream()`因为如果您子类（并且子类在另一个包中）并调用父方法，上述代码可能会失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T08:26:14.963

抱歉，问题不一样。（其实没问题……）

在继承自我`java.io.File`用来`getPath()`获取资源路径的类中。但是路径有反斜杠而不是常规斜杠（因为我在 Windows 操作系统上工作）。当我使用正斜杠时，即使使用继承的类也能正常工作。

# python - Python Django：使用 Google App Engine 处理 URL - 发布然后获取

> ID：873966
> 
> 赞同：0
> 
> 时间：2009-05-17T05:32:11.090
> 
> 标签：python, google-app-engine

我有这样的设置：

```
class CategoryPage (webapp.RequestHandler):
def get(self):
    ** DO SOMETHING HERE **
def post(self):
    ** DO SOMETHING HERE **
    ** RENDER THE SAME AS get(self) 
```

问题是，在处理完发布的数据后，如何才能显示与 get(self) 函数相同的信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T22:07:59.987

正如其他人所建议的那样，重定向确实有一些优势，但它是一种“沉重”的方法。作为替代方案，考虑将渲染部分重构为一个单独的辅助方法`def _Render(self):`，`get`并`post`通过调用`self.Render()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T09:28:36.327

调用 self.redirect(url) 通过 GET 将用户重定向回同一页面。这样，如果他们点击刷新，他们就不会意外地重新提交表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T05:48:58.117

```
create_object(request, form_class=FormClass,
        post_save_redirect=reverse('-get-url-handler-',
                                   kwargs=dict(key='%(key)s'))) 
```

我从通用视图中使用上述 django 快捷方式，您可以在其中指定保存后重定向，获取您的情况。此代码段中还有几个示例。顺便说一句，根据问题的标题，我假设您正在使用带有 app engine 的 django （帮助程序或补丁）。如果您使用的是应用程序引擎补丁，请查看“myapp”应用程序示例 add_person 处理程序中的 views.py 是否符合您的要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T05:56:44.840

这通常不是一个好主意，因为它会引起混乱。你真的应该做任何你想做的事，然后将它们重定向到 get 方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T09:20:02.493

实际上，您的代码不是 Django，而是 webapp（Google 的迷你“框架”）。请阅读 Django 文档：[http ://docs.djangoproject.com/](http://docs.djangoproject.com/)

Django 的通用视图仅适用于 app-engine-patch。助手不支持他们。您可以查看 app-engine-patch 示例项目以了解有关 App Engine 上 Django 的更多信息：[http ://code.google.com/p/app-engine-patch/](http://code.google.com/p/app-engine-patch/)

# linux - 如何在 Linux 上捕获原始 HID 输入？

> ID：873975
> 
> 赞同：39
> 
> 时间：2009-05-17T05:46:20.357
> 
> 标签：linux, hid, hid-device

**我想要完成的简短版本**：我有一个作为通用 HID 设备实现的脚踏板（INFINITY-IN-USB-1，如果有兴趣的话），我希望它的行为`Ctrl`和`Alt`按键一样Linux。我正在寻找 X 级别的东西，即不仅仅是单个程序。

**更长的版本：我通过调用 DLL 函数***RegisterRawInputDevices*和*GetRawInputData*并在隐藏窗口中侦听输入，使此设置在 Windows XP 中工作。这一切都是通过一个相当简单的[AutoHotkey](http://autohotkey.com)脚本完成的（如果有人感兴趣，我可以在这里发布）。关键是，不需要任何额外的驱动程序等；只需要本机 Windows DLL 文件。

我希望这个设置可以在 Linux 上运行（更具体地说是 Ubuntu 下的[GNOME](https://en.wikipedia.org/wiki/GNOME)，但我偶尔会使用其他发行版/窗口管理器，因此感谢 X 级别的解决方案）。此脚踏板不会将自己注册为键盘甚至操纵杆，而是使用 UsagePage 12，Usage 3 注册为 HID 设备。

我注意到最新的 Ubuntu 可以检测和使用[Microsoft Natural Keyboard](https://en.wikipedia.org/wiki/Microsoft_Natural_Keyboard)上最喜欢的键，这些键也注册为 HID 设备*。我使用与使用脚踏板相同的方法在 Windows 上使用这些键（即，没有捆绑软件）。所以我假设这个踏板也可以在 Linux 上运行，但问题是如何？

（我对 Linux 上的低级内容不熟悉，所以请在适用时提供介绍或教程的链接。）

[* 对于不知情的人，Microsoft Natural Keyboard 注册为常规键盘和通用 HID 设备。如果某些应用程序（例如捆绑应用程序）不知道如何解释 HID 输入，则常规键将起作用，但收藏夹键和特殊功能键无用。]

* * *

澄清一下，Linux*没有*将踏板按下视为输入。它确实可以识别 USB 设备，但[xev](https://linux.die.net/man/1/xev)没有为踏板按下提供任何输出。我已经看到有人在[Wine](https://en.wikipedia.org/wiki/Wine_%28software%29)下成功使用踏板进行转录软件的报告，但这必须以 Windows 方式工作，并且不能提供我想要的（这使得踏板看起来像所有本地 Linux 应用程序的键盘）。是否需要一些低级 Linux 键盘驱动程序？

* * *

这里有一些更多信息：如果我在终端发出这个

```
cat /dev/usb/hiddev0 
```

（`dev/usb/hiddev0`是我的踏板），我得到与我的踏板压力相对应的原始代码。这是一个开始。我知道这些原始代码是什么意思：在二进制中，0001、0010、0100 分别对应于每个踏板，踏板按下的组合发送这些二进制数的组合，并释放仍然按下的任何踏板的踏板触发输入（如果全部踏板抬起，发送 0000）。

我怎样才能让 X 收听`dev/usb/hiddev0`原始代码并将其翻译成可能的特殊键码，以便我可以使用 xmodmap 或其他东西映射它们？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-11-24T18:47:42.007

你会想要`uinput`的。您将在 /dev/usb/hiddev0 上收听，然后创建您将发送的新事件`/dev/input/uinput`。

这对其进行了解释并提供了一个小教程： [在 Linux-2.6.x 中使用 uinput 驱动程序来发送用户输入](http://web.archive.org/web/20100407043556/http://www.einfochips.com/download/dash_jan_tip.pdf){*这是 EInfochips 的“仪表板”出版问题 2007 年 1 月“本月提示”文章在[此](http://web.archive.org/web/20100407043556/http://www.einfochips.com/newsletters/jan_07.html)存档页面*上提到}。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-08-28T02:59:53.243

我在我的博客上写了关于如何让我的 Infinity IN-USB-1（又名“VEC USB 脚踏板”）在 X 下发送任意键符的文章：

[Linux下使用VEC/Infinity USB脚踏板作为键盘](http://catswhisker.xyz/log/2018/8/27/use_vecinfinity_usb_foot_pedal_as_a_keyboard_under_linux/ "Linux下使用VEC/Infinity USB脚踏板作为键盘")

（它也应该适用于 IN-USB-2 以及 VEC 和 PI Engineering 及其克隆销售的其他一些 USB 脚踏控制器型号。）

这是较短的版本：

## 让 X 识别踏板

踏板是符合 HID 的 USB 设备，内核可以毫无问题地发现它并通过`/dev/input/eventX`节点将其事件提供给用户空间。要查看您是否可以运行该`evtest`程序（在 Debian 上：）`sudo apt install evtest`。因此，您*无需*进入 HID 级别即可使用脚踏板。

问题是 udev 没有将其标记为键盘或鼠标，因此 X 忽略了它。这可以通过单行 udev 规则文件修复（感谢[Parlatype开发人员 Gabor Karsay 在](https://gkarsay.github.io/parlatype/)[Parlatype Issue 28](https://github.com/gkarsay/parlatype/issues/28)中提供此解决方案）：

```
ACTION=="add|change", KERNEL=="event[0-9]*", ATTRS{idVendor}=="05f3", ATTRS{idProduct}=="00ff", ENV{ID_INPUT_KEYBOARD}="1" 
```

将该行放在一个名为`/etc/udev/rules.d/10-vec-usb-footpedal.rules`. 不需要重新启动任何东西，udev 应该会自动检测文件。

现在，当您拔下并重新插入 USB 踏板时，它应该被 X 识别（并发送鼠标按钮事件）。要验证，请运行`xev`.

## 使用 udev hwdb 重新映射键符

拥有只发送鼠标点击的踏板可能不是您想要的。踏板开关发送的这个键码可以用 udev hwdb 文件重新映射。

`/etc/udev/hwdb.d/`在（我把我的）下创建一个`/etc/udev/hwdb.d/60-usb-footpedal.hwdb`包含这些行的文件：/etc/udev/hwdb.d/60-usb-footpedal.hwdb

```
evdev:input:b*v05F3p00FF*
 KEYBOARD_KEY_90001=f14
 KEYBOARD_KEY_90002=f15
 KEYBOARD_KEY_90003=f16 
```

这次我们确实需要通知系统更新二进制 hwdb 文件：

```
$ sudo systemd-hwdb update 
```

然后拔下并重新插入设备。

hwdb 文件的第一行与我们的设备（供应商`05F3`、产品`00FF`）匹配，随后的行将扫描码（十六进制）映射到键码。[我选择了 F14、F15 和 F16 功能键，但在/usr/include/linux/input-event-codes.h](https://github.com/torvalds/linux/blob/master/include/uapi/linux/input-event-codes.h)中定义了可用键码列表；要使用该文件中的名称#defined 作为 hwdb 键码，只需将它们转换为小写并删除`key_`前缀。

我的计算机上的默认 (pc+us) xkb 键盘布局分别映射`F14`、`F15`和、和`F16`键符。如果您现在打开并踩下踏板，您应该会看到这些键符发出。使用这些键符，每个踏板开关都可以映射为桌面或窗口管理器中的热键。`XF86Launch5``XF86Launch6``XF86Launch7``xev`

您还可以`XF86*`使用 xmodmap 之类的东西将键符重新映射到其他键。有关更多详细信息，包括在 vim 中映射键、更多文档链接、指向直接读取 HID 设备的指针（如果需要）以及 Mac OS X 的解决方案，请参阅我的[博客文章](http://catswhisker.xyz/log/2018/8/27/use_vecinfinity_usb_foot_pedal_as_a_keyboard_under_linux/)

## 脚踏控制器

我要提到的最后一件事是一个名为[footcontroller](https://sourceforge.net/projects/footcontroller/)的 Python 程序，它从 evdev 设备 (/dev/input/eventX) 读取事件，并且可以配置为发出击键（通过 xdotool）或运行脚本以响应踩踏踏板。它可以用来代替 xmodmap 让您的踏板发送您想要的任何击键。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-11-06T00:52:06.667

如果设备出现在*/dev/input*中，请使用“evdev”X 驱动程序将其连接起来，就像使用键盘或鼠标一样。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T13:15:41.767

您应该调查[LIRC](https://en.wikipedia.org/wiki/LIRC)。它解释来自遥控器的输入。一些受支持的遥控器显然将自己呈现为通用 HID 设备，因此您可以让您的设备与 LIRC 对话。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-02T06:10:31.363

同样的问题，但在无线键盘上有特殊键。我感觉到你的痛苦。

无论如何，试图让它工作，这是我的方法：

1.  `sleep 10; killall cat`然后在另一个终端中快速：`cat /dev/usb/hiddevice0 > key1.usbdump`并按下/使用该设备。这将转储该密钥的 hiddevice 的二进制输出。
2.  我迅速编写了一个 Python 脚本来读取 hiddevice 输入和触发事件。到目前为止，它在第一次击键时起作用。这与 Adam 的建议类似，但我认为 uinput 更难编程/使用，尽管可能更优雅，而且 Python 很容易获得。

所以这是一项正在进行的工作（仅适用于第一次按下），但也许这样的事情可能对你有用：

```
sf1 = open("test.usbdump").read() # Read the earlier USB dump from hiddevice
kb = open("/dev/usb/hiddev0")
while 1:
    # Prints true if the specific key has been read.
    print (kb.read(len(sf1)) == sf1)
    # Basically all that has to be done is if ^ is true, then fire off the event you want. 
```

如果有人可以帮助我完成我的程序，或者我做错了，请告诉我。;)

我意识到 hiddevice 的初始转储中包含一些标头。使用一些 bless 十六进制编辑和位差分，您可以找到哪些值是重要的，并在 Python 中检查它们。（例如，十六进制数字“B0”表示在我的键盘上按下了一个特殊功能键，稍后会有更多关于按下哪个键的信息等）

我的最终结果是这样的：hiddevice0 似乎在一段时间后挂起并停止提供数据，不知道为什么，但是我使用 /dev/input/event* （它也可能对你有用），这似乎效果更好。再次，相同的十六进制编辑和低级解析导致成功。一路走来，我发现这`sudo cat /dev/input/event3 | hexdump`对于确定哪些字节对您很重要非常有帮助。

所以，如果你有一个[SK-8812 IBM 键盘](http://ibmfiles.com/pages/sk8812.htm)，并且想使用特殊的键，你可以和我交谈以获得我使用的脚本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T09:27:35.487

对于我的绑定/快捷方式，我使用[Compiz](https://en.wikipedia.org/wiki/Compiz)、easystroke 和 xmacro 的组合。

为了您的需要，我认为缺少的部分是 xbindkeys。我为您找到了这个链接，它可能会帮助您进行设置：

[http://linux-trackball.dreamhosters.com/](http://linux-trackball.dreamhosters.com/)

无论如何，我想知道是否有办法区分几种鼠标设备。

# c++ - 最快的 C/C++ 图像大小调整库

> ID：873976
> 
> 赞同：18
> 
> 时间：2009-05-17T05:46:29.497
> 
> 标签：c++, c, image, resize

我正在编写一个需要调整大量图像大小的应用程序......这些是我的要求：

*   C/C++
*   至少支持 jpeg/png
*   快速地
*   跨平台

到目前为止，我的选择是：

*   开放式CV
*   CImg
*   ImageMagick
*   GraphicsMagick（据说速度很快）
*   魔鬼
*   来自 Boost 的 GIL
*   图像
*   Imlib2（据说速度很快）
*   还有其他人吗？

所有这些都可以完成工作，但我在这里寻找**最快**的，我无法找到任何关于它们性能的基准。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-17T06:59:36.060

看看[Intel IPP（Integrated Performance Primitives）](http://en.wikipedia.org/wiki/Integrated_Performance_Primitives)（Wiki 链接比 Intel 更好……）它也适用于 AMD，并具有调整图像大小（双线性、最近邻等）的功能，并且适用于 Linux 和 Windows。

它不是免费的（但它不会破坏银行），但它是你能找到的最快的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-07-13T07:59:53.310

看看[贵宾](https://libvips.github.io/libvips/)。这是迄今为止我发现的最快的一个，并且可以免费用于商业用途。

[https://github.com/libvips/libvips/wiki/Speed-and-memory-use](https://github.com/libvips/libvips/wiki/Speed-and-memory-use)

On that benchmark, it's 2x faster than Pillow-SIMD, 5x faster than imagemagick, 6x faster than opencv, 8x faster than freeimage, etc. It has dramatically lower memory use too: more than 10x less than imagemagick, for example.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-17T13:55:43.783

@Chris Becke 的评论：

“想一想那句话。在一个（复杂的）步骤中做这件事的哪一部分会使它更快？图像解码例程仍然需要解码每个像素，以便过滤器例程过滤它们。 "

情况并非总是如此。例如，在解码 JPEG 时，您可以要求 JPEG 库为您提供 1/2、1/4、1/8 大小的图像（或类似的东西；我已经有一段时间没有详细看过了），它可以由于JPEG的工作方式，根本不需要解码额外的细节。它可以比完整的解码 + 缩放快得多。

（显然，如果较小的图像不是您想要的确切尺寸，您可能需要在之后进行缩放。）

（对不起，由于没有声誉，我只能将此回复作为评论发布。我第一次尝试在这里发布任何内容。如果有人想重新发布此或类似的评论并删除我的答案，请随意！）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-17T23:04:15.890

如果[IPP](http://software.intel.com/en-us/intel-ipp/)[满足您的需求](http://www.intel.com/cd/software/products/asmo-na/eng/405959.htm)（例如第 12 节中的 Resize 函数），那么我怀疑您会在其他任何地方找到明显更快的 x86 代码。请记住，在 AMD CPU 上运行时，它可能会退回到较慢的“参考实现”。

如果 CPU 不能满足您的性能要求，您可以考虑使用 OpenGL 将调整大小推送到 GPU（使用纹理映射的最简单实现将受益于硬件插值器，对于更复杂的过滤使用 GLSL 着色器代码）。GPU 做这种事情的能力比 CPU 快一百倍（给或取零）必须与相对较慢的数据传输进出卡（通常每秒千兆字节或两千兆字节）进行权衡至多，最多）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T13:12:52.590

如果您正在寻找开源，那么 FreeImage 怎么样？对于商业内容，我使用 Snowbound。两者都非常快，并且能够处理许多不同的图像格式和调整大小的算法。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-17T07:37:41.133

如果您正在寻找免费的东西，并且想快速完成操作，请尝试开发一个 Gimp C 编译插件：这很容易，我认为 Gimp 在调整大小方面做得很好：

这可能不是调整大小最快的，但最便宜（免费）和最快**的开发**。

看看[那里](http://developer.gimp.org/writing-a-plug-in/1/index.html)。

# c++ - C++ - 向客户端发送简单 HTML 的简单服务器

> ID：873978
> 
> 赞同：1
> 
> 时间：2009-05-17T05:47:54.143
> 
> 标签：c++, html, http, winsock2

现在，我只是在玩这个，我不确定为什么这不起作用。

```
#include <winsock2.h>
#include <ws2tcpip.h>
#include <iostream>
#include <cassert>

const char html[] = "HTTP/1.1 200 OK\r\n"
"Connection: close\r\n"
"Content-type: text/html\r\n"
"\r\n"
"<html>\r\n"
"<head>\r\n"
"<title>Hello, world!</title>\r\n"
"</head>\r\n"
"<body>\r\n"
"<h1>Hello, world!</h1>\r\n"
"</body>\r\n"
"</html>\r\n\r\n";

int main() {
    WSADATA wsa;

    assert( WSAStartup( MAKEWORD( 2, 2 ), &wsa ) == 0 );

    addrinfo *res = NULL;
    addrinfo hints;

    ZeroMemory( &hints, sizeof( hints ) );

    hints.ai_family = AF_INET;
    hints.ai_socktype = SOCK_STREAM;
    hints.ai_protocol = IPPROTO_TCP;
    hints.ai_flags = AI_PASSIVE;

    assert( getaddrinfo( NULL, "80", &hints, &res ) == 0 );

    SOCKET s = socket( res->ai_family, res->ai_socktype, res->ai_protocol );

    assert( s != INVALID_SOCKET );
    assert( bind( s, res->ai_addr, (int)res->ai_addrlen ) != SOCKET_ERROR );
    assert( listen( s, SOMAXCONN ) != SOCKET_ERROR );

    SOCKET client = accept( s, NULL, NULL );

    assert( client != INVALID_SOCKET );

    char buffer[512];
    int bytes;

    bytes = recv( client, buffer, 512, 0 );

    for ( int i = 0; i < bytes; ++i ) {
        std::cout << buffer[i];
    }

    assert( send( client, html, strlen( html ) - 1, 0 ) > 0 );
    assert( shutdown( client, SD_BOTH ) != SOCKET_ERROR );

    closesocket( client );
    WSACleanup();

    return 0;
} 
```

当我编译并运行它，然后在浏览器中导航到 127.0.0.1 时，我在控制台中得到了这个：

> 获取/HTTP/1.1
> 
> 主机：127.0.0.1
> 
> 连接：保持活动
> 
> 用户代理：Mozilla/5.0（Windows；U；Windows NT 5.1；en-US）AppleWebKit/530.5（K HTML，如 Gecko）Chrome/2.0.172.8 Safari/530.5
> 
> 缓存控制：max-age=0
> 
> 接受：application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png, */* ;q=0.5
> 
> 接受编码：gzip、deflate、bzip2、sdch
> 
> 接受语言：en-US,en;q=0.8
> 
> 接受字符集：ISO-8859-1,utf-8;q=0.7,*;q=0.3

**编辑**- 我已经更新了我发送的 HTML。我刚刚用 Mozilla Firefox 和 Google Chrome 测试了它，它可以在 Firefox 中运行，但不能在 Chrome 中运行！

**编辑 2** - 所以似乎它在 Firefox 上工作的原因，而不是 Chrome，是因为 Firefox 将 HTML 显示为收到的，而 Chrome 在进行任何渲染之前等待连接关闭。我添加了关闭套接字的代码并且它起作用了。我已经用工作源更新了我的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T05:56:45.150

您需要发回状态行：

HTTP/1.1 200 正常

在您的响应标头之前。

请参阅 Fiddler (www.fiddler2.com) 以更好地了解正确的 HTTP 响应是什么样的。

关于您以后的编辑，所有浏览器在开始渲染之前都会等待一定数量的数据；Chrome 的限制与 Firefox 的不同。如果您设置了 Content-Length 或使用了 HTTP Chunked 编码，您会看到正确的行为。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T06:03:15.667

看看 Mongoose [http://code.google.com/p/mongoose/](http://code.google.com/p/mongoose/) 它是一个自包含的库，它是一个多线程的 http web 服务器，并且有一个超级简单的 api（尚未完成）。几分钟之内，我就可以将它绑定到我已经存在的应用程序上。

我今天早些时候有同样的问题（给我的 C++ 应用程序一个 Web 端）[给 C++ 应用程序一个 HTTP Web 服务器功能](https://stackoverflow.com/questions/873615/giving-c-application-a-http-web-server-functionality)

# c++ - 如何保存帧缓冲区然后将其取回

> ID：873984
> 
> 赞同：0
> 
> 时间：2009-05-17T05:56:34.590
> 
> 标签：c++, opengl, graphics

嗨，我对openGL非常陌生，我正在尝试做一个像绘画工具这样的小项目..所以我只想将所有内容保存在帧缓冲区中以保存在文件中并取回它们。 .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T06:40:39.070

> 帧缓冲区中的所有内容？

如果您尝试在前/后缓冲区中捕获当前图像，glReadPixels（从帧缓冲区读取像素块）以及 glReadBuffer 可能是您正在寻找的。[请参阅 OpenGL 手册](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/readpixels.html)。这不一定是最快的方法，这取决于您可以与硬件一起使用的扩展，可能有更快的方法，但 glReadPixels 使用起来相当简单。glDrawPixels 将帮助您将数据返回到帧缓冲区。您可以将原始图像存储到磁盘或根据需要进行转换/压缩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T06:56:17.193

如果您希望将所有对象保存到文件中并重新加载它们，我认为您不应该使用 OpenGL 来执行此操作。将对象发送到 OpenGL 后，您通常不会再次修改它们。如果您正在编写某种应用程序来在屏幕上绘制许多对象，那么您自己跟踪对象是最简单的。

如果您正在寻找最终图像，您可以使用 glReadPixels - 获取原始像素数据，或 glCopyTexImage2D - 将屏幕上的内容保存到纹理中，以便在 OpenGL 中进一步使用。

# forms - 需要通过 PHP 和 Javascript 从一个表单克隆到另一个表单的文件输入元素

> ID：873987
> 
> 赞同：0
> 
> 时间：2009-05-17T05:59:03.990
> 
> 标签：forms, upload, clone, element, file-io

好的，我有一个通过 method="POST" 提交的模板函数。但我无法正常提交，因为这就是我想要提交的全部内容，并且代码上方和代码下方已经定义了一个标签，关闭表单必须保留在那里。由于无法在表单中包含表单，因此我使用 Javascript 创建表单并即时提交。但我需要获取 document.forms.creator 表单中定义的文件输入元素的副本。我正在使用 PHP 和 Javascript 来完成我现在所拥有的，但是 cloneNode(true) 没有获取 $_FILES['image'] 数组并将其设置为 $_FILES['sigImg'] 数组:(

```
echo '<tr><td colspan="2"><a href="#" name="sig' . $user_info['id'] . '"></a><center><b>Signature Image Rotator</b></center><br /><center>
Add Image: <input type="file" size="48" id="imagefile" name="image" />&nbsp;&nbsp;<input type="button" value="Upload" onclick="createFormAndSubmit()"></center>';

echo '
<script language="JavaScript" type="text/javascript"><!-- // --><![CDATA[
//helper function to create the form
function getNewSubmitForm(){
 var submitForm = document.createElement("FORM");
 document.body.appendChild(submitForm);
 submitForm.enctype = "multipart/form-data";
 submitForm.method = "POST";
 return submitForm;
}

//function that creates the form, clones <input type="file" name="image">,
//and then submits it
function createFormAndSubmit(){
 var submitForm = getNewSubmitForm();
 var element = document.getElementById("imagefile");
    element = element.cloneNode(true);
    element.id = \'sigImgId\'; //<- ID Assignment
    element.name = \'sigImg\'; //<- NAME Assignment
    submitForm.appendChild(element);
 submitForm.action= "', $scripturl, '?action=sigimages;sa=upload";
 submitForm.submit();
}
// ]]></script></td></tr>'; 
```

如何获得 php echo 中定义的文件输入的真正克隆并将其放入 createFormAndSubmit() 函数中定义的表单中？

请有人帮忙...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T14:34:59.840

另一个线程上的 Mark Allen 评论建议不要将新的克隆输入（IE 不提供选定的文件属性）附加到另一个表单，而是用新输入替换旧输入（看起来正确），然后你把旧的输入放在你的上传表单上。

所以你的代码会变成：

```
// clone up a new one
var oldFile = document.getElementById("imagefile");
var newFile = oldFile.cloneNode(true);

// set props
newFile.id = "sigImgId"; //<- ID Assignment
newFile.name = "sigImg"; //<- NAME Assignment

// replace old with new
oldFile.parentNode.replaceChild(newFile, oldFile);

// attach old to upload form
submitForm.appendChild(oldFile); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T05:31:27.853

好的，非常感谢克里斯，一定会记住这一点。刚刚想出了一个自己解决这个问题的方法，并且正在使用这个方法，它只是改变表单的操作并提交，唯一的问题是它提交表单中的所有内容，而不仅仅是 imagefile 对象。但我想这不是一个真正的问题，或者是吗？无论如何都可以使用此代码：

```
// change the action and submit the form...
function submitSigImg(){
 var mainForm = document.forms.creator;
 mainForm.action= "', $scripturl, '?action=sigimages;sa=upload";
 mainForm.submit();
} 
```

这只是改变了它已经存在的表单的操作，并且由于该功能仅在单击上传按钮并重定向回页面时使用，因此在正常提交表单时也不是问题。

再次感谢 ：）

# c# - C#提供C++回调，endthread()中_threadex.c中的访问冲突

> ID：873992
> 
> 赞同：1
> 
> 时间：2009-05-17T06:09:38.350
> 
> 标签：c#, delegates

我有一个将回调函数指针传递给 C++ dll 的 C# Windows 服务应用程序。我已经将 C# 端和 C++ 端的函数指针都定义为 __stdcall 类型。一切正常，直到回调由 C++ dll 触发并在 0x04cb0e 中引发未处理的异常访问冲突。调试在 C# 应用程序的 endthread 调用下的 threadex.c 中停止。

```
public delegate void NotificationFunc(int notifycode, IntPtr Userdata);

[DllImport("notice.dll")]
void INotify(NotificationFunc notefunc,IntPtr Userdata);//ignore the IntPtr Userdata
.
.
.
NotificationFunc notefunc = new NotificationFunc(Noticallback);
INotify(notefunc, Intptr.zero);

//notice.dll triggers this callback thru the delegate passed in
void Noticallback(int notifycode, IntPtr userdata)
{
Swtich(notifycode)
{
//my actions
}
.
.//Error Exceptions happens here when trying to end the thread/call
} 
```

我知道我必须处理清理此回调资源，因为它是单向调用事件。我已经尝试过 GC 和 GCHandle 来防止它成为 GC，但似乎总是存在内存泄漏或错误。有人可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T06:50:42.837

[维基百科](http://en.wikipedia.org/wiki/Platform_Invocation_Services)有一篇关于这个主题的相当不错的文章。如果我是你，我会使用 C++/CLI，因为它速度更快且绑定不那么强。这种 P/Invoke 将所有定义布置在各处，非常容易出错。如果你改变了，或者你的规范改变了，对于你的数据类型或类似的东西，C++/CLI 将自动更新，但不幸的是，任何显式的 P/Invoke 的声明，就像你在这里一样，总是必须重新-有线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T14:45:40.170

您必须防止委托被托管代码收集，使用`GCHandle.Alloc`：

```
 public delegate void NotificationFunc(int notifycode, IntPtr Userdata);

    [DllImport("notice.dll")]
    static extern void INotify(NotificationFunc notefunc,IntPtr Userdata); // Note IntPtr as the callback type

    NotificationFunc notefunc = new NotificationFunc(Noticallback);

    // Now, allocate a GCHandle to prevent the delegate from being collected
    GCHandle handle = GCHandle.Alloc(notefunc);

    INotify(notefunc, Intptr.Zero);

    // Free the handle when it's no longer needed
    handle.Free(); 
```

# c++ - pthread-win32 的 VS rand() 问题

> ID：873993
> 
> 赞同：1
> 
> 时间：2009-05-17T06:09:54.307
> 
> 标签：c++, visual-studio, random, pthreads

我在 pthread 编程中遇到了一个奇怪的问题我在 vs2005 中使用[pthread-w32编译了以下代码](http://sourceware.org/pthreads-win32/)

```
#include <cstdio>
#include <cstdlib>
#include <ctime>
#include <pthread.h>
#include <windows.h>

pthread_mutex_t lock;

void* thread1(void *) {
  int r1;
  while(true) {
    pthread_mutex_lock(&lock); // rand is maybe a CS
    r1 = rand() % 1500;
    pthread_mutex_unlock(&lock);
    Sleep(r1); printf("1:%d\n", r1);
  }
  return NULL;
}

void* thread2(void *) {
  int r2;
  while(true) {
    pthread_mutex_lock(&lock);
    r2 = rand() % 1500;
    pthread_mutex_unlock(&lock);
    Sleep(r2); printf("2:%d\n", r2);
  }
  return NULL;
}

int main() {
  srand((int)time(NULL));
  pthread_mutex_init(&lock, NULL);

  pthread_t tc_p, tc_v;
  pthread_create(&tc_p, NULL, thread1, NULL);
  pthread_create(&tc_v, NULL, thread2, NULL);

  pthread_join(tc_p, NULL);
  pthread_join(tc_v, NULL);

  pthread_mutex_destroy(&lock);

    return 0;
} 
```

输出是这样的

```
2:41
1:41
1:467
2:467
1:334
2:334
1:1000
2:1000 
```

就像 rand() 在每两次调用中返回相同的结果并且我有 srand() 但每次运行程序时结果都不会改变

我对多线程编程很陌生，我听说 rand() 不是线程安全的。但我仍然无法弄清楚上面的程序是错误的还是 rand() 函数有问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T06:15:16.090

`rand`只是伪随机的，每次都会返回相同的序列。 `srand`仅适用于当前线程，因此在主线程中调用它不会影响您的工作线程。

您需要`srand`从每个线程中调用，每个线程的值都不同 - 例如，在您的`thread1`and`thread2`函数中：

```
srand((int)time(NULL) ^ (int)pthread_getthreadid_np()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T06:15:26.963

尝试`rand_s()`改用，它是线程安全的。见[这里](http://msdn.microsoft.com/en-us/library/sxtz2fa8(VS.80).aspx)。当然，它不是便携式的。

# asp.net - ASP.NET 下载未知大小的大文件

> ID：873995
> 
> 赞同：1
> 
> 时间：2009-05-17T06:11:30.730
> 
> 标签：asp.net, iis

我想使用[ASP.NET](http://en.wikipedia.org/wiki/ASP.NET)和[IIS](http://en.wikipedia.org/wiki/Internet_Information_Services)将动态生成的文件下载到浏览器进行保存。我不知道将生成的文件的大小。

在当前形式中，我的代码生成数据并使用 HttpResponse.Write() 发送到客户端。但是在最终显示保存文件对话框之前，客户端大约一分钟内没有看到任何活动。

默认情况下，IIS 缓冲要发送到客户端的输出。可以将其关闭，但这对我来说没有帮助。问题似乎是 IIS 选择格式化数据包的方式。

如果提前知道文件大小，那么我可以在标题中设置 Content-length。如果我关闭了输出缓冲，那么大概 IIS 可以立即开始发送到客户端。

但由于我不知道文件大小，IIS 似乎正在缓冲输出，直到达到某个限制（数据包大小或时间，我不知道），然后发送一个传输编码设置为分块的数据包。

我可以尝试自己对数据进行分块，但有没有办法让 IIS 执行分块，但数据包大小更小，以便对话框更快显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T06:26:28.497

您是否尝试过偶尔调用 HttpResponse.Flush()？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:38:03.183

到目前为止，没有可接受的答案，但我可以分享我所学到的。

我正在使用 IIS 6 和 .NET 框架 2.0。

似乎是 IIS 正在缓冲输出，并且不尊重我对 Flush() 的调用。事实上， Flush() 实际上减慢了下载速度。它似乎只是将输出从一个进程移动到 IIS 中的另一个进程，但效率低于不使用 Flush() 的情况。

测试中出现了一些有趣的行为。如果输出足够小，IIS 会将 content-length 添加到响应的标头中，然后发送它。

如果输出太大，大约 60 秒后，IIS 将 transfer-encoding: 分块添加到标头，然后添加适当的十六进制数字并发送它所具有的内容。从那里，当我的 Flush() 调用发生时，输出被流式传输。

如果我自己分块数据也没关系。IIS 仍然缓冲输出，直到其缓冲区已满。

也许有更好的方法在较新的框架中设置传输编码，以便 IIS 6 可以更好地处理它。

另一种可能性是在 Metabase.xml 中尝试不同的设置。在进一步调查之前，我已经没有时间了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T07:45:34.610

您怎么不知道要流式传输到浏览器的文件的大小？你的意思是 Response.BinaryWrite 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T07:18:05.283

您是否尝试将[BufferOutput](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.bufferoutput.aspx)属性设置为 false？另一种想法（我不知道这是否会改变任何东西）是将文件写入[OutputStream](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.outputstream.aspx)而不是调用`HttpResponse.Write()`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T11:07:23.860

尝试类似的东西：

```
byte[] response_bytes = ...
int offset = ...

using (Stream writeStream = HttpContext.Response.OutputStream)
{
    ...
    writeStream.Write(response_bytes, offset, response_bytes.Length);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-09T06:16:51.490

```
Response.BufferOutput = false; 
```

`return File(fileStream, contentType);`******