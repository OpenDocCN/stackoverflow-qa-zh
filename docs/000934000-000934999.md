# StackOverflow 问答 000934000-000934999

# java - 具有强制数组大小参数的 Java 方法？

> ID：934002
> 
> 赞同：10
> 
> 时间：2009-06-01T08:41:38.097
> 
> 标签：java, class, architecture

我想为接受 3 个参数的 Java 类创建一个初始化方法：

```
Employee[] method( String[] employeeNames, Integer[] employeeAges, float[] employeeSalaries )
{
    Employee myEmployees[] = new Employee[SIZE]; // I don't know what size is

    for ( int count = 0; count < SIZE; count++)
    {
        myEmployees[count] = new Employee( employeeNames[count], employeeAges[count], employeeSalaries[count] );
    }
    return myEmployees;
} 
```

您可能会注意到这段代码是错误的。未定义 SIZE 变量。我的问题是我想传入 3 个数组，但我想知道我是否可以确保这三个数组都是相同的数组大小。这样for循环不会失败，因为for循环中的构造函数使用了数组的所有参数。

也许 Java 有一个不同的特性可以强制解决我的问题。我可以接受另一个名为 SIZE 的参数，它将在 for 循环中使用，但如果参数 1 和 2 的大小为 10 并且第三个参数是大小为 9 的数组，这并不能解决我的问题。

如何强制 3 个参数都是包含完全相同数量元素的数组？使用指定数组大小的额外参数不是很优雅而且有点脏。它也不能解决数组参数包含不同大小的数组的问题。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-01T08:44:44.037

你不能在编译时强制执行。您基本上必须在执行时检查它，如果不满足约束，则抛出异常：

```
Employee[] method(String[] employeeNames,
                  Integer[] employeeAges,
                  float[] employeeSalaries)
{
    if (employeeNames == null
        || employeeAges == null 
        || employeeSalaries == null)
    {
        throw new NullPointerException();
    }
    int size = employeeNames.length;
    if (employeesAges.length != size || employeeSalaries.length != size)
    {
        throw new IllegalArgumentException
            ("Names/ages/salaries must be the same size");
    }
    ...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T08:54:10.600

由于传入的数组直到运行时才生成，因此无法阻止方法调用完成，具体取决于作为编译时检查传入的数组的特征。

正如 Jon Skeet 所提到的，指示问题的唯一方法是`IllegalArgumentException`在运行时抛出一个或类似的东西，以在使用错误参数调用方法时停止处理。

在任何情况下，文档都应该清楚地说明使用该方法的期望和“合同”——传入三个长度相同的数组。在该方法的 Javadocs 中注意这一点可能是个好主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T10:27:05.857

绕过这个问题的一种方法是创建一个构建器，例如 EmployeeArrayBuilder，

```
public class EmployeeArrayBuilder {
   private Integer arraySize = null;
   private String[] employeeNames;
   public EmployeeArrayBuilder addName(String[] employeeNames) {
      if (arraySize == null) {
         arraySize = employeeNames.length;
      } else if (arraySize != employeeNames.length) {
         throw new IllegalArgumentException("employeeNames needs to be " + arraySize + " in length");
      }
      this.employeeNames = employeeNames;
      return this;
   }
   public EmployeeArrayBuilder addSalaries(float[] employeeSalaries) {/* similar to above */}
   public EmployeeArrayBuilder addAges(Integer[] employeeAges) {/* similar  */}
   public Employee[] build() {
       // here, you can do what you needed to do in the constructor in question, and be sure that the members are correctly sized.
       Employee myEmployees[] = new Employee[arraySize ];// dont know what size is            
       for ( int count = 0; count < arraySize ; count++) {
            myEmployees[count] = new Employee( employeeNames[count], employeeAges[count], employeeSalaries[count] );
       }
       return myEmployees;
   }
} 
```

# sql - SQL 查询帮助

> ID：934005
> 
> 赞同：0
> 
> 时间：2009-06-01T08:42:28.127
> 
> 标签：sql

海，

表结构

```
Id No   Date        Time

0001,   01-05-2009, 040000
0001,   02-05-2009, 020000
0002,   01-05-2009, 060000
0002,   01-05-2009, 180000 
```

时间和日期是 nvarchar

我想获取之间的数据

*   昨天 030001 到今天 030000
*   前天0300001到昨天030000

我尝试了下面提到的查询

```
Select 
    idno, min (time), max (time) 
from 
    table 
where 
    time between 030001 and 030000 
```

结果中没有显示任何内容，因为今天的时间从凌晨 03.00 到凌晨 03.01 正是我需要今天凌晨 03.00 到昨天凌晨 03.01

我需要上述条件的 sql 查询

谁能帮我？

贾什。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T09:10:45.573

当您的日期采用 DD-MM-YYYY 之类的格式时，很难排序或过滤。在这种格式中， 01-01-2009 在 02-01-2000 之前！

因此，首先将您的日期转换为长年，最后短秒：

```
YYYY-MM-DD HH:MM:SS 
```

像这样的查询可以做到这一点：

```
select [id no],
    substring(date,1,2) + '-' + substring(date,4,2) + '-' + 
    substring(date,7,4) + ' ' +
    substring(time,1,2) + ':' + substring(time,3,2) + ':'
    substring(time,5,2) as NormalDate
from YourTable 
```

现在，您可以轻松选择特定时间跨度的所有行：

```
select *
from (
    select [id no],
        substring(date,1,5) + '-' + substring(date,7,4) + ' ' +
        substring(time,1,2) + ':' + substring(time,3,2) + ':'
        substring(time,5,2) as NormalDate
    from YourTable
) sub
where '2009-05-01 03:00:00' < NormalDate
and NormalDate < '2009-05-02 03:00:00' 
```

# svn - SVN 文件夹到新的存储库根目录

> ID：934009
> 
> 赞同：2
> 
> 时间：2009-06-01T08:43:10.933
> 
> 标签：svn, migration, repository

我有一个现有的 SVN 存储库，其中包含一个包含我的项目的文件夹。我想知道是否有一种方法可以创建一个新的存储库，并将我的项目文件夹设置为其根目录并保留所有颠覆历史记录（日志）。请注意，我不介意丢失原始存储库修订号。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T09:51:25.087

您可以手动复制存储库，也可以使用 svnadmin。

然后，您可以将项目的子目录移动到根目录下，并删除其他所有内容，从而保留您想要的目录结构。每个文件都将保留历史记录，但它会记住文件曾经有不同的路径（这可能是一件好事）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T10:20:31.127

Avi 的解决方案可能是最简单的，但缺点是新存储库将包含该项目之外的所有内容的完整历史记录。在下面的示例中，我假设您在 *NIX 机器的命令行中，并且您在包含现有存储库的目录中。

```
svnadmin create new-project-repo  # create new repo next to old repo
svnadmin dump old-project-repo | svnadmin load new-project-repo
svn mv file://$PWD/new-project-repo/my-project/trunk    file://$PWD/new-project-repo/trunk
svn mv file://$PWD/new-project-repo/my-project/branches file://$PWD/new-project-repo/branches
svn mv file://$PWD/new-project-repo/my-project/tags     file://$PWD/new-project-repo/tags
# ... svn rm file://$PWD/new-project-repo/XXX for all the cruft still at the top level. 
```

如果你运行的是 subversion 1.6.x，svnsync 提供了一个更好的选择。在 1.6.x 之前，svnsync 只能用于复制整个存储库。在 1.6.x 中，它获得了仅复制存储库的给定子树的能力。

```
svnadmin create new-project-repo
# svnsync needs the ability to set revision properties, so we must install a pre-revprop-change
# hook script which just exits with status 0 (no error).  On *NIX systems, the program `true` will do this.
ln -s /usr/bin/true new-project-repo/hooks/pre-revprop-change  # possibly /bin/true
svnsync init file://$PWD/new-project-repo file://$PWD/old-project-repo/my-project
svnsync sync file://$PWD/new-project-repo
# go drink some coffee 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-02T19:18:22.617

仅供参考： svnsync 选项适用于 subversion 1.5.3。

此外，这是一个执行相同操作的 Windows 批处理脚本：

> SET OLD_REPO_URL= [https://old-project-repo/my-project](https://old-project-repo/my-project)
> SET NEW_REPO_URL=D:/Repositories/new-project-repo
> SET NEW_REPO_FILE_PATH=D:\Repositories\new-project-repo
> 
> svnadmin create %NEW_REPO_FILE_PATH%
> echo exit 0 > %NEW_REPO_FILE_PATH%\hooks\pre-revprop-change.bat
> 
> svnsync 初始化文件:///%NEW_REPO_URL% %OLD_REPO_URL%
> svnsync 文件:///%NEW_REPO_URL%

注意：在同步完成之前，您将无法浏览新存储库。

# javascript - 在 JavaScript 中获取图像数据 URL？

> ID：934012
> 
> 赞同：358
> 
> 时间：2009-06-01T08:43:42.430
> 
> 标签：javascript, image, firefox, greasemonkey, base64

我有一个带有一些图像的常规 HTML 页面（只是常规的`<img />`HTML 标签）。我想获得他们的内容，最好是base64编码，而不需要重新下载图像（即它已经被浏览器加载，所以现在我想要内容）。

我很想用 Greasemonkey 和 Firefox 来实现。

* * *

## 回答 #1

> 赞同：418
> 
> 时间：2009-06-01T13:55:36.980

**Note:** This only works if the image is from the same domain as the page, or has the `crossOrigin="anonymous"` attribute and the server supports CORS. It's also not going to give you the original file, but a re-encoded version. If you need the result to be identical to the original, see [Kaiido's answer](https://stackoverflow.com/a/42916772/2214).

* * *

You will need to create a canvas element with the correct dimensions and copy the image data with the `drawImage` function. Then you can use the `toDataURL` function to get a data: url that has the base-64 encoded image. Note that the image must be fully loaded, or you'll just get back an empty (black, transparent) image.

It would be something like this. I've never written a Greasemonkey script, so you might need to adjust the code to run in that environment.

```
function getBase64Image(img) {
    // Create an empty canvas element
    var canvas = document.createElement("canvas");
    canvas.width = img.width;
    canvas.height = img.height;

    // Copy the image contents to the canvas
    var ctx = canvas.getContext("2d");
    ctx.drawImage(img, 0, 0);

    // Get the data-URL formatted image
    // Firefox supports PNG and JPEG. You could check img.src to
    // guess the original format, but be aware the using "image/jpg"
    // will re-encode the image.
    var dataURL = canvas.toDataURL("image/png");

    return dataURL.replace(/^data:image\/(png|jpg);base64,/, "");
} 
```

Getting a JPEG-formatted image doesn't work on older versions (around 3.5) of Firefox, so if you want to support that, you'll need to check the compatibility. If the encoding is not supported, it will default to "image/png".

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2013-05-15T13:21:47.453

此函数获取 URL，然后返回图像 BASE64

```
function getBase64FromImageUrl(url) {
    var img = new Image();

    img.setAttribute('crossOrigin', 'anonymous');

    img.onload = function () {
        var canvas = document.createElement("canvas");
        canvas.width =this.width;
        canvas.height =this.height;

        var ctx = canvas.getContext("2d");
        ctx.drawImage(this, 0, 0);

        var dataURL = canvas.toDataURL("image/png");

        alert(dataURL.replace(/^data:image\/(png|jpg);base64,/, ""));
    };

    img.src = url;
} 
```

像这样称呼它： `getBase64FromImageUrl("images/slbltxt.png")`

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2017-03-21T01:16:09.560

很久以后，但这里没有一个答案是完全正确的。

在画布上绘制时，传递的图像是未压缩的 + 全部预乘。
导出时，其未压缩或使用不同的算法重新压缩，并且未相乘。

在此过程中，所有浏览器和设备都会发生不同的舍入错误
（请参阅[画布指纹](https://en.wikipedia.org/wiki/Canvas_fingerprinting)）。

因此，如果想要一个图像文件的 base64 版本，他们必须再次**请求**它（大部分时间它将来自缓存），但这次是作为 Blob。

然后，您可以使用[FileReader](https://developer.mozilla.org/en-US/docs/Web/API/FileReader)将其作为 ArrayBuffer 或 dataURL 读取。

```
function toDataURL(url, callback){
    var xhr = new XMLHttpRequest();
    xhr.open('get', url);
    xhr.responseType = 'blob';
    xhr.onload = function(){
      var fr = new FileReader();

      fr.onload = function(){
        callback(this.result);
      };

      fr.readAsDataURL(xhr.response); // async call
    };

    xhr.send();
}

toDataURL(myImage.src, function(dataURL){
  result.src = dataURL;

  // now just to show that passing to a canvas doesn't hold the same results
  var canvas = document.createElement('canvas');
  canvas.width = myImage.naturalWidth;
  canvas.height = myImage.naturalHeight;
  canvas.getContext('2d').drawImage(myImage, 0,0);

  console.log(canvas.toDataURL() === dataURL); // false - not same data
  });
```

```
<img id="myImage" src="https://dl.dropboxusercontent.com/s/4e90e48s5vtmfbd/aaa.png" crossOrigin="anonymous">
<img id="result">
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2017-07-21T21:36:06.540

使用 fetch 的 kaiido 答案的更现代版本是：

```
function toObjectUrl(url) {
  return fetch(url)
      .then((response)=> {
        return response.blob();
      })
      .then(blob=> {
        return URL.createObjectURL(blob);
      });
} 
```

[https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch)

编辑：正如评论中所指出的，这将返回一个指向本地系统中文件的对象 url，而不是实际的 DataURL，因此根据您的用例，这可能不是您所需要的。

您可以查看以下答案以使用 fetch 和实际 dataURL：[https ://stackoverflow.com/a/50463054/599602](https://stackoverflow.com/a/50463054/599602)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-11-01T01:23:58.913

### shiv / 垫片 / 假

如果您的图像已加载（或未加载），则此“工具”可能会派上用场：

```
Object.defineProperty
(
    HTMLImageElement.prototype,'toDataURL',
    {enumerable:false,configurable:false,writable:false,value:function(m,q)
    {
        let c=document.createElement('canvas');
        c.width=this.naturalWidth; c.height=this.naturalHeight;
        c.getContext('2d').drawImage(this,0,0); return c.toDataURL(m,q);
    }}
); 
```

### .. 但为什么？

这具有使用“已加载”图像数据的优点，因此不需要额外的请求。此外，它让最终用户（像您这样的程序员）决定*CORS*`mime-type`和/或- 或 - 您可以省略[这些](https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL)`quality`参数/参数，如**MDN**规范中所述。

如果你已经加载了这个 JS（在需要它之前），那么转换为`dataURL`很简单：

### 例子

`HTML`

```
<img src="/yo.jpg" onload="console.log(this.toDataURL('image/jpeg'))"> 
```

`JS`

```
console.log(document.getElementById("someImgID").toDataURL()); 
```

### GPU 指纹识别

如果您担心位的“精确性”，那么您可以更改此工具以满足@Kaiido 回答所提供的您的需求。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-04-24T08:03:38.567

加载后使用`onload`事件转换图像

```
function loaded(img) {
  let c = document.createElement('canvas')
  c.getContext('2d').drawImage(img, 0, 0)
  msg.innerText= c.toDataURL();
}
```

```
pre { word-wrap: break-word; width: 500px; white-space: pre-wrap; }
```

```
<img onload="loaded(this)" src="https://cors-anywhere.herokuapp.com/http://lorempixel.com/200/140" crossorigin="anonymous"/>

<pre id="msg"></pre>
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-16T18:01:34.443

这就是您需要阅读的全部内容。

[https://developer.mozilla.org/en-US/docs/Web/API/FileReader/readAsBinaryString](https://developer.mozilla.org/en-US/docs/Web/API/FileReader/readAsBinaryString)

```
var height = 200;
var width  = 200;

canvas.width  = width;
canvas.height = height;

var ctx = canvas.getContext('2d');

ctx.strokeStyle = '#090';
ctx.beginPath();
ctx.arc(width/2, height/2, width/2 - width/10, 0, Math.PI*2);
ctx.stroke();

canvas.toBlob(function (blob) {
  //consider blob is your file object

  var reader = new FileReader();

  reader.onload = function () {
    console.log(reader.result);
  }

  reader.readAsBinaryString(blob);
}); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2019-01-12T10:18:20.610

在 HTML5 中更好地使用这个：

```
{
//...
canvas.width = img.naturalWidth; //img.width;
canvas.height = img.naturalHeight; //img.height;
//...
} 
```

# delphi - 有没有比 Delphi 中默认的 TDBGrid 更好的多选？

> ID：934020
> 
> 赞同：1
> 
> 时间：2009-06-01T08:45:44.190
> 
> 标签：delphi, grid

首先，这适用于 Delphi 5 Enterprise，因为这是我们在工作中使用的。短期内没有升级的想法，因为这个版本显然“做了我们需要的”。

在 TDBGrid 上设置 dgRowSelect 和 dgMultiSelect 选项后，该行为无法与标准 Windows UI 确认。

我认为我们以前不需要这个选项，否则我会注意到 Delphi 的 TDBGrid 上的默认实现是多么糟糕。我希望 Ctrl-Click 用于单行（可以正常工作；不是很好，但可以），但也希望 Shift-Click 用于范围选择（这不起作用）。

我怀疑我可以捕获 WM_LBUTTONDOWN 消息并在子类中手动处理它，但是在这条路上有什么陷阱等着我吗？

我希望有人已经不得不经历这些动议，因为我无法想象人们会对所提供的糟糕的默认努力感到满意。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-06-01T17:22:41.567

[可从 Woll2Woll [ http://www.woll2woll.com]](http://www.woll2woll.com])获得的 Infopower 库包含一个扩展的数据网格，其中包括将提供您想要的行为的属性 (msoAutoUnselect,msoShiftSelect)。

这些属性是在 Infopower 历史的早期引入的，因此即使是您能找到的最便宜的版本也应该足够了。无论如何，Infopower 的成本都不到三百美元。

我与 Woll2Woll 没有任何关系；我只是使用他们的产品。

-阿尔。

# linux - 如何使 PHP 进程在死时自动重启？

> ID：934022
> 
> 赞同：0
> 
> 时间：2009-06-01T08:46:25.810
> 
> 标签：linux, bash

像一个永远不会死的恶魔，

我的系统是fedora10

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T08:58:41.073

```
while true; do php daemon.php; done 
```

如果可以接受小的中断，请在`sleep 1;`之前添加，`done`以便不断失败的守护进程的生成率受到一定限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T09:38:45.457

您想知道如何构建这样的服务，或者只是在失败的情况下如何重新启动它？

您可以在系统级别使用某些东西，例如“monit”：[http ://www.cyberciti.biz/tips/howto-monitor-and-restart-linux-unix-service.html](http://www.cyberciti.biz/tips/howto-monitor-and-restart-linux-unix-service.html)

# selenium - 硒 xpath 流

> ID：934027
> 
> 赞同：0
> 
> 时间：2009-06-01T08:48:18.147
> 
> 标签：selenium, xpath

谁能告诉我在 Selenium-IDE 中取出 xpath 的确切流程是什么。在通过发出警报尝试了很多之后，我没有得到如何取出确切的 xpath。Selenium 根据 xpath:position 和其他一些方式显示 xpath，但我想添加从 html 遍历的 xpath，即最高位置。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-23T01:07:12.587

我开始更喜欢 CSS 选择器而不是 Xpath。IDE 不会为您创建它们，但只要稍加练习，它们就很容易编写。作为奖励，它们使您的测试更容易维护。

例如，假设您有一个带有“保存”文本的按钮。定位器将是：

```
css=button:contains('save') 
```

查看[http://www.w3.org/TR/css3-selectors/](http://www.w3.org/TR/css3-selectors/)了解更多详情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-11T10:00:59.170

用javascript编写1行代码：

```
LocatorBuilders.order = ['id', 'link', 'name', 'dom:name', 'xpath:link', 'xpath:img','xpath:attributes', 'xpath:href', 'dom:index', 'xpath:position']; 
```

以你想要的方式改变它（并非所有人都必须在那里）

看：

```
chrome://selenium-ide/content/locatorBuilders.js 
```

另存为 your_file.js

在 IDE 选项中将 your_file.js 添加为“Selenium Core 扩展”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-15T20:01:16.577

[Firebug 的Firefinder](https://addons.mozilla.org/en-US/firefox/addon/11905)有助于匹配 CSS 和 XPath 定位器

一般来说，安装 Firebug 后，您可以检查元素的 HTML 和 DOM 结构，以确定您可以构建的最佳定位器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T13:36:34.537

我使用[XPather](https://addons.mozilla.org/en-US/firefox/addon/1095)找出 xpath。然后我使用 Selenium IDE 中生成的路径进行交叉验证。您也可以使用 XPath Checker 或 Firebug 等其他工具来执行相同的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-26T11:58:44.167

找到 x 路径的最佳方法是：

1.  在 chrome 中打开开发者工具栏：
2.  找到下面显示的 x 路径： [![在此处输入图像描述](https://i.stack.imgur.com/dGaDB.png)](https://i.stack.imgur.com/dGaDB.png)

您可以直接在脚本中复制并粘贴此 x 路径

# windows - 如何从“调用”例程中终止 Windows 批处理文件？

> ID：934030
> 
> 赞同：9
> 
> 时间：2009-06-01T08:48:59.830
> 
> 标签：windows, batch-file

我有一个 Windows 批处理文件，其中有一些子例程，如下所示：

```
call :a
goto :eof

:a
call :b
goto :eof

:b
:: How do I directly exit here from here?
goto :eof 
```

我在 Vista 的 cmd 窗口中运行它。
如果我在批处理文件的某处检测到错误，我希望它以非零错误级别退出。我可以在例程 :b 中写什么会导致批处理文件像这样终止。

*   我试过“退出”，它会关闭整个 cmd 窗口。那不是我想要的。
*   我试过“退出/B 1”。回到之前的例程。要在每次“调用”后使用此方案，我必须在每次“调用”后仔细编写“if errorlevel 1 exit /B 1”，以将错误传递回调用堆栈。我不想在每次通话后都写这行。

这篇文章很有趣，但没有一个替代品以我想要的方式运行。[http://www.computerhope.com/exithlp.htm](http://www.computerhope.com/exithlp.htm)

还有其他方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-01T09:25:09.803

您可以像这样调用您的子例程：

```
call :b||exit /b 1 
```

这相当于

```
call :b
if errorlevel 1 exit /b 1 
```

它稍微短一些，可以节省一行，但我同意它仍然不理想。

除此之外，我看不到任何方法。

**编辑：**好的，我有办法，但它是 Pure Evil™。

滥用最大堆栈大小和递归限制，我们创建了另一个子程序，它通过递归调用自身来简单地耗尽堆栈：

```
@echo off
echo Calling a
call :a
echo Called a
goto :eof
:a
echo Calling b
call :b
echo Called b
goto :eof
:b
echo Trying to exit
call :exit
goto :eof
:exit
call :exit 
```

但是，这将导致令人讨厌的错误消息

```
****** BATCHRECURSION 超出堆栈限制 ******
递归计数=704，堆栈使用率=90%
****** 批处理已中止 ******

```

此外，在我的机器上大约需要 2 秒。

`call`您可以通过如下更改语句来抑制错误消息：

```
call :exit >nul 2>&1 
```

这会将它想要输出的所有内容重定向到一个巨大的空白中。

但考虑到填充堆栈所需的时间，我认为第一个变体会更容易。

我也在考虑使用第二个批处理文件，如果没有运行，它`call`基本上会停止第一个批处理文件。但不知何故，这不能很好地与子例程配合使用。展开调用堆栈似乎仍在进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T19:32:15.877

您可以创建一个 exit.bat 文件，该文件按标题名称杀死顶部的 bat 文件。

例子：

**一只蝙蝠**

```
@echo off
title A.bat
echo A.bat
call B.bat
echo A.bat 
```

**蝙蝠**

```
@echo off
echo B.bat
exit.bat A.bat
echo B.bat 
```

**退出.bat**

```
@echo off
echo exit.bat
kill %1 
```

# web-services - 可能的时间网络服务操作

> ID：934033
> 
> 赞同：1
> 
> 时间：2009-06-01T08:50:43.557
> 
> 标签：web-services, time

在我们的客户端应用程序中，我们需要获取服务器的时间。对于此 getTime() 操作，添加到服务器上的现有 Web 服务，该服务基本上返回 DateTime.Now（.Net 环境）。目前，除了当前时间之外，似乎没有其他与时间相关的需求。但是除此之外还可以添加什么方法呢？如果你有过这样的经历，或者以后需要添加一些其他的方法，请分享你的经验。

注意：我知道，我们可以坚持使用[YAGNI](http://en.wikipedia.org/wiki/YAGNI)，但我想知道人们面临的与时间 Web 服务相关的其他需求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T09:07:28.607

时区信息？（即服务器所在的时区..）

# svn - 在 cc.net 中的 svn User-wise Options 上构建特定项目

> ID：934035
> 
> 赞同：0
> 
> 时间：2009-06-01T08:50:54.850
> 
> 标签：svn, cruisecontrol.net

当用户在 svn 上提交任何更改时，我想构建项目。我的项目解决方案包含许多项目，因为它们使用一些共享控件和功能。现在我的问题是如何只构建用户已提交的项目。是否可以根据用户构建项目。

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-10T12:50:33.510

检查[Filtered Source Control Block](http://confluence.public.thoughtworks.org/display/CCNET/Filtered+Source+Control+Block)以查看如何仅过滤某些用户的提交以触发构建。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-01T12:13:46.203

看看 SVN 提交后挂钩 - 这至少可以让您在提交更改时构建您的项目：

[http://svnbook.red-bean.com/en/1.1/ch05s02.html#svn-ch-5-sect-2.1](http://svnbook.red-bean.com/en/1.1/ch05s02.html#svn-ch-5-sect-2.1)

# comparison - 在 AQTime 4 中，如何比较来自安装在不同目录中的构建的性能结果？

> ID：934036
> 
> 赞同：0
> 
> 时间：2009-06-01T08:51:04.427
> 
> 标签：comparison, aqtime

例如，如果我配置文件：

```
C:\Program Files\Application Build 1\MyApp.exe
C:\Program Files\Application Build 2\MyApp.exe 
```

然后我将两组结果导入单个 AQTime 项目并尝试比较它们，AQTime 不匹配每个中的任何相应函数。我假设在比较时，当遇到两个具有相同名称但模块名称不同的函数时，得出的结论是它们不是同一个函数，然后将它们放在输出表中的单独行中。如何忽略模块名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T08:37:49.910

据我所知，模块名称是相同的——不同之处在于路径。尝试禁用 Profiler 工具栏上的“带路径的文件名”选项（它显示在报告面板的顶部）。如果这没有给出预期的结果，请在此处发布一个屏幕截图来展示您的情况。

最好的问候，
Alex
AutomatedQA 支持团队

# cocoa - Cocoa: NSXMLParser - 如何解析 DTD 中定义的实体

> ID：934039
> 
> 赞同：0
> 
> 时间：2009-06-01T08:52:08.793
> 
> 标签：cocoa, nsxmlparser

我使用 NSXMLParser 来解析大型 XML 文件——运行良好但是 :) 我无法让解析器解析来自 DTD 的外部实体。

我用谷歌搜索并阅读了文档和旧邮件......我确实设置了 parser.shouldResolveExternalEntities = YES

我确实得到了：- (NSData *)parser:(AQXMLParser *)parser resolveExternalEntityName:(NSString *)name systemID:(NSString *)systemID 但我不知道要返回什么...实体是在 DTD 中定义的。 .

如果我能获得 DTD 中条目的以下内容，我将自己构建一个表 - (void)parser:(AQXMLParser *)parser foundInternalEntityDeclarationWithName:(NSString *)name value:(NSString *)value;

不过，NSXMLParser 不应该为我做实体替换吗？不知何故... ：）

无论如何，我不知道如何进行

* * *

交叉发布@ cocoa-dev@lists.apple.com

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T09:43:18.660

由于 DTD 中的 URI 不一定指向被引用对象或实体的真实位置，因此委托方法的工作是解析外部实体：

在 parser:resolveExternalEntityName:systemID:
使用 NSXMLDTD 加载外部 DTD (systemID) 并
使用 NSXMLDTD 返回的 NSXMLDTDNode 对象： entityDeclarationForName:entityName 来解析实体

# c# - 一次性

> ID：934042
> 
> 赞同：0
> 
> 时间：2009-06-01T08:52:44.613
> 
> 标签：c#, .net, idisposable

我正在尝试调整课程以适应刚刚完成的工作，但我无法解决问题。我的问题是如何识别句柄关闭 //CloseHandle（句柄）。我的问题是我无法调整以下代码。

```
for (Int32 i = 0; i < temp_items.Count; i++)
{ 
        string conj_itens = temp_itens[i].ToString();
         ContarSuporte cs= new ContarSuporte(matriz_bin,strExpr);
 _cont = cs.Suporte;
      If (_cont>100) 
   {
     list.add(conj_itens);
   }

} 

public class ContarSuporte: IDisposable 
{
    private int _cont;
    private bool disposed = false;
    private IntPtr handle; 

    public ContarSuporte()
    { 
    } 

   public ContarSuporte(DataTable matriz_binaria, string strExpr)
    {
        int c = matriz_binaria.Rows.Count;
        this._cont = (int)(matriz_binaria.Compute("COUNT(TID)", strExpr)); 
    } 
    ~ContarSuporte()
     {

         Dispose(false);

    } 
    public void Dispose()
    {
        //GC.Collect();
        Dispose(true);
        GC.SuppressFinalize(this); 
        // GC.Collect();
    } 

    private void Dispose(bool disposing)
    {
        if (!this.disposed)
        {
            if (disposing)
            {
                //this.Dispose();
            }
            //CloseHandle(handle); 
            handle = IntPtr.Zero;

        }
        disposed = true;
    } 

    public int  Suporte
    {
        get
        {
            return _cont;
        }
        set
        {
            _cont =value;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T08:56:21.093

您没有显示任何实际*使用*句柄的代码。你真的确定你首先需要实施`IDisposable`并有一个句柄吗？您要使用什么非托管资源？

您是否可能只是遵循您在其他地方看到的*确实*使用手柄的模式？你应该只`IDisposable`在你真正需要的时候实现——现在实现终结器应该是*非常*罕见的（因为你可以用它`SafeHandle`来代替`IntPtr`句柄）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T08:58:03.963

你想关闭什么句柄？我看不到任何分配句柄的东西。

另外-在许多情况下，您可以使用它`SafeHandle`来简化此操作-我无法确定这是否适用于您的情况，因为我看不到发生了什么...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T10:32:32.337

这个想法是完成这个指令**this._cont = (int)(matriz_binaria.Compute("COUNT(TID)", strExpr));** 对每段来说，问题不在于增加内存的使用我认为最多的是因为它是垃圾。我的想法是创建一个类来避免内存增长。已经放置了_cont变量=1，对内存没有影响，以及this引发intrucção内存的问题，而每一段的目的和效果都是有兴趣清理用这条指令创建的垃圾内存this._cont = (int )(matriz_binaria.Compute("COUNT(TID)", strExpr));**

谢谢

# sharepoint - Howto：在 sharepoint 中启用匿名调查

> ID：934045
> 
> 赞同：0
> 
> 时间：2009-06-01T08:54:58.647
> 
> 标签：sharepoint

我正在尝试为允许匿名访问的面向公众的 MOSS 网站设置调查。我愿意接受这些限制，并按照博客 teuntostring-using-surveys-on-anonymous-access.htm 上的说明（我是新用户，无法在此处添加链接）到信中（我认为）。但是，每次我尝试访问调查时都会出现登录提示。

请注意，这是一个发布门户。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T10:43:44.437

匿名人士不能以任何形式做出贡献。

有几个选项可以解决。

1) 使用 infopath Web 表单并将其作为 Web 服务提交。这确实需要您编写一个 Web 服务来处理它，这样的例子有很多。

2) 使用 javascript 和硬编码帐户信息伪造 Web 服务。

3）有一个匿名用户自动登录的帐户，需要一个处理程序。

见 http: [//blogs.devhorizo​​n.com/reza/?p=551](http://blogs.devhorizon.com/reza/?p=551) [http://www.elumenotion.com/Blog/Lists/Posts/Post.aspx?ID=11](http://www.elumenotion.com/Blog/Lists/Posts/Post.aspx?ID=11) [http://wssguestaccount.codeplex.com/发布/ProjectReleases.aspx?ReleaseId=12313](http://wssguestaccount.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=12313)

# opengl - opengl中的“无限”画布

> ID：934049
> 
> 赞同：1
> 
> 时间：2009-06-01T08:55:49.753
> 
> 标签：opengl

我在 tilemap 编辑器中使用 opengl。以 GL_LUMINANCE32F 格式存储 tilemap，然后使用 opengl 命令对其进行修改。

现在，我意识到画布大小限制是人们绘制瓷砖地图的负担。那么如何实现无限画布呢？（这样扩展和收缩无需用户显式触发它来扩展或收缩）

需要的画布的扩展或缩小并不难，我可以轻松地创建另一个画布，将旧画布内容移动到上面并移除旧画布。相反，我不知道的是，我怎样才能让画布检测它什么时候可以收缩，它可以收缩多少？

所以我应该检测我的画布边缘有多少行和多少列的零。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T08:59:04.273

用瓷砖制作无限的画布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T15:43:06.843

想到的一个想法是通过以下方法分别找出在 X 和 Y 方向上要缩小多少：渲染一个矩形“边距”，例如画布大小的一半，并使用 ARB_occlusion_query 来确定它是否为空. 如果不为空，则分成两半并重复（即进行二进制搜索以找到正确的大小）。这需要 log(N) 步，其中 N 是画布的大小（宽度或高度），所以如果不时完成，它会非常快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T15:32:29.970

像你建议的那样缩小画布对艺术家没有帮助。他们经常扩大他们正在工作的区域，只是为了有工作的区域。还有一些精灵表，在目标程序中工作所需的模型周围有空白区域。

我的建议是按需增长，但允许艺术家在需要时手动调整大小。

# javascript - Javascript 方法

> ID：934050
> 
> 赞同：2
> 
> 时间：2009-06-01T08:55:56.510
> 
> 标签：javascript, methods

我正在制作一个收藏列表，您可以在其中通过 javascript 添加项目并再次删除它们。这些值存储在 cookie 中，以便在用户返回时记住该列表。我遇到的问题是从列表中删除项目的方法不会运行，除非首先有回发。我删除项目的代码如下所示：

```
 function removeFavorite(OrderId) {
    debugger;
    var cookieValues = jQuery.cookie('FavoriteList');
    var cookieArray = cookieValues.split(",");
    for (var i = 0; i < cookieArray.length; i++) {
        if (cookieArray[i] == OrderId) {
            cookieArray.splice(i, 1);
        }
    }
    jQuery('li#liFavoriteOrder_' + OrderId).remove();
    jQuery.cookie('FavoriteList', cookieArray.join(","));
} 
```

调用该方法的代码如下所示：

```
<a onclientclick="removeFavorite(1272331)" style="cursor: pointer;"> 
```

![](/Images/Icons/bullet_toggle_minus.png)

列表看起来像

```
<ul id="ulFavoriteList"> 
<li id="FavoriteId_1272331">
Milk
<a onclientclick="removeFavorite(1272331)" style="cursor: pointer;">
<img src="/Images/Icons/bullet_toggle_minus.png"/>
</a>
</li>
</ul> 
```

添加到列表的代码看起来有点像这样（短版）：

```
 jQuery('<li id=\"liFavorite_' + OrderId + '\"><a target=\"_blank\" href=\"' + url + '\">' + OrderName + '</a><a style="cursor:pointer;" onclientclick="removeFavorite(' + OrderId+ ')"><img src="/Images/Icons/bullet_toggle_minus.png" /></a></li>').appendTo('ul#ulFavoriteList'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T09:39:52.257

这只是一个非常愚蠢的错误。我不能在常规 html 元素上使用 onclientclick，但需要使用 onclick 代替。

# git - 如何防止 autotools 自动重新生成配置脚本？

> ID：934051
> 
> 赞同：4
> 
> 时间：2009-06-01T08:56:03.293
> 
> 标签：git, autotools

有时由于 SCM 没有严格记住文件的时间戳，生成的 Makefile 会认为它需要重新运行“autoreconf -i”或等效于从 Makefile.am 重新生成 Makefile.in，从 configure.ac 配置等..

我该如何防止这种情况？

我想阻止它，因为它会导致这些问题：

*   创建 dist 存档（git archive --format=tar ...）时，时间戳将不正确，最终用户会遇到问题。不酷。
*   在慢速系统上，这会使编译花费更长的时间，因为它不再是 configure、make、make install，而是 configure、autoreconf -i、configure、make make install。

我知道我可以在制作 dist tarball 之前“触摸”生成的文件，但在我看来，这只能解决 tarball 的问题，而不是开发人员的问题。解决应该可以关闭的错误功能也是一个丑陋的黑客。此外，它会破坏 git 存档，因为无论如何时间戳并不总是正确的。

其他 SCM 也有这个，所以问题不在于 (IMO) 与 git。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-01T09:12:42.777

您需要查看[维护者模式](http://sources.redhat.com/autobook/autobook/autobook_43.html)- 这应该会阻止 autoreconf 步骤，这将解决最终用户的问题。

添加

```
AM_MAINTAINER_MODE 
```

到您的 configure.ac / configure.in 文件，然后（除非您指定`--enable-maintainer-mode`）当您配置时，您的 Makefile 将不包含重新配置规则。

# wpf - WPF 析构函数

> ID：934054
> 
> 赞同：0
> 
> 时间：2009-06-01T08:57:41.873
> 
> 标签：wpf, destructor, xbap

有谁知道为 XBAP 应用程序编写析构函数的正确方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T09:13:39.547

XBAP 应用程序是在浏览器中运行的**托管**WPF 应用程序，因此不应该支持确定性清理……也就是破坏。[Dispose 模式](http://msdn.microsoft.com/en-us/library/fs2xkftw.aspx)是任何需要明确执行的清理的答案。

或者，如果只是想在关机前运行一些代码……查看[Application](http://msdn.microsoft.com/en-us/library/system.windows.application.aspx)类，它公开了诸如 OnExit/Exit 之类的生命周期方法/事件。

# watin - 如何通过 Watin 中的代码关闭弹出窗口阻止程序？

> ID：934064
> 
> 赞同：1
> 
> 时间：2009-06-01T09:01:35.000
> 
> 标签：watin, popup-blocker

我在通过 watin 代码关闭弹出窗口阻止程序时遇到了麻烦。谁能帮我知道如何通过watin关闭IE的弹出窗口阻止程序？如果 IE 中安装了工具栏（如 google、yahoo 或 msn）的弹出窗口阻止程序，有什么方法可以关闭它们？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-10T12:05:17.237

您可以使用 .NET 更改 IE 的注册表项。有关特定键的更多信息，请参阅[http://support.microsoft.com/kb/843016](http://support.microsoft.com/kb/843016)。

全部：

```
HKEY_LOCAL_MACHINE\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_WEBOC_POPUPMANAGEMENT
Value = 0 for Off
Value = 1 for On 
```

每个区域：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\[0-4]\1809
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\[0-4]\1809
Value = 0 for Enabled
Value = 3 for Disabled 
```

每个站点：

```
HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\New Windows\Allow
Create subkey with domain name and binary data. 
```

以下是通过 .NET 编写注册表项以将站点放入受信任区域的代码示例，这使 WatiN 能够下载文件：

[以编程方式将受信任的站点添加到 Internet Explorer](https://stackoverflow.com/questions/972345/programmatically-add-trusted-sites-to-internet-explorer)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-09T03:44:47.880

您无法使用 WatiN 禁用此功能，但您可以使用 UIAutomation 来执行此操作。

# c# - C#：尽管使用 Graphics.DrawImage 的分辨率不同，但仍保持大小

> ID：934067
> 
> 赞同：3
> 
> 时间：2009-06-01T09:03:46.120
> 
> 标签：c#, graphics, resolution, drawimage

我正在尝试使用 C# 绘图命名空间并排绘制两个图像。这是一个非常简单的示例，假设我们有两个相同高度的图像：

```
Image[] oldImages = GetOldImages();

var newImage = new Bitmap(oldImages[0].Width + oldImages[1].Width, 800);

using (var newImageGraphics = Graphics.FromImage(newImage))
{
    newImageGraphics.DrawImage(oldImages[0], 0, 0);
    newImageGraphics.DrawImage(oldImages[1], oldImage[0].Width, 0);
    newImageGraphics.Save();
} 
```

如果两个旧图像的分辨率相同，这可以正常工作。

但是，如果分辨率不同，则会调整图像大小，从而导致问题。例如，如果第一张图像具有不同的分辨率，则第二张图像的位置将不正确。

有谁知道我可以如何轻松解决这个问题？理想情况下，我希望原始图像的高度和宽度在绘制到新图像时保持不变。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-10T08:54:53.910

试试这个技巧：

```
Bitmap picture_1 = new Bitmap(picture_1_path);
Graphics graphics = Graphics.FromImage(picture_1);
Bitmap picture_2 = new Bitmap(picture_2_path);
picture_2.SetResolution(graphics.DpiX, graphics.DpiY);

//Then do with pictures anything 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T09:09:09.260

基本上，您需要在添加到新图像之前调整第二张图像的大小。

尽管您说要保留原始高度和宽度，但您需要更改第二张图像的画布大小。这通过在实际图像周围添加空白空间来增加图像的大小。如果第二张图片大于第一张，则需要对第一张图片执行此操作。

# asp.net - 安装 .net 3.5 sp1 后，我无法在网站中创建任何文件？

> ID：934068
> 
> 赞同：1
> 
> 时间：2009-06-01T09:04:08.990
> 
> 标签：asp.net

安装 .net 3.5 sp1 后，我无法从 asp.net 页面创建任何文件，它总是抛出异常：“访问路径被拒绝”。我将 asp.net 工作进程帐户的所有权限设置为完全控制，但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T09:44:26.990

首先，通过临时授予该目录中的“所有人”完全权限来确认这确实是用户权限错误。（这当然假设您在测试环境中！）如果仍然无法正常工作，则说明发生了其他事情。

那么……“网络服务”呢？IIS 配置为用于匿名访问的用户权限如何？通常这是“IUSR_[主机名]”。

这里有很好的信息：http: [//www.bluevisionsoftware.com/WebSite/TipsAndTricksDetails.aspx?Name=AspNetAccount](http://www.bluevisionsoftware.com/WebSite/TipsAndTricksDetails.aspx?Name=AspNetAccount)

# php - 所有这些网络平台如何实现不需要用户反复登录的长时间登录会话？

> ID：934071
> 
> 赞同：4
> 
> 时间：2009-06-01T09:05:36.067
> 
> 标签：php, session, login, persistence

我真的不明白：有些平台有某种“持久”登录会话。像 Stackoverflow 和许多其他板和平台一样。我一个月前在这里登录。即使我完全退出浏览器并使用不同的 IP 建立另一个互联网连接，我还是没有登录就回到这里。

我不敢相信这只是用 cookie 完成的，因为大多数现代浏览器不再接受 cookie（他们会询问用户和点击本能的“不”）。

我什至遇到了一个无论我使用什么浏览器都可以进行持久登录的平台。我可以使用野生动物园或歌剧。无论。我总是用我的昵称登录。

从那以后几年过去了，我完全放弃了 Web 开发，我想知道技术是否发生了变化？今天是怎么做到的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T09:07:48.857

> 我无法相信 [原文如此] 只是用 cookie 完成的，因为大多数现代浏览器不再接受 cookie（它们会询问用户和点击本能的“不”）。

默认情况下，每个主要浏览器都接受 cookie。

[（这只是理性黄金法则的另一个例子：信念不能代替事实。）]

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-01T09:10:46.870

大多数浏览器默认配置为接受第一方 cookie - 这些是网站为同一域提供的 cookie。但是，[*第三方*](http://en.wikipedia.org/wiki/HTTP_cookie#Third-party_cookies)cookie，一个由一个站点发送，但注定要在另一个站点上使用，通常会被拒绝或弹出一个确认对话框。

所以答案是，是的，它是饼干！

这里有一些[有趣的图表，](http://www.grc.com/cookies/stats.htm)显示了启用了各种形式的 cookie 过滤的网站访问者的百分比，按浏览器细分：

![替代文字](https://www.grc.com/cookies/browsercookies.png)

同一个站点还总结了主要浏览器[中 cookie 处理的功能和默认设置。](http://www.grc.com/cookies/fameandshame.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T09:11:20.753

饼干让世界运转起来。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T09:14:57.873

所以......似乎你有你的答案（或至少部分答案），但我想我会添加细节（虽然我怀疑你已经知道这一点），你可以设置一个 cookie 在某个时间点过期遥远的未来，有效地使其永久化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T09:15:30.387

## 饼干

就像 Paul Dixon 指出的 cookie 仍然以某种方式被浏览器接受。

## PHP 会话和 cookie。

在 php 中，大部分时间都是通过会话完成的，会话默认将文件存储在服务器上以跟踪用户并发送 cookie-header 以在浏览器上存储 cookie。

[从这个zend 教程](http://devzone.zend.com/node/view/id/646)中阅读更多关于它的信息

## 附加到 url 的 PHP Session-id

也可以通过将 session-id 附加到 url 而不是使用 cookie 来完成。

```
ini_set('session.use_cookies', 0) // don't use cookies 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T09:11:17.337

您可以轻松检查 StackOverflow 是否在浏览器中存储 cookie。

# javascript - Visual Studio 中的 Javascript 调试

> ID：934073
> 
> 赞同：1
> 
> 时间：2009-06-01T09:07:05.020
> 
> 标签：javascript, visual-studio-2008, debugging

我在 IE 中启用了脚本调试。我在文件中放入了 debugger 关键字，它也被捕获了。调试器已经附加到 ie 进程并且类型是脚本。

当 ie 提示“你想调试”时，我按下是并选择 Visual Studio 2008（打开我的项目）。当 Visual Studio 打开时，我收到一条警报，“当前位置没有可用的源代码。”。当我设置断点时，会打开旧版本的文件。

我认为它与 Visual Studio 缓存相关的一些问题。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T09:41:28.523

这可能不是您所要求的，但我的建议是转储 VS 进行 javascript 调试，并为此目的使用[Firebug 。](https://addons.mozilla.org/en/firefox/addon/1843)我这样做了，不想回去。

此外，Firebug 可以做很多比 Javascript 调试更有用的事情，所以如果你对 AJAX 开发很感兴趣，你真的想安装它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-21T02:05:12.947

这是一个令人沮丧的问题。这是在 VS 2013 中解决它的方法（希望您已经升级）。

进入 Internet Explorer>Internet 选项>高级并取消选中禁用脚本调试（Internet Explorer）和禁用脚本调试（其他）。

现在，当您在 Visual Studio 中设置断点并在调试模式下运行您的解决方案并选择 Internet Explorer 时，它将到达您的断点。我不确定其他浏览器是否有任何可能的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-01T10:32:30.527

它不是 VS 缓存它的浏览器缓存。F5 获取最新的 js 到浏览器中。

# internet-explorer - cookie 接受度很低的原因是什么？

> ID：934077
> 
> 赞同：-1
> 
> 时间：2009-06-01T09:08:45.187
> 
> 标签：internet-explorer, cookies, acceptance

我目前正在为一个希望利用 cookie 来更好地塑造他们的流量等的客户构建一个网络应用程序，等等，你知道这个练习。

所以在上周结束时，我添加了一个简单的 cookie 写入（基本上设置 cookie="helloworld"）和一个带有计数器的 cookie 读取到应用程序，这实际上只是一个页面，所以对服务的每个请求都会通过这个读取/肯定写。

部署 cookie 读取率后的几百万个请求占总请求的约 25%，而现在在周末之后，它们仅攀升至约 33%。

* * *

供参考：没有设置路径，域是固定的，有效期是从创建开始的一个月。重复访问的次数相对较高。我对设置/获取和计数的技术有 100% 的信心。

* * *

更新：进一步调查显示，非 IE 浏览器的接受率为**90% 。**将自己标识为 IE（无疑包括许多机器人）的请求有**10%**的接受率。基于 fiddler 会话（由 firebug 确认），响应标头如下所示：

```
HTTP/1.1 200 OK
Content-Encoding: gzip
Expires: Wed, 09 Jun 1993 00:00:00 GMT
Vary: Accept-Encoding
Set-Cookie: foo; domain=bar.com; expires=Sat, 11-Jul-2009 11:10:19 GMT; path=/; HttpOnly
Cache-Control: no-cache
Cache-Control: private
Cache-Control: no-store
Cache-Control: must-revalidate
Cache-Control: max-stale=0
Cache-Control: post-check=0
Cache-Control: pre-check=0
Date: Thu, 11 Jun 2009 11:10:19 GMT
Transfer-Encoding: chunked
X-AspNet-Version: 2.0.50727
Server: Microsoft-IIS/6.0
X-Powered-By: ASP.NET
Content-Type: text/html
Pragma: no-cache 
```

所以我有两个理论：

1）。IE 发现标头中存在冲突，导致它忽略 cookie——这可能与缓存控制字段有关吗？

2）。IE 需要的东西丢失或格式不正确。我找不到这种谷歌搜索的证据。

**任何人都可以发现上面的标题有问题或有类似的经验吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-12T12:01:19.207

为了未来读者的利益，事实证明它只是在一个未预料到的实现上执行[P3P 。](http://www.w3.org/P3P/)

死我死

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T09:16:34.393

当我想到更多原因时，我会更新列表，但这些都是可能的。

*   您的网站是否使用任何创意形式的框架？
*   您是否使用 Javascript 设置 cookie，您的用户是否可能启用它？
*   Javascript跨浏览器兼容吗？
*   目标受众是否可能禁用 cookie？
*   您是否有很多机器人在抓取您的网站？
*   每个页面上都有跟踪代码吗？

您是否将 cookie 响应与 HTTP 请求的总数进行比较？您是否意识到您的一些请求可能是图像、css 或其他可能不会发送 cookie 标头的内容？我想我在某处读到浏览器没有将 cookie 标头用于某些类型的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T09:40:47.510

我想由于声明不准确，浏览器会拒绝 cookie。您尤其缺少有效性信息（`Domain`,`Path`和`Expires`/ `Max-age`）。事实上，丢失`Expires`或`Max-age`信息将使该 cookie 只是一个会话 cookie，在关闭浏览器时到期。

# vb.net - 如何在VB中编辑文件？

> ID：934081
> 
> 赞同：0
> 
> 时间：2009-06-01T09:10:17.510
> 
> 标签：vb.net, visual-studio-2005

我有一个 CPP 文件。我在 VS2005 中使用 VB。我已经使用`FileSystemObject`. 我正在阅读该 CPP 文件中的每一行。在遇到返回语句之前，我必须注释所有行。我正在使用`scripting.textstream`从 CPP 文件中读取一行。但是我不知道如何`//`在我阅读的每一行的开头添加注释，甚至是从开头到返回语句的多行注释。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T09:23:30.463

您似乎使用的`FileSystemObject`是 Windows 脚本运行时而不是 System.IO.File 类的方法。奇怪的！

静态`System.IO.File.ReadAllLines()`将读取一个文件（并关闭它）并返回一个包含所有行的字符串数组。然后，您可以遍历数组并为每一行添加注释（除非该行以 开头`return`）。

最后，使用任何方法将更改的文本保存到文件中`WriteAllLines()`，从而覆盖任何包含的文本。

在开始时添加多行注释会更容易，您不需要将行读入数组。

# ftp - 使用 FTP 上传到大型机

> ID：934089
> 
> 赞同：3
> 
> 时间：2009-06-01T09:13:22.213
> 
> 标签：ftp, mainframe

我只想知道您如何上传指定其特征的数据集？EG 使用命令引用站点 lrecl=500 recfm=fb

好吧，当我尝试使用该命令时，它被接受了，但问题是当我尝试使用“发送”命令上传文件时，ftp 挂断，并且 definitley 关闭了会话。

这是示例：[http ://www.mvsforums.com/helpboards/recent.php?sid=dab6b1f3cda149c7d7db855d90acaab1](http://www.mvsforums.com/helpboards/recent.php?sid=dab6b1f3cda149c7d7db855d90acaab1)

```
ftp> quote site lrecl=500 recfm=fb
200 SITE command was accepted
ftp> send C:\test\test.txt 'ADM.SAMPLE.TEST'
200 Port request OK.
425 Can't open data connection.
ftp> 
```

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T09:33:20.083

在尝试在路由器后面进行 ftp 时，我有时会因为防火墙问题而收到此错误。您可以尝试切换到[主动或被动模式](http://slacksite.com/other/ftp.html)（取决于您当前使用的模式），看看这是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T15:15:19.830

我有几个程序可以做到这一点，但没有指定记录大小。阻塞命令应该没问题。你确定你没有权限问题？ADM.SAMPLE.TEST 是否已经存在，是否至少有 500 个字节？如果没有，让他们为您创建它，然后查看 ftp 是否有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-09T05:22:58.927

您应该能够使用 site 命令指定数据集分配参数。

站点 u=SYSDA rec=VB lr=6144 blk=0 ucount=2 tr pri=3000 sec=200

这转化为：

*   单位=SYSDA
*   记录格式=变量块
*   逻辑记录长度=6144
*   块大小=0
*   单位数=2
*   轨道（分配单位）
*   主空间=3000
*   二级空间=200

# php - PHP 中的 SOAP 替换/解决方法/库

> ID：934095
> 
> 赞同：0
> 
> 时间：2009-06-01T09:15:52.523
> 
> 标签：php, web-services, soap, wsdl

我固执己见，正在构建我自己的基于 PHP 的 CMS 和框架（命名为 RAmen/ [FSM](http://venganza.org)只是为了好玩），已经为我的客户部署了多次。现在，我将为它开发一个支持票证应用程序，我将部署在一个“中央”服务器上以便于维护。

现在，我研究了 SOAP 服务并且很高兴，直到我开始使用 PHP 及其本身生成 WSDL。那么，您会建议我在客户端（`$support->newTicket`）使用类似 SOAP 的简单性来“安全地”（例如，没有 https）管理它，而不会在服务器端出现 WSDL 问题？或者我应该——喘气——不要再这么固执了，直接使用 PHP 库（在这种情况下，请推荐！）

谢谢你们，意大利面食爱好者/sagnostic 编码员！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T12:10:55.647

PHP 有一个[本地 SOAP 扩展](http://www.php.net/manual/en/class.soapserver.php)，它可以自动执行客户端和服务器。在某些地方它有点小车，但仍然比 nusoap（恕我直言）好。

也就是说，如果我对这个决定有任何影响，我永远不会选择 SOAP。使用 xml-rpc 或基于休息的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T09:23:23.117

我有一个类似的问题，是使用 REST 还是 SOAP。我正在使用 REST，但那是因为我想要一个简单的 API，比如函数，而不是与 REST 相关的刚性功能。

这里说的是一个不错的小库，可以帮助您开始使用 SOAP

[http://sourceforge.net/projects/nusoap/](http://sourceforge.net/projects/nusoap/)

听起来 SOAP 实际上就是您想要的。当您从 WSDL 获得域模型时，您会发现它更容易实现。

# sql - 清除表后表大小未减小

> ID：934098
> 
> 赞同：0
> 
> 时间：2009-06-01T09:16:50.273
> 
> 标签：sql, sql-server, database, diskspace

我最近对我的应用程序表执行了清除操作。总记录为 110 万，使用的磁盘空间为 11.12GB。

我已经删除了 860k 条记录并保留了 290k 条记录，但为什么我使用的空间只下降到 11.09GB？

我监视**报告的详细信息-磁盘使用情况-数据文件使用的磁盘空间-使用的空间**。

我需要执行收缩数据文件吗？这让我困惑了很久。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T09:33:33.703

对于 MS SQL Server，重建聚集索引。

您只删除了行：没有回收空间。

[DBCC DBREINDEX](http://msdn.microsoft.com/en-us/library/ms181671.aspx)或[ALTER INDEX ... WITH REBUILD](http://msdn.microsoft.com/en-us/library/ms188388.aspx)取决于版本

（这是 MS SQL，因为磁盘空间报告在 SSMS 中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T09:19:44.963

您需要显式调用一些将缩小数据文件的操作（特定于您的数据库管理系统）。当您删除记录时，数据库引擎不会收缩文件，这是出于优化目的 - 收缩非常耗时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T09:20:04.057

我认为这就像 Thunderbird 中的邮件文件夹：如果您删除某些内容，它只会被标记为已删除，但为了获得更高的性能，空间并没有被释放。因此，您的 11.09 GB 中的大部分现在将包含您的旧数据或 0。收缩数据文件将通过创建一个仅包含剩余实际数据的新文件来“压缩”（或“清理”）它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T09:20:22.137

可能您需要缩小表格。我知道 SQL Server 默认情况下不会为您执行此操作，我猜这是出于性能原因，也许其他数据库是相同的。

# c# - 如何在 C# 中像 VS 一样保存每 10 秒的备份文件以在断电时恢复数据

> ID：934101
> 
> 赞同：1
> 
> 时间：2009-06-01T09:19:10.487
> 
> 标签：c#

我想在 c# 中使用序列化将备份文件每 10 秒保存一次到特定路径（如 VS 保存备份文件并在断电时打开该文件后询问“恢复文件”）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T09:22:42.430

添加一个每 10 秒触发一次的计时器。拍摄数据的内存快照，然后在后台将其保存到磁盘。确保在保存时保存到新文件，并且仅在新文件成功写入后才删除旧备份：

*   第 1 步：在开始编写新的备份之前：

    ```
    file.backup (old back-up) 
    ```

*   第 2 步：编写新的备份：

    ```
    file.backup (old)
    file.tmp (new) 
    ```

*   第 3 步：重命名旧备份：

    ```
    file.backup.old (old)
    file.tmp (new) 
    ```

*   第 4 步：重命名新备份：

    ```
    file.backup.old (old)
    file.backup (new) 
    ```

*   第 5 步：删除旧备份：

    ```
    file.backup (new) 
    ```

当您恢复时，您需要考虑所有这些 - 特别是当您看到第 3 步时，确定您是要使用旧备份还是新备份。

您可能希望通过在进行任何写入之前检查是否有任何实际更改来使这更加复杂......并且可能还考虑使计时器略长于 10 秒。我怀疑大多数人不介意失去一分钟的工作......

# java - java新手问题：更丰富的java子进程

> ID：934110
> 
> 赞同：1
> 
> 时间：2009-06-01T09:23:00.650
> 
> 标签：java, jvm

我想生成一个子进程 Java 虚拟机（通过 Java API 调用）并与之通信。

也许我只是没有在 Google 上寻找正确的东西，但我一直被指向 Runtime.exec()，这不是我想要的。我知道我可以连接标准输入/输出并使用各种序列化技术，或使用远程方法调用，但这些似乎很麻烦/重量级。似乎 API 调用可能比尝试调用 Runtime.exec("/usr/bin/java -cp [system.getclasspath] ...") 更强大。

这样做的目的/动机是动态重新加载具有许多依赖项的类似乎有些棘手（一些网站提到读取 .class 文件并将其传递给 [ClassLoader].defineClass，但这并不能很好地处理依赖类文件的加载）。如果我不需要太多的通信带宽或低延迟，我认为一个新的 JVM 实例可以正常工作；只是与它的交流似乎很麻烦。无论如何，这个问题都不是高优先级的。我可能会走直截了当的路线，看看如何加载依赖的类文件（例如，用于内部类的文件）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T09:35:56.037

只要您要加载的类位于与主应用程序分开的 JAR 文件或目录树中，使用 URLClassLoader 并在单独的线程中运行它们就可以正常工作。AFAIK 所有的 Java 应用程序服务器都是这样工作的，所以这绝对是一种经过验证的技术。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T15:20:18.450

我肯定会推荐看看[Tomcat servlet 容器](http://tomcat.apache.org/svn.html)使用的类加载器机制——它们似乎有**完全相同**的类加载问题并且似乎已经很好地解决了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T15:40:08.997

如果你走通信路线，你应该考虑[Java RMI](http://java.sun.com/javase/technologies/core/basic/rmi/index.jsp)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-03T20:09:32.793

**ClassRunner**（如下面的清单所示）使用**ProcessBuilder**运行类路径中任何可用类的*主*函数，使用与当前 JVM 相同的类路径和库路径。它甚至会克隆当前 JVM 的环境和工作目录。

警告：**ClassRunner**假定它`java`位于`PATH`当前 JVM 上。您可能希望围绕定位`java`或`java.exe`基于`System.getProperty("java.home")`:)

*ClassRunner.java*清单：

```
import java.io.BufferedReader;
import java.io.InputStreamReader;

public class ClassRunner
{
    private final Class<?> classToRun;

    public ClassRunner(Class<?> classToRun)
    {
        this.classToRun = classToRun;
    }

    public void run(String... args) throws Exception
    {
        String javaCommand = "java";
        String libraryPath = "-Djava.library.path=\"" + System.getProperty("java.library.path") + "\"";
        String classpath = "\"" + System.getProperty("java.class.path") + "\"";
        ProcessBuilder processBuilder = new ProcessBuilder(javaCommand,
                libraryPath,
                "-classpath", classpath,
                classToRun.getCanonicalName());
        processBuilder.redirectErrorStream();

        for (String arg : args) processBuilder.command().add(arg);
        Process process = processBuilder.start();
        BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = reader.readLine()) != null) System.out.println(line);
        reader.close();
        process.waitFor();
    }

    public static void main(String[] args) throws Exception
    {
        new ClassRunner(Main.class).run("Hello");
    }
} 
```

*Main.java*清单：

```
public class Main
{
    public static void main(String... args)
    {
        System.out.println("testing Main");
        for (String arg : args) System.out.println(arg);
    }
} 
```

# windows-mobile - 在 Windows Mobile Contact 中扩展上下文菜单

> ID：934115
> 
> 赞同：1
> 
> 时间：2009-06-01T09:25:39.163
> 
> 标签：windows-mobile, compact-framework, opennetcf

我想在 windows mobile 中扩展联系人上下文菜单。当用户右键单击带有拨号和其他功能的联系人时，我想扩展并添加我自己的项目以执行我的自定义程序左右。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T09:57:44.060

如果您安装了[Windows Mobile 5 SDK](http://www.microsoft.com/Downloads/details.aspx?FamilyID=83a52af2-f524-4ec5-9155-717cbe5d25ed&displaylang=en)，您会发现一些相关示例：

C:\Program Files\Windows Mobile 5.0 SDK\Samples\Pocket PC\CPP\Win32

*   电话卡
*   收件箱菜单可扩展性
*   ReadViewMenuExt

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-03T13:56:37.427

我在这里找到了另一个[例子](http://www.ceveni.com/2009/10/sample-code-for-context-menu-in-c.html)，我认为这对你有用

```
// Initialize the below code snippet in the beginning of the class
internal struct SHRGINFO
{
public int cbSize;
public IntPtr hwndClient;
public int ptDownX;
public int ptDownY;
public SHRGFLags dwFlags;
}

[Flags]
internal enum SHRGFLags
{
SHRG_RETURNCMD = 0x00000001,
SHRG_NOTIFYPARENT = 0x00000002,
SHRG_LONGDELAY = 0x00000008,
SHRG_NOANIMATION = 0x00000010,
}
[DllImport("aygshell")]
extern private static int SHRecognizeGesture(ref SHRGINFO shr);

[DllImport("coredll.dll", SetLastError = true)]
public static extern IntPtr GetActiveWindow();

//call the showContMenu() method in Mouseup or MouseDown event
public void showContMenu(int x, int y)
{
SHRGINFO shr = new SHRGINFO();
shr.cbSize = Marshal.SizeOf(typeof(SHRGINFO));
shr.dwFlags = SHRGFLags.SHRG_RETURNCMD;
shr.ptDownX = x;
shr.ptDownY = y;
shr.hwndClient = GetActiveWindow();

int ret = SHRecognizeGesture(ref shr);

if (ret == 1000)
contextMenu1.Show(this, new System.Drawing.Point(x, y));

} 
```

# python - 通过 Python 比较 SQL 中的数据

> ID：934117
> 
> 赞同：0
> 
> 时间：2009-06-01T09:27:51.157
> 
> 标签：python, sql

我必须解析一个非常复杂的转储（无论它是什么）。我已经通过 Python 完成了解析。由于解析的数据量非常大，我必须将其输入数据库（SQL）。我也做过这个。现在问题是我必须比较 SQL 中现在存在的数据。

实际上我必须将第一个转储的数据与第二个转储的数据进行比较。两个转储具有相同的字段（属性），但它们的字段值可能不同。所以我必须检测到这种变化。为此，我必须进行比较。但是我不知道如何使用 Python 作为我的前端来完成这一切。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T20:53:28.773

如果你没有`MINUS`or `EXCEPT`，还有这个，它将使用`UNION`/`GROUP BY`技巧显示所有不匹配的行

```
SELECT MAX(table), data1, data2
FROM (
    SELECT 'foo1' AS table, foo1.data1, foo1.data2 FROM foo1
    UNION ALL
    SELECT 'foo2' AS table, foo2.data1, foo2.data2 FROM foo2
) AS X
GROUP BY data1, data2
HAVING COUNT(*) = 1
ORDER BY data1, data2 
```

我有一个通用表比较 SP，它还可以与左右连接和内部连接以及货币阈值（或阈值百分比）和子集标准进行更复杂的表比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T13:11:42.327

为什么不在 SQL 中进行“检测更改”？就像是：

```
select foo.data1, foo.data2 from foo where foo.id = 'dump1'
minus
select foo.data1, foo.data2 from foo where foo.id = 'dump2' 
```

# .net - 从 SerialPort 同步读取单个字节？

> ID：934118
> 
> 赞同：1
> 
> 时间：2009-06-01T09:28:24.027
> 
> 标签：.net, serial-port

我正在尝试一次从串行端口读取一个字节。我的控制台应用程序中有以下代码：

```
// Open the serial port in 115200,8N1
using (SerialPort serialPort = new SerialPort("COM1", 115200,
                                              Parity.None, 8,
                                              StopBits.One))
{
    serialPort.Open();

    for (; ; )
    {
        int result = serialPort.ReadByte();
        if (result < 0)
            break;

        Console.WriteLine(result);
    }
} 
```

我期待它循环，将接收到的字节转储到屏幕上（暂时忽略它们将被打印为整数；我稍后会处理）。

但是，它只是阻塞了 ReadByte 调用，没有任何反应。

我知道我的串行设备正在工作：如果我使用 Tera Term，我会看到数据。如果我使用`DataReceived`事件并调用`SerialPort.ReadExisting`，那么我可以看到数据。

但是，我并不担心性能（至少现在还没有），而且我正在实现的协议在同步处理时效果更好。

所以：我做错了什么？为什么不`ReadByte`回来？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-04-30T07:41:14.947

您可以通过执行以下操作使异步行为看起来是同步的，并`WaitForData()`在每次读取之前调用：

```
static SerialPort port;
static AutoResetEvent dataArrived = new AutoResetEvent(false);

static void Main(string[] args) {
  port = new SerialPort(...);
  port.DataReceived += new SerialDataReceivedEventHandler(port_DataReceived);
  port.Open();
  WaitForData(1000);
  int data = port.ReadByte();
  Console.WriteLine(data);
  Console.ReadKey();
}

static void WaitForData(int millisecondsTimeout) {
  dataArrived.WaitOne(millisecondsTimeout);
}

static void port_DataReceived(object sender, SerialDataReceivedEventArgs e) {
  dataArrived.Set();      
} 
```

这个答案不像发现和解决潜在问题那样“正确”，但可能是解决方法的基础。

我在 SerialPort 类中看到了一些奇怪的事情，包括您描述的行为。请记住，在辅助线程上调用 DataReceived 事件（请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.datareceived.aspx "MSDN 链接")）。使用 Monitor.Wait() 和 .Pulse() 的 lock() 语义可以获得更好的性能，如此处[所述](https://stackoverflow.com/questions/1355398/monitor-vs-waithandle-based-thread-sync/1355415#1355415)

如果你很懒惰，你也可以尝试在调用 ReadByte 之前插入一个 Thread.Sleep() 行（例如 200 毫秒），看看它是否有所作为。我也可以发誓我曾经看到一个案例，在控制台应用程序中阻塞 ReadByte() 的 SerialPort 被移植到 WinForms 应用程序，没有有意义的代码更改，问题就消失了。没有机会彻底调查，但你可以看看你在 WinForms 下是否有更好的运气，然后从那里进行故障排除。

这个答案有点晚了，但我想我会为下一个在这个问题上遇到困难的人插话。

**编辑：**这是一个方便的`WaitForBytes(count, timeout)`扩展方法，可以很好地过滤掉您描述的“无限阻塞”行为。

用法是：`port.WaitForBytes(1)`等待1个字节的数据到达。或者为了减少开销，请 `SerialPortWatcher.WaitForBytes(n)`改用。

```
using System;
using System.Diagnostics;
using System.IO.Ports;
using System.Threading;

public static class SerialPortExtensions {

  /// <summary>
  /// Wait for a specified number of bytes to arrive on the serial port, or until a timeout occurs.
  /// </summary>
  /// <param name="port">Serial port on which bytes are expected to arrive.</param>
  /// <param name="count">Number of bytes expected.</param>
  /// <param name="millisecondsTimeout">Maximum amount of time to wait.</param>
  /// <exception cref="TimeoutException">Thrown if <paramref name="count"/> bytes are not received
  /// within <paramref name="millisecondsTimeout"/> milliseconds.</exception>
  /// <exception cref="ArgumentNullException">Thrown if <paramref name="port"/> is null.</exception>
  /// <exception cref="ArgumentOutOfRangeException">Thrown if either <paramref name="count"/> or
  /// <paramref name="millisecondsTimeout"/> is less than zero.</exception>
  /// <exception cref="InvalidOperationException">Thrown if the serial port is closed.</exception>
  /// <remarks>This extension method is intended only as an ad-hoc aid.  If you're using it a lot,
  /// then it's recommended for performance reasons to instead instantiate a
  /// <see cref="SerialPortWatcher"/> instance for the lifetime of your SerialPort.</remarks>
  public static void WaitForBytes(this SerialPort port, int count, int millisecondsTimeout) {

    if (port == null) throw new ArgumentNullException("port");
    if (port.BytesToRead >= count) return;

    using (var watcher = new SerialPortWatcher(port)) {
      watcher.WaitForBytes(count, millisecondsTimeout);
    }

  }

  /// <summary>
  /// Wait for a specified number of bytes to arrive on the serial port, or until a timeout occurs.
  /// </summary>
  /// <param name="port">Serial port on which bytes are expected to arrive.</param>
  /// <param name="count">Number of bytes expected.</param>
  /// <exception cref="ArgumentNullException">Thrown if <paramref name="port"/> is null.</exception>
  /// <exception cref="ArgumentOutOfRangeException">Thrown if either <paramref name="count"/> or
  /// <paramref name="millisecondsTimeout"/> is less than zero.</exception>
  /// <exception cref="InvalidOperationException">Thrown if the serial port is closed.</exception>
  /// <exception cref="TimeoutException">Thrown if <paramref name="count"/> bytes are not received
  /// within the number of milliseconds specified in the <see cref="SerialPort.ReadTimeout"/> property
  /// of <paramref name="port"/>.</exception>
  /// <remarks>This extension method is intended only as an ad-hoc aid.  If you're using it a lot,
  /// then it's recommended for performance reasons to instead instantiate a
  /// <see cref="SerialPortWatcher"/> instance for the lifetime of your SerialPort.</remarks>
  public static void WaitForBytes(this SerialPort port, int count) {
    if (port == null) throw new ArgumentNullException("port");
    WaitForBytes(port, count, port.ReadTimeout);
  }

}

/// <summary>
/// Watches for incoming bytes on a serial port and provides a reliable method to wait for a given
/// number of bytes in a synchronous communications algorithm.
/// </summary>
class SerialPortWatcher : IDisposable {

  // This class works primarilly by watching for the SerialPort.DataReceived event.  However, since
  // that event is not guaranteed to fire, it is neccessary to also periodically poll for new data.
  // The polling interval can be fine-tuned here.  A higher number means less wasted CPU time, while
  // a lower number decreases the maximum possible latency.
  private const int POLL_MS = 30;

  private AutoResetEvent dataArrived = new AutoResetEvent(false);
  private SerialPort port;

  public SerialPortWatcher(SerialPort port) {
    if (port == null) throw new ArgumentNullException("port");
    this.port = port;
    this.port.DataReceived += new SerialDataReceivedEventHandler(port_DataReceived);
  }

  public void Dispose() {
    if (port != null) {
      port.DataReceived -= port_DataReceived;
      port = null;
    }
    if (dataArrived != null) {
      dataArrived.Dispose();
      dataArrived = null;
    }
  }

  void port_DataReceived(object sender, SerialDataReceivedEventArgs e) {

    // This event will occur on a secondary thread.  Signal the waiting thread (if any).
    // Note: This handler could fire even after we are disposed.

    // MSDN documentation describing DataReceived event:
    // http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.datareceived.aspx

    // Links discussing thread safety and event handlers:
    // https://stackoverflow.com/questions/786383/c-events-and-thread-safety
    // http://www.codeproject.com/Articles/37474/Threadsafe-Events.aspx

    // Note that we do not actually check the SerialPort.BytesToRead property here as it
    // is not documented to be thread-safe.

    if (dataArrived != null) dataArrived.Set();

  }

  /// <summary>
  /// Blocks the current thread until the specified number of bytes have been received from the
  /// serial port, or until a timeout occurs.
  /// </summary>
  /// <param name="count">Number of bytes expected.</param>
  /// <param name="millisecondsTimeout">Maximum amount of time to wait.</param>
  /// <exception cref="ArgumentOutOfRangeException">Thrown if either <paramref name="count"/> or
  /// <paramref name="millisecondsTimeout"/> is less than zero.</exception>
  /// <exception cref="InvalidOperationException">Thrown if the serial port is closed, or if this
  /// <see cref="SerialPortWatcher"/> instance has been disposed.</exception>
  /// <exception cref="TimeoutException">Thrown if <paramref name="count"/> bytes are not received
  /// within the number of milliseconds specified in the <see cref="SerialPort.ReadTimeout"/> property
  /// of <paramref name="port"/>.</exception>
  public void WaitForBytes(int count, int millisecondsTimeout) {

    if (count < 0) throw new ArgumentOutOfRangeException("count");
    if (millisecondsTimeout < 0) throw new ArgumentOutOfRangeException("millisecondsTimeout");
    if (port == null) throw new InvalidOperationException("SerialPortWatcher has been disposed.");
    if (!port.IsOpen) throw new InvalidOperationException("Port is closed");

    if (port.BytesToRead >= count) return;

    DateTime expire = DateTime.Now.AddMilliseconds(millisecondsTimeout);

    // Wait for the specified number of bytes to become available.  This is done primarily by
    // waiting for a signal from the thread which handles the DataReceived event.  However, since
    // that event isn't guaranteed to fire, we also poll for new data every POLL_MS milliseconds.
    while (port.BytesToRead < count) {
      if (DateTime.Now >= expire) {
        throw new TimeoutException(String.Format(
          "Timed out waiting for data from port {0}", port.PortName));
      }
      WaitForSignal();
    }

  }

  // Timeout exceptions are expected to be thrown in this block of code, and are perfectly normal.
  // A separate method is used so it can be marked with DebuggerNonUserCode, which will cause the
  // debugger to ignore these exceptions (even if Thrown is checkmarked under Debug | Exceptions).
  [DebuggerNonUserCode]
  private void WaitForSignal() {
    try {
      dataArrived.WaitOne(POLL_MS);
    } catch (TimeoutException) { }
  }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T14:06:18.737

我认为当缓冲区中没有数据时，您的循环在第一次运行时（开始时）会中断。

```
if (result < 0)
    break; 
```

后来的循环没有运行，您在控制台上看不到任何数据。

# javascript - 在没有查询字符串参数的情况下使用 Google Analytics 跟踪广告系列？

> ID：934119
> 
> 赞同：44
> 
> 时间：2009-06-01T09:28:57.283
> 
> 标签：javascript, google-analytics

Google Analytics 中是否有一种支持的方式来跟踪广告系列而无需使用查询字符串参数。

在 Analytics 中，您可以使用查询字符串参数[标记指向您网站的链接，](http://www.google.com/support/analytics/bin/answer.py?hl=en&answer=55518)`utm_campaign`这些参数`utm_medium`包含有关活动的信息，以便对其进行跟踪。

Google 实际上有一个[在线工具](http://www.google.com/support/analytics/bin/answer.py?answer=55578&hl=en)来帮助创建此类链接。

例如，如果 StackOverflow 在 Experts Exchange 上做广告，他们可能会有这样的链接：

[http://www.stackoverflow.com/?utm_source=expertexchange&utm_medium=banner&utm_campaign=a-better-expert-exchange](http://www.stackoverflow.com/?utm_source=expertexchange&utm_medium=banner&utm_campaign=a-better-expert-exchange)

由于许多原因，我不希望这些看起来笨拙的参数出现在我的 URLS 中：

*   我想鼓励发推特，而长链接不鼓励这样做
*   我不希望人们用活动 ID 为它们添加书签
*   我希望人们看到一个干净的 URL
*   我不希望搜索引擎索引这些链接。
*   我希望完全控制发送到谷歌分析的参数 - 而不是让我的合作伙伴搞乱他们访问我网站的 URL

不久前，我试图找到一种可以设置这些参数的方法。[Google 有一个页面](http://code.google.com/apis/analytics/docs/gaJS/gaJSApiCampaignTracking.html)，乍一看像是解决方案，但实际上并非如此。该页面描述了如何将查询字符串参数的名称更改为其他名称 - 例如使用`src`而不是`utm_source`运行：

```
 pageTracker._setCampSourceKey("src"); 
```

我似乎真的无法弄清楚为什么他们不能轻松地明确设置`utm_source`键的值 - 而不仅仅是为它设置一个替代参数名称。

我记得前段时间找到了一个有一种讨厌的黑客的人，但我现在似乎找不到了。我似乎记得，不管是谁拿到了分析代码的副本，基本上都将其分支出来并对其进行了黑客攻击。这对我来说不是一个好的解决方案！

有没有官方支持的方式来做到这一点，没有某种讨厌的重定向。

简而言之，我想做这样的事情（ASP.NET MVC 站点）。使用这样的 URL 为我的网站提供一个链接：

```
 http://www.example.com/?cid=2dae88a8-66b1-475d-8a35-2978bd1a158c 
```

在我的 MVC 页面的控制器中，我会找出这个 GUID 与什么活动相关，并设置模型状态。注意：这给了我一个优势，我可以更改活动参数而无需重新发布 URL。

在页面本身中，我会这样做：

```
var campaignMedium = <%= ViewData.Model.CampaignMedium %>;
var campaignSource = <%= ViewData.Model.CampaignSource %>;
var campaignName = <%= ViewData.Model.CampaignName %>;

pageTracker._setCampaignData({
    utm_source: campaignSource,
    utm_medium: campaignMedium,
    utm_campaignName: campaignName
});
pageTracker._trackPageview(); 
```

**重要提示：此 _setCampaignData 方法实际上并不存在。这只是我希望能够做的“伪代码”。**

有没有人成功地做到了这样的事情？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2010-11-02T22:16:37.467

## _set 活动参数

您的理论“_setCampaignData”最终以以下形式存在`["_set","campaignParams",...]`

如果您有办法以编程方式注入您想要设置的值（例如，由 cookie 在重定向或服务器端设置并打印到页面上），您可以使用`_set`API 对您要设置的广告系列参数。

其格式只是：

```
_gaq.push(['_set', 'campaignParams', 
'utm_campaign=CAMPAIGN&utm_source=SOURCE&utm_medium=MEDIUM']); 
```

因此，使用您的原始示例：

```
 var campaignMedium = <%= ViewData.Model.CampaignMedium %>;
 var campaignSource = <%= ViewData.Model.CampaignSource %>;
 var campaignName = <%= ViewData.Model.CampaignName %>;
 _gaq.push(['_set', 'campaignParams', 
'utm_campaign=' + campaignName +  '&utm_source=' + campaignSource +'&utm_medium=' + campaignMedium]); 
```

## 2017 年更新

[此答案](https://stackoverflow.com/a/35624890/172322)详细说明了如何使用较新的 Google Analytics 库analytics.js/Universal Analytics 来完成此任务。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-02T08:35:03.107

Török Gábor 给了我一个想法。

```
// ...
var campaignMedium = <%= ViewData.Model.CampaignMedium %>;
var campaignSource = <%= ViewData.Model.CampaignSource %>;
var campaignName = <%= ViewData.Model.CampaignName %>;

// save the old hash
var oldHash = document.location.hash;

// add campaign data to the hash
document.location.hash = 'utm_source=' + escape(campaignSource) + ...;
pageTracker._setAllowAnchor(true);
pageTracker._trackPageview();
// restore the old hash:
document.location.hash = oldHash; 
```

这样，您可以在后端创建活动数据，然后将其动态传递给哈希，然后在用户甚至没有注意到它的情况下恢复它。即活动跟踪 100% 独立于真实 URL。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-02-25T10:38:09.030

[使用 push(['_set', 'campaignParams',...](https://stackoverflow.com/a/4082585/5118762)的解决方案似乎只适用于[遗留库 ga.js](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCampaigns?hl=de)。

使用 analytics.js，您需要单独指定活动参数。例如

```
ga('set', 'campaignName', 'TheCampaignName...');
ga('set', 'campaignSource', 'someCampaignSource');
ga('set', 'campaignMedium', 'email'); 
```

[https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference#campaignName](https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference#campaignName)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-01T12:40:42.733

Trackin API 中有一个函数[`_setAllowAnchor`](http://code.google.com/apis/analytics/docs/gaJS/gaJSApi.html#_gat.GA_Tracker_._setAllowAnchor)允许您在锚文本中指定标签，而不是作为查询参数。

```
pageTracker._setAllowAnchor(true); 
```

所以你可以使用`http://www.stackoverflow.com/#utm_source=expertexchange`，GA 会理解它。这样就可以避免 SEO 问题。

对于 Twitter 问题，我建议您使用[Tracking Twitter and Shorten URLs in Google Analytics 中](http://blog.avangate.com/twitter-analytics-love/)描述的方法。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-07-21T15:31:35.320

我将此发布到 Google 帮助论坛。

谷歌请阅读！！！很大的提升机会！！！这导致很多用户无法使用广告参数。允许从 trackPageview(url) 上使用的 URL 读取广告参数。

无论如何，如果没有这种能力，我不得不使用一种变通方法。而不是将参数附加到 URL。我暂时将它们作为书签附加到 URL。然后我在 trackPageview 调用后删除了它们。通过将它们添加为书签，页面不会重新加载。请参阅以下示例。

```
var pageTracker = _gat._getTracker(param);
var orighash = document.location.hash;
if (orighash == "") {
    orighash = "none";  // this is done to prevent page scrolling
}
document.location.hash = 'utm_source='+source+'&utm_campaign='+campaign+'&utm_medium='+medium+'&utm_content='+content;
pageTracker._setAllowAnchor(true);
pageTracker._trackPageview();
document.location.hash = orighash 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-02-19T21:38:16.373

以下是使用 Google Analytics 通用事件跟踪方法而不是 GA 标准事件跟踪的更新方法。

整个 UTM 字符串可以从 queryString 中提取（如果有）或从 Google cookie (__utmz) 中提取，然后使用以下代码传递给 Google Analytics。

```
ga('send', 'event', 'queryString', 'getQueryString', googleString ); 
```

然后，在执行您想要创建的任何触发器时（我使用名为“widgetTracker”的函数），您可以执行 GA 事件跟踪器。

这是整个代码：

```
/* JavaScript Document */
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-xxxxxxx-xx', 'xx.xxx');
  ga('send', 'pageview');

 var googleString;  
 var stringArray = [];  
 var queryStringObject = makeQueryStringObject();   
 var QUOT = "'";    
 var EQ = '=';  
 var AMP = '&';         

 for  ( var v in queryStringObject ) {  
    var str =  v + EQ + queryStringObject[v] ;  
    stringArray.push(str);   
    googleString = stringArray.join(AMP);
} 

         function makeQueryStringObject()   {       
            var obj = [];       
            var pageURL = window.location.href;         
            var URLArray = pageURL.split('?');      
            if( URLArray[1] )       {           
                var argsArray = URLArray[1].split('&');             
                var l = argsArray.length;           
                for( i=0; i<l; i++ )            {               
                    var individualArg = argsArray[i].split('=');                
                    if(individualArg[1] && individualArg[1].indexOf('#') > -1)              {               
                        var dropHashArray = individualArg[1].split('#');                    
                        individualArg[1] = dropHashArray[0];                
                    }               
                    obj[ individualArg[0] ] = individualArg[1];     
                    console.log("value of queryStringObject: " + individualArg[0] + " :: " + obj[   individualArg[0] ]);

                }       
            } else { /* from http://stackoverflow.com/a/14984832/1013405 */         
                ga1 = parseGACookie();  
                if(ga1['utmcsr']) {             
                    var utm_source = ga1['utmcsr'];                     
                }           
                    if(ga1['utmccn']) {             
                        var utm_campaign = ga1['utmccn'];                   
                    }           if(ga1['utmcmd']) {             
                        var utm_medium = ga1['utmcmd'];                 
                        }           
                        if(ga1['utmctr']) {             
                            var utm_term = ga1['utmctr'];                           
                        }           
                        if(ga1['utmcct']) {             
                            var utm_content = ga1['utmcct'];                
                        }       
                    }   
                        var googleString2 = "utm_campaign=" + utm_campaign + '&' + "utm_medium=" + utm_medium + '&' + "utm_term=" + utm_term + '&' + "utm_content=" + utm_content;  
                    return obj;     
                } 

                function parseGACookie()  {     
                var values = {};     
                var cookie = readCookie("__utmz");     
                if (cookie) {         
                    var z = cookie.split('.');         
                    if (z.length >= 4) {             
                        var y = z[4].split('|');            
                         for (i=0; i<y.length; i++) {                 
                            var pair = y[i].split("=");                 
                            values[pair[0]] = pair[1];             
                         }         
                        }     
                    }     
                    return values; 
                }  

                function readCookie(name) {     
                    var nameEQ = name + "=";     
                    var ca = document.cookie.split(';');     
                    for(var i=0;i < ca.length;i++) {        
                     var c = ca[i];        
                      while (c.charAt(0)==' ') c = c.substring(1,c.length);         
                      if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);     
                    }     
                    return null; 
                }  
                function widgetTracker() {  
                /* event tracking order of elements: send (required), event (required), Category, Action, Label, Value */ 
                    if (googleString) { 
                    ga('send', 'event', 'queryString', 'getQueryString', googleString ); 
                    } else { 
                     ga('send', 'event', 'queryString2', 'getQueryString2', googleString2 ); 
                     }
                } 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-01T12:09:40.597

好吧，我没有测试它，但尝试将这些参数添加到`.trackPageview()`方法中，即：

```
pageTracker._trackPageview("?utm_source=...") 
```

无论如何，您必须以某种方式传递这些参数。这意味着，您总是会有很长的 URL-s，其中包含某种活动废话。它不会阻止为错误的 URL 添加书签、搜索引擎将它们编入索引等。

如果您想保持对这些参数的控制，请为合作伙伴设置单独的 URL-s，以重定向到标记的目标 URL：

```
http://example.com/campaigns/1 -> http://example.com/?utm_source=... 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-01T12:38:02.020

在您的示例中，您可以使用 Google Analytics API 自定义对 _trackPageview 的调用。

```
pageTracker._trackPageview("/inbound/" + campaignSource + "/" + campaignMedium ); 
```

然后，所有入站链接将显示在 /inbound/“伪目录”下的 Google Analytics 中，其中包含用于广告系列来源和广告系列媒介的单独“目录”。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-11-01T02:18:41.907

新的（ER）通用分析允许您指定这些参数 - 请参阅此处的文档[https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference](https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference)

查找“Campaign Source”部分以获取设置 utm_source 参数的示例。

# javascript - javascript 幻灯片 slick_accessible_slideshow

> ID：934120
> 
> 赞同：0
> 
> 时间：2009-06-01T09:29:02.683
> 
> 标签：javascript, jquery, html, css, dhtml

我在一个 HTML 页面中有三个 div。页面看起来像这样

HTML页面：

```
 leftArrow(>)   div   rightArrow(<) 
```

我需要从左到右和从右到左移动 div。使用 javascript 和 DHTMl

或 jQuery。

有可能朝那个方向移动吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T09:43:09.690

是的，这是可能的，我过去没有使用 jQuery 就完成了。

我有以下标记：

```
<div id="HorThumbs" style="overflow:hidden;width:500px">
  <div id="HorScroller" style="width:1000px">
    //Data to be shown
  </div>
</div>

var scrollStep=1;
var timerLeft,timerRight="";
function scrollDivLeft(id){
  clearTimeout(timerRight);
  document.getElementById(id).scrollLeft-=scrollStep;
  timerRight=setTimeout("scrollDivLeft('"+id+"')",1);
}

function scrollRight(id){
  clearTimeout(timerLeft);
  document.getElementById(id).scrollLeft+=scrollStep;
  timerLeft=setTimeout("scrollRight('"+id+"')",1);
} 
```

然后向左右箭头添加一个 MouseOver 事件，将“HorThumbs”作为 Id 传递给 scrollDivLeft 或 scrollDivRight 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T10:50:17.230

看看[jQuery 循环插件](http://malsup.com/jquery/cycle/)。它将向左/向右滚动并允许上一个/下一个按钮。

# design-patterns - 成本装饰师

> ID：934124
> 
> 赞同：0
> 
> 时间：2009-06-01T09:29:50.607
> 
> 标签：design-patterns, decorator, strategy-pattern

对于每个产品，都有相关的成本计算器，如：折扣、商家折扣、商家奖金、每月折扣等。未来，将添加更多成本计算器。

对于每个成本计算，我们都有一个具体的产品类别和许多装饰器。所有产品都应使用所有计算器，因为计算器决定根据产品属性（如产品商家 ID、类别 ID、颜色等）应用其计算。

而且，我们的系统中有数百万种产品需要计算。所以，我们最好缓存装饰过的计算器。因为，在运行时装饰每个产品实体会很昂贵。但这对于装饰器模式来说很难。在我们的情况下使用这种模式似乎是一种气味。

你有什么建议？我们应该使用装饰器、策略还是责任链模式？或无模式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T09:38:32.397

在策略模式中，对象的意图会发生变化。

因此，我认为策略将是一个不错的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T09:44:56.050

> 所有产品都应使用所有计算器，因为计算器决定根据产品属性（如产品商家 ID、类别 ID、颜色等）应用其计算。

如果您需要让所有产品都使用所有装饰器，那么您并没有真正从该模式中获得任何好处。这是否意味着如果你实现一个新的装饰器，所有现有的实体都必须更新才能使用这个新的装饰器？

装饰器应仅在必要时应用于产品，并且仅应应用那些需要的装饰器。

我认为您应该从装饰器中删除决定；其他东西应该决定是否应用装饰器，在这种情况下，它将产品包装在适当的装饰器中。这样你就知道如果一个产品被包装在一个装饰器中，那个装饰器正在影响（影响？）产品。

# makefile - 具有许多目标目录的 GNU make

> ID：934127
> 
> 赞同：4
> 
> 时间：2009-06-01T09:30:16.503
> 
> 标签：makefile, release-management, gnu-make, build-management

我必须将许多 HTML 文件的生成集成到现有的`Makefile`. 问题是 HTML 文件需要驻留在许多不同的目录中。我的想法是编写一个隐式规则，将源文件（*.st）转换为相应的html文件

```
%.html: %.st
    $(HPC) -o $@ $< 
```

和一个依赖于所有 html 文件的规则

```
all: $(html) 
```

如果 HTML 文件不在 builddir 中，则*make*找不到隐式规则：`*** No rule to make target`. 如果我像这样更改隐式规则

```
$(rootdir)/build/doc/2009/06/01/%.html: %.st  
    $(HPC) -o $@ $< 
```

找到了，但是我必须对项目中的几乎每个文件都有一个隐式规则。根据GNU 手册中的[隐式规则搜索算法](http://www.gnu.org/software/make/manual/make.html#Implicit-Rule-Search)`make`，规则搜索的工作方式如下：

> 1.  将整个目标名称*t*拆分为目录部分，称为*d*，其余部分称为*n*。例如，如果*t*是`src/foo.o`，则*d*是`src/`，并且*n*是`foo.o`。
> 2.  列出所有目标匹配*t*或*n*的模式规则。如果目标模式包含斜线，则与*t*匹配；否则，反对*n*。

为什么没有找到隐含规则，假设`make`使用 GNU，什么是最优雅的解决方案？

这是我的精简版`Makefile`：

```
rootdir  = /home/user/project/doc
HPC      = /usr/local/bin/hpc

html = $(rootdir)/build/doc/2009/06/01/some.html

%.html: %.st
    $(HPC) -o $@ $<

#This works, but requires a rule for every output dir
#$(rootdir)/build/doc/2009/06/01/%.html: %.st  
#   $(HPC) -o $@ $<

.PHONY: all
all: $(html) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T12:25:17.630

到目前为止，我发现的最佳解决方案是通过[foreach-eval-call](http://www.gnu.org/software/make/manual/make.html#Eval-Function)为每个目标目录生成一个隐式规则，如[GNU`make`手册](http://www.gnu.org/software/make/manual/make.html)中所述。我不知道这如何扩展到几千个目标目录，但我们会看到......

如果您有更好的解决方案，请发布！

这是代码：

```
rootdir  = /home/user/project/doc
HPC      = /usr/local/bin/hpc

html = $(rootdir)/build/doc/2009/06/01/some.html \
       $(rootdir)/build/doc/2009/06/02/some.html

targetdirs = $(rootdir)/build/doc/2009/06/01 \
             $(rootdir)/build/doc/2009/06/02

define generateHtml
 $(1)/%.html: %.st
    -mkdir -p $(1)
    $(HPC) -o $$@ $$<
endef   

$(foreach targetdir, $(targetdirs), $(eval $(call generateHtml, $(targetdir))))

.PHONY: all
all: $(html) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T09:36:27.130

您的主动隐式规则`$(rootdir)/build/doc/2009/06/01/some.html`取决于`$(rootdir)/build/doc/2009/06/01/some.st`. 如果`$(rootdir)/build/doc/2009/06/01/some.st`不存在，则不会使用/找到该规则。

注释掉的规则使得`$(rootdir)/build/doc/2009/06/01/some.html`依赖于`some.st`.

一种解决方案是使您的源布局与您的目标/结果布局相匹配。

另一种选择是根据需要使用[`eval`](http://www.gnu.org/software/make/manual/make.html#Eval-Function). 但这将非常复杂：

```
define HTML_template
 $(1) : $(basename $(1))
      cp $< $@
endef

$(foreach htmlfile,$(html),$(eval $(call HTML_template,$(htmlfile)))) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-19T00:39:00.177

像 Maria Shalnova 一样，我喜欢递归制作（尽管我不同意“递归制作被认为是有害的”），一般来说，从那里的源头制作一些东西会更好，而不是相反。但如果必须，我建议稍微改进一下：让 generateHtml 只生成 RULE，而不是 COMMANDS。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-01T12:45:32.443

另一种可能性是让突击队`make`在每个输出目录中使用参数 -C 递归调用自身。递归`make`在某种程度上是处理子目录的标准方法，但要注意文章“递归使被认为是有害的”中提到的含义

# java - 帮助查看以下代码，它是线程安全的吗？

> ID：934130
> 
> 赞同：3
> 
> 时间：2009-06-01T09:31:12.430
> 
> 标签：java, multithreading, static-methods

```
private static Callback callback;

public Foo()
{
    super(getCallback());
}

private static Callback getCallback()
{
    callback = new Callback();
    return callback;
} 
```

构造函数 Foo() 可能会从多个线程中调用。我关心的是私有静态字段“callback”和静态方法“getCallback()”。

可以看出，每次调用“getCallback()”时，都会为静态字段“回调”分配一个新值。

我的*猜测*是它不是线程安全的，因为关键字*static*总是附加到类而不是实例上，这意味着 Foo 的静态字段“回调”可能会被构造另一个 Foo() 的其他线程覆盖. 它是否正确？

如果我错了，请纠正我。谢谢！

编辑：我的目的是在课堂上的某个地方保留“回调”，以便以后可以重用它。但这并不容易，因为 Foo 从一个类扩展而来，该类具有强制传递“回调”的构造函数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T09:41:57.150

是的，你是对的。当两个线程同时进入方法并且一个为静态字段分配一个新的而另一个已经完成但尚未返回时，两个实例可能以`Foo`相同的实例结束。在这种情况下，最好的解决方法是不要使用静态字段，因为它没有任何用处。或者，使同步。`CallBack``getCallback()``CallBack``getCallback()`

但请注意，只有关键字导致代码不是线程安全的，这是不*正确的。*`static`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-01T09:52:12.387

它不是线程安全的。尝试以下替代方案：

选项 1：这里所有实例共享相同的回调

```
private static final Callback callback = new Callback();

public Foo() {
    super(callback);
} 
```

选项2：这里每个实例都有自己的回调

```
public Foo() {
    super(new Callback());
} 
```

注意，在这两种情况下，虽然构造函数是线程安全的，但是整个类的线程安全取决于Callback的实现。如果它具有可变状态，那么您将遇到潜在问题。如果 Callback 是不可变的，那么您就具有线程安全性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T09:43:03.327

每次调用 Foo() 时（即使来自同一个线程），回调都会获得一个新值。我不太确定您的代码应该做什么（如果您只想初始化静态变量一次（单例），您应该检查它是否在 getCallback() 中仍然为空 - 以及 actionCallback 是什么？）。为了使其线程安全，请使用同步。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T09:44:01.200

我认为您自己完美地总结了它，但是如果没有更多关于您要实现的目标的详细信息，提出解决问题的建议将很棘手。

一个明显的问题是，`callback`必须是静态的吗？或者你能安全地将它变成一个实例字段而不破坏你的类的功能吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T16:58:15.017

我知道它已经得到了回答，但原因并没有真正详细说明。

它有两个线程正在调用 getCallback() 方法，它们可以执行如下行：

1.  线程 1 - 回调 = new Callback();
2.  线程 2 - 回调 = new Callback();
3.  线程 1 - 返回 actionCallback；
4.  线程 2 - 返回 actionCallback；

在这种情况下，在 (2.) 处生成的回调将在 (3.) 和 (4.) 中返回

解决方案似乎是询问如果回调特定于实例而不是类，为什么静态定义回调。

我希望这会有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T06:22:57.377

您正在尝试做的事情称为单例模式，如果您进行搜索，您会发现为什么如果可以的话避免这种模式通常是一个好主意，但是如果您需要它，您可以执行以下操作。

```
private static final Callback CALLBACK= new Callback(); 
```

或者，如果您需要一个懒惰的单身人士，您可以这样做

```
public class Foo {
   class CallbackHolder {
       static final Callback CALLBACK= new Callback();
   }

   public static Callback getCallback() {
      return CallbackHolder.CALLBACK;
   }

public Foo() {
    super(getCallback());
} 
```

两种实现都是线程安全的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T07:42:02.823

你想要每个线程一个回调，每个对象一个回调，还是一个真正的单例？

一些关于如何做不同变体的草图 - 只是从我的脑海中，不要太从字面上理解:)

请注意，我假设 Callback 有一个非平凡的构造函数，它可能会抛出需要处理的异常，如果它是一个平凡的构造函数，您可以大大简化所有这些。

每个线程一个：

```
 private static ThreadLocal<Callback> callback;

  public Foo()
  {
      super(getCallback());
  }

  private static Callback getCallback()
  {
      if ( callback.get() == null ) 
          callback.set(new Callback());
      return callback.get();
  } 
```

所有线程的单一回调：

```
 private final static Callback callback;

  static {
      callback = new Callback(); 
  }

  public Foo()
  {
      super(getCallback());
  }

  private static Callback getCallback()
  {
      return callback;
  } 
```

而且，为了完整起见，每个对象一个回调：

```
 private Callback callback;

  public Foo()
  {
      super(getCallback());
  }

  private Callback getCallback()
  {
      callback = new Callback();
      return callback;
  } 
```

# java - 如何在不更改注释的情况下禁用 Hibernate 中某些实体的二级缓存

> ID：934133
> 
> 赞同：6
> 
> 时间：2009-06-01T09:31:31.493
> 
> 标签：java, hibernate, annotations, second-level-cache

我在我的应用程序中使用 Hibernate 二级缓存，由于某些业务原因，**我不能再更改实体注释**。

在我的项目中，除了从 Hibernate 更改数据库之外，还存在其他不通过 Hibernate 的原生 SQL。因此，从本地 SQL 更新数据库后，Hibernate 二级缓存数据可能会过时。这就是为什么我要**禁用某些实体的二级缓存（以编程方式或除更改注释之外的其他方式）。**

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T11:07:37.040

**警告：**正如 Jens Schauder 所指出的，无法通过设置 maxElementsInMemory="0" 将 Ehcache 配置为在内存中存储 0 个元素，因为它实际上会产生相反的效果 - 为缓存设置无限大小。这种行为在[Hibernate Caching](http://ehcache.sourceforge.net/documentation/hibernate.html)页面上没有提到，但在[Cache Configuration](http://ehcache.org/documentation/configuration.html)页面上有记录。

我已经快速查看了文档，还没有找到替代方法。我无法自己删除此答案。:-(

*我原来的建议：*

您可以将二级缓存的实现提供程序配置为缩短 TTL 时间和/或存储 0 个特定实体类型的条目。

例如，如果您使用的是 Ehcache，您可以在 ehcache.xml 中配置它：*

```
<cache
name="com.problematic.cache.EntityName"
maxElementsInMemory="0" <<== this should effectively disable caching for EntityName
overflowToDisk="false" <<== Do not overflow any entries to disk
/> 
```

请参阅Ehcache 文档中的[休眠缓存](http://ehcache.sourceforge.net/documentation/hibernate.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-11T07:12:24.800

在 Terracotta 3.1 及更高版本中，您可以使用 Terracotta 开发人员控制台在配置（静态）和运行时基于每个区域启用/禁用 Hibernate 2nd Level Caches。

您还可以针对集群或集群范围内的各个节点实时监控缓存和休眠的统计信息。

Terracotta 是开源的。有关更多详细信息，请查看[用于 Hibernate 的 Terracotta](http://www.terracotta.org/web/display/orgsite/Hibernate)。

# ruby-on-rails - 您是否有一个在 Windows 下运行的 Rails 开发环境令您满意？

> ID：934143
> 
> 赞同：1
> 
> 时间：2009-06-01T09:36:24.400
> 
> 标签：ruby-on-rails, windows

我当前的 Rails 开发环境是 Windows XP 上的 Aptana + RadRails 插件，运行测试、rake 和生成器有点慢。

如果您已经将您的 Windows Ruby on Rails 开发环境发展并证明了您满意并且速度很快，请在下面分享详细信息。

非常感谢，

艾略特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T15:28:26.840

[http://www.akitaonrails.com/2009/1/13/the-best-environment-for-rails-on-windows](http://www.akitaonrails.com/2009/1/13/the-best-environment-for-rails-on-windows)

试试这个指南

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T14:01:19.060

虽然我现在主要使用 Ubuntu，但我使用的是装有 Vim 的 Windows 机器。Vim 有一个名为[rails.vim](http://www.vim.org/scripts/script.php?script_id=1567)的插件。它非常了解导轨结构。我发现这些东西非常有用。

1.  使用 :RModel、RUnittest、:RFunctionaltest、RController 在 3-4 次击键内的模型、控制器、单元测试、功能测试之间导航。
2.  能够使用 :Rake 立即运行单元/功能/集成测试
3.  使用 :RConsole 快速跳转到控制台
4.  使用 :RHelper 快速跳转到助手
5.  goto 文件“gf”快捷方式现在以可预测的方式运行。它甚至会在您安装的 gem 中查找文件。

该网站上的视频几乎没有任何公正。如果您不是 vim 用户，那么我建议您使用[E text editor](http://www.e-texteditor.com/)。它不是免费的，但值得您付出的每一分钱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T18:48:44.237

添加到 Omar：您可以安装在 Windows 中运行的便携式 Ubuntu，而不是处理 VMWare。虽然这样做会降低性能，但它会给你一个 Linux 环境来工作，你不必担心安装另一个操作系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T11:11:50.947

我被引导相信，与 *n[iu]x 相比，Windows 上的 Rails（实际上是 Ruby）通常很慢，但由于我没有体验过后者，所以我仍然非常无知。特别是，即使在相当快的（3GHz Xeon）机器上，Rails 环境加载也很乏味。

最重要的是，IDE 会带来开销。最近，我尝试过 NetBeans 和 RubyMine。与我正常的命令行和测试编辑器工作环境相比，两者都非常有能力但有点慢，这几乎足够了 95% 的时间：我发现我在开发测试优先时不需要太多 IDE 支持. 我仍然发现自己主要使用 SciTE，主要是因为“运行”命令很容易访问。在我的测试中对“require test_helper”行稍作调整，单个测试执行不超过 F5，并且整个套件可以从命令行快速“rake”。

如果我需要调试框架以消除（通常）我的一些误解，那么我目前倾向于 NetBeans，其中调试器似乎更直观一些。我怀疑 RubyMine 可能有更强大的功能，但我还没有发现自己需要它。

尽管如此，Windows 上性能的关键是执行 `environment.rb' 的时间，这不是一个容易破解的问题。（希望我完全错了，我错过了一些超酷的东西，顺便说一句。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T17:53:10.073

我会认真考虑反对在 Windows 中进行 Rails 开发，我背后的理由是因为您不会在生产中使用 Windows 机器。

您很可能会运行某种 Linux 机器，因为Passenger 无法在 Windows 上运行，mongrel_cluster（我上次检查）也无法在 Windows 上运行，而 IIS 是一场噩梦。相信我，开发和生产之间的一致性是一个巨大的好处。

如果您必须运行 Windows，那么我建议您在具有您选择的 Linux 发行版的虚拟机中运行 Rails。这样你就可以使用像 e-texteditor 之类的东西（强烈推荐它作为 Textmate 的一个很好的替代品），并在你的虚拟机上将 Samba 共享到 git/svn 存储库。

检查 VMWare 服务器并安装 CentOS / Ubuntu。它是免费的，它将让您深入了解 Linux 中的开发，这最终是您想要的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T18:59:53.057

我会推荐用于 Windows 的 jruby。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T20:56:02.573

如果您使用 Windows XP 的原因并非不可改变，那么您应该切换到 Linux。Windows 上没有出现任何奇怪的兼容性问题。如果您的应用程序最终将部署到 linux 机器上，那么在其上进行开发会更容易。另外，它将解决您的性能问题。

[https://help.ubuntu.com/community/RubyOnRails](https://help.ubuntu.com/community/RubyOnRails)

如果存在使 Windows 绝对必要的约束，请修改并指定。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-01T21:00:28.993

如果您想使用 Visual Studio，那么 Ruby in Steel 也不错。

它有它的问题，但它不像我尝试过的 eclipse 变体那样“慢”。到目前为止，RadRails 具有我所见过的最完整的代码完成，因为它对您的模型的了解远远超过 Ruby in Steel。即使为它加载数据很慢，至少它在那里。

# powershell - 使用 ADSI 设置“作为服务登录”和“允许本地登录”

> ID：934156
> 
> 赞同：6
> 
> 时间：2009-06-01T09:41:09.147
> 
> 标签：powershell, adsi

我正在尝试创建一个 powershell 脚本来自动创建用户，这在使用 ADSI 时效果很好。但是我需要设置以下属性，但我不确定如何（或者 ADSI 是否可以这样做）：

*   作为服务登录
*   允许本地登录

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T21:00:47.980

在 PowerShell 中使用 GPO 的解决方案是通过一个名为 GPMgmt.GPM 的 COM+ 对象，它是组策略管理控制台功能的一部分。我能找到的关于此信息的最佳文章是：[http ://technet.microsoft.com/en-us/magazine/cc162355.aspx](http://technet.microsoft.com/en-us/magazine/cc162355.aspx)

不过，我还没有弄清楚如何设置这些特定值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-25T18:58:29.630

这可能是您正在寻找的：

[https://gist.github.com/ned1313/9143039](https://gist.github.com/ned1313/9143039)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-27T12:55:08.097

我们可以通过导入第三方 DLL ( Carbon ) 在 powershell 中为用户设置登录即服务权限。

你可以从这里下载 dll [https://bitbucket.org/splatteredbits/carbon/downloads](https://bitbucket.org/splatteredbits/carbon/downloads)

```
$Identity = "DomainName\Administrator"
$privilege = "SeServiceLogonRight"

$CarbonDllPath = "C:\Users\Administrator\Downloads\Carbon-1.5.1\Carbon\bin\Carbon.dll"

[Reflection.Assembly]::LoadFile($CarbonDllPath)

[Carbon.Lsa]::GrantPrivileges( $Identity , $privilege ) 
```

# python - 在 Python 中写入 UTF-8 文件

> ID：934160
> 
> 赞同：228
> 
> 时间：2009-06-01T09:42:23.530
> 
> 标签：python, utf-8, character-encoding, byte-order-mark

我真的很困惑`codecs.open function`。当我做：

```
file = codecs.open("temp", "w", "utf-8")
file.write(codecs.BOM_UTF8)
file.close() 
```

它给了我错误

> UnicodeDecodeError：“ascii”编解码器无法解码位置 0 的字节 0xef：序数不在范围内（128）

如果我做：

```
file = open("temp", "w")
file.write(codecs.BOM_UTF8)
file.close() 
```

它工作正常。

**问题**是为什么第一种方法会失败？以及如何插入 bom？

如果第二种方法是正确的方法，那么使用的意义`codecs.open(filename, "w", "utf-8")`何在？

* * *

## 回答 #1

> 赞同：297
> 
> 时间：2009-06-01T09:46:58.933

我相信问题在于这[`codecs.BOM_UTF8`](https://docs.python.org/library/codecs.html#codecs.BOM_UTF8)是一个字节字符串，而不是 Unicode 字符串。我怀疑文件处理程序试图根据“我打算将 Unicode 编写为 UTF-8 编码文本，但你给了我一个字节字符串！”来猜测你的真正意思。

尝试直接为字节顺序标记编写 Unicode 字符串（即 Unicode U+FEFF），以便文件将其编码为 UTF-8：

```
import codecs

file = codecs.open("lol", "w", "utf-8")
file.write(u'\ufeff')
file.close() 
```

（这似乎给出了正确的答案 - 一个字节为 EF BB BF 的文件。）

编辑：S. Lott[建议](https://stackoverflow.com/a/934203/12892)使用“utf-8-sig”作为编码比自己明确编写 BOM 更好，但我将把这个答案留在这里，因为它解释了之前出了什么问题。

* * *

## 回答 #2

> 赞同：194
> 
> 时间：2009-06-01T09:58:14.107

阅读以下内容： http: [//docs.python.org/library/codecs.html#module-encodings.utf_8_sig](http://docs.python.org/library/codecs.html#module-encodings.utf_8_sig)

做这个

```
with codecs.open("test_output", "w", "utf-8-sig") as temp:
    temp.write("hi mom\n")
    temp.write(u"This has ♭") 
```

生成的文件是 UTF-8 和预期的 BOM。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2021-08-12T11:17:48.227

使用这个非常简单。**不需要任何库。**

```
with open('text.txt', 'w', encoding='utf-8') as f:
    f.write(text) 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-06-01T10:12:39.257

@S-Lott 提供了正确的程序，但扩展了*Unicode*问题，*Python*解释器可以提供更多见解。

Jon Skeet 关于[`codecs`](http://docs.python.org/library/codecs.html#codecs.BOM)模块是正确的（不寻常的） - 它包含字节字符串：

```
>>> import codecs
>>> codecs.BOM
'\xff\xfe'
>>> codecs.BOM_UTF8
'\xef\xbb\xbf'
>>> 
```

选择另一个 nit，它`BOM`有一个标准的*Unicode*名称，它可以输入为：

```
>>> bom= u"\N{ZERO WIDTH NO-BREAK SPACE}"
>>> bom
u'\ufeff' 
```

它也可以通过以下方式访问[`unicodedata`](http://docs.python.org/library/unicodedata.html#module-unicodedata)：

```
>>> import unicodedata
>>> unicodedata.lookup('ZERO WIDTH NO-BREAK SPACE')
u'\ufeff'
>>> 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-02-08T20:35:11.170

我使用 file *nix 命令将未知字符集文件转换为 utf-8 文件

```
# -*- encoding: utf-8 -*-

# converting a unknown formatting file in utf-8

import codecs
import commands

file_location = "jumper.sub"
file_encoding = commands.getoutput('file -b --mime-encoding %s' % file_location)

file_stream = codecs.open(file_location, 'r', file_encoding)
file_output = codecs.open(file_location+"b", 'w', 'utf-8')

for l in file_stream:
    file_output.write(l)

file_stream.close()
file_output.close() 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-12-08T12:04:46.310

如果您使用的是 pandas.to_excel() 等 Pandas I/O 方法，请添加一个编码参数，例如

```
pd.to_excel("somefile.xlsx", sheet_name="export", encoding='utf-8') 
```

这适用于我相信的大多数国际角色。

# .net - 从 VB.NET 中搜索文件

> ID：934161
> 
> 赞同：0
> 
> 时间：2009-06-01T09:42:42.997
> 
> 标签：.net, vb.net, search, filesystems

给定一个文件名，我如何有效地在磁盘上搜索该文件？

（Visual Studio 2005，即 .NET 2.0）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T09:57:02.143

你的问题很模糊，你没有指定任何编程语言。因此，您可以使用命令提示符执行此操作：

```
dir /s /b d:\<filename> 
```

或在您使用的任何语言的系统调用中使用上述内容。

在 C/C++ 或任何其他使用本机 Win32 API 的语言中，使用：

*   [`FindFirstFileEx`](http://msdn.microsoft.com/en-us/library/aa916293.aspx)

*   [`FindNextFile`](http://msdn.microsoft.com/en-us/library/aa914380.aspx)

*   [`FindClose`](http://msdn.microsoft.com/en-us/library/aa914380.aspx)

并通过您遇到的任何目录进行递归。在 C#/VB/其他 .Net 语言中，它是：

*   [`System.IO.Directory.GetFiles`](http://msdn.microsoft.com/en-us/library/system.io.directory.getfiles.aspx)

*   [`System.IO.Directory.GetDirectories`](http://msdn.microsoft.com/en-us/library/system.io.directory.getdirectories.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T10:58:58.227

如果你想实现搜索机制，我会从这样的东西开始（C#）

```
using System;
using System.Collections.Generic;
using System.IO;

namespace Samples.FileSearcher
{
    public delegate void FileFoundHandler(string fileName);
    public delegate void SearchStatChangeHandler( bool newStat);
    public class FileSearch
    {
        private bool _isSearching;
        private FileFoundHandler _fileFound;
        private SearchStatChangeHandler _searchStatusChanged;
        public bool IsSearching { get { return _isSearching; } }
        public event FileFoundHandler FileFound{add { _fileFound += value; }remove { _fileFound -= value; }}
        public event SearchStatChangeHandler SearchingStatusChanged { add { _searchStatusChanged += value; } remove { _searchStatusChanged -= value; } }

        public void Search(string rootFolder, string filePattern)
        {
            ChangeStat(true);
            Queue<string> folderList = new Queue<string>();
            folderList.Enqueue(rootFolder);

            while (folderList.Count > 0)
            {
                string currentFolder = folderList.Dequeue();
                foreach (string folder in Directory.GetDirectories(currentFolder))
                    folderList.Enqueue(folder);
                foreach (string foundFile in Directory.GetFiles(currentFolder, filePattern))
                    if (_fileFound != null)
                        _fileFound(foundFile);
            }
            ChangeStat(false);
        }
        private void ChangeStat(bool newStat)
        {
            _isSearching = newStat;
            if (_searchStatusChanged != null) _searchStatusChanged(_isSearching);
        }

    }
} 
```

这只是一个快速的课程。您应该使用它来实现表单，对搜索方法进行一些错误处理，并且可能还有一些取消标志，这样当您已经找到您想要的内容时，您就不会永远继续搜索。

我用这样的东西实现了我的表单：

```
private void button1_Click(object sender, EventArgs e)
    {
        listView1.Items.Clear();
        Samples.FileSearcher.FileSearch searcher = new Samples.FileSearcher.FileSearch();
        searcher.FileFound += new FileFoundHandler(searcher_FileFound);
        searcher.Search(textBox1.Text, textBox2.Text);
    }

    void searcher_FileFound(string fileName)
    {
        listView1.Items.Add(fileName);
    } 
```

如果您有更具体的疑问，请将它们发布出来，我们会尽力调查并尽力帮助您。

# c# - 'Bad Data' 使用 DES3 解密消息时

> ID：934171
> 
> 赞同：0
> 
> 时间：2009-06-01T09:45:50.060
> 
> 标签：c#, encryption

C# 2008

我正在使用以下代码来加密和加密消息。但是，当我尝试解密时，我收到“错误数据”错误。

我下面的代码有什么问题吗？

非常感谢，

```
public string encryptText(string text)
    {
        try
        {
            TripleDESCryptoServiceProvider encrypt = new TripleDESCryptoServiceProvider();

            encrypt.Key = new byte[] { 0, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 144, 89, 55, 34, 21, 13, 8, 5, 3, 2, 1, 0 };
            encrypt.IV = new byte[] { 1, 2, 3, 5, 8, 13, 21, 34 };
            byte[] byteText = Encoding.Unicode.GetBytes(text);

            ICryptoTransform encryptor = encrypt.CreateEncryptor();

            byte[] encryptedText = encryptor.TransformFinalBlock(byteText, 0, byteText.Length);

            return Encoding.Unicode.GetString(encryptedText);
        }
        catch (Exception ex)
        {
            Console.Write(ex.Message);

            return ex.Message;
        }

    }

    /// Decrypt the text
    public string decryptText(string encryptedText)
    {
        try
        {
            byte[] bytesText = Encoding.Unicode.GetBytes(encryptedText);

            TripleDESCryptoServiceProvider decrypt = new TripleDESCryptoServiceProvider();

            decrypt.Key = new byte[] { 0, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 144, 89, 55, 34, 21, 13, 8, 5, 3, 2, 1, 0 };
            decrypt.IV = new byte[] { 1, 2, 3, 5, 8, 13, 21, 34 };

            ICryptoTransform decryptor = decrypt.CreateDecryptor();

            byte[] originalText = decryptor.TransformFinalBlock(bytesText, 0, encryptedText.Length);

            return Encoding.Unicode.GetString(originalText);
        }
        catch (Exception ex)
        {
            Console.Write(ex.Message);

            return ex.Message;
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T09:53:45.580

您正在获取加密的字节并使用 将它们转换为字符串`Encoding.Unicode`，但随后您将获取字符串并使用 将其转换回字节`Encoding.Default`。这几乎*可以保证*不起作用（除非默认值恰好是 UTF-16）。

但是，您应该使用*其中任何*一个 - 使用编码将任意二进制数据转换为文本是一个坏主意。改用`Convert.ToBase64String`（在加密器中）和`Convert.FromBase64String`（在解密器中）。

（我也非常质疑返回异常消息是否明智，就好像它是加密/解密的成功结果一样，但希望您只是为了示例代码而这样做。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T11:06:00.177

是的，代码中有一些错误。

*   encryptedText 和 bytesText 必须是相同的字节数组。正如 Jon Skeet 建议的那样，您可以使用 Base64 编码。

*   IV是密文的一部分。因此，您不必在解密时设置 IV。

*   默认的加密模式是 CBC。此模式要求 IV 是随机的（rsp。不可预测）。因此，加密时不能设置固定的 IV。当您创建 CryptoServiceProvider 时，已经设置了一个随机 IV。因此，用固定值覆盖 IV 会降低您的安全性。

*   在代码中显式放置一个键并不是一个好主意。我希望一旦您的代码离开实验状态，您将更改此设置。

*   有理由使用 TripleDes 吗？否则，您可能需要考虑改用 AES。

# svn - 如何做内部 svn:externals

> ID：934174
> 
> 赞同：11
> 
> 时间：2009-06-01T09:47:06.857
> 
> 标签：svn, symlink, svn-externals

我正在尝试使用 svn:externals 在我们的 subversion 存储库中设置一种符号链接，但它并没有真正工作得那么好。我想要做的是将*同一*存储库的一部分中的文件夹链接到另一个，如下所示：

src/somewhere_else/schema [https://svn.acme.com/svn/project/trunk/src/schema](https://svn.acme.com/svn/project/trunk/src/schema)

这适用于真正的外部资源（即，不同存储库中的目录），但我无法让它适用于上述相同存储库中的资源。我已经用谷歌搜索了一段时间，似乎应该支持它，我错过了什么？

我们在 Windows 2003 服务器安装上使用 VisualSVN 下的 Subversion 1.5.5。

我忘了提到我没有收到任何错误，应该从另一个文件夹中获取其内容的文件夹保持为空。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-01T09:56:23.487

Subversion 1.5 添加了[相关的 externals](http://svnbook.red-bean.com/en/1.5/svn.advanced.externals.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T10:03:41.770

我不认为这是否是您真正的问题，但我直接在文件夹上定义属性。在您的情况下，我创建一个`src\somewhere_else`文件夹并添加属性：

```
schema https://svn.acme.com/svn/project/trunk/src/schema 
```

只需记住一点，如果您像您建议的那样定义绝对外部 url：

```
src/somewhere_else/schema https://svn.acme.com/svn/project/trunk/src/schema 
```

如果您创建 TAG 或 BRANCH，它们不会自动更改。这意味着 TAG（外部 url）的一部分将始终指向架构的 TRUNK。

如果架构没有太大变化当然很好，但是当您有一个 2 年的旧应用程序要修补并且架构已被广泛更改时，这可能会成为一个问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T10:33:03.990

你给出的语法：

```
working-copy-relative-path    full-repo-url 
```

应该工作得很好。但是，如果你走这条路，你必须提供完整的 URL，就像你在签出时使用它一样，即使链接在同一个存储库中。你正在这样做，对吧？

1.5 中引入的替代方案是相对外部：

repo-url-or-relative-path 工作副本-相对路径

有关更多信息，请参阅 Roger Lipscombe 的链接。

不过，您所描述的*应该*有效。如果它不起作用，那么您一定不能足够准确地描述您实际在做什么。一些细节仍然缺失。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-01T10:46:01.997

尝试执行“更新到特定版本”，并指定“完全递归”。如果您的工作副本停留在“仅工作副本”上，它将无法获取外部内容。

# javascript - JavaScript 中的国际化

> ID：934175
> 
> 赞同：3
> 
> 时间：2009-06-01T09:47:16.657
> 
> 标签：javascript, internationalization

我有一个 JSP 页面，它接受超过 23 种语言的用户字符串。所以说英语的用户写`8.5`了 ，JavaScript 函数应该接受它以及`8,5`来自俄语用户的输入。

在这种情况下，我们如何验证所有语言的 JavaScript 输入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-07T03:35:27.443

您可能可以使用 java.text.NumberFormat 使用 Java 执行此服务器端，但 Dojo 具有执行此客户端的代码。请参阅使用 dojo.number 的[dojo.number](http://api.dojotoolkit.org/jsdoc/1.3/dojo.number)和[dijit.form.NumberTextBox](http://docs.dojocampus.org/dijit/form/NumberTextBox)。

# actionscript-3 - 修复 ASDoc 中的损坏路径？

> ID：934176
> 
> 赞同：6
> 
> 时间：2009-06-01T09:47:29.493
> 
> 标签：actionscript-3, asdoc

这个问题涉及使用 ASDoc 从 AS3 创建文档。我不是通过 Flex 或其他任何方式执行此操作，而是使用命令行，尽管一切正常且 ASDoc 没有返回任何错误，但生成的文档中的某些链接已损坏。

具体来说，在文档的其他部分（包括在同一类中）中存在指向属性或方法的链接的所有地方，该链接最终会使与包对应的文件夹翻倍。

例如，假设我正在记录`myPackage.MyClass`. 如果`MyClass`有一个名为 的属性`MyProperty`，并且在我的文档中的某处，我包含了这样的一行：

```
@see #MyProperty 
```

然后正确解析文档并正确创建“另请参阅：”链接，但最终指向

```
.../output_directory/myPackage/myPackage/MyClass.html#MyProperty 
```

当然，在实际文件系统中只有一个`myPackage`文件夹。

我的 ASDoc 命令的相关部分如下所示：

```
asdoc
 -source-path .
 -doc-sources myPackage
 -output D:\dev\repository\docs\myPackage_docs
 -external-library-path "C:\Progra~1\Adobe\flex_sdk_3\frameworks\libs\player\10\playerglobal.swc" 
```

我是否可能遗漏了一些 ASDoc 参数来指定链接的基本 URL，或者类似的东西？如果这是一个简单的错误，对许多人来说很明显，但我找不到任何关于该问题的谷歌结果，所以我的工作假设是它不会发生在从 Flex 运行 ASDoc 的人身上，也许是因为我的某些设置'已省略。

谢谢你的帮助！

* * *

在 TypeOneError 的建议下，我尝试了不同类型的 @see 链接。我发现这些工作正常：

*   `@see some.package`
*   `@see ClassName`
*   `@see ClassName#property`

虽然这些不起作用：

*   `@see #property`
*   `@see full.package.ClassName`
*   `@see full.package.ClassName#property`

更糟糕的是，尽管所有导航链接都有效，但自动生成的类型链接中会出现相同的双重路径。例如，当它显示每个方法的签名时，当方法返回文档中的类时，该链接就会断开。

我还查看了 HTML，发现问题似乎与页面的基本 URL 或任何内容无关，只是链接不一致。因此，在一排连续的`@see`链接中，其中一些链接到`ClassName.html`，一些链接到`package/ClassName.html`，按照上面显示的规则。顺便说一句，无论页面是否在框架中查看，所有这些都是正确的。

如果我想出任何东西，请提供更多信息，但最欢迎解决方法的想法。

* * *

*更新：*更多细节：我不确定我的确切 SDK 版本，除了它附带 Flex 3，但如果我不带参数运行 ASDoc，它会报告：`Adobe ASDoc Version 3.3.0 build 4852`. 我在 Windows XP 上从放置在类路径目录中的批处理文件中运行这一切。

* * *

**部分解决方案：**通过升级到 Flex 4 SDK 的 4.0.0.7219 beta 版本（并使用其中分发的 ASDoc）解决了我的所有问题，但其中一个问题除外。现在，我的所有`@see`标签都按预期工作。剩下的唯一问题是，无论我有一个方法返回一个属于我的文档的一部分的类，ASDoc 都会简单地破坏链接。例如，如果我有一个签名为 的方法`ClassA#getB():ClassB`，那么在文档中显示的地方，文本“ClassB”链接到“packageName:ClassB.html”而不是“packageName/ClassB.html”。这似乎是一个简单的错误。呜呜。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T20:57:16.050

ASDoc 令人沮丧。您是否尝试过将完整的包/类名称显式添加到@see，即：

```
@see myPackage.myClass#MyProperty 
```

看看有没有区别？

**编辑**

我根据您的发现进行了一些测试，内部属性标记对我有用。IE

@see #_dispatcher

直接链接到页面上的该属性（无双子文件夹）。我想也许你需要重新考虑你是如何运行命令的。例如，我的代码库是这样设置的：

```
/src
    /com
        /bkwld
            /fetch 
```

我通常在“src”中运行 asdoc：

```
asdoc -source-path . -doc-classes com/bkwld/fetch/Fetch 
```

我在 Fetch.as 中尝试了所有这些，它们都按预期工作：

```
*  @see FetchItem
*  @see com.bkwld.utils.Logger
*  @see #_dispatcher 
```

首先将我带到 FetchItem 页面，然后将我带到不同包中的 Logger 页面，然后将页面跳转到 Fetch 的受保护方法。

只是出于好奇...您使用的是什么版本的 sdk？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T11:01:05.227

我猜问题是你的线

-doc-sources myPackage

指定“。” 应该修复它而不是'myPackage'（所以让它与你的源路径相同）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T12:02:20.047

我编写了一个简单的 Python 脚本，修复了上述情况下 asdoc 错误生成的路径。即，如果有一个方法 myMethod(v:MyClass,...) asdoc 错误地生成链接 href="../mypackage:Myclass" 脚本将修复此问题，将 : 替换为 /

我应该注意到我生成的文档有一个非常“扁平”的结构，即一个包含一堆类的单个包。我不知道该修复程序是否适用于更复杂的文档结构。

无论如何，如果有人想尝试这个脚本，我很乐意发送它。

# internet-explorer-8 - IE8 中使用 VBScript 的兼容模式

> ID：934178
> 
> 赞同：2
> 
> 时间：2009-06-01T09:49:20.770
> 
> 标签：internet-explorer-8, vbscript

是否可以使用 VBScript 在 IE8 中设置和检查兼容模式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T11:01:56.363

根据[定义文档兼容性](http://msdn.microsoft.com/en-us/library/cc288325(VS.85).aspx)文章，有[document.documentMode](http://msdn.microsoft.com/en-us/library/cc196988(VS.85).aspx)属性返回 IE8 中当前页面的兼容性模式。例如，您可以在 IE8 的地址栏中键入以下内容，以获取显示在消息框中的兼容模式值：

```
vbscript:msgbox(document.documentMode) 
```

至于动态修改兼容模式...您可能可以遍历所有元标记并更改 X-UA-Compatible http-equiv 标头的内容，如下例所示，但我没有 IE 8 所以可以不要说它是否真的有效。

```
Sub ChangeCompatMode
  Dim metatags, meta

  Set metatags = document.getElementsByTagName("meta")
  For Each meta In metatags
    If UCase(meta.getAttribute("httpEquiv")) = "X-UA-COMPATIBLE" Then
      ' Change the document mode
      meta.setAttribute "content", "IE=edge"
      Exit For
    End If
  Next
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T12:36:26.173

For the "setting" part... since you control the code delivered to the browser, you control what mode it goes into.

If you want proper standards support, set a valid DOCTYPE and you are set. If you want you can also set the META or HTTP Header to force standards mode so that the end user can't accidentally shoot themselves in the foot by setting it to compatibility mode.

On the other hand, if you have a legacy site that requires IE's legacy rendering/scripting behaviors, then send the META / HTTP Header to force compatibility mode.

Attempting to change this on the fly... is asking for trouble.

# sharepoint - 用于获取爬网信息的 SharePoint API

> ID：934179
> 
> 赞同：0
> 
> 时间：2009-06-01T09:49:25.277
> 
> 标签：sharepoint, moss

我正在尝试创建一个自定义报告，该报告显示当前抓取时间/持续时间以及完全或增量抓取的状态。

有谁知道我可以使用什么 API 来获取此类信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T10:51:25.887

不确定名称，但这里有一系列关于搜索 API 的好文章，如果有人无法提供全名，可能会为您指明正确的方向。

[http://www.helloitsliam.com/archive/2009/05/01/moss2007---using-the-search-api-part-1.aspx](http://www.helloitsliam.com/archive/2009/05/01/moss2007-) _

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T15:22:11.003

它是 Microsoft.Office.Server.Search.Administration.CrawlHistory 类。

SDK 甚至对此有一篇文章：http: [//msdn.microsoft.com/en-us/library/cc789570.aspx](http://msdn.microsoft.com/en-us/library/cc789570.aspx)

# c# - 如何从 DataTable 中绑定 Enum 以赢得表单 CheckedListBox

> ID：934188
> 
> 赞同：1
> 
> 时间：2009-06-01T09:52:11.637
> 
> 标签：c#, .net, winforms

我有这种情况：

```
[Flags]
enum Colors : long
(
    red = 1,
    blue = 2,
    green = 4,
    yellow = 8,
)

DataTable dt = new DataTable();
dt.Columns.Add("PersonName", typeof(string));
dt.Columns.Add("CheckOption", typeof(bool));
dt.Columns.Add("Colors", typeof(long));

// note that the values in the Colors column are enumed values of chosen colors
dt.Rows.Add("Name 1", true, 1); // red
dt.Rows.Add("Name 2", true, 12);    // green and yellow
dt.Rows.Add("Name 3", true, 4); // green
dt.Rows.Add("Name 4", false, 11);   // red, blue and yellow

// bind the datatable to grid
DataGridView dgv = new DataGridView();
dgv.DataSource = dt;
// hide the colors in the grid 
dgv.Columns["Colors"].Visible = false;

// checked list box has all items from the enum
CheckedListBox clb = new CheckedListBox();
string[] colorsArray = Enum.GetNames(typeof(Colors));
clb.Items.AddRange(colorsArray); 
```

我想要以某种方式将数据表的“颜色”列中所选颜色的枚举值以一种很好的方式绑定到 CheckedListBox。是否可以？

到目前为止，我一直在玩 grid 的 RowEnter 事件，但这似乎很脆弱，而且一点也不好。

编辑：例如，如果我在名为 MyText 的数据表中有第四列，我可以将该列绑定到这样的文本框：

```
myTextBox.DataBindings.Add("Text", dt, "MyText"); 
```

在数据网格中的行中移动时，文本框中的值会自动更改，并且对文本框的任何更新都会保存回数据表。我也想从复选框和枚举中获得这个功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T06:19:15.963

没有简单的方法可以做到这一点，因为这不是典型的主细节场景。我想你应该开始写那段代码了。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-01T10:04:50.363

我不确定你在追求什么，但你可以使用贪心算法来确定正在使用哪些颜色吗？

例如，您有数字 11。获得 11 的唯一可能方法是使用黄色，因此您删除适合 (8) 的最大数字，并选中相应的复选框。然后你得到 3。适合的最大数字是 2（蓝色），那么余数是显而易见的。

# java - 如何检查路径中是否存在程序

> ID：934191
> 
> 赞同：17
> 
> 时间：2009-06-01T09:52:37.580
> 
> 标签：java, scala, runtime

我正在scala中编写一个程序，它调用：

```
Runtime.getRuntime().exec( "svn ..." ) 
```

我想检查命令行中是否可以使用“svn”（即它可以在 PATH 中访问）。我怎样才能做到这一点 ？

PS：我的程序设计为在windows上运行

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2014-05-08T10:30:54.900

这是一个 Java 8 解决方案：

```
String exec = <executable name>;
boolean existsInPath = Stream.of(System.getenv("PATH").split(Pattern.quote(File.pathSeparator)))
        .map(Paths::get)
        .anyMatch(path -> Files.exists(path.resolve(exec))); 
```

替换`anyMatch(...)`为`filter(...).findFirst()`以获得完全合格的路径。

* * *

这是一个跨平台的静态方法，用于比较常见的可执行扩展：

```
import java.io.File;
import java.nio.file.Paths;
import java.util.stream.Stream;

import static java.io.File.pathSeparator;
import static java.nio.file.Files.isExecutable;
import static java.lang.System.getenv;
import static java.util.regex.Pattern.quote;

public static boolean canExecute( final String exe ) {
  final var paths = getenv( "PATH" ).split( quote( pathSeparator ) );
  return Stream.of( paths ).map( Paths::get ).anyMatch(
    path -> {
      final var p = path.resolve( exe );
      var found = false;

      for( final var extension : EXTENSIONS ) {
        if( isExecutable( Path.of( p.toString() + extension ) ) ) {
          found = true;
          break;
        }
      }

      return found;
    }
  );
} 
```

这应该解决对第一个解决方案的大多数批评。此外，遍历[`PATHEXT`](https://superuser.com/a/228693/9067)系统环境变量可以避免硬编码扩展，但也有其自身的缺点。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-01T10:00:41.043

我不是 scala 程序员，但我会用任何语言执行类似 ' `svn help`' 之类的操作，以检查 exec 方法的返回码（0 或 1）...如果失败，则 svn 不在路径：P

```
Runtime rt = Runtime.getRuntime();
Process proc = rt.exec("svn help");
int exitVal = proc.exitValue(); 
```

按照惯例，值 0 表示正常终止。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-01-14T05:18:56.233

Selenium 在类中看起来是一个相当完整的 Windows/Linux/Mac 实现[`org.openqa.selenium.os.ExecutableFinder`](https://github.com/SeleniumHQ/selenium/blob/selenium-3.6.0/java/client/src/org/openqa/selenium/os/ExecutableFinder.java#L31)，`public`从 Selenium 3.1 开始就可以访问（以前只能通过不推荐使用的方法访问`org.openqa.selenium.os.CommandLine#find`）。虽然它是 ASL 2.0。

请注意，这在 Windows`ExecutableFinder`上无法理解[`PATHEXT`](https://stackoverflow.com/a/7839178/14379)- 它只有一组硬编码的可执行文件扩展名（.exe、.com、.bat）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-06-28T10:43:05.647

此代码在 Windows 上使用“where”命令，在其他系统上使用“which”命令来检查系统是否知道 PATH 中所需的程序。如果找到，该函数返回一个 java.nio.file.Path 给程序，否则返回 null。

我在 Windows 7 和 Linux Mint 17.3 上使用 Java 8 对其进行了测试。

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.logging.Logger;

public class SimulationUtils
{
    private final static Logger LOGGER = Logger.getLogger(SimulationUtils.class.getName());

    public static Path lookForProgramInPath(String desiredProgram) {
        ProcessBuilder pb = new ProcessBuilder(isWindows() ? "where" : "which", desiredProgram);
        Path foundProgram = null;
        try {
            Process proc = pb.start();
            int errCode = proc.waitFor();
            if (errCode == 0) {
                try (BufferedReader reader = new BufferedReader(new InputStreamReader(proc.getInputStream()))) {
                    foundProgram = Paths.get(reader.readLine());
                }
                LOGGER.info(desiredProgram + " has been found at : " + foundProgram);
            } else {
                LOGGER.warning(desiredProgram + " not in PATH");
            }
        } catch (IOException | InterruptedException ex) {
            LOGGER.warning("Something went wrong while searching for " + desiredProgram);
        }
        return foundProgram;
    }

    private static boolean isWindows() {
        return System.getProperty("os.name").toLowerCase().contains("windows");
    }
} 
```

要使用它：

```
 System.out.println(SimulationUtils.lookForProgramInPath("notepad")); 
```

在我的 Windows 7 系统上，它显示：

> C:\Windows\System32\notepad.exe

在 linux 上：

```
 System.out.println(SimulationUtils.lookForProgramInPath("psql")); 
```

> /usr/bin/psql

这种方法的优点是它可以在任何平台上工作，并且不需要解析 PATH 环境变量或查看注册表。即使找到了所需的程序，也永远不会调用它。最后，不需要知道程序扩展。Windows 下的 gnuplot.exe 和 Linux 下的 gnuplot 都可以通过相同的代码找到：

```
 SimulationUtils.lookForProgramInPath("gnuplot") 
```

欢迎提出改进建议！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T14:27:03.737

关于最初的问题，我也会按照 FMF 的建议检查是否存在。

我还想指出，您至少必须处理流程的输出，读取可用数据，这样流就不会被填满。否则，这将导致进程阻塞。

为此，请使用 proc.getInputStream()（用于 System.out）和 proc.getErrorStream()（用于 System.err）检索进程的 InputStream，并在不同线程中读取可用数据。

我只是告诉你，因为这是一个常见的陷阱，并且 svn 可能会产生相当多的输出，所以请不要对离题投反对票；）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-09-28T14:08:30.283

这类似于的答案，但它也解决了在环境变量[`Dmitry Ginzburg`](https://stackoverflow.com/a/23539220/3764804)中存在无效路径的罕见情况。`PATH`这会导致`InvalidPathException`.

```
private static final String ENVIRONMENT_VARIABLES_TEXT = System.getenv("PATH");

private static boolean isCommandAvailable(String executableFileName)
{
    String[] environmentVariables = ENVIRONMENT_VARIABLES_TEXT.split(File.pathSeparator);
    for (String environmentVariable : environmentVariables)
    {
        try
        {
            Path environmentVariablePath = Paths.get(environmentVariable);
            if (Files.exists(environmentVariablePath))
            {
                Path resolvedEnvironmentVariableFilePath = environmentVariablePath.resolve(executableFileName);
                if (Files.isExecutable(resolvedEnvironmentVariableFilePath))
                {
                    return true;
                }
            }
        } catch (InvalidPathException exception)
        {
            exception.printStackTrace();
        }
    }

    return false;
} 
```

总的来说，这可能是现在最有效和最强大的解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T16:26:12.563

如果你安装了 cygwin，你可以先调用“which svn”，如果它在可执行路径中，它将返回 svn 的绝对路径，否则返回“which: no svn in (...)”。如果未找到，则对“which”的调用将返回 1，如果找到则返回 0。您可以通过 FMF 详细信息的方式检查此错误代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-11-01T23:15:37.573

以我的经验，仅通过调用带有`ProcessBuilder`是否退出的命令来判断各种系统是不可能的（`Exceptions`返回值似乎都不一致）

所以这里有一个Java7的解决方案，它遍历`PATH`环境变量并寻找匹配的工具。如果目录将检查所有文件。`matchesExecutable`必须是忽略扩展名和大小写的工具的名称。

```
public static File checkAndGetFromPATHEnvVar(final String matchesExecutable) {
    String[] pathParts = System.getenv("PATH").split(File.pathSeparator);
    for (String pathPart : pathParts) {
        File pathFile = new File(pathPart);

        if (pathFile.isFile() && pathFile.getName().toLowerCase().contains(matchesExecutable)) {
            return pathFile;
        } else if (pathFile.isDirectory()) {
            File[] matchedFiles = pathFile.listFiles(new FileFilter() {
                @Override
                public boolean accept(File pathname) {
                    return FileUtil.getFileNameWithoutExtension(pathname).toLowerCase().equals(matchesExecutable);
                }
            });

            if (matchedFiles != null) {
                for (File matchedFile : matchedFiles) {
                    if (FileUtil.canRunCmd(new String[]{matchedFile.getAbsolutePath()})) {
                        return matchedFile;
                    }
                }
            }
        }
    }
    return null;
} 
```

这里是帮手：

```
public static String getFileNameWithoutExtension(File file) {
        String fileName = file.getName();
        int pos = fileName.lastIndexOf(".");
        if (pos > 0) {
            fileName = fileName.substring(0, pos);
        }
        return fileName;
}

public static boolean canRunCmd(String[] cmd) {
        try {
            ProcessBuilder pb = new ProcessBuilder(cmd);
            pb.redirectErrorStream(true);
            Process process = pb.start();
            try (BufferedReader inStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream()))) {
                while ((inStreamReader.readLine()) != null) {
                }
            }
            process.waitFor();
        } catch (Exception e) {
            return false;
        }
        return true;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-25T11:22:26.087

你可以在windows下使用where命令。假设您检查 git-bash.exe 应用程序是否在 Windows 路径上。您必须运行 shell 命令：cmd /c where git-bash. 然后在返回的修剪后的字符串上，您可以执行以下操作： if(shellResult!=null && shellResult.endsWith('git-bash.exe')) ..... do yout things

# c# - 如何将 xml 保存在 webbrowser 控件中？

> ID：934192
> 
> 赞同：0
> 
> 时间：2009-06-01T09:52:48.720
> 
> 标签：c#, html, xml, text, webbrowser-control

我有一个显示一些 xml 的 webbrowser 控件，当我访问文档属性时，我得到了控件生成的 HTML，而不是 xml。如何保存文档的“来源”？（不能使用网络客户端）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T06:56:50.287

你有原来的路径，不是吗？

```
string urlPath = wb.Url; 
```

为什么不从那里下载源代码？

```
private string GetSourceCode(string sourceUrl) {
   String url = String.Format(sourceUrl);

   WebClient client = new WebClient();
   client.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0;)"); // pass as Internet Explorer 7.0

   Stream data = client.OpenRead(url);
   StreamReader reader = new StreamReader(data);
   s = reader.ReadToEnd();
   data.Close();
   reader.Close();

   return s;
} 
```

使用 GetSourceCode() 方法，您在返回的字符串中拥有整个源（原始源）......用它做你想做的事；）

```
string xmlSource = GetSourceCode(wb.Url); 
```

# feedback - 我在哪里可以讨论我创建的特定架构/实现并获得良好的反馈？

> ID：934197
> 
> 赞同：0
> 
> 时间：2009-06-01T09:54:57.280
> 
> 标签：feedback

假设我想出了一个我认为是针对编码项目中常见的通用需求的简洁优雅的解决方案。我很高兴分享我的代码，但我发布它的主要动机是从优质受众那里获得关于我的解决方案的反馈，并确定它是否在其他地方做得更好，是否可以做得更好，是否有问题，等等。程序员想要反馈的正常原因。

*   [代码项目](http://www.codeproject.com)- 丑陋的论坛/评论界面，当您想在文章分类后更新文章时会感到非常痛苦。有时也可能非常缓慢。
*   [CodePlex](http://www.codeplex.com) - 不是一个真正的通用代码社区；人们必须提前知道他们在寻找什么才能找到我的代码。

如果 Stack Overflow 团队制作了类似 The Code Project 的简化版本以允许用户展示代码片段并获得反馈，从而提高每个参与人员的一般技能，那将是非常棒的。有点像 Scott Hanselman 的每周源代码博客文章，但更多的是公共目的。然而，与此同时，你有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-04-21T16:52:37.597

> 如果 Stack Overflow 团队制作了类似 The Code Project 的简化版本以允许用户展示代码片段并获得反馈，从而提高每个参与人员的一般技能，那将是非常棒的。

现在有一个专门用于此目的的姊妹问答网站——[代码审查](http://codereview.stackexchange.com)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T14:15:37.283

您可以在此处发布您的解决方案，作为对描述它建议解决的问题的问题的回答。

您可能至少会得到一些反馈，并看到类似解决方案的其他编辑/版本。

# sql-server - MSSQL：last_user_update 是否意味着索引会损害性能？

> ID：934199
> 
> 赞同：0
> 
> 时间：2009-06-01T09:56:42.580
> 
> 标签：sql-server, performance, maintenance

我编写了一个查询来查找在生产环境中未使用的索引以删除它们，但是我很好奇该`last_user_update`列是否表明索引只是维护开销，在这种情况下它将是删除它很好，或者索引是否有助于插入/更新/删除语句的性能，在这种情况下我不想删除它。以下是我想使用的查询：

```
DECLARE @DBInfo TABLE  
( database_id int, object_id int, tablename nvarchar(200), indexname nvarchar(200), lastactivity datetime)  

DECLARE @command VARCHAR(5000)  

SELECT @command = 'Use [' + '?' + '] SELECT  
database_id, o.object_id, o.name, i.name as indexname, max(lastactivity) as lastactivity
from (
    select database_id, object_id, index_id, max(last_user_seek) as lastactivity from sys.dm_db_index_usage_stats
    WHERE object_id > 1000
    GROUP BY database_id, object_id, index_id
    UNION ALL
    select database_id, object_id, index_id, max(last_user_scan) as lastactivity from sys.dm_db_index_usage_stats
    WHERE object_id > 1000
    GROUP BY database_id, object_id, index_id
    UNION ALL
    select database_id, object_id, index_id, max(last_user_lookup) as lastactivity from sys.dm_db_index_usage_stats
    WHERE object_id > 1000
    GROUP BY database_id, object_id, index_id
    /*UNION ALL
    select database_id, object_id, index_id, max(last_user_update) as lastactivity from sys.dm_db_index_usage_stats
    WHERE object_id > 1000
    GROUP BY database_id, object_id, index_id*/
) a
inner join sys.objects o on a.object_id = o.object_id
inner join sys.indexes i on i.object_id = a.object_id AND i.index_id = a.index_id
where database_id = db_id()
GROUP BY database_id, o.object_id, o.name, i.name
order by lastactivity'  
INSERT INTO @DBInfo  
   (database_id, object_id, tablename, indexname, lastactivity)  
EXEC sp_MSForEachDB @command  

SELECT db_name(database_id) as dbname, tablename, indexname, lastactivity FROM @DBInfo
where lastactivity < dateadd(day, -15, getdate()) or lastactivity is null
order by db_name(database_id), tablename, indexname 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T10:21:45.587

该列在检查未使用的索引时没有任何实际意义。

索引可能没有最近的更新，但仍然非常有用（例如，避免表扫描或覆盖流行的查询）。此查询告诉您如何使用索引：

```
SELECT
    o.name AS [object_name], 
    i.name AS index_name, 
    i.type_desc, 
    u.user_seeks, u.user_scans, 
    u.user_lookups, u.user_updates,
    o.type
FROM
    sys.indexes i
    JOIN
    sys.objects o ON i.[object_id] = o.[object_id]
    LEFT JOIN 
    sys.dm_db_index_usage_stats u ON i.[object_id] = u.[object_id] AND 
                                    i.index_id = u.index_id AND 
                                    u.database_id = DB_ID()
WHERE
    o.type IN ('U', 'V') AND
    i.name IS NOT NULL
ORDER BY 
    o.name, i.NAME; 
```

编辑，评论后：

我更喜欢`user_seeks, user_scans, user_lookups and user_updates`告诉我如何使用索引的列。仅供参考，我使用了上面的查询并包含“system_updates”列，但所有值都为零（SQL 2005、50Gb 左右的数据库，我们之前使用过这个效果很好）

从[`sys.dm_db_index_usage_stats`](http://msdn.microsoft.com/en-us/library/ms188755.aspx)

> user_updates 计数器指示由对基础表或视图的插入、更新或删除操作引起的索引维护级别。您可以使用此视图来确定哪些索引仅由您的应用程序轻度使用。您还可以使用该视图来确定哪些索引会产生维护开销。您可能需要考虑删除会导致维护开销但不用于查询或仅不经常用于查询的索引。

所以，最后一句话意味着要查看使用情况和更新

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T10:29:46.523

如果你对索引的*动态*属性感兴趣——无论它们是否被使用——你最好在 DMV 中查询——[动态管理视图](http://www.codeproject.com/KB/database/Dynamic_Management_Views.aspx)。他们应该为您提供有关正在使用哪些索引以及使用频率的很好的信息。

此外，还有一个 DMV 实际上使用查询优化器的内部统计信息来建议 a) 可能有助于提高性能的可能丢失的索引，以及 b) 另一个显示可能未使用的索引。

请注意-这些是*动态*管理视图-每次服务器重新启动时都会重置它们，因此它们不会在永恒的时间段内收集数据-仅在您上次重置后。

马克

查找缺失的索引：

```
SELECT  
    object_name(object_id), d.*, s.*
FROM
    sys.dm_db_missing_index_details d 
INNER JOIN 
    sys.dm_db_missing_index_groups g ON d.index_handle = g.index_handle
INNER JOIN 
    sys.dm_db_missing_index_group_stats s ON    g.index_group_handle = s.group_handle
WHERE   
    database_id = db_id()
ORDER BY  
    object_id 
```

查找未使用的索引：

```
DECLARE  @dbid INT

SELECT @dbid = DB_ID(DB_NAME())

SELECT   
    OBJECTNAME = OBJECT_NAME(I.OBJECT_ID),
    INDEXNAME = I.NAME,
    I.INDEX_ID
FROM     
    SYS.INDEXES I
JOIN 
    SYS.OBJECTS O ON I.OBJECT_ID = O.OBJECT_ID
WHERE    
    OBJECTPROPERTY(O.OBJECT_ID, 'IsUserTable') = 1
    AND I.INDEX_ID NOT IN (SELECT S.INDEX_ID
                            FROM SYS.DM_DB_INDEX_USAGE_STATS S
                            WHERE S.OBJECT_ID = I.OBJECT_ID
                                    AND I.INDEX_ID = S.INDEX_ID
                                    AND DATABASE_ID = @dbid)
ORDER BY 
    OBJECTNAME,
    I.INDEX_ID,
    INDEXNAME ASC 
```

# c# - OneTransaction 中的批量复制和删除

> ID：934204
> 
> 赞同：1
> 
> 时间：2009-06-01T09:58:35.930
> 
> 标签：c#, sql-server, ado.net

在 C# 应用程序中，我喜欢将表数据从一台服务器（SQLServer2000）复制到另一台服务器（SQLServer2005）。我喜欢复制单个实例中的数据并删除 SQL Server 2000 表中的现有数据。我需要在单个事务中完成所有这些（批量复制和删除）。如何做到这一点？

注意：我有两个不同的 sql server 连接如何为单个事务实现这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T10:04:54.717

为了最大限度地减少事务的持续时间，我总是通过批量复制到*暂存*表（相同的模式，但不同的名称 - 没有索引等）来做到这一点，然后一旦所有数据都在服务器上，执行以下操作：

```
BEGIN TRAN

DELETE FROM FOO

INSERT FOO ...
SELECT ...
FROM FOO_STAGING

COMMIT TRAN

DELETE FROM FOO_STAGING 
```

（事务可以在 TSQL 中，也可以在通过托管代码或通过的连接上`TransactionScope`；TSQL 可以是命令文本，也可以是 SPROC）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T19:05:14.453

您可以使用[链接服务器](http://msdn.microsoft.com/en-us/library/ms188279.aspx)来执行此操作，尽管我从未尝试在 SQL2005 和 SQL2000 实例之间执行此操作。在您的 SQL2005 实例上：

```
sp_addlinkedserver Sql2000Server --Only need to do this once on the server

BEGIN TRAN

INSERT INTO dbo.MyTable (id, column) 
    SELECT id, column FROM Sql2000Server.MyDatabase.dbo.MyTable
DELETE FROM Sql2000Server.MyDatabase.dbo.MyTable
--etc...

COMMIT TRAN 
```

有关添加/删除链接服务器的语法，请参阅 Microsoft 在线书籍 ( [http://msdn.microsoft.com/en-us/library/ms190479.aspx](http://msdn.microsoft.com/en-us/library/ms190479.aspx) )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T10:14:38.670

除了链接服务器建议之外，您还可以使用 SSIS，这将是我的首选方法。

# sql - 排序不同的日期列

> ID：934206
> 
> 赞同：0
> 
> 时间：2009-06-01T10:01:15.957
> 
> 标签：sql, sql-server, tsql

我需要与日期列不同的年份和月份，这些日期列将按同一列排序。

我的日期库具有 (YYYY/MM/DD) 之类的值

```
2007/11/7
2007/1/8
2007/11/4
2007/12/3
2008/10/4
2009/11/5
2008/5/16 
```

查询后，应该是

```
2007/1/1
2007/11/1
2007/12/1
2008/5/1
2008/10/1
2009/11/1 
```

这似乎不起作用

```
SELECT distinct (cast(year(datecol) as nvarchar(20) ) +
       '/'+ cast(month(datecol) as nvarchar(20) ) + '/1') as dt1 
FROM Table 
ORDER BY dt1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T10:15:03.027

像这样的东西可以在 MS SQL Server 上运行：

```
select 
    distinct 
    dateadd(day, -1 * DAY(datefield) + 1, datefield)
From
    datetable
order by
    dateadd(day, -1 * DAY(datefield) + 1, datefield) 
```

DATEADD 函数调用基本上从当前日期减去 (day-1) DAYS --> 你总是得到该日期所在月份的第一个月。

按它排序，你就完成了！:-)

此外，您还可以将此功能作为“计算列”添加到您的表中，然后使用它来轻松访问：

```
alter table yourTable 
  add FirstOfMonth As DATEADD(day, -1 * DAY(datefield) + 1, datefield) persisted 
```

那么你的查询会更简单：

```
SELECT DISTINCT FirstOfMonth
FROM YourTable
ORDER BY FirstOfMonth 
```

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T10:08:01.217

在 SqlServer 中处理日期时避免`cast`这样使用 - 结果格式将根据服务器配置而改变。

而是使用[`convert`](http://msdn.microsoft.com/en-us/library/ms187928.aspx)并选择一种在月份中添加前导零的格式（例如 112）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T10:39:58.390

Anil，你在约会中也有时间吗？您为该列使用什么数据类型？您使用的是 DateTime dataType 还是 Char ？

这对我有用

```
SELECT DISTINCT (DateField) AS Date FROM DateTable ORDER BY 1 
```

# c - C中的XML签名验证库？

> ID：934213
> 
> 赞同：5
> 
> 时间：2009-06-01T10:03:59.523
> 
> 标签：c, xml, verification, xmlsec, xml-signature

是否有任何可用的 C 语言库来验证 XML 签名？我只能从[http://santuario.apache.org/cindex.html](http://santuario.apache.org/cindex.html)找到一个 C++ 库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T10:06:12.047

这里有一个：[XML Security Library (xmlsec)](http://www.aleksey.com/xmlsec/) is a C library based on LibXML2

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-21T09:54:20.210

除了 Apache XML 安全套件和 XMLSec，您还可以查看 Microsoft 的基于 DCOM 的[XML 签名实现](http://msdn.microsoft.com/en-us/library/ms757845(VS.85).aspx)。对于 Win7 Web 服务堆栈，当然还有一个 XML 签名实现，但它似乎没有在 API 中公开。

基督教

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-05-06T10:26:54.333

System.Security.Cryptography.Xml

SignedXml sx = new SignedXml((XmlElement)responseDocument.GetElementsByTagName("tns:CreateCertificateResponse")[0]); XmlNodeList nodeList = responseDocument.GetElementsByTagName("Signature"); foreach (XmlElement element in nodeList) { // 加载签名节点。sx.LoadXml(元素); sx.CheckSignature(bankSigningCertificate, true); }

这是您可以在 C# 中验证签名的方法。使用这个库“System.Security.Cryptography.Xml”

对于 c，请通过以下链接 [http://msdn.microsoft.com/en-us/library/aa382384%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa382384%28v=vs.85%29.aspx)

# c# - .NET C# 组件的通知或警报框架

> ID：934218
> 
> 赞同：3
> 
> 时间：2009-06-01T10:06:09.830
> 
> 标签：c#, components, notifications

我正在寻找可以在我的应用程序中作为单独模块使用的通知或警报框架，我可以只使用框架的功能。有什么好的吗？

我需要不使用来自其他供应商的太多 dll 的框架来完成一些工作..只需连接到 .net 框架 dll

诸如电子邮件之类的通知是基本的...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T01:44:30.463

我们正在使用 log4net，并且发现它具有很大的灵活性。我们也有自己的包装类，它在我们所有的项目中都使用，允许我们使用静态方法写入定义的日志。Log4net 带有一个 dll，当然还有我们的 wrapper dll。很容易扩展它以增加功能，我们的包装类现在允许我们在需要时写入 Windows 事件日志。

有很多关于如何实现 log4net 的示例，它提供了很多写入/发送日志信息的方法：http: [//logging.apache.org/log4net/release/config-examples.html](http://logging.apache.org/log4net/release/config-examples.html)

我们的包装器的示例实现：

```
Log.Error("Message", this);
Log.Error("Message", Exception, this);
Log.Error("Message", Exception, Type);
Log.Info("Message", this);
Log.Warn("Message", this); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-01T20:58:09.653

企业框架的微软企业日志模块可以根据您的目的进行配置。它支持多种渠道，包括电子邮件和跟踪文件。它可以通过更改应用程序的配置文件来重新配置。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-01T16:40:54.117

像 log4Net 之类的东西？或消息队列系统，sks MSMQ

# python - python 数据库连接

> ID：934221
> 
> 赞同：0
> 
> 时间：2009-06-01T10:08:00.623
> 
> 标签：python

我有一个脚本，它建立一个数据库连接并执行一些选择操作。根据获取数据，我正在调用不同的函数，这些函数也执行数据库操作。我如何将数据库连接传递给我不想调用的函数建立新的联系

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T12:58:26.223

Why to pass connection itself? Maybe build a class that handles all the DB-operation and just pass this class' instance around, calling it's methods to perform selects, inserts and all that DB-specific code?

# arrays - 按值在数组中搜索哈希

> ID：934225
> 
> 赞同：8
> 
> 时间：2009-06-01T10:11:05.670
> 
> 标签：arrays, perl, hash, perl-data-structures

我有一个函数可以将 Excel 数据提取到一个哈希数组中，如下所示：

```
 sub set_exceldata {

    my $excel_file_or = '.\Excel\ORDERS.csv';
    if (-e $excel_file_or) {

        open (EXCEL_OR, $excel_file_or) || die("\n can't open $excel_file_or: $!\n");                   
        while () {

            chomp;
            my ( $id, $date, $product, $batchid, $address, $cost ) = split ",";
            my %a = ( id      => $id
                    , date    => $date
                    , product => $product
                    , batchid => $batchid
                    , address => $address
                    , cost    => $cost
                    );
            push ( @array_data_or, \%a );
        }
        close EXCEL_OR;
    }
} 
```

填充哈希数组很好。但是，困难的部分是在数组中搜索特定项目（哈希）。我似乎无法找到可能具有 id 或 21、batchid 为 15 或成本 > 20 美元等的项目。

我将如何实施这样的搜索工具？

谢谢大家，

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-01T10:24:28.360

借助[grep的力量](http://perldoc.perl.org/functions/grep.html)

```
my @matching_items = grep {
  $_->{id} == 21
} @array_data_or; 
```

如果您知道只会退回一件商品，您可以这样做：

```
my ($item) = grep {
  $_->{id} == 21
} @array_data_or; 
```

（未经测试，我已经有一段时间没有写其中之一了，但这应该可以）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-01T12:33:14.450

If you're sure that the search always returns only one occurence or if you're interested in only the first match then you could use the 'first' subroutine found in [List::Util](http://search.cpan.org/~gbarr/Scalar-List-Utils-1.21/lib/List/Util.pm)

```
use List::Util;

my %matching_hash = %{ first { $_->{id} == 21 } @array_data_or }; 
```

I enclosed the subroutine call in the **%{ }** block to ensure that the RHS evaluates to a hash.

# html - 可访问的文本框

> ID：934230
> 
> 赞同：1
> 
> 时间：2009-06-01T10:13:49.473
> 
> 标签：html, accessibility

我有一个带有许多文本框的 HTML 页面。我必须为可访问性目的标记它们。但是，我不希望标签可见。这可能吗？或者，还有其他设计方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T10:17:57.763

有多种方法可以将文本放在页面中，并将其隐藏给视觉用户，而屏幕阅读器用户可以访问（例如高负文本缩进）。

然而，“可访问性”并不是“使用网络没有问题的人”和“盲人”之间的界限。有很多人不属于这两个群体，作者太容易也太普遍忘记可访问性不仅仅是为看不见的人提供内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T11:14:36.120

使用 display:none 对此不好，我支持关于为什么要隐藏所有标签的查询 - 您可能使用一些标签来通知用户 textarea 包含的内容，所以只需将其标记为相应的标签和样式。

如果您仍想隐藏标签，最好将其放置在屏幕外。最近[在 456 Berea Street 博客上对此进行了总结](http://www.456bereastreet.com/archive/200905/hiding_with_css_problems_and_solutions/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T10:47:57.377

标签的重点是描述输入的目的，有点像给它一个标题。如果您不使用标签，您的视力正常的用户将如何知道要在输入中输入什么？

任何给视力正常的用户提供视觉线索的东西也应该是辅助技术用户的标签。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-11T19:04:36.653

如前所述，最好为所有输入元素设置一个可见标签——这将有助于有视力和无视力的用户。话虽如此，在某些情况下这是不可行的，我猜你的情况属于这种情况。对于这些情况，您有几个选择。

第一种是使用“title”属性，它的额外好处是为有视力的用户显示工具提示：

```
<input type="text" title="first name" /> 
```

其他几个人提到了第二个选项，它涉及使用 CSS 将标签放置在屏幕之外：

```
<label for="first_name" 
  style="position:absolute;left:-1000px;width:1px;overflow:hidden;" />
<input type="text" id="first_name" /> 
```

与使用“display:none”不同，屏幕阅读器仍会读取标签。选择禁用 CSS 的用户也会看到标签，这也很优雅。

无论您使用什么，我绝对建议您从[Freedom Scientific](http://freedomscientific.com)下载JAWS[的试用版](http://freedomscientific.com/products/fs/jaws-product-page.asp)并测试您的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T10:16:51.213

带水印的文本框呢？

例如[http://www.asp.net/AJAX/AjaxControlToolkit/Samples/TextBoxWatermark/TextBoxWatermark.aspx](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/TextBoxWatermark/TextBoxWatermark.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T10:43:42.843

试试 CSS：

```
label {
    display: none;
} 
```

确保仅将此样式表应用于“屏幕”媒体：

```
<link rel="stylesheet" href="style.css" type="text/css" media="screen" /> 
```

# java - 休眠自动加入条件

> ID：934231
> 
> 赞同：0
> 
> 时间：2009-06-01T10:14:04.947
> 
> 标签：java, hibernate, join, persistence

Hibernate 持久化类：@Entity public class A {

```
 @OneToMany(mappedBy = "a")
    private Set<B> bSet = new HashSet<B>();

    @Basic
    private boolean DELETED;

} 
```

B 类也有一个 DELETED 属性。我们如何在连接期间自动处理 DELETED 属性，仅选择未删除的实体。可能需要一些注释的帮助。有可能的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T10:32:35.283

根据[Hibernate 文档](http://docs.jboss.org/hibernate/stable/core/reference/en/html/querycriteria-associations.html)，您应该使用 ResultTransformer (ALIAS_TO_ENTITY_MAP)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T14:41:37.527

很多谢谢！这是我的决心：

```
@Entity
public class A extends DeletableEntity{

    @OneToMany(mappedBy = "a")
    @Where(clause = "DELETED=0 or DELETED is null")
    private Set<B> bSet = new HashSet<B>();

    public Set<B> getBSet() {
        return bSet;
    }

    public void setBSet(Set<B> bSet) {
        this.bSet = bSet;
    }
} 
```

和 HQL "select a.DELETED from A a join a.bSet bSet" 将生成本机 SQL，如下所示：

选择 a0_.DELETED as col_0_0_ from A a0_ inner join B bset1_ on a0_.id=bset1_.a_id**和（ bset1_.DELETED=0 或 bset1_.DELETED 为空）**

和 entityManager.find(...) 将正常工作:)

# vim - cscope 或 ctags 为什么选择一个而不是另一个？

> ID：934233
> 
> 赞同：142
> 
> 时间：2009-06-01T10:14:34.167
> 
> 标签：vim, kernel, ctags, cscope

我主要使用 vim / gvim 作为编辑器，并且正在考虑使用[lxr（Linux 交叉参考）](http://lxr.linux.no/)和[cscope](http://cscope.sourceforge.net/)或[ctags](http://ctags.sourceforge.net/)的组合来探索内核源代码。但是，我从未使用过[cscope](http://cscope.sourceforge.net/)或[ctags](http://ctags.sourceforge.net/)，我想听听考虑到我将 vim 用作主要编辑器，为什么会选择其中一个而不是另一个。

* * *

## 回答 #1

> 赞同：168
> 
> 时间：2009-06-01T11:52:57.103

ctags 启用了两个功能：允许您从函数调用跳转到它们的定义，以及全方位完成。第一个意味着当您结束对方法的调用时，点击`g]`或`CTRL-]`将跳转到定义或实现该方法的地方。第二个功能意味着当您键入`foo.`or`foo->`时，如果 foo 是一个结构，那么将显示一个带有字段完成的弹出菜单。

cscope 也有第一个特性——使用`set cscopetag`——但不是最后一个。然而，cscope 还增加了跳转到任何调用函数的地方的能力。

因此，就在代码库中跳转而言，ctags 只会将您带到实现函数的地方，而 cscope 也可以显示调用函数的位置。

为什么你会选择一个而不是另一个？嗯，我两个都用。ctags 更容易设置，运行速度更快，如果你只关心一种跳跃方式，它会显示更少的行。您可以运行`:!ctags -R .`并且`g]`可以正常工作。它还可以实现全方位的完整事物。

Cscope 非常适合更大、未知的代码库。设置很痛苦，因为 cscope 需要一个包含要解析的文件名列表的文件。同样在 vim 中，默认情况下没有设置键绑定 - 您需要`:cscope blah blah`手动运行。

为了解决第一个问题，我有一个`cscope_gen.sh`如下所示的 bash 脚本：

```
#!/bin/sh
find . -name '*.py' \
-o -name '*.java' \
-o -iname '*.[CH]' \
-o -name '*.cpp' \
-o -name '*.cc' \
-o -name '*.hpp'  \
> cscope.files

# -b: just build
# -q: create inverted index
cscope -b -q 
```

这将搜索我感兴趣的代码，创建 cscope.files 列表并创建数据库。这样我就可以运行 ":!cscope_gen.sh" 而不必记住所有的设置步骤。

我使用此代码段将 cscope 搜索映射到 ctrl-space x 2，这减轻了 cscope 的另一个不利因素：

```
nmap <C-@><C-@> :cs find s <C-R>=expand("<cword>")<CR><CR> 
```

有[这个 cscope_maps.vim 插件](http://cscope.sourceforge.net/cscope_maps.vim)，它设置了一堆类似的绑定。我永远记不起所有选项的含义，所以倾向于坚持使用 ctrl-space。

所以总结一下：ctags 更容易设置并且大部分工作而无需做太多其他事情，它对于全能也很重要。如果您必须维护大型且大部分未知的代码库，cscope 会提供更多功能，但需要更多的工作。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-06-01T14:06:07.193

几个月前我也有同样的情况...

ctags 缺乏精确性是一个痛苦。我发现 cscope 对于所有与宏相关的东西都要好得多（并且在 linux 内核中有一堆宏）。

关于用法，这实际上很简单...您只需在内核的根目录下键入 cscope -R ，然后您就不用担心了..（我的意思是，如果您只想探索那是完美的...）

那么，按键绑定都是基于Ctrl-\（对Ctrl过敏的可以重新映射），主要用s和g....，

为内核开发，我不需要这么多的完成......

无论如何，选择cscope，这更方便，更准确。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-12-28T23:06:07.427

嗯...您可能应该使用 etags 而不是 ctags...

如果你使用cscope，那么你可以看到调用链，即谁调用了这个函数&这个函数调用了哪些函数？

我不确定这是否可以使用 etags / ctags 来完成......

这只是一个功能......如何找出包含特定函数定义的文件？这只能在 cscope 中获得。

我*同时*使用cscope 和 etags，它们都适用于不同的事物，尤其是在使用大型代码库（例如 Linux 内核）时。事实上，当我开始使用 Linux Kernel / Xen 时，我就开始使用 cscope 和 etags。

LXR 不是很好，因为您必须单击、通过网络等，而您可以在内核代码上构建 cscope 和标签数据库，而*不必通过网络*（与 lxr 不同）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-30T08:50:23.807

建议使用全局 gtags。可以使用 vim 插件[gen_tags](https://github.com/jsfaint/gen_tags.vim)将 gtags 与 vim 集成。

# php - PHP 适合非常大的项目吗？它可以是交易安全的吗？

> ID：934236
> 
> 赞同：4
> 
> 时间：2009-06-01T10:15:18.377
> 
> 标签：php

这个问题可能看起来很奇怪。

但是以前每次做PHP项目的时候，都会遇到这种不好的体验：

脚本在 10 秒后取消运行。这会导致非常糟糕的数据库不一致（删除循环的错误示例：用户即将删除相册。相册对象从数据库中删除，然后在删除照片的一半时脚本在原处被杀死，并且10.000 张照片没有参考）。

它不是交易安全的。*我从来没有找到一种方法来安全地*做某事，以确保它*完成*。如果脚本被杀死，它就会被杀死。就在一个循环的中间。它会被杀死。这从未发生在带有 java 的 tomcat 上。Java 运行，运行，运行，如果它需要很长时间。

很多时事通讯脚本试图通过将工作拆分成很多包来解决这个问题，即一次发送 100 个，然后重新加载页面（哦，伙计，真的很愚蠢），做下一个，等等。大多数情况下，挂起或脚本需要超过 10 秒的时间，并且您的平台已瘫痪。

但是后来，我听说非常大的项目使用 PHP，例如 studivz（德国的 facebook 克隆，实际上是最大的德国网站）。所以有一点希望，这种不良行为只是来自不专业的托管公司，他们只是因为他们的服务器太糟糕而杀死了 php 脚本。这件事的真相是什么？能否以这样的方式进行配置，使脚本永远不会因为它们花费更长的时间而被杀死？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-01T12:04:08.783

> PHP 适合非常大的项目吗？

每当我看到这样的问题时，我都会感到有些不安。*很大*是什么意思？对你来说可能很大，对我来说可能很小，反之亦然。这甚至假设我们使用相同的指标。您是否在衡量构建项目的时间、项目的完整生命周期、所涉及的资金、使用它的人数、构建/维护它的开发人员数量等等。

也就是说，您所描述的问题听起来像是您对自己的技术不够了解。无论您选择哪种技术，这对您来说都是一个问题。例如，使用数据库事务来确保原子性。并使用异步离线作业来处理长时间运行的任务（例如发送邮件列表）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T10:20:47.930

如果不良行为被像 Zend 框架这样的良好框架所覆盖，那么很多。任何需要更长 10 秒的东西都真的搞砸了，但你总是可以使用[http://de3.php.net/set_time_limit来提高执行时间](http://de3.php.net/set_time_limit)

很多大型网站都是用 PHP 编写的：Facebook、Wikipedia、StudiVZ、Digg.com 等。你所说的很多东西都只是配置问题，也许你应该研究一下？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-01T10:18:10.213

您在寻找[set_time_limit()](http://us3.php.net/set_time_limit)和[ignore_user_abort()](http://us3.php.net/manual/en/function.ignore-user-abort.php)吗？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-01T12:17:28.177

性能不是您可以在大部分站点完成后才添加的功能。您必须为重负载设计网站。

如果一个数据库任务通常涉及 10K 行，那么您不仅要准备执行时间问题，还要准备其他维护问题。

*   最坏的情况：制作一个一致性工具来检查和修复这些错误。
*   更好：不要物理删除图像，只需标记它们并让后台服务处理昂贵的操作。
*   最佳：您可以使用作业队列服务并将此作业添加到队列中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T12:12:01.340

如果你确实需要在 php 中进行事务，你可以这样做：

```
mysql_query("BEGIN");

/// do your queries here

mysql_query("COMMIT"); 
```

提交命令只会完成事务。

如果发生任何错误，您可以回滚：

```
mysql_query("ROLLBACK"); 
```

**编辑：**请注意，这仅在您使用支持事务的数据库时才有效，例如 InnoDB

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T10:18:13.160

您可以在 php.ini 设置中或通过 ini_set/set_time_limit 配置允许执行脚本的时间

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-01T12:04:02.480

您可以查看完全是 PHP 的实际 Facebook，而不是 studivz（德国 Facebook 克隆）。或者迪格。或许多雅虎网站。或者很多很多其他的。

ignore_user_abort 可能是您正在寻找的，但您也可以在计划维护作业方面添加另一层。它们基本上以指定的时间间隔运行并执行各种操作以确保您的数据/文件系统处于您想要的状态......删除旧的/未链接的文件只是您可以做的许多事情之一。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-01T13:26:07.320

从技术上讲，没有一种编程语言是事务安全的，它是需要事务安全的数据库。因此，如果正在运行的脚本/代码终止或断开连接，无论出于何种原因，事务都将回滚。

将查询置于循环中是一个非常糟糕的主意，除非它专门设计为批量运行并将更大的集合分解成更小的部分。调整 PHP 计时器和限制通常是一种权宜之计，如果使用 Web 启动脚本，您仍然依赖于客户端浏览器。

如果我有一个需要由浏览器启动的长进程，我会“断开”该进程与浏览器和 Web 服务器的连接，以便在脚本运行时将控制权返回给用户。如果需要，从命令行运行的 PHP 脚本可以运行数小时。然后，您可以使用 AJAX 或重新加载页面来检查长时间运行的脚本的进度。

此代码存在安全问题，但要“断开”进程与在 Apache 等运行下运行的 PHP 的连接：

```
exec("nohup /usr/bin/php -f /path/to/script.php > /dev/null 2>&1 &"); 
```

但这与 PHP 适合大型项目或交易安全无关。PHP 可用于大型项目，但由于默认情况下没有代码在点击之间保持“常驻”，如果设计不当，它可能会变慢。此外，由于没有命名空间支持，如果您有一个大型开发团队，您需要提前计划。

对于基于 Java 的系统来说，花几分钟来启动、初始化和加载所有默认对象是可以的。但这对于 PHP 是不可接受的。PHP 将对更大的系统进行更多的规划。问题是，使用 PHP 节省的时间何时会被大型系统所需的额外规划时间浪费掉？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-01T13:04:55.307

对于这些大型循环，例如删除相册或发送 1000 封电子邮件，您需要查找 ignore_user_abort 和 set_time_limit。
像这样的东西：

```
ignore_user_abort(true); //users leaves webpage will not kill script
set_time_limit(0); //script can take as long as it wants
for(i=0;i<10000;i++)
 costly_very_important_operation(); 
```

但是要小心，这可能会永远运行脚本：

```
ignore_user_abort(true); //users leaves webpage will not kill script
set_time_limit(0); //script can take as long as it wants
while(true)
  do_something(); 
```

除非您重新启动服务器，否则该脚本将永远不会消失。

因此，最好不要将 time_limit 设置为 0。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-01T20:07:27.320

您过去很可能遇到数据库一致性不佳的原因是因为您使用的是 mysql 的 MyISAM 引擎（它不支持事务）。改用 InnoDB，它支持事务并执行行级锁定。或者使用 postgreSQL。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-06-01T12:51:49.670

Many, many software sites are made in PHP. However, you will not hear about millions of web pages made in PHP that do not exist anymore because they were abandoned. Those pages may have burned all company money for dealing with PHP mess, or maybe they bankrupted because their soft was so crappy that customer did not want it… PHP seems good at the startup, but it does not scale very well. Yes, there are many huge web sites made in PHP, but they are rather exceptions, than a norm.

# android - SQLite 异常：没有这样的表错误

> ID：934237
> 
> 赞同：16
> 
> 时间：2009-06-01T10:15:22.137
> 
> 标签：android, sqlite

> **可能重复：**
> [Android Sqlite - “没有这样的表”错误](https://stackoverflow.com/questions/6554269/android-sqlite-no-such-table-error)

我们正在尝试在 Android 上开发应用程序。我们正在使用 SQLite 数据库，在电话上我们得到

> SQLiteException：没有这样的表。

它在模拟器上运行良好。

任何人都可以对此提供任何意见吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-01T17:34:34.860

如果您没有正确指定数据库文件名，我相信它会退回到创建一个空数据库。这通常是“找不到表”的原因。检查您的路径和数据库文件名。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-08-18T03:20:44.503

我遇到过同样问题的不同风味。

`no such table`尝试插入时出现错误。

在插入之前，代码正在调用

```
mDb = mDbHelper.getWritableDatabase(); 
```

`getWritableDatabase()`, 第一次调用时会调用`onCreate()`

我让我的 SQL 查询在这个 oncreate 方法中创建表

```
public void onCreate(SQLiteDatabase db) {

            db.execSQL(DATABASE_CREATE);
            Log.v("INFO1","creating db");
            //Toast.makeText(mCtx, "created", Toast.LENGTH_SHORT).show();
        } 
```

所以对我来说，发生的事情是，`db`在应用程序首次运行时成功创建，但由于其他一些错误而没有表。以后无论何时运行应用程序，都不会像已经存在`onCreate()`的那样调用它，因此没有创建表，因此所有进一步的 SQL 命令都失败了。`db`

所以我把创建表移出了`onCreate()`，现在它可以工作了

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-21T10:54:11.947

有些人已经能够使用[此处](http://www.anddev.org/networking-database-problems-f29/missing-table-in-sqlite-with-specific-version-of-desire-hd-t50364.html)提到的步骤解决问题。在我看来，这个问题存在于某些版本的 Android 2.2 上。我已经在我的代码中加入了这个更改，尽管我仍在寻找 Beta 测试人员来看看它是否真的有效。

# c# - 如何在选中复选框时选择列表框中的所有项目？

> ID：934241
> 
> 赞同：31
> 
> 时间：2009-06-01T10:17:49.730
> 
> 标签：c#, winforms, listbox, .net-2.0

单击 CheckBox 时，我需要选择 ListBox 中的所有项目。是否可以使用一行代码选择 ListBox 中的所有项目？或者我是否必须遍历所有项目并将每个项目设置为 true？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2010-12-01T19:38:50.590

事实是这`ListBox.Items`是一个普通的对象集合并返回普通的无类型对象，不能被多选（默认情况下）。

如果您想多选所有项目，那么这将起作用：

```
 for (int i = 0; i < myListBox.Items.Count;i++)
   {
       myListBox.SetSelected(i, true);
   } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-12-21T06:24:54.070

我已经看到了许多（类似的）答案，所有这些在逻辑上都做同样的事情，我很困惑为什么它们都不适合我。关键是将列表框设置`SelectionMode`为`SelectionMode.MultiSimple`. 它不适用于`SelectionMode.MultiExtended`. 考虑在列表框中选择多个项目，您将选择模式设置为多个模式，并且大多数人都选择传统`MultiExtended`风格，这个答案应该会有很大帮助。而且你不是一个`foreach`，而是`for`。

你实际上应该这样做：

```
lb.SelectionMode = SelectionMode.MultiSimple;
for (int i = 0; i < lb.Items.Count; i++)
    lb.SetSelected(i, true);
lb.SelectionMode = //back to what you want 
```

或者

```
lb.SelectionMode = SelectionMode.MultiSimple;
for (int i = 0; i < lb.Items.Count; i++)
    lb.SelectedIndices.Add(i);
lb.SelectionMode = //back to what you want 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-22T21:47:22.113

据我所知，使用任何 .NET 方法来选择大量项目都比直接调用 PInvoke 慢得多，将 LB_SETSEL 消息 (0x185) 传递给控件，​​并带有一个指示您是否想要的标志选择 (1) 或取消选择 (0) 以及表示更改应应用于所有项目的魔法值 (-1)。

```
 [DllImport("user32.dll", EntryPoint = "SendMessage")]
  internal static extern IntPtr SendMessage(IntPtr hWnd, UInt32 msg, IntPtr wParam, IntPtr lParam);

  // Select All
  SendMessage(listBox.Handle, 0x185, (IntPtr)1, (IntPtr)(-1));

  // Unselect All
  SendMessage(listBox.Handle, 0x185, (IntPtr)0, (IntPtr)(-1)); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-01T10:38:09.453

我认为你必须在这里循环。一次选择所有项目是一个非常具体（并且可能很少见）的用例，开箱即用地提供该功能是没有意义的。此外，无论如何，循环将只是两行代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-27T13:34:32.897

我使用 Mika 的解决方案，但是如果您有数千个项目，这可能会非常慢。要大幅提高速度，您可以暂时关闭可见性。正如您可能怀疑的那样，列表框实际上不会在操作过程中消失，但在我的情况下，选择的速度至少快了 10 倍。

```
myListBox.Visible = false;
for (int i = 0; i < myListBox.Items.Count;i++)
{
    myListBox.SetSelected(i, true);
}
myListBox.Visible = true; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-02T17:58:10.320

在此构造函数中，您需要启用`MultiExtended`所需文本框的多选模式 ( )。

```
public Form1()
{
    InitializeComponent();
    listBox1.SelectionMode = SelectionMode.MultiExtended;
    listBox2.SelectionMode = SelectionMode.MultiExtended;
} 
```

在此之后，使用循环选择所有内容：

```
private void selectAll_Click(object sender, EventArgs e)
{
    for (int val = 0; val < listBox1.Items.Count; val++)
    {
        listBox1.SetSelected(val, true);
    }
} 
```

我测试了它。有用。您也可以使用**[CTRL/SHIFT] 按钮 + 左键单击**来单独选择项目。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-01-31T19:11:35.587

就我而言，我有 10k 多个项目，基本的循环方法需要将近一分钟才能完成。使用@DiogoNeves 回答并扩展它，我希望能够全选（Ctrl+A）和复制（Ctrl+C）。我处理了这两种方式。我使用 BeginUpdate() 和 EndUpdate() 来推迟绘图，但我还添加了一个直接复制所有 (Ctrl+Shift+C)，它甚至不需要在复制之前选择项目。

```
private static void HandleListBoxKeyEvents(object sender, KeyEventArgs e)
{
    var lb = sender as ListBox;
    // if copy
    if (e.Control && e.KeyCode == Keys.C)
    {
        // if shift is also down, copy everything!
        var itemstocopy = e.Shift ? lb.Items.Cast<object>() : lb.SelectedItems.Cast<object>();
        // build clipboard buffer
        var copy_buffer = new StringBuilder();
        foreach (object item in itemstocopy)
            copy_buffer.AppendLine(item?.ToString());
        if (copy_buffer.Length > 0)
            Clipboard.SetText(copy_buffer.ToString());
    }
    // if select all
    else if (e.Control && e.KeyCode == Keys.A)
    {
        lb.BeginUpdate();
        for (var i = 0; i < lb.Items.Count; i++)
            lb.SetSelected(i, true);
        lb.EndUpdate();
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-15T07:10:27.540

如果您有很多（100+）项，这绝对不是很好，但比循环快得多：选择列表框并模拟 [home] 和 [shift]+[end] 的键输入

```
lb.BeginUpdate();
lb.Select();
SendKeys.Send("{Home}");
SendKeys.Send("+{End}");
lb.EndUpdate(); 
```

编辑：仅适用于 SelectionMode.MultiExtended 我猜

DoubleEDit：还请注意，这对于之后使用 lb.selecteditems 执行的代码可能太慢，但对于用户将单击的 [全选] 按钮可能很有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-15T22:35:44.360

**Select All**绝对是开箱即用的：

```
$("#ListBoxID option").prop("selected", true); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-06-14T23:46:55.733

我知道这个问题是用 .NET 2.0 标记的，但是如果您在 3.5+ 中可以使用 LINQ，则可以执行以下操作：

> ASP.NET Web 窗体

```
var selected = listBox.Items.Cast<System.Web.UI.WebControls.ListItem>().All(i => i.Selected = true); 
```

> WinForms

```
var selected = listBox.SelectedItems.Cast<int>().ToArray(); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-03-25T11:37:07.333

我将nawfal 的想法添加到我已经拥有的东西中，这也是'BeginUpdate'。另外，正如用户所期望的那样，视图位置也得到了维护。对我来说，这似乎解决了所有问题：

```
public void SelectAll()
{
    bool prevBusy = MouseHelper.IsBusy;
    MouseHelper.IsBusy = true;
    int topIndex = TopIndex;

    // BUG: In 'SelectionMode.MultiExtended' the box gets crazy
    SelectionMode previousMode = this.SelectionMode;
    this.SelectionMode = SelectionMode.MultiSimple;

    this.BeginUpdate();

    for (int i = 0; i < Items.Count; i++)
    {
        SelectedIndices.Add(i);
    }

    this.EndUpdate();
    this.SelectionMode = previousMode;

    TopIndex = topIndex;
    MouseHelper.IsBusy = prevBusy;
} 
```

* * *

## 回答 #12

> 赞同：-5
> 
> 时间：2014-10-25T10:28:15.943

```
private void Button_Click(object sender, RoutedEventArgs e)
    {

            listbox.SelectAll();

    } 
```

# asp.net - 替换控制和缓存位置

> ID：934246
> 
> 赞同：1
> 
> 时间：2009-06-01T10:19:19.897
> 
> 标签：asp.net, caching, outputcache

如果我在 asp.net 页面中使用 Substitution 控件，并在页面中添加以下指令：

```
<%@ OutputCache Duration="7200" VaryByParam="None" Location="Any" %> 
```

是否会忽略 location 属性，因为在页面上使用 Substitution 控件会使页面只能在服务器上缓存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T10:30:48.877

是的，它将被忽略。Substition.Render 通过 RenderMarkup 调用 HttpResponse.WriteSubstitution 调用 HttpCachePolicy.SetCacheability(HttpCacheability.Server)。

# c++ - 支持不同的显示器分辨率

> ID：934251
> 
> 赞同：3
> 
> 时间：2009-06-01T10:21:17.210
> 
> 标签：c++, mfc, multiple-monitors

我有一个带有一些位图、对话框和菜单的 MFC 应用程序。目前它只支持一种显示器分辨率（1280x1024）。我计划为其添加不同的显示器分辨率支持。为此，我想我必须加载不同分辨率的位图、更改字体大小等。我的问题是，这些在典型的 Windows 应用程序中是如何处理的？他们是使用单个位图并根据显示器分辨率拉伸/收缩它，还是实际上在资源中有不同的位图集并根据分辨率动态加载它们？有没有标准的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T10:29:55.197

在过去，我使用了一张大图像并进行了相应的缩放。

确保调整菜单和对话框的大小很棘手，但 CodeProject 上有帮助代码可以提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T14:43:50.223

我会说使用具有不同分辨率的多种资源。虽然您可以动态缩放图标，但如果您在适当的图像编辑程序中调整它们的大小，它们可能看起来会更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T14:47:13.493

无论屏幕分辨率如何，菜单和工具栏图标通常以相同数量的像素显示。因此，随着分辨率的增加，菜单和工具栏占据的屏幕比例越来越小。

我认为没有任何标准方法可以处理涉及位图的不同分辨率。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T15:08:49.783

我还将确保您的应用程序适用于 Windows DPI 缩放。当在更高分辨率的显示器上运行而不是重新设计应用程序以满足特定分辨率时，这可能是一个更好的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T15:40:12.583

缩放位图看起来很糟糕（使它们变大总是看起来很糟糕，使它们变小取决于源）。如果可能的话，看看你是否可以用几个可以很好地缩放的小位图组成你的大位图。很多时候，制作一个可以很好地在一个方向上缩放的位图是相当容易的。例如，如果您想围绕某物制作一个框架，而不是使用一个位图，而是将其像井字棋盘一样切成 9 块。四个角块保持原来的大小，顶部和底部的部分水平伸展，左右垂直，中心是两个方向（如果有的话）。

# php - 是否可以使用 php 进行 mysql 数据库事务和回滚？

> ID：934254
> 
> 赞同：3
> 
> 时间：2009-06-01T10:22:13.043
> 
> 标签：php, mysql, transactions

示例：从用户 A 向用户 B 进行付款转账。用户 A 的账户：-10 美元 用户 B 的账户：+10 美元

如果有交易，并且出现问题，一切都会被撤消。因此，对于交易，用户 A 的账户不会减少 10，而用户 B 的账户不会增加 10。

我知道 java 人到处都在使用事务和回滚。但我从来没有听说过 PHP 人这样做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T10:27:31.317

```
$db = new mysqli("localhost", "", "", "");
$db->autocommit(FALSE);
if ($db->query("INSERT ..."))
    $db->commit();
else
    $db->rollback(); 
```

确保您的表使用`InnoDB`引擎：`MyISAM`不支持事务。

**评论更新**：

`InnoDB`是使用的两个主要存储引擎`MySQL`之一，另一个是`MyISAM`.

`MySQL`附带`InnoDB`默认编译的支持，实际上禁用它需要一些努力。

即使是最便宜的房东，我也从未听说过`MySQL`残疾人。`InnoDB`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T10:48:38.560

如果你使用 pdo，它也有事务支持

[http://us2.php.net/manual/en/pdo.begintransaction.php](http://us2.php.net/manual/en/pdo.begintransaction.php)

就像已经说过的那样，请确保使用 innoDB 存储引擎。

# .net - 如何使用 WebDav 将 dav:href 匹配到 Outolook Interop href 值

> ID：934257
> 
> 赞同：1
> 
> 时间：2009-06-01T10:23:11.870
> 
> 标签：.net, email, interop, outlook, webdav

我以前使用 webdav 根据主题和时间访问 Exchange 2003 服务器上发送的消息，这已经奏效。

我现在需要实现另一个功能，这意味着将消息从客户端 Outlook（不是 Web 访问）拖到 Windows 窗体上，然后在 Exchange 上查询 webdav 以获取有关此消息的所有信息。

我可以使用以下代码获取消息 href：

```
Dim msg As MAPI.Message = CType(session.GetMessage(mail.EntryID), MAPI.Message)
Dim id as string = CType(CType(msg.Fields(), MAPI.Fields).Item(&H6707001E), MAPI.Field).Value.ToString 
```

但是有两个问题；

1) URL 上的编码在我从拖动的消息中获得的内容和从 webdav 带回的内容之间是不同的（如果我要求所有邮件，我可以看到这些）。

2）无论我如何格式化查询，即使我在带回所有消息时从列表中复制 href，它也永远不会带回结果。

以下是失败的搜索请求示例（如果您删除 where 子句则有效）：

```
 <?xml version="1.0" ?>
    <D:searchrequest xmlns:D="DAV:">
        <D:sql>SELECT "DAV:contentclass","DAV:href", "DAV:displayname","urn:schemas:httpmail:datereceived","urn:schemas:httpmail:subject" 
FROM "https://server/exchange/mailbox" WHERE "DAV:href"='/Inbox/email.EML'</D:sql>
    </D:searchrequest> 
```

[根据本文](http://support.microsoft.com/kb/295408)，我一直在使用相对语法，但尝试了许多组合。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-30T13:33:03.503

这很啰嗦，但我还没有找到更好的方法：

Outlook.MailItem.EntryID 包含 4 个 Guid，尽管我不确定它们都映射到什么。最后一个 guid 包含您需要的信息。

00000000E6053DD369FAB340B6B8C4D77A0
B37D30700173A23D2AA06A3488E75E759DD
1ACBBB00000A6F78CC00007B9F3D877B316
4499DE695FBB7FCDE5F00000 **EBD83B** _

粗体部分是我们可以使用的消息 ID（在我的收件箱中的所有消息中，只有这 7 位数字在它们的条目 ID 之间有所不同）。

接下来，修改您的 webDAV 查询以恢复该`DAV:permanenturl`属性。这将如下所示：

[https://SERVER_NAME/exchange/MAILBOX@DOMAIN](https://SERVER_NAME/exchange/MAILBOX@DOMAIN) >COM/-FlatUrlSpace-/173a23d2aa06a3488e75e759dd1acbbb-a6f78cc/7b9f3d877b3164499de695fbb7fcde5f- **ebd83b9**

因此，匹配所需要做的就是对指定邮箱中的所有项目进行 webDAV 查询，循环比较**PermanentURL**和部分**EntryID**以找到匹配项。

如果 webDAV 上有一个 EntryID，我会更高兴，但似乎没有可直接访问的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T21:58:21.903

当我想弄清楚如何将 WebDav 发送到 Exchange 2003 时，我启动了 Fiddler2 并查看了 Outlook Web Access 正在发送的消息。如果要解压缩 https 响应，则需要 Fiddler2。

# c# - ToString() 自定义数字格式的奇数

> ID：934260
> 
> 赞同：2
> 
> 时间：2009-06-01T10:24:52.430
> 
> 标签：c#, asp.net, format, numbers, tostring

我正在尝试将格式为 123456 的数字转换为 123,456，我发现使用自定义格式为 N0 的 .NET ToString() 方法很容易。

然而，在一种数据情况下，我在使用这种方法时得到了奇怪的格式。

在这种情况下，我正在为我的输入表动态生成一个 DataTable 来测试代码。

```
DataTable dt = new DataTable();

dt.Columns.Add("Cases", typeof(Int32)); 
```

例如，我的数据在应用格式之前看起来像这样。

```
------------------------------------------
| 案例 | 第2495章 3937 | 3207 | 4173 | 4265 |
------------------------------------------
```

我希望它看起来像这样。

```
-------------------------------------------------
| 案例 | 2,495 | 3,937 | 3,207 | 4,173 | 4,265 |
-------------------------------------------------
```

我尝试使用这样的代码对其进行格式化。

```
output.Rows[r][c] = Convert.ToInt32(input.Rows[c - 1][r + 1]).ToString("N0"); 
```

*（注意：奇怪格式的原因是因为我正在获取一个 DataTable 并将其转置到另一个 DataTable。）*

使用上述格式，我现在返回以下数据。

```
-------------------------------------------------- ----------------------
| 案例 | 01/02/0495 | 0937 年 1 月 3 日 | 01/03/0207 | 0173 年 1 月 4 日 | 01/04/0265 |
-------------------------------------------------- ----------------------
```

然后我尝试使用小数点后一位：

```
output.Rows[r][c] = Convert.ToInt32(input.Rows[c - 1][r + 1]).ToString("N01"); 
```

这给了我以下结果。

```
-------------------------------------------------- ----
| 案例 | 2495.0 | 3937.0 | 3207.0 | 4173.0 | 4265.0 |
-------------------------------------------------- ----
```

现在这让我感到困惑，因为它接受了可以以这种方式格式化数字的事实。

我尝试的下一件事是用不同的方式来格式化字符串。

```
output.Rows[r][c] = string.Format("{0:N0}", input.Rows[c - 1][r + 1]);
output.Rows[r][c] = Convert.ToInt32(input.Rows[c - 1][r + 1]).ToString("#,##0"); 
```

这些都没有给出我想要的数字格式。谁能告诉我哪里出错了？是不是很简单，以至于我错过了重点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T10:30:19.983

在我看来，您只是`DataTable`错误地设置了列的数据类型。尝试将其明确化为`int`（目前看起来`DateTime`）。

另外 - 的工作`DataTable`是*保存*数据；不要显示它。您可以将其存储为预先格式化为`string`s，我猜（只要您*告诉*它列是字符串） - 但如果您将其存储为`int`，则忘记显示；一旦你运行`Convert.ToInt32`你的工作就结束了。它如何出现是`DataGridView`（或其他）的工作；说说“N0” *...*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T10:33:18.917

尝试在 ToString("N"); 中简单地使用 "N"

# iphone - 如果视图加载，请执行某些操作

> ID：934261
> 
> 赞同：0
> 
> 时间：2009-06-01T10:25:00.760
> 
> 标签：iphone, cocoa-touch, model-view-controller, uikit

我转移到我的观点

```
[[self navigationController] popToViewController:controller animated:YES]; 
```

在那个 ViewController 中，我无法得到通知，它回到了前面（例如通过 viewWillAppear）。一旦视图再次可见，我想重新加载一个表。

我如何得到通知，该视图返回到屏幕上？

----> 已解决：请参阅我对 Corey 回答的最后评论

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T10:38:59.233

如果您使用的是 UINavigationController，则应调用 viewWillAppear。

您确定已将其正确添加到视图层次结构中吗？

您是否检查了 viewWillDisappear 在屏幕外时是否被调用？

您是否尝试 viewDidAppear 只是为了确定？

您是否正确拼写了方法名称？

* * *

加上：

UINavigationController 的实例是否直接添加到 UIWindow 实例中？

像 viewWillappear 这样的委托方法是从 UIApplication 发送的（我相信）。UIApplication 只“知道” viewControllers 的视图是：

1.  直接添加到 UIWindow。

2.  添加到直接添加到 UIWindow（或导致 UIWindow 的这些链）的 UINavigationController/UITabBarCONtroller。

# c# - ListView - 如何避免闪烁（.NET/C#）？

> ID：934262
> 
> 赞同：1
> 
> 时间：2009-06-01T10:25:59.977
> 
> 标签：c#, .net, user-interface, components

我的应用程序是多线程的，它有 f.ex 25 个活动线程，每个线程将其状态推送到委托列表视图项。

例子：

```
 private delegate void SetBackColorDelegate(int index, Color color);
    private void SetBackColor(int index, Color color)
    {
        if (listView1.InvokeRequired)
        {
              listView1.Invoke(new SetBackColorDelegate(SetBackColor), new object[] { index, color });

        }
        else
        {
              listView1.Items[index].BackColor = color;
        }
    } 
```

根据状态，它会改变项目颜色等。它会闪烁很多，看起来很讨厌:)

也许你可以建议如何避免这种情况？如何加快绘图速度？或者也许我应该考虑开始使用一些不同的组件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T11:11:50.760

在等待您对我的评论作出回应的同时。如果闪烁*是*一个双缓冲问题，那么[这个问题](https://stackoverflow.com/questions/220100/how-do-i-enable-double-buffering-of-a-control-using-c-window-forms)的公认答案会让你上路。将您的列表视图设置为使用答案中的样式，您就可以开始了。这样做会降低性能，因为它将确保颜色更新仅与显示器的刷新率同步发生（通常约为每秒 60 次），但它将停止在显示器刷新之间发生更新时发生的闪烁/撕裂.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T10:34:31.613

考虑让每个线程将其状态推送到某个共享数据结构，然后使用计时器从 UI 线程每秒轮询一次。那样：

*   您不必担心从非 UI 线程调用
*   你不会得到一个“忙碌”的用户界面
*   您仍然可以保持最新（相对于说“如果我最近已经更新，请不要更新）的方法）

在效率方面，我对 UI 计时器了解不多 - 这样的计时器可能会相对昂贵，因此无论如何您*可能*需要进行一些跨线程通信：如果不是，请让每个非 UI 线程启用计时器已启用，并在您进行更新时将其禁用。这样一来，您将永远落后于现实，但仍然每秒只有一次状态更新。

# visual-studio - 向 Team Foundation Server 2010 添加解决方案时显示警告

> ID：934263
> 
> 赞同：62
> 
> 时间：2009-06-01T10:26:37.450
> 
> 标签：visual-studio, version-control, tfs

我刚刚开始使用 TFS 2010（从来没有使用过 TFS 2008）并且我正在尝试将我的第一个解决方案添加到 TFS 中。但是我收到以下警告消息：

> 您尝试添加到源代码管理的项目可能会导致其他源代码管理用户难以打开此解决方案或获取其更新版本。为避免此问题，请从解决方案中其他源代码控制项目的绑定根目录下方的位置添加项目。

有人可以向我解释这意味着什么以及如何解决它吗？在解决方案资源管理器中右键单击解决方案并选择“添加到源代码管理”时会显示此警告。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-06-01T10:40:39.310

您的解决方案文件夹结构应类似于：

```
Solution Root folder
├── .sln solution file       
│
├── Project1 folder
│   └── Project1.csproj   (or .vbproj)
│
├── Project2 folder
│   └── Project2.csproj   (or .vbproj)
.
.
. 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-11-04T20:58:53.340

如此 Visual Studio 论坛帖子（下面的链接）中所述，基本问题是解决方案中的项目位于解决方案本身所在的子树之外。如果另一个用户映射不同的子树，这可能会导致问题在他的工作空间中与正在签入的用户不同。跨树引用将不再起作用。该对话框只是一个警告，但如果您知道您的团队没有使用复杂的工作区映射拆分代码树，则可以继续此对话框。

[https://social.msdn.microsoft.com/Forums/vstudio/en-US/29579a28-9de0-4fc6-a253-b38191aa4fdc/must-projects-be-added-under-binding-root-of-solution?forum= tfs版本控制](https://social.msdn.microsoft.com/Forums/vstudio/en-US/29579a28-9de0-4fc6-a253-b38191aa4fdc/must-projects-be-added-under-binding-root-of-solution?forum=tfsversioncontrol)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-12-01T10:19:01.250

对我来说，就像这样，我已经尝试从另一个位置添加解决方案。然后我不得不清理为其他位置创建的工作区。

对于 Visual Studio 2013，您可以在以下位置找到工作区设置：

```
File -> Source Control -> Advanced -> Workspaces... 
```

1.  在`Manage Workspaces`对话框中选择您使用的工作区
2.  打`Edit...`。
3.  在`Edit Workspace <yourworkspacename>`对话框中
4.  清除**“错误”**的位置

尝试再次添加解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-24T16:38:47.440

以下问题可以象征性地体现您报告的错误。请记住，引用的程序集不必位于 TFS 或工作站文件系统中的任何特定位置。

一个潜在的问题是某些类型的项目默认使用目标 .NET Framework 的“*客户端*”版本。*客户端*版本去除了可部署项目中通常不使用的程序集。此外，您的项目引用的任何程序集也不得引用*客户端*配置文件省略的程序集。

只需将项目的目标框架设置更改为完整的框架版本。

查看我的博客文章，关于这个问题： [http ://thecurlybrace.blogspot.com/2010/09/visual-studio-wears-sabots.html](http://thecurlybrace.blogspot.com/2010/09/visual-studio-wears-sabots.html)

# loops - 循环的性能差异

> ID：934265
> 
> 赞同：0
> 
> 时间：2009-06-01T10:26:43.207
> 
> 标签：loops, c#-2.0

是否会有巨大的性能差异：

```
if (this.chkSelectAll.Checked)
    for (int i = 0; i < this.listBoxColumns.Items.Count; i++)
        this.listBoxColumns.SetSelected(i, true);
else
    for (int i = 0; i < this.listBoxColumns.Items.Count; i++)
        this.listBoxColumns.SetSelected(i, false); 
```

对比

```
for (int i = 0; i < this.listBoxColumns.Items.Count; i++)
    this.listBoxColumns.SetSelected(i, this.chkSelectAll.Checked); 
```

哪一个是可取的。简洁的编码与性能提升？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-01T10:29:57.910

我不希望看到太大的性能差异，我当然会选择后者，因为它更具可读性。（不过我会在它周围放上大括号。）

很容易想象您可能需要更改循环的情况，并且在第一个示例中，您可能不小心只更改了其中一个而不是两个都更改。如果你*真的*想避免`Checked`在每次迭代中调用该属性，你总是可以这样做：

```
bool checked = this.chkSelectAll.Checked;
for (int i = 0; i < this.listBoxColumns.Items.Count; i++)
{
    this.listBoxColumns.SetSelected(i, checked);
} 
```

与以往一样，首先编写最易读的代码，并在为了性能而弯曲您的设计/代码之前测量/分析任何性能差异。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T10:35:34.810

我想性能差异几乎不会引起注意。然而，这里有一个既高效又可读性强的变体：

```
bool isChecked = this.chkSelectAll.Checked;
for (int i = 0; i < this.listBoxColumns.Items.Count; i++) {
    this.listBoxColumns.SetSelected(i, isChecked);
} 
```

如果您正在进行一些真正的优化，您还需要注意在每次迭代中访问“this.listBoxColumns”两次的开销是否首先存在并且值得关注。这就是分析的用途。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T10:29:26.897

在第一个示例中，您有一个额外的布尔检查。但是话虽如此，我无法想象性能差异可以忽略不计。您是否尝试过在您的特定场景中进行测量？

第二个示例更可取，因为您没有重复循环代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T10:31:11.950

我看不出两者之间存在显着的性能差异。确认它的方法是设置一个基准并将不同算法的时间超过 1000 次迭代。

然而，由于它是 UI 代码，因此任何性能提升都毫无意义，因为您将等待用户阅读对话框并决定下一步该做什么。

就个人而言，我每次都会选择第二种方法。您只需维护一个循环，并且代码更清晰。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T10:32:16.220

任何性能差异都可以忽略不计。

您最关心的应该是代码的可读性和可维护性。

诸如此类的微优化往往是错位的。在关注性能之前始终进行分析。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T10:32:54.457

它最有可能可以忽略不计。然而，更重要的是，我觉得有必要引用以下内容：

> [“过早优化是万恶之源”](https://stackoverflow.com/questions/211414/is-premature-optimization-really-the-root-of-all-evil)

第二个更容易阅读，所以简单地使用它，除非你以后发现需要优化（在我看来这不太可能）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T10:30:57.830

为什么不使用 System.Diagnostics.StopWatch 并自己比较两者？但是，我不相信会有任何真正的性能差异。第一个示例可能更快，因为您只访问 chkSelectAll.Checked 一次。两者都很容易阅读。

# java - Java中简单2D动画的框架/库？

> ID：934290
> 
> 赞同：0
> 
> 时间：2009-06-01T10:35:28.290
> 
> 标签：java, graphics, 2d

我想用 Java 编写一个非常简单的游戏来演示我构建的无线控制器。我想到了诸如 Breakout 或 Pong 之类的东西。目前，我有一个原型 Pong 实现，它直接使用 AWT 功能执行所有动画。然而，这对编程来说有点尴尬，而且也是一个主要的 CPU 消耗。

我的问题：

有人可以推荐一个 Java 库来显示简单的 2D 动画吗？你在类似的项目中使用过什么？该库应该易于使用且直接使用——我不是在寻找像 Java3D 这样的东西。集成碰撞检测将是一个专业人士。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T10:41:37.810

[这个问题](https://stackoverflow.com/questions/293079/java-2d-game-frameworks)与 Java 2D 框架的比较有关，可能有用。

我对为什么您的原始实现会占用 CPU 很感兴趣。是在绘制的*时候*，还是一直在消耗 CPU 资源？如果是后者，它可能指向一个问题。你如何查询/轮询你的控制器。

# .net - 如何确定哪个程序正在使用 VB 2005 中的文件？

> ID：934297
> 
> 赞同：2
> 
> 时间：2009-06-01T10:39:39.653
> 
> 标签：.net, vb.net, file, process

有没有办法在 vb 2005 中获取锁定文件的程序？

例如，当我尝试打开一个已经被另一个程序打开的文件时，我可以获得锁定该文件的进程/程序的名称吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T11:31:47.490

System Internals 有一个您可以使用的名为[Handle的工具。](http://technet.microsoft.com/en-us/sysinternals/bb896655.aspx)它告诉您哪个程序打开了哪个文件和/或目录。它是一个控制台应用程序。您可以将其输出通过管道传输到文本文件，然后只需打开该文本文件并搜索您要查找的文件。然后你可以看到哪个进程打开了它。

```
c:\handle > output.txt 
```

# android - Android 设备中的 SU 命令问题

> ID：934301
> 
> 赞同：1
> 
> 时间：2009-06-01T10:41:07.997
> 
> 标签：android, shell, root

我想更改设备上的文件夹权限，但是当我输入 su 时，我得到权限被拒绝，还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T21:53:36.267

由于目前可用的 Android 设备并不多，我猜你说的是 HTC Dream（又名 G1）。看起来您在该设备上没有 root 访问权限，这是正常的，除非它是开发人员手机 (ADP1)。

可以在您[的](http://www.google.com/search?q=root+g1)T-Mobile G1 上获得 root 访问权限，但需要付出一些努力。

# iphone - MPMoviePlayerController 成功预加载后将视频缓存到磁盘

> ID：934303
> 
> 赞同：17
> 
> 时间：2009-06-01T10:42:12.723
> 
> 标签：iphone, cocoa-touch, video

使用 MPMoviePlayerController 启动视频后`initWithContentURL:`，是否可以缓存下载的视频，以便下次播放视频时可以通过本地 file:// URI 加载？我知道可以自己下载*然后*启动电影播放器​​，但是我想利用播放器在完成预加载之前启动的能力。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T22:13:42.667

一个技巧是开始下载到磁盘 - （使用 atomic : YES），等待 10 秒，然后将电影播放器​​指向本地磁盘路径。它会在播放不完整的文件时“下载”。

下次，只需检查文件是否存在。

我在 WIFI 连接上做得很好，但在 3G 上却有各种崩溃。

更糟糕的是，本地文件不完整存在问题。让我知道是否值得。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T01:13:17.953

我没有对此进行测试，但可以`[NSURLCache sharedURLCache]`使用自定义的仅磁盘缓存实现来覆盖。如果`MPMoviePlayerController`使用`NSURLRequest`，它可以工作。

# javascript - JavaScript - 确认框。| 是的？> 从 MySQL 中删除数据 / 不 - 什么都不做

> ID：934313
> 
> 赞同：2
> 
> 时间：2009-06-01T10:45:03.903
> 
> 标签：javascript, mysql

我对 JavaScript 没有太多经验。但是我想用 JavaScript 和 MySQL 做点小事。我可以使用一些帮助。

我在 PHP 中有一个页面，可以搜索某些内容，它会根据搜索查询给出结果。对于每个结果，它会添加 3 张图像，其中一张作为您可以查看内容的 URL。其他可以编辑该内容的地方。

第三个可以删除。为此，我想做点好事。

就像，用户单击图像，会出现一个确认对话框。在该框中，它会询问您是否确定要删除数据。如果是，它将删除数据。其中 ID =

ID 打印在 onclick 操作中，在图像中使用 PHP 的 JavaScript 函数内`echo`。

如果没有，我们将关闭对话框并继续。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-01T11:08:45.553

好的，让我们假设以下内容（请原谅我重新澄清问题）：

你有一些表格的行，带有删除链接，你想确认用户确实想要删除它？

让我们假设以下 HTML：

```
<tr>
   <td>Some Item 1</td>
   <td><a href="?mode=delete&id=1" class="delete-link">Delete</a></td>
</tr>
<tr>
   <td>Some Item 2</td>
   <td><a href="?mode=delete&id=2" class="delete-link">Delete</a></td>
</tr>
<tr>
   <td>Some Item 3</td>
   <td><a href="?mode=delete&id=3" class="delete-link">Delete</a></td>
</tr> 
```

所以我假设相同的 PHP 脚本可以运行删除，选择 mode 参数：

```
<?php
    if($_GET['mode'] == 'delete') {
       //Check if there is something in $_GET['id'].
       if($_GET['id']) {

          //Prevent SQL injection, just to be safe.
          $query = "DELETE FROM sometable WHERE id='" . mysql_real_escape_string($_GET['id']) . "'";

          mysql_query($query);
       }
    } 
```

我将在 JavaScript 方面给出两个解决方案——第一个是内联的、略显丑陋的解决方案，第二个是使用 jQuery ( [http://jquery.com/](http://jquery.com/) ) 和不显眼的 JavaScript。

好的，首先，我将绑定每个链接的 onclick 事件。

```
<tr>
   <td>Some Item 3</td>
   <td><a href="?mode=delete&id=3" class="delete-link" onclick="checkDeleteItem();">Delete</a></td>
</tr> 
```

然后创建一个 JavaScript 函数：

```
//This will get called when the link is clicked.
function checkDeleteItem() {
   //show the confirmation box
   return confirm('Are you sure you want to delete this?');
} 
```

正如我所说，我不喜欢这种解决方案，因为它非常突兀，而且也不是特别健壮。

现在，jQuery 解决方案：

```
//Do all this when the DOM is loaded
$(function() {
   //get all delete links (Note the class I gave them in the HTML)
   $("a.delete-link").click(function() {
       //Basically, if confirm is true (OK button is pressed), then
       //the click event is permitted to continue, and the link will
       //be followed - however, if the cancel is pressed, the click event will be stopped here.
       return confirm("Are you sure you want to delete this?");
   });
}); 
```

我衷心推荐这个解决方案而不是前一个解决方案，因为它更加优雅和漂亮，并且通常是最佳实践。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T10:58:13.423

无法帮助您处理 php 部分，但您可以使用 JavaScript `Confirm`：

```
var ok = confirm('Are you sure you want to delete this row');
//ok is true or false 
```

您可以将函数绑定到删除按钮上的单击事件。返回`false`将导致他们忽略点击。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T10:57:27.310

您需要的是一个基本的 HTML 表单，它将提交和删除。首先获取正确的 HTML - 我建议每个图像都有自己的表单，其中包含 ID 值的隐藏字段，并且图像使用图像按钮：`<input type="image" />`

完成此工作后，您可以添加 JavaScript 警告对话框。您将需要用您自己的函数替换表单的提交事件，以防止表单提交（通过返回 false），然后显示您的对话。如果用户单击“是”，那么您需要`onsubmit()`使用 JavaScript 触发表单事件，如果用户单击“否”，则只需隐藏对话框。

另外，请阅读 Jeremy Keith 撰写的关于不显眼的 JavaScript - [DOM Scripting 的](https://rads.stackoverflow.com/amzn/click/com/1590595335)书籍，这本书将简单地解释如何做这些事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T10:58:42.330

如果您有一个删除所需行的按钮，则调用下面的函数以确认用户是否要删除：

```
function confirmDelete()
{
  if (confirm('Do you want to delete ?'))
  {
      return true;
  }
  else
  {
      return false;
  }
} 
```

这样称呼它：

```
<input type="button" value="Delete Record" onclick="confirmDelete()" /> 
```

# .net - .NET 进程可以分配的最大内存

> ID：934314
> 
> 赞同：27
> 
> 时间：2009-06-01T10:45:51.263
> 
> 标签：.net, memory-management

垃圾收集器可以为 .NET 进程分配的最大内存是多少？当我编译到 x64 时，Process.GetCurrentProcess.MaxWorkingSet 返回大约 1.4GB，但是当我编译到 AnyCPU (x64) 时，返回相同的数字。对于 x64，它应该更像任务管理器中显示的“限制”值。我怎样才能得到正确的数字，当在所有情况下超过时会导致 OutOfMemory-Exceptions？

该方法应返回的一些示例：

1）机器配置：x64-Windows，4GB物理内存，4GB页面文件
-作为64位进程：8GB
-作为32位进程：1.4GB

2）机器配置：x64-Windows，1GB物理内存，2GB页面文件
-作为64位进程：3GB
-作为32位进程：1.4GB

3) 机器配置：x32-Windows，4GB 物理内存，4GB 页面文件
-作为 64 位进程：不会发生
-作为 32 位进程：1.4GB

4）机器配置：x32-Windows，512MB物理内存，512MB页面文件
-作为64位进程：不会发生
-作为32位进程：1.0GB

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-01T13:16:12.070

Windows 可以配置为按需分配更多的页面文件空间，或者[根据请求](http://windowshelp.microsoft.com/Windows/en-GB/help/89ca317f-649d-40a6-8934-e5707ee5c4b81033.mspx)分配更多的页面文件空间。
[作业对象](http://msdn.microsoft.com/en-us/library/system.activities.design.base.propertyediting.editorreuseattribute(VS.100).aspx)可以防止消耗超过一定数量的内存。
堆的碎片和它的代际性质（加上需要将大的东西放在大对象堆中）

所有这些都意味着硬限制在现实中没有多大用处，并且意味着回答“理论上我可以分配多少内存”这个问题比您想象的要复杂得多。

由于它很复杂，任何*提出*该问题的人都可能试图*做错*事，应该将他们的问题重定向到更有用的东西。

你想做什么似乎需要这样一个问题？

> “我只想知道进程的当前内存负载何时会出现问题，这样我就可以采取行动，例如释放自定义缓存的某些项目。”

正确的。这是一个更容易处理的问题。

按复杂程度排列的两种解决方案：

1.  让你的缓存使用[Wea​​kReferences](http://msdn.microsoft.com/en-us/library/system.weakreference.aspx)
    *   这意味着系统几乎可以神奇地为您释放东西，但您几乎无法控制诸如更换政策之类的事情
    *   这依赖于缓存的数据比键和弱引用的开销大得多
2.  注册[垃圾收集通知](http://msdn.microsoft.com/en-us/library/cc713687.aspx)
    *   这使您可以控制释放事物。
    *   您依赖于系统具有适合 GC 代的最大大小，这可能需要一段时间才能达到稳定状态。

需要注意的地方。*维护这个庞大的缓存（通过它的声音进入磁盘）真的*比重新计算/重新请求数据更便宜吗？
如果您的缓存在通常/连续请求的项目之间表现出较差的局部性，那么将花费大量精力将数据分页进出。具有有效调整的 relpacement 策略的较小缓存很有可能表现得更好（并且对其他正在运行的程序的影响要小得多）

顺便说一句：在 .Net 中，由于用于内存管理的核心 CLR 结构的限制，任何可变大小的对象（字符串、数组）的大小都不能超过 2GB。（上述任一解决方案都将受益于此）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T11:23:08.863

这不取决于你有多少内存吗？

从理论上讲，我认为 x64 进程可以分配 EB（千兆字节？）的 RAM - 即很多。但是如果你这样做了，你的机器应该开始疯狂地分页并且通常会死机。

它在 32 位模式下有所不同，因为您不能在 Windows 的任何进程中分配超过 1GB 的 RAM（是的，有一些方法可以解决它，但它并不漂亮）。实际上，这意味着每个 .NET 进程大约需要 7-800meg，因为 .NET 保留了一些空间。

无论哪种方式，在 32 位中，您最多可以使用 3GB - 操作系统为自己保留 1GB 的虚拟空间。

在 64 位中，它应该是 2^64，这是一个很大的数字，但是[http://en.wikipedia.org/wiki/X86-64](http://en.wikipedia.org/wiki/X86-64)说它是 256TB 的虚拟空间和 1TB 的 REAL RAM。无论哪种方式，它都比您机器中可能拥有的要多得多，因此它会命中页面文件。

> 借助 64 位操作系统和 64 位运行时，基于 .NET 2.0 的应用程序现在可以将 500 倍以上的内存用于数据，例如基于服务器的缓存。

这也有一些很好的信息[http://www.theserverside.net/tt/articles/showarticle.tss?id=NET2BMNov64Bit](http://www.theserverside.net/tt/articles/showarticle.tss?id=NET2BMNov64Bit)

顺便说一句，如果您在 x64 机器上（即 x64 机器 + x64 操作系统），为 AnyCPU 和 x64 编译会做同样的事情 - 它在 x64 模式下运行。唯一的区别是如果您使用 AnyCPU vrs x86：

*   x64 OS/.NET，AnyCpu：x64 应用程序
*   x64 操作系统/.NET，x64：x64 应用程序
*   x64 OS/.NET、x32：x32 应用程序（x64 .NET 框架同时安装了 x32 和 x64 版本的 Fx）

*   x32 OS/NET，AnyCPU：x32 应用程序

*   x32 OS/.NET、x64：崩溃并烧毁婴儿！（实际上，它只是优雅地死去）
*   x32 OS/.NET，x32：x32 应用程序。

# c# - 有没有办法将 TransactionScope 与现有连接一起使用？

> ID：934316
> 
> 赞同：17
> 
> 时间：2009-06-01T10:46:19.593
> 
> 标签：c#, transactions, transactionscope

我有一些代码类似于建议使用 TransactionScope，但有环境连接而不是环境事务。

有没有办法将 TransactionScope 对象与现有连接一起使用，或者.Net 框架中是否有用于此目的的替代方法？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2010-07-01T16:11:58.683

事实上，有一种方法。

```
connection.EnlistTransaction(Transaction.Current) 
```

它有效，并且如果没有必要，它不会将事务推广到分布式（与文档所说的相反）

高温高压

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-01T10:55:20.480

要将连接登记到 TransactionScope，您需要`'Enlist=true'`在其连接字符串中指定并在该 TransactionScope 对象的范围内打开连接。

您可以 `SqlConnection.BeginTransaction`在现有连接上使用。

**更新**：你可以`BeginTransaction`这样使用：

```
using (SqlConnection connection = new SqlConnection(connectionString))
{
    connection.Open();

    SqlCommand command = connection.CreateCommand();
    SqlTransaction transaction;

    // Start a local transaction.
    transaction = connection.BeginTransaction("SampleTransaction");

    // Must assign both transaction object and connection
    // to Command object for a pending local transaction
    command.Connection = connection;
    command.Transaction = transaction;

    ...
    ...

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-10T08:57:15.040

经过更多研究，我的问题的答案原来是：

不，需要在实例化 TransactionScope 对象后打开连接。

# java - 在 Hibernate Search 中索引数据

> ID：934322
> 
> 赞同：4
> 
> 时间：2009-06-01T10:48:43.037
> 
> 标签：java, hibernate-search

我刚刚开始将 Hibernate Search 与我的 Hibernate 应用程序集成。每次我启动服务器时，都会使用 Hibernate Session 对数据进行索引。

```
FullTextSession fullTextSession = Search.getFullTextSession(session);
Transaction tx = fullTextSession.beginTransaction();

List books = session.createQuery("from Book as book").list();
for (Book book : books) {
    fullTextSession.index(book);
}

tx.commit(); //index is written at commit time 
```

这很尴尬，服务器需要 10 分钟才能启动。我是否以正确的方式做这件事？

我写了一个调度器，它会定期更新索引。这会自动更新现有的索引条目，还是创建重复的索引？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-09-17T11:16:50.823

如 Hibernate Search 指南第 3.6.1 节所述，如果您使用注解（现在是默认设置），则默认注册在存储上启动索引的侦听器：

> 使用 Hibernate Annotations 或 Hibernate EntityManager 时，Hibernate Search 开箱即用。如果由于某种原因需要禁用它，请将 hibernate.search.autoregister_listeners 设置为 false。

有关如何手动打开它们的示例：

```
 hibConfiguration.setListener("post-update", new FullTextIndexEventListener());
 hibConfiguration.setListener("post-insert", new FullTextIndexEventListener());
 hibConfiguration.setListener("post-delete", new FullTextIndexEventListener()); 
```

您需要做的就是用

```
@Indexed(index = "fulltext") 
```

注释，然后对字段进行细粒度注释，如用户指南中所述。

因此，您不应在存储时手动启动索引，也不应在应用程序启动时重新启动索引，除非您有在启用索引之前已存储的实体。

当您存储一个说有“附件”的对象时，您可能会遇到性能问题，因此您在存储实体的事务的同一范围内对其进行索引。看这里：

[Hibernate Search 和离线文本提取](https://www.hibernate.org/432.html)

解决此问题的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T08:02:04.123

如果您使用的是 FSDirectoryProvider（这是默认设置），Lucene 索引将持久保存在磁盘上。这意味着不需要在启动时进行索引。如果您有现有的数据库，您当然希望使用 fullTextSession.index() 功能创建一个初始索引。但是，这不应该在应用程序启动时发生。考虑公开某种触发 url 或管理界面。一旦你有了初始索引，我建议使用自动索引。这意味着如果书籍被创建/更新/删除，Lucene 索引会自动更新。默认情况下也应启用自动索引。

我建议您参考在线手册中的自动和手动索引部分 - [http://docs.jboss.org/hibernate/stable/search/reference/en/html_single](http://docs.jboss.org/hibernate/stable/search/reference/en/html_single)

——哈代

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-10T03:19:10.633

我目前使用 Hibernate Search 的 JPA 自动索引，它工作得非常好。要最初创建索引，您只需调用以下命令：

```
 FullTextEntityManager fullTextEntityManager = 
                    Search.getFullTextEntityManager(entityManager);

    try {
       fullTextEntityManager.createIndexer().startAndWait();
    } catch (InterruptedException e) {
       // Exception handling
    } 
```

其中“entityManager”只是一个 javax.persistence.EntityManager。以上将为标记为@Indexed 的所有实体索引所有标记为@Field 的字段。

然后，只要您通过实体管理器进行所有更新等，索引就会自动更新。然后，您可以像往常一样进行搜索，但请确保在每次搜索时重新创建 EntityManager（您可以使用 EntityManagerFactory 来执行此操作）。

# jquery - 使用 jQuery 控制 iframe 高度

> ID：934323
> 
> 赞同：20
> 
> 时间：2009-06-01T10:49:23.910
> 
> 标签：jquery, html, iframe

我正在使用 jQuery 来控制 iframe 的高度。

```
jQuery("iframe",top.document).contents().height(); 
```

这在 iframe 的高度增加时有效。当高度降低时，它不起作用。它只返回旧值。为什么会这样？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-03-08T12:33:33.040

我使用以下，它完美地工作......

```
$("#frameId").height($("#frameId").contents().find("html").height()); 
```

当然就在它被调用时（没有“自动调整大小”）......但它的工作原理随着减少而增加

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-01T11:11:55.003

它适用于我如果我设置它并在不使用的情况下检索它`.contents()`。请看我下面的例子。

```
function changeFrameHeight(newHeight){
  jQuery("iframe",top.document).height(newHeight);
  alert("iframe height=" + jQuery("iframe",top.document).height());
} 
```

**编辑：**如果我理解正确，您正试图通过调用增量来摆脱滚动条，并通过调用减量返回到原始高度。

在跨不同浏览器进行多次测试后。这是适用于 FF、IE、Chrome、Safari 和 Opera 的代码。

```
//first declare a variable to store the original IFrame height.
var originalHeight = $("iframe",top.document).height(); 
```

更改您的**heightIncrement**函数以使用以下内容：

```
heightIncrement:function(){
 var heightDiv = jQuery("iframe",top.document).contents().find('body').attr('scrollHeight'); 
 jQuery("iframe",top.document).css({height:heightDiv});
} 
```

更改您的**heightDecrement**函数以使用以下内容：

```
heightDecrement:function(){
 jQuery("iframe",top.document).css({height:originalHeight});
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-06-19T00:46:59.330

这是古老的，但希望它有所帮助。

似乎 Chrome（或者可能是所有 webkit，不确定）有一个错误，即 scrollHeight 可以增加但不能减少（至少在 iframe 中的内容的情况下）。因此，如果内容先增长然后缩小，则 scrollOffset 将保持在较高级别。当您试图使 iframe 的高度足够大以容纳不断变化的内容时，这并不是很好。

一个 hack 解决方法是通过将高度设置为绝对小到足以导致 iframe 的高度小于其内容的高度来重新计算高度，然后重置 scrollHeight。

```
var frame = top.document.getElementById('iFrameParentContainer').getElementsByTagName('iframe')[0];
var body = frame.contentWindow.document.body;
var height = body.scrollHeight; // possibly incorrect
body.height = "1px";
height = body.scrollHeight; // correct 
```

这可能会导致轻微的闪烁，但通常不会，至少它在我的机器（tm）上工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-03T15:54:05.183

这是一个对我有用的简单 jQuery。在 iExplorer、Firefox 和 Crome 中测试：

```
 $('#my_frame').load(function () {  
      $(this).height($(this).contents().find("html").height()+20);
}); 
```

我添加 20 像素只是为了避免任何滚动条，但您可以尝试下限。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T11:23:23.340

在加载时我调用这个函数

```
heightIncrement:function(){     
           if($.browser.mozilla)
           { 
             var heightDiv   = jQuery("iframe",top.document).contents().attr("height")+"px";                    
             jQuery("iframe",top.document).css({height:heightDiv});
           }
           else if($.browser.opera  || $.browser.safari || $.browser.msie)
           {               
             var heightDiv   = jQuery("iframe",top.document).height();                   
             jQuery("iframe",top.document).css({height:heightDiv}); 
           } 
} 
```

如果我不使用 contents() 它返回零。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-30T02:50:50.447

加载时，我已成功调整 iframe 的高度和宽度。基本上你可以这样做，我也在我的博客上发表了一篇小文章：[http ://www.the-di-lab.com/?p=280](http://www.the-di-lab.com/?p=280)

```
$(".colorbox").colorbox(

{iframe：真，

内部宽度：0，

内部高度：0，

滚动：假，

完成：函数（）{

$.colorbox.resize(

{

innerHeight:($('iframe').offset().top + $('iframe').height()),

innerWidth:($('iframe').offset().left + $('iframe').width())

}

);

}

}

);

```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-14T15:42:28.933

我用这个：

> $('#iframe').live('mousemove', function (event) {
> 
> var theFrame = $(this, parent.document.body);
> 
> this.height($(document.body).height() - 350);
> });

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-03T18:58:57.633

我不确定人们是否对他们的方法感到满意，但我已经编写了一个非常非常简单的方法，在最新的 Safari、Chrome、IE9、Opera 和 Firefox 中似乎对我来说效果很好。

我在调整谷歌日历馈送 iFrame 的大小时遇到​​问题，所以我刚刚以 iFrame 的样式为其设置了默认大小：宽度 =“600”，高度设置基本上是我想要的最大值，我相信是 980，然后将其包裹在一个容器 Div，高度和宽度为 100%，最小高度和最小宽度分别为 400 像素和 300 像素，然后添加了一些 jQuery 以在 onload 和 onresize 时运行...

```
 <script>

        var resizeHandle = function(){
            var caseHeight = $('#calendarCase').height();
            var caseWidth = $('#calendarCase').width();
            var iframeWidth = $('#googleCalendar').width(caseWidth - 10);
            var iframeHeight = $('#googleCalendar').height(caseWidth - 10);;
        };

</script>

<body id ="home" onLoad="resizeHandle()" onResize="resizeHandle()"> 
```

澄清一下，resize 函数在 onLoad 上运行，因为我在响应式设计中针对手机和平板电脑，它采用 calendarCase div 的高度和宽度，并相应地设置 iframe (#googleCalendar) 的高度和宽度，减去 10 个像素一些填充。

*编辑*我忘了提到我已经使用 caseWidth 来设置 iFrame 的高度，以保持比例受到限制并保持正方形。

到目前为止效果很好，如果有人知道为什么它可能不稳定，请告知，

干杯

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-12-06T03:31:21.610

如果 iframe 源与其父域是不同的域，那么您可能需要使用[easyXDM](http://easyxdm.net/wp/)。

# c# - Linq to SQL 用分隔符附加多条记录

> ID：934327
> 
> 赞同：4
> 
> 时间：2009-06-01T10:50:58.617
> 
> 标签：c#, .net, linq-to-sql

对不起，如果它是重复的问题的错误标题道歉。

我有两个数据库表：

```
Users                 Documents
-------               --------- 
ID                    ID
Name                  DocumentName
                      UserID 
```

假设我有 1 条记录`Users`

```
1, "bob" 
```

和三个相关的记录`Documents`

```
1, "Doc1", 1
2, "Doc2", 1
3, "Doc3", 1 
```

我想生成一个结果集：

```
1, "bob", "Doc1, Doc2, Doc3" 
```

我尝试了涉及合并多个结果集的各种事情，但得到了错误：`Local sequence cannot be used in LINQ to SQL implementation of query operators except the Contains() operator.`

我该怎么做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T11:02:16.613

任何一个：

*   从服务器中“按原样”获取列并在 C# 中执行 concat
*   编写一个执行此操作的 SP，并通过 LINQ 调用该 SP

SP（接受@UserID）可以这样做：

```
DECLARE @txt varchar(max)
SET @txt = ''
SELECT @txt = @txt + [DocumentName] + ', '
FROM [Documents]
WHERE [UserID] = @UserID

SELECT [ID], [Name], @txt AS [Docs]
FROM [Users]
WHERE [ID] = @UserID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-11T17:41:24.810

如果您使用的是原始 sql，那么您可以使用 STUFF 和 FOR XML PATH 语法，如： [How Stuff and 'For Xml Path' work in Sql Server](https://stackoverflow.com/questions/31211506/how-stuff-and-for-xml-path-work-in-sql-server) other solution，您需要首先通过 linq 从 sql 获取数据，然后生成结果 .AsEnumerable () - 现在你可以使用 string.Join 函数

# batch-file - XCOPY 排除列表在第一次排除后被忽略

> ID：934329
> 
> 赞同：1
> 
> 时间：2009-06-01T10:51:40.893
> 
> 标签：batch-file, xcopy

我创建了一个批处理文件，它使用 xcopy 复制一个目录和子目录，并将它们合并到一个文件中。（即，我所有的模块化开发 CSS 样式表合并到一个生产样式表中）。

一切都很好，除了当我引用 excludelist.txt 时，它只排除第一行，而不是我想要排除的后续文件。

有人想破解这个吗？你会是最有帮助的。

这是代码：

```
XCOPY C:\xampp\htdocs\PROJECT\css\*.* C:\temp /S /I /Y /EXCLUDE:C:\xampp\htdocs\PROJECT\exclude.txt 
```

...在我的 exclude.txt 里面是...

1.css
2.css
3.css
4.css
5.css

///// 我知道代码有效（在一定程度上），因为它实际上不包括文件 1.css —— 只是它下面的那些。我是否可以将每个排除项放在一个新行上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-03-04T05:22:21.440

我使用以下，

```
xcopy "C:\users\dad\*.*" dad /s /d <yesnoyesno /EXCLUDE:excluexclu 1>cop.txt 2>err.txt 
```

在网络上的某个地方，我看到一个注释，大意是该`/Y`开关不能直接与排除文件一起使用。

我想在这里指出的是有用的输出文件 1 和 2，它们详细说明了成功和失败的问题。

我的只显示成功。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T11:11:33.210

我有一个类似的问题。我试图排除根文件夹和任何子文件夹中具有特定扩展名的所有文件，但它不起作用。原因是我放的是 *.pdb 而不是 .pdb。换行/回车的事情对我来说是一个完全的红鲱鱼。

所以我的文件看起来像：

.pdb .obj .vb .cs

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-23T22:44:28.477

简短的回答：创建一个新的文本文件，输入条目并保存文件。

更长的解释：我今天在 Windows 2008 服务器上遇到了这个问题。我尝试了各种各样的方法来让它工作。强制记事本将文件保存为 ANSI、Unicode 和 UTF-8，但它们都有同样的问题。最后我开始考虑我通过 FTP 将文件放在服务器上的事实，并且很可能 FTP 调整了文件格式。我在服务器上创建了一个新的文本文件，在新文件中输入了所有相同的条目，现在它可以工作了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T11:21:54.217

您似乎正确地使用了 xcopy - 每个排除文件（或根据通配符匹配）应该在文件中的新行上。到目前为止，我一直无法重现您遇到的行为。

您在测试文件上方给出的 exclude.txt 列表是实际的 css 名称吗？
您的批处理文件应该复制的其他文件的名称是什么？

**编辑：**
xcopy 在单场比赛后未能排除更多文件，这让我最停顿。我认为这可能与排除文件中使用的回车类型有关，但 xcopy 可以很好地处理 unix 样式的回车。

您能否重新验证是否使用了正确的排除文件？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-05T16:14:12.400

尝试在您的文本编辑器上强制它使用 ANSI 编码保存。我遇到了类似的问题，并且做到了。

# sql-server - SQL 2008 CAL - 它们是如何实施的？

> ID：934333
> 
> 赞同：3
> 
> 时间：2009-06-01T10:54:22.027
> 
> 标签：sql-server

我正在运行一个需要非常有限数量的用户连接（一次最多 5 个）的服务器。所以 SQL 2008 Workgroup 的 5-CAL 版本对我来说似乎是完美的。现在，我需要知道以下内容：我是否真的需要在将使用服务器的每台机器/用户上物理安装 CAL（我的意思是读取和写入）还是 5-CAL 许可证只是意味着任何时候只有 5 台机器/用户可以登录？

即，只要其中只有 5 个同时连接，6 或 7 个不同的人可以使用它吗？

谢谢卡尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T11:07:05.417

一切尽在此处：[SQL Server 2008 许可常见问题](http://www.microsoft.com/sqlserver/2008/en/us/licensing-faq.aspx)

然而，这并不是最容易遵循的。

基本上，CAL 是针对每个用户或设备的。区别在于“设备客户端访问许可证 (CAL) 和用户 CAL 之间的区别是什么？” 是上面的链接”。

无论您使用哪种 CAL 类型，一次只能连接 5 个都没有关系。或者一个客户端打开了 200 个连接。

它针对每个用户或每台 PC（用户 CAL 或设备 CAL），而不是每个连接。在过去（SQL 7？）你确实有每个连接，但我已经有一段时间没有看到这个了。

编辑，实际回答：它们没有严格执行，因为 SQL Server 实例对事物进行计数，但您将非法使用该软件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T11:09:49.500

这取决于您采用的许可模式：

1.  按 CPU 许可 - 无需 CAL，但您为无限制的用户和设备访问预先付费。您受限于 SQL Server 框中可以拥有的物理 CPU（不是内核）的数量。

2.  每设备 CAL - 您可以将 CAL 分配给物理设备，并且从该设备访问 SQL Server 的任何人都获得许可。因此，10 个人从 1 台共享计算机访问 SQL Server 需要您拥有 1 个设备 CAL。

3.  每用户 CAL - 您可以将 CAL 分配给一个人，并且任何访问 SQL Server 的人都需要拥有许可证。因此，10 个人从 1 台共享计算机访问 SQL Server 需要您拥有 10 个用户 CAL，但 1 个人从 10 台计算机访问 SQL Server 只需要您拥有 1 个 CAL。

CAL 按逻辑处理 - 没有硬性限制，只是不要超过您拥有的许可证数量。

[http://www.microsoft.com/Sqlserver/2005/en/us/pricing-licensing-faq.aspx](http://www.microsoft.com/Sqlserver/2005/en/us/pricing-licensing-faq.aspx)

[http://www.microsoft.com/sqlserver/2008/en/us/licensing-faq.aspx](http://www.microsoft.com/sqlserver/2008/en/us/licensing-faq.aspx)

# html - 301直接在HTML文件中重定向

> ID：934336
> 
> 赞同：3
> 
> 时间：2009-06-01T10:55:42.803
> 
> 标签：html, iis-7, redirect, http-status-code-301

我在我的网站上更改了一些文件名，现在我想将“301 永久移动”从旧文件重定向到新文件。

问题是我的网站完全由静态 html 页面组成，所有 301 重定向教程都描述了如何在 PHP、ASP、htaccess 等中进行操作。我想将重定向直接写入旧的 html 文件，这可能吗？还是我必须联系我的网络提供商并解决服务器上的重定向问题？

我对服务器的唯一了解是它在 Windows 上运行，而我对服务器一无所知。

编辑：我的虚拟主机使用的是 Microsoft IIS 7.0，所以我认为这里无法使用 .htaccess？

编辑#2：刚才我的服务器管理员写信给我，即使我只使用静态 HTML 页面，我仍然可以使用 web.config 文件来重定向单个 html 文件。这是非常好的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T10:59:01.440

您不能使用 HTML 更改 HTTP 状态代码。

但如果您使用的是 Apache 网络服务器，则可以使用[mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)或[mod_alias](http://httpd.apache.org/docs/2.2/mod/mod_alias.html)将此类请求重定向到新地址：

```
# mod_rewrite
RewriteEngine on
RewriteRule ^old\.html$ /new.html [L,R=301]

# mod_alias
RedirectMatch 301 ^/old\.html$ /new.html 
```

* * *

**编辑**   正如您现在澄清您使用的是 IIS 7 一样，请查看其[`<httpRedirect>`用于 HTTP redirects 的元素](http://www.iis.net/ConfigReference/system.webServer/httpRedirect)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T11:01:02.480

不，这是不可能的。服务器不处理 HTML，因此无法设置 HTTP 标头。

您应该改为查看 Apache 配置（例如，使用 .htaccess）。

简单地说，您可以这样做：

```
 Redirect 301 old.html http://example.com/new/
  Redirect 301 other-old.html http://example.com/newer/ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T11:09:44.057

我想您可以使用 JavaScript 和/或元刷新（如 Gumbo 建议的那样）将用户从旧页面重定向到新页面。就像是：

```
<html>
<head>
  <meta http-equiv="refresh" content="0;url=http://YourServer/NewFile.html" />

  <script type="text/javascript">
    location.replace('http://YourServer/NewFile.html');
  </script> 
</head>
<body>
  This page has moved. <a href="http://YourServer/NewFile.html">Click here for the new location</a>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-01-26T02:54:18.620

在 IIS 中重定向单个页面是一件简单的事情，并在您的 web.config 文件中完成。

```
 <location path="products.htm">
    <system.webServer>
      <httpRedirect enabled="true" destination="http://yourserver/products" httpResponseStatus="Permanent" />
    </system.webServer>
  </location> 
```

# ajax - facebook-ish 就像 ajax 中的 iframe

> ID：934339
> 
> 赞同：1
> 
> 时间：2009-06-01T10:58:26.073
> 
> 标签：ajax, facebook, iframe, frameworks

任何人都可以在这里扩展我如何在页面中创建框架，例如 facebook 在 AJAX 中（例如，当您单击用户的个人资料并且您与他不是朋友时），甚至更好 - 有没有人知道一个框架可以做AJAX脏活，我用PHP写？

就像是

```
$frame = new iframeObject;
$frame->setType('a'); 
```

等等？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T11:02:59.560

假设您指的是模态对话框然后检查一下... [http://www.84bytes.com/2008/06/02/jquery-modal-dialog-boxes/](http://www.84bytes.com/2008/06/02/jquery-modal-dialog-boxes/)

# c# - 如何在列表框中找到所选项目的特定位置，使按钮在 C# 中启用？

> ID：934340
> 
> 赞同：0
> 
> 时间：2009-06-01T10:58:38.057
> 
> 标签：c#, button, listbox

我有一个包含**ABCDE**等项目的列表框。
我还有两个按钮**Move UP**和**Move Down**。
我已经在属性窗口 (F4) 中将它们的属性设为 false。

当用户选择 B 或下面的所有项目时，我的 Move Up 按钮应该启用。应该为 A 项禁用它

同样，当用户选择 D 或其上方的所有项目时，应该启用我的 Move Down 按钮。应该为 E 禁用它。

您能否提供我要在此处编写的代码的正确部分。

谢谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T11:01:40.920

处理 ListBox 的 SelectedIndexChanged 事件。如果 SelectedIndex 大于 0，则启用“上移”。如果它小于 count - 1，则启用“下移”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T11:04:01.943

这是我使用的代码`listBox_SelectedIndexChanged`：

```
this.moveUp.Enabled = this.listBox.SelectedIndex > 0;
this.moveDown.Enabled = this.listBox.SelectedIndex > -1 && listBox.SelectedIndex < listBox.Items.Count - 1; 
```

实际上它是在一个从那里调用的方法中，因为在对话框初始化时也调用了代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T11:05:39.337

我在我的应用程序中做类似的事情。它还处理多个项目的选择，并检查选择的多个项目是否连续。

这是代码：

```
private bool SelectionIsContiguous(ListBox lb)
{
    for (int i = 0; i < lb.SelectedIndices.Count - 1; i++)
        if (lb.SelectedIndices[i] < lb.SelectedIndices[i + 1] - 1)
            return false;

    return true;
}

private void SetMoveButtonStates()
{
    if (this.listBox.SelectedIndices.Count > 0)
    {
        if (this.listBox.SelectedIndices.Count > 1 && !SelectionIsContiguous(this.listBox))
        {
            this.btnMoveUp.Enabled = false;
            this.btnMoveDown.Enabled = false;
            return;
        }

        int firstSelectedIndex = this.listBox.SelectedIndices[0];
        this.btnMoveUp.Enabled = firstSelectedIndex == 0 ? false : true;

        int lastIndex = this.listBox.Items.Count - 1;
        int lastSelectedIndex = this.listBox.SelectedIndices[this.listBox.SelectedIndices.Count - 1];
        this.btnMoveDown.Enabled = lastSelectedIndex == lastIndex ? false : true;
    }
} 
```

# language-agnostic - 如何在 NON MVC Web 应用程序中组织视图/控制器？

> ID：934344
> 
> 赞同：0
> 
> 时间：2009-06-01T10:59:03.420
> 
> 标签：language-agnostic

寻找 Web 开发的最佳实践，当您在传统的非框架环境（核心 PHP 或 Perl / CGI）中编写 Web 应用程序时，组织或映射从客户端到服务器进程的调用的最简洁方法是什么？

在单范围页面中工作时，答案相当简单，例如，您需要填写一个表单和一个提交按钮。您可以将表单的操作设置为“save.php”，并在页面与其绑定的函数之间建立一对一的关系。所以 save.php 可以执行保存操作并将表单写入客户端。

现在，我使用的唯一非开箱即用的 php 增强功能是模板引擎（tinybutstrong）。每当我有一个包含多种表单的复杂页面（例如，用于对网格进行排序、保存某些内容、请求其他内容、ajax 组件和搜索框）时，您如何设置各种功能（搜索、排序、插入，检索）到单个显示页面（索引）？

您是否使用 index.php?action=search / index.php?action=insert 之类的东西，或者将每个操作设置为一个页面，该页面就像一个函数（search.php、sort.php、insert.php），每个都委托单个脚本（index.php）的演示功能？如果各种“视图”都可以使用“搜索”功能怎么办？

我以搜索或插入等通用术语为例，对 PHP 的引用也只是示例，因为我认为我的问题在最佳实践方面相当笼统。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T11:25:57.440

通过在存在将您指向视图的动作的地方创建一些东西，您实际上是在为视图创建一个控制器，并且您已经完成了 MVC 的三分之二。（并不是说这有什么问题，这就是你要去的地方）

**Q1。**组织或映射从客户端到服务器进程的调用的最简洁方法是什么？

**A1。**使用文件系统，但在语义上基于您的数据结构（如果可能）做类似的事情`/search/mysearch`是您语义上正确的选择。需要一点 Apache Mojo

**Q1。**你使用 index.php 之类的东西吗？

**A1。**是的，我不会回避这种方法。使用一点 Apache 重写魔法来创建漂亮的路径是理想的，但除此之外，没有任何其他神奇的方式来创建控制器。

# c# - 使用 .ascx 渲染来自 ajax 调用的内容

> ID：934345
> 
> 赞同：0
> 
> 时间：2009-06-01T10:59:21.173
> 
> 标签：c#, jquery, asp.net-mvc, serialization

假设我在一个页面上有一篇可以评论的文章。我有一个通过 ajax 提交的提交表单，并且 OnComplete javascript 方法拦截了表单提交的结果。每条评论都像是：

```
<div class="text">
<p class="details">
User <a href="http://www.mywebsitehere.com/user/3583/" rel="nofollow" class="f">Always_Dreaming</a> at 01/01/2009 - 11:13:52        </p>
<p>Here goes my text   :D</p>
</div> 
```

我从中制作了一个 .ascx 文件，然后我做了 tml.RenderPartial foreach 评论。现在的问题是如何使用这个 .ascx 控件将插入的内容从客户端输出到 OnComplete 方法。

PS。我想使用这种方法，而不是序列化 Comment 对象并返回序列化数据，将它与我的 js 代码一起使用，并使用来自反序列化的 Comment 对象的数据动态生成 html。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T11:16:13.417

您需要做的是使用您的 javascript 调用调用的操作中的 PartialViewResult。客户端代码可以使用 jQuery append 或 html 方法调用之类的方法将其附加到 html。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T12:51:29.777

对于那些感兴趣的人，我在 [这里找到了一个样本:)](http://jarrettatwork.blogspot.com/2009/04/creating-ajax-repeater-in-aspnet-mvc.html)

# azure - 企业图书馆和 MS Azure 文章？

> ID：934347
> 
> 赞同：1
> 
> 时间：2009-06-01T10:59:29.707
> 
> 标签：azure, enterprise-library

只是想知道是否有人有使用 MS Azure 和企业库的经验？我似乎找不到任何关于此的文章并希望（真的希望）有人有一些？

谢谢，

T。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T00:38:48.367

企业库很大……您对哪一部分特别感兴趣？

通常，您不会有任何问题，因为 Azure 现在支持完全信任。但是，有些部分并没有真正意义……例如，您不能使用 Enterprise Logging 记录到“C:\MyLog.txt”，因为您将无法将任何内容记录到“本地云端硬盘”。例如，也许您可​​以将日志记录提供程序写入 Azure 表存储。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T23:04:55.910

请参阅此白皮书“[在 Windows Azure 中使用经典 Enterprise Library 5.0](http://entlib.codeplex.com/downloads/get/336804) ”。

此外，请查看专门[为 Windows Azure 设计的企业库集成包，](http://msdn.microsoft.com/en-us/library/hh680918%28PandP.50%29.aspx)其中引入了 2 个新的应用程序块 - 自动缩放应用程序块（“Wasabi”）和瞬态故障处理应用程序块（“Topaz”。

# jquery - 在 Qtip 中显示 jScrollPane

> ID：934348
> 
> 赞同：0
> 
> 时间：2009-06-01T10:59:39.113
> 
> 标签：jquery, scrollbar, lightbox, tooltip, jscrollpane

我`Jscrollpane`用于我的新项目。这在页面上效果很好。

该页面工作正常，但在 qtip 内部调用时，自定义栏消失。

见自定义滚动条[81.171.199.24/qtip/scrollpanel.html](http://81.171.199.24/qtip/scrollpanel.html)

查看 qtip 示例（点击 snowy Owl 链接）：[81.171.199.24/qtip/index.html](http://81.171.199.24/qtip/index.html)

来自 qtip 的开发人员建议我应该在您的 qTip 页面上包含滚动脚本，并在工具提示`jScrollPanel`的回调中调用该方法，`onRender`否则将无法正常工作，因为它只是从页面中检索 HTML，而不是解析其上的 JS。

所以我试着把代码放在`onRender`函数中，比如

```
onRender: function(){
   $Q('#pop-panel').jScrollPane({scrollbarWidth:15,scrollbarMargin:0});
} 
```

我也尝试使用

```
onRender: function(){
   this.elements.content.jScrollPane({scrollbarWidth:15, scrollbarMargin:0});
} 
```

但我仍然无法获得任何运气。

我认为不起作用的原因是：

1.  我认为这两个脚本有冲突，这意味着我需要在 onRender 函数中使用 jquery noconflict 。
2.  滚动条 div 位于 scrollpanel.html 而不是 index.html 中。如果我使用`this.elements.content.jScrollPane....`，这是否只影响“ `#report_main_content a[rel]`”内的元素。

请给一些建议，非常感谢您的帮助。

谭雅

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-22T22:09:07.300

```
api: {
    onRender: function(){
        alert("here");
    }
} 
```

# sql-server-2005 - 如何将数据库从 sql server 2005 转换为 2000

> ID：934349
> 
> 赞同：1
> 
> 时间：2009-06-01T11:00:31.593
> 
> 标签：sql-server-2005

如何将数据库从 sql server 2005 转换为 2000

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T11:09:10.483

使用 SSIS 将数据库直接导出到 SQL Server 2000。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T18:16:25.213

首先确保您没有使用任何本机 2005 功能，例如索引中包含的列、XML 功能等。然后您可以使用 SSMS 编写架构脚本，并使用 BCP 或 SSIS 将数据导出到 SQL 2000。存在一些供应商工具像 RedGate SQL 比较和数据比较，如果您在表上定义了主键，那么这样做会容易得多。

# api - Castle Windsor Fluent API：将具有单个项目的数组定义为依赖项

> ID：934352
> 
> 赞同：1
> 
> 时间：2009-06-01T11:01:18.377
> 
> 标签：api, castle-windsor, fluent

鉴于此 XML 配置（有效）

```
<component type="X.Y.Z.ActivityService, X.Y.Z.Services" id="X.Y.Z.ActivityService" lifestyle="transient">
  <parameters>
    <Listeners>
      <array>
        <item>${DefaultActivityListener}</item>
      </array>
    </Listeners>
  </parameters>
</component>

<component type="X.Y.Z.DefaultActivityListener, X.Y.Z.Services" id="DefaultActivityListener" lifestyle="transient" /> 
```

我已转换为使用以下流利的 API（不起作用）：

```
Container.Register(
    Component.For<X.Y.Z.ActivityService>()
    .ServiceOverrides(
        ServiceOverride.ForKey("Listeners").Eq(typeof(X.Y.Z.DefaultActivityListener).Name))
    .LifeStyle.Transient
);

Container.Register(
    Component.For<X.Y.Z.DefaultActivityListener>()
    .Named("DefaultActivityListener")
    .LifeStyle.Transient
); 
```

当我现在尝试解决`X.Y.Z.ActivityService`Windsor 的一个实例时，会抛出一个`NotImplementedException`in `Castle.MicroKernel.SubSystems.Conversion.ArrayConverter.PerformConversion(String, Type)`.

PerformConversion 方法的实现是：

```
public override object PerformConversion(String value, Type targetType)
{
    throw new NotImplementedException();
} 
```

我应该补充一点，如果我删除`ServiceOverrides`呼叫，一切都会按预期运行。因此，我连接 Listeners 参数的方式特别有问题。顺便说一下，侦听器是一个属性，而不是构造函数参数。

看到 XML 配置按预期工作，我如何最好地使用流畅的 API（没有实现 PerformConversion 方法）来获得相同的结果？

我正在使用 2.0 版。

编辑

我将把问题扩展到如何在代码中实现这种配置，无论是否使用 fluent API。

更新

如果您尝试将单个元素分配给数组属性，则会出现问题。下面提供了单元测试来说明问题。

```
namespace Components
{
    public class A
    {
        public I[] I { get; set; }
    }

    public interface I
    {
        string Name { get; }
    }

    public class B : I
    {
        public string Name { get { return "B"; } }
    }

    public class C : I
    {
        public string Name { get { return "C"; } }
    }
}

[TestMethod]
public void ArrayPropertyTestApi()
{
    //PASSES
    using (Castle.Windsor.WindsorContainer container = new Castle.Windsor.WindsorContainer())
    {
        container.Register(Component.For<Components.A>().ServiceOverrides(ServiceOverride.ForKey("I").Eq(typeof(Components.B).FullName, typeof(Components.C).FullName)));
        container.Register(Component.For<Components.B>());
        container.Register(Component.For<Components.C>());

        Components.A svc = container.Resolve<Components.A>();
        Assert.IsTrue(svc.I.Length == 2);
        Assert.IsTrue(svc.I[0].Name == "B");
        Assert.IsTrue(svc.I[1].Name == "C");
    }
}

[TestMethod]
public void ArrayPropertyTestApi2()
{
    //FAILS
    using (Castle.Windsor.WindsorContainer container = new Castle.Windsor.WindsorContainer())
    {
        container.Register(Component.For<Components.A>().ServiceOverrides(ServiceOverride.ForKey("I").Eq(typeof(Components.B).FullName)));
        container.Register(Component.For<Components.B>());
        container.Register(Component.For<Components.C>());

        Components.A svc = container.Resolve<Components.A>(); //Throws NotImplementedException
        Assert.IsTrue(svc.I.Length == 1);
        Assert.IsTrue(svc.I[0].Name == "B");
    }
} 
```

问题仍然存在。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T01:10:05.743

```
[TestFixture]
public class WindsorTests {

    [Test]
    public void ArrayConfig() {
        var container = new WindsorContainer();
        container.Register(Component.For<Listener>().Named("listener"));
        container.Register(Component.For<ActivityService>()
            .ServiceOverrides(ServiceOverride.ForKey("listeners").Eq(new[] {"listener"})));
        var service = container.Resolve<ActivityService>();
        Assert.AreEqual(1, service.Listeners.Length);
    }
}

public class Listener {}

public class ActivityService {
    public Listener[] Listeners { get; set; }
} 
```

这里的关键部分是`new[] {"listener"}`. MicroKernel 需要知道参数**listeners**是一个数组，如果您只传递“listener”，它会假定参数是标量并抛出，因为它无法将标量转换为数组。

# jquery - 将事件应用于 JQuery 中新创建的 Div

> ID：934357
> 
> 赞同：0
> 
> 时间：2009-06-01T11:03:08.483
> 
> 标签：jquery, html, click

我在 Jquery 工作..因为我是 JQuery 的新手。我怀疑我已经在该 DIv 中创建了一个 DIV，我有一个标签和一个文本框..我想要做的是点击那个 Generated Div，我需要显示一些现有值...但是当我单击我的 DIv 时，我会保持警报以检查单击事件是否有效。但是该单击不起作用...所以，请建议不允许新创建的 Div 事件单击？ ？？？我的代码是，

```
 $("<div id=field></div>").appendTo("#displayPanel");
   $("<label id=labelstr>untitled1</label>").appendTo("#displayPanel #field");
   $("<input id=inputstr type= 'text' ></input>").appendTo("#displayPanel #field");

 $("#displayPanel #field").click(function (){alert("div clicked");}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T11:23:56.117

没有什么可以阻止新的 div 元素被点击。事实上，我会建议页面上的其他内容阻止它工作（可能是重复的 ID？）

[您的代码在隔离时工作得很好。](http://jsbin.com/evapa)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T02:28:38.593

You want the [jQuery live function](http://docs.jquery.com/Events/live#typefn)

It allows you to add events to elements that are loaded after the DOM finishes loading.

# c++ - C++ 中大于 2^32 的整数使用什么类型？

> ID：934358
> 
> 赞同：13
> 
> 时间：2009-06-01T11:03:21.930
> 
> 标签：c++, types

我有一个整数变量，它可以得到一个大于 4294967295 的值。

我应该使用什么类型（long long、double 或其他）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-01T11:05:41.817

使用`long long`并在可能的情况下添加一个编译时断言该类型足够宽（smth like `sizeof( long long ) >= 8`）。

`double`是浮点数，不是整数。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-01T11:17:06.053

尝试：

[http://gmplib.org/](http://gmplib.org/)大数字。

[http://mattmccutchen.net/bigint/](http://mattmccutchen.net/bigint/)大整数。

我都没有使用过，但我在 Java 中使用过类似的东西。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-01T12:45:21.973

我将假设您的数字适合 64 位。如果没有，那么您需要一个[任意精度的算术库](http://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic)，例如[GMP](http://gmplib.org/)。

理论上，在 C++ 中进行 64 位数学运算没有简单、可移植的方法。实际上，大多数 C++ 编译器也支持“老式”C 头文件，C99 有一个很好的头文件，称为[stdint.h](http://en.wikipedia.org/wiki/Stdint.h)。

所以首先做：

```
#include <stdint.h> 
```

然后使用类型`int64_t`（有符号）和`uint64_t`（无符号）。

**编辑添加：**在我写完这个答案之后，C++11 添加了[<cstdint> 标头](http://en.wikipedia.org/wiki/Stdint.h)，它通常*定义 std::int64_t 和 std::uint64_t ，所以如果你有一个现代编译器，最好使用它们。

（* 理论上系统可能根本不支持 64 位类型。但实际上，在您可能遇到的任何系统上都会支持）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-01T11:10:49.607

在 C++ 中没有可移植的方式来执行此操作，因为该语言没有指定整数类型的大小（除了 sizeof char 为 1）。您需要查阅编译器文档。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-01T11:29:10.007

这两个提议都不好，因为 long long 不是标准的 C++ 数据类型，而 double 是浮点数。

由于我的程序必须是可移植的，我将 #define 我自己的类型，适合我使用的所有编译器（Visual Studio 和 gcc）：

```
#ifdef WIN32
  #define unsigned_long_long unsigned __int64
  #define long_long __int64
#else // gcc. Might not work on other compilers!
  #define unsigned_long_long unsigned long long
  #define long_long long long
#endif 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-01T12:16:42.110

不要使用双精度，因为：

```
cout.setf(ios::fixed);
cout << LONG_LONG_MAX << endl;
cout << double(LONG_LONG_MAX) << endl;

cout << LONG_LONG_MAX-100 << endl;
cout << double(LONG_LONG_MAX-100) << endl; 
```

输出：

```
9223372036854775807
9223372036854775808.000000
9223372036854775707
9223372036854775808.000000 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-01T11:18:14.227

我用

```
uint64_t 
```

但这不是标准的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-01T11:08:49.407

如果您不需要负数，则 unsigned long long 听起来像是您可以获得的大多数。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-01T11:44:39.163

试试[TTMath](http://www.ttmath.org/ttmath)。您需要做的就是包含一个标头，然后声明一个 bignum 类型，例如：

```
typedef ttmath::UInt<100> BigInt; 
```

它创建了一个可以容纳 0 到 2 ^ (32*100)-1 之间的无符号整数的类型。然后在`BigInt`任何你想使用的地方使用`int`.

当然，您可以为模板参数选择您喜欢的任何大小。100 可能是矫枉过正 ;-)

刚刚意识到，该库仅适用于 x86 和 x64，但在这些处理器上是操作系统跨平台的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-01T12:43:43.397

许多当前的 C/C++ 编译器都有[stdint.h](http://en.wikipedia.org/wiki/Stdint.h)或 inttypes.h 头文件。

`int_fast64_t`或者`int64_t`可能是一个选项（恕我直言，最便携）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-01T13:05:07.583

你的程序应该有多便携？TR1 具有 cstdint 和 stdint.h，因此大多数最新的编译器都可能支持它。如果不支持 cstdint，您应该可以使用 Boost cstdint.hpp。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-01T11:05:15.313

双打是浮点数。你应该使用 long long，可能。我不知道哪个别名是首选。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-01T11:22:22.517

如果您的编译器没有 long long，您可以自己使用包含两个 long 的结构来实现它们，但是您需要对进位等进行谨慎处理。您当然可以寻找像[GMP这样的多精度算术](http://gmplib.org/)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-11-19T07:01:31.773

只是出于好奇-如果您愿意，我认为编写自己的代码不会太难。我的意思是，所有这些数据类型当然都有预定义的结构，但是你可以，例如，使用`double`使用指数的结构，并执行以下操作：

为了容纳一个非常大的数字，超出双倍的规模，创建一个包含两个部分的对象 - 数字和十的幂，

所以，如果你想存储类似的东西

1.1230123123 x 10^(100000000000000000000000000000000000)，这不受双精度支持，您可以将 1.123 ... 部分存储在双精度中，然后将十的幂作为单独的双精度/整数/浮点数（无论适合什么），然后从那里拿走。当然，这可能不是最好的方法——您可能必须编写许多除法、减法等功能，但它肯定是可移植的，因为您将使用定义的普通数据类型。它的可用性取决于您要实现的目标以及您是否打算在单个项目之外使用它，但我认为如果这些数字是绝对要求，这是一种可行的方法

# postgresql - Postgresql 缓存（内存）性能 + 如何预热缓存

> ID：934360
> 
> 赞同：11
> 
> 时间：2009-06-01T11:03:58.840
> 
> 标签：postgresql

我有一个包含 25M 行的数据库表，每行约 3K（即约 75GB），连同我使用的多个索引（额外的 15-20GB）将无法完全放入内存（机器上为 64GB）。一个典型的查询通过一个索引定位 300 行，可选地使用其他索引将它们过滤到 ~50-300 行，最后获取匹配的行。响应时间在热数据库上的 20 毫秒到冷数据库上的 20 秒之间变化。我有两个相关的问题：

1.  在任何给定时间，我如何检查特定表和索引的哪一部分 (%) 缓存在内存中？

2.  在打开数据库进行查询之前预热缓存的最佳方法是什么？例如，“select *”强制进行顺序扫描（在冷数据库上约 15 分钟），但随后的响应时间仍然很差。有没有一种内置的方法来代替通过查询来做到这一点？

谢谢，也可以通过电子邮件回复 (info@shauldar.com])

-- 绍尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T20:01:47.333

关于您的第一点，contrib 模块“pg_buffercache”允许您检查缓冲区缓存的内容。我喜欢这样定义：

```
create or replace view util.buffercache_hogs as
select case
       when pg_buffercache.reldatabase = 0
            then '- global'
       when pg_buffercache.reldatabase <> (select pg_database.oid from pg_database where pg_database.datname = current_database())
            then '- database ' || quote_literal(pg_database.datname)
       when pg_namespace.nspname = 'pg_catalog'
            then '- system catalogues'
       when pg_class.oid is null and pg_buffercache.relfilenode > 0
            then '- unknown file ' || pg_buffercache.relfilenode
       when pg_namespace.nspname = 'pg_toast' and pg_class.relname ~ '^pg_toast_[0-9]+$'
            then (substring(pg_class.relname, 10)::oid)::regclass || ' TOAST'::text
       when pg_namespace.nspname = 'pg_toast' and pg_class.relname ~ '^pg_toast_[0-9]+_index$'
            then ((rtrim(substring(pg_class.relname, 10), '_index'))::oid)::regclass || ' TOAST index'
       else pg_class.oid::regclass::text
       end as key,
       count(*) as buffers, sum(case when pg_buffercache.isdirty then 1 else 0 end) as dirty_buffers,
       round(count(*) / (SELECT pg_settings.setting FROM pg_settings WHERE pg_settings.name = 'shared_buffers')::numeric, 4) as hog_factor
from pg_buffercache
     left join pg_database on pg_database.oid = pg_buffercache.reldatabase
     left join pg_class on pg_class.relfilenode = pg_buffercache.relfilenode
     left join pg_namespace on pg_namespace.oid = pg_class.relnamespace
group by 1
order by 2 desc; 
```

此外，“pageinspect”contrib 模块允许您从关系中访问特定页面，所以我想您可以简单地遍历关系中的所有页面来抓取它们？

```
select count(get_raw_page('information_schema.sql_features', n))
from generate_series(0,
        (select relpages-1 from pg_class where relname = 'sql_features')) n; 
```

这会将所有内容加载`information_schema.sql_features`到缓存中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T11:45:24.343

2）我通常通过记录来自实时系统的查询并重放它们来解决这个问题。这会预热数据的典型部分，而不是不经常使用的部分（否则会浪费 RAM）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T11:44:40.957

广告。1 - 我完全不知道。

广告。2 - 你为什么不随机选择一些你知道很重要的查询，然后在冷服务器上运行它们？您将运行的查询越多，预热过程就越好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T16:01:13.453

不要试图预热内存，这是 postgresql 和操作系统的工作。只需在分区中划分表（和索引）并尝试使用较小的数据集。如果您完成了建立良好的分区计划，那么庞大的索引或表就没有问题。如果您仍然想预热表和索引，那么可能可以完全缓存在 RAM 中，因为它们比以前小了。

# iphone - iPhone en_* 子语言本地化

> ID：934365
> 
> 赞同：10
> 
> 时间：2009-06-01T11:05:24.767
> 
> 标签：iphone, xcode, localization

我想在我的 iphone 应用程序中为 en_GB 和其他“en”子语言本地化字符串，但 XCode 和 iphone 拒绝让这种情况发生。我已经为 en_GB 和 en_US 创建了一个本地化的“Localizable.strings”（我尝试了连字符和下划线）用于测试目的，但它们就是无法识别。唯一有效的语言代码就是“en”（在 XCode 中显示为“English”）。

我不敢相信这是不可能的，所以我做错了什么？我也希望获得典型的“级联”行为，如果在子语言中找不到字符串，例如“en_GB”，那么如果可能的话，它应该从“en”中获取。帮助？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-10T13:22:05.990

当您从 iPhone 偏好设置的语言列表中选择“英语”时，这实际上意味着“en_US”语言。

因此，在苹果使用“英语（英国）”等其他子语言更新他们的软件之前，我们只能通过语言环境区域设置，并从另一个字符串表手动加载字符串。

但是，语言和区域区域设置是分开的，原因是：英国的西班牙用户可能希望根据当地习俗格式化日期/时间，但用他们的母语编写字符串。检测区域语言环境 (UK) 并因此显示 UK 字符串是不正确的。

所以目前基本上没有办法做到这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T17:41:58.703

你在做什么应该根据文档工作。但似乎 iPhoneOS 的实现与文档不一致。根据[Radar 6158876](http://discussions.apple.com/thread.jspa?threadID=1662877)，不支持 en_GB 语言，仅支持语言环境（日期格式等）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-08T21:29:33.200

我发现了同样的问题。

顺便说一句，如果您查看 iPhone 设置 -> 常规 -> 国际菜单，语言和地区之间的区别非常明显：

语言：
-英语

地区格式：
-美国
-英国

本地化框架似乎只关注语言，而不是地区。

我很想向 Apple 提出增强请求，因为 IMO 用户在美国时可能想要使用英式英语（文本）是合理的（例如，电话号码应该在美国）格式）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-30T13:52:03.147

这实际上可以做到 - 在这里查看我的解决方案 - [iPhone App Localization - 英文问题？](https://stackoverflow.com/questions/3308519/iphone-app-localization-english-problems/3311899#3311899)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-20T19:58:13.273

创建一个单独的字符串资源，比如`UKLocalization.strings`，并为您支持的每种语言创建本地化。对于除此`en`文件之外的所有本地化版本都是空的。对于`en`，它仅包含具有唯一 en_GB 拼写的字符串。

接下来，您为 NSLocalizationString 创建一个替换项，该替换项将首先检查 UKLocalization 表，然后再返回到标准本地化表。

例如：

```
static NSString* _locTable = nil;
void RTLocalizationInit()
{
    _locTable = nil;

    NSString* country = [[NSLocale currentLocale] objectForKey:NSLocaleCountryCode];
    if ([country isEqual:@"GB"])
    {
        _locTable = @"UKLocalization";
    }
}

NSString* RTLocalizedString(NSString* key, NSString* ignored)
{
    NSString* value = nil;
    value = [[NSBundle mainBundle] localizedStringForKey:key value:nil table: _locTable];
    if (value == key)
    {
        value = NSLocalizedString(key, @"");
    }
    return value;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-24T14:07:34.683

我不确定它是在哪个版本的 iOS 中引入的，但 iOS 7 肯定有一个“英式英语”语言偏好，可以从`en_GB.lproj`目录中获取资源。除非您追求更专业的*方言，否则网络上的各种 hack 应该是不必要的。

*看看我在那里做了什么；）

# sql - 如何在 Oracle 中编码字符串？

> ID：934371
> 
> 赞同：1
> 
> 时间：2009-06-01T11:07:29.677
> 
> 标签：sql, oracle, base64, encode

我在 Oracle 数据库中编码数据时遇到问题。我想用另一个字符串（掩码）对字符串进行异或，然后用base64对其进行编码。

在 Python 中，这看起来像：

```
def encode_str(s, mask):
    xor_mask = mask
    while len(xor_mask) < len(s):
        xor_mask += mask
    chrs2 = []
    for i in range(len(s)):
        chrs2.append(chr(ord(s[i]) ^ ord(xor_mask[i])))
    s2 = ''.join(chrs2)
    return base64.b64encode(s2)
    #return binascii.hexlify(s2).lower() 
```

在 PL/SQL 中，我得到：

```
create or replace function ht_encode(str in varchar2, mask in varchar2) return varchar2 as
  xor_mask varchar2(2000);
  result_s varchar2(2000);
  i integer;
  xx integer;
  x char(10);
  ch1 char(10);
  ch2 char(10);
  chrx varchar2(10);
begin
  result_s := '';
  xor_mask := mask;
  while length(xor_mask) < length(str) loop
    xor_mask := xor_mask || mask;
  end loop;
  for i in 1..length(str) loop
    ch1 := substr(str, i, 1);
    ch2 := substr(xor_mask, i, 1);
    xx := BITXOR(ascii(ch1), ascii(ch2));
    x := xx;
    chrx := rawtohex(x);
    --result_s := result_s || ':' || chrx;
    --result_s := result_s || chrx;
    -- HELP ME HERE!
  end loop;
  --return lower(utl_encode.base64_encode(result_s));
  --return result_s || ' | ' || rawtohex(result_s);
  -- HELP ME HERE!
  return result_s;
end; 
```

（bitxor 来自[http://forums.oracle.com/forums/thread.jspa?threadID=496773](http://forums.oracle.com/forums/thread.jspa?threadID=496773)）

我不知道如何创建“二进制”字符串，然后将其编码为十六进制或优于 base64。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T11:10:32.557

```
SELECT  UTL_RAW.cast_to_varchar2(UTL_ENCODE.base64_encode(UTL_RAW.bit_xor(UTL_RAW.cast_to_raw('text'), UTL_RAW.cast_to_raw('mask'))))
FROM    dual 
```

# php - 存储在数组中或使用多个数据库查询

> ID：934376
> 
> 赞同：1
> 
> 时间：2009-06-01T11:08:46.257
> 
> 标签：php, mysql

在 php/mysql 系统中，我们有许多配置值（大约 200） - 这些主要是布尔值或整数，并存储诸如每页结果数以及页面是 2 列还是 3 列之类的东西。这些都存储在单个 mysql 表中，我们使用单个函数在请求时返回这些值，在某些页面加载时，可能有多达 100 个对该配置表的请求。由于使用该系统的站点数量众多，这意味着每秒可能有数千个请求来检索这些值。问题是这种方法是否有意义，或者是否最好每页执行一个请求并将所有配置存储在一个数组中，然后每次都从这里检索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T11:15:26.150

如果启用`MySQL`查询缓存，选择您的值的查询将缓存在内存中，并`MySQL`会从内存中立即给出答案，除非基础表中的查询或数据发生更改。

这在性能和可管理性方面都非常出色。

查询结果可以在会话之间重复使用：这意味着，如果您有`1000`会话，则不需要保留`1000`数据的副本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T13:25:08.307

使用缓存，例如 memcache、APC 或任何其他缓存。加载设置一次，将其缓存，并通过会话与单例对象共享。

即使保存了查询缓存，一遍又一遍地查询数据库也是浪费时间和资源。相反，在任何修改值的请求中，使内存中的缓存无效，以便在下次有人从其中请求值时立即重新加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T11:25:59.950

您可能需要考虑为此使用 memcache。我认为它会比多个数据库查询更快（即使启用了查询缓存），而且您不需要数据库连接来获取它们。

您可能想考虑将它们从平面文件加载到内存中，这为您提供了对配置值进行版本控制的机会。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-25T11:57:32.357

我肯定会为此推荐memcache。我们有一个类似的设置，它显着降低了该服务器上的资源使用率。

# nhibernate - Nhibernate 映射：将列表封装在对象中

> ID：934393
> 
> 赞同：1
> 
> 时间：2009-06-01T11:13:58.587
> 
> 标签：nhibernate, nhibernate-mapping

我有两张桌子`Deal`和`Cost`. 成本可以有多种类型，例如计划内、计划外。每笔交易都可以有一个或只有一个每种类型的成本。这很容易映射为多对一交易，从而产生 IList of Costs。但我想要的是创建一个成本对象，该对象具有为每个成本命名的属性。所以对于一个看起来像这样的数据库：

```
Deal:               Cost
ID   Name           ID   DealID   Type        Value
---------           -------------------------------
1    Test           1    1        Planned     10
                    2    1        Unplanned   5 
```

可以这样访问

```
Deal.Costs.Planned = 10m;
Deal.Costs.Unplanned = 5m; 
```

映射这个的最好方法是什么？我应该映射它还是应该手动编写属性来查询底层集合？

我看到的困难在于映射成本的属性，以便它们映射到同一张表中的不同行。使用其中一列作为鉴别器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T11:23:33.357

这对我来说听起来并不像 Costs 是一个列表。

我会将成本映射为交易上的属性。如果您想保留 Deal.Costs.Planned 语法，您可以使用组件映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T11:26:35.720

手动编写~~属性~~方法：

```
public class Deal
{
    public virtual Cost GetPlannedCost() 
    {
        return _costs.FirstOrDefault(x => x.IsPlanned()); 
    }

    public virtual Cost GetUnplannedCost() {}
    {
        return _costs.FirstOrDefault(x => x.IsUnplanned()); 
    }

    public virtual Cost[] GetAllCosts() 
    {
        return _costs.ToArray(); 
    }

    private ISet<Cost> _costs = new HashedSet<Cost>();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T11:49:31.977

我会将成本映射为私人收藏，并在交易中公开计划内和计划外成本。这将允许您强制执行“每笔交易都可以有一个且只有一种成本”作为业务规则。它看起来像这样：

```
public class Deal
{
    private IList<Cost> _costs = new List<Cost>(2); // map this collection

    public Cost PlannedCost
    {
        get { return _costs.FirstOrDefault(c => c.Type == CostType.Planned); }
        set
        {
            var plannedCost = _costs.FirstOrDefault(c => c.Type == CostType.Planned);
            if (plannedCost != null)
            {
                _costs.Remove(plannedCost);
            }
            _costs.Add(value);
        }
    }

    public Cost UnplannedCost { // similarly }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T12:04:12.900

您可以使用 NHibernate 映射的公式标记在您的类中拥有公式属性。公式只是一个 SQL 语句，它将作为子查询插入到映射查询中。显然，公式属性是只读的，不能更新。

由于您想为每个交易计算这些属性，您应该将它们添加为交易属性（如果您想使用公式），因此您将拥有：

```
Deal.UnPlannedCosts
Deal.PlannedCosts 
```

[这](http://jason.whitehorn.ws/2008/02/19/NHibernate-Formula-Properties.aspx)是一篇解释公式属性的文章。

# doctrine - Doctrine 生成的模型可以有前缀吗？

> ID：934394
> 
> 赞同：2
> 
> 时间：2009-06-01T11:13:59.413
> 
> 标签：doctrine, zend-autoloader

教义中是否有一个选项可以为教义生成的任何类指定前缀？

我在使用新的 Zend 自动加载器和自动加载模型时遇到问题，教义自动加载器也无济于事。

理想情况下，我会让教义生成的类以“Model_”为前缀，如“Model_User”中。

我在尝试使用 generate-migrations-diff 生成迁移时遇到了这个问题，它说 Fatal error: Cannot redeclare class BaseUser in /tmp/fromprfx_doctrine_tmp_dirs/generated/BaseUser.php on line 38

因为实际模型是在新生成的类之前加载的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T11:18:36.067

抱歉，我问这个问题很仓促，几秒钟后就找到了答案。

添加：

```
Doctrine_Manager::getInstance()->setAttribute('model_loading', 'conservative'); 
```

修复了问题。

# c# - 跨数组传递给构造函数

> ID：934401
> 
> 赞同：1
> 
> 时间：2009-06-01T11:15:45.353
> 
> 标签：c#, arrays

如果我有一个类 FooWrapper 在构造过程中接收一个 Foo ：

```
Foo foo = new Foo();
FooWrapper fooWrapper = new FooWrapper(foo); 
```

通常，我会从一些 API 中得到 Foo 的数组

```
Foo[] foos = _api.GetFoos(); 
```

无论如何，我是否可以通过传入适当的 Foo 对象来构建一个 FooWrappers 数组，而无需简单地循环遍历每个对象？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-01T11:20:21.193

您可以使用[Array.ConvertAll](http://msdn.microsoft.com/en-us/library/exc45z53.aspx)方法。

```
FooWrapper[] wfoos = Array.ConvertAll<Foo, FooWrapper>(foos, delegate(Foo foo){return new FooWrapper(foo);}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T11:31:38.893

我认为 arul 有一个很好的答案，但我想提出一个问题：使用泛型和/或 LINQ 真的“更好”吗？

我会在这里使用一个简单的 for 循环。主要原因是可读性。

# c# - MyAssembly.XmlSerializers.dll 是为了什么而生成的？

> ID：934411
> 
> 赞同：126
> 
> 时间：2009-06-01T11:18:46.050
> 
> 标签：c#, visual-studio-2008, xml-serialization

我正在开发一个生成程序集的项目。我刚刚注意到正在生成一个额外的程序集 *.XmlSerializers.dll。为什么这个文件是自动生成的，它的用途是什么？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-06-01T11:28:03.643

在[.NET](http://en.wikipedia.org/wiki/.NET_Framework)实现中，XmlSerializer 生成一个临时程序集，用于序列化/反序列化您的类（出于性能原因）。它可以即时生成（但每次执行都需要时间），也可以在编译期间预先生成并保存在您询问的此程序集中。

您可以在项目选项中更改此行为（分别选项卡*编译*->*高级编译选项*->*生成序列化程序集*，*自动*或*打开*）。项目文件中对应的元素是*GenerateSerializationAssemblies*，例如`<GenerateSerializationAssemblies>Auto</GenerateSerializationAssemblies>`.

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2010-05-28T02:55:07.373

供参考。阻止自动生成 XmlSerializers.dll 的确切步骤是：

1.  在VS中，右键单击您的项目文件并选择“属性”
2.  单击“构建”选项卡
3.  将“生成序列化程序集”下拉菜单从“自动”更改为“关闭”
4.  重建它就会消失

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-01T11:23:42.607

出于性能原因，我认为这是 XML 序列化程序的 JIT（及时）编译。

使用 RegexOptions.Compiled 选项打开的 RegEx 实例可以得到相同的结果。

我不是 .NET CLR 专家，抱歉缺乏精确的技术细节。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-01T11:25:41.200

`*.XmlSerializers.dll`使用 Sgen.exe [XML Serializer Generator Tool] 生成

请参阅[MSDN 上的 Sgen.exe](http://msdn.microsoft.com/en-us/library/bk3w6240(VS.80).aspx)

通常`Sgen.exe`用于项目的构建后事件。查看您的项目是否有生成后的事件`*.XmlSerializers.dll`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-03-27T21:56:54.703

该项目仅为 Web 应用程序生成 project.XMLSerialisers.dll。对于其他应用程序，您必须单独运行 sgen。

# c++ - 如何进入图像处理编程？

> ID：934412
> 
> 赞同：3
> 
> 时间：2009-06-01T11:19:31.850
> 
> 标签：c++, image-processing, image-manipulation

我怎样才能做一些简单的事情，比如以编程方式操作图像？（我猜是用 C++ ..） jpgs/png/gif .....

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T11:24:31.310

查看 BOOST ，它有一个名为 GIL 的简单图像处理库。它还具有导入常见格式的扩展。

[http://www.boost.org/doc/libs/1_39_0/libs/gil/doc/index.html](http://www.boost.org/doc/libs/1_39_0/libs/gil/doc/index.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T11:44:32.533

使用 .NET，您有两种选择：

1.  System.Drawing 命名空间中的 GDI+（位图类）
2.  WPF引擎可以做很多事情

如果您想要低级处理，您可以使用不安全的代码和指针。

位图或图像只是一个大字节数组。你需要学习：

*   什么是步幅（每行像素后的额外填充字节）
*   如何使用宽度、高度、步幅计算下一行或特定像素位置
*   图像格式 RGB、ARGB、黑白
*   基本图像处理功能（亮度、中间色调、对比度、颜色检测、边缘检测、矩阵抽搐）
*   RGB 颜色的 3D 矢量表示

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T11:47:21.640

根据您想要获得的花哨，您可能需要查看[OpenCV](http://opencv.willowgarage.com/wiki/)。它是一个计算机视觉库，具有从读取和写入图像到图像处理再到对象检测等高级功能的功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T11:52:39.117

[Magick++](http://www.imagemagick.org/Magick++/)是优秀的 ImageMagick 库的 C++ API。

ImageMagick 的一个优点是它可以从命令行以及[一堆](http://www.imagemagick.org/script/api.php)流行的脚本和编译语言中使用，其中一些可能比 C++ 更容易访问。

# asp.net - 如何使用 ASP.NET 和 iframe 跨域对用户进行身份验证？

> ID：934422
> 
> 赞同：4
> 
> 时间：2009-06-01T11:23:31.483
> 
> 标签：asp.net, authentication, iframe, cross-domain

我正在为一个客户创建一个 ASP.NET 网站，该客户希望通过 IFRAME 在其他“经销商”网站上提供他们的报告页面。经销商网站提供具有不同品牌的相同服务。我需要尽可能避免要求他们在其网络服务器上实现任何代码以启用此功能 - 因此使用 iframe。

用户将登录到经销商网站，加载包含 iframe 的页面，然后在主站点加载报告。作为参数，我们将发送经销商 ID 和他们的用户名。

我们可以使用 SSL 服务器证书，但不能使用任何联合登录（如 OpenId）——客户端的业务选择。

问题是，主站点如何验证从经销商处加载页面的用户确实正在请求报告页面？换句话说，如何跨域对用户进行身份验证，而不需要经销商实现代码..

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T12:35:17.410

对于您需要登录的每个域，您的登录表单可以使用一些 javascript 将登录表单发布到隐藏的 iframe（由于跨域安全问题，您不能使用 XMLHTTPRequest）。

请务必将您的 iframe 重定向回原始域，否则由于跨域安全性，您将无法从 iframe 中获取登录状态。

IE 支持的最后一个技巧是翻转邪恶位并添加

```
P3P: CP="CAO PSA OUR" 
```

到您的 HTTP 响应标头。它告诉浏览器“我不会做任何坏事，老实说”。

[http://support.microsoft.com/kb/323752](http://support.microsoft.com/kb/323752)

[http://www.w3.org/P3P/](http://www.w3.org/P3P/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T14:44:19.313

如果不在经销商网站上实现任何代码，我认为没有令人满意的方法可以做到这一点。

相反，我会要求他们从经销商网络服务器向主网络服务器发送一个 HTTPS 请求，传递一个唯一的密钥来识别自己，以及他们登录用户的用户名。

一旦在主站点上验证，此密钥将用作经销商的身份验证，并扩展为他们的登录用户。

此请求的响应将包含一个 html 片段字符串，经销商可以将其注入任何页面。

该片段将包含一个 iframe，而 iframe 反过来会使用登录用户的用户名直接从主站点加载登录用户的报告。此报告内容将包含对特定于经销商的样式表的引用。

使用这种方法，我会说浏览器不需要 HTTPS，因为经销商和他们的用户都经过身份验证，如果该过程通过 HTTPS 发生，我们可以假设没有窃听者。

在密钥或用户密码被泄露的情况下，来自浏览器的 HTTPS 无论如何都没有任何区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T12:17:45.773

我可能遗漏了一些东西，但是如果客户端通过了您的服务器的身份验证，那么如果您通过 iframe 查看它，它仍然会通过身份验证。

例如，在您的服务器上创建一个带有 iframe 到 gmail 的 HTML 页面。只要您在浏览器中通过 gmail 身份验证，您就会在该页面中看到您的收件箱...

# web-services - 使用您自己的 API 构建您的网站

> ID：934429
> 
> 赞同：1
> 
> 时间：2009-06-01T11:25:26.863
> 
> 标签：web-services, api

我正在寻找创建一个新站点，为了鼓励自己创建一个强大的 API 供其他人使用，我很想编写 API 并自己使用它来构建实际站点。这个想法是，如果它能够运行主站点，那么它将为其他用户提供大量选项来进行自己的操作。它还将鼓励我保持 API 是最新的。

我想知道的是这个想法是否值得采用，或者它是否只是简单的坚果。

这是常见的做法吗？它可能会导致代码过于复杂吗？如果（偶然）该网站要起飞，它会导致性能问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T11:42:13.630

这是一个好主意，只要你是为自己做，而不是浪费别人的时间/金钱。

从头开始编写自己的框架是自学规划和编写代码的好方法。这可能需要很长时间并且是一次漫长的冒险，但我个人可以证明，它迫使你成为所有方面的专家。

但是，对于任何在别人的钱上开发的东西，或者是关键任务（安全性或性能），我建议在合乎逻辑的情况下重新使用现有框架。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T11:41:57.593

构建一个公共 api 并在内部使用它是一种常见的做法，根据我的经验，它会产生更清晰的代码（而不是维护两组，一组内部，一组外部）。可能会影响性能，但在您看到一些真正的需求之前，我不会太担心这一点。否则，您可以解决不存在的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-08T11:28:42.567

绝对是个好主意。始终编​​程到接口，而不是实现。所以使用你自己的 API 很有意义，不这样做可能是一种冗余形式。

需要注意的一件事是早期优化。你真的需要所有这些功能吗？

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-06-01T11:38:33.997

已经有一些非常棒的 AP​​I。为什么要重新发明轮子？（我假设这是你想要做的）

# sql - SQL 2005 中 XML 数据类型的大小限制

> ID：934430
> 
> 赞同：7
> 
> 时间：2009-06-01T11:25:40.607
> 
> 标签：sql, sql-server, xml, sql-server-2005

SQL 2005 中的 XML 数据类型是否有大小限制？

当我尝试从我的存储过程中返回超过 44kb 大小的 XML 字符串时，它只返回一个空字符串。我正在使用 FOR XML PATH 从存储的过程中返回 XML 格式的分层数据集。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-01T11:38:28.957

[xml 数据类型为2GB](http://msdn.microsoft.com/en-us/library/ms187339(SQL.90).aspx)。

您是否仅在 SSMS 或客户端代码中获得 44k？SSMS 限制了 Tools..Options..Query Results 下的 LOB 类型数据

编辑，评论后：

如果您再次进入选项，SSMS 可能已将值更改回来。

如果您在网格模式下查看结果，则 SSMS 将 xml 显示为一个链接，该链接会在包含所有数据的新窗口中打开（我检查了 FOR XML AUTO 与 16000 行表）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-23T19:16:09.803

如果您在 SQL Server Management Studio 中查看结果，则可以选择设置它可以显示多少数据，默认情况下只有 2MB。

要更改它，请遵循以下路径：
工具 > 选项 > 查询结果 > SQL Server > 网格结果 > 检索到的最大字符数

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T11:50:19.170

根据文档，它将 XML 数据存储为 BLOB。所以 SQL 2005 的限制应该是 2gb，而在 SQL 2008 中实际上是无限的。

# php - 多个域指向一个 PHP 文件

> ID：934433
> 
> 赞同：0
> 
> 时间：2009-06-01T11:25:51.353
> 
> 标签：php, url

我的 2 个网址，例如 www.abc.com 和 www.def.com 指向同一个 .php 文件。我在该目标页面上有一些文本需要根据它来自 www.abc.com 还是 www.def.com 进行动态更改。这可以做到吗？如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T11:27:46.763

查看[`$_SERVER['HTTP_HOST']`](http://docs.php.net/manual/en/reserved.variables.server.php)当前请求的主机名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T11:32:55.880

在 Apache 的配置中，将两个主机名配置为指向同一个目录。如果这是不可能的，例如因为您在共享主机上，那么您仍然可以对两个主机名使用符号链接。

在 PHP 中，您可以确定与变量一起使用的主机名`$_SERVER['HTTP_HOST']`。

# java - 在 JPA 查询中修改属性名称

> ID：934439
> 
> 赞同：4
> 
> 时间：2009-06-01T11:27:37.793
> 
> 标签：java, hibernate, jpa, annotations

我使用的是在字段名称前加上下划线的约定。当我使用此类字段生成注释实体类时，我坚持在查询中使用带下划线前缀的属性名称。我想避免这种情况，并且能够做到：

```
@Entity
public class Container {

    private String _value;
}

// in a lookup method
executeQuery("from Container where value = ?", value); 
```

这对于一般的 JPA 或特别是 Hibernate 是否可行？

* * *

**更新：**仍在尝试记住原因，但我需要在字段上而不是在 getter 上对此进行注释。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T12:39:57.773

您可以对 getter 进行注释：

```
@Entity
public class Container {

    private String _value;

    @Column
    public String getValue()
    {
        return _value;
    }

    public void setValue( String value )
    {
        this._value = value;
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T12:31:35.357

您也许可以编写生成的实体类的子类，它们具有 getter 方法，然后将实体管理器配置为使用 getter/setter 访问而不是字段访问？然后你的 getter/setter 可以有任何你喜欢的名字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-10T18:15:05.133

Have a look at [`NamingStrategy`](https://www.hibernate.org/hib_docs/v3/api/org/hibernate/cfg/NamingStrategy.html). It would be fairly easy to extend the `DefaultNamingStrategy` and override the `columnName` method to strip the first underscore (if it is there).

# c# - 如何使用触发器或任何其他事件在 wpf 中更改按钮颜色 onmoveover、onmouseleave

> ID：934442
> 
> 赞同：5
> 
> 时间：2009-06-01T11:28:54.343
> 
> 标签：c#, wpf, button, triggers

我开发了一个带有一些按钮的 WPF 应用程序。现在我想通过使用触发器或任何其他事件来更改这些按钮 onmouseover、onmouseleave、onmouseenter 的颜色。任何建议请提前感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T13:32:52.753

在所需的事件中，您可以像这样设置背景颜色...

```
// Change the background color of button1 to Blue
button1.Background = Brushes.Blue; 
```

您还可以在触发器中设置它：

```
<!-- Button will change from Blue to Yellow on MouseOver -->
<Style TargetType="{x:Type Button}">
    <Setter Property="Background" Value="Blue" />
    <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
            <Setter Property="Background" Value="Yellow" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

有关更多详细信息，请查看本文的[属性](http://www.microsoft.com/belux/msdn/nl/community/columns/gillcleeren/wpf_stylesandtriggers.mspx)**触发器**部分。

# vb.net - 使用 linq to sql dbml，如何获取数据类型的大小？像 varchar(50)，如何得到 50？

> ID：934445
> 
> 赞同：0
> 
> 时间：2009-06-01T11:29:38.367
> 
> 标签：vb.net, linq-to-sql

使用 linq to sql（dbml 文件），如何获取数据类型的大小？

例如，varchar(50)，如何得到 50？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T11:35:40.337

您可以从与该属性关联的 ColumnAttribute 中获取字符串（例如：“NVarChar(30)”）。

```
var prop = typeof(User).GetProperty("FirstName");
var attr = (ColumnAttribute)prop.GetCustomAttributes(typeof(ColumnAttribute), false)[0];
string dbType = attr.DbType;
int index = dbType.IndexOf("(") + 1;
int width = int.Parse(dbType.Substring(index, dbType.IndexOf(")") - index)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T11:49:40.293

你也可以这样做...

```
 String databaseType = 
        *DataContextInstance*.Mapping.MappingSource
        .GetModel(typeof(*DataContext*))
        .GetMetaType(typeof(*Entity*))
        .DataMembers.First(x => x.Name.Equals("ColumnName"))
        .DbType; 
```

希望有帮助**:)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T22:45:25.067

[我用了那个方法](http://l2st4.codeplex.com/Thread/View.aspx?ThreadId=47488)

# jquery - 为什么jQuery会抛出错误'fadeOut is not a function'？

> ID：934446
> 
> 赞同：39
> 
> 时间：2009-06-01T11:30:11.347
> 
> 标签：jquery

我正在使用 jQuery 并将这段代码放在我的 javascript 中：

```
function HideMe(itemID) {
    var myDiv = 'item_' + itemID;
    $(myDiv).fadeOut("slow");
} 
```

但它给了我这个错误：*`fadeOut`is not a function*。

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2016-10-20T13:04:18.310

如果您使用 jQuery 的“slim”版本，就会发生这种情况。只有“完整”版本的 jQuery 包含动画效果。

尝试从[jQuery 下载页面](https://jquery.com/download/)获取“完整”版本的 jQuery，并将其包含在您的页面中（或从页面[的 CDN 中包含完整版本的 jQuery](https://code.jquery.com/)）。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-06-01T11:53:53.250

你在那个页面上有另一个 javascript 库吗？看起来你有这个`hide`功能，并且`$`定义了（例如，原型也有一个`hide`功能）。
如果是这种情况，请尝试：

```
jQuery("#item_0").fadeOut("slow"); 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2016-11-16T19:16:22.140

我遇到了这个错误，因为我使用的是 jQuery 的精简版本。如果你下载完整版应该没问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-01T11:39:12.467

**即使选择器没有返回集合中的任何项目，如果正确加载了 jQuery ，函数调用也会起作用（*无论如何都不会生成此错误）。***页面中存在冲突，或者根本没有加载。你可以试试

```
jQuery(myDiv).fadeOut("slow"); 
```

或者看看为什么 jQuery 没有被加载。

`#`PS：如果按 id 选择，不要忘记选择器中的 。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-01T11:37:27.633

此外，您可能在选择器中忘记了 a `#`（除非您`<item_1 />`在标记中有类似的东西）。

```
var myDiv = '#item_' + itemID; 
```

jQuery 使用 CSS 选择器来搜索元素，因此如果没有`#`，您将获得带有标签`item_x`而不是 ID 的每个元素。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-10-16T04:55:24.060

由于 Jquery 库的精简版本，它发生在我身上。完整版的 Jquery 库包括动画。

Jquery CDN 可在[https://code.jquery.com/获得](https://code.jquery.com/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-01T11:37:02.533

看起来 jquery 没有正确附加到页面。

检查您与 jQuery 的链接。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-01T11:45:12.423

试着把它藏在里面

```
$(document).ready(function(){
// your code. and don't forget the '#' in front of item.
}); 
```

看起来您正试图在 jQuery / DOM 加载之前调用该函数。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-01T11:32:13.510

你有`liDiv`而不是`myDiv`. 尝试：

```
function HideMe(itemID) {
    var myDiv = 'item_' + itemID;
    $(myDiv).fadeOut("slow");
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-05-15T19:48:17.533

在将 .html 模板移动到 wordpress 模板时，我发现它经常弹出。

两个原因，控制台错误可能具有欺骗性：

1.  控制台中的错误可能**会让您走错路**。这可能不是真正的问题。对我来说，第一个原因是您设置要加载的 .js 文件的**顺序。**在 html easy 中，将它们按与主题模板相同的顺序放置。在 Wordpress 中，您需要以正确的顺序将它们排入队列，但如果它们没有以正确的顺序出现，还需要设置优先级，

2.  第二件事是**页眉或页脚**中的 .js 文件。将它们移到页脚可以解决问题 - 经过一天的尝试调试问题后，它对我有用。通常没关系，但是对于一个有很多 js 库的复杂页面，它可能会！

# java - 如何从随机访问文件中删除特定行

> ID：934458
> 
> 赞同：1
> 
> 时间：2009-06-01T11:34:29.293
> 
> 标签：java

我正在使用一个随机访问文件，我想在其中删除满足某些条件的行，例如我有记录

马华 30

工商管理硕士 20

BCA 10

现在我的要求是如果我进入MBA，那么第二行将被删除。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T12:01:21.160

通常，从文件中间删除一个项目意味着重写该条目之后的所有条目，以使用该项目所占用的空间。

有些东西会用一些无效值标记已删除的项目，以便发现该插槽未使用。通常，它们甚至不会重用已删除的插槽，因为这比您想象的要管理更多，并且基本上是在文件中实现类似堆的体系结构。他们需要一个单独的“压缩”步骤来稍后删除这个死区。Microsoft Jet（如在 Access 中）就是这样工作的。

有一个非常酷的优化适用于某些情况：

如果行无序且长度相等，您可以用最后一个条目覆盖要“删除”的条目，并截断文件。

如果行是无序的但不是固定长度的，您可以使用这种方法的更复杂的变体，您可以将一些条目从末端附近移动，该条目的长度与要删除的项目相同，以便只需要洗牌。条目尽可能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T11:43:18.293

如果它是一个简单的文本文件，则必须将除 MBA 行之外的所有内容复制到新文件中。随机访问文件并不真正支持删除或插入。

优化：移动MBA排队后的所有内容（在同一个文件中）

替代方案：使用更结构化的东西，如数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T11:50:21.617

在我看来，您正在寻找类似“grep”的实现。有一个 GNU grep 的 Java 实现，您可以在[此处找到文档，并](http://www.ssec.wisc.edu/visad-docs/javadoc/gnu/regexp/util/Grep.html)[从此](http://nlp.stanford.edu/nlp/javadoc/gnu-regexp-docs/)页面中的链接下载。

# c# - 混淆和 protobuf.net - 例外：未定义默认枚举值

> ID：934459
> 
> 赞同：1
> 
> 时间：2009-06-01T11:34:30.683
> 
> 标签：c#, obfuscation, protocol-buffers, protobuf-net

尝试序列化包含混淆项目中的枚举的类时，出现以下异常：

> ProtoBuf.ProtoException：未为可选属性 Y 定义默认枚举值 X

如果我从混淆中排除所有受影响的枚举，一切运行正常，但是，我切换到 protobuf.net 以便能够混淆更多代码内容，所以我希望有更好的解决方案。

那么是混淆器对 protobuf.net 造成了很大的影响，还是我以错误的方式声明我的枚举？

我努力了：

```
 [ProtoContract]
    public enum X
    {
        Y, Z
    } 
```

和

```
 [ProtoContract]
    public enum X
    {
        Y=0, Z=1
    } 
```

也根本没有合同和其他一些不那么明显的事情，但除了排除工作之外什么都没有。顺便说一句：在使用 protobuf.net 时，我们与枚举有什么关系吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T11:50:44.020

嗯....老实说，我不知道枚举的混淆问题；我将不得不准备一个测试用例进行调查。

如果您能告诉我您正在使用什么混淆工具，那将会有所帮助。查看您如何指定默认值（即属性定义）也将有所帮助。

请注意，它仅`[ProtoEnum]`在枚举的情况下才真正考虑（`[ProtoContract]`可用于为其命名，但除非您正在生成 .proto 文件，否则不会使用它，这不太可能） - 但我不希望它在这种情况下会影响任何事情（这用于将“在线”值更改为与 .NET 中不同的值）。至于例子；我承认我落后于文档 - 但[这里的枚举测试用例](http://code.google.com/p/protobuf-net/source/browse/trunk/Examples/EnumTests.cs)显示了典型用法。

我已将此记录为[第 59 期](http://code.google.com/p/protobuf-net/issues/detail?id=59)；如果你能让我知道上面的细节（在这里，或者给我发电子邮件 - 查看我的个人资料），我会尝试调查。

（如果你不知道，我是protobuf-net的作者）

* * *

我尝试了以下（使用 .NET Reactor）并且效果很好......枚举值的隐式默认为零是最有可能的怀疑。你能提供一个显示它失败的测试用例吗？

```
using System;
using ProtoBuf;

[ProtoContract]
class Foo {
    static void Main() {
        Foo foo = new Foo { Bar = MyEnum.B };
        Console.WriteLine(foo.Bar);
        Foo clone = Serializer.DeepClone(foo);
        Console.WriteLine(clone.Bar); // Expect "B"
    }

    [ProtoMember(1)]
    public MyEnum Bar { get; set; }
}
enum MyEnum { A, B, C } 
```

# python - 从蓝牙设备获取响应

> ID：934460
> 
> 赞同：3
> 
> 时间：2009-06-01T11:35:07.920
> 
> 标签：python, sms, bluetooth, mobile-phones

我正在尝试编写一个可以发送短信的简单模块。我使用以下示例使用蓝牙连接到手机：

# 文件：bt-sendsms.py

```
import bluetooth

target = '00:32:AC:32:36:E8' #  Mobile address 
print "Trying to send SMS on %s" %  target

BTSocket = bluetooth.BluetoothSocket(bluetooth.RFCOMM)
BTSocket.connect((target, 2)) # BT Address
BTSocket.send('ATZ\r')
BTSocket.send('AT+CMGF=1\r')
#sockfd.send('AT+CSCA="+972547716507"\r') # This line changes the SMSC address - do not modify unless required 
BTSocket.send('AT+CMGS="+972547877763"\r') # TO Phone Number
BTSocket.send('This is a test message - port 2.\n')
BTSocket.send(chr(26)) # CTRL+Z

print "SMS sent"
sockfd.close()
print "Closed" 
```

我的问题是我无法验证或获取 SMS 发送或任何套接字操作的错误代码。

任何对正确方向的推荐将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T12:02:02.233

从 Python 中，您看起来好像正在打开任何旧的 RFCOMM 通道，并希望它能够神奇地接收 AT 命令并进行消息传递。

我认为（我可能是错的）您需要连接到特定的配置文件/服务通道，我认为对于 SMS，它是消息访问配置文件 (MAP)，它尚未标准化，因此要找到带有它的电话，好吧，我不会说不可能，但非常非常不可能。否则，某些手机将支持 AT 命令进行消息传递，但这超出了规范，例如，我有权授权 Sony-Ericson 手机通过拨号网络配置文件 (DUN) 支持它。

那么，首先，您的移动设备是否支持某些不符合规范的短信 AT 命令，如果支持，是否支持特定配置文件或临时专有配置文件？接下来，您需要连接到该配置文件。

您可以使用以下 Python 浏览支持的服务等...（检查所有周围的 BT 设备）...

```
import bluetooth

def whats_nearby():
    name_by_addr = {}
    nearby = bluetooth.discover_devices(flush_cache=True)
    for bd_addr in nearby:
        name = bluetooth.lookup_name( bd_addr, 5)
        print bd_addr, name
        name_by_addr[bd_addr] = name
    return name_by_addr

def what_services( addr, name ):
    print " %s - %s" % ( addr, name )
    for services in bluetooth.find_service(address = addr): 
        print "\t Name:           %s" % (services["name"]) 
        print "\t Description:    %s" % (services["description"]) 
        print "\t Protocol:       %s" % (services["protocol"]) 
        print "\t Provider:       %s" % (services["provider"]) 
        print "\t Port:           %s" % (services["port"]) 
        print "\t service-classes %s" % (services["service-classes"])
        print "\t profiles        %s" % (services["profiles"])
        print "\t Service id:  %s" % (services["service-id"]) 
        print "" 

if __name__ == "__main__":
    name_by_addr = whats_nearby()
    for addr in name_by_addr.keys():
        what_services(addr, name_by_addr[addr]) 
```

一旦您找到正确的服务/配置文件，您的下一个问题将是协商安全性（用于配对的密码），我还没有弄清楚如何去做！

请访问[www.bluetooth.org](http://www.bluetooth.org)了解您的所有蓝牙需求！

# .net - ScriptResource 错误：我被黑了吗？

> ID：934462
> 
> 赞同：7
> 
> 时间：2009-06-01T11:35:20.867
> 
> 标签：.net, scriptresource.axd

我在我的一个网站上不断收到这样的错误。它往往在一天中随机发生，在我不希望网站上有用户的夜间时段。

它总是来自不同的IP地址

> System.Web.HttpException：无效的视图状态。在 System.Web.UI.Page.DecryptStringWithIV(String s, IVType ivType) 在 System.Web.UI.Page.DecryptString(String s)

或者

> System.Security.Cryptography.CryptographicException：填充无效且无法删除。在 System.Security.Cryptography.RijndaelManagedTransform.DecryptData(Byte[] inputBuffer, Int32 inputOffset, Int32 inputCount, Byte[]& outputBuffer, Int32 outputOffset, PaddingMode paddingMode, Boolean fLast) 在 System.Security.Cryptography.RijndaelManagedTransform.TransformFinalBlock(Byte[ ] inputBuffer, Int32 inputOffset, Int32 inputCount) at System.Security.Cryptography.CryptoStream.FlushFinalBlock() at System.Web.Configuration.MachineKeySection.EncryptOrDecryptData(Boolean fEncrypt, Byte[] buf, Byte[] 修饰符, Int32 start, Int32 长度, IVType ivType, Boolean useValidationSymAlgo) 在 System.Web.UI.Page.DecryptStringWithIV(String s, IVType ivType) 在 System.Web.UI.Page.DecryptString(String s)

它们发生在此页面中：

```
 ScriptResource.axd?d=VVe1O4rzLSI9hB5nRzBXZxUYTQz6ylDTL9djGR 
```

该站点使用 Ajax 并在 .NET 3 上运行。

这是有人试图入侵该网站吗？网站上的 html 是否有错误？

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T11:55:14.930

我相信这个错误是由你的 ViewState 使用过期的 ViewStateUserKey 解密引起的。

删除这些错误是一个两步过程：

1.  确保您拥有特定于站点的验证密钥。您可以使用多种在线资源为您生成一个，例如[这个](http://aspnetresources.com/tools/keycreator.aspx)。
2.  确保页面的 ViewStateUserKey 始终一致。从 MSDN 文档：

> 设置 ViewStateUserKey 属性可以帮助您防止恶意用户对您的应用程序进行攻击。它允许您为各个用户的视图状态变量分配一个标识符，这样他们就不能使用该变量来生成攻击。您可以将此属性设置为任何字符串值，例如用户的会话 ID 或用户的认证名称。

您可以通过自己设置来做到这一点（可能在您的 Page 或基本 Page 的 Init 事件中）：

```
if (Session["ViewStateUserKey"] == null)
{
    Session["ViewStateUserKey"] = new Guid().ToString();
}    
this.Page.ViewStateUserKey = Session["ViewStateUserKey"].ToString(); 
```

不，我不认为你被黑客入侵了。

# javascript - html & javascript：如何存储引用 html 元素的数据

> ID：934463
> 
> 赞同：10
> 
> 时间：2009-06-01T11:35:34.860
> 
> 标签：javascript, jquery, html

我正在开发一个使用 ajax 与服务器通信的 Web 应用程序。我的具体情况如下：

我在 html 页面中有一个用户列表。对于这些用户中的每一个，我可以执行以下操作：更改他们的“状态”或从帐户中“删除”他们。

在页面中存储以下信息的最佳做法是：

*   用户标识
*   用户的当前状态

PS：我正在使用 jQuery。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-01T11:50:08.747

有jQuery的数据功能

```
$('li').data('userid',uid); // sets the value of userid
uid = $('li').data('userid'); // retrieves the value of userid 
```

官方文档：[http ://docs.jquery.com/Data](http://docs.jquery.com/Data)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T05:00:39.490

关于什么是最好的使用存在很多争论。您可以通过多种方式存储数据，而且它们都会让人感到高兴——如果您使用 XHTML，自定义属性当然不会生效，并且使用类来存储一两位数据充其量是笨拙的，而且只会变得更糟你想知道的事情的数量。就个人而言，我不仅不是 XHTML 的忠实粉丝，而且我也不太喜欢验证纳粹，所以我建议使用自定义属性。

但是，有一个选项可以使自定义属性与标准相协调：`data-`属性。正如 John Resig（jQuery 的作者）[在他的博客中所写](http://ejohn.org/blog/html-5-data-attributes/)，这是 HTML5 中引入的一个新属性，允许您使用前缀指定[自定义数据属性。](http://dev.w3.org/html5/spec/Overview.html#custom-data-attribute)`data-`所以一个完全有效的元素可能看起来像这样：

```
<ul>
    <li data-userid='5' data-status='active'>Paolo Bergantino</li>
</ul> 
```

这样做的好处是，虽然您仍在使用自定义属性，如果您使用 XHTML，这*可能会*很糟糕，但您的代码将会很好地老化，因为这是我们将来存储与特定项目相关的数据的方式。

进一步阅读是[Attributes > Classes: Custom DOM Attributes for Fun and Profit。](http://unspace.ca/discover/attributes/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-01T11:41:08.127

也许使用自定义属性，所以对于用户的列表元素，为变量添加属性：

```
<li uid="theuserid" ustatus="thestatus"></li> 
```

然后可以使用 attr 函数获取值：

```
$("li").attr("uid") 
```

和

```
$("li").attr("ustatus") 
```

**注意：**显然需要更改选择器

请注意，对于自定义属性的使用存在不同的意见 - 但是，这对于每个主要浏览器都应该没问题。这也是我能想到的最简单的解决方案。它不需要跳转到同级元素来获取数据或查找附近的元素，这都会增加少量的处理开销——我在做这些事情时尽量减少添加到 DOM 的额外膨胀量。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-01T11:46:20.440

**jQuery 数据**

如果要针对 jQuery 对象存储自定义数据，请使用[data 函数](http://docs.jquery.com/Core/data)。

```
$('#myField').data('name', 'Jack');
var name = $('#myField').data('name'); 
```

**HTML5 数据-* 属性**

您也可以使用 HTML5`data-*`属性，尽管不同浏览器仅部分支持访问这些属性的 API。[这是有关此的更多信息](http://html5doctor.com/html5-custom-data-attributes/)。

```
<div data-userid="123" class="user-row"> 
```

以编程方式：

```
$('#myElement').attr('data-fruit', 'apple');
// or
document.getElementById('myElement').dataset.fruit = 'apple'; 
```

**隐藏字段**

如果您想以旧的浏览器兼容方式执行操作并将元数据直接填充到您的 html 中，您可以使用隐藏字段。这有点粗略，但很容易做到。

```
<input type="hidden" name="UserID" value="[userid]" /> 
```

您可以轻松地使用[jQuery 选择器](http://docs.jquery.com/Selectors)来查询您的列表并查找包含用户项的 html 块，这些用户项具有与您查询的元数据匹配的相关隐藏字段。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T12:29:53.630

In this case, I think custom attributes might be overkill. You can store the user-id in the *id*-attribute, since there will only be one instance of the user in the list, right? Also, the status of the user could be stored in the *class*-attribute. In this way, each user could be given different styling in CSS, such as green for active, yellow for a non-activated account, and red for a suspended account.

The code for fetching the status will, however, be a little more complex compared to using a custom attribute (But only if you also want to have multiple classes). On a more positive note, the HTML will validate with this approach whereas it would not with custom attributes.

```
<ul id="userList">
    <li id="uid123" class="active">UserName X</li>
    <li id="uid456" class="suspended">Mr. Troll</li>
</ul>

/**
 * Simple function for searching (strict) for a value in an array
 * @param array arr The array to look in
 * @param mixed val The value to look for in arr. Note that the value is looked for using strict comparison
 * @return boolean true if val is found in arr, else false
 */
function searchArray(arr, val) {
    for(var i = 0, len = arr.length; i < len; i++) {
        if(arr[i] === val) {
            return true;
        }
    }
    return false;
}

/**
 * Gets a known status from a string of class names. Each class name should be separated
 * by a space.
 * @param string classNames The string to check for a known status
 * @return string|false The status if found in classNames, else false
 */
function getStatus(classNames) {
    // The different statuses a user can have. Change this into your own!
    var statuses = ['active', 'suspended', 'inactive'], 
        nameArr = classNames.split(" ");
    for(var i = 0, nameLen = nameArr.length; i < nameLen; i++) {
        // If we find a valid status among the class names, return it
        if(searchArray(statuses, nameArr[i])) {
            return nameArr[i];
        }
    }
    return false; // We didn't find any known status in classNames
}

var id = $("li").attr("id"); // Fetches the id for the first user
var status = getStatus($("li").attr("class")); // Fetches the status of the first user 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-03T04:32:31.753

jquery的[元数据](http://plugins.jquery.com/project/metadata)插件就是你的答案。

```
<html >
<head>
<script src="/js/jquery-1.3.2.js"></script>
<script src="/js/jquery.metadata.js"></script>
</head>
<body>
<ul>
<li type="text" class="{UID:'1',status:'alive'}">Adam</li>
<li type="text" class="{UID:'2',status:'alive'}">Bob</li>
<li type="text" class="{UID:'3',status:'alive'}">Carol</li>
</ul>
<script>
$('li').each(function(){window.console.log($(this).metadata().UID)});
</script>
</body>
</html> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-01T12:40:01.580

To answer the question of "how to get it into the document in the first place", I suggest a layout similar to this:

```
<ul id="users">
    <li id="someUserId" class="someStatus">Some Username</li>
    <li id="someOtherUserId" class="someOtherStatus">Some Username</li>
</ul> 
```

This allows you to easily select a lot of info about your users:

```
$('#users > li') // all user elements
$('.someStatus') // all users of a particular status 
```

Then in your event handlers it's also easy to get the current status:

```
$(this).attr('class') //get current status once you have a user element selected. 
```

Another alternative is to dump javascript to the page and simply have it use the jquery `data` functionality to store the data as soon as the page loads. You'd still need an id on the element in order to find the right one though.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-01T11:46:15.247

有多种方法可以做到这一点，具体取决于您存储的数据类型以及您通常在页面中存储的信息量。最好设计一个一致的方案，这样您就可以编写一个简单的库调用来完成这项工作。例如，

您可以将数据存储在特定元素的类中。这可能需要额外的包装元素，以便能够提供额外的类来驱动您的 CSS。这也限制了可存储的内容格式。用户 ID 很可能适合类属性。

您可以将数据存储在 Javascript 激活链接的未使用的 href 中。这具有将状态栏中的数据显示为翻转时 URL 的一部分的附加功能。例如，您可以在 href 中存储“#userid”甚至只是“userid”。

您可以将数据存储在其他元素中。例如，您可以有一个嵌套的 div，其中包含一个指示存储的类，这也会触发 CSS 将元素从显示中取出。这是您可以在页面中安排的最普遍和最广泛的支持。

除了嵌套的 div，您还可以使用 type="hidden" 的嵌套输入标签。这是一种更加预期/传统的方式，并且不需要 CSS 将它们从显示中取出。您可以使用 id 属性来识别这些输入，也可以使用页面上的位置。例如，将它们放在用户单击的链接中，然后在 onclick 处理程序中搜索当前链接。

# javascript - 是否有任何 Javascript 功能可让您检查元素是否已关闭？

> ID：934467
> 
> 赞同：1
> 
> 时间：2009-06-01T11:37:08.773
> 
> 标签：javascript, html

JS 中是否有任何参数/函数可以告诉您元素是否以结束标记关闭？...[为此目的](https://stackoverflow.com/questions/932075/detect-if-iframes-document-is-malformed)。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T11:40:50.263

JS 只是提供对页面 DOM 的访问的脚本语言。DOM 是在您访问它之前从页面源中预先解析的。任何访问页面源的尝试都将返回由浏览器在初始解析阶段确定的预先更正的源。

所以一句话，没有。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T13:37:35.317

```
function getSource() {
    var xhr = window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest();
    xhr.open('GET', window.location.href, false);
    xhr.send(null);
    return xhr.responseText;
} 
```

采用这种方法，您必须自己解析 HTML - 这是一项艰巨的任务。

# java - 如何从 Java 中的用户输入中过滤掉所有非单词字符

> ID：934474
> 
> 赞同：-1
> 
> 时间：2009-06-01T11:40:14.400
> 
> 标签：java, input, validation

我试图从用户名输入中过滤掉 XSS 的所有可能性，同时仍然允许输入外来名称。

将多种语言（包括中文、日文和俄文）的所有单词字符列入白名单的最佳方法是什么？

这可能吗？用“”为 XSS 创建黑名单很容易，`<>&gt;&lt;`但黑客可以解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T12:02:04.293

我认为您可能是从错误的方向解决问题。

通常，防止 XSS 漏洞是确保您在网站上显示的任何用户生成的内容都被正确转义。

这样，您可以确保显示的内容正是用户输入的内容，而不会冒着白名单无意中让一些不良案例通过的风险。

# c# - 如何调整“是一种类型但像变量一样使用”？

> ID：934479
> 
> 赞同：13
> 
> 时间：2009-06-01T11:41:50.200
> 
> 标签：c#, .net, asp.net, generics

我正在尝试在 Web 服务中生成一些代码。但它返回 2 个错误：

1) List 是一种类型，但用作变量

2) 方法“客户”没有重载需要“3 个参数”

```
[WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [ToolboxItem(false)]
    public class wstest : System.Web.Services.WebService
    {

        [WebMethod]
        public List<Customer> GetList()
        {
            List<Customer> li = List<Customer>();
            li.Add(new Customer("yusuf", "karatoprak", "123456"));
            return li;
        }
    }

    public class Customer
    {
        private string name;
        private string surname;
        private string number;

        public string Name { get { return name; } set { name = value; } }
        public string SurName { get { return surname; } set { surname = value; } }
        public string Number { get { return number; } set { number = value; } }
    } 
```

我该如何调整上述错误？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-01T11:43:51.817

问题出在一线

```
List<Customer> li = List<Customer>(); 
```

你需要添加“新”

```
List<Customer> li = new List<Customer>(); 
```

此外，下一行应该是：

```
li.Add(new Customer{Name="yusuf", SurName="karatoprak", Number="123456"}); 
```

**编辑：**如果您使用的是 VS2005，那么您必须创建一个采用 3 个参数的新构造函数。

```
public Customer(string name, string surname, string number)
{
     this.name = name;
     this.surname = surname;
     this.number = number;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T11:44:43.237

这

```
List<Customer> li = List<Customer>(); 
```

需要是：

```
List<Customer> li = new List<Customer>(); 
```

并且您需要创建一个 Customer 构造函数，该构造函数接受您要传递的 3 个参数。默认的 Customer 构造函数不接受任何参数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T11:45:20.880

回答你的第二个问题：

您要么需要创建一个接受三个参数的构造函数：

```
public Customer(string a_name, string a_surname, string a_number)
{
     Name = a_name;
     SurName = a_surname;
     Number = a_number;
} 
```

或在创建对象后设置值：

```
Customer customer = new Customer();
customer.Name = "yusuf";
customer.SurName = "karatoprak";
customer.Number = "123456";
li.Add(customer); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T11:58:54.893

由于`Customer`类中的所有属性都有公共设置器，因此您不必绝对*创建*构造函数（正如大多数人所建议的那样）。您还可以选择使用默认的无参数构造函数并设置对象的属性：

```
Customer c = new Customer();
c.Name = "yusuf";
c.SurName = "karatoprak";
c.Number = "123456";
li.Add(c); 
```

# c# - 如何从 XDocument 中获取 NameTable？

> ID：934486
> 
> 赞同：45
> 
> 时间：2009-06-01T11:43:32.240
> 
> 标签：c#, xml, xpath, linq-to-xml

如何从 XDocument 中获取 NameTable？

它似乎没有 XmlDocument 具有的 NameTable 属性。

编辑：从缺乏答案来看，我猜我可能错过了重点。

我正在对这样的 XDocument 进行 XPath 查询...

```
document.XPathSelectElements("//xx:Name", namespaceManager); 
```

它工作正常，但我必须手动将我想要使用的命名空间添加到 XmlNamespaceManager，而不是像使用 XmlDocument 那样从 XDocument 中检索现有的名称表。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-06-01T13:01:58.307

您需要通过 XmlReader 推送 XML 并使用 XmlReader 的 NameTable 属性。

如果您已经将 Xml 加载到 XDocument 中，请确保使用 XmlReader 加载 XDocument：-

```
XmlReader reader = new XmlTextReader(someStream);
XDocument doc = XDocument.Load(reader);
XmlNameTable table = reader.NameTable; 
```

如果您使用 XDocument 从头开始​​构建 Xml，则需要调用 XDocument 的 CreateReader 方法，然后让阅读器消耗一些东西。一旦使用了阅读器（比如加载另一个 XDocument，但最好是一些什么都不做的接收器，这只会导致阅读器遍历 XDocument 的内容），您可以检索 NameTable。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2010-10-20T12:36:17.240

我是这样做的：

```
//Get the data into the XDoc
XDocument doc = XDocument.Parse(data);
//Grab the reader
var reader = doc.CreateReader();
//Set the root
var root = doc.Root;
//Use the reader NameTable
var namespaceManager = new XmlNamespaceManager(reader.NameTable);
//Add the GeoRSS NS
namespaceManager.AddNamespace("georss", "http://www.georss.org/georss");  
//Do something with it
Debug.WriteLine(root.XPathSelectElement("//georss:point", namespaceManager).Value); 
```

马特

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-11-01T09:29:41.407

> 我必须手动将要使用的命名空间添加到 XmlNamespaceManager，而不是像使用 XmlDocument 那样从 XDocument 中检索现有的名称表。

```
XDocument project = XDocument.Load(path);
//Or: XDocument project = XDocument.Parse(xml);
var nsMgr = new XmlNamespaceManager(new NameTable());
//Or: var nsMgr = new XmlNamespaceManager(doc.CreateReader().NameTable);
nsMgr.AddNamespace("msproj", "http://schemas.microsoft.com/developer/msbuild/2003");
var itemGroups = project.XPathSelectElements(@"msproj:Project/msproj:ItemGroup", nsMgr).ToList(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-01-19T11:03:47.667

它也可以由 XPathNavigator 完成。当您既不知道 Xml 文件编码也不知道名称空间前缀时，它可能很有用。

```
XDocument xdoc = XDocument.Load(sourceFileName);
XPathNavigator navi = xdoc.Root.CreateNavigator();
XmlNamespaceManager xmlNSM = new XmlNamespaceManager(navi.NameTable);
//Get all the namespaces from navigator
IDictionary<string, string> dict = navi.GetNamespacesInScope(XmlNamespaceScope.All);
//Copy them into Manager
foreach (KeyValuePair<string, string> pair in dict)
{
    xmlNSM.AddNamespace(pair.Key, pair.Value);
} 
```

# javascript - Javascript - 写入新标签的链接

> ID：934487
> 
> 赞同：0
> 
> 时间：2009-06-01T11:43:42.707
> 
> 标签：javascript, firefox-addon, hyperlink

在 Firefox 扩展中使用 Javascript，我打开了一个新选项卡。我不知道如何在此选项卡中编写指向 www.google.com 的链接和其他链接（整个列表），用户可以在其中单击链接并打开此页面。

谢谢您的帮助

到目前为止，我输入了：

```
var newTabBrowser2 = gBrowser.getBrowserForTab(gBrowser.selectedTab = gBrowser.addTab()); 
```

不幸的是，这不起作用：

```
var newTabBrowser2 = gBrowser.getBrowserForTab(gBrowser.selectedTab = gBrowser.addTab());
newdocument=newTabBrowser2.contentDocument.documentElement.textContent;
newdocument.write("<a href=\"http://www.google.com\">google</a><br>");
newdocument.write("<a href=\"http://www.yahoo.com\">yahoo</a><br>"); 
```

我试过这个：

```
var newTabBrowser2 = gBrowser.getBrowserForTab(gBrowser.selectedTab = gBrowser.addTab());
newTabBrowser2.contentDocument.documentElement.innerHTML += "<a 
```

href=\" [http://www.google.com](http://www.google.com) \">谷歌
";

但这仅在我使用调试器时才有效

知道为什么吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T12:41:33.840

I don't believe you can use textContent to add HTML content to a document - you're possibly better off using the DOM to construct the HTML.

How about something like this (untested):

```
var newTabBrowser2 = gBrowser.getBrowserForTab(gBrowser.selectedTab = gBrowser.addTab());
newdocument=newTabBrowser2.contentDocument.documentElement;

var link=newdocument.createElement("a");
link.setAttribute("href", "http://www.google.com");
link.textContent="google";
newdocument.appendChild(link);

newdocument.appendChild(newdocument.createElement("br"));

link=newdocument.createElement("a");
link.setAttribute("href", "http://www.yahoo.com");
link.textContent="yahoo";
newdocument.appendChild(link);

newdocument.appendChild(newdocument.createElement("br")); 
```

Alternatively, it *may* be possible to just write to the innerHtml of the document element.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T12:11:37.457

你的问题不是很清楚你想要什么。也许是这样的：

```
newwindow=window.open();
newdocument=newwindow.document;
newdocument.write("<a href=\"http://www.google.com\">google</a><br>");
newdocument.write("<a href=\"http://www.yahoo.com\">yahoo</a><br>");
newdocument.close(); 
```

？？？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T11:51:33.567

这看起来像你正在寻找的东西。

[http://mesh.typepad.com/blog/2004/11/creating_a_new_.html](http://mesh.typepad.com/blog/2004/11/creating_a_new_.html)

```
var myUrl = "http://mesh.typepad.com";
var tBrowser = document.getElementById("content");
var tab = tBrowser.addTab(myUrl); 
```

这会在每次运行时创建一个新选项卡 - 您可以像这样更新预先存在的选项卡的 url：

```
var uri = "http://mesh.typepad.com";
tBrowser.getBrowserForTab(tab).loadURI(uri); 
```

最后，您应该能够将焦点设置到新选项卡：

```
tBrowser.selectedTab = tab; 
```

# asp.net - 组合框列gridview

> ID：934495
> 
> 赞同：0
> 
> 时间：2009-06-01T11:44:43.767
> 
> 标签：asp.net, gridview

我需要询问我有带有组合框模板列的 gridview 及其填充项目。when select index changed i need to set description value in onther cell but I couldn't get the index of the gridview row? 任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T12:11:23.620

有点不清楚您在谈论哪个 SelectedIndexChanges，但我假设您考虑的是 SelectedIndexChanged 组合框。

假设您已经在组合框上连接了事件处理程序，您可以使用以下代码获取处理程序内的 RowIndex

```
protected void cmb_SelectedIndexChanged(object sender, EventArgs e)
{
   int idx = (((sender as System.Web.UI.WebControls.DropDownList).Parent.Parent as GridViewRow)).RowIndex;
} 
```

下拉列表的父级将是 DataControlField，如果它是 GridRow，则父级。

这还假设您的模板字段中没有其他容器控件，因为 parent.parent 结构可能会有所不同。

# c# - 如何在 C#（托管代码）中获取 *THREAD* 的 CPU 使用率和/或 RAM 使用率？

> ID：934497
> 
> 赞同：13
> 
> 时间：2009-06-01T11:45:15.217
> 
> 标签：c#, performance, multithreading, memory-management, cpu-usage

我知道如何获取进程的 CPU 使用率和内存使用率，但我想知道如何在每个线程级别上获取它。如果最好的解决方案是做一些 P-Invoking，那也没关系。

我需要的示例：

```
Thread myThread = Thread.CurrentThread;

// some time later in some other function...

Console.WriteLine(GetThreadSpecificCpuUsage(myThread)); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-01T12:34:34.117

如前所述，内存使用无法回答，因为这是整个进程的属性，但 CPU 使用：

```
Process p = Process.GetCurrentProcess(); // getting current running process of the app
foreach (ProcessThread pt in p.Threads)
{
    // use pt.Id / pt.TotalProcessorTime / pt.UserProcessorTime / pt.PrivilegedProcessorTime
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-01T12:19:21.183

您无法获取每个线程的内存使用情况，因为内存在进程中的所有线程之间共享。操作系统如何知道您是否在一个线程中分配内存并在另一个线程中使用它。这意味着什么？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T12:07:11.023

这是一个执行您想要的操作的示例 [http://www.codeproject.com/KB/system/processescpuusage.aspx](http://www.codeproject.com/KB/system/processescpuusage.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-01-10T20:56:19.337

这是一个简单的程序，它启动 5 个消耗不同 CPU 量的线程，然后匹配哪个托管线程消耗多少 CPU。

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Threading;

class Program
{
[DllImport("Kernel32", EntryPoint = "GetCurrentThreadId", ExactSpelling = true)]
public static extern Int32 GetCurrentWin32ThreadId();

static void Main(string[] args)
{
    Dictionary<int, Thread> threads = new Dictionary<int, Thread>();

    // Launch the threads
    for (int i = 0; i < 5; i++)
    {
        Thread cpuThread = new Thread((start) =>
        {
            lock (threads)
            {
                threads.Add(GetCurrentWin32ThreadId(), Thread.CurrentThread);
            }

            ConsumeCPU(20 * (int)start);
        });
        cpuThread.Name = "T" + i;
        cpuThread.Start(i);
    }

    // Every second wake up and see how much CPU each thread is using.
    Thread monitoringThread = new Thread(() =>
        {
            Stopwatch watch = new Stopwatch();
            watch.Start();

            while (true)
            {
                Thread.Sleep(1000);
                Console.Write("\r");

                double totalTime = ((double)watch.ElapsedMilliseconds);
                if (totalTime > 0)
                {
                    Process p = Process.GetCurrentProcess();
                    foreach (ProcessThread pt in p.Threads)
                    {
                        Thread managedThread;
                        if (threads.TryGetValue(pt.Id, out managedThread))
                        {
                            double percent = (pt.TotalProcessorTime.TotalMilliseconds / totalTime);
                            Console.Write("{0}-{1:0.00} ", managedThread.Name, percent);
                        }
                    }
                }
            }
        });
    monitoringThread.Start();
}

// Helper function that generates a percentage of CPU usage
public static void ConsumeCPU(int percentage)
{
    Stopwatch watch = new Stopwatch();
    watch.Start();
    while (true)
    {
        if (watch.ElapsedMilliseconds > percentage)
        {
            Thread.Sleep(100 - percentage);
            watch.Reset();
            watch.Start();
        }
    }
}
} 
```

请注意，CLR 可能会更改托管线程在其下执行的本机线程。但是，在实践中，我不确定这种情况实际发生的频率。

# windows - 自定义 Windows GINA 身份验证

> ID：934505
> 
> 赞同：5
> 
> 时间：2009-06-01T11:47:47.490
> 
> 标签：windows, authentication, gina

在 Windows 中，可以扩展 GINA 模块以支持不同的身份验证方式。例如，您已经可以看到对指纹、智能卡甚至人脸识别的支持（就像联想对他们的笔记本电脑所做的那样）。我想要达到的目标并不像那些方法那么复杂。我想要的只是能够提供我的自定义身份验证服务（即我自己的登录身份验证方法）。另外，我想知道是否有办法扩展默认身份验证方法（密码），以便在将密码发送到 Windows 本地身份验证服务之前有一个密码预处理阶段。

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T12:16:15.560

这篇 MSDN 杂志文章或许能够回答您的问题：

[自定义 GINA，第 1 部分](http://msdn.microsoft.com/en-us/magazine/cc163803.aspx)

[自定义 GINA，第 2 部分](http://msdn.microsoft.com/en-us/magazine/cc163786.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-02T05:59:15.447

我知道问题已得到解答，但我不禁注意到，没有提及证书提供者替换 GINA。这里有几个链接：

[使用 Windows Vista 的凭据提供程序创建自定义登录体验](http://msdn.microsoft.com/en-us/magazine/cc163489.aspx)

[MSDN 上的 ICredentialProvider 接口](http://msdn.microsoft.com/en-us/library/bb776042%28v=vs.85%29.aspx)

新方法不会像 GINA 那样工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T03:42:20.247

上述点的附加信息：

Windows Vista 和更高版本的 Microsoft 操作系统已将 Gina 替换为凭据提供程序。

塔

# java - Java 等价于 Python 中的函数映射

> ID：934509
> 
> 赞同：10
> 
> 时间：2009-06-01T11:48:37.970
> 
> 标签：java, python, function

在 python 中，如果我有一些我想根据输入调用的函数，我可以这样做：

```
lookup = {'function1':function1, 'function2':function2, 'function3':function3}
lookup[input]() 
```

那就是我有一个映射到函数的函数名字典，并通过字典查找调用该函数。

如何在java中做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-01T11:58:09.620

Java没有一流的方法，所以[命令模式](http://en.wikipedia.org/wiki/Command_pattern)是你的朋友......

免责声明：代码未经测试！

```
public interface Command 
{
    void invoke();
}

Map<String, Command> commands = new HashMap<String, Command>();
commands.put("function1", new Command() 
{
    public void invoke() { System.out.println("hello world"); }
});

commands.get("function1").invoke(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T13:35:27.757

有几种方法可以解决这个问题。其中大部分已经发布：

*   [命令](https://stackoverflow.com/questions/934509/java-equivalent-of-function-mapping-in-python/934532#934532)- 在映射中保留一堆具有 execute() 或 invoke() 方法的对象；按名称查找命令，然后调用该方法。
*   [多态性](https://stackoverflow.com/questions/934509/java-equivalent-of-function-mapping-in-python/934676#934676)- 比命令更普遍的是，您可以在任何相关的对象集上调用方法。
*   最后是反射 - 您可以使用反射来获取对 java.lang.Method 对象的引用。对于一组已知的类/方法，这工作得相当好，并且一旦加载 Method 对象就没有太多开销。例如，您可以使用它来允许用户在命令行中键入 java 代码，您可以实时执行这些代码。

我个人会使用命令方法。[命令与模板方法](http://en.wikipedia.org/wiki/Template_method_pattern)很好地结合在一起，允许您在所有命令对象上强制执行某些模式。例子：

```
public abstract class Command {
  public final Object execute(Map<String, Object> args) {
    // do permission checking here or transaction management
    Object retval = doExecute(args);
    // do logging, cleanup, caching, etc here
    return retval;
  }
  // subclasses override this to do the real work
  protected abstract Object doExecute(Map<String, Object> args);
} 
```

仅当您需要将这种映射用于您无法控制其设计的类并且为其创建命令不切实际时，我才会诉诸反射。例如，您不能通过为每个方法创建命令来在命令外壳中公开 Java API。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T11:52:36.653

您可以使用 Map<String,Method> 或 Map<String,Callable> 等，然后使用 map.get("function1").invoke(...)。但通常这些问题可以通过使用多态性而不是查找来更干净地解决。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T12:45:54.017

多态示例..

```
public interface Animal {public void speak();};
public class Dog implements Animal {public void speak(){System.out.println("treat? treat? treat?");}}
public class Cat implements Animal {public void speak(){System.out.println("leave me alone");}}
public class Hamster implements Animal {public void speak(){System.out.println("I run, run, run, but never get anywhere");}}

Map<String,Animal> animals = new HashMap<String,Animal>();
animals.put("dog",new Dog());
animals.put("cat",new Cat());
animals.put("hamster",new Hamster());
for(Animal animal : animals){animal.speak();} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T17:13:49.677

不幸的是，Java 没有一流的功能，但考虑以下接口：

```
public interface F<A, B> {
  public B f(A a);
} 
```

这为从 type`A`到 type的函数类型建模`B`，作为您可以传递的一等值。你想要的是一个`Map<String, F<A, B>>`.

[函数式 Java](http://code.google.com/p/functionaljava)是一个以一流函数为中心的相当完整的库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T14:30:33.073

如其他问题所述，`Map<String,MyCommandType>`带有匿名内部类的 a 是一种冗长的方法。

一种变体是使用枚举代替匿名内部类。枚举的每个常量都可以实现/覆盖枚举或实现的接口的方法，与匿名内部类技术非常相似，但没有那么混乱。我相信 Effective Java 2nd Ed 处理如何初始化枚举映射。从枚举名称映射只需要调用`MyEnumType.valueOf(name)`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T18:33:46.557

正如其他人所说，Java 不支持将函数作为第一级对象。为此，您使用 Functor，它是一个包装函数的类。史蒂夫耶格对此有一个[很好的咆哮](http://steve-yegge.blogspot.com/2006/03/execution-in-kingdom-of-nouns.html)。

为了帮助您解决这个限制，人们编写了函子库：[jga](http://jga.sourceforge.net/)，[Commons Functor](http://commons.apache.org/sandbox/functor/)

# java - Tomcat：会话计数。它是什么？

> ID：934527
> 
> 赞同：4
> 
> 时间：2009-06-01T11:54:47.147
> 
> 标签：java, session, tomcat

好的，我想我已经知道了，但我想确定一下，这个令人惊讶的简单问题很难用谷歌搜索。:P

在 tomcat 管理器中，我有一些会话统计信息，如下所示：

活动会话：1 会话计数：1 最大活动会话：1 拒绝会话创建：0 过期会话：0 最长会话活动时间：0 秒平均会话活动时间：0 秒处理时间：0 毫秒

**会话计数是否只是自服务器启动以来创建的会话数？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T12:13:27.563

**会话计数**是当前在线用户的数量。

用户离开站点后，会话可以在接下来的 x 分钟内保持活动状态，直到过期。

根据您的报告工具的功能，**活动会话**可能是在过去 5 分钟内注册用户活动的会话数。

编辑：**过期会话**可能是自服务器启动以来创建和过期的所有会话数

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-25T08:01:33.853

活动会话：当前活动的会话数（未过期）

会话计数：自服务器启动以来创建的会话总数。

过期会话：会话计数 - 活动会话

# c++ - 使用 GCC 的 C++ 内联函数 - 为什么是 CALL？

> ID：934529
> 
> 赞同：16
> 
> 时间：2009-06-01T11:56:14.740
> 
> 标签：c++, inline, tdm-mingw

我一直在测试 C++ 中的内联函数调用。

```
Thread model: win32
gcc version 4.3.3 (4.3.3-tdm-1 mingw32) 
```

C++ 编程语言中的 Stroustrup 写道：

> inline 说明符是对编译器的提示，它应该尝试生成代码 [...] 内联，而不是为函数放置一次代码，然后通过通常的函数调用机制进行调用。

但是，我发现生成的代码根本不是内联的。isquare函数有一个*CALL 指令***。**

[![替代文字](https://i.stack.imgur.com/LbyAx.jpg)](https://i.stack.imgur.com/LbyAx.jpg)

**为什么会这样？那我该如何使用内联函数呢？**

**编辑：**使用的命令行选项：

```
**** Build of configuration Debug for project InlineCpp ****

**** Internal Builder is used for build               ****
g++ -O0 -g3 -Wall -c -fmessage-length=0 -osrc\InlineCpp.o ..\src\InlineCpp.cpp
g++ -oInlineCpp.exe src\InlineCpp.o 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-06-01T12:06:39.417

就像 Michael Kohne 提到的那样， inline 关键字始终是一个提示，对于您的函数，GCC 决定不内联它。

由于您使用的是 Gcc，因此您可以使用 __attribute((always_inline)) 强制内联。

例子：

```
 /* Prototype.  */
 inline void foo (const char) __attribute__((always_inline)); 
```

资料来源：[GCC 内联文档](http://gcc.gnu.org/onlinedocs/gcc/Inline.html)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-06-01T12:00:05.653

没有通用的 C++ 方法可以强制编译器创建内联函数。请注意您引用的文本中的“提示”一词-编译器没有义务听您的话。

如果你真的，绝对必须做一些内联的东西，你需要一个编译器特定的关键字，或者你需要使用宏而不是函数。

编辑：njsf 在他的回复中给出了正确的 gcc 关键字。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-01T12:11:35.367

您是否正在查看调试版本（已禁用优化）？编译器通常在“调试”构建中禁用内联，因为它们使调试更加困难。

无论如何，`inline`指定的确实是一个*提示*。编译器不需要内联函数。任何编译器可能决定忽略内联提示的原因有很多：

*   编译器可能很简单，并且不支持内联
*   编译器可能会使用内部算法来决定内联的内容并忽略提示。
    *（有时，编译器在选择内联内容方面可能做得比您做得更好，尤其是在像 IA64 这样的复杂架构中）*
*   编译器可能会使用自己的启发式方法来决定尽管有提示，但内联不会提高性能

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-01T12:44:24.707

内联只不过是对编译器的一个建议，如果可以内联这个函数，那么编译器应该考虑这样做。有些函数会自动内联，因为它们非常简单，而您*建议*它内联的其他函数不会因为它们太复杂而不会内联。

另外，我注意到您正在进行调试构建。我实际上不知道，但编译器可能会禁用调试构建的内联，因为它使调试器变得困难......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-01T12:04:15.490

这是一个提示，编译器可以选择忽略该提示。我想我读到了一些 GCC 通常忽略它的地方。我记得听说有一个标志，但它在 100% 的情况下仍然不起作用。（我还没有找到链接）。

标志：-finline-functions 在 -O3 优化级别打开。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T12:03:00.280

是否内联取决于编译器。是否可以免费忽略*内联*提示。一些编译器有一个特定的关键字（如`__forceinline`在 VC++ 中），但即使有这样一个关键字，对虚拟成员函数的虚拟调用也不会被内联。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T12:50:39.467

我遇到了类似的问题，发现它只有在将内联函数写入头文件时才有效。

# c# - 从对象列表到具有两个属性的字典的优雅方式

> ID：934536
> 
> 赞同：39
> 
> 时间：2009-06-01T11:59:38.730
> 
> 标签：c#, arrays, visual-studio-2005, dictionary

我似乎一遍又一遍地编写这段代码，并想看看是否有更好的方法更通用。

我从 Foo 对象的列表开始

```
Foo[] foos = GenerateFoos(); 
```

我想创建一个字典，其中键和值都是 Foo 的属性

例如：

```
Dictionary<string, string> fooDict = new Dictionary<string, string>():
foreach (Foo foo in foos)
{
    fooDict[foo.Name] = foo.StreetAddress;
} 
```

无论如何都可以通用地编写此代码，因为它似乎是一个基本模板，其中有一个对象数组、一个键属性、一个值属性和一个字典。

有什么建议么？

**我正在使用 VS 2005 (C#, 2.0)**

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-06-01T12:00:57.010

使用 LINQ：

```
var fooDict = foos.ToDictionary(x=>x.Name,x=>x.StreetAddress); 
```

（是的，`fooDict`是`Dictionary<string, string>`）

* * *

编辑以显示 VS2005 中的痛苦：

```
Dictionary<string, string> fooDict =
    Program.ToDictionary<Foo, string, string>(foos,
        delegate(Foo foo) { return foo.Name; },
        delegate(Foo foo) { return foo.StreetAddress; }); 
```

你在哪里（在`Program`）：

```
public static Dictionary<TKey, TValue> ToDictionary<TSource, TKey, TValue>(
    IEnumerable<TSource> items,
    Converter<TSource, TKey> keySelector,
    Converter<TSource, TValue> valueSelector)
{
    Dictionary<TKey, TValue> result = new Dictionary<TKey, TValue>();
    foreach (TSource item in items)
    {
        result.Add(keySelector(item), valueSelector(item));
    }
    return result;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-01T12:02:02.997

如果您使用的是框架 3.5，则可以使用`ToDictionary`扩展：

```
Dictionary<string, string> fooDict = foos.ToDictionary(f => f.Name, f => f.StreetAddress); 
```

对于框架 2.0，代码非常简单。

您可以通过在创建字典时指定字典的容量来稍微提高性能，以便在填充它时不必进行任何重新分配：

```
Dictionary<string, string> fooDict = new Dictionary<string, string>(foos.Count): 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T12:13:01.633

没有 LINQ，不，没有内置的帮助程序。你可以写一个：

```
// I forget if you need this delegate definition -- this may be already defined in .NET 2.0
public delegate R Func<T,R>(T obj);
public static Dictionary<K,V> BuildDictionary<T,K,V>(IEnumerable<T> objs, Func<T,K> kf, Func<T,V> vf)
{
    Dictionary<K,V> d = new Dictionary<K,V>();
    foreach (T obj in objs)
    {
        d[kf(obj)] = vf(obj);
    }
    return d;
}

Dictionary<string, string> fooDict = BuildDictionary(foos, new Func<Foo,string>(delegate(Foo foo) { return foo.Name; }), new Func<Foo,string>(delegate(Foo foo) { return foo.StreetAddress; })); 
```

它看起来不像基于 LINQ 的答案那么优雅，是不是……

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T12:15:37.743

这是一个与 .net 2.0 兼容的解决方案，它使用 System.Web.UI.Databinder 对属性名称进行反射 - 您会丢失编译时类型检查。

```
 public static Dictionary<string, string> ToDictionary<T>(List<T> list, string keyName, string valueName)
    {
        Dictionary<string, string> outputDictionary = new Dictionary<string, string>();
        foreach (T item in list)
        {
            string key = Eval<T, string>(item, keyName);
            string value = Eval<T, string>(item, valueName);
            output[key] = value;
        }

        return outputDictionary;
    }

    public static TOut Eval<TIn, TOut>(TIn source, string propertyName)
    {
        object o = DataBinder.GetPropertyValue(source, propertyName);
        if (o is TOut)
            return (TOut)o;

        return default(TOut);
    } 
```

你会调用如下：

```
Dictionary<string, string> fooDict = ToDictionary(foos, "Name", "StreetAddress"); 
```

# winapi - Windows 服务查询

> ID：934539
> 
> 赞同：1
> 
> 时间：2009-06-01T12:01:11.877
> 
> 标签：winapi, service

使用 MSDN 中描述的方法注册 Windows 服务 (ms-help://MS.VSCC.v80/MS.MSDN.v80/MS.WIN32COM.v10.en/dllproc/base/createservice.htm) 并使用类似的方法提供的示例的代码：

```
schService = CreateService( 
    schSCManager,              // SCManager database 
    TEXT("Sample_Srv"),        // name of service 
    lpszDisplayName,           // service name to display 
    SERVICE_ALL_ACCESS,        // desired access 
    SERVICE_WIN32_OWN_PROCESS, // service type 
    SERVICE_DEMAND_START,      // start type 
    SERVICE_ERROR_NORMAL,      // error control type 
    szPath,                    // path to service's binary 
    NULL,                      // no load ordering group 
    NULL,                      // no tag identifier 
    NULL,                      // no dependencies 
    NULL,                      // LocalSystem account 
    NULL);                     // no password 
```

我的问题是，虽然该服务已注册并且运行良好，但在 msconfig.msc 中，该服务在恢复选项中有“不采取任何行动”。有没有办法以编程方式更改它，以便在失败时重新启动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T12:07:28.463

查看[ChangeServiceConfig2](http://msdn.microsoft.com/en-us/library/ms681988(VS.85).aspx)以设置这些类型的服务选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T12:07:10.460

您可能可以使用该`sc`命令进行设置。

```
sc failure "servicename" reset= 0 actions= restart/30000//// 
```

这将告诉它在 0 天（从不）后重置失败计数器，并在第一次失败 30 秒后重新启动，而对第二次和以后的失败不采取任何措施。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T13:29:10.873

在 MSDN 中进行了进一步挖掘 - 它不是特别容易找到，但它似乎

**ChangeServiceConfig2** ( [http://msdn.microsoft.com/en-us/library/ms681988(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms681988(VS.85).aspx) )

```
BOOL WINAPI ChangeServiceConfig2(
  __in      SC_HANDLE hService,
  __in      DWORD dwInfoLevel,
  __in_opt  LPVOID lpInfo
); 
```

当参数 dwInfoLevel 为 SERVICE_CONFIG_FAILURE_ACTIONS (2) 时，lpInfo 参数是一个指向 SERVICE_FAILURE_ACTIONS 结构的指针。

SERVICE_FAILURE_ACTIONS 结构 [http://msdn.microsoft.com/en-us/library/ms685939(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms685939(VS.85).aspx)

您可以根据需要配置“可选”服务设置。

# apache-flex - 有没有办法在 Flex 上使用 OpenLayers？

> ID：934546
> 
> 赞同：0
> 
> 时间：2009-06-01T12:02:22.920
> 
> 标签：apache-flex, maps, openlayers

有没有办法在 Flex 上使用 OpenLayers？到目前为止，我已经找到了 Open-Scales 项目，但它正在开发中（功能不完整）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-12-15T10:43:23.033

我们最近发布了[OpenScales 1.1](http://openscales.org/)，与 1.0 beta 版本相比，它有很多改进和错误修复。以前的链接上有一个演示。

OpenScales API 的设计与 OpenLayers 非常接近。从一开始，代码库就进行了广泛的修改和改进。尽管如此，即使 OpenScales API 并不严格等同于 OpenLayers，如果您曾经在 OpenLayers 上进行过开发，您会发现 OpenScales API 非常容易理解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-10T01:41:42.740

OpenLayers 是一个纯 JavaScript 框架，我认为没有人为它编写过 Flex 包装器。所以简短的回答是“不”或“不容易”。

也就是说，根据您的需要，还有其他可用的 Flex 映射客户端。

*   [ArcGIS Server Flex API](http://resources.esri.com/arcgisserver/apis/flex/)
*   谷歌地图 API
*   雅虎！地图 API

我不使用 Flex，所以我没有资格谈论每个 API 的优点，但希望它可以帮助您入门。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-28T04:08:51.807

OpenScales 非常好，尤其是 1.2 版本。但是，这是一个很小的项目，并且支持不是很好，所以如果你遇到困难，你几乎只能靠自己。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-20T03:27:48.077

[OpenScales](http://openscales.org/)是 Openlayers 的 LGPL ActionScript3 端口。这可能是您正在寻找的。

# sharepoint - 如何让 Web 部件在 IE 中刷新？

> ID：934561
> 
> 赞同：0
> 
> 时间：2009-06-01T12:07:42.627
> 
> 标签：sharepoint, moss, wss

我有一个 SharePoint Web 部件，它从 .ASHX 页面获取 XML 数据，对其进行解析并使用 JavaScript 显示它。一切正常，直到 XML 更改。当我在 IE 中查看 Web 部件时，在我关闭浏览器之前不会更新新数据。即使执行 CTRL-F5 也不会获取新数据。

Firefox 会立即显示新数据，只需简单的页面刷新。

我在我的 .ASHX 页面的查询字符串中添加了一个时间戳，这样 XML 结果就不会被缓存，但这并没有解决我的 IE 问题。还有其他想法吗？

**编辑**
.ASHX 页面使用 API 访问列表并构建 XML 字符串，然后将其作为`application/XML`内容类型返回。我已确认 XML 已更新以反映列表中的新数据。当 Web 部件显示在 FireFox 中时，我还能够看到在 Web 部件中使用的数据。

**解决方案**
我实际上是在服务器代码中生成时间戳以附加到我的查询中，然后将该字符串放入 javascript 中。一旦我将时间戳代码移到 javascript 中，事情就开始变得更好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T15:01:14.010

它很可能被缓存了，没有其他合乎逻辑的解释为什么它可以在 Firefox 而不是 IE 中工作。尝试连续多次重新加载 IE。

检查 .ashx 页面设置的标题。

不仅仅是您的浏览器可以缓存页面，包括 Web 服务器在内的任何中间件都可能存在有缺陷的缓存实现。您也可以尝试使用 HTTP POST 而不是 GET，因为根据 HTTP 规范，不应缓存 POST 请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T13:11:02.360

它是自定义 Web 部件还是开箱即用的 Web 部件之一？如果您提供有关如何从 HttpHandler (ashx) 检索数据的更多信息，将会更容易为您提供帮助。

# sql - 列中的按月总计

> ID：934562
> 
> 赞同：0
> 
> 时间：2009-06-01T12:08:10.397
> 
> 标签：sql, sql-server, recursion, sum

我有一张表（消费）如下：

```
DocDate   ItemCode    Quantity
01.01.09  A           5
02.01.09  A           6 
```

等等..全年

我需要如下结果：

ItemCode Jan09Total Feb09Total Mar09Total

问题是应该对月份的数量进行汇总，这些数量应该在列中并根据给定的日期标准，例如从 1 月到 3 月 9 日或 2 月到 7 月 9 日等。

如何使用递归查询来实现这一点。

谢谢拉胡尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T12:27:50.903

Assuming you use a DB which supports PIVOT, you should use it. Here's example code for Oracle:

```
CREATE TABLE Consumption (
  DocDate  DATE,
  ItemCode VARCHAR2(10),
  Quantity NUMBER
);

INSERT INTO Consumption VALUES(to_date('2009-01-01', 'YYYY-MM-DD'), 'A', 5);
INSERT INTO Consumption VALUES(to_date('2009-02-01', 'YYYY-MM-DD'), 'A', 6);
INSERT INTO Consumption VALUES(to_date('2009-01-01', 'YYYY-MM-DD'), 'B', 5);

SELECT * FROM Consumption
PIVOT(
  sum(Quantity)
  FOR DocDate IN (
    to_date('2009-01-01', 'YYYY-MM-DD') AS Jan09Total,
    to_date('2009-02-01', 'YYYY-MM-DD') AS Feb09Total
  )
); 
```

As noted by Robin, if your columns vary, then you will have to dynamically generate such a query with the correct columns.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T12:12:41.137

好吧，它不是递归的，但这会让你得到你想要的：

```
SELECT
    DateName(month, DocDate) + ' ' + CAST(YEAR(DocDate) AS VARCHAR(10)) AS MonthYear,
    ItemCode,
    SUM(Quantity)
FROM
    Consumption
GROUP BY
    DateName(month, DocDate) + ' ' + CAST(YEAR(DocDate) AS VARCHAR(10)) AS MonthYear,
    ItemCode
ORDER BY
    1,2 
```

我认为递归只会阻碍这个查询的性能。你确定要这样做吗？或者这只是家庭作业？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T12:31:38.850

Here is a link to a wonderfully elegant way of implementing pivot logic on KNOWN x-axis values. Dynamic pivots are more difficult.

I didn't read this article fully, so if it isn't helpful then look up "The Rozenshtein Method"

[http://www.stephenforte.net/default.aspx?date=2003-08-07](http://www.stephenforte.net/default.aspx?date=2003-08-07)

I've used this in many queries with great results.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T12:14:27.140

您可以根据需要使用 PIVOT 将数据放入列中，但是，需要事先定义列列表。因此，您需要为您需要的列（基于您的日期范围）构建一些动态 SQL，然后运行它来生成您的 PIVOT。

# jquery - Jquery Validation Plugin - 你可以从选项中启用“eager”验证吗？

> ID：934575
> 
> 赞同：11
> 
> 时间：2009-06-01T12:12:46.410
> 
> 标签：jquery, jquery-validate

我在一个项目中使用 Jquery Validation 插件。

默认情况下，插件会在单击提交按钮时验证输入。该行为是“懒惰的”，以便对用户不显眼。如果发现错误，则验证将变为“急切”并在用户更正违规条目时验证输入。

有没有办法通过一个选项来覆盖最初的“懒惰”行为？我在文档中找不到任何解决方案。

例子：

如果您查看此[演示](http://jquery.bassistance.de/validate/demo/)，您会注意到用户可以在表单中导航，留下空文本框，当用户单击提交时，这些文本框将无法通过验证。如果用户最初在电子邮件文本框中输入了无效的电子邮件地址，则在单击提交按钮之前它不会突出显示。之后，在每次按键和模糊事件时验证输入。这就是我想从一开始就激活的。

我了解插件创建者的设计选择，但我需要不同的行为。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-01T18:18:16.880

感谢混乱对这个问题的指导：

要在 jquery 验证插件上启用即时验证，请将以下选项添加到 validate 函数：

```
 $('#myform').validate({
    onfocusout: function(element) {
        $(element).valid();
    }
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T12:23:58.943

实际上，我得到的默认行为是对`focusout`和`keyup`事件的验证，我在插件代码中将其视为默认行为。我必须禁用插件配置中的那些，以便仅在提交时获得验证。也许您应该发布一些代码......我认为情况并不完全清楚。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-21T03:20:14.760

我想在罗伯特的回答中补充一点，您可以在默认设置中通过使用来执行此操作，[`setDefaults()`](http://jqueryvalidation.org/jQuery.validator.setDefaults)因此它不依赖于利用 validate 方法的实际实例（通常不会通过不显眼的验证公开）。

只需[`onfocusout`](http://jqueryvalidation.org/validate#onfocusout)使用一个始终通过调用[`valid()`](http://jqueryvalidation.org/valid)方法评估模糊元素的函数来覆盖该属性：

```
// enable eager evaluation
$.validator.setDefaults({
    onfocusout: function (element) {
        $(element).valid();
    }
}) 
```

**带有急切评估的演示**：（
^(将在标签后显示为必需）)

```
// enable eager evaluation
$.validator.setDefaults({
  onfocusout: function (element) {
    $(element).valid();
  }
});

$("form").validate();
```

```
input.error {
  border-color: red
}
```

```
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.13.1/jquery.validate.js"></script>

<form >
  <input type="text" name="Name" required /><br/>
  <input type="text" name="Email" required /><br/>
  <input type="submit" value="Submit"/>
</form>
```

**普通演示**
^(（在提交之前不会显示）)

```
$("form").validate();
```

```
input.error {
  border-color: red
}
```

```
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.13.1/jquery.validate.js"></script>

<form >
  <input type="text" name="Name" required /><br/>
  <input type="text" name="Email" required /><br/>
  <input type="submit" value="Submit"/>
</form>
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-22T10:49:10.070

对我来说，添加 onfocusout 也不起作用。我试图通过 setDefaults 像 KyleMit 建议的那样通过 $('#myform').validate 添加它。

我最终使用的解决方案是为表单的不同字段添加一个额外的 keyup、blur 和 change 事件。我使用了一个类而不是一个 id 来保持逻辑的通用性。

```
$('body').on('keyup blur change', '.tovalidate input, .tovalidate select, .tovalidate textarea', function () { 
        $('.tovalidate').validate().checkForm(); 
}); 
```

# mysql - 我应该标准化我的数据库吗？

> ID：934577
> 
> 赞同：34
> 
> 时间：2009-06-01T12:13:19.230
> 
> 标签：mysql, database, optimization, rdbms, database-normalization

在为数据库（例如 MySQL）设计模式时，会出现是否完全规范化表的问题。

一方面连接（和外键约束等）非常慢，另一方面你会得到冗余数据和不一致的可能性。

“最后优化”是正确的方法吗？即创建一个按规范规范化的数据库，然后查看可以对哪些内容进行非规范化以实现最佳速度增益。

关于这种方法，我担心的是我会选择一个可能不够快的数据库设计——但在那个阶段重构模式（同时支持现有数据）将是非常痛苦的。这就是为什么我很想暂时忘记我学到的关于“正确”RDBMS 实践的一切，并尝试一次“平面表”方法。

该数据库将插入大量的事实是否会影响该决定？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-06-01T12:31:43.173

一个哲学答案：次优（关系）数据库充斥着插入、更新和删除异常。这些都导致数据不一致，导致数据质量不佳。如果你不能相信你的数据的准确性，那有什么好处呢？问问自己这个问题：你想要更慢地得到正确答案还是想要更快地得到错误答案？

作为一个实际问题：在快速获得它之前先把它做好。我们人类非常不擅长预测瓶颈会发生在哪里。让数据库变得更好，在相当长的一段时间内衡量性能，然后决定是否需要让它更快。在你去规范化和牺牲准确性之前尝试其他技术：你能获得更快的服务器、连接、数据库驱动程序等吗？存储过程会加快速度吗？索引及其填充因子如何？如果这些以及其他性能和调优技术不能解决问题，那么只有考虑非规范化。然后测量性能以验证您是否获得了“付费”的速度提升。确保您正在执行优化，而不是悲观化。

[编辑]

> Q：那么如果我最后优化的话，能否推荐一种合理的方式来在架构改变后迁移数据？例如，如果我决定摆脱查找表 - 我如何将现有的数据库迁移到这个新设计？

答：当然。

1.  做好备份。
2.  再次备份到不同的设备。
3.  使用“从旧表中选择新表...”类型命令创建新表。您需要进行一些连接来组合以前不同的表。
4.  删除旧表。
5.  重命名新表。

**但是**......考虑一个更强大的方法：

立即在完全规范化的表上创建一些视图。这些视图（虚拟表、数据上的“窗口”......问我是否想了解更多关于该主题的信息）将具有与上述第三步相同的定义查询。当您编写应用程序或 DB 层逻辑时，请使用视图（至少用于读取访问；可更新的视图......嗯，很有趣）。然后，如果您稍后进行非规范化，则如上所述创建一个新表，删除视图，重命名新的基表，无论视图是什么。您的应用程序/数据库层不会知道其中的区别。

在实践中实际上还有更多内容，但这应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-01T12:18:42.230

数据库的使用模式（插入重与报告重）肯定会影响您的规范化。此外，如果您发现规范化表显着放缓，您可能需要查看索引等。您使用的是哪个版本的 MySQL？

一般来说，插入繁重的数据库应该比报告繁重的数据库*更加规范化。*但是，YMMV 当然...

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-01T14:44:38.630

正常的设计是开始的地方；首先，把它做好，因为你可能不需要让它快。

对耗时连接的担忧通常是基于糟糕设计的经验。随着设计变得更加正常，设计中的表数通常会增加，而每个表中的列数和行数会减少，设计中的联合数会随着连接数的减少而增加，索引变得更有用等等。换句话说：好事发生。

规范化只是最终获得正常设计的一种方式......

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-01T12:40:35.930

您从哪里得到“连接（和外键约束等）非常慢”的想法？这是一个非常模糊的陈述，通常 IMO 没有性能问题。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-01T13:37:57.063

在操作系统上很少需要非规范化。我为其创建数据模型的一个系统有 560 个左右的表（当时它是澳大利亚最大的 J2EE 系统），并且只有 4 条非规范化数据。其中两个项目是非规范化搜索表，旨在促进复杂的搜索屏幕（一个是物化视图），另外两个是为了响应特定的性能要求而添加的。

不要使用非规范化数据过早地优化数据库。这是持续的数据完整性问题的秘诀。此外，始终使用数据库触发器来管理非规范化数据——不要依赖应用程序来做。

最后，如果您需要提高报告性能，请考虑构建数据集市或其他单独的非规范化报告结构。结合对大量数据计算的聚合的实时视图的要求的报告很少见，而且往往只出现在少数业务线中。可以做到这一点的系统往往构建起来非常繁琐，因此价格昂贵。

您几乎可以肯定只有少量真正需要最新数据的报告，而且它们几乎总是像待办事项列表或处理少量数据的异常报告这样的操作报告。其他任何东西都可以推送到数据集市，为此每晚刷新一次可能就足够了。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-01T12:20:01.013

> “最后优化”是正确的方法吗？即创建一个按规范规范化的数据库，然后查看可以对哪些内容进行非规范化以实现最佳速度增益。

我会说，是的。我不得不处理结构不良的数据库太多次，以至于在没有经过深思熟虑的情况下容忍“平面表”数据库。

实际上，插入通常在完全规范化的数据库上表现良好，所以如果插入很重，这不应该是一个因素。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-01T12:32:38.320

此问题的一般设计方法是首先将您的数据库完全规范化为第 3 范式，然后根据性能和易于访问进行适当的反规范化。这种方法往往是最安全的，因为您是根据设计做出具体决定，而不是默认情况下不进行规范化。

“酌情”是需要经验的棘手部分。规范化是一个可以教授的相当“死记硬背”的过程，知道在哪里进行非规范化不太精确，并且取决于应用程序的使用和业务规则，因此会因应用程序而异。您所有的非规范化决定都应该为专业人士辩护。

例如，如果我有一对多的关系，在大多数情况下，A 到 BI 会使其正常化，但如果我知道该业务只有每个 A 出现两次 B，这极不可能改变， B记录中的数据有限。他们通常会用 A 记录拉回 B 数据，我很可能会用两次出现的 B 字段来扩展 A 记录。当然，大多数合格的 DBA 会立即将其标记为可能的设计问题，因此您必须能够令人信服地证明您对非规范化的理由。

很明显，非规范化应该是个例外。在任何生产数据库中，我都希望其中的绝大多数——95% 以上——处于第三范式，只有少数非规范化结构。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-06-01T12:35:56.097

在插入繁重的数据库上，我肯定会从规范化表开始。如果您对查询有性能问题，我会首先尝试优化查询并添加有用的索引。

只有当这没有帮助时，您才应该尝试非规范化表。请务必在非规范化之前和之后对插入和查询进行基准测试，因为您可能会减慢插入速度。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-01T14:22:07.363

我不知道您对*按书*创建数据库是什么意思，因为我读过的大多数关于数据库的书籍都包含一个关于优化的主题，这与非规范化数据库设计相同。

这是一种平衡行为，所以不要过早优化。原因是非规范化的数据库设计往往变得难以使用。您将需要一些指标，因此对数据库进行一些压力测试，以确定您是否要进行非规范化。

因此，为了可维护性进行规范化，但为了优化而去规范化。

# sql - 在 SQL 中创建十六进制数

> ID：934579
> 
> 赞同：2
> 
> 时间：2009-06-01T12:13:30.603
> 
> 标签：sql, sql-server, database, unique-key

我想在 SQL 中生成唯一的十六进制数字。我怎样才能做到这一点？

如果您知道如何在 c# 中生成，请也包括在内。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T12:16:42.017

在 SQL Server 中：newid()

在 C# 中：System.Guid.NewGuid()

这些为您提供[GUID](http://en.wikipedia.org/wiki/Guid)，它们是唯一的十六进制数字；但是，它们的中间往往有破折号 (-)，因此您可能需要进行一些字符串解析才能获得所需的内容。但是，除此之外，这应该对您有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T12:34:53.867

**SQL 服务器**：

```
SELECT  NEWID() 
```

**甲骨文**：

```
SELECT  SYS_GUID()
FROM    dual 
```

**MySQL**：

```
SELECT  UUID() 
```

在**PostgreSQL**中，您必须使用外部函数，尽管它有`UUID`类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T12:18:15.320

您可以使用整数 IDENTITY 列，然后将其转换为十六进制使用

```
CONVERT(varbinary(8), MyTable.MyId) 
```

# c# - 如何绑定列表 带有gridview的数据？

> ID：934580
> 
> 赞同：1
> 
> 时间：2009-06-01T12:13:44.067
> 
> 标签：c#, .net, asp.net, generics, data-binding

[请看我的网络服务代码返回类型列表](https://stackoverflow.com/questions/934479/how-to-adjust-is-a-type-but-is-used-like-a-variable)

我使用 listformat List 从 Web 服务获取数据；还在下面创建了一个gridview并将列表返回到gridview数据源。发生错误：

**在所选数据源上找不到名为“名称”的字段或属性。**

```
 <asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="false">
        <Columns>
        <asp:BoundField HeaderText="Ad" DataField="name" />
        <asp:BoundField HeaderText="SoyAd" DataField="surname" />
        <asp:BoundField HeaderText="Numara" DataField="number" />
        </Columns>
        </asp:GridView>
```

```
 wstest ws = new wstest();
            GridView1.DataSource = ws.GetList(); ;
            GridView1.DataBind();
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T12:18:02.170

检查您生成的列表的内容。如果您没有一个名为 name 的字段在您调用时获得输出，`GetList()`那么它将中断，因为 GridView 正在寻找它并且它不在那里绑定。

但是，您可能需要粘贴更多代码供我们验证。

**编辑**：根据您创建的类的链接，您似乎需要验证您的属性“名称”是否在所有区域中都使用了正确的大写字母。C# 区分大小写，因此这很可能是它被丢弃的原因。确保您的其他属性也是如此。

**编辑2**：还应该注意，混淆可能是因为您的私人成员都是小写的，而您的属性是大写的。您的 GridView 将绑定到公共属性，这就是为什么您要确保 Gridview 正在查看大写属性“Name”、“SurName”等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T12:17:41.500

这条线

```
<asp:BoundField HeaderText="Ad" DataField="name" /> 
```

是说从列表中的每个项目中获取一个属性值，并将其绑定到网格中的该列。列表中的项目似乎没有属性“名称”

# python - 插入/删除性能

> ID：934602
> 
> 赞同：1
> 
> 时间：2009-06-01T12:19:54.117
> 
> 标签：python, database, performance, database-design

```
DB Table: 
id       int(6)
message  char(5) 
```

我必须在数据库表中添加一条记录（消息）。如果出现重复消息（此消息已经存在，具有不同的 ID），我想删除（或以某种方式停用）这两条消息并获得它们的 ID 作为回复。

是否可以只使用一个查询来执行？任何性能提示？...

PS我使用PostgreSQL。

我担心的主要问题是在使用两个或多个查询执行此操作时需要使用锁......

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T18:00:45.333

如果您真的想担心锁定，请执行此操作。

1.  更新表 SET status='INACTIVE' WHERE id = 'key';

    如果成功，则存在重复。

    *   插入附加的非活动记录。用你的副本做任何你想做的事情。

    如果失败，则没有重复。

    *   插入新的活动记录。
2.  犯罪。

这会立即获取排他锁。替代品不是那么好。

*   从 INSERT 开始并检查重复项在您开始更新之前不会占用锁。目前尚不清楚这是否是一个问题。

*   从 SELECT 开始需要添加一个 LOCK TABLE 以确保选择保存找到的行以便可以更新它。如果没有找到行，插入将正常工作。

如果您有多个并发写入者并且两个写入者可能同时尝试访问，您可能无法容忍行级锁定。

考虑一下。

1.  进程 A 执行了 LOCK ROW 和 SELECT，但没有找到任何行。

2.  进程 B 执行 LOCK ROW 和 SELECT 但没有找到行。

3.  进程 A 执行 INSERT 和 COMMIT。

4.  进程 B 执行 INSERT 和 COMMIT。您现在有重复的活动记录。

多个并发插入/更新事务仅适用于表级锁定。是的，这是一个潜在的放缓。三个规则：（1）尽可能短的事务，（2）尽快释放锁，（3）通过重试处理死锁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T12:22:51.910

您可以编写一个包含这两个命令的过程，但使用插入触发器检查重复项（或夜间作业，如果它对时间不敏感）可能更有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T13:03:08.193

理解您的确切要求有点困难。让我用两种方式改写它：

1.  您希望表中的两个条目都具有相同的消息（具有不同的 ID），并且想知道 ID 以进行进一步处理（将它们标记为不活动等）。为此，您可以使用单独的查询编写一个过程。我认为您无法通过一个查询来实现这一目标。

2.  您不想要表中的任何一个条目（我从“我要删除”中得到这个）。为此，您只需检查消息是否已经存在，如果存在则删除该行，否则插入它。我不认为这也可以通过一个查询来实现。

如果在插入期间性能是一个约束，您可以在不进行任何检查的情况下插入，然后定期清理数据库。

# vim - VIM：全能，自动选择下拉框中的第一项

> ID：934613
> 
> 赞同：1
> 
> 时间：2009-06-01T12:26:20.813
> 
> 标签：vim

VIM 完成的标准是选择下拉框中的第一项（并使用向上和向下选择所需的条目）。我宁愿输入，直到正确的条目是唯一可用的。

这是通过以下方式完成的：

```
设置 completeopt=longest,menuone 

```

问题：现在我必须手动按下才能选择条目。

有一个模拟菜单打开时的映射：

```
inoremap pumvisible() ？''：
  \ '=pumvisible() ? "\向下>" : ""'

inoremap pumvisible() ？''：
  \ '=pumvisible() ? "\向下>" : ""'

```

vim.wikia.com/wiki/VimTip1386

但这对我不起作用。什么都不做。任何想法？

（vim 7.2，赢 xp）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T12:59:00.230

[Autocomplpop](http://www.vim.org/scripts/script.php?script_id=1879) plugin: the completion menu is always visible with the first element highlighted.

It's not exactly what you want, but you can type until only one item is visible in the list then simply press enter to insert it.

# python - 如何确定 numpy 数组是否包含整数？

> ID：934616
> 
> 赞同：44
> 
> 时间：2009-06-01T12:27:46.037
> 
> 标签：python, numpy

我知道有一个简单的解决方案，但目前似乎找不到。

给定一个 numpy 数组，我需要知道该数组是否包含整数。

检查 dtype 本身是不够的，因为有多个 int dtype（int8、int16、int32、int64 ...）。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-06-01T12:39:12.987

在[numpy 书中](http://templatelab.com/numpybook/)找到它！第 23 页：

> 层次结构中的其他类型定义了特定的类型类别。这些类别可用于测试 self.dtype.type 返回的对象是否属于特定类（使用 issubclass）。

```
issubclass(n.dtype('int8').type, n.integer)
>>> True
issubclass(n.dtype('int16').type, n.integer)
>>> True 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2011-08-29T22:34:52.533

检查整数类型不适用于整数浮点数，例如`4.`更好的解决方案是`np.equal(np.mod(x, 1), 0)`，如：

```
>>> import numpy as np
>>> def isinteger(x):
...     return np.equal(np.mod(x, 1), 0)
... 
>>> foo = np.array([0., 1.5, 1.])
>>> bar = np.array([-5,  1,  2,  3, -4, -2,  0,  1,  0,  0, -1,  1])
>>> isinteger(foo)
array([ True, False,  True], dtype=bool)
>>> isinteger(bar)
array([ True,  True,  True,  True,  True,  True,  True,  True,  True,
    True,  True,  True], dtype=bool)
>>> isinteger(1.5)
False
>>> isinteger(1.)
True
>>> isinteger(1)
True 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-07-22T22:52:30.763

这也有效：

```
 n.dtype('int8').kind == 'i' 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-03-24T15:12:23.373

Numpy 的 issubdtype() 函数可以如下使用：

```
import numpy as np

size=(3,3)
A = np.random.randint(0, 255, size)
B = np.random.random(size)

print 'Array A:\n',  A
print 'Integers:', np.issubdtype(A[0,0], int)
print 'Floats:', np.issubdtype(A[0,0], float)

print '\nArray B:\n',  B
print 'Integers:', np.issubdtype(B[0,0], int)
print 'Floats:', np.issubdtype(B[0,0], float) 
```

**结果：**

```
Array A:
[[  9 224  33]
 [210 117  83]
 [206 139  60]]
Integers: True
Floats: False

Array B:
[[ 0.54221849  0.96021118  0.72322367]
 [ 0.02207826  0.55162813  0.52167972]
 [ 0.74106348  0.72457807  0.9705301 ]]
Integers: False
Floats: True 
```

PS。请记住，数组的元素始终具有相同的数据类型。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-04-20T23:36:28.890

虽然[2009 年接受的答案](https://stackoverflow.com/a/934652/2898712)仍然有效，但从 2014 年 9 月发布的 Numpy v0.19 开始，有[一个新的增强解决方案：](https://docs.scipy.org/doc/numpy-1.9.0/release.html#compatibility-to-python-numbers-module)

> 现在，所有数字 numpy 类型都在 python numbers 模块中的类型层次结构中注册。

这允许`dtype`对照 Python 的[Numeric abstract base classes](https://docs.python.org/library/numbers.html)检查。

```
isinstance(np.dtype('int8'), numbers.Integral)
issubclass(np.dtype('int32').type, numbers.Integral) 
```

您可以针对`numbers.Complex`和`numbers.Real`进行测试`numbers.Integral`。

*PS*由于您不再需要访问`.type`，您现在可以将行缩短几个字符。;)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-31T01:31:19.603

如果您正在寻找确定 dtype 是否是完整的，那么您可以按照其他答案的建议查看类型层次结构。但是，如果您想检查可能包含整数的浮点数，您可以使用`(x % 1) == 0`，或者我最近为此目的编写的 ufunc：[https](https://github.com/madphysicist/is_integer_ufunc) ://github.com/madphysicist/is_integer_ufunc 。安装后，你可以运行它

```
from is_integer_ufunc import is_integer

is_integer(x) 
```

它同样适用于整数和浮点类型。返回值是一个掩码。对于整数类型，它始终为 True，而对于浮点数，它表示包含整数值的元素。

# c# - C# 多线程无符号增量

> ID：934619
> 
> 赞同：18
> 
> 时间：2009-06-01T12:29:31.540
> 
> 标签：c#, multithreading, unsigned, interlocked-increment

我想从多个线程中增加一个无符号整数。

我知道 Interlocked.Increment，但它不处理无符号整数。我可以使用 lock()，但出于性能原因，我宁愿不使用。

仅以正常方式递增它是线程安全的吗？偶尔的增量是否丢失也没关系，因为它仅用于统计。我不想要的是被破坏的价值。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-06-01T12:46:26.950

您说出于性能原因不想使用`lock`- 但您测试过吗？一个无争议的锁（这很可能是，从它的声音）是相当便宜的。

在线程方面（一般来说，尤其是线程方面），我通常会选择“显然正确”而不是“聪明且可能性能更好”。

对您的应用程序有无锁定进行基准测试，看看您是否能注意到差异。如果锁定会产生*重大影响*，那么可以肯定的是，使用狡猾的东西。否则，我只会坚持使用锁。

您*可能*想要做的一件事是`Interlocked.Increment`与 an 一起使用，`int`并在需要时将其转换为 a `uint`，如下所示：

```
using System;
using System.Reflection;
using System.Threading;

public class Test
{
    private static int count = int.MaxValue-1;

    public static uint IncrementCount()
    {
        int newValue = Interlocked.Increment(ref count);
        return unchecked((uint) newValue);
    }

    public static void Main()
    {
        Console.WriteLine(IncrementCount());
        Console.WriteLine(IncrementCount());
        Console.WriteLine(IncrementCount());
    }

} 
```

输出：

```
2147483647
2147483648
2147483649 
```

（换句话说，它包装没有问题。）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-01T12:32:30.567

如果您确实需要完整范围的无符号整数 (2^32 - 1) 而不是有符号整数 (2^31 -1)，则可以转换为 int64（存在`Interlocked.Increment`采用 int64 的重载），然后再转换回到一个无符号整数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-12-01T17:17:55.660

在[pre-kidney's answer 的](https://stackoverflow.com/a/52491870/5185376)基础上，您可以创建自己的助手类。由于增量将在二进制级别上以相同的方式工作，因此您可以在使用类递增之前将类型从无符号更改为有符号`Unsafe`：

```
using System.Runtime.CompilerServices;
using System.Threading;

public static class InterlockedEx
{
    /// <summary>
    /// unsigned equivalent of <see cref="Interlocked.Increment(ref Int32)"/>
    /// </summary>
    public static uint Increment(ref uint location)
    {
        int incrementedSigned = Interlocked.Increment(ref Unsafe.As<uint, int>(ref location));
        return Unsafe.As<int, uint>(ref incrementedSigned);
    }

    /// <summary>
    /// unsigned equivalent of <see cref="Interlocked.Increment(ref Int64)"/>
    /// </summary>
    public static ulong Increment(ref ulong location)
    {
        long incrementedSigned = Interlocked.Increment(ref Unsafe.As<ulong, long>(ref location));
        return Unsafe.As<long, ulong>(ref incrementedSigned);
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-02-04T12:21:42.710

从 .NET 5.0`Interlocked.Increment`开始，无符号和有符号`int32`以及`int64`.

[https://docs.microsoft.com/en-us/dotnet/api/system.threading.interlocked.increment?view=net-5.0](https://docs.microsoft.com/en-us/dotnet/api/system.threading.interlocked.increment?view=net-5.0)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-25T06:27:25.400

在使用带符号整数的二进制补码表示的系统上（根据维基百科，[“几乎全部” ），递增无符号整数与递增使用同一组位表示的有符号整数具有相同的效果。](https://en.wikipedia.org/wiki/Signed_number_representations#History)因此，可以在无符号整数上使用 InterlockedIncrement 而不牺牲任何东西。

例如，对于 3 位，我们有下表：

```
raw bits | unsigned integer | twos complement signed integer
------------------------------------------------------------
000      |                0 |                             0 
001      |                1 |                             1 
010      |                2 |                             2 
011      |                3 |                             3 
100      |                4 |                            -4 
101      |                5 |                            -3
110      |                6 |                            -2
111      |                7 |                            -1 
```

在这两种情况下，加一（并考虑溢出）相当于在表中向下移动一个条目。请注意，这不适用于补码算术，因为负数以相反的顺序排列。

* * *

## 回答 #6

> 赞同：-15
> 
> 时间：2009-06-01T12:31:27.493

您可以将 uint 声明为 volatile。

[http://msdn.microsoft.com/en-us/library/x13ttww7(VS.71).aspx](http://msdn.microsoft.com/en-us/library/x13ttww7%28VS.71%29.aspx)

# ms-access - 如何在文本框中显示 *foreign* 字段值？

> ID：934621
> 
> 赞同：1
> 
> 时间：2009-06-01T12:30:44.453
> 
> 标签：ms-access, foreign-keys

如何通过设计视图将文本框与不属于表单的“记录源”表的字段绑定？

示例：我有“Order.cust_id”（记录来源=Order），我想显示“Customers.name”。我相信这是微不足道的，但我没有使用 MS Access 的经验。我尝试使用文本框“控制源”属性，但没有运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T12:44:01.790

一种方法是将文本框转换为组合框。然后将行源设置为包括客户表中的 cust_Id 和 Customer.Name。SQL 语句示例

```
Select Cust_ID, Name From Customer 
Order By Name; 
```

通过将列数设置为 2 和列宽；第一列为零（即“0;6”），则外键将对用户隐藏，并显示客户名称。

请注意，此方法确实会强制您将列表限制设置为 true。

此外，您最终会得到一个可能不是您想要的下拉列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T13:36:20.763

您可以使用 DlookUp 作为文本框的控制源：

```
 =DlookUp("[Name]", "Customer", "ID=" & Cust_ID) 
```

语法：要查找的内容、表名、where 语句

Where 语句应遵循 Jet SQL 的规则，这意味着如果字段是文本或日期格式，则必须使用分隔符。

请注意，对于任何事情来说，Name 都是一个非常糟糕的名字。我建议您在事情变得更糟之前立即重命名该字段。

了解错误可能很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T12:36:12.803

您可以创建一个新视图（例如`OrdersAndCustomerNames`），选择要在表单中使用的所有列，然后不要将`Order`表用作记录源，而只需切换到`OrdersAndCustomerNames`. 您说您没有使用 MS Access 的经验，所以我猜您并没有构建任何庞大且过于复杂的东西，所以我会这样做。我很确定它可以做得更优雅，但现在就可以了。

# c - 当我说#include时，如何告诉预处理器搜索头文件的特定文件夹

> ID：934627
> 
> 赞同：2
> 
> 时间：2009-06-01T12:31:51.860
> 
> 标签：c, include, visual-studio-2005, c-preprocessor

我有大约 120 个头文件（.h 文件），在所有这些头文件中，每个都包含许多其他使用 .h 的头文件`#include <abcd/xyz.h>`，但是当我将 .h 文件保存在特定文件夹中时，预处理器正在生成 filenotfound 错误。

我将所有 .h 文件移动到调用第一个头文件的单个 .C 文件中。

一种方法是 make `#include <abcd/xyz.h>`as `#include "abcd/xyz"`，但我需要在所有有 include 语句的头文件中执行此操作，并且有数百个。

我不能在 Visualstudio 的头文件部分中包含其中的许多，因为一些头文件具有相同的名称，但它们位于不同的目录中。( `<abcd/xyz.h>`, `<efgh/xyz.h>`)。

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T12:35:12.730

您应该在项目选项（“常规”选项卡）的“C++”部分中的“附加包含目录”中添加路径。您可以使用环境变量以及“此文件夹”(.) 快捷方式和“上一个文件夹”(..) 快捷方式，使此设置不绑定到某个目录结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T15:34:26.203

> 而且我不能在 Visualstudio 的头文件部分中包含其中的许多，因为，一些头文件具有相同的名称，但它们位于不同的目录中。(,)

这是一个相当大的问题，除非包含那些非唯一命名的头文件的文件与头文件本身位于同一目录中。

如果不修改#include 指令本身（并添加相对路径作为一个示例），您无法保证编译器将在另一个头文件之前找到一个头文件。

**编辑**：看起来 Visual Studio 将允许您为项目中的每个源文件指定不同的附加包含目录（在解决方案资源管理器中单击源文件并修改 C/C++ 属性）。但我认为这比修改#include 指令本身更有效——取决于你有多少非唯一的头文件名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T12:39:36.493

在项目设置中（在 VS2005/2008 中的 C/C++ 下）有一个“附加包含目录”选项。您可以使用相对路径在此处添加包含头文件的文件夹。

您也可以在 IDE 级别的工具 -> 选项 -> 项目和解决方案 -> VC++ 目录 -> 包含文件中执行此操作。通常，此方法保留用于作为正式库的一部分包含的标头。第一个选项通常是首选，因为它是可移植的（您可以将项目文件发送给另一个开发人员，并且如果您使用相对/宏路径，他们可以按原样构建项目）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T13:39:25.640

你正在寻找的是 -I 标志，你给了目录......如果你有一个 Makefile，你应该将它添加到 CPP_FLAGS 类似的东西......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T13:56:05.513

您还可以将 INCLUDE 变量添加到环境变量中。

# python - 在 PyObjc 和 Cocoa 中实现 NSText 委托方法

> ID：934628
> 
> 赞同：3
> 
> 时间：2009-06-01T12:31:57.650
> 
> 标签：python, cocoa, pyobjc

在我正在构建的项目中，我希望在将一些文本粘贴到特定文本字段时调用一个方法。我似乎无法让它工作，但这是我尝试过的

我将一个自定义类（基于 NSObject）作为我的文本字段的委托，然后给它一个方法：textDidChange：

```
class textFieldDelegate(NSObject):
    def textDidChange_(self, notification):
        NSLog("textdidchange") 
```

然后我在接口生成器中实例化了这个类的一个对象，并将其设置为 NSTextField 的委托。然而，这似乎并没有做任何事情。[但是，当我从http://www.programmish.com/?p=30](http://www.programmish.com/?p=30)构建示例代码时，一切似乎都运行良好。如何实现此委托代码以使其真正起作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T18:24:44.640

这对您不起作用的原因是它`textDidChange_`不是委托方法。这是`NSTextField`发布更改通知的方法。如果您查看 文档`textDidChange`，您会看到它提到了委托方法的实际名称：

> 此方法导致接收者的委托接收 controlTextDidChange: 消息。有关文本委托方法的更多信息，请参阅 NSControl 类规范。

委托方法实际上被调用`controlTextDidChange_`并在`NSTextField`超类上声明`NSControl`。

将您的委托方法更改为：

```
def controlTextDidChange_(self, notification):
    NSLog("textdidchange") 
```

它应该适合你。

# c# - 当连续有多个空格时去掉多余的空格

> ID：934630
> 
> 赞同：3
> 
> 时间：2009-06-01T12:32:31.533
> 
> 标签：c#, regex

我追求的是一个正则表达式，当有两个或多个重复时，它会去掉空格，只留下一个空格。

例如这一行

```
The cow  jumped    over the moon 
```

在某些情况下，有多个空格分隔单词会变成

```
The cow jumped over the moon 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-01T12:37:33.957

```
string cleanedString = Regex.Replace(input, @"\s+", " "); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-01T12:35:01.030

试试这个正则表达式：

```
[ ]+ 
```

并用一个空格替换它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T12:35:32.727

我通常这样做的方法是用一个重复替换两个空格，直到找不到更多条目。这当然意味着多次传递和几轮替换，每轮分配和垃圾收集一个字符串，但我发现开销比解析和执行正则表达式要少得多。即使有 64 个空格，也只需要 7 次通过即可修复。此外，典型的字符串只有 2-5 个空格，因此运行速度更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T14:15:28.393

我一直用 sed 来做这件事。

```
$ echo "The cow  jumped    over the moon" | sed -e 's/[     ]\+/ /g'
The cow jumped over the moon 
```

在字符类方括号中，您有一个空格和一个制表符。我用“\”引用了“+”，如果您的正则表达式引擎将“+”表示“一个或多个”而不是字面的“+”，这可能不是必需的。

# c# - 是否有 LINQ 等价于 string.Join(string, string[])

> ID：934635
> 
> 赞同：19
> 
> 时间：2009-06-01T12:34:21.013
> 
> 标签：c#, .net, linq, linq-to-sql

有没有办法使用 LINQ 将对象集合转换为单个新对象？

我想在另一个 LINQ to SQL 表达式中使用它。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-06-01T12:52:25.953

你为什么不使用它[`string.Join`](http://msdn.microsoft.com/en-us/library/system.string.join.aspx)本身？

```
string.Join("<br/>", collection.Select(e => e.TextProp).ToArray()); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-01T13:04:12.187

您可以使用聚合方法...

```
var myResults = (from myString in MyStrings
                 select myString)
                .Aggregate(string.Empty, (results, nextString) 
                   => string.Format("{0}<br />{1}", results, nextString)); 
```

或者

```
var myResults = MyStrings.Aggregate(string.Empty, (results, nextString) 
                   => string.Format("{0}<br />{1}", results, nextString)); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-01T12:44:16.283

正常的方法是使用聚合运算符之一（`Aggregate`,`Sum`等`Average`），但这完全取决于类型和您想要做什么。你对什么类型感兴趣？

编辑：好的，所以你想连接字符串......我*认为*在 LINQ to SQL 本身中没有任何东西可以做到这一点。选项：

*   编写存储过程或 TVF 以在 SQL 中执行此操作
*   在 LINQ to SQL 中获取单个字符串并在客户端连接回来

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-04-17T13:40:34.470

如果您要连接大量值，则此处的大多数解决方案都相当低效。此外，它们并不是那么可读。如果你要经常做这种事情，那么构建你自己的扩展方法来做这件事是值得的。下面的实现允许您执行相当于`string.Join(", ", arrayOfStrings)`arrayOfStrings 可以是 的地方`IEnumerable<T>`，并且分隔符可以是任何对象。它允许您执行以下操作：

```
var names = new [] { "Fred", "Barney", "Wilma", "Betty" };
var list = names
    .Where(n => n.Contains("e"))
    .Join(", "); 
```

我喜欢这个的两点是：

1.  它在 LINQ 上下文中非常易读。
2.  它相当有效，因为它使用 StringBuilder 并且避免了两次评估枚举，这在数据库场景（L2S、L2E 或 L2Nh）中很重要。

```
public static string Join<TItem,TSep>( 
    this IEnumerable<TItem> enuml, 
    TSep                    separator) 
{ 
    if (null == enuml) return string.Empty; 

    var sb = new StringBuilder(); 

    using (var enumr = enuml.GetEnumerator()) 
    { 
        if (null != enumr && enumr.MoveNext()) 
        { 
            sb.Append(enumr.Current); 
            while (enumr.MoveNext()) 
            { 
                sb.Append(separator).Append(enumr.Current); 
            } 
        } 
    } 

    return sb.ToString(); 
} 
```

# asp.net-mvc - 为什么我的所有 ActionFilter 都不运行？

> ID：934647
> 
> 赞同：9
> 
> 时间：2009-06-01T12:36:48.513
> 
> 标签：asp.net-mvc, action-filter

我今天早些时候[问了一个](https://stackoverflow.com/questions/933798/how-do-i-access-the-modelstate-form-an-actionfilter)`ActionFilters`关于ASP.Net MVC 的问题。原来我的问题真的是我`ActionFilter`什至没有运行。除其他外，我阅读[了这篇文章](http://ittecture.wordpress.com/2009/04/25/tip-of-the-day-193-aspnet-mvc-custom-action-filters/)，但我找不到他做的任何我不做的事情。

这是我的代码：

```
// The ActionFilter itself
public class TestingIfItWorksAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        filterContext.Controller.TempData["filter"] = "it worked!";
        base.OnActionExecuting(filterContext);
    }
}

// The Controller Action with the filter applied
[TestingIfItWorks]
public ActionResult Test()
{
    var didit = TempData["filter"];
    return View();
} 
```

filter 方法中的断点在我调试时永远不会被命中，并且在呈现视图时会`TempData["filter"]`保存一个值。`null`

**为什么这不起作用？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-03-30T17:25:23.617

**如果它对使用 MVC 4/5 的任何人都有帮助：**

如果您获得`ActionFilterAttribute`或`IActionFilter`错误的命名空间，则 ActionFilters 不会运行：[https ://stackoverflow.com/a/13710468/188926](https://stackoverflow.com/a/13710468/188926)

用于`System.Web.Http.Filters`Web API，`System.Web.Mvc`用于标准 MVC 操作。

与问题一样，如果您弄错了 filter 属性，它将被简单地忽略（没有错误），这使得诊断变得困难。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-01T12:51:55.580

**根据您对另一个答案的评论**

通过单元测试进行测试时，不会调用过滤器。如果要调用过滤器，则需要模仿 ControllerActionInvoker。最好单独测试过滤器本身，然后使用反射来确保过滤器以正确的属性应用于您的操作。我更喜欢这种机制，而不是组合测试过滤器和操作。

**原来的**

当然你需要一个`override`你的方法，否则你实际上并没有替换基类上的方法。我原以为编译器会抱怨您需要 a`new`或`override`在它上面。如果您不包含`override`关键字，它的行为就像您使用了`new`. 由于框架将其作为 ActionFilterAttribute 调用，这意味着您的方法将永远不会被调用。

引用[MSDN](http://msdn.microsoft.com/en-us/library/6fawty39.aspx)：

> 如果派生类中的方法前面没有 new 或 override 关键字，编译器将发出警告，并且该方法的行为就像存在 new 关键字一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T12:59:47.000

除了 tvanofosson 所说的之外，您的操作方法实际上并没有向视图呈现任何内容。您的观点是否有`<%=TempData["Filter"].ToString()%>`声明或类似的内容？

# ssis - 尝试在集成服务上加载包时访问被拒绝错误

> ID：934656
> 
> 赞同：1
> 
> 时间：2009-06-01T12:40:24.153
> 
> 标签：ssis, login

当我尝试将导入的 ssis 项目上传到我们的服务器时出现错误。该服务器仅安装了集成和报告服务，因为实时 sql 服务器位于另一台服务器上。我很好地登录了集成服务，但是当我尝试右键单击 MSDB 文件夹以导入包时，我得到了这个问题末尾列出的错误。我已在安装了集成服务的服务器上将我的本地用户帐户添加为管理员，并将管理员组添加到组件服务中 MsDtsServer 的安全权限中。对此的任何帮助将不胜感激。

## 标题：Microsoft SQL Server 管理工作室

未能为此请求检索数据。(Microsoft.SqlServer.SmoEnum)

* * *

附加信息：

Login timeout expired 建立与服务器的连接时发生错误。连接到 SQL Server 2005 时，此故障可能是由于在默认设置下 SQL Server 不允许远程连接造成的。命名管道提供程序：无法打开与 SQL Server [2] 的连接。（微软 SQL 本地客户端）

* * *

纽扣：

## 好的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:09:23.730

我最近遇到了这个问题。这有点棘手。

这是来自 MSDN 的一个很好的链接，关于如何破解，错误，我的意思是修复它。

[配置集成服务服务](http://msdn.microsoft.com/en-us/library/ms137789(SQL.90).aspx)

> “要管理存储在数据库引擎的命名实例或远程实例或多个数据库引擎实例中的包，您必须修改配置文件。” - MSDN

感谢微软？？

更具体地说，您需要在服务器上编辑此文件：C:\Program Files\Microsoft SQL Server\90\DTS\Binn\MsDtsSrvr.ini.xml

改变：

```
<ServerName>.</ServerName> 
```

到

```
<ServerName>ServerName\InstanceName</ServerName> 
```

节省。并重新启动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T22:37:57.377

您的服务器是否设置为接受远程 sql 连接？也许检查服务器上的防火墙以检查是否允许所有 SSIS 端口通过，并检查 SQL 外围应用配置工具以确保所有服务都设置为允许远程连接。

# apache - 如何根据域有条件地向 Apache .htaccess 添加一行？

> ID：934657
> 
> 赞同：4
> 
> 时间：2009-06-01T12:40:32.077
> 
> 标签：apache, .htaccess

我的本地开发PC默认设置为使用PHP5，我的客户端主机（1and1.co.uk）默认设置为使用PHP4。

要在 1and1 帐户上启用 PHP5，您必须将以下行添加到您的 .htaccess 文件中：

```
AddType x-mapp-php5 .php 
```

如果我将此行添加到我的本地 .htaccess 文件中，它会破坏我的 PHP。

如何根据域（或其他一些参数？）有条件地添加此行，以便它仅由实时站点而不是我的开发站点执行？

我希望能够只上传（FTP）我的整个源代码树，而不必担心每次都必须记住编辑服务器上的 .htaccess。

例如

```
<IfDomain www.example.com>
    AddType x-mapp-php5 .php
</IfDomain>

... rest of .htaccess 
```

这可能吗？

我无权访问服务器配置文件，只有 .htaccess

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-27T21:07:23.107

对于其他看到这个并使用带有虚拟主机指令的本地服务器的人：花了我一段时间，网上找到的方法都没有奏效（可能是因为我的 MAMP apache 版本还不是 2.4 或其他什么），但这个确实有效。

忘记在 .htaccess 文件中添加“条件”行：您可以定义要在虚拟主机设置中使用的 .htaccess 文件！

所以只需创建一个文件 .htaccess_dev，并将这一行添加到本地 /dev 机器上的虚拟主机定义中：

```
AccessFileName .htaccess_dev 
```

所以它变成了这样：

```
<virtualhost>
ServerName www.example.local
DirectoryRoot /var/www/www.example.local
AccessFileName .htaccess_dev
</virtualhost> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T14:25:59.027

试试这个。我不知道它是否会起作用。文档中使用的术语表明它应该这样做，但由于没有人做过你想做的事情，所以它有点悬而未决。

```
<Location http://www.example.com/>
    AddType x-mapp-php5 .php
</Location> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T16:52:33.120

我知道您可以使用 VirtualHost 标签在 httpd.conf 中执行特定于服务器的命令。( [http://httpd.apache.org/docs/1.3/vhosts/ip-based.html](http://httpd.apache.org/docs/1.3/vhosts/ip-based.html) )

虽然我不能 100% 确定您可以在 .htaccess 文件中使用它，但我建议您尝试以下方法：

```
<VirtualHost www.example.com>
    AddType x-mapp-php5 .php
</VirtualHost> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T16:52:52.760

您可以使用 VirtualHost 指令来完成此操作。当我希望带有 mod_python 的 django 仅在子域中运行时，我也做了同样的事情

```
<VirtualHost *:80>
DocumentRoot /www/docs/path
ServerName www.example.com
....

AddType x-mapp-php5 .php
</VirtualHost> 
```

# python - Python3.0 - 标记化和取消标记化

> ID：934661
> 
> 赞同：2
> 
> 时间：2009-06-01T12:41:21.797
> 
> 标签：python, python-3.x, tokenize, lexical-analysis

我正在使用类似于以下简化脚本的内容来解析较大文件中的 python 片段：

```
import io
import tokenize

src = 'foo="bar"'
src = bytes(src.encode())
src = io.BytesIO(src)

src = list(tokenize.tokenize(src.readline))

for tok in src:
  print(tok)

src = tokenize.untokenize(src) 
```

尽管python2.x中的代码不一样，但它使用相同的习语并且工作得很好。然而，使用 python3.0 运行上面的代码片段，我得到了这个输出：

```
(57, 'utf-8', (0, 0), (0, 0), '')
(1, 'foo', (1, 0), (1, 3), 'foo="bar"')
(53, '=', (1, 3), (1, 4), 'foo="bar"')
(3, '"bar"', (1, 4), (1, 9), 'foo="bar"')
(0, '', (2, 0), (2, 0), '')

Traceback (most recent call last):
  File "q.py", line 13, in <module>
    src = tokenize.untokenize(src)
  File "/usr/local/lib/python3.0/tokenize.py", line 236, in untokenize
    out = ut.untokenize(iterable)
  File "/usr/local/lib/python3.0/tokenize.py", line 165, in untokenize
    self.add_whitespace(start)
  File "/usr/local/lib/python3.0/tokenize.py", line 151, in add_whitespace
    assert row <= self.prev_row
AssertionError 
```

我已经搜索了有关此错误及其原因的引用，但找不到任何内容。我做错了什么，我该如何纠正？

### [编辑]

在[partisann](https://stackoverflow.com/users/54982/partisann)观察到在源代码中添加换行符会导致错误消失之后，我开始弄乱我正在取消标记的列表。如果没有在换行符之前立即出现该标记，则该标记似乎`EOF`会导致错误，因此删除它可以消除该错误。以下脚本运行没有错误：

```
import io
import tokenize

src = 'foo="bar"'
src = bytes(src.encode())
src = io.BytesIO(src)

src = list(tokenize.tokenize(src.readline))

for tok in src:
  print(tok)

src = tokenize.untokenize(src[:-1]) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T12:49:16.163

```
src = 'foo="bar"\n'
```

你忘了换行符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T12:48:53.857

如果您将输入限制为`untokenize`令牌的前两项，它似乎可以工作。

```
import io
import tokenize

src = 'foo="bar"'
src = bytes(src.encode())
src = io.BytesIO(src)

src = list(tokenize.tokenize(src.readline))

for tok in src:
  print(tok)

src = [t[:2] for t in src]
src = tokenize.untokenize(src) 
```

# sharepoint - 希望在 InfoPath 表单中的字段更改后启动 SharePoint 警报

> ID：934664
> 
> 赞同：1
> 
> 时间：2009-06-01T12:42:57.813
> 
> 标签：sharepoint, infopath

早上好，

我的 SharePoint 网站上有一个表单库。在我的表单上，我有一个计算字符串字段，可以进行基本数学运算（field1 x 3）。我正在寻找某种方式让表单识别该字段已更改（保存时）并以某种方式引发 SharePoint 警报。

我完全不知道该怎么做，如果有人可以提供帮助，那就太棒了！谢谢！香农

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T12:56:07.523

有几种方法可以做到这一点。

如果您没有编程访问权限。

创建一个新列，如果需要，可以隐藏。在 SPD 中创建一个工作流以在进行更改时运行。在该工作流程中，将当前值与该新列进行比较，如果不同，则发送电子邮件并将当前值复制到该新列。

或者在 Infopath 中做同样的事情，如果你有编程权限，当打开表单时你存储当前值，当他们保存表单比较值并根据需要发送电子邮件或设置另一列发送电子邮件并有一个工作流程进行邮寄。

如果您对 Sharepoint 具有编程访问权限，则可以编写自己的处理程序来复制它，而无需更多控制。

# php - Future proof file storage

> ID：934680
> 
> 赞同：0
> 
> 时间：2009-06-01T12:47:19.927
> 
> 标签：php, upload, synchronization, filesystems

I accept file uploads from users. Each file has a pointer in the db which has info on the file location in the filesystem. Currently, I'm storing the files in the filesystem non categorically, and each file is currently just named a unique value. All categorisation and naming etc is done in the app using the db.

A factor that I'm concerned about is that of file synchronization issues. If I wanted to set up file system synchronization where, for example, the user's files are automatically updated by bridging with a pc app, would this system still work well? I have no idea how such a system would work so hopefully I can get some input.

Basically, is representing a file's name and location purely in the database optimal, especially if said file may be synchronized with a pc application?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T13:01:04.267

Yes, the way you are doing this is the best way to do it. You are using a file system to store files and a database to sore structured data.

One suggestion I would make is that you create a directory tree on the file system. You may one day run up against a maximum files per directory limitation of your file system. I have built systems that create a new sub directory for each day or week.

Make sure you have good backups of the database as well as the document repository.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T12:58:44.770

All you need to make such a system work is to make sure the API you use (or, more likely, create) can talk to the database and to the filesystem in a sensible way. Since this is what your site is already doing anyway, it shoudn't be hard to implement.

The mere fact that your files are given identifiers instead of plain-English names is mostly irrelevant with regard to remote synchronization.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T13:00:25.643

Store a file hash in the database rather than a path (i.e. [SHA1](http://en.wikipedia.org/wiki/SHA1)) and have a separate database connect the hash with the path. Write a small app that will synchronize the hash database so that when you move your files to a different location it'll be easy to build a new database with updated paths.

That way you can also have the system load the file from a different location depending of which hash database you use to locate the file so it offers some transparency if you need people to be able to access the same file from diverse locations (i.e. nfs or webdav).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T21:19:26.553

我们正是使用这种模型来存储文件，以及（无耻的插件）[SabreDAV](http://code.google.com/p/sabredav/)以使其在最终用户看来是一个普通的文件系统。

我认为这是一个非常好的模型，只要查找文件记录在案并且易于检索，就不会有问题。只需备份您的数据库 :)

我可以给出的另一个建议是，我们在文件 ID 上使用 md5() 来生成唯一的文件名。我们使用部分文件来生成目录结构，例如.. id 1 将产生：b026324c6904b2a9cb4b88d6d61c81d1，生成的文件名将变为：

b02/632/4c6/904b2a9cb4b88d6d61c81d1 原因是大多数稳定的文件系统在一个目录中有大量文件（或目录）后会变得非常慢。遍历几个子目录也快得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T13:32:36.450

无聊的答案™：

我认为这取决于你想做什么，一如既往:)

我的意思是采取您的常规网络托管公司。开发人员一直在将文件同步到 Web 服务器。Web 服务器将哈希生成的文件名存储在指向物理文件的数据库中是否有意义？不。然后你不能用你的 FTP 客户端登录并上传这样的文件，你必须编写一个自定义模块来让 Apache 工作等等。瞬间头痛。

Flickr 使用数据库有意义吗？是的，一点没错！（再说一次，您不能使用 FTP 客户端登录并管理您的照片——这可能是件好事！）

请记住，文件系统也是一个（非常简单的）数据库。它是一个带有许多有用的免费工具的数据库。

我的 2¢

```
/0 
```

# flash - Flash 10: How to stream data to a local file?

> ID：934687
> 
> 赞同：2
> 
> 时间：2009-06-01T12:50:36.550
> 
> 标签：flash, actionscript-3, flash-10

I need something like FileStream class in Adobe AIR, but needs to work in Flash Player. I know there is FileReference#save(), but it can only save the whole file at once, which does not work if the size of the data to be saved is larger than the available memory... Is it really not possible to stream data to a local file to avoid keeping the whole data in the memory? Or maybe it is possible to append data to a local file without first reading the whole file into memory?

I need this badly! Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T14:01:35.567

你运气不好。安全限制不允许这种情况发生在 AIR 应用程序的上下文之外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T16:01:25.220

如果您要访问服务器，则可以通过将数据传递给服务器来实现。

使用 FileReference.save() 并点击服务器上的某个 URL。然后，开始将要保存的数据流式传输到服务器，然后让服务器将其重定向到 Flash 客户端。您需要在服务器上编写一些自定义的处理方式，而且速度不会像在本地保存那样快，但这可能是您能够做到这一点的唯一方法。

# django - 我可以从 django 表单中挑选上传文件吗？我的意思是 InMemoryUploadedFile

> ID：934693
> 
> 赞同：2
> 
> 时间：2009-06-01T12:51:52.553
> 
> 标签：django, file, forms, file-upload, pickle

我有一个 django 表单，其中有一个接受用户简历的 FileField。稍后我会将简历转换为 html 文档。所以我想立即腌制原始文档并将其存储在一个 db 列中，然后将其解压缩并转换它。那可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T13:13:25.163

我认为您不需要对 FileField 实例进行酸洗。所有 FileField 存储都是保存文件的驱动器上的路径......从这个意义上说，文件已经存储以供以后使用，并且酸洗字段实例并不会真正为您带来太多好处。事实上，由于该字段实际上并不存储数据，因此酸洗它不会真正做任何事情:-) 请参阅[FileField 上的 django 文档](http://docs.djangoproject.com/en/dev/ref/models/fields/#filefield)。

保存带有 FileField 的模型时，它会将文件路径保存到简历。以后出现的任何进程都可以从驱动器加载简历，将其转换为 HTML，然后删除原始简历，或执行您喜欢的任何其他“清理”处理。

如果您需要将实际文件内容存储在数据库中，您将考虑为您的模型创建一个 Blob 字段... Blob 是特定于数据库的。这个[关于 SO](https://stackoverflow.com/questions/759288/how-do-you-put-a-file-in-a-fixture-in-django)的问题有一个简单的实现。但是请注意，许多人认为将二进制文件存储在数据库中是一个性能不佳的想法，实际上您应该小心以这种方式构建您的应用程序。这个 google [django-developers 论坛帖子](http://groups.google.com/group/django-developers/browse_thread/thread/266565a23b765ea2)有一些关于 Django 和 blob 的很好的讨论和示例代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T13:24:46.327

最好只存储文件，然后在要转换时再次打开它。将其腌制并存储在数据库中将对您的性能产​​生很大影响。特别是如果文件很大。

# vb.net - datagridview 默认不保存对 Access MDB 文件的更改？

> ID：934695
> 
> 赞同：0
> 
> 时间：2009-06-01T12:52:11.947
> 
> 标签：vb.net

当用户编辑 datagridview 时，它不会保存对 Access MDB 文件的更改？

这不工作..

TableAdapter.Update(DataGridView1.DataSource)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T12:57:17.503

您需要明确更新数据源。

确切的机制将取决于附加到视图的数据源（通过`.DataSource`属性）。

```
dataTable.AcceptChanges(); 
```

将更新内存中的`DataTable`对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T13:25:32.877

```
BindingSource.endedit()
adapter.update() 
```

做了一个把戏。

# ado.net - DBServerSyncProvider SelectClientIdCommand Sync Services Ado.Net

> ID：934699
> 
> 赞同：0
> 
> 时间：2009-06-01T12:53:12.927
> 
> 标签：ado.net, synchronization, service

I want to use the DBServerSyncProvider's SelectClientIdCommand but i don't wan't to add more tables to my data base, i want to specifically define the clients id (as a long), something like this:

```
long ClientIdentifier=540;

SqlCommand ClientIdComm = new SqlCommand();
ClientIdComm.CommandType = CommandType.Text;

ClientIdComm.CommandText = " declare @sync_originator_id bigint "+
                                    " set @sync_originator_id= " +ClientIdentifier +
                                    " select @sync_originator_id "; 

            serverSyncProvider.SelectClientIdCommand = ClientIdComm; 
```

this will throw "Failed to map client ID to originator ID. Make sure the command DbServerSyncProvider.SelectClientIdCommand is correct."
what am I doing wrong? tks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T13:34:00.410

好的，发现@Sync_originator_id 接受 Int，但不接受 BigInt，是否有传递 bigint 作为客户端标识符？

# java - 使用 java servlet 进行异步文件上传

> ID：934708
> 
> 赞同：1
> 
> 时间：2009-06-01T12:57:33.637
> 
> 标签：java, javascript, ajax, file-upload

这是我想做的，我想上传一个将由 servlet 处理的文件。我会使用 Apache Commons - File Upload 来处理要上传的文件。

我见过类似 gmail 的 AJAX 文件上传，其中会有一个隐藏的 iframe，稍后会用 javascript 填充以停止显示上传图像或显示上传成功的消息。但是，这使用 PHP，其中处理文件上传的 php 文件将在 iframe 中包含 javascript。

我的问题是，我将如何使用 servlet 在 Java 中做到这一点，而不诉诸 JSP 并在 PHP 上模仿上述实现。我什至不知道这是否可能，所以请指导我一个好的实现（除了公共文件上传之外没有外部库）。

注意：我知道有一些图书馆可以很容易地做到这一点，但我首先想知道这是怎么发生的，这是怎么可能的，并且弄脏我的手并学习这一点。

编辑：只是补充一下，我会使用 Apache-Commons FileUpload 的流 API

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T13:01:40.320

完全一样。

客户端向服务器发出 HTTP 请求（通过提交表单）。

服务器响应一些 HTML（链接或嵌入一些 JavaScript）。

从 PHP 切换到 Java 只是一个替代品。您不需要更改任何 JavaScript。[用户指南](http://commons.apache.org/fileupload/using.html)告诉您如何设置它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-15T13:04:49.297

[http://oreilly.com/pub/a/javascript/2002/02/08/iframe.html](http://oreilly.com/pub/a/javascript/2002/02/08/iframe.html)是上传文件的最佳方式。我使用隐藏的 iframe 完成了文件上传。请参考所附链接。

# apache - 是否可以在不支付任何费用的情况下使用 https（自己的服务器）？

> ID：934713
> 
> 赞同：6
> 
> 时间：2009-06-01T12:59:35.550
> 
> 标签：apache, ssl, https

我想使用 SSL (https) 来保护通信。是否可以在不购买某种证书的情况下做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-01T13:03:55.493

您可以使用自签名证书（google it），但您的用户会收到一条消息，说明证书无效。但是，流量仍将被加密。

您必须向第三方支付“有效” SSL 证书的原因是 SSL 证书的部分目的是验证您的服务器的真实性。如果任何机构可以使用他们想要的任何信息颁发 SSL 证书，那么是什么阻止我使用 Walmart.com 的联系信息设置 SSL 证书并诱使用户认为我的网站是 walmart.com 的一个分支？

简而言之，您可以免费获得加密部分，但如果您想避免浏览器身份警告，则需要支付第三方证书。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T13:03:38.880

您可以[自签名证书](http://www.tc.umn.edu/~brams006/selfsign.html)，或从[cacert.org](http://www.cacert.org/)或相关的免费签名社区获取证书。大多数浏览器都会抛出警告，所以你不应该在生产中这样做（如果你是电子商务），但是在开发过程中，或者如果你不关心警告，这是一个便宜的选择

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T13:18:20.223

正如其他人所说，您可以简单轻松地使用自签名证书或设置自己的证书颁发机构 (CA)，然后颁发任意数量的证书。所有这些证书都与大型 CA 颁发的“商业”证书一样有效，因此您的证书与来自威瑞信的证书在技术上没有区别。

大多数浏览器和其他客户端应用程序警告您的证书的原因是，他们不知道您的 CA，因此不信任您的 CA。浏览器通常带有数百个众所周知的 CA 证书，每个人都会自动信任（如果这是一件好事，那么……），因此您在通过 HTTPS 访问 amazon.com 时不会收到警告。在 Firefox 中，您可以转到“首选项”>“高级”>“加密”>“查看证书”以查看您的浏览器当前信任哪些 CA 或单个证书。

最后，这是您和您服务的用户信任谁的问题。如果您的用户认识并信任您（例如在公司网络或小型开发团队中），他们可以将您的 CA 证书添加到浏览器中的受信任证书中。从那时起，您自己的 CA 颁发的每个证书都不会产生警告，并且会像所有其他证书一样受到信任。

# wcf - NHibernate 类作为数据契约

> ID：934716
> 
> 赞同：8
> 
> 时间：2009-06-01T13:00:03.630
> 
> 标签：wcf, nhibernate

我通过 WCF 服务公开了一些 CRUD 方法，因为一些数据对象通过 NHibernate 持久化在数据库中。将 NHibernate 类用作数据契约是一种好方法，还是将它们包装起来或用其他一些数据契约替换它们更好？你的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T16:17:17.417

我们的团队刚刚就这个设计点进行了几个月的辩论，所以我有很多链接要分享；-)

*简短的回答：* 您“应该”从您的 NHibernate 类转换为域模型。

*长答案：* 我认为这个问题的答案是原则问题。如果你想要互操作，你不应该*使用**数据*集作为你的 DTO（[我喜欢 Hanselman 的帖子](http://www.hanselman.com/blog/ReturningDataSetsFromWebServicesIsTheSpawnOfSatanAndRepresentsAllThatIsTrulyEvilInTheWorld.aspx)）。我并不是说这从来都不是一个好主意。显然，人们在这方面取得了成功。只要知道你在偷工减料，这是一个冒险的提议。

如果您可以完全控制要向其中推送数据的类，则可以构建一个不错的域模型并将 NHibernate 数据映射到这些类中。您很可能会遇到严重的问题，因为 IList<> （ <bag> 映射到的）不可序列化。您必须编写自己的序列化程序，或使用[NetDataContractSerializer 之](http://lunaverse.wordpress.com/2007/05/09/remoting-using-wcf-and-nhibernate/)类的东西，但您会失去互操作性。

您将需要衡量构建一些包装器类所涉及的工作量，以及它们之间的转换，但是您在域模型的外观方面具有完全的灵活性。然后，您就可以为您的 NHibernate 地图和对象进行代码生成（就像我们所做的那样）。然后，您的数据合同应作为数据的抽象。

PS 您可能想看看[ADO.NET Data Services](http://msdn.microsoft.com/en-us/data/bb931106.aspx)，这是一种公开数据的 RESTful 方式，在这一点上，这似乎是公开数据的最具互操作性的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T16:15:24.047

您不想直接公开您的域模型，而是在域到达流程边界时将其映射到某种消息。您可以利用 NHibernate 为您完成映射工作。在这种情况下，您将有 2 个映射，一个用于域模型，另一个用于轻量级消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T15:06:07.573

我在这方面没有直接经验，但我之前通过 WCF 发送过数据集，效果很好。我认为在 WCF 上使用 NHibernete 作为数据对象的最大问题是缺乏互操作性（使用数据集时也是如此）。不仅客户端必须使用 .NET，客户端还必须使用 NHibernate。这违反了 SOA 原则，但是如果您*确定*不会重用该组件，那么没有理由不这样做。

至少值得一试。

# java - Hibernate二级缓存ehcache.xml，实体的缓存设置不能读到HIbernate

> ID：934720
> 
> 赞同：0
> 
> 时间：2009-06-01T13:01:06.950
> 
> 标签：java, xml, hibernate, ehcache, second-level-cache

为了清楚易懂，我有两个项目： 1\. 一个实体项目，其中有这个项目中的所有实体类。2.一个项目，包含一个main()函数来运行应用程序，我的ehcache.xml放在这个项目的类路径下。

我的问题是：我可以更改 ehcache.xml 的**defaultCache**元素，并且可以从 SQL 日志文件中看到更改。但我认为 Hibernate 只读取了我的**defaultCache**元素，因为无论我在 ehcache.xml 的特定实体的**缓存**元素中发生什么变化，SQL 日志中都不会发生任何变化。

例如：如果我将**defaultCache**元素的*maxElementsInMemory*设置为*0*，无论我将实体的**缓存**元素的*maxElementsInMemory设置为**100*还是*0*，都不会在二级缓存中缓存任何该实体。如果我将**defaultCache**元素的*maxElementsInMemory*设置为*100*，无论我将实体的**缓存**元素的*maxElementsInMemory设置为**100*还是*0*，都会有该实体缓存在二级缓存中。

 *********所以我认为也许实体的**缓存**元素的名称属性设置错误，无法从Hibernate中读取？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T16:52:13.993

我发现我的问题出在哪里。我正在使用 ehcache 作为缓存提供程序。在 ehcache.xml 中，如果我没有设置 standardQueryCache 元素，我认为 defaultCache 元素也用于所有 QueryCache。因此，我是否将 maxElementsInMemory 设置为“0”并不重要，因为所有 QueryCache 都在使用 defaultCache 区域。但是在使用 EntityManager.find() 函数时，将 maxElementsInMemory 设置为“0”绝对有助于禁用该实体的二级缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-11T15:18:40.730

请阅读文档。在`maxElementsInMemory`设置的情况下， 的值`0`具有特殊含义 - `unlimited`。因此，您将缓存所有内容，而不是根本没有缓存。

# visual-studio-2008 - Visual Studio 2008 - 禁用 .NET Framework 调试

> ID：934723
> 
> 赞同：8
> 
> 时间：2009-06-01T13:02:16.527
> 
> 标签：visual-studio-2008, debugging

我知道一个相当奇怪的问题...我以前在 Visual Studio 2008 中使用 .NET 框架源步进选项（工具>选项>调试>常规）。

现在，虽然我关闭了该选项，但每次我暂停调试器时，我都会开始单步执行代码，我会进入 .NET 框架，该框架需要一段时间才能退出，因为此时已经加载了很多符号。

有没有其他人遇到过这个问题，有没有人知道如何关闭它？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T13:09:18.353

尝试在相同的选项菜单中选择*Enable Just My Code (Managed Only)*（即工具 -> 选项 -> 调试 -> 常规）。

当您启用 .Net Framework 源步进时，此选项将被禁用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T13:08:33.097

听起来您正在调试来自 .NET 的源代码，该代码从 Web 下载适当的 PDB 和源代码。有关示例，请参见此 URL：

[http://weblogs.asp.net/scottgu/archive/2007/10/03/releasing-the-source-code-for-the-net-framework-libraries.aspx](http://weblogs.asp.net/scottgu/archive/2007/10/03/releasing-the-source-code-for-the-net-framework-libraries.aspx)

您可能只需要扭转 ScottGu 所做的事情来打开它。

# c++ - 从 gcc 3.3.3 到 4.1.0 的移植，C++ 模板，未定义的引用

> ID：934725
> 
> 赞同：0
> 
> 时间：2009-06-01T13:02:34.903
> 
> 标签：c++, templates, gcc

我们的应用程序在很多地方都使用了 C++ 模板。我目前正在尝试从 gcc 3.3.3 移植到 4.1.0 并遇到问题。我在一个小型共享库和可执行文件中重新创建了这个问题。我正在构建共享库，但可执行文件无法与以下内容链接：

```
 undefined reference to `MyNumber<int>::~MyNumber()'
    undefined reference to `MyNumber<int>::MyNumber(int)'
    undefined reference to `MyNumber<int>::number()' 
```

我没有直接在可执行文件中使用模板类，并且希望这一切都被封装在共享库的实现中（可能天真地如此）。

该问题仅在使用共享库时出现。当我在 SLES 11 (gcc 4.3.2) 上构建我们的应用程序时，我的大部分问题似乎都得到了解决，但我仍然收到以下一些：

```
 undefined reference to `vtable for MYCLASS<T1, T2>' 
```

这都是在将可执行文件链接到共享库时。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T13:07:53.287

这是一条非常晦涩难懂的信息，但这意味着您没有定义虚函数，请参见[此处](http://gcc.gnu.org/faq.html#vtables)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T16:00:56.530

我有一个类似的问题，并通过在头文件中实现函数来解决它，而不是在 cpp 文件中。

萨鲁2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T15:11:14.520

如果不了解更多关于您的源代码，这很难回答。[然而，在gcc 邮件列表](http://gcc.gnu.org/lists.html)上提出这个特定问题可能会产生更好的结果，因为从事 gcc 工作的人比其他人都更了解所有错综复杂的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T19:54:04.833

感谢您的评论。我从我的编译/链接选项中删除了 -frepo 和 -fno-impicit-templates 并且很好。

# maps - 谷歌地图：想要将地图分成多个子边界

> ID：934729
> 
> 赞同：0
> 
> 时间：2009-06-01T13:03:42.173
> 
> 标签：maps

我想把谷歌地图显示分成 200 个部分，我有这个代码

```
bounds = map.getBounds();
southWest = bounds.getSouthWest();
northEast = bounds.getNorthEast();

tileWidth  = (northEast.lng() - southWest.lng()) / 10; 
tileHeight = (northEast.lat() - southWest.lat()) / 20; 

for (x=0; x < 20 ; x++)
{
for (y=0; y < 10 ; y++)
{
    var x1 = southWest.lat()+ (tileHeight * x);
    var y1 = southWest.lng()+ (tileWidth * y);
    var x2 = x1 + tileHeight;
    var y2 = y1 + tileWidth;

    var tempCell = new GLatLngBounds(new GLatLng(x1, y1), new GLatLng(x2, y2));
}
} 
```

我只是想不通它有什么问题......有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T13:32:57.417

我不禁注意到您使用 tempCell 来保存结果，但是在那之后做了什么？你有没有再次提到那些有界区域？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-14T16:24:18.550

我尝试了您发布的代码 - 它似乎工作得很好。问题可能在您的代码中的其他地方。你能发布更多细节吗？

然而，值得注意的是，如果边界包括国际日期变更线，此代码将以惊人的方式失败。让我们知道这是否是问题所在。

# perl - Perl：遍历文件并替换

> ID：934733
> 
> 赞同：6
> 
> 时间：2009-06-01T13:04:27.943
> 
> 标签：perl, file, substitution

我只是想读入一个日志文件，进行搜索和替换，然后将更改写出到同一个日志文件中。

在 Perl 中执行此操作的最佳实践方式是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T13:10:22.470

我通常为此编写一个衬里：

```
perl -i -pe 's/some/thing/' log.file 
```

看[这里](https://web.archive.org/web/20100612201232/http://sial.org/howto/perl/one-liner/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-01T13:12:29.533

这通常使用单线完成：

```
perl -pi.bak -e "s/find/replace/g" <file> 
```

请注意该`-i.bak`部分 - 这将创建一个扩展名为`.bak`. 如果您想在没有网络的情况下玩，您可以这样做以覆盖现有文件而不进行备份：

```
perl -pi -e "s/find/replace/g" <file> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T13:22:22.743

或者你可以使用`sed`（我知道......你问过perl）：

```
sed -i 's/find/replace/g' <file> 
```

# asp.net-mvc - ASP.Net MVC AJAX 链接不起作用

> ID：934745
> 
> 赞同：2
> 
> 时间：2009-06-01T13:07:28.483
> 
> 标签：asp.net-mvc, ajax, actionlink

为了实现 AJAX 登录，我在我的页面上有此链接：

```
<%= Ajax.ActionLink("Log On", "LogOn", "Account", new AjaxOptions {
    UpdateTargetId = "lll",
    Confirm = "blah"}) %> 
```

附近有一个 id 为 lll 的 div。当我单击链接时，我得到了 blah 确认（只是为了调试目的而添加的，没有它的行为是相同的），但随后什么也没有发生。没有请求到达服务器（因为我在 LogOn 操作方法上有一个断点）。那是在 Chrome 和 IE8 中。在 FF3 中，它会打开登录视图，但作为一个页面，它不会通过 AJAX 下载它。

有什么想法可能是错的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T13:37:07.160

问题是 ajax 操作链接默认发出 POST 请求，它被定向到另一个 LogOn 方法（接受 POST 的方法），这就是我没有击中断点的原因另外，它失败了，因为必要的 POST 数据没有被发送。将 HttpMethod 添加到操作链接修复它：

```
<%= Ajax.ActionLink("Log On", "LogOn", "Account", new AjaxOptions {
    UpdateTargetId = "lll",
    Confirm = "blah",
    HttpMethod = "Get"}) %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T13:27:21.623

听起来页面上有一些 javascript 错误导致插入的 javascript 处理 AJAX 请求不触发。您是否在页面加载时在 FireBug 中查看过它，以查看您的所有 Javascript 是否正确加载？此外，您的 Microsoft javascript 库版本是否与您使用的 MVC 版本相匹配？我记得至少有一次在我必须在我的项目中手动更新我的 Microsoft javascript 库版本的版本进展中。如果您的项目通过多个版本的 MVC 存在，我建议跟踪新库（创建一个新项目并将它们复制到旧项目或打开安装目录中的项目存档并手动提取它们）并安装它们.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T13:12:16.803

您是否在 head 部分中包含 ajax 客户端脚本：

*   微软MvcAjax.js
*   微软Ajax.js

# ruby-on-rails - 这是对 Rails 单表继承的合法使用吗？

> ID：934758
> 
> 赞同：4
> 
> 时间：2009-06-01T13:10:30.223
> 
> 标签：ruby-on-rails, sti

我刚刚阅读了 Chad Fowler 关于[20 Rails Development No-Nos](http://chadfowler.com/2009/4/1/20-rails-development-no-no-s)的博客文章。关于单表继承，他评论道：

> 存储一个名为“type”的列，其中包含一个类名，这是一个很好的指标，表明正在发生一些可疑的事情。这很可疑，但并不总是很糟糕。不过，我认为，无论何时使用它，都应该不止一次地问自己这是否是正确的解决方案。当您有大量 STI 和多态关联时，数据库不会做它们最擅长的事情。

我正在编写一个博客应用程序，并且我正在考虑使用 STI 来对帖子进行评论，以及访问者可以发布的联系消息（如果他们想与我取得联系）。我的`Message`模型将继承自我的`Comment`模型。它们都有共同的属性，除了`Message`会有一个额外的`subject`字段。另一个共同点是两者都将提交给 Akismet 进行垃圾邮件检查。

与其像 Chad 建议的那样不止一次地问自己这是否是正确的解决方案，我还想从 Stack Overflow 专家那里得到一些意见！我的提议听起来是否适合 STI？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T13:26:07.650

我已经多次使用 STI。考虑一个可能有 Page、NewsItem、BlogItem 等的 CMS。

它们每个都可以继承自一个公共类，而该类又继承自 ActiveRecord。每个模型的表都是相同的（标题、正文、标签、published_at），但每个模型可能具有不同的关联、不同的状态或不同的工作流，因此每个模型在自己的类中都有自定义代码。然而，它们都共享一个公共表和父类。它还允许我使用父类进行跨类搜索，并让生成的记录数组自动类型转换。

还有其他方法可以解决这个问题，也许不是最好的例子，但在对象行为可能不同但持久状态相同的情况下，STI 肯定会派上用场。当然，你必须确保这在未来也是如此。

在您的情况下，评论和联系信息是不同的。听起来将它们放在同一张桌子上没有任何好处。也许将共享代码放在父类中，或者最好放在 /lib 中的模块中。

# c# - 插件架构中的反射与属性

> ID：934762
> 
> 赞同：3
> 
> 时间：2009-06-01T13:11:50.783
> 
> 标签：c#, .net, reflection, architecture, plugins

我正在开发一个在启动时从子目录加载插件的应用程序，目前我正在通过使用反射来迭代每个程序集的类型并找到实现 IPluginModule 接口的公共类来做到这一点。

由于反射涉及性能损失，并且我希望一段时间后会有几个插件，我想知道定义在程序集级别应用的自定义属性是否有用，可以在迭代类型之前检查该属性（可能大约一个程序集中的十几种类型，包括 IPluginModule 的 1 个实现者）。

该属性（如果存在）然后可以提供一种方法来返回所需的类型或实例，并且迭代这些类型将只是一种回退机制。将类型信息存储在配置文件中不是一种选择。

这会提高性能，还是与实际从存储中加载程序集所需的时间相比无关紧要？此外，这种用法是否适合属性？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T13:19:55.633

您还可以在配置中包含可插入类型，这样您就知道确切的类，而不是遍历所有类。必须为此选项提供一些配置实用程序......但可能会根据您循环通过的类的数量获得很好的性能提升。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-01T13:22:07.017

我会用一个问题来回答你的问题：你为什么担心这个？

您担心*一次性操作**可能*会影响性能，因为以后*可能*会有多个插件。

 **除非您的应用程序启动时间对用户来说过长，否则我不会浪费时间去考虑它——您可能可以做一些更好的事情来改进您的应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T13:20:58.767

我相信微软的两个 .net 插件框架，Managed AddIn Framework (MAF) 和 Managed Extensibility Framework (MEF) 都可以使用属性或反射来发现插件。所以微软似乎觉得属性是合适的。

不过，我不确定性能差异是什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-05T22:23:24.773

一个好的解决方案是缓存有关插件的所有信息。第一次启动应用程序时，它会全面扫描插件 dll，并保存在文件中找到的类型列表。下次应用程序启动时，它会从文件中加载信息，这将比再次扫描所有 dll 快得多。该应用程序还可以存储每个 dll 的时间戳，因此如果它检测到 dll 中的更改，它可以重新扫描它并更新缓存。

这基本上是[Mono.Addins 框架](http://monoaddins.codeplex.com)所遵循的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T13:18:56.570

我曾认为向程序集询问所有带有属性标记的类也会使用反射。然后归结为在元数据、接口实现或属性标记中查找哪个更快？

# algorithm - 和 S 在 N 个不同操作数上的分布

> ID：934763
> 
> 赞同：1
> 
> 时间：2009-06-01T13:12:02.640
> 
> 标签：algorithm, math

我试图找出一种方法将总和 S 分配给 N 个不同的操作数（b1，b2，..，bn），其中 b1，b2，... bn 处于固定比率，由另一组确定操作数 (a1,a2, .. an)

考虑以下情况：

候选人 A 总共获得`Ta`N 个选区的选票，分布为：`{a1, a2, a3 .. aN}`

候选人 B 从 M 个选区 (IMP: M <= N) 获得总`Tb`票数（`Ta`并且`Tb`是不相关的，这意味着`Ta < Tb`, `Ta = Tb`&`Ta > Tb`都是可能的），分布未知。

将选票分配给选区 b1、b2、b3..bM的最佳方法是什么`Tb`，使得它们以与 a1、a2、a3..aN 相同的比例分配。

一些案例：

1.理想

```
Ta = 20 (8,6,4,2) Tb = 10 
```

然后我们得到： Tb (4,3,2,1)

2.不太理想

```
Ta = 20(8 ,6, 4, 1 , 1) Tb = 10 
```

然后我们得到 (4, 3, 2, 1, 0) 这实际上意味着 (4,3,2,1) (M < N)，并且仍然可以容忍。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T13:16:16.843

一个简单的解决方案：

br = ar * (Tb / Ta)

对于复杂的范围或不匹配的 Ta 和 Tb，这实际上并不适用

比如，Ta = 22 (5, 5, 4, 2, 1, 1, 1, 1, 1, 1) 和 Tb = 7

更新：我遵循以下规则来获得最佳解决方案：

1.  保持比率为（Tb / Ta）并继续分配直到用完。
2.  每当你四舍五入时，四舍五入即 3.24 -> 4 和 3.68 也 -> 4
3.  例如这里： b1 = 5 * 7 / 22 => 2, b2 = 5*7/22 = 2, b3 = 4*7/22 = 2, b4 = 1 （因为只剩下一个）

所以我们有 Tb = 7(2,2,2,1) 最接近 (5, 5, 4, 2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-11T06:12:22.370

你的 a_i 总是排序吗？假设是这种情况，一种方法是从 a_i 的第一个值开始分配 b_i。

# jquery - 要问一个想要完成中型网站的人的基本问题是什么？

> ID：934769
> 
> 赞同：10
> 
> 时间：2009-06-01T13:13:11.107
> 
> 标签：jquery, web-applications, user-interface

我想知道一个人需要问的基本问题是否有人想要完成他的网络应用程序？它可以是 UI、平台、应用程序的症结和许多其他东西......请在开始使用应用程序之前发布需要了解的内容。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-01T13:25:50.863

**你的预算是多少？**确保每个人的期望都是现实的。高质量的工作需要更高的价格。如果他们不愿意接受，那就走开。我假设你的工作将达到高标准。即使你的工作低于标准，这仍然是一个重要的问题，但走开并不​​是一种选择。

**你的完成时间是多少？**换句话说，他希望你在一周内为他的公司写 Facebook 吗？如果是这样，请走开。这个问题和上一个问题的不同之处在于，无论你的工作质量如何，你都应该走开。不合理的时间框架总是以糟糕的方式结束。总是。

**您要我建立的网站的目的是什么？**令人惊讶的是，这一点经常被忽视。中小型企业通常采取1）做网站，2）????，3）利润的方法！确保他们有计划将网站整合到他们的业务中。一个充满无用信息的静态、陈旧网站几乎比没有网站更糟糕。

**您的用户的技术水平如何？**这具有广泛的影响。例如，较少的技术用户将导致较高的 IE6 市场份额，因此您必须相应地进行设计。老用户可能需要更大的字体大小。名单还在继续。了解您的用户非常非常重要。例如，Stack Overflow 使用“markdown”语法，因为它的用户是技术人员并且可以理解它。

**您的网站需要国际化吗？**这完全取决于公司，但在有大量`<insert non-English language>`演讲者的市场中，国际化可能是推动网站业务发展的关键。

**你愿意依靠我的专业知识吗？**这很重要，因为企业主通常认为`<blink>`这非常酷。确保您在驾驶座上。听取他们的建议并接受他们，但仅限于有意义的地方。不要为了他们的利益而牺牲你的设计意识，因为这个网站将在你的投资组合中，因此会反映你。

**您是否有任何我需要了解的现有基础架构？**这并不适用于所有情况，但是提前知道您需要将他们的 Web 应用程序与 Active Directory 环境集成可以对您选择的技术产生重大影响。

**从里到外了解他们的产品。**不是问题，而是很好的建议。这将提高您交付的整体产品（网站）的质量。

**你有一个配色方案吗？**很多时候，公司会在他们的标志中加入配色方案，但如果没有，最好问问他们是否有任何想法。如果它不是太离谱（例如，呕吐绿色与亮橙色相冲突），请尝试将其用作起点。

* * *

**回应评论：**用户界面真的是你的统治。除了配色方案偏好等基本事项外，您还是专家。请记住，企业主不是网页设计师，可能无法告诉您“我想要这里的登录表单和这里的日期/时间选择器”。

最好的方法是研究网站的一些常见用例。当然，这取决于企业主知道他的客户在使用他的网站时想要完成什么。这将决定 UI 流程和网站的核心功能。一切都来自用例。调查和记录它们可能很乏味，但这项工作非常值得。

UI 和核心功能对于每个网站都是独一无二的，因此在一般情况下很难解决它们。在各种规模和所有类型的项目中，处理用例是一种常见的做法，并且这是您前进所需要的技能。很抱歉给你这样一般的建议，但这确实是我能想到的最合理的建议。祝你好运！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T14:07:10.610

还有一些流程问题可能值得一开始就提出。

当你在这个项目上工作时，他希望看到什么样的进度报告？这导致了整个通信组件，即 IMO。

他是否希望以敏捷的方式在开发的各个阶段查看原型并提供反馈，或者它只是您在完成后交付的一个大黑匣子？

法律要求，包括应用程序是否有“服务条款”或“最终用户许可协议”？以及应该使用什么许可证来构建？他是希望一切都建立在开源堆栈之上，还是“按原样工作”的场景？

就其生产环境而言，规模也将是我们所说的“中等”？考虑到公司的规模，来自亚马逊、微软或谷歌的中型网络农场可能包含数千台机器，而其他人可能认为中型网络农场不止少数。

最后但并非最不重要的一点是，明确要求。这在某种意义上属于法律要求，因为您为 $x 构建它并且他想要一个执行 a、b 和 c 的应用程序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-01T14:25:30.867

其中一些与布伦德尔先生相似，但希望我能增加价值。没有特别的顺序：

*   你为什么要构建这个应用程序？（描述这个 Web 应用程序的“快乐端点”是什么样的。）
*   我们是在雕刻新的流程/模块/功能，还是简单地自动化现有的流程/模块/功能？（后者比前者容易。）
*   此应用程序范围内的流程/模块/功能是什么？谁定义了它们？
*   客户的整体商业模式是什么？应用程序和该模型之间的接触点在哪里？受到多少影响？
*   传递了什么价值？它将如何测量？（与第一个问题密切相关......）
*   谁将使用 Web 应用程序？（网络应用程序的设计需要考虑到最终用户。）
*   谁是“利益相关者”？（IOW，谁将直接从该项目中受益或损失？当然不会，但如果交易员必须滑倒怎么办？这将反映在谁身上？）
*   如果有的话，你的预算是多少？
*   什么是dealine/go-live drop-dead date，如果有的话？
*   Do you have any rules/process for interacting with external/internal developers? (Ex: reporting needs, coding standards, etc...)
*   Is it technically integrated with anything else or stand-alone?
*   Is it visually integrated with anything else or stand-alone? What characteristics/attributes/attitude should the site convey to users?
*   Is it replacing anything? If so, what and why?
*   What "server stack" will it be deployed on? What technologies must be used, if any?
*   What are the "hard metrics" that must met, if any? (Ex: Must be able to field 1000 requests/min.)
*   What are the project's security needs?
*   Who will test/validate the prototype? What are their needs/expectations for performing testing/validation?
*   Who will maintain the web application? What are their needs/expectations for performing maintenance?
*   谁将维护任何静态内容？他们对执行维护有什么需求/期望？
*   谁来培训用户？他们对进行培训有什么需求/期望？

现在，小心点。首先，单独和分组采访利益相关者。如果可能的话，面试多次，因为你的第一次面试可能会沉淀出你在第二次面试中会得到的想法。

It's best **not** to mash all of this in one interview with all stakeholders and end-users in the room at once. Divide it into two parts, at least: the "current and future business" part, and the "exact solution" part? Don't mix conversations about the business-side of the problem with the other conversation you should have on pet features, functionality, content, search engine optimization, etc. The latter will tend to obscure the former, but the former is where a good developer can really catalyze a business.

Hope this helps. Requirements gathering is pretty much an art, not a science...

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-01T22:28:18.473

Ask them to provide you some links to sites which have similar functionality or layouts. This will really speed up communications (especially the creative process) and set expectations on both ends.

This is the easiest way to establish a starting set of requirements.

# sql-server - 如何根据段落查找 SQl Server 行 - 特别是段落中的单词，而不是确切的段落

> ID：934771
> 
> 赞同：1
> 
> 时间：2009-06-01T13:13:58.813
> 
> 标签：sql-server, sql-server-2005, full-text-search

我想使用 SQL Server 2005 Express 来查找与一段文本相关的前五个元组。我知道我可以使用全文索引和 CONTAINSTABLE 来查找包含确切短语的行，但是如何让它返回与段落中的单词最接近的匹配，而不是确切的段落本身。

到目前为止，我能想到的唯一方法是拆分 CONTAINSTABLE 查询，为每个空格字符插入“或”，按照以下内容生成查询，但我担心性能（和停用词）。

```
SELECT  id, FT.rank, description
FROM    SearchTable
    INNER JOIN CONTAINSTABLE (SearchTable, *, 
            '"This" OR "is" OR "my" OR "paragraph"') AS FT 
            ON SearchTable.id = FT.[key]
ORDER BY Rank DESC 
```

我希望这个问题有一个标准的解决方案——有人知道它是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T18:09:06.083

你有没有试过 FREETEXT 和 FREETEXTTABLE 应该做你想做的事？

[http://msdn.microsoft.com/en-us/library/cc879300.aspx](http://msdn.microsoft.com/en-us/library/cc879300.aspx)

# ruby - 将 RSpec 放入 RDoc

> ID：934772
> 
> 赞同：3
> 
> 时间：2009-06-01T13:14:15.100
> 
> 标签：ruby, rspec, rdoc, ioke

在 Ioke doc 中，ISpec 测试包含在文档中，请参阅 ioke.org/dok/index.html

Ruby 的 RSpec 和 RDoc（或 SDoc）如何做到这一点？我找不到任何命令行开关或外部库来这样做。有什么想法（不包括我自己实现它;-)）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-29T16:08:10.350

时间有帮助：现在有一个 YARD 插件完全符合我的要求：http: [//github.com/lsegal/yard-spec-plugin](http://github.com/lsegal/yard-spec-plugin)

# c# - 无法以编程方式更改 gridview 列宽

> ID：934773
> 
> 赞同：0
> 
> 时间：2009-06-01T13:14:30.043
> 
> 标签：c#, winforms, gridview, .net-2.0

在我的 Windows 窗体上，我需要以编程方式设置网格视图中列的宽度。我正在使用以下代码：

```
this.dgridv.Columns[columnName].Width = columnWidth; 
```

上面的 stmt 运行没有任何错误。但是，列宽保持不变。如果我在stmt运行后插入断点并检查width的值，它仍然是100，我猜这是datagrid列宽的默认值。

除了这个，我还有什么需要做的吗？在更改列宽之前我需要设置任何值吗？

对此的任何帮助或指示都将受到高度赞赏。

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T13:21:27.517

你有`AutoSizeColumnsMode`要填充的设置吗？

如果有，则需要设置`FillWeight`属性。这不是一个简单的宽度，而是`width / no. columns`该列所占的比例。

如果您没有调整列的大小，它将是 100.0。

如果该列已加宽，它将 > 100.0。

如果该列已收缩，它将小于 100.0。

根据定义，扩大一列会缩小其余列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T13:54:20.010

这有效：

```
this.dgridv.Columns[columnName].AutoSizeMode= DataGridViewAutoSizeColumnMode.None;
this.dgridv.Columns[columnName].Width = columnWidth; 
```

要重置它，我正在使用：

```
dgvCol.AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-29T15:26:58.357

`dataGridView1.Columns[index].Width = 150;`

这行代码将以编程方式设置列宽。

# java - 将值放入 HashMap 后更改值会更改 HashMap 中的内容？

> ID：934775
> 
> 赞同：39
> 
> 时间：2009-06-01T13:15:56.453
> 
> 标签：java, hashmap, pass-by-reference

如果我创建一个新的 HashMap 和一个新的 List，然后使用任意键将 List 放在 Hashmap 中，然后再调用`List.clear()`它会影响我在 HashMap 中放置的内容吗？

这里更深层次的问题是：当我向 HashMap 添加内容时，是复制并放置了新对象还是放置了对原始对象的引用？

谢谢！

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-06-01T13:39:32.177

这里发生的事情是您将*指向*哈希图中的列表的指针，而不是列表本身。

当你定义

```
List<SomeType> list; 
```

您正在定义指向列表的指针，而不是列表本身。

当你这样做

```
map.put(somekey, list); 
```

您只是存储*指针*的副本，而不是列表。

如果在其他地方，您跟随该指针并在其末尾修改对象，则持有该指针的任何人仍将引用相同的修改对象。

有关 Java 中传递值的详细信息，请参阅[http://javadude.com/articles/passbyvalue.htm 。](http://javadude.com/articles/passbyvalue.htm)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-01T13:18:02.563

Java 是按值传递引用。

将列表添加到哈希映射只是添加对哈希映射的引用，它指向同一个列表。因此，直接清除列表确实会清除您在哈希图中引用的列表。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-01T14:26:42.177

> 当我向 HashMap 添加内容时，是复制并放置了新对象还是放置了对原始对象的引用？

它始终是对对象的引用。如果您清除 HashMap，该对象仍将是“活动的”。如果没有人再引用它，那么该对象将被垃圾收集器销毁。如果您需要复制它，请查看 Object.clone() 方法和 Cloneable 接口

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-06-16T05:18:43.820

```
Map<Integer, Integer> hasmapA = new HashMap<>();
hasmapA.put("key1", "value1");
hasmapA.put("key2", "value2");
hasmapA.put("key3", "value3"); 
```

1.  **按引用复制：**如果将一个**HashMap**分配给另一个，则两者都指向内存中的相同引用。

    地图 hasmapB;

    hashmapB = hashmapA;

如果您对其中任何一个进行更改，更改将反映在两个**HashMap**中，因为两者都引用相同的位置。

2.  **按值复制：**如果你想

> 克隆/深拷贝/创建单独的内存位置/创建单独的对象

复制 hashmapA 的内容时 hashmapB 的

```
Map<Integer, Integer> hashmapB = new HashMap<>();;

hashmapB.putAll(hashmapA) 
```

**注意：** 您是否注意到 hashmapB 声明的两点不同？在第二点我们必须调用 **HashMap**构造函数。这样我们就可以把**hashmapA**的所有数据放到hashmapB中。

[参考](http://www.java2s.com/Tutorial/Java/0140__Collections/TocopyallthekeyvaluepairsfromoneMapintoanotherpublicvoidputAllMapmap.htm)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T14:26:43.220

通常，您总是在 Java 中处理引用（除非您自己使用“new”[1] 显式创建一个新对象）。

因此，它是一个参考，而不是您存储在地图中的完整对象副本，更改列表也会影响您在浏览地图时看到的内容。

这是一个功能，而不是一个错误:)

[1] 清教徒将包括“clone()”和序列化，但对于大多数 java 代码，“new”是获取对象的方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-28T09:45:24.967

试试看

```
包 test32;

导入 java.util.ArrayList；
导入 java.util.HashMap；
导入 java.util.List；

类Foo {
    公共 Foo（int id，字符串名称）{
 这个.id=id;
 这个名字=名字；
    }

    公共静态无效主要（字符串[]参数）{
 HashMap strs = new HashMap();

 // 创建一个对象列表
 列表 ls = new ArrayList();
 ls.add(new Foo(1, "Stavros"));
 ls.add(new Foo(2, "Makis"));
 ls.add(new Foo(3, "Teo"));
 ls.add(new Foo(4, "Jim"));

 // 将对象的引用从列表复制到 hashmap
 strs.put("1", ls.get(0));
 strs.put("2", ls.get(1));
 strs.put("3", ls.get(2));
 strs.put("4", ls.get(3));

 System.out.println("修改前的列表：" + ls);
 System.out.println("变更前的地图：" + strs);
 // 从 hashmap 中获取一个对象
 Foo f=strs.get("1");
 // 设置不同的值
 f.setId(5);
 // 观察差异反映到列表和哈希图也
 System.out.println("修改后的列表："+ls);
 System.out.println("修改后的地图："+strs);
    }

    私人 int id；
    公共无效setId（int id）{
 这个.id=id;
    }
    公共 int getId() {
 返回这个.id;
    }

    私有字符串名称；
    公共无效集合名称（字符串名称）{
 这个名字=名字；
    }
    公共字符串 getName() {
 返回这个名称；
    }

    公共字符串 toString() {
 StringBuilder sb = new StringBuilder();
 sb.append(id);
 sb.append("-");
 sb.append(name);
 返回 sb.toString();
    }
}

```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-15T16:44:40.520

正确答案解释如下：假设您有一个名为 hashmap 的 HashMap，并且最初您在此 HashMap 中放置了一个键值对，例如 hashmap<"test1","test2">。在此之后，当您将此哈希图传递给一个函数，在该函数中您再次将其值更改为 test3，例如 hashmap.put("test1", "test3") 并在 main 方法中再次打印该映射，Java Pass by Value Concept 在这里失败。

原因是：当您使用 HashMap 时，它会对 Key(test1) 进行哈希处理并存储值。当您将它传递给再次更改其值的函数时，它再次对同一键进行哈希处理并获取相同的内存地址并相应地更改值。这就是为什么当您尝试检索密钥“test1”时，它会为您提供“test3”的结果

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-06-01T13:53:32.930

天哪，Java 中的一切都是按价值传递的。当你传递一个对象时，你传递的值就是对象引用。具体来说，您正在传递对象引用的副本。Java 中也没有指针，尽管引用是相似的。修正它！

# java - 更改 NumberConstants.decimalSeparator() 值

> ID：934777
> 
> 赞同：2
> 
> 时间：2009-06-01T13:16:12.117
> 
> 标签：java, gwt, gxt

我正在使用 NumberField 和 NumberFormat。如何在不更改语言环境的情况下更改 NumberConstants.decimalSeparator() 值？例如我想要“。” 或 "," 作为所有语言环境的小数分隔符。是否可以创建自定义属性文件 NumberConstants_bla.properties 并强制 gxt 使用它而不是标准 NumberConstants_ru_RU.properties 或 NumberConstants_en_US.properties（取决于当前语言环境）？我应该把这个文件放在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T14:36:41.017

[在 Java 中，您可以使用DecimalFormatSymbols](http://java.sun.com/javase/6/docs/api/java/text/DecimalFormatSymbols.html)设置小数分隔符。

```
// default symbols for the locale
DecimalFormatSymbols decimalFormatSymbols = DecimalFormatSymbols.getInstance();
// set your required separator
decimalFormatSymbols.setDecimalSeparator(',');
// create a decimal format and set your symbols
DecimalFormat format = new DecimalFormat();
format.setDecimalFormatSymbols(decimalFormatSymbols); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T15:07:28.123

您可以创建自己的 NumberConstants（在其中放置所需的小数分隔符），然后使用它来创建自己的 NumberFormat。

我自己的 NumberConstants 示例：

```
import com.google.gwt.i18n.client.constants.NumberConstants;

public class MyNumberConstants implements NumberConstants {
  @Override
  public String notANumber() {
    return "NaN";
  }

  @Override
  public String currencyPattern() {
    return "#,##0.00\\u00A0\\u00A4";
  }

  @Override
  public String decimalPattern() {
    return "#,##0.###";
  }

  @Override
  public String decimalSeparator() {
    return ".";
  }

  @Override
  public String defCurrencyCode() {
    return "EUR";
  }

  @Override
  public String exponentialSymbol() {
    return "e";
  }

  @Override
  public String globalCurrencyPattern() {
    return "#,##0.00\\u00A0\\u00A4";
  }

  @Override
  public String groupingSeparator() {
    return "\\u00A0";
  }

  @Override
  public String infinity() {
    return "\u221E";
  }

  @Override
  public String minusSign() {
    return "-";
  }

  @Override
  public String monetaryGroupingSeparator() {
    return ",";
  }

  @Override
  public String monetarySeparator() {
    return "\\u00A0";
  }

  @Override
  public String percent() {
    return "%";
  }

  @Override
  public String percentPattern() {
    return "#,##0\\u00A0%";
  }

  @Override
  public String perMill() {
    return "\\u2030";
  }

  @Override
  public String plusSign() {
    return "+";
  }

  @Override
  public String scientificPattern() {
    return "#E0";
  }

  @Override
  public String simpleCurrencyPattern() {
    return "#,##0.00\\u00A0\\u00A4";
  }

  @Override
  public String zeroDigit() {
    return "0";
  }
} 
```

MyFormat 示例：

```
public class MyFormat extends NumberFormat{

  public MyFormat(){
    super(new MyNumberConstants(),"0.0", CurrencyList.get().getDefault(),true);
  }
} 
```

警告：这是一个丑陋的解决方法，可能会导致 i18n 出现问题。我只是用它来格式化一些我假设每个人都以相同方式显示的维度。

# sql - Django：按多对多字段订购模型

> ID：934779
> 
> 赞同：13
> 
> 时间：2009-06-01T13:16:26.170
> 
> 标签：sql, django, database-design, django-models

我正在编写一个具有 People 模型的 Django 应用程序，但遇到了障碍。我正在使用多对多关系将角色对象分配给人们 - 其中角色具有名称和权重。我希望按照最重角色的权重来排列我的人员名单。如果我执行 People.objects.order_by('-roles__weight')，那么当人们分配有多个角色时，我会得到重复。

我最初的想法是添加一个名为*heaviest-role-weight*的非规范化字段- 并按此排序。然后可以在每次向用户添加或删除新角色时更新此信息。[然而](http://code.djangoproject.com/ticket/5390)，事实证明，每次在 Django 中更新 ManyToManyField 时，都无法执行自定义操作（无论如何）。

所以，我认为我可以完全过火并编写一个自定义字段、描述符和管理器来处理这个问题——但是当为 ManyToManyField 动态创建 ManyRelatedManager 时，这似乎非常困难。

我一直在尝试想出一些聪明的 SQL 可以为我做到这一点 - 我确信它可以使用子查询（或几个），但我担心它不兼容所有数据库后端 Django支持。

有没有人这样做过 - 或者有任何想法如何实现？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-01T14:27:58.070

Django 1.1（当前为测试版）增加了[聚合](http://docs.djangoproject.com/en/dev/topics/db/aggregation/)支持。您的查询可以通过以下方式完成：

```
from django.db.models import Max
People.objects.annotate(max_weight=Max('roles__weight')).order_by('-max_weight') 
```

这会按人们最重的角色对他们进行分类，而不会返回重复项。

生成的查询是：

```
SELECT people.id, people.name, MAX(role.weight) AS max_weight
FROM people LEFT OUTER JOIN people_roles ON (people.id = people_roles.people_id)
            LEFT OUTER JOIN role ON (people_roles.role_id = role.id)
GROUP BY people.id, people.name
ORDER BY max_weight DESC 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-06-04T19:26:37.633

这是一种无需注释的方法：

```
class Role(models.Model):
    pass

class PersonRole(models.Model):
    weight = models.IntegerField()
    person = models.ForeignKey('Person')
    role = models.ForeignKey(Role)

    class Meta:
        # if you have an inline configured in the admin, this will 
        # make the roles order properly 
        ordering = ['weight'] 

class Person(models.Model):
    roles = models.ManyToManyField('Role', through='PersonRole')

    def ordered_roles(self):
        "Return a properly ordered set of roles"
        return self.roles.all().order_by('personrole__weight') 
```

这让你可以说：

```
>>> person = Person.objects.get(id=1)
>>> roles = person.ordered_roles() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T13:55:35.577

Something like this in SQL:

```
select p.*, max (r.Weight) as HeaviestWeight
from persons p
inner join RolePersons rp on p.id = rp.PersonID
innerjoin Roles r on rp.RoleID = r.id
group by p.*
order by HeaviestWeight desc 
```

Note: group by p.* may be disallowed by your dialect of SQL. If so, just list all the columns in table p that you intend to use in the select clause.

Note: if you just group by p.ID, you won't be able to call for the other columns in p in your select clause.

I don't know how this interacts with Django.

# asp.net - DataReader 中的“操作”列

> ID：934780
> 
> 赞同：0
> 
> 时间：2009-06-01T13:16:49.603
> 
> 标签：asp.net, repeater

我的转发器中有一个“操作”列，显示用户可以为项目选择的操作。该列包含 ASP.NET HyperLink 或 LinkBut​​ton 控件。某些操作基于用户是否在某个角色中，这是我以编程方式确定的。当我填充中继器时，我正在努力寻找动态生成此列的最佳方法。现在我将内联代码分配给每个控件的 Visible 属性，但我觉得这很草率而且不是很直接。使用 PlaceHolder 控件并在运行时填充它会更好吗？其他人在这种情况下使用什么样的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T13:30:53.647

将任何类型的动态呈现应用到基于模板的控件的“正常”方式`Repeater`是处理`ItemCreated`或`ItemDataBound`事件。

在您的特定情况下，您可以检查该事件处理程序中的适当条件并切换相关“操作”列的可见性。

另外，[请参阅](https://stackoverflow.com/questions/681057/retrieve-the-value-of-td-in-repeater)Ian Quigley 发布的代码片段，该问题应该为您提供一个很好的示例。阅读我自己的答案也可能会有所帮助，该答案显示了如何在内联代码中使用可见性切换。

# .net - 为什么.NET 警告“未使用的变量”而不是“未使用的参数”？

> ID：934787
> 
> 赞同：2
> 
> 时间：2009-06-01T13:19:21.733
> 
> 标签：.net

为什么.NET 警告“未使用的变量”而不是“未使用的参数”？（我相信 Java 在这两种情况下都会发出警告。）

为什么 .NET 不关心“未使用的参数”？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T13:22:53.817

在我看来，您可能真正想要保留未使用的参数有几个原因；例如，假设一个应用程序链接到您的 DLL，并且您在 DLL 中进行了更改——为避免重新编译应用程序，您可能希望保持函数签名相同。

我想不出任何类似的原因，您希望将未使用的变量留在周围并且未注释掉。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-01T13:33:12.300

这不是技术答案，如果有技术答案，我当然不知道。但是，既然你问了。

未使用的变量是完全独立的。它们没有任何锚点，除了占用堆栈空间之外，它们实际上什么都不做。因此，没有正当理由在完整的程序中包含未使用的变量。您可以在编码时声明变量，因为您知道以后*将*需要它们，并且您现在只是实现了函数的一部分，但是一旦您的应用程序准备好生产，未使用的变量除了占用空间之外什么都不做。

* * *

您可能拥有/保留未使用的参数的原因有很多。首先，您必须重构引用该函数的每一行代码。这不一定容易或不可能。

如果您编写了一个 API，实际上不可能更改所有这些代码行。因此，在某些情况下，您必须保留未使用的参数以保持 API 一致性。

其次，如果你坚持或实现一个接口，那么你没有删除未使用变量的选项，它是强加给你的。即使您不需要变量中的任何信息，您也必须实现正确的调用，因此您最终会得到未使用的参数。

第三，如果你正在创建一个新的 API，并且有很多事情需要的信息，但不是这个特定的调用，为了一致性起见，它可能会放在那里。或者如果它是一个将在下一个版本中实现的功能，那么你最好在第一时间就正确地调用，这样你的下一个版本就不会成为一个破坏性的版本。

* * *

最终，不同之处在于参数是提供给您的信息，因此您可能并不总是需要全部使用它，但变量是您所说的*立即*需要的信息。由于局部变量是直接的并且不会影响超出范围的任何内容，因此删除未使用的变量要容易得多并且没有缺点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T13:23:58.310

好问题！我假设 Visual Studio 团队还没有实现它。我知道其他代码检查工具，例如 JetBrains 的 ReSharper，会警告您未使用的参数。

此外，正如另一个答案指出的那样，保留未使用的参数可能是有原因的。在公共方法的情况下，该参数可能被另一个程序集使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T13:29:46.753

这并不重要，因为编译器会去除未使用的局部变量。我认为编译器警告局部变量的主要原因是因为它们的存在没有使用很可能是由于疏忽（您声明了一个不需要的变量，或者您重构了一个曾经需要的变量现在不再需要） .

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T14:20:25.760

您可能正在使用特定实现不需要的值来实现接口方法或回调（委托签名）。例如，我从不记得在标准事件回调中使用 sender 参数。这将被标记在所有地方。

# svn - 指责 ToroiseSVN 时访问被拒绝

> ID：934788
> 
> 赞同：1
> 
> 时间：2009-06-01T13:19:42.577
> 
> 标签：svn, tortoisesvn

最近（在安装 Windows 7 之后？）我在使用 TortoiseSVN 归咎文件时遇到了问题。我收到一条错误消息，例如：“无法打开 'c:\temp\tmp.tmp'：访问被拒绝。”

如果我选择使用文本查看器来查看责备的选项，它可以工作，但这是一个糟糕的视图。我相信它与时间有关，因为它可以偶尔工作一次，但大多数时候我都会被拒绝访问......

有这个问题的其他人有什么解决方案吗？

使用

TortoiseSVN 1.5.9，构建 15518 - 32 位，2009/02/27 18:34:12 颠覆 1.5.6，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T17:15:48.007

这是已解决的 Subversion 中的错误。我认为升级到新的 TortoiseSvn（并且您还需要更新的 Subversion 命令行工具）将解决此问题。

# objective-c - 如何在 Objective C 中将十六进制数转换为整数和字符串？

> ID：934790
> 
> 赞同：5
> 
> 时间：2009-06-01T13:20:01.280
> 
> 标签：objective-c, cocoa, hex

给定这样的数组示例：

```
idx = [ 0xe, 0x3,  0x6, 0x8, 0x2 ] 
```

我想获得Objective C中每个指定项目的整数和字符串表示形式。我模拟了一个完美运行的ruby示例：

```
0xe gives 14 when i run 0xe.to_i and "e" when i run to_i(base=16)
0x3 gives 3 when i run 0x3.to_i and gives 3 when i run to_i(base=16) 
```

如何在 Objective C 中实现这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-01T13:49:07.213

To get the decimal and hexadecimal equivalents, you would do:

```
int number = 0xe; // or 0x3, 0x6, 0x8, 0x2

NSString * decimalString = [NSString stringWithFormat:@"%d", number];
NSString * hexString = [NSString stringWithFormat:@"%x", number]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-10T19:31:36.533

有了 NSString 后，您就可以使用该类中的方法，例如 intValue 或 longValue 或 floatValue

# iis - 开发机 IIS 版本 vs 部署 IIS 版本

> ID：934792
> 
> 赞同：0
> 
> 时间：2009-06-01T13:20:36.710
> 
> 标签：iis, iis-7, windows-server-2008, upgrade

我的开发机器正在运行 Windows XP SP2（隐含 IIS 5.1）。

直到最近，我们的部署环境还是​​基于 Windows Server 2003（因此是 IIS 6.0）。

我们即将迁移到 Windows Server 2008（以及因此 IIS 7.0）来进行新项目。

我们的项目使用 ASP.NET MVC 和 WCF 服务。

我们升级开发机器以运行 Windows Server 2008（或可能是 Vista，因为这也带有 IIS 7.0）有什么关键原因吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T16:24:32.860

我会说升级您的开发机器以在您的能力和资源范围内**尽可能多**地模拟生产环境符合您的最大利益。否则，您可能会陷入您完全没有意识到的陷阱，只是将应用程序从开发机器部署到服务器环境，这可能与不同版本的 IIS、每台机器运行的 .NET 框架版本或方式有关代码在运行时编译或执行。

尤其是 IIS 7 自 IIS 5.1 以来已进行了大幅升级，为什么您不应该在开发过程中更密切地使用它的当前功能，以免错过一些大好机会呢？要真正了解生产中的应用程序会发生什么，请在相同的情况下进行开发。

编辑/添加：[此链接](http://tinyurl.com/npl3nl)可以帮助您了解至少一个重要示例，说明不同版本如何影响您的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T07:53:32.433

我建议您针对打算部署的相同主要版本进行开发。也就是说，这给您留下了一些选择。首先，您可以针对您的本地 IIS 安装进行构建（就像您目前所做的那样）。这意味着您的所有机器都应该升级到 Windows Vista 或 Windows 2008 Server（或运行 IIS 7.5 的 Windows 7）。您的第二个选择是部署到远程机器。完全可以将您的应用程序部署到运行 IIS 7 的远程测试机器并进行远程调试。问题是，如果您有多个开发人员在远程站点上工作，就会出现问题。IIS 可以为不同的开发人员处理不同 Web 上的远程调试，但取决于您的架构和配置，您可能仍在测试 Web 应用程序的实例之间共享资源。您有时可能会彼此死锁。唯一的好处是您不必为所有机器购买许可证（并且可能升级硬件以支持操作系统升级）。但是，我认为这是短视的。恕我直言，开发人员生产力的损失是不值得的。

IIS 5.1 和 IIS 7.x 之间存在重大变化。对架构的更改（例如集成管道）可能会导致截然不同的行为和兼容性问题。我想您会发现 IIS 7 对开发人员更加友好。仅引入失败请求跟踪、扩展日志记录和增强错误页面等功能就可以更轻松地跟踪应用程序中的错误。在这方面，升级是非常值得的。

# debugging - IntelliJ 中是否有“异常中断”？

> ID：934794
> 
> 赞同：357
> 
> 时间：2009-06-01T13:21:15.147
> 
> 标签：debugging, exception, intellij-idea

是否有在第一次发生异常时会自动中断调试的功能？

所以我们

1.  开始申请
2.  做一些引发异常的事情
3.  让 IntelliJ 在发生异常的地方弹出突出显示的行。

* * *

## 回答 #1

> 赞同：406
> 
> 时间：2009-06-01T13:27:48.613

运行 | 查看断点 | 异常断点

* * *

## 回答 #2

> 赞同：174
> 
> 时间：2011-04-27T21:26:48.683

弹出对话框的一种快速方法是按`Ctrl`+ `SHIFT`+ `F8`（在 Mac 上：`Cmd`+ `SHIFT`+ `F8`），然后单击到异常断点选项卡。如果这是您查看的最后一个选项卡，它仍会被选中，从而可以轻松打开和关闭异常中断。

这将导致 IntelliJ 在引发异常的代码（或库代码）中中断。具体来说，在遍历堆栈以查找要执行的 catch/finally 块之前，您获得了异常处理的“第一次机会”。

* * *

提示：Java 在加载类时往往会在内部抛出大量异常，因此打破所有异常可能会变得非常乏味。好消息是您可以使用*条件*字段排除某些类型的异常。

例如：

```
!(this instanceof java.lang.ClassNotFoundException) 
```

您可以将多个此类条件与`&&`.

![在此处输入图像描述](https://i.stack.imgur.com/OGAZH.png)

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2015-02-12T14:45:37.113

在**IntelliJ IDEA 14**中转到：

`Run -> View Breakpoints -> Check "Java Exceptions Breakpoints" -> Uncheck "Caught Exceptions"`

如果不取消选中`Caught Exceptions`，则每次`Java Framework`抛出内部异常时都会停止执行。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-06-01T14:39:03.447

就在这里。您需要在 IntelliJ IDEA 的断点对话框中定义一个异常断点（可以是“任何异常”）。

如果需要，可以按条件或类过滤异常，或者按您是否对捕获的或未捕获的异常感兴趣。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2020-03-07T02:34:43.780

在较新版本的 intellij 中，它位于*Run* > *View Breakpoints*下。

然后你可以检查*Java Exception Breakpoints* -> *Any Exception*。

调试异常的一个好方法是使用您的主应用程序包和通配符`.*`。这样您就可以跳过所有其他库异常，因为大多数时候您正在寻找由您的应用程序而不是任何其他库抛出的异常（这可能是很多异常）。

作为图像中显示的示例，我`com.gs.mercury.*`每次应用程序抛出异常时都会中断。如果您将异常用于它们的用途（处理异常情况而不是处理正常情况的流程），您只会在几乎所有时间都达到所需的异常时停止。

PD。添加答案只是为了指出非常有用的*Catch 类过滤器*。

[![断点](https://i.stack.imgur.com/BpRqT.png)](https://i.stack.imgur.com/BpRqT.png)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-10-10T06:42:04.930

如果单击左上角的小“+”号，可以添加新断点。如果您选择异常断点，您会看到一个小对话框，您可以在其中输入要中断的异常类（以防您不想中断所有异常）。

# agile - 我们可以为瀑布项目创建一个新的 Scrum 变体吗

> ID：934813
> 
> 赞同：-1
> 
> 时间：2009-06-01T13:27:12.123
> 
> 标签：agile, scrum, product-management, waterfall

在分布式离岸环境中从事产品开发的传统大型软件产品组织很难遵循 Scrum 中的敏捷精神，原因如下：

1.  他们的产品开发不是迭代的。产品工程团队经过多轮迭代系统工程，提前正式确定给定版本的产品需求、产品架构和设计。可能会发生这种变化，但不会大规模。

2.  产品工程团队现在让离岸团队根据创建的规范构建此产品。这些大型离岸团队不能在迭代和经验模式上工作，因为这在这里没有保证。

3.  然而，产品经理可能希望通过在短期迭代中请求增量交付来定期了解离岸团队的产品开发。

4.  如果这些离岸团队可以在定义的正式流程（非经验性）、经理管理的环境（非授权）和使用增量开发方法（非迭代和自适应）中遵循 Scrum 的变体，那对他们将非常有用。

5.  在这种情况下实施的真正 Scrum 方法可能看起来很虚伪。但是，如果我们可以给他们一个正式的 Scrum 变体，用于传统的瀑布式场景，他们可能会利用它来为每个人带来好处。

我试图在我的博客[scrumtales.blogspot.com](http://scrumtales.blogspot.com)上更详细地描述这种情况。

我们可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T18:42:29.833

简短的回答绝对**是 YES**。

虽然 Scrum 是一种由某些仪式和流程组成的方法论，但它们的常见实现就是这样 - 一个实现。对于每个过程，退后一步，寻找更高抽象级别的解决方案，这不存在您遇到的问题 - 主要是距离。例如 - 托管。虽然常见的解释是让所有正在协作以“完成”用户故事的人进入一个具体的房间，​​但这不一定是唯一的房间。聊天室会做这项工作吗？虚拟现实房间会更适合您吗？VOIP 解决方案也可以工作。

每月一两次会议（冲刺计划和回顾）可以在这样的虚拟环境中举行，而不会对偶尔在正常下班时间工作的人造成太大压力。

如果时区和互联网带宽难以逾越，也许可以将频繁的在线会议脱机。日常会议可以通过使用 wiki 来完成。或电子邮件。

有无数用于仪式的在线工具，例如计划扑克 ( [PlanningPoker.com](http://planningpoker.com/) )，有些是商业的，有些是免费的：[VersionOne](http://www.versionone.com/)、[AxoSoft OnTime](http://www.axosoft.com/products/ontime.aspx)等等。

无论物理距离如何，Scrum 的其余部分都可以完成——编写用户故事、估计和故事点没有基于位置的限制。

希望这会有所帮助，阿萨夫。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T05:46:56.110

> 用于传统瀑布场景的 Scrum 正式变体

这被称为“Scrummerfall”。这里有几个链接可以帮助您开始解决您可以在您的组织中释放的痛苦：

[http://www.agileprogrammer.com/dotnetguy/archive/2006/07/08/16855.asp](http://www.agileprogrammer.com/dotnetguy/archive/2006/07/08/16855.aspx) x [http://blogs.msdn.com/nickmalik/archive/2007/06/04/waterscrum-vs-scrummerfall。 aspx](http://blogs.msdn.com/nickmalik/archive/2007/06/04/waterscrum-vs-scrummerfall.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-05T20:44:27.417

根据我在您的问题中读到的内容，我的简短回答是否定的。

我不得不说，除非你的分布式离岸团队愿意采用增量开发，否则这根本不是一个有用的练习。如果没有增量交付，正在为这个远程团队嘲笑 Scrum 流程的其余部分的产品经理将在 sprint 审查中寻找进展，并且团队将无法展示他们作为一部分完成的事情之外的任何内容他们的瀑布过程。因此，对于第一部分，设计已经完成，随后实施工作完成，最后系统和集成测试正在工作。当然，产品经理将无法要求对原始计划进行一些更改，此时团队可以做出响应并仍然满足他们正在推动的其他承诺和里程碑。为什么？因为他们要等到项目后期才能提供功能。

增量开发是关键。一旦他们有了这些，并且产品经理正在接受有时间限制的审查会议，那么您就可以开始远离做出承诺的经理，让团队成员收到反馈并直接做出承诺。

一旦您进行了增量开发，另一件要尝试的事情是使用离岸团队经理作为产品负责人代理的想法。它允许您的产品经理与项目中的所有团队协商依赖关系，并将其传达给代理。然后代理可以以权威的方式与他们的本地团队进行交互，并且仍然代表产品经理的目标和优先级。这也有助于解决分布式团队在无法直接访问产品负责人时所面临的问题。拥有本地代理有助于解决团队可能对功能提出的问题，而无需等待世界另一端的人在一天后做出回应。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T13:39:03.893

您可能想看看 ThoughtWorks (Martin Fowler)在进行敏捷离岸开发方面的[经验。](http://martinfowler.com/articles/agileOffshore.html)我想说的是，让敏捷适应离岸开发（或者你的离岸开发适应敏捷）当然是可能的，但这可能是一个很大的变化。您可能还想查看[Fearless Change](http://www.cs.unca.edu/~manns/intropatterns.html) - 了解将新想法引入组织的模式。听起来你面临的最大困难是对变革的抵制，而不是关于敏捷实施的技术问题。

# javascript - 输入表格时是否可以检查大写锁定按钮是否处于活动状态？

> ID：934818
> 
> 赞同：13
> 
> 时间：2009-06-01T13:28:26.663
> 
> 标签：javascript

我想知道是否有可能在填写网络表单时知道大写锁定按钮是否处于活动状态？

有时，当您被要求输入密码时，软件会注意到您处于活动状态，因此您要小心。

我本来希望在 Web 表单中做同样的事情。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-02T21:59:29.537

以下 jQuery 代码片段检测是否在按键时启用了大写锁定：

```
$('#example').keypress(function(e) { 
    var s = String.fromCharCode( e.which );
    if ( s.toUpperCase() === s && s.toLowerCase() !== s && !e.shiftKey ) {
        alert('caps is on');
    }
}); 
```

取自 StackOverflow 答案：[https ://stackoverflow.com/a/896515/1113435](https://stackoverflow.com/a/896515/1113435)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-27T06:34:20.947

有趣的是，这只适用于 keypress 而不是 keyup 和 keydown。只是要知道，这个：

```
$("#example").keypress(function(e) {
    console.log("keypress: " + e.which);
});
$("#example").keydown(function(e) {
    console.log("keydown: " + e.which);
});
$("#example").keyup(function(e) {
    console.log("keyup: " + e.which);
}); 
```

("a" press) 返回：

```
keydown: 65
keypress: 97
keyup: 65 
```

注意：尝试使用 chrome 和 firefox

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-02T21:54:46.110

尝试

```
<html>
<head>
<script type="text/javascript">
function checar_caps_lock(ev) {
    var e 

    = ev || window.event;
        codigo_tecla = e.keyCode?e.keyCode:e.which;
        tecla_shift = e.shiftKey?e.shiftKey:((codigo_tecla == 16)?true:false);
        if(((codigo_tecla >= 65 && codigo_tecla <= 90) && !tecla_shift) || ((codigo_tecla >= 97 && codigo_tecla <= 122) && tecla_shift)) {
            document.getElementById('aviso_caps_lock').style.visibility = 'visible';
        }
        else {
            document.getElementById('aviso_caps_lock').style.visibility = 'hidden';
        }
    }
    </script>
    </head>
    <body>
    <form>
    <input name="nome_do_campo" type="text" onkeypress="checar_caps_lock(event)" />
    <div id="aviso_caps_lock" style="visibility: hidden">CAPS LOCK ATIVADO</div>
    </form>

</body>
</html> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-01T13:32:01.833

像这样访问用户设置将违反任何体面的安全模型，但是您可以检查用户是否输入了 ALL_CAPS 或 aLL_CAPS 并适当地发出警告。

可以在这里找到一个优雅的解决方法：http: [//24ways.org/2007/capturing-caps-lock](http://24ways.org/2007/capturing-caps-lock)

> 可悲的是，没有办法实际检测 Caps Lock 是否直接打开。但是，有一个简单的解决方法；如果用户按下一个键，并且它是一个大写字母，并且他们没有按下 Shift 键，那么为什么他们必须打开 Caps Lock！简单的。

# c# - 我可以在没有窗口的情况下发送/接收窗口消息吗？

> ID：934820
> 
> 赞同：4
> 
> 时间：2009-06-01T13:29:18.330
> 
> 标签：c#, .net, mfc, window-handles

我正在围绕我们拥有的旧的基于 MFC 的库编写一个 .NET 包装器。它基于一个使用窗口消息发送通知的类；它有一个功能，可以让用户将句柄传递给窗口，该窗口将接收消息。

我可以只要求我的包装器的用户子类化`Control`并传递他们的控件句柄以接收消息，但这太可怕了。我希望我的包装类具有在旧库发送消息时触发的事件，然后我可以将消息解码为合理的东西。但是，我不希望我的包装类必须是一个控件。

有没有办法让我创建一个“虚拟”窗口句柄，并接收发送到该句柄的消息，而不创建一个窗口？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-01T13:36:03.917

有一个[MessageOnly Windows](http://msdn.microsoft.com/en-us/library/ms632599(VS.85).aspx#message_only)的概念可以帮助您。您可以在包装类中创建一个内部消息窗口，并将此句柄传递给旧库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T14:03:15.517

您可以尝试使用消息泵创建一个线程并将您的消息发送到该线程。然后，该线程会引发您想要在 C# 代码中处理的任何必要事件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-02T08:15:23.627

您不能在没有窗口的情况下创建窗口句柄，因为窗口句柄*是*Windows 所关心的窗口，但是您可以创建一个不设置 WS_VISIBLE 标志的窗口，并将其仅用于消息中继。我有时使用这种技术在仅 MFC 的应用程序中进行跨线程通信（不要告诉任何人；））。您可以从 CWnd 派生一个 (c++) 类，让它处理消息，并为收到的每条消息调用函数或发出信号。我想这将使它与您的 C# 代码一起使用，尽管我没有这方面的经验。

# haskell - 运行相同的haskell应用程序需要不同的时间

> ID：934821
> 
> 赞同：2
> 
> 时间：2009-06-01T13:29:21.963
> 
> 标签：haskell

我编写了一个应用程序来使用haskell 分析日志文件。当我使用相同的日志文件运行它时，有时需要 30 秒，有时需要 20 秒，执行时间最多相差 10 秒。

为什么运行时间会有如此大的差异？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T13:57:35.433

Try separating the processing time from the file-access time.

Read the entire file into memory, track that time, then process the data in your storage strucutres and track that time separately.

My gut instinct is that the file access is the random contriubtor. Gut instinct is not a good substitution for a profiler.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T13:31:07.513

这种差异很可能是由系统上同时运行的其他进程引起的。

# c - 散列函数到矩阵

> ID：934827
> 
> 赞同：3
> 
> 时间：2009-06-01T13:30:48.233
> 
> 标签：c, hash, matrix

我有两个矩阵，我需要比较它们，但我不想逐个位置比较，我认为这不是最好的方法。我想到了散列函数，有人知道如何计算矩阵的散列吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T14:02:29.293

如果您的矩阵被实现为数组，我建议使用`memcmp()`from`string.h`来确定它们是否相等。

如果涉及浮点值并且这些值来自实际计算，则无法逐个检查它们，因为您必须包含 epsilon 以适应数字错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T13:49:15.620

You can compute a hash of the whole floating point array (as a byte sequence). If you want a comparison function able to cope with small differences in the coefficients, you can compare trivial scalars and vectors computed from each matrix. It makes sense if you have to compare each matrix with more than one matrix. Examples coming to mind:

```
trace of the matrix
vector of L0, L1, L2 norms of all columns or rows
diagonal of LU factorization
tridiagonal reduction (if symmetric)
diagonal of eigenvalues (if possible)
diagonal of SVD 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T22:02:09.663

首先，哈希不会告诉你两个矩阵是否相等，只能告诉你它们是否不同；因为可能会有（而且将会有，墨菲定律总是潜伏着）碰撞。

您可以通过将任何函数链接到元素上来计算哈希...如果您可以将元素转换为整数值（不是截断，而是二进制表示），也许您可​​以对它们进行异或（但请记住，这不会'如果某些值相同但具有不同的表示形式（如 -0 和 +0 或 NaN），则不起作用。

所以我的建议是你可以预先计算某种散列函数（甚至所有元素的总和也可能是有效的）（这很重要，每次你想进行比较时计算散列是没有意义的，然后比较hashes) 来快速丢弃一些不同的矩阵，但如果 hash 相同，则必须比较每个位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T02:35:48.850

当您说*哈希*时，我想您想对矩阵进行*校验*和并比较校验和以确认相等性。假设您的每个矩阵都存储为连续的数据块，您可以计算每个块的起始地址和长度（以字节为单位），然后为两者生成校验和（因为您有时希望它们相等，长度将是相同的）。如果校验和以非常高的概率相同，则两个矩阵也相等。如果正确性很重要，一旦它们的校验和匹配，您可以在两个矩阵上运行比较循环。这样，除非很可能相等，否则您将不会调用比较成本。

[维基百科校验和参考](http://en.wikipedia.org/wiki/Checksum)

# java - 如果在 BlackBerry 中使用 GZIP 压缩数据，如何在 java 中使用 GZIP 解压缩数据

> ID：934832
> 
> 赞同：2
> 
> 时间：2009-06-01T13:32:24.017
> 
> 标签：java, blackberry, compression

我编写了一个示例程序，在黑莓中使用 GZIP 压缩和解压缩数据。该程序运行良好。我编写了一个示例程序来使用 Java 中的 GZIP 压缩和解压缩数据。该程序也可以正常工作。但如果我使用 BlackBerry 压缩数据。我无法解压缩java中的数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T18:32:57.417

如果您遵循 BlackBerry Javadocs 中为[GZIPOutputStream](http://www.blackberry.com/developers/docs/4.7.0api/net/rim/device/api/compress/GZIPOutputStream.html)提供的示例代码，它应该可以正确压缩它。

**示例代码**

```
public static byte[] compress( byte[] data )
{   
    try
    {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        GZIPOutputStream gzipStream = new GZIPOutputStream( baos, 6, GZIPOutputStream.MAX_LOG2_WINDOW_LENGTH );
        gzipStream.write( data );
        gzipStream.close();
    }
    catch(IOException ioe)
    {
        return null;
    }

    return baos.toByteArray();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T13:39:53.457

您应该尝试参考 GZIP 实现，例如 gzip 工具本身。然后，您将更好地了解您的哪些终端不符合标准。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T13:50:04.607

When you say, "I have written a sample program," do you mean you wrote your own GZIP code, or you wrote a program that uses [`GZIPInputStream`](http://java.sun.com/javase/6/docs/api/java/util/zip/GZIPInputStream.html)?

If you just want something that works, you should definitely use the core Java library.

If you are trying to satisfy your curiosity about how GZIP works and want to write your own code as a learning exercise, you'll have to provide much more detail.

# php - 如何正确工作_around_ Javascript持久性？

> ID：934838
> 
> 赞同：0
> 
> 时间：2009-06-01T13:33:22.767
> 
> 标签：php, javascript, persistence, scope, code-reuse

Javascript vars / etc具有基本的持久性。您调用一个函数/方法，下次调用相同的函数/方法时，它会保存上次的数据。

您可以在使用完这些变量后删除它们，但这消除了对该实例再次使用代码的优势。

那么在同一页面内的不同元素上编写可重用的代码的*正确方法是什么。*

因此，我需要编写代码的能力，以便我可以将它指向几个不同的元素，然后与为每个元素隔离的代码进行交互。

所以在 PHP 中（例如）我会这样做：

```
$element1 = new MyClass();
$element2 = new MyClass();
$element3 = new MyClass(); 
```

在这种情况下，它是在三个隔离范围内运行的相同代码。我怎样才能用 JS 正确地做到这一点。即使使用 jQuery 的 extend() 也会给我带来问题。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T13:37:07.033

定义局部变量时使用`var`关键字（否则它们将默认为全局变量）。

```
function foo() {
    var i;
    // code code code code
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T13:44:51.013

要在 JavaScript 中创建实例，您需要编写一个构造函数，并使用 new 调用它。例如：

```
function MyClass( somevalue ) {
   this.somevalue = somevalue;
   this.somefunction = function() {
     alert(somevalue);
   }
}

var instance1 = new MyClass(1);
var instance2 = new MyClass(2);
var instance3 = new MyClass(3); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T13:38:08.687

您可以命名您的 JavaScript 以使其与您所追求的非常相似。请参阅下面的示例。听起来您的问题确实与在您想使用局部变量的地方使用全局变量有关 - 即您声明 var myvariable; 在您的功能之外，但只想在您的功能中使用它并忘记它。在这种情况下，请在函数中声明变量以使其成为本地变量。

```
var MyNameSpace = function() {
    return {
        sayhello : function() {
            alert("hello");
        },
        saygoodbye : function() {
            alert("see ya");
        }
    };
}(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T14:21:47.177

听起来您正在寻找的是拥有类实例并拥有与每个实例相关联的私有数据的能力。

您可以使用以下技术执行此操作：

```
function Foo()
{
    // Member variable only visible inside Foo()

    var myPrivateVar;       

    // Function only visible inside Foo()

    var myPrivateFunction = function() 
                            { 
                                alert("I'm private!");
                            }

    // Member variable visible to all

    this.myPublicVar = "Hi, I'm public!";

    // Function visible to all

    this.myPublicFunction = function()   
                            {
                                myPrivateVar = "I can set this here!";
                            }
} 
```

您可以使用以下语法创建和使用其中之一：

```
var myFoo = new Foo();

myFoo.myPublicVar = "I can set this!";
myFoo.myPublicFunction(); 
```

# javascript - Icefaces actionListener 问题

> ID：934842
> 
> 赞同：0
> 
> 时间：2009-06-01T13:35:25.180
> 
> 标签：javascript, icefaces

我遇到了 Icefaces ActionListener 的问题......我需要防止在我仍然在客户端时触发 actionListener...以另一种方式：我需要在触发 actionListener 之前检查 javascript 中的布尔表达式，如果我的布尔表达式返回 false 我不想触发 actionListener，如果结果为真，我希望触发 actionListener....有没有办法做到这一点...请帮助我.... .....................

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T14:30:16.100

如果您使用的是 icefaces，最好不要在客户端尝试在 javascript 中执行此操作。您正在侦听按钮单击的动作吗？如果是按钮，请单击发送布尔表达式以及表单数据并使用验证器。如果验证器不接受数据，则不应调用 actionmethod。

# java - BeanPropertySqlParameterSource 和 Doubles

> ID：934847
> 
> 赞同：1
> 
> 时间：2009-06-01T13:35:48.223
> 
> 标签：java, spring, sybase

在 Sybase 中有一个表和一个 sproc 设置，如下所示：

创建表 testtab (f float)

create proc insert_testtab @f float 作为插入 testtab 值(@f)

还有一个包含 Double 的 java 对象

```
class TestObj { Double getF() { return 12.34; } } 
```

使用 SimpleJdbcCall & BeanPropertySqlParameterSource：

```
SqlParameterSource params = new BeanPropertySqlParameterSource(new TestObj());
SimpleJdbcCall call = new SimpleJdbcCall(dataSource).withProcedureName("insert_testtab");
call.execute(params); 
```

发生的情况是 12.0 被插入到数据库中，而不是 12.34。看起来，在幕后，BeanPropertySqlParameterSource 将数字作为 java.sql.Types.NUMERIC 传递给 sproc 并截断小数点。

谁能帮忙解释一下，这可能是 Spring 中的 Sybase 代码的问题，还是我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T17:00:52.360

最好的办法是使用 BeanPropertySqlParamterSource 对象注册属性的类型。否则，Spring 在底层 CallableStatement 上使用 setObject。这一切都由 JDBC 驱动程序实现来决定如何处理数据。类似的东西`params.registerSqlType("f", java.sql.Types.DECIMAL)`应该可以解决问题。您还需要将 params 声明为的实例`BeanPropertySqlParameterSource`才能使其工作。

# php - 在这个循环中是否存在更漂亮的替代方案？

> ID：934849
> 
> 赞同：0
> 
> 时间：2009-06-01T13:36:05.163
> 
> 标签：php, pointers, loops

```
$i=0;
while ($row=mysql_fetch_assoc()) {
if ($i==0) echo "First"
$i++;
} 
```

直接访问mysqli指针？像Iterator这样的php类？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T13:47:14.080

I’d use this:

```
if ($row = mysql_fetch_assoc()) {
    // process first item
    while ($row = mysql_fetch_assoc()) {
        // process following items
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T14:14:09.643

```
$first = true;
while ($row=mysql_fetch_assoc()) {
   if ($first) echo "First"
   $first = false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T14:40:56.250

好吧，如果我正确理解你的问题，你想要第一行，然后遍历其他行：

```
$row = mysql_fetch_assoc(); // $row contains first row

while ($row = mysql_fetch_assoc()) { // loop through the rest of the rows

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T13:56:29.290

Do not have any method for know exactly position in all moment?

for example java iterator implements next or hasNext(), if !hasNext() the item is the last.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T13:44:39.420

如果您尝试将第一个元素用于特殊用途，那么可能类似于：

```
$row=mysql_fetch_assoc();
//do stuff to first row
do {
    //do stuff to all rows (including the first)
} while ($row=mysql_fetch_assoc()); 
```

否则我不知道问题是什么，而且我不是 PHP 人......

# visual-c++ - 如何从 std::list 类禁用警告 4510 和 4610？

> ID：934854
> 
> 赞同：0
> 
> 时间：2009-06-01T13:37:53.897
> 
> 标签：visual-c++, warnings

当我在课堂上使用 std::list 时，我有一堆警告 C4510 和 C4610。这是一个警告，指出默认构造函数不可用，我想禁用它们。

当我放：

```
#pragma warning(disable: 4510) 
```

在实例化此列表的 .cpp 文件中没有任何反应。

我尝试将这个编译指示放在我实例化列表的函数周围，甚至放在 .cpp 文件的顶部，但结果是相同的 - 没有任何反应。仅当我在 .cpp 文件的属性对话框中禁用警告时才有效。我讨厌在这样的属性中隐藏东西，因为它们会被开发人员忽略。我想让它们围绕函数进行本地化。有什么我可以做的吗？

* * *

编辑：

行。这就是我的代码基本上的样子。此代码在警告级别 4 上生成警告 4510 和 4610：

```
#include <list>

class foo {
public:
    foo(int) { }
};

class bar {};

class problem_class {
    foo m_foo;
    const bar *m_bar;
public:
    problem_class(const foo &_foo, const bar *_bar) : m_foo(_foo), m_bar(_bar) { }
};

void problem_fn(std::list<problem_class> &problem_collection) {
    foo _foo(3);
    problem_collection.clear();
    problem_collection.push_back(problem_class(_foo, new bar));
}

int main(int , char **)
{
    std::list<problem_class> collection;
    problem_fn(collection);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T13:52:52.807

与其通过禁用警告来隐藏问题，不如将带有默认构造函数的类包装在具有默认构造函数*的代理类中。然后代理的默认构造函数可以对包装类进行适当的初始化。然后将代理类存储在 std::list 中。这将使您的意图明确并消除警告。

*假设您不能出于某种原因实际上使包装类具有适当的默认构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T13:57:41.750

您需要发布一些代码来准确说明您在做什么。警告 C4510 说：

> 编译器无法为指定的类生成默认构造函数，并且没有创建用户定义的构造函数。您将无法创建这种类型的对象。

这似乎与 std::list 没有任何关系，因此可能是您的代码有问题。

我知道这不是很有帮助，但是您发布的代码对我来说看起来不错，并且使用 g++ 和 comeau 编译时没有任何警告。我不再使用 VC++，所以恐怕无法提供进一步的帮助。

**进一步编辑：**纯粹本着实验的精神，如果你改变会发生什么：

```
const bar *m_bar; 
```

到

```
bar *m_bar; 
```

此警告的 MSDN 文档说：

> 有几种情况会阻止编译器生成默认构造函数，包括：
> 
> ```
> * A const data member. 
> ```

现在 m_bar 成员不是 const （它指向的是），但我想知道编译器是否对此有点困惑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T14:33:23.287

在包含之前包含#pragma`<list>`

```
#pragma warning (disable:4510)
#pragma warning (disable:4610)
#include <list> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T15:07:30.457

```
#pragma warning (disable : 4510 4610)
#pragma warning (push, 3)
#include <list>
#pragma warning (pop)
#pragma warning (default : 4510 4610) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T15:08:53.713

好的，找到了。

我的项目使用预编译的头文件，因此在 StdAfx.h 中包含的某些头文件中，有人包含列表。当我在 StdAfx.h 顶部添加 #pragma 指令时，一切正常。让我感到困惑的是，当我在 .cpp 文件中添加#pragma 时

```
#include "StdAfx.h" 
```

没有任何效果（仍然显示警告）。由于 list 包含在预编译的头文件中，因此无论稍后指定什么 .cpp 文件，它都具有相同的警告设置。

但是，奇怪的是，即使我无法覆盖 .cpp 文件中的设置，我也可以通过为同一个文件指定编译属性来覆盖它们。那有什么不同？

# javascript - 使用 JavaScript 使用 WCF，但保持它对所有客户端足够通用？

> ID：934859
> 
> 赞同：2
> 
> 时间：2009-06-01T13:38:28.280
> 
> 标签：javascript, wcf, internet-explorer, mozilla

我想为我的客户创建一个 Web 服务，以便他们可以在自己的网站上显示他们的数据。由于我不知道每个客户端运行的平台是什么，因此为所有浏览器都可以使用的 WCF 服务创建代理的最佳解决方案是什么？另外，我不确定我应该如何呈现数据。假设我的用户没有任何开发技能。我将通过其他接口让用户能够下载创建请求所需的代码，然后处理响应。在客户端解析 xml 响应然后创建数据列表或已经格式化列表（在字符串中）并让客户端执行 document.write 会更好吗？我查看了一些解决方案，但它们似乎需要使用带有脚本管理器的 ASP 页面。就像我说的，我想要一些足够通用的东西来使用不同的浏览器。主要是IE和FireFox。

丹尼尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T14:41:23.193

首先，由于您不想依赖 Microsoft Ajax ScriptManager，因此不要在 endpointBehaviors/behavior 中使用 <enableWebScript />。它是 Microsoft 特定的 JSON。

然而，幸运的是，WCF 使您的客户端可以很容易地决定他们需要 XML 还是通用 JSON。

1.  使用**<webHttp />**行为。

    <endpointBehaviors>
    <behavior name="My.WcfServices.webHttpBehavior">
    **<webHttp />**
    </behavior>
    </endpointBehaviors>

2.  [如Damian Mehers 的博客 WCF REST Services](http://damianblog.com/2008/10/31/wcf-rest-dynamic-response/ "WCF REST 服务")中所述，创建自定义 WebServiceHost 和自定义属性特性 。在 Mehers 的代码中，类型由请求内容类型决定。您可能希望扩展它以检查 URL，例如 .xml 或 .json 或 ?format=xml|json。

3.  在**SerializeReply**方法中，检查 URL。

    消息请求 = OperationContext.Current.RequestContext.RequestMessage；
    Uri url = request.Properties["OriginalHttpRequestUri"] as Uri;
    // 检查 ?format 查询字符串
    System.Collections.Specialized.NameValueCollection colQuery = System.Web.HttpUtility.ParseQueryString(url.Query);
    字符串 strResponseFormat = colQuery["format"];
    // 或者检查扩展
    字符串 strResponseFormat = url.LocalPath.Contains(".json") ？“json”：“xml”；

4.  定义你的方法

    [OperationContract]
    [WebGet(UriTemplate="Hello.{responseFormat}")] // 或 "Hello?format={responseFormat}"
    [DynamicResponseType]
    public string Hello(string responseFormat)
    {
    return "Hello World";
    }

示例 URL：
[http://localhost/myrest.svc/Hello.xml](http://localhost/myrest.svc/Hello.xml)
[http://localhost/myrest.svc/Hello.json](http://localhost/myrest.svc/Hello.json)
或
[http://localhost/myrest.svc/Hello?format=xml](http://localhost/myrest.svc/Hello?format=xml)
[http://localhost /myrest.svc/Hello?format=json](http://localhost/myrest.svc/Hello?format=json)

5.  JSON 和 XML 都易于跨浏览器使用。诸如用于 JSON 的 jQuery 和用于 XML 的 Sarissa 之类的库使其变得更加容易。

注意：如果您看到错误“找不到与具有绑定 WebHttpBinding 的端点的方案 http 匹配的基地址。”，添加**baseAddressPrefixFilters**元素并将 localhost（或任何您的域）添加到 IIS 主机头名称。

```
<system.serviceModel>
<serviceHostingEnvironment aspNetCompatibilityEnabled="true">
    <baseAddressPrefixFilters>
        <add prefix="http://localhost"/>
    </baseAddressPrefixFilters>
</serviceHostingEnvironment> 
```

# javascript - IE7 中的 window.location.hash 问题

> ID：934865
> 
> 赞同：6
> 
> 时间：2009-06-01T13:39:49.230
> 
> 标签：javascript, internet-explorer, internet-explorer-7

我们有一个 javascript 函数，它应该使用锚点将页面“移动”到某个位置。这个功能只是做`window.location.href = "#" + hashName`。这适用于FF，但不适用于IE。我在 Windows XP 下使用 IE7 测试了这段代码。我已经尝试过`using window.location.href`,`window.location.hash`和`window.location.replace`所有这些方法，但是使用`document`object. 有谁知道如何处理这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T15:17:23.760

IE 和大多数其他浏览器将使用 anchor.focus() 滚动到锚点，或者使用 element.scrollIntoView(true) 滚动到具有 id 的任何元素

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T15:42:42.053

我刚刚在Vista下的IE7中测试过这个问题，也许这个问题只存在于XP下的IE7中？因为这在 IE7、Chrome 和 Firefox 中对我来说很好用：

```
 window.location.hash = hashName; 
```

如果这真的不起作用，那么我们可以按照 Kennebec 的建议使用 scrollIntoView 。

```
 function scrollToAnchor(anchorName){
   //set the hash so people can bookmark
   window.location.hash = anchorName;
   //scroll the anchor into view
   document.getElementsByName(anchorName)[0].scrollIntoView(true);
 } 
```

像这样使用：

```
 <script type='text/javascript'>scrollIToAnchor('foo');</script>
 <a name='foo'></a>
 <p>I will be scrolled into view</p> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T13:42:50.173

你试过改变`location.hash`吗？

```
window.location.hash = "#" + hashName; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-19T15:01:41.187

我也遇到了一个问题

[http://artur.ejsmont.org/blog/content/window-location-hash-difference-in-ff3-and-opera](http://artur.ejsmont.org/blog/content/window-location-hash-difference-in-ff3-and-opera)

# jquery - jQuery Tablesorter 的自定义解析器

> ID：934867
> 
> 赞同：10
> 
> 时间：2009-06-01T13:40:01.507
> 
> 标签：jquery, tablesorter

我正在使用[jQuery Tablesorter](http://tablesorter.com/)，并且解析器应用于表列的顺序存在问题。我正在添加一个自定义解析器来处理 $-3.33 形式的货币。

```
$.tablesorter.addParser({
    id: "fancyCurrency",
    is: function(s) {
      return /^\$[\-]?[0-9,\.]*$/.test(s);
    },
    format: function(s) {
      s = s.replace(/[$,]/g,'');
      return $.tablesorter.formatFloat( s );
    },
    type: "numeric"
}); 
```

问题似乎是内置货币解析器优先于我的自定义解析器。我可以将解析器放在表格排序器代码本身中（在货币解析器之前），它可以正常工作，但这不是很容易维护。我无法使用以下方式手动指定分拣机：

```
headers: {
    3: { sorter: "fancyNumber" },
    11: { sorter: "fancyCurrency" }
} 
```

因为表格列是从用户输入动态生成的。我想一个选择是指定排序器用作css类并使用一些JQuery来明确指定一个排序器，就像[这个问题](https://stackoverflow.com/questions/889117/adding-metadata-parser-to-a-table-header)所暗示的那样，但如果可能的话，我更愿意坚持使用动态检测。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-09T03:21:01.493

第一个选项是为具有货币值的列提供附加类“{'sorter':'currency'}”。还要确保包含 tablesorter 支持的插件元数据。这将引入每个元素选项并明确告诉 tablesorter 如何排序。

```
<link rel="stylesheet" href="/css/jquery/tablesorter/green/style.css" />
<script src="/js/jquery-1.3.2.js"></script>
<script src="/js/jquery.ui.core.js"></script>
<script src="/js/jquery.metadata.js"></script>
<script src="/js/jquery.tablesorter.js"></script>

<script>
    $(document).ready(function()
    {
    $("#table").tablesorter();
    }
    );
    </script>
</head>
<table id="table" class="tablesorter">
<thead>
  <tr>
    <th class="{'sorter':'currency'}">Currency</th>
    <th>Integer</th>
    <th>String</th>
  </tr>
</thead>
<tbody>
<tr>
  <td class="{'sorter':'currency'}">$3</td>
  <td>3</td>
  <td>three</td>
</tr>
<tr>
  <td class="{'sorter':'currency'}">-$3</td>
  <td>-3</td>
  <td>negative three</td>
</tr>
<tr>
  <td class="{'sorter':'currency'}">$1</td>
  <td>1</td>
  <td>one</td>
</tr>
</tbody>
</table> 
```

此外，格式化货币的函数存在一个错误：它不处理负数。

我已经提交了一个[错误](http://plugins.jquery.com/node/8547)，并且正在努力登陆一个补丁。

第二个选项是将此修复应用到您的 tablesorter 副本。应用修复后，您无需在 th 或 td 中指定货币分类器（在 td 中指定无论如何都过分了）。

> 编辑 jquery.tablesorter.js 的第 724 行：
> 
> return $.tablesorter.formatFloat(s.replace(new RegExp(/[^0-9.]/g),""));
> 
> 改成：
> 
> return $.tablesorter.formatFloat(s.replace(new RegExp(/[^-0-9.]/g),""));
> 
> 案子：
> 
> *   值：$-3、$1、$3
>     
>     
> *   当前升序：$1,$3,$-3
>     
>     
> *   预期升序订单 $-3,$1,$3
>     
>     
> 
> 案子：
> 
> *   值：-$3,$1,$3
>     
>     
> *   当前升序：$1,$3,-$3
>     
>     
> *   预期升序订单 $-3,$1,$3

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T14:07:12.370

我遇到了类似的问题，并发现了[`textExtraction`](http://tablesorter.com/docs/example-option-text-extraction.html)当您的单元格包含标记时推荐的选项。但是，它作为预格式化程序非常好用！

```
$('table').tablesorter({
  textExtraction: function(s) {
    var text = $(s).text();
    if (text.charAt(0) === '$') {
      return text.replace(/[^0-9-.]/g, '');
    } else {
      return text;
    }
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-03T10:54:49.603

我用过这样的东西，它对我有用。

在标题 < th class="{'sorter':'digit'}"> 和列 < td class="{'sorter':'digit'}"> 中使用此类。

完成后，更改 javascript 代码以获取所有数字形式的货币。

它完成了，享受排序！

这是代码：

标题：

```
 <th style='width: 98px;' class="{'sorter':'digit'}">
            Amount
   </th> 
```

栏目（待定）：

```
 <td align="left" style='width: 98px;' class="{'sorter':'digit'}">
            <%= Convert.ToDouble( a.AMOUNT ?? 0.0).ToString("C3") %>
 </td> 
```

JAVASCRIPT：

```
<script language="javascript" type="text/javascript">
  jQuery("#rewardtable").tablesorter({
    textExtraction: function (data) {
        var text = $(data).text();
        if (text.toString().indexOf("-$") != -1) {
            return ("-" + text.replace(new RegExp(/[^0-9.]/g), ""));
        }
        else if (text.toString().indexOf("$") != -1) {
            return (text.replace(new RegExp(/[^-0-9.]/g), ""));
        }
        else {
            return text;
        }
    }
  }); 
```

# sql-server - SQL Server 2005 链接到访问

> ID：934869
> 
> 赞同：1
> 
> 时间：2009-06-01T13:40:29.260
> 
> 标签：sql-server, ms-access

我正在使用 Access 97 数据库。它有很多表格。数据堆积如山。我必须快速升级它。我购买了 SQL Server 2005 企业版。

我想使用 SQL Server 作为数据持有者。我将定期使用 Access 表单。我只想将数据导出到sql server。

是否可以使用“链接”数据存储？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T22:50:39.410

虽然我同意 HLGEM 的第一段，但我恭敬地不同意 HLGEM 的第二段。您需要了解一些我不太了解的怪癖。例如将布尔字段更改为 LittleInt。但除此之外，重新创建数据库模式是一项繁琐的工作。而且它很容易出错，例如缺少索引或关系。

SQL Server 组中有一个工具比升迁向导要好得多，尤其是 Access 97 版本。SQL Server Migration Assistant for Access (SSMA Access) [http://www.microsoft.com/sql/solutions/migration/access/default.mspx](http://www.microsoft.com/sql/solutions/migration/access/default.mspx)

当您发现这些怪癖时，您可以更改脚本以通过适当的更改重新创建数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T02:30:14.367

我同意[Tony Toews](https://stackoverflow.com/questions/934869/sql-server-2005-links-to-access/937191#937191)（你应该相信他，他是 Access 专家）：使用 SSMA 帮助你将数据移动到 SQL Server，它比 Access 中集成的升迁向导做得更完整（这不起作用无论如何升级到 SQL Server 2008）。

不过，您必须警惕一些警告；我写了[一篇](http://blog.nkadesign.com/2009/access-building-upsizable-applications/)关于你应该检查的事情的博客文章。
关键是，如果最初的 Access 数据库的设计没有过多地依赖 Access 允许的自由（例如，表和列名中的奇怪字符），那么这个过程会容易得多。
请特别注意 SSMA 报告的所有警告和错误，它们对于帮助您专注于*必须*解决的问题非常有用。

就性能而言，迁移到 SQL Server 不一定会使事情变得更快。
在某些领域，它实际上会更慢，有时会慢得多：
Access 非常擅长优化某些形式的数据访问，但是一旦数据库超出其范围，它就没有那么多的控制权。
大多数事情都会正常工作。

您可能必须重写一些查询，可能将它们作为 SQL Server 上的视图移动，而不是将它们保留在您的 Access 应用程序中。
诸如在查询中使用`%`而不是作为通配符之类的小事情在其子句中使用也会导致奇怪的问题，例如查询不返回任何记录。`*``LIKE``WHERE`

By the way, I'll post a very good resource Tony has on his own website regarding SQL upsizing: [*My random thoughts on SQL Server Upsizing from Microsoft Access*](http://www.granite.ab.ca/access/sqlserverupsizing.htm).

There is also a good and detailed read about things to consider when using SQL Server from Access: [*Optimizing Microsoft Office Access Applications Linked to SQL Server*](http://msdn.microsoft.com/en-us/library/bb188204.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T13:55:08.323

您可以添加要作为链接表访问的 SQL Server 表。然后，您将要开始查看最慢的查询并将它们转换为存储过程。

不要使用 Access 中的升级向导来创建 SQl Server 表，因为它会为数据类型做出糟糕的选择。自己完成工作以创建脚本，选择最佳数据类型。这种方式需要更长的时间，但您的数据库会表现得更好，并且您将更好地了解如何在 SQL Server 中执行操作。您应该立即开始，学习通过脚本而不是从 GUI 来完成所有事情。最好从一开始就学习 SQL Server 的良好习惯。

# .net - 使用 StackPanel 作为 ContentControl (WPF)

> ID：934873
> 
> 赞同：5
> 
> 时间：2009-06-01T13:41:30.597
> 
> 标签：.net, wpf, xaml, itemscontrol, stackpanel

所以我有一个 StackPanel，用作 ContentControl。我有一个地方，我希望根据我绑定的数据生成按钮，这一切都很好，但我希望按钮水平布局，而不是像当前正在发生的那样垂直布局。这是一个屏幕截图：

![替代文字](https://img.photobucket.com/albums/v428/acousticshredder/releaseButtons.jpg)

这是我的 ContentTemplate 描述中的代码：

```
<StackPanel Name="wpReleaseButtons" Orientation="Horizontal" Grid.Row="2">
    <ItemsControl IsTabStop="False" ItemsSource="{Binding Path=BranchCommands}">
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <Button Tag="{Binding}" Padding="3">
                     <TextBlock Text="{Binding Path=DisplayValue}" />
                </Button>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
</StackPanel> 
```

不知道我在这里做错了什么。任何信息，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T14:03:46.373

我会说它看起来像是`ItemsControl`垂直显示按钮的东西。如果您希望 中的按钮`ItemsControl`是水平的，那么您需要位于`StackPanel`中`ItemsControl` `ItemsPanelTemplate`，而不是像您的代码中那样相反：

```
<ItemsControl IsTabStop="False" ItemsSource="{Binding Path=BranchCommands}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <Button Tag="{Binding}" Padding="3">
                <TextBlock Text="{Binding Path=DisplayValue}" />
            </Button>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <StackPanel Orientation="Horizontal"/>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
</ItemsControl> 
```

我可能有点错误，`ItemsControl.ItemsPanel`因为我没有任何数据来测试它......

**编辑：**除了 Bea 参考之外，[WPF 博士](http://drwpf.com/blog/Home/tabid/36/EntryID/28/Default.aspx)还有一些好东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T13:52:20.327

我看不到你的图片（它被我公司的防火墙阻止了），但无论如何我都走了......

您的 'Orientation="Horizo​​ntal"' 可能正在正常工作：它只包含一个子元素，一个 ItemsControl。相反，请尝试为您的 ItemsControl 创建一个 ControlTemplate，其中 ControlTemplate 包含一个带有 Orientation="Horizo​​ntal" 的 StackPanel。

希望这可以帮助！

**编辑：**

再一次，Bea 给出了一个答案/例子！

[http://bea.stollnitz.com/blog/?p=10](http://bea.stollnitz.com/blog/?p=10)

# visual-studio - 如何使用 TFS 离线工作

> ID：934875
> 
> 赞同：104
> 
> 时间：2009-06-01T13:42:47.927
> 
> 标签：visual-studio, tfs

我们的 TFS 服务器现在有一些暂时的连接问题，因此 VS 没有响应，导致 50 多个开发人员无法工作！

如果出现此类问题，是否可以将 TFS 切换到离线模式？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-06-01T13:48:05.997

有关如何从源代码管理绑定/取消绑定您的解决方案或项目的信息，请参阅此[参考。](http://msdn.microsoft.com/en-us/library/6ka7d2dw.aspx)注意：这不适用于您使用 GIT 并且可能不适用于 VS2008 之后的版本。

引用参考：

> 断开解决方案或项目与源代码管理的连接
> 
> 1.  在 Visual Studio 中，打开解决方案资源管理器并选择要断开连接的项目。
>     
>     
> 2.  在“文件”菜单上，单击“源代码管理”，然后单击“更改源代码管理”。
>     
>     
> 3.  在更改源代码管理对话框中，单击断开连接。
>     
>     
> 4.  单击确定。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2011-02-26T07:37:46.853

“脱机”扩展在源代码管理菜单中添加了一个按钮。

[https://visualstudiogallery.msdn.microsoft.com/6e54271c-2c4e-4911-a1b4-a65a588ae138](https://visualstudiogallery.msdn.microsoft.com/6e54271c-2c4e-4911-a1b4-a65a588ae138)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-02-02T22:29:44.070

plundberg：“断开连接”按钮仅适用于从 VS 2008 开始的 TFS 提供程序。即便如此，我也不确定它是否得到官方支持。使用“脱机”功能的推荐方法是[重新]打开解决方案。

Martin Pritchard：如果你在运行过程中卡住了，你可以通过拔出网络插头（字面意思）或运行**ipconfig /release**来强制 VS 超时。

一旦您被标记为离线，以下是在该模式下工作的分步指南：http: [//teamfoundation.blogspot.com/2007/12/offline-and-back-again-in-vs2008.html](http://teamfoundation.blogspot.com/2007/12/offline-and-back-again-in-vs2008.html)

有关调整幕后行为的更多详细信息：http: [//blogs.msdn.com/benryan/archive/2007/12/12/when-and-how-does-my-solution-go-offline.aspx](http://blogs.msdn.com/benryan/archive/2007/12/12/when-and-how-does-my-solution-go-offline.aspx) [http://blogs.msdn.com/benryan/archive/2007/12/12/how-to-make-tfs-offline-strictly-solution-based.aspx](http://blogs.msdn.com/benryan/archive/2007/12/12/how-to-make-tfs-offline-strictly-solution-based.aspx)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-03-28T07:12:57.600

为此目的，有几个小的视觉工作室扩展：

1.  对于 VS2010 和 TFS 2010，试试[这个](http://visualstudiogallery.msdn.microsoft.com/425f09d8-d070-4ab1-84c1-68fa326190f4)
2.  对于 VS2012 和 TFS 2010，使用[这个](http://visualstudiogallery.msdn.microsoft.com/6e54271c-2c4e-4911-a1b4-a65a588ae138)

对于 TFS 2012，看起来不需要“离线”扩展。出于类似的目的，我阅读了一些关于名为*本地工作区的新功能。*

或者，我在[Git-TF](http://gittf.codeplex.com/wikipage?referringTitle=Documentation)上取得了很好的成功。git 的所有优点，当你准备好时，你可以将它推送到 TFS。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-02-02T19:57:36.327

根据您打开的工具窗口，VS 可能会或可能不会在启动时尝试自动访问团队服务器。

为获得最佳效果，请尝试以下操作：

1.  关闭visual studio的所有实例
2.  打开一个空的视觉工作室（没有项目/解决方案）
3.  查看默认打开哪些窗口，如果源代码管理资源管理器或团队资源管理器或任何其他使用团队的窗口默认打开（并激活），关闭它们或将它们切换到后台选项卡。
4.  关闭视觉工作室

您现在应该注意到，您可以启动 Visual Studio，而无需尝试访问 TFS 服务器。

我知道这只是您的问题的一个旁白，但我希望这对您有所帮助！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-06-09T15:09:55.470

如果您打开了解决方案，并且 TFS 已关闭，则您可能无法进入离线模式。如果您关闭并重新打开解决方案，将出现一个漂亮的小对话框，询问您是否要脱机。

或者，如果您不想关闭/重新打开解决方案，（如[Bernie 建议的那样](https://stackoverflow.com/a/5125700/61697)），您可以安装[TFS Go-Offline 插件](https://visualstudiogallery.msdn.microsoft.com/6e54271c-2c4e-4911-a1b4-a65a588ae138)，然后单击：

```
TEAM -> Go Offline 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-11-07T08:46:13.793

只需在本地计算机中更改解决方案的根文件夹名称，它将自动断开连接。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-07-30T03:29:27.687

我只是想包含一个链接，以解决我在使用 VS2008 和 TFS08 时遇到的问题。

我不小心打开了我的解决方案而没有连接到我的网络，并且无法“恢复原状”，每次打开时都必须重新绑定。

我在这里找到了解决方案； [http://www.fkollmann.de/v2/post/Visual-Studio-2008-refuses-to-bind-to-TFS-or-to-open-solution-source-controlled.aspx](http://www.fkollmann.de/v2/post/Visual-Studio-2008-refuses-to-bind-to-TFS-or-to-open-solution-source-controlled.aspx)

基本上，您需要打开“连接到 Team Foundation Server”，然后打开“服务器...”，删除/删除您的服务器并重新添加它。这解决了我的问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-11-26T21:06:26.120

如果用户已经检查了代码，如果离线并且他们的本地硬盘上有最新版本，那么他们只需要浏览到解决方案位置并通过双击 sln 文件打开解决方案。该解决方案将以断开连接模式打开。

# clickonce - ClickOnce 如何将 app.config 从开发更改为部署？

> ID：934877
> 
> 赞同：4
> 
> 时间：2009-06-01T13:43:13.417
> 
> 标签：clickonce

我有一个开发 app.config 和一个部署 app.config。我需要 clickonce 在部署时更改它。这可以自动完成吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T17:49:58.537

如果您不想重新构建您的应用程序，您可以尝试这种直接在已部署文件上工作的方法。

作为我们测试工作流程的一部分，我们经常设置同一应用程序的多个部署，只是`.config`文件中的差异。我们真的不希望每次想要使用不同的配置文件添加新部署时都必须重新发布。由于 ClickOnce 要求对所有内容进行签名和哈希处理，因此不可能仅更改`myapp.exe.config.deploy`文件内容并期望一切正常。因此，您可以做的是`mage.exe`在进行更改后使用更新您的清单。

如前所述[，](http://www.eggheadcafe.com/tutorials/xaml/a8788ed5-c1b5-41d5-b49c-ea4760c3b820/update-configuration-of-a-clickonce-wpf-application-using-mage-or-mageui.aspx)您基本上需要做的是：

首先，转到部署目录中的“Application Files\MyApp_1_2_3_4\”目录

您必须将所有文件重命名`something.extension.deploy`为`something.extension`

然后运行：

```
mage -Update "Application Files\MyApp_1_2_3_4\myapp.exe.manifest"
mage -Sign "Application Files\MyApp_1_2_3_4\myapp.exe.manifest" -CertHash my_ceritficate_thumbnail 
```

然后将文件重命名为原始名称（添加`.deploy`扩展名）

最后，运行：

```
mage -Update MyApp.xbap -appmanifest "Application Files\MyApp_1_2_3_4\myapp.exe.manifest"
mage -Sign MyApp.xbap -CertHash my_certificate_thumbnail 
```

或者，为避免重命名文件，您可以告诉 Visual Studio`.deploy`在发布时不要添加扩展名（转到 Visual Studio 项目中的发布...选项），下次发布时，文件将不会获得该扩展名。我对这种危险的唯一猜测是某些用户在尝试下载`.exe`或`.dll`文件时遇到防火墙问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-13T19:48:50.213

一种简单的方法是将 app.config 文件复制到您可以在应用程序的属性页*Build events*中定义的预构建脚本中。

你可以这样做：

1）创建一个仅用于部署到生产的解决方案配置，并在脚本中打开它，例如

```
if  ($(ConfigurationName)) == (PublishConfig) call ReplaceAppConfig.cmd 
```

或者，如果您只在特定机器上构建发布配置：

2）始终在预构建事件中运行脚本：

```
call CheckAndReplaceAppConfig.cmd 
```

并且 CheckAndReplaceAppConfig.cmd 在这种情况下将具有：

```
IF (%MACHINENAME%)==(PUBLISH_SERVER) ReplaceAppConfig.cmd 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-16T17:03:39.140

我认为这是一种更好的方法：

[http://blogs.msdn.com/b/vsto/archive/2010/03/09/tricks-with-app-config-and-clickonce-deployment-saurabh-bhatia.aspx](http://blogs.msdn.com/b/vsto/archive/2010/03/09/tricks-with-app-config-and-clickonce-deployment-saurabh-bhatia.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T13:52:53.697

如果您使用的是 VS 工具，那么配置文件都是部署的签名部分的一部分。因此，最好的方法是通过您的*构建*工具 - 即使用 dev/live/etc 配置文件构建不同的版本。

使用 3.5SP1，您可以[选择退出签名](http://weblogs.asp.net/scottgu/archive/2008/05/12/visual-studio-2008-and-net-framework-3-5-service-pack-1-beta.aspx)；我不知道您是否可以通过 IDE 执行此操作 - 如果您手动（通过法师）执行此操作，大概可以执行此操作，但这是更多的工作......

# iphone - 静态数据的属性列表或sqlite？

> ID：934878
> 
> 赞同：10
> 
> 时间：2009-06-01T13:43:29.813
> 
> 标签：iphone, sqlite, plist

是否有任何“最佳实践”方法来存储iPhone 应用程序的持久**静态数据？**

我有一个应用程序可以读取大约 1000 个项目的字典，其中许多是数组。我开始为此使用单个 plist，但它变得有些笨拙，尤其是因为许多值都是 HTML 字符串。

我有更好的方法来解决这个问题吗？我计划显着扩展这个应用程序，我显然不想在中途改变我的方法。

我已经搜索了`iphone data storage`各种变体，但没有找到任何内容，甚至涉及到最佳实践。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-01T14:08:54.380

听起来您打算与您的应用程序一起分发一些数据。属性列表可能是最容易维护的，但它会一次全部加载到内存中。这可能会占用大量设备的内存。

另一方面，sqlite 数据库将仅加载您请求的数据。我不确定您的数据是如何构造的，但是您可以很容易地使用单个数据库表创建键值对。（带有一`key`列和一`value`列的单个表）然后，如果是我，我会编写一个 Objective-C 类来包装数据库查询，这样我就可以编写简单的语句，例如：

```
NSString *welcomeText = [[MyData sharedData] dataWithKey:@"WelcomeText"]; 
```

首先将数据放入数据库并不难。您可以使用命令行`sqlite3`实用程序批量加载数据。有一个命令`.import`可以从文本文件中导入您的数据。

希望这能让你朝着正确的方向前进！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T14:17:22.490

我会选择一个 sqlite 解决方案。我现在正在做的应用程序，只是帮助我学习 iPhone 开发的应用程序，大部分都使用 sqlite。我使用 Firefox 的 sqlite 插件来帮助维护数据库，效果非常好。[https://addons.mozilla.org/en-US/firefox/addon/5817](https://addons.mozilla.org/en-US/firefox/addon/5817)

正如 Alex 建议的那样，使用包装类也是最好的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T20:35:27.640

不要忘记在 3.0 中，您可以在 SQLlite 周围使用 CoreData 层，这可能会使它对您更有吸引力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T07:43:06.340

如果您不需要存储有关数据的任何关系信息，为什么不直接使用文件呢？会浪费一些文件系统空间，但纯文件可能是最节省内存和 CPU 的解决方案，具体取决于项目的大小和数量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T13:46:00.370

我从未开发过 iPhone 应用程序，但我在文件系统中玩过。我已经看到 sqlite 数据库在手机的各个地方浮动。我很确定它使用 sqlite 数据库来存储您的日历条目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T13:46:16.547

我会使用sqlite。它已经存在，易于使用，并将为未来的扩展提供最灵活的路径。

我一直在我的 iPhone 应用程序中使用 sqlite 来处理静态数据。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T13:50:35.447

我所做的只是在应用程序关闭时保存状态。我为此使用了一个文件。

sqlite 听起来非常适合您的应用程序。sqlite 很简单。我在 Adob​​e AIR 应用程序中使用过它。

# ruby - 在乘客中运行 gem 服务器

> ID：934880
> 
> 赞同：1
> 
> 时间：2009-06-01T13:44:14.070
> 
> 标签：ruby, rubygems, passenger, rack, rdoc

我在 Apache/passenger 中运行了一些 rails/rake 应用程序，我想将由这些应用程序提供的文档应用程序添加`gem server`到这些应用程序中，所以我可以轻松地给它一个特殊的（子）域，比如 docs.example.org，所以它是我们团队的所有成员都可以轻松使用，没有人需要自己启动服务器或记住端口号（如 8808，默认`gem server`端口）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-08T04:05:02.787

我建议查看 bdoc 而不是`gem server`，它允许用户在没有服务器运行的情况下访问他们所有的 gem 文档。修改 bdoc 以输出到特定目录也很简单，然后您可以轻松添加一个步骤来重新生成文档。

将它们放在静态文件中的好处是 apache 配置非常简单。

如果您确实想将 bdoc 输出到特定目录，请查看[此行](http://github.com/manalang/bdoc/blob/f7bb81ff800c8c79878d6f4771e9bd0ef9976be4/lib/bdoc.rb#L62)。

编辑：

实际上，我继续[在 github 上进行了分支](http://github.com/csexton/bdoc/tree/master)并进行了更改。现在您可以在命令行上提供输出目录，它将为您生成静态 rdoc 页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-06T17:32:43.200

我正在我的机器上运行[http://gems.local](http://gems.local)，以防我想离线进行一些 Ruby 破解。（平原旅行，火车等）。

这真的很容易，您实际上可以在本地运行所有 Ruby gems 文档的乘客，而无需访问网络。

我按照 Jason 的提示进行操作，一切正常。请参阅以下文章，您应该准备好了：

[http://jasonseifer.com/2009/02/22/offline-gem-server-rdocs](http://jasonseifer.com/2009/02/22/offline-gem-server-rdocs)

阿提拉

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-29T05:25:44.827

我写了一篇关于我如何在本地使用 yard 服务器和 nginx 在 mac os x 中拥有我的 gems、ruby、rails 和 jquery 文档的博客文章。linux 的步骤几乎相同，唯一不同的是配置守护进程的方式。

[https://makarius.posterous.com/offline-rails-ruby-jquery-and-gems-docs-with](https://makarius.posterous.com/offline-rails-ruby-jquery-and-gems-docs-with)

# mysql - MySQL：为每个日期选择不同的名称？

> ID：934885
> 
> 赞同：2
> 
> 时间：2009-06-01T13:45:23.320
> 
> 标签：mysql, mysql4

假设我想选择日期范围或 date_feild > 2009-06-01 && date_field < 2009-07-01 的行。我想选择 first_name_field 和 last_name_field 但我只希望每个日期显示一次相同的名称 (F+L)。所以同一个名字可以出现多次，只要他们的日期不同；但如果名称在同一日期，则不会。这有意义吗？我们正在尝试跟踪我们在一段时间内收到了多少查询，但如果同一用户在同一天进行了多次查询，我们希望将其计为 1。

我什至还没有开始编程，所以我愿意接受所有建议。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T13:49:34.543

使用[GROUP BY](http://dev.mysql.com/doc/refman/5.0/en/group-by-modifiers.html)

```
SELECT date,name FROM table GROUP BY date,name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T13:51:41.030

在 mySQL 中不知道，但在 SQL Server 中您可以使用 COUNT DISTINCT。

```
SELECT
    date_field,
    COUNT(DISTINCT first_name + last_name)
FROM
    YourTable
GROUP BY
    date_field 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T13:52:34.537

答案在您的问题中：

```
select distinct date, concat(first_name, ' ', last_name) from table 
```

# telerik - RadGrid 上的客户端绑定

> ID：934888
> 
> 赞同：0
> 
> 时间：2009-06-01T13:46:56.360
> 
> 标签：telerik, radgrid

我正在寻找一种方法来呈现网格或使用 xml 客户端数据执行需要数据源事件之类的事情我的意思是使用客户端数据绑定和呈现网格任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T14:53:02.670

查看 RadGrid QSF 的使用数据填充 -> 客户端绑定部分下的演示。

迪克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T08:37:25.633

看看[客户端绑定演示](http://demos.telerik.com/aspnet-ajax/grid/examples/client/databinding/defaultcs.aspx)。

# java - JNA Passing Structure By Reference Help

> ID：934897
> 
> 赞同：4
> 
> 时间：2009-06-01T13:49:49.380
> 
> 标签：java, c, struct, pass-by-reference, jna

I'm trying to use JNA to talk over a USB device plugged into the computer. Using Java and a .dll that was provided to me. I am having trouble with the Write function:

C code:

```
typedef struct {
    unsigned int id;
    unsigned int timestamp;
    unsigned char flags;
    unsigned char len;
    unsigned char data[16];
} CANMsg;

CAN_STATUS canplus_Write(
        CANHANDLE handle, //long
        CANMsg *msg
    ); 
```

Java Equivalent:

```
public class CANMsg extends Structure{
    public int id = 0;
    public int timestamp = 0;
    public byte flags = 0;
    public byte len = 8;
    public byte data[] = new byte[16];
}

int canplus_Write(NativeLong handle, CANMsg msg); 
```

I have confirmed that I can open and close the device. The close requires the NativeLong handle, so i am assuming that the CANMsg msg is the issue here. I have also confirmed that the device works when tested with C only code.

I have read the the JNA documentation thoroughly... I think. Any pointers. Thanks all.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-29T17:44:52.750

len 是结构的大小吗？如果是; 那么你给出的值是错误的。做这个：

```
CANMsg msg = new CANMsg();
msg.len = msg.size(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-06T16:48:59.787

我也遇到了 canplus_write 接口的问题。到目前为止，一切都指向提供的驱动程序中的错误——我认为新的 USBCANPlus 模块还没有经过适当的测试阶段。从您的代码中，我可以看到您使用的是旧版本的驱动程序，因为数据字段应包含 8 个字节（这是 CAN 消息中的最大数据字节数）。我通过自己的调查发现，驱动程序无法将数据正确转换为 ASCII 字符，即如果您要发送 01 02 03，它将向模块发送 ASCII 字符 '1' '2' '3' '0' '1' '0' '2' '0' '3' - 你可以使用USB监控软件来验证这一点。

希望这也能解决您的问题，我也建议您与他们联系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T17:48:45.587

我对 JNA 了解不多，但是当指针作为简单地址传输时，语言间数据传输通常会失败。

如果它指向您要发送的数据，则可能在某处有一个打包方法调用。如果您不是自己编写的，那么它可能是由这个 JNA 框架生成的......将它添加到您的问题中可能很有用。

将 C 字符映射到 Java 字节对我来说也有点奇怪，但我可以看到它的来源。您在什么操作系统上运行此代码？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-10T13:17:34.853

我对您正在使用的 dll 一无所知，但 CANMsg.len 很可能指的是 byte[] 数据中实际有多少字节。因此，您要么需要跟踪写入 byte[16] 数据数组的数量，要么根据终止的 null char 计算 len（假设 String ASCII 是数据）。我不认为 CANMsg.size() 存在或像上面的 Rusty 建议的那样实现。

# javascript - Should I bring HTML snippets or JSON?

> ID：934898
> 
> 赞同：2
> 
> 时间：2009-06-01T13:49:59.287
> 
> 标签：javascript, html, ajax

Please note: this is not exactly same as [this question](https://stackoverflow.com/questions/867163/the-ajax-response-data-json-xml-or-html-snippet). Although it looks like that, I have some very specific requirements.

In my application, I have two panels to update with a single AJAX request. Currently, I am sending JSON, and constructing two DOMs in JS and appending them in corresponding places.

This is becoming difficult to maintain, and much processing is happening on the client side. So, I am thinking of sending HTML code snippet.

The problem here is that I have two panels, and with a single AJAX request, how should I bring two different HTML snippets for different panels?

Also: -

1) I am sending the AJAX request periodically after each 30 seconds, and also sending a CRC-32 of the data in the JSON. So, if there is no change in the data I don't have to recreate the DOM.

2) Replacing the old HTML, with new HTML suddenly flickers the page.

3) Each panel can have dynamic number of rows, and I have to attach some events from JavaScript side to each row. For this, it is easier if I have data in JSON format. But if I am switching to HTML snippet, how to do this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T14:26:38.243

[铁燧石](http://malsup.com/jquery/taconite/)是你应该研究的东西。它通过一个请求更新多个 HTML 块。

[http://malsup.com/jquery/taconite/](http://malsup.com/jquery/taconite/)

# c# - .Net Console Application that Doesn't Bring up a Console

> ID：934901
> 
> 赞同：22
> 
> 时间：2009-06-01T13:50:19.300
> 
> 标签：c#, .net, vb.net, console, console-application

I have a console application I'm using to run scheduled jobs through windows scheduler. All the communication to/from the application is in email, event logging, database logs. Is there any way I can suppress the console window from coming up?

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-06-01T13:51:18.253

Sure. Build it as a winforms app and never show your form.

Just be careful, because then it's not really a console app anymore, and there are some environments where you won't be able to use it.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-01T13:58:17.960

借自 MSDN（[链接文本](http://social.msdn.microsoft.com/forums/en-US/csharpgeneral/thread/ea8b0fd5-a660-46f9-9dcb-d525cc22dcbd/)）：

```
using System.Runtime.InteropServices;

...
      [DllImport("user32.dll")]
      public static extern IntPtr FindWindow(string lpClassName,string lpWindowName);

      [DllImport("user32.dll")]
      static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);

...

         //Sometimes System.Windows.Forms.Application.ExecutablePath works for the caption depending on the system you are running under.
         IntPtr hWnd = FindWindow(null, "Your console windows caption"); //put your console window caption here
         if(hWnd != IntPtr.Zero)
         {
            //Hide the window
            ShowWindow(hWnd, 0); // 0 = SW_HIDE
         }

         if(hWnd != IntPtr.Zero)
         {
            //Show window again
            ShowWindow(hWnd, 1); //1 = SW_SHOWNORMA
         } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T13:55:45.343

It's a hack, but the following blog post describes how you can hide the console window:

[http://expsharing.blogspot.com/2008/03/hideshow-console-window-in-net-black.html](http://expsharing.blogspot.com/2008/03/hideshow-console-window-in-net-black.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T14:06:01.907

安排任务以与您的帐户不同的用户身份运行，您不会弹出窗口。. .

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-04T20:09:15.570

只需将计划任务配置为“无论用户是否登录都运行”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T13:52:28.127

Why don't you make the application a Windows Service?

# asp.net-mvc - When would you not use a strongly-typed ASP.NET MVC view?

> ID：934906
> 
> 赞同：3
> 
> 时间：2009-06-01T13:51:54.697
> 
> 标签：asp.net-mvc, strongly-typed-view

Assuming that an ASP.NET MVC View is going to show data, is there any scenario where you would not want to use a strongly-typed view?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T13:54:38.857

Places where there is no model -- like Logon/Logoff.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T14:04:57.523

我认为您应该遵循始终使用强类型视图的做法，除非根本没有像之前提到的登录等页面那样使用任何模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T14:20:15.560

我被迫在布局中放置一些数据。因为我找不到任何制作强类型布局的好方法，我正在通过控制器基类传递必要的数据，并通过 viewData 的索引器按键在布局中获取它。

对于部分视图，我只是嵌套表单模型，我猜没有问题。

# html - 如何将Firefox中的垂直滚动条设置在左侧？

> ID：934918
> 
> 赞同：2
> 
> 时间：2009-06-01T13:54:18.763
> 
> 标签：html, firefox, textarea, scrollbar

我希望在 fire fox 的 textarea 中显示的垂直滚动条将显示在左侧，我的站点具有 'rtl' 方向，并且在 IE 中它可以，在左侧 - （与文本相反）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-05-06T12:38:32.280

Firefox 认为它是一种可用性功能，即无论页面中的文本使用什么方向，滚动条对于给定用户始终显示在同一侧。

[https://bugzilla.mozilla.org/show_bug.cgi?id=330863](https://bugzilla.mozilla.org/show_bug.cgi?id=330863)

因此，如果您的浏览器使用某种 RTL 语言，例如希伯来语，则滚动条始终位于左侧，如果您的浏览器使用英语，则滚动条始终位于右侧。您可以在 about:config (layout.scrollbar.side) 中设置一个首选项，该首选项会覆盖此选项，但网络作者无法控制它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T14:23:13.180

您始终可以使用设置为看起来像标准滚动条的自定义滚动条来执行此操作。但正如其他人所说，我不会推荐。以这种方式更改 UI 总体上是个坏主意。

[http://www.kelvinluck.com/assets/jquery/jScrollPane/jScrollPane.html](http://www.kelvinluck.com/assets/jquery/jScrollPane/jScrollPane.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T14:17:37.407

我不会这样做，因为它打破了用户的期望，但是你去：

1.  在地址栏中输入 about:config
2.  在“过滤器”中输入 layout.scrollbar.side
3.  双击 layout.scrollbar.side 首选项并将其更改为 3

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T14:19:32.300

同意此处的其他答案，我会认真考虑您是否要这样做（从易用性的角度来看）。

也就是说，即使你让它在 IE 中工作，我认为你对 RTL 设置的使用是不正确的。我不确定它的效果，但我认为更多的是允许用户使用从右到左读/写的语言编写。

# php - PHP：如何从不同的服务器加载文件作为字符串？

> ID：934921
> 
> 赞同：2
> 
> 时间：2009-06-01T13:54:51.397
> 
> 标签：php, regex, php4

我正在尝试将来自不同域名的 XML 文件作为字符串加载。我想要的只是 xml 文件的 <title></title> 标记中的文本数组，所以我在想，因为我使用的是 php4，所以最简单的方法是对其进行正则表达式来获取它们。有人可以解释如何将 XML 作为字符串加载吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T13:58:17.163

首先使用 file_get_contents(' [http://www.example.com/](http://www.example.com/) ');

要获取文件，请插入到 var. 解析 xml 后，链接为 [http://php.net/manual/en/function.xml-parse.php](http://php.net/manual/en/function.xml-parse.php) 在评论中有示例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T14:57:05.703

您可以像下面的示例一样使用 cURL。我应该补充一点，基于正则表达式的 XML 解析通常不是一个好主意，使用真正的解析器可能会更好，尤其是在它变得更复杂的情况下。

您可能还想添加一些正则表达式修饰符以使其跨多行等工作，但我认为问题更多是关于将内容提取到字符串中。

```
<?php

$curl = curl_init('http://www.example.com');

//make content be returned by curl_exec rather than being printed immediately                                 
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);

$result = curl_exec($curl);

if ($result !== false) {
    if (preg_match('|<title>(.*)</title>|i', $result, $matches)) {
        echo "Title is '{$matches[1]}'";   
    } else {
        //did not find the title    
    }
} else {
    //request failed
    die (curl_error($curl)); 
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-10T15:15:22.257

如果您正在加载格式正确的 xml，请跳过基于字符的解析，并使用 DOM 函数：

```
$d = new DOMDocument;
$d->load("http://url/file.xml");
$titles = $d->getElementsByTagName('title');
if ($titles) {
    echo $titles->item(0)->nodeValue;
} 
```

如果由于 php 的设置方式而无法使用 DOMDocument::load() ，请使用 curl 抓取文件，然后执行以下操作：

```
$d = new DOMDocument;
$d->loadXML($grabbedfile);
... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T14:59:36.587

我有这个功能作为一个片段：

```
function getHTML($url) {
    if($url == false || empty($url)) return false;
    $options = array(
        CURLOPT_URL            => $url,     // URL of the page
        CURLOPT_RETURNTRANSFER => true,     // return web page
        CURLOPT_HEADER         => false,    // don't return headers
        CURLOPT_FOLLOWLOCATION => true,     // follow redirects
        CURLOPT_ENCODING       => "",       // handle all encodings
        CURLOPT_USERAGENT      => "spider", // who am i
        CURLOPT_AUTOREFERER    => true,     // set referer on redirect
        CURLOPT_CONNECTTIMEOUT => 120,      // timeout on connect
        CURLOPT_TIMEOUT        => 120,      // timeout on response
        CURLOPT_MAXREDIRS      => 3,       // stop after 3 redirects
    );

    $ch      = curl_init( $url );
    curl_setopt_array( $ch, $options );
    $content = curl_exec( $ch );
    $header  = curl_getinfo( $ch );
    curl_close( $ch );

    //Ending all that cURL mess...

    //Removing linebreaks,multiple whitespace and tabs for easier Regexing
    $content = str_replace(array("\n", "\r", "\t", "\o", "\xOB"), '', $content);
    $content = preg_replace('/\s\s+/', ' ', $content);
    $this->profilehtml = $content;
    return $content;
} 
```

这将返回没有换行符、制表符、多个空格等的 HTML，只有 1 行。

所以现在你做这个 preg_match：

```
$html = getHTML($url)
preg_match('|<title>(.*)</title>|iUsm',$html,$matches); 
```

并且 $matches[1] 将拥有您需要的信息。

# java - Efficient way to implement paged SQL result table in a Java desktop application

> ID：934927
> 
> 赞同：3
> 
> 时间：2009-06-01T13:55:56.717
> 
> 标签：java, paging

I need to build a table from SQL select result set. I want to add some paging functionality to the table because the result set can be very large. There was many discussions how to do the paging at the SQL level. But how to implement the paging at the GUI level? I have two ideas:

1.  Do the paging in a web UI style - for example google search result paging;
2.  "Excel style" - the scroll pane where the table resides expands as user scrolls down.

The second one looks nicer but complex to implement. When to do SQL select for a next chunk of data so that a user haven't wait for it. There should be some "read ahead" logic? What will happen if user scrolls quite quickly? What to do with rows that aren't visible any more to have constant memory usage? Maybe there is already such a table component or good examples? Or maybe this good looking table functionality is unworthy of efforts to implement it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T16:05:48.247

您可以直接在 TableModel 中进行所有操作，无需更改 UI 中的某些内容（您可能会在 UI 中显示某些内容 - 一种状态 - 但您不需要更改 JTable 呈现自身的方式）。

只需实现一个 JDBCTableModel ，它将具有：

*   计算结果并将此值作为 getRowCount() 返回。
*   有一个后台线程，它将页面 X（行 X 到行 X + page_size）带入内存
*   如果视图（JTable）请求不存在的行（页面未加载），则在左上角或右上角的某处显示消息“正在加载数据...”并返回空单元格。

分页对 Swing 应用程序没有意义，它是在当前花哨的 AJAX 库可以实现表格滚动之前发明的（参见[http://www.ext-livegrid.com/](http://www.ext-livegrid.com/)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T03:42:53.990

为 AJAX 库构建分页表的人显然对此想了很多，所以如果你找不到已经构建的东西，你也许可以向他们学习。由于您使用的是 Java，请注意您可以找到用 Java 编写的用于 GWT 的分页表。请参阅这些 SO 线程：

[GWT 分页小部件](https://stackoverflow.com/questions/231407/gwt-paging-widget)

[GWT 中的最佳分页表实现](https://stackoverflow.com/questions/335602/best-pageable-table-implementation-in-gwt)

您实现的想法（以及大部分代码）可以在提到的开源项目中找到。

# c# - 我可以使用反射更改 C# 中的私有只读字段吗？

> ID：934930
> 
> 赞同：121
> 
> 时间：2009-06-01T13:56:41.847
> 
> 标签：c#, reflection, field, readonly

我想知道，由于可以使用反射完成很多事情，我可以在构造函数完成执行后更改私有只读字段吗？
（注：只是好奇）

```
public class Foo
{
 private readonly int bar;

 public Foo(int num)
 {
  bar = num;
 }

 public int GetBar()
 {
  return bar;
 }
}

Foo foo = new Foo(123);
Console.WriteLine(foo.GetBar()); // display 123
// reflection code here...
Console.WriteLine(foo.GetBar()); // display 456 
```

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2009-06-01T13:59:10.610

你可以：

```
typeof(Foo)
   .GetField("bar",BindingFlags.Instance|BindingFlags.NonPublic)
   .SetValue(foo,567); 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-06-01T13:59:56.630

显而易见的是尝试它：

```
using System;
using System.Reflection;

public class Test
{
    private readonly string foo = "Foo";

    public static void Main()
    {
        Test test = new Test();
        FieldInfo field = typeof(Test).GetField
            ("foo", BindingFlags.Instance | BindingFlags.NonPublic);
        field.SetValue(test, "Hello");
        Console.WriteLine(test.foo);
    }        
} 
```

这工作正常。（有趣的是，Java 有不同的规则 - 您必须明确设置`Field`可访问，而且它只适用于实例字段。）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-02-26T11:36:19.330

我同意其他答案，因为它*通常*有效，尤其是 E. Lippert 的评论，即这不是记录在案的行为，因此不是面向未来的代码。

但是，我们也注意到另一个问题。如果您在权限受限的环境中运行代码，您可能会遇到异常。

我们刚刚遇到了一个案例，我们的代码在我们的机器上运行良好，但是`VerificationException`当代码在受限环境中运行时我们收到了一个案例。罪魁祸首是对只读字段设置器的反射调用。当我们删除该字段的只读限制时，它起作用了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-01-27T21:20:41.327

您问为什么要像那样破坏封装。

我使用实体助手类来水合实体。这使用反射来获取新空实体的所有属性，并将属性/字段名称与结果集中的列匹配，并使用 propertyinfo.setvalue() 对其进行设置。

我不希望其他人能够更改该值，但我也不希望花费所有精力为每个实体自定义代码水合方法。

我的许多存储过程返回的结果集不直接对应于表或视图，因此代码生成 ORM 对我没有任何作用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-05-12T17:52:33.707

不要这样做。

我刚刚花了一天时间修复一个超现实的错误，其中对象可能不是它们自己声明的类型。

修改只读字段一次。但是如果你再次尝试修改它，你会遇到这样的情况：

```
SoundDef mySound = Reflection_Modified_Readonly_SoundDef_Field;
if( !(mySound is SoundDef) )
    Log("Welcome to impossible-land!"); //This would run 
```

所以不要这样做。

这是在 Mono 运行时（Unity 游戏引擎）上。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-02-21T23:19:41.147

另一种使用 unsafe 的简单方法（或者您可以通过 DLLImport 将该字段传递给 C 方法并将其设置在那里）。

```
using System;

namespace TestReadOnly
{
    class Program
    {
        private readonly int i;

        public Program()
        {
            i = 66;
        }

        private unsafe void ForceSet()
        {
            fixed (int* ptr = &i) *ptr = 123;
        }

        static void Main(string[] args)
        {
            var program = new Program();
            Console.WriteLine("Contructed Value: " + program.i);
            program.ForceSet();
            Console.WriteLine("Forced Value: " + program.i);
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-01T14:21:04.950

答案是肯定的，但更重要的是：

你为什么想要？故意破坏封装对我来说似乎是一个非常糟糕的主意。

使用反射来更改只读或常量字段就像将[意外后果](http://en.wikipedia.org/wiki/Unintended_consequence#The_law_of_unintended_consequences)定律与[墨菲定律](http://en.wikipedia.org/wiki/Murphy%27s_law)结合起来。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-24T14:40:00.003

我只想补充一点，如果您需要为单元测试做这些事情，那么您可以使用：

A) [PrivateObject](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.privateobject(v=vs.80).aspx)类

B) 您仍然需要 PrivateObject 实例，但您可以使用 Visual Studio 生成“访问器”对象。 [如何：重新生成私有访问器](http://msdn.microsoft.com/en-us/library/ms184796(v=vs.80).aspx)

如果您在单元测试之外的代码中设置对象的私有字段，那将是“代码异味”的一个实例，我认为您想要这样做的唯一其他原因可能是您正在与第三方打交道库，您无法更改目标类代码。即便如此，您可能还是想联系第 3 方，说明您的情况，看看他们是否会继续更改代码以适应您的需要。

# ruby-on-rails - ActiveScaffold - Specifying Conditions in Embedded Scaffold

> ID：934931
> 
> 赞同：0
> 
> 时间：2009-06-01T13:57:02.110
> 
> 标签：ruby-on-rails, activescaffold

I have a Project model and a TaskType model. Association between the two occurs through a ProjectTaskType model (backed by a link/join table in the DB with foreign keys to both Projects and TaskTypes).

A Project has_many TaskTypes :through ProjectTaskType, and a TaskTypes has_many Projects :through ProjectTaskType.

I have a vew with an embedded scaffold and want to display all TaskTypes belonging to a given Project.

Can someone quide me as to how I would write the conditions for this?

```
<%= render 
   :active_scaffold => :task_type, 
   :label => 'Task Types', 
   :conditions => "TaskTypes which are associated with @project 
                   through the ProjectTaskType" %> 
```

And can my filtering logic go elsewhere?

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T15:44:11.197

在 ActiveSacffold 控制器中，我添加了这个 AS 钩子方法......

def conditions_for_collection subquery = "SELECT t.id from #{TaskType.table_name} t, #{ProjectTaskTypes.table_name} ptt where (t.id = ptt.task_type_id and ptt.project_id = #{project_id})"

“ID in (#{subquery})”结束

# cocoa - NSImage 到 Base64

> ID：934940
> 
> 赞同：7
> 
> 时间：2009-06-01T13:58:20.300
> 
> 标签：cocoa, base64

我需要创建一个 NSImage 可可对象的 base64 字符串表示。处理这个问题的最佳方法是什么，苹果文档似乎在这个主题上有点短（或者我只是找不到它）。从外部看，Base64 编码似乎相当复杂。

任何帮助将不胜感激。

干杯亚历克斯

编辑

```
NSArray *keys = [NSArray arrayWithObject:@"NSImageCompressionFactor"];
NSArray *objects = [NSArray arrayWithObject:@"1.0"];
NSDictionary *dictionary = [NSDictionary dictionaryWithObjects:objects forKeys:keys];

NSImage *image = [[NSImage alloc] initWithContentsOfFile:[imageField stringValue]];
NSBitmapImageRep *imageRep = [[NSBitmapImageRep alloc] initWithData:[image TIFFRepresentation]];
NSData *tiff_data = [imageRep representationUsingType:NSPNGFileType properties:dictionary];

NSString *base64 = [tiff_data encodeBase64WithNewlines:NO]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T17:12:17.993

NSImage 是一个非常抽象的对象。NSImage 并不真正关心它是光栅图像还是矢量图像；一个 NSImage 对象甚至可以同时拥有光栅、矢量*甚至编程*表示——就是这么普遍。

在生成 Base64 数据之前，您必须确定*要*编码的内容。

第一步是决定是否要对栅格或矢量进行编码。前者很简单，我猜这可能就是你的意思。但是，NSImage 可能来自矢量源，例如 PDF 文档。

如果您知道您是从栅格源创建图像的，则只需对该源数据进行编码即可。

如果它来自矢量源，如果您知道解码端的应用程序能够处理它（例如，如果它是另一个 Cocoa 或 Cocoa Touch 应用程序），您仍然可以对其进行编码。另一方面，如果解码端的应用程序可能无法处理矢量数据，那么您应该避免这种策略。

**适用于所有情况的一种解决方案**是使用[NSBitmapImageRep](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSBitmapImageRep_Class/)创建图像[的光栅捕获](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSBitmapImageRep_Class/Reference/Reference.html#//apple_ref/doc/uid/20000347-initWithFocusedViewRectCOLON)。锁定图像上的焦点，然后使用该方法创建一个 NSBitmapImageRep，然后解锁焦点。然后，使用[representationUsingType:properties:](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSBitmapImageRep_Class/Reference/Reference.html#//apple_ref/occ/instm/NSBitmapImageRep/representationUsingType:properties:)为图像生成PNG（或任何合适的格式）数据。然后对 PNG（或任何格式）数据进行 Base64 编码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-08-31T07:57:26.793

**斯威夫特 4**

```
extension NSImage {
    var base64String: String? {
        guard let rep = NSBitmapImageRep(
            bitmapDataPlanes: nil,
            pixelsWide: Int(size.width),
            pixelsHigh: Int(size.height),
            bitsPerSample: 8,
            samplesPerPixel: 4,
            hasAlpha: true,
            isPlanar: false,
            colorSpaceName: .calibratedRGB,
            bytesPerRow: 0,
            bitsPerPixel: 0
            ) else {
                print("Couldn't create bitmap representation")
                return nil
        }

        NSGraphicsContext.saveGraphicsState()
        NSGraphicsContext.current = NSGraphicsContext(bitmapImageRep: rep)
        draw(at: NSZeroPoint, from: NSZeroRect, operation: .sourceOver, fraction: 1.0)
        NSGraphicsContext.restoreGraphicsState()

        guard let data = rep.representation(using: NSBitmapImageRep.FileType.png, properties: [NSBitmapImageRep.PropertyKey.compressionFactor: 1.0]) else {
            print("Couldn't create PNG")
            return nil
        }

        // With prefix
        // return "data:image/png;base64,\(data.base64EncodedString(options: []))" 
        // Without prefix
        return data.base64EncodedString(options: []))
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T14:32:04.850

Apple 在这里没有提供任何特别的帮助，因此您必须以一种或另一种方式自行解决复杂性。

幸运的是，有一些资源可以让这更容易。第一种方法是自己进行编码和解码。Google Toolbox for Mac 有一个很好的例子，你可以直接使用这个源文件：

[http://code.google.com/p/google-toolbox-for-mac/source/browse/trunk/Foundation/GTMBase64.m](http://code.google.com/p/google-toolbox-for-mac/source/browse/trunk/Foundation/GTMBase64.m)

如果您只为 Mac 构建，其中 OpenSSH 库可用，那么您可以利用这些库中的一些功能来进行编码和解码：

[http://www.dribin.org/dave/blog/archives/2006/03/12/base64_cocoa/](http://www.dribin.org/dave/blog/archives/2006/03/12/base64_cocoa/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T16:29:52.300

[我在 github 上的工具包](http://github.com/AlanQuatermain/aqtoolkit/tree/master)中有一堆代码，包括基于 OmniFoundation 中实现的 Base64 解析。特别是，请查看 Extensions/NSData+Base64.h。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-07-02T23:52:14.693

这是一个将 NSImage 转换为 base64 字符串的 Swift 2 扩展：

```
private extension NSImage {
    var base64String:String? {
    guard let rep = NSBitmapImageRep(
        bitmapDataPlanes: nil,
        pixelsWide: Int(size.width),
        pixelsHigh: Int(size.height),
        bitsPerSample: 8,
        samplesPerPixel: 4,
        hasAlpha: true,
        isPlanar: false,
        colorSpaceName: NSDeviceRGBColorSpace,
        bytesPerRow: 0,
        bitsPerPixel: 0
        ) else {
            print("Couldn't create bitmap representation")
            return nil
    }

    NSGraphicsContext.saveGraphicsState()
    NSGraphicsContext.setCurrentContext(NSGraphicsContext(bitmapImageRep: rep))
    drawAtPoint(NSZeroPoint, fromRect: NSZeroRect, operation: .CompositeSourceOver, fraction: 1.0)
    NSGraphicsContext.restoreGraphicsState()

    guard let data = rep.representationUsingType(NSBitmapImageFileType.NSPNGFileType, properties: [NSImageCompressionFactor: 1.0]) else {
        print("Couldn't create PNG")
        return nil
    }
    return data.base64EncodedStringWithOptions([])
}
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-09-28T13:25:51.560

**斯威夫特 3**

```
extension NSImage {
    var base64String:String? {
        guard let rep = NSBitmapImageRep(
            bitmapDataPlanes: nil,
            pixelsWide: Int(size.width),
            pixelsHigh: Int(size.height),
            bitsPerSample: 8,
            samplesPerPixel: 4,
            hasAlpha: true,
            isPlanar: false,
            colorSpaceName: NSDeviceRGBColorSpace,
            bytesPerRow: 0,
            bitsPerPixel: 0
            ) else {
                print("Couldn't create bitmap representation")
                return nil
        }

        NSGraphicsContext.saveGraphicsState()
        NSGraphicsContext.setCurrent(NSGraphicsContext(bitmapImageRep: rep))
        draw(at: NSZeroPoint, from: NSZeroRect, operation: .sourceOver, fraction: 1.0)
        NSGraphicsContext.restoreGraphicsState()

        guard let data = rep.representation(using: NSBitmapImageFileType.PNG, properties: [NSImageCompressionFactor: 1.0]) else {
            print("Couldn't create PNG")
            return nil
        }

        return data.base64EncodedString(options: [])
    }
} 
```

# sharepoint - MOSS 和业务数据目录 - 有什么好的文档吗？

> ID：934943
> 
> 赞同：2
> 
> 时间：2009-06-01T13:59:47.223
> 
> 标签：sharepoint, moss, bdc

任何人都可以为 MOSS 2007 Enterprise 中的业务数据目录指出任何好的“初学者演练”吗？它似乎非常强大，但所有官方指南都假设预先存在的知识。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T14:46:41.403

查看[SharePoint 2007 业务数据目录开发人员指南](http://www.manning.com/lonsdale/)。作者（布雷特·朗斯代尔和尼克·斯旺）一直在开发工具并与 BDC 合作“多年”，并且真正了解他们的东西。

现在可以进行早期访问，最终版本将于 2009 年 9 月发布。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-22T18:23:38.803

这对 BDC 有一个很好的概述，一些关于它可以做什么以及如何配置它的示例：

[http://sharepointmagazine.net/technical/administration/everything-you-need-to-know-about-bdc-part-1-of-8](http://sharepointmagazine.net/technical/administration/everything-you-need-to-know-about-bdc-part-1-of-8)

这是一个非常好的起点，可以帮助您在访问更多技术站点和操作指南时获得更好的基础。这是我找到的最好的“入门”资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T07:38:08.400

看看[BDC Metaman](http://www.lightningtools.com/bdc-meta-man/default.aspx)，这个工具将支持你连接到 BDC。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T14:10:19.417

几个月前我玩过它，并且能够显示来自数据库的数据。您是否有要解决的问题，或者您只是想了解您可以用它做什么？

您所说的“预先存在的知识”是指 Sharepoint 还是 BDC 本身？

查看这些链接，作为开始：

[http://channel9.msdn.com/shows/In+the+Office/Introducing-the-Business-Data-Catalog-BDC/](http://channel9.msdn.com/shows/In+the+Office/Introducing-the-Business-Data-Catalog-BDC/) [http://blah.winsmarts.com/2007-4-SharePoint_2007__BDC_-_The_Business_Data_Catalog.aspx](http://blah.winsmarts.com/2007-4-SharePoint_2007__BDC_-_The_Business_Data_Catalog.aspx)

# wpf - 将 Xaml 编译成 Baml？

> ID：934945
> 
> 赞同：8
> 
> 时间：2009-06-01T13:59:59.187
> 
> 标签：wpf, xaml, baml

如何将 xaml 转换为 baml？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-11-11T09:23:47.510

您可以通过创建引用它的 MSBuild 项目文件来编译 XAML。当您对项目进行编译时，这就是在 Visual Studio“幕后”发生的事情（它会创建一个临时的 .proj 文件并构建它）。

一个相当小的项目文件 (xamlcompile.csproj) 是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="3.5" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <ProductVersion>9.0.30729</ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <OutputType>library</OutputType>
    <TargetFrameworkVersion>v3.5</TargetFrameworkVersion>
    <ProjectGuid>{6B8967FF-37B7-43E8-B866-FFD6F13FFC0A}</ProjectGuid>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Core">
      <RequiredTargetFramework>3.5</RequiredTargetFramework>
    </Reference>
    <Reference Include="System.Xml.Linq">
      <RequiredTargetFramework>3.5</RequiredTargetFramework>
    </Reference>
    <Reference Include="System.Data.DataSetExtensions">
      <RequiredTargetFramework>3.5</RequiredTargetFramework>
    </Reference>
    <Reference Include="System.Data" />
    <Reference Include="System.Xml" />
    <Reference Include="WindowsBase" />
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="PresentationFramework.Classic" />
  </ItemGroup>
  <ItemGroup>
    <Page Include="Themes\Generic.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
</Project> 
```

然后您可以通过运行以下命令生成 BAML 文件：

```
MSBuild /t:ResolveReferences;MarkupCompilePass1;MarkupCompilePass2 xamlcompile.csproj 
```

这将在 obj\Debug 下创建一个 baml 文件，在上面的示例中它将是 obj\Debug\Themes\Generic.baml。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T14:40:39.997

有一个 Reflector 插件可以加载包含 BAML 资源的程序集（例如本地化资源程序集）并显示相应的 XAML：[BamlViewer](http://reflectoraddins.codeplex.com/Wiki/View.aspx?title=BamlViewer)

在 Visual Studio 中编译 WPF 应用程序时，所有 XAML 文件都将转换为 BAML，然后将该 BAML 作为资源嵌入到最终的 DLL 或 EXE 程序集中。

# asp.net-mvc - 关于 ASP.NET MVC 模型位置的最佳实践

> ID：934946
> 
> 赞同：0
> 
> 时间：2009-06-01T14:00:02.153
> 
> 标签：asp.net-mvc, model

是否有涵盖应该定义 ASP.NET MVC 模型的位置的最佳实践？

一个新的 ASP.NET MVC 项目有一个漂亮整洁的 Models 文件夹供他们进入，但在生产环境中，他们可以来自其他地方：

*   第三方类库
*   WCF 服务

强类型视图使用在这样的位置定义的类是否可以接受？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T17:06:09.423

在我从事过的每个项目中，ASP.NET MVC 模型比传统意义上的模型更多的是视图模型。我还没有一个项目可以使用我在数据访问中使用的相同模型来访问我的视图模型。大多数页面上需要显示的其他信息太多了。因此，出于这个原因，我要么将我的模型存储在模型文件夹中，要么将它们与我的所有其他 MVC 特定类一起存储在一个单独的库中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T14:07:02.560

我不知道您将模型放入 WCF 服务的确切含义。如果您的意思是使用公开您需要的模型对象的 WCF 服务，那将起作用。

关于保存模型、视图和控制器的单独类库，我认为这是一种非常常见的方法并且效果很好。事实上，我相信当您的应用程序的规模和复杂性增加时，这确实是一项要求。这是 MVC 应用程序中不同逻辑组件的一种*物理分离*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T14:04:15.577

我发现的一个问题是，除非模型是在 Web 项目中定义的，否则在使用标记中指定的强类型视图时，VisualStudio 似乎无法找到它。我的模型通常在一个单独的项目中定义，我发现要使用强类型视图，我需要创建一个代码隐藏，以便我有一个派生自强类型 ViewPage 的类。然后我更改标记并将其与此类关联。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-05T19:22:20.647

您需要将命名空间导入到视图页面。这**不需要**代码隐藏页面。

使用指令

```
<%@ import namespace='your.namespace.here' %> 
```

`<@ Page.....`指令后立即

# linux - 如何为 Linux 制作 Qt 应用程序的二进制分发

> ID：934950
> 
> 赞同：16
> 
> 时间：2009-06-01T14:01:25.940
> 
> 标签：linux, qt, deployment, distribution

我正在开发跨平台的 Qt 应用程序。它是免费软件，虽然不是开源的。因此，我想将它作为已编译的二进制文件分发。

在 Windows 上没有问题，我将编译`exe`后的文件与 MinGW 和 Qt 的 DLL 一起打包，一切顺利。

但是在 Linux 上存在一个问题，因为用户可能在他/她的系统中拥有与我非常不同的共享库。

Qt 部署指南建议两种方法：静态链接和使用共享库。第一个产生巨大的可执行文件，还需要Qt依赖的许多库的静态版本，即我必须从头开始重建它们。第二种方法基于在应用程序启动之前重新配置动态链接器，对我来说似乎有点棘手。

谁能分享他/她在 Linux 下分发 Qt 应用程序的经验？我应该使用什么方法？我可能会遇到什么问题？还有其他方法可以完成这项工作吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-20T17:34:52.800

共享库是要走的路，但您可以避免使用`LD_LIBRARY_PATH`（这涉及使用启动器 shell 脚本运行应用程序等）使用`-rpath`编译器标志构建二进制文件，指向您存储库的位置。

例如，我将我的库存储在我的二进制文件旁边或在我的二进制文件旁边名为“mylib”的目录中。要在我的 QMake 文件中使用它，我在文件中添加了这一行`.pro`：

```
QMAKE_LFLAGS += -Wl,-rpath,\\$\$ORIGIN/lib/:\\$\$ORIGIN/../mylib/ 
```

而且我可以使用覆盖任何系统库的本地库来运行我的二进制文件，而无需启动器脚本。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-01T14:08:40.823

您还可以在 Linux 上分发 Qt 共享库。然后，让您的软件加载那些而不是系统默认的。可以使用`LD_LIBRARY_PATH`环境变量覆盖共享库。这可能是您最简单的解决方案。您始终可以在可执行文件的包装脚本中更改它。

或者，只需指定您的用户需要在系统上安装的最低库版本。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-01T14:42:49.927

当我们在 Linux 上分发 Qt 应用程序（或者实际上是任何使用共享库的应用程序）时，我们会发布一个目录树，其中包含实际的可执行文件和相关的包装脚本在顶部，子目录包含共享库和您不需要的任何其他必要资源不想链接。

这样做的好处是您可以让包装脚本设置运行应用程序所需的一切，而不必担心让用户设置环境变量、安装到特定位置等。如果操作正确，这还允许您不必担心从哪里调用应用程序，因为它总能找到资源。

实际上，我们通过将所有可执行文件和共享库放在平台/架构子目录中来进一步采用这种树结构，以便包装脚本可以确定本地架构并为该平台调用适当的可执行文件并设置环境变量以找到合适的共享库。我们发现此设置在为共享公共文件系统的多个不同 linux 版本分发时特别有用。

尽管如此，我们仍然更喜欢尽可能静态构建，Qt 应用程序也不例外。您绝对可以使用 Qt 静态构建，并且您不必像 krbyrd 在他的回复中指出的那样构建很多额外的依赖项。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-01T14:43:16.620

[sybreon 的回答](https://stackoverflow.com/a/934981/)正是我所做的。你可以总是将你的库添加到**LD_LIBRARY_PATH**或者你可以做一些更花哨的事情：

为每个目录设置一个已发布的 Qt 库。编写一个 shell 脚本，让它`ldd`在可执行文件上运行并 grep 查找“未找到”，对于每个库，将适当的目录添加到列表中（我们称之为 $LDD）。全部完成后，运行二进制文件并将**LD_LIBRARY_PATH**设置为之前的值加上 $LDD。

最后是关于“我将不得不从头开始重建所有这些”的评论。不，你不必这样做。如果你有这些库的开发包，你应该有`.a`文件，你可以静态链接这些。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-01T14:42:25.763

不是这样的答案（sybreon 涵盖了那个），但请注意，如果您的二进制文件与 Qt 静态链接，则**不允许**您分发它，除非您购买了商业许可证，否则您的整个二进制文件属于 GPL（或者您'违反了 Qt 的许可。）

如果您有商业许可证，请不要介意。

如果您没有商业许可证，您有两种选择：

1.  与 Qt v4.5.0 或更高版本（LGPL 版本 - 除了在开源应用程序中，您不得使用以前的版本）动态链接，或

2.  打开你的源代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-02-04T11:03:05.567

在 Linux 上创建 Qt 应用程序包的最简单的方法可能是[linuxdeployqt](https://github.com/probonopd/linuxdeployqt)。它收集所有必需的文件，并允许您构建在大多数 Linux 发行版上运行的[AppImage 。](https://appimage.org)

确保您在仍受支持的最旧 Ubuntu LTS 版本上构建应用程序，以便您的 AppImage 可以在[AppImageHub](https://appimage.github.io/apps/)上列出。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-20T09:41:34.273

您可以查看 QtCreator 文件夹并将其用作示例。它在*QtCreator/bin中有**qt.conf*和*qtcreator.sh*文件。

 ***lib/qtcreator**是包含所有需要的 Qt *.so 库的文件夹。相对路径是在qtcreator.sh里面设置的，应该重命名为*you-app-name.sh*

**imports**，**plugins**，**qml**都在*bin*目录中。它们的路径在*qt.conf*文件中设置。这是**QML**应用程序部署所必需的。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-03T18:03:09.143

本文包含有关该主题的信息。我自己试试：http: [//labs.trolltech.com/blogs/2009/06/02/deploying-a-browser-on-gnulinux/](http://labs.trolltech.com/blogs/2009/06/02/deploying-a-browser-on-gnulinux/)

简单来说：

*   使用 -platform linux-lsb-g++ 配置 Qt
*   链接应该使用 –lsb-use-default-linker
*   打包所有东西并部署（这里需要一些调整，但我还没有尝试过）

# php - 创建唯一密钥 - 最有效的方式

> ID：934952
> 
> 赞同：2
> 
> 时间：2009-06-01T14:01:50.340
> 
> 标签：php, while-loop

我有两个函数，makeKey() 和 keyExists()。

makeKey() 简单地生成一个 5 位随机字母数字密钥，keyExists() 接受这个密钥作为它的唯一参数，并在一个表中查找，根据它是否存在返回真/假。

我需要做一些非常简单的事情，但我想不出最快的方法。

我只需要创建一个键，如果它存在于表中，则再次创建一个键，依此类推，直到返回一个唯一的键。我认为一个while循环就足够了？

谢谢，请原谅这个相当基本的问题，我想我昨天在阳光下煮了我的大脑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T14:06:58.767

我会使用`do`-`while`循环：

```
do {
    $newKey = makeKey();
} while (keyExists($newKey)); 
```

这将在每次迭代时生成一个新密钥，直到该密钥尚不存在。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-01T14:11:03.393

任何依赖于创建然后检查的解决方案都会在关键空间被填满时表现出糟糕的表现。您最好使用自动生成的列（身份或 guid）生成唯一键。如果它需要是字母数字，请使用映射函数将其转换为您选择的字母表，方法是选择位组并将它们用作字母表的索引。

伪代码

```
alphabet = "ABCDE...789";
key = insert new row, get autogenerated key
alphaKey = "";
while (get n bits from key)
   alphaKey += alphabet[bits]
done
echo alphaKey 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T14:05:18.397

我的 php 有点生锈，所以考虑一下这个伪代码：

```
$key_exists = true;
while($key_exists) {
       $key = generateKey();
       $key_exists = checkKey($myKeysHash, $key);
}
// $key is now unique and ready to use 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T14:13:54.573

[为什么不使用像uniqid()](http://us3.php.net/manual/en/function.uniqid.php)这样的内置 php 函数？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T14:09:39.370

您提到了一个表，所以我想知道您是否将这些键存储在数据库中？如果是这样，您的方法将有一个竞争条件 - 您可能会在另一个进程使用该密钥之前检查一个密钥是否可以使用。

更好的方法是生成一个可能的密钥，然后尝试将其持久化——也许通过对密钥表执行 INSERT 并使用不同的密钥重试直到成功。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T14:12:34.560

如果您不固定在 5 位数字上，则可以考虑使用 id + name 列的哈希值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T14:13:56.883

我还将假设您正在使用某种数据库。

您不能在数据库中使用唯一的自增 ID 列吗？它将删除检查密钥是否存在的要求，因为数据库引擎永远不会两次分配相同的 ID。

但是，您必须更改应用程序中的逻辑，而不仅仅是编写新功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-01T14:16:46.673

需要随机吗？只需增加一个变量并存储下一个以在另一个字段中使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-01T14:36:05.310

`while (keyExists($newKey = makeKey()));`

可能是最快的检查方法，如果存在密钥，它将生成一个新密钥。如果您开始有很多冲突/需要在获取新的唯一密钥之前多次检查数据库，您可能需要重新考虑您的 makeKey() 算法。对数据库的调用很昂贵，调用越少，脚本就越快、越高效。

# makefile - 如何在递归构建中忽略命令行变量赋值？

> ID：934953
> 
> 赞同：6
> 
> 时间：2009-06-01T14:02:27.483
> 
> 标签：makefile, gnu, build-management

我正在尝试将两个构建系统粘合在一起。两者都是递归的（makefile 中的规则使用 make 来调用其他 makefile 来构建项目的组件）。

我将它们称为“A”和“B”，其中“A”构建应用程序，“B”构建“A”使用的库。

A中的顶级makefile调用'make TARGET=whatever'，这意味着构建的所有递归调用位都继承TARGET的值作为只读变量，包括来自B的构建系统，它被称为递归构建。

我不希望这种情况发生在“B”（来自不同项目）的构建系统中，因为那里的 makefile 将 TARGET 用于自己的目的，并且构建失败，因为 TARGET 具有错误的值并且是只读的。

我只能看到两种解决方案，这两种解决方案都不是可取的；

1) 将 TARGET 重命名为 A 中设置它的 makefile 和 A 中使用它的 makefile 中的其他内容，以避免与构建系统的较低级别发生冲突。

2) 在 B 中设置了 TARGET 变量的 makefile 中的任何地方使用“覆盖”指令，以覆盖其只读状态。

有人有更好的想法吗？- 理想情况下，我不希望B 的构建系统从 A 继承任何东西，除了我从 A 明确传递给 B 构建系统的那些选项*。*

顺便说一句，我正在使用 GNU Make v3.80。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T18:06:31.023

您可以在 A 中的第二级 makefile 中将*MAKEOVERRIDES设置为空。*

```
callb:
      cd subdir && $(MAKE) MAKEOVERRIDES= 
```

这会传递正常的命令行参数，如*-k*和*-s*，但不会传递命令行变量定义。

或者您使用与*MAKEFLAGS相同的历史**MFLAGS*，但*MFLAGS*不包含命令行变量定义。

 **```
callb:
     cd subdir && $(MAKE) $(MFLAGS) 
```

可以在此处阅读有关这两个选项[的详细信息：GNU Make Manual](http://www.gnu.org/software/make/manual/make.html#Options_002fRecursion "GNU Make 手册第 5.7.3 章与子 make 通信选项")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T15:53:45.063

也许您可以使用“unexport”指令来防止 TARGET 被传播到 B 的 makefile？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T18:37:14.940

At the point where build system A invokes build system B, do not use '`${MAKE}`' directly; invoke a shell script that invokes build system B (possibly after sanitizing the environment).

To achieve the behaviour where the commands are executed by '`make -n`', prefix the command line in the makefile with '`+`' (similar to prefixing the line with '`@`' or '`-`').

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-09T22:10:31.333

听起来您已经修改了 A makefile 以递归调用 B makefile，因此您的问题。为什么不引入一个新的顶层makefile，它递归调用B makefile，然后递归调用A makefile？例如，combined.mk：

```
all:
    $(MAKE) -f Makefile.B
    $(MAKE) -f Makefile.A 
```

这样，B makefile 不会从 A makefile 继承任何内容。

# c# - 如何在linq中使用foreach

> ID：934956
> 
> 赞同：1
> 
> 时间：2009-06-01T14:02:51.273
> 
> 标签：c#, linq, foreach, anonymous-types

我前段时间在一些博客中读到（抱歉含糊不清）我可以使用如下所示的 linq

```
var list = from c in xml
           select new 
           {
              foreach(XElement el in c.Elements())
              {
              }
           } 
```

有谁知道这是可能的还是只是我的想象？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T14:04:35.153

您不能`foreach`直接在匿名类型初始化表达式中使用循环，不。

如果您能告诉我们您想要实现的目标，我们可能会帮助您找到实现目标的最佳方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-05T19:40:31.577

您可以使用 ToList() 函数将元素转换为 List 列表，然后您可以在其上使用 ForEach 方法。仅供参考，当使用 LinqToXml 时，我发现 Descendants() 更有用，因为它将全面深入到对象模型中。

```
xml.Elements().ToList().ForEach(ele => DoSomething(ele)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T14:04:52.423

这是你的想象。您可以在 foreach 循环中使用 linq 查询的结果，但不能在匿名类型的声明中使用类似的 foreach 循环。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T14:26:01.023

好的，我有一个包含两部分的 xml，首先声明 xml 中的字段，第二部分具有与第一部分中的声明关联的数据。所以我要做的是，阅读第一个字段定义并使用它在第二部分中创建数据的匿名类。尽量不要在程序中进行硬编码，因为我们从具有不同字段定义的不同来源获取数据。

# iphone - UITableCellView中的UIScrollView，单元格不更新

> ID：934967
> 
> 赞同：0
> 
> 时间：2009-06-01T14:04:57.900
> 
> 标签：iphone, uitableview, uiscrollview

我有一个自定义 UITableViewCell ，其中有一个 UIScrollView ，它连接到单元控制器。当我将文本分配给滚动视图时，一些单元格得到正确的文本，一些是空白的，一些重新显示旧文本，而另一些则将滚动视图剪裁在文本的第 2 行或第 3 行周围。会发生什么似乎是随机的。我按照这里的建议使用计时器来修复空白单元格，[http://www.bdunagan.com/2008/12/08/uitextview-in-a-uitableview-on-the-iphone/](http://www.bdunagan.com/2008/12/08/uitextview-in-a-uitableview-on-the-iphone/)，但那没有帮助。我将计时器代码放在 cellForRowAtIndexPath 方法中。

我也试过打电话

```
[cell.textview setNeedsDisplay]; 
```

在将文本分配给 textview 但它没有任何影响之后。

当我使用文本字段或标签时，一切看起来都很好。但是，我需要可以滚动文本的东西。有关修复或更好方法的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T16:30:01.910

更新：在开发论坛上找到了这个（特别提到了你的问题）：

[https://devforums.apple.com/message/38944#38944](https://devforums.apple.com/message/38944#38944)

我会点击链接，它有一些更详细的信息。

```
 // view controller

- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
     NSArray*     visibleCells = [self.tableView visibleCells];

     for (UITableViewCell* cell in visibleCells)
     {
          if ([cell.reuseIdentifier isEqualToString:kTextViewCellID])
          {
               [(MTextViewCell*)cell refresh];
          }
     }
}

// MTextViewCell 

- (void)refresh
{
     // mucking with the contentOffset causes the textView to redraw itself
     CGPoint     contentOffset = mTextView.contentOffset;
     CGPoint     contentOffset1 = { contentOffset.x, contentOffset.y + 1.0f };

     mTextView.contentOffset = contentOffset1;
     mTextView.contentOffset = contentOffset;
} 
```

* * *

尝试调用：

```
[tableView reloadData]; 
```

更新所有 textViews 之后。

# postgresql - 删除循环数据库关系

> ID：934970
> 
> 赞同：2
> 
> 时间：2009-06-01T14:05:40.253
> 
> 标签：postgresql, relationship, circular-reference

如何摆脱我的数据库结构中的循环关系。我有一个名为 Item 的实体。一个项目可以有一个子项目（循环关系）。一个项目可以有多个费率，具体取决于它是哪个财政年度（为此目的创建的 rate_per_year 实体和 1-m 关系）。如果一个项目有一个子项目，那么它可能没有费率（如果创建了一个子项目，我需要打破这种关系）。任何帮助将不胜感激。

提前感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T14:17:46.813

如果 item->subitem 链可以在多个级别上继续，那么您别无选择，但它就像您拥有它一样。如果只有顶级项目可以有子项目，那么您可以将结构分成两层，可能`item`和`group`where 只能`item`有一个速率，并且可能有也可能没有`group`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T15:56:12.473

您所描述的是零件爆炸问题。上大学的时候，这是关系型数据库无法解决的问题，也是面向对象数据库的主要卖点之一。看来事情现在可能已经发生了，这取决于您使用的数据库。

这个页面看起来很有趣 [Sql Anywhere 用户指南 - 部件爆炸问题](http://www.ianywhere.com/developer/product_manuals/sqlanywhere/0901/en/html/dbugen9/00000338.htm)，但遗憾的是您没有提及您使用的是哪个 RDBMS。SQL Server 2005 似乎也支持它，所以也许你会走运。尝试搜索“递归 SQL 查询”以及您使用的任何数据库。

祝你好运

# .net - WCF 在创建 ServiceHost 时为“System.ServiceModel”抛出 FileNotFound 异常

> ID：934980
> 
> 赞同：1
> 
> 时间：2009-06-01T14:08:09.123
> 
> 标签：.net, wcf, web-services, exception, fusion

我遇到了 WCF 的一个非常奇怪的问题。我在一个解决方案中有 2 个项目，每个项目都启动了一些自托管的 WCF 服务。

项目一：

```
myService = new ServiceHost(typeof(MyService1)); 
```

运行良好。但是，当我尝试运行我的第二个项目时，其中包含：

```
meService = new ServiceHost(typeof(MyOtherService)); 
```

我得到了例外：

```
FileNotFoundException
Could not load file or assembly 'System.ServiceModel' or one of its dependencies.
The system cannot find the file specified.":"System.ServiceModel 
```

融合日志：

```
=== Pre-bind state information ===
LOG: User = removed\removed
LOG: DisplayName = System.ServiceModel
 (Partial)
LOG: Appbase = file:///C:/Work/MySln/MyProj/bin/Dev
LOG: Initial PrivatePath = NULL
Calling assembly : System.ServiceModel, Version=3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089.
===
LOG: This bind starts in default load context.
LOG: Using application configuration file: C:\Work\MySln\MyProj\bin\Dev\MyProj.dll.temp.config
LOG: Using machine configuration file from c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\config\machine.config.
LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).
LOG: Attempting download of new URL file:///C:/Work/MySln/MyProj/bin/Dev/System.ServiceModel.DLL.
LOG: Attempting download of new URL file:///C:/Work/MySln/MyProj/bin/Dev/System.ServiceModel/System.ServiceModel.DLL.
LOG: Attempting download of new URL file:///C:/Work/MySln/MyProj/bin/Dev/System.ServiceModel.EXE.
LOG: Attempting download of new URL file:///C:/Work/MySln/MyProj/bin/Dev/System.ServiceModel/System.ServiceModel.EXE. 
```

真正奇怪的是，在调试器中，当我得到这个异常时，我可以进入 Visual Studio 中的“QuickWatch”并输入：

```
new MyOtherService()  // returns new instance properly
new ServiceHost()     // returns new instance properly
new ServiceHost(typeof(MyOtherService))  // throws exception, same as above. 
```

我尝试在调试时运行 SysInternals File System Watcher，但除了 devenv.exe 试图跟踪 .pdb 文件以生成堆栈跟踪之外，它没有显示任何“FileNotFound”错误。

有人对看什么有其他想法吗？

* * *

**更新#1**

我查看了该过程的融合日志，似乎发生了一些奇怪的事情。System.ServiceModel 有 2 个日志条目，背靠背：

```
*** Assembly Binder Log Entry  (6/1/2009 @ 10:26:48 AM) ***

The operation was successful.
Bind result: hr = 0x0\. The operation completed successfully.

Assembly manager loaded from:  c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll
Running under executable  C:\Program Files\TestDriven.NET 2.0\ProcessInvocation.exe
--- A detailed error log follows. 

=== Pre-bind state information ===
LOG: User = removed\removed
LOG: DisplayName = System.ServiceModel, Version=3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
 (Fully-specified)
LOG: Appbase = file:///C:/Work/MySln/PFWebIntgTests/bin/Dev
LOG: Initial PrivatePath = NULL
LOG: Dynamic Base = NULL
LOG: Cache Base = C:\Documents and Settings\removed\Local Settings\Temp\TestDrivenShadowCopy\633794488082894732
LOG: AppName = domain-nunit.addin.dll
Calling assembly : PFWebIntgTests, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null.
===
LOG: This bind starts in default load context.
LOG: Using application configuration file: C:\Work\MySln\PFWebIntgTests\bin\Dev\PFWebIntgTests.dll.temp.config
LOG: Using machine configuration file from c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\config\machine.config.
LOG: Post-policy reference: System.ServiceModel, Version=3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
LOG: Found assembly by looking in the GAC.
LOG: Binding succeeds. Returns assembly from C:\WINDOWS\assembly\GAC_MSIL\System.ServiceModel\3.0.0.0__b77a5c561934e089\System.ServiceModel.dll.
LOG: Assembly is loaded in default load context. 
```

然后是第二个条目：

```
*** Assembly Binder Log Entry  (6/1/2009 @ 10:26:52 AM) ***

The operation failed.
Bind result: hr = 0x80070002\. The system cannot find the file specified.

Assembly manager loaded from:  c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll
Running under executable  C:\Program Files\TestDriven.NET 2.0\ProcessInvocation.exe
--- A detailed error log follows. 

=== Pre-bind state information ===
LOG: User = removed\removed
LOG: DisplayName = System.ServiceModel
 (Partial)
LOG: Appbase = file:///C:/Work/MySln/PFWebIntgTests/bin/Dev
LOG: Initial PrivatePath = NULL
LOG: Dynamic Base = NULL
LOG: Cache Base = C:\Documents and Settings\removed\Local Settings\Temp\TestDrivenShadowCopy\633794488082894732
LOG: AppName = domain-nunit.addin.dll
Calling assembly : System.ServiceModel, Version=3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089.
===
LOG: This bind starts in default load context.
LOG: Using application configuration file: C:\Work\MySln\PFWebIntgTests\bin\Dev\PFWebIntgTests.dll.temp.config
LOG: Using machine configuration file from c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\config\machine.config.
LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).
LOG: Attempting download of new URL file:///C:/Work/MySln/PFWebIntgTests/bin/Dev/System.ServiceModel.DLL.
LOG: Attempting download of new URL file:///C:/Work/MySln/PFWebIntgTests/bin/Dev/System.ServiceModel/System.ServiceModel.DLL.
LOG: Attempting download of new URL file:///C:/Work/MySln/PFWebIntgTests/bin/Dev/System.ServiceModel.EXE.
LOG: Attempting download of new URL file:///C:/Work/MySln/PFWebIntgTests/bin/Dev/System.ServiceModel/System.ServiceModel.EXE.
LOG: All probing URLs attempted and failed. 
```

所以它似乎尝试加载 System.ServiceModel 两次，一次从本地应用程序目录而不是 GAC？我很困惑...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T15:17:36.800

**发现我的问题：**

对于这两个项目（我们称它们为 MyProj1 和 MyProj2），我在 .dll.config 文件中有这一行：

```
<serviceAuthorization principalPermissionMode="Custom" serviceAuthorizationManagerType="System.ServiceModel.ServiceAuthorizationManager, System.ServiceModel" /> 
```

Proj1 运行良好，Proj2 失败但上述异常。出于某种原因，仅在 Proj2 中，它仅在尝试解析“System.ServiceModel”时查看我的私人 \bin 文件夹。

如果我将上面的行更改为具有完整的程序集名称：

```
<serviceAuthorization principalPermissionMode="Custom" serviceAuthorizationManagerType="System.ServiceModel.ServiceAuthorizationManager, System.ServiceModel, Version=3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" /> 
```

一切都恢复正常。多么奇怪......我不知道为什么完全相同的配置参考适用于一个项目而不是另一个，但是嘿......至少我现在可以回去工作了:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T14:10:41.583

几个问题：

*   您的两个项目是否至少针对 .NET 框架 3.0 或更高版本？
*   你能告诉我们这两个服务实现的接口，以及服务实现类本身的粗略轮廓吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T14:12:05.280

我会尝试删除第二个项目中的引用并将其重新添加到 System.ServiceModel 程序集中。也许另一个开发人员使用本地文件而不是 GAC 版本添加了它，这会导致您的本地环境出现问题？

# sql - SQL 中的 Where 语句

> ID：934985
> 
> 赞同：0
> 
> 时间：2009-06-01T14:09:41.650
> 
> 标签：sql, sql-server-2005

我的数据主要在数据库的一个表中使用，并在几个不同的表中引用。我需要更正数据。是否可以编写一个“where-used”语句来搜索数据库中的每个表并返回引用数据的所有表？

我正在使用 SQL 2005。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T14:18:45.857

我在[这里](http://blog.sqlauthority.com/2007/09/16/sql-server-2005-list-all-the-constraint-of-database-find-primary-key-and-foreign-key-constraint-in-database/)找到了这个 sql 语句：

```
SELECT OBJECT_NAME(OBJECT_ID) AS NameofConstraint,
SCHEMA_NAME(schema_id) AS SchemaName,
OBJECT_NAME(parent_object_id) AS TableName,
type_desc AS ConstraintType
FROM sys.objects
WHERE type_desc LIKE '%CONSTRAINT'
AND  OBJECT_NAME(OBJECT_ID) LIKE 'FK_%' 
```

注意：- 我以*FK_*开头命名所有外键约束，因此很容易过滤它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T15:23:38.880

如果数据库中实际存在外键，您可以对数据库进行反向工程（请参阅[此发布的脚本以获取执行此操作的脚本）。](https://stackoverflow.com/questions/181909/tool-for-scripting-table-data/181942#181942)如果不是这种情况，那么您可以进行一些手动侦探工作。

Visio 专业版有一个用于对数据库进行逆向工程的工具。2003 不能很好地与 SQL Server 2005 配合使用，因此您需要：

*   视觉 2007

*   修改上面链接的脚本，使其不生成架构引用并将脚本加载到 SQL Server 2000 数据库中。然后，从 SQL 2000 DB 进行逆向工程。

如果您没有外键或外键覆盖不完整，您可以手动查找它们（例如，查找具有相似外观代码的字段以引用数据）并手动注释图表中的键。不要尝试使用 SSMS 中的图表工具执行此操作，因为它可能会尝试将 FK 填充回数据库中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T14:14:40.767

尝试将图表添加到数据库中，然后将所有表放到其中。如果我正确解释了您的问题，您是在尝试理解已经存在的数据库模式吗？如果您使用图表，它将为您绘制参考资料，这将允许您查看数据在表结构中的链接位置。

至于 SQL，您可以使用连接或 where 条件来链接来自不同表的数据。

你想“纠正”什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T14:20:56.133

在 Management Studio 中，您可以右键单击表/视图/存储过程并选择查看依赖关系。在依赖项窗口中，您可以选择查看选定项所依赖的对象或查看依赖于选定项的项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T14:27:02.083

事后您不能这样做，但在表设计时您可以设置与“ON UPDATE CASCADE”的关系。

# c# - 从 Sitefinity 中删除模块

> ID：934988
> 
> 赞同：0
> 
> 时间：2009-06-01T14:10:41.507
> 
> 标签：c#, asp.net, sitefinity

如何从 Sitefinity 中删除模块？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T00:25:37.800

**编辑：**这仅适用于 Sitefinity 3.x

这取决于你想清理多远。

如果您想简单地禁用模块，可以通过 web.config 查找以下部分来完成：

```
 <telerik><framework><modules> 
```

只需从那里删除模块，Sitefinity 就不会加载该模块。

**可选的**

接下来的步骤是完全可选的，但将完全删除一个模块。

然后更进一步，您可以从 Bin 文件夹中删除代表模块的 dll，例如 Telerik.Blogs 和 Telerik.Blogs.Data 用于博客模块，所有模块都以这种方式命名。

在 web.config 中搜索对模块的任何引用：例如在部分中

*   节组
*   泰勒里克
*   工具箱
*   元字段

然后根据您使用的 Sitefinity 版本和您使用的模块进行进一步清理。

**某些模块无法删除，例如图像和文档以及通用内容，因为它们在 CMS 页面中是不可或缺的**

我刚刚还发现 Telerik 有一篇关于此的[知识库文章](http://www.sitefinity.com/support/knowledge-base/kb-article/b1154K-bbgc-b1154T-cgh.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T14:16:15.833

我对 Sitefinity 了解不多，但我相信您可以在他们的**[支持页面](http://www.sitefinity.com/support/get-support.aspx)**上找到您正在寻找的内容，您会找到视频、论坛、博客文章。

如果您没有找到好的答案，您也可以在那里提交支持票。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-01T20:56:55.350

您可以通过从 web.config 文件中的 <telerik/framework/modules> 节点注释掉一个模块来禁用它

您应该能够删除默认模块并将其替换为您自己的模块，但我建议您更改 web.config 的 < cmsEngine/Providers > 节点下的应用程序名称，以免与现有模块冲突。

# .net - ASP.NET 成员密码StrengthRegularExpression 和 GeneratePassword

> ID：934990
> 
> 赞同：3
> 
> 时间：2009-06-01T14:10:59.430
> 
> 标签：.net, asp.net, security, membership

asp.net 成员资格提供程序中的 generatePassword 方法只允许设置长度和字母数字字符。

但是还有属性 passwordStrengthRegularExpression

GeneratePassword 是否使用了上面的属性。如果它这样做会很棒，但我认为它没有？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T14:17:11.853

不，不幸的是它没有。请参阅[`GeneratePassword`](http://msdn.microsoft.com/en-us/library/system.web.security.membership.generatepassword.aspx)：

> GeneratePassword 方法创建的随机密码不能保证传递 PasswordStrengthRegularExpression 属性中的正则表达式。但是，随机密码将满足 MinRequiredPasswordLength 属性和 numberOfNonAlphanumericCharacters 参数建立的条件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T12:53:11.450

我有一个类似的问题并采取了以下方法；

```
newRndPwd = String.Empty;

do 
{
    newRndPwd = Membership.GeneratePassword(MinRequiredPasswordLength, MinRequiredNonAlphanumericCharacters)
}
while(!Regex.IsMatch(newRndPwd, PasswordStrengthRegularExpression) 
```**************