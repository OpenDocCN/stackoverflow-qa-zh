# StackOverflow 问答 000900000-000900999

# html - SELECT 元素在多选显示样式中不允许多选

> ID：900019
> 
> 赞同：5
> 
> 时间：2009-05-22T21:11:53.423
> 
> 标签：html

我想要一个以多选显示样式显示的元素（它--框而不是下拉菜单），但只允许您一次选择一个东西。那可能吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-22T21:15:59.080

这将显示一个列表框样式的选择元素，该元素一次只允许一个选定的项目：

```
<select size="3">
    <option>1</option>
    <option>2</option>
    <option>3</option>
</select> 
```

该`size`属性将控制控件中可见的行数。如果要允许选择多个项目，请将 multiple 属性添加到 select 元素：

```
<select size="3" multiple="multiple"> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T21:19:35.483

呈现 SELECT 元素的方式取决于实现。在大多数浏览器中，'multiple="1"' 为您提供了一个（可能是滚动的）选项框，而 multiple="0" 为您提供了一个下拉框，这是巧合。

没有标准可以说“我想要一个只允许选择一个选项的列表框”。

也可以看看：

[http://www.w3.org/TR/html401/interact/forms.html#h-17.6](http://www.w3.org/TR/html401/interact/forms.html#h-17.6)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T22:32:17.293

您可以编写 js 来取消选择任何额外的选择 onclick

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T21:18:19.417

带有列表项链接的有序列表`<ol>`或无序列表怎么样？`<ul>``<li>`

# .net - 如何使用内置的 .net 压缩类压缩目录？

> ID：900031
> 
> 赞同：2
> 
> 时间：2009-05-22T21:15:15.803
> 
> 标签：.net, compression

使用 System.IO.Compression 命名空间类 GZIPStream 和 DeflateStream 我可以成功地压缩和解压缩单个文件。但是，如果我将目录名作为压缩目标传递，则会出现安全异常。我是否必须（递归地）枚举所有文件和子目录才能压缩目录？

（可能来自 codeplex 的 dotnetzip 会更好地处理这个问题，但这不是我现在所追求的）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T21:20:13.580

当您使用`GZipStream`etc 时，您正在压缩**流**；不是文件。`GZip`没有文件头信息，所以没有明智的打包多个文件的方法。为此，您需要 .zip 之类的东西；#ziplib 将完成这项工作，但您仍然（IIRC）需要手动输入每个文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T21:27:06.827

这些`System.IO.Compression`类没有提供管理多文件档案的方法。您需要自己做一些工作来创建一种文件格式来跟踪存档中的内容。本文可能会帮助您入门：

[如何使用 GZipStream 和 C# (System.IO.Compression.GZipStream) 压缩文件夹和多个文件](http://www.vwd-cms.com/Forum/Forums.aspx?topic=18)

但是，如果您追求一种可以与只有 WinZip 或 WinRAR 的用户交换文件的格式，那么您最好研究一下[SharpZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/)之类的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T21:23:57.237

System.IO.Compression 中的类只会处理流，是的。您必须自己处理文件。我想，您可以使用[SharpZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/)或类似工具来 tar 文件，然后压缩生成的 tar 文件。简单（未经测试）：

```
using (Stream out = new FileStream("out.tar", FileMode.CreateNew))
{
    TarArchive archive = TarArchive.CreateOutputTarArchive(outStream
                                    , TarBuffer.DefaultBlockFactor);
    foreach (string name in fileNames)
    {
        TarEntry entry = TarEntry.CreateEntryFromFile(name);
        archive.WriteEntry(entry, true);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T22:09:55.303

人们之前已经提到过，内置的 .Net 类可以很好地压缩流而不是目录结构。

他们还提到，sharpziplib 等是很好的库，我同意。他们提供有用的 Zip 和 Tar 实现。

但是...如果您束手无策并且无法使用这些库，请记住[tar 格式](http://en.wikipedia.org/wiki/Tar_(file_format))非常简单。实现:) `Stream ToTar(string path`是一个相当简单直接的任务（与实现压缩算法不同）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-19T16:26:49.480

这将使用 Powershell 和 System.IO.Packaging.ZipPackage 将 .\in 内容压缩到 .\out.zip，如下[所示](http://www.winsoft.se/2010/12/easy-archiving-of-files-using-powershell/)

```
$zipArchive = $pwd.path + "\out.zip"
[System.Reflection.Assembly]::Load("WindowsBase,Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35")
$ZipPackage=[System.IO.Packaging.ZipPackage]::Open($zipArchive, [System.IO.FileMode]"OpenOrCreate", [System.IO.FileAccess]"ReadWrite")
$in = gci .\in | select -expand fullName
[array]$files = $in -replace "C:","" -replace "\\","/"
ForEach ($file In $files) {
   $partName=New-Object System.Uri($file, [System.UriKind]"Relative")
   $part=$ZipPackage.CreatePart($partName, "application/zip", [System.IO.Packaging.CompressionOption]"Maximum")
   $bytes=[System.IO.File]::ReadAllBytes($file)
   $stream=$part.GetStream()
   $stream.Write($bytes, 0, $bytes.Length)
   $stream.Close()
                                                    }
$ZipPackage.Close() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-12T22:49:56.473

您可以在纯 .NET 3.0 中压缩目录。

首先，您需要对 WindowsBase.dll 的引用。

此代码将打开或创建一个 zip 文件，在其中创建一个目录，并将文件放在该目录中。如果你想压缩一个文件夹，可能包含子目录，你可以遍历目录中的文件并为每个文件调用这个方法。然后，您可以深度优先搜索文件的子目录，为每个文件调用方法并传入路径以在 zip 文件中创建该层次结构。

```
public void AddFileToZip(string zipFilename, string fileToAdd, string destDir)
{
    using (Package zip = System.IO.Packaging.Package.Open(zipFilename, FileMode.OpenOrCreate))
    {
        string destFilename = "." + destDir + "\\" + Path.GetFileName(fileToAdd);
        Uri uri = PackUriHelper.CreatePartUri(new Uri(destFilename, UriKind.Relative));
        if (zip.PartExists(uri))
        {
            zip.DeletePart(uri);
        }
        PackagePart part = zip.CreatePart(uri, "", CompressionOption.Normal);

        using (FileStream fileStream = new FileStream(fileToAdd, FileMode.Open, FileAccess.Read))
        {
            using (Stream dest = part.GetStream())
            {
                CopyStream(fileStream, dest);
            }
        }
    }
} 
```

destDir 可以是一个空字符串，它将文件直接放在 zip 中。

资料来源： [https ://weblogs.asp.net/jongalloway/creating-zip-archives-in-net-without-an-external-library-like-sharpziplib](https://weblogs.asp.net/jongalloway/creating-zip-archives-in-net-without-an-external-library-like-sharpziplib)

[https://weblogs.asp.net/albertpascual/creating-a-folder-inside-the-zip-file-with-system-io-packaging](https://weblogs.asp.net/albertpascual/creating-a-folder-inside-the-zip-file-with-system-io-packaging)

# cross-compiling - 我的 scratchbox 2 安装使用 ARM gcc 构建来编译 ARM 目标。我该如何解决？

> ID：900040
> 
> 赞同：3
> 
> 时间：2009-05-22T21:17:22.447
> 
> 标签：cross-compiling, maemo, scratchbox

我正在使用scratchbox 2，maemo 开发交叉编译环境。在为 ARM 目标编译代码时，我认为 scratchbox 2 正在使用本机 ARM gcc 编译器，它在我的 x86 机器上运行非常慢。

我认为它应该使用为 x86 编译的 ARM 交叉编译器，它运行得更快。

抱歉暂时没有详细信息，但是有什么办法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T18:07:37.343

经过很长时间的努力，似乎最好的解决方案是简单地重新安装 Scratchbox 2。

确保删除以下目录：

```
~/.maemo-sdk
~/.scratchbox2
/opt/maemo 
```

然后运行：

```
apt-get install maemo-sdk --reinstall 
```

然后安装 Scratchbox2，不管你以前做过什么。

# sockets - 是什么导致 ENOTCONN 错误？

> ID：900042
> 
> 赞同：24
> 
> 时间：2009-05-22T21:17:58.887
> 
> 标签：sockets

我目前正在维护一些 Web 服务器软件，我需要执行很多 I/O 操作。、和调用在套接字上使用时`read()`，有时可能会引发错误。这个错误到底是什么意思？触发它的条件是什么？我似乎永远无法在本地复制它，但有些用户可以。`write()``close()``shutdown()``ENOTCONN`

现在我只是忽略`ENOTCONN`了`close()`，`shutdown()`因为它似乎无害，但我并不完全确定。

编辑：

*   我绝对确定`connect()`通话成功了。我检查它的返回值。
*   `ENOTCONN`最常由`close()`and提出`shutdown()`。我只是很少看到 a`read()`和`write()`raise `ENOTCONN`。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-24T02:49:21.203

如果您确定您的 TCP 连接端没有任何东西正在关闭连接，那么在我看来，远程端正在关闭连接。

`ENOTCONN`，正如其他人指出的那样，仅表示套接字未连接。这并不一定意味着`connect`失败。套接字很可能以前已连接，只是在调用时没有导致`ENOTCONN`.

这不同于：

*   `ECONNRESET`：连接的另一端发送了一个 TCP 重置包。如果另一端拒绝连接，或者不承认它已经连接等等，就会发生这种情况。
*   `ETIMEDOUT`: 这一般只适用于`connect`。如果连接尝试在取决于系统的时间内未成功，则可能会发生这种情况。

`EPIPE`有时可以由一些与套接字相关的系统调用在与`ENOTCONN`. 例如，在某些系统上，`EPIPE`和`ENOTCONN`由 . 返回时是同义词`send`。

虽然`shutdown`return并不罕见`ENOTCONN`，但由于这个函数应该断开 TCP 连接，我会惊讶地看到`close`return `ENOTCONN`。它真的不应该那样做。

最后，正如 dwc 所提到的，`EBADF`除非您尝试对已经`close`d 的文件描述符进行某些操作，否则不应适用于您的场景。使套接字断开连接（即 TCP 连接已断开）与关闭与该套接字关联的文件描述符不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T05:35:00.227

我相信 ENOTCONN 被返回，因为 shutdown() 不应该返回 ECONNRESET 或其他更准确的错误。

假设对方“只是”关闭了连接是错误的。在 TCP 级别上，对方只能半关闭连接（或中止它）。如果双方都执行shutdown()（或close()），则连接通常是完全关闭的。如果双方都这样做，则 shutdown() 实际上对他们双方都成功！

问题是 shutdown() 没有*成功*地普通（半）关闭连接，既不是第一个关闭它，也不是第二个。– 从 POSIX 文档中列出的 shutdown() 错误来看，ENOTCONN 是最不合适的，因为其他错误表明传递给 shutdown() 的参数存在问题（或处理请求的本地资源问题）。

所以发生了什么事？这些天来，涉及的两方之间的某个 NAT 设备可能已经放弃了关联并发送 RESET 数据包作为响应。重置连接对于 IPv4 来说非常常见，以至于您可以在代码中的任何位置获取它们，甚至在 shutdown() 中被屏蔽为 ENOTCONN。

编码错误也可能是原因。例如，在非阻塞套接字上，connect() 可以返回 0 而不表示连接成功。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-11T20:01:15.340

这是因为，在关闭（）套接字的那一刻，套接字缓冲区中有数据等待传递给已关闭（）或关闭（）其接收套接字的远程方。我还没有完全理解套接字是如何工作的，我是个菜鸟，我什至找不到实现这个“关闭”功能的文件，但是看到我开始的整个套接字几乎没有用户手册尝试所有可能性，直到我在“受控”环境中遇到错误。可能是别的东西，但经过多次尝试，这些是我解决的解释：

*   如果您在远程端关闭连接后发送数据，则当您关闭（）时，您会收到错误消息。
*   如果您在远程端关闭连接之前发送了数据，但在另一端没有收到（），您可以关闭（）一次，下次您尝试关闭（）时，您会收到错误消息。
*   如果你没有发送任何数据，你可以随时关闭，只要远程端没有shutdown(); 一旦远程端有shutdown()，如果你尝试shutdown()并且套接字已经shutdown()，你会得到错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T21:19:59.023

传输端点未连接

套接字与面向连接的协议相关联，尚未连接。这通常是一个编程缺陷。

来自：[http ://www.wlug.org.nz/ENOTCONN](http://www.wlug.org.nz/ENOTCONN)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T21:32:32.853

如果您确定一开始就已正确连接，`ENOTCONN`则很可能是由于`fd`您在请求中间时关闭了您的一端（可能在另一个线程中？），或者由当您在请求中间时连接断开。

无论如何，这意味着套接字未连接。继续清理那个套接字。它死了。打电话`close()`或`shutdown()`上它没问题。

# .net - 如何使用关键字以编程方式搜索谷歌并获得我的网站排名？

> ID：900043
> 
> 赞同：5
> 
> 时间：2009-05-22T21:18:16.780
> 
> 标签：.net, javascript, web-services

我想使用带有关键字和网站 url 的 javascript 调用 google 服务，并在使用此关键字搜索时从 google 获取该站点的位置。

这个有可能？可以仅使用 javascript 完成还是需要服务器端语言？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T21:22:08.223

这个链接看起来很有希望：[Getting google page rank using javascript](http://abhinavsingh.com/blog/2009/04/getting-google-page-rank-using-javascript-for-adobe-air-apps/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T01:00:26.207

使用 JavaScript 查询另一个不是提供 HTML 的域时，您将遇到安全问题。

如果您可以编写自己的服务，最好的选择（用于抓取）是向此页面发送查询：[http](http://www.google.com/ie) ://www.google.com/ie 。它提供了可以用正则表达式解析的干净的 HTML。这个页面也很不错，你可以传入[一个“num”参数](http://www.google.com/ie?q=lucky&hl=en&num=100)，一次得到不止 10 个结果。（如果您正在寻找完美的结果，这样做时您不会得到与一次 10 个完全相同的结果）。

通过在您的服务器上运行这样的服务，您的 JavaScript 代码不会有任何问题，直到 Google 注意到来自您服务器 IP 地址的太多查询并决定将您列入黑名单。;)

我还建议使用 Google 的 AJAX 搜索 API，如果你可以忍受它被限制为 64 个总结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-18T14:34:39.847

您可以使用我的 PHP 类，它通过 Google AJAX 搜索 API 进行搜索并检查您的域/URL 的结果。如果您想知道竞争对手的排名，您还可以检查不同的域/URL：

[http://bohuco.net/blog/2010/07/google-ranking-checker-class-in-php/](http://bohuco.net/blog/2010/07/google-ranking-checker-class-in-php/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T21:27:41.177

您可以使用[Google 搜索 API](http://code.google.com/intl/en-US/apis/ajaxsearch/web.html)从 AJAX 中的应用程序或页面开发任何搜索

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T21:28:13.063

不完全是你想要的，但[谷歌网站管理员工具](https://www.google.com/webmasters/tools)会列出你网站的热门搜索以及你的结果有多远。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T03:08:31.130

您可以只使用 curl 和 regexp 来获取结果，但如果您进行大量调用（并返回虚假结果），Google 会捕捉到您抓取结果，因此您必须拥有完整的标头支持。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-23T05:07:24.540

Kevin Pullin 给出的第一个链接确实有效。您可以使用 SEO Analyzer 从 code.google.com/p/seoanalyzer 下载所需内容

# iphone - 为什么我的 Quartz 弧线显示的比直线粗？

> ID：900053
> 
> 赞同：4
> 
> 时间：2009-05-22T21:21:29.817
> 
> 标签：iphone, objective-c, core-graphics, antialiasing

我正在尝试创建一个看起来像 UIButtonTypeRoundedRect 的自定义 UIButton。在我的 drawRect: 中，我正在创建一个路径，首先调用 CGContextMoveToPoint()，然后调用 CGContextAddArc() 四个。然后我抚摸路径。但是，在生成的图像中，四个圆角明显比路径的其余部分厚。

我怀疑这与抗锯齿有关，所以我尝试使用 CGContextSetShouldAntiAlias() 将其关闭，但后来看起来更糟。我也尝试过线宽，但弧线总是比直线粗。Apple 的 UIButtonTypeRoundedRect 看起来非常好，所以一定有可能以某种方式解决。有人有线索吗？

编辑：相关代码：

```
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextBeginPath(context);

CGContextMoveToPoint(context, rect.origin.x + kRoundedRectButtonRadius, rect.origin.y);
CGContextAddArc(context, rect.origin.x + rect.size.width - kRoundedRectButtonRadius, rect.origin.y + kRoundedRectButtonRadius, kRoundedRectButtonRadius, 3 * M_PI_2, 0, NO);
CGContextAddArc(context, rect.origin.x + rect.size.width - kRoundedRectButtonRadius, rect.origin.y + rect.size.height - kRoundedRectButtonRadius, kRoundedRectButtonRadius, 0, M_PI_2, NO);
CGContextAddArc(context, rect.origin.x + kRoundedRectButtonRadius, rect.origin.y + rect.size.height - kRoundedRectButtonRadius, kRoundedRectButtonRadius, M_PI_2, M_PI, NO);
CGContextAddArc(context, rect.origin.x + kRoundedRectButtonRadius, rect.origin.y + kRoundedRectButtonRadius, kRoundedRectButtonRadius, M_PI, 3 * M_PI_2, NO);

CGContextClosePath(context);
CGContextSetLineWidth(context, 1.7);
CGContextStrokePath(context); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-22T21:53:06.710

我之前在绘制自定义按钮时遇到过这种情况。您看到的行为源于可可的绘图例程以您要求它们的像素位置*为中心绘制线条的事实。*让我解释。

您绘制的直线落在按钮矩形的最边缘。当您的绘图例程被调用时，Cocoa 方便地将剪切区域设置为按钮矩形的确切边界，但是当您要求 Cocoa 沿边缘绘制一条线时，*恰好一半的线被绘制在剪切矩形之外*。

您会注意到圆角的差异，因为弯曲部分完全落在剪切矩形内，因此没有一个被剪切掉。

现在解决方案：

让我们假设您正在绘制的线条正好是两个像素厚。这意味着在剪切矩形内绘制一个像素，在外部绘制一个像素（因此被忽略）。您所要做的就是在距离矩形中心更近一个像素处绘制线条。在自定义绘图例程的情况下，您可能正在使用：

```
NSRect myBounds = [self bounds]; 
```

然后从那里计算你的角点。Insead，使用：

```
NSRect myProperBounds = NSInsetRect([self bounds], 1.0, 1.0); 
```

你应该很高兴。

# sql - SQL 甚至 TSQL 图灵完备吗？

> ID：900055
> 
> 赞同：198
> 
> 时间：2009-05-22T21:21:37.927
> 
> 标签：sql, tsql, programming-languages, language-features

这是今天办公室里出现的。我没有做这种事情的计划，但理论上你能用 SQL 写一个编译器吗？乍一看，它似乎是图灵完备的，尽管对于许多类别的问题来说非常麻烦。

如果它不是图灵完备的，它需要什么？

注意：我不想做任何事情，比如用 SQL 编写编译器，我知道这样做很愚蠢，所以如果我们能避免讨论，我将不胜感激。

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2011-09-28T07:59:35.277

事实证明，即使没有真正的“脚本”扩展，例如 PL/SQL 或 PSM（它们被设计为真正的编程语言，所以这有点作弊），SQL 也可以是图灵完备的。

在[这组幻灯片](http://assets.en.oreilly.com/1/event/27/High%20Performance%20SQL%20with%20PostgreSQL%20Presentation.pdf)中，Andrew Gierth 通过构建[循环标签系统](http://mathworld.wolfram.com/CyclicTagSystem.html)证明了 CTE 和 Windowing SQL 是图灵完备的，已被证明是图灵完备的。然而，CTE 特性是重要的部分——它允许您创建可以引用自身的命名子表达式，从而递归地解决问题。

有趣的是，添加 CTE 并不是为了将 SQL 转变为编程语言——只是为了将声明式查询语言转变为更强大的声明式查询语言。有点像在 C++ 中，其模板被证明是图灵完备的，尽管它们并非旨在创建元编程语言。

哦，[SQL 示例中的 Mandelbrot 集](http://wiki.postgresql.org/wiki/Mandelbrot_set)也非常令人印象深刻 :)

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2016-01-18T04:47:41.637

> 如果可以证明给定的编程语言在计算上等同于图灵机，则称该编程语言是图灵完备的。

TSQL 是图灵完备的，因为我们可以在 TSQL 中制作[BrainFuck](https://en.wikipedia.org/wiki/Brainfuck)解释器。

[SQL 中的 BrainFuck 解释器 - GitHub](https://github.com/PopovMP/BrainFuck-SQL)

提供的代码在内存中工作，不会修改数据库。

```
-- Brain Fuck interpreter in SQL

DECLARE @Code  VARCHAR(MAX) = ', [>,] < [.<]'
DECLARE @Input VARCHAR(MAX) = '!dlroW olleH';

-- Creates a "BrainFuck" DataBase.
-- CREATE DATABASE BrainFuck;

-- Creates the Source code table
DECLARE @CodeTable TABLE (
    [Id]      INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
    [Command] CHAR(1) NOT NULL
);

-- Populate the source code into CodeTable
DECLARE @CodeLen INT = LEN(@Code);
DECLARE @CodePos INT = 0;
DECLARE @CodeChar CHAR(1);

WHILE @CodePos < @CodeLen
BEGIN
    SET @CodePos  = @CodePos + 1;
    SET @CodeChar = SUBSTRING(@Code, @CodePos, 1);
    IF @CodeChar IN ('+', '-', '>', '<', ',', '.', '[', ']')
        INSERT INTO @CodeTable ([Command]) VALUES (@CodeChar)
END

-- Creates the Input table
DECLARE @InputTable TABLE (
    [Id]   INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
    [Char] CHAR(1) NOT NULL
);

-- Populate the input text into InputTable
DECLARE @InputLen INT = LEN(@Input);
DECLARE @InputPos INT = 0;

WHILE @InputPos < @InputLen
BEGIN
    SET @InputPos = @InputPos + 1;
    INSERT INTO @InputTable ([Char])
    VALUES (SUBSTRING(@Input, @InputPos, 1))
END

-- Creates the Output table
DECLARE @OutputTable TABLE (
    [Id]   INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
    [Char] CHAR(1) NOT NULL
);

-- Creates the Buffer table
DECLARE @BufferTable TABLE (
    [Id]     INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
    [Memory] INT DEFAULT 0  NOT NULL
);
INSERT INTO @BufferTable ([Memory])
VALUES (0);

-- Initialization of temporary variables 
DECLARE @CodeLength INT = (SELECT COUNT(*) FROM @CodeTable);
DECLARE @CodeIndex  INT = 0;
DECLARE @Pointer    INT = 1;
DECLARE @InputIndex INT = 0;
DECLARE @Command    CHAR(1);
DECLARE @Depth      INT;

-- Main calculation cycle
WHILE @CodeIndex < @CodeLength
BEGIN
    -- Read the next command.
    SET @CodeIndex = @CodeIndex + 1;
    SET @Command = (SELECT [Command] FROM @CodeTable WHERE [Id] = @CodeIndex);

    -- Increment the pointer.
    IF @Command = '>'
    BEGIN
        SET @Pointer = @Pointer + 1;
        IF (SELECT [Id] FROM @BufferTable WHERE [Id] = @Pointer) IS NULL
            INSERT INTO @BufferTable ([Memory]) VALUES (0);
    END

    -- Decrement the pointer.
    ELSE IF @Command = '<'
        SET @Pointer = @Pointer - 1;

    -- Increment the byte at the pointer.
    ELSE IF @Command = '+'
        UPDATE @BufferTable SET [Memory] = [Memory] + 1 WHERE [Id] = @Pointer;

    -- Decrement the byte at the pointer.
    ELSE IF @Command = '-'
        UPDATE @BufferTable SET [Memory] = [Memory] - 1 WHERE [Id] = @Pointer;

    -- Output the byte at the pointer.
    ELSE IF @Command = '.'
        INSERT INTO @OutputTable ([Char]) (SELECT CHAR([Memory]) FROM @BufferTable WHERE [Id] = @Pointer);

    -- Input a byte and store it in the byte at the pointer.
    ELSE IF @Command = ','
    BEGIN
        SET @InputIndex = @InputIndex + 1;
        UPDATE @BufferTable SET [Memory] = COALESCE((SELECT ASCII([Char]) FROM @InputTable WHERE [Id] = @InputIndex), 0) WHERE [Id] = @Pointer;
    END

    -- Jump forward past the matching ] if the byte at the pointer is zero.
    ELSE IF @Command = '[' AND COALESCE((SELECT [Memory] FROM @BufferTable WHERE [Id] = @Pointer), 0) = 0
    BEGIN
        SET @Depth = 1;
        WHILE @Depth > 0
        BEGIN
            SET @CodeIndex = @CodeIndex + 1;
            SET @Command = (SELECT [Command] FROM @CodeTable WHERE [Id] = @CodeIndex);
            IF @Command = '[' SET @Depth = @Depth + 1;
            ELSE IF @Command = ']' SET @Depth = @Depth - 1;
        END
    END

    -- Jump backwards to the matching [ unless the byte at the pointer is zero.
    ELSE IF @Command = ']' AND COALESCE((SELECT [Memory] FROM @BufferTable WHERE [Id] = @Pointer), 0) != 0
    BEGIN
        SET @Depth = 1;
        WHILE @Depth > 0
        BEGIN
            SET @CodeIndex = @CodeIndex - 1;
            SET @Command = (SELECT [Command] FROM @CodeTable WHERE [Id] = @CodeIndex);
            IF @Command = ']' SET @Depth = @Depth + 1;
            ELSE IF @Command = '[' SET @Depth = @Depth - 1;
        END
    END
END;

-- Collects and prints the output
DECLARE @Output VARCHAR(MAX);
SELECT @Output = COALESCE(@Output, '') + [Char]
FROM @OutputTable;

PRINT @Output;
Go 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-05-22T21:23:56.583

[https://web.archive.org/web/20110807062050/http://channel9.msdn.com/forums/TechOff/431432-SQL-Turing-Completeness-question](https://web.archive.org/web/20110807062050/http://channel9.msdn.com/forums/TechOff/431432-SQL-Turing-Completeness-question)

是对这个话题的讨论。一个报价：

> SQL 本身（即 SQL92 标准）不是图灵完备的。但是，很多从SQL衍生出来的语言，比如Oracle的PL/SQL和SQL Server的T-SQL等都是图灵完备的。
> 
> PL/SQL 和 T-SQL 肯定符合编程语言的条件，SQL92 本身是否符合条件还有待商榷。有人声称，任何告诉计算机该做什么的代码都可以称为编程语言。按照这个定义，SQL92 就是其中之一，但 HTML 也是。这个定义相当模糊，在我看来争论是没有意义的。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-05-23T09:41:16.943

严格来说，SQL 现在是图灵完备的语言，因为最新的 SQL 标准包括“持久存储模块”（PSM）。简而言之，PSM 是 Oracle 中 PL/SQL 语言的标准版本（以及当前 DBMS 的其他类似过程扩展）。

随着这些 PSM 的加入，SQL 变得图灵完备

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-07-23T22:07:57.733

最初在 SQL-86 中定义的 ANSI 选择语句不是图灵完备的，因为它总是终止（递归 CTE 除外，并且仅当实现支持任意深度递归时）。因此无法模拟任何其他图灵机。存储过程已经完成，但那是作弊 ;-)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-09-05T20:56:51.147

简单地说，执行这个查询：

```
select * 
from (SELECT 0 union SELECT 1) 
JOIN (SELECT 0 union SELECT 1) 
JOIN (SELECT 0 union SELECT 1)  
JOIN (SELECT 0 union SELECT 1)  
JOIN (SELECT 0 union SELECT 1) 
JOIN (SELECT 0 union SELECT 1)  
JOIN (SELECT 0 union SELECT 1) 
JOIN (SELECT 0 union SELECT 1) 
```

您将生成前 256 个 8 位数字。现在使用 SELECT、AND 和 OR 的组合，您可以编写任何 8 位机器。

如您所见，没有涉及表，只有选择、联合和连接

对我来说，这看起来像图灵完整

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-01-07T11:50:20.390

Oracle 的 PLSQL 和 Microsoft 的 TSQL 都图灵完备。Oracle 的 select 语句本身也是图灵完备的。

# c - 检查一个套接字是否在 C 中断开，没有 select()

> ID：900074
> 
> 赞同：0
> 
> 时间：2009-05-22T21:28:14.827
> 
> 标签：c, sockets

有什么方法可以检查远程端的套接字是否在 C 中没有 select() 的情况下断开连接？

我不想使用 select() 的原因是，在我的缓冲区已满的情况下，可能有数据可用于读取我有意忽略的套接字，并且 select(readfds=[socket_fd]) 将始终立即返回让我知道。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T21:32:16.033

如果套接字上有一个阻塞的 read() 函数调用，它返回整数值 0，这意味着套接字连接已关闭。

```
while ( n = read(sockfd, buffer, BUFFER_SIZE) ) {
     //use buffer contents
} 
```

当从另一端发送数据时，此循环将继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T21:36:00.707

因此，请`poll()`改用，设置`events`为您关心的内容并检查结果`revents`。仅供参考，您可以调用`select()`或`poll()`不损坏套接字或更改其缓冲区。

# apache-flex - 从左侧调整 Flex/Flash 对象的大小？

> ID：900081
> 
> 赞同：1
> 
> 时间：2009-05-22T21:31:22.697
> 
> 标签：apache-flex, flash, actionscript-3

我正在开发可以使用左右手柄调整大小的 Flex 组件（也就是说，如果单击并拖动左侧，组件将向左增长，如果单击并拖动右侧，它将向右增长）。

现在我正在使用：

```
var oldX:Number = this.x;
this.x = event.stageX + (initial.x - initial.stageX); // Move the left edge to the left
this.width += oldX - this.x; // Increase the width to compensate for the move to the left 
```

但这会使右侧跳来跳去，通常看起来很难看。

这样做的“权利”是什么？我有什么基本的错误吗？

谢谢！

**编辑**：抖动发生在组件的右侧。当我设置`this.x`时，组件向左移动，屏幕重绘，然后宽度更新，屏幕再次重绘。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T14:47:07.083

我不是 Flex 人，但我想你的抖动与内部使用的 Flex 框架有关，`Stage.invalidate()`或者在帧执行期间导致重绘。

我想可能有一种“框架”方式来处理这个问题，但是为了让你的改变变成一个原子操作，你可以直接更新对象的变换，沿着这些线：

```
var dx:Number = // however you're finding this
var m:Matrix = new Matrix();
m.scale( scaleX*(width-dx)/width, scaleY );
m.translate( x+dx, y );
transform.matrix = m; 
```

这应该适用于简单的图形，但我不确定它是否适用于可能需要捕获尺寸已更改的事件并重绘自身的组件。我认为这是使您的更新原子化的唯一方法，因此如果这些方面的某些内容没有帮助，那么您将需要框架上更多人的回答。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-16T23:33:04.053

有同样的问题。

问题是舞台不够清爽。

只需添加 stage.invalidate(); 在你的2个任务之后......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T21:56:13.083

根据您设置句柄的侦听器的方式，问题可能是一遍又一遍地调用调整大小代码，因为当您为组件设置新的 x 位置时，句柄将在鼠标光标下有效地调用调整大小再次编码等等。

# java - 将常春藤依赖项指向本地文件？

> ID：900084
> 
> 赞同：2
> 
> 时间：2009-05-22T21:32:58.030
> 
> 标签：java, ivy

我有一个主项目，其中模块 A 依赖于为模块 B 构建创建的 .jar 文件。在开发过程中，我定期修改 B，然后构建 B 以创建库，然后构建 A 到使用这些更改。

有没有办法将模块 A 的常春藤文件指向我的模块 B 构建创建的 jar 文件？鉴于我多次迭代，我不想一遍又一遍地将模块 B 的 jar 放入 ivy 中。在构建每个模块 B 之后，必须将 jar 复制到模块 A 的构建目录结构中也很烦人。

实际上，对我来说情况更糟，因为我在某个依赖树（A->B->CD）中有大约 4 个模块。如果只是 A 和 B，我可能会忍受它，但我厌倦了在子模块构建后复制 jar 文件，并认为是否有办法覆盖 ivy 文件依赖行以在本地查看然后会让生活变得简单很多。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T22:02:15.287

将 Ivy 依赖项指向本地构建的模块并不是解决此问题的方法。相反，当您构建模块 B 时，将其发布到您的本地 Ivy 存储库。当您解决模块 A 的依赖关系时，它将从本地存储库中拉下模块 B。

[来自本地存储库上的常春藤文档](http://ant.apache.org/ivy/history/2.2.0/tutorial/defaultconf.html)：

> 当您想要做某事而不受环境中发生的任何其他事情的干扰时，本地存储库特别有用。这意味着只要 ivy 能够在此存储库中找到一个模块，它就会被使用，无论其他模块有什么可用的。
> 
> 例如，如果您有一个模块在修订 latest.integration 中声明了对模块 foo 的依赖关系，那么如果在本地存储库中找到了 foo 的修订，它将被使用，即使其他存储库中存在更新的修订.
> 
> 这可能会让你们中的一些人感到不安，但是假设您必须在项目中实现一个新功能，并且为了实现这一点，您需要修改两个模块：您在模块 foo 中添加一个新方法并在模块中利用这个新方法酒吧。然后，如果您将模块 foo 发布到本地存储库，您将确保在您的 bar 模块中获取它，即使其他人在共享存储库中发布了 foo 的新修订（此修订没有您当前添加的新方法）。
> 
> 但请注意，当您完成开发并将其发布到共享上时，您必须清理本地存储库以从共享存储库中发布的新版本中受益。
> 
> 还要注意，在本地存储库中找到的模块必须是完整的，即它们必须提供模块描述符和已发布的工件。

在[多个项目环境中使用 Ivy](http://ant.apache.org/ivy/history/2.2.0/tutorial/multiproject.html)文档有一个示例`publish-local`Ant 任务，您可能会发现它很有用。

# filenames - 使用文件名列表创建文件并向每个文件添加内容

> ID：900085
> 
> 赞同：0
> 
> 时间：2009-05-22T21:33:01.790
> 
> 标签：filenames, createfile

我需要制作一堆重定向页面，因为我最近更新了以前使用 .html 文件的网站，现在所有文件都是 .aspx。我有一个制表符分隔的文件，其中包含原始文件名列表和相应的新文件名。

似乎应该有一种语言，我应该能够使用第一列作为文件名创建文件，并插入第二列作为其内容，并为 301 重定向添加一些附加文本。

有人可以为我指出正确的方向，什么语言可以做到这一点吗？此外，如果您还可以指出我将使用的方法/函数的名称，那么我知道在创建文件时从哪里开始。

我需要多次做这类事情，并且愿意学习一门新语言（Perl、Python 或其他）来完成此任务，但我只需要指出正确的方向。我正在使用 Windows XP 进行开发。

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T22:29:11.990

这可以在几行 C# 中完成，如果您已经在使用 aspx，您可以在虚拟页面上的代码隐藏中处理它。

```
System.IO.StreamReader myreader = new System.IO.StreamReader(Server.MapPath("~/Text.txt"));
        while (!myreader.EndOfStream)
        {
            //9 is Ascii value of Tab  bad idea to split if the second set of values might contain tabs but can reconstruct the data if inputString.length >2
            string[] inputString = myreader.ReadLine().Split(char.ConvertFromUtf32(9).ToCharArray());
            //construct the path to where you want to save the file, or if the filename is the full path all the better
            System.IO.StreamWriter filemaker = new System.IO.StreamWriter(@"C:\" + inputString[0]);
            filemaker.Write(inputString[1]);
            filemaker.Close();
        } 
```

# iphone - 如何更改 UITableView 中文本的位置？

> ID：900086
> 
> 赞同：1
> 
> 时间：2009-05-22T21:33:34.957
> 
> 标签：iphone, cocoa-touch, uitableview

如何更改文本的位置并在 UITableView 中显示完整的字符串？

这是我所拥有的屏幕截图，一旦你看到它，你就会明白我的意思。谢谢 [我的应用程序 http://img188.imageshack.us/img188/9926/chucknhelp.tif](http://img188.imageshack.us/img188/9926/chucknhelp.tif)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T22:29:38.523

你可以在没有子类化的情况下做到这一点`UITableViewCell`。

在方法`tableView:cellForRowAtIndexPath:`中，创建一个基本`UITableViewCell`并更改`UILabel`此单元格中包含的属性。更改最大行数以在单元格中容纳更多文本。

不幸的是，属性无法访问单元格的标签，因此您需要使用`subviews`属性来获取它。

当然，这使用了 的实现细节`UITableViewCell`，因此它可能会与 SDK 的未来版本中断。小心使用。

这是一个例子：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell* cell = [tableView dequeueReusableCellWithIdentifier:@"YourCellId"];
    if (cell == nil)
    {
        cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:@"YourCellId"] autorelease];
        cell.font = [UIFont systemFontOfSize:16];
        UILabel* cellLabel = [cell.contentView.subviews objectAtIndex:0];
        [cellLabel setNumberOfLines:3];
    }
    cell.text = @"Your text";
    return cell;
} 
```

**更新：**

要设置行高以适合文本，您可以执行以下操作：

*1\. 设置单元格高度以适合文本。*

你需要这样的东西：

```
CGSize textSize = [text sizeWithFont:font
                   constrainedToSize:CGSizeMake(313, 1000)
                       lineBreakMode:UILineBreakModeWordWrap];
cell.frame = CGRectMake(0.0f, 0.0f, 320.0, textSize.height); 
```

*2\. 在方法中返回单元格高度`tableView:heightForRowAtIndexPath:`。*

例如像这样：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell* cell = [self tableView:(UITableView*)self.view cellForRowAtIndexPath:indexPath];
    CGRect cellFrame = cell.frame;
    return cellFrame.size.height;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T21:35:49.820

子类`UITableViewCell`，并在子类的`loadView`方法中，在其内部创建一个 UILabel `contentView`。将此标签设置为具有适当的包装和位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T21:51:05.263

亚当说得对。有关更多详细信息（以及快速滚动的方法），您可以查看 atebits.com 上完全绕过 UILabel 方法的此条目。

[Loren Brichter 的 UITableViewCell 子类化示例](http://blog.atebits.com/2008/12/fast-scrolling-in-tweetie-with-uitableview/)

您还可以查看[developer.apple.com](http://developer.apple.com)上的 TableViewSuite 示例，它包含 5 个不同的示例，它们的复杂性越来越高，用于构建自定义 TableView。最后一个示例在结构上与 atebits.com 上的教程非常相似。

斯坦福 iPhone 课程的第 8 讲也是关于 Scroll 和 TableViews 的，并且有一些子类化 UITableViewCell 的示例。

[iPhone课程](http://www.stanford.edu/class/cs193p/cgi-bin/index.php)

# c# - 引用路径的 C# 命令行解析和避免转义字符

> ID：900087
> 
> 赞同：26
> 
> 时间：2009-05-22T21:34:11.803
> 
> 标签：c#, command-line, escaping

如何解析将被解释为路径的命令行参数？args[] 包含被引用时自动连接的字符串，例如：

example.exe 一二“三四”

```
args[0] = one
args[1] = two
args[2] = three four 
```

但是，args[] 不会将 "C:\Example\" 属性解析为参数。相反，它将以 "C:\Example"" 的形式提供参数（包括额外的引号。）这是由于路径中的反斜杠被视为转义字符，因此用户在命令中提供的结束引号-line 成为参数的一部分。

。例如：

example.exe 一 "C:\InputFolder" "C:\OutuptFolder\"

```
args[0] = one
args[1] = C:\InputFolder"
args[2] = C:\OutputFolder" 
```

一个简单的组合可能是：

```
_path = args[i].Replace("\"", @"\"); 
```

但是，我确信有一个最佳实践。如何正确解析包含路径的命令行，防止 args[] 数组不正确地填充已解析为转义字符的字符串？

注意：我不想在我的项目中包含整个命令行解析库！我只需要处理引用的路径并希望以“手动”方式进行。请不要推荐 NConsoler、Mono 或任何其他大型“厨房水槽”命令行解析库。

另请注意：据我所知，这不是一个重复的问题。虽然其他问题侧重于通用命令行解析，但此问题特定于路径的一部分被解释为转义序列时引入的问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T21:59:41.440

不是答案，但以下是来自 Microsoft 在线社区支持 (12/7/2006) 的 Jeffrey Tan的一些[背景和解释：](http://www.eggheadcafe.com/conversation.aspx?messageid=31268633&threadid=31268617)

> 注意：这不是代码失败，而是设计使然，因为反斜杠通常用于转义某些特殊字符。此外，该算法与 Win32 命令行参数解析函数 CommandLineToArgvW 相同。请参阅下面的备注部分：http: [//msdn2.microsoft.com/en-us/library/bb776391.aspx](http://msdn2.microsoft.com/en-us/library/bb776391.aspx)

还参考了 FX 方法[Environment.GetCommandLineArgs](http://msdn.microsoft.com/en-us/library/system.environment.getcommandlineargs.aspx)以进一步解释斜杠处理行为。

我个人认为这是一个拖累，我很惊讶我以前没有被它咬过。或者也许我知道但不知道？不过，用斜杠盲目替换引号并不是我的解决方案。我对这个问题投了赞成票，因为这让我大开眼界。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T21:47:48.157

我喜欢你的想法：

```
_path = args[i].Replace("\"", @"\"); 
```

它是干净的，除非问题存在，否则不会有任何效果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-07T02:40:57.730

我也有同样的挫败感。我的解决方案是使用正则表达式。我的预期输入是路径列表，其中一些可能会被引用。除非引用所有最后的参数，否则上述 kludge 不起作用。

```
// Capture quoted string or non-quoted strings followed by whitespace
string exp = @"^(?:""([^""]*)""\s*|([^""\s]+)\s*)+";
Match m = Regex.Match(Environment.CommandLine, exp);

// Expect three Groups
// group[0] = entire match
// group[1] = matches from left capturing group
// group[2] = matches from right capturing group
if (m.Groups.Count < 3)
    throw new ArgumentException("A minimum of 2 arguments are required for this program");

// Sort the captures by their original postion
var captures = m.Groups[1].Captures.Cast<Capture>().Concat(
               m.Groups[2].Captures.Cast<Capture>()).
               OrderBy(x => x.Index).
               ToArray();

// captures[0] is the executable file
if (captures.Length < 3)
    throw new ArgumentException("A minimum of 2 arguments are required for this program"); 
```

谁能看到更有效的正则表达式？

# apache-flex - 使用 Canvas 与 VBox/HBox 的 Flex 3 性能显着提升？

> ID：900092
> 
> 赞同：2
> 
> 时间：2009-05-22T21:34:55.157
> 
> 标签：apache-flex, performance, canvas

有人告诉我，在布置孩子的位置时，使用 Canvas 与 HBox 或 VBox 相比，性能会有所提高。因此，我们的许多组件已转换为使用 Canvas。但是，现在添加了代码来根据其他子元素的宽度和高度计算某些子元素的 x 和 y 位置。如果需要添加代码来确定孩子的坐标/位置，是否值得使用 Canvas 来提高性能？除了最小化添加的 ui 组件的数量和绝对指定定位之外，是否还有更好的方法或技术可以实践？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T23:11:16.273

有许多中间技术，其中之一是使用渲染类型的组件，例如`TileGrid`or `ItemRenderers`，如果您的布局符合某个公式。如果您使用的是表单，请尝试使用`Form`布局组件而不是使用自定义布局。

如果确实需要在 Flex 中使用布局引擎，优化使用的方法是记住框架使用某些技术来增加性能负载，大致遵循以下列表，最后一个是性能最密集的：

1.  绝对定位 ( `<Canvas>`)
2.  相对定位 ( `<VBox>`)
3.  基于约束的定位 ( `right=0`)
4.  先进的基于约束的定位 ( `<constraintColumns>`)

使用相对定位通常不是性能密集型的。如果您发现是这样，则可能是您使用了太多嵌套容器。查看您的布局架构并尝试找出您的对象可能“重叠”的方式，并简化它们。一个很好的工具是 FlexSpy，它可以让您在运行时内省对象布局。

另一个常见的性能瓶颈是您的应用程序试图在您的 GUI 试图响应用户交互的同时进行一些数字运算。尽管目前不存在使您能够在单独的“线程”中运行 UI 和逻辑的绿色线程框架，但您可以使用良好的架构框架，例如 Cairngorm 或 Mate（有很多），它使用命令而不是直接方法，所以可能占用处理周期的功能执行会一直等待，直到 UI 完成对用户的响应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T02:01:23.183

在优化 Flex UI 时需要牢记以下几点：

1.  避免容器过度嵌套。考虑在嵌套大量 HBox / VBox 元素上使用具有绝对或基于约束的定位的 Canvas。然而这并不意味着你永远不应该使用 VBox/HBox。可以混搭，比如用一个Canvas作为主容器，根据需要在里面放置子Box，尽量避免嵌套过多。

2.  在自定义组件中正确使用 UIComponent 模型。特别是，使用 invalidateProperties()、invalidateSize() 和 invalidateDisplayList()，以便在 Flash Player 的最佳时间调用它们的配套函数（commitProperties()、measure() 和 updateDisplayList()）。Deepa 在这里对此进行了精彩的讨论：

[http://tv.adobe.com/#vi+f15384v1002](http://tv.adobe.com/#vi+f15384v1002)

她解释了如何大量使用失效方案允许 Flash Player 在理想的时间执行您的代码，即不在屏幕更新的中间。所有 Flex 组件都使用这些原则，无论使用何种框架，都可以/应该利用这些原则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T21:50:53.937

为了确保我理解：

*   你听说 Canvas 可以比 [VH]Box 更快地定位子元素
*   Canvas 只做绝对定位
*   您的某些（很多？）组件具有绝对位置，因此您切换到使用 Canvas
*   但是你的一些组件是有相对位置的，所以你需要编写代码来定位它们

那是对的吗？

无论如何，假设我是正确的（可能不是这样），您要做的第一件事是选择需要最少代码行的功能接口，然后确定它是否“足够好”。您想要代码行数最少的那个，因为研究表明代码行数和错误数量之间存在相关性（并且您不想要错误）。你想看看它是否“足够好”，因为如果它“足够好”，你不需要做任何事情（如果你*尝试*让它更快，你就是在提交[Premature Optimization](http://c2.com/cgi/wiki?PrematureOptimization)）。

但这可能不是你想听到的:)

所以我也建议，如果你想坚持使用基于 Canvas 的布局，你可以尝试将所有相对定位的内容粘贴在 [VH]Boxes 中，然后绝对定位在 Canvas 中。Adobe 编写的代码很有可能比代码更快，因此您应该尝试利用它。

但唯一能确定的方法是尝试并*分析它*。

# iphone - 在 iPhone 上设置表格视图单元格的背景颜色

> ID：900094
> 
> 赞同：35
> 
> 时间：2009-05-22T21:35:24.313
> 
> 标签：iphone

我想实现表格视图的一个单元格背景为蓝色，下一个单元格为白色，下一个单元格再次为蓝色，然后是白色等等的效果......你能告诉我我该怎么做吗？去做？

谢谢。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2010-02-15T20:19:00.530

将此方法添加到您的表视图委托中：

```
#pragma mark UITableViewDelegate
- (void)tableView: (UITableView*)tableView 
  willDisplayCell: (UITableViewCell*)cell 
forRowAtIndexPath: (NSIndexPath*)indexPath
{
    cell.backgroundColor = indexPath.row % 2 
        ? [UIColor colorWithRed: 0.0 green: 0.0 blue: 1.0 alpha: 1.0] 
        : [UIColor whiteColor];
    cell.textLabel.backgroundColor = [UIColor clearColor];
    cell.detailTextLabel.backgroundColor = [UIColor clearColor];
} 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-05-23T06:45:47.497

您必须设置单元格内容视图的背景颜色

```
cell.contentView.backgroundColor = [UIColor colorWithRed...] 
```

这将设置整个单元格的背景。

要对备用单元格执行此操作，请使用`indexPath.row`and `%`by 2。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-12-04T06:10:18.567

如果您想根据实际单元格数据对象中的某些状态设置单元格颜色，那么这是另一种方法：

如果将此方法添加到表视图委托中：

```
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath {
cell.backgroundColor = cell.contentView.backgroundColor;
} 
```

然后在您的 cellForRowAtIndexPath 方法中，您可以执行以下操作：

```
if (myCellDataObject.hasSomeStateThatMeansItShouldShowAsBlue) {
    cell.contentView.backgroundColor = [UIColor blueColor];
} 
```

这省去了在 willDisplayCell 方法中再次检索数据对象的麻烦。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-06-15T04:53:20.437

请在 cellForRowAtIndexPath 中添加以下代码

```
if (indexPath.row % 2 == 0){
    cell.backgroundColor =[UIColor blueColor];
} else {
    cell.backgroundColor =[UIColor whiteColor];
} 
```

我想这会对你有所帮助

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-06T12:54:44.117

`cell.contentView.backgroundColor = [UIColor colorWithRed...]`只要您不使用 UITableViewCell 的内置标签，lostInTransit 答案中的方法就可以工作。

我发现如果您使用内置标签，例如通过设置`cell.text`，您最终会在标签下方看到一个不透明的白色块，并且只有单元格的两端显示您想要的颜色。

我发现无法编辑内置标签，因此它是不透明的（您可以通过 访问它`UILabel* cellLabel = [cell.contentView.subviews objectAtIndex:0]`）。

我通过添加自己的自定义解决了这个问题`UILabel`。像这样：

```
UILabel* cellLabel = [[[UILabel alloc] initWithFrame:cell.frame] autorelease];
cellLabel.text = @"Test with non-opaque label";
cellLabel.backgroundColor = [UIColor clearColor];
cellLabel.opaque = NO;

[cell.contentView addSubview:cellLabel];
cell.contentView.backgroundColor = [UIColor darkGrayColor]; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-08-18T11:05:14.043

When using the default table cell setting the following two properties will color both the cell's background and the background color of it's label, avoiding the need to create a custom label as a subview of the cell's contentView.

```
cell.textLabel.backgroundColor = [UIColor redColor];
cell.contentView.backgroundColor = [UIColor redColor]; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-05-23T02:59:15.717

//省时方法：

//在单元格中用于索引方法：

```
static NSString* evenIdentifier = @"even";
static NSString* oddIdentifier = @"odd";

__weak identifier;
if(indexPath.row %2 ==0)
{
    identifier = evenIdentifier;
}else{
    identifier = oddIdentifier;
}

cell = dequeue..WithIdentifier: identifier;
if(cell == nil){
    cell = allocOrLoadNib...;
    cell.backgroundColor = (indexPath.row %2 ==0 ? evenColor : oddColor);
} 
```

// 改变单元格内容然后返回。轻松的工作。

// 这是一个大纲代码。请不要直接复制。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-09-07T06:24:58.200

这对我有用.. 在 cellForRowAtIndexPath 中，

```
cell.textLabel.backgroundColor = [UIColor clear];
cell.detailTextLabel.backgroundColor = [UIColor clearColor];
cell.contentView.backgroundColor = [UIColor grayColor]; //whichever color u want
cell.backgroundColor = cell.contentView.backgroundColor; 
```

根据您的要求，如前所述，您可以根据 indexPath % 2 值执行上述功能。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-02-15T20:13:34.303

对于您使用内置文本标签并且不希望文本标签的白色背景颜色遮挡背景颜色的情况，此代码是一个稍微干净的解决方案。这也解决了违反分组样式的表格视图的圆角的问题（当您使用 cell.contentView.backgroundColor 而不是 cell.backgroundColor 时会发生这种情况）：

```
UITableViewCell *cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
cell.backgroundColor = [UIColor redColor];
cell.textLabel.backgroundColor = [UIColor clearColor]; //transparent background 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-09T06:20:56.203

您需要做的就是在表的视图控制器实现文件中添加以下代码。

```
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath {
if (indexPath.row%2 == 0) {
    UIColor *altCellColor = [UIColor blackColor];
    cell.backgroundColor = altCellColor;
}} 
```

然后就像添加和更改模值一样简单。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-04-04T08:55:53.573

```
 UIView *bg = [[UIView alloc] initWithFrame:cell.frame];
    bg.backgroundColor = [UIColor colorWithRed:175.0/255.0 green:220.0/255.0 blue:186.0/255.0 alpha:1]; 
    cell.backgroundView = bg;
    [bg release]; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-05-09T06:05:43.490

添加`backgroundView`到单元格并设置您选择的背景颜色。

```
let backgroundView = View() //  add background view via code or via storyboard
view.backgroundColor = UIColor.red // your color
cell.backgroundView = backgroundView 
```

# lua - luaopen_my_example 在编译 swig 包装器后未定义

> ID：900098
> 
> 赞同：1
> 
> 时间：2009-05-22T21:36:25.217
> 
> 标签：lua, wrapper, swig

我刚刚潜入 SWIG 作为创建 Lua 绑定的一种方法，但遇到了障碍。我制作了我的接口文件并从中构建了一个共享对象文件，没有任何问题。但是，当我运行 Lua 并尝试请求共享对象时，我得到以下信息：

```
Lua 5.1.4 版权所有 (C) 1994-2008 Lua.org, PUC-Rio
 要求（“我的例子”）
 从文件“./my_example.so”加载模块“my_example”时出错：

        ./my_example.so：未定义符号：luaopen_my_example

```

堆栈回溯：

```
[C]： ？

[C]：在函数“要求”中

标准输入：1：在主块中

[C]： ？

```

我似乎在网上找不到任何描述这种情况的东西，所以我想我会在这里发帖。那里有 SWIG 大师吗？我要包装的课程有几千行（并且是专有的），或者我会在这里发布。

谢谢！:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T02:54:26.150

您使用的是什么版本的 SWIG，在什么平台上？

我在 Cygwin 下运行的稍微过时的 SWIG 版本 1.3.29 使用`#define SWIG_init`深埋在其生成的包装文件中来指定所需的名称，`require`因为SWIG文件顶部的语句中使用的名称在`luaopen_mod`哪里。我包装的模块确实可以在 Windows 上加载和使用 Lua 5.1。`mod``%module``.i`

您可能还需要做一些事情来确保符号被导出，并且没有被命名为 Lua 永远找不到的 C++ 名称。我正在包装 C 结构和部分 Windows API，因此没有处理该包装器中的任何 C++ 特定问题。但是，即使不涉及 SWIG，意外的名称修改也是模块加载问题的常见原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T14:15:43.443

/掌脸

我在接口 (.i) 文件中错误命名了模块。不管怎么说，还是要谢谢你！

# javascript - 原型 PeriodicExecutor 不更新源

> ID：900100
> 
> 赞同：0
> 
> 时间：2009-05-22T21:37:13.467
> 
> 标签：javascript, prototypejs

我有一个脚本，当数据库中有新条目时更新表。它从表的最后一行中提取一个时间，然后获取从那时起输入的所有条目。

它第一次运行良好，它获取新条目并更新表。但是，当它第二次运行时，它将使用该初始时间戳，而不是检索刚刚从数据库中提取的当前最后一个条目。

因此，PeriodicExecuter 函数似乎在启动时加载了页面的 html，并且无法考虑任何异步更新，或者它只是节省了初始时间。有没有办法解决这个问题？

这是一些代码：

```
new PeriodicalExecuter(function() {
      new Ajax.Request(
        '#{url}&since_ts=' + $$('#posts tr:last-child td.description')[0].innerHTML.match(/Posted at: (\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2})/)[1], 
        {asynchronous:true, 
          evalScripts:true, 
          parameters:'authenticity_token=' + encodeURIComponent('#{form_authenticity_token}')
        }
      )
    }, 60) 
```

我对 javascript 相当陌生，我将不胜感激任何帮助。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T21:44:04.670

我以前没有使用过 Prototype，所以这是一个疯狂的猜测，但它可能只是缓存调用，因为它默认为 GET。试试下面的参数是你调用后的url

```
{
    asynchronous:true, 
    method: 'post',
    evalScripts:true, 
    parameters:'authenticity_token=' + encodeURIComponent('#{form_authenticity_token}')
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T22:41:41.933

我发现问题不在于 PeriodicExecutor 函数，而在于我的选择器语句。所以我所要做的就是找到另一种方法来访问表中的最后一个 tr 元素。

```
$$('#posts tr td.description').last().innerHTML.match(/Posted at: (\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})/)[1] 
```

如此简单，但它始终是您看到的最后一件事。

# c# - 在 C# 应用程序中创建数据库

> ID：900103
> 
> 赞同：2
> 
> 时间：2009-05-22T21:39:05.850
> 
> 标签：c#, database, tsql

在 C# 应用程序上创建数据库的最佳方法是什么，我的意思是单击一个按钮，它将创建一个名称不同但模型相同的数据库？

目前，我在 C# 应用程序上编写 TSQL 脚本，所以当我单击一个按钮时，将使用我定义的名称创建一个新数据库，它运行良好，但是维护起来非常困难，有没有更好的方法来创建数据库在 C# 上？

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T21:51:38.243

您可以使用 SMO 创建数据库。请参阅[MSDN 示例](http://msdn.microsoft.com/en-us/library/ms162577.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T21:47:49.450

一种方法是只拥有数据库文件 (mdf) 的副本，以便推送到新服务器上。这类似于微软对其模型数据库所做的事情。每当您创建一个新数据库时，它都会从制作该数据库的副本开始。

您的按钮单击可以将数据库文件复制到所需位置，根据需要重命名，然后将其附加到正在运行的 sql server 实例。每当您需要使用新架构更新数据库时，只需将 mdf 复制到您的部署目录即可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T22:03:15.660

Sql Server 2008 Management Studio 可以生成用于数据库生成的 SQL 脚本。将脚本保存在文本文件中，然后将其假脱机到 RDBMS 并创建数据库。

这并不难维护。

要在 SqlServer 2008 Management Studio 中生成脚本：右键单击数据库 -> 任务 -> 创建脚本，单击几次并保存到文件。

# vb.net - VB.net 1.1 TCPIP 打印机端口创建与 CreateProcessWithLogon API

> ID：900104
> 
> 赞同：1
> 
> 时间：2009-05-22T21:39:16.520
> 
> 标签：vb.net, privileges

几个月前，我编写了一个 VB.net 控制台应用程序，将一组大约 100 多台打印机和使用它们的 1800 多位用户从一些旧的 HP 打印设备迁移到混合打印服务器和直接到 IP 打印解决方案。该应用程序使用数据库来比较已安装的打印机并删除旧/无效共享并重新映射到基于 Win2K3 的新打印服务器或创建 TCPIP 打印机端口并安装驱动程序以直接到 IP 打印。

它工作得非常好，但用户需要高级用户权限才能创建 TCPIP 打印机端口。对于主校区来说，这不是问题，但较小的远程站点需要一个解决方案，允许应用程序由没有高级用户权限的用户运行。

我的解决方案是采用“CreatePrinterIPPort”函数并将其放入它自己的包装应用程序中，然后使用硬编码的本地管理员帐户根据需要从主应用程序调用它，但是在生成 createport 时我遇到了问题应用程序。如果我独立运行应用程序，它会毫无问题地创建端口，但是当我在测试应用程序中运行它以使用 CreateProcessWithLogon API 生成 createport 时，端口创建会失败并出现“拒绝访问”错误。我仅限于使用 .net 1.1，因为 2.0 并没有完全在我们的环境中，而且我被告知它不会仅仅为这个应用程序推送。

有什么想法吗？

来源如下。

**生成应用程序：**

`Imports System.Runtime.InteropServices`

 `Module Module1

# Region "API Structures"

```
<StructLayout(LayoutKind.Sequential)> _
  Public Structure PROCESS_INFORMATION
    Dim hProcess As System.IntPtr
    Dim hThread As System.IntPtr
    Dim dwProcessId As Integer
    Dim dwThreadId As Integer
End Structure

<StructLayout(LayoutKind.Sequential)> _
 Public Structure STARTUPINFO
    Dim cb As Integer
    Dim lpReserved As System.IntPtr
    Dim lpDesktop As System.IntPtr
    Dim lpTitle As System.IntPtr
    Dim dwX As Integer
    Dim dwY As Integer
    Dim dwXSize As Integer
    Dim dwYSize As Integer
    Dim dwXCountChars As Integer
    Dim dwYCountChars As Integer
    Dim dwFillAttribute As Integer
    Dim dwFlags As Integer
    Dim wShowWindow As Short
    Dim cbReserved2 As Short
    Dim lpReserved2 As System.IntPtr
    Dim hStdInput As System.IntPtr
    Dim hStdOutput As System.IntPtr
    Dim hStdError As System.IntPtr
End Structure 
```

# End Region

# Region "API Constants"

```
Private Const LOGON_NETCREDENTIALS_ONLY As Integer = &H2
Private Const NORMAL_PRIORITY_CLASS As Integer = &H20
Private Const CREATE_DEFAULT_ERROR_MODE As Integer = &H4000000
Private Const CREATE_NEW_CONSOLE As Integer = &H10
Private Const CREATE_NEW_PROCESS_GROUP As Integer = &H200
Private Const LOGON_WITH_PROFILE As Integer = &H1 
```

# End Region

# Region "API Functions"

```
Private Declare Unicode Function CreateProcessWithLogon Lib "Advapi32" Alias "CreateProcessWithLogonW" _
    (ByVal lpUsername As String, _
     ByVal lpDomain As String, _
     ByVal lpPassword As String, _
     ByVal dwLogonFlags As Integer, _
     ByVal lpApplicationName As String, _
     ByVal lpCommandLine As String, _
     ByVal dwCreationFlags As Integer, _
     ByVal lpEnvironment As System.IntPtr, _
     ByVal lpCurrentDirectory As System.IntPtr, _
     ByRef lpStartupInfo As STARTUPINFO, _
     ByRef lpProcessInfo As PROCESS_INFORMATION) As Integer

Private Declare Function CloseHandle Lib "kernel32" (ByVal hObject As System.IntPtr) As Integer 
```

# End Region

```
Public Sub RunProgram(ByVal UserName As String, ByVal Password As String, ByVal Domain As String, ByVal Application As String, ByVal CommandLine As String)

    Dim siStartup As STARTUPINFO
    Dim piProcess As PROCESS_INFORMATION
    Dim intReturn As Integer

    If CommandLine Is Nothing OrElse CommandLine = "" Then CommandLine = String.Empty

    siStartup.cb = Marshal.SizeOf(siStartup)
    siStartup.dwFlags = 0

    intReturn = CreateProcessWithLogon(UserName, Domain, Password, LOGON_WITH_PROFILE, Application, CommandLine, _
    NORMAL_PRIORITY_CLASS Or CREATE_DEFAULT_ERROR_MODE Or CREATE_NEW_CONSOLE Or CREATE_NEW_PROCESS_GROUP, _
    IntPtr.Zero, IntPtr.Zero, siStartup, piProcess)

    If intReturn = 0 Then
        Throw New System.ComponentModel.Win32Exception(Marshal.GetLastWin32Error())
    End If

    CloseHandle(piProcess.hProcess)
    CloseHandle(piProcess.hThread)

End Sub

Overloads Sub Main(ByVal args() As String)
    Dim command As String = "C:\Program Files\Printer Server Update Utility\CreatePrinterPort.exe"
    Dim arguments As String = Chr(34) & "C:\Program Files\Printer Server Update Utility\CreatePrinterPort.exe" & Chr(34) & " /I:138.90.1.3"
    Dim user As String = "PrintAdmin" 
    Dim domain As String = System.Environment.MachineName
    Dim password As String = "Pa$$word" '<---- No not really
    Dim currentDirectory As String = System.IO.Directory.GetCurrentDirectory()

    RunProgram(user, password, domain, command, arguments)
    System.Console.WriteLine("Please press the ENTER key to close window.")
    System.Console.WriteLine("")
    System.Console.Read()
End Sub 
```` 

`End Module`

**TCPIP 端口创建应用程序中的功能，该功能在上面的应用程序中生成时完成工作并失败。**

`Function CreatePrinterIPPort(ByVal strPrinterIPAddress As String, Optional ByVal Protocol As Short = 1, Optional ByVal QueueName As String = "Dummy", _ Optional ByVal ByteCount As Boolean = False) As Boolean ' Protocal 1 = RAW (Default) 2 = LPR System.Console.WriteLine("Attempting to create port at IP Address: " & strPrinterIPAddress) Dim options As New ConnectionOptions options.Impersonation = ImpersonationLevel.Impersonate Dim mpBasePath As New ManagementPath("\.\ROOT\CIMV2") Dim mpTCPIPPort As New ManagementPath("Win32_TCPIPPrinterPort") Dim msLocalMachine As New ManagementScope(mpBasePath, options) msLocalMachine.Connect() Dim mcNetworkPorts As New ManagementClass(msLocalMachine, mpTCPIPPort, New ObjectGetOptions) Dim moNewPort As ManagementObject = mcNetworkPorts.CreateInstance() moNewPort.Properties("Name").Value = "IP_" & strPrinterIPAddress moNewPort.Properties("Protocol").Value = Protocol moNewPort.Properties("HostAddress").Value = strPrinterIPAddress If Protocol = 1 Then moNewPort.Properties("PortNumber").Value = "9100" ElseIf Protocol = 2 Then moNewPort.Properties("ByteCount").Value = ByteCount moNewPort.Properties("Queue").Value = QueueName End If`

 ````
 Try
        moNewPort.Put()
    Catch ex As Exception
        System.Console.WriteLine("Port creation failed.")
        System.Console.WriteLine(ex.Message.ToString)
        Return False
    End Try
    System.Console.WriteLine("Created port at IP Address: " & strPrinterIPAddress)
    Return True
End Function 
````  `* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T21:21:12.663

似乎 WMI 不允许对模拟帐户进行写访问，因此我继续使用 prnadmin.dll 创建端口。这需要我检查 dll 是否已注册，如果没有注册，但似乎这是我能找到（并保持理智）完成此操作的唯一方法。

# design-patterns - 你如何防止类成为“依赖磁铁”和上帝类？

> ID：900105
> 
> 赞同：13
> 
> 时间：2009-05-22T21:39:29.373
> 
> 标签：design-patterns, refactoring

在我从事过的几乎每个项目中，都会有一两个具有以下属性的类：

*   非常大，有很多成员和方法。
*   许多其他类继承自这个类。
*   许多其他类，否则依赖于这个类。

糟糕的设计，你可能会说。但在所有情况下，设计时都不是这种情况。随着时间的推移，这些课程有机地增长，成为众所周知的“上帝课程”。这与我在大型软件项目中的经验如此一致，我不得不问：

*   是否有可能以这样一种方式预见可能的依赖磁铁和设计软件，以使此类类出现的可能性更小？如果有，具体怎么做？
*   或者，它是否只需要随着时间的推移进行无情的重构？
*   或者，是否有一些技术解决方案或设计模式可以减轻这些类引起的问题？
*   或者，三者的结合？

欢迎提示，经验和想法！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T21:48:03.693

持续重构将有助于防止这种情况发生。

此外，这是强制进行一些静态代码分析非常有益的地方。通过查看代码指标，您通常可以很容易地找到这些类并将它们标记为自动重构。

不过，我最大的建议是保持一种态度，即设计需要改变，事情需要分解。通常，根据我的经验，这些类的形成是因为人们不愿意考虑更改损坏或次优的设计。保持灵活性可以更容易地防止这种情况。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T22:04:11.243

我认为，其中很多往往源于随后的设计懒惰。“积极重构”的理念是解决这类设计问题的良药。问题是，虽然“依赖磁铁”类的初始设计很好，但随后时间紧张的工程师倾向于简单地将其他功能附加到该类，原因很简单，因为它可以在他们需要的地方（通常）可用。

很大程度上，这个问题与这样一个事实有关，即能够满足成熟软件产品需求的设计对于不太成熟的软件产品来说是过度设计。最终在软件产品的成熟迭代中进行的所有设计对于该产品的早期迭代来说都是巨大的矫枉过正；因此，从根本上说，随着开发的继续，设计必须始终被摆弄。这就是需要重构的地方；随着新特性和功能的开始实施，设计问题将浮出水面；正如他们所做的那样，承担重新设计类交互方式的任务并重构代码以利用它是至关重要的。只有这样，您才能保持与项目成熟度具有任何相似性的设计成熟度。

实际上，设计成熟度的水平会随着项目的复杂性而增加；一个简单项目的大规模复杂设计是不合适的；就像一个复杂项目的大规模简单设计是不合适的一样。但是由于存在这种不匹配，因此设计必须与项目一起发展。重构作为一个过程只是对这种必要性的认识。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T22:33:36.957

这个：

*   从这个类继承的许多其他类

可以通过[优先组合而不是继承](https://stackoverflow.com/questions/49002/prefer-composition-over-inheritance)来克服。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T21:44:17.820

我的经验是，你提出的第一个设计通常是不正确的，随着时间的推移，你需要重新考虑设计。当一个类开始变得太大时，通常是因为它[开始违反 SRP](http://en.wikipedia.org/wiki/Single_responsibility_principle)。

Fowler 的一些重构模式很有用。[Extract Class](http://www.refactoring.com/catalog/extractClass.html)重构可以提供帮助，[Extract Subclass](http://www.refactoring.com/catalog/extractSubclass.html)和[Extract Superclass](http://www.refactoring.com/catalog/extractSuperclass.html)也可以。我经常发现自己在更改继承层次结构，可能使用[带委托的替换继承](http://www.refactoring.com/catalog/replaceInheritanceWithDelegation.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T22:01:23.700

对我来说也是无情的重构，特别是对于持续很长时间（例如数年）的小型（即不是高度设计的瀑布式）项目。

我从小处着手：一点点架构，比如 2 到 5 个组件。我通过向这些组件添加代码来实现功能……当一个组件变得太大（这是主观的）时，我将它分成多个组件。[“组件”是指“包”或“DLL”之类的东西。]

“依赖磁铁”是一个稍微不同的问题：为了解决这个问题，我热衷于分层软件，没有层之间的循环依赖，有时还有一个将高级组件与低级组件隔离开的外观。

# c# - DataGridView 不显示 DataTable

> ID：900112
> 
> 赞同：1
> 
> 时间：2009-05-22T21:41:44.767
> 
> 标签：c#, sqlite, datagridview, datatable, system.data.sqlite

我有以下代码，我认为应该将 DataTable 绑定到 DataGridView，但 DataGridView 显示为空。DataTable 肯定有行，所以我假设我以某种方式错误地绑定了 DataSource。有谁看到这有什么问题：

```
DataBase db = new DataBase(re.OutputDir+"\\Matches.db");
MatchDBReader reader = new MatchDBReader(db.NewConnection());

BindingSource bindingSource = new BindingSource();
bindingSource.DataSource = reader.GetDataTable();

this.dataGridView1.DataSource = bindingSource.DataSource; 
```

*   第一行只是获取我从中提取数据的数据库的句柄。
*   下一行是提供了一个用于从同一个数据库读取的类 - 特别是它公开了 GetDataTable 方法，并返回我打算放入 DataGridView 的数据表。
*   下一行是无趣的...
*   第 4 行尝试抓取 DataTable - QuickWatch 表明这正在工作......
*   最后一行是我假设我搞砸了......我的理解是这将 DataTable 绑定到 DataGridView GUI，但没有显示任何内容。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T22:52:19.603

尝试将 DataGridView 直接绑定到 BindingSource，而不是 BindingSource 的 DataSource：

```
this.dataGridView1.DataSource = bindingSource; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T21:58:06.933

在获取数据表之前，您需要将 BindingSource 附加到网格。

尝试切换最后两行代码：

```
DataBase db = new DataBase(re.OutputDir+"\\Matches.db");
MatchDBReader reader = new MatchDBReader(db.NewConnection());
BindingSource bindingSource = new BindingSource();
this.dataGridView1.DataSource = bindingSource.DataSource;
bindingSource.DataSource = reader.GetDataTable(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T07:02:59.103

除上述解决方案外，还修复了“bindingSource”数据成员属性。像：

```
bindingSource.DataMember = yourDataSet.DataTable; 
```

我对 sql 数据库和 datagrid 视图有同样的问题。经过一番麻烦后，我发现我忘记设置绑定源的 dataMember 属性。

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T20:12:02.807

这些都不适合我，尽管这一切似乎都是好的建议。我最终做的是世界上最大、最糟糕的黑客攻击。我希望完成的只是从 SQLite 数据库加载数据库表并将其呈现在 DataGridView 中（只读，带有可排序的列）。实际的数据库将在运行时以编程方式指定。我通过向表单添加 DataGridView 来定义 DataSet，并使用向导静态定义 DB 连接字符串。然后我进入 Settings.Designer.cs 文件并`set`为 DB Connection 字符串属性添加了一个访问器：

```
namespace FormatDetector.Properties {

    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator", "9.0.0.0")]
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase {

        private static Settings defaultInstance = ((Settings)(global::System.Configuration.ApplicationSettingsBase.Synchronized(new Settings())));

        public static Settings Default {
            get {
                return defaultInstance;
            }
        }

        [global::System.Configuration.ApplicationScopedSettingAttribute()]
        [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [global::System.Configuration.SpecialSettingAttribute(global::System.Configuration.SpecialSetting.ConnectionString)]
        [global::System.Configuration.DefaultSettingValueAttribute("data source=E:\\workspace\\Test\\Matches.db;useutf16encoding=True")]
        public string MatchesConnectionString {
            get {
                return ((string)(this["MatchesConnectionString"]));
            }
            set
            {
                (this["MatchesConnectionString"]) = value;
            }
        }
    }
} 
```

这是一个 klugey hack，但它有效。关于如何清理这个烂摊子的建议非常受欢迎。

布莱恩

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-15T17:56:07.493

`DataGridView`以a`DataTable`为基础。列`DataTable`将它们的类型保存为属性。

如果此类型是一个接口，您将看到的只是空单元格。

# apache-flex - Flex/AIR：发送带有嵌入图像的电子邮件.. 怎么样？

> ID：900113
> 
> 赞同：3
> 
> 时间：2009-05-22T21:41:57.980
> 
> 标签：apache-flex, image, email, air

我正在制作一个 Flex AIR 应用程序，它将根据网络摄像头图片生成礼品卡。此礼品卡需要通过电子邮件发送给程序中提供的收件人。我应该将图片上传到服务器并使用 php 发送邮件吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T07:41:10.680

您可以尝试使用 SMTP Mailer，这是一个用于 SMTP 的 ActionScript 库。它支持附件，因此应该可以满足您的需求。

[http://www.bytearray.org/?p=27](http://www.bytearray.org/?p=27)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-08-21T03:45:13.613

```
 var mailer:SMTPMailer = new SMTPMailer("localhost",25);
        var myBitmap:BitmapData = new BitmapData(photo.width,photo.height);
        myBitmap.draw(photo);
        var myEncoder:JPEGEncoder = new JPEGEncoder(100);
        var myCapStream:ByteArray = myEncoder.encode (myBitmap);
        var subject:String = "subject goes here";
        var content:String = "This is content";
        mailer.sendAttachedMail ( "noreply@nobody", toEmail.text,subject, content, myCapStream, "style.jpg"); 
```

我使用了托管在谷歌代码中的[SMTPMailer 0.9 。](http://code.google.com/p/smtpmailer/downloads/detail?name=SMTPMailer%200.9.zip&can=2&q=)0.6 出现图片附件问题。对于邮件，使用“ [Test Mail Server Tool](http://www.toolheap.com/test-mail-server-tool/) ”模拟邮件服务器。

# visual-studio-2008 - 亚音速模式错误

> ID：900114
> 
> 赞同：0
> 
> 时间：2009-05-22T21:42:12.380
> 
> 标签：visual-studio-2008, .net-3.5, subsonic, subsonic2.2

我在 .net 3.5 中运行 VS2008 并试图让 SubSonic 2.2 运行。我的数据库叫Test，DB中的表叫TestTable。它正在 SQL Server 2005 上运行。我收到以下“警告”：

> 找不到元素“SubSonicService”的架构信息。
> 
> 找不到属性“defaultProvider”的架构信息。
> 
> 找不到元素“提供者”的架构信息。
> 
> 找不到元素“clear”的架构信息。
> 
> 找不到元素“添加”的架构信息。
> 
> 找不到属性“名称”的架构信息。
> 
> 找不到属性“类型”的架构信息。
> 
> 找不到属性“connectionStringName”的架构信息。
> 
> 找不到属性“generatedNameSpace”的架构信息。

问题是没有生成命名空间，所以我无法进行太多工作。“SubSonic.Generated.Tables”行将在智能中显示我的表的名称，所以我知道它可以连接并且它显然正在做某事。但我不能像类一样引用我的表。下面我包含了“警告”引用的 web.config 部分。

```
<SubSonicService defaultProvider="GeekPower">
    <providers>
      <clear/>
      <add name="GeekPower" type="SubSonic.SqlDataProvider, SubSonic" connectionStringName="GeekPower" generatedNameSpace="GeekPower" />
    </providers>    
  </SubSonicService> 
```

任何帮助，将不胜感激。我一直在寻找几个小时，但没有找到工作的修复程序。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-09T20:36:54.727

Those warnings are because the XML doesn't recognize the config like Jason was saying. You can ignore them - or you can set the configuration to .NetConfiguration/v3.5

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T21:47:30.777

项目中是否有任何类与生成类创建命名空间冲突？尝试使用 GeekPower.Foo 等不同的命名空间重新生成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T21:48:18.187

你可能想看看：

*   [linq to sql 不会错过重点吗？](https://stackoverflow.com/questions/458802/doesnt-linq-to-sql-miss-the-point-arent-orm-mappers-subsonic-etc-sub-opti) 和
*   [如何进入亚音速？](https://stackoverflow.com/questions/467591/how-to-get-into-subsonic/467625#467625)

特别是，如果你刚刚开始。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T21:52:47.583

你真的用 sonic.exe 程序生成了这些类吗？这将生成您然后导入到项目中的 .cs 文件。要摆脱警告，请将其添加到 .config 的顶部：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration xmlns="http://schemas.microsoft.com/.NetConfiguration/v2.0">
  <configSections>
    <section name="SubSonicService" type="SubSonic.SubSonicSection, SubSonic" requirePermission="false" />
  </configSections>
</configuration> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-28T07:18:40.360

唔。很抱歉重新打开这个家伙，但我认为我们可以确定它，它似乎还没有确定。

我对警告有完全相同的问题，并且配置几乎完全相同。我的 DAL 可以完美运行，构建，从广义上讲没有任何问题，但我在使用 SubSonic 的每个项目中都会收到警告。这是一种刺激，仅此而已，但我很想摆脱这种刺激。

如果我添加

> ```
> <configuration xmlns="http://schemas.microsoft.com/.NetConfiguration/v2.0"> 
> ```

或 v3.5，按照建议的配置，我只是收到额外的消息

消息 1 找不到元素“ [http://schemas.microsoft.com/.NetConfiguration/v2.0:configuration](http://schemas.microsoft.com/.NetConfiguration/v2.0:configuration) ”的架构信息

或类似的，所以这似乎不是问题。它本身不是配置文件，只有 SubSonicService 部分。

原始消息似乎是合理的——应该有一些文件（XML Schema？）告诉 VS 在 SubSonicService 部分中允许的标签，并且可能也会给我们一些急需的智能感知。该文件似乎丢失了。这只是“不能被打扰”的情况吗？（Rob？- 顺便说一句，我们都去过那里！）如果是这样，任何人都可以指出一组相当简单的关于如何创建文件和应用它的说明，我会这样做并分享它。

# javascript - HTML & Javascript：使用自定义文本输入进行密码输入

> ID：900115
> 
> 赞同：0
> 
> 时间：2009-05-22T21:43:39.677
> 
> 标签：javascript, html, passwords, textinput

我想重新发明 HTML 中的密码输入。

好的，这是我所做的工作：

[http://www.symplik.com/password.html](http://www.symplik.com/password.html) （它只是一个普通的 html 代码，没有什么花哨的 :>）

“密码”确实是文本输入，我使用 onkeyup 事件将输入重写为屏蔽字符。

有两个问题：（1）无法检测到退格或删除（2）如果我输入非常快，某些字符无法及时捕获。

对于问题（1）。通过检查密码字段中的文本长度和存储的密码可以部分解决。无论如何，这不是一个非常优雅的解决方案。

对于问题（2），我尝试在两者之间插入一些时间延迟功能，但仍然失败。我会在每个 keyUp 之后将该字段设为只读，但它的行为仍然相同。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T21:48:31.430

为什么不使用

**`<input type='password'>`**

它为您屏蔽了输入。**不需要 javascript**。

# javascript - 在 getElementById 等浏览器中使用 getElementByClass 是否安全？

> ID：900117
> 
> 赞同：9
> 
> 时间：2009-05-22T21:43:45.950
> 
> 标签：javascript, dom

在 getElementById 等浏览器中使用 getElementByClass 是否安全？

**更新** 当前使用：

```
 window.opener.document.getElementById 
```

但我想通过类名引用对象（该类名只有 1 个元素）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-23T02:34:28.453

`getElementsByClassName`不幸的是，跨浏览器不可靠。根据[Quirksmode](http://www.quirksmode.org/dom/w3c_core.html#t11)的说法，最新版本的 Firefox、Opera、Safari 和 Chrome 目前支持它，但在 Internet Explorer 或 Konqueror 中根本不支持。

如果你想跨浏览器使用它，你必须为那些不支持它的浏览器提供你自己的实现，[比如在 PPK 的博客中](http://www.quirksmode.org/blog/archives/2008/05/getelementsbycl.html)：

```
function getElementsByClassName(node,classname) {
    if (node.getElementsByClassName)
        return node.getElementsByClassName(classname);
    else {
        // your custom function
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T21:54:17.830

IIRC，`getElementsByClassName`在 Firefox 3、Safari 3.1 中引入，并且从一开始就在 Chrome 中。我不知道它是否/何时添加到 Opera，但它根本不存在于 Internet Explorer 中。（尽管可以通过扩展 DOM 原型将其添加到 IE8；请参阅[Grant 的回答](https://stackoverflow.com/questions/900117/is-getelementbyclass-safe-to-use-across-browsers-like-getelementbyid/900187#900187)。）

换句话说，如果你想要一个跨浏览器`getElementsByClassName`，你要么需要自己动手，要么使用框架。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T22:01:50.110

正如其他人所提到的，`getElementsByClassName`在 Internet Explorer 中不可用。

有关如何在 IE 中实现功能的信息，请参阅[文档对象模型原型的](http://msdn.microsoft.com/en-us/library/dd282900.aspx)[自定义 DOM](http://msdn.microsoft.com/en-us/library/dd282900.aspx#custom)部分，第 1 部分：简介。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T22:38:20.537

如果您真的想使用它，您可以在使用它之前测试以验证对象是否支持 getElementsByClassname，如果浏览器不支持它，则回退到该函数的 JS 实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T01:48:59.433

我建议使用prototype.js或jQuery之类的包装库，它们都支持css选择器模型，并处理浏览器兼容性问题（IE6-7通常是更大的问题）

# c# - 需要 FindControl 功能的帮助

> ID：900122
> 
> 赞同：1
> 
> 时间：2009-05-22T21:44:38.147
> 
> 标签：c#, asp.net

我正在使用我一直在研究的转发器的表单，我目前正在尝试编写一个事件处理程序，该处理程序将在包含转发器的表单之后获取转发器内部某些控件的值已经提交。我假设如果我想从第一个转发器项目中检索标签，那么类似的东西会起作用，然后将它的文本设置为另一个标签的文本：

```
protected void SubmitMessage_Click(object sender, EventArgs e)
{
    Label MyLabel = (Label)MyRepeater.Items[0].FindControl("MessageID");
    MyLabel2.Text = MyLabel.Text;
} 
```

然而，使用这个，似乎 MyLabel.Text 是空的。在设置 MyLabel 后测试它是否为 null 时，结果为 false，因此我试图找出 MyLabel 在我尝试设置的中继器项目中没有相同内容的任何原因。MyLabel2 已经在类的顶部声明。提前致谢。

编辑： .aspx 文件中的标签文本不是在文本属性内进行数据绑定，而是在标签本身的容器中。根据 Benjamin 的建议，我将在周二早上尝试另一种方法，只要我能回到我的代码中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T00:25:15.123

这取决于您如何将数据绑定到中继器上的标签。

```
<asp:Repeater ID="Repeater1" runat="server">

<ItemTemplate>

    <asp:Label ID="Label1" runat="server"><%# DataBinder.Eval(Container.DataItem,"CustomerName") %></asp:Label>

    <asp:Label ID="Label2" runat="server" Text=<%# DataBinder.Eval(Container.DataItem,"Country") %>></asp:Label>

    </ItemTemplate>
</asp:Repeater> 
```

Label1 未设置 Text 属性，数据~~在客户端绑定到 Label 正文中的控件。~~**在标签呈现到页面后写入跨度标签，并且永远不会直接绑定到标签控件。仅当您在标签正文中使用行内脚本时才会发生这种情况，如果它只是文本，标签正文总是会覆盖标签的文本属性值。**

对于 Label2，Text 属性被设置~~，因此绑定发生在服务器上，~~**强制它在完成呈现 Label 之前评估内联脚本，**因此您的其他控件可以访问。

在没有实际看到您的中继器的情况下，我怀疑这就是您的数据被绑定的方式。

这是一些测试代码来向您证明这种情况。

```
protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            DataSet ds = new DataSet();
            DataTable dt = ds.Tables.Add("Customer");
            dt.Columns.Add("CustomerName", Type.GetType("System.String"));
            dt.Columns.Add("Country", Type.GetType("System.String"));

            DataRow dr = dt.NewRow();
            dr[0] = "Testcustomer1";
            dr[1] = "USA";
            dt.Rows.Add(dr);

            dr = dt.NewRow();
            dr[0] = "Testcustomer2";
            dr[1] = "UK";
            dt.Rows.Add(dr);

            dr = dt.NewRow();
            dr[0] = "Testcustomer3";
            dr[1] = "GERMANY";
            dt.Rows.Add(dr);

            dr = dt.NewRow();
            dr[0] = "Testcustomer4";
            dr[1] = "FRANCE";
            dt.Rows.Add(dr);

            //Bind the data to the Repeater
            Repeater1.DataSource = ds;
            Repeater1.DataMember = "Customer";
            Repeater1.DataBind();
        }

    }

    protected void SubmitMessage_Click(object sender, EventArgs e)
    {
        Label MyLabel = (Label)Repeater1.Items[0].FindControl("Label1");
        Label MyLabel2 = (Label)Repeater1.Items[0].FindControl("Label2");
        //Empty String Text was never set server side
        Label3.Text = MyLabel.Text;
        //String is found because Text was set
        Label4.Text = MyLabel2.Text;
    } 
```

plug it in and add a couple extra labels and you will see Label4 has the data you are looking for while Label3 is blank.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T22:13:13.113

我不确定这一点，但是当事件执行时，中继器可能尚未重新填充。由于对该方法的调用是“ByVal”（VB 说话）而不是 ByRef，因此值可能会被传递，但尚未填充原始对象......只是一个想法......

# c++ - COM、COM+、DCOM，从哪里开始？

> ID：900123
> 
> 赞同：30
> 
> 时间：2009-05-22T21:45:37.193
> 
> 标签：c++, c, com, com+, dcom

我对COM+、DCOM很好奇。我知道 MSFT 不鼓励你在本地使用这个工具（意思是 C/C++，实际上没有很多可用的文档），但我想学习使用这些技术，比如将 Internet Explorer 嵌入到 C 程序中。

我想也许我可以找到使用这个或知道这项技术的人。

从哪儿开始？有任何想法吗？任何例子（如Hello World DCOM）？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-24T04:37:32.490

如果你认真学习 COM，Don Box 的《Essential COM》绝对是一本绝对的“必读”。COM 可能会令人困惑，在我看来，Don Box 是少数几个真正“明白”的人之一。

“Essential COM”中的示例代码是用 C++ 编写的。你不会找到很多支持 C 语言的书。你可以用 C 语言编写 COM，但这会非常*非常*痛苦。COM 针对 C++ 开发进行了优化。

这本书既不完美也不“完整”。这本书略读了一些（当然，有点深奥）领域。例如，这本书有大约 1 1/2 页的“绰号”（我从未见过让我满意的绰号处理）。我认为这本书是最基础的书。

其次，在现实生活中，您可能希望使用 ATL 等支持库，而不是直接编写所有 COM 胶水。即使在基本设置中，也有太多方法可以在 COM 中犯细微的错误。ATL 将为您提供良好的模式并为您实现无聊的代码。在学习中，最好使用纯 C++。

有很多关于 ATL 的书，有几本相当不错。我知道自 VC++6 的旧时代以来，ATL 已经发生了很大变化，但我没有第一手的知识：遗憾的是，我使用的大部分 COM 代码永远锁定在 VC6 中的 C++ 风格.

确保您获得的任何书籍都是针对您计划使用的 Visual Studio 和/或 ATL 版本编写的。

COM书籍的一些背景知识：

请注意，那里有很多书误解了 COM，或者专注于错误的事情。旧书在这方面更差。前几本书中的一些将 COM 视为使 OLE 工作所需的管道细节（“对象链接和嵌入”，这就是允许您将电子表格范围拖放到 Word 文档中的原因）。正因为如此，那里的很多材料都非常混乱。过了一段时间，人们才意识到 OLE 并不那么重要，而 COM 确实如此。

当 Don Box 发表《Essential COM》时，COM 基础上的裂痕已经开始显现。COM 没有任何严重的缺陷，但是开发社区的需求已经发展并超出了 COM 在不进行重大改造的情况下所能做的事情。

.NET 的诞生就是为了解决 COM 中的限制，特别是在“类型信息”领域。在“Effective COM”出版仅仅几年之后，社区的注意力就转移到了.NET。正因为如此，好的 COM 培训材料现在并且很可能永远是有限的。

所以，COM 没有损坏，它在它所用的东西上工作得很好（这就是 Explorer 仍然使用它的原因）。对于今天需要解决的许多问题，它不再是最佳解决方案。

总之：

我推荐“Essential COM”作为基础。然后，可以使用许多优秀的 ATL 书籍中的任何一本（那里没有强烈的偏好），然后使用其他资源，如 MSDN 或 - 当然 - Stack Overflow，涵盖您特别感兴趣的领域。

如果您宁愿避免依赖死树种类的资源，请继续从 Web 学习 ATL。但是有些书值得用老式的方式阅读——《Essential COM》就是其中之一。

祝你好运。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-22T22:02:15.257

[COM](http://www.microsoft.com/com/default.mspx)、[COM+](http://msdn.microsoft.com/en-us/library/ms685978(VS.85).aspx)和[DCOM](http://msdn.microsoft.com/en-us/library/ms809340.aspx)是三个完全不同的东西。在这一点上，几乎没有理由学习 COM，几乎没有理由学习 DCOM。我能想到的唯一原因是您是否必须维护或集成遗留组件。COM+ 仍在使用，因为它允许在进程外托管组件和分布式事务管理等好东西。

开始编写一些 COM 的最佳方式是使用[ATL](http://msdn.microsoft.com/en-us/library/t9adwcde(VS.80).aspx)。在 .NET COM+ 中称为[企业服务](http://msdn.microsoft.com/en-us/library/aa286569.aspx)。

我所知道的关于 COM 的最佳书籍是 Don Box 的[Essential COM](https://rads.stackoverflow.com/amzn/click/com/0201634465)，Tim Ewald 的[COM+ 书籍](https://rads.stackoverflow.com/amzn/click/com/0201615940)也非常出色。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-07-24T11:34:48.277

我整理了一份书籍清单，应该按以下顺序阅读：

1.  Dale Rogerson 的“Inside COM”，这应该是你的第一本书。它解释了引用计数、接口、IUnknown、组件、idl、IDispatch、自动化类型和公寓的基础知识。从这本书中你会注意到，制作组件需要相当多的代码，而且你可以很容易地跳过一个'Release'，这会导致资源泄漏。这本书也缺少一些细节。
2.  来自 Tavares 的“ATL 内部”。ATL 可帮助您将两种客户端用作制作 COM 组件。如今，使用智能指针（例如 CComPtr）很难弄错引用计数。ATL 还有助于在 c++ 中制作组件。不幸的是，ATL 在宏中隐藏了许多功能，并且有一种反直观的方式来实现 IUnknown。另一种选择可能是“内部 ATL”。
3.  来自 Don Box 的“Essential COM”。这本书经常被提及，但它不是一本好的初学者书籍。它错过了整体画面，但在细节上很棒（例如 idl 中的 'size_is' 和 'length_is' 之间的区别）。
4.  “了解 ActiveX 和 OLE：开发人员和管理人员指南”。本书涉及一些更深奥的接口，如 IPersist、IStorage；IMoniker 等，但没有详细说明。

请注意，COM 在某种程度上是一种古老的技术，尽管对于本地开发人员来说仍然可行。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-22T22:15:16.510

如果您想使用或扩展各种 Windows API，例如 shell 扩展、脚本主机等，COM 仍然很有用。

Essential COM (Box) 和 ATL Internals (Rector and Sells) 是极好的资源。有效的 COM（Box 等）也可以。

如果您真的想要 COM 上的完整图片，请尝试获取巨大的 Inside OLE (Brockschmidt) 的副本。

分布式 COM (Eddon, Eddon) 在 DCOM 上很不错，就像在 COM+ 上的 Inside COM+ Base Services (Eddon, Eddon) 一样。

甚至一些所谓的“纯”C++ 书籍中也有一些关于 COM 的内容。Matthew Wilson 的 Imperfet C++ 有一些有用的部分可以用来了解它的内部工作原理，他的 Extended STL 书中有几章介绍了如何使 COM 适应 STL 集合。

如果您想了解更多关于如何编写 COM 服务器的信息，您可能需要熟悉 ATL。前面提到的 ATL 内部是必须的。尽管它的标题听起来很不起眼，但开始 ATL COM 也有一些有用的东西。

在学习过程中也有帮助的可能是将 COM 与 .NET 进行对比。.NET 和 COM 互操作性手册是一本大书，但里面有一些有用的东西。另外，我会查看 Shared Source CLI Essentials，以帮助对比这两种技术。

高温高压

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-09-09T12:11:38.723

从“Inside COM”开始，然后转到“Inside DCOM”，然后阅读“Essential COM”。您将掌握 COM。Inside COM 和 Inside DCOM 这两本书都是 Microsoft Publications。适合想要彻底了解 COM/DCOM 的人的优秀书籍。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-22T22:20:08.090

*Essential COM*特别适用于从 C++ 实现或使用 COM 组件，而无需使用 IDE、框架或库来提供帮助。

例如，在 VB 或 Delphi 中使用 COM 是微不足道的，它们对应用程序程序员隐藏了特定于 COM 的粘合剂。在 C++ 中，您经常会使用一些试图抽象细节的类库...... *Essential COM* 会告诉您这些细节是什么（并在这样做时实现了自己的库/框架）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-22T21:52:25.620

实际上，如果您想了解有关 COM 的更多信息，Microsoft 会出版一本关于 COM 及其工作原理的书... [http://www.amazon.com/Inside-Microsoft-Programming-Dale-Rogerson/dp/1572313498/ref= sr_1_2?ie=UTF8&s=books&qid=1243029018&sr=8-2](https://rads.stackoverflow.com/amzn/click/com/1572313498)

# jquery - jQuery idTabs 插件链接选项

> ID：900125
> 
> 赞同：0
> 
> 时间：2009-05-22T21:46:03.683
> 
> 标签：jquery, html, plugins

我正在使用 jQuery [idTabs](http://www.sunsean.com/idTabs/)插件。我想提供点击链接（href）功能并使用此功能的默认选项。我能怎么做？

```
<ul class="idTabs"> 
 <li>
      <a href="#div_1" href="google.com">
      Hover call div_1 and Click Call go to google
      </a>
 </li> 
</ul> 
```

注意：我正在使用悬停功能 > [$("...").idTabs("!mouseover");](https://stackoverflow.com/questions/810980) 我使用[了这个](http://kizilcahamam.bel.tr)菜单系统。

最好的祝福。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T23:49:26.507

这是解决此插件限制的一种方法，这样当您将鼠标悬停时，您会看到 DIV 的内容，并且当您单击时，您会导航到 URL。

在 html 中添加一个名为“url”的自定义属性，如下所示：

```
<ul class="idTabs"> 
 <li>
      <a href="#div_1" url="http://www.google.com">
        Hover call div_1 and Click Call go to google
      </a>
 </li> 
</ul>
<div id="div_1">Contents of Div1</div> 
```

在您的 jQuery 脚本中添加以下内容：

```
$(function(){
 $(".idTabs").idTabs("!mouseover");
 $(".idTabs a").click(function(){
   var url = $(this).attr('url');
   if(url){
     window.location = url;
   }
 });
}); 
```

# c# - 将 DataGridView 绑定到 List<>，某些属性不应显示

> ID：900126
> 
> 赞同：7
> 
> 时间：2009-05-22T21:46:04.853
> 
> 标签：c#, data-binding, datagridview

我正在尝试将 DataGridView 绑定到列表，其中 MyObject 看起来像

```
class MyObject
{
    public string Property1 { get; set; }
    public string Property2 { get; set; }
}

//List<MyObject> objects;
grid.Columns[0].DataPropertyName = "Property1";
grid.DataSource = objects; 
```

我只想显示一个属性，但是我将另一列添加到我的 DataGridView 中，其中还显示了 Property2。我怎样才能防止它被添加？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T22:15:17.743

如果您*不想*显示该属性：

```
class MyObject
{
    public string Property1 { get; set; }
    [Browsable(false)]
    public string Property2 { get; set; }
} 
```

否则，如前所述 - 设置`AutoGenerateColumns`为 false 并手动添加它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T21:52:27.960

听起来您将 DataGridView 控件的 AutoGenerateColumns 属性设置为 True。您可以将其设置为 False，或使用 .Columns.Remove 方法删除您不想看到的列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T22:16:12.903

正如 Henk 所说，我相信您需要手动设置列。但是，您可能想要设置比他的示例更多的属性。这是我在一个项目中所做的：

```
DataGridView dataGridView = new DataGridView();
dataGridView.AutoGenerateColumns = false;

DataGridViewColumn columnA = new DataGridViewTextBoxColumn();
columnA.DataPropertyName = "propertyA";
columnA.HeaderText = "Column A";
columnA.Name = "columnA";

DataGridViewColumn columnB = new DataGridViewTextBoxColumn();
columnB.DataPropertyName = "propertyB";
columnB.HeaderText = "Column B";
columnB.Name = "columnB";

dataGridView.Columns.Clear();
dataGridView.Columns.Add(columnA);
dataGridView.Columns.Add(columnB);
dataGridView.AutoResizeColumns(); 
```

我相信上述工作。如果您遇到奇怪的异常，请检查以确保列/单元格具有定义的默认单元格样式。

# firefox - 让您查看控件名称的 Firefox 插件？

> ID：900128
> 
> 赞同：0
> 
> 时间：2009-05-22T21:46:18.033
> 
> 标签：firefox, plugins

有谁知道允许您查看控件名称/ID 的 Firefox 插件？最好通过鼠标悬停或其他方式，但如果我必须右键单击它或其他方式也可以。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T21:47:59.123

萤火虫。优秀的插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T21:50:00.087

[Firebug](http://getfirebug.com/)，或者使用[DOM 检查](https://addons.mozilla.org/en-US/firefox/addon/6622)器。

# java - Java：Collections.unmodifiableXYZ(...) 在特殊情况下是否使集合对象成为享元？

> ID：900130
> 
> 赞同：1
> 
> 时间：2009-05-22T21:46:36.287
> 
> 标签：java, collections, design-patterns

可能的答案是**“从不”**或**“取决于”**。

就个人而言，我会说，**这取决于**.

以下用法会使集合看起来（对我来说）是一个轻量级：

```
public final static List<Integer> SOME_LIST = 
  Collections.unmodifiableList(
    new LinkedList<Integer>(){ // scope begins
      {
        add(1);
        add(2);
        add(3);
      }
    } // scope ends
  ); 
```

对？**您永远**无法更改它，因为唯一知道“原始”集合对象（**可以**更改）的地方是**unmodifiableList**的参数列表中的范围，该范围立即结束。

第二件事是：当您从列表中检索一个元素时，它是一个 **Integer**，它**本身**就是一个享元。

*不使用**final static**和**unmodifiableList**的其他明显情况**不会**被视为享元。*

我错过了什么？
我是否必须考虑可能会损害享元的**LinkedList的某些内部方面？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T22:16:08.007

我认为您指的是[轻量级模式。](http://en.wikipedia.org/wiki/Flyweight_pattern)这种模式的基本思想是您正在处理可以重用其实例的复杂对象，并使用其方法提出不同的表示。

为了使这样的对象正常工作，它应该是不可变的。

以您描述的方式创建列表时，明确给出了不变性。但由于没有 SOME_LISt 在其上运行的外部对象/参数，我不会将此称为享元模式的示例。

享元模式的另一个典型特性是此类对象的“驻留”。当只创建一个对象的单个实例时，这是没有意义的。

如果您经常处理从一个对象传递到另一个对象的列表，并且您希望确保不变性，那么更好的选择可能是使用[Google-Collections](http://code.google.com/p/google-collections/)。

```
final static ImmutableList<Integer> someList = ImmutableList.of(1, 2, 3); 
```

当然，也可以使用 Builders 构造更复杂的不可变对象。

这将创建一个不可变列表的实例。它仍然会实现 List 接口，但会拒绝执行任何 add()、addAll() set()、remove() 操作。

因此，当需要 List 接口时，您仍然可以将其传递给方法，但要确保其内容没有被更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T22:23:31.393

我认为您的示例是针对不可变对象的，[flyweight](http://en.wikipedia.org/wiki/Flyweight_pattern)是完全不同的。不可变对象是享元的候选对象，但享元不必是不可变的，它只需设计为节省内存即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T01:25:03.897

让库检测到可变`List`对象没有以其他方式逃脱是一个问题，尽管理论上是可能的。

如果您序列化返回的对象，则受信任的代码可以查看内部对象。尽管记录了该类的序列化形式，但没有记录该方法使用这些类。

实际上，任何缓存都取决于 API 的用户。

（为什么`LinkedList`要使用不可变列表，顺便说一句？除了它会更改不可修改的实现。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T22:42:21.773

整数只是从-128到127的享元。

另见[http://www.javaworld.com/javaworld/jw-07-2003/jw-0725-designpatterns.html](http://www.javaworld.com/javaworld/jw-07-2003/jw-0725-designpatterns.html)。

# java - 使用 Ant 执行适用于绝对路径，但不适用于相对路径

> ID：900143
> 
> 赞同：8
> 
> 时间：2009-05-22T21:48:35.660
> 
> 标签：java, ant, relative-path, absolute-path

我的 Ant 脚本中有以下代码段。它执行得很好：

```
<exec executable="C:\test\foo\programName.exe" /> 
```

但是当我尝试通过设置目录来执行它时，如下所示：

```
<exec executable="programName.exe"
  dir="C:\test\foo\" /> 
```

我得到：

> 执行失败：java.io.IOException：无法运行程序“programName.exe”（在目录“C:\test\foo”中）：CreateProcess error=2，系统找不到指定的文件

请帮忙！为什么单独指定目录时它不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T02:15:22.313

添加**resolveexecutable**属性：

```
<exec executable="programName.exe" 
  resolveexecutable="true"
  dir="C:\test\foo\" /> 
```

> **resolveexecutable** 当此属性为 true 时，可执行文件的名称首先根据项目 basedir 解析，如果不存在，则根据指定的执行目录解析。在 Unix 系统上，如果您只想允许执行用户路径中的命令，请将其设置为 false。从 Ant 1.6 开始 **没有，默认为 false**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T12:22:41.037

我最终坚持了这一点：

```
<exec executable="${basedir}\myexefile.exe}" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T22:05:09.777

试试这个：

```
<property name="prog.dir" value="C:/test/foo" />
<exec executable="${prog.dir}/programName.exe"/> 
```

您执行程序的目录似乎必须在您的构建路径中。

# c++ - 在学习新语言相关的阅读、分心或辅助工具时？

> ID：900145
> 
> 赞同：0
> 
> 时间：2009-05-22T21:49:02.693
> 
> 标签：c++, programming-languages

在从 PHP 中学习 C++ 等新语言时，阅读其他语言片段是否可以通过提供不同的前景来帮助您更好地理解，或者这样做是否会使像我这样的菜鸟感到困惑？此外，任何关于学习 C++ 的建议都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T21:56:18.590

我发现它有助于

1.  通过查看简单的示例并将其与**您已经知道的内容相关联，从而很好地掌握该语言的语法和语义**
2.  看看哪些库和设计模式是常见的。找出它们常见的**原因。**语言是否旨在鼓励他们？是约定吗？高效的？
3.  **有一个**你想用该语言实现的想法。它会给你一个目标和一些观点。
4.  看看其他人的代码，一旦你习惯了拆开阅读它，并且习惯了源布局、约定、通用命名等等

我发现最好先潜入头脑。如果可能的话，从人们那里获得反馈。最重要的是：

**不要害怕犯错误**，它们是学习过程的重要组成部分。并尝试**将事物**与您已经熟悉的概念联系起来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T22:00:07.117

我发现阅读简短的片段有很大帮助。一本好书也很方便。一旦你理解了语言本身的大部分内容，阅读大型的全尺寸程序有助于了解如何解决该语言中的常见问题。大多数语言没有这个术语，但它就像 Python 中的“Pythonic”方式。

至于学习C++，首先要对C有一个很好的了解。C很简单，所以应该不会花那么长时间。一旦您了解了 C，就开始一次学习 C++ 的特定功能。这样，在学习真正的“C++ ic”方式之前，您仍然可以编写有用的程序（C 主要是 C++ 的一个子集）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T01:33:36.140

如果您没有足够的经验来提出这个问题，我建议您阅读简短的片段，但*不要*阅读其他语言。一个更好的脑力练习是说给定一个新语言 (C++) 的简短片段，它与你用你已经知道的旧语言 (PHP)*编写的内容相比如何？*类似地，如果你读到一个新的 C++ 东西，问问你可以用新的 C++ish 方式表达什么 PHP 片段。

关于 C++ 本身，还有很多其他的 SO 问题需要解决。我认为值得重申的是，这本由四位作者撰写的*设计模式*书对于学习许多长期 C++ 程序员的词汇和思维方式非常有帮助。

# asp.net - 为什么我的 webservice 方法会通过 GET 调用？

> ID：900154
> 
> 赞同：2
> 
> 时间：2009-05-22T21:51:13.250
> 
> 标签：asp.net, web-services

我有一个带有 *.asmx 的 asp.net 3.5 站点，它提供多种 Web 服务方法。唯一应该调用这些方法的客户端是我编写的客户端，它使用 POST 请求调用它们。但是，由于使用 GET 请求调用这些方法，我的错误日志显示了许多 InvalidOperationException 错误。

问题：什么可能导致这些 GET 请求？代理是否可以将 POST 请求转换为 GET 请求，而客户端却不知道它的请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T21:57:31.430

机器人和爬虫？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T22:30:36.900

您的客户端应用程序中总是可能存在错误。为什么不使用 HTTP 嗅探器，这样您就可以准确地看到正在发送的请求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T22:34:22.540

扩展 rusanu 的答案、机器人和爬虫和/或黑客？

# ruby - 如果我安装了 jRuby on Rails，我可以只使用 Ruby 吗？

> ID：900168
> 
> 赞同：3
> 
> 时间：2009-05-22T21:56:04.630
> 
> 标签：ruby, jruby, jrubyonrails

我的意思是如果我在 Rails 上安装 jRuby，我可以只使用 ruby​​ 语言来构建我的应用程序吗？我想用 jRuby 安装我的 rails 应用程序，以防我将来想使用 Java，尽管我现在不需要它。还是我不明白？jRuby ruby​​ 是否可以访问 java 库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T23:21:42.413

是的，jruby 就是 ruby​​（您的 ruby​​ 脚本无需修改即可在 jruby 下运行）。此外，它还可以完全访问 java 库 - 查看[wiki](http://wiki.jruby.org/wiki/Calling_Java_from_JRuby)，了解将 java 类或库集成到您的 ruby​​ 代码中是多么容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T02:47:43.793

其他人已经回答了你的直接问题。我只想说，在过去的 6 个月里，我一直在工作中全职使用 jruby，这很棒。使用 glassfish gem 部署 rails 应用程序非常容易，并且 jruby 的性能优于 MRI ruby​​ 1.8.x。

6 个月后我没有看到任何真正的缺点，除了我们不能使用用 C 编写的 gem麻烦。

通过在 java 中编写一些关键部分来加速您的应用程序也非常容易（这比 C 更容易使用）。

# ruby-on-rails - Ruby on Rails 项目需要过滤器/观察器的替代品

> ID：900171
> 
> 赞同：0
> 
> 时间：2009-05-22T21:57:00.697
> 
> 标签：ruby-on-rails, ruby, database, performance, observer-pattern

Rails 有一组很好的过滤器（before_validation、before_create、after_save 等）以及对观察者的支持，但我面临的情况是，依赖过滤器或观察者在计算上过于昂贵。我需要一个替代方案。

问题：我正在记录对大量页面的 Web 服务器点击。我需要的是一个触发器，它会在给定页面的浏览次数超过 X 次时执行操作（例如，发送电子邮件）。由于页面和点击量巨大，使用过滤器或观察器会浪费大量时间，因为 99% 的时间，它测试的条件都是错误的。电子邮件不必*立即*发送（即可以接受 5-10 分钟的延迟）。

相反，我考虑的是实现某种流程，每 5 分钟左右扫描一次数据库，并检查哪些页面被点击超过 X 次，在新的数据库表中记录该状态，然后发送相应的电子邮件。它并不完全优雅，但它会起作用。

还有其他人有更好的主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T22:52:09.260

耙任务很好！但是您最终将为您添加的每个后台作业编写更多自定义代码。查看延迟作业插件[http://blog.leetsoft.com/2008/2/17/delayed-job-dj](http://blog.leetsoft.com/2008/2/17/delayed-job-dj)

DJ 是一个异步优先级队列，它依赖于一个简单的数据库表。根据 DJ 网站，您可以使用如下所示的*Delayed::Job.enqueue()方法创建作业。*

```
class NewsletterJob < Struct.new(:text, :emails)
  def perform
    emails.each { |e| NewsletterMailer.deliver_text_to_email(text, e) }
  end    
end  

Delayed::Job.enqueue( NewsletterJob.new("blah blah", Customers.find(:all).collect(&:email)) ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T15:53:14.530

我曾经是编写自定义广告服务器的团队的一员，该服务器具有相同的要求：监控每个文档的点击次数，并在达到特定阈值时执行某些操作。该服务器将为现有的非常大的站点提供大量流量，并且可扩展性是一个真正的问题。我的公司聘请了两名 Doubleclick 顾问来挑选他们的大脑。

他们的意见是：保存任何信息的最快方法是将其写入自定义 Apache 日志指令。所以我们建立了一个网站，每次有人点击一个文档（广告、页面，都一样），处理请求的服务器会在日志中写入一条 SQL 语句：“INSERT INTO Impressions (timestamp, page, ip, etc) ) VALUES (x, 'path/to/doc', y, etc);" -- 所有动态输出都来自网络服务器的数据。每 5 分钟，我们会从 Web 服务器收集这些文件，然后一次将它们全部转储到主数据库中。然后，在闲暇时，我们可以解析这些数据以做任何我们满意的事情。

根据您的确切要求和部署设置，您可以执行类似的操作。检查您是否超过某个阈值的计算要求可能仍然比执行 SQL 以增加值或插入行更小（在这里猜测）。您可以通过记录命中（特殊格式或非特殊格式）来消除这两种开销，然后定期收集它们，解析它们，将它们输入数据库，然后对它们做任何你想做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T22:07:05.730

保存 Hit 模型时，更新 Page 模型中的一个冗余列，该列存储运行中的命中总数，这会花费您 2 个额外的查询，因此每个命中可能需要两倍的时间来处理，但您可以决定是否需要发送带有简单 if 的电子邮件。

您的原始解决方案也不错。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T22:09:07.317

我必须在这里写一些东西，以便 stackoverflow 代码突出显示第一行。

```
class ApplicationController < ActionController::Base
  before_filter :increment_fancy_counter

  private

  def increment_fancy_counter
    # somehow increment the counter here
  end
end

# lib/tasks/fancy_counter.rake
namespace :fancy_counter do
  task :process do
    # somehow process the counter here
  end
end 
```

让一个 cron 作业运行，`rake fancy_counter:process`但你希望它经常运行。

# emacs - 在 PuTTY 中，Emacs 组合键没有效果

> ID：900177
> 
> 赞同：8
> 
> 时间：2009-05-22T21:59:08.820
> 
> 标签：emacs, ide, text-editor, putty

请尽量原谅这个稍微偏离编程主题的问题。至少我在将我的 C++ 代码移植到 Linux 时遇到了这个问题。我遇到的问题非常基本：emacs 无法识别某些组合键。结果之一是我无法在 Emacs 中“撤消”编辑。

我正在将 Putty.exe 从 Windows 运行到我的 Ubuntu 机器。Putty 字符集（Window -> Translation -> received data char set）是 UTF-8，我所有的瑞典语字符都整齐地显示在控制台上。然而，在 Emacs 中，我无法让 C-_ 工作。没发生什么事。我的瑞典语键盘上的组合键是

```
Ctrl Shift -
```

任何指针都有帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T22:14:41.800

尝试使用`Ctrl`和`"-"`。我不使用 emacs，但我将该键用于 screen(1)，因为它不用于其他任何东西（并且 Ctrl-a 的默认值不是那么有用）。在 Windows 上（使用我的挪威语键盘）触发它的按键只是 Ctrl-。在 KDE 的 konsole 窗口中 Ctrl- 会减小字体大小，所以我不得不退回到那里`Ctrl Shift -`（它曾经只是 Ctrl- 几年前也是如此）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T22:17:32.060

当我使用瑞典语键盘设置进行编辑时，我已经习惯了撤消，`C-x u`原因我已经记不得了。

# apache-flex - 可以在 List 组件中显示 Sprite 的 arrayCollection 吗？

> ID：900184
> 
> 赞同：1
> 
> 时间：2009-05-22T22:01:11.577
> 
> 标签：apache-flex, sprite, itemrenderer, arraycollection

我有一个扩展 Sprite 的对象的 arrayCollection，并且其中有位图。

我想在列表中显示这些（或允许用户滚动浏览它们并查看其关联数据的其他组件。）

当我这样做时： myList.dataProvider = myArrayCollection

该列表只显示了一堆 [Object, Item] 而不是视觉精灵。

这是我的对象的简化版本：

```
public class myUIC extends UIComponent
    {

        public var mySprite:Sprite = new Sprite;

        [Embed(source="assets/BGimage.png")]
        public var BGimage:Class;

        public var myBitmap:Bitmap;
        public var wordText:TextField = new TextField;

        public function myUIC(myWord:String)
        {
            this.wordText.text = myWord;
            this.myBitmap = new BGimage;
            this.mySprite.addChild(this.myBitmap);
            this.mySprite.addChild(this.wordText);
            this.addChild(this.mySprite);
        }
    } 
```

尝试了许多不同的方法让它显示在列表中，但不能这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T08:10:28.920

请参阅本教程：[Flex 示例 - 在 flex 列表控件中显示图标](http://blog.flexexamples.com/2007/08/17/displaying-icons-in-a-flex-list-control/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-28T09:13:49.110

在这里，尝试使用类似这样的 itemRenderer。它应该适用于任何通用的 DisplayObject。它从分配的数据属性中获取宽度和高度，因此您可能需要在实际列表中将 variableRowHeight 设置为 true 才能按预期工作。

```
package
{
    import flash.display.DisplayObject;
    import mx.controls.listClasses.IListItemRenderer;
    import mx.core.UIComponent;
    import mx.events.FlexEvent;

    /*
    Extending UIComponent means we can add Sprites (or any DisplayObject)
    with addChild() directly, instead of going through the rawChildren property.
    Plus, in this case, we don't need the extra overhead of Canvas's layout code.

    IListItemRenderer lets us use it as a List's itemRenderer. UIComponent already
    implements all of IListItemRenderer except for the data property
    */
    public class SpriteRenderer extends UIComponent implements IListItemRenderer
    {
        // Implementing the data property for IListItemRenderer is really easy,
        // you can find example code in the LiveDocs for IDataRenderer
        private var _data:Object;

        [Bindable("dataChange")]
        public function get data():Object
        {
            return _data;
        }

        public function set data(value:Object):void
        {
            if (value !== _data) {

                // We need to make sure to remove any previous data object from the child list
                // since itemRenderers are recycled
                if (_data is DisplayObject && contains(_data as DisplayObject)) {
                    removeChild(_data as DisplayObject);
                }

                _data = value;

                // Now we just make sure that the new data object is something we can add
                // and add it
                if (_data is DisplayObject) {
                    this.width = (_data as DisplayObject).width;
                    this.height = (_data as DisplayObject).height;

                    addChild(_data as DisplayObject);
                }

                dispatchEvent(new FlexEvent(FlexEvent.DATA_CHANGE));
            }
        }

        public function SpriteRenderer()
        {
            super();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T01:41:57.653

听起来您可能想尝试编写一个简单的项目渲染器（可能基于 UIComponent），它使用 addChild() 将关联的精灵添加到渲染的显示列表中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-21T18:19:04.187

尝试 rawChildren.addChild 添加 Sprite

# c++ - 在 C++ 中捕获错误的数组引用

> ID：900199
> 
> 赞同：2
> 
> 时间：2009-05-22T22:07:22.610
> 
> 标签：c++, arrays, exception, reference, manpage

如何在 C++ 中捕获错误的数组引用？为什么以下代码不起作用：

```
 #include <exception>

    int * problemNum = new int;
    int (* p [100])() = {problem1, problem2, problem3};

    ...

    try {
        cout << (*p[*problemNum-1])();
    }
    catch (exception){
        cout << "No such problem";
    } 
```

我的编译器说：*Euler.exe 中 0xcccccccc 处的未处理异常：0xC0000005：访问冲突。*当我通过输入`0`*problemNum 来启动错误引用时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T22:22:21.597

alamar 是对的——C++ 不会用这种类型的数组捕获异常。

改用 STL 向量：

```
#include <exception>
#include <vector>

int * problemNum = new int;
std::vector<int(*)()> p;
p.push_back(problem1);
p.push_back(problem2);
p.push_back(problem3);

...

try {
    cout << p.at(*problemNum-1)();
}
catch (exception){
    cout << "No such problem";
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T22:10:26.567

因为 C++ 无法通过其异常机制处理此类错误。有关该问题，请参阅[有缺陷的 C++ 。](http://www.yosefk.com/c++fqa/defective.html#defect-4)

使用`sigaction(2)`.

*sigaction - 检查和更改信号动作*

概要

```
 #include <signal.h>

   int sigaction(int signum, const struct sigaction *act,
                 struct sigaction *oldact); 
```

描述 sigaction() 系统调用用于更改进程在接收到特定信号时采取的操作。signum 指定信号并且可以是除 SIGKILL 和 SIGSTOP 之外的任何有效信号。如果 act 不为空，则从 act 安装信号 signum 的新动作。如果 oldact 不为 null，则前一个操作保存在 oldact 中。sigaction 结构定义为：

```
 struct sigaction {
           void     (*sa_handler)(int);
           void     (*sa_sigaction)(int, siginfo_t *, void *);
           sigset_t   sa_mask;
           int        sa_flags;
           void     (*sa_restorer)(void);
       }; 
```

您需要捕获 SIGSEGV，您可以附加自己的处理程序（执行非法内存访问时调用的函数）。

# php - 将 PHP 页面作为图像返回

> ID：900207
> 
> 赞同：72
> 
> 时间：2009-05-22T22:10:43.133
> 
> 标签：php, image-processing, http-headers, mime-types

我正在尝试读取图像文件（确切地说是.jpeg），并将其“回显”回页面输出，但是显示图像...

我的 index.php 有一个像这样的图片链接：

```
<img src='test.php?image=1234.jpeg' /> 
```

我的 php 脚本基本上是这样做的：

1) 读取 1234.jpeg 2) 回显文件内容... 3) 我觉得我需要用 mime 类型返回输出，但这是我迷路的地方

一旦我弄清楚这一点，我将一起删除文件名输入并将其替换为图像 ID。

如果我不清楚，或者您需要更多信息，请回复。

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2009-05-22T22:17:02.620

PHP手册有[这个例子](http://php.net/manual/en/function.fpassthru.php)：

```
<?php
// open the file in a binary mode
$name = './img/ok.png';
$fp = fopen($name, 'rb');

// send the right headers
header("Content-Type: image/png");
header("Content-Length: " . filesize($name));

// dump the picture and stop the script
fpassthru($fp);
exit;
?> 
```

重要的一点是您必须发送 Content-Type 标头。此外，您必须注意不要在`<?php ... ?>`标签之前或之后在文件中包含任何额外的空格（如换行符）。

`?>`正如评论中所建议的，您可以通过省略标签来避免脚本末尾出现额外空白的危险：

```
<?php
$name = './img/ok.png';
$fp = fopen($name, 'rb');

header("Content-Type: image/png");
header("Content-Length: " . filesize($name));

fpassthru($fp); 
```

您仍然需要小心避免脚本顶部的空白。一种特别棘手的空白形式是[UTF-8 BOM](http://en.wikipedia.org/wiki/Byte_order_mark#UTF-8)。为避免这种情况，请确保将您的脚本保存为“ANSI”（记事本）或“ASCII”或“UTF-8 without signature”（Emacs）或类似文件。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-11-07T22:59:00.150

我觉得我们可以通过从 $image_info 获取 mime 类型来简化这段代码：

```
$file_out = "myDirectory/myImage.gif"; // The image to return

if (file_exists($file_out)) {

   $image_info = getimagesize($file_out);

   //Set the content-type header as appropriate
   header('Content-Type: ' . $image_info['mime']);

   //Set the content-length header
   header('Content-Length: ' . filesize($file_out));

   //Write the image bytes to the client
   readfile($file_out);
}
else { // Image file not found

    header($_SERVER["SERVER_PROTOCOL"] . " 404 Not Found");

} 
```

使用此解决方案可以处理任何类型的图像，但这只是另一种选择。感谢*禁令地球工程*的贡献。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-30T15:41:40.847

这应该有效。它可能会更慢。

```
$img = imagecreatefromjpeg($filename);
header("Content-Type: image/jpg");
imagejpeg($img);
imagedestroy($img); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-03-02T18:31:43.967

我在没有 Content-Length 的情况下工作。也许是远程图像文件的原因

```
// open the file in a binary mode
$name = 'https://www.example.com/image_file.jpg';
$fp = fopen($name, 'rb');

// send the right headers
header('Cache-Control: no-cache, no-store, max-age=0, must-revalidate');
header('Expires: January 01, 2013'); // Date in the past
header('Pragma: no-cache');
header("Content-Type: image/jpg");
/* header("Content-Length: " . filesize($name)); */

// dump the picture and stop the script
fpassthru($fp);
exit; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-05-16T02:19:13.670

非常非常容易。

```
<?php

//could be image/jpeg or image/gif or whatever
header('Content-Type: image/png')
readfile('image.png')
?> 
```

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2009-05-22T23:11:57.050

如果您不从数据库中读取数据，另一个简单的选项（不是更好，只是不同）是使用一个函数为您输出所有代码...注意：如果您还希望 php 读取图像尺寸并给出为了更快地渲染客户端，您也可以使用此方法轻松地做到这一点。

```
<?php
  Function insertImage( $fileName ) {
    echo '<img src="path/to/your/images/',$fileName,'">';    
  }
?>

<html>
  <body>
    This is my awesome website.<br>
    <?php insertImage( '1234.jpg' ); ?><br>
    Like my nice picture above?
  </body>
</html> 
```

# database - 在错误/错误状态模型中，外键将驻留在哪里？

> ID：900213
> 
> 赞同：0
> 
> 时间：2009-05-22T22:13:30.147
> 
> 标签：database, database-design, foreign-key-relationship

我总是卡在外键上，所以我有一个关于外键应该驻留在错误跟踪系统中的位置的问题，在这个系统中，错误在任何给定时间都有一个状态，而只有少数状态存在（打开，正在调查，已解决，待批准）。所以每个状态都有很多与之相关的错误。我的假设是外键应该作为引用状态表中 id 列的 status_id 列驻留在 Bug 表中。这是一个安全的假设吗？

```
TABLE:
    Bug
    id integer
    desc string
    status_id integer fk

    Status
    id integer
    desc string

RAILS MODEL:
    Bug
    has_one :status

    Status
    has_and_belongs_to_many :bugs 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T22:15:35.260

是的，你的假设是正确的。只要每个 Bug 只有一个状态，您就可以将外键包含到该表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T22:16:34.340

您的假设是正确的，更重要的是关系（一对多/一对一/多对多）决定哪个表是主键表，哪个是外键表？

在这种情况下，Status 表清楚地包含了 FK 关系的主键。如果反过来，则每个状态都必须先存在于 Bug 表中，然后才能存在于 Status 表中，这显然不是有意的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T22:16:14.853

是的，这是正确的。考虑这一点的方法是您的错误具有状态；任何给定状态都有许多错误。

# php - 用于清理空的、不必要的 HTML 标记的正则表达式

> ID：900214
> 
> 赞同：4
> 
> 时间：2009-05-22T22:14:01.567
> 
> 标签：php, regex, replace, preg-replace

我在我的一个项目中使用 TinyMCE (WYSIWYG) 作为默认编辑器，有时它会自动添加`<p>&nbsp;</p> , <p> </p>`或 div。

我一直在搜索，但我真的找不到用正则表达式清理任何空标签的好方法。

我尝试使用的代码是，

```
$pattern = "/<[^\/>]*>([\s]?)*<\/[^>]*>/";
$str = preg_replace($pattern, '', $str); 
```

注意：我也想清除   :(

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T22:21:36.560

试试 `/<(\w+)>(\s|&nbsp;)*<\/\1>/` 吧。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T22:22:09.630

那个正则表达式有点奇怪——但看起来它可能会起作用。你可以试试这个：

```
$pattern = ':<[^/>]*>\s*</[^>]*>:';
$str = preg_replace($pattern, '', $str); 
```

不过非常相似。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-25T13:21:46.200

尝试这个：

```
<([\w]+)[^>]*?>(\s|&nbsp;)*<\/\1> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T22:51:39.900

我知道这不是您直接要求的，但是在使用了几个月的 TinyMCE 之后，不仅要处理这个问题，还要处理用户直接从 Word 发布的问题，我已经切换到[FCKeditor](http://www.fckeditor.net/)并且非常高兴。

编辑：以防万一不清楚，我要说的是 FCKeditor 不会在感觉像的地方插入任意段落，并且可以处理开箱即用的粘贴 Word 废话。您可能会发现我[之前的问题](https://stackoverflow.com/questions/379342/php-to-clean-up-pasted-microsoft-input)会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T23:44:58.170

您需要多个正则表达式来确保您不会用一个通用的元素消除其他想要的元素。

正如 Ben 所说，您可以使用一个通用正则表达式删除有效元素

```
<\s*[^>]*>\s*`&nbsp;`\s*<\s*[^>]*>
<\s*p\s*>\s*<\s*/p\s*>
<\s*div\s*>\s*<\s*/div\s*> 
```

# c# - 如何处理 WPF 中长时间运行的“线程”？

> ID：900215
> 
> 赞同：5
> 
> 时间：2009-05-22T22:14:33.563
> 
> 标签：c#, .net, wpf, multithreading

晚上好！

目前我正在为一些休息服务开发一个 wpf 客户端。与 rest-service 的通信没有问题，并且是在一个额外的程序集（通信接口）中完成的。

基本上：
我有一个执行方法的“搜索”按钮。这个方法与服务通信，更新一些文本框和一个进度条（给用户一些图形信息，我们有多远......）。不幸的是，托管服务的服务器有点蹩脚，导致一些严重的响应时间（大约 4 秒）。另一方面，这会导致我的 wpf 应用程序等待，最终结果为：变黑，并且标题为“无响应”......

我已经尝试将此执行放在另一个线程中，但是......我无法访问我的 wpf 窗口的控件是合乎逻辑的......

atm 我真的很无助......谁能给我一些处理程序或解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T22:18:48.610

您的 UI 线程正忙于等待来自 Web 服务的响应，并且无法绘制屏幕。一个不错的选择是将服务请求推送到另一个非 UI 线程。查看[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)，它是专门为简化此操作而设计的。它处理从非 UI 到 UI 线程的跨线程调用的编组。

大致：

```
BackgroundWorker bw = new BackgroundWorker();
bw.DoWork += new DoWorkEventHandler(bw_DoWork);
bw.ProgressChanged += new ProgressChangedEventHandler(bw_ProgressChanged);
bw.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw_RunWorkerCompleted);
bw.RunWorkerAsync(arg);
...

static void bw_DoWork(object sender, DoWorkEventArgs e)
{
    BackgroundWorker worker = (BackgroundWorker)sender;
    int arg = (int)e.Argument;
    e.Result = CallWebService(arg, e);
}

static void bw_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
    progressBar.Increment();
}

static void bw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    label.Text = "Done: " + e.Result.ToString();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T22:22:51.847

要从第二个线程访问您的控件，请使用 Dispatcher.BeginInvoke：

```
Dispatcher.BeginInvoke(new Action(() =>
    {
        // Update your controls here.
    }), null); 
```

或者您可以考虑使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)。

# vb.net - 如何使用后期绑定调用带有 ByRef 参数的方法

> ID：900227
> 
> 赞同：1
> 
> 时间：2009-05-22T22:16:44.650
> 
> 标签：vb.net, com-interop, late-binding

我有一个 COM 组件，我想使用 VB.NET 的后期绑定来调用它（使用痛苦的 Primary Interop Assembly - PIA 方法）

我的 COM 方法的 IDL 签名如下所示：

```
HRESULT Send([in]BSTR bstrRequestData,
             [out]VARIANT *pvbstrResponseData,
             [out]VARIANT *pvnExtCompCode,
             [out,retval]int *pnCompletionCode); 
```

所以 VB.NET 术语中的 2 个“ByRef”参数和一个返回值。

我尝试像这样调用这个方法：

```
Dim parameters(2) As Object
parameters(0) = "data"
parameters(1) = New Object()
parameters(2) = New Object()

Dim p As New ParameterModifier(3)
p(1) = True
p(2) = True
Dim parameterMods() As ParameterModifier = {p}

objReturn = MyObject.GetType().InvokeMember("Send", _
                                            BindingFlags.InvokeMethod, _
                                            Nothing, _
                                            MyObject, _
                                            parameters, _
                                            parameterMods, _
                                            Nothing, _
                                            Nothing) 
```

这失败了一个异常：{“无效的被调用者。（来自HRESULT的异常：0x80020010（DISP_E_BADCALLEE））”}

我认为这意味着我在 parameterMods 数组中做错了。因为如果我注释掉将 ParameterMods 数组的任何值设置为“True” - 它会起作用。它当然不会更新 [out] 参数的参数，因此它没有按预期工作。

由于该方法也有返回值，还有其他需要考虑的吗？[MSDN 示例](http://msdn.microsoft.com/en-us/library/system.reflection.parametermodifier.aspx)几乎完全符合我的要求，只是该示例没有返回值。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T10:29:00.170

一个问题是您的参数和 ParameterModifier 数组具有不同的大小。我相信它们必须匹配，以便 CLR/BCL 可以将每个参数与 ParameterModifier 匹配。

如果 PIA 是使用保留签名属性生成的，则该方法实际上有 4 个参数而不是 3 个。您需要扩展数组以容纳 4 个成员，并且 pnCompletionCode 的返回值将在参数数组的最后一个索引中通话完成。

另外我很好奇你为什么使用这种调用方法。既然您使用的是 VB.Net，为什么不禁用 Option Explicit 并使用 VB 后期活页夹。这比自己编写反射代码要容易得多（并且通常会更正确，因为它会处理奇怪的编组规则）。

```
Option Explicit Off
...
Dim obj As Object = DirectCast(MyObject,Object)
obj.Send("data", new Object(), new Object()) 
```

# c++ - long 和 int 数据类型之间的区别

> ID：900230
> 
> 赞同：47
> 
> 时间：2009-05-22T22:17:51.153
> 
> 标签：c++, types, integer, size

考虑到以下语句 return ， C++ 中的和类型`4`有什么区别？`int``long`

```
sizeof(int)
sizeof(long) 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-22T22:20:38.933

从[这个](http://tsemba.org/c/inttypes.html)参考：

> int 最初旨在成为处理器的“自然”字长。许多现代处理器可以同样轻松地处理不同的字长。

另外，这一点：

> 在许多（但不是全部）C 和 C++ 实现中，long 大于 int。当今最流行的桌面平台，例如 Windows 和 Linux，主要在 32 位处理器上运行，并且这些平台的大多数编译器都使用 32 位 int，其大小和表示形式与 long 相同。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-05-22T22:59:04.423

标准给你的保证是这样的：

```
1 == sizeof(char) <= sizeof(short) <= sizeof (int) <= sizeof(long) <= sizeof(long long) 
```

所以它对平等是完全有效的`sizeof (int)`，`sizeof (long)`许多平台选择采用这种方法。你会发现一些平台`int`有 32 位、`long`64 位和`long long`128 位，但 4 位似乎很常见`sizeof (long)`。

（请注意，`long long`从 C99 开始，它在 C 中被识别，但通常在 C++11 之前的 C++ 中作为扩展实现。）

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-22T22:21:04.517

您使用的是 32 位计算机或 64 位 Windows 计算机。在我的 64 位机器上（运行 Unix 衍生操作系统，而不是 Windows）`sizeof(int) == 4`，但是`sizeof(long) == 8`.

它们是不同的类型——有时大小相同，有时不同。

（在过去的日子里，`sizeof(int) == 2`虽然`sizeof(long) == 4`那可能是 C++ 存在之前的日子，但想想看。不过，从技术上讲，它是一个合法的配置，尽管在嵌入式空间之外是不寻常的，甚至在嵌入式领域也很可能是不寻常的嵌入空间。）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-22T22:18:44.053

在它们都具有相同大小的平台上，答案是什么。它们都代表有符号的 4 字节值。

但是，您不能相信这是真的。标准没有明确定义 long 和 int 的大小。编译器可以给类型不同的大小，从而打破这个假设。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-22T22:23:07.587

long 必须至少与 int 大小相同，并且可能（但不一定）更长。

在常见的 32 位系统上，int 和 long 都是 4 字节/32 位，根据 C++ 规范这是有效的。

在其他系统上，int 和 long long 的大小可能不同。我曾经在一个平台上工作，int 是 2 字节，long 是 4 字节。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-05-28T01:44:30.023

一个典型的最佳实践是不直接使用 long/int/short。相反，根据编译器和操作系统的规范，将它们包装到头文件中，以确保它们准确地保存您想要的位数。然后使用 int8/int16/int32 而不是 long/int/short。例如，在 32 位 Linux 上，您可以像这样定义一个标头

```
typedef char int8;
typedef short int16;
typedef int int32;
typedef unsigned int uint32; 
```

# c# - ASMX webservice 不返回 JSON，只能使用 application/x-www-form-urlencoded contentType POST

> ID：900231
> 
> 赞同：8
> 
> 时间：2009-05-22T22:17:58.500
> 
> 标签：c#, jquery, web-services, sharepoint, asmx

如果 contentType = "application/x-www-form-urlencoded; charset=utf-8"，我可以使用 jQuery 调用我的网络服务

但是，这将返回 xml：`<string>[myjson]</string>`

如果我尝试使用“application/json; charset=utf-8” POST 到服务，我会收到一个 500 错误，其中包含空的 StackTrace 和 ExceptionType。我的网络服务功能从未被击中，所以我不太确定如何调试这种情况。

我的方法和类用适当的属性修饰，并设置为使用 JSON 作为它们的响应类型（我的 wsdl 和 disco 文件也是如此）。我在 web.config 中安装了 Ajax 扩展和所需的条目。

这是在 SharePoint 场上，但我不确定这会产生多大的不同。我在所有 WFE 上部署了 web.config 更改，并安装了 ajax 扩展。该服务再次起作用，它只接受默认内容类型以外的任何内容。

不知道我在这里错过了什么，伙计们......

我的ajax调用：

```
$.ajax({
type: "POST",
url: "/_vti_bin/calendar.asmx/Test",
dataType: "json",
data: "{}",
contentType: "application/json; charset=UTF-8",
success: function(msg){
    alert(msg);
    },
error: function(xhr, msg){ alert(msg + '\n' + xhr.responseText); }
}); 
```

我的网络服务类：

```
[WebService(Namespace = "http://namespace")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[ScriptService()]
public class CalendarService : WebService
{
    [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    public string Test()
    {
        return "Hello World";
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-29T19:44:21.020

I have this working in 2.0 using web services, but I have put in place protection from the .d (see dataFilter below). I also am returning an array of objects. NOTE: the class for the object is static, or it would not work correctly for me at least.

```
 $.ajax({
        type: "POST",
        contentType: "application/json; charset=utf-8",
        data: "{}",
        dataFilter: function(data)
        {
            var msg;
            if (typeof (JSON) !== 'undefined' &&
                typeof (JSON.parse) === 'function')
                msg = JSON.parse(data);
            else
                msg = eval('(' + data + ')');
            if (msg.hasOwnProperty('d'))
                return msg.d;
            else
                return msg;
        },
        url: "webservice/ModifierCodesService.asmx/GetModifierList",
        success: function(msg)
        {
            LoadModifiers(msg);
        },
        failure: function(msg)
        {
            $("#Result").text("Modifiers did not load");
        }
    }); 
```

Here is a snippett of my web service:

...

```
[WebService(Namespace = "http://mynamespace.com/ModifierCodesService/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.ComponentModel.ToolboxItem(false)]
[ScriptService]
public class ModifierCodesService : System.Web.Services.WebService
{

     /// <summary>
    /// Get a list of Modifiers
    /// </summary>
    /// <returns></returns>
    [WebMethod(EnableSession = true)]
    public Modifier[] GetModifierList()
    {
        return GetModifiers();
    }
       /// <summary>
        /// Modifiers list from database
        /// </summary>
        /// <returns></returns>
        private Modifier[] GetModifiers()
        {
            List<Modifier> modifier = new List<Modifier>();
            ModifierCollection matchingModifiers = ModifierList.GetModifierList();
            foreach (Modifier ModifierRow in matchingModifiers)
            {
                modifier.Add(new Modifier(ModifierRow.ModifierCode, ModifierRow.Description));
            }
            return modifier.ToArray();
        }
    } 
```

...

the object code:

```
 public static class ModifierList
    {

        /// <summary>
        /// Returns the Modifier Collection.
        /// </summary>
        /// <param name="prefix"></param>
        /// <returns></returns>
        public static ModifierCollection GetModifierList()
        { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-29T00:36:24.443

今天我一直在用一个 iPhone 应用程序与一个 .Net Web 服务通信来解决这个问题。

我发现，如果我将我的内容类型更改为 application/jsonrequest，它就会顺利通过，并且我能够在我的 Web 服务器中处理数据。

只是为了笑，我将上面提到的行添加到我的 web.config 中，但它并没有使 application/json 工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T14:09:52.420

我经常使用 JQuery AJAX JSON 调用 ASMX webservice。它在所有浏览器中都能完美运行。我正在使用安装了 ASP.NET AJAX 扩展的 .NET 2.0（捆绑在 3.5 中）。

我的班级有和你一样的装饰师。我的方法只有`[WebMethod(EnableSession = true)]`装饰器。但是，我的 web.config 在其 httpHandlers 部分中有以下条目：

```
<add verb="*" path="*jsonservice.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" /> 
```

我的 jquery 调用如下所示：

```
$.ajax({
    type: "POST",
    contentType: "application/json; charset=utf-8",
    url: "path/to/service/jsonservice.asmx/MethodName",
    data: JSON.stringify(DTO),
    dataType: "json",
    success: function(rtrn) { alert("good"); },
    error: function(req, msg, err) { alert("bad"); }
}); 
```

[这篇文章](http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/)是我知识的根源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-11T18:04:21.837

我认为您正在寻找 WebInvoke 或 WebGet 属性，它可以让您指定 Uri 模板、正文样式、请求和响应格式，例如：

```
[WebGet(ResponseFormat= WebMessageFormat.Json)] 
```

[此](http://msdn.microsoft.com/en-us/library/system.servicemodel.web.webgetattribute.aspx)链接可能会有所帮助。WebInvoke 有一篇类似的文章（主要用于发布）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-29T09:55:41.990

如果您在 IE 中对此进行测试，请尝试从您的 contentType 属性中删除字符集声明（即它应该如下所示：

```
contentType: "application/json", 
```

`charset=UTF-8`我还没有发现原因，但 IE 在使用 " " 部分进行 JSON 调用时似乎会变得扭曲。

![替代文字](https://www.hanselman.com/blog/content/binary/WindowsLiveWriter/IntroducingRockScroll_C29C/works-on-my-machine-starburst_3.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T06:04:17.143

不确定它是否会这么简单，但我正在使用 jQuery 从我的 Web 方法中回调 JSON。

我看到的主要区别是类的属性

> [System.Web.Script.Services.ScriptService]

```
 [WebService(Namespace = "http://MyNameSpace")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.Web.Script.Services.ScriptService]
    public class Web : System.Web.Services.WebService{

       [WebMethod]
       public string TestMethod(){
         return "Testing";
       }

    } 
```

我必须假设您使用的是 3.5 框架，因为这是公开 JSON Web 方法的唯一方法。

我的 jQuery 调用看起来几乎相同，所以没有问题。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-25T18:28:34.153

看起来您必须在 scriptMethod 标记中指定 json 作为响应格式。这是来自 vb.net，但我相信你明白了：

ResponseFormat:=ResponseFormat.Json

# design-patterns - 枚举与配置文件

> ID：900235
> 
> 赞同：0
> 
> 时间：2009-05-22T22:19:00.653
> 
> 标签：design-patterns

我们希望基于表中的记录来实现业务逻辑。我们有两个选择。

一种方法是在代码中为表中的每条记录创建一个枚举，并在代码中将枚举与读取的记录进行比较以确定接下来的逻辑。该系统的一个缺点是，如果表中的键发生变化（例如在自动编号字段中），则需要重新编译应用程序以反映变化。

第二种方法是将变量存储在配置文件中，用于表中的每条记录，并在代码中将配置变量与读取的记录进行比较，以确定接下来的逻辑。这个系统的一个缺点是配置文件可以被操纵并且应用程序将停止工作。

解决这个问题的最佳编程模式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T22:23:06.370

为什么不将它们放在一起并在数据库中放置一个表来告诉您接下来是哪个业务记录表？

抱歉，我无法给出更好的答案。我需要更多关于你的业务逻辑试图做什么的信息，以及这些记录的顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T22:25:29.767

我赞成你的第一种方法。如果逻辑发生了足够的变化，需要更改您的自动编号字段（通过删除旧记录或添加新记录），您将不得不更改代码以反映新的范例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T22:34:24.053

枚举应该是静态且不变的。如果您有一个需要更改枚举的解决方案，那么枚举是错误的解决方案。

外部配置确实会遇到您提到的问题，因此它也不总是一个好的选择。为了解决这个问题，您可以对其进行加密，使其不易修改。

另一种选择是创建一个资源 dll，将配置文件作为资源，因此不容易修改。当您确实需要进行更改时，您只需编译资源 dll 并仅部署它而不是整个应用程序。

Scott Langham 提到在您的数据库中使用配置表。这也是个好主意。这可能与您的设置？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-25T04:38:22.610

这听起来像状态模式。我想你有一个表，它存储状态（ID、名称）和与应用程序中每个状态相关联的逻辑。给定一个状态 ID，给定您必须执行的逻辑。您必须解决如何实例化正确的状态，如果您使用的是 ORM，您可以使用鉴别器（在这种情况下为状态 ID）。

# c++ - C++项目源代码布局

> ID：900240
> 
> 赞同：8
> 
> 时间：2009-05-22T22:20:21.040
> 
> 标签：c++, version-control, directory-structure, code-organization, project-organization

组织项目目录的一种流行方式或多或少是这样的：

```
我的库
     +--mylib_class_a.h
        mylib_class_a.cpp
        mylib_library_private_helpers.h
        mylib_library_private_helpers.cpp

我的应用
     +--other_class.h
        other_class.cpp
        应用程序.cpp

```

`app.cpp`：

```
#include "other_class.h"
#include <mylib_class_a.h> // using library MyLib 
```

同一个库的所有`.h`和`.cpp`文件都在同一个目录中。为避免名称冲突，文件名通常以公司名称和/或库名称作为前缀。MyLib 将位于 MyApp 的头文件搜索路径等中。我不喜欢为文件名添加前缀，但我喜欢查看`#include`并确切知道该头文件所属位置的想法。我不讨厌这种组织文件的方法，但我认为应该有更好的方法。

由于我正在开始一个新项目，因此我想征求一些目录组织的想法。目前我喜欢这个目录结构：

```
项目
    +--包括
             +--项目
                    +--mylib
                           +--class_a.h
                    +--应用程序
                           +--other_class.h
    +--src
         +--mylib
                +--class_a.cpp
                   library_private_helpers.h
                   library_private_helpers.cpp
         +--应用程序
              +--other_class.cpp
                 应用程序.cpp
                 实用程序.h

```

`app.cpp`：

```
#include "util.h" // private util.h file
#include <ProjA/app/other_class.h> // public header file
#include <ProjA/mylib/class_a.h> // using class_a.h of mylib
#include <other3rdptylib/class_a.h> // class_a.h of other3rdptylib, no name collision
#include <class_a.h> // not ProjA/mylib/class_a.h
#include <ProjA/mylib/library_private_helpers.h> // error can't find .h 
```

`.cpp`文件和私有（仅对直接库可见）`.h`文件存储在 src 目录下（src 有时称为 lib）。公共头文件被组织成一个 project/lib 目录结构，并通过`<ProjectName/LibraryName/headerName.h>`. 文件名没有任何前缀。如果我需要打包 MyLib 以供其他团队使用，我可以简单地更改我的 makefile 以复制适当的二进制文件和整个 include/ProjA 目录。

一旦文件被检入源代码控制并且人们开始处理它们，就很难更改目录结构。最好一开始就做好。

任何有组织这样的源代码经验的人？你有什么不喜欢的吗？如果你有更好的方法，我很想听听。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T22:33:35.957

好吧，这一切都取决于这些项目有多大。如果您只有几个文件，则将它们全部放在一个文件夹中。

在我看来，当您没有太多要管理的文件时，太多的文件夹是矫枉过正的。当您只有几个文件时，在文件夹中挖掘和挖掘会很烦人。

此外，这取决于谁在使用这些东西。如果您正在编写一个库并且它将被其他程序员使用，那么最好将他们想要使用的头文件组织到一个包含文件夹中。如果您正在创建多个库并将它们全部发布，那么您的结构可能会起作用。但是，如果它们是独立的库，并且开发不是一起完成的，并且它们在不同时间进行版本化和发布，那么您最好坚持将一个项目的所有文件都放在一个文件夹中。

事实上，我会说将所有内容都保存在一个文件夹中，直到您发现它无法管理，然后重新组织成一个聪明的方案，将源文件分成文件夹，就像您所做的那样。您可能会知道如何根据遇到的问题来组织它。

KISS 通常是编程中的解决方案 -> 让一切尽可能简单。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T22:41:35.037

为什么不做第一个类似的事情，只使用`MyLib`包含指令的一部分的目录，这减少了愚蠢的前缀：

```
#include <MyLib/ClassA.h> 
```

这告诉你他们来自哪里。至于第二个选择，当我打开一个头文件或源文件时，我个人非常恼火，并且必须在目录结构中导航才能找到另一个并打开它。对于您的第二个示例，如果您已经`src/mylib/class_a.cpp`打开并想要编辑标题，在许多编辑器中您必须返回两个级别，然后`include/ProjA`在找到标题之前进入。我们怎么知道标题在`ProjA`没有其他外部线索的子目录？另外，一个文件或另一个文件很容易被移动到“更好”代表其使用方式的不同位置，而无需移动备用文件。当我在工作中遇到它时，它只会让我头疼（而且我们的代码库确实有一些部分，人们在那里解决了我刚刚提到的所有潜在问题）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T22:28:15.953

这两种方法我都试过了。就个人而言，我更喜欢第一个。我理解将所有内容放在更具体的目录中的冲动，但这会导致很多过度复杂化。

我通常使用这条规则：应用程序和内部库使用第一种方法。公共开源库使用第二种方法。当您发布代码时，如果包含文件位于单独的目录中，这将有很大帮助。

# javascript - 在 AJAX 响应处理程序中关闭 Firefox 2 中的弹出窗口

> ID：900241
> 
> 赞同：0
> 
> 时间：2009-05-22T22:20:29.823
> 
> 标签：javascript, ajax, firefox

给定以下流程：

1) 用户点击一个链接，打开一个弹出窗口。2）用户做了一些事情，点击一个按钮来保存更改。3) 使用 AJAX，一些数据被 POST。4) 在 AJAX 响应处理程序中，关闭弹出窗口并刷新主窗口。

FireFox 2 中存在一个问题，在响应处理程序中关闭弹出窗口失败（直到在窗口上执行某些用户活动，例如鼠标移动）。

```
Sample code (popup window only):

function ajax_cb()
{
    window.close();
}

// Send a POST request, ajax_cb will be called when readystate == 4.
function test_ajax_close()
{
    Request.sendPOST("file:///test.html", "", ajax_cb);
} 
```

在上面的示例中，窗口最终会关闭，但首先需要用户交互。根据此[链接](http://www.htmlbugs.com/archives/6-Firefox-+-AJAX-requests-+-window.close.html)：

> 如果 Firefox 仍然有一个打开的套接字执行异步 AJAX 请求并且您尝试执行 window.close()，它会不高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T01:45:00.207

只需在短暂的超时内结束您的收盘即可..

```
setTimeout(window.close, 100); 
```

应该有足够的时间让套接字完成关闭，并且 poopup 可以自行关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T22:23:10.660

我想出的一种解决方案是在外部轮询一些变量并在它发生变化时关闭窗口。我正在寻找更好的解决方案，但示例代码是：

```
var response_received = 0;

function ajax_cb()
{
    response_received = 1;
}

function monitor_response()
{
    if (response_received)
    {
        self.close();
        return;
    }

    setTimeout("monitor_response()", 100);
}

function test_ajax_close()
{
    Request.sendPOST("file:///test.html", "", ajax_cb);
    monitor_response();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T22:43:23.847

我不会为此使用常规窗口。我会在 div 中使用 Iframe，模拟一个窗口，完全控制它。

# java - XML 序列化真的与 XML 数据绑定不同吗？如果是，又如何？

> ID：900244
> 
> 赞同：2
> 
> 时间：2009-05-22T22:20:47.950
> 
> 标签：java, xml, xml-serialization

有一个相关的问题[什么是首选的 Java XML 绑定框架？](https://stackoverflow.com/questions/205749/java-xml-binding)

在目前排名第二的答案中，发帖人区分了 XML 序列化和 Java/XML 数据绑定。据我所知，XML 数据绑定意味着“从 XML 文档创建内存对象图”。XML 序列化意味着“从内存中的对象图创建 XML 文档”。

我看不出他们有什么不同，只是对同一个问题有不同的看法。

争论是数据绑定的重点是对象模型，而序列化的重点是文档格式。我根本不这么认为。如果要将对象图序列化为 XML，可能会关心格式——它需要可读、可工具、可验证。（如果格式无关紧要，那么为什么不直接使用二进制序列化并完成它呢？）另一方面，在执行“数据绑定”（我称之为*反序列化*）时，必须平衡强调两者文档格式和对象模型。

那么问题来了：*Java/XML 数据绑定*和*XML 序列化*
之间有什么区别值得担心吗？

 *** * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-01T03:42:59.950

不，正如您提到的，这里有一个非常重要的**概念差异。**可能是实现具有很强的相似性，这可能会导致混淆，但从概念上讲并不是那么不清楚。

数据绑定意味着将 Java 对象绑定到非对象内容（ORM、xml 或 json 文档等的关系数据）；不同的表示（POJO、关系/分层数据）同样重要。数据绑定必须关注其支持的数据格式的细节；一些特性在 Java POJO 中没有等效的构造（例如：XML 混合内容、注释、处理指令、属性和元素之间的差异）。数据绑定侧重于尝试弥合阻抗：允许在表示之间尽可能无缝转换，并且在两个方向上。

使用对象序列化，您以（Java）对象开始和结束——其他格式是次要的，仅用于传递对象的目的。他们可以在所使用的数据格式中硬编码确切的结构；但即使没有，也要限制可以使用的结构种类。对象序列化必须处理对象特有的事情：身份、引用、循环处理；数据绑定器可以忽略的事情。

但这里可能会造成混淆：一般来说，对象序列化库（如 XStream）为自定义外部格式提供了很大的灵活性（即使它不如对象重要）。您当然可以使用数据绑定工具作为纯对象序列化工具的替代品——在许多/大多数情况下，它们工作得很好。因此，您确实可以将工具用于“次要目的”。但是有一些限制，具体取决于您需要的确切功能集：许多数据绑定工具无法处理循环引用；对象序列化程序不能支持但子集 xml 等等。即使在您可以使用辅助工具的地方，您最好还是选择不同的工具，以考虑易用性或性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T23:47:52.360

在许多情况下，区别很小。您的问题的答案是：这取决于您的用例。例如，请参阅 Wikipedia 的[XML Data Binding](http://en.wikipedia.org/wiki/XML_data_binding)条目，该条目以：

> XML 数据绑定是指将 XML 文档中的信息表示为计算机内存中的对象的过程。

相比之下，请参阅[XStream](http://xstream.codehaus.org/)页面，它是一个序列化框架：

> XStream 是一个简单的库，用于将对象序列化为 XML 并再次返回。

因此，对于 XML 数据绑定，XML 格式是“主要”格式，即具有显式定义的数据版本。（通常是 XSD。）Java（或 C# 或 ...）对象是 XML 的表示。但是，对于序列化，对象是定义，是“主要”格式，而 XML 表示是次要的。

基本上，当您有两种格式的相同数据时——一种是您选择的语言中的对象，另一种是 XML 表示形式——对于大多数用途，这两种格式中的一种将是主要的，而另一种将是次要的。当 XML 格式是主要格式时，您谈论的是 XML 数据绑定。当对象是主要的时，您正在谈论序列化。

对于序列化，为什么使用 XML 而不是二进制格式？好吧，数据的 XML 格式更有可能是人类可读的，更有可能处理对对象的更改（例如，添加一个新字段），在移动序列化对象时不太可能遇到编码问题具有不同字节顺序的机器之间，等等。XML 以一种已知且易于理解的方式构建，并且 XML 在处理新字段和新元素方面具有高度的灵活性。二进制格式通常是本地开发的，并且对于您的序列化格式的未来更改可能会或可能不会脆弱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T22:53:47.227

XStream 等库提供 XML 序列化（而不是 XML 文档处理），因此对象图可以使用标准 Java 序列化语义来保存/恢复。

序列化的表单可能不是您希望在 java 环境之外使用的文档，因为它可能嵌入了 java 类名（尽管您可以使用别名进行更改）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T17:41:39.890

感谢所有的投入。考虑到这一切，我仍然觉得这种区别是人为的。基本的？中学？它给人的感觉是主观的、模糊的、武断的和人为的。这告诉我没有有意义的区别。

# c# - 如何编程跨共享监视器的视频演示延迟？

> ID：900251
> 
> 赞同：1
> 
> 时间：2009-05-22T22:22:55.527
> 
> 标签：c#, wpf, winforms, video

我正在寻找一种体面的程序化方法来传递“乘坐面包车”的错觉。以下是概要：

我有一个朋友在旧金山开了一家酒吧，房间内部设计得像一辆面包车的内部（想象一下*史酷比神秘机器*的内部）。设置在墙上的是“窗户”，这些窗户后面是显示器。有两台服务器（用于左侧和右侧）从预先录制的车辆在路上行驶的镜头中提供同步演示。

目前，屏幕在共享工作区中分割，因此背景中的项目从右向左移动，运动的印象是完美的。但是，一旦您将屏幕移开，空的“墙壁空间”就不会出现延迟，或者当对象从一个屏幕穿过墙中的空间到下一个屏幕时，人们会期望感知到的自然延迟。

**在这种情况下，我是否可以采用托管代码方法来构建一个可能需要时间延迟参数来在监视器之间传递内容的项目？**或者是否有一个现成的程序也可以做到这一点？

**编辑：**

**我真正想要的是关于如何编程的建议：我可以加载一个 Windows 媒体文件并将其流式传输到单独线程上的单独监视器，并稍有延迟吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T23:10:49.097

当然，您只需要分别在两台显示器上播放并延迟其中一个视频。

# arrays - 如何在 XSLT 中声明和迭代数组？

> ID：900261
> 
> 赞同：11
> 
> 时间：2009-05-22T22:27:08.157
> 
> 标签：arrays, xslt, drop-down-menu, iteration

我的要求是 - 使用 XSLT - 显示美国各州的下拉列表，并在将使用我的样式表的 XML 中声明的特定对象上*打印“已选择”。*

我正在考虑用状态声明一个数组并对其进行迭代，但我不知道该怎么做。

注意：欢迎更多想法；）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-22T23:00:30.710

一种方法是将状态数据嵌入样式表本身，并使用 访问样式表文档`document('')`，如下所示：

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:my="whatever"
  exclude-result-prefixes="my">

  <xsl:output indent="yes"/>

  <!-- The value of the state you want to select, supplied in the input XML -->
  <xsl:variable name="selected-state" select="/xpath/to/state/value"/>

  <!-- You have to use a namespace, or the XSLT processor will complain -->
  <my:states>
    <option>Alabama</option>
    <option>Alaska</option>
    <!-- ... -->
    <option>Wisconsin</option>
    <option>Wyoming</option>
  </my:states>

  <xsl:template match="/">
    <!-- rest of HTML -->
    <select name="state">
      <!-- Access the embedded document as an internal "config" file -->
      <xsl:apply-templates select="document('')/*/my:states/option"/>
    </select>
    <!-- rest of HTML -->
  </xsl:template>

          <!-- Copy each option -->
          <xsl:template match="option">
            <xsl:copy>
              <!-- Add selected="selected" if this is the one -->
              <xsl:if test=". = $selected-state">
                <xsl:attribute name="selected">selected</xsl:attribute>
              </xsl:if>
              <xsl:value-of select="."/>
            </xsl:copy>
          </xsl:template>

</xsl:stylesheet> 
```

如果您有任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T22:34:31.823

理想情况下，您会将状态列表存储在 XML 文件中，然后使用 XSLT 对其进行迭代。

更新：如果您无法编辑 XML，您可以查看使用[文档功能](http://www.w3.org/TR/xslt#function-document)从第二个数据文件加载数据：

# c++ - 在 C++ 中初始化指针

> ID：900262
> 
> 赞同：14
> 
> 时间：2009-05-22T22:28:15.827
> 
> 标签：c++, pointers, initialization

可以在声明中分配指向值的指针吗？像这样的东西：

```
 int * p = &(1000) 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-22T22:33:50.577

是的，您可以在声明时初始化指向值的指针，但是您不能这样做：

```
int *p = &(1000); 
```

& 是运算符的**地址，**您不能将其应用于常量（尽管如果可以，那会很有趣）。尝试使用另一个变量：

```
int foo = 1000;
int *p = &foo; 
```

或类型转换：

```
int *p = (int *)(1000); // or reinterpret_cast<>/static_cast<>/etc 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-22T22:40:14.477

关于什么：

```
// Creates a pointer p to an integer initialized with value 1000.
int * p = new int(1000); 
```

测试和工作。;-)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-22T22:52:29.710

对我来说，这个问题有两点不清楚。你想将指针设置为一个特定的值（即地址），还是想让指针指向某个特定的变量？

在后一种情况下，您可以只使用地址运算符。然后将指针的*值*设置为的*地址*。`some_int_variable`

```
int *p = &some_int_variable;
*p = 10; // same as some_int_variable = 10; 
```

* * *

**注意**：接下来是手动更改指针的值。如果你不知道你是否想这样做，你就不想这样做。

在前一种情况下（即设置为某个特定的给定地址），您不能只做

```
int *p = 1000; 
```

由于编译器不会采用 int 并将其解释为地址。您必须告诉编译器它应该明确地这样做：

```
int *p = reinterpret_cast<int*>(1000); 
```

现在，指针将引用地址 1000 处的某个整数（希望如此）。请注意，结果是实现定义的。但是，这就是语义，这就是你告诉编译器它的方式。

**更新**：委员会修复`reinterpret_cast<T*>(0)`了注释中建议的奇怪行为，我之前为此提供了解决方法。[见这里](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#463)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T22:35:06.983

嗯。我认为您不能采用这样的常量的非常量地址。

但这有效：

```
int x = 3;
int *px = &x;
cout << *px; // prints 3 
```

或这个：

```
const int x = 3;
const int *px = &x;
const int *pfoo = reinterpret_cast<const int*>(47); 
```

# linq - 如何在 Linq lambda 表达式中“选择新”？

> ID：900264
> 
> 赞同：11
> 
> 时间：2009-05-22T22:28:53.270
> 
> 标签：linq, lambda

我如何在一份声明中做到这一点，而不是在两份声明中做到这一点？

```
 var newpeople= _rep.GetPeople().Where(p=>p.personID).Select(new KindoFPerson...id=p.id etc) 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-22T22:32:46.350

```
var newpeople= _rep.GetPeople().Where(p=>p.personID)
    .Select(p => new KindoFPerson...id=p.id etc) 
```

注意新的“ `p =>`”。

# php - 瓶颈在哪里？

> ID：900269
> 
> 赞同：0
> 
> 时间：2009-05-22T22:30:19.350
> 
> 标签：php, networking, ethernet

我有两台测试计算机联​​网在一起。

一个有千兆以太网，另一个有 10 兆。

理论上，两者之间传输的数据应该达到大约 1 兆字节 p/s。

现在我正在使用 PHP 脚本使用 fread 将数据从一台主机读取到另一台主机。读取文件和要读取的文件都是 chmod 777。

两台计算机都在运行 wampserver，并且都安装并运行了 zonealarm 和 avast。Zonealarm 被配置为将两台计算机识别为网络的受信任部分。

使用 time() 函数计算脚本读取另一个 comp 上的文件所需的时间。我正在读取的文件是 10 兆字节。它应该只需要 10 多秒。然而，它需要大约 30 秒。平均300kbs。

那么我的设置中的瓶颈在哪里？

一个comp是Vista，如果重要的话，另一个是XP。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T22:34:26.953

仅仅因为您的网络速度是 10Mb/sec 并不意味着应用层可以做到这一点。有 TCP/IP 标头信息（每 1500 字节数据包约 64 字节）、内核中处理缓冲区的时间、与 LAN 控制器芯片进行缓冲区传输所花费的时间等。

我想当你说你得到 300kbs 时，你的意思是 3mbs，对吧？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T22:33:32.043

虽然我们可以进行很多猜测，但这可能属于 serverfault，因为您没有在编程方面询问问题是什么，老实说，即使在那里，这也需要大量的试验和错误。不太适合提问/回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T22:34:03.523

打开任务管理器（ctrl+alt+delete，任务管理器），然后切换到第二个选项卡（或第三个？）并在运行测试时观察 CPU 和网络使用情况。如果 CPU 使用率为 100%，则可能是瓶颈。还要检查网络使用情况，看看是否有任何您不期望的开销。

那就是我要开始的地方。

# algorithm - 假设 P=NP 证明会是什么样子？

> ID：900273
> 
> 赞同：17
> 
> 时间：2009-05-22T22:31:58.037
> 
> 标签：algorithm, math, computer-science, complexity-theory, p-np

它是针对特定 NP 完全问题的多项式时间算法，还是只是证明存在 NP 完全问题解决方案的抽象推理？

似乎特定的算法更有帮助。有了它，我们要多项式解决一个 NP 问题，我们要做的就是将其转换为证明有解决方案的特定 NP 完全问题，我们就完成了。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-23T00:51:07.147

P = NP：“ [3SAT](http://en.wikipedia.org/wiki/Boolean_satisfiability_problem)问题是一个经典的 NP 完全问题。在这个证明中，我们展示了一种算法来解决它，它的渐近界为 (n^99 log log n)。首先我们......”

P != NP：“假设有一个针对[3SAT](http://en.wikipedia.org/wiki/Boolean_satisfiability_problem)问题的多项式算法。这意味着 .... 这意味着我们可以做到......然后......然后......这是不可能的。这一切都基于 3SAT 的多项式时间算法。因此 P != NP。

**更新**：也许类似于[这篇论文](http://www.scribd.com/doc/35539144/pnp12pt)（对于 P ！= NP）。

**更新 2**：[这是 Michael Sipser 为 P != NP 勾勒出证明的视频](http://www.youtube.com/watch?v=msp2y_Y5MLE#t=46m23s)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-22T22:49:21.887

叫我悲观，但它会是这样的：

...

∴, P ≠ NP

量子点

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-05-23T04:13:47.220

有一些关于 P=NP 或 P≠NP 证明看起来不像*的*[元结果。](http://en.wikipedia.org/wiki/P_%3D_NP_problem#Results_about_difficulty_of_proof)细节是相当技术性的，但众所周知证明不能

 **   [*relativizing*](http://en.wikipedia.org/wiki/Oracle_machine#Complexity_classes_of_oracle_machines)，这意味着证明必须使用所使用的图灵机的确切定义，因为进行了一些修改（“oracles”，例如添加到指令集中的非常强大的 CISC 指令）P = NP，并进行了一些其他修改, P≠NP。另请参阅[此博客文章](http://terrytao.wordpress.com/2009/08/01/pnp-relativisation-and-multiple-choice-exams/)，了解相对化的一个很好的解释。

*   [*自然*](http://en.wikipedia.org/wiki/Natural_proof)，几个经典[电路复杂性](http://en.wikipedia.org/wiki/Circuit_complexity)证明的属性，

*   或[*algebrizing*](http://scottaaronson.com/blog/?p=272)，相对化的概括。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-22T23:00:22.143

它可以采取证明假设 P ≠ NP 会导致矛盾的形式。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-22T23:03:24.057

它可能不会以直接的方式连接到 P 和 NP……现在许多定理都基于 P!=NP，因此证明一个假设的事实是不正确的会产生很大的不同。即使证明 TS 的恒定比率近似之类的东西也应该足够 IIRC。我认为，NPI（GI）和其他集合的存在也是基于 P！= NP，因此使它们中的任何一个等于 P 或 NP 可能会彻底改变这种情况。

恕我直言，现在一切都发生在一个非常抽象的层面上。如果有人证明了关于 P=/!=NP 的任何事情，则不必提及这些集合中的任何一个，甚至不必提及特定问题。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-22T23:14:44.987

可能是从 NP 问题简化为 P 问题的形式。请参阅有关[减少](http://en.wikipedia.org/wiki/Reduction_(complexity))的 Wikipedia 页面。

或者

就像Vinay Deolalikar 提出的这个[证明一样。](https://stackoverflow.com/questions/3436978/explain-the-proof-by-vinay-deolalikar-that-p-np)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-22T23:18:03.043

设置 N 等于乘法恒等式。那么 NP = P. QED。;-)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-23T16:13:14.403

最直接的方法是证明 NP-complete 类中的问题存在多项式时间解。这些是 NP 中的问题，可以简化为已知的 np 问题之一。这意味着您可以提供更快的算法来证明[斯蒂芬库克或许多其他人提出的原始问题，](http://portal.acm.org/citation.cfm?coll=GUIDE&dl=GUIDE&id=805047)这些问题也被证明是 NP 完全的。请参阅 Richard Karp 的[开创性论文](http://en.wikipedia.org/wiki/Karp%27s_21_NP-complete_problems)和[这本书](https://rads.stackoverflow.com/amzn/click/com/0716710455)更多有趣的问题。已经表明，如果你解决了其中一个问题，整个复杂性类别就会崩溃。编辑：我必须补充一点，我正在和正在研究量子计算的朋友交谈。虽然我不知道这意味着什么，但他说某个证明/实验？在量子世界中可以使整个复杂性类别，我的意思是整个事情，没有实际意义。如果这里有人对此有更多了解，请回复。

在没有给出正式算法的情况下，对该问题也进行了多次尝试。你可以试着数一数。有罗伯特/西摩证明。人们还尝试使用久经考验的对角化证明来解决它（也用于表明存在您永远无法解决的问题）。Razborov 还表明，如果存在某些单向函数，那么任何证据都无法给出解决方案。这意味着需要新技术来解决这个问题。

原论文发表至今已 38 年，至今仍无证据。不仅如此，数学家在复杂性类的概念出现之前提出的许多问题都被证明是 NP。因此，许多数学家和计算机科学家认为，其中一些问题是如此根本，以至于可能需要一种新的数学来解决这个问题。你必须记住，人类所能提供的最优秀的人才已经解决了这个问题，但没有任何成功。我认为至少需要几十年才能有人破解这个谜题。但即使存在多项式时间解，常数或指数也可能非常大，以至于在我们的问题中毫无用处。

有一个很好的调查可以回答你的大部分问题：[http](http://www.scottaaronson.com/papers/pnp.pdf) ://www.scottaaronson.com/papers/pnp.pdf 。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-22T22:36:10.930

当然，描述性证明是最有用的，但还有其他类型的证明：例如，可以提供“存在性证明”来证明**可以**在不找到答案的情况下找到答案（或者，有时甚至建议如何找到）那个答案。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-06-02T02:57:09.100

它可能看起来几乎完全像其中[之一](http://en.wikipedia.org/wiki/Mathematical_proof#Methods_of_proof)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-22T22:37:31.207

好问题; 它可以采取任何一种形式。显然，特定的算法会更有帮助，是的，但是没有确定这将是理论 P=NP 证明发生的方式。鉴于 NP 完全问题的性质以及它们的普遍性，似乎在解决这些问题上付出的努力比在解决等式的理论推理方面付出的努力更多，但这只是假设。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-27T00:52:52.660

任何 P=NP 确实不是的非建设性证明。这意味着以下显式 3-SAT 算法在多项式时间内运行：

> 枚举所有程序。**在第i**轮，运行所有编号小于**i**的程序一步。*如果程序以对公式的满意输入而*终止 ，则返回**true**。*如果程序以不存在此类输入的正式证明*终止，则返回 **false**。

如果 P=NP，那么存在一个运行在 O(poly(N)) 中的程序，如果存在这样的公式，则向公式输出一个令人满意的输入。

如果 P=coNP，则存在一个在 O(poly(N)) 中运行的程序，如果不存在公式，则输出不存在公式的正式证明。

如果 P=NP，那么由于 P 在补码 NP=coNP 下是封闭的。因此，存在一个在 O(poly(N)) 中运行并且两者都运行的程序。该程序是枚举中的第**k**个程序。**k 是 O(1)**！由于它在 O(poly(N)) 中运行，我们的蛮力模拟只需要

> k*O(聚(N))+O(聚(N))^2

一旦它到达有问题的程序，就会进行轮次。因此，蛮力模拟在多项式时间内运行！

（请注意，k 是程序大小的指数；这种方法实际上并不可行，但它表明很难做出 P=NP 的非建设性证明，即使是这种情况。）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-23T05:01:06.997

在某种程度上，这种证明需要具有的形式取决于您的哲学观点（=您认为正确的公理） - 例如，作为一个[建构](http://en.wikipedia.org/wiki/Constructivism_(mathematics))主义者，您会要求构建一个需要多项式时间来解决的实际算法一个NP完全问题。这可以通过使用归约来完成，但不能使用间接证明。无论如何，这似乎真的不太可能:)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-24T00:25:25.253

该证明将推断出与 NP 的至少一个元素（问题）不是 P 的元素的假设相矛盾。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-09-03T10:00:44.320

[与此有些相关的有趣读物](http://rjlipton.wordpress.com/2009/08/20/what-will-happen-when-pnp-is-proved/)

# c++ - 在 C++ 中从 Web 流中导入数据

> ID：900278
> 
> 赞同：2
> 
> 时间：2009-05-22T22:33:24.727
> 
> 标签：c++, stream, live

我想知道是否可以从网站的实时流中导入数据并实时对数据执行计算？如果这是可能的，那么最有效（计算速度快）的方法是什么？感谢您的任何帮助或评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T00:38:26.020

你可以使用[cURL](http://curl.haxx.se/)。每次新数据进入时，curl 句柄都可以调用一个函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T00:23:11.510

VideoLan.org 的 VLC 是一个免费的开源播放器，可以渲染几乎任何编解码器，并且可以处理几乎任何类型的流。这可能是您最好的起点，并且根据您正在做的事情，通过为该应用程序编写插件可能会更好地实现您的目标。不过，这是一个非常开放的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T07:31:43.843

您在谈论流式传输哪种类型的数据？也许[套接字编程](http://en.wikipedia.org/wiki/Berkeley_sockets)是您所需要的。

# dao - 多个服务层对象是否应该共享一个 DAO？

> ID：900279
> 
> 赞同：1
> 
> 时间：2009-05-22T22:33:29.827
> 
> 标签：dao, oop

我有一个包含 PortalAccount 对象的 Contact 类。当我想为联系人创建“门户帐户”时，使用soap/axis 在门户应用程序上远程创建一个帐户，然后填充联系人的portalAccount 并保存联系人（本地数据库保存有关远程帐户的信息，例如用户 ID 和用户名等）。

因此，我有一个服务类 PortalServiceImpl，它具有在给定 Contact 实例的情况下在远程门户上实际创建用户的方法。

鉴于所有这些信息，我的问题是：PortalServiceImpl 是否应该获取 ContactDAO 对象的实例并实际进行保存，或者 PortalServiceImpl 类是否应该只创建远程用户，修改传入的 Contact 对象，然后让客户端负责储蓄？

**方法一：**

```
class ServiceFacadeImpl {
  public void createPortalAccount(Contact contact) {
    // here the contact is implicitly saved
    this.portalService.createPortalAccount(contact);
  }
} 
```

**方法二：**

```
class ServiceFacadeImpl {
  public void createPortalAccount(Contact contact) {
    // here contact is implicitly modified
    this.portalService.createPortalAccount(contact);
    this.contactDAO.save(contact);
  }
} 
```

这两种方法对我来说都是错误的。方法 1 感觉不对，因为 PortalService 正在创建一个远程用户并将联系人保存到数据库中（尽管是通过 DAO 接口）。方法 2 感觉不对，因为我必须假设 PortalService 正在修改我传递给它的联系人。

我也有一种感觉，我没有看到其他一些问题，比如可能无法始终如一地处理交易。

（顺便说一句，我已经用过这两种方法了，不想在一个无休止的循环中继续重构。这里似乎有问题。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T00:26:49.333

您确定在本地和远程拥有不同的联系人 ID 是个好主意吗？这对我来说似乎是错误的，但也许我只是不知道您的域。

在我的应用程序中，所有新联系人都通过 Web 服务发送到远程门户并保存在那里。因此，当我在本地保存新联系人时，它会被发送到远程门户并保存在那里。也许你需要同样的？

如果上述想法对你来说是不可接受的，那么我会这样做：

```
class ServiceFacadeImpl {
  public void CreatePortalAccountAndSaveContact(Contact contact) {
    try
    {
      contact.portalAccount = this.portalService.createPortalAccount(contact);
      this.contactDAO.save(contact);
    }
    catch(...)
    {
      // do cleanup, for example do you need to delete account from remote 
      // portal if it couldn't be saved locally?
      // If yes, delete it from portal and set contact.portalAccount = null;
    }
  }
}
```

有人可能会说，CreatePortalAccountAndSaveContact 打破了单一责任原则，但在这种情况下，imo 是绝对正常的，因为据我了解，您需要此操作是原子的。对？

或者您可以在方法中添加布尔标志，指示您是否要保存联系人。但是，如果您总是需要在从远程门户获取联系人后直接保存与 PortalAccount 的联系 - 则不需要布尔标志。

PS。为什么使用“this”关键字？portalService 是私有成员吗？如果是，那么也许您需要重新考虑您的命名约定并使用前缀“_”命名私有成员（我认为这是最流行的），例如 _portalService - 那么很容易理解 _portalService 是私有成员。对不起题外话。

祝你好运。

# android - Android 1.5：阅读短信

> ID：900294
> 
> 赞同：7
> 
> 时间：2009-05-22T22:36:02.443
> 
> 标签：android, backup, sms

我正在为 Android 创建一个备份实用程序，我需要阅读收件箱、发件箱和 dratfs 的内容。如何在 SDK v1.5 上实现这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-23T23:14:12.307

有一个用于访问 SMS 消息的[内容提供程序](http://developer.android.com/guide/topics/providers/content-providers.html)，但它没有记录在公共 SDK 中。如果您与您[`ContentResolver.query()`](http://developer.android.com/reference/android/content/ContentResolver.html#query(android.net.Uri,%20java.lang.String[],%20java.lang.String,%20java.lang.String[],%20java.lang.String))中的一个人一起使用`Uri`，`content://sms`您应该能够访问这些消息。

[您可以在此 Google Groups 线程](http://groups.google.com/group/android-beginners/browse_thread/thread/2e049e79f88d95d5)或[stackoverflow 上的先前问题上](https://stackoverflow.com/search?q=android+sms)找到更多信息。

* * *

## 回答 #2

> 赞同：-11
> 
> 时间：2009-05-23T08:39:28.393

如果您可以打开到内部调制解调器的连接并运行[AT 命令](http://en.wikipedia.org/wiki/AT_command)（不确定这是如何完成的），那么您可以通过以下方式备份（去掉注释）：

```
AT+CSCS="UTF8"      // select character set
AT+CMEE=2           // turn on extended error reporting
AT+CPMS="ME","ME"   // select message storage in the phone
AT+CMGL=4           // read all messages
AT+CPMS="SM","SM"   // select message storage on SIM
AT+CMGL=4           // read all messages 
```

您当然应该在发出每个命令后等待 OK。有关命令的详细信息，请参阅[27.005](http://www.3gpp.org/ftp/Specs/html-info/27005.htm)和[27.007](http://www.3gpp.org/ftp/Specs/html-info/27007.htm)。

# asp.net-mvc - ASP.NET MVC 中的自定义绑定 - 更改单个字段的绑定行为

> ID：900298
> 
> 赞同：2
> 
> 时间：2009-05-22T22:36:24.453
> 
> 标签：asp.net-mvc, c#-3.0

我的数据库中有一个双精度浮点字段，存储午夜过后的秒数。我有 c# 中的代码，可以将此数字转换为 HH:MM:SS.ffffff 的形式，其中 f 是几分之一秒。我也有可以将其解析回双精度的代码。

我想做的是修改 ASP.NET MVC 中的库存活页夹对象，以便它使用 MY 解析和 ToString() 方法，而不是通常从 double 类型使用的方法，而无需编写完整的自定义活页夹。

我可以在 c# 中编写几个扩展方法，或者使用几个放置得当的属性来让 binder 对象知道我的解析和 ToString() 方法吗？

这里有更多的说明。

如果我向视图提供诸如 Linq to SQL 类之类的模型，则 MVC 可以自动将我的字段连接到底层数据模型，前提是我在视图中为控件使用与在数据模型中使用的名称相同的名称。如果我将 MVC 视图发布回控制器方法，我可以通过调用 Controller 类上的 UpdateModel 方法将用户的更改写回数据库。我不必担心将我的特定字段从 FormCollection 连接到我的 Linq to SQL 数据类，因为活页夹已经为我完成了这些。

我假设，为了让 binder 对普通数字 double 发挥这种魔力，它必须首先解析来自用户的输入（可能通过调用 double.parse），并将其传递给 Linq to SQL 类，以便它可以更新数据库。

对于模型中的一个字段，我需要使用我自己的自定义解析器，而不是双数据类型附带的解析器。我不想承担剩余领域的责任。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T23:47:40.113

这是一个天真的、快速和肮脏的例子，但如果你决定走模型绑定路线，试试类似的东西：

```
// This goes in global.asax
ControllerBuilder.Current.SetControllerFactory(new ControllerFactory());
ModelBinders.Binders.Add(typeof(CustomDateType), new CustomDateBinder()); 
```

……

```
public class CustomDateType
{
    public CustomDateType(string value)
    {
    }

    public string GetText()
    {
        // I do fancy stuff
        throw new NotImplementedException();
    }
    public decimal? GetValue()
    {
        // I do fancy stuff
        throw new NotImplementedException();
    }
}

public class CustomDateBinder : IModelBinder
{
    public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        try
        {
            string doubleDateValue = GetAttemptedValue(bindingContext);

            if (doubleDateValue == "")
            {
                return null;
            }

            return new CustomDateType(doubleDateValue);
        }
        catch (Exception ex)
        {
            string message = string.Format("Unable to locate a valid value for query string parameter '{0}'",
                                       bindingContext.ModelName);
            throw new ApplicationException(message, ex);
        }
    }

    private static string GetAttemptedValue(ModelBindingContext bindingContext)
    {
       ValueProviderResult value = bindingContext.ValueProvider[bindingContext.ModelName];
        return value == null ? string.Empty : value.AttemptedValue;
    }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T22:53:28.243

这个名字是绝对必要的`.ToString()`吗？例如，如果`.ToCustomString()`可以接受，这很容易：

```
public static class DoubleExtensions
{
    public static string ToCustomString(this double d)
    {
        return "my own";
    }
} 
```

# python - pywikipedia 名称 wikiquote 未定义？

> ID：900306
> 
> 赞同：1
> 
> 时间：2009-05-22T22:39:57.613
> 
> 标签：python, python-2.6, pywikibot

我正在为 Wikipedia 编写一个机器人，但有一个问题。当我想从另一个 Wikimedia 站点获取内容时，我收到错误 - 错误名称 'wikiquote' 未定义。

这是我像这样开始代码的时候-

```
import wikipedia

site = wikiquote.getSite() 
```

然而，如果我从编写维基百科而不是维基语录开始，它会起作用。据我所知，它应该可以在其他 Mediawiki 网站上使用？

帮助感激不尽！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T22:48:28.487

`wikiquote`没有在脚本的任何地方定义或导入。因此，您的代码不起作用是可以理解的。

根据[pywikipedia 的文档](http://meta.wikimedia.org/wiki/Wikipedia.py#Page_class.2C_site_class_and_wikipedia.stopme.28.29_function)，您需要改用它：

```
import wikipedia
site = wikipedia.getSite('en', 'wikiquote') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T23:12:48.717

如果您只是为自己运行它，那没关系，但 pywikipedia 机器人应该让用户控制他们运行的站点（以及使用的帐户）。`user-config.py`用户在文件中指定这些设置，如此[处](http://meta.wikimedia.org/wiki/Using_the_python_wikipediabot#Configuration_for_other_Wikimedia_wikis)所述。在这种情况下，他们会设置：

```
family = 'wikiquote' 
```

你的机器人应该处理哪个。您可以查看该`login.py`文件以查看如何使用这些配置设置的示例。

# c++ - 限制 cout 流？

> ID：900319
> 
> 赞同：4
> 
> 时间：2009-05-22T22:47:15.417
> 
> 标签：c++, windows, buffer, stdout

一个困扰我的谜题。在一些简单的测试工具代码中，如果我将太多字符流式传输到标准输出，程序就会失败。奇怪但非常可重复。这可能是 Windows 唯一的问题，但很容易看出：

```
#include <iostream>
#include <deque>

using namespace std;

int main() 
{
  deque<char> d;
  char c;

  while (cin.get(c)) d.push_back(c);

  for (deque<char>::reverse_iterator j = d.rbegin(); j != d.rend(); j++)
    cout << (*j);
} 
```

前面的代码只是从标准输入加载一个字符流并以相反的顺序输出它们。它适用于最多 100K 左右的字符，但对于较大的文件，在 Windows 中会因“错误写入标准输出”消息而死。它总是以相同的角色死去。像“cat bigfile.txt | reverse.exe”这样的 shell 命令就是重现问题所需要的。MSFT 和 Intel 编译器的行为都类似。

我意识到标准输出上可能有一个缓冲区，但是当它被填充时不应该自动刷新吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T23:15:32.253

您可以尝试强制缓冲区以这种方式刷新其内容：

```
cout << (*j) << std::flush; 
```

否则`std::endl`也可以，但也提供和行尾（我想你不想要吗？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T22:56:39.500

这里没有这样的问题：

```
C:\Temp> cl
Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 15.00.21022.08 for 80x86 
```

编辑：**更多信息**

我通过编译您发布的程序对此进行了测试。我创建了一个包含 0123456789 的文件，重复了 100,000 次（使其大小为 1,000,000 字节）。然后，我跑了

```
C:\Temp> t.exe < test.in 
```

也

```
C:\Temp> cat test.in | t.exe 
```

和

```
C:\Temp> t.exe < test.in > test.out 
```

没有问题。等待 1,000,000 个字符滚动确实需要相当长的时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T08:42:45.603

问题可能是管道运算符（|）而不是“cat”。Windows 命令解释器[1] 没有真正的管道（如 Unix）并使用临时文件模拟它们。您可能会用完磁盘空间或溢出命令解释器中的某些缓冲区。

您可以尝试“键入 bigfile.txt | reverse.exe”，看看是否得到相同的结果。

[1] 至少旧版本没有真正的管道。我没看过最新版本。有趣的是，Michael Burr 无法在 Vista x64 上重现它。也许MS已经解决了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T22:57:48.983

您可以在每次循环迭代期间或每 100 次迭代期间睡一小段时间吗？这将使操作系统有机会刷新缓冲区。

我不知道在 c++ 中执行此操作的命令是什么，但在 c# 中它是

```
System.Threading.Sleep(10); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T00:55:27.200

感谢所有的建议，尤其是迈克尔·伯尔，他正确地推测了 cat 命令而不是 reverse.exe 可能会失败！就是这样...... reverse.exe < bigfile.txt 工作正常，但 cat bigfile.txt | reverse.exe 因“写入标准输出错误”而失败。现在为什么 CAT 会失败也是一个谜，但至少现在它与代码无关。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T16:52:07.820

如果您尝试在 win32 上向标准输出写入特殊字符，我之前就遇到过这个问题。您的测试数据中有这样的字符吗？

# c++ - 如何在 C++ 中优雅地格式化字符串，使其四舍五入到小数点后 6 位，并修剪额外的 '0' 或 '9'

> ID：900326
> 
> 赞同：2
> 
> 时间：2009-05-22T22:51:32.583
> 
> 标签：c++, string, formatting, string-formatting

如何编写一个函数来格式化带有小数位的字符串，而不用尾随 0 或不必要的 9？鉴于小数是 2，这就是我所期望的：

```
0.999 -> 1.0
0.99 -> 0.99
1.01 -> 1.01
1.001 -> 1.0
123 -> 123.0
0 -> 0.0
0.1 -> 0.1 
```

（如你所料的负面）

这是我到目前为止所拥有的，但它是非常丑陋的代码。有没有更好的方法来做到这一点？

```
string toStrMaxDecimals(double value, uint decimals) {
    value *= pow(10, decimals);
    value = round(value);
    value *= pow(0.1, decimals);
    string temp = boost::lexical_cast<string>(value); 
    size_t dot = temp.find('.');
    if (dot != string::npos) {
        if (temp.size() > dot + decimals + 1)
            temp.erase(dot + decimals + 1);
        if (*temp.rbegin() == '0')
            temp.erase(temp.find_last_not_of("0") + 1);
        if (*temp.rbegin() == '.')
            temp.append("0");
    } else {
        temp.append(".0");
    }
    return temp;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T23:28:32.073

```
std::string toStrMaxDecimals(double value, int decimals)
{
    std::ostringstream ss;
    ss << std::fixed << std::setprecision(decimals) << value;
    std::string s = ss.str();
    if(decimals > 0 && s[s.find_last_not_of('0')] == '.') {
        s.erase(s.size() - decimals + 1);
    }
    return s;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-23T00:11:20.923

sprintf 将比 C++ 流更容易、更具可读性和更高的性能。你不需要自己做任何舍入或修剪。Sprintf 有这方面的标志。你可能想要类似的东西

```
sprintf(targetBuffer, "%.2g", floatingPointValue); 
```

Sprintf 在 Java 中进行四舍五入，我很确定它在 C++ 中也是如此。

编辑：

对不起，我写的示例代码是为了你的例子。对于您的原始问题，将 %.2g 更改为 %.6g

编辑：

将 f 更改为 g 以抑制尾随零。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T22:58:43.787

您是否考虑过使用普通的旧 sprintf 进行格式化？

它不会完全满足您的需要，但是如果您四舍五入到百分之一，然后将数字 sprintf 为 %f （用于浮点数）或 %lf （用于双浮点数）。

要四舍五入到第 100 位，您可以执行
num = num + ((int)(num-((int)num))*100)/100;

# jsp - 为什么 JSP 2.0 标记文件不能有“JSP”的正文内容？

> ID：900331
> 
> 赞同：2
> 
> 时间：2009-05-22T22:53:07.540
> 
> 标签：jsp, tags, jsp-tags

“新的”JSP 2.0 标记文件标记非常有用，并且在大多数情况下（至少我见过）它们提供了比 Java 类更易读的格式。然而，虽然标记文件*几乎*可以完成Java 类标记可以做的所有事情，但有一件大事是它们无法做到的：具有“脚本”正文内容（即，开始和结束标记之间的“<%”内容）。

所以，我的问题是多方面的：

1.  有谁知道为什么（从设计的角度）这是？由于它们的实现方式或其他原因，标签文件是否天生就不可能具有此类内容？
2.  有谁知道是否有任何未来计划允许在标记文件中使用 body-content="JSP" （可能在 JSP 标准的未来版本中）？
3.  有谁知道“破解”标记文件以允许它们具有脚本内容的任何方法（例如通过具有无脚本的正文内容，然后以某种方式处理内容）？

基本上我的梦想是有一天编写标签文件，如果有人放一个不会导致异常的标签文件

`<%= myVar %>`

在里面，我只是想确定那个梦想是否无望。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T06:10:30.927

JSP 标记是这样设计的，以便在表示层和后面的代码之间完全分离关注点。JSP 页面应该由设计人员编辑，因此不适合使用 Java 代码。

我想你需要在这种哲学中调整你的编码习惯。您可以将所有 Java 代码移动到 bean。在那里做任何需要的事情，然后将适当的 bean 传递给 JSP 页面。异常处理也应该去那里。如果这还不够，您可以随时创建自己的标签来使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T23:41:27.537

如果您使用旧式标签（即从 BodyTag 派生），它们可以。然而，SimpleTag 实现不能。

> 因为 JSP 片段不支持 scriptlet，所以**SimpleTag**的不能是“JSP”

如果可以的话，我个人会避免使用 Java 来编写标签，而只使用新的 .tag 样式。您可以将 Java 代码合并到此类标记文件中，但通常如果您被迫这样做，您可能做错了什么。

# iphone - 为什么 iPhone SDK 对某些代表使用类别而不是协议？

> ID：900335
> 
> 赞同：9
> 
> 时间：2009-05-22T22:53:59.817
> 
> 标签：iphone, objective-c, delegates, protocols, categories

我的理解是，协议就像其他语言中的接口——它们声明了预期的方法——而类别允许您向现有类型添加新方法（甚至可能是您不拥有的类型。）

那么，为什么 iPhone SDK 有时会使用类别来声明委托类型？通常，我希望所有代表都输入 id<MyDelegateProtocol> 但有很多示例并非如此。

例如，参见 NSURLConnection。它的委托类型为“id”，并且“合同”被声明为 NSObject (NSURLConnectionDelegate) 上的一个类别。

那么：在这些情况下使用类别的动机是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-22T22:59:56.200

Objective-C 2.0 引入了@optional 协议指令，允许您将某些协议方法声明为可选的。在 Obj-C 2.0 之前，类别用于允许可选的委托方法（特别是 NSObject 上的类别，称为*非正式协议*）。

我的猜测是，iPhone SDK 中使用的大多数类别而不是协议是对等 Mac 类的保留。例如，`NSURLConnection`存在于 Mac 和 iPhone SDK 中，因此代码可能是共享的。由于 Apple 尚未更改所有 Mac 类以使用正式协议，因此我们留下了一些不一致的地方。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T23:00:30.943

直到随着 OS X 10.5 和 iPhone SDK 推出的 Objective-C 修订版，称为“Objective-C 2.0”，人们只能通过使用类别来制作可选协议。在 Objective-C 2.0 中，在协议中添加了一个新的 @optional 关键字来标记哪些方法是可选的（其余的是隐式需要的）。

因此，我认为您看到的是 @optional 关键字之前的早期版本的轻微保留。

编辑：回答原始问题中出现的后续问题：将 NSObject/id 上的类别用于非正式协议的动机部分是记录和分组对象可能在其数据源（或委托或其他）中调用的方法, 并在较小程度上避免编译器警告您正在调用编译器不知道的方法将出现在接收调用的对象中。想象一下自己是实现调用这些数据源方法的类的人——当你有兴趣调用 my :datasource:method: 对象 obj 上的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T02:07:20.487

这是来自objective-c 1.0 的遗产，它没有“可选协议方法”。

# php - 最佳数据库（MySQL）结构：包含喜欢标签的文章

> ID：900337
> 
> 赞同：3
> 
> 时间：2009-05-22T22:55:41.123
> 
> 标签：php, mysql, tags, tagging

我建立了一个新闻网站： - 文章按日期排序显示在首页上。先上最新的。- 新闻在“新闻”表中，包含“id”、“title”、“text”和其他一些字段。- 所有文章都标有 1-5 个相关标签。- 标签位于“标签”表中，其中包含“id”、“标签”、“文章”和其他一些字段。- “标签”的“文章”字段适合“新闻”的“id”字段。

现在我想让用户有机会将标签添加到他的“喜欢的标签列表”中。然后用户应该只看到包含喜欢的标签之一的新闻文章。

假设用户 Bob 喜欢标签“barack obama”、“nba”、“new jersey”和“dogs”。他应该只看到至少包含这四个标签之一的文章。

我如何编写实现此目的的 PHP/MySQL 脚本？我认为我的数据库结构不足以满足此目的，是吗？我将不得不像这样进行数据库查询：

“SELECT * FROM news WHERE id IN (SELECT article FROM tags WHERE tag IN ('barack obama', 'nba', 'new jersey', 'dogs'))”

这个查询会运行很长时间，不是吗？必须有一个比我的更合适的数据库结构。你对这个问题有想法吗？我需要哪种数据库结构以及我必须使用哪些查询？

我希望你能帮助我。提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T23:13:37.500

以下内容绝不是详尽/明确的，但它应该让您朝着正确的方向前进。

# 表：

```
news
=====
id
title
text

tag
===
id
tag

tag_map
=======
tag_id
news_id

favorite_tags
=============
user_id
tag_id 
```

# 询问

```
SELECT * 
FROM favorite_tags
JOIN tag_map ON favorite_tags.tag_id = tag_map.tag_id
JOIN news ON tag_map.news_id = news.id
WHERE favorite_tags.user_id = $userid 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T04:57:02.930

查询的性能（无论是在您的子选择方法中，还是在 Frank Farmer 更优雅的基于联接的方法中）将主要取决于索引。请记住，MySQL 每个表只使用一个索引，并且正确的索引集（取决于您要优化的查询）总是变得非常明显......

# c++ - 为什么我不能使用 strerror？

> ID：900338
> 
> 赞同：35
> 
> 时间：2009-05-22T22:56:08.410
> 
> 标签：c++, c, deprecated

我正在将一些代码移植到 Windows，Microsoft 编译器 (Visual C++ 8) 告诉我这`strerror()`是不安全的。

撇开微软提供的所有安全字符串中的烦恼因素不谈，我实际上可以看到一些已弃用的函数是危险的。但我不明白有什么问题`strerror()`。它接受一个代码 ( `int`)，并返回相应的字符串，如果该代码未知，则返回空字符串。

危险在哪里？

C中有一个好的选择吗？

C++ 中有没有好的替代方案？

[编辑]

得到了一些好的答案，现在明白了一些实现可能足够疯狂，以至于实际写入一个公共共享缓冲区——在单线程内重入是不安全的，更不用说线程之间了！- 我的问题不再是“为什么我不能使用它，还有什么替代方案？” 到“C 和/或 C++ 中是否有任何体面、简洁的替代方案？”

提前致谢

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-22T23:02:43.433

`strerror`已弃用，因为它不是线程安全的。`strerror`在内部静态缓冲区上工作，该缓冲区可能会被其他并发线程覆盖。您应该使用一个名为`strerror_s`.

安全变体要求将缓冲区大小传递给函数，以便在写入之前验证缓冲区是否足够大，这有助于避免可能导致恶意代码执行的缓冲区溢出。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-22T23:27:21.433

`strerror`本身并不是不安全的。在线程之前的过去，这根本不是问题。使用线程，两个或更多线程可以调用`strerror`使返回的缓冲区处于未定义状态。对于单线程程序，`strerror`除非他们在 libc 中玩一些奇怪的游戏，例如 DLL 中所有应用程序的公共内存，否则使用它应该没有什么坏处。

为了解决这个问题，有一个相同功能的新接口：

```
int strerror_r(int errnum, char *buf, size_t buflen); 
```

请注意，调用者提供缓冲区空间和缓冲区大小。这解决了这个问题。即使对于单线程应用程序，您也不妨使用它。它不会有一点伤害，你不妨习惯以更安全的方式来做。

注意：上面的原型来自 POSIX 规范[`strerror_r()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/strerror_r.html)。它可能因平台或编译器选项或`#define`符号而异。例如，GNU 根据`#define`.

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-23T10:59:52.463

> 得到了一些好的答案，现在明白了一些实现可能足够疯狂，以至于实际写入一个公共共享缓冲区——在单线程内重入是不安全的，更不用说线程之间了！- 我的问题不再是“为什么我不能使用它，还有什么替代方案？” 到“C 和/或 C++ 中是否有任何体面、简洁的替代方案？”

Posix 指定`strerror_r()`, 并且您可以在 Windows 上使用`strerror_s()`，这有点不同但具有相同的目标。我这样做：

```
#define BAS_PERROR(msg, err_code)\
  bas_perror(msg, err_code, __FILE__, __LINE__)

void bas_perror (const char* msg, int err_code, const char* filename,
                 unsigned long line_number);

void
bas_perror (const char* usr_msg, int err_code, const char* filename,
            unsigned long line_number)
{
  char sys_msg[64];

#ifdef _WIN32
  if ( strerror_s(sys_msg, sizeof sys_msg, err_code) != 0 )
  {
    strncpy(sys_msg, "Unknown error", taille);
    sys_msg[sizeof sys_msg - 1] = '\0';
  }
#else
  if ( strerror_r(err_code, sys_msg, sizeof sys_msg) != 0 )
  {
    strncpy(sys_msg, "Unknown error", sizeof sys_msg);
    sys_msg[sizeof sys_msg - 1] = '\0';
  }
#endif

  fprintf(stderr, "%s: %s (debug information: file %s, at line %lu)\n",
          usr_msg, sys_msg, filename, line_number);
} 
```

我写这个函数是因为 Posix 线程函数不修改`errno`，而是返回一个错误代码。所以这个功能与 基本相同`perror()`，只是它允许你提供除 之外的错误代码`errno`，并且还显示一些调试信息。您可以根据需要对其进行调整。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-22T23:03:36.693

您不能依赖返回的字符串，`strerror()`因为它可能会随着下一次调用该函数而改变。之前返回的值可能会变得过时。尤其是在**多线程环境**下，访问时无法保证字符串是有效的。

想象一下：

```
Thread #1:
char * error = strerror(1);
                                    Thread #2
                                    char * error = strerror(2);
printf(error); 
```

根据 的实现`strerror()`，此代码打印出错误代码 2 的错误代码，而不是错误代码 1。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T23:29:50.790

对于简洁的包装，您可以使用[STLSoft](http://www.stlsoft.org/)的`stlsoft::error_desc`，如：

```
std::string errstr = stlsoft::error_desc(errno); 
```

查看代码，似乎它是根据 实现的`strerror()`，这意味着它可以安全地在线程内重入（即，如果在给定语句中多次使用），但它没有解决多线程问题。

他们似乎对缺陷进行了相当快的发布周期，所以你可以尝试请求一个 mod 吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-04-12T12:46:34.870

我理解其他答案，但我认为用代码显示更清楚。

检查 glibc 的实现（我们应该在 MS lib 中得到类似的代码）

```
/* Return a string describing the errno code in ERRNUM.
   The storage is good only until the next call to strerror.
   Writing to the storage causes undefined behavior.  */
libc_freeres_ptr (static char *buf); 
```

当`errnum`不是已知错误时，它必须生成类似“Unknown error 41”的字符串。该字符串不是常量，而是生成到分配的缓冲区。并且`buf`是全局变量。`strerror`因此，当再次使用锁定调用时，其内容可能会发生变化。这就是为什么它是线程不安全的。

另一方面`strerror_r(int errnum, char *buf, size_t buflen)`，它为参数生成错误字符串`buf`。所以现在没有全球资源。这就是为什么它是线程安全的。

参考： [https ://github.com/liuyang1/glibc/blob/master/string/strerror.c#L23-L26](https://github.com/liuyang1/glibc/blob/master/string/strerror.c#L23-L26)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-22T23:04:14.570

虽然我不知道微软的原因，但我注意到 strerror 返回一个非 const char *，这意味着存在风险，一些 Merry Prankster 在你之前调用了 strerror 并修改了消息。

# apache-flex - 如何保护 CFC 中的 access="remote" 功能免受窥探者的侵害？

> ID：900348
> 
> 赞同：6
> 
> 时间：2009-05-22T22:58:43.380
> 
> 标签：apache-flex, flex3, coldfusion, remoting, cfc

CFC 的一大特色是能够为直接的 .cfm 页面和 Flex 应用程序重用代码。

我开发的一个这样的应用程序使用 Flex 的图表功能，需要访问 cfc 中的“getResults()”函数。

所有这些内容都在身份验证机制之后，但是由于 cfc 将向 wsdl 请求开放自己：

> [https://myserver.com/c/functions.cfc?wsdl](https://myserver.com/c/functions.cfc?wsdl)

如果 URL 查询设计正确，实际上会将结果返回给浏览器：

> [https://myserver.com/c/functions.cfc?method=getResults&Term=2009&Course=Anatomy](https://myserver.com/c/functions.cfc?method=getResults&Term=2009&Course=Anatomy)

人们使用了哪些技术来保护 cfc 免受直接访问，除非请求直接来自 CFML 处理器或来自 Flex Remoting？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T23:26:23.323

您可以利用一些 CGI 范围变量来检查请求的来源。

即：CGI.REMOTE_HOST，CGI.REMOTE_ADDR

因此，您可能会构建一个带有 access="public" 属性的新函数，该属性会根据您的服务器的有效值列表检查这些变量的值。如果它返回 true，您将执行请求，如果它返回 false，您将抛出/返回某种错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T17:16:37.187

我建议在您的 application.cfc 文件中添加一个 OnRequestStart 处理程序，并在那里执行检查...检查的内容取决于您当前的模型，但一些好的建议是检查 cgi.remote_user （如果经过身份验证）或存储会话范围内的东西？

```
<cfif structKeyExists(session,"empID") and len(session.empid)>
  <!--- user is authenticated, process normally --->
<cfelse>
  <!--- abort request or sending meaningful error message --->
</cfif> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T01:19:17.287

使用新的角色属性怎么样？访问您网站的每个人都会自动获得 cflogin roles="public"。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T13:24:02.690

我喜欢做的一件事是每个方法只有一个参数 - XML 或 Struct - 并且需要某个节点/对象名称出现在该 XML 或 Struct 中。

```
<cfif NOT StructKeyExists(arguments.myArgs, "requiredParam")>
    <cfxml name="myXML">
         <error>
             <message>Required parameter not found.</message>
         </error>
    </cfxml>

    <cfreturn myXML />
</cfif> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T23:48:56.260

虽然有点老了，但我还是翻出了 Bill Purcell 关于保护 CF 应用程序的一般笔记。已提到保护 CFC。

[http://www.bpurcell.org/blog/index.cfm?mode=entry&entry=978](http://www.bpurcell.org/blog/index.cfm?mode=entry&entry=978)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-20T11:31:13.580

只是在寻找其他东西时遇到了这个问题，并认为我会添加我的 2p：

我有一个使用远程 CFC 的应用程序，我只想对登录的“管理员”用户可用。在这种情况下，应用程序的来宾用户仍会通过 CGI 变量检查。

当管理员用户登录时，我会获取他们的会话 ID 和登录时间的哈希值，并将其存储在数据库和会话范围中。当我点击远程 CFC 时，我将哈希作为变量传递，并根据管理员用户的数据库对其进行检查。

如果返回记录，我知道当前用户是管理员，我会继续请求。

# ruby-on-rails - 解决 NameErrors -- 在使用沙漠插件和 Community_Engine 时，在 rails_end.rb 中的 RAILS_END 上出现 NameError

> ID：900358
> 
> 赞同：0
> 
> 时间：2009-05-22T23:00:55.777
> 
> 标签：ruby-on-rails, debugging, ruby-on-rails-plugins

在 Rails 中调试 NameErrors 的有效方法是什么？

我正在尝试使用沙漠插件（0.5.0）和 Community_Engine 的边缘版本。我从头开始并完成了安装说明。当我尝试启动服务器时，我收到此错误：“未找到 rails_end.rb 的常量 RAILS_END (NameError)”。问题是我找不到 rails_end.rb，也找不到这个文件的谷歌引用或错误。

我已经验证了所需的 gem 已安装并且是最新的。我已经在谷歌和沙漠中进行了挖掘，但没有找到对这个常量的任何引用。

有任何想法吗？谢谢

这是我的堆栈跟踪：

```
=> Booting Mongrel
=> Rails 2.3.2 application starting on http://0.0.0.0:3000
/opt/local/lib/ruby/gems/1.8/gems/desert-0.5.0/lib/desert/rails/
dependencies.rb:15:in `load_missing_constant': Constant RAILS_END from
rails_end.rb not found (NameError)
       from /Users/dmr/.gem/ruby/1.8/gems/activesupport-2.3.2/lib/
active_support/dependencies.rb:80:in `const_missing'
       from /Users/dmr/.gem/ruby/1.8/gems/activesupport-2.3.2/lib/
active_support/dependencies.rb:92:in `const_missing'
       from /Users/dmr/dev/lionfold/config/environment.rb:32
       from /Users/dmr/.gem/ruby/1.8/gems/rails-2.3.2/lib/
initializer.rb:111:in `run'
       from /Users/dmr/dev/myapp/config/environment.rb:31
       from /opt/local/lib/ruby/vendor_ruby/1.8/rubygems/
custom_require.rb:31:in `gem_original_require'
       from /opt/local/lib/ruby/vendor_ruby/1.8/rubygems/
custom_require.rb:31:in `require'
       from /Users/dmr/.gem/ruby/1.8/gems/activesupport-2.3.2/lib/
active_support/dependencies.rb:156:in `require'
       from /Users/dmr/.gem/ruby/1.8/gems/activesupport-2.3.2/lib/
active_support/dependencies.rb:521:in `new_constants_in'
       from /Users/dmr/.gem/ruby/1.8/gems/activesupport-2.3.2/lib/
active_support/dependencies.rb:156:in `require'
       from /Users/dmr/.gem/ruby/1.8/gems/rails-2.3.2/lib/commands/
server.rb:84
       from /opt/local/lib/ruby/vendor_ruby/1.8/rubygems/
custom_require.rb:31:in `gem_original_require'
       from /opt/local/lib/ruby/vendor_ruby/1.8/rubygems/
custom_require.rb:31:in `require'
       from script/server:3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-06-14T21:04:18.597

抱歉，我刚刚注意到这一点；请务必在 CommunityEngine Google 群组中提出您的问题；你可能会在那里得到更好的答案：

[http://groups.google.com/group/communityengine/](http://groups.google.com/group/communityengine/)

感谢 Bruno - 首席 CE 开发人员

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-09T15:17:25.093

最后我知道，Desert 不适用于 Rails 2.3

# java - 在 Java 文本框中设置文本颜色

> ID：900360
> 
> 赞同：0
> 
> 时间：2009-05-22T23:01:42.437
> 
> 标签：java, swing, textbox, colors

如何在运行时设置 Java Swing 文本框中的文本颜色？在启动时，颜色是灰色的，当用户进入文本框时，我希望将颜色更改为正常的文本颜色。我目前正在使用以下代码：

```
private void txtScheduleInfoFocusGained(java.awt.event.FocusEvent evt)                                            
    {                                                
        try
        {
            if (currentClassIsNewClass() && txtScheduleInfo.getDocument().getText(0, txtScheduleInfo.getDocument().getLength()).equals(PASTE_SI_HERE))
            {
                txtScheduleInfo.setText("");
                txtScheduleInfo.setForeground(java.awt.SystemColor.textText);
            }
        }
        catch (BadLocationException ex)
        {
            JOptionPane.showMessageDialog(this, "BLE\nContact Zian", "Unexpected Problem", JOptionPane.ERROR_MESSAGE);
        }
    } 
```

此时，代码运行时，文本仍然显示为灰色。

附加代码：
声明（作为字段）：

```
 private javax.swing.JTextPane txtScheduleInfo; 
```

实例化：

```
txtScheduleInfo = new javax.swing.JTextPane(); 
```

初始化：

```
txtScheduleInfo.setForeground(java.awt.SystemColor.textInactiveText);
txtScheduleInfo.setText("Paste schedule information here");
txtScheduleInfo.addFocusListener(new java.awt.event.FocusAdapter() {
    public void focusGained(java.awt.event.FocusEvent evt) {
        txtScheduleInfoFocusGained(evt);
    }
    public void focusLost(java.awt.event.FocusEvent evt) {
        txtScheduleInfoFocusLost(evt);
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T00:28:09.610

您是否确保启用了 JTextBox？你可以打电话`setEnabled(true)`确认一下。不要试图粗鲁，这只是最可能的原因（Swing 中有代码强制禁用的组件变灰）。

如果这不能解决问题，您还可以通过调用 txtScheduleInfo.repaint() 来触发重绘，这可能会导致重绘。

如果这些都没有帮助，您可以发布一些代码，以便我们了解发生了什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T01:35:16.233

试试这个

```
private void txtScheduleInfoFocusGained(java.awt.event.FocusEvent evt)                                            
    {                                                
        try
        {
            if (currentClassIsNewClass() && txtScheduleInfo.getDocument().getText(0, txtScheduleInfo.getDocument().getLength()).equals(PASTE_SI_HERE))
            {
                txtScheduleInfo.setForeground(java.awt.SystemColor.textText);
                txtScheduleInfo.setText("");
            }
        }
        catch (BadLocationException ex)
        {
            JOptionPane.showMessageDialog(this, "BLE\nContact Zian", "Unexpected Problem", JOptionPane.ERROR_MESSAGE);
        }
    } 
```

（唯一的变化是交换顺序。现在您在清除文本之前设置前景色。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T15:29:26.547

Swing 通常不会执行此行为（当文本框获得编辑焦点时更改颜色）？尝试禁用所有颜色更改代码，看看它是否正常工作。如果您愿意在[PasteBin](http://pastebin.com/)上以可编译的形式发布您的代码，其他人实际上也可以进行全面调试。

我可以建议的其他事情：

*   检查 java.awt.SystemColor.textText 是否真的是您想要的颜色（使用其上的方法获取十六进制颜色，然后将其显示在颜色选择器中）
*   删除该行`txtScheduleInfo.setForeground(java.awt.SystemColor.textInactiveText);`，因为如果您的焦点处理程序损坏，它可能会以某种方式覆盖默认绘画。
*   替换
    `if (currentClassIsNewClass() && txtScheduleInfo.getDocument().getText(0, txtScheduleInfo.getDocument().getLength()).equals(PASTE_SI_HERE))`
    **为** `if(true)`

由于 if 语句中的条件，您的焦点事件侦听器可能永远不会触发更改颜色。此外，您知道在调用该方法时无论如何都会获得焦点。

# c++ - 当我创建我的助手类时，我是否过度设计？

> ID：900361
> 
> 赞同：8
> 
> 时间：2009-05-22T23:02:13.887
> 
> 标签：c++, c

我是一名 C++ 程序员，最近加入了一家使用大量 C 的新公司。当他们审查我的代码时，他们认为我过度设计了一些我完全不同意的东西。该公司在嵌入式系统中做所有事情，所以我的代码需要内存高效，但我正在做的事情不是 CPU 密集型的。我想知道你们如何看待我的设计。这是清单。

1.  我有一些需要传递的数组，最终需要传递给一些 C 代码。我可以在整个地方传递一个指针和一个大小。但是我选择创建一个代表这一点的类——一个具有固定大小（我们知道最大大小）缓冲区的类，并且长度应该始终<=缓冲区的大小，否则断言。这样，我可以只用一个变量而不是两个变量来传递数组，如果将来最大大小发生变化，我应该可以轻松更改它。我不对数组使用动态分配，因为它是嵌入式系统，内存分配可能会失败，我们不使用异常。这个类可能少于 30 行代码，我在很多地方都使用它。他们说我过度设计了它。

2.  他们在 C 语言中有自己的容器实现。我需要使用其中一个，但我想隐藏所有详细代码，远离我的主要逻辑，所以我为它创建了一个包装类。包装类类似于stl，所以我有迭代器，它在内部管理内存分配，但与stl不同的是，它在无法分配更多内存时返回错误代码。他们对此的论点是我是唯一使用它的人，所以他们不希望它出现在存储库中。我觉得说实话很愚蠢。

编辑：以下课程或多或少是我用于第 1 点的课程。我想做的就是在不携带长度的情况下传递一些东西。

```
class A
{
  static const MAX_SIZE = 20;
  int m_Array[MAX_SIZE];
  size_t m_Len;

public:
  A(const int* array, size_t len)
  {
    assert(len <= MAX_SIZE);
    memcpy(m_Array, array, len);
    m_Len = len;
  }

  size_t GetLen() const { return m_Len; }
  const int* GetArray() const { return m_Array; }
}; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T00:20:38.643

第一件事：你加入了一家新公司，所以你可以期望你需要学会遵守他们的规则。你仍然是“新人”，对“你的方式”做事会有一些阻力，即使它更好。习惯它们，慢慢整合你自己和你的想法。

至于＃1，传递指针+大小对于程序员来说肯定是一种痛苦，但它是最节省内存的做事方式。您的课程没有“过度”设计，但是如果 MAXSIZE 在未来某个时候变得非常大，会发生什么？您的所有实例每个都将占用那么多空间，即使它们不需要。您可能会因为 MAXSIZE 更改而导致空间不足，即使没有什么需要那么多空间。

至于＃2，它是否是一个不必要的层是一个折腾（也许它更适合改进他们的包装器而不是简单地再次包装它？），但这将归结为你与他们集成的程度并提出建议。

总而言之，我不会称其为“过度设计”，但在嵌入式情况下，您需要非常谨慎地泛化代码以节省自己的精力与节省内存..

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-23T00:31:53.037

您可能是对的，但另一方面，如果公司中的每个人都认为他们不喜欢现有的 API，并且每个人都设计了自己的 shims 和 helper 函数，只有他们自己使用，那么维护就会很棘手。

如果您的数组包装器“过度设计”，那么我会质疑代码审查员是否认为*任何*数量的设计都是可以接受的。它看起来对我无害[*]。我想你可以把它做成一个有两个公共成员的结构，而失去可读性的好处。一般来说，您的同事对 const 正确性有多热衷？

我认为 2 的目标应该是就 C API 是否应该直接从 C++ 使用或包装达成共识。如果它应该被包装（并且它的参数可能非常强大，命名空间和 RAII 是什么），设计一个每个人都会使用的包装器，并将其指定为“该模块的 C++ API”而不是“一个 C++ 包装器”模块用于其他模块”。

其他人可能真的更喜欢 API，而不是更多的 OO API 或使用 STL。遵循他们的约定将使他们更容易维护您的代码，只要他们的约定是可靠的 C 编程风格。C++ 是一种多范式语言，“花里胡哨的 C”不是你习惯的范式。但这是一个有效的范例，如果它是现有代码库使用的，那么您必须质疑您的公司现在需要的是一场单人革命，无论多么开明。

[*] （即 API。他们可能会质疑它是否会不恰当地按值传递，以及每个实例都必须与最大的一样大是否明智。这就是你与审阅者争论的全部，但与“过度设计”无关。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T01:38:11.530

已经存在的 c 风格容器库的 c++ 包装器是一件好事。但请确保它真的是一个包装纸，而不是用螺栓固定在花里胡哨上的包装纸。

如果您将所有访问函数声明为内联并使用最精简的实现编写包装器，则代码和数据大小的开销应该完全为零。

这样的包装器只会为您提供到 c 库的类类接口，这对于 C/C++ 项目来说是一个很好的做法。

我建议检查你的代码。看一下使用包装器对一个小测试用例的反汇编，并将其与仅 c 的实现进行比较。如果你看到任何额外的复杂性、分配或调用你的类实现，你就会有开销，并且可能有点过度设计。

与 c 版本相比，证明您的包装器生成或多或少相同的代码可能会让其他程序员相信包装器在这里和那里都没有害处。它遵循 C++ 程序的编写方式，将产生更清晰、更一致的代码库。

顺便说一句 - “我们不希望我们的存储库中没有无用的包装类”是一个社会问题，而不是技术问题。你是新来的人。如果我处于你的位置，我会在几个月内遵守他们的规则，然后——在我证明自己之后——向他们介绍你的想法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T23:24:46.243

一方面，如果您对 C++ 感到满意并且他们使用 C，那么帮助程序类可能是一件好事，至少对您而言。另一方面，如果您正在编写任何类型的容器类，您几乎肯定最好直接使用 STL 并编写一个辅助*函数*来弥合 STL 容器和 C 代码之间的差距。不要重新发明轮子。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-23T00:22:22.557

“过度设计”是非常相对的。您小组中的 C 人可能会看到您的班级存在问题，因为当您通过引用传递班级时，您将复制整个数组。这将在“嵌入式​​”系统上花费相当长的时间（取决于您对嵌入式的定义）当然，如果您通过地址传递，这不是问题。

你的#2是一个文化问题。如果他们不愿意尝试新的编程技术，那么您将被视为局外人。这是你不想发生的事情。慢慢介绍。

至于不把它放在存储库中 - 那是胡说八道。每个人都应该将所有内容都放在存储库中，以便人们可以访问它并在以后发现错误。

不要自吹自擂，但我前几天问了一个相关问题： [在嵌入式环境中使用 C++](https://stackoverflow.com/questions/880603/using-c-in-an-embedded-environment)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T23:12:12.993

我不确定1。也许您可以举一个简单的代码示例来说明。

至于2，我同意你的看法。作为一名努力掌握 C++ 速度的 C 程序员，我完全被围绕现有 C API 编写精简外观的想法所折服，以便于错误处理和资源管理。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-23T00:57:31.457

您为您的类制作了一份数据副本，这不再使您的类成为一个单纯的包装类。虽然这将保护您免受从您下面删除的数据，但如果原始数据被修改，您的数据将过期。

用大小封装数组的想法是合理的。也许你可以让他们接受将 size 字段添加到他们的容器中，假设它不仅仅是一个 const int*。但我可以看到，仅仅为了封装大小的特权，额外的内存和运行时来建模和初始化类的开销对他们来说似乎是不可接受的。

除此之外，我必须完全同情经典的 C 偏见，即 C++ 是邪恶且缓慢的。闪回……颤抖。

# security - 混淆或隐藏服务器到客户端状态更新

> ID：900367
> 
> 赞同：0
> 
> 时间：2009-05-22T23:03:37.333
> 
> 标签：security, network-programming, obfuscation, information-hiding

我实际上并没有自己编写这个软件，但我突然想到我不知道如何解决这个问题。作为解释这个问题的最佳方式，我将描述一个假设的多人第一人称射击游戏的特定场景......

*   玩家 A 躲在一些朝西的灌木丛中
*   玩家 B 正从东面偷袭玩家 A，或潜入玩家 A 身后

为这个游戏编写的一个流行的“hack”是让玩家 A 有一个雷达来显示玩家 B 的位置，即使他在屏幕上看不到玩家 B，而且游戏不支持雷达。这种破解是可能的，因为服务器正在向特定范围内的所有玩家（可能在玩家 A 的剪裁平面内）向玩家 A 的客户端发送信息。（据我所知）服务器尝试仅向玩家 A 的客户端发送玩家 A 视野内玩家的信息是不现实的。因为服务器必须将所有附近玩家的信息发送到玩家 A 的客户端，玩家 A 可以编写一个 hack，在他的屏幕上覆盖一个雷达，通过观察发送到客户端的数据并提取敌方玩家状态更新来填充该雷达。我认为这些通常被称为“雷达”或“

有没有办法在发送给客户端的信息中混淆或隐藏敌方玩家的状态更新？据我了解，加密对于实时解决方案不可行？即使服务器只能在玩家 A 的视野范围内发送玩家的状态更新，这仍然允许玩家 A 的 hack 显示玩家躲在伪装或掩护物体后面（大概是透明的）。

我唯一能真正想到的就是实施某种类型的“punkbuster”解决方案。也就是说，让玩家 A 的客户端定期扫描非法进程。这个想法是任何流行的黑客都会受到监控。不受欢迎的黑客攻击会影响足够小的玩家群，以至于他们太小而无法追踪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T23:17:53.700

这是唯一的方法。除了 punkbuster，你应该对[Warden](http://en.wikipedia.org/wiki/Warden_(software))做一些研究（除了维基百科，还有很多有趣的东西我不会在这里链接）。[鉴于在线世界设计的规律，](http://www.raphkoster.com/2008/04/17/how-to-hack-an-mmo/)这是一场非常有趣的战斗......

> 客户掌握在敌人手中。

另一个因素是人们会用经过修改的驱动程序来替换他们的视频驱动程序，从而给他们带来优势（事物是不透明的或突出显示的，玩家不能“失明”，等等）。我不确定是否有任何游戏检查修改过的驱动程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T23:23:43.970

简单的加密对于今天的硬件来说可能是可行的，但问题是为了让客户端访问加密的数据，它必须有密钥。如果客户拥有密钥，那么作弊程序可能不会太难找到并检索它。最好的方法是服务器只在可能看到 B 的情况下将 B 的位置发送给 A。它仍然可以作弊，但程度要小一些。

对于 B 隐藏但一小部分可能可见的情况，一个可能的解决方案是让服务器简单地说 B 的位置有*东西*。它可能是一块石头或诸如此类的东西。问题在于，为了让客户端能够渲染*某物*，服务器必须给出相当准确的描述。鉴于当今的多人游戏通过模拟服务器的行为来伪造低延迟，在我们拥有超低延迟网络之前，这很可能是不可行的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T23:18:05.120

有一个名为“eqmon”的程序为游戏 Everquest 做了类似的事情。起初，游戏包是完全未加密的，并且包含整个关卡的所有角色（PC 和 NPC）。最终，他们最终使用加密来让窥探数据包变得更加困难，但 eqmon 通过暴力破解加密密钥（每次进入关卡时服务器都会创建一个新密钥，因此有时需要几分钟）来解决这个问题解密密钥）。然后他们对其进行了更改，以便您的客户端仅收到您所在位置特定范围内的 PC 或 NPC 的更新。这使得 eqmon 不太有助于在同一关卡中远距离露营和监控“稀有产卵”。

# c++ - C++ 将 shared_ptr 提升为 hash_map 键

> ID：900369
> 
> 赞同：2
> 
> 时间：2009-05-22T23:04:45.800
> 
> 标签：c++, boost, neural-network, shared-ptr, hashmap

我正在制作一个神经网络，并希望使用 hash_map 来为每个神经元的输出神经元保留权重参考：

```
class Neuron; //forward declaration was there (sorry I forgot to show it earlier)
typedef double WEIGHT;
typedef stdext::hash_map<boost::shared_ptr<Neuron>,WEIGHT> NeuronWeightMap;
class Neuron
{
private:
    NeuronWeightMap m_outputs;
    //...
public:

    Neuron();
    ~Neuron();
    //...
    WEIGHT GetWeight(const boost::shared_ptr<Neuron>& neuron) const
    {
        NeuronWeightMap::const_iterator itr = m_outputs.find(neuron);
        if( itr != m_outputs.end() )
        {
            return itr->second;
        }
        return 0.0f;
    }
}; 
```

我意识到我不能使用 boost::shared_ptr 作为 stdext::hash_map 的键，那么还有什么建议呢？是否有任何变通方法或者是使用不同键或切换到 std::map 的唯一选择？谢谢！

这是错误：

```
1>c:\program files (x86)\microsoft visual studio 8\vc\include\xhash(61) : error C2440: 'type cast' : cannot convert from 'const boost::shared_ptr<T>' to 'size_t'
1>        with
1>        [
1>            T=Neuron
1>        ]
1>        No user-defined-conversion operator available that can perform this conversion, or the operator cannot be called
1>        c:\program files (x86)\microsoft visual studio 8\vc\include\xhash(99) : see reference to function template instantiation 'size_t stdext::hash_value<_Kty>(const _Kty &)' being compiled
1>        with
1>        [
1>            _Kty=boost::shared_ptr<Neuron>
1>        ]
1>        c:\program files (x86)\microsoft visual studio 8\vc\include\xhash(98) : while compiling class template member function 'size_t stdext::hash_compare<_Kty,_Pr>::operator ()(const _Kty &) const'
1>        with
1>        [
1>            _Kty=boost::shared_ptr<Neuron>,
1>            _Pr=std::less<boost::shared_ptr<Neuron>>
1>        ]
1>        c:\program files (x86)\microsoft visual studio 8\vc\include\hash_map(80) : see reference to class template instantiation 'stdext::hash_compare<_Kty,_Pr>' being compiled
1>        with
1>        [
1>            _Kty=boost::shared_ptr<Neuron>,
1>            _Pr=std::less<boost::shared_ptr<Neuron>>
1>        ]
1>        c:\program files (x86)\microsoft visual studio 8\vc\include\xhash(119) : see reference to class template instantiation 'stdext::_Hmap_traits<_Kty,_Ty,_Tr,_Alloc,_Mfl>' being compiled
1>        with
1>        [
1>            _Kty=boost::shared_ptr<Neuron>,
1>            _Ty=common_ns::WEIGHT,
1>            _Tr=stdext::hash_compare<boost::shared_ptr<Neuron>,std::less<boost::shared_ptr<Neuron>>>,
1>            _Alloc=std::allocator<std::pair<const boost::shared_ptr<Neuron>,common_ns::WEIGHT>>,
1>            _Mfl=false
1>        ]
1>        c:\program files (x86)\microsoft visual studio 8\vc\include\hash_map(90) : see reference to class template instantiation 'stdext::_Hash<_Traits>' being compiled
1>        with
1>        [
1>            _Traits=stdext::_Hmap_traits<boost::shared_ptr<Neuron>,common_ns::WEIGHT,stdext::hash_compare<boost::shared_ptr<Neuron>,std::less<boost::shared_ptr<Neuron>>>,std::allocator<std::pair<const boost::shared_ptr<Neuron>,common_ns::WEIGHT>>,false>
1>        ]
1>        FILE_PATH_REMOVED\neuralnet.h(21) : see reference to class template instantiation 'stdext::hash_map<_Kty,_Ty>' being compiled
1>        with
1>        [
1>            _Kty=boost::shared_ptr<Neuron>,
1>            _Ty=common_ns::WEIGHT
1>        ]
1>NeuralNet.cpp
1>c:\program files (x86)\microsoft visual studio 8\vc\include\xhash(61) : error C2440: 'type cast' : cannot convert from 'const boost::shared_ptr<T>' to 'size_t'
1>        with
1>        [
1>            T=Neuron
1>        ]
1>        No user-defined-conversion operator available that can perform this conversion, or the operator cannot be called
1>        c:\program files (x86)\microsoft visual studio 8\vc\include\xhash(99) : see reference to function template instantiation 'size_t stdext::hash_value<_Kty>(const _Kty &)' being compiled
1>        with
1>        [
1>            _Kty=boost::shared_ptr<Neuron>
1>        ]
1>        c:\program files (x86)\microsoft visual studio 8\vc\include\xhash(98) : while compiling class template member function 'size_t stdext::hash_compare<_Kty,_Pr>::operator ()(const _Kty &) const'
1>        with
1>        [
1>            _Kty=boost::shared_ptr<Neuron>,
1>            _Pr=std::less<boost::shared_ptr<Neuron>>
1>        ]
1>        c:\program files (x86)\microsoft visual studio 8\vc\include\hash_map(80) : see reference to class template instantiation 'stdext::hash_compare<_Kty,_Pr>' being compiled
1>        with
1>        [
1>            _Kty=boost::shared_ptr<Neuron>,
1>            _Pr=std::less<boost::shared_ptr<Neuron>>
1>        ]
1>        c:\program files (x86)\microsoft visual studio 8\vc\include\xhash(119) : see reference to class template instantiation 'stdext::_Hmap_traits<_Kty,_Ty,_Tr,_Alloc,_Mfl>' being compiled
1>        with
1>        [
1>            _Kty=boost::shared_ptr<Neuron>,
1>            _Ty=common_ns::WEIGHT,
1>            _Tr=stdext::hash_compare<boost::shared_ptr<Neuron>,std::less<boost::shared_ptr<Neuron>>>,
1>            _Alloc=std::allocator<std::pair<const boost::shared_ptr<Neuron>,common_ns::WEIGHT>>,
1>            _Mfl=false
1>        ]
1>        c:\program files (x86)\microsoft visual studio 8\vc\include\hash_map(90) : see reference to class template instantiation 'stdext::_Hash<_Traits>' being compiled
1>        with
1>        [
1>            _Traits=stdext::_Hmap_traits<boost::shared_ptr<Neuron>,common_ns::WEIGHT,stdext::hash_compare<boost::shared_ptr<Neuron>,std::less<boost::shared_ptr<Neuron>>>,std::allocator<std::pair<const boost::shared_ptr<Neuron>,common_ns::WEIGHT>>,false>
1>        ]
1>        FILE_PATH_REMOVED\neuralnet.h(21) : see reference to class template instantiation 'stdext::hash_map<_Kty,_Ty>' being compiled
1>        with
1>        [
1>            _Kty=boost::shared_ptr<Neuron>,
1>            _Ty=common_ns::WEIGHT
1>        ]
1>Generating Code... 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T23:33:01.173

您可能已`Neuron`在 .h 文件中声明。

所以下面可以工作：

```
struct hasher {
    size_t operator()(const boost::shared_ptr<Neuron>& n) { return (size_t)n.get(); }
};

typedef stdext::hash_map<boost::shared_ptr<Neuron>,WEIGHT,hasher> NeuronWeightMap; 
```

问题可能是`boost:shared_ptr`没有默认的散列函数（看起来像什么？），所以你只需要提供一个。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-01-18T16:16:40.127

您还可以为哈希提供模板特化：

```
#include <functional>
#include <boost/shared_ptr.hpp>

template<class T>
class std::tr1::hash<boost::shared_ptr<T>> {
public:
    size_t operator()(const boost::shared_ptr<T>& key) const {
        return (size_t)key.get();
    }
}; 
```

与 unordered_set 完美配合：

```
class Foo;
typedef boost::shared_ptr<Foo> FooPtr;
typedef std::tr1::unordered_set<FooPtr> FooSet; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T23:37:42.367

“正常”`Neuron*`应该作为关键`hash_map`：

```
typedef stdext::hash_map<Neuron*, WEIGHT> NeuronWeightMap; 
```

如果要查找`shared_ptr`-Neurons，可以使用`shared_ptr`s`get()`方法访问原始指针：

```
NeuronWeightMap weights;
boost::shared_ptr<Neuron> n;

weights.find(n.get()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T00:01:23.503

既然你已经使用了 Boost，为什么不使用`boost::unordered_map`哈希表呢？它使用 for 键编译开箱即用`shared_ptr`，但您最好检查如何正确执行 ( [Boost.Unordered](http://www.boost.org/doc/libs/1_39_0/doc/html/unordered.html) )

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T23:22:37.013

从上面的代码中编译器错误是什么？

您是否尝试过声明神经元类？

```
class Neuron; // class Neuron must be forward declared to be used

typedef double WEIGHT;
typedef stdext::hash_map<boost::shared_ptr<Neuron>,WEIGHT> NeuronWeightMap;

class Neuron
{
private:
    NeuronWeightMap m_outputs;
    //...
public:

    Neuron();
    ~Neuron();
    //...
}; 
```

在这种情况下，标准地图也应该没问题，您使用 hash_map 的具体原因是什么？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-05T13:01:54.213

我发现通过添加 hash_value() 函数，我可以使用 shared_ptr 作为 stdext::hash_map 中的键。下面我比较使用 boost::unordered_map 和 std::hash_map

```
#include <boost/smart_ptr.hpp>
#include <boost/unordered_map.hpp>
#include <hash_map>
#include <assert.h>

struct MyItem
{
    int i;
};
typedef boost::shared_ptr<const MyItem> MyItem_csptr;

struct MyExtra
{
    double d;
};

//Boost's unordered_map already knows how to hash shared_ptr
typedef boost::unordered_map<MyItem_csptr,MyExtra> MapMyItemToExtra;

//But for stdext::hash_map, we need to write this:
template<class T>
size_t hash_value(const boost::shared_ptr<T>& aSptr)
{
    return reinterpret_cast<size_t>( aSptr.get() );
};
typedef stdext::hash_map<MyItem_csptr,MyExtra> MapMyItemToExtra2;

template<class MAP>
void TryMapMyItemToExtra_T()
{
    MAP tMap;

    MyItem_csptr tItem1(new MyItem);
    MyItem_csptr tItem2(new MyItem);
    tMap[tItem1].d=1.0;
    tMap[tItem1].d=1.1;
    tMap[tItem2].d=2.0;

    assert( tMap[tItem1].d == 1.1 );
    assert( tMap[tItem2].d == 2.0 );
}

void TryMapMyItemToExtra()
{
    TryMapMyItemToExtra_T<MapMyItemToExtra>();
    TryMapMyItemToExtra_T<MapMyItemToExtra2>();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-08T18:19:42.343

哈希函数的问题`stdext::hash_set`也随之而来。带有声明的解决方案`hash_value()`是最好的，因为您可以在主头文件中只声明一次。

# emacs - 在 Emacs 中，如何更改 minibuffer 完成列表窗口？

> ID：900372
> 
> 赞同：7
> 
> 时间：2009-05-22T23:09:41.347
> 
> 标签：emacs, elisp

我想为 minibuffer 完成列表设置一个特定的窗口。目前，我在此配置中有 3 个窗口：

```
 ______
|    | |
|____| |
|____|_| 
```

在这种情况下，我想使用左下角的窗口作为 minibuffer 完成列表。

目前，它似乎是一个随机的窗口，并且大多数时候它喜欢使用最右边的窗口，它太薄而无法显示完成列表而我不必水平滚动，这很烦人。

[另外，当我加载 Emacs 时，我正在使用一个名为revive.el](http://www.gentei.org/~yuuji/software/revive.el)的 lisp 脚本从文件 (~/.revive.el)中*恢复我的窗口配置。*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T23:44:56.033

在开始尝试使用的路径之后`minibuffer-scroll-window`（结果不是用户可自定义的）。我尝试了这种方法：

```
(add-to-list 'special-display-buffer-names '("*Completions*" my-display-completions))

(defun my-display-completions (buf)
  "put the *completions* buffer in the right spot"
  (let ((windows (delete (minibuffer-window) (window-list))))
    (if (eq 1 (length windows))
        (progn 
          (select-window (car windows))
          (split-window-vertically)))
    (let ((target-window (window-at 0 (- (frame-height) 2)))
          (pop-up-windows t))
      (set-window-buffer target-window buf)
      target-window))) 
```

这通过将唯一的窗口一分为二并显示`*Completions*`在底部窗口中来工作，或者，如果已经显示了 2 个或更多窗口，则使用左下角的窗口显示`*Completions*`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T05:15:57.450

一个稍微作弊的答案，*可能会*做你想做的事：

使用手动使左下角窗口成为 *Completions* 缓冲区

```
C-x b *Completions* RET 
```

当光标在该窗口中处于活动状态时。然后，每当 minibuffer 必须显示一些完成时，它应该总是使用这个特定的窗口。但是，这将依赖于该缓冲区始终保持打开和可见 - 可能不是您想要的？

其他可能性：

1.  看看“ [Icicles](http://www.emacswiki.org/emacs/Icicles_-_Completions_Display) ”是否有帮助 - 例如，它提到“有很多 Icicles 功能可以增强 '*Completions*' 的显示和行为”。
2.  [完成完成的 Minibuffer 命令](http://www.zvon.org/other/elisp/Output/SEC263.html#SEC271)可能有用吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T15:31:12.340

不像 Trey 的答案那么健壮，但似乎也以粗略的方式工作。

```
; Go to the 3rd window, and make it dedicated.
(other-window 2)
(set-window-dedicated-p (selected-window) 1) 
```

这仅在您不介意第三个窗口被锁定时才有效。不幸的是，它仍然会不时尝试使用第一个窗口（这不那么令人沮丧，但仍然不可取）。

**注意：**我刚刚尝试了 Trey 的解决方案，它现在可以工作了，所以我建议人们使用它。

# c# - C# 和 mp3 淡入/淡出

> ID：900383
> 
> 赞同：3
> 
> 时间：2009-05-22T23:14:41.727
> 
> 标签：c#, sdk, mp3

我正在寻找一个库来为我提供剪切 mp3 文件的选项。我想剪切文件的某个部分并淡入/淡出音量。

现在我正在使用 Windows Media Encoder SDK，但它没有淡入/淡出的选项，或者我不知道。

在某个论坛上，我注意到有人建议 DirectX SDK 褪色，但我找不到任何有关此的文档。

如果有人可以帮忙，谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T23:20:56.113

您最好的选择可能是使用 .NET 的[NAudio](http://www.codeplex.com/naudio)库，至少用于操作（淡入/淡出）音频数据。它还具有 MP3 读/写支持，但我不确定它有多完整。如果它现在可用，那么该库应该能够完美地完成您的所有工作，并且作为奖励，所有这些都以完全托管的方式进行。在最坏的情况下，您将需要一个额外的工具来解码/重新编码原始音频/WAV 文件中的 MP3 文件。

[DirectShow.NET](http://directshownet.sourceforge.net/)（Microsoft DirectShow API 的托管包装器）可能是另一种选择，尽管这肯定会很痛苦，因为 a) 接口仍然是有效的 COM，b) DirectShow API 是出了名的复杂且难以使用。

# python - 在 Python 中的另一个函数中获取调用者函数名称？

> ID：900392
> 
> 赞同：148
> 
> 时间：2009-05-22T23:19:16.397
> 
> 标签：python, debugging

如果您有 2 个功能，例如：

```
def A
def B 
```

和 A 呼叫 B，你能在 B 中知道谁在呼叫 B，例如：

```
def A () :
    B ()

def B () :
    this.caller.name 
```

* * *

## 回答 #1

> 赞同：232
> 
> 时间：2009-05-22T23:24:18.243

您可以使用[检查](http://docs.python.org/library/inspect.html)模块来获取您想要的信息。它的[stack](https://docs.python.org/3.5/library/inspect.html#the-interpreter-stack)方法返回一个帧记录列表。

*   对于**Python 2**，每个帧记录都是一个列表。每条记录中的第三个元素是调用者姓名。你想要的是这样的：

    ```
    >>> import inspect
    >>> def f():
    ...     print inspect.stack()[1][3]
    ...
    >>> def g():
    ...     f()
    ...
    >>> g()
    g 
    ```

* * *

*   对于**Python 3.5+**，每个帧记录都是一个[命名元组](https://docs.python.org/3.5/glossary.html#term-named-tuple)，因此您需要替换

    ```
    print inspect.stack()[1][3] 
    ```

    和

    ```
    print(inspect.stack()[1].function) 
    ```

    在上面的代码上。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2015-01-28T05:52:56.497

有两种方式，使用`sys`和`inspect`模块：

*   `sys._getframe(1).f_code.co_name`
*   `inspect.stack()[1][3]`

该`stack()`表单的可读性较差，并且由于它调用而依赖于实现`sys._getframe()`，请参阅以下内容的摘录`inspect.py`：

```
def stack(context=1):
    """Return a list of records for the stack above the caller's frame."""
    return getouterframes(sys._getframe(1), context) 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-22T23:27:35.053

*注意（2018 年 6 月）：今天，我可能会使用`inspect`模块，请参阅其他答案*

`sys._getframe(1).f_code.co_name`如下例所示：

```
>>> def foo():
...  global x
...  x = sys._getframe(1)
...
>>> def y(): foo()
...
>>> y()
>>> x.f_code.co_name
'y'
>>> 
```

重要提示：从`_getframe`方法名称中可以看出（嘿，它以下划线开头），它不是一个应该轻率依赖的 API 方法。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-07-22T23:12:58.460

这对我有用！:D

```
>>> def a():
...     import sys
...     print sys._getframe(1).f_code.co_name
...
>>> def b():
...     a()
...
...
>>> b()
b
>>> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-07-24T08:20:05.027

您可以使用日志记录模块并在 BaseConfig() 中指定 %(funcName)s 选项

```
import logging
logging.basicConfig(filename='/tmp/test.log', level=logging.DEBUG, format='%(asctime)s | %(levelname)s | %(funcName)s |%(message)s')

def A():
    logging.info('info') 
```

# python - 是否有一种高级方法可以从输出文件中读取行并让内容结构识别类型？

> ID：900396
> 
> 赞同：0
> 
> 时间：2009-05-22T23:20:32.243
> 
> 标签：python, string, tuples

假设我有一个要读取的输出文件，并且每一行都是通过将几种类型连接在一起创建的，预先和附加列表大括号，

```
[('tupleValueA','tupleValueB'), 'someString', ('anotherTupleA','anotherTupleB')] 
```

我想读入这些行。现在我可以读入它们，并对字符串进行操作以分配值和类型，但我想知道 Python 是否有更高级别的方法。

在构建了一个函数来执行此操作后，我试图找到一种更高级别的方法，但没有找到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T23:26:54.133

您正在寻找的是[eval](http://docs.python.org/library/functions.html#eval)。但请记住，此函数将评估并执行这些行。所以永远不要在不受信任的输入上运行它！

```
>>> print eval("[('tupleValueA', 1), 'someString']")
[('tupleValueA', 1), 'someString'] 
```

如果您可以控制生成输出文件的脚本，那么我建议您使用[json](http://docs.python.org/library/json.html)编码。JSON 格式与列表和字典的 Python 字符串表示非常相似。并且读取起来会更加安全和健壮。

```
>>> import json
>>> json.dumps(['foo', {'bar': ('baz', None, 1.0, 2)}])
'["foo", {"bar": ["baz", null, 1.0, 2]}]'
>>> json.loads('["foo", {"bar": ["baz", null, 1.0, 2]}]')
["foo", {"bar": ["baz", null, 1.0, 2]}] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T23:46:04.877

您描述的问题通常称为[序列化](http://en.wikipedia.org/wiki/Serialization)。 [JavaScript Object Notation (JSON)](http://en.wikipedia.org/wiki/JSON)是一种流行的序列化协议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T23:51:51.713

可能最好首先使用像[pickle](http://docs.python.org/library/pickle.html)这样的模块来存储数据，而不是使用普通字符串。通过这种方式，您可以避免很多随之而来的问题，`eval`并获得更强大的解决方案。

# c - 如何在我自己的 C 中正确等待前台/后台进程？

> ID：900411
> 
> 赞同：8
> 
> 时间：2009-05-22T23:27:14.150
> 
> 标签：c, process, signals, background-foreground

在[上](https://stackoverflow.com/questions/873620/how-do-i-clear-this-array-pointer-in-c)一个问题中，我发布了我自己的大部分 shell 代码。我的下一步是实现前台和后台进程执行并适当地等待它们终止，这样它们就不会像“僵尸”一样停留。

在添加在后台运行它们的可能性之前，所有进程都在前台运行。为此，我在使用 execvp() 执行任何进程后简单地调用了 wait(NULL)。现在，我检查 '&' 字符作为最后一个参数，如果它在那里，通过不调用 wait(NULL) 在后台运行进程，并且进程可以在后台愉快地运行，我将返回到我的 shell。

这一切正常（我认为），现在的问题是我还需要以某种方式调用 wait() （或 waitpid() ？），以便后台进程不会保持“僵尸”状态。那是我的问题，我不知道该怎么做...

我相信我必须处理 SIGCHLD 并在那里做一些事情，但我还没有完全理解什么时候发送 SIGCHLD 信号，因为我试图也将 wait(NULL) 添加到 childSignalHandler() 但它没有工作，因为我在后台执行了一个进程，调用了 childSignalHandler() 函数，因此调用了 wait(NULL)，这意味着在“后台”进程完成之前我无法对我的 shell 执行任何操作。由于信号处理程序中的等待，它不再在后台运行。

我在这一切中缺少什么？

最后一件事，这个练习的一部分，我还需要打印进程状态的变化，比如进程终止。因此，对此的任何见解也非常感谢。

这是我目前的完整代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <wait.h>
#include <signal.h>
#include <sys/types.h>

#include "data.h" // Boolean typedef and true/false macros

void childSignalHandler(int signum) {
    //
}

int main(int argc, char **argv) {
    char bBuffer[BUFSIZ], *pArgs[10], *aPtr = NULL, *sPtr;
    bool background;
    ssize_t rBytes;
    int aCount;
    pid_t pid;

    //signal(SIGINT, SIG_IGN);

    signal(SIGCHLD, childSignalHandler);

    while(1) {
        write(1, "\e[1;31mmyBash \e[1;32m# \e[0m", 27);
        rBytes = read(0, bBuffer, BUFSIZ-1);

        if(rBytes == -1) {
            perror("read");
            exit(1);
        }

        bBuffer[rBytes-1] = '\0';

        if(!strcasecmp(bBuffer, "exit")) {
            exit(0);
        }

        sPtr = bBuffer;
        aCount = 0;

        do {
            aPtr = strsep(&sPtr, " ");
            pArgs[aCount++] = aPtr;
        } while(aPtr);

        background = FALSE;

        if(!strcmp(pArgs[aCount-2], "&")) {
            pArgs[aCount-2] = NULL;
            background = TRUE;
        }

        if(strlen(pArgs[0]) > 1) {
            pid = fork();

            if(pid == -1) {
                perror("fork");
                exit(1);
            }

            if(pid == 0) {
                execvp(pArgs[0], pArgs);
                exit(0);
            }

            if(!background) {
                wait(NULL);
            }
        }
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T23:53:57.137

有多种选择可以`waitpid()`帮助您（来自 POSIX 标准的引用）：

> W续
> 
> waitpid() 函数应报告 pid 指定的任何继续子进程的状态，该子进程的状态自作业控制停止后继续未报告。
> 
> 万航
> 
> 如果 pid 指定的子进程之一不能立即获得状态，则 waitpid() 函数不应暂停调用线程的执行。

特别是，WNOHANG 将允许您查看是否有任何尸体要收集，而不会导致您的进程阻塞等待尸体。

> 如果调用进程设置了 SA_NOCLDWAIT 或 SIGCHLD 设置为 SIG_IGN，并且该进程没有转化为僵尸进程的未等待子进程，则调用线程将阻塞，直到包含调用线程的进程的所有子进程终止，并且wait() 和 waitpid() 将失败并将 errno 设置为 [ECHILD]。

您可能不想忽略 SIGCHLD 等，并且您的信号处理程序可能应该设置一个标志来告诉您的主循环“糟糕；有死孩子 - 去收集那具尸体！”。

SIGCONT 和 SIGSTOP 信号也与您相关——它们分别用于重新启动和停止子进程（在这种情况下，无论如何）。

我建议看一下 Rochkind 的书或 Stevens 的书——它们详细介绍了这些问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T00:12:54.400

这应该让你开始。主要区别在于我摆脱了子处理程序并`waitpid`在主循环中添加了一些反馈。经过测试和工作，但显然需要更多的 TLC。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <strings.h>
#include <unistd.h>
#include <wait.h>
#include <signal.h>
#include <sys/types.h>

int main(int argc, char **argv) {
        char bBuffer[BUFSIZ], *pArgs[10], *aPtr = NULL, *sPtr;
        int background;
        ssize_t rBytes;
        int aCount;
        pid_t pid;
        int status;
        while(1) {
                pid = waitpid(-1, &status, WNOHANG);
                if (pid > 0)
                        printf("waitpid reaped child pid %d\n", pid);
                write(1, "\e[1;31mmyBash \e[1;32m# \e[0m", 27);
                rBytes = read(0, bBuffer, BUFSIZ-1);
                if(rBytes == -1) {
                        perror("read");
                        exit(1);
                }
                bBuffer[rBytes-1] = '\0';
                if(!strcasecmp(bBuffer, "exit")) 
                        exit(0);
                sPtr = bBuffer;
                aCount = 0;
                do {
                        aPtr = strsep(&sPtr, " ");
                        pArgs[aCount++] = aPtr;
                } while(aPtr);
                background = (strcmp(pArgs[aCount-2], "&") == 0);
                if (background)
                        pArgs[aCount-2] = NULL;
                if (strlen(pArgs[0]) > 1) {
                        pid = fork();
                        if (pid == -1) {
                                perror("fork");
                                exit(1);
                        } else if (pid == 0) {
                                execvp(pArgs[0], pArgs);
                                exit(1);
                        } else if (!background) {
                                pid = waitpid(pid, &status, 0);
                                if (pid > 0)
                                        printf("waitpid reaped child pid %d\n", pid);
                        }
                }
        }
        return 0;
} 
```

**编辑：**`waitpid()`使用 WNOHANG重新添加信号处理并不困难。这就像将`waitpid()`内容从循环顶部移动到信号处理程序中一样简单。但是，您应该注意两件事：

首先，即使是“前台”进程也会发送 SIGCHLD。由于只能有一个前台进程，`fork()`如果您想对前台与后台进行特殊处理，您可以简单地将前台 pid（父进程的返回值 from ）存储在信号处理程序可见的变量中。

其次，您当前正在标准输入（`read()`主循环顶部）上阻塞 I/O。当 SIGCHLD 发生时，您极有可能被阻塞`read()`，从而导致系统调用中断。根据操作系统，它可能会自动重新启动系统调用，或者它可能会发送您必须处理的信号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-07T09:58:28.897

您可以使用：

```
if(!background)
    pause(); 
```

这样，进程会阻塞直到它接收到`SIGCHLD`信号，而信号处理程序将做等待的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T16:24:38.590

我没有使用全局变量，而是想到了一个不同的解决方案：

```
if(!background) {
    signal(SIGCHLD, NULL);

    waitpid(pid, NULL, 0);

    signal(SIGCHLD, childSignalHandler);
} 
```

如果我正在运行前台进程，请“删除” SIGCHLD 的处理程序，这样它就不会被调用。然后，在 waitpid() 之后，再次设置处理程序。这样，只会处理后台进程。

你认为这个解决方案有什么问题吗？

# javascript - Cocoa - 防止在 WebKit 中缓存 Javascript - Safari Beta 4 错误？

> ID：900415
> 
> 赞同：4
> 
> 时间：2009-05-22T23:28:48.903
> 
> 标签：javascript, html, cocoa, caching, webkit

我有一个包含 WebView 的 Cocoa 应用程序。由于应用程序已安装客户群，我的目标是 10.4 SDK。（即我不能要求 Leopard。）

我有两个文件：index.html 和 data.js。

在运行时，为了响应用户输入，我通常会覆盖 data.js 文件，并使用来自应用程序的当前数据填充它。

（index.html 文件在正文加载时使用 data.js 文件来填充 index.html 中的表。index.html 本身不会被修改。）

为了（据说）防止 WebKit 缓存我经常变化的数据，我调用：

```
NSURLRequest *urlRequest = [NSURLRequest requestWithURL:indexFileURL cachePolicy: NSURLRequestReloadIgnoringCacheData timeoutInterval:10]; 
```

和

```
[[myWebView mainFrame] loadRequest: urlRequest]; 
```

这在 Tiger 和 Leopard 中效果很好。

但是，如果安装了 Safari Beta 4，它会在 Leopard 中失败。在 webview 中绘制 index.html 文件不考虑当前对 data.js 文件的更改。无论 URL 的缓存策略如何，似乎实际上都在缓存 javascript 文件 (data.js)。

作为一种解决方法，我尝试在 loadRequest 之后调用 [[myWebView mainFrame] reload]，但这会导致其他问题。（网络视图根本没有更新。）

任何人都可以提出解决或解决此行为的方法吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T23:55:24.263

不是解决方案，而是可能有效的解决方法：

尝试在您的 URL 中添加类似“?version=some_random_number”的内容，每次重新加载时使用不同的随机数。以我的经验，这在强制 webkit 重新加载方面非常有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T23:53:19.103

[刚刚关闭这个]

无论缓存标志如何，Javascript 仍在 Safari 4 final 中缓存。令人失望，尤其是考虑到这是已知问题。我强烈怀疑浏览器大战中对营销点和测试分数的需求已经超过了对正常工作代码的需求。

但是，解决方法（请参阅下面的评论）确实有效。

# unix - 在unix下将视频流MPEGTS（H264）分割成文件块

> ID：900416
> 
> 赞同：2
> 
> 时间：2009-05-22T23:28:51.883
> 
> 标签：unix, video, streaming, ffmpeg

问：如何将 MPEGTS(H264) 视频流分割成文件块？

寻找将编码为 H264 的 MPEGTS 视频流分割成精确文件块的方法。挑战在于流需要 24/7 保存，并且不应该丢失任何数据。

考虑split(1)，但是视频帧有问题。如果视频帧在中间被剪切，那么视频数据就会丢失。

另一个问题是关键帧...

现在我正在考虑 split(1) 的一些分支，它对标记（关键帧的开头）做出反应并在此之后剪切。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T23:39:05.763

从[这里](http://www.misterhowto.com/index.php?category=Computers&subcategory=Video&article=trim_or_split_with_mencoder)：

> Mencoder 可以轻松修剪文件的结尾或开头，或将其拆分为多个部分。

Mencoder 可以在[这里](http://www.mplayerhq.hu/)找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-28T14:57:59.603

它实际上可以用分段器轻松完成 [http://svn.assembla.com/svn/legend/segmenter/segmenter.c](http://svn.assembla.com/svn/legend/segmenter/segmenter.c)

# ruby - 如何理解 class_eval() 和 instance_eval() 的区别？

> ID：900419
> 
> 赞同：64
> 
> 时间：2009-05-22T23:32:21.487
> 
> 标签：ruby, class-method, instance-method

```
Foo = Class.new
Foo.class_eval do
  def class_bar
    "class_bar"
  end
end
Foo.instance_eval do
  def instance_bar
    "instance_bar"
  end
end
Foo.class_bar       #=> undefined method ‘class_bar’ for Foo:Class
Foo.new.class_bar   #=> "class_bar"
Foo.instance_bar       #=> "instance_bar"
Foo.new.instance_bar   #=> undefined method ‘instance_bar’ for #<Foo:0x7dce8> 
```

仅基于方法的名称，**我希望 class_eval 允许您向 Foo 添加一个类方法，而 instance_eval 允许您向 Foo 添加一个实例方法。但他们似乎反其道而行之**。

在上面的例子中，如果你在 Foo 类上调用 class_bar，你会得到一个未定义的方法错误，如果你在 Foo.new 返回的实例上调用 instance_bar，你也会得到一个未定义的方法错误。这两个错误似乎都与对 class_eval 和 instance_eval 应该做什么的直观理解相矛盾。

**这些方法之间的真正区别是什么？**

[class_eval](http://www.ruby-doc.org/core-1.8.6/classes/Module.html#M001673)的文档：

> mod.class_eval(string [, filename [, lineno]]) => obj
> 
> *在 mod 的上下文中评估字符串或块。这可用于向类添加方法。*

[instance_eval](http://www.rubybrain.com/api/ruby-1.8.7/doc/index.html?a=M000295&name=instance_eval)的文档：

> obj.instance_eval {| | 块 } => 对象
> 
> *在接收器 (obj) 的上下文中评估包含 Ruby 源代码或给定块的字符串。为了设置上下文，在代码执行时将变量 self 设置为 obj，从而使代码可以访问 obj 的实例变量。*

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-05-23T00:16:39.010

正如文档所说，`class_eval`在模块或类的上下文中评估字符串或块。所以下面的代码是等价的：

```
class String
  def lowercase
    self.downcase
  end
end

String.class_eval do
  def lowercase
    self.downcase
  end
end 
```

在每种情况下，都重新打开了 String 类并定义了一个新方法。该方法适用于该类的所有实例，因此：

```
"This Is Confusing".lowercase 
=> "this is confusing"
"The Smiths on Charlie's Bus".lowercase
=> "the smiths on charlie's bus" 
```

`class_eval`与简单地重新开放课程相比具有许多优势。首先，您可以轻松地在变量上调用它，并且很清楚您的意图是什么。另一个优点是，如果该类不存在，它将失败。所以下面的例子会因为`Array`拼写错误而失败。如果简单地重新打开该类，它将成功（并且`Aray`将定义一个新的不正确的类）：

```
Aray.class_eval do
  include MyAmazingArrayExtensions
end 
```

finally`class_eval`可以带一个字符串，如果您正在做一些更邪恶的事情，这可能会很有用......

`instance_eval`另一方面，针对单个对象实例评估代码：

```
confusing = "This Is Confusing"
confusing.instance_eval do
  def lowercase
    self.downcase
  end
end   

confusing.lowercase
=> "this is confusing"
"The Smiths on Charlie's Bus".lowercase
NoMethodError: undefined method ‘lowercase’ for "The Smiths on Charlie's Bus":String 
```

因此，使用`instance_eval`，该方法仅针对字符串的单个实例定义。

那么为什么要`instance_eval`定义`Class`类方法呢？

正如`"This Is Confusing"`和`"The Smiths on Charlie's Bus"`都是`String`实例一样`Array`，`String`,`Hash`和所有其他类本身都是 的实例`Class`。您可以通过调用`#class`它们来检查：

```
"This Is Confusing".class
=> String

String.class
=> Class 
```

因此，当我们调用`instance_eval`它时，它在类上的作用与在任何其他对象上的作用相同。如果我们使用`instance_eval`在一个类上定义一个方法，它将只为该类的实例定义一个方法，而不是所有类。我们可以将该方法称为类方法，但它只是该特定类的实例方法。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-08-23T10:08:46.867

另一个答案是正确的，但请允许我深入一点。

Ruby 有多种不同的作用域。根据[维基百科](http://en.wikipedia.org/wiki/Ruby_%28programming_language%29#Features)，有六个，但似乎缺乏详细的正式文档。毫不奇怪，这个问题涉及的范围类型是**instance**和**class**。

当前实例范围由 的值定义`self`。所有不合格的方法调用都被调度到当前实例，对实例变量的任何引用（看起来像`@this`）也是如此。

但是，`def`不是方法调用。by 创建的方法的目标`def`是当前类（或模块），可以使用`Module.nesting[0]`.

让我们看看两种不同的 eval 风格如何影响这些范围：

`String.class_eval { [self, Module.nesting[0]] } => [String, String] String.instance_eval { [self, Module.nesting[0]] } => [String, #<Class:String>]`

在这两种情况下，实例范围都是调用 *_eval 的对象。

对于`class_eval`，类范围也成为目标对象，因此`def`为该类/模块创建实例方法。

对于`instance_eval`，类范围成为目标对象的**单例类**（又名元类、特征类）。在对象的单例类上创建的实例方法成为该对象的单例方法。类或模块的单例方法通常（并且有些不准确）称为**类方法**。

类范围也用于解析常量。类变量 ( `@@these @@things`) 在类范围内解析，但在搜索模块嵌套链时它们会跳过单例类。我发现访问单例类中的类变量的唯一方法是使用`class_variable_get/set`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T23:50:32.683

我想你弄错了。class_eval 在类中添加方法，所以所有实例都会有方法。instance_eval 只会将该方法添加到一个特定对象。

```
foo = Foo.new
foo.instance_eval do
  def instance_bar
    "instance_bar"
  end
end

foo.instance_bar      #=> "instance_bar"
baz = Foo.new
baz.instance_bar      #=> undefined method 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-23T00:10:27.197

instance_eval 有效地为有问题的对象实例创建了一个单例方法。class_eval 将在给定类的上下文中创建一个普通方法，该方法可用于该类的所有对象。

这是关于[单例方法](http://www.rubyist.net/~slagell/ruby/singletonmethods.html)和[单例模式](http://en.wikipedia.org/wiki/Singleton_pattern)的链接（非 ruby​​ 特定的）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-05-07T05:36:52.057

`instance_eval`并`class_eval`允许您执行一大段代码。那你可能会说什么？老式的`eval`可以做到这一点。但是`instance_eval`并`class_eval`接受代码块的块参数。所以代码块不需要是字符串。还允许接收器（`instance_eval`与`class_eval`旧的不同`eval`）。因此，您可以在类对象甚至实例对象上调用这两个现代方法。

```
class A
end

A.instance_eval do
  # self refers to the A class object
  self
end

a = A.new

a.instance_eval do
  # self refers to the a instance object
  self
end 
```

还要记住，在 ruby​​ 中，如果我们调用一个没有接收器的方法，那么该方法将被调用 on `self`，在`instance_eval`块中是我们调用的对象`instance_eval`。实例变量在 ruby​​ 中是私有的。您不能在定义它们的类之外访问它们。但是由于实例变量存储在 中`self`，我们可以在其中访问它们`instance_eval`（这同样适用于不能用接收器调用的私有方法）：

```
class A
  def initialzie
    @a = “a”
  end

  private

  def private_a
    puts “private a”
  end
end

a = A.new
puts a.instance_eval {  @a }
# => “a”
puts a.instance_eval {  private_a }
# => “private a” 
```

我们还可以在`instance_eval`和中为接收者添加方法`class_eval`。在这里，我们将其添加到`instance_eval`：

```
class A
end

A.instance_eval do
  def a_method
    puts “a method”
  end
end

A.a_method
# =>  a method 
```

现在想想我们刚刚做了什么。我们使用`instance_eval`，在其中定义了一个方法`block`，然后在类对象本身上调用该方法。这不是类方法吗？如果您愿意，可以将其视为“类”方法。但是我们所做的只是在`instance_eval`块中的接收器上定义一个方法，而接收器恰好是`A`. 我们可以很容易地在实例对象上做同样的事情：

```
 a.instance_eval do
  def a_method
    puts "a method"
  end
end

a.a_method
# => a method 
```

它的工作原理是一样的。不要将类方法视为其他语言中的类方法。它们只是在 上定义的方法`self`，而`self`恰好是一个类对象（从`Class.new`as in扩展`class A end`）。

但我想把这个答案比接受的答案更深入一点。`instance_eval`实际上将您放入其中的方法粘贴在哪里？他们进入`singleton`接收者的班级！一旦您`instance_eval`在接收器上调用，ruby 解释器就会打开`singleton_class`并将块中定义的方法放在 this`singleton_class`中。就像`extend`在类中使用一样（因为extend打开了单例类，并将传递给扩展的模块中的方法放入单例类中）！它打开了`singleton_class`，它是继承层次结构的一部分（就在父类之前）：`A -> singleton_class -> Parent`

现在有什么`class_eval`不同？`class_eval`只能在类和模块上调用。`self`仍然指的是接收者：

```
class A
end

A.class_eval do
  # self is A
  self
end 
```

但与 不同`instance_eval`的是，当您在`class_eval`块中定义方法时，它们将在类的实例而不是类对象本身上可用。使用`class_eval`，方法不会添加到继承层次结构中的单例类中。相反，方法被添加到`current class`接收者的！因此，当您在 中定义方法时`class_eval`，该方法直接进入`current class`，因此它成为实例方法。所以你不能在类对象上调用它；您只能在类对象的实例上调用它。

# python - 比较序列的优雅方式

> ID：900420
> 
> 赞同：12
> 
> 时间：2009-05-22T23:32:56.510
> 
> 标签：python

python 是否提供了一种优雅的方式来检查不同类型序列的“相等性”？以下工作，但对于 python 代码，它们看起来相当丑陋和冗长：

```
def comp1(a, b):
    if len(a) != len(b):
        return False
    for i, v in enumerate(a):
        if v != b[i]:
            return False
    return True 
```

由于创建了第三个序列，以下内容有点短，但效率也较低：

```
def comp2(a, b):
    for l, r in map(None, a, b):
        if l != r:
            return False
    return True 
```

将这些示例中的一个硬塞到列表理解中也不是我真正想要的。

编辑：理想情况下，我正在寻找一种在比较期间不会创建另一个序列的解决方案。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-22T23:36:48.747

将两个序列都转换为列表，并使用内置列表比较。这应该足够了，除非你的序列真的很大。

```
list(a) == list(b) 
```

编辑：

schickb 所做的测试表明使用元组稍微快一些：

```
tuple(a) == tuple(b) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-22T23:45:37.840

您可以使用以下命令确定任何两个可迭代对象（字符串、元组、列表，甚至自定义序列）的相等性，而无需创建和存储重复列表：

```
all(x == y for x, y in itertools.izip_longest(a, b)) 
```

请注意，如果两个可迭代的长度不同，则较短的将用`None`s 填充。换句话说，它会认为`[1, 2, None]`等于`(1, 2)`。

**编辑：**正如 Kamil 在评论中指出的那样，`izip_longest`仅在 Python 2.6 中可用。但是，[该函数的文档](http://docs.python.org/library/itertools.html#itertools.izip_longest)还提供了一个替代实现，它应该可以一直工作到 2.3。

**编辑2：**在几台不同的机器上进行测试后，看起来这只比`list(a) == list(b)`某些情况下更快，我无法隔离。大多数时候，它需要大约七倍的时间。但是，我还发现它始终比该版本`tuple(a) == tuple(b)`快两倍。`list`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-08-09T12:30:27.717

除了创建临时列表/元组使用的额外内存外，当不等式发生在序列的早期时，这些答案将输给大序列的短路生成器解决方案

```
from itertools import starmap, izip
from operator import eq
all(starmap(eq, izip(x, y))) 
```

或更简洁地说

```
from itertools import imap
from operator import eq
all(imap(eq, x, y)) 
```

来自 ipython 的一些基准测试

```
x=range(1000)
y=range(1000); y[10]=0

timeit tuple(x) == tuple(y)
100000 loops, best of 3: 16.9 us per loop

timeit all(imap(eq, x, y))
100000 loops, best of 3: 2.86 us per loop 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-23T00:34:34.263

看起来 tuple(a) == tuple(b) 是最好的整体选择。或者也许与前面的 len 进行元组比较，检查它们是否经常是不同的长度。这确实会创建额外的列表，但除了非常庞大的列表之外，希望这不是问题。这是我对建议的各种替代方案的比较：

```
import timeit

tests = (
'''
a=b=[5]*100
''',

'''
a=[5]*100
b=[5]*3
''',

'''
a=b=(5,)*100
''',

'''
a=b="This on is a string" * 5
''',

'''
import array
a=b=array.array('B', "This on is a string" * 5)
'''
)

common = '''import itertools
def comp1(a, b):
    if len(a) != len(b):
        return False
    for i, v in enumerate(a):
        if v != b[i]:
            return False
    return True'''

for i, setup in enumerate(tests):
    t1 = timeit.Timer("comp1(a, b)", setup + common)
    t2 = timeit.Timer("all(x == y for x, y in itertools.izip_longest(a, b))", setup + common)
    t3 = timeit.Timer("all([x == y for x, y in itertools.izip_longest(a, b)])", setup + common)
    t4 = timeit.Timer("list(a) == list(b)", setup + common)
    t5 = timeit.Timer("tuple(a) == tuple(b)", setup + common)

    print '==test %d==' % i
    print '   comp1: %g' % t1.timeit()
    print ' all gen: %g' % t2.timeit()
    print 'all list: %g' % t3.timeit()
    print '    list: %g' % t4.timeit()
    print '   tuple: %g\n' % t5.timeit() 
```

结果如下：

```
==test 0==
   comp1: 27.8089
 all gen: 31.1406
all list: 29.4887
    list: 3.58438
   tuple: 3.25859

==test 1==
   comp1: 0.833313
 all gen: 3.8026
all list: 33.5288
    list: 1.90453
   tuple: 1.74985

==test 2==
   comp1: 30.606
 all gen: 31.4755
all list: 29.5637
    list: 3.56635
   tuple: 1.60032

==test 3==
   comp1: 33.3725
 all gen: 35.3699
all list: 34.2619
    list: 10.2443
   tuple: 10.1124

==test 4==
   comp1: 31.7014
 all gen: 32.0051
all list: 31.0664
    list: 8.35031
   tuple: 8.16301 
```

**编辑：**添加了更多测试。这是在具有 2GB 内存的 AMD 939 3800+ 上运行的。Linux 32 位，Python 2.6.2

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T00:03:33.670

由于您将“平等”一词放在引号中，因此我假设您想知道列表的相同之处以及不同之处。查看具有 SequenceMatcher 类的**difflib ：**

```
 sm = difflib.SequenceMatcher(None, a, b)
    for opcode in sm.get_opcodes():
        print "    (%s %d:%d %d:%d)" % opcode 
```

您将获得一系列关于差异的描述。将其转换为**类似 diff**的输出相当简单。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-09T23:01:38.413

我认为当两个序列都是 type 时，特殊情况是个好主意`list`。比较两个列表比将两者都转换为元组更快（并且内存效率更高）。

在其中一个`a`或`b`不是列表的情况下，它们都被转换为`tuple`. 如果一个或两个已经是元组，则没有开销，因为`tuple()`在这种情况下只返回对原始对象的引用。

```
def comp(a, b):
    if len(a) != len(b):
        return False
    if type(a) == type(b) == list:
        return a == b
    a = tuple(a)
    b = tuple(b)
    return a == b 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-23T00:05:15.837

它可能效率不高，但看起来很时髦：

```
def cmpLists(a, b):
    return len(a) == len(b) and (False not in [a[i] == b[i] for i in range(0,len(a)]) 
```

我不知道[Ben 提到](https://stackoverflow.com/questions/900420/elegant-way-to-compare-sequences/900444#900444)的“全部”功能，但也许您可以使用它而不是“False not in”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-24T12:29:19.843

这个“功能性”代码应该足够快速和通用，适用于所有目的。

```
# python 2.6 ≤ x < 3.0
import operator, itertools as it

def seq_cmp(seqa, seqb):
    return all(it.starmap(operator.eq, it.izip_longest(seqa, seqb))) 
```

如果在 Python 2.5 上，请使用 izip_longest from [there](http://docs.python.org/library/itertools.html#itertools.izip_longest)的定义。

# .net - .Net Webservice 不会接受 XML 调用的参数

> ID：900422
> 
> 赞同：0
> 
> 时间：2009-05-22T23:33:23.730
> 
> 标签：.net, jquery, xml, ajax, web-services

出于某种原因，我的网络服务不喜欢我发送的数据。我不断收到以下错误：

```
System.InvalidOperationException: Request format is invalid: text/xml; charset=utf-8. 
```

在 System.Web.Services.Protocols.HttpServerProtocol.ReadParameters() 在 System.Web.Services.Protocols.WebServiceHandler.CoreProcessRequest()

有任何想法吗？

这是我的代码：

```
$.ajax({
    type: "POST",
    url: "/wsCheckout.asmx/loginUser",
    data: "userName=" + userName + "&pw=" + pw,
    contentType: "text/xml; charset=utf-8",
    dataType: "xml",
    cache: false,
    beforeSend: function(n){ showLoading(); },
    complete: function(n){ hideLoading(); },
    success: function(r) {        
      if( checkResponse(r) == true ){ 
        closeBox(aspxIdPrefix + "login");
        hideBox(aspxIdPrefix + "login");        
        openBox("#shippingAddress");     
      }           
    } // end success
}); //end AJAX

[WebMethod(EnableSession = true)]
[System.Web.Script.Services.ScriptMethod(ResponseFormat = System.Web.Script.Services.ResponseFormat.Xml)]
public DataTable loginUser(string userName, string pw)
{
......
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T23:55:34.670

data 选项将参数作为查询字符串 (GET) 而不是 post 传递，并且内容类型需要是 application/json。这是完整的语法。

```
$.ajax({
    type: "POST",
    url: "/wsCheckout.asmx/loginUser",
    data: "{userName:'" + userName + "',pw:'" + pw+"'}",
    contentType: "application/json; charset=utf-8",
    dataType: "xml",
    cache: false,
    beforeSend: function(n){ showLoading(); },
    complete: function(n){ hideLoading(); },
    success: function(r) {        
      if( checkResponse(r) == true ){ 
        closeBox(aspxIdPrefix + "login");
        hideBox(aspxIdPrefix + "login");        
        openBox("#shippingAddress");     
      }           
    } // end success
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T23:54:31.490

我建议你试试[soapUI](http://soapui.org/)。使用它来发送请求，并观察响应。查看soapUI 发送的请求是什么样的。然后尝试发送相同的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T17:33:21.387

您实际上并未将 XML 数据发送到您的 Web 服务。目前，鉴于您的示例代码片段，您以标准 HTML 表单编码格式发送：

```
field1=value1&field2=value2&field3=value3 
```

您可能需要将数据更改为 xml，如下所示：

```
'<data><userName>' + userName + '</userName><pw>' + pw + '</pw></data>' 
```

要执行后者，您还需要将 Web 服务签名更改为采用单个字符串，该字符串稍后会被反序列化：

```
[XmlRoot("data")]
public class UserRequestData
{
    public string userName { get; set; }
    public string pw { get; set; }
}

[WebMethod(EnableSession = true)]
[System.Web.Script.Services.ScriptMethod(ResponseFormat = System.Web.Script.Services.ResponseFormat.Xml)]
public DataTable loginUser(string xmlUserRequest)
{
    XmlSerializer serializer = new XmlSerializer(typeof(UserRequestData));
    StringReader reader = new StringReader(xmlUserRequest);
    UserRequestData data = serializer.Deserialize(reader);

    string userNme = data.UserName;
    string pw = data.Pw;
......
} 
```

可能还需要注意的是，您使用以下属性修饰了服务方法：

```
[System.Web.Script.Services.ScriptMethod(ResponseFormat = System.Web.Script.Services.ResponseFormat.Xml)] 
```

与您的服务方法的返回值有关，而不是输入数据。通过用它进行装饰，您的 RESPONSE 将被格式化为 xml。这不会影响您的服务的输入。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T12:59:35.607

如果您想通过 JSON 返回序列化的 .Net 对象，您需要做一些事情。假设您使用的是 jQuery ajax 调用，它应该*可以正常工作*（在对下面提到的服务进行更改之后），因为 jQuery 为您附加了回调参数。如果您不使用 jQuery，只需自己附加回调参数，指向您希望在成功时调用的任何 js 函数。

*   装饰您的操作合同设置 ResponseFormat.WebMessageForm.Json（例如`[WebGet(BodyStyle = WebMessageBodyStyle.WrappedRequest,ResponseFormat = WebMessageFormat.Json,RequestFormat = WebMessageFormat.Json)]`）
*   创建一个继承自 Stream 的类（见下文）：

    ```
    public class JSONCallbackStream : Stream 
    ```

    { 私人流 _stream;

    ```
    private string _callbackFunction = string.Empty;

    public JSONCallbackStream(Stream stream)
    {
        _stream = stream;
    }

    public override bool CanRead
    {
        get { return _stream.CanRead; }
    }

    public override bool CanSeek
    {
        get { return _stream.CanSeek; }
    }

    public override bool CanWrite
    {
        get { return _stream.CanWrite; }
    }

    public override long Length
    {
        get { return _stream.Length; }
    }

    public override long Position
    {
        get { return _stream.Position; }
        set { _stream.Position = value; }
    }

    public string CallbackFunction
    {
        get { return _callbackFunction; }
        set { _callbackFunction = value; }
    }

    public override void Flush()
    {
        _stream.Flush();
    }

    public override int Read(byte[] buffer, int offset, int count)
    {
        return _stream.Read(buffer, offset, count);
    }

    public override long Seek(long offset, SeekOrigin origin)
    {
        return _stream.Seek(offset, origin);
    }

    public override void SetLength(long value)
    {
        _stream.SetLength(value);
    }

    public override void Write(byte[] buffer, int offset, int count)
    {
        if (CallbackFunction != string.Empty)
        {
            // This MUST be a one-time write to the underlying stream - any more than 1 write means
            // that the stream will be truncated/an exception could be thrown
            string content = CallbackFunction + "(" + Encoding.UTF8.GetString(buffer) + ");";
            byte[] contentBytes = Encoding.UTF8.GetBytes(content);
            _stream.Write(contentBytes, 0, Encoding.UTF8.GetMaxCharCount(contentBytes.Length));
        }
        else
        {
            _stream.Write(buffer, offset, count);
        }
    } 
    ```

    }

*   创建一个从 IHttpModule 继承的类，并确保在 system.web -> httpModules （如果在 IIS 7 上还有 system.webServer -> modules）下的 web.config 中有条目，请参见下面的类：

    ```
    public class JSONCallback : IHttpModule 
    ```

    {公共无效处置（）{}

    ```
    //looks for a callback parameter, if found it wraps the return in the callback string
    public void Init(HttpApplication app)
    {
        app.BeginRequest += delegate
        {
            HttpContext ctx = HttpContext.Current;

            if ((ctx.Request.RequestType.ToUpper() == "GET"))
            {
                string[] parameters = ctx.Request.QueryString.GetValues("callback");

                if (parameters != null && parameters.Length == 1)
                {
                    JSONCallbackStream _captureStream = new JSONCallbackStream(ctx.Response.Filter);
                    _captureStream.CallbackFunction = parameters[0];

                    ctx.Response.Filter = _captureStream;
                }
            }
        };

    } 
    ```

    }

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T08:25:57.663

试试这个：

```
contentType: "text/xml; charset=\"utf-8\"", 
```

# iphone - 有没有人有一种将文本滚动到一侧的好方法，例如 iphone 应用程序中笔尖标签中的股票行情？

> ID：900425
> 
> 赞同：0
> 
> 时间：2009-05-22T23:36:01.743
> 
> 标签：iphone, cocoa-touch, scroll, horizontal-scrolling

我想从右侧开始滚动文本并使其平滑地向左移动并离开屏幕。有没有人有他们尝试过的东西的例子？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T01:29:53.373

[这个问题](https://stackoverflow.com/questions/430942/resizable-uilabel-which-scrolls-across-the-screen)是在问一些非常接近你想做的事情。那里提供的答案，加上[这个问题](https://stackoverflow.com/questions/419710/how-do-i-pan-the-image-inside-a-uiimageview)的答案中描述的方法，应该可以让您以流畅的动画方式滚动文本。

# mvvm - RelayCommand lambda 语法问题

> ID：900437
> 
> 赞同：0
> 
> 时间：2009-05-22T23:40:14.653
> 
> 标签：mvvm, lambda, relaycommand

我正在应用 Josh Smith 的 MVVM 模式并且遇到了困难。我一直在这里研究这个问题，但似乎无法完全正确地使用语法。

在我看来，下面的代码遵循了所需的语法，但 Visual Studio 在指示的行上报告错误**“Delegate 'System.Action' does not take '2' arguments”**。

有人可以看到我在哪里犯了错误吗？谢谢！
+汤姆

```
 RelayCommand _relayCommand_MoveUp;
    public ICommand RelayCommand_MoveUp
    {
      get
      {
        if (_relayCommand_MoveUp == null)
        {
          _relayCommand_MoveUp = new RelayCommand(
          (sender, e) => this.Execute_MoveUp(sender, e),     **ERROR REPORTED HERE**
          (sender, e) => this.CanExecute_MoveUp(sender, e));
          return _relayCommand_MoveUp;
        }
      }
    }

    private void Execute_MoveUp(object sender, ExecutedRoutedEventArgs e)
    {
      if (_selectedFolder != null)
      {
        _selectedFolder.SelectParent();
      }
    }

    private void CanExecute_MoveUp(object sender, CanExecuteRoutedEventArgs e)
    {
      e.CanExecute = (_selectedFolder != null) && (_selectedFolder.Parent != null);
        }

//And from Josh Smith:

  public class RelayCommand : ICommand
  {
    public RelayCommand(Action<object> execute);
    public RelayCommand(Action<object> execute, Predicate<object> canExecute);

    public event EventHandler CanExecuteChanged;

    [DebuggerStepThrough]
    public bool CanExecute(object parameter);
    public void Execute(object parameter);
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-25T04:35:39.440

本周末（8 月 22 日）Josh Smith 为他的 MvvmFoundation 项目在 codeplex 中签入了新的更改，该项目更改了 RelayCommand 为具有参数的代表工作的方式。谨防！

要将参数传递给委托，您需要使用他的新 RelayCommand<T> 构造函数：

```
 public ICommand GotoRegionCommand
    {
        get
        {
            if (_gotoRegionCommand == null)
                _gotoRegionCommand = new RelayCommand<String>(GotoRegionCommandWithParameter);
            return _gotoRegionCommand;
        }
    }
    private void GotoRegionCommandWithParameter(object param)
    {
        var str = param as string;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T23:58:59.077

RelayCommand 不是 RoutedCommand，我认为这是您最终感到困惑的地方。

Relay 命令的构造函数采用[Action 委托](http://msdn.microsoft.com/en-us/library/018hxwa8.aspx)和可选的[Predicate 委托](http://msdn.microsoft.com/en-us/library/bfcke1bz.aspx)。这些委托不采用 EventArgs，仅采用单个 Object 参数，这就是您遇到错误的原因。谓词还需要返回类型为 bool，这是您将得到的下一个错误。在 CanExecute 谓词中，而不是像使用 RoutedCommand 那样设置 e.CanExecute，您只需返回 true/false。

这是它的外观：

```
public ICommand RelayCommand_MoveUp
{
  get
  {
    if (_relayCommand_MoveUp == null)
    {
      _relayCommand_MoveUp = new RelayCommand(Execute_MoveUp, CanExecute_MoveUp);

    }
    return _relayCommand_MoveUp;
  }
}

private void Execute_MoveUp(object sender)
{
  if (_selectedFolder != null)
  {
    _selectedFolder.SelectParent();
  }
}

private void CanExecute_MoveUp(object sender)
{
  return (_selectedFolder != null) && (_selectedFolder.Parent != null);
} 
```

**编辑（从评论中的讨论中添加）：**

如果您想使用更像 RoutedCommands 的东西，这将使 ViewModels 更依赖于 WPF 特定视图，有一些不错的选项可用。

这个[讨论](http://groups.google.com/group/wpf-disciples/browse_thread/thread/40f387caac2f1e13?pli=1)开始了将 RoutedCommands 与 MVVM 结合使用的整个想法。

这是 Josh Smith 和 Bill Kempf 提出的问题[的一个非常可靠的解决方案。](http://www.codeproject.com/KB/WPF/VMCommanding.aspx)

# database - SQLite.NET 和 SQL Server Compact 的优缺点

> ID：900438
> 
> 赞同：7
> 
> 时间：2009-05-22T23:40:39.193
> 
> 标签：database, sqlite, sql-server-ce, system.data.sqlite

我已经多次使用 SQLite.NET。它总是运行良好，但我有一个朋友真的很困扰我，我应该改用 SQL Server Compact，所以我完全留在了 Microsoft 环境中。

现在，我从未与 Compact 合作过，他告诉我这对他来说很好用，但看到 .MDF 扩展名让我毛骨悚然。不开玩笑。我想要的最后一件事是我的应用程序依赖于 Access 数据库。

由于我从未真正使用过它，我想问这里是否有人知道它来担保它，是否有人能告诉我它们之间的主要区别，主要是速度、文件大小、可靠性和功能。我知道要问的很多，但如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T23:48:05.590

一件事是 SQL Server Compact 一次只能有一个进程访问 MDF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-23T14:50:15.507

Access 是 MDB（我相信它已针对最近的版本进行了更改）- SQL Server 完整版默认为 MDF。

我承认我决定虽然这个契约对文档来说太麻烦了，但还是选择了 SQLite。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-05T10:57:19.390

我没有 SQL Server 精简版。它是单线程可访问的，没有任何好的功能。您必须每次都为所有内容编写查询。此外，据我所知，它没有被索引。纠正我，如果我在这一点上错了。但是，最后，任何桌面任务都非常慢。

SQL Server Compact 将在 ASP.NET 4 下在中等信任下运行，并支持 x64 和 x86 平台。它限制为最多 256 个并发连接。它是基于文件的，不如 SQL Server 强大，并且不支持恢复到某个时间点。

# c# - 在 MVC 中使用多个内容占位符

> ID：900456
> 
> 赞同：0
> 
> 时间：2009-05-22T23:49:05.773
> 
> 标签：c#, asp.net-mvc

嗨，我在 MVC 中有一个包含多个内容占位符的母版页，例如：

新闻列表、购物篮预览、优惠等以及这些我想在整个应用程序中出现的东西，但这是我的第一个 MVC 应用程序，我想知道你们是否有一些关于如何从多个（页面/代码），而不必为每个控制器重现代码。

我一直在尝试围绕视图进行思考，并且可能将每个部分都作为视图，因此 viewnews 会有 contentplaceholderid="newsholder" 等，但我不知道这是否是要走的路，或者如何在控制器中实现这一点因为我仍然希望在说 /product/1 的网址上使用这个

无论如何期待你的回应

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T23:55:47.710

ContentPlaceholders 适用于您希望能够在 99% 的页面上替换的内容。

如果您想要跨多个页面的半通用内容，您想要查看 UserControls 和[Html.RenderPartial](http://www.google.co.uk/search?hl=en&safe=off&q=Html.RenderPartial&meta=)（我会尝试找到更好的链接）。

# iphone - 第一次播放声音时 AVAudioPlayer 启动缓慢

> ID：900461
> 
> 赞同：40
> 
> 时间：2009-05-22T23:50:46.957
> 
> 标签：iphone, caching, audio, nsdata, avaudioplayer

我试图通过 iPhone 上的 AVAudioPlayer 播放（非常短 - 不到 2 秒）音频文件时消除启动滞后。

首先，代码：

```
NSString *audioFile = [NSString stringWithFormat:@"%@/%@.caf", [[NSBundle mainBundle] resourcePath], @"audiofile"];
NSData *audioData = [NSData dataWithContentsOfMappedFile:audioFile];

NSError *err;
AVAudioPlayer *audioPlayer = [(AVAudioPlayer*)[AVAudioPlayer alloc] initWithData:audioData error:&err];

audioPlayer.delegate = self;
[audioPlayer play]; 
```

完成后，我还实现了 audioPlayerDidFinishPlaying 方法以释放 AVAudioPlayer。

我第一次播放音频时，延迟是显而易见的——至少 2 秒。但是，在那之后声音立即播放。那么，我怀疑罪魁祸首是 [NSData dataWithContentsOfMappedFile] 最初从闪存读取很长时间，但后来读取速度很快。不过，我不确定如何测试它。

是这样吗？如果是这样，我是否应该预先缓存 NSData 对象并在内存不足的情况下积极清除它们？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2010-06-21T04:48:51.700

延迟似乎与第一次实例化 AVAudioPlayer 有关。如果我加载任何音频，运行 [audioPlayer prepareToPlay] 然后立即释放它，我所有其他音频的加载时间非常接近于难以察觉。所以现在我在 applicationDidFinishLaunching 中这样做，其他一切都运行良好。

我在文档中找不到任何关于此的内容，但似乎确实如此。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-03-15T01:14:22.087

这是我所做的（在一个单独的线程中）：

```
[audioplayer start]
[audioplayer stop]
self.audioplayer = audioplayer 
```

[audioplayer prepareToPlay] 似乎是一个异步方法，因此如果音频实际上已准备好播放，您无法确定它何时返回。

在我的情况下，我调用 start 来实际开始播放 - 这似乎是同步的。然后我立即停止。无论如何，在模拟器中，我没有听到此活动发出任何声音。现在声音“真的”可以播放了，我将局部变量分配给一个成员变量，以便线程外的代码可以访问它。

我必须说，即使在 iOS 4 上，加载一个长度仅为 4 秒的音频文件也需要大约 2 秒，这让我感到有些惊讶......

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-01-03T04:55:23.677

如果您的音频长度少于 30 秒，并且是线性 PCM 或 IMA4 格式，并且被打包为 .caf、.wav 或 .aiff，您可以使用系统声音：

导入 AudioToolbox 框架

在您的 .h 文件中创建此变量：

```
SystemSoundID mySound; 
```

在您的 .m 文件中，在您的 init 方法中实现它：

```
-(id)init{
if (self) {
    //Get path of VICTORY.WAV <-- the sound file in your bundle
    NSString* soundPath = [[NSBundle mainBundle] pathForResource:@"VICTORY" ofType:@"WAV"];
    //If the file is in the bundle
    if (soundPath) {
        //Create a file URL with this path
        NSURL* soundURL = [NSURL fileURLWithPath:soundPath];

        //Register sound file located at that URL as a system sound
        OSStatus err = AudioServicesCreateSystemSoundID((CFURLRef)soundURL, &mySound);

            if (err != kAudioServicesNoError) {
                NSLog(@"Could not load %@, error code: %ld", soundURL, err);
            }
        }
    }
return self;
} 
```

在您的 IBAction 方法中，您使用以下命令调用声音：

```
AudioServicesPlaySystemSound(mySound); 
```

这对我有用，在按下按钮时播放的声音非常接近。希望这对您有所帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-10-06T16:52:54.103

我采取了另一种适合我的方法。我在其他地方看到过这种技术（但我现在不记得那是在哪里）。

简而言之，在执行任何其他操作之前，通过加载并播放一个简短的“空白”声音来预检音响系统。对于我在视图控制器的`viewDidLoad`方法中预加载的持续时间为 0.1 秒的简短 mp3 文件，代码如下所示：

```
 NSError* error = nil;
   NSString* soundfilePath = [[NSBundle mainBundle] pathForResource:@"point1sec" ofType:@"mp3"];
   NSURL* soundfileURL = [NSURL fileURLWithPath:soundfilePath];
   AVAudioPlayer* player = [[[AVAudioPlayer alloc] initWithContentsOfURL:soundfileURL error:&error] autorelease];
   [player play]; 
```

如果需要，您可以创建自己的空白 mp3，或者在“空白 mp3”上进行谷歌搜索以查找并下载其他人已经构建的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-02T16:21:27.493

我为 AVAudioPlayer 编写了一个简单的包装器，它提供了一个实际有效的 prepareToPlay 方法：

[https://github.com/nicklockwood/SoundManager](https://github.com/nicklockwood/SoundManager)

它基本上只是扫描您的应用程序中的声音文件，选择一个并以零音量播放。这会初始化音频硬件并允许立即播放下一个声音。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-08-14T07:59:16.577

这是 AVAudioPlayer 的一个简单的 Swift 扩展，它使用前面答案中提出的在 0 音量处播放和停止的想法。PrepareToPlay() 不幸的是，至少对我来说没有做到这一点。

```
extension AVAudioPlayer {
    private func initDelaylessPlayback() {
        volume = 0
        play()
        stop()
        volume = 1
    }

    convenience init(contentsOfWithoutDelay : URL) throws {
        try self.init(contentsOf: contentsOfWithoutDelay, fileTypeHint: nil)
        initDelaylessPlayback()
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-25T23:33:53.823

其他解决方法是创建一个短而无声的音频，并在第一次启动播放器时播放。

1.  在系统偏好设置中将麦克风级别设置为 0。
2.  打开 QuickTime。
3.  创建新的录音（文件 > 新录音）。
4.  记录 1 或 2 秒。
5.  保存/导出音频文件。（它将具有 .m4a 扩展名，大小约为 2 kb）。
6.  将文件添加到您的项目并播放它。

如果您不想自己创建新的声音文件，您可以在这里下载一个简短的静音音频文件：[https ://www.dropbox.com/s/3u45x9v72ic70tk/silent.m4a?dl=0](https://www.dropbox.com/s/3u45x9v72ic70tk/silent.m4a?dl=0)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-23T00:36:32.793

我不确定，但我怀疑 NSData 对象很懒惰并按需加载文件的内容。您可以尝试“作弊”，`[audioData getBytes:someBuffer length:1];`方法是尽早调用以使其在需要之前加载该文件。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2010-07-18T23:45:37.233

答案是

```
AVAudioPlayer *audioplayer;
[audioplayer prepareToPlay]; 
```

# php - PHP多个MySQL连接通过类/对象？

> ID：900478
> 
> 赞同：3
> 
> 时间：2009-05-22T23:58:05.537
> 
> 标签：php, mysql, class, object

这是我试图使工作的代码：

```
<?php

class database {
    var $connection;
    function database($host,$username,$password,$database){
        $this->connection = mysql_connect($host, $username, $password);
        mysql_select_db($database,$this->connection);
    }
    function query($query){
        $query = mysql_query($query,$this->connection);
        return $query;
    }
}

$db = new database("localhost","root","password","database1");
$db2 = new database("SERVER2","root","password","database2");

$sql = $db->query("SELECT * FROM users WHERE name = 'Yifan' LIMIT 1");
$row = mysql_fetch_assoc($sql);

var_dump($row);

$sql = $db2->query("SELECT * FROM users WHERE name = 'Yifan' LIMIT 1");
$row = mysql_fetch_assoc($sql);

var_dump($row);

?> 
```

所以，如果你不明白，我想有两个或多个使用对象连接到 mysql，但问题是，我得到“bool(false)”作为第一个结果，而第二个结果是正确的响应. 关于我做错了什么的任何想法，或者是否有可能？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T00:31:54.410

mysql_connect 的下一个参数是 $new_link，你可以尝试在那里发送一个 true 看看它是否有帮助？

```
$this->connection = mysql_connect($host, $username, $password, true); 
```

# c# - C# 架构问题

> ID：900483
> 
> 赞同：0
> 
> 时间：2009-05-23T00:00:24.770
> 
> 标签：c#, architecture

我正在设计一个项目，其中所有主要组件共享一个公共 DomainObject（是的，我从 O/RM 世界中偷了这个术语，但它不是*一个*O/RM 项目。） DomainObject 维护对象更改状态（脏/干净）并允许自己回滚或提交（AcceptChanges()、RejectChanges()）。当对对象调用 AcceptChanges() 时，它会触发一个事件，并且该事件将触发将 hte 值写入底层数据存储。此外，它传递一个参数，允许在事件中取消持久性。

> 1) Classroom (a DomainObject) 被实例化并修改其属性。
> 2) Classroom.AcceptChanges() 被调用，触发 OnAcceptEvent 并传递 DomainObjectChangeEventArgs，其中包含一个名为 Cancel 的布尔属性
> 3) 如果没有被事件取消，则接受更改并更新教室的状态。
> 4) 然后项目在任何也是 DomainObjects 的内部属性（例如 Student）上调用 AcceptChanges。
> 5) 每个学生通过 DomainObjectChangeEventArgs...等触发 OnAcceptEvent。

现在，向整个社区询问：

A) 您是否会让 Classroom 的 AcceptEvent 上的取消指示符停止整个过程，迫使其不再评估并可能接受任何学生，或者您是否会将 Cancel 编码为仅适用于教室。b) 是否会期望任何学生的取消指示符停止对任何其他学生的处理？

我最初的想法是，教室事件上的取消指示器应该停止整个过程，因此可以优雅地保存教室和所有学生的预先接受状态，而不会涉及事务的开销。但我不一定相信我是正确的。

你会怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T00:24:17.920

我觉得你有钱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T01:09:06.923

是的，无论哪种情况，您都应该取消整个过程。您在对象图的根上调用接受，因此消费者的期望将是整个图被持久化。我会将此视为全有或全无的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T01:16:12.697

我将调用事件 CanSave，它返回一个枚举 { OK, Cancel }。在持久化任何东西之前，我会查询整个对象图，寻找取消。*每个对象都可以验证自己并在当前未处于可持久*状态时取消……避免大多数但绝不是全部的回滚。

但是你能用 Cancel 做什么呢？好的软件的主要法令之一是“始终**允许**用户在那里保存工作”。程序员不会接受一个不会保存不可编译的源代码的 IDE，那么你为什么希望你的用户忍受它呢？

取消状态**应该**是真正的异常状态......比如不能写入只读文件->“另存为”？或空键字段->“需要用户名”。

那么有什么选择呢？保存为一种中间格式，一种可以存储“无效”数据的格式......就像文本文件一样。

旁白：我经常认为数据库应用缺少“验证”按钮，允许用户找出“这样可以吗？” 没有真正承诺。

只是思考的食物。

干杯。基思。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T05:13:29.807

如果说将学生添加到您的班级仅修改班级的状态（例如，如果您将班级中的哪个学生存储在单独的表中，班级可以拥有的更多学生人数等），那么您不需要完全保留学生对象.

如果添加到此类或从此类中删除会修改学生类（例如他们可以参加的更多课程的数量等），那么您也应该将取消传播到学生对象。

# regex - ActionScript 3 中的正则表达式：如何排除复杂前缀？

> ID：900500
> 
> 赞同：0
> 
> 时间：2009-05-23T00:12:12.857
> 
> 标签：regex, actionscript-3, prefix, lookbehind

AS3 RegExp 引擎（和基于 ECMAScript 的 JavaScript）不支持**复杂**的“lookbehind”表达式。（完全支持前瞻表达式。）

例如：

```
 (?<=<body>)(.*?)(?=<\/body>) 
```

会工作，但是；

```
(?<=<body\b[^>]*>)(.*?)(?=<\/body>) 
```

在 AS3 中不起作用。

我需要的是匹配一个复杂的前缀，但在最终匹配中排除它。在上面的例子中；我试图在 HTML 文本中获取正文内容，但不是开始和结束正文标签。实际的测试文本如下所示：

```
<body bgcolor="#EEEEEE">
Some content here...
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T00:23:48.403

这是来自我的 JavaScript RegExp 经验，但应该是比较相似的......

我认为您不需要后视，您只需要非捕获组。它们仍然匹配输入，但它们没有被匹配捕获：

```
(?:<body\b[^>]*>)(.*?)(?:<\/body>) 
```

当您进行匹配时，返回的匹配将仅包括内容（但不包括正文开始/结束标签）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T00:38:33.913

我认为您希望`var regExp:RegExp = /<body>(.*?)<\/body>/i;`与当前正则表达式中的 3 个组相反，因此您只捕获 body 标记，然后可以根据您使用的函数使用 \1 或 $1 引用匹配：

[http://livedocs.adobe.com/flex/3/html/help.html?content=12_Using_Regular_Expressions_09.html](http://livedocs.adobe.com/flex/3/html/help.html?content=12_Using_Regular_Expressions_09.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T01:12:44.280

感谢现状；问题很快就解决了。。

```
var re:RegExp = new RegExp(/(<body\b[^>]*>)(.*?)(<\/body>)/gis); }
return strHTML.replace(re, "$2"); 
```

这仅返回没有正文标签的内容。无需担心lookbehinds 和/或lookaheads..

谢谢大家。。

# asp.net - 网络服务器上的 system.web.routing 不起作用

> ID：900510
> 
> 赞同：3
> 
> 时间：2009-05-23T00:20:59.127
> 
> 标签：asp.net, asp.net-routing

我已经阅读了所有这些关于如何使 system.web.routing 工作的文章，但所有这些文章都在 localhost:port 上进行了解释。我可以在本地机器上让它工作，但是一旦我将网站上传到服务器上，无论我做什么，路由都会停止工作。

首先，我尝试不使用任何扩展名（.aspx），但经过所有努力，我放弃并添加了扩展名，但它仍然无法在服务器上运行。

任何帮助表示赞赏。

样本：

## 在`global.ascx`

```
Route test = new Route("home.aspx", new TestRoutingHandler());
Routes.Add(test); 
```

## 在路由处理程序中

```
public IHttpHandler GetHttpHandler(RequestContext requestContext)
{
    string virtualPath = string.Empty;
    Route route = (Route)requestContext.RouteData.Route;
    virtualPath = "~/Default.aspx";
    return (Page)BuildManager.CreateInstanceFromVirtualPath(virtualPath, typeof(Page));
} 
```

## 在 httpModules 下的 web.config

```
add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web.Routing, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" 
```

这非常简单，可以在本地机器上运行，但不能在 Web 服务器上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-12-11T17:38:34.940

对于 IIS7+，我发现添加到 web.config 的部分突然使一切正常：

```
<modules runAllManagedModulesForAllRequests="true" /> 
```

就像在 Cassini Web 服务器上运行的 VS 一样令人困惑，它工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T00:25:53.453

验证 Web 服务器是否已配置为使用 ASP.NET（也称为通配符处理程序）处理所有请求。如果不是，则仅当请求的确切路径对应于磁盘上的物理文件并具有 .aspx 扩展名时，它才会通过 ASP.NET 处理请求。显然，路由概念完全不满足第一个条件，通常是第二个条件。

Phil Haack对如何在**IIS 6中执行此操作进行了**[很好的演练](http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx)。

 **对于**IIS 7**，您只需要在 web.config 的 system.webServer 下指定[正确的模块和处理程序。](http://msdn.microsoft.com/en-us/magazine/2009.01.extremeaspnet.aspx#id0070014)

# iphone - 如何使用 Firefox 但假装我在使用 iPhone（使用 Firebug 检查页面设计）

> ID：900511
> 
> 赞同：0
> 
> 时间：2009-05-23T00:21:06.677
> 
> 标签：iphone, firefox, safari, firebug, ipod

有没有办法使用 Firefox 和 Firebug，但通过伪造用户代理字符串来假装它是 iPhone 的 Safari？我想使用 Firefox 来检查 Amazon 或 Gmail 网站，看看页面是如何为 iPhone 布局的……只是为了好玩和实验。有办法吗？谢谢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T00:30:47.530

您可以使用 great_llama 提供的说明伪造用户代理字符串，但请记住 Firefox 不是 Safari，它可能不会以相同的方式布置页面。如果您使用的是 Windows 或 OS X 机器，您可以使用 Safari 以更高的准确度查看它的外观。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T00:24:53.673

以下是有关如何执行[此操作的一些说明。](http://paininthetech.com/2007/10/03/fake-iphone-user-agent/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-20T10:32:30.450

转到[模拟器](http://www.testiphone.com/)，您可以运行您的开发版本。然后您可以在模拟器框架上使用萤火虫

# linux - 上千张图片，我应该如何组织目录结构？(Linux)

> ID：900512
> 
> 赞同：11
> 
> 时间：2009-05-23T00:21:39.377
> 
> 标签：linux, directory-structure

我在由 1and1.com 托管的 Linux 服务器上收到了数千用户上传的数千张图片（我相信他们使用 CentOS，但不确定版本）。这是一个与语言无关的问题，但是，供您参考，我使用的是 PHP。

我的第一个想法是将它们全部转储到同一个目录中，但是，我记得不久前，可以在一个目录中删除多少个文件或目录是有限制的。

我的第二个想法是根据用户的电子邮件地址对目录内的文件进行分区（因为无论如何我都使用它作为用户名），但我不想遇到目录中目录的限制......

无论如何，对于来自 user@domain.com 的图像，我打算这样做：

```
/images/domain.com/user/images... 
```

这是聪明的做法吗，如果成千上万的用户说“gmail”也许我可以更深入，像这样

```
/images/domain.com/[first letter of user name]/user/images... 
```

所以对于 mike@gmail.com 它将是......

```
/images/domain.com/m/mike/images... 
```

这是一个不好的方法吗？其他人都在做什么？我也不想遇到太多目录的问题......

* * *

有关的：

*   [一个目录中有多少个文件太多了？](https://stackoverflow.com/questions/466521/how-many-files-in-a-directory-is-too-many)
*   [约 250,000 张图像的最佳 Web 文件夹结构](https://stackoverflow.com/questions/315459/optimum-web-folder-structure-for-250-000-images)
*   [如何在文件系统中存储图像](https://stackoverflow.com/questions/191845/how-to-store-images-in-your-filesystem)
*   [管理大量文件的技巧？](https://stackoverflow.com/questions/671260/tips-for-managing-a-large-number-of-files)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-23T00:28:50.453

我会做以下事情：

1.  获取每个图像的 MD5 哈希值。
2.  将 MD5 哈希写入您正在跟踪这些内容的数据库中。
3.  将它们存储在一个目录结构中，您可以在其中使用 MD5 哈希十六进制字符串的前几个字节作为目录名称。因此，如果哈希是“abcdef1234567890”，您会将其存储为“a/b/abcdef1234567890”。

使用哈希还可以让您合并多次上传的同一张图片。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T00:38:54.053

扩展 Joe Beda 的方法：

*   数据库
*   数据库
*   数据库

如果您关心按用户、原始文件名、上传日期、拍照日期 (EXIF) 等对文件进行分组或查找，请将此元数据存储在数据库中并使用适当的查询来挑选适当的文件。

使用数据库主键——无论是文件哈希还是自动递增的数字——在一组固定的目录中定位文件（或者，使用每个目录的固定最大文件数 N，当你填满时，转到下一张，例如第*k*张照片应该存储在`{somepath}/aaaaaa/bbbb.jpg`aaaaaa = floor(k/N) 的位置，格式为十进制或十六进制，而 bbbb = mod(k,N)，格式为十进制或十六进制。如果层次结构太平对你来说，使用类似的东西`{somepath}/aa/bb/cc/dd/ee.jpg`）

不要将目录结构直接暴露给您的用户。如果他们使用 Web 浏览器通过 HTTP 访问您的服务器，请给他们一个类似 www.myserver.com/images/{primary key} 的 URL，并在 Content-Type 标头中编码正确的文件类型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T00:28:37.863

我用于另一个要求但可以满足您的需求的是使用简单的约定。

加 1 得到新号码的长度，然后加上这个号码的前缀。

例如：

假设“a”是一个用最后一个 id 设置的 var。

```
a = 564;
++a;
prefix = length(a);
id = prefix + a; // 3565 
```

然后，您可以使用以下约定为目录使用时间戳：

```
20092305 (yyyymmdd) 
```

然后你可以像这样爆炸你的路径：

```
2009/23/05/3565.jpg 
```

（或者更多）

这很有趣，因为您可以同时按日期和数字保持排序顺序（有时很有用）并且您仍然可以在更多目录中分解您的路径

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-23T00:39:00.387

这是我为这种情况写的两个函数。它们已经在一个拥有数千名成员的网站上使用了一年多，每个成员都有很多文件。

本质上，这个想法是使用每个成员唯一的数据库 ID 的最后一位来计算一个目录结构，为每个人提供一个唯一的目录。使用最后一个数字，而不是第一个数字，可确保目录分布更均匀。每个成员都有一个单独的目录意味着维护任务要简单得多，而且你可以看到人们的东西在哪里（就像视觉上一样）。

```
// checks for member-directories & creates them if required
function member_dirs($user_id) {

    $user_id = sanitize_var($user_id);

    $last_pos = strlen($user_id);
    $dir_1_pos = $last_pos - 1;
    $dir_2_pos = $last_pos - 2;
    $dir_3_pos = $last_pos - 3;

    $dir_1 = substr($user_id, $dir_1_pos, $last_pos);
    $dir_2 = substr($user_id, $dir_2_pos, $last_pos);
    $dir_3 = substr($user_id, $dir_3_pos, $last_pos);

    $user_dir[0] = $GLOBALS['site_path'] . "files/members/" . $dir_1 . "/";
    $user_dir[1] = $user_dir[0] . $dir_2 . "/";
    $user_dir[2] = $user_dir[1] . $dir_3 . "/";
    $user_dir[3] = $user_dir[2] . $user_id . "/";
    $user_dir[4] = $user_dir[3] . "sml/";
    $user_dir[5] = $user_dir[3] . "lrg/";

    foreach ($user_dir as $this_dir) {
        if (!is_dir($this_dir)) { // directory doesn't exist
            if (!mkdir($this_dir, 0777)) { // attempt to make it with read, write, execute permissions
                return false; // bug out if it can't be created
            }
        }
    }

    // if we've got to here all directories exist or have been created so all good
    return true;

}

// accompanying function to above
function make_path_from_id($user_id) {

    $user_id = sanitize_var($user_id);

    $last_pos = strlen($user_id);
    $dir_1_pos = $last_pos - 1;
    $dir_2_pos = $last_pos - 2;
    $dir_3_pos = $last_pos - 3;

    $dir_1 = substr($user_id, $dir_1_pos, $last_pos);
    $dir_2 = substr($user_id, $dir_2_pos, $last_pos);
    $dir_3 = substr($user_id, $dir_3_pos, $last_pos);

    $user_path = "files/members/" . $dir_1 . "/" . $dir_2 . "/" . $dir_3 . "/" . $user_id . "/";
    return $user_path;

} 
```

sanitize_var() 是用于清理输入并确保其为数字的支持函数，$GLOBALS['site_path'] 是服务器的绝对路径。希望，否则它们将是不言自明的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-23T07:33:54.173

Joe Beda 的回答几乎是完美的，但请注意，MD5 已被证明在笔记本电脑上的 iirc 2 小时内可碰撞？

也就是说，如果您真的会以上述方式使用文件的 MD5 哈希，您的服务将容易受到攻击。攻击会是什么样子？

1.  黑客不喜欢某张照片
2.  他确保这是您正在使用的普通 MD5（image+secret_string 的 MD5 会吓到他）
3.  他使用了一种神奇的方法，将一张（在这里发挥你的想象力）哈希的图片与他不喜欢的照片相撞
4.  他像往常一样上传照片
5.  您的服务用新服务覆盖旧服务并显示两者

有人说：那我们不要覆盖它。然后，如果可以预测某人会上传某些东西（网络上的热门图片可能会被上传），那么就可以先获取它的“散列位置”。用户在上传小猫的图片时会很高兴，他会发现它实际上看起来像（在这里发挥你的想象力）。我说：使用 SHA1，因为它在 iirc 127 年中被 10.000 台计算机集群证明是可破解的？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-25T14:30:10.117

在这方面可能会迟到。但是一种解决方案（如果它适合您的用例）可能是文件名散列。这是一种使用文件名创建易于重现的文件路径的方法，同时还创建了一个分布良好的目录结构。例如，您可以使用文件名哈希码的字节作为其路径：

```
String fileName = "cat.gif";
int hash = fileName.hashCode();
int mask = 255;
int firstDir = hash & mask;
int secondDir = (hash >> 8) & mask; 
```

这将导致路径为：

```
/172/029/cat.gif 
```

然后，您可以`cat.gif`通过重现算法在目录结构中找到。

使用 HEX 作为目录名称就像转换`int`值一样简单：

```
String path = new StringBuilder(File.separator)
        .append(String.format("%02x", firstDir))
        .append(File.separator)
        .append(String.format("%02x", secondDir)
        .toString(); 
```

导致：

```
/AC/1D/cat.gif 
```

几年前我写了一篇关于这个的文章，最近把它移到了 Medium。它有更多细节和一些示例代码：[文件名哈希：创建哈希目录结构](https://medium.com/@michael.andrews/file-name-hashing-creating-a-hashed-directory-structure-eabb03aa4091)。希望这可以帮助！

# silverlight - 我应该在 Silverlight 和客户端上为游戏使用什么框架？

> ID：900515
> 
> 赞同：0
> 
> 时间：2009-05-23T00:23:34.783
> 
> 标签：silverlight, client

我在 Silverlight 中制作了几个简单的游戏。我正在考虑为 Windows 制作更深入的游戏。它将在 Silverlight 中提供一个功能受限版本，以在浏览器中使用。您会建议我将什么用于客户端应用程序（不在浏览器或 Silverlight 中）？

如果需要任何其他信息，我会尝试添加它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T00:28:42.730

WPF 似乎是显而易见的选择。由于 Silverlight 本身是 WPF 的子集，因此您已经拥有的游戏和代码可以轻松地移植到您设置的任何应用程序中。您甚至可以将您的主页包装在一个窗口中并可能运行它。

如果您不想将 WPF 用于客户端应用程序，请尝试说明原因，（跨平台等）

# .net - 对等方使用 iPhone NSURLConnection 重置连接

> ID：900523
> 
> 赞同：0
> 
> 时间：2009-05-23T00:26:19.617
> 
> 标签：.net, iphone, http

我正在尝试使用 iPhone 应用程序连接到 C# HTTP 服务器。到目前为止非常简单的代码：

```
 NSData *requestData = [ NSData dataWithBytes: [ requestMessage UTF8String ] length: [ requestMessage length ] ];
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:infoURL]];
    [request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"content-type"];
    [request setHTTPMethod: @"POST"];
    [request setHTTPBody: requestData];
    NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self]; 
```

服务器获取请求，发送响应，然后终止连接。iPhone 报告对等方重置连接。

为了能够在我的桌面上访问 Firefox 中的服务器，我需要进入它的高级 preffs 并禁用 keep-alive。我认为原因是因为我在发送响应后立即终止连接。我这样做是因为我不想以后重用连接。

无论如何在iPhone上使用NSURLConnection时禁用keep-alive，或者对修改我的.Net代码有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T00:45:02.370

为什么不直接添加 Connection: Close 到 HTTP/1.1 请求？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-12T16:42:03.033

这实际上似乎是我正在使用的 iOS 版本的测试版中的一个错误。未来的更新和相同的代码工作得很好。

# iphone - OpenGL 2D 视图的最小样板代码是什么？

> ID：900534
> 
> 赞同：0
> 
> 时间：2009-05-23T00:35:26.367
> 
> 标签：iphone, cocoa, opengl, graphics, boilerplate

设置用于绘制 2D 游戏的 OpenGL 视图（具有必要的投影、摄像机角度等）所需的最少样板代码是多少？

例如，在自定义视图中进行 Quartz 2D 绘图（例如，加载背景图像）的最低要求如下：

```
#import <Cocoa/Cocoa.h>

@interface MyView : NSView {
}

@end 
```

= = =

```
#import "MyView.h"

@implementation MyView

- (id)initWithFrame:(NSRect)frame {
    self = [super initWithFrame:frame];
    return self;
}

- (void)drawRect:(NSRect)rect {
    CGContextRef myContext = [[NSGraphicsContext currentContext] graphicsPort];
    CGRect frame = CGRectMake(bounds.origin.x, bounds.origin.y, bounds.size.width, bounds.size.height);
    CFBundleRef mainBundle = CFBundleGetMainBundle();
    CFURLRef url = CFBundleCopyResourceURL(mainBundle, CFSTR("background"), CFSTR("png"), NULL);
    CGDataProviderRef provider = CGDataProviderCreateWithURL (url);
    CGImageRef image = CGImageCreateWithPNGDataProvider (provider, NULL, true, kCGRenderingIntentDefault);
    CGDataProviderRelease (provider);
    CGContextDrawImage (myContext, frame, image);
    CGImageRelease (image);

    //rest of drawing code here...
}

@end 
```

与在 Mac 上使用 Open GL 相比，iPhone 上的 Open GS ES 的样板代码中的任何内容会有所不同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-28T15:15:33.737

在 iPhone 上设置 OpenGL 应用程序的最简单方法是通过 Xcode 创建一个“OpenGL ES 应用程序”。它会生成您需要开始的样板源代码。

这是我用于 OpenGL iPhone 游戏的样板源代码：

```
@implementation EAGLView

@synthesize context;

// You must implement this method
+ (Class)layerClass {
   return [CAEAGLLayer class];
}

//The GL view is stored in the nib file. When it's unarchived it's sent -initWithCoder:
- (id)initWithCoder:(NSCoder*)coder {

   if ((self = [super initWithCoder:coder])) {
      // Get the layer
      CAEAGLLayer *eaglLayer = (CAEAGLLayer *)self.layer;

      eaglLayer.opaque = YES;
      eaglLayer.drawableProperties = [NSDictionary dictionaryWithObjectsAndKeys:
                                      [NSNumber numberWithBool:NO], kEAGLDrawablePropertyRetainedBacking, kEAGLColorFormatRGBA8, kEAGLDrawablePropertyColorFormat, nil];

      context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES1];

      if (!context || ![EAGLContext setCurrentContext:context]) {
         [self release];
         return nil;
      }
   }
   return self;
}

- (void)drawView 
{
   [EAGLContext setCurrentContext:context];

   glBindFramebufferOES(GL_FRAMEBUFFER_OES, viewFramebuffer);
   glViewport(0, 0, ScreenWidth, ScreenHeight);

   glMatrixMode(GL_PROJECTION);
   glLoadIdentity();

   // Setup the coordinate system to use 0,0 as the lower left corner
   // and 320,480 as the upper right corner of the screen (in portrait mode).
   glOrthof(0.0f, ScreenWidth, 0.0f, ScreenHeight, -1.0f, 1.0f);

   glMatrixMode(GL_MODELVIEW);
   glLoadIdentity();

   glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

   // Here is where you draw everything in your world.
   DrawWorld();

   glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer);
   [context presentRenderbuffer:GL_RENDERBUFFER_OES];
}

- (void)layoutSubviews {
   [EAGLContext setCurrentContext:context];
   [self destroyFramebuffer];
   [self createFramebuffer];
   [self drawView];
}

- (BOOL)createFramebuffer {

   glGenFramebuffersOES(1, &viewFramebuffer);
   glGenRenderbuffersOES(1, &viewRenderbuffer);

   glBindFramebufferOES(GL_FRAMEBUFFER_OES, viewFramebuffer);
   glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer);
   [context renderbufferStorage:GL_RENDERBUFFER_OES fromDrawable:(CAEAGLLayer*)self.layer];
   glFramebufferRenderbufferOES(GL_FRAMEBUFFER_OES, GL_COLOR_ATTACHMENT0_OES, GL_RENDERBUFFER_OES, viewRenderbuffer);

   glGetRenderbufferParameterivOES(GL_RENDERBUFFER_OES, GL_RENDERBUFFER_WIDTH_OES, &ScreenWidth);
   glGetRenderbufferParameterivOES(GL_RENDERBUFFER_OES, GL_RENDERBUFFER_HEIGHT_OES, &ScreenHeight);

   if(glCheckFramebufferStatusOES(GL_FRAMEBUFFER_OES) != GL_FRAMEBUFFER_COMPLETE_OES) {
      NSLog(@"failed to make complete framebuffer object %x", glCheckFramebufferStatusOES(GL_FRAMEBUFFER_OES));
      return NO;
   }

   return YES;
}

- (void)destroyFramebuffer {

   glDeleteFramebuffersOES(1, &viewFramebuffer);
   viewFramebuffer = 0;
   glDeleteRenderbuffersOES(1, &viewRenderbuffer);
   viewRenderbuffer = 0;
}

- (void)dealloc {

   if ([EAGLContext currentContext] == context) {
      [EAGLContext setCurrentContext:nil];
   }

   [context release];  
   [super dealloc];
}

@end 
```

作为替代方案，[本文](http://mitchallen.com/iphone/archives/100)提供了在 iPhone 上创建 OpenGL ES 应用程序的一个很好的演练。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T00:44:02.107

> iPhone 上的 [OpenGL] ES 与在 Mac 上使用 Open GL 相比，样板代码中的任何内容会有所不同吗？

是的。在 Mac 上，您将使用 NSOpenGLView，它是 Application Kit 的一部分。iPhone 没有 AppKit。

我不能确定更多，因为我不是 iPhone 开发人员，但我猜你会在 iPhone 上使用[EAGL](http://developer.apple.com/iphone/library/documentation/OpenGLES/Reference/OpenGLES_Framework/)。

# gravatar - 允许匿名图片肖像的系统是什么？

> ID：900535
> 
> 赞同：1
> 
> 时间：2009-05-23T00:35:36.647
> 
> 标签：gravatar, identification

任何人都知道允许博客/网站为匿名评论者生成随机图片的系统是什么？如果您输入相同的姓名和电子邮件，它总是相同的图片，看起来非常有用，但无法追踪它是什么。

它在 stackoverflow 上使用过，我已经在许多其他网站和博客上看到过它。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T00:36:34.180

[头像](http://en.gravatar.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T00:42:23.950

Identicon 是我真正想要的，但 Gravatar 的答案让我找到了它！谢谢杰夫！我假设惰性注册是单独处理的。

见：[http ://scott.sherrillmix.com/blog/blogger/wp_identicon/](http://scott.sherrillmix.com/blog/blogger/wp_identicon/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-04T18:22:34.380

您正在寻找[identicons](http://en.wikipedia.org/wiki/Identicon)。

它的替代品是 wavatar 和[monsterids](http://www.splitbrain.org/projects/monsterid)。

Gravatar 和[Libravatar](http://www.libravatar.org/)（gravatar 的开源和联合替代品）都支持在没有用户提供的图像可用于电子邮件地址时将其作为后备。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-16T01:02:42.610

使用 gravatar，这是您用来更改您的帐户图片的工具。您可以在这里免费注册：[gravitar](https://en.gravatar.com/)

如果要更改个人资料图片，请转到用户设置，单击编辑，然后更改图片。注册，然后选择一张图片。确保您注册的电子邮件地址与您帐户中的电子邮件地址相同。享受。

# video-capture - 显示高清视频源

> ID：900542
> 
> 赞同：3
> 
> 时间：2009-05-23T00:38:50.667
> 
> 标签：video-capture

我需要捕捉高清视频源（例如高清电视）并将其显示在电脑上。我应该使用什么？我更喜欢使用 windows 和 c# 的解决方案，但我对其他选项持开放态度。

先感谢您

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-26T01:59:11.217

我会推荐[VLC](http://videolan.org)或[mplayer/mencoder](http://www.mplayerhq.hu/)（win32 版本）。它们可以由 C# 应用程序命令行驱动。VLC 支持任何 DirectShow 捕获设备，并具有大量高级捕获、转码和发布选项。

另一个选项是[ffmpeg](http://sourceforge.net/projects/ffmpeg/)，它可用作命令行工具或[绑定到 C#](http://it.toolbox.com/blogs/rymoore/using-c-ffmpeg-11334)。

我个人建议在 C# 绑定上使用这些工具之一的命令行版本，因为所有这些程序都倾向于很快开发补丁和功能。相对于任何这些程序的当前稳定（更不用说 SVN）构建，C# 绑定很可能已经过时了。此外，您会发现更多命令行格式的文档，因为这通常是这些工具的使用方式。

最后，可以通过构建自己的[DirectShow Capture Filter](http://msdn.microsoft.com/en-us/library/dd375472(VS.85).aspx)来做到这一点。这个选项伴随着我的 BIG FAT 警告，即使使用[Capture Graph Builder](http://msdn.microsoft.com/en-us/library/dd318619(VS.85).aspx) DirectShow 之类的工具，它也是一个极其复杂和喜怒无常的野兽，需要大量经验才能正确完成。它还受到定期 API 更改、Windows 平台差异和糟糕文档的影响。走这条路，后果自负。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-30T16:29:17.683

你的预期来源是什么？您想要获取和使用的实时电视信号，还是已经存储的东西？当你想使用实时电视信号时会很困难，因为有些电视频道不希望我们抓取它，并使用 HDCP 作为信号保护或其他复制保护方法。你应该意识到这一点

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T02:28:04.470

[Hauppage](http://www.hauppauge.com/)为捕捉视频提供了多种解决方案，包括捕捉高清视频。我相信他们有 C# 的驱动程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T15:34:31.023

首先，我会查看现有的软件来执行此操作。例如，Windows Movie Maker 可以显示和捕捉高清摄像机的输出。mplayer 应该能够显示来自大多数采集卡/相机的实时提要（并且具有全屏选项）。还有其他更完整的系统，如[ScopeBox](http://www.scopebox.com/)、[OnLocation](http://www.adobe.com/products/premiere/onlocation/)、[UltraScope](http://www.blackmagic-design.com/products/ultrascope/)或任何非编软件（Adobe Premiere、Final Cut Pro 等）。这些是针对视频制作的，但您并没有真正提及为什么要显示或捕获视频。

如果您想从头开始编写一些东西，DirectShow API 应该是一个很好的起点。

> 我需要捕捉高清视频源（例如高清电视）

你不能从高清电视上捕捉，因为它只是一个显示器..

你可以从高清摄像机上捕捉，但你需要一张捕捉卡——Blackmagic Design 制作了很多这些，最便宜的是他们的~150 美元的[“录像机”](http://www.blackmagic-design.com/products/videorecorder/)，它可以通过组件捕捉，他们的~200 美元的[“强度”卡](http://www.blackmagic-design.com/products/intensity/)将通过 HDMI 捕获（以及任何其他模拟连接）

然后，您应该能够使用 DirectShow 或 QuickTime API（[关于此的支持页面](http://www.blackmagic-design.com/support/detail.asp?techID=104)）从 BlackMagic 卡进行录制。其他采集卡也应该如此（我只是提到 BlackMagic，因为它们是更知名的品牌之一）

需要注意的一件事是，如果您正在捕获高清视频 (1920x1080p)，那么您正在处理大量数据。大多数最新的计算机应该可以很好地处理它，但它仍然需要大量的 CPU 和 IO 速度。

另一件事是，您无法从蓝光播放器之类的东西中捕获，因为[HDCP](http://en.wikipedia.org/wiki/High-bandwidth_Digital_Content_Protection)（高带宽数字内容保护）系统可以防止这种情况发生。

# ruby-on-rails - Rails 中的视图不会调用被覆盖的属性访问器

> ID：900543
> 
> 赞同：1
> 
> 时间：2009-05-23T00:38:53.147
> 
> 标签：ruby-on-rails, ruby, erb

我有一个这样的模型：

```
class Transaction < ActiveRecord::Base
  def amount
    self[:amount].abs
  end

  def transaction_type
    read_attribute(:amount) > 0 ? :credit : :debit
  end

  def transaction_type=(type)
    if type == :credit || type == 'credit'
      self[:amount] = amount.abs
    elsif type == :debit || type == 'debit'
      self[:amount] = amount.abs * -1
    else
      raise ArgumentError.new 'Type must be credit or debit'
    end
  end
end 
```

因为我希望我的金额列在呈现时始终为正数。问题显然是视图从来没有调用过这个方法：

```
<% form_for @transaction do |f| %>
  <%= f.error_messages %>
  <p>
    <%= f.label 'Where?' %><br />
    <%= f.text_field :target %>
  </p>
  <p>
    <%= f.label 'What?' %><br />
    <%= f.text_field :memo %>
  </p>
  <p>
    <%= f.label 'How much?' %><br />
    <%= f.text_field :amount %>
  </p>
  <p>
    <%= f.radio_button :transaction_type, 'debit' %>
    <%= f.label :transaction_type_debit, 'Debit' %>
    <%= f.radio_button :transaction_type, 'credit' %>
    <%= f.label :transaction_type_credit, 'Credit' %>
  </p>
  <p><%= f.submit "Submit" %></p>
<% end %> 
```

难道我做错了什么？还是有更好的方法来做到这一点？

**编辑：**添加了我的 transaction_type 访问器方法，这更好地解释了为什么我不在数据库中将金额存储为仅正数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T00:52:59.453

几年前我也遇到过类似的问题。鉴于所涉及的时间，如果我错了，请原谅。

据我所知，表单助手使用`*_before_type_cast`访问器方法。考虑将您的方法重命名为`amount_before_type_cast`. [这里](http://dev.rubyonrails.org/ticket/3519)有一些关于“问题”的更多信息。

但是，如果您只希望在视图中将数字设为绝对值，但仍希望在模型中以通常的方式使用该数字，那么这完全是错误的方法，您应该“清理”数据以用于以不同的方式查看视图（即，在控制器中的助手，或在模型上具有全新的非基于数据的自定义属性）。

# django - Django Templates — 将模板中的变量值传递给 templatetags 过滤器

> ID：900546
> 
> 赞同：1
> 
> 时间：2009-05-23T00:39:25.783
> 
> 标签：django, templates, django-templates, tags

name class 一个 id，一个 first & a last 属性

在我的 view.py 中，我从数据库中获取一个名称对象并将其传递给 index.html 模板。

在我的中，我有一个带有值和 arg`templagetags/my_tags.py`的过滤器。`my_private_tag(value, arg)`它将 arg 附加到值并返回结果。

```
def my_private_tag(value, arg):
  return value + ' ' + arg 
```

在我的 index.html 标记中，我需要执行以下操作。

```
{% if name %}

  # to display 
  # John says hello
  {{name.first | my_private_tag:"says hello"}

  # Johns student id = id_value
  {{name.first | my_private_tag:"????????"}

  # Johns student id = id_value, lastname = lastname_value
  {{name.first | my_private_tag:"????????"}

{% endif %} 
```

在哪里：

```
id_value = name.id & lastname_value = name.last 
```

请填写？？？？？？如果你可以的话。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T00:47:06.390

而不是为此实现自己的过滤器。为什么不这样做：

```
{{name.first }} says hello
{{name.first }}'s student id = {{ name.id }} 
```

它更具可读性。无论如何，这就是您应该使用模板的方式。

如果您仍然想为此使用自定义过滤器，您可以像这样传递变量：

```
{{name.first|my_private_tag:name.id}} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T05:06:20.033

如果过滤器只得到两个字符串，它将无法访问原始名称对象，因此无法获取 ID。

当您可以使用现有标签获得所需结果时，我认为您想使用过滤器执行此操作，因此您走错了方向。但是，为了争论，假设你可以得到

```
Johns student id = 47, lastname = Doe 
```

从过滤器。你会怎么做？首先，您必须将名称对象传递给过滤器

```
{{name|my_private_tag:"??????"}} 
```

然后过滤器的代码变为

```
return name.first_name + "s student id = " + name.id + ", lastname = " + name.last_name 
```

请注意，您没有使用该参数。如果你希望你的过滤器根据参数返回不同的东西，那么添加条件逻辑就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-03T11:13:01.493

如果您需要一个仅由业务逻辑规定的模型字段值组合组成的值，则模板标签不是正确的方法。

相反，这应该是模型的属性：

```
class Student(models.Model):
    firstname = models.CharField(...)
    lastname = models.CharField(...)

    @property
    def student_id(self):
        return '{}{}'.format(self.id, self.lastname) 
```

您可以在任何地方使用此属性，不仅在您的模板中，而且在视图、导出、管理 UI 等中。您可能需要看到这`student_id`听起来像是一个相当重要的属性。

在模板中：

```
{% if student %}

  # to display 
  # John says hello
  {{ student.firstname }} says hello

  # John's student id
  Student ID: {{ student.student_id }}

{% endif %} 
```

应该为更通用的功能和取决于当前请求的功能创建模板标签，而不是为您将只应用于特定上下文中的一个特定模型的东西创建模板标签。而且，最重要的是，它们不适用于不限于模板的功能。

# iphone - 有什么方法可以确定iphone是否在漫游？

> ID：900547
> 
> 赞同：21
> 
> 时间：2009-05-23T00:39:51.163
> 
> 标签：iphone, jailbreak, core-telephony, roaming-profile

我正在开发一个 iPhone 应用程序，并且真的很想确定设备是否正在漫游，这样我就可以智能地避免在用户离开家庭网络时花费昂贵的连接费用。

我正在编写的应用程序是针对越狱手机的，但如果可能的话，我更愿意使用标准 SDK。

这是我已经找到的：

**1\. Apple SDKs：** 在Apple 文档中，我发现了Apple 的SCNetworkReachability API 中的promise。该 API 提供对诸如您是在 WIFI 还是手机网络上、当前是否建立网络连接等内容的访问。但是，在 SCNetworkReachability API 参考 pdf 中搜索“roam”或“roaming”都为零。他们的示例代码也是如此。

**2\. 越狱 iPhone FS 的 Grep：** 首选项 -> 常规 -> 网络选项卡是用户可以打开或关闭漫游的地方。查看 plist 文件（“/Applications/Preferences/Network.plist”）我能够找到以下参考：

```
 PostNotification = "com.apple.commcenter.InternationalRoamingEDGE.changed";
        cell = PSSwitchCell;
        default = 1;
        defaults = "com.apple.commcenter";
        key = InternationalRoamingEDGE;
        label = "EDGE_ROAMING_TOGGLE";
        requiredCapabilities =             (
            telephony
        ); 
```

这当然是一个线索，因为看起来我可以注册用户更改国际漫游设置的通知。不过，我不确定如何将其转化为他们实际上正在漫游的知识。

**3\. 检查 SpringBoard 的类转储源：** 我已经使用[class-dump 转储](http://www.codethecode.com/projects/class-dump/)了 SpringBoard 的类。我找不到任何提及“漫游”或“漫游”

**4\. 显然，我首先在 SO 上进行了检查：** 找不到任何相关的东西。

进一步的步骤：这里有人有什么建议吗？我知道这是可能的。然而，苹果显然很难找到它。我非常怀疑这在不使用私有框架的情况下是否可行。（例如 CoreTelephony）。由于这是一个越狱的应用程序，我可能会使用 SpringBoard 中的注入代码对运营商名称进行屏幕抓取，但我真的不想走这条路。非常感谢任何建议。谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-08T19:45:31.677

有！它根本没有记录，我非常怀疑这是否适用于非越狱手机（因为它需要使用不在沙箱中的文件）。但是，这是如何完成的。

iPhone 文件系统保留两个软链接：

```
static NSString *carrierPListSymLinkPath = @"/var/mobile/Library/Preferences/com.apple.carrier.plist";
static NSString *operatorPListSymLinkPath = @"/var/mobile/Library/Preferences/com.apple.operator.plist"; 
```

当这些链接指向同一个文件时，电话没有漫游。当指向不同的文件时，电话正在漫游。

简化代码（无错误检查等）：

```
- (BOOL)isRoaming
{
    NSFileManager *fm = [NSFileManager defaultManager];
    NSError *error;
    NSString *carrierPListPath = [fm destinationOfSymbolicLinkAtPath:carrierPListSymLinkPath error:&error];
    NSString *operatorPListPath = [fm destinationOfSymbolicLinkAtPath:operatorPListSymLinkPath error:&error];
    return (![operatorPListPath isEqualToString:carrierPListPath]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-12T09:51:58.257

符号链接的解决方案不是唯一的方法，但绝对是最好的。正如我刚刚意识到的，返回的字符串包含运营商和运营商的 MCC 和 MNC 代码！！！即使是核心电话框架也无法在漫游时检索有关您的 iPhone 所连接的运营商的信息。

```
 Logs: 
 carrier: /System/Library/Carrier Bundles/iPhone/72410/carrier.plist
 operator: /System/Library/Carrier Bundles/iPhone/20810/carrier.plist 
```

如您所见，运营商（原始蜂窝提供商）行包含“文件夹”72410 内的文件，这意味着 MCC 724（巴西）和 MNC 10（VIVO）。运营商（实际上是我的手机现在连接的那个 - 我正在漫游）位于文件夹 20810 中，这意味着 MCC 208（法国）和 MNC 10（SFR）。

顺便说一句，我正在使用带有 iOS5 的 iPhone 4。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-09T19:11:50.863

[在非越狱设备上，您可以使用http://ipinfo.io](http://ipinfo.io) （我自己的服务）等第三方服务，根据设备的 IP 地址找出当前所在国家/地区的运营商代码，然后您可以将其与CTC 运营商详细信息，以确定设备是否正在漫游。这是标准的 ipinfo.io API 响应：

```
$ curl ipinfo.io/24.32.148.1 
{
    "ip": "24.32.148.1",
    "hostname": "doc-24-32-148-1.pecos.tx.cebridge.net",
    "city": "Pecos",
    "region": "Texas",
    "country": "US",
    "loc": "31.3086,-103.5892",
    "org": "AS7018 AT&T Services, Inc.",
    "postal": "79772"
} 
```

可以使用自定义包，其中还包括移动 IP 的 mnc/mcc 详细信息。有关详细信息，请参阅[http://ipinfo.io/developers](http://ipinfo.io/developers)。

# php - cookie 不会被销毁的部分原因可能是什么？

> ID：900550
> 
> 赞同：1
> 
> 时间：2009-05-23T00:42:40.597
> 
> 标签：php

我设置了一个名为 MVCID 的 cookie，它的值是一些生成的哈希。当我写这个

```
setcookie("MVCID","", time()-60*60*24); 
```

并加载页面，不仅 cookie 的内容没有被删除，而且它也没有消亡。

可能是什么问题？这不是第一次发生这种情况。

ps：我也在一个没有其他代码的空页面上尝试这个，但是它仍然不会死。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T00:52:05.680

尝试传递“/”作为第四个参数——*路径*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T00:53:19.093

您是否在输出任何 HTML*之前*调用此函数？这是该调用的一个已知缺点，因为 cookie 必须出现在 HTTP 标头中。

您可能还想检查客户端的时间。即使您设置在一天前到期，时钟偏差也可能更大（如果时间设置不正确）。

而且我更喜欢填充*所有*参数而不是依赖默认值（可以根据许多事情进行更改）。

此外，您可能想检查返回码，尽管我不知道它是如何失败的，例如：

```
<?php
    $ret = setcookie("MVCID","", time()-60*60*24);
?>
<html>
    <head></head>
    <body>
        Hello<br>
        <pre>
            <?php
                print_r ($ret);
            ?>
        </pre>
    </body>
</html> 
```

如果做不到这一点，您可能需要查看线路级别的情况。换句话说，检查 HTTP 响应以确保`Set-Cookie`HTTP 标头中有 a 并检查与它一起传递的实际值。

最后一个技巧可以尝试：完全删除 cookie 并退出浏览器（其中一些缓存在内存中）。然后再试一次。如果 PHP setcookie 不起作用，则不会创建任何 cookie - 您拥有的未更改或过期的 cookie 可能是您代码的先前成功变体遗留下来的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T12:59:54.267

使用诸如[firebug](https://addons.mozilla.org/firefox/addon/1843)或[fiddler](http://www.fiddler2.com/)之类的东西来检查实际的响应标头（包含“真实”cookie 和包含“删除”cookie）

# algorithm - 数据压缩研究的推荐资源

> ID：900559
> 
> 赞同：2
> 
> 时间：2009-05-23T00:47:44.097
> 
> 标签：algorithm, data-compression

我正在寻找有关数据压缩的推荐资源；任何关于技术、数据结构和/或算法的研究；任何与研究相关的有用资源、任何书籍、组织或任何其他信息都会有所帮助。

我知道这是一个一般性的查询，但只是对扩展我对该主题的知识感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T00:50:11.113

检查这个：[http](http://datacompression.info/) ://datacompression.info/ （数据压缩门户）

一些有趣的文章：

*   算术编码： http: [//www.dogma.net/markn/articles/arith/part1.htm](http://www.dogma.net/markn/articles/arith/part1.htm)
*   霍夫曼编码： [http ://www.geocities.com/SiliconValley/2151/huffman.html](http://www.geocities.com/SiliconValley/2151/huffman.html)
*   LZW： http: [//marknelson.us/1989/10/01/lzw-data-compression/](http://marknelson.us/1989/10/01/lzw-data-compression/)
*   BWT： http: [//marknelson.us/1996/09/01/bwt/](http://marknelson.us/1996/09/01/bwt/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T01:04:19.943

[这份 1987 年](http://doi.acm.org/10.1145/45072.45074)关于数据压缩的调查论文涵盖了最初的 40 年左右，看起来不错。

附带说明一下，在“扩展 [您] 对主题的知识”类别中的[是](http://video.google.com/videoplay?docid=4358667732166276191). [ARC](http://en.wikipedia.org/wiki/ARC_(file_format))与 . 1990 年代初期的[ZIP争议。](http://en.wikipedia.org/wiki/ZIP_(file_format))这是对这些压缩“战争”的人性化一面的迷人观察。

当时我是一个活跃的 BBS 用户，并没有意识到事情的全貌。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-12T12:39:10.333

我 2015 年的论文[A Survey Of Architectural Approaches for Data Compression in Cache and Main Memory Systems](https://www.academia.edu/12429529/A_Survey_Of_Architectural_Approaches_for_Data_Compression_in_Cache_and_Main_Memory_Systems) （[此处](http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=7110612)为永久链接）回顾了许多压缩算法以及在现代处理器中使用它们的技术。它回顾了研究级和商业级压缩算法/技术，因此您可以从本文引用的参考资料中找到许多相关的压缩技术。

# git - Git：从以前的提交中签出文件并将其修改为 HEAD

> ID：900560
> 
> 赞同：73
> 
> 时间：2009-05-23T00:47:44.517
> 
> 标签：git, version-control

我最近向我的分支的 HEAD 提交了一个文件，其中有错误。我需要做以下事情：

*   从 HEAD 之前的一次提交中获取该文件

*   将该文件提交回 HEAD

最好的方法是什么？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2009-05-23T00:51:06.070

您实际上自己说过：

首先从之前的一次提交中取回文件：

```
$> git checkout HEAD~1 path/to/file.ext 
```

然后提交：

```
$> git commit -a -m 'Retrieved file from older revision' 
```

如果仅在上次提交中存在对该文件的更改，您甚至可以使用`git-revert`：

```
$> git revert HEAD 
```

我认为将其作为单独的提交会更好，因为它会准确地告诉您您已恢复的内容以及原因。但是，您可以使用`--amend`切换到`git-commit`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-13T19:36:48.733

小心，在这种情况下：

```
Commit hash - File modified
aaaaaaa       index.php
bbbbbbb       test.php
ccccccc       index.php 
```

Git checkout HEAD~1（或 HEAD^）index.php 尝试将 index.php 文件签出到前一个 HEAD 哈希（bbbbbbb），但这不是真正的前一个提交哈希文件，是 ccccccc。在之前的 HEAD 哈希中，index.php 仍然保持不变，因为最后一次更改是在哈希 ccccccc 中进行的。

要将某些文件恢复为影响该文件的先前提交哈希，请使用：

```
git log -n 2 --pretty=format:%h path/to/file.ext 
```

忽略第一个哈希并取第二个哈希，然后：

```
git checkout <second_hash> path/to/file.ext
git commit -m 'Revert this file to real previous commit' 
```

# windows - 使用 .BAT 检查程序何时完成运行

> ID：900561
> 
> 赞同：0
> 
> 时间：2009-05-23T00:48:45.187
> 
> 标签：windows, process, batch-file

我将如何检查特定程序是否已完成运行？

我正在尝试制作一个自动运行一系列.exe（特别是安装程序和许多补丁）的脚本。

到目前为止，我已经能够让它们同时运行，但这显然不是我所需要的。

我怎样才能让它们在另一个完成后运行？

我查看了一些已经发布的内容，但无法将它们修改为我需要的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T00:54:53.957

使用此语法从 bat 运行您的 exe

```
start /wait foo.exe 
```

等待可执行文件返回，然后再继续执行 bat 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T00:55:15.470

你能指定你使用什么方法来运行这些程序吗？不止一个。

例如，如果您使用“START”，则有一个“/WAIT”开关负责等待。

# .net - ASPX ..重命名了一个库..现在错误

> ID：900571
> 
> 赞同：0
> 
> 时间：2009-05-23T00:54:15.690
> 
> 标签：.net, asp.net, visual-studio, iis

我的一个网站在我的解决方案中引用了一个名为“Foo”的库该项目生成一个名为“Foo.dll”的文件，其中的类位于名为“MyCompany.Foo”的命名空间中

到目前为止一切都解决了......好吧，我右键单击项目“Foo”并将其输出的文件名更改为“MyCompany.Foo”......现在项目生成一个文件“MyCompany.Foo.dll”一切仍然编译正常，但是当我尝试访问我的网站时，它说找不到参考或文件“Foo”

> 解析器错误
> 
> 说明：解析服务此请求所需的资源时出错。请查看以下特定的解析错误详细信息并适当地修改您的源文件。
> 
> 解析器错误消息：无法加载文件或程序集“Foo”或其依赖项之一。该系统找不到指定的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T01:11:59.587

没关系，这是我自己的愚蠢。

在我的 web.config 中，我有一个对 Foo 的引用，我需要将其更改为 MyCompany.Foo

我对 Foo.dll 进行了全局搜索......但在这种情况下，程序集最后被引用，没有 dll

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T00:56:51.083

这可能是很多事情。

打开 Visual Studio 和您的解决方案文件。然后键入 ctrl+f 并在 ALL 解决方案中搜索 Foo.dll。用 MyCompany.Foo.dll 替换任何出现的 Foo.dll

希望这可以帮助。

编辑：如果您将 foo.dll 中的名称空间从名称空间 foo 更改为名称空间 MyCompany.Foo，那么您可能需要进行其他更改，但我想您不需要。

此外，请确保在您的 ASP.NET 项目中，引用条目的 Copy Local 属性设置为 True。

# javascript - 使用 JQuery 在 IE8 中不更新 ScrollHeight

> ID：900572
> 
> 赞同：2
> 
> 时间：2009-05-23T00:54:23.757
> 
> 标签：javascript, jquery, html, scroll, append

我正在尝试将一些文本（div）附加到可滚动的 div，然后自动滚动底部。

出于某种原因，当我尝试在 IE8 中执行此操作时，它不起作用。取消注释 'alert' 行表明 IE8 返回 ScrollHeight 属性的两个值。

Jquery 追加是异步运行还是 DOM 需要时间来刷新？

处理这个问题的正确方法是什么？

有问题的HTML页面：

款式：

```
.scrollbox
{
   border-style: solid;
   overflow-y: scroll;
   padding: 5px;
   margin: 20px;
   border-color: #C0C0C0;
   height: 400px;
   width: 500px;
   font-family: "Times New Roman", Times, serif;
   font-size: 20px;
   color: #333333;
} 
```

jQuery脚本：

```
$(document).ready(function() {
    var node = $("#list");
    for (i = 1; i <= 100; i++) {
        node.append("<div>Item :" + i + "</div>");
    }
    //alert(node.attr("scrollHeight"));
    //alert(node.attr("scrollHeight"));
    node.animate({ scrollTop: node.attr("scrollHeight") }, 500);
}); 
```

身体：

```
<div id="list" class="scrollbox"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-06-30T18:34:04.200

我也遇到了这个问题——对我来说这似乎是 IE8 的一个缺陷（兼容模式没有表现出相同的行为）。在我的情况下，我只读取一次值以“启动”它并忽略结果，然后后续读取是正确的。不理想，但似乎工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T01:30:42.183

您是否尝试过使用`node.outerHeight()`而不是获取 scrollHeight 的值？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T01:37:03.763

尝试使用 jQuery 的 innerHeight() 值，我也相信你需要 'px' 的值。

```
node.animate({ scrollTop: node.innerHeight() + 'px' }, 500); 
```

# iphone - 有人成功调试过 iPhone 的单元测试吗？

> ID：900577
> 
> 赞同：8
> 
> 时间：2009-05-23T00:55:30.697
> 
> 标签：iphone, unit-testing, xcode, gdb

[我在这里找到了有关如何在 Cocoa](http://chanson.livejournal.com/120740.html)或[ADC 页面](http://developer.apple.com/mac/articles/tools/unittestingwithxcode3.html)中调试单元测试的示例。但我无法让调试适用于 iPhone 应用程序目标。我可以启动并运行测试，它们在构建期间运行，但我需要*调试*测试以解决一些更复杂的故障。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T06:54:43.317

您可能会考虑将您的测试移动到[GHUnit](http://rel.me/2009/02/21/unit-testing-for-mac-os-x-and-iphone-ghunit/)，它们在普通应用程序目标中运行，因此调试很简单。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-01-05T20:18:42.633

这可以通过为使用 otest 工具运行单元测试的项目设置一个单独的可执行文件来完成，在为可执行文件设置一堆相关的环境变量之后。我已经使用这种方法成功调试了 SenTestKit 逻辑单元测试。

我发现以下链接很有帮助：

[http://www.grokkingcocoa.com/how_to_debug_iphone_unit_te.html](http://www.grokkingcocoa.com/how_to_debug_iphone_unit_te.html)（还包含修复设置项目时遇到的常见错误的帮助）。

[http://cocoawithlove.com/2009/12/sample-iphone-application-with-complete.html](http://cocoawithlove.com/2009/12/sample-iphone-application-with-complete.html)（涵盖逻辑测试和应用测试）

[http://developer.apple.com/mac/library/documentation/Darwin/Reference/ManPages/man1/otest.1.html（otest](http://developer.apple.com/mac/library/documentation/Darwin/Reference/ManPages/man1/otest.1.html) XCode 工具的手册页）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T04:58:01.900

NSLog 消息显示在 Console.app 中

应该给你一个起点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-20T03:35:38.647

在 Xcode 4 中，您可以在单元测试中设置断点。

1.  创建一个选中“包含单元测试”的新项目。
2.  在失败的单元测试中放置一个断点。
3.  按 Command-U 进行测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-15T18:51:40.360

如果您执行 Build & Go 而不是仅仅构建，那么您可以在单元测试中设置断点并以传统方式对其进行调试。这是如果您使用 google 工具箱进行 iphone 单元测试；我不知道你是怎么做的，以及过程是否不同。

# command-line - Vista命令行上的递归文件复制和重命名

> ID：900578
> 
> 赞同：3
> 
> 时间：2009-05-23T00:56:06.997
> 
> 标签：command-line, windows-vista, recursion, copy, for-loop

我试图通过我的音乐目录递归并将每个名为folder.jpg的文件复制到同一目录中名为cover.jpg的文件中。

我在[这个问题](https://stackoverflow.com/questions/210413/command-line-recursive-rename-move-in-windows)中尝试了各种不同的建议，例如：

```
for /r %i in (folder.jpg) do copy %i cover.jpg 
```

导致“系统找不到指定的文件”。

我怎么解决这个问题？

**编辑**

这是我最终的结果：

```
for /r %i in (folder.jpg) do copy "%i" "%~picover.jpg" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T02:32:03.980

试试这个：

```
for /f "usebackq delims==" %I in (`dir /b /s ^| findstr folder.jpg`) do copy "%I" "%~pIcover.jpg" 
```

解码环：

```
usebackq :: 运行反引号中的命令并将输出用作循环的输入
delims== :: 使用等号作为分隔符。真的，您可以使用文件名中无效的任何字符
dir /b /s :: 做一个递归目录列表只输出裸文件名
^| :: ^ 转义管道字符，管道 - 将第一个命令的输出通过管道传输到第二个
findstr :: 在输入中搜索匹配的行，并且只输出它们
%~pI :: 波浪号 p 指示变量扩展仅输出路径而不是完整的文件名 + 路径。请注意，这包括尾随 \

```

我希望这有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T01:02:43.910

您的音乐文件夹中可能没有任何名为 folder.jpg 的文件，所以它失败了，对吧？

我在 mymusic 文件夹中使用名为 folder.jpg 的虚拟文件进行了尝试，它正常复制了它。;)

编辑：

Kishi 是对的，您在第二个 %i 上缺少双引号

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T01:07:51.653

您在复制命令中缺少双引号。

%i 变量将保存文件的完整路径——其中可能包含空格。尝试使用：

```
for /r %i in (folder.jpg) do copy "%i" cover.jpg 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T03:35:34.633

PowerShell 必须替换 CMD。这是不可避免的，也是正义的。我的工作就是帮助它……

```
gci -r . folder.jpg | % { copy $_.FullName ([IO.Path]::Combine( $_.Directory.FullName, "cover.jpg" )) } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T02:01:35.350

您可以将 xcopy 与 /s 标志一起使用...

编辑：我的错 - 没有正确阅读问题。仅将文件复制到固定目标时，带有 /s 的 Xcopy 将有所帮助。

# f# - 为什么 OCaml/F# 中的函数默认不递归？

> ID：900585
> 
> 赞同：110
> 
> 时间：2009-05-23T00:59:13.607
> 
> 标签：f#, recursion, ocaml

为什么默认情况下 F# 和 OCaml（可能还有其他语言）中的函数不是递归的？

换句话说，为什么语言设计者认为明确地让你输入`rec`如下声明是个好主意：

```
let rec foo ... = ... 
```

并且默认不赋予函数递归能力？为什么需要显式`rec`构造？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-12-11T23:37:50.493

最初的 ML 的法国和英国后裔做出了不同的选择，他们的选择几十年来一直被继承到现代变体中。所以这只是遗留问题，但它确实会影响这些语言的习语。

在法语 CAML 系列语言（包括 OCaml）中，函数默认不是递归的。这种选择使取代`let`在这些语言中使用的函数（和变量）定义变得容易，因为您可以在新定义的主体内引用先前的定义。F# 从 OCaml 继承了这种语法。

例如，`p`在 OCaml 中计算序列的香农熵时取代函数：

```
let shannon fold p =
  let p x = p x *. log(p x) /. log 2.0 in
  let p t x = t +. p x in
  -. fold p 0.0 
```

注意`p`高阶`shannon`函数的参数是如何`p`被主体的第一行中的另一个替代的，然后是主体`p`第二行中的另一个。

相反，ML 语言家族的英国 SML 分支采取了另一种选择，并且 SML 的`fun`-bound 函数默认情况下是递归的。当大多数函数定义不需要访问其函数名称的先前绑定时，这会导致代码更简单。但是，被取代的函数使用不同的名称（`f1`等`f2`），这会污染范围并可能意外调用错误的函数“版本”。现在隐式递归`fun`绑定函数和非递归`val`绑定函数之间存在差异。

Haskell 可以通过将定义限制为纯定义来推断定义之间的依赖关系。这使玩具样品看起来更简单，但在其他地方却付出了沉重的代价。

请注意，Ganesh 和 Eddie 给出的答案是红鲱鱼。他们解释了为什么不能将函数组放在一个巨大的内部，`let rec ... and ...`因为它会影响类型变量何时被泛化。这与 SML 中的默认值无关，但与`rec`OCaml 中的默认值无关。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-05-24T21:37:57.227

显式使用的一个关键原因`rec`是与 Hindley-Milner 类型推断有关，它是所有静态类型函数式编程语言的基础（尽管以各种方式进行了更改和扩展）。

如果你有一个定义`let f x = x`，你会期望它有类型`'a -> 'a`并且适用于`'a`不同点的不同类型。但同样，如果你写`let g x = (x + 1) + ...`，你会期望`x`在.`int``g`

Hindley-Milner 推理处理这种区别的方式是通过明确的*概括*步骤。在处理程序的某些时刻，类型系统停止并说“好的，此时这些定义的类型将被泛化，因此当有人使用它们时，其类型中的任何自由类型变量都将被*重新*实例化，因此不会干扰该定义的任何其他用途。”

事实证明，进行这种概括的明智之处是在检查一组相互递归的函数之后。任何更早的，你都会概括太多，导致类型实际上可能发生冲突的情况。稍后，您将泛化得太少，从而使定义不能用于多种类型的实例化。

那么，鉴于类型检查器需要知道哪些定义集是相互递归的，它可以做什么呢？一种可能性是简单地对范围内的所有定义进行依赖性分析，并将它们重新排序为尽可能小的组。Haskell 实际上是这样做的，但是在像 F#（以及 OCaml 和 SML）这样具有不受限制的副作用的语言中，这是一个坏主意，因为它也可能对副作用进行重新排序。因此，它要求用户明确标记哪些定义是相互递归的，从而扩展应该在哪里进行泛化。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-23T02:05:55.170

这是一个好主意有两个关键原因：

首先，如果您启用递归定义，那么您不能引用以前绑定的同名值。当你在做一些像扩展现有模块这样的事情时，这通常是一个有用的习惯用法。

其次，递归值，尤其是相互递归值的集合，更难推理，因为定义是按顺序进行的，每个新定义都建立在已经定义的之上。阅读这样的代码时最好能保证，除了明确标记为递归的定义外，新定义只能引用以前的定义。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-23T01:29:35.337

一些猜测：

*   `let`不仅用于绑定函数，还用于绑定其他常规值。大多数形式的值不允许递归。某些形式的递归值是允许的（例如函数、惰性表达式等），因此需要明确的语法来表明这一点。
*   优化非递归函数可能更容易
*   创建递归函数时创建的闭包需要包含一个指向函数本身的条目（以便函数可以递归调用自身），这使得递归闭包比非递归闭包更复杂。因此，当您不需要递归时，能够创建更简单的非递归闭包可能会很好
*   它允许您根据先前定义的函数或同名值来定义函数；虽然我认为这是不好的做法
*   额外的安全？确保你正在做你想做的事。例如，如果您不打算将其递归，但您不小心在函数内部使用了与函数本身同名的名称，它很可能会抱怨（除非之前已定义该名称）
*   该`let`构造类似于`let`Lisp 和 Scheme 中的构造；这是非递归的。Scheme中有一个单独的`letrec`构造用于递归让我们

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-12-22T05:30:16.877

鉴于这种：

```
let f x = ... and g y = ...;; 
```

比较：

```
let f a = f (g a) 
```

有了这个：

```
let rec f a = f (g a) 
```

前者重新定义`f`以将先前定义的应用到应用到`f`的结果中。后者重新定义为循环永远应用于，这通常不是您在 ML 变体中想要的。`g``a``f``g``a`

也就是说，这是语言设计师风格的事情。放手去做。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-24T22:36:23.147

其中很大一部分是它使程序员可以更好地控制其本地范围的复杂性。的频谱`let`，`let*`并`let rec`提供越来越高的功率和成本水平。`let*`并且`let rec`本质上是 simple 的嵌套版本`let`，因此使用任何一个都更昂贵。此分级允许您对程序的优化进行微观管理，因为您可以选择手头任务所需的级别。如果您不需要递归或引用先前绑定的能力，那么您可以依靠一个简单的 let 来节省一些性能。

它类似于 Scheme 中的分级相等谓词。（即`eq?`和）`eqv?``equal?`

# apache-flex - 在构建时禁用项目刷新

> ID：900586
> 
> 赞同：0
> 
> 时间：2009-05-23T00:59:16.163
> 
> 标签：apache-flex, eclipse, flexbuilder

在 Eclipse 的 Flex 3 Perspective 中，是否可以在构建后禁用项目的刷新？怎么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T17:38:28.800

我联系了 Adob​​e 支持，在 Flex 3 中无法在不破坏 Flex 的情况下禁用任何刷新。真可惜。

# python - 了解python导入

> ID：900591
> 
> 赞同：3
> 
> 时间：2009-05-23T01:04:11.223
> 
> 标签：python, django, import

在学习Django和Python的过程中。我无法理解这一点。

（示例注释：'helloworld' 是我的项目的名称。它有 1 个名为 'app' 的应用程序。）

```
from helloworld.views import *          # <<-- this works
from helloworld import views            # <<-- this doesn't work
from helloworld.app import views        # <<-- but this works.  why? 
```

似乎第 2 行和第 3 行实际上是相同的。为什么喜欢 #2 不起作用？

**编辑——添加了两个文件的来源。**[您可能会从 Django Book 项目 ( http://www.djangobook.com/en/2.0](http://www.djangobook.com/en/2.0/) ) 中认出这段代码

## 你好世界/views.py

```
from django.shortcuts import render_to_response
from django.http import HttpResponse, Http404
import datetime

def hello(request):
    return HttpResponse("Hello world")

def current_datetime(request):
    current_date = datetime.datetime.now()
    return render_to_response('current_datetime.html', locals())

def offset_datetime(request, offset):
    try:
        offset = int(offset)
    except ValueError:
        raise Http404()

    next_time = datetime.datetime.now() + datetime.timedelta(hours=offset)
    return render_to_response('offset_datetime.html', locals())

def display_meta(request):
    values = request.META.items()
    values.sort()
    path = request.path
    return render_to_response('metavalues.html', locals()) 
```

## helloworld/app/views.py

```
from django.shortcuts import render_to_response

def search_form(request):
    return render_to_response('search_form.html')

def search(request):
    if 'q' in request.GET:
        message = 'You searched for: %r' % request.GET['q']
    else:
        message = 'You searched for nothing.'

    return render_to_response('search_results.html', locals()) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-23T02:35:50.523

Python 导入可以导入两种不同的东西：模块和对象。

```
import x 
```

导入一个名为`x`.

```
import x.y 
```

导入一个名为`y`container的模块`x`。你参考`x.y`。

但是，当您创建它时，您创建了这个目录结构

```
x
    __init__.py
    y.py 
```

当您添加到 import 语句时，您确定要从模块中提取的特定对象并移动到全局命名空间中

```
import x # the module as a whole
x.a # Must pick items out of the module
x.b

from x import a, b # two things lifted out of the module
a # items are global
b 
```

如果 helloworld 是一个包（一个目录，一个`__init__.py`文件），它通常不包含任何对象。

```
from x import y # isn't sensible
import x.y # importing a whole module. 
```

有时，您将在`__init__.py`文件中定义对象。

通常，使用“from module import x”从模块中挑选特定对象。

用于`import module`导入整个模块。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T01:18:24.660

```
from helloworld.views import *          # <<-- this works
from helloworld import views            # <<-- this doesn't work
from helloworld.app import views        # <<-- but this works.  why? 
```

#2 和 #3*不*一样。

第二个`views`从包中导入`helloworld`。第三个是`views`从包中导入的`helloworld.app`，它是`helloworld`. 这意味着视图特定于您的 django 应用程序，而不是您的项目。如果您有单独的应用程序，您将如何从每个应用程序导入视图？您必须指定要从中导入的应用程序的名称，因此语法为`helloworld.app`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T01:21:44.450

正如 sykora 所暗示的，helloworld 本身并不是一个包，所以#2 不起作用。你需要一个 helloworld.py，适当地设置。

几天前我问过关于导入的问题，这可能会有所帮助： [在 Python 中布局导入路径，简单明了吗？](https://stackoverflow.com/questions/860672/lay-out-import-pathing-in-python-straight-and-simple)

# sql - SQL从vb中的表中读取数据

> ID：900592
> 
> 赞同：1
> 
> 时间：2009-05-23T01:04:18.773
> 
> 标签：sql, sql-server, vb.net

我正在尝试从数据中获取单个字段。（我正在按主键搜索，所以我应该得到 0 或 1 个答案）。请帮忙。我正在查询的表有一个用户 = 某人的条目，输入到几列，其中 ans 列具有“一个好的答案”

* * *

### 代码：

```
Dim reader As SqlDataReader
Dim par As SqlParameter
Dim result As String

Dim sqlconn As SqlConnection
sqlconn = New SqlConnection("....")
sqlconn.Open()

Dim sqlcmd As SqlCommand
sqlcmd = New SqlCommand("Select Ans From Test Where User = @auser", sqlconn)

par = New SqlParameter
par.ParameterName = "auser"
par.Value = Textbox1.Text

sqlcmd.Parameters.Add(par)

reader = sqlcmd.ExecuteReader()

result = reader.GetString(0)

''//output to label
label1.Text = result 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T01:09:17.250

您需要先读取数据阅读器才能将其放在第一行。

所以而不是

```
reader = sqlcmd.ExecuteReader()    
result = reader.GetString(0) 
```

您将像这样插入 Read() 方法：

```
reader = sqlcmd.ExecuteReader()    
if reader.Read() then '' <<<<< newly inserted code
    result = reader.GetString(0)
end if 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T01:38:15.930

```
''// using statement will guarantee the object is closed and disposed
''// even if an exception occurs
Using sqlconn As New SqlConnection("...."), _
      sqlcmd As  New SqlCommand("Select Ans From Test Where User = @auser", sqlconn)

    ''// you can create, add, and set the value for a parameter all on one line
    sqlcmd.Parameters.Add("@auser", SqlDbType.VarChar, 50).Value = Textbox1.Text

    ''//wait as long as possible to open the connection
    sqlconn.Open() 

    ''// if you're only getting the first column of the first row, use execute scalar
    label1.Text = CString(sqlcmd.ExecuteScalar())

End Using 
```

# php - PHP Subversion 设置 FTP

> ID：900594
> 
> 赞同：3
> 
> 时间：2009-05-23T01:07:10.237
> 
> 标签：php, svn, ftp

我在一家小型 php 商店工作，最近我提议我们不再使用 nas 作为共享代码库，而是开始使用 subversion 进行源代码控制。

我已经想出了如何确保我们的开发服务器在每次提交到我们的开发分支时都得到更新......而且我知道如何合并到主干并更新我们的登台服务器，因为我们可以直接访问这两者，但我最大的问题是如何编写一个脚本来更新生产服务器，我们很多时候只能通过 ftp 访问。我不想每次都上传整个网站......有没有办法编写一个足够聪明的脚本，以便在我们执行它时只将更改的内容上传到网络服务器（不希望它自动成为上传到生产环境，我们要手动执行）？

我的问题甚至有意义吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T09:37:52.520

基本上，您的问题是您不能在生产服务器上使用颠覆。您需要做的是在单独的（理想情况下配置相同的）服务器上保留生产结帐的副本，并通过任何方法将其复制到生产服务器。实际上，您可以将其视为您的登台服务器，因为它对于在发布之前对版本进行最终测试也很有用。

就副本而言，如果您的提供商支持[`rsync`](http://en.wikipedia.org/wiki/Rsync)，您就可以了。如果您只有 FTP，则必须找到某种方法来通过 FTP 进行 rsync 等效。这不是第一次有人有这种需要。网络搜索将为您提供帮助。但是，如果您找不到任何东西，请给我留言，我会进一步环顾四周。

编辑：希望作者不介意我添加这个，但我认为它属于这里。要使用 ftp 执行类似于 rsync 的操作，请查看 weex [http://weex.sourceforge.net/](http://weex.sourceforge.net/)。它是命令行 ftp 的包装器，它使用本地镜像来跟踪远程服务器上的内容，以便它只能发送更改的文件。对我很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T01:14:12.983

[听起来](http://svn.haxx.se/users/archive-2006-12/0545.shtml)SVN 不能很好地与 FTP 配合使用，但如果您有 http 访问权限，这可能证明足以使用svnsync[推送](http://svnbook.red-bean.com/en/1.4/svn.ref.svnsync.html)更改。这就是我们将更改推送到生产服务器的方式——我们使用 svnsync 来保持存储库的只读镜像可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T10:41:30.550

我使用以下解决方案。只需在您的网络服务器上安装 SVN 客户端，并将其附加到一个可私人访问的 url 中：

```
 <?php

    // make sure you have a robot account that can't commit ;) 
    $username = Settings::Load()->Get('svn', 'username');
    $password = Settings::Load()->Get('svn', 'password');
    $repos = Settings::Load()->Get('svn', 'repository');

    echo '<h1>updating from svn</h1><pre>';
    // for secutity, define an array of folders that you do want to be synced from svn. The rest should be skipped.
    $svnfolders = array(    'includes/' ,'plugins/' ,'images/' ,'templates/', 'index.php' => 'index.php');

    if(!empty($_GET['justthisone']) && array_search($_GET['justthisone'], $svnfolders) !== false){ // you can also just update one of above by passing it to $_GET
        $svnfiles = array($_GET['justthisone']);
    }

    foreach($svnfiles as $targetlocation)
    {   
        echo system("svn export --username={$username} --password {$password} {$repos}{$targetlocation} ".dirname(__FILE__)."/../{$targetlocation} --force");
    }

    die("</pre><h1>Done!</h1>"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T01:37:08.693

我将在这里做一个假设，并说您正在使用提交后挂钩来合并/更新您的登台服务器。这可能有效，但我强烈建议您研究[持续集成](http://en.wikipedia.org/wiki/Continuous_Integration)解决方案。以下是我知道的一些：

1.  Xinc - [http://code.google.com/p/xinc/](http://code.google.com/p/xinc/)（特定于 PHP）
2.  CruiseControl - [http://cruisecontrol.sourceforge.net/](http://cruisecontrol.sourceforge.net/)（非常受欢迎。）通过[http://phpundercontrol.org/about.html实现 PHP 集成](http://phpundercontrol.org/about.html)
3.  Hudson - [ [https://hudson.dev.java.net/]](https://hudson.dev.java.net/])（似乎是基于 Java 的，但允许插件/扩展）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T10:04:50.267

[LFTP](http://lftp.yar.ru/)能够通过 ftp 同步目录。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T10:57:52.453

只是一个想法：

您可以在您有权访问且安装了 subversion 的主机上保存项目的修订版。这个单一修订反映了生产服务器的版本。您现在可以编写一个 PHP 脚本，通过 svn 更新此存储库，然后查找自 rep 更新以来已更改的所有文件。您可以上传这些文件。

这样的脚本可能如下所示：

```
$path = realpath( '/path/to/production/mirror' );
chdir( $path );

$start = time();
shell_exec( 'svn co' );

$list = array();
$i = new RecursiveIteratorIterator( new RecursiveDirectoryIterator( $path ), RecursiveIteratorIterator::SELF_FIRST );

foreach( $i as $node )
{

    if ( $node->isFile() && $node->getCTime() > $start )
    {

        $list[] = $node->getPathname();

    } 

    // directories should also be handled

}

$conn = ftp_connect( ... );

// and so on 
```

就像我想到的那样。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-26T17:55:32.427

我想这会对你有所帮助

[https://github.com/midhundevasia/deploy](https://github.com/midhundevasia/deploy)

它在 Windows 中运行良好。

# programming-languages - 我应该为桌面 Windows 应用程序使用哪个开发平台？

> ID：900596
> 
> 赞同：4
> 
> 时间：2009-05-23T01:08:10.747
> 
> 标签：programming-languages

在做了一段时间的 Web 开发之后，我遇到了一个新客户，他想要一个简单的数据库应用程序在互联网之外运行。

他非常坚持使用微软的产品。“我们不希望没有恶意的开源”是他的立场。

自从我真正进行桌面开发以来已经有一段时间了，而且我的大多数工具都生锈了，没有许可证，或者只是完全丢失了。我最近一直专注于 LAMP 应用程序，但这并没有完全转移回桌面环境。

一些选项：

```
数据库：MySql（我的最爱）、Access、MSSql
语言：C++、VB、PHP、Java、C#

```

我一直倾向于 Access/VisualBasic，不是因为我非常喜欢它，而是因为它易于设置和部署。对于新手计算机用户来说，数据库服务器（MySql、MsSql）可能很难部署/维护。即使从纯粹主义者的角度来看，C++ 是更好的语言，但引导应用程序（恕我直言）会花费太多精力。Java 太麻烦了（再次恕我直言）。

另一个考虑因素是成本。虽然我可以说服他获得适当的软件运行时许可证，但我可能无法让他购买必要的开发工具，而且项目支付的费用肯定不足以证明大量购买可能不会再次使用的合理性。

非常感谢您在平台选择、开发工具和应用程序框架方面的意见。

编辑 2009 年 5 月 23 日

谢谢大家的出色建议。

我已经选择了 C# Express。到目前为止，我一直避免学习 C#，但是另一种语言是什么？我有一整周的时间来跟上进度。

我在纠结是使用 Access 还是 MSSql (Express) 数据库。使用 Access，我可以将数据库部署为独立文件，但 MSSql 要求安装数据库服务器。（AFAIK）

客户端要求将应用程序安装在多个位置，其中一些是移动的并且未连接到互联网。冒险的部分是协调数据库的所有副本，并确定哪个是connonical 版本。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T01:13:14.217

我会选择 C# 和 MSSQL 的[Express 版本](http://www.microsoft.com/Express/)。免费且易于使用/设置/部署。这里有一个更深入的链接，指向一些专门关于将 VS Express 版本用于 Windows 应用程序的[一般材料。](http://www.microsoft.com/express/windowsdevelopment/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T01:10:49.433

C# + MSAccess/MSSql(express) = 利润。

我不确切知道您的要求，但我会建议以下内容：

**如果你有预算：**

*   Visual Studio 专业版
*   MS SQL 或访问
*   用于表单和数据库持久性的 DevExpress 组件。

**如果你没有预算**

*   Visual Studio 速成版
*   mysql
*   NHibernate 或 Linq2Entities
*   WPF 或 Windows 窗体

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T02:11:08.827

我建议：**只需使用 Access。**它适用于小型、简单的单用户数据库。它不仅仅是一个“数据库”，它本身也是一个“数据库应用程序”和“数据库应用程序开发环境”。那就是：将数据库、CRUD 表单和简单的报告放在一起非常快速和容易；并且内置的 VBA 可以处理大多数业务逻辑，如果您需要做任何“有趣”的事情，您可以随时调用 C# dll。

只需告诉客户他们需要在开发期间向您借出*生产*盒（很公平），而 Access（无需提及哪个版本）约为 200.00 美元。

不付款的客户得到的是他们想要的，而不是他们需要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T01:15:02.310

Microsoft Visual Studio 有便宜或免费的速成版。也就是说，选择很明显：带有 C# 或 Visual Basic .Net（这只是一个语法问题）的 Winforms 与 MySql 后端（用于成本问题）对话。

Microsoft Winforms 很棒，但仅限于 Windows（尽管是 Mono）。享受这个项目。在我看来，它比 LAMP 更有趣，但没有那么普遍。

**编辑：**如果您有额外的时间和耐心（当然，您将不得不花时间而不是花费学习时间），尽管 C# 非常出色且非常成熟（即使在 .Net 1.1 中也是如此:)，您可能想要使用 .Net 的 Python 变体之一编写应用程序。这就是我要做的... Python 拥有大量的追随者，并且可能会在您非 Microsoft 的未来某个时候出现。另一方面，C# ......好吧，如果你使用 Mono，它可能会出现，但除此之外，这就像学习意大利语：在意大利很好，但在其他方面无用。（我应该知道，我是在威尼斯的地方写这篇文章的……）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T01:23:56.177

我不知道你为什么认为另一个数据库引擎比 MS SQL 更容易管理。有一个免费的 MS SQL 版本，称为“Express”，可能适合。它支持与完整数据库引擎相同的所有 DDL 和 SQL 功能：以备不时之需；它只是在 CPU 的大小和数量上受到限制。

同样，还有免费/快速版的开发人员工具，它们并没有缺少太多功能（最显着的可能是编写安装程序的能力，但还有其他免费的方法可以做到这一点）。我不知道 PHP 或 Java，但如果让我在 C++ 和 C# 之间进行选择（我对两者都很熟悉），我会说 C# 实际上对于大多数应用程序都具有同样的能力，除了可能是软实时的，并且是相当容易和更愉快。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-23T01:28:26.807

我的首选是带有 MSSQL Express 的 C#。您可以将 Visual Studio Express Edition 用于您的开发环境。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-23T11:00:04.040

您是否考虑过[Delphi](http://www.codegear.com/en/products/delphi)或[C++Builder](http://www.codegear.com/en/products/cppbuilder)有可用的[免费版本](http://www.turboexplorer.com/delphi)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-23T01:13:42.703

C# 或 VB.Net 与 SQLite.Net 用于数据库。几乎是跨平台的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-23T02:35:19.463

如果您需要一个本地数据库，一个文件 (.dat) 或从一个 IDE (berkeleydb) 或 Sphinxsearch() 建议的文件 带有数据透视表的相关性排序顺序通常是用户想要的，并且不需要数据库，只需要根据文档或图形进行 i/o类型。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-05-23T01:13:45.790

如果您正在桌面上开发应用程序。我会说

*   脚本语言：ASP.NET(C#)
*   数据库：MS SQL 2005
*   服务器：带有 IIS 6 的 Windows Server 2003

# .net - 通用字符串加密

> ID：900610
> 
> 赞同：5
> 
> 时间：2009-05-23T01:16:33.540
> 
> 标签：.net, cryptography

我正在寻找.NET 中的通用字符串加密类。（不要与“SecureString”类混淆。）

我已经开始想出自己的类，但认为必须有一个 .NET 类已经允许您使用任何加密服务提供程序加密/解密任何编码的字符串。

```
Public Class SecureString

        Private key() As Byte
        Private iv() As Byte
        Private m_SecureString As String

        Public ReadOnly Property Encrypted() As String
            Get
                Return m_SecureString
            End Get
        End Property

        Public ReadOnly Property Decrypted() As String
            Get
                Return Decrypt(m_SecureString)
            End Get
        End Property

        Public Sub New(ByVal StringToSecure As String)
            If StringToSecure Is Nothing Then StringToSecure = ""
            m_SecureString = Encrypt(StringToSecure)
        End Sub

        Private Function Encrypt(ByVal StringToEncrypt As String) As String

            Dim result As String = ""
            Dim bytes() As Byte = Text.Encoding.UTF8.GetBytes(StringToEncrypt)

            Using provider As New AesCryptoServiceProvider()

                With provider
                    .Mode = CipherMode.CBC                  
                    .GenerateKey()
                    .GenerateIV()
                    key = .Key
                    iv = .IV
                End With

                Using ms As New IO.MemoryStream
                    Using cs As New CryptoStream(ms, provider.CreateEncryptor(), CryptoStreamMode.Write)
                        cs.Write(bytes, 0, bytes.Length)
                        cs.FlushFinalBlock()
                    End Using
                    result = Convert.ToBase64String(ms.ToArray())
                End Using

            End Using

            Return result

        End Function

        Private Function Decrypt(ByVal StringToDecrypt As String) As String

            Dim result As String = ""
            Dim bytes() As Byte = Convert.FromBase64String(StringToDecrypt)

            Using provider As New AesCryptoServiceProvider()

                Using ms As New IO.MemoryStream
                    Using cs As New CryptoStream(ms, provider.CreateDecryptor(key, iv), CryptoStreamMode.Write)
                        cs.Write(bytes, 0, bytes.Length)
                        cs.FlushFinalBlock()
                    End Using
                    result = Text.Encoding.UTF8.GetString(ms.ToArray())
                End Using

            End Using

            Return result

        End Function

    End Class 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T01:33:17.593

用于对称加密的[AES](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aes.aspx)算法通常是对字符串进行通用加密的方法。但是，恐怕 .NET BCL 不会为您进一步简化提供基本加密/解密类和功能的事情。

[您可以在此页面](http://www.obviex.com/samples/Encryption.aspx)上找到一个很好的示例，说明如何使用专门用于字符串加密的密码类。它看起来非常完整，并且确实得到了很好的评论——您甚至可能会发现无需任何进一步修改即可使用它。注意：*Rijndael是与**AES*相同的算法。（从技术上讲，前者指的是算法的真名，后者指的是*高级加密标准*。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T17:59:50.720

如果您尝试实现与 .NET 的 SecureString 相同的目标，那么您的示例确实不能解决问题。（我可能误解了你的目标，在这种情况下我道歉。）

.NET 的 SecureString 的想法是，它将加密的字符串数据存储在非托管内存块中，一旦创建就不可变，并且不能使用普通字符串变量在 .NET 中读取。这可以保护字符串不被任何人试图探测您的内存空间（即恶意软件、蠕虫、木马等），并且必须由您明确清除。造成这种情况的原因涉及 .NET 如何处理字符串，以及内存中的数据只是在 GC 的一时兴起时才被清理的事实。

即使您的 SecureString 类将字符串加密为私有变量，传入的原始字符串仍然不安全。它也可以在 GC 收集它之前停留一段时间，或者，如果该字符串被实习，它将在它所在的进程的持续时间内存在。内部字符串存储在一个表中，这也使它们更容易找到。

另一方面......如果你解密你的SecureString，你得到一个新的字符串变量，它可能会遇到与输入字符串相同的问题......它只有在GC决定时才会被清理......并且它也可能最终被实习并在整个过程中生活。

更复杂的问题是，每次您解密时，您都会得到另一个加密字符串的副本。这可能会积累过多的安全字符串的解密版本，从而增加某些正在探测信用卡号码的恶意软件......实际上会找到一个的机会。

我曾多次尝试创建更好、更类似于 .NET 的 .NET 2.0 的 SecureString 版本，但从未能够产生真正安全的东西。您可以获得指向已解密的字符串变量的指针，将其擦除，将每个字符设置为 nil 等。但是，即使某些东西仍在引用该字符串，导致文本消失、读取损坏等，这也可能是非常有问题的。如果字符串被保留，这通常意味着它被许多东西长期使用，擦除它会擦除唯一的版本，并影响它的所有使用。即使您设法成功擦除了安全字符串的副本，也不能保证在您擦除它之前它没有被其他代码复制（即您将字符串发送到某个网络服务......它现在存在于更多不止一个进程空间，

这绝对是一个复杂的问题，只有在您的应用程序的内存空间被某种恶意软件破坏的情况下才能真正提供安全性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T02:00:14.917

这是来自SO的一个：

[为什么密码错误会导致“填充无效，无法删除”？](https://stackoverflow.com/questions/11762/c-cryptographicexception-padding-is-invalid-and-cannot-be-removed)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T18:29:28.533

这是满足您需求[的一站式解决方案。](http://www.codeproject.com/Articles/36449/String-Encryption-using-DPAPI-and-Extension-Methods.aspx)

链接文本：http: [//www.codeproject.com/Articles/36449/String-Encryption-using-DPAPI-and-Extension-Methods.aspx](http://www.codeproject.com/Articles/36449/String-Encryption-using-DPAPI-and-Extension-Methods.aspx)

# wcf - WCF 中的服务太忙错误

> ID：900616
> 
> 赞同：30
> 
> 时间：2009-05-23T01:23:00.797
> 
> 标签：wcf, web-services, throttling

我在 .Net WCF 服务中间歇性地收到以下异常。“位于[http://MyServer/TestWCF/MyService.svc](http://MyServer/TestWCF/MyService.svc)的 HTTP 服务太忙了。”

我在这里错过了什么吗？

我正在使用基本的 http 绑定并启用了 WCF 限制。

```
<basicHttpBinding>
        <binding name="BasicHttpBinding_MyService" maxReceivedMessageSize="2147483647"
                 messageEncoding="Text" textEncoding="utf-16" sendTimeout="00:01:00" >
          <readerQuotas maxStringContentLength="2147483647" maxArrayLength="163840000"
                        maxDepth="2147483647" maxBytesPerRead="2147483647" maxNameTableCharCount="16384" />
        </binding> 
```

. . . .

```
<behavior name="MyWCFServices.MyServiceBehavior">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="true" />
          <serviceThrottling
                    maxConcurrentCalls="16"
                    maxConcurrentInstances="2147483647"
                    maxConcurrentSessions="10"/>
        </behavior> 
```

节流有助于解决问题吗？另外，我可以知道为高流量网站节流的推荐参数值吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-23T08:46:52.717

您绝对可以尝试将您的服务限制行为增加到 30`maxConcurrentSessions`左右`maxConcurrentCalls`的标准值，看看这是否会使错误消失。服务器太忙似乎表明进入的请求多于您的服务限制行为所允许的区域，并且由于在给定的超时期限内没有服务实例可用于为它们提供服务，因此它们已被丢弃。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-10-17T16:26:51.217

我的回答是，检查应用程序池是否正常？

我已经看到当应用程序池由于未捕获的异常而死亡时发生此错误。

例如，考虑自定义配置部分 - 那里有错误，将导致您的应用程序在启动之前失败。在很短的时间内太多这些会杀死应用程序池。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-30T20:19:57.993

如果您的服务在您的帐户（身份）下运行，您很可能最近更改了密码——您需要在高级设置 | 中为其 IIS 应用程序池重置密码。身份对话框。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-25T14:33:42.583

确保您也检查内部异常；在我们的部署过程中，我们禁用了 WCF Web 服务的应用程序池，并且客户端在此期间开始收到此错误：

> System.ServiceModel.ServerTooBusyException：位于[https://ourserver.x.com/path/service.svc](https://ourserver.x.com/path/service.svc)的 HTTP 服务太忙。---> System.Net.WebException：远程服务器返回错误：（503）服务器不可用。

因此，在这种情况下，HTTP 错误 503 被（错误？）解释为“服务器太忙”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-23T19:58:25.883

不仅仅是 maxConcurrentSessions，还有会话持续多长时间。

如果客户端没有关闭连接，它将保持打开状态，直到超时。然后，您可以在服务器上几乎没有活动的情况下达到 maxConcurrentSessions 限制。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-16T23:02:37.607

我知道这个异常的唯一来源是如果您正在使用会话，并且您设法达到 MaxPendingChannels 油门。它的默认值非常低，例如 4。您可以尝试将其设置得更高（例如 128），或者如果您只是想重现，请将其设置为 1，您应该会在负载测试中看到它。

有关会话的更多信息，请参见此处：http: [//msdn.microsoft.com/en-us/library/ms733795.aspx](http://msdn.microsoft.com/en-us/library/ms733795.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-17T21:25:37.077

我刚刚遇到了这个错误，它归结为一个简单的配置问题。我在完全相同的端口和相同的接口（模拟服务）上提供了一项服务。我使用适当的命令行开关运行服务以运行我想要的“原始”服务。错误消失了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-02-01T04:44:57.403

我的解决方案是，检查 App.Config 文件，是否存在此特定服务的服务标签。

例如：

```
<service name="MyServices.ServiceName">
        <endpoint address="" binding="wsHttpBinding" bindingConfiguration="TestBinding"   contract="MyServices.ServiceName">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8732/Design_Time_Addresses/MyServices/ServiceName/" />
          </baseAddresses>
        </host>
</service> 
```

# ruby - Netbeans 是否同样适用于 Mac 上的 Ruby 开发？

> ID：900622
> 
> 赞同：3
> 
> 时间：2009-05-23T01:25:57.140
> 
> 标签：ruby, macos, netbeans

我意识到 Mac 上的大多数 Ruby 开发都使用 Textmate，但我喜欢 Windows 环境中的 Netbeans，我想知道它在 Mac 上是否同样出色——即使它有点逆流而上，Netbeans 作为 Ruby IDE 会不会带来任何问题麦克？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T01:41:23.847

它不会造成任何问题，但与使用其他编辑器相比，它并没有给您带来太多好处——它们实际上都是一样的，只是工作流程和小部分功能发生了变化。我想这取决于个人喜好 - 如果您对 Netbeans 感到满意，那么您可以使用它。然而，TextMate 非常受欢迎，因为它确实为 Ruby 和 Rails 提供了很好的内置支持，它比 Netbeans 快得多，并且感觉更像是一个原生应用程序（当然是这样）。

最终，这取决于您以及您想从编辑器/IDE 中得到什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T19:33:44.980

我在 Mac 和 PC 上广泛使用了 Netbeans。对于 Mac，它本质上是相同的——一个微妙之处是 ctrl 和 cmd（苹果键）之间的相互作用。在Mac上，和其他Mac应用一样，cmd在PC上的作用往往和ctrl一样，ctrl和右键是一样的，比如cmd-clicking方法名/类名/render Fragment名会跳转到该文件（如果可以找到）以及 6.5+ 附带的所有其他 Rails 优点。

Netbeans + 咆哮 + 自动测试 = 很棒。

我也拥有 Textmate，但从未被说服。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-20T20:29:09.917

我是另一个不相信 Textmate 或“它远不止于此”的人。对我来说，它不断地破坏并用日志消息填充我的代码。我认为 Textmate 生活在它是你能得到的最好的 Rails 编辑器的辉煌岁月里。对我来说，Netbeans 作为一个 Rails 开发环境要好得多，除非你是铁杆，永远不要使用鼠标劝说。所有很酷的片段功能（这是 Textmate 的大事）都已在 Netbeans 中复制。它更慢，但没有那么慢，而且好的编码不是一场竞赛。

和

Netbeans 是免费的！！

# windows - 发送到 HWND_BROADCAST 的消息会发送到其他桌面吗？

> ID：900623
> 
> 赞同：3
> 
> 时间：2009-05-23T01:25:59.230
> 
> 标签：windows, messages

我正在尝试确定如何`HWND_BROADCAST`工作的一些细节。不幸的是，MSDN 没有这个值的特定页面。它只是在其他几篇文章中顺便提及，例如 for[`SendMessage`](http://msdn.microsoft.com/en-us/library/ms644950(VS.85).aspx)和[`PostMessage`](http://msdn.microsoft.com/en-us/library/ms644944(VS.85).aspx).

我特别想知道的是发送到`HWND_BROADCAST`的消息是否被与同一窗口站中的其他桌面关联的窗口接收。文档说该消息将发送到“系统中的所有顶级窗口”，但显然这不能完全正确。例如，我确信他们不会在其他登录会话中进入窗口（例如在终端服务器上）。我的猜测是它们至少仅限于调用进程的窗口站，但我不知道它们是否也仅限于调用线程的桌面（每个线程与单个桌面相关联）。

最坏的情况下，我可以编写一些代码来凭经验进行测试，但是有人碰巧知道答案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T01:36:13.623

你是对的。以这种方式发送的消息只会发送到当前登录的 windows 会话/桌面的顶级窗口。他们不会转到任何其他桌面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T01:49:50.273

如果消息来自较低特权的进程，Vista 将阻止消息传递到顶级窗口，您应该注意它。

# process - 您如何处理长期项目中的技术更新？

> ID：900634
> 
> 赞同：2
> 
> 时间：2009-05-23T01:33:45.877
> 
> 标签：process, frameworks, updates

假设您正在进行一个长期运行的项目（长期运行 = 数年），并且正如预期的那样，将会有一些全新的版本出现。可能会有一个具有全新功能的新 .Net 框架（例如 Linq、Entity Framework、WPF、WF...）、一个新的 Visual Studio 或您最喜欢的控件库的 V.next、一个新的 Mock 框架和更多的东西. 您处理这些技术更新的指导方针是什么？您是立即采用它们还是在项目结束之前忽略它们？你对不同的东西（工具、框架、支持的东西）有不同的指导方针吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T01:49:28.107

根据我的经验，这些决定总是根据具体情况做出的。考虑了几个因素，包括：

1.  新技术有多成熟？组织是否喜欢站在最前沿使用最前沿的新技术，还是更喜欢使用经过验证的工具和方法？

2.  你的员工有什么技能？它们是否与新技术的使用一致，还是需要更多的培训？提高生产力会超过加快速度所需的时间吗？

3.  您对现有技术有哪些投资？迁移到新技术的成本是多少？涉及多少代码的返工和重写？

4.  有什么要求？它是由现有技术支持，还是需要新工具来满足要求？

5.  业绩预期如何？新技术是否提供了旧技术无法满足的性能改进？

6.  科技文化呢？组织供应商是否特定（例如 Microsoft 商店）？可以使用开源代码吗？

7.  项目的范围是什么？它是一个可以从框架和工具等支持技术中受益的大型项目，还是一个会被这些东西过度拖累和复杂化的小项目？

8.  新技术如何支持？供应商是否有良好的文档？有问题可以找人谈谈吗？或者您是一个组织，其人员知道如何在没有支持合同的情况下解决问题？

9.  使用该技术是否舒适？这似乎有意义吗？它干净优雅吗？其他人似乎喜欢它吗？其他人有问题吗？

10.  这项技术是本周最新的风格吗？它是在战场上证明了自己产生了实实在在的成果，还是只是一种宗教？

11.  您有多少时间来学习新技术并解决问题？收益是否大于成本？

作为一个非常简短的例子，我为我最近的项目选择了 Link to SQL，因为该项目足够复杂，可以保证 ORM，L2S 性能良好且轻量级，我们是 Microsoft Shop，我感觉 Entity 框架还没有为黄金时间做好准备（尽管微软表示它将成为未来的首选框架）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T01:48:27.297

坚持你已经开始的。

大型且长期运行的项目通常带有庞大且高度复杂的代码库。对库的新版本的任何更改或升级都可能以非常微妙和意想不到的方式添加错误。

另外：对于大型项目，使用的工具和库应该在设计阶段进行测试和评估。除非您发现问题或安全问题，否则最好不要升级。

永远记住：不要在溪流中间换马。:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T01:50:35.920

我想说的是不同的因素，比如——

1.  假设一个软件即将结束生命周期，例如去年 4 月，Microsoft 停止了对 SQL Server 2000 的主流支持，而您的产品使用它，那么在您的下一个版本中选择下一个版本的 SQL Server 会更明智。
2.  另一个起作用的因素是最新版本的软件中的新功能会给你的产品带来多少价值。很可能是 .NET 框架的新版本有一些东西不会为您的产品增加任何价值，那么这并没有建立一个强有力的升级案例。
3.  预算也是一个重要因素。我认为您需要升级许可证才能升级到下一个版本，除非您已经是软件保障之类的一部分。
4.  对球队的训练也是一个因素。如果最新版本要添加到您的产品中，那么您还必须培训您的团队。

好吧，也可能有其他重要因素。这些是我头顶上的那些。我希望它有所帮助。

干杯

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T01:54:11.840

如果您谈论的是特定于框架的示例，我给您的最大建议是保持系统和应用程序分开。这就是我喜欢 Model-View-Controller 这样的模式的原因——它使你的代码保持模块化，这意味着你可以在不破坏整个应用程序的情况下升级部分。

在更实际的层面上，如果您的框架有 Git 或 SVN 存储库，请从存储库中签出通常的“系统”目录，然后您可以偶尔调用“svn update”以跟上最新和最好的构建。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T01:46:35.757

我建议这个项目不要持续那么久。每几个月进行一次迭代，以较小的部分开发应用程序。这样，随着新技术的出现，您可以随时进行必要的更改并实施更新，而不必决定重新开发整个应用程序。正如您所说，尝试随着事情的变化而开发整个应用程序是行不通的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T09:05:55.610

正如另一位发帖人所说，这当然是逐案处理的事情。您可以升级什么以及何时升级主要取决于测试新版本系统的难易程度。为您的应用程序拥有一个全面的自动化测试套件对此有很大帮助。

一般来说，我会尽可能频繁地更新到最新的稳定版本的库等，因为这样可以更容易地维护。如果您不更新，您可能会发现自己正在修补或解决您正在使用的库版本中的错误。如果您更新的频率较低，则每次更新的工作量会更大，因为您需要处理更多的更改，并且距离您上次接触系统的时间更长，因此您对它的记忆会更少。

# crystal-reports - 删除 Crystal 中的括号和文本

> ID：900646
> 
> 赞同：0
> 
> 时间：2009-05-23T01:41:59.243
> 
> 标签：crystal-reports

我正在使用以下文本删除括号和括号内的文本；我需要扔掉整个备忘录字段，它在找到并删除第一组括号和文本后停止。

```
if right({table.col},1) = "]" then
left({table.col},instr({table.col},"[")-1)
else
{table.col} 
```

有什么建议么...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T00:44:33.253

这在 Crystal2008 上测试得很好，不确定你使用的是什么版本，它还需要一些错误检查来处理不匹配的括号对，但它可能会提供一些思考：

```
将 workString 调暗为字符串
将括号内的文本调暗为字符串

如果 (InStr({table.col},"[") > 0) 那么
  workString = {table.col}
  while(InStr(workString,"[") > 0 )
    括号内文本 = "[" + ExtractString(workString,"[","]") + "]"
    工作字符串 = 替换（工作字符串，括号内文本，“”）
  文德
  公式 = workString
别的
  公式 = {table.col}
万一

```

# django - django中不显示的函数在哪里

> ID：900651
> 
> 赞同：0
> 
> 时间：2009-05-23T01:46:21.683
> 
> 标签：django, django-views

我在 html 页面上有一些链接，比如，，目前我是这样处理它们的

```
<p> <a href="/cases/{{case.id}}/case_rate/-">rate down</a> 
```

并有一个 url.py 条目：

```
 (r'^cases/(?P<case_id>\d+)/case_rate/(?P<oper>.)$', 'mysite.cases.views.case_rate'), 
```

然后我有一个处理逻辑并访问数据库的视图函数，然后执行以下操作：

```
return HttpResponseRedirect(request.META.get('HTTP_REFERER','/')) 
```

有一个更好的方法吗？我可以看到这会如何，因为它确实必须重绘屏幕才能显示新评级......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T05:12:57.450

如果您询问 case_rate 是否仍然应该进入 views.py ，因为它返回重定向而不是提供内容，答案是肯定的，因为 case_rate 正在处理请求并返回响应。

但是考虑这样一种情况，您在 views.py 中有两个视图函数，它们有一些重复的代码，并且您选择将该重复代码分解到另一个既不接受请求又不返回响应的函数中。留在views.py中是公平的游戏吗？当然，如果将它移到其他地方会使代码更难阅读。或者你可以选择把它放在别处。这真的是你根据你的味觉来决定的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T14:02:52.343

处理此问题的典型方法是使用 ajax 请求。

您放置了一个调用视图的 javascript 处理程序，而不是链接，它会更新数据库，并返回一个带有该项目新评级的 json / xml 对象。然后另一个 javascript 句柄接收该响应并更新屏幕上的评级数字，而无需重新加载页面。

理想情况下，您将保留两个版本：纯 html（您当前拥有的版本）和 ajax 版本。ajax 可以在页面加载后附加到元素上，所以如果 javascript 不可用，您仍然有一个工作站点。

然后，关于组织，您可以在视图中添加“ajax”参数。视图应该相应地更新数据库，如果是 ajax 调用，则返回 json / xml 响应，否则返回新页面。这样您就可以将逻辑（获取对象、更新数据库）保留在一个地方。

# java - 使用 FileUtils.listFiles 递归查找目录

> ID：900659
> 
> 赞同：18
> 
> 时间：2009-05-23T01:50:12.347
> 
> 标签：java, apache-commons-io

我想收集一个目录下*所有*文件的列表，特别是包括子目录。我不喜欢自己做事，所以我使用`FileUtils.listFiles`的是 Apache Commons IO。所以我有类似的东西：

```
import java.io.File;
import java.util.Collection;

import org.apache.commons.io.FileUtils;
import org.apache.commons.io.filefilter.TrueFileFilter;

public class TestListFiles {
  public static void main(String[] args) {
    Collection<File> found = FileUtils.listFiles(new File("foo"),
        TrueFileFilter.INSTANCE, TrueFileFilter.INSTANCE);
    for (File f : found) {
      System.out.println("Found file: " + f);
    }
  }
} 
```

问题是，这似乎只能找到普通文件，而不是目录：

```
$ mkdir -p foo/bar/baz; touch foo/one_file
$ java -classpath commons-io-1.4.jar:. TestListFiles
Found file: foo/one_file 
```

我已经通过`TrueFileFilter`了两个过滤器，所以我想不出任何更具包容性的东西。我希望它列出：（`"foo", "foo/one_file", "foo/bar", "foo/bar/baz"`以任何顺序）。

我也会接受非`FileUtils`解决方案，但必须编写我自己的 BFS，甚至从我得到的列表中收集父目录集似乎很愚蠢。（无论如何都会错过空的子目录。）这是在Linux上，FWIW。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-17T16:21:08.433

一个旧答案，但这对我有用：

```
FileUtils.listFilesAndDirs(new File(dir), TrueFileFilter.INSTANCE, DirectoryFileFilter.DIRECTORY); 
```

显示两者：

我用：

```
FileUtils.listFilesAndDirs(new File(dir), new NotFileFilter(TrueFileFilter.INSTANCE), DirectoryFileFilter.DIRECTORY) 
```

只显示目录而不显示文件...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-02-01T10:24:30.173

您是否简单地尝试过：

```
File rootFolder = new File(...);
File[] folders = rootFolder.listFiles((FileFilter) FileFilterUtils.directoryFileFilter()); 
```

它似乎对我有用。当然，您将需要递归。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-23T04:23:54.880

在我的大多数重要应用程序中，我避免使用 Java IO 库，而是更喜欢 Commons VFS。我相信使用适当的参数调用[此方法](https://commons.apache.org/proper/commons-vfs/commons-vfs2/apidocs/org/apache/commons/vfs2/FileObject.html#findFiles-org.apache.commons.vfs2.FileSelector-)将实现您的目标，但我会授予它很长的路要走的功能。

具体来说，此代码将执行您想要的操作：

```
 FileObject[] files = fileObject.findFiles(new FileSelector() {
        public boolean includeFile(FileSelectInfo fileInfo)  {
            return fileInfo.getFile().getType() == FileType.FOLDER; }

        public boolean traverseDescendents(FileSelectInfo fileInfo) {
            return true;
        }
    }); 
```

其中 fileObject 是 FileObject 的一个实例。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-23T02:45:50.037

如果您查看[源代码](https://github.com/apache/commons-io/blob/master/src/main/java/org/apache/commons/io/FileUtils.java)并阅读 JavaDoc 中的字里行间，您会发现——不幸的是——这个 API 并不是为满足您的需要而设计的。它将返回与提供的参数匹配的**文件**列表（不是**文件和目录**列表）。在源代码中——查看方法`innerListFiles`——你会看到目录被搜索并且*没有被*添加到结果列表中。

我不知道有任何公共 API 可以满足您的需求。希望其他人会知道一个。大多数可能是 DFS，而不是 BFS，这可能对您的目的很重要，也可能无关紧要。（到目前为止，我看过的*所有执行目录树遍历的 Java 代码都是通过深度优先搜索来完成的。当然，这并不意味着 BFS 不存在。）*

如果您真的想要一个给定目录下**所有内容**的列表，那么滚动您自己的很容易。但我理解你不想重新发明轮子的愿望。

注意：[Apache Commons Finder](http://commons.apache.org/sandbox/finder/)可能会支持您需要的内容，但该库位于 Commons Sandbox 中，这意味着它在此阶段更具实验性。它可能是完整的，也可能不是完整的，它可能会或可能不会被维护。对于您正在寻找的东西，它也可能是重量级的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-05T23:53:21.307

一个更简单+完整的[Commons VFS](http://commons.apache.org/vfs/)解决方案：

```
FileSystemManager fsManager = VFS.getManager();
FileObject fileObject = fsManager.resolveFile( "yourFileNameHere" );
FileObject[] files = fileObject.findFiles( new FileTypeSelector( FileType.FOLDER ) ) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T02:32:49.313

根据他们的 API，它应该可以工作。

这是我自己的[FileUtils](http://svn.adrian.tarau.org/svn/intellicommons/trunk/utilities/src/main/java/com/intellisoftsystems/commons/utilities/FileUtilities.java)版本，不如 Commons IO 完整，它只包含我需要的内容。搜索*findFiles*或者您可以使用*iterate*来避免创建巨大的列表（有时/大部分时间您只想对这些文件做一些事情，因此将它们收集在 List 中没有意义）。

# c++ - C++ 中的 System() 调用及其在编程中的作用

> ID：900666
> 
> 赞同：8
> 
> 时间：2009-05-23T02:00:55.697
> 
> 标签：c++, windows, operating-system, system, dos

我经常听说使用`system("PAUSE")`是不好的做法，`std::cin.get()`而是使用。现在我对系统调用的理解是，它们将一个字符串输入系统命令行并与操作系统对话，因此 PAUSE 是一个 DOS 命令，可以暂停命令窗口中的输出。我认为这与具有不同关键字的 Mac 和 unix 类似，并且由于缺乏跨操作系统兼容性，不鼓励使用系统调用。（如果我有任何错误，请纠正我）

我的问题是：什么时候适合使用 system() 调用？它们应该如何应用？什么时候不应该应用它们？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-23T02:12:50.803

`system("PAUSE")`肯定不太理想。使用对系统的调用会创建一个子进程，这在 Windows 上是相当昂贵的，并且无论如何在任何操作系统上都不是非常便宜。在嵌入式系统上，内存开销很大。

如果有任何方法可以在本地没有太多痛苦的情况下做到这一点，那就去做吧。在等待用户按下单个按钮的情况下，cin.get() 将很难被击败。在这种情况下，您的应用程序进程只会在标准输入上阻塞，只设置几个对内核可见的标志，最重要的是，不会分配新内存，也不会创建新的调度实体，甚至不会创建中断处理程序。

此外，它在所有具有所有 c++ 编译器的操作系统上都可以正常工作，因为它仅使用该语言非常标准部分的一个非常基本的特性，而不依赖于操作系统提供的任何东西。

编辑：预测您担心它是否昂贵并不重要，因为整个*想法*是暂停。好吧，首先，如果它很贵，那么它会损害可能发生的其他任何事情的性能。有没有注意到（在 Windows 上）当一个应用程序启动时，其他已经打开的应用程序也变得不那么响应了？此外，您的用户可能不是一个活生生的人，而是另一个代表人类用户工作的程序（例如，一个 shell 脚本）。该脚本已经知道下一步该做什么，并且可以在标准输入中预先填充一个字符以跳过等待。如果您在此处使用了子进程，则脚本将经历（人类可察觉的）延迟。如果脚本这样做数百（或数亿！）次，则可能需要几秒钟才能运行的脚本现在需要几天或几年。

EDIT2：何时使用`system()`：当您需要做另一个进程所做的事情时，您不能轻易做到。 `system()`并不总是最好的候选人，因为它做了两件有些限制的事情。首先，与子进程通信的唯一方法是通过命令行参数作为输入，返回值作为输出。第二个是父进程阻塞，直到子进程完成。这两个因素限制了系统可用的情况。

在 unixy 系统上，大多数子进程都会发生，`fork`因为它允许同一个程序作为两个单独的进程在同一个地方继续，一个作为另一个的子进程（除非你从操作系统请求它，否则几乎不会注意到它）。在 Linux 上，这特别优化，并且与创建 pthread 一样便宜。即使在速度不那么快的系统上，它仍然非常有用（如 apache 进程池方法所证明的那样）（在 windows/ [unix 文档链接上](http://linux.die.net/man/2/fork)不可用）

其他情况（在 Windows 上也是如此！）通常由函数`popen`或`exec`函数族处理。 `popen`创建一个子进程和一个连接到子进程的标准输入或标准输出的全新管道。然后，父进程和子进程都可以同时运行并很容易地进行通信。（[链接到 windows 文档](http://msdn.microsoft.com/en-us/library/96ayss4b.aspx)/[链接到 unix 文档](http://linux.die.net/man/3/popen)）

`exec`* 另一方面，函数族（有几个，execl，execv 等）会导致当前程序被新程序替换。原始程序不可见地退出，新进程接管。当新进程返回时，它将返回到任何所谓的原始进程，就好像该进程在那个时候已经返回而不是消失一样。这样做的好处`exit(system("command"))`是不会创建新进程，从而节省时间和内存（尽管并不总是非常多）（[链接到 windows 文档](http://msdn.microsoft.com/en-us/library/431x4c1w.aspx)/[链接到 unix 文档](http://linux.die.net/man/3/exec)）

`system`某些脚本工具可以合理地使用它来调用某些配方操作中的几个步骤。例如，在某个时刻，程序可以使用`system`调用文本编辑器来编辑某些配置文件。它不需要太关心发生的事情，但它当然应该等到用户保存并关闭编辑器后再继续。然后它可以使用返回值来确定编辑会话是否成功，即编辑器实际上打开了请求的文件（并且编辑器本身根本存在！），但将从中读取会话的实际结果直接编辑文件，而不是与子进程通信。（[链接到 windows 文档](http://msdn.microsoft.com/en-us/library/277bwbdz.aspx)/[链接到 unix 文档](http://linux.die.net/man/3/system)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T02:14:53.467

系统调用被发送到操作系统的 shell 或命令行解释器（dos、bash 等），并由 shell 来执行它想要使用此命令执行的操作。

您将避免使用此类调用，因为它会降低您的程序与其他操作系统一起使用的可移植性。我认为只有当您绝对确定您的代码针对的是您应该使用此类调用的特定操作系统时。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T02:15:10.923

> 但我的问题是：什么时候使用 system() 调用合适？它们应该如何应用？

当你不能用自己的代码或库做你想做的事情时（或者实现它的成本超过了启动一个新流程的成本）。与 cin.get() 相比，system() 在系统资源方面的成本相当高，因此只能在绝对必要时使用它。请记住，system() 通常会同时启动一个全新的 shell 以及您要求它运行的任何程序，因此会启动两个新的可执行文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-06T09:09:49.673

顺便说一句，*system()*调用不应该与设置了**SUID**或**SGID**位的二进制文件一起使用，引用[手册页](http://linux.die.net/man/3/system)：

> 不要在具有 set-user-ID 或 set-group-ID 权限的程序中使用 system()，因为某些环境变量的奇怪值可能会被用来破坏系统完整性。请改用 exec(3) 系列函数，但不要使用 execlp(3) 或 execvp(3)。实际上，system() 在 /bin/sh 是 bash 版本 2 的系统上无法从具有 set-user-ID 或 set-group-ID 权限的程序正常工作，因为 bash 2 在启动时会放弃权限。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-23T08:18:59.590

`system()`用于要求操作系统运行程序。

为什么您的程序希望操作系统运行程序？嗯，有案例。有时，外部程序或操作系统命令可以执行在您自己的程序中难以完成的任务。例如，外部程序可以使用提升的特权或访问适当的数据格式来运行。

该`system()`函数本身是相当可移植的，但是您传递给它的命令字符串可能是非常特定于平台的——尽管可以从本地配置数据中提取命令字符串以使其与平台更加无关。

其他功能，如`fork()`、和 ，`exec*()`可以让您更好地控制运行外部程序的方式，但它们是特定于平台的，可能无法在您选择的平台上使用。`spawn*()``CreateProcess()`

`system("PAUSE")`是一个古老的 DOS 技巧，现在通常被认为是相当怪诞的风格。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-23T02:08:29.673

据我所知 system("PAUSE") 是一个只有 Windows 的东西，这就是为什么它不受欢迎。

# c# - 如何在 C# 中将 Excel 工作表的内容嵌入到电子邮件中？

> ID：900669
> 
> 赞同：1
> 
> 时间：2009-05-23T02:01:42.077
> 
> 标签：c#, excel, email

我有发送电子邮件的 C# 代码。在电子邮件的正文中，我想发送 Excel 工作表的内容。

一种方法是为 excel 文件中的每条记录创建带有 html 行的 html 表，并将此 html 代码嵌入到电子邮件的正文中。

有没有更简单的方法来做到这一点？我可以指定excel工作表的路径并直接将表格复制到电子邮件正文中的东西？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T13:03:36.240

到目前为止，最简单的是使用 Workbook.SendMail() 方法。

示例代码：

```
Excel.Workbook myWorkbook = xlApp.Workbooks["Book1.xls"];

string recipients = "johndoe@email.com";
string subject = "Proposal for Review";
bool returnReceipt = false;

myWorkbook.SendMail(recipients, subject, returnReceipt); 
```

请注意，`recipients`参数实际上是这样键入的，因此如果您有多个收件人`System.Object`，则传入的参数可以是 a 。`string[]`

资料来源：

(1) [http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.sendmail(VS.80).aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.sendmail(VS.80).aspx)

(2) [http://msdn.microsoft.com/en-us/library/bb178034.aspx](http://msdn.microsoft.com/en-us/library/bb178034.aspx)

您可能还想看看 Ron de Bruin 的[使用 CDO 方法从 Excel 发送邮件](http://www.rondebruin.nl/cdo.htm)，但 Workbook.SendMail() 方法确实是最简单的。

希望这可以帮助...

麦克风

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T02:06:19.977

您可以尝试通过与 Excel 工作表的 ADODB 连接来执行此操作。[http://support.microsoft.com/kb/306023](http://support.microsoft.com/kb/306023)

1.  打开 Excel 工作表的记录集
2.  调用 recordset.GetString ( [http://www.devguru.com/technologies/ado/quickref/recordset_getstring.html](http://www.devguru.com/technologies/ado/quickref/recordset_getstring.html) )。这会将工作表的内容转储到字符串中。

这可能比您计划的代码更短（长度方面），这可能涉及 Excel 自动化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T02:06:45.590

它不是嵌入式的，但您可以尝试附件类：http: [//msdn.microsoft.com/en-us/library/system.net.mail.attachment.aspx](http://msdn.microsoft.com/en-us/library/system.net.mail.attachment.aspx)

替代方法是使用第 3 方 excel 控件打开它，将数据复制出来，然后将其粘贴到消息中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T02:15:14.187

我假设您想在 C# 中本地执行此操作。

我认为您最好的选择是使用 C# 中的 Office 自动化将电子表格保存为 HTML 文件格式。然后，您可以使用 StreamReader 对象打开此文件并将文本嵌入到消息正文中。

Microsoft 有一篇关于自动化 Excel 的文章，其中包含一些代码示例来帮助您入门：

如何从 Microsoft Visual C# .NET [http://support.microsoft.com/kb/302084自动化 Microsoft Excel](http://support.microsoft.com/kb/302084)

# c - 从 C 中的 FIFO 读取：select() 不返回？

> ID：900671
> 
> 赞同：4
> 
> 时间：2009-05-23T02:04:59.777
> 
> 标签：c, linux, select

我有一个我正在编写的 C 程序。这是它的作用：

*   使用 mkfifo 创建 n 个 fifo
*   打开它们进行读取（设置了 O_NONBLOCK 标志）
*   打开它们进行写入
*   产生一个线程

在线程中，循环运行：

*   为所有 n 个 fifo 创建文件描述符的 fd_set
*   调用 select(n, &my_set, NULL, NULL, NULL)
*   对于每个准备好 I/O 的 fd (FD_ISSET(fd, &my_set))：
    *   从 fd 中读取一个字符串 (read(fd, buf, buf_len))
    *   打印字符串
    *   如果 string == "kill"，则将 fd 标记为已死并将其从列表中删除 (n--)
    *   如果 n == 0，则终止线程

在主程序中：

*   对于 i = 0 到 n
    *   使用字符串写入 fds[i] (write(fds[i], buf, buf_len))
*   对于 i = 0 到 n
    *   使用字符串“kill”写入 fds[i]
*   加入我创建的线程
*   出口

我看到的行为是 select() 将返回一次，长度为 1，是列表中的第一个 fd。第二次通过循环，选择将永远坐在那里。

这是我的输出：

```
thread created
Waiting on 4 file descriptors
> Wrote 'Hello to target 0 from writer 0' to 0
> Wrote 'Hello to target 0 from writer 1' to 1
> Wrote 'Hello to target 1 from writer 0' to 2
> Wrote 'Hello to target 1 from writer 1' to 3
> Sending kill to 0:0 (#0)
> Sending kill to 0:1 (#1)
> Sending kill to 1:0 (#2)
> Sending kill to 1:1 (#3)
< Got string: 'Hello to target 0 from writer 0'
Waiting on 4 file descriptors
^C 
```

操作系统是 Linux，以防万一。

代码链接：[https](https://dl.getdropbox.com/u/188590/fifotest.c) ://dl.getdropbox.com/u/188590/fifotest.c （对不起，有点令人发指）

谢谢，内森

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T03:33:06.570

正如 Lance Richardson 所说，第一个问题是您需要传递最大文件描述符的数量加一，而不是文件描述符的数量。

~~然后，您必须清理侦听器线程中的内务管理——我得到了大部分数据，但最终侦听了 6 个文件描述符，而不是 4 个。~~（*报告的数字现在是最大的 fd，而不是文件描述符的数量。*）

您还有一个问题，您将一个字符串加上一个空字节写入每个管道，然后是第二个字符串加上一个空字节。由于调度是不确定的，因此主程序实际上将其两个字符串都写入每个 fifo，因此当侦听器线程读取它时，它会读取两个字符串。当我打印出长度时，我得到了 41 read ( `read_len`) 的总长度，但字符串 per 的长度`strlen()`是 31。换句话说，第一个 read 包含了 'kill' 部分，但是您在打印输出中没有注意到因为第一条消息末尾的尾随 null 。因此，您正在等待永远不会发生的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T03:13:02.570

select() 调用中的第一个参数应该是编号最高的文件描述符加 1，而不是 fd_set 中文件描述符的数量。

这是我为解决此问题所做的更改：

```
--- fifotest-1.c        2009-05-22 23:44:03.000000000 -0400
+++ fifotest.c  2009-05-22 23:34:00.000000000 -0400
@@ -34,19 +34,22 @@
     sim_arg_t* ifs = arg;
     uint32_t num_ifs;
     uint32_t select_len;
+    int maxfd;

        num_ifs = ifs->num_ifs;
     while (num_ifs > 0) {
                FD_ZERO (&set);
                select_len = 0;
-               for (i = 0; i < ifs->num_ifs; ++i) {
+               for (maxfd=0, i = 0; i < ifs->num_ifs; ++i) {
                        if (ifs->if_list[i].valid) {
                                FD_SET(ifs->if_list[i].fh, &set);
-                               ++select_len;
+                               if (ifs->if_list[i].fh > maxfd)
+                                   maxfd = ifs->if_list[i].fh;
+                               select_len++;
                        }
                }
                printf("Waiting on %d file descriptors\n", select_len);
-               ret = select(select_len, &set, NULL, NULL, NULL);
+               ret = select(maxfd+1, &set, NULL, NULL, NULL);
                if (ret < 0) {
                        fprintf(stderr, "Select returned error!\n");
                        continue; 
```

# php - 如何在 PHP 中安全地执行与金钱相关的计算？

> ID：900677
> 
> 赞同：13
> 
> 时间：2009-05-23T02:07:23.873
> 
> 标签：php, finance

我正在研究一些需要对一些货币价值进行基本计算的报告输出脚本。

我知道为此目的浮点算术的局限性，但是输入值都是十进制格式，所以如果我对它们使用算术运算符，PHP 会将它们转换为浮点数。

那么处理数字的最佳方法是什么？我应该使用[BCMath](http://au2.php.net/bc)吗？.NET 中是否有类似于[Decimal的东西？](http://msdn.microsoft.com/en-us/library/system.decimal.aspx)或者如果我转换回 int，使用算术运算符是否安全？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-23T02:49:34.570

不要以美元（1.54 美元）工作，以美分工作：（154c）。除非您需要执行重要的任务，否则您将使用整数并且一切都很好。如果您对十分之一美分感兴趣，那么只需将所有内容乘以十！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-23T02:29:28.227

如果您使用 BCMath，所有值都将存储在字符串中并作为字符串传递给函数，就像结果将是一个字符串一样。因此，您不需要进行任何转换，但要确保给函数的数字是值数值。就个人而言，如果数学*需要*小数点的高精度，那么使用 BCMath。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-05-23T06:17:06.860

如果您使用合理的金额（对于“普通人”），使用浮点可能不是问题，特别是如果您只是添加和减去金额，而不是进行利息计算。

如果您正在寻找快速解决方案，切换到整数不太可能对您有所帮助；你仍然必须处理溢出。（有人在这里编辑提到，如果 PHP 遇到超出整数类型范围的数字，它将被[解释为浮点数](http://jp2.php.net/integer)。但是你又回到了使用浮点数的原始问题！）任意长度整数（GMP ，从该页面引用）可以提供帮助。）

基本上，在大多数情况下，以半途而废的方式这样做是可行的，而且很便宜。正确地做是一种严重的痛苦。我的建议是将其视为一个商业问题：如果有人抱怨少了一分钱，给他们一美元，不要费心开始真正的解决方案，直到你这样做可以节省更多的钱。

# php - 我可以在请求的 javascript 中访问我的 ajax 请求的 href 吗？

> ID：900680
> 
> 赞同：2
> 
> 时间：2009-05-23T02:08:40.203
> 
> 标签：php, javascript, jquery, ajax

这是一个示例用例：

我通过 ajax 请求请求一个简单的表单。我想将结果提交到我请求的同一页面。有没有办法在结果请求的 javascript 中访问该请求的 URL？

下面是一些通过 javascript 和 PHP 完成我想要的代码。这样做的缺点是我必须将我的 javascript 包含在与 myajaxform.php 相同的文件中。我宁愿把它分开，这样我就可以缩小、缓存它等等。

我不能使用 location.href，b/c 它指的是窗口的位置，而不是最新的请求。

```
frm.submit(function () {
    if (frm.validate()) {
        var data = frm.serialize();
        jQuery.ajax({
            url : '<?= $_SERVER['PHP_SELF'] ?>',
            type : 'POST',
            data : data,
                dataType: "html",
            success : function (data) {

            }
        });
    }
    return false;
}); 
```

如果没有办法直接通过 javascript 访问它，你将如何解决这个问题，以便 javascript 可以进入它自己的文件？我想我可以在原始 ajax 请求的成功处理程序中创建对 URL 的某种引用。想法？也许使用 jQuery 数据方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T02:15:36.087

您可以将要提交的 url 存储在`action`表单的属性中，然后将其设置`url`为`frm.action`：

```
jQuery.ajax({
             url : frm.action,
             type : 'POST',
             data : data,
             dataType: "html",
             success : function (data) {
            }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T02:13:42.800

如果我完全误解了您的问题，请原谅我，因为我觉得它有些令人困惑。关于什么

```
frm.submit(function () {
    if (frm.validate()) {
        var data = frm.serialize();
    jQuery.ajax({
            url : window.location.href,
            type : 'POST',
            data : data,
            dataType: "html",
            success : function (data) {

            }
    });
    }
    return false;
}); 
```

# php - Web 开发中的 ASP.NET 到 PHP 转换

> ID：900683
> 
> 赞同：0
> 
> 时间：2009-05-23T02:11:21.447
> 
> 标签：php, asp.net

如何通过 html 表单在 asp.net Web 应用程序中来回传递信息？我知道如何在 PHP 中做到这一点，但我似乎无法通过代码隐藏的东西来考虑它（我认为这就是它的名称）。（注意：我几个小时前才开始查看 asp.net。我决定通过重新创建一个简单的页面来尝试它）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T03:29:16.080

您可以使用如下标准 HTML 表单发布到 ASP.NET 页面：

```
<form action="/MyPage.aspx" method="post"> 
    <input type="text" name="name" />
</form> 
```

然后在 MyPage.aspx 后面的代码中，您可以像这样访问表单元素：

```
protected void Page_Load(object sender, System.EventArgs e)
{
    string name = Request.Form["name"];
} 
```

还应该注意的是，大多数 ASP.NET 书籍可能会教授回发到同一页面。然后，您可以通过对象访问页面上的表单项，然后执行 Response.Redirect() 到您要转到的下一页。

在这种情况下，aspx 看起来像这样：

```
<asp:TextBox runat="server" id="Name" /> 
```

您可以像这样从代码隐藏中访问值：

```
protected void Page_Load(object sender, System.EventArgs e)
{
    if(Page.IsPostBack)
    {
        string name = Name.Text;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T02:24:53.667

要考虑的最重要的事情之一是您实际上无法控制经典 ASP.NET WebForms 中的表单回发。当我从 PHP 迁移到 ASP.NET 时，这对我来说是一个巨大的范式转变。但是，您确实有一个方便的对象，它可以使您的事情变得更轻松。在 ASP.NET WebForms 中，您可以访问[Session](http://msdn.microsoft.com/en-us/library/ms178581.aspx)对象。您可以在 Session 中存储几乎任何内容，并且在表单之间可见。您唯一需要注意的是[会话过期](http://www.hanselman.com/blog/TroubleshootingExpiredASPNETSessionStateAndYourOptions.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T07:46:29.670

# 无状态

PHP 非常适合无状态 Internet 模型。可以从头开始编写简单的表单并让它们立即执行您期望的操作。然而，ASP.NET 改变了无状态模型，使其类似于为桌面设计软件。

因此，我假设您正在尝试在记事本中键入 ASP.NET 命令，就像您在 PHP 中所习惯的那样，但这可能会导致挫败感。

## 奇才

要初步了解表单的结构和构建方式，也许您应该使用 Visual Studio 中提供的向导和教程构建一个简单的应用程序，然后深入了解它生成的代码。

# c# - 如何创建 c# 函数以将数字范围组转换为连续数字

> ID：900689
> 
> 赞同：1
> 
> 时间：2009-05-23T02:14:03.347
> 
> 标签：c#, .net, c#-3.0

我们有 6 组，每组 253 台机器，
但每组的范围从机器 #2 到机器 #254 ，
并继续 ID 来表示每台机器。

如下表所示：

组机器 ID
0 2-254 1-253

1 2-254 254-506

2 2-254 507-759

3 2-254 760-1012

4 2-254 1013-1265

5 2-254 1266-1518

我正在寻找 ac# easy way to write a function to convert from an ID to a group-machine

example: ID 508 is the group #2 , machine #3
（机器 507 是
第 2 组中的第一台机器，因为它以2 第二台机器是 machine#3)

以及相反的
例子：如果我得到参数：group #2 machine#5 ，
该函数必须返回 ID 510
我该怎么做？
我有一个公式，但它没有
任何想法？
谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T02:28:20.710

先把id减一，得到从零开始，然后就可以分为group和machine，通过加二将机器号调整到2-254范围：

```
id--;
int group = id / 253;
int machine = (id % 253) + 2; 
```

作为两个独立的功能：

```
int GetGroup(int id) {
   return (id - 1) / 253;
}

int GetMachine(int id) {
   return ((id - 1) % 253) + 2;
} 
```

要从组和机器中获取 id，请执行相反的操作；从机器编号中减去 2 使其从零开始，合并它们，然后加 1：

```
int GetId(int group, int machine) {
   return group * 253 + (machine - 2) + 1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T02:23:01.190

那这个呢？

```
function getid ( int g, int m ) {
    return g * (254 - 1 ) + m - 1; 
} 
```

我认为这是对的吗？简化为：

```
function getid ( int g, int m ) {
    return g * 253 + m - 1; 
} 
```

IE

```
2 * 253 + 3 = 508
2 * 253 + 5 = 510 
```

# networking - 如何找到我可以在不分段的情况下发送的最大 UDP 数据包？

> ID：900697
> 
> 赞同：59
> 
> 时间：2009-05-23T02:16:18.240
> 
> 标签：networking, tcp, udp, mtu

我需要知道我可以发送到另一台计算机的最大 UDP 数据包是没有碎片的。

这个大小通常被称为 MTU（最大传输单元）。假设在两台计算机之间，会有许多路由器和调制解调器，它们可能具有不同的 MTU。

我读到 Windows 中的 TCP 实现会自动找到路径中的最大 MTU。

我也在试验，我发现从我的计算机到服务器的最大 MTU 是 57712 字节+header。上面的任何东西都被丢弃了。我的电脑在局域网上，MTU 不是应该在 1500 字节左右吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-23T02:37:38.290

以下内容并未直接回答您的问题，但您可能会觉得它很有趣；它说 IP 数据包可以被分解/重新组合，因此大于底层媒体的限制（例如 1500 字节以太网）：[解决 GRE 和 IPSEC 的 IP 分段、MTU、MSS 和 PMTUD 问题](http://www.cisco.com/en/US/tech/tk827/tk369/technologies_white_paper09186a00800d6979.shtml)

* * *

有关此主题的更多信息：

*   [Re: UDP碎片](http://lists.apple.com/archives/darwin-development/2004/May/msg00069.html)说你应该使用ICMP而不是UDP来发现MTU
*   [路径 MTU 发现](http://msdn.microsoft.com/en-us/library/ms817967.aspx)表示 TCP 连接可能包括通过 ICMP 进行的隐式 MTU 协商

我不知道如何在 Windows 上通过 API 生成 ICMP：曾经有人提出过这样的 API，并引起了争议，因为人们认为通过生成大量ICMP 消息。

不，它看起来*已经*实现了：例如参见[Winsock Programmer's FAQ 示例：Ping: Raw Sockets Method](http://tangentsoft.net/wskfaq/examples/rawping.html)。

因此，要发现 MTU，请生成带有“不分段”标志的 ping 数据包。

也许有比这更简单的 API，我不知道；但我希望我已经让您了解底层协议。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-24T00:55:50.447

除了所有先前的答案，引用[经典](http://www.kohala.com/start/unpv22e/unpv22e.html)：

IPv4 和 IPv6 定义了*最小重组缓冲区大小*，我们保证任何实现都必须支持的最小数据报大小。对于 IPv4，这是 576 字节。IPv6 将此提升到 1,280 字节。

这几乎意味着如果您在公共互联网上工作并且您只控制交换的一侧，您希望将数据报大小限制在 576 以下 - 这就是大多数基于标准 UDP 的协议所做的。

另请注意，PMTU 是路径的动态属性。这是 TCP 为您处理的事情之一。除非您准备好重新实现大量的排序、定时和重传逻辑，否则将 TCP 用于任何关键网络。Benchmark，test，profile，即**证明**TCP是你的瓶颈，然后才考虑UDP。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-14T17:32:24.460

这对我来说是一个有趣的话题。当通过 UDP 在现实世界的互联网上传输大块 UDP 数据时，可能会感兴趣一些实际结果，并且以每秒 1 个数据包的传输速率，数据会继续以最小的丢包率出现，最高可达 2K。在这个问题上，你开始遇到问题，但我们经常发送 1600+ 字节的数据包而没有痛苦 - 这是通过 GPRS 移动网络以及全球范围内的 WAN。假设信号稳定（不是！），大约 1K 时，丢包率很低。

有趣的是，它不是奇怪的数据包，而是通常会持续几秒钟的数据包狂风——这大概就是 VoIP 呼叫偶尔崩溃的原因。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-23T02:19:48.543

您自己的 MTU 在[注册表](http://www.pctools.com/guides/registry/detail/280/)中可用，但实际上 MTU 将指向您的机器和目标之间的路径中的最小 MTU。它既可变又只能凭经验确定。有许多[RFC](http://en.wikipedia.org/wiki/Path_MTU_discovery) 展示了如何确定它。

LAN 内部可能具有非常大的 MTU 值，因为网络硬件通常是同质的或至少是集中管理的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-31T16:30:38.713

对于 UDP 应用程序，如果您想避免 IP 碎片或丢包，您必须自己处理端到端 MTU。任何应用程序的推荐方法是尽最大努力使用 PMTU 来选择最大数据报，或发送数据报 < 最小 PMTU

[https://www.rfc-editor.org/rfc/rfc5405#section-3.2](https://www.rfc-editor.org/rfc/rfc5405#section-3.2)

> 应用程序设计者的单播 UDP 使用指南“不应该发送超过 PMTU 的数据报，应该发现 PMTU 或发送数据报 < 最小 PMTU

Windows 似乎通过它的基本套接字选项界面设置和访问 PMTU 信息：

您可以确保通过 IP_MTU_DISCOVER 开启 PMTU 发现，并且可以通过 IP_MTU 读取 MTU。

[https://docs.microsoft.com/en-us/windows/desktop/winsock/ipproto-ip-socket-options](https://docs.microsoft.com/en-us/windows/desktop/winsock/ipproto-ip-socket-options)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-09-06T23:51:44.457

这是我为检查路径 MTU 问题而编写的一些 Windows PowerShell。（通用技术在其他编程语言中实现起来并不难。）许多防火墙和路由器被配置为丢弃所有不了解的人的所有 ICMP。路径 MTU 发现取决于是否能够接收设置了需要分片的 ICMP 目标不可达消息，以响应发送设置了不分片的数据包。Resolve IPv4 Fragmentation , [MTU, MSS, and PMTUD Issues with GRE and IPsec](https://www.cisco.com/c/en/us/support/docs/ip/generic-routing-encapsulation-gre/25885-pmtud-ipfrag.html)实际上很好地解释了发现的工作原理。

```
function Test-IPAddressOrName($ipAddressOrName)
{
    $ipaddress = $null
    $isValidIPAddressOrName = [ipaddress]::TryParse($ipAddressOrName, [ref] $ipaddress)

    if ($isValidIPAddressOrName -eq $false)
    {
        $hasResolveDnsCommand = $null -ne (Get-Command Resolve-DnsName -ErrorAction SilentlyContinue)
        if ($hasResolveDnsCommand -eq $true)
        {
            $dnsResult = Resolve-DnsName -DnsOnly -Name $ipAddressOrName -ErrorAction SilentlyContinue
            $isValidIPAddressOrName = $null -ne $dnsResult
        }
    }

    return $isValidIPAddressOrName
}

function Get-NameAndIPAddress($ipAddressOrName)
{
    $hasResolveDnsCommand = $null -ne (Get-Command Resolve-DnsName -ErrorAction SilentlyContinue)

    $ipAddress = $null
    $validIPAddress = [ipaddress]::TryParse($ipAddressOrName, [ref] $ipAddress)
    $nameAndIp = [PSCustomObject] @{ 'Name' = $null; 'IPAddress' = $null }

    if ($validIPAddress -eq $false)
    {
        if ($hasResolveDnsCommand -eq $true)
        {
            $dnsResult = Resolve-DnsName -DnsOnly $ipAddressOrName -Type A -ErrorAction SilentlyContinue

            if ($null -ne $dnsResult -and $dnsResult.QueryType -eq 'A')
            {
                $nameAndIp.Name = $dnsResult.Name
                $nameAndIp.IPAddress = $dnsResult.IPAddress
            }
            else
            {
                Write-Error "The name $($ipAddressOrName) could not be resolved."
                $nameAndIp = $null
            }
        }
        else
        {
            Write-Warning "Resolve-DnsName not present. DNS resolution check skipped."
        }
    }
    else
    {
        $nameAndIp.IPAddress = $ipAddress

        if ($hasResolveDnsCommand -eq $true)
        {
            $dnsResult = Resolve-DnsName -DnsOnly $ipAddress -Type PTR -ErrorAction SilentlyContinue

            if ($null -ne $dnsResult -and $dnsResult.QueryType -eq 'PTR')
            {
                $nameAndIp.Name = $dnsResult.NameHost
            }
        }
    }

    return $nameAndIp
}

<#
    .Synopsis
    Performs a series of pings (ICMP echo requests) with Don't Fragment specified to discover the path MTU (Maximum Transmission Unit).

    .Description
    Performs a series of pings with Don't Fragment specified to discover the path MTU (Maximum Transmission Unit). An ICMP echo request 
    is sent with a random payload with a payload length specified by the PayloadBytesMinimun. ICMP echo requests of increasing size are 
    sent until a ping response status other than Success is received. If the response status is PackeTooBig, the last successful packet 
    length is returned as a reliable MTU; otherwise, if the respone status is TimedOut, the same size packet is retried up to the number 
    of retries specified. If all of the retries have been exhausted with a response status of TimedOut, the last successful packet 
    length is returned as the assumed MTU.

    .Parameter UseDefaultGateway
    If UseDefaultGateway is specified the default gateway reported by the network interface is used as the destination host.

    .Parameter DestinationHost
    The IP Address or valid fully qualified DNS name of the destination host.

    .Parameter InitialTimeout
    The number of milliseconds to wait for an ICMP echo reply. Internally, this is doubled each time a retry occurs.

    .Parameter Retries
    The number of times to try the ping in the event that no reply is recieved before the timeout.

    .Parameter PayloadBytesMinimum
    The minimum number of bytes in the payload to use. The minimum MTU for IPv4 is 68 bytes; however, in practice, it's extremely rare 
    to see an MTU size less than 576 bytes so the default value is 548 bytes (576 bytes total packet size minus an ICMP header of 28 
    bytes).

    .Parameter PayloadBytesMaximum
    The maximum number of bytes in the payload to use. An IPv4 MTU for jumbo frames is 9000 bytes. The default value is 8973 bytes (9001 
    bytes total packet size, which is 1 byte larger than the maximum IPv4 MTU for a jumbo frame, minus an ICMP header of 28 bytes).

    .Example
    Discover-PathMTU -UseDefaultGateway

    .Example
    Discover-PathMTU -DestinationHost '192.168.1.1'

    .Example
    Discover-PathMTU -DestinationHost 'www.google.com'
#>
function Discover-PathMtu
{
    [CmdletBinding(SupportsShouldProcess = $false)]
    param
    (
        [Parameter(Mandatory = $true, ParameterSetName = 'DefaultGateway')]
        [switch] $UseDefaultGateway,

        [Parameter(Mandatory = $true, Position = 0, ValueFromPipeline = $true, ParameterSetName = 'IPAddressOrName')]
        [ValidateScript({ Test-IPAddressOrName $_ })]
        [string] $DestinationHost,

        [Parameter(ParameterSetName = 'IPAddressOrName')]
        [Parameter(ParameterSetName = 'DefaultGateway')]
        [int] $InitialTimeout = 3000,

        [Parameter(ParameterSetName = 'IPAddressOrName')]
        [Parameter(ParameterSetName = 'DefaultGateway')]
        [int] $Retries = 3,

        [Parameter(ParameterSetName = 'IPAddressOrName')]
        [Parameter(ParameterSetName = 'DefaultGateway')]
        $PayloadBytesMinimum = 548,

        [Parameter(ParameterSetName = 'IPAddressOrName')]
        [Parameter(ParameterSetName = 'DefaultGateway')]
        $PayloadBytesMaximum = 8973
    )

    begin
    {
        $ipConfiguration = Get-NetIPConfiguration -Detailed | ?{ $_.NetProfile.Ipv4Connectivity -eq 'Internet' -and $_.NetAdapter.Status -eq 'Up' } | Sort { $_.IPv4DefaultGateway.InterfaceMetric } | Select -First 1
        $gatewayIPAddress = $ipConfiguration.IPv4DefaultGateway.NextHop

        $pingOptions = New-Object System.Net.NetworkInformation.PingOptions
        $pingOptions.DontFragment = $true
        $pinger = New-Object System.Net.NetworkInformation.Ping

        $rng = New-Object System.Security.Cryptography.RNGCryptoServiceProvider
    }

    process
    {
        $pingIpAddress = $null

        if ($UseDefaultGateway -eq $true)
        {
            $DestinationHost = $gatewayIPAddress
        }

        $nameAndIP = Get-NameAndIPAddress $DestinationHost

        if ($null -ne $nameAndIP)
        {
            Write-Host "Performing Path MTU discovery for $($nameAndIP.Name) $($nameAndIP.IPAddress)..."

            $pingReply = $null
            $payloadLength = $PayloadBytesMinimum
            $workingPingTimeout = $InitialTimeout

            do
            {
                $payloadLength++

                # Use a random payload to prevent compression in the path from potentially causing a false MTU report.
                [byte[]] $payloadBuffer = (,0x00 * $payloadLength)
                $rng.GetBytes($payloadBuffer)

                $pingCount = 1

                do
                {
                    $pingReply = $pinger.Send($nameAndIP.IPAddress, $workingPingTimeout, $payloadBuffer, $pingOptions)

                    if ($pingReply.Status -notin 'Success', 'PacketTooBig', 'TimedOut')
                    {
                        Write-Warning "An unexpected ping reply status, $($pingReply.Status), was received in $($pingReply.RoundtripTime) milliseconds on attempt $($pingCount)."
                    }
                    elseif ($pingReply.Status -eq 'TimedOut')
                    {
                        Write-Warning "The ping request timed out while testing a packet of size $($payloadLength + 28) using a timeout value of $($workingPingTimeout) milliseconds on attempt $($pingCount)."
                        $workingPingTimeout = $workingPingTimeout * 2
                    }
                    else
                    {
                        Write-Verbose "Testing packet of size $($payloadLength + 28). The reply was $($pingReply.Status) and was received in $($pingReply.RoundtripTime) milliseconds on attempt $($pingCount)."
                        $workingPingTimeout = $InitialTimeout
                    }

                    Sleep -Milliseconds 10

                    $pingCount++
                } while ($pingReply.Status -eq 'TimedOut' -and $pingCount -le $Retries)
            } while ($payloadLength -lt $PayloadBytesMaximum -and $pingReply -ne $null -and $pingReply.Status -eq 'Success')

            if ($pingReply.Status -eq 'PacketTooBig')
            {
                Write-Host "Reported IPv4 MTU is $($ipConfiguration.NetIPv4Interface.NlMtu). The discovered IPv4 MTU is $($payloadLength + 27)."
            }
            elseif ($pingReply.Status -eq 'TimedOut')
            {
                Write-Host "Reported IPv4 MTU is $($ipConfiguration.NetIPv4Interface.NlMtu). The discovered IPv4 MTU is $($payloadLength + 27), but may not be reliable because the packet appears to have been discarded."    
            }
            else
            {
                Write-Host "Reported IPv4 MTU is $($ipConfiguration.NetIPv4Interface.NlMtu). The discovered IPv4 MTU is $($payloadLength + 27), but may not be reliable, due to an unexpected ping reply status."    
            }

            return $payloadLength + 27
        }
        else
        {
            Write-Error "The name $($DestinationHost) could not be resolved. No Path MTU discovery will be performed."
        }
    }

    end
    {
        if ($null -ne $pinger)
        {
            $pinger.Dispose()
        }

        if ($null -ne $rng)
        {
            $rng.Dispose()
        }
    }
} 
```

# database - 如何通过 System.Data.SQLite 数据提供程序在数据库项目中使用 SQL 脚本？

> ID：900700
> 
> 赞同：0
> 
> 时间：2009-05-23T02:17:31.810
> 
> 标签：database, visual-studio, fluent-nhibernate, system.data.sqlite

我有一个项目，我试图通过[System.Data.SQLite](http://sqlite.phxsoftware.com/)使用 SQLite 。为了使数据库处于版本控制之下，我继续在我的 VS2008 中创建了一个数据库项目。听起来不错，对吧？

我创建了我的第一个表创建脚本并尝试在脚本上使用右键单击-> 运行来运行它，我收到以下错误消息：

> 您正在使用的提供程序或数据源不支持此操作。

有谁知道是否有一种自动方法可以使用 System.Data.SQLite 安装提供的提供程序，针对数据库引用的 SQLite 数据库使用属于数据库项目一部分的脚本？

我已经尝试了所有我能想到的变体，试图让脚本使用默认的 Run 或 Run On... 命令运行。这是最冗长且可能不正确的脚本：

```
USE Characters
GO

IF EXISTS (SELECT * FROM sysobjects WHERE type = 'U' AND name = 'Skills')
  BEGIN
    DROP Table Skills
  END
GO

CREATE TABLE Skills
(
   SkillID INTEGER PRIMARY KEY AUTOINCREMENT,
   SkillName TEXT,
   Description TEXT
)
GO 
```

请注意，这是我第一次尝试使用数据库，也是我第一次接触 SQLite。在我试图让它运行的过程中，除了 CREATE TABLE 命令之外，我已经删除了所有内容。

**更新：**好的，正如罗伯特哈维在下面指出的那样，这看起来像一个 SQL Server 存储过程。我进入服务器资源管理器并使用我的连接（来自数据库项目）执行他关于创建表的建议。我可以生成 SQL 来创建表，结果如下：

```
CREATE TABLE [Skills] (
    [SkillID] integer PRIMARY KEY NOT NULL,
    [SkillName] text NOT NULL,
    [Description] text NOT NULL
); 
```

我可以轻松地复制它并将其添加到项目中（或将其添加到处理我的其余数据访问的另一个项目中），但是无论如何在构建时自动执行此操作？我想，因为在这种情况下 SQLite 是一个单一文件，所以我也可以将构建的数据库保持在版本控制之下。

想法？此实例的最佳实践？

**更新：**我在想，因为我打算使用 Fluent NHibernate，我可能只是使用它的自动持久性模型来保持我的数据库最新并有效地进行源代码控制。想法？陷阱？我想我必须将初始人口插入单独保存在源代码控制中，但它应该可以工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-07-13T18:18:21.083

我使用 SQLite SQL 脚本构建了我的数据库，然后像这样将它输入到 sqlite3.exe 控制台程序中。

c:\sqlite3.exe mydatabase.db < FileContainingSQLiteSQLCommands

约翰

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T03:02:49.253

好吧，您的脚本看起来像一个 SQL Server 存储过程。SQLite 很可能不支持这个，因为

1.  它不支持存储过程，并且
2.  它不理解 SQL Server T-SQL

SQL 实际上是一个伪标准。它在供应商之间有所不同，有时甚至在同一供应商内产品的不同版本之间也有所不同。

也就是说，我看不出有什么理由不能通过打开连接和命令对象来对 SQLite 数据库运行任何（与 SQLite 兼容的）SQL 语句，就像使用 SQL Server 一样。

但是，由于您是数据库和 SQLite 的新手，因此您应该从这里开始。我假设你已经安装了 SQLite

1.  在 Visual Studio 2008 中创建一个新的 Windows 应用程序。数据库应用程序对您没有用处。

2.  通过下拉查看菜单并选择服务器资源管理器来打开服务器资源管理器。

3.  通过右键单击服务器资源管理器中的数据连接节点并单击添加新连接来创建一个新连接...

4.  单击更改按钮

5.  选择 SQLite 提供程序

6.  给你的数据库一个文件名。

7.  单击确定。

服务器资源管理器中应该会出现一个新的数据连接。您可以通过右键单击 Tables 节点并选择 Add New Table 来创建您的第一个表。

# apache-flex - 是否有与 GWT-RPC 等效的 Flex？

> ID：900703
> 
> 赞同：6
> 
> 时间：2009-05-23T02:22:23.500
> 
> 标签：apache-flex, gwt, gwt-rpc

现在，我的很多应用程序都使用 GWT-RPC 从 GWT RemoteService 中检索 POJO，而 GWT RemoteService 又调用 Web 服务 (SOAP) 来获取数据。我正在评估 Flex，并没有真正看到任何与这种简单架构真正相似的东西。我可能错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T02:35:24.893

AMF 是 Adob​​e 的紧凑型二进制消息格式，用于 Flash / Flex 应用程序。BlazeDS 是 Java 的开源参考实现，基本上只使用一个简单的“消息代理”servlet 来处理请求。这类似于在 GWT 中公开服务的方式，尽管 Blaze 使用单个 servlet，而不是 GWT 中的多个。

[http://opensource.adobe.com/wiki/display/blazeds/BlazeDS/](http://opensource.adobe.com/wiki/display/blazeds/BlazeDS/)

[http://download.macromedia.com/pub/labs/amf/amf3_spec_121207.pdf](http://download.macromedia.com/pub/labs/amf/amf3_spec_121207.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T02:25:59.983

[BlazeDS](http://opensource.adobe.com/wiki/display/blazeds/BlazeDS/)，尤其是与[Spring 集成](http://www.springsource.org/spring-flex)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T02:25:49.843

[这](http://www.adobe.com/devnet/flex/articles/java_flex.html)对你有帮助吗？我对 GWT-RPC 不太熟悉，但是您正在寻找 AMF 协议吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T14:32:10.217

正如其他人所提到的，这里的主要选择是 BlazeDS，它是 Adob​​e 的开放式服务器产品，用于公开 flex-native 服务器 RPC 和消息传递。BlazeDS 本身有点笨拙，如果您在服务器上使用 Spring，则可以在 Spring 和 Blaze 之间进行巧妙的集成。

另一个第 3 方替代方案是 GraniteDS，它的功能与 Blaze 大致相同，但开箱即用对 Spring 友好，并且比 Blaze 做得更多（例如运行时编译和从 webapp 生成 SWF 文件）。我没有尝试过Granite，但它看起来很不错。

# ruby - 为什么 instance_eval() 在类上调用时会定义类方法？

> ID：900704
> 
> 赞同：6
> 
> 时间：2009-05-23T02:22:23.873
> 
> 标签：ruby, class-method, instance-method

```
Foo = Class.new
Foo.instance_eval do
  def instance_bar
    "instance_bar"
  end
end
puts Foo.instance_bar       #=> "instance_bar"
puts Foo.new.instance_bar   #=> undefined method ‘instance_bar’ 
```

我的理解是，在对象上调用[instance_eval](http://www.rubybrain.com/api/ruby-1.8.7/doc/index.html?a=M000295&name=instance_eval)应该允许您为该对象定义实例变量或方法。

但是在上面的例子中，当你在 Foo 类上调用它来定义 instance_bar 方法时，**instance_bar 就变成了一个**可以用“Foo.instance_bar”调用的类方法。很明显，这段代码没有创建实例方法，因为 Foo.new.instance_bar 导致“未定义的方法 'instance_bar'”。

**为什么 instance_eval 在这种情况下定义类方法而不是实例方法？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-23T03:00:32.113

`x.instance_eval`更改您的上下文，因此`self`评估为`x`.

这允许您做很多事情，包括定义实例变量和实例方法，但仅限于 x。

```
 x = Object.new
 y = Object.new

 # define instance variables for x and y
 x.instance_eval { @var = 1 }
 y.instance_eval { @var = 2 }

 # define an instance method for all Objects
 class Object
   def var
     @var
   end
 end

 x.var #=> 1
 y.var #=> 2 
```

Ruby 允许您在几个地方为对象定义实例方法。通常，在一个类中定义它们，并且这些实例方法在该类的所有实例之间共享（`def var`如上所示）。

但是，我们也可以为单个对象定义一个实例方法：

```
# here's one way to do it
def x.foo
  "foo!"
end
# here's another
x.instance_eval do
  # remember, in here self is x, so bar is attached to x.
  def bar
    "bar!"
  end
end 
```

即使`x`和`y`具有相同的类，它们也不共享这些方法，因为它们只是为`x`.

```
x.foo #=> "foo!"
x.bar #=> "bar!"
y.foo #=> raises NoMethodError
y.bar #=> raises NoMethodError 
```

现在在 ruby​​ 中，一切都是对象，甚至是类。类方法只是该类对象的实例方法。

```
# we have two ways of creating a class:
class A 
end
# the former is just syntatic sugar for the latter
B = Class.new

# we have do ways of defining class methods:

# the first two are the same as for any other object
def A.baz
  "baz!"
end
A.instance_eval do
   def frog
     "frog!"
   end
end

# the others are in the class context, which is slightly different
class A
  def self.marco
    "polo!"
  end
  # since A == self in here, this is the same as the last one.
  def A.red_light
    "green light!"
  end

  # unlike instance_eval, class context is special in that methods that
  # aren't attached to a specific object are taken as instance methods for instances
  # of the class
  def example
     "I'm an instance of A, not A itself"
  end
end
# class_eval opens up the class context in the same way
A.class_eval do
  def self.telegram
    "not a land shark"
  end
end 
```

再次注意，所有这些方法都是`A`特定的，`B`不能访问它们中的任何一个：

```
A.baz #=> "baz!"
B.telegram #=> raises NoMethodError 
```

重要的是，类方法只是类对象的实例方法`Class`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-29T07:36:09.267

“instance_eval”的目的是扩展对象，而“class_eval”的目的是扩展类。而且因为类也是对象，所以您可以在类上应用 instance_eval。

我想在经典的 OOP 中类的扩展更容易理解。动态语言允许我们轻松地指定特定对象的行为。事实上，每个对象都可以有自己的行为，这为设计应用程序增加了很多灵活性。对于同一类的对象，不仅数据会有所不同。两个人之所以不同，不仅因为他们出生在不同的年份，不仅因为他们有不同的父母，而且他们的思维方式不同，因此行为也不同。

改变每个对象行为的能力是基本的。它以多种语言存在。

考虑 instance_eval 首先考虑对象。然后你会意识到类也是对象——对象的附加目的是创建新对象，保存对常见行为（方法）的描述。您不仅可以使用类的定义，还可以将类分配给变量，将类作为参数传递，在类上调用方法，对类进行编程！

我会推荐 Yehuda Katz 和 Yugui 写的文章来深入了解它：

*   [http://yehudakatz.com/2009/11/15/metaprogramming-in-ruby-its-all-about-the-self/](http://yehudakatz.com/2009/11/15/metaprogramming-in-ruby-its-all-about-the-self/)
*   [http://yugui.jp/articles/846](http://yugui.jp/articles/846)

# java - 在面试前为 Java 专业工作环境做准备

> ID：900715
> 
> 赞同：3
> 
> 时间：2009-05-23T02:30:19.443
> 
> 标签：java, ide, jakarta-ee

我最近毕业于计算机工程专业。我还没有固定的工作。经济衰退对我的目标和现实产生了很大影响。我不想只是坐下来。我想提高我的能力。我想在专业的工作环境中学习和实践。

现在我的问题是：在专业工作环境中遵循哪些工具和做法？我的意思是 IDE、团队工作工具、调试工具、单元测试工具等？

Java EE 中有哪些框架是必须知道的，或者哪些框架会在我的工作面试中为我带来优势？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T02:34:29.887

一些初步建议：

*   IDE：[Eclipse](http://www.eclipse.org/)或[IntelliJ](http://www.jetbrains.com/idea/)
*   源代码管理工具，如[git](http://git-scm.com/)、[Subversion](http://subversion.tigris.org/)、[Mercurial](http://www.selenic.com/mercurial/wiki/)、[CVS](http://www.nongnu.org/cvs/)
*   用于测试的[JUnit](http://www.junit.org/)

阅读“[代码完成](http://cc2e.com/)”，然后将其放在枕头下睡觉。也许在你的浴室里也放一份。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T03:55:44.600

你可能会发现这个民意调查（很长但）很有趣...... [http://www.java-forums.org/new-java/7315-what-you-using-write-your-code.html](http://www.java-forums.org/new-java/7315-what-you-using-write-your-code.html)

在过去的五年（左右）时间里，我们一直在开展合作社（即学员）计划。以下是合作社不知道的东西列表（不分先后），我们真的希望他们在到达时知道“基础知识”：

*   测试 - 每个人都测试，但（恕我直言）很少有人真正有效地测试。包括我自己。
*   团队开发 - 如何在比任何人都大的代码库上一起工作。
*   了解遗留系统 - 嘿，这段代码是我年龄的两倍？怎么回事？
*   项目管理——按时按预算交付质量的黑暗艺术。
*   商业分析 - BA 充满了它！你至少需要足够了解才能闻到污水的味道。
*   知道什么时候说不——在镜子前练习这样说：“不，先生，对不起，你真的不能以二手迷你车的价格拥有这辆法拉利。”

这项技术真的很容易。话虽如此，您的第一个职位很可能是密码猴……所以 tecken ze spreken 越多，您就越有可能踏入大门。

所以我建议

1.  处理[J2EE 1.4 教程](http://java.sun.com/j2ee/1.4/docs/tutorial/doc/) ……还可以查看 Web 应用程序 MVC 框架，例如 Struts 1 或（更好的）JSF；和......还看看Hibernate - 伪标准持久层。...还可以查看“早期”DHTML - 使用 javascript 操作 html-DOM。... 也看看 Swing，Applets，但尽量不要淹没在其中。

2.  然后（并且仅在那时）处理[J2EE 1.5 Tutorial (EJB3)](http://java.sun.com/javaee/5/docs/tutorial/doc/)。我自己还在这个过程中。我已经做了两个月了。每次超过两个小时都会让我的大脑受伤，很多......你*可以*教一只老狗新技巧，你只需要慢慢做。

就像已经说过的那样：每个职位都有自己的技术集......两个坐在一起的人可能会使用截然不同的产品组。我建议您学习而不是“所有技术”的是学习技术的过程，以及选择适合特定问题和组织的适当技术的考虑因素。

你能做的最好的事情就是加入一个“年轻的 IT 专业人士”小组（就像[澳大利亚的这个](http://www.acs.org.au/youngit/)小组）......他们可能会做一个“模拟面试”日......建设性的批评（相对于勺子喂食）会改善你的工作申请、简历和面试能力。与一群志趣相投的人一起闲逛既有趣又有趣。在大学和 IT 工作之间的间隙，你会错过那种“大脑刺激”。

关于经济衰退的事情......我在互联网泡沫破裂一个月后毕业于 B.Bus（计算）。我在超市工作，开出租车，送披萨，做一些建筑工人的劳动，鞭打个人电脑，向无法为 ${nameless_charlitans} 加起来的人提供糟糕的财务建议，鞭打杀毒软件，在当地辅导TAFE 大学，为一家大型会计师事务所获得了一些短期合同编写软件......然后我开始自愿在当地的就业交流中心修理电脑（无论如何，我在那里等了几个小时的约会，而且它总比什么都不做要好）...那里的 IT 哥们让我接受了“一个伙伴”的采访（即我的工作从未被宣传过），剩下的就是历史了。有趣的是，事情是如何运作的。我对你有感觉，只是请不要亲自接受击退......你'

干杯。基思。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T02:45:04.593

[IntelliJ](http://www.jetbrains.com/idea/)是迄今为止最好的 Java IDE，但它是商业的。在[Eclipse](http://www.eclipse.org/)和[NetBeans](http://www.netbeans.org)之间，我会推荐 NetBeans，它更接近 IDE 的外观和/或功能（与 Eclipse 无关，但我无法使用它......也许只是我的问题:)）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-23T05:52:17.057

从长远来看，从事开源项目。你会学到很多东西，而且可能比你从工作中学到的更快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T11:59:29.660

假设您可以让某人阅读您的简历并获得面试：

获取 Josh Bloch 的《Effective Java》，阅读、记忆并理解它。很多面试官（我做的比我应得的更多）把它作为人们应该知道和理解的技术的一个很好的来源。

在工具方面 - 如果你知道，你就不会出错：

*   蚀
*   春天
*   休眠
*   蚂蚁/Maven/哈德森
*   JUnit
*   日志4J

这些都是开源的（因此适合任何人的预算）。大多数 Java 商店都会使用其中的至少一种！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-23T02:40:09.407

我的 Java 同事在大多数事情上都使用它。

*   蚀
*   甲骨文或 MySQL
*   支柱
*   颠覆
*   布吉拉
*   JUnit

他们还使用 Sun 的 Java Composite Application Platform Suite (JCAPS) 做一些事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-23T03:44:37.333

我将建议我认为最受欢迎的选择，希望这能让你更多地接触到第一份工作。一旦你弄湿了脚，我建议你花一些空闲时间来评估那里的其他选择。Java 生态系统中有很多东西需要探索。

*   IDE：在我交谈过的人看来，Eclipse 似乎是最受欢迎的。Netbeans 也很稳固，但由于甲骨文正在努力收购 Sun，它的未来仍存疑。很多人都对 IntelliJ 发誓，但我认为它的社区要小得多（而且要花钱）。
*   SCM：Subversion 和 CVS 可能是最流行的，Eclipse 内置了对两者的支持。
*   单元测试：JUnit，它是事实上的标准。
*   构建：Ant，再次成为构建自动化的事实标准。
*   框架：我会推荐 (1) Spring 和 Hibernate，广受欢迎的开源堆栈或 (2) EJB 和 JPA，Java 标准。我个人的偏好是#1。就 UI 而言，有很多可用的选项，因此很难推荐。Struts 和 Spring MVC 是更“老派”的经典 MVC 框架，而 GWT 和 JSF 是更“面向组件”的框架。你也有一些不太受欢迎的，比如 Wicket 和 Tapestry。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-11-03T12:42:19.660

**使用以下工具，您可以制作示例/演示应用程序**

**IDE：** JDevloper/Eclipse/Netbeans

**服务器：** Tomcat/Jboss/Glassfish

**技术：** Hibernate,Spring,EJB,Struts,Log4J,SLF4J,Hudson,Ant,Maven

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-23T02:57:52.943

我认为你需要仔细看看你申请的公司。Java 世界中的“工具”数量太多了，您无法自己熟悉以吸引任何随机雇主。

我个人认为其中大部分都是过于复杂的废话，尽管它得到了所有的营销炒作。找一家看起来与您感兴趣的东西合作的公司，找出他们使用的东西类型，然后熟悉它。您可能无法展示工作级别的经验，但您会表现出热情。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-23T04:00:26.160

Weblogic、Jetty、JBoss 或 Tomcat 与

*   -Maven 构建工具（间接后台 Ant 和库版本控制） -Prettify（“readify”） -Minify（无空格） -Refactoring（批量重命名单元） -XML -压力测试工具

旧工具，例如 rsync、emacs、awk、xargs、dd 处理最大的文件。less 对流文件有好处（shift+F）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-23T12:24:57.987

构建您有兴趣构建的东西，并选择看起来正确的技术来完成这项工作。同时，花点额外的时间——正如你在工作时应该做的那样——使用可能很麻烦但你认为会给你带来优势的工具。了解 Spring 或 Maven 之类的框架或任何可能相关或不相关的框架。一个好的雇主不在乎你知道什么，而是你如何知道你知道什么。你能学吗？

使用一些笔记存储库（比如 Evernote 或我自己的 TheKbase :) 并开始为你的世界做笔记。无论你消化了什么知识，都应该可以立即检索，而不是基于你有限的记忆。

我一直对 Swing 和教学很感兴趣，奇怪的是，我找到了一份教 Swing 的工作（我知道一点），而且还教各种我不知道的东西，比如 Struts 和 XML 安全性（你读了书，然后把当时）。另外，我教过我一直喜欢的 IDE，尽管每个人都认为我是一个不成熟的程序员，因为我想要自动完成 :) 再次，遵循偏好......

我的观点是，除非学习框架或工具对你特别有吸引力，否则不要费心去学习它。另一方面，如果框架对你来说特别烦人（对我来说，它们一直是），那就选择最烦人和最令人生畏的，并用它来构建一些东西。这是大多数人做的一种仪式，因为雇主要求它，这为时已晚，IMO。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-23T05:50:02.097

这实际上取决于您所在地区的工作。我建议你采取分析方法。

使用适合您所在地区的工作搜索引擎并进行关键字搜索。这将为您提供人们在您所在地区寻找的大量工作技能。

您可能还会发现这些页面很有用2009 年的[10 种热门技能 2009](http://www.globalknowledge.com/training/generic.asp?pageid=2321&country=United+States) [年 IT 薪资指南](http://www.itcareerplanet.com/article.php/3782086)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-23T06:04:26.317

写一个自己的主页！它表明你在编写软件时很开心（所以你在空闲时间做）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-23T13:17:18.117

您已经从上面的答案中获得了一个很好的工具列表。您可以采取以下措施来吸引潜在雇主。

*   参与一个开源项目
*   要成为一名更好的程序员，请学习一门与 Java 完全不同的语言。一个好的起点可能是 JVM 上的其他语言 - Clojure / Scala。
*   获得 J2EE 特定领域的专业知识，这将使您脱颖而出 - 安全性、性能分析等。
*   使用您所学的工具和框架创建您自己的网站

# apache-flex - Flex：弹出窗口 - 获取 [ok] 或 [cancel]

> ID：900735
> 
> 赞同：2
> 
> 时间：2009-05-23T02:46:05.543
> 
> 标签：apache-flex, air, popup

我已经使用 Winforms 和 WPF 完成了很多 C# 编程。我现在正在开发一个 Flex/Air 应用程序以获得跨平台支持。但这是我的第一个弹性项目，所以我边走边学。

我有一个要弹出的窗口，用户将填写表格，然后点击 OK 或 CANCEL。我以与 C# 中相同的方式设置它，但它不起作用，而且我真的找不到让它做我想做的事情的方法。

编辑：所以我现在正在尝试事件，这些事件似乎没有得到处理......

再次编辑：哦，这是因为弹出管理器似乎创建了 Form 对象的一个​​新实例，而不是使用我已经创建的那个。

所以在 showWindow 方法中，我输入了这段代码而不是弹出管理器：

```
parent.addChild(this); 
```

然后我在关闭它时将其删除。唯一的问题是，它不会像弹出管理器那样禁用父级的其余部分。对此有何建议？

家长：

```
private function btnAdd_Clicked():void
{               
        var form:Form = new Form();
        form.addEventListener(CloseEvent.CLOSE, onFormClosed, false, 0, true);

        recipeForm.showWindow(this);
}

private function onFormClosed(e:CloseEvent):void
{
    //none of these Alerts are ever shown. I also tried breakpoints in debug to try an follow the code, with no luck
    Alert.show("Closed");
    if(e.detail == Alert.OK)
    {
        Alert.show("OK");
    }
    else if(e.detail == Alert.CANCEL)
    {
        Alert.show("Cancel");
    }
} 
```

孩子：

```
private function btnCancel_Clicked():void
{
    okClicked = false;
    closeWindow();
}

public function closeWindow():void
{
    var e:CloseEvent = new CloseEvent(CloseEvent.CLOSE);
    e.detail = okClicked ? Alert.OK : Alert.CANCEL;
    dispatchEvent(e);
    PopUpManager.removePopUp(this);
}

public function showWindow(parent:WindowedApplication):void
{
    var window:IFlexDisplayObject = PopUpManager.createPopUp(parent, RecipeForm, true);
    PopUpManager.centerPopUp(window);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T03:11:52.433

您至少可以通过两种不同的方式执行此操作：

第一种方式：使用事件

让您的 Form 类在单击任一按钮时调度一个事件。在从父视图实例化 Form 之后，为已知要调度的事件添加一个 eventListener。当 Form 调度事件时，将调用 eventListener。您甚至可以重用 Flex 的 CloseEvent 并将“detail”属性设置为 Alert.OK 或 Alert.CANCEL，然后再调度它。

通知：

```
var e:CloseEvent = new CloseEvent(CloseEvent.CLOSE);
e.detail = okClicked ? Alert.OK : Alert.CANCEL;
dispatchEvent(e); 
```

在父母中：

```
var f:Form = new Form();
f.addEventListener(CloseEvent.CLOSE, onClose, false, 0, true);
...
private function onClose(e:CloseEvent):void
{
    if (e.detail == Alert.OK)
        // do something
    else if (e.detail == Alert.CANCEL)
        // do something else
} 
```

第二种方式：使用回调

将类型为“Function”的公共 var 添加到您的 Form 类并提供来自父级的回调函数。这与 #1 基本相同，只是抽象/间接少了一点。

我会推荐#1，因为 Flex 中的事件模型设计得非常好，并且比回调更灵活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-11T10:18:24.127

通知：

```
var e:CloseEvent = new CloseEvent(CloseEvent.CLOSE);
e.detail = okClicked ? Alert.OK : Alert.CANCEL;
dispatchEvent(e); 
```

在父母中：

```
var f:Form = new Form();
f.addEventListener(CloseEvent.CLOSE, onClose, false, 0, true);
...
private function onClose(e:CloseEvent):void
{
    if (e.detail == Alert.OK)
        // do something
    else if (e.detail == Alert.CANCEL)
        // do something else
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-14T03:44:33.527

不确定这是否仍然是一个悬而未决的问题。我遇到了同样的问题，我想我知道出了什么问题。至少我为我的问题做了。

我完全按照你的方式实现了。我还将 close 属性设置为 closeWindow （我正在为我的对话框使用 TitleWindow）。

So when the window is closed via the X at the top, it will call closeWindow, also if you click on the Cancel button, it will also call closeWindow. The problem for me was that clicking cancel, dispatches a CloseEvent which seems to be caught by a Listener which calls closeWindow again (possibly via the close attribute which probably creates its own internal listener). I'm not sure if its an infinite loop but Flex does not like this.

My solution was to create two functions, one for the X close window to call and one for the Cancel button to dispatch a CloseEvent of its own. This seemed to work for me. Hope it helps you.

# hosting - 什么是网格托管

> ID：900737
> 
> 赞同：-1
> 
> 时间：2009-05-23T02:47:27.053
> 
> 标签：hosting, grid

我去了 GoDaddy.com 进行托管。他们有像 1) 网站托管 2) 网格托管这样的菜单

两者有什么区别。我是这个托管和网络应用程序的新手..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T02:54:01.393

网格托管通常意味着您租用的网络空间不在一台（可能共享的）机器上，而更像是托管在服务器集群（网格）上的“虚拟机”（想想 VMware）。

虽然单台机器上的资源是有限的并且可能会用完，特别是如果它是一个共享主机并且您必须与可能与您在同一台机器上托管的数百或数千名其他用户共享您的资源（内存、带宽），网格托管更加灵活，因为您的虚拟网站可以在必要时利用集群中更多机器的资源。这当然也增加了网站的可靠性，因为一个网格节点的故障无关紧要，另一台服务器接管，而您的专用或共享主机的故障会使您的网站离线。

我假设他们将单台机器称为“网站托管”。

*更新*

GoDaddy 有一个关于他们的网格托管的[常见问题解答](http://help.godaddy.com/topic/703/article/4883)，它应该回答您可能遇到的所有其他问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-24T11:30:29.337

来自 Godaddy 支持的回复：

> 请注意，站点服务器而不是数据库的计算周期是无限的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T02:54:15.323

来自维基百科： [网格计算](http://en.wikipedia.org/wiki/Grid_Computing) | [云计算](http://en.wikipedia.org/wiki/Cloud_Computing)。我没有将“网格托管”视为一个常用短语，但它可以理解为使用前两个概念之一以可扩展的方式托管网站。

但是，如果 godaddy 提供“网格托管”，我怀疑他们以与托管网站无关的方式向您提供网格计算。他们向您出售大量具有低通信要求的处理器能力，而不是向您出售通常具有高通信要求和低处理要求的网络托管（当然相对于彼此而言）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-07T10:38:51.127

[网格计算](http://en.wikipedia.org/wiki/Grid_hosting)是从多个位置到一个公共位置的计算资源的集合。网格也称为分布式系统。它类似于 VPS，但通常比[VPS 服务器](http://www.computehost.com/blog/cloud-hosting/cloud-vs-vps-hosting-make-a-smarter-choice-to-gain-business-agility)拥有更多的存储空间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-08T15:37:59.410

网格托管是分布式托管的一种形式，即服务器集群像网格一样由多个节点组成。

[目前，可以使用各种托管服务类型..您可以从这里](https://en.wikipedia.org/wiki/Web_hosting_service)找到它们的详细信息..

从以上这些中，您可以选择所需的托管服务提供商和类型。

# java - 用于字符串和整数参数的 Java compareTo

> ID：900745
> 
> 赞同：3
> 
> 时间：2009-05-23T02:54:17.180
> 
> 标签：java, compareto

我正在实现冒泡排序算法，我希望它能够同时接受`Integer`和`String`参数。我将所有输入转换为字符串，并使用该`compareTo`方法将转换为字符串的整数与字符串进行比较。`compareTo`用于比较强制转换的整数时，我得到的答案不正确。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T06:46:14.220

Integer.compareTo 对数字进行数字排序。这就是你想要的。

String.compareTo 按字典顺序对字符串进行排序；也就是说，按字母顺序。

我记得在 Windows 3.1 中，我的数码相机中的照片文件夹是这样排列的：PHOTO1、PHOTO10、PHOTO100、PHOTO2、PHOTO20、PHOTO3 等等。Windows XP 对它们的排序更符合您的预期：PHOTO1、PHOTO2、PHOTO3 等。这是因为它对表示数字的字符串有特殊的排序规则。

在字典顺序中，将一个字符串 A 中的每个字符与另一个字符串 B 中的对应字符进行比较。对于两个字符串中的每个对应字符：

*   如果 A 的当前字符按字典顺序小于（在字母表中位于之前）B 的字符，则 A 位于 B 之前。
*   如果 B 的字符小于 A 的字符，则 B 在 A 之前。
*   如果这两个字符相同，那么我们还不知道。下一个被检查。
*   如果其中一个字符串中没有更多字符，则较短的字符在较长的字符之前。
*   如果两个字符串中都没有字符了，那么它们就是同一个字符串。

这里的第四点是假设 Eddie 对您的问题的分析是正确的，为什么您会得到错误的答案。

考虑字符串“10”和“2”。字典顺序将分别查看每个字符的第一个字符，“1”和“2”。在 Java 使用的字符集中，字符 '1' 排在 '2' 之前，因此它将“10”排在“2”之前，就像“bare”排在“hare”之前一样，因为 'b' 排在 ' 之前H'。

我建议您在排序之前将字符串转换为整数。使用 Integer.parseString 来做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T04:37:47.883

您确定要将整数和字符串混合在同一个列表中吗？如果是这样，整数是小于还是大于字符串？这个特定的排序标准是什么？

您还可以创建一个冒泡排序方法，对不同的 Integer 列表和 String 列表（以及任何其他类的列表）进行排序。为此，您可以使用泛型。例如：

```
public static <T> void bubbleSort(List<T> elements, Comparator<T> comparator) {
    // your implementation
} 
```

您使用`comparator`参数来比较`elements`，这就是为什么它们可以是整数或字符串（不能同时是两者）。编译器不会让你[没有任何警告]传递一个类的对象列表和不同类的比较器，所以比较总是有效的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T02:59:57.980

举个例子`Comparable`。

字符串不能真正转换为整数，并且没有比较方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T03:01:27.977

你所描述的实际上是不可能的......所以也许你需要发布代码。这是我对你在做什么的解释：

```
public int compareTo(final Object o)
{
    final String str;

    str = (String)o; // this will crash if you pass it an Integer.

    // rest of the code.
} 
```

compareTo 的文档在[这里](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Comparable.html)，你真的应该遵守合同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T03:13:53.787

首先，您希望[Comparator](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Comparator.html) not [Comparable](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Comparable.html)因为 Comparator 需要两个对象，而 Comparable 将当前对象与传入的对象进行比较，并且您不能更改 String 或 Integer 上的 compareTo() 方法，因此：

```
public class CompareIntegersAsStrings implements Comparator {
  public int compare(Object o1, Object o2) {
    return o1.toString().compareTo(o2.toString());
  }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T03:14:37.293

假设您真正的意思是将整数转换为字符串，然后进行比较，这是行不通的。例如，假设您有 Integer`1234`和 Integer`1`和 Integer `2`。如果将这些转换为字符串并进行比较，您将得到顺序：

```
1
1234
2 
```

这对于 ASCII 排序是正确的，对于数字排序是不正确的。也就是说，我假设您的代码执行以下操作：

```
public int myCompare(Integer a1, Integer a2) {
    myCompare(String.valueOf(a1), String.valueOf(a2));
}

public int myCompare(String a1, String a2) {
    ....
} 
```

为什么我会假设这个？因为您在谈论获得不正确的结果而不是谈论获得异常。如果您实际上得到了例外，那么其他海报是正确的，铸造将不起作用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-16T08:59:04.660

这是因为`String`类中的以下 java API 代码仅比较两个字符串中字符的最小长度。

```
public int compareTo(String anotherString) {
    int len1 = value.length;
    int len2 = anotherString.value.length;
    int lim = Math.min(len1, len2); //**HERE**
    char v1[] = value;
    char v2[] = anotherString.value;

    int k = 0;
    while (k < lim) {
        char c1 = v1[k];
        char c2 = v2[k];
        if (c1 != c2) {
            return c1 - c2;
        }
        k++;
    }
    return len1 - len2;
} 
```

如果我们用这个api来比较

```
String first = "ABCD"; 
String second = "ABZ"; 
System.out.println("" + "ABCD".compareTo("ABZ")); //-23 
```

将返回负值，表示 ABCD 小于 ABZ 表示 C 小于 Z 并在第一个字符串中忽略 D。

所以也许我们需要像下面这样的东西

```
class StringNumericComparator implements Comparator<String> {
    @Override
    public int compare(String o1, String o2) {
        int len1 = o1.length();
        int len2 = o2.length();
        if(len1 != len2) {
            return len1 - len2; //Else iterate all diff lengh chars and SUM it.
        }
        int lim = Math.min(len1, len2);
        char v1[] = o1.toCharArray();
        char v2[] = o2.toCharArray();

        int k = 0;
        while (k < lim) {
            char c1 = v1[k];
            char c2 = v2[k];
            if (c1 != c2) {
                return c1 - c2;
            }
            k++;
        }
        return 0;
    }
} 
```

# iphone - 如何检查 NSSet 或 NSCountedSet 中的现有项目？

> ID：900749
> 
> 赞同：0
> 
> 时间：2009-05-23T02:59:34.750
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我目前正在将模型对象填充到 NSSet 中（也许我应该使用 NSCountedSet）。模型应该是唯一的。我所做的是将它们从 Web 服务中拉入，然后在客户端实例化它们并将它们添加到集合中。

我的问题如下：有时我只会拉一个模型并将其添加到集合中，例如说我有法拉利的库存。因此，我会要求我的服务器将我拉入一辆特定的法拉利，因为个人点击了库存中该法拉利的详细视图。单独的法拉利细节视图将列出该车型可用的所有不同油漆。因此，一旦用户深入了解此 Ferrari 视图，我将向服务器询问适用于特定 Ferrari 模型的所有油漆。

接下来，用户退出，然后转到视图控制器，该控制器询问我为每辆车提供的所有油漆颜色。我已经收藏了法拉利油漆。现在我要从服务器上获取所有的油漆。在不重复资源的情况下，将现有涂料与所有涂料聚合的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T04:19:13.833

您需要一种从服务器中唯一标识每个对象的方法。在数据库中，一个对象（部分或全部）可以表示为一行，而 rowid 通常是一个单调递增的整数（尽管您的数据源可以使用其他东西）。在任何情况下，将此唯一 ID 存储在您创建的每个对象中，并在创建新对象之前检查是否存在具有该 ID 的对象。如果对象已经存在，则返回现有对象，如果不存在，则创建一个新对象，然后将其存储在缓存中。使用整数作为 id 效果很好，因为您可以使用 NSMapTable 作为缓存，其中 rowid 作为键，值是对象指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T05:06:38.613

在您的应用程序中维护一个基于您的功能的一些[哈希函数](http://en.wikipedia.org/wiki/Hash_function)`NSArray*`存储`NSString*`对象的应用程序：

```
hashValue = hash(color + horsepower + leatherSeating + whatever...) 
```

例如，您可能会采用`SHA1`整理字符串的哈希值（[示例代码](http://hollowout.blogspot.com/2009/01/recovering-cisco-ipsec-vpn-group.html)）。

获取从 Web 服务获得的特征，并使用相同的函数从它们中生成散列值。

使用 . 在应用程序的哈希表中搜索 web-service-value [`-containsObject:`](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSArray_Class/Reference/Reference.html#//apple_ref/doc/uid/20000137-BABCEJDI)。

如果它返回`YES`，则执行*X*，否则执行*Y。*

# c++ - 考虑不周的非标准 C++ 库中有哪些好的部分？

> ID：900754
> 
> 赞同：2
> 
> 时间：2009-05-23T03:02:27.677
> 
> 标签：c++, c, standards-compliance

在尝试跟上 C++ 的速度（来自 C 的长期经验）时，我显然在尝试做正确的事情，并尽可能多地使用标准。

然而，在我对此事的阅读中，我遇到了很多对标准事物的批评和对非标准事物的赞扬。例如，即使（我认为）考虑不周的 MFC 库也有一些功能，例如，它的`CString`类中一些人认为它足够有用，可以使他们继续使用它，尽管它是（a）非标准的并且（b）它（我假设，从大量的批评中）在许多重要方面都有缺陷。

我的问题是双重的，那么：

A. 哪些库是考虑不周的，包含的特性仍然值得继续使用，这些特性是什么，它们有什么好处？

B. 是否有“适配器”库可以简化和/或加强此类库的使用，例如提供抽象资源泄漏的良好接口、从非 STL 库接口到 STL 的适配器等等

作为 StackOverflow 的相对新手，我不能 100% 确定这个问题是否足够准确，所以如果它过于开放，我会提前道歉。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T03:24:14.390

IMO 关于 MFC 最好的一点是，从历史上看，它在 STL 可用之前就已经可用，有总比没有好。

如果您正在编写与现有 MFC 代码库兼容的代码，MFC 仍然很好。

除此之外，MFC 几乎没有什么优点，只是它可能仍然是（如果不是最明显的）Windows 的 C++ 类库之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T05:12:05.457

我个人的 grunge 是[ACE](http://www.cs.wustl.edu/~schmidt/ACE.html)。有点相反——好主意，当时没有其他东西可用于 C++ 中的跨平台线程和网络开发、广泛部署、图书馆作者的书籍等。但是实现很糟糕，使用模式复杂，几乎所有 C++ 有用的特性都被压制了（或者当时不存在）。我认为仅这个库就导致很多人认为 C++ 既难看又难看。最近[提升](http://www.boost.org)collection 开始赶上线程、ipc 和网络，所以至少有一个替代方案。但话虽如此，我仍然认为如果你在那个领域熟悉 ACE 是值得的，因为太多人使用它，想法很好，它可以作为图书馆设计的一个很好的反面例子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T09:25:37.460

更笼统地说，我认为人们坚持使用旧的、笨拙的甚至可能是过时的库的原因之一是他们已经习惯了它，任何新的和闪亮的东西可能会做得更好，但最初更难掌握/理解。因此，您可以使用熟悉的内容并保持生产力。

我认为这是完成工作和“正确”完成工作之间的平衡。介于两者之间的某个地方可能是我们大多数人最终的结局。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T03:20:33.757

我认为 CString 是非标准的，因为 MFC 不是跨平台的。std::string() 是标准的，但如果我们使用一切标准，那么为什么 MS 开发 MFC？

# macos - 持久仪表板小部件首选项

> ID：900758
> 
> 赞同：0
> 
> 时间：2009-05-23T03:05:39.373
> 
> 标签：macos, widget, osx-leopard, dashboard

我正在构建一个仪表板小部件，并且我正在尝试存储在“会话”中持续存在的首选项（即，用户关闭小部件并再次打开它）。

我试过了：

```
function setEmail(event)
{
var preferenceKey = "email";
var preferenceValue = $F("email");
widget.setPreferenceForKey(preferenceValue, preferenceKey);
}

function getEmail() {
var preferenceForKey = "email";
preferenceForKey = widget.preferenceForKey(preferenceForKey);
return preferenceForKey;
} 
```

这适用于当前会话，但如果小部件关闭并再次打开，数据将丢失。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T22:36:21.267

This seems to do the trick:

```
// Values you provide
var preferenceKey = "key";      // replace with the key for a preference
var preferenceValue = "value";  // replace with a preference to save

// Preference code
widget.setPreferenceForKey(preferenceValue, preferenceKey); 
```

# apache - 如何保护公共和私有 Rails 应用程序的管理区域

> ID：900763
> 
> 赞同：3
> 
> 时间：2009-05-23T03:09:25.433
> 
> 标签：apache, ssl, ssh, admin, security

您将如何保护对 Web 应用程序管理区域的访问？

我们的 Rails CMS 公开提供页面。我想使用 webserver(apache) 或防火墙(netfilter) 使后端 (/admin) 无法访问。

这可以使用 SSL 证书来完成吗？我想将对后端的访问限制为只有那些拥有“密钥”的人，类似于对服务器的 SSH 访问。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T08:59:12.707

您绝对正确，SSL 证书是要走的路。设置起来并不是那么棘手，尽管很少这样做。

重要的是要记住这个问题有两个组成部分。第一个是，“我如何让这该死的东西完全正常工作”，这是一个安全系统，第二个是，“我如何设置它，这样我就不会意外地做一些让我感到厌烦的事情安全？”

我建议的第一件事是为管理内容编写一个单独的 Rails 应用程序，并在不同端口上使用不同的 Web 服务器运行它。（如果您真的想避免在管理站点的 URL 中放置端口号，请在两个 Web 服务器前面使用代理，该代理使用`Host:`标头将请求重定向`foo.com`到一个服务器，然后重定向到另一个服务器`admin.foo.com`。）这种分离将帮助确保您不会意外地让普通用户访问管理功能，并使 SSL 设置更容易。

对于管理服务器，将其设置为仅用于 SSL 访问。创建一个新的签名证书，并只允许由该签名证书签名的证书连接。（这取决于网络服务器；如果您确实需要有关如何执行此操作的详细信息，您可能需要发布一个新问题，说明您正在使用的服务器和配置的详细信息。）您可以设置一个页面（在非 SSL 站点，或 SSL 站点上未经身份验证的用户可访问的页面），这将使您的管理员的 Web 浏览器自动生成并上传您可以签署的证书，该证书将授予他们访问权限。

保留您签署的所有证书的副本，以便在您需要撤销访问权限时，可以将该证书放入撤销列表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T03:29:26.937

不要使用防火墙，你只会使你的实现复杂化。“正确”的方法是使用 .htaccess 或在 Apache Directory 配置中设置授权。

听起来你想要 SSLRequire

```
SSLVerifyClient      none
<Directory /usr/local/apache/htdocs/secure/area>
SSLVerifyClient      require
SSLVerifyDepth       5
SSLCACertificateFile conf/ssl.crt/ca.crt
SSLCACertificatePath conf/ssl.crt
SSLOptions           +FakeBasicAuth
SSLRequireSSL
AuthName             "Snake Oil Authentication"
AuthType             Basic
AuthUserFile         /usr/local/apache/conf/httpd.passwd
require              valid-user
</Directory> 
```

操作方法：http : [//eregie.premier-ministre.gouv.fr/manual/mod/mod_ssl/ssl_howto.html](http://eregie.premier-ministre.gouv.fr/manual/mod/mod_ssl/ssl_howto.html)

# ruby-on-rails - 将 Rails 与 Paperclip 和 SWFUpload 一起使用

> ID：900769
> 
> 赞同：6
> 
> 时间：2009-05-23T03:13:57.827
> 
> 标签：ruby-on-rails, ruby, paperclip, swfupload

我有一个使用回形针处理照片字段的用户模型的基本 Rails 应用程序测试。我创建了能够创建/编辑用户的视图，并且照片上传运行良好。

```
<h1>Editing user</h1>

<% form_for :user, @user, :url => user_path(@user), :html => { :method => "put", :multipart => true } do |f| %>
  <%= f.error_messages %>

  <p>
    <%= f.label :first_name %><br />
    <%= f.text_field :first_name %>
  </p>
  <p>
    <%= f.label :last_name %><br />
    <%= f.text_field :last_name %>
  </p>
  <p>
    <%= f.label :file %><br />
    <%= f.file_field :file %>
  </p>

  <p>
    <%= f.label :photo %><br />
    <%= f.file_field :photo %>
  <p>
    <%= f.submit 'Update' %>
  </p>

<% end %>

<%= link_to 'Show', @user %> |
<%= link_to 'Back', users_path %> 
```

然后，我想将 SWFUpload 集成到我的应用程序中。我尝试按照本[教程](http://jimneath.org/2008/05/15/swfupload-paperclip-and-ruby-on-rails/)运行[测试项目](http://jimneath.org/wp-content/uploads/2008/05/swfupload1.zip)，但没有成功：浏览按钮没有打开文件对话框，并且抛出了关于 selectFiles() 方法的错误 #2176。

首先，问题在于 Flash v.10 与项目中包含的旧版本 SWFUpload (2.1.0) 不兼容：现在不推荐使用 selectFiles()。所以我尝试升级到 SWFUpload v. 2.2.0，它现在使用 button_placeholder_id 设置，但我无法获得任何示例。

所以我对如何使用 SWFUpload 初始化以及在我的表单中使用它有点迷茫，这样我就可以上传和保存照片。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-23T21:39:50.187

这是一篇[不错的文章](http://thewebfellas.com/blog/2008/12/22/flash-uploaders-rails-cookie-based-sessions-and-csrf-rack-middleware-to-the-rescue)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-24T10:01:47.520

为了将照片文件字段 id 传递给 SWFUpload，您的字段的 id 将是 user_photo（来自 <input type='file' id='user_photo'.../>），所以初始化 swfupload

```
var swfupload = new SWFUpload({button_placeholder_id:'user_photo' ... }); 
```

它将用 swf 上传器替换文件字段。

请记住，默认情况下，文件将作为“Filedata”参数上传。从技术上讲，您可以将其更改为“用户 [照片]”，但显然这在 Linux 上不起作用，因此您可能需要在服务器端进行一些调整才能将其移动到正确的位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-21T15:06:04.243

您可以尝试使用[easy-swf-upload 插件](http://github.com/over/easy_swf_upload)

您只需要插入一个助手并可能采用 css

# asp.net - 在 ASP.NET 中创建可扩展报告的最佳 UI 控件？

> ID：900774
> 
> 赞同：0
> 
> 时间：2009-05-23T03:19:44.757
> 
> 标签：asp.net, sql-server, reporting

我有一个充满培训课程进度的 SQL Server 表。我想做一个报告。该报告将是一个用户列表，其中每一行显示他们的姓名、完成状态和百分比。他们将能够扩展每一行以显示子行，这些子行详细说明了逐节详细的统计信息。在 ASP.NET 中与我的 SQL 数据配对以以易于阅读的方式显示它的最佳 UI 控件是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T10:27:24.183

Dave Ward 有一篇关于创建简单数据转发器 ASP.net 页面方法和 jQuery 以表格格式显示数据的非常有趣[的帖子。](http://encosia.com/2008/06/26/use-jquery-and-aspnet-ajax-to-build-a-client-side-repeater/)本质上，您将使用页面方法将数据发送到客户端，并使用微模板将其格式化为一个简单的表格。

作为一种替代方法，您可以使用 ASP.Net 数据转发器将数据格式化为 html 表，并使用[jQuery 插件](http://www.datatables.net/usage)在客户端添加分页功能。您可能要小心这种方法，因为对于大量数据，您的 html 可能会变得非常大，并且分页对于确保快速的用户体验可能变得很重要。

这会照顾你在客户端的桌子。要添加扩展行以显示详细信息的功能，您可以将该信息包装在 div 标记中并附加单击事件以显示或隐藏内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T03:28:03.243

听起来像是一个 ASP.NET GridView/ListView 组合来创建一个分组网格。查看此博客文章了解更多信息： http: [//mattberseth.com/blog/2008/01/building_a_grouping_grid_with.html](http://mattberseth.com/blog/2008/01/building_a_grouping_grid_with.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T07:44:16.010

为了类似的目的，我们一直在使用[Telerik](http://www.telerik.com/)网格控件。他们工作得非常好。

# design-patterns - 如果我有有限的时间学习一些设计模式，我应该学习哪些？

> ID：900780
> 
> 赞同：12
> 
> 时间：2009-05-23T03:26:44.790
> 
> 标签：design-patterns, oop

如果我的时间有限，但我想开始学习一些设计模式，我应该先学习哪些？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-23T03:35:14.133

我建议反转控制/依赖注入。这在单元测试时非常方便，因为它使您能够为被测类提供模拟依赖项。在包装密封类以使其在测试场景中更有用时，代理也非常有用。

如果我提出另一个建议，我会专注于学习哪些模式在不同情况下有用，而不是专注于学习如何实现特定模式。在实现模式时，您几乎总能找到要使用的参考实现，但能够辨别何时以及使用哪种模式将使模式更有用。如果你以另一种方式开始，你最终会让你的问题适合你知道的模式，而不是应用适合问题的正确模式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-23T03:34:48.003

为什么不阅读它们的[摘要，例如此摘要](http://en.wikipedia.org/wiki/Design_pattern_(computer_science)#Classification_and_list)，看看它们是否对*您*有用，是否值得进一步研究。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-23T03:41:08.487

设计模式不是您快速开始阅读和学习的主题。您将不得不做许多练习，然后将您学到的知识应用到实际场景中。如果你的时间真的那么有限，那么你可能是在浪费你的时间。我推荐这本书[Head First Design Patterns](https://rads.stackoverflow.com/amzn/click/com/0596007124)，非常棒。

但是您对OO的了解应该是一个相当高的标准。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-23T04:08:49.153

你的问题就像是在问，“我想学习 C#，但只有时间学习几个关键字。我应该学习哪些？”

任何一种设计模式都不是生活在真空中的。它们都定义了应用程序如何组合在一起的不同方面。任何一个应用程序都不太可能需要所有已知的设计模式，但每个应用程序都是不同的，您需要为每个应用程序使用不同的组合。知道不使用什么与知道使用什么一样重要。您至少需要所有主要设计模式的对话知识。

从[这个列表](http://sourcemaking.com/design_patterns)和前面提到的[Head First Design Patterns书开始。](https://rads.stackoverflow.com/amzn/click/com/0596007124)了解所有这些。不要因为没有时间而感到痛心——抓紧时间！多住几个晚上离开 Facebook 或跳过一两次星际迷航重播。

此外，除非您是真正的 OO 专家，否则首先要避免[阅读 GoF 模式书。](https://rads.stackoverflow.com/amzn/click/com/0201633612)它非常密集，并立即假设您了解模式的价值和需求。这是一本很棒的书，只是不是一本很棒的第一本书。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-23T03:33:43.823

我认为设计模式的有用性更多地在于伴随它们的附加词汇，而不是使用单个（或几个）模式。在尝试与其他开发人员交流时，了解四人帮中的常见模式非常有用。

我建议阅读目录，然后阅读模式目录的摘要。如果您的时间有限，大致了解这些模式的象征意义将是有益的，这样当您需要了解模式的细节时，您就会知道去哪里寻找。这与了解他们自己的小岛上的状态或单例模式相反。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-23T03:35:59.923

**抽象工厂**。用于依赖注入 (DI)。
如果你理解了这一点，你就会知道 DI 的基本工作原理，然后你就会知道什么是控制反转。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-23T03:50:39.640

“命令”模式比抽象工厂稍微复杂一点，但是很常用，而且功能强大。

我从未真正有机会使用的另一种模式是“复合”模式。这将使您很好地接触 OO 技术，并且如果您遇到需要它可能会证明是有用的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-23T05:45:47.237

我认为“享元”是一种非常酷的模式，与其他任何东西都没有任何关系。（即，你永远不会决定在它的位置使用另一种模式。）

但是，如果您只想学习一种模式，那么“Visitor”就是您想要的模式。这是一个远远超出 OO 编程的概念。它将帮助您理解函数式编程概念，例如`map`和`fold`。甚至是 OO 方法，例如`collect`和`inject`.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-24T04:23:18.953

**策略**在我的候选名单上。这是摆脱代码中仅支持多种做事方式的条件逻辑的好方法，它有助于提取“策略”代码，以便可以单独对其进行测试。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-08T11:42:34.383

GoF（四人组）一书推荐这些作为开始：（在书中的“读者指南”中）

> 从最简单和最常见的模式开始：
> 
> 1.  抽象工厂
> 2.  适配器
> 3.  合成的
> 4.  装饰器
> 5.  工厂方法
> 6.  观察者
> 7.  战略
> 8.  模板法

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-09T01:55:37.250

我个人一直觉得你没有“学习”设计模式……你学会了“识别”它们。换句话说，当我第一次阅读设计模式时，它们中的许多似乎只是在我之前创建的应用程序中自然而然地出现了解决方案，但也许我没有完全一样或干净地做到这一点。

在我看来，设计模式更多的是关于标准化一次又一次实现的解决方案，而不是教你如何解决特定问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-23T03:28:50.713

[Singleton](http://en.wikipedia.org/wiki/Singleton_pattern)在很多地方被大量使用。[适配器](http://en.wikipedia.org/wiki/Adapter_pattern)模式也很常用。这两个是最常用的，并且相对简单；理解它们有助于理解模式，并且对你的开发很有用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-09T01:59:25.150

扔掉你的拐杖。[学习函数式编程](http://www.defmacro.org/ramblings/fp.html)。

# visual-studio-2008 - 如何为 ankhsvn 创建提交评论模板？

> ID：900786
> 
> 赞同：2
> 
> 时间：2009-05-23T03:29:39.480
> 
> 标签：visual-studio-2008, svn, version-control, ankhsvn

我在 Visual Studio 2008 中使用 AnkhSVN。我正在寻找一种方法来为每个提交评论设置默认模板。有没有办法配置这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T22:00:31.463

这里唯一真正的答案是：不，AnkhSvn 不支持这样做。此类模板的问题之一是挂起的更改窗口可以一直打开。使用 tsvn:logtemplate 的内容填充提交框必须通过上下文菜单/工具栏单击来完成。

你能在[我们的用户语音页面](http://ankhsvn.uservoice.com)添加一个请求吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-23T03:49:42.527

您可以尝试将模板设置为工作副本根文件夹（例如解决方案文件夹）的 tsvn:logtemplate 属性，并查看 AnkhSVN 是否识别它。

如果没有，也许可以考虑使用 VisualSVN 作为替代方案。在评估 AhkhSVN 之后，我们决定改用 Visual SVN，它是一个 VS 插件和免费 TortoiseSVN 的前端。好处是您可以获得 TortoiseSVN 的所有功能，包括所有自定义 tsvn: 属性。缺点是它不是免费的（49 美元）。

# javascript - Javascript嵌套问题中的正则表达式匹配

> ID：900788
> 
> 赞同：2
> 
> 时间：2009-05-23T03:32:37.383
> 
> 标签：javascript

首先，请原谅我的 hacky 代码，我只是想尝试一下，而且我是第一次学习 javascript。基本上，给定字符串 "abc!random{3}" 意味着返回一个以 "abc" 开头并以 0-3 的随机数结尾的字符串。

这是我所拥有的：

```
var pattern=/!random{([^{]*?)}/gi;
var text="abc!random{3}def!random{4}ghi!random{!random{3}}";

while (pattern.test(text))
{
    text=text.replace(pattern, Math.random() * parseInt("$1")); 
} 
```

问题是 parseInt 函数。似乎 $1 没有传递给它..它的价值被清除或其他东西。如果我做：

```
text=text.replace(pattern, "$1"); 
```

它正确返回了 {} 之间的内容，因此正则表达式正在工作并且匹配存储在 $1 中。但是，一旦我将它用作 $1 的参数，它的值似乎就被清除了。是什么赋予了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T07:32:15.737

要替换的第二个参数可以是替换整个匹配项的字符串，其中，如果存在，所有出现的 $1、$2 等都将替换为捕获，或者它可以是一个接受两个参数的函数（匹配项和捕获）并返回捕获的替换字符串：

```
var pattern=/!random{([^{]*?)}/gi;
var text="abc!random{3}def!random{4}ghi!random{!random{3}}";

text=text.replace(pattern,
    function(match,capture)
    {
        return Math.random() * parseInt(capture)
    });
WScript.echo(text); 
```

Notice that the while loop is unnecessary: the regular expression already has the global flag set ("g"), which says to process the regex globally.

Also note that the function actually receives multiple (m) arguments: 1=the matched string, 2..m=the captures from left to right, m+2=the offset within the string where the match occured, and m+3=the entire string being matched. JavaScript allows the right-most arguments (of any function) to be omitted, which is why the example has only two.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T03:51:03.540

该`replace`方法正在对其传递的值进行操作。也就是说，如果它得到一个包含 $0、$1 等的字符串，那么它将用正确的匹配项替换它。但是，您编写的内容首先将字符串解析`"$1"`为整数，将其乘以随机数，然后将其作为替换传递。所以它几乎肯定会通过它`NaN`（由于无法解析`"$1"`），这不是你想要的。

所以，而不是

```
text = text.replace(pattern, Math.random() * parseInt("$1")); 
```

我会尝试

```
var matches = text.match(pattern);
text = text.replace(pattern, Math.random() * parseInt(matches[1])); 
```

# iphone - 为什么在 Default.png 期间仍然显示状态栏？

> ID：900795
> 
> 赞同：10
> 
> 时间：2009-05-23T03:35:44.743
> 
> 标签：iphone, delegates, statusbar

我很确定我已采取所有步骤将状态栏正确设置为隐藏。我在 info.plist 文件（将 UIStatusBarHidden 设置为布尔值 TRUE）以及 Application Delegate 中的 applicationDidFinishLaunching 方法中都这样做了：

```
[[UIApplication sharedApplication] setStatusBarHidden:YES animated:NO]; 
```

状态栏确实隐藏了——只是不够快。尽管采取了上述步骤，但在启动应用程序时，在显示**Default.png**默认图像期间，状态栏仍会**显示大约一秒钟。**这看起来很俗气，我想确保在应用程序运行期间的任何时候都不会显示状态栏。

 **我尝试过的许多应用程序都**成功隐藏了状态栏**（在 default.png 显示期间甚至不显示），但我不知道如何。以前有人处理过这个问题吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-29T18:07:37.813

你已经想通了吗？我所做的就是在 TextMate 中而不是在 Xcode 中编辑 Info.plist 文件。我添加了以下两行：

```
<key>UIStatusBarHidden</key>
<真/>

```

我认为与上面给出的答案唯一不同的是我使用了文本编辑器而不是 Xcode。当您随后在 Xcode 中查看 Info.plist 时，您会在 UIStatusBarHidden 旁边看到一个复选标记，而不是一个字符串。可能有一种方法可以直接在 Xcode 中执行此操作，但我不知道它是什么。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-23T04:25:59.217

UIStatusBarHidden 应设置为 true。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-02-20T00:15:30.597

在 info.plist 中还有一个名为“状态栏最初隐藏”的键需要检查。它会在加载 default.png 时隐藏状态栏

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-11-25T08:23:38.800

这比那更容易。至少在 Xcode 4 中，您可以简单地将条目“状态栏最初隐藏”添加到 plist 并将其值设置为 YES。

![plist中的状态栏条目](https://i.stack.imgur.com/quPC8.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-26T15:18:57.003

我在使用 IOS 2.1 和旧版 Cydia 的越狱设备上看到了这一点。在那种情况下，一旦 Cydia 更新， info.plist + ...statusBarHidden = YES 方法就起作用了。

或者看看是否有`[application setStatusBarStyle: ...]`帮助。

-isdi-

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-19T17:30:16.257

我在 iPod Touch 2G (3.1.3) 上看到了类似的问题，其中一个黑色矩形 - 与状态栏的尺寸相同 - 显示在 default.png 上方。

此问题的解决方案涉及将 default.png 图像设置为 320x480，而不是原来的 640x960。确切的解决方案是使用较大的尺寸制作 default@2x.png。

# svn - 易于设置的 Mac SVN 服务器？

> ID：900804
> 
> 赞同：4
> 
> 时间：2009-05-23T03:46:33.183
> 
> 标签：svn, macos, svn-server

我已经尝试过用于 PC 的 VisualSVN 服务器，它似乎很容易安装和使用。唯一的问题是我的带有 Vista 的 PC 确实会崩溃，或者有时会变得不那么响应，所以我正在考虑在 Mac 上使用 SVN 服务器。

Mac上是否有一个易于安装且也可靠的软件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T05:36:13.100

[macsvnserver](http://macsvnserver.sourceforge.net)声称是 Mac OS X 的可拖放安装的 Subversion 服务器。或者，您可以使用远程 Subversion 托管服务，如[Beanstalk](http://beanstalkapp.com)或[Unfuddle](http://unfuddle.com)来托管您的存储库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T18:10:25.930

如果你使用的是 OS X 10.5 Server，你真的应该考虑使用 macports SVN。Macports 是单次安装，SVN 端口自动与系统 apache 2.0 集成，包括对 OpenDirectory 的身份验证。

# javascript - 有没有办法从网页中的已知值计算 XPath？

> ID：900808
> 
> 赞同：0
> 
> 时间：2009-05-23T03:51:58.690
> 
> 标签：javascript, xpath

据我了解，XPath 是一种在 XML 文档中导航元素的方法。
方向是 XPath -> 元素。
你怎么反其道而行之？也就是说，根据已知元素值计算 XPath？

例如，您如何在 stackoverflow 标头中找到“faq”链接的 xpath？
语言并不那么重要，我对有助于我计算 XPath 的算法和/或库/技术更感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T07:40:24.363

这是一个简单的JS函数来做到这一点。它仅使用 previousSibling、nodeType 和 parentNode，因此它应该可以移植到其他语言。但是，结果是不可读的（对于人类来说），并且在面对页面更改时它不会特别健壮。

以我的经验，如果是手写的话，XPath 会更有用。但是，您当然可以创建一个算法来生成更漂亮（如果可能更慢）的结果。

```
function getXPath(node)
{
    if(node == document)
    return "/";
    var xpath = "";
    while (node != null && node.nodeType != Node.DOCUMENT_NODE)
    {
    print(node.nodeType);
    var pos = 1, prev;
    while ((prev = node.previousSibling) != null)
    {
        node = prev
        pos++;
    }
    xpath = "/node()[" + pos + "]" + xpath;
    node = node.parentNode;
    }
    return xpath;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T03:59:35.397

由于XPath 可以选择第n 个子元素（即/parentelement/child_element[2]），如果您可以找出元素在树中的位置，那么您应该能够生成返回给它的XPath。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T04:01:14.600

您没有指定使这个问题难以回答的语言。python lxml模块可以做到

```
>>> a  = etree.Element("a")
>>> b  = etree.SubElement(a, "b")
>>> c  = etree.SubElement(a, "c")
>>> d1 = etree.SubElement(c, "d")
>>> d2 = etree.SubElement(c, "d")

>>> tree = etree.ElementTree(c)
>>> print(tree.getpath(d2))
/c/d[2]
>>> tree.xpath(tree.getpath(d2)) == [d2]
True 
```

即使您不使用 python，您也可以在模块源代码中找到您需要的内容

# java - 如何恢复 Hibernate 中的瞬态字段，如 readResolve() 以进行休眠序列化？

> ID：900814
> 
> 赞同：2
> 
> 时间：2009-05-23T03:58:58.267
> 
> 标签：java, hibernate, serialization, orm

当对象从 Hibernate 反序列化时，有没有办法连接要调用的回调方法。类似于 Java 对象序列化的 Java 的[readResolve()](http://java.sun.com/javase/6/docs/platform/serialization/spec/input.html#5903)方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T07:57:59.180

[您可以使用自定义UserType](https://www.hibernate.org/hib_docs/v3/api/org/hibernate/usertype/UserType.html)映射该类。这使您可以完全控制序列化和反序列化。

# javascript - 以编程方式在 jQuery 选项卡中重新加载 ajax 内容

> ID：900821
> 
> 赞同：0
> 
> 时间：2009-05-23T04:02:11.573
> 
> 标签：javascript, jquery, jquery-ui

我对编程很陌生，所以请原谅我的菜鸟。我正在为我的应用程序使用出色的 jQuery 选项卡，我通过 ajax 将外部内容加载到选项卡中，并且在其中一个选项卡中，我需要在结果后以编程方式重新加载该选项卡的内容。我按照文档*无济于事。

我已经非常简单地初始化了我的根页面中的选项卡：

Javascript：

```
 $(document).ready(function(){
    $("#tabs").tabs({ cookie: { expires: 30 } });    
  }); 
```

的HTML：

```
<div id="tabs">
<ul>
     <li><a href="#moderatorManage"><span>Find and Manage Moderators</span></a></li>
     <li><a href="flaggedCards/" id="flaggedCards" ><span>Flagged Cards</span></a></li>
     <li><a href="pendingDelete/"><span>SinBin / Pending Delete</span></a></li>
</ul>
</div> 
```

您可以看到我加载了“flaggedCards/”的外部 URL 在那里我有更多带有此功能的 jQuery：

```
 $(document).ready(function(){
        $("#controls_{{id}} input").click(function() {

                $(this).parent().parent().parent().addClass("highlight").fadeTo("slow", 0.1);
                $("#tabs").tabs( 'load' , 0 ); // fails also tried various selectors

        });
 }); 
```

我正在尝试做的是在调用该函数时调用 flaggedCards 选项卡以重新加载，我尝试了各种不同的语法均无济于事。

*   docs.jquery.com/UI/API/1.7.1/Tabs#method-load

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T08:04:21.320

我能够复制您在帖子中报告的完全相同的问题。这就是我最终解决它的方式。

在托管选项卡的根页面中，添加此功能：

```
function selectTab(index){
 $("#tabs").tabs('load', index);
} 
```

然后在您的外部 URL 页面“flaggedCards/”中，替换以下行：

```
$("#tabs").tabs( 'load' , 0 ); 
```

有了这个：

```
selectTab(0); 
```

我不知道为什么这种解决方法会奏效。也许这是一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T08:02:57.173

我应该提到它正在运行它加载的 html 中的脚本，请参阅运行良好的 addclass 函数，但是在运行之后它不会使用我输入的代码重新加载选项卡。不过，我会尝试添加该数据类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T06:37:43.720

要执行脚本，您必须确保 ajax 请求的数据类型是“html” - 请参阅[$.ajax options](http://docs.jquery.com/Ajax/jQuery.ajax#options)。为此，请在设置选项卡时尝试选项卡[ajaxOptions](http://docs.jquery.com/UI/API/1.7.1/Tabs#option-ajaxOptions)选项。

```
$("#tabs").tabs({ cookie: { expires: 30 }, ajaxOptions: {dataType: "html"} }); 
```

另一个问题可能是`$(document).ready(function(){`通过 ajax 加载选项卡内容时可能没有触发。尝试删除它和相应的`}`. 当它通过 ajax 加载您的内容时，希望它在评估脚本之前将其插入到文档中。

我没主意了。希望有帮助:-)

# visual-studio-2008 - 在 VS 2008 中使用 SVN 的问题

> ID：900824
> 
> 赞同：3
> 
> 时间：2009-05-23T04:07:13.320
> 
> 标签：visual-studio-2008, svn

我一直在阅读有关 SVN 如何与 Visual Studio 配合使用的信息。我正在使用 VS 2008 并担心将 SVN 与 VS 2008 一起使用可能会出现问题。

任何人都可以分享他们使用 SVN + VS 2008 的经验吗？

多谢！

注意：我意识到将 GIT 混入其中有点淡化了我想问的真正问题。所以，我把问题限制在 SVN + VS 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T04:30:57.250

您将需要一个插件来将 Visual Studio 2008 与 svn 接口。 [Ankh](http://ankhsvn.open.collab.net/)似乎很受欢迎，我听说过[Visual SVN](http://www.visualsvn.com/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T04:35:07.297

就个人而言，我对 IDE 集成并不太兴奋。我在资源管理器中使用 TortoiseSVN，IMO 也可以正常工作，而不会增加 VS 的权重。AnkhSVN、Visual SVN 和 SlickEdit 版本控制工具箱属于集成工具。

但据我了解（仅来自对话），Git != SVN ...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-21T03:37:58.113

[Agent SVN是与](http://zeusedit.com/agent/)*Visual Studio*配合使用的MS-SCCI 插件，因为它是 MS-SCCI，所以它直接与*Visual Studio*本身中的源代码控制菜单集成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T04:36:51.287

我在 VS 2008 中使用了带有和不带有 IDE 插件的 SVN，并且没有发现任何问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T05:51:46.947

TortoiseSVN 非常好，但如果您使用的是 VS 2008，VisualSVN 非常棒。Git 对于 VS 开发人员（或通常在 Windows 上运行）来说是可怕的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-23T07:37:51.920

当您的 IDE 支持包括重命名文件的重构操作时，良好的 IDE-VC 集成是最重要的。在没有 Subversion 集成的情况下使用 Eclipse JDT 会非常低效，因为重命名的类会在“svn update”之后重新出现，除非 Eclipse 通知 Subversion 该文件已被删除。

如果您没有进行任何此类“文件系统更改”重构，那么 IDE 中的 VC 集成并不是非常重要，您可以使用 TortoiseSVN。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-28T15:44:14.110

SVN + VS2008 有多种选择。

1) 使用 TortoiseSVN，不与 VS2008 集成。这是我大部分时间使用的，没有问题。（如果您不介意偶尔离开 IDE）

2) 使用 TortoiseSVN 并通过将自定义工具栏按钮映射到 TortoiseSVN 自动化命令，自行将其与 VS2008 集成。[看到这个博客](http://blog.vorpal.cc/category/development/tortoisesvn-in-visual-studio.html)

3）使用VisualSVN（这些家伙为您将TortoiseSVN完全集成到VS2008中！）

4) 使用 AnknSVN（免费和开源，但不是基于 TortoiseSVN）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-23T05:28:03.097

由于 svn 和 git 的不同范式，您将看到比通过与 Visual Studio 集成相关的任何内容所看到的更大的差异。

解释这些差异是一项工作，任何一个都会以各种方式让你的生活更快乐，所以我不会担心你使用哪一个。无论如何，如果您决定走那条路，您以后总是可以更改，并且在您使用两者之前，您不会真正理解差异。

# wpf - 如何在 XAML 中注入转换器

> ID：900825
> 
> 赞同：8
> 
> 时间：2009-05-23T04:07:24.973
> 
> 标签：wpf, xaml, dependency-injection

我有一个 IValueConverter 实现类，我需要使用我的 DI 容器（Ninject）注入它。

问题是，在 XAML 中，没有直接明显的方法来控制 Converter 对象的实例化。

所以我的 XAML 包含这样的一行：

> Source="{绑定路径=CurrentMessage, 转换器={StaticResource ImagePathConverter}}"

在哪里，将为我创建*ImagePathConverter 。*

我想我可以创建一个“服务定位器”静态类并调用它来解决我的依赖关系并将 StaticResource 更改为属性“MyServiceLocator.TheImageConverter”，但这让我想呕吐。

我希望这个问题可以用一些专门针对所提供代码的代码片段来回答——也许还有一个示例的支持链接。不仅仅是建议去某个地方看看。

此外，非常重要的是，假设 XAML**没有代码隐藏**- 而且我不能使用它。我正在创建一个*皮肤*，不希望后面有代码。所以我不能在类构造函数中设置类变量并引用它。也许这是不合理的，我还不确定。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-23T07:10:59.510

处理此问题的常用方法是让您的转换器也成为`MarkupExtension`. 那是：

```
public class MyConverter : MarkupExtension, IValueConverter 
```

您的`ProvideValue()`方法可以返回转换器的实例，从而允许您像这样使用它：

```
Source="{Binding CurrentMessage, Converter={local:MyConverter SomeParameterToConverter}}" 
```

这实际上与 DI 没有任何关系，但它确实满足了您消除背后代码的要求。我真的看不出将转换器注册到您的 DI 容器中的意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-12T11:20:41.230

另一种方法是通过解决依赖关系`MarkupExtension`并将其设置为 XAML 中转换器的属性。

有关详细信息，请参阅以下答案：

[https://stackoverflow.com/a/41611854/2115905](https://stackoverflow.com/a/41611854/2115905)

# crystal-reports - 有没有办法嵌套其中一个（水晶报告）

> ID：900830
> 
> 赞同：0
> 
> 时间：2009-05-23T04:09:25.037
> 
> 标签：crystal-reports

我需要将这两个公式用于一个字段。有人可以帮我把它们结合起来吗？

 `````
stringvar input := {tbl.col};
stringvar output := '';
numbervar i;

input := Trim(input);

for i := 1 to Length(input) Step 1 do 
if not(input[i] in [Chr(13),Chr(10)]) then 
   output := output + input[i];output;

if right({tbl.col},1) = "]" then
   left({tbl.col},instr({tbl.col},"[")-1)
else 
   {tbl.col};

````  `如果我想先使用此代码然后删除空格/换行符，有什么建议吗？//stringvar 数组 x := split({Police.Narrative},"]"); //数字变量 i; //numbervar j := ubound(x); //stringvar y := ""; //for i := 1 to j-1 do( //y := y + trim(extractstring(x[i],"","["))+"; " //); //如果 len(y) > 2 那么 //left(y, len(y)-2);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-11T16:27:34.783

您应该使用 Replace 函数，而不是执行循环来删除空格和换行符。

# http - 如果凭据已经可用，是否有办法强制浏览器始终传递 Authorization 标头？

> ID：900831
> 
> 赞同：0
> 
> 时间：2009-05-23T04:12:21.883
> 
> 标签：http, cgi, http-headers, basic-authentication

使用基本身份验证，如果用户已经登录，浏览器将在随后的 http 请求中包含用户名/密码，前提是它收到包含身份验证质询的 401 响应。用户名/密码通过 Authorization 标头传递。

一旦用户登录，有没有办法强制浏览器始终包含 Authorization 标头？

我要求这样做的原因是我有一个 CGI 应用程序（与为我的动态页面提供服务的主 CGI 应用程序分开）应该使用授权信息（如果存在）但如果它不存在则不应提示它。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T05:23:25.957

> 如果用户已经登录，浏览器将在随后的 http 请求中包含用户名/密码，仅当它收到包含身份验证质询的 401 响应时

这不是我在网络浏览器中看到的行为；一旦浏览器收到 401，它总是包含在那之后的授权。您能否提供有关如何重现该问题的更多详细信息？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T08:44:46.653

一种解决方案是公开 CGI 应用程序的一个处理程序，该处理程序将生成一个 HTML 页面，该页面将执行 AJAX 调用，提示 401，然后浏览器将对其进行响应。这有意义吗？

# css - ie7奇怪的浮动正确问题

> ID：900837
> 
> 赞同：1
> 
> 时间：2009-05-23T04:16:30.387
> 
> 标签：css, internet-explorer-7, css-float

这是在 IE7 中给我带来问题的 html 代码

```
<div style="position:absolute;top:276px;left:194px;" class="drag layer_3">
<img class="deleteitem" height="12px" width="12px" title="Remove" src="/static/redclose.png" style="float:right;cursor:pointer;">
<img src="/static/18.png"  >
</div> 
```

这是它应该看起来的样子，在ie8，firefox中看起来很好

[http://img200.imageshack.us/img200/189/ie8.png](http://img200.imageshack.us/img200/189/ie8.png)

但在 IE7 中，浮动右图像这样跳到文档的右端

[http://img33.imageshack.us/img33/6239/ie7bug.png](http://img33.imageshack.us/img33/6239/ie7bug.png)

我该如何解决？我尝试删除高度宽度属性并使用最大高度，最大宽度。那没有帮助。多谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T04:54:08.927

您可以明确设置 div 的宽度或颠倒图像的顺序并向左浮动而不是向右浮动：

```
<div style="position:absolute;top:276px;left:194px;" class="drag layer_3">
    <img src="/static/18.png" style="float:left"  >
    <img class="deleteitem" height="12px" width="12px" title="Remove"
         src="/static/redclose.png" style="cursor:pointer;">
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T04:20:05.753

我相信有问题的元素浮动到“拖动 layer_3”的父级的右侧，一旦您将某人设为绝对位置，它就会从正常的文档流中取出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T04:22:20.370

您的问题可能已在此处得到解答：[Floating Too Far Right！](https://stackoverflow.com/questions/428862/floating-too-far-right)

他建议使用 jQuery 来执行此操作，因为它被编写为独立于浏览器的。

另外，请参阅底部的原作者的解决方案（不使用 jQuery）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T04:42:19.877

我认为我们需要查看 .drag 和 layer_3。目前我看不到 Remove 的父级没有定义的宽度。我相信您的 div 的宽度在 ie7 中可能会有所不同。尝试为其添加边框以查看其计算宽度。

# php - 使用 Vim 突出显示代码块背景

> ID：900854
> 
> 赞同：3
> 
> 时间：2009-05-23T04:32:45.470
> 
> 标签：php, vim, syntax-highlighting, codeblocks

当我在 Vim 中工作时，我想对 php 标签内的所有代码进行轻微的背景颜色更改。例如，常规 XHTML 标记的背景是纯黑色，然后在 php 标记内显示稍微浅一些，以帮助我快速识别它。这是我可以/应该用配色方案做的事情还是有其他方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T04:37:51.583

你可以在配色方案中做到这一点

例子：

```
hi htmlTag          guifg=#00bdec   guibg=#200000            gui=bold 
```

# iphone - 为什么 UILabel 是 0x0？

> ID：900857
> 
> 赞同：1
> 
> 时间：2009-05-23T04:34:59.340
> 
> 标签：iphone, cocoa-touch, memory-management, uilabel

我正在加载一个笔尖：

```
ContentViewController *theController = [[ContentViewController alloc] initWithNibName:@"ContentView" bundle:nil]; 
```

上面有标签。视图控制器有一个 IBOutlet 的 UILabel 和一个 @property 的保留和综合变量。当我从另一个类加载上述笔尖并将标签的文本属性引用为：

```
theController.myLabel.text = @"testing..."; 
```

myLabel 的地址为 0x0。在分配之前，文本是“无效的”。赋值后，它的类型是 ContentViewController。内存管理存在一些问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T14:12:13.660

在 init 调用中不会立即建立连接。在访问视图控制器的`view`属性之前不会加载主视图，这会导致所有其他 IBOutlets 也被设置。如果您在加载视图之前尝试访问 IBOutlet，它将为零。通常，分配代码应该进入`-viewDidLoad`. 如果您需要在将视图添加到屏幕之前执行某些操作，只需在将任何内容分配给任何 IBOutlets 之前访问该视图：

```
theController.view;
theController.myLabel.text = @"testing..."; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-24T07:47:07.600

你有没有写任何代码，

```
-(void)loadView {  } 
```

方法？

如果是这样，则未分配 IBOutlet 对象。
尝试评论此功能。
如果你需要这个函数被触发调用 loadNibnamed: 方法来调用那个 viewController。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T04:50:29.100

ViewController 仅按需加载其视图。赋值中的隐式`getMyLabel`调用会导致加载视图并连接出口。至于类型错误，我不知道为什么`myLabel`会以`ContentViewController`. 您应该检查接口生成器中的连接并确保它们正确连接。

# controls - 替代下拉列表？

> ID：900863
> 
> 赞同：5
> 
> 时间：2009-05-23T04:41:24.167
> 
> 标签：controls, drop-down-menu, usability

列表中有 30-35 项，预计还会进一步增长。将它放在页面上的最佳方式是什么？下拉列表是想到的第一个控件，但随着列表的增长，它很容易成为一种痛苦。

呈现这种长列表的最佳可用性控制是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T04:53:09.770

另一种选择是多层树，如果您能想到一种划分列表的方法：例如，35 个项目可能是 7 组，每组 5 个项目。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T04:44:33.943

35 并不是一个很长的列表，只要在放入列表时按字母顺序排序即可，因此用户可以键入前几个字符并接近他们想要的选择。由于该功能，即使是几百个条目似乎也不会有太多选择。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-24T07:40:54.527

这实际上是一个非常艰难的决定，在不了解产品或将要使用该产品的人的技术素养的情况下，不可能给出可靠的答案（您是否与用户（甚至代理用户）测试过想法？）。

您可以做的一件事是将信息分解为相关的部分：

**描述**
列表元素一
列表元素二
**描述**
列表元素三
列表元素四

唯一的缺点是，如果有人选择其中一个描述性元素，您可能需要处理会发生什么。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-23T04:59:37.310

如果列表变得太长，请创建一个按钮以打开完全可搜索和可排序的值列表。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-23T06:28:21.787

创建一个复选框/单选框网格。然后你可以利用水平空间。按字母顺序排序选项也将有很大帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-08-20T19:19:08.753

查看[Room To Read 网站](http://www.roomtoread.org) 这是我见过的最实用的菜单设计之一。没有下拉菜单。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-23T05:13:12.600

我想我会尽量远离下拉列表，不是因为项目的数量，而是因为选择项目时会发生什么：在下拉列表中选择项目会立即执行命令并不常见（从用户的角度来看）。相反，我会考虑使用一个通常用于表示命令的控件。

我首先想到的是使用一个按钮和一个弹出菜单。单击按钮将直接在按钮下方显示菜单。然后，您还可以利用菜单的级联可能性将项目分组到逻辑组中。您还将以使用户认为“命令”而不是“选择”的方式呈现项目。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-23T05:18:47.570

两个列表，其中一个是类别，哪个将另一个列表更改为该类别的项目？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-08T17:01:13.723

如果您确实使用包含大量项目的下拉列表，我建议避免在扩展列表上施加任意小的“一次显示的最大项目数”的做法（并在用于访问其余项目的扩展下拉菜单），除非您有充分的理由这样做。

我曾不止一次对某些应用程序感到恼火，该应用程序向我显示了一个包含大量项目（例如 20 或 30 个）的下拉列表，但将显示的项目数量限制为少量（例如 8 个） . 整个应用程序窗口中有大量可用的屏幕空间，整个屏幕上有更多可用空间；那么为什么要强迫我滚动列表以查看所有可用选项，而列表可以简单地绘制得足够大以同时显示所有项目呢？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-08T20:40:12.707

如果您有大量的项目-可以根据对键入的单词进行的搜索通过**ajax填充该框-就像谷歌搜索和许多其他搜索一样。**也许在一些流行的库中有一个罐装的 javascript 解决方案，任何人都可以添加到这个答案中？

30个项目一点也不多。几乎所有地方都使用约 150 个国家/地区下拉框进行国家选择（但是该列表永远不会改变……这可能是考虑的一部分）

至于使用按字母顺序排序的列表——在框旁边放置一个提示可能会使它更有用——访问者可以输入一些字符来快速浏览列表——正如 Ron 建议的那样。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-03-02T14:51:48.097

我建议使用“键入时查找”自动完成文本框。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-01-12T04:11:49.560

你应该让它扩展成一个多列列表而不是一个长列表

# c# - 在我的应用程序中嵌入 SQL Server Express 2005

> ID：900866
> 
> 赞同：1
> 
> 时间：2009-05-23T04:43:09.873
> 
> 标签：c#, installation, setup-deployment

如何将 Sql server 2005 express edition 与我的安装程序包作为一个文件嵌入？

谢谢。

PS：这是一个Windows应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T07:09:01.057

有关嵌入说明，请参阅[http://msdn.microsoft.com/en-us/library/bb264562.aspx](http://msdn.microsoft.com/en-us/library/bb264562.aspx)。

不要让“使用包装器”部分吓到......你不需要那个。但是您将需要命令行开关。安装程序是一个单一的可执行文件，可以从主安装程序中启动，命令行开关提供了成功安装所需的所有控制。

另请参阅此处：

在安装期间配置 SQL Express [http://blogs.msdn.com/sqlexpress/archive/2006/09/20/763956.aspx](http://blogs.msdn.com/sqlexpress/archive/2006/09/20/763956.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T05:50:13.267

从技术上讲，要真正嵌入数据库，您必须使用 SqlCe、SQLite 等。SQL Express 仍然作为服务运行，所以我不知道您是否可以真正嵌入它。

# iphone - 在事件处理程序中获取 UIButton 的标题

> ID：900867
> 
> 赞同：25
> 
> 时间：2009-05-23T04:44:31.713
> 
> 标签：iphone, objective-c, cocoa, uibutton

我创建一个按钮并将标题设置为“单击此处”。当我按下该按钮时，我想获取该按钮标题并记录它。这是我的代码，我哪里出错了？

```
-(void)clicketbutton {
    UIButton *mybutton = [UIButton buttonWithType:UIButtonTypeCustom];
    [mybutton setTitle:@"Click here"  forState:UIControlStateNormal];
    [mybutton addTarget:self  
       action:@selector(displayvalue:)forControlEvents:UIControlEventTouchUpInside]; 
}

-(void)displayvalue:(id)sender {       
    UIButton *resultebutton= [UIButton buttonWithType:UIButtonTypeCustom];

    resultebutton=sender;// pls clear here.. my question here , it it possible or not. if possible how ?
    NSLog(@" The buttontitile is %@ ", [resultebutton.Title] // here also.
} 
```

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-05-24T22:01:45.103

您的 displayvalue: 方法应如下所示：

```
-(void)displayvalue:(id)sender {       
    UIButton *resultButton = (UIButton *)sender;
    NSLog(@" The button's title is %@.",  resultButton.currentTitle);
} 
```

（请查看 XCode 中的文档，它会给您正确的答案。）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-04T12:12:02.917

```
-(void)displayvalue:(id)sender 
{
    UIButton *resultebutton= (UIButton*)sender;
    NSLog(@"The button title is %@ ", resultebutton.titleLabel.text);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-03-11T23:43:47.857

我知道这是一个老问题，但这可能是解决这个问题的最巧妙方法。

```
NSLog(@"The button title is: %@", [sender currentTitle]); 
```

**编辑**
我刚刚意识到这取决于您已将接收参数设置为`UIButton*`. 而不是使用默认值`id`，而是创建一个`UIButton`对象并投射`(id)sender`到该按钮。去掉中间人，只需将函数签名设置为

```
-(void)buttonPressed:(UIButton*)sender{
  NSLog(@"Button title: %@",sender.currentTitle);
} 
```

这有效地转换了函数参数

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-14T10:39:02.167

```
-(void)clicketbutton {
    UIButton *mybutton = [UIButton buttonWithType:UIButtonTypeCustom];
    [mybutton setTitle:@"Click here"  forState:UIControlStateNormal];
    [mybutton addTarget:self  
       action:@selector(displayvalue:)forControlEvents:UIControlEventTouchUpInside]; 
}
-(void)displayvalue:(id)sender {       

     NSLog(@"The title is %@ ", [mybutton titleForState:UIControlStateNormal]);

} 
```

# windows - 如果不使用 4GB RAM 中的 800MB，如何更好地利用编码平台？

> ID：900870
> 
> 赞同：0
> 
> 时间：2009-05-23T04:48:34.080
> 
> 标签：windows, vmware, 32-bit, virtual-pc

我的编码平台是一台具有 4GB RAM 的 Vista 机器。虽然机器很光滑，但我知道有 800MB 的 RAM 根本没有使用。（仅使用了大约 3.2GB 或 4GB）。

我可以安装一些东西来帮助我的平台进行编码吗？我认为五笔将无法使用那些RAM，但VMware或VirtualPC可能会？或者一个 RAM 磁盘，以便下载和安装带有大文件的工具可以更快地解压缩？（例如解压缩 Ruby 安装文件，这似乎是 17,000 个文件要解压缩 - 可能夸大了）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T04:52:46.930

上面 500MB-1GB 的 RAM 是为 Windows 和 32 位 Windows 上的设备驱动程序保留的。它的大小因许多因素而异，但最大的是您的显卡拥有的 RAM 量，因为该量通常会从 32 位地址空间的顶部保留。使用它的唯一方法是安装 64 位操作系统（例如 Vista 64 位）。虚拟化对您没有帮助，因为您无法提供给来宾操作系统的内存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T16:48:55.533

您将需要安装 64 位操作系统，然后您将能够利用您的所有内存。

顺便说一句，安装/启用 PAE 的 32 位 Linux 内核可以利用额外的内存，尽管个别应用程序本身仍将受到限制。

以下是有关 PAE 的更多信息：

[维基百科](http://en.wikipedia.org/wiki/Physical_Address_Extension)

[Linux中的高内存](http://kerneltrap.org/node/2450)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T05:04:37.603

小心使用 RAM 磁盘。通常，内存会更好地用于应用程序、后台任务或系统缓存。您经常会在 ramdisk 和读/写缓冲区或进程内存之间复制数据。

如果解压文件是你的应用程序的瓶颈，那么考虑在用户设置他们的偏好、阅读你的程序介绍或其他耗时但不是 io 密集型任务时在后台进行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T09:17:53.223

到目前为止，充分利用内存的最简单方法是切换到 64 位操作系统。

关于为什么您无法很好地使用 ram 的最佳文章是：

[突破 Windows 的极限：](http://blogs.technet.com/markrussinovich/archive/2008/07/21/3092070.aspx) Mark Russinovich 的物理内存，

当然还有[老兄，我的 4 GB RAM 呢？](http://www.codinghorror.com/blog/archives/000811.html)通过杰夫阿特伍德。

[![替代文字](https://i.stack.imgur.com/eN8x9.png)](https://i.stack.imgur.com/eN8x9.png)
[（来源：[technet.com](http://blogs.technet.com/blogfiles/markrussinovich/WindowsLiveWriter/PushingtheLimitsofWindowsPhysicalMemory_878B/image_thumb_4.png)）]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T16:31:55.307

任何应用程序或驱动程序都不会纠正物理/可用内存差异，因为它们在操作系统的限制内运行。您永远不能使用带有 32 位 Windows 的物理内存。它没有丢失；800MB 不（不能）存在。

只有 64 位操作系统才能寻址和使用 4Gb 物理内存。您可以使用任何 Linux 发行版 LiveCD 测试我的断言（我建议使用 Ubuntu 64 位桌面）。

我没有使用 64 位 Vista，但 64 位 Windows Server 2003 对我来说运行良好（即使在笔记本电脑上）。

# webserver - “ab”或“httperf”更适合检查网站的性能吗？

> ID：900875
> 
> 赞同：13
> 
> 时间：2009-05-23T04:52:22.233
> 
> 标签：webserver, performance

到目前为止，我知道“ab”和“httperf”，它们都可以检查网站的性能。这个比那个好吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-23T05:14:11.023

好吧，它确实取决于您要检查的内容，但我自己总是使用 httperf。

关键区别在于 httperf 尝试以给定的速度发送连续的请求流，而不管它们是否得到响应。这不仅可以显示 Web 服务器的最大负载是多少，更重要的是，它可以显示过载时的行为。许多应用程序都有一个不幸的特性，即当提供的负载超过服务器的处理能力时，性能会迅速下降：即，当每秒提供 100 个请求时，它可以处理其中的 80 个，而当每秒提供 150 个请求时，它可以处理只有10个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-26T15:39:38.850

我发现在 httperf 上找到有用的文档是一项艰巨的任务，但是有一个很好的（如果你喜欢截屏视频）[peepcode 截屏视频](http://peepcode.com/products/benchmarking-with-httperf)让我继续使用它。

我没有使用过 ab mind，但我发现 httperf 在我弄清楚如何使用它之后似乎工作得很好。

**更新：**该链接现在位于[复数视觉](http://www.pluralsight.com/courses/benchmarking-with-httperf)，您需要订阅或使用他们的 10 天免费试用。

# c# - 如何将方法限制为特定线程？

> ID：900889
> 
> 赞同：2
> 
> 时间：2009-05-23T05:02:22.020
> 
> 标签：c#, .net, multithreading

我有一种方法，出于线程安全的原因，应该只由特定线程使用。如果另一个线程试图使用它，我希望抛出一个异常。

```
public void UnsafeMethod()
{
    if (CurrentThreadId != this.initialThreadId)
        throw new SomeException("Can only be run on the special thread.");
    // continue ...
} 
```

如何`CurrentThreadId`在上面的代码中找到？或者，还有其他方法可以实现我想做的事情吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T05:11:44.630

线。[当前线程](http://msdn.microsoft.com/en-us/library/system.threading.thread.currentthread.aspx)。[ManagedThreadId](http://msdn.microsoft.com/en-us/library/system.threading.thread.managedthreadid.aspx)

或者您可以只存储对线程对象本身的引用并将其与 Thread.CurrentThread 进行比较。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T05:33:33.353

在创建时命名您的线程

```
System.Threading.Thread thread = new System.Threading.Thread(..);
thread.Name = "MySpecialThread"; 
```

并检查您想要线程特定代码的条件：

```
if (System.Threading.Thread.CurrentThread.Name == "MySpecialThread")
{
    //..
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T05:09:54.817

我想你需要一些类似于静态变量（伪装的全局变量）的东西来做到这一点。这对我来说感觉不是很好，但是把这个方法放在一个单例对象中会让你拥有它。

# java - maven-native-plugin 是否广泛用于使用 maven 构建 C++ 项目？

> ID：900890
> 
> 赞同：9
> 
> 时间：2009-05-23T05:04:02.610
> 
> 标签：java, c++, maven-2, build-process, maven-plugin

自从我专业地进行 C++ 开发以来已经有一段时间了，我想了解 C++ 开发在许多领域的当前状态。我最近的大部分工作都是 Java，大量使用 Maven。当我上次为工作进行 C++ 开发时，一些变体`make`被广泛接受为构建 C++ 项目的方式（我们也曾经`make`在我们的混合 Java 和 C++ 项目中构建 Java 代码，尽管我相信`ant`它开始成为主流）。

我喜欢使用 Maven 进行构建。我的问题不是讨论使用 Maven 的相对优点，而是确定用于构建 C++ 项目的[Native Maven 插件](http://mojo.codehaus.org/maven-native/native-maven-plugin/index.html)的采用程度以及人们对此的体验。或者，是否有用于 C++ 构建的新通用工具链具有很大的动力？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-23T09:51:51.417

根据我的经验，C++ 社区还没有标准化一个通用的构建工具。虽然 GNU 自动工具（和 GNU make）在开源项目中仍然很受欢迎，但其他选项包括[SCons](http://www.scons.org/)、[CMake](http://www.cmake.org/)、[makepp](http://makepp.sourceforge.net/)和[bjam](http://www.boost.org/doc/tools/build/doc/html/jam/usage.html) /jam。

就个人而言，我只会将 Maven 用于主要用 Java 编写的项目，其中包含一个小的 JNI 部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-08-24T07:13:53.413

我们对 maven 原生插件的体验是它与 Java 工具链的集成非常好。如果您构建混合的 java/C++ 系统，那么它就是适合您的插件。由于这个插件，我们的 C++ 和 Java 开发人员拥有相同的环境（maven、eclipse、hudson）和集中的依赖管理（nexus）。不利的一面是，我们的一些修复（由于我们的大量代码库，数百万行代码而导致的性能相关）尚未集成到主版本中，这迫使我们必须使用补丁版本。

# c# - C# 'ref' 关键字，性能

> ID：900903
> 
> 赞同：13
> 
> 时间：2009-05-23T05:12:13.177
> 
> 标签：c#, performance, ref

如果您有一个 Bitmap 对象需要传递给许多方法（大约 10 个），最后传递给一个事件，在使用后最终将其处理掉，那么将它传递给每个方法（性能方面）是否有益？那些方法是引用而不是值？

通过值传递，对象被复制，而不是通过引用传递。

（在这种情况下，性能至关重要。应用程序需要尽可能快地运行。）

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-23T05:21:06.957

位图是一种引用类型。按值传递引用类型不会复制对象，而只是复制对对象的引用。通过引用而不是按值传递位图不会带来性能优势。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-23T05:28:42.157

由于 Bitmap 是一种引用类型，因此在这种情况下的性能没有实际差异，因为它已经通过引用传递给该方法。

我推荐[Jon Skeet 关于这个主题的文章，](http://www.jonskeet.uk/csharp/parameters.html)以全面解释“按引用”和“按值”如何在 C# 中工作。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-23T05:20:50.327

您究竟使用哪种类型来保存位图？例如，[System.Drawing.Bitmap](https://msdn.microsoft.com/en-us/library/system.drawing.bitmap%28v=vs.110%29.aspx)是一个引用类型/类。当您传递对方法的引用（作为参数）时，引用是按值传递的。（**制作了引用的副本......不是对象**）因此将在 32 位机器上分配四个字节来保存副本。

使用 ref 关键字对性能没有太大影响，只是传递了相同的引用（不复制引用）。它有以下好处

*   **只清除获取参数的方法可能修改它**的意图，调用者可能会在执行后获得修改后的值。
*   并且该变量**必须由被调用者初始化，**然后才能作为参数传递给采用 ref 参数的被调用函数。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-23T05:58:50.460

'ref' 不会将对象本身传递给函数，而是传递对它存储在/at 中的变量的引用。

如果对象是类或接口，那么每当您在函数中访问该变量时，它必须取消引用它，然后访问该变量。如果它是在没有 'ref' 关键字的情况下传入的，那么它就不必执行取消引用步骤（因此它会稍微快一些）。

如果对象是结构（或枚举或其他基本类型），则“ref”关键字将引用传递给存储该结构的变量，这仍然会在您使用它时导致解引用的轻微速度命中，但如果您不这样做“ t 指定它，然后程序必须为结构的新实例分配内存，然后复制它。在大多数情况下，通过 ref 关键字传递结构会更快，但如果它是一个非常小的结构，或者它被取消引用很多（我的意思是很多），情况可能并非如此。

因此，如果您要传递一个结构，那么 ref 通常是要走的路，否则不会有太大的区别（取消引用阶段的开销很小）。

哦，实际上要回答这个问题，Bitmap 是一个类，所以'ref' 关键字不会真正对非'ref' 参数产生速度差异。

# cocoa - 如何告诉 NSTableView 在显示/隐藏列时不要调整所有其他列的大小？

> ID：900908
> 
> 赞同：1
> 
> 时间：2009-05-23T05:16:17.290
> 
> 标签：cocoa, nstableview

我有一个 NSTableView，我可以让用户动态显示或隐藏列（使用邮件样式的标题上下文菜单）。

我的问题是，如果表格视图当前比它的滚动视图更宽（即它显示一个水平滚动条），当一个列被隐藏或显示时，它会调整每个可见列的大小，以便它们都再次适合屏幕。我怎么做，好吧，不是。我只想隐藏/显示隐藏/显示的列而不调整其他列的大小。

我尝试将列调整大小样式设置为 None is interface builder，但这没有任何效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T05:20:54.213

您可以通过在 IB 中单独选择每一列并禁用 Attributes->Resizes With Table 复选框来执行此操作。

# linq - 如何从 LINQ to SQL 中的子集合中删除记录？

> ID：900919
> 
> 赞同：3
> 
> 时间：2009-05-23T05:23:06.767
> 
> 标签：linq, linq-to-sql

我的数据库中有两个通过外键连接的表：Page（PageId，其他数据）和 PageTag（PageId，Tag）。我使用 LINQ 为这些表生成类，页面作为父集合，标签作为子集合（一对多关系）。有没有办法从 Page 类中标记 PageTag 记录以从数据库中删除？

**快速清算：**

我希望在父 DataContext 调用 SubmitChanges() 时删除子对象，而不是之前。我希望 TagString 的行为与 Page 对象的任何其他属性完全相同。

我想启用如下代码：

```
Page page = mDataContext.Pages.Where(page => page.pageId = 1);
page.TagString = "new set of tags";

//Changes have not been written to the database at this point.

mDataContext.SubmitChanges();

//All changes should now be saved to the database. 
```

以下是我的详细情况：
为了更轻松地处理标签集合，我向 Page 对象添加了一个属性，将标签集合视为字符串：

```
public string TagString {
    get {
        StringBuilder output = new StringBuilder();
        foreach (PageTag tag in PageTags) {
            output.Append(tag.Tag + " ");
        }

        if (output.Length > 0) {
            output.Remove(output.Length - 1, 1);
        }

        return output.ToString();
    }
    set {
        string[] tags = value.Split(' ');
        PageTags.Clear();
        foreach (string tag in tags) {
            PageTag pageTag = new PageTag();
            pageTag.Tag = tag;
            PageTags.Add(pageTag);
        }
    }
} 
```

基本上，这个想法是当一串标签被发送到这个属性时，对象的当前标签被删除，并在它们的位置生成一个新的集合。

我遇到的问题是这一行：

```
PageTags.Clear(); 
```

提交更改时实际上不会从数据库中删除旧标签。

环顾四周，删除事物的“正确”方法似乎是调用数据上下文类的 DeleteOnSubmit 方法。但我似乎无法从 Page 类中访问 DataContext 类。

有谁知道从 Page 类中标记要从数据库中删除的子元素的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T18:09:54.870

经过更多的研究，我相信我已经设法找到了解决方案。从集合中删除对象时将其标记为删除由 Association 属性的 DeleteOnNull 参数控制。

当两个表之间的关系使用 OnDelete Cascade 标记时，此参数设置为 true。

不幸的是，无法从设计器中设置此属性，也无法从 *DataContext.cs 文件的部分类中设置它。在不启用级联删除的情况下设置它的唯一方法是手动编辑 *DataContext.designer.cs 文件。

在我的例子中，这意味着找到 Page 关联，并添加 DeleteOnNull 属性：

```
[Association(Name="Page_PageTag", Storage="_Page", ThisKey="PageId", OtherKey="iPageId", IsForeignKey=true)]
public Page Page
{
    ...
} 
```

并添加 DeleteOnNull 属性：

```
[Association(Name="Page_PageTag", Storage="_Page", ThisKey="PageId", OtherKey="iPageId", IsForeignKey=true, DeleteOnNull = true)]
public Page Page
{
    ...
} 
```

请注意，该属性需要添加到 PageTag 类的 Page 属性中，而不是相反。

See also:
[Beth Massi -- LINQ to SQL and One-To-Many Relationships](http://blogs.msdn.com/bethmassi/archive/2007/10/02/linq-to-sql-and-one-to-many-relationships.aspx)
[Dave Brace -- LINQ to SQL: DeleteOnNull](http://blogs.catalystss.com/blogs/dave_brace/archive/2008/10/01/linq-to-sql-deleteonnull.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T00:11:46.573

对不起这是我的错。那是行不通的。

看起来您确实需要在存储库中执行此操作，而不是在 Page 类中。在那里，您可以访问原始数据上下文。

有一种方法可以“附加”原始数据上下文，但是当你这样做时，它已经变成了代码的味道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T05:59:52.813

在 Linq to SQL 实体图中，您是否有链接 Page 和 PageTags 表的关系？如果您不这样做，这就是您无法从 Page 类中看到 PageTags 类的原因。

如果 PageTags 数据库表中的外键设置为 Allow Nulls，则即使您在 SQL Server 上创建了关系，当您将表拖入设计器时，Linq to SQL 也不会创建链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T20:18:41.210

这是 OR 映射可能会有点毛茸茸的领域之一。提供这个 TagString 属性会使事情变得更方便一些，但从长远来看，当有人使用 TagString 属性时，它会混淆实际发生的情况。通过隐藏您执行数据修改的事实，某人可以很容易地出现并设置 TagString，而无需在 DataContext 范围内使用您的 Page 实体，这可能会导致一些难以发现的错误。

更好的解决方案是使用 L2S 模型设计器在 Page 类上添加一个 Tags 属性，并要求在 DataContext 范围内直接在 Tags 属性上编辑 PageTags。将 TagString 属性设为只读，以便对其进行分类（并且仍然提供一些便利），但消除了设置该属性时的混乱和困难。这种更改明确了意图，并明确了正在发生的事情以及 Page 对象的消费者需要什么来实现它。

由于 Tags 是 Page 对象的属性，只要它附加到 DataContext，对该集合的任何更改都会正确触发数据库中的删除或插入，以响应 Remove 或 Add 调用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T21:26:45.767

亚伦，

显然，您必须遍历您的 PageTag 记录，为每个记录调用 DeleteOnSubmit。当您调用 SubmitChanges 时，Linq to SQL 应该创建一个聚合查询来一次删除所有记录，因此开销应该是最小的。

代替

```
PageTags.Clear(); 
```

和

```
foreach (PageTag tag in PageTags)
    myDataContext.DeleteOnSubmit(tag); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T22:56:27.567

亚伦：

将 DataContext 成员添加到您的 PageTag 分部类。

```
partial class PageTag 
{ 
    DataClassesDataContext myDataContext = new DataClassesDataContext(); 

    public string TagString { 
```

..ETC。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-24T00:01:05.613

应 Robert Harvey 的要求发布的更大代码示例：

DataContext.cs 文件：

```
namespace MyProject.Library.Model
{
    using Tome.Library.Parsing;
    using System.Text;

    partial class Page
    {
        //Part of Robert Harvey's proposed solution.
        MyDataContext mDataContext = new TomeDataContext();

        public string TagString {
            get {
                StringBuilder output = new StringBuilder();
                foreach (PageTag tag in PageTags) {
                    output.Append(tag.Tag + " ");
                }

                if (output.Length > 0) {
                    output.Remove(output.Length - 1, 1);
                }

                return output.ToString();
            }
            set {
                string[] tags = value.Split(' ');
                //Original code, fails to mark for deletion.
                //PageTags.Clear();

                //Robert Harvey's suggestion, thorws exception "Cannot remove an entity that has not been attached."
                foreach (PageTag tag in PageTags) {
                    mDataContext.PageTags.DeleteOnSubmit(tag);
                }

                foreach (string tag in tags) {
                    PageTag PageTag = new PageTag();
                    PageTag.Tag = tag;
                    PageTags.Add(PageTag);
                }
            }
        }

        private bool mIsNew;
        public bool IsNew {
            get {
                return mIsNew;
            }
        }

        partial void OnCreated() {
            mIsNew = true;
        }

        partial void OnLoaded() {
            mIsNew = false;
        }
    }
} 
```

存储库方法：

```
public void Save() {
    mDataContext.SubmitChanges();
}

public Page GetPage(string pageName) {
    Page page =
        (from p in mDataContext.Pages
        where p.FileName == pageName
        select p).SingleOrDefault();

    return page;
} 
```

用法：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(string pageName, FormCollection formValues) {
    Page updatedPage = mRepository.GetPage(pageName);

    //TagString is a Form value, and is set via UpdateModel.
    UpdateModel(updatedPage, formValues.ToValueProvider());
    updatedPage.FileName = pageName;

    //At this point NO changes should have been written to the database.

    mRepository.Save();

    //All changes should NOW be saved to the database.

    return RedirectToAction("Index", "Pages", new { PageName = pageName });
} 
```

# debugging - 在客户环境中创建内存转储好吗？

> ID：900921
> 
> 赞同：4
> 
> 时间：2009-05-23T05:26:56.623
> 
> 标签：debugging, memory-dump

我的程序面临一个严重的问题，该程序只能在客户处复制。放置日志并没有帮助，因为我怀疑第三方 dll 中发生了故障。由于某些原因，我无法从图书馆提供者那里获得帮助。我正在考虑在故障点产生转储，以便离线分析它。这是推荐的做法吗？或者有什么替代方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T09:25:22.873

是的，这是每个程序都应该尽可能多地使用和使用的东西。

我建议您不要使用第三方库。而是创建自己的转储。这非常简单直接。您基本上需要执行以下操作：

您的程序需要访问**dbghelp.dll**。它是一个 Windows dll，允许您创建人类可读的调用堆栈等。调试器使用此 dll 在您的进程中显示数据。它还处理事后调试，即某种形式的转储。此 dll 可以安全地与您的软件一起分发。我建议您下载并安装[Debugging Tools for Windows](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)。这将使您可以访问各种工具，最好的工具**WinDbg.exe**和最新的 dbghelp.dll 也在该发行版中。

在 dbghelp.dll 中，您调用例如**MiniDumpWriteDump()**，它将创建转储文件，这或多或少是它。你完成了。一旦您掌握了该文件，就可以开始使用它。在 Visual Studio 调试器中，甚至可能与 .dmp 文件扩展名相关联，或者在 WinDbg 中。

现在，当你在做的时候，有一些事情需要考虑。像这样检查转储文件时，您需要在编译和链接可执行文件时生成 .pdb 文件。否则没有机会将转储数据映射到人类可读数据，例如获得良好的调用堆栈和变量值等。这也意味着您必须保存这些 .pdb 文件。您需要能够将它们与该版本完全匹配。由于转储文件带有可执行文件的日期戳，因此调试器需要确切的 pdb 文件。如果你的代码没有改变一点也没关系，如果 .pdb 文件属于另一个编译会话，你就完蛋了。

我鼓励每个 windows win32 开发人员查看 Oleg Starodumov 的站点[DebugInfo.com](http://www.debuginfo.com/examples.html)。它包含大量示例和教程以及如何配置和调整转储文件生成。当然有无数种方法可以排除某些数据，创建自定义调试消息以附加到转储等。

请记住，小型转储将包含有关异常时应用程序状态的非常有限的信息。权衡的是一个小文件（大约 50-100 kB，具体取决于您的设置）。但是，如果您愿意，您可以创建一个**完整**的转储，其中将包含整个应用程序的状态，即全局变量甚至内核对象。这些文件可能非常庞大，只能在极端情况下使用。

如果有法律方面的问题，请确保您的客户知道您在做什么。我敢打赌，您已经签订了一些合同，您不应该透露商业机密或其他法律方面的内容。如果客户抱怨，请说服他们发现错误是多么重要，这将大大提高软件的质量。或多或少的质量更高，不惜一切代价。如果它不花费他们任何费用，那也是一个很好的论据:)

最后，如果您想了解更多关于故障转储分析的信息，这里是另一个很棒的网站：[dumpanalysis.org](http://www.dumpanalysis.org/)

希望这可以帮助。如果您想让我解释更多，请发表评论。

干杯！

编辑：

只是想补充一点，**MiniDumpWriteDump()**要求您有一个指向 MINIDUMP-EXCEPTION-INFORMATION（带下划线）结构的指针。但是**GetExceptionInformation()**宏在异常处理程序（结构化异常处理或 SEH）中为您提供了这个：

```
__try {

}
__except (YourHandlerFunction(GetExceptionInformation())) {

} 
```

YourHandlerFunction() 将负责生成小型转储（或调用链中的其他一些函数）。此外，如果您的程序中有自定义错误，例如发生了不应该发生但技术上不是异常的事情，您可以使用**RaiseException()**来创建自己的错误。

**GetExceptionInformation()**只能在此上下文中使用，而在程序执行期间不能用于其他任何地方。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T05:40:05.187

故障转储是一种非常常见的故障排除方法，并且非常有效，尤其是对于仅在客户站点重现的问题。

只需确保客户/客户了解您在做什么并且您获得许可。故障转储可能包含客户可能不希望（或被允许）走出门或通过电线的敏感信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T06:10:19.990

更好的是，有一些库可以将崩溃数据上传回您。

[BugDump](http://www.bugdump.com/)和[BugSplat](http://www.bugsplatsoftware.com/)

还有微软的方式：

[http://msdn.microsoft.com/en-us/library/aa936273.aspx](http://msdn.microsoft.com/en-us/library/aa936273.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T06:44:28.233

*免责声明：我不是律师，也不假装是律师，这不是法律建议。*

您可以包含在日志和故障转储中的数据还取决于您在哪个领域工作。例如，医疗设备和患者信息系统通常包含有关患者的敏感数据，未经授权的人员不应看到这些数据。

> [HIPAA 隐私规则](http://en.wikipedia.org/wiki/Hipaa#The_Privacy_Rule)规范了“受保护实体”持有的某些信息的使用和披露（...），它为受保护的健康信息 (PHI) 的使用和披露制定了法规。PHI 是涵盖实体持有的任何与个人相关的与健康状况、医疗保健提供或医疗保健支付有关的信息。 [10] 这被解释得相当广泛，包括个人医疗记录或付款历史的任何部分。*——维基百科*

不可能将健康信息与个人联系起来。崩溃转储和日志应该匿名化并去除任何敏感信息，或者根本不发送。

也许这不适用于您的具体情况，因此这更像是一般性说明。我认为它适用于处理敏感信息的其他领域，例如军事和金融等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T15:29:36.070

基本上，生成转储文件的最简单方法是使用 adplus。您无需更改代码。

Adplus 是windows 调试工具的一部分，如上篇文章所述。Adplus 基本上是windbg 的一个巨大的vbscript 自动化。

使用 adplus 必须做的事情：

1.  将 Windows 调试工具下载并安装到 c:\debuggers
2.  启动您的应用程序
3.  打开命令行并导航到 c:\debuggers
4.  运行这一行“adplus -crash your_exe.exe”
5.  重现崩溃

你会得到一个包含你需要的所有信息的小型转储。您可以在您最喜欢的调试器中打开故障转储。在 windbg 中，命令“analyze -v”帮助我解决了至少 40% 的仅发生在客户现场且无法在内部重现的崩溃。

# asp.net - 学习什么 - Ruby on Rails 或 ASP .NET MVC...鉴于熟悉 ASP .NET

> ID：900922
> 
> 赞同：34
> 
> 时间：2009-05-23T05:27:18.510
> 
> 标签：asp.net, ruby-on-rails, asp.net-mvc

我需要学习并采用 MVC 方法来构建 Web 应用程序。鉴于我对 ASP .NET Webforms - ASP .NET MVC 或 Ruby on Rails 有经验，哪种方法更好？

我听说人们对 RoR 及其简单性及其功能（例如脚手架、ActiveRecord、约定优于配置等）大加赞赏。

但是，我看不出这些有什么了不起的。它们中的大多数听起来很基础（你不会真的想在生产代码中使用那种——例如脚手架）——而且它们中的大多数听起来就像它们以某种形式存在于 ASP .NET MVC 中。

为什么我应该考虑通过 ASP .NET MVC 学习 RoR？

是否有我不知道或无法感知的好处？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-26T02:34:26.623

建议你**两个都**学！

我白天是专业的 ASP.Net 开发人员，晚上是业余爱好者 RoR 开发人员。学习 RoR 实际上会让你成为更好的 .Net 开发人员，而且很有趣！

还要考虑到有一天你实际上可以用 IronRuby 编写一个 ASP.NET MVC 应用程序，而不是繁琐的旧 c# :)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-23T06:13:33.993

我建议通过 MVC 学习 RoR 的原因有很多

1.  这是一个更成熟的堆栈。自 2005 年以来一直存在。
2.  你可以学习一门新的编程语言。“他们”说你应该每年学习一门新的编程语言。
3.  基础堆栈有一组非常丰富的扩展。例如。HAML、身份验证宝石、分析和列表不胜枚举。
4.  您可以开箱即用地使用数据库迁移。这在数据库配置管理方面有点突破。
5.  动态语言为您提供了极大的灵活性。

也就是说：ASP.Net MVC 是来自微软的一个很棒的框架。我并不是在提倡倾倒你的筹码并转向黑暗的一面。我只是认为在技术方面有广泛的了解会有所帮助。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-23T06:32:43.293

如果您熟悉 Microsoft 堆栈（Windows、IIS、SQL、ASP.NET）但不太熟悉 Linux 堆栈（Apache、MySql 等），那么使用 ASP.NET MVC over Ruby on Rails 将花费您从长远来看，花在学习基础设施上的时间要少得多。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-24T12:56:05.887

我建议你看看你所在地区的就业市场，然后选择能增加你机会的东西。Ruby on Rails 是一个很棒的框架，但是如果您所在地区没有人关心或使用它，那么学习它对您没有任何好处（从职业的角度讲 - 有很多原因会使您从学习中受益看法）。我最近面临这个困境并考虑了很多；因为我的领域几乎 99% 都是基于 .Net 的，而这正是公司想要的，所以我决定专注于 MVC 并成为 ASP.NET 的“专家”，而不是学习 RoR，因为没有对 RoR 的需求。我实际上浪费了两个月的时间来学习 RoR，然后我才意识到它对我个人有帮助，但对专业没有帮助。

也就是说，如果你打算自己出击，那么选择你觉得更舒服的那个。如果你已经知道 Asp.Net，我建议你先看看 MVC 框架，因为它利用了你已经知道的东西，但我衷心建议你看看 Ruby，如果不是 Rails 框架，因为它非常好许多任务的脚本语言。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-24T12:29:31.137

我建议一次学习一个。学习新语言或编程方法的最大部分是学习最佳实践并改变处理编程问题的方式。不仅仅是语法。一次跳进两个会让你在两个方面都养成坏习惯。

因为您已经了解 ASP.NET，所以我认为学习 ASP.NET MVC 将是合乎逻辑的下一步。深入了解 MVC 概念，然后在 Ruby on Rails 中尝试一两个项目。这两个框架处理某些事情的方式不同。您可能会发现您的风格和偏好比另一种更适合。但无论哪种方式，现在你都知道了。伤不起吧？

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-24T13:56:06.657

> 但是，我看不出这些有什么了不起的。它们中的大多数听起来很基础（你不会真的想在生产代码中使用那种——例如脚手架）——而且它们中的大多数听起来就像它们以某种形式存在于 ASP .NET MVC 中。

快速制作网站原型的能力是 RoR 如此受欢迎的部分原因。在为客户设计网站时，非功能模拟和功能模拟之间存在很大差异。

我相信 ASP.NET MVC 和 RoR 之间的功能差距将继续缩小。最终选择将归结为 Windows 与 LAMP 的问题。

我会和 RoR 一起度过几个星期。安装、启动和运行它非常简单，因此您可以使用它进行开发。然后，只需遵循一些教程，直到您涵盖了大部分基础知识。然后决定是继续使用 RoR 还是坚持使用 ASP.NET MVC。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-24T14:35:00.400

如果您已经了解 c# 并且您正在使用 asp.net webforms，请尝试 asp.net mvc...当您学习它时，您可以按照我的计划提高您的 RoR 技能...

干杯

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-26T02:30:56.630

就个人而言，我会花时间学习两者。我已经这样做了，虽然我最终为我当前的项目选择了 MVC，但这个决定是因为我没有时间投资学习 Ruby 语言。另一方面，您可以在几个晚上内获得 RoR 框架，并立即开始使用网页、验证、CRUD 等。但是，当您需要开始添加域逻辑时，您可能需要了解 Ruby 来了解 gem。

另一个原因是我已经为 Microsoft 设置了托管设置，并且我知道 c# 和 .net 框架以及我需要的资源，所以虽然它不那么成熟并且没有 RoR 那样丰富的功能，但我推断我可以得到使用 MVC 更快。

要自己做出决定，权衡所有选项，花一周时间学习 MVC（使用 MVC in Action 书）并花一周时间学习 RoR（使用 Ruby on Rails 3rd Edition 的敏捷 Web 开发一书），这些将使您深入了解没时间。然后，当您决定其中一个或另一个时，您将拥有更博学的观点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-23T05:42:31.097

考虑到[Stack Overflow](http://stackoverflow.com)是用 ASP.NET MVC 编写的，我认为在 MVC 之上推广 RoR 可能是一种亵渎。

MVC 几乎为微软爱好者提供了一种他们不需要去其他地方获得的工具。

# vb.net - 在 VB.NET 中比较字符串

> ID：900927
> 
> 赞同：20
> 
> 时间：2009-05-23T05:30:25.010
> 
> 标签：vb.net, string, compare

希望这应该是一个简单的问题。在 Java 中，我认为它是`compareTo()`.

如何比较两个字符串变量以确定它们是否相同？

IE：

```
If (string1 = string2 And string3 = string4) Then
    'perform operation
Else
    'perform another operation
End If 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-23T05:34:08.080

我建议使用[String.Compare](http://msdn.microsoft.com/en-us/library/system.string.compare.aspx)方法。使用该方法，您还可以控制是否让它执行区分大小写的比较。

样本：

```
Dim str1 As String = "String one"
Dim str2 As String = str1
Dim str3 As String = "String three"
Dim str4 As String = str3

If String.Compare(str1, str2) = 0 And String.Compare(str3, str4) = 0 Then
    MessageBox.Show("str1 = str2 And str3 = str4")
Else
    MessageBox.Show("Else")
End If 
```

编辑：如果要执行不区分大小写的搜索，可以使用[StringComparison](http://msdn.microsoft.com/en-us/library/system.stringcomparison.aspx)参数：

```
If String.Compare(str1, str2, StringComparison.InvariantCultureIgnoreCase) = 0 And String.Compare(str3, str4, StringComparison.InvariantCultureIgnoreCase) = 0 Then 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-12T15:19:42.400

在 vb.net 中，您实际上可以将字符串与`=`. 尽管`String`是引用类型，但在 vb.net`=`中已重新定义以对两个字符串的*内容*`String`进行区分大小写的比较。

 *您可以使用以下代码对此进行测试。请注意，我从用户输入中获取了其中一个值，以确保编译器不能像 Java 编译器那样对两个变量使用相同的引用，如果变量是从相同的字符串 Literal 定义的。运行程序，输入“This”并按<Enter>。

```
Sub Main()
    Dim a As String = New String("This")
    Dim b As String

    b = Console.ReadLine()

    If a = b Then
        Console.WriteLine("They are equal")
    Else
        Console.WriteLine("Not equal")
    End If
    Console.ReadLine()
End Sub 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-23T05:38:44.157

```
Dim MyString As String = "Hello World"
Dim YourString As String = "Hello World"
Console.WriteLine(String.Equals(MyString, YourString)) 
```

返回一个布尔值 True。此比较区分大小写。

所以在你的例子中，

```
if String.Equals(string1, string2) and String.Equals(string3, string4) then
  ' do something
else
  ' do something else
end if 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-08-09T09:38:26.460

我知道这已经得到解答，但是在 2013 年以上的 VB.net（我个人使用过的最低版本）中，您可以将字符串与`=`运算符进行比较。这是最简单的方法。

所以基本上：

```
If string1 = string2 Then
    'do a thing
End If 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-09-28T16:41:57.757

我认为这 String.Equals 是你需要的。

```
Dim aaa = "12/31"
            Dim a = String.Equals(aaa, "06/30") 
```

a 将返回 false。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2015-04-10T13:06:28.867

```
If String.Compare(string1,string2,True) Then

    'perform operation

EndIf 
```

# python - 需要有关 Python 中的类和实例概念的帮助

> ID：900929
> 
> 赞同：2
> 
> 时间：2009-05-23T05:32:13.713
> 
> 标签：python

我已经阅读了几个文档，但是“类”和“实例”的定义对我来说还不是很清楚。

看起来那个“类”就像返回一些结果的函数或方法的组合，对吗？那么实例呢？我读到你使用你通过实例创建的类，但直接使用类会更容易吗？

有时获得语言的概念比使用它更难。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T05:40:03.643

您的问题非常广泛，因为类和实例/对象是面向对象编程的重要部分，所以这并不是真正的 Python 特定的。我建议你买一些这方面的书，虽然最初是基本的，但它可以变得非常深入。[然而，本质](http://en.wikipedia.org/wiki/Class-based_programming)上：

> OOP 最流行和最发达的模型是基于类的模型，而不是基于对象的模型。在这个模型中，对象是结合了状态（即数据）、行为（即过程或方法）和身份（在所有其他对象中唯一存在）的实体。对象的结构和行为由类定义，该类是特定类型的所有对象的定义或蓝图。必须基于类显式创建对象，并且将由此创建的对象视为该类的实例。对象类似于结构，增加了方法指针、成员访问控制和在类层次结构中定位类实例（即该类的实际对象）的隐式数据成员（对于运行时继承特性至关重要）。

因此，例如，您将定义一个`Dog`类，并创建特定狗的实例：

```
>>> class Dog():
...     def __init__(self, name, breed):
...             self.name = name
...             self.breed = breed
...     def talk(self):
...             print "Hi, my name is " + self.name + ", I am a " + self.breed
...
>>> skip = Dog('Skip','Bulldog')
>>> spot = Dog('Spot','Dalmatian')
>>> spot.talk()
Hi, my name is Spot, I am a Dalmatian
>>> skip.talk()
Hi, my name is Skip, I am a Bulldog 
```

虽然这个例子很愚蠢，但您可以开始了解如何定义一个`Client`类，该类为客户端设置蓝图，具有在特定客户端上执行操作的方法，然后通过创建对象来操作客户端的特定*实例*和在该上下文中调用这些方法。

但是，有时，您有一个类的方法，通过类的实例访问这些方法并没有真正意义，而更多的是从类本身访问。这些被称为[静态方法](http://docs.python.org/library/functions.html#staticmethod)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T05:46:44.613

我不确定您的知识水平，所以如果这个答案过于简单，我深表歉意（然后忽略它）。

类是对象的模板。就像汽车的蓝图。类的实例就像一辆真正的汽车。所以你有一个蓝图，但你可以有几个不同的汽车实例。蓝图和汽车是不同的东西。

因此，您创建了一个类来描述该类的实例可以做什么以及它应该具有哪些属性。然后你“构建”实例并获得一个你可以使用的对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T05:44:14.930

其实很简单。您知道他们在 python 中如何说“一切都是对象”。简单来说，您可以将任何对象视为“实例”，并将创建对象的说明视为类。或者用生物学术语来说，DNA 是一类，而你是 DNA 的一个实例。

```
class HumanDNA(): # class
   ... class attributes ...

you = HumanDNA() # instance 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T11:29:44.277

见[http://homepage.mac.com/s_lott/books/python/htmlchunks/ch21.html](http://homepage.mac.com/s_lott/books/python/htmlchunks/ch21.html)

> 面向对象的编程允许我们围绕对象的交互来组织我们的程序。一个类提供了对象的结构和行为的定义；每个对象都是一个类的实例。

对象（“实例”）是交互、工作、保存在文件系统中的事物等。

类是对象行为的定义。

此外，一个类创建作为该类成员的新对象（共享共同的结构和行为）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T05:41:45.417

部分原因在于 Python 的动态类型特性，它允许您以基本相同的方式对类和实例进行操作。在其他语言中，区别更为具体，因为类提供了创建对象（实例）的模板，并且不能像在 Python 中那样直接操作。对实例而不是类进行操作的好处是类可以提供一个原型，在该原型上创建实例。

# iphone - 一种在数据可用后重绘 UITableViewCell 的有效方法

> ID：900942
> 
> 赞同：4
> 
> 时间：2009-05-23T05:41:43.373
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我目前有一个 UITableViewController，其中包含许多包含简单数据的单元格。当 UITableViewController 实例化一个 UITableViewCell 时，它开始为每个单独的单元格运行一个后台线程，以从服务器获取其状态。UITableViewCell 是子类，并且已经有一个 UIImageView 属性，一旦来自服务器的数据准备好，就需要将其添加到 contentView 中。

我的问题是，每次从后台线程取回新数据时，我都需要调用 [tableView reloadData] 。这有点矫枉过正，因为我可以通过直接访问受影响的单元格来简单地将 UIImageView 添加到 contentView。我只是不确定当我的数据管理实用程序完成工作（与服务器交谈）时找到单元的最佳方法。

在调用我的数据管理器以运行其后台任务时传递单元格的 indexPath 并在任务完成后将 indexPath 传回，这样做是否有意义？这是矫枉过正吗？

你最喜欢处理这个常见任务的方式是什么？

谢谢工作人员。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T05:55:12.400

如果需要在单元格内更改数据，我不使用 dequeueReusableCellWithIdentifier:(NSString *)identifier 方法。这会阻止 UITableView 缓存单元格。当表格视图单元格滚动离开屏幕时，它们会被释放。有一个委托方法，

```
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath 
```

在你的单元格被绘制之前被调用。您可以使用它，是的，将 indexPath 传递给管理器。

当您的数据返回时，我通常会调用该方法

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

获取单元格，然后在单元格中设置文本并调用其 UIView 超类方法， `- (void)setNeedsLayout`.
这将告诉单元格重绘。

我这样做的另一种方法是使用自定义单元格，并让该自定义单元格子类在绘制时直接调用管理器以获取其数据。当数据返回时，它会调用自己的自定义委托方法来更新其内部的 UILabel 对象，然后调用 setNeedsLayout。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T16:42:44.043

如果您不介意在加载图像时在单元格中使用占位符，则可以使用 Three20 库中的 TTImageView 之类[的](http://github.com/joehewitt/three20/blob/master/src/Three20/TTImageView.h)东西。图像视图始终位于单元格中，您可以指定其图像 URL。图像视图处理 URL 请求，当图像加载时，它会自动显示。

虽然我不使用 Three20，但我在代码中做了非常相似的事情。这与表格单元重用标识符兼容——当一个单元格滚动离开屏幕时，它的图像视图 URL 会更改为一个新值，这会取消 URL 请求（如果它仍在进行中）并开始一个新的请求。结合缓存，当您向上滚动时，图像将立即加载。

# jquery - 鼠标悬停/鼠标移出 DIV

> ID：900946
> 
> 赞同：0
> 
> 时间：2009-05-23T05:42:31.563
> 
> 标签：jquery, css

我有以下 3 列布局：

```
<div id="outerwrap">
    <div id="innerwrap">
        <div id="centerc">...</div>

        <div id="rightc" style="font-weight:bold">
        </div>
        <div style="background-color:White;height:10px;top:284px;left:0px"></div>

        <div id="leftc">..</div>
    </div>
    <div id="footer" ">...</div>
</div>

<style>
    #outerwrap {
        background-color: #EE44E7;
    }

    #innerwrap {
        background-color: #EE44E7;
        margin-right: 200px;
        top: 0px;
        height: 100%;
    }

    #leftc {
        position: absolute;
        top: 111px;
        left: 0px;
        width: 197px;
        background-color: #EE44E7;
        font-size: 10px;
    }

    #centerc {
        position: relative;
        margin-left: 199px;
        padding: 0px;
        background-color: white;
    }

    #rightc {
        position: absolute;
        top: 111px;
        right: 0px;
        width: 199px;
        color: blue;
        background-color: #EE44E7;
        font-size: 10px;
    }

    #footer {
        padding: 0px;
        margin: 0px;
        width: 100%;
        height: 62px;
        visibility: hidden;
    }
</style> 
```

我打算做的是以半可见状态加载左侧 div (div id="leftc") 的页面......就像只显示 10% 的 div。当用户将鼠标悬停在其上时，div 应展开为其正常状态，鼠标移出时，它应返回其半可见状态..有点自动隐藏行为

我怎样才能在多个浏览器和使用 jQuery 或 CSS 时达到最佳效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T06:17:28.573

简单的解决方案是使用[jQuery 高度](http://docs.jquery.com/CSS/height)方法，但这可能会弄乱您的布局，除非您仔细使用 #leftc 中的 HTML。溢出：隐藏在这里可能会有所帮助。

您可以使用[css 剪辑](http://www.ibloomstudios.com/articles/misunderstood_css_clip/)属性，以及[jQUery 的 hover](http://www.ibloomstudios.com/articles/misunderstood_css_clip/)。在鼠标悬停时，删除剪辑，在鼠标移出时，应用剪辑。如果你想为它制作动画（这是下一个闪亮的进展:)），那么也有一个[jQuery 插件](http://plugins.jquery.com/project/clipAnimate)。

# java - 如何使用 JAVA 向 COM PORT 发送数据？

> ID：900950
> 
> 赞同：30
> 
> 时间：2009-05-23T05:45:17.050
> 
> 标签：java, serial-port

> **可能重复：**
> [Windows 上的 Java 串行通信](https://stackoverflow.com/questions/264277/java-serial-communication-on-windows)

朋友，我想在JAVA中连接和传输数据到COM PORT（虚拟或原始）？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-23T06:35:21.727

这个问题已经被问过很多次了：

[使用Java从串口读取文件](https://stackoverflow.com/questions/544824/read-file-from-serial-port-java)

[用Java读取串口](https://stackoverflow.com/questions/336714/reading-serial-port-in-java)

[从Java中的串口读取文件](https://stackoverflow.com/questions/560328/reading-file-from-serial-port-in-java)

[是否有用于访问串行端口的 Java 库或框架？](https://stackoverflow.com/questions/747539/is-there-java-library-or-framework-for-accessing-serial-ports)

[Windows 上的 Java 串行通信](https://stackoverflow.com/questions/264277/java-serial-communication-on-windows)

参考一些。

[我个人推荐来自http://serialio.com](http://serialio.com)的SerialPort -~~它不是免费的，但对于任何商业项目来说，开发者（无版税）许可费都值得~~。可悲的是，它不再是免版税的，而且 SerialIO.com 似乎已将自己重塑为硬件销售商。我不得不搜索有关 SerialPort 的信息。

根据个人经验，我强烈建议**不要**使用 Sun、IBM 和 RxTx 实现，它们在 24/7 使用中都不稳定。有关详细信息，请参阅我对上述一些问题的回答。公平地说，自从我尝试 RxTx 以来，它可能已经走了很长一段路，尽管 Sun 和 IBM 的实现基本上被放弃了，即使在那时也是如此。

正如@Jodes 评论所建议的那样，[jSSC (Java Simple Serial Connector)](https://code.google.com/p/java-simple-serial-connector/)是一个看起来很有希望并且值得尝试的较新的免费选项。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-23T05:53:24.010

Java 通信 API（也称为 javax.comm）提供对 RS-232 硬件（串行端口）的应用程序访问：[http ://www.oracle.com/technetwork/java/index-jsp-141752.html](http://www.oracle.com/technetwork/java/index-jsp-141752.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-23T06:24:34.037

一个替代方案`javax.comm`是[`rxtx`](http://users.frii.com/jarvi/rxtx/)支持比`javax.comm`.

# .htaccess - .htaccess/mod_rewrite

> ID：900956
> 
> 赞同：0
> 
> 时间：2009-05-23T05:48:25.593
> 
> 标签：.htaccess, mod-rewrite

实际上我想运行`~name/how`而不是`~name/how.php`.

我在 .htaccess 中做了以下更改：

```
# If the requested URI does not contain a period in the final path-part
RewriteCond %{REQUEST_URI} !(.[^./]+)$
# and if it does not exist as a directory
RewriteCond %{REQUEST_fileNAME} !-d
# and if it does not exist as a file
RewriteCond %{REQUEST_fileNAME} !-f
# then add .html to get the actual filename
RewriteRule (.*) $1.php [L] 
```

但它将运行为：

```
~name/~name/how 
```

并且在每次点击链接时，它都会被添加`~name`到 URL ex 中。`http://ip/~name/~name/~name/serach`.

你能告诉我.htaccess 有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T05:50:52.627

您使用的是相对路径，而不是绝对路径。您的页面现在认为您在路径 ~name/ 中。你可以`<base href>`在你的页面中设置。

您可以通过使用“DirectoryIndex index.php”将 /whatever 映射到 /whatever/index.php 来简化这一点

这可能会有所帮助：[如何在不更改相对路径的情况下使用 apache 的 mod_rewrite 重写器](https://stackoverflow.com/questions/144651/how-to-use-apaches-modrewrite-rewriterule-without-changing-relative-paths)

编辑：简短的回答。您应该考虑为您的菜单和 php 包含使用绝对路径，以防止在开始更深地嵌套时出现问题。您的相对路径仅在您有两层深度时才有效（即~laborfa2/search/）

坦率地说，你的链接很乱，所以你很困惑。我强烈建议创建一个非常简单的测试站点来正确组织路径。酌情使用绝对路径和相对路径。删除基本 href，因为它只会让您更加困惑。一旦你运行它，再次尝试重写，记住如果路径深度被重写改变，你的相对路径可能需要更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-26T10:09:16.600

这是一个 URL 解析问题：如果没有其他说明，相对 URL 始终在作为当前资源 URL 的基本 URL 上解析。因此，如果您正在打开`/~name/foo`并且有一个指向的链接`~name/bar`（这只是一个相对 URL 路径！），它将被解析为`/~name/~name/bar`. 但是如果你指向`/~name/bar`，它就不会被解析，因为它已经是一个绝对 URL 路径。

因此，您可以通过使用绝对 URL 路径（以 a 开头`/`）或更改基本 URL（请参阅[BASE HTML 元素](http://www.w3.org/TR/html401/struct/links.html#edef-BASE)）来避免这种情况。但后者将影响任何相对 URL 引用，而不仅仅是那些以相对 URL 路径开头的引用。

# iphone - iPhone：如何在drawRect中换行？

> ID：900964
> 
> 赞同：4
> 
> 时间：2009-05-23T05:52:06.867
> 
> 标签：iphone, uitableview

如何在`drawRect`方法中绘制环绕文本？我正在尝试使用 atebits 的`ABTableViewCell`类来自定义绘制表格视图单元格。我想画一张小图片，然后在它旁边的文字可能需要也可能不需要换行。想想像 Tweetie 这样的 Twitter 客户端中的表格单元格，它显示了个人资料图片和推文。这是怎么做的？

我尝试使用各种`NSString drawAtPoint`方法，但它们似乎没有将文本包装成多行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T06:01:10.097

我认为您需要其中一种`drawInRect:withFont:`方法。它们被记录为执行自动换行。如果您考虑一下，那行不通是有道理的`drawAtPoint`，因为它不知道文本需要适应的矩形。

# php - 如何通过php检查网络服务器上是否存在ssl？

> ID：900984
> 
> 赞同：1
> 
> 时间：2009-05-23T06:06:35.423
> 
> 标签：php

我在课堂上有这个功能：

```
function enable_ssl() {
    if ($_SERVER[HTTPS] != "on") {
        $domain = "https://".$_SERVER['HTTP_HOST'] . "/" . $_SERVER['SCRIPT_NAME'];
        header("Location: {$domain}");
    }
} 
```

问题是当服务器没有安装 SSL 并且我有这个函数启动页面重定向到 404 页面时。我想知道只有当 SSL 安装并工作时，我才能让这个功能工作？

可能吗？

谢谢。

> PS：我做了一些谷歌研究，但找不到很多东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T06:16:25.893

在 *nix 服务器上，您可以尝试解析`netstat -A inet -lnp`监听端口 443 的 Web 服务器的输出。有点笨拙。

我想说，更好的选择是让它成为用户的配置选项。让他们告诉您的应用是否启用了 HTTPS。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T07:24:23.710

两个想法

1.  设置一个到端口 443 的套接字连接并查看它是否连接。
2.  通读 apache 配置文件，看看是否有任何东西在该端口上监听

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-13T16:35:00.553

扩展加载！

[http://php.net/manual/en/function.extension-loaded.php](http://php.net/manual/en/function.extension-loaded.php)

例如

```
if(!extension_loaded('openssl'))
{
    throw new Exception('This app needs the Open SSL PHP extension.');
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T08:20:00.447

您可以尝试使用[curl](http://us.php.net/manual/en/intro.curl.php)连接到服务器。但是，我也会尝试做一个配置选项。如果您使用以下内容，请确保您不会导致无限循环。

```
function ignoreHeader($curl, $headerStr)
{
  return strlen($headerStr);
}

$curl = curl_init("https://example.com/");
curl_setopt($curl, CURLOPT_NOBODY, TRUE);
curl_setopt($curl, CURL_HEADERFUNCTION, 'ignoreHeader');
curl_exec($curl);
$res = curl_errno($curl);

if($res == 0)
{
  $info = curl_getinfo($curl);
  if($info['http_code'] == 200)
  {
    # Supports SSL
    enable_ssl();
  }
}
else
{
  # Doesn't.
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-02T15:33:18.387

我在笔记本电脑上使用 xampp 作为开发服务器。我还没有在 xampp 上建立 SSL 连接。我的生产服务器确实启用了 SSL，并且还具有有效的证书。

我注意到 $_SERVER['HTTPS'] 在我的 xampp 开发服务器上不存在，但在我的生产服务器上存在。

我假设（可能是错误的）如果 $_SERVER['HTTPS'] 未设置，则服务器上未启用 SSL。

```
<?php

if (isset($_SERVER['HTTPS')) echo 'SSL Exists'
else echo 'No SSL'

?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-14T14:00:41.030

我使用了下面的代码

```
$file ="https://mydomain/index.php";        
$file_headers = @get_headers($file);
$DomainName=(!$file_headers || $file_headers[0] == 'HTTP/1.1 404 Not Found')?'http://mydomain':'https://mydomain'; 
```

这基本上检查是否可以通过 HTTPS 找到（访问）文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-15T22:28:16.180

我只是`file_get_contents`用来尝试通过 https 打开同一个文件，如果成功，则强制重定向...

```
 function IsHttps() 
    { 
        return 
            (!empty($_SERVER["HTTPS"]) && (strtolower($_SERVER["HTTPS"])!=="off")) 
            || ($_SERVER["SERVER_PORT"]==443); 
    }

    if (!IsHttps() && extension_loaded("openssl"))
    {
        $target = "https://".$_SERVER["HTTP_HOST"].$_SERVER["PHP_SELF"];
        ini_set("allow_url_fopen", true);
        if (file_get_contents($target)!==false) 
        { 
            header("Location: https://".$_SERVER["HTTP_HOST"].$_SERVER["URL"]); 
            die(); 
        }
    } 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-02-12T19:24:02.340

This is how wordpress does it:

```
<?php
function is_ssl() {
if ( isset($_SERVER['HTTPS']) ) {
return true;
if ( '1' == $_SERVER['HTTPS'] )
return true;
} elseif ( isset($_SERVER['SERVER_PORT']) && ( '443' == $_SERVER['SERVER_PORT'] ) ) {
return true;
}
return false;
}
?> 
```

You can use your validation in between 'return true' stuff! Go to: [http://tutes.in/2012/02/13/check-if-ssl-exists-on-a-webserver-through-php/](http://tutes.in/2012/02/13/check-if-ssl-exists-on-a-webserver-through-php/) for explanation and more detailed source code.

# wpf - 在 MVVM 中，如何将视图逻辑与模型和业务逻辑保持在视图模型之外？

> ID：900991
> 
> 赞同：6
> 
> 时间：2009-05-23T06:10:33.763
> 
> 标签：wpf, mvvm, viewmodel, business-logic

我无法弄清楚如何让视图模型收到模型更改的通知，而无需在我的模型中添加一堆特定于 UI 的东西，例如 INotifyProperyChanged 和 INotifyCollectionChanged，或者创建大量不同的事件并做一堆感觉就像它们是特定于 UI 的，应该远离模型。

否则我只需要复制视图模型中的所有业务逻辑以确保一切都是最新的，那么拥有模型有什么意义呢？

我的模型中的一个棘手问题是“类别”类的属性。你可以把它想象成一个树结构，属性都是叶子节点的后代。那么在模型中，属性是通过它的所有孩子递归生成的，这一切都很好。然而，视图模型需要绑定到该属性并且需要知道它何时更改。我应该更改模型以适应视图模型吗？如果我这样做了，那么此时视图模型实际上并没有做任何事情，模型会引发所有必要的更改通知，并且视图可以直接绑定到模型。此外，如果模型是我没有来源的东西，我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T07:15:04.883

我不同意这一点，`INotifyPropertyChanged`并且`INotifyCollectionChanged`是特定于 UI 的。它们位于未绑定到任何特定 UI 堆栈的命名空间和程序集中。出于这个原因，我通常将这种行为放在系统中尽可能低的位置（通常是数据层）。

如果出于某种原因您不想将其置于该级别，那很好。您可以将其放在更高的级别，例如服务或 UI 层。但是，您需要确保对数据结构的所有更改也通过该层发生。

# netbeans - 检索/恢复已删除的 Netbeans 项目

> ID：900992
> 
> 赞同：41
> 
> 时间：2009-05-23T06:11:02.093
> 
> 标签：netbeans, project, restore, recover

我只是在处理我的 Netbeans 项目，不小心删除了它，不知道如何恢复它。

是否有存储已删除项目的 tmp 文件夹。

还是我永远注定要失败？

谢谢，卢卡斯

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2011-11-18T08:38:53.050

不要恐慌。它很容易。按照步骤：

1.  右键单击文件已被删除的文件夹/目录。

2.  选择本地历史 - 恢复已删除

3.  完毕

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2013-10-02T23:22:34.413

如果不小心删除了 Netbean 上的文件夹，恢复方法如下。您无法恢复已删除的文件夹，但可以恢复已删除的文件。按着这些次序。

1.  重新创建您在 Netbean 项目中删除的文件夹。（您可能无法在 Netbean 中创建文件夹，在这种情况下，您可以使用 mkdir 命令创建文件夹）
2.  右键单击 Netbeans 中的该文件夹，然后转到 History -> revert deleted（您应该看到与该特定文件夹相关的已删除文件的列表。
3.  对每个文件夹和子文件夹重复

注意：我不知道这是否适用于 Windows，我知道它适用于我的 Linux。我也不知道在您关闭 Netbeans 后这是否有效。

希望它可以帮助某人。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-04-11T23:33:16.950

您有在 netbeans 中删除包/目录/文件的问题吗？不要惊慌，这很简单：

1.  打开你的 netbeans IDE
2.  去项目
3.  转到您的项目文件夹所在的包
4.  右键单击它
5.  转到本地历史记录，然后转到还原已删除
6.  它完成了。等一下！

我想它会对你有所帮助。请享受您的代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-23T06:13:33.213

[http://www.recuva.com/](http://www.recuva.com/)

在我第一次开始用Visual C#打开IDE做小程序不保存的时候救了我无数次。您的所有文件都存储在一个临时文件夹中，退出 Visual C# 会擦除它们。只需进行 recuva 扫描并按修改时间对找到的文件进行排序。删除的文件是可恢复的，但覆盖的文件是另一回事，因此请尽快运行该程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-17T13:18:37.680

实际上，尝试加载 netbeans 项目资源管理器中不存在的项目更容易。

如果您在本地仍有文件，只需选择打开项目，您丢失的项目将恢复到 netbeans 的项目资源管理器中。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-07-19T12:16:07.493

不知道有没有临时文件夹。Windows 搜索引擎无法找到它。如果您使用安全删除删除源文件；

在 Netbeans Refactor-Undo[Safely Delete] 选项可用于恢复...*``*******`