# StackOverflow 问答 10693000-10693999

# javascript - 是否有一种可接受的跨平台方法在基于触摸的设备上以标准 Web 表单显示数字键盘？

> ID：10693003
> 
> 赞同：7
> 
> 时间：2012-05-21T21:37:45.113
> 
> 标签：javascript, android, ios, mobile-website, numeric-keypad

**目标**：找到一种跨平台的解决方案，用于在基于触摸的移动设备上显示数字键盘，并且将黑客攻击降至最低。

**问题**：

我有一个使用数据输入表单的常规 Web 应用程序，主要包含数字数据。当用户在移动设备上与我的网站交互时，我想显示一个数字虚拟键盘，因为大多数标准键盘需要第二次按下才能从字母切换到数字。我知道我可以通过设置输入元素的“类型”属性来触发不同的键盘：

`type=number`：这在 iOS/Safari 下效果很好。我不确定平台上的其他浏览器。

在 Android 上，这不会在各种浏览器上始终提升正确的键盘，并且通常会导致输入时出现不需要的电梯按钮。我还没有找到一种干净的方法来在 CSS 中关闭这些。

`type=tel`：这几乎适用于 iOS/Safari，但电话键盘缺少十进制按钮。

似乎在多个 android 浏览器上都能很好地工作，而页面中没有添加任何无关的 UI 元素。

我目前的解决方案是hacky和简单化。基于我已经用于数字验证的类，我将每个应该包含数字的文本元素替换为基于检测到的操作系统/浏览器的a`number`或类型的新输入。`tel`

```
var isAndroid = navigator.userAgent.match(/android/i) ? true : false;
var isIOS = navigator.userAgent.match(/(ipod|ipad|iphone)/i) ? true : false;

if (isAndroid || isIOS) {
    var useNumberType = (isIOS ? true : false); //iOS uses type=number, everyone else uses type=tel
    jQuery("input.num").each(function () {
        var type = (useNumberType ? "number" : "tel");
        var html = this.outerHTML;
        html = html.replace(/(type=\"?)text(\"?)/, "$1" + type + "$2");
        this.outerHTML = html;
    });
} 
```

我宁愿不使用浏览器检测，也不希望在运行时动态更改输入。我可能会在服务器端引入一个 http 模块，它基本上做同样的事情，但实际上并没有更好。对此没有 CSS 调用，我感到很震惊。

有没有更好的方法来获得带有小数点按钮的数字键盘，它适用于所有或大多数基于触摸的移动设备，而无需向页面添加奇怪的 UI 元素？

- - - - - - - 更新

我不认为有一种方法可以做我真正想做的事情，即设置一个可以在桌面浏览器和所有主要的基于移动触摸的平台上正常工作的单一输入样式或类型。我决定通过直接 DOM 调用而不是通过 jQuery 来更改输入的类型，而不是通过 outerHTML 重写整个输入。我怀疑效果上没有太大区别，但代码更简洁一些。由于我没有更改桌面上的输入类型，因此我不必担心 IE 对属性的只读限制。

理想情况下，我可能会在服务器端处理此问题，以便以发出请求的设备所需的格式将所有内容发送到浏览器。但现在新代码看起来更像这样：

```
var isAndroid = navigator.userAgent.match(/android/i) || navigator.platform.match(/android/i) ? true : false;
var isIOS = navigator.userAgent.match(/(ipod|ipad|iphone)/i) ? true : false;

if (isAndroid || isIOS) {
    var useNumberType = (isIOS ? true : false); //iOS uses type=number, everyone else uses type=tel
    jQuery("input.num").each(function () {
        var type = (useNumberType ? "number" : "tel");
        if (this.type == "text") {
            this.type = type;
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:53:53.877

提示：使用移动设备时，不要干扰用户体验。这意味着保持内置键盘不变。

一些用户甚至可能在他们的移动设备/浏览器上禁用了 Javascript！

您应该在这里做的是在浏览器中包含一个 HTML 提示。这样，移动浏览器应该知道他们正在与什么样的内容进行交互。

HTML5 包括几种新的`<input>`内容类型，所有现代移动设备（和大多数现代浏览器）都应支持这些内容类型

[您可以在此处](http://www.w3schools.com/html5/html5_form_input_types.asp)找到完整列表。

您具体想要的是以下内容：

旧代码：

```
Phone number: <input type="text" name="phone" /> 
```

新代码：

```
Phone number: <input type="tel" name="phone" /> 
```

我不知道目前有任何浏览器支持`"tel"`，因此您可以使用以下内容：

```
Phone number: <input type="number" name="phone" min="1000000000" max="9999999999" /> 
```

这有点小技巧，但对您来说是另一种选择。

这是一种更简单、更易于维护的做事方式，对用户来说也更好。

请让我知道，如果你有任何问题。我知道这不是直接回答问题，但在我看来，这是目前更好的做事方式。:)

编辑：

为每个浏览器解决此问题的一种可能方法是使用 JS/Jquery 检查用户代理。我不确定如何执行此操作，但[这里有一个关于如何在 .NET 中执行此操作](http://www.codeproject.com/Articles/34422/Detecting-a-mobile-browser-in-ASP-NET)以及使用 JQuery 更改每个元素的 CSS 的教程。

编辑编辑！：

尝试只修改您的代码：

```
var isAndroid = navigator.userAgent.match(/android/i) ? true : false;
var isIOS = navigator.userAgent.match(/(ipod|ipad|iphone)/i) ? true : false;

if(isIOS)
    $(.phoneInput).attr("type", "tel");
if(isAndroid)
{
    $(.phoneInput).attr("type", "number");
    $(.phoneInput).attr("min", "1000000000");
    $(.phoneInput).attr("max", "9999999999");
} 
```

我希望这一切都有效！您可能需要切换这两个`if`语句，具体取决于您的测试结果。

# objective-c - 从一个文件复制到另一个文件的代码不会生成

> ID：10693005
> 
> 赞同：3
> 
> 时间：2012-05-21T21:38:05.503
> 
> 标签：objective-c, xcode4

我有一些在 UITextView 周围设置边框的代码。它在一个类中正确构建；当我将该代码复制到另一个类（更改对象名称）时，它不再构建，说“在前向类对象'CALayer *'中找不到属性'borderWidth'”（其他两行的相同消息代码）。我做了一个干净的，重建的，没有任何帮助。为什么会这样？我该如何解决？

```
- (void)viewDidLoad  {
[super viewDidLoad];

//--  draw box around notes field
orderNotes.layer.borderWidth = 1.0f;
orderNotes.layer.borderColor = [[UIColor blackColor] CGColor];
orderNotes.layer.cornerRadius = 4; 
```

}

对象“orderNotes”被定义为 UITextView。没有其他错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-21T21:39:51.790

你需要：

```
#import <QuartzCore/QuartzCore.h> 
```

否则，`layer`您将看不到该属性。

# android - 在捆绑包上传递整数和可序列化的问题

> ID：10693007
> 
> 赞同：0
> 
> 时间：2012-05-21T21:38:10.183
> 
> 标签：android, android-intent

我正在尝试传递可序列化和整数或字符串，但在我的子活动中，我只得到可序列化

家长活动

```
Intent intent = new Intent(Class1.this, Class2.class);
Bundle bundle = new Bundle();
bundle.putInt("key", 23);
bundle.putSerializable(serializable, object);
intent.putExtras(bundle);
startActivityForResult(intent, 1); 
```

儿童活动

```
Intent intent = getIntent();
int intKey;
Bundle bundle = intent.getExtras();
object = (Object) bundle.getSerializable(serializable);
intKey = bundle.getInt("key", 0); 
```

我得到了可序列化的对象，但我也无法得到整数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:58:11.713

尝试将 int 直接放在 Intent 上，而不是通过 bundle。意义 ：

```
intent.putExtra("key", 23); 
```

并得到它：

```
intent.getIntExtra("key", 23); 
```

应该管用

但是，如果您有理由想要使用该捆绑包，您可以尝试 Sajmon 在评论中所说的内容，`bundle.getInt("key")`我在某处读到它不一样，我不知道为什么。

# regex - 通过 .htaccess 文件生成动态漂亮的 url

> ID：10693009
> 
> 赞同：0
> 
> 时间：2012-05-21T21:38:14.740
> 
> 标签：regex, .htaccess, friendly-url

我正在尝试通过 .htaccess 生成动态“漂亮的 URL”，这样它就会`http://mysite.com/episode.php?episode=1`变成`http://mysite.com/1`加载 .htaccess 文件时引发 503 错误：

```
Options -Multiviews

RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} !^mysite\.com$
RewriteRule ^(.*) http://mysite.com/$1 [R=301,L]

RewriteRule ^/episode/\(\?:0|\[1-9\]\\d{0,2}\)$ //episode.php?episode=(?:0|[1-9]\d{0,2}) [L] 
```

我似乎无法弄清楚我哪里出错了，也没有真正理解为什么会抛出 503。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T05:48:34.847

```
RewriteRule ^episode/(0|[1-9]\d{0,2})$ /episode.php?episode=$1 [L,QSA] 
```

更多信息`QSA`：[apache.org/docs/current/rewrite/flags.html#flag_qsa](http://httpd.apache.org/docs/current/rewrite/flags.html#flag_qsa)

# asp.net-mvc - 在 FormsAuthentication.SignOut() 上发送 HTTP 标头后，服务器无法修改 cookie

> ID：10693015
> 
> 赞同：1
> 
> 时间：2012-05-21T21:38:55.083
> 
> 标签：asp.net-mvc, forms-authentication

我已将 MVC 应用程序配置为使用表单身份验证。我正在通过调用 LogOff 操作退出用户

```
 public ActionResult LogOff()
    {
        FormsAuthentication.SignOut();

        DropUserInfo();

        return RedirectToUrl(null, "Home", "Index", null);
    } 
```

但是每次代码到达 FormsAuthentication.SingOut() 行时，应用程序都会抛出异常

> 发送 HTTP 标头后服务器无法修改 cookie

什么错误消息说得很清楚，你我不明白，怎么可能在调用 FormsAuthentication.SingOut() 方法时发送了 Http 标头。

所以问题是导致错误的原因，以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T11:05:46.180

在 ActionFilter 中调用 LogOff() 函数之前，我已经启动了 Redirect() 方法调用，这会引发错误。

希望这对其他人有帮助。

# c# - 通过 ajax 在 javascript 中解析 Web 服务响应时出错

> ID：10693022
> 
> 赞同：0
> 
> 时间：2012-05-21T21:39:43.957
> 
> 标签：c#, asp.net, ajax, web-services, response

### 我正在通过一个看起来像的 ajax 调用来调用 Web 服务 -

```
$.ajax({
         cache: false,
         type: 'POST',             
         url: 'renderDisplay.asmx/displayElements',
         dataType: 'json',
         data: object,
         success: function () {
             alert ("success"); },
         error: function (response) {                                    
             alert("error: " +  response.responseText);}
}); 
```

### 我的网络服务功能 -

```
JavaScriptSerializer serializer = new JavaScriptSerializer();
Dictionary<string, string> temp = new Dictionary<string, string>();
temp.Add("boston", "mass");
string json = serializer.Serialize((object)temp);
return json; 
```

### 我得到的错误 -

注意：左括号“<”已放在括号中，否则两行将被视为实际代码

```
error: (<)?xml version="1.0" encoding="utf-8"?>
(<)string xmlns="http://tempuri.org/">{"boston":"mass"}</string> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:44:12.880

在我看来，您的 Web 服务实际上是在返回用 XML 包装的 JSON。

该线程可能会有所帮助：

[ASP.NET JSON Web 服务始终返回包装在 XML 中的 JSON 响应](https://stackoverflow.com/questions/1121559/asp-net-json-web-service-always-return-the-json-response-wrapped-in-xml)

# javascript - 对对象属性的困惑

> ID：10693028
> 
> 赞同：0
> 
> 时间：2012-05-21T21:40:23.173
> 
> 标签：javascript, object, properties

我将对象的属性传递给函数。这个属性恰好是一个数组。

```
object.color[] 
```

无论如何我可以获得该属性所属的对象的名称吗？

我想这样做，而不必将对象和属性都传递给函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:52:37.423

做不到。为什么不只传递对象并访问函数中的属性？

```
var object = {};

object.color = ['red', 'green', 'blue']

doStuff(object);

function doStuff(obj) {
    obj.color.push['purple'];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:48:21.260

不，您必须传递整个对象。为什么需要包含此属性的对象*名称？*你会用它做什么？你知道几个变量可以指向同一个对象，而几个对象可以指向同一个数组吗？

```
var object2.color = object1.color; 
```

当您现在通过`object1`并且`object2`都引用同一个`color`数组时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:48:53.017

不，您不能从属性中获取对象名称。

为什么不传递对象并在函数中获取它的属性？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T21:50:26.090

不，你不能。javascript 对象（在本例中为数组）没有像 DOM 节点那样的“父级”。如果您将对象传递给函数，则该函数将只知道该对象而不会知道其他任何内容。

```
var myob = { color: ["abc", "def"] };
myfunc(myob.color); 
```

等于

```
var myarr = ["abc", "def"];
myfunc(myarr); 
```

等于

```
myfunc(["abc", "def"]); 
```

- 没有区别`myfunc`。

# php - PHP/HTML：PHP 替换 $_FILES 中下划线的点？

> ID：10693039
> 
> 赞同：0
> 
> 时间：2012-05-21T21:41:41.083
> 
> 标签：php, html

> **可能重复：**
> [变量名中的点](https://stackoverflow.com/questions/1057622/dot-in-variable-name)

我有一个带有文件输入的 HTML 表单。该文件将保存为 name 属性中给出的名称，

前任：

```
<input type='file' name='myfile.jpg'> 
```

然后 PHP 会将这个文件保存为`myfile.jpg`

问题是，提交表单时，files var 替换了点“。” 下划线“_”

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:44:25.843

[这是一个有据可查的行为](http://php.net/manual/en/language.variables.external.php)

> 变量名中的点和空格被转换为下划线。例如`<input name="a.b" />`变成 $_REQUEST["a_b"]。

# java - 服务层中的 IllegalArgumentException？

> ID：10693045
> 
> 赞同：2
> 
> 时间：2012-05-21T21:42:31.617
> 
> 标签：java, exception, exception-handling, service-layer

据我了解， IllegalArgumentException 旨在传达编程错误。

如果我正在编写一个基本上通过 Web 服务接受用户输入的服务层，如果 Web 服务传入客户端提供的非法参数，则 IllegalArgumentException不合适，因为这*不是*真正的编程错误？创建我自己的服务级别异常会更好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T02:36:43.960

是的，应该使用 a `RuntimeException`（以及扩展的，an `IllegalArgumentException`）来明确表示发生了编程错误或其他一些意外或不正确的操作。它应该发送一个错误已经被发现的警报，应该通过测试来纠正和验证。

但是根据你的设计如何分配职责，服务层抛出一个`IllegalArgumentException`. 从用例的角度来看，每当您处理用户输入时，您几乎都必须期待无效值并优雅地处理它们。它只是通过用例的一条替代路径，并且绝对会发生的事情，所以不是真正的错误。

但是处理无效的用户输入通常是用户界面的责任，所以网页应该优雅地处理错误的输入并给用户一个纠正的机会（例如在登录尝试期间输入错误的密码） ）。但既然这是意料之中的，这并不是一个例外。关键是用户界面如果能够在发送请求之前确保有效性，则不应向服务器发送无效请求。如果这在用户界面中是可能的，那么服务层抛出一个`IllegalArgumentException`.

回到用户登录的例子，用户界面只能确保输入的数据格式正确；它完全无法保证这些值实际上是正确的。因此，用户界面必须将正确格式化的输入发送到服务层。在这种情况下，我不会从服务层抛出异常，因为格式正确但值不正确是可以预料的。在这种情况下，如果用户界面发送的值格式不正确，我会抛出异常，但如果值只是不正确，则不会。在第二种情况下，我会回复用户界面说值不正确，但我不会抛出异常。

希望这个*长*答案有帮助-

# java - JAX-WS 单元测试

> ID：10693048
> 
> 赞同：2
> 
> 时间：2012-05-21T21:42:38.873
> 
> 标签：java, unit-testing, testing, integration-testing

我有一个独立的 Java 应用程序，它使用 Java JAX-WS 创建服务。我想创建测试用例来测试服务，我该怎么做？

我想过在项目之外使用外部客户端，这是最好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T22:01:56.973

严格来说，部署 Web 服务并对其进行测试是集成测试，而不是单元测试。话虽如此，最好对此进行单元测试。我将创建一个单独的层来实现业务逻辑，以及将其公开为 Web 服务的其他层。然后您可以测试业务逻辑，而不必担心 Web 服务。

毕竟，您可能不想费心重新测试您用来启动 Web 服务的 Web 框架。你真的想测试你的业务逻辑。这将让您创建更快、更不脆弱的测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T22:43:08.403

关于集成与单​​元测试的争论可能会一直持续下去。仅移除 Web 服务层并测试内部业务逻辑不会将集成测试更改为单元测试。

恕我直言，Web 服务是您应用程序的公共 API，您需要它们在您的应用程序版本之间一致地工作。因此，我会推荐一个广泛的soapUI 测试套件，像普通客户端一样访问您的应用程序和数据库。您可以添加断言来检查预期的成功和失败消息（不要忘记测试您的 Web 服务在向它们抛出不正确的数据时会做什么）。您还可以添加 groovy 断言以在每次 Web 服务调用后检查您的数据库状态。

我完全推荐快速运行的单元测试来补充上述内容，但是让一个健壮的集成套件每晚针对你的夜间构建运行将确保你的 API 的质量并避免许多问题，否则这些问题只会在你的客户开始点击时被淘汰部署应用程序后的服务。

Web 服务的本质是它们没有 UI，因此如果留给人类测试人员，则无法进行良好的测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T21:58:32.353

我认为我不会测试实际的 Web 服务端点或客户端。我会将所有业务逻辑移动到某个服务层，然后对这些对象进行单元测试。例如：

```
 @Path("/user")
 public class UserWebService {

   @Inject
   private UserService userService;

   @Path("/delete")
   public void deleteUser(@RequestParam long id) {
      userService.deleteUser(id);
   }

 } 
```

然后我将对我的 UserService 实现进行单元测试。

# objective-c - 什么是与 Objective-C 相关的便利初始化程序？

> ID：10693052
> 
> 赞同：1
> 
> 时间：2012-05-21T21:42:49.980
> 
> 标签：objective-c, initialization, lazy-initialization

我大约 8 个月前开始学习编程，从 C、OOP 开始，现在到 iOS，这是我的目标。在大多数情况下，一切都很顺利，我已经开始通过在 xcode 上编写小型应用程序来练习。只是像便利初始化器这样的小术语有时会让我失望。任何人都可以为我定义这个术语，并给我一个简单的例子来说明它的用法吗？我了解分配和初始化的概念，但我无法区分初始化程序和便利初始化程序。我在网上看过，但运气不太好。

任何帮助表示赞赏，谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T22:03:51.543

基本上，便利初始化器/构造器是一个类（静态/非成员）方法，它返回一个类的实例。

这意味着，为了获取类的实际实例，您可以使用便利构造函数（或初始化程序）（如果提供），而不是显式分配对象。

它将取代标准`alloc`/ `init`（或`initWith...`）方式。

**但...**

在内存管理方面，它有着完全不同的含义！

**您不拥有**便利构造函数返回的对象。
这意味着您不必自己释放它。

例如，当您分配 a 时`NSMutableArray`：

```
NSMutableArray * a = [ [ NSMutableArray alloc ] initWithCapacity: 10 ]; 
```

你调用了alloc。这意味着您必须释放该对象，因为您**拥有**它：

```
NSMutableArray * a = [ [ NSMutableArray alloc ] initWithCapacity: 10 ];

/* Some stuff here... */

[ a release ]; 
```

便利构造函数不是这种情况，因为对象将被自动释放（它会自动放置在当前的自动释放池中）：

```
NSMutableArray * a = [ NSMutableArray arrayWithCapacity: 10 ];

/* Some stuff here... */
/* No need to release the array! */ 
```

基本上，这就是`arrayWithCapacity`便利构造函数的`NSMutableArray`作用：

```
+ ( NSMutableArray * )arrayWithCapacity: ( NSUInteger )capacity
{
    return [ [ [ NSMutableArray alloc ] initWithCapacity: capacity ] autorelease ];
} 
```

**注意最后对自动释放**的调用吗？
这意味着该对象将在当前运行循环结束时自动释放，因此您不必自己做（当然，如果您不明确保留它）。

**最后说明**

你没有提到你是否使用**ARC**。
我以为不是这样的。

当然，如果你使用**ARC**，这是完全不同的，因为保留/释放是自动完成的（大部分时间），基于变量限定符（强/弱）。

但即使使用**ARC**，您也应该知道引用计数是如何工作的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-20T15:11:39.093

我有同样的疑问，但现在解决了：[https ://developer.apple.com/library/ios/documentation/general/conceptual/devpedia-cocoacore/MultipleInitializers.html](https://developer.apple.com/library/ios/documentation/general/conceptual/devpedia-cocoacore/MultipleInitializers.html)

注意：如果上述链接失败，请阅读此备份：[https ://gist.github.com/JeOam/9116926](https://gist.github.com/JeOam/9116926)

# c - 8051 中的代码优化

> ID：10693053
> 
> 赞同：1
> 
> 时间：2012-05-21T21:42:50.897
> 
> 标签：c, microcontroller, 8051, keil

所以，我必须完成这个挑战，即为一个 8051 微控制器实现一个摄像头监控系统。

这些是规格：

1.  每个摄像机都与一个运动传感器相关联，每次检测到运动时，该摄像机的记录都会被注册并保存。如果传感器超过 5 秒没有捕捉到任何动作，则此摄像机将不再被记录；

2.  如果没有摄像头，录像机必须处于“暂停”状态；

3.  如果打开了多个摄像机，则必须使用多路复用器（mux）以某种方式选择摄像机信号，以便在 3 秒内记录每个摄像机。这样，必须在 3 秒内记录所有活动的摄像机。如果只有一台摄像机处于活动状态，则它的信号必须是多路复用器中唯一的一台。

我已经在下面的代码中完成了这一点。而我们现在要做的就是在没有编译器优化的情况下优化代码的大小。代码现在是 198 字节，但我试图低于 180 字节。

可能吗？我已经尝试进行#define 的计算，但编译器已经为我优化了它。

```
#include <REG51F.h>

#define TIMEOUT 50
#define TIMEOUT_REC 30

#define FrClk 12000000
#define FreqTimer0_emHz 10
#define VALOR_TH0 ((65536 - (FrClk /(12 * FreqTimer0_emHz ))) >> 8)
#define VALOR_TL0 ((65536 - (FrClk /(12 * FreqTimer0_emHz ))) & 0xFF)

data bit PAUSE_INT;
data bit PAUSE_TMP;
sbit PAUSE = P0^0;
sbit SENSOR1 = P0^1;
sbit SENSOR2 = P0^2;
sbit SENSOR3 = P0^3;
sbit SENSOR4 = P0^4;
sbit MUX0 = P0^5;
sbit MUX1 = P0^6;

data unsigned char CAM[4];
data unsigned char REC;
data unsigned char index;
data unsigned char count;

void timer0_int (void) interrupt 1 using 2 {
    for (index = 0; index < 4; index++)
        if(CAM[index])
        CAM[index]--;

    if (!PAUSE_INT && REC)
        REC--;
    else
    { 
         REC = TIMEOUT_REC;
         index = (index + 1) & 0x03;
         for (count = 0; !CAM[index] && count < 4; index = (index + 1) & 0x03, count++);

         MUX0 = index & 0x1;
         MUX1 = index & 0x2;

         PAUSE_INT = 0;
    }   
}

int main(void)
{

    PAUSE_TMP = 1;
    PAUSE_INT = 0;

    index = 0;

    //timer0_init
    EA = 1;
    TR0 = 0;              
    TMOD = (TMOD & 0xF0) | 0x01;  
    TH0 = VALOR_TH0;  
    TL0 = VALOR_TL0;
    ET0 = 1;     
    TR0 = 1;     

    while(1) {

        if (SENSOR1)
        {
                CAM[0] = TIMEOUT;
        }

        if (SENSOR2)
        {
                CAM[1] = TIMEOUT;
        }

        if (SENSOR3)
        {
                CAM[2] = TIMEOUT;
        }

        if (SENSOR4)
        {
                CAM[3] = TIMEOUT;
        }

        if (CAM[0] || CAM[1] || CAM[2] || CAM[3])
        {
                if (PAUSE_TMP)
                        PAUSE_INT = 1;
                PAUSE_TMP = 0;
        }
        else {
                PAUSE_TMP = 1;
        }

            PAUSE = PAUSE_TMP;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T04:05:56.123

您可能必须查看为此生成的汇编代码，以便从中提取最后几个字节。通过重用变量或组合操作，可能会在这里和那里刮掉一些。生成的代码不会很漂亮——或可维护——但它可能会让你低于你的临界值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:01:50.200

我认为开关盒而不是 if(sensor1,2,3,4) 可以帮助一些。

# c# - VS 2010 调试

> ID：10693055
> 
> 赞同：0
> 
> 时间：2012-05-21T21:42:58.937
> 
> 标签：c#, visual-studio-2010, visual-studio, debugging, pdb

.pdb 文件是否足以调试和单步执行 dll 的代码？还是真的要参考对应的项目源码？

我尝试使用同一目录中的 .pdb 文件引用 dll，但无法进入 dll 的代码。所以我想知道 dll 和 .pdb 文件的规则在哪里。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:46:17.123

.pdb 文件将允许您进行调试，但它不会提供任何源。查看此博客文章，了解 PDB 文件及其用途的精彩描述。

[http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/05/11/pdb-files-what-every-developer-must-know.aspx](http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/05/11/pdb-files-what-every-developer-must-know.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:49:12.913

PDB 文件是 Visual Studio 如何知道程序集中的执行代码如何与源代码中的行相对应的。您的问题的答案是肯定的，Visual Studio 需要构建相应 pdb 的源代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:49:05.950

pdb 不包含打包在其中的源代码（[它可以](http://www.codeproject.com/Articles/245824/Sourcepack-indexing-PDB-files-with-source-archive)，但它有点 hack 并且没有多少人这样做），但是如果符号服务器有可用的源代码，它应该会自动下载它。但是，pdb 必须与您正在使用的 dll 的确切版本匹配，才能下载源代码。

我有一点怀疑，您正在尝试执行 .NET 框架源代码单步执行，但它没有介入。Microsoft 尚未使用 pdb 文件的当前版本更新符号服务器，因此如果您正在运行最新版本的 .net（至少在它们发布新版本的源文件之前），源步进将被破坏。

# jquery - 如何循环两次 jquery.cycle() 幻灯片

> ID：10693056
> 
> 赞同：1
> 
> 时间：2012-05-21T21:43:04.237
> 
> 标签：jquery, cycle

我正在使用 jquery.cycle() 没有问题>

但是，我的老板要我循环浏览幻灯片两次，然后在第一张幻灯片上停下来。

我可以看到自动停止可以循环一次。但是如何指定幻灯片循环播放两次呢？

可以做到吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:45:57.997

使用`autostopCount`：http: [//jquery.malsup.com/cycle/options.html](http://jquery.malsup.com/cycle/options.html)

```
autostop:0,     // true to end slideshow after X transitions (where X == slide count) 
autostopCount: 0,     // number of transitions (optionally used with autostop to define X) 
```

另一种选择，如果这不能像我认为的那样工作：

```
$(document).ready(function(){
    var index = 1;
    var interval = setInterval(function(){
        $('#slideshow').cycle('next');
        index++;
        if(index == cycleLength*2) {
            clearInterval(interval);    
        }
    }, 1000);
}); 
```

你必须`cycleLength`自己提供。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T15:14:49.457

为了解释以前的答案，在 X 转换后的第一张幻灯片上停止的实际代码[http://jsfiddle.net/lucuma/LKUyg/](http://jsfiddle.net/lucuma/LKUyg/)：

```
var numberReptitions = 2;

$('#slideshow').cycle(
    {
        autostop:1,     // true to end slideshow after X transitions (where X == slide count) 
        autostopCount: ($('#slideshow').children().length*numberReptitions)+1
});​ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T22:13:22.053

添加到 Little Big Bot，

您可以通过根据所需逻辑检查“之后”事件来暂停循环

```
var numberOfImages = 3;var counter=0;
after: function(currSlideElement, nextSlideElement, options, forwardFlag)   {
    counter++;
    if(counter > numberOfImages*2) 
        $('#slideshow').cycle('pause');
} 
```

# sql - 两个表 SQL 查询基于查询中的一个字段，同时从另一个表中提取

> ID：10693058
> 
> 赞同：0
> 
> 时间：2012-05-21T21:43:12.457
> 
> 标签：sql, powershell, ms-access-2007

好的，这听起来可能有点奇怪，但这是我必须处理的。

我有一个特殊的安装程序，它将利用 powershell 对 access 2007 数据库进行查询

第一个表是程序列表。表中的一列是 prog_pre，它表示程序在安装之前必须安装一些东西

pre_req 表有一个名为 prog_id 的列，它是需要先安装另一个程序的特定程序的唯一 ID。它还有 prog_pre 列，它引用程序表中的唯一 ID。

我想要做的是当我执行类似的查询时

```
 Select * 
 from program_table 
 WHERE ID = '3' 
```

程序 3 是 barware 有一个 pre_req 所以我希望它也循环通过 pre_req 表获取预需要程序的 ID 并将其添加到查询中。

有没有办法做到这一点，或者我只是坚持执行两个查询？

### 节目表

```
-------------------------------------------------- -------------
ID prog_name prog_version prog_pre
1 访问 2007 否
2 Acrobat 2012 专业版 否
3 酒具 2012 是
4 Fooware 2012 否
5 foomaker 2012 否
-------------------------------------------------- --------------

```

### pre_req 表

```
-------------------------------------------------- --------------
id prog_id prog_pre
1 3 4
2 3 5

```

```
所需的结果将是一个数组，如下所示
3 酒具 2012 是
4 Fooware 2012 否
5 foomaker 2012 否

```

由于字段 prog_pre 是 yes，它还包括 pre_Req 表中列出的两个 prog_pre 程序 id

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T11:58:49.760

在阅读了 X-Zero 的评论后

> Blockquote 如果有最大级别数，您可以手动完成。否则，你会被程序代码困住。我已经看到提到 Access 不支持递归查询，这正是您想要的。- X-Zero

我做了一些进一步的研究，发现我想要的确实是一个递归查询。我还发现 X-Zero 是正确的。Access 不支持递归查询。

[是否可以在 Access 中创建递归查询？](https://stackoverflow.com/questions/763016/is-it-possible-to-create-recursive-query-in-access)

感谢您的帮助 X-Zero

# character-encoding - 排除 DOCTYPE、字符集等有多糟糕？

> ID：10693064
> 
> 赞同：3
> 
> 时间：2012-05-21T21:43:44.537
> 
> 标签：character-encoding, doctype

简单的问题，只是有点好奇，因为我个人觉得必须在每个网页上都包含这些内容很烦人。

不包括这些行：

```
<!DOCTYPE html>
<meta charset="utf-8"> 
```

真的会损坏您的网页吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T04:21:22.347

这取决于。忽略其中一个或两个可能没有效果，或者它可能完全破坏页面，或者它可能会改变它的外观（从几乎不引人注意到剧烈的任何东西），或者它可能会在某些浏览器上改善它。

省略`<!DOCTYPE html>`通常会将浏览器置于[Quirks Mode](http://www.cs.tut.fi/~jkorpela/quirks-mode.html)，这实际上只是浏览器（不同地）尝试模仿旧的损坏浏览器的大量功能集合的一个词。对于新页面，这通常很糟糕。对于为在那些旧浏览器上工作而编写的旧页面，Quirks Mode 可能是必需的。

假设页面实际上是 UTF-8 编码的，省略`<meta charset="utf-8">`可能会使浏览器在字符级别上完全错误地解释其内容，从而可能导致灾难。更多的时候，省略没有效果，因为浏览器会从 HTTP 标头（如果信息存在，它应该），或者从前导字节顺序标记（如果存在），或者通过启发式分析（即基于猜测）推断编码数据的实际内容）。并且大量的 UTF-8 编码页面只包含 Ascii 字符，使得字符编码问题主要是学术性的。

如果页面实际上不是 UTF-8 编码的，那么`<meta charset="utf-8">`当然不应该使用。不过，省略它并不一定能节省时间。在这种情况下，您应该用`utf-8`正确的编码名称替换，或者将实际数据的编码更改为 UTF-8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:57:33.850

在实践中，不，它不会损坏您的网页。有数百万页没有这些说明符。此外，由于文档类型通常包含在服务器上的 mime-type 中，并且如果不是所有客户端都默认为正确的类型，如果不是自动检测它，那么确实没有令人信服的理由来包含这些额外的字节。

现在，如果您正在使用某种需要这些的网页设计师解决方案或内容管理软件，那么答案可能会有所不同。

编辑：我想我应该澄清一下，如果您使用较新的 HTML 功能（即 HTML5），您至少应该在其中拥有基本的 html 文档类型。但是您的问题是它会损坏您的网页，并且对于许多网页（尤其是不使用高级功能的简单网页），如果您排除文档类型，它根本不会损坏您的页面。正如另一个提到的，由于 UTF-8 是默认编码，它也不应该重要。

# google-apps-script - 需要一个脚本来发送电子邮件而不重新发送给以前记录的发件人

> ID：10693065
> 
> 赞同：0
> 
> 时间：2012-05-21T21:43:55.173
> 
> 标签：google-apps-script

我正在使用从现有 sendEmail 脚本修改的下面的脚本。我正在从 Google 表单中收集信息，并希望在每次“提交”时发送电子邮件。我遇到的问题是脚本会发送到电子表格的每一行，即使该信息已经发送。我需要脚本以某种方式标记已发送的行，以便无法重新发送信息。我的“新手”解决方法是在发送后将电子邮件地址更改为我的电子邮件地址。我过滤了我的收件箱以自动删除这些电子邮件。这是我的粗略解决方案，但我希望它能够正常工作。请问有什么建议吗？

```
 var EMAIL_SENT = "EMAIL_SENT";

    function sendEmails() {
      var ss = SpreadsheetApp.getActiveSpreadsheet();
      var dataSheet = ss.getSheets()[0];
      var dataRange = dataSheet.getRange(2, 1, dataSheet.getMaxRows() - 1, 17);

      var templateSheet = ss.getSheets()[1];
      var emailTemplate = templateSheet.getRange("A1").getValue();

  // Create one JavaScript object per row of data.
  objects = getRowsData(dataSheet, dataRange);

  // For every row object, create a personalized email from a template and send
  // it to the appropriate person.
  for (var i = 0; i < objects.length; ++i) {
    // Get a row object
        var rowData = objects[i];

    // Generate a personalized email.
    // Given a template string, replace markers (for instance ${"First Name"}) with
    // the corresponding value in a row object (for instance rowData.firstName).
        var emailText = fillInTemplateFromObject(emailTemplate, rowData);
        var emailSent = rowData[4];
        if (emailSent != EMAIL_SENT) {
          var emailSubject = "CCSS Walkthrough";
          MailApp.sendEmail(rowData.emailAddress, emailSubject, emailText);
          var startRow = 2;
          var sheet = SpreadsheetApp.getActiveSheet();
          sheet.getRange(startRow + i, 2).setValue("myemailaddress");
          SpreadsheetApp.flush ();
    }
   } 
}

// Replaces markers in a template string with values define in a JavaScript data object.
// Arguments:
//   - template: string containing markers, for instance ${"Column name"}
//   - data: JavaScript object with values to that will replace markers. For instance
//           data.columnName will replace marker ${"Column name"}
// Returns a string without markers. If no data is found to replace a marker, it is
// simply removed.
    function fillInTemplateFromObject(template, data) {
      var email = template;
  // Search for all the variables to be replaced, for instance ${"Column name"}
      var templateVars = template.match(/\${\"[^\"]+\"\}/g);

  // Replace variables from the template with the actual values from the data object.
  // If no value is available, replace with the empty string.
      for (var i = 0; i < templateVars.length; ++i) {
    // normalizeHeader ignores ${"} so we can call it directly here.
        var variableData = data[normalizeHeader(templateVars[i])];
        email = email.replace(templateVars[i], variableData || "");
  }

      return email;
}

//////////////////////////////////////////////////////////////////////////////////////////
//
// The code below is reused from the 'Reading Spreadsheet data using JavaScript Objects'
// tutorial.
//
//////////////////////////////////////////////////////////////////////////////////////////

// getRowsData iterates row by row in the input range and returns an array of objects.
// Each object contains all the data for a given row, indexed by its normalized column name.
// Arguments:
//   - sheet: the sheet object that contains the data to be processed
//   - range: the exact range of cells where the data is stored
//   - columnHeadersRowIndex: specifies the row number where the column names are stored.
//       This argument is optional and it defaults to the row immediately above range; 
// Returns an Array of objects.
    function getRowsData(sheet, range, columnHeadersRowIndex) {
      columnHeadersRowIndex = columnHeadersRowIndex || range.getRowIndex() - 1;
      var numColumns = range.getEndColumn() - range.getColumn() + 1;
      var headersRange = sheet.getRange(columnHeadersRowIndex, range.getColumn(), 1,       numColumns);
      var headers = headersRange.getValues()[0];
      return getObjects(range.getValues(), normalizeHeaders(headers));
}

// For every row of data in data, generates an object that contains the data. Names of
// object fields are defined in keys.
// Arguments:
//   - data: JavaScript 2d array
//   - keys: Array of Strings that define the property names for the objects to create
    function getObjects(data, keys) {
      var objects = [];
      for (var i = 0; i < data.length; ++i) {
        var object = {};
        var hasData = false;
        for (var j = 0; j < data[i].length; ++j) {
          var cellData = data[i][j];
          if (isCellEmpty(cellData)) {
            continue;
      }
      object[keys[j]] = cellData;
      hasData = true;
    }
    if (hasData) {
      objects.push(object);
    }
  }
  return objects;
}

// Returns an Array of normalized Strings.
// Arguments:
//   - headers: Array of Strings to normalize
    function normalizeHeaders(headers) {
      var keys = [];
      for (var i = 0; i < headers.length; ++i) {
        var key = normalizeHeader(headers[i]);
        if (key.length > 0) {
          keys.push(key);
    }
  }
  return keys;
}

// Normalizes a string, by removing all alphanumeric characters and using mixed case
// to separate words. The output will always start with a lower case letter.
// This function is designed to produce JavaScript object property names.
// Arguments:
//   - header: string to normalize
// Examples:
//   "First Name" -> "firstName"
//   "Market Cap (millions) -> "marketCapMillions
//   "1 number at the beginning is ignored" -> "numberAtTheBeginningIsIgnored"
    function normalizeHeader(header) {
      var key = "";
      var upperCase = false;
      for (var i = 0; i < header.length; ++i) {
        var letter = header[i];
        if (letter == " " && key.length > 0) {
          upperCase = true;
          continue;
    }
        if (!isAlnum(letter)) {
          continue;
    }
        if (key.length == 0 && isDigit(letter)) {
          continue; // first character must be a letter
    }
        if (upperCase) {
          upperCase = false;
          key += letter.toUpperCase();
    }     else {
          key += letter.toLowerCase();
    }
  }
  return key;
}

// Returns true if the cell where cellData was read from is empty.
// Arguments:
//   - cellData: string
    function isCellEmpty(cellData) {
      return typeof(cellData) == "string" && cellData == "";
}

// Returns true if the character char is alphabetical, false otherwise.
    function isAlnum(char) {
       return char >= 'A' && char <= 'Z' ||
        char >= 'a' && char <= 'z' ||
        isDigit(char);
}

// Returns true if the character char is a digit, false otherwise. 
    function isDigit(char) {
      return char >= '0' && char <= '9';
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T01:40:29.297

因为您要做的是：“*我正在从 Google 表单中收集信息，并希望在每次“提交”时发送电子邮件。* ”您甚至不必访问电子表格即可发送您想要发送的信息。电子表格实际上将存储表单提交随附的信息，但您不必返回电子表格将数据发送到提交时的电子邮件。您可以改为编写一个在表单提交时触发的函数，它将表单提交作为一个事件接收，并从那里获取相关数据并将其发送到所需的电子邮件地址。我在这里包含一个演示代码，请查看评论以获取更多详细信息。

```
function onFormSubmit(event) { //On form submission send an email to the approver.
 var sheet = SpreadsheetApp.getActiveSheet();
     //Get values that have to be put on the email.
     //event.values[index] is indexed in the same order that form values are ordered        on the spreadhseet
var formVal1 = event.values[0]; 
var formVal2 = event.values[1];
.
.
.
.
. 
var  formValN = event.values[N];
//Setting the message that goes on the email sent to the approver.
var message = 'This message has the following information from the form submit: '+ formVal1+'blah blah' + formVal2+...........+formValN;
//Title for the mail sent.
var title = 'New Submission';
//Email address the email is sent to.
var mailAdd = 'example@receiveemail.com' //this could be an array for multiple recipients.
//Sending Email.   
MailApp.sendEmail(mailAdd, title, message);
} 
```

编写完此脚本后，您必须转到**Resources>Current script's triggers**。这样就可以从表单提交上的电子表格触发您的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:21:23.017

最好的方法是添加一列并将其标记为 email_sent，然后在发送时将其过滤掉。

[本教程](https://developers.google.com/apps-script/articles/sending_emails)的[第 2 节](https://developers.google.com/apps-script/articles/sending_emails#section2)正是您想要完成的工作。

此方法允许您保留提交表单的人的电子邮件地址。

# mysql - 如何处理 SQL 条件子句中的 null？

> ID：10693066
> 
> 赞同：1
> 
> 时间：2012-05-21T21:43:59.387
> 
> 标签：mysql, sql, null

我最近发现，如果值 where ，查询将无法对我的某些记录起作用`null`。显然在 SQL 中，`null`不能与任何东西相比——甚至`null`.

```
UPDATE company SET views = IF(views, views + 1, 1),
trendingViews = IF(viewed != '2012-05-21 00:00:00', 1, trendingViews + 1),
viewed = IF(viewed != '2012-05-21 00:00:00', '2012-05-21 00:00:00', viewed)
WHERE id = '3024' 
```

如何更改此查询以有条件地检查提供的值和`null`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T21:47:39.290

使用`Coalesce(value1, ... valueN)`或`isnull(value1, value2)`为空字段定义替代的非空值。

`Coalesce`将返回参数列表中的第一个 NON-NULL 值。`Isnull`如果第一个为空，将返回第二个参数值

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:46:45.280

使用合并：

```
UPDATE company 
SET views = COALESCE(views, 0) + 1,
    trendingViews = IF(viewed != '2012-05-21 00:00:00', 1, trendingViews + 1),
    viewed = IF(viewed != '2012-05-21 00:00:00', '2012-05-21 00:00:00', viewed)
WHERE id = '3024' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T21:53:19.473

除了给出的其他答案，您还可以使用`NULL`-safe 比较运算符[`<=>`](http://dev.mysql.com/doc/en/comparison-operators.html#operator_equal-to)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T21:46:09.307

检查 null 的正确方法是`MyField IS NULL`. 正如您正确指出的那样，直接比较`null`是行不通的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-21T21:46:19.603

如果要排除 a`column`不为空的结果，则需要`is not null`在 where 子句中使用：

```
select ...
where ...
and column is not null 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-21T23:06:10.297

警告：我不是 mysql 人，而是 TSQL 人。首先，对您的一个条件更新语句的一般逻辑进行评论：当您第一次检查“已查看”以获取特定值时，如果“已查看”不是该值，则将其设置为该值，您比必要的。

我的意思是，如果您知道您希望 ID 为 3024 的所有记录对“已查看”列具有相同的时间戳，然后，首先检查列中的任何值并仅更新那些不匹配的值，不需要，额外的工作也是如此。如果您的意图是所有“已查看”（其中 Id = '3024'）都应设置为“2012-05-21 00:00:00”，那么只需将它们设置为该值。无需考虑它们的原始价值是什么......你不在乎。

所以而不是：

```
viewed = IF(viewed != '2012-05-21 00:00:00', '2012-05-21 00:00:00', viewed) 
```

您将拥有：

```
viewed = '2012-05-21 00:00:00' 
```

其次，您可以在 if 语句中使用“或”和/或“合并”，这样空值就不会被忽略。通过将 OR 与 IS NULL 结合使用和/或与非空默认值合并，您可以强制更新任何空值。（在您的特定示例中，使用默认值为 0 的合并，将具有将“trendingViews”列中的先前空值设置为 1 的效果，因为您递增 1，并且您将使用 0 作为默认值对于空实例。）

例子：

```
trendingViews = IF(viewed IS NULL = 1 OR viewed != '2012-05-21 00:00:00', 1, COALESCE(trendingViews, 0) + 1), 
```

更新语句的第一行...设置“视图”的部分让我感到困惑，因为我不知道您的意图是检查名为“视图”的列/字段是否存在，或者您是否试图检查该“视图”列中的值是否为非空。如果您的目标是检查它是否不为空，然后在这种情况下将其增加 1，如果它为空，则将其设置为 1，那么可以这样做：

```
 views = IF(views IS NULL != 1, views + 1, 1), 
```

所以这是我要测试的整个语句（在 MYSQL 中）：

```
UPDATE company SET 
    views = IF(views IS NULL = 0, views + 1, 1),
    trendingViews = IF(viewed IS NULL = 1 OR viewed != '2012-05-21 00:00:00', 1, COALESCE(trendingViews, 0) + 1), 
    viewed = '2012-05-21 00:00:00'
WHERE id = '3024'; 
```

请记住，我不使用 MYSQL .... 没有测试过这些 MYSQL 更改。如果我在 TSQL 中执行此操作，则以下语句将起作用：

```
 UPDATE company SET 
        [views] = (CASE WHEN [views] IS NOT NULL THEN [views] + 1 ELSE 1 END),
        trendingViews = CASE WHEN viewed IS NULL OR viewed != '2012-05-21 00:00:00' THEN 1 ELSE COALESCE(trendingViews, 0) + 1 END, 
        viewed = '2012-05-21 00:00:00'
    WHERE id = '3024';
    go 
```

# nhibernate - nHibernate queryover 多对多子查询

> ID：10693070
> 
> 赞同：1
> 
> 时间：2012-05-21T21:44:12.133
> 
> 标签：nhibernate, subquery, queryover

我的数据库中有三个表

1.  约会（ID，BunchOfFields）
2.  AppointmentAttendee (AppointmentId,ContactId)
3.  联系人（Id、ContactFields）

约会可以有 1 个或多个只是联系人的参加者。我有这些映射：

```
<class name="Appointment">
    <set name ="Attendees" table="AppointmentAttendee">
      <key column="AppointmentId"></key>
      <many-to-many class="Cutter.Domain.Contact" column="ContactId"/>

    </set>
</class> 
```

我需要获得所有约会（与所有与会者），这些约会具有特定的联系人，并且在特定的时间范围内开始。到目前为止，我有：

```
 CurrentSession.QueryOver<Appointment>()
            .Where(a=>a.StartDate>=start && a.StartDate<=end) 
```

我需要的基本上是这个 SQL Query

```
SELECT * 
FROM Appointment a
LEFT JOIN OtherTables....
WHERE EXISTS (SELECT * FROM AppointmentAttendee att WHERE a.Id=att.AppointmentId and att.ContactId=?) 
```

**编辑**
到目前为止，我想出了这个：

```
 var list=CurrentSession.QueryOver<Appointment>(() => appt)
                    .JoinAlias(()=>appt.Work, ()=>work)
                    .Where(a => (a.StartDate >= start && a.StartDate <= end) 
                     &&   work.Status==WorkStatus.Active )
                                           .JoinQueryOver<Contact>(a => a.Attendees)
                    .Where(u => u.Id == assignedTo)

                    .List<Appointment>(); 
```

但我相信这是加入与与会者的约会，并将限制我回来的与会者。

**编辑**
一些更多的实验让我明白了这一点。（注意一些对象从联系人更改为用户，但仍然是同样的问题）

```
 Appointment appt=null;
        WorkBase work=null;

        var subQuery = QueryOver.Of<Appointment>()
            .JoinQueryOver<User>(a => a.InternalAttendees)             
            .Where(u => u.Id == assignedTo)
            .SelectList(a => a.Select(c=>c.Id));

        var list=CurrentSession.QueryOver<Appointment>(() => appt)
            .JoinAlias(()=>appt.Work, ()=>work)
            .Where(a => (a.StartDate >= start && a.StartDate <= end)
                && work.Status==WorkStatus.Active )            
            .WithSubquery.WhereExists(subQuery)              
            .List<Appointment>(); 
```

现在我得到了子查询，但是如何将子查询连接到父查询。（需要子查询来引用外部约会ID）

如果我可以这样做而不必在子查询中加入实体表，当我需要的所有数据都在关联表中时，必须加入三个表似乎是错误的，这将是很好的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T12:34:24.730

只需在引用别名的子查询中添加一个子句 (Where(a => a.Id == appt.Id))：

```
 Appointment appt=null;
    WorkBase work=null;

    var subQuery = QueryOver.Of<Appointment>()
        .Where(a => a.Id == appt.Id) // restrict it to Appointment in outer query
        .JoinQueryOver<User>(a => a.InternalAttendees)             
        .Where(u => u.Id == assignedTo)             
        .SelectList(a => a.Select(c=>c.Id));

    var list=CurrentSession.QueryOver<Appointment>(() => appt)
        .JoinAlias(()=>appt.Work, ()=>work)
        .Where(a => (a.StartDate >= start && a.StartDate <= end)
            && work.Status==WorkStatus.Active )            
        .WithSubquery.WhereExists(subQuery)              
        .List<Appointment>(); 
```

# java - 移动背景安卓

> ID：10693075
> 
> 赞同：1
> 
> 时间：2012-05-21T21:44:28.417
> 
> 标签：java, android, loops, background

我正在创建一个带有移动位图背景的 android 游戏。背景应该是一张简单的空间图片，可以无限移动（它会循环）。我不知道如何做到这一点，任何帮助将不胜感激。

顺便说一句，我正在使用一个扩展 GameView 并实现 SurfaceHolder.Callback 的主类，并且我已经有一个游戏循环线程。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-24T13:15:23.573

```
 super.onDraw(c);
    bgx = bgx - 5;
    int newFarX = background.getWidth() - (-bgx);
    // if we have scrolled all the way, reset to start
    if (newFarX <= 0) {
        bgx = 0;
        // only need one draw
        c.drawBitmap(background, bgx + 10, 100, null);
    } else {
        // need to draw original and wrap
        c.drawBitmap(background, bgx + 10, 100, null);
        c.drawBitmap(background, newFarX, 100, null);
        // bgr.setPixel(0, background.getWidth(), (Integer) null);
        c.drawBitmap(bgr, bgx + 10, 100, null);
        c.drawBitmap(bgr, newFarX, 100, null);
    }
    // c.drawBitmap(jump, 100, 400, null);
    // objectSprite.setPosition(x, y);
    objectSprite.paint(c);
    // c.drawBitmap(canv1, 0, 200, null);

    objectSprite.nextFrame();
    invalidate(); 
```

# windows - 重命名文件扩展名 - 顽固遗留下来

> ID：10693078
> 
> 赞同：0
> 
> 时间：2012-05-21T21:44:32.520
> 
> 标签：windows, batch-file

我正在重命名文件扩展名：

> 1.txt 到 1.txt.new
> 
> 2.txt 到 2.txt.new

现在我正在尝试运行命令：

```
ren *.txt.new *.txt 
```

但是，我现在看到：

> 1.txt.txt
> 
> 2.txt.txt

如何重命名或仅删除该 .new 扩展名？重命名并没有削减它的样子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:50:10.770

这个命令应该可以解决问题：

```
for %i in (*.txt.new) do @rename "%i" "%~ni" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T07:47:09.033

这应该有效：

```
RENAME *.txt.new *. 
```

# sql - SQL 从父类型检索数据

> ID：10693080
> 
> 赞同：1
> 
> 时间：2012-05-21T21:44:46.310
> 
> 标签：sql, inner-join

我有几张桌子：

```
lecturer(id,name,email)
- 1,john,john@abc.com
- 2,andy,andy@abc.com
- 3,kyle,kyle@abc.com
- 4,allen,allen@abc.com

sig(id,name)
- s1, Multimedia
- s2, Business IT

expertise(id, description); 
- e1, Gaming
- e2, Graphic
- e3, Multimedia System
- e4, E-Business

lecturer_has_expertise(lecturer.id,expertise.id)
- 1, e1
- 2, e2
- 3, e4
- 4, e1

lecturer_has_sig (lecturer.id,sig.id)
- 1, s1
- 2, s1
- 3, s2

sig_has_expertise(sig.id,expertise.id)
- s1, e1
- s1, e2
- s1, e3
- s2, e4 
```

这是我要显示的输出：

```
Lecturer's Name, Email, Expertise 
```

基本上，当用户在文本框中输入关键字例如：**游戏**时，它会显示哪个讲师的专长是游戏，并且由于游戏在**多媒体下，多媒体****签名中的**所有讲师的数据也会显示。例如：

```
Name   Email            Expertise
John   john@abc.com     Gaming
Allen  allen@abc.com    Gaming
Andy   andy@abc.com     Graphic 
```

我设法仅输出用户输入的专业知识，而不是同一 sig 中的所有专业知识。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T19:39:33.370

这有效（至少对于您的示例）并在 MySQL 上进行了测试。但它是简单的 SQL，因此它应该适用于大多数数据库。

```
SELECT lc.name, lc.email, ex.description
FROM lecturer lc 
INNER JOIN lecturer_has_expertise lhc ON lc.id = lhc.lcId
INNER JOIN expertise ex ON ex.id = lhc.exId
WHERE ex.description = 'Gaming'

UNION

SELECT lc.name, lc.email, ex2.description
FROM 
(SELECT she.sigId FROM expertise ex 
INNER JOIN sig_has_expertise she ON she.exId = ex.id
WHERE ex.description = 'Gaming') sigex
INNER JOIN sig_has_expertise she2 ON sigex.sigId = she2.sigId
INNER JOIN expertise ex2 ON she2.exId = ex2.id
INNER JOIN lecturer_has_expertise lhc ON ex2.id = lhc.exId
INNER JOIN lecturer lc ON lhc.lcId = lc.id 
```

下次请提供示例数据的 DDL（至少对于此类复杂查询）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T19:44:43.323

所以基本上你想回报每一位老师

*   具有特定的专业知识

    或者

*   属于具有特定专业知识的组。

这就是上面在 SQL 中的翻译方式：

```
SELECT
  l.name,
  l.email,
  e.description AS expertise
FROM lecturer_has_expertise le
  INNER JOIN lecturer l ON l.id = le.lecturer_id
  INNER JOIN expertise e ON e.id = le.expertise_id
WHERE e.description = @InputExpertise
   OR EXISTS (
     SELECT *
     FROM lecturer_has_sig ls
       INNER JOIN sig_has_expertise se ON ls.sig_id = se.sig_id
       INNER JOIN expertise e ON e.id = se.expertise_id
     WHERE e.description = @InputExpertise
       AND ls.lecturer_id = le.lecturer_id
   ) 
```

# java - 带有条件的 PostgreSQL 触发器

> ID：10693082
> 
> 赞同：2
> 
> 时间：2012-05-21T21:45:00.990
> 
> 标签：java, postgresql, triggers, mybatis

说，我在 MyBatis 映射器中有以下用于 postgres 表的内容：

```
 <select id="selectValues" parameterType='int' resultType="SomeType">
        select foo from bar where baz=#{qux}
    </select> 
```

可以从表中返回 SomeType 值的列表。但是我想在触发器的帮助下检查返回的列表是否为空，如果是，则给它一个空值。它可能看起来像：

```
CREATE TRIGGER mytrigger AFTER select ON bar FOR EACH STATEMENT EXECUTE PROCEDURE trigger_after_select ();

CREATE FUNCTION trigger_after_select () RETURNS trigger AS ' 
BEGIN 
if (select count(*) from bar)=0
then return NULL; 
... 
```

我想知道我是否朝着正确的方向前进，是否有人能说出触发器的其余部分会是什么样子（如果开始看起来合适的话）。一个建议会很有帮助，谢谢你的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:48:37.717

Postgres 中没有“SELECT”触发器。

如果您将 SQL 更改为：

```
select foo from bar where baz=#{qux}
union all
select null where not exists (select 1 from bar where baz=#{qux}) 
```

那么你会得到同样的效果。如果该列没有具有该值的行，它将返回 NULL 值`baz`。

（免责声明：我不知道MyBatis，所以不知道是否可以指定这样的声明）

# php - linux php 连接到运行 MS SQL Server Express 的 Server 2008

> ID：10693083
> 
> 赞同：1
> 
> 时间：2012-05-21T21:45:08.403
> 
> 标签：php, sql-server

我可以使用以下凭据从客户端 PC 连接到 SQL Server Express。在 mgnt 音频中：

```
server: 192.168.44.96\sqldb
auth: windows auth
user name: domain\user
pw: 1234! 
```

让 LAMP 服务器尝试连接到上述 SQL 服务器，PHP 如下所示：

```
$server = '192.168.44.96\sqldb';
$username = 'domain\user';
$password = '1234!';
$database = 'testing123';
$connection = mssql_connect($server, $username, $password);
if($connection != FALSE){
    echo "Connected to the database server OK<br />";
}
else {
    die("Couldn't connect" . mssql_get_last_message());
}

if(mssql_select_db($database, $connection)){
    echo "Selected $database ok<br />";
}
    else {
    die('Failed to select DB');
} 
```

该页面显示“无法连接”，并且 error.log 显示“无法连接 ot 服务器：192.168.44.96”。

我还在 php.ini 中设置了 mssql.secure_connection = On 并重新启动了 apache2。

有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:48:15.637

我无法评论 PHP 部分，我只知道 SQL Server。
但我可以告诉你：Windows 身份验证不是这样工作的。
您不能使用 Windows 身份验证，然后将用户名和密码显式传递给服务器。您需要执行以下操作之一：

1.  使用 SQL Server 身份验证并显式传递用户名和密码
2.  使用 Windows 身份验证并且**不**传递用户名和密码 - 您将自动连接到活动的 Windows 用户。

由于您使用的是 Linux 服务器，因此我很确定您不能使用 Windows 身份验证。因此，您必须使用 SQL 身份验证（需要在全新的 SQL Server 安装上启用），并且您必须在 SQL Server 上创建用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:48:46.407

如果您有默认的 sqlexpress 安装，您可能需要配置您的 sql 服务器以允许远程访问连接。另外我不知道你是否可以连接windows auth。在您的 sql 服务器上，您还可以设置 sql 身份验证并使用 uid=;pwd=。

# jquery - 试图根据屏幕分辨率显示不同的背景图像？

> ID：10693084
> 
> 赞同：0
> 
> 时间：2012-05-21T21:45:19.993
> 
> 标签：jquery, css, background-image

我遇到了一个问题。我正在尝试根据屏幕分辨率加载不同的图像，但我尝试了下面列出的代码，它没有加载背景。我有一个 css 和 jquery 设置当说和背景没有显示。我不知道我哪里出错了？

```
@media (min-width:800px) { .w800 { background-image: url(images/DCBG800.png);                      @media (min-width:1024px) { .w1024 { background-image: url(images/DCBG1024.png);
@media (min-width:1152px) { .w1152 { background-image: url(images/DCBG1152.png);
@media (min-width:1280px) { .w1280 { background-image: url(images/DCBG1280.png);
@media (min-width:1360px) { .w1360 { background-image: url(images/DCBG1360.png);
@media (min-width:1366px) { .w1366 { background-image: url(images/DCBG1366.png);
@media (min-width:1600px) { .w1600 { background-image: url(images/DCBG1600.png);
}

   <script type="text/javascript">
   function setImageClass() {
switch(true) {
    case($(window).width()>1600): $("body").removeClass("w800 w1024 w1152 w1280 w1360 w1366").addClass("w1600");
    break;
    case($(window).width()>1366): $("body").removeClass("w800 w1024 w1152 w1280 w1360 w1600").addClass("w1366");
    break;
    case($(window).width()>1360): $("body").removeClass("w800 w1024 w1152 w1280 w1366 w1600").addClass("w1360");
    break;
    case($(window).width()>1280): $("body").removeClass("w800 w1024 w1152 w1360 w1366 w1600").addClass("w1280");
    break;
    case($(window).width()>1152): $("body").removeClass("w800 w1024 w1280 w1360 w1366 w1600").addClass("w1152");
    break;
    case($(window).width()>1024): $("body").removeClass("w800 w1152 w1280 w1360 w1366 w1600").addClass("w600");
    break;
    default: $("body").removeClass("w1024 w1152 w1280 w1360 w1366 w1600").addClass("w800");
    break;
}
   }

    $(document).ready(function() {
setImageClass();
    });

    $(window).resize(function() {
setImageClass();
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:57:07.800

您没有关闭 CSS 示例中的任何大括号。此外，尝试摆脱“body”上的所有类（即现在也是 javascript），并将 background-image css 规则直接应用于“body”元素选择器，如下所示：

```
@media (min-width:800px) { 
   body {
       background-image: url(images/DCBG800.png); 
   }
} 
```

我希望这有帮助，

卢克斯

# html - CodeIgniter HTML 表格生成器，内部带有自定义布局

> ID：10693086
> 
> 赞同：3
> 
> 时间：2012-05-21T21:45:31.663
> 
> 标签：html, codeigniter, html-table

CI`table->generate($data1, $data2, $data3)`将以**简单表格**的形式输出我的数据，例如：

```
<table>
    <tr>
        <td>data1</td>
        <td>data2</td>
        <td>data3</td>
    </tr>
</table> 
```

如果我需要一个 **复杂的单元格布局**`$vars`，每个单元格中有多个：

```
$data1 = array('one', 'two', 'three'); 
```

我想要这样的东西：

```
<table>
    <tr>
        <td>
            <div class="caption">$data1[0]</div>
            <span class="span1">$data1[1] and here goes <strong>$data1[2]</strong></span>
        </td>
        <td>...</td>
        <td>...</td>
    </tr>
</table> 
```

我应该如何编码那部分？

现在我只是`td`在模型中生成内容，然后调用`generate()`. 但这意味着我的单元格 HTML 在模型中，但我想将其保留在视图中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T00:57:49.857

我的建议是，您可以传递生成 td 结构的数据。捕获视图的输出并将其传递给表生成器。这使您的结构保持在视图中，尽管是不同的结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-17T21:53:46.157

Hailwood 的回答并不是最好的方法。html 表类在[add_row](https://www.codeigniter.com/user_guide/libraries/table.html#CI_Table::add_row)方法上有一个数据元素。所以代码是：

```
$row = array();
$row[] = array('data' => "<div class='caption'>{$data1[0]}</div><span class='span1'>{$data1[1]} and here goes <strong>{$data1[2]}</strong></span>");
$row[] = $col2;
$row[] = $col3;

$this->table->add_row($row)
echo $this->table->generate(); 
```

顺便说一句，在表中有一个名为 caption 的类在语义上是令人困惑的，因为 table 有一个标题标签。

# networking - 将边缘权重传递给networkx中的graphviz_layout

> ID：10693088
> 
> 赞同：4
> 
> 时间：2012-05-21T21:45:38.263
> 
> 标签：networking, layout, graph, graphviz, networkx

每个人都找不到如何将权重列表的属性名称传递给 networkx 中的 graphviz_layout。像这样的东西：

```
nx.spring_layout(G, weight='weight.sum') 
```

但与`nx.graphviz_layout(G, ...)`. 也许有人会知道？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T05:54:41.010

如果我说得对，您想指定哪个边缘属性用作 graphviz 布局的边缘权重。从[NetworkX 文档](http://networkx.lanl.gov/reference/generated/networkx.drawing.nx_agraph.graphviz_layout.html?#graphviz-layout)中，我认为这是不可能的。

但是，该`weight`属性由 graphviz 中的布局算法使用。这就是它所说的：

> [重量](http://www.graphviz.org/doc/info/attrs.html#d%3aweight)
> 
> 边缘的重量。在dot中，重量越重，边缘越短、越直、越垂直。对于其他布局，较大的权重会鼓励布局使边缘长度更接近[len](http://www.graphviz.org/doc/info/attrs.html#d%3alen)属性指定的长度。

有了这个，您可以为网络中的每条边[设置边权重：](http://networkx.lanl.gov/tutorial/tutorial.html#edge-attributes)

```
g = nx.Graph()
g.add_edge(1, 2, {'weight': 4}) 
```

或者

```
g.add_edge(1, 2)
g.edge[1][2]['weight'] = 4 
```

或者

```
g[1][2]['weight'] = 4 
```

如果要为边缘设置默认权重，可以将其作为参数传递给要在其中使用[的 graphviz 程序](http://www.graphviz.org/content/command-line-invocation)`graphviz_layout`：

```
nx.graphviz_layout(g, prog='dot', args='-Eweight=4') 
```

# c - C - 分段错误

> ID：10693090
> 
> 赞同：1
> 
> 时间：2012-05-21T21:45:39.727
> 
> 标签：c

这是我的生成分段错误的小 C 片段：

```
#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>

int checkTiime(char time[]);

int main(int argc, char** argv) {

    char time1[6];
    char time2[6];

    printf("Tempo 1 [hh:mm]: ");
    fgets(time1, sizeof time1, stdin);
    printf("Tempo 2 [hh:mm]: ");
    fgets(time2, sizeof time2, stdin);

    printf("Checktime: %d", checkTime(time1));

    return (EXIT_SUCCESS);
}

int checkTime(char time[]){

    long hours = 0;
    long minutes = 0;

    if(time[2] == ':') {

        if(isdigit(time[3]) && isdigit(time[4]) && isdigit(time[0]) && isdigit(time[1])) {
            hours = strtol(time[0], NULL, 10) + strtol(time[1], NULL, 10);
            minutes = strtol(time[3], NULL, 10) + strtol(time[4], NULL, 10);

            if((hours >= 0 && hours <= 23) && (minutes >= 0 && minutes <= 59)){

                return 0;

            } else {

                return 1;

            }

        } else {

            return 1;

        } 

    } else {

        return 1;

    }

} 
```

有人能帮我吗。我真的不知道为什么给我的问题。

我还注意到，例如，当我输入“12:34”时，它要求我输入第二个输入，但是当我写“12:34”时，我使用退格键删除“34”并再次输入“34”它写道第二个 printf 但不允许我输入第二个输入并且程序退出。

**个人评论：**

我注意到最好使用`gets()`函数来输入字符串，因为它不计算`\n`字符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:54:30.347

使用时要小心`fgets`。您的调用要求它在遇到换行符或 EOF 之前最多读取 6 个字符。`fgets`将换行符视为有效字符并存储它（如果遇到这样的字符）。现在，在您的情况下，最后一个字符不是 NULL ，因为它应该在 C 样式字符串中，而是`\n`. 您需要将其替换为 a `NULL`，然后才能将其传递给`strtol`期望 C 样式的 NULL 终止字符串。所以：

```
if (fgets(time1, sizeof time1, stdin) != NULL) {
    time1[ sizeof time1 - 1 ] = NULL;
} 
```

或者，甚至更好：

```
if (fgets(time1, sizeof time1 - 1, stdin) != NULL) {
    // hurray we have the time!
} 
```

或者，您可以拥有自己的换行安全`fgets`包装器：

```
char *chomp(char *buf, size_t sz, FILE *fp, size_t *outsz) {
   char *p = fgets(buf, sz - 1, fp) ; /* make sure there is room for terminating NULL */
   if (p != NULL) {
      char *nl = strchr(buf, '\n');
      if (nl) *nl = NULL; /* replace trailing newline */
      *outsz = strlen(buf); /* recompute */
   }
   return p;
} 
```

# regex - Emacs 文件浏览器中文件名（正则表达式）的大小写转换

> ID：10693093
> 
> 赞同：0
> 
> 时间：2012-05-21T21:45:50.430
> 
> 标签：regex, emacs, dired, case-conversion

我有一个与中解决的问题类似的问题

[Emacs：正则表达式替换以改变大小写](https://stackoverflow.com/questions/677021/emacs-regular-expression-replacing-to-change-case)

我想使用 Emacs 的文件浏览器模式 Dired 将文件从 重命名`08 - hey you.mp3`为`08 - Hey you.mp3`.

我输入`% R`替换`^\([0-9]* - \)\([a-z]\)\(.*\)$`为`\1\,(upcase \2)\3`，我得到一个错误

```
Invalid use of `\' in replacement text 
```

当我在普通文本缓冲区中查询-替换-正则表达式时`\([0-9]* - \)\([a-z]\)\(.*\)`，`\1\,(upcase 2)\3`我没有问题。唯一的输入区别是封闭的`^`和，如[http://www.gnu.org/software/emacs/manual/html_node/emacs/Transforming-File-Names.html#Transforming-File-Names](http://www.gnu.org/software/emacs/manual/html_node/emacs/Transforming-File-Names.html#Transforming-File-Names)`$`中所述，这是必需的，但是错误的来源似乎是，它在 Dired 中似乎不可用，因为当我使用例如替换正则表达式时我没有这个错误。`\,(upcase )``\1\3\2`

我正在使用 Emacs 23.2.1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:30:54.277

`% R``dired-do-rename-regexp`在最终调用`replace-match`from的 dired 调用中`dired-string-replace-match`，并且 replace-match 不支持 elisp 替换。

您可以做的是利用`wdired`它允许您将目录列表编辑为纯文本。

`C-x``C-q`（即通常的`toggle-read-only`绑定）将在 dired 和 wdired 之间切换。一旦进入 wdired，您就可以使用普通的搜索和替换，包括 elisp 替换模式。

# c# - 如何使双打正常工作？C＃

> ID：10693098
> 
> 赞同：2
> 
> 时间：2012-05-21T21:46:01.037
> 
> 标签：c#, double

这是代码：

```
 static void Main(string[] args)
    { 
        int xd2 = 5;

        for (double xd = (double)xd2; xd <= 6; xd += 0.01)
        {
            Console.WriteLine(xd);
        }

    } 
```

这是输出： ![在此处输入图像描述](../Images/47b0052631d0b7797c75808805221719.png)

我想继续添加 0.01（正如您在屏幕上看到的那样，有时它恰好添加了 0.99999）谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-21T21:47:14.440

[`decimal`](http://msdn.microsoft.com/en-us/library/system.decimal.aspx)如果您想保持这种准确性，请使用。

浮点类型无法准确表示某些值。我建议阅读[What Every Computer Scientist Should Know About Floating-Point Arithmetic](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)以获得全面的解释。

```
decimal xd2 = 5m;

for (decimal xd = xd2; xd <= 6m; xd += 0.01m)
{
    Console.WriteLine(xd);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T21:49:15.543

不，这就是双打的工作方式......尝试使用小数代替

```
 int xd2 = 5;

 for (decimal xd = (decimal)xd2; xd <= 6; xd += 0.01M)
 {
     Console.WriteLine(xd);
 } 
```

如果您想坚持使用双打，但只关心两位小数，请使用...

```
int xd2 = 5;

for (double xd = (double)xd2; xd <= 6; xd += 0.01)
{
   Console.WriteLine(Math.Round(xd,2));
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T21:55:11.263

这是因为 double 是浮点型的，而且这种算法并不精确。您可以改用小数，如下所示：

```
 static void Main(string[] args)
    {
        int xd2 = 5;

        for (decimal xd = (decimal)xd2; xd <= 6; xd += 0.01M)
        {
            Console.WriteLine(xd);
        }
        Console.ReadLine();
    } 
```

另见这篇文章：[.NET 上的双精度问题](https://stackoverflow.com/questions/566958/double-precision-problems-on-net)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T21:52:48.403

如果可能，您应该始终使用绝对而不是迭代计算来消除这些类型的舍入错误：

```
public static void Main(string[] args)
{
    int xd2 = 5;

    for (int i = 0; i < 100; ++i) {
        Console.WriteLine(xd2 + i * 0.01);
    }
} 
```

# javascript - 在 For 循环中通过 Javascript 提取表单变量

> ID：10693106
> 
> 赞同：0
> 
> 时间：2012-05-21T21:46:45.390
> 
> 标签：javascript, html, forms, variables

我有一个基于用户输入填充表单字段的网页，如下所示：

```
 function Go2() {
            var loans = document.getElementById('count').value;
            var content = document.getElementById('stage3').innerHTML;
            content = '<TABLE Width="100%">'
                +'<TR>'
                +'<TD Style="font-weight:bold;" Width="30%">Customer Name</TD>'
                +'<TD Style="font-weight:bold;" Width="30%">Customer Number</TD>'
                +'<TD Style="font-weight:bold;" Width="30%">Origination Date</TD>'
                +'</TR>'
                +'</TABLE>';
            document.getElementById('stage3').innerHTML = content;
            for(var i=0; i<loans; i++) {
                content = document.getElementById('stage3').innerHTML;
                document.getElementById('stage3').innerHTML = content
                    + '<TABLE Width="100%">'
                    + '<TR>'
                    + '<TD Width="30%"><INPUT Name="CName'
                    + i
                    + '" Size="40" Type="text"></TD>'
                    + '<TD Width="30%"><INPUT Name="CNumber'
                    + i
                    + '" Size="40" Type="text"></TD>'
                    + '<TD Width="30%"><INPUT Name="Date'
                    + i
                    + '" Size="40" Type="text"></TD>'
                    + '</TR>'
                    + '</TABLE>';
            }
            content = document.getElementById('stage3').innerHTML;
            document.getElementById('stage3').innerHTML = content
                    + '<TABLE><TR><TD><INPUT Type="Button" Value="Submit" onClick="Go3()"></TD></TR></TABLE>';
        } 
```

现在我需要做的是遍历表单并提取每个表单字段的值。据我所知，这大约是：

```
for (var n=0; n<loans; n++) {
content += '<TR>'
    + '<TD Colspan="2">'
    + document.getElementById('CName + n').value
    + '</TD>'
    + '<TD Colspan="2">'
    + document.getElementById('CNumber + n').value
    + '</TD>'
    + '<TD>'
    + document.getElementById('Date + n').value
    + '</TD>'
    + '</TR>';
} 
```

哪个...没有。我取得的最后一个显着进步是让它吐出“null”，这根本不是真正的进步。我看过 eval ，但有很多警告反对它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:48:42.693

我想你想要

```
document.getElementById('CName' + n).value 
```

（其中 n 在引号之外）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:49:08.233

那么它应该是 'CName' + n - 即，你把引号放在了错误的地方

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T00:34:13.687

如果您的所有控件都在一个表单中，那么您可以通过以下方式访问它们：

```
var allControls = document.<formId>.elements; 
```

或者

```
var allControls = document.forms[formId].elements; 
```

然后遍历控件列表以获取值。表单控件必须有名称才能成功，不需要 ID。您还可以获得以下值：

```
var value = allControls['CName' + n].value; 
```

要不就

```
var form = docment.forms[formID];
var value = form['CName' + n].value; 
```

# sql - Rails 3：在视图中加入结果

> ID：10693110
> 
> 赞同：0
> 
> 时间：2012-05-21T21:47:08.200
> 
> 标签：sql, ruby-on-rails, ruby, ruby-on-rails-3, join

再一次，我面临着一些表面上不应该如此困难但已经让我发疯了一个小时左右的事情。我有多个模型，我想将它们拉入一个“索引”视图。我认为这是一个连接，但我似乎无法找到一种方法来做到这一点。

我在索引视图中的内容：

```
 <% @tips.each do |tip| %>
  <tr>
    <td><%= tip.user_id %></td>
    <td><%= tip.city_id # here I want to draw on the cities table to show city.name
         %></td>
    <td><%= tip.type_id # here I want to draw on the type table to show type.name
         %></td>
    <td><%= tip.place_id # here I want to draw on the place table to show place.name
         %></td>
    <td><%= tip.tip_desc %></td>
    <td><%= link_to 'Show', tip %></td>
    <td><%= link_to 'Edit', edit_tip_path(tip) %></td>
    <td><%= link_to 'Destroy', tip, confirm: 'Are you sure?', method: :delete %></td>
  </tr>
<% end %> 
```

以下是模型：

```
class Tip < ActiveRecord::Base
  belongs_to :user
  belongs_to :city
  belongs_to :place
end

class Place < ActiveRecord::Base
  belongs_to :city
  has_and_belongs_to_many :collections
  has_many :tips
end

class City < ActiveRecord::Base
  has_many :places
  has_many :tips 
end 
```

任何帮助将不胜感激！

提前致谢，

詹姆士

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:42:22.670

其他人的建议应该有效。我不确定，但您的数据库中的指定 ID 内似乎没有对象。就这样 ：）

例子：

```
@tips.each do |tip|
  tip.city_id # 1
  City.find( tip.city_id ) # nil
end 
```

# random - 如何从 xy 坐标生成种子

> ID：10693111
> 
> 赞同：1
> 
> 时间：2012-05-21T21:47:09.760
> 
> 标签：random, seed, prng

我一直在研究 perlin 脚本，但在创建简单的伪随机值时遇到了问题。

我需要能够从 xy 坐标创建种子值，但 x+y 在重复值方面存在明显问题。他们也进入负空间，所以 x^y 不起作用。

抱歉，如果这已经在其他地方得到了回答，但我不明白或找不到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T01:03:29.750

您想为每个 x,y 对分配一个可重复的随机数吗？

使用 x,y 的线性或一般函数组合作为种子将在分布中产生伪影（至少如果您不使用非常复杂的函数）。试试这个，我遇到了同样的问题，它对我有用

```
//seeded random for JS - integer
function irnd2()
{
    a=1664525;
    c=1013904223;
    m=4294967296;
    rnd2.r=(rnd2.r*a+c)%m;
    return rnd2.r;
}

//seeded random for JS - double [0,1]
function rnd2()
{
    a=1664525;
    c=1013904223;
    m=4294967296;
    rnd2.r=(rnd2.r*a+c)%m;
    return rnd2.r/m;
}

rnd2.r=192837463;

//seed function
function seed2(s)
{
    s=s>0?s:-s;
    rnd2.r=192837463^s;
}

//my smart seed from 2 integer
function myseed(x,y)
{
seed2(x);//x is integer
var sx=irnd2();//sx is integer
seed2(y);//y is integer
var sy=irnd2();//sy is integer
seed2(sx^sy);//using binary xor you won't lose information 
} 
```

为了使用它：

```
myseed(x,y);
irnd2(); 
```

通过这种方式，您可以获得良好的不相关随机序列。

我在 JS 中使用它，但它也应该在其他语言中工作，假设种子的参数和 rnd 的返回值是一个整数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:53:12.720

取两者的绝对值`x`和`y`第一；然后`x^y`会正常工作。创建伪随机源的最简单方法之一是使用时间。您可以尝试乘以`x^y`当前系统时间；此方法生成重复种子值的机会极低。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:53:45.997

如果您知道您拥有的值的范围，您可以简单地将 x 和 y 转换为用零填充的字符串，附加两个字符串，然后通过哈希函数运行生成的字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T21:53:56.040

您需要更好地定义问题以获得最佳答案。

如果您的 x 和 y 值相对较小，您可以将它们放入整数的高位和低位部分（您的语言中的种子是整数），例如对于 32 位平台：

int 种子 = x << 16 + y;

如果种子值不允许为负（我没有完全理解你的问题中的“负空间”是什么意思，无论你是指地理还是种子值），你可以取种子的绝对值.

如果您的意思是坐标可以具有负值，那么您的最佳行动方案取决于您是否想要相同的坐标种子和相反的种子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-28T11:06:55.580

在 C# 中，根据 alexroat 的回答进行了改编和改进。只需设置`Random.seed = MyUtils.GetSeedXY(x, y)`，您就可以开始了。

```
public static class MyUtils
{
    static int seed2(int _s)
    {
        var s = 192837463 ^ System.Math.Abs(_s);
        var a = 1664525;
        var c = 1013904223;
        var m = 4294967296;
        return (int) ((s * a + c) % m);
    }

    public static int GetSeedXY(int x, int y)
    {
        int sx = seed2(x * 1947);
        int sy = seed2(y * 2904);
        return seed2(sx ^ sy);
    }
} 
```

# java - 推进 ListView 下一项 / setSelectionFromTop 不工作 / 禁止用户滚动 ListView

> ID：10693112
> 
> 赞同：1
> 
> 时间：2012-05-21T21:47:11.197
> 
> 标签：java, android, listview

下午好，

我有一个显示项目列表的列表视图......虽然不是全部，但它们都在那里。而不是让用户向上/向下滚动，而是要求和向上/向下按钮。除了如何推进 ListView 之外，我的一切都处理得很好。假设我正在查看列表中的第 3 项。用户点击下一步...我想 ListView 前进到第 4 项。我在内部跟踪他们在哪个页面上进行递增/递减。我期待找到这样的东西，但没有骰子。

```
ListView.MoveNext(); 
```

或者

```
ListView.Move(int); 
```

根据 Brayden 的建议，我在这里尝试了接受的解决方案：[返回 ListView 时保持/保存/恢复滚动位置，](https://stackoverflow.com/questions/3014089/scroll-to-a-position-in-a-listview)并且它没有出现滚动列表....即它停留在第一个列表项上。我也试过setSelection。

这是我的代码：

```
public void btn_NextClick(View vw_Current) 
{
    //increment page count 1
    i_PageTracker ++;

    //advance to next record
    //int x = lstvw_LiftData.getFirstVisiblePosition();
    View v = lstvw_LiftData.getChildAt(0);
    int top = (v == null) ? 0 : v.getTop();

    lstvw_LiftData.setSelectionFromTop(i_PageTracker, top);
    //lstvw_LiftData.setSelection(i_PageTracker);
 } 
```

基于弗拉基米尔的成功和我的缺乏，我想提供一些我认为无关紧要的额外信息，但......

我扩展了 SimpleAedapter 并覆盖了 getView。我还有一个 DataBinder 可以用数据对象中的某些数据填充 TextViews。

有趣的是，当我在 DataAdapter 的 getView 和加载时绑定器的 setViewValue 中设置断点时，我们会适当地点击它们。但是，当单击下一个按钮时，我们不会点击它们，如果列表前进到下一个位置，我会期望它们....嗯，我想知道....我有另一个想法....马上回来。

我想通了....但我不知道该怎么办。看到不知道我在做什么，我自己开枪了。我只想一次在列表中看到一个项目，并且我不希望用户能够滚动。好吧，我所做的就是覆盖 DataAdapter 中的 getCount 并返回 1。这似乎是答案，因为只有一项显示很酷！但是覆盖 getCount 也意味着只有一项要显示，所以我们永远不会前进……没有什么可以前进的。

所以我想知道的是这个。如何防止用户滚动并强制他们使用导航按钮。我是否处理滚动事件并返回 null？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:37:13.840

我想通了....但我不知道该怎么办。看到不知道我在做什么，我自己开枪了。我只想一次在列表中看到一个项目，并且我不希望用户能够滚动。好吧，我所做的就是覆盖 DataAdapter 中的 getCount 并返回 1。这似乎是答案，因为只有一项显示很酷！但是覆盖 getCount 也意味着只有一项要显示，所以我们永远不会前进……没有什么可以前进的。

所以我想知道的是这个。如何防止用户滚动并强制他们使用导航按钮。我是否处理滚动事件并返回 null？

# javascript - 如何更改 Meteor 加载 Javascript 文件的顺序？

> ID：10693113
> 
> 赞同：46
> 
> 时间：2012-05-21T21:47:12.927
> 
> 标签：javascript, dependencies, meteor, require

当您使用 Meteor 框架创建项目时，它会将所有文件打包在一起，但似乎没有办法明确地说“我希望在该文件之前加载此文件”。

假设，例如，我有 2 个 javascript 文件：`foo.js`和`bar.js`.

该文件`bar.js`实际上包含代码，取决于其中的一个，但 Meteor之前`foo.js`正在加载，从而破坏了项目。`bar.js``foo.js`

*   在**node.js**中，我会简单地`require('./bar')`在里面使用`foo.js`
*   在**浏览器**中，我会放置一个`<script>`指向 的标签，`foo.js`然后再放置一个指向 的标签`bar.js`，以便以正确的顺序加载文件。

我们如何在**Meteor**中做到这一点？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-05-24T15:58:40.980

根据 Meteor 文档，文件当前按以下顺序加载：

1.  首先加载 [project_root]/lib 中的文件
2.  文件按目录深度排序。首先加载更深的文件。
3.  文件按字母顺序排序。
4.  main.* 文件最后加载。

资料来源： [http ://docs.meteor.com/#structuringyourapp](http://docs.meteor.com/#structuringyourapp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T20:11:51.340

不是适用于所有场景的解决方案，但我认为理想情况下，任何依赖于其他代码的内容都将放在 Meteor.startup 函数中，以确保所有内容都已加载。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2015-04-05T17:40:52.060

我有一组在公共命名空间（js 全局）下构建的实用程序函数。

IE

```
// utils/utils.js
Utils = {}; 
```

然后在子文件夹中：

```
// utils/validation/validation.js
Utils.Validation = {};

// utils/validation/creditCard.js
Utils.Validation.creditCard = ... // validation logic etc 
```

我也有一堆使用 Utils 的代码及其子对象。

显然，这种结构不适用于 Meteor 首先加载子文件夹。

为了使其按预期工作，我必须创建具有无意义名称的 /subfolder/subfolder/subfolder，然后将根对象推到最深的子文件夹中，并在不那么深的子文件夹中分支对象。

这对我的口味来说非常违反直觉并且容易出错（假设您有文件夹结构更深的组件）。

为了解决这个问题，我使用了带有 defers 和 Promise 的 Q 库。解决方案仍然不干净，因为它使您例行代码重复和检查，但它使您可以完全控制加载顺序而不会弄乱目录结构（向那些说您可以根据需要组织流星代码的人打招呼）。

例子：

```
//utils.js
UtilsDefer = UtilsDefer || Q.defer();
UtilsDefer.resolve({
    // here some root utils stuff
});

//cards.js
// here we'll depend on Utils but don't want to care about directory structure
UtilsDefer = UtilsDefer || Q.defer(); // it will be a) already 
// resolved defer from utils.js, or b) new defer that will
// be resolved later in utils.js
UtilsDefer.then(function(Utils) {
    // do something with utils usage, or for instance add some fields here
    Utils.CreditCardDefer = Utils.CreditCardDefer || Q.defer();
    Utils.CreditCardDefer.resolve({
        // Credit card utils here
    })
});

//someOtherFile.js
// it will be pain to use sub-objects with this method though:
UtilsDefer = UtilsDefer || Q.defer();
UtilsDefer.then(function(Utils) {
    Utils.CreditCardDefer = Utils.CreditCardDefer || Q.defer();
    Utils.CreditCardDefer.then(function(CreditCard) {
        // do stuff with CreditCard _if_ you need to do it on startup stage   
    })
}); 
```

`Meteor.startup`这是一个相当狭窄的用例示例，因为大多数情况下您会很高兴在一些用户交互回调中或所有内容都已初始化的地方处理这些全局变量。否则，如果您想在早期阶段对初始化顺序进行细粒度控制，这可能是一个解决方案。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-05-15T09:59:51.413

您总是可以使用[yepnope.js](http://yepnopejs.com/)之类的 JS 加载器并将其添加到 client.js 文件中。这对我有用。

# xml - 使用 SQL Server 2008 运行时指定的 XSD 验证 XML？

> ID：10693123
> 
> 赞同：5
> 
> 时间：2012-05-21T21:48:17.993
> 
> 标签：xml, sql-server-2008, tsql, xsd

SQL Server 2008 允许我们通过定义一个类型化的 XML 列/变量来针对现有的 XML 模式集合验证 XML：`DECLARE @TypedXml XML(MyXmlSchemaCollection)`

但是，据我所知，在我们定义列/变量时必须知道 XML 模式集合。

*有没有办法使用在运行时*指定的 XML 模式来验证 XML ？

例如：

```
DECLARE @Xml XML
SET @Xml = 
N'<person>
    <firstname>Ming</firstname>
    <lastname>The Merciless</lastname>
</person>'

DECLARE @Xsd XML
SET @Xsd =
N'<?xml version="1.0"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
 <xs:element name="person">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="firstname" type="xs:string"/>
      <xs:element name="lastname" type="xs:string"/>
      <xs:element name="dateofbirth" type="xs:date"/>
    </xs:sequence>
  </xs:complexType>
 </xs:element>
</xs:schema>'

DECLARE @Valid BIT
SET @Valid = (SELECT dbo.f_ValidateXmlAgainstXsd(@Xml, @Xsd)) -- With a user-defined function?
EXEC @Valid = s_ValidateXmlAgainstXsd @Xml, @Xsd -- With a stored procedure? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T02:22:43.290

对于您的要求，我可能会探索 CLR 集成：使用[存储过程](http://msdn.microsoft.com/en-us/library/ms131094.aspx)或[用户定义的函数](http://msdn.microsoft.com/en-us/library/ms131077.aspx)；您应该首先检查您的环境中是否允许 CLR 集成。

在这里张贴太多了；但是，使用 .NET 验证 XML 文档的代码很常见；只要 SQL 2008 出现，我添加到 SQL Server 在线书籍中的链接就会出现......

一般来说，我认为要实现不受 SQL Server 支持 XSD 方式限制的验证，应该依赖 CLR 集成。[此处](http://msdn.microsoft.com/en-us/library/ms190665.aspx)描述的 SQL 服务器上的 XSD 集合的限制无论如何都会使许多人朝这个方向发展。在大容量环境中需要解决一些问题，我认为缓存已编译的 XSD 是最重要的问题。另一个是 XSD 的复杂性，以及 XSD 的来源和引用方式（包括/导入/重新定义支持）。尝试自己实现这些方面肯定会让您了解 SQL Server 不支持 xsd:include 的原因......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-02T21:16:18.060

如果要针对存储在数据库中的一组预定义 XSD 进行验证，则可以在存储过程中使用动态 SQL 来进行验证。

如果您想针对任何 XSD 进行验证，最好在 Petru 的回答中使用 CLR。

以下脚本将起作用。如果输入 XML 无效，它会引发异常。如果您希望验证仅返回结果而不是引发异常，则可以使用 try/catch 子句。

编辑：您不能在函数中使用动态 SQL，但可以将此脚本包装在存储过程中。

```
 DECLARE @result int

    DECLARE @XsdValidationSQL nvarchar(max) = 
        'DECLARE @xml xml(' + @xsdSchema + '.' + @xsdName + ') = ''' + CONVERT(nvarchar(max), @xml) + ''''

    EXEC @result = sp_executesql @XsdValidationSQL

    RETURN @result 
```

# io - 如何判断给定进程是否使用 O_DIRECT 打开文件？

> ID：10693125
> 
> 赞同：3
> 
> 时间：2012-05-21T21:48:25.297
> 
> 标签：io, linux-kernel, posix

我想知道一个进程是否使用 O_DIRECT 打开了任何文件，但我只能在进程启动**后**检查它（即 strace 不是一个选项）。我尝试查看 /proc/$pid/fd/ 以查看是否有任何有用的东西，但没有。我的目标是跟踪系统上的数百个用户中是否有任何一个使用 O_DIRECT 打开了文件。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T06:46:10.890

我不认为它`/proc`在用户空间中或其他地方可见。

使用内核代码，可以：
1\. 获取进程的`task_struct`（使用`find_task_by_pid`）。
2\. 浏览文件 - 使用`task->files->count`和`task->files->fd_array`。3\. 寻找`file->f_flags & O_DIRECT`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T14:15:41.723

从内核 2.6.22 开始，/proc/$pid/fdinfo/$fd 包含一个八进制的标志字段。见[http://www.kernel.org/doc/man-pages/online/pages/man5/proc.5.html](http://www.kernel.org/doc/man-pages/online/pages/man5/proc.5.html)

# javascript - 关于如何为列表项的背景设置动画的建议

> ID：10693131
> 
> 赞同：0
> 
> 时间：2012-05-21T21:48:59.230
> 
> 标签：javascript, jquery

我想知道你是否可以为我提供一种更好的方法来实现我在这个小提琴中创建的效果：http: [//jsfiddle.net/YLuKh/1/](http://jsfiddle.net/YLuKh/1/)

基本上，我想为锚标签的背景颜色设置动画，以显示我通过将锚标签放置在图像顶部的跨度顶部然后悬停动画跨度宽度来完成的图像。任何人都可以提出更直接的方法吗？

HTML

```
<ul id="test">
    <li>
        <a href="">This is the link</a>
        <span class="bg"></span>
        <img src="http://www.ritaxxii.org/wp-content/uploads/Luxury-Bedroom-Furniture-1.jpg" />
</li>
</ul>​ 
```

JS

```
$(document).ready(function() {

    var li_width = $('#test').find('li').width();
    console.log(li_width);

    $('#test').find('li').on('mouseover', function() {
        $(this).find('.bg').stop().animate({
            width: '0'
        }, 200);
    }).on('mouseout', function() {
        $(this).find('.bg').stop().animate({
            width: li_width
        }, 200);
    });

});​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:03:35.867

您可以从中获得参考：[http ://snook.ca/archives/javascript/jquery-bg-image-animations](http://snook.ca/archives/javascript/jquery-bg-image-animations)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:06:51.187

我可以建议一种仅 CSS3 的方法来实现我*认为*您正在尝试做的事情：

```
li {
    border: 1px solid #f90;
    width: 504px; /* width of the image, adjust to taste */
    overflow: hidden;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    -o-box-sizing: border-box;
    box-sizing: border-box;
}
li a {
    display: block;
    position: relative;
    width: 100%;
    height: 2em;
    line-height: 2em;
    color: #fff;
    background-color: #000;
    -webkit-transition: width 1s linear;
    -moz-transition: width 1s linear;
    -o-transition: width 1s linear;
    -ms-transition: width 1s linear;
    transition: width 1s linear;
}

li:hover a {
    width: 0;
    -webkit-transition: width 1s linear;
}

li a::after {
    content: url(http://www.ritaxxii.org/wp-content/uploads/Luxury-Bedroom-Furniture-1.jpg);
    position: absolute;
    top: 0;
    right: 0;
    left: 100%;
    bottom: 0;
}
​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/YLuKh/8/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T22:10:09.253

正如我在评论中提到的，您可以使用背景位置来制作动画。这是一个仅使用背景图像定位的简单方法（[http://jsfiddle.net/3PESX/](http://jsfiddle.net/3PESX/)）

```
$('a').mouseenter(function() {
    $(this).stop().animate({ 'background-position-x': '-700px'}, 300);
});
$('a').mouseleave(function() {
    $(this).stop().animate({ 'background-position-x': '0'}, 300);
});​

a {
    display: inline-block;
    height: 50px;
    width: 300px; 
    background: transparent url(http://jtrujillo.net/digital-photo-tutorials/8vs16bit/dgr1.jpg) 0 top no-repeat;
    color: grey;
    text-decoration: none;
    line-height: 50px;
}​

<a href="/">This is a link text</a>​ 
```

请注意，背景位置属性是 x 和 y 版本的组合。您不能为复合属性设置动画，您需要分别为 X 和 Y 版本设置动画。或者，您可以使用一个 css 钩子插件，使其成为可能。你可以在这里找到：[https ://github.com/brandonaaron/jquery-cssHooks](https://github.com/brandonaaron/jquery-cssHooks)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T22:16:26.120

如果您将有很多列表项，您可能需要考虑将事件委托给 #test 元素，这样您就不必将一堆不同的事件侦听器附加到每个 li 标签

```
//attach one event listener for 'mouseover' and one for 'mouseout' on the test element
$('#test').on('mouseover', 'li', function(){
    //'this' is still the li element
    console.log( $(this)); 

    $(this).find('.bg').stop().animate({width: '0'},200);             
}).on('mouseout', 'li', function(){
    $(this).find('.bg').stop().animate({width: li_width},200);       
}); 
```

# asp.net-mvc - ValidationMessageFor 不显示错误

> ID：10693133
> 
> 赞同：13
> 
> 时间：2012-05-21T21:49:06.213
> 
> 标签：asp.net-mvc

我有这堂课：

```
public class Product
{
    [Required(ErrorMessage = "empty name")]
    public string Name { get; set; }

    [Required(ErrorMessage = "empty description")]
    public string Description { get; set; }
} 
```

我有一个 ResponseProduct 显示在视图中：

```
public class ProductInsertVM
{
    public string Message = "Success";
    public Product Product;
} 
```

在我看来，我有这个：

```
@using (Html.BeginForm()){  
    @Html.ValidationSummary(false)

    @Html.TextBoxFor(m => m.Product.Description)
    @Html.ValidationMessageFor(m => m.Product.Description)
} 
```

我想知道为什么 ValidationMessageFor 不起作用？！！只有 ValidationSummary 有效。如果我用产品回应，那么它就可以工作。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-21T22:03:42.027

如果满足以下条件，您提供的代码应该可以正常工作。

**1）**您在视图中参考了 jQuery 验证脚本

```
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script> 
```

**2)**在表单提交时，您正在调用 ModelState.IsValid 属性并因此验证传递给操作方法的模型

```
[HttpPost]
public ActionResult CarList(CarList model)
{
    if (ModelState.IsValid)
    {
       //Save or whatever you want to do 
    }
    return View(model);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-02T14:49:58.987

在 _Lahout.cshtml 中缺少这一行

@Scripts.Render("~/bundles/jqueryval")

完全的：

```
@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/jqueryval") <------------ 
@Scripts.Render("~/bundles/bootstrap")
@RenderSection("scripts", required: false) 
```

# knockout.js - 打开许多 Windows 的 Spa 应用程序

> ID：10693140
> 
> 赞同：1
> 
> 时间：2012-05-21T21:49:34.467
> 
> 标签：knockout.js, asp.net-mvc-4, single-page-application

是否可以使用 mvc 4 在 SPA 应用程序中打开许多 Windows。

我的意思是我有一个用户列表。打开一个用户让我进入一个视图，然后我可以返回同一个视图并打开另一个。然后选择直接转到第一个打开的持有该用户状态的用户。

我不知道你是否理解我的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T23:23:40.693

我想你可能误解了什么是单页应用程序。它按照与常规网页完全相同的规则进行播放，但您不会离开该页面。

没有窗口之类的东西，它们只是模拟真实应用程序窗口的 div。您所描述的完全有可能您只需要创建正确的 div 并正确定位/填充它们。例如，前一段时间我在 KO 中编写了一个模仿 windows 7 外观和感觉的窗口管理器。

你可以在这里找到它。

[https://github.com/madcapnmckay/Knockout-UI](https://github.com/madcapnmckay/Knockout-UI)

我要提醒的是，单页应用程序是一个高级主题，在理解其含义之前，您应该非常谨慎地研究它们。

**编辑**

有很多方法可以分离你的 viewModel。对于整个应用程序，我总是有一个主视图模型。在您的情况下，我会在 javascript 中创建一个 UserViewModel 类并新建一个新的类，然后再将其添加到一些可观察的数组中。

```
var user1 = new UserViewModel(ajaxdata);
self.users.push(user1);
var user2 = new UserViewModel(ajaxdata);
self.users.push(user2);

<div data-bind="foreach: users">
     <div>
        ... your user window markup goes here
     </div>
</div> 
```

您可以选择使用模板绑定而不是内联模板。至于加载取决于您的数据。您可以在更新 UserViewModel 之前执行 ajax 调用来获取用户数据，或者您可以在开始时加载所有数据并在您希望它们显示时更新它们。

希望这可以帮助。

# jquery - 如何使用 jquerymobile 制作可拖动的 li 元素？

> ID：10693143
> 
> 赞同：2
> 
> 时间：2012-05-21T21:49:44.670
> 
> 标签：jquery, jquery-ui, jquery-mobile, mobile-website

我是网络移动新手。

当我想在我们中制作可拖动项目时，我只使用 jquery ui，在移动 web 应用程序中这样做的方法是什么？（我正在使用 jquerymobile）我们应该在 web 移动中也使用 jquery ui 还是存在其他好方法？

谢谢，

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-22T02:50:31.653

jQuery mobile 没有内置支持创建可拖动对象。引入 jQuery UI 来创建可拖动对象可以很好地工作，只要您引入一些东西来使触摸事件工作（jQuery UI 目前不支持触摸事件）。 [jQuery UI Touch Punch](http://touchpunch.furf.com/)是提供此类功能的不错选择。

仅包含可拖动插件及其依赖项的 jQuery UI 自定义构建仅缩小了 4 K。jQuery UI Touch Punch 是 1/2 K。相比之下，jQuery 本身是 32 K。jQuery UI 的可拖动性非常强大，所以我认为它是值得的。

在这个答案中有一些相关的讨论和一个更轻量级的解决方案 - [Javascript Drag and drop for touch devices](https://stackoverflow.com/questions/5186441/javascript-drag-and-drop-for-touch-devices)。

# apache - 如何更改 apache 的默认 tcp/ip 端口

> ID：10693147
> 
> 赞同：2
> 
> 时间：2012-05-21T21:50:14.407
> 
> 标签：apache

如何让 apache 使用端口 3000 而不是 80 在外部服务器上运行我的 ruby​​ on rails 应用程序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T21:53:36.480

编辑您的`httpd.conf`Find 行`Listen 80`并将 80 更改为您要使用的任何端口。

不要忘记重新启动apache。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-27T13:44:53.560

在服务器版本中：Apache/2.2.22 (Debian) 服务器构建时间：2014 年 2 月 1 日 21:26:04 在 /etc/apache2 目录中有一个名为 ports.conf 的文件，您可以从那里更改监听端口。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-12-10T21:02:58.213

在 Ubuntu 上，它是`/etc/apache2/ports.conf`.

# runtime - InsertionSort 和 FingerTreeSort 的渐近运行时

> ID：10693155
> 
> 赞同：-1
> 
> 时间：2012-05-21T21:50:52.847
> 
> 标签：runtime, asymptotic-complexity, insertion-sort, finger-tree

我在我的书以及互联网上的几个网站上搜索了高低，但我并不完全确定我的答案。

关于存在的反转数量，我需要给出 InsertionSort 和 FingerTreeSort（基于 RB-Trees）的渐近运行时。InsertionSort 运行时间为 O(n+INV)，FingerTreeSort 运行时间为 O(n+n*lg(INV/n+1)。我需要给出 INV = 0、n、n^1.5 和 n^2/ 的渐近运行时4.

我自己想出的是 InsertionSort 运行在：O(n)、O(n)、O(n^2) 和 O(n^2)

这个对吗？为什么不？（我特别不确定 INV = n 和 n^1.5）

对于 FingerTreeSort：O(n*lg(n))、O(n*lg(n))、O(n*lg(sqrt(n))) 和 O(n*lg(n^2))

我对 FingerTreeSort 中的所有内容都存有疑问，但我认为它们应该是这样的。如何找到正确的渐近运行时？例如对于 FingerTreeSort 和 n^1.5，我认为它会通过插入通用运行时给出 O(n+n*lg(n^1.5/n+1) 并简化： O(n+n*lg (sqrt(n)+1) 并且看到它是渐近的，我可以忽略 +1 和 +n 等较低的数字给我 O(n*lg(sqrt(n)))。这是正确的做法吗?

提前感谢那些回答这个问题的人。我非常喜欢它:)

附言。用java编写，这对问题并不重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:48:17.993

**插入排序：**
公式：O(n + inv)
inv = 0 : **O(n)**
inv = O(n) : O(n +n) = **O(n)**
inv = O(n^1.5) : O(n+ n^1.5) = **O(n^1.5)**
inv = (n^2)/4 : O(n + n^2) = **O(n^2)**

**FingerTreeSort ：**
公式（使用 OP 提供的公式）：O( n + n*(ln[(inv/n) +1 ] ) )
inv = 0 : **O(n)**
inv = O(n) : O(n + n*( ln[( O(n)/n ) + 1] ) ) = O(n + n*( ln[ O(1) +1] )) = **O(n)**
inv = O(n^1.5) : O(n + n*( ln[( O(n^1.5)/n ) + 1] ) ) = O(n + n*( ln[ c*(n^0.5) + 1] ) ) =
O( n + 0.5*n*ln(n)) = **O(n*ln (n))**
同样，对于 inv = O(n^2) : **O(n*ln(n))**

# php - 数组键比较失败

> ID：10693158
> 
> 赞同：1
> 
> 时间：2012-05-21T21:51:11.177
> 
> 标签：php, loops

出于某种原因，当我使用 foreach 循环遍历数组时，条件无法将键与字符串进行比较。我的数组有两个索引，第一个是整数，第二个是字符串。

```
$firmas[] = $credito['acreditado'];
$firmas['cbi'] = "LIC. MARCELA SOTO ALARCÓN"; 
```

当循环发现那一刻的键是字符串 1 时，我想做其他事情，但由于某种原因，当我评估整数索引时，结果为真。

```
 foreach($firmas as $key => $firma){
            var_dump($key);
            var_dump($key=='cbi');die();
        } 
```

输出是

```
int(0) bool(true) 
```

但正如您所看到的，条件正在寻找字符串“cbi”，因此整数索引的结果应该为假，字符串的结果应该为真。

这里发生了什么事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:54:35.933

在 PHP 中，所有字符串都等于`0`，但不等于它。尝试使用`===`而不仅仅是`==`.

附录：所有*不以数字开头的*字符串都等于`0`。

# javascript - jQuery 的窗口加载包装器

> ID：10693162
> 
> 赞同：1
> 
> 时间：2012-05-21T21:51:28.010
> 
> 标签：javascript, jquery, dom

`jQuery(document).ready(function($){});`是一种保护 $ 不引起错误的已知且很好的方法。

我很好奇的是是否`jQuery(window).load(function($){});`会以同样的方式工作？

基本上，我现在拥有的是：

```
jQuery(document).ready(function($){

    $(window).load(function(){
       // ...
    }); 

}); 
```

这对我来说似乎没有必要，关于简化这个的任何想法？我需要将 jQuery 正确映射到 $ （或任何正确的术语）的安全性，但时间与`window.load()`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T21:57:05.323

我更喜欢这个...

```
(function($){

    $(window).load(function(){
        //everything is loaded (images, scripts, etc.)
    });

    // and/or

    $(document).ready(function(){
        // the dom is in place, but everything is not necessarily loaded
    });

})(jQuery); 
```

注意：这仅在此脚本之前包含 jQuery 时才有效。我从未遇到过以这种方式未定义 jQuery 的任何问题。此外，您将永远不会遇到 $ 未定义的问题，因为您将它传递给您的匿名函数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-21T21:54:56.307

你可以这样做：

```
(function($) {

    $(window).load(function(){
       // ...
    }); 

})(jQuery); 
```

匿名函数将立即执行，而不是像问题中的代码那样等待 DOM 就绪。函数内`$`将是一个引用，`jQuery`因此不会与`$`匿名函数之外定义的任何其他内容发生冲突。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T21:55:13.200

您可以创建一个本地参数：

```
(function($) {
    $(...)
})(jQuery); 
```

此代码使用名为 的参数执行匿名函数，并作为参数值`$`传递。`jQuery`

# umbraco - Umbraco 5 Very Basic - 如何在宏中加载实体（或实际使用 HiveId）？

> ID：10693164
> 
> 赞同：1
> 
> 时间：2012-05-21T21:51:50.557
> 
> 标签：umbraco, umbraco5

我创建了我的第一个自定义 Umbraco 5.1 解决方案。此时，我有一个带有**自定义模板的****内容项**（“主页”），上面有一个**自定义部分宏**。现在如何使用帮助程序加载实体？我尝试使用 a 添加几个结构，但是我不断收到相同的错误：****`Umbraco``HiveId``Uri`****

 ****> 参数“other”必须是 Guid 类型才能转换为 Guid CLR 类型，但它是“Uri”，值为：xxx

**宏部分：**

```
@inherits PartialViewMacroPage
@使用 Umbraco.Cms.Web
@使用 Umbraco.Cms.Web.Macros
@使用 Umbraco.Framework

@{
    //所有这些都失败并显示相同的错误消息...

    //基于名称：
    var p = Umbraco.GetContentById(
      新的 HiveId(
        新的 Uri("content://Homepage")));

    //基于路径
    var p = Umbraco.GetContentById(
      新的 HiveId(
        新的 Uri("content://p__nhibernate/v__guid/5a4abe489a2e47858bd2a0580180b683")));

    //使用自定义 Hive 提供程序（我使用自定义树/部分添加了它，并且产品显示出来，因此 Hive 提供程序有效）
    var p = Umbraco.GetContentById(
      新的 HiveId(
        新的 Uri("custom://products/1")));
}

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:59:10.923

**你为什么要创建一个 Uri？** 接受您可以使用的字符串参数
。`HiveId`也一样`Umbraco.GetContentById(string id)`

我通过了 Umbraco 5 认证，我们从未使用过构造函数的`Uri`重载`HiveId`。

```
var p = Umbraco.GetContentById("yourStringHiveIdHere"); //(string overload) or 
var p = Umbraco.GetContentById(new HiveId("yourSringHiveIdHere")); // (HiveId overload) 
```

另外，您从哪里获得 HiveId？****

# .net - VS2010 构建时序列化以实现快速运行时加载？

> ID：10693169
> 
> 赞同：2
> 
> 时间：2012-05-21T21:52:35.060
> 
> 标签：.net, visual-studio-2010, msbuild, preprocessor, binary-serialization

在 .NET4 下的 Visual Studio 2010 中，是否有一种在构建过程中实例化、填充和二进制序列化类的好方法？我正在编写一个应用程序，每次都需要几秒钟的时间将一组复杂的相互关联的类加载到相同的“启动状态”，我怀疑如果我可以从序列化图像加载它们，加载时间实际上会消失。

我的问题不是关于 XNA，但我最近花了一些时间在 XNA 框架下玩 Xbox 编程。该框架添加了一个有趣的预处理功能（内容管道），它完全符合我的描述：来自主应用程序的重要类可以被实例化和填充（使用不同的代码块，仅在构建时预处理），然后序列化为部署文件。此序列化版本在运行时重新加载，以显着提高初始化性能。（在 XNA 下，此过程还允许目标平台进行调整，例如字节顺序更改，这对我的问题无关紧要。）

我意识到我必须手动启动反序列化，我知道它不会自动化到那种程度——我担心的是构建方面。

XNA 框架之外的 VS2010 是否存在类似的东西？这不是 T4 风格的代码生成（它仍然需要运行时处理，尽管它可能比读取外部文件执行得更好），我不确定我是否可以编写一个单独的项目来创建这些类并将其转储到磁盘稍后在不同的项目中安全地重新加载它们（可能需要进行一些实验），但即使可行，它仍然缺乏与构建过程的集成。我不能仅仅劫持 XNA Framework 插件，因为它有许多 XNA 特定的关系，并且加载端进程只是 XNA。

请注意，我愿意考虑价格合理的第三方插件（我不会为此犹豫 30 美元或 40 美元，但我不会购买价值数百美元的工具）。

# java - 如何获取另一个应用程序的图标？

> ID：10693171
> 
> 赞同：11
> 
> 时间：2012-05-21T21:52:37.837
> 
> 标签：java, windows

所以在我正在制作的这个应用程序中，用户单击一个按钮，该按钮启动一个程序。此按钮将具有应用程序的标题和图标。我只需要知道如何获取图标，就像这样：[Windows http://goo.gl/5WjdT](http://goo.gl/5WjdT)

所以我想知道的是：

1.  在Java中有什么真正的方法可以做到这一点
2.  如果是这样，你会怎么做？

提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-21T21:55:25.120

您是否必须获取与应用程序的 exe 文件关联的图标？如果在 Java 中是可能的，请查看[本教程](http://www.rgagnon.com/javadetails/java-0439.html)，该教程解释了从 Java 应用程序的可执行二进制文件中提取应用程序图标的几种方法。

看看这段代码：

```
String s = "c:/windows/regedit.exe";
File file = new File(s);

// Get metadata and create an icon
sun.awt.shell.ShellFolder sf =
        sun.awt.shell.ShellFolder.getShellFolder(file);
Icon icon = new ImageIcon(sf.getIcon(true)); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-21T22:10:09.450

你可以简单地使用 FileSystemView 来达到这个目的：

```
public static void main(String[] args) {
    Icon icon = FileSystemView.getFileSystemView()
         .getSystemIcon(new File("C:\\Windows\\regedit.exe"));
    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.add(new JLabel(icon));
    frame.pack();
    frame.setVisible(true);
} 
```

# iphone - 停止在 UITextView 中重复背景图像

> ID：10693179
> 
> 赞同：0
> 
> 时间：2012-05-21T21:53:12.523
> 
> 标签：iphone, ios, xcode, uiimageview, uitextview

如何阻止图像在 UITextView 中重复？我想要实现的是有一个 UITextView，它具有从 .txt 文件加载的文本（已经有效）并加载预览图像（已经有效），最后我希望背景在顶部显示我的徽标以及背景颜色我'已经制作（全部在 1 个 .png 文件中），当您滚动时，徽标会消失，其余的背景也会滚动。我的问题是图像在文本末尾附近重复。如果我将图像放大，我的徽标会拉伸并且看起来很草率，我想将图像保持在（0,0,480，无论文字有多高），并且仍然保持徽标的完整性。我试过搜索其他类似的问题，但他们似乎都想要重复，而我不想要。建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:42:39.123

What about having a UIImageView that acts as a background image and setting the background for the textView to transparent - will it help?

# c# - Microsoft Jet 4.0 是否支持 64 位整数？

> ID：10693181
> 
> 赞同：0
> 
> 时间：2012-05-21T21:53:15.783
> 
> 标签：c#, .net, jet, sqlanywhere

我有一个 csv 文件，我正尝试使用 C# .NET 中的 SABulkCopy（Sybase 的 SQLBulkCopy 版本）类将其导入 Sybase SQL Anywhere 数据库。csv 文件的第一列映射到 Sybase DB 中的 64 位整数主键值。其中一列中还有二进制数据（大于 510 字节）。使用 Jet 4.0 OleDB 访问 csv 文件可能不是进行批量插入的最佳方式，但我不知道使用 csv 源文件完成此操作的另一种方法。这样做的重点是避免将所有插入写入日志，因为 blob 数据是可消耗的，但需要快速导入。我正在使用 schema.ini 文件来映射 csv 文件中的数据类型，问题是“Long”数据类型仅适用于 32 位整数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:00:46.380

您无法使用 Jet 4.0 执行此操作，但您不需要这样做。[您可以在http://www.microsoft.com/en-us/download/details.aspx?id=13255](http://www.microsoft.com/en-us/download/details.aspx?id=13255)获得 64 位访问引擎可再发行组件。您还需要将连接字符串“Provider”更新为“Microsoft.ACE.OLEDB.12.0”。

如果无法使用单独安装的引擎，您始终可以[像这样](http://www.akamarketing.com/blog/256-csv-datatable.html)读取一个简单的文件并解析出数据。

# vba - VBA 递归和哈希

> ID：10693182
> 
> 赞同：0
> 
> 时间：2012-05-21T21:53:17.353
> 
> 标签：vba, recursion

我有点进退两难。我收到一个数组数组，其中包含数组的第一个元素中的字符串，表示哈希 {HASH}。我不知道数组数组的结构，它可以根据不同调用的结果而有所不同。数据示例如下：

```
[ [ "{HASH}", 1000, ["{HASH}", "A", 100], ["{HASH}", "B", 150], ["{HASH}", "C", 200] ], 
  [ "{HASH}", 1001, ["{HASH}", "D", 101], ["{HASH}", "E", 151], ["{HASH}", "F", 201] ]
] 
```

哈希应该如下所示：

```
{1000}{A}=100
{1000}{B}=150
{1000}{c}=200
{1001}{D}=101
{1001}{E}=151
{1001}{F}=201 
```

我已经编写了以下函数以递归调用以输出数组中的条目这很好，但我需要将其放入定义的哈希中，这是失败的地方，因为它被递归调用，哈希被重置ETC：

```
Public Function ProcessObjOrArray(Obj As Variant, key As String, ByRef hashIn, HashCreated As Boolean) As Variant

Dim sKey As String
Dim i As Integer
Dim objRes As Variant

If HashCreated = False Then
    Dim hash
    HashCreated = True
    Set hash = CreateObject("Scripting.Dictionary")
End If
If IsArray(Obj) Then
    For i = 0 To UBound(Obj, 1)
        objRes = ProcessObjOrArray(Obj(i), sKey, hash, HashCreated)

        If (objRes = "{HASH}") Then
            i = i + 1
            sKey = Obj(i)
        End If
    Next i
    If key <> "" Then
        Debug.Print "Adding {" + key + "}=AllTheStuff"
        Set hash.Item(key) = hashIn

        Dim a
        a = hash.Item(key)("Enabled")
        Exit Function
    End If
Else
    If key <> "" Then
        Debug.Print "Adding {" + key + "}=" + CStr(Obj)
        hash.Item(key) = Obj
    Else
        ProcessObjOrArray = Obj
    End If
End If
End Function 
```

传入的 Object 显然是我上面定义的数组。如果有人有这样做的聪明方法，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T07:58:14.290

我解决了这个问题，通过使用传入的哈希并在端点创建一个新的哈希，它是传入的哈希的副本，然后最后重置传入的哈希并将 key 和 value = 设置为哈希 I复制。这成功创建了哈希的哈希

# iphone - iPhone iOS如何在UIImage中列出所有颜色的像素？

> ID：10693195
> 
> 赞同：0
> 
> 时间：2012-05-21T21:54:26.767
> 
> 标签：iphone, colors, uiimage

是否有任何工具或演示项目可以让我从相机胶卷中选择图像并让实用程序分析该图像，列出所有像素或重要像素区域的颜色？

摆在我面前的是一套需求文件，想简单了解一下设计师要我用什么颜色。我的 Mac 上没有安装 Photoshop。

感谢您的任何指点

# c++ - 在 opengl visual cpp 中加载 BMP

> ID：10693199
> 
> 赞同：3
> 
> 时间：2012-05-21T21:54:36.230
> 
> 标签：c++, visual-c++, opengl

我需要在多边形中应用纹理。所以我搜索并找到了很多来源，但其中大多数我在包含和加载 BMP 图片时遇到了问题。（在视觉 cpp 10 中开发）。那么谁能告诉我加载 BMP 文件的简单方法以及如何应用纹理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:00:57.397

一个简单的方法是使用 GDI+ 类`Bitmap`：

[http://msdn.microsoft.com/en-us/library/ms534420%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms534420%28v=vs.85%29.aspx)

您使用带有文件名的构造函数创建一个对象，然后使用`LockBits()`方法获取指向包含像素的缓冲区的指针。该方法为您提供了一个指向缓冲区的指针，您可以将其发送到 OpenGL 纹理函数。

# html - 如何禁用 Vim 的 HTML 错误突出显示？

> ID：10693207
> 
> 赞同：2
> 
> 时间：2012-05-21T21:55:37.117
> 
> 标签：html, vim, syntax-highlighting

我使用 Vim 编辑带有嵌入宏的 HTML，其中的宏用双尖括号括起来，例如“<>”。Vim 的标准 HTML 高亮显示将第二个 "<" 和 ">" 视为错误，并将它们高亮显示。我怎样才能防止这种情况？我很乐意教 $VIMHOME/syntax/html.vim 双尖括号是可以的，或者只是禁用错误突出显示，但我不确定如何做任何一个。（“highlight clear htmlTagError”无效。事实上，“highlight clear”在 HTML 缓冲区中无效。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T22:49:36.517

如果您想在宏中引入完整的语法突出显示，最简单的方法是从 ( 之类的语法文件开始`htmldjango`，`$VIMRUNTIME/syntax/htmldjango.vim`然后使用`html.vim`和`django.vim`来自同一目录)；`{{ ... }}`其中，除其他外，还有特殊含义。您希望它是一样的，但要使用`<<`并`>>`作为您的分隔符。

要`<< ... >>`特别突出显示，您需要这样的语法行：

```
syntax region mylangMacro start="<<" end=">>" containedin=ALLBUT,mylangMacro 
```

然后你可以用以下方式突出显示它：

```
highlight default link mylangMacro Macro 
```

这既可以进入`~/.vim/after/syntax/html.vim`也可以`htmldjango`以新语法荧光笔的方式完成（这将是我的首选方法；然后您可以使 HTML 文件使用这个带有 autocmd 的新语法文件）。

* * *

（您也可以删除错误突出显示，`syntax clear htmlTagError`它会出现在相同的位置。但希望您会认为单独突出显示比仅删除错误更好。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:29:19.007

以下是在 Vim 中编辑现有语法高亮的说明：

[http://vimdoc.sourceforge.net/htmldoc/syntax.html#mysyntaxfile-add](http://vimdoc.sourceforge.net/htmldoc/syntax.html#mysyntaxfile-add)

Unix/Linux 的 vim 运行时路径：

```
 $HOME/.vim,
                    $VIM/vimfiles,
                    $VIMRUNTIME,
                    $VIM/vimfiles/after,
                    $HOME/.vim/after 
```

> 在你的 vim 运行时路径中创建一个名为“after/syntax”的目录。

适用于 Unix/Linux 的命令：

```
mkdir ~/.vim/after
mkdir ~/.vim/after/syntax 
```

> 1.  编写一个包含您要使用的命令的 Vim 脚本。例如，要更改 C 语法的颜色： **highlight cComment ctermfg=Green guifg=Green**
>     
>     
> 2.  将该文件写入“after/syntax”目录中。使用语法名称，并添加“.vim”。对于我们的 C 语法： **:w ~/.vim/after/syntax/c.vim**
>     
>     
> 
> 而已。下次编辑 C 文件时，注释颜色会有所不同。你甚至不必重新启动 Vim。
> 
> 如果您有多个文件，则可以使用文件类型作为目录名称。将使用该目录下的所有“*.vim”文件，例如：~/.vim/after/syntax/c/one.vim ~/.vim/after/syntax/c/two.vim

或者，您可以采用更简单的方法并在 Nano 命令行编辑器中使用语法高亮，您可以使用正则表达式轻松定义自己的语法：

[http://how-to.wikia.com/wiki/How_to_use_syntax_highlighting_with_the_GNU_nano_text_editor](http://how-to.wikia.com/wiki/How_to_use_syntax_highlighting_with_the_GNU_nano_text_editor)

# javascript - 将未知大小的图像调整为特定大小而不进行裁剪。（信箱）

> ID：10693210
> 
> 赞同：1
> 
> 时间：2012-05-21T21:56:00.427
> 
> 标签：javascript, html, css

我正在尝试从外部 URL 获取图像并将其放入特定大小的 div 中。

例如一个 300x200 的 div。外部 URL 上的图像可以是横向或纵向的，我不想用类似的东西裁剪图像`overflow:hidden`

有没有好的/聪明的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:57:15.400

你可以试试#your-div img { max-width: 100% max-height: 100%; }

这应该像在这个 jsfiddle [http://jsfiddle.net/trickeedickee/xWeVK/中那样为您完成工作](http://jsfiddle.net/trickeedickee/xWeVK/)

# jquery - jQuery 选择器返回“NaN”——间歇性

> ID：10693211
> 
> 赞同：1
> 
> 时间：2012-05-21T21:56:20.860
> 
> 标签：jquery, jquery-selectors, nan

遇到了这个非常奇怪的时间问题。

```
var myVar = myContainer.find("input, textarea, button, select");
console.log("myContainer", myContainer.length, "myVar", myVar.length);
if (!myVar.length) {
   debugger;
} 
```

当调试器被命中时，对象 myVar 包含以下内容：

```
myVar {
       NaN: HTMLInputElement
//all other jQuery member data here
} 
```

成员元素怎么可能是“NaN”？！

有时，我们会看到 myVar 的“NaN”（查找操作的结果）。myContainer 的长度总是 1。所以它是一个有效的 jQuery 对象......

这怎么可能？我认为如果 myContainer 对象在某些方面不好，它的长度将为 0 或者我会得到一个不同的更明确的错误。

我们知道这是一个时间问题，主要是因为它是如此断断续续。大约 1/10 次左右会发生这种情况。

任何建议都会很棒！:D

# c++ - boost::property_:tree - 解析和处理数据

> ID：10693213
> 
> 赞同：0
> 
> 时间：2012-05-21T21:56:34.420
> 
> 标签：c++, parsing, boost, boost-propertytree

我刚刚发现了 boost::property_tree，这似乎是我问题的完美答案。我编写了一个小测试程序来从 xml 文件中提取特定数据。我已使用文档中提供的示例作为指南。xml 文件：test.xml：

```
<section>
    <GROUP>
        <g_name>ABC</g_name>
        <fields>
            <row>
                <name>A</name>
                <datatype>string</datatype>
                <field_size>6</field_size>
                <value>ABC</value>
            </row>
            <row>
                <name>B</name>
                <datatype>integer</datatype>
                <field_size>5</field_size>
                <value>00107</value>
            </row>
            <row>
                <name>C</name>
                <datatype>string</datatype>
                <field_size>20</field_size>
                <value>LOTS OF LETTERS     </value>
            </row>
        </fields>
    </GROUP>
    <GROUP>
        <g_name>CDE</g_name>
        <fields>
            <row>
                <name>A</name>
                <datatype>string</datatype>
                <field_size>6</field_size>
                <value>CDE</value>
            </row>
            <row>
                <name>B</name>
                <datatype>integer</datatype>
                <field_size>5</field_size>
                <value>00100</value>
            </row>
            <row>
                <name>F</name>
                <datatype>integer</datatype>
                <field_size>4</field_size>
                <value>1970</value>
            </row>
        </fields>
    </GROUP>
</section> 
```

编码：

```
 using boost::property_tree::ptree;
        struct t_collection
        {
            ptree pt;
            void load(const std::string &filename);
            void print();
        };
        void t_collection::load(const std::string &filename)
        {
            read_xml(filename, pt);
        }
        void t_collection::print()
        {
                BOOST_FOREACH(ptree::value_type &v, pt.get_child("section.GROUP"))
BOOST_FOREACH(ptree::value_type &v, pt.get_child("section.GROUP"))
{
    printf("X: %s->", v.second.data().c_str());
    //prints X: ABC ->
    BOOST_FOREACH(ptree::value_type &w, pt.get_child("section.GROUP.fields.row"))
        printf("%s\n", w.second.data().c_str());
    //prints A, string, 6, ABC - that is good for first iteration but there should be 3 iterations here
}
//then prints X: and just "" and repeats the set from the first one 
        }
        int main()
        {
            try
            {
                t_collection t1;
                t1.load("test.xml");
                t1.print();
            }
            catch (std::exception &e)
            {
                std::cout << "Error: " << e.what() << "\n";
            }
            return 0;
        } 
```

注意：我正在尝试提取值（ABC 和内部值，如 A - string - 6 - ABC，对于每个 GROUP - 以及每组“行”，我将对其进行处理，然后以不同的格式输出）。请参阅代码中的注释以了解我尝试过的内容。
到目前为止，最好的结果是：（print() 中的内容：

```
BOOST_FOREACH(ptree::value_type &z, pt.get_child("section"))
    //BOOST_FOREACH(ptree::value_type &v, pt.get_child("section.GROUP"))
        {
            printf("X: %s->", pt.get<std::string>("section.GROUP.g_mame", "default").c_str());
            //prints X: ABC ->
            BOOST_FOREACH(ptree::value_type &w, pt.get_child("section.GROUP.fields.row"))
            {
                printf("%s\n", pt.get<std::string>("section.GROUP.fields.row.name", "name").c_str());
                printf("%s\n", pt.get<std::string>("section.GROUP.fields.row.datatype", "type").c_str());
                printf("%s\n", pt.get<std::string>("section.GROUP.fields.row.field_size", "size").c_str());
                printf("%s\n", pt.get<std::string>("section.GROUP.fields.row.value", "value").c_str());
            }
        }
        //prints x: default->A, string, 6, ABC (3 times) then repeat identically 
```

我无法从多条记录中获取数据！请帮忙，给我一个建议 - 我做错了什么？
谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:37:21.113

您在迭代中缺少一个级别。您需要遍历具有多个具有相同名称的子元素的元素。

```
std::pair<ptree::const_assoc_iterator, ptree::const_assoc_iterator>
    r(pt.get_child("section").equal_range("GROUP"));

for (ptree::const_assoc_iterator i(r.first); i != r.second; ++i) {
    // Do something with each group.
} 
```

下树时酌情重复。

# windows - 批处理文件：解析命令行输入

> ID：10693214
> 
> 赞同：2
> 
> 时间：2012-05-21T21:56:35.820
> 
> 标签：windows, batch-file, validation

我正在研究一个批处理文件，以用作一些已经编写的数据处理模块的包装器，目标是能够根据需要/处理能力允许并行运行一些并行运行和串行运行其他一些。底层模块需要一个输入（包含在双引号中的路径），以及可选的包含在双引号和/或一组标志中的另一个路径，我试图弄清楚如何测试这些输入。我目前有

```
:TEST_PARAMS
REM Make sure parameters are correct; if not, display a usage message
IF NOT "%1"=="" (SET SUBBASENAME=%1
) ELSE (
    GOTO :USAGE
)
IF NOT "%2"=="" (SET ATLASBASENAME=%2
) ELSE (
    SET ATLASBASENAME=%DEFAULTATLAS%
)
IF NOT "%3"=="" (SET FLAGS=%3
) ELSE (
    SET FLAGS=""
)
GOTO :START_SVREG 
```

如果以正确的顺序输入内容，这似乎可以正确解析所有内容。但是，我还想检查标志（前面有'-'）是否作为第一个或第二个输入弹出，如果是，则根据需要显示使用消息/正确设置变量。我认为最简单的方法是查看这些字符串的第一个字符是否是'-'，但我找不到任何方法来做到这一点。我找到了一段代码，它通过用空字符串替换子字符串然后查看结果字符串是否与原始字符串相同来检查字符串是否包含某个子字符串，但这不起作用，因为人们可能在其他地方合法地使用连字符在他们的路径中。有没有办法检查字符串的第一个字符是否与批处理文件中的给定字符匹配，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:04:41.593

您真的不需要在任何批处理文件参数中检查“-”，因为作为批处理文件创建者，您将知道可以处理哪些命令。意味着如果使用“-b”，那么您知道如何处理它，或者如果用户通过“-t”，您将知道如何处理。在您的批处理文件中，您只需要处理所有参数，无论它们的顺序如何，并且在您的批处理文件中，您将有部分来处理它。这是一个示例批处理文件，它可以处理任意数量的带有“-”或“/”的参数：

```
@echo off

if [%1]==[] goto usage
:CHECKFORSWITCHES
@echo Execute the Command
IF '%1'=='/param1' GOTO PARAM1
IF '%1'=='-param2' GOTO PARAM2
IF '%1'=='/param3' GOTO PARAM3
IF '%1'=='-param4' GOTO PARAM4
IF '%1'=='/param5' GOTO PARAM5
goto :eof

:PARAM1
@echo This is Param1
set var=%1
set var2=%var:~0,1%
echo %var2%
SHIFT
goto :CHECKFORSWITCHES
:PARAM2
@echo This is Param2
SHIFT
goto :CHECKFORSWITCHES
:PARAM3
@echo This is Param3
SHIFT
goto :CHECKFORSWITCHES
:PARAM4
@echo This is Param4
set var=%1
set var2=%var:~0,1%
echo %var2%
SHIFT
goto :CHECKFORSWITCHES
:PARAM5
@echo This is Param5
SHIFT
goto :CHECKFORSWITCHES
:usage
@echo Usage: %0 ^<Write your command here^>
exit /B 1 
```

上面的脚本还检查任何参数的第一个字符，因此如果您需要单独使用该代码，您当然可以使用它，但我认为这不是一个好方法。

上面如果你需要编写一些基于“-”或“/”的逻辑，只需使用 IF %var2%=='/" GOTO XXX ，你可以做任何你想做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T01:38:52.867

您可以将参数传输到环境变量，然后使用 SET 子字符串操作查看第一个字符。（`HELP SET`从命令行键入以获取有关子字符串操作的信息）

```
@echo off
set "var=%~1"
if defined var if "%var:~0,1%" equ "-" echo arg 1 is a flag 
```

# python - 如何查询 dbpedia 资源本体 'wikiPageExternalLink'

> ID：10693216
> 
> 赞同：7
> 
> 时间：2012-05-21T21:56:45.537
> 
> 标签：python, sparql, dbpedia

在 python 中使用 sparql\sparqlwrapper，我将如何查询某个 dbpedia 资源的值？例如，我将如何获得[http://dbpedia.org/page/Asturias](http://dbpedia.org/page/Asturias)的 dbpedia-owl:wikiPageExternalLink 值？这是一个关于如何查询阿斯图里亚斯的 rdfs:label 的简单示例。但我不知道如何修改查询/查询参数以获取属性/本体的值，而不是 rdfs 模式中包含的值。这是示例：

```
from SPARQLWrapper import SPARQLWrapper, JSON, XML, N3, RDF
sparql = SPARQLWrapper("http://dbpedia.org/sparql")
sparql.setQuery("""
    PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
    SELECT ?label
    WHERE { <http://dbpedia.org/resource/Asturias> rdfs:label ?label }
""")
print '\n\n*** JSON Example'
sparql.setReturnFormat(JSON)
results = sparql.query().convert()
for result in results["results"]["bindings"]:
    print result["label"]["value"] 
```

希望收到反馈。提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T00:10:25.577

不知道你在哪里卡住了——这真的很容易：

```
SELECT ?label
WHERE { <http://dbpedia.org/resource/Asturias>
            dbpedia-owl:wikiPageExternalLink ?label } 
```

通常你需要声明命名空间前缀，`rdfs:`或者`dbpedia-owl:`如果你想在查询中使用它们，但在 DBpedia 端点上，即使没有它也可以工作。如果你愿意，你可以声明它们：

```
PREFIX dbpedia-owl: <http://dbpedia.org/ontology/>
SELECT ?label
WHERE { <http://dbpedia.org/resource/Asturias>
            dbpedia-owl:wikiPageExternalLink ?label } 
```

[您可以通过访问http://dbpedia.org/sparql](http://dbpedia.org/sparql)并单击右上角附近的“命名空间前缀”来找到与前缀对应的完整 URI 。

如果要重命名变量（例如， from `?label`to `?link`），请执行以下操作：

```
PREFIX dbpedia-owl: <http://dbpedia.org/ontology/>
SELECT ?link
WHERE { <http://dbpedia.org/resource/Asturias>
            dbpedia-owl:wikiPageExternalLink ?link } 
```

并且您还必须更改`"label"`从`"link"`JSON 结果中获取值的 Python 代码。

# objective-c - 一个奇怪的 C 字符串和 NSString 比较问题

> ID：10693219
> 
> 赞同：3
> 
> 时间：2012-05-21T21:57:04.807
> 
> 标签：objective-c, c, string, cocoa, character-encoding

请考虑以下代码：

```
NSString *string = @"ä";
const char *str1 = [string cStringUsingEncoding:NSUTF8StringEncoding];
const char *str2 = "ä";
NSLog(@"C string comparison: %d",strcmp(str1,str2));
NSLog(@"str1: \"%s\"", str1);
NSLog(@"str2: \"%s\"", str2); 
```

如果从一个全新的 Foundation 项目运行，该程序会输出：

```
C string comparison: 0
str1: "√§"
str2: "√§" 
```

这确实是我期望发生的，因为字符串应该是相同的。

但是，如果我在另一个代码库的某个深处运行完全相同的代码，我会得到以下输出：

```
C string comparison: 31
str1: "‚àö¬ß"
str2: "√§" 
```

什么可以解释这种差异？我很确定这两个文件都采用 UTF-8 编码。那——不同的文件编码——是这种行为的唯一可能解释，对吧？

任何想法在第二种情况下可能出了什么问题？我该如何解决？

（我可能应该提一下，在第二种情况下，代码在`.mm`文件中运行，即在 Objective-C++ 下。这可以解释吗？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:20:21.413

您可以尝试使用字符的 unicode 版本吗？

IE

```
NSString * string1 = @"\u00e4" ; 
```

参看。[http://blog.ablepear.com/2010/07/objective-c-tuesdays-unicode-string.html](http://blog.ablepear.com/2010/07/objective-c-tuesdays-unicode-string.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:01:33.063

源文件如何在磁盘上编码是一回事。编译器如何*认为*它被编码是另一回事。默认情况下，GCC 假定为 UTF-8，但可以从语言环境或`-finput-charset=<charset>`选项中告知它是另一种编码。我希望 Clang 支持同样的事情。

Xcode 有自己的源文件编码概念。我不知道它是否会调整编译命令以使用上述选项传递它，但我不会感到惊讶。

GCC 也有执行字符集的概念。这就是它将字符串写入二进制文件的方式。查看`-fexec-charset=<charset>`选项。

因此，编译器根据输入字符集解释文件的字节，并将它们写到执行字符集中的二进制文件中。如果这两者不同，那么这涉及转换。这是每个翻译单元的事情，因此对于不同的源文件可能会发生不同的情况。

另一个问题是“ä”在 Unicode 中有两种可能的表示形式。它可以是带分音符号的拉丁文小写字母 A (U+00E4)，也可以是拉丁文小写字母 A (U+0061) 后跟分音符号组合 (U+0308)。在 UTF-8 中，这将是 0xC3 0xA4 与 0x61 0xCC 0x88。您的两个源文件可能会以不同的方式表达相同的字符，这意味着它们确实包含不同的字符串（在所有级别：C 字符串`NSString`，等等，尽管如果未指定，`NSString`将忽略方法的差异；尽管方法会进行文字比较）。当然，如果这两个字节序列以不同的方式在编码之间进行转换，这种情况会更加严重。`-compare:...``NSLiteralSearch``-isEqual...`

因此，您需要追踪包含相关字符串的特定源文件。使用十六进制转储准确检查它们包含哪些**字节。**检查用于编译它们的命令（如果语言环境可能起作用，可能还有环境）以查看编译器对输入和可执行字符集的看法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T11:50:35.530

从[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)：

> 保证返回的 C 字符串仅在接收器被释放或当前自动释放池被清空之前有效，以先发生者为准。

我认为在你的情况下，要么接收器被释放，要么当前的自动释放池被清空。
例如

```
NSString *string = @"ä";
NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
const char *str3 = [string cStringUsingEncoding:NSUTF8StringEncoding];
[pool release];
NSLog(@"str1: \"%s\"", str3);
const char *str2 = "ä";
NSLog(@"C string comparison: %d",strcmp(str3,str2));
NSLog(@"str2: \"%s\"", str2); 
```

输出是

```
2012-05-22 17:14:50.069 test[32895:a0f] str1: "√§"
2012-05-22 17:14:50.071 test[32895:a0f] C string comparison: -195
2012-05-22 17:14:50.074 test[32895:a0f] str2: "√§" 

NSString *string = @"ä";
NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
const char *str3 = [string cStringUsingEncoding:NSUTF8StringEncoding];
[pool release];
const char *str2 = "ä";
NSLog(@"C string comparison: %d",strcmp(str3,str2));
NSLog(@"str1: \"%s\"", str3);
NSLog(@"str2: \"%s\"", str2); 
```

输出是

```
2012-05-22 17:19:13.226 test[33153:a0f] C string comparison: 0
2012-05-22 17:19:13.228 test[33153:a0f] str1: ""
2012-05-22 17:19:13.229 test[33153:a0f] str2: "√§" 
```

# javascript - 如何从 JavaScript 调用 JQuery 函数（异步调用后）

> ID：10693222
> 
> 赞同：0
> 
> 时间：2012-05-21T21:57:15.010
> 
> 标签：javascript, jquery, json, flot

我现在正在开发的代码的想法是从 JSON 文件（我从服务器获取）中提取数据，然后使用漂亮的图形显示结果。问题是我无法检索将 JSON 结果保存在 Jquery 代码中的对象，因此我可以将它们加载到图形中。为了简化，我的代码是这样的（Javascript部分）

```
var obj; //I initialize it here in order to make it global though it doesn't work

function handle_json() {
  if (http_request.readyState == 4) {
     if (http_request.status == 200) {
      var json_data = http_request.responseText; 
      obj = eval("(" + json_data + ")");
      //at this point I have the information I want in "obj"
} else {
  alert("A problem ocurred.");
}
http_request = null; 
```

} }

但现在我想将“obj”发送到我的 jQuery 代码，这样我就可以访问信息并显示它。但是如果尝试这个（jQuery部分）

```
$(function () {
 alert(obj.results.bindings[0].a.value); //<-- this doesn't work, obj isn't initialized
var fert = [];
fert = [[1990, 1.28], [1995, 1.25], [2000, 1], [2005, 1.3], [2010, 1.83]];

var plot = $.plot($("#placeholder"),
       [ { data: fert, label: "Fertility"} ], {
           series: {
               lines: { show: true },
               points: { show: true }
           },
           grid: { hoverable: true, clickable: true },
           yaxis: { min: 0, max: 2}
         }); 
```

我明白了问题所在，我进行了异步 Ajax 调用，我需要在评估 de json 信息（ obj = eval("(" + json_data + ")") ）后立即执行 jQuery 但我只是不知识！如果有帮助，我使用了一个名为“flot”的库来绘制图形。非常感谢！任何帮助将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:07:23.757

当前，您的 jQuery 代码位于文档就绪处理程序中，因此（显然）它在文档就绪后立即运行 - 与您的 Ajax 调用完全无关的时间。相反，将您的 jQuery 代码放在它自己的函数中，并在您设置`obj`. 或者只是将 jQuery 代码直接移动到您设置的函数中`obj`：

```
 var json_data = http_request.responseText; 
  obj = eval("(" + json_data + ")");
  //at this point I have the information I want in "obj"
  // either process obj directly here, or call a function to do it...
  processData(obj);

  ...

  function processData(obj) {
     // your jQuery code here, using obj
  } 
```

不过更好的是，因为无论如何您都在使用 jQuery，所以最好使用[jQuery 的 Ajax 函数之一](http://api.jquery.com/category/ajax/)来执行 Ajax 。我建议[`$.getJSON()`](http://api.jquery.com/jQuery.getJSON/)。

```
$.getJSON("yourURLhere", function(obj) {
    // your jQuery code using obj here
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:08:43.460

当您使用 jQuery 的 AJAX 调用时，您可以提供一个函数在接收到数据后执行。它甚至有一个自动解析 JSON 的变体，如下所示：

```
$.getJSON(url, options, function(response) {
    ... do something with the data ...
}); 
```

# git - 如何编写从不同文件夹推送文件的 bash 脚本？

> ID：10693228
> 
> 赞同：0
> 
> 时间：2012-05-21T21:58:01.360
> 
> 标签：git, bash

我正在编写一个 cron 作业，每小时将目录“~/foo”中的文件推送到远程服务器。

此 cron 作业运行的脚本位于“~/bar/backupScript.sh”。因此，我不能直接运行这样的 git 命令，`git commit -m 'backup'`因为“~/bar”不是 git 存储库。

如何从“~/bar/backupScript.sh”运行与“~/foo”中的文件相关的 git 命令？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:59:36.370

`cd ~/foo`在脚本的开头。

# android - 网络不可用 - 怎么做（如在 Twitter 中）

> ID：10693230
> 
> 赞同：0
> 
> 时间：2012-05-21T21:58:14.573
> 
> 标签：android, networking

我需要我的应用程序不会导致异常并在智能手机无法访问互联网时结束，我会发出网络不可用消息，以及适用于 android 的官方 Twitter 应用程序，有人可以给我看一个例子吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:21:05.500

有趣的是，如果你继续阅读 SOF，这个新问题给出了答案：[为图像下载添加边界控制](https://stackoverflow.com/questions/10693386/add-boundary-control-for-image-downloads)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:25:21.770

这是一个快速的解决方案：

```
try {
   // your network request goes here
} catch (IOException e) {
   // there is a problem with the connection, show an alert dialog
} 
```

# c# - 优雅的 TryParse

> ID：10693231
> 
> 赞同：75
> 
> 时间：2012-05-21T21:58:22.437
> 
> 标签：c#

我觉得每次我使用`TryParse`它都会导致代码有些难看。主要是我这样使用它：

```
int value;
if (!int.TryParse(someStringValue, out value))
{
    value = 0;
} 
```

是否有一些更优雅的解决方案来解析所有基本数据类型，具体来说有没有办法在一行中进行故障安全解析？通过故障保险，我假设如果解析无一例外地失败，则设置默认值。

顺便说一句，这是针对即使解析失败也必须执行某些操作的情况，只需使用默认值即可。

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2013-09-24T11:01:22.803

这是有效的，如果您喜欢单线，您可能会更喜欢它：

```
int i = int.TryParse(s, out i) ? i : 42; 
```

如果无法解析字符串，则设置 的值`i`，否则设置。`42``s``i = i`

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-05-21T22:07:05.870

直接扩展方法怎么样？

```
public static class Extensions
{
    public static int? TryParse(this string Source)
    {
        int result;
        if (int.TryParse(Source, out result))
            return result;
        else

            return null;
    }
} 
```

或者在一行中使用新的 c# 语法：

```
public static int? TryParse(this string Source) => int.TryParse(Source, out int result) ? result : (int?)null; 
```

用法：

```
v = "234".TryParse() ?? 0 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-05-21T22:03:45.640

您可以编写自己的方法以获得更适合您的解决方案。不久前，我偶然发现了`Maybe`包装方法的类。`TryParse`

```
int? value = Maybe.ToInt("123");

if (value == null)
{
    // not a number
}
else
{
    // use value.Value
} 
```

或在线指定默认值：

```
int value = Maybe.ToInt("123") ?? 0; 
```

`Nullable<int>`观察/`int?`和之间的区别`int`。

有关更多信息，请参阅[http://www.kodefuguru.com/post/2010/06/24/TryParse-vs-Convert.aspx](http://www.kodefuguru.com/post/2010/06/24/TryParse-vs-Convert.aspx)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-07-03T14:28:01.893

~~C# 6~~ C# 7中有一个不错的小功能，[声明表达式](https://roslyn.codeplex.com/wikipage?title=Language%20Feature%20Status&referringTitle=Documentation)，所以在 C# 7 中，而不是：

```
int x;
if (int.TryParse("123", out x))
{
  DoSomethingWithX(x);
} 
```

我们可以用：

```
if (int.TryParse("123", out int x))
{
  DoSomethingWithX(x);
} 
```

对我来说足够好:)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-03-05T11:38:11.277

在单行中使用 C# 7

```
int.TryParse(s, out var i) ? i : (int?)null; 
```

示例方法：

```
public static int? TryParseSafe(string s)
{
    return int.TryParse(s, out var i) ? i : (int?)null;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-21T22:09:19.423

在您的特定示例中，您可以这样做：

```
int value; 
int.TryParse(someStringValue, out value); 
```

...因为 Int32.TryParse()`value=0`如果解析失败，则记录为设置。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-21T22:05:22.263

您可以改用 TypeDescriptor：

```
public T Convert<T>(string input, T defaultVal)
{
    var converter = System.ComponentModel.TypeDescriptor.GetConverter(typeof(T));
    if(converter != null)
    {
        return (T)converter.ConvertFromString(input);
    }
    return defaultVal;
}

public T Convert<T>(string input)
{
    return Convert(input, default(T));
} 
```

您也可以限制`T`struct 和 use `Nullable`（根据@skarmats 的回答）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-22T12:01:15.717

这是尝试 F# 的 C# 开发人员的惊喜之一。TryParse 方法返回一个包含布尔值和值的元组。

# javascript - 为什么 $.post 在我的网站上似乎无法在 iPad/iPhone 上运行？

> ID：10693233
> 
> 赞同：2
> 
> 时间：2012-05-21T21:58:34.883
> 
> 标签：javascript, jquery, ipad, debugging, qtip

[这](http://wncba.co.uk/results/?action=navigate&season=2012&league_id=3&division_id=14&fixture_id=2444&nav_key=4bb9400fb779ddf686dea09070519589)是其中一页。

当您单击表格底部的错误图标时，表格中会出现更多信息。然后，当您单击表格中的图标时，会出现一个 qtip 弹出窗口，并通过 jquery 函数 $.post 获取代码。我已经在 IE、Chrome、Opera 和 Firefox 中对其进行了测试，并且运行良好。在 ipod/ipad 上的 safari 中它没有，然后设备上的开发者控制台并不是很有帮助。其中出现的一件事（两次）是：

* * *

```
JavaScript：错误
不明确的
类型错误：“未定义”不是函数

```

* * *

任何人都知道可能是什么触发了这种情况，以及这是否与 ajax 不起作用的原因有关？与这一切相关的脚本在[这里](http://wncba.co.uk/results/javascript/error-reportingv2.js)。

谢谢。

* * *

**编辑：**这是我现在更改以修复它的代码的一部分。它已经从

```
$.post("ajax_requests.php?action=get_error_code", {data:$(this.targetThis).attr('data-errorData')}, function(data) {

    $(this.qtipThis).find('.code').html(data);

    $(this.qtipThis).find('.email.link').attr('onclick', '');
    $(this.qtipThis).find('.email .link').attr('href', 'mailto:'+errorReportEmail+'?subject=网站表错误(错误id: '+data+')');

}.bind(this));

```

对此（感谢@raina77ow 的回答）

```
    变种自我=这个；
    $.post("ajax_requests.php?action=get_error_code", {data:$(this.targetThis).attr('data-errorData')}, function(data) {

    $(self.qtipThis).find('.code').html(data);

    $(self.qtipThis).find('.email.link').attr('onclick', '');
    $(self.qtipThis).find('.email .link').attr('href', 'mailto:'+errorReportEmail+'?subject=网站表错误(错误id: '+data+')');
});

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:10:24.443

如果问题与 相关`$.post`，可能是因为[此问题](https://github.com/Shopify/batman/issues/189)的某些变化？这不是关于`batman`，而是关于 Function.bind() 方法。

# android - 在一类实用函数中初始化静态变量

> ID：10693235
> 
> 赞同：0
> 
> 时间：2012-05-21T21:58:40.563
> 
> 标签：android

对于我的 Android 应用程序，我编写了一个由应用程序中各种活动所需的实用程序函数组成的类。在这个类中，我需要一个上下文变量（用于处理文件）以及一个首选项管理器和首选项编辑器的实例.此外，需要一个长整数来表示当前日期作为时间戳：

```
private static long today;
private static Context myContext;
private static SharedPreferences sharedPrefs;
private static Editor editor; 
```

这是初始化这些变量的正确方法。我已经尝试通过如下所示的私有构造函数来执行此操作，但我遇到了错误。

```
private NetworkController()
{
    //Getting the Unix timestamp for today
    GregorianCalendar aDate = new GregorianCalendar();
    GregorianCalendar tDate = new  
    GregorianCalendar(aDate.get(Calendar.YEAR),aDate.get(Calendar.MONTH),  
    aDate.get(Calendar.DAY_OF_MONTH), 0, 0, 0);
    today = (tDate.getTimeInMillis())/1000; 
     //The preferences manager for reading in the preferences
    sharedPrefs = PreferenceManager.getDefaultSharedPreferences(myContext);
    //The preferences editor for modifying the preferences values
    editor = sharedPrefs.edit();
} 
```

一种方法是在使用它的每个活动中创建此类的一个实例，但我不想这样做。还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:10:55.553

如果您有一组随处使用的东西并且只想要一个实例，则可以使用所谓的[*单例*](https://en.wikipedia.org/wiki/Singleton_pattern)。例如，这里有一个非常简单的，它包含一个名为 的整数`level`：

```
public class Utility {
    private static Utility theInstance;

    public int level;

    private Utility() {
        level = 1;
    }

    public static getUtility() {
        if (theInstance == null) {
            theInstance = new Utility();
        }
        return theInstance;
    }

} 
```

然后你可以像这样使用它：

```
Utility u = Utility.getUtility();
u.level++; 
```

然而，许多人不鼓励使用单例，因为它们会导致程序行为混乱。关于这个主题的一篇好文章是[Singletons are Pathological Liars](http://misko.hevery.com/2008/08/17/singletons-are-pathological-liars/)。单例在某些情况下可能很有用，但您应该注意使用它们所涉及的陷阱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:16:44.907

@Greg 是对的，只是不要使用任何静态的东西来做你想做的事。您没有理由不想在这里放置普通对象。将上下文作为参数传递，并在需要它们为您服务时实例化您的对象：

```
private long today;
private Context myContext;
private SharedPreferences sharedPrefs;
private Editor editor;

public NetworkController( Context context )
{
    this.context = context;
    //Getting the Unix timestamp for today
    GregorianCalendar aDate = new GregorianCalendar();
    GregorianCalendar tDate = new  
    GregorianCalendar(aDate.get(Calendar.YEAR),aDate.get(Calendar.MONTH),  
    aDate.get(Calendar.DAY_OF_MONTH), 0, 0, 0);
    today = (tDate.getTimeInMillis())/1000; 
     //The preferences manager for reading in the preferences
    sharedPrefs = PreferenceManager.getDefaultSharedPreferences(this.context);
    //The preferences editor for modifying the preferences values
    editor = sharedPrefs.edit();
} 
```

单例是一种糟糕的编程方式，它使测试变得非常困难。即使你还没有使用测试，也不要使用单例，当事情变得更复杂时，这会导致代码质量很差，并且会变得一团糟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T22:17:20.760

在这里你可以这样做：

```
public class NetworkController {

     SharedPreferences settings;
     SharedPreferences.Editor editor;

     public NetworkController(Context context){
        settings = PreferenceManager.getDefaultSharedPreferences(context);
        editor = settings.edit();
     }

     public void saveName(String name){
          editor.putString("name", name).commit();
     }

     public String getName(){
          return settings.getString("name");
     }

     public static long getTimeStamp(){
          return System.currentTimeMillis();
     } 

} 
```

您可以使用如下类：

```
 NetworkController prefs = new NetworkController(context); // Context being an Activity or Application
 prefs.saveName("blundell");
 System.out.println(prefs.getName()); // Prints 'blundell';
 System.out.println(NetworkController.getTimeStamp()); // Prints 1294931209000 
```

* * *

如果您不想在每个类中创建一个实例，您可以在应用程序的实例上创建并始终引用它：

```
public class MyApplication extends Application {

     private NetworkController myPrefs;

     public NetworkController getPrefs(){
          if(myPrefs == null){ // This is called lazy initialization
             myPrefs = new NetworkController(this); // This uses the Application as the context, so you don't have issues when Activitys are closed or destroyed
          }
          return myPrefs;
     }

} 
```

您需要添加`MyApplication`到您的清单：

```
<application 
    android:name="com.your.package.MyApplication"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"> 
```

要使用这个单一实例，您可以这样做：

```
public class MyActivity extends Activity {

     public void onCreate(Bundle savedInstanceState){
          super(savedInstanceState);

          NetworkController prefs = ((NetworkController) getApplicationContext()).getPrefs();

          // use this object just like shown above
          prefs.saveName("blundell"); // etc
     }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T00:09:19.050

这里已经发布了很多很好的建议，但我想这种“实用程序”/“帮助程序”功能的另一种方法是简单地传递您需要逻辑处理的参数。`Context`在您的情况下，您可以简单地将其传入，而不是尝试使逻辑在本地引用上工作：

```
public static void NetworkController(Context context) {
    //Getting the Unix timestamp for today
    GregorianCalendar aDate = new GregorianCalendar();
    GregorianCalendar tDate = new  
    GregorianCalendar(aDate.get(Calendar.YEAR),aDate.get(Calendar.MONTH),  
    aDate.get(Calendar.DAY_OF_MONTH), 0, 0, 0);
    long today = (tDate.getTimeInMillis())/1000; 
    //The preferences editor for modifying the preferences values
    SharedPreferences.Editor editor = PreferenceManager.getDefaultSharedPreferences(context).edit();
    ...
} 
```

您可以即时计算/推断的其他变量。这可能意味着更多的垃圾收集，但在内存管理方面应该是相对安全的。

# http - 通过 HTTP 将受密码保护的文档发布到 Solr

> ID：10693237
> 
> 赞同：2
> 
> 时间：2012-05-21T21:58:41.467
> 
> 标签：http, authentication, solr

我想发布一个受密码保护的 http 文档。
在您访问实际文档之前，它有一个用户名和密码登录页面。我试着这样做

```
curl 
 -u username:password 
 "http://localhost:8983/solr/update/extract?literal.id=doc900&commit=true" 
 -F stream.url=http://somewebsite.com/docs/DOC2609 
```

但它只索引登录页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:20:49.850

我的猜测是，您的此页面使用的身份验证方法不是 curl 开箱即用支持的 HTTP 身份验证方法之一。

HTTP 身份验证是基本的——有些人可能会说是微不足道的——而且它最基本的形式从根本上是不安全的（字面意思是，“基本”模式 HTTP 身份验证通过网络以纯文本形式发送用户的密码，作为请求标头之一）。我只见过它与 HTTPS 结合使用，即使是现在也很少见。

通常避免使用 HTTP 身份验证，而支持通过 HTTPS 的 HTTP PUT 或 POST 请求，通常通过某种跨站点请求伪造 (CSRF) 预防措施或 OAUTH2 策略（通常将问题推迟到身份验证代理的实现）来加强）。

你的问题是，curl 对此一无所知。如果您使用 python 编程，您可能会发现该`requests`软件包很有帮助（并且在其启动设计中比 curl 更现代）。Solr 不会在意任何一种方式，如果您正确调用它的 HTTP API。

# c# - 对匿名类型的 foreach

> ID：10693238
> 
> 赞同：4
> 
> 时间：2012-05-21T21:58:46.253
> 
> 标签：c#, foreach, anonymous

```
using System;
using System.Linq;
using System.Text;
using System.Net;
using System.IO;

namespace LearningJustCode
{
    class Program
    {
        static void Main(string[] args)
        {
            Update();
        }

        static void Update()
        {
            var quote1 = new { Stock = "DELL", Quote = GetQuote("DELL") };
            var quote2 = new { Stock = "MSFT", Quote = GetQuote("MSFT") };
            var quote3 = new { Stock = "GOOG", Quote = GetQuote("GOOG") };

            var quotes = new object[] { quote1, quote2, quote3 };

            foreach (var item in quotes)
            {
                Console.WriteLine(item.Stock);
                Console.WriteLine(item.Quote.ToString());
            }
        Console.ReadKey();

        }

        static string GetQuote(string stock)
        {
            try
            {
                return InnerGetQuote(stock);
            }
            catch (Exception ex)
            {

                Console.WriteLine(ex.Message);
                return "N/A";
            }
        }

        static string InnerGetQuote(string stock)
        {
            string url = @"http://www.webservicex.net/stockquote.asmx/GetQuote?symbol={0}";
            var request = HttpWebRequest.Create(string.Format(url, stock));

            using (var response = request.GetResponse())
            {
                using (var reader = new StreamReader(response.GetResponseStream(), Encoding.ASCII))
                {
                    return reader.ReadToEnd();
                }
            }

        }
    }
} 
```

我在项目上得到一个波浪线；变量“项目”仅分配给。此代码已根据 Paul Kimmel 的书 C# Unleashed by Sams 稍作修改。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-21T22:21:38.633

您的数组必须是您的股票报价的类型。您的股票报价是匿名类型，因此我们也需要匿名定义数组。这可以干净地完成为：

```
 var quotes = new[]{  new { Stock = "DELL", Quote = "123" },
                         new { Stock = "MSFT", Quote = "123" },
                         new { Stock = "GOOG", Quote = "123" }};

    foreach (var item in quotes)
    {
        Console.WriteLine(item.Stock);
        Console.WriteLine(item.Quote.ToString());
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T22:02:27.043

我想问题出在那一行：

```
var quotes = new object[] { quote1, quote2, quote3 }; 
```

引号是一个对象数组，而不是该匿名类型的数组。foreach 也只有对象值。您可以尝试在一行或 lambda 表达式中形成数组

一个***非常***肮脏的解决方法是将“var”更改为“动态”

```
 var quote1 = new { Stock = "DELL", Quote = ("DELL") };
        var quote2 = new { Stock = "MSFT", Quote = ("MSFT") };
        var quote3 = new { Stock = "GOOG", Quote = ("GOOG") };

        var quotes = new object[] { quote1, quote2, quote3 };

        foreach (dynamic item in quotes)
        {
            var r = item.Stock;

        } 
```

一个更干净的解决方案是省略“对象”，因此编译器可以生成一个匿名类型数组

```
 var quote1 = new { Stock = "DELL", Quote = ("DELL") };
        var quote2 = new { Stock = "MSFT", Quote = ("MSFT") };
        var quote3 = new { Stock = "GOOG", Quote = ("GOOG") };

        var quotes = new [] { quote1, quote2, quote3 };

        foreach (var item in quotes)
        {
            var r = item.Stock;

        } 
```

# objective-c - 将事件添加到 iCal

> ID：10693239
> 
> 赞同：1
> 
> 时间：2012-05-21T21:58:49.877
> 
> 标签：objective-c, events, calendar, icloud, icalendar

我遇到了 CalCalendar 框架的问题。我想检索默认的 iCloud 日历并向其添加事件。这是我的代码，但我有这个“错误：提醒日历不支持事件”。

```
IBOutlet NSDatePicker *minDatePicker;

/////

#import <CalendarStore/CalendarStore.h>

-(void)awakeFromNib {

[minDatePicker setDateValue:[NSDate date]];  
[minDatePicker setLocale:[NSLocale currentLocale]];

}

-(IBAction)addEvent:(id)sender {

CalCalendarStore *calendarStore = [CalCalendarStore defaultCalendarStore];
NSArray *calendars = [calendarStore calendars];

for (CalCalendar *calendar in calendars) {
    if (calendar) {

        CalEvent *event = [CalEvent event];

[event setTitle:@"title"];
[event setStartDate:[minDatePicker dateValue]];
[event setEndDate:[minDatePicker dateValue]];
[event setCalendar:calendar];

    NSError *error;
    [calendarStore saveEvent:event span:CalSpanThisEvent error:&error];

        NSLog(@"error:%@", [error localizedDescription]);

     break;   
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T19:49:44.733

我知道我不应该在这里放任何不能回答问题的东西。但是，奇怪的是，我在同一天发现了同样的错误。框架中是否有可能发生变化？还是我们只是同时做错了同样的事情？希望有人会对此有所启发。如果我弄清楚了，我一定会在这里发布！

顺便说一句，您的代码对我来说看起来不错！

# c# - 使用 Web 服务遍历 Sharepoint 列表项的属性，获取“对象引用未设置为对象实例”

> ID：10693246
> 
> 赞同：1
> 
> 时间：2012-05-21T22:00:11.483
> 
> 标签：c#, web-services, sharepoint

我正在使用 C# 调用 Sharepoint Web 服务。我想得到一个 Sharepoint 列表，然后对于列表中的每个项目，将其属性写入控制台。当我使用`foreach`. 代码如下：

```
class Program
    {
        static void Main(string[] args)
        {
            try
            {                 
                cSharpTest_service.Lists lists = new cSharpTest_service.Lists();
                lists.Url = "http://wsssandbox/sites/cSharp/_vti_bin/lists.asmx";
                lists.Credentials = System.Net.CredentialCache.DefaultCredentials;
                System.Xml.XmlNode listData = lists.GetListItems("cSharpTestList", "", null, null, "", null, "");

                foreach (System.Xml.XmlNode iterateNode in listData)
                {

                    Console.WriteLine("--NODE--");
                    System.Xml.XmlAttributeCollection attrs = iterateNode.Attributes;
                    foreach (System.Xml.XmlAttribute attr in attrs)
                    {
                        Console.WriteLine("Name:");
                        Console.WriteLine(attr.Name);
                        Console.WriteLine("Value:");
                        Console.WriteLine(attr.Value);
                    }

                }
                Console.ReadLine();

            }
            catch (Exception e)
            {
                Console.WriteLine(e.Message);
                Console.ReadLine();
            }

        }
      } 
```

我认为它引发了异常，因为某些属性适用`Null`于某些列表项。`foreach`但是我不知道如何在迭代过程中检查属性是否为空。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T00:23:00.713

看看这个例子和这篇[文章](http://sarangasl.blogspot.com/2009/12/sharepoint-list-web-service.html)。

```
public void getListData()
{
  WS_Lists.Lists myservice = new WS_Lists.Lists();
  myservice.Credentials = System.Net.CredentialCache.DefaultCredentials;
  myservice.Url = "http://merdev-moss:5050/testsara/_vti_bin/Lists.asmx";

  try
  {
    /* Assign values to pass the GetListItems method*/
    string listName = "{5C65CB1A-2E1B-488A-AC07-B115CD0FC647}";
    string viewName = "{75E689B4-5773-43CB-8324-58E42E1EB885}";
    string rowLimit = "100";

    // Instantiate an XmlDocument object
    System.Xml.XmlDocument xmlDoc = new System.Xml.XmlDocument();
    System.Xml.XmlElement query = xmlDoc.CreateElement("Query");
    System.Xml.XmlElement viewFields = xmlDoc.CreateElement("ViewFields");
    System.Xml.XmlElement queryOptions = xmlDoc.CreateElement("QueryOptions");

    /*Use CAML query*/
    query.InnerXml = "<Where><Gt><FieldRef Name=\"ID\" />" +
    "<Value Type=\"Counter\">0</Value></Gt></Where>";
    viewFields.InnerXml = "<FieldRef Name=\"Title\" />";
    queryOptions.InnerXml = "";

    System.Xml.XmlNode nodes = myservice.GetListItems(listName, viewName, query, viewFields, rowLimit, null, null);

    foreach (System.Xml.XmlNode node in nodes)
    {
        if (node.Name == "rs:data")
        {
            for (int i = 0; i < node.ChildNodes.Count; i++)
            {
                if (node.ChildNodes[i].Name == "z:row")
                {
                    Response.Write(node.ChildNodes[i].Attributes["ows_Title"].Value + "</br>");
                }
            }
        }
    }
}
 catch (Exception ex)
 {
    Response.Write(ex.Message);
 }
} 
```

# html - Youtube 嵌入 chrome 的问题

> ID：10693248
> 
> 赞同：-1
> 
> 时间：2012-05-21T22:00:29.363
> 
> 标签：html, youtube

我正在使用此代码

```
<div onclick="thevid=document.getElementById('thevideo'); 
              thevid.style.display='block'; 
              this.style.display='none'">
    <img src="../img/film.jpg" style="cursor:pointer" />
</div>
<div id="thevideo" style="display:none">
    <iframe width="600" 
            height="335" 
            src="https://www.youtube.com/embed/MZ-NmMMTyTU?&rel=0&theme=light&showinfo=0&disablekb=1&hd=1&autohide=1&color=white&autoplay=1"
            frameborder="0"
            allowfullscreen>
    </iframe></div>
</div> 
```

在我的网站上嵌入 YouTube 视频，它在 Firefox 中运行良好。但是在 Chrome 中，视频开始播放，在我放在顶部的图像后面。

任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:19:19.417

我刚刚使用 Javascript API 制作了一个 YouTube 处理程序。

HTML 代码：

```
<b id="youbox" class="youbox youbox-left">
    <div id="player"></div> <!--player will loads here-->
</b>
<div id="youtube-select" class="youtube-select clearfix">
    <ul>
        <!-- use this part as a dynamic block, so you can multiply this -->
        <li class="playanothervideo {ACTIVE}" rel="{YOUTUBE VIDEO ID}">
            <h1>{TITLE OF VIDEO}</h1>
        </li>
        <!-- end of dynamic block. important: at the dom ready you have to make one li active, because that will be the first loaded video -->
    </ul>
</div> 
```

javascript

```
if (($("#youbox").size() > 0)) // if you have youbox, which means you want a youtube player
{
    var tag = document.createElement('script');
    tag.src = "http://www.youtube.com/player_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    var player; // insert youtube player api to the html source, and make a player instance

    function onYouTubePlayerAPIReady() // on youtube player api loaded
    {
        player = new YT.Player('player', {
        height: '350', // height of player
        playerVars: { 'color': 'white', 'theme': 'light', 'modestbranding': 1, 'rel':0, 'showsearch':0, 'showinfo': 0, 'iv_load_policy': 3, 'hd': 1, 'controls':1}, // personalize players lookout (this is white instead of red)
        width: '629', // width of player
        videoId: $("#youtube-select li.active").attr("rel"), // aye, this is the first video id's getter
        events:
            {
                'onReady': onPlayerReady, // the easiest event handling, calls onplayerready fn
            }
        });
    }

    function playAnotherVideo(id) // play another video event handler
    {
        if (player.getPlayerState() == 1) // if video is playing
        {
        console.log("playerstate ok")
            player.stopVideo();       // stops video
            player.loadVideoById(id); // load other
            player.playVideo();       // starts other
        }
        else
        {
            player.cueVideoById(id);   // if not playing just loads the other video's thumbnail
        }
    }

    function onPlayerReady(event) 
    {
        event.target.setPlaybackQuality("hd720"); // setting 720p resolution by default (it's not tested yet, sorry)
    }
} 
```

并来自其他 js，但可以应用于第一个：

```
$(".playanothervideo").live("click", function(){
    playAnotherVideo($(this).attr("rel"));
    pickMe($(this), "active");
});
function pickMe(e, c) {
    e.siblings(e[0].tagName).removeClass(c);
    e.addClass(c);
} 
```

它选择视频并处理他们的活动课程。

祝你在 Youtubein 上好运。:)

有关更多信息，请查看：[https ://developers.google.com/youtube/js_api_reference](https://developers.google.com/youtube/js_api_reference)

# dataset - 我在哪里可以获得电影标题列表以及带有剧集标题的电视节目标题

> ID：10693249
> 
> 赞同：0
> 
> 时间：2012-05-21T22:00:32.730
> 
> 标签：dataset, imdb

IMDB 有电影标题可供下载，但没有电视节目标题。我打算只使用 pyIMDB，但看起来您无法轻松获取所有数据，只有与搜索查询类似的几个结果。有谁知道我在哪里可以买到这些东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T06:41:45.480

使用[IMDbPY](http://imdbpy.sf.net)，您可以获取[纯文本数据文件](http://www.imdb.com/interfaces)并将它们放入 SQL 数据库中。数据包括电视剧及其剧集。请参阅文档或在邮件列表中询问更多详细信息。

另外，不要忘记 IMDb 数据的许可仅授予个人和非商业用途。

# jquery - 导航菜单中的 jQuery 重置切换

> ID：10693253
> 
> 赞同：1
> 
> 时间：2012-05-21T22:00:57.880
> 
> 标签：jquery, menu, toggle, reset

我对 jQuery 相当陌生，并且我正在处理的当前项目存在问题。

我一直在寻找具有类似问题的其他问题，但在他们的情况下，解决方案对我不起作用。

在此站点上，用户将单击导航列表中的链接，该链接将滑出包含信息的 div。我使用了切换命令，因为我希望能够通过单击相同的链接来关闭显示和隐藏 div，我还希望能够通过单击不同的链接来隐藏活动的 div，目前效果很好。问题是当单击不同的链接并隐藏内容时，您必须双击以前的链接才能重置切换。

如何重置此切换，以便用户不必双击？

这是网站的链接[www.RickPatinoPhotography.com](http://www.rickpatinophotography.com)

我的代码：

```
//Slide Bio Div
    $('#showBio').toggle(function() {
            //shows Bio div
        $('#bio').animate({ marginLeft: '+=1316px'}, 500);
            //hides other divs if showing
        $('#work').animate({ marginLeft: '0px'}, 500);
        $('#contact').animate({ marginLeft: '0px'}, 500);
    }, function () {
            //returns Bio div to default state      
        $('#bio').animate({ marginLeft: '0px'}, 500);
    });

//Slide Work Div
    $('#showWork').toggle(function() {
            //shows Work div
        $('#work').animate({ marginLeft: '+=1316px'}, 500);
            //hides other divs if showing
        $('#bio').animate({ marginLeft: '0px'}, 500);
        $('#contact').animate({ marginLeft: '0px'}, 500);
            //returns Contact div to default state  
        }, function () {
        $('#work').animate({ marginLeft: '0px'}, 500);
    }); 

//Slide Contact Div
    $('#showContact').toggle(function() {
            //shows Contact div
        $('#contact').animate({ marginLeft: '+=1316px'}, 500);
            //hides other divs if showing
        $('#work').animate({ marginLeft: '0px'}, 500);
        $('#bio').animate({ marginLeft: '0px'}, 500);
            //returns Contact div to default state  
    }, function () {
        $('#contact').animate({ marginLeft: '0px'}, 500);
    }); 
}); 
```

**编辑：** 嗯，我能够想出一个解决方案，我能够创建一个基本的 .click 函数以及一个像冠军一样工作的 if/else 语句。感谢大家的关注。

**新代码：**

```
 //Slide Bio Div
    $('#showBio a').click(function() {
            //shows Bio div
        if ($('#bio').css("marginLeft") == "1316px"){
            $('#bio').animate({ marginLeft: '0px'}, 500);
        } else {
            $('#bio').animate({ marginLeft: '+=1316px'}, 500);
            //hides other divs if showing
            $('#work, #contact').animate({ marginLeft: '0px'}, 500);        
            $('#showBio a').addClass('activePage');
            $('#showWork a, #showContact a').removeClass('activePage');
            $("#showBio li, #showBio a").click(false);
        }
    });

//Slide Work Div
    $('#showWork a').click(function() {
            //shows Bio div
        if ($('#work').css("marginLeft") == "1316px"){
            $('#work').animate({ marginLeft: '0px'}, 500);
        } else {
            $('#work').animate({ marginLeft: '+=1316px'}, 500);
                //hides other divs if showing
            $('#bio, #contact').animate({ marginLeft: '0px'}, 500);
            $('#showWork a').addClass('activePage');
            $('#showBio a, #showContact a').removeClass('activePage');
        }
    }); 

//Slide Contact Div
    $('#showContact a').click(function() {
                //shows Bio div
        if ($('#contact').css("marginLeft") == "1316px"){
            $('#contact').animate({ marginLeft: '0px'}, 500);
        } else {
            $('#contact').animate({ marginLeft: '+=1316px'}, 500);
                //hides other divs if showing
            $('#work, #bio').animate({ marginLeft: '0px'}, 500);
            $('#showContent a').addClass('activePage');
            $('#showWork a, #showBio a').removeClass('activePage');
        }
    }); 
}); 
```

# entity-framework - 实体框架附加错误：ObjectStateManager 中已存在具有相同键的对象

> ID：10693254
> 
> 赞同：1
> 
> 时间：2012-05-21T22:01:00.843
> 
> 标签：entity-framework, asp.net-mvc-3, dbcontext

我是Entity Framework的新手，看了同名的问题，还没有找到满意的答案。

这是我的课：

```
public class MyUser
{
 public string FirstName { get; set; }
public virtual ICollection<ProfileSkillEdu> Skills { get; set; }
} 
```

在控制器中我有：

```
[HttpPost]
    public ActionResult EditProfile(MyUser user, string emailAddress)
    {
        try
        {
            if (ModelState.IsValid)
            {
                _unitOfWork.GetMyUserRepository().Update(user);
                _unitOfWork.Save();
                return View(user);
            }
        }
        catch (DataException)
        {
            //Log the error 
            ModelState.AddModelError("", "Unable to save changes. Try again, and if the problem persists see your system administrator.");
        }
        return View(user);
    } 
```

在我的用户存储库中：

```
public virtual void Update(TEntity entityToUpdate)
    {
        dbSet.Attach(entityToUpdate);

        context.Entry(entityToUpdate).State = EntityState.Modified;

    } 
```

我不断收到**具有相同键的对象已存在于 ObjectStateManager 中。ObjectStateManager 无法跟踪具有相同键的多个对象。**在 dbSet.Attach(entityToUpdate)。我观察了变量，发现如果 MyUser 只有 1 个 Skill 对象，那很好，因为当它 Attach 时，键是唯一的（值为 0）。但如果 MyUser 有 2 个技能对象，则两个主键的值都为 0，因此会出错。

有人能解释一下为什么所有 Skill 对象的主键的值都是 0 吗？另外，这个问题有简单的解决方案吗？我认为这应该是直截了当的，但我已经为此苦苦挣扎了好几个小时。

编辑：

我想知道问题是否是因为我如何使用上下文。

在控制器定义中，我有：

```
public class MyAccountController : Controller
{
IUnitOfWork _unitOfWork;

 public ActionResult EditProfile()
    {
        if (_user == null)
        {
            MembershipUser currentUser = Membership.GetUser();

            if (currentUser == null)
            {
                return RedirectToAction("Logon", "Account");
            }
            Guid currentUserId = (Guid)currentUser.ProviderUserKey;

            MyUserService svc = new MyUserService();

            MyUser user = svc.GetUserLoaded(currentUserId); //this uses include/eager loading to get the Skills too.

            if (user == null)
            {
                return RedirectToAction("Logon", "Account");
            }
            else
                _user = user;
        }

        return View(_user);
    }
} 
```

在我的 UnitOfWork 中，我有：

```
public class UnitOfWork:IUnitOfWork
{
    private GlobalContext context = new GlobalContext();

    private GenericRepository<MyUser> myUserRepository;
    private GenericRepository<Skill> skillRepository;

    .. and implementation of Save() and Dispose()
} 
```

# javascript - jQuery 函数找不到容器 - 可能是克隆错误？

> ID：10693255
> 
> 赞同：0
> 
> 时间：2012-05-21T22:01:05.563
> 
> 标签：javascript, jquery

我有一个以前没有的案例，真的无法弄清楚，这是什么问题。:( 我试图为我的旧的、不稳定的 js 代码创建一个控制器类，试图让它更加面向对象（是的，对我来说失败了，但实践也是知识之母）。所以，这是我的代码：

一个函数调用 Main 函数，该函数处理变量并弹出一个表单，例如：

```
function Main(com,  multiple, grid) {
    if (CheckTableFunctions(arguments) == true)
    {
        var partner = Partner.Factory(com);
        switch(com)
        {
            case "CreatePartners":
            ...
            break;

            case "GetPartners":
            $e = ShowModal(); // <- this makes a form visible
            Communicate(com, partner, function(data) <- ajax req. with callback
                {
                ... // <- manipulate data, fill form, etc.
                });
            Main("EditPartners", multiple, grid); // <- calling Main Editpartners case
            break; 
```

事实上，GetPartners 案例在 EditPartners 之前，只是为了填表而已。编辑和事件绑定转到editpartners，如下所示：

```
 case "EditPartners":
            $e = GetModal(); // <- THE ERROR
            $e.find("a.submit").click(function(e){
                partner.fx_data.partner.data = getFormData($e)
                Communicate(com, partner, function(data) // <- return the modified values by ajax
                {
                    CloseModal();
                });
            });
        break; 
```

因此，当我运行 fn GetModal 时，它返回一个空对象，但该函数在运行`GetModal = fn(){$e=$(".poppedModal");return $e;}`后正常工作`Main(EditP)`。我认为这是比其他任何事情都更合乎逻辑或有条理的错误。说实话，我用回调调用它，这意味着我使用`ShowModal(callback)`并且当它准备好时，我调用`Main(EditP)`了，但也没有工作。

**编辑：**

抱歉，我忘记了主要问题（我认为是主要问题）。所以我没有确切的表格，我只有一个 html 原型。原型，因为我总是在需要时克隆它。

所以这是showmodal fn，我认为这使得模态无法访问：

 ~~~~```
function ShowModal()
{
    $container = $('#myModal');
    $clone = $container.clone();
    $clone.removeAttr("id").addClass("clonedModal");
    $clone.modal('show');
    return $clone;
} 
```~~  ~~```
function ShowModal()
{
    $container = $('#partnerModal');
    document.getElementById('partnerForm').reset();
    $container.modal('show');
    return $container;
} 
```

谢谢你的帮助。

重复

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T00:05:21.127

几点：

1.  javascript 函数中的成员仅在使用`var`. 否则，它们是直到并包括全局名称空间的“外部”成员。您的几个变量需要本地化。未声明的变量可能会导致讨厌的错误。
2.  `.clone()`确实会创建一个 DOM 片段的克隆，但不会自动将其惰性化回 DOM。您需要使用 jQuery 指令来执行此操作，例如`.append()`, `.prepend()`, `.before()`, `.after()`。我强烈怀疑您的问题的很大一部分是试图`.modal()`在未插入的克隆上进行。
3.  不清楚为什么每次使用时都需要克隆表单。这种编程很可能导致内存泄漏。重用一个表单会更干净、更正常。重置表单以清除以前输入/选择的值并不难。

编辑：

ShowModal 具有正确本地化的变量：

```
function ShowModal() {
    var $container = $('#partnerModal');
    document.getElementById('partnerForm').reset();
    $container.modal('show');
    return $container;
} 
```

事实上，如果`.modal()`写成可链接的，应该是这样，那么`ShowModal()`可以简化以避免创建任何命名成员，本地或其他：

```
function ShowModal() {
    $('#partnerForm').get(0).reset();
    return $('#partnerModal').modal('show');
} 
```

另外，请注意，按照 javascript 编程的惯例，只有构造函数才应该使用首字母大写来命名。构造函数是那些设计用来调用的`new Fn()`。（这里并不重要，但是关于构造函数的主题已经进行了很多讨论，有些人选择编写他们的代码以避免使用`new`）。~~~~

# python - 如何在命令行python中接受按键？

> ID：10693256
> 
> 赞同：21
> 
> 时间：2012-05-21T22:01:05.927
> 
> 标签：python, keyboard, keypress

> **可能重复：**
> [Python 从用户读取单个字符](https://stackoverflow.com/questions/510357/python-read-a-single-character-from-the-user)

我希望能够使用 python 用箭头键控制机器人。我的想法是实现看起来像这样的代码......

```
#!/usr/bin/env python
# control a robot using python
exit = 0
while exit == 0:
  keypress = ##get keypress, if no key is pressed, continue##
  if keypress == 'q':
    exit = 1
    break
  elif keypress == KEY_UP:
    ##robot move forward##
  elif keypress == KEY_DOWN:
    ##robot move backward##
print "DONE" 
```

然而问题是我不知道如何让用户输入。而且我不能使用我发现的基于 GUI 的解决方案，例如 pygame，因为机器人不使用显示器。

很感谢任何形式的帮助！！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-22T00:40:44.600

一个简单的诅咒示例。有关详细信息，请参阅[curses 模块](https://docs.python.org/2/library/curses.html)的文档。

```
import curses
stdscr = curses.initscr()
curses.cbreak()
stdscr.keypad(1)

stdscr.addstr(0,10,"Hit 'q' to quit")
stdscr.refresh()

key = ''
while key != ord('q'):
    key = stdscr.getch()
    stdscr.addch(20,25,key)
    stdscr.refresh()
    if key == curses.KEY_UP: 
        stdscr.addstr(2, 20, "Up")
    elif key == curses.KEY_DOWN: 
        stdscr.addstr(3, 20, "Down")

curses.endwin() 
```

# mysql - 使用引用字段别名的子选择的 MySQL 语句在 SQLite 中的等价物是什么

> ID：10693259
> 
> 赞同：1
> 
> 时间：2012-05-21T22:01:22.963
> 
> 标签：mysql, sqlite, subquery

这个问题看起来比问题本身更复杂。所以这里是例子。我在**MySQL**中有一个“测试”表，只有一个字段：ObjectId INTEGER(10)。ObjectId 字段中的值：
1
1
1
2
2

我在 MySQL 查询浏览器中执行以下语句：

```
SELECT DISTINCT ObjectId obid, (SELECT count(*) FROM Test WHERE ObjectId = obid) AS cnt FROM Test 
```

结果是我所期望的：在上面的示例中，有 2 行包含：
第 1 列：ObjectId 值
第 2 列：相应 ObjectId 值出现在列中的次数。

```
obid        cnt
1           3
2           2 
```

**现在我在SQLite**数据库中创建的相同表（结构和数据）上执行相同的语句。我收到一条错误消息，提示“没有这样的列：obid”。

上面提到的 SELECT 对我的目的来说非常方便。被迫用一系列选择（比如使用光标）替换它看起来有点奇怪。我是 SQLite 的新手，所以也许我错过了一些东西。我已经调查了很多结果为零。

那么，有没有人知道是否有类似的单个 SELECT 语句会在 SQLite 数据库上产生相同的结果？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:17:36.430

您正在以复杂的方式进行操作。:) [`GROUP BY`](http://www.sqlite.org/lang_select.html#resultset)应该得到你想要的。

```
SELECT ObjectID AS obid, COUNT(1) AS cnt
FROM Test
GROUP BY ObjectID 
```

# email - 通过 VBA 在 Outlook 工具栏中显示数据

> ID：10693262
> 
> 赞同：1
> 
> 时间：2012-05-21T22:01:45.270
> 
> 标签：email, vba, outlook, add-in

好的，在我的工作中，我们的程序/指南要求我们发送电子邮件，让其他员工知道我们是否要长时间离开办公桌。这是一个空的电子邮件正文（除了我们的签名），主题是 IN、OUT 或 10。

我已经养成了简单地删除这些电子邮件的习惯，以减少混乱。但是很难跟踪谁进出。因此，我想编写一个插件，根据这些电子邮件显示谁进出。我目前的想法是在工具栏中创建带有每个员工姓名的标签，以及他们是否进出。

任何人都可以提出一个很好的方法来做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:14:41.120

您可以为此创建一个插件（使用 VB6 或 VSTO），或使用一些 VBA 来处理传入的电子邮件并创建日历约会以阻止这些人处于 AFK 的时间。

就像是：

```
Private WithEvents Items As Outlook.Items 
Private Sub Application_Startup() 
Dim olApp As Outlook.Application 
Dim objNS As Outlook.NameSpace 
Set olApp = Outlook.Application 
Set objNS = olApp.GetNamespace("MAPI") 
Set Items = objNS.GetDefaultFolder(olFolderInbox).Items 
End Sub

Private Sub Items_ItemAdd(ByVal item As Object) 
On Error Goto ErrorHandler 
Dim Msg As Outlook.MailItem 

If TypeName(item) = "MailItem" Then
Set Msg = item 
  If Msg.Subject = "OUT" Then
    ' create calendar appointment here
  End If
  If Msg.Subject = "IN" Then
    ' delete calendar appoinment here
  End If
End If
ProgramExit: 
Exit Sub
ErrorHandler: 
MsgBox Err.Number & " - " & Err.Description 
Resume ProgramExit 
End Sub 
```

我推荐一个替代方案：使用外出功能。我意识到即使您只是在使用浴室或开会，主题行也会显示“不在办公室”，但我无法想象它比您现在所做的更糟糕。它是内置的，不需要太多努力。

ps-这不关我的事，我可能会因为问这个而被激怒，但你能告诉我们那是哪家公司，所以我知道永远不会在那里工作吗？这听起来绝对可怕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:00:05.950

您应该注册[MS BizSpark](http://www.microsoft.com/bizspark/)并[下载 Lync Server/Communicator](http://gotspeech.net/blogs/verbalinput/archive/2010/11/18/exploring-microsoft-lync-server-2010-part-3-where-to-get-the-software.aspx)。它具有[内置的**存在意识**](http://office.microsoft.com/en-us/communicator-help/what-is-presence-HA010014350.aspx)- 与这种奇怪的 Outlook VBA/电子邮件设置相比，您最好将精力投入其中。

作为替代方案，如果您想走 jabber 路线，您也可以[免费获得 jabber 客户端。](http://xmpp.org/xmpp-software/clients/)如果您不想托管自己的 jabber 服务器，[jabber.org 会提供免费帐户。](https://register.jabber.org/)

这两种方法都是基于标准的方式来了解人们的可用性（*存在*），而无需依赖他们执行任何手动操作。

# crystal-reports - 日期期间更改的水晶报表仪表

> ID：10693265
> 
> 赞同：0
> 
> 时间：2012-05-21T22:02:00.207
> 
> 标签：crystal-reports, charts, gauge

我有一个水晶报表，我在其中使用“仪表”图表来显示企业的准时交货。仪表需要“更改时”，但我有两个单独的值，我想在同一个仪表上显示，一个用于整体，一个用于上周。我可以通过创建一个空公式并将 OnChange 设置为该公式来做到这一点，但是针的颜色相同。关于如何为整体买一根针，为上周买一根针有什么想法吗？

我的表只是带有截止日期和完成日期的制造订单列表。我使用公式来确定订单是否准时，如果是，我打印订单号。然后，我使用具有不同订单号计数的汇总字段来确定按时订单的总数。这除以总的不同订单计数，然后我得到 OTD 的百分比......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T12:20:03.107

好的，这个值得更多解释。对于本质上是销售订单列表的每个细节，我都有一个要求的日期和一个完成的日期。从这两个字段中，我计算了第三个字段，它返回“准时”、“迟到”或“3 天窗口”，我想显示所有准时记录的仪表图......我们的 OTD %

除此之外，我还想显示每周数字与该周之前的数字。为此，我创建了返回“本周”或“历史”的第四列。我现在可以为每条记录制作一个多仪表类型图表，其中包含 OTD 状态和每周历史的变化。这会生成正确标记历史和每周 OTD 的并排仪表。

# jquery - 想使用绑定和取消绑定。希望能够在我选择单选按钮后悬停在其他行上

> ID：10693267
> 
> 赞同：1
> 
> 时间：2012-05-21T22:02:09.097
> 
> 标签：jquery, asp.net, html, css, radio-button

我想使用 Bind 和 Unbind Please。我有一个多行的表。我有每一行的单选按钮。当我执行 html 时，我可以将鼠标悬停在每一行上，每一行都会变成浅蓝色。如果我选择一个单选按钮，我不能再将鼠标悬停在我没有选择的其他行上。请帮帮我

```
 <table id ="myTable">
 <tr>
<th>Selected</th>
<th>First Name</th>
<th>Middle Name</th>
<th style="width: 10%;">Last Name</th>
<th>Active Email</th> 
```

```
 <tr>
    <td><input class ="rad" type="radio" name="developerRadio" value="Value 1" /></td>
    <td>Hello</td>
    <td>everyone</td>
    <td>good</td>
    <td>email</td>
    <td>hello</td>

 </tr>
           <tr>
    <td><input class ="rad" type="radio" name="developerRadio" value="Value 1" /></td>
    <td>Hello</td>
    <td>everyone</td>
    <td>good</td>
    <td>email</td>
    <td>hello</td>

 </tr>
        <tr>
    <td><input class ="rad" type="radio" name="developerRadio" value="Value 1" /></td>
    <td>Hello</td>
    <td>everyone</td>
    <td>good</td>
    <td>email</td>
    <td>hello</td>

 </tr>

<script>
$(document).ready(function () {
    $("tr").mouseover(function () {
        $(this).css("background-color", "#0066FF");
    });
    $("tr").mouseout(function () {
        $(this).css("background-color", "");
    });

    $('input:radio').click(function () {
        $("tr").unbind("mouseover mouseout");
        $(this)
            .closest('tr')
                .siblings()
                .css('background-color', 'white')
                .end()
            .css('background-color', 'darkblue');
        $("input:radio")
            .unbind("click")
            .click(function () {
                $('tr').bind("mouseover");
                $(this).closest('tr').css('background-color', "#0066FF");
        });
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:21:12.143

无需绑定和取消绑定，只需使用活动类来确定悬停行为：

```
$("table")
  .on("mouseenter mouseleave", "tr:not(.selected)", function(e){
    $(this).toggleClass("hovered", e.type === "mouseenter"); })
  .on("click", "input:radio", function(){
    $(this).closest("tr").addClass("selected"); });​ 
```

小提琴：http: [//jsfiddle.net/Bc2DN/1/](http://jsfiddle.net/Bc2DN/1/)

或者您可以返回主要依赖 CSS 并真正让事情变得简单：

```
<style>
  tr:hover { background: yellow }
  tr.selected { background: orange }
</style>

<script>
  $("input:radio").on("click", function(){
     $(this).closest("tr").addClass("selected"); 
  });
</script> 
```

提琴手：http: [//jsfiddle.net/Bc2DN/2/](http://jsfiddle.net/Bc2DN/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:15:58.090

如果没有现场示例，很难弄清楚所有奇怪的颜色内容和绑定/解除绑定，但我猜是这样的：

```
$(document).ready(function () {
    $("tr").on({
        mouseover: function () {
            if (!$(this).find('input:radio').prop('checked')) {
                $(this).css("background-color", "#0066FF");
            }
        },
        mouseout: function () {
            $(this).css("background-color", "");
        }
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T22:28:07.413

你的老 CSS 怎么样？

```
tr {background: transparent;}
tr:hover {background: #0066FF;}
tr.active {background: lightgoldenrod;}
tr.active:hover {background: yellow;} 
```

并将活动类绑定到单选按钮的 tr 例如：

```
$("input[type='radio']").click(function(
    $(this).parentsUntil("tr").parent().addClass("active")
    $(this).parentsUntil("tr").parent().siblings().removeClass("active");
)); 
```

# nosql - 图 DB 等效于二分网络投影？

> ID：10693269
> 
> 赞同：2
> 
> 时间：2012-05-21T22:02:15.790
> 
> 标签：nosql, neo4j, flock, orientdb, gremlin

假设一个网络有两种节点，比如用户和地点，关系为“一直在”。这是一个二分网络，通常由 networkx 之类的模块提供网络在两个方向中的任何一个方向的“投影”，这样我们就可以生成地点网络（链接的权重与普通用户的数量相同）或用户网络（链接的权重与公共场所的数量相同）。

我应该如何在 Graph 数据库中生成这样的网络？您能否提供最常见的开源示例，例如 OrientDB、Neo4j、FlockDB ......

更具体地说，如何用 gremlin 做到这一点？

在这种情况下（gremlin）我自己已经粘贴了一个答案，但是它从幸存的节点开始，从将要被投影的节点开始会更有效，因为通常第一步是一些间隔子选择

```
g.V.filter{it.date=='3/3/2003'}.filter{it.type=='place'}.... 
```

所以我们只对那些在某一天或某个其他时间段都在同一个地方相关的用户网络感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:12:49.157

我可以推荐[Marko Rodriguez 的博客](http://markorodriguez.com/)，因为其中包含许多关于此用例的示例。Marko 也是 Gremlin 的作者，[OrientDB](http://www.orientdb.org)和 Neo4J 都符合它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T17:16:24.160

从投影节点开始，我在 gremlin 中找到了一种方法（此外，它适用于 OrientDB REST 接口）

```
g.V.filter{it.type=='user'}.as('a').out('checkedIn_at').in('checkedIn_at')
.as('b').simplePath.select(['a','b']).groupCount(){it.name}.cap() 
```

因为这是一个答案，所以我在自我回答：-D

在某些情况下，您有一个庞大的数据库，其中的图表是子选择。我更喜欢从以下内容开始的答案

```
g.V.filter{it.date=='3/3/2003'}.filter{it.type=='place'}.... 
```

我的猜测是

```
...sideEffect{x=it}.in.as('a').transform{x}.in.as('b').select(['a','b'])
.groupCount(){it.name}.cap() 
```

现存的问题是这些模式不允许任意投影函数。我认为，一个解决方案可能是列出每对用户的公共顶点，利用 groupBy 的多功能性：

```
g.V.filter{it.type=='place'}.sideEffect{x=it}.out.as('a').transform{x}.out
.as('b').select(['a','b']).groupBy{[it[0],it[1]]}{x}.cap 
```

groupBy，带有用于后处理的第三个参数，允许许多 MapReduce 模式。

# php - 将纬度和经度值保存到 MySQL 数据库 iOS

> ID：10693276
> 
> 赞同：-1
> 
> 时间：2012-05-21T22:02:44.750
> 
> 标签：php, mysql, objective-c, xcode, clgeocoder

我设置了我的代码，以便用户输入所有位置详细信息（地址、城市、县、国家和邮政编码），然后单击按钮，将纬度和经度值输入两个文本框...我现在的问题是以前用于将数据保存到数据库的代码不起作用。

这是我的代码...

php

```
<?php

$username = "username";
$database = "database";
$password = "password";

mysql_connect(localhost, $username, $password);

@mysql_select_db($database) or die("unable to find database");

$name = $_GET["name"];
$address = $_GET["address"];
$city = $_GET["city"];
$county = $_GET["county"];
$country = $_GET["country"];
$postcode = $_GET["postcode"];
$date = $_GET["date"];
$time = $_GET["time"];
$latitude = $_GET["latitude"];
$longitude = $_GET["longitude"];

$query = "INSERT INTO map VALUES ('', '$name', '$address', '$city', '$county', '$country', '$postcode', '$date', '$time, '$latitude', '$longitude'')";

mysql_query($query) or die(mysql_error("error"));
mysql_close();

?> 
```

AddSessionViewController.h

```
#import <UIKit/UIKit.h>

#define kpostURL @"http://myurl.com/map.php"
#define kname @"name"
#define kaddress @"address"
#define kcity @"city"
#define kcounty @"county"
#define kcountry @"country"
#define kpostcode @"postcode"
#define kdate @"date"
#define ktime @"time"
#define klatitude @"latitude"
#define klongitude @"longitude"

@interface addSessionViewController : UIViewController {

UIScrollView *scrollView_;
BOOL keyboardVisible_;

IBOutlet UITextField *nameText;
IBOutlet UITextField *addressText;
IBOutlet UITextField *cityText;
IBOutlet UITextField *countyText;
IBOutlet UITextField *countryText;
IBOutlet UITextField *postcodeText;
IBOutlet UITextField *dateText;
IBOutlet UITextField *timeText;
IBOutlet UITextField *latitudeText;
IBOutlet UITextField *longitudeText;
NSURLConnection *postConnection;

}

@property (nonatomic, strong) IBOutlet UIScrollView *scrollView;

-(IBAction)textFieldDoneEditing:(id) sender;
-(IBAction)post:(id)sender;
-(IBAction)getLatLon:(id)sender;

-(void) postMessage:(NSString*) postcode withName:(NSString *) name withAddress:(NSString *) address withCity:(NSString *) city withCounty:(NSString *) county withCountry:(NSString *) country  withDate:(NSString *) date withTime:(NSString *) time withLatitude:(NSString *) latitude withLongitude:(NSString *) longitude;

- (void) keyboardDidShow:(NSNotification *)notif;
- (void) keyboardDidHide:(NSNotification *)notif;

@end 
```

添加SessionViewController.m

```
#import "addSessionViewController.h"
#import <QuartzCore/QuartzCore.h>
#import "SVGeocoder.h"

@implementation addSessionViewController

@synthesize scrollView;

- (IBAction)textFieldDoneEditing:(id)sender {
[sender resignFirstResponder];
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
[super viewDidLoad];

self.scrollView.contentSize = self.view.frame.size;

UIColor *backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"bg-splash.png"]];
[self.view setBackgroundColor:backgroundColor];

UIView* gradientView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 4)];
CAGradientLayer *gradient = [CAGradientLayer layer];
gradient.frame = gradientView.bounds;

UIColor* lightColor = [[UIColor blackColor] colorWithAlphaComponent:0.0];
UIColor* darkColor = [[UIColor blackColor] colorWithAlphaComponent:0.5];

gradient.colors = [NSArray arrayWithObjects:(id)darkColor.CGColor, (id)lightColor.CGColor, nil];
[gradientView.layer insertSublayer:gradient atIndex:0];

[self.view addSubview:gradientView];

}

-(void) postMessage:(NSString*) postcode withName:(NSString *) name withAddress:(NSString *) address withCity:(NSString *) city withCounty:(NSString *) county withCountry:(NSString *) country withDate:(NSString *) date withTime:(NSString *) time withLatitude:(NSString *)latitude withLongitude:(NSString *)longitude; {

if (name != nil && address != nil && city != nil && county != nil && country != nil && postcode !=nil && date != nil && time != nil && latitude != nil && longitude != nil){

    NSMutableString *postString = [NSMutableString stringWithString:kpostURL];

    [postString appendString:[NSString stringWithFormat:@"?%@=%@", kname, name]];

    [postString appendString:[NSString stringWithFormat:@"&%@=%@", kaddress, address]];

    [postString appendString:[NSString stringWithFormat:@"&%@=%@", kcity, city]];

    [postString appendString:[NSString stringWithFormat:@"&%@=%@", kcounty, county]];

    [postString appendString:[NSString stringWithFormat:@"&%@=%@", kcountry, country]];

    [postString appendString:[NSString stringWithFormat:@"&%@=%@", kpostcode, postcode]];

    [postString appendString:[NSString stringWithFormat:@"&%@=%@", kdate, date]];

    [postString appendString:[NSString stringWithFormat:@"&%@=%@", ktime, time]];

    [postString appendString:[NSString stringWithFormat:@"&%@=%@", klatitude, latitude]];

    [postString appendString:[NSString stringWithFormat:@"&%@=%@", klongitude, longitude]];

    [postString setString:[postString stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];

    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:postString]];
    [request setHTTPMethod:@"POST"];

    postConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self startImmediately:YES];

}

}

-(IBAction)post:(id)sender{

[self postMessage:(NSString*) postcodeText.text withName:nameText.text withAddress:addressText.text withCity:cityText.text withCounty:countyText.text withCountry:countryText.text withDate:dateText.text withTime:timeText.text withLatitude:latitudeText.text withLongitude:longitudeText.text];

[postcodeText resignFirstResponder];
nameText.text = nil;
addressText.text = nil;
cityText.text = nil;
countyText.text = nil;
countryText.text = nil;
postcodeText.text = nil;
dateText.text = nil;
timeText.text = nil;
latitudeText.text = nil;
longitudeText.text = nil;
[[NSNotificationCenter defaultCenter] postNotificationName:@"Test2" object:self];
}

-(IBAction)getLatLon:(id)sender{

NSString *eventName = [nameText text];
NSString *eventAddress = [addressText text];
NSString *eventCity = [cityText text];
NSString *eventCountry = [countryText text];
NSString *eventCounty = [countyText text];
NSString *eventDate = [dateText text];
NSString *eventPostCode = [postcodeText text];
NSString *eventTime = [timeText text];

// Use this to build the full event string
NSString *addressString = [NSString stringWithFormat:@"%@,%@,%@,%@,%@,%@,%@,%@", eventName, eventAddress, eventCity, eventCounty, eventCountry, eventPostCode, eventDate, eventTime];

// A search can't inlude the event and time and hour as it means nothing to MapKit
// The geocodeAddressString simply contains the address info
NSString *geocodeAddressString = [NSString stringWithFormat:@"%@,%@,%@,%@,%@", eventAddress, eventCity, eventCounty, eventCountry, eventPostCode];

//NSLog(@"Hello %@",addressString);
CLGeocoder *geocoder = [[CLGeocoder alloc] init]; 

[geocoder geocodeAddressString:geocodeAddressString completionHandler:^(NSArray* placemarks, NSError* error){
    // Check for returned placemarks
    if (placemarks && placemarks.count > 0) {
        CLPlacemark *topResult = [placemarks objectAtIndex:0];

        //NSLog([topResult locality]);
        //NSLog([topResult location]);
        //MKCoordinateRegion region;
        //double *value = topResult.region.center.latitude;

        CLLocationDegrees latitude = topResult.region.center.latitude;
        CLLocationDegrees longitude = topResult.location.coordinate.longitude;

        NSString *latitudeString = [NSString stringWithFormat:@"%f",latitude];
        NSString *longitudeString = [NSString stringWithFormat:@"%f",longitude];

        latitudeText.text = latitudeString;
        longitudeText.text = longitudeString;

        NSLog(@"Lat: %f", latitude);
        NSLog(@"Long: %f", longitude);
    }
}];
}

- (void)viewDidUnload
{

// Release any retained subviews of the main view.
// e.g. self.myOutlet = nil;
}

- (void)viewWillAppear:(BOOL)animated
{

NSLog(@"%@", @"Registering for keyboard events...");
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardDidShow:) name:UIKeyboardDidShowNotification object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardDidHide:) name:UIKeyboardDidHideNotification object:nil];
keyboardVisible_ = NO;

[super viewWillAppear:animated];

}

- (void)viewDidAppear:(BOOL)animated
{
[super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{

NSLog(@"%@", @"Unregistering for keyboard events...");
[[NSNotificationCenter defaultCenter] removeObserver:self];

[super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
// Return YES for supported orientations
return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

#pragma mark -
#pragma mark Keyboard handlers

- (void) keyboardDidShow:(NSNotification *)notif {
NSLog(@"%@", @"Received UIKeyboardDidShowNotification");

if (keyboardVisible_) {
    NSLog(@"%@", @"Keyboard is already visible.  Ignoring notifications.");
    return;
}

// The keyboard wasn't visible before
NSLog(@"Resizing smaller for keyboard");

// Get the origin of the keyboard when it finishes animating
NSDictionary *info = [notif userInfo];
NSValue *aValue = [info objectForKey:UIKeyboardFrameEndUserInfoKey];

// Get the top of the keyboard in view's coordinate system. 
// We need to set the bottom of the scrollview to line up with it
CGRect keyboardRect = [aValue CGRectValue];
keyboardRect = [self.view convertRect:keyboardRect fromView:nil];
CGFloat keyboardTop = keyboardRect.origin.y;

// Resize the scroll view to make room for the keyboard
CGRect viewFrame = self.view.bounds;
viewFrame.size.height = keyboardTop - self.view.bounds.origin.y;

self.scrollView.frame = viewFrame;
keyboardVisible_ = YES;
}

- (void) keyboardDidHide:(NSNotification *)notif {
NSLog(@"%@", @"Received UIKeyboardDidHideNotification");

if (!keyboardVisible_) {
    NSLog(@"%@", @"Keyboard already hidden.  Ignoring notification.");
    return;
}

// The keyboard was visible
NSLog(@"%@", @"Resizing bigger with no keyboard");

// Resize the scroll view back to the full size of our view
self.scrollView.frame = self.view.bounds;
keyboardVisible_ = NO;
}

@end 
```

我知道代码不是最好的，因为我是 Objective C 和 iOS 开发的新手，但我真的很恐慌，因为这是我最后的大学作业，需要在明天上午 10 点提交，所以任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:40:45.443

你有一个多余`'`的在你的`INSERT`声明之后`$longitude`。

# java - 在 xml 中使用内置颜色？

> ID：10693279
> 
> 赞同：0
> 
> 时间：2012-05-21T22:03:06.660
> 
> 标签：java, android

如何使用`android.grapics.color`常量？ [http://developer.android.com/reference/android/graphics/Color.html](http://developer.android.com/reference/android/graphics/Color.html)

这不起作用：

```
android:drawable="@android:color/cyan" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T22:08:43.367

android.R .提供了[这些颜色](http://developer.android.com/reference/android/R.color.html)。

如果你想使用[Color](http://developer.android.com/reference/android/graphics/Color.html)类，你需要一些 java 代码：

```
view.setBackgroundColor( Color.CYAN ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:08:17.063

为什么要为 android:drawable 设置颜色。你想设置背景吗？因为那时你会使用：

```
android:background="@android:color/black" 
```

尽管在我的编辑器中，我不认为青色是一种选择。如果您只是在 xml 字段中使用 cntrl+space，则可以选择 @android:color/ 然后选择一种颜色。不过，您始终可以在 colors.xml 文件中自己制作 :)

# ms-access-2010 - Access 2010：将多条记录的内容显示到数据表中的未绑定控件

> ID：10693280
> 
> 赞同：0
> 
> 时间：2012-05-21T22:03:08.090
> 
> 标签：ms-access-2010, dynamicquery, pass-through

我在 Access 2010 中使用动态传递查询从后端数据库中检索一条或多条记录。经过多次试验和错误，我剽窃了足够多的正确代码来检索适当的记录，并在 OnLoad 事件期间将它们分配给我的数据表表单上的未绑定文本框。剩下的唯一问题是显示多条记录。我已经验证我正在检索多条记录，但是每条记录的字段的内容会覆盖存储到表单文本框控件的先前值，所以当我希望从任何地方看到时，我总是在数据表中只显示一条记录一到十。

我确定这是一个简单的解决方案。有人可以向我指出吗？

```
Private Sub Form_Load()
    Dim sqlString As String
    sqlString = "SELECT Transmitter_ID, Receiver_ID, UTC_Date, Local_Date from Detections"
    If Not IsNull(Me.OpenArgs) Then
        sqlString = sqlString & " where " & OpenArgs
    End If

    Dim cnn As New ADODB.Connection
    Dim cmd As New ADODB.Command
    Dim rst As ADODB.Recordset

    'Define and open connection
    cnn.ConnectionString = "DRIVER={SQLite3 ODBC Driver};Database=z:\EWAMP\EWAMP_be_dev.sqlite"
    cnn.Open

    'Define ADO command
    cmd.ActiveConnection = cnn
    cmd.CommandText = sqlString

    'Populate and enumerate through recordset
    Set rst = cmd.Execute
    If rst.EOF Then
       MsgBox "Nothing found...", vbInformation + vbOKOnly
       Exit Sub
    Else
        Do While Not rst.EOF
            '// I'm guessing the problem is with my control assignments, here.
            Me.cntl_Receiver_ID.Value = rst("Receiver_ID")
            Me.cntl_Transmitter_ID.Value = rst("Transmitter_ID")
            Me.cntl_UTC_Date.Value = rst("UTC_Date")
            Me.cntl_Local_Date.Value = rst("Local_Date")
            Debug.Print {Show me the four control values}
            rst.MoveNext
        Loop
    End If

End Sub 
```

干杯!

杜德利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T06:54:51.630

另一个论坛的一位读者向我指出了一个类似于 HK1 提出的解决方案，即`Set Me.Recordset = rst`. 这解决了我原来的问题，但又产生了另一个问题。

首先，我在未绑定的表单上重新绑定了四个文本框控件，然后使用[http://msdn.microsoft.com/en-us/library/ff835419.aspx](http://msdn.microsoft.com/en-us/library/ff835419.aspx)中的示例对代码进行了重大修改。修改后的代码如下所示：

```
Private Sub Form_Load()
   Dim sqlString As String
   sqlString = "SELECT Transmitter_ID, Receiver_ID, UTC_Date, Local_Date from Detections"
   If Not IsNull(Me.OpenArgs) Then
      sqlString = sqlString & " where " & OpenArgs
   End If

   Dim cn As ADODB.Connection
   Dim rs As ADODB.Recordset

   'Define and open connection
   Set cn = New ADODB.Connection
   cn.ConnectionString = "DRIVER={SQLite3 ODBC Driver};Database=z:\EWAMP\EWAMP_be_dev.sqlite;"
   cn.Open

   'Create an instance of the ADO Recordset class,
   'and set its properties
   Set rs = New ADODB.Recordset
   With rs
       Set .ActiveConnection = cn
       .Source = sqlString
       '// .LockType = adLockOptimistic
       .LockType = adLockReadOnly
       .CursorType = adOpenKeyset
       '// .CursorType = adOpenStatic
       .Open
   End With

   'Set the form's Recordset property to the ADO recordset
   Set Me.Recordset = rs

   Set cn = Nothing
   Set rs = Nothing
End Sub 
```

该表单现在显示 4 行返回的 4 条记录，20 行 20 条记录，以及至少 256k 行（由我的参数集指定）。唯一剩下的小问题是，对于四个或更多记录，如果我按下“最后一行”导航按钮 (>|)，本地光标会将焦点设置到一个或多个中间行，并且控件的属性表会大力刷新（每秒多次）。如果我的表单行数超过屏幕上显示的行数，我无法导航或光标到最后一行。就好像记录集在不断更新。

如您所见，我使用了 RecordSet LockType 和 CursorType 属性（包括 adOpenDynamic 和 adOpenForwardOnly，这两者都会导致 Set Me.Recordset 语句出现运行时错误）。在 adLockOptimistic 和 AdLockReadOnly 之间切换 LockType 以及在 adOpenKeyset 和 adOpenStatic 之间切换 CursorType 对检索性能（现在非常快！）或明显的刷新率（不幸的是，它甚至更快）没有影响。

或许值得一提的是，sqlString 从中“选择”的“检测”表包含约 4M 条记录。我在之前尝试使用绑定到该表的直通查询的数据源的表单时感到沮丧，因为无论我传递给表单的过滤器/WhereClause/OpenArgs 参数如何，查询总是将整个 4M 记录返回给客户端. 如果只有我可以关闭连接（我已经尝试过）或者在我调用过一次后将 RecordSet 静默，那么上面显示的解决方案将是完美的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T04:47:13.907

我不相信数据表视图中的表单可以用作未绑定的表单。但是您可以将 ADO 记录集用作表单记录集。

```
Set Me.Recordset = rst 
```

然后注意不要在表单关闭之前关闭名为 rst 的变量。

另一种替代解决方案是使用内存中的、制造的、断开连接的 ADO 记录集。基本上，您最终会创建一个新记录集，将字段附加到它以匹配您现有的记录集，然后将所有数据移动到您的新记录集中。但是，如果您已经有一个有效的、已填充的 ADO 记录集，我真的看不出这样做的意义。

如果您确实需要/想要在未绑定的表单中显示多条记录，我认为您将不得不使用 ActiveX 控件，例如 GridView、ListView、TreeView 或 MSFlexGrid。我注意到大多数熟练、专业的 Access 开发人员都尽可能远离 ActiveX 控件。如果并且当他们确实使用它们时，他们通常将其限制为仅 TreeView 和 ListView，我认为因为它们是唯一的 ActiveX 控件，它们增加了足够的价值，值得忍受它们可能引入的任何问题。

我建议你看看这篇关于 DAO 和 ADO 的区别的文章。 [http://www.utteraccess.com/wiki/index.php/Choosing_between_DAO_and_ADO](http://www.utteraccess.com/wiki/index.php/Choosing_between_DAO_and_ADO)

# ios - 如何在我的应用程序中设置特定的区域格式并覆盖 iOS 应用程序中的设备区域格式？

> ID：10693281
> 
> 赞同：0
> 
> 时间：2012-05-21T22:03:09.297
> 
> 标签：ios, regional-settings

我有一个基本的计算器应用程序，它不能在小数点“。”的区域正确处理百分比。用作逗号分隔符，逗号“，”用于标记小数点。我正在对此进行修复，但同时我想知道当我的应用程序启动时，我是否可以覆盖设备设置应用程序中设置的区域格式并强制使用特定的区域格式，仅适用于我的应用程序。

这可能吗？感谢您抽出宝贵的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:27:01.050

我建议您不要这样做，而是立即查看 NSNumberFormatter 和 NSNumber 来执行此操作。例如，无论设备的区域设置如何，这都应该有效。

```
NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
[formatter setNumberStyle:NSNumberFormatterDecimalStyle];
NSNumber *test = [formatter numberFromString:@"1,000,000"]; 
```

另请查看 NSNumberFormatter 提供的其他功能。这似乎是一种比您正在尝试的更优雅的方式。

# .net - 人们如何管理加密的配置文件？

> ID：10693295
> 
> 赞同：0
> 
> 时间：2012-05-21T22:04:06.083
> 
> 标签：.net, file, encryption, configuration

我们有大量的 SVN 服务器，为多个团队保存应用程序。我们收到了一项要求，即配置文件不得将数据库连接字符串以纯文本形式存储在 SVN 存储库中。也就是说，只有团队成员才能看到纯文本的连接字符串。由于我们使用 .net 加密配置部分并不是什么大不了的事。但是我读过的大多数方法都需要使用特定于机器或特定于用户的密钥。由于机器和用户会有所不同，这似乎不起作用。其他人如何与用户/开发人员团队一起管理加密密钥？我们确实有自己的 RSA 密钥服务器。这是要走的路吗？

谢谢，

杰瑞

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:39:17.850

好吧，基本上你不应该将配置与源一起存储。

配置使用公钥加密，私钥在资源中或单独配置。它还由私有“代码/配置签名”密钥签名，验证所需的公钥再次单独存储或配置。有时还会部署额外的验证和混淆技术。解密和签名密钥应该用于特定项目，或者您可能会交换配置文件（或在交换它们时遇到可怕的异常）。

在代码中存储普通密钥称为混淆，任何有权访问源代码或二进制代码的人都能够找到它们。密钥最好不要存储在代码中。

当然，如果您使用公钥/私钥，您需要拥有 PKI 基础设施和必要的密钥管理。我不会（也不能/可能不会）对此进行讨论，但我想 RSA 密钥服务器可以为您提供正确的环境。

# php - PHP 将无法正确执行，仅显示为文本

> ID：10693298
> 
> 赞同：2
> 
> 时间：2012-05-21T22:04:38.583
> 
> 标签：php

我的整个 PHP 页面只显示为文本，没有执行任何 PHP 代码。这很奇怪，因为当我`<? phpinfo(); ?>`在 test.php 文件中测试它时，我得到了一个成功的测试，它可以在我的 Apache 服务器上运行。但是，当我尝试做其他事情时。它只显示为文本。

编辑：这是代码的链接。我不知道如何在这里发布。[巴斯宾](http://pastebin.com/UdWq8Gmc)

```
<?php
  // create short variable names
  $tireqty = $_POST['tireqty'];
  $oilqty = $_POST['oilqty'];
  $sparkqty = $_POST['sparkqty'];
  $find = $_POST['find'];
?>
<html>
<head>
  <title>Bob's Auto Parts - Order Results</title>
</head>
<body>
<h1>Bob's Auto Parts</h1>
<h2>Order Results</h2>
<?php

    echo "<p>Order processed at ".date('H:i, jS F Y')."</p>";

    echo "<p>Your order is as follows: </p>";

    $totalqty = 0;
    $totalqty = $tireqty + $oilqty + $sparkqty;
    echo "Items ordered: ".$totalqty."<br />";

    if ($totalqty == 0) {

      echo "You did not order anything on the previous page!<br />";

    } else {

      if ($tireqty > 0) {
        echo $tireqty." tires<br />";
      }

      if ($oilqty > 0) {
        echo $oilqty." bottles of oil<br />";
      }

      if ($sparkqty > 0) {
        echo $sparkqty." spark plugs<br />";
      }
    }

    $totalamount = 0.00;

    define('TIREPRICE', 100);
    define('OILPRICE', 10);
    define('SPARKPRICE', 4);

    $totalamount = $tireqty * TIREPRICE
                 + $oilqty * OILPRICE
                 + $sparkqty * SPARKPRICE;

    echo "Subtotal: $".number_format($totalamount,2)."<br />";

    $taxrate = 0.10;  // local sales tax is 10%
    $totalamount = $totalamount * (1 + $taxrate);
    echo "Total including tax: $".number_format($totalamount,2)."<br />";

    if($find == "a") {
      echo "<p>Regular customer.</p>";
    } elseif($find == "b") {
      echo "<p>Customer referred by TV advert.</p>";
    } elseif($find == "c") {
      echo "<p>Customer referred by phone directory.</p>";
    } elseif($find == "d") {
      echo "<p>Customer referred by word of mouth.</p>";
    } else {
      echo "<p>We do not know how this customer found us.</p>";
    }

?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T22:08:22.993

我愿意赌 10$`test.php`使用`<?php`，并且更改的代码使用`<?`，而服务器不将其理解为开始标记，因为`short_open_tags`在 php.ini 中已关闭。

很多书籍都使用`<?`开放标签，而大多数服务器只支持长版本（`<?php`）。如果是这种情况，那么将所有简单的更改`<?`为`<?php`就可以了。

PHP 代码仅在 1 种情况下暴露：当 PHP 解释器未将其识别为 PHP 代码时。这可能是由两个问题引起的：

*   根本不处理 php 文件的 Apache（或其他 http 服务器）的错误配置。
*   PHP 文件中的打开标签错误，因此 PHP 不知道代码何时开始。

如果文件是 *.php，如果 Apache 已打开通过 PHP 解释器提供 *.php 文件，如果使用标准打开标签或 PHP 配置为使用其他类型的已用标签，以及如果您正在访问此 PHP 文件通过浏览器，PHP 在任何情况下都不会公开此代码。

# java - 按照它们在源文件中出现的顺序获取 java bean 属性名称的列表/数组

> ID：10693299
> 
> 赞同：2
> 
> 时间：2012-05-21T22:04:55.693
> 
> 标签：java, reflection, javabeans

我有一个像

```
class A {

    private String property1;

    private String property2;

    private String property3;

    // constructor , getters , setters 

} 
```

是否可以按照它们在源文件中出现的顺序获取此类属性名称的列表/数组？像`["property1", "property2", "property3"]`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:45:56.113

答案是你不能。您需要的信息在运行时无法从 .class 文件中获得。

> 在我的代码的其他一些部分，我需要按特定顺序“打印”这个类的数据。真实案例中的这个类有很多属性并且可以改变（作为顺序）所以，我可以自己编写这个数组/列表来获得我需要的顺序，但如果可以从类中得到它，那就是对我更好。

这里有一些更好的方法来解决这个问题：

*   在打印之前按名称或类型名称或有意义的方式对属性进行排序。
*   在定义 bean 属性顺序的 bean 类（或另一个类）中嵌入一个数组。
*   创建一个单独的元数据文件来指定 bean 属性顺序。

You could do some build time pre-processing of your source code to extract the order of the properties and (say) write them to a file. But frankly, I think it is better to detach these aspects; e.g. so that your system integrators / end-users could tweak the property order without changing the source code.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:10:42.507

> 可以获得此类属性名称的列表/数组

是的，使用[`Class.getDeclaredFields()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getDeclaredFields%28%29)

> 按照它们在源文件中出现的顺序

不，除非您解析源文件，否则没有任何保证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T22:11:11.790

这并不完全可能。[`Class#getDeclaredFields`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getDeclaredFields%28%29)不保证返回字段的顺序。但是，在我刚刚进行的测试中，这些字段确实是按照它们的声明顺序返回的。

# objective-c - 自定义单元格中的标签不显示

> ID：10693300
> 
> 赞同：0
> 
> 时间：2012-05-21T22:05:01.013
> 
> 标签：objective-c, uitableview

我是 iphone 开发的新手。我正在使用带有情节提要的 xCode 4.2。我试图让我的表格视图中的单元格显示几个 uilabels。他们只是没有出现在我的模拟器中。但原版`cell.textLabel`出现了。

这就是我所做的：我创建了一个扩展 UITableViewCell 的新 customcell.h/.m 文件。我在类中添加了一些实例变量。我去了情节提要，在 tableviewcell 的身份检查器类中，我将其更改为指向 customcell。我将一些 UIlabels 拖放到我的新单元格中。然后我去连接检查器拖动那些带有线条的“加号”图标以将我的新 uilabels 连接到我的实例变量。

当我运行我的模拟器时，我看不到任何新的 ui 标签。我只看到原始的 uilabel `cell.textLabel`。我可以以编程方式获取和设置`cell.mylabel1`等`cell.mylabel2`...，它们是新标签，但是嘿只是没有出现。

**添加详细信息** 这是我的 tableviewcontroller 的 cellForRowAtIndexpath 函数。

```
static NSString *CellIdentifier = @"Cell"; // this was the error, i needed to change this to CustomCell, or whatever it is in my storyboard

CustomCell *cell = (CustomCell *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {
    cell = [[CustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}
cell.mylabel1.text = @"hello"; // doesn't appear in simulator
cell.textLabel.text = @"world"; // does apepar in the simulator 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:44:32.640

正如大卫所暗示的那样，这里缺少的一个部分是您需要引用情节提要中指定的单元格的标识符：

首先，在情节提要的“属性检查器”中指定一个标识符。您可以通过选择 UITableViewCell 并添加标识符“ExampleCell”（例如）来执行此操作。其次，在创建 CustomCell 时在代码中引用此标识符。

```
static NSString *CellIdentifier = @"ExampleCell";
CustomCell *cell = (CustomCell *) [tableView  dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
cell = [[CustomCell alloc] initWithStyle:UITableViewCellStyleDefault   reuseIdentifier:CellIdentifier];
} 
```

# facebook - 使用 javascript 自定义 facebook 注册小部件

> ID：10693301
> 
> 赞同：0
> 
> 时间：2012-05-21T22:05:16.740
> 
> 标签：facebook, widget, customization

有人知道 Facebook 对修改其注册小部件的外观和感觉有任何限制吗？

我们想在我们的一个页面上使用 FB 注册小部件，然后使用 jQuery 隐藏某些 div、文本等，使其更紧凑，更适合我们的网站。

是“合法的”还是可以接受的？我正在尝试通读他们的所有文件以找出答案，但如果有人已经知道，那真的会有所帮助。

蒂亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:10:57.717

Facebook 使用 iframe 在您的网站上加载注册插件。因此，您无法使用 css 或 jQuery 更改它的外观。

您可以根据此处提供的指南进行自定义。 [https://developers.facebook.com/docs/guides/web/](https://developers.facebook.com/docs/guides/web/)

# c# - HtmlAgility Pack 创建的测试 HTML 是否有效

> ID：10693307
> 
> 赞同：4
> 
> 时间：2012-05-21T22:06:45.397
> 
> 标签：c#, html, html-agility-pack

我想确保使用 HtmlAgility 包生成的 HTML 是有效的 HTML5。

例如，以下创建一个空的 HTML5 文档。我将拥有其他类似的功能来创建更复杂的文档。我想要验证我没有搞砸什么并且生成的 HTML 格式正确且有效的测试。

```
public static String CreateEmptyHtmlDoc()
{
    var hd = new HtmlDocument();
    var doctype = hd.DocumentNode.SelectSingleNode("/comment()[starts-with(.,'<!DOCTYPE')]");
    if (doctype == null)
        doctype = hd.DocumentNode.PrependChild(hd.CreateComment());
    doctype.InnerHtml = "";

    hd.DocumentNode.AppendChild(
      HtmlNode.CreateNode(
        "<HTML><HEAD><META CHARSET=\"UTF-8\"><TITLE></TITLE></HEAD><BODY></BODY></HTML>"));
    return hd.DocumentNode.OuterHtml;
} 
```

我将如何使用 HtmlAgility Pack 构建“html5 验证器”，我可以在其中执行以下操作：

```
Assert.IsTrue(IsValidHtml5(CreateEmptyHtmlDoc())); 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T22:12:58.747

w3c 提供免费的在线验证器。您可以编写一个包装器来提交您生成的文档以供验证。通过直接输入验证可能是最简单的自动化选项。HTML5 验证是实验性的。如果您大规模执行此操作，请检查他们的服务条款。

[http://validator.w3.org/#validate_by_input+with_options](http://validator.w3.org/#validate_by_input+with_options)

[validator.nu](http://about.validator.nu/)通过 RESTful API 提供类似的服务。

# jquery - 使用 django 生成文件以使用 javascript/jQuery 下载

> ID：10693314
> 
> 赞同：6
> 
> 时间：2012-05-21T22:07:22.590
> 
> 标签：jquery, python, django, download

使用 Django，我想让一些数据可供下载。

到目前为止，我的 jQuery 调用看起来像这样：

```
$.getJSON("/get_data", 
            { users: users, study: "{{study.id}}" } ,
            function(json){
                alert('some data!');
            }
); 
```

这会调用我的一个 Django 视图，它会生成一些 JSON 并尝试将该 JSON 文本放入文件中以供下载

```
jsonResponse = json.dumps(data, cls=DjangoJSONEncoder)

jsonFile = cStringIO.StringIO()
jsonFile.write(jsonResponse)

response = HttpResponse(jsonFile, mimetype='application/json')
response['Content-Disposition'] = 'attachment; filename=data.txt'

return response 
```

但是，这不起作用。看了一会儿，我相信我应该在两端更改一些东西——Javascript 和 python/Django 代码——但我不清楚具体是什么。

对于 Python，我主要关心的是[cStringIO](http://docs.python.org/library/stringio.html#module-cStringIO)的使用（尤其是在返回之前我无法在 jsonFile 上执行 close 而不会提示“ValueError: I/O operation on closed file”）。

也许我也应该使用 FileWrapper（就像在这篇[文章](https://stackoverflow.com/questions/908258/generating-file-to-download-with-django)中一样），但无论有没有它，我都会得到相同的结果。

对于 Javascript，我不确定我的成功处理程序函数应该包含什么。

任何指针将不胜感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T01:56:24.633

对此的经典解决方案是使用隐藏的`iframe`.

在你的`urls.py`

```
url(r'^test/getFile', 'getFile') 
```

在你的`views.py`

```
def getFile(request):
    fileContent = "Your name is %s" % request.GET['name']
    res = HttpResponse(fileContent)
    res['Content-Disposition'] = 'attachment; filename=yourname.txt'
    return res 
```

在您的页面上

```
<script type="text/javascript">
    var data = {name: 'Jon'};
    $(function(){
        $("body").append('<iframe src="/test/getFile?'+ $.param(data) + '" style="display: none;" ></iframe>');
    });
</script> 
```

# javascript - Firefox 3.6.24 在某些图像上添加了灰色边框

> ID：10693316
> 
> 赞同：0
> 
> 时间：2012-05-21T22:07:31.510
> 
> 标签：javascript, html, css, firefox

Firefox 在我的大多数图像上都设置了灰色边框。边框有时位于底部或右侧。如果我在图像中添加填充，有时边框会消失。

图像不是链接，我基本上涵盖了 CSS 中的每个选项以消除问题，但没有成功：

```
body img{
    padding: 0;
    border: none;
    text-decoration: none;
    outline: none;
    overflow: hidden;
    -webkit-border-radius: 0;
     -khtml-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-box-shadow: 0 0 0 #000;
       -moz-box-shadow: 0 0 0 #000;
} 
```

希望有人以前遇到过这种情况或有一些信息可以提供帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:18:29.510

尝试向您的 html img 标签添加一个属性，例如`border="0"`

# ruby-on-rails - 简单的 Rails 搜索

> ID：10693318
> 
> 赞同：0
> 
> 时间：2012-05-21T22:07:37.953
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我为我的 rails 应用程序生成了一个 search_contoller 和视图。

我的控制器：

```
class SearchController < ApplicationController

  def index
    if params[:commit] == "Search"
      # Great, now lets figure out what sort of query we're after
      @searchQuery = params[:q]
      @resultsReceived = true
      if 
         @sqlResults = Product.where("title like ? OR categories like ?", "%" + params[:q] + "%", "%" + params[:q] + "%").order("published DESC")
      end
    else
      @resultsReceived = false
      @sqlResults = []
    end

    # Render the page when we're done.
    respond_to do |format|
      format.html
    end
  end
end 
```

我的观点

```
<%= form_tag("/search", :method => "get") do %>
  <%= label_tag(:q, "Search for:") %>
  <%= text_field_tag(:q) %>
  <%= submit_tag("Search") %>
<% end %>

<% if @resultsReceived == true %>
<b><%= @sqlResults.length %> Results Found For: </b><%= @searchQuery %>
<br>
<table>
  <tr>
    <th>Publish</th>
    <th>Product</th>
    <th></th>
  </tr>
<% @sqlResults.each do |product| %>
 <tr class="<%= cycle('oddrow', 'evenrow') %>">
      <td><%= check_box_tag "product_ids[]", product.id, product.published, {:id => product.id, :class => "publish_checkbox"} %></td>
      <td><%= link_to 'Edit', edit_product_path(product) %></td>
      <td><%= link_to 'Destroy', product, confirm: 'Are you sure you want to KILL this product?', method: :delete %></td>   

      <td>
        <div>
          <b>Title:</b> <%= product.title %>
        </div>

        <div class="float_left prod_image">
            <a href='<%= product.url %>' target="_blank"><img src='<%= product.image_url %>' class='product_image'></img></a>
        </div>
        <div class="float_left prod_description">
          <div><b>Product is Published: </b> <%= product.published %></div>
          <div><b>Category Names:</b> <%= product.category_names %></div>
          <div><b>Categories:</b> <%= product.categories %></div>
          <div><b>Rating:</b> <%= product.rating %></div>
          <div><b>Wow:</b> <%= product.is_curated %></div>
          <div><b>Age:</b> <%= product.pr_attributes['ag_type'] %></div>
          <div><b>Gender:</b> <%= product.pr_attributes['gender_type'] %></div>
          <div>
            <b>Description:</b>
            <% if product.long_descr.length < 200 %>
              <%= product.long_descr %>
            <% else %>
              <span id="short_desc_<%= product.id %>"><%= product.long_descr[0..199] %>...</span>
              <span class="long_description", id="long_desc_<%= product.id %>"><%= product.long_descr  %> </span><a id="<%= product.id %>" class="toggle">toggle</a>
          <% end %>
          </div>
      <div><b>Backfill Male:</b> <%= product.backfill_text['male'] %></div>
      <div><b>Backfill Female:</b> <%= product.backfill_text['female'] %></div>
      <div><b>Backfill Unisex:</b> <%= product.backfill_text['unisex'] %></div>
      <div><b>MP Seller Name:</b><%= product.mp_seller_name %></div>
          <div><b>Price:</b> Current: $<%= product.curr_item_price %> / Base: $<%= product.base_item_price %></div>
      <div><b>ID STR:</b> <%= product.id_str %></div>
      <div><b>Stock:</b> <%= product.stock_status %></div>
      <div><b>Last Updated by <%= product.updated_by_name %> at <%= product.updated_at %></b></div>
        </div>
 </tr>

<% end %>
<% end %> 
```

我需要更具体的搜索，并且想分解 sql 语句，所以我可以搜索其他附加属性。例如，我想搜索 TITLE（并获得仅与用户输入的字符串匹配的结果）或按 GENDER 搜索（并仅返回我用户正在搜索的性别）。我怎样才能做到这一点？我应该为我想要执行的每种类型的搜索创建新的 form_tags 吗？是否可以在视图中只有一个搜索框，并让用户在单选按钮之间选择他们想要搜索的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:18:12.473

使用 MySQL，您的选择仅限于自行构建 LIKE 子句。MySQL 上的大多数 Rails 应用程序将使用其他搜索选项，例如 SOLr（太阳黑子）、ElasticSearch 或 Sphinx。

在 PostgreSQL 上，您有更多选项来使用内置的全文搜索功能，例如 Texticle。

上面有很多链接：[https ://www.ruby-toolbox.com/categories/rails_search](https://www.ruby-toolbox.com/categories/rails_search)

# c - 使用 scandir() 时打开每个文件但不链接到其他目录

> ID：10693329
> 
> 赞同：4
> 
> 时间：2012-05-21T22:09:04.883
> 
> 标签：c, loops, copy, scandir

我想`cp -R`使用 POSIX 递归地将一个目录复制到另一个目录（如 ）[`scandir()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/scandir.html)。

问题是当我复制像 /sys/bus/ 这样的目录时，其中包含指向更高级别的链接（例如： foo/foo1/foo2/foo/foo1/foo2/foo/... ）系统进入循环状态并永远复制“中间”的目录......

如何检查我用 dirent 打开的文件是否是链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T07:40:38.553

看这个：[如何检查两个文件名是否指向同一个物理文件](https://stackoverflow.com/questions/2042106/how-to-check-whether-two-file-names-point-to-the-same-physical-file)

您需要存储您访问过的 inode 列表，以确保没有任何重复项。如果您有两个指向同一个文件的硬链接，则没有“一个”规范名称。一种可能性是首先存储所有文件，然后递归所有文件名。您可以将路径结构与 inode 和文件内容分开存储。

# facebook - Open Graph - 自定义动作和对象

> ID：10693331
> 
> 赞同：0
> 
> 时间：2012-05-21T22:09:19.763
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph

我正在尝试实现 Open Graph 自定义操作和对象。

我使用本教程作为参考[https://developers.facebook.com/docs/opengraph/tutorial/](https://developers.facebook.com/docs/opengraph/tutorial/)

一切似乎都很好，我可以使用 curl 命令在我的时间轴上发布一个动作。
但是，当尝试从站点执行此操作时，请求权限的弹出窗口没有打开图形操作请求，即使我请求 publish_actions 权限。

我错过了什么？我是否必须先发布操作才能显示在推荐对话框中？请注意，在应用程序设置下，如果我转到 Auth Dialog > advanced 并执行“Preview Referral Dialog”，弹出对话框看起来是正确的。

![在此处输入图像描述](../Images/47c374ed488ad2dd672e2d15c4c1e0b5.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:18:02.847

如果您是应用程序的管理员或开发人员，您将能够在操作被批准之前请求 publish_actions 的权限。尝试使用 API Explorer 工具测试您从网站发出的请求：[https ://developers.facebook.com/tools/explorer/](https://developers.facebook.com/tools/explorer/)

您是否在尝试从您的站点测试该操作之前删除该应用程序？如果您已经批准了应用程序和请求的权限，您将不会再次看到对话框。

发布您用于请求 publish_actions 权限的代码。此外，请确保从您的应用程序的“高级”设置中启用“增强的身份验证对话框”。

# php - PHP 和 JQuery Post 通信错误

> ID：10693332
> 
> 赞同：1
> 
> 时间：2012-05-21T22:09:23.477
> 
> 标签：php, jquery

好的，所以我尝试了多种解决方案，但似乎没有什么对我有用，（或者我太愚蠢了，无法理解）。

我有这样的jQuery代码：

**查询：**

```
var current_id = $(this).attr("id");
var dataString = {"id" : current_id};
$.post("popup.php" , {"id" : $(this).attr("id")}, function(msg) { alert(msg);} ); 
```

我知道这里有几行没用，但我尝试了所有选项，

**PHP：**

```
$tmp = $_POST['id'];
if($tmp == "kontakt"){
echo '<p>UDANE PRZESŁANIE</p>';}
else{
echo '<p>NIEUDANE PRZESŁANIE</p>';
} 
```

当我点击 id=kontakt php 返回错误：

```
 Notice: Undefined index: id in D:\***\popup.php on line 2 
```

但警报发回

```
<p>UDANE PRZESŁANIE</p> 
```

编辑：

好吧，也许我没有把我的问题说清楚。我不在乎是否显示 php 错误，我只想知道为什么它首先出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:15:26.373

这只是一个 PHP 警告——它基本上是在说 $_POST 没有名为“id”的索引。

您可以通过多种方式摆脱它...

1.  Austin Allover 的简短回答：

    if(!isset($_POST['id')) $tmp = '';

2.  在脚本或 php 配置文件中打开警告，请参阅： [http://php.net/manual/en/function.error-reporting.php](http://php.net/manual/en/function.error-reporting.php)（查找 E_WARNING）

3.  您可能还想尝试 $.post("popup.php" , {"id" : "BLAHBLAHBLAH"}, function(msg) { alert(msg);} ); - 以防万一 $(this).attr("id") 不包含任何东西......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:12:38.497

以这种方式声明 $tmp var：

```
$tmp = (isset($_POST['id'])) ? $_POST['id'] : ""; 
```

或者 ...

```
if(isset($_POST['id'])) { $tmp = $_POST['id']; } else { $tmp = ""; } 
```

如果你不明白这段代码的作用......

如果设置了帖子 ID，则将 $tmp 声明为帖子 ID，否则将 $tmp 设置为“”。这将带走 PHP 通知。

# javascript - Webkit JQuery Mobile 块到内联转换不起作用

> ID：10693333
> 
> 赞同：5
> 
> 时间：2012-05-21T22:09:28.623
> 
> 标签：javascript, jquery, jquery-mobile, webkit

我很想改变方向以在移动浏览器上工作。当方向改变时，div“wrapStat”应该在内联和块显示之间改变。

这个完整的文本块每隔 X 秒就会被一个 ajax 调用替换，因此在 wrapStat 类本身上放置一个样式是行不通的。我正在根据方向更改 PortraitCustomStats 和 LandscapeCustomStats 之间的父 #CustomStats 类。

这在 Firefox 中有效（调整浏览器大小将翻转方向标志）但在 ajax 调用触发之前在任何 webkit 浏览器中都不起作用。

webkit 和动态更改内联和块样式是否存在问题？

CSS：

```
.portraitCustomStats .StatsRow .wrapStat {
    display: block !important;
}
.landscapeCustomStats .StatsRow .wrapStat {
    display: inline !important;
} 
```

javascript:

```
$(window).bind('orientationchange', function (anOrientationEvent) {
    if ($(window).width() > 600) return;
    $("#CustomStats").attr("class", anOrientationEvent.orientation.toLowerCase() + "CustomStats").trigger("updatelayout");
}); 
```

HTML：

```
<span id="CustomStats" class="portraitCustomStats">
    <tr class="StatsRow">
      <td class="description">Unique Visitors</td>
        <td class="stat">
          <span class="UniqueVisitors">
            <strong>
            <div class="wrapStat">
              <span class="pastStat">(1,318)</span>
                <img src="../../Images/up_arr.gif" alt="increase">
                <span class="increasedStat">85.43%</span>
            </div>
           </span>
        </td>
    </tr>
</span> 
```

这是代码的jsFiddle实际上不起作用...

[http://jsfiddle.net/Hupperware/43eK8/5/](http://jsfiddle.net/Hupperware/43eK8/5/)

移动端视图：http: [//jsfiddle.net/m/rat/](http://jsfiddle.net/m/rat/)

这在 Firefox 中有效（文本在“横向”中变为红色，在“纵向”中变为蓝色，这样您就知道它正在工作）。在 FF 中，当您在更宽的视图和窄的视图之间切换时，它将显示内联和阻塞...

在 Webkit（Safari 和 Chrome）中，它不会...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T15:10:32.983

我做了一些测试，但无法重现问题。您是否尝试过在 jsfiddle 上测试移动调试功能？

我整理了以下简单的示例。

HTML：

```
<body>
    <div id="changeMe">Hello World</div>
</body> 
```

CSS：

```
.portrait {
    display: block !important;
}
.landscape {
    display: inline !important;
}
#changeMe {
    color: blue;
} 
```

Javascript：

```
$(document).ready(function() {

    $('body').on('orientationchange', function() {
        console.log('updated orientation: ' + window.orientation);

        if (window.orientation == 0) {
            // portrait mode
            $('#changeMe').removeClass('landscape').addClass('portrait').text('Portrait Mode');
        } else {
            // landscape mode
            $('#changeMe').removeClass('portrait').addClass('landscape').text('Landscape Mode');
        }
    });

});​ 
```

这是工作 jsfiddle 的链接：http: [//jsfiddle.net/gizmovation/9ALTU/](http://jsfiddle.net/gizmovation/9ALTU/)

当您使用移动调试功能（运行按钮旁边的 wifi 小图标）时，您可以在您的 iphone 上打开该页面，同时在您的 PC 上进行调试。当我这样做时，我能够看到块和内联样式在#changeMe div 上正确切换。无论内容是否通过 ajax 加载，这都应该有效。

希望这会有所帮助，并且您能够使用移动调试器来解决您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T16:22:45.723

我相信我已经找到了答案……

原来的：

```
<tr class="StatsRow">
     <td class="description">Total Sales</td>
     <td class="stat">
          <span class="TotalSalesRow">
               <strong>$59,549.16</strong>
               <div class="wrapStat">
                    <span class="pastStat">($59,799.66)</span>
                    <img src="https://portal.thesba.com/Images/down_arr.gif" alt="decrease">
                    <span class="decreasedStat">0.42%</span>
               </div>
          </span>
      </td>
</tr> 
```

当您尝试更改包含 div 的布局时，似乎有一个跨度包装 div 会导致 webkit 中出现不良行为。

更改：（低于 2nd td 的 div 标签）

```
<tr class="StatsRow">
     <td class="description">Total Sales</td>
     <td class="stat">
          <div class="TotalSalesRow">
               <strong>$59,549.16</strong>
               <div class="wrapStat">
                    <span class="pastStat">($59,799.66)</span>
                    <img src="https://portal.thesba.com/Images/down_arr.gif" alt="decrease">
                    <span class="decreasedStat">0.42%</span>
               </div>
          </div>
      </td>
</tr> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T14:09:53.387

我没有得到的是`if ($(window).width() > 600) return;`您不想针对高 rez 设备？

我可能错了，但如果 paysage 和大多数最近的 android 和 iphone（> HVGA 和 Iphone 视网膜），它不会结束这个事件处理功能吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T22:56:12.990

我不能说浏览器中的 webkit 处理。我可以说的是，在设备和浏览器中检测到的方向变化是不同的。这可能会导致头痛......（[示例](https://forum.jquery.com/topic/orientationchange-event-returns-wrong-values-on-android)）。

上次我拔掉头发是因为 Android 总是返回“错误”的方向（横向纵向，纵向横向），而 iOS 以相反的方式报告它。

这就是为什么[JQM 建议](http://jquerymobile.com/test/docs/api/events.html)在使用 width/height 和orientationchange 时**绑定**resize**而**不是orientationchange。调整大小将与每个方向更改一起触发，因此您独立于事件的浏览器实现。

 **所以我的第一个建议是：你可以绑定来调整大小吗？

如果您想坚持使用orientationchange，这是我正在使用的一个脚本，它似乎可以正常工作：

```
// trigger 
$(window).on('orientationchange', function(event){
      your_function(event);
      });

// function handling orientation
function  your_function(event) {
    ...
    if ( event ) {
        // portrait
        if (window.orientation == 0 || window.orientation == 180 ){
                // portrait stuff
        }
        // landscape
            else if (window.orientation == 90 || window.orientation == -90 ) {
                // landscape stuff
                }
        // any other event that's passed into here, you could feed RESIZE
        } else if ( $window.width() < THRESHOLD WIDTH) {
                // portrait stuff
                } else if ($window.width() > THRESHHOLD WIDTH) {
                          // landscape stuff
                          }
               } 
```

现在，我只是将orientationchange 输入到这个函数中，它似乎工作正常。如果不是这样，我也可以更改为在调整大小时触发它，而不是像这样传递事件：

```
$(window).on('resize', function(event){
     your_function("I'm no event");
     }); 
```

这将在第二个处理程序中结束。您将需要一个阈值宽度（600px？），尽管布局应该改变。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-27T03:39:20.630

您在上面粘贴的 html 搞砸了。你有一个未封闭的强标签。你可能根本不应该有一个强标签，或者如果你有，把它放在 div 里面，而不是外面。你有 tr 包裹在一个跨度中。这在语法上是非常不正确的，我一点也不惊讶它不能可靠地呈现。默认情况下，跨度是内联的，然后您将 tr 放在内联元素内。你希望这会如何呈现？如果可以，请尝试完全删除 tr 和 td，而只使用浮动 div。如果您绝对需要使用表格，请正确构建表格。尝试简化标记。标记越复杂，出错的空间就越大。如果您有多个标记错误，不同的浏览器可能会以不同的方式处理不良标记。那里' s 没有理由在 td（块）内的 spans（内联）内的 strongs（默认内联）内有 div（默认为块）。我认为如果你简化和清理你的标记，问题就会消失。祝你好运。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-24T03:46:06.133

尝试`!important`从你的两个 CSS 类中删除。**

# wicket - 使用“/”路径挂载页面

> ID：10693336
> 
> 赞同：1
> 
> 时间：2012-05-21T22:09:30.183
> 
> 标签：wicket

我试图在检票口中使用 mountPage 将“/” url 挂载为我的 MainPage url。

我的 WebApplication 现在看起来像这样：

```
public class WicketApplication extends WebApplication
{
@Override
public Class<HomePage> getHomePage()
{
    return HomePage.class;
}

@Override
public void init()
{
    super.init();
    mountPages();
}

private void mountPages()
{
    mountPage( "/home", HomePage.class );
    mountPage( "/about", AboutCompany.class );
    mountPage( "/prices", Prices.class );
    mountPage( "/gallery", Gallery.class );
    mountPage( "/contact", Contact.class );
    mountPage( "/offer", Offer.class );
}
} 
```

并且实际上效果很好，但我想将“/home”更改为“/”，但是它与 CSS 混淆了很多，例如，不是转移它，而是整个主页。我怎样才能按照我想要的方式进行这项工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T10:35:31.277

从 wicket 1.5 开始，您可以应用[HomePageMapper](http://wicket.apache.org/apidocs/1.5/org/apache/wicket/request/mapper/HomePageMapper.html)，它旨在将请求映射到根路径。实际上 HomePageMapper 将由 wicket 自动应用于您提供的页面，以便您`WebApplication`的`Class<? extends Page> getHomePage()`主页将安装到路径根目录

# javascript - jQuery ScrollTo 和 LocalScroll 从单击的链接中生成变量

> ID：10693343
> 
> 赞同：1
> 
> 时间：2012-05-21T22:10:24.743
> 
> 标签：javascript, jquery, element, this, scrollto

使用[scrollTo](http://flesler.blogspot.com/2007/10/jqueryscrollto.html)和[localScroll](http://flesler.blogspot.com/2007/10/jquerylocalscroll-10.html)在页面中导航，并且需要确定哪个链接被单击以用于回调函数。我已经挖掘了每个的来源，但无法理解如何提取它。

我确定的是，它`$(this)`指的是整个`body`元素。谢谢你的帮助！

这是我的功能：

```
$('nav').localScroll({
    duration: 500,
    easing:'easeOutSine',
    axis:'xy',
    onAfter: function(){
        /* This is where I need to identify the anchor that was clicked*/
        var test = $(this);
        console.log(test);
    }
}); 
```

HTML：

```
<nav>
  <ul>
    <li><a href="#one" class="active">One</a></li>
    <li><a href="#two">Two</a></li>
    <li><a href="#three">Three</a></li>
    <li><a href="#four">Four</a></li>
    <li><a href="#five">Five</a></li>
    <li><a href="#six">Six</a></li>
  </ul>
</nav> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:36:34.637

使用启用`hash`选项，这可能很有用：[JQuery > ScrollTo > 突出显示滚动到的项目](https://stackoverflow.com/q/7730400/729077)。

其他解决方案是向所有链接添加另一个`click`事件并设置您稍后可以在`onAfter`回调中读取的变量/属性。

# asp.net-mvc - 用于使用 NHibernate 在 mvc 中处理每个 Web 请求的会话的推荐模式

> ID：10693344
> 
> 赞同：1
> 
> 时间：2012-05-21T22:10:26.940
> 
> 标签：asp.net-mvc, nhibernate, fluent-nhibernate, session-per-request

例如。我的会话工厂位于 MyDomain.SessionProvider 类中。会话可以打开`using ISession session = SessionProvider.Instance.OpenSession()`

**步骤：SessionProvider.cs**

```
public static SessionProvider Instance { get; private set; }
        private static ISessionFactory _SessionFactory;

        static SessionProvider()
        {
            var provider = new SessionProvider();
            provider.Initialize();
            Instance = provider;
        }

        private SessionProvider()
        {

        }

        private void Initialize()
        {
            string csStringName = "ConnectionString";
            var cfg = Fluently.Configure()
               //ommiting mapping and db conf.

                .ExposeConfiguration(c => c.SetProperty("current_session_context_class", "web"))
                .BuildConfiguration();
            _SessionFactory = cfg.BuildSessionFactory();

        }

        public ISession OpenSession()
        {
            return _SessionFactory.OpenSession();
        }

        public ISession GetCurrentSession()
        {
            return _SessionFactory.GetCurrentSession();
        } 
```

**步骤：Global.asax.cs**

```
public static ISessionFactory SessionFactory { get; private set; } 
```

申请开始

```
SessionFactory = SessionProvider.Instance.OpenSession().SessionFactory; 
```

App_BeginRequest

```
var session = SessionFactory.OpenSession();
CurrentSessionContext.Bind(session); 
```

EndRequest 处理会话

```
var session = CurrentSessionContext.Unbind(SessionFactory);
session.Dispose(); 
```

**Step3.HomeController** 我应该使用当前会话

```
var session = SessionProvider.Instance.GetCurrentSession();
using (var tran = session.BeginTransaction())
{
   //retrieve data from session
} 
```

现在，尝试在我的控制器上检索数据，例如 desc。在步骤 3。我收到错误消息，提示我的会话已关闭。我试图删除 global.asax 中的 Application_EndRequest 块，因为我的事务被会话包装但没有成功。还是一样的错误。

第二个/侧面问题：这种模式是否被广泛接受，或者最好将其包装在 mvc 控制器的自定义属性中。谢谢。

更新：在我的控制器上尝试在线实例化当前会话

```
var session = SessionProvider.Instance.GetCurrentSession(); 
```

我收到以下错误：

```
**Connection = 'session.Connection' threw an exception of type 'NHibernate.HibernateException'**

**base {System.ApplicationException} = {"Session is closed"}** 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T09:30:10.963

谢谢@LeftyX

我使用 TekPub 视频 Mastering NHibernate 解决了这个问题，并进行了一些自定义。

全球.asax

```
//Whenever the request from page comes in (single request for a page)
//open session and on request end close the session.

public static ISessionFactory SessionFactory =
   MyDomain.SessionProvider.CreateSessionFactory();

public MvcApplication() 
{
    this.BeginRequest += new EventHandler(MvcApplication_BeginRequest);
    this.EndRequest +=new EventHandler(MvcApplication_EndRequest);
}

private void MvcApplication_EndRequest(object sender, EventArgs e)
{
    CurrentSessionContext.Unbind(SessionFactory).Dispose();
}

private void MvcApplication_BeginRequest(object sender, EventArgs e)
{
    CurrentSessionContext.Bind(SessionFactory.OpenSession());
}

protected void Application_Start()
{
    SessionFactory.OpenSession();
} 
```

在我的控制器里面

```
 var session = MvcApplication.SessionFactory.GetCurrentSession();
 {
     using (ITransaction tx = session.BeginTransaction())
      {... omitting retrieving data}
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T08:11:58.460

[您可以在此处](http://ayende.com/blog/4101/do-you-need-a-framework)和[此处](http://ayende.com/blog/4805/refactoring-toward-frictionless-odorless-code-limiting-session-scope)找到几个简单易用的实现，并在[此处](https://github.com/ayende/NHibernate-London-May)找到一些代码。
我喜欢 Ayende 保持一切简单和干净的方法：

```
public class Global: System.Web.HttpApplication
{
    public static ISessionFactory SessionFactory = CreateSessionFactory();

    protected static ISessionFactory CreateSessionFactory()
    {
        return new Configuration()
            .Configure(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "hibernate.cfg.xml"))
            .BuildSessionFactory();
    }

    public static ISession CurrentSession
    {
        get{ return (ISession)HttpContext.Current.Items["current.session"]; }
        set { HttpContext.Current.Items["current.session"] = value; }
    }

    protected void Global()
    {
        BeginRequest += delegate
        {
            CurrentSession = SessionFactory.OpenSession();
        };
        EndRequest += delegate
        {
            if(CurrentSession != null)
                CurrentSession.Dispose();
        };
    }
} 
```

在我的项目中，我决定使用 IoC 容器（StructureMap）。
如果你有兴趣可以看看[这里](https://stackoverflow.com/questions/9204611/using-nhibernate-with-both-mysql-server-and-microsoft-sql-server-2008/9213847#9213847)。

# .net - 带有滚动条 wpf 的富文本框缩放转换

> ID：10693345
> 
> 赞同：2
> 
> 时间：2012-05-21T22:10:31.123
> 
> 标签：.net, wpf, richtextbox

我有 RichTextbox 的转换如下：

```
 <RichTextBox Name="mainRTB" AcceptsTab="True" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" TabIndex="0" DockPanel.Dock="Top">
                <SpellCheck.IsEnabled>False</SpellCheck.IsEnabled>
                <RichTextBox.RenderTransform>
                    <TransformGroup>
                        <ScaleTransform 
                    ScaleY="{Binding Path=Value, ElementName=slider1}" 
                    ScaleX="{Binding Path=Value, ElementName=slider1}"/>
                    </TransformGroup>
                </RichTextBox.RenderTransform>
            </RichTextBox>
<Slider Width="100" VerticalAlignment="Center" Name="slider1" Grid.Row="1" Minimum="1" Maximum="3" DockPanel.Dock="Top" Value="1.0"/> 
```

富文本框的缩放由slider1 控制。问题是，当缩放因子增加到超过 1 时，richtextbox 上的滚动条会丢失，但是内容正在被编辑但不可见，我的意思是内容在可见屏幕下方，一旦缩放恢复正常我可以再次看到内容和滚动条，您能否建议我需要做什么才能使事情正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T02:37:07.373

您需要将 RichTextBox 放在 ScrollViewer 中。

# ruby - 如何在 DataMapper 中将 finalizing 分离到不同的数据库中？

> ID：10693346
> 
> 赞同：3
> 
> 时间：2012-05-21T22:10:32.997
> 
> 标签：ruby, sinatra, datamapper, ruby-datamapper

目前在我的 Sinatra + DataMapper 应用程序中，我有：

```
require 'data_mapper'

DataMapper.setup(:default,  "sqlite3://#{Dir.pwd}/main.db")
DataMapper.setup(:comments, "sqlite3://#{Dir.pwd}/comments.db")

class Recording
    include DataMapper::Resource

    # ...

    belongs_to :user
    has n, :comments
end

class User
    include DataMapper::Resource

    # ...

    has n, :recordings
end

class Audience
    include DataMapper::Resource

    # ...
end

# -------- ITS OWN DATABASE --------
class Comment
    include DataMapper::Resource

    #...

    belongs_to :recording
end 
```

我希望 Comments 类与其他类分开进入 comments.db。我环顾四周，看到了这样的东西（并且我已经根据我的情况对其进行了格式化）：

```
# -------- ITS OWN DATABASE --------
repository(:comments) do 
    class Comment
        include DataMapper::Resource

        #...

        belongs_to :recording
    end
end 
```

这会按计划进行吗，还是有适当的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T02:50:19.827

我们重写`#default_repository_name`模型上的方法来做到这一点：

```
class Comment
  include DataMapper::Resource

  def self.default_repository_name
    :comments
  end
end 
```

# direct3d - 为什么我们仍然在 D3D11 等中使用固定函数混合操作？

> ID：10693352
> 
> 赞同：1
> 
> 时间：2012-05-21T22:10:58.333
> 
> 标签：direct3d, direct3d11, direct3d10

我一直在试图理解为什么我们仍然在较新的 3D API（如 D3D11）中使用固定功能混合模式。在 D3D10 中，移除了固定功能 Alpha Clipping，以支持使用着色器。为什么，因为它在几乎任何情况下都是一种更强大的方法。

那么为什么我们不能计算或拥有混合操作（也就是我们当前正在渲染的 RenderTarget 中的纹理样本）？视频卡流水线中是否存在一些硬件设计问题使得这难以完成？

这很有用的原因是因为您可以做一些事情，例如使折射着色器运行得更快，因为您不必在每个折射对象叠加的两个渲染目标之间来回交换。例如用于操作系统或游戏 UI 的折射窗口系统。

哪里可能是提出这样一个想法的最佳地点，因为这不是一个讨论论坛，因为我希望在 D3D12 中看到这个？或者这在 D3D11 中已经可以实现了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T22:30:43.260

> 那么为什么我们不能计算或拥有混合操作

谁说你不能？使用 shader_image_load_store（和等效的 D3D11），您几乎可以对图像做任何您想做的事情。前提是你遵守规则。最后一部分通常是人们绊倒的地方。在着色器中进行完整的读取/修改/写入，以便以后的片段着色器调用不会读取错误的值，在大多数情况下几乎是不可能的。您必须通过说每个渲染对象不会与其自身重叠来限制它，并且您必须在渲染对象之间插入内存屏障（可以与其他渲染对象重叠）。或者您使用链表方法。

但重点是：通过这些机制，人们不仅在着色器中实现了混合，而且还实现了与顺序无关的透明度（通过链表）。没有什么能阻止你现在做你想做的事。

好吧，当然除了性能。固定功能混合器总是更快，因为它可以与片段着色器操作*并行运行。*混合单元是与片段着色器分开的硬件，因此您可以在执行片段着色器操作的同时进行混合操作（显然是来自后来的片段，而不是正在混合的片段）。

混合硬件中的读/修改/写机制是专门为混合而设计的，而 image_load_store 是一种更通用的机制。虽然从硬件发展的长期来看，通用可能会击败特定的，但在近期和不久的将来，您可以期望固定功能混合每次都在性能方面击败 image_load_store 混合。

*只有在必须*时才应该使用它。甚至，决定你是否真的，*真的*需要它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:16:15.893

> 视频卡流水线中是否存在一些硬件设计问题使得这难以完成？

是的，事实就是这样。如果可以在片段着色器中进行混合，这将引入可能的反馈循环，这确实使事情变得复杂。出于性能和并行化的原因，混合是在单独的硬连线阶段完成的。

# sql-server - 针对 SQL Server 使用 ADO.Net 同时批量插入，选择哪些索引？

> ID：10693357
> 
> 赞同：0
> 
> 时间：2012-05-21T22:11:25.427
> 
> 标签：sql-server, sql-server-2008, ado.net

如果我使用 ADO.Net 对同一个表同时进行批量插入，使用两个具有单独连接的不同进程，每个进程都有一个隔离级别为“ReadCommitted”的事务，该表具有：

*   RowId:bigint 身份
*   FooId:uniqueidentifier PK Non Clustered（在 bulkinsert 之前在代码中预先分配）

关于同时插入，最好是：

*   a) 在 RowId 上放置一个带有聚集索引和唯一键约束索引的 PK，非聚集在 FooId
*   b) 放一个唯一的键约束索引，非聚集在 RowId

还有其他提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T23:30:38.747

无论您选择哪一个，您都将拥有一个以 RowId 身份顺序排列的索引。这两个操作都将尝试在同一区域（索引结束）中插入行，因此无法实现最低限度的日志记录（即尽可能快的加载）。我强烈建议您阅读[数据加载性能指南](http://msdn.microsoft.com/en-us/library/dd425070%28v=sql.100%29.aspx)。

显而易见的问题是*为什么*要两个并发的批量插入操作？他们更有可能彼此放慢速度，而不是加快速度。在集群+索引场景中实现并行快速加载流是相当困难的。您是否尝试过单流和 TF610？如果您能够使用单个流实现最少记录的批量插入，并使用足够大的批处理大小，我希望它比两个完全记录的并行流更快。

# java - Thread.sleep 和 object.wait

> ID：10693361
> 
> 赞同：2
> 
> 时间：2012-05-21T22:12:31.713
> 
> 标签：java

两者都在尝试做类似的事情，即对线程产生一些影响。

我知道 thread.sleep 是让 CURRENT 线程休眠并等待可以让任何线程等待，如果他们试图获得对象的锁。

问题是，大多数时候他们都在做类似的事情——是什么让你选择一个而不是另一个？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-21T22:15:31.773

不，`Object.wait()`也只会导致*当前*线程阻塞。

主要区别在于`sleep()`指示当前线程休眠一段时间，而`wait()`指示当前线程释放一个监视器，然后休眠*直到通知监视器*。换句话说，`wait()`是线程之间的协调原语，而`sleep()`只关心时间的流逝（假设没有中断）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:19:54.130

睡眠和等待看起来很诱人，它们有很大的不同：

睡眠 - 使线程在给定的时间内睡眠 - 有利于调度任务、动画等......

等待 - 主要用于没有时间限制，使一个线程等待某事发生，这是同步的最佳实践。

如果您试图通过使用睡眠来实现等待，那是不好的做法，这有点接近一些非常糟糕的事情，称为忙等待。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T22:15:48.323

一个用于将线程同步在一起，而另一个用于休眠给定的时间。

如果你想同步线程一起，用户等待/通知。如果您想睡一段已知的时间，请使用 Thread.sleep。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T22:16:16.393

这两种方法做非常不同的事情：在等待通知事件[`Thread.sleep`](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html#sleep%28long%29)的同时[`Object.wait`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#wait%28%29)等待指定的时间（这可能需要任意时间才能发生）。

两者都只能让当前线程休眠。此外，`Object.wait`要求当前线程持有与对象关联的监视器。

# eclipse - 无法在 Eclipse 表中浏览 Informix 中的任何模式

> ID：10693370
> 
> 赞同：1
> 
> 时间：2012-05-21T22:13:35.943
> 
> 标签：eclipse, informix

***编辑：虽然这个问题对于 Eclipse 的 3.X 版本仍然没有答案，但使用 4.X 版本（Juno）解决了这个问题。***

我无法使用 Eclipse 数据源资源管理器在 Informix 中浏览给定模式的表。我可以浏览的唯一表是目录，即 Informix 模式中的 sys* 表。

我正在使用 Eclipse v3.6 (Helios) 和 Data Tools Project 插件 v1.9.2 来访问 Informix 11.70 数据库。驱动程序（v10.0）和连接配置似乎是正确的，因为我可以使用 SQL 剪贴簿正确地 ping 和查询，创建和选择表。事实上，一旦部署应用程序就可以完美运行，但我无法使用 JPS 工具等 Eclipse 功能。用户具有适当的访问权限，并且能够从 Server Studio 浏览和操作任何内容。

我在 Google 上搜索了几天，发现了一些类似的情况（例如，如果您在 URL 中缺少数据库，它可能发生在 MySQL 中），但没有找到正确的答案。

提前致谢

[PS：我在 DTP 论坛http://www.eclipse.org/forums/index.php/m/874976/#msg_874976](http://www.eclipse.org/forums/index.php/m/874976/#msg_874976)中有同样的问题

PS II：我创建了一个说明问题的测试项目。请注意“表格”节点无法展开。 ![在此处输入图像描述](../Images/f6a9f6954923f94ee69a1bcc5ee39bbb.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T13:55:07.653

问题将是“带有数据工具项目的 Eclipse Helios 如何在 Informix 数据库中查找表？

如果它直接询问 Informix 系统目录（`systables`, `syscolumns`, ...），应该不会有问题。您可以浏览系统目录表这一事实很奇怪。也许它只是`informix`在 Informix 行话中向您显示“由 ”拥有的表；`informix`在其他一些系统的行话中，这将是“在架构中”。查看插件选项，看看您是否可以以某种方式更改架构名称，或者让它同时查看所有架构。

如果它正在寻找标准的 SQL“信息模式”表，那么这些表在 Informix 中就是 AWOL。您可能能够运行`dbaccess yourdb $INFORMIXDIR/etc/xpg4_is.sql`并获得足够的信息架构表的古老版本（来自 XPG4 – X/Open Portability Guide 第 4 版 – 信息架构的定义）以供使用，但我不想打赌这是足够的。

# python - django-tastypie 可以在单个资源的列表和详细视图中显示一组不同的字段吗？

> ID：10693379
> 
> 赞同：11
> 
> 时间：2012-05-21T22:14:23.197
> 
> 标签：python, django, tastypie

我希望一个特定的`django-tastypie`模型资源在列出对象时只有一个字段子集，在显示详细信息时有所有字段。这可能吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-16T10:38:14.877

您现在还可以使用[`use_in`](http://django-tastypie.readthedocs.org/en/latest/fields.html#use-in)字段上的属性来指定要在其中显示该字段的相关资源。这可以是`list`或`detail`，或回调。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-22T12:57:12.570

您必须指定实际 ModelResource 中的所有字段，然后覆盖该`get_list`方法以仅过滤掉您要显示的字段。`get_list`请参阅on的内部实现`Resource`以了解如何覆盖它。

但是，请注意，这仅适用于 GET 请求，如果您的授权限制允许您这样做，您仍然应该能够使用所有字段对资源进行 POST/PUT/PATCH。

简而言之，您希望在调用 full_dehydrate 返回的所有 ORM 对象之前热修补内部字段列表`obj_get_list`。

或者，您可以让完整的脱水机制发生，并在它结束时删除您不想显示的字段，如果您不关心尽可能快地挤出。当然，只有当 URL 作为 get_list 调用的结果而被调用时，您才需要这样做。有一个方便的方法`alter_list_data_to_serialize(request, to_be_serialized)`。

做就是了：

```
class SomeResource(Resource):
    class Meta(...):
         ...
         field_list_to_remove = [ 'field1', 'field2' ]
         ...

    def alter_list_data_to_serialize(request, to_be_serialized):
        for obj in to_be_serialized['objects']:
            for field_name in self._meta.field_list_to_remove:
                del obj.data[field_name]
        return to_be_serialized 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T04:00:04.420

在 GitHub 上有一个[未解决的问题，其中建议了许多解决方法。](https://github.com/toastdriven/django-tastypie/issues/18)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-05T11:08:03.980

也可以使用 dehydrate(self, bundle) 方法。

`def dehydrate(self, bundle): del bundle.data['attr-to-del] return bundle`

# batch-file - 重定向批处理文件的输出，包括命令

> ID：10693381
> 
> 赞同：2
> 
> 时间：2012-05-21T22:14:51.647
> 
> 标签：batch-file, command, redirect

我有一个执行一系列命令的批处理文件。在每个执行过程中，它都会返回“成功”或“失败”消息。它很简单，可以使用 >> 重定向每个输出并将其发送到文件，但如果没有相关的命令，输出是无用的。

（批处理文件）

```
Command "D21" >> Myfile.txt
Command "D22" >> Myfile.txt
Command "D23" >> Myfile.txt
Command "D24" >> Myfile.txt 
```

（输出文件：Myfile.txt）

```
Fail
Succeed
Fail
Succeed 
```

我想做的还将执行的命令发送到该文件，所以它可能看起来像这样......

（所需的输出文件：Myfile.txt）

```
Command "D21" Fail
Command "D22" Fail
Command "D23" Succeed
Command "D24" Succeed 
```

关于如何以最少的努力完成此任务的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T00:52:01.120

我假设您想在批处理中选择性地重定向回显的命令和输出，而不是整个批处理。

```
@echo off
echo before not echoed, not captured
call :echoCommands >myFile.txt
echo after not echoed, not captured
exit /b

:echoCommands
echo on
Command "D21"
Command "D22"
Command "D23"
Command "D24"
@echo off
exit /b 
```

如果要捕获整个批处理文件，则只需从脚本中删除重定向，不要关闭回显，并在调用批处理脚本时进行重定向。

```
myScript >myFile.txt 
```

如果您想使用命令捕获整个文件输出，并且您真的想在脚本中重定向，那么类似

```
@if "%~1" neq "_GO_" (
  >myFile.txt call "%~f0" _GO_ %*
  exit /b
)
@echo on
Command "D21"
Command "D22"
Command "D23"
Command "D24" 
```

在上述所有解决方案中，每个命令都将打印在一行上，输出将在后续行上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:59:55.217

这是将命令和响应放在同一行的方式

```
@echo off
for /f "skip=6 delims=" %%i in (%~dpnx0) do (
    <nul set /p =%%i >> MyFile.txt
    %%i >> MyFile.txt
)
goto :eof
Command "D21"
Command "D22"
Command "D23"
Command "D24" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-13T22:25:48.527

有两种方法可以做到这一点。第一个有点“神秘”，但它可以在一行命令中完成：

```
for %%f in ("Command "D21"" "Command "D22"" "Command "D23"" "Command "D24"") do for /F "usebackq delims=" %%g in (`%%~f`) do echo %%~f %%g >> MyFile.txt 
```

这应该工作得很好。添加更多的只是有点麻烦**`Command "xxx"`**。

第二种方法是使用“子程序”来处理工作：

```
@echo off

call :work Command "D21"
call :work Command "D22"
call :work Command "D23"
call :work Command "D24"
goto :EOF

:work
for /F "usebackq delims=" %%g in (`%*`) do echo %* %%g
goto :EOF 
```

# extjs - ExtJS4：在 initComponent 中创建的存储在表单面板中未定义

> ID：10693382
> 
> 赞同：2
> 
> 时间：2012-05-21T22:15:01.517
> 
> 标签：extjs, extjs4

在回到 ExtJS4 文档并在他们的示例行中逐行复制试图解决我可能出错的地方之后，我很难过。嗅探 initComponent 处于不幸的操作顺序的问题。

正在定义的商店是 1) 不填充该字段，并且 2) 在尝试从字段侦听器调用它之后被认为是未定义的。

我在 initComponent 中定义了一个这样的商店，

```
Ext.define('X.view.NewLogWindow', {
extend: 'Ext.window.Window',
xtype:'newlogwindow',
itemId: 'newLogWindow',
width: 300,
height: 140,
modal: true,
title: 'Create Log',
layout: 'fit',
initComponent: function() {

    this.monthStore = Ext.create('Ext.data.Store', {
        fields : [
            {name : 'id', type : 'int'}, {name : 'month', type : 'string'}
        ],
        autoLoad: true,
        data : [
            {"id" : 0, "month" : "January"},
            {"id" : 1, "month" : "February"},
            {"id" : 2, "month" : "March"},
            {"id" : 3, "month" : "April"},
            {"id" : 4, "month" : "May"},
            {"id" : 5, "month" : "June"},
            {"id" : 6, "month" : "July"},
            {"id" : 7, "month" : "August"},
            {"id" : 8, "month" : "September"},
            {"id" : 9, "month" : "October"},
            {"id" : 10, "month" : "November"},
            {"id" : 11, "month" : "December"}
        ]
    });

    var x = 'fixme';

    console.log(this.monthStore);
    console.log(x);

    this.callParent();

} 
```

然后，我将商店分配给表单面板中的组合框，如下所示：

```
items: [
    {
        xtype: 'form',
        margin: 10,
        border: false,
        defaults: {allowBlank: false},
        items: [
            {
                xtype: 'combobox',
                fieldLabel: 'Log Month',
                store: this.monthStore,
                queryMode : 'local',
                displayField: 'month',
                valueField: 'id',
                listeners: {blur: function(field)
                {
                    console.log(this.monthStore);
                    console.log(this.x);
                    }

                }
            }
        ]
    }
] 
```

以下是我的控制台日志记录的输出：

```
constructor NewLogWindow.js:40
fixme NewLogWindow.js:41
undefined NewLogWindow.js:74
undefined NewLogWindow.js:75 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:27:31.863

您正在努力解决的是“这个”上下文的范围。在控制台输出上放置一个断点并检查“this”对象。它会让你走上正确的道路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T01:57:05.540

只需使用[storeId](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.AbstractStore-cfg-storeId)配置，这样您就可以掌握商店的句柄，例如：

```
initComponent: function() {

    Ext.create('Ext.data.Store', {
        storeId: 'months',
        fields : [
            {name : 'id', type : 'int'}, {name : 'month', type : 'string'}
        ],
        autoLoad: true,
        data : [
            {"id" : 0, "month" : "January"},
            {"id" : 1, "month" : "February"},
            {"id" : 2, "month" : "March"},
            {"id" : 3, "month" : "April"},
            {"id" : 4, "month" : "May"},
            {"id" : 5, "month" : "June"},
            {"id" : 6, "month" : "July"},
            {"id" : 7, "month" : "August"},
            {"id" : 8, "month" : "September"},
            {"id" : 9, "month" : "October"},
            {"id" : 10, "month" : "November"},
            {"id" : 11, "month" : "December"}
        ]
    });

// etc... 
```

然后，您可以使用`store: Ext.StoreManager.lookup('months')`将其分配到您想要的位置。

还要实现`initComponent`在组件中的静态数据处理完后调用。我不知道你在哪里运行上面的第二个代码块。但是您必须创建该组合以使用您在创建`initComponent`商店之后创建的商店，即`initComponent`调用之后。您可以在`initComponent`创建商店后立即执行以下操作：

```
this.items = [{
    xtype: 'form',
    margin: 10,
    border: false,
    defaults: {allowBlank: false},
    items: [{
        xtype: 'combobox',
        fieldLabel: 'Log Month',
        store: Ext.StoreManager.lookup('months'),
        queryMode : 'local',
        displayField: 'month',
        valueField: 'id',
        listeners: {
            blur: function(field) {
                console.log(this.monthStore);
                console.log(this.x);
            }
        }
    }]
}]; 
```

如果我有一个可以被多个视图使用的参考存储，我要做的另一件事是在控制器中创建它。然后，当我创建一个视图实例时，我已经可以使用它了，我可以执行`StoreManager.lookup`上面显示的调用。

# objective-c - 将 NSString 截断为宽度

> ID：10693383
> 
> 赞同：5
> 
> 时间：2012-05-21T22:15:05.593
> 
> 标签：objective-c, ios, algorithm

我正在尝试将[此处找到的代码](http://mobiledevelopertips.com/cocoa/truncate-an-nsstring-and-append-an-ellipsis-respecting-the-font-size.html)转换为二进制算法，因为线性方法非常慢。我有一个有效的实现，但似乎有些东西我错过了，因为我得到的结果并不精确（也就是说，如果我从宽度中添加或减去 20 个左右的像素，我会得到相同的截断字符串..它应该更准确一些并且更接近）：

```
-(NSString*)stringByTruncatingToWidth:(CGFloat)width withFont:(UIFont*)font addQuotes:(BOOL)addQuotes
{
    int min = 0, max = self.length, mid;
    while (min < max) {
        mid = (min+max)/2;

        NSString *currentString = [self substringWithRange:NSMakeRange(min, mid - min)];
        CGSize currentSize = [currentString sizeWithFont:font];

        if (currentSize.width < width){
            min = mid + 1;
        } else if (currentSize.width > width) {
            max = mid - 1;
        } else {
            min = mid;
            break;
        }
    }
    return [self substringWithRange:NSMakeRange(0, min)];
} 
```

任何人都可以看到蝙蝠有什么问题吗？（这是一个类别方法，`self`NSString 也是。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T01:40:12.223

我很确定这条线是错误的：

```
[self substringWithRange:NSMakeRange(min, mid - min)]; 
```

这意味着每次通过时，您只检查从`min`to的字符串的大小`mid`——但这不是您最终要显示`min`的字符串，因为在搜索时正在向上移动字符串。您应该始终从字符串的开头开始进行测试：

```
[self substringWithRange:NSMakeRange(0, mid)]; 
```

这是您完成搜索后要返回的内容。

# heroku - 使用共享数据库时如何查看 heroku 中的 postgres 数据？

> ID：10693391
> 
> 赞同：0
> 
> 时间：2012-05-21T22:15:38.350
> 
> 标签：heroku

我无法直接访问数据库，因为它是共享的。关于如何获得非常复杂的数据表的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:06:48.223

You probably want to use the dev plan, this will allow you to ingress and runs on the same version as the production instances - [https://devcenter.heroku.com/articles/heroku-postgres-dev-plan](https://devcenter.heroku.com/articles/heroku-postgres-dev-plan)

# sqlite - SQLite DataAdapter 没有更新或插入

> ID：10693397
> 
> 赞同：0
> 
> 时间：2012-05-21T22:16:11.193
> 
> 标签：sqlite, dataadapter

我使用 Sqlite v1.0.79 和 vs2010 创建了一个简单的 winform 应用程序。

我有一张客户表，想使用 SQLiteDataAdapter 轻松插入、更新和删除记录。所以我不需要输入整个插入、更新和删除语句。

所以我有一个带有静态加载函数的 Customer 类，它返回一个数据集。

```
 private static SQLiteDataAdapter _Adapter;

  internal static DataSet Load(long id)
  {
     var q = "SELECT * FROM Customer WHERE id = {0}".FormatInvariant(id);
     var cmd = new SQLiteCommand();
     cmd.Connection = [_Connection];
     cmd.CommandType = CommandType.Text;
     cmd.CommandTimeout = 10;
     cmd.CommandText = commandText;
     return cmd;         _Adapter = new SQLiteDataAdapter();
     _Adapter.SelectCommand = cmd;
     var ds = new DataSet();
     _Adapter.Fill(ds, "Customer");
     if (id == 0)
     {
        ds.AddRow(ds.NewRow());
     }
     var b = new SQLiteCommandBuilder(_Adapter);
     _Adapter.AcceptChangesDuringUpdate = true;
     _Adapter.InsertCommand = b.GetInsertCommand();
     _Adapter.UpdateCommand = b.GetUpdateCommand();
     _Adapter.DeleteCommand = b.GetDeleteCommand();

     // Commented out code for note A:
     ////ds.SetRowValue("lastname", "blaat44");
     ////_Adapter.Update(ds, "Customer");

     return ds;
  } 
```

调用 Load 方法后，DataSet 将用于 windows 窗体上的绑定。在一些更改之后，调用 Save 方法，其中应该保存更改。

```
 internal static void Save(DataSet data)
  {
     //// data.AcceptChanges();
     _Adapter.Update(data, "Customer");
  } 
```

但是更新后，数据库没有更新任何东西。我错过了什么？我已经在更新之前尝试了 data.AcceptChanges ，但没有任何效果。

顺便提一句。保存方法中的数据集确实具有“正确”值，但更新或插入不起作用....

奇怪的是，如果我在 Load 方法中更改数据集中的一个字段（上面示例中注释 A 处的注释掉的代码），则数据将正确保存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:35:10.840

我不是专家，对 sqlite 等有基本的了解，但问题可能是您将数据集传递给保存函数，因此适配器可能使用原始数据集的副本。这就是为什么它在加载方法中工作的原因，因为适配器正在访问原始数据集？

同样，这可能完全是胡说八道，我可能不明白，但我发现有时未受过教育的答案是朝着正确方向的一个很好的推动

# ios - 下面的代码是否存在潜在的内存泄漏？

> ID：10693402
> 
> 赞同：1
> 
> 时间：2012-05-21T22:16:35.657
> 
> 标签：ios

它返回的最后两行代码给了我一个潜在的内存泄漏警告。.....这是真阳性警告还是假阳性警告？如果属实，我该如何解决？非常感谢你的帮助！

```
-(UIImage*)setMenuImage:(UIImage*)inImage isColor:(Boolean)bColor
{ 
    int w = inImage.size.width + (_borderDeep * 2);
    int h = inImage.size.height + (_borderDeep * 2);

    CGColorSpaceRef colorSpace;
    CGContextRef context;

    if (YES == bColor)
    {
        colorSpace = CGColorSpaceCreateDeviceRGB();
        context = CGBitmapContextCreate(NULL, w, h, 8, 4 * w, colorSpace, kCGImageAlphaPremultipliedFirst);
    }
    else
    {
        colorSpace = CGColorSpaceCreateDeviceGray();
        context = CGBitmapContextCreate(NULL, w, h, 8, w, colorSpace, kCGImageAlphaNone);        
    }

    CGContextSetInterpolationQuality(context, kCGInterpolationHigh);

    CGContextDrawImage(context, CGRectMake(_borderDeep, _borderDeep, inImage.size.width, inImage.size.height), inImage.CGImage);

    CGImageRef image = CGBitmapContextCreateImage(context);
    CGContextRelease(context); //releasing context
    CGColorSpaceRelease(colorSpace); //releasing colorSpace

    //// The two lines of code above caused Analyzer gives me a warning of potential leak.....Is this a true positive warning or false positive warning? If true, how do i fix it?
    return [UIImage imageWithCGImage:image];
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T22:21:26.807

您正在泄漏`CGImage`对象（存储在您的`image`变量中）。您可以通过在创建`UIImage`.

```
UIImage *uiImage = [UIImage imageWithCGImage:image];
CGImageRelease(image);
return uiImage; 
```

这样做的原因是CoreGraphics 遵循CoreFoundation 所有权规则；在这种情况下，[“创建”规则](https://developer.apple.com/library/mac/documentation/CoreFoundation/Conceptual/CFMemoryMgmt/Concepts/Ownership.html#//apple_ref/doc/uid/20001148-103029)。即，带有“创建”（或“复制”）的函数返回一个您需要释放自己的对象。所以在这种情况下，`CGBitmapContextCreateImage()`返回一个`CGImageRef`你负责发布的。

* * *

顺便说一句，您为什么不使用`UIGraphics`便利功能来创建您的上下文？那些将处理在结果上放置正确的比例`UIImage`。如果你想匹配你的输入图像，你也可以这样做

```
CGSize size = inImage.size;
size.width += _borderDeep*2;
size.height += _borderDeep*2;
UIGraphicsBeginImageContextWithOptions(size, NO, inImage.scale); // could pass YES for opaque if you know it will be
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextSetInterpolationQuality(context, kCGInterpolationHigh);
[inImage drawInRect:(CGRect){{_borderDeep, _borderDeep}, inImage.size}];
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
return image; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:25:59.567

您必须释放您制作的 CGImageRef。`CGBitmapContextCreateImage`名称中有“create”，这意味着（Apple 严格遵守其命名约定）您负责释放此内存。

将最后一行替换为

```
UIImage *uiimage = [UIImage imageWithCGImage:image];
CGImageRelease(image);
return uiimage; 
```

# ruby-on-rails - 为什么 Rails 应用程序显示 /public 索引列表而不是实际应用程序？

> ID：10693403
> 
> 赞同：3
> 
> 时间：2012-05-21T22:16:43.617
> 
> 标签：ruby-on-rails, apache, virtualhost

一旦它在服务器上，你如何设置 apache 来显示 rails 应用程序？我的 rails 应用程序在 localhost 上运行良好，但是当我转到外部站点时，它会为我提供索引信息

像这样

```
Name    Last modified   Size    Description
[TXT]   404.html    21-May-2012 21:38   728      
[TXT]   422.html    21-May-2012 21:38   711      
[TXT]   500.html    21-May-2012 21:38   643      
[IMG]   favicon.ico 21-May-2012 21:38   0    
[TXT]   robots.txt  21-May-2012 21:38   204 
```

这是我的虚拟主机信息

```
<VirtualHost *:80>
      ServerAdmin example@example.com
      ServerName server.example.com
      # ServerAlias
      DocumentRoot /var/www/sample_app/current/public
      ErrorLog /var/www/sample_app/error.log

          RailsEnv production
        <Directory "/var/www/sample_app/current/public">
          Options Indexes FollowSymLinks MultiViews
          Order allow,deny
          Allow from all
        </Directory>
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T23:23:34.203

好吧，可能不是这样，但这是[乘客文档的](http://www.modrails.com/documentation/Users%20guide%20Apache.html#_deploying_to_a_virtual_host_8217_s_root)建议：

```
<VirtualHost *:80>
    ServerName www.mycook.com
    DocumentRoot /webapps/mycook/public
    <Directory /webapps/mycook/public>
        Allow from all
        Options -MultiViews
    </Directory>
</VirtualHost> 
```

明确指出MultiViews与Passenger**不**兼容。

所以你可以尝试：

*   删除索引选项
*   指定`-MultiViews`而不是`MultiViews`

老实说，我尝试将索引添加到我的生产应用程序中，因为我认为这可能只是导致问题的这个选项，但它并没有改变任何东西......所以这有点“疯狂的猜测” “它可能会解决您的问题。

**更新** 从[另一个答案](https://stackoverflow.com/questions/2923588/directory-listing-instead-of-rails-site-after-passenger-ree-upgrade)，您可以尝试添加`PassengerResolveSymlinksInDocumentRoot`选项：

```
<VirtualHost *:80>
    ServerName www.mycook.com
    DocumentRoot /webapps/mycook/public
    <Directory /webapps/mycook/public>
        Allow from all
        Options -MultiViews
        PassengerResolveSymlinksInDocumentRoot on
    </Directory>
</VirtualHost> 
```

# asp.net-mvc - 无法在 Global.asax 上加载类型 MvcApplication

> ID：10693405
> 
> 赞同：6
> 
> 时间：2012-05-21T22:16:50.603
> 
> 标签：asp.net-mvc, asp.net-mvc-3, deployment, global-asax

我使用 FTP 复制了我的 MVC3 Razor 网站。但是，当我输入 URL 时出现错误：

```
"Could not load type Mynamespace.MvcApplication" 
```

它表明问题出在 Global.asax 上：

```
 Line 1:  <%@ Application Codebehind="Global.asax.cs" Inherits="MvcPanamaVibes.MvcApplication" Language="C#" %> 
```

我的项目在我的电脑上运行良好。我尝试只上传 Global.asax 和其余的，但得到了错误。我也上传了 Global.asax.cs，但问题仍然存在。

如果我的应用程序已完全编译并在我的计算机上运行良好，为什么它会抱怨这个？我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T15:10:20.350

我遇到了这个问题，当我在服务器上重建我的 MVC 项目时，它已修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-23T23:34:53.303

我正在使用 IIS Express，并尝试了许多解决方案，但没有一个有效，两天后我发现了 1 个可能的解决方案：

1.  从发布输出文件夹复制 dll，尤其是 [项目名称].dll
2.  粘贴到调试输出文件夹然后运行。

# python - 实现 AirDrop 协议

> ID：10693411
> 
> 赞同：23
> 
> 时间：2012-05-21T22:17:58.650
> 
> 标签：python, c, wifi, bonjour, adhoc

我有兴趣在 iPad 或 Windows 计算机等设备上将 AirDrop 实现为客户端。谁能指出我在 Python 或 C 中实现 AirDrop 协议的正确方向。对此的任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-08-03T11:23:58.973

为了您或任何将尝试逆向工程和实施 Airdrop 的人的利益，以下是我发现的内容以及您必须做的事情才能开始：

涉及两个步骤，它们可以独立或并行完成。

1.  对物理 WLAN ad-hoc 网络的创建和命名方式进行逆向工程

为此，请从此处[http://istumbler.net/](http://istumbler.net/)获取 iStumbler，并尝试查看空投运行时是否出现了额外的 ad-hoc 网络。我曾短暂尝试过，似乎有一个未加密的 ad-hoc 802.11b 网络，其名称以“H”开头。（但我可能错了，你自己试试吧。）试着找出 Airdrop 用来命名或识别网络的模式。尝试从多台 Mac 上找到它。

1.  对协议进行逆向工程

一旦客户端加入 WiFi 网络，Airdrop 将检测到其他使用 Bonjour 的客户端。

首先，如[http://osxdaily.com/2011/09/16/enable-airdrop-ethernet-and-unsupported-macs/](http://osxdaily.com/2011/09/16/enable-airdrop-ethernet-and-unsupported-macs/)中所述，在您的终端中运行此命令以在*没有*隐藏的 ad-hoc 网络的情况下运行：

默认写入 com.apple.NetworkBrowser BrowseAllInterfaces 1

然后重新启动 Finder。

从这里获取 Bonjour 浏览器：tildesoft.com

启动 Airdrop 时，您会发现您的 mac 广告服务“_airdrop._tcp”。它还会发布您的 mac 正在侦听的主机和端口（每次在 Finder 中打开 Airdrop 时都会创建一个新的 IP 地址）的各种 IP 地址。它还发布了计算机的名称以及两个键“ehash”和“phash”以及一个值为 1 的键“flags”。您必须查看这两个哈希是如何生成的以及它们是否需要. 大概是吧。尝试使用可用的 Bonjour 库之一在第二台计算机上发布您自己的数据，并查看它们是否显示在 Airdrop（在 Finder 中）。

我发现每个客户端公开的 TCP 服务都在使用 SSL 连接。服务器证书似乎与您的 Apple ID 相关联。您可以在钥匙串中找到证书。服务器还请求客户端证书。这可能只是来自另一台计算机的相同 Apple ID 证书。您将不得不对此进行试验。

我不知道该 SSL 连接中使用的是什么协议，并且目前无法访问第二台 Mac 进行调查。您必须通过 MITM 来找出连接（试试 Charles 和 Wireshark）。在任何情况下，它将用于传输用户图标以及协商传输以及可能还用于移动实际数据。

我认为对此的开放实施将大有裨益，即使最终结果仅限于拥有 Apple ID 的用户——毕竟他们是免费的。

祝你好运！

# php - 柠檬的“hello world”解析器

> ID：10693418
> 
> 赞同：1
> 
> 时间：2012-05-21T22:18:44.533
> 
> 标签：php, pear, lexer, parser-generator, lemon

我花了几个小时尽力为解析简单的“hello + world”的柠檬解析器（分别是 PEAR 的 PHP_LexerGenerator）创建一个 y 文件。

我使用[了这个（德语）教程](http://blog.oncode.info/2007/10/25/eine-eigene-programmiersprache-erschaffen-lexer-und-parser-in-php/)，是的，有一个计算器教程很好，但最后，我想解析一些更复杂的东西（使用“变量”）。

这种“语言”解析/标记“hello + world”的定义是什么？

这是我尝试过的许多其他事情之一：

```
/* %name, %declare_class, %token_prefix, %syntax_error, .. removed */

%left S.
%left PLUS MINUS.

%right IDENT.

start(res)       ::= expression(expr). { res = expr; }

/* The common stuff */
expression(res)  ::= expression(e1) PLUS expression(t2). { res = e1+t2; }
expression(res)  ::= expression(e1) MINUS expression(t2). { res = e1-t2; }
expression(res)  ::= NUMBER(n). { res = n; }
expression(res)  ::= IDENT(n). { res = (n * 0) + 99; } 
```

除了 IDENT，我还尝试了 VALUE、string、... 甚至[SQLite/parser.y 文件都](http://read.cs.ucla.edu/~vandebo/sqlite/source/parse.y)没有帮助我。

谢谢你的帮助。

# php - 更改用户表关系的正确方法？

> ID：10693424
> 
> 赞同：0
> 
> 时间：2012-05-21T22:19:24.123
> 
> 标签：php, mysql

我正在开发一个事件系统，它有两个表，EVENTS 和 EVENT_CREATORS。我一直通过将创建者 ID 放在事件表中来将事件链接到创建者，因为我认为我只会有一个事件创建者。

我现在需要多个创建者编辑事件的能力。我是否应该简单地向 EVENTS 表添加其他字段，即 ec_id、ec_id_2、ec_id_3 等。或者向数据库添加交叉引用表并为其他创建者添加单独的表是否更有意义？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:22:50.723

你应该有 3 张桌子：

```
Event (with an ID field)
Creator (with an ID field)
EventCreator (2 fields: eventID and creatorID) 
```

这应该几乎涵盖了事件和创作者之间所有可能的关系。您可以通过在 EventCreator 表上创建索引来限制关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:22:58.633

简单来说就是添加一个交叉引用表。这样您就不必担心将来需要多少创作者。

所以，有一个像这样的表：

**xref_Events_Creators**
EventId
CreatorId

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T22:32:37.840

在这种情况下，明智的做法是使用交叉引用表。我将逐步解释它。第一的

*   创建一个新表。称之为“event_reference”
*   给出以下字段：`Id`, `Ref_Id`, `Creator_ID`.

我将省略 EventId 的需要，因为我们正在创建一个对事件的引用的表，所以事件的表将保存`Ref_Id`以跟踪所有引用。

*   *接下来*，修改`events`表并存储`Ref_ID`而不是`Creator`

这样，您可以以***标准化***的方式获取事件的所有创建者。

# c# - 如何为动态 for 循环级别编写代码？

> ID：10693425
> 
> 赞同：6
> 
> 时间：2012-05-21T22:19:30.307
> 
> 标签：c#, dynamic, recursion, for-loop, traversal

我的问题是这样的：

我有几个列表需要排列，但列表编号是不可知的。并且每个列表中的每个元素编号也是不可知的。Sicne我想遍历所有列表元素组合，例如1）从列表1中选择A，从列表2中选择A，从列表3中选择A；2) ick A 来自列表 1，A 来自列表 2，B 来自列表 3 ...对于 ALL 排列。

我使用嵌套的for循环来遍历，就像我有两个列表一样，那么：

```
 for (int i = 0; i < list[0].EnergyParameters.ListEnergyLevelCandidates.Count; i++)
        {
            for (int j = 0; j < list[1].EnergyParameters.ListEnergyLevelCandidates.Count; j++)
            {
                // Do sth
            }
        } 
```

如果我有三个列表，那么：

```
 for (int i = 0; i < list[0].EnergyParameters.ListEnergyLevelCandidates.Count; i++)
        {
            for (int j = 0; j < list[1].EnergyParameters.ListEnergyLevelCandidates.Count; j++)
            {
                for (int k = 0; k < list[2].EnergyParameters.ListEnergyLevelCandidates.Count; k++)
                {
                    // Do sth
                }
            }
        } 
```

因为列表号是不可知的，所以嵌套号也是不可知的，也就是说，我不知道需要写多少级的for循环。

在这种情况下，我该如何编写动态for循环级别的代码？我不想为 10 个列表编写 10 个循环。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-21T22:26:35.887

如果您不知道有多少列表，则不要编写嵌套循环：而是编写递归。在调用的每个级别，您循环一个列表，如下所示：

```
void AllCombos(List<string>[] lists, int level, string[] current) {
    if (level == lists.Length) {
        // Do somthing; items of current[] contain elements of the combination
    } else {
        foreach (var s in lists[level]) {
            current[level] = s;
             AllCombos(lists, level+1, current);
        }
    }
} 
```

调用`AllCombos`如下：

```
var lists = new List<string>[10];
for (int i = 0 ; i != 10 ; i++) {
    lists[i] = PopulateMyList(i);
}
string[] current = new string[lists.Length];
AllCombos(lists, 0, current); 
```

# php - 它不会把我送到下一页

> ID：10693426
> 
> 赞同：-1
> 
> 时间：2012-05-21T22:19:45.780
> 
> 标签：php

嘿，这样我就应该将一些信息放入数据库中，但是当它这样做时，它不会让我导出登录页面。这将只是空话白。

文件名**activate.php**

```
<?php
            include ("include/database/db.php");
            if($stmt = $mysqli->prepare("SELECT `code`,`rank` FROM `brugere` WHERE `code` = ?"))
            {
                $stmt->bind_param('s', $g_code);
                $g_code = $_GET["code"];
                $stmt->execute();
                $stmt->store_result();
                $stmt->bind_result($code, $rank);
                $stmt->fetch();
                $count_res = $stmt->num_rows;
                $stmt->close();

                if($count_res > 0)
                {
                    if($rank == 0)
                    {
                        echo "<h3 class=\"toptitlecontent\">Godkende email</h3>";
                        echo "<div id=\"box\"><ul><li>Husk at skrive alt ude på siden!</li></ul></div>";
                        $_SESSION["code"] = $g_code;
                    ?>

                    <div id="midtbox_alt">
                        <form action="http://,,,.dk/activate_updater.php" method="post" name="formular" onsubmit="return validerform ()" enctype="multipart/form-data">
                                <table border="0">
                                    <tr>
                                        <td id="tb-w_a"><p>Kategori</p></td>
                                        <td>:</td>
                                        <td>
                                        <select name="kategori">
                                        <?php
                                        $query = "SELECT id_katogori, navn FROM kategori";
                                        $result = $mysqli->query($query);
                                        while(list($id_katogori, $navn) = $result->fetch_row())
                                        {
                                            echo "<option value=\"$id_katogori\">$navn</option>";  
                                        }
                                        ?>
                                        </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td id="tb-w_a"><p>Djnavn</p></td>
                                        <td>:</td>
                                        <td><input type="text" name="djnavn"></td>
                                    </tr>
                                    <tr>
                                        <td id="tb-w_a"><p>Facebook</p></td>
                                        <td>:</td>
                                        <td><input type="text" name="facebook"></td>
                                    </tr>
                                    <tr>
                                        <td id="tb-w_a"><p>Pris</p></td>
                                        <td>:</td>
                                        <td><input type="text" name="pris"></td>
                                    </tr>
                                    <tr>
                                        <td id="tb-w_a"><p>Booking Email</p></td>
                                        <td>:</td>
                                        <td><input type="email" name="booking"></td>
                                    </tr>
                                    <tr>
                                        <td id="tb-w_a"><p>Mobil</p></td>
                                        <td>:</td>
                                        <td><input type="text" name="mobil"></td>
                                    </tr>
                                    <tr>
                                        <td id="tb-w_a"><p>Upload Profil</p></td>
                                        <td>:</td>
                                        <td><input type="file" name="file"></td>
                                    </tr>
                                </table>
                            <textarea name="profiltekst" style="width:500px; height:170px;"></textarea><br />
                            <input type="submit" value="Godkend brugere" name="godkendt-brugere">
                        </form>
                    </div>
                    <?php
                    }
                    if($rank == 2)
                    {
                        echo "<h3 class=\"toptitlecontent\">Forkert Email</h3>";
                        echo "<div id=\"box\"><ul><li>Din bruger er allerede godkendt</li></ul></div>";
                    }
                }
                else {
                    /* Der er opstået en fejl */
                    echo "<h3 class=\"toptitlecontent\">Ukendt side!</h3>";
                    echo "<div id=\"box\"><ul><li>Der opstod en fejl</li></ul></div>";
                }
            }
            ?> 
```

原因我有不必要的搅动这就是这样一个网站无法在谷歌上获得的原因.. 或者在这里因为我有帮助并且没有出现在谷歌上所以其他人可以看到我或说什么？

**她的 http:** //,,,.dk/activate_updater.php

 **文件名

激活更新程序.php

```
<?php include ("include/database/db.php");?>
<?php
session_start();
    if($stmt = $mysqli->prepare('UPDATE `brugere` SET `rank`=2, `katogori`=?, `djnavn`=?, `profilbillede`=?, `profiltekst`=?, `facebook`=?, `pris`=?, `booking`=?, `mobil`=? WHERE `code`=?'))
    {

        $stmt->bind_param('iiiiiiiis', $katogori, $djnavn, $profilbillede, $profiltekst, $facebook, $pris, $booking, $mobil, $g_code);
        //fra input ting ting..
        $katogori = $_POST["kategori"];
        $djnavn = $_POST["djnavn"];
        $profilbillede = $file;
        $profiltekst = $_POST["profiltekst"];
        $facebook = $_POST["facebook"];
        $pris = $_POST["pris"];
        $booking = $_POST["booking"];
        $mobil = $_POST["mobil"];
        $g_code = $_SESSION["code"];

        $stmt->execute();
        $stmt->close();
    }
    else
    {
        echo 'Der opstod en fejl i erklÃ¦ringen: ' . $mysqli->error;
    }
?> 
```

**所以问题是它不会让我被重定向到另一个页面..**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:22:54.827

我根本看不到您要重定向到哪里，但这不起作用：

```
<?php include ("include/database/db.php");?>
<?php
session_start(); 
```

您正在向浏览器发送输出（在 php 标签的关闭和打开之间有一个新行）并且`session_start`需要发送标头，如果标头已经发送，则无法执行此操作。

我猜`headers already sent`当您在脚本顶部启用错误消息时，您至少会看到一条错误消息：

```
ini_set('display_errors',1);
error_reporting(E_ALL | E_STRICT); 
```

**编辑：**需要明确的是，我没有看到任何重定向，`activate_updater.php`也没有在成功更新后显示任何内容，所以如果该`headers already sent`部分不是问题，可能就是这个。**

# gwt - smartgwt 过滤器设置数据

> ID：10693427
> 
> 赞同：2
> 
> 时间：2012-05-21T22:19:47.060
> 
> 标签：gwt, smartgwt

我有一个由 setData 方法填充的网格，我创建了一个过滤器，但我看到默认网格附带的过滤器有效，当我通过 DataSource 类获取数据时，我做得不好，我做到了用一个简单的 setData

有没有办法在不使用数据源的情况下实现过滤器？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T18:38:39.403

根据[这个论坛帖子](http://forums.smartclient.com/showthread.php?t=22009)，我倾向于怀疑您是否可以在没有数据源的情况下进行过滤。我建议在此 ListGrid 上构造一个 DataSource 并调用 setClientOnly() 以防止它触发任何 CRUD 事件。

# bash - 如何使用 printf 添加换行符？

> ID：10693431
> 
> 赞同：37
> 
> 时间：2012-05-21T22:20:15.780
> 
> 标签：bash, printing, terminal

如何使用 printf 在打印命令中添加新行？

```
printf "I want this on a new line!" 
```

我以为它会是这样的，但它没有用

```
printf "/n I want this on a new line!/n" 
```

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-05-21T22:21:53.937

要写一个换行符，`\n`不`/n`使用后者只是一个斜杠和一个

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-05-21T23:44:04.150

尝试这个：

```
printf '\n%s\n' 'I want this on a new line!' 
```

这使您可以将格式与实际文本分开。您可以使用多个占位符和多个参数。

```
quantity=38; price=142.15; description='advanced widget'
$ printf '%8d%10.2f  %s\n' "$quantity" "$price" "$description"
      38    142.15  advanced widget 
```

# asp.net - 使用 ASP .Net MVC4 在 Web API 中处理集合内的集合

> ID：10693435
> 
> 赞同：4
> 
> 时间：2012-05-21T22:21:00.350
> 
> 标签：asp.net, asp.net-mvc-4

我在我的机器上安装了新的 ASP .Net MVC4 beta 并且一直试图了解 Web API 的工作原理。我为单个集合（例如书籍）构建了一个演示。我按照 asp.net 网站上的示例进行操作。我实现了自己的发布到收藏的方法，即添加新书、获取所有书籍、获取特定书籍、更新书籍和删除书籍记录。这一切都很好。

前任：

```
POST /books - adds a new book
GET /books - gets all books
GET /books/1 - get a particular book
PUT /books/1 - update a particular book
DELETE /books/1 - delete a particular book 
```

现在我想在书籍集合中添加另一个集合，比如作者，并希望为新集合实现相同的 POST、PUT、GET 和 DELETE 调用

我希望新的电话是这样的：

```
POST /books/1/authors - add a new author to a book
GET /books/1/authors - gets all authors of a book
GET /books/1/authors/a@a.com - get a particular author for a book
PUT /books/1/authors/a@a.com - update a particular author for a book
DLETE /books/1/authors/a@a.com - delete a particular author for a book 
```

我很困惑如何添加路由以使此呼叫正常工作。默认情况下，我通过项目获得这条路线。

```
routes.MapHttpRoute(
name: "DefaultApi", 
routeTemplate: "api/{controller}/{id}", 
defaults: new { id = RouteParameter.Optional }
); 
```

在这种模式下，为集合和它们之间的关联处理路由的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T13:41:17.023

在 Global 中管理路线可能会令人困惑且容易出错。就个人而言，我发现 Attribute Routing 包有助于大大简化路由配置。本文介绍了如何获取和使用它。

[http://www.strathweb.com/2012/05/attribute-based-routing-in-asp-net-web-api/](http://www.strathweb.com/2012/05/attribute-based-routing-in-asp-net-web-api/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T10:17:56.640

我认为 Ken 使用 Attribute Routing 的方法更好，我是从这篇文章中发现的，我自己可能也会使用它。但这是我在了解 AR 之前想到的。

```
public static class WebApiConfig
{
    public static void Register(HttpConfiguration config)
    {
        config.Routes.MapHttpRoute(
            name: "JustController",
            routeTemplate: "api/Books/{bookId}/{category}/{categoryId}/{subCategory}",
            defaults: new
            {
                controller = "books",
                bookId= RouteParameter.Optional,
                category = RouteParameter.Optional,
                categoryId = RouteParameter.Optional,
                subCategory = RouteParameter.Optional
            },
            constraints: new
            {
                bookId= @"\d*",
                category= @"(|authors|pictures|videos)", 
                categoryId = @"\d*",
                subCategory = @"(|comments)"
            }
        ); 
```

然后我想在Get、Post、Delete、Put函数中使用Request属性中的URL，获取我需要的参数。

例如：

```
 public class BooksController : ApiController
    {
        // GET api/books
        public Book Get(int bookId)
        {
         var url = this.Request.RequestUri.ToString() // decide how to handle! 
```

# ruby-on-rails - 导轨。检查集合中的任何属性是否为空

> ID：10693439
> 
> 赞同：2
> 
> 时间：2012-05-21T22:21:23.563
> 
> 标签：ruby-on-rails, ruby

我有一系列发票。其中一个属性是 exchange_rate（用于从美元计算墨西哥比索的货币）。如果即使其中一条记录没有设置 exchange_rate，我也需要创建一个警告。

我可以像这样检查集合中记录的 exchange_rate 是否为空白...

```
<% is_blank = false %>

<% @invoices.each do |invoice| %>
  <% if invoice.exchange_rate.blank? %>
    <% is_blank = true %>
  <% end %>
<% end %>

<% if is_blank %>
  shoot warning: all of the invoices must have an exchange rate in order
  to calculate pesos total
<% end %> 
```

写上述内容的更 Railsy 方式是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T22:23:10.053

就像这样，使用[`Enumerable#any?`](http://apidock.com/ruby/Enumerable/any?)方法：

```
<% if @invoices.any? { |i| i.exchange_rate.blank? } %>
  shoot warning: all of the invoices must have an exchange rate in order
  to calculate pesos total
<% end %> 
```

# .htaccess - .htaccess mod_rewrite 带有子域的漂亮 URL

> ID：10693443
> 
> 赞同：0
> 
> 时间：2012-05-21T22:21:41.117
> 
> 标签：.htaccess, mod-rewrite, subdomain, friendly-url

我正在尝试从中获取我的网址：

hxxp://m.newsite.com/index.php?id=12345

对此：

hxxp://m.newsite.com/12345

我遇到的问题是我有一个共享主机帐户并且我正在托管一个新域，因此上述带有子域的 URL 在技术上可以从以下位置访问：

hxxp://www.originalsite.com/newsite.com/mobile

我已经为 mod_rewrite 尝试了各种不同的组合，但恐怕我只是不在那里！帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T08:09:50.443

把它放在`/newsite.com/mobile`目录的htaccess中

```
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} ^m\.newsite\.com$
RewriteRule ^([0-9]+)$ index.php?id=$1 [L] 
```

# mysql - 单元测试找不到表

> ID：10693444
> 
> 赞同：1
> 
> 时间：2012-05-21T22:21:44.950
> 
> 标签：mysql, ruby-on-rails, rake, testunit, octopus

我在 Rails 2.3 上运行单元测试，并且在运行时不断收到以下错误`rake test:units`：

```
10) Error:
test_the_truth(BrokerTest):
ActiveRecord::StatementInvalid: Mysql::Error: Table 'shadow_test.users' doesn't exist: DELETE FROM `users`
    /Library/Ruby/Gems/1.8/gems/after_commit-1.0.10/lib/after_commit/connection_adapters.rb:14:in `transaction' 
```

我在`rake db:test:load`此之前运行，它创建了表。但是，当我`mysql`在运行单元测试命令后检查时，这些表确实丢失了。在准备单元测试的过程中，有些东西会导致表格丢失。这是运行测试的调试日志：

```
WARNING: 'task :t, arg, :needs => [deps]' is deprecated.  Please use 'task :t, [args] => [deps]' instead.
    at /Users/me/sources/shadow/lib/tasks/turk.rake:53
** Invoke test:units (first_time)
** Invoke db:test:prepare (first_time)
** Invoke db:abort_if_pending_migrations (first_time)
** Invoke environment (first_time)
** Execute environment
** Execute db:abort_if_pending_migrations
** Execute db:test:prepare
** Invoke db:test:load (first_time)
** Invoke db:test:purge (first_time)
** Invoke environment 
** Execute db:test:purge
** Execute db:test:load
** Invoke db:schema:load (first_time)
** Invoke environment 
** Execute db:schema:load
** Execute test:units
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby -I"lib:test" -I"/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib" "/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb" "test/unit/**/*_test.rb" 
/Library/Ruby/Gems/1.8/gems/bundler-1.1.3/lib/bundler/runtime.rb:211: warning: Insecure world writable dir /usr/local/git/bin in PATH, mode 040777
NOTE: Gem.source_index is deprecated, use Specification. It will be removed on or after 2011-11-01.
Gem.source_index called from /Library/Ruby/Gems/1.8/gems/rails-2.3.14/lib/rails/gem_dependency.rb:21.
WARNING: using the built-in Timeout class which is known to have issues when used for opening connections. Install the SystemTimer gem if you want to make sure the Redis client will not hang.
/Users/me/sources/shadow/test/unit/../test_helper.rb:36: warning: already initialized constant BEANSTALK
Loaded suite /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader
Started
EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE
Finished in 3.389328 seconds. 
```

更多背景知识：我正在使用 Octopus 进行分片，这可能会以某种方式干扰事物？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:56:54.063

使用`Octopus`数据库分片 gem 在测试用例准备方面存在一些问题。请参阅 GitHub 问题：[https](https://github.com/tchandy/octopus/issues/31) ://github.com/tchandy/octopus/issues/31 。

您有几个选项，其中最简单的是`Octopus`为您的开发环境禁用。从您的`shards.yml`文件中删除“-development”。

否则，您可以通过添加任务来修补问题：

```
 task :reconnect_octopus do
   if ActiveRecord::Base.connection.is_a?(Octopus::Proxy)
     ActiveRecord::Base.connection.initialize_shards(Octopus.config)
   end
 end
 task :'db:test:clone_structure' => :reconnect_octopus 
```

或者对于 Rails 3：

```
 task :reconnect_octopus do
   if ActiveRecord::Base.connection.is_a?(Octopus::Proxy)
     ActiveRecord::Base.connection.initialize_shards(Octopus.config)
   end
 end
 task :'db:structure:load' => :reconnect_octopus 
```

这应该源于您上面列出的问题。快乐编码！

# c - 我应该如何在 C 中正确执行此命令

> ID：10693445
> 
> 赞同：0
> 
> 时间：2012-05-21T22:21:45.370
> 
> 标签：c

我目前正在使用 popen 通过 C 执行命令，但它没有正确输出，所以我只是想知道我是否做错了什么？

原始命令（以前通过 bash 脚本调用，但我现在正在制作一个 C 程序来调用它）是

```
 /home/minecraft/remoteclient01a.py "sendmsgtogroup staff §f(§bSTAFF§f) * $colourcode$MCEXEC_PLAYERNAME§f $MCEXEC_ARGS" 
```

我试图在 C 中执行它的方式是

```
 snprintf(command, 10000, "/home/minecraft/remoteclient01a.py 'sendmsgtogroup staff  §f(§bSTAFF§f) * %s§f %s'", pname, parg);
   popen(command, "w"); 
```

但是由于某种原因，执行命令时似乎没有包含最后一个变量（parg），如果有人可以让我知道我是否搞砸了，我将非常感激，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:36:43.393

哦，等等，似乎没有配置 irc 侦听器来正确接收它，这造成了没有任何东西通过的错觉，但实际上工作正常，不过感谢您的输入！“很尴尬”

# php - 通过直接比赛排序足球 [足球] 排名

> ID：10693446
> 
> 赞同：3
> 
> 时间：2012-05-21T22:21:53.253
> 
> 标签：php, mysql, sql

我在尝试在 football[soccer] 应用程序中应用有关直接比赛的规则时遇到问题。我已经阅读了这篇文章[，](https://stackoverflow.com/questions/8009379/how-to-output-a-standings-table-on-the-fly-from-a-mysql-table-of-football-socce)它对根据积分标准、差异和进球数创建站立位置表非常有帮助。

但我想知道是否可以通过直接比赛来排序球队位置：

看这个职位表：

```
Pos Team           Pld  W   D   L   F   A   GD  Pts
1   FC Barcelona    5   2   3   0   8   5   3   9
2   **Inter Milan** 6   2   2   2   11  10  1   8
3   *Real Madrid*   6   2   2   2   8   8   0   8
4   AC Milan        5   0   3   2   8   12  -4  3 
```

正如你所看到的，国际米兰和皇家马德里在积分上打成平手，而国际米兰因为净胜球而领先皇家马德里。我想要得到的结果是这样的：

```
Pos Team                Pld  W   D   L   F   A   GD  Pts
    1   FC Barcelona    5   2   3   0   8   5   3   9
    2   **Real Madrid** 6   2   2   2   8   8   0   8
    3   *Inter Milan*   6   2   2   2   11  10  1   8
    4   AC Milan        5   0   3   2   8   12  -4  3 
```

请注意，这次皇家马德里队领先于国际米兰，因为它赢得了他们之间的两场直接比赛。

我有一个团队表和其他结果表。

如果可能的话，我想使用 mysql 中的查询来实现这一点。或者，如果我在服务器端（PHP）进行此排序，可能会更好。

感谢任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T22:49:18.107

不可能在单个查询中**有效地**执行您请求的操作，该查询将返回您要求的结果**并**使用该标准对关系进行排序。

推理很简单：假设您可以在查询中获得一个列，该列将提供或帮助您想要的排序类型。也就是说，它会根据得分并列的球队来排序，根据哪个球队比其他球队获得更多胜利（因为这很可能发生在超过 2 支球队身上）。要手动进行计算，您需要一个复式表，显示这些球队之间赢得的比赛数量，如下所示：

```
 | TeamA | TeamB | TeamC
 ------------------------------
 TeamA |     0 |   XAB |   XAC
 TeamB |   XBA |     0 |   XBC
 TeamC |   XCA |   XCB |     0 
```

因此，您只需将每一列行相加，然后按降序排序即可为您提供所需的数据。

问题是，*在您真正获得数据之前，您不知道哪些球队是平局的*。因此，为一般情况创建该列意味着您需要针对每个团队创建每个团队的整个表（这不是一项小任务）；然后您需要将逻辑添加到查询中，仅将团队的列与与它相关的点相加......您需要原始结果集（您应该使用相同的查询创建无论如何）。

有可能在单个查询中获取该信息，但它肯定对数据库来说太重了。您最好在获取您知道需要的数据之后在代码中添加该逻辑（获取 TeamA 与 TeamB 或 TeamC 的比赛数量并不太复杂）。您仍然需要注意如何构建该查询以及运行多少；毕竟，在联赛的前几场比赛中，您将有很多球队相互捆绑，因此获取数据实际上与构建整个复式表相同，我之前以所有球队对阵所有球队为例团队。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-22T09:39:37.103

在存储过程中创建临时并调用过程...

```
create temporary table tab1 (position int not null auto_increment ,
                      team_name varchar(200),
                      points int,
                      goal_pt int,
                      primary key(position));

insert into tab1(team_name, 
                 points,
                 goal_pt) 
    select team_name,
           points,
           goal_pt 
    from team     
    order by points desc,
             goal_pt desc ; 
```

# javascript - 更好的画布运动模糊

> ID：10693448
> 
> 赞同：8
> 
> 时间：2012-05-21T22:21:55.750
> 
> 标签：javascript, canvas, motion-blur

之前有人[问过](https://stackoverflow.com/questions/5304199/html-canvas-motion-blur-with-transparent-background)，但接受的解决方案对我不起作用（从字面上看，在链接的演示中没有什么对我来说是模糊的），而且它有点涉及两个画布元素。

我目前正在使用“穷人”运动模糊技术，它基本上涉及将源图像一遍又一遍地粘贴到画布上，并在每次迭代后将一个与背景颜色相同的半透明矩形放在顶部。

这是一个演示：http: [//jsfiddle.net/YmABP/](http://jsfiddle.net/YmABP/)

如您所见，它对图像的边缘效果很好，但图像的内部部分最终不会变得模糊，并且对于具有部分透明度的图像看起来很糟糕。

有没有更好的运动模糊技术？理想情况下，我希望能够做类似的事情`context.drawImage`并传递一个不透明度参数，但 AFAIK 不存在这样的东西。某些图像可能托管在第三方域上，因此我无法访问单个像素数据。如果归根结底，我们可以将图像拉到我们的服务器上，然后我可以遍历每个像素并将其绘制为一个半透明的小矩形，但这似乎有点矫枉过正。

有谁知道更好的运动模糊解决方案，最好是我可以与远程图像一起使用的解决方案？

我怀疑这很重要，但就我目前的目的而言，事情只会向上发展。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T22:26:39.100

只需在[`globalAlpha`](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha)重复绘制图像之前设置上下文的属性：

## 演示：http: [//jsfiddle.net/qfEUt/](http://jsfiddle.net/qfEUt/)

```
var img = new Image,
    ctx = document.querySelector('canvas').getContext('2d');
    ctx.globalAlpha = 0.1;

img.onload=function(){
  for (var y=0;y<10;++y) ctx.drawImage(img,0,y);
}
img.src = 'http://phrogz.net/tmp/gkhead-small.png';​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T22:35:47.753

您是否尝试过[EaselJS](http://createjs.com/EaselJS)及其[BlurFilter](http://createjs.com/Docs/EaselJS/classes/BlurFilter.html) - 尝试在一个方向（x 或 y）上更改/动画模糊。

# c# - 从 XML C# 中读取变量

> ID：10693449
> 
> 赞同：0
> 
> 时间：2012-05-21T22:22:05.903
> 
> 标签：c#, xml

根据我之前的一些问题，我整理了以下内容：

```
var xml = "<root><Data><Info>data</Info></Data></root>";

            var xmlString = (from data in XElement.Parse(xml).Descendants("Data")
                             where data.Descendants().Any()
                             select data.Descendants().First().Value).FirstOrDefault();

            var fileString = File.ReadAllText(@"1.txt");

            Console.WriteLine("{0}", fileString == xmlString ? 1 : 0); 
```

上面应该是加载一个xml的**特定部分**，加载一个文本文件，然后比较两者。对我来说不幸的是，我是 C# 及其一些概念的新手，并且不确定如何`var xml = "<root><Data><Seperator>data</Seperator></Data></root>";`从同一目录中的特定 xml 文件进行读取。

我知道我可以使用：

```
 FileStream stream = new FileStream("1234.xml", FileMode.Open);
XmlReader reader = new XmlTextReader(stream);
while(reader.Read())
{
  Console.WriteLine(reader.Value);
} 
```

如果我有 1234.xml 并想将其输出到控制台，但我不知道如何以定义的变量 xml 能够读取它的方式加载文件的内容。

编辑：

根据下面的帖子，我尝试使用以下内容，但它在控制台中返回空白：

```
 using(XmlReader reader = XmlReader.Create("2.xml"))
     {
          while (reader.Read())
          {
               if (reader.NodeType == XmlNodeType.Element)
               {
                    if (reader.Name.ToLower() == "data")
                    {
                        string xml = reader.ReadOuterXml();

                        var xmlString = (from data in XDocument.Parse(xml).Elements()
                                                 select data.Elements().First().Value).FirstOrDefault();

                         xmlString = xmlString.Replace("\n", "").Trim();

                        var fileString = File.ReadAllText(@"8.txt");
    Console.WriteLine("{0}", fileString == xmlString ? 1 : 0);
                     }
                }
           }

  } 
```

编辑2：

XML 文件是一个哈希值和一个签名（我只是想抓取和比较哈希及其值）：

```
<?xml version="1.0"?>
-<root>-<Data><Info>Hash: xxxxxxxxxxxxxxxxxxxxxxxxxxx</Info></Data>-<Signature xmlns="http://www.w3.org/2000/09/xmldsig#">-<SignedInfo><CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/><SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>-<Reference URI="">-<Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/></Transforms><DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/><DigestValue>GHOSJRUqcHnZ3M090/5/KhvghyQ=</DigestValue></Reference></SignedInfo><SignatureValue>oib+LAXqJshDFm3YM63qkSsJxxF+t0uahGax8tLrjSPJUjW045iYvB4LJCgMeF9oxatbWnVB9hGbvtVnl4iewJDL3kjnjvot5CLozMOaIGJgdys5MP8ncx771itANTm8wi8KgnqVjGjvTakEmcdwcSdRXuCP1WGOwuXm5StkY8Q=</SignatureValue></Signature></root> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:26:38.850

如果您只想使用文件内容填充字符串变量，请尝试

```
var xml = File.ReadAllText("1234.xml"); 
```

（与“1.txt”相同）

确保你是

```
using System.IO; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:26:58.663

您可以使用 XDocument 或 XElement 加载文件并`Load`对其进行 ing：

例如：

```
XDocument doc = XDocument.Load("1234.xml"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T00:09:34.997

不完全确定您的要求是什么；但根据您的问题和评论，您似乎有一个 xml 文档，例如

```
<?xml version="1.0" encoding="utf-8"?>
<root>
  <Data>
   <Info>
    data
   </Info>
  </Data>
  <Data>
   <Seperator>
    other data
   </Seperator>
  </Data>
</root> 
```

您想从`<Data></Data>`标签中的第一个元素中读取值（子元素名称可能会有所不同，例如在示例中它可以是`<Info></Info>`或`<Seperator></Seperator>`

这是解决方案（将获得值' `data`'，' `other data`'）

```
 using(XmlReader reader = XmlReader.Create("1234.xml"))
 {
      while (reader.Read())
      {
           if (reader.NodeType == XmlNodeType.Element)
           {
                if (reader.Name.ToLower() == "data")
                {
                    string xml = reader.ReadOuterXml();

                    var xmlString = (from data in XDocument.Parse(xml).Elements()
                                             select data.Elements().First().Value).FirstOrDefault();

                     xmlString = xmlString.Replace("\n", "").Trim();

                     // Your other operations
                 }
            }
       }
  } 
```

**编辑**

您的 xml 数据格式不正确（元素前有不需要的连字符 (-)）。如果格式正确，我的代码正在运行。您的 xml 文件应如下所示。

```
<?xml version="1.0"?>
<root>
 <Data>
  <Info>Hash: xxxxxxxxxxxxxxxxxxxxxxxxxxx</Info>
 </Data>
 <Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
  <SignedInfo>
    <CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
    <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
    <Reference URI="">
      <Transforms>
         <Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
       </Transforms>
       <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
       <DigestValue>GHOSJRUqcHnZ3M090/5/KhvghyQ=</DigestValue>
     </Reference>
   </SignedInfo>
  <SignatureValue>oib+LAXqJshDFm3YM63qkSsJxxF+t0uahGax8tLrjSPJUjW045iYvB4LJCgMeF9oxatbWnVB9hGbvtVnl4iewJDL3kjnjvot5CLozMOaIGJgdys5MP8ncx771itANTm8wi8KgnqVjGjvTakEmcdwcSdRXuCP1WGOwuXm5StkY8Q=</SignatureValue>
</Signature>
</root> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T02:44:13.920

要从与可执行文件相同的目录加载文件，请尝试以下操作：

```
string path = Path.Combine(
    Path.GetDirectoryName(Environment.GetCommandLineArgs()[0]), 
    "1234.xml");

XElement xml = XElement.Load(path); 
```

如果你关心你可以使用这个库来获取哈希值：[https](https://github.com/ChuckSavage/XmlLib/) ://github.com/ChuckSavage/XmlLib/喜欢：

```
string result = xml.XPathElement("//Data[*]").Descendants().First().Value; 
```

这`//Data[*]`意味着具有任何子节点的后代数据节点，您在方程式中拥有这些节点。

但是，如果您知道您的数据将位于 Data/Info 节点中（仍在使用该库）：

```
string info = xml.Get("Data/Info", string.Empty); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-25T05:39:58.603

试试下面的代码.......

您必须使用名为 Persons.xml 的 XML 文件.....

```
 <?xml version="1.0" encoding="utf-8"?>
    <Persons>
      <Person>
        <Name>abcd</Name>
        <City>Kolkata</City>
        <Sex>Female</Sex>
      </Person>
    </Persons> 
```

现在要向此 XML 文件添加数据，您必须创建一个表单，其中您可以有三个字段名称、城市和性别字段以及相应的文本框和两个按钮来**将**数据添加到 XML 文件和**读取**以从该 XML 文件中读取数据.

现在双击**添加**按钮并编写以下代码...

```
 protected void butAdd_Click(object sender, EventArgs e)
    {
        try
        {
            if (txtName.Text == "" || txtCity.Text == "" || txtSex.Text == "")
            {
                lblStatus.Text = "Please complete the form.";
            }
            else
            {
                XDocument xmlDoc = XDocument.Load(Server.MapPath("Persons.xml"));

                xmlDoc.Element("Persons").Add(new XElement("Person", new XElement("Name", txtName.Text),
                new XElement("City", txtCity.Text), new XElement("Sex", txtSex.Text)));
                lblStatus.Text = "Data successfully added to XML file.";
                xmlDoc.Save(Server.MapPath("Persons.xml"));

            }
         }
        catch
            { 
                lblStatus.Text = "Sorry, unable to process request. Please try again.";
            }
      } 
```

再次双击读取按钮并编写以下代码以读取数据....

```
 protected void butRead_Click(object sender, EventArgs e)
    {
        XDocument xmlDoc = XDocument.Load(Server.MapPath("Persons.xml"));

        var persons = from person in xmlDoc.Descendants("Person")
                      select new
                      {
                          Name = person.Element("Name").Value,
                          City = person.Element("City").Value,
                          Sex = person.Element("Sex").Value,
                      };

        litResults.Text = "";
        foreach (var person in persons)
        {
            litResults.Text = litResults.Text + "Name: " + person.Name + "<br />";
            litResults.Text = litResults.Text + "City: " + person.City + "<br />";
            litResults.Text = litResults.Text + "Sex: " + person.Sex + "<br /><br />";
        }

        if (litResults.Text == "")
            litResults.Text = "No Results.";
    } 
```

# html - 如何在缩放期间停止 HTML/CSS 中的分区重叠

> ID：10693450
> 
> 赞同：0
> 
> 时间：2012-05-21T22:22:05.747
> 
> 标签：html, css

我需要在浏览器的各个部分放置具有类 ID 的表。我的问题发生在缩小时。分区开始重叠。有没有办法让它除了让它们分开更远之外它们不会重叠（这样当我放大它们时它们会靠得很近）。

这是CSS的示例代码：

那么除了我可以使用之外，还有什么其他东西`position:absolute`可以使用，或者除此之外还有什么东西会有所作为？

```
#UB_37{
 position:absolute; 
 top: 144px;
 left: 646px;
 width:32px;
 height:252px;
transform:rotate(0deg);
 -ms-transform:rotate(0deg); /* IE 9 */
 -moz-transform:rotate(0deg); /* Firefox */
 -webkit-transform:rotate(0deg); /* Safari and Chrome */
 -o-transform:rotate(0deg); /* Opera */
} 
```

# java - 服务器和 iPhone / Android 客户端上的号码生成验证

> ID：10693457
> 
> 赞同：0
> 
> 时间：2012-05-21T22:23:14.920
> 
> 标签：java, android, iphone, security

问题：在不涉及要求的情况下，我在 iPhone 和 Android 上有客户端应用程序，它们需要生成一个数字（理想情况下为 4 位），然后该数字与服务器上基于相同输入生成的数字相匹配，例如 PIN 和生成的数字需要静止一天（从早上 6 点开始）

因此，运行应用程序的 iPhone 客户端将根据 PIN 1245677 生成一个数字 3456，而服务器将在凌晨 5 点根据相同的 PIN 生成相同的数字

早上 6 点，生成的数字需要更改

我很欣赏这似乎是一个奇怪的问题，但需要根据要求将其构建到我的应用程序中（主要是设备需要在没有任何网络连接的情况下运行）

服务器将使用 Java 和 iPhone 和 Android 客户端

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:34:47.927

您必须使用确定性的种子生成数字。您可以将日期 a long 与分配给客户端的任意 ID 一起使用，然后生成一个散列来表示您需要的数字。

# objective-c - 表格视图中的完整文件列表

> ID：10693460
> 
> 赞同：0
> 
> 时间：2012-05-21T22:23:27.867
> 
> 标签：objective-c, ios, uitableview

**情况**：我正在尝试在 UITableView 中显示我的应用程序文档目录 (iOS) 中的文件列表。

**问题**：当视图加载时，而不是列出所有文件，它只列出一个文件（第一个按字母顺序排列）

**代码**：

```
cell.textLabel.text = [NSString  stringWithFormat:@"Cell Row #%d", [indexPath row]];
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSPredicate *filter = [NSPredicate predicateWithFormat:@"self ENDSWITH '.txt'"];
NSArray *fileListAct = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:documentsDirectory error:nil];
NSArray *FileList = [fileListAct filteredArrayUsingPredicate:filter];
cell.textLabel.text = [NSString stringWithFormat:@"%@",[FileList objectAtIndex:indexPath.row]];
NSLog(@"File List: %@", FileList); 
```

所有代码都按其应有的方式执行，甚至最后的 NSLog 行也列出了所有文件名，但由于某种原因，在 UiTableView 中它只列出了第一个文件名。

**更多信息**：我尝试`do`为最后`cell.textlabel.text`一行创建一个循环，但这也需要一个`while`语句（我想不出条件是什么）。

**关于如何使 UITableView 显示所有文件名而不是第一个文件名的任何想法？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:33:41.823

您需要为 fileList 设置一个全局 NSArray。您需要在其中一个`viewDidLoad`或`viewWillAppear:`

## 例子

这是一个粗略的例子，我会怎么做，虽然它还没有经过测试，但它应该可以工作。

```
@interface MyViewController () {
    NSMutableArray *FileList;
}
@end

@implementation MyViewController

- (void)viewDidLoad:(BOOL)animated
{ 
    [super viewDidLoad];

    FileList = [[NSMutableArray alloc] init];
}

/*  Setup the array here  */
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSPredicate *filter = [NSPredicate predicateWithFormat:@"self ENDSWITH '.txt'"];
    NSArray *fileListAct = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:documentsDirectory error:nil];

    FileList = [fileListAct filteredArrayUsingPredicate:filter];
}

/* Set the number of cells based on the number of entries in your array  */
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return [FileList count];
    /*  this is probably what you are missing and is definitely 
        the reason you are only seeing 1 cell.  */
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
{
    cell.textLabel.text = [NSString stringWithFormat:@"%@",[FileList objectAtIndex:indexPath.row]];
}

@end 
```

# knockout.js - 关于使用 Knockout、Upshot 和 Entity Framework 4.3 的架构最佳实践的问题

> ID：10693461
> 
> 赞同：2
> 
> 时间：2012-05-21T22:23:29.320
> 
> 标签：knockout.js, asp.net-web-api, knockout-2.0, upshot

**问题**

使用 Knockout 2.0.1、Upshot.js 和 Entity Framework 4.3 构建应用程序的最佳实践是什么？

**技术栈**

我们的技术堆栈目前看起来像：

• SQL Server 2008 R2 • ASP.NET MVC3（使用 C#）和 Entity Framework 4.3（使用 Code-First） • jQuery 1.7.2 • jQuery-UI 1.8.2 • Knockout 2.0.1 • Upshot.js beta

背景（许多其他开发人员可能会在这里用他们自己的项目代替我们的项目。）

我们正在开发一个新的 Web 应用程序，其中用户体验非常重要。该应用程序涉及许多密切相关的实体。出于各种原因，非常希望将这些实体中的许多或大部分驻留在相同的一般视觉上下文中（并且很可能在同一个“页面”上）。此外，一些页面元素需要与服务器频繁通信。

虽然我们最初打算将 ASP.NET MVC4 用于我们的表示层，但我们很快决定这可能不是最好的方法。在努力让 MVC 做我们想做的事情之后，我们基本上得出结论，我们最好的方法是将几乎所有 UI 逻辑移动到客户端，然后将 JSON 数据来回传递给服务器。单页应用程序似乎非常适合我们客户的需求。

我们一直在评估 Knockout，但由于映射由我们的 ASP.NET MVC 控制器（使用 JSON 操作方法）公开的实体（在 JavaScript 中）所需的工作量，我们并未完全“出售”它。如果有超过 100 个不同的实体，这种手动映射会非常痛苦！

在看到来自 TechDays 荷兰 (http://channel9.msdn.com/Events/TechDays/Techdays-2012-the-Netherlands/2159) 的 Steve Sanderson 关于“单页应用程序”的精彩演示后，我们认为圣诞节来得太早了。Knockout + Upshot 似乎是完美的解决方案。我们没有花任何合理的时间思考问题，就立即通知客户我们将对我们的 UI 工具集进行一些调整。

当我们开始深入研究伴随任何实际应用程序的更微妙的架构问题时，我们意识到几乎没有例子，关于实现方法和最佳实践的想法甚至更少

我们整理了一些棘手的建筑问题，希望得到答案。我们非常感谢您提供的任何想法或解决方案。

**在 upshot 和 .NET 之间进行通信的最佳机制是什么？**

根据 Denver Developer 在其题为“深入了解 Upshot.js”的博文 (http://denverdeveloper.wordpress.com/2012/03/07/digging-into-upshot-js/) 中，共有三个数据提供者由Upshot.js。这些都是：

• “默认是DataProvider() 并使用/Submit 方法和您提供的操作来使用jQuery 的$.ajax 方法获取数据。• 下一个是 riaDataProvider() – 与第一个类似，但它使用 /json/SubmitChanges 方法和 /json/{your opertion} 来获取数据 • 最后我们还有 odataDataProvider() – 这个完全不同，因为它确实目前不支持更新数据——它是只读的。”</p>

哪个数据提供者更好——默认数据提供者还是 RIA 数据提供者？推荐哪一个？

**应该如何配置控制器来管理传入和传出数据？**

我们的理解是 WebAPI 控制器只能有一个“Get”方法。如果我们可能有几百个不同的查询（不包括过滤器变体）将针对服务器执行，这是否意味着我们将需要 200 个不同的控制器类？如果是这样，这是否支持使用结果的 riaDataProvider() 以外的数据提供程序？

**如何访问和绑定可供 Upshot 使用的元数据？**

Upshot 的一个假定好处是它能够查询通过数据注释公开的元数据。（至少这是我们目前的理解。）如何访问字符串长度、默认值、显示名称、描述信息以及是否需要字段的实体属性的元数据？

**哪个客户端验证库应该与 Knockout 和 Upshot 一起使用？**

假设，使用标准 jQuery 验证需要在所有表单输入字段上绑定“uniqueName”。似乎不鼓励使用 jQuery 验证。Knockout 插件页面 (https://github.com/SteveSanderson/knockout/wiki/Plugins) 列出了两个验证插件——“Knockout.Validation”和“Knock-Knock Validation”。对于一般用途，推荐使用什么工具或插件使用 Knockout 进行验证？

**Upshot 如何处理在层次结构中创建和更新对象？**

当结果将数据写回服务器时，它会自动处理同时添加父母和他们的孩子，就像在实体框架中已经可以完成的那样吗？我们假设答案是肯定的，但这不是我们尚未测试过的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T04:05:16.467

正如建议的那样，我将这篇文章分成几个较小的问题。

# php - Facebook PHP SDK getUser() 在 Windows 上的 Safari 中返回 0

> ID：10693463
> 
> 赞同：1
> 
> 时间：2012-05-21T22:23:51.707
> 
> 标签：php, javascript, jquery, ajax, facebook

我正在开发 Facebook iframe 应用程序。我同时使用 PHP SDK 和 JS SDK。在我的索引文件中，我调用 PHP SDK 以获取有关用户的一些信息。这包括 getUser() 函数，该函数始终在索引中工作。

但是，我还有许多其他 PHP 文件，当用户单击某些链接时，我使用它们来填充索引中的 div。我在每个文件中都使用了 FB PHP SDK，以确保用户仍然登录到 FB。也就是说，当执行这些文件时，我调用 getUser() 函数来获取用户的 ID 并确定该人是否仍然登录。我通过 jQuery 的 load() 函数将这些 PHP 文件的内容注入索引中的 div .

这在 FFox、Opera、IE 和 Chrome 下工作得很好，但在 Safari 的某些安装下却不行。具体来说，我遇到了 5.1.5 (7534.55.3) 的重大问题。在此版本的 Safari 下，当 jQuery 加载函数调用 PHP 文件时，getUser() 函数似乎总是返回 0（零）。我假设这与会话 cookie 有关？我真的不知道，希望这里有人可以为我解释一下。谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T21:40:14.017

您可以将其添加到您的网站：

```
<?php
$uid = $facebook->getUser();

if ($uid==0) {

    $params = array(
      'scope' => 'read_stream, friends_likes',
      'redirect_uri' => 'https://www.myapp.com/post_login_page'
    );

    $loginUrl = $facebook->getLoginUrl($params);
    echo '<a href="'.$loginUrl.'">You need first to Login</a>';
    exit();

} else {

     //Continue your site code

} 

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-06T04:17:33.513

不确定这是否是一个问题，但它在一段时间内影响了我的 Safari FB 应用程序开发。查看此 SA 答案以修复它，我几乎完全遵循它并且它有效。[Safari 5.1.5 中 iframe 上缺少 cookie](https://stackoverflow.com/questions/10192142/missing-cookies-on-iframe-in-safari-5-1-5)

# php - 运行 CRON 脚本时缺少 _SESSION 变量

> ID：10693464
> 
> 赞同：1
> 
> 时间：2012-05-21T22:23:52.443
> 
> 标签：php, cron, session-variables

我有一个检查 _SESSION 变量的 PHP 脚本（在创建会话时，我设置了以下 var **$_SESSION['LAST_ACTIVITY']=time()**）。

该脚本可以访问相关的会话 ID。它设置会话 ID、启动会话并检查变量。

当我手动运行脚本时，它可以完美运行。它启动先前启动的会话并检索 _SESSION 变量。

但是，当相同的脚本通过 CRON 运行时，_SESSION 变量没有设置......

知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:32:57.053

当您调用时`session_start()`，php 在 $_COOKIE 中查找会话 ID，有时在 $_REQUEST 中查找。这些在命令行版本中不存在，因为没有网络服务器。

您可以通过手动指定会话 ID`session_start($id);`

确保`session.save_path`网络服务器和命令行 php 版本之间的设置相同。它们可以不同。在两个版本上通过 phpinfo() 检查。

# c# - c# 使用目录类进行搜索

> ID：10693466
> 
> 赞同：3
> 
> 时间：2012-05-21T22:24:27.510
> 
> 标签：c#, directory

我正在编写一个软件工具，作为其主要任务的一部分，它必须在目录及其子目录中搜索具有给定名称的目录，并将每个以指定目录名称结尾的文件路径保存到字符串数组中。例如：

```
                   级别_1 级别_2 级别_3
RootDirectory ---> 文件夹A ---> 文件夹D ---> 文件夹F ---> 目标
             | |---> 文件夹E ---> 目标
             |            
             |---> 文件夹B ---> 目标
             |
             |---> 文件夹C ---> 目标

```

应该抽出：

```
string[] = {RootDirectory\folderA\FolderD\folderF\Target,  
    RootDirectory\folderA\folderE\Target, 
    Rootdirectory\folderB\Target, 
    RootDirectory\foderC\Target} 
```

最初我`getDirectories(myPath, "Target", SearchOption.AllDirectories)`在目录信息对象上使用，但出现了问题。出于某种原因，它会在文件夹 b 和 c 下以及文件夹 A>folderD>folderF 下找到目标，但会跳过 FolderE。一旦它在子目录文件夹 A 中找到第一个匹配项，它将继续到 level_1 的下一个文件夹。我应该提到，在我的真实案例中，folderD 实际上是按字母顺序排列在 folderE 之前的，就像在这个例子中一样

因此，我决定使用`IEnumerator`并运行 where 过滤器来选择以给定目录名称终止的文件。这让他们都找到了。但是，我无法弄清楚如何`getDirectories().Where(x=>(x.attributes & fileattributes.hidden)==0);`在`IEnumerator`.

问题是，我需要它跳过隐藏的 SVN 目录，因为它大大减慢了进程。

所以这是我的问题：如何获取子目录中以给定目录名称结尾的所有路径的集合，并从搜索中排除隐藏文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:38:27.940

我在我的根目录中创建了您的文件夹结构，`C:\`并使用 Linqpad 提出了以下代码。

```
string root = "c:\\folderA";
string target = "Target";   
var d = new DirectoryInfo(root);
var x = d.EnumerateDirectories(target, SearchOption.AllDirectories);
x.ToList() // for each element, it's in the the FullName 
```

唯一缺少的部分是忽略`.svn`文件夹

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:17:00.743

我认为您将不得不编写自己的实现。如果您使用的是 .net 4.0，则可以使用[EnumerateDirectories](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.enumeratedirectories.aspx)

并做这样的事情：

```
private IEnumerable<DirectoryInfo> EnumerateDirectories(DirectoryInfo dir, string target)
{
    foreach (var di in dir.EnumerateDirectories("*",SearchOption.TopDirectoryOnly))
    {
        if ((di.Attributes & FileAttributes.Hidden) != FileAttributes.Hidden)
        {
            if (di.Name.EndsWith(target, StringComparison.OrdinalIgnoreCase))
            {
                 yield return di;
                 continue;
            }
            foreach (var subDir in EnumerateDirectories(di, target))
            {
                yield return subDir;
            }
        }
    }
} 
```

然后：

```
DirectoryInfo dir = new DirectoryInfo(@"C:\RootDirectory");
var found = EnumerateDirectories(dir,"target").ToArray(); 
```

这样，一旦你找到一个“目标”，或者遇到一个隐藏目录，你就停止浏览子目录。

# .net - 意外的“无效的电子邮件地址格式”

> ID：10693467
> 
> 赞同：0
> 
> 时间：2012-05-21T22:24:27.570
> 
> 标签：.net, email-validation, mailmessage

我有以下代码行来向`MailMessage`实例添加一个收件人地址。（字符串中的 X 代表字母字符的占位符，以防止识别客户。）

```
message.To.Add("Xxxxxxxxx Xxxxxx Xxxxxxxxxx, Xxx. <xxxxxx@xxxxxxxxx-xx.com>"); 
```

我收到以下错误：

> 指定的字符串不是电子邮件地址所需的格式

`message`是类型`System.Net.Mail.MailMessage`。我的理解是这种格式被接受了。而且，事实上，代码一直在使用其他地址。名称中的逗号或句点是否可能破坏格式？

**编辑**

因此，到目前为止，这就是我以正确格式构建电子邮件地址的内容。

```
// Construct a compound email address string
public static string BuildEmailAddress(string name, string emailAddress)
{
    if (String.IsNullOrWhiteSpace(name))
        return emailAddress;
    name = Regex.Replace(name, @"[()<>\[\]:;@\\,.""]",
        m => string.Format(@"\{0}", m.Value));
    return String.Format("\"{0}\" <{1}>", name, emailAddress);
} 
```

这其中的要素仍不清楚。例如，如果 Yahoo 遇到逗号，它只是将名称用双引号括起来，而不用反斜杠。如果有人可以说出何时需要引号以及何时需要反斜杠，我会欢迎任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:36:03.380

我相信逗号是不允许的，因为它在技术上是 RFC 822/2822 中的列表分隔符。至少，我是这么读的。

# javascript - 减慢 ajax 调用/xhr 请求的最佳方法

> ID：10693475
> 
> 赞同：1
> 
> 时间：2012-05-21T22:25:22.203
> 
> 标签：javascript, ajax

不确定我的问题是否正确，但我有下面的代码。基本上想发出一个ajax请求，检查回调，然后重新执行ajax，直到它得到所需的响应（在示例中connectedvoter == 1）。

问题是它只需要大约 80 毫秒，而且 xhr 的数量以这种速度非常快。我试图想出一种“暂停”的方法，但我能想到的一切都占用了 cpu。

有没有办法“减慢”请求的数量，说一两秒一次而不吃掉cpu？

```
var connctedvoter = 0;
var govoters = function () {
        $.ajaxSetup({
            async: false
        });
        var url = "getconnectedvoter.php";
        var data = {
            userid: userid
        };
        $.getJSON(url, data, callback);
    };
var pausevoters = function () {
        console.log("pausing ajax voters");
    };
var callback = function (response) {
        if (response.error) {
            return;
        }
        if (response.connectedvoter == 0) {
            setTimeout(govoters, 150);
            //govoters();
        } else {
            $('#vanid').html(response.vanid);
            $('#name').html(response.name);
            $("#mapurl").attr("src", response.mapurl);
            $('.call').fadeIn();
            return;
        }
    };
//DO THIS TO START
setTimeout(govoters, 150);
pausevoters(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:28:11.957

只是增加超时的延迟：

```
if(!response.connectedvoter) {
  setTimeout(govoters, 2000); // instead of 150
} 
```

而不是一秒钟的 10 个请求：

```
setTimeout(govoters, 150); // one request every 150 millisecond. 
```

* * *

请注意，您可以从以下位置更改：

```
//DO THIS TO START
setTimeout(govoters, 150); 
```

对此：

```
//DO THIS TO START
govoters(); 
```

这里真的不需要超时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:31:57.183

只需使用以下代码更改行：

```
setTimeout(govoters, 150); 
```

和：

```
setTimeout(govoters, 1000); // 1 second 
```

# php - 我使用 readfile('php://input') 通过 curl 帖子接收 xml，但标题是 content-disposition:form-data，我可以更改它吗？

> ID：10693477
> 
> 赞同：0
> 
> 时间：2012-05-21T22:25:31.440
> 
> 标签：php, xml

因为接收到的字符串中有很多乱码，我不能将它用作 xml。有什么想法吗？

```
$login_xml ='<xml>'.
            '<action>log_in</action>'.
            '<parameters>'.
            '<username>'.$var.'</username>'.
            '<pass>abdef01</pass>'.
            '</parameters>'.
            '</xml>';

$ch = curl_init($URL);      
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: text/xml'));
curl_setopt($ch, CURLOPT_POSTFIELDS, $login_xml);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST,'POST');
$output = curl_exec($ch); 
```

也许 CURLOPT_HTTPHEEADER 中有一些选项？谢谢你的时间！

编辑：

```
 var_dump($output) : string '<xml><action>log_in</action><parameters><username>Ionel P</username><pass>abdef01</pass></parameters></xml>107' (length=110) 
```

编辑2：

```
<?php
$xml = readfile('php://input');//file_get_contents('php://input');
var_dump($xml);
print_R($xml);
?>
var_dump($xml) = pre class='xdebug-var-dump' dir='ltr'><small>int</small> <font color='#4e9a06'>107</font> 
```

107'（长度=207）

# javascript - Application.js 在部分内部不起作用

> ID：10693478
> 
> 赞同：0
> 
> 时间：2012-05-21T22:25:33.077
> 
> 标签：javascript, ajax, ruby-on-rails-3.1, partial

我有一个经典方案 - 在**application.js**中包含所有需要的 JS 例程，并且在应用程序中运行良好。

然后我有一个 AJAX 链接（remote="true"） - 单击此链接后称为相应的部分（可以说**_display_popup.html.haml** - 此弹出窗口由**display_popup.js**打开）。这也很好。

问题来了——在这个打开的弹出窗口中不包括来自**application.js**的 JS 例程。我整天都在努力解决这个问题，但我仍然找不到原因......

谁能给我任何建议，问题是什么以及如何解决？

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:52:10.957

看看[http://api.jquery.com/live/](http://api.jquery.com/live/)

我在加载 ajax 的部分中无法使用 js 时遇到问题。我刚刚添加了 .live 以附加到加载文档后添加的元素。

```
$('input:radio').click(function () { });  // Doesn't work with partials loaded remotely

$('input:radio').live("click",(function () { }); // works fine 
```

# tcp - 如果数据包的大小不能超过 1500 字节，文件传输怎么能这么快？

> ID：10693480
> 
> 赞同：1
> 
> 时间：2012-05-21T22:26:09.520
> 
> 标签：tcp, ip

从网站下载文件时，可以达到每秒数兆字节的速度。如果 TCP 需要拆分并单独发送超过 1500 字节的数据包，那么这些速度如何实现？客户端是否不必等待每个 1500 字节的片段，这应该需要一段时间？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T22:30:29.877

> 客户端是否不必等待每个 1500 字节的片段，这应该需要一段时间

不，这就是 的魔力`TCP`，你不必`ACK`每个片段，你可以`ACK`偶尔。在客户端肯定必须至少确认一些之前，服务器可以推送很多段。

TCP 使用一个称为“窗口”的概念。发送者可以将数据推送到窗口中，从而使其缩小。接收方确认数据，导致窗口扩大。如果接收方不确认数据，传输就会停止。

在现代 TCP 中，知道何时确认数据是协议的要点。过于频繁或不够频繁都会对性能产生巨大影响。

# javascript - 如何在 JavaScript 中运行随机选择的函数？

> ID：10693488
> 
> 赞同：8
> 
> 时间：2012-05-21T22:27:09.320
> 
> 标签：javascript, jquery

我正在尝试运行一个随机函数，但还没有完全弄清楚：

```
<script>

function randomFrom(array) {return array[Math.floor(Math.random() * array.length)];}

function randomchords(){randomFrom(['poop()', 'poop2()', 'poop3()']);}               

function poop() { $(function() {ionian_c_vi() });  }                          

function poop2() {  $(function() {ionian_c_iii() }), $(function() {ionian_c_iv() });  }                      

function poop3() { $(function() {ionian_c_vi() }), $(function() {ionian_c_i() }), $(function() {ionian_c_ii() });  }  

</script> 
```

进而：

```
<button onclick="randomchords()" >Get some random chords</button> 
```

我在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T22:30:00.113

一种选择是使用`window`对象：

```
function randomchords() {
    var func = randomFrom(['poop', 'poop2', 'poop3']);
    window[func]();
} 
```

请注意，您应该从数组中的函数名称中删除括号。

* * *

另一种选择是从上面的变体中删除引号并直接调用函数：

```
function randomchords() {
    var func = randomFrom([poop, poop2, poop3]);
    (func)();
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-21T22:35:12.823

函数就像值。你可以说：

```
var myArray = [
    function(){
        ionian_c_vi();
    },
    function(){
        ionian_c_iii();
        ionian_c_iv()
    },
    function(){
        ionian_c_vi();
        ionian_c_i();
    }
];
function randomchords(){ 
     randomFrom(myArray).call();
} 
```

有关更多信息，请查看[http://www.yuiblog.com/blog/2010/02/24/video-crockonjs-3/](http://www.yuiblog.com/blog/2010/02/24/video-crockonjs-3/)和/或阅读[https://developer.mozilla.org/en/JavaScript/Reference /Global_Objects/函数/调用](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/Call)

Bookwise，阅读 Javascript：好的部分（120 页）

帮助在 jQuery 之外学习 JS :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T22:36:05.693

你很接近：

```
function foo() { ... }
function bar() { ... }
function baz() { ... } 
```

这些函数被定义为全局范围，通常`window`在浏览器中。例如，您可以通过调用字符串来访问它们`window['foo']`。这将返回`foo`函数本身（而不是执行的值）。

```
function randomFrom(array) {
  return array[Math.floor(Math.random() * array.length)];
}

function randomchords() {
  // add the 'window' prefix here
  randomFrom(window['foo', 'bar', 'baz'])();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T22:33:08.390

您可以通过多种方式执行此操作：

但我认为最简单的方法是生成一个随机数，并用 case 调用函数:)

```
$("button").click(function)
{
    var n = Math.floor(Math.random()*11);
    switch(n)
    {
        case: 0:
        Function0();
        break;

        case: 1:
        Function1();
        break;

        case: 2:
        Function2();
        break;

        ...

        case: 10:
        Function10();
        break;
} 
```

使用 btn 你可以调用

```
<button>Get some random chords</button> 
```

# php - PHP将字符串矩阵转换为多维数组

> ID：10693490
> 
> 赞同：2
> 
> 时间：2012-05-21T22:27:48.973
> 
> 标签：php, arrays, matrix

假设我的`string`格式如下：

```
293545
974256
947276 
```

我想将其转换为`PHP`二维数组，其中换行符是单独的行，数字值`(single character)`是数组中的每个元素。`most efficient`假设字符串可能增长到 500x500，那么执行此操作的方法是什么。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T22:40:47.143

我不确定效率，但以下内容简单易读。

```
function matrix_to_array($matrix) {
  $matrix = explode("\n", $matrix);
  $matrix = array_map("str_split", $matrix);
  return $matrix;
} 
```

如果上述（或任何其他 PHP 实现）太慢，将计算繁重的算法外包给外部 C（或其他低级编译语言）程序通常是一个好主意。

# c# - 如何设计一个全屏应用C#？

> ID：10693494
> 
> 赞同：2
> 
> 时间：2012-05-21T22:28:09.160
> 
> 标签：c#, .net, controls

> **可能重复：**
> [用 C# 设计全屏应用程序的最佳方法是什么？](https://stackoverflow.com/questions/10687693/whats-the-best-way-to-design-a-full-screen-application-in-c)

您可能知道全屏表单不适合 IDE。所以，我只是想知道如何在该表单上放置控件。

像这样的东西：

```
 picturebox1.Location = Screen.PrimaryScreen.Bounds.Width - 50(margin). 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T22:31:15.510

将您的图片框放在相对于顶部和左侧边框的正确位置，然后确保您有

```
picturebox1.Anchor = AnchorStyles.Top | AnchorStyles.Right; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:35:35.873

使用 yhour 子控件的 Anchor/Dock 属性，并在设计器中，使用鼠标调整表单的大小来拉伸/收缩它 - 并确保一切都保持在您想要的位置！

# flash - 使用哪些工具来录制演示文稿的屏幕？

> ID：10693498
> 
> 赞同：1
> 
> 时间：2012-05-21T22:28:40.097
> 
> 标签：flash, demo

在接下来的几天里我有一个演讲，这是我最后一年的计算机工程项目......

我必须展示我的工作演示，所以我想知道从我的计算机（使用自动缩放等）录制演示的最佳工具是什么，而且对于 flash，我想用 flash 做一个很好的演示，我能用什么？

欢迎任何建议。

谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T01:16:02.197

A quick way is to use the record software, recommand the Camtasia, which was simple, easy to use.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-26T19:53:48.643

Camtasia 非常受欢迎，但当今市场上还有许多其他解决方案，如[PresentationTube](http://presentationtube.com/)、[Prezi](http://prezi.com/)和[PowToon](http://www.powtoon.com/)。 例如，[PresentationTube提供了一个视频演示记录器和视频共享平台，以帮助演示者以一种新的方式录制和共享高质量的视频演示。](http://presentationtube.com/)视频演示记录器允许演示者讲述和注释 PowerPoint 幻灯片，并同步各种基本的视觉辅助工具，包括网络摄像头流、白板、绘图板、Web 浏览器内容和桌面录制。

# java - 这是多态吗？

> ID：10693500
> 
> 赞同：1
> 
> 时间：2012-05-21T22:28:55.060
> 
> 标签：java, polymorphism

我最近参加了一次采访，在那次采访中我意识到我的编程概念并不像我想象的那么具体。

有人问我，描述一下您在以前的工作中使用多态性的时间吗？

经过一番思考，我说我们有一个记录类，每条新记录都会扩展。因此，如果我们有 AddRecord 或 RemoveRecord 或任何其他类型的记录，它们将扩展 Record。记录界面看起来像这样：

```
public abstract Record{
  public writeLine(String line);
  public getColumn(int column);
  public setHeader(String header);
  ...
}

public AddRecord extends Record{
  public writeLine(String line){
      // do something
  }

  // etc...
}

public MakeRecord{
   Record r;
   public setRecord(Object s){
      if(s instanceof Record){
          r = s;
      }
   } 

   public void printNewRecord(){
      while(thingsToWrite){
          r.writeLine(something);
      }
   }
} 
```

我只是简写了它，所以请不要挑它。

我告诉他们这是使用多态性，因为无论记录类型如何，都可以在不知道它是什么类型的记录的情况下编写它。这很有价值，因为我们正在编写需要正确填充的文件，无论是零填充还是用空格填充等......

如果这不是多态性，请告诉我如何将我的示例更改为使用多态性的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:35:12.293

长答案简短：是的，根据韦伯斯特的说法，多态性是：a (1)：物种以多种形式存在，与性别的变化无关 (2)：基因以多种等位基因形式存在 (3)：分子的存在（作为一种酶）在一个物种中以多种形式存在 b ：以两种或多种具有不同结构的形式结晶的特性

我们专注于定义a。这在 Java 术语中描述为使用 1 个“顶级”类来引用两个“底部”类。据我所知，如上例所示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T09:50:28.037

一个非常基本的多态性示例：

```
import java.util.ArrayList;

public class TestClass{
  public static void main(String args[]) {
     ArrayList animals = new ArrayList();
     animals.add(new Bear());
     animals.add(new Fish());
     animals.add(new Animal());
     for (Animal a : animals){
         a.someMethod();
     }
  }
}

class Animal {
   public void someMethod(){
      System.out.println("I am an Animal");
   }
}

class Bear extends Animal{
   public void someMethod(){
      System.out.println("I am a Bear");
   }
}

class Fish extends Animal{
   public void someMethod(){
      System.out.println("I am a Fish");
   }
} 
```

这个的输出是：

```
I am a Bear
I am a Fish
I am an Animal 
```

所以我们可以在这里看到，调用每种类型对象的方法的循环都调用了 Animal 上的所有方法，而在每个对象上调用的实际方法是对象自己实现该方法。

显然，要使集合中的每个对象都可以工作，该方法必须具有此方法的实现，尽管如果适用于该对象，它显然可以使用超类的版本。

这意味着集合中的对象（作为如何使用它的示例）可以在运行时决定，并且不必单独类型转换回它们的真实形式，而可以简单地由父类调用类型或接口类型。这为代码提供了更大的灵活性，并使其更易于维护。它还允许更通用和松耦合的代码。

简而言之，就是这样。网上有很多例子可以看。这是一个绝妙的概念，非常值得花一些时间来理解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T14:55:10.650

该示例不利于解释多态性。

Addrecord 不是 Record 类的良好扩展。Addrecord 应该是方法而不是类。

所以基本上你应该有具有 Addrecord 方法的 Record 类，并且这个方法可以被特殊记录覆盖，比如 - *ColumnnameRecord*。

如果您有从 Record 类派生的 specialRecord 类，并且 Record Class 具有被派生类覆盖的方法，那么您就有了很好的多态性示例。

当前示例在技术上是正确的，但在概念上并不正确。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-10T16:05:26.953

多态性的另一个例子：

```
abstract class PolyGeometricEntity
{
    public int center_x__mm;                    // commen superset
    public int center_y__mm;                    // commen superset
    public void move(int d_x__mm, int d_y_mm)   // commen superset
    {
        center_x__mm += d_x__mm;
        center_y__mm += d_y_mm:
    }

    public abstract int area();                 // commen superset on abstract level, but specialized at implementation level
    public abstract void draw();               // commen superset on abstract level, but specialized at implementation level
}

class CircleEntity : PolyGeometricEntity
{
    public override int area()
    {
        // circle specific
        return 1;
    }
    public override void draw()
    {
        // draw a circle
    }
}

class TriangleEntity : PolyGeometricEntity
{
    public override int area()
    {
        // triangle specific
        return 1;
    }
    public override void draw()
    {
        // draw a triangle
    }
}

class PolyCanvas
{
    List<PolyGeometricEntity> entities = new List<PolyGeometricEntity>();

    void CreateEntity(string toCreateClass)
    {
        // assume that code is called by the ui
        // you do not know what the user decides at runtime
        // Polymorphism 'starting' now:
        PolyGeometricEntity toCreate = null;
        if (toCreateClass == "c") { toCreate = new CircleEntity(); }
        else if (toCreateClass == "t") { toCreate = new TriangleEntity(); }
        entities.Add(toCreate);
    }

    void ReDraw()
    {
        foreach (PolyGeometricEntity toDraw in entities)
        {
            toDraw.draw(); // polymorphism in action!
        }
    }
} 
```

# facebook - facebook 和他的 start_time 日期

> ID：10693507
> 
> 赞同：0
> 
> 时间：2012-05-21T22:29:54.030
> 
> 标签：facebook, time

我最近在玩 facebook API 时遇到了很多麻烦：

我正在从一个事件中获取 start_time，我得到了这个：

2012-11-14T04:00:00+0000

我认为这是太平洋时间，因为事件发生在 13 日晚上 7 点在法国（我的时区）。如何将其转换为我的时区？

**PS：我用PHP**

编辑：我发现了一种并非一直有效的解决方法，我只是写

```
date_default_timezone_set('America/Los_Angeles'); 
```

在使用日期函数之前。但它不适用于某些修改后的日期。虽然我真的认为它来自 facebook ......无法修复的错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:56:39.287

```
$time = '2012-11-14T04:00:00+0000';

$dt = new DateTime($time, new DateTimeZone('PST'));
$dt->setTimezone(new DateTimeZone('CET'));

echo $dt->format('Y-m-d H:i:s'); // 2012-11-14 05:00:00 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T00:48:52.447

Facebook 使用[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)时间格式。

最后的 +0000 表示它是 UTC 时间而不是太平洋时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-20T09:39:48.833

```
date_default_timezone_set('California'); 
```

试试加州时区。对我来说效果很好。

# mysql - 用于国际和多语言目的的数据库建模

> ID：10693508
> 
> 赞同：47
> 
> 时间：2012-05-21T22:29:57.647
> 
> 标签：mysql, database, database-design, internationalization, multilingual

我需要为多语言的 Web 应用程序创建一个大规模的 DB 模型。

我每次思考如何做到这一点时都有一个疑问，那就是我如何解决一个领域的多个翻译问题。一个案例。

管理员可以从后端编辑的语言级别表可以有多个项目，例如：基本、高级、流利、重要……在不久的将来，它可能会是另一种类型。管理员去后端并添加一个新级别，它会在正确的位置对其进行排序.. 但是我如何为最终用户处理所有翻译？

数据库国际化的另一个问题是，用户研究可能会因美国、英国和德国而异……在每个国家，他们都会有自己的水平（可能与另一个国家等价，但最终不同）。那么计费呢？

你是如何大规模建模的？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-05-24T09:18:07.460

这是我设计数据库的方式：

![数据模型](../Images/3ea6e30911268419d7737cb94f145093.png)

*[DB Designer Fork](http://sourceforge.net/projects/dbdesigner-fork/)的可视化*

该`i18n`表仅包含一个 PK，因此任何表只需引用此 PK 即可将字段国际化。然后该表`translation`负责将这个通用 ID 与正确的翻译列表联系起来。

`locale.id_locale`是一个`VARCHAR(5)`管理`en`和`en_US` [ISO 语法](http://en.wikipedia.org/wiki/Locale#POSIX_platforms)。

`currency.id_currency`是一种`CHAR(3)`管理[ISO 4217 的语法](http://en.wikipedia.org/wiki/ISO_4217#Active_codes)。

您可以找到两个示例：`page`和`newsletter`。这两个由*管理员管理的*实体都需要分别国际化他们的领域`title/description`和`subject/content`.

这是一个示例查询：

```
select
  t_subject.tx_translation as subject,
  t_content.tx_translation as content

from newsletter n

-- join for subject
inner join translation t_subject
  on t_subject.id_i18n = n.i18n_subject

-- join for content
inner join translation t_content
  on t_content.id_i18n = n.i18n_content

inner join locale l

  -- condition for subject
  on l.id_locale = t_subject.id_locale

  -- condition for content
  and l.id_locale = t_content.id_locale

-- locale condition
where l.id_locale = 'en_GB'

  -- other conditions
  and n.id_newsletter = 1 
```

请注意，这是一个规范化的数据模型。如果您有一个庞大的数据集，也许您可​​以考虑[对其进行非规范化](http://en.wikipedia.org/wiki/Denormalization)以优化您的查询。您还可以使用索引来提高查询性能（在某些数据库中，外键会自动建立索引，例如[MySQL/InnoDB](https://stackoverflow.com/a/304339/1225328)）。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-05-24T08:50:33.673

以前关于此主题的一些 StackOverflow 问题：

*   [多语言数据库设计的最佳实践是什么？](https://stackoverflow.com/a/929430/623041)
*   [保存多语言数据的最佳数据库结构是什么？](https://stackoverflow.com/a/2227994/623041)
*   [多语言数据库的架构](https://stackoverflow.com/a/316822/623041)
*   [如何在 ORM 中使用多语言数据库模式？](https://stackoverflow.com/a/4745863/623041)

一些有用的外部资源：

*   [创建多语言网站：数据库设计](http://www.codeproject.com/Articles/8084/Creating-multilingual-websites-Part-2#databasedesign)
*   [多语言数据库设计方法](http://www.gsdesign.ro/blog/multilanguage-database-design-approach/)
*   [Propel 获得 I18n 行为及其重要性](http://propel.posterous.com/propel-gets-i18n-behavior-and-why-it-matters)

最好的方法通常是为每个现有表格创建一个新表格，将文本项移入其中；新表的PK是旧表的PK加上语言。

在你的情况下：

1.  > 管理员可以从后端编辑的语言级别表可以有多个项目，例如：基本、高级、流利、重要……在不久的将来，它可能会是另一种类型。管理员去后端并添加一个新级别，它会在正确的位置对其进行排序.. 但是我如何为最终用户处理所有翻译？

您现有的表可能看起来像这样：

```
+----+--------+---------+
| 编号 | 价格 | 类型 |
+----+--------+---------+
| 1 | 299 | 基本 |
| 2 | 299 | 提前|
| 3 | 399 | 流利 |
| 4 | 0 | 物质 |
+----+--------+---------+

```

然后它变成两个表：

```
+----+-------+ +----+------+-------------+
| 编号 | 价格 | | 编号 | 朗 | 类型 |
+----+-------+ +----+------+-------------+
| 1 | 299 | | 1 | zh | 基本 |
| 2 | 299 | | 2 | zh | 提前|
| 3 | 399 | | 3 | zh | 流利 |
| 4 | 0 | | 4 | zh | 物质 |
+----+-------+ | 1 | 法语 | 元素 |
                 | 2 | 法语 | 前卫 |
                 | 3 | 法语 | 钱|
                 : : : :
                 +----+------+-------------+

```

2.  > 数据库国际化的另一个问题是，用户研究可能会因美国、英国和德国而异……在每个国家，他们都会有自己的水平（可能与另一个国家等价，但最终不同）。那么计费呢？

所有本地化都可以通过类似的方法进行。您可以移动任何可本地化的字段，而不只是将文本字段移动到新表中 - 只有所有语言环境共有的字段才会保留在原始表中。

# android - 布局填满时自动垂直滚动新视图不断添加到同一

> ID：10693510
> 
> 赞同：0
> 
> 时间：2012-05-21T22:30:08.863
> 
> 标签：android

我有一个问题，我有一个父布局，我正在以编程方式和动态方式在父布局中添加许多子布局，但是当屏幕被子布局填满时，它应该自动向下滚动以获取将添加到父布局中的下一个子布局.

是否有任何滚动视图的属性可以做同样的事情。我想要与 android 设备中的默认消息功能相同。当新消息到来时，视图会自动向上滚动。请就此提出任何解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T16:46:54.097

ScrollView 类有

```
scrollTo(int x, int y) 
```

和

```
smoothScrollTo(int x, int y) 
```

允许您移动到子视图位置的方法。要获取子视图的位置，请参阅[获取视图相对于根布局的坐标](https://stackoverflow.com/questions/3619693/how-to-get-views-position)

或者，如果您可以选择将视图添加到父视图的顶部，则可以通过将 0 索引传递给 addView(View child, int index) 方法来指定它。

# c - fread 只读取 64 个字节？

> ID：10693511
> 
> 赞同：1
> 
> 时间：2012-05-21T22:30:29.613
> 
> 标签：c, fopen

正如标题所说，freads 似乎只读取前 64 个字符。相关代码：

```
FILE* sigD = fopen("signature", "r");
char *sig[255];
fread(sig, 255, 255, sigD);
close(sigD);    
fputs(sig, stdout); 
```

控制台输出：

```
user@PC:~$ ./a.out --has-sig 
;2F*S|tr;;E9;Yb=R6)!fcXhoX@RC`#NzLy<}w@T+uvH${3Et&9K&-0~%D{1
user@PC:~$ 
user@PC:~$ cat signature
;2F*S|tr;;E9;Yb=R6)!fcXhoX@RC`#NzLy<}w@T+uvH${3Et&9K&-0~%D{1N{7ry:-B9b:kGB=Gkk9V+Cc$8a&35W{15Q~#-+PMeqa;#cKA7Ew3G6P4smDdJWV2@>R!V#ki@(Xj<a,^B)qJ5D&bON//?%/!G)XA&m|8:1mVHmx{7nQoRJ%v{(K:;JtX2hOm/dhVm9mnuDMSbQX55ouVnmECbA`/`!?=Mh0Ab^@vk*K*HG5$omu6716/Loh1Ht 
```

h 如该日志所示，文件中有 254 个字符，但只有 64 个被读取。

编辑：问题不在于 fread，我不小心将零终止符写入文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T22:39:13.817

目前尚不清楚这是否相关，但似乎有几个问题：

```
char *sig[255];
fread(sig, 255, 255, sigD); 
```

调用`fread`与声明不一致。它可能应该是以下内容（您可能想要一个 char 数组而不是指向 char 的指针数组）。并且传递给[fread](http://www.manpagez.com/man/3/fread/)的大小/元素信息不正确：

```
char sig[255];
// initially I had this as 'sizeof(), 1' but I think for this file it would make
// more sense as the following (nitems=255):
fread(sig, 1, sizeof(sig), sigD); 
```

虽然这无关紧要，但您可以尝试`"rb"`以强制打开二进制文件的模式打开它（在`b`符合 POSIX 的系统上应该忽略 for 二进制文件）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T22:39:21.433

你的定义`sig`不正确。如果你想要一个字符数组，你必须删除星号。您已经定义了一个字符指针数组。它应该看起来像：

```
char sig[255]; 
```

# php - 是否有 JavaScript 方法来执行 file_get_contents()？

> ID：10693518
> 
> 赞同：16
> 
> 时间：2012-05-21T22:31:11.810
> 
> 标签：php, javascript

这是[PHP文档](http://php.net/manual/en/function.file-get-contents.php)

如果我找不到纯粹的客户端方式来执行此操作，我将在 Ajax 调用中使用它。

```
$homepage = file_get_contents('http://www.example.com/');
echo $homepage; 
```

有没有办法代替这个客户端，这样我就不必将字符串 ajax 了？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T22:38:34.007

你可以做

JS代码：

```
$.post('phppage.php', { url: url }, function(data) {
    document.getElementById('somediv').innerHTML = data;        
}); 
```

PHP代码：

```
$url = $_POST['url'];
echo file_get_contents($url); 
```

这将为您提供 url 的内容。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-21T22:37:23.913

JavaScript 不能出去并从页面上抓取数据。它可以调用本地 PHP 脚本，然后代表它去获取数据，但 JavaScript（在浏览器中）不能这样做。

```
$.post("/localScript.php", { srcToGet: 'http://example.com' }, function(data){
  /* From within here, data is whatever your local script sent back to us */
}); 
```

您可以使用 JSONP 和跨域资源共享等选项，但是这两个选项都需要设置另一端，因此您不能只选择一个域并开始发出数据请求。

延伸阅读：[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-04-17T21:31:10.873

该函数将文件作为字符串返回，就像 PHP 一样`file_get_contents()`。

```
function file_get_contents(uri, callback) {
    fetch(uri).then(res => res.text()).then(text => callback(text));
} 
```

然而，与 PHP 不同的是，JavaScript 将继续执行下一条语句，而不是等待数据返回。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-05-14T00:49:24.413

现在是 2020 年和一些现代方法；

```
async function file_get_contents(uri, callback) {
    let res = await fetch(uri),
        ret = await res.text(); 
    return callback ? callback(ret) : ret; // a Promise() actually.
}

file_get_contents("https://httpbin.org/get", console.log);
// or
file_get_contents("https://httpbin.org/get").then(ret => console.log(ret)); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-21T22:37:17.113

不是一般意义上的。跨域限制不允许 Javascript 代码执行此操作。

如果目标站点设置了[CORS](http://www.w3.org/TR/cors/)（跨域资源共享），则可以使用 XMLHttpRequest 加载文件。大多数网站都没有，因为出于安全原因默认情况下它是关闭的，并且很少需要。

如果您只需要包含一个 HTML 页面，您可以将其粘贴在一个`<iframe>`元素中。不过，这会受到一些布局问题的影响（页面以固定大小的元素结束）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-21T23:07:23.483

Or You can use php.js library. Which allow some php functions for javascript. file_get_contents() function one of them.

```
<script>
var data = file_get_contents('Your URL');
</script> 
```

You can find more info about php.js : [http://phpjs.org/](http://phpjs.org/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-14T05:56:49.680

我认为这可能对您有用：

具有 node.js 的“file-get-contents”方法的 npm 包 [https://www.npmjs.com/package/file-get-contents](https://www.npmjs.com/package/file-get-contents)

***它是异步的，所以如果你使用 express，它应该像这样使用***

```
app.get('/',  async (req, res)=>{
    //paste here the code below
} 
```

> 例子
> 
> ```
> const fileGetContents = require('file-get-contents');
>  
> // A File request
>  
> try {
>     let data = await fileGetContents('/tmp/foo/bar');
>  
>     console.log(data);
> } catch (err) {
>     console.log('Unable to load data from /tmp/foo/bar');
> }
>  
> // Or a HTTP(S) request
>  
> fileGetContents('https://pokeapi.co/api/v2/pokemon/1/').then(json => {
>     const pokemon = JSON.parse(json);
>  
>     console.log(`Name of first pokemon is ${pokemon.name}`);
> }).catch(err => {
>     console.err(`Unable to get content from PokeAPI. Reason: ${err.message}`);
> }); 
> ```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-05-06T22:11:20.047

```
 <div id="svg">

  </div>
  <script>

    function file_get_contents(uri, callback) {
         fetch(uri).then(res => res.text()).then(text => 
        {

            var xmlSvg =text;
            console.log(xmlSvg );
            document.getElementById('svg').innerHTML = xmlSvg;
        })
    }

    var uri ='You-urlllllllll-svg';

    file_get_contents(uri);

</script> 
```

# java - 如何将对象添加到 JFrame

> ID：10693520
> 
> 赞同：1
> 
> 时间：2012-05-21T22:31:16.897
> 
> 标签：java, image, swing, object, jframe

我正在尝试在 JFrame 中制作游戏，但遇到了问题。我创建了一个由四个图像串成一个的对象。我的问题是，我如何在 JFrame 中绘制这个对象？

这是代码：

```
import java.io.*;
import java.awt.*;
import java.awt.event.*;
import java.awt.image.*;
import java.util.Random;
import javax.swing.JFrame;
import javax.swing.*;

public class t4
{
    static boolean running;

    public static Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
    public static double width = screenSize.getWidth();
    public static double height = screenSize.getHeight();

    public static int x = ( 250 );
    public static int y = ( 150 );

    public static final int sx = (int)width;
    public static final int sy = (int)height;

    public static void main( String[] args ) throws IOException, InterruptedException
    {
        Image ur = new ImageIcon("redBlock.gif").getImage();
        Image ll = new ImageIcon("redBlock.gif").getImage();
        Image ul = new ImageIcon("blueBlock.gif").getImage();
        Image lr = new ImageIcon("blueBlock.gif").getImage();

        // Create game window...
        JFrame app = new JFrame();
        app.setIgnoreRepaint( true );
        app.setUndecorated( true );

        // Add ESC listener to quit...
        app.addKeyListener( new KeyAdapter()
        {
            public void keyPressed( KeyEvent e )
            {
                if( e.getKeyCode() == KeyEvent.VK_ESCAPE )
                    running = false;
                if((e.getKeyCode()==KeyEvent.VK_LEFT)||(e.getKeyCode()==KeyEvent.VK_KP_LEFT))
                    x-=10;
                if((e.getKeyCode()==KeyEvent.VK_RIGHT)||(e.getKeyCode()==KeyEvent.VK_KP_RIGHT))
                    x+=10;
                if((e.getKeyCode()==KeyEvent.VK_UP)||(e.getKeyCode()==KeyEvent.VK_KP_UP))
                    y-=10;
                if((e.getKeyCode()==KeyEvent.VK_DOWN)||(e.getKeyCode()==KeyEvent.VK_KP_DOWN))
                y+=10;
            }
        });

        // Get graphics configuration...
        GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
        GraphicsDevice gd = ge.getDefaultScreenDevice();
        GraphicsConfiguration gc = gd.getDefaultConfiguration();

        // Change to full screen
        gd.setFullScreenWindow( app );
        if( gd.isDisplayChangeSupported() )
        {
            gd.setDisplayMode(new DisplayMode( sx, sy, 32, DisplayMode.REFRESH_RATE_UNKNOWN ));
        }

        // Create BackBuffer...
        app.createBufferStrategy( 2 );
        BufferStrategy buffer = app.getBufferStrategy();

        // Create off-screen drawing surface
        BufferedImage bi = gc.createCompatibleImage( sx, sy );

        // Objects needed for rendering...
        Graphics graphics = null;
        Graphics2D g2d = null;
        Color background = Color.BLACK;
        Random rand = new Random();

        // Variables for counting frames per seconds
        int fps = 0;
        int frames = 0;
        long totalTime = 0;
        long curTime = System.currentTimeMillis();
        long lastTime = curTime;

        running = true;
        while( running )
        {
            try
            {
                //    wait(500);

                // count Frames per second...
                lastTime = curTime;
                curTime = System.currentTimeMillis();
                totalTime += curTime - lastTime;
                if( totalTime > 1000 )
                {
                    totalTime -= 1000;
                    fps = frames;
                    frames = 0;
                } 
                ++frames;

                // clear back buffer...
                g2d = bi.createGraphics();
                g2d.setColor( background );
                g2d.fillRect( 0, 0, sx, sy );

                // draw some rectangles...
                /* int r = 45;
                int g = 232;
                int b = 163;
                g2d.setColor( new Color(r,g,b) );
                int w = ( 250 );
                int h = ( 150 );
                g2d.fillRect( x+25, y+25, w, h );*/

                if(y<775)
                {
                    y++;
                }
                else
                {
                    y=0;
                }

                // display frames per second...
                g2d.setFont( new Font( "Courier New", Font.PLAIN, 12 ) );
                g2d.setColor( Color.GREEN );
                g2d.drawString( String.format( "FPS: %s", fps ), 20, 20 );

                // Blit image and flip...
                graphics = buffer.getDrawGraphics();
                graphics.drawImage( bi, 0, 0, null );

                graphics.drawImage(ur,x,y,null);
                graphics.drawImage(ll,x+50,y+50,null);
                graphics.drawImage(ul,x,y+50,null);
                graphics.drawImage(lr,x+50,y,null);

                if( !buffer.contentsLost() )
                    buffer.show();

            }
            finally
            {
                // release resources
                if( graphics != null ) 
                    graphics.dispose();
                if( g2d != null ) 
                    g2d.dispose();
            }
        }

        gd.setFullScreenWindow( null );
        System.exit(0);
    }

    public static void wait(int x) throws InterruptedException
    {
        Thread.currentThread().sleep(x);
    }
} 
```

我想创建一个包含图像 ur、ll、ul 和 lr 的对象，并能够在屏幕上绘制它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T21:05:35.300

这是你应该做的：

1.  修改类以使其扩展`javax.swing.JComponent`。
2.  覆盖`paintComponent(Graphics)`。
3.  创建一个`javax.swing.Timer`来管理帧速率。
4.  覆盖`getPreferredSize()`。

首先（按照 DavidB 的要求）我会解释*为什么*你应该做这些事情，然后我会告诉你*如何*做。

# 解释

*   由于您尝试将组件添加到 JFrame，因此您需要组件的类与 JFrame 的`add`方法兼容（实际上，它属于`Container`，但这并不重要）。如果您查看[JavaDoc 文档`add`](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/Container.html#add%28java.awt.Component%29)，您会发现它不接受任何`Object`; 相反，它需要一个`Component`（或其子类）的实例。您*可以*子类`Component`化而不是`JComponent`，但`Component`更多的是 AWT 应用程序而不是 Swing 应用程序。
    **简而言之：**子类`JComponent`，以便`JFrame.add`将其作为参数接受。
*   子类`JComponent`化后，您需要实际告诉窗口管理器要绘制什么。您可以将绘图代码放在任何地方，但请记住它不会被调用（使用），除非实际*调用*该方法。图形环境调用开始绘制过程的方法称为`paintComponent`*. 如果您覆盖此方法，则图形环境将调用您的自定义绘画代码。
    **简而言之：**覆盖`paintComponent`，因为这是图形环境所关心的。
*   由于您很可能会在游戏中制作动画，因此您需要保持每秒帧数的恒定速率，对吗？如果你不这样做，有很多因素（计算机能力、运行的其他应用程序、绘图复杂性等）可能会导致帧速率失控。为此，您需要`repaint`每秒调用该方法指定的次数（每帧一次）。这是 Swing 计时器的重点。你给它一段代码和几毫秒，它会在每次指定的时间间隔过去时运行该代码。
    **简而言之：**使用 Swing 计时器，以便您可以保持帧速率恒定并受到控制。
*   想象一下，您有一个文字处理应用程序。它的顶部有一个菜单栏，中间有一个文档窗口，底部有一个工具栏。显然，您希望菜单栏和工具栏很小，并且文档占用尽可能多的空间，对吗？这就是为什么您需要让每个组件告诉您它的大小应该是多少，称为它的*首选大小*。覆盖`getPreferredSize`允许您返回所需的任何大小，从而控制组件的大小。**
    **简而言之：**覆盖`getPreferredSize`，以便窗口管理器和图形环境获得正确的所有大小。

* 实际上并不是`paintComponent`这样调用的；它是`paint`。但是，该`paint`方法调用`paintComponent`、`paintBorder`和`paintChildren`：

> 该方法实际上将绘画工作委托给了三个受保护的方法：paintComponent、paintBorder 和paintChildren。它们按列出的顺序调用，以确保子组件出现在组件本身的顶部。一般来说，组件及其子组件不应该在分配给边框的 insets 区域中进行绘制。子类可以像往常一样覆盖这个方法。只想专门化 UI（外观和感觉）委托的绘制方法的子类应该重写paintComponent。

（来源：[JavaDoc](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/JComponent.html#paint%28java.awt.Graphics%29)）

** 覆盖`getPreferredSize`实际上并不能保证这是显示组件的大小。它仅指定*应*显示的大小。一些布局管理器会选择忽略这一点（例如 BorderLayout）。但是，当您调用`pack`正确调整窗口大小时，它应该根据此大小计算首选大小。

# 程序

## 扩展 JComponent

要使类扩展 JComponent，只需将类签名更改为：

```
import javax.swing.JComponent;

public class MyGameDisplay extends JComponent {
    ...
} 
```

## 覆盖`paintComponent`

您需要导入`java.awt.Graphics`该类。请参阅此示例代码以了解如何使用`paintComponent`：

```
import javax.swing.JComponent;
import java.awt.Graphics;

public class MyGameDisplay extends JComponent {
    // Some code here

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g); // this line is crucial; see below
        g.drawString(100,100,"Hello world");
    }
} 
```

**注意**：上面，我提到了`super.paintComponent`在方法中调用 from的必要性`paintComponent`。这样做的原因是它将（除其他外）清除您之前显示的所有图形。因此，例如，如果您的程序绘制了一个在屏幕上移动的圆，则绘图的每次迭代也将包含来自先前绘图的圆的轨迹，除非您调用`super.paintComponent`.

## 用一个`Timer`

要获得所需的 FPS 速率，请修改类以包含 Swing 计时器，如下所示：

```
// Include these imports:
import javax.swing.Timer;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class MyGameDisplay extends JComponent {
    private Timer t;
    public MyGameDisplay() {
        ActionListener al = new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                repaint();
            }
        }
        t = new Timer(1000 / 30 /* frame rate */, al);
        t.start();
    }
} 
```

## 覆盖`getPreferredSize`

覆盖的原因`getPreferredSize`是布局管理器将知道如何正确调整容器的大小。

虽然编写实际逻辑来计算大小可能很困难，但覆盖`getPreferredSize`本身并不困难。这样做：

```
@Override
public Dimension getPreferredSize() {
    return new Dimension(400, 400); // for example
} 
```

* * *

完成后，您只需运行以下代码：

```
import javax.swing.JFrame;

public class Test {
    public static void main(String[] args) {
        JFrame frame = new JFrame();
        MyGameDisplay mgd = new MyGameDisplay();
        frame.add(mgd);
        frame.pack();
        frame.setVisible(true);
    }
} 
```

# c++ - J 编程语言中的数组

> ID：10693521
> 
> 赞同：5
> 
> 时间：2012-05-21T22:31:19.547
> 
> 标签：c++, j

在 J 编程语言中如何进行数组访问？例如，使用 C++ 作为我的伪代码语言：

```
int M [100];  // declare an array called M
int j = 5;  //index into the array
int y = 10;  //value to store or load from the array

M[j] = y;  // store y into the array

y = M[j];  // load y from the array 
```

在惯用的 J 中，这些类型的数组访问会是什么样子？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-10T19:29:15.350

在 J 中写这个的字面（但仍然很惯用）的方式如下。

```
m =: 100 $ 0   NB. This means create a 1d array consisting of 100 zeros.
j =: 5
y =: 10 
```

完成初始化后，现在我们已经准备好回答的核心内容了，其中包括副词的两种不同用法[（`}`“Item Amend”和“Amend”）](http://www.jsoftware.com/help/dictionary/d530n.htm)。

```
m =: y j } m 
```

将两个参数放在左边`}`会导致 J用 value替换`j`右边参数的第 th 个元素。注意：我们必须将结果分配回，因为结果只是计算一个新数组，其中包含您使用动词请求的更改。`m``y``m``y j } m``}`

```
y =: j } m 
```

仅将一个参数放在左侧`}`导致 J 摘录的`j`第一个元素`m`并返回它。在这种情况下，我们将 y 设置为结果。

# php - 如何使用 PHP 在 mysql 表中查找重复项？

> ID：10693522
> 
> 赞同：0
> 
> 时间：2012-05-21T22:31:40.583
> 
> 标签：php, mysql

我有一张包含客户信息的表格。通常，PHP 在插入新行之前会检查重复项。但是，我不得不手动转储很多旧行，现在它们都在我的表中，我需要检查重复项。

示例行：

ID、姓名、电子邮件、电话、传真

我想做一个 mysql 查询，它将显示所有带有匹配电子邮件的 ID。我可以稍后修改电话、传真等的查询。

我有一种感觉，我会使用`DISTINCT`，但我不太确定它是如何完成的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:32:20.843

您可以`GROUP BY email`查找`HAVING COUNT(*) > 1`所有重复的电子邮件地址，然后将生成的重复电子邮件与您的表连接起来以获取 id：

```
SELECT id FROM my_table NATURAL JOIN (
  SELECT email FROM my_table GROUP BY email HAVING COUNT(*) > 1
) t 
```

# matlab - 生成二维系统的分岔图

> ID：10693525
> 
> 赞同：5
> 
> 时间：2012-05-21T22:31:51.863
> 
> 标签：matlab, diagram, matlab-figure

为 1D 系统绘制分岔图很清楚，但如果我有以下形式的 2D 系统 `dx/dt=f(x,y,r), dy/dt=g(x,y,r)`

我想在 MATLAB 中为 x 与 r 生成一个分岔图。这样做的主要想法是什么或任何可以帮助我的提示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T23:58:47.073

我不认为 MATLAB 有任何内置的东西会给你一个分岔图。有这个第三方解决方案：

[http://www.mathworks.com/matlabcentral/fileexchange/8382](http://www.mathworks.com/matlabcentral/fileexchange/8382)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T06:44:21.390

**您首先必须做一些数学运算：**

将每个函数设置为零会为您提供两个函数 y(x)（称为零斜线），您可以将其绘制在相图中。两条线相交的地方是系统的不动点（平衡点）。

现在，您必须获取系统的雅可比并插入每个固定点，这将为您提供系统的线性稳定性分析。

固定点的位置和每个点的稳定性现在可以通过改变 r（分岔参数）来计算。

**对于编程：**

- 使用牛顿法（ MATLAB 中的**fsolve**）找到方程为零的位置 - **eig**将帮助您找到系统的特征值。

**然而**

这取决于您的系统。

如果您应该寻找极限环或混乱或其他东西，您将不得不使用其中一个 ode 求解器，然后分析变得更加棘手。我想你可以开发一个 poincare-bendixson 算法，但这会涉及到细节，具体取决于你的系统。

# css - CSS溢出：隐藏在圆圈内

> ID：10693526
> 
> 赞同：3
> 
> 时间：2012-05-21T22:31:54.137
> 
> 标签：css

我试图隐藏圆形 div 的溢出。它的子 div 在容器区域之外时隐藏在视图之外（好），但仅在半径区域之外时仍然可见（坏）

```
.outer{
    position:relative;
    border-radius: 50%;               
    width: 200px;
    height: 200px;
    background:#dedede;
    overflow: hidden;
}
.inner{
    position: absolute;
    top:150px;
    left:150px;
    width: 50px;
    height: 50px;
    background-color: red;
    background:#98de45;
}​ 
```

总的来说，我想在[http://buildinternet.com/project/mosaic/1.0](http://buildinternet.com/project/mosaic/1.0)上实现效果，但使用圆圈 - 有没有办法做到这一点？

小提琴：http: [//jsfiddle.net/a9Feu/](http://jsfiddle.net/a9Feu/)

编辑：这适用于 Firefox 和 IE 10，但不适用于 Chrome 或 Safari

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T22:38:48.230

像这样？

```
.outer{
    position:static;
    border-radius: 50%;               
    width: 200px;
    height: 200px;
    background:#dedede;
    overflow: hidden;
}
.inner{
    position: static;
    top:150px;
    left:150px;
    width: 50px;
    height: 50px;
    background-color: red;
    background:#98de45;
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T06:31:41.953

我希望这应该工作

[http://jsfiddle.net/a9Feu/35/](http://jsfiddle.net/a9Feu/35/)

```
.inner{
    position: absolute;
    **border-bottom-right-radius: 100% 110%;**
    top:150px;
    left:150px;
    width: 38px;
    height: 35px;
    background-color: red;
    background:#98de45;
}​ 
```

# emacs - 我在哪里可以获得 Emacs 24 的“Light Table”主题？

> ID：10693531
> 
> 赞同：3
> 
> 时间：2012-05-21T22:32:21.623
> 
> 标签：emacs, lisp, themes, emacs24

我真的很喜欢 Light Table 配色方案，但尽管 Google 搜索了很多，但我似乎无法找到 Emacs 主题。我已经尝试重新创建它，但肯定有人已经这样做了。

这是一个黑暗的主题，看起来像：

![灯桌主题示例](../Images/03abcfc25abccce5fed05c56f8b89ba7.png)

[Kickstarter 页面](http://www.kickstarter.com/projects/ibdknox/light-table)上有更多示例图片。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T09:13:44.750

我基于 LightTable 配色方案制作了一个主题，我刚刚发布了它作为一个要点。

```
https://gist.github.com/3027622 
```

![泡泡莓主题.el](../Images/1c183408ccac9ebab2bbb0b0b768002a.png)

仅供参考，我正在为 Emacs24 发布几个新主题。[在https://emacsfodder.github.io/](https://emacsfodder.github.io/)还有一些其他的黑暗主题

### 更新

这是 font-lock 的视图（即语言泛型，主要模式使用它来提供语法突出显示。）彩虹模式的定义。

![BubbleBerry Theme font-lock defs Rainbow-mode](../Images/8f4061df022b23dc9a4741744aef87a6.png)

### 笔记：

在 Emacs Lisp 模式下（CommonLisp 和 EmacsLisp 是我所知道的最接近 Clojure 的东西。）

我们可以看到，即使是本地函数用法也没有添加到语法高亮中：

![在 Emacs Lisp 模式下，本地函数的使用不会被添加到语法高亮中。](../Images/de167a74f4ab58fa0e8096ca7046670d.png)

（用 clojure-mode 做了一个小检查，我可以看到那里发生了同样的事情，defn 显示它们的函数名称突出显示，但使用的是默认的面颜色。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-29T21:31:38.463

为了完整起见，可能值得在这里添加这个新答案。现在有一个适用于 Emacs 的 LightTable 主题。它被称为**夜光**：

[https://github.com/stafu/noctilux-theme](https://github.com/stafu/noctilux-theme)

# php - 如何检查字符串中是否存在数组元素

> ID：10693532
> 
> 赞同：0
> 
> 时间：2012-05-21T22:32:22.557
> 
> 标签：php, arrays, string

我有一个数组中的单词列表。检查字符串中是否存在这些单词的最快方法是什么？

`foreach`目前，我正在通过循环逐一检查数组元素的存在`stripos`。我很好奇是否有更快的方法，就像我们`str_replace`使用数组所做的那样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:54:36.190

关于[您的附加评论](https://stackoverflow.com/questions/10693532/how-to-check-if-array-elements-exist-in-a-string#comment13881089_10693532)，您可以使用 explode() 或[preg_split()将您的字符串分解为单个单词，然后使用](http://www.php.net/manual/en/function.preg-split.php)[array_intersect()](http://www.php.net/manual/en/function.array-intersect.php)检查该数组与 needles 数组。所以所有的工作只做一次。

```
<?php
$haystack = "Hello Houston, we have a problem";
$haystacks = preg_split("/\b/", $haystack);
$needles = array("Chicago", "New York", "Houston");
$intersect = array_intersect($haystacks, $needles);
$count = count($intersect);

var_dump($count, $intersect); 
```

我可以想象 array_intersect() 非常快。但这取决于您真正想要什么（匹配单词，匹配片段，..）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:33:16.540

我的个人功能：

```
function wordsFound($haystack,$needles) {
    return preg_match('/\b('.implode('|',$needles).')\b/i',$haystack);      
}

//> Usage:
if (wordsFound('string string string',array('words'))) 
```

请注意，如果您使用 UTF-8 外来字符串，则需要将 \b 更改为 utf-8 preg 单词边界的对应关系

注意2：请务必在 $needles 中仅输入 a-z0-9 字符（感谢 MonkeyMonkey），否则您需要在`preg_quote`此之前输入

`i`注意3：由于修饰符，此函数不区分大小写

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T22:37:49.950

通常，与基本字符串函数（如`str_ipos()`. 但我认为这真的取决于情况。如果您真的需要最高性能，我建议您使用真实数据进行一些测试。

# ruby-on-rails - 安装rails——“rails new”不起作用

> ID：10693544
> 
> 赞同：0
> 
> 时间：2012-05-21T22:34:02.357
> 
> 标签：ruby-on-rails, ruby, rubygems, installation

我正在尝试安装导轨。我对这些东西很陌生，如果我遗漏了一些明显的东西，我很抱歉。我已经完成了大部分工作，但是当我实际尝试“rails new blog”时，出现以下错误：

```
/Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/fileutils.rb:247:in `mkdir':    Permission denied - /rails_projects/blog (Errno::EACCES)
from /Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/fileutils.rb:247:in `fu_mkdir'
from /Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/fileutils.rb:221:in `block (2 levels) in mkdir_p'
from /Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/fileutils.rb:219:in `reverse_each'
from /Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/fileutils.rb:219:in `block in mkdir_p'
from /Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/fileutils.rb:205:in `each'
from /Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/fileutils.rb:205:in `mkdir_p'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/actions/empty_directory.rb:51:in `block in invoke!'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/actions/empty_directory.rb:114:in `call'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/actions/empty_directory.rb:114:in `invoke_with_conflict_check'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/actions/empty_directory.rb:50:in `invoke!'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/actions.rb:95:in `action'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/actions/empty_directory.rb:15:in `empty_directory'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.3/lib/rails/generators/app_base.rb:103:in `create_root'
from (eval):1:in `create_root'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/task.rb:22:in `run'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/invocation.rb:118:in `invoke_task'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/invocation.rb:124:in `block in invoke_all'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/invocation.rb:124:in `each'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/invocation.rb:124:in `map'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/invocation.rb:124:in `invoke_all'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/group.rb:226:in `dispatch'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/thor-0.14.6/lib/thor/base.rb:389:in `start'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.3/lib/rails/commands/application.rb:38:in `<top (required)>'
from /Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
from /Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.3/lib/rails/cli.rb:15:in `<top (required)>'
from /Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
from /Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.3/bin/rails:7:in `<top (required)>'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin/rails:19:in `load'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin/rails:19:in `<main>'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin/ruby_noexec_wrapper:14:in `eval'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin/ruby_noexec_wrapper:14:in `<main>' 
```

我已经四处寻找修复它的方法（尝试 gem install rails 几次，摆弄其他一些东西），但我无法让它工作。我真的很感激一些帮助。我正在开发 OS X Lion，并且已经安装了 Ruby 和 RVM 等等。不能为我的生活弄清楚我做错了什么。

谢谢！

萨沙

PS——如果我用“sudo”执行上述操作，它会返回：

```
/Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find railties (>= 0) amongst [bigdecimal-1.1.0, io-console-0.3, json-1.5.4, minitest-2.5.1, rake-0.9.2.2, rdoc-3.9.4] (Gem::LoadError)
from /Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:256:in `to_spec'
from /Users/sashafklein/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems.rb:1231:in `gem'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin/rails:18:in `<main>'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin/ruby_noexec_wrapper:14:in `eval'
from /Users/sashafklein/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin/ruby_noexec_wrapper:14:in `<main>' 
```

问题是，我肯定有铁路。并且尝试通过 gem install 重新安装并不能解决任何问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:14:14.803

我遇到了完全相同的问题（在 Mac 上）。当我尝试在 HOME 目录的文件夹中创建应用程序时，给了我同样的错误。但是当我在用户文件夹用户/用户名之一中尝试相同时，它起作用了。我猜想与root权限有关。希望这可以帮助。

# android - My service running even if i close my app, and couldn't write it to my layout

> ID：10693554
> 
> 赞同：1
> 
> 时间：2012-05-21T22:35:29.133
> 
> 标签：android

i wrote an application that listens received sms'.
2 problems occured. First , I noticed that my service is running even if i close my app. And second is that i couldn't make it write to my sms.xml layout. It shows the Toast but not writing to the screen.

This is my activity.

```
import android.app.Activity;
import android.app.Service;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.os.Bundle;
import android.os.IBinder;
import android.telephony.SmsMessage;
import android.util.Log;
import android.widget.TextView;
import android.widget.Toast;

public class SMSGoster extends Activity {

    public TextView t;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.sms);
        t=(TextView) findViewById(R.id.smsText);
        t.setText("Okumaya Baslandı!\n");
    }

    public class SMSService extends Service {

        private SMSreceiver mSMSreceiver;
        private IntentFilter mIntentFilter;
        public TextView t;

        @Override
        public void onCreate() {
            super.onCreate();
            // SMS event receiver
            mSMSreceiver = new SMSreceiver();
            mIntentFilter = new IntentFilter();
            mIntentFilter.addAction("android.provider.Telephony.SMS_RECEIVED");
            registerReceiver(mSMSreceiver, mIntentFilter);
            t=(TextView) findViewById(R.id.smsText);
        }

        @Override
        public void onDestroy() {
            super.onDestroy();

            // Unregister the SMS receiver
            unregisterReceiver(mSMSreceiver);
        }

        @Override
        public IBinder onBind(Intent arg0) {
            // TODO Auto-generated method stub
            return null;
        }

    }

    private class SMSreceiver extends BroadcastReceiver {
        private final String TAG = this.getClass().getSimpleName();
        public TextView t;
        @Override
        public void onReceive(Context context, Intent intent) {
            Bundle extras = intent.getExtras();

            String strMessage = "";

            if (extras != null) {
                Object[] smsextras = (Object[]) extras.get("pdus");

                for (int i = 0; i < smsextras.length; i++) {
                    SmsMessage smsmsg = SmsMessage
                            .createFromPdu((byte[]) smsextras[i]);

                    String strMsgBody = smsmsg.getMessageBody().toString();
                    String strMsgSrc = smsmsg.getOriginatingAddress();

                    strMessage += "SMS from " + strMsgSrc + " : " + strMsgBody;

                    Log.i(TAG, strMessage);
                    smsReceived(strMessage);
                    Toast.makeText(getApplicationContext(), strMessage,
                            Toast.LENGTH_LONG).show();
                }

            }

        }
        public void smsReceived(String s) {
            t=(TextView) findViewById(R.id.smsText);
            t.append(s);
        }
    }

} 
```

This is the layout : sms.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/smsText"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>

</LinearLayout> 
```

And this is the manifes file :

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.emre"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="10" />
    <uses-permission android:name="android.permission.RECEIVE_SMS" />
    <uses-permission android:name="android.permission.SEND_SMS" />
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
     <activity
            android:name="SMSGoster"
            android:label="@string/app_name" >
            <service
                android:name="SMSService"
                android:enabled="true" >
                <intent-filter>
                    <action android:name="SMSService" />
                </intent-filter>
            </service>
        </activity>
    </application>
</manifest> 
```

Any advice would be great! Best Regards.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:40:25.490

I'll answer one of your two questions:

Services should be for things running in the background, for example, to monitor SMS messages (as I'm assuming you are)

This means that it is active between activities.

If you want to turn off the service when your app is closed, you have two options.

*   Kill the service on every Activity by overriding `onPaused()`
*   Create a "parent activity" that all of your activities inherit from that implements `onPaused()`

I can post a code sample if you don't know how to do these things :)

SO encourages individual questions to be answered individually. So please write your 2nd question in a 2nd submission and I will go answer it as well. Include the link in a comment response!

If you're impatient, I will give you a hint: the service is very loosely coupled to the immediate UI, so you need to find a way to send something from a service to the UI... there is a method to do this :)

# javascript - 检测样式是否为用户样式

> ID：10693562
> 
> 赞同：0
> 
> 时间：2012-05-21T22:36:17.247
> 
> 标签：javascript, firefox, firefox-addon

调用后`window.getComputedStyle`，如何判断一个样式一个样式是否来自页面本身（而不是来自浏览器）？我有兴趣在纯 javascript 中这样做，尽管我会选择在附加组件的上下文中运行的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T05:53:56.253

你将很难弄清楚`getComputedStyle`给你的规则是从哪里来的。请注意，MaxArt 提供的代码并不是一个完整的解决方案 - 还有继承的样式，因此必须为父节点重复所有内容。更简单的方法是使用[`inIDOMUtils.getCSSStyleRules()`](https://developer.mozilla.org/en/XPCOM_Interface_Reference/inIDOMUtils#getCSSStyleRules%28%29)，沿着这些思路：

```
function isPageStyle(styleSheet)
{
  if (styleSheet.ownerNode)
    return true;

  if (styleSheet.ownerRule instanceof Components.interfaces.nsIDOMCSSImportRule)
    return isPageStyle(styleSheet.parentStyleSheet);

  return false;
}

var domUtils = Components.classes["@mozilla.org/inspector/dom-utils;1"]
                         .getService(Components.interfaces.inIDOMUtils);
var rules = domUtils.getCSSStyleRules(element);
for (var i = 0; i < rules.Count(); i++)
{
  var rule = rules.GetElementAt(i);
  if (isPageStyle(rule.parentStyleSheet))
    alert(rule.cssText);
} 
```

You will have to do it for the parent nodes as well. For a complete example you can look at the [implementation of the Inspector feature in Firefox](http://hg.mozilla.org/mozilla-central/file/64187d60fae7/browser/devtools/styleinspector/CssRuleView.jsm#l121) (`isPageStyle` function in my answer shamelessly "borrowed" from [here](http://hg.mozilla.org/mozilla-central/file/64187d60fae7/browser/devtools/styleinspector/CssLogic.jsm#l844)).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:40:54.660

除非您想解析文档中的每个样式表，否则您不能。如果你对每个浏览器默认应用到元素的样式有问题，你可以依赖重置 CSS 之类的东西。

如果你想解析样式表，无论如何，你可以这样做：

```
function isDefaultStyle(element, property) {
    if (element.style[property]) return false;
    for (var i = 0; i < document.styleSheets.length; i++) {
        for (var j = 0, r; j < document.styleSheets[i].cssRules.length; j++) {
            r = document.styleSheets[i].cssRules[j];
            if (element.matchesSelector(r.selectorText) && r[property]) return false;
        }
    }
    return true;
} 
```

`matchesSelector`是一种实际上不被任何浏览器支持的元素方法，它实际上支持命名空间函数，如`webkitMatchesSelector`, `mozMatchesSelector`,`oMatchesSelector`甚至`msMatchesSelector`(IE9+)。可悲的是，对于 IE8，您必须模拟它，而我找不到比检查元素是否包含在 中更好的方法`document.querySelectorAll(r.selectorText)`，这对于大型 DOM 树来说可能非常慢。

在最后一种情况下，您显然还必须使用`rules`而不是`cssRules`.

# android - Monodroid：未签名的二进制文件上传到亚马逊

> ID：10693564
> 
> 赞同：2
> 
> 时间：2012-05-21T22:36:22.213
> 
> 标签：android, mono, amazon, xamarin.android, unsigned

要上传使用 Google API（地图）的 Android 应用程序`Amazon`，您需要上传`unsigned binary`.

从亚马逊应用管理门户：

```
7\.       Upload your unsigned binary (shown as Step 1\. Upload unsigned binary) 
```

使用`MonoDevelop`and `Mono for Android`，我如何`unsigned binary`为亚马逊创建一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:41:50.483

每次部署到模拟器或设备时，都会创建已签名和未签名的包。签入 bin\Release 以找到一对文件，例如：

*   AndroidApplication1.AndroidApplication1.apk
*   AndroidApplication1.AndroidApplication1-Signed.apk

没有“签名”的是未签名的包。

# apache-camel - 从 Apache Camel 生成 SNMP 陷阱

> ID：10693566
> 
> 赞同：0
> 
> 时间：2012-05-21T22:36:38.847
> 
> 标签：apache-camel

我正在查看骆驼 SNMP 组件：[http](http://camel.apache.org/snmp.html) ://camel.apache.org/snmp.html ，它看起来像是一个仅限消费者的组件。

我是不是误会了？有没有办法从路由中生成 SNMP 陷阱？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T04:41:43.727

尚未，但已请求：[https ://issues.apache.org/jira/browse/CAMEL-5271](https://issues.apache.org/jira/browse/CAMEL-5271)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T06:33:32.733

正如博迪所说。但是，您当然可以使用常规 Java 在 bean 或处理器中执行 SNMP 工作。也许使用第三方库，例如[http://www.snmp4j.org/](http://www.snmp4j.org/)

# sockets - 使用 Java 发送零数据 TCP/IP 数据包

> ID：10693570
> 
> 赞同：5
> 
> 时间：2012-05-21T22:37:03.170
> 
> 标签：sockets, tcp, java, outputstream

我的目标是发送一个带有空数据字段的 TCP 数据包，以便用远程机器测试套接字。

我正在使用 OutputStream 类的 write(byte[] b) 方法。我的尝试：

```
outClient = ClientSocket.getOutputStream();
outClient.write(("").getBytes()); 
```

这样做，数据包永远不会出现在网络上。如果将 "" 替换为 " " 或任何非零字符串，它可以正常工作。

我尝试了 jpcap，它对我有用，但没有达到我的目标。我想扩展 OutputStream 类，并实现我自己的 OutputStream.write 方法。但这超出了我的知识范围。如果有人已经做过这样的事情，请给我建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T23:12:25.113

如果您只想快速检测静默断开的连接，您可以使用`Socket.setKeepAlive( true )`. 此方法要求 TCP/IP 处理心跳探测，无需任何数据包或应用程序编程。但是，如果您想对心跳频率进行更多控制，则应使用应用程序级数据包实现心跳。

有关详细信息，请参见此处：http: [//mindprod.com/jgloss/socket.html#DISCONNECT](http://mindprod.com/jgloss/socket.html#DISCONNECT)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-22T01:17:37.053

There is no such thing as an empty TCP packet, because there is no such thing as a TCP packet. TCP is a byte-stream protocol. If you send zero bytes, nothing happens.

To detect broken connections, short of keepalive which only helps you after two hours, you must rely on read timeouts and write exceptions.

# java - 返回arraylist并在不同的类中使用

> ID：10693575
> 
> 赞同：0
> 
> 时间：2012-05-21T22:38:10.493
> 
> 标签：java, arraylist, return

我正在尝试从此方法返回一个数组列表

```
 import java.io.*;
import java.util.*;
/** The class reader read the file 2RainfallDataLanc.txt and stores is as an ArrayList. 
 * It also parses the variables within the file by white spaces, making variables accessible.
 *
 */
public class reader {

    public ArrayList<String[]> getRows(){

    try {
            BufferedReader reader = new BufferedReader(new FileReader("2RainfallDataLanc.txt"));
            String line = null;
            ArrayList<String[]> rows = new ArrayList<String[]>();

            while((line=reader.readLine())!=null) 
            {String[] row = line.split("\\s+");
            rows.add(row);

                }
            for (String[] row : rows) {
                System.out.println(Arrays.toString(row));
                return rows;
                }   

} catch (IOException e) {
}
    return null;
}
} 
```

因为我希望在另一个课程中使用它。第二类目前看起来像这样：

```
public class mean extends reader{

public static void main(String[] args) {
    reader newarray = new reader();

}

} 
```

有人可以告诉我我做错了什么吗？每当我尝试返回行时，我都会收到一条错误消息，指出 void 方法无法返回值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:40:20.980

你没有在你的`reader`对象中创建一个方法来返回一些东西。创建一个方法签名，如下所示：

```
public ArrayList<String[]> getRows() {
    // Rest of your code here.
} 
```

# jquery-mobile - 与 Jquery 移动嵌套列表不一致的页面主题

> ID：10693580
> 
> 赞同：0
> 
> 时间：2012-05-21T22:38:40.087
> 
> 标签：jquery-mobile, nested-lists

在 jquery mobile 我有一个嵌套列表。当嵌套列表出现时，页面与前一页不同。显示列表“1.html”的页面是：data-theme="a"，带有漂亮的页眉和页脚。嵌套列表看起来像 data-theme="d"，没有页脚并且有一个后退按钮 - 我更喜欢自定义按钮？无论如何要解决此问题，以便嵌套列表页面与其父页面一致？谢谢 ：-）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:11:28.413

一个错误？您使用的是什么版本的 jQuery Mobile？从 1.1.0 版开始，默认情况下禁用标题中的后退按钮。查看此示例[http://jquerymobile.com/demos/1.1.0/docs/lists/lists-nested.html](http://jquerymobile.com/demos/1.1.0/docs/lists/lists-nested.html)

关于您关于按钮、页脚和主题的第二个问题。

要呈现按钮，您需要做的就是将`data-role="button"`主题添加`data-theme="a"`到这样的链接中

```
<a href="index.html" data-role="button" data-theme="a">Link button</a> 
```

要创建页脚，您需要在页面 div 中放置以下内容：

```
<div data-role="footer">
    <h4>Footer content</h4>
</div><!-- /footer --> 
```

作为演示，这是一个应用了主题*e*的页面：

```
<div data-role="page" data-theme="e">

    <div data-role="header" data-theme="e">
        <h1>Single page</h1>
    </div><!-- /header -->

    <div data-role="content">    
        <p>Some text here</p>
        <a href="index.html" data-role="button">Link button</a>       
    </div><!-- /content -->

    <div data-role="footer" data-theme="e">
        <h4>Footer content</h4>
    </div><!-- /footer -->

</div><!-- /page --> 
```

作为提示，您可以在此处查看示例[http://jquerymobile.com/demos/1.1.0/](http://jquerymobile.com/demos/1.1.0/)并通过在浏览器中选择“查看页面源代码”来研究代码。这就是我现在学习JQM的方式。

# php - 使用 jQuery post() 的 PHP 代码没有响应

> ID：10693583
> 
> 赞同：0
> 
> 时间：2012-05-21T22:39:12.947
> 
> 标签：php, javascript, jquery, post

我正在尝试从读取 mySQL 数据库的 PHP 文件中检索数据。数据在浏览器上很好：

[http://www.primaryaccess.org/REST/geteasyfile.php?id=25](http://www.primaryaccess.org/REST/geteasyfile.php?id=25)

但是当我尝试使用 jQuery 的 get() 或 post() 方法访问它时，我没有得到任何响应。Firebug 中的响应标头说有正确数量的数据，但没有显示：

```
$.get("http://www.primaryaccess.org/REST/geteasyfile.php?id=25",function(data) { alert(data); }); 
```

这是PHP：

```
<?
$id=$_GET['id'];
$query="SELECT * FROM easyfile WHERE id = '$id'";
$result=mysql_query($query);
mysql_close();
if (($result == false) || (!mysql_numrows($result)))
    echo "Can't load file!";
else    
    echo mysql_result($result,0,"data");
?> 
```

谢谢！

账单

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:40:42.167

可能你的问题出在 url，你已经设置了 id=25 然后你连接了 id 变量

希望这有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:44:59.037

尝试[getJSON](http://api.jquery.com/jQuery.getJSON/)并替换`alert()`为`console.log()`. 此外，您的 URL 看起来很奇怪 ( `'id=25' + id`)。我希望你也注意到 JS 中有一个[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，所以你需要将你的测试文件上传到指定的域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T23:16:03.180

尝试使用 json 回调

JS

```
$.ajax({
  url: "http://www.primaryaccess.org/REST/geteasyfile.php?id=25&jsoncallback=?",
  success: function(data) {
    alert(data)
  },
  error: function(error){
    alert(JSON.stringify(error));
  }
}); 
```

PHP

```
<?
$id=$_GET['id'];
$query="SELECT * FROM easyfile WHERE id = '$id'";
$result=mysql_query($query);
mysql_close();
if (($result == false) || (!mysql_numrows($result)))
    $result = "Can't load file!";
else    
    $result = mysql_result($result,0,"data");

$result = array('result' => $result);

echo $_GET['jsoncallback'] . '(' . json_encode($result) . ');'

?> 
```

# jquery - 阻止默认在 Google Chrome 上工作，但在 Firefox 上不工作element 因此，如果您尝试以下代码：http://jsfiddle.net/LNfZT/29/ 它在 Chrome 上完美运行，但在 firefox 上却完全不运行。有谁知道为什么？只需将选项添加到您的元素选择器 - 并返回 false；在你的代码中。$('select[id="selectID"] option').on('keydown',function(e){ e.preventDefault();

> ID：10693585
> 
> 赞同：1
> 
> 时间：2012-05-21T22:39:17.497
> 
> 标签：jquery

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:23:50.587

它是由多种因素共同造成的。

第一个问题是 Firefox 在您执行此操作之前附加了它的事件侦听器，因此您没有机会阻止默认操作。

第二个是 Firefox 中的一个[错误](https://bugzilla.mozilla.org/show_bug.cgi?id=291082)，它不会检查默认操作是否被阻止。

您可以通过在事件到达之前捕获事件`<select>`并停止其传播来解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:45:33.727

只需添加`option`到您的元素选择器 - 并`return false;`在您的代码中。

```
$('select[id="selectID"] option').on('keydown',function(e){
    e.preventDefault();
    return false;
}); 
```

## *[演示](http://jsfiddle.net/roXon/AQjjA/1/)*

# file-upload - Fileupload Primefaces 中的最大文件数

> ID：10693588
> 
> 赞同：3
> 
> 时间：2012-05-21T22:39:29.963
> 
> 标签：file-upload, jsf-2, primefaces

我用这个参数设置了我的 FileUpload 组件：

```
 <p:fileUpload label="Select image"  
                    mode="advanced"  
                    update="messages"  
                    fileUploadListener="#{fileUploadController.handleFileUpload}"
                    sizeLimit="1000000"   
                    fileLimit="1"
                    fileLimitMessage="Only 1 image"
                    allowTypes="/(\.|\/)(gif|jpe?g|png)$/"/> 

  <p:growl id="messages" showDetail="true"/> 
```

但是，如果我选择更多图像，我不会收到任何错误或警告。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T18:55:43.490

我重现了相同的行为，但我认为这不是故意的。如果您使用，您可以做一些解决方法，`auto="true"`因为文件将立即上传。另一方面，您可以确保您的支持 bean 只是在处理上载的**最后一个**文件（也许用户首先选择了错误的文件并想要使用另一个文件？）。

`fileLimit="1"`仅在使用`mode="advanced"`and时限制文件限制`multiple="true"`（参见 [1]），但目前 primefaces 不支持（参见 [2]）。

[1] [http://forum.primefaces.org/viewtopic.php?f=3&t=14194](http://forum.primefaces.org/viewtopic.php?f=3&t=14194)

[2] [https://www.primefaces.org/docs/guide/primefaces_user_guide_6_1.pdf](https://www.primefaces.org/docs/guide/primefaces_user_guide_6_1.pdf)第 218 页

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-25T17:08:30.313

我遇到了同样的问题。为了解决这个问题，我尝试了 update="@this"

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T06:13:22.410

fileLimit 属性在我的情况下也不起作用。我尝试了 mode="advanced" 和 multiple="true"。就我而言，我想将要上传的文件限制为 3。但这并不限制我上传更多文件。

# iphone - 一个好的、简单的、软调制解调器库的来源

> ID：10693590
> 
> 赞同：10
> 
> 时间：2012-05-21T22:40:16.910
> 
> 标签：iphone, signal-processing, modem

我正在做一个奇怪的项目，并希望将一些简短的数据报转换为音频 - 通过（物理）无线电发送它们 - 然后在另一台设备上接收和解码它们（想想 - 带有音频输出插孔和 GSM/GPRS 的嵌入式设备型收音机）。

（我*必须*使用物理的、现有的外部收音机）。

有谁知道适合这样一个项目的好的、*简单*的软件调制解调器库？我不太关心数据速率，并且更喜欢简单而不是功能。即使是类似于基本的 1200 波特调制解调器的东西也会很棒。

看这更多的是一种学习经验和潜在的构建块，而不是任何非常实用的东西。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-14T02:49:43.420

作为练习，我使用 FSK 调制实现了一个简单的类似 V.23 的调制解调器，并支持 1200 位/秒的数据速率（由于开始位和停止位，960 位/秒有效）。

我很好奇它是否适用于您的收音机。噪声、信号反射和不完善的解调都会影响调制解调器的性能。

在尝试将此代码集成到您的项目中之前，请先查看它是否适用于从您的收音机录制的音频。

代码：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <limits.h>
#include <math.h>

#ifndef M_PI
#define M_PI 3.14159265358979324
#endif

typedef unsigned char uchar, uint8;
typedef signed char schar, int8;
typedef unsigned short ushort, uint16;
typedef short int16;
typedef unsigned int uint;
typedef unsigned long ulong;
#if UINT_MAX >= 0xFFFFFFFF
typedef int int32;
typedef unsigned int uint32;
#else
typedef long int32;
typedef unsigned long uint32;
#endif
typedef long long int64;
typedef unsigned long long uint64;

typedef struct
{
  double x, y;
} tComplex;

tComplex complexAdd(const tComplex* a, const tComplex* b)
{
  tComplex c;
  c.x = a->x + b->x;
  c.y = a->y + b->y;
  return c;
}

tComplex complexMul(const tComplex* a, const tComplex* b)
{
  tComplex c;
  c.x = a->x * b->x - a->y * b->y;
  c.y = a->x * b->y + a->y * b->x;
  return c;
}

void dft(tComplex out[], const tComplex in[], size_t n, int direction)
{
  size_t k, i;
  for (k = 0; k < n; k++)
  {
    tComplex r = { 0, 0 }, e;
    for (i = 0; i < n; i++)
    {
      e.x = cos(-2 * direction * M_PI / n * ((double)k - n / 2) * ((double)i - n / 2));
      e.y = sin(-2 * direction * M_PI / n * ((double)k - n / 2) * ((double)i - n / 2));
      e = complexMul(&e, &in[i]);
      r = complexAdd(&r, &e);
    }
    out[k] = r;
  }
}

#define FILTER_LENGTH 64

typedef struct tTx
{
  enum
  {
    stSendingOnes,
    stSendingData
  } State;

  uint SampleRate;
  uint OnesFreq;
  uint ZeroesFreq;
  uint BitRate;

  uint32 SampleCnt;
  uint BitSampleCnt;
  uint Data;
  uint DataLeft;

  double Phase;
  double PhaseIncrement;

  uint (*pTxGetDataCallBack)(struct tTx*, uint8*);
} tTx;

void TxInit(tTx* pTx,
            uint SampleRate,
            uint (*pTxGetDataCallBack)(tTx*, uint8*))
{
  memset(pTx, 0, sizeof(*pTx));
  pTx->State = stSendingOnes;
  pTx->SampleRate = SampleRate;
  pTx->OnesFreq = 1300;
  pTx->ZeroesFreq = 2100;
  pTx->BitRate = 1200;
  pTx->pTxGetDataCallBack = pTxGetDataCallBack;

  pTx->SampleCnt = 0;
  pTx->BitSampleCnt = pTx->SampleRate;
  pTx->Data = 0;
  pTx->DataLeft = 0;
  pTx->Phase = 0.0;
  pTx->PhaseIncrement = 2 * M_PI * pTx->OnesFreq / pTx->SampleRate;
}

int16 TxGetSample(tTx* pTx)
{
  int16 sample;

  if (pTx->State == stSendingOnes &&
      pTx->SampleCnt >= pTx->SampleRate)
  {
    // Sent 1 second worth of 1's, can now send data
    pTx->State = stSendingData;
  }

  if (pTx->State == stSendingData &&
      pTx->BitSampleCnt >= pTx->SampleRate)
  {
    // Another data bit can now be sent
    uint8 d;

    pTx->BitSampleCnt -= pTx->SampleRate;

    if (!pTx->DataLeft)
    {
      // Get the next data byte (if any)
      if (pTx->pTxGetDataCallBack(pTx, &d) != 0)
      {
        pTx->Data = d & 0xFF;
        pTx->Data |= 1 << 8; // insert the stop bit
        pTx->Data <<= 1; // insert the start bit
        pTx->DataLeft = 10;
      }
      else
      {
        pTx->Data = 0x3FF; // no data, send 10 1's
        pTx->DataLeft = 10;
      }
    }

    // Extract the next data bit to send
    d = pTx->Data & 1;
    pTx->Data >>= 1;
    pTx->DataLeft--;

    // Choose the appropriate frequency for 0 and 1
    if (d)
    {
      pTx->PhaseIncrement = 2 * M_PI * pTx->OnesFreq / pTx->SampleRate;
    }
    else
    {
      pTx->PhaseIncrement = 2 * M_PI * pTx->ZeroesFreq / pTx->SampleRate;
    }
  }

  // Generate the next sample, advance the generator's phase
  sample = (int16)(16000 * cos(pTx->Phase));
  pTx->Phase += pTx->PhaseIncrement;
  if (pTx->Phase >= 2 * M_PI)
  {
    pTx->Phase -= 2 * M_PI;
  }

  if (pTx->State == stSendingData)
  {
    pTx->BitSampleCnt += pTx->BitRate;
  }

  pTx->SampleCnt++;

  return sample;
}

typedef struct tRx
{
  enum
  {
    stCarrierLost,
    stCarrierDetected,
    stReceivingData
  } State;

  uint SampleRate;
  uint OnesFreq;
  uint ZeroesFreq;
  uint MidFreq;
  uint BitRate;

  uint32 SampleCnt;
  uint BitSampleCnt;
  uint Data;

  double Phase;
  double PhaseIncrement;

  tComplex Filter[FILTER_LENGTH];
  double Delay[FILTER_LENGTH];

  double LastAngle;
  int LastDelta;
  int32 Deltas;

  int32 CarrierAngle;
  int32 CarrierCnt;

  double LongAvgPower;
  double ShortAvgPower;

  void (*pRxGetDataCallBack)(struct tRx*, uint8);
} tRx;

void RxInit(tRx* pRx,
            uint SampleRate,
            void (*pRxGetDataCallBack)(struct tRx*, uint8))
{
  tComplex tmp[FILTER_LENGTH];
  uint i;

  memset(pRx, 0, sizeof(*pRx));
  pRx->State = stCarrierLost;
  pRx->SampleRate = SampleRate;
  pRx->OnesFreq = 1300;
  pRx->ZeroesFreq = 2100;
  pRx->MidFreq = (pRx->OnesFreq + pRx->ZeroesFreq) / 2;
  pRx->BitRate = 1200;
  pRx->pRxGetDataCallBack = pRxGetDataCallBack;

  pRx->SampleCnt = 0;
  pRx->BitSampleCnt = 0;
  pRx->Data = 0x3FF;
  pRx->Phase = 0.0;
  pRx->PhaseIncrement = 2 * M_PI * pRx->MidFreq / pRx->SampleRate;
  pRx->LastAngle = 0.0;
  pRx->LastDelta = 0;
  pRx->Deltas = 0;
  pRx->CarrierAngle = 0;
  pRx->CarrierCnt = 0;
  pRx->LongAvgPower = 0.0;
  pRx->ShortAvgPower = 0.0;

  for (i = 0; i < FILTER_LENGTH; i++)
  {
    pRx->Delay[i] = 0.0;
  }

  for (i = 0; i < FILTER_LENGTH; i++)
  {
    if (i == 0) // w < 0 (min w)
    {
      pRx->Filter[i].x = 0;
      pRx->Filter[i].y = 0;
    }
    else if (i < FILTER_LENGTH / 2) // w < 0
    {
      pRx->Filter[i].x = 0;
      pRx->Filter[i].y = 0;
    }
    else if (i == FILTER_LENGTH / 2) // w = 0
    {
      pRx->Filter[i].x = 0;
      pRx->Filter[i].y = 0;
    }
    else if (i > FILTER_LENGTH / 2) // w > 0
    {
      pRx->Filter[i].x = 0;
      pRx->Filter[i].y = -1;

      // Extra filter to combat channel noise
      if (i - FILTER_LENGTH / 2 < 875UL * FILTER_LENGTH / pRx->SampleRate ||
          i - FILTER_LENGTH / 2 > (2350UL * FILTER_LENGTH + pRx->SampleRate - 1) / pRx->SampleRate)
      {
        pRx->Filter[i].y = 0;
      }
    }
  }

  memcpy(tmp, pRx->Filter, sizeof(tmp));
  dft(pRx->Filter, tmp, FILTER_LENGTH, -1);
}

#define RX_VERBOSE 0
void RxGetSample(tRx* pRx, int16 Sample)
{
  tComplex s = { 0.0, 0.0 }, ss;
  double angle;
  uint i;
  int delta;
  double pwr;

  // Insert the sample into the delay line
  memmove(&pRx->Delay[0], &pRx->Delay[1], sizeof(pRx->Delay) - sizeof(pRx->Delay[0]));
  pRx->Delay[FILTER_LENGTH - 1] = Sample;

  // Get the next analytic signal sample by applying Hilbert transform/filter
  for (i = 0; i < FILTER_LENGTH; i++)
  {
    s.x += pRx->Delay[i] * pRx->Filter[FILTER_LENGTH - 1 - i].x;
    s.y += pRx->Delay[i] * pRx->Filter[FILTER_LENGTH - 1 - i].y;
  }

  // Frequency shift by MidFreq down
  ss.x = cos(-pRx->Phase);
  ss.y = sin(-pRx->Phase);
  s = complexMul(&s, &ss);
  pRx->Phase += pRx->PhaseIncrement;
  if (pRx->Phase >= 2 * M_PI)
  {
    pRx->Phase -= 2 * M_PI;
  }

  // Calculate signal power
  pwr = (s.x * s.x + s.y * s.y) / 32768 / 32768;
  pRx->LongAvgPower *= 1 - pRx->BitRate / (pRx->SampleRate * 8.0 * 8);
  pRx->LongAvgPower += pwr;
  pRx->ShortAvgPower *= 1 - pRx->BitRate / (pRx->SampleRate * 8.0);
  pRx->ShortAvgPower += pwr;

#if 0
  printf("LongAvgPower:%f ShortAvgPower:%f\n", pRx->LongAvgPower, pRx->ShortAvgPower);
#endif

  // Disconnect if the signal power changes abruptly.
  if (pRx->State != stCarrierLost &&
      pRx->LongAvgPower > pRx->ShortAvgPower * 8 * 8)
  {
    // N.B. The receiver may have received a few extra (garbage) bytes
    // while demodulating the abruptly changed signal.
    // Prefixing data with its size or using a more advanced protocol
    // may be a good solution to this little problem.
    pRx->State = stCarrierLost;
    pRx->BitSampleCnt = 0;
    pRx->Data = 0x3FF;
    pRx->Phase = 0.0;
    pRx->LastAngle = 0.0;
    pRx->LastDelta = 0;
    pRx->Deltas = 0;
    pRx->CarrierAngle = 0;
    pRx->CarrierCnt = 0;
  }

  // Get the phase angle from the analytic signal sample
  angle = (fpclassify(s.x) == FP_ZERO && fpclassify(s.y) == FP_ZERO) ?
    0.0 : 180 / M_PI * atan2(s.y, s.x);
  // Calculate the phase angle change and force it to the -PI to +PI range
  delta = (int)(360.5 + angle - pRx->LastAngle) % 360;
  if (delta > 180) delta -= 360;

  if (pRx->State == stCarrierLost)
  {
    // Accumulate the phase angle change to see if we're receiving 1's
    pRx->CarrierAngle += delta;
    pRx->CarrierCnt++;

    // Check whether or not the phase corresponds to 1's
    if (delta < 0)
    {
      if (pRx->CarrierCnt >= pRx->SampleRate / pRx->OnesFreq * 8)
      {
        double ph = (double)pRx->CarrierAngle / pRx->CarrierCnt;
#if RX_VERBOSE
        printf("ca:%5ld, cc:%4ld, ca/cc:%4ld\n",
               (long)pRx->CarrierAngle,
               (long)pRx->CarrierCnt,
               (long)(pRx->CarrierAngle / pRx->CarrierCnt));
#endif
        // Frequency tolerance is +/-16 Hz per the V.23 spec
        if (ph < (pRx->OnesFreq - 17.0 - pRx->MidFreq) * 360.0 / pRx->SampleRate ||
            ph > (pRx->OnesFreq + 17.0 - pRx->MidFreq) * 360.0 / pRx->SampleRate)
        {
          goto BadCarrier;
        }
      }
    }
    else
    {
BadCarrier:
      // Phase doesn't correspond to 1's
      pRx->CarrierAngle = 0.0;
      pRx->CarrierCnt = 0;
    }

    if (pRx->CarrierCnt >= pRx->SampleRate / 2 + pRx->SampleRate / 4)
    {
      // 0.75 seconds worth of 1's have been detected, ready to receive data

      // Adjust MidFreq to compensate for the DAC and ADC sample rate difference
      double f1 = (double)pRx->CarrierAngle / pRx->CarrierCnt / 360 * pRx->SampleRate + pRx->MidFreq;
      pRx->MidFreq = (uint)(pRx->MidFreq * f1 / pRx->OnesFreq);
      pRx->PhaseIncrement = 2 * M_PI * pRx->MidFreq / pRx->SampleRate;
#if RX_VERBOSE
      printf("f1:%u, new MidFreq:%u\n", (uint)f1, pRx->MidFreq);
#endif
      pRx->State = stCarrierDetected;
    }
  }
  else
  {
    // Detect frequency changes (transitions between 0's and 1's)
    int freqChange = ((int32)pRx->LastDelta * delta < 0 || pRx->LastDelta && !delta);
    int reAddDelta = 0;

#if RX_VERBOSE
    printf("%6lu: delta:%4d freqChange:%d BitSampleCnt:%u\n",
           (ulong)pRx->SampleCnt,
           delta,
           freqChange,
           pRx->BitSampleCnt);
#endif

    // Synchronize with 1<->0 transitions
    if (freqChange)
    {
      if (pRx->BitSampleCnt >= pRx->SampleRate / 2)
      {
        pRx->BitSampleCnt = pRx->SampleRate;
        pRx->Deltas -= delta;
        reAddDelta = 1;
      }
      else
      {
        pRx->BitSampleCnt = 0;
        pRx->Deltas = 0;
      }
    }

    // Accumulate analytic signal phase angle changes
    // (positive for 0, negative for 1)
    pRx->Deltas += delta;

    if (pRx->BitSampleCnt >= pRx->SampleRate)
    {
      // Another data bit has accumulated
      pRx->BitSampleCnt -= pRx->SampleRate;

#if RX_VERBOSE
      printf("bit: %u\n", pRx->Deltas < 0);
#endif

      pRx->Data >>= 1;
      pRx->Data |= (pRx->Deltas < 0) << 9;
      pRx->Deltas = delta * reAddDelta;

      if ((pRx->Data & 0x201) == 0x200)
      {
        // Start and stop bits have been detected
        if (pRx->State == stCarrierDetected)
        {
          pRx->State = stReceivingData;
        }
        pRx->Data = (pRx->Data >> 1) & 0xFF;
        pRx->pRxGetDataCallBack(pRx, (uint8)pRx->Data);

#if RX_VERBOSE
        printf("byte: 0x%02X ('%c')\n",
               pRx->Data,
               (pRx->Data >= 0x20 && pRx->Data <= 0x7F) ? pRx->Data : '?');
#endif

        pRx->Data = 0x3FF;
      }
    }

    pRx->BitSampleCnt += pRx->BitRate;
  }

  pRx->LastAngle = angle;
  pRx->LastDelta = delta;
  pRx->SampleCnt++;
}

typedef struct
{
  tTx Tx;
  FILE* DataFile;
  int CountDown;
} tTxTest;

uint TxGetDataCallBack(tTx* pTx, uint8* pTxData)
{
  tTxTest* pTxTest = (tTxTest*)pTx;
  uchar c;

  if (pTxTest->CountDown)
  {
    pTxTest->CountDown--;
    return 0;
  }

  if (fread(&c, 1, 1, pTxTest->DataFile) != 1)
  {
    pTxTest->CountDown = 20;
    return 0;
  }

  *pTxData = c;
  return 1;
}

int testTx(uint SampleRate,
           double NoiseLevel,
           const char* DataFileName,
           const char* AudioFileName)
{
  FILE *fData = NULL, *fAudio = NULL;
  int err = EXIT_FAILURE;
  tTxTest txTest;

  if ((fData = fopen(DataFileName, "rb")) == NULL)
  {
    printf("Can't open file \"%s\"\n", DataFileName);
    goto Exit;
  }

  if ((fAudio = fopen(AudioFileName, "wb")) == NULL)
  {
    printf("Can't create file \"%s\"\n", AudioFileName);
    goto Exit;
  }

  txTest.DataFile = fData;
  txTest.CountDown = 0;

  TxInit(&txTest.Tx,
         SampleRate,
         &TxGetDataCallBack);

  do
  {
    int16 sample = TxGetSample(&txTest.Tx);
    if (txTest.CountDown > 1 && txTest.CountDown <= 10)
    {
#if 0 // Enable this code to test disconnecting.
      // Finish with silence.
      sample = 0;
#endif
    }
    sample += (rand() - (int)RAND_MAX / 2) * NoiseLevel * 16000 / (RAND_MAX / 2);
    fwrite(&sample, 1, sizeof(sample), fAudio);
  } while (txTest.CountDown != 1); // Drain all data-containing samples

  err = EXIT_SUCCESS;

Exit:

  if (fData != NULL) fclose(fData);
  if (fAudio != NULL) fclose(fAudio);

  return err;
}

typedef struct
{
  tRx Rx;
  FILE* DataFile;
} tRxTest;

void RxGetDataCallBack(tRx* pRx, uint8 RxData)
{
  tRxTest* pRxTest = (tRxTest*)pRx;
  uchar c = RxData;
  fwrite(&c, 1, 1, pRxTest->DataFile);
}

int testRx(uint SampleRate,
           const char* AudioFileName,
           const char* DataFileName)
{
  uint lastState;
  FILE *fAudio = NULL, *fData = NULL;
  int err = EXIT_FAILURE;
  tRxTest rxTest;

  if ((fAudio = fopen(AudioFileName, "rb")) == NULL)
  {
    printf("Can't open file \"%s\"\n", AudioFileName);
    goto Exit;
  }

  if ((fData = fopen(DataFileName, "wb")) == NULL)
  {
    printf("Can't create file \"%s\"\n", DataFileName);
    goto Exit;
  }

  rxTest.DataFile = fData;

  RxInit(&rxTest.Rx,
         SampleRate,
         &RxGetDataCallBack);

  for (;;)
  {
    int16 sample;

    if (fread(&sample, 1, sizeof(sample), fAudio) != sizeof(sample))
    {
      if (rxTest.Rx.State != stCarrierLost) goto NoCarrier;
      break;
    }

    lastState = rxTest.Rx.State;
    RxGetSample(&rxTest.Rx, sample);

    if (rxTest.Rx.State != lastState && rxTest.Rx.State == stCarrierDetected)
    {
      printf("\nCONNECT %u\n\n", rxTest.Rx.BitRate);
    }

    if (rxTest.Rx.State != lastState && rxTest.Rx.State == stCarrierLost)
    {
NoCarrier:
      printf("\n\nNO CARRIER\n");
      break;
    }
  }

  err = EXIT_SUCCESS;

Exit:

  if (fAudio != NULL) fclose(fAudio);
  if (fData != NULL) fclose(fData);

  return err;
}

int main(int argc, char* argv[])
{
  uint sampleRate;
  double noiseLevel;

  if (argc < 2 ||
      !stricmp(argv[1], "-help") ||
      !stricmp(argv[1], "/help") ||
      !stricmp(argv[1], "-?") ||
      !stricmp(argv[1], "/?"))
  {
Usage:
    printf("Usage:\n\n"
           "  %s tx <sample rate> <noise level> <data input file> <PCM output file>\n"
           "  %s rx <sample rate> <PCM input file> <data output file>\n",
           argv[0],
           argv[0]);
    return 0;
  }

  if (!stricmp(argv[1], "tx") &&
      argc == 6 &&
      sscanf(argv[2], "%u", &sampleRate) == 1 &&
      sscanf(argv[3], "%lf", &noiseLevel) == 1)
  {
    return testTx(sampleRate, noiseLevel, argv[4], argv[5]);
  }
  else if (!stricmp(argv[1], "rx") &&
           argc == 5 &&
           sscanf(argv[2], "%u", &sampleRate) == 1)
  {
    return testRx(sampleRate, argv[3], argv[4]);
  }
  else
  {
    goto Usage;
  }
} 
```

典型用法：

```
modem.exe tx 8000 0.2 testin.txt test8000.pcm
modem.exe rx 8000 test8000.pcm testout.txt 
```

生成的 testout.txt 应该与 testin.txt 相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T00:56:41.233

网络搜索会发现很多业余无线电 BPSK 和 RTTY/FSK 解决方案。大部分代码是为较慢的较旧 CPU 编写的，因此在 iPhone 上应该可以正常运行。您可以使用 Audio Queue API 或 RemoteIO Audio Unit for iOS 音频 IO 到编解码器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-12T05:14:45.937

如果您仍在寻找软调制解调器，您可以考虑[libquiet](https://github.com/brian-armstrong/quiet)或[Quiet.js](https://github.com/brian-armstrong/quiet-js)。如果您使用音频电缆，它们提供了功能相当强大的低功耗 GMSK 模式以及更高的比特率模式。Quiet 使用现有的 SDR 库来执行其调制，因此您将获得功能非常齐全的东西。

# c# - 向动作方法发送参数

> ID：10693594
> 
> 赞同：2
> 
> 时间：2012-05-21T22:40:44.440
> 
> 标签：c#, asp.net, asp.net-mvc-3, razor

目前我有这个代码：

```
@using (Html.BeginForm("Add", "Review", "Review"))
{
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>Review</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.TEKST)
        </div>
         <div class="editor-field">
            @Html.TextBoxFor(model => model.TEKST)
        </div>

        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
} 
```

这会将我发送到：localhost:4470/Review/Add?Length=6 我真正想要的是这个 url：localhost:4470/Review/Add?tekst=sdfsdf

如何修改此代码以使用“tekst”作为参数而不是长度？并将文本框的内容作为值。

更新：这是我的行动方法：

```
public ActionResult Create()
{
    return View();
}

public ActionResult Add(string tekst)
{
    ViewBag.test = tekst;
    return View();
} 
```

在 Create 的 View 页面中，我想要一个带有文本框或 textarea 的表单，它向 Add 发送操作，文本框或 textarea 的内容应该在操作方法“Add”的参数“tekst”中

解决方案：参见 CD Smith 的帖子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:04:51.263

我不确定“Length = 6”来自哪里，因为我看不到您的代码的哪一部分会创建该 URL ...

在我看来，您期待 GET 请求，但（默认情况下）表单将导致 POST 请求。根据您的代码，我希望生成的路由是“localhost:4470/Review/Add”。无论表单的内容是什么，都将作为表单数据发送。

因此，在您的控制器中，如果您的操作方法如下所示：

```
[HttpPost]
[ActionName("Add")]
public ActionResult AddViaPost(string tekst)
{
    // do something with tekst
} 
```

然后您应该将文本框的值正确发布到您的控制器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T23:09:37.630

我不确定您的操作是什么样的，但只要它接受您的模型，您的模型中就有 TEKST 的价值。

如果您需要不同的东西，那么您的 View 也需要不同，您从视图中发布模型，不要通过发布 POST 来发送 GET 参数

您当前是否有将 TEKST 作为参数的操作？

## **更新**

好的，看看你的动作......你不需要修改你的视图，你需要修改你的动作，试试这个，这会让你得到你想要的。

更改`YourModelTypeHere`以匹配您的真实模型类型

```
[HttpPost]
public ActionResult Create(YourModelTypeHere model)
{
    return RedirectToAction("Add", new { tekst = model.tekst });
}

public ActionResult Add(string tekst) 
{
    ViewBag.test = tekst;
    return View();
} 
```

您只需稍微修改一下视图 - 从 BeginForm 标记中删除参数

```
@using (Html.BeginForm()) 
```

因此，该`Create`操作将呈现`Create`视图，然后 POST 回`Create`具有`[HttpPost]`注释的方法。然后 的值`TEKST`将作为参数发送给`Add`方法作为 a`RedirectToAction`并渲染`Add`视图

# mysql - 经典 ASP mysql INSERT 获取结果 对象关闭时不允许操作

> ID：10693598
> 
> 赞同：1
> 
> 时间：2012-05-21T22:40:49.777
> 
> 标签：mysql, asp-classic

我有这个代码：

```
Set oConnection = Server.CreateObject("ADODB.Connection")
Set oRecordset = Server.CreateObject("ADODB.Recordset")

oConnection.Open "DRIVER={MySQL ODBC 5.1 Driver};SERVER=localhost;UID=xxxx;PWD=xxxx;DATABASE=xxxx; OPTION=3;"
    Sqltemp = "INSERT INTO rsvptable (fname, lname, fbid, rsvp, streetaddress, city, state, zip, streetaddress2, cellphone, acode) " & _
              "VALUES ('" & firstName & "', '" & lastName & "', " & fb & ", 0, '" & address1 & "', '" & city & "', '" & strState & "', " & zip & ", '" & address2 & "', " & cell & ", " & returnedNums & ")"

set newAdd = oConnection.execute(Sqltemp)

if newAdd.EOF then
   response.write "end"
else
   response.write "not end"
end if 
```

它一直告诉我：

> ADODB.Recordset 错误“800a0e78”
> 
> 对象关闭时不允许操作。
> 
> /add.asp，第 136 行

第 136 行是这样的：

```
if newAdd.EOF then 
```

我会在这里俯瞰什么？

**更新**

在这里找到了我的答案！:o)

[如何判断数据库更新是否成功？](https://stackoverflow.com/questions/6878577/how-to-tell-if-a-db-update-was-successful)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:46:42.037

[http://www.w3schools.com/ado/met_conn_execute.asp](http://www.w3schools.com/ado/met_conn_execute.asp)

> 如果是行返回查询，结果将存储在新的 Recordset 对象中。如果不是行返回查询，则将返回已关闭的 Recordset 对象。

INSERT 不是返回行的查询，因此它返回一个封闭的记录集，因此您不能`.EOF`这样做。检查 Rows Affected bu 将变量作为第二个参数传递给`Execute`. 如果 RowsAffected 为 1，那么您就设置好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:49:38.217

两件事情：

1.  您定义`oRecordset`为记录集，然后使用 & 检查 eof`newAdd`
2.  为什么要尝试从插入查询中填充记录？

# windows-8 - 从旧的后台线程使用 CoreDispatcher::RunAsync

> ID：10693600
> 
> 赞同：2
> 
> 时间：2012-05-21T22:41:17.853
> 
> 标签：windows-8, windows-runtime

我正在使用 WRL 将常规 C++ 应用程序移植到 C++ 中的 Metro。我有一个现有的线程池，并且在某些时候我需要从这些线程之一更新 UI。

直接触摸 UI 对象会产生预期的 RPC_E_WRONG_THREAD，因此我需要以某种方式在正确的线程中执行。查看 MSDN，我发现 Metro Dispatcher (CoreDispatcher) 有一个 RunAsync 方法。

Larry Osterman 在这里回答了如何使用它的问题： [Run code on UI thread in WinRT](https://stackoverflow.com/questions/10579027/run-code-on-ui-thread-in-winrt)

但不清楚的是，我是否可以从非 winrt 线程（即未调用 RoInitialize 的线程）执行此操作。

我想更准确地说，我担心调度程序可能属于 STA，我需要以某种方式编组接口，以便从我的其他线程调用是安全的。

请注意，我的应用程序在 msdn 示例之后的 main() 函数调用 RoInitialize(RO_INIT_MULTITHREADED)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T05:08:54.647

您应该可以从非 UI 线程调用 CoreDispatcher::RunAsync。但有几点需要注意：1）您需要使用 Metro 风格的应用程序（这应该不言而喻）。原因是应用程序对象创建了一个在应用程序生命周期中存在的 MTA。COM 有一个称为隐式 MTA 的漂亮特性——如果 MTA 存在于您的进程中，则任何线程都被视为该 MTA 的一部分，即使它们没有调用 CoInitialize。

这意味着当您访问 CoreDispatcher::RunAsync 时，即使您需要代理对象，MTA 也是活动的，因此编组应该成功。

请注意，在应用程序启动期间有一段时间可能尚未创建应用程序对象 - 在执行应用程序代码之前，您应该避免做任何事情。

2）您需要在您要使用的 UI 线程上捕获 CoreDispatcher 对象。[由于 Xaml 基础结构已经在DependencyObject](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.dependencyobject.aspx)中捕获了调度程序，这一点变得更加容易。因此，如果您已经拥有 Xaml UI 元素，则只需调用 .Dispatcher.RunAsync()。

PS：UI线程在ASTA（应用程序STA，Win8中新增的一种公寓）上，但是调度器是线程敏捷的。请注意，虽然调度程序是敏捷的，但不应将 CoreWindow 视为敏捷。

# haskell - Haskell 语义未定义值

> ID：10693601
> 
> 赞同：3
> 
> 时间：2012-05-21T22:41:48.593
> 
> 标签：haskell, undefined, semantics

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T22:57:56.137

# php - PHP How to find if 2 dates are equal

> ID：10693605
> 
> 赞同：3
> 
> 时间：2012-05-21T22:42:28.750
> 
> 标签：php

I have a date field that submits the chosen dates and I want to find out if the end date is today.

So for example I want to compare 21-May-2012(today) to 21-May-2012(submitted) and see if they match or not.

Can someone please help?

Thanks in advance

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-21T22:44:50.560

```
if ( strtotime($current) != strtotime($sumbit) ) 
```

Or just simplier:

```
$currentDate  = '21-May-2012';
$submit = '21-May-2012';

if ($submit != $currentDate)
  echo 'Different'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-03T14:18:10.637

```
$currentDate  = '21-May-2012';
$submitDate = '21-May-2012';

if ($submitDate == $currentDate)
  echo 'Same';
else
  echo 'Different'; 
```

# awk - 有没有办法完全删除 awk 中的字段，以便不打印额外的分隔符？

> ID：10693608
> 
> 赞同：18
> 
> 时间：2012-05-21T22:42:50.747
> 
> 标签：awk

考虑以下命令：

```
$ gawk -F"\t" "BEGIN{OFS=\"\t\"}{$2=$3=\"\"; print $0}" Input.tsv 
```

当我设置`$2 = $3 = ""`时，预期的效果是获得与写作相同的效果：

```
print $1,$4,$5...$NF 
```

然而，实际发生的是我得到了两个空字段，额外的字段分隔符仍在打印。

是否可以实际删除`$2`and `$3`？

注意：如果这是在 Linux 中`bash`，则上面的正确语句如下，但 Windows 不能很好地处理`cmd.exe`.

```
$ gawk -F'\t' 'BEGIN{OFS="\t"}{$2=$3=""; print $0}' Input.tsv 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-07-11T15:58:57.030

这是一个老歌，但很好。

正如乔纳森所指出的，你不能删除中间的字段，但你可以用其他字段的内容替换它们的内容。您可以制作一个可重用的函数来为您处理删除。

```
$ cat test.awk
function rmcol(col,     i) {
  for (i=col; i<NF; i++) {
    $i = $(i+1)
  }
  NF--
}

{
  rmcol(3)
}

1

$ printf 'one two three four\ntest red green blue\n' | awk -f test.awk
one two four
test red blue 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-26T23:33:50.913

你不能删除中间的字段，但你可以删除最后的字段，方法是递减`NF`.

因此，您可以将所有后面的字段向下移动以覆盖`$2`然后`$3`递减`NF`2，这会擦除最后两个字段：

```
$ echo 1 2 3 4 5 6 7 | awk '{for(i=2; i<NF-1; ++i) $i=$(i+2); NF-=2; print $0}'
1 4 5 6 7 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-21T23:06:55.370

如果您只是想删除列，您可以使用`cut`：

```
$ cut -f 1,4- file.txt 
```

模仿`cut`：

```
$ awk -F "\t" '{ for (i=1; i<=NF; i++) if (i != 2 && i != 3) { if (i == NF) printf $i"\n"; else printf $i"\t" } }' file.txt 
```

相似地：

```
$ awk -F "\t" '{ delim =""; for (i=1; i<=NF; i++) if (i != 2 && i != 3) { printf delim $i; delim = "\t"; } printf "\n" }' file.txt 
```

高温高压

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-27T20:48:27.740

一种方法可能是像您一样删除字段并使用以下命令删除多余的空格`gsub`：

```
$ awk 'BEGIN { FS = "\t" } { $2 = $3 = ""; gsub( /\s+/, "\t" ); print }' input-file 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-05T22:46:25.170

除了 Suicidal Steve 的答案之外，我还想提出一个更多的解决方案，但`sed`使用`awk`.

它似乎比史蒂夫建议的用法更复杂`cut`。但这是更好的解决方案，因为`sed -i`允许就地编辑。

```
$ sed -i 's/\(.*,\).*,.*,\(.*\)/\1\2/' FILENAME 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-18T02:46:14.453

我能想到在 Awk 中不使用循环的唯一方法是使用`gsub`on`$0`来组合相邻`FS`：

```
$ echo {1..10} | awk '{$2=$3=""; gsub(FS"+",FS); print}'
1 4 5 6 7 8 9 10 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-08-26T17:19:52.237

要从给定的输入文件中删除字段 2 和 3（假设使用制表符字段分隔符），您可以使用以下方法从 $0 中删除字段`gensub`并重新生成它：

```
awk -F '\t' 'BEGIN{OFS="\t"}\
             {$0=gensub(/[^\t]*\t/,"",3);\
              $0=gensub(/[^\t]*\t/,"",2);\
              print}' Input.tsv 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-13T19:16:02.610

好吧，如果目标是删除额外的分隔符，那么您可以`tr`在 Linux 上使用。例子：

```
$ echo "1,2,,,5" | tr -s ',' 
```

```
1,2,5 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-27T14:53:16.377

[ghoti](https://stackoverflow.com/a/38311342/8344060)的答案中提出的方法存在一些问题：

*   awk 的每一次分配`$i = $(i+1)`力量都重建了记录`$0`。这意味着如果您有 100 个字段并且您想要删除字段 10，您将重建记录 90 次。

*   手动更改的值`NF`不符合posix，并导致未定义的行为（如评论中所述）。

删除一组列的一种更麻烦但稳定可靠的方法是：

**单列：**

```
awk -v del=3 '
    BEGIN{FS=fs;OFS=ofs}
    { b=""; for(i=1;i<=NF;++i) if(i!=del) b=(b?b OFS:"") $i; $0=b }
    # do whatever you want to do
   ' file 
```

**多列：**

```
awk -v del=3,5,7 '
    BEGIN{FS=fs;OFS=ofs; del="," del ","}
    { b=""; for(i=1;i<=NF;++i) if (del !~ ","i",") b=(b?b OFS:"") $i; $0=b }
    # do whatever you want to do
   ' file 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-12-31T04:12:31.260

```
echo one two three four five six|awk '{
print $0
is3=$3
$3=""
print $0
print is3
}' 
```

一二三四五六

一二四五六

三

# javascript - Multiple image resize and upload with description

> ID：10693612
> 
> 赞同：2
> 
> 时间：2012-05-21T22:43:41.073
> 
> 标签：javascript, jquery, html, file-upload, image-resizing

I'm looking for a way to upload multiple images with description. Users will be uploading 1-10 images of quite a large size from cameras so it's better if the images get resized before upload.

Requirements:

*   browser compatible (including mobile browsers and IE), can rely on JavaScript (jQuery)
*   multiple files either as selection of multiple files in native file manager or at least having to click on some button to bring an input for another file
*   add a description to each file
*   resize files before upload (doesn't need to be browser compatible)
*   uploads on submit
*   keeps EXIF info or at least extracts GPS coordinates (could do it with some libraries I found)

Bonuses:

*   can auto-rotate image before upload (using EXIF info)
*   shows thumbnail of selected image
*   drag & drop feature
*   progress bar

I use PHP on backend.

I guess HTML5 canvas might be suitable here. Or some jQuery plugin like [blueimp's Jquery-File-Upload](https://github.com/blueimp/jQuery-File-Upload). But I don't have experience with more than simple `<input type="file">`s so I'm asking for your suggestions.

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-28T11:52:58.347

看看[Uploadcare](https://uploadcare.com)。它的小部件开箱即用几乎可以满足您的所有要求，您可以自定义其行为以涵盖其余部分。

*披露*：我是 Uploadcare 开发人员之一，发布此消息并不是为了无耻地推广该服务，而是因为它旨在解决此类案例。

# c# - How to read data from textbox in ASP C#?

> ID：10693614
> 
> 赞同：-1
> 
> 时间：2012-05-21T22:43:42.663
> 
> 标签：c#, asp.net

there is an error in reading data from a text box here is the XML code:

```
 <asp:Button ID="btnSearch" runat="server" Style="z-index: 100; left: 513px; position: absolute;
        top: 340px" Text="Search" Width="188px"/>
    <asp:TextBox ID="MyTB" runat="server" Style="z-index: 101; left: 365px; position: absolute;
        top: 302px" Width="493px"/> 
```

and here is the code where i call the textbox "MyTB" to read the data from it:

```
 protected void btnSearch_Click(object sender, EventArgs e)
    {
        string text = MyTB.Text;

        string[] textArr = text.Split(new char[] { ' ', '\n', ',' });
    } 
```

The XML code :

```
<div>
    <asp:Button ID="btnSearch" runat="server" Style="z-index: 100; left: 513px; position: absolute;
        top: 340px" Text="Search" Width="188px"/>
    <asp:TextBox ID="MyTB" runat="server" Style="z-index: 101; left: 365px; position: absolute;
        top: 302px" Width="493px"/>

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T00:25:49.997

The codes seems to be correct. You could check the page's **designer.cs** file to make sure that it has MyTB defined eg

```
protected global::System.Web.UI.WebControls.TextBox MyTB; 
```

# javascript - jQuery - UI 自动完成问题

> ID：10693615
> 
> 赞同：0
> 
> 时间：2012-05-21T22:43:52.593
> 
> 标签：javascript, jquery, jquery-ui, autocomplete, getjson

使用[具有多个值的 jQ UI 自动完成](http://jqueryui.com/demos/autocomplete/#multiple)

我的功能看起来像这样

```
mailto_input.bind( "keydown", function( event ) {
    if ( event.keyCode === $.ui.keyCode.TAB && $( this ).data( "autocomplete" ).menu.active ) {
        event.preventDefault();
    }
}).autocomplete({
    source: function( request, response ) {
        $.getJSON( "core/search.php", {
            term: extractLast( request.term )
        }, response );
    },
    search: function(){
        // custom minLength
        var term = extractLast( this.value );
        if ( term.length < 2 ) {
            return false;
        }
    },
    focus: function() {
        // prevent value inserted on focus
        return false;
    },
    select: function( event, ui ) {
        var terms = split( this.value );
        // remove the current input
        terms.pop();
        // add the selected item
        terms.push( ui.item.value );
        // add placeholder to get the comma-and-space at the end
        terms.push( "" );
        this.value = terms.join( "; " );
        return false;
    }
}); 
```

我想要实现的是，限制用户只选择服务器端数据。我的意思是，只有在 PHP 端有任何结果时，我才想将术语添加到输入框中。否则，通知用户，服务器中没有类似这个术语的数据

例如。

![在此处输入图像描述](../Images/6489fb12b71b6afa5960e8caa35d1708.png)

我想防止添加类似的词`sdsf`（在这种情况下，服务器响应类似`[]`）。换句话说，仅当服务器端至少有 1 条建议时才添加。否则保持原样并通知用户有关问题。

那可能吗？我怎样才能达到这个结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:56:05.347

[试试](https://github.com/loopj/jquery-tokeninput)Tokeninput 。它完全符合您的要求。

此外，这里的[演示](http://loopj.com/jquery-tokeninput/)只是为了确保它是你想要的......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:12:51.027

好吧，他们这样做的方式是将标签交换为跨度。

```
<div id="taginput">
    <span id="tags">
    <span>tagname</span>
    </span>
    <input type="text" id="tagtext"/>
</div> 
```

您必须这样做，以便在之前添加建议作为跨度：

```
$('.suggestion_element_class').click(function() {
    textof = this.text();
    $('#tags').append('<span>' + textof + '</span>');
    $('#tagtext').val('');
}); 
```

当然，您必须首先获得建议和一切。

# c# - Rx framework for a web crawler

> ID：10693617
> 
> 赞同：0
> 
> 时间：2012-05-21T22:44:03.633
> 
> 标签：c#, system.reactive

I found that Rx framework looks really useful for async operations but i cannt understand how can i use it for download a lot of pages.

i am trying write something like this

```
var en = Enumerable.Range(0,100).Select(x => WebRequest.Create("http://google.com")).Select(x => Observable.FromAsyncPattern<WebResponse>(x.BeginGetResponse, 
    x.EndGetResponse)().Subscribe(r => Console.WriteLine(r.ContentLength)) ).ToList(); 
```

Ofcourse it doesnt work. How to do it right?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T01:08:31.893

EDIT: Modified to provide simple error handling.

Here's what you need to do:

```
var urls = new[]
        {
            "http://stackoverflow.com/questions/10693617/"
                    + "rx-framework-for-a-web-crawler",
            "http://stackoverflow.com/",
            "http://stackoverflow.com/users/259769/enigmativity",
        };

Func<string, IObservable<WebResponse>> create =
    url =>
        Observable.Defer(() =>
        {
            var wr = WebRequest.Create(url);
            return
                Observable
                    .FromAsyncPattern<WebResponse>(
                        wr.BeginGetResponse,
                        wr.EndGetResponse)
                    .Invoke()
                    .Catch(Observable.Return<WebResponse>(null));
        });

var query =
    from u in urls.ToObservable()
    from r in create(u)
    select new
    {
        URL = u,
        ContentLength = r == null ? -1L : r.ContentLength,
    };

ServicePointManager.DefaultConnectionLimit = 100;

query.Subscribe(x => Console.WriteLine(x)); 
```

I would be more inclined to provide better error handling than this though. I'd send out a tuple that includes the exception rather than just a `null` value.

# mysql - Retrieve columns from the same table with the same foreign keys but different values

> ID：10693618
> 
> 赞同：0
> 
> 时间：2012-05-21T22:44:12.807
> 
> 标签：mysql, select, union, left-join, outer-join

This is a quite delicate question, but I'll give my best to make it clear:

I have a table `countrynames` with 3 columns: iso, lang, name. The main spelling for these is english, for example:

```
+-----+------+-----------------------------+
| iso | lang | name                        |
+-----+------+-----------------------------+
| CA  | EN   | Canada                      |
| CC  | EN   | Cocos (Keeling) Islands     |
| CF  | EN   | Central African Republic    |
| CG  | EN   | Congo                       |
| CI  | EN   | Cote d'ivoire (Ivory Coast) |
| CK  | EN   | Cook Islands                |
| CL  | EN   | Chile                       |
| CM  | EN   | Cameroon                    |
| CN  | EN   | China                       |
| CO  | EN   | Colombia                    |
+-----+------+-----------------------------+ 
```

iso is the foreign key which references the iso-3166 coding for countries.

I inserted a number of countries with english spelling, but also in other languages ONLY when the spelling is different from english, in order to save some space in the database (for example "Germany" in german is "Deutschland", so the iso for 'DE' appears twice in the table, with 2 different names).

What I need is to select all the countries in some specific language (like german, or spanish), then all countries with english names from the same column. Where there is no corresponding name in the foreign language, then the english name should fill the empty field, so that I get a mixture of english + foreign language. The mixture should be equal to the sum of countries with english spelling, like this (nulls are where the english names should fill the missing spanish names, like Congo, Chile, China, Colombia):

```
'CA', 'ES', 'Canadá'
'CC', 'ES', 'Islas Cocos'
'CD', 'ES', 'República Democrática del Congo'
'CF', 'ES', 'República Centroafricana'
NULL, NULL, NULL
'CH', 'ES', 'Suiza'
'CI', 'ES', 'Costa del Marfil'
'CK', 'ES', 'Islas Cook'
NULL, NULL, NULL
'CM', 'ES', 'Camerún'
NULL, NULL, NULL
NULL, NULL, NULL
NULL, NULL, NULL
NULL, NULL, NULL 
```

This is what I used so far:

```
select result2.iso, result2.lang, result2.name from (select result1.* from (select  t1.*
from (
select iso, lang, name from countrynames where lang = 'es') t1
right join
(select iso, lang, name from countrynames where lang = 'en') t2
on t1.iso = t2.iso) result1) result2; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:57:36.653

您的原件`SELECT`可以简化一点：

```
SELECT t1.iso, t1.lang, t1.name
  FROM (SELECT * FROM countrynames WHERE lang = 'ES') t1
  RIGHT JOIN (SELECT * FROM countrynames WHERE lang = 'EN') t2
  ON t1.iso = t2.iso; 
```

然后您需要做的就是合并列结果，因此`t2`如果 中没有值，您可以检索这些值`t1`：

```
SELECT COALESCE(t1.iso, t2.iso), COALESCE(t1.lang, t2.lang), COALESCE(t1.name, t2.name)
  FROM (SELECT * FROM countrynames WHERE lang = 'ES') t1
  RIGHT JOIN (SELECT * FROM countrynames WHERE lang = 'EN') t2
  ON t1.iso = t2.iso; 
```

# android - How to export ADT certificate to facebook?

> ID：10693619
> 
> 赞同：1
> 
> 时间：2012-05-21T22:44:30.557
> 
> 标签：android, facebook, apache-flex

I have a flex android mobile application and I want to implement facebook's SSO.

I was reading facebook's android SSO tutorial and it said:

> "You need to put your Android application signature into your Facebook app settings."

My application's signature was generated by ADT certificate:

> adt -certificate -validityPeriod 25 -cn SelfSigned 1024-RSA file.pfx mypassword

But facebook suggests using keytool to export the key and that apparently requires an alias. Because doing the command below gives me an alias not found error:

> keytool -exportcert -storetype pkcs12 -keystore file.pfx -storepass mypassword

How am I supposed to export my certificate?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:46:16.973

这样做的一个好技巧是不要这样做（哈哈！），让它失败（你需要安装 facebook 应用程序，如果它回退到 web auth，它就不会被使用）。当它失败时，它会将密钥打印到 logcat 输出中，您可以从那里获取它并将其放入您的 facebook 应用程序设置中。

# hibernate - Grails hasMany association check

> ID：10693621
> 
> 赞同：0
> 
> 时间：2012-05-21T22:44:32.647
> 
> 标签：hibernate, grails, grails-orm, has-many

What is the cheapest way (from performance stand point) to figure out if hasMany association has any members? I am trying to avoid retrieval of all children. Is there a clean way to count children using gorm?

The use case here is to show(or not) a [+] on the UI of a parent object.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T01:58:16.110

不可能，我想用一个直接的 gorm 表达

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T03:54:08.383

我认为通过对孩子进行 size() 检查不会丢失任何东西（尤其是在使用缓存的情况下）。另一种选择是去规范化一点并将计数保留为父级的列。我们为跟踪订单标题的订单项目数量的 ecomm 站点执行此操作。

您还可以查看 countBy 动态查找器。

# javascript - Javascript oop 基础知识

> ID：10693625
> 
> 赞同：3
> 
> 时间：2012-05-21T22:45:33.990
> 
> 标签：javascript, jquery

> **可能重复：**
> [$(document).ready 速记](https://stackoverflow.com/questions/6004129/document-ready-shorthand)

有人可以帮我理解下面的JS代码吗，请：

```
$(function(){  <-- Is this a JS constructor? Why we need this?
    var someVariable = $(".classa").on('click', function() { <-- At what point in time does someVariable get populated?
        var $this = $(this);
            id = $this.attr('id');
         someVariable.removeClass('selected'); 
    });

    var someVariable2 = $(".classb").on('click', function() {
        var $this = $(this);
            id = $this.attr('id');
         someVariable2.removeClass('selected');
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:46:28.810

`$`是函数的名称。您将在其中传递一个匿名函数作为其第一个参数。如果我们要降低它的复杂性，它看起来像这样：

```
var $ = function( arg1 ){
  /* Internals */
}; 
```

如果我们现在调用它，它将如下所示：

```
$("foo"); 
```

在这段代码中，`"foo"`是我们的第一个参数。现在假设我们`"foo"`用另一个函数替换了我们的：

```
var callback = function(){
  alert("Hello World");
}; 
```

如果我们将它传递给我们的`$`函数，它将如下所示：

```
$( callback ); 
```

但是我们真的不需要使用命名函数，我们可以使用匿名函数：

```
$(function(){
  alert("Hello World");
}); 
```

开始看到相似之处？在生命周期的某个时刻`$`，它会决定执行我们传入的函数。在它执行之前，我们的函数什么都不做。

现在我们在这里讨论 jQuery，只要 DOM 准备好，jQuery 就会执行该函数。所以我们传递的代码应该在 DOM 准备好时执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:48:38.170

$ 不是 js 构造函数。它是[jquery(js library)](http://jquery.com/)函数。该变量在声明时填充。

# c# - C# VS2010 - 为什么我收到消息“非静态字段需要对象引用”？

> ID：10693626
> 
> 赞同：0
> 
> 时间：2012-05-21T22:45:51.073
> 
> 标签：c#

我把这个问题归结为一个非常简单的程序：

```
public Form1()
{
    InitializeComponent();

    TextBox tb1;

    tb1 = textBox1;             // this line is OK
    tb1 = this.textBox1;        // this line is OK
    tb1 = Form1.textBox1;       // this line generates error message    

    } 
```

如果将鼠标悬停在“textBox1”、“this.textBox1”和“Form1.textBox1”上，工具提示在所有情况下都会显示“TextBox Form1.textBox1”。

（有关显示工具提示的屏幕转储，请参见 www.firish.com/tb1.jpg 和 www.firish.com/tb2.jpg）

我在办公室里转了一圈，但这里没有人能真正解释为什么第三个例子没有编译，但除了“嗯哼”、“嗯……”和几个耸肩之外没有得到什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T22:47:33.223

因为 Form1 是类的名称，而不是 Form1 的实例。

当您创建类时，您的代码如下所示

```
Form1 f = new Form1(); 
```

这`f`是 Form1 类的实例，您可以使用（前提是 textbox1 可见）

```
TextBox tb1 = f.TextBox1; 
```

在 Form1 类中，您可以使用关键字引用当前实例`this`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:48:36.547

因为使用这种语法，您只能访问`static`成员。`textBox1`是一个动态成员，只能从初始化对象访问。`myObject.textBox1`. 你正在尝试做`MyClass.textBox1`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T22:50:14.570

textBox1 是一个实例变量。它必须存在于对象的实例化副本中。当你这样说时会发生这种情况：

```
Form1 form new Form1();
form.textBox1 = "Something"; 
```

如果您不实例化该对象，则它正在使用静态调用，并且您不能静态调用作为实例变量的对象。

```
Form1.textBox1 = "Something"; // this fails. 
```

在您的情况下，您正在使用构造函数。构造函数仅在对象被实例化时被调用，因此使用 this（或隐含的 this）有效，但使用静态调用不起作用，因为没有实例可以分配变量。

# iphone - 分段表视图动画

> ID：10693627
> 
> 赞同：0
> 
> 时间：2012-05-21T22:45:52.350
> 
> 标签：iphone, objective-c, ios, ipad

我经常看到这种情况，您在顶部有剖面视图，然后当您向上滚动并且下一个剖面视图与顶部的剖面视图到达/重叠时，它会合并。我该怎么做这样的事情？有这样做的图书馆吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:57:52.520

这是所有 UITableViews 都支持的默认行为（您不需要自定义库）。您必须实现 UITableView 的 sectionIndexTitlesForTableView 方法：

```
- (NSArray *)sectionIndexTitlesForTableView:(UITableView *)tableView {
} 
```

# javascript - 如何将布尔值从 javascript 传递给 python？

> ID：10693630
> 
> 赞同：18
> 
> 时间：2012-05-21T22:46:05.893
> 
> 标签：javascript, python

以下似乎传递了一个字符串而不是一个布尔值。我将如何传递布尔值？

```
$.post('/ajax/warning_message/', {'active': false}, function() {
            return
       }); 
```

```
def warning_message(request):
    active  = request.POST.get('active')
    print active
    return HttpResponse() 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-05-21T22:50:54.610

在您的 Python 代码中执行以下操作：

```
active = True if request.POST.get('active') == 'true' else False 
```

或者更简单：

```
active = request.POST.get('active') == 'true' 
```

请注意，该`get()`函数将始终返回一个字符串，因此您需要根据您需要的实际类型对其进行转换。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-21T22:49:29.077

假设您可以将布尔值作为`true/false`or发送到服务器`1/0`，在服务器端您可以使用以下命令检查这两种情况`in`：

```
def warning_message(request):
    active = request.POST.get('active') in ['true', '1']
    print active
    return HttpResponse() 
```

* * *

否则，如果您确定您的布尔值将仅`true/false`使用：

```
def warning_message(request):
    active = request.POST.get('active') == 'true'
    print active
    return HttpResponse() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-06-04T07:14:44.613

Oscar 的答案是 1-liner，我不想从中得到什么，但是比较字符串并不是最干净的方法。

我喜欢使用[simplejson](http://simplejson.readthedocs.io/en/latest/)库。专门[加载](http://simplejson.readthedocs.io/en/latest/#simplejson.loads)将 JavaScript 的自然 json 形式解析为原生 Python 类型。因此，这种技术可以用于更广泛的案例。

这将为您提供更易于**阅读、理解和维护的****统一代码技术**。

 **从文档：

> 将 s（包含 JSON 文档的 str 或 unicode 实例）反序列化为 Python 对象。

```
import simplejson as sjson
valid_python_var = sjson.loads(json_str_to_parse) 
```

或者在您通过参数传递接收它的可能情况下：

```
var_to_parse = request.POST.get('name_of_url_variable') #get url param
    if var_to_parse is not None: #check if param was passed, not required
        parsed_var = sjson.loads(var_to_parse) # loads does the work 
```

注意：使用常识导入库，如果您打算在不需要时使用它们。**

# c# - 如何将 WCF rest api 集成到应用程序中

> ID：10693632
> 
> 赞同：2
> 
> 时间：2012-05-21T22:46:19.123
> 
> 标签：c#, wcf, rest

我正在寻找可以测试 WCF REST api 调用的 C# 示例测试应用程序？我在网上找不到一个。我还有一些需要传递的 wcf 端点的登录凭据。有人可以指点我示例 test rest api appln 吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T00:30:03.973

I think using `WebClient` should work for WCF REST services (if you need, you can use credentials, request headers, etc):

```
private void TestService()
{
    try
    {
        string address = "<WCF REST service address>";
        WebClient client = new WebClient();
        string userName = "<user>";
        string password = "<password>";
        ICredentials creds = new NetworkCredential(userName, password);
        client.Credentials = creds;
        client.Headers[HttpRequestHeader.Authorization] = String.Format("Basic {0}:{1}", userName, password);
        client.Headers[HttpRequestHeader.UserAgent] = @"Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 4.0)";
        Stream data = client.OpenRead(address);
        StreamReader reader = new StreamReader(data);
        string s = reader.ReadToEnd();
        Console.WriteLine(s);
    }
    catch (WebException ex)
    {
        Console.WriteLine(ex.Message);
        if (ex.Response != null)
        {
            Stream strm = ex.Response.GetResponseStream();
            byte[] bytes = new byte[strm.Length];
            strm.Read(bytes, 0, (int)strm.Length);
            string sResponse = System.Text.Encoding.ASCII.GetString(bytes);
            Console.WriteLine(sResponse);
        }
    }
} 
```

EDIT: Example for web application which uses Forms authentication.

My previous example works if the web application allows anonymous users. If not (web.config contains `<deny users="?"/>` and Anonymous access is enabled in IIS), two requests are required:

1.  the request to the login page to authenticate;

2.  the request to the actual service url.

The auth cookie should be passed to the second request (we use the `CookieContainer` object to achieve this). The first call passes the user name and password using the POST method. Because my web application uses out-of-the-box login control, I need to pass the view state, event validation, etc. You can get the form data passed during the login from a web browser using Fiddler or Chrome dev tools. This is the code:

```
private static void TestService()
{
    try
    {
        string loginAddress = "<login url>";
        string serviceAddress = "<service url>";
        HttpWebRequest req = (HttpWebRequest)WebRequest.Create(loginAddress);
        req.Method = "POST";
        string userName = "<user>";
        string password = "<password>";
        CookieContainer cc = new CookieContainer();
        req.CookieContainer = cc;

        StringBuilder sb = new StringBuilder();
        sb.Append(@"__VIEWSTATE=<viewstate>");
        sb.Append(@"&__EVENTVALIDATION=<event validation>");
        sb.Append(@"&ctl00$MainContent$LoginUser$UserName={0}&ctl00$MainContent$LoginUser$Password={1}");
        sb.Append(@"&ctl00$MainContent$LoginUser$LoginButton=Log In");
        string postData = sb.ToString();
        postData = String.Format(postData, userName, password);
        req.ContentType = "application/x-www-form-urlencoded";
        Encoding encoding = new ASCIIEncoding();
        byte[] requestData = encoding.GetBytes(postData);
        req.ContentLength = requestData.Length;

        //write the post data to the request
        using (Stream reqStream = req.GetRequestStream())
        {
            reqStream.Write(requestData, 0, requestData.Length);
            reqStream.Flush();
        }

        HttpWebResponse response = (HttpWebResponse)req.GetResponse(); //first call (login / authentication)

        req = (HttpWebRequest)WebRequest.Create(serviceAddress);
        req.CookieContainer = cc; //set the cookie container which contains the auth cookie
        response = (HttpWebResponse)req.GetResponse(); //second call, the service request
        Stream data = response.GetResponseStream();
        StreamReader reader = new StreamReader(data);
        string s = reader.ReadToEnd();
        Console.WriteLine(s);
    }
    catch (WebException ex)
    {
        Console.WriteLine(ex.Message);
        if (ex.Response != null)
        {
            Stream strm = ex.Response.GetResponseStream();
            byte[] bytes = new byte[strm.Length];
            strm.Read(bytes, 0, (int)strm.Length);
            string sResponse = System.Text.Encoding.ASCII.GetString(bytes);
            Console.WriteLine(sResponse);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T00:38:33.977

我更喜欢用 Fiddler (www.fiddler2.net) 做这种测试

# .htaccess - htaccess - 模拟虚拟主机行为

> ID：10693636
> 
> 赞同：1
> 
> 时间：2012-05-21T22:47:25.767
> 
> 标签：.htaccess, redirect, url-rewriting, virtualhost

嗨！

我也没有找到答案的技能，所以我在这里问。

我有一个没有 root 访问权限的专用服务器（可以使用）。这是结构： /myportfolio/ /clients/client1/project1 /clients/client2/project1 根目录中的 /nothing ...

这是一个美妙的世界，直到“client3/project1”想要使用他自己管理的 URL (project1.client3.com)。我不能对这个子域做任何事情。

通过将我的 IP 地址提供给该客户端，该子域将指向服务器根目录，并且由于我无法访问 httpd.conf 文件以在其中放置虚拟主机，因此我被卡住了……

我可以在服务器根目录上有一个像这样的 htaccess：

```
if url = projet1.client3.com
show the clients/client3/projet1 content 
```

这个怎么写？非常感谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T22:16:41.327

试试这个：

```
RewriteEngine on
RewriteBase /
RewriteCond %{HTTP_HOST} project1.client3.com
RewriteRule ^(.*)$ http://www.yourdomain.com/clients/client3/project1/$1 [L,QSA] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:57:44.970

```
<VirtualHost *:80>
    ServerName www.example.com
    ServerAdmin admin@localhost
    DocumentRoot path/to/website/public
    AllowOverride All
</VirtualHost> 
```

# haskell - 如何以人类可读的形式转储 GHC 简化器输出？

> ID：10693638
> 
> 赞同：14
> 
> 时间：2012-05-21T22:47:36.077
> 
> 标签：haskell, command-line, ghc

我有以下程序：

```
data Peano = Zero | Succ Peano deriving (Show)

add Zero     b = b
add (Succ a) b = add a (Succ b)

mul Zero     b = Zero
mul (Succ a) b = add b (mul a b)

four x = let two = Succ (Succ Zero) in mul two two 
```

我想从 GHC 得到这样的东西：

```
add =
  \ ds b ->
    case ds of
      Zero ->
        b
      Succ a ->
        add
          a
          (Succ b)

mul =
  \ ds b ->
    case ds of 
      Zero ->
        Zero
      Succ a ->
        add
          b
          (mul a b)

four =
    let
      two =
        Succ
           (Succ Zero)
    in
    mul two two 
```

我设法得到的最好的是

```
ghci -ddump-simpl -dsuppress-module-prefixes -dsuppress-uniques foo.hs 
```

但是它需要大量手动删除 GHC 生成的东西才能获得上面的代码。是否有用于 GHC 的开关或进行清理的第三方脚本？

有没有办法至少摆脱`case {tick (main:Main, 8)} @ (State# RealWorld) of _ { __DEFAULT ->`？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-21T23:08:59.687

你很幸运！有一个工具可以完成这项工作：[ghc-core](http://hackage.haskell.org/package/ghc-core)。

ghc-core 使用命令行包装器包装 ghc，该命令行包装器在寻呼机中以人类可读的彩色方式显示 GHC 的优化核心和程序集输出。

用法 - 只需替换`ghc`为`ghc-core`：

```
 ghc-core A.hs  

   ghc-core -fvia-C -optc-O3 A.hs 
```

# c# - If/Else OR "? :" (有条件的) 不工作

> ID：10693640
> 
> 赞同：1
> 
> 时间：2012-05-21T22:47:38.730
> 
> 标签：c#, asp.net-mvc

**试图在这里改写/清理问题：**

我正在尝试做某种条件语句来计算一个值。为了模拟我的数据，我在我的控制器中（临时）分配值以查看我的 UI 是如何进行的。我可以在视图中的功能块中执行计算，但它很长并且不属于那里。所以，我现在正在尝试在模型（`Calculations.cs`）中进行计算。

计算代码的工作原理是传递一个值，除了我的条件失败并传递了默认值，`0`即它应该根据我在控制器中的模拟值传递另一个值的时间。

这里是`Calculations.cs`

```
public class Calculations
{
    PriceQuote price = new PriceQuote();
    StepFilingInformation filing = new StepFilingInformation();
    public decimal Chapter7Calculation
    {
        get
        {
            return
                price.priceChapter7
                +
                ((filing.PaymentPlanRadioButton ==
                    Models.StepFilingInformation.PaymentPlan.Yes)
                ?
                price.pricePaymentPlanChapter7
                :
                0);
        }

    }
} 
```

我最初`(filing.PaymentPlanRadioButton == Models.StepFilingInformation.PaymentPlan.Yes)`检查单选按钮是否设置为“是”，但将其更改为`ReferenceEquals`. 这不影响结果。

我让我的控制器将值分配`PaymentPlanRadioButton`给“是”，因此`pricePaymentPlanChapter7`应该将值添加到`priceChapter7`，但事实并非如此。相反，添加“0”作为回退到条件。`PaymentPlanRadioButton`即使我在控制器中分配它也是 null 。

我无法弄清楚如何解决这个问题。如果我在模型中分配它并让它工作，这将无法解决问题，因为当我删除模拟控制器并期望用户选择一个单选按钮时，它仍然会是`null`并且条件将失败。

这是“模拟”控制器：

```
public class QuoteMailerController : Controller
{
    public ActionResult EMailQuote()
    {
        Calculations calc = new Calculations();
        var total = calc.Chapter7Calculation;

        QuoteData quoteData = new QuoteData
        {
            StepFilingInformation = new Models.StepFilingInformation
            {
                //"No" is commented out, so "Yes" is assigned
                //PaymentPlanRadioButton = 
                    //Models.StepFilingInformation.PaymentPlan.No,
                PaymentPlanRadioButton = 
                    Models.StepFilingInformation.PaymentPlan.Yes,
            }
         };
    }
} 
```

这是我存储价格的地方（`PriceQuote.cs`）：

```
public class PriceQuote
{
    public decimal priceChapter7 { get { return 799; } }
    public decimal pricePaymentPlanChapter7 { get { return 100; } }
} 
```

这是我的视图模型：

```
public class QuoteData
{
    public PriceQuote priceQuote;
    public Calculations calculations;
    public StepFilingInformation stepFilingInformation { get; set; }
    public QuoteData()
    {
        PriceQuote = new PriceQuote();
        Calculations = new Calculations();
    }
} 
```

因此，这应该工作的方式是 799 + 100 = 899，因为`PaymentPlan.Yes`它被分配为控制器中单选按钮的值。但相反，我得到的只是 799 (799 + 0)，因为当我调试时`PaymentPlanRadioButton`出现空值。

有什么想法/指导吗？

以防万一，这是`PaymentPlanRadioButton`位于内部`StepFilingInformation.cs`（并且是我的模型之一）：

```
public enum PaymentPlan
{
    No,
    Yes
}
public class PaymentPlanSelectorAttribute : SelectorAttribute
{
    public override IEnumerable<SelectListItem> GetItems()
    {
        return Selector.GetItemsFromEnum<PaymentPlan>();
    }
}       
[PaymentPlanSelector(BulkSelectionThreshold = 3)]
public PaymentPlan? PaymentPlanRadioButton { get; set; } 
```

对不起，长度。

**对于上下文，这是我试图摆脱的**

在我看来，我最初在一个功能块中有这个计算代码。计算在那里工作正常，但显然非常冗长且不合适。

这就是我的功能块的样子（部分）

```
@{ Model.PriceQuote.calculationChapter7
    =
    Model.PriceQuote.priceChapter7
    +
    ((Model.StepFilingInformation.PaymentPlanRadioButton == 
        StepFilingInformation.PaymentPlan.No)
    ?
    Model.PriceQuote.priceNoPaymentPlan
    :
    Model.PriceQuote.pricePaymentPlanChapter7)
    +
    ...//more of the same
    ;
} 
```

因此，我一直在努力将其写入`.cs`文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T23:02:58.507

你真的有这段代码吗：

```
public decimal calculatingTest(MyModel MyModel)
{ ... } 
```

而不是这个？

```
public decimal calculatingTest(MyModel myModel) // note the difference in case.
{ ... } 
```

只有这样的事情才能使生活变得非常复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:55:03.093

您是否尝试过调试以确保 MyModel.MyModelProperty 在运行时确实等于“否”？

如果是，也许您需要覆盖相等运算符（即，“==”测试可能失败） - 请参阅此处的 MSDN 文章以获取教程：

[http://msdn.microsoft.com/en-us/library/ms173147(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms173147(v=vs.80).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T02:03:32.767

在您的 Calculations 类中，您得到 '100' 作为返回值不是因为

```
MyModel.MyProperty == MyModel.MyPropertyEnum.Yes 
```

但因为它**不**等于 MyModel.MyPropertyEnum.No。所以你的 if 块只是落在默认情况下。在这段代码中， MyModel.MyProperty 没有分配任何值，所以它只采用默认值，据我所知是；

```
(MyPropertyEnum?)null 
```

“并非所有代码路径都返回值”异常是由于您已将 MyProperty 设为可空类型且未提供结果；

```
MyModel.MyProperty == null 
```

同样，您将类型名称用作变量名称是一个糟糕的选择。在Calculations.cs 中有一个名为“MyModel”的类实例变量，在calculationTest 中有一个名为MyModel 的方法参数。这令人困惑。

最后，您的*StackOverflowException*的原因是您使用相同的参数递归调用计算测试，因此它进入了无限循环。

这里有很多问题可以清理，您可能会找到问题的原因。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T23:01:37.827

[添加第二个答案，因为添加的代码自原始帖子以来发生了显着变化]。

我认为这里的根本问题是您实现 Calculations 类的方式。Chapter7Calculation 属性*总是*返回 799 + 0，因为它使用私有局部类变量来确定要返回的值；

```
public class Calculations
{
    PriceQuote price = new PriceQuote();

    // private local variable - will ALWAYS have PaymentPlanRadioButton = null
    StepFilingInformation filing = new StepFilingInformation();

    public decimal Chapter7Calculation
    {
        get {
            return
                price.priceChapter7
                +
                (filing.PaymentPlanRadioButton == Models.StepFilingInformation.PaymentPlan.Yes)
                ? price.pricePaymentPlanChapter7
                : 0);
        }
    }
} 
```

您有一个“控制器”正在修改StepFilingInformation 的**其他**一些实例，而您的 Calculations 类不知道这些实例。同样，您的 PriceQuote 类只是返回常量或静态值，因此没有真正需要实例化它。像这样修改那个类；

```
public static class PriceQuote
{
    public static decimal PriceChapter7 { get { return 799; } }
    public static decimal PricePaymentPlanChapter7 { get { return 100; } }
} 
```

将您的计算更改为这样的方法；

```
public decimal CalculatePrice(QuoteData quoteData)
{
    return PriceQuote.PriceChapter7 + 
        (quoteData.StepFilingInformation.PaymentPlanRadioButton == Models.StepFilingInformation.PaymentPlan.Yes) 
        ? PriceQuote.PricePaymentPlanChapter7 : 0);
} 
```

现在您的控制器可以传入它创建的 QuoteData 实例，您应该会看到更好的结果。模拟控制器的示例代码；

```
public class QuoteMailerController : Controller 
{
    public ActionResult EMailQuote()
    {
        Calculations calc = new Calculations();

        QuoteData quoteData = new QuoteData
        {
            StepFilingInformation = new Models.StepFilingInformation
            {
                PaymentPlanRadioButton = Models.StepFilingInformation.PaymentPlan.Yes,
            }
         };

         var total = calc.CalculatePrice(quoteData);
    }
} 
```

# salesforce - 销售队伍 SOQL 事件与潜在客户关系

> ID：10693643
> 
> 赞同：1
> 
> 时间：2012-05-21T22:48:23.427
> 
> 标签：salesforce, apex-code, visualforce, soql

我一直在尝试查询分配给事件的潜在客户，以便我可以获得潜在客户的电话号码，但到目前为止，电话字段始终为空，即使 Who.Name 字段是正确的，以及使用ID作为记录的链接..我想做的简化版本是：

```
SELECT Who.Phone FROM Event 
```

但这不会返回任何内容，如果我这样做：

```
SELECT Who.Name, Who.Phone FROM Event 
```

这将返回一个名称正确的对象，但不返回电话。我真的不确定该往哪里走，似乎我可以使用这种关系提取的唯一字段是名称和 ID ..

我是在错误地使用 Who 还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T01:29:10.430

事件的查找字段有点特殊，因为它们可以查找不同类型的记录。

也许只是通过查询`WhoId`on event 来获取所有 ID，然后在 Lead 上运行第二个查询`where id in : listLeadIds`——我怀疑在这种情况下添加另一个查询会导致你的调控器限制问题。

# git - 从提交变基

> ID：10693644
> 
> 赞同：0
> 
> 时间：2012-05-21T22:48:23.660
> 
> 标签：git

我有一个我编写的框架，它作为主分支进入*Github存储库。*进入那个分支的只有框架的核心文件，所以我把它命名为**核心分支**。现在进入其他分支，我列出了使用上述核心框架的项目——我这样做是因为我虽然使用分支会更容易，但正如我刚刚发现的那样，事实并非如此。严重地。

所以总结一下：我有一个**核心分支**和一个使用该核心的**项目分支。**现在在**项目分支**上，我主要进行与项目相关的提交（添加图像 X，修改样式表 Y），但有时我会修改核心，以使其更好。

现在我想做的是，我再次认为这很简单，就是当我开始在核心而不是项目上工作时，将对核心的更改合并到核心分支中。有几种解决方案，这一切都开始让我感到困惑，既然我不想弄乱我的核心分支，我应该如何进行？

我知道我可以挑选提交并推送它，但我真的很想保留核心文件的更改历史，所以我被指示重新定位。问题是：如果我将我的核心分支重新设置为项目分支上的特定提交，它将推送所有与核心无关的文件和内容。那么我如何*从*某个提交中变基（而不是*，*这似乎是默认的？）。

以下是项目分支上的提交可能是什么样子的某种想法：

**项目分支**

```
00:12 - Added image X
00:14 - Modified stylesheet Y to have a pink background (pink is pretty)
00:16 - Modified class core.background to handle pink background
00:18 - Modified class core.string to always capitalize Pink (because it's so pretty) 
```

如何在不合并与项目相关的两个第一个提交的情况下将最后两个提交合并到**核心分支中，并保留历史记录 - 即。**将这两个核心更改保持为两个提交而不是一个？

* * *

编辑：更精确。我的核心框架定义了项目的文件夹组织，因此需要位于项目文件夹的根目录。这就是为什么它不是一个子模块，这本来就是梦想。另外，我尝试了核心的分叉，但显然你不能分叉自己的项目。

如果除了分支之外还有其他方法可以做我想做的事，我会全神贯注。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:42:14.553

`git`分支并不是那样工作的——分支都与存储库有关。将项目或项目的一部分分离到单独的分支中并不是正确的方法。最终，大多数分支应该被合并到`release`某种类型的分支中，或者被丢弃。

> 我有一个核心分支和一个使用该核心的项目分支。现在在项目分支上，我主要做与项目相关的提交......
> 
> 我真的很想保留核心文件的更改历史[单独]

由此看来，我认为这听起来很像您对两个独立的存储库有一个很好的用例，一个用于`core-files`，一个用于`project`- 您希望保留历史记录`core`并将其`project`分开。与其将它们保存在不同分支的同一个存储库中，我建议将它们拉`core-files`入一个[`git submodule`](http://git-scm.com/book/en/Git-Tools-Submodules). `projects`这会给你带来几个好处：

*   `project`和`core`历史是分开的。
*   与另一个项目一起使用`core`非常简单；导入`core`为. `git submodule`_`otherproject`
*   `project`两者的历史都`core`更容易维护，因为您不再需要*在分支之间*进行挑选。

# visual-studio-2010 - 如何在 Visual Studio 2010 ASP.NET 中恢复错误删除的项目？

> ID：10693645
> 
> 赞同：1
> 
> 时间：2012-05-21T22:48:34.613
> 
> 标签：visual-studio-2010

如果有人在 Visual Studio 2010 ASP.NET 中错误地删除了一个项目，我该如何恢复它？

# vba - mac 宏的 word 获取活动文档的路径

> ID：10693651
> 
> 赞同：1
> 
> 时间：2012-05-21T22:49:14.080
> 
> 标签：vba, ms-word

我正在尝试通过调用在我的 Word for mac 宏中返回活动文档的路径

```
strFolder = ActiveDocument.Path 
```

这也给出了文件名。

是否有仅用于路径或字符串操作的命令来减去`ActiveDocument.Name`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T09:36:01.693

FWIW 我认为这个问题是在 Word 2008 中引入的，其中“路径”和“全名”属性具有相同的值（在 Applescript 中，因为那里没有 VBA）。相同的 VBA 在 Word 2004 中运行良好。

您现有解决方案中的一个潜在问题是文件夹的名称可能与文档相同，例如您的文档全名可能是

```
Macintosh HD:Users:me:Documents:mydoc.docx:mydoc.docx 
```

如果你需要处理这个问题，你可以考虑类似

```
strFolder = left(ActiveDocument.Path, len(ActiveDocument.Path) - len(ActiveDocument.Name)) 
```

（也许未保存的文档也需要一些不同的东西）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T00:38:29.737

我不知道为什么会这样，但下面有一个解决方案......

```
strFolder = Replace(ActiveDocument.Path, ActiveDocument.Name, "") 
```

希望这可以在将来对其他人有所帮助！

# iphone - ios自动调整容器大小

> ID：10693653
> 
> 赞同：1
> 
> 时间：2012-05-21T22:49:25.250
> 
> 标签：iphone, ios, ipad, uiview, resize

我不确定ios中是否有自动调整大小的容器，经过一些研究，似乎没有。这是我的问题，我想要一个容器，最多包含 4 个子元素，所以我有：

```
 |A B C D| 
```

我希望包含 A、B、C 和 D 的容器完全适合（我的意思是高度和宽度应该正是它所包含的）

```
 so i don't want:
        |A B C D         |

        or 

        |A B C D|
        |       | 
```

现在棘手的部分是，有时你并不总是得到 A、B、C、D，你可以得到任意数量的它们，在这种情况下，我还需要容器相应地增长和收缩。

```
 example:
        say we only have A or B
        I expect container to be

        |A B|
        not 
        |A B     | 
```

我如何着手创建这样的容器是我有一个 UIView 作为容器，我通过 addSubview 添加 A、B、C、D 子视图并调用 [container sizeToFit] 这不起作用，因为这里的线程[有问题UIView sizeToFit 做任何有意义](https://stackoverflow.com/questions/3946665/having-trouble-getting-uiview-sizetofit-to-do-anything-meaningful) 的事情，换句话说，我不能调用 sizeToFit 到通用 UIView 有人可以帮忙吗？

编辑：

如果没有内置支持，有人可以为我提供自定义代码来处理这种情况吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T15:30:59.207

您必须在启用自动布局的情况下实现 intrinsicContentSize 方法。

有了这个，您可以根据必须放置多少元素来指定视图的内容大小！

# jquery - jQuery - 调用 Document Ready 后未应用 CSS 和 JS？

> ID：10693654
> 
> 赞同：0
> 
> 时间：2012-05-21T22:49:26.237
> 
> 标签：jquery, css, handlebars.js

我正在尝试使用 HandleBars JS，到目前为止它大部分都在工作。但是我遇到了一个有趣的问题。

我正在尝试让 HandleBars 呈现具有三个文本字段的用户输入表单。为了进行测试，我已将构建这三个文本字段所需的 JSON 字符串粘贴到我的文档中，并且效果很好。但是，当我使用 $.getJSON 并在呈现文本字段时通过 ajax 调用完全相同的 JSON 字符串时，不会将 CSS 或 jQuery 规则应用于表单。

我知道这是因为此时已调用 Document Ready，因为我在我的静态字符串周围添加了 Document Ready，同样的事情发生了，它们没有呈现任何 CSS 或 JS 规则。

有没有办法可以重新强制所有 jQuery 和 CSS 规则刷新？或者我怎样才能让它工作？

另外，请注意这**不是**jQuery Mobile。

非常感谢..如果您有任何问题，请在投票前询问。

编辑 - 这是代码：

**静态版本**

```
var source   = $("#form-template").html();
var template = Handlebars.compile(source);
var data = { 
    info: { id: 'longbeach2012', name: 'Long Beach 2012' },
forms: [
{id: "1", label: "This is a label", description: "", type: "text", name: "t1", username: "alan" },
{id: "2", label: "This is a label2", description: "description2", type: "text", name: "t2", username: "allison" },
{id: "3", label: "This is a label3", description: "description3", type: "text", name: "t3", username: "ryan" }
]};
var example = {title: "Sample Title", body: "Sample Body"};
$("#testForm").html(template(data)); 
```

**动态版**

```
$.getJSON('http://register.local.dev/fetchtemplate',
{
    language: 'english',
    formid: 'longbeach2012'
},
function(data) {
    $.each(data, function(i,item){
        if( item.elem_type === 'text' )
        {
            var source = $("#textinput-template").html();
            var template = Handlebars.compile(source);
            $("#testForm").append(template(item));
        }
    });
}); 
```

**车把模板**

```
<script id="textinput-template" type="text/x-handlebars-template">
<div id="q{{elem_id}}">
    <div class="small">{{trans_label}}{{#if trans_description}}</br />
    <span class="notice">{{trans_description}}</span>{{/if}}</div>
    <input type="{{elem_type}}" name="{{elem_name}}" id="{{elem_name}}" value="{{trans_defaultValue}}" tabindex="1" autocomplete="off" />
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T20:28:32.800

我想到了。

我从准备好的文档中删除了我的大部分 javascript 代码，并让我的 getJSON 调用一个函数，该函数在 getJSON 完成运行后执行我的 javascript 的其余部分。

# php - 使用 phpdocx 下载损坏的 .docx

> ID：10693660
> 
> 赞同：0
> 
> 时间：2012-05-21T22:49:44.430
> 
> 标签：php, docx, phpdocx

我有一个项目，我们在其中使用 phpdocx pro 在模板中生成 .docx 文件。我可以很容易地将数据输入到模板中，但是当文件在 MS Word 2010 中下载并打开时，程序报告由于内容存在问题而无法打开文件，详细信息为“文件已损坏并且无法打开”。Word 可以修复文档，但问题仍然在于它不应该首先被损坏。

这就是我生成文档的方式：

```
function generateUnitDesign(){
  if($this->populateRecords()){
      require_once dirname(__FILE__).'/phpdocx/classes/CreateDocx.inc';
      $filename = 'UnitDesignTemplate-'.str_replace(' ', '', $this->rec->title);
      //Create Document
      $document = new CreateDocx();
      $document->addTemplate(dirname(__FILE__).'/templates/unitdesigntemplate.docx');

      // Fill in text fields
      $document->addTemplateVariable('TITLE', $this->rec->title);
      $document->addTemplateVariable('CHALLENGE', $this->rec->challenge, 'html');
      $document->addTemplateVariable('HOOK', $this->rec->hook, 'html');
      $document->addTemplateVariable('RESEARCH', $this->rec->research, 'html');
      $document->addTemplateVariable('AUDIENCE', $this->rec->audience, 'html');
      $document->addTemplateVariable('SUMMARY', $this->rec->project_brief, 'html');
      $document->addTemplateVariable('RESOURCES', $this->rec->resources, 'html');
      $document->addTemplateVariable('REQUIREMENTS', $this->rec->requirements, 'html');
      $document->addTemplateVariable('SCAFFOLDING', $this->rec->scaffolding, 'html');

      $document->createDocx($filename);
      unset($document);
      header("Content-Type: application/vnd.ms-word");
      header("Content-Length: ".filesize($filename.'.docx'));
      header('Content-Disposition: attachment; filename='.$filename.'.docx');
      header('Content-Transfer-Encoding: binary');
      ob_clean();
      flush();
      readfile($filename.'.docx');
      unlink($filename.'.docx');
  }
} 
```

最初，我试图使用他们的`createDocxAndDownload()`功能来获取文件，但它会在服务器上留下 .docx 文件的副本，这并不理想。我错过了什么吗？有没有对phpdocx有更多经验的人来帮忙？

**编辑：** 嗯，我觉得自己像个白痴。在将问题缩小到输出文件的代码部分之后，我终于在 HEX 编辑器中打开了文件，发现问题是文件成功输出后，Web 前端会将其 HTML 的开头附加到末尾制作“损坏”文件的 docx 文件。`unlink()`在修复整个事情之后立即这一行：

```
exit;
```

**Pekka：**如果你想用新信息来回答这个问题，我会接受你的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:37:18.197

在将问题缩小到输出文件的代码部分之后，我终于在 HEX 编辑器中打开了文件，发现问题是文件成功输出后，Web 前端会将其 HTML 的开头附加到末尾的 docx 文件制作一个“损坏”的文件。`unlink()`在修复整个事情之后立即这一行：

```
exit;
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T23:32:24.310

如果不直接访问模板文件，这很难确定，但这里有一些模板引擎经常失败的指针：

*   尝试将所有 PHP 变量记录到控制台：`print print_r($this->rec->variable_name, true);`然后检查以确保所有变量都是字符串，并且没有一个为 NULL。
*   检查您的模板文件并确保样式（即字体类型、字体大小等）在每个模板变量中是一致的。换句话说，确保没有变量的一半与变量的其余部分的风格不同。这种特殊的微妙之处很容易在模板文件中引入，通常最简单的修复方法是简单地删除和重写每个模板变量。

最后，在调用该方法时尝试删除“html”参数`addTemplateVariable`，看看是否有区别。如果您实际上没有使用 HTML，那么传递 'html' 参数是没有意义的。相反，如果您使用的是 HTML，则损坏的文件可能是 HTML 结构不正确的情况，导致 Microsoft Word 将文档标记为已损坏。

# perl - 用perl从网站获取图片

> ID：10693664
> 
> 赞同：-1
> 
> 时间：2012-05-21T22:50:16.393
> 
> 标签：perl, file, save, uri, image

我正在寻找一种从网站保存图片的好方法。我得到了图片的网址。在 Perl 中保存图片的标准方法是什么？考虑将它们保存为数组或 .jpg 文件中的字符串。（哪个更好？）而且，我需要修改文件名的功能。感谢您的所有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T23:19:20.180

好吧，我猜标准方法如下：首先，您获取远程图片的内容，然后将该内容保存在您喜欢的任何名称（和路径）下。

这可以通过多种方式完成，我想最简单的方法就是使用简单的 CPAN 模块[LWP::Simple](https://metacpan.org/module/LWP%3a%3aSimple)：

```
use strict; 
use warnings; 
use LWP::Simple;

my $url = 'here goes some url'; 
my $file = 'here goes a filename'; 

getstore($url, $file); 
```

嗯，就是这样。) 是的，就这么简单。当然，它可能会被一些错误检查（和相关消息）修饰，但对于最简单的任务来说应该足够了。

甚至更好的是，它可以简化为单行：

```
perl -MLWP::Simple -e 'getstore("http://google.com/", "~/have/grabbed/the.internets")' 
```

# jquery - 下拉更改火显示相同的元素

> ID：10693665
> 
> 赞同：0
> 
> 时间：2012-05-21T22:50:18.377
> 
> 标签：jquery

```
<span id="row-0" class="row">
   <span class="Foo">
      <select name="first[]">
            <option value="XX">XX</option>
            <option value="YY">YY</option>
            <option value="ZZ">ZZ</option>
      </select>
   </span>
   <span class="Foo">
       <select name="second[]">
            <option value=""></option>
            <option value="AA">AA</option>
            <option value="BB">BB</option>
            <option value="CC">CC</option>
        </select>
   </span>
</span> 
```

我有一排有两个不同的选择。当两个都填满时，我想显示另一行。使用jquery如何实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:02:52.543

我不确定添加新行是什么意思。但一般来说，这就是您要寻找的。您需要捕获最后一个下拉列表的更改事件并创建该行的副本并附加到其父级。假设您的行跨度在带有 class 的 div 内`container`，这应该适用于您提供的 HTML 标记。

```
$(function(){   
    $(".container").on("change",".Foo:last",function(){
       var item=$(this);
       var rowClone=item.closest(".row").clone();   
       item.closest(".container").append(rowClone);
    });
}); 
```

这是一个示例：http: [//jsfiddle.net/Dbq3D/12/](http://jsfiddle.net/Dbq3D/12/)

这不会验证两个选择是否都已填充，因为您提供的标记已在第一个下拉列表中填充了一个值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T23:32:41.163

嗯..如何让第一个选项“做出你的选择”

```
$("select").change(function(){
   if ($("#row-0").find(':selected').not(:contains('make your choice')).size()>1)  
     {$("#row-0").append('<br/> yournewLine');}  
}); 
```

...这对我来说似乎很自然..我希望它可以帮助你

* * *

@Roko C. Buljan 说：“我现在可以想象另一个问题说：”是的，很好，现在我想从新选项中删除已经选择的选项“:)”。我想这也很简单，使用 :selected - Selector 就像：

```
$("select").change(function(){
    /*better read the value first*/
   $(":selected").not(:contains('make your choice')).remove();
}); 
```

# php - MySQL 搜索 w/ 有序通配符，并提取它们的值

> ID：10693667
> 
> 赞同：1
> 
> 时间：2012-05-21T22:50:35.563
> 
> 标签：php, mysql, regex, database, wildcard

是否可以进行通配符搜索，并提取通配符的值并将它们放入 MySQL 结果中？最好，我还想标记通配符。继续阅读以了解我的意思。

**示例：** 考虑具有以下结构的数据库表。

```
+----+-------------------+
| id | content           |
+========================+
| 1  |  %1.%2.%3         |
+----+-------------------+
| 2  |  Hey %name.       |
+----+-------------------+ 
```

首先，请注意*这只是一个示例*。我没有在单个数据库字段中存储多个值。请参阅此处：[在数据库列中存储分隔列表真的那么糟糕吗？](https://stackoverflow.com/questions/3653462/is-storing-a-comma-separated-list-in-a-database-column-really-that-bad)

相反，我想知道是否可以在数据库中使用通配符，然后将其与用户输入进行比较。换句话说，我想接受用户输入，例如`2.bla.^7`或类似的，然后返回相应的行--%.%.%。然后我想采用这些通配符，并将它们作为 MySQL 结果的一部分返回。`mysql_fetch_assoc()`下面是一个基于我正在寻找的示例 PHP结果。结果显然不需要完全像这样布置，但这*是*我正在寻找的结果。

**例子：**

```
/************************
 * Input:    2.bla.^7   *
 ************************/
Array
(
    [0] => Array
    (
        [id] => 1,
        [content] => %1.%2.%3
    ),

    [1] => Array
    (
        [1] => 2,
        [2] => bla,
        [3] => ^7
    )
)

/************************
 * Input:   Hey Matt.   *
 ************************/
Array
(
    [0] => Array
    (
        [id] => 2,
        [content] => Hey %1.
    ),

    [1] => Array
    (
        [name] => Matt
    )
) 
```

* * *

我知道我正在寻找的东西可能相当复杂，或者专门针对我的独特案例。如果您能指出我正确的方向，我将不胜感激！我什至不知道这是否可能 - 如果不是，将不胜感激替代解决方案！但是，我希望数据库结构尽可能接近相同。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:04:09.953

你不只是想做：

```
SELECT * FROM patterns WHERE 'user input' LIKE content; 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/4a5ab/1)上查看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T04:03:11.970

事实上，没有现成的解决方案。这是我要做的：

1) 添加 3 个特殊列`like_pattern`,`regexp_pattern`和`placeholders`. `content`它们的值是在将数据加载到表之前在 PHP 中或在插入/更新触发器之前从列中计算出来的。

*   `like_pattern VARCHAR(N)`- 反向搜索的 LIKE 模式
*   `regexp_pattern VARCHAR(N)`- 用于稍后在 PHP 中提取部分的正则表达式模式
*   `placeholders VARCHAR(N)`- 逗号分隔的占位符名称列表

这是示例：

```
+----+-------------+--------------+--------------------+--------------+
| id | content     | like_pattern | regexp_pattern     | placeholders |
+====+=============+==============+====================+==============+
| 1  |  %1.%2.%3   | %.%.%        | ^(.*)\.(.*)\.(.*)$ | 1,2,3        |
+----+-------------+--------------+-+------------------+--------------+
| 2  |  Hey %name. | Hey %.       | ^Hey (.*)\.$       | name         |
+----+-------------+--------------+--------------------+--------------+ 
```

2) 对于给定的字符串搜索记录，使用`like_pattern`：

```
SELECT * FROM patterns WHERE 'Hey Nathanael.' LIKE like_pattern; 
```

请注意，简单索引无法加速此查询，因为我们执行反向搜索，因此根据您的表有多大，您可能需要不同的解决方案。

3) 匹配字符串“Hey Nathanael”。反对`regexp_pattern`使用 PHP`preg_match()`或`ereg()`. 您将获得占位符值。

4) 将它们与列中的占位符名称结合起来`placeholders`。

就是这样。

# jquery - 将税收计算添加到 jQuery 计算插件

> ID：10693670
> 
> 赞同：0
> 
> 时间：2012-05-21T22:51:17.453
> 
> 标签：jquery, html, jquery-calculation

我正在使用在这里找到的非常有用的 jQuery 计算插件，

[http://www.pengoworks.com/workshop/jquery/calculation/calculation.plugin.htm](http://www.pengoworks.com/workshop/jquery/calculation/calculation.plugin.htm)

我正在使用它来计算报价单的行项目总计和小计。我让它工作，以便计算各个行项目和小计。不过，我的下一个要求是添加税额，最后是总计。这就是我的 jQuery 能力到此为止的地方。我尝试了一些事情，但最终破坏了一切。税额是固定的，所以我需要做的是获取小计并使用它来计算税额，然后将税额添加到小计以创建总计。

到目前为止，我有这个脚本，

```
<script type="text/javascript" src="/uploads/JS/jquery.calculation.min.js"></script>

<script type="text/javascript">    
    var bIsFirebugReady = (!!window.console && !!window.console.log);

    $(document).ready(

        function (){            
            // bind the recalc function to the quantity fields   
            $("input[id^=q]").bind("keyup", recalc);    
            $("input[id^=p]").bind("keyup", recalc);    
            // run the calculation function now    
            recalc();

            // automatically update the "#totalSum" field every time    
            // the values are changes via the keyup event
            $("input[name^=sum]").sum("keyup", "#totalSum");

            // this calculates the sum for some text nodes    
            $("#idTotalTextSum").click(

                function (){    
                    // get the sum of the elements    
                    var sum = $(".textSum").sum();

                    // update the total    
                    $("#totalTextSum").text("€" + sum.toString());    
                }    
            );

            // this calculates the average for some text nodes    
            $("#idTotalTextAvg").click(    
                function (){    
                    // get the average of the elements    
                    var avg = $(".textAvg").avg();    

                    // update the total    
                    $("#totalTextAvg").text(avg.toString());    
                }    
            );    
        }    
    );

    function recalc(){    
        $("[id^=total_item]").calc(   
            // the equation to use for the calculation    
            "qty * price",    
            // define the variables used in the equation, these can be a jQuery object

            {    
                qty: $("input[id^=q]"),   
                price: $("input[id^=p]")    
            },

            // define the formatting callback, the results of the calculation are passed to this function    
            function (s){    
                // return the number as a dollar amount    
                return "€" + s.toFixed(2);    
            },    
            // define the finish callback, this runs after the calculation has been complete    
            function ($this){    
                // sum the total of the $("[id^=total_item]") selector    
                var sum = $this.sum();    

                $("#myTotal").val(   
                    // round the results to 2 digits
                    "€" + sum.toFixed(2)    
                );    
            }    
        );    
    }    
</script> 
```

这是 HTML 的一个片段，

```
<tr>    
<td valign="middle" align="center" style="width: 15%;">    
<select class="cms_dropdown" id="t5" name="cntnt01fbrp__914">    
<option value="(none)">(none)</option>
<option value="tasks">Tasks</option>
<option value="resources">Resources</option>
<option value="expenses">Expenses</option>
<option value="other">Other</option>
</select>    
</td>   
<td class="quote_textarea" valign="middle" align="center">    
<textarea cols="80" rows="10" class="cms_textarea" id="d5" name="cntnt01fbrp__915">    
Shower Riser Budget    
</textarea>    
</td>    
<td valign="middle" align="center" style="width: 10%;">   
<input type="text" value="1" size="25" maxlength="80"   id="q5" name="cntnt01fbrp__916">    
</td>    
<td valign="middle" align="center" style="width: 10%;">    
<input type="text" value="€27.00" size="25" maxlength="80"   id="p5" name="cntnt01fbrp__917">    
</td>    
<td valign="middle" align="center" style="width: 10%" id="total_item_5"></td>    
</tr>

<tr>  
<td valign="middle" align="center" style="width: 15%;">   
<select class="cms_dropdown" id="t6" name="cntnt01fbrp__918">    
<option value="(none)">(none)</option>    
<option value="tasks">Tasks</option>    
<option value="resources">Resources</option>    
<option value="expenses">Expenses</option>    
<option value="other">Other</option>   
</select>    
</td>   
<td class="quote_textarea" valign="middle" align="center">    
<textarea cols="80" rows="10" class="cms_textarea" id="d6" name="cntnt01fbrp__919">    
Expenses    
</textarea>   
</td>    
<td valign="middle" align="center" style="width: 10%;">    
<input type="text" value="1" size="25" maxlength="80"   id="q6" name="cntnt01fbrp__920">    
</td>    
<td valign="middle" align="center" style="width: 10%;">    
<input type="text" value="€20.00" size="25" maxlength="80"   id="p6" name="cntnt01fbrp__921">   
</td>    
<td valign="middle" align="center" style="width: 10%" id="total_item_6"></td>  
</tr>

<tr>   
<td colspan="4" align="right">Subtotal </td>    
<td valign="middle" align="center"><input type="text" name="cntnt01fbrp__1104" value="0.00" size="25" maxlength="80" id="myTotal" /></td>    
</tr>             

<tr class="tax">  
<td colspan="4" align="right">Tax (19.6%)</td>        
<td valign="middle" align="center"><input type="text" name="cntnt01fbrp__1105" value="0.00" size="25" maxlength="80" id="tax"/></td>   
</tr>

<tr>    
<td colspan="4" align="right"><b>Total</b></td>    
<td valign="middle" align="center"><input type="text" name="cntnt01fbrp__1106" value="0.00" size="25" maxlength="80" id="total" /></td>    
</tr> 
```

如果有人能够提供帮助，将不胜感激。

非常感谢

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T02:45:08.543

更改 HTML 的税收部分：

```
<tr class="tax">
<td colspan="4" align="right">Tax (19.6%)</td>
<td valign="middle" align="center">
    <input type="hidden" name="cntnt01fbrp__1105" value="19.6" size="25" maxlength="80"
    id="tax" />
    <input type="text" id="taxAmount" name="taxAmount" size="25">
</td>
</tr>

<tr>
<td></td>
<td colspan="3" align="right"><button type="button" onclick="Compute();">Get Total</button>
</td>
<td valign="middle" align="center">
    <input type="text" name="cntnt01fbrp__1106" value="0.00" size="25" maxlength="80"
    id="newTotal" />
</td>
</tr> 
```

并将此函数添加到脚本中：

```
function Compute() {
        var Total = document.getElementById("myTotal").value;
        var Tax = document.getElementById("tax").value;
        var NewTotal = document.getElementById("newTotal");
        var TaxAmount = document.getElementById("taxAmount");
        Total = parseFloat(Total);
        Tax = parseFloat(Tax);
        TaxAmount.value = Math.max((Total * Tax) / 100).toFixed(2) + ""
        NewTotal.value = Math.max(Total + (Total * Tax) / 100).toFixed(2) + "";
    } 
```

如果您得到 NaN 结果，请从脚本和输入值中删除“€”符号。

# sqlite - 如何正确设计这个 SQLite 数据库？

> ID：10693678
> 
> 赞同：-1
> 
> 时间：2012-05-21T22:52:30.833
> 
> 标签：sqlite

我想在 SQLite 中创建一个包含两个表的数据库：客户和订单。每个客户可以有多个订单；（我知道这是一对多的关系）。除了信用卡信息、条款和运输信息（非地址类型信息）之外，每个订单还可以有许多“行项目”（行项目是“项目”的特定订单）。我需要能够找到任何特定客户的所有订单，但不必根据订单找到客户。

到目前为止，这是我对 Customer 表的内容：

```
[db executeUpdate:@"CREATE TABLE IF NOT EXISTS CustData ("
 "BUS_NAME TEXT PRIMARY KEY NOT NULL, "
 "EMAIL TEXT, "
 "PHONE TEXT, "
 "SHOP_NAME TEXT, "
 "SHOP_ADDR1 TEXT, "
 "SHOP_ADDR2 TEXT, "
 "SHOP_CITY_STATE TEXT, "
 "SHOP_ZIP TEXT, "
 "SHIP_NAME TEXT, "
 "SHIP_ADDR1 TEXT, "
 "SHIP_ADDR2 TEXT, "
 "SHIP_CITY_STATE TEXT, "
 "SHIP_ZIP TEXT, "
 "NOTES TEXT)"]; 
```

这就是我的 Order 表：

```
[db executeUpdate:@"CREATE TABLE Orders ("
 "CUST_ID TEXT REFERENCES CustData, "
 "ORDER_NBR TEXT, "
 "SALES_NAME TEXT, "
 "CREDIT_CARD TEXT, "
 "EXP_DATE TEXT, "
 "CID TEXT, "
 "NOTES TEXT, "
 "PCS INTEGER, "
 "PATTERN TEXT, "
 "STYLE_NAME TEXT, "
 "PRICE DECIMAL)" ]; 
```

PCS、Pattern、Style_Name 和 Price 被视为“行项目”。

我的问题是：关于“行项目”定义这些表格的正确方法是，还是有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T01:57:47.203

您的订单项设计不正确。

考虑就像一个客户有一个或多个订单一样，每个*订单*都有一个或多个订单项。因此，您应该有一个用于订单本身的表格和一个用于订单项的单独表格。这两个表之间唯一重复的列应该是唯一标识订单的列（或列）。

在您展示的设计中，这意味着将 PCS、Pattern、Style_Name 和 Price 与 Order_Nbr（如果仅此一项就足以识别订单）或 Cust_ID 和 Order_Nbr 一起拆分到行项目表中。

还要考虑一个客户可能有不同送货地址的订单，送货地址或帐单地址可能会随着时间而改变，送货地址和帐单地址实际上只是同一实体（某种事物）的简单实例，您可以看到您可能需要一个单独的表来保存链接到客户的地址。

您可能还需要考虑其他问题（例如存储信用卡信息的可取性），但这应该可以帮助您入门。

# c++ - CMake - 同时为 Windows 和 Linux 开发

> ID：10693681
> 
> 赞同：0
> 
> 时间：2012-05-21T22:52:58.840
> 
> 标签：c++, cmake, sdl

我正在用 C++ 和 SDL 开发一个用于 linux 竞赛的小游戏，但更喜欢在 Windows 上开发。是否有一个教程可以向我展示如何设置 CMake，以便我可以轻松地在 SVN 中获取代码，将副本拉到 Windows，并使用 Visual Studio 编辑/更新/编译它，并在同时将副本拉到 linux 并在那里构建它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T10:58:53.087

既然告诉你谷歌这是一个毫无意义的答案......

cmake -G "Visual Studio 10 Win64" c:\source

创建 VS 项目文件，您可以在 VS 中加载并在命令行中使用

msbuild 项目.sln

在 Linux 中：

cmake /源

和“制造”来建造

# css - CSS Html：Chrome上选定文本区域的圆角

> ID：10693683
> 
> 赞同：7
> 
> 时间：2012-05-21T22:53:19.373
> 
> 标签：css, google-chrome, rounded-corners

我正在尝试向我的网站添加一个带有圆角的文本区域。

我正在使用这个 CSS：

```
-webkit-border-radius: 6px;
-moz-border-radius: 6px;
border-radius: 6px; 
```

现在这在 chrome 中正确显示，但是当 textarea 获得焦点时，橙色边框被添加到 textarea 并且这样的边框没有圆角。

关于如何解决这个问题的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-21T23:06:50.440

To remove the default `outline`, and then emulate that outline with one that's more...style-compliant:

```
textarea {
    width: 40%;
    height: 10em;
    border-radius: 1em;
    border: 1px solid #000; /* everything up to and including this line
                               are aesthetics, adjust to taste */
    outline: none; /* removes the default outline */
    resize: none; /* prevents the user-resizing, adjust to taste */
}

textarea:focus {
    box-shadow: inset 0 0 3px 2px #f90; /* provides a more style-able
                                           replacement to the outline */
}​ 
```

[JS Fiddle demo](http://jsfiddle.net/davidThomas/84mpn/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:03:47.163

`textarea:focus{outline:none}` should do it, although its pretty hard to answer without seeing it

# grid - 行编辑插件上的 Extjs4 无限滚动分页

> ID：10693689
> 
> 赞同：0
> 
> 时间：2012-05-21T22:54:06.230
> 
> 标签：grid, infinite-scroll, extjs4.1

我试图让无限滚动工作并浏览相关的博客和帖子，但无法弄清楚为什么当我的垂直滚动器到达 numfromedge 时它不会向服务器发出任何请求？

我是否正确理解这一点，当垂直滚动条到达 numfromedge 时，商店将向服务器发出请求？这意味着在服务器端我们必须管理查询并按页面返回？还是我一次从服务器返回所有记录？因为如果我将leadingBufferedZone 设置为 100 并将 purgePageCount 设置为 0 那么大约有 7 个请求向服务器发出每个大小为 50 的请求？但在这种情况下，如您所见，这不会发生在 numfromedge 上，而是在开始时发生......

我的网格

```
Ext.define('AM.Something', {
extend : 'Ext.grid.Panel',
alias : 'widget.something',
title : 'something',
store : 'somethingStore',
    verticalScroller: {
        numFromEdge: 10,
        trailingBufferZone: 10,
        leadingBufferZone: 10
    },
verticalScrollerType: 'paginggridscroller',
invalidateScrollerOnRefresh: false,
disableSelection:true,

selType : 'rowmodel',
features : [ somefiltering],
plugins : // Row editing plugin .... 
```

我的商店

```
Ext.define('AM.somethingStore', {
extend: 'Ext.data.Store',
model: 'AM.somethingModel',
autoLoad : true,
autoSync: true,
//    remoteSort:true,
buffered : true,
//    leadingBufferedZone:100,
//    purgePageCount:0,
pageSize:50,
proxy: {
    type: 'ajax',
    api :
        {
            read : 'something/fetch',
            update:'something/update',
            create :'something/create',
            destroy : 'something/delete'
        },
    reader :
        {
        type : 'json',
        root : 'someList.content', // an array of rows for the grid
        successProperty : 'success',
        idProperty : 'id',
        totalProperty: 'total'
        },

    writer :
        {
        type : 'json',
        allowSingle : true
        }

} 
```

我在后端使用 spring-data 和 spring 控制器

```
 @RequestMapping(value = "/something/fetch", method = RequestMethod.GET)
public @ResponseBody
Map<String, ? extends Object> fetchPricing(@RequestParam Integer page,  @RequestParam Integer limit ) {
 Page<Somethings> someList= someService.fetchSomething(page-1,limit);
 Map<String, Object> responseMap = new HashMap<String, Object>();
 responseMap.put("success", true);
 responseMap.put("someList", someList);
return responseMap;
    } 
```

我期待当滚动条到达网格中显示的最后一条记录的 10 以内时，商店会向服务器发送请求 page2 和 pagesize limit ..

有什么配置不正确吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:33:26.743

店铺

```
//autoLoad : true,
autoSync: true,
//remoteSort:true,
remoteFilter:true,
buffered : true,
leadingBufferedZone:200,
purgePageCount:0,
pageSize:50 
```

网格

```
verticalScroller: {
        numFromEdge: 10,
        trailingBufferZone: 10,
        leadingBufferZone: 10
    },
verticalScrollerType: 'paginggridscroller',
invalidateScrollerOnRefresh: false,
disableSelection:true, 
```

# eclipse - 你能在 Eclipse 格式化程序中更改预览代码吗

> ID：10693691
> 
> 赞同：4
> 
> 时间：2012-05-21T22:54:13.440
> 
> 标签：eclipse

是否可以更改 Eclipse 格式化程序使用的“预览”代码？

例如，*Window->Preferences->Java-Code Style->Formatter->Indentation*选项卡显示以下预览代码：

```
int[]   myArray     = {
        1,
        2,
        3,
        4,
        5,
        6           }; 
```

我想将其更改为：

```
int[]   myNewPreviewArray       = {
        11,
        12,
        13,
        14,
        15,
        16          }; 
```

我想补充一些默认预览代码中没有处理的情况。

# c - 计算百分位数

> ID：10693692
> 
> 赞同：1
> 
> 时间：2012-05-21T22:54:15.950
> 
> 标签：c

我需要一个小程序：

1.  读取自然数 n
2.  然后读取 n 个实数 r0,r1,r2,...,rn
3.  然后读取另一个实数 x

然后打印 x 相对于数字 r0,r1,r2,...,rn 的百分位数大小

```
 #include<stdio.h>

int main(){

int n, i=0;
double r[1000], x;

printf("Enter how many numbers\n");
scanf("%i", &n);

printf("Enter numbers\n");
while(i<n){
    scanf("%lf", &r[i]);
    i++;
    }

printf("Enter x:\n");
scanf("%lf", &x);
// need part here
// where percentiles are calculated

} 
```

所以这是我的问题，我怎么能计算出百分位数？我已经阅读了很多关于百分位数的文章，但我仍然不明白，所以也许有人会向我解释我需要做什么，或者只是向我展示如何计算百分位数的模式。我对 C 语言有点了解，所以如果有人向我解释如何计算百分位数，我可以单独编写；o

PS关于来自维基百科的百分位数

在统计学中，百分位数（或百分位数）是某个变量的值，低于该值的观察值百分比。例如，第 20 个百分位是可以找到 20% 观察值的值（或分数）。第 25 个百分位数也称为第一个四分位数 (Q1)，第 50 个百分位数称为中位数或第二个四分位数 (Q2)，第 75 个百分位数称为第三个四分位数 (Q3)。

编辑：好的，一切正常（我认为），但我还有 1 个问题：我的代码看起来

```
#include<stdio.h>

void sortowanie( double r[1000], int n){
    int i,j;
    double temp;
    for(i=0; i<n; i++)
        for(j=0;j<n-1; j++){
            if (r[j]>r[j+1]){
                temp=r[j+1];
                r[j+1]=r[j];
                r[j]=temp;
                }

            }
}

int centyl(double x, int n){
int temp, wynik;
temp=n-x;
wynik=100*temp/n;
return wynik;

}

int main(){

int n, i=0;
double r[1000], x;

printf("Enter how many numbers\n");
scanf("%i", &n);

printf("Enter numbers\n");
while(i<n){
    scanf("%lf", &r[i]);
    i++;
    }

printf("Enter x:\n");
scanf("%lf", &x);

sortowanie(r, n);

printf("Centyl to %i\n", centyl(x, n) );

return 0;
} 
```

并且想知道我可以采取什么保护措施来不破坏该程序？我可以在这里进行任何保护吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:11:02.093

这更与数学相关，更适合[数学](https://math.stackexchange.com/)论坛。但是，我会为您省去麻烦，因为线程已经在这里。

要找到任何事物的百分位数，只需考虑以下事项：

如果你在 200 名学生中排在第 25 位，那么你的成绩比他们中的 175 名要好。为了找到你的百分位数，你可以用你做得比学生总数更好的学生数除以学生总数。

例如：

```
1\. 200 - 25 = 175

2\. 175 / 200 = 87.5 = 88th Percentile 
```

这是找到百分位数的一种非常简单的方法——它很容易理解并且总是有效的。我希望这可以帮助你。

# java - DirectoryScanner：使用 ant 文件集的 getExcludedFiles 性能问题

> ID：10693694
> 
> 赞同：3
> 
> 时间：2012-05-21T22:54:29.193
> 
> 标签：java, ant, fileset

有没有办法加快 getExcludedFiles() 的性能？我一直在玩文件集模式，但没有得到任何改进。

这是我的情况：

我有一个用这些模式定义的文件集：

```
basedir/normal/abc/control/*.ins
basedir/normal/abc/models/bx/cells/*.l 
```

下`basedir/normal`，还有大约一百个其他子目录，但我只对 abc 感兴趣。但是，当我调用 时`DirectoryScanner.getExcludedFiles()`，我认为它调用了 slowScanner() 并且显然它必须扫描所有其他子目录，这导致了 24 小时的周转。任何帮助将不胜感激。

提前致谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:19:04.797

您应该将`dir`文件设置为，`basedir/normal/abc`然后您的模式将是：

```
control/*.ins
models/bx/cells/*.l 
```

# python - 在 openshift 上的 Bottle.py 应用程序中加载静态文件

> ID：10693695
> 
> 赞同：2
> 
> 时间：2012-05-21T22:54:31.013
> 
> 标签：python, bottle, openshift

我正在开发一个应用程序，托管在 openshift 上并建立在他们的 bottle.py 快速入门示例（[https://github.com/openshift/bottle-openshift-quickstart](https://github.com/openshift/bottle-openshift-quickstart)）上，但我很难正确使用静态文件. 我有一个本地版本，可以与瓶子中内置的服务器一起使用，但是当我将本地工作的内容转移到 openshift 应用程序中时，它的行为会有所不同。

在我的本地 main.tpl 中，以下行用于指示应加载哪些文件...

```
<link rel="stylesheet" href="{{ get_url('static', file_name='base.css') }}">
<link rel="stylesheet" href="{{ get_url('static', file_name='skeleton.css') }}">
<link rel="stylesheet" href="{{ get_url('static', file_name='layout.css') }}"> 
```

在我的本地 app.py 中，以下代码尝试提供正确的文件...

```
app = default_app()

@route('/')
@view('main.tpl')
def index():
    return {'get_url': app.get_url}

@route('/static/<file_name>', name="static")
def send_static(file_name):
    if file_name[-3:] == 'css':
        return static_file(file_name, root=os.path.join(os.getcwd(), 'static', 'styles')) 
```

有条件是因为我试图找出一种方法来保持 /static 目录的组织，而不必编写几个类似`send_static`的函数，一个具有 css 文件的根位置，一个具有 js 文件的根位置或其他。

当代码在 openshift 中使用时，它不再起作用，本地版本在显示的页面中插入“/static/styles/base.css”，openshift 版本只插入“/static/base.css”。为了让 css 文件加载，我偶然发现了以下代码。

我的 main.tpl 保持不变......

```
<link rel="stylesheet" href="{{ get_url('static', file_name='base.css') }}">
<link rel="stylesheet" href="{{ get_url('static', file_name='skeleton.css') }}">
<link rel="stylesheet" href="{{ get_url('static', file_name='layout.css') }}"> 
```

但是在我的 openshift app.py 中，我必须明确地将子目录放入路由中

```
application = default_app()

@route('/')
@view('main.tpl')
def index():
    return {'get_url': application.get_url}

@route('/static/styles/<file_name>', name="static")
def send_static(file_name):
    if file_name[-3:] == 'css':
        root_dir = os.path.join(os.getcwd(), 'static', 'styles')
        return static_file(file_name, root=root_dir) 
```

我是否遗漏了导致差异的 openshift 服务器环境？该应用程序正在运行，但我真的很想知道加载和显示 css 文件的正确方法。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T06:31:13.200

我已经评估了你的项目。你遇到了这个问题，完全是由错误的配置引起的。首先，参考这里的资源。 [如何将 javascript 或 css 文件加载到 BottlePy 模板中？](https://stackoverflow.com/questions/6978603/how-to-load-a-javascript-or-css-file-into-a-bottlepy-template)

你会注意到，你可以设置哈希来映射你的静态文件夹

```
@route('/static/:path#.+#', name='static')
def static(path):
    return static_file(path, root='static') 
```

另一个问题，我们需要在您的 openshift 环境中明确设置视图路径。

```
 from bottle import TEMPLATE_PATH                                               

   import os                                                                      
   views_path = os.environ['APPDIR'] + '/repo/wsgi/views'                         
   TEMPLATE_PATH.insert(0,views_path)                                             
   app = default_app() 
```

模板中的视图：

```
<head>                                                                         
<script type="text/javascript" src="{{ get_url('static', path='js/main.js') }}" charset="utf-8"></script>                                                
</head>                                                                        
<body>                                                                         
<p>it's works</p>                                                              
</body>                                                                        
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T17:47:26.713

如果您的瓶子在视图文件夹中看不到 tpl 文件。

我用了：

```
TEMPLATE_PATH.append(os.path.join(os.environ['OPENSHIFT_REPO_DIR'], 'wsgi/views/')) 
```

它有效。

# css - boxshadow 以匹配设计

> ID：10693698
> 
> 赞同：0
> 
> 时间：2012-05-21T22:55:19.147
> 
> 标签：css

我得到了这个设计：

[http://img526.imageshack.us/img526/1363/desginer.jpg](http://img526.imageshack.us/img526/1363/desginer.jpg)

我正在尝试使用以下方法获得最佳结果：

```
 div.image {
            -moz-box-shadow: 0 0 1px 1px #bbb;
            -webkit-box-shadow: 0 0 1px 1px #bbb;
            box-shadow: 0 0 1px 1px #bbb;
            padding: 2px;
            width: 120px;
            height: 120px;
        }

<div class="image"><img width="120" height="120" src="image.jpg" title="title" alt="alt" /></div> 
```

但是我尝试了很多值，但我仍然不确定什么是最好的。有小费吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:00:32.267

this does what you want; no 3rd value, a bit more on the 4th [http://jsfiddle.net/jalbertbowdenii/LAT5B/](http://jsfiddle.net/jalbertbowdenii/LAT5B/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T23:04:39.517

[http://www.css3.info/preview/box-shadow/](http://www.css3.info/preview/box-shadow/)

From the page:

> **The Syntax:**
> box-shadow: none | < shadow > [ , < shadow > ]*
> < shadow > = inset? && [ < length >{2,4} && < color >? ]

So, the first values can be the `X`(left) and `Y`(top) position, the third is the blur spred and the fouth is the color.

You can also specify `inset` at the start to create a inner shadow.

In your case, you will have to zero the top and left offset and define a blur radius accordingly:

```
div.image {
    ...
    -moz-box-shadow: 0 0 5px #bbb;
    -webkit-box-shadow: 0 0 5px #bbb;
    box-shadow: 0 0 5px #bbb;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T23:04:43.450

For me, with that the perfect values : [http://jsfiddle.net/D2LVq/1/](http://jsfiddle.net/D2LVq/1/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T23:04:46.680

The closest I can get a shadow to your sample is this: `0 0 8px #666`

# python - 在 Google App Engine 上使用 Python 计算城市之间的距离并根据 GeoPT 查找周边城市

> ID：10693699
> 
> 赞同：5
> 
> 时间：2012-05-21T22:55:21.307
> 
> 标签：python, google-app-engine, geolocation, distance

我定义了一个城市模型，它保存了一个城市的`geoname_id`和`location`（作为GeoPt）。我想实现两件事。

1.  我想`500km`从给定城市获取半径范围内的所有城市。
2.  我想计算`km`两个给定城市之间的距离。

实现这一目标的最佳方法是什么，请记住我有一个非常大的城市数据库，我不想在性能因素上牺牲太多。任何帮助或建议表示赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T20:53:30.957

这很完美，但速度有点慢：

计算距离的函数。传递给此函数的参数是位置或 Geopt() 的纬度和经度元组：

```
def HaversineDistance(location1, location2):
  """Method to calculate Distance between two sets of Lat/Lon."""
  lat1, lon1 = location1
  lat2, lon2 = location2
  earth = 6371 #Earth's Radius in Kms.

 #Calculate Distance based in Haversine Formula
 dlat = math.radians(lat2-lat1)
 dlon = math.radians(lon2-lon1)
 a = math.sin(dlat/2) * math.sin(dlat/2) + math.cos(math.radians(lat1)) * math.cos(math.radians(lat2)) * math.sin(dlon/2) * math.sin(dlon/2)
 c = 2 * math.atan2(math.sqrt(a), math.sqrt(1-a))
 d = earth * c
 return d 
```

计算半径内的周边城市的功能。这是存储所有城市的 City 模型下的方法：

```
def get_closest_cities(self, kms):
  cities = []
  #Find surrounding Cities of a given city within a given radius
  allcities = self.country.city_set
  for city in allcities:
    distance = HaversineDistance((self.location.lat, self.location.lon),(city.location.lat, city.location.lon))
    if not distance >= kms:
      cities.append((city.name, int(distance)))
  cities.remove(cities[0])
  return cities 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T00:00:24.750

Google App Engine 不支持地理空间查询，但您可以参考[Geospatial Queries with Google App Engine using GeoModel](https://developers.google.com/maps/articles/geospatial)。

您可能还想考虑使用`mongoDB`支持[地理空间索引](http://www.mongodb.org/display/DOCS/Geospatial+Indexing)的其他数据库，并可能将其作为仅执行此操作的外部服务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T23:05:23.683

1.  您可以使用类似于[https://developers.google.com/appengine/articles/geosearch的内容](https://developers.google.com/appengine/articles/geosearch)
2.  只需加载两个城市的位置并使用三角函数来计算距离。参见例如[http://www.movable-type.co.uk/scripts/latlong.html](http://www.movable-type.co.uk/scripts/latlong.html)

# animation - FlexSlider - 从左到右的幻灯片

> ID：10693700
> 
> 赞同：3
> 
> 时间：2012-05-21T22:55:21.457
> 
> 标签：animation, slideshow, flexslider

我正在使用 flexslider，它工作正常。但是如何将幻灯片更改为“从左到右”？只有 2 个动画：淡入淡出和滑动（从右到左）。请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:05:12.250

在 1.8 版中有一个名为“reverse”的新属性。如果将其设置为 true，则滑块将从左到右设置动画。

阅读关于属性： [https ://github.com/woothemes/FlexSlider](https://github.com/woothemes/FlexSlider)

下载 v1.8： [https ://github.com/woothemes/FlexSlider/downloads](https://github.com/woothemes/FlexSlider/downloads)

# python - 如何从 Python 脚本中包装交互式 ssh 会话的调用？

> ID：10693704
> 
> 赞同：2
> 
> 时间：2012-05-21T22:56:24.000
> 
> 标签：python, ssh

我正在编写一个 SSH 命令行包装器，但我发现它不想以交互方式运行。

假设我确实有`ssh.py`应该建立一个交互式`ssh`会话。

如果我运行：

*   `subprocess.open('ssh -t server')`并且`p.wait()`，我会得到一个错误： `Pseudo-terminal will not be allocated because stdin is not a terminal.`
*   如果我试图通过使用它来强制`-t -t`它会阻塞。

注意：我真的需要一个交互式会话，因为我尝试使用它`screen`来恢复以前的连接。

我怎么解决这个问题？

注意：我不想以任何方式控制从 python 调用的 ssh。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T10:12:14.547

您可能想改用[Fabric 。](http://fabfile.org)

# python - 创建辅助站点包目录（并从其中的 .pth 文件加载包）

> ID：10693706
> 
> 赞同：20
> 
> 时间：2012-05-21T22:56:32.347
> 
> 标签：python, pythonpath

我想将一些软件包安装到第三方`site-packages`目录（超出标准系统位置）。有什么方法可以设置它以便尊重其中的 .pth 文件？

* * *

背景：我正在使用 OS X、virtualenv 和 homebrew。有一些包（在我的例子中尤其是 wxPython）不能通过 pip 很好地安装到 virtualenv 中。在这些情况下，可以使用自制软件包来代替它们。Homebrew 在`/usr/local/lib/python2.7`. 我想简单地指向这个文件夹，并让那里的所有项目的维护都在`brew`'s 的控制之下。然而，这似乎是不可能的。

*   附加到路径 via`$PYTHONPATH`不会加载 .pth 文件。（[OS X 上的 Python 2.6 是否应该处理 $PYTHONPATH 中的多个 easy-install.pth 文件？](https://stackoverflow.com/questions/2794107/should-python-2-6-on-os-x-deal-with-multiple-easy-install-pth-files-in-pythonpa)）
*   Python 不允许嵌套或递归使用 .pth 文件。（[嵌套的 .pth 文件或从网络加载额外的站点目录](https://stackoverflow.com/questions/6600938/nested-pth-files-or-loading-extra-site-dirs-from-a-network)）
*   virtualenv 的包装器`add2virtualenv`除了简单地列出目录之外，还为 .pth 文件添加了一些额外的智能，但我相信它只是重新排序路径列表。

我当然不是唯一对这个问题感兴趣的人。我敢打赌，我偶然发现的许多通用的“pth files not working”问题和在线帖子都与这个问题有关。有没有好的解决方案？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-21T23:06:08.803

看一下[站点](http://docs.python.org/library/site.html)模块。它提供了[`addsitedir`](http://docs.python.org/library/site.html#site.addsitedir)应该做你想做的事情的功能。

使用它的最简单方法是创建一个名为`sitecustomize.py`or的文件`usercustomize.py`，并将其放在当前`PYTHONPATH`目录（或任何以 结尾的目录`sys.path`）中，内容如下：

```
import site
site.addsitedir('/usr/local/lib/python2.7') 
```

当 Python 开始尝试导入时`sitecustomize`，然后`usercustomize`，这就是它起作用的原因。从网站文档：

> 在这些路径操作之后，尝试导入一个名为 的模块`sitecustomize`，该模块可以执行任意特定于站点的自定义。它通常由系统管理员在 site-packages 目录中创建。如果此导入因`ImportError`异常而失败，则会被静默忽略。
> 
> 在此之后，尝试导入一个名为 的模块，如果为真`usercustomize`，该模块可以执行任意用户特定的自定义。`ENABLE_USER_SITE`该文件旨在在用户站点包目录（见下文）中创建，`sys.path`除非被`-s`. An`ImportError`将被默默地忽略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-16T08:59:48.090

[PEP 370](https://www.python.org/dev/peps/pep-0370/)专门针对每个用户目录的创建，`site-packages`以处理用户对系统范围没有管理员访问权限的情况`site-packages`。

例如在 Unix（包括 Mac OS）上，假设使用 Python 3.6，可以创建以下目录并`.pth`在其中放置文件

`~/.local/lib/python3.6/site-packages`

# dependency-injection - Autofac.Core.DependencyResolutionException

> ID：10693711
> 
> 赞同：7
> 
> 时间：2012-05-21T22:57:24.017
> 
> 标签：dependency-injection, autofac

我是 Autofac 的新手，我希望对以下例外有更好的理解。对此的任何帮助/指针将不胜感激！

获得关注`Autofac.Core.DependencyResolutionException`。

```
未处理的异常：
    Autofac.Core.DependencyResolutionException：
        在“Test.Authorization.LoginService”类型上使用“公共绑定标志”找到的任何构造函数都不能使用可用的服务和参数调用：
         无法解析构造函数 'Void .ctor(System.Func`1[System.IO.Stream], System.Func`1[System.IO.Stream] 的参数 'System.Func`1[System.IO.Stream] readStream' )'。
    在 Autofac.Core.Activators.Reflection.ReflectionActivator.ActivateInstance(IComponentContext context, IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Activators\Reflection\ReflectionActivator.cs:line 117    
    在 Autofac.Core.Resolving.InstanceLookup.Activate(IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Resolving\InstanceLookup.cs:line 79
    在 Autofac.Core.Resolving.InstanceLookup.Execute() 在 \autofac\src\Source\Autofac\Core\Resolving\InstanceLookup.cs:line 62
    在 Autofac.Core.Resolving.ResolveOperation.GetOrCreateInstance(ISharingLifetimeScope currentOperationScope, IComponentRegistration 注册, IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Resolving\ResolveOperation.cs:line 124
    在 Autofac.Core.Resolving.InstanceLookup.ResolveComponent(IComponentRegistration 注册，IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Resolving\InstanceLookup.cs:line 115  
    在 Autofac.Features.Collections.CollectionRegistrationSource.c__DisplayClass4.c__DisplayClass6.b__1(IComponentRegistration cr) 在 \autofac\src\Source\Autofac\Features\Collections\CollectionRegistrationSource.cs: System.Linq.Enumerable.WhereSelectArrayIterator`2.MoveNext 的第 80 行()  
    在 System.Linq.Buffer`1..ctor（IEnumerable`1 源）    
    在 System.Linq.Enumerable.ToArray[TSource]（IEnumerable`1 源）
    在 Autofac.Features.Collections.CollectionRegistrationSource.c__DisplayClass4.b__0(IComponentContext c, IEnumerable`1 p) 在 \autofac\src\Source\Autofac\Features\Collections\CollectionRegistrationSource.cs:line 80    
    在 Autofac.Core.Activators.Delegate.DelegateActivator.ActivateInstance(IComponentContext context, IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Activators\Delegate\DelegateActivator.cs:line 65
    在 Autofac.Core.Resolving.InstanceLookup.Activate(IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Resolving\InstanceLookup.cs:line 79   
    在 Autofac.Core.Resolving.InstanceLookup.Execute() 在 \autofac\src\Source\Autofac\Core\Resolving\InstanceLookup.cs:line 62   
    在 Autofac.Core.Resolving.ResolveOperation.GetOrCreateInstance(ISharingLifetimeScope currentOperationScope, IComponentRegistration 注册, IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Resolving\ResolveOperation.cs:line 124    
    在 Autofac.Core.Resolving.InstanceLookup.ResolveComponent(IComponentRegistration 注册，IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Resolving\InstanceLookup.cs:line 115  
    在 Autofac.Core.Activators.Reflection.AutowiringParameter.c__DisplayClass2.b__0() 在 \autofac\src\Source\Autofac\Core\Activators\Reflection\AutowiringParameter.cs:line 51    
    在 Autofac.Core.Activators.Reflection.ConstructorParameterBinding.Instantiate() 在 \autofac\src\Source\Autofac\Core\Activators\Reflection\ConstructorParameterBinding.cs:line 113    
    在 Autofac.Core.Activators.Reflection.ReflectionActivator.ActivateInstance(IComponentContext context, IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Activators\Reflection\ReflectionActivator.cs:line 119    
    在 Autofac.Core.Resolving.InstanceLookup.Activate(IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Resolving\InstanceLookup.cs:line 79   
    在 Autofac.Core.Resolving.InstanceLookup.b__0() 在 \autofac\src\Source\Autofac\Core\Resolving\InstanceLookup.cs:line 64   
    在 Autofac.Core.Lifetime.LifetimeScope.GetOrCreateAndShare(Guid id, Func`1 creator) 在 \autofac\src\Source\Autofac\Core\Lifetime\LifetimeScope.cs:line 269    
    在 Autofac.Core.Resolving.InstanceLookup.Execute() 在 \autofac\src\Source\Autofac\Core\Resolving\InstanceLookup.cs:line 64   
    在 Autofac.Core.Resolving.ResolveOperation.GetOrCreateInstance(ISharingLifetimeScope currentOperationScope, IComponentRegistration 注册, IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Resolving\ResolveOperation.cs:line 124    
    在 Autofac.Core.Resolving.ResolveOperation.ResolveComponent(IComponentRegistration 注册，IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Resolving\ResolveOperation.cs:line 69
    在 Autofac.Core.Resolving.ResolveOperation.Execute（IComponentRegistration 注册，IEnumerable`1 参数）在 \autofac\src\Source\Autofac\Core\Resolving\ResolveOperation.cs:line 96
    在 Autofac.Core.Lifetime.LifetimeScope.ResolveComponent(IComponentRegistration 注册，IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Lifetime\LifetimeScope.cs:line 235    
    在 Autofac.Core.Container.ResolveComponent(IComponentRegistration 注册，IEnumerable`1 参数) 在 \autofac\src\Source\Autofac\Core\Container.cs:line 191    
    在 Autofac.ResolutionExtensions.TryResolveService(IComponentContext context, Service service, IEnumerable`1 parameters, Object& instance) in \autofac\src\Source\Autofac\ResolutionExtensions.cs:line 728    
    在 Autofac.ResolutionExtensions.ResolveService（IComponentContext 上下文，服务服务，IEnumerable`1 参数）在 \autofac\src\Source\Autofac\ResolutionExtensions.cs:line 346    
    在 Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType, IEnumerable`1 parameters) in \autofac\src\Source\Autofac\ResolutionExtensions.cs:line 244 at Autofac.ResolutionExtensions.Resolve[TService](IComponentContext context, IEnumerable`1参数）在 \autofac\src\Source\Autofac\ResolutionExtensions.cs:line 197    
    在 Autofac.ResolutionExtensions.Resolve[TService](IComponentContext context, Parameter[] 参数) 在 \autofac\src\Source\Autofac\ResolutionExtensions.cs:line 213

```

这是我的cs代码：

```
 public sealed class AuthorizationModule : Module
    {
        protected override void Load(ContainerBuilder builder)
        {
            builder
            .Register(LoginService)
            .AsImplementedInterfaces()
            .SingleInstance();
        }

     static LoginService LoginService(IComponentContext c)
     {
         var file = c.Resolve<IFile>();
         var dataPath = <Some Path>;

         return new LoginService
         (readStream: () => file.Open(dataPath),
          writeStream: () => file.Create(dataPath));
     }
    }

    sealed class LoginService : TLoginService.Iface, IService
    {
        readonly Func<Stream> _readStream;
        readonly Func<Stream> _writeStream;
        readonly XmlSerializer _serializer;

        public LoginService(
          Func<Stream> readStream,
          Func<Stream> writeStream
        )
        {
           Contract.Requires(readStream != null);
           Contract.Requires(writeStream != null);
           _readStream = readStream;
           _writeStream = writeStream;
           _serializer = new XmlSerializer(typeof (List<LoginRecord>));
     }
     ...
     ... 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T23:54:47.933

你的`LoginService`类有一个类似于`LoginService(Func<System.IO.Stream> stream)`. Autofac 无法创建`Func<System.IO.Stream>`参数。所以适当地注册它，以便 Autofac 可以创建`LoginService`.

例如：

```
builder.Register(c => new LoginService(d => File.Open("Foo)); 
```

浏览Wiki 的[组件注册](http://code.google.com/p/autofac/wiki/ComponentCreation)部分以找到适合您的方法。

# c++ - makefile 和多文件 C++ 模板问题

> ID：10693712
> 
> 赞同：2
> 
> 时间：2012-05-21T22:57:28.867
> 
> 标签：c++, templates, makefile

我有一个 C++ 模板类使用 #include 指令拆分为两个文件，如此链接中所建议的 -->[模板分布在多个文件中](https://stackoverflow.com/questions/36039/templates-spread-across-multiple-files)

对于这两个文件，我使用了标准命名 *.h 和 *.cpp。在 makefile 中，我已经包含了 *.h 一个，因为 - 据我了解 - 从编译器的角度来看，以这种方式拆分的两个文件实际上都是一个。我设置了与编译常用 *.cpp 文件相同的编译选项。

但是，当我尝试通过 makefile 编译它时，出现以下错误：

```
Stos.o: file not recognized: File format not recognized
collect2: ld returned 1 exit status
make: *** [program] Error 1 
```

我在某处读到这可能是因为我编译了 *.h 文件。我不知道我应该怎么做。

感谢您的帮助。

### 编辑

我正在发布 makefile 本身以使事情更清楚。请原谅我的名字不是英文的，但是在这种情况下这应该不是问题。我已经更新了错误消息，使其适合 makefile。

由于这里的建议，我已经将模板文件的名称从上面提到的 *.h 和 *.cpp 更改为 *.hpp 和 *.tpp。

```
CC=g++
CFLAGS=-c -Wall -pedantic -W
COMP= $(CC) $(CFLAGS)

program: Graf.o wgraf.o wnazwe.o menu.o Stos.o TabDyn.o komunikaty.o main.o
    $(CC) Graf.o wgraf.o wnazwe.o menu.o Stos.o TabDyn.o komunikaty.o main.o -o program
Graf.o: graf_struktura/Graf.cpp graf_struktura/Graf.h lifo/TabDyn.hpp lifo/Stos.hpp
    $(COMP) graf_struktura/Graf.cpp -o $@
wgraf.o: wczytywanie_grafu/wczytaj_graf.cpp wczytywanie_grafu/wczytaj_graf.h    graf_struktura/Graf.h lifo/Stos.hpp
    $(COMP) wczytywanie_grafu/wczytaj_graf.cpp -o $@
wnazwe.o: wczytywanie_grafu/wczytaj_nazwe_pliku.cpp    wczytywanie_grafu/wczytaj_nazwe_pliku.h wczytywanie_grafu/komunikaty.cpp 
    $(COMP) wczytywanie_grafu/wczytaj_nazwe_pliku.cpp -o $@
komunikaty.o: wczytywanie_grafu/komunikaty.cpp
    $(COMP) wczytywanie_grafu/komunikaty.cpp
menu.o: menu/menu.cpp graf_struktura/Graf.h
    $(COMP) menu/menu.cpp
main.o: main.cpp wczytywanie_grafu/wczytaj_nazwe_pliku.h    wczytywanie_grafu/wczytaj_graf.h menu/menu.cpp graf_struktura/Graf.h
    $(COMP) main.cpp
#Here is the issue.
Stos.o: lifo/Stos.hpp lifo/Stos.tpp lifo/TabDyn.hpp
    $(COMP) lifo/Stos.hpp -o $@
TabDyn.o: lifo/TabDyn.hpp lifo/TabDyn.tpp
    $(COMP) lifo/TabDyn.hpp -o $@ 
```

编译器实际上创建了“Stos.o”，但未能将其包含在“程序”中，从而产生引用错误。

希望现在我的问题更清楚了。抱歉，如果 makefile 不优雅。我仍然是makefile的初学者，请理解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T23:55:00.103

如果您的 MyClass.h 看起来像

```
#ifndef MYCLASS_H
#define MYCLASS_H
template<typename T>
  struct MyClass
  {
    void f();
  };
#include "MyClass.tcc"
#endif 
```

MyClass.tcc 文件看起来像

```
template<typename T>
  void
  MyClass::f(T)
  { } 
```

然后使用模板的代码，比如在一个名为 main.cpp 的文件中，如下所示：

```
#include "MyClass.h"

int main()
{
  MyClass<int> m;
  m.f(1);
} 
```

Makefile 可能看起来像：

```
main: main.o
    $(CXX) $^ $(LDFLAGS) -o $@

main.o: main.cpp MyClass.h MyClass.tcc
    $(CXX) $(CXXFLAGS) $< -o $@ 
```

makefile 不应该**编译**模板头文件，它将 main.cpp 文件编译为 .o，并将头文件列为依赖项。如果任何一个标题或`main.cpp`更改，`main.o`则将重新编译。但是不要编译标题。

FWIW，在我自己的代码中，我`.cc`用于源文件、`.h`标题和`.tcc`内联定义。GCC 知道这`.tcc`是一个头文件，如果你说它会正确对待它（作为头文件）`g++ foo.tcc`，请参阅[http://gcc.gnu.org/onlinedocs/gcc/Overall-Options.html](http://gcc.gnu.org/onlinedocs/gcc/Overall-Options.html)了解 GCC 识别的文件扩展名。

注意而不是手动列出所有头文件依赖项，您可以使用 GCC 生成列出依赖项的 makefile 片段，例如，因为`main.cpp`您将生成一个`main.d`并且在 makefile 中执行`include main.d`...不过，这超出了此答案的范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T23:00:39.673

在您的 makefile 中既不包含 .h 也不包含 .cpp。使用该模板的文件将包括 .h（其中将包括 .cpp），并且每个翻译单元都将以模板所有功能的（弱）符号结束，而没有任何文件在您的 Makefile 中。

# ios - RestKit 嵌套映射到特定数组项

> ID：10693715
> 
> 赞同：5
> 
> 时间：2012-05-21T22:57:47.293
> 
> 标签：ios, core-data, mapping, restkit

是否可以通过 mapKeyPath 点语法强制 RestKit 对象映射器映射到数组中的特定嵌套对象？

这是我试图映射的响应

```
<result is_array="true">
  <item>
     <_field_data>
        <nid>
           <entity>
              <field_region>
                 <und is_array="true">
                    <item>
                       <value>1</value>
                    </item>
                 </und>
              </field_region>
.... 
```

我只对为 field_region 返回的第一个项目感兴趣。

映射这个的正确方法是什么？

我尝试了各种迭代：

```
RKManagedObjectMapping *record = [RKManagedObjectMapping mappingForClass:[MyRecordClass class] inManagedObjectStore:objManager.objectStore];
[record mapKeyPath:@"_field_data.nid.entity.field_region.und.0.item.value" toAttribute:@"region"]; 
```

我不断收到类似于以下的错误：

```
T restkit.object_mapping:RKObjectMappingOperation.m:152 Found transformable value at keyPath '_field_data.nid.entity.field_region.und.0.item.value'. Transforming from type '__NSArrayI' to 'NSNumber'
W restkit.object_mapping:RKObjectMappingOperation.m:232 Failed transformation of value at keyPath '_field_data.nid.entity.field_region.und.0.item.value'. No strategy for transforming from '__NSArrayI' to 'NSNumber' 
```

我通过以下方式调用映射：

```
[[RKObjectManager sharedManager] loadObjectsAtResourcePath:kMyResourcePath usingBlock:^(RKObjectLoader* loader) {
    loader.objectMapping = [[RKObjectManager sharedManager].mappingProvider objectMappingForClass:[MyRecordClass class]];
    loader.method = RKRequestMethodGET;
    loader.delegate = self;
    loader.targetObject = nil;
}]; 
```

有任何想法吗？最欣赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T20:17:54.237

认为您必须为每个级别进行映射，因此实体对象映射包含一个字段区域对象。field 区域对象映射包含一个 und 对象。und 对象映射包含项目等...

我只使用嵌套的 json rest kit 响应而不是 xml 来完成此操作，但必须为每个级别创建映射。

像这样的东西（当然这是不完整的，因为你需要每个级别的关系）

```
RKObjectMapping* undMapping = [RKObjectMapping mappingForClass:[UND class]];
[und mapKeyPath:@"item" toAttribute:@"item"];

RKObjectMapping* regionmapping = [RKObjectMapping mappingForClass:[Region class]]; 
[regionmapping mapKeyPath:@"und" toRelationship:@"undArrays" withMapping:undMapping]; 
```

# php - 使用 PHP 旋转图像时创建的边界框中的黑色背景

> ID：10693718
> 
> 赞同：1
> 
> 时间：2012-05-21T22:58:45.183
> 
> 标签：php, transparency, image-rotation, bounding-box

我已经在互联网上搜索了这个问题的答案，但我似乎找不到有用的东西。当我将图像旋转 5 度时，该图像会在为容纳旋转而创建的边界图像内旋转。创建的图像是完全黑色的。

我正在尝试使边界框图像完全透明。我看过的其他一些网站和问题说这应该可行：

```
<?PHP
$png = imagecreatefrompng('polaroids/polaroid0002.png');

// Do required operations
$png = imagerotate($png, 354.793, 0, 0);

// Turn off alpha blending and set alpha flag
imagealphablending($png, false);
imagesavealpha($png, true);

// Output image to browser
header('Content-Type: image/png');

imagepng($png);
imagedestroy($png);
?> 
```

但是，这会产生：

![产量](../Images/2223b7955cb286200bc7eba36899d7ba.png)

我该怎么做才能使黑色边界框透明？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:16:35.830

只需为背景颜色设置透明`imagecolorallocatealpha($png, 0, 0, 0, 127)`颜色。

```
<?php
$png = imagecreatefrompng('polaroids/polaroid0002.png');

// Do required operations
$png = imagerotate($png, 354.793, imagecolorallocatealpha($png, 0, 0, 0, 127), 0);

// Turn off alpha blending and set alpha flag
imagealphablending($png, false);
imagesavealpha($png, true);

// Output image to browser
header('Content-Type: image/png');

imagepng($png);
imagedestroy($png);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:09:26.087

不确定，我不熟悉使用那个特定的 PHP 函数。也就是说，大多数开发人员似乎更喜欢直接使用 ImageMagick 或 GD 来使用 PHP 进行图像处理。您使用的功能似乎是 GD 功能。我会开始在这里寻找。您可能需要更多地修改图像资源以设置透明度或不同的颜色。

[http://php.net/manual/en/book.image.php](http://php.net/manual/en/book.image.php)

[http://php.net/manual/en/book.imagick.php](http://php.net/manual/en/book.imagick.php)

我建议看看这个： http: [//php.net/manual/en/function.imagecolortransparent.php](http://php.net/manual/en/function.imagecolortransparent.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T23:10:35.613

这是一个有效的代码（从我 3 年的档案中挖掘出来）。我用它来组合 2 张 png 图像并渲染一些文本，同时保持透明度。它创建一个新图像，设置透明度颜色，然后将图像复制到其中。这个确切的文件适用于我的实现（但是我现在已经制作了颜色，因为当时我是从数据库中提取它们，所以我不记得它们是什么以及它们的含义）。很抱歉，如果它很乱。生成的图像是`$image`，它由`$ruler_img`作为第一层、`$index_img`作为第二层和作为第三层的文本组成。你的情况只有一层。

```
 //prepare first layer
        $ruler_img=$ruler_img=imagecreatefrompng($_SERVER['DOCUMENT_ROOT'].$ruler['out_ruler_img']);
        //create main image, basic layer, background
        $image = imageCreateTrueColor($ruler_width, $ruler_height);
        imageSaveAlpha($image, true);
        $transparentColor = imagecolorallocatealpha($image, 0,0,0, 127); //some color used as transparency key, this uses black
        $color = imagecolorallocatealpha($image, 0,0,0,127);
        //fill with transparent color
        imagefill($image, 0, 0, $transparentColor);

        imagealphablending($ruler_img,true);
        //copy the first layer
        imagecopy($image,$ruler_img,0,0,0,0,$ruler_width,$ruler_height);

        //prepare the second layer 
        $index_img=imagecreatefrompng($_SERVER['DOCUMENT_ROOT'].$ruler['out_index_img']);
        $size=getimagesize($_SERVER['DOCUMENT_ROOT'].$ruler['out_index_img']);
        $index_width=$size[0];
        $index_height=$size[1];

        imagealphablending($index_img,true);

        $ratio=1.0;
        if($index_height>$ruler_height)
            $ratio=$ruler_height*1.0/$index_height;
        $new_width=$index_width*$ratio;
        $new_height=$index_height*$ratio;

        //now I copy the resampled second layer 
        imagecopyresampled(
            $image,
            $index_img,
            $position*($ruler_width-$new_width),
            ($ruler_height-$new_height)/2,
            0,
            0,
            $new_width,
            $new_height,
            $index_width,
            $index_height);
        //render text   
        $font = "fonts/comic.ttf";
        $fontSize=10;
        $box=imagettfbbox($fontSize, 0, $font,$text);
        $textWidth=$box[2]-$box[6];
        $textHeight=$box[3]-$box[7];

        imagettftext($image, $fontSize, 0, $ruler_width-$textWidth-10, $ruler_height+12, $color, $font, $text);
        header("Content-type: image/png");
        //that's it!
        imagepng($image); 
```

# java - JMock 期待自定义类

> ID：10693722
> 
> 赞同：1
> 
> 时间：2012-05-21T23:00:05.513
> 
> 标签：java, junit, jmock

我在 JUnit 测试类中有以下期望：

```
CustomEvent myCustomEvent = new CustomEvent(data1, data2);
m_context.checking(new Expectations() {{
    oneOf(handler).somethingHappened(myCustomEvent); }}); 
```

在正在测试的类中，我正在调用一个在测试类中使用相同参数`handler.somethingHappened`的实例。`CustomEvent`但是，当正在测试的类中发生这种情况时，JMock 会声明意外调用。

JMock 错误显示了对在类中创建的对象的差异对象引用，所以我假设这就是我有意外引用的原因。

我的问题是，我怎样才能改变我的期望，以便我可以测试对象实际上是相等的？等于对象的内容而不是内存引用。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:06:09.347

`myCustomEvent`与测试期间出现在代码中的那个有什么关系？默认匹配是调用`equals()`，否则您应该使用匹配器来描述该关系（并且不要忘记`with`子句）

# java - Restyle list row design with extra text?

> ID：10693723
> 
> 赞同：1
> 
> 时间：2012-05-21T23:00:12.063
> 
> 标签：java, android

How can I restyle the theme of the list design?

I use a theme `android:theme="@style/Theme.HoloEverywhereDark.Sherlock"`, and would like to preserve/extend this style. Just want to add another text element.

As for restyling, I assume I have to extends ArrayAdapter. There inflate the row styling. This means I have to define a `R.layout.row_styling.xml` myself. How can I keep the whole row styling that is present in a included theme, but add another element?

# mysql - 如何将 MySQL SUM() 函数添加到此查询？

> ID：10693728
> 
> 赞同：1
> 
> 时间：2012-05-21T23:00:50.147
> 
> 标签：mysql, sum

我一直在摆弄创建自己的留言板，虽然它工作正常，但我想向它添加帖子投票（帖子末尾的图表）。

我从我的两个表 msgboard_user 和 msgboard_post 中提取了我想要的数据，如下所示：

```
SELECT p.post_id, p.user_id, u.username, get_time_diff(p.date) as date, p.ip, p.text, p.parent_post_id, p.approved AS posts
FROM msgboard_post p, msgboard_user u
WHERE p.user_id = u.user_id
AND p.approved = "yes"
ORDER BY p.date DESC
-- code for limit... 
```

所以现在我需要使用第三张表 msgboard_vote。每张选票都会在表格中占一行，我希望在我的结果中有一个列来汇总该帖子的选票。投票 (vote_value) 可以是 1 或 -1。没有投票的帖子（msgboard_vote 中没有行）最好在结果中总结为 0，null 也会这样做。

修修补补了几个小时……：/非常感谢您对此的帮助：）

![在此处输入图像描述](../Images/d6e9fea7c4fdae483c628c736c33efc5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:07:16.770

好吧，我想最简单的方法是在 select 子句中添加一些嵌套查询，如下所示：

```
SELECT p.post_id, (SELECT SUM(vote_value) FROM msgboard_vote WHERE post_id = p.post_id) AS vote_count... 
```

您是否尝试过 - 或类似的东西？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T23:22:45.953

避免在选定列和 WHERE 子句中进行子选择，优化器不能很好地处理它们。

```
SELECT p.post_id, p.user_id, u.username, 
   get_time_diff(p.date) as date, p.ip, p.text, 
   p.parent_post_id, p.approved AS posts,
IFNULL(v.vote_count, 0) AS vote_count
FROM msgboard_user u, msgboard_post p
LEFT JOIN
(SELECT post_id, COUNT(*) vote_count FROM msgboard_vote GROUP BY post_id) v
ON p.post_id = v.post_id
WHERE p.user_id = u.user_id
AND p.approved = "yes"
ORDER BY p.date DESC 
```

# ironpython - 如何在 IronPython 中覆盖 C# 属性和方法？

> ID：10693730
> 
> 赞同：2
> 
> 时间：2012-05-21T23:01:38.427
> 
> 标签：ironpython

我有一个与 C# 中的基类的接口——我希望能够在 IronPython 中实现派生类以实现嵌入式可扩展性。

在 C# 中，我会有类似的东西：

```
public interface IInterface
{
    bool SomeProperty { get; set; }
    bool SomeMethod(DateTime atTime);
}

public abstract class BaseClass : IInterface
{
    public BaseClass() {}

    private bool someProperty = true;
    public virtual bool SomeProperty
    {
        get { return someProperty; }
        set { someProperty = value; }
    }

    public virtual bool SomeMethod(DateTime atTime)
    {
        return true;
    }
} 
```

然后是控制器类型类

```
public class SomeOtherClass
{
    List<IInterface> interfaceCollection = new List<IInterface>();

    ... factory here to create C# classes and IPy classes derived from BaseClass or IInterface ...

    interfaceCollection.Add(somePytonDerivedClass);
    foreach (var intExersize in interfaceCollection)
    {
        if (intExersize.SomeProperty == true)
        {
            intExersize.SomeMethod(DateTime.Now);
        }
    }
} 
```

我想在 IronPython 中做一个 impl —— 比如：

```
class BaseClassIPy (BaseClass):
def __new__(self):
    print("Made it into the class")
    return BaseClass.__new__(self)

def __init__(self):
    pass

def get_SomeProperty(self):
    return BaseClass.SomeProperty

def set_SomeProperty(self, value):
    BaseClass.SomeProperty = value

def SomeMethod(self, atTime):
    return BaseClass.SomeMethod(atTime) 
```

**new**和**init**方法被正确调用——

但是当我调用 IPy 类的属性和方法时，调用似乎直接转到基类......

是语法问题吗？即IPy代码是错误的？

还是我完全错过了什么？

问候，乍得

---------------- 编辑 ----- 安装 python 类的方法：

```
private IInterface GetScriptPlugInNode()
{

    IInterface node = null;

    string plugInScript = "c:\\BaseClassIPy.py";
    string plugInClass = "BaseClassIPy";

    var options = new Dictionary<string, object>();
    ScriptRuntimeSetup setup = Python.CreateRuntimeSetup(options);
    setup.HostType = typeof(SelfContainedScriptHost);  //PAL impl
    setup.DebugMode = true;

    var pyRuntime = new ScriptRuntime(setup);
    var engineInstance = Python.GetEngine(pyRuntime);

    // Redirect search path to use embedded resources
    engineInstance.SetSearchPaths(new[] { String.Empty });

    var scope = engineInstance.CreateScope();

    ScriptSource source = engineInstance.CreateScriptSourceFromFile(plugInScript);

    source.Execute(scope);
    var typeClass = scope.GetVariable(plugInClass);
    var instance = engineInstance.Operations.CreateInstance(typeClass);
    node = instance;

    return node;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T06:28:18.710

您必须将抽象基类中的接口属性/方法更改为**虚拟**，以允许 IronPython 类正确继承。

```
public abstract class BaseClass : IInterface
{
    public BaseClass() {}

    private bool someProperty = true;
    public virtual bool SomeProperty
    {
        get { return someProperty; }
        set { someProperty = value; }
    }

    public virtual bool SomeMethod(DateTime atTime)
    {
        return true;
    }
} 
```

# django - keeping youtube auth object based on django session

> ID：10693733
> 
> 赞同：1
> 
> 时间：2012-05-21T23:01:55.200
> 
> 标签：django, youtube-api, django-sessions

I need to authenticate an user on Django to allow him to post comments on a video. I'm creating an gdata.youtube.service.YouTubeService() object, setting the developer key, getting the auth URL (GenerateAuthSubURL) and UpgradeToSessionToken() after I get the token back from the user. Then this instance ( YouTubeService() ) is allowed to do requests as this user on youtube.

The problem is that I want that to persists on the user session. How can I keep this object session-persistent?

# qt - 如何测量 QGraphicsView 中绘图需要多长时间

> ID：10693735
> 
> 赞同：0
> 
> 时间：2012-05-21T23:02:42.450
> 
> 标签：qt, qgraphicsview, performance

我试图弄清楚我的 QGraphicsView 需要多长时间才能重绘。我尝试了以下方法：

```
QElapsedTimer timer;
timer.start();

complexViewTransformation();

qDebug() << timer.elapsed(); 
```

问题是我得到的结果非常小，只有 0 到 3 毫秒，即使内容在视觉上有点卡顿。我认为小结果的发生是因为在应用程序重新进入事件循环之前不会发生重绘。那么如何测量重绘实际需要多长时间呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T23:28:11.380

我不认为瓶颈在你的方法/占位符`complexViewTransformation()`中，因为实际的绘制是在视图的绘制事件中在幕后完成的。在这种情况下，视图会绘制需要绘制的所有内容（要更新的区域内的任何项目）。

如果你从 QGraphicsView 继承，你可以重新实现 paintEvent 并测量对原始 QGraphicsView::paintEvent 的调用需要多长时间：

```
class MyGraphicsView : public QGraphicsView {
{
    //...
protected:
    void paintEvent(QPaintEvent *e)
    {
        QElapsedTimer timer;
        timer.start();

        // call the "real" paint event
        QGraphicsView::paintEvent(e);

        qDebug() << timer.elapsed();
    }
}; 
```

# java - Java/Joda：从长名称（显示名称）中获取时区

> ID：10693741
> 
> 赞同：3
> 
> 时间：2012-05-21T23:03:59.850
> 
> 标签：java, datetime, formatting, timezone, icalendar

在从 Outlook 接收 iCal 事件时，它以长格式指定时区：

```
DTSTART;TZID=Eastern Standard Time:20120521T180000 
```

也就是说，您将从 TimeZone.getDisplayName() 获得什么。

我怎样才能从那个 ( `Eastern Standard Time`) 转到 TimeZone 对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T23:30:52.337

好吧，它不是很漂亮，但这就是我最终得到的结果（基本上，迭代可用的 TZ，寻找`getDisplayName()`匹配项）：

// 注意：vTZID 是 iCalendar 格式显示的时区 ID // 例如“东部标准时间”。我只在常规方法找不到 TZ 时才这样做 //（即 TimeZone.getTimeZone()）

```
boolean foundTZ=false;
for (String availId : TimeZone.getAvailableIDs()){
  if (vTZID.trim().equalsIgnoreCase(TimeZone.getTimeZone(availId).getDisplayName())){
    vTimezone = TimeZone.getTimeZone(availId);
    foundTZ = true;
    break;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T11:14:19.417

你看过奥尔森时区吗？也可在 joda：http: [//joda-time.sourceforge.net/timezones.html](http://joda-time.sourceforge.net/timezones.html)

# javascript - How can I use a checkbox to modify an HREF?

> ID：10693743
> 
> 赞同：0
> 
> 时间：2012-05-21T23:04:11.047
> 
> 标签：javascript

I am making an image gallery with a user preference checkbox that displays a large or jumbo size image when the thumbnail is clicked. I have a form element on the page that looks like this:

```
<input type="checkbox" name="targetbox" id="pref"
    onclick="supersize(this.checked);">
<label for="pref">Supersize Pics</label> 
```

I also have a link and thumbnail like this:

```
<a href="images/large/image1.jpg"><img src="images/thumbs/image1.jpg" /></a> 
```

The part that is giving me some trouble is the JavaScript. Here is what I was able to cobble together so far:

```
<script language="JavaScript">
    function supersize(checkme) {
        if (checkme)
            where = "images/super/";
        else
            where = "images/large/";

        for (var i=0; i<=(document.links.length-1); i++) {
            document.links[i].href = where;
        }
    }
</script> 
```

This will replace the links, but not how I need them. Obviously, this will replace the entire `href`, and I need to retain the "image1.jpg" so the new link would be something like: "images/super/image1.jpg". I am sure I need to use an array or split the url into two parts or something. That's the part I am having trouble figuring out. Any help would be appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:16:29.460

我建议使用一个简单的`replace()`：

```
var href = document.links[i].href;
if (href.indexOf('super') > -1){
    document.links[i].href = href.replace('super','large');
}
else {
    document.links[i].href = href.replace('large','super');
} 
```

当然，这将简单地用字符串替换`large`字符串`super`，反之亦然。所以，量身定制`if`适合自己的。

参考：

*   [`indexOf()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/indexOf).
*   [`replace()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:16:56.297

`replace()`如果您知道最后一个值，则可以使用：

```
document.links[i].href = document.links[i].href.replace("last/value/goes/here/", where); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T23:23:34.113

试试这个功能。

*hrefLink.lastIndexOf('/')+1*获取最后一个“/”的位置，.substr() 获取图像名称，稍后可以将其附加到您想要的任何内容！

```
<script language="JavaScript">
   function supersize(checkme) {
      if (checkme)
         where = "images/super/";
      else
         where = "images/large/";
      for (var i=0; i<=(document.links.length-1); i++) {
         hrefLink = document.links[i].href;     
         imgName =  hrefLink.substr(hrefLink.lastIndexOf('/')+1);
         document.links[i].href = where+imgName;
      }
   }
</script> 
```

这样，我们在您的上下文中保持函数独立于“super”和“large”等硬编码词。

干杯，哈沙。

# c - 内存分配器建议

> ID：10693753
> 
> 赞同：6
> 
> 时间：2012-05-21T23:05:19.223
> 
> 标签：c, optimization, memory

我有多线程部分，其中线程需要分配几个大数据段，例如每个约 100MB，以用作缓冲区。此外，缓冲区可能需要在运行时多次调整大小。

自然的解决方案是使用`realloc`，但它可能会移动不需要的内存。 `free/malloc`配对以调整缓冲区大小恐怕会导致碎片和保留内存，然后再产生其他问题。

我可以使用什么来分配/重新分配内存？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T23:48:10.853

使用`free`和`malloc`。这不会导致碎片问题。

现代分配器对内存碎片具有相当的抵抗力。如今，需要一个相当病态的程序才能导致碎片问题。当我们的程序直接处理物理 RAM 时，碎片化是一个更严重的问题，但是对于虚拟内存，程序堆中的一个大“洞”不需要消耗任何资源。

此外，由于缓冲区的大小，大多数分配器将为每个缓冲区从内核请求一个专用区域。*在 Linux / OS X / BSD 上，这意味着每个缓冲区*`mmap`的幕后匿名。 这会导致地址空间的碎片化，但虚拟地址空间在 64 位系统上基本上是免费的，几百兆在 32 位上也不是问题。

 *所以使用`free`and `malloc`。

**备选方案：**您可能会发现使每个缓冲区比您需要的大更快。这种方式`malloc`适用于现代 Unix，任何你不写的页面都不会消耗内存。

因此，如果您`malloc`使用 500 MB 缓冲区但只使用前 100 MB，那么您的程序实际上并不会比使用`malloc`100 MB 缓冲区并使用整个程序时使用更多的内存。通过这种方式可以获得更多的地址空间碎片，但这在 64 位系统上不是问题，并且您始终可以调整分配大小，使其也适用于 32 位系统。

至于使用的建议`mmap`，只需将`malloc`/视为/`free`的更简单接口，这就是大型分配的含义（1 MiB 是一个常见的阈值）。`mmap``munmap`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T02:16:24.383

只需使用`realloc`. 在现代系统上，即使缓冲区被移动到新地址，移动也将通过操作页表（在 Linux 上，`mremap`我确信其他系统具有类似的机制）而不是通过复制数据来实现。（请注意，我假设缓冲区很大；对于通常小于几百 kb 的小缓冲区，将发生实际复制。）

If your target is 64-bit machines, there's absolutely no need to worry about memory fragmentation. You'll never fragment memory badly enough to run out of virtual address space. If you need to handle 32-bit machines too, you're probably safe as long as you don't have too many threads. As long as the total memory consumption is less than 1GB, it would be very hard to run out of virtual address space due to fragmentation, *assuming your usage pattern*. If you are worried about it, just preallocate the largest size you might possibly need.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T23:41:18.520

使用 malloc/realloc/free 实现您的解决方案并对其进行分析。如果内存分配有问题，您可以使用更好的 malloc 实现，例如 facebook 的[jemalloc](http://www.canonware.com/jemalloc/)或 google 的[tcmalloc](http://goog-perftools.sourceforge.net/doc/tcmalloc.html)。

有关两者的比较，请参阅[C++ 内存分配机制性能比较（tcmalloc 与 jemalloc）](https://stackoverflow.com/questions/7852731/c-memory-allocation-mechanism-performance-comparison-tcmalloc-vs-jemalloc)。

它们都非常擅长处理内部/外部碎片。*

# visual-studio-2010 - 用于 JQuery Mobile 的 Visual Studio 2010 SP1 智能感知？？？

> ID：10693756
> 
> 赞同：1
> 
> 时间：2012-05-21T23:05:33.683
> 
> 标签：visual-studio-2010, jquery-mobile

我正在尝试在 VS2010 SP1 中为 JQuery Mobile 设置智能。我找不到为 JQuery 实现的 VSDOC 文件。唯一的其他建议是安装“html_5_jqm.xsd”，如[https://github.com/hakanson/intellisense-jquery-mobile](https://github.com/hakanson/intellisense-jquery-mobile)中所述，我无法开始工作。我正在运行 64 位 Win7 并执行了相关的 REG 文件。我的感觉是为 JQMobile 获得一个 VSDOC，但我不确定是否存在。

所有的想法都赞赏，

埃德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:30:26.270

如果您启用了 HTML 源代码编辑工具栏，请在下拉列表中选择“Jquery Mobile”选项，通常它应该正在运行。

# java - Changing Jbutton's Icon Through mouse listener

> ID：10693762
> 
> 赞同：4
> 
> 时间：2012-05-21T23:06:15.197
> 
> 标签：java, swing, jbutton, mouselistener

I'm doing a board game project and I'm representing cells by Jbuttons. I made mouseLitener to all the buttons. My question is how to change the icon of the Jbutton when it is clicked ?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T23:38:10.953

> 我正在做一个棋盘游戏项目，我正在用 Jbuttons 表示单元格。

*   使用[JToggleButton](http://docs.oracle.com/javase/tutorial/uiswing/components/button.html)进行基于按钮数组和鼠标事件的游戏，而不是`JButton`

*   使用[ButtonModel](http://docs.oracle.com/javase/tutorial/uiswing/components/model.html)而不是任何[XxxListener](http://docs.oracle.com/javase/tutorial/uiswing/events/eventsandcomponents.html)

*   `JButton`并`JToggleButton`直接在API中实现了这些方法

.

```
setIcon(Icon i);
setRolloverIcon(Icon i);
setPressedIcon(Icon i);
setDisabledIcon(Icon i); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T23:22:46.857

```
yourButton.addActionListener(new ActionListener() {
@Override
    public void actionPerformed(ActionEvent e) {
        yourButton.setIcon(new ImageIcon("yourImage"));
    }
}); 
```

单击 JButton 时会调用 ActionListener。这种方式使用最频繁。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-22T02:49:58.643

作为替代方案，还可以考虑`setText()`使用 unicode 字形，如图[所示](https://sites.google.com/site/drjohnbmatthews/buttons)。

# linux - 我的进程如何检测计算机是否正在关闭？

> ID：10693769
> 
> 赞同：6
> 
> 时间：2012-05-21T23:07:20.877
> 
> 标签：linux, amazon-ec2, shutdown

我在 EC2 现货实例上运行一些应用程序。此类实例可能会在没有通知的情况下被 Amazon 杀死。

在关闭过程中，进程按某种顺序被杀死。我们有监控/恢复程序，它们的行为应该根据服务器是关闭还是进程刚刚崩溃而有所不同。（特别是如果服务器实际上正在关闭，我们不想做任何事情）

如何在恢复过程中（如果它仍然存在）检测到进程因关闭而被杀死？

（更多系统细节：我在不修改外部状态的沙箱中运行未知/不受信任/等代码。通常如果沙箱代码崩溃，这是不受信任代码的作者的错，我们不会重新运行它。但如果沙盒代码由于VM关闭或失败而终止，我们需要在另一个实例上重新运行它。我现在遇到的问题是用户的代码首先被终止，所以监控程序错误地认为崩溃是用户错误.)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T07:42:23.453

## 代理人

在产生沙箱子进程的每台机器上运行一个代理。代理运行您的“防崩溃”代码，沙盒代码运行可能崩溃的用户代码。

负责启动具有新沙箱进程的新机器的监控系统检查哪些进程已被杀死（代理和沙箱进程或仅沙箱子进程）。

它通过向代理查询其子进程的 TCP 连接 (RMI/RPC/HTTP) 来实现这一点。如果代理响应 - 机器仍在运行，并且可以询问其子沙箱进程。如果代理没有响应 - 机器被怀疑被终止。

## 代理（变体）

该代理还负责在同一 VM 上重新启动子沙箱进程，以防它崩溃。

## 查询服务

使用查找服务（例如 Zoo Keeper）来跟踪哪些进程发送了心跳保持活动。如果代理还活着，那么机器仍在运行，如果代理不活跃，那么它就没有运行。

## ec2 接口

轮询 EC2 API 以确定机器是处于运行状态还是终止状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T00:30:43.660

您的恢复过程如何进行？

如果您正在使用[`waitpid`](http://pubs.opengroup.org/onlinepubs/009695399/functions/wait.html)监视进程，当它退出时，您可以确定：

*   是否正常退出，如果退出，进程返回什么状态，或者
*   它是否因信号而退出，以及该信号是什么。

根据进程的关闭方式，我希望看到它正常退出或通过`SIGTERM`or退出`SIGKILL`。`SIGILL`, `SIGABRT`, `SIGFPE`, `SIGBUS`, `SIGSEGV`, 和`SIGSYS`表示因编程错误而崩溃。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T23:25:18.230

这听起来像是一个非常脆弱的计划。不要试图检测系统的状态：让你的应用程序写出一个有效性令牌（并同步相关文件！）以某种方式遵循应用程序的“干净”关闭/暂停/停止并使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T16:48:19.330

我假设当实例关闭时，您的监控进程会收到一个 SIGTERM 信号。

那么是否有可能做类似的事情 - 如果受监控的进程已经退出 && 在接下来的 5 秒内没有收到 SIGTERM 信号 - 假设进程崩溃了。如果收到 SIGTERM，只需退出信号处理程序。

# cakephp - 找不到 Cakephp 类“DOMDocument”

> ID：10693771
> 
> 赞同：9
> 
> 时间：2012-05-21T23:07:24.027
> 
> 标签：cakephp, domdocument

[我尝试按照蛋糕书http://book.cakephp.org/2.0/en/core-libraries/helpers/rss.html](http://book.cakephp.org/2.0/en/core-libraries/helpers/rss.html)中的这个简单解释来实现 rss 提要 我收到此错误“在 lib/ 中找不到类 'DOMDocument'第 99 行的 Cake/Utility/Xml.php"

有什么线索吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-21T23:20:29.073

安装 php-xml 包，该包提供使用 DOMDocument 类所需的文件

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-06-28T08:29:11.093

我有同样的麻烦，**安装**包。我试图加载它，`new DOMDocument();`但我不得不使用`$dom = new \DOMDocument();`

希望这可以帮助人们使用 CakePHP 3.x

# drupal-7 - Drupal Role-specific Fields & Registration Forms

> ID：10693775
> 
> 赞同：0
> 
> 时间：2012-05-21T23:08:07.023
> 
> 标签：drupal-7, registration, field

I have set up 2 role types:

*   Vendor
*   Customer

I would like to create a role-specific Vendor signup at mysite.com/vendor-register

(And for customer, to sign up at /customer-register )

I have also been reading up on Drupal 7 user permissions and roles however can't seem to see how, during the registration / profile modification stages, only certain fields are associated with certain roles?

For example, the Vendor requires diff fields to be added during registration than the customer.

These fields/data would be specific to the Vendors and the customers' profiles.

Any help much appreciated,

gvanto drupal7 novice

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T22:04:49.930

你必须使用这个模块，它运行良好 [http://drupal.org/project/profile2](http://drupal.org/project/profile2)

# c - Inconsistent summation in C

> ID：10693777
> 
> 赞同：3
> 
> 时间：2012-05-21T23:08:36.473
> 
> 标签：c, floating-point, floating-point-precision

When I run the following program:

```
#include <stdio.h>
#include <math.h>

int main()
{
    double sum, increase;
    long amount, j;

    printf("sum = ");
    scanf("%lf", &sum);
    printf("increase = ");
    scanf("%lf", &increase);
    printf("amount = ");
    scanf("%ld", &amount);

    for (j = 1; j <= amount; j++)
    {
        sum += increase;
    }

    printf("%lf\n", sum);

    return 0;
} 
```

I obtain the following response for these values:

```
MacBook:c benjamin$ ./test
sum = 234.4
increase = 0.000001
amount = 198038851
432.438851
MacBook:c benjamin$ ./test
sum = 234.4
increase = 0.000001
amount = 198038852
432.438851
MacBook:c benjamin$ ./test
sum = 234.4
increase = 0.000001
amount = 198038853
432.438852 
```

where I have increased the variable 'amount' by 1 in each case.

*   In the first one, the summation gives what I expect.
*   In the second, it surprisingly gives the same value.
*   In the third, it goes on summing.

Why does this happen?

Although the code doesn't seem to be very useful, I have just written the part in question. I actually wanted to use it in a larger program.

Thanks!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T23:18:18.187

这是格式的问题，而不是数字的问题。如果您更改`printf`为

```
printf("%.12lf\n", sum); 
```

结果看起来更符合您的预期：

```
sum = increase = amount = 432.438851000198
sum = increase = amount = 432.438852000198
sum = increase = amount = 432.438853000198 
```

最后的“垃圾”是由于浮点数的精度有限。

# php - 为什么 php 数组使用较新的 php 版本变慢，以及如何解决这个问题？

> ID：10693788
> 
> 赞同：8
> 
> 时间：2012-05-21T23:10:29.470
> 
> 标签：php, arrays, performance, memory, migration

自 2006 年以来，我有一个基于 php 的系统运行良好，它有一个后端（CLI、cron）进程，处理数百万条记录，在内存中使用大树状结构。

升级 debian 机器时，我注意到性能下降很大。

因此，为了研究这个问题，我编写了一个简单的脚本，并下载了十几个 xampp 版本，并使用不同的 php 版本运行相同的脚本。

```
$start=microtime(true);
$n=10;
$counter=1;
$testarray=Array();

for ($i[1]=0;$i[1]<$n;$i[1]++) 
  for ($i[2]=0;$i[2]<$n;$i[2]++) 
    for ($i[3]=0;$i[3]<$n;$i[3]++) 
      for ($i[4]=0;$i[4]<$n;$i[4]++) 
        for ($i[5]=0;$i[5]<$n;$i[5]++) 
          for ($i[6]=0;$i[6]<$n;$i[6]++) 
            for ($i[7]=0;$i[7]<$n;$i[7]++) 
              $testarray[$i[1]][$i[2]][$i[3]][$i[4]][$i[5]][$i[6]][$i[7]]=$counter++;

$end=microtime(true);
echo "PHP ".phpversion()." ".round(memory_get_peak_usage(true)/(1024*1024),2)." mbyte max ram, ".round($end-$start,2)." seconds\r\n"; 
```

我对 xampp win32 1.6.0a 到 win32 1.7.7-vc9 运行相同的脚本，结果如​​下：

```
 - PHP 5.2.1 890.25 mbyte max ram, 12.43 seconds
 - PHP 5.2.1 890.25 mbyte max ram, 12.37 seconds
 - PHP 5.2.2 890.25 mbyte max ram, 12.43 seconds
 - PHP 5.2.3 890.25 mbyte max ram, 12.38 seconds
 - PHP 5.2.4 890.25 mbyte max ram, 12.5 seconds
 - PHP 5.2.5 890.25 mbyte max ram, 12.28 seconds
 - PHP 5.2.5 890.25 mbyte max ram, 12.31 seconds
 - PHP 5.2.6 890.25 mbyte max ram, 12.52 seconds
 - PHP 5.2.6 890.25 mbyte max ram, 12.54 seconds
 - PHP 5.2.8 890.25 mbyte max ram, 12.72 seconds
 - PHP 5.2.9 890.25 mbyte max ram, 12.53 seconds
 - PHP 5.3.0 975.5 mbyte max ram, 18.28 seconds
 - PHP 5.3.1 975.5 mbyte max ram, 18.06 seconds
 - PHP 5.3.5 975.5 mbyte max ram, 18.49 seconds
 - PHP 5.3.8 975.5 mbyte max ram, 17.97 seconds
 - PHP 5.3.8 975.5 mbyte max ram, 18.11 seconds 
```

注意： - 我不在服务器上使用 xampp 或 windows，但这是一次测试不同版本的最简单方法。- 我尝试用谷歌搜索这个问题几次，但没有得到任何相关结果 - 服务器上的速度损失大致相同（运行时间延长 50%） - 我不认为这种减速是任何框架或编译器都可以接受，即使有新功能，旧功能也应该像以前一样工作。我不能告诉我的老板，使用相同软件的同一台计算机不能再做同样的工作了，因为我们对它的 debian 进行了 dist-upgrade... 这看起来像是一些 windows 升级。:)

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T23:22:47.933

在循环之前调用[gc_disable ()。](http://www.php.net/gc_disable)把我的时间减半。

（php 在 5.3 中添加了一个新的垃圾收集器）

# javascript - 有没有办法使用 Javascript/HTML5 从 USB 设备获取 GPS 位置？

> ID：10693790
> 
> 赞同：3
> 
> 时间：2012-05-21T23:10:34.383
> 
> 标签：javascript, html, geolocation, gps, usb

我正在尝试从 GlobalSat G-Star IV USB GPS 设备中获取位置以在网页中使用。我找到了 Geolocation API 并且可以让它在带有内置 GPS 的手机上工作（基于[http://w3schools.com/html5/html5_geolocation.asp](http://w3schools.com/html5/html5_geolocation.asp)），但它总是返回“error.POSITION_UNAVAILABLE”当我尝试在台式电脑上将它与我的 USB 设备一起使用（使用最新版本的 Chrome 和 Firefox）。出于某种原因，它甚至没有根据我的 IP 地址提取位置，但这不是重点，因为我的项目需要尽可能高的准确性。我已经确保我的浏览器允许网站访问我的位置，并且没有其他任何东西可以阻止我识别它。

有什么方法可以让 Geolocation API 以这种方式工作，还是我仅限于使用内置 GPS 的设备？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T06:59:04.263

这取决于您所在的平台。显然 linux 上的 firefox 使用 GPSD [http://catb.org/gpsd/](http://catb.org/gpsd/)理论上至少应该允许您访问 USB 连接的 GPS 设备。

[http://www.andygup.net/?p=600](http://www.andygup.net/?p=600)很好地概述了各种浏览器如何实现地理定位 API。

# regex - 使用 sed 将一个命名空间替换为两个

> ID：10693792
> 
> 赞同：1
> 
> 时间：2012-05-21T23:10:37.347
> 
> 标签：regex, sed

我有以下代码布局：

```
#ifndef _file_h_
#define _file_h_

namespace FooBar
{
    // code
}

#endif 
```

我想通过 sed 运行它并将 FooBar 命名空间转换为 Foo::Bar 并添加右括号

```
#ifndef _file_h_
#define _file_h_

namespace Foo { namespace Bar {

// code

}}

#endif 
```

我承认我的正则表达式知识在最好的时候是很差的。

我认为我下面的命令接近于实现我正在寻找的东西，但我得到了一些语法错误。有人可以帮忙吗？

```
cat file.h  | sed -e 's/(.*)namespace FooBar[\s\n]{(.*)}/\1namesapce Foo \{ namespace Bar \{\2\}\}/g' | less 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:17:54.987

希望你的头文件的格式总是像你展示的那样（命名空间在它自己的行上，在行首打开/关闭大括号等）。

如果是这样，您无需担心在此处捕获。尝试：

```
sed -e 's/namespace FooBar/namespace Foo { namespace Bar/g; s/^}/}}/g;' file.h > file2.h 
```

如果没有，请牢记@sarnold 的评论——这将很困难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T23:33:55.900

知道最后一个大括号始终是文件中的最后一个大括号，这给了我一个可行的想法：

首先，窃取 Rob 的第一个正则表达式：

```
sed -ie 's/namespace FooBar/namespace Foo { namespace Bar/g;' file.h 
```

接下来，最后一个大括号的新正则表达式：

```
perl -pi -e 's/^}$(.*?)\z/}}\1/ms' file.h 
```

我为第二个命令切换到 Perl，因此我可以使用它的不那么贪婪的`*?`运算符、`^`and`$`和`\z`断言以及`/ms`修饰符（以获得友好的多行匹配）。

这两个命令结合起来对您的示例文件进行了以下更改：

```
$ diff -u file.h.backup file.h
--- file.h.backup   2012-05-21 16:27:29.000000000 -0700
+++ file.h  2012-05-21 16:29:31.000000000 -0700
@@ -1,10 +1,10 @@
 #ifndef _file_h_
 #define _file_h_

-namespace FooBar
+namespace Foo { namespace Bar
 {
     // code
-}
+}}

 #endif 
```

这*很*脆弱——一个完整的 C++ 语言解析器会更加健壮，尽管编写起来肯定不是那么容易。我希望剩下的东西很容易用手处理。

# c# - 如何使用 VS 2010、C#、oledbconnection 从 excel 文件中选择特定单元格（来自不同的行或列）

> ID：10693793
> 
> 赞同：0
> 
> 时间：2012-05-21T23:10:47.783
> 
> 标签：c#, visual-studio-2010

这是我在项目中使用的代码：

```
private void button1_Click(object sender, EventArgs e)
    {
        OleDbConnection conn = new OleDbConnection();
        conn.ConnectionString = @"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=C:\KursniListi.xlsx" + @";Extended Properties=""Excel 8.0;HDR=Yes;IMEX=1;ImportMixedTypes=Text;TypeGuessRows=0""";

        OleDbCommand command = new OleDbCommand
        (
            "SELECT *" +
            "FROM [Sheet1$]", conn
        );

        DataSet dsKL = new DataSet();
        OleDbDataAdapter adapter = new OleDbDataAdapter(command);
        adapter.Fill(dsKL);

        dataGridView1.DataSource = dsKL.Tables[0];

    } 
```

[http://uploadpic.org/v.php?img=j8nn3BtVP2](http://uploadpic.org/v.php?img=j8nn3BtVP2)

我需要这个来显示我：第 1 行和第 11 行，C、E、F 列

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:20:52.897

您可以使用 Visible 属性隐藏数据网格上的列和行

```
this.dataGridView1.Columns[0].Visible = false;
....

this.dataGridView1.Rows[1].Visible = false;
.... 
```

（我使用了列/行的索引，因为我无法输入您的标题名称）
但是，如果不知道隐藏行的要求，很难给出令人满意的答案。

# winforms - 将 NHibernate 集合分配给 ListBox 数据源时，Visual Studio 调试器退出

> ID：10693794
> 
> 赞同：0
> 
> 时间：2012-05-21T23:10:53.997
> 
> 标签：winforms, visual-studio-2010, nhibernate

我正在使用 NHibernate 从我的数据库中提取一些对象：

```
Dim RpList As List(Of ReferencePackage) = session.QueryOver(Of ReferencePackage).OrderBy(Function(x) x.Name).Asc.List 
```

然后我尝试将此集合作为数据源分配给 ListBox：

```
ReferencePackagesListBox.DataSource = RpList 
```

当我这样做时，Visual Studio 会立即停止调试。我有一个围绕数据源分配的尝试/捕获，并且我还在调试选项中禁用了“仅我的代码”；它不会抛出异常。

我还有另一个我从 NHibernate 中提取的对象列表，它们似乎以同样的方式绑定到 ListBox 上。我只能假设问题在于将对象绑定到控件。我曾尝试在分配 the之前分配`DisplayMember`and ，但它根本没有帮助。我也尝试将NHibernate 转换为 a但它仍然崩溃。`ValueMember``DataSource``IList``BindingList`

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T05:07:04.560

事实证明，答案与我在这里提出的另一个问题相同。

基本上 - 绑定 NHibernate 代理对象有时会表现得很奇怪。这种奇怪行为的一部分是它可以导致 Visual Studio 停止调试而不会引发异常或发出任何警告。解决方案是使用对象的视图类并绑定到视图。

# php - 从 url php 获取 ID

> ID：10693795
> 
> 赞同：1
> 
> 时间：2012-05-21T23:10:59.267
> 
> 标签：php, url

这是我的网址

```
http://localhost:8888/App.php#?ID=1S 
```

我需要将其`1S`作为变量用于查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:13:28.157

**如果要将 URL 解析为字符串：**

```
$str = 'http://localhost:8888/App.php#?ID=1S';
$temp = explode( "?", $str );
$result = explode( "=", $temp['1'] );
echo $result['1']; 
```

*   [演示](http://codepad.org/erwiNASf)

* * *

**如果你想在服务器端获取它：**

哈希值不会发送到服务器端。所以不可能在服务器端得到它，但你可以使用 javascript 来做一些技巧。

*   [我可以在我的服务器端应用程序（PHP、Ruby、Python 等）上读取 URL 的哈希部分吗？](https://stackoverflow.com/questions/940905/can-php-read-the-hash-portion-of-the-url)

* * *

**使用 JavaScript/jQuery：（** *虽然没有添加标签）*

```
<script>

    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('#') + 1).split('&');
    hash = hashes[0].split('='); 
    alert( hash['1'] );

    // you can use jQuery.ajax() here to send this value to server side.

</script> 
```

*   [获取哈希值并从 javascript 传递到 php](http://www.daniweb.com/web-development/javascript-dhtml-ajax/threads/233251/get-hash-value-pass-from-javascript-to-php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:30:23.407

```
echo parse_url('http://localhost:8888/App.php#?ID=1S', PHP_URL_FRAGMENT); 
```

或者

```
echo parse_url($_SERVER['QUERY_STRING'], PHP_URL_FRAGMENT); 
```

如果需要进一步解析：

```
$x = parse_url($_SERVER['QUERY_STRING'], PHP_URL_FRAGMENT);

parse_str($x, $arr);

echo $arr['ID'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T23:49:00.327

```
$url = "http://localhost:8888/App.php#?ID=1S&another=3";
$a = parse_url($url);
parse_str($a["fragment"],$arr);
print_r($arr); 
```

输出：

```
Array (
    [?ID] => 1S
    [another] => 3
); 
```

如果您可以使用“？ID”访问第一个参数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T23:50:13.353

我想这样做的唯一方法是通过 AJAX 请求，这是一个简化的示例：

索引页

```
<!doctype html>
<html>
<head>
    <title>Website</title>
    <script type="text/javascript">
        var url = document.location;
        url = url.toString();
        var getVal = url.split("#");
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.open('GET', 'App.php'+getVal[1], true);
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                alert(xmlhttp.responseText);
            }
        }
        xmlhttp.send();
    </script>
</head>
<body>

</body>
</html> 
```

App.php 页面

```
<?php
    if (isset($_GET['url'])) echo 'url : ' . $_GET['url'];
?> 
```

# box-api - Box API 2.0：使用 /tokens API 时如何将文件上传到 Box (apps) 文件夹

> ID：10693798
> 
> 赞同：2
> 
> 时间：2012-05-21T23:11:20.123
> 
> 标签：box-api

我正在使用 Box v2 中的 /tokens API，并且在使用 /tokens API 后能够同时获取令牌和应用程序特定的文件夹 ID。当我使用此令牌列出我的 Box 帐户中的所有文件夹时，它似乎只正确列出了我的应用程序文件夹。但是，我无法使用从 /tokens API 获得的令牌和 folder_id 将文件上传到我的应用程序文件夹。

我可以使用常规 auth_token 进行上传。我不知道如何使用即时模式令牌进行上传。有没有其他人有这个运气？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:00:37.647

更新：截至 2012 年 6 月 7 日，此问题已得到解决。

我们做了一些进一步的调查，似乎存在阻止在即时模式下上传的错误。我们正在修复它，并希望很快有一个解决方案。

# php - 图片上传问题

> ID：10693800
> 
> 赞同：0
> 
> 时间：2012-05-21T23:11:41.480
> 
> 标签：php, upload

就是这样，我还必须建立它会将图片上传到服务器，但它出现的错误导致无法继续或该说什么？唔

activate.php**她**

```
<input type="file" name="file" /> 
```

activate_updater.php**她**

```
<?php include ("include/database/db.php");
ini_set('display_errors',1);
error_reporting(E_ALL | E_STRICT);
session_start();

        $pb = null;
        include("class.upload.php");
        $handle = new Upload($_FILES['profilbillede']);

        if($handle->uploaded){
                //lidt mere store billeder
                $handle->image_resize = true;
                $handle->image_ratio_y = true;
                $handle->image_x = 220;
                $handle->Process("profil/store");
                    //til profil billede lign..
                    $handle->image_resize = true;
                    $handle->image_ratio_crop = true;
                    $handle->image_y = 75;
                    $handle->image_x = 75;
                    $handle->Process("profil");                
            $pb = $handle->file_dst_name;

                echo 'Billedet: '.$pb.'<br>';
                echo "Dit billede blev upload<br>";
        }else{
                $pb = 'bruger_intet.png';
            }

    if($stmt = $mysqli->prepare('UPDATE `brugere` SET `rank`=2, `katogori`=?, `djnavn`=?, `profilbillede`=?, `profiltekst`=?, `facebook`=?, `pris`=?, `booking`=?, `mobil`=? WHERE `code`=?'))
    {

        $stmt->bind_param('iiiiiiiis', $katogori, $djnavn, $profilbillede, $profiltekst, $facebook, $pris, $booking, $mobil, $g_code);
        //fra input ting ting..
        $katogori = $_POST["kategori"];
        $djnavn = $_POST["djnavn"];
        $profilbillede = $_POST["file"];
        $profiltekst = $_POST["profiltekst"];
        $facebook = $_POST["facebook"];
        $pris = $_POST["pris"];
        $booking = $_POST["booking"];
        $mobil = $_POST["mobil"];
        $g_code = $_SESSION["code"];

        $stmt->execute();
        $stmt->close();

        header("Location: http://.....dk/logind/");

    }
    else
    {
        echo 'Der opstod en fejl i erklÃ¦ringen: ' . $mysqli->error;
    }
?> 
```

**所以这里出现了错误？**

注意：未定义的索引：第 37 行 /home/jesperbo/public_html/,,,.dk/activate_updater.php 中的文件

警告：无法修改标头信息 - 标头已由 /home/jesperbo/public_html/,,.dk/activate_updater.php 中的（输出开始于 /home/jesperbo/public_html/,,,.dk/activate_updater.php:24）发送在第 48 行

*问题来了*

```
$profilbillede = $_POST["file"]; 
```

和这里

```
echo 'Billedet: '.$pb.'<br>'; 
```

和这里

```
header("Location: http://....dk/logind/"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:16:08.857

就像错误消息说的那样，输出文本后不能发送标题。

```
header('....') 
```

必须出现*在*任何 echo 命令之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:17:00.217

标头已发送后，您无法发送标头。修改您的代码，使标题位于任何输出之前，包括空格

# oracle - 如何以文本形式查看结果，而不是 Oracle SQL Developer 中的工作表视图？

> ID：10693801
> 
> 赞同：12
> 
> 时间：2012-05-21T23:11:42.930
> 
> 标签：oracle, oracle-sqldeveloper

我只能通过在工作表视图中运行 SQL 查询来获得结果。我想将其视为文本。我知道这在过去的版本中是可能的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-21T23:22:11.937

我认为您想要“运行脚本”（F5）命令而不是“运行语句”（Ctrl-Enter）命令。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-22T21:16:33.743

这是一个解决方法

**获取包含标题的工作表视图的文本副本。**

1.  单击工作表视图中的任何单元格。

2.  `CTRL-A`然后按`CTRL-SHIFT-C`

工作表视图的内容现在显示为文本，可以粘贴到其他地方。

# java - 使用 jsoup 返回从 url 检索到的图像数组

> ID：10693804
> 
> 赞同：0
> 
> 时间：2012-05-21T23:11:53.733
> 
> 标签：java, android, jsoup

当我尝试使用 jsoup 获取图像 url 数组时，我得到一个空指针异常，真的不确定我在这里做错了什么，因为我似乎遵循了 javadoc 中列出的示例，任何帮助都会大有帮助，谢谢。

```
public class ImagetestActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    String url = "http://www.goal.com/en/news/1717/editorial/2012/05/20/3116140/in-pictures-chelsea-celebrate-champions-league-success#";
    Document doc = null;
    List<Element> media = new ArrayList<Element>();
    try {
        doc = Jsoup.connect(url).get();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    media = doc.select("[src]");

    for (Element src : media) {
        if (src.tagName().equals("img")) {
            Toast.makeText(ImagetestActivity.this, src.text(),
                    Toast.LENGTH_LONG).show();
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:31:39.257

尝试这个：

```
media = doc.select("img[src]");

for (Element src : media) {
   Toast.makeText(ImagetestActivity.this, src.attr("src"),
                Toast.LENGTH_LONG).show();
} 
```

即选择图像（无需检查标签名称）。并且可能您需要 src 属性值，而不是内部文本（始终为空）

# javascript - Webkit 点击高亮颜色大于链接

> ID：10693806
> 
> 赞同：1
> 
> 时间：2012-05-21T23:12:16.113
> 
> 标签：javascript, css, ios, uiwebview, webkit

在 iOS 应用程序的 UIWebView 中，当按下链接时，我会在 javascript 中触发事件。当点击链接时，通常还会出现一个灰色框。`-webkit-tap-highlight-color`CSS 属性。

但是，激活这个灰色框的点击区域与根据javascript的元素框架不同。结果是，如果我从链接点击一定距离，点击突出显示颜色会被激活，但是当您收到此反馈时，事件不会像您期望的那样被触发。

有没有办法纠正激活高光颜色的框架？或者也许有更简单的方法来禁用它并以另一种方式提供类似的反馈？

# python - 如何使用 Flask 测试模板上下文变量

> ID：10693808
> 
> 赞同：11
> 
> 时间：2012-05-21T23:12:31.377
> 
> 标签：python, flask

Django 的测试客户端返回一个测试响应对象，其中包括用于呈现模板的模板上下文变量。[https://docs.djangoproject.com/en/dev/topics/testing/#django.test.client.Response.context](https://docs.djangoproject.com/en/dev/topics/testing/#django.test.client.Response.context)

在 Flask 中测试时如何访问模板上下文变量？

示例视图：

```
@pgt.route('/myview')
def myview():
    context = {
        'var1': 'value 1',
        'var2': 'value 2',
        'var3': 'value 3',
    }
    return render_template('mytemplate.html', **context) 
```

示例测试：

```
class MyViewTestCase(unittest.TestCase):
    def setUp(self):
        self.app = create_app()
        self.client = self.app.test_client()

    def test_get_success(self):
        response = self.client.get('/pgt/myview')

        # I don't want to do this
        self.assertIn('value 1', response.data)

        # I want to do something like this
        self.assertEqual(response.template_context['var1'], 'value 1') 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-22T02:18:22.287

感谢[@andrewwatts](https://twitter.com/#!/andrewwatts)，我使用了（一个版本的）[Flask-Testing](http://pypi.python.org/pypi/Flask-Testing)

```
from flask.ext.testing import TestCase

class MyViewTestCase(TestCase):
    def create_app(self):
        # This method is required by flask.ext.testing.TestCase. It is called
        # before setUp().
        return create_app()

    def test_get_success(self):
        response = self.client.get('/pgt/myview')
        self.assertEqual(self.get_context_variable('var1'), 'value 1') 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-21T23:20:01.180

根据这些有限的信息，我建议将生成上下文的代码分解为一个单独的单元并直接对其进行测试。映射上面的示例：

```
def get_context():
    context = {
        'var1': 'value 1',
        'var2': 'value 2',
        'var3': 'value 3',
    }
    return context

@pgt.route('/myview')
def myview():
    return render_template('mytemplate.html', **get_context()) 
```

# ruby-on-rails-3 - 如何在控制器中使用 Gem 生成常量

> ID：10693813
> 
> 赞同：1
> 
> 时间：2012-05-21T23:12:47.490
> 
> 标签：ruby-on-rails-3, rubygems, ruby-on-rails-3.2

我觉得这是一个愚蠢的问题，但我花了一些时间试图弄清楚并在谷歌上搜索它，但无济于事。我正在尝试在控制器中使用 Ruby Gem。我已将它包含在我的 Gemfile 中，运行 bundle install，看到它出现在我的 gems 列表中，重新启动了我的本地服务器。但不知何故，每当我尝试调用 gem ( [rails_rrdtool](https://github.com/bluescripts/rails_rrdtool "原始宝石") ) 它只是告诉我

```
uninitialized constant RrdgraphsController::RRD
app/controllers/rrdgraphs_controller.rb:22:in `show' 
```

我的代码中它假发的地方是我打电话的时候

```
RRD.graph 
```

就好像它不知道 gem 到底在哪里......但是，我可以使用 require 将它成功导入到 irb 会话中。所以我知道它有效，它只是没有进入那里......

Bundler 应该处理我假设的 gem 的包含。我在错误的地方调用它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T00:34:31.237

This looks like a namespacing issue. Your error says it is looking for the constant inside of the current class: `RrdgraphsController::RRD` when it should be looking for a class outside of the current context.

Try prefixing the class name with a double colon to fully define the location of the class.

```
::RRD.graph #rest of your code 
```

There's a good analogy of what this does in [this other accepted answer](https://stackoverflow.com/questions/10482772/rubys-double-colon-operator-usage-differences). Basically it creates an absolute path so Ruby doesn't have to guess.

# mysql - Django ajax unicode 错误

> ID：10693819
> 
> 赞同：0
> 
> 时间：2012-05-21T23:13:52.590
> 
> 标签：mysql, django, unicode

嗨，我有一个小的 javascript 函数，可以动态过滤我的表单：

```
// set up a new XMLHttpRequest variable
var request = false;
try {
    request = new XMLHttpRequest();
} catch (trymicrosoft) {
    try {
        request = new ActiveXObject("Msxml2.XMLHTTP");
    } catch (othermicrosoft) {
        try {
            request = new ActiveXObject("Microsoft.XMLHTTP");
        } catch (failed) {
            request = false;
        }
    }
}

// if no request then throw up an alert window
if (!request)
    alert("Error initializing XMLHttpRequest!");

// this function takes the island group value and sends it to the url as a get variable
function getIslandName(lang) {
    var islandGroup = document.getElementById("id_island_group").value;

    if (islandGroup == '') {
        // if Not Specified re-selected then set data to null and bypass updatePage()
        var data = null; 
        update_select($('select[name=island_name]'), data);
    } 
    else {
        var url = "../collections/find_island?island_group=" + escape(islandGroup);
        // alert("Ready state is: " + request.readyState);
        // alert("url: " + url);
        request.open("GET", url, true);
        request.onreadystatechange = updatePage;
        request.send(null);
    }    
} 

// what to do when http ready state changes
function updatePage() { 
    if (request.readyState == 4) {
        if (request.status == 200) {

            // get response array
            var data = JSON.parse(request.responseText); 
            update_select($('select[name=island_name]'), data);
        }  
        // some error checking
        else if (request.status == 404) {
            alert("Request url does not exist");
        }
        else {
            alert("Error: status code is " + request.status);
        }
    }
}   

function update_select(select, data) {
    // find and remove existing options
    select.find('option').remove();

    var optionText = document.getElementById("lang").innerHTML

    select.append($('<option value>' + optionText + '</option>'));
    // loop through results and append to select as options
    for (var k in data) {
        select.append($('<option value="'+data[k]+'">'+data[k]+'</option>'));
    }
} 
```

我的表格：

```
class SearchForm(forms.Form):
    ...
    island_group = forms.ModelChoiceField(
        required=False,
        label=ugettext_lazy('Island Group'), 
        initial=None,
        queryset=Localityonline.objects.values_list('islandgroup', flat=True).distinct('islandgroup').exclude(islandgroup=None).order_by('islandgroup'), 
        empty_label=ugettext_lazy("Not Specified"), 
        widget=forms.Select(attrs={"class":'searchfield', "onChange":'getIslandName()'})
    )
    island_name = forms.ChoiceField(
        required=False,
        label=ugettext_lazy('Island Name'), 
        initial=None,
        choices=DEFAULT_CHOICES,
        #queryset = Localitymayor.objects.values_list('islandname', flat=True).distinct('islandname').exclude(islandname="n/a").order_by('islandname'), 
        #empty_label=ugettext_lazy("Not Specified"),
    )
    ... 
```

问题是，如果值`islandGroup`类似于“Española”（即拉丁字符），我会收到状态 500 错误和以下 Django 错误：

```
OperationalError: (1267, "Illegal mix of collations (latin1_swedish_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation '='")

<WSGIRequest
path:/datazone/collections/find_island/,
GET:<QueryDict: {u'island_group': [u'Espa\ufffd']}>,
POST:<QueryDict: {}>,
COOKIES:{'__utma': '173650102.812455619.1337018914.1337629222.1337641044.38',
 '__utmb': '173650102.4.10.1337641044',
 '__utmc': '173650102',
 '__utmz': '173650102.1337613083.36.2.utmcsr=darwinfoundation.org|utmccn=(referral)|utmcmd=referral|utmcct=/datazone/galapagos-research/search/',
 'csrftoken': '7cac07481c8ff5762fac33bf0b3590da',
 'sessionid': '4becce44a950091a3cf7d306633427b4'},
META:{'CSRF_COOKIE': '7cac07481c8ff5762fac33bf0b3590da',
 'DOCUMENT_ROOT': '/home/darwinfo/public_html',
 'GATEWAY_INTERFACE': 'CGI/1.1',
 'HTTP_ACCEPT': '*/*',
 'HTTP_ACCEPT_CHARSET': 'ISO-8859-1,utf-8;q=0.7,*;q=0.3',
 'HTTP_ACCEPT_ENCODING': 'gzip,deflate,sdch',
 'HTTP_ACCEPT_LANGUAGE': 'en-US,en;q=0.8',
 'HTTP_CONNECTION': 'close',
 'HTTP_COOKIE': 'csrftoken=c297f86b353937f52abc36af8b4d595a; csrftoken=7cac07481c8ff5762fac33bf0b3590da; sessionid=4becce44a950091a3cf7d306633427b4; __utma=173650102.812455619.1337018914.1337629222.1337641044.38; __utmb=173650102.4.10.1337641044; __utmc=173650102; __utmz=173650102.1337613083.36.2.utmcsr=darwinfoundation.org|utmccn=
     ...
 'HTTP_USER_AGENT': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.168 Safari/535.19',
 'PATH': '/sbin:/usr/sbin:/bin:/usr/bin',
 'PATH_INFO': u'/collections/find_island/',
 'PATH_TRANSLATED': '/home/darwinfo/public_html/collections/find_island/',
 'QUERY_STRING': 'island_group=Espa%F1ola',
 'REDIRECT_QUERY_STRING': 'island_group=Espa%F1ola',
 'REDIRECT_STATUS': '200',
 'REDIRECT_UNIQUE_ID': 'T7rLMjIWL2YAAGS3N@sAAAET',
 'REDIRECT_URL': '/datazone/collections/find_island/',
 'REMOTE_ADDR': '157.100.37.112',
 'REMOTE_PORT': '35245',
 'REQUEST_METHOD': 'GET',
 'REQUEST_URI': '/datazone/collections/find_island/?island_group=Espa%F1ola',
 'SCRIPT_FILENAME': '/home/darwinfo/public_html/datazone/django.fcgi',
 'SCRIPT_NAME': u'/datazone',
 'SERVER_ADDR': '50.22.47.102',
 'SERVER_PORT': '80',
 'SERVER_PROTOCOL': 'HTTP/1.1',,
 'SERVER_SOFTWARE': 'Apache',
 'UNIQUE_ID': 'T7rLMjIWL2YAAGS3N@sAAAET',
 'wsgi.errors': <flup.server.fcgi_base.OutputStream object at 0x1707ab90>,
 'wsgi.input': <flup.server.fcgi_base.InputStream object at 0x16f2fad0>,
 'wsgi.multiprocess': False,
 'wsgi.multithread': True,
 'wsgi.run_once': False,
 'wsgi.url_scheme': 'http',
 'wsgi.version': (1, 0)}> 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T03:03:19.510

检查每个表的排序规则类型，并确保它们具有相同的排序规则。

之后，还要检查您在操作中使用的每个表字段的排序规则类型。

我遇到了同样的错误，并且这个技巧有效。

# git - 是否可以基于日期时间进行浅 git 克隆？

> ID：10693820
> 
> 赞同：12
> 
> 时间：2012-05-21T23:13:58.137
> 
> 标签：git, date, git-clone

我知道我可以通过指定`--depth`标志来进行浅克隆。但是，这需要一个整数作为其值。有没有办法与 a 具有相同的行为`datetime`？我不希望克隆整个存储库并检查以前的状态。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-10-12T09:02:30.253

为什么是的。至少只有 Git 2.11（2016 年第四季度）

见[提交cccf74e](https://github.com/git/git/commit/cccf74e2da85808478c784e403a69bbfe2b9f518)，[提交079aa97](https://github.com/git/git/commit/079aa97e24daff1329f041e00ba621b0afd59163)，[提交2997178](https://github.com/git/git/commit/2997178ee63c76a4c449f35f299e20b32956795a)，[提交cdc3727](https://github.com/git/git/commit/cdc37277f904ff5c832f04db9e799bccd9672ea5)，[提交859e5df](https://github.com/git/git/commit/859e5df916cc3f3cba920c527f485ffaf6d7efa9)，[提交a45a260](https://github.com/git/git/commit/a45a260086b395729e3c26c9680602e1352184b5)，[提交269a7a8](https://github.com/git/git/commit/269a7a831636b7c7a453f6621fc8b440ff28a408)，[提交41da711](https://github.com/git/git/commit/41da7111f2c825ee0dcd319ec246a84b5ca0fd21)，[提交6d43a0c](https://github.com/git/git/commit/6d43a0cefd769c650bd114f41434ef5a7aa998e7)，[提交994c2aa](https://github.com/git/git/commit/994c2aaf31e1f8e8e69f86324e585620fee68c82)，[提交508ea88](https://github.com/git/git/commit/508ea88226bbdd25ac0aac4f9c8a65a2c3b5be5c)，[提交569e554](https://github.com/git/git/commit/569e554be9cb88047d9f2752750e0c260241f446)，[提交3d9ff4d](https://github.com/git/git/commit/3d9ff4d736475bc74ed249c579b3ad7322e22b85)，[提交79891cb](https://github.com/git/git/commit/79891cb90a4e5b2680308ba2b757a218b9aaa14c)，[提交1dd73e2](https://github.com/git/git/commit/1dd73e20d72921fe81a881a9f6cff6d02eca8146)，[提交0d789a5](https://github.com/git/git/commit/0d789a5bc1aeef2d6d0d3120efc4b85766a0a327)，[提交45a3e52](https://github.com/git/git/commit/45a3e52641fd58c2ebaba2fd2a03308fd6ab8a0a)，[提交 3f0f662](https://github.com/git/git/commit/3f0f6624f554a663ca0c83fd80f769dc9cef93e2)，[提交 7fcbd37](https://github.com/git/git/commit/7fcbd37f9c1b7413b408d0223344d070613777ac)，[提交 6e414e3](https://github.com/git/git/commit/6e414e30fd12460d7a7ba3ce67d20aa82a41a737)(2016 年 6 月 12 日) [Nguyễn Thái Ngọc Duy ( `pclouds`)](https://github.com/pclouds)。
帮助者：[Duy Nguyen ( `pclouds`)](https://github.com/pclouds)、[Eric Sunshine ( `sunshineco`)](https://github.com/sunshineco)和[Junio C Hamano ( `gitster`)](https://github.com/gitster)。
^(（由[Junio C Hamano 合并 -- `gitster`--](https://github.com/gitster)在[提交 a460ea4](https://github.com/git/git/commit/a460ea4a3cb1dad253604b5e2aeaa161637453a9)中，2016 年 10 月 10 日）)

[`git clone`](https://github.com/git/git/blob/994c2aaf31e1f8e8e69f86324e585620fee68c82/Documentation/git-clone.txt#L196-L197)现在包括：

```
--shallow-since=<date>: 
```

> 在指定时间之后创建具有历史记录的浅克隆。

日期格式应该[是`git log`](https://git-scm.com/docs/git-log#Documentation/git-log.txt---dateltformatgt).
虽然测试显示原始日期：

```
cd shallow-since &&
GIT_COMMITTER_DATE="100000000 +0700" git commit --allow-empty -m one &&
GIT_COMMITTER_DATE="200000000 +0700" git commit --allow-empty -m two &&
GIT_COMMITTER_DATE="300000000 +0700" git commit --allow-empty -m three &&
git clone --shallow-since "300000000 +0700" "file://$(pwd)/." ../shallow11 &&
git -C ../shallow11 log --pretty=tformat:%s HEAD >actual &&
echo three >expected &&
test_cmp expected actual 
```

“原始日期”表示：日期为自纪元 (1970-01-01 00:00:00 UTC) 以来的秒数，后跟一个空格，然后是时区作为与 UTC 的偏移量（一个 + 或 - 带有四位数字；前两个是小时，后两个是分钟）。

# javascript - 如何在一个函数调用中结合 jQuery UI 对话框标题更改和打开

> ID：10693821
> 
> 赞同：4
> 
> 时间：2012-05-21T23:13:58.087
> 
> 标签：javascript, jquery, jquery-ui, jquery-dialog

我有一个案例，每当双击表格单元格时，我都需要使用部件号更新 jQuery UI 对话框的标题。标题将从表格单元格的值本身获得。

实际代码中的这个片段（如下）有效，但它对我来说似乎不正确，因为我必须调用对话框函数两次：（1）更改标题，（2）打开对话框。

有没有更好的方法将这两个操作与对 .dialog() 的单个调用结合起来？

**JS 片段**

```
// Dialog declaration
var my_dlg = $('<div id="my-dlg">')
  .html(
    '<span class="part">FOO BAR</span>'
  )
  .dialog({
    autoOpen: false,
    title: 'Default Title',
    modal: true
  });

// Event handler
$('td.part').live('dblclick', function(){
  $(my_dlg)
    .dialog('option','title', $(this).text())
    .dialog('open');
}); 
```

**HTML 片段**

```
<table>
<tr><td class="part">AB123456</td></tr>
<tr><td class="part">GX443459</td></tr>
<tr><td class="part">SK555455</td></tr>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T13:39:02.873

这是正确/唯一的方法，因为您有 2 个事件、对话框打开本身以及单击表格单元格。这也是在实例化之后更改 jQuery UI 对话框中的任何选项的正确方法。

您所做的唯一不必要的事情是在您第二次使用它时卡住`my_dlg`了`$()`，它不需要，因为它已经是一个 jQuery 对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T13:44:31.843

这是调用小部件方法的标准方式。给定小部件（在您的情况下）公开的所有方法`dialog`都桥接到`$.fn`小部件的名称下，因此它们可以应用于 jQuery 对象。

但是，如果您想避免重复调用`dialog()`，您可以获取对小部件实例的引用并直接调用其方法：

```
my_dlg.data("dialog").option("title", $(this).text()).open(); 
```

# r - 在R中索引矩阵

> ID：10693824
> 
> 赞同：6
> 
> 时间：2012-05-21T23:14:12.743
> 
> 标签：r, matrix, indexing

一个新手 R 用户在这里。所以我有一个格式如下的数据集：

```
 Date  Temp  Month
 1-Jan-90 10.56      1
 2-Jan-90 11.11      1
 3-Jan-90 10.56      1
 4-Jan-90 -1.67      1
 5-Jan-90  0.56      1
 6-Jan-90 10.56      1
 7-Jan-90 12.78      1
 8-Jan-90 -1.11      1
 9-Jan-90  4.44      1
10-Jan-90 10.00      1 
```

在 R 语法中：

```
datacl <- structure(list(Date = structure(1:10, .Label = c("1990/01/01", 
  "1990/01/02", "1990/01/03", "1990/01/04", "1990/01/05", "1990/01/06", 
  "1990/01/07", "1990/01/08", "1990/01/09", "1990/01/10"), class = "factor"), 
      Temp = c(10.56, 11.11, 10.56, -1.67, 0.56, 10.56, 12.78, 
      -1.11, 4.44, 10), Month = c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
      1L, 1L)), .Names = c("Date", "Temp", "Month"), class = "data.frame", row.names = c(NA, 
  -10L)) 
```

我想对特定月份的数据进行子集化，并将更改因子应用于临时，然后保存结果。所以我有类似的东西

```
idx <- subset(datacl, Month == 1)  # Index
results[idx[,2],1] = idx[,2]+change  # change applied to only index values 
```

但我不断收到类似的错误

```
Error in results[idx[, 2], 1] = idx[, 2] + change: 
  only 0's may be mixed with negative subscripts 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:22:08.527

首先，给变化因子一个值：

```
change <- 1 
```

现在，这是创建索引的方法：

```
# one approach to subsetting is to create a logical vector: 
jan.idx <- datacl$Month == 1

# alternatively the which function returns numeric indices:
jan.idx2 <- which(datacl$Month == 1) 
```

如果您只想要一月份的数据子集，

```
jandata <- datacl[jan.idx,]
transformed.jandata <- transform(jandata, Temp = Temp + change) 
```

要保留整个数据框，但仅将更改因子添加到 Jan temps：

```
datacl$Temp[jan.idx] <- datacl$Temp[jan.idx] + change 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T23:22:47.973

首先，请注意，`subset`它不会生成索引，它会生成原始数据框的子集，其中包含所有带有`Month == 1`.

然后当你在做的时候`idx[,2]`，你正在选择`Temp`列。

```
results[idx[,2],1] = idx[,2] + change 
```

但是随后您将这些用作 的索引*，*`results`即您将它们用作行号。行号不能是`10.56`or之类的东西`-1.11`，因此您的错误。`results`此外，您正在选择其中的第一列`Date`并尝试为其添加温度。

有几种方法可以做到这一点。

您可以`TRUE`为一行创建一个逻辑索引`Month == 1`，`FALSE`否则如下所示：

```
idx <- datac1$Month == 1 
```

然后您可以使用该索引来选择`datac1`要修改的行（我认为这是您最初尝试做的）：

```
datac1$Temp[idx] <- datac1$Temp[idx] + change  # or 'results' instead of 'datac1'? 
```

请注意，`datac1$Temp[idx]`选择`Temp`列`datac1`和`idx`行。

你也可以做

```
datac1[idx,'Temp'] 
```

或者

```
datac1[idx,2]  # as Temp is the second column. 
```

如果您*只想*成为`results`其中的子集，请`Month == 1`尝试：

```
results <- subset(datac1, Month == 1)
results$Temp <- results$Temp + change 
```

这是因为`results`只包含你感兴趣的行，所以不需要做子集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T00:30:40.493

就个人而言，我会使用`ifelse()`和利用句法之美，这是`within()`一个不错的 one liner `datacl <- within(datacl, Temp <- ifelse(Month == 1, Temp + change,Temp))`。好吧，我说的是一个班轮，但你也需要在`change`其他地方定义。

# java - GSON 序列化非常非常慢

> ID：10693825
> 
> 赞同：12
> 
> 时间：2012-05-21T23:14:42.197
> 
> 标签：java, json, performance, serialization, gson

我正在尝试使用 GSON 序列化 7000 POJO 的数组，并且序列化时间非常慢。序列化以下对象的数组大约需要 3-5 秒：

```
public class Case {
    private Long caseId;
    private Key<Organization> orgKey;

    private Key<Workflow> workflowKey;
    private Key<User> creatorKey;

    private Date creationTimestamp;
    private Date lastUpdatedTimestamp;

    private String name;
    private String stage;
    private String notes;
} 
```

关键字段使用自定义序列化器/反序列化器进行序列化：

```
public class GsonKeySerializerDeserializer implements JsonSerializer<Key<?>>, JsonDeserializer<Key<?>>{

@Override
public JsonElement serialize(Key<?> src, Type typeOfSrc, JsonSerializationContext arg2) {
    return new JsonPrimitive(src.getString());
}

@Override
public Key<?> deserialize(JsonElement src, Type typeOfSrc, JsonDeserializationContext arg2) throws JsonParseException {
    if (src.isJsonNull() || src.getAsString().isEmpty()) {
        return null;
    }

    String s = src.getAsString();
    com.google.appengine.api.datastore.Key k = KeyFactory.stringToKey(s);
    return new Key(k);
}
} 
```

为了测试手写 JSON 序列化程序的性能，我测试了以下代码，它可以比 GSON 快大约 10 倍地序列化相同的 Case 对象数组。

```
List<Case> cases = (List<Case>) retVal;
JSONArray a = new JSONArray();
for (Case c : cases) {
    JSONObject o = new JSONObject();
    o.put("caseId", c.getCaseId());
    o.put("orgKey", c.getOrgKey().getString());
    o.put("workflowKey", c.getWorkflowKey().getString());
    o.put("creatorKey", c.getCreatorKey().getString());
    o.put("creationTimestamp", c.getCreationTimestamp().getTime());
    o.put("lastUpdatedTimestamp", c.getLastUpdatedTimestamp().getTime());
    o.put("name", c.getName());
    o.put("stage", c.getStage());
    o.put("notes", c.getNotes());
    a.put(o);

}
String json = a.toString(); 
```

任何想法为什么 GSON 在这种情况下表现如此糟糕？

**更新**

这是实际启动序列化的代码：

```
Object retVal = someFunctionThatReturnsAList();
String json = g.toJson(retVal);
resp.getWriter().print(json); 
```

**更新2**

这是一个非常简单的测试用例，说明了相对于 org.json 的较差性能：

```
List<Foo> list = new ArrayList<Foo>();
for (int i = 0; i < 7001; i++) {
    Foo f = new Foo();
    f.id = new Long(i);
    list.add(f);
}

Gson gs = new Gson();
long start = System.currentTimeMillis();
String s = gs.toJson(list);
System.out.println("Serialization time using Gson: " + ((double) (System.currentTimeMillis() - start) / 1000));

start = System.currentTimeMillis();
JSONArray a = new JSONArray();
for (Foo f : list) {
    JSONObject o = new JSONObject();
    o.put("id", f.id);
    a.put(o);

}
String json = a.toString();
System.out.println("Serialization time using org.json: " + ((double) (System.currentTimeMillis() - start) / 1000));

System.out.println(json.equals(s)); 
```

Foo 在哪里：

```
public class Foo {
public Long id;
} 
```

这输出：

```
Serialization time using Gson: 0.233
Serialization time using org.json: 0.028
true 
```

几乎 10 倍的性能差异！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T14:26:36.773

我试图重现您的问题，但无法重现。我创建了 7000 个包含重要数据的对象。在我的 ThinkPad 上，Gson 需要约 260 毫秒来序列化约 3MB 的 Gson，这是一个可观的约 10Mbps。

大部分时间用于将日期转换为字符串。将两个日期字段转换为“long”节省了大约 50 毫秒。

通过从树适配器（JsonSerializer/JsonDeserializer）迁移到新的流适配器类，我能够节省大约 10 毫秒`TypeAdaper`。设置它的代码如下所示：

```
 private static TypeAdapter<Key<String>> keyAdapter = new TypeAdapter<Key<String>>() {
        @Override public void write(JsonWriter out, Key<String> value) throws IOException {
            out.value(value.value);
        }

        @Override public Key<String> read(JsonReader in) throws IOException {
            if (in.peek() == JsonToken.NULL) {
                in.nextNull();
                return null;
            }
            return new Key<String>(in.nextString());
        }
    };

    ...

    Gson gson = new GsonBuilder()
            .registerTypeAdapter(Key.class, keyAdapter)
            .create(); 
```

我的场景和你的场景之间的主要区别在于我使用的是我自己的伪造 Key 类。但是，如果 Key 是您手动序列化每个案例时应该出现的瓶颈。

**解决问题**

最好的下一步是在`Case`序列化改进之前删除字段。您的某个字段可能包含需要很长时间才能序列化的内容：可能是一个非常长的字符串，需要过度转义？隔离问题后，向 Gson 项目[报告错误](http://code.google.com/p/google-gson/issues/list)，我们将很高兴地解决问题。除了包含重现问题的*代码之外，您还应该包含代表性**数据*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-09T09:45:02.110

如何在 json 上使用平面缓冲区。

[https://medium.freecodecamp.com/why-consider-flatbuffer-over-json-2e4aa8d4ed07#.d79exjq8n](https://medium.freecodecamp.com/why-consider-flatbuffer-over-json-2e4aa8d4ed07#.d79exjq8n)

# silverlight - 为什么我的 Silverlight 用户控件属性为空？

> ID：10693826
> 
> 赞同：1
> 
> 时间：2012-05-21T23:15:06.360
> 
> 标签：silverlight

我有一个用户控件：

```
 <Grid x:Name="LayoutRoot" Background="White">
        <TextBlock Name="TextBlock1" Text="Text for"></TextBlock> 
    </Grid> 
```

它有一个cs文件：

```
public partial class MyUserControl: UserControl
{
    public string MyProperty { get; set; }

    public MyUserControl()
    {
        InitializeComponent();
        DoSomething();
    }

    private void DoSomething()
    {
        TextBlock1.Text = TextBlock1.Text + MyProperty;
    }
} 
```

我正在尝试以编程方式将此用户控件添加到另一个用户控件：

```
 UserControls.MyUserControl myUserControl = new UserControls.MyUserControl();
            myUserControl.MyProperty = "Something";
            MyStackPanel.Children.Add(myUserControl); 
```

我以为我以前做过这样的事情没有任何问题，但在这种情况下 MyProperty 始终为空。我做错什么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T01:03:33.813

发生的事情是您`DoSomething`在设置之前调用了您的构造函数，`MyProperty`因此`MyProperty`等于 null。如果您希望数据在`UserControl`创建时就在那里，您可以在构造函数中设置它。

IE

```
public partial class MyUserControl : UserControl
{
    public string MyProperty { get; set; }

    public MyUserControl()   //Default Constructor
    {
        InitializeComponent();
    }

    public MyUserControl(string MyData)
    {
        InitializeComponent();
        MyProperty = MyData;
        DoSomething();
    }
    private void DoSomething()
    {
        TextBlock1.Text = TextBlock1.Text + MyProperty;
    }

} 
```

并像这样创建它。

```
MyUserControl myUserControl = new MyUserControl(" Something");
MyStackPanel.Children.Add(myUserControl); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T10:41:26.243

您的代码按原样正常运行，除非您调用`DoSomething()`. 您应该避免在控件的构造函数中进行*GUI 交互*，原因有很多（其中最重要的是您的属性尚未设置，正如 Mark Hall 所指出的那样）。*但是，我不建议添加不同的构造函数来获取初始属性*。

您只是想将该调用推迟到控件的[Loaded](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.loaded%28v=vs.95%29.aspx)事件。

## 假设您像这样在 Xaml 中设置事件：

```
<navigation:Page x:Class="MyUserControl" 
    ...
    Loaded="Page_Loaded"> 
```

## 您的代码如下所示：

```
public partial class MyUserControl: UserControl
{
    public string MyProperty { get; set; }

    public MyUserControl()
    {
        InitializeComponent();
    }

    private void Page_Loaded(object sender, RoutedEventArgs e)
    {
       DoSomething();
    }

    private void DoSomething()
    {
        TextBlock1.Text = TextBlock1.Text + MyProperty;
    }
} 
```

## 如果你想在代码中设置*Loaded*事件，它看起来像：

```
public partial class MyUserControl: UserControl
{
    public string MyProperty { get; set; }

    public MyUserControl()
    {
        InitializeComponent();
        Loaded += Page_Loaded; 
    }

    private void Page_Loaded(object sender, RoutedEventArgs e)
    {
       DoSomething();
    }

    private void DoSomething()
    {
        TextBlock1.Text = TextBlock1.Text + MyProperty;
    }
} 
```

这取决于您在构建之后设置所有所需的属性，但在页面加载之前，就像您已经在做的那样。

```
UserControls.MyUserControl myUserControl = new UserControls.MyUserControl();
myUserControl.MyProperty = "Something";
MyStackPanel.Children.Add(myUserControl); // This makes it visible when Loaded event is called 
```

# c - valgrind 大小为 8 的无效读取

> ID：10693827
> 
> 赞同：3
> 
> 时间：2012-05-21T23:15:11.440
> 
> 标签：c, valgrind

我试图理解为什么 Valgrind 报告“无效读取大小 4”错误。代码编译并在 Linux 控制台上给出正确的输出。
目标是构建一个动态增长的结构*记录*数组（最多 100 万个项目），并通过结构*列表*按语言组织它。

代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <errno.h>
#include <sys/types.h>
#include <unistd.h>
#include "../crc64.c"

typedef struct {
  char          cat;
  uint64_t      crc;
  int           id;
} record;

typedef struct {
  int           count;
  char          *lang;
  record        **records;
} list;

record *records = NULL;
int record_count = 0;
list *lists = NULL;
int list_count = 0;

void addItemToList(record *r, char *lang){  
  int found = 0;
  for(int i = 0; i<list_count; i++){
    if(strcmp(lists[i].lang, lang) == 0){
      list *l = &lists[i];
      found = 1;      
      record **tmp  = realloc(l->records, (l->count + 1) * sizeof(record *));
      if (tmp == NULL)
        printf("Problem on realloc - records/list\n");
      else{
        l->records = tmp;
        l->count ++;
        l->records[l->count -1] = r;
      }        
      break;
    }
  }
  if(found == 0){
    list_count ++;
    list *tmp = realloc(lists, list_count  * sizeof(list));
    if(!tmp) 
      printf("Error on realloc - list");
    lists = tmp;
    lists[list_count - 1].count =1 ;
    lists[list_count - 1].lang = lang ;
    record **tmp1 = realloc(NULL, sizeof(record *));
    if(!tmp1)
      printf("Error on realloc records/list \n");          
    lists[list_count - 1].records = tmp1;      
    tmp1[0] = r;    
  }  
}

int addRecord(char cat, char *name, int id, char lang[3]){  
  record *tmp;
  if(record_count == 0){
    tmp = malloc(1 * sizeof(record));         
  }  
  else 
    tmp = realloc(records, (record_count + 1)  * sizeof(record));
  if(tmp == NULL){
    printf("Error on m(re)alloc records\n");
    return(1);
  }  

  records = tmp;
  record r = {cat, crc64(name), id};
  records[record_count ] = r; 
  addItemToList(&(records[record_count]), lang);
  record_count ++;
  return 0;  
}

int main(void){
  addRecord('l', "torino",1, "it");
  addRecord('l', "berlin",20, "de");
  addRecord('l', "paris",30, "fr");  
  addRecord('l', "hamburg",21, "de");
  addRecord('l', "sassari",2, "it");
  addRecord('l', "cagliari",3, "it");
  addRecord('l', "milano",4, "it");

  for(int i=0; i< list_count;i++){
    printf("lang: %s, count :%d\n", lists[i].lang, lists[i].count);  
    for (int z = 0; z < lists[i].count; z ++){
      printf("  crc:  %lu -   id: %d \n", lists[i].records[z]->crc, lists[i].records[z]->id);
    }
  }
  return 0;
} 
```

这里是 Valgrind 的输出：

```
cc -std=c99  -O0 -g tt.c -o tt && valgrind --track-origins=yes ./tt
lang: it, count :4
==17435== Invalid read of size 4
==17435==    at 0x400BAC: main (tt.c:92)
==17435==  Address 0x51d0050 is 16 bytes inside a block of size 24 free'd
==17435==    at 0x4C29097: realloc (vg_replace_malloc.c:525)
==17435==    by 0x400990: addRecord (tt.c:65)
==17435==    by 0x400A8E: main (tt.c:81)
==17435== 
==17435== Invalid read of size 8
==17435==    at 0x400BE0: main (tt.c:92)
==17435==  Address 0x51d0048 is 8 bytes inside a block of size 24 free'd
==17435==    at 0x4C29097: realloc (vg_replace_malloc.c:525)
==17435==    by 0x400990: addRecord (tt.c:65)
==17435==    by 0x400A8E: main (tt.c:81)
==17435== 
  crc:  10540480176773849829 -   id: 1 
  crc:  5100567372334599520 -   id: 2 
  crc:  16805344662159858020 -   id: 3 
  crc:  16314500525507880138 -   id: 4 
lang: de, count :2
  crc:  3766391767329109829 -   id: 20 
  crc:  12127946872667643737 -   id: 21 
lang: fr, count :1
  crc:  2180538375615994033 -   id: 30 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T23:26:07.947

您正在重新分配记录，但不更新指针。

```
tmp = realloc(records, (record_count + 1)  * sizeof(record)); 
```

当你这样做时，所有指向旧 `records`数组的指针都变得**无效。**

这是一个更简单的例子。

```
record *array = malloc(sizeof(*array));
record *r1 = &array[0];
array = realloc(array, sizeof(*array) * 2);
record *r2 = &array[1];
// r1 is probably invalid, since 'array' changed 
```

有几种方法可以解决此问题。

1.  当你时`realloc`，通过并更新所有指针。这是一个真正的痛苦。

2.  分别分配每条记录，而不是在一个大数组中。（不，这不会浪费内存。至少与由于字段顺序已经浪费的每条记录的 8 个字节相比没有。）

3.  代替指向记录的指针，使用记录数组的索引。这些不需要更新。

# c++ - 静态对象如何跨 DLL 和 Windows 二进制内存共享

> ID：10693829
> 
> 赞同：4
> 
> 时间：2012-05-21T23:15:27.860
> 
> 标签：c++, memory, memory-management, dll

我有一些关于 DLL 的设计问题，我目前在你可能称之为它的地方，正如维基百科所指的那样[DLL Hell](http://en.wikipedia.org/wiki/DLL_Hell "DLL 地狱")问题如下：

我创建了一个系统，该系统具有多个实现为 DLL 的模块。这些在应用程序中使用，并且可以加载 DLL，但并非所有这些都是必需的。如果只完成数学之类的事情，它可以链接到“Utilities.dll”并使用它。问题是，我有一个记录器/跟踪器。这会将所有内容记录到一个文件和一个调试控制台中，调试控制台只是一个流输出。问题是如何处理多个 DLL 尝试使用同一个日志类。看到日志类在这个“Utilities.dll”中，“DataManagers.dll”和其他 dll 之类的东西也想使用日志类功能。这包括登录到文件。我目前正在使用临界区来确保不会发生写入冲突，但看到临界区是在用户模式下实现的 d 必须在某些时候切换到互斥锁或类似的东西才能拥有内核模式对象。但是，如果我只使用关键部分，那么在 DLL 内存中拥有多个日志类实例意味着我会遇到一些严重的问题。

我似乎无法一起困惑的是，所有 DLL 都能够使用相同的日志类实例，而不必一个一个地链接到 Utilities.dll。我不想将 8 个 dll 加载到我的演示项目中，并让所有这 8 个引用带有日志类的那个 dll，如果我需要更多类似日志类的东西，这将是一个连锁反应。有没有办法正确地做到这一点？使用类的功能，在其他 DLL 中的 DLL 中使用静态函数，在 .exe Windows 二进制文件中使用相同的“静态”函数，从而不会在写入日志文件甚至调试控制台的输出流时发生冲突。

如果我完全错了并试图做不可能的事情，请告诉我并帮助实现尽可能接近此的目标。我知道在 DLL 中使用 Singleton 模式时会出现一些类似的问题，但这可以通过以下方式解决

到目前为止我已经尝试过：

*   初始化 DLL 的类时，给它们一个日志库的实例，但这违背了类具有所有静态成员的目的。

我也发现了这个问题，它是 similair （甚至我的全局工具的库的名称都在那个..）但它没有回答我的问题并且有一些不同的方法以及来自 '09 . [如何模仿静态库的“应用程序中全局变量的多个实例”行为但使用 DLL？](https://stackoverflow.com/questions/1076644/how-to-mimic-the-multiple-instances-of-global-variables-within-the-application)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T07:19:19.767

您的问题根本不是“DLL Hell”。

这是一个基本了解 DLL 如何工作的问题。每个进程最多加载一次 DLL。因此，如果您的 DLL 被多个其他 DLL 使用，它仍然会在每个进程中存在一次。如果您的日志类对象在您的 DLL 中实现为单例（例如全局对象），那么每个进程都有一个对象。

然后应该保护一个对象以防止在进程中同时使用。关键部分是流程本地的，非常适合这一点。您不需要互斥体，因为两个进程各自都有自己的 Utilities.DLL 及其对象的副本。

如果您的记录器记录到单个固定文件，您*可能会遇到问题。*在这种情况下，两个进程会尝试登录到同一个文件。这是一个设计问题，无论如何您都不想破解。将您的日志输出分开，因此请确保每个记录器写入一个唯一的日志文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T11:28:44.400

从下图可以看出![图片](../Images/559dd06b6a5d6d1e1b125b60b4c30655.png)，

实际上，在一个进程中多次映射一个 DLL 是很常见的（与一种非常流行的观点相反）！这是一个基本了解 DLL 如何工作的问题 :-)

在干净的 Windows XP 系统上，您可以在 iexplore.exe 进程中看到多个 dxtmsft.dll、ieframe.dll、iepeers.dll 等实例。所有这些 Dll 都只是映射到不同的地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T23:45:42.340

使用 WinApi 的 CreatePipe 或 CreateNamedPipe 函数，这是一个使用 Windows 共享内存的类似队列的通信部分：

```
 BOOL WINAPI CreatePipe(
  __out         PHANDLE hReadPipe,
  __out         PHANDLE hWritePipe,
  __in          LPSECURITY_ATTRIBUTES lpPipeAttributes,
  __in          DWORD nSize
); 
```

或者

```
 HANDLE WINAPI CreateNamedPipe(
  __in          LPCTSTR lpName,
  __in          DWORD dwOpenMode,
  __in          DWORD dwPipeMode,
  __in          DWORD nMaxInstances,
  __in          DWORD nOutBufferSize,
  __in          DWORD nInBufferSize,
  __in          DWORD nDefaultTimeOut,
  __in          LPSECURITY_ATTRIBUTES lpSecurityAttributes
); 
```

使用 ReadFile 和 WriteFile 通过管道从其他线程/进程中进行通信。

要从管道中读取，进程在调用 ReadFile 函数时使用读取句柄。ReadFile 在以下情况之一为真时返回：在管道的写端完成写操作、已读取请求的字节数或发生错误。

当进程使用 WriteFile 写入匿名管道时，直到写入所有字节后，写入操作才会完成。如果在写入所有字节之前管道缓冲区已满，则 WriteFile 不会返回，直到另一个进程或线程使用 ReadFile 来提供更多可用缓冲区空间。

使用一个线程处理输入并将日志写入文件和/或控制台。

更多关于管道的信息：http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa365780 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365780(v=vs.85).aspx)

# gdb - Go：使用 gdb 打印变量

> ID：10693831
> 
> 赞同：5
> 
> 时间：2012-05-21T23:15:28.743
> 
> 标签：gdb, go

在这个程序中，如何使用调试器中断执行并打印 i 的值？

```
package main

import "fmt"

func main() {
        x := "abc"
        i := 3
        fmt.Println(i)
        fmt.Println(x)
} 
```

我无法打印我。但是我可以打印 x：

```
go build test.go
gdb test  
[...]Reading symbols from /home/ned/test...done.
(gdb) br 9
(gdb) run
(gdb) p i
No symbol "i" in current context.
(gdb) p x
$1 = "abc" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T15:00:00.400

听起来我可能被编译器优化了不存在的变量。您是否尝试过调试版本？

您可以使用`go build -gcflags '-N'`.

# sfml - 键盘事件 SFML 2.0

> ID：10693835
> 
> 赞同：6
> 
> 时间：2012-05-21T23:16:14.227
> 
> 标签：sfml

我试图在 SFML 2 中获取密钥输入，在 SFML 1.6 中使用

```
 while (App.GetEvent(Event))
       {
          if (App.GetInput().IsKeyDown(sf::Key::Down)) { dir='d'; }
    } 
```

但我不知道如何在 SFML 2 中做到这一点。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-09T03:29:26.730

当您不需要担心实时键盘输入时，您可以使用与您提供的 SFML 1.6 代码非常相似的方法。在应用程序的事件处理循环中，您可以执行以下操作：

```
sf::Event event;
while (mWindow.pollEvent(event))
{
    if (event.type == sf::Event::KeyPressed)
    {
        if (event.key.code == sf::Keyboard::Escape)
        {
            // Do something when Escape is pressed...
        }
        if (event.key.code == sf::Keyboard::W)
        {
            // Do something when W is pressed...
        }

        // And so on.
    }
} 
```

当您必须保证应用程序在用户按下键时具有焦点时，这种类型的输入处理非常好，因为否则不会生成键事件。当不经常按下相关键时，它也非常有用。您可以在此处的 SFML 2.0 教程中查看一个示例，在标题为“KeyPressed 和 KeyReleased 事件”的部分下：http: [//sfml-dev.org/tutorials/2.0/window-events.php](http://sfml-dev.org/tutorials/2.0/window-events.php)

另一方面，您实际上可能需要访问实时键盘输入。为此，请使用 SFML 2.0 的 Keyboard 类，如下所示：

```
if (sf::Keyboard::isKeyPressed(sf::Keyboard::W))
{
    // 'W' is currently pressed, do something...
} 
```

通过实时输入，您可以访问该特定时间点的输入设备状态。这很方便，因为您不必将所有关键检查集中在事件处理循环中。这种方法的一个缺点是因为 SFML 只是读取键盘的状态，如果应用程序没有焦点、最小化等，您的事件处理代码仍然可以执行。您可以找到有关所有实时输入的教程这里：[http ://sfml-dev.org/tutorials/2.0/window-inputs.php](http://sfml-dev.org/tutorials/2.0/window-inputs.php)

在选择事件处理与实时方法时要小心。对于一个游戏示例，考虑当用户按住空格键时角色开火机枪的情况。如果您在事件处理循环中处理空格键，机枪将像半自动一样错误地开火，因为`sf::Event::KeyPressed`同一键的事件之间存在延迟，即使用户按住键也是如此。如果您通过检查实时键盘输入来处理空格键，机枪将按预期重复射击。

# android - 当按钮 onFocus 或 onPress Android 时播放声音

> ID：10693840
> 
> 赞同：0
> 
> 时间：2012-05-21T23:16:59.063
> 
> 标签：android, button, onfocus

我正在做一个简单的钢琴活动，我有几个按钮模拟钢琴键，我只想播放声音；不是在单击按钮时，而是在按下按钮时。

我尝试使用 a 对其焦点状态进行操作，`OnFocusChangeListener`但没有成功。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:26:49.103

你最好使用`ImageView`和使用`OnTouchListener`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:30:06.107

如果您使用按钮，为什么不使用`onClickListener`? 如果你想长按使用`OnLongClickListener`？

一个很好的视频使用`onLongClickListener`：[http ://www.youtube.com/watch?v=K7YuusyEvOg&feature=plcp](http://www.youtube.com/watch?v=K7YuusyEvOg&feature=plcp)

# javascript - querySelectorAll 和 getElementsBy* 方法返回什么？

> ID：10693845
> 
> 赞同：183
> 
> 时间：2012-05-21T23:17:15.363
> 
> 标签：javascript, getelementsbyclassname, dom-traversal

`getElementsByClassName`（和类似的函数，如`getElementsByTagName`and ）是否与返回元素数组`querySelectorAll`相同`getElementById`或返回元素数组？

我问的原因是因为我正在尝试使用`getElementsByClassName`. 见下文。

```
//doesn't work
document.getElementsByClassName('myElement').style.size = '100px';

//works
document.getElementById('myIdElement').style.size = '100px'; 
```

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2012-05-21T23:18:23.053

您的[`getElementById`](https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementById)代码有效，因为 ID 必须是唯一的，因此该函数始终只返回一个元素（或者`null`如果没有找到）。

但是，方法 、、、 [`getElementsByClassName`](https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByClassName)和 返回 元素的可迭代集合。[`getElementsByName`](https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByName)[`getElementsByTagName`](https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByTagName)[`getElementsByTagNameNS`](https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByTagNameNS)

方法名称提供了提示：`getElement`隐含*单数*，而`getElements`隐含*复数*。

该方法[`querySelector`](https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelectorAll)还返回一个元素，并[`querySelectorAll`](https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelectorAll)返回一个可迭代的集合。

可迭代集合可以是 a[`NodeList`](https://developer.mozilla.org/en-US/docs/Web/API/NodeList)或[`HTMLCollection`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLCollection).

[`getElementsByName`](https://html.spec.whatwg.org/multipage/dom.html#the-document-object)并且[`querySelectorAll`](https://dom.spec.whatwg.org/#interface-parentnode)都指定返回一个`NodeList`; 其他[`getElementsBy*`方法](https://dom.spec.whatwg.org/#interface-document)指定返回一个`HTMLCollection`，但请注意，某些浏览器版本以不同的方式实现这一点。

这两种集合类型都没有提供元素、节点或类似类型提供的相同属性；这就是读取...<code>(...<code>) 失败`style`的原因。`document.getElements`换句话说： a`NodeList`或 an`HTMLCollection`没有`style`; 只有一个`Element`有一个`style`。

* * *

这些“类似数组”的集合是包含零个或多个元素的列表，您需要对其进行迭代才能访问它们。虽然您可以像数组一样迭代它们，但请注意它们与[s](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)[*不同*](https://stackoverflow.com/q/29707568)。[`Array`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)

在现代浏览器中，您可以使用 ; 将这些可迭代对象转换为适当的数组[`Array.from`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from)。然后您可以使用`forEach`其他[数组方法，例如迭代方法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#instance_methods)：

```
Array.from(document.getElementsByClassName("myElement"))
  .forEach((element) => element.style.size = "100px"); 
```

在不支持`Array.from`或迭代方法的旧浏览器中，您仍然可以使用[`Array.prototype.slice.call`](https://stackoverflow.com/q/7056925). 然后你可以像使用真正的数组一样迭代它：

```
var elements = Array.prototype.slice
    .call(document.getElementsByClassName("myElement"));

for(var i = 0; i < elements.length; ++i){
  elements[i].style.size = "100px";
} 
```

您也可以遍历`NodeList`or`HTMLCollection`本身，但请注意，在大多数情况下，这些集合是*实时*的（[MDN 文档](https://developer.mozilla.org/en-US/docs/Web/API/NodeList#live_vs._static_nodelists)、[DOM 规范](https://dom.spec.whatwg.org/#concept-collection-live)），即它们会随着 DOM 的变化而更新。因此，如果您在循环时插入或删除元素，请确保不要意外[跳过某些元素](https://stackoverflow.com/q/15562484)或[创建无限循环](https://stackoverflow.com/q/9709351)。MDN 文档应始终注意方法返回实时集合还是静态集合。

例如，a`NodeList`提供了一些迭代方法，例如`forEach`在现代浏览器中：

```
document.querySelectorAll(".myElement")
  .forEach((element) => element.style.size = "100px"); 
```

`for`也可以使用一个简单的循环：

```
var elements = document.getElementsByClassName("myElement");

for(var i = 0; i < elements.length; ++i){
  elements[i].style.size = "100px";
} 
```

* * *

有一些像[jQuery](https://jquery.com)这样的库可以使 DOM 查询更短一些，并在“一个元素”和“一个元素集合”上创建一个抽象层：

```
$(".myElement").css("size", "100px"); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2016-02-15T02:53:10.243

您正在使用数组作为对象，和之间的区别`getElementbyId`在于 `getElementsByClassName`：

*   `getElementbyId`如果没有找到具有 ID 的元素，将返回一个[Element 对象或 null](https://developer.mozilla.org/en-US/docs/Web/API/Element)
*   `getElementsByClassName`将返回一个[实时的 HTMLCollection](https://developer.mozilla.org/en-US/docs/Web/API/HTMLCollection)，如果没有找到匹配的元素，长度可能为 0

## getElementsByClassName

> 该`getElementsByClassName(classNames)`方法采用一个字符串，该字符串包含一组无序的、以空格分隔的表示类的唯一标记。调用时，该方法必须返回一个活动 `NodeList`对象，该对象包含文档中具有该参数中指定的所有类的所有元素，并通过在空格上拆分字符串来获得类。如果参数中没有指定标记，则该方法必须返回一个空的 NodeList。

[https://www.w3.org/TR/2008/WD-html5-20080610/dom.html#getelementsbyclassname](https://www.w3.org/TR/2008/WD-html5-20080610/dom.html#getelementsbyclassname)

## getElementById

> getElementById() 方法访问具有指定 id 的第一个元素。

[https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementById](https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementById)

在您的代码中：

> 1- document.getElementsByClassName('myElement').style.size = '100px';

将**无法**按预期工作，因为`getElementByClassName`将返回一个数组，并且该数组将**没有**该`style`属性，您可以`element`通过遍历它们来访问它们。

这就是该函数`getElementById`为您工作的原因，该函数将返回直接对象。因此，您将能够访问该`style`物业。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2017-02-21T23:07:39.983

**ES6**提供了[`Array.from()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from)方法，它从类数组或可迭代对象创建一个新的 Array 实例。

```
let boxes = document.getElementsByClassName('box');

Array.from(boxes).forEach(v => v.style.background = 'green');
console.log(Array.from(boxes));
```

```
.box {
  width: 50px;
  height: 50px;
  margin: 5px;
  background: blue;
  display: inline-block;
}
```

```
<div class='box'></div>
<div class='box'></div>
<div class='box'></div>
<div class='box'></div>
```

正如您在代码片段中看到的那样，在使用[`Array.from()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from)函数之后，您就可以对每个元素进行操作。

使用相同的解决方案**`jQuery`**。

```
$('.box').css({'background':'green'});
```

```
.box {
  width: 50px;
  height: 50px;
  margin: 5px;
  background: blue;
  display: inline-block;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div class='box'></div>
<div class='box'></div>
<div class='box'></div>
<div class='box'></div>
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2016-01-07T09:14:12.577

以下描述来自[此页面](http://www.w3schools.com/jsref/met_document_getelementsbyclassname.asp)：

> getElementsByClassName() 方法返回文档中具有指定类名的所有元素的集合，作为 NodeList 对象。
> 
> NodeList 对象表示节点的集合。可以通过索引号访问节点。索引从 0 开始。
> 
> 提示：您可以使用 NodeList 对象的 length 属性来确定具有指定类名的元素的数量，然后您可以遍历所有元素并提取所需的信息。

因此，作为参数`getElementsByClassName`将接受类名。

如果这是您的 HTML 正文：

```
<div id="first" class="menuItem"></div>
<div id="second" class="menuItem"></div>
<div id="third" class="menuItem"></div>
<div id="footer"></div> 
```

then`var menuItems = document.getElementsByClassName('menuItem')`将返回 3 个 upper 的集合（不是数组）`<div>`，因为它们与给定的类名匹配。

然后，您可以使用以下方法迭代此节点（`<div>`在本例中为 s ）集合：

```
for (var menuItemIndex = 0 ; menuItemIndex < menuItems.length ; menuItemIndex ++) {
   var currentMenuItem = menuItems[menuItemIndex];
   // do stuff with currentMenuItem as a node.
} 
```

有关元素和节点之间差异的更多信息，请参阅[这篇文章。](https://stackoverflow.com/questions/9979172/difference-between-node-object-and-element-object)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-10-23T11:41:11.960

**换句话说**

*   `document.querySelector()`仅选择指定选择器的第**一个**元素。所以它不会吐出一个数组，它是一个单一的值。与`document.getElementById()`仅获取 ID 元素类似，因为 ID 必须是唯一的。

*   `document.querySelectorAll()`选择具有指定选择器的**所有**元素并将它们返回到一个数组中。`document.getElementsByClassName()`仅与类和`document.getElementsByTagName()`标签类似。

**为什么使用查询选择器？**

它仅用于方便和简洁的唯一目的。

**为什么使用 getElement/sBy？***

更快的性能。

**为什么会有这种性能差异？**

两种选择方式的目的都是创建一个**NodeList**以供进一步使用。 **querySelectors**使用选择器生成一个静态 NodeList，因此它必须首先从头开始创建。
**getElement/sBy***立即适应当前 DOM 的现有活动 NodeList。

因此，何时使用哪种方法取决于您/您的项目/您的设备。

**信息**

[所有方法的演示](https://jsfiddle.net/Thielicious/teu8nbd4/)
[NodeList 文档](https://developer.mozilla.org/en-US/docs/Web/API/NodeList)
[性能测试](https://jsperf.com/different-types-of-selecting)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-07-02T19:29:34.480

您可以通过运行获得单个元素

```
document.querySelector('.myElement').style.size = '100px'; 
```

但它适用于类 .myElement 的第一个元素。

如果您想将此应用于该类的所有元素，我建议您使用

```
document.querySelectorAll('.myElement').forEach(function(element) {
    element.style.size = '100px';
}); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-06-17T03:21:49.110

它返回类似数组的列表。

**你把它作为一个数组作为例子**

```
var el = getElementsByClassName("elem");
el = Array.prototype.slice.call(el); //this line
el[0].appendChild(otherElem); 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-11-25T04:06:32.877

```
/*
 * To hide all elements with the same class, 
 * use looping to reach each element with that class. 
 * In this case, looping is done recursively
 */

const hideAll = (className, i=0) => {
if(!document.getElementsByClassName(className)[i]){ //exits the loop when element of that id does not exist
  return; 
}

document.getElementsByClassName(className)[i].style.visibility = 'hidden'; //hide element
return hideAll(className, i+1) //loop for the next element
}

hideAll('appBanner') //the function call requires the class name 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-04-20T16:03:36.127

对于任何支持 ES5+ 的浏览器（任何基本上 IE8 以上的浏览器），您都可以使用该`Array.prototype.forEach`方法。

```
Array.prototype.forEach.call(document.getElementsByClassName('answer'), function(el) {
    el.style.color= 'red';
});
```

[犬源](https://caniuse.com/mdn-javascript_builtins_array_foreach)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-12-15T21:32:22.190

超级老派解决方案：

```
 [].forEach.call(document.getElementsByClassName('myClass'), function (el) {
            el.style.size = '100px';
        }); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-12-25T18:47:54.927

所以我被告知这是我的问题的重复，我应该删除我的，我会这样做，这样我可以保持论坛的清洁并保留提出问题的权利。

由于我认为我的问题和这个问题真的不同，所以我会指出我的答案，所以我会在这个页面完成知识并且信息不会丢失。

**问题**

1.  我在片段中有一个代码，它在`document.getElementsByClassName("close")[0]`做`[0]`什么？

2.  我从未见过方括号`getElementsByClassName`用于什么目的？

3.  另外，如何将其转换为 jQuery？

**回答**

1.  片段中的代码有一个`[0]`它实际上被用作一个数组，因为它是一个 0，它指的是第一次使用指定的类。

2.  同上。

3.  我真的做不到，也没有人回答。在引用的代码部分`event. target`我不能使用`$("#myModal")`代替`document.getElementById("myModal")`，我认为它们应该是等效的，但是在这种情况下，替换标准形式的 jQuery 形式不会产生预期的效果。

```
 window.onclick = function(event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    } 
```

```
var modal = document.getElementById("myModal");
var btn = document.getElementById("myBtn");
var span = document.getElementsByClassName("close")[0];

btn.onclick = function() {
  modal.style.display = "block";
}
span.onclick = function() {
  modal.style.display = "none";
}
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
```

```
body {font-family: Arial, Helvetica, sans-serif;}

.modal {
  display: none;
  position: fixed;
  z-index: 1;
  padding-top: 100px;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgb(0,0,0);
  background-color: rgba(0,0,0,0.4);
}

.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
```

```
<h2>Modal </h2>

<button id="myBtn">Open Modal</button>

<div id="myModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <p>Some text in the Modal..</p>
  </div>
</div>
```

**更新**

看来我真的不能删除我的问题，人们对此不满意，我真的不知道我该怎么办。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2020-07-11T01:18:04.083

**Drenzii具体案例**的答案......

您可以创建**一个适用于任何`word`元素**的函数，并传入要转换的元素的编号，例如：

```
// Binds `wordButtons` to an (array-like) HTMLCollection of buttons
const wordButtons = document.getElementsByClassName("word");

// Applies the `slantWord` function to the first word button
slantWord(1);

// Defines the `slantWord` function
function slantWord(wordNumber) {
  const index = wordNumber - 1; // Collection index is zero-based
  wordButtons[index].style.transform = "rotate(7deg)"; // Transforms the specified button
}
```

```
<div class="wordGameContainer">
  <button class="word word1">WORD 1</button>
  <button class="word word2">WORD 2</button>
  <button class="word word3">WORD 3</button>
  <button class="word word4">WORD 4</button>
</div>

<div>
  <button onclick="moveWord()" class="playButton">PLAY</button>
</div>
```

# php - 从我的表单收到的电子邮件显示我的主机

> ID：10693846
> 
> 赞同：1
> 
> 时间：2012-05-21T23:17:21.900
> 
> 标签：php, forms, wordpress, email, contact

我在我的 WP 3.1 安装中有这个小猪设置，它应该是一个很好的联系表格。

问题是当我收到电子邮件时，它会显示我的虚拟主机服务器名称而不是“myemail@mydomain.com”。

有什么办法可以纠正吗？还有一个“向我发送副本”功能，我想将其用作密件抄送，以保持事情清洁。先感谢您！

这是我的 sendmail.php"

```
require_once("../../../../wp-load.php");

$mail = addslashes($_POST["mailForm"]);
$mail = nl2br($mail);

$from_mail = addslashes($_POST['from_mail']);

$to = wpts_get_option("general", "contact_email");

/* subject */
$subject = "New Contact Message - ATOM";

/* message */
$message = $mail;

/* To send HTML mail, you can set the Content-type header. */
$headers = "MIME-Version: 1.0\r\n";
$headers .= "Content-type: text/html; charset=iso-8859-1\r\n";

/* and now mail it */
if(@mail($to, $subject, $message, $headers))
{
?>
    <div class="success">
    <div class="box-content"><?php _e("Done! We'll contact you in few moments!", 'atom'); ?></div>
    <div class="clearboth"></div>
    </div>
<?php
}
else
{
?>
    <div class="error">
    <div class="box-content"><?php _e("Oh, sorry! Something wrong... Please, try again.", 'atom');?></div>
    <div class="clearboth"></div>
    </div>
<?php
} 
```

?> “这是我的 sendorder.php”

```
require_once("../../../../wp-load.php");

$myemail = wpts_get_option("ordernow", "order_email");

$name = addslashes($_POST["name"]);
if($name == '') {
?>
    <div class="error">
    <div class="box-content"><?php _e("Please insert your name.", 'atom'); ?></div>
    <div class="clearboth"></div>
    </div>
<?php
exit;
}

$email = addslashes($_POST["email"]);
if($email == '') {
?>
    <div class="error">
    <div class="box-content"><?php _e("Please insert a email address.", 'atom'); ?></div>
    <div class="clearboth"></div>
    </div>
<?php
exit;
}

$finalOrder = nl2br( addslashes($_POST["finalOrder"]) );

$uploads = addslashes($_POST["uploads"]);

$files = explode(";", $uploads);
$uploads = '';

for($i = 0; $i < count($files); $i++) {
    $uploads .= '- <a href="'.$files[$i].'" target="_blank">'.$files[$i].'</a><br />';
}

$message = str_replace("uploads_here", $uploads, $finalOrder);

/* subject */
$subject = "New Order/Quote Request";

/* To send HTML mail, you can set the Content-type header. */
$headers = "MIME-Version: 1.0\r\n";
$headers .= "Content-type: text/html; charset=iso-8859-1\r\n";

$to = $myemail.','.$email;

/* and now mail it */
if(@mail($to, $subject, $message, $headers))
{
?>
    <div class="success">
    <div class="box-content"><?php _e("Done! You'll receive a order copy in your email.", 'atom'); ?></div>
    <div class="clearboth"></div>
    </div>
<?php
}
else
{
?>
    <div class="error">
    <div class="box-content"><?php _e("Oh, sorry! Something wrong... Please, try again.", 'atom');?></div>
    <div class="clearboth"></div>
    </div>
<?php
} 
```

?> "

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T00:00:25.557

我遇到了同样的问题。它出现在我的 [login_name]@[mysever] 中。

尝试调整标题。

我从[http://php.net/manual/en/function.mail.php](http://php.net/manual/en/function.mail.php)中提取了这个：

```
$headers .= 'To: Mary <mary@example.com>, Kelly <kelly@example.com>' . "\r\n";
$headers .= 'From: Birthday Reminder <birthday@example.com>' . "\r\n";
$headers .= 'Cc: birthdayarchive@example.com' . "\r\n";
$headers .= 'Bcc: birthdaycheck@example.com' . "\r\n"; 
```

希望这是您所需要的。

# jquery-plugins - Colorbox 插件无边框视图

> ID：10693847
> 
> 赞同：1
> 
> 时间：2012-05-21T23:17:23.937
> 
> 标签：jquery-plugins, colorbox

我需要使用模态插件，颜色框看起来很棒。

如何在不带圆形边框的情况下加载它？

鉴于我的页面大小，粗边框占用了太多空间。

无论如何隐藏它或使其更薄并在某些呼叫需要时隐藏边框？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-07-27T07:47:22.373

您可以以简单的方式隐藏边框：

```
 $("#cboxTopLeft").hide();
            $("#cboxTopRight").hide();
            $("#cboxBottomLeft").hide();
            $("#cboxBottomRight").hide();
            $("#cboxMiddleLeft").hide();
            $("#cboxMiddleRight").hide();
            $("#cboxTopCenter").hide();
            $("#cboxBottomCenter").hide(); 
```

如果你想用这种方式添加带有边框样式的类：

```
.thin_border {
    border: 10px solid blue;
    border-radius: 10px;
    margin: 10px;
    box-shadow: 0 0 25px blue;
} 
```

然后用jquery添加它

```
$("#cboxContent").addClass("thin_border"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:45:03.570

我认为colorbox实际上并没有使用属性“border”来获得巨大的黑色边框。似乎它被装在一个 3 x 3 div 中，它使用图像来创建该边框。我确定你可以删除它，但它需要弄乱实际的彩盒 javascript。您也可以尝试弄乱 CSS。

您考虑寻找不同的插件，如 lightbox2 或 shadowbox？我个人使用 slimbox（灯箱的漂亮小克隆）。如果您想弄乱代码，那就去吧。否则我只会选择一个不同的插件。

# c# - 在 C# 脚本中获取和使用当前目录

> ID：10693848
> 
> 赞同：-1
> 
> 时间：2012-05-21T23:17:27.313
> 
> 标签：c#

这只是一个示例，但它有助于说明我正在尝试做的事情。

我知道如何获取当前目录，如下面的脚本所示，我可以设置一个文件`variable`。

我遇到的问题是我不知道如何让它创建一个文件夹并将文件放在文件夹中

例如（使用下面的变量）

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            var cd = Directory.GetCurrentDirectory();
            Directory.CreateDirectory(cd: \5app\);
            File.Copy(c:\xyz.txt, cd: \5app\xyz.txt

        }
    }
} 
```

我知道我上面写的不正确，因为 vs10 告诉我是这样，但并没有给我太多帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T23:23:04.767

您缺少括号和分号，尤其是方法的参数`Directory.CreateDirectory()`和`File.Copy()`字符串，请将它们放在引号内：

```
namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            var cd = Directory.GetCurrentDirectory();
            Directory.CreateDirectory(cd + @"\5app\");
            File.Copy(@"c:\xyz.txt", cd + @"\5app\xyz.txt");
        }
    }
} 
```

MSDN 参考：[Directory.CreateDirectory](http://msdn.microsoft.com/en-us/library/54a0at6s(v=vs.100).aspx)，[File.Copy](http://msdn.microsoft.com/en-us/library/system.io.file.copy(v=vs.100).aspx)

感谢**[Cole Johnson](https://stackoverflow.com/users/1350209/cole-johnson)**指出不应该这样`@"cd: \5app\"`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T23:21:21.017

你不使用引号。

此外，我建议不要使用显式参数命名。如果您查看使用显式参数时生成的 CIL，就会发现性能下降，因为参数变量被保存到局部变量，然后通过。这会导致不需要的`strfld`命令。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T23:27:30.693

您的代码存在几个问题，编译器错误可能会帮助您解决这些问题：

该方法`Directory.CreateDirectory(string path)`需要一个字符串，该字符串包含在“”中。这是一篇关于如何使用[Directory.CreateDirectory的 MSDN 文章](http://msdn.microsoft.com/en-us/library/system.io.directory.createdirectory%28v=vs.71%29.aspx)

方法相同`File.Copy(string source, string destination)` 这里是一篇关于如何使用[File.Copy的 MSDN 文章](http://msdn.microsoft.com/en-us/library/system.io.file.copy%28v=vs.71%29.aspx)

由于 Directory.GetDirectory() 返回一个字符串，您可以将您的特定目录连接到结果。但请记住在您的字符串中使用适当的[转义序列](http://msdn.microsoft.com/en-us/library/h21280bw.aspx)来处理诸如*反斜杠*之类的内容。

```
namespace ConsoleApplication1 
{ 
    class Program 
    { 
        static void Main(string[] args) 
        { 
            string cd = Directory.GetCurrentDirectory(); 
            Directory.CreateDirectory(cd + "\\5app\\"); 
            File.Copy("c:\\xyz.txt", cd + "\\5app\\xyz.txt");
        } 
    } 
} 
```

# c# - 线程：不正确的变量传递 C#

> ID：10693853
> 
> 赞同：2
> 
> 时间：2012-05-21T23:18:27.387
> 
> 标签：c#, multithreading, variables

用户。我遇到了一个我找不到答案的问题。我对线程（在 C# 中）有点陌生，遇到了这个问题。我有这个带效果的图像编辑器，但由于运行速度太慢，我尝试将其拆分为线程。问题是他总是使用效果列表中的最后一项来运行“CreatePreview”命令。因此，如果我激活了效果：“黑/白”、“饱和”和“绿色滤镜”，它将尝试使用绿色滤镜创建 3 个预览。

谁能帮我解决这个问题？

```
private void CreatePreviews(string fileName, List<IEffect> effects)
{
    List<Task> tasks = new List<Task>();
    foreach (var effect in effects)
    {
        //previews.Add(effect, CreatePreview(fileName, effect));
        Task task = new Task(delegate()
        {
            string result = CreatePreview(fileName, effect);
            Dispatcher.BeginInvoke(new Action(
            delegate()
            {
                ShowPreview(result, effect.DisplayName);
            }));

        });
        task.Start();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T23:25:24.000

我现在无法测试，但我很确定你的问题是你正在[关闭循环变量](http://blogs.msdn.com/b/ericlippert/archive/2009/11/12/closing-over-the-loop-variable-considered-harmful.aspx)。

获取循环变量的副本并关闭它：

```
foreach (var effect in effects)
{
    var effectCopy = effect;

    //previews.Add(effectCopy, CreatePreview(fileName, effectCopy));
    Task task = new Task(delegate()
    {
        string result = CreatePreview(fileName, effectCopy);
        Dispatcher.BeginInvoke(new Action(delegate()
        {
            ShowPreview(result, effectCopy.DisplayName);
        }));
    });

    task.Start();
} 
```

（或者等待 C#5，它会在每次迭代时自动关闭变量的新副本。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T23:29:42.890

您的委托需要创建 effect 值的本地副本，以便在实际评估它时的值不会因为循环迭代器在线程实际评估效果之前将所有更改排队而改变。

```
foreach(var effect in effects)
{
    var localEffect = effect;
    var task = new Task(()=>
        {
            var result = CreatePreview(fileName, localEffect);
            Dispatcher.BeginInvoke(()=> ShowPreview(result, localEffect.DisplayName));
        });
    task.Start();
} 
```

这将强制各个线程正确关闭效果的创建时间值。这是由于匿名委托在后台创建隐藏类的方式。

请参阅这篇文章，了解为什么您创建的内容并没有完全创建词法闭包，但是通过将效果复制到 localEffect 它将... [匿名方法文章。](http://blogs.msdn.com/b/abhinaba/archive/2005/10/18/482180.aspx%20Anonymous%20method%20discussion.)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T23:24:39.360

您必须将当前保存`effect`到循环内的变量中，以防止访问委托中修改后的闭包，这意味着所有委托都访问循环变量，该变量最终具有您循环的最后一个元素的值，并且因此所有任务都以最后一个效果运行。为了防止这种情况：

```
private void CreatePreviews(string fileName, List<IEffect> effects)
{
    List<Task> tasks = new List<Task>();

    foreach (var effect in effects)
    {
        var mcEffect = effect;

        Task task = new Task(delegate()
            {
                string result = CreatePreview(fileName, mcEffect);
                Dispatcher.BeginInvoke(new Action(
                delegate()
                {
                    ShowPreview(result, effect.DisplayName);
                }));
            });

        task.Start();
    }
} 
```

`mc`我喜欢给注释修改后的闭包添加前缀。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T23:28:16.577

多线程是一个相当复杂的事情，有很多潜在的问题。

一定要读一两篇关于任务并行库（或一本书）的文章。

使用 TPL 的可能更正确的版本如下所示：

```
Parallel.ForEach(effects, currentEffect =>
{
    string result = CreatePreview(fileName, currentEffect );
    ShowPreview(result, effect.DisplayName);
} 
```

PS。请记住，在这种情况下，最佳实践是实际并行化每个过滤操作（或者甚至更好地将其卸载到 GPU）。

# c++ - 未在此范围内使用友好函数声明

> ID：10693854
> 
> 赞同：0
> 
> 时间：2012-05-21T23:18:30.997
> 
> 标签：c++, qt, function, declare

我不确定为什么会发生这种情况，但似乎它错误地抛出了“未在此范围内声明”错误。我这样说是因为它适用于我的 Windows 计算机（MSVC 编译器），但它不适用于我的 Mac（GCC）。我正在使用 Qt Creator 来编写这个。这是我的情况：

它在我的 pushButtonClicked 上引发错误...

```
void NewGpdDialog::on_pushButton_clicked()
{
    *xdbf = XDBFcreate(filePath.toStdString(), Achievement, ba.data(), ba.size(), &str);
} 
```

它抛出的确切错误是：

> .../newgpddialog.cpp:63：错误：未在此范围内声明“XDBFcreate”

我几乎肯定它已被标定，因为在我的文件顶部我包括：

```
#include "newgpddialog.h"
#include "ui_newgpddialog.h"
#include "xdbf.h"
#include <QDesktopServices>
#include <QBuffer>
#include <QFileDialog>
#include <QMessageBox> 
```

“xdbf.h”是它被声明的地方......这是我的 XDBF 头文件的一部分：

```
class XDBF
{
public:
    XDBF(string path);
    ~XDBF();

    ...

    static std::string FILETIME_to_string(FILETIME *pft);
    friend XDBF* XDBFcreate(string filePath, GPD_Type type, char *imageData = NULL, size_t imageDataLen = 0, wstring *gameName = NULL); 
```

我现在将它放在我的“xdbf.cpp”文件中，如下所示：

```
XDBF* XDBFcreate(string filePath, GPD_Type type, char *imageData, size_t imageDataLen, wstring *gameName)
{
    ...
} 
```

另外，有趣的是，如果我在标题中右键单击它，然后单击“跟随光标下的符号”，它就找不到它...另一件事是，请记住，这适用于我的 Windows 计算机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:31:46.400

友元声明不作为完整的函数声明。

您需要为 XDBFcreate 单独声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T00:25:14.097

仅声明为友元的函数，未使用单独的命名空间范围声明进行声明，只能通过 Argument-Dependent Lookup 找到。您的调用`XDBFcreate`不涉及类型参数，`XDBF`因此在该类中声明的友元函数无法通过名称查找找到。

`XDBFcreate`要修复代码，请在声明之前添加一个命名空间范围声明`XDBF`

# c# - 如何判断 Crystal Report 何时加载

> ID：10693855
> 
> 赞同：1
> 
> 时间：2012-05-21T23:18:32.757
> 
> 标签：c#, crystal-reports, .net

我正在构建一个使用 Crystal Reports 的 Winforms C# 应用程序。

我正在加载一个虚拟报表，以便在用户打开报表时加载 Crystal Reports 组件。我这样做是因为第一次加载报告需要很长时间。

我打开一个最小化的 0% 不透明度表单，其中包含来自后台工作人员的虚拟报告。我需要知道报表何时完全加载，以便我知道何时关闭表单。我没有设法在网上找到答案，所以我的问题是：

**如何以编程方式告诉 Crystal Report 何时完成加载？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T14:52:29.697

我认为水晶报告中对此没有任何官方规定，因此我建议使用回调和 YourDummyReport.IsLoaded 属性来解决此问题。希望能帮助到你

# hibernate - 在 JSF 表单中列出对象时出现 LazyInitializationException

> ID：10693856
> 
> 赞同：0
> 
> 时间：2012-05-21T23:18:35.637
> 
> 标签：hibernate, jsf-2, ejb-3.0, jpa-2.0

我正在开发一个使用 JBoss 6.1.0.Final、JSF 2.0.3、EJB3 和 JPA 2 + Hibernate 3.3 的项目。

一个 JSF 页面显示了一个输入实体 A 数据的表单，同时它还有一个与该实体 A 关联的 B、C 和 D 实体列表。其中一个列表在加载表单时显示，其中一个是一个抛出 LazyInitializationException 因为没有会话或会话已关闭。

经过一些 SO & Google 浏览后，我尝试了一些答案，以及将 EntityManager 保留在视图中的模式，但这些都不够。Spring 有一个 org.springframework.orm.jpa.support.OpenEntityManagerInViewInterceptor 似乎可以处理这种情况 AFAIK 但我可能是错的。

执行访问列表的任何方法时都会引发异常：

```
IA entityA = business.getListOfAs();// In AListBean 
```

然后，在我做的表格上：

```
entityA.getListofB(); //LazyInitializationException 
```

获取 A 记录后，我不会立即访问列表，中间有一些导航导致会话在我获取 B 项目列表之前关闭。

重新附加 A 的分离实例可以解决问题，但我不知道如何在不合并对象（保留对其所做的任何更改）并将获取类型设置为*渴望*的情况下做到这一点。

是否有任何方法可以以惰性方法访问 A 中的 B、C 和 D 实体列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T00:38:47.230

如果 A 与其 Session 分离，您可以单独加载 B 集合，如果您不想重新附加它，则可以通过其 Setter 设置它。

在使用 gui 事件访问它之前，单独加载集合并通过 setter 设置它。

使用 HQL 或标准 API 将集合加载到 EJB 中，例如：

```
public List<B> getBsByA(int aId); 
```

在 JSF 托管 bean 中，使用属性和连接到 gui 事件的更新方法，例如：

```
private A selectedA;
//Directly setting collection in selectedA should make this obsolete.
private List<B> bsOfSelA;

public void updateBsOfSelectedA()
{
    this.bsOfSelA = business.getBsByA(this.selectedA.getId())
    //this.selA.setBs(business.getBsByA(this.selectedA.getId()))
} 
```

# vba - 使用 VBA 防止 Word 中的图像打印 .doc

> ID：10693859
> 
> 赞同：0
> 
> 时间：2012-05-21T23:19:24.097
> 
> 标签：vba, ms-word

我设置了一份背景为 8.5 x 11 图像的简历（如果需要，可以将其设置为水印）。现在我想设置它，这样它就不会自动打印背景图像，这样雇主就不必费劲了。在网上查看后，我注意到这可能是必须使用 VBA 和模板设置的东西。任何现场或任何愿意解决这个问题的人都将不胜感激。

几乎我只是希望我的 Word 文档不打印图像或水印，而无需让打印它的人进行任何设置。（不必两者兼而有之）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:57:40.517

你真的需要VBA吗？

要在 Word 2010 中禁用背景颜色和图像的打印，只需按照以下步骤操作

点击文件 | 选项

您将获得一个“字选项”对话框。

在显示选项卡下，只需取消选中“打印背景颜色和图像”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T23:19:05.060

不知道为什么，但这似乎可以正常工作。

```
Public WithEvents appWord As Word.Application

Private Sub Document_Open()
    Set appWord = Application
    ' Not sure if your image is a shape or inlineshape, so...
    If ThisDocument.Shapes.Count Then
        ' First Shape is now visible
        ThisDocument.Shapes(1).Visible = msoTrue
    ElseIf ThisDocument.InlineShapes.Count Then
        ' First inlineshpae has medium brightness
        ThisDocument.InlineShapes.Item(1).PictureFormat.Brightness = 0.5
    End If
End Sub

Private Sub appWord_DocumentBeforePrint(ByVal Doc As Document, Cancel As Boolean)

 Dim intResponse As Integer

 intResponse = MsgBox("This document contains a background image. " & _
    "Would you like to hide it before printing?", vbYesNo, _
    "Hide Background Image?")
     If intResponse = vbYes Then
         hide_images

     ElseIf intResponse = vbNo Then

        show_images
     End If
End Sub

Sub hide_images()

    Application.DisplayStatusBar = True
    With ActiveWindow
        .DisplayHorizontalScrollBar = True
        .DisplayVerticalScrollBar = True
        .DisplayLeftScrollBar = False
        .StyleAreaWidth = CentimetersToPoints(0)
        .DisplayVerticalRuler = True
        .DisplayRightRuler = False
        .DisplayScreenTips = True
        With .View
            .ShowAnimation = True
            .Draft = False
            .WrapToWindow = False
            .ShowPicturePlaceHolders = False
            .ShowFieldCodes = False
            .ShowBookmarks = False
            .FieldShading = wdFieldShadingWhenSelected
            .ShowTabs = False
            .ShowSpaces = False
            .ShowParagraphs = False
            .ShowHyphens = False
            .ShowHiddenText = False
            .ShowAll = True
            .ShowDrawings = True
            .ShowObjectAnchors = False
            .ShowTextBoundaries = False
            .ShowHighlight = True
        End With
    End With
    With Options
        .UpdateFieldsAtPrint = False
        .UpdateLinksAtPrint = False
        .DefaultTray = "Druckereinstellungen verwenden"
        .PrintBackground = True
        .PrintProperties = False
        .PrintFieldCodes = False
        .PrintComments = False
        .PrintHiddenText = False
        .PrintDrawingObjects = False
        .PrintDraft = False
        .PrintReverse = False
        .MapPaperSize = True
    End With
    With ActiveDocument
        .PrintPostScriptOverText = False
        .PrintFormsData = False
    End With
End Sub

Sub show_images()

    With Options
        .UpdateFieldsAtPrint = False
        .UpdateLinksAtPrint = False
        .DefaultTray = "Druckereinstellungen verwenden"
        .PrintBackground = True
        .PrintProperties = False
        .PrintFieldCodes = False
        .PrintComments = False
        .PrintHiddenText = False
        .PrintDrawingObjects = True
        .PrintDraft = False
        .PrintReverse = False
        .MapPaperSize = True
    End With
    With ActiveDocument
        .PrintPostScriptOverText = False
        .PrintFormsData = False
    End With
End Sub 
```

干杯马丁

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T16:24:26.037

我使用以下（简短）过程作为功能区扩展，用于在文档标题中显示/隐藏徽标，以便用户可以在创建打印/pdf 之前进行切换。

```
Sub ShowHideLogoInHeader 
```

本地错误处理程序（非关键）

```
On Local Error GoTo ErrHandler 
```

昏暗的形状范围

```
Dim myStory As ShapeRange
Set myStory = ActiveDocument.StoryRanges(wdFirstPageHeaderStory).ShapeRange
myStory.Visible = Not myStory.Visible

Exit Sub 
```

ErrHandler：debug中报错（单独函数）

```
ReportError "modRibbon - ToonOfVerbergLogo"
Err.Clear
End Sub 
```

# excel - Excel vba使用ADO获取结果集到listobject

> ID：10693867
> 
> 赞同：0
> 
> 时间：2012-05-21T23:20:08.747
> 
> 标签：excel, vba

您好，我在行中收到错误 [Runtime Error '448': Named argument not found]

```
Set qt = ThisWorkbook.Sheets(server_hostname).ListObjects.Add(Connection:=oRS, _
Destination:=ThisWorkbook.Sheets(server_hostname).Range("A1")).QueryTable 
```

完整的源代码如下，

```
Sub getavgcpu(server_hostname)

Dim oCn As ADODB.Connection
Dim oRS As ADODB.Recordset
Dim ConnString As String
Dim SQL As String

Dim qt As QueryTable
ThisWorkbook.Sheets(server_hostname).Activate

ConnString = "Driver={MySQL ODBC 5.1 Driver};Server=localhost; _
Database=test; User=root;Password=123456;Option=3;"
Set oCn = New ADODB.Connection
oCn.ConnectionString = ConnString
oCn.Open

SQL = "SELECT cpu_max_unix_0.LOGDATE as 'Date of Month', cpu_max_unix_0.CPU as 'CPU   Utilization %' FROM test.cpu_max_unix cpu_max_unix_0 where (cpu_max_unix_0.LOGDATE between '" & fromDateStr & "' and '" & toDateStr & "') And  (cpu_max_unix_0.SERVER_NAME='" & server_hostname & "') Order By cpu_max_unix_0.LOGDATE"

Set oRS = New ADODB.Recordset
oRS.Source = SQL
oRS.ActiveConnection = oCn
oRS.Open

'Set qt = ThisWorkbook.Sheets(server_hostname).QueryTables.Add(Connection:=oRS, _
'Destination:=ThisWorkbook.Sheets(server_hostname).Range("A1"))

Set qt = ThisWorkbook.Sheets(server_hostname).ListObjects.Add(Connection:=oRS, _
Destination:=ThisWorkbook.Sheets(server_hostname).Range("A1")).QueryTable

qt.Refresh

If oRS.State <> adStateClosed Then
oRS.Close
End If

If Not oRS Is Nothing Then Set oRS = Nothing
If Not oCn Is Nothing Then Set oCn = Nothing

End Sub 
```

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T00:15:25.793

I tried your code with the first argument(SourceType) as following:

```
Set qt = ThisWorkbook.Sheets(server_hostname).ListObjects.Add( _
    SourceType:=XlListObjectSourceType.xlSrcQuery, _
        Source:=oRS, _
            Destination:=ThisWorkbook.Sheets(server_hostname).Range("A1")).QueryTable 
```

and it works well.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:40:16.947

**未经测试**

尝试这个

```
Dim ws As Worksheet

'
'~~> Rest of the code
'

Set ws = ThisWorkbook.Sheets(server_hostname)

Set objListObject = ws.ListObjects.Add(SourceType:=xlSrcExternal, Source:=oRS, _
LinkSource:=True, TableStyleName:=xlGuess, Destination:=ws.Range("A1"))

'
'~~> Rest of the code
' 
```

另请参阅 MS 的此链接

**主题：ListObjects.Add 方法 (Excel)**

**链接**：http: [//msdn.microsoft.com/en-us/library/ff823155.aspx](http://msdn.microsoft.com/en-us/library/ff823155.aspx)

# mercurial - 从 Mercurial 迁移到 TFS 的工具

> ID：10693868
> 
> 赞同：1
> 
> 时间：2012-05-21T23:20:10.993
> 
> 标签：mercurial, tfs

> **可能重复：**
> [如何将 Mercurial (Hg) 源代码存储库迁移到 TFS？](https://stackoverflow.com/questions/8567038/how-do-i-migrate-a-mercurial-hg-source-code-repository-to-tfs)

是否有将具有历史记录的源代码从 Mercurial 迁移到[TFS](http://en.wikipedia.org/wiki/Team_Foundation_Server)的工具？

# machine-learning - 由神经网络训练的神经机器人可以用于以下目的吗？

> ID：10693869
> 
> 赞同：2
> 
> 时间：2012-05-21T23:20:28.773
> 
> 标签：machine-learning, web-crawler, neural-network, genetic-algorithm, information-retrieval

嘿，我有一个任务要执行，基本上就是以某种方式检索与某个领域有关的 powerpoint 演示文稿或 pdf 文档。假设我想检索与生物信息学领域有关的 ppt 和 pdf 讲义。我想知道这项任务是否可以通过调整使用由神经网络训练的神经机器人的方法来完成？在我进一步实施之前，只是想确认这种方法并非完全错误。

如果有人想知道为什么在这种情况下需要神经网络或任何学习算法，这就是我的计划（这可能是错误的，或者可能有更简单的方法来实现这一点，所以请随时纠正我）：

我生成由神经网络训练的神经机器人（尚不确定这种训练是如何发生的，我假设通过使用某些 ppt 和 pdf 文件的样本训练集进行监督学习），然后这些机器人检索与他们通过学习相似的页面他们的训练。

那么上述方法是完成这项任务的正确方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T00:11:40.007

神经网络很复杂。看起来你有一个通用的文档分类问题。最简单的起点是使用某种带有词袋特征的朴素贝叶斯模型。我将从那里采取的下一步是在同一特征集上使用线性 SVM 或逻辑回归。如果在尝试了更简单的事情之后仍然没有得到想要的性能，那么也许可以继续尝试使用神经网络。

就像你不会说的那样，我想写一个电子邮件服务器，我将从写一个操作系统开始，在更简单的事情失败之前，我倾向于对使用神经网络持谨慎态度。

# c# - mvvm中的对象关系映射和数据访问层有什么区别？

> ID：10693872
> 
> 赞同：0
> 
> 时间：2012-05-21T23:20:44.077
> 
> 标签：c#, mvvm

在我的 mvvm 项目中，有一个包含添加、更新、删除接口的接口。因此接口是数据访问层。其代码是：

```
public interface IAccountDataSource
{
    bool Add(Account account);
    bool Update(Account account);
    bool Remove(Account account);

    Account GetById(int id);
    Account GetByName(string name);
    IEnumerable<Account> GetByCategory(AccountCategory accountCategory);
    IEnumerable<Account> GetBySearchTerm(string searchTerm);
    IEnumerable<Account> GetAll();

    event EventHandler<ObjectAddedEventArgs> AccountAdded;
    event EventHandler<ObjectUpdatedEventArgs> AccountUpdated;
    event EventHandler<ObjectRemovedEventArgs> AccountRemoved;
}
enter code here 
```

任何人都可以说数据访问层是否意味着 ORM。数据访问层的优势是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:24:59.867

不，你在这里展示的是某种[Repository](http://martinfowler.com/eaaCatalog/repository.html)。存储库通常（但不总是）与 ORM（对象关系映射器）对话，后者将对象转换为 SQL 查询（反之亦然）。

至于优点是什么：

现在您只通过数据访问层查询数据库，您可以通过模拟或存根对象替换该层（通过实现/模拟其接口）以进行单元测试。通过这种方式，您无需在数据库中实际编写任何内容即可执行测试，因为您的存根/模拟实际上并没有做任何事情。另一个优点是更容易将数据源替换为另一个数据源（即从关系数据库迁移到 NoSQL），因为您所有的数据访问代码都在一个地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:29:55.187

数据访问层允许您抽象出如何访问数据的实现，并且会根据数据的存储位置（即：数据库、文件系统等）而有所不同。

如果您希望将存储在数据库中的数据映射到某种对象集，则可以使用 ORM（对象关系映射器）来实现数据访问层。

话虽如此，您的界面看起来像是在执行存储库模式方法。

# php - PHP 显示源代码而不是 .html 文件

> ID：10693873
> 
> 赞同：1
> 
> 时间：2012-05-21T23:20:48.320
> 
> 标签：php

如果标题有点混乱，我很抱歉，但这是我的问题：
我需要使用 PHP 回显 .html 文件的源代码。我尝试使用 PHP include(); 虽然文件的扩展名是 .html.txt，但它显示为好像是 . 当我直接访问文件时，例如“example.com/file.html.txt”，它显示为普通的 .txt。
这是我用来显示文件的 PHP 代码：

```
<div>
<?php
include "../head.php";
$path = $_GET["p"];
?>
<div style="position:absolute; top:90px; padding-left:5px; padding-right:10px;">

<?php
echo "<code>";
include("files/".$path);
echo "</code>";
?>

</div> 
```

我希望我可以理解！：） 在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T23:25:28.603

不要使用`include()`，读取文件的内容并打印它们（不要忘记转义）。

在您的情况下`$path`是用户输入，您应该确保不能访问敏感信息。使用[`basename($path);`](http://php.net/basename)确保没有目录遍历是可能的。

```
<code>
<?php
    // $path = basename($path);
    $html = file_get_contents("files/".$path);
    echo htmlspecialchars($html);
?>
</code> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T23:22:36.937

如果要在 html 文件中输出 HTML 标签，请使用`htmlspecialchars()`转义特殊字符。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-21T23:32:18.333

我建议将其包装在**textarea**中。简单快捷。

```
echo "<textarea>";
include "/filename.txt";
echo "</textarea>"; 
```

有时，当我们在寻找非常简单的东西时，我们会忽略显而易见的东西。**:o)**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-21T23:25:34.820

如果您希望能够在浏览器中查看 html 源代码，最好的方法是通过函数 htmlentities() 或类似函数运行它。棘手的部分是将包含的文件内容放入一个字符串中，以便您可以做到这一点。为此，我们使用 ob_start() 和 ob_get_clean()。这些基本上启动了一个输出缓冲区，然后获取输出缓冲区的内容，以便您可以处理它并回显它。

```
<div>
<?php
include "../head.php";
$path = $_GET["p"];
?>
<div style="position:absolute; top:90px; padding-left:5px; padding-right:10px;">

<?php
echo "<code>";
ob_start();
include("files/".$path);
echo htmlentities(ob_get_clean());
echo "</code>";
?>

</div> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-21T23:26:48.057

包含不安全。如果您的文件有 PHP 代码，它将被执行。你应该使用这个：

```
echo htmlspecialchars(file_get_contents('yourfile.html')); 
```

# delphi - Delphi 存储库中对象的默认/受限行为

> ID：10693878
> 
> 赞同：2
> 
> 时间：2012-05-21T23:21:36.073
> 
> 标签：delphi, repository, delphi-xe2

我在存储库中有一些代码（表单/框架），无论如何都可以禁用“使用”选项。我只希望“继承”或复制存储库中的对象。

有没有办法将默认设置为“继承”

查看了 RADStudioRepository.xml 中的 XML，没有明显的字段可以添加/编辑。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T03:37:23.520

确实从来没有一种方法可以在对象存储库中将表单或框架指定为“仅继承”。

不是以当前 RADStudioRepository.xml 指定对象存储库中的内容的方式，也不是以旧方式（我在 Delphi 2..7 天忘记了配置名称）。

[您可以在http://qc.embarcadero.com](http://qc.embarcadero.com)上建议将此作为未来 Delphi 版本的新功能

我认为这是一个有趣的功能请求，并且会支持这样的请求。因此，如果您创建了这样的请求，请告诉我们。

# facebook - 首次点击赞按钮后标签内容不刷新

> ID：10693879
> 
> 赞同：0
> 
> 时间：2012-05-21T23:21:54.627
> 
> 标签：facebook, tabs, refresh, facebook-like, page-refresh

我已经为 facebook 标签实现了一个非常简单的“like guard”，并且我的测试用户遇到了问题。多个测试人员报告说，当他们打开选项卡并单击“喜欢”按钮时，他们并不总是会刷新页面（因此，在他们手动重新加载之前，喜欢保护不会消失）。这是在页面顶部使用facebook的like按钮，而不是我自己编写的。

作为健全性检查，我在我的服务器上启用了一些简单的日志记录，并且能够重新创建问题 - 我点击“喜欢”或“不喜欢”，但似乎没有对我的 index.php 页面发出请求，所以绝对没有刷新正在发生。

我知道这个老错误[https://developers.facebook.com/bugs/228778937218386](https://developers.facebook.com/bugs/228778937218386) 但这个似乎不同。对于初学者，在第一次单击“喜欢”按钮后，如果我继续单击不同/喜欢/....，那么刷新会自动发生，正如预期的那样。特别奇怪的是，**如果我在第**一次刷新失败后重新加载页面，刷新会按预期再次开始工作，即对我的喜欢状态的第一次更新会触发页面刷新。

一些可能（？）相关信息：

1.  我的标签是测试页的一部分，并且未发布
2.  我只对选项卡内容使用 http 托管，因为我的 https 尚未设置
3.  到目前为止，我刚刚与其他管理员进行了测试 - 所以也许用户角色会影响这一点？

很想知道以前是否有人遇到过这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T04:35:34.560

终于解决了这个问题，分享一下，以防其他人遇到同样的问题：

我的困惑是由我创建/分配测试人员的位置引起的。我制作了一个虚拟社区页面来托管我正在构建的选项卡，并将所有测试人员添加到**测试社区页面**。我意识到唯一没有遇到奇怪刷新问题的用户是那些我还添加为应用程序本身的管理员/测试人员的测试人员。显然，将他们作为测试人员添加到您的社区页面是不够的，测试人员在查看您的选项卡时不会给您某种警告，而是会得到这种错误的刷新行为。

# iphone - 使用计算机名称从 iPhone 访问网络服务

> ID：10693880
> 
> 赞同：0
> 
> 时间：2012-05-21T23:21:56.517
> 
> 标签：iphone, wcf, web-services, ip, sudzc

我在一台机器上发布了一个网络服务，我可以通过这个地址使用它：( `http://computer-name/`) 从任何通过 Wi-Fi 连接到这台机器的设备。

问题是，使用 iPhone，我只能使用 IP 地址访问 Web 服务，而不能使用计算机名称 ( `http://computer-name/`)。

那么，有谁知道这个问题来自哪里？或者有没有解决方案，让我可以使用计算机的名称来访问 iPhone 上的 Web 服务，而无需使用 IP 地址？谢谢。

# perl - 制作一条线

> ID：10693894
> 
> 赞同：-2
> 
> 时间：2012-05-21T23:22:54.347
> 
> 标签：perl

```
keyword harry /
sally/
tally/ 
```

希望每当字符串与关键字匹配时，它也应该寻找“/”字符。这表示行的延续

然后我想要输出为

```
keyword harry sally tally 
========================== 
```

我当前的代码：

```
#!/usr/bin/perl
open (file2, "trial.txt");

$keyword_1 = keyword;
foreach $line1 (<file2>) {
  s/^\s+|\s+$//g;
  if ($line1 =~ $keyword_1)    {
    $line2 =~ (s/$\//g, $line1) ;
    print " $line2 " ;
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T12:59:03.137

如果`=====`您的问题中的行应该在输出中，则使用

```
#! /usr/bin/env perl

use strict;
use warnings;

*ARGV = *DATA;  # for demo only; delete

sub print_line {
  my($line) = @_;
  $line =~ s/\n$//;  # / fix Stack Overflow highlighting
  print $line, "\n",
        "=" x (length($line) + 1), "\n";
}

my $line = "";
while (<>) {
  $line .= $line =~ /^$|[ \t]$/ ? $_ : " $_";

  if ($line !~ s!/\n$!!) {  # / ditto
    print_line $line;
    $line = "";
  }
}

print_line $line if length $line;

__DATA__
keyword jim-bob
keyword harry /
sally/
tally/ 
```

输出：

```
关键词吉姆鲍勃
=================
关键词 harry sally 理货
===========================
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T12:31:44.217

A`redo`在处理连接续行时很有用。

```
my $line;
while ( defined( $line = <DATA> )) {
    chomp $line;
    if ( $line =~ s{/\s*$}{ } ) {
        $line .= <DATA>;
        redo unless eof(DATA);
    }
    $line =~ s{/}{};
    print "$line\n";
}
__DATA__
keyword harry /
sally/
tally/
and
done!!!

$ ./test.pl
keyword harry  sally tally and
done!!! 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T23:48:22.027

您没有指定如何处理不包含关键字的行。不过，您可能会将此代码用作灵感：

```
#!/usr/bin/perl
use warnings;
use strict;

my $on_keyword_line;
while (<>) {
    if (/keyword/ or $on_keyword_line) {
        chomp;

        if (m{/$}) {
            chop;
            $on_keyword_line = 1;

        } else {
            $on_keyword_line = 0;

        }
        print;

    } else {
        $on_keyword_line = 0;
        print "\n";
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T05:18:16.607

我认为您需要简单地连接所有以斜杠结尾的行，而不管关键字如何。

我建议这个代码。

**更新**以说明 OP 的评论，即续行由*反斜杠*终止。

```
while (<>) {
  s|\\\s*\z||;
  print;
} 
```

# mysql - 此 SELECT 应该使用连接还是子查询？

> ID：10693895
> 
> 赞同：3
> 
> 时间：2012-05-21T23:22:59.493
> 
> 标签：mysql, sql, select, join

```
SELECT u.users_username, u.givenname, u.familyname, u.studentassent, u.parentconsent, u.birthdate, u.gender
FROM users AS u
JOIN classes_users as c
ON c.users_username = u.users_username
JOIN classes_users as x
ON c.classes_id = x.classes_id
WHERE x.users_username = "johnny" AND x.role = "teacher" 
```

或者

```
SELECT u.users_username, u.givenname, u.familyname, u.studentassent, u.parentconsent, u.birthdate, u.gender
FROM users AS u
WHERE u.users_username
IN (
    SELECT c.users_username
    FROM classes_users as c
    JOIN classes_users as x
    ON c.classes_id = x.classes_id
    WHERE x.users_username = "johnny" AND x.role = "teacher"
) 
```

我认为第一个更好，但我仍在学习如何编写更好的 SQL 语句，我不清楚在这种情况下会发生什么使一个语句比另一个语句更好的所有内部结构。

如果有比我写的两种方式更好的写法，请告诉我。谢谢。

编辑：有老师和学生。通过查看 classes_users 表可以找到他们在任何给定班级中作为学生或教师的位置。我想要做的是当给一个用户时，找到他是老师的班级，然后返回这些班级的所有学生。

这是我的数据库架构：

```
-- -----------------------------------------------------
-- Table `kcptech`.`users`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `kcptech`.`users` (
`users_username` VARCHAR(63) NOT NULL ,
`password` VARCHAR(255) NULL DEFAULT NULL ,
`salt` VARCHAR(127) NULL DEFAULT NULL ,
`givenname` VARCHAR(96) NULL DEFAULT NULL ,
`familyname` VARCHAR(128) NULL DEFAULT NULL ,
`privileges` TINYINT NULL DEFAULT NULL ,
`studentassent` TINYINT(1) UNSIGNED NULL DEFAULT NULL ,
`parentconsent` TINYINT(1) UNSIGNED NULL DEFAULT NULL ,
`birthdate` DATE NULL DEFAULT NULL ,
`gender` VARCHAR(1) NULL DEFAULT NULL ,
`registration` TIMESTAMP NULL DEFAULT NULL ,
PRIMARY KEY (`users_username`) ,
UNIQUE INDEX `uname_UNIQUE` (`users_username` ASC) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `kcptech`.`classes`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `kcptech`.`classes` (
`classes_id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,
`course` VARCHAR(127) NULL ,
`period` VARCHAR(31) NULL DEFAULT '' ,
`organization` VARCHAR(127) NULL DEFAULT '' ,
PRIMARY KEY (`classes_id`) ,
UNIQUE INDEX `id_UNIQUE` (`classes_id` ASC) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `kcptech`.`classes_users`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `kcptech`.`classes_users` (
`classes_id` INT UNSIGNED NOT NULL ,
`users_username` VARCHAR(64) NOT NULL ,
`role` VARCHAR(12) NOT NULL ,
PRIMARY KEY (`classes_id`, `users_username`) ,
INDEX `fk_class_users__users_users_username` (`users_username` ASC) ,
INDEX `fk_class_users__class_class_id` (`classes_id` ASC) ,
CONSTRAINT `fk_class_users__users_users_username`
  FOREIGN KEY (`users_username` )
  REFERENCES `kcptech`.`users` (`users_username` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION,
CONSTRAINT `fk_class_users__class_class_id`
  FOREIGN KEY (`classes_id` )
  REFERENCES `kcptech`.`classes` (`classes_id` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION)
ENGINE = InnoDB; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T23:28:37.620

第一个更好，假设它`(classes_id, users_username)`是独一无二的。

`MySQL`不能`IN`在内部查询前导进行半连接（构造）。因此`IN`查询将始终`users`用作前导表，而对于`JOIN`查询，优化器可以选择前导表。

如果`(classes_id, users_username)`不是唯一的，则查询在语义上是不等价的。您需要添加`DISTINCT`到联接查询。

# javascript - 验证包含日期和时间字段的表单，这些字段必须一起描述未来的日期和时间

> ID：10693897
> 
> 赞同：1
> 
> 时间：2012-05-21T23:23:13.230
> 
> 标签：javascript, jquery, jquery-validate

我有一个包含很多字段的表单，这些字段都有某种验证。然而，有两个字段是特殊的：日期字段和时间字段。他们的验证表明他们的组合日期/时间值是未来某个地方的时间戳。我使用 jQuery 验证插件以及它的额外功能来进行验证。看看这个小提琴，看看我所拥有的精简版：

[http://jsfiddle.net/2df9h/4/](http://jsfiddle.net/2df9h/4/)

我有几个问题：

1.  当我在日期字段中填写今天的日期并在时间字段中填写过去的时间时，验证按预期失败（时间戳在过去）。但是：只有时间字段才能获得正确的插件行为的错误视图，但我希望这两个字段都显示错误。我怎样才能做到这一点？
2.  当两个字段都显示“未来”错误并且我通过更改一个字段来修复它时，另一个字段不会切换到已修复。这也是预期的行为，但我希望两个字段都立即清除错误。我怎样才能做到这一点？

我尝试使用[此处](https://stackoverflow.com/questions/1300994/jquery-validate-require-at-least-one-field-in-a-group-to-be-filled)描述的技术验证其他字段：`$(.. selector for the two fields...).valid()`，但由于该帖子中[此评论](https://stackoverflow.com/a/5853963/1236396)中描述的错误，当我这样做时，其他字段将不再被验证。我几乎被困住了......有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T00:30:22.910

You can force (or clear) an error on any field programatically with the method `.showErrors(errors)` (see [documentation](http://docs.jquery.com/Plugins/Validation/Validator/showErrors#errors)).

This should help overcome both issues.

# c# - 用 C# 模仿 Powerpoint 和 Photoshop 的曲线制作 UI

> ID：10693902
> 
> 赞同：0
> 
> 时间：2012-05-21T23:23:43.283
> 
> 标签：c#, winforms, algorithm, bezier, curve

我一直在用 C# 编写一个涉及图像编辑和动画的程序。

我发现我需要一个允许我的用户绘制曲线的界面。

我认为 Photoshop 和 Powerpoint 使用的系统非常直观。

我四处搜索，发现了关于这个曲线系统的很多东西，包括它被称为贝塞尔曲线，以及点如何定义它们。

然而，尽管他们都描述了点如何定义曲线，但没有一个人描述了 Powerpoint 和 Photoshop 使用的定义系统，两个线段类似于切线。

直觉上，我认为这些段以某种方式用于计算定义曲线的点，但我完全不知道如何。

简而言之，我试图让我的用户以与 Photoshop 和 Powerpoint 类似的方式绘制贝塞尔曲线，使用在给定点具有端点的两条线段定义“切线”，这些线段的长度和方向都影响曲线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:32:14.300

```
this.CreateGraphics().DrawBezier(Pens.Black, 0, 0, 20, 80, 80, 20, 100, 100); 
```

`this`在这种情况下是一个表单，我在 OnPaint 事件的覆盖中调用了它。

您也可以在图像上绘制贝塞尔曲线，然后查看它：

```
var bitmap = new Bitmap(100, 100);

Graphics.FromImage(bitmap).DrawBezier(Pens.Black, 0, 0, 20, 80, 80, 20, 100, 100);

this._pictureBox.Image = bitmap; 
```

我的示例中的结果是：

![例子](../Images/179fe9d0060539349ef9bb0a9d4f086d.png)

# c# - 在 asp.net 中即时创建多个标签

> ID：10693904
> 
> 赞同：1
> 
> 时间：2012-05-21T23:23:55.010
> 
> 标签：c#, asp.net

我想根据用户输入的数字即时创建多个标签。例如，如果用户在文本框中写入 10，则应使用 id label1 - label10 创建 10 个标签，并且我想在这些标签中放置单独的文本。知道如何在 asp.net 中使用 c# 清晰的代码来做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:31:16.063

读取文本框值并执行循环，在其中创建标签控件对象并设置 ID 和文本属性值

```
int counter = Convert.ToInt32(txtCounter.Text);
for(int i=1;i<=counter;i++)
{
   Label objLabel = new Label();
   objLabel.ID="label"+i.ToString();
   objLabel.Text="I am number "+i.ToString();

   //Control is ready.Now let's add it to the form 
   form1.Controls.Add(objLabel);
} 
```

假设`txtCounter`是 TextBox 控件，用户在其中输入要创建的标签数量，而 form1 是页面中具有 runat="server" 属性的表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:31:38.413

类似以下内容应该可以帮助您入门。

```
// get user input count from the textbxo
string countString = MyTextBox.Text;
int count = 0;

// attempt to convert to a number
if (int.TryParse(countString, out count))
{
    // you would probably also want to validate the number is
    // in some range, like 1 to 100 or something to avoid
    // DDOS attack by entering a huge number.

    // create as many labels as number user entered
    for (int i = 1; i <= count; i++)
    {
        // setup label and add them to the page hierarchy
        Label lbl = new Label();
        lbl.ID = "label" + i;
        lbl.Text = "The Label Text.";
        MyParentControl.Controls.Add(lbl);
    }
}
else
{
    // if user did not enter valid number, show error message
    MyLoggingOutput.Text = "Invalid number: '" + countString + "'.";
} 
```

当然，您需要更正：

1.  你的实际文本框是什么，对于`MyTextBox`
2.  您的标签中有什么文字。
3.  将标签添加到页面的父控件`MyParentControl`。
4.  号码无效时怎么办，即`MyLoggingOutput`。
5.  适当的验证，例如，不允许用户输入 > 100 或 < 1 的数字。您可以使用自定义代码或验证控件（例如`RangeValidator`和）来处理`CompareValidator`。

# tomcat - TomEE + EclipseLink：EntityManager 注入不起作用

> ID：10693905
> 
> 赞同：1
> 
> 时间：2012-05-21T23:24:26.107
> 
> 标签：tomcat, jpa, ejb, eclipselink, apache-tomee

我试图让这个[JPA + EJB + Facelets 示例](http://docs.oracle.com/javaee/6/tutorial/doc/giqst.html)在 TomEE Web Profile 中运行。因为该示例使用 EclipseLink，所以我下载了 EclipseLink 并复制`eclipselink/jlib/eclipselink.jar`到该`TomEE/lib`目录中。

**问题 1：**这是我需要复制的唯一文件吗？

我有许多`Entity`类，一个用于服务 Web 请求的 JSF SessionScoped ManagedBean，一个用于处理数据库请求的有状态 EJB，还有一个用于在启动时将数据加载到数据库中的 EJB。

ManagedBean 和有状态 EJB 的代码片段如下：

```
@Singleton
@Startup
public class ConfigBean {
    @EJB
    private RequestBean request;

    @PostConstruct
    public void createData() {
        request.createPart("1234-5678-01", 1, "ABC PART", new java.util.Date(),
                "PARTQWERTYUIOPASXDCFVGBHNJMKL", null);    
        // more code here...
    }
}

@Stateful
public class RequestBean {
    private static Logger logger = Logger.getLogger("order.ejb.RequestBean");
    @PersistenceContext
    private EntityManager em;

    public void createPart(String partNumber, int revision, String description,
            java.util.Date revisionDate, String specification,
            Serializable drawing) {
        try {
            Part part = new Part(partNumber, revision, description,
                    revisionDate, specification, drawing);
            em.persist(part); // <--- EXCEPTION THROWN HERE
        } catch (Exception ex) {
            throw new EJBException(ex.getMessage());
        }
    }
} 
```

当`em.persist(part);`RequestBean 中的行尝试执行时，我收到以下异常：

```
WARNING: Injection: No such property 'order.ejb.RequestBean/em' in class order.ejb.RequestBean
May 22, 2012 12:38:39 AM org.apache.openejb.core.transaction.EjbTransactionUtil handleSystemException
SEVERE: The bean instance business method encountered a system exception: The transaction has been marked rollback only because the bean encountered a non-application exception :javax.ejb.EJBException : null
javax.ejb.EJBTransactionRolledbackException: The transaction has been marked rollback only because the bean encountered a non-application exception :javax.ejb.EJBException : null
    at org.apache.openejb.core.ivm.BaseEjbProxyHandler.convertException(BaseEjbProxyHandler.java:350)
    at org.apache.openejb.core.ivm.BaseEjbProxyHandler.invoke(BaseEjbProxyHandler.java:288)
    at order.ejb.RequestBean$LocalBeanProxy.createPart(order/ejb/RequestBean.java)
    at order.ejb.ConfigBean.createData(ConfigBean.java:35)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext$Invocation.invoke(ReflectionInvocationContext.java:181)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext$LifecycleInvocation.invoke(ReflectionInvocationContext.java:213)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext.proceed(ReflectionInvocationContext.java:163)
    at org.apache.openejb.monitoring.StatsInterceptor.record(StatsInterceptor.java:176)
    at org.apache.openejb.monitoring.StatsInterceptor.PostConstruct(StatsInterceptor.java:104)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext$Invocation.invoke(ReflectionInvocationContext.java:181)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext.proceed(ReflectionInvocationContext.java:163)
    at org.apache.openejb.core.interceptor.InterceptorStack.invoke(InterceptorStack.java:138)
    at org.apache.openejb.BeanContext.newInstance(BeanContext.java:1368)
    at org.apache.openejb.core.singleton.SingletonInstanceManager.createInstance(SingletonInstanceManager.java:174)
    at org.apache.openejb.core.singleton.SingletonInstanceManager.access$100(SingletonInstanceManager.java:66)
    at org.apache.openejb.core.singleton.SingletonInstanceManager$1.call(SingletonInstanceManager.java:115)
    at org.apache.openejb.core.singleton.SingletonInstanceManager$1.call(SingletonInstanceManager.java:113)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at org.apache.openejb.core.singleton.SingletonInstanceManager.getInstance(SingletonInstanceManager.java:124)
    at org.apache.openejb.core.singleton.SingletonInstanceManager.initialize(SingletonInstanceManager.java:90)
    at org.apache.openejb.core.singleton.SingletonInstanceManager.start(SingletonInstanceManager.java:81)
    at org.apache.openejb.core.singleton.SingletonContainer.start(SingletonContainer.java:118)
    at org.apache.openejb.assembler.classic.Assembler.createApplication(Assembler.java:795)
    at org.apache.openejb.assembler.classic.Assembler.createApplication(Assembler.java:506)
    at org.apache.tomee.catalina.TomcatWebAppBuilder.startInternal(TomcatWebAppBuilder.java:634)
    at org.apache.tomee.catalina.TomcatWebAppBuilder.configureStart(TomcatWebAppBuilder.java:588)
    at org.apache.tomee.catalina.GlobalListenerSupport.lifecycleEvent(GlobalListenerSupport.java:117)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5161)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1566)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1556)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: javax.ejb.EJBException
    at order.ejb.RequestBean.createPart(RequestBean.java:59)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext$Invocation.invoke(ReflectionInvocationContext.java:181)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext.proceed(ReflectionInvocationContext.java:163)
    at org.apache.openejb.monitoring.StatsInterceptor.record(StatsInterceptor.java:176)
    at org.apache.openejb.monitoring.StatsInterceptor.invoke(StatsInterceptor.java:95)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext$Invocation.invoke(ReflectionInvocationContext.java:181)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext.proceed(ReflectionInvocationContext.java:163)
    at org.apache.openejb.cdi.CdiInterceptor.invoke(CdiInterceptor.java:129)
    at org.apache.openejb.cdi.CdiInterceptor.access$000(CdiInterceptor.java:45)
    at org.apache.openejb.cdi.CdiInterceptor$1.call(CdiInterceptor.java:66)
    at org.apache.openejb.cdi.CdiInterceptor.aroundInvoke(CdiInterceptor.java:72)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext$Invocation.invoke(ReflectionInvocationContext.java:181)
    at org.apache.openejb.core.interceptor.ReflectionInvocationContext.proceed(ReflectionInvocationContext.java:163)
    at org.apache.openejb.core.interceptor.InterceptorStack.invoke(InterceptorStack.java:138)
    at org.apache.openejb.core.stateful.StatefulContainer.businessMethod(StatefulContainer.java:648)
    at org.apache.openejb.core.stateful.StatefulContainer.invoke(StatefulContainer.java:353)
    at org.apache.openejb.core.ivm.EjbObjectProxyHandler.synchronizedBusinessMethod(EjbObjectProxyHandler.java:260)
    at org.apache.openejb.core.ivm.EjbObjectProxyHandler.businessMethod(EjbObjectProxyHandler.java:240)
    at org.apache.openejb.core.ivm.EjbObjectProxyHandler._invoke(EjbObjectProxyHandler.java:91)
    at org.apache.openejb.core.ivm.BaseEjbProxyHandler.invoke(BaseEjbProxyHandler.java:284)
    ... 45 more 
```

由于我对 Java EE 的魔力不是很熟悉，所以我几乎不知道这里出了什么问题，但我很想知道是什么导致了堆栈跟踪中的第一行，上面：

```
WARNING: Injection: No such property 'order.ejb.RequestBean/em' in class order.ejb.RequestBean 
```

**问题 2：**由于某种原因，实体管理器的注入似乎不起作用。有人知道为什么吗？

为了完整起见，下面是 my `persistence.xml`，它位于`project/src/main/webapp/classes/META-INF/`目录中：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0"
    xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
    <persistence-unit name="order" transaction-type="JTA">
        <jta-data-source>jdbc/__default</jta-data-source>
        <properties>
            <property name="eclipselink.ddl-generation" value="drop-and-create-tables" />
            <property name="eclipselink.ddl-generation.output-mode"
                value="both" />
        </properties>
    </persistence-unit>
</persistence> 
```

**源代码**

如果有人想看项目的目录结构、源代码、配置文件等，我这里已经上传到[github了](https://github.com/alexaverbuch/order)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:33:56.790

`persistence.xml`根据[Common PersistenceProvider 属性](http://openejb.apache.org/common-persistenceprovider-properties.html)更新为使用 OpenJPA ：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0"
    xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
    <persistence-unit name="order" transaction-type="JTA">
        <jta-data-source>jdbc/__default</jta-data-source>
        <properties>
            <property name="openjpa.jdbc.SynchronizeMappings"
                value="buildSchema(foreignKeys=true,schemaAction='dropDB,add')" />
            <property name="openjpa.jdbc.SchemaFactory" value="native(foreignKeys=true)" />
            <property name="openjpa.jdbc.MappingDefaults"
                value="ForeignKeyDeleteAction=restrict, JoinForeignKeyDeleteAction=restrict" />
            <property name="openjpa.Log" value="DefaultLevel=TRACE,SQL=TRACE" />
        </properties>
    </persistence-unit>
</persistence> 
```

仍然出现以下异常：

```
INFO - Starting OpenJPA 2.2.0 
java.lang.NullPointerException 
        at order.web.OrderManager.getOrders(OrderManager.java:53) 
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) 
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 
        at java.lang.reflect.Method.invoke(Method.java:601) 
        at javax.el.BeanELResolver.getValue(BeanELResolver.java:64) 
        at javax.el.CompositeELResolver.getValue(CompositeELResolver.java:58) 
        at org.apache.myfaces.el.unified.resolver.FacesCompositeELResolver.getValue(FacesCompositeELResolver.java:169) 
        at org.apache.el.parser.AstValue.getValue(AstValue.java:169) 
        at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189) 
        at org.apache.myfaces.view.facelets.el.ContextAwareTagValueExpression.getValue(ContextAwareTagValueExpression.java:96) 
        at javax.faces.component._DeltaStateHelper.eval(_DeltaStateHelper.java:246) 
        at javax.faces.component.UIData.getValue(UIData.java:2031) 
        at javax.faces.component.UIData.createDataModel(UIData.java:1979) 
        at javax.faces.component.UIData.getDataModel(UIData.java:1956) 
        at javax.faces.component.UIData.getRowCount(UIData.java:478) 
        at org.apache.myfaces.shared.renderkit.html.HtmlTableRendererBase.encodeInnerHtml(HtmlTableRendererBase.java:366) 
        at org.apache.myfaces.shared.renderkit.html.HtmlTableRendererBase.encodeChildren(HtmlTableRendererBase.java:214) 
        at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:626) 
        at javax.faces.component.UIComponentBase.encodeAll(UIComponentBase.java:524) 
        at javax.faces.component.UIComponentBase.encodeAll(UIComponentBase.java:533) 
        at org.apache.myfaces.view.facelets.FaceletViewDeclarationLanguage.renderView(FaceletViewDeclarationLanguage.java:1908) 
        at org.apache.myfaces.application.ViewHandlerImpl.renderView(ViewHandlerImpl.java:285) 
        at javax.faces.application.ViewHandlerWrapper.renderView(ViewHandlerWrapper.java:59) 
        at org.apache.myfaces.lifecycle.RenderResponseExecutor.execute(RenderResponseExecutor.java:116) 
        at org.apache.myfaces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:241) 
        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:199) 
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305) 
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) 
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225) 
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169) 
        at org.apache.tomee.catalina.OpenEJBValve.invoke(OpenEJBValve.java:44) 
        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472) 
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168) 
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98) 
        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927) 
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118) 
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407) 
        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999) 
        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565) 
        at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307) 
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) 
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) 
        at java.lang.Thread.run(Thread.java:722) 
```

显然这是 TomEE 1.0.0 中的一个已知错误，已在主干中解决，所以我[下载了最新的 beta3 快照](https://repository.apache.org/content/repositories/snapshots/org/apache/openejb/apache-tomee/1.0.0-beta-3-SNAPSHOT/)

现在一切正常。

# language-agnostic - 如果计算机语言在发生溢出时总是抛出异常有什么优点和缺点？

> ID：10693907
> 
> 赞同：1
> 
> 时间：2012-05-21T23:24:47.387
> 
> 标签：language-agnostic, overflow, computer-science

一些计算机语言从不承认发生了溢出这一事实，但这样做有什么好处呢？我假设这样做的缺点是，如果您有一个整数，那么您必须牢记某些界限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T18:13:50.430

> 我假设这样做的缺点是，如果您有一个整数，那么您必须牢记某些界限。

正如您所说，这并不是真正的缺点。但是，如果您考虑如何为有符号和无符号加法定义“溢出”，您可能会意识到，如果您忽略溢出，则可以进行重大简化。

另外，考虑性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T18:02:38.307

优点包括捕获值无意溢出的错误。

# php - 如何修复mysql行中的ENTER键

> ID：10693911
> 
> 赞同：2
> 
> 时间：2012-05-21T23:25:14.423
> 
> 标签：php, mysql, database

我有一个很大的 mysql 表，我在尝试查询数据库时发现了一个问题。似乎在插入某些列时按下了 ENTER 键。例如，我可以执行以下搜索：

```
$query = mysql_query("SELECT * FROM table WHERE color= 'red'"); 
```

现在，我可能有 20 行颜色为红色但显示较少的行。当我使用 phpmyadmin 编辑搜索结果中未显示的行时，我注意到颜色列显示`red`但有一个换行符，因此光标位于“红色”一词下方的一行上。如果我使用退格键一次擦除该行然后保存该行，它现在出现在我的查询结果中。

我的数据库非常大，所以我想知道是否有任何方法可以搜索`color`值末尾有任何“额外字符”的数据库，并删除这些额外字符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T23:30:30.260

TRIM 默认只删除空格。以下将删除换行符：

```
UPDATE table SET color = TRIM(TRAILING '\n' FROM color) 
```

参考：[MySQL 文档](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_trim)

# c++ - 具有重要成员的 C++11 匿名联合

> ID：10693913
> 
> 赞同：29
> 
> 时间：2012-05-21T23:25:19.777
> 
> 标签：c++, constructor, c++11, anonymous, unions

我正在更新我的一个结构，我想向它添加一个 std::string 成员。原始结构如下所示：

```
struct Value {
  uint64_t lastUpdated;

  union {
    uint64_t ui;
    int64_t i;
    float f;
    bool b;
  };
}; 
```

当然，仅向联合中添加一个 std::string 成员会导致编译错误，因为通常需要添加对象的非平凡构造函数。 [在 std::string 的情况下（来自informit.com 的文本）](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=556)

> 由于 std::string 定义了所有六个特殊成员函数，因此 U 将具有隐式删除的默认构造函数、复制构造函数、复制赋值运算符、移动构造函数、移动赋值运算符和析构函数。实际上，这意味着您不能创建 U 的实例，除非您明确定义一些或所有特殊成员函数。

然后网站继续提供以下示例代码：

```
union U
{
int a;
int b;
string s;
U();
~U();
}; 
```

但是，我在结构中使用匿名联合。我在 freenode 上询问了##C++，他们告诉我正确的方法是将构造函数放在结构中，并给了我这个示例代码：

```
#include <new>

struct Point  {
    Point() {}
    Point(int x, int y): x_(x), y_(y) {}
    int x_, y_;
};

struct Foo
{
  Foo() { new(&p) Point(); }
  union {
    int z;
    double w;
    Point p;
  };
};

int main(void)
{
} 
```

但是从那里我无法弄清楚如何定义 std::string 需要定义的其余特殊函数，而且，我并不完全清楚该示例中的 ctor 是如何工作的。

我可以请人更清楚地向我解释一下吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-22T02:07:51.833

这里不需要放置新的。

变体成员不会被编译器生成的构造函数初始化，但是选择一个并使用普通的*ctor-initializer-list*初始化它应该没有问题。在匿名联合中声明的成员实际上是包含类的成员，并且可以在包含类的构造函数中初始化。

此行为在第 9.5 节中描述。`[class.union]`：

> 类*联合*类是具有匿名联合作为直接成员的联合或类。类似联合的类`X`有一组*变体成员*。如果`X`是联合，则其变体成员是非静态数据成员；否则，它的变体成员是所有匿名联合的非静态数据成员，它们是`X`.

在第 12.6.2 节中`[class.base.init]`：

> *ctor-initializer*可以初始化构造函数类的变体成员。如果*ctor-* initializer为同一个成员或同一个基类指定了多个*mem-initializer ，则**ctor-initializer 格式错误*。

所以代码可以很简单：

```
#include <new>

struct Point  {
    Point() {}
    Point(int x, int y): x_(x), y_(y) {}
    int x_, y_;
};

struct Foo
{
  Foo() : p() {} // usual everyday initialization in the ctor-initializer
  union {
    int z;
    double w;
    Point p;
  };
};

int main(void)
{
} 
```

当然，当激活一个变量成员而不是在构造函数中初始化的另一个成员时，仍然应该使用placement new。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-22T01:48:44.820

该`new (&p) Point()`示例是对标准放置`new`运算符的调用（通过放置新表达式），因此您需要包含`<new>`. 该特定运算符的特殊之处在于它不*分配*内存，它只返回您传递给它的内容（在这种情况下它是`&p`参数）。表达式的最终结果是已经构造了一个对象。

如果将此语法与显式析构函数调用结合使用，则可以完全控制对象的生命周期：

```
// Let's assume storage_type is a type
// that is appropriate for our purposes
storage_type storage;

std::string* p = new (&storage) std::string;
// p now points to an std::string that resides in our storage
// it was default constructed

// *p can now be used like any other string
*p = "foo";

// Needed to get around a quirk of the language
using string_type = std::string;

// We now explicitly destroy it:
p->~string_type();
// Not possible:
// p->~std::string();

// This did nothing to our storage however
// We can even reuse it
p = new (&storage) std::string("foo");

// Let's not forget to destroy our newest object
p->~string_type(); 
```

您应该在何时何地在您的类中构造和销毁`std::string`成员（我们称之为`s`）`Value`取决于您对`s`. 在这个最小的示例中，您永远不会在特殊成员中构造（并因此破坏）它：

```
struct Value {
    Value() {}

    Value(Value const&) = delete;
    Value& operator=(Value const&) = delete;

    Value(Value&&) = delete;
    Value& operator=(Value&&) = delete;

    ~Value() {}

    uint64_t lastUpdated;

    union {
        uint64_t ui;
        int64_t i;
        float f;
        bool b;
        std::string s;
    };
}; 
```

因此，以下是 的有效用法`Value`：

```
Value v;
new (&v.s) std::string("foo");
something_taking_a_string(v.s);
using string_type = std::string;
v.s.~string_type(); 
```

您可能已经注意到，我禁用了复制和移动`Value`。这样做的原因是，如果不知道哪个是活跃的（如果有的话），我们就无法复制或移动工会的适当活跃成员。

# c# - wpf 自定义控件事件

> ID：10693917
> 
> 赞同：1
> 
> 时间：2012-05-21T23:25:45.513
> 
> 标签：c#, .net, wpf, wpf-controls, custom-controls

我想创建一个包含 Button 和 ContentPresenter 的自定义 wpf 控件。由于 WPF 控件应该是无外观的，因此我创建了一个应该包含控件行为的类，并将控件的默认样式放在 generic.xaml 文件中。到目前为止，一切都很好。

但是如何让我的按钮引发一个事件（路由事件？）并在我的控件类中处理它？我发现我可以从 generic.xaml 为 ResourceDictionary 添加代码隐藏文件并将我的事件处理程序放在那里，但这会将我的控件的行为与其模板相关联，因此是不可取的。我见过的另一个想法（但还没有尝试过）是使用 TemplatePart 机制来定位模板内的一些关键控件并订阅代码中的事件。但这对我来说似乎不够灵活，因为我的控件的用户可能会希望将按钮替换为在设计控件时我不知道任何事件的控件。

那么，当单击按钮并在控件的代码文件中订阅它时，如何在 XAML 中引发事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T05:51:46.157

重写控件的[OnApplyTemplate](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.onapplytemplate%28v=vs.100%29.aspx)方法。

那是您知道模板已被应用的地方，您可以使用 GetTemplateChild 获取对控件的引用。

例如：

```
public override void OnApplyTemplate()
{
    base.OnApplyTemplate();
    var myButton = this.GetTemplateChild("myButton") as Button;
    if(myButton != null)
    {
        myButton.Click += ...;
} 
```

# php - 表示单行的模型是否应该返回使用多行生成的数据？

> ID：10693919
> 
> 赞同：0
> 
> 时间：2012-05-21T23:25:47.683
> 
> 标签：php, model-view-controller, orm, model

**一些背景：**

*   这适用于在不使用任何框架的情况下构建的 MVC 应用程序，但遵循 MVC 范例。
*   我正在使用一个名为[RedBean](http://www.redbeanphp.com/)的 ORM 库来与数据库通信。
*   虽然 RedBean 使用“bean”表示数据，但它支持将它们包装到模型中，因此模型可以提供自定义函数：

    ```
    $account = R::dispense('account');
    $account->name = "john";
    R::store($account);
    $account->getFormattedLastUpdatedTime('America/New_York'); 
    ```

**现在的问题：**

目前，模型的每个实例将代表数据库中的 1 行。如果我有一组帐户，那么我将拥有一组“帐户”模型。

在应用程序中，我有一个自定义配置文件字段的功能（别担心，虽然我没有使用 EAV :)）。其中一张表存储这些字段（名称、描述等）的元数据，用于为这些自定义配置文件字段生成表单字段。同样，元数据的每一行代表 1 个表单字段，每一行由 1 个模型表示。

我现在希望编写一个方法来将所有这些行转换为一个表单对象，然后可以将其用于呈现和处理表单。但是，这种方法应该存在于哪里？我最初的想法是将它放在表示自定义配置文件字段元数据的模型中。

澄清：此功能不在`account`模型中，而是在`profile_fields_meta`模型中。

**问题**

由于每个模型应该代表 1 行，因此让模型返回一个从数据库中的 MULTIPLE 行生成的对象似乎有点“脏”。我是否正确地说这不是最好的方法？你建议我做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:42:43.163

扩展 ArrayObject ( [http://php.net/manual/en/class.arrayobject.php](http://php.net/manual/en/class.arrayobject.php) ) 或其他容器类来运行收集方法是正确的。如果指定，请尝试修改查询方法以返回自定义集合类中的数据，而不是数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:44:29.827

MVC 没有任何内在的东西说“每个模型 [实例] 应该代表一行”。通常在 MVC 框架中，模型（至少如控制器所见）完全不了解数据存储，并且没有任何概念或直接映射到“行”。这不一定是 ORM 的情况，但模型不需要遵守 ORM 的约束。

但是，尽管如果不了解更多有关架构和实现的信息就很难判断，但您所描述的功能听起来并不适合您的 Account 模型。事实上，在我看来，您应该考虑拥有一个“FormField”模型，这样，用 Rails 的说法，Account“有很多”FormFields。

并且为了记录，EAV 并不总是坏的，它只是经常被滥用。

# sql-server - 如何表达 T-SQL 水平连接？

> ID：10693924
> 
> 赞同：0
> 
> 时间：2012-05-21T23:26:39.780
> 
> 标签：sql-server, tsql, sql-server-2008-r2

`LabUsers`我有一个数据库，其中包括两个表 Labs 和LabUsers如何将列从`Labs`.

具体来说，我希望将实验室的用户名连接起来并用项目符号 ( `• is Alt+0149`) 分隔，并让这些用户名按字母顺序从左到右排序。

这是一个例子。

该`Labs`表如下所示：

```
LabID  LabName     LabStudents
-----  ----------  -----------
1      North       NULL
2      North East  NULL
3      South West  NULL 
```

`LabUsers`看起来像这样：

```
LabUserID   LabUserName   LabID
---------   -----------   -----    
1           Diana         1
2           Paul          2
3           Paula         2
4           Romeo         1
5           Julia         1
6           Rose          2
7           Diana         2 
```

我想在`Labs`表格中得到这个结果：

```
LabID  LabName     LabUsers
-----  ----------  ---------------------
1      North       Diana•Julia•Romeo
2      North East  Diana•Paul•Paula•Rose
3      South West  NULL 
```

这是创建表的脚本：

```
USE [tempdb];
GO
CREATE TABLE [dbo].[LabUsers]
(
    [LabUserID] [int] PRIMARY KEY CLUSTERED,
    [LabUserName] [nvarchar](50) NOT NULL,
    [LabID] [int] NOT NULL
);
GO
INSERT [dbo].[LabUsers] SELECT 1, N'Diana', 1;
INSERT [dbo].[LabUsers] SELECT 2, N'Paul',  2;
INSERT [dbo].[LabUsers] SELECT 3, N'Paula', 2;
INSERT [dbo].[LabUsers] SELECT 4, N'Romeo', 1;
INSERT [dbo].[LabUsers] SELECT 5, N'Julia', 1;
INSERT [dbo].[LabUsers] SELECT 6, N'Rose',  2;
INSERT [dbo].[LabUsers] SELECT 7, N'Diana', 2;

CREATE TABLE [dbo].[Labs]
(
    [LabID] [int] PRIMARY KEY CLUSTERED,
    [LabName] [nvarchar](50) NOT NULL,
    [LabUsers] [nvarchar](max) NULL
);
GO
INSERT [dbo].[Labs] SELECT 1, N'North',      NULL;
INSERT [dbo].[Labs] SELECT 2, N'North East', NULL;
INSERT [dbo].[Labs] SELECT 3, N'South West', NULL; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:40:03.677

```
SELECT l.LabID, l.LabName, LabUsers = STUFF((SELECT N'•' + lu.LabUserName
  FROM dbo.LabUsers AS lu 
  WHERE lu.LabID = l.LabID
  ORDER BY lu.LabUserName
  FOR XML PATH(''), 
  TYPE).value(N'./text()[1]', N'nvarchar(max)'), 1, 1, N'')
FROM dbo.Labs AS l; 
```

我认为绝对没有理由将其存储在表中，因为您始终可以在运行查询时生成代码。如果将其存储在表中，则每次更改表中的任何行时都必须更新它。

但是，如果我无法说服您不要这样做（这样存储冗余数据确实很糟糕），您可以尝试以下方式：

```
;WITH x AS
(
    SELECT l.LabID, l.LabName, x = STUFF((SELECT N'•' + lu.LabUserName
      FROM dbo.LabUsers AS lu 
      WHERE lu.LabID = l.LabID
      ORDER BY lu.LabUserName
      FOR XML PATH(''), 
      TYPE).value(N'./text()[1]', N'nvarchar(max)'), 1, 1, N'')
    FROM dbo.Labs AS l
)
UPDATE l
SET LabUsers = x.x
FROM dbo.Labs AS l
INNER JOIN x ON l.LabID = x.LabID; 
```

至于性能测试，我会将上述版本与此变体进行比较：

```
SELECT l.LabID, l.LabName, LabUsers = STUFF((SELECT N'•' + lu.LabUserName
  FROM dbo.LabUsers AS lu 
  WHERE lu.LabID = l.LabID
  ORDER BY lu.LabUserName
  FOR XML PATH('')), 1, 1, '')
FROM dbo.Labs AS l; 
```

在我的系统上，我看到这个答案顶部的初始版本要贵得多。另请注意，将这些方法填充（不是双关语）到用户定义的函数中将使其更接近@RThomas 提出的串联方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T23:43:49.313

试试这个

```
SELECT  LabName ,
        STUFF(( SELECT  ',' + LabUsers.LabUserName
                FROM    dbo.LabUsers
                WHERE   LabUsers.LabID = Labs.LabID
                ORDER BY LabName
              FOR
                XML PATH('')
              ), 1, 1, '') AS Labusers
FROM    dbo.Labs
ORDER BY LabName 
```

FOR XML PATH('') 将您的字符串连接到一个 XML 结果中，并且 STUFF 在第一个字符处放置一个“无”字符，例如清除不需要的第一个逗号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T23:45:41.043

另一种方法是设置一个 UDF，将所有实验室用户作为单个字符串返回，如下所示：

```
CREATE FUNCTION LabUserString
(
@pLabId Int
)
RETURNS NVarChar(Max)
AS
BEGIN

  Declare @pResult NVarChar(Max)

  SELECT @pResult = COALESCE(@pResult + N'•', '') + [LabUserName] 
  FROM LabUsers WHERE LabId = @pLabId

  Return @pResult

END 
```

然后是这样的查询：

```
Select LabID, LabName, dbo.LabUserString(LabID) AS LabUsers FROM Labs 
```

# iphone - 阻止 iCloud 备份

> ID：10693925
> 
> 赞同：2
> 
> 时间：2012-05-21T23:26:42.363
> 
> 标签：iphone, objective-c, ios5, icloud

我制作了人们下载内容的应用程序，他们可以离线访问它，它就像一个目录。但苹果拒绝了它，因为它在 iCloud 中烘烤，我正在执行以下操作，但它似乎不起作用。

函数.m

```
+ (BOOL)addSkipBackupAttributeToItemAtURL:(NSURL *)URL {
    const char* filePath = [[URL path] fileSystemRepresentation];

    const char* attrName = "com.apple.MobileBackup";
    u_int8_t attrValue = 1;

    int result = setxattr(filePath, attrName, &attrValue, sizeof(attrValue), 0, 0);

    return result == 0;
} 
```

更新.m

```
- (void)updateImg:(NSString *)tipo {

    //tomamos el ultimo update
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSTimeInterval time = [defaults doubleForKey:@"lastUpdate"];
    NSLog(@"%f", time);

    CatalogoAppDelegate *app = [[UIApplication sharedApplication] delegate];

    NSString *post = [NSString stringWithFormat:@"lastUpdate=%f", time];
    NSData *postData = [post dataUsingEncoding:NSISOLatin1StringEncoding allowLossyConversion:NO];
    NSMutableURLRequest *urlRequest = [[[NSMutableURLRequest alloc] init] autorelease];
    NSString *url = [NSString stringWithFormat:@"%@iPhone/update%@Img.php", app.serverUrl, tipo];
    [urlRequest setURL:[NSURL URLWithString:url]];
    [urlRequest setHTTPMethod:@"POST"]; 
    [urlRequest setHTTPBody:postData];

    NSData *urlData; 
    NSURLResponse *response; 
    NSError *error;
    urlData = [NSURLConnection sendSynchronousRequest:urlRequest returningResponse:&response error:&error]; 
    if(urlData) {

        NSString *aStr = [[[NSString alloc] initWithData:urlData encoding:NSUTF8StringEncoding]autorelease];
        //NSLog(@"%@: %@", tipo, aStr);
        NSArray *temp = [aStr componentsSeparatedByString:@";"];

        //Direccionl Local de la APP
        NSString *docDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];

        for (int i=0; i<[temp count]; i++) {

            NSString *tempImg = [NSString stringWithFormat:@"%@", [temp objectAtIndex:i]];
            //NSLog(@"%@", tempImg);

            //pedimos cada url
            NSURL *tempURL = [NSURL URLWithString:[NSString stringWithFormat:@"%@images/%@/%@", app.serverUrl, tipo, tempImg]];
            //[Funciones addSkipBackupAttributeToItemAtURL:tempURL];
            UIImage *image = [[UIImage alloc] initWithData:[NSData dataWithContentsOfURL:tempURL]];
            NSLog(@"%@images/%@/%@", app.serverUrl, tipo, tempImg);
            NSString *pngFilePath = [NSString stringWithFormat:@"%@/%@", docDir, tempImg];
            NSData *data1 = [NSData dataWithData:UIImagePNGRepresentation(image)];
            [data1 writeToFile:pngFilePath atomically:YES];

            NSURL *backUrl = [NSURL fileURLWithPath:pngFilePath];
            [Funciones addSkipBackupAttributeToItemAtURL:backUrl];

        }

    }
    [self performSelectorInBackground:@selector(finUpdate) withObject:nil];
} 
```

知道我做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:38:16.900

`setxattr`提供指示成功或错误的结果，Apple 的`addSkipBackupAttributeToItemAtURL:`方法检查错误并将此信息传递回您的代码。您的代码只是忽略它。首先确定它是否返回错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:47:32.200

可能是因为您的应用与 iOS 5.0 兼容。不备份变量仅从 5.1 开始可用。详情在这里[http://developer.apple.com/library/ios/#qa/qa1719/_index.html#//apple_ref/doc/uid/DTS40011342](http://developer.apple.com/library/ios/#qa/qa1719/_index.html#//apple_ref/doc/uid/DTS40011342)

# ruby-on-rails - 为什么我的 Rails 控制器/表单没有将任何数据保存到我的本地数据库？

> ID：10693928
> 
> 赞同：0
> 
> 时间：2012-05-21T23:26:57.933
> 
> 标签：ruby-on-rails, database, forms, model, controller

我是 Ruby on Rails 的新手，作为我的第一个项目，我正在为我的初创公司创建一个 beta 注册页面。我只想将用户的电子邮件地址保存到数据库中以供将来使用，并且我无法将任何数据保存到我的数据库中。我可以通过 rails 控制台添加电子邮件，但我的表单/控制器无法正常工作。怎么了？

用户模型：

```
class User < ActiveRecord::Base
  attr_accessible :email

  before_save { |user| user.email = email.downcase }
  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence: true, format: { with: VALID_EMAIL_REGEX }, uniqueness:
 {case_sensitive: false }

end 
```

用户控制器：

```
class UsersController < ApplicationController

  def index

  end

  def create
    User.create params[:email]

    redirect_to :back, :notice => "Success!"

  end

end 
```

主页 HTML：

```
<h1>######</h1>
<p>Welcome to #####! Give us your email address, and we'll keep you informed on our
latest happenings.
You'll also be placed on the list for our private alpha and beta testings.</p>

<%= render 'form' %> 
```

形成部分：

```
<%= form_for User.new do |f| %>
<%= f.label :email %>
<%= f.text_field :email %>
<%= f.submit %>
<% end %> 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T23:43:27.597

首先，使用`params[:user]`not创建用户`params[:email]`。如果您只想要电子邮件地址，请将`params[:user][:email]`.

这是因为 params 是一个嵌套的哈希，看起来像这样 `params[:user] = { email: "name@example.com" }`：

其次，使用条件逻辑以防电子邮件地址未通过验证且未保存。

```
@user = User.new(params[:user])
if @user.save
  redirect_to :back, :notice => "Success!"
else
  # display error messages
end 
```

或者如果你想详细一点：

```
@user = User.new(:email => params[:user][:email]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T23:36:14.213

这是错误的：

```
User.create params[:email] 
```

它应该是：

```
User.create params[:user] 
```

# xml - 如何使用属性限制子标签应该是什么？

> ID：10693930
> 
> 赞同：0
> 
> 时间：2012-05-21T23:27:05.060
> 
> 标签：xml, xsd

我有一个这样的片段 XML：

```
....
<cell type='1'>
    <A>Some text</A>
</cell>
<cell type='2'>
    <B>Some text</B>
</cell>
.... 
```

仅当“类型”属性为 1（如果为 2 时为 B）时，如何编写强制元素 A 成为“单元格”子级的模式？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T00:07:46.867

抱歉，但我认为当前的 XSD 不允许这样做。

定义选择或替代的唯一方法是使用[xsd:choice](http://www.w3schools.com/schema/el_choice.asp)标签。这仅指定要从哪些元素中选择以及这些元素的基数（最大和最小出现），但不是在某些条件下。

所以它只是关于*哪些*和*多少*元素，但肯定*不是在哪些条件下*可以选择

# jquery - 使点击事件中的 jQuery 变量可用于其他函数

> ID：10693937
> 
> 赞同：1
> 
> 时间：2012-05-21T23:28:36.873
> 
> 标签：jquery, function, variables, this, global

我需要通过另一个函数的回调中的方法发送一个变量。变量应该是单击的导航链接。这里不是无力解释，而是代码。逻辑是错误的，但你会明白的。

```
/* Make a variable out of which link was clicked */

$('nav a').click(function(){
    var $nav = $(this);
});

$('nav').localScroll({
    duration: 500,
    easing:'easeOutSine',
    axis:'xy',
    onAfter: function(){

/* send that variable through aktivator() in the callback of localScroll() */

        $nav.aktivator();
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:31:21.097

放在`$nav`更高的范围：

```
var $nav;

$('nav a').click(function(){
    $nav = $(this);
});

$('nav').localScroll({
    /* ... */
    onAfter: function(){
        $nav.aktivator();
    }
}); 
```

现在两个区域都可以访问它，或者调用它的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T23:32:55.590

```
var $nav; //higher

$('nav a').click(function(){
    $nav = $(this);
});

$('nav').localScroll({
    duration: 500,
    easing:'easeOutSine',
    axis:'xy',
    onAfter: function(){
        $nav.aktivator(); //available
    }
}); 
```

# json - 如何使用 DataContractJsonSerializer 在 WP7 中反序列化少量 JSON

> ID：10693939
> 
> 赞同：1
> 
> 时间：2012-05-21T23:28:37.963
> 
> 标签：json, web-services, windows-phone-7, deserialization

我正在尝试反序列化来自 Web 请求的 JSON 结果。

这是我的代码。

```
 void myButton_Click(object sender, RoutedEventArgs e)
    {
        try
        {
            WebClient webClient = new WebClient();
            Uri uri = new Uri("http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Specialty/ESRI_StateCityHighway_USA/MapServer/1/query?text=&geometry=&geometryType=esriGeometryPoint&inSR=&spatialRel=esriSpatialRelIntersects&relationParam=&objectIds=&where=POP1999%3E15000000&time=&returnCountOnly=true&returnIdsOnly=false&returnGeometry=false&maxAllowableOffset=&outSR=&outFields=STATE_NAME%2CMALES%2CFEMALES%2CPOP1999&f=json");
            webClient.OpenReadCompleted += new OpenReadCompletedEventHandler(webClient_OpenReadCompleted);
            webClient.OpenReadAsync(uri); 
            //RESULT {"count":4}

        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message); 
        }
    }

    void webClient_OpenReadCompleted(object sender, OpenReadCompletedEventArgs e)
    {
        DataContractJsonSerializer ser = null;
        try
        {
            //countertext.Text =  DESERIALIZE COUNT HERE
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message); 
        }

    }

    public class Counter
    {
        public int count { get; set; }
    }
} 
```

看起来应该很简单，但我无法弄清楚。

我想在后台代理期间使用此代码，但我无法在后台代理期间使用 ArcGIS runtime for windows Phone API，因为它是第三方 API。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T00:36:18.880

It should deserialize without a problem:

```
var ser = new DataContractJsonSerializer(typeof(Counter));
Counter r = (Counter) ser.ReadObject(e.Result);

System.Diagnostics.Debug.WriteLine(r.count);  // 4 
```

# python - Python 默认/可选变量

> ID：10693940
> 
> 赞同：0
> 
> 时间：2012-05-21T23:28:39.973
> 
> 标签：python, dictionary, overloading

我正在尝试像这样在python中的字典对象周围编写一个包装器对象

```
class ScoredList():
    def __init__(self,dct={}):
        self.dct = dct

list = ScoredList()
list.dct.update({1,2})

list2 = ScoredList()
list.dct.update({"hello","world"})

print list1.dct, list2.dct # they are the same but should not be! 
```

似乎我无法创建新的 ScoredList 对象，或者更确切地说，每个评分列表对象都共享相同的基础字典。为什么是这样？

```
class ScoredList2():
    def __init__(self):
        self.dct = {} 
```

上面的 ScoredList2 代码工作正常。但我想知道如何在 python 中正确地重载构造函数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T23:30:03.757

字典是一个可变对象。在 Python 中，创建函数时会解析默认值，这意味着将相同的空字典分配给每个新对象。

要解决这个问题，只需执行以下操作：

```
class ScoredList():
    def __init__(self, dct=None):
        self.dct = dct if dct is not None else {} 
```

# c++ - 带有 SCHED_OTHER 的可移植 pthread_setschedparam

> ID：10693942
> 
> 赞同：3
> 
> 时间：2012-05-21T23:28:47.657
> 
> 标签：c++, linux, multithreading, unix, pthreads

我正在为我正在处理的项目组合一个 Unix/Linux 半便携式线程类（即使用 pthread 库）。部分项目需要能够设置某些线程的优先级，以允许同一进程中的其他线程有更多的 CPU 时间；这就是`pthread_setschedparam`功能发挥作用的地方，我的班级碰上了砖墙。

下面是我整理的一个简单测试来说明我的问题：

```
#include <iostream>
#include <unistd.h>
#include <pthread.h>
#include <sched.h>
#include <string.h>
#include <errno.h>

pthread_mutex_t m_mtx;
bool m_goahead;

void dosleep(int millis)
{
    usleep(millis*1000);
}

void domsg(const char *msg)
{
    pthread_mutex_lock(&m_mtx);
    std::cout << msg << std::endl;
    pthread_mutex_unlock(&m_mtx);
}

void dowait() {
    while (!m_goahead) {
        dosleep(1);
    }
}

void *fn1(void *param)
{
    domsg("in fn1...waiting");
    dowait();
    while (m_goahead) {
        dosleep(1000);
        domsg("in fn1 loop");
    }
}

void *fn2(void *param)
{
    domsg("in fn2...waiting");
    dowait();
    while (m_goahead) {
        dosleep(1000);
        domsg("in fn2 loop");
    }
}

int main(int argc, char **argv)
{
    // min prio = -2, max prio = 2
    int t1_pri = 2, t2_pri = 0, main_pri = 1;
    //SCHED_RR, SCHED_FIFO, SCHED_OTHER (POSIX scheduling policies)
    int sched = SCHED_OTHER; // standard
    // get the range between min and max and set the priorities base on split range
    int min = sched_get_priority_min(sched);
    int max = sched_get_priority_max(sched);
    int skip = (max - min) / 5; // 5 since -2...2
    struct sched_param main_param, t1_param, t2_param;
    memset(&main_param, 0, sizeof(sched_param));
    memset(&t1_param, 0, sizeof(sched_param));
    memset(&t2_param, 0, sizeof(sched_param));
    main_param.sched_priority = (min + ((main_pri+2) * (skip+1))) + (skip / 2);
    t1_param.sched_priority = (min + ((t1_pri+2) * (skip+1))) + (skip / 2);
    t2_param.sched_priority = (min + ((t2_pri+2) * (skip+1))) + (skip / 2);
    std::cout << "main thread will have a prio of " << main_param.sched_priority << std::endl;
    std::cout << "t1 thread will have a prio of " << t1_param.sched_priority << std::endl;
    std::cout << "t2 thread will have a prio of " << t2_param.sched_priority << std::endl;
    m_goahead = false;
    pthread_mutex_init(&m_mtx, NULL);
    pthread_t t1, t2;
    // Create the threads 
    if (pthread_create(&t1, NULL, fn1, NULL) != 0) {
        std::cout << "couldn't create t1" << std::endl;
        return -1;
    }
    if (pthread_create(&t2, NULL, fn2, NULL) != 0) {
        std::cout << "couldn't create t2" << std::endl;
        return -1;
    }
    dosleep(1000); // sleep a second before setting priorities
    // --main thread--
    if (pthread_setschedparam(pthread_self(), sched, &main_param) != 0) {
        std::cout << "error setting priority for main thread: (" << errno << "), " << strerror(errno) << std::endl;
    }
    // --t1 thread--
    if (pthread_setschedparam(t1, sched, &t1_param) != 0) {
        std::cout << "error setting priority for T1: (" << errno << "), " << strerror(errno) << std::endl;
    }
    // --t2 thread--
    if (pthread_setschedparam(t2, sched, &t2_param) != 0) {
        std::cout << "error setting priority for T2: (" << errno << "), " << strerror(errno) << std::endl;
    }
    m_goahead = true; // all start
    // loop until user interupt
    for (;;) {
        dosleep(1000);
        domsg("in main loop");
    }
    pthread_mutex_destroy(&m_mtx);
    return 0;
} 
```

基于此代码，如果我编译它并在 OpenBSD 系统上运行它，我会得到以下信息：

```
main thread will have a prio of 24
t1 thread will have a prio of 31
t2 thread will have a prio of 17
in fn1...waiting
in fn2...waiting
in fn1 loop
in main loop
in fn2 loop
in fn1 loop
in main loop
in fn2 loop
in fn1 loop
in main loop
in fn2 loop 
```

注意它是如何按照线程优先级的顺序进行的，fn1，main，fn2 ...

如果我在 Ubuntu 10.04LTS 系统上运行相同的测试，我会得到以下结果：

```
main thread will have a prio of 3
t1 thread will have a prio of 4
t2 thread will have a prio of 2
in fn1...waiting
in fn2...waiting
error setting priority for main thread: (22), Invalid argument
error setting priority for T1: (22), Invalid argument
error setting priority for T2: (22), Invalid argument
in main loop
in fn2 loop
in fn1 loop
in main loop
in fn2 loop
in fn1 loop
in main loop
in fn2 loop
in fn1 loop 
```

我知道无效的参数是因为我指定了`SCHED_OTHER`优先级并试图为其分配除 0 以外的任何数字；我想不通的是我怎样才能使它正常工作？

我已经尝试“假设”一个`SCHED_FIFO`或`SCHED_RR`优先级类来获取最小/最大值，这给了我有效的最小/最大值并且我没有得到“无效参数”错误，但函数循环输出不在优先级中顺序，而是按照函数碰巧被调用的任何顺序（如果没有设置优先级，则可以预期）。

理想情况下，我会获得当前进程的优先级类，然后也分配该类上的线程，但是，如果当前进程的优先级是`SCHED_OTHER`基于该优先级设置线程，则会产生我不想要的无效结果。

是否有更“便携”的方式来设置线程的优先级或获取有效的最小/最大值？我什至可以`SCHED_OTHER`在某些环境下设置线程的优先级，还是该功能留给所述环境？

我在这个问题上陷入了僵局，并希望在正确的方向上提供任何见解或指示。

谢谢，如果我的代码/解释不清楚，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T01:25:43.963

如果它有助于增加理解，请参考[此内容。](https://stackoverflow.com/questions/10657970/pthread-sched-get-priority-min-max-implementation-for-sched-other-sched-fifo)但是我学到的一点是，SCHED_OTHER 是唯一意味着所有非实时线程都将具有相同的优先级。但是在提到的问题中，即使在 SCHED_OTHER 的情况下，BSD 也给出了 max 和 min 0 和 99，不明白为什么，但有一点很清楚，它不是一个非常便携的，并且依赖它的确切值将无济于事。在这种情况下，进行特殊处理会做得更好，例如如果范围为 [0-0]，则使用 nice（如果线程优先级可以通过 nice 固定，请告诉我）用于设置优先级。

谢谢

# html - 将画布导出到视频

> ID：10693954
> 
> 赞同：6
> 
> 时间：2012-05-21T23:30:44.000
> 
> 标签：html, animation, canvas, export

是否可以将画布动画导出到视频？我想构建一个允许创建简单动画的工具，但是我想将它们导出为 .avi .mp4 或任何视频格式。

这可能吗？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-26T01:50:17.210

您可以尝试使用回调函数向 requestAnimationFrame 注册一个侦听器，并在每个循环之后尝试捕获画布 png 文件，使用 html5 的某些持久方法将其保存在服务器端或客户端的某个位置，然后使用其他软件（如 ffmpeg）稍后把它们放在一起形成一个视频文件。

```
 window.requestAnimFrame = (function(callback) {
    return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame ||
    function(callback) {
      window.setTimeout(callback, 1000 / 60);
    };
  })(); 
```

获取画布图像/png信息的代码

```
var canvas = document.getElementById("mycanvas");
var img    = canvas.toDataURL("image/png"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-02-26T03:00:50.157

好的。我知道我迟到了 7 年，但是：现在有一个完全符合您需求的库！

[Whammy.js 对](https://github.com/antimatter15/whammy)视频进行编码。它工作得很好（但如果您还打算实时查看画布，则会减慢您的应用程序）。

如果没有外部库，这很难做到，我不建议使用您自己的库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T23:33:49.057

您可以使用具有画布所在屏幕的预定义区域的屏幕捕获软件。

[http://www.webresourcesdepot.com/10-free-screen-recording-softwares-for-creating-attractive-screencasts/](http://www.webresourcesdepot.com/10-free-screen-recording-softwares-for-creating-attractive-screencasts/)

# c# - 存根或模拟 ASP.NET Web API HttpClient

> ID：10693955
> 
> 赞同：28
> 
> 时间：2012-05-21T23:30:55.220
> 
> 标签：c#, unit-testing, dotnet-httpclient, rhino-mocks

我在一个项目中使用新的 Web API 位，我发现我不能使用 normal `HttpMessageRequest`，因为我需要将客户端证书添加到请求中。结果，我正在使用`HttpClient`（所以我可以使用`WebRequestHandler`）。这一切都很好，除了它不是存根/模拟友好，至少对于犀牛模拟。

我通常会创建一个`HttpClient`我会使用的包装服务，但如果可能的话，我想避免这种情况，因为我需要包装很多方法。我希望我遗漏了一些东西——关于如何存根的任何建议`HttpClient`？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-06-30T12:08:37.597

作为@Raj 已经提出的优秀想法的替代方案，可以降低一步并模拟/伪造它`HttpMessageHandler`。

如果你在构造函数中让任何需要`HttpClient`接受它作为依赖注入参数的类，那么在单元测试时你可以传入一个`HttpClient`已经注入你自己的`HttpMessageHandler`. 这个简单的类只有一个你需要实现的抽象方法，如下：

```
public class FakeHttpMessageHandler : HttpMessageHandler
    {
    public HttpRequestMessage RequestMessage { get; private set; }

    protected override Task<HttpResponseMessage> SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
        {
        RequestMessage = request;
        return Task.FromResult(new HttpResponseMessage(HttpStatusCode.OK));
        }
    } 
```

我的简单示例只是将 in 保存`HttpRequestMessage`在公共属性中以供以后检查并返回 HTTP 200（OK），但是您可以通过添加一个设置您想要返回的结果的构造函数来增加它。

你会像这样使用这个类：

```
public void foo()
    {
    //Arrange
    var fakeHandler = new FakeHttpMessageHandler();
    var client = new HttpClient(fakeHandler);
    var SUT = new ClassUnderTest(client);

    //Act
    SUT.DomSomething();

    //Assert
    fakeHandler.RequestMessage.Method.ShouldEqual(HttpMethod.Get); // etc...
    } 
```

这种方法存在局限性，例如在发出多个请求或需要创建多个`HttpClient`s 的方法中，假处理程序可能开始变得过于复杂。但是，对于简单的情况可能值得考虑。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2014-09-22T23:53:00.937

几个月前我发布了一个名为[MockHttp](http://www.nuget.org/packages/RichardSzalay.MockHttp/)的库，它可能很有用。它使用`HttpMessageHandler`具有流畅（和可扩展）API 的自定义。您可以将模拟处理程序（或 HttpClient）注入您的服务类，它会按照配置进行响应。

下面显示基本用法。`When`and方法有`Respond`很多重载，包括运行自定义逻辑。[GitHub 页面上](https://github.com/richardszalay/mockhttp)的文档更详细。

```
var mockHttp = new MockHttpMessageHandler();

// Setup a respond for the user api (including a wildcard in the URL)
mockHttp.When("http://localhost/api/user/*")
        .Respond("application/json", "{'name' : 'Test McGee'}"); // Respond with JSON

// Inject the handler or client into your application code
var client = new HttpClient(mockHttp);

var response = async client.GetAsync("http://localhost/api/user/1234");
// or without async: var response = client.GetAsync(...).Result;

var json = await response.Content.ReadAsStringAsync();

// No network connection required
Console.Write(json); // {'name' : 'Test McGee'} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-09-03T12:18:30.113

我使用最小起订量，我可以删除 HttpClient。我认为 Rhino Mock 也是如此（我自己没有尝试过）。如果您只想存根 HttpClient，则以下代码应该可以工作：

```
var stubHttpClient = new Mock<HttpClient>();
ValuesController controller = new ValuesController(stubHttpClient.Object); 
```

如果我错了，请纠正我。我想你在这里指的是在 HttpClient 中删除成员。

大多数流行的隔离/模拟对象框架不允许您在非虚拟成员上存根/设置例如以下代码引发异常

```
stubHttpClient.Setup(x => x.BaseAddress).Returns(new Uri("some_uri"); 
```

您还提到您希望避免创建包装器，因为您会包装很多 HttpClient 成员。不清楚为什么需要包装很多方法，但您可以轻松地只包装您需要的方法。

例如 ：

```
public interface IHttpClientWrapper  {   Uri BaseAddress { get;  }     }

public class HttpClientWrapper : IHttpClientWrapper
{
   readonly HttpClient client;

   public HttpClientWrapper()   {
       client = new HttpClient();
   }

   public Uri BaseAddress   {
       get
       {
           return client.BaseAddress;
       }
   }
} 
```

我认为可能对您有益的其他选项（那里有很多示例，所以我不会编写代码）Microsoft Moles Framework [http://research.microsoft.com/en-us/projects/moles/](http://research.microsoft.com/en-us/projects/moles/) Microsoft Fakes：（如果您使用的是 VS2012 Ultimate） [http://msdn.microsoft.com/en-us/library/hh549175.aspx](http://msdn.microsoft.com/en-us/library/hh549175.aspx)

# ruby - HTTP 调用在本地与 AWS 的行为不同——是 ruby 还是 AWS？

> ID：10693959
> 
> 赞同：0
> 
> 时间：2012-05-21T23:31:29.427
> 
> 标签：ruby, http, amazon-ec2, amazon-web-services, sinatra

我正在编写的 API 有一个奇怪的问题。API 已向其他服务发出 http get 请求，并在某些情况下超时 - 在大多数情况下，另一个服务关闭/无法访问。

我正在尝试完全在 AWS 上运行系统，但是当在那里运行 API 时，尝试访问同一实例上的服务时经常出现超时。API 是用 ruby​​+sinatra 编写的；我从来没有遇到过它的 python 前身的问题。如果我从 AWS 实例命令行 curl 其他服务的 url，我永远不会超时。当我在本地运行 API（AWS 上的其他服务）时，它每次都运行良好。

最初我认为这可能是我使用的 http 库-net/http，结果证明即使在本地也有问题。切换到 open-uri 或 rest-client 解决了所有本地问题，但是当我在 AWS 上运行时，我仍然有 20% 的时间出现超时。

API 是 ruby​​+sinatra，使用 open-uri 来做 http 请求。其他服务是 ruby​​+sinatra 或 java。我在 32 位 Amazon Linux 小型实例上运行，ruby 1.9.3，java 1.6；我的本地机器是 Mac，带有 Snow Leopard，带有 ruby​​ 1.9.3 和 java 1.6。

有什么想法或提示可以进一步缩小可能发生的情况吗？

* * *

**更新：我的大 sinatra 应用程序和小 sinatra 应用程序的行为不同！？**

我的 sinatra 应用程序的测试版本调用我的 java 服务，都在 AWS 上运行......工作正常。

```
require 'rubygems'
require 'uri'
require 'open-uri'
require 'sinatra'

set :port, 6969

get '/wtf' do
  xid = params[:xid]
  state = params[:state]
  service_addr = 'http://prod.myserver.com'
  rid = 'xxx'
  json = "{\"state\":\"#{state}\",\"sid\":\"0xac99d8929a89e6c01b56378336dec3a8L\",\"m\":\"set\",\"rid\":\"#{rid}\",\"id\":\"#{xid}\"}"

  paramStr = URI.escape("rid=#{rid}&id=#{xid}&json=#{json}")
  response = open(service_addr+"?"+paramStr)
  status = response.status[0]
  body = response.read

  body
end 
```

大版本，使用 Rack + 作为结构更好的 sinatra 应用程序运行...... 20+% 的时间失败！

```
require 'uri'
require 'open-uri'

class MyApp < Sinatra::Base

  get '/wtf' do
    xid = params[:xid]
    state = params[:state]
    service_addr = 'http://prod.myserver.com'
    rid = 'xxx'
    json = "{\"state\":\"#{state}\",\"sid\":\"0xac99d8929a89e6c01b56378336dec3a8L\",\"m\":\"set\",\"rid\":\"#{rid}\",\"id\":\"#{xid}\"}"

    paramStr = URI.escape("rid=#{rid}&id=#{xid}&json=#{json}")
    response = open(service_addr+"?"+paramStr)
    status = response.status[0]
    body = response.read

    body
  end

end 
```

* * *

**更新 2：使用 mechanize 的详细错误读数 - 总是网关超时**

对于简单版本，它每次都有效（没有超时）。对于复杂的版本，这里有 mechanize 的读数，当它工作时，而不是。

当它工作时：

```
I, [2012-05-22T22:45:53.267464 #11610]  INFO -- : Net::HTTP::Get: /? ### big long get str
D, [2012-05-22T22:45:53.267587 #11610] DEBUG -- : request-header: accept => */*
D, [2012-05-22T22:45:53.267630 #11610] DEBUG -- : request-header: user-agent => Mechanize/2.5.1 Ruby/1.9.3p125 (http://github.com/tenderlove/mechanize/)
D, [2012-05-22T22:45:53.267676 #11610] DEBUG -- : request-header: accept-encoding => gzip,deflate,identity
D, [2012-05-22T22:45:53.267713 #11610] DEBUG -- : request-header: accept-charset => ISO-8859-1,utf-8;q=0.7,*;q=0.7
D, [2012-05-22T22:45:53.267750 #11610] DEBUG -- : request-header: accept-language => en-us,en;q=0.5
D, [2012-05-22T22:45:53.267787 #11610] DEBUG -- : request-header: host => prod.pixieplug.com:9001
I, [2012-05-22T22:45:53.341814 #11610]  INFO -- : status: Net::HTTPOK 1.1 200 OK
D, [2012-05-22T22:45:53.341916 #11610] DEBUG -- : response-header: content-type => application/json;charset=ISO-8859-1
D, [2012-05-22T22:45:53.341962 #11610] DEBUG -- : response-header: transfer-encoding => chunked
D, [2012-05-22T22:45:53.342009 #11610] DEBUG -- : response-header: server => Jetty(8.0.y.z-SNAPSHOT)
D, [2012-05-22T22:45:53.342137 #11610] DEBUG -- : Read 167 bytes (167 total)
98.247.240.63 - - [22/May/2012 22:45:53] "GET /wtf?xid=00:00:00:00:00:17&state=255 HTTP/1.1" 200 167 0.0777 
```

当它没有时：

```
I, [2012-05-22T22:46:23.665908 #11610]  INFO -- : Net::HTTP::Get: /?# long list of params
D, [2012-05-22T22:46:23.666014 #11610] DEBUG -- : request-header: accept => */*
D, [2012-05-22T22:46:23.666053 #11610] DEBUG -- : request-header: user-agent => Mechanize/2.5.1 Ruby/1.9.3p125 (http://github.com/tenderlove/mechanize/)
D, [2012-05-22T22:46:23.666090 #11610] DEBUG -- : request-header: accept-encoding => gzip,deflate,identity
D, [2012-05-22T22:46:23.666125 #11610] DEBUG -- : request-header: accept-charset => ISO-8859-1,utf-8;q=0.7,*;q=0.7
D, [2012-05-22T22:46:23.666161 #11610] DEBUG -- : request-header: accept-language => en-us,en;q=0.5
D, [2012-05-22T22:46:23.666233 #11610] DEBUG -- : request-header: host => prod.pixieplug.com:9001
I, [2012-05-22T22:46:28.675045 #11610]  INFO -- : status: Net::HTTPGatewayTimeOut 1.1 504 Gateway Timeout
D, [2012-05-22T22:46:28.675156 #11610] DEBUG -- : response-header: content-type => application/json;charset=ISO-8859-1
D, [2012-05-22T22:46:28.675195 #11610] DEBUG -- : response-header: transfer-encoding => chunked
D, [2012-05-22T22:46:28.675232 #11610] DEBUG -- : response-header: server => Jetty(8.0.y.z-SNAPSHOT)
D, [2012-05-22T22:46:28.675332 #11610] DEBUG -- : Read 48 bytes (48 total)
Mechanize::ResponseCodeError - 504 => Net::HTTPGatewayTimeOut for http://prod.pixieplug.com:9001/?# long list of params  -- unhandled response:
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/mechanize-2.5.1/lib/mechanize/http/agent.rb:304:in `fetch'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/mechanize-2.5.1/lib/mechanize.rb:407:in `get'
    /home/ec2-user/elphi-api/routes/sandbox.rb:15:in `block in <class:MyApp>'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:1212:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:1212:in `block in compile!'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:785:in `[]'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:785:in `block (3 levels) in route!'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:801:in `route_eval'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:785:in `block (2 levels) in route!'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:822:in `block in process_route'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:820:in `catch'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:820:in `process_route'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:784:in `block in route!'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:783:in `each'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:783:in `route!'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:886:in `dispatch!'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:719:in `block in call!'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:871:in `block in invoke'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:871:in `catch'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:871:in `invoke'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:719:in `call!'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/base.rb:705:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-protection-1.2.0/lib/rack/protection/xss_header.rb:22:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-protection-1.2.0/lib/rack/protection/base.rb:47:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-protection-1.2.0/lib/rack/protection/base.rb:47:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-protection-1.2.0/lib/rack/protection/path_traversal.rb:16:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-protection-1.2.0/lib/rack/protection/json_csrf.rb:17:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-protection-1.2.0/lib/rack/protection/base.rb:47:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-protection-1.2.0/lib/rack/protection/xss_header.rb:22:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:205:in `context'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:200:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/logger.rb:15:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/head.rb:9:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/sinatra-1.3.2/lib/sinatra/showexceptions.rb:21:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/lint.rb:48:in `_call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/lint.rb:36:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/showexceptions.rb:24:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/commonlogger.rb:20:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/chunked.rb:43:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/content_length.rb:14:in `call'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/thin-1.3.1/lib/thin/connection.rb:80:in `block in pre_process'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/thin-1.3.1/lib/thin/connection.rb:78:in `catch'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/thin-1.3.1/lib/thin/connection.rb:78:in `pre_process'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/thin-1.3.1/lib/thin/connection.rb:53:in `process'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/thin-1.3.1/lib/thin/connection.rb:38:in `receive_data'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/thin-1.3.1/lib/thin/backends/base.rb:61:in `start'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/thin-1.3.1/lib/thin/server.rb:159:in `start'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/handler/thin.rb:13:in `run'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/server.rb:265:in `start'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/server.rb:137:in `start'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/bin/rackup:4:in `<top (required)>'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/bin/rackup:19:in `load'
    /home/ec2-user/.rvm/gems/ruby-1.9.3-p125/bin/rackup:19:in `<main>'
98.247.240.63 - - [22/May/2012 22:46:28] "GET /wtf?xid=00:00:00:00:00:17&state=255 HTTP/1.1" 500 157221 5.1385 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T09:08:19.277

这是一个看起来很奇怪的请求，通常 json 数据进入帖子正文而不是查询字符串。让我们尝试使用 mechanize，因为当您使用记录器时它会提供大量调试信息，也许这会帮助您了解问题所在。稍微重构的代码：

```
require 'sinatra/base'
require 'mechanize'
require 'logger'
require 'json'

class Myapp < Sinatra::Base

  AGENT = Mechanize.new
  AGENT.log = Logger.new $stdout

  get '/wtf' do
    rid, sid, xid, state = 'xxx', '0xac99d8929a89e6c01b56378336dec3a8L', params[:xid], params[:state]
    service_addr = 'http://prod.myserver.com/'
    json = {'state' => state, 'sid' => sid, 'm' => 'set', 'rid' => rid, 'id' => xid}.to_json
    response = AGENT.get service_addr, {:rid => rid, :id => xid, :json => json}
    response.body
  end

end 
```

# php - PHP OAuth 扩展“从对等方接收数据时失败”

> ID：10693964
> 
> 赞同：0
> 
> 时间：2012-05-21T23:31:46.937
> 
> 标签：php, oauth

我正在使用 PHP OAuth 扩展连接到 Netflix API 并通过 GET 请求提取数据。

在我的本地机器上运行请求会导致尝试成功并返回正确的数据。

但是，在将请求推送到我们的“实时”服务器后，我立即遇到了 PHP OAuth 扩展失败的问题。

我正在使用带有 curl 作为我的请求方法的扩展程序的 1.2.2 版本（还安装了 libcurl）。我调用 OAuth 提取的 PHP 代码是：

```
$oauth = new OAuth($this->key, $this->secret);
$resource = $oauth->fetch($url, array('v' => '2.0', 'include_tms' => 'true'));
$this->_writeFile($oauth->getLastResponse()); 
```

同样，这个确切的代码在我的本地开发机器上 100% 工作（运行 OS X Lion 的 Mac，通过 MacPorts 安装 php-oauth ......还有版本 1.2.2 ... PHP 5.3.8）。但是，在我们的服务器上运行时（Debian Linux，PHP 5.3.3，通过 apt-get 安装 php-oauth）我收到以下错误：

PHP 致命错误：在 /var/www/familymedia/application/Services/Netflix.php:23 中出现未捕获的异常“OAuthException”和消息“使请求失败（从对等方接收数据时失败）”

我真的不知道该怎么做这个错误。

一些进一步的信息：

我们目前从我们的服务器向其他 API 服务发出成功的 cURL 请求，并每小时返回良好的信息而不会出现问题。但是，这些服务都没有通过 OAuth 进行身份验证，因此它们都不需要 OAuth 扩展，我直接使用 php curl 运行它们。

我觉得我们的实时服务器上的 php-oauth 扩展存在某种设置问题，MacPorts 在我的本地机器上安装期间“神奇地”为我解决了……但我找不到任何安装或配置建议/说明/etc 有帮助。

希望有人有答案或有地方指出我以进一步发现答案...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T03:03:17.633

以为我会用找到的答案更新这个问题：该公司专门阻止来自 Netflix 的入站通信。IT 解决了这个问题。不是一个非常令人兴奋的答案，但就是这样。

# jquery - 显示带有缩略图大小的照片的图像网格

> ID：10693966
> 
> 赞同：0
> 
> 时间：2012-05-21T23:32:03.327
> 
> 标签：jquery

我有一个要求，我必须显示一个网格，其中包含 2 行和 5 列中的缩略图大小的照片。如果有更多图像，我需要一些滚动条来显示其余图像。现在，这些是用户上传的图像，大小可能会有所不同。

有人可以阐明一下我如何将每个图像动态调整为缩略图大小并以网格方式显示它们？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:38:01.310

您将使用或大量借用已经免费提供的众多产品之一，或者很少的钱......就像在这里找到的那​​些：

[http://ibrandstudio.com/inspiration/30-best-jquery-image-gallery-plugins-portfolio-website](http://ibrandstudio.com/inspiration/30-best-jquery-image-gallery-plugins-portfolio-website)

没有意义重新发明轮子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:38:32.310

我认为这是两个不同的问题。)

要从用户上传的图片制作缩略图，您可以使用[PHP GD 库](http://php.net/manual/en/book.image.php)函数 - 或现成的 PHP 脚本，如[phpThumb](http://phpthumb.sourceforge.net/)。

要将这些文件组织到网格中，您可以使用[本讨论](https://stackoverflow.com/questions/8014114/creating-a-grid-of-images-with-jquery)中给出的建议。

# python - Psycopg2 报告 pg_hba.conf 错误

> ID：10693978
> 
> 赞同：19
> 
> 时间：2012-05-21T23:33:23.627
> 
> 标签：python, postgresql, psycopg2

我在尝试使用 PostgreSQL 和 Psycopg2 时遇到了一个奇怪的情况。出于某种原因，每次我尝试通过 python 连接到 postgre 数据库时，都会收到以下错误：

```
psycopg2.OperationalError: FATAL:  no pg_hba.conf entry for host "127.0.0.1", user "steve", database "steve", SSL on
FATAL:  no pg_hba.conf entry for host "127.0.0.1", user "steve", database "steve", SSL off 
```

自然，我检查了 pg_hba.conf 以查看问题所在，但据我所见，一切似乎都配置正确：

**pg_hba.conf：**

```
# TYPE  DATABASE        USER            CIDR-ADDRESS            METHOD

# "local" is for Unix domain socket connections only
local   all             all                                     md5
# IPv4 local connections:
host    all             all             127.0.0.1/32            md5
# IPv6 local connections:
host    all             all             ::1/128                 md5 
```

此外，我发现我可以通过 psql 连接到数据库，正如我所期望的那样：

```
$ psql -U steve -h 127.0.0.1
...
steve=> 
```

有人对这里可能发生的事情有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-21T23:50:31.507

典型的解释包括：

*   您连接到**错误的服务器**。
    数据库服务器是否与 Python 在同一主机上运行？

*   你**弄错了端口**。
    如果您看到连接尝试，请检查服务器日志。当然，您必须为此记录连接。请参阅[配置参数`log_connections`](http://www.postgresql.org/docs/current/interactive/runtime-config-logging.html#GUC-LOG-CONNECTIONS)。

*   更改后您没有**重新加载**(SIGHUP) 服务器`pg_hba.conf`- 或重新加载了错误的集群（如果您有多个数据库集群）。
    在 Debian 及其衍生产品上使用[`pg_ctl`](http://www.postgresql.org/docs/current/interactive/app-pg-ctl.html)or `pg_ctlcluser`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-05-24T01:03:00.833

我最近遇到了同样的问题，我找到了解决这个问题的方法。

**系统：**

1.  例如，我有一个应用程序服务器（安装了这些软件包`python`、`django`和( )）（一个私有地址）。`psycopg2``postgres client 9.6.1``postgresql-9.6.1.tar.gz``ip address 10.0.0.1`
2.  和 AWS postgres RDS 服务器“ `aws_rds_host_name`”或任何数据库 IP 地址。

**错误：**

`django.db.utils.OperationalError: FATAL: no pg_hba.conf entry for host` `"10.0.0.1", user "your_user", database "your_db", SSL off`

**解决方案：**

在应用服务器中安装`postgres client 9.6.1`源码包时`10.0.0.1`，我们必须传递一个参数“ `--with-openssl`”。我建议删除现有的`postgres client`并按照以下步骤安装。

1.  下载`postgres client source package 9.6.1`( `postgresql-9.6.1.tar.gz`)
2.  解压包`postgresql-9.6.1.tar.gz`。
3.  `./configure --prefix="your_preferred_postgres_path_if_needed" --with-openssl (this '--with-openssl'`论点对于摆脱该错误很重要）
4.  制作
5.  进行安装
6.  安装成功后，当我们使用`psycopg2`.

我希望这个解决方案可以帮助某人。

# ruby-on-rails-3 - URL 本身而不是之后的 URL 参数？在 Rails 中

> ID：10693979
> 
> 赞同：1
> 
> 时间：2012-05-21T23:33:34.403
> 
> 标签：ruby-on-rails-3, forms, routes, url-parameters

我在路线中有以下行：

```
match 'area/:area_id/stores', :to => "stores_directory#index", :as => "stores_directory" 
```

我有一个表格，我可以在其中选择 area_id：

```
<%= form_tag stores_directory_path, :method=>:get do %>

<select id="area_id" name="area_id">
....
</select> 
```

这会将 area_id 作为参数广告在 ? 之后。所以，我的问题是：我将如何在**area**和**stores**之间添加它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T05:00:53.030

我看到了一种解决方案（也许不是最好的，但也可以接受）。可以编写自己的中间件来处理这个请求，但我认为这是错误的方式（在这种情况下）。

而是**使用 JS 重定向**

这可以写成一个方法（使用 JQuery 的例子）：

```
$('#area_id option').click(function() {
  if (this.value) { // check value is not empty
    document.location.href = Routes.stores_directory_path({area_id: this.value})
  }
}); 
```

或使用 options_for_select：

```
options = []
areas.each do |a|
  options << [a.to_s, a.id, {:onclick => "document.location.href = Routes.stores_directory_path({area_id: #{a.id}})"}]
end
options_for_select(options) 
```

在这里，我使用[js-routes](https://github.com/railsware/js-routes) gem 来获得漂亮的 url。

希望这会有所帮助。

# plsql - 在 APEX 中运行脚本时出现 PLS-00103

> ID：10693984
> 
> 赞同：1
> 
> 时间：2012-05-21T23:33:58.287
> 
> 标签：plsql, oracle-apex

我正在尝试在 APEX 中运行以下 PLSQL 脚本：

```
DECLARE
    total NUMBER;
BEGIN
    SELECT COUNT(*) 
    INTO total
    FROM one_table;

    FOR i IN 0:100 --This is line 8
    LOOP
        INSERT INTO other_table(id, column_a) SELECT id + i * total, column_a FROM one_table;
    END LOOP;
    COMMIT;
END; 
```

我得到这个错误：

```
ORA-06550: line 8, column 15: PLS-00103: Encountered the symbol "" when expecting one of the following: * & - + / at mod remainder rem .. <an exponent (**)> || multiset The symbol ".." was substituted for "" to continue.' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T23:36:18.947

我不认为这是合法的语法：

```
FOR i IN 0:100 
```

我想你的意思是：

```
FOR i IN 0..100 
```

# android - 如何用新的 sqlite 文件替换 sqlite 文件？安卓

> ID：10693985
> 
> 赞同：1
> 
> 时间：2012-05-21T23:34:07.460
> 
> 标签：android, database, sqlite, overwrite

我的应用程序必须定期更新数据库。

此更新可能不是自动的。当用户访问应用程序时，将检查是否有可用的新数据库。验证后，如果有新版本会提示用户是否要更新数据库。获得许可后，开始下载新文件 sqlite，它将替换旧文件。

新文件与旧文件具有相同的结构，但表中的行数更多。此外，该数据库仅包含一张表。

我正在寻找两天的可行解决方案，但没有发现任何可以帮助我的东西。

提前感谢您的关注！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:36:43.203

您不能更改分布在`.apk`. 您需要在其他地方下载这个附加文件，然后在您的代码中，您必须决定在打开它时使用哪个文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T04:26:35.723

一旦任何`update`可用的`market`用户将下载它，并且如果您的应用程序的新版本其数据库版本不匹配`onUpdate`方法被调用，您可以覆盖它并执行您想做的任何事情。

另一件事你可以`data/data/databases/yourdatabase.db`简单地复制你的数据库`FileOutputStream`

# javascript - 如何安全地将字符串从 Webview Activity 传递到 Android 中正在运行的服务？

> ID：10693986
> 
> 赞同：0
> 
> 时间：2012-05-21T23:34:23.857
> 
> 标签：javascript, android, android-intent, webview, uri

在我的应用程序中，我想从 WebView Activity 传递一个字符串，可能在用户提交表单之后，直接传递给我的应用程序正在运行的服务，该服务有自己的进程。

硬模式：任何恶意应用程序都不应该能够拦截此字符串。

这可能吗？有任何想法吗？

抱歉，我对 Android 有点陌生，所以我不确定我是否有意义。:'(

Heeeelp :-) :-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T07:22:49.410

在 Android 中（如在 Linux 中），每个应用程序都作为单独的用户运行，由 UID 标识。因此，另一个应用程序通常无法访问您的应用程序的文件或进程。简而言之，您无需做任何特别的事情就可以了。如果您的服务已导出（其他应用程序可以使用它），您可能需要使用签名权限或检查调用方的 UID 以确保只有您的 WebView 可以调用该服务，并且没有其他应用程序可以向您发送虚假数据。

在 root 设备上，如果用户允许某些应用程序获得 root 访问权限，它可以转储内存，并且基本上可以做任何事情。然后它可以读取内存中的任何内容，包括您的超级机密字符串。真的没有万无一失的方法来保护这种情况。

# javascript - Jquery 鼠标悬停和淡入功能

> ID：10693987
> 
> 赞同：0
> 
> 时间：2012-05-21T23:34:44.327
> 
> 标签：javascript, jquery

我有这两个功能可以在鼠标悬停时选择我的标签，第一个是左侧：

```
$(function() {
        var $items = $('#vtab>ul>li' || '#vtab2>ul>li');
        $items.mouseover(function() {
            $items.removeClass('selected');
            $(this).addClass('selected');

            var index = $items.index($(this));
            $('#vtab>div' && '#vtab2>div').hide().eq(index).show();
        }).eq(0).mouseover();
    }); 
```

这是右侧的：

```
 $(function() {
        var $items = $('#vtab2>ul>li');
        $items.mouseover(function() {
            $items.removeClass('selected');
            $(this).addClass('selected');

            var index = $items.index($(this));
            $('#vtab2>div').hide().eq(index).show();
        }).eq(0).mouseover();
    }); 
```

然后我有另一个淡入淡出页面的功能：

$(document).ready(function() { $("body").css("display", "none");

```
$("body").fadeIn(3000);

$("a.transition").click(function(event){
    event.preventDefault();
    linkLocation = this.href;
    $("body").fadeOut(2000, redirectPage);
});

function redirectPage() {
    window.location = linkLocation;
} 
```

});

由于某种原因，第二个功能仅在页面淡入时起作用，一旦动画完成，它就会停止工作。如果我使屏幕足够小以至于我无法同时看到两个垂直列表，则第二个功能也可以使用。

有谁知道为什么会这样？我是 jQuery 新手，我真的不知道从哪里开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:50:42.040

我相信您的问题是错误地使用了 javascript 的布尔运算符。$('#vtab>ul>li' || '#vtab2>ul>li');

相当于：$('#vtab>ul>li')

因为 '#vtab>ul>li' 的广义布尔值是 true 并且 "||" 是它找到的第一个 true 的 javascript“或”运算符和“或”短路。

一些相关的事实：

```
true || true || true == true
false || true || false == false
false || 'hey there' || true == 'hey there'
'hey there' || true == 'hey there'
'hey there' && true == true
true && 'hey there' == 'hey there' 
```

# c++ - 什么是 C++ 中的 RND / 种子？

> ID：10693989
> 
> 赞同：2
> 
> 时间：2012-05-21T23:35:03.963
> 
> 标签：c++

我正在尝试使用一些代码..不断收到编译错误`RND not declared in scope`我发现了定义它的部分代码，如果它在 linux 上运行并且如果在 Windows 上定义它从而忽略 Mac 用户（没什么大不了的，我也会忽略它们！）。我删除了那部分代码并使用 linux 设置定义了它（因为我认为我的 Mac 比 windows 更接近 linux），但后来我得到了同样的错误，但对于种子。奇怪的是，这些种子错误与 RND 错误的位置相同。所以我的问题是 RND/Seed 到底是什么？我的搜索发现它们特定于 VB，但不确定它是否有用，因为我使用的是 C++。

这是一个令人反感的代码被剪断（建议观众自行决定）：

`mi = (int)(round(RND*(dimc-1)));`

任何提示/建议都会很棒。我刚刚开始学习 C++，所以我可能会遗漏一些非常简单的东西。

这是整个代码（从这里偷来的[http://cg.iit.bme.hu/~zsolnai/gfx/genetic/](http://cg.iit.bme.hu/~zsolnai/gfx/genetic/)）：

```
// a fast genetic algorithm for the 0-1 knapsack problem
// by karoly zsolnai - keeroy@cs.bme.hu
// test case: 1000 items, 50 knapsack size
//
// compilation by: g++ genetic.cpp -O3 -ffast-math -fopenmp
#include <math.h>
#include <time.h>
#include <algorithm>
#include <vector>
#include <fstream>
#include <limits.h>

#define RND ((double)rand_r(&seed)/RAND_MAX) // reentrant uniform rnd

using namespace std;

struct chromo {
    chromo(int dimc) { items = new bool[dimc]; }
    ~chromo() { items = NULL; }
    void mutate(const int dimc, const int count) {
        int mi;
        for(int i=0;i<count;i++) {
            mi = (int)(round(RND*(dimc-1)));
            items[mi] = !items[mi];
        }
    }
    bool* items;
    int f;
};

int fitness(bool*& x, const int dimc, const vector<int>& v, const vector<int>& w, const int limit) {
    int fit = 0, wsum = 0;
    for(int i=0;i<dimc;i++) {
        wsum += x[i]*w[i];
        fit += x[i]*v[i];
    }
    if(wsum>limit) fit -= 7*(wsum-limit); // penalty for invalid solutions
    return fit;
}

void crossover1p(const chromo& c1, const chromo& c2, const chromo& c3, const int dimc, const int cp) {
    for(int i=0;i<dimc;i++) {
        if(i<cp) { c3.items[i] = c1.items[i]; }
        else { c3.items[i] = c2.items[i]; }
    }
}

void crossover1p_b(const chromo &c1, const chromo &c2, const chromo &c3, int dimc, int cp) {
    for(int i=0;i<dimc;i++) {
        if(i>=cp) { c3.items[i] = c1.items[i]; }
        else { c3.items[i] = c2.items[i]; }
    }
}

void crossoverrand(const chromo &c1, const chromo &c2, const chromo &c3, const int dimc) {
    for(int i=0;i<dimc;i++) {
        if(round(RND)) { c3.items[i] = c1.items[i]; }
        else { c3.items[i] = c2.items[i]; }
    }
}

void crossoverarit(const chromo &c1, const chromo &c2, const chromo &c3, int dimc) {
    for(int i=0;i<dimc;i++) {
        c3.items[i] = (c1.items[i]^c2.items[i]);
    }
}

bool cfit(const chromo &c1,const chromo &c2) { return c1.f > c2.f; }
bool cmpfun(const std::pair<int,double> &r1, const std::pair<int,double> &r2) { return r1.second > r2.second; }

int coin(const double crp) { // a cointoss
    if(RND<crp) return 1; // crossover
    else return 0; // mutation
}

// initializes the chromosomes with the results of a greedy algorithm
void initpopg(bool**& c, const std::vector<int> &w, const std::vector<int> &v, const int dimw, const int limit, const int pop) {
    std::vector<std::pair<int,double> > rvals(dimw);
    std::vector<int> index(dimw,0);
    for(int i=0;i<dimw;i++) {
        rvals.push_back(std::pair<int,double>(std::make_pair(i,(double)v[i]/(double)w[i])));
    }
    std::sort(rvals.begin(),rvals.end(),cmpfun);
    int currentw = 0, k;
    for(int i=0;i<dimw;i++) {
        k = rvals[i].first;
        if(currentw + w[k] <= limit) { // greedy fill
            currentw += w[k];
            index[k] = 1;
        }
    }
    for(int i=0;i<pop;i++) {
        for(int j=0;j<dimw;j++) {
            c[i][j] = index[j];
        }
    }
}

int main() {
    printf("\n");
    srand(time(NULL));
    vector<int> w, v; // items weights and values
    int info=0;
    FILE *f = fopen("1000_weights.txt","r");
    FILE *f2 = fopen("1000_values.txt","r");
    while(!feof(f) || !feof(f2) ) {
        fscanf(f," %d ",&info);
        w.push_back(info);
        info=0;
        fscanf(f2," %d ",&info);
        v.push_back(info);
    } // omitted fclose(f1) and fclose(f2) on purpose
    const int limit = 50; // knapsack weight limit
    const int pop = 250; // chromosome population size
    const int gens = INT_MAX; // maximum number of generations
    const int disc = (int)(ceil(pop*0.8)); // chromosomes discarded via elitism
    const int dimw = w.size();
    int best = 0, ind = 0, ind2 = 0; // a few helpers for the main()
    int parc = 0; // parent index for crossover
    double avg = 0, crp = 0.35; // crossover probability
    vector<chromo> ch(pop,chromo(dimw));
    bool **c = new bool*[pop];
    for(int i=0;i<pop;i++) c[i] = new bool[dimw];
    clock_t start = clock();
    printf("Initializing population with a greedy algorithm...");
    initpopg(c,w,v,dimw,limit,pop);
    printf("done!");
    for(int i=0;i<pop;i++) {
        ch[i].items = c[i];
        ch[i].f = fitness(ch[i].items, dimw ,v, w, limit);
    }
    printf("\n\n");

    for(int p=0;p<gens;p++) {
        std::sort(ch.begin(), ch.end(), cfit);
        #pragma omp parallel for shared(ch)
        for(int i=0;i<pop;i++) {
            if(i>pop-disc) { // elitism - only processes the discarded chromosomes
                if(coin(crp)==1) { // crossover section
                    ind = parc+round(10*RND); // choosing parents for crossover
                    ind2 = parc+1+round(10*RND);
                    // choose a crossover strategy here
                    crossover1p(ch[ind%pop],ch[ind2%pop],ch[i],dimw,round(RND*(dimw-1)));
//                  crossoverrand(ch[ind],ch[ind2],ch[i],dimw);
//                  crossoverarit(ch[0],ch[1],ch[i],dimw);
                    ch[i].f = fitness(ch[i].items, dimw ,v, w, limit);
                    parc += 1;
                }
                else { // mutation section
                    ch[i].mutate(dimw,1);
                    ch[i].f = fitness(ch[i].items, dimw ,v, w, limit);
                }
            }
            avg += ch[i].f;
            if(ch[i].f>best) best=ch[i].f;
        }
        parc = 0;
        if(p%5==0) {
            printf("\n#%d\t",p);
            printf("best fitness: %d \t",best);
            printf("avg fitness: %f",avg/pop);
            if(best == 675) goto end; // psst...don't tell anyone
        }
        best = avg = 0;
    }

end:
    printf("\n\n");
    clock_t end = clock();
    double t = (double)(end-start)/CLOCKS_PER_SEC;
    printf("\nCompletion time: %fs.\n",t);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T23:52:43.783

问题是您不熟练地分割了您拥有的代码：

```
#if defined(__linux) || defined(__linux__)
        unsigned int seed = time(NULL);
        #define RND ((double)rand_r(&seed)/RAND_MAX) // reentrant uniform rnd
#endif

#if defined(WIN32) || defined(_WIN32) || defined(__WIN32__)
        #define RND ((double)rand()/RAND_MAX) // uniform rnd
#endif 
```

这为 Linux 系统*定义*了`seed`基于当前时间的变量；也许Windows系统不需要种子？

无论如何，如果您包含分支中的*两*行`if defined (__linux) ...`，而不是仅一行，它应该可以在您的 OS X 系统上正常工作。

# git - 拉取时删除的忽略的 GIT 文件

> ID：10693992
> 
> 赞同：3
> 
> 时间：2012-05-21T23:35:21.567
> 
> 标签：git

我有一个 git 存储库，其中包含一个完整的用户上传文件的目录。该目录还包含一个 .gitignore `*/`。

我从远程仓库拉取了目录中的所有这些文件，并且没有警告就被删除了。

**什么可能导致这种情况发生？**

我所做的所有研究都告诉我，删除所有这些文件是一种蓄意的行为，不可能是偶然的。这是真的还是有另一个 git 命令会静默删除所有这些文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:19:51.860

.gitignore 是一种方便，可以防止噪音出现在状态报告中或被自动添加`git add .`等等，仅此而已。您可以显式添加一个被忽略的文件，然后 git 无论如何都会关心那个特定的文件，并且在 .gitignore 中命名一个文件不会让 git 停止关心一个已经跟踪的文件。

如果`git pull`删除了文件，则跟踪并删除这些文件。`git checkout "@{may 21 17:30 pdt}"`您可以在拉取时为您签出的提交 取回它们或一些这样的参考。

很可能有人添加了文件，没有提交更改，并强制合并，使孤儿更难找到，但除非有人明确擦除 git 的内存`git fsck --lost-found`，就像旧的取消删除程序一样，它会丢弃你所有的副本曾经在乎过却又被抛弃成`.git/lost-found`。

`git ls-files -ic --exclude-standard`将向您显示与忽略规范匹配的跟踪文件，即有人可能错误地添加或忽略的文件。想一想，对于预提交钩子来说，这可能不是一个坏行，

```
git ls-files -ic --exclude-standard \
| sed '${p;s,.*,*** '"$0"' refusing commit with tracked files marked as ignored in the standard excludes lists,;q1}' 
```

# java - 列表样式选择橙色故障姜饼

> ID：10693993
> 
> 赞同：0
> 
> 时间：2012-05-21T23:35:29.520
> 
> 标签：java, android

在 Gingerbread 上仅使用一个简单的列表 UI 时，我遇到了非常奇怪的故障： ![在此处输入图像描述](../Images/8cda5a0e675ff0ff7017385e7f725595.png)

有谁知道这可能来自哪里？

```
<ListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" /> 
```

行：

```
<TextView
    android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        layout_alignParentTop="true"
        gravity="center_vertical"
        padding="5dp"
        textColor="#FFFFFF"
        typeface="monospace" /> 
```

# javascript - 如何加快追加（）

> ID：10693998
> 
> 赞同：1
> 
> 时间：2012-05-21T23:36:26.117
> 
> 标签：javascript, jquery, append

如果这是一个新手问题，我很抱歉，但我对 Javascript 不是很了解......

所以，这里的代码片段：

```
function insertSquares() {
    for (i = 0; i < 113; i++) {
        $('#wrapper').append('<span><img src="images/square_2.png" style='display: none;'/></span>');
    }
} 
```

如您所见，我有一个循环，每次重复代码时都会将 a`<span>`和 an添加`<img>`到 a上。`<div>`通常，这种附加不是问题，但由于它必须在循环中多次执行此操作，因此需要一段时间。（另外，这个函数被 a 调用了很多次`setInterval()`，它会减慢整个网页的速度）

当使用 JSLitmus 对这个函数进行基准测试时，它运行 5 ops/sec，我想加快速度。我已经考虑过使用循环将数据添加到数组中，（而不是每次都通过循环追加），然后在循环之外时，仅将所有数据追加一次，但这似乎并没有加快速度显着提升该过程。

那么，有什么方法可以加快我没有想到的代码速度吗？我想不出一种更有效的方法来加载和显示这么多相同的图像。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T23:38:04.883

您可以做的最好的事情是等到您完成循环后再对 DOM 进行更改。您当前的方法将锤击 DOM 使其提交，您当然不希望这样。请考虑使用[文档片段](https://developer.mozilla.org/en/DOM/document.createDocumentFragment)。

John Resig 前段时间写过关于 DOM Document Fragments 的文章，但这篇文章仍然是一个很好的入门读物。[您可以在http://ejohn.org/blog/dom-documentfragments/](http://ejohn.org/blog/dom-documentfragments/)上在线找到它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T23:41:47.110

您可以只使用字符串，直到需要附加它。

```
function insertSquares() {
    var html = '';
    for (var i = 0; i < 113; i++) {
        html += '<span><img src="images/square_2.png" style="display: none;"/></span>';
    }
    $('#wrapper').html(html);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T01:32:59.480

为了流畅的性能，我同意@jonathon-sampson 和@timrwood 的观点，即对 DOM 的一种修改比许多人更可取。

也就是说，提高性能的另一种方法是尽量减少插入 DOM 的 html 数量。`<span>`在您的情况下，如果可能的话，我会尝试使用 CSS 类来封装常见的风格元素，将每个元素缩减为一个块。

从：

```
html += '<span><img src="images/square_2.png" style="display: none;"/></span>'; 
```

至：

```
html += '<span class='myclass'></span>'; 
```

正如上面的评论所指出的，如果您可以避免所有这些并处理 DOM 服务器端的创建，那确实是“最佳”解决方案。