# StackOverflow 问答 000628000-000628999

# ruby-on-rails - rails ：这个带有关联条件的多重连接有什么问题？

> ID：628000
> 
> 赞同：4
> 
> 时间：2009-03-09T20:52:46.660
> 
> 标签：ruby-on-rails, ruby, activerecord, join

这是我的模型：

```
class Deck < ActiveRecord::Base
  belongs_to :game
  has_many :deck_cards
end

class DeckCard < ActiveRecord::Base
  belongs_to :card
  belongs_to :deck
end

class Card < ActiveRecord::Base
end 
```

这是我的尝试发现：

```
DeckCard.all :joins => [:card, :deck], :conditions => {{:decks => {:game_id => @game.id}}, {:cards => {:present => true}}} 
```

我不断收到错误消息：#Class:0x4b2a98> 的未定义方法`all`。我假设这是解析我的条件的误导性错误。我正在遵循 Active Record Query 的指南。我不确定是使用单数形式还是复数形式的关联。看起来像 belongs_to 一样，你应该在 :joins 哈希中使用单数形式，但我不确定在 :conditions 哈希中，所以我都尝试了，但都没有成功。

如果不清楚，我在 SQL 中尝试做的是：

```
SELECT * from DeckCards  
INNER JOIN decks on decks.id = deck_cards.deck_id  
INNER JOIN cards on card.id = deck_cards.card_id  
WHERE decks.game_id = 4  
AND cards.present = true 
```

我现在可以通过使用来解决它`DeckCard.find_by_sql`，但是很高兴弄清楚为什么关联的连接和条件不起作用。

我在 Windows 上使用 InstantRails-2.0，它使用的是 Rails 2.0.2

已编辑：改为使用一些进展`DeckCard.find(:all ...)`。我还根据另一个答案编辑了括号。我最新的代码是

```
DeckCard.find :all, :joins => [:card, :deck], :conditions => {:deck => {:game_id => @game.id}, :cards => {:present => true}} 
```

这会产生以下错误：

```
Unknown column 'deck_cards.decks' in 'where clause': SELECT `deck_cards`.* FROM `deck_cards`   INNER JOIN `cards` ON `cards`.id = `deck_cards`.card_id  INNER JOIN `decks` ON `decks`.id = `deck_cards`.deck_id  WHERE (`deck_cards`.`decks` = '--- \n- :game_id\n- 5\n' AND `deck_cards`.`cards` = '--- \n- :present\n- true\n') 
```

连接显示正确，但 WHERE 条件不正确。我已经尝试了一些不同的东西，比如`:deck`或`:decks`在条件子句中，但没有运气。这可能是当前 ActiveRecord 查询接口文档与 2.0.2 中的条件如何完成之间的另一个区别吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T21:06:43.130

您需要完成与 Card 模型的关联：

```
class Card < ActiveRecord::Base
  has_many :deck_cards
end 
```

**编辑 2**：试试这个：

```
 DeckCard.find :all, :joins => [:card, :deck], :conditions => ["decks.game_id = ? and cards.present = ?", @game.id, true] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T21:11:52.807

您`:conditions`包含 2 个哈希值。这是不正确的。您应该有两个键（`:decks`和`:cards`），每个键都应该有一个哈希值。纠正你的看起来像这样：

```
:conditions => {:decks => {:game_id => @game.id}, :cards => {:present => true}} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T21:13:02.587

我没有对此进行测试，但是如果您使用...会发生什么

```
DeckCard.find(:all, :include => [:cards, :deck], :conditions => {:deck => {:game_id => @game.id}, :cards => {:present => true}}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T00:53:11.777

什么版本的导轨？ActiveRecord#all 是在 2.0.2 之后的某个时间添加的。

结果是什么`puts DeckCard.respond_to?(:all)`？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-03T23:38:21.007

你的语法也是倒退的。我相信连接（和连接表）需要按字母顺序排列。因此card_decks。我相信这是rails的默认配置。在我开始使用 has_many => 之前，我遇到过类似的问题：通过

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-17T21:42:45.247

`@game.deck.deckcards.joins(:cards).where('cards.present' => true)`

rails 4 语法要好得多

# sql-server - 在 NOLOCK 上使用 ADO.NET TransactionScope vs ExecuteCommand 的大容量站点，直接读取未提交？

> ID：628004
> 
> 赞同：5
> 
> 时间：2009-03-09T20:54:18.060
> 
> 标签：sql-server, linq-to-sql, transactionscope, nolock, read-uncommitted

刚刚阅读了 Omar 在他的博客 Linq to SQL 上的这篇有趣的文章，[使用未提交的读取来解决事务死锁和查询超时问题](http://msmvps.com/blogs/omar/archive/2009/03/07/linq-to-sql-solve-transaction-deadlock-and-query-timeout-problem-using-uncommitted-reads.aspx)，最后 Javed Hasan 开始与他争论他对大容量站点上无锁情况的解决方案。

这里要解决的问题是，从 sql 的意义上来说，我们需要使用带 NOLOCK 的 Select 语句或使用 SET TRANSACTION LEVEL READ UNCOMMITTED，否则 DB 中的大量行将被锁定并导致错误。Omar 使用的技术是 Linq2Sql，所以问题是我们如何在您的 C# 数据访问代码中实现这一点，这样就不会发生上述情况？

基本上在帖子中，Omar 通过在现实世界的站点上工作和测试以及使用 SqlProfiler 等工具来提出他的解决方案，而 Javed Hasan 则通过 MSDN 文档和 Scott Hanselman 的博客文章等来提出他的解决方案。

奥马尔建议使用以下

```
using (var db = new DropthingsDataContext2())
{
  db.Connection.Open();
  db.ExecuteCommand("SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;");

  var user = db.aspnet_Users.First();
  var pages = user.Pages.ToList();
} 
```

而 Javed Hasan 建议

```
using (new TransactionScope(TransactionScopeOption.Required, 
  new TransactionOptions { IsolationLevel = IsolationLevel.ReadUncommitted }))
{
 //Your db Operation
} 
```

**我很想知道你们在 StatckOverflow 这样的高容量网站上对这个特定问题做了什么，或者 Jeff 和他们的人在这方面做了什么？**

**编辑**：阅读第一篇文章后，我想在 Omar 的文章中指出一些事情。

1.  他的方法确实遇到了连接问题，但他解决了，请参阅他的帖子。
2.  更重要的是，他提到他尝试了使用 ADO.NET Transaction 的方式，甚至尝试了 Scott Hanselman 在他的博客上写的，但它不适用于大容量站点，它会大大降低性能。Omar 说，“System.Transactions 有很大的开销。我从来没有在大容量网站上使用它而不使 CPU 达到 100% 并且 Req/sec 下降到 1/10。它是为企业应用程序设计的，而不是为了高量网站。”

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T21:08:20.427

首先请避免未提交的读取，它们会导致很多问题。一个更好的方法是将数据库设置为[快照隔离](http://msdn.microsoft.com/en-us/library/tcbchxcb(VS.80).aspx)。**这就是杰夫所做**的。

Jeff 基本上说：“bla bla bla，be real，bla bla bla，数据库理论家，bla bla bla，READ UNCOMMITTED 对于不需要数据一致性的真实生产应用程序很有用。” Jeff 不是 DBA，幸运的是这里有很多 DBA。

Omar 方法的问题在于，它可能会将具有“未提交读取”隔离级别的连接泄漏到您的连接池中，这可能会对您的网站造成严重破坏。意思是随机语句可以在未提交的读取中执行。

Javed 方法会更好，因为在处置时 MS 有机会清理连接上的东西。

**编辑**如果您对 Javed 的方法有性能问题，您可以考虑滚动您自己的事务管理器。

您可能想要做的一些事情：

*   持有一堆当前交易
*   提交事务时确认您在创建者线程上
*   在 dispose 时将事务隔离重置为之前的状态
*   如果事务未提交，则在处置时回滚。
*   支持嵌套回滚。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-07-30T06:56:15.457

我是 Microsoft SQL Server 小组工具团队的开发人员。许多应用程序对事务一致性并不是特别敏感，特别是如果您编写一个执行报告的应用程序，或者偶尔不一致的数据不是世界末日的事情。当然，如果您编写财务应用程序或其他对数据不一致的容忍度非常低的东西，您可能想要探索其他解决方案。

如果确实选择使用未提交的读取，我在 C# 中使用扩展方法[写了一个方便的解决方案。](http://ryancoder.blogspot.com/2010/06/execute-linq-queries-without-locking.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-30T20:37:47.047

{我的（糟糕的）声誉阻止我发表评论，所以我把它作为答案}

如果您通过 System.Transactions 使用 IsolationLevel 并在事务块中创建新的 Linq 上下文，SQL Server 最终会尝试调​​用 DTC 来协调事务。这只是发生在我身上，非常出乎意料。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-20T09:22:23.997

关于 .Net 中的事务和 DTC 的（有点令人惊讶的）副作用，Juval Lowy 的这篇文档[介绍了 .NET Framework 2.0 中的 System.Transactions](http://msdn.microsoft.com/en-us/library/ms973865.aspx)很好地解释了事情并且仍然完全有效（.Net4）。值得一读。（我也会发表评论......如果可以的话。）

# c# - C#/ASP.NET helper library

> ID：628012
> 
> 赞同：0
> 
> 时间：2009-03-09T20:56:27.523
> 
> 标签：c#, asp.net

I'm gonna start building a small helper library for my web projects, but not sure what typical features that they should contain (only building web application with C# and ASP.NET). I was thinking of logging features, caching, mail etc. Any other typical features that I should put in it?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T20:58:50.717

If you don't have any features you need yet, why bother writing a helper library? Just add to it as you need to if you want, but placing a bunch of generic classes into a library that may or may not be used just smells bad.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T21:11:05.600

Take a look at that : [Enterprise Library](http://msdn.microsoft.com/en-us/library/cc467894.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T21:05:25.897

Typically a helper library contains anything that isn't application specific, but needs to be accessed by multiple applications.

As you mentioned, some typical uses of a helper library are things like sending email, logging, and maybe caching.

It all depends on how you want to use it.

However you are putting the cart before the horse if you are designing a helper library before you know what you need it to do.

# css - 如何使重叠 Flash 下的 HTML 可访问

> ID：628013
> 
> 赞同：1
> 
> 时间：2009-03-09T20:56:42.860
> 
> 标签：css, flash, xhtml

我有一个带有透明背景的 Flash 标头，包含在 z-index 为 10 的相对定位的 div 中。由此产生的效果允许我的具有透明窗口模式的 Flash 电影重叠并悬停在 HTML 内容上。不幸的是，无法访问不可见 Flash 下面的 HTML。例如，锚将不起作用。一个[例子可以在这里找到](http://www.humanoidwake.com/gear/)。请注意锚链接的最顶部如何不激活悬停状态？我以前见过 Flash 翻转重叠 HTML 内容，而 HTML 仍然正常工作......我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T21:11:18.783

据我所知，没有办法阻止这种情况。重叠的透明图像和 Flash 无法进行每像素点击。您有两种选择，将整个网站设为 Flash，或使用 HTML 获得创意。

例如，您的“齿轮”按钮可以分为两部分；底层图像的 z-index 低于 Flash 标头，并且`<a>`可以为标签指定更高的 z-index，因此链接的实际可点击区域会以不可见的方式悬停在其他所有内容上。

为此，您需要考虑以下几点：

*   负责`<div>`容纳图像，您可以使用一个`<img>`或一个`background-image`样式。
*   和标签必须是分开的，不能嵌套在容器`<div>`中`<a>`
*   `<a>`必须设置样式，以便`display:block;`可以为其指定宽度和高度
*   和必须是相同的高度和`<div>`宽度`<a>`
*   您可能希望使用绝对定位来使它们正确重叠

# mfc - MFC 项目中的虚假内存泄漏

> ID：628021
> 
> 赞同：4
> 
> 时间：2009-03-09T20:58:53.773
> 
> 标签：mfc, memory-leaks

我有一个 MFC 项目，它链接到第三方 dll。在程序退出时，IDE 报告“检测到内存泄漏！” 并倾倒泄漏。

这些泄漏来自第三方 dll。我很确定这些被错误地报道了。（Google 的一项快速检查表明 MFC 在 CRT 销毁文件范围内的变量之前会检查内存泄漏。）

有没有办法禁用内存泄漏检查，只针对那个dll？

回应迄今为止发布的答案

我不认为我在滥用 API。我怀疑的行为可以通过一个简单的项目来重现

1.  使用VS2005
2.  创建一个新的解决方案。
3.  创建一个新项目（MFC 应用程序。）
4.  创建一个新项目（Windows 32 项目，应用程序类型：DLL，导出符号）
5.  在 dll 项目中，导出一个函数。
6.  在dll项目中，定义类Foo如下

这是代码

```
class foo
{
    public:
        foo(void)  { p = new int; };
        ~foo(void) { delete p; }
    private:
        int* p;
}; 
```

在 dll 项目中，创建类 foo 的实例，范围为文件级别。

```
foo g_foo;

// This is an example of an exported function.
TEMPDLL_API int exportedFunction(void)
{
    return 42;
} 
```

在MFC工程中，链接库，调用InitInstance()中导出的函数

运行应用程序，当调用 g_foo 的析构函数时，即使 p 被删除，也会报告内存泄漏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-10T15:53:16.450

找到了我想要的。

*   在项目属性对话框中，在 Linker | 输入
*   将 dll 指定为延迟加载的 DLL。

一旦我这样做了，Visual Studio 就不再报告任何内存泄漏。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T21:03:19.910

这些泄漏是合法的。我会仔细检查 DLL 文档，以确保您不会错过对 DLL 特定清理函数的调用。

# javascript - Javascript 中的对象属性“上一个值”

> ID：628030
> 
> 赞同：2
> 
> 时间：2009-03-09T21:02:37.510
> 
> 标签：javascript, variables, object, oop

我刚刚开始思考整个面向对象的事情，所以请耐心等待。

因此，我看到了一个对象函数（用于 Javascript）的示例，您在其中分配了一个新值，并且该值被分配为该属性的实际值。例子：

```
function Meat (name, color, price) {
    function newPrice (new_price) {
        this.price = new_price;
    }
 this.name = name;
 this.color = color;
 this.price = price;
 this.newprice = newPrice;
 } 
```

很好，花花公子。现在我可以使用 Bacon.price 或 Bacon.newprice 来指定价格。就个人而言，这似乎是最高级别的语义，因为在功能上它做同样的事情。但作为语义编码的倡导者，我会让它滑动。这就是我想要的：

当我更改 Bacon.price 的值时，该对象应包含一个函数，用于将旧值自动存储在名为 oldprice 的属性中。我玩过这个，但无处可去。这是我到目前为止所尝试的：

```
function Meat (name, color, price) {
    function oldPrice () {
        this.oldprice = this.price;
    }
 this.name = name;
 this.color = color;
 this.oldprice = oldPrice;
 this.price = price;
 }

///////////////////////

function Meat (name, color, price) {
    this.name = name;
    this.color = color;
    this.oldprice = this.price;
    this.price = price;
} 
```

或多或少的变化。我认为在分配新值之前引用已经分配的值（第一次不会是什么）就足够了。我知道值（或缺少值）在被分配之前存储在某处，我只是不知道如何引用它以在它被清除之前将其分配给 oldvalue 属性。

* * *

好吧，也许问题出在我的眼睛或手指上。因为我认为我在询问之前已经尝试过这些建议（我知道，我没有提到它们！）除非我真的很困惑，否则这应该有效：

```
function Meat(price)
{

    function setPrice(price)
    {
        this.oldprice = this.price;
        this.price = price;
    }

this.price=setPrice;
}

bacon = new Meat()
bacon.price = "Expensive";
document.write(bacon.price+"<br />");
document.write(bacon.oldprice+"<br />");
bacon.price = "Cheap";
document.write(bacon.price+"<br />");
document.write(bacon.oldprice+"<br />"); 
```

但我得到的输出是： 昂贵的未定义 廉价的未定义

一切都好，直到最后一个。再一次，我愿意接受视力不好和拼写不好的根源。但我无法弄清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T21:07:06.470

这将在您调用时存储它`obj.newPrice(xxx);`- 我认为您在使用时无法自动执行`obj.price = xxx;`

```
function Meat (name, color, price) {
    function newPrice (new_price) {
        this.oldprice = this.price
        this.price = new_price;
    }
 this.name = name;
 this.color = color;
 this.price = price;
 this.newprice = newPrice;
 } 
```

编辑：

正如@Mauris 所指出的，Javascript 1.5 确实支持[getter 和 setter](https://developer.mozilla.org/En/Core_JavaScript_1.5_Guide:Creating_New_Objects:Defining_Getters_and_Setters)（另请参见[此处](http://ejohn.org/blog/javascript-getters-and-setters/)- 您可以将它们视为伪装成属性的方法。

使用这些，您的代码将如下所示：

```
function Meat (name, color, price) {
    function newPrice (new_price) {
        this.oldprice = this.price
        this.price = new_price;
    }
 this.name = name;
 this.color = color;

 this.__defineSetter__("price", function(newprice)
 {
       this.oldprice = this.price
       this.price = price;
 });
 } 
```

不幸的是，Internet Explorer 还不支持这种语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T21:07:52.583

是这样吗？

```
功能设置价格（价格）{
  this.oldprice = this.price;
  this.price = 价格；
}

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-05T02:11:16.773

```
store = (function (prev) {
    callee = arguments.callee;
    return function (curr) {

        console.log("prev:" + prev, "curr:" + curr);
        store = callee(curr);
    }
}(0)) //Initial value

store(1); //Output : prev:0 curr:1 
store(2); //Output : prev:1 curr:2
store(3); //Output : prev:2 curr:3
store(4); //Output : prev:3 curr:4 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T21:14:04.300

考虑一下您要做什么：
1\. 记住旧价格
2\. 将当前价格更改为新价格

由于这是您想要做的两个步骤，因此您需要将它们粘贴在**一个功能**中。您需要首先记住当前价格是多少（在 this.oldprice 中），*然后*更改当前价格（this.price）。来自 RoBorg 和 cherouvim 的响应中包含了执行此操作的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T21:14:57.837

嗯，首先我不太确定你是否正确地执行了 OOP Javascript。OOP Javascript 从一开始就不是真正的面向对象编程，而是使用称为原型的东西来工作：

例如：

```
function Meat (name, color, price) {
       if(arguments.length > 0) 
    {
        this.init(name, color, price);
    }
}

Meat.prototype.init = function(name, color, price) {
    this.name = name;
    this.color = color;
    this.price = price;

    // Initially these are all set to null, 
    // because they don't have an old value yet.
    this.old_name = null;
    this.old_color = null;
    this.old_price = null;
}; 
```

这将构成您的构造函数。

接下来我们需要添加一些方法，以便可以存储您的旧值：

```
Meat.prototype.setName = function(new_name) {
    // Store the old name of the meat
    this.old_name = this.name;
    this.name = new_name;
}; 
```

你会为你肉中的每个属性写一个这样的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T21:15:08.167

由于您刚刚开始使用 OO javascript，请听听以下建议：

不要使用 new 关键字来创建对象。改用函数继承。这样您就可以轻松获取私有变量，而且我认为语法要容易得多。看看这个：

```
var meat = function(name, color, price){
   var that = {};
   var name = name;
   var price = price;
   var color = color;
   var oldPrice = null;
   var setPrice = function(p){
      oldPrice = price;
      price = p;
   };
   var getPrice = function(){ return price;};
   var getOldPrice = function(){return oldPrice;};
   that.getPrice = getPrice;
   that.setPrice = setPrice;
   that.getOldPrice = getOldPrice;
   return that;
}; 
```

你可以像这样使用上面的：

```
var m = meat("chicken", "white", 100);
m.setPrice(50);
var old = m.getOldPrice(); 
```

现在您可能需要 getName 和 setName 方法等。如果您想要继承，您可以执行以下操作：

```
var cow = function(name){
    var that = meat(name, "spotted", 100);
    that.moo = function() { return name +" moooo"; };
    return that;
} 
```

无论如何，我可能已经回答了错误的问题，但也许你会读到这篇文章并看到光明:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T22:02:45.697

JS 中还没有 getter/setter 或运算符重载，因此您确实需要编写一个函数来设置价格并获得那些有趣的副作用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-12T15:31:14.057

您正在覆盖您的价格变量。不要忘记在 javascript 中，您可以将任何内容分配给变量，因为它不是强类型的。所以，你设置它的方式：

```
function Meat(price)
{

    function setPrice(price)
    {
        this.oldprice = this.price;
        this.price = price;
    }

this.price=setPrice; //<-- this assigns the function "setPrice" to the variable "this.price"
}

bacon = new Meat()
bacon.price = "Expensive"; //<-- this overwrites the "price" variable with a string
document.write(bacon.price+"<br />");
document.write(bacon.oldprice+"<br />");
bacon.price = "Cheap";
document.write(bacon.price+"<br />");
document.write(bacon.oldprice+"<br />"); 
```

假设您不需要 IE 支持，您可以（如前所述）使用 getter 和 setter。否则，使用您定义的方法：

```
bacon = new Meat();
bacon.setPrice("Expensive");
document.write(bacon.price+"<br />");
document.write(bacon.oldprice+"<br />");
bacon.setPrice("Cheap");
document.write(bacon.price+"<br />");
document.write(bacon.oldprice+"<br />"); 
```

由于您确实想强制访问这些值，因此我也会为它们编写 getter：

```
bacon.getPrice();
bacon.getOldPrice(); 
```

# java - 方法应该在自定义对象中具有破坏性吗？

> ID：628049
> 
> 赞同：2
> 
> 时间：2009-03-09T21:07:57.230
> 
> 标签：java, oop, polynomial-math

我必须实施 Java.Polynomial 作为学校作业。部分方法是*add(polynomial)*，*multiply(polynomial)*等。

在类似的情况下

```
p.add(q); // computes p + q 
```

返回 void 并将多项式的总和保留在 p 中会更好吗？还是返回多项式并保持以前的 p 值不变更好？

我的直觉告诉我应该做以下事情

*   将 p.add(q) 实现为“破坏性”方法...它将 q 添加到 p 的值并将总和存储在 p
*   还实现了一个静态方法 Polynomial.add(p,q)，它返回多项式的总和。

你怎么看？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T21:14:26.340

就我个人而言，我真的很喜欢不可变类型。我会写`p.plus(q)`而不是`p.add(q)`让它返回一个新的多项式。不变性有很多好处，不仅在线程安全方面（听起来在这种情况下它不会成为问题），而且在对代码的推理方面。如果你知道一旦你隐藏了对它的引用，就没有任何东西可以改变你脚下对象的内容，那么预测会发生什么会容易得多。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T21:13:53.580

这是风格问题。当对象是不可变的时通常会更好（并且“更整洁”），因此方法不是“破坏性的”（它们不是变异器，它们没有副作用）而是返回具有新值的新实例。

最著名的不可变类是 String。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T21:13:07.780

“最好返回一个多项式并保持以前的 p 值不变”

如果你让你的数字类型表现得像其他数字一样，生活会更好。

当您必须通过减少内存分配来优化性能时，“破坏性”操作是必不可少的。

权衡是由于变量中看起来更复杂的状态变化，您的处理变得不透明。您不希望隐藏状态更改；你希望你对变量的赋值是一个大的、明显的一流的、带有-an-=的东西。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T21:19:14.817

所以每个人都说你应该让它不可变，除非有非常具体的性能原因让它可变（你将在一个魔术多项式上添加十亿多项式并且不想要内存分配），不可变是一种方式去。

如果您有真正的性能原因，您可能想要一个破坏性和非破坏性版本，但请记住——这会导致混淆。我认为您关于重载添加的想法是否具有破坏性或不基于数量将使事情变得非常非常混乱。如果您愿意，最好让一切都成为非破坏性的，并制作一个 addDestructive(poly p) 方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T21:15:45.760

即使您使用“破坏性”方法，您仍然希望返回新值以允许函数链接。而且，对于它的价值，当面对 BigInteger 和 BigDecimal 的相同问题时，Sun 决定采用非破坏性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T22:08:06.913

使其不可变，并使接口与 BigInteger 相同（尽可能适用）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-09T22:11:32.773

> *返回 void 并将多项式的总和保留在 p 中会更好吗？*

不错，也不一定更好。

> *还是返回多项式并保持以前的 p 值不变更好？*

更好，更少的惊喜和更容易理解和维护的代码。（尽管您将不得不创建更多变量）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-09T22:30:28.297

多项式在其变量方面具有固定值，因此只有使其不可变才真正有意义。为您的操作返回一个新的多项式。

# windows-xp - 如何在 Windows XP 中的可执行文件上设置处理器关联？

> ID：628057
> 
> 赞同：10
> 
> 时间：2009-03-09T21:10:43.137
> 
> 标签：windows-xp, executable, processor, affinity

我有一个带有第三方应用程序的四核系统，它偶尔会旋转几个进程（总是相同的可执行文件，但它有几个实例）并占用 100% 的 CPU 时间。我还在同一个盒子（IIS 和第三方）上运行了几个 Web 服务。

所有核心都忙的问题是它使这个第三方 Web 服务器超时（IIS 工作正常，只是比平时慢）。我无法控制第三方网络服务器，它是更大产品的一部分并且必须能够运行。因此，我尝试使用处理器亲和性（通过 SysInternals Process Explorer）并将那些讨厌的进程限制为 4 个内核中的 3 个内核，并将第 4 个内核专用于第三方 Web 服务器，它似乎工作得很好。

问题是它只在正在运行的进程上设置亲和力，而不是在可执行级别上，所以在这些进程完成并稍后作为新进程重生之后，它又是一样的——它们占用了所有 4 个内核。因此，我在 Google 上搜索了 Microsoft 提供的这个 ImageCfg.exe 实用程序，但我无法在 Microsoft 网站上找到它以供下载，我看到有些人尝试过它，但现在抱怨它并没有真正起作用。

有没有办法将亲和力与可执行文件联系起来？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-01-23T11:24:55.607

[http://waynes-world-it.blogspot.com/2009/06/processor-affinity-on-windows-server.html](http://waynes-world-it.blogspot.com/2009/06/processor-affinity-on-windows-server.html)

电源外壳

使用 PowerShell 为一个或多个正在运行的进程设置处理器关联。下面有一个示例脚本，将 calc.exe 的处理器掩码设置为前 4 个处理器。我喜欢这种方法，因为脚本很简单，很容易安排，适用于 x86 和 x64，支持同名的多个进程，至少部分是因为它突出了使用 PowerShell 进行管理是多么容易。

请注意，如果您在 calc.exe (n!) 中使用大量的阶乘，您将生成 100% 的 CPU，这对于测试很有用。下面的掩码是 0xf = 1111 – 一个只允许使用前四个处理器的掩码：

```
$calcSet = Get-Process -ProcessName "calc"
foreach ($calc in $calcSet) {$calc.ProcessorAffinity=0xF} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T21:14:58.617

[Process Lasso](http://www.bitsum.com/prolasso.php)的一个功能是在启动进程时设置进程的亲和性。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T21:15:56.383

您可能想查看 的`/AFFINITY`参数`start`。

从帮助：

```
AFFINITY    The new application will have the specified processor
            affinity mask, expressed as a hexadecimal number. 
```

由于 Windows 上的处理器亲和性是一个位掩码，您可能需要进行一些实验，但我假设`1`是第一个核心，因此`7`是前三个核心并且`F`全部是四个。或者`8`只有第四个。

`start`然后，您可以使用适当的参数调用来替换计划任务或快捷方式。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-12T20:42:36.003

ImageCfg.exe 实用程序确实有效。我今天只是用它来解决公司问题。可从[http://www.robpol86.com/pages/imagecfg.php获得](http://www.robpol86.com/pages/imagecfg.php)

Imagecfg -a 0x3 xxx.exe

例如，将 .exe 限制为 CPU0 和 CPU1。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-09T21:15:00.147

使用[SetProcessAffinityMask()](http://msdn.microsoft.com/en-us/library/ms686223.aspx)。请注意，[处理器亲和力是继承的！](http://blogs.msdn.com/oldnewthing/archive/2005/08/17/452630.aspx)

您需要使用 ImageFileExecutionOptions，特别[是“调试器”选项](http://support.microsoft.com/default.aspx?kbid=238788)，并编写自己的小型可执行文件，该可执行文件在其自身上调用 SetProcessAffinityMask()，然后生成一个新进程，即您要为其设置亲和力的进程。将其设置为调试器，您就完成了。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-09T21:16:38.410

您可以使用单进程关联应用程序 shim 将一个处理器强制置于可执行级别，这会将进程强制到一个内核上。

这篇文章[http://msdn.microsoft.com/en-us/library/bb173458.aspx](http://msdn.microsoft.com/en-us/library/bb173458.aspx)有一段关于使垫片朝向底部。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-14T17:58:44.910

显然这个帖子已经过时了，但我还是添加了一条评论，以防万一有人在这个主题上搜索（就像我一样）

> 您可以尝试设置进程的优先级，这样即使它决定使用 100% 的 CPU，在需要时，更高优先级的东西也可以接管。
> 
> 自动执行此操作（而不是必须在任务管理器中播放）是我不久前询问的问题。

start 命令可用于设置进程的启动优先级。

例如。`start "my path\my process" /LOW`为低优先级。

允许的优先级开关 `LOW, NORMAL, HIGH, REALTIME, ABOVENORMAL, BELOWNORMAL`

例如，可以从批处理文件中调用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-09T21:28:29.193

您可以尝试设置进程的优先级，这样即使它决定使用 100% 的 CPU，在需要时，更高优先级的东西也可以接管。

[自动执行此](https://stackoverflow.com/questions/4208/windows-equivalent-of-nice)操作（而不是必须在任务管理器中播放）是我不久前询问的问题。

# php - 在 PHP 中构建管理界面的最快方法是什么？

> ID：628062
> 
> 赞同：4
> 
> 时间：2009-03-09T21:11:28.190
> 
> 标签：php, django, user-interface, frameworks

在 PHP 中构建管理界面的最快方法是什么？

它可以是一个框架，一个库/库加上特定的方法，或者其他什么。

背景：我是一名被自动管理员宠坏的 Django 开发人员，他必须用 PHP 交付一个网络应用程序。该应用程序的管理区域/表单非常繁重，并且具有不同的访问级别。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T21:13:43.613

在 PHP 上，具有管理生成器的[Symfony](http://www.symfony-project.org/)可能是您正在寻找的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T21:25:05.160

我还建议使用 symfony。Zend 对于小项目来说太多了。如果您正在构建博客，请使用 Drupal。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-08T15:39:52.953

我个人会使用[http://agiletoolkit.org/](http://agiletoolkit.org/) 它是在 php 中完成的，但允许您使用我见过的最好的框架之一来构建它。他们有很大的支持，并回答了我所有的问题。

在这个框架可以做什么的表面上查看这个页面。 [http://ui.agiletoolkit.org/](http://ui.agiletoolkit.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T21:32:23.273

如果您坚持为此使用框架，请务必使用[CodeIgniter](http://codeigniter.com/)。它的轻量级[MVC](http://en.wikipedia.org/wiki/Model-view-controller)方法确实让这样的项目变得轻而易举。我使用 PHP 构建了许多数据库驱动的管理应用程序，并且发现 CI 可以节省时间。

当然，完全有可能只使用普通的 PHP 和库来完成这项任务。我已经构建了许多没有框架的管理/管理应用程序。

如果您有其他问题，请告诉我/我们。

`-`尼古拉斯

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T21:16:16.027

也许[CodeIgniter](http://codeigniter.com/)。还没有尝试过，但我有一位同事 (PM) 在工作（一家 Java 商店）总是抱怨如果我们使用 CodeIgniter，他将如何更快更好地完成所有事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T22:35:01.560

最快的方法？手写吧。如果有重用的潜力，首先复制和粘贴，然后重构到库中。如果您非常清楚自己在做什么，这种方法效果最好。否则，一个框架可能就是答案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-10T07:51:46.327

您是否尝试过 QCodo，它会自动执行很多操作。

# pdf - 将 PDF 添加到 AFP 输出

> ID：628078
> 
> 赞同：2
> 
> 时间：2009-03-09T21:15:19.880
> 
> 标签：pdf, ibm-midrange, afp

我们正在尝试获取在 Web 应用程序中创建的 PDF 文件并将其动态插入到 IBM iSeries 上的 AFP 数据流中。有谁知道这是否可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T12:38:16.577

简短的回答并不容易。

有两种方法可以做到这一点。最简单的方法是将 pdf 转换为一系列 tiff 图像并重写 afp 流以将它们包含为 IOCA 图像。如果它们是双色传真 G4 压缩，则可以转换为 IOCA 组 10，而不会太麻烦。

第二种方法是将 pdf 转换为 AFP（这两种格式有很多相似之处）并重写 AFP 流以包含它。如果 PDF 没有嵌入字体，那么将字体映射到 AFP 字体应该不会有太多麻烦。

一开始它可能看起来不太对劲。AFP 允许您比 PDF 更准确地定位元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-13T19:48:45.637

我同意之前的回答，这不是一个“简单”的任务......

但是，如果您熟悉 AFP 结构（或至少愿意学习规范），您可以使用 AFP 的对象容器从技术上将单页 PDF 对象添加到 AFP 中。

但缺点是您需要一个非常现代的 AFP 打印环境来实际处理包含 PDF 对象容器的 AFP。我处理过的大多数打印机都无法处理它。

因此，最好将 PDF 转换为 AFP 并将其合并到父文档中。像 Xenos.com 的 d2e Vision 这样的应用程序将在这方面做得很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-16T18:30:26.403

您可以尝试 COMPART CPMILL，您可以在其中将 PDF 转换为 AFP，然后您可以轻松地将其插入 AFP。我们使用此工具在 AFP 中插入 PNG 图像。

# java - 我在哪里可以找到 AS400 到 Java 的接口？

> ID：628082
> 
> 赞同：5
> 
> 时间：2009-03-09T21:15:59.817
> 
> 标签：java, ibm-midrange, interop

有没有人有从 Java 连接到 AS400 的链接和资源？

我记得几年前，有人告诉我一个连接器，它可以从键盘模拟按键和其他直接连接的“最纯粹”的方法。

在网上我找到了很多链接，但我找不到一个完整的产品来做到这一点（我可能没有使用正确的关键字）。

**编辑**

感谢您的回答：

我们正在寻找的是一种访问 AS400 内部数据和/或它使用的屏幕并将它们公开以供其他新应用程序重用的方法。作为某种 web 服务，或者直接通过 Java（并且 java 将使用 webservices 公开操作）

提前致谢。

**编辑**

根据 MicSim 帖子，我还找到了这个链接：

[http://www.ibm.com/developerworks/library/ws-as400/index.html](http://www.ibm.com/developerworks/library/ws-as400/index.html)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T21:53:19.977

您正在寻找的可能是 IBM 的 Toolbox for Java™ & JTOpen。工具箱中还有一个 AS400 类，用于执行特定的 AS400 任务。您可以[在此处](http://www-03.ibm.com/systems/i/software/toolbox/faqjdbc.html)和[此处](http://publib.boulder.ibm.com/infocenter/iadthelp/v7r0/index.jsp?topic=/com.ibm.etools.iseries.toolbox.doc/as400obj.htm)查看更多详细信息。刚刚google了一下，希望对你有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T22:36:33.023

IBM 的 5250 屏幕抓取技术是“WebFacing”——我会发布一个链接，但你最好用谷歌搜索它，因为 IBM 的文档非常分散。还有其他可用的技术，但是：屏幕抓取从来都不是任何人的最爱，因为通常你最终会得到一些东西，虽然它看起来更最新，但实际上比绿屏更难使用，而且没有更多功能。5250 可能是我用过的最好的数据输入平台——浏览器中的 Web 表单是最差的之一。

如前所述，jt400 是处理大多数其他事情的方式。尤其：

JDBC - 适用于所有 SQL。如果你做对了并且处理你的文件，就好像它们真的是表格一样，这是一种完全摆脱 400 的方法。

Record-level access - write Java programs using a similar database API to RPGLE (all those chains, setlls that 400 programmers love)

Call programs, system commands, manage resources (data queues, data areas, prints / spools, jobs etc etc)

Good luck

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T21:50:41.857

这显然取决于您想要做什么，但是如果您想通过网络连接到 AS400 进程来模拟击键，那么 Expect4j 可能是您正在寻找的库。

不过，这通常是一个非常讨厌的 hack，并且通常有更好的方法来实现您的目标。你想做什么？

可以在[这里找到 expect4J 库。](http://expectj.sourceforge.net/)Expect 最初是一个 unix 命令，它允许您指定您希望看到的字符串，然后指定要返回的字符串。它经常用于自动登录等和屏幕抓取应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T22:03:37.177

如果您只想在 AS/400（或 iSeries、System i 或 IBM 营销部门本月决定将其命名的任何名称）上运行 Java，那么这是一种受支持的语言。您可以直接访问伪 DB2 数据库。或者您是否正在寻求其他形式的整合？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-28T07:01:06.987

Even better is the [TN5250j](http://tn5250j.sourceforge.net/) Console, which can be used to extract data from the AS/400.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-04T00:42:08.870

jacada makes tools to do what your looking for

[http://www.jacada.com/](http://www.jacada.com/)

# c# - 如何从 Team Explorer 获取默认的 TFS 服务器？

> ID：628090
> 
> 赞同：1
> 
> 时间：2009-03-09T21:19:46.437
> 
> 标签：c#, .net, tfs, vsx

像这样的调用需要服务器名称或 url：

```
TeamFoundationServerFactory.GetServer("mytfsserver"); 
```

同样，我可以使用以下内容获取可用服务器或服务器名称的列表：

```
TeamFoundationServer[] servers = RegisteredServers.GetServers();
string[] serverNames = RegisteredServers.GetServerNames(); 
```

但是如何获取 Team Explorer 用于连接的默认服务器？

或者，如果我可以获得当前工作区，我想我可以使用它来获得正确的 TeamFoundationServer 进行连接。但是，我希望能够在加载解决方案之前执行此操作，这意味着我没有用于查询它所属的工作区的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T21:28:15.373

不确定默认值（这只是 VS 上次保存其配置时连接到的服务器 Team Explorer），但您可以获取具有当前文件夹映射的服务器。

```
var wsp = Microsoft.TeamFoundation.VersionControl.Client.Workstation.GetLocalWorkspaceInfo(path)
var server = wsp.ServerUri 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T21:29:13.653

请参阅以下内容：http: [//blogs.msdn.com/hippietim/archive/2006/03/29/563988.aspx](http://blogs.msdn.com/hippietim/archive/2006/03/29/563988.aspx)

# java - 为什么当类存在时会抛出这个 NoClassDefFoundError ？

> ID：628094
> 
> 赞同：1
> 
> 时间：2009-03-09T21:22:32.827
> 
> 标签：java, generics, netbeans

我试图创建一个可以在我的程序中使用的通用 Observable 类：

```
public class GeoGolfObserver<T> extends Observable
{
    public GeoGolfObserver()
    {
        super();
    }

    public void passObject(T object)
    {
        setChanged();
        notifyObservers(object);
    }
} 
```

它是使用以下方法创建的：

```
GeoGolfObserver<Cache> cacheObserver = new GeoGolfObserver<Cache>(); // [1]
cacheObserver.addObserver(this);
new CreateCache(cacheObserver).setVisible(true); 
```

这被传递给 CreateCache 类的构造函数：

```
public CreateCache(GeoGolfObserver<Cache> cacheObserver) {
    initComponents();
    bindList();
    this.cacheObserver = cacheObserver;
} 
```

但是，上面标记为 [1] 的行会引发错误：

```
线程“AWT-EventQueue-0”中的异常 java.lang.NoClassDefFoundError: Common/GeoGolfObserver
```

为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T21:26:47.483

在类路径中找不到您的类之一。具体来说，`GeoGolfObserver`如果我正确理解您的错误。

检查您在类路径中是否有对所有类的有效引用，以及它们各自的 JAR/类文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T12:44:01.963

**固定的**

通过简单地告诉 netbeans 对我的应用程序进行干净的重建，这个问题得到了解决。谢谢你们的评论。

# ruby - Ruby：文件行的长度（以字节为单位）？

> ID：628096
> 
> 赞同：1
> 
> 时间：2009-03-09T21:23:37.410
> 
> 标签：ruby, byte

我正在写这个小 HelloWorld 作为[对此](https://stackoverflow.com/questions/625733)的后续，并且数字不加起来

```
filename = "testThis.txt"
total_bytes = 0
file = File.new(filename, "r")
file.each do |line|
  total_bytes += line.unpack("U*").length
end
puts "original size #{File.size(filename)}"
puts "Total bytes #{total_bytes}" 
```

结果与文件大小不同。我想我只需要知道`format`我需要插入什么......或者我可能完全错过了这一点。**如何逐行测量文件大小？**

注意：我在 Windows 上，文件被编码为 ANSI 类型。

**编辑：**这会产生相同的结果！

```
filename = "testThis.txt"
total_bytes = 0
file = File.new(filename, "r")
file.each_byte do |whatever|
  total_bytes += 1
end
puts "Original size #{File.size(filename)}"
puts "Total bytes #{total_bytes}" 
```

所以现在任何可以提供帮助的人...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T23:32:48.270

您可以尝试 IO#each_byte，例如

```
total_bytes = 0
file_name = "test_this.txt"
File.open(file_name, "r") do |file|
  file.each_byte {|b| total_bytes += 1}
end
puts "Original size #{File.size(file_name)}"
puts "Total bytes #{total_bytes}" 
```

当然，这不会一次给你一行。你最好的选择可能是通过文件`each_byte`直到你遇到`\r\n`. IO 类提供了许多可能有用的非常低级的读取方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T00:07:37.703

IO#gets 的工作方式与从命令行捕获输入相同：“Enter”不作为输入的一部分发送；在 File 或 IO 的其他子类上调用 #gets 时也不会通过，因此这些数字肯定不会匹配。

请参阅相关的[镐部分](http://www.rubycentral.com/pickaxe/ref_c_io.html)

我可以问一下您为什么如此担心行长与文件大小的总和吗？你可能正在解决一个比必要的更难的问题......

啊哈。我想我现在明白了。

缺少一个方便的 iPod（或任何其他类型，就此而言），我不知道您是否想要精确的 4K 块，在这种情况下 IO#read(4000) 将是您的朋友（4000 或 4096？）或者如果您更乐意按行打破，在这种情况下，这样的事情应该可以工作：

```
class Chunkifier
  def Chunkifier.to_chunks(path)
    chunks, current_chunk_size = [""], 0
    File.readlines(path).each do |line|
      line.chomp! # strips off \n, \r or \r\n depending on OS
      if chunks.last.size + line.size >= 4_000 # 4096?
        chunks.last.chomp! # remove last line terminator
        chunks << ""
      end
      chunks.last << line + "\n" # or whatever terminator you need
    end
    chunks
  end
end

if __FILE__ == $0
  require 'test/unit'
  class TestFile < Test::Unit::TestCase
    def test_chunking
      chs = Chunkifier.to_chunks(PATH)
      chs.each do |chunk|
        assert 4_000 >= chunk.size, "chunk is #{chunk.size} bytes long"
      end
    end
  end
end 
```

请注意使用 IO#readlines 将所有文本一次性获取：#each 或 #each_line 也可以。我用过字符串#chomp！以确保无论操作系统在做什么，最后的字节都被删除，以便 \n 或任何可以强制进入输出。

我建议使用 File#write，而不是 #print 或 #puts 作为输出，因为后者倾向于提供特定于操作系统的换行符序列。

如果您真的关心多字节字符，请考虑使用 each_byte 或 unpack(C*) 选项和猴子修补字符串，如下所示：

```
class String
  def size_in_bytes
    self.unpack("C*").size
  end
end 
```

顺便说一句，解包版本比我机器上的 each_byte 快大约 8 倍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T21:51:39.980

您可能在这里遇到几个重叠的问题：

1.  换行字符`\r\n`与`\n`（根据您之前的帖子）。还有EOF文件字符（^Z）？

2.  问题陈述中“大小”的定义：您的意思是“多少个字符”（考虑到多字节字符编码）还是“多少个字节”？

3.  `$KCODE`全局变量 的交互（在 ruby​​ 1.9 中已弃用。`String#encoding`如果您在 1.9 下运行，请查看和朋友）。例如，您的文件中是否有重音字符？

4.  您的格式字符串`#unpack`. `C*`如果你真的想计算字节数，我想你想在这里。

还要注意`IO#each_line`(只是这样你就可以扔掉`while`并变得更加 ruby​​ 惯用 ;-)) 的存在。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T06:43:29.367

问题是当您在 Windows 上保存文本文件时，您的换行符是两个字符（字符 13 和 10），因此是 2 个字节，当您将它保存在 linux 上时只有 1 个（字符 10）。但是，ruby 将这两个字符都报告为单个字符 '\n' - 它表示字符 10。更糟糕的是，如果您在带有 windows 文件的 linux 上，ruby 会给您两个字符。

因此，如果您**知道**您的文件始终来自 Windows 文本文件并在 Windows 上执行，则每次获得换行符时，您都可以将计数加 1。否则，它是几个条件和一个小状态机。

顺便说一句，没有 EOF '字符'。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T21:38:08.517

```
f = File.new("log.txt")
begin
    while (line = f.readline)
        line.chomp
        puts line.length
    end
rescue EOFError
    f.close
end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-30T21:42:05.870

这是一个简单的解决方案，假设当前文件指针设置为读取文件的行首：

```
 last_pos = file.pos
    next_line = file.gets
    current_pos = file.pos
    backup_dist = last_pos - current_pos
    file.seek(backup_dist, IO::SEEK_CUR) 
```

在此示例中，“文件”是您正在读取的文件。要在循环中执行此操作：

```
 last_pos = file.pos
    begin loop
        next_line = file.gets
        current_pos = file.pos
        backup_dist = last_pos - current_pos
        last_pos = current_pos
        file.seek(backup_dist, IO::SEEK_CUR)
    end loop 
```

# iphone - 使用动画从 SuperView 中删除 UIVIew

> ID：628099
> 
> 赞同：7
> 
> 时间：2009-03-09T21:26:29.200
> 
> 标签：iphone, cocoa-touch, uiview, core-animation

我可以为我的应用添加 UIView 动画，它看起来非常漂亮，所以谢谢苹果。

但是，如何为从超级视图中删除此视图设置动画？

我正在使用：

```
CATransition *animation = [CATransition animation];
[animation setDuration:1];
[animation setType:kCATransitionReveal];
[animation setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn]];
[[myview layer] addAnimation:animation forKey:kCATransitionReveal]; 
```

动画“in”过渡......你如何动画“out”过渡？？？？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-09T21:33:47.497

为您的视图设置动画，使其移出屏幕/缩小/展开/淡入淡出，然后在动画结束时进行实际移除。

您可以通过在 beginAnimations/commitAnimations 块之间更改视图的属性（位置/大小/偏移）来做到这一点。UIKit 然后将在指定的时间内为这些属性设置动画。

例如类似的东西；

```
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.30f];
view.transform = 
  CGAffineTransformMakeTranslation(
    view.frame.origin.x, 
    480.0f + (view.frame.size.height/2)  // move the whole view offscreen
  );
background.alpha = 0; // also fade to transparent
[UIView commitAnimations]; 
```

在动画结束通知中，您可以删除视图。

# iphone - 如何开始为 iPhone OpenGL ES 开发实现我自己的 VGP 代码？

> ID：628104
> 
> 赞同：1
> 
> 时间：2009-03-09T21:27:10.273
> 
> 标签：iphone, opengl-es

我如何开始为 iPhone OpenGL ES 开发实现我自己的顶点几何处理器代码，以便充分受益于其 VGP Lite 芯片？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T21:36:51.343

iPhone 芯片只能用于固定功能处理，作为法线变换和光照管线的一部分。无法运行自定义顶点程序。

# javascript - 如何在 JavaScript 中解析 excel 文件？

> ID：628114
> 
> 赞同：6
> 
> 时间：2009-03-09T21:34:25.233
> 
> 标签：javascript, html, excel, parsing

我正在尝试编写一个小型 Web 工具，它需要一个 Excel 文件，解析内容，然后将数据与另一个数据集进行比较。这可以在 JavaScript 中轻松完成吗？是否有执行此操作的 JavaScript 库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T21:44:23.913

首先，您将如何将文件加载到 JavaScript 中？

此外，Excel 是一种专有格式，并且足够复杂，以至于经过多年开发的服务器端库（例如[Apache POI](http://poi.apache.org/)）尚未设法正确 100% 地对这些 Microsoft 格式进行逆向工程。

所以我认为答案是你不能。

**更新：**那是纯 JavaScript。

**更新 2：**现在可以在 JavaScript 中加载文件：[https ://developer.mozilla.org/en-US/docs/DOM/FileReader](https://developer.mozilla.org/en-US/docs/DOM/FileReader)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-07T01:54:56.067

在过去的四年里，取得了许多进步。HTML5 File API 已被主要浏览器供应商采用，性能增强实际上使在浏览器中解析 excel 文件（xls 和 xlsx）成为可能。

我在这个空间的条目：

*   [http://oss.sheetjs.com/js-xls/](http://oss.sheetjs.com/js-xls/) (xls)
*   [http://oss.sheetjs.com/js-xlsx/](http://oss.sheetjs.com/js-xlsx/) (xlsx)

两者都是纯 JS 解析器

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-09T21:45:22.493

要在 js 中完成所有操作，您必须使用 ActiveX，并且可能还需要使用 Office Web 组件。只是一个建议，但您可能不想走这条路；这将是低效的，只有 IE/Win。使用基于服务器的解决方案会更好。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-16T12:53:13.027

您将需要使用 ActiveX（请参阅 W3C Schools 关于 AJAX 的使用）并在托管计算机 Dataconnectors（仅托管该文件的计算机）中注册文件。与前面提到的不同，此方法不依赖于 Microsoft 平台（无论如何对于客户端），并且您不需要安装 Office 组件。

对于在 Windows 中注册的大多数数据文件（包括 MDB），都可以这样做，并且允许您进行尽可能多的控制，因为您可以为不同的目的分配不同的 Windows 帐户。

就像我之前说的，这一切都是服务器端的，对客户端没有影响，除了可能检索凭据、操作等等。

此方法使用 JavaScript、SQL（不，甚至不是 MSSQL，只是 SQL 标准），并且只需要主机运行任何 Microsoft NT 平台。

Windows 数据连接器所做的是为各种数据组件提供通用接口，就像 DirectX 为视频卡和其他外围设备所做的那样。您还可以使用它将 MDB (Microsoft Access) 链接到 MySQL 服务器并以这种方式实时提供数据，我相信这比使用 XLS 电子表格更简单……尤其是因为您可以将 XLS 导入 MDB。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-11T04:19:16.390

你*真的*需要一个Excel文件吗？为什么不使用 Excel 以 CSV 或 XML 格式导出数据并加载呢？

Excel 文件格式非常特定于 Excel 的实现。如果您只需要数据，请使用仅包含数据的文件格式。

# c# - 在c#中动态改变css样式？

> ID：628115
> 
> 赞同：2
> 
> 时间：2009-03-09T21:34:41.503
> 
> 标签：c#, asp.net

我有一些链接按钮，我在其中动态添加样式。我在一种方法中执行以下操作：

```
LinkButton lb = new LinkButton();
lb.Style["font-weight"] = "bold"; 
```

当单击另一个链接时，它应该取消加粗的链接按钮，并加粗当前单击的链接按钮，因此在执行此操作的方法中，我尝试过：

```
lb.Style["font-weight"] = "none"; 
```

上面的方法不起作用，之前选择的链接保持粗体。

我刚刚意识到可能的问题。我正在创建多个链接，它看起来是因为所有链接都命名为 lb，它永远不会删除粗体。我正在想办法让它记住以前选择的链接，并且只取消那个链接。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T21:39:57.467

我可以建议一种替代方法吗？

设置 CSS 样式：

```
.selected { font-style: bold; } 
```

单击链接时，将该链接的 CSS 类设置为“已选择”，将其他链接设置为“”；

**编辑：以适应现有的 Css 类**

```
const string MY_CLASS = "links";
lb1.CssClass = MY_CLASS + " selected"; // selected
lb.CssClass = MY_CLASS; // not selected 
```

定义内联样式时很快就会遇到麻烦，因为它们很难被覆盖。

**编辑2：**

像这样的代码应该可以工作。您可能必须遍历列表中的所有 LinkBut​​ton，但我不这么认为。我只是关闭 LinkBut​​tons 上的 ViewState。

```
// container for links. so you can reference them 
// outside of the creation method if you wish. I'd probably call this method in the  
// Page_Init Event.

List<LinkButton> listOfLinks = new List<LinkButton>();
const string MY_LB_CLASS = "linkButton"; // generic lb class

private void createSomeLinks() {

    for (int i = 0; i < 10; i++) {
        // create 10 links.
        LinkButton lb = new LinkButton() 
        { 
            ID = "lb" + i, 
            CssClass = MY_LB_CLASS 
        };
        lb.Click += new EventHandler(lb_Click); // Add the click event
    }

    // You can bind the List of LinkButtons here, or do something with them.
}

void lb_Click(Object sender, EventArgs e) {

    LinkButton lb = sender as LinkButton; // cast the sender as LinkButton
    if (lb != null) {
        // Make the link you clicked selected.
        lb.CssClass = MY_LB_CLASS + " selected"; 
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T21:39:05.347

试试 lb.Style.Remove("font-weight")。我没测试过，你可以试试。

或者，您是否尝试过设置 Font.Bold 属性？

```
lb.Font.Bold = true; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T21:38:13.337

尝试`ListBox1.Attributes.Add("style","font-weight:bold");` 并`ListBox1.Attributes.Add("style","font-weight:normal");`

甚至更好的是

// CSS

```
.active {font-weight:bold}
.notactive {font-weight:normal} 
```

//C＃

```
ListBox1.CssClass = "active";
ListBox1.CssClass = "notactive "; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T21:47:02.270

你可以试试 lb.Style.Remove("font-weight");

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T14:49:51.783

在链接按钮的单击事件中设置粗体字体，并在单击事件本身中将启用视图状态属性设置为 false，这将在另一次单击中将链接重置为正常泡沫

# .net - 动态使用 typeof

> ID：628119
> 
> 赞同：0
> 
> 时间：2009-03-09T21:36:04.807
> 
> 标签：.net, reflection

我正在使用反射来获取对象的属性，这没有任何困难，但我需要让我的类更加通用，所以基本上我想要做的是以下内容：

```
PropertyInfo[] properties = (typeof ("ObjectName")).GetProperties(BindingFlags.Public | BindingFlags.Instance); 
```

或类似的东西。注意在 typeof 中使用了一个字符串。我知道这不起作用，这只是为了展示我想要完成的事情。我也试过：

```
public void Test(object myObject)  
{  
    typeof(myObject.GetType());  

    Type myType = myObject.GetType();
    typeof(myType);
} 
```

没有成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T21:38:18.233

听起来你可能想要[`Type.GetType`](http://msdn.microsoft.com/en-us/library/system.type.gettype.aspx)或[`Assembly.GetType`](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.gettype.aspx). 对前者的一个警告 - 除非类型在调用程序集或 mscorlib 中，否则您需要提供程序集名称以及类型名称 - 请参阅[今天早些时候的这个问题](https://stackoverflow.com/questions/626115/c-doubt-in-gettype-managed-codegen)以获取示例。

或者，在您的示例代码中，您是否`myObject.GetType()`真的可以满足您的所有需求？目前尚不清楚*您*要在这里实现什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T21:39:07.297

如果您只想获取有`Type`问题的对象，请使用该`object.GetType()`方法，如下所示：

```
Type myType = myObject.GetType();

PropertyInfo[] properties = myType.GetProperties(
    BindingFlags.Public | BindingFlags.Instance); 
```

这假设您已经拥有该类型的实例，但您不知道在编译时该类型是什么，或者它可以是任何类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T21:39:17.110

您需要静态**Type.GetType**方法。例如：

```
Type t=Type.GetType("System.String"); 
```

# python - Django 表单预览 - 如何使用“cleaned_data”

> ID：628132
> 
> 赞同：4
> 
> 时间：2009-03-09T21:39:21.337
> 
> 标签：python, django, django-models, django-forms

感谢 Insin 回答了与此相关的上一个[问题](https://stackoverflow.com/questions/625800/django-form-preview-adding-the-user-to-the-form-before-save)。

他的回答很有效，而且效果很好，但是，我对“cleaned_data”的提供感到困惑，或者更准确地说，如何使用它？

```
class RegistrationFormPreview(FormPreview):
    preview_template    = 'workshops/workshop_register_preview.html'
    form_template       = 'workshops/workshop_register_form.html'

    def done(self, request, cleaned_data):
        # Do something with the cleaned_data, then redirect
        # to a "success" page. 

        registration            = Registration(cleaned_data)
        registration.user       = request.user
        registration.save()
        # an attempt to work with cleaned_data throws the error: TypeError 
        # int() argument must be a string or a number, not 'dict'
        # obviously the fk are python objects(?) and not fk_id
        # but how to proceed here in an easy way?

        # the following works fine, however, it seems to be double handling the POST data
        # which had already been processed in the django.formtools.preview.post_post
        # method, and passed through to this 'done' method, which is designed to 
        # be overidden.
        '''
        form                    = self.form(request.POST)   # instansiate the form with POST data
        registration            = form.save(commit=False)   # save before adding the user
        registration.user       = request.user              # add the user
        registration.save()                                 # and save.
        '''

        return HttpResponseRedirect('/register/success') 
```

为了快速参考，这里是 post_post 方法的内容：

```
def post_post(self, request):
    "Validates the POST data. If valid, calls done(). Else, redisplays form."
    f = self.form(request.POST, auto_id=AUTO_ID)
    if f.is_valid():
        if self.security_hash(request, f) != request.POST.get(self.unused_name('hash')):
            return self.failed_hash(request) # Security hash failed.
        return self.done(request, f.cleaned_data)
    else:
        return render_to_response(self.form_template,
            {'form': f, 'stage_field': self.unused_name('stage'), 'state': self.state},
            context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T23:46:11.767

我以前从未尝试过您在这里使用 ModelForm 执行的操作，但是您可以使用 ** 运算符将您的cleaned_data 字典扩展为您的 Registration 构造函数所需的关键字参数：

```
 registration = Registration (**cleaned_data) 
```

模型类的构造函数采用关键字参数，Django 的模型元类将其转换为结果对象的实例级属性。** 运算符是一种调用约定，它告诉 Python 将您的字典扩展为这些关键字参数。

换句话说...

你目前在做的事情无异于这样：

```
registration = Registration ({'key':'value', ...}) 
```

这不是您想要的，因为构造函数需要关键字参数，而不是包含关键字参数的字典。

你想做的是这个

```
registration = Registration (key='value', ...) 
```

这与此类似：

```
registration = Registration (**{'key':'value', ...}) 
```

同样，我从未尝试过它，但只要您不对表单做任何花哨的事情，例如向其添加注册构造函数不期望的新属性，它似乎就可以工作。在这种情况下，您可能必须在执行此操作之前修改 clean_data 字典中的项目。

不过，通过表单预览实用程序，您似乎失去了 ModelForms 中固有的一些功能。或许您应该将您的用例带到 Django 邮件列表中，看看是否有对该 API 的潜在增强功能可以使其更好地与 ModelForms 一起使用。

**编辑**

除了我上面描述的内容之外，您始终可以“手动”从您的 clean_data 字典中提取字段并将它们也传递到您的 Registration 构造函数中，但需要注意的是，您必须记住在添加新代码时更新此代码字段到您的模型。

```
registration = Registration (
    x=cleaned_data['x'],
    y=cleaned_data['y'],
    z=cleaned_data['z'],
    ...
) 
```

# membership - ASP.NET 中的 Membership、MembershipProvider 和 MembershipUser 关系？

> ID：628137
> 
> 赞同：8
> 
> 时间：2009-03-09T21:40:41.600
> 
> 标签：membership, membership-provider

我将用户数据存储在名为 Users 的 MSSQL 表中。我想要的是访问实际登录用户的所有用户数据（电子邮件、地址、电话，如果用户是订户等）。

我不想使用配置文件，所以我决定使用自定义 MembershipProvider（或者你知道一些更好、更不痛苦的方法吗？）。

我不明白的是 MembershipUser 和 Membership。如果我从 MembershipProvider 继承，在重写的方法中，我控制对数据库的访问数据。

但是如何使用从 MembershipProvider 继承的类？如果我想使用成员身份验证用户，我应该这样做：

```
if(Membership.ValidateUser(string username, string password))
{
   FormsAuthentication.RedirectFromLoginPage(string username, string password);
} 
```

但是从 MembershipProvider 继承的类在哪里呢？以及何时使用从 MembershipUser 继承的类？Membership 和 MembershipProvider 之间是什么关系？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-10T01:38:05.037

[虽然在 MSDN](http://msdn.microsoft.com/en-us/library/2d449f1x.aspx)上不是很清楚，但并不是那么复杂。有三个类：

*   成员资格：提供实用方法和入口点——基本上是单例（静态类）。
*   MembershipProvider：充当 MembershipUser 对象的数据访问器和工厂。
*   MembershipUser：代表个人用户。

根据应用程序的配置选择自定义 MembershipProvider（通过 Membership 中的代码）：configuration/system.web/membership。在这里，您可以让您的提供商发挥作用。必须编写 MembershipProvider 实现以访问您喜欢的用户数据存储：在这种情况下是您的 User 表。

MembershipUser 对象只能通过您的 MembershipProvider 创建。MembershipProvider.ValidateUser() 方法应该检查您的数据存储，用户/密码组合是否有效。MembershipProvider.GetUser() 检索用户信息——在访问受保护的页面中使用它，并将 System.Web.HttpContext.Current.User.Identity.Name 作为当前经过身份验证的用户传入。

这就是说，我希望你确定你不想[使用 Profiles](https://stackoverflow.com/questions/95120/where-is-the-best-place-to-store-user-related-data-in-asp-net)，并且真的想要一个单独的 User 表。如果您正在编写内部应用程序，使用现有的[Active Directory](http://en.wikipedia.org/wiki/Active_directory)或启用[LDAP](http://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol)的数据存储将降低管理成本并可能降低安全风险。走 MembershipProvider 路线时，您很容易做数百件事。你使用[盐渍哈希](http://en.wikipedia.org/wiki/Salt_(cryptography))吗？您如何保护 User 表免受操纵？MSDN 仅涵盖您可能面临 的一小部分[安全问题。](http://msdn.microsoft.com/en-us/library/ms178398.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T21:55:39.427

使用的特定提供程序在 web.config 上进行控制。您实际上可以设置超过 1 个提供者，并有一个默认的提供者。检查：http: [//msdn.microsoft.com/en-us/library/6e9y4s5t.aspx](http://msdn.microsoft.com/en-us/library/6e9y4s5t.aspx)。

当这样调用时，成员资格只使用默认提供程序。如果您想为用户提供额外信息，您将继承 MembershipUser，但这会将其余代码与您的特定提供者联系起来。

# c# - HashSet 性能 Add vs Contains 现有元素

> ID：628141
> 
> 赞同：14
> 
> 时间：2009-03-09T21:42:53.277
> 
> 标签：c#, performance, hashset

`Add`出于某种原因，对 a的操作似乎`HashSet`比`Contains`在元素已经存在于`HashSet`.

这是证据：

```
 Stopwatch watch = new Stopwatch();
    int size = 10000;
    int iterations = 10000;

    var s = new HashSet<int>();
    for (int i = 0; i < size; i++) {
        s.Add(i);
    }

    Console.WriteLine(watch.Time(() =>
    {
        for (int i = 0; i < size; i++) {
            s.Add(i);
        }
    }, iterations));

    s = new HashSet<int>();
    for (int i = 0; i < size; i++) {
        s.Add(i);
    }

    // outputs: 47,074,764

    Console.WriteLine(watch.Time(() =>
    {
        for (int i = 0; i < size; i++) {
            if (!s.Contains(i))
                s.Add(i);
        }
    }, iterations));

    // outputs: 41,125,219 
```

为什么`Contains`比`Add`现有元素更快？

注意：我正在使用`Stopwatch`另一个 SO question 的扩展。

```
 public static long Time(this Stopwatch sw, Action action, int iterations) {
        sw.Reset();
        sw.Start();
        for (int i = 0; i < iterations; i++) {
            action();
        }
        sw.Stop();

        return sw.ElapsedTicks;
    } 
```

**更新**：内部测试表明，大的性能差异仅发生在 x64 版本的 .NET 框架上。使用 32 位版本的框架 Contains 似乎以相同的速度运行（事实上，在某些测试运行中，带有 contains 的版本似乎运行速度慢了一个百分点）在 X64 版本的框架上，带有 contains 的版本似乎运行速度快约 15%。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T23:12:51.300

AddIfNotPresent 执行包含不执行的附加除法。看一下包含的 IL：

```
IL_000a:  call       instance int32 class System.Collections.Generic.HashSet`1<!T>::InternalGetHashCode(!0)
  IL_000f:  stloc.0
  IL_0010:  ldarg.0
  IL_0011:  ldfld      int32[] class System.Collections.Generic.HashSet`1<!T>::m_buckets
  IL_0016:  ldloc.0
  IL_0017:  ldarg.0
  IL_0018:  ldfld      int32[] class System.Collections.Generic.HashSet`1<!T>::m_buckets
  IL_001d:  ldlen
  IL_001e:  conv.i4
  IL_001f:  rem
  IL_0020:  ldelem.i4
  IL_0021:  ldc.i4.1
  IL_0022:  sub
  IL_0023:  stloc.1 
```

这是计算哈希码的存储桶位置。结果保存在本地内存位置 1。

AddIfNotPresent 做了类似的事情，但它也将计算的值保存在位置 2，以便如果项目不存在，它可以将项目插入到该位置的哈希表中。这样做会保存，因为稍后在查找该项目的循环中修改了其中一个位置。无论如何，这是 AddIfNotPresent 的相关代码：

```
IL_0011:  call       instance int32 class System.Collections.Generic.HashSet`1<!T>::InternalGetHashCode(!0)
  IL_0016:  stloc.0
  IL_0017:  ldloc.0
  IL_0018:  ldarg.0
  IL_0019:  ldfld      int32[] class System.Collections.Generic.HashSet`1<!T>::m_buckets
  IL_001e:  ldlen
  IL_001f:  conv.i4
  IL_0020:  rem
  IL_0021:  stloc.1
  IL_0022:  ldarg.0
  IL_0023:  ldfld      int32[] class System.Collections.Generic.HashSet`1<!T>::m_buckets
  IL_0028:  ldloc.0
  IL_0029:  ldarg.0
  IL_002a:  ldfld      int32[] class System.Collections.Generic.HashSet`1<!T>::m_buckets
  IL_002f:  ldlen
  IL_0030:  conv.i4
  IL_0031:  rem
  IL_0032:  ldelem.i4
  IL_0033:  ldc.i4.1
  IL_0034:  sub
  IL_0035:  stloc.2 
```

无论如何，我认为额外的划分是导致 Add 比 Contains 花费更多时间的原因。乍一看，似乎可以排除额外的差异，但如果不花更多时间破译 IL，我不能肯定地说。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T22:20:38.693

有趣的是，在我的机器（Dell Latitude D630，双核 2.2 Ghz）上，除非我在`null`测试前针对某个动作运行秒表，否则我在两个测试中得到的结果几乎相同。例如：

我使用您在问题中给出的确切代码运行测试：

```
Without Contains(): 8205794
With Contains():    8207596 
```

如果我以这种方式修改代码：

后：

```
Stopwatch watch = new Stopwatch();
int size = 10000;
int iterations = 10000; 
```

添加：

```
watch.Time(null, 0); 
```

我的结果变成：

```
Without Contains(): 8019129
With Contains():    8275771 
```

在我看来，这似乎是在`Stopwatch`导致这些波动的内部发生了一些奇怪的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T22:29:40.200

我的猜测是您从 Visual Studio 运行了测试，导致`AddIfNotPresent`into的内联`Add`被抑制，因此您在方法调用中看到了额外级别的间接结果。

如果我从命令行编译并运行以删除任何 VS 诡计...

```
> csc /o+ /t:exe Program.cs
> Program.exe 
```

...那么没有性能差异。

样本输出（代表大量测试）：

```
35036174
35153818

35225763
34862330

35047377
35033323 
```

# asp.net - 为什么 Web 服务或 HTTP 处理程序调用会给出两个未经授权的错误，然后是一个成功？

> ID：628143
> 
> 赞同：3
> 
> 时间：2009-03-09T21:43:16.257
> 
> 标签：asp.net, web-services, authorization

在访问我编写的应用程序时，FireBug 显示每次调用 Web 服务或 HTTP 处理程序都会尝试 3 次，前两次显示为“401 Unauthorized”，即使它们返回了正确的结果。这一致。每个电话都做同样的事情。

任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T23:07:20.330

它正在为 NTLM 授权进行协商。检查 Microsoft NTLM 上的 MSDN：http: [//msdn.microsoft.com/en-us/library/aa378749.aspx](http://msdn.microsoft.com/en-us/library/aa378749.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T23:06:57.040

当访问标记为集成 Windows 身份验证的 IIS 服务器时，会发生这种情况（在某些设置中）。
这仅在使用 NTLM（而不是 Kerberos）时发生，它是 NTLM 身份验证过程的一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T22:49:43.960

您确定返回 401 的调用也返回正确的结果吗？他们不应该。

这听起来像是一场授权谈判。

# .net - 为什么 .NET 被称为 .NET？

> ID：628145
> 
> 赞同：40
> 
> 时间：2009-03-09T21:43:53.353
> 
> 标签：.net, terminology

我一直想知道为什么微软为这样一个伟大的平台选择了一个奇怪的、对搜索引擎不友好的名称。他们就不能想出更好的办法吗？

显然代号是NGWS：

> Microsoft 在 1990 年代后期开始开发 .NET Framework，最初的名称是下一代 Windows 服务 (NGWS)。^([[维基百科]](http://en.wikipedia.org/wiki/.NET_Framework#Versions))

有谁知道他们为什么选择 .NET 这个名字？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-10T03:46:35.557

.NET 使微软的营销人员能够强调其技术的“网络”方面，也是对 1990 年代后期 Sun Microsystems 以“网络即计算机”为主题的营销闪电战的反应。“Dot-Com”这个词在当时是互联网的同义词，而“Dot-NET”就是那个词的玩意儿。

我不认为这是一个坏名字，问题是微软用“.Net”命名法命名了这么多产品，比如 .NET My Services 和 Microsoft .NET Enterprise Servers，后者与 Internet 无关. 它引起了很多混乱。直到后来微软才通过将 .NET 名称限制为与托管运行时框架相关的技术来纠正问题。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-09T21:48:19.240

互联网将是我的猜测

在 90 年代中后期，微软将互联网视为未来，也觉得他们的游戏有点晚了。因此，Explorer 被嵌入到操作系统中来强迫人们使用（他们现在正在后悔）。从 Windows 中删除 Java 等竞争对手，以及 .NET 等名副其实的顶级名称，表明现在有一家网络友好的公司......

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-10T06:56:49.467

当时我是 Microsoft 的一名开发人员，我不知道 .NET 这个名字是从谁那里得到的。由于已经列举的所有原因，我与之交谈的任何人都认为这是一个糟糕的名字。与NGWS不同，至少它是可发音的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-09T23:25:50.050

.NET 的早期营销重点是 Web 服务。.NET 应该使编写和使用 Web 服务变得容易。特别是，它应该更容易调用微软将提供的 Web 服务，然后每个人都会使用：“.NET 我的服务”。

当然，这很快就瓦解了，但名字仍然存在。它至少比“COM++”或“ActiveXX”好。

# c - tcp - 得到 num 个字节的确认

> ID：628149
> 
> 赞同：2
> 
> 时间：2009-03-09T21:45:46.157
> 
> 标签：c, tcp

在标准 tcp 实现中（例如，在 bsd 上），有人知道是否有可能找出远程主机已确认的字节数？在套接字上调用 write() 会返回写入的字节数，但我相信这实际上意味着可以放入 tcp 缓冲区的字节数（不是写入网络的字节数，或确认的字节数）。或者，也许我错了……

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T00:28:24.877

当你有 NODELAY=false （这是默认值）时，当你用比 TCP 窗口少的字节调用 send() 时，字节并没有真正立即发送，所以你是对的。操作系统会稍等片刻，看看您是否调用另一个 send()，以便仅使用一个数据包来传输组合数据，并避免浪费 TCP 标头。

当 NODELAY=true 时，数据会在您调用 send() 时传输，因此您可以（理论上）依靠返回值。但由于增加了网络效率低下，不建议这样做。

总而言之，如果不需要绝对精度，即使 NODELAY=true，也可以使用 send() 返回的值。该值不会反映即时现实，但会在几毫秒后反映（但还会检查丢失的连接，因为您发送的最后一个数据块可能已丢失）。一旦连接正常终止，您就可以相信所有数据都已传输。如果不是，您之前就会知道 - 要么是因为连接突然断开，要么是因为您收到了与数据保留相关的错误（或任何其他错误）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T11:25:56.763

我不知道有什么方法可以得到这个，而且它可能对你没有用。

假设您想知道主机接收了多少数据，以便在连接丢失并重新连接后您可以再次从那里开始发送。因此，确认的数据仅被操作系统确认！它并不表示你的程序在另一端收到了哪些数据；根据那里的 TCP 接收缓冲区的大小，您的程序可能落后数百 KB。*如果您想知道那里的程序已接收和*“使用”了多少数据，请让它发送应用程序级 ACK

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T21:51:08.767

我认为你错了，尽管它是我想先看看具体实施的地方之一，然后我才会赌上大笔的钱。但是，请考虑 TCP 连接的情况，在原始握手后立即断开连接。如果返回的字节数只是缓冲的数量，则可能显然已经写入了许多字节，但它们仍未交付；这将违反 TCP 的交付保证属性。

但请注意，这仅适用于 TCP；并非 IP 中的所有协议都提供相同的保证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T22:19:49.803

通过使用`ioctl(fd, TIOCOUTQ, &intval);`将传出队列放入`intval`. 这将是保留在队列中的总长度，包括“由应用程序写入”但尚未发送。这仍然是我目前能想到的最好的近似值。

# python - 如何在 Python 中对集合运行操作并收集结果？

> ID：628150
> 
> 赞同：5
> 
> 时间：2009-03-09T21:45:56.080
> 
> 标签：python, list, lambda

如何在 Python 中对集合运行操作并收集结果？

因此，如果我有一个包含 100 个数字的列表，并且我想为每个数字运行一个这样的函数：

```
Operation ( originalElement, anotherVar ) # returns new number. 
```

并像这样收集结果：

结果=另一个列表...

我该怎么做？也许使用 lambdas？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-09T21:48:40.690

[列出理解。](http://docs.python.org/tutorial/datastructures.html#list-comprehensions) 在 Python 中，它们看起来像：

```
a = [f(x) for x in bar] 
```

其中 f(x) 是某个函数，bar 是一个序列。

您可以将 f(x) 定义为具有以下构造的部分应用函数：

```
def foo(x):
    return lambda f: f*x 
```

它将返回一个将参数乘以 x 的函数。列表推导中使用的这种类型的构造的一个简单示例如下所示：

```
>>> def foo (x):
...     return lambda f: f*x
... 
>>> a=[1,2,3]
>>> fn_foo = foo(5)
>>> [fn_foo (y) for y in a]
[5, 10, 15] 
```

虽然我不认为在任何但相当深奥的情况下使用这种结构。Python 不是一种真正的函数式语言，因此与（例如）Haskell 相比，它在使用更高阶函数的巧妙技巧方面的余地更小。您可能会找到这种类型的构造的应用程序，但它并不是真正*的*Pythonic。您可以通过以下方式实现简单的转换：

```
>>> y=5
>>> a=[1,2,3]
>>> [x*y for x in a]
[5, 10, 15] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T07:53:30.207

这样做的另一种（有些折旧）方法是：

def kevin(v): 返回 v*v

vals = 范围（0,100）

地图（凯文，瓦尔斯）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T21:54:18.133

[列表推导](http://docs.python.org/tutorial/datastructures.html)、[生成器表达式](http://www.python.org/dev/peps/pep-0289/)、[reduce 函数](http://docs.python.org/library/functions.html#reduce)。

# php - 缩放phpBB？

> ID：628156
> 
> 赞同：2
> 
> 时间：2009-03-09T21:47:45.637
> 
> 标签：php, mysql, scaling, phpbb

我希望通过将读取查询与写入查询分离到两个单独的复制 MySQL 服务器来扩展现有的 phpBB 安装。任何人都成功地做到了这一点，特别是 phpBB？

到目前为止，我最大的担忧是查询似乎散布在整个代码中。我很想听听其他人是否这样做，如果是这样，它是如何进行的/过程是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T21:51:55.423

您可以尝试[MySQL Proxy](http://forge.mysql.com/wiki/MySQL_Proxy)，这将是一种在不更改应用程序的情况下拆分查询的简单方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T17:51:08.733

只需添加更多 RAM。足够的 RAM 来容纳整个数据库。您会惊讶于您的低效脚本的运行速度有多快。内存可以原谅很多数据库扩展错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-18T13:28:25.270

*我知道这是很久以前问过的，但我想分享我的经历，以防它可以帮助任何人。*

如果您的问题是表锁，并且知道当时 phpbb 的默认存储引擎是 MyISAM，您是否考虑过迁移到 InnoDB 存储引擎？

只需找出哪些表最常被锁定，然后将它们转换为 InnoDB。会话表是这里的第一个候选者，但如果这是您的主要瓶颈，您可能希望查看其他优化（例如仅将会话数据存储在 memcache 或其他东西中）。

# .net - System.IO.Ports.SerialPort - 可以配置 IOCTL_SERIAL_SET_WAIT_MASK 吗？

> ID：628161
> 
> 赞同：1
> 
> 时间：2009-03-09T21:49:28.800
> 
> 标签：.net, serial-port

`System.IO.Ports.SerialPorts`我一直在尝试通过编写一个小型 Windows 窗体应用程序从旧的外部调制解调器收集调用方显示数据来了解 .Net (3.5) 如何通过类与串行端口交互。

我已经测试过调制解调器支持来电显示；使用 Putty 或 Hyperterminal，我可以配置调制解调器以收集来电显示数据（使用命令`AT#CID=1`，我在[此处](http://ftp.mtnsys.com/Pages/howto/htmdmtst.htm)找到），当电话响起时，显示数据。在终端窗口中，它看起来像这样：

```
RING

DATE = 0308
TIME = 2045
NMBR = 01234567890

RING 
```

我的 C# 应用程序似乎成功配置了调制解调器，并`RING` 在电话响铃时显示一条消息；但是，它从不显示来电显示数据。

为了理解为什么会这样，我使用 Sysinternals [Portmon](http://technet.microsoft.com/en-us/sysinternals/bb896644.aspx)比较了不同客户端所采取的操作。

主要区别在于连接配置；我的 C# 应用程序包含以下行，而 Putty 和 Hyperterminal 没有；

```
0.00000307  callerID.exe    IOCTL_SERIAL_SET_WAIT_MASK  Serial0 SUCCESS Mask: RXCHAR RXFLAG CTS DSR RLSD BRK ERR RING 
```

据我了解，`IOCTL_SERIAL_SET_WAIT_MASK`是要过滤的消息类型的包含列表。

所以，三个问题：

来电显示信息是否可能被 抑制`IOCTL_SERIAL_SET_WAIT_MASK`？

如果是这样，我该如何配置它以显示来电显示信息？它似乎无法从类属性中访问。

如果我不能配置它，我唯一的选择是解决这个问题，将我自己的包装器编写到控制串行端口的低级系统功能？

我对串口通信的理解非常基础，所以我希望我的诊断还很遥远。感激地接受任何指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T18:49:24.433

我的诊断离我很远。

似乎该`WriteLine`方法不会终止它使用我的调制解调器所期望的行终止符发送的命令。

我需要做的就是在我发送的命令中添加一个回车，然后使用该`Write`方法发送它们。

为浪费任何人的时间而道歉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T10:46:49.197

我在 MSDN 上找到[了这个](http://msdn.microsoft.com/en-us/magazine/cc301786.aspx)，它看起来像是一个不错的示例，说明如何通过系统 dll 上的 P/Invoke 访问串行端口。

我仍然想知道是否可以解决 .Net 类的问题。

# python - 如何实现一个覆盖单个值和多个值的函数

> ID：628162
> 
> 赞同：4
> 
> 时间：2009-03-09T21:49:37.240
> 
> 标签：python, list, function, vectorization

假设您有这样的值：

```
n = 5 
```

以及一个返回它的阶乘的函数，如下所示：

```
factorial(5) 
```

你如何处理多个值：

```
nums = [1,2,3,4,5]
factorial (nums) 
```

所以它将所有这些值的阶乘作为列表返回？

在不编写 2 种方法的情况下，最干净的处理方法是什么？Python 是否有处理这类情况的好方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-09T21:56:19.050

```
def Factorial(arg):
    try:
        it = iter(arg)
    except TypeError:
        pass
    else:
        return [Factorial(x) for x in it]
    return math.factorial(arg) 
```

如果它是可迭代的，则递归应用。否则，正常进行。

或者，您可以将最后一个`return`移入`except`块中。

如果你确定身体`Factorial`永远不会 raise `TypeError`，它可以简化为：

```
def Factorial(arg):
    try:
        return [Factorial(x) for x in arg]
    except TypeError:
        return math.factorial(arg) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T21:53:08.573

[列表理解](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)：

```
[fac(n) for n in nums] 
```

**编辑：**

抱歉，我误会了，您想要一种同时处理序列和单个值的方法吗？我无法想象你为什么不使用两种方法来做到这一点。

```
def factorial(n):
    # implement factorial here
    return answer

def factorial_list(nums):
    return [factorial(n) for n in nums] 
```

另一种方法是进行某种类型检查，除非你有一些非常令人信服的理由，否则最好避免这样做。

**编辑2：**

MizardX 的答案更好，投票给那个。干杯。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-09T22:20:37.260

有时会这样做。

```
def factorial( *args ):
    def fact( n ):
        if n == 0: return 1
        return n*fact(n-1)
    return [ fact(a) for a in args ] 
```

它提供了一个几乎神奇的功能，可以处理简单的值和序列。

```
>>> factorial(5)
[120]
>>> factorial( 5, 6, 7 )
[120, 720, 5040]
>>> factorial( *[5, 6, 7] )
[120, 720, 5040] 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-09T21:54:11.363

如果你问 Python 是否可以进行方法重载：不。因此，执行这样的多方法是定义方法的一种相当非 Pythonic 的方式。此外，命名约定通常是大写的类名和小写的函数/方法。

如果你想继续，最简单的方法就是创建一个分支：

```
def Factorial(arg):
  if getattr(arg, '__iter__', False): # checks if arg is iterable
    return [Factorial(x) for x in arg]
  else:
    # ... 
```

或者，如果你觉得花哨，你可以制作一个装饰器来对任何功能执行此操作：

```
def autoMap(f):
    def mapped(arg):
        if getattr(arg, '__iter__', False):
            return [mapped(x) for x in arg]
        else:
            return f(arg)
    return mapped

@autoMap
def fact(x):
    if x == 1 or x == 0:
        return 1
    else:
        return fact(x-1) + fact(x-2)

>>> fact(3)
3
>>> fact(4)
5
>>> fact(5)
8
>>> fact(6)
13
>>> fact([3,4,5,6])
[3, 5, 8, 13] 
```

尽管更 Pythonic 的方式是使用可变参数长度：

```
def autoMap2(f):
    def mapped(*arg):
        if len(arg) != 1:
            return [f(x) for x in arg]
        else:
            return f(arg[0])
    return mapped

@autoMap2
def fact(n):
# ...

>>> fact(3,4,5,6)
[3, 5, 8, 13] 
```

将两者组合成一个深度映射装饰器：

```
def autoDeepMap(f):
    def mapped(*args):
        if len(args) != 1:
            return [mapped(x) for x in args]
        elif getattr(args[0], '__iter__', False):
            return [mapped(x) for x in args[0]]
        else:
            return f(args[0])
    return mapped

@autoDeepMap
def fact(n):
# ...

>>> fact(0)
1
>>> fact(0,1,2,3,4,5,6)
[1, 1, 2, 3, 5, 8, 13]
>>> fact([0,1,2,3,4,5,6])
[1, 1, 2, 3, 5, 8, 13]
>>> fact([0,1,2],[3,4,5,6])
[[1, 1, 2], [3, 5, 8, 13]]
>>> fact([0,1,2],[3,(4,5),6])
[[1, 1, 2], [3, [5, 8], 13]] 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-09T22:22:41.030

或者，如果您不喜欢列表理解语法，并且希望跳过使用新方法：

```
def factorial(num):
    if num == 0:
        return 1
    elif num > 0:
        return num * factorial(num - 1)
    else:
        raise Exception("Negative num has no factorial.")

nums = [1, 2, 3, 4, 5]
# [1, 2, 3, 4, 5]

map(factorial, nums)
# [1, 2, 6, 24, 120, 720] 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-09T22:39:54.483

您可能想看看 NumPy/SciPy 的[vectorize](http://docs.scipy.org/doc/numpy/reference/generated/numpy.vectorize.html)。

在 numpy 的世界中，给定你的单整数参数 Factorial 函数，你会做类似的事情

```
 vFactorial=np.vectorize(Factorial)
  vFactorial([1,2,3,4,5])
  vFactorial(6) 
```

尽管请注意，最后一种情况返回的是单元素 numpy 数组而不是原始 int。

# visual-studio - VS 2008 和 Team Explorer - 签出文件

> ID：628188
> 
> 赞同：6
> 
> 时间：2009-03-09T21:57:46.567
> 
> 标签：visual-studio, visual-studio-2008

如何在 vs 2008 Team Explorer 中搜索其他用户签出的文件。我可以通过搜索在 Visual Source Safe 中搜索项目中签出的所有文件，是否在团队资源管理器中实现了类似的功能？现在我必须点击每个文件夹，看看该文件夹中的文件是否被其他人签出。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T19:15:14.173

将此命令添加到 VS 的“外部工具...”列表中。

工具 >> 外部工具... 选择“添加”并输入以下内容： 标题：“查看所有签出的文件” 命令：“tf.exe” 参数：“status $(ProjectDir) /user:* /recursive” 勾选“使用输出窗口”取消选中“提示输入参数”选择“确定”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-02T22:51:09.903

获取 TFS Power Tools - 它们集成到 Team Explorer 视图中。您将获得团队中的人员列表。您可以右键单击团队成员并查看他们当前的变更集。

[您可以在此处查看](http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx)Microsoft 站点上的 TFS Power Tools - 2008 年 10 月版具有团队成员功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T01:16:55.603

Attrice TFS Sidekicks 可用于获取一些未在 VS 中显示的信息。我相信状态视图会显示你所追求的：http: [//www.attrice.info/cm/tfs](http://www.attrice.info/cm/tfs)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T06:08:26.713

安装 Microsoft 的（免费）Team Foundation Server Power Tools 为源代码管理资源管理器添加了许多额外功能，包括右键单击文件夹并选择“在源代码管理中查找”的能力。

您可以从此处下载 Team Foundation Server Power Tools：http: [//msdn.microsoft.com/en-us/teamsystem/bb980963.aspx](http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-02T22:48:55.853

您可以运行 TF.exe status 命令语句来获取特定项目下签出的文件列表。您也可以根据用户名搜索..

这里是更多信息的链接。

[http://patelshailesh.com/index.php/how-to-get-the-list-of-currently-checked-out-files-in-tfs](http://patelshailesh.com/index.php/how-to-get-the-list-of-currently-checked-out-files-in-tfs)

希望这可以帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T22:41:09.317

据我所知，Team Explorer 是不可能的。您可以使用[TF STATUS](http://blogs.vertigosoftware.com/teamsystem/archive/2006/07/24/3125.aspx)命令从命令行执行此操作。

# .net - 在 .NET 中捕获 SQL 唯一键异常

> ID：628189
> 
> 赞同：12
> 
> 时间：2009-03-09T21:57:47.220
> 
> 标签：.net, asp.net, sql

我想知道除了解析错误消息之外，是否有人有更优雅的方法来检查 .NET 中 SQL 的唯一键异常？现在我在 SQL 中调用存储过程，然后在 .NET 中使用 try catch 块。在 try catch 块中，我解析错误消息，这是一个唯一键错误，我将自定义错误的实例抛出给调用类，如果不是，我只是将原始异常抛出调用类。这对我来说似乎非常低效。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-09T22:10:03.570

如果您捕获到 SqlException，您应该能够枚举包含许多“SqlError”对象的“Errors”集合。

SqlError 具有“Class”和“Number”等属性 - 唯一键违规是 class = 14 和 number = 2601。检查这些数字以准确找到您的错误。

这些错误代码与您尝试在 SQL Management Studio 中执行查询时得到的错误代码相同：

> 消息 2601，级别 14，状态 1，行 1
> 无法在对象中插入重复
> 的键行............语句已终止。

“Msg”转换为 SqlError 上的“Number”属性，“Level”转换为“Class”。

```
try
{
  _cmd.ExecuteNonQuery();
}
catch(SqlException sqlExc)
{
   foreach (SqlError error in sqlExc.Errors)
   {
      string msg = string.Format("{0}: {1}", error.Number, error.Message);
   }
} 
```

这样，您可以轻松准确地识别“违反唯一约束”错误。

马克

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T22:05:04.957

为什么不直接查询唯一 ID 是否存在？最好是得到异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T22:12:05.563

解析错误消息是个坏主意。例如，如果您使用 Ms SQL 消息可以本地化（用不同的语言），您将找不到您正在寻找的词。

如果您使用的是 Ms SQL，您应该检查[Number](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlexception.number(VS.71).aspx)属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T22:04:09.717

显而易见的答案：尝试在插入（或更新）之前从数据库中获取该值，并在插入之前通知用户。

替代答案：检查 SP 内部的唯一性并将其作为来自 SP 的错误消息返回，然后您不必解析任何错误。他们都很坏。

# c# - .NET Process Start Process Error using credentials（句柄无效）

> ID：628191
> 
> 赞同：9
> 
> 时间：2009-03-09T21:58:08.110
> 
> 标签：c#, .net, system.diagnostics

我有一个 Windows 窗体应用程序，它向 StartInfo 提供用户名、域和密码，它会抛出这个：

System.ComponentModel.Win32Exception：**句柄** 在 System.Diagnostics.Process.StartWithCreateProcess(ProcessStartInfo startInfo) 在 System.Diagnostics.Process.Start() 处无效

当我允许将凭据默认为当前用户时，我不会收到此类错误，并且我启动的过程可以在不需要使用凭据的范围内工作（凭据对于在 MSBuild 脚本中映射驱动器是必需的）。这是填写开始信息的代码：

```
Process p = new Process();
ProcessStartInfo si = new ProcessStartInfo(buildApp, buildArgs);
si.WorkingDirectory = msBuildWorkingDir;
si.UserName = txtUserName.Text;
char[] psw = txtPassword.Text.ToCharArray();
SecureString ss = new SecureString();
for (int x = 0; x < psw.Length; x++)
{
    ss.AppendChar(psw[x]);
}
si.Password = ss;
si.Domain = "ABC";
si.RedirectStandardOutput = true;
si.UseShellExecute = false;
si.WorkingDirectory = txtWorkingDir.Text;
p.StartInfo = si;
p.Start(); 
```

并不是用户/psw 不匹配，因为例如，当我提供错误的 psw 时，它会捕获它。所以，这个“无效句柄”的事情是在信用通过之后发生的。关于我可能会忽略或搞砸的任何想法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-09T22:03:48.830

您必须重定向您的输入、错误和输出。

例如：

```
ProcessStartInfo info = new ProcessStartInfo("cmd.exe");
 info.UseShellExecute = false;
 info.RedirectStandardInput = true;
 info.RedirectStandardError = true;
 info.RedirectStandardOutput = true;
 info.UserName = dialog.User;

 using (Process install = Process.Start(info)) {
       string output = install.StandardOutput.ReadToEnd();
       install.WaitForExit();
       // Do something with you output data       
    Console.WriteLine(output);
 } 
```

微软还表示该错误应为“无法重定向输入”。（曾经有一个链接，但不再有效）

# python - Python 等价于 java.util.SortedSet？

> ID：628192
> 
> 赞同：21
> 
> 时间：2009-03-09T21:58:14.723
> 
> 标签：python, data-structures

有人知道 Python 是否具有与 Java 的 SortedSet 接口等效的接口吗？

这是我正在寻找的内容：假设我有一个类型的对象`foo`，并且我知道如何比较两个类型的对象`foo`以查看`foo1`是 "大于" 还是 "小于" `foo2`。我想要一种`foo`在 list中存储许多类型对象的方法`L`，这样每当我遍历 list 时`L`，我都会根据我定义的比较方法按顺序获取对象。

### 编辑：

我想我每次修改它时都可以使用字典或列表`sort()`，但这是最好的方法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-09T22:22:21.840

您可以使用`insort`from[`bisect`](http://docs.python.org/library/bisect.html#module-bisect)模块在已排序的列表中有效地插入新元素：

```
from bisect import insort

items = [1,5,7,9]
insort(items, 3)
insort(items, 10)

print items # -> [1, 3, 5, 7, 9, 10] 
```

请注意，这并不直接对应于`SortedSet`，因为它使用了一个列表。如果您多次插入相同的项目，您将在列表中出现重复项。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-09T23:33:08.537

看看[BTrees](http://pypi.python.org/pypi?%3Aaction=search&term=btree)。看起来你需要其中之一。据我了解，您需要支持将元素相对便宜地插入存储结构和便宜的排序操作（甚至不支持）的结构。BTrees 提供了这一点。

我有使用 ZODB.BTrees 的经验，它们可以扩展到成千上万个元素。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T22:41:52.637

如果您正在寻找使用平衡搜索树（例如红黑树）之类的 Python 实现的高效容器类型的实现，那么它不是标准库的一部分。

不过，我能够找到这个：

[http://www.brpreiss.com/books/opus7/](http://www.brpreiss.com/books/opus7/)

源代码可在此处获得：

[http://www.brpreiss.com/books/opus7/public/Opus7-1.0.tar.gz](http://www.brpreiss.com/books/opus7/public/Opus7-1.0.tar.gz)

我不知道源代码是如何获得许可的，我自己也没有使用过，但如果您对滚动自己的容器类不感兴趣，这将是一个很好的起点。

PyAVL是一个实现 AVL 树的 C 模块[。](http://linux.softpedia.com/get/Programming/Libraries/pyavl-43893.shtml)

此外，[此线程](http://mail.python.org/pipermail/python-list/2007-September/628938.html)可能对您有用。它包含很多关于如何使用 bisect 模块来增强现有 Python 字典以完成您所要求的工作的建议。

当然，以这种方式使用 insort() 插入和删除会非常昂贵，因此请为您的应用程序仔细考虑它。实施适当的数据结构可能是更好的方法。

无论如何，要了解是否应该对数据结构进行排序或在迭代时对其进行排序，您必须知道您是打算插入很多还是迭代很多。如果您相对不频繁地修改其内容但对其进行大量迭代，则保持数据结构排序是有意义的。相反，如果您一直插入和删除成员，但相对不频繁地迭代集合，则在迭代之前对键集合进行排序会更快。没有一种正确的方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-09-23T06:19:16.180

与 blist.sortedlist 类似，[sortedcontainers](http://www.grantjenks.com/docs/sortedcontainers/)模块提供了排序列表、排序集和排序字典数据类型。它在底层实现中使用了修改后的 B-tree，并且在大多数情况下比 blist 更快。

sortedcontainers 模块是纯 Python 的，因此安装很容易：

```
pip install sortedcontainers 
```

然后例如：

```
from sortedcontainers import SortedList, SortedDict, SortedSet
help(SortedList) 
```

sortedcontainers 模块具有 100% 的覆盖率测试和数小时的压力。有一个非常全面的[性能比较](http://www.grantjenks.com/docs/sortedcontainers/performance.html)，列出了您为此考虑的大多数选项。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-09T22:16:35.927

如果您只需要键，而没有关联的值，Python 提供了集合：

```
s = set(a_list)

for k in sorted(s):
    print k 
```

但是，每次执行此操作时都会对集合进行排序。如果开销太大，您可能需要查看[HeapQueues](http://docs.python.org/library/heapq.html)。它们可能没有那么优雅和“Pythonic”，但也许它们适合您的需求。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-06T22:36:48.387

`blist.sortedlist`从[blist 包](http://pypi.python.org/pypi/blist/)中使用。

```
from blist import sortedlist

z = sortedlist([2, 3, 5, 7, 11])
z.add(6)
z.add(3)
z.add(10)

print z 
```

这将输出：

```
sortedlist([2, 3, 3, 5, 6, 7, 10, 11]) 
```

生成的对象可以像 python 列表一样使用。

```
>>> len(z)
8
>>> [2 * x for x in z]
[4, 6, 6, 10, 12, 14, 20, 22] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-18T19:24:11.360

你有可能使用 Jython 吗？我只是提到它是因为使用 TreeMap、TreeSet 等是微不足道的。此外，如果您来自 Java 背景并且想要朝着 Pythonic 方向前进，那么 Jython 非常适合使过渡更容易。尽管我认识到在这种情况下使用 TreeSet 不会成为这种“过渡”的一部分。

对于 Jython 超级用户，我自己有一个问题：无法导入 blist 包，因为它使用必须导入的 C 文件。但是使用 blist 代替 TreeSet 会有什么好处吗？我们一般可以假设 JVM 使用的算法本质上与 CPython 的算法一样好吗？

# php - SQL 查询导致页面变为空白

> ID：628198
> 
> 赞同：1
> 
> 时间：2009-03-09T22:01:30.083
> 
> 标签：php, sql

我正在使用 php 创建一个网站，但我在使用 SQL 查询时遇到了一些问题。

```
$dataArray = array();
$result = mysql_query("SELECT * FROM test WHERE web_id='$websiteID'")
    or die(mysql_error());

while ($row = mysql_fetch_array($result)) {
    $k = $row['kfoo'];
    $v = $row['vbar'];
    $dataArray[$k] = $v;
} 
```

这就是应该的代码，但是这会导致页面变为空白（即仅显示全白）。我已经仔细检查过，`web_id`绝对是正确的名称和正确的大小写。

例如，如果我`web_id`将查询更改为“foo”（基本上不是`web_id`），则页面将显示，但会显示错误消息“'where 子句'中的未知列 'foo'”。

有人知道是什么原因造成的吗？这是我创建表测试的代码：

```
$dataDB = "CREATE TABLE test
(
    data_id INT NOT NULL AUTO_INCREMENT,
    PRIMARY KEY(data_id),
    web_id INT,
    kfoo TEXT,
    vbar TEXT
)";

mysql_query($dataDB,$con); 
```

**更新**

根据此处的一些答案，我删除了 $websiteID 周围的引号并使用显示错误

```
error_reporting(E_ALL);
ini_set('display_errors', 1); 
```

这显示了很多错误，包括之前我现在修复的语法错误。但是，仍然存在许多错误，它们对我来说没有多大意义。这是我的方法的完整代码：

```
function getOutputSQL($websiteID,$userInput) {
 $result = mysql_query("SELECT * FROM websites WHERE websiteID=$websiteID") 
    or die(mysql_error());

  while ($row = mysql_fetch_array($result)){
    $url = $row['url'];
    $exp = $row['exp'];
    $output= $row['textPrint'];
    $endUrlStart = $row['outUrlStart'];
    $endUrlEnd = $row['outURLEnd'];

    $image = $row['image'];
    $print = $row['print'];
    $post = $row['post'];

    $dataSource = $row['dataSource'];
    $dataSourceName = $row['dataSourceName'];           

  }

  // construct array of data names and values
  $dataArray = array();
  $result = mysql_query("SELECT * FROM test WHERE web_id=$websiteID") 
    or die(mysql_error());

  while ($row = mysql_fetch_array($result)) {
    $k = $row['kfoo'];
    $v = $row['vbar'];
    $dataArray[$k] = $v;
  }

  // construct array of expressions and replacements
  $result = mysql_query("SELECT * FROM regex WHERE web_id=$websiteID");
  $expArray = array();

  while ($row = mysql_fetch_array($result)) {
    $e = $row['ex'];
    $r = $row['re'];
    $expArray[$e] = $r; 
  }

  return getOutput($userInput,$url,$exp,$output,$endUrlStart,
     $endUrlEnd,$dataSource,$dataSourceName,$post,$image,$print,
     $expArray,$dataArray); 
} 
```

我得到的错误都是这样的-

> 注意：未定义的变量：在 /home/daniel/web/resultsTest.php 第 113 行输出"

对于 url、exp、output、endUrlStart、endUrlEnd、dataSource、dataSourceName、post、image 和 print 重复几次 第 113 行是大返回行。

问题是，据我所知，这些变量已定义，并且我知道该表不是空的，因为我可以在另一个页面上显示它。

**解决了**

排序。问题实际上出在我的代码的另一部分——我错误地调用了 getOutputSQL，但我现在已经修复了它！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T22:09:53.680

我希望您的实际代码实际上会输出任何内容，如果这是您拥有的所有代码，则不会输出任何内容，因为没有错误时您不会输出（没有回显或打印是模板或任何东西）

还要确保设置了 error_reporting 和 display_errors。您可以使用从脚本顶部执行此操作

```
error_reporting(E_ALL);
ini_set('display_errors', 1); 
```

这样你就会看到所有的错误。

**编辑**
PHP 有多种类型的错误，包括致命错误、警告和通知。通知告诉您，当您使用未定义的变量或不推荐使用的函数时，您几乎可以忽略它们。您可以更改设置，这样您就不会看到它们使用：

```
error_reporting(E_ALL ^ E_NOTICE); 
```

然后你只会看到真正的错误（警告和致命错误）。

**更多编辑**
然后这些变量是真正未设置的，在调用 getOutput() 之前尝试这样的操作：

```
echo "<pre>";
var_dump($userInput);
var_dump($url);
//etc.
echo "</pre>"; 
```

看看变量是否真的设置好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T22:06:50.413

一般来说，php 中的空白页表示已禁用[错误通知](http://www.php.net/error_reporting)。首先，您应该通过 .htaccess 或 php.ini 启用它们。

顺便说一句：据我所知，整数不应该在 SQL 中引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T22:11:00.807

试试这个：

```
$dataArray = array();
if(is_numeric($websiteID){
        $result = mysql_query("SELECT * FROM test WHERE web_id=$websiteID") or die(mysql_error());

        while ($row = mysql_fetch_array($result)) {
                $k = $row['kfoo'];
                $v = $row['vbar'];
                $dataArray[$k] = $v;
        }
} 
```

请注意，我删除了 websiteID 变量周围的 ''。这意味着 mysql 不会将其视为字符串，而是将其视为 int，这是您在 mysql 表创建中指定的。我还检查了 websiteID 是否是一个数字。如果不是，那么执行 sql 查询就没有意义，因为您将得到零个结果。这可以防止 sql 注入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T23:42:42.773

Variables you define inside loops are destroyed at the end of the loop. That means the output variable you create in the first while loop does not exist after the loop. You should define them outside the while loop and then set the values inside the loop:

```
function getOutputSQL($websiteID,$userInput) {
 $result = mysql_query("SELECT * FROM websites WHERE websiteID=$websiteID") 
    or die(mysql_error());
  $url = "";
  $exp = "";
  $output = "";
  //... etc for all the other variables you need in the function at the end.
  while ($row = mysql_fetch_array($result)){
    $url = $row['url'];
    $exp = $row['exp'];
    $output= $row['textPrint'];
    $endUrlStart = $row['outUrlStart'];
    $endUrlEnd = $row['outURLEnd'];

    $image = $row['image'];
    $print = $row['print'];
    $post = $row['post'];

    $dataSource = $row['dataSource'];
    $dataSourceName = $row['dataSourceName'];                   

  }
  // the rest of your function... 
```

# asp.net - 迁移 Linq DBML 表的最佳解决方案是什么？

> ID：628221
> 
> 赞同：1
> 
> 时间：2009-03-09T22:07:37.493
> 
> 标签：asp.net, sql-server, linq-to-sql, version-control, data-migration

我正在尝试找出使用 Linq 处理数据库更新的最佳方法。我想要一种检查数据库更改的干净方法。我想使用 ruby​​ 样式的迁移脚本，但我也想使所有内容与 DBML 文件保持同步。做这个的最好方式是什么？我是否需要编写自定义解决方案来执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T17:22:42.357

我假设你的意思是模式的变化？如果是这样，那么自定义代码生成器肯定是一种选择，并且比每次模式更改时手动更新 DBML 更好。但是也有第三方工具可以同步模式更改：

[http://www.huagati.com/dbmltools/](http://www.huagati.com/dbmltools/)

如果您愿意放弃将 LINQ 作为数据访问模型，那么可以使用 OR/M 工具或类似 OR/M 的工具来控制代码生成。

# sql - 从包含数千个的 MySQL 视图中查询单个记录是否等同于查询那些数千 + 1？

> ID：628224
> 
> 赞同：2
> 
> 时间：2009-03-09T22:09:10.407
> 
> 标签：sql, mysql, performance

我一直希望并假设它不是——集合论（或其他东西）提供了一条通往结果的捷径。

我创建了一个**不可更新的**视图，它聚合了来自多个表的数据，以一种产生指数数量的记录的方式。从这个角度来看，我一次查询一条记录。因为底层数据集很小，所以这种技术效果很好——但我担心它不会扩展。

我听说 MySQL 使用临时表来实现视图。一想到每个查询都可能出现大量临时表，我的心就会颤抖。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T00:00:13.900

使用`explain <select query>`语法查看查询中实际发生的情况。

一般来说，使用视图相当于使用相同 SQL 的子查询。没有更好也没有更糟，只是防止一遍又一遍地编写相同子查询的捷径。

*有时*您最终会使用临时表来解决一些复杂的查询，但如果数据库结构得到很好的优化并且使用视图而不是子查询不会改变任何事情，这种情况就不应该经常发生。

# diagnostics - 什么被认为是平均请求处理时间？

> ID：628229
> 
> 赞同：5
> 
> 时间：2009-03-09T22:11:19.217
> 
> 标签：diagnostics

请求处理的正常时间范围是多少？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T22:14:19.520

50ms 到 500ms 之间的任何时间都很好。

这当然只是服务器端。看看[Yahoo's Best Practices for Speeding Your Web Site](http://developer.yahoo.com/performance/rules.html)和[Firebug YSlow](http://developer.yahoo.com/yslow/)来学习和测量客户端的响应时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T22:30:39.060

以我有限的经验，如果响应通常需要一秒钟以上，用户通常会注意到交互式站点很慢。几秒钟或更长时间可能会令人抓狂。“交互式”是指用户将生成大量页面的地方，例如论坛。

这是一篇关于响应时间的有趣文章/书籍片段：[http ://www.useit.com/papers/responsetime.html](http://www.useit.com/papers/responsetime.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T22:16:37.767

任何慢于[8 秒](http://en.wikipedia.org/wiki/Network_performance)的内容通常都被认为太长。大多数重型网站的平均时间为 1-2 秒。

# java - 将受脚本感染的 JSP 应用程序转换为 Struts 的任何快速方法？

> ID：628234
> 
> 赞同：1
> 
> 时间：2009-03-09T22:12:17.607
> 
> 标签：java, jsp, struts

我们有一个旧版应用程序需要支持。它是纯JSP，即JSP 打开连接、处理业务逻辑、提交表单（通常是同一个JSP）等等。它有 400 多页，有些页面高达 100K。

该应用程序预计将在未来几年内进行扩展和修改，因此我们正在研究拆分表示和业务逻辑以简化维护的方法。至少我们希望将它移植到一些简单的 MVC 框架中（Struts 是#1 候选者）。

没有人热衷于手动重构每一页。我们有一个想法，可能在某个地方有一个工具至少可以进行部分重构，例如基于 JSP 中的 request.getParameter() 调用创建 ActionForm，将所有 Java 代码移动到 Action（尽管不可编译），替换一些“<% if" 与 <c:if 标签，等等。

剩下的工作还是很枯燥的，但至少范围小了很多。

有人知道这样的工具吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T22:25:13.333

我认为这不值得。你是说你有 400 多页，有些超过 10 万页？

# 10万！！！

可能最好的方法是对该 webapp 进行良好的分析，并将其模块化。您可以在其他框架中编写全新的模块，并且仍然可以结合使用。

对于 100K 的页面，它们是自己模块的良好候选者。

我真的看不出将整个 JSP 混乱转换成其他框架混乱有什么好处。将会发生的事情就是它会破碎成碎片，没有人愿意修理它们。

好的部分是？哪些模块将首先出现？还有什么不应该改变的？

我将从过去几个月发生了更多变化的那些开始。文件为 100K 的事实仅意味着必须添加新功能，但模型设计得非常糟糕，以至于没有创建新对象，而是简单地复制/粘贴了一些代码并放置在 if ( 我几乎觉得我有已经看到您的代码）并且文件不断增长。

有些部分似乎很容易迁移，但源代码控制表示 2 年内没有人接触过。别管他们。

不仅仅是使用一个不错的框架。您应该迁移并重新编写系统中受影响最大的部分，并创建测试用例。

此外，您应该创建一个项目样式并使用 checkstyle 等自动验证它，因此没有人提交新的快速补丁。

最终不会迁移所有应用程序，但新的更改将更容易执行，并且应用程序更易于维护。

# javascript - IE 中的 Tab 顺序问题，初始 Javascript 选择表单中的字段

> ID：628235
> 
> 赞同：3
> 
> 时间：2009-03-09T22:12:35.860
> 
> 标签：javascript, html, internet-explorer, browser, cross-browser

我试图在 html 中实现以下行为：向用户呈现一个包含多个文本字段的表单。这些字段填充了默认值，但在许多情况下，用户希望输入自己的值。当页面加载时，第一个字段中的值被选中，因此用户可以通过简单地开始键入并跳出到下一个字段来替换它，或者简单地将其保留并跳出。这是我所拥有的精简示例：

```
<html>
    <body onload="document.getElementById('helloField').select()">
        <form>
            <input id="helloField" value="hello"/><br/>
            <input value="goodbye"/><br/>
            <input type="submit" value="Submit"/>
        </form>
    </body>
</html> 
```

这适用于 Chrome（我相信还有 Firefox，但我这里没有）。在 IE 中，该字段是按预期选择的，但是当用户点击选项卡时，浏览器会跳到其地址栏而不是再见字段。如果我用一个简单的焦点替换选择，比如

```
<body onload="document.getElementById('helloField').focus()"> 
```

选项卡在所有浏览器中都可以，但这不是我想要的。我希望用户能够立即开始输入以替换默认值。

有人有想法么？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-10T04:29:25.110

聚焦，*然后*选择。

还可以考虑将代码直接放在有问题的输入之后的脚本块中。如果页面上有一堆图像，document.onload 可能会在很久以后触发，而您最不想做的就是在 onload 触发并劫持您的焦点时在输入框中输入内容（使您删除盒子）。

```
<input id="helloField" value="hello"/><br/>
<script type="text/javascript">
    var hello= document.getElementById('helloField');
    hello.focus();
    hello.select();
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T22:16:11.810

尝试使用 tabindex 设置字段的 tab 顺序：

```
<html>
    <body onload="document.getElementById('helloField').select()">
        <form>
            <input id="helloField" value="hello" tabindex="1" /><br/>
            <input value="goodbye" tabindex="2" /><br/>
            <input type="submit" value="Submit" tabindex="3" />
        </form>
    </body>
</html> 
```

# asp.net-mvc - 如何使 ASP.NET MVC 在 IIS 6 中工作？

> ID：628236
> 
> 赞同：7
> 
> 时间：2009-03-09T22:12:45.703
> 
> 标签：asp.net-mvc, iis-6, windows-server-2003

我已经在 Windows Server 2003 R2 机器中安装了 .NET Framework 3.5 SP1 和 ASP.NET MVC CTP，但我的 ASP.NET MVC 站点仍然无法在该服务器上运行。我在 Internet 和 IIS 上搜索解决方案，我注意到我不能为我的虚拟目录选择除 2.0 之外的其他 .NET Framework 版本。我几乎可以肯定，如果我纠正这个问题，我可以让我的网站在那里工作。

目前主要的“/”网址回答：

```
Directory Listing Denied
This Virtual Directory does not allow contents to be listed. 
```

“/Default.aspx” URL 回答如下：

```
Configuration Error
Description: An error occurred during the processing of a configuration file required to service this request. Please review the specific error details below and modify your configuration file appropriately.
Parser Error Message: Section or group name 'system.web.extensions' is already defined. 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T22:27:58.410

Phil Haack 在这里有一篇很好的文章

[http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx](http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-19T15:29:14.093

我有类似的问题。

1.  我最近升级了我的服务器以支持 .net framework 4.0。

2.  将我的应用程序转换为支持 .net fx 4.0。

3.  在服务器上部署应用程序并尝试测试.. 我收到“HTTP 错误 404 - 找不到文件或目录”

**解决方案**

1.  打开 IIS 管理器，展开主服务器节点（即 Servername 节点），然后选择 Web 服务扩展节点。

2.  在 IIS 管理器的右窗格中，右键单击扩展名“ASP.NET v4.0.*”。

3.  单击允许按钮。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T02:32:48.043

除了杰森的回答，常见的事情是：

*   启用通配符映射并将其指向 Phil 在 Jason 的链接中提到的 aspnet 程序集。

您收到的 /default.aspx 错误似乎是 web.config 配置错误。在 web.config 的最顶部，查找：

```
<sectionGroup name="system.web.extensions" 
```

很可能它被定义了两次。您只需要您拥有的 RC 版本的参考。如果您需要确切的 RC 引用，请在临时文件夹中创建一个新的 ASP.NET MVC Web 项目。然后从中获取 web.config。

-E

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T10:53:54.317

我也遇到了这个问题，在我的情况下，解决方案是卸载 ASP.NET MVC Beta。

我试图开始工作的应用程序部署了版本 1 MVC dlls bin，一旦卸载了 Beta，它就一切正常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-15T13:59:50.610

类似问题：我们尝试在 IIS6 机器上安装 MVC4/.NET 4 应用程序，按照描述设置所有内容，并得到相同的错误：

```
Directory Listing Denied
This Virtual Directory does not allow contents to be listed. 
```

对我们来说，最后的解决方法是将 UrlRoutingModule 添加到 web.config：

```
 <add name="UrlRoutingModule"
       type="System.Web.Routing.UrlRoutingModule, System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
```

这是有道理的，但我不知道为什么我们需要明确添加它而其他人没有。（我们是在Sharepoint下的一个目录下运行的，可能是相关的……）

# php - 日期和时间输入

> ID：628239
> 
> 赞同：1
> 
> 时间：2009-03-09T22:14:24.077
> 
> 标签：php, mysql, html, date, time

如何显示格式化日期的日期弹出框，使其适合 mySQL 日期字段？

另外，如何检查或格式化时间以适应 mySQL 时间字段？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T22:20:39.677

```
$mysqldate = date( 'Y-m-d H:i:s', $phpdate );
$phpdate = strtotime( $mysqldate ); 
```

编辑：

关于 PHP 中的日期/时间以及如何将其与 MySQL 一起使用的所有其他内容，都在精彩的 PHP 文档中：

[http://be.php.net/datetime](http://be.php.net/datetime)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T22:59:25.137

听起来您正在寻找某种小部件来允许用户输入日期和时间。请参阅此[堆栈溢出线程](https://stackoverflow.com/questions/576524/recommend-a-js-calendar-widget-that-handles-both-date-and-time)。

# .net - 为什么在 CCR 中使用因果关系会导致内存泄漏？

> ID：628241
> 
> 赞同：2
> 
> 时间：2009-03-09T22:14:44.747
> 
> 标签：.net, memory-leaks, ccr, causality

有没有人有关于使用因果关系的信息？我曾尝试在我的项目中使用它们但没有成功，因为它们似乎会导致大量内存负载。

这不寻常吗？

除了文档中给出的普通（又名过于简单）示例之外，没有太多关于在 CCR 代码中使用因果关系的信息。

我不能给出任何代码示例，因为我撕掉了因果关系并替换为更传统的异常处理（虽然在 CCR 中不是传统的！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T10:50:00.110

我最近才开始研究它们，所以我不能提供太多建议，但我会提供我能提供的：

1.  检查您的代码中是否有任何循环 - 是否有可能一次又一次地产生因果关系？这方面的一个例子是，您创建一个新的因果关系并将消息发布到另一个组件，该组件（最终）回发到您的组件，导致原始任务再次运行，因此因果关系“堆叠”在另一个组件上。一种方法是在添加新的之前检查 ActiveCausalities。
2.  您是否考虑尝试在添加它的同一范围的末尾显式删除因果关系？
3.  显然，DSS 广泛使用因果关系，因此，如果确实存在泄漏，那么您会认为他们已经找到了。
4.  同意，关于此主题的示例不足，因此如果不尝试了解实现，就很难知道最佳实践是什么。

* * *

看看[这个帖子](http://social.msdn.microsoft.com/Forums/en-US/roboticsccr/thread/e01fdd4d-2392-4d8e-b556-0c16e4ad4a8d/)。它建议您要在添加的范围末尾自动删除因果关系。

# c# - 如何在特定边界内绘制具有可变宽度边框的圆角矩形

> ID：628261
> 
> 赞同：20
> 
> 时间：2009-03-09T22:21:08.973
> 
> 标签：c#, gdi+, rounded-corners

我有一种方法可以绘制一个带边框的圆角矩形。边框可以是任何宽度，所以我遇到的问题是当边框很厚时，它会超出给定的边界，因为它是从路径的中心绘制的。

我将如何包含边框的宽度以使其完全适合给定的边界？

这是我用来绘制圆角矩形的代码。

```
private void DrawRoundedRectangle(Graphics gfx, Rectangle Bounds, int CornerRadius, Pen DrawPen, Color FillColor)
{
    GraphicsPath gfxPath = new GraphicsPath();

    DrawPen.EndCap = DrawPen.StartCap = LineCap.Round;

    gfxPath.AddArc(Bounds.X, Bounds.Y, CornerRadius, CornerRadius, 180, 90);
    gfxPath.AddArc(Bounds.X + Bounds.Width - CornerRadius, Bounds.Y, CornerRadius, CornerRadius, 270, 90);
    gfxPath.AddArc(Bounds.X + Bounds.Width - CornerRadius, Bounds.Y + Bounds.Height - CornerRadius, CornerRadius, CornerRadius, 0, 90);
    gfxPath.AddArc(Bounds.X, Bounds.Y + Bounds.Height - CornerRadius, CornerRadius, CornerRadius, 90, 90);
    gfxPath.CloseAllFigures();

    gfx.FillPath(new SolidBrush(FillColor), gfxPath);
    gfx.DrawPath(DrawPen, gfxPath);
} 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-10T00:31:11.877

好的，伙计们，我想通了！只需要缩小边界以考虑笔的宽度。我有点知道这是我只是想知道是否有办法在路径内部画一条线的答案。不过这很好用。

```
private void DrawRoundedRectangle(Graphics gfx, Rectangle Bounds, int CornerRadius, Pen DrawPen, Color FillColor)
{
    int strokeOffset = Convert.ToInt32(Math.Ceiling(DrawPen.Width));
    Bounds = Rectangle.Inflate(Bounds, -strokeOffset, -strokeOffset);

    DrawPen.EndCap = DrawPen.StartCap = LineCap.Round;

    GraphicsPath gfxPath = new GraphicsPath();
    gfxPath.AddArc(Bounds.X, Bounds.Y, CornerRadius, CornerRadius, 180, 90);
    gfxPath.AddArc(Bounds.X + Bounds.Width - CornerRadius, Bounds.Y, CornerRadius, CornerRadius, 270, 90);
    gfxPath.AddArc(Bounds.X + Bounds.Width - CornerRadius, Bounds.Y + Bounds.Height - CornerRadius, CornerRadius, CornerRadius, 0, 90);
    gfxPath.AddArc(Bounds.X, Bounds.Y + Bounds.Height - CornerRadius, CornerRadius, CornerRadius, 90, 90);
    gfxPath.CloseAllFigures();

    gfx.FillPath(new SolidBrush(FillColor), gfxPath);
    gfx.DrawPath(DrawPen, gfxPath);
} 
```

# c# - C#库安装？

> ID：628275
> 
> 赞同：0
> 
> 时间：2009-03-09T22:27:07.290
> 
> 标签：c#

我下载了两个不同的包，它们都带有一个 .XML 和一个 .DLL 文件。我使用了他们的一些源代码，但无法正常工作（缺少命名空间）。如何安装 XML 文件和 DLL 文件？我知道 dll 应该进入 system32/system 但我该如何处理 xml 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T22:31:54.470

实际上，您根本不需要安装 DLL。只需将其添加为项目的引用，然后正常使用即可。

XML 文件不是特别需要的。如果您愿意，它可用于为 DLL 生成文档。

编辑：还要确保在参考的属性中将“复制本地”（或类似的东西，不记得确切的措辞）设置为 True。这将确保 DLL 与您的 exe 位于同一目录中。否则它可能不会在加载路径中，然后您的应用程序将无法运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T22:36:32.837

您无需将其放在任何特定位置（该 system32 注释是一项较旧的技术）。

根据您提到的问题（缺少命名空间-> 编译时），您只需添加对项目的引用（右键单击项目-> 添加引用-> 浏览-> 选择 .net dll）。

# bash - 是否有一个 shell 命令可以递归地授予目录和文件的权限？

> ID：628277
> 
> 赞同：6
> 
> 时间：2009-03-09T22:27:28.583
> 
> 标签：bash, shell, command-line

有人可以给我一个递归命令，它将遍历一个目录并使所有普通文件权限为 644 和所有子目录为 755？

每次我必须在主机上安装某些东西时，我真的厌倦了手动执行此操作。我不知道足够的 BASH（Shell？）命令来执行此操作。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-09T22:34:35.167

有 X 选项。

```
chmod a+X * -R 
```

这将只为目录提供执行位，而不是文件。要使用一个命令分别设置 644、755，请使用：

```
chmod a=rX,u+w <files/dirs> -R 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-09T22:30:17.783

第一行更改文件权限，第二行更改活动目录及其子目录中的目录权限。

```
find . -type f -print0 | xargs -0 chmod 644
find . -type d -print0 | xargs -0 chmod 755 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T22:42:53.353

使用符号模式名称而不是原始数字权限：

```
chmod -R u=rwX,go=rX somedir 
```

权限标志仅将`X`目录或已经可执行的文件设置为可执行文件，该`-R`标志表示“递归”并将权限应用于`somedir`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T22:50:16.517

不，没有命令可以递归地更改权限。如果有这样的命令，那就违反了 Unix 的口头禅：做一件事，把它做好。

但是，有*两个*命令：一个用于递归 ( `find`)，另一个用于更改权限 ( `chmod`)。

所以，神奇的命令行是：

```
find . -type d -exec chmod 0755 '{}' + -or -type f -exec chmod 0644 '{}' + 
```

# asp.net - 如何使用 Team Build 部署 ASP.NET Web 应用程序？

> ID：628281
> 
> 赞同：4
> 
> 时间：2009-03-09T22:28:31.280
> 
> 标签：asp.net, tfs, tfsbuild

我已经成功安装了 Team Foundation Server 2008，并创建了一个单独的构建服务器（因为我的构建当前失败，所以它可以工作）。

我已经创建了一个简单的“Hello World”Web 应用程序（都是标准的 Default.aspx 页面）并将它放在 TFS 的源代码控制系统中。

***以前，在 TFS 之前，我只需预编译我的 Web 应用程序并将结果复制到预先创建的 IIS 虚拟目录中。***

在 Google 上搜索了一段时间，我还没有找到关于通过 TeamBuild 将应用程序从 TFS 源正确部署到指定测试 Web 服务器的分步指南。我知道 MS Build 属于这个等式，所以任何指导都会有所帮助。

我已经看到了有关部署的点点滴滴，其中提到了 _PublishedWebSites 等文件夹，但还没有一步一步地找到任何东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T16:34:18.050

我在 TFSBuild.proj 文件的 AfterDropBuild 目标中成功使用了 exec 任务。

```
<Target Name="AfterDropBuild>
    <Exec Command="xcopy /Y /E &quot;$(DropLocation)\\$(BuildNumber)\%(ConfigurationToBuild.FlavorToBuild)\_PublishedWebsites\MyWebsite1\*.*&quot; &quot;\\server\MyWebsite1\&quot;" />
    <Exec Command="xcopy /Y /E &quot;$(DropLocation)\\$(BuildNumber)\%(ConfigurationToBuild.FlavorToBuild)\_PublishedWebsites\MyWebsite2\*.*&quot; &quot;\\server\MyWebsite2\&quot;" />
</Target> 
```

请注意，需要正确设置权限，TFS 服务用户才能访问您要复制到的服务器上的文件夹。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T19:24:40.313

Firstly you should be using WebDeployment projects as this will do a lot more compilation and checking of your code and markup. See [here](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx) for more info.

I have 4 environments setup DV [Development], PY [Prototype], PP [Pre-Production], PD [Production] all matching branches in TFS. Each of these has also has an entry in the sln configuration manager where you can setup what projects are required to be build and the build flags.

Once that is setup correctly you can then start setting up deployment scripts. I prefer use MSbuild to deploy as it will give you a lot more fine-grained approach to deployment. MSbuild is a bit strange to start with however once you get the hang of it it's quite powerful.

My deployment script which is added to the TeamBuild config is below. Basically as you can see I do a bit of post-build cleanup before I copy to the live servers. I also use 2 MSbuild frameworks (imported at the top).

```
<Import Project="$(MSBuildExtensionsPath)\Microsoft\SDC Tasks - Release 2.1.3155.0\Microsoft.Sdc.Common.tasks"/>
<Import Project="$(MSBuildExtensionsPath)\FreeToDev\MSBuild Tasks Suite 3.5\FreeToDev.MSBuild.tasks"/>

<PropertyGroup>
    <InetpubFolder>\\PathToInetPub</InetpubFolder>
    <AppFolder>AppFolder</AppFolder>
    <AppFolderPath>$(InetpubFolder)$(AppFolder)</AppFolderPath>
    <WebDeployName>WebDeployProjectName</WebDeployName>
    <Debug>0</Debug>
    <AppConfiguration>DV</AppConfiguration>
</PropertyGroup>

<Target Name="AfterDropBuild">
    <Message Text="Begin Release to $(AppConfiguration) Webserver" />
    <Message Text="DropLocation = $(DropLocation)" />
    <CallTarget Targets="PostBuildCleanUp"  />
    <CallTarget Targets="DeployApp"  />
</Target>

<Target Name="DeployApp">

    <GetBuildProperties TeamFoundationServerUrl="$(TeamFoundationServerUrl)" BuildUri="$(BuildUri)">
        <Output TaskParameter="DropLocation" PropertyName="DropLocation"></Output>
    </GetBuildProperties>

    <PropertyGroup>
        <CodeDropLocation>$(DropLocation)\$(AppConfiguration) Release</CodeDropLocation>
    </PropertyGroup>

    <ItemGroup>
        <AppFilesToDelete Include="$(AppFolderPath)\**\*.*" Exclude="$(AppFolderPath)\Library\*.*;$(AppFolderPath)\App_Offline.htm;$(AppFolderPath)\jobs\**\*.*" />
    </ItemGroup>

    <ItemGroup>
        <FilesToDeploy Include="$(CodeDropLocation)\$(AppFolder)\**\*.*" Exclude="" />
    </ItemGroup>

    <Copy SourceFiles="$(CodeDropLocation)\$(AppFolder)\App_Offline[RemoveToActivate].htm" DestinationFiles="$(AppFolderPath)\App_Offline.htm" OverwriteReadOnlyFiles="true"/>

    <Message Text="Deleting files in $(AppFolderPath)" />
    <Microsoft.Sdc.Tasks.File.DeleteFiles Files="@(AppFilesToDelete)" Force="true" Condition="$(Debug)==0" />

    <Message Text="Copy $(CodeDropLocation)\$(AppFolder) to $(AppFolderPath)" />
    <Copy Condition="$(Debug)==0" SourceFiles="@(FilesToDeploy)" DestinationFiles="@(FilesToDeploy->'$(AppFolderPath)\%(RecursiveDir)%(Filename)%(Extension)')" SkipUnchangedFiles="true"/>

    <Message Text="Deploy to $(AppConfiguration) Completed" />
    <Microsoft.Sdc.Tasks.File.DeleteFiles Files="$(AppFolderPath)\App_Offline.htm" Force="true" />

    <OnError ExecuteTargets="ErrorHandler" />
</Target>

<Target Name="ErrorHandler">
    <Message Text="Error encountered!!" />
</Target>

<Target Name="PostBuildCleanUp">

    <GetBuildProperties TeamFoundationServerUrl="$(TeamFoundationServerUrl)" BuildUri="$(BuildUri)">
        <Output TaskParameter="DropLocation" PropertyName="DropLocation"></Output>
    </GetBuildProperties>

    <PropertyGroup>
        <CodeDropLocation>$(DropLocation)\$(AppConfiguration) Release</CodeDropLocation>
    </PropertyGroup>

    <ItemGroup>
        <PostBuildCleanUpFilesToDelete Include="$(CodeDropLocation)\*.*;$(CodeDropLocation)\bin\*.xml;$(CodeDropLocation)\bin\*.pdb"/>
    </ItemGroup>

    <RemoveDir Directories="$(CodeDropLocation)\_PublishedWebsites\Web" />
    <Microsoft.Sdc.Tasks.File.DeleteFiles Files="@(PostBuildCleanUpFilesToDelete)" Force="true">
        <Output TaskParameter="DeletedFiles" ItemName="FilesThatWereDeleted" />
    </Microsoft.Sdc.Tasks.File.DeleteFiles>
    <Message Text="The files that were removed were @(FilesThatWereDeleted)" />

    <FTDFolder TaskAction="Move" Path="$(CodeDropLocation)\_PublishedWebsites\$(WebDeployName)" TargetPath="$(CodeDropLocation)\$(AppFolder)"/>

    <RemoveDir Directories="$(CodeDropLocation)\_PublishedWebsites" />

    <RemoveDir Directories="$(CodeDropLocation)\$(AppFolder)\WebDeploy" />

    <OnError ExecuteTargets="ErrorHandler" />
</Target> 
```

Obviously you will need to modify to your system setup. Also it clears down the target folder before it starts to copy the new build accross. This is to make sure they system is clean but obviously you will need to add anything that you need to keep to the ExcludedFiles list.

I also have a folder for each environment in the main application project. This holds the web.config replacements (another feature of WebDeployment projects) and any other environement specifc files.

It will be a long process to get it working correctly but hopefully this will get you started!! (Obviously if you choose this apporach!)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T15:41:25.493

这可以直接通过构建脚本来完成，Vertigo Software 的人通常是解决许多此类 TFS 问题的最佳信息来源……不幸的是，他们的博客文章在谷歌上的排名通常不那么高。这是本网站的创建者之一杰夫·阿特伍德 (Jeff Atwood) 的作品：

[团队构建后复制 Web 文件](http://blogs.vertigosoftware.com/teamsystem/archive/2007/02/15/Copying_Web_Files_After_a_Team_Build.aspx)

# c# - C#编译器增强建议

> ID：628284
> 
> 赞同：13
> 
> 时间：2009-03-09T22:30:15.630
> 
> 标签：c#, .net

想象一下有人编写以下代码：

```
string s = "SomeString";
s.ToUpper(); 
```

我们都知道，在上面的例子中，对“ToUpper()”方法的调用是没有意义的，因为根本没有处理返回的字符串。但是，许多人犯了这个错误并花时间尝试通过问自己“为什么我的变量中的字符没有大写”来解决问题是什么？？？？？

那么，如果有一个属性可以应用于“ToUpper()”方法，如果返回对象没有被处理会产生编译器错误，那不是很好吗？类似于以下内容：

```
[MustHandleReturnValueAttribute]
public string ToUpper()
{
…
} 
```

如果为了正确编译此代码，用户必须像这样处理返回值：

```
string s = "SomeString";
string uppers = s.ToUpper(); 
```

我认为这将清楚地表明您必须处理返回值，否则调用该函数**毫无意义**。

在字符串示例的情况下，这可能没什么大不了的，但我可以想到其他更有效的原因为什么它会派上用场。

你们有什么感想？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T22:35:32.323

调用一个方法是为了它的副作用、它的返回值，还是两者兼而有之？“纯”函数（没有影响，仅用于计算返回值）可以很好地注释，既可以消除您描述的错误类型，也可以启用一些潜在的优化/分析。也许再过5年我们就会看到这种情况发生。

（请注意，当您隐式忽略返回值时，F# 编译器会发出警告。当您想显式忽略它时，可以使用“忽略”函数。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T22:59:52.173

如果您有 Resharper，它将为您突出显示类似的内容。不能高度推荐 resharper，它有很多有用的 IDE 添加，尤其是在重构方面。

[http://www.jetbrains.com/resharper/](http://www.jetbrains.com/resharper/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T22:56:28.297

我不确定我喜欢这个。我已经调用了许多返回我选择不捕获的值的方法。添加某种类型的默认值（编译器在未处理返回值时生成警告）对我来说似乎是错误的。

我确实同意建议中的某些内容可能会帮助新程序员，但在游戏中此时添加一个属性只会影响相对于现有大型主体的极少数方法。当编译器未标记大多数未处理的返回值时，同一位初级程序员永远不会解决这个问题。

回来的时候可能还不错，但是马已经离开了谷仓。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T23:03:59.760

我实际上更喜欢将结构或类标记为 [Immutable] 的方法，并为调用的方法自动处理（带有警告）而不在不可变对象上使用它们的返回值。这也可以保护编译器在创建对象后免受更改。

如果对象真的是一个不可变对象，那么真的没有办法处理它。它也可能被编译器用来捕捉其他常见错误。

不过，标记方法本身对我来说似乎没那么有用。我同意关于此的大多数其他评论。如果对象是可变的，则调用方法可能会产生其他副作用，因此上述代码可能完全有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T06:46:21.630

我有闪回在所有 printf() 调用上放置 (void) 强制转换，因为我无法让 Lint 闭嘴，因为返回值被忽略。

也就是说，这个功能似乎应该在一些代码检查工具中，而不是编译器本身。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T22:34:26.040

至少编译器警告会有所帮助。也许他们为 C# 4.0 (Design-By-Contract) 添加了类似的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T22:43:56.330

这不保证警告或编译指示。有太多地方打算丢弃结果，我会因为该方法被一些闪避属性修饰而从编译器收到警告/错误而感到非常恼火。

这种“警告”应该在 IDE 的编辑器中进行注释，例如装订线“警告：丢弃返回值”或类似内容上的小图标。

# java - Java Swing 问题

> ID：628290
> 
> 赞同：0
> 
> 时间：2009-03-09T22:31:23.753
> 
> 标签：java, swing, resources, classloader

我有一个卡片板，我必须在其中找到匹配项。我有两个变量`buttonA`并`buttonB`跟踪单击的方块。

当它们相等时，我可以通过简单地添加以下代码将它们从板上删除：

```
cards[buttonA].setVisible(false);
cards[buttonB].setVisible(false); 
```

找到匹配项后，如何在所有按钮上放置相同的图像？我尝试了以下操作，但它并没有更改图像，而是在按钮上留下相同的图像

```
cards[buttonA].setIcon(new ImageIcon("myPic.png"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T22:33:48.693

您可能需要使用：

```
new ImageIcon(getClass().getResource("/path/to/myPic.png")); 
```

此资源在`classpath`. （请记住，如果使用 IDE，您需要确保将 PNG 资源复制到输出目录。例如，在 IDEA 中，这是在编译器设置菜单中实现的）

**编辑：**我永远不记得路径是否以 a 开头`/`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T13:39:31.793

You can have a reference to the ImageIcon if you want to share it across buttons (instead of loading it everytime). To me your code should work. Maybe you can remove the current icon (using setIcon(null)) and then set it.

# artificial-intelligence - 进化算法和神经网络是否在同一个领域中使用？

> ID：628297
> 
> 赞同：20
> 
> 时间：2009-03-09T22:34:27.757
> 
> 标签：artificial-intelligence, machine-learning, neural-network, evolutionary-algorithm

我试图了解各类机器学习算法之间的区别。

我知道进化算法的实现与神经网络的实现有很大不同。

然而，它们似乎都倾向于从一组潜在嘈杂的训练/历史数据中确定输入和输出之间的相关性。

从定性的角度来看，与进化算法相比，是否存在更适合神经网络目标的问题域？

我浏览了一些建议以互补方式使用它们的文章。有没有一个像样的用例示例？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-10T01:44:08.580

这是交易：在机器学习问题中，您通常有两个组成部分：

a) 模型（功能类等）

b) 拟合模型的方法（优化算法）

神经网络是一个模型：给定布局和权重设置，神经网络会产生一些输出。存在一些拟合神经网络的规范方法，例如反向传播、对比散度等。但是，神经网络的重要之处在于，如果有人给了你“正确”的权重，你就会在这个问题上做得很好。

进化算法解决了第二部分——拟合模型。同样，有一些规范模型与进化算法一起使用：例如，进化编程通常会尝试优化特定类型的所有程序。但是，EA 本质上是一种为特定模型找到正确参数值的方法。通常，您以这样一种方式编写模型参数，即交叉操作是合理的做法，然后转动 EA 曲柄以获得合理的参数设置。

现在，例如，您可以使用进化算法来训练神经网络，我相信它已经完成了。然而，EA 需要工作的关键是交叉操作必须是合理的事情——通过从一个合理的设置中获取部分参数，而从另一个合理的设置中获取其余参数，您通常会得到一个更好的参数设置。大多数时候使用 EA，情况并非如此，它最终类似于模拟退火，只是更加混乱和低效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-10T00:52:15.210

需要“直觉”的问题更适合人工神经网络，例如手写识别。你用大量输入训练一个神经网络并对其进行评分直到你完成（这需要很长时间），但之后你有一个黑盒算法/系统可以“*猜测*”手写，所以你保持你的小大脑并将其用作模块多年或其他东西。因为为一个复杂的问题训练一个高质量的人工神经网络可能需要几个月的时间，我是最坏的情况，而且很幸运。

大多数其他进化算法以一种爬山模式在现场“*计算”一个临时解决方案。*

同样正如另一个答案中所指出的，在运行时，ANN 可以比大多数其他进化算法“*计算”更快地“**猜测*”。但是必须小心，因为 ANN 只是“*猜测*”，它可能是错误的。

 *** * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-04-06T03:29:42.063

进化的或更一般的遗传算法和神经网络都可以用于类似的目标，其他答案很好地描述了差异。

然而，有一种特殊情况是进化算法比神经网络更适用：**当解空间不可微时**。

事实上，神经网络使用梯度下降从反向传播（或类似算法）中学习。梯度的计算依赖于导数，它需要一个连续的导数空间，换句话说，您可以逐渐地从一个解决方案转移到下一个解决方案。

如果您的解决方案空间是不可微分的（即，您可以选择解决方案 A、B 或 C，但中间没有 0.5% A + 0.5% B，因此某些解决方案是不可能的），那么您正在尝试去拟合一个不可微的函数，然后神经网络就不能工作了。

（旁注：离散状态空间部分共享相同的问题，因此对于大多数算法来说是一个常见问题，但通常会做一些工作来解决这些问题，例如决策树可以轻松处理分类变量，而其他模型（如 svm）有更多的困难，通常需要将分类变量编码为连续值）。

在这种情况下，进化和遗传算法是完美的，甚至可以说是上帝派来的，因为它们可以毫无问题地从一个解决方案“跳跃”到下一个解决方案。他们不关心某些解决方案是不可能的，也不关心可能状态空间子集之间的差距是大是小，进化算法可以随机跳远或靠近，直到找到合适的解决方案。

另外值得一提的是，进化算法不像任何其他机器学习算法（包括神经网络）那样受到维度的诅咒。这似乎有点违反直觉，因为不能保证收敛到全局最大值，并且该过程似乎发展为一个好的解决方案似乎很慢，但实际上选择过程工作得很快并且收敛到一个好的局部最大值。

**这使得进化算法成为一种非常通用和通用的工具，可以天真地解决任何问题，并且是处理不可微函数、离散函数或天文高维数据集的极少数工具之一。**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-08T07:07:55.150

看看神经进化。(东北)

目前最好的方法是Kenneth Stanley 的[NEAT](http://www.cs.ucf.edu/~kstanley/neat.html)和[HyperNEAT](http://eplex.cs.ucf.edu/hyperNEATpage/HyperNEAT.html)。

遗传算法只能找到某种基因组。创建神经网络的基因组非常棒，因为您可以获得神经网络的反应特性，而不仅仅是一堆静态基因。

它可以学习的内容没有太多限制。但这当然需要时间。神经拓扑必须通过通常的变异和交叉以及权重更新来进化。不可能有反向传播。

您还可以使用适应度函数对其进行训练，因此当您不知道输出应该是什么时，它优于反向传播。非常适合学习您不知道任何最佳策略的系统的复杂行为。唯一的问题是它会学习你没有预料到的行为。通常，这种行为可能非常陌生，尽管它完全符合您在适应度函数中的奖励。因此，您将使用与为反向传播创建输出集一样多的时间来导出适应度函数：P

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T22:41:18.940

进化算法 (EA) 很慢，因为它们依赖于无监督学习：EA 被告知某些解决方案比其他解决方案更好，但不*知道如何*改进它们。神经网络通常更快，作为监督学习的一个实例：它们知道如何通过在函数空间内对某些参数使用梯度下降来改进解决方案；这使他们能够更快地找到有效的解决方案。当没有足够的关于问题的知识以使其他方法起作用时，通常会使用神经网络。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-05T08:09:32.040

在问题领域方面，我将通过反向传播训练的人工神经网络与进化算法进行了比较。

**进化算法**部署随机波束搜索，这意味着您的进化算子开发候选者以通过其适应度进行测试和比较。这些运算符通常是非确定性的，您可以对其进行设计，以便它们既可以找到靠近的候选者，也可以找到参数空间中更远的候选者，以克服陷入局部最优的问题。

然而，EA 方法的成功很大程度上取决于您开发的模型，这是在高表达潜力（您可能会过拟合）和通用性（模型可能无法表达目标函数）之间进行权衡。

因为**神经网络**通常是多层的，参数空间不是凸的并且包含局部最优，梯度下降算法可能会陷入困境。梯度下降是一种确定性算法，它通过非常接近的搜索。这就是为什么神经网络通常是随机初始化的，以及为什么你应该训练不止一个模型。

此外，您知道神经网络中的每个隐藏节点都定义了一个超平面，您可以设计一个神经网络，使其很好地适应您的问题。有一些技术可以防止神经网络过拟合。

总而言之，神经网络可以快速训练并获得合理的结果（只需尝试一些参数）。从理论上讲，足够大的神经网络能够逼近每个目标函数，另一方面，这使得它容易过度拟合。进化算法需要你做出很多设计选择才能获得好的结果，最难的可能是优化哪个模型。但是 EA 能够搜索非常复杂的问题空间（以您定义的方式）并快速获得良好的结果。当问题（目标函数）随时间变化时，AE 甚至可以保持成功。

Tom Mitchell 的机器学习书籍： [http ://www.cs.cmu.edu/~tom/mlbook.html](http://www.cs.cmu.edu/~tom/mlbook.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-10-13T09:44:00.263

进化算法 (EA) 代表了一种训练模型的方式，其中神经网络 (NN) 是一个模型。在整个文献中最常见的是，您会发现 NN 是使用反向传播算法进行训练的。这种方法对数学家非常有吸引力，但它要求您可以使用数学公式表达模型的错误率。在您知道要逼近的函数的大量输入和输出值的情况下，就是这种情况。这个问题可以在数学上建模，作为损失函数的最小化，这可以通过微积分来实现（这就是数学家喜欢它的原因）。

但是神经元网络对于试图最大化或最小化某些结果的建模系统也很有用，其公式很难在数学上建模。例如，神经元网络可以控制机器人的肌肉来实现跑步。在每个不同的时间范围内，模型必须根据来自各种传感器的输入来确定机器人身体的每块肌肉中应该存在多少张力。提供这样的训练数据是不可能的。EA 仅通过提供一种模型评估方式来允许训练。对于我们的示例，我们将惩罚跌倒并奖励穿过表面的行进距离（在固定的时间范围内）。EA 只会选择在这个意义上做得最好的模型。第一代很糟糕，但令人惊讶的是，在几百代之后，这些人取得了非常大的成就。”

# html - CSS3 的border-radius 属性和border-collapse:collapse 不能混用。如何使用border-radius创建一个圆角折叠表？

> ID：628301
> 
> 赞同：361
> 
> 时间：2009-03-09T22:35:07.270
> 
> 标签：html, css, rounded-corners, html-table

**编辑 - 原标题：**有没有其他方法可以实现`border-collapse:collapse`（`CSS`为了有一个折叠的圆角桌）？

事实证明，简单地让表格的边框折叠并不能解决根本问题，我更新了标题以更好地反映讨论。

**我正在尝试使用该`CSS3` `border-radius`属性**制作一张圆角的桌子。**我使用的表格样式如下所示：**

 **```
table {
    -moz-border-radius:10px;
    -webkit-border-radius:10px;
    border-radius:10px
} 
```

这就是问题所在。我也想设置`border-collapse:collapse`属性，当设置`border-radius`不再有效。有没有一种基于 CSS 的方式，我可以获得与`border-collapse:collapse`不实际使用它相同的效果？

**编辑：**

我制作了一个简单的页面来演示[这里](http://vamin.net/examples/rounded_tables.html)的问题（仅限 Firefox/Safari）。

似乎很大一部分问题在于将表格设置为圆角不会影响角`td`元素的角。如果表格都是一种颜色，这不会有问题，因为我可以`td`分别为第一行和最后一行制作顶角和底角。但是，我为表格使用不同的背景颜色来区分标题和条纹，因此内部`td`元素也会显示它们的圆角。

**建议的解决方案摘要：**

用另一个圆角元素围绕桌子不起作用，因为桌子的方角“渗出”。

将边框宽度指定为 0 不会折叠表格。

`td`将单元格间距设置为零后，底角仍然是方形的。

改用 JavaScript 可以避免问题。

**可能的解决方案：**

这些表是用 PHP 生成的，所以我可以对每个外部 th/tds 应用不同的类并分别设置每个角的样式。我宁愿不这样做，因为它不是很优雅，而且应用于多个表有点痛苦，所以请不断提出建议。

可能的解决方案 2 是使用 JavaScript（特别是 jQuery）来设置角的样式。这个解决方案也有效，但仍然不是我想要的（我知道我很挑剔）。我有两个保留：

1.  这是一个非常轻量级的网站，我希望将 JavaScript 保持在最低限度
2.  使用边界半径对我的部分吸引力是优雅的退化和渐进的增强。通过对所有圆角使用边框半径，我希望在支持 CSS3 的浏览器中拥有一个始终如一的圆形站点，在其他浏览器中拥有一个始终如一的方形站点（我在看着你，IE）。

我知道今天尝试用 CSS3 来做这件事似乎没有必要，但我有我的理由。我还想指出，这个问题是 w3c 规范的结果，而不是糟糕的 CSS3 支持，所以当 CSS3 得到更广泛的支持时，任何解决方案仍然是相关和有用的。

* * *

## 回答 #1

> 赞同：278
> 
> 时间：2009-03-11T18:53:29.970

我想到了。你只需要使用一些特殊的选择器。

圆角表的问题是 td 元素也没有变成圆角。您可以通过执行以下操作来解决此问题：

```
 table tr:last-child td:first-child {
        border: 2px solid orange;
        border-bottom-left-radius: 10px;
    }

    table tr:last-child td:last-child {
        border: 2px solid green;
        border-bottom-right-radius: 10px;
    }
```

```
<table>
  <tbody>
    <tr>
      <td>
        1
      </td>
      <td>
        2
      </td>
    </tr>
    <tr>
      <td>
        3
      </td>
      <td>
        4
      </td>
    </tr>
  </tbody>
</table>
```

现在一切正常，除了仍然存在`border-collapse: collapse`破坏一切的问题。

一种解决方法是在表中[添加`border-spacing: 0`](https://developer.mozilla.org/en-US/docs/Web/CSS/border-spacing)并保留默认值`border-collapse: separate`。

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2010-04-06T17:09:18.567

以下方法通过使用`box-shadow`带有扩展`1px`而不是“真实”边框的 a 来工作（在 Chrome 中测试）。

```
 table {
        border-collapse: collapse;
        border-radius: 30px;
        border-style: hidden; /* hide standard table (collapsed) border */
        box-shadow: 0 0 0 1px #666; /* this draws the table border  */ 
    }

    td {
        border: 1px solid #ccc;
    }
```

```
<table>
  <thead>
    <tr>
      <th>Foo</th>
      <th>Bar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Baz</td>
      <td>Qux</td>
    </tr>
    <tr>
      <td>Life is short</td>
      <td rowspan="3">and</td>
    </tr>
    <tr>
      <td>Love</td>
    </tr>
    <tr>
      <td>is always over</td>
    </tr>
    <tr>
      <td>In the</td>
      <td>Morning</td>
    </tr>
  </tbody>
</table>
```

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2011-01-24T18:56:28.733

如果您想要一个允许 1px 边框的纯 CSS 解决方案（无需`cellspacing=0`在 HTML 中设置）（您无法使用该`border-spacing: 0`解决方案），我更喜欢执行以下操作：

*   为表格单元格（和）设置一个`border-right`和`border-bottom``td``th`
*   给**第一行**的单元格一个`border-top`
*   给**第一列**中的单元格一个`border-left`
*   使用`first-child`和`last-child`选择器，为四个角中的表格单元格圆角。

[在此处查看演示。](http://codepen.io/mlms13/pen/CGgLF)

给定以下 HTML：

请参见下面的示例：

```
 table {
  border-collapse: separate;
  border-spacing: 0;
  min-width: 350px;
}
table tr th,
table tr td {
  border-right: 1px solid #bbb;
  border-bottom: 1px solid #bbb;
  padding: 5px;
}

table tr th:first-child,
table tr td:first-child {
  border-left: 1px solid #bbb;
}
table tr th:first-child,
table tr td:first-child {
  border-left: 1px solid #bbb;
}
table tr th {
  background: #eee;
  text-align: left;
  border-top: solid 1px #bbb;
}

/* top-left border-radius */
table tr:first-child th:first-child {
  border-top-left-radius: 6px;
}

/* top-right border-radius */
table tr:first-child th:last-child {
  border-top-right-radius: 6px;
}

/* bottom-left border-radius */
table tr:last-child td:first-child {
  border-bottom-left-radius: 6px;
}

/* bottom-right border-radius */
table tr:last-child td:last-child {
  border-bottom-right-radius: 6px;
}
```

```
<div>
    <table>
        <tr>
            <th>item1</th>
            <th>item2</th>
        </tr>
        <tr>
            <td>item1</td>
            <td>item2</td>
        </tr>
        <tr>
            <td>item1</td>
            <td>item2</td>
        </tr>
        <tr>
            <td>item1</td>
            <td>item2</td>
        </tr>
    </table>
</div>
```

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2010-10-18T04:16:58.123

您是否尝试过使用`table{border-spacing: 0}`而不是`table{border-collapse: collapse}`???

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2009-03-09T22:56:40.620

您可能必须在表格周围放置另一个元素并使用圆形边框对其进行样式设置。

[工作草案](http://www.w3.org/TR/css3-background/)规定当的值为时`border-radius`不适用于表格元素。`border-collapse``collapse`

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2013-01-06T21:27:15.277

正如伊恩所说，解决方案是将表格嵌套在一个 div 中并像这样设置它：

```
.table_wrapper {
  border-radius: 5px;
  overflow: hidden;
} 
```

使用`overflow:hidden`，方角不会流过 div。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-03-09T22:54:11.187

据我所知，您可以这样做的唯一方法是修改所有单元格，如下所示：

```
table td {
  border-right-width: 0px;
  border-bottom-width: 0px;
} 
```

然后得到底部和右后的边框

```
table tr td:last-child {
  border-right-width: 1px;
}
table tr:last-child td {
  border-bottom-width: 1px;
} 
```

`:last-child`在 ie6 中无效，但如果您使用的是`border-radius`我假设您不在乎。

**编辑：**

查看您的示例页面后，您似乎可以使用单元格间距和填充来解决此问题。

您看到的粗灰色边框实际上是表格的背景（如果将边框颜色更改为红色，您可以清楚地看到这一点）。如果将单元格间距设置为零（或等效地：），`td, th { margin:0; }`灰色“边框”将消失。

**编辑2：**

我找不到只用一张桌子就能做到这一点的方法。如果您将标题行更改为嵌套表，您可能可以获得您想要的效果，但它会做更多的工作，而不是动态的。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2017-10-24T11:45:08.853

实际上你可以添加你的`table`inside a`div`作为它的包装器。然后将这些`CSS`代码分配给包装器：

```
.table-wrapper {
  border: 1px solid #f00;
  border-radius: 5px;
  overflow: hidden;
}

table {
  border-collapse: collapse;
} 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2011-08-25T01:43:02.107

我尝试了一种使用伪元素的解决方法，`:before`并且`:after``thead th:first-child``thead th:last-child`

结合用包裹桌子`<div class="radius borderCCC">`

```
table thead th:first-child:before{ 
    content:" ";
    position:absolute;
    top:-1px;
    left:-1px;
    width:15px;
    height:15px;
    border-left:1px solid #ccc;
    border-top:1px solid #ccc; 
    -webkit-border-radius:5px 0px 0px;
}
table thead th:last-child:after{ 
    content:" "; 
    position:absolute; 
    top:-1px;
    right:-1px; 
    width:15px;
    height:15px;
    border-right:1px solid #ccc;
    border-top:1px solid #ccc;
    -webkit-border-radius:0px 5px 0px 0px;
} 
```

见[jsFiddle](http://jsfiddle.net/adardesign/PhaaP/)

在 chrome (13.0.782.215) 中适用于我，让我知道这是否适用于其他浏览器。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2020-02-14T10:17:52.493

这是一种方法：

```
div {
  border: 2px solid red;
  overflow: hidden;
  border-radius: 14px;
  transform: rotate(0deg);
}
table {
  border-spacing: 0;
  background-color: blue;
  height: 100%;
  width: 100%;
}
```

```
<div>
  <table>
    <tr>
      <td><br></td> 
    </tr>
  </table>
</div>
```

或者

```
 div {
      ...
      overflow: hidden;
      border-radius: 14px;
      position: relative;
      z-index: 1;
    } 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2011-07-15T10:44:33.070

给定的答案仅在桌子周围没有边框时才有效，这是非常有限的！

我在 SASS 中有一个宏来执行此操作，它完全支持外部*和*内部边框，实现与边框折叠相同的样式：折叠而不实际指定它。

在 FF/IE8/Safari/Chrome 中测试。

在所有浏览器中以纯 CSS 提供漂亮的圆形边框，但 IE8（优雅地降级），因为 IE8 不支持边框半径:(

一些[较旧的浏览器可能需要供应商前缀](http://caniuse.com/#feat=border-radius)才能使用`border-radius`，因此请随时根据需要将这些前缀添加到您的代码中。

这个答案不是最短的 - 但它有效。

```
.roundedTable {
  border-radius: 20px / 20px;
  border: 1px solid #333333;
  border-spacing: 0px;
}
.roundedTable th {
  padding: 4px;
  background: #ffcc11;
  border-left: 1px solid #333333;
}
.roundedTable th:first-child {
  border-left: none;
  border-top-left-radius: 20px;
}
.roundedTable th:last-child {
  border-top-right-radius: 20px;
}
.roundedTable tr td {
  border: 1px solid #333333;
  border-right: none;
  border-bottom: none;
  padding: 4px;
}
.roundedTable tr td:first-child {
  border-left: none;
} 
```

要应用此样式，只需更改您的

```
<table> 
```

标记到以下内容：

```
<table class="roundedTable"> 
```

并确保在您的 HTML 中包含上述 CSS 样式。

希望这可以帮助。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2014-03-14T21:43:47.670

我刚刚为此编写了一组疯狂的 CSS，看起来效果很好：

```
 table {
      border-collapse: separate;
      border-spacing: 0;
      width: 100%;
    }
    table td,
    table th {
      border-right: 1px solid #CCC;
      border-top: 1px solid #CCC;
      padding: 3px 5px;
      vertical-align: top;
    }
    table td:first-child,
    table th:first-child {
      border-left: 1px solid #CCC;
    }
    table tr:last-child td,
    table tr:last-child th {
      border-bottom: 1px solid #CCC;
    }
    table thead + tbody tr:first-child td {
      border-top: 0;
    }
    table thead td,
    table th {
      background: #EDEDED;
    }

    /* complicated rounded table corners! */
    table thead:first-child tr:last-child td:first-child {
      border-bottom-left-radius: 0;
    }
    table thead:first-child tr:last-child td:last-child {
      border-bottom-right-radius: 0;
    }
    table thead + tbody tr:first-child td:first-child {
      border-top-left-radius: 0;
    }
    table thead + tbody tr:first-child td:last-child {
      border-top-right-radius: 0;
    }
    table tr:first-child td:first-child,
    table thead tr:first-child td:first-child {
      border-top-left-radius: 5px;
    }
    table tr:first-child td:last-child,
    table thead tr:first-child td:last-child {
      border-top-right-radius: 5px;
    }
    table tr:last-child td:first-child,
    table thead:last-child tr:last-child td:first-child {
      border-bottom-left-radius: 5px;
    }
    table tr:last-child td:last-child,
    table thead:last-child tr:last-child td:last-child {
      border-bottom-right-radius: 5px;
    }
```

```
<table>
  <thead>
    <tr>
      <th>
        Table Head
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        Table Data
      </td>
    </tr>
  </tbody>
</table>
```

```
/* end complicated rounded table corners !*/ 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2010-11-26T23:37:41.983

我有同样的问题。完全删除`border-collapse`并使用： `cellspacing="0" cellpadding="0"` 在 html 文档中。例子：

```
<table class="top_container" align="center" cellspacing="0" cellpadding="0"> 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2013-06-08T15:26:01.327

对于有边框和可滚动的表格，使用这个（替换变量，`$`起始文本）

如果您使用`thead`, `tfoot`or ，`th`只需用它们替换`tr:first-child`and 。`tr-last-child``td`

```
#table-wrap {
  border: $border solid $color-border;
  border-radius: $border-radius;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
table td { border: $border solid $color-border; }
table td:first-child { border-left: none; }
table td:last-child { border-right: none; }
table tr:first-child td { border-top: none; }
table tr:last-child td { border-bottom: none; }
table tr:first-child td:first-child { border-top-left-radius: $border-radius; }
table tr:first-child td:last-child { border-top-right-radius: $border-radius; }
table tr:last-child td:first-child { border-bottom-left-radius: $border-radius; }
table tr:last-child td:last-child { border-bottom-right-radius: $border-radius; } 
```

HTML：

```
<div id=table-wrap>
  <table>
    <tr>
       <td>1</td>
       <td>2</td>
    </tr>
    <tr>
       <td>3</td>
       <td>4</td>
    </tr>
  </table>
</div> 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2012-11-28T18:32:53.550

带有边框折叠的解决方案：表格和显示分开：tbody 和thead 的内联表格。

```
table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0px;
  background: transparent;   
}
table thead {
  display: inline-table;
  width: 100%;
  background: #fc0 url(../images/bg-heading.png) repeat-x 0% 0;
  -webkit-border-top-left-radius: 7px;
  -moz-border-radius-topleft: 7px;
  -webkit-border-top-right-radius: 7px;
  -moz-border-radius-topright: 7px;
    border-radius: 7px 7px 0px 0px;
  padding: 1px;
  padding-bottom: 0;
}

table tbody {
  border: 1px solid #ddd;
  display: inline-table;
  width: 100%;
  border-top: none;        
} 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2015-02-08T21:59:09.267

我是 HTML 和 CSS 的新手，我也在寻找解决方案，在这里我找到了。

```
table,th,td {
   border: 1px solid black;
   border-spacing: 0
}
/* add border-radius to table only*/
table {
   border-radius: 25px    
}
/* then add border-radius to top left border of left heading cell */
th:first-child {
   border-radius: 25px 0 0 0
}
/* then add border-radius to top right border of right heading cell */
th:last-child {
   border-radius: 0 25px 0 0
}
/* then add border-radius to bottom left border of left cell of last row */
tr:last-child td:first-child {
   border-radius: 0 0 0 25px
}
/* then add border-radius to bottom right border of right cell of last row */
tr:last-child td:last-child {
   border-radius: 0 0 25px 0
} 
```

我试试看，猜猜它的工作原理:)

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2016-09-27T17:23:10.530

在遇到同样的问题后找到了这个答案，但发现它很简单：只需给表溢出：隐藏

不需要包装元素。当然，我不知道这在 7 年前最初提出问题时是否可行，但现在可行。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2011-09-22T02:07:50.833

[这是一个最近的例子，说明如何从http://medialoot.com/preview/css-ui-kit/demo.html](http://medialoot.com/preview/css-ui-kit/demo.html)实现一个带有圆角的表格。它基于上面 Joel Potter 建议的特殊选择器。如您所见，它还包含一些让 IE 开心一点的魔法。它包括一些额外的样式来交替行的颜色：

```
table-wrapper {
  width: 460px;
  background: #E0E0E0;
  filter: progid: DXImageTransform.Microsoft.gradient(startColorstr='#E9E9E9', endColorstr='#D7D7D7');
  background: -webkit-gradient(linear, left top, left bottom, from(#E9E9E9), to(#D7D7D7));
  background: -moz-linear-gradient(top, #E9E9E9, #D7D7D7);
  padding: 8px;
  -webkit-box-shadow: inset 0px 2px 2px #B2B3B5, 0px 1px 0 #fff;
  -moz-box-shadow: inset 0px 2px 2px #B2B3B5, 0px 1px 0 #fff;
  -o-box-shadow: inset 0px 2px 2px #B2B3B5, 0px 1px 0 #fff;
  -khtml-box-shadow: inset 0px 2px 2px #B2B3B5, 0px 1px 0 #fff;
  box-shadow: inset 0px 2px 2px #B2B3B5, 0px 1px 0 #fff;
  -webkit-border-radius: 10px;
  /*-moz-border-radius: 10px; firefox doesn't allow rounding of tables yet*/
  -o-border-radius: 10px;
  -khtml-border-radius: 10px;
  border-radius: 10px;
  margin-bottom: 20px;
}
.table-wrapper table {
  width: 460px;
}
.table-header {
  height: 35px;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 14px;
  text-align: center;
  line-height: 34px;
  text-decoration: none;
  font-weight: bold;
}
.table-row td {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 14px;
  text-align: left;
  text-decoration: none;
  font-weight: normal;
  color: #858585;
  padding: 10px;
  border-left: 1px solid #ccc;
  -khtml-box-shadow: 0px 1px 0px #B2B3B5;
  -webkit-box-shadow: 0px 1px 0px #B2B3B5;
  -moz-box-shadow: 0px 1px 0px #ddd;
  -o-box-shadow: 0px 1px 0px #B2B3B5;
  box-shadow: 0px 1px 0px #B2B3B5;
}
tr th {
  border-left: 1px solid #ccc;
}
tr th:first-child {
 -khtml-border-top-left-radius: 8px;
  -webkit-border-top-left-radius: 8px;
  -o-border-top-left-radius: 8px;
  /*-moz-border-radius-topleft: 8px; firefox doesn't allow rounding of tables yet*/
  border-top-left-radius: 8px;
  border: none;
}
tr td:first-child {
  border: none;
}
tr th:last-child {
  -khtml-border-top-right-radius: 8px;
  -webkit-border-top-right-radius: 8px;
  -o-border-top-right-radius: 8px;
  /*-moz-border-radius-topright: 8px; firefox doesn't allow rounding of tables yet*/
  border-top-right-radius: 8px;
}
tr {
  background: #fff;
}
tr:nth-child(odd) {
  background: #F3F3F3;
}
tr:nth-child(even) {
  background: #fff;
}
tr:last-child td:first-child {
  -khtml-border-bottom-left-radius: 8px;
  -webkit-border-bottom-left-radius: 8px;
  -o-border-bottom-left-radius: 8px;
  /*-moz-border-radius-bottomleft: 8px; firefox doesn't allow rounding of tables yet*/
  border-bottom-left-radius: 8px;
}
tr:last-child td:last-child {
  -khtml-border-bottom-right-radius: 8px;
  -webkit-border-bottom-right-radius: 8px;
  -o-border-bottom-right-radius: 8px;
  /*-moz-border-radius-bottomright: 8px; firefox doesn't allow rounding of tables yet*/
  border-bottom-right-radius: 8px;
} 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2012-05-30T22:00:54.107

我开始尝试“显示”，我发现：`border-radius`, `border`, `margin`, `padding`, 在 a`table`中显示为：

```
display: inline-table; 
```

例如

```
table tbody tr {
  display: inline-table;
  width: 960px; 
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  border-radius: 5px;
} 
```

但是我们需要`width`为每一列设置一个

```
tr td.first-column {
  width: 100px;
}
tr td.second-column {
  width: 860px;
} 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2018-08-23T10:32:28.013

带有圆角和带边框的单元格的表格。使用**@Ramon Tayag**解决方案。

**`border-spacing: 0`**正如他指出的那样，关键是要使用。

使用**SCSS**的解决方案。

```
$line: 1px solid #979797;
$radius: 5px;

table {
  border: $line;
  border-radius: $radius;
  border-spacing: 0;
  th,
  tr:not(:last-child) td {
    border-bottom: $line;
  }
  th:not(:last-child),
  td:not(:last-child) {
    border-right: $line;
  }
} 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2020-07-30T06:20:10.907

最简单的方法...

```
table {
 border-collapse: inherit;
 border: 1px solid black;
 border-radius: 5px;
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-08-11T13:34:29.877

我总是使用 Sass 这样做

```
table {
  border-radius: 0.25rem;
  thead tr:first-child th {
    &:first-child {
      border-top-left-radius: 0.25rem;
    }
    &:last-child {
      border-top-right-radius: 0.25rem;
    }
  }
  tbody tr:last-child td {
    &:first-child {
      border-bottom-left-radius: 0.25rem;
    }
    &:last-child {
      border-bottom-right-radius: 0.25rem;
    }
  }
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-10-15T01:40:45.790

迄今为止最好的解决方案来自您自己的解决方案，它是这样的：

```
table, tr, td, th{
  border: 1px solid; 
  text-align: center;
}

table{
	border-spacing: 0;
  width: 100%;
  display: table;
}

table tr:last-child td:first-child, tr:last-child, table {
    border-bottom-left-radius: 25px;
}

table tr:last-child td:last-child, tr:last-child, table {
    border-bottom-right-radius: 25px;
}

table tr:first-child th:first-child, tr:first-child, table {
    border-top-left-radius: 25px;
}

table tr:first-child th:last-child, tr:first-child, table {
    border-top-right-radius: 25px;
}
```

```
<table>
  <tr>
    <th>Num</th><th>Lett</th><th>Lat</th>
  </tr>
  <tr>
    <td>1</td><td>A</td><td>I</td>
  </tr>
  <tr>
    <td>2</td><td>B</td><td>II</td>
  </tr>
  <tr>
    <td>3</td><td>C</td><td>III</td>
  </tr>
</table>
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-06-06T12:47:38.840

```
table {
  width: 200px;
  text-align: center;
  border-radius: 12px;
  overflow: hidden;
}

table td {
  border-width: 1px 0 0 1px;
}

table tr:first-child td {
  border-top: none;
}

table tr td:first-child {
  border-left: none;
}

div {
  background-color: lime;
}
```

```
<table cellspacing="0" cellpadding="0" border="1">
  <tr>
    <td><div>1</div></td>
    <td>1</td>
    <td>1</td>
    <td>1</td>
  </tr>
  <tr>
    <td>1</td>
    <td>1</td>
    <td>1</td>
    <td>1</td>
  </tr>
  <tr>
    <td>1</td>
    <td>1</td>
    <td>1</td>
    <td>1</td>
  </tr>
</table>
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-08-30T12:04:06.520

其他一些答案很好，但没有一个认为您使用`thead`,`tbody`和`tfoot`. 或者情况，当你可以将它们组合起来时。当你应用它们时，你会得到一些不必要的舍入或边框。因此，我尝试从 @NullUserException 调整仅 css 的答案，这就是我得到的：

```
table {
    border-radius: 5px;
    border-width: 2px;
    border-style: solid;
    border-color: darkgreen;
    border-spacing: 0;
    border-collapse: separate;
    width: 100%;
}
table tr td,
table tr th {
    border-right-width: 2px;
    border-right-style: solid;
    border-right-color: darkgreen;
    border-bottom-width: 2px;
    border-bottom-style: solid;
    border-bottom-color: darkgreen;
}
table tr th:last-child,
table tr td:last-child {
    border-right-width: 2px;
    border-right-style: none;
    border-right-color: darkgreen;
}
table tr:last-child td,
table tr:last-child th {
    border-bottom-width: 2px;
    border-bottom-style: none;
    border-bottom-color: darkgreen;
}
/* top-left border-radius */
table :not(tfoot) tr:first-child th:first-child,
table :not(tfoot) tr:first-child td:first-child {
    border-top-left-radius: 5px;
    border-bottom-left-radius: 0;
}

/* top-right border-radius */
table :not(tfoot) tr:first-child th:last-child,
table :not(tfoot) tr:first-child td:last-child {
    border-top-right-radius: 5px;
    border-bottom-right-radius: 0;
}

/* bottom-left border-radius */
table :not(thead) tr:last-child th:first-child,
table :not(thead) tr:last-child td:first-child {
    border-bottom-left-radius: 5px;
}

/* bottom-right border-radius */
table :not(thead) tr:last-child th:last-child,
table :not(thead) tr:last-child td:last-child{
    border-bottom-right-radius: 5px;
}

/*Handle thead and tfoot borders*/
table thead tr:first-child th,
table thead tr:first-child td {
  border-top-style: none;
}
table thead tr:last-child th,
table thead tr:last-child td {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: darkgreen;
}
table tfoot tr:last-child th,
table tfoot tr:last-child td {
  border-bottom-style: none;
}
table tfoot tr:first-child th,
table tfoot tr:first-child td {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: darkgreen;
}
table tr:first-child th,
table tr:first-child td {
  border-top-style: none;
} 
```

`darkgreen`用于清楚地表明整个表格的任何地方的边界都是正确的。从本质上讲，无论您在哪里看到`darkgreen`- 就是您设置表格边框的位置。
此[代码笔](https://codepen.io/Simbiat/pen/gORPPBV)显示常规表格和带有`thead`,`tbody`和的表格`tfoot`。CSS 与上面的相同，只是为`th`. 在撰写本文时，您可以看到它们的渲染相同。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2022-02-12T05:16:00.177

使用“溢出：隐藏”和“边界半径”这也适用于“折叠”表

例子：

边界半径：1em；溢出：隐藏；

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2011-11-17T00:38:21.753

现在正式支持边界半径。因此，在上述所有示例中，您都可以删除“-moz-”前缀。

另一个技巧是使用与边框相同的颜色作为顶行和底行。所有 3 种颜色都相同，它融合在一起，看起来像一个完美的圆桌，即使它不是物理的。

# javascript - 如何避免 JavaScript 小部件中的名称冲突

> ID：628306
> 
> 赞同：5
> 
> 时间：2009-03-09T22:36:36.113
> 
> 标签：javascript, html, widget

我有一个嵌入在其他网站上的 JavaScript 小部件（一段嵌入的 JS 和 HTML 代码）。我应该怎么做才能确保它的变量名不会与托管页面变量发生冲突？

我希望这个小部件与托管页面在同一页面上“内联”，**而不是**在 iframe 中，避免与托管页面发生名称冲突或与其他小部件发生冲突的最佳方法是什么？

名称冲突可能以多种方式发生：

*   JavaScript 变量名
*   JavaScript 函数名称
*   DOM 元素标识符
*   CSS 类名
*   也许更多...

我可以想到几种避免名称冲突的方法，但我想知道是否有最佳实践或其他一般性建议。所以这是我的2c：

1.  只需使用长且尝试唯一的名称。这是丑陋的，不是完全证明，但在概念上很简单。
2.  使用 iframe。但如前所述，我不想使用 iframe 有几个原因。我希望小部件从页面继承样式属性（例如默认字体和背景颜色），最重要的是，我不知道小部件会有多大。它取决于实时数据，可以是任意大小。
3.  使用匿名函数以获得更好的范围，例如 (function(){my code here})()。这个解决方案虽然很优雅，但首先仍然不适用于我 b/c，它只解决了 JS 名称冲突而不是 DOM ID 或 CSS 类名称，其次，我还使用了 jsonp，我需要为其提供回调函数name，最终需要在全局范围内，所以不能嵌套在匿名函数范围内。
4.  在 JavaScript 中创建一个命名空间机制，它将提供 JS 变量和函数的唯一性。样式 window['my_app'][variable_name] 或 window['my_app']function_name 的东西。这也有点难看，但至少我可以控制命名空间并且可以生成保证是唯一的命名空间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T22:43:45.753

Javascript 命名空间：

[http://www.codeproject.com/KB/scripting/jsnamespaces.aspx](http://www.codeproject.com/KB/scripting/jsnamespaces.aspx)

它在几个 javascript 框架/库中大量使用，例如 YUI：http: [//developer.yahoo.com/yui/yahoo/](http://developer.yahoo.com/yui/yahoo/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T12:46:45.740

在我之前的项目中，我有一个嵌入在其他站点上的小部件，为了防止名称冲突，我在嵌入站点中使用的所有名称都加上了两个字母前缀（我从 Objective C 中得到了这个想法，所有类都从这里开始带有像 NS...这样的前缀）。

当然，我也使用了命名空间（例如 var Foo = { bar: function() { ... }}）和“类”（使用 John Resig 的类实现），因为无论我是否有小部件，我都会使用它们，但是命名空间、类和全局变量或函数的名称都带有前缀 - 例如 HMWidget、HMClass、hmDoSomething() 等。

关于 DOM ID 和 CSS 类 - 首先，我必须摆脱大多数 ID，因为在同一个站点上可能有来自我的服务的多个小部件。所以剩下的唯一 ID 就是“widget_12345”之类的东西，用来区分小部件。其余元素由 CSS 类标识，所有 CSS 声明都与主窗口小部件容器相关（例如，“.my_widget .left_column”，而不仅仅是“.left_column”）。

# javascript - 如何在 jQuery 中隐藏仅包含隐藏 DIV 的元素？

> ID：628310
> 
> 赞同：0
> 
> 时间：2009-03-09T22:38:59.460
> 
> 标签：javascript, jquery

我想隐藏所有只包含隐藏 DIV 的块（除了标题）。所有元素都必须通过类名选择。

详细地说，我希望当下面的所有“groupBlocks”都已经隐藏时，每个“eventBlock”都不会出现。与“菜单”相同，当所有子事件块都被隐藏时，它不应该出现。

每个“菜单”包含多个事件块，

每个“eventBlock”包含 1 个或多个 groupBlocks。

我正在使用类并且不能使用 ID，因为有很多 groupBlocks、eventBlocks 等。

如果相关，DIV 使用 JQuery 的“hide()”函数隐藏。

我的 HTML 基本上是这样的：

```
<div class="Menu">
     <strong><a name="one">Menu CAPTION</a></strong><br />
     <div class="eventBlock event1">
         <p class="underlined">eventBlock CAPTION</p>
         <div class="groupBlock group2">
             <strong>name</strong><br />
             4pm - 6pm<br />
         </div>
         <div class="groupBlock group1">
             <strong>name</strong><br />
             5pm - 7pm<br />
         </div>
     </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T22:44:42.053

这应该有效：

```
var blocks = jQuery(".groupBlock");
if( blocks.size() == blocks.not(":visible").size() )
{
  blocks.parents(".eventBlock").hide();
} 
```

如果所有 groupBlocks 都被隐藏，您可以执行类似的操作来隐藏菜单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T07:57:51.740

最简单的方法是使用单个 jQuery 选择器：

```
$('.eventBlock:not(:has(.groupBlock:visible))').hide(); 
```

就个人而言，我发现该`not()`函数更具可读性，`end()`以后可以使用：

```
$('.eventBlock').not(':has(.groupBlock:visible)').hide(); 
```

现在，您也想隐藏`Menu`s 吗？如果没有可见的 eventBlocks，似乎应该隐藏菜单，这意味着它没有可见的 groupBlocks。因此，我们可以使用与之前相同的条件：

```
$('.eventBlock, .Menu').not(':has(.groupBlock:visible)').hide(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T22:49:53.413

```
$('eventBlock').each(function() {
    if ($('.groupBlock:visible', this).length)
        $(this).show();
    else
        $(this).hide();
}); 
```

可以实现为插件

# automation - 我可以使用 Selenium 访问 DOM 对象吗？

> ID：628311
> 
> 赞同：3
> 
> 时间：2009-03-09T22:39:27.230
> 
> 标签：automation, selenium, automated-tests, web-testing

我来自 QuickTest Pro 背景，我可以使用 .object 方法访问任何元素的 DOM 对象。我想知道 Selenium RC 中的等价物是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T23:35:17.440

你当然可以。真正的问题是：你想用它做什么？查看 getEval() 命令。它可以评估任何 JavaScript 并以字符串格式返回结果。这意味着您无法将完整的 DOM 对象返回到 Java/C#/perl/etc，但您可以取回它的属性（即：innerHTML 等）。

# asp.net - 禁用选中复选框显示为未选中 - ASP.NET

> ID：628314
> 
> 赞同：9
> 
> 时间：2009-03-09T22:39:54.997
> 
> 标签：asp.net, html

我有一个输入复选框，当某些 JS 在页面加载时运行时，它会被选中并禁用。

```
<input name="selectUnionDues" id="selectUnionDues"  type="checkbox" checked="checked" runat="server" /> 
```

当我通过使用（在服务器端）获取复选框的值时

```
this.selectUnionDues.checked //returns false 
```

我总是得到一个假

**编辑：我担心使用繁重的 asp.net 控件，因为此应用程序中的页面大小需要很小。有没有办法使用 HTML 控件？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T22:47:42.717

[禁用的表单控件](http://www.w3.org/TR/html401/interact/forms.html#h-17.12.1)不是“[成功的控件](http://www.w3.org/TR/html401/interact/forms.html#successful-controls)”，这意味着它们的值根本不会与您的表单一起“提交”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-14T23:56:25.660

看看这个 [http://www.4guysfromrolla.com/articles/012506-1.aspx](http://www.4guysfromrolla.com/articles/012506-1.aspx)

简而言之，（1）“表单”有一个“SubmitDisabledControls”属性或（2）调整作者提供的javascript

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T00:44:31.407

如果禁用该复选框，它总是返回 false。最好的办法是将复选框设为只读，以便它按原样返回值。使`readonly="readonly"`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T22:46:58.647

我也得到了不那么直观的行为。如果我测试 Page_Init 中的值，它总是返回 true。在 Page_Load 中测试它会返回选定的值。

尝试使用服务器端控件而不是带有 runat=server 的 HTML 控件。

```
<asp:CheckBox ID="selectUnionDues" runat="server" Checked="true" /> 
```

此外，您声明“禁用”控件，但我没有在您的标记中看到任何禁用的内容。无论哪种方式，最好使用服务器 WebControl。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T23:10:51.413

如果您不介意依赖 JS，您可以有一个隐藏的输入，当复选框的检查属性更改时，谁的值会更改，然后使用该值服务器端。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-19T20:06:07.117

虽然最初的问题是关于 HtmlInputCheckBox 控件，但我想提一下类似的问题也存在于 Checkbox 控件中会很有用，图片更复杂，因为 Enabled="False" 和 disabled="disabled 之间存在差异”。我在这里发布调查结果：[ASP.Net Checkbox.Checked is set to default when use disabled attribute or difference between Enabled property and disabled attribute](http://sadomovalex.blogspot.fi/2013/01/aspnet-checkboxchecked-is-set-to.html)。具体来说，它解释了为什么在使用 disabled 属性时会重置 Checked 属性，以及为什么在使用 Enabled 服务器属性时不会重置它。

# python - 使用 Python 解码 HTML 实体

> ID：628332
> 
> 赞同：0
> 
> 时间：2009-03-09T22:47:01.767
> 
> 标签：python, unicode, encoding, utf-8, beautifulsoup

以下 Python 代码使用 BeautifulStoneSoup 获取托尔金的“胡林的孩子们”的 LibraryThing API 信息。

```
import urllib2

from BeautifulSoup import BeautifulStoneSoup

URL = ("http://www.librarything.com/services/rest/1.0/"
            "?method=librarything.ck.getwork&id=1907912"
            "&apikey=2a2e596b887f554db2bbbf3b07ff812a")

soup = BeautifulStoneSoup(urllib2.urlopen(URL),
                          convertEntities=BeautifulStoneSoup.ALL_ENTITIES)
title_field = soup.find('field', attrs={'name': 'canonicaltitle'})
print title_field.find('fact').string 
```

不幸的是，它打印出的不是“Húrin”，而是“HÃºrin”。这显然是一个编码问题，但我无法弄清楚我需要做什么才能获得预期的输出。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T23:05:28.227

在网页的源代码中，它看起来像这样：`The Children of H&Atilde;&ordm;rin`. 所以编码已经在他们这边的某个地方被破坏了，甚至在它被转换为 XML 之前......

如果这是所有书籍的普遍问题并且您需要解决它，这似乎有效：

```
unicode(title_field.find('fact').string).encode("latin1").decode("utf-8") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T22:53:49.880

该网页可能在其编码方面撒谎。输出看起来像 UTF-8。如果最后有一个 str ，则需要将其解码为 UTF-8。如果你有一个 unicode，那么你需要先编码为 Latin-1。

# algorithm - 球体表面上的射线-多边形交点

> ID：628335
> 
> 赞同：4
> 
> 时间：2009-03-09T22:48:05.710
> 
> 标签：algorithm, 2d, polygon, raytracing

我有一个点（纬度/经度）和一个以度数为单位的航向（真北），该点正沿着该点移动。我有许多静止的多边形（点在纬度/经度中定义），它们可能是凸面的，也可能不是凸面的。

我的问题是，如何计算与多边形最近的交点（如果有）。我看过一些关于光线追踪的令人困惑的帖子，但是当光线和多边形不在同一个平面上并且多边形必须是凸面时，它们似乎都与 3D 有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T22:55:36.503

听起来你应该能够做一个简单的二维线交叉点......

但是，我之前曾与 Lat/Long 合作过，并且知道它们并不完全适用于任何 2d 坐标系。

我会从一个通用的“IsPointInPolygon”函数开始，你可以通过谷歌搜索找到一百万个，然后在你的多边形上测试它，看看它有多好用。如果它们足够准确，请使用它。但有可能由于纬度/经度坐标的非正方形性质，您可能必须使用球面几何进行一些修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T22:57:18.123

在 2D 中，计算相当简单......

您总是可以首先检查以确保光线的端点不在多边形内（因为在这种情况下那是交点）。

如果端点不在直线上，您可以与多边形的每个边界特征进行射线/线段相交，并使用最近找到的位置。处理凸/凹特征等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T23:07:27.863

[使用此技术](https://stackoverflow.com/questions/563198/how-do-you-detect-where-two-line-segments-intersect)计算光线是否与多边形中的每个线段相交。

（我接受的）答案（我称之为`h`）中产生的比例因子是“相交点沿射线有多远”。您正在寻找 和 之间的`0`值`1`。

如果有多个交叉点，那很好！如果您想要“第一个”，请使用具有最小值的那个`h`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-14T00:02:05.923

此页面上的答案似乎是最准确的。

[问题 1.E GodeGuru](http://www.codeguru.com/Cpp/Cpp/algorithms/general/article.php/c5115/)

# c - Objective C 布尔数组

> ID：628343
> 
> 赞同：39
> 
> 时间：2009-03-09T22:52:46.527
> 
> 标签：c, objective-c, arrays, boolean, primitive

我需要在objective-c中使用一组布尔值。我已经基本设置好了，但是编译器在以下语句中抛出警告：

```
[updated_users replaceObjectAtIndex:index withObject:YES]; 
```

我敢肯定，这是因为 YES 根本不是一个对象。这是一个原始的。无论如何，我需要这样做，并且非常感谢有关如何完成它的建议。

谢谢。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-03-09T22:57:13.910

是的，这正是它的本质：NS* 容器只能存储 Objective-C 对象，而不是原始类型。

您应该能够通过将其包装在 NSNumber 中来完成您想要的：

`[updated_users replaceObjectAtIndex:index withObject:[NSNumber numberWithBool:YES]]`

或使用`@(YES)`which 将 a 包裹`BOOL`在 an`NSNumber`

`[updated_users replaceObjectAtIndex:index withObject:@(YES)]]`

然后，您可以拉出 boolValue：

`BOOL mine = [[updated_users objectAtIndex:index] boolValue];`

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-09T22:56:23.490

假设您的数组包含有效对象（并且不是 c 样式数组）：

```
#define kNSTrue         ((id) kCFBooleanTrue)
#define kNSFalse        ((id) kCFBooleanFalse)
#define NSBool(x)       ((x) ? kNSTrue : kNSFalse)

[updated_users replaceObjectAtIndex:index withObject:NSBool(YES)]; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-09T22:56:06.580

您可以存储`NSNumbers`：

```
[updated_users replaceObjectAtIndex:index
                         withObject:[NSNumber numberWithBool:YES]]; 
```

或使用 C 数组，具体取决于您的需要：

```
BOOL array[100];
array[31] = YES; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-12-08T15:08:47.727

就像 Georg 所说，使用 C 数组。

```
BOOL myArray[10];

for (int i = 0; i < 10; i++){
  myArray[i] = NO;
}

if (myArray[2]){
   //do things;
} 
```

Martijn，“myArray”是您使用的名称，在georg 的示例中为“array”。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-04-24T13:33:52.640

从 XCode 4.4 开始，您可以使用 Objective-C 文字。

`[updated_users replaceObjectAtIndex:index withObject:@YES];`

哪里`@YES`相当于`[NSNumber numberWithBool:YES]`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-04T05:19:52.887

如果您的集合很大或者您希望它比 objc 对象更快，请尝试 CoreFoundation 中的`CFBitVector`/`CFMutableBitVector`类型。它是 CF-Collections 类型之一，不*附带*NS 对应物，但如果需要，它可以快速包装在 objc 类中。

# php - 获取标题以匹配链接标题

> ID：628346
> 
> 赞同：0
> 
> 时间：2009-03-09T22:53:18.693
> 
> 标签：php, mysql

我正在开发一个类似 Digg 的网站，我希望评论页面的标题与链接标题相匹配，这里是评论文件代码：

```
class CommentsPage extends Page {

    function __construct($title = '')
    {
        $this->setTitle($title);
    }

    function header()
    {
        parent::header();
    }

    function showAllComments($article_id, $param)
    {

        $article = Article::getById($article_id);
        if(!empty($article))
        {
            ?>
            <div class="news_item">
                <a href="/index.php?action=vote&param=<?php echo $article->getId(); ?>"><img alt="vote button" class="vote_button" height="10" src="assets/images/vote2.png" width="10" class="border_less" /></a>
                <h2 class="news_item_title"><b><a href = "<?php echo $article->getUrl(); ?>"><?php echo $article->getTitle(); ?></a></b></h2>
                <span class="news_item_url">(<?php echo $article->getUrlDomain(); ?>)</span>
                <div class="news_item_info"><?php $points = $article->getPoints(); echo $points > 1 ? "$points points" : "$points point"; ?> by <a href="/index.php?action=user&param=<?php echo $article->getUsername(); ?>"><?php echo $article->getUsername(); ?></a> <?php echo $article->getElapsedDateTime(); ?></div>
                <p class="news_item_content"><?php echo $article->getDescription(); ?></p>
            </div>
            <?php
            $this->showSubmitForm($article);
        } 
```

我知道我必须更改“$this->setTitle($title);” 对于这样的东西： $article->getTitle(); 但我尝试了不同的东西，只是显示错误。

我想我不够清楚：页面顶部的标题要更改并与该页面的新闻标题相同（这是网站：kiubbo.com）Thx

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T12:22:32.460

这个怎么样：

```
class CommentsPage extends Page
{
    private $article;

    function __construct($article_id)
    {
        $this->article = Article::getById($article_id);
        if(!empty($article))
        {
            $this->setTitle($article->getTitle());
        }
        else
        {
            //Throw an exception
        }
    }

    function header()
    {
        parent::header();
    }

    function showAllComments($param)
    {
        if(!empty($this->article))
        {
        ?>
            <div class="news_item">
                <a href="/index.php?action=vote&param=<?php echo $this->article->getId(); ?>"><img alt="vote button" class="vote_button" height="10" src="assets/images/vote2.png" width="10" class="border_less" /></a>
                <h2 class="news_item_title"><b><a href = "<?php echo $this->article->getUrl(); ?>"><?php echo $this->article->getTitle(); ?></a></b></h2>
                <span class="news_item_url">(<?php echo $this->article->getUrlDomain(); ?>)</span>
                <div class="news_item_info"><?php $points = $this->article->getPoints(); echo $points > 1 ? "$points points" : "$points point"; ?> by <a href="/index.php?action=user&param=<?php echo $this->article->getUsername(); ?>"><?php echo $this->article->getUsername(); ?></a> <?php echo $this->article->getElapsedDateTime(); ?></div>
                <p class="news_item_content"><?php echo $this->article->getDescription(); ?></p>
            </div>
        <?php
        $this->showSubmitForm($this->article);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T23:36:22.960

我有点困惑。您只是在寻找属性获取器/设置器吗？

```
<?php
class CommentsPage extends Page {

    protected $title;

    function __construct($title = '')
    {
        $this->setTitle($title);
    }

    //  This function does nothing, by the way
    function header()
    {
        parent::header();
    }

    public function setTitle( $title )
    {
        $this->title = $title;
    }

    public function getTitle()
    {
        return $this->title;
    }

    function showAllComments($article_id, $param)
    {

        $article = Article::getById($article_id);
        if(!empty($article))
        {
            ?>
            <div class="news_item">
                <a href="/index.php?action=vote&param=<?php echo $article->getId(); ?>"><img alt="vote button" class="vote_button" height="10" src="assets/images/vote2.png" width="10" class="border_less" /></a>
                <h2 class="news_item_title"><b><a href = "<?php echo $article->getUrl(); ?>"><?php echo $this->getTitle(); ?></a></b></h2>
                <span class="news_item_url">(<?php echo $article->getUrlDomain(); ?>)</span>
                <div class="news_item_info"><?php $points = $article->getPoints(); echo $points > 1 ? "$points points" : "$points point"; ?> by <a href="/index.php?action=user&param=<?php echo $article->getUsername(); ?>"><?php echo $article->getUsername(); ?></a> <?php echo $article->getElapsedDateTime(); ?></div>
                <p class="news_item_content"><?php echo $article->getDescription(); ?></p>
            </div>
            <?php
            $this->showSubmitForm($article);
        }
    }
} 
```

# javascript - 使用 $.post 回调生成 html 后未注册的事件

> ID：628363
> 
> 赞同：0
> 
> 时间：2009-03-09T22:58:57.557
> 
> 标签：javascript, jquery, json

`$.post`我有一些在回调函数中动态生成的输入复选框。然后我有一个`$().change()`调用，当值改变时会做一些事情（提醒一些信息）。但是，对于动态生成的输入， .change() 不起作用。还有其他一些可以工作的输入被硬编码到可以工作的 html 中，但其他输入没有。

这是代码。

```
<html>
<head>
    <script type="text/javascript" src="js/jquery.js"></script>
    <script>
    $(document).ready(function(){
        $("#hideme").hide();
        $.post("php/test.php",{},function(data){
            writeMe = "<input type='checkbox' name='foo' value='" + data + "'>" + data;
            $("#insert").html(writeMe);
        }, "json");
        $("input[name=foo]").change(function(){
            alert($(this).attr("value"));
        })
    });
    </script>

</head>
<body>
    <div id="insert"></div>
    <input type="checkbox" name='foo' value='world'>world
</body>
</html> 
```

php/test.php 很简单：

```
echo json_encode("hello"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T23:02:32.417

问题是您的陈述：

```
$("input[name=foo]").change(function(){
        alert($(this).attr("value"));
}) 
```

没有任何效果，因为在它执行时，没有匹配 $("input[name=foo]") 的元素，因为 $.post() 回调尚未发生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T23:36:52.257

此外，如果您确实需要在 $.post 发生之前定义挂钩，请查看使用[LiveQuery](http://docs.jquery.com/Plugins/livequery)，因为它允许您侦听与您的选择器匹配的任何新元素并绑定它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T23:01:31.093

发布此问题后，我立即尝试将 .change() 放在回调中，一切都很好。

```
$.post("php/test.php",{},function(data){
    writeMe = "<input type='checkbox' name='foo' value='" + data + "'>" + data;
    $("#insert").html(writeMe);

    $("input[name=foo]").change(function(){
        alert($(this).attr("value"));
    });
}, "json"); 
```

# php - PHP 4 和 PHP 5 都在 IIS7 上运行

> ID：628376
> 
> 赞同：0
> 
> 时间：2009-03-09T23:03:17.890
> 
> 标签：php, iis, iis-7, php4

我有一台在 PHP5 中托管大量网站的服务器。我有一个为 PHP4 设计的旧站点，我在服务器上也需要它。

最初，我只是要将代码移植到 PHP5，但发现这个过程更加紧张，我有时间，所以我需要在同一个 Server 2008 机器上运行 PHP4 和 PHP5。

如果我可以设置要加载的 PHP.ini 文件，我认为这应该相当容易。我记得在某处读过有关如何设置 PHP 将加载哪个 PHP.ini 文件的文章，但我似乎在任何地方都找不到那篇文章。

有谁知道如何在 IIS7 上并行运行 PHP4 和 PHP5，或者如何指定为不同版本的 PHP 加载哪个 PHP.ini 文件？

谢谢，瑞恩。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T07:32:16.320

我没有并行运行 php4 和 php5，但是对于 php.ini 问题：PHP*应该*在

*   php目录
*   windows 目录 (%windir%)

因此，如果您确保您的 windows 目录中没有 php.ini（我在某处听说它也不应该在您的路径中，但我没有任何证据）并且仅在您的 php 目录中，您应该没事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T23:04:54.203

将不同版本的 php 映射到不同的文件扩展名。

即php4、php5

更具体地说，请按照[此处列出的步骤进行操作](http://gggeek.altervista.org/2007/07/21/running-multiple-php-versions-on-a-single-apache-install/)

# wpf - 将 DynamicResource 用于应用程序级资源可能会导致泄漏

> ID：628386
> 
> 赞同：5
> 
> 时间：2009-03-09T23:07:04.650
> 
> 标签：wpf, memory-leaks, resources

似乎使用 DynamicResource 来引用应用程序级资源可能会导致发生内存泄漏。

请参阅此 WPF 论坛[帖子](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/b97a5f83-5394-430e-9a78-9d3a957e3537)以获取更多信息、如何重现它以及一些解决方法。

我的问题是：还有其他人遇到过吗？如果是这样，你是如何解决它的？

顺便说一句，似乎有很多情况不会发生这种泄漏，也许最好的问题是：这种泄漏发生和不发生的情况到底是什么？

为方便起见，这里是重现它的代码：

**应用程序.xaml**

```
<Application
    x:Class="WeakReferences.App"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    StartupUri="Window1.xaml"
>
    <Application.Resources>
        <SolidColorBrush x:Key="MyBrush" Color="SkyBlue"/>
    </Application.Resources>
</Application> 
```

**Window1.xaml**

```
<Window
    x:Class="WeakReferences.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1"
    Height="300"
    Width="300"
>
    <Grid>
        <Button
            Name="ReleaseButton"
            Content="Release Reference"
            Click="Button_Click"
        />
    </Grid>
</Window> 
```

**Window1.xaml.cs**

```
public partial class Window1 : Window
{
    object p;

    public Window1()
    {
        InitializeComponent();

        p = new Page1();
    }

    private void Button_Click(object sender, RoutedEventArgs e)
    {            
        p = null;

        GC.Collect();
    }
} 
```

**Page1.xaml**

```
<Page
    x:Class="WeakReferences.Page1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Page1"
    Background="{DynamicResource MyBrush}"
>
    <Grid>
    </Grid>
</Page> 
```

**Page1.xaml.cs**

```
public partial class Page1 : Page
{
    public Page1()
    {
        InitializeComponent();
    }

    ~Page1()
    {
        Trace.TraceInformation("Page1 Finalized.");
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T14:19:22.577

Microsoft 已[确认](https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=422659&SiteID=212&wa=wsignin1.0)这是一个错误，并且已在 .NET 4.0 中修复。

As far as I can tell, this bug only reproduces if the object that is using DynamicResource to refer to an application level resource ... is never made part of the visual tree. Would love to see some counter-evidence to that ... or further clarification on when this leak does occur.

**Update:** This bug has also been fixed in .NET 3.5\. See this hot [fix](http://support.microsoft.com/?kbid=967328) for more info.

# javascript - 在 IE 7 中丢失 div 内容中的换行符

> ID：628391
> 
> 赞同：2
> 
> 时间：2009-03-09T23:08:36.363
> 
> 标签：javascript, internet-explorer, split, newline, innerhtml

我正在尝试在源中的换行符上拆分 div 的 innerText 。这适用于：

```
$('div').text().split("\r\n|\r|\n") 
```

但这在 IE 7 中失败了，因为换行符显然被删除了。jQuery 1.3.2 似乎没有错，因为我也尝试了这两种方法：

```
$('div')[0].innerText.split("\r\n|\r|\n") 
```

和

```
$('div')[0].innerHTML.split("\r\n|\r|\n") 
```

如果我将 div 更改为 pre，则上述任何工作都不会。

看来换行符是一旦源被解析到 DOM 中。:( 是这样吗？有没有办法用javascript来解决它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T23:11:18.150

尝试拆分`"\n"`而不是`"\r\n"`.

为此，请考虑在模式上进行拆分`"\r?\n"`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T23:42:52.867

换行符是空格，通常不会保留。它们的含义与空间的含义相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T04:38:48.397

IE 确实会在元素内容中丢失换行符，除了：

*   在`pre`（并且`plaintext`，不是本世纪曾经使用过的那个）
*   in `textarea`，它还添加了不计入其自身字符计数机制的虚假 '\r's

但是，无论如何，这都行不通：

> 拆分("\r\n|\r|\n")

与 Java 相比，JavaScript 的 String.split 采用简单的分隔符字符串，*而不是*正则表达式模式。

# c# - How can I use the IL generated to make decisions and look for bottlenecks?

> ID：628392
> 
> 赞同：3
> 
> 时间：2009-03-09T23:08:55.740
> 
> 标签：c#, .net

If I look at the il produced for my C# code (I can do this using the great LINQPad tool), what should I look for to find out what may be a performance bottleneck?

I have read the book Inside Intermediate Language to understand the code, but it doesn't really cover how to use this information to make decisions and thus changes.

Thanks

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T23:18:42.160

Examining IL is good for narrowing down what specific lines of code are causing unintended side effects, but is probably less useful for tracking down a performance bottleneck.

I'd recommend using a profiler for that purpose instead. Ideally, run a sampling and a tracing profiler (if it's very important). Once you've found your bottlenecks in a profiler, you could look at the IL to help you fix the problems.

Typically, however, the profiler results highlight the problems and it's fairly obvious what needs changing. If the code isn't obvious, examining the IL itself can help. The only place where I've found this useful is in code being run many times (in a tight loop, for example). You can compare 2 different approaches to writing a block of code, and see which produces the fastest/most compact IL.

Also, you can't always just go off the IL - sometimes, seemingly slower (and longer) IL can be handled better by the JIT than simpler looking IL. Remember, the IL isn't run directly - it's compiled (and optimized) before running. This is where a sampling profiler can help, or doing your own timings.

However, looking at IL is great for gaining a deeper understanding of how .net works, which is very valuable in the long run.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T23:30:38.120

LINQPad is used for analyzing the SQL generated from LINQ to SQL operations. Are you looking for database bottlenecks or code performance bottlenecks?

If you are troubleshooting database bottlenecks, use LINQPad to get the raw SQL queries and check them with the [SQL Query Analyzer](http://www.sql-server-performance.com/tips/query_analyzer_p1.aspx).

If you are looking for code performance bottlenecks, you'll want to use a .NET profiler like [ANTS](http://www.red-gate.com/products/ants_profiler/index.htm) from Red Gate.

# c# - 监控我的主 XP PC

> ID：628393
> 
> 赞同：0
> 
> 时间：2009-03-09T23:09:21.993
> 
> 标签：c#, windows-mobile, windows-ce

我想编写一个小型 Windows Mobile 应用程序，用于监控我的主 XP PC。IT 应该检查我的 PC 是否正在运行以及 Internet 连接是否正常（可能通过 ping 服务器）。

如果出现问题，我的移动应用程序应该使用移动网络（而不是通过互联网）通过移动设备向我发送 SMS。

这可能吗你能给我一些想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T23:14:18.050

您应该研究 WMI - 它允许您查询 Windows 计算机并收集各种数据；网络信息、硬件信息、资源使用情况，不胜枚举。

我没有使用 Windows Mobile 的经验，所以我不确定您是否可以从中执行 WMI 查询，但是如果不能，您可以创建一个基于 ASP.NET 的接口来执行实际的 WMI 调用。然后，您可以从移动设备访问 ASP.NET 页面。以类似方式运行的另一个选项是使用 Web 服务并从您的移动应用程序调用这些服务。

这是关于 WMI 的 MSDN 部分：http: [//msdn.microsoft.com/en-us/library/aa394582.aspx](http://msdn.microsoft.com/en-us/library/aa394582.aspx)

编辑：实际上我在那里有点切线；这个想法没有按照要求使用移动网络，我很抱歉。

# vb6 - 在 IDE 中运行的代码在 exe 中崩溃，出现错误 91“未设置对象变量”

> ID：628397
> 
> 赞同：0
> 
> 时间：2009-03-09T23:11:01.477
> 
> 标签：vb6, webbrowser-control

这段代码在 IDE 中运行良好，但每次在最后一行被制作成 exe 并在同一台机器上运行时都会崩溃。知道为什么吗？

```
PageFinished = False
Cancelling = False
OKToUnload = False

WebBrowser.Navigate ("https://www.example.com/index.jsp")

Do While PageFinished = False  'set to true in document complete event
    DoEvents
    If Cancelling = True Then
        OKToUnload = True
        GoTo Endline
    End If
Loop
PageFinished = False
WebBrowser.Document.All("UserId").Value = txtNumber.Text 'error here 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T04:25:10.113

在没有看到更多示例代码的情况下，我冒昧地猜测这是一个被 VB IDE“隐藏”的时间问题。在设置 .Value 属性之前测试 WebBrowser.Document.All("UserId")。在代码的非 IDE 版本达到这一点时，它可能不可用（无）。

“对象变量或未设置块变量”是 VB 告诉您空引用的方式，在 WebBrowser.Document.All("UserId") 行中，您有 3 个可能为空的单独对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T12:10:10.977

您将需要添加显示测试结果的 msgboxes 哪些变量设置为 NOTHING 或写入文本文件并运行 exe 并查看设置为空的内容。

这可能就像在最后一行之前等待一样简单。Wait 子例程如下所示。

```
Public Sub Wait(T As Double)
    Dim StartTime As Double
    StartTime = Timer
    Do While Abs(Timer - StartTime) < T
    Loop
End Sub 
```

我会尝试 1/10 秒，然后按自己的方式向上工作。即等待 .1 如果必须等待一秒钟或更长时间，请确保您定期调用 DoEvents 以保持您的应用程序响应。

原因是 IDE 总是使用 PCODE，所以它比 EXE 编译的 EXE 慢一点。您可能还想尝试编译为 PCODE，看看是否会有所不同。

# sql - 在部署后脚本中处理 SQLCMD :r

> ID：628403
> 
> 赞同：4
> 
> 时间：2009-03-09T23:14:06.630
> 
> 标签：sql, database, sqlcmd

我们使用 Visual Studio 数据库项目来控制数据库架构的源代码。我们还想从数据库中编写某些数据（配置值等）的脚本，因此我们使用自定义命令行实用程序将数据转储到插入脚本中。一个文件代表一个表的脚本数据。

有一个特定的 SQL 脚本，称为部署后脚本，它会在项目的 Deploy 命令之后自动执行。建议在这里链接其他脚本文件，我们想链接我们的数据插入脚本。

说明说使用此命令从任意文件中解析

```
SQLCMD :r <filename> 
```

问题是，我看不到我的同事从源代码管理下载它时如何使用它，因为 :r 命令的起始目录是 devenv.exe（VS dev.env.）所在的位置.

我们是否使用正确的工具从正确的角度处理脚本数据的问题？如果是这样，那么我怎样才能获得正在执行的部署后脚本文件的路径，或者如何在不将它们的路径硬编码到部署后脚本中的情况下解析插入脚本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-10T12:18:13.207

好吧，事实证明，简单地指定脚本文件的相对路径就足够了。我被 Visual Studio 的 Validate SQL Syntax 功能误导了，该功能使用 devenv.exe 的位置作为起始目录来评估 :r 之后的路径。

但是，在项目上执行 Deploy 时， :r 命令使用脚本的目录作为起始目录，因此可以使用相对路径轻松给出文件的位置。

# css - Hidden features of CSS

> ID：628407
> 
> 赞同：60
> 
> 时间：2009-03-09T23:17:27.777
> 
> 标签：css, hidden-features

I have definitely picked up some useful tips in the *hidden features* style questions concerning PHP and XHTML.

So here is one to cover CSS. While easy to pick up, it takes a little while to learn about everything, their default behaviors, properties etc

Here are some to start the ball

```
@charset "UTF-8"; /* set the character set. must be first line as Gumbo points out in comments */

.element {
        /* takes precedence over other stylings */
        display: block !important;

        /* mozilla .... rounded corners with no images */
        -moz-border-radius: 10px; 

        /* webkit equivalent */
        -webkit-border-radius: 10px 
} 
```

These are not so much *hidden*, but their use is not often widespread. What tips, tricks, rare features have you discovered with CSS?

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2010-01-26T08:05:31.540

您可以显示文档的`title`元素：

```
head, title {
    display: block;
} 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-06-05T07:33:36.417

将多个样式/类应用于这样的元素`class="bold red GoldBg"`

```
<html><head>
<style>
.bold {font-weight:bold}
.red {color:red}
.GoldBg {background-color:gold}
</style>
</head><body>
<p class="bold red GoldBg">Foo.Bar(red)</p>
</body></html> 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-06-05T07:47:50.350

我真的很喜欢 CSS 精灵。

您只需使用一张图片，每次都放置它，以便只有您想要的部分可见，而不是为您的所有网站按钮和徽标提供 20 个图像（因此需要 20 个 http 请求，每个请求都有延迟）。

很难发布示例，因为您需要查看组件图像和展示位置 CSS - 但我已经在博客中记录了 Google 对它的使用：http: [//www.stevefenton.co.uk/Content/Blog/Date/ 200905/博客/Google-Uses-Image-Sprites/](http://www.stevefenton.co.uk/Content/Blog/Date/200905/Blog/Google-Uses-Image-Sprites/)

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-03-09T23:32:29.550

The fact that `float`ing a parent element will cause it to expand to contain all of its `float`ed children.

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-03-09T23:32:39.740

Maybe *negative margins* and *absolute positioned elements in relative positioned elements*.

See [How would YOU do this with CSS?](https://stackoverflow.com/questions/636712/how-would-you-do-this-with-css/636767#636767) for examples.

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2009-06-05T08:15:24.150

You can set a variable width for an absolutely positioned element by specifying both `left` and `right` properties. This gives you more control than simply setting `width` to a percentage.

For example:

```
#myElement {
    position: absolute;
    left: 5px;
    right: 10px;
} 
```

**An alternative Example**

```
#myElement{ /* fill up the whole space :) */
   background: red;
   position:absolute;
   left: 0;
   right:0;
   top: 0;
   bottom: 0;
} 
```

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2009-10-24T12:55:52.393

看看 Webkit CSS Transformations，例如`-webkit-transform: rotate(9deg);`

![样本](https://dl.getdropbox.com/u/561580/imgs/css_rotate.gif)

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2010-07-17T23:27:15.677

上周我遇到了一个我从未听说过的非常有用的 CSS 属性：

```
text-rendering: optimizeLegibility; 
```

Safari、Chrome 和 Firefox 都理解此属性，并在设置时启用高级字距调整和连字。这是一个很棒的[演示](http://www.aestheticallyloyal.com/public/optimize-legibility/)。

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2009-03-10T00:06:59.390

我的是：

*   听觉床单的所有属性，例如`azimuth`，`pitch`...
*   打印模块的一些属性，例如`page-break-after: avoid;`
*   `counter-increment: section 1;`
*   `border-collapse: collapse;`
*   `background-color: transparent;`
*   `outline: 1px solid...`

* * *

## 回答 #10

> 赞同：15
> 
> 时间：2009-03-10T00:11:49.707

不是一个真正的功能，但仍然有用：子选择器适用于除 IE6 之外的所有浏览器，允许您在不使用黑客或条件样式表或使您的代码无效的情况下隔离 IE6。因此，以下代码中的链接在 IE6 中为红色，在其他浏览器中为蓝色。

**CSS**

```
/*Red for IE6*/
.link {color:#F00;}
/*Blue for everything else*/
#content>.link {color:#00F;} 
```

**HTML**

```
<div id="content">
    <a class="link" href="#">Link</a>
</div> 
```

这是[选择器列表](http://www.w3.org/TR/CSS2/selector.html)（用于 CSS2）和[浏览器兼容性图表](http://www.quirksmode.org/css/contents.html#link2)。

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2011-02-15T02:04:36.640

**IE6 中的透明 PNG** 这修复了 IE6 中的 PNG 透明度。将背景设置为非并将图像包含在过滤器中。不需要任何 javascript 或 htc。

```
.whatever {
   background: none; /* Hide the current background image so you can replace it with the filter*/
   width: 500px; /* Must specify width */
   height: 176px; /* Must specify height */
   filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=scale, src='vehicles.png');
} 
```

**在元素之后设置分页行为 - 跨浏览器**

```
table {
   page-break-after:always
} 
```

您可以始终使用属性，避免、自动、左、右、固有。[在http://www.w3schools.com/CSS/pr_print_pageba.asp](http://www.w3schools.com/CSS/pr_print_pageba.asp)阅读文档

**一种使用“Section 1”、“1.1”、“1.2”等对部分和子部分进行编号的方法 - 跨浏览器**

```
h2:before 
{
   counter-increment:subsection;
   content:counter(section) "." counter(subsection) " ";
} 
```

[http://www.w3schools.com/CSS/pr_gen_counter-increment.asp](http://www.w3schools.com/CSS/pr_gen_counter-increment.asp)

**将表格边框折叠成单个边框或像标准 HTML 一样分离 - 跨浏览器**

```
table
{
   border-collapse:collapse;
} 
```

[http://www.w3schools.com/css/pr_tab_border-collapse.asp](http://www.w3schools.com/css/pr_tab_border-collapse.asp)

**从按钮或输入字段中删除选择边框或虚线。还有其他很棒的用途 - 跨浏览器**

```
button{
   outline:0;
} 
```

[http://www.w3schools.com/CSS/pr_outline.asp](http://www.w3schools.com/CSS/pr_outline.asp)

*** 用于 IE6 中 100% 高度的 html**

```
* html .move{
   height:100%;
} 
```

**允许长单词中断并换行到下一行 - CSS3跨浏览器**

```
.whatever {
   word-wrap:break-word;
} 
```

[http://www.w3schools.com/css3/css3_pr_word-wrap.asp](http://www.w3schools.com/css3/css3_pr_word-wrap.asp)

## 速记

*前*

```
font-size: 1em;
line-height: 1.5em;
font-weight: bold;
font-style: italic;
font-family: serif 
```

*后*

```
font: 1em/1.5em bold italic serif; 
```

*前*

```
background-color: #fff;
background-image: url(image.gif);
background-repeat: no-repeat;
background-position: top left; 
```

*后*

```
background: #fff url(image.gif) no-repeat top left; 
```

*前*

```
list-style: #fff;
list-style-type: disc;
list-style-position: outside;
list-style-image: url(image.gif) 
```

*后*

```
list-style: disc outside url(something.gif); 
```

*前*

```
margin-top: 2px;
margin-right: 1px;
margin-bottom: 3px;
margin-left: 4px 
```

*后*

```
margin:2px 1px 3px 4px; /*also works for padding*/
margin:0; /*You can also do this for all 0 borders*/
margin:2px 3px 5px; /*  you can do this for top 2px, left/right 3px, bottom 5px and ; 
```

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2010-06-26T03:16:07.630

您可以使用 CSS 的溢出属性创建滚动区域，而无需借助框架。例子：

```
div.foo {
    border:   1px solid;
    width:    300px;
    height:   300px;
    overflow: auto;
} 
```

`overflow: auto`表示如果内容无法容纳在 div 中，将根据需要显示水平和/或垂直滚动​​条。

`overflow: scroll`意味着两个滚动条都将始终存在。如果您只希望始终存在一个滚动条，请使用`overflow-x`or `overflow-y`（现代浏览器和 IE6 都支持）。

你们中的一些人可能在想“duuuh”，但我很惊讶地发现滚动区域可以在没有框架的情况下创建。

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2011-01-30T14:18:09.657

: **before**和**:after**伪元素

以下规则导致在每个 H1 元素之前生成字符串“Chapter:”：

```
H1:before { 
  content: "Chapter: ";
  display: inline;
} 
```

更多信息，[http://www.w3.org/TR/CSS2/generate.html](http://www.w3.org/TR/CSS2/generate.html)

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2009-03-09T23:28:25.800

Not so much hidden features, but a question featuring **[CSS tips which every beginning developer should know about](https://stackoverflow.com/questions/500827/css-tips-which-every-beginning-developer-should-know-about)**

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2009-03-09T23:47:48.050

内联块（替代浮动 div）：

```
.inline_block
{
    display:-moz-inline-box;
    display:inline-block;
} 
```

**不要将此类应用于 div！**它行不通！将其应用于跨度（或内联元素）

```
<span class="inline_block">
</span> 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2010-11-01T18:17:13.127

内联@media 作业：

```
/* Styles.css */
.foo { ... bar ... }
...
@media print{
    .ads{display:none}
} 
```

这样您就可以摆脱另一个 HTTP 请求。

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2011-03-07T22:11:54.107

我们可以将样式标签显示为块元素，并使用 HTML5 *contenteditable*属性动态编辑 CSS。[演示在这里。](http://css-tricks.com/examples/ShowCSS/)

```
 <body>
       <style contenteditable>
           style {
            display: block;
           }
           body {
            background: #FEA;
           }

       </style>
   </body> 
```

学分：[CSS-技巧](http://css-tricks.com/show-and-edit-style-element/)

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2009-03-09T23:35:43.927

Not really "hidden", but understanding the box model and positioning model will help tremendously.

Like, knowing that a `position: absolute` element is positioned relative to its first parent that is styled with `position: relative`.

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2009-03-09T23:50:52.270

目前仅适用于 WebKit 但非常有趣：[CSS Animations](http://webkit.org/blog/138/css-animation/)

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2010-12-08T07:00:43.587

我从来没有想过使用 css 'border' 属性可以制作不同形状的三角形。这是要走的链接，

*（编辑）* 以下链接不再起作用。 [http://www.dinnermint.org/blog/css/creating-triangles-in-css/](http://www.dinnermint.org/blog/css/creating-triangles-in-css/)

从现在开始，您可以尝试以下方法， [http://jonrohan.me/guide/css/creating-triangles-in-css/](http://jonrohan.me/guide/css/creating-triangles-in-css/)

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2010-04-14T11:26:11.547

使用 css 可以轻松完成自动换行，无需任何服务器端技术的帮助。

```
word-wrap: break-word; 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2009-03-11T20:52:11.293

另一个 IE6 选择器

```
* html .something
{
  color:red;
} 
```

修复随机 IE6 渲染错误 - 应用 zoom:1 将触发[布局](http://www.satzansatz.de/cssd/onhavinglayout.html)。

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2009-06-30T16:40:34.513

跨浏览器内联块使用组合声明处理块和内联元素：

```
.column { 
-moz-inline-box; -moz-box-orient:vertical; display:inline-block; vertical-align:top; 
} 
```

适用于标准浏览器，包括 Firefox 2，以及：

```
.ie_lte7 .column { display:inline; } 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2009-12-29T07:01:50.997

跨浏览器（IE6+、FF、Safari）`float`替代方案：

```
.inline-block {
    display: inline-block;
    display: -moz-inline-box;
    -moz-box-orient: vertical;
    vertical-align: top;
    zoom: 1;
    *display: inline; } 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2010-01-04T20:12:55.740

我不知道这是否是一个隐藏的功能，但我只是惊叹于看到这个： [http ://www.romancortes.com/blog/css-3d-meninas/](http://www.romancortes.com/blog/css-3d-meninas/)

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-07-09T12:43:49.657

```
.class {
/* red for chrome, ff, safari, opera */
background-color: red;
/* green for IE6 */
.background-color: green;
/* blue for IE7+ */
_background-color: blue;
} 
```

将使您的 <whatever> 背景在这些浏览器类别中有所不同

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-03-09T23:41:25.630

The border-radius stuff is part of the CSS3 specification. As CSS3 is still not completely finished the more progressive browsers in the meantime implement parts of it with their own properties (-moz, -webkit). So we can already enjoy rounded corners, cleanly coded in pure css.

Unfortunately the other big player in the browser market still shows no sign of implementing css3 features.

# php - 自定义异常消息：最佳实践

> ID：628408
> 
> 赞同：74
> 
> 时间：2009-03-09T23:17:41.070
> 
> 标签：php, exception

想知道在创建异常消息时我应该付出多少努力来强制提供有用的调试信息，还是应该相信用户提供正确的信息，或者将信息收集推迟到异常处理程序？

我看到很多人都在做他们的例外，比如：

```
throw new RuntimeException('MyObject is not an array') 
```

或使用自定义异常扩展默认异常，这些异常不会做太多，但会更改异常的名称：

```
throw new WrongTypeException('MyObject is not an array') 
```

但这并没有提供太多调试信息......并且不会强制使用错误消息进行任何格式设置。因此，您最终可能会遇到完全相同的错误，产生两条不同的错误消息......例如“数据库连接失败”与“无法连接到数据库”

当然，如果它冒泡到顶部，它会打印堆栈跟踪，这很有用，但它并不总是告诉我我需要知道的一切，通常我最终不得不开始使用 var_dump() 语句来发现出了什么问题，在哪里......虽然这可能会被一个体面的异常处理程序所抵消。

我开始考虑类似下面的代码，我*需要*异常的抛出者提供必要的参数来产生正确的错误消息。我想这可能是这样做的方法：

*   必须提供最低限度的有用信息
*   产生一些一致的错误消息
*   异常消息的模板都在一个位置（异常类），因此更容易更新消息...

但我认为缺点是它们更难使用（需要您查找异常定义），因此可能会阻止其他程序员使用提供的异常......

我想对这个想法发表一些评论，以及一致、灵活的异常消息框架的最佳实践。

```
/**
* @package MyExceptions
* MyWrongTypeException occurs when an object or 
* datastructure is of the incorrect datatype.
* Program defensively!
* @param $objectName string name of object, eg "\$myObject"
* @param $object object object of the wrong type
* @param $expect string expected type of object eg 'integer'
* @param $message any additional human readable info.
* @param $code error code.
* @return Informative exception error message.
* @author secoif
*/
class MyWrongTypeException extends RuntimeException {
    public function __construct($objectName, $object, $expected, $message = '', $code = 0) {
        $receivedType = gettype($object) 
        $message = "Wrong Type: $objectName. Expected $expected, received $receivedType";
        debug_dump($message, $object);
        return parent::__construct($message, $code);
    }
} 
```

……

```
/**
 * If we are in debug mode, append the var_dump of $object to $message
 */
function debug_dump(&$message, &$object) {
     if (App::get_mode() == 'debug') {
         ob_start();
         var_dump($object);
         $message = $message . "Debug Info: " . ob_get_clean();
    }
} 
```

然后像这样使用：

```
// Hypothetical, supposed to return an array of user objects
$users = get_users(); // but instead returns the string 'bad'
// Ideally the $users model object would provide a validate() but for the sake
// of the example
if (is_array($users)) {
  throw new MyWrongTypeException('$users', $users, 'array')
  // returns 
  //"Wrong Type: $users. Expected array, received string
} 
```

我们可能会在自定义异常处理程序中执行类似 nl2br 的操作，以使 html 输出变得更好。

一直在阅读：http: [//msdn.microsoft.com/en-us/library/cc511859.aspx#](http://msdn.microsoft.com/en-us/library/cc511859.aspx#)

而且没有提到这样的事情，所以也许这是一个坏主意......

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-10T00:51:35.087

我强烈推荐[Krzysztof 博客](https://docs.microsoft.com/en-us/archive/blogs/kcwalina/how-to-design-exception-hierarchies)上的建议，并注意到在您的情况下，您似乎正在尝试处理他所谓的使用错误。

在这种情况下，需要的不是指示它的新类型，而是关于导致它的更好的错误消息。作为这样的辅助功能：

1.  生成要放入异常的文本字符串
2.  生成整个异常和消息

是需要什么。

方法 1 更清晰，但可能会导致使用更冗长，方法 2 则相反，使用更简洁的语法来降低清晰度。

请注意，这些函数必须非常安全（它们本身绝不应该导致不相关的异常），并且不会强制提供在某些合理用途中可选的数据。

通过使用这两种方法中的任何一种，您可以在以后根据需要更轻松地国际化错误消息。

堆栈跟踪至少会为您提供函数，可能还有行号，因此您应该专注于提供不容易从中计算出来的信息。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-07-23T10:07:39.933

我不会偏离关于 Krzysztof 博客的建议，但这里有一种创建自定义异常的简单方法。

例子：

```
<?php
   require_once "CustomException.php";
   class SqlProxyException extends CustomException {}

   throw new SqlProxyException($errorMsg, mysql_errno());     
?> 
```

其背后的代码（我在某处借来的，向任何人道歉）

```
<?php

interface IException
{
    /* Protected methods inherited from Exception class */
    public function getMessage();                 // Exception message
    public function getCode();                    // User-defined Exception code
    public function getFile();                    // Source filename
    public function getLine();                    // Source line
    public function getTrace();                   // An array of the backtrace()
    public function getTraceAsString();           // Formated string of trace

    /* Overrideable methods inherited from Exception class */
    public function __toString();                 // formated string for display
    public function __construct($message = null, $code = 0);
}

abstract class CustomException extends Exception implements IException
{
    protected $message = 'Unknown exception';     // Exception message
    private   $string;                            // Unknown
    protected $code    = 0;                       // User-defined exception code
    protected $file;                              // Source filename of exception
    protected $line;                              // Source line of exception
    private   $trace;                             // Unknown

    public function __construct($message = null, $code = 0)
    {
        if (!$message) {
            throw new $this('Unknown '. get_class($this));
        }
        parent::__construct($message, $code);
    }

    public function __toString()
    {
        return get_class($this) . " '{$this->message}' in {$this->file}({$this->line})\n"
                                . "{$this->getTraceAsString()}";
    }
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-09T23:36:24.083

请参阅“框架设计指南”的合著者 Krzysztof Cwalina 的博客上的[How to Design Exception Hierarchies 。](https://docs.microsoft.com/en-us/archive/blogs/kcwalina/how-to-design-exception-hierarchies)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-10T06:31:51.993

永远不要相信用户“做正确的事”，并包含用于调试的信息。如果您需要信息，则需要自己收集并将其存储在可访问的地方。

同样如前所述，如果做某事很难（呃），用户将避免这样做，所以再次强调，不要依赖他们的善意和他们对需要发送什么的了解。

这种想法暗示了一种收集信息并记录信息的方法，这意味着在某处使用 var_dump()。

此外，正如 Mark Harrison 所说，一个可以轻松在某处发送错误消息的按钮对您和用户来说都很棒。这使他们很容易报告错误。您（作为收件人）会收到很多重复信息，但重复信息总比没有信息好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T23:23:29.840

无论您添加多少细节，请务必

*   使剪切和粘贴整个东西变得容易，或者
*   有一个按钮可以为他们报告错误

# c++ - 错误：X 可能在 C 中的此函数中未初始化使用

> ID：628410
> 
> 赞同：1
> 
> 时间：2009-03-09T23:20:54.430
> 
> 标签：c++, initialization

我收到此错误

```
error: Access.Core may be used uninitialized in this function 
```

这是我的代码：

```
 static int FirstTime = 1;
 MyStruct Access;

 if (FirstTime) {
   FirstTime = 0;
   Access = Implementation();
   DoSomething(Access);
 }

 if(Other_Variable) {
    Access = Implementation2();
    DoSomething(Access);
  }

  //The Other_Variable will be set to 1 and to 0 by other part of the code 
```

我的代码就是这样，因为我只想第一次调用函数实现。在每次调用中，Access 变量都将被更新，因此将其设为静态没有多大意义。

如果我将 Access 设为静态，但我不喜欢将其设为静态，因为在其他所有调用中，Access 都会被更新。有什么方法可以避免问题而不使其成为静态？

此外，欢迎使用仅执行一次函数而不是使用静态变量的任何更好的选项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T23:28:45.583

像这样（`Access`并删除`FirstTime`和`if`）：

```
static MyStruct Access = Implementation(this_b); 
```

您收到此警告的原因是静态变量在一次函数调用中仍然存在。它们的值在所有函数调用中保留（*不*考虑哪个线程调用该函数）。所以，`FirstTime`将控制你是否初始化`Access`. 第一次调用代码所在的函数将正确初始化`Access`变量。但是对于每一个进一步的函数调用，`FirstTime`都为零，您将*不再*初始化`Access`，因此将在代码中使用未初始化的变量。

**编辑：**现在，根据您的更新信息，您说您有两个`Implementation`功能。第一次您想使用一个功能，而其他所有时间您都想使用另一个功能。那么这个怎么样：

```
 // static will be false/zero by default
 static bool AlreadyCalled;
 MyStruct Access;

 if (!AlreadyCalled) {
   Access = Implementation();
   AlreadyCalled = true;
 } else {
   Access = Implementation2();
 } 
```

不过，根据您的实际用例，可能有更好的方法来处理这个问题。例如，为什么不更新 的状态`Access`，像这样：

```
// let the default constructor initialize it
// to a plausible state
static MyStruct Access;

// use RAII to update the state of Access when this
// function returns. 
MyUpdater updater(Access);

// now, do whatever the function does. 
```

像这样的东西`MyUpdater`：

```
struct MyUpdater {
    MyStruct &s;
    MyUpdater(MyStruct &s):s(s) { }
    ~MyUpdater() {
        s.ChangeState();
    }
}; 
```

该模式称为`RAII`：您将一些有用的操作与本地分配对象的构造函数和析构函数相关联。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T23:45:20.457

@litb 的回答很有趣。下面是一个等效的程序。代码按照 C++ 中的说明编译和工作，但不能在 C 中编译。

```
#include <stdio.h>

static int newval(void) { return 3; }

void inc(void)
{
    static int a = newval();

    a++;
    printf("%d\n", a);
}

int main(void)
{
    int i;
    for (i = 0; i < 10; i++)
        inc();
    return(0);
} 
```

gcc 说：

xc：在函数'inc'中：xc：7：错误：初始化元素不是常量

g++ 对此非常满意。

这是我不知道的 C 和 C++ 之间的区别（但这不适合 300 个字符，所以我不能轻易地发表评论）。

* * *

@Eduardo 在评论中提出了一个问题：“为什么 C 不允许这样做而 C++ 允许这样做？”。 *由于答案是300多个字符...*

正如@litb 在评论中所说，在 C 中，您只能将常量用于静态变量的初始化程序。这部分是因为值是在调用 main() 之前设置的，并且在调用 main() 之前没有调用用户定义的函数。相比之下，C++ 允许在调用 main() 之前由（用户定义的）构造函数初始化全局变量和静态变量，因此没有理由不允许其他用户定义的函数也被调用，因此初始化是合理的。使用 C89，您可以使用自动（局部）变量的初始化程序受到限制；在 C99 中，您几乎可以使用任何表达式来初始化任何局部变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T23:27:40.920

访问不是静态的，因此每次调用函数时都会创建一个新实例。只有在第一次通过时，您才真正为它分配任何值；一旦函数退出，这个值就会丢失。

如果您需要 Access 在对函数的调用中保持不变，请将其设为静态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T23:30:20.307

`Access`不是静态的，因此必须在每次调用中创建。

考虑将代码简化为：

```
static MyStruct Access = Implementation(this_b); 
```

这确保了该函数只会在该方法第一次运行时被调用，并且`Access`在调用之间保存该值。

# java - 面向人类的 JAAS

> ID：628416
> 
> 赞同：84
> 
> 时间：2009-03-09T23:27:00.080
> 
> 标签：java, security, spring, spring-security, jaas

我很难理解 JAAS。这一切似乎都比应有的复杂（尤其是 Sun 教程）。我需要一个简单的教程或示例，说明如何在基于 Struts + Spring + Hibernate 和自定义用户存储库的 java 应用程序中实现安全性（身份验证 + 授权）。可以使用 ACEGI 来实现。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-03-29T15:37:04.427

其他用户在上面提供了一些非常有用的链接，所以我不打算为链接而烦恼。我在 JAAS 中针对 Web 应用程序进行了类似的研究，并且遇到了“思维障碍”，直到我最终意识到 JAAS 是一个框架，它在与 Java World 中的 Web 应用程序不同的“层”处理安全性。它旨在解决 Java SE 而不是 Java EE 中的安全问题。

JAAS 是一个安全框架，用于在比 Web 应用程序低得多的级别保护事物。其中一些示例是 JVM 级别可用的代码和资源，因此所有这些都可以在 JVM 级别设置策略文件。

但是，由于 Java EE 是在 Java SE 之上构建的，因此一些来自 JAAS 的模块在 Java EE 安全性中被重用，例如 LoginModules 和 Callbacks。

请注意，除了 Java EE 安全性之外，还有 Spring 安全性（以前称为 Acegi），它与本机 Java EE 安全性类似，解决了 Web 应用程序安全问题中更高的“层”。它是一个单独的安全实现，并非建立在标准 Java EE 安全之上，尽管它在许多方面的行为相似。

总而言之，除非您希望保护 Java SE 级别的资源（类、系统资源），否则除了使用公共类和接口之外，我看不到 JAAS 的任何实际用途。只需专注于使用 Spring Security 或普通的旧 Java EE 安全性，它们都解决了许多常见的 Web 应用程序安全问题。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-09T23:38:07.900

以下是我用来帮助理解 JAAS 的一些链接：

[http://www.owasp.org/index.php/JAAS_Tomcat_Login_Module](http://www.owasp.org/index.php/JAAS_Tomcat_Login_Module)

[http://www.javaworld.com/jw-09-2002/jw-0913-jaas.html](http://www.javaworld.com/jw-09-2002/jw-0913-jaas.html)

[http://jaasbook.wordpress.com/](http://jaasbook.wordpress.com/)

[http://roneiv.wordpress.com/2008/02/18/jaas-authentication-mechanism-is-it-possible-to-force-j_security_check-to-go-to-a-specific-page/](http://roneiv.wordpress.com/2008/02/18/jaas-authentication-mechanism-is-it-possible-to-force-j_security_check-to-go-to-a-specific-page/)

另请查看 Apache tomcat 领域配置操作方法：

[http://tomcat.apache.org/tomcat-6.0-doc/realm-howto.html](http://tomcat.apache.org/tomcat-6.0-doc/realm-howto.html)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-06-21T09:49:59.213

javax.security 是恕我直言过于复杂的 API。因此，不仅有 LoginModules 的实现者，还有整个身份验证和授权 api 的实现者，它们在上面创建抽象层，如身份验证和授权管理器。

对于初学者，最好将其打印**[到](http://media.techtarget.com/tss/static/articles/content/Pramati-JAAS/interaction.gif)**您的记忆中。

其次，恕我直言，JAAS 最简单的设置和运行库是 Jboss [PicketBox](http://www.jboss.org/picketbox)。它说明了如何通过 JBossAuthenticationManager 和 JBossAuthorizationManager 进行身份验证和授权......通过 XML 或注释轻松配置。您可以使用它来管理 webapps 和独立应用程序。

如果您需要授权部分来管理存储库访问，就资源的 ACL 而言，这就是您要确定的。

安全性的问题是，通常您需要根据自己的需要对其进行自定义，因此您最终可能会实现：

**LoginModule** - 验证用户名 + 密码

**CallbackHandler**是这样使用的`new LoginContext("Sample", new MyCallbackHandler());`

CallbackHandler 被传递给底层的 LoginModules，因此它们可以与用户进行通信和交互——例如，通过图形用户界面提示输入用户名和密码。因此，在处理程序内部，您从用户那里获取用户名和密码，并将其传递给 LoginModule。

**LoginContext** - 然后你只需调用 lc.login(); 并验证凭据。LoginContext 填充有经过身份验证的主题。

然而，Jboss Picketbox 为您提供了一个非常简单的方法，除非您需要特定的东西。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-05-03T22:11:13.197

lsiu 的答案是这里为数不多的真正“明白”的答案之一；）

除了这个答案之外，关于这个主题的一个非常好的参考是[JAAS 发生了什么？](http://java.sys-con.com/node/1002315).

它解释了 JASPIC 如何成为 Java EE 中 Servlet 和 EJB 安全模型以及潜在的 JAAS 登录模块之间的链接，但在许多情况下，JAAS 的角色被简化为 Java EE 中相对简单的用户名和角色提供者。

来自同一作者的是[JAAS in the Enterprise](http://raymondkng.sys-con.com/node/171477)，这是一篇较早的文章，但提供了很多关于 Java SE (JAAS) 和 Java EE 模型为何如此不同的历史背景。

总的来说，JAAS 中的一些类型直接用于 Java EE，基本上`Principal`是 、`Subject`和`CallbackHandler`. 后两者主要由 JASPIC 使用。我在[使用 JASPIC 在 Java EE 中实现容器身份验证一文中解释了 JASPIC](http://arjan-tijms.blogspot.com/2012/11/implementing-container-authentication.html)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T23:58:33.780

我不能对 JAAS 本身说太多，但是这个关于 Spring Security 的[“建议步骤”指南](http://static.springsource.org/spring-security/site/start-here.html)和[参考手册](http://static.springframework.org/spring-security/site/reference.html)都是关于 Spring Security 的很好的资源——如果你的设置很简单，你真的不需要做的远不止阅读这些。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T23:31:00.443

[对于纯粹的 JAAS 教程，请](http://www.javaworld.com/javaworld/jw-09-2002/jw-0913-jaas.html)查看. 它很旧，但应该有助于 JAAS 基础知识。

# c# - 如何在 C# 中扩展数组

> ID：628427
> 
> 赞同：20
> 
> 时间：2009-03-09T23:31:59.910
> 
> 标签：c#, arrays, input

我必须使用数组做一个练习。用户必须输入 3 个输入（每次输入有关项目的信息），输入将被插入到数组中。然后我必须显示数组。

但是，我很难在不更改其中信息的情况下增加数组的长度；以及如何允许用户输入另一组输入？这是我到目前为止所拥有的：

```
public string stockNum;
public string itemName;
public string price;

string[] items = new string[3];

public string [] addItem(string[] items)
{
    System.Console.WriteLine("Please Sir Enter the stock number");
    stockNum = Console.ReadLine();
    items.SetValue(stockNum, 0);
    System.Console.WriteLine("Please Sir Enter the price");
    price = Console.ReadLine();
    items.SetValue(price, 1);
    System.Console.WriteLine("Please Sir Enter the item name");
    itemName = Console.ReadLine();
    items.SetValue(itemName, 2);
    Array.Sort(items);
    return items;
}

public void ShowItem()
{
    addItem(items);
    Console.WriteLine("The stock Number is " + items[0]);
    Console.WriteLine("The Item name is " + items[2]);
    Console.WriteLine("The price " + items[1]);
}

static void Main(string[] args)
{
    DepartmentStore depart = new DepartmentStore();
    string[] ar = new string[3];
    // depart.addItem(ar);
    depart.ShowItem();
} 
```

所以我的问题归结为：

1.  如何允许用户输入多于一批的输入？例如，用户第一次会输入有关商品的信息（插座编号、价格和名称），但我需要允许用户输入有关其他商品的更多信息吗？

2.  基于数组中有多个项目的假设，如何显示数组中每个项目的套接字编号、价格和名称？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2014-12-01T14:40:00.610

从 .NET Framework 3.5 开始，对于一维数组，您可以使用`Array.Resize<T>`以下方法：

```
int[] myArray = { 1, 2, 3 };
Array.Resize(ref myArray, 5); 
```

MSDN 链接在[这里](http://msdn.microsoft.com/en-us/library/bb348051(v=vs.110).aspx)。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2011-12-21T10:47:57.080

在 .NET (C#) 中，数组不可调整大小。与 JavaScript 或 PHP 不同，数组变得非常灵活并且可以使用任意元素进行扩展。

根据定义，默认静态数组具有固定大小，因此您可以使用索引来引用其中的元素。（[http://en.wikipedia.org/wiki/Array_data_structure#Array_resizing](http://en.wikipedia.org/wiki/Array_data_structure#Array_resizing)）但是您可以在那里阅读有关动态数组的信息。在 C# 中，它将是 System.Collections.ArrayList-Object。（[http://en.wikipedia.org/wiki/Dynamic_array](http://en.wikipedia.org/wiki/Dynamic_array)）

因此，您需要的是 ArrayList-Definition 或普通列表或通用列表。(System.Collections.Generic.List)

```
string[] items = new string[3] { "input1", "input2", "input3" };
string[] moreItems = new string[10] { "input4", "input5" };

// array to list
List<string> itemsList = items.ToList<string>();

itemsList.Add("newItem");
// or merge an other array to the list
itemsList.AddRange(moreItems);

// list to array
string[] newArray = itemsList.ToArray(); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-09T23:39:12.373

我想你可能是在处理错误的问题......

考虑这三个项目（股票编号、价格和名称）是一个更大对象的一部分。现在我们可以直接调用它`item`。我们希望`item`在列表或数组中存储多个 s。考虑使用这样的面向对象方法：

```
class Widget
{
  public int StockNum;
  public int Price;
  public string Name;

  Widget(stockNum, price, name)
  {
    this.StockNum= stockNum;
    this.Price = price;
    this.Name = name;
  }
} 
```

现在，您可以实例化这些对象的列表：

```
List<Widget> items = new List<Widget>(); 
```

并向它们添加项目：

```
for (int i = 0; i < 5; i++)
{
  //Get input from user
  System.Console.WriteLine("Please Sir Enter the stock number");
  stockNum= Convert.ToInt32(Console.ReadLine()); //This isn't very safe...

  System.Console.WriteLine("Please Sir Enter the price");
  price = Convert.ToInt32(Console.ReadLine()); //This isn't very safe...

  System.Console.WriteLine("Please Sir Enter the item name");
  name = Console.ReadLine();

  //Then add it to a new object
  Widget item = new Widget(stockNum, price, name);

  //And add this item to a list
  items.Add(item);
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-10T00:09:10.133

假设您的任务要求您使用数组而不是其他集合类，那么您将不得不以艰难的方式做事。

数组是不可变的，也就是说你不能在它们创建后更改它们。您可以更改内容，但不能更改数组的大小。如果您需要扩大或缩小数组，则必须使用新的项目数创建一个新数组，然后将所需的项目从旧数组复制到新数组。

例如，假设您想获取一个数组并且只复制偶数元素。

```
int[] a = new int[] {0,1,2,3,4,5,6,7,8,9};
int[] a2 = new int[a.Length / 2];
int counter = 0;
for (int i = 0; i < a.Length; i = i + 2)
{
    a2[counter++] = a[i];
} 
```

然后，您总是可以将 a2 分配回 a

```
a = a2; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-09T23:37:12.350

您可以使用`System.Collections.Generic.List<T>`which 提供一个可调整大小的集合，`.ToArray()`如果需要，它还具有返回普通数组的方法。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-09T23:38:49.927

使用列表，然后转换为数组。

事实上，在这个例子中，你应该有一个 StockInfo {stock number, price, item name} 的类或结构，然后你应该将数据输入到一个列表中。最后，您可以使用列表的 ToArray 方法转换为 StockInfo[]。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T23:37:55.107

你可以改用[ArrayList](http://msdn.microsoft.com/en-us/library/system.collections.arraylist.aspx)吗？它将根据需要调整大小。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-08T12:35:27.280

我遇到了同样的问题，但无法更改类型并且不得不坚持使用 Array，因为我正在扩展现有的 API 类。这是一个扩展现有数组的简单模板方法：

```
 public static T[] ExtendArray<T> ( T[] array , uint index) where T:new()
    {
        List<T> list = new List<T>();
        list.AddRange(array);

        while (list.Count < index) {
            list.Add(new T());
        }

        return list.ToArray();
    } 
```

请注意，上面还使用默认构造函数**初始化**元素。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-12-21T11:24:51.597

您可以通过使用与您期望的最大数组一样大的数组来解决无法调整数组大小的“问题”。请注意，这被认为是黑客攻击，而不是结构化编程！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-22T18:39:21.703

如果您有权访问 System.Linq，那么您可以对 IEnumerable 对象（例如数组）使用方便的扩展方法***Concat 。***这将允许您扩展数组：

```
int[] result = new int[] { 1, 2 };
int[] extend = new int[] { 3, 4 };

result = result.Concat(extend).ToArray();

foreach (int i in result)
{
    Console.WriteLine(i.ToString());
} 
```

结果：
1
2
3
4

# version-control - Version control approaches in Scrum

> ID：628430
> 
> 赞同：20
> 
> 时间：2009-03-09T23:32:41.220
> 
> 标签：version-control, scrum, agile

Recently with my coworkers we were discussing how to organize the version control in a Scrum project. More specifically, the criteria for branches creation (per developer, per task, per Story, per Sprint?) and the methods of integration.

My opinion was that a useful way to organize it is to create a branch for each User Story, so you can integrate each Story in the releasable trunk once it is completed and it also allows that you always have a "deliverable version" of the application at any moment.

So if a story cannot be completed, it can be just left out and does not compromise the sprint release. (That considering a centralized tool, may be if using a distributed one the considerations would be different)

I'd like to know your own approaches, which kind of tools you prefer and the pros and cons that you have seen with the experience and the lessons learned.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T23:44:19.460

Keep branching protocol light-weight. In Scrum, if someone wants to branch the code to work on a specific feature, let them. Nobody should be afraid to branch. This is one of the benefits of DVCS - people branch when they want and aren't biased by team rules or standards.

For my money, it's a case-by-case basis, and if you start seeing patterns in your development processes then formalize them so everyone is on the same page.

Just make sure that every developer understands that it is their responsibility to integrate and merge their changes. That should set the bar to around about the right place to ensure people make the right call as to when to branch the code.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T23:35:36.847

A branch per user story sounds quite excessive to me. We keep a single code base (trunk) and work out of this. The only time we would normally branch is to fix a current production problem which could not wait until a regular release.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-10T16:12:34.687

每当我们有一个故事或一组故事威胁要让主分支混乱几天或涉及“许多”开发人员时，我们都会为此创建一个分支（不是很常见，我们会尝试分配任务来避免这种情况，但它发生）作为一种降低风险的事情。我们希望确保主分支始终准备好在每个 sprint 结束时发布，即使这可能意味着我们可能没有在 sprint 之后增加主分支的值。

故事/功能/任务分支经常与主分支同步，目标是始终在冲刺结束之前将分支合并回来。

当然，我们都使用 ' [git](http://git-scm.com/) '，所以实际上我们总是有一个本地分支来处理，而且我们已经变得非常擅长与 master 同步，经常足以避免大爆炸式集成，并且很少不会留下无用的/主分支中未使用的代码。

除此之外，我们做'[按目的分支](http://www.accurev.com/product/docs/SCMBranchingModels1.pdf)'（PDF）。我还在这里写了更多关于我们如何做 git[的文章](https://stackoverflow.com/questions/605681/605714#605714)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-30T22:39:55.827

这实际上是一个非常有趣的话题。

我们总是在每个任务创建时强制执行分支，事实上，每个任务（不是故事，而是在 Scrum 计划会议之后分解的实际任务）将至少有一个关联的分支。

您可以在下图中看到它的样子： ![替代文字](https://farm4.static.flickr.com/3354/3439112851_133242de6f_d.jpg)

这使得鼓励同行评审之类的事情变得非常容易，因为团队可以检查任务（分支）上的修改内容，即使开发人员决定进行许多中间提交（这是一个非常好的做法！）

下面有许多链接可能会有所帮助：

1.  [每个分支的任务详细](http://codicesoftware.blogspot.com/2007/04/isolation-branch-per-task-detailed.html)
2.  [4步走敏捷！](http://www.codicesoftware.com/xpgoagile.aspx)
3.  还有一个[关于它的截屏在这里](http://www.plasticscm.com/demos/associatingbranchestotasks-explained/associatingbranchestotasks-explained.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T23:45:14.373

I would use one branch per release, and use Continuous Integration to keep one user story from damaging the others.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-10T02:07:42.597

The only change you should do to your source versioning system is to integrate it with the continuous integration system (like [TeamCity](http://www.jetbrains.com/teamcity/) or [CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)).

Yeah I know that I am not really answering your question but I really mean it. In agile software project you want to be able to release the product to customers (or be able to) as often as possible. That's why you need to know that whatever is in your source system is working or if it is not working why it is not working.

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-10T01:41:17.603

我看不出每个功能的分支如何使您更敏捷或更精简。分行管理的成本太高了。我会争辩说，如果您觉得每个功能都需要一个分支，那么您的故事就太大了。一个故事应该在下一次 Scrum 中完成，如果没有，肯定在下一次完成。因此，如果一个分支只存在 1-2 天，我看不出它有什么用处或它的成本如何偿还。许多人处理一个故事是例行公事，所以我有时使用开发分支供开发人员工作，这样他们就可以每天多次合并代码，同时处理同一个故事，而无需部署代码进行测试（主分支） . 理想情况下，您将有如此少的故事在进行中并且如此快速地完成它们，以至于您只需要主分支而不需要其他分支。

# wpf - 将实体框架与 WPF 数据绑定一起使用的最佳实践

> ID：628437
> 
> 赞同：53
> 
> 时间：2009-03-09T23:34:20.030
> 
> 标签：wpf, entity-framework

我正在构建我的第一个真正的 WPF 应用程序（即第一个打算由除我之外的人使用的应用程序），并且我仍在思考在 WPF 中做事的最佳方法。这是一个使用仍然相当新的实体框架的相当简单的数据访问应用程序，但是我无法在网上找到很多指导，以找到同时使用这两种技术（WPF 和 EF）的最佳方式。所以我想我会抛弃我的处理方式，看看是否有人有更好的建议。

*   我正在使用带有 SQL Server 2008 的实体框架。EF 让我印象深刻，因为它比它需要的复杂得多，而且还不成熟，但 Linq-to-SQL 显然已经死了，所以我不妨使用该技术MS似乎正在关注。

*   这是一个简单的应用程序，所以我（还）认为不适合围绕它构建一个单独的数据层。当我想获取数据时，我使用相当简单的 Linq-to-Entity 查询，通常直接来自我的代码隐藏，例如：

    ```
    var families = from family in entities.Family.Include("Person")
               orderby family.PrimaryLastName, family.Tag
               select family; 
    ```

*   Linq-to-Entity 查询返回一个 IOrderedQueryable 结果，它不会自动反映底层数据的变化，例如，如果我通过代码向实体数据模型添加新记录，则该新记录的存在不会自动反映在引用 Linq 查询的各种控件。因此，我将这些查询的结果放入 ObservableCollection 中，以捕获底层数据更改：

    ```
    familyOC = new ObservableCollection<Family>(families.ToList()); 
    ```

*   然后我将 ObservableCollection 映射到 CollectionViewSource，这样我就可以进行过滤、排序等操作，而无需返回数据库。

    ```
    familyCVS.Source = familyOC;
    familyCVS.View.Filter = new Predicate<object>(ApplyFamilyFilter);
    familyCVS.View.SortDescriptions.Add(new System.ComponentModel.SortDescription("PrimaryLastName", System.ComponentModel.ListSortDirection.Ascending));
    familyCVS.View.SortDescriptions.Add(new System.ComponentModel.SortDescription("Tag", System.ComponentModel.ListSortDirection.Ascending)); 
    ```

*   然后，我将各种控件和其他内容绑定到该 CollectionViewSource：

    ```
    <ListBox DockPanel.Dock="Bottom" Margin="5,5,5,5" 
        Name="familyList" 
        ItemsSource="{Binding Source={StaticResource familyCVS}, Path=., Mode=TwoWay}" 
        IsSynchronizedWithCurrentItem="True" 
        ItemTemplate="{StaticResource familyTemplate}" 
        SelectionChanged="familyList_SelectionChanged" /> 
    ```

*   当我需要添加或删除记录/对象时，我从实体数据模型和 ObservableCollection 手动执行此操作：

    ```
    private void DeletePerson(Person person)
    {
        entities.DeleteObject(person);
        entities.SaveChanges();
        personOC.Remove(person);
    } 
    ```

*   我通常使用 StackPanel 和 DockPanel 控件来定位元素。有时我会使用网格，但它似乎很难维护：如果你想在网格顶部添加一个新行，你必须触摸网格直接托管的每个控件来告诉它使用一个新行。哎呀。（微软似乎从来没有真正理解过 DRY 的概念。）

*   我几乎从不使用 VS WPF 设计器来添加、修改或定位控件。VS 附带的 WPF 设计器对查看表单的外观有点帮助，但即便如此，也不是真的，特别是如果您使用的数据模板未绑定到可用的数据设计时间。如果我需要编辑我的 XAML，我会像男人一样手动进行。

*   我的大部分真实代码都使用 C# 而不是 XAML。正如我在[别处提到的](http://blog.wouldbetheologian.com/2009/03/further-thoughts-on-wpf-and-xaml.html)，除了我还不习惯在其中“思考”这一事实之外，XAML 给我的印象是一种笨拙、丑陋的语言，它也恰好伴随着糟糕的设计器和智能感知支持，而且无法调试。哎呀。因此，每当我可以清楚地看到如何在 C# 代码隐藏中执行某些我无法在 XAML 中轻松执行的操作时，我都会在 C# 中执行此操作，而无需道歉。有很多关于在 WPF 页面中几乎从不使用代码隐藏（例如，用于事件处理）的好习惯的文章，但至少到目前为止，这对我来说毫无意义。当我可以使用像 C# 这样具有世界级编辑器、近乎完美的漂亮、干净的语言时，我为什么要使用一种丑陋、笨拙、语法糟糕得令人吃惊的编辑器以及几乎没有类型安全性的语言来做某事智能感知，

这就是我所在的位置。有什么建议么？我错过了这个的任何重要部分吗？我真的应该考虑做不同的事情吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-10T00:35:56.530

您需要实现存储库模式以将 WPF 关注点与 EF 分开

然后可以使用泛型来降低 EF 到 CollectionViewSource 处理的复杂性

设计良好的存储库应减少代码级别并允许替换任何 ORM（体面测试所需）

一些想法在这里

[http://blog.nicktown.info/2008/12/10/using-a-collectionviewsource-to-display-a-sorted-entitycollection.aspx](http://blog.nicktown.info/2008/12/10/using-a-collectionviewsource-to-display-a-sorted-entitycollection.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-09T23:55:25.690

另外，我认为您不需要在这里执行 ToList() 。我相信 ObservableCollection() 需要一个家庭已经存在的 IEnumerable。如果您执行 ToList，然后将其传递给 ObservableCollection，那么我认为您将遍历所有记录两次。

```
familyOC = new ObservableCollection<Family>(families.ToList()); 
```

相反，试试这个，它应该更快一点：

```
familyOC = new ObservableCollection<Family>(families); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-10T11:25:06.187

我明白你来自哪里。Josh Smith 的这篇[文章](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)帮助我改变（或开始改变）心态，以便您可以从 WPF 中受益，而不是将其视为一个奇怪、阻碍、难以调试和不友好的框架！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-09T23:44:02.800

我的建议是，如果可能的话，使用 Expression Blend 来设计你的界面，而不是 Code Behind，而不是使用 Visual Studio 设计器，它会为你节省大量时间。还尝试重新考虑使用 C# 而不是 xaml。如果您按照“WPF 方式”进行操作，Xaml 就不会那么难看。很多时候，当我认为使用后面的代码而不是 xaml 更容易时，这是因为我做错了，需要重新考虑它应该如何最好地与 WPF/xaml 一起工作。一旦你习惯了 Xaml，它就很棒。我还使用了还不太好的实体框架。我更喜欢NHibernate。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-30T01:18:24.710

我关注了我博客中的这个链接，并想提一下我在 EF 中发现的其他内容。有点离题，但不完全是。

在使用 .Include 时，我注意到 EF 存在一些疯狂的性能问题。MS 在他们网站上的一篇文章中解释了为什么我实际上已经开始将我的大部分代码改为使用 .Load 方法。

因为这是一项乏味的任务，而且因为我找不到另一种方法来做到这一点……我创建了自己的方法，称为“IncludeByRoundTrip”。它所做的是采用对象路径并确保加载整个路径。最终结果与使用 include 时相同，但是在幕后，我只是在对象图中的所有属性上调用 Load。

如果存在这样的机制，它将类似于执行 order.Load("Customer.Address") 之类的操作。不管怎样，在我的博客上看看，让我知道你的发现。我很想知道其他人是否注意到使用 Include 的速度变慢，以及您是否有其他方法来解决这种情况。

有关我的解决方案的更多信息，请访问：[http://blog.nicktown.info/2009/07/27/method-to-load-an-entire-object-graph-using-adonet-entity-framework.aspx](http://blog.nicktown.info/2009/07/27/method-to-load-an-entire-object-graph-using-adonet-entity-framework.aspx)。

再次抱歉，这有点离题，但我期待您的回复。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T07:10:39.427

另一个工具可能是[BindableLINQ](http://www.codeplex.com/bindablelinq)

可绑定 LINQ 是 LINQ 的一组扩展，可为标准 LINQ 查询添加数据绑定和更改传播功能

# javascript - javascript math equation

> ID：628443
> 
> 赞同：1
> 
> 时间：2009-03-09T23:35:40.510
> 
> 标签：javascript, math, equation

I have two form fields `money` and `years` that need to output a number into a third field `cv` .

Ideally while the first numbers are being entered but I'm OK with it happening after a button is pressed as well

```
<FORM name="salary">
    <input type="number" size=12 name="money"> 
    <input type="number" size=12 name="years"> 
    <input type="number" size=12 name="cv"> 
</FORM> 
```

The math involved would be the following.

> (money * years) - (money * years) x = cv

Where:

*   x equals 0 if years equals 1
*   x equals .2 if years equals 2
*   x equals .45 if years equals 3
*   x equals .6 if years equals 4
*   x equals .65 if years equals 5
*   x equals .75 if years equals 6

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T23:44:27.870

You can use jQuery, in which case it'll be something like this:

```
var money = parseFloat($("#money").val());
var years = parseInt($("#years").val(), 10);
var x = [0.00, 0.20, 0.45, 0.60, 0.65, 0.75][years-1];

$("#cv").val((money*years)*(1-x)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T23:45:24.840

Breaking the problem down, you need to know how to use javascript to:

*   Programmatically get the text entered into a textbox
*   Confirm that the textbox contains numerical data
*   Perform the math
*   Set the value of the third textbox

All that and much more can be found [here](http://www.w3schools.com/JS/default.asp).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T23:48:50.993

您将要在人们输入数据的两个字段上放置一个 onKeyUp() 事件并调用如下所示的函数，此外还为函数中使用的每个字段添加一个 id。如果您不使用原型或 jquery，则需要使用 getElementById('var') 代替 $('var')

```
function calculateAndSetCV()
{
    money = parseFloat($('money').val());
    years = parseInt($('years').val());
    cv = 0;

    if(years == 1)
    {
        cv = (money * years) - (money * years)0;
    }

    $('cv').val(cv);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T23:58:33.763

算一算：

```
(money * years) - (money * years) x = cv
(money * years) x = (money * years) - cv
x = ((money * years) - cv) / (money * years)
x = 1 - cv / (money * years) 
```

[在http://jquery.com/](http://jquery.com/)获取 jQuery

像这样更新您的代码（注意名称 → id）：

```
<script type="text/javascript" src="jquery.js"></script>
<input type="number" size="12" id="money" />
<input type="number" size="12" id="years" />
<input type="number" size="12" id="cv" />
<div id="result"></div>
<script type="text/javascript">
  $ ('input').bind ('input change keyup keydown keypress', function () {
    $ ('#result').val (
       1 - $ ('#cv').val () / ($ ('#money').val () * $ ('#years').val ())
    )
  })
</script> 
```

# mysql - 从 SQL Server 高效更新 MySQL 表

> ID：628447
> 
> 赞同：2
> 
> 时间：2009-03-09T23:36:38.263
> 
> 标签：mysql, sql-server, ruby, performance, migration

我们有一个 MySQL 数据库（大部分是只读的，所以是 MyISAM 表）位于数据中心，它与现场的 SQL Server 数据库通信。WAN 中有一些明显的延迟（超过 100 毫秒）；大约 6 个月后，SQL Server DBMS 将向上移动到数据中心（例如同一个千兆位 LAN）。

在 MySQL 数据库中，我需要从 SQL Server 数据库中的结果更新数千行。**MySQL DB 连接到在 Linux 上运行的 rails 应用程序，所以我想保留在shell 脚本或 rake/ruby 任务**中尽可能多地迁移数据的逻辑（我们不是 Windows 应用程序开发人员，所以 Win32 应用程序和类似的*就出来了*！）。

这是一个相当简单的过程。在伪代码中：

```
SELECT id
     , amount
  FROM bank_account.on_SQL_Server
 WHERE (some logic)

FOREACH ROW:
  UPDATE bank_account.on_MySQL
     SET amount = $some_amount
   WHERE id     = $some_id 
```

让我们假设有几千行需要更新并频繁更新（每 5 分钟一次）。还假设我无法知道 SQL Server 中的哪些行发生了变化（不幸的是！）所以我不能将其限制为仅修改过的行——我必须将它们全部发送出去（糟糕，但是 SQL Server DB是无法修改的第 3 方应用程序**编辑：我们确实可以控制 DBMS，因此我们可以进行一些轻微的修改，例如对表进行触发器或新的存储过程——只是没有表架构更改要添加，比如说，最后更新的专栏——但我想将此选项保存为最后的手段**）。

如何最好地执行此更新过程以最小化运行时间？这个过程需要每隔几分钟运行一次（越快越好），并且从 Ruby 向 SQL Server 和 MySQL 发出双连接太慢了。这可能是由 MyISAM 引擎发出的一些写表锁，但转换为 Innodb 似乎并没有让它更快（系统正在测试中，因此不容易模拟生产将收到的相同类型的负载，导致我相信它与锁无关）。

我目前倾向于 BCP 将 VIEW（对应于上面的 SQL Server 语句）发送到文件，FTP 发送到 Linux 服务器，然后使用 Ruby 来查找文件（并执行大量序列化的 SQL 语句） ，但我不得不想象有更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T15:40:44.030

[您可以按照这些说明](http://www.sqlservercentral.com/Forums/Topic340912-146-1.aspx)将 MySQL 作为链接服务器添加到 SQL Server

从那里你可以做一些事情，比如在你的 mysql 表和你的 mssql 表之间进行连接，其中数量不相等，并相应地更新它们。然后，您可以将其作为 SQL 作业运行，以使数据库每 5 分钟保持一次同步。

例如。

```
SELECT * FROM mysql.dbo.bank_account myb 
INNER JOIN bank_account sqlb 
ON myb.id = sqlb.id 
AND sqlb.amount <> myb.amount 
```

一旦您可以从 SQL Server 内部查询将使用更少资源的 mysql 表，可能会有更聪明的方法来确定哪些数据已更改，但这只是一个开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T00:17:56.057

您也许可以将另一个表添加到 MSSQL 端，以免您通过缓存旧值或通过[触发器 (yuck)](http://feedproxy.google.com/~r/BrentOzar-SqlServerDba/~3/HKtLKNc8g0c/)找到更新的行。

与此正交，您可能会看到是否有一个 MySQL 引擎可以提供 MSSQL DB 的远程视图，就像[联邦引擎](http://dev.mysql.com/doc/refman/5.0/en/federated-storage-engine.html)对 MySQL 所做的那样。

# objective-c - QTKit，打开输入设备？

> ID：628465
> 
> 赞同：0
> 
> 时间：2009-03-09T23:44:52.360
> 
> 标签：objective-c, cocoa, xcode, macos, qtkit

我正在尝试在以下 QTCaptureSession 中添加两个输入：

```
mainSession = [[QTCaptureSession alloc] init];

BOOL success;
NSError* error;

QTCaptureDevice *videoDevice = [QTCaptureDevice defaultInputDeviceWithMediaType:@"QTMediaTypeVideo"];
success = [videoDevice open:&error];

QTCaptureDevice *audioDevice = [QTCaptureDevice defaultInputDeviceWithMediaType:@"QTMediaTypeSound"];
success = [audioDevice open:&error];

//video = [[QTCaptureDeviceInput alloc] initWithDevice:videoDevice];
//success = [mainSession addInput:video error:&error];

//audio = [[QTCaptureDeviceInput alloc] initWithDevice:audioDevice];
//success = [mainSession addInput:audio error:&error];

output = [[QTCaptureMovieFileOutput alloc] init];
success = [mainSession addOutput:output error:&error];

[output setDelegate:self];

[movieView setCaptureSession:mainSession];

[mainWindow makeKeyAndOrderFront:NSApp];

[mainSession startRunning]; 
```

我已经确定注释掉的部分是错误的来源：

> `[QTCaptureDeviceInput initWithDevice:]-`无法使用未打开的设备初始化设备输入。

我在打开方法之后探测了我的“成功”变量，它是肯定的。那么为什么该方法认为设备未打开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T01:40:15.180

如果您还没有找到答案，我认为您的问题实际上在您指出的两行之上。我检查了 Apple 的文档，发现 QTMediaTypeSound 和 QTMediaTypeVideo 是常量，而不是您应该手动传入的字符串。例如，快速的 NSLog() 语句显示 QTMediaTypeVideo 常量实际上等于“vide”。

简而言之，您的代码应该是：

```
mainSession = [[QTCaptureSession alloc] init];

BOOL success;
NSError* error;

QTCaptureDevice *videoDevice = [QTCaptureDevice defaultInputDeviceWithMediaType:QTMediaTypeVideo];
success = [videoDevice open:&error];

QTCaptureDevice *audioDevice = [QTCaptureDevice defaultInputDeviceWithMediaType:QTMediaTypeSound];
success = [audioDevice open:&error];

video = [[QTCaptureDeviceInput alloc] initWithDevice:videoDevice];
success = [mainSession addInput:video error:&error];

audio = [[QTCaptureDeviceInput alloc] initWithDevice:audioDevice];
success = [mainSession addInput:audio error:&error];

output = [[QTCaptureMovieFileOutput alloc] init];
success = [mainSession addOutput:output error:&error];

[output setDelegate:self];

[movieView setCaptureSession:mainSession];

[mainWindow makeKeyAndOrderFront:NSApp];

[mainSession startRunning]; 
```

# iphone - iPhone SDK：使用 NSMutableURLRequest 发布 NSData 导致神秘崩溃

> ID：628472
> 
> 赞同：8
> 
> 时间：2009-03-09T23:46:55.850
> 
> 标签：iphone, objective-c

我看到在我发出的 POST 请求完成后 10 或 20 秒发生崩溃（`didReceiveResponse`并且`didReceiveData`在`connectionDidFinishLoading`崩溃发生之前都触发了）。

这是我用来发出请求的代码：

```
NSURL* url = [[NSURL alloc] initWithString:urlString];
[urlString release];

NSData* requestData = [jsonData dataUsingEncoding:NSUTF8StringEncoding];
NSString* requestDataLengthString = [[NSString alloc] initWithFormat:@"%d", [requestData length]];

NSMutableURLRequest* request = [[NSMutableURLRequest alloc] initWithURL:url];
[request setHTTPMethod:@"POST"];
[request setHTTPBody:requestData];
[request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
[request setValue:requestDataLengthString forHTTPHeaderField:@"Content-Length"];
[request setTimeoutInterval:30.0];
[url release];
[requestData release];
[requestDataLengthString release];

m_URLConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self];  
[request release]; 
```

这次崩溃非常奇怪的是：如果我**不**`NSData`使用我的对象调用setHTTPBody和`setValue:@"application/json"`for ，则**不会**发生崩溃。我对正在发生的事情感到完全困惑。据我所知，崩溃与通过我的请求发送对象直接相关。当它确实崩溃时，崩溃的调用堆栈中的顶部元素 ( ) 如下：`Content-Type``setValue:requestDataLengthString``Content-Length`**`NSData``EXEC_BAD_ACCESS`**

 ***   `objc_msgSend`
*   `CFRelease`
*   `HTTPMessage::~HTTPMessage`
*   `_CFRelease`
*   `HTTPWriteFilter::~HTTPWriteFilter`

谁能想到我可能做错了什么？我完全不知道我做错了什么，如何解决它，或者如何解决它。有没有比我现在做的更好的方式来发布数据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-10T00:05:22.593

您是正确的，因为问题出在您的`NSData`对象上。你像这样分配它：

```
NSData* requestData = [jsonData dataUsingEncoding:NSUTF8StringEncoding]; 
```

根据[Cocoa 内存管理编程指南中](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)规定的规则，您不是数据的所有者，因此您`release`以后不应该调用它。 `dataUsingEncoding`调用，因此下次自动释放池耗尽时`autorelease`，该对象将是d 。`release`因为您要添加额外的`release`，所以自动释放池将尝试`release`使用已被释放的对象，这会导致崩溃。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-10T00:02:36.140

您释放了一个自动释放的对象。

删除 [requestData release] 行；你不需要它。它会导致崩溃，因为数据是由你释放的，然后在数据发送完成后再次释放，这是一个太多的释放。

通常，除非您分配对象，否则您不会在对象上调用 release，或者文档明确说明返回的对象不是自动释放的。（这是罕见的）。

使用此代码，您不必担心您使用的是自动释放的对象，就内存而言，无论您做什么，内存都会一直存在，直到底层框架通过网络发送数据。

我不知道是否有更好的方法来发布数据 - 你的代码看起来不错，除了 json 数据可能在字符串和数据对象中重复，但你发送的数据量可能很小. 如果不是，您应该在创建数据后立即释放 jsonData 字符串。（这意味着 jsonData 字符串必须来自 alloc/init 调用以及数据）。或者不要将 jsonData 作为字符串，只需从一开始就将其作为 nsmutable 数据，但这可能会很尴尬。

——汤姆

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T06:57:23.787

检查电话`[urlString release];`也。如果`urlString`是用`stringWithFormat`or之类的东西创建的`stringwithString`，则不应释放它。

# javascript - 用新 URL 替换浏览器内容

> ID：628475
> 
> 赞同：1
> 
> 时间：2009-03-09T23:47:49.903
> 
> 标签：javascript

我需要使用新 URL 重新加载浏览器窗口，该 URL 也将替换/刷新内容并强制重新加载页面。window.replace() 或 window.location 不起作用，我可以使用任何其他功能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T23:51:10.880

这应该这样做：

```
window.location.replace("http://example.com/"); 
```

其他方式（但不替换）：

```
window.location.href = "http://example.com/";
window.location.assign("http://example.com/"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T23:49:28.870

```
location.href="http://www.example.com"; 
```

还有

```
location.replace="http://www.example.com"; 
```

后者不会与浏览器历史记录混淆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T06:09:21.970

如果我使用 Ajax 导航，你会想到。我可以使用此代码。我将能够使用后退按钮浏览上一页？

# linq - 你能在 IronPython 中使用 LINQ 类型和扩展方法吗？

> ID：628482
> 
> 赞同：35
> 
> 时间：2009-03-09T23:53:22.183
> 
> 标签：linq, ironpython

是否可以在 IronPython 中使用 LINQ 类型和扩展方法？

如果有怎么办？而且经常有更多的pythonic来做同样的事情吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2011-04-06T20:48:36.633

`clr.ImportExtensions`IronPython 2.7 最终通过将扩展方法从命名空间添加到目标类型的方法弥补了这一差距，例如

```
>& 'C:\Program Files\IronPython 2.7\ipy.exe'
IronPython 2.7 (2.7.0.40) on .NET 4.0.30319.225
Type "help", "copyright", "credits" or "license" for more information.
>>> import clr
>>> clr.AddReference("System.Core")
>>> from System.Collections.Generic import List
>>> dir (List)
['Add', 'AddRange', 'AsReadOnly', 'BinarySearch', 'Capacity', 'Clear', 'Contains', 'ConvertAll', 'CopyTo', 'Count', 'Enu
merator', 'Equals', 'Exists', 'Find', 'FindAll', 'FindIndex', 'FindLast', 'FindLastIndex', 'ForEach', 'GetEnumerator', '
GetHashCode', 'GetRange', 'GetType', 'IndexOf', 'Insert', 'InsertRange', 'IsReadOnly', 'IsSynchronized', 'Item', 'LastIn
dexOf', 'MemberwiseClone', 'ReferenceEquals', 'Remove', 'RemoveAll', 'RemoveAt', 'RemoveRange', 'Reverse', 'Sort', 'Sync
Root', 'ToArray', 'ToString', 'TrimExcess', 'TrueForAll', '__add__', '__class__', '__contains__', '__delattr__', '__doc_
_', '__format__', '__getattribute__', '__getitem__', '__hash__', '__init__', '__iter__', '__len__', '__new__', '__reduce
__', '__reduce_ex__', '__repr__', '__setattr__', '__setitem__', '__sizeof__', '__str__', '__subclasshook__']
>>> import System
>>> clr.ImportExtensions(System.Linq)
>>> dir (List)
['Add', 'AddRange', 'Aggregate', 'All', 'Any', 'AsEnumerable', 'AsParallel', 'AsQueryable', 'AsReadOnly', 'Average', 'Bi
narySearch', 'Capacity', 'Cast', 'Clear', 'Concat', 'Contains', 'ConvertAll', 'CopyTo', 'Count', 'DefaultIfEmpty', 'Dist
inct', 'ElementAt', 'ElementAtOrDefault', 'Enumerator', 'Equals', 'Except', 'Exists', 'Find', 'FindAll', 'FindIndex', 'F
indLast', 'FindLastIndex', 'First', 'FirstOrDefault', 'ForEach', 'GetEnumerator', 'GetHashCode', 'GetRange', 'GetType',
'GroupBy', 'GroupJoin', 'IndexOf', 'Insert', 'InsertRange', 'Intersect', 'IsReadOnly', 'IsSynchronized', 'Item', 'Join',
 'Last', 'LastIndexOf', 'LastOrDefault', 'LongCount', 'Max', 'MemberwiseClone', 'Min', 'OfType', 'OrderBy', 'OrderByDesc
ending', 'ReferenceEquals', 'Remove', 'RemoveAll', 'RemoveAt', 'RemoveRange', 'Reverse', 'Select', 'SelectMany', 'Sequen
ceEqual', 'Single', 'SingleOrDefault', 'Skip', 'SkipWhile', 'Sort', 'Sum', 'SyncRoot', 'Take', 'TakeWhile', 'ToArray', '
ToDictionary', 'ToList', 'ToLookup', 'ToString', 'TrimExcess', 'TrueForAll', 'Union', 'Where', 'Zip', '__add__', '__clas
s__', '__contains__', '__delattr__', '__doc__', '__format__', '__getattribute__', '__getitem__', '__hash__', '__init__',
 '__iter__', '__len__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__setitem__', '__sizeof__'
, '__str__', '__subclasshook__']
>>> 
```

这使它符合 IronRuby 1.1 的`using_clr_extensions`方法。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-10T00:25:52.013

您使用 LINQ 所做的一些事情可以通过列表推导来完成：

```
[myFunc(i) for i in numbers if i > 3] 
```

或者您可以使用`map`、`reduce`和`filter`：

```
map(myFunc, filter(lambda x: x > 3, numbers)) 
```

但是列表推导比使用函数式编程结构更“Pythonic”。为了减少事情，请考虑使用`"".join`or `sum`。`any`您可以使用and来检查整个迭代的真值`all`。

只要记住这些翻译：

```
Select -> map
Where -> filter
Aggregate -> reduce 
```

你会一路走好！

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-02-19T19:37:00.327

在[IronPython 2.7.1](http://ironpython.codeplex.com/releases/view/62475)中，您有*clr.ImportExtensions*用于此用例。

```
import clr
clr.AddReference("System.Core")
import System
clr.ImportExtensions(System.Linq)

# will print 3 and 4 :)
[2, 3, 4].Where(lambda x: x != 2).ToList().ForEach(System.Console.WriteLine) 
```

一点背景知识：[IronPython 2.7](http://ironpython.codeplex.com/releases/view/54498)最初引入了这个特性，但是有[一个问题](http://ironpython.codeplex.com/workitem/30379)阻止了它真正可用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-08-26T09:02:15.737

我[描述了一个围绕 LINQ 扩展方法的 C# 包装类](http://jeroen.haegebaert.com/post/2010/07/24/Chained-method-syntax-in-IronPython-(alternative-to-extension-methods))，以实现类似于 IronPython 中 C# 的“链式扩展方法”语法的语法。

这个想法是有一种装饰器类，`IEnumerable`它简单地调用扩展方法。可能这个包装类也可以用 IronPython 编写，但我对 Python 还不是很流利:-)

```
public class ToLinq<T> : IEnumerable<T>
{
    private readonly IEnumerable<T> _wrapped;

    public ToLinq(IEnumerable<T> wrapped)
    {
       _wrapped = wrapped;
    }

    public ToLinq<T> Where(Func<T, bool> predicate)
    {
        return new ToLinq<T>(_wrapped.Where(predicate));
    }

    // ... similar methods for other operators like Select, Count, Any, ...
} 
```

这允许使用类似于以下的语法：

```
johns = ToLinq[Customer](customers)\
          .Where(lambda c: c.Name.StartsWith("John"))\
          .Select(lambda c: c.Name) 
```

免责声明：这是我尝试过的学习练习。我没有在实际项目中使用过它。

# c# - 如何以编程方式将 WPF 控件的颜色设置为系统颜色，以便在颜色方案更改时更新？

> ID：628483
> 
> 赞同：34
> 
> 时间：2009-03-09T23:53:57.143
> 
> 标签：c#, wpf

如何在 WPF 的代码隐藏中做到这一点？

```
<Grid Background="{DynamicResource {x:Static SystemColors.DesktopBrushKey}}"/> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-10T00:12:31.577

我刚刚找到了一个丑陋的解决方案：

```
grid1.SetResourceReference(
    Control.BackgroundProperty,
    SystemColors.DesktopBrushKey); 
```

我希望有人会发布一个更好的（我希望看到类似 grid1.Background = BackgroundBrush 的东西，因为 SetResourceReference 的语法是从 Windows 窗体倒退了一步）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-10T07:29:53.833

扩展方法可能会有所帮助：

```
public static class FrameworkElementExtensions
{
    // usage xPanel.SetBackground(SystemColors.DesktopBrushKey);
    public static void SetBackground(this Panel panel, ResourceKey key)
    {
        panel.SetResourceReference(Panel.BackgroundProperty, key);
    }

    // usage xControl.SetBackground(SystemColors.DesktopBrushKey);
    public static void SetBackground(this Control control, ResourceKey key)
    {
        control.SetResourceReference(Control.BackgroundProperty, key);
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-09-28T14:08:20.667

这必须已添加到更高版本的 WPF 中，因为最初发布的是因为您的原始代码对我来说很好（我使用的是 WPF 4.5）

`<Grid Background="{DynamicResource {x:Static SystemColors.DesktopBrushKey}}"/>`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-03-18T06:03:31.020

.NET Framework 受支持：3.0

[https://msdn.microsoft.com/en-us/library/system.windows.systemcolors.highlightbrush(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/system.windows.systemcolors.highlightbrush(v=vs.85).aspx) [https://msdn.microsoft.com/en_us/library/system.windows。 systemcolors.highlightbrushkey(v=vs.85).aspx](https://msdn.microsoft.com/en_us/library/system.windows.systemcolors.highlightbrushkey(v=vs.85).aspx)

```
this.background=SystemColors.HighlightBrush; 
```

# .htaccess - htaccess 不会加载图像和 css

> ID：628490
> 
> 赞同：0
> 
> 时间：2009-03-10T00:01:08.593
> 
> 标签：.htaccess

我最近将目录更改为我的一个网站，并在 htaccess 文件中编写了一条规则来处理重定向。但是，css 和图像现在无法加载。

```
Options -Indexes
Options +FollowSymLinks

RewriteEngine On
RewriteBase /
RewriteRule ^(\.*)$ http://www.myDomain.com/temp_site/$1 [R=301,L] 
```

### 编辑：

一些不起作用的文件是

> [http://www.myDomain.com/css/style.css](http://www.myDomain.com/css/style.css)
> [http://www.myDomain.com/images/me.jpg](http://www.myDomain.com/images/me.jpg)
> [http://www.myDomain.com/about.php](http://www.myDomain.com/about.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T00:10:51.410

试试这个规则：

```
RewriteRule !^temp_site/ /temp_site%{REQUEST_URI} [R=301,L] 
```

# php - 你能帮助使用正则表达式或函数来删除 HTML 编码的标签吗？

> ID：628493
> 
> 赞同：0
> 
> 时间：2009-03-10T00:02:54.923
> 
> 标签：php, html, tags

我需要一个可以从数据库记录中删除 ENCODED HTML 标记的正则表达式或函数。我在数据库中有文本，该文本被存储（来自 TinyMCE）作为编码的 HTML。

代码有“小于”；和“大于”；标签编码。

我想删除所有编码的标签和 HTML，只留下纯文本和空格。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T00:39:27.520

我会避免在这里使用 reg ex，因为提出可以涵盖用户可能强加给您的任何和所有 HTML 的东西是一项可以让全职员工永远忙碌的任务。

相反，依赖已经存在的 PHP 功能的两站方法是更好的选择。

[首先，让我们使用htmlspecialchars_decode](http://us2.php.net/manual/en/function.htmlspecialchars-decode.php)将编码的 HTML 实体转回大于和小于符号。

```
$string = htmlspecialchars_decode($string); 
```

这应该给我们一个正确的 html 字符串。（如果您的引号仍然被编码，请参阅链接文档中的第二个参数）。

最后，我们将使用 PHP 函数 strip_tags 去除 HTML 标签。这将从源中删除所有 HTML 标记。

```
$string = strip_tags($string); 
```

包裹在函数/方法中

```
function decodeAndStripHTML($string){
    return strip_tags(htmlspecialchars_decode($string));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T00:05:29.503

听起来您需要翻译和翻译`&lt;`，然后使用 HTML 解析器来提取文本（后者不能/不应该用正则表达式完成）。`<``&gt;``>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T00:45:11.967

您可能还对这个名为[HTML Purifier](http://htmlpurifier.org/)的库感兴趣。

他们说，我引用：

> HTML Purifier 是一个用 PHP 编写的符合标准的 HTML 过滤器库。HTML Purifier 不仅会使用经过全面审核、安全且允许的白名单删除所有恶意代码（更广为人知的 XSS），它还将确保您的文档符合标准，这只有通过全面了解 W3C 规范才能实现。由于当前 HTML 过滤器不足或不安全的情况而厌倦了使用 BBCode？拥有 WYSIWYG 编辑器但从未使用过它？正在为您正在构建的应用程序寻找高质量、符合标准的开源组件？HTML 净化器适合您！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-04T18:46:40.230

**删除 HTML 正则表达式**

回应 Alan Storm：不幸的是，我是一个使用 JavaScript 验证的 Web 应用程序的全职员工（哈哈）。

这是我编写的 JavaScript 正则表达式。我确信它可以被清理：

var 正则表达式 =

/(&#[0-9] *;)|(&[A-Za-z0-9]* ;)|(<[/]?[A-Za-z0-9 =/.:;,!@#$ %^&*"'?|_{}\~`()+-]+[/]?>)/g;

其中 [ d 或 $amp; or or ] or ANYTHING 在尖括号内是匹配的，突出显示，并最终为用户删除。

-旁注：我不相信为用户着想，但这个正则表达式是必需的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T00:13:58.157

`&lt;.*?&gt;`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T00:35:37.717

我通常用它`\s*?<.*?>\s*?`来匹配所有的 html 标签。要删除编码为实体的标签，您可以使用`\s*?&lt;.*?&gt;\s*?`

\s 匹配空格， . (dot) 匹配任何字符，* 表示前一个字符出现零次或多次，? 与 * 结合使 * 变得懒惰（不贪婪）。

根据您使用的语言，您可能需要添加额外的反斜杠才能使表达式起作用。如果我没记错的话，PHP 需要第二个反斜杠，就像这样`\\s*?<.*?>\\s*?`

但是，如果文本包含大于和小于不是 html 标记的字符（例如数学方程式），您将遇到问题。在这种情况下，您需要一个更复杂、更简单的正则表达式。

# html - 我可以阻止 100% 宽度的文本框超出其容器吗？

> ID：628500
> 
> 赞同：186
> 
> 时间：2009-03-10T00:05:43.980
> 
> 标签：html, css

假设我有一个要填充整行的文本框。我会给它一个这样的风格：

```
input.wide {display:block; width: 100%} 
```

这会导致问题，因为宽度基于文本框的内容。默认情况下，文本框具有边距、边框和填充，这使得 100% 宽度的文本框比其容器大。

例如，在右边：

![在此处输入图像描述](https://i.stack.imgur.com/IvcQx.png)

有没有办法让文本框填充其容器的宽度而不超出它？

这是一些示例 HTML 来说明我的意思：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Untitled Page</title>
    <style type="text/css">
        #outer{border: 1px solid #000; width: 320px; margin: 0px;padding:0px}
        #inner{margin: 20px; padding: 20px; background: #999;border: 1px solid #000;}
        input.wide {display:block; margin: 0px}
        input.normal {display:block; float: right}
    </style>
</head>
<body>
    <div id="outer">
        <div id="inner">
            <input type="text" class="wide" />
            <input type="text" class="normal" />
            <div style="clear:both;"></div>
        </div>
    </div>
</body>
</html> 
```

如果运行此程序，您可以通过查看“普通”文本框看到“宽”文本框伸出容器之外。“正常”文本框浮动到容器的实际边缘。我试图让“宽”文本框填充它的容器，而不像“普通”文本框那样扩展超出边缘。

* * *

## 回答 #1

> 赞同：283
> 
> 时间：2009-03-10T04:10:54.907

> 有没有办法让文本框填充其容器的宽度而不超出它？

是的：通过使用 CSS3 属性“box-sizing:border-box”，您可以重新定义“宽度”的含义，包括外部填充和边框。

不幸的是，因为它是 CSS3，支持还不是很成熟，而且由于规范过程还没有完成，同时它在浏览器中具有不同的临时名称。所以：

```
input.wide {
    width: 100%;
    box-sizing: border-box;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
} 
```

老式的替代方案是简单地在封闭的 <div> 或 <td> 元素上放置一定数量的“padding-right”，等于你认为浏览器会在“px”中增加多少左右填充/边框给出输入。（对于 IE<8，通常为 6px。）

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2009-03-10T16:32:19.147

你可以做的是删除默认的“额外” `input`：

```
input.wide {display:block; width:100%;padding:0;border-width:0} 
```

这将保留`input`其容器内部。现在，如果您确实需要边框，请将其包裹`input`在 a`div`中，并将边框设置在 the 上`div`（这样您也可以`display:block`从 the中删除`input`）。就像是：

```
<div style="border:1px solid gray;">
 <input type="text" class="wide" />
</div> 
```

**编辑：** 另一种选择是，而不是从 中删除样式，`input`而是在包装中对其进行补偿`div`：

```
input.wide {width:100%;}

<div style="padding-right:4px;padding-left:1px;margin-right:2px">
  <input type="text" class="wide" />
</div> 
```

这将在不同的浏览器中为您提供一些不同的结果，但它们不会与容器重叠。div 中的值取决于边框的大小以及边框和边框`input`之间需要多少空间`input`。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-08-25T07:12:54.133

这为我解决了问题！

**无需外部 div。**只需将其应用于您给定的文本框。

```
box-sizing: border-box; 
```

使用此属性“宽度和高度属性（以及最小/最大属性）包括内容、填充和边框，但不包括边距”

[请参阅w3schools](http://www.w3schools.com/cssref/css3_pr_box-sizing.asp)的财产描述。

希望这对某人有帮助！

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-12T04:02:25.377

我自己刚刚遇到了这个问题，我能找到的唯一可以在我所有的测试浏览器（IE6、IE7、Firefox）中工作的解决方案如下：

1.  将输入字段包装在两个单独的 DIV 中
2.  将外部 DIV 设置为宽度 100%，这可以防止我们的容器溢出文档
3.  将填充放在精确数量的内部 DIV 中，以补偿输入的水平溢出。
4.  在输入上设置自定义填充，使其溢出的量与我在内部 DIV 中允许的量相同

编码：

```
<div style="width: 100%">
    <div style="padding-right: 6px;">
        <input type="text" style="width: 100%; padding: 2px; margin: 0;
                                  border : solid 1px #999" />
    </div>
</div> 
```

在这里，输入元素的总水平溢出为 6px - 2x(padding + border) - 所以我们为 6px 的内部 DIV 设置了 padding-right。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-06-13T19:33:58.143

box-sizing 支持实际上非常好： http: [//caniuse.com/#search=box-sizing](http://caniuse.com/#search=box-sizing)

因此，除非您以 IE7 为目标，否则您应该能够使用此属性解决此类问题。像 sass 或更少这样的层可以更容易地处理这样的前缀规则，顺便说一句。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-10T03:24:59.213

实际上，这是因为 CSS 定义了 100% 相对于容器的整个宽度，包括其边距、边框和内边距；这意味着空间可用。其内容的大小小于 100%，除非容器没有边距、边框或填充。

*这是违反直觉的，并且被许多人广泛认为是我们现在所坚持的错误*。它实际上意味着 % 尺寸对于顶级容器以外的任何东西都没有好处，即使那样，只有当它没有边距、边框或填充时。

请注意，文本字段的边距、边框和内边距*都*包含在为其指定的 CSS 大小中 - 是容器将事情扔掉了。

我已经通过使用 98% 勉强解决了这个问题，但这并不是一个完美的解决方案，因为随着容器变大，输入字段往往会变得更短。

* * *

编辑：我遇到了这个[类似的问题](https://stackoverflow.com/questions/485827/css-100-height-with-padding-margin)- 我从来没有尝试过给出的[答案](https://stackoverflow.com/questions/485827/css-100-height-with-padding-margin/485838#485838)，我不确定它是否适用于你的问题，但它似乎会。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-03-24T20:52:48.963

一种可能有效的解决方案（它适用于我）是**在输入（文本框）处应用负边距**......或为 ie7 应用固定宽度或放弃 ie7 支持。这导致像素完美的宽度.. 对我来说它是 7 所以我添加了 3 和 4 但它仍然是完美的像素..

我遇到了同样的问题，我讨厌为边框等设置额外的 div！

所以这是我的解决方案，它似乎有效！

您应该使用仅 ie7 的样式表来避免 starhacks。

```
input.text{
    background-color: #fbfbfb;
    border : solid #eee 1px;
    width: 100%;
    -box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
    height: 32px;

    *line-height:32px;
    *margin-left:-3px;
    *margin-right:-4px;
    display: inline;   
    padding: 0px 0 0 5px;

} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-12T14:15:55.410

如果您不能使用`box-sizing:border-box`，您可以尝试删除`width:100%`并在元素中放置一个非常大`size`的属性，`<input>`但缺点是您必须修改 html，并且不能仅使用 CSS：

```
<input size="1000"></input> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-11T17:14:50.977

如果您不需要动态执行此操作（例如，您的表单具有固定宽度），您可以将子`<input>`元素的宽度设置为其容器的宽度减去填充、边距、边框等任何装饰：

```
 // the parent div here has a width of 200px:
.form-signin input[type="text"], .form-signin input[type="password"], .form-signin input[type="email"], .form-signin input[type="number"] {
  font-size: 16px;
  height: auto;
  display: block;
  width: 280px;
  margin-bottom: 15px;
  padding: 7px 9px;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-02-18T10:02:55.070

如果您不能使用 box-sizing（例如，当您使用 iText 将 HTML 转换为 PDF 时）。试试这个：

CSS

```
.input-wrapper { border: 1px solid #ccc; padding: 0 5px; min-height: 20px; } 
.input-wrapper input[type=text] { border: none; height: 20px; width: 100%; padding: 0; margin: 0; } 
```

HTML

```
<div class="input-wrapper">
     <input type="text" value="" name="city"/>
</div> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-10-03T07:34:47.463

这有效：

```
<div>
    <input type="text" 
        style="margin: 5px; padding: 4px; border: 1px solid; 
        width: 200px; width: calc(100% - 20px);">
</div> 
```

第一个“宽度”是旧浏览器的后备规则。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-02-06T20:47:09.257

只需将输入设置为偏移以获取额外的填充。在以下示例中，输入上的填充将在左右各 10 像素，总填充偏移量为 20 像素：

```
input[type=text]{
   width: calc(100% - 20px);
} 
```

# python - 谷歌数据源 JSON 无效吗？

> ID：628505
> 
> 赞同：5
> 
> 时间：2009-03-10T00:07:31.637
> 
> 标签：python, simplejson

我正在使用他们的[Python 库](http://code.google.com/apis/visualization/documentation/dev/gviz_api_lib.html#tojsonexample)实现一个 Google 数据源。我希望库的响应能够使用[simplejson 库导入另一个 Python 脚本。](http://simplejson.googlecode.com/svn/tags/simplejson-2.0.9/docs/index.html)

但是，即使是他们的[示例](http://google-visualization.appspot.com/python/dynamic_example)也无法在 JSONLint 中验证：

```
{cols:
    [{id:'name',label:'Name',type:'string'},
     {id:'salary',label:'Salary',type:'number'},
     {id:'full_time',label:'Full Time Employee',type:'boolean'}],
rows:
    [{c:[{v:'Jim'},{v:800,f:'$800'},{v:false}]},
     {c:[{v:'Bob'},{v:7000,f:'$7,000'},{v:true}]},
     {c:[{v:'Mike'},{v:10000,f:'$10,000'},{v:true}]},
     {c:[{v:'Alice'},{v:12500,f:'$12,500'},{v:true}]}]} 
```

如何调整 simplejson 'loads' 函数以导入上述 JSON 内容？我认为主要问题是对象键不是字符串。

我宁愿不编写正则表达式来将键转换为字符串，因为我认为这样的代码维护起来很烦人。

尝试使用 simplejson 将上述 JSON 导入 Python 时，我目前收到“期望属性名称：第 1 行第 1 列（字符 1）”错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-10T01:35:25.357

它被认为是没有字符串键的无效 JSON。

```
{id:'name',label:'Name',type:'string'} 
```

一定是：

```
{'id':'name','label':'Name','type':'string'} 
```

根据[谷歌数据源](http://code.google.com/apis/visualization/documentation/dev/implementing_data_source.html#jsondatatable)页面，他们返回无效的 JSON。他们没有具体说出来，但他们所有的例子都没有在键上引用。

这是一个相当完整的[Python JSON 处理器](http://deron.meranda.us/python/comparing_json_modules/basic)列表，其中详细介绍了它们支持的格式以及性能如何。大多数不支持非字符串键，**但似乎[demjson](http://deron.meranda.us/python/demjson/)会转换它。**

```
easy_install demjson 
```

# jquery - 在jquery中选择更改时如何更新div

> ID：628508
> 
> 赞同：7
> 
> 时间：2009-03-10T00:09:02.427
> 
> 标签：jquery, forms

我有一个带有选择字段和一个 div 的表单，我希望根据用户选择的内容更新一个值。

例子：

```
<select name="mysel" id="msel">
    <option value="test1">Test1</option>
    <option value="test2">Test2</option>
    <option value="test3">Test3</option>
</select>

<div id="myresult"></div> 
```

如果用户选择 test2 等，我希望 div 更新为“这是测试 2 和其他信息”。

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-10T00:18:42.093

尝试这样的事情：

```
<select id="choose">
    <option value="test1">Test1</option>
    <option value="test2">Test2</option>
    <option value="test3">Test3</option>
</select>
<div id="update"></div>

<script type="text/javascript">
    $('#choose').change(function(event) {
        $('#update').html('This is ' + $('#choose').val() + ' and other info');
    }); 
</script> 
```

* * *

如果你想用 AJAX 来做，把 javascript 函数改成这样：

```
<script type="text/javascript">
    $('#choose').change(function(event) {
        $.post('info.php', { selected: $('#choose').val() },
            function(data) {
                $('#update').html(data);
            }
        );            
    });
</script> 
```

在您的 info.php 中，您将拥有如下内容：

```
<?php

    $selected = isset($_POST['selected']) ? $_POST['selected'] : 'nothing';
    echo("This is $selected and other info"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T00:13:54.290

总体思路：

```
$(function() {
   $("#msel").change(function(){
      $("#myresult").html("This is " + $("#msel").val() + " and other info");
   });
}); 
```

有了更多的细节，我可以做得更好。;-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-17T21:18:20.093

这是我发现的最简单的方法（来自[这个](http://www.webdeveloper.com/forum/showthread.php?t=194923)方便的论坛）

```
<!-- the select -->
<select id="thechoices">
    <option value="box1">Box 1</option>
    <option value="box2">Box 2</option>
    <option value="box3">Box 3</option>
</select>

<!-- the DIVs -->
<div id="boxes">
    <div id="box1"><p>Box 1 stuff...</p></div>
    <div id="box2"><p>Box 2 stuff...</p></div>
    <div id="box3"><p>Box 3 stuff...</p></div>
</div>

<!-- the jQuery -->
<script type="text/javascript" src="path/to/jquery.js"></script>
<script type="text/javascript">

$("#thechoices").change(function(){
    $("#" + this.value).show().siblings().hide();
});

$("#thechoices").change();

</script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-26T09:10:20.047

## 准备好文件

```
<script type="text/javascript">
    $(document).ready(function(){
        $('#choose').change(function(event) {    
          $.post(
           'info.php',
            $(this).serialize(),
            function(data){
              $("#update").html(data)
            }
          );
          return false;   
        });   
    }); 
```

## 关于 ajaxComplete

```
<script type="text/javascript">
    $(document).ajaxComplete(function(){
        $('#choose').change(function(event) {    
          $.post(
           'info.php',
            $(this).serialize(),
            function(data){
              $("#update").html(data)
            }
          );
          return false;   
        });   
    }); 
```

# c++ - 是否强制使用短路逻辑运算符？和评价顺序？

> ID：628526
> 
> 赞同：162
> 
> 时间：2009-03-10T00:23:39.303
> 
> 标签：c++, c, logical-operators, short-circuiting, operator-precedence

ANSI 标准是否*要求*在 C 或 C++ 中将逻辑运算符短路？

我很困惑，因为我记得 K&R 书中说你的代码不应该依赖于这些被短路的操作，因为它们可能不会。有人可以指出标准中说逻辑操作总是短路的地方吗？我对 C++ 最感兴趣，C 的答案也很好。

我还记得读过（不记得在哪里）没有严格定义评估顺序，因此您的代码不应依赖或假设表达式中的函数将按特定顺序执行：在语句结束时所有引用的函数将被调用，但编译器可以自由选择最有效的顺序。

标准是否指明了这个表达式的评估顺序？

```
if( functionA() && functionB() && functionC() ) cout<<"Hello world"; 
```

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2009-03-10T00:37:18.570

`||`是的，运算符以及`&&`C 和 C++ 标准都需要短路和评估顺序。

C++ 标准说（C 标准中应该有一个等效的子句）：

> **1.9.18**
> 
> *在以下表达式的评估中*
> 
> ```
> a && b
> a || b
> a ? b : c
> a , b 
> ```
> 
> *使用这些表达式中运算符的内置含义，在**对第一个表达式**(12) 求值之后有一个序列点。*

在 C++ 中有一个额外的陷阱：短路**不适**用于重载运算符`||`和`&&`.

> *脚注 12：本段中指示的运算符是内置运算符，如第 5 节所述。当这些运算符之一在有效上下文中重载（第 13 条）时，指定用户定义的运算符函数，表达式指定函数调用，操作数形成一个参数列表，**它们之间没有隐含的序列点。***

通常不建议在 C++ 中重载这些运算符，除非您有非常具体的要求。您可以这样做，但它可能会破坏其他人代码中的预期行为，特别是如果这些运算符是通过实例化模板间接使用的，其类型重载这些运算符。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2009-03-10T00:28:49.073

短路评估和评估顺序是 C 和 C++ 中的强制性语义标准。

如果不是这样，这样的代码就不会是一个常见的习惯用法

```
 char* pChar = 0;
   // some actions which may or may not set pChar to something
   if ((pChar != 0) && (*pChar != '\0')) {
      // do something useful

   } 
```

C99 规范的第**6.5.13 节逻辑与运算符**[（PDF 链接）](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)说

> (4)。与按位二进制 & 运算符不同，&& 运算符保证从左到右的求值；在计算第一个操作数之后有一个序列点。如果第一个操作数比较等于 0，则不计算第二个操作数。

同样，第**6.5.14 节逻辑或运算符**说

> (4) 不同于按位 | 运算符，|| 运算符保证从左到右的评估；在计算第一个操作数之后有一个序列点。如果第一个操作数比较不等于 0，则不计算第二个操作数。

在 C++ 标准中可以找到类似的措辞，[请查看此草稿副本中的第 5.14 节](http://www.csci.csusb.edu/dick/c++std/cd2/index.html)。正如检查员在另一个答案中指出的那样，如果您覆盖 && 或 ||，则必须评估两个操作数，因为它成为常规函数调用。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-10T00:27:53.397

是的，它要求（评估顺序和短路）。在您的示例中，如果所有函数都返回 true，则调用的顺序严格从 functionA 然后 functionB 然后 functionC。用于这个喜欢

```
if(ptr && ptr->value) { 
    ...
} 
```

逗号运算符也一样：

```
// calls a, then b and evaluates to the value returned by b
// which is used to initialize c
int c = (a(), b()); 
```

有人说,的左右操作数`&&`之间以及（条件运算符）的第一个和第二个/第三个操作数之间是一个“序列点”。任何副作用都在该点之前完全评估。所以，这是安全的：`||``,``?:`

```
int a = 0;
int b = (a++, a); // b initialized with 1, and a is 1 
```

请注意，逗号运算符不要与用于分隔事物的语法逗号混淆：

```
// order of calls to a and b is unspecified!
function(a(), b()); 
```

C++ 标准中说`5.14/1`：

> && 运算符从左到右分组。操作数都被隐式转换为 bool 类型（第 4 条）。如果两个操作数都为真，则结果为真，否则为假。与 & 不同，&& 保证从左到右的评估：如果第一个操作数为假，则不评估第二个操作数。

并在`5.15/1`：

> || 运算符组从左到右。操作数都被隐式转换为 bool（第 4 条）。如果其中一个操作数为真，则返回真，否则返回假。与 |、|| 不同 保证从左到右的评估；此外，如果第一个操作数的计算结果为真，则不计算第二个操作数。

它对旁边的两个都说：

> 结果是一个布尔值。第一个表达式的所有副作用，除了临时变量（12.2）的破坏外，都发生在第二个表达式被计算之前。

除此之外，`1.9/18`说

> 在每个表达式的评估中
> 
> *   `a && b`
> *   `a || b`
> *   `a ? b : C`
> *   `a , b`
> 
> 使用这些表达式 (5.14, 5.15, 5.16, 5.18) 中运算符的内置含义，在对第一个表达式求值之后有一个序列点。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-10T00:28:49.027

直接来自优秀的 K&R：

> C 保证了这一点，`&&`并且`||`从左到右进行评估——我们很快就会看到这很重要的案例。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-10T02:05:38.840

非常非常小心。

对于基本类型，这些是快捷操作符。

但是，如果您为自己的类或枚举类型定义这些运算符，它们就不是捷径了。由于在这些不同情况下它们的用法存在语义差异，因此建议您不要定义这些运算符。

对于`operator &&`和`operator ||`对于基本类型，评估顺序是从左到右（否则快捷方式将很难:-) 但是对于您定义的重载运算符，这些基本上是定义方法的语法糖，因此参数的评估顺序是不明确的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T00:27:38.733

如果您信任维基百科：

> [`&&`和`||`] 在语义上不同于按位运算符 & 和 | 因为如果可以仅从左侧确定结果，它们将永远不会评估右侧操作数

[C（编程语言）](https://en.wikipedia.org/wiki/C_(programming_language)#Characteristics)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-16T09:38:42.687

您的问题归结为[C++ 运算符优先级](http://en.cppreference.com/w/cpp/language/operator_precedence)和关联性。基本上，在具有多个运算符且没有括号的表达式中，编译器按照这些规则构造表达式树。

为了优先考虑，当您有类似 的内容时`A op1 B op2 C`，您可以将事物分组为`(A op1 B) op2 C`或`A op1 (B op2 C)`。如果`op1`优先级高于`op2`，您将获得第一个表达式。否则，你会得到第二个。

对于关联性，当你有类似的东西时`A op B op C`，你可以再次将薄分组为`(A op B) op C`或`A op (B op C)`。如果`op`已经离开关联性，我们将得到第一个表达式。如果它具有正确的关联性，我们将得到第二个。这也适用于相同优先级的运算符。

在这种特殊情况下，`&&`的优先级高于`||`，因此表达式将被评估为`(a != "" && it == seqMap.end()) || isEven`。

顺序本身在表达式树形式上是“从左到右”。因此，我们将首先评估`a != "" && it == seqMap.end()`. 如果它是真的整个表达式是真的，否则我们去`isEven`。当然，该过程在左子表达式内递归地重复。

* * *

有趣的花絮，但优先级的概念源于数学符号。同样的事情发生在`a*b + c`， where`*`的优先级高于`+`。

更有趣/更晦涩的是，对于`A1 op1 A2 op2 ... opn-1 An`所有运算符具有相同优先级的无括号表达式，我们可以形成的二叉表达式树的数量由所谓的[加泰罗尼亚数字](https://en.wikipedia.org/wiki/Catalan_number)给出。对于大`n`，这些增长非常快。d

# versioning - 我可以提供一些版本编号建议吗？

> ID：628527
> 
> 赞同：5
> 
> 时间：2009-03-10T00:23:39.710
> 
> 标签：versioning

我们的产品历史悠久（12年左右）。

它起源于 VB3（第 1 版）和后来的 VB6（第 2 版）。（版本号是“狗早餐”，版本控制是一场噩梦。

我已经在这里参与了几年了。我们在 .Net 平台上正在开发第 3 版，但第 2 版继续得到定期发布的支持 - 每年大约 3 或 4 次。

我在开始时引入了夜间自动化构建，我们产品的版本号是 2.2.2。每个人都计划只发布 2.2.3，但是自动构建过程和 VB6 的“有趣”的 3 部分编号系统意味着我们需要使用第三部分 - 构建/修订号 - 它应该是。

所以我们发布了 2.3 版（内部版本号为“whatever”）并开始使用 2.4（每晚增加内部版本号），然后是 2.5，然后是 2.6，等等。

内部版本号隐藏在公众视野之外，但可用于支持目的，即使我们很少发布超过一个版本的版本 - 但我们偶尔需要修补。

确保一致性。现在我们达到 2.9。我们即将移动到 2.10（2 点 9，最多 2 点 10）。不幸的是，非技术人员将其视为有理数（两点一）。他们无法理解我们为什么不直接使用 3.0 版——比如数数。（内部版本号仅出于支持目的显示在“帮助/关于”屏幕上）。

我认为没有必要对产品（主要数量）进行升级，尤其是由于市场对这将设定的期望。

这里有正确的方法吗？（2.10 或 3.0 或更好的版本 - 或者它甚至重要吗？）

*（注意。我已经竭尽全力确保版本号现在显示为 2.09，而不是 2.9（在我们的网站、产品启动屏幕和各种其他公共场所等），因此当我们移动到 2.10 时，它可能更有意义，但这可能同样令人困惑，因为 2.09 实际上是比 2.8 更低的有理数......）*

**也可以看看：**

[确定版本号](https://stackoverflow.com/questions/619422/deciding-on-version-numbers)

[版本号怎么做？](https://stackoverflow.com/questions/615227/how-to-do-version-numbers)

[你怎么知道要使用什么版本号？](https://stackoverflow.com/questions/396429/how-do-you-know-what-version-number-to-use)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-10T01:22:52.733

将其视为非技术人员学习一些东西的机会；-) 版本号应该就像一本书中的章节号，它们将您的程序的生命周期分成连贯且内部一致的块。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-10T01:10:44.183

如何对自己的软件进行版本控制取决于您。没有“对”或“错”之分，除了在考虑维护、发布管理和客户支持的观点后最好的选择。对你来说重要的是控制版本控制——你理解它，使用该产品的每个人都理解它，并且它不会在以后引起问题。与 3.0 相比，从 2.9 升级到 2.10 没有任何意义，除了*你*赋予它的意义。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-10T03:55:02.773

其他答案只对了一半。版本号具有您赋予它们的含义，但它们也具有其他人赋予它们的含义。你自己的意思真的不重要，因为你不会去纠正你的用户。如果他们认为从 2.9 升级到 3.0 是一个巨大的飞跃，那么他们就会接受它。如果他们害怕使用 x.0 版本，那么他们不会。如果他们习惯于使用 alpha 版本的奇数版本，那么他们将不会使用这些版本。

尽管我不想这么说，但版本号是一种营销工具。他们向用户说明了有关版本的信息，因此您在选择版本号时必须考虑到这一点。

问题是，版本号对不同的人意味着不同的东西。有些事情你可以预测。正如我上面提到的，人们会怀疑 x.0 版本。他们预计 2.x 到 3.x 会有很大的变化。如果您想尝试播放，请继续。

版本号有两个基本属性。首先，它们必须始终上升。其次，它们必须易于分类。第一个是显而易见的，但第二个经常被违反。考虑版本 2.9 -> 2.10。从数值上讲，2.9 大于 2.10。您必须考虑它们的主要/次要版本号才能正确排序。由此产生了关于 2.10 或 3.0 是否遵循 2.9 的混淆。即使我们知道排序规则，它似乎仍然是错误的。出于这个原因，我总是填充我的版本。2.09 之后是 2.10。它以数字和点对的形式正确排序。

这仍然让用户试图从版本号中推测含义，就像命理学家筛选中奖号码一样。你可以尝试玩那个游戏，或者你可以离开它。为什么要使用点对呢？使用整数。这是明确的。它排序微不足道。它没有为用户提供任何错误的含义。

我可以去一个更好的。您可以赋予版本号明确的含义，这是有用的东西。我们在[CPAN](http://cpan.org)世界中遇到的一个问题是人们没有升级他们的模块，因为他们使用的是 1.03 版本，而最新版本是 1.07，看起来，只有 0.04 的差异。为什么要升级？它没有显示在 1.03 和 1.07 之间有四年。微软发现了这一点，这就是我们购买 Office 2009 而不是 Office 12 的原因（如果你不经常发布它也会咬你一口，谁会想要 2001 年的 Windows 98？）它就在版本号中。“Widgets 2007”告诉你也许你应该去寻找升级。

我曾经使用 ISO 日期作为版本。如果您今天发布，它将是版本 20090309。如果您必须在一天内发布两个，请在末尾添加小时和分钟：20090309.2051。这很容易。它总是上升。它向用户传达了一些关于发布的明确含义。 [这是一个例子](http://search.cpan.org/dist/Method-Signatures/)。

我现在使用[语义版本控制](http://semver.org/)。它使用点三元组来传达三个重要的信息。API被破坏了吗？是否添加了功能？这只是一个错误修复吗？用户必须知道您的项目正在使用语义版本，这是 ISO 日期版本的劣势。优点是它传达的信息类型并且定义明确。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-10T01:24:40.560

我建议始终在您的版本号中使用至少 3 个组件，并且除了第四个或更多组件之外不要隐藏任何内容。到处都遵守这个约定，因为对于非技术人员来说很明显，这不可能是一个有理数，它必须是其他东西（即三个整数的复合物）。

*   2.8.0
*   2.9.0
*   2.10.0
*   2.11.0
*   ...

此外，在关于对话框中，将构建日期 (yyyy-mm-dd) 粘贴在版本号附近。如果客户对版本号感到困惑，他/她可以直接比较日期，这对于普通人来说更直观**。**

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-10T00:28:29.743

你可以做 2.9.1 甚至 2.10.1，但是有很多项目一直在计数。2.10、2.11 12 13 等

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-10T01:13:37.827

我认为您通过走向 2.10 追求了正确的方法。版本号的主要目的应该是将新功能和开发分组为可定义的发布版本。如果您的编号妨碍了这一点，您需要一个不同的编号方案。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-10T01:14:02.037

如果 2.10 引起混乱，则跳过它并转到 2.11。准备好用 2.20 解决同样的问题 :)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-10T02:20:33.797

我建议将您的营销版本与您的 DLL 的内部版本和诸如此类的东西分离。它们有不同的语义。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-10T02:28:27.023

Wikipedia 有[关于软件版本控制的非常好的文章](http://en.wikipedia.org/wiki/Software_versioning)

如果您正在处理长期持续的项目，则基于序列的标识符（如 1.0、2.0 等）无法扩展。

我个人喜欢（并且更喜欢）在其版本中使用发布年份和月份的 Ubuntu 版本控制方案。例如，Ubuntu 8.04 于 2008 年 4 月发布。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-10T02:32:27.967

谢谢 - 这里有很多很棒的答案。

我有“接受答案焦虑”-但我认为从每个答案中取一点可能是正确的。

首先，这里没有对错。其次，编号不应该妨碍任何事情。

版本编号可以被认为是一本书中的章节和章节编号——这将真正帮助我向其他人解释，至少是我的想法。

将营销版本控制与技术/开发版本编号分开/分离将解决所有问题……不过，这是一个长期的答案。

我坚持使用 2.10 来遵循 2.9 - 我会继续战斗......并且肯定会调查 Ubuntu

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-10T18:57:55.070

您应该告诉他们以独立于内部版本号的方式标记软件版本。例如，iPhoto '09 是 iPhoto 8.x 版。微软也做了同样的事情。

显然，主要供应商已经转向与功能发布有关的品牌版本，同时允许开发人员更自由地使用他们的版本号。这让每个人都满意，营销人员会特别高兴，因为他们会想出一个全新的策略来为软件版本打上品牌。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-11-28T17:34:34.633

我不会使用主要版本号来表示完全重写。重写是如此罕见，以至于对于很多员工来说，你只需要解释第 1 版是“在你在这里工作之前”。如果您的产品被称为“堆栈溢出”，那么我只需将重写称为“堆栈溢出”，将较旧的产品称为“旧堆栈溢出”。这可以不断提醒旧版本的用户他们需要迁移。

# iphone - 适用于 Safari、Iphone 的 Webkit API

> ID：628536
> 
> 赞同：2
> 
> 时间：2009-03-10T00:28:31.180
> 
> 标签：iphone, safari, webkit

我访问了 webkit.org，老实说，该站点没有提供任何 API 教程或文档。

我正在寻找新的 CSS 和 DOM webkit 提供的内容。

有谁知道我在哪里可以找到这些信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T00:31:38.333

请参阅Safari[支持的 CSS 属性](http://developer.apple.com/documentation/appleapplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html)列表，它支持与 WebKit 相同的属性。此外，WebKit 支持所有的 CSS3。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-22T05:41:59.743

[Apple 在https://developer.apple.com/libary/safari/](https://developer.apple.com/libary/safari/)维护一个 Safari 开发者库

对于 CSS，您可以阅读[Safari CSS 参考](https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariCSSRef/Introduction.html)，对于 DOM 更新，[WebKit DOM 参考](https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/WebKitDOMRef/index.html)是您的最佳选择（虽然肯定缺少一些细节）

# java - FlexGantt 时间线对象颜色变化

> ID：628542
> 
> 赞同：0
> 
> 时间：2009-03-10T00:31:17.897
> 
> 标签：java, swing, gantt-chart

我正在使用 FlexGantt Javax Swing 包 ( [http://www.dlsc.com/](http://www.dlsc.com/) ) 来显示一些甘特图。我遇到的麻烦是我无法弄清楚如何更改已扩展到我自己的类的 DefaultTimelineObject 的颜色。实际上，我似乎能够改变的唯一颜色是甘特行的背景颜色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T09:48:21.023

[您应该在位于http://groups.google.com/group/flexgantt](http://groups.google.com/group/flexgantt)的 FlexGantt 新闻组中发布此问题

问候，

Dirk（FlexGantt 作者）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T01:55:22.097

所以我确实设法弄清楚了这一点。这有点复杂，或者至少对我来说是这样，因为我并没有真正（并且仍然不完全）理解 FlexGantt 使用的模型-视图-控制器模式。所以，这就是我们要去的地方。我们需要一个扩展 DefaultTimelineObjectRenderer 的 TimelineObjectRenderer 类。该渲染器有一个返回组件的方法，称为 getTimelineObjectRendererComponent。在该方法中，我需要调用方法 setActivityFillColor1 和 setActivityFillColor2，它们是用于在项目上创建垂直混合的两种颜色。

重要的代码在这里：

```
public class myTimelineObjectRenderer extends DefaultTimelineObjectRenderer {
    public Component getTimelineObjectRendererComponent(
        setActivityFillColor1(new Color(r,g,b));
        setActivityFillColor2(new Color(r,g,b));
    }
} //there is other code in this class, not mentioned here 
```

这是第一部分。

下一部分是我们将 Renderer 与 GanttChart 对象本身连接起来，并告诉 Chart 在哪里可以找到每个项目所需的 Renderer。

我使用的两行如下：

```
GanttChart gc = new GanttChart();
gc.getLayerContainer().setTimelineObjectRenderer(
          new myTimelineObject().getClass(),new myTimelineObjectRenderer()); 
```

所以，我最终到达了那里，让它发挥了作用，并且对 FlexGantt 包的灵活性印象深刻。

# objective-c - objective-c setter 二维数组

> ID：628547
> 
> 赞同：2
> 
> 时间：2009-03-10T00:34:31.213
> 
> 标签：objective-c, arrays

我想初始化一个二维数组..但我的代码不起作用，

有人可以告诉我有什么问题吗？

谢谢克里斯

```
@interface Map : NSObject {
    int mapData[8][8];  
}
@property(readwrite) int** mapData;
@end

@implementation Map
@synthesize **mapData; (Error: Syntax before *)

- (id)initWithMap:(int[8][8])map {

    for (int i=0; i<8; i++) {
        for (int j=0; j<8; j++) {
            self.mapData[i][j] = map[i][j];
        }
    }
    return self;
}

@end

(Warning mapData requires method... use @synthesize or.......) 
```

编辑：如果我按照建议删除了 synthesize 的类型，编译器会告诉我另一个错误：属性 mapData 的错误类型与 ivar mapData 的类型不匹配

编辑#2：**有人可以发布更正的代码吗？**我在这个非常愚蠢的问题上工作了一个多小时..（没有 c/c++ 背景，但是 java）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T00:48:23.783

还

```
int mapData[8][8]; 
```

和

```
int **mapData; 
```

有不同的解释。第一个是一个有 64 个连续整数的数组，另一个是指向一个整数的指针。

也许这对你有用，将二维数组包装在一个结构中......

```
struct map_s {
  int map[8][8];
};
typedef struct map_s map_t;

@interface Map : NSObject {
  map_t mapData;
}
@property (nonatomic, readwrite) map_t mapData;
@end

@implementation Map
@synthesize mapData;

- (id)initWithMap:(map_t)map {
  int i, j;
  for (i=0; i<8; i++) {
    for (j=0; j<8; j++) {
      self.mapData.map[i][j] = map.map[i][j];
    }
  }
  return self;
}

@end 
```

稍作改写以显示地图初始值设定项

```
struct map_s {
  int map[8][8];
};
typedef struct map_s map_t;

@interface Map : NSObject {
  map_t mapData;
}
@property (nonatomic, readwrite) map_t mapData;
- (void)init;
- (id)initWithMap:(map_t)map;
@end

@implementation Map
@synthesize mapData;

- (void)init
{
  map_t first = {
    {
      { 0,0,0,0,0,0,0,0 },
      { 0,0,0,0,0,0,0,0 },
      { 0,0,0,0,0,0,0,0 },
      { 0,0,0,0,0,0,0,0 },
      { 0,0,0,0,0,0,0,0 },
      { 0,0,0,0,0,0,0,0 },
      { 0,0,0,0,0,0,0,0 },
      { 0,0,0,0,0,0,0,0 }
    }
  };
  [self initWithMap:first];
}

- (id)initWithMap:(map_t)map {
  mapData = map;
  return self;
}

@end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T01:41:33.640

我认为您不能拥有数组类型的属性。您可以只使用 getter/setter 吗？例如：

```
@interface Map : NSObject {
    int mapData[8][8];  
}
- (int)getI:(int)i j:(int)j;
- (int)setI:(int)i j:(int)j to:(int)v;
@end

@implementation Map

- (id)initWithMap:(int[8][8])map {

    for (int i=0; i<8; i++) {
        for (int j=0; j<8; j++) {
            mapData[i][j] = map[i][j];
        }
    }
    return self;
}

- (int)getI:(int)i j:(int)j {
    return mapData[i][j];
}

- (void)setI:(int)j j:(int)j toValue:(int)v {
    mapData[i][j] = v;
}

@end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T00:40:01.357

属性的综合语句不需要指定类型，只需指定名称即可。

所以;

```
@synthesize mapData; 
```

此外，由于 mapData 是一个实例变量，您不需要使用“self.mapData”语法。你可以这样做；

```
mapData[i][j] = map[i][j]; 
```

最后，请意识到这些只是数据块，因此您可以一次性复制所有内容。例如

```
// could also be sizeof(mapData) but this is more instructive
memcpy(mapData, map, sizeof(int) * 8 * 8); 
```

# c# - 合并 RTF 文件

> ID：628553
> 
> 赞同：7
> 
> 时间：2009-03-10T00:36:42.877
> 
> 标签：c#, rtf

我有一组存储在 C# 中的字符串中的 RTF 是他们将这些合并到一个文档中进行打印的一种方式，因为用户希望将它们打印为一个文档，并且打印设置出现一次。如有必要，我可以使用 office interop，显然避免这种情况会更好。

编辑：每个文档之间都需要分页符，我认为我可以为此插入 \page

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-10T00:49:03.923

您必须从第一个文档中删除尾随 }。

您必须从第二个文档中删除 {\rtf1... 和 {fonttbl.. 和 {colortbl... 部分。可能需要查看您可能拥有的任何标题、边距等。

如您所说，用 \page 将它们分开。

这假设字体和颜色表是相同的。

如果可以的话，最好从用户那里获取打印设置，然后单独打印每个文档。

文件 1：

```
{\rtf1\ansi\ansicpg1252\deff0\deflang5129
{\fonttbl{\f0\fswiss\fprq2\fcharset0 Arial;}}
{\colortbl;\red0\green0\blue0;}
\margl1134\margr1134\margt1134\margb1134\sectd 
\pard
Document One Content
\line
} 
```

文件 2：

```
{\rtf1\ansi\ansicpg1252\deff0\deflang5129
{\fonttbl{\f0\fswiss\fprq2\fcharset0 Arial;}}
{\colortbl;\red0\green0\blue0;}
\margl1134\margr1134\margt1134\margb1134\sectd 
\pard
Document Two Content
\line
} 
```

合并文件：

```
{\rtf1\ansi\ansicpg1252\deff0\deflang5129
{\fonttbl{\f0\fswiss\fprq2\fcharset0 Arial;}}
{\colortbl;\red0\green0\blue0;}
\margl1134\margr1134\margt1134\margb1134\sectd 
\pard
Document One Content

\page

\pard

Document Two Content
\line
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-29T22:17:46.487

仅当两个文档使用相同的字体集时，仅删除字体表才有效。如果要保留两个 rtfs 的字体信息，则需要唯一地合并（联合）字体表（字体元素）。这将适用于 n 个 rtfs，但我们再次需要单个字体表的联合。我目前正在开发这个联合的代码，一旦准备好就会发布。:)

在我们的项目中，我们还使用 Office Doc 对象来呈现 rtfs 并从 word 的自动化中受益。但它创建了安装 ms-word 的依赖关系。特别是如果代码需要从内存也是一个问题的服务器运行，它可能会引发问题，因为使用 word API 会导致 ms-word 的实例被加载到内存中。但解决方案确实有效！！

好的！！准备好在两个 rtfs 中合并字体表并合并它们以保留不同字体的代码。请阅读字符串中的 RTF。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections;
//Arjun 02nd May
namespace MergeRtf
{
class RTFUtils
{
    public static string getRTFBlock(string blockName,string rtf){

       int i=rtf.IndexOf(@"{\"+blockName);
        int startOfBlock = i;
        //Next find the end of style sheet element tag
        Stack<char> braceHolder=new Stack<char>();
        braceHolder.Push('{');

        string stylesheetBlock = "";

        while (braceHolder.Count != 0&&i<rtf.Length) {
            i++;
            if (rtf[i] == '{') {
                braceHolder.Push('{');
                continue;
            }
            if (rtf[i] == '}') {
                braceHolder.Pop();
            }
        }
        if (braceHolder.Count == 0) { 
        //encountered the ending tag for stylesheet
            stylesheetBlock = rtf.Substring(startOfBlock, i-startOfBlock+1); 
            return stylesheetBlock;
        }
        else
        {
            //Error in doc format
            throw (new Exception("Error in doc format"));
        }

    }

    public static string MergeRTFs(string rtf1,string rtf2,string mergingBreak){ 
        //mergingBreak is the type of break that will be sandwiched between the docs
        //get the fonttbl blocks for both the documents
        string fontTableOfDoc1 = getRTFBlock("fonttbl", rtf1);
        string fontTableOfDoc2 = getRTFBlock("fonttbl", rtf2);

        //get font lists
        List<string> fontList1 = ExtractRTFFonts(fontTableOfDoc1);
        List<string> fontList2 = ExtractRTFFonts(fontTableOfDoc2);

        //Union the font list
        IEnumerable<string> mergedfonts = fontList1.Union(fontList2);
        List<string> fontList3 = new List<string>(mergedfonts);
        string mergedFontListBlock = @"{\fonttbl";
        foreach (string font in fontList3) {
            mergedFontListBlock += font;
        }
        mergedFontListBlock += "}";

        //Find location of the fonttable in doc 1 and doc 2
        int indexOfFontTable1 = rtf1.IndexOf(@"{\fonttbl");
        int indexOfFontTable2 = rtf2.IndexOf(@"{\fonttbl");

        string rtfMerged = "";
        //Get rtf content before and after fonttable
        string headerRTF1 = rtf1.Substring(0, indexOfFontTable1);
        int endOfFontTableIndex=indexOfFontTable1 + (fontTableOfDoc1.Length-1);
        string trailerRTF1 = rtf1.Substring(endOfFontTableIndex + 1,      rtf1.LastIndexOf('}') - (endOfFontTableIndex + 1)); //-2 to remove ending } of 1st doc
        //create the first rtf with merged fontlist
        rtfMerged = headerRTF1 + mergedFontListBlock + trailerRTF1;
        //next identify trailer part after font table in rtf 2
        string trailerRTF2 = rtf2.Substring(indexOfFontTable2 + fontTableOfDoc2.Length);
        rtfMerged += mergingBreak + trailerRTF2;

        return rtfMerged;
    }

    private static List<string> ExtractRTFFonts(string fontTableBlock) {
        Stack<char> braces = new Stack<char>();
        List<string> fonts = new List<string>();
        int fontDefStart=0,fontDefLength;
        braces.Push('{');
        int i=0;
        while (braces.Count > 0 && i < fontTableBlock.Length) { 
            i++;
            if (fontTableBlock[i] == '{') {
                braces.Push('{');
                if (braces.Count == 2) { 
                //means font definition brace started store the position
                    fontDefStart = i;
                }
                continue;
            }
            if (fontTableBlock[i] == '}') {
                braces.Pop();
                if (braces.Count == 1) { 
                //means only root level brace left identifying one font definition ended
                    fontDefLength = i - fontDefStart + 1;
                    fonts.Add(fontTableBlock.Substring(fontDefStart,fontDefLength));
                }
            }
        }

        if (braces.Count == 0)
        {
            //everything is fine then
            return fonts;
        }
        else { 
        //malformed font table passed
            throw (new Exception("Malformed font table passed"));
        }
    }

}
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-13T15:33:33.757

您可以使用两个富文本框。将 rtf 文件读入一个富文本框 (rtbTemp)，然后将文本剪切并粘贴到另一个 (rtbMerged) 中。例如：

```
RichTextBox rtbTemp = new RichTextBox();
RichTextBox rtbMerged = new RichTextBox();

string Merge(string s1, string s2)
{
    rtbTemp.Rtf = s1;
    rtbTemp.SelectAll();
    rtbTemp.Cut();
    rtbMerged.Paste();

    rtbMerged.AppendText(Environment.NewLine);
    rtbMerged.AppendText(Environment.NewLine);

    rtbTemp.Rtf = s2;
    rtbTemp.SelectAll();
    rtbTemp.Cut();
    rtbMerged.Paste();

    return rtbMerged.Rtf;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-03T16:40:43.143

我只从第一个 rtf 文件的末尾删除 3 个字符，以及第二个 rtf 文件的第一个字符，它工作得很好！

```
RichTextBox r = new RichTextBox();
r.Rtf = rtf1.Rtf.Substring(0, rtf1.Rtf.Length - 3) + rtf2.Rtf.Substring(1,rtf2.Rtf.Length - 1) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T01:21:41.380

我想还有一种方法可以做到这一点，而无需深入了解 RTF 格式的细节。将您的 RTF 保存为文件并使用 MS Word 的自动化打开文档并将文档彼此附加（然后再次另存为 RTF）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T12:41:06.560

我已经使用此[代码两次合并到 rtf 文件](http://miscosasdepuntonet.blogspot.com/2009/04/como-unir-2-documentos-rtf-aspnet-c.html)，使用 de 方法 Merge 与 de 文件的 de 路径。如果你只有文本，你可以修改它，但如果你有更大的文档，你会出现记忆错误。我很抱歉我的英语。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2011-02-25T05:09:16.343

[给你](http://anhl3.blogspot.com/2011/02/trick-of-processing-rtf-files.html)（包含 C# 代码）

# c# - 从正则表达式仅返回部分匹配项

> ID：628556
> 
> 赞同：25
> 
> 时间：2009-03-10T00:37:58.583
> 
> 标签：c#, regex

假设我的字符串“用户名：firstname.surname”包含在一个较大的字符串中，如何使用正则表达式来获取 firstname.surname 部分？

我尝试过的每种方法都返回字符串“用户名：firstname.surname”，然后我必须将“用户名：”上的字符串替换为空字符串。

可以在这里使用反向引用吗？

编辑：

较长的字符串可能包含“帐户名称：firstname.surname”，因此我想匹配字符串的“用户名：”部分以获得该值。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-03-10T00:43:33.220

我喜欢使用命名组：

```
Match m = Regex.Match("User Name:first.sur", @"User Name:(?<name>\w+\.\w+)");
if(m.Success)
{
   string name = m.Groups["name"].Value;
} 
```

将`?<something>`组的开头放在括号中（例如`(?<something>...)`）允许您使用`something`作为键（例如 from `m.Groups["something"].Value`）从匹配中获取值

如果你不想麻烦给你的组命名，你可以说

```
Match m = Regex.Match("User Name:first.sur", @"User Name:(\w+\.\w+)");
if(m.Success)
{
   string name = m.Groups[1].Value;
} 
```

并得到第一个匹配的东西。（请注意，第一个带括号的组位于 index `1`；匹配的整个表达式位于 index `0`）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-08-21T14:51:48.847

您也可以尝试“环视”的概念。这是一种零宽度断言，这意味着它会匹配字符，但不会在结果中捕获它们。

在您的情况下，我们可以积极地向后看：我们希望目标字符串“firstname.surname”后面的内容等于“User Name：”。

正向后视运算符：(?<=StringBehind)StringWeWant

例如，可以这样实现（一个小的 Java 示例，使用字符串替换）：

```
String test = "Account Name: firstname.surname; User Name:firstname.surname";
String regex = "(?<=User Name:)firstname.surname";
String replacement = "James.Bond";
System.out.println(test.replaceAll(regex, replacement)); 
```

这仅替换“用户名：”前面的“名字.姓氏”字符串，而不替换“用户名：”本身 - 正则表达式不返回，仅匹配。

输出：帐户名称：firstname.surname；用户名：James.Bond

***也就是说，如果您使用的语言支持这种操作***

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-10T00:49:22.283

用括号创建一个组，然后从`Match.Groups`集合中获取它，如下所示：

```
string s = "User Name:firstname.surname";
Regex re = new Regex(@"User Name:(.*\..*)");
Match match = re.Match(s);
if (match.Success)
{
    MessageBox.Show(match.Groups[1].Value);
} 
```

（注意：第一组，索引为 0，是整个匹配）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-10T00:44:45.057

我使用的所有正则表达式库都允许您使用括号在正则表达式中定义组，然后从结果中访问该组。

因此，您的正则表达式可能如下所示： User name:([^.].[^.])

完全匹配是第 0 组。括号内匹配的部分是第 1 组。

# winapi - 在 Win32 上使用 GNU gettext

> ID：628557
> 
> 赞同：2
> 
> 时间：2009-03-10T00:38:01.017
> 
> 标签：winapi, gettext

我正在编写一个主要面向 GNU/Linux 和 Mac OS X 系统的游戏，但我一直在我的大部分代码中保持相当可移植的内容。

我已经将几乎所有特定于操作系统的东西都移植到了 Windows 上。唯一剩下的是i18n。

我的问题是这个

> 我应该如何将 Win32 的`setlocale()`功能与 gettext 一起使用？

到目前为止，我一直在使用 ISO 638/ISO 3166 代码（例如`de_DE.utf8`），但这些代码似乎不适用于 Windows。

我尝试了 setlocale(LC_ALL, "German")，它成功了，但是 gettext 无法正确找到翻译后的字符串，即使在使用 bindtextdomain 之后也是如此。

有什么提示吗？我想坚持使用 GNU gettext 以避免重写大量代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T04:53:52.913

好吧，经过一番挖掘，我找到了答案：Windows 上的 setlocale() 对 gettext 没有任何作用。gettext 使用用户的环境和线程的区域设置（请参阅 GetThreadLocale、SetThreadLocale）。如果使用线程的区域设置，则返回的 LCID 将转换为具有 ISO 639 和 3166 的语言字符串（例如 en_US），并且查找在 *nix 上进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-03T09:33:27.870

如果您可以阅读 Python 示例，那么我的小项目有助于将 Windows 区域设置 ID 转换为 gettext 语言代码，例如`de_DE`：[https ://launchpad.net/gettext-py-windows](https://launchpad.net/gettext-py-windows)

简而言之，您需要使用返回整数 id 的`LCID`函数来获取。`GetUserDefaultLCID()`然后您需要将此值映射到字符串代码。在 Python 中，标准模块中有地图`locale.py`：请参阅`windows_locale`文件底部附近的字典[http://svn.python.org/view/python/trunk/Lib/locale.py?view=markup](http://svn.python.org/view/python/trunk/Lib/locale.py?view=markup)

您可以在此处找到 Windows 区域设置 ID 列表：http: [//msdn.microsoft.com/en-us/library/dd318693%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/dd318693%28VS.85%29.aspx)

获得语言代码 ( `de_DE`) 后，您需要将其直接传递给 gettext 库或使用环境变量 LANGUAGE 间接传递。

# bash - 使用 shell 脚本过滤目录列表

> ID：628564
> 
> 赞同：2
> 
> 时间：2009-03-10T00:44:10.393
> 
> 标签：bash, shell

如果我有一个 BASH 变量：

```
Exclude="somefile.txt anotherfile.txt" 
```

如何获取目录的内容，但将上述内容排除在列表中的文件中？我希望能够做类似的事情：

```
Files=  #some command here
someprogram ${Files} 
```

`someprogram``${Exclude}`应该给出特定目录中的所有文件，变量中的文件除外。修改`someprogram`不是一种选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T01:11:26.553

我不确定您是否正在学习 unix shell 脚本，但这是 bash 的一个工作示例：

```
#!/bin/bash

Exclude=("a" "b" "c")
Listing=(`ls -1Q`)

Files=( $(comm -23 <( printf "%s\n" "${Listing[@]}" ) <( printf "%s\n" "${Exclude[@]}"
) ) )

echo ${Files[@]} 
```

请注意，我用双引号将 Exclude 中的每个文件名括起来，并在它们周围添加了括号。替换`echo`为`someprogram`，将 ls 命令更改为您要检查的目录，您应该可以让它工作。`comm`程序是关键，在这里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T01:08:43.750

您可以使用查找。就像是：

```
FILES=`find /tmp/my_directory -type f -maxdepth 1 -name "*.txt" -not -name somefile.txt -not -name anotherfile.txt` 
```

其中 /tmp/my_directory 是您要搜索的路径。

如果你想要一个简单的 for 循环，你可以从排除中建立“-not -name blah -not -name blah2”列表......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T01:16:56.320

这是标准 Unix 命令行的一个衬里：

ls | grep -v "^${排除}$" | xargs

它确实有一个假设。${Exclude} 需要正确转义，这样句号之类的字符就不会被解释为正则表达式的一部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T10:56:00.190

假设文件名没有空格或其他病态字符：

```
shopt -s extglob
Files=(!(@(${Exclude// /|}))) 
```

# c# - 在发布模式下显示 .NET 程序集的堆栈跟踪中的行号

> ID：628565
> 
> 赞同：146
> 
> 时间：2009-03-10T00:44:28.943
> 
> 标签：c#, .net, visual-studio, stack-trace, line-numbers

有没有办法在发布模式下显示 .NET 程序集构建/部署的堆栈跟踪中的行？

**更新：**

我的应用程序分为三个类库项目和一个 ASP.NET“网站”项目。我试图追查的错误是在三个类库项目之一中。我只为生成“对象引用未设置为对象的实例”错误的类库项目部署了 pdb 文件。

行号仍未显示在堆栈跟踪中。我是否需要为所有项目部署 pdb 文件以获取堆栈跟踪中的行号？

**工作解决方案**

为每个应用程序部署 pdb 文件修复了行号问题。

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-03-10T01:01:56.217

*   进入要查看堆栈跟踪行号的项目的“属性”窗口。
*   单击构建“垂直选项卡”。
*   选择“发布”配置。~~检查 DEBUG 常量参数。~~
*   取消选中“优化代码”参数以避免内联代码偶尔出现跟踪问题（此步骤不是必需的）。
*   按 Advanced... 按钮并选择 Output -> Debug Info -> pdb-only。
*   使用程序集部署生成的 .pdb 文件。

# 使用以下评论实现：

*   要检查的另一件事是在“打包/发布 Web”部分中，“排除生成的调试符号”复选框也未选中

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-01-29T20:50:20.193

在 VS2012 中，您还需要在属性的“打包/发布 Web”部分中取消选中“排除生成的调试符号”。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-09-03T20:10:54.983

我的解决方案

将 pdb 文件复制到与可执行文件相同的文件夹中。

现在我可以在运行 exe 文件时查看行号。

这是原因

[http://msdn.microsoft.com/en-us/library/ee416588%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ee416588%28v=vs.85%29.aspx)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-09-03T20:27:20.840

过去我遇到过一些问题，我觉得需要使用发布版本部署 PDB 文件以跟踪错误。原因是，就像你说的，异常发生在一个非常大的方法中，我无法准确地确定它发生在哪里。

这可能表明该方法需要重构为更小、更细粒度的方法。不是一刀切的答案，但这种方法在短期内（我经常在重构过程中发现错误）和从长远来看对我很有帮助。

只是一个想法。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-10T00:47:07.873

在构建/部署包中包含调试符号。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T14:54:54.483

在 VS 2008 Express 中，我在 Project Properties --> Compile --> Advanced Compile Options 下找到了它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-08T04:21:27.177

在 .NET Core 中，您需要关闭发布模式的“优化代码”选项以显示正确的行号。

[控制代码生成的 C# 编译器选项](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/code-generation#optimize)

* * *

## 回答 #8

> 赞同：-7
> 
> 时间：2016-03-07T15:32:59.660

这每次都有效。您只需要对堆栈跟踪消息进行子串化。真正的容易！此外，在 vb.net 中，您确实需要执行“显示所​​有文件”并包含 pdb。

```
'Err is the exception passed to this function

Dim lineGrab As String = err.StackTrace.Substring(err.StackTrace.Length - 5)
Dim i As Integer = 0
While i < lineGrab.Length                   
    If (IsNumeric(lineGrab(i))) Then
        lineNo.Append(lineGrab(i))
    End If
    i += 1
End While

'LineNo holds the number as a string 
```

C#版本：

```
string lineGrab = error.StackTrace.Substring(error.StackTrace.Length - 5);

int i = 0;
int value;
while (i < lineGrab.Length)
{
    if (int.TryParse(lineGrab[i].ToString(), out value))
    {
        strLineNo.Append(lineGrab[i]);
    }
    i++;
} 
```

# language-agnostic - 您是否曾经有一个业务需求被证明是一个 NP-Complete 问题？

> ID：628568
> 
> 赞同：7
> 
> 时间：2009-03-10T00:45:16.477
> 
> 标签：language-agnostic, np-complete

在我看来，NP-completeness 似乎是那些大多只是理论上的东西，而不是你在正常工作环境中遇到的东西。

所以我有点好奇，是否有人在他们的工作中遇到了一个结果证明是 NP 完全的问题，并且需要更改设计以适应它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-10T01:34:19.710

正如其他人所说，背包（用于包装货物）和旅行商问题可能是最常见的“现实世界”NP-完全问题。

我倾向于在工作中遇到无法证明是 NP 完整或不完整的问题，因为它们的定义不是很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T00:48:35.593

任何需要在两个以上位置之间找到最佳旅行点的映射工具都可以在不进行任何更改的情况下成为[NP-Complete 问题](http://en.wikipedia.org/wiki/Traveling_salesman_problem)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T00:52:20.250

从仓库优化波次拣货的问题等价于[旅行推销员问题](http://en.wikipedia.org/wiki/Traveling_salesman_problem)。

也就是说，您有 N 个订单等待拣选，并且您希望找到 n 个最佳订单以最小化行进距离和拣货员访问的不同拣货位置。

我最近遇到了这个问题。我们下注并使用了一个近似值，该近似值适用于一般情况，但有时可能会提供次优结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T01:30:00.703

此外，背包问题（NP-hard）相当频繁地出现。这是试图优化事物的诱人陷阱。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-05T18:24:51.253

当我还是大学一年级的学生时，我同意为朋友的父亲编写软件。这是为了调度资源。我当时并没有意识到，但事实证明这是一个 NP 完全问题。

值得庆幸的是，只需找到一个解决方案是可以接受的——不需要找到最佳解决方案。编写启发式方法很有趣——实际上是一组启发式方法——可以在程序运行并尝试解决问题时进行更改。

我在夏天完成了一个解决方案，但随后每年都在开发新版本。我出售它的宏伟计划落空了。我是一个比营销人员更好的开发人员。

这很有趣，并且在早期教会了我很多关于现实世界的开发——（最终用户、需求收集、测试等——很多你在本科 CS 中得不到的东西）

为了解决您的问题 - 这是一位必须安排学生接受特殊指导的老师。他是一名言语治疗师和听力学家——但它可以应用于任何类似的领域。他有现有的教师、课堂和学生活动可以解决，并且每周必须与学生见面特定次数。这是背包问题或任何数量的其他类似/等效的调度问题。

再次证明，只要找到一个解决方案就可以了——我们不必最大化或最小化任何东西——我们只需要容纳所有的学生。

我只记得无法解决我用来运行场景的测试用例——他多年来提供的所有问题，我们都解决了。

我从来没有能够推销它——主要是因为我不知道我在做什么，我不知道如何接触我的市场/买家。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-05T18:25:34.653

值得注意的是，有一些启发式逼近技术可以为 NP 完全问题获得“足够好”的答案，例如模拟退火和压缩退火。如果您可以将 NP 完全问题简化为 Traveling Salesman 问题，则可以使用这些方法。（任何 NP 完全问题都可以简化为任何其他 NP 完全问题，但实际上这样做有时会让人头疼。）

无论如何，那里有模拟退火和压缩退火实现。其中之一是[Djinni](http://scarydevilmonastery.com/trac/Djinni/wiki)，它是用 C++ 编写的并具有 Python 绑定。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T00:48:20.510

旅行商问题就是一个很好的例子。同样的物流问题也适用于航空公司、邮局和各行各业。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-05T18:26:49.253

另一个例子是，拥有区域配送中心的公司，尤其是那些直接向客户交付的公司（例如 Netflix），需要担心被称为[设施位置](http://people.brunel.ac.uk/~mastjjb/jeb/or/facloc.html)的 NP-Complete 问题系列。

事实上，NP-Complete 问题与现实世界相关的想法得到了证明，即它们的近似算法如此频繁地出现在运筹学期刊中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-05T18:40:56.557

几年前我正在开发一个地图程序，比如原生的谷歌地图。我在地图上放置了一些位置标记，但是很多标记紧密地聚集在某些位置。我的老板说“让我来做，这样我就可以将标记拖开一点”（它会有一条线或语音气泡指针从标记到实际位置）。

我认为让用户这样做是愚蠢的，特别是因为他会花 5 分钟使它完美，然后更改缩放级别，然后一切都会出错。

我决定尝试编写一个函数来找到一种布置标签的方法，以使从每个标签到其位置的总屏幕距离最小化。我相信我当时说服自己这是 NP 完全的，但点的数量可能足够小，至少在许多情况下仍然可行。（我记得我们在课堂上花了太多时间在 NP 完备性证明上，而在替代解决方案上花的时间不够：如果你的老板想要完成某件事，你不能只说“NP 很难，不会做”——你还是得想*办法*。）

然后谷歌地图出现了，只是把所有的标签都放在了一起，这太糟糕了（我每天都在诅咒它），但我无法与他们的其他功能竞争，所以我放弃了。:-(

# java - JSF 调优

> ID：628570
> 
> 赞同：12
> 
> 时间：2009-03-10T00:46:44.960
> 
> 标签：java, jsf, websphere, performance

遇到 JSF 正在填满我们的会话的问题。前几天我们发生了系统崩溃。将 Heap 发送给 IBM 进行审核，发现我们有一些会话高达 50M。他们在会话中发现 JSF 组件并且有些非常大。

那么，有没有可以做的调优呢？配置项要看？或者其他方向。

我们的系统是使用 JSF 和 Spring 作为表示层构建的，后端是 EJB、Spring 和 Hibernate，它们都在 WebSphere 6.1 上运行。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-10T12:18:58.383

JSF 是一种有用的技术，但您当然可以用它来吊死自己。

听起来，要么你在夸大视图状态的大小（通过在组件上设置大的值），要么你正在将对组件的引用泄漏到其他会话状态中（这会很糟糕）。另一个潜在的罪魁祸首是视图过大（我已经看到人们可以轻松构建 UI 树导致非常大的控制图，其中到处都是数据表）。我知道 IBM 提供富文本和电子表格控件 - 我无法评论使用这些控件将对状态大小产生什么影响。

唾手可得的成果是检查*faces-config.xml*中为会话范围配置的托管 bean 。

JSF 在请求之间保存了两件事：

*   视图（页面上的所有控件）
*   视图状态（控件的状态）

这些是分开的，因为某些控件（例如数据表的子项）可以具有多种状态（每行一个状态）。状态可以保存到表单上的隐藏字段（如果未加密，可能会带来很大的安全隐患）或会话中。为了适应共享同一会话的多个浏览器窗口（并且在某些实现中，支持后退按钮），存储了多个视图。

*   应该有一个配置选项来设置应用程序在任何给定时间为给定用户在会话中保留的视图状态数。
*   您可以通过提供一个测量已保存视图/状态大小的[StateManager](http://java.sun.com/javaee/5/docs/api/javax/faces/application/StateManagerWrapper.html)来测量视图状态的大小（在 faces-config.xml 中配置一个 StateManager，并使用一个采用 StateManager 的公共构造函数 - 有关更多详细信息，请参阅[JSF 规范](http://java.sun.com/javaee/javaserverfaces/reference/api/index.html)PDF；该状态是可序列化的，您可以通过将其转储到流中来检查其大小）。

大多数 IDE 构建的 JSF 应用程序都有支持 bean。有可能通过会话 bean 范围保持状态比您想要的时间更长，从而给会话带来压力。由于每页往往有一个支持 bean，因此您拥有的页面越多，问题就越大。检查您的*faces-config.xml*以查看这是否是潜在的问题来源。

您可以做的其他事情是在您的*web.xml中配置一个*[HttpSessionAttributeListener](http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpSessionAttributeListener.html)。您可以获得[堆栈跟踪](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#getStackTrace())以帮助识别应用程序中的问题区域。

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T00:56:28.740

这是我听说的第二个由于 JSF 和过多的对象创建而死亡的系统。另一个在后端也使用了 Spring 和 Hibernate。使用 OptimizeIt 进行分析表明，所有请求的后端响应都在毫秒级，但是您可以使用秒表再次为浏览器渲染计时，因为它花了很长时间 - 30 秒到几分钟。客户端消耗的内存是荒谬的。

我只是一个观察者，不是那个项目团队的成员。我将不得不询问问题是否已解决，如果是，解决方案可能是什么。

但是，如果有两点形成趋势，我会说 JSF 可能存在致命缺陷。就个人而言，我完全远离它。

为什么不试试 Spring Web 前端看看是否有帮助？如果您遵循 Spring 习惯用法，那么将 JSF 替换为基于 JSTL 的 JSP 和 Spring 控制器应该是一件相对简单的事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-11T06:25:23.747

我正在处理一个 JSF 项目，发现我们有一个错误，我们正在添加多个 JSF h:form 元素。导致每个表单都包含整个视图状态的副本。将每页减少到 1 个表单将页面从 ~2M 减少到 ~300K。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T15:44:28.927

您可能会遇到将大量支持 bean 作为会话范围的问题。

您可以尝试查看[MyFaces Orchestra](http://myfaces.apache.org/orchestra/index.html)。这是一个提供会话范围的库，因此一旦用户完成了一组特定的 bean，他们将从会话中删除。

我知道 Spring WebFlow 具有类似的功能，但我还没有真正研究过！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T02:22:02.510

JSF 将视图存储在会话中以支持其丰富的基于组件的架构（需要维护其视图状态），如果使用不当，可能会填满堆。如果您没有大的工作流程，请始终使用每个会话的少量视图。还要尽可能避免让 backingbeans 保持在会话中。使用自定义标签使数据对象仅用于下一个请求周期。我们还可以将 Spring Web Flow 与 JSF 一起使用，如果我们在应用程序中有较长的工作流，它会引入视图范围和流范围，以减少会话中配置的视图数量。JSF 可用于轻松制作丰富的用户界面，有助于构建类似于桌面应用程序的 Web 应用程序。为 JSF 框架分配一个特定的堆来完成它的工作。但是在应用程序端有效地使用内存并确保没有内存泄漏。所有内存泄漏都需要在开发过程中进行调查和纠正。Aways 使用分析器来查找应用程序中存在的内存泄漏和性能瓶颈。

垫。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T12:07:07.167

如果您使用的是 MyFaces < 1.1.6，那么它在会话中缓存旧的序列化视图的方式存在巨大的内存泄漏，有效地从不让它们释放，以便它们可以被垃圾收集。我对此有一个严重的问题，并且也有 50Mb 的会话。MyFaces 的快速升级解决了这个问题，没有任何问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-18T22:01:52.897

配置会话持久化到数据库，它将使用最少使用的算法将最少使用的会话推出内存。它具有高性能（如果配置正确），将具体而快速地帮助您。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-03-11T11:47:29.747

有点老话题，但最近遇到了这个。通常，视图和视图状态被存储（如前所述），并填充会话以允许后退按钮工作。在需要设置的部署描述符 (web.xml) 中有一些参数可以对其进行排序。

某些库的多个实例可能需要多个参数设置，例如在使用 MyFaces 和 JSF RI 时。默认情况下，它们可以设置为一些相当高的值（我相信分别为 20 和 16）。这意味着您可以使用 20 倍于您应该用于（部分？）会话的空间。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-06-07T01:49:55.647

生产环境的 JSF 调优技巧：
- 图片、CSS、JavaScript 资源的使用应该通过标准的 HTML 标签`(img,link,script)`而不是服务器端来完成，并且一定要`#{request.contextPath}`在 url 之前设置以避免相对路径问题。-使用
缓存页面的静态部分 - 将变量设置为 -1 - 设置为生产 - 检查您的代码过滤器（如果有） `(menu,header,footer)``omnifaces cache`
`refresh-period`
`project-stage`

另外，请查看我在 DZone 上的文章“ [Java Server Faces in Real-Life Applications](https://dzone.com/articles/java-server-faces-in-real-life-applications) ”，它将让您全面了解 JSF 在开发、测试和生产环境中的情况。

# c# - ListView 中的 WPF 文本格式

> ID：628578
> 
> 赞同：1
> 
> 时间：2009-03-10T00:50:32.967
> 
> 标签：c#, wpf, listview

在 WPF ListView 中显示项目时，我需要应用一些文本格式。文本格式只是在文本中的某些字符串上设置不同的背景颜色而已。

文本不适合不同的列，因此不能将样式应用于 ListView 列之一。

我很确定答案是以某种方式在 ListView 的 TextBlock 控件中使用 Paragraphs 或 Runs，但我无法在 XAML 中找到如何使用它。到目前为止，我所得到的证明我正在尝试做但不起作用的是：

```
<ListView>
  <ListView.View>
    <GridView>
      <GridViewColumn Width="600">
        <GridViewColumn.CellTemplate>
          <DataTemplate>
            <TextBlock>
              <Paragraph>
                <Binding Path="ListDescription" />
              </Paragraph>
            </TextBlock>
          </DataTemplate>
         </GridViewColumn.CellTemplate>
      </GridViewColumn>
    </GridView>
  </ListView.View>
</ListView> 
```

绑定的 ListDescription 属性将是 Paragraph 或其他可以保存格式化文本的容器控件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T01:10:57.490

我认为这在纯 XAML 中是不可能的。您可以使用文本块或 RichTextBlock 以相同的样式格式化整个字符串，但要将不同的格式应用于子字符串，您将需要用户控件或其他形式的代码逻辑 - 例如值转换器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T06:01:42.627

我在一个相关问题上找到了答案：[如何将段落数据绑定到 TextBlock？](https://stackoverflow.com/questions/483834/how-would-i-databind-a-paragraph-to-a-textblock).

```
<GridViewColumn Width="600">
  <GridViewColumn.CellTemplate>
    <DataTemplate>
      <ItemsControl ItemsSource="{Binding ListDescription}">
        <ItemsControl.ItemsPanel>                   
           <ItemsPanelTemplate> 
             <WrapPanel/>                    
           </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>  
      </ItemsControl>
    </DataTemplate>
  </GridViewColumn.CellTemplate>
</GridViewColumn> 
```

对于我绑定到 ListView 的数据源，我有：

```
public InlineCollection ListDescription
{
    get { return GetFormattedHistoryStatement().Inlines; }
} 
```

# java - 正则表达式以逗号分隔，不包含在括号中

> ID：628583
> 
> 赞同：4
> 
> 时间：2009-03-10T00:53:59.200
> 
> 标签：java, regex

我无法编写正则表达式以在 String.split (Java) 表达式中使用，例如仅拆分不在括号中的逗号。

例子：

> (54654,4565):(45651,65423),4565:45651,(4565,4564):45651

应该产生3个字符串：

1.  (54654,4565):(45651,65423)
2.  4565:45651
3.  (4565,4564):45651

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-10T02:24:08.203

You can do this with just a lookahead, which is easier to work with than lookbehind.

```
String[] parts = str.split(",(?![^()]*+\\))"); 
```

But the other responders are right: if you couldn't come up with this regex on your own, what will you do when the requirements change? You're probably better off with a long-winded solution that you actually understand.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T01:28:24.703

这有效：

`String regex = "((?<!\\d),)|(,(?!\\d))";`

但假设您在逗号的一侧或另一侧有数字以外的东西。因此，它并没有真正查看您是否在括号内，而是希望看到它没有在仅由数字包围的逗号上拆分。

因此，如果您正在查看此文本：

`"45651:65423,4565:45651"`

那么这个解决方案失败（例如）。如果您更具体地了解您期望的输入类型，我们可能会根据您的情况定制我们的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T02:03:44.867

Just a reminder that you need to be careful if there will be any nesting. Regex just isn't very good at this. Consider the following snippet:

> (a,)b,(c,(d,)e,)

Based on your question, you would only want to match comma `b`. The trick is that expressions are generally either completely greedy or completely un-greedy, with little middle ground.

A greedy expression would see the `(` at the very beginning of the segment and the `)` at the very end and take *everything* inside them, regardless that there are closing parentheses elsewhere. *Nothing* would be matched.

An ungreedy expression would take only the smallest set possible, starting from the beginning. It would match comma `b`, but also see this segment as one unit: `(c,(d,)`. Then it would proceed to also match comma `e`, because it's already taken the last `(`.

There are some engines that allow you to handle the nesting levels, but the expressions are usually ugly and hard to maintain: best to just avoid the feature unless you really understand it well.

# symfony1 - 跨多个服务器部署 Symfony 应用程序

> ID：628584
> 
> 赞同：1
> 
> 时间：2009-03-10T00:56:19.443
> 
> 标签：symfony1

对于我的 Symfony 应用程序，我至少有两个模块：

1.  登录模块
2.  处理模块

登录模块位于网关服务器上；当用户首次登录时，它会执行所有身份验证。之后，它会重定向到位于另一台服务器上的处理模块。请注意，可以有许多服务器处理处理模块。

问题是如何在 Symfony 中的不同服务器之间保持会话持久性？我计划将我的会话数据存储在数据库中。是那个吗

1.  使数据库对所有服务器公开
2.  [将用户会话管理数据库指向该数据库](http://www.symfony-project.org/book/1_2/06-Inside-the-Controller-Layer)

会做？有什么我想念的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-17T08:24:03.643

如果我理解正确：您有 1 个 symfony 应用程序，其中包含两个模块，它们应该在至少 2 个不同的服务器上（在一台服务器上登录，在 2 个或更多服务器上处理）。

将这些模块分离到不同的应用程序不会更好（因为它们部署在不同的服务器上）

例如：在第一台服务器上登录的应用程序，登录后它重定向到具有处理模块的应用程序的服务器上。

为此，您需要将会话数据存储到数据库（现有的 mysql 和 pdo 适配器）。

这样就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-17T12:31:32.770

这是我发现的如何[跨多个服务器](http://itscommonsensestupid.blogspot.com/2009/03/how-to-deploy-symfony-application.html)部署 Symfony 应用程序。

# c++ - 重命名可执行文件会导致运行时出错

> ID：628588
> 
> 赞同：1
> 
> 时间：2009-03-10T01:00:09.730
> 
> 标签：c++, email, executable

我创建了一个小型守护程序（基本上是一个隐藏控制台并运行的控制台应用程序）。

我需要将其发送给用户并尝试使用不同的扩展名重命名可执行文件，将其通过电子邮件发送给用户，并让他们将其重命名为正确的名称。

当我通过电子邮件将其发送给自己进行测试时，这似乎有效。但是，当用户尝试运行可执行文件时，会产生以下错误消息：

> 此应用程序无法启动，因为应用程序配置不正确。重新安装应用程序可能会解决问题。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-10T01:20:21.553

您缺少一些 dll。

[您可以使用dependency walker](http://www.dependencywalker.com/)准确找出哪些。

您还可以安装[Visual Studio Re-distributable package (x86)](http://www.microsoft.com/downloads/details.aspx?FamilyID=9b2da534-3e03-4391-8a4d-074b9f2bc1bf&displaylang=en)或[Visual Studio Re-distributable package (x64)](http://www.microsoft.com/downloads/details.aspx?familyid=bd2a6171-e2d6-4230-b809-9a8d7548c1b6&displaylang=en)，这也可能解决您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T01:09:36.323

这有点好笑......几分钟前我刚在工作中第一次遇到这个错误。在我们的例子中，我们使用的是 C++ 应用程序，并试图在网络上的另一台计算机上运行生成的可执行文件。您需要[Visual C++ Redistributable package](http://www.microsoft.com/downloads/details.aspx?FamilyID=9b2da534-3e03-4391-8a4d-074b9f2bc1bf&displaylang=en)。

我在这里假设您使用的是 Visual Studio 2008——如果它是不同的版本，您可能需要它。或者，您可以只复制带有可执行文件的 DLL，它就会像那样运行。

让我知道这是否不适用...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T01:08:53.407

让用户验证可执行文件的哈希值是否与您发送的相同。防病毒或其他程序以试图去除恶意软件但也破坏完全无辜软件的方式破坏可执行文件并非完全不寻常。

此外，请确保他们已安装任何必需的库，例如 VC++ 可再发行包（包括通常的 msvcrt*.dll 恶作剧）。

# verilog - Verilog中$readmemh和$writememh的作用是什么？

> ID：628603
> 
> 赞同：13
> 
> 时间：2009-03-10T01:16:32.657
> 
> 标签：verilog

我一直在查看一些大量使用`$readmemh`和`$writememh`.

我有一个模糊的理解，这些函数基本上是从内存中读取和写入的。它们的具体功能是什么，它们是如何工作的？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-10T11:45:12.397

我同意要找到有关 readmem/writemem 的东西并不容易。你可以在这里找到一点： [https ://www.fullchipdesign.com/readmemh.htm](https://www.fullchipdesign.com/readmemh.htm)

反正这些函数就不多说了，语法是：

```
$readmem[hb]("File", ArrayName, StartAddr, EndAddr)
$writemem[hb]("File", ArrayName, StartAddr, EndAddr) 
```

Verilog 对文件格式非常挑剔，文本文件中的位数必须与数组中的位数相匹配。

我建议你通过定义一个数组来玩一点，用数据填充它，用 writememh/writememb 写出来，然后打印出来。

像这样的东西应该让你开始（没有尝试过！）。

```
integer i;
reg [7:0] memory [0:15]; // 8 bit memory with 16 entries

initial begin
    for (i=0; i<16; i++) begin
        memory[i] = i;
    end
    $writememb("memory_binary.txt", memory);
    $writememh("memory_hex.txt", memory);
end 
```

# c# - 占位符控件和对齐子控件

> ID：628608
> 
> 赞同：1
> 
> 时间：2009-03-10T01:19:53.537
> 
> 标签：c#, asp.net, css

我有一个程序可以显示发布到论坛的消息。现在，我在后面的代码中使用 Response.Write 方法来插入我想要的 HTML。但我宁愿避免将 HTML 放在后面的代码中（因为它不符合 .NET 的整个代码背后/设计分离功能的精神）。我想使用内容占位符，并动态插入子控件。但是，我似乎只能将它们并排插入，一个接一个。我想要一些看起来像这样的东西：

表列 1 表列 2
用户名：[UserName]      
[MessageSubject]
发表于：[PostDate]
用户评分：[UserRating]

但我似乎唯一能完成的是：

用户名：[UserName]发布于：[PostDate] 用户评分 [UserRating][MessageSubject]，没有链接或格式。

如何将段落、换行符、表单按钮和常规超链接放入内容占位符，并使它们按照我想要的方式对齐？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T01:41:02.333

您执行此操作的方式与 int .aspx 页面的方式大致相同，例如：

```
Table table = new Table();
TableRow row1 = new TableRow();
table.Rows.Add(row1);
TableCell cell1 = new TableCell();
TableCell cell2 = new TableCell();
row1.Cells.Add(cell1);
row1.Cells.Add(cell2);
Label label1 = new Label();
label1.Text = "Username:";
cell1.Controls.Add(label1);
TextBox textBox1 = new TextBox();
textBox1.ID = "userNameTextBox";
cell2.Controls.Add(textBox1);
// and so on...
myPlaceholder.Controls.Add(table); 
```

相当于：

```
<asp:Table runat="server">
  <asp:TableRow runat="server">
    <asp:TableCell runat="server">
      <asp:Label runat="server" Text="Username:" />
    </asp:TableCell>
    <asp:TableCell runat="server">
      <asp:TextBox runat="server" ID="userNameTextBox" />
    </asp:TableCell>
  </asp:TableRow>
</asp:Table> 
```

当然代码可以更聪明，这只是为了说明这一点。您可以以声明方式构建以控制布局的任何控件层次结构，您也可以以编程方式进行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T01:24:19.797

试试这个关于[Web 部件](http://msdn.microsoft.com/en-us/library/e0s9t4ck.aspx#)的概述。或者更简单地说，只需使用[用户控件](http://msdn.microsoft.com/en-us/library/y6wb1a0e.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T01:30:14.900

你可以这样做：

```
<table>
<tr><td>Table Column 1</td><td>Table Column 2</td></tr>
<tr><td>Username:</td><td>[UserName]</td></tr>
<tr><td></td><td><p>[MessageSubject]</td></tr>
<tr><td>Posted On:</td><td>[PostDate]</td></tr>
<tr><td>User Rating:</td><td>[UserRating]</td></tr>
</table> 
```

这将产生如下内容：

有些人可能会与我争论或投票否决我，但桌子并不邪恶，这就是你如何使用它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T01:33:47.263

汤姆，我已经实现了与您尝试的基本完全相同的模式。

请记住，重要的区别不是 ASPX 和代码隐藏之间的区别，而是 UI 和业务逻辑之间的区别。事实上，ASPX 页面的代码隐藏*都是*为了确保适当的 UI 行为。更糟糕的是，在这方面保持纯粹的尝试会阻止您执行您寻求的设计。最后，我确实最终在我的控件之间放置了间距 HTML - 在代码中 - 以使布局工作并且从未后悔过。

与其专注于 ASPX/代码隐藏的区别，我强烈建议您专注于将您的 UI 代码与业务逻辑分开。为此，只需将一个类库 (DLL) 项目添加到您的解决方案中，然后将对该 DLL 的引用放在您的 BIN 目录中。然后，您将让 ASPX 页面调用 DLL 以执行业务规则并从数据库中提取信息。*从最佳实践的角度来看，这*是有意义的区别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T01:45:21.150

我同意把它变成一个 UserControl 可能是正确的方法。我建议输出类似于以下内容的 html：

```
<div class="message">
    <div>
        <span class="column1">Username:</span>
        <span class="column2">[UserName]</span>
    </div>
    <div>[MessageSubject]</div>
    <div>
        <span class="column1">Posted On:</span>
        <span class="column2">[PostedOn]</span>
    </div>
    <div>
        <span class="column1">User Rating:</span>
        <span class="column2">[UserRating]</span>
    </div>
</div> 
```

然后，您可以通过 CSS 应用样式，例如：

```
<style>
    .message .column1
    {
        display: inline-block;
        width: 150px;
    }
    .message .column2
    {
        display: inline-block;
        width: 300px;
    }
</style> 
```

您会看到`<div>`标签通常是“我如何将它放在下一行？”的答案。

编辑：如果您不熟悉网络布局，您可能会喜欢早点发现[蓝图](http://www.blueprintcss.org/)，而不是晚点。

# linux - 将目录中的所有文件上移一步

> ID：628617
> 
> 赞同：10
> 
> 时间：2009-03-10T01:24:32.870
> 
> 标签：linux, bash, shell, unix, mv

我有一个看起来像这样的目录

```
fool@brat:/mydir/ucsc_mm8> tar -xvf *.tar 
1/chr1.fa.masked
1/chr1_random.fa.masked
2/chr2.fa.masked
3/chr3.fa.masked
4/chr4.fa.masked
5/chr5.fa.masked
5/chr5_random.fa.masked
19/chr19.fa.masked
Un/chrUn_random.fa.masked 
```

我想要做的是将子目录中的所有“* .masked”文件移出`/1`到`/Un`. 在 Linux/Unix 中是否有一种紧凑的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-10T01:32:54.100

移动与特定表达式匹配的所有文件的典型方法是

```
mv 1/*.masked targetDir 
```

targetDir 可能在哪里..

如果您想将其从目录 1、2、3 中移动，则可以执行类似的操作

```
mv */*.masked targetDir 
```

或者，如果你想专门从编号目录中移动它，你可以运行类似的东西

```
mv [0-9][0-9]/*.masked targetDir 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-10T01:30:50.470

```
mv */*.masked . 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-10T01:30:32.840

许多 unix shell 在路径的目录部分也支持 * 运算符。以下至少在 bash 和 zsh 中有效：

```
ls */*.masked 
```

这将返回所有以 .masked 更深的目录结尾的文件。

所以要移动它们：

```
mv */*.masked destination 
```

# sharepoint - 扩展内容查询 Web 部件

> ID：628619
> 
> 赞同：1
> 
> 时间：2009-03-10T01:28:00.757
> 
> 标签：sharepoint, moss

我希望在 SharePoint 页面上显示一些数据，该页面本质上是一个内容查询 WebPart，但有一些小的更改：

*   过滤动态日期
*   分页结果

是否可以通过扩展现有的来进行修改，或者是否有一个组件可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T23:02:41.443

我还有一个项目需要具有动态过滤功能的内容查询 Web 部件。我的解决方案是扩展现有的（ContentByQueryWebPart 类），类似于Andrew Connell 撰写的[这篇博文。](http://www.andrewconnell.com/blog/archive/2008/02/18/Subclassing-the-Content-Query-Web-Part-Adding-Dynamic-Filtering.aspx)

我的解决方案还包括一个自定义“过滤器”Web 部件，用于动态更改要在扩展内容查询 Web 部件中使用的过滤器值。这个“过滤器”Web 部件基本上是一个下拉控件，它使用 javascript 重新加载页面，并将参数添加到查询字符串中。它工作得很好。

我没有对我的自定义内容查询 Web 部件实现任何分页功能，所以我自己没有尝试过。经过一番搜索，我找到了 Waldek Mastykarz 的[这篇博文。](http://blog.mastykarz.nl/paging-content-query-web-part/)他展示了如何通过扩展 Content Query Web 部件来实现分页的示例。他还使用 queyrsting 方法来传递参数，我看不出在扩展的内容查询 Web 部件中集成分页和动态过滤有任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T03:25:18.337

尝试使用数据表单或数据视图 Web 部件。我相信它在这方面更灵活。您可能需要[构建自定义数据源](http://jamestsai.net/Blog/post/How-to-query-cross-site-lists-in-DataFormWebPart-Part-1-Build-your-own-data-source-for-DataFormWebPart.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T08:56:11.380

CodePlex 上有一个扩展内容查询 Web 部件的开源项目：

[增强的内容查询 Web 部件](http://www.codeplex.com/ECQWP)

# asp.net - 将 ValidationSummary 限制为特定按钮

> ID：628628
> 
> 赞同：1
> 
> 时间：2009-03-10T01:33:16.343
> 
> 标签：asp.net, button, validationsummary

我有一个场景，我正在使用新添加的 ValidationSummary 控件。我正在处理的表单有多个按钮（客户搜索、提交等）。是否可以仅在用户单击提交按钮而不是客户搜索按钮时触发 ValidationSummary？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T01:36:02.953

在客户搜索按钮上，添加“CausesValidation='False'”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T01:44:01.623

最好和最通用的方法是`ValidationGroup`为摘要和所有要验证的控件以及提交按钮的属性分配一个值。只有具有相同 ValidationGroup 的控件会受到影响。

使用验证组，您可以验证页面的不同部分，而不会相互影响。此功能是在 ASP.NET 2.0 中应大众需求引入的。

# sql - SQL Server Management Studio 中的脚本大小限制

> ID：628635
> 
> 赞同：3
> 
> 时间：2009-03-10T01:35:43.203
> 
> 标签：sql, sql-server, ssms

例如：多少行

插入 foo ( '1','2' )

可以在一个文件中。我记得它大约是 100k，但到目前为止，用谷歌搜索已被证明是徒劳的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T02:51:12.820

根据[这篇关于如何指定禁用 IntelliSense 功能的脚本大小的文章](http://msdn.microsoft.com/en-us/library/bb964729.aspx)，至少在 SQL Server 2008 中允许超过 2MB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T01:52:32.303

我不确定是否有硬限制，我最大的文件由 Database Publisher 生成大约 270K 并且运行良好。

# mysql - 在 MySQL 数据库中存储货币值的最佳数据类型

> ID：628637
> 
> 赞同：221
> 
> 时间：2009-03-10T01:36:22.530
> 
> 标签：mysql, sql, sqldatatypes

货币值的最佳 SQL 数据类型是什么？我正在使用 MySQL，但更喜欢独立于数据库的类型。

* * *

## 回答 #1

> 赞同：238
> 
> 时间：2009-03-10T01:38:56.953

在大多数情况下，类似的东西`Decimal(19,4)`通常效果很好。您可以调整比例和精度以适应您需要存储的数字的需要。即使在 SQL Server 中，我也倾向于不使用“ `money`”，因为它是非标准的。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-03-10T02:06:30.553

您唯一需要注意的是，如果您从一个数据库迁移到另一个数据库，您可能会发现 DECIMAL(19,4) 和 DECIMAL(19,4) 的含义不同

（[http://dev.mysql.com/doc/refman/5.1/en/precision-math-decimal-changes.html](https://web.archive.org/web/20090313093848/http://dev.mysql.com/doc/refman/5.1/en/precision-math-decimal-changes.html)）

```
    DBASE：10,5（10 个整数，5 个十进制）
    MYSQL：15,5（15位，10位整数（15-5），5位小数）

```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-03-10T02:34:09.380

计算出您的计算可能需要多少个小数位也很重要。

我在一个股价应用程序上工作，该应用程序需要计算一百万股的价格。报价的股价必须存储到 7 位的准确性。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-03-10T01:45:04.710

阿萨夫的回应

> 那要看你有多少钱了...

听起来很轻率，但实际上它是相关的。

仅在今天，我们遇到了一个问题，即未能将记录插入到我们的费率表中，因为其中一列 (GrossRate) 设置为十进制 (11,4)，而我们的产品部门刚刚获得了一些令人惊叹的度假村的房间合同在波拉波拉岛，每晚售价数百万太平洋法郎……这是 10 年前设计数据库模式时从未预料到的。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-08-24T04:52:15.013

对于会计应用程序，将值存储为整数是很常见的（有些人甚至说这是*唯一*的方法）。为了得到一个想法，将交易金额（假设为 100.23 美元）乘以 100、1000、10000 等，以获得所需的准确性。因此，如果您只需要存储美分并且可以安全地向上或向下舍入，只需乘以 100。在我的示例中，这将使 10023 作为要存储的整数。您将节省数据库中的空间，并且比较两个整数比比较两个浮点数要容易得多*。*我的 0.02 美元。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-09-11T00:46:17.173

超级迟到，但公认会计原则是一个很好的经验法则..

> 如果您的应用程序需要处理高达一万亿的货币价值，那么这应该可以：13,2 如果您需要遵守 GAAP（公认会计原则），请使用：13,4
> 
> 通常，在将输出四舍五入为 13.2 之前，您应该将您的货币价值加总为 13.4。

资料来源：[在 MySQL 中存储货币价值的最佳数据类型](https://stackoverflow.com/a/23353037)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-04-01T04:43:48.513

这取决于数据的性质。你需要事先考虑清楚。

# 我的情况

*   用于记录货币交易的小数（13,4）无符号
    *   存储效率（小数点每侧 4 个字节）[1](https://dev.mysql.com/doc/refman/5.7/en/precision-math-decimal-characteristics.html)
    *   符合公认会计原则
*   十进制（19,4）无符号聚合
    *   我们需要更多空间来处理数十亿笔交易
    *   半遵从 MS Currency 数据类型不会受到伤害[2](https://msdn.microsoft.com/en-us/library/office/gg264338.aspx)
    *   每条记录将占用更多空间（11 字节 - 7 左和 4 右），但这很好，因为聚合[1的记录较少](https://dev.mysql.com/doc/refman/5.7/en/precision-math-decimal-characteristics.html)
*   十进制（10,5）汇率
    *   它们通常用 5 位数字引用，因此您可以找到像 1.2345 & 12.345 但不是 12345.67890 这样的值
    *   这是普遍的惯例，但不是编纂的标准（至少根据我的快速搜索知识）
    *   您可以使用相同的存储将其设为十进制 (18,9)，但数据类型限制是有价值的内置验证机制

# 为什么是（M，4）？

*   有一种货币可以分裂成一千便士
*   有像“Unidad de Fermento”、“CLF”这样的货币等价物，用 4 个有效小数位表示[3](http://corrugatedcity.blogspot.ie/2007/08/inflation-and-mysterious-uf.html) , [4](http://si3.bcentral.cl/Indicadoressiete/secure/Indicadoresdiarios.aspx)
*   它符合公认会计原则

# 权衡

*   较低的精度：
    *   存储成本更低
    *   更快的计算
    *   降低计算错误风险
    *   更快的备份和恢复
*   更高的精度：
    *   未来的兼容性（数字趋于增长）
    *   节省开发时间（当达到限制时，您不必重建半个系统）
    *   由于存储精度不足而降低生产失败的风险

# 兼容极限

虽然 MySQL 允许您使用小数（65,30），但如果我们想让传输选项保持打开状态，31 表示比例和 30 表示精度似乎是我们的限制。

最常见 RDBMS 中的最大比例和精度：

```
            精密秤
甲骨文 31 31
T-SQL 38 38
MySQL 65 30
PostgreSQL 131072 16383

```

[6、7、8、9](http://docs.oracle.com/javadb/10.6.2.1/ref/rrefsqlj15260.html) _ [_](https://docs.microsoft.com/en-us/sql/t-sql/data-types/decimal-and-numeric-transact-sql) _ [_](https://dev.mysql.com/doc/refman/5.7/en/precision-math-decimal-characteristics.html) _ [_](https://www.postgresql.org/docs/9.1/static/datatype-numeric.html#DATATYPE-NUMERIC-TABLE)

# 合理的极端

2.  为什么是 (27,4)？
    *   你永远不知道系统何时需要存储津巴布韦元

> 2015 年 9 月 津巴布韦政府表示将以 1 美元兑 35 万亿津巴布韦元的汇率将津巴布韦元兑换成美元[5](https://en.wikipedia.org/wiki/Zimbabwean_dollar#Abandonment_and_demonetisation)

我们倾向于说“是的，当然……我不需要那些疯狂的数字”。嗯，津巴布韦人过去也这么说。不久前。

假设您需要以津巴布韦元记录 100 万美元的交易（今天可能不太可能，但谁知道这在 10 年后会是什么样子？）。

> 1.  (100 万美元) * (35 Quadrylion ZWL) = ( 10^6 ) * (35 * 10^15) = 35 * 10^21
> 2.  我们需要：
>     *   2位数字存储“35”
>     *   21位存储零
>     *   小数点右边4位
> 3.  这使得 decimal(27,4) 每个条目花费我们 15 个字节
> 4.  我们可以免费在左边添加一位数字 - 我们有 15 个字节的小数（28,4）
> 5.  现在我们可以存储以津巴布韦元表示的 1000 万美元交易，或者避免再次出现过度通胀，希望这种情况不会发生

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-03-08T00:00:16.810

您可以`DECIMAL(19,2)`对所有货币值使用默认值，但如果您只存储低于 1,000 美元的值，那只会浪费宝贵的数据库空间。

对于大多数实现，`DECIMAL(N,2)`就足够了，其中的值`N`至少是`.`您期望存储在该字段中的最大总和之前的位数`+ 5`。因此，如果您不希望存储任何大于 999999.99 的值，`DECIMAL(11,2)`则应该绰绰有余（直到期望发生变化）。

如果您想符合[**GAAP**](http://www.fasab.gov/accounting-standards/authoritative-source-of-gaap/)，您可以选择`DECIMAL(N,4)`，其中 的值`N`至少是`.`您期望存储在该字段中的最大总和之前的位数`+ 7`。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-10-05T07:43:26.827

虽然这可能会迟到，但对其他人会有所帮助。根据我的经验和研究，我已经了解并接受小数（19、6）。那是在使用 php 和 mysql 时。处理大量资金和汇率时

# sql - tsql：我如何加入这个表？

> ID：628640
> 
> 赞同：0
> 
> 时间：2009-03-10T01:39:57.327
> 
> 标签：sql, tsql, join

我有以下 sql 语句：

```
SELECT TOP (100) PERCENT inv.CompanyID, 
                         cust.CustID AS ClientID, 
                         cust.CustName AS CustomerName, 
                         inv.InvcKey, inv.PrimarySperKey AS SperKey, 
                         inv.TranID AS InvoiceNumber, 
                         inv.TranDate AS PostDate, 
                         sper.SperName AS SalesPersonName, 
                         inv.SalesAmt AS InvoiceSubAmount, 
                         inv.TranAmt AS InvoiceTotal, 
                         detl.ItemKey, 
                         detl.InvoiceLineKey AS dtInvoiceLineKey, 
                         detl.Description, 
                         detl.UnitCost AS calcUnitCost, 
                         detl.UnitPrice, 
                         detl.ExtAmt, 
                         (detl.UnitPrice - detl.UnitCost) * dist.QtyShipped - detl.TradeDiscAmt AS detLineGrossProfit, 
                         dbo.tPA00175.chrJobNumber AS ARJobNumber, 
                         dist.QtyShipped, 
                         dbo.timItem.ItemID AS ARItemID, 
                         dbo.timItemClass.ItemClassID AS ARItemClass,         
                         dist.TradeDiscAmt,                       
                         dbo._v_GP_SalesTerr.SalesTerritoryID

FROM         
                      dbo.tarInvoiceDetl AS detl RIGHT OUTER JOIN
                      dbo.timItem INNER JOIN
                      dbo.timItemClass ON dbo.timItem.ItemClassKey = dbo.timItemClass.ItemClassKey ON detl.ItemKey = dbo.timItem.ItemKey RIGHT OUTER JOIN
                      dbo._v_GP_SalesTerr RIGHT OUTER JOIN
                      dbo.tarInvoice AS inv INNER JOIN
                      dbo.tarCustomer AS cust ON inv.CustKey = cust.CustKey ON dbo._v_GP_SalesTerr.CustKey = cust.CustKey ON 
                      detl.InvcKey = inv.InvcKey LEFT OUTER JOIN
                      dbo.tPA00175 INNER JOIN
                      dbo.paarInvcHdr ON dbo.tPA00175.intJobKey = dbo.paarInvcHdr.intJobKey ON inv.InvcKey = dbo.paarInvcHdr.InvcKey LEFT OUTER JOIN
                      dbo.tarInvoiceLineDist AS dist ON detl.InvoiceLineKey = dist.InvoiceLineKey LEFT OUTER JOIN
                      dbo.tarSalesperson AS sper ON inv.PrimarySperKey = sper.SperKey 
```

如果我想添加一个名为 Inventory.LastUnitCost 的字段，其中 Inventory 有一个名为 itemkey 的代理键，用于表“tiitem”，我将如何将它添加到它只会通过 itemkey 查找 LastUnitCost 字段的地方？如果没有与 timeitem 表对应的 LastUnitCost，则它将为 null..

每次我尝试将其添加到 Inventory.itemkey = timItem.itemkey 上的 timItem 的 Inner Join 中时，它都会影响 timItemClass.ItemClassID 字段，其中一些类别不再显示。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T01:52:27.063

添加`Inventory.LastUnitCost`到`SELECT`列表中

并将这一行添加到查询的末尾：

```
dbo.Inventory LEFT OUTER JOIN dbo.timItem ON dbo.timItem.itemkey = dbo.Inventory.itemkey 
```

# .net - WPF：在加载所有绑定属性之前显示 UserControl

> ID：628646
> 
> 赞同：0
> 
> 时间：2009-03-10T01:43:58.097
> 
> 标签：.net, wpf, data-binding, xaml

我有一个 UserControl，它有一个 ListView 显示客户端对象的列表。双击其中一行会播放动画并转换到另一个 UserControl，该 UserControl 显示该客户端的帐户列表。

第二个用户控件绑定到 Client 对象的 Accounts 属性。首次访问该属性时会加载帐户列表。如果帐户列表很小，这一切都很好。如果帐户列表很大，则在双击和显示帐户列表之间会有非常明显的延迟。而且动画根本不播放。

我了解这里发生了什么，但我不确定修复它的最佳方法。如何使动画仍然播放并显示第二个用户控件，但帐户列表在加载时出现？我知道我将需要异步加载列表视图，并且为此使用 BackgroundWorker 没有问题，但我不确定这种加载会发生在哪里。

帐户列表是一个 ObservableCollection，并且客户端对象实现了 INotifyPropertyChanged，但是没有为帐户属性调用 PropertyChanged，因为它没有设置器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T02:27:30.550

I think you need to look at the Virtualized controls in WPF - these only display the contents required not the whole list and are therefore a lot faster than the standard ListView.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T07:44:36.280

您可以尝试在绑定上设置 IsAsync=true，例如：{Binding Path=Accouns, IsAsync=true}

# python - python中使用双引号和引号的区别

> ID：628657
> 
> 赞同：18
> 
> 时间：2009-03-10T01:52:30.010
> 
> 标签：python

在 Python 中使用双引号和单引号之间有什么区别吗？

```
"A string with double quotes"
'A string with single quotes' 
```

他们是一样的吗？python 解释这些字符串的方式有区别吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-10T02:47:09.833

简短的回答：除了风格上几乎没有区别。
简短的简介：如果您不想转义字符串中的引号字符，请使用其他类型。例如：

```
string1 = "He turned to me and said, \"Hello there\"" 
```

会比说的更难看

```
string2 = 'He turned to me and said, "Hello there"' 
```

这同样适用于单引号/撇号。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-10T01:54:25.933

Not generally, you just have to be consistent within a given statement. E.g., don't do "foo'

For further reading, see [here](http://docs.python.org/reference/lexical_analysis.html#string-literals).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T01:57:38.657

Double quotes look distinctive. Single quotes look like single ticks. Apart from that ...

# android - 如何在我的 Android 应用中妥善管理音量？

> ID：628659
> 
> 赞同：35
> 
> 时间：2009-03-10T01:54:07.590
> 
> 标签：android

我有一个应用程序在其活动打开时播放间歇性声音，用户总是希望它发出这些声音，但不幸的是它受到音乐流音量的限制。因此，我发现的选项是：

1.  调整音乐流的音量，如果他们当时正在播放音乐，可能会使用户耳聋。
2.  如果音乐流的音量为 0，则调用 MediaPlayer.setVolume() 无效。
3.  处理音量按钮按下我自己，这会带来两个问题：按下音量按钮会调整铃声音量，除非我的音频正在播放，而且我还无法使用我的 OnKeyListener 捕捉音量按钮按下的 onKey 事件。如果有某种方法可以在我的活动集中时强制将调整应用于音乐流，或者只是自己抓住按钮按下，这将起作用。
4.  在后台播放一段无声的循环音频，以使音乐流保持在上下文中以进行音量调整。

我认为第三个选项可能是最好的，因为它将音量控制权交给了用户，但是如果有某种方法可以在单个媒体播放器实例中覆盖系统音量，那也可以。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-03-23T16:53:58.283

通过 Google Groups 获得了另一个建议，这是我一直在寻找的平台集成解决方案，并且运行良好：

> 请不要自己处理音量键 - 几乎不可能保证您不会破坏音量键的行为。
> 
> 在你的 onCreate() 中调用这个 API：
> 
> setVolumeControlStream(AudioManager.STREAM_MUSIC);
> 
> 这告诉 AudioManager 当你的应用程序有焦点时，音量键应该调整音乐音量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-13T05:55:22.867

这个 API 很有用： setVolumeControlStream(AudioManager.STREAM_MUSIC);

除非这个我会花更多的时间来修复那个音量错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-25T10:08:56.240

如果您使用的是“OnKeyDown”方法，则可以通过执行以下操作来解决此问题：

```
public boolean onKeyDown(int keyCode, KeyEvent event) {    
if (keyCode == KeyEvent.KEYCODE_VOLUME_UP || keyCode == KeyEvent.KEYCODE_VOLUME_DOWN) {
                setVolumeControlStream(AudioManager.STREAM_MUSIC);}} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-07T12:45:17.220

如果您覆盖了活动的 onKeyDown(int keycode,KeyEvent event) 方法，这将无济于事。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-20T10:06:14.273

```
 var audioManager:AudioManager?=null
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        registerReceiver(mVolumeReceiver, IntentFilter("android.media.VOLUME_CHANGED_ACTION"))
        audioManager = getSystemService(Context.AUDIO_SERVICE) as AudioManager
    }

    private var mVolumeReceiver: BroadcastReceiver = object : BroadcastReceiver() {
        override fun onReceive(context: Context, intent: Intent) {

            if (intent.action == "android.media.VOLUME_CHANGED_ACTION") {
                var currentVolume = audioManager?.getStreamVolume(AudioManager.STREAM_MUSIC)
            }
        }
    } 
```

# linux - 列出具有文件计数的文件夹的 UNIX 命令

> ID：628662
> 
> 赞同：18
> 
> 时间：2009-03-10T01:56:44.540
> 
> 标签：linux, bash, unix, shell, command

我想获取当前级别的文件夹列表（不包括它们的子文件夹），并简单地打印文件夹名称和文件夹中文件的数量（如果可能，最好过滤到 *.jpg）。

这在标准 bash shell 中可行吗？`ls -l`打印除文件数以外的所有内容:)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-10T02:09:51.547

我想出了这个：

```
find -maxdepth 1 -type d | while read dir; do 
    count=$(find "$dir" -maxdepth 1 -iname \*.jpg | wc -l)
    echo "$dir ; $count"
done 
```

`-maxdepth 1`如果在考虑子目录的情况下在目录中搜索 jpg 文件应该是递归的，则删除第二个。请注意，这仅考虑文件的名称。您可以重命名文件，隐藏它是 jpg 图片。您可以使用该`file`命令来猜测内容，而不是（现在，也递归搜索）：

```
find -mindepth 1 -maxdepth 1 -type d | while read dir; do 
    count=$(find "$dir" -type f | xargs file -b --mime-type | 
            grep 'image/jpeg' | wc -l)
    echo "$dir ; $count"
done 
```

但是，这要慢得多，因为它必须读取部分文件并最终解释它们包含的内容（如果幸运的话，它会在文件的开头找到一个神奇的 id）。`-mindepth 1`阻止它打印`.`（当前目录）作为它搜索的另一个目录。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-08-28T07:18:25.023

在我已经找到了自己的类似脚本之后，我发现了这个问题。它似乎适合您的条件并且非常灵活，因此我想将其添加为答案。

**好处：**

*   可以分组到**任何深度**（0 表示`.`，1 表示第一级子目录等）
*   打印漂亮的输出
*   没有循环，只有一个`find`命令，所以在大目录上更快一点
*   仍然可以调整以添加自定义过滤器（maxdepth 使其非递归，文件名模式）

**原始代码：**

```
 find -P . -type f | rev | cut -d/ -f2- | rev | \
      cut -d/ -f1-2 | cut -d/ -f2- | sort | uniq -c 
```

包装成一个函数并解释：

```
fc() {
  # Usage: fc [depth >= 0, default 1]
  # 1\. List all files, not following symlinks.
  #      (Add filters like -maxdepth 1 or -iname='*.jpg' here.)
  # 2\. Cut off filenames in bulk. Reverse and chop to the
  #      first / (remove filename). Reverse back.
  # 3\. Cut everything after the specified depth, so that each line
  #      contains only the relevant directory path
  # 4\. Cut off the preceeding '.' unless that's all there is.
  # 5\. Sort and group to unique lines with count.

  find -P . -type f \
      | rev | cut -d/ -f2- | rev \
      | cut -d/ -f1-$((${1:-1}+1)) \
      | cut -d/ -f2- \
      | sort | uniq -c
} 
```

产生如下输出：

```
$ fc 0
1668 .

$ fc # depth of 1 is default
   6 .
   3 .ssh
  11 Desktop
  44 Downloads
1054 Music
 550 Pictures 
```

当然，首先它可以通过管道传输到`sort`：

```
$ fc | sort
   3 .ssh
   6 .
  11 Desktop
  44 Downloads
 550 Pictures
1054 Music 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-10T02:25:36.703

我的从命令行输入更快。:)

其他建议是否比以下建议提供任何真正的优势？

```
find -name '*.jpg' | wc -l               # recursive

find -maxdepth 1 -name '*.jpg' | wc -l   # current directory only 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T02:10:40.873

```
#!/bin/bash
for dir in `find . -type d | grep -v "\.$"`; do
echo $dir
ls $dir/*.jpg | wc -l
done; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T10:33:55.920

您可以在没有外部命令的情况下执行此操作：

```
for d in */; do 
  set -- "$d"*.jpg
  printf "%s: %d\n" "${d%/}" "$#"
done 
```

或者您可以使用*awk*（在*Solaris上是**nawk*或*/usr/xpg4/bin/awk*）：

 *```
printf "%s\n" */*jpg |
  awk -F\/ 'END { 
    for (d in _) 
      print d ":",_[d] 
      }
  { _[$1]++ }' 
```

# php - How do you resolve a hidden javascript link with php?

> ID：628664
> 
> 赞同：1
> 
> 时间：2009-03-10T01:59:27.700
> 
> 标签：php, javascript, hyperlink, hidden, fopen

I'm trying to parse a bunch of webpages one after the next with PHP, but I noticed that when I fopen the first page, the links to the following pages are hidden in javascript.

Is there anyway I can continue on to parse the next webpages? If the url had a variable like "page=2" encrypted into it I would go through them that way, but the urls are encrypted.

-LPG

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T23:49:51.297

基本上你有两个选择：

1.  模仿他们的逻辑
2.  模拟一个有效的客户

如果你想使用#1，你必须阅读他们的 Javascript 代码并弄清楚它是如何工作的。我真的无法比这更好地解释它，因为它在很大程度上取决于他们的代码。您只需要了解 Javascript 并“了解”他们的代码。然后，让您的代码执行相同的逻辑来生成“下一页”URL。

如果他们的系统使用 AJAX，您仍然可以模拟它（与 click-upvote 所说的相反）。为此，您只需使用像 Firebug Firefox 扩展这样的工具，这样您就可以“在幕后”观察浏览器向其服务器发送的内容。然后，让您的代码发送一个模仿其 AJAX 请求的虚假 HTTP 请求。即使没有像 Firebug 这样的工具，您实际上也可以做到这一点：只需通过查看 Javascript 代码来推断您的浏览器将发送什么。然而，如果你使用像 Firebug 这样的东西，它会让事情变得更容易（而不是推断，你可以看到正在发送的内容）。

如果您想改用#1，则需要使用实际的浏览器（并使用 Selenium 之类的东西以编程方式控制它），或者使用 Rhino 之类的东西来运行 Javascript。使用带有 Selenium 等控制系统的实际浏览器可能是最简单的方法。但是，它会很慢，因为它受到浏览器渲染页面等时间的限制。使用 Rhino 或类似的解决方案会更快，但也会涉及更多工作（您必须解析 HTML，包括所有相关的 JS 文件等），所以我建议仅作为最后一招。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T02:04:09.267

The only way would be to write a regular expression which parses out the javascript links and follows them. This would probably only work if the url to the page was in the javascript code, e.g:

```
<a href="javascript:open('something/some_page.html');">Something</a> 
```

instead of just

```
<a href="javascript:open(someField.value);">Something</a> 
```

Because with the second example, you would actually have to process the javascript link using PHP, which can be very challenging.

Keep in mind also that you would have to create website-specific regular expressions because each site formats their URLs differently. So [Cnn.com](http://cnn.com) might format their urls differently than [Reddit.com](http://www.reddit.com)

# mysql - MySQL database modeling problem from a newbie

> ID：628665
> 
> 赞同：0
> 
> 时间：2009-03-10T01:59:45.487
> 
> 标签：mysql, database, modeling

Ok, I have a problem that i've searched and searched for solutions to online and can't find any leads, here it is (oh, and i'm very new to this database stuff ;-)

Lets say I have thousands of retail stores and each one can carry 1 to 100 products, but there are 10,000 possible products available. I need each store owner to be able to see (and edit) the list of products in their store - this is straightforward and I can figure out the table structure for this - but what I also want to do is to be able to find the most common product combinations across stores, so for example I want to see something like:

```
120: pid34, pid234, pid876, pid120, pid100
118: pid45, pid54, pid657, pid763, pid237
115: pid23, pid546, pid657, pid543, pid23

```

Where the first number is the number of stores with those products (order of the products within the store doesn't matter), and the pid numbers are the product ids of the products (except remember there could be up to 100 products in each store).

So if I set up a table of:

```
ID, PID,    Store ID
1,  pid34,  10
2,  pid234, 10
3,  pid876, 10
4,  pid120, 10
5,  pid100, 10
6,  pid45,  45
... etc ...

```

I can keep track of my store inventories, but i've no idea how I can do my 'combinations' search, help!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T03:04:12.913

您应该能够使用数据库查询来解决这个问题的大部分，但是您仍然需要围绕此查询包装的另一种编程语言（例如 java 和 JDBC）。假设您使用的是某种 SQL 数据库。从您的结构来看，我认为您将需要使用 group by 子句。虽然我不知道你的数据库结构，因为你没有提到它，所以为了这个，我打算说你的表被称为“产品”

我们首先设计一个查询来获取每个产品的数量：

```
SELECT pid, COUNT(*) AS NUM FROM products p GROUP BY pid ORDER BY NUM DESC; 
```

所以这个查询将返回如下内容：

```
pid,    NUM
pid34   120
pid29   120
pid20   20 
```

所以，这越来越接近了，但仍然不是我们想要的。但是，现在通过将查询与编程语言结合使用，事情可以轻松完成。我在下面做了一些java代码作为例子。

```
// Assumes that database connection has already been made and is in the variable: conn1
Statement stmt1 = conn1.createStatement();
ResultSet rs1 = stmt1.executeQuery("SELECT pid, COUNT(*) AS NUM FROM products p GROUP BY pid ORDER BY NUM DESC");

int prevNum = -1;
while(rs1.next())
{
    int thisNum = rs1.getInt("NUM");
    if(thisNum != prevNum)
    {
        // this means it is a different number than the last result, start a new line
        system.out.print("\n" + thisNum + ": ");
        prevNum = thisNum;
    }
    system.out.print(rs1.getString("pid") + ", ");
}
stmt1.close();
conn1.close(); 
```

虽然我可能没有正确的逻辑，尤其是在格式化方面，但这应该能让你走上正确的道路，了解你需要如何去做。确实，这个问题需要结合使用查询和编程语言来解决。

查询可以解决一小部分问题，但是它们在解决这些问题方面做得非常好，而编程语言可以解决更广泛的问题。但是，在许多情况下，编程语言在解决相同问题方面的效率不如数据库，这就是为什么将两者多次结合可以更高效地解决复杂问题的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T02:03:57.300

This is categorically not a database problem. This is a problem which something like Prolog or ECLiPSe would be great for, or perhaps a constraint solver within some other language.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T02:32:11.290

```
var1 = Select the unique store numbers

foreach var1
  select the products that apply to that store number.
/foreach

```

Justice is right though, this is not neccessarilly a database problem, but rather a more general programming problem.

# c# - 如何从类中获取私有静态字段的值？

> ID：628666
> 
> 赞同：36
> 
> 时间：2009-03-10T02:00:08.527
> 
> 标签：c#, reflection

有没有办法使用反射从已知类中获取私有静态字段的值？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-03-10T02:10:08.160

是的。

```
Type type = typeof(TheClass);
FieldInfo info = type.GetField(name, BindingFlags.NonPublic | BindingFlags.Static);
object value = info.GetValue(null); 
```

这是一个领域。对于属性，更改`type.GetField`为`type.GetProperty`。您还可以以类似的方式访问私有方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-10T02:46:25.653

我想有人应该问这是否是个好主意？它创建了对这个静态类的私有实现的依赖。私有实现如有更改，恕不另行通知使用反射访问私有实现的人。

如果这两个类要一起工作，请考虑将字段设为*内部*并将协作类的程序集添加到 [assembly:InternalsVisibleTo] 属性中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T02:14:55.200

如上所述，您可能可以使用[`System.Type::GetMembers()`](http://msdn.microsoft.com/en-us/library/k2w5ey1e(VS.80).aspx#)with ，但前提是您拥有正确的.[`BindingFlags`](http://msdn.microsoft.com/en-us/library/system.reflection.bindingflags(VS.80).aspx)`::NonPublic | BindingFlags::Static`[`ReflectionPermission`](http://msdn.microsoft.com/en-us/library/system.security.permissions.reflectionpermission(VS.80).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T02:16:41.217

如果您完全信任，您应该能够：

```
Type t = typeof(TheClass);
FieldInfo field = t.GetField("myFieldName", BindingFlags.NonPublic | BindingFlags.Static);
object fieldValue = field.GetValue(myObject); 
```

但是，如果您在没有完全信任的系统上运行它，则 GetField 调用将失败，这将不起作用。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-10T02:11:56.657

尝试这样的事情：

```
Type type = typeof(MyClass);
MemberInfo[] members = type.GetMembers(BindingFlags.NonPublic | BindingFlags.Static); 
```

我认为这应该可行。

# ruby-on-rails - Rails Web 服务 SOAP 客户端

> ID：628667
> 
> 赞同：0
> 
> 时间：2009-03-10T02:00:41.257
> 
> 标签：ruby-on-rails, web-services

尝试通过肥皂访问 Web 服务时出现错误

```
soap_client = SOAP::WSDLDriverFactory.new("http://api.upsidewireless.com/soap/Authentication.asmx?WSDL")
driver = soap_client.createDriver
@p = driver.GetParameters(:username => 'uname', :password => 'pword') #ERROR => wrong number of arguments (1 for 2) 
```

我可以清楚地看到这个方法调用的两个参数。为什么我会收到此错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T20:38:56.573

@james 有正确的答案，但只是为了将来参考（因为这曾经咬过我），这个电话：

```
driver.GetParameters(:username => 'uname', :password => 'pword') 
```

正在传递一个参数：哈希。你的每一个元素都不是一回事。它是一个带有键和值的散列元素。Ruby 注意到这一点并将它们全部放入一个哈希中。所以你有效地传递了这个：

```
driver.GetParameters({:username => 'uname', :password => 'pword'}) 
```

这是在 Ruby 中调用方法时令人困惑的事情之一。如果您将哈希作为最后（或唯一）参数传递，则可以省略`{}`，大多数人都这样做。有时很难弄清楚。

如果您真的想将其作为两个参数传递：

```
driver.GetParameters('uname', 'pword') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T02:21:43.327

不推荐使用 WSDLDriver（从 createDriver 调用）。您应该使用“create_rpc_driver”。我从您的示例中得到了该方法的回复。有什么理由不使用 'create_rpc_driver' 吗？

# c# - 使用 APIRequest 和 Response 进行类设计

> ID：628668
> 
> 赞同：0
> 
> 时间：2009-03-10T02:00:50.973
> 
> 标签：c#, architecture

我设计了一个为 POST 创建 XML 的类，以便调用第三方 API 的 API。该类具有辅助方法；一个形成 HttpWebRequest，然后一个发送它。我的问题是这样的：

响应（最终我将推入 XMLReader 并解析它以获取值）是否应该作为 HttpWebResponse、XMLReader 或什么返回？并且该响应应该由我拥有的 Send HttpWebRequest 方法返回还是简单地设置为正在发送的 APIRequest.cs 类中的一个属性？或者我应该将该 HttpWebResponse 或 XMLReader （如果我决定先将该响应推入阅读器）传递给一个完全不同的名为 APIMethodResponse 的类，该类保存响应中返回的值？

我正在考虑 SOLID 和这里的基本类设计。在处理从我的 APIRequest.cs 类发出的 API 方法调用/请求返回的响应方面，我不确定该采用哪种方式。

注意：APIRequest.cs 类实际上更具体，例如 UpdateCustomerRequest.cs，因为我正在调用 API 方法 UpdateCustomer。因此，我为 POST 创建的 XML 是通过一种方法创建的，该方法创建必要的节点和数据以作为 UdpateCustomer 方法调用的 POST 发送

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T02:12:54.800

您不应返回 HttpWebResponse。这是您的 API 调用框架内部的，与调用者无关。

我要么保持基本并返回原始 XML（然后可以根据调用者的要求以多种方式对其进行解析），要么我会一直进行解析并返回内部的返回值/输出参数。

请记住，调用者希望尽可能接近地调用 API 方法并获取返回值，而无需处理所涉及的接线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T02:42:46.460

返回一个 XmlReader。您可以使用 XmlReader 执行任何操作 - 加载到 XmlDocument 中，用作 XslCompiledTransform 的输入等。它是 XML API 的最小公分母。

顺便说一句，您是否曾经创建过 HttpWebRequest 但没有发送它？

# wpf - 从 Visual Studio 帮助中删除 Silverlight 文档

> ID：628674
> 
> 赞同：2
> 
> 时间：2009-03-10T02:05:15.160
> 
> 标签：wpf, silverlight, visual-studio-2008

在VS2008中开发WPF应用程序时，如何过滤掉Silverlight文档？当我按 F1 时获得 Silverlight 版本的类的帮助非常烦人。

我不想完全删除 Silverlight 的文档，因为我将来会需要它，但是在 WPF 和 Silverlight 帮助之间进行选择的某种方式会很棒。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T22:50:40.110

我上周[写了这篇博客。](http://idunno.org/archive/2009/03/16/workaround-visual-studio-contextual-help-brings-up-silverlight-help.aspx)它确实“删除”了 silverlight 文档，或者更确切地说，将它们从索引中隐藏起来，直到您决定重新添加它们的那一天。

> 为了解决这个问题，请右键单击 VS2008 图标并以管理员身份运行。从帮助菜单中选择索引选项。在搜索框中输入“collection manager”——然后单击索引列表中的“帮助”选项。取消选中“Microsoft Silverlight 2 SDK 文档”集合，然后单击更新 VSCC。关闭文档资源管理器和 Visual Studio。您必须从 Visual Studio 中的 Help/Index 打开 Document Explorer，直接启动 MSDN 是不够的。
> 
> 现在尝试在 .NET 和 Silverlight 中存在的那些讨厌的主题之一上按 F1（我在 Dictionary 类上使用了 Add 方法）并等待 Document Explorer 自行更新，这个漫长而缓慢的可怕过程。完成后，您应该会发现默认情况下会返回看到 .NET 帮助，而不是 Silverlight 帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T22:28:14.080

坦率地说，我发现 Visual Studio 中 F1 帮助的“上下文敏感性”值得怀疑。我通常使用帮助索引。这使您可以按广泛的主题进行过滤。

我不使用 .NET 3.5，目前只使用 VS2005，所以我不确定安装 WPF、Silverlight 等时索引的“过滤依据”列表究竟包含什么，但我认为在这种情况下我会尝试“Windows 窗体开发”过滤器。

或者，您可以使用搜索。您仍然可能有误点击，但您可以从列表中选择主题，并且主题标题通常可以让您对上下文有所了解。

希望能帮助到你，

Nathan D. Southerland，MCSD.NET

PS - 我唯一能找到的关于自定义帮助的内容是在[这篇文章中](http://msdn.microsoft.com/en-us/library/25e3x9a7.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T23:43:47.737

为了完整起见，[Silverlight SDK 博客上](http://blogs.msdn.com/silverlight_sdk/archive/2008/11/22/silverlight-toolkit-and-f1-help.aspx)也有方法详细信息。不幸的是，它确实会改变帮助的工作方式，因此如果您不喜欢在线模式，它可能不适合您。

> 解决方法是调整 Visual Studio 的工具|选项|环境|帮助|在线对话框中的设置。有两种情况：
> 
> *   在工具|选项对话框中，设置您的首选项以使用本地帮助。在这种情况下，在 .NET/Silverlight 共享成员上按 F1 始终会转到 Silverlight 版本，无论您是为 .NET 还是 Silverlight 开发。
> *   在工具|选项对话框中，设置您的首选项以使用在线帮助。在这种情况下，在 .NET/Silverlight 共享成员上按 F1 始终会转到 .NET 在线版本，无论您是为 .NET 还是 Silverlight 进行开发。

# nhibernate - Nhibernate - query with join table without relationship

> ID：628677
> 
> 赞同：3
> 
> 时间：2009-03-10T02:06:23.317
> 
> 标签：nhibernate, join, nhibernate-mapping

I was wondering if anyone has tried to do this in NHibernate.

I have the following tables (simpify version).

CITY: city (varchar2) (PK) province (varchar2) (PK)

CITY_TL: city (varchar2) (PK) province (varchar2) (PK) lang (char (2)) (PK)

LOCATION: location (varchar2) (PK) some other column.

As you can see, there are no relationship between CITY and LOCATION. However, it was set up in a way that CITY.Province can equal to LOCATION.Location. So, I can execute a query like this:

select c.* from city c join city_tl ctl on c.city = ctl.city join location l on l.location = c.province

How do I do that in NHibernate? Is this even doable?

Here is my mapping files for CITY and LOCATION

CITY:

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="NHDAL"
                   namespace="NHDAL.Domain">

  <class name="CityTL" table="CITY_TL">
    <composite-id>
      <key-property column="CITY" type="String" name="Name"/>
      <key-property column="PROVINCE" type="String" name="Province"/>
      <key-property column="LANG" type="String" name="Lang" />
    </composite-id>

    <timestamp
        column="MODIFY_DATE"
        name="ModifyDate"
        access="property"
        unsaved-value="null"/>

    <property name="ProvinceDescription" column="PROVINCE_TL"
type="String" not-null="true" />
    <property name="Description" column="CITY_TL" type="String" not-
null="true"/>
    <property name="SortOrder" column="SORT_ORDER" type="Int32" not-
null="false"/>

    <many-to-one name="City" class="City">
      <column name="CITY"/>
      <column name="PROVINCE"/>
    </many-to-one>
  </class>

</hibernate-mapping> 
```

LOCATION:

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="NHDAL"
                   namespace="NHDAL.Domain">

  <class name="Location" table="LOCATION">
    <id column="LOCATION" name="Name">
      <generator class="assigned" />
    </id>

    <timestamp
        column="MODIFY_DATE"
        name="ModifyDate"
        access="property"
        unsaved-value="null"/>

      </class>

</hibernate-mapping> 
```

Can someone shine some light on this and tell me what should the query look like in NHibernate?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-02T00:54:40.333

不相关的实体，您可以使用笛卡尔积将它们与 hql 或 SQL 连接起来：

[这里](http://www.jumpingbean.co.za/blogs/mark/hibernate)

# jquery - 使用 jquery 在更改事件中从 JS var 添加文本

> ID：628679
> 
> 赞同：0
> 
> 时间：2009-03-10T02:06:47.107
> 
> 标签：jquery

我试图完成“像”这样的事情。我想根据组合中选择的值将存储在一些 JS 变量中的文本添加到文档中。即如何根据组合的选定值引用 JS 变量？

```
<select id="clickMe">
    <option value="a">a</a>
    <option value="b">b</a>
    <option value="c">c</a>
</select>

<span id="attachHere"></span>   

<script>

var a = "something about a";
var b = "something about b";
var c = "something about c";

$(document).ready(function() {
    $("#clickMe").change(function() {
        $("#attachHere").text($("#clickMe").val());
    });
});

</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T02:15:26.710

为什么不使用类似的东西呢？

```
<script>
<!--

var values = {
    'a' : "something about a",
    'b' : "something about b",
    'c' : "something about c",
};

$(document).ready(function() {
    $("#clickMe").change(function() {
        $("#attachHere").text(values[$("#clickMe").val()]);
    });
});

//-->
</script> 
```

您将控制值列表并轻松添加和删除值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T02:15:00.550

如果你用过就更好了~~数组~~对象。

假设您不想使用数组，我认为您可以使用 eval：

```
$(document).ready(function() {
    $("#clickMe").change(function() {
        var tmp;
        eval('tmp = ' + $("#clickMe").val());
        $("#attachHere").text(tmp);
    });
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T02:16:18.783

尝试将值放入由选项键入的哈希中，然后根据所选值提取它。

```
var choices = {};
choices['a'] = 'something about a';
choices['b'] = 'something about b';
choices['c'] = 'something about c';

$(document).ready(function() {
    $("#clickMe").change(function() {
        $("#attachHere").text(choices[$(this).val()]);
    });
}); 
```

# sql - 左连接是我想要的，但它们很慢？

> ID：628685
> 
> 赞同：9
> 
> 时间：2009-03-10T02:09:47.240
> 
> 标签：sql, optimization, join

概述：

我有三张表 1) 订阅者、简历和衬衫尺码，我需要找到没有简历或衬衫尺码的订阅者

表格的布局如下

**订户**

```
| season_id |  user_id | 
```

**生物**

```
| bio_id | user_id | 
```

**衬衫尺码**

```
| bio_id | shirtsize | 
```

而且我需要找到所有给定季节没有简历或衬衫尺码的用户（如果没有简历；那么通过关系就没有衬衫尺码）。

我最初写了一个查询，如：

```
SELECT *
   FROM subscribers s 
   LEFT JOIN bio b ON b.user_id = subscribers.user_id 
   LEFT JOIN shirtsizes ON shirtsize.bio_id = bio.bio_id 
WHERE s.season_id = 185181 AND (bio.bio_id IS NULL OR shirtsize.size IS NULL); 
```

但现在需要 10 秒才能完成。

我想知道如何重组查询（或者可能是问题），以便它能够合理地执行。

这是mysql解释：（ogu =订阅者，b = bio，tn = shirtshize）

```
| id | select_type | table | type  | possible_keys | key     | key_len | ref         | rows   | Extra       |   
+----+-------------+-------+-------+---------------+---------+---------+-------------+--------+-------------+    
|  1 | SIMPLE      | ogu   | ref   | PRIMARY       | PRIMARY | 4       | const       |    133 | Using where |
|  1 | SIMPLE      | b     | index | NULL          | PRIMARY | 8       | NULL        | 187644 | Using index |
|  1 | SIMPLE      | tn    | ref   | nid           | nid     | 4       | waka2.b.nid |      1 | Using where | 
```

上面的内容很干净，这里是realz信息：

```
mysql> DESCRIBE subscribers
+-----------+---------+------+-----+---------+-------+
| Field     | Type    | Null | Key | Default | Extra |
+-----------+---------+------+-----+---------+-------+
| subscribers  | int(11) | NO   | PRI |         |       | 
| uid       | int(11) | NO   | PRI |         |       | 

mysql> DESCRIBE bio;
+-------+------------------+------+-----+---------+-------+
| Field | Type             | Null | Key | Default | Extra |
+-------+------------------+------+-----+---------+-------+
| bio_id   | int(10) unsigned | NO   | PRI | 0       |       | 
| uid   | int(10) unsigned | NO   | PRI | 0       |       | 

mysql> DESCRIBE shirtsize;
+-------+------------------+------+-----+---------+-------+
| Field | Type             | Null | Key | Default | Extra |
+-------+------------------+------+-----+---------+-------+
| bio_id   | int(10) unsigned | NO   | PRI | 0       |       | 
| shirtsize   | int(10) unsigned | NO   | PRI | 0       |       | 
```

真正的查询看起来像：

```
SELECT ogu.nid, ogu.is_active, ogu.uid, b.nid AS bio_node, tn.nid AS size
                  FROM og_uid ogu
                  LEFT JOIN bio b ON b.uid = ogu.uid
                  LEFT JOIN term_node tn ON tn.nid = b.nid
                  WHERE ogu.nid = 185033 AND ogu.is_admin = 0
                  AND (b.nid IS NULL OR tn.tid IS NULL) 
```

nid 是 season_id 或 bio_id （带有类型）；term_node 将成为衬衫尺寸

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-10T02:15:37.927

查询应该没问题。我将通过查询分析器运行它并优化表上的索引。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-10T02:34:42.203

联接是您可以对 SQL 查询执行的最昂贵的操作之一。虽然它应该能够在某种程度上自动优化您的查询，但也许可以尝试对其进行重组。首先，我会代替 SELECT *，确保从哪些关系中指定您需要哪些列。这将大大加快速度。

如果您只需要用户 ID，例如：

```
SELECT s.user_id
   FROM subscribers s 
   LEFT JOIN bio b ON b.user_id = subscribers.user_id 
   LEFT JOIN shirtsizes ON shirtsize.bio_id = bio.bio_id 
WHERE s.season_id = 185181 AND (bio.bio_id IS NULL OR shirtsize.size IS NULL); 
```

这将允许 SQL 数据库自己更有效地重组您的查询。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-10T02:42:44.587

显然我还没有检查过这个，但似乎你想要的是选择没有匹配的生物或生物和衬衫尺寸之间的连接失败的任何订阅者。对于这种情况，我会考虑使用[NOT EXISTS 。](http://dev.mysql.com/doc/refman/5.0/en/exists-and-not-exists-subqueries.html)您可能需要 bio.user_id 和 shirtsizes.bio_id 上的索引。

```
select *
from subscribers
where s.season_id = 185181
      and not exists (select *
                      from bio join shirtsizes on bio.bio_id = shirtsizes.bio_id
                      where bio.user_id = subscribers.user_id) 
```

**编辑**：

根据您的更新，您可能希望在每列上创建单独的键，而不是/除了具有复合主键。连接可能无法充分利用复合主索引，而连接列本身的索引可能会加快速度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T02:23:33.103

如果您准确地定义您要查找的内容而不是 SELECT * 它可能会加快一点速度......而且 OR 也不是最快的查询，如果您可以在没有 OR 的情况下重新编写它，它会更快。

另外...您可以尝试联合而不是左连接吗？

```
选择 s.user_id
   FROM 订阅者
   左连接 bio b ON b.user_id = s.user_id
   LEFT JOIN shirtsizes ON shirtsize.bio_id = bio.bio_id
WHERE s.season_id = 185181 AND (bio.bio_id 为 NULL 或 shirtsize.size 为 NULL)；

```

会是这样的：

```
（从订阅者 s 中选择 s.user_id，其中 s.season_id = 185181）
联盟
(SELECT b.user_id, b.bio_id FROM bio b WHERE bio.bio_id IS NULL)
联盟
（SELECT shirtsizes.bio_id FROM shirtsizes WHERE shirtsizes.size 为 NULL）

```

（老实说，这对我来说看起来不正确......但是我从不使用~~连接或~~连接语法或联合......）

我会做：

```
选择 *
FROM 订户 s, bio b, shirtsize sh
WHERE s.season_id = 185181
AND shirtsize.bio_id = bio.bio_id
AND b.user_id = s.user_id
AND（bio.bio_id 为空
     或者
     shirtsize.size 为 NULL);

```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T02:37:43.973

是`bio_id`bios的主键吗？真的有可能有一个带有`b.user_id`=`subscribers.user_id`但带有`b.bio_id`NULL的bios行吗？

是否有带`shirtsize.bio_id`NULL 的衬衫尺寸行？这些行是否有 shirtsize.size 不为 NULL？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-10T03:12:11.893

在相关季节的订阅者列表和带有简历和衬衫尺码的季节的订阅者列表之间进行区分会更快吗？

```
SELECT *
   FROM Subscribers
   WHERE season_id = 185181
     AND user_id NOT IN
         (SELECT DISTINCT s.user_id
             FROM subscribers s
             JOIN bios b ON s.user_id = b.user_id
             JOIN shirtsizes z ON b.bio_id = z.bio_id
             WHERE s.season_id = 185181
         ) 
```

这避免了外连接，外连接不如内连接快，因此可能更快。另一方面，它可能会创建两个大列表，它们之间的差异很小。目前尚不清楚子查询中的 DISTINCT 是否会提高或损害性能。它意味着排序操作（昂贵），但如果 MySQL 优化器支持此类操作，则为合并连接铺平了道路。

可能还有其他可用的符号 - 例如，减号或差异。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-11T12:45:33.130

您现在编写的查询会评估所有`bio`' 和`term_node`'（如果它们存在），然后将它们过滤掉。

但是你想要的只是 find`og_uid`没有`term_node`'s （没有 a`bio`也意味着没有 a `term_node`）

因此，您只想在找到第一个存在时立即停止评估`bio`'s 和's ：`term_node``term_node`

```
SELECT  *
FROM    (
        SELECT  ogu.nid, ogu.is_active, ogu.uid,
                (
                SELECT  1
                FROM    bio b, term_node tn
                WHERE   b.uid = ogu.uid
                        AND tn.nid = b.nid
                LIMIT   1
                ) AS ex
        FROM    og_uid ogu
        WHERE   ogu.nid = 185033
                AND ogu.is_admin = 0
        ) ogu1
WHERE   ex IS NULL 
```

这将最多评估一个，每个`bio`最多一个，而不是评估所有现有的数千个并将它们过滤掉。`term_node``og_uid`

应该工作得更快。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-10T09:09:56.420

```
select * from subscribers where user_id not in (
  select user_id from bio where bio_id not in (
    select bio_id from shirt_sizes
  )
) and season_id=185181 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-11T11:04:10.473

我假设您的“大表”是订阅者，并且该 season_id 可能既不是选择性也不是索引（如果它不是选择性的，索引它是毫无意义的，无论如何），这意味着无论如何您都必须完全扫描订阅者。分开时，我将加入（使用内部连接）另外两个表 - 请注意，如果 shirt_size 中没有 bio_id，那么您的查询与没有 bio 完全相同。第一点：

```
select uid
from bio
     inner join shirtsizes
             on shirtsizes.bio_id = bio.bio_id 
```

此时您要检查衬衫尺寸是否已在 bio_id 上编制索引。现在您可以将此查询左外部加入订阅者：

```
select *
from subscribers s
     left outer join (select uid
                      from bio
                      inner join shirtsizes
                              on shirtsizes.bio_id = bio.bio_id) x
                  on x.uid = s.uid
where s.season_id = 185181
  and x.uid is null 
```

如果生物和衬衫尺寸都不是巨大的，那么它可能会跑得相当快......

# macports - 如何在 MacPorts 中重置端口？

> ID：628707
> 
> 赞同：5
> 
> 时间：2009-03-10T02:18:45.113
> 
> 标签：macports

假设我想将一个端口重置为其初始状态，包括其配置文件。这可以通过以下方式实现：

```
sudo port uninstall portname
sudo port install portname 
```

（停用然后重新激活端口不会重置配置文件。）

有没有办法在不卸载和重新安装端口的情况下做到这一点，避免重建包的开销？

**编辑：**感谢Alexander 和Nerdling 的回复。存档模式对我有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T03:32:31.423

您要做的是激活存档模式。

```
vi ${prefix}/etc/macports/macports.conf 
```

通常，您的前缀是`/opt/local`.

在该文件中，查找`portarchivemode`并启用它。现在，无论何时安装软件包，文件都将按设置存档`portarchivetype`。

支持的类型：tgz（默认）、tar、tbz、tbz2、tlz、xar、zip、cpgz、cpio

如果您卸载端口，它将打开存档而不是重建所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T02:39:51.973

几周前我也有同样的问题。我在没有任何运气的情况下搜索了 Macports 文档。据我所知，它没有执行此操作的命令。

# objective-c - 如何在特殊类中建立 HTTP 连接？

> ID：628708
> 
> 赞同：2
> 
> 时间：2009-03-10T02:19:19.650
> 
> 标签：objective-c, cocoa, http, class-design

我想创建一个类来处理其他类的所有 HTTP 连接工作（以避免重复编写代码）。我称它为 ConnectionCenter（NSObject 的子类）并向其添加以下代码：

```
-(void)connect:(NSString *)strURL obj:(ConnectCenter *)objConnect
{
    NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString:strURL]
                                              cachePolicy:NSURLRequestUseProtocolCachePolicy
                                          timeoutInterval:60.0];

    NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:objConnect];
    if (theConnection) 
    {
        // receivedData is declared as a method instance elsewhere
        receivedData = [[NSMutableData data] retain];
    } 
    else 
    { 
        // inform the user that the download could not be made
    }

}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    // append the new data to the receivedData
    // receivedData is declared as a method instance elsewhere
    [receivedData appendData:data];
} 
```

其他类通过传递 URL 和 ConnectionCenter 对象来调用它。但是没有调用 ConnectionCenter 中的方法“didReceiveData”。关于它有什么问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T03:02:54.553

您需要`[theConnection setDelegate:self]`在设置连接后调用，因为`connection:didReceiveData:`它是一个委托方法。

阅读[文档](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html#//apple_ref/occ/instm/NSObject/connection:didCancelAuthenticationChallenge:)以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T15:59:00.193

关于这段代码的一些事情......

首先，令人困惑的是您实际上将哪个对象设置为委托。对 connection:didReceiveData: 的调用将在连接的委托上调用，它是您传递给 connect:obj: 方法的任何对象。您在 ConnectionCenter 上有一个实例方法，可以启动与不同 ConnectionCenter 对象作为委托的连接，这似乎很奇怪。确保您正在查看正确对象上的 connection:didReceiveData: 方法。

如果您没有收到任何数据，则您的连接可能无法连接或只是完成而没有返回任何数据。您应该实现 connectionDidFinishLoading: 和 connection:didFailWithError: 委托方法，以便您知道连接是否已完成，无论是否返回数据。

最后，如果你得到一个良好、快速的连接，你就会遇到一个竞争条件。NSURLConnection 对象将在您创建后立即开始运行。如果有任何数据要读取，它将调用 connection:didReceiveData: 并将其附加到 receivedData。但是，如果连接速度足够快，您最终可能会尝试将数据附加到尚未创建的 receivedData 上。这是一个很小的机会，但是即使 NSURLConnection 的 init 方法没有阻塞，在返回之前对它进行多少工作以使连接继续进行任何假设都是不明智的。在开始连接之前创建 receivedData 以便您可以确保在数据进入时有一个放置数据的地方。

# ocaml - 在 Ocaml 中将字符返回到标准输入

> ID：628712
> 
> 赞同：3
> 
> 时间：2009-03-10T02:21:07.790
> 
> 标签：ocaml, stream-processing

是否有等效`istream::putback(char)`于 OCaml 的 C++ 方法？

如何在*stdin*的开头添加一个字符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T17:19:53.527

你不能用`in_channel`或来做`Stream.t`。以下是一些建议：

1.  如果要放回已读过的字符，则可能要使用 use`peek`来检查流而不是删除元素。

2.  您可能有一些运气直接为该函数编写 C 接口。我可以看到这是一个非常糟糕的主意。

3.  您是否考虑过使用蓄能器？

4.  围绕当前函数编写一个模块，其类型为拉链或堆栈或其他允许将字符推回的结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-16T10:44:35.670

[OCaml Batteries Included](http://batteries.forge.ocamlcore.org/)具有更全面和更高级别的流接口。你可以看看这个。另外，总的来说，这很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-08T04:30:29.357

基本上：你不能。电池（和 Extlib）提供了增强的 I/O 包装器，但它们都不支持此功能。

但是，如果您愿意只进行字符级读取，则可以使用 Batteries 或 Extlib 模拟它，将 I/O 流包装在[Enum](http://ocaml-extlib.googlecode.com/svn/doc/apiref/Enum.html)中（[BatEnum](http://thelema.github.com/AAA-batteries/hdoc/BatEnum.html)与 Batteries ）。Enum 提供具有“获取下一个值”类型接口的通用枚举，并允许您将值推回枚举的前面。因此，您可以将 stdin 包装在一个类型的枚举中，该类型`char Enum.t`使用其`Enum.next`函数返回字符，然后使用`Enum.push`将不需要的字符推回到它的前面。

It may be possible then to re-wrap such an enum with [IO](http://ocaml-extlib.googlecode.com/svn/doc/apiref/IO.html) ([BatIO](http://thelema.github.com/AAA-batteries/hdoc/BatIO.html)) for a more flexible interface, if you first verified that those modules don't perform internal buffering that would mess up the semantics of pushing characters.

# asp.net-mvc - asp.net mvc上传图片大小

> ID：628723
> 
> 赞同：1
> 
> 时间：2009-03-10T02:31:40.260
> 
> 标签：asp.net-mvc

如何查看用户上传的图片大小？客户端首先与服务器端双重检查将是最好的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T02:45:43.910

您所描述的是在 HTML 2.0 规范中获取更多 HttpFileUpload 信息的终极战斗，因为您正在为表单 POST 引用 HTML 规范。不幸的是，HttpFileUpload 不允许你得到这个——即使是在 Javascript 中也是如此。这是一个非常普遍的问题。

两种解决方案：

*   正常的解决方案是更改您的 web.config 并修改 http 运行时（允许上传多长时间，例如大文件 30 分钟）和 http 文件大小以增加限制（默认为 4 MB）。这适用于 Ruby/php、ASP.NET 和 ASP.NET MVC - 它适用于所有语言，因为 HTML 2.0 规范限制了您可以在表单 POST 上获取的 HttpFileUpload 数据。这将允许用户上传整个文件；然后，您将在服务器代码中处理您这边的限制。不是最好的解决方案；但是，除非您使用第三部分，否则这是唯一的解决方案。

*   使用第 3 方“文件监视器”插件。

我见过的最简单的方法之一是 Telerik 的 RadControls。这些控件对我们有什么作用，它们安装了 HttpModule、HttpHandler 和特殊的 javascript。有几个第三方确实可以，但基本上是这样的：

*   Javascript 捕获 HttpFileUpload 提交，并将表单 POST 重新路由到特殊处理程序（例如 /RadControlsUploadHandler.asmx）。
*   RadControlsUploadHandler 更新实时上传的实际字节的静态变量。
*   然后 Javascript 加载一个“进度条”弹出窗口，该弹出窗口不断地点击 RadControlsUploadHandler.asmx 以进行“状态”更新。此状态更新执行 HttpModule，该模块将原始表单发布过程中的静态变量数据读取到同一处理程序。
*   然后，模块通过“进度条”ajax 调用返回 JSON 数据，给出上传字节数、估计带宽等状态。

这是 Telerik 的进度条上传演示：

[http://demos.telerik.com/aspnet-ajax/upload/examples/customprogress/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/upload/examples/customprogress/defaultcs.aspx)

就个人而言，我不喜欢不知道他们是如何锁定这些上传的线程的——因为在使用这些 3rd 方工具的情况下，我有可伸缩性问题。但是，对于 Joe Bloe 的博客来说，它们是很好的工具。

## 问题与 ASP.NET MVC

这些第 3 方工具的问题在于它们只能在 ASP.NET WebForms（标准 ASP.NET）下工作。ASP.NET MVC 删除了整个 ASP.NET WebForms 概念 - 因此，使这些控件变得无用。

嗯，也许有人要写一个新项目。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T02:49:54.007

Finding the size on the client without an applet or ActiveX control that allows the user to access the file system won't be possible. For security reasons, the browser restricts access to the file system. On the server side, the uploaded file should have a content length associated with it that you can check.

# eclipse - How to change the color of Eclipse RCP view title bar

> ID：628726
> 
> 赞同：7
> 
> 时间：2009-03-10T02:32:47.480
> 
> 标签：eclipse, eclipse-rcp

How to change the color of Eclipse RCP view title bar?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-10T05:01:18.497

You can change the color with this is possible with the **[org.eclipse.ui.themes Extension-Point](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_themes.html)**.

Here's an example snippet

```
 <extension
         point="org.eclipse.ui.themes">
      <theme
            id="de.spiritlink.custom.ui.theme"
            name="Custom Theme">
         <colorOverride
               id="org.eclipse.ui.workbench.ACTIVE_TAB_BG_END"
               value="255,0,0">
         </colorOverride>
         <colorOverride
               id="org.eclipse.ui.workbench.ACTIVE_TAB_BG_START"
               value="0,255,0">
         </colorOverride>
      </theme>
   </extension> 
```

Setting the theme programmatically with [**IThemeManager**](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/themes/IThemeManager.html), which is an object that contains references to usable **[`ITheme`](http://help.eclipse.org/stable/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/themes/ITheme.html)** objects and maintains a reference to the currently active theme. This theme will be used by the workbench to decorate tab folders and other controls where possible:

```
PlatformUI.getWorkbench().getThemeManager().setCurrentTheme("myThemeID"); 
```

Other details in thoses articles:

*   [Adding Color and Font preferences](http://swik.net/Eclipse/Eclipse+Tips/Adding+Color+and+Font+preferences/cqkx3)
*   [**RCP Custom Look and Feel**](http://wiki.eclipse.org/RCP_Custom_Look_and_Feel)

# java - 需要了解Java中LinkedList类的一些基础知识

> ID：628730
> 
> 赞同：0
> 
> 时间：2009-03-10T02:34:28.960
> 
> 标签：java

```
package abc;

class DependencyDataCollection
{
    private int sNo;
    private String sessionID;
    private int noOfDependency;
    private int noOfRejection;
    private int totalValue;

    /** Creates a new instance of DependencyDataCollection */
    public DependencyDataCollection(int sNo, String sessionID, int noOfDependency, int noOfRejection, int totalValue)
    {
        this.sNo = sNo;
        this.sessionID = sessionID;
        this.noOfDependency = noOfDependency;
        this.noOfRejection = noOfRejection;
        this.totalValue = totalValue;
    }

    public int getSNo()
    {
        return sNo;
    }

    public String getSessionID()
    {
        return sessionID;
    }

    public int getNoOfDependency()
    {
        return noOfDependency;
    }

    public int getNoOfRejection()
    {
        return noOfRejection;
    }

    public int getTotalValue()
    {
        return totalValue;
    }
}

public class DependencyStack {

    LinkedList lList;

    /** Creates a new instance of DependencyStack */
    public DependencyStack()
    {
        lList = new LinkedList();
    }

    public void add(int sNo, String sessionID, int noOfDependency, int noOfRejection, int totalValue)
    {
        lList.add(new DependencyDataCollection(sNo,sessionID,noOfDependency,noOfRejection,totalValue));
    }

    public int size()
    {
        return lList.size();
    }

    public void show()
    {
        for(int i=0;i<lList.size();i++)
        {
            DependencyDataCollection ddc = (DependencyDataCollection)lList.get(i);
            System.out.println(ddc.getSNo()+"   "+ddc.getSessionID()+"   "+ddc.getNoOfDependency()+"     "+ddc.getNoOfRejection()+"      "+ddc.getTotalValue());
        }
    }

    public int returnIndexOfSession(String sessionID)
    {
        DependencyDataCollection ddc = null;
        for(int i=0;i<lList.size();i++)
        {
            ddc = (DependencyDataCollection)lList.get(i);
            if(ddc.getSessionID().equals(sessionID))
                break;
        }
        return ddc.getSNo();
    }

    public static void main(String args[])
    {
        DependencyStack ds = new DependencyStack();
        ds.add(1,"a",0,0,0);
        ds.add(2,"b",0,0,0);
        ds.show();

        //System.out.println(ds.returnIndexOfSession("a"));

//        DependencyDataCollection ddc = new DependencyDataCollection(1,"a",0,0,0);
//        System.out.println(ds.indexOf(ddc));
    }
} 
```

这是一个简单的 Java 链表程序，它使用 java.util 包中的内置链表类。链表用于使用 DependencyDataCollection 类存储不同数量的数据。

**现在我的问题是**

> 1）请评估这个程序，我是否尊重所有java概念，如私有成员访问，我已经完成了，等等。
> 
> 2) 我在查找特定会话的 indexOf 时遇到问题。
> 
> 例如，节点 1 包含 1,"a",0,0,0......节点 2 包含 2,"b",0,0,0
> 
> 现在我想找到包含“b”或“a”数据之一的节点的indexOf。什么可能是最短的内置方法可以做到这一点，因为我制作了一个名为“public int returnIndexOfSession（String sessionID）”的函数，它使用了for循环，我发现这非常耗时..还有其他出路吗？ .

请评估和指导，因为我是 java 新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T03:01:32.577

这是我要做的更改，理由在评论中。

```
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.io.Writer;
import java.util.ArrayList;
import java.util.List;

class DependencyDataCollection
{
    // makte them fnal, then you hava an immutible object and your code is much safer.
    // in your case you had noset methods so it was safe, but always try to make things final.
    private final int sNo;
    private final String sessionID;
    private final int noOfDependency;
    private final int noOfRejection;
    private final int totalValue;

    public DependencyDataCollection(final int    sNo, 
                                    final String sessionID, 
                                    final int    noOfDependency, 
                                    final int    noOfRejection, 
                                    final int    totalValue)
    {
        this.sNo            = sNo;
        this.sessionID      = sessionID;
        this.noOfDependency = noOfDependency;
        this.noOfRejection  = noOfRejection;
        this.totalValue     = totalValue;
    }

    public int getSNo()
    {
        return sNo;
    }

    public String getSessionID()
    {
        return sessionID;
    }

    public int getNoOfDependency()
    {
        return noOfDependency;
    }

    public int getNoOfRejection()
    {
        return noOfRejection;
    }

    public int getTotalValue()
    {
        return totalValue;
    }
}

class DependencyStack
{
    // change the type to be as generic as poosible - List interface
    // added generics so you get compile time safety and don't use casts later on
    // renamed it to something meaningful
    private final List<DependencyDataCollection> dependencies;

    // use an ArrayList instead of a LinkedList, it'll be faster since you are not inserting/deleting
    // into the middle of the list
    {
        dependencies = new ArrayList<DependencyDataCollection>();
    }

    // your Stack shouldn't know how to make the collections... (in my opinion)
    public void add(final DependencyDataCollection ddc)
    {
        dependencies.add(ddc);
    }

    public int size()
    {
        return dependencies.size();
    }

    // the next 3 methods are just convenience since you don't know if someione
    // will want to write to a file or a writer instead of a stream
    public void show()
    {
        show(System.out);
    }

    public void show(final OutputStream out)
    {
        show(new OutputStreamWriter(out));
    }

    public void show(final Writer writer)
    {
        show(new PrintWriter(writer));
    }

    public void show(final PrintWriter writer)
    {
        // use the new for-each instead of the old style for loop
        // this also uses an iterator which is faster than calling get
        // (well on an ArrayList it probably is about the same, but a LinkedList it'll be faster)
        for(final DependencyDataCollection ddc : dependencies)
        {
            writer.println(ddc.getSNo()            + "   " +
                           ddc.getSessionID()      + "   " +
                           ddc.getNoOfDependency() + "   " +
                           ddc.getNoOfRejection()  + "   " +
                           ddc.getTotalValue());
        }
    }

    public int returnIndexOfSession(final String sessionID)
    {
        DependencyDataCollection foundDDC;
        final int                retVal;

        foundDDC = null;

        for(final DependencyDataCollection ddc : dependencies)
        {
            if(ddc.getSessionID().equals(sessionID))
            {
                foundDDC = ddc;
                break;
            }
        }

        // deal with the fact that you might have not found the item and it would be null.
        // this assumes -1 is an invalid session id
        if(foundDDC == null)
        {
            retVal = -1;
        }
        else
        {
            retVal = foundDDC.getSNo();
        }

        return (retVal);
    }

    public static void main(final String[] args)
    {
        DependencyStack ds = new DependencyStack();
        ds.add(new DependencyDataCollection(1,"a",0,0,0));
        ds.add(new DependencyDataCollection(1,"a",0,0,0));
        ds.show();

        //System.out.println(ds.returnIndexOfSession("a"));

//        DependencyDataCollection ddc = new DependencyDataCollection(1,"a",0,0,0);
//        System.out.println(ds.indexOf(ddc));
    }
} 
```

编辑：

这将加快查找（和删除）。

```
class DependencyStack
{
    // A Map provides quick lookup
    private final Map<String, DependencyDataCollection> dependencies;

    // a LinkedHashMap allows for quick lookup, but iterates in the order they were added... if that matters for show.
    {
        dependencies = new LinkedHashMap<String, DependencyDataCollection>();
    }

    // your Stack shouldn't know how to make the collections... (in my opinion)
    public void add(final DependencyDataCollection ddc)
    {
        if(ddc == null)
        {
            throw new IllegalArgumentException("ddc cannot be null");
        }

        dependencies.put(ddc.getSessionID(), ddc);
    }

    public int size()
    {
        return dependencies.size();
    }

    // the next 3 methods are just convenience since you don't know if someione
    // will want to write to a file or a writer instead of a stream
    public void show()
    {
        show(System.out);
    }

    public void show(final OutputStream out)
    {
        show(new OutputStreamWriter(out));
    }

    public void show(final Writer writer)
    {
        show(new PrintWriter(writer));
    }

    public void show(final PrintWriter writer)
    {
        // use the new for-each instead of the old style for loop
        // this also uses an iterator which is faster than calling get
        // (well on an ArrayList it probably is about the same, but a LinkedList it'll be faster)
        for(final DependencyDataCollection ddc : dependencies.values())
        {
            writer.println(ddc.getSNo()            + "   " +
                           ddc.getSessionID()      + "   " +
                           ddc.getNoOfDependency() + "   " +
                           ddc.getNoOfRejection()  + "   " +
                           ddc.getTotalValue());
        }
    }

    public int returnIndexOfSession(final String sessionID)
    {
        final DependencyDataCollection ddc;
        final int                      retVal;

        if(sessionID == null)
        {
            throw new IllegalArgumentException("sessionID cannot be null");
        }

        // get it if it exists, this is much faster then looping through a list
        ddc = dependencies.get(sessionID);

        // deal with the fact that you might have not found the item and it would be null.
        // this assumes -1 is an invalid session id
        if(ddc == null)
        {
            retVal = -1;
        }
        else
        {
            retVal = ddc.getSNo();
        }

        return (retVal);
    }

    public static void main(final String[] args)
    {
        DependencyStack ds = new DependencyStack();
        ds.add(new DependencyDataCollection(1,"a",0,0,0));
        ds.add(new DependencyDataCollection(1,"a",0,0,0));
        ds.show();

        //System.out.println(ds.returnIndexOfSession("a"));

//        DependencyDataCollection ddc = new DependencyDataCollection(1,"a",0,0,0);
//        System.out.println(ds.indexOf(ddc));
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T02:38:57.747

突出的一件事是缺少 javadoc 样式的注释（来自[http://en.wikipedia.org/wiki/Javadoc](http://en.wikipedia.org/wiki/Javadoc)）

```
/**
 *验证国际象棋移动。使用 {@link #doMove(int, int, int, int)} 移动一块。
 *
 * @param theFromFile 文件从中移动一块
 * @param theFromRank 排名从哪个棋子被移动
 * @param theToFile 一块被移动到的文件
 * @param theToRank 一块被移动到的排名
 * @return 如果棋步有效，则返回 true，否则返回 false
 */

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T02:41:57.350

你想使用泛型：

```
List<DependencyDataCollection> lList; 
```

此外，在您的变量定义中，您应该使用接口 List 而不是具体类型 (LinkedList)。

要使 indexOf 工作，您的元素类型 (DependencyDataCollection) 需要实现比较器以实现相等：

```
class DependencyDataCollection{

  @Override
  public boolean equals(Object o){
    ...
  }
} 
```

然后，您可以使用 List 接口提供的内置 indexOf()。然而，它将执行与您现在执行的相同类型的循环。如果这太耗时（真的吗？），那么您需要一个哈希支持的列表或其他东西（在这种情况下，您还需要实现 hashCode()）。

**更新：**它会做同样的循环，但比你现在更有效。不要通过索引访问链接列表，它不是为此而构建的，使用 foreach 循环或迭代器（或 ArrayList）：

```
 for(DependencyDataCollection d: iList){
    ... } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T02:43:47.313

你有一个好的开始。您可以进行的改进：

*   泛型。您的链接列表可能是

    LinkedList < DependencyDataCollection > lList; 这使您可以进行类型检查。

*   你已经看到你的链表不方便搜索——你必须检查每个值，这既慢又笨重。这就是人们使用哈希图的原因。

*   查找构建器模式以找到绕过一长串构造函数参数的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T02:45:59.633

1）你为什么不使用泛型：

```
LinkedList<DependencyDataCollection> lList; 
```

2）那是LinkedList的缺点，你还不如使用HashMap或者其他数据结构

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T02:42:33.493

在最近的 Java 版本中，您可以使用[泛型](http://en.wikipedia.org/wiki/Generics_in_Java)，这样您就不必强制转换调用时生成的对象`lList.get(i)`。例如：

```
LinkedList<DependencyDataCollection> lList = new LinkedList<DependencyDataCollection>();

...

DependencyDataCollection ddc = lList.get(0); 
```

要获取特定元素的索引，请手动遍历列表。对于列表范围内的每个索引 i，获取 DependencyDataCollection 并查看它是否具有您想要的属性。如果是，请保存索引。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T03:55:55.347

LinkedList 在 java.util 中，可以包含任何类型的类。例如，我使用一个名为 Application 的类。所以在下面的代码中，我只有一个应用程序列表。然后我把一个应用程序放在列表中。我还可以遍历我的应用程序以对我的对象做任何我想做的事情。

```
 LinkedList<Application> app = new LinkedList<Application>();

            app.add(new Application("firefox"));

    Iterator<Application> iterable = app.iterator();
    while(iterable.hasNext()){
        Application eachapp = iterable.next();
    } 
```

如果您需要找到一个带有 indexOf 的对象，您可以在我的情况下为您的对象覆盖 equal 方法“应用程序”，所以如果在 equal 我声明它并且应用程序等于和其他应用程序，如果字段名称相同，那么

app.indexOf(new Application("firefox")) 将返回我刚刚插入的应用程序的索引。

# c# - 如果表单/字段是数据绑定的，如何将其标记为“脏”？

> ID：628735
> 
> 赞同：5
> 
> 时间：2009-03-10T02:39:47.060
> 
> 标签：c#, .net, wpf, validation

如果我有一个数据绑定表单，我如何知道用户是否修改了它（通过在文本框中键入文本，或通过选择组合框中的项目）？我已经尝试连接到我的文本框的“TextChanged”事件，但问题是，当我的表单参与数据绑定时，“TextChanged”事件会触发，过早地将我的表单标记为“脏”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T03:09:42.157

尝试实施

```
public partial class Window1 : INotifyPropertyChanged 
```

进而

```
public event PropertyChangedEventHandler PropertyChanged;

public string UserName
{
    get { return _UserName; }
    set { if (value != _UserName)
    {
        _UserName = value;
        OnNotifyPropertyChanged("UserName");
    }}
}

private void OnNotifyPropertyChanged(string property)
{
  if (PropertyChanged != null)
    PropertyChanged(this, new PropertyChangedEventArgs(property));
} 
```

和数据绑定一样

```
<TextBox Text="{Binding UserName}"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T02:59:16.933

你的模型类实现了`INotifyPropertyChanged`吗？如果是这样，您可以为`PropertyChanged`类上的事件添加一个处理程序，并观察相关属性的变化。

如果您还没有实现`INotifyPropertyChanged`，也许您用来通知 UI 层更新的机制也可以在这里使用？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T02:56:31.323

当您第一次显示页面时，将表单值存储在一个数组中，当 TextChanged 事件触发时，与您已经获得的内容进行比较，如果它是不同的脏表单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T12:03:49.857

--> [http://www.mishainthecloud.com/2009/07/simple-dirty-tracking-for-winforms-in-c.html](http://www.mishainthecloud.com/2009/07/simple-dirty-tracking-for-winforms-in-c.html)。

我知道这有点晚了，但我喜欢这种方法 :) 封装的好处。

绑定控件后，调用 SetAsClean()。通过处理一些 BindingSources 的事件，这个方法调用可能被封装在同一个脏跟踪类中。

# visual-studio - msbuild SLN 并且仍然获得单独的项目输出？

> ID：628739
> 
> 赞同：11
> 
> 时间：2009-03-10T02:42:34.027
> 
> 标签：visual-studio, msbuild, projects-and-solutions

我有一个普通的 SLN 文件，我正在使用命令行中的 msbuild 对其进行编译。我这样做：

C:\slndir> msbuild /p:OutDir=C:\slnbin\

它会将所有内容转储到 C:\slnbin，但网站除外，这些网站会部署到 C:\slnbin_PublishedWebsites\。

我想要的不仅是将所有二进制文件放在 bin 目录中，而且让每个可执行程序都有自己的“已部署”文件夹，类似于每个网站获得的文件夹。

因此，例如，如果我有以下项目： - Common - Lib1 - Service1 - Lib2 - Service2

我想得到：

```
 C:\slnbin\ // Everything
  C:\slbin\Deploy\Service1 // Common, Lib1, Service1
  C:\slbin\Deploy\Service2 // Common, Lib2, Service2 
```

我尝试做诸如“msbuild /p:OutDir=C:\slnbin\$(ProjectName)”之类的东西，但它只是将其视为文字并创建一个实际的“$(ProjectName)”子目录。

最好，我不必修改每个单独的项目等等。

这可能吗？简单的？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-10T08:21:15.240

正如 John Saunders 所说，您需要有一个主 MSBuild 文件来处理该过程。

下面是一个使用[MSBuild 社区任务](http://msbuildtasks.tigris.org/)的示例：**GetSolutionProjects**获取给定解决方案的项目

```
<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" DefaultTargets="Package">

  <Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets"/>

  <!-- Specify here, the solution you want to compile-->
  <ItemGroup>
    <Solution Include="C:\slndir\solution.sln"/>
  </ItemGroup>

  <PropertyGroup>
    <Platform>AnyCPU</Platform>
    <Configuration>Debug</Configuration>

    <!-- Your deployment directory -->
    <DeployDir>C:\slbin\Deploy</DeployDir>
  </PropertyGroup>

  <!-- Gets the projects composing the specified solution -->
  <Target Name="GetProjectsFromSolution">
    <GetSolutionProjects Solution="%(Solution.Fullpath)">
      <Output ItemName="ProjectFiles" TaskParameter="Output"/>
    </GetSolutionProjects>
  </Target>

  <Target Name="CompileProject" DependsOnTargets="GetProjectsFromSolution">
    <!-- 
      Foreach project files
        Call MSBuild Build Target specifying the outputDir with the project filename.
    -->
    <MSBuild Projects="%(ProjectFiles.Fullpath)"
             Properties="Platform=$(Platform);
             Configuration=$(Configuration);
             OutDir=$(DeployDir)\%(ProjectFiles.Filename)\"
             Targets="Build">
    </MSBuild>
  </Target>
</Project> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T02:50:03.197

您必须“手动”执行此操作。创建一个构建解决方案的主 MSBUILD 项目文件，然后将所有解决方案输出复制到所需的位置。这（大致）是 Visual Studio Team Build 的工作方式。

# .net - Chrome / IE8 多进程设计，.NET 可以吗？

> ID：628744
> 
> 赞同：5
> 
> 时间：2009-03-10T02:44:13.647
> 
> 标签：.net, user-interface, internet-explorer-8, google-chrome, process

Google Chrome 和 IE8（以及其他）旨在通过在单独的进程中隔离每个选项卡（网页）来提供更高的可靠性/稳定性（我知道过于简化了）。

这似乎比多线程更重量级，但主要好处是一个进程中的崩溃不会导致整个应用程序崩溃。

似乎多进程架构长期以来一直用于服务器端应用程序（例如 Web 服务器），但这些是没有专用 GUI 的进程。有趣的是，它现在被用于桌面应用程序的用户界面。

我将如何在 Windows Forms .NET 应用程序中实现这一点？甚至可能吗？

Process.Start() 显然是第一个要查看的地方，但新进程的 GUI 并未与宿主应用程序的 GUI 紧密集成。它是一个新的独立应用程序，而不是主应用程序的子控件/窗口，就像 Chrome/IE8 一样。

[（对于任何感兴趣的人，Scott Hanselmann 在这里写了一篇关于 IE8 多进程架构](http://www.hanselman.com/blog/MicrosoftIE8AndGoogleChromeProcessesAreTheNewThreads.aspx)的很好的介绍。）

[更新]

进一步来说：

一个单独的“子流程”如何在“主流程”内直接渲染到 UI？这实际上是发生了什么，或者正如评论中所建议的那样，子进程是否使用 IPC 要求主进程为其渲染？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-10T03:02:27.237

Google Chrome 使用**命名管道**进行进程间通信。

这里有一些有趣的文档：http: [//dev.chromium.org/developers/design-documents](http://dev.chromium.org/developers/design-documents)

有关使用“.net”的命名管道的更多信息，只需 google 即可。

@Ash：子进程在*单独的 Windows“桌面”*中运行，这意味着它们无法显示任何内容。（桌面是一件棘手的事情......）所以我必须假设子进程呈现的所有内容都必须通过 IPC。然后 main(?) 进程显示它。

我在这里发现了*单独的 Windows“桌面”* ：http : [//dev.chromium.org/developers/design-documents/multi-process-architecture](http://dev.chromium.org/developers/design-documents/multi-process-architecture)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T03:02:15.787

在 .NET 中使用多个进程的更好选择是使用多个 AppDomain。这样做的好处是只创建了一个实际的 Windows 进程，但仍然增加了多个区域的稳定性（即，一个 AppDomain 中的崩溃只会导致该 AppDomain 崩溃，而不是整个应用程序）。

有与此相关的成本，因为对象需要跨 AppDomain 边界进行序列化。不过，它可能比多进程模型更容易开发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T03:56:36.967

顺便说一句...重复

请参阅：[Windows 窗体应用程序，例如具有多个进程的 Google Chrome](https://stackoverflow.com/questions/197182/winforms-app-like-google-chrome-with-multiple-processes)（来自 Jon Skeet 的回答：o）

（我认为这也回答了“更具体”的部分）

# bash - 无法将图片从桌面移动到特定文件夹

> ID：628745
> 
> 赞同：0
> 
> 时间：2009-03-10T02:44:44.347
> 
> 标签：bash, mv

我的桌面上有从 Picture_1.png 到 Picture_77.png 的图片。

我现在在终端中一个名为 Pictures 的文件夹中。我想将图片移动到我现在所在的文件夹中。

我尝试了以下代码不成功

```
mv Picture_[1-77].png 
```

我不确定应该为目标文件夹添加什么，因为我在目标文件夹中。

你怎么能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T02:46:49.380

```
mv /path/to/pictures/Picture_* ./ 
```

`./`表示“当前目录”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T02:51:11.167

从字面上看，您可以像这样解决它：

```
mv ~/Desktop/Picture_{1..77}.png ./ 
```

If you want to move all the pictures beyond 77 and other numbers too, Daniel L solution will do it too. His one is simplier and the best *ad hoc* solution if you know those are the only files with a `Picture_` prefix.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T02:50:27.390

即使您位于目标文件夹，也需要指定目标文件夹。例如，如果我的文件在 Foo 文件夹中，我想将它们移动到 Bar 文件夹中。假设我在 Foo 文件夹中，这是目录的组织方式：

/ (根)
|--Foo/
|--Bar/

然后，我会做（在 Foo 文件夹内）：

```
mv Picture_* ../Bar/ 
```

# c# - 不会立即执行的单元测试代码

> ID：628751
> 
> 赞同：2
> 
> 时间：2009-03-10T02:48:40.733
> 
> 标签：c#, unit-testing, c#-3.0, nunit, xna

我正在使用 C# 3.0 和 NUnit。我想知道是否有一种标准方法可以对在一段时间后执行的代码执行单元测试。例如，我有一个简单的静态类，我可以向它注册方法，并在 n 毫秒后调用它们。我需要确保正在调用委托方法中的代码。

例如，以下测试将始终通过，因为在方法退出之前没有任何断言。

```
[Test]
public void SampleTest()
{
    IntervalManager.SetTimeout(delegate{ 
        Assert.Equals(now.Millisecond + 100, DateTime.Now.Millisecond); 
    }, 100);
} 
```

甚至可以对不立即执行的代码进行单元测试吗？

干杯，

保罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T03:05:23.410

那么你到底在测试什么？你在测试定时器的工作吗？或者您的代码正确设置了一个计时器，以便在到期时计时器执行回调？在不知道代码是什么样子的情况下，我假设您真正想要测试的是后者。我的回答是（1）这对于静态方法可能会很困难，（2）你可能需要使用依赖注入并注入模拟计时器等，它们实际上并不运行生成的方法，而是记录通过期望您的代码进行了正确的调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T03:48:45.660

这个怎么样？它会导致测试阻塞一些预期的最大时间，以便回调触发并在保释之前完成，并报告错误。

```
public void Foo() {
    AutoResetEvent evt = new AutoResetEvent(false);
    Timer t = new Timer(state => {
        // Do work
        evt.Set();
    }, null, 100, Timeout.Infinite);
    if (evt.WaitOne(500)) {
        // method called and completed
    } else {
        // timed out waiting
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T06:54:07.210

作为旁注。我们通常会尝试使用[NUnit 类别](http://www.nunit.org/index.php?p=category&r=2.2)标记运行缓慢的测试，并且可以选择在某些构建上跳过这些测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T03:02:28.517

是的，像你的例子那样做是行不通的。

相反，我建议您创建一个测试类，用作委托，记录何时调用其方法以及何时调用。

然后，您将您的模拟注入您要测试的 IntervalManager。然后您的测试方法必须等待 IntervalManager（使用 IntervalManager 提供的合适方法，或者等待几秒钟），然后您可以验证测试类的状态。

顺便说一句，这种方法通常被称为 [模拟](http://en.wikipedia.org/wiki/Mock_object)；在这种情况下，测试类将是模拟对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-06T21:45:38.260

正如其他几个答案所表明的那样，长时间运行的测试通常是一个坏主意。为了便于测试这个组件，您应该考虑到您确实有两个不同的东西要测试。

1.  当您注册定时委托执行时，会设置正确的时间。这可能需要使用超时和代表数量的各种组合进行测试。
2.  委托以适当的方式执行。

以这种方式分离测试将允许您测试您的计时机制是否按预期工作，只需少量短超时（测试您需要考虑的所有情况）。请记住，根据系统上的当前负载以及组件代码的复杂程度（即`IntervalManager`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T02:51:32.460

当然你可以测试一下。你只需要等待它执行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-06T21:33:05.743

也许我遗漏了一些东西，但 Visual Studio 的单元测试具有特殊属性，您可以将其放在控制执行顺序和其他内容的方法上。这应该在您第一次制作单元测试项目时自动生成：

```
 #region Additional test attributes
    // 
    //You can use the following additional attributes as you write your tests:
    //
    //Use ClassInitialize to run code before running the first test in the class
    //[ClassInitialize]
    //public static void MyClassInitialize(TestContext testContext) {
    //}
    //
    //Use ClassCleanup to run code after all tests in a class have run
    //[ClassCleanup()]
    //public static void MyClassCleanup()
    //{
    //}
    //
    //Use TestInitialize to run code before running each test
    //[TestInitialize()]
    //public void MyTestInitialize()
    //{
    //}
    //
    //Use TestCleanup to run code after each test has run
    //[TestCleanup()]
    //public void MyTestCleanup()
    //{
    //}
    //
    #endregion 
```

因此，使用 [ClassInitialize] 应该允许您将必须首先执行的任何内容写入方法中。然后你的测试就可以运行了。或者您可以使用 [TestInitialize] 在每次测试之前运行代码。

# c# - 为什么在析构函数中调用 dispose(false)？

> ID：628752
> 
> 赞同：66
> 
> 时间：2009-03-10T02:49:04.510
> 
> 标签：c#, dispose

下面是一个典型的 dispose 模式示例：

```
 public bool IsDisposed { get; private set; }

  #region IDisposable Members

  public void Dispose()
  {
    Dispose(true);
    GC.SuppressFinalize(this);
  }

  protected virtual void Dispose(bool disposing)
  {
    if (!IsDisposed)
    {
      if (disposing)
      {
        //perform cleanup here
      }

      IsDisposed = true;
    }
  }

  ~MyObject()
  {
    Dispose(false);
  } 
```

我了解 dispose 的作用，但我不明白为什么要在析构函数中调用 dispose(false) ？如果您查看定义，它绝对不会做任何事情，那么为什么有人会编写这样的代码呢？*根本不*从析构函数调用 dispose是否有意义？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-03-10T03:11:24.283

如果对象由于某种原因未正确处理，终结器将用作后备。通常`Dispose()`会调用该方法来删除终结器连接并将对象转换为垃圾收集器可以轻松删除的常规托管对象。

这是一个来自 MSDN 的示例，该类具有要清理的托管和非托管资源。

请注意，仅在为 true 时才清理`disposing`托管资源，但始终清理非托管资源。

```
public class MyResource: IDisposable
{
    // Pointer to an external unmanaged resource.
    private IntPtr handle;
    // Other managed resource this class uses.
    private Component component = new Component();
    // Track whether Dispose has been called.
    private bool disposed = false;

    // The class constructor.
    public MyResource(IntPtr handle)
    {
        this.handle = handle;
    }

    // Implement IDisposable.
    // Do not make this method virtual.
    // A derived class should not be able to override this method.
    public void Dispose()
    {
        Dispose(true);
        // This object will be cleaned up by the Dispose method.
        // Therefore, you should call GC.SupressFinalize to
        // take this object off the finalization queue
        // and prevent finalization code for this object
        // from executing a second time.
        GC.SuppressFinalize(this);
    }

    // Dispose(bool disposing) executes in two distinct scenarios.
    // If disposing equals true, the method has been called directly
    // or indirectly by a user's code. Managed and unmanaged resources
    // can be disposed.
    // If disposing equals false, the method has been called by the
    // runtime from inside the finalizer and you should not reference
    // other objects. Only unmanaged resources can be disposed.
    private void Dispose(bool disposing)
    {
        // Check to see if Dispose has already been called.
        if(!this.disposed)
        {
            // If disposing equals true, dispose all managed
            // and unmanaged resources.
            if(disposing)
            {
                // Dispose managed resources.
                component.Dispose();
            }

            // Call the appropriate methods to clean up
            // unmanaged resources here.
            // If disposing is false,
            // only the following code is executed.
            CloseHandle(handle);
            handle = IntPtr.Zero;

            // Note disposing has been done.
            disposed = true;

        }
    }

    // Use interop to call the method necessary
    // to clean up the unmanaged resource.
    [System.Runtime.InteropServices.DllImport("Kernel32")]
    private extern static Boolean CloseHandle(IntPtr handle);

    // Use C# destructor syntax for finalization code.
    // This destructor will run only if the Dispose method
    // does not get called.
    // It gives your base class the opportunity to finalize.
    // Do not provide destructors in types derived from this class.
    ~MyResource()
    {
        // Do not re-create Dispose clean-up code here.
        // Calling Dispose(false) is optimal in terms of
        // readability and maintainability.
        Dispose(false);
    }
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-10T02:54:09.723

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-10T02:53:25.153

C# 中没有析构函数。那是一个终结器，这是另一回事。

区别在于您是否需要清理托管对象。您不想尝试在终结器中清理它们，因为它们本身可能已被终结。

* * *

我最近碰巧看了 C# Programming Guide 的[Destructors](http://msdn.microsoft.com/en-us/library/66x5fx1b.aspx)页面。这表明我在上面的回答中是错误的。特别是，析构函数和终结函数之间存在区别：

```
class Car
{
    ~Car()  // destructor
    {
        // cleanup statements...
    }
} 
```

相当于

```
protected override void Finalize()
{
    try
    {
        // Cleanup statements...
    }
    finally
    {
        base.Finalize();
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-10T03:10:42.913

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-10T02:59:48.197

在 if(disposing) 内部，您应该对具有非托管资源（例如数据库连接）的托管对象调用 dispose/close。当调用终结器时，这些对象不再可访问，因此对象本身可以被终结，而您不需要需要对它们调用 dispose。此外，完成的顺序是未确定的，因此您可能会在已处理的对象上调用 dispose。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-05-21T10:07:31.907

以下示例演示如何创建实现 IDisposable 接口的资源类：[https ://msdn.microsoft.com/en-us/library/System.IDisposable.aspx](http://The%20following%20example%20demonstrates%20how%20to%20create%20a%20resource%20class%20that%20implements%20the%20IDisposable%20interface:%20https://msdn.microsoft.com/en-us/library/System.IDisposable.aspx%20%20In%20Dispose(bool%20disposing)%20function:%20If%20disposing%20equals%20true,%20the%20method%20has%20been%20called%20directly%20or%20indirectly%20by%20your%20code.%20Managed%20and%20unmanaged%20resources%20can%20be%20disposed.%20If%20disposing%20equals%20false,%20the%20method%20has%20been%20called%20by%20the%20runtime%20from%20inside%20the%20finalizer%20and%20you%20should%20not%20reference%20other%20objects.%20Only%20unmanaged%20resources%20can%20be%20disposed.)

在 Dispose(bool disposing) 函数中：如果 disposing 等于 true，则该方法已被您的代码直接或间接调用。可以处置托管和非托管资源。如果 disposing 等于 false，则该方法已由运行时从终结器内部调用，您不应引用其他对象。只能释放非托管资源。

# c - 将字符数字转换为C中的相应整数

> ID：628761
> 
> 赞同：129
> 
> 时间：2009-03-10T02:53:12.330
> 
> 标签：c, type-conversion

有没有办法在C中将字符转换为整数？

例如，从`'5'`到 5？

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2009-03-10T02:59:39.710

根据其他回复，这很好：

```
char c = '5';
int x = c - '0'; 
```

此外，对于错误检查，您可能希望首先检查 isdigit(c) 是否为真。请注意，您不能对字母完全便携地执行相同的操作，例如：

```
char c = 'b';
int x = c - 'a'; // x is now not necessarily 1 
```

该标准保证数字 '0' 到 '9' 的 char 值是连续的，但不保证其他字符（如字母表中的字母）。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-03-10T02:54:52.077

像这样减去“0”：

```
int i = c - '0'; 
```

C 标准保证范围内的每个数字`'0'..'9'`都比其前一个数字大一个（在[C99 草案](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf)`5.2.1/3`的部分中）。C++ 也是如此。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-03-10T03:14:42.327

如果出于某种疯狂的巧合，您想将*字符串*转换为整数，您也可以这样做！

```
char *num = "1024";
int val = atoi(num); // atoi = ASCII TO Int 
```

`val`现在是 1024。显然`atoi()`很好，我之前所说的仅适用于我（在 OS X 上（也许（在此处插入 Lisp 笑话）））。我听说这是一个大致映射到下一个示例的宏，它使用`strtol()`更通用的函数来进行转换：

```
char *num = "1024";
int val = (int)strtol(num, (char **)NULL, 10); // strtol = STRing TO Long 
```

`strtol()`像这样工作：

```
long strtol(const char *str, char **endptr, int base); 
```

它转换`*str`为 a `long`，将其视为基数`base`。如果`**endptr`不为空，则它包含找到的第一个非数字字符`strtol()`（但谁在乎）。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2018-03-05T07:45:50.283

将字符数字转换为相应的整数。如下图所示：

```
char c = '8';                    
int i = c - '0'; 
```

上述计算背后的逻辑是使用 ASCII 值。字符 8 的 ASCII 值是 56，字符 0 的 ASCII 值是 48。整数 8 的 ASCII 值是 8。

如果我们减去两个字符，那么字符的 ASCII 之间就会发生减法。

```
int i = 56 - 48;   
i = 8; 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2015-08-30T15:46:08.517

像这样减去 char '0' 或 int 48：

```
char c = '5';
int i = c - '0'; 
```

说明：它在内部使用[ASCII](http://www.asciitable.com/)值。从 ASCII 表中，字符**5 的十进制值是 53**和**0 是 48**。所以**53 - 48 = 5**

或者

```
char c = '5';
int i = c - 48; // Because decimal value of char '0' is 48 
```

*这意味着如果您从任何数字字符中减去**48**，它将自动转换为整数。*

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-10T02:55:30.373

```
char numeralChar = '4';
int numeral = (int) (numeralChar - '0'); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-07-16T21:56:48.527

以下是允许将 char 中的数字转换为 int 的辅助函数，反之亦然：

```
int toInt(char c) {
    return c - '0';
}

char toChar(int i) {
    return i + '0';
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-06-03T01:27:10.670

只需使用以下`atol()`功能：

```
#include <stdio.h>
#include <stdlib.h>

int main() 
{
    const char *c = "5";
    int d = atol(c);
    printf("%d\n", d);

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-10T03:05:54.967

如果它只是 ASCII 中的单个字符 0-9，那么从 ASCII 值中减去 ASCII 零字符的值应该可以正常工作。

如果要转换更大的数字，则可以执行以下操作：

```
char *string = "24";

int value;

int assigned = sscanf(string, "%d", &value); 
```

** 不要忘记检查状态（如果在上述情况下有效，则应为 1）。

保罗。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-10T03:11:22.380

```
char chVal = '5';
char chIndex;

if ((chVal >= '0') && (chVal <= '9')) {

    chIndex = chVal - '0';
}
else 
if ((chVal >= 'a') && (chVal <= 'z')) {

    chIndex = chVal - 'a';
}
else 
if ((chVal >= 'A') && (chVal <= 'Z')) {

    chIndex = chVal - 'A';
}
else {
    chIndex = -1; // Error value !!!
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-02-26T04:38:31.850

当我需要做这样的事情时，我会用我想要的值预烘焙一个数组。

```
const static int lookup[256] = { -1, ..., 0,1,2,3,4,5,6,7,8,9, .... }; 
```

然后转换很容易

```
int digit_to_int( unsigned char c ) { return lookup[ static_cast<int>(c) ]; } 
```

这基本上是 ctype 库的许多实现所采用的方法。您也可以轻松地将其调整为使用十六进制数字。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-01-05T09:43:28.333

**检查这个，**

```
char s='A';

int i = (s<='9')?(s-'0'):(s<='F')?((s-'A')+10):((s-'a')+10); 
```

仅适用于 0,1,2,....,E,F。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-08-10T11:45:51.040

例如，如果您的数字是`'5'`ASCII，则它表示为二进制数`0011 0101`(53)。每个数字都有最高四位`0011`，最低四位代表bcd中的数字。所以你只是做

```
char cdig = '5';
int dig = cdig & 0xf; // dig contains the number 5 
```

得到最低的 4 位，或者，同样的，数字。在 asm 中，它使用`and`操作而不是`sub`（如在其他答案中）。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2009-03-10T02:59:49.007

您可以将其转换为 int （或 float 或 double 或您想用它做什么）并将其存储在另一个变量中。

# apache-flex - 离线 RIA 跨平台环境

> ID：628773
> 
> 赞同：2
> 
> 时间：2009-03-10T02:57:58.217
> 
> 标签：apache-flex, flash, silverlight, ria, offline

我想为一些卡片/客厅风格的游戏创建一个简单的类似“记分卡”的机制。诀窍是我希望这是一个视觉刺激的应用程序（WPF/Flash 风格的动画等），最终可以在 Mac、Windows 和一些移动客户端上使用。对框架有什么想法吗？如果我可以离线运行 Silverlight 会很棒，否则它看起来就像 Adob​​e Flex via AIR。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-29T08:17:02.723

如果您更愿意使用 Silverlight，有个好消息：**Silverlight 3**，[现在处于 beta 阶段](http://silverlight.net/getstarted/silverlight3/default.aspx)，希望在不远的将来推出，确实有一个（受限的）离线模式。[这里有一些细节](http://nerddawg.blogspot.com/2009/03/introducing-offline-and-out-of-browser.html)。

如果您相信营销材料，您还应该关注**[JavaFx](http://javafx.com/)**，因为它也在推动移动平台。从我到目前为止所看到的情况来看，它有可能成为另一个死机平台，并且永远不会流行起来。

**[Adobe Air](http://www.adobe.com/products/air/)**，不管有没有 Flex，都会带你离线、跨平台，但不是移动的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-03T12:00:47.583

[Hulu Desktop](http://www.hulu.com/labs/hulu-desktop)的有趣之处在于它本质上是一个捆绑在 Mac 或 Windows 特定应用程序包装器中的 Flash 应用程序。它要求用户已经在他们的计算机上安装了 Flash，但是有 98% 的渗透率，所以我不认为这是一种威慑。这样做的缺点是您必须为您支持的每个操作系统构建和维护一个单独的包装代码库，但优点是您不必要求用户安装 AIR 运行时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-17T22:35:55.307

你的线下需求是什么？如果您不需要从本地文件系统读取文件，flash 和 silverlight 在本地 html 文件中运行良好。Flash通过`SharedObject`类有一个简单的本地存储机制。我不知道silverlight是否有类似的东西。

仅当您需要某些系统权限（例如设置文件关联、完整 IO、系统托盘/停靠集成等）时才需要 Adob​​e AIR。

有一些手机运行 flashlite，这与 actionscript 2.0 几乎相同。所以移植 actionscript 应用程序要容易一些。但是，flashlite 仍然依赖`SharedObject`该类进行持久存储。

**Mac和iphone/ipod touch使用safari浏览器，所以今天**可以使用html`<canvas>`元素+javascript+html5离线存储。Firefox 也支持此功能，适用于 windows、mac 和 linux。在此处查看使用此技术构建的一些游戏：http: [//www.sarkscape.com/games](http://www.sarkscape.com/games)

 **Java 已经存在了很长一段时间。它甚至通过 JOGL 库支持 OpenGL。我不知道游戏的特定库。

唯一真正广泛用于移动设备的编程语言是 j2me，但是，将桌面 Java 应用程序移植到 j2me 并不是那么简单。

JavaFX 仍处于起步阶段，还有很多改进要做，现在还不值得一试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-17T22:38:58.547

由于您既需要移动设备也需要台式机，因此最好的选择似乎是[Titanium](http://www.appcelerator.com/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T03:04:14.317

Adobe Flex via AIR 对我来说似乎是一个不错的方法。Java 可能是另一种方式。

# language-agnostic - 什么时候不使用垃圾收集？

> ID：628782
> 
> 赞同：13
> 
> 时间：2009-03-10T03:00:42.313
> 
> 标签：language-agnostic, memory-management, garbage-collection

不使用垃圾收集的明显情况是硬实时、内存严重受限以及想要使用指针进行位玩弄。是否还有其他一些讨论较少的充分理由让人们更喜欢手动内存管理而不是 GC？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-10T05:32:46.613

如果你有完全增量的垃圾收集器，每个分配的内存字节的执行时间是有限的，那么可以使用硬实时的垃圾收集，所以，够疯狂的，不一定是不使用垃圾收集的理由:)

然而，垃圾收集的一个基本问题是难以估计和管理内存中工作集的实际大小，因为垃圾收集器只能延迟释放内存。所以，是的，当内存受到限制时，垃圾收集可能不是一个好的选择。

垃圾收集的另一个问题是它有时会干扰释放其他资源，例如文件描述符、窗口句柄等，因为垃圾收集器可能只是延迟释放这些资源，从而导致资源匮乏。

垃圾收集也可能导致缓存垃圾，因为内存不一定以本地方式分配。例如，堆栈分配的内存比堆分配的短期对象对缓存更友好。

最后，垃圾收集当然会消耗 CPU 时间 :) 因此，如果您可以手动编写内存管理代码，则可以节省垃圾收集器将消耗的 CPU 周期 :)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T03:07:23.327

暂时的疯狂？

实际上，我所知道的唯一一个您没有涉及的情况是所谓的“基于生命周期的内存管理”，有时称为“池”或“竞技场”或“区域”。这个想法是你要分配大量的对象，可能很小，而且*它们都将立即死亡*。所以你有一个便宜的分配器，然后你在一次自由操作中恢复*所有对象。*

如今，有一些程序分析可以让编译器为您执行此操作，但如果您正在编写 C 代码，则需要手动执行。[Dave Hanson 的C Interfaces and Implementations](http://www.cs.princeton.edu/software/cii/)中有一个带有示例的实现，它用于 Fraser 和 Hanson 的[`lcc`编译器](http://www.cs.princeton.edu/software/lcc/)，它是用 C 编写的，没有垃圾收集器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T03:09:17.970

为资源有限的嵌入式设备编程时。例如，iPhone 使用引用计数。

或者在您的计算机上进行非常密集的编程时。想到 SETI@Home 和视频游戏。

我建议您不要管理自己的记忆，除非情况表明确实有必要。有人曾经说过，代码的调试难度是编写代码的两倍。好吧，首先，内存管理已经够难了。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-10T04:18:28.227

不使用垃圾收集进行资源管理的唯一原因是如果您想使用 RAII ala C++，但由于它纯粹适用于内存，即使那样使用它也是一个合理的想法。（注意：仍然可以这样做，因为问题与非确定性终结有关）。

也就是说，使用垃圾收集可以使用比严格需要更多的内存，因此在内存严重受限的区域，甚至无法腾出内存来管理 GC 例程（和代码），那么这是不使用它的一个很好的理由，也。

此外，如果您使用的语言默认不包含 GC，例如 C++，并且您喜欢使用 RAII，那么这也是一个合理的理由，尽管对于某些问题它可能非常有用。

最终要权衡取舍——您的要求越专业，尤其是在线程安全 RAII 方面，实现 GC 就越复杂，而 GC 可能不会为您的应用程序买太多东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T03:06:50.630

嗯……我教授的理由是让我们（他的学生）的生活更艰难，并教我们“真正的东西”。哈哈 ：）

但总的来说，垃圾收集并不总是针对您的特定应用程序进行优化，因此，如果您是一名优秀的程序员，那么您在内存管理方面肯定会比 GC 做得更好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-11T17:18:59.237

> 是否还有其他一些讨论较少的充分理由让人们更喜欢手动内存管理而不是 GC？

也许最重要的未说出口的问题是 VM 注入的代码以使其与 GC 协调工作。特别是，只要将指针写入堆，所有生产质量的 GC 都会静默地产生写屏障。

例如，以下 F# 程序创建一个包含 10,000 个整数的数组，然后交换它们：

```
do
  let xs = Array.init 10000 int
  let timer = System.Diagnostics.Stopwatch.StartNew()
  for i=0 to xs.Length-2 do
    for j=i+1 to xs.Length-1 do
      let t = xs.[i]
      xs.[i] <- xs.[j]
      xs.[j] <- t
  printfn "%f" timer.Elapsed.TotalSeconds 
```

将其更改`int`为`string`，程序运行速度会慢 2 倍，因为 int 可以直接交换，而交换引用类型必须产生两个写入障碍。

人们喜欢掩盖的另一个重要情况是传统 GC 的病理行为。今天，大多数 GC 都是分代的，这意味着它们会先分配到托儿所，然后将幸存者疏散到老一代（通常是标记清除）。当代际假设（对象死亡年轻而老对象很少引用较新对象）成立时，这很有效，因为当它被有效地清扫时，托儿所中的大多数对象都死了。但是对象并不总是在年轻时死去，老对象有时充满了指向新对象的指针。

特别是，当程序分配一个基于数组的大型可变数据结构（例如哈希表、哈希集、堆栈、队列或堆），然后用新分配的对象填充它时，分代 GC 的病态行为就表现出来了。这些新对象之所以能够幸存，是因为它们是从旧对象中引用的，这完全违反了世代假设。因此，使用 GC 的解决方案通常比此处所需的慢 3 倍。

FWIW，我相信标记区域 GC 有可能在未来规避这些问题。在标记区域 GC 中，老年代是前托儿所的集合。当一个线程局部区域被填满并被发现包含大部分可达对象时，整个区域可以在逻辑上迁移到老年代而不复制任何对象，并且可以分配一个新的托儿所（或者可以回收一个未满的旧托儿所）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T04:57:30.113

如果您有大量很少被释放的对象，那么垃圾收集器将启动并浪费时间来发现只有少数对象需要完成。在极端情况下，这可能会导致巨大的性能损失。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-10T05:11:53.167

出于安全原因如何？例如，如果您在内存中有一个加密私钥，您可能希望它在最短的时间内使用。

话虽如此，我认为硬件的发展方向，学习多线程编程的艺术可能更值得学习。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-11-09T13:56:25.600

一个可能的答案是，“安全/系统稳定性不是主要要求”。

请记住，自由支配内存的应用程序可能会导致各种安全问题，包括简单地分配和不释放内存（DoS 攻击通过因可用内存资源不足而使系统停滞不前）。例如，这是 Java 安全模型的核心部分——它的 GC 确保这永远不会发生。

与 Jon Harrop 一样，我的观点是 GC 出于多种原因增加了系统性能的开销（在此处的其他答案中有所说明）；它更间接但更安全，并且将内存管理的责任从应用程序开发人员手中移开；但是安全网络总是有性能成本。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-05-07T17:30:21.450

## 垃圾收集与泄漏

我避免垃圾收集的主要原因之一是避免在泄漏严重的区域发生资源泄漏。当您的目标是安全和简单时，垃圾收集非常有用，但不是为了避免软件泄漏。

**我们在使用 GC 时遇到的一个常见情况是，它很难避免资源泄漏。**

现在这可能会让一些人感到困惑，并且似乎自相矛盾地认为垃圾收集与不太理想的团队实践相结合会导致软件泄漏，但软件中资源的非平凡管理并不在于与有限范围绑定的资源，但那些挥之不去的顽固者。

## 复杂的资源管理

这种复杂性的一个例子是 3D 软件中的场景图，其中包含数百万行代码以及数千个通过事件相互交互的对象和类。

在这些情况下，这些持久对象通常存储系统中资源的句柄/引用，可能还有其他存在于持久场景图中的对象。在这种情况下，您可以拥有一个中央资源，`R`例如需要数百兆 RAM 的复杂 3D 模型，由场景和用户界面的许多不同部分访问。例如，相机和灯光对象都可能存储对要从相机视图和照明系统中排除的对象的引用列表，其中可以包括此类复杂的 3D 模型。

`R`在这些情况下，在团队环境中，3 个独立的开发人员编写代码在代码中的数十个不同位置存储持久句柄/引用的情况并不少见。当用户删除`R`时，*所有*这些地方都应该释放句柄/引用。

*没有*垃圾收集，如果其中一个人没有这样做（也许他/她今天过得很糟糕，是经验不足的开发人员之一，处于高压的最后期限紧缩状态，测试和审查标准更宽松，不管是什么原因） ，留下一个悬空*指针/句柄/引用*。访问它会使应用程序因段错误而*崩溃*。使用调试器跟踪这样的段错误通常会立即揭示它发生的位置和原因。

*使用*垃圾收集，除了长时间运行软件会继续泄漏越来越多的资源外，不会发生任何明显的事情。因为其中一个地方忘记释放引用，永久延长其生命周期，并在有效、未销毁的状态下继续使用它，所以软件不仅可能会继续增加内存使用量，而且运行时间越长，速度也会越来越慢它处理用户不再可见的隐藏对象。

## 崩溃还是不崩溃

在这些类型的情况下，有时可以在测试期间立即捕获和处理由该错误导致的明显且明显的崩溃实际上*比*无声且非常难以发现的资源泄漏更可取，这可能是追查的噩梦，并且可能永远不会被修复。

因此，如果您正在从事这样一个项目，其中在测试期间立即明显且可纠正的崩溃实际上可能比经常在测试雷达下飞行并出现此类错误的泄漏软件更可取，垃圾收集，除非它结合非常仔细的编码标准和每个团队成员都意识到要注意它的陷阱（例如，需要弱引用或虚引用），实际上弊大于利。对我来说，垃圾收集最适合更小、更紧密的团队和项目，这些团队和项目实际上在状态/资源管理方面具有*更高*而不是更低的专业知识水平，或者此类资源泄漏没有崩溃那么严重的项目。

从开发人员的角度来看，一个明显的、暴露在你面前的、引人注目的错误通常比非常微妙、隐藏*的“没有人知道发生了什么，但发生了不好的事情”更可取*种错误。它通常说明您的调试器告诉您发生了什么与盲目地试图在数百万行代码的大海捞针中寻找针头之间的区别。在大型系统中管理资源是最难做到的事情之一，而垃圾收集实际上并没有让这变得更容易。崩溃还是不崩溃，这是个问题，在这些场景中，我们经常看到没有 GC 的悬空句柄崩溃或随之而来的神秘资源泄漏。在处理潜在巨大资源的性能关键型应用程序中，这种泄漏通常是不可接受的。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-03-10T03:09:42.243

当您构建高性能应用程序（例如第一人称射击游戏）时，您不希望 GC 可能会影响应用程序的执行。手动管理这些应用程序中的内存可让您决定释放资源的正确时间。

# c# - 创建通用类型列表的解决方法 并用派生类填充它？

> ID：628783
> 
> 赞同：2
> 
> 时间：2009-03-10T03:00:58.287
> 
> 标签：c#, generics, inheritance

我想创建一个列表并将派生类添加到此列表中。

我在这里看到这在 .NET 中是不可能通过设计实现的：http: [//msdn.microsoft.com/en-us/library/aa479859.aspx#fundamentals_topic12](http://msdn.microsoft.com/en-us/library/aa479859.aspx#fundamentals_topic12)

那么对此的最佳实践解决方案是什么？我想我可以将派生类装箱，使它们看起来像我的超类，但这感觉有点笨拙。我想我应该以不同的方式设计我的课程....但是如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T03:09:24.133

如果我了解您要做什么，那么您应该可以做得很好。

```
List<SuperClass> myList = new List<SuperClass>();

SubClass item1 = new SubClass();
SuperClass item2 = new SuperClass();

myList.add(item1);
myList.add(item2); 
```

这是有效的代码，然后您可以轻松地从列表中检索元素，并使用多态性的基本规则相应地更改对象的类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T04:51:09.083

正如[布赖恩所说](https://stackoverflow.com/questions/628783/workaround-for-creating-a-generic-list-of-typesuperclass-and-populate-it-with-der/628808#628808)，这应该可以正常工作。人们在这个领域看到的唯一常见限制是列表作为方法参数的协方差 - 即他们发现他们无法将 a 传递`List<Dog>`给接受 a 的方法`List<Animal>`。在这种情况下，答案是泛型：

```
public void Foo<T>(IList<T> list) where T : Animal {...}
....
List<Dog> dogs = ...
Foo(dogs); // implicit <Dog> 
```

有关协方差的更多讨论（包括*不*改变上述场景的 C# 4.0 更改，[请参见此处](http://marcgravell.blogspot.com/2009/02/what-c-40-covariance-doesn-do.html)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T03:09:50.293

那会很好用。虽然您不会知道列表中某个项目的确切类型（不进行强制转换），但将派生类型添加到基本类型的集合中没有问题。

本文链接的内容是您尝试将派生类型的集合用作基类型的集合的情况：

```
void DisplayFruit(List<Fruit> fruit)
{
    fruit.ForEach(f => Console.WriteLine(f.ToString()));
}

List<Apples> apples = new List<Apples>();
// add apples here

DisplayFruit(apples); //Error! 
```

如果将苹果声明为 a `List<Fruit>`，它将起作用。

# c++ - 对 C++ 哈希表有一个好的哈希函数吗？

> ID：628790
> 
> 赞同：35
> 
> 时间：2009-03-10T03:02:54.600
> 
> 标签：c++, hash, hashtable

我需要 C++ 中面向性能的哈希函数实现，用于我将编码的哈希表。我已经环顾四周，只发现“一般”的问题是什么是好的散列函数。我考虑过 CRC32（但是在哪里可以找到好的实现呢？）和一些密码算法。不过，我的桌子有非常具体的要求。

下面是表格的样子：

```
100,000 items max
200,000 capacity (so the load is 0.5)
hashing a 6-character string which is a part of English sentence
     examples: "become"    "and he"    ", not " 
```

我的哈希表的*第一要务*是快速搜索（检索）。快速插入并不重要，但它会伴随着快速搜索而来。删除并不重要，我不会研究重新散列。为了处理冲突，我可能会使用[此处](http://eternallyconfuzzled.com/tuts/datastructures/jsw_tut_hashtable.aspx)描述的*单独链接*。我已经看过[这篇文章](http://eternallyconfuzzled.com/tuts/algorithms/jsw_tut_hashing.aspx)，但想听听那些以前处理过此类任务的人的意见。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-10T03:37:22.740

现在假设你想要一个哈希，并且想要一些在你的情况下可以工作的**快速**的东西，因为你的字符串只有 6 个字符长，你可以使用这个魔法：

```
size_t precision = 2; //change the precision with this
size_t hash(const char* str)
{
   return (*(size_t*)str)>> precision;
} 
```

CRC 用于慢动作 ;)

**说明：** 这通过将字符串指针的内容转换为“看起来像”一个 size_t（int32 或 int64 基于您的硬件的最佳匹配）来工作。因此，字符串的内容被解释为原始数字，不再担心字符，然后您将其移位所需的精度（您将此数字调整为最佳性能，我发现 2 适用于散列字符串一套几千）。

此外，真正整洁的部分是现代硬件上的任何体面的编译器都会在 1 条汇编指令中散列这样的字符串，很难打败它；）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-10T06:36:42.073

这个简单的多项式工作得非常好。我从 Microsoft Research 的 Paul Larson 那里得到它，他研究了各种散列函数和散列乘法器。

```
unsigned hash(const char* s, unsigned salt)
{
    unsigned h = salt;
    while (*s)
        h = h * 101 + (unsigned) *s++;
    return h;
} 
```

`salt`应该在创建哈希表之前将其初始化为一些*随机*选择的值，以防御[哈希表攻击](http://www.georgevreilly.com/blog/2009/03/02/HashTableAttacks.html)。如果这对您来说不是问题，请使用 0。

表的大小也很重要，以尽量减少冲突。听起来你的很好。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-10T03:10:36.313

[Boost.Functional/Hash](http://www.boost.org/doc/libs/1_38_0/doc/html/hash.html)可能对你有用。我没有尝试过，所以我不能保证它的性能。

Boost 还有一个[CRC 库](http://www.boost.org/doc/libs/1_38_0/libs/crc/index.html)。

我会先看一个[Boost.Unordered](http://www.boost.org/doc/libs/1_38_0/doc/html/unordered.html)（即 boost::unordered_map<>）。它对容器使用哈希映射而不是二叉树。

我相信一些 STL 实现在 stdext 命名空间中有一个 hash_map<> 容器。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-10T03:17:31.617

你的表的大小将决定你应该使用什么大小的散列。当然，您希望尽量减少碰撞。我不确定您通过最大项目和容量指定了什么（它们对我来说似乎是同一件事）在任何情况下，这些数字中的任何一个都表明 32 位哈希就足够了。您可能会摆脱 CRC16（约 65,000 种可能性），但您可能需要处理很多冲突。另一方面，冲突可能比 CRC32 哈希处理得更快。

我会说，选择 CRC32。您会发现不乏文档和示例代码。由于您已经确定了最大值并且速度是优先事项，因此请使用指针数组。使用哈希生成索引。碰撞时，增加索引直到你碰到一个空桶..快速而简单。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-10T03:53:25.417

由于您存储英文单词，因此您的大多数字符都是字母，并且数据的最重要两位不会有太大变化。除此之外，我会保持它非常简单，只使用 XOR。毕竟，您不是在寻找加密强度，而只是在寻找合理均匀的分布。这些方面的东西：

```
size_t hash(const std::string &data) {
  size_t h(0);
  for (int i=0; i<data.length(); i++)
    h = (h << 6) ^ (h >> 26) ^ data[i];
  }
  return h;
} 
```

除此之外，您是否将 std::tr1::hash 视为哈希函数和/或将 std::tr1::unordered_map 视为哈希表的实现？与实现自己的类相比，使用这些可能会节省很多工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-10T03:12:01.117

如果您需要搜索短字符串并且插入不是问题，也许您可​​以使用 B-tree 或 2-3 树，在您的情况下通过散列不会获得太多收益。

这样做的方法是在每个节点中放置一个字母，因此首先检查节点“a”，然后检查“a”的子节点是否为“p”，它是“p”的子节点，然后是“ l”，然后是“e”。在你有“apple”和“apply”的情况下，你需要寻找最后一个节点，（因为唯一的区别是最后一个“e”和“y”）

但是在大多数情况下，您只需几步（“xylophone”=>“x”->“ylophone”）就可以得到单词，因此您可以像这样优化。这可能比散列更快

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-10T03:25:08.447

> 我的哈希表的第一要务是快速搜索（检索）。

那么您使用的是正确的数据结构，因为在哈希表中搜索是 O(1)！:)

CRC32 应该没问题。实现并不复杂，它主要基于 XOR。只要确保它使用一个好的多项式。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-10T03:27:24.603

简单的事情怎么样：

```
// Initialize hash lookup so that it maps the characters
// in your string to integers between 0 and 31
int hashLookup[256];

// Hash function for six character strings.
int hash(const char *str)
{
    int ret = 0, mult = 1;
    for (const char *p = str; *p; *p++, mult *= 32) {
        assert(*p >= 0 && *p < 256);
        ret += mult * hashLookup[*p];
    }

    return ret;
} 
```

这假定 32 位整数。它每个字符使用 5 位，因此哈希值中只有 30 位。也许，您可以通过为前一个或两个字符生成六位来解决此问题。如果你的字符集足够小，你可能不需要超过 30 位。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-12-05T15:09:42.847

从 C++11 开始，C++ 提供了一个[`std::hash< string >( string )`](http://en.cppreference.com/w/cpp/string/basic_string/hash). 这可能是一个高效的散列函数，可为大多数字符串提供[良好的散列码分布。](https://en.cppreference.com/w/cpp/named_req/Hash)

此外，如果您正在考虑实现哈希表，那么您现在应该考虑使用 C++ [`std::unordered_map`](http://en.cppreference.com/w/cpp/container/unordered_map)。

# opengl - glLoadIdentity() 在 OpenGL 中做了什么？

> ID：628796
> 
> 赞同：141
> 
> 时间：2009-03-10T03:04:35.877
> 
> 标签：opengl, graphics

我是 OpenGL 的新手，我对代码中的所有随机函数有点不知所措。它们可以工作，我知道何时使用它们，但我不知道我为什么需要它们或它们实际上做了什么。

我知道`glLoadIdentity()`用单位矩阵替换当前矩阵，但它到底是做什么的呢？如果每个程序都需要它，除非另有说明，否则为什么默认情况下不使用单位矩阵？我不喜欢在我的代码中包含函数，除非我知道它们是做什么的。我应该注意，我专门为丰富的 2D 客户端使用 OpenGL，所以如果这对于 3D 来说非常明显，请原谅我的无知。

`glMatrixMode(GL_PROJECTION)`对VS也有点困惑`glMatrixMode(GL_MODELVIEW)`。

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2009-03-10T17:46:06.163

就投影和模型视图矩阵而言，单位矩阵本质上将矩阵重置回其默认状态。

如您所愿，`glTranslate`并且`glRotate`始终与矩阵的当前状态相关。因此，例如，如果您调用`glTranslate`，您是从矩阵的当前“位置”转换，而不是从原点转换。但是如果你想从原点重新开始，那就是你调用的时候`glLoadIdentity()`，然后你可以`glTranslate`从现在位于原点`glRotate`的矩阵，或者从现在以默认方向定向的矩阵。

我认为 Boon 的答案，它相当于 1，并不完全正确。矩阵实际上是这样的：

```
1 0 0 0
0 1 0 0
0 0 1 0
0 0 0 1 
```

那就是单位矩阵。Boon 在数学上是正确的，任何矩阵乘以该矩阵（或看起来像这样的矩阵；对角线的矩阵，其他都是 0）都会产生原始矩阵，但我不相信他解释了为什么这很重要。

这很重要的原因是因为 OpenGL 通过每个矩阵乘以所有位置和旋转；因此，例如，当您绘制一个多边形（`glBegin(GL_FACE)`，一些点，`glEnd()`）时，它会通过将其与 MODELVIEW 相乘来将其转换为“世界空间”，然后通过将其与 PROJECT 矩阵相乘将其从 3D 转换为 2D，并给出它屏幕上的 2D 点以及用于绘制像素的深度（来自屏幕“相机”）。但是当这些矩阵之一是单位矩阵时，点与单位矩阵相乘，因此不会改变，所以矩阵没有效果；它不会平移这些点，也不会旋转它们，而是让它们保持原样。

我希望这能澄清一点！

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-03-10T03:15:48.063

单位矩阵相当于数字的 1。如您所知，任何乘以 1 的数字就是它本身`(e.g. A x 1 = A)`，

矩阵也是如此`( MatrixA x IdentityMatrix = MatrixA)`。

因此，加载单位矩阵是一种在将更多矩阵乘入矩阵堆栈之前将矩阵初始化为正确状态的方法。

`glMatrixMode(GL_PROJECTION)`：处理透视变换或正交变换使用的矩阵。

`glMatrixMode(GL_MODELVIEW)`：处理模型视图转换使用的矩阵。也就是说，将您的对象（又名模型）转换为视图坐标空间（或相机空间）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-05-08T16:58:47.997

投影矩阵用于创建您的查看体积。想象现实世界中的一个场景。你并没有真正看到你周围的一切，只有你的眼睛让你看到的东西。例如，如果你是一条鱼，你会看到更广泛的事物。所以当我们说我们设置了投影矩阵时，我们的意思是我们设置了我们想要从我们创建的场景中看到的东西。我的意思是你可以在你世界的任何地方绘制物体。如果它们不在视图体积内，您将看不到任何东西。当您创建视图体积时，想象您创建了 6 个裁剪平面来定义您的视野。

至于模型视图矩阵，它用于对您世界中的模型（对象）进行各种转换。像这样，您只需定义一次对象，然后平移或旋转或缩放它。

您将在场景中绘制对象之前使用投影矩阵来设置视图体积。然后绘制对象并相应地更改模型视图矩阵。当然，您可以在绘制模型的中途更改矩阵，例如，如果您想绘制场景然后绘制一些文本（使用某些方法可以在正交投影中更轻松地工作），然后改回模型视图矩阵。

至于名称 modelview，它与建模和查看转换的二元性有关。如果将相机向后拉 5 个单位，或者将对象向前移动 5 个单位，则基本相同。

希望我能有所启发

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-10T17:52:44.663

单位矩阵用于将矩阵“初始化”为合理的默认值。

要意识到的一件重要的事情是矩阵乘法在某种意义上是加法的。例如，如果您采用以单位矩阵开头的矩阵，将其乘以旋转矩阵，然后将其乘以缩放矩阵，您最终会得到一个矩阵，该矩阵会旋转并缩放与其相乘的矩阵。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-12-13T10:33:14.063

回顾一下其他人所说的话，单位矩阵是这样的矩阵，当您将向量/矩阵与它相乘时，结果是相同的向量/矩阵。它相当于数字 1 的乘法或数字 0 的加法。

glLoadIdentity() 是一个已弃用的函数，我们鼓励您管理自己的矩阵。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-03-27T18:12:39.143

`glLoadIdentity()`函数保证每次我们进入投影模式时，矩阵都会被重置为单位矩阵，这样新的观看参数就不会和之前的合并。

# java - 将Java版本从一台PC复制到另一台PC而不是安装它会不会有任何问题

> ID：628800
> 
> 赞同：2
> 
> 时间：2009-03-10T03:05:51.113
> 
> 标签：java, versions

我想将当前 Java 1.6 更新 11 中的目录和子目录嵌入到我将在其他几台 PC 上安装的软件包中，并且想知道这样做的缺点是什么（如果有的话）。我想这样做，这样我的 Java 版本就不会覆盖 PC 上的其他版本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T03:15:25.537

在 Linux 上，没有问题。在 Windows 上，如果您通过将路径和 JAVA_HOME 设置为目录来使用 JDK/JRE，应该不会有任何问题。但是，如果不弄乱注册表，您将无法使用小程序插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T03:17:44.270

我见过一些软件这样做（即：将 JRE 与软件打包），这种方法的主要缺点是您的包较大，它破坏了使用 JRE 的一个很好的理由（事实上它是 widley分散式）。

您为什么担心在现有的 JRE 上安装更新的 JRE？JRE 应该向后兼容。如果这是您的动机，我会考虑安装新的 JRE，而不是按照您建议的方式进行打包，因为不应该存在任何向后兼容性问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T14:36:04.183

感谢您的回复；我想使用这种方法的原因是因为我的一个应用程序不适用于高于 1.6u11 的 Java 版本；如果用户将 Java 的自动更新设置为开启，或者他/她决定升级到更高版本，那将破坏我仅适用于 Java 1.6u11 的其他应用程序。通过在我的应用程序安装中嵌入 jre 文件/文件夹结构并使用该版本的 Java 指向 ini 文件来执行应用程序，我将确保该版本是应用程序使用的版本，而不是在 JAVA_HOME 中定义的版本，无论是哪个（高于或低于 1.6u11）。

任何评论都非常受欢迎。

# c# - 委托用法：业务应用程序

> ID：628803
> 
> 赞同：5
> 
> 时间：2009-03-10T03:06:58.710
> 
> 标签：c#, .net, asp.net, delegates

### 背景

鉴于“大多数”开发人员都是业务应用程序开发人员，我们最喜欢的编程语言的特性在我们正在使用它们的上下文中使用。

作为 C#/ASP.NET 应用程序开发人员，我倾向于只在处理 UI 事件时使用委托。事实上（这是我缺乏经验的一部分），*除了使用代表的事件之外，我什至不知道一个好的上下文！* 这很可怕；但我收集到在同一条船上还有其他开发人员。

**注意**：答案应该与 .NET 2.0 有关。.NET 3.0 将代表完全带到了一个不同的级别，这可能是一个单独的问题。

### 问题：

> 除了事件之外，委托有多有用，在哪些业务应用程序上下文中它们最有用？

**更新**：[Jarrod Dixon帮助](https://stackoverflow.com/users/3/jarrod-dixon) [链接](http://twitter.com/jarrod_dixon/status/1303756483)到 MSDN 文档[关于委托使用](http://msdn.microsoft.com/en-us/library/ms173173(VS.80).aspx)，我必须承认我[最喜欢的设计模式书](http://oreilly.com/catalog/9780596007126/)根本没有提出委托，所以除了 UI 事件之外，我还没有真正看到它们在使用中。为了扩展这个问题（只是一点点！），您可以为业务应用程序（或者实际上，任何必须处理相关问题的应用程序）提供哪些示例，以便更容易消化有关该主题的 MSDN 文档？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T03:19:23.250

我认为这个问题反映了给猫剥皮的多种方法。我发现委托（和 lambda）几乎与“for”循环一样基本。

这是我最近使用代表的一种情况（出于演示目的而更改了格式和名称：）

```
protected T[] SortLines<T>(Func<T> createLine, IEnumerable<T> unsorted)
where T : LineType
{
    Func<IEnumerable<T>, IEnumerable<T>> sorter = (lines => lines);

    switch (settings.OrderSort)
    {
        case OrderSort.ByA: 
            sorter = (lines => lines.OrderBy(x => x.A)); break;
        case OrderSort.ByB:
            sorter = (lines => lines.OrderBy(x => x.B)); break;

        // and so on... a couple cases have several levels of ordering
    }

    bool requiresSplit = // a complicated condition
    if (requiresSplit)
    {
        var positives = unsorted.Where(x => x.Qty >= 0);
        var negatives = unsorted.Where(x => x.Qty <  0);

        return sorter(negatives).Concat(
               new T[] { createLine.Invoke() }).Concat(
               sorter(positives)).ToArray();
    }
    else
        return sorter(unsorted).ToArray();
} 
```

因此，这会根据某些标准对一组项目进行排序，然后它要么返回已排序的整个列表，要么将其分成两部分，分别对两半进行排序，并在它们之间放置一个分隔符。如果你不能表达“一种排序方式”的概念，那么祝你好运，这就是委托的目的。

编辑：我猜 Concat 和 OrderBy 是特定于 3.0 的，但这仍然是基本思想。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T03:12:45.530

除了图形...

1.  事件调度；我的一些业务应用程序非常复杂，与硬件设备通信，并依靠事件队列来保持一切同步。这些应用程序使用委托来进行事件分派。
2.  商业规则; 我的一些业务应用程序具有部分软编码能力，其中某些事件会触发保存在数据库中的某些规则。委托（在字典中）用于在客户端执行规则。（可以支持插件，但不需要电流）。
3.  通用辅助线程（当然是使用 SafeThread 类！）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T03:20:27.727

据我所知，.NET 委托本质上是单方法接口的实现，没有所有的类声明。我希望我们在 Java 中拥有它们，就个人而言。考虑一个比较器类：

```
class MyComparator<Circle> extends Comparator<Circle> {
    public int compare(Circle a, Circle b) {
        return a.radius - b.radius;
    }
} 
```

在这种模式有用的任何地方，委托都可能有用。

我希望我是对的，但如果我错了，请继续投票给我；我已经很久没有看到任何 C# 了:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-10T06:12:12.307

委托的另一个重要用途是作为状态机。如果您的程序逻辑包含重复的 if...then 语句来控制它所处的状态，或者如果您正在使用复杂的 switch 块，您可以轻松地使用它们来复制状态模式。

```
enum State {
  Loading,
  Processing,
  Waiting,
  Invalid
}

delegate void StateFunc();

public class StateMachine  {
  StateFunc[] funcs;   // These would be initialized through a constructor or mutator
  State curState;

  public void SwitchState(State state)  {
    curState = state;
  }

  public void RunState()  {
    funcs[curState]();
  }
} 
```

我的 2.0 委托语法可能生锈了，但这是状态调度程序的一个非常简单的示例。还要记住，C# 中的委托可以执行多个函数，允许您拥有一个状态机，每个 RunState() 执行任意多个函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T03:12:51.690

每当您执行任何异步操作时，例如进行 web 服务调用，您都可以使用委托，因此当调用返回时，您可以发起委托调用，以便目标处理事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-10T03:56:13.100

多年来我看到的一种常见模式（在各种语言中）是“冻结”将逻辑从循环中移到设置中的决定的结果。在伪代码中（因为技术因语言而异）：

```
some_condition = setup_logic
...
while (not terminated) {
    data = obtain_data
    if (some_condition)
        process_one (data)
    else
        process_two (data)
} 
```

关键是如果`some_condition`不根据循环中的任何内容进行更改，那么重复测试它确实没有任何好处。代表/关闭/等。允许将上述内容替换为：

```
some_condition = setup_logic
if (some_condition)
    selected_process = process_one
else
    selected_process = process_two
...
while (not terminated) {
    data = obtain_data
    selected_process (data)
} 
```

（当然，真正的函数式程序员会将设置编写为：

```
selected_process = if (some_condition) process_one else process_two 
```

;-)

这很好地概括了多种选择（而不仅仅是两个）。关键思想是提前决定在未来一个（或多个）点采取什么行动，然后记住选择的*行动*，而不是决策所基于的*价值。*

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-10T04:26:57.707

当您开始将委托视为功能构造时，委托会变得非常强大

.Net 2.0 包括对匿名委托的支持，这构成了 Linq 扩展的一些功能概念的核心。匿名委托的语法比 Lambda 提供的要大一些，但很多核心功能模式都在 2.0 中。

在 List 泛型类型中，您可以使用以下项目：

1.  ConvertAll() - 使用委托将列表的所有成员转换为另一种类型 (T)。这基本上是一个映射函数的实现
2.  Find() 和 FindAll 都接受委托，并且将返回单个项目（在 Find() 的情况下）或导致传入的委托评估为真的所有项目。这提供了一个过滤器函数，以及一个谓词的定义（一个计算为布尔值的函数）
3.  有一个 ForEach() 方法的实现，它接受一个委托。允许您对列表中的每个元素执行任意操作。

Appart from List specific items，当您使用匿名委托上下文得到正确处理时，您可以实现类似闭包的结构。或者，在更实际的层面上做类似的事情：

```
ILog logger = new Logger();
MyItemICareAbout.Changed += delegate(myItem) { logger.Log(myItem.CurrentValue); }; 
```

它只是工作。

还有 DynamicMethod 的东西，它允许您定义 IL 位（使用 Reflection.Emit），并将它们编译为委托。这为您提供了一个很好的替代纯反射的方法，例如映射层和数据访问代码。

委托实际上是一种允许您将可执行代码表示为数据的结构。一旦你明白这意味着什么，就有很多事情可以做。与 3.5 相比，2.0 中对这些构造的支持是基本的，但仍然存在，并且仍然非常强大。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-10T05:58:42.913

委托通常用于事件调度，但这只是因为它们这样做很方便。委托对任何类型的方法调用都很有用。它们还具有许多附加功能，例如异步调用的能力。

委托的基本原因是提供一个[Closure](http://en.wikipedia.org/wiki/Closure_(computer_science))或调用函数及其状态的能力，这通常是一个对象实例。

# php - 动态页面标题

> ID：628816
> 
> 赞同：0
> 
> 时间：2009-03-10T03:11:56.047
> 
> 标签：php, mysql, html

我有这个页面标题类：

```
class UI {

    private static $title;

    public static function getTitle() { return self::$title; }
    public static function setTitle($value) { self::$title = $value; }
    } 
```

因此，在我的首页中，我简单地声明了这一点：

```
UI::setTitle('Kiubbo.com :: Todas las Noticias, Fotos y Videos'); 
```

并且工作正常。问题是让评论页面标题根据内容（链接标题）而改变。我想与此变量相同（具有相同的名称，但对于另一个函数，它与 getTitle 不同）：

```
<?php echo $article->getTitle(); ?> 
```

它在这个功能中：

```
function showAllComments($article_id, $param)
    {

        $article = Article::getById($article_id);

        if(!empty($article))
        {
            ?>
            <div class="news_item">
                <h2 class="news_item_title"><b><a href = "<?php echo $article->getUrl(); ?>"><?php echo $article->getTitle(); ?></a></b></h2>              

            </div> 
```

如果有人可以帮助我很感激。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T03:31:49.070

我不确定我是否完全理解你想要做什么。如果您希望每个对象都有一个单独的标题，那么您需要使标题变量非静态（以及函数非静态）。静态变量/函数每个类只有一个实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T04:09:46.267

将“ $article->getTitle() ”更改为“ UI::getTitle() ”，它应该可以工作，但我认为这不是你真正想要做的，是吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T09:09:46.137

也许`showAllComments()`你可以做

```
UI::setTitle($article->getTitle()); 
```

# network-programming - 一个程序与其他程序或其他计算机对话时叫什么

> ID：628825
> 
> 赞同：4
> 
> 时间：2009-03-10T03:14:55.850
> 
> 标签：network-programming

作为一名真正的初学者，人们经常会发现进一步了解的障碍是不知道要谷歌什么。

我已经制作了像 pong 和数独求解器这样的简单程序。这些天来，我想做一些更像 tabslock 或制作多人乒乓球的东西，或者至少开始考虑这会涉及到什么。

那么当程序导致其他程序这样做或那样做时，或者当一个程序与这个庞大互联网中其他地方的另一台计算机上的自身副本进行对话时，它到底被称为什么。

z。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-10T03:16:19.047

我希望搜索服务器/客户端示例和一般的套接字编程将使您朝着正确的方向前进。

例如，谷歌搜索[`socket client server c`](http://www.google.com/search?hl=en&q=socket+client+server+c)将带您进入[An Introduction to Socket Programming](http://www.uwo.ca/its/doc/courses/notes/socket/)。

一个类似的搜索[`socket client server java`](http://www.google.com/search?hl=en&q=socket+client+server+java)让你上一[堂关于套接字通信的课](http://java.sun.com/developer/onlineTraining/Programming/BasicJava2/socket.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-10T03:18:00.337

网络通讯、TCP/IP通讯等

尝试在谷歌上搜索“socket server examples in”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-10T05:14:15.300

我认为从广义上讲，您是在谈论[进程间通信](http://en.wikipedia.org/wiki/Interprocess_communication)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-10T03:20:36.290

当前的帖子很好，远程方法调用 (RMI) 或 Web 服务，SOAP 也可能有用。还有远程过程调用 (RPC)，如 XML-RPC。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-10T03:34:45.210

*   *套接字*是操作系统中用于运行程序（进程）以进行通信的逻辑插槽。
*   *协议*是这种通信双方同意的语言、编码等，用于理解数据。
*   *远程过程调用*或 RPC 是当一个地方的一个进程导致另一个地方的另一个进程运行一些代码时，就好像一个人刚刚在另一个地方调用了一个函数。这可以通过网络完成。
*   *例如， XML-RPC*和*SOAP*是用于在 Web 上执行 RPC 的两种协议。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-10T12:09:01.387

**SkyNet**或者，如果您愿意，可以选择**Colossus/Guardian**。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T04:12:40.907

仅使用套接字的点对点网络怎么样？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-10T04:54:29.560

在更一般的意义上，您可能想查找“面向服务的体系结构”（SOA）服务是一个程序，一台机器上的给定服务可以与其他机器上的其他服务进行通信。

# python - 如何将一组重叠范围划分为非重叠范围？

> ID：628837
> 
> 赞同：15
> 
> 时间：2009-03-10T03:21:07.990
> 
> 标签：python, algorithm, math, range, rectangles

假设您有一组范围：

*   0 - 100：“一”
*   0 - 75：'b'
*   95 - 150：'c'
*   120 - 130：'d'

显然，这些范围在某些点重叠。您将如何剖析这些范围以生成不重叠范围的列表，同时保留与其原始范围相关的信息（在这种情况下，范围后面的字母）？

例如，上面运行算法后的结果将是：

*   0 - 75：'a'，'b'
*   76 - 94：'一个'
*   95 - 100：'a'，'c'
*   101 - 119：'c'
*   120 - 130：'c'，'d'
*   131 - 150：'c'

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-10T03:32:48.477

在编写混合（部分重叠）音频样本的程序时，我遇到了同样的问题。

我所做的是将“开始事件”和“停止事件”（针对每个项目）添加到列表中，按时间点对列表进行排序，然后按顺序处理。您可以这样做，除了使用整数点而不是时间，而不是混合声音，您将向与范围相对应的集合中添加符号。无论您是生成空范围还是忽略它们都是可选的。

`Edit`也许一些代码...

```
# input = list of (start, stop, symbol) tuples
points = [] # list of (offset, plus/minus, symbol) tuples
for start,stop,symbol in input:
    points.append((start,'+',symbol))
    points.append((stop,'-',symbol))
points.sort()

ranges = [] # output list of (start, stop, symbol_set) tuples
current_set = set()
last_start = None
for offset,pm,symbol in points:
    if pm == '+':
         if last_start is not None:
             #TODO avoid outputting empty or trivial ranges
             ranges.append((last_start,offset-1,current_set))
         current_set.add(symbol)
         last_start = offset
    elif pm == '-':
         # Getting a minus without a last_start is unpossible here, so not handled
         ranges.append((last_start,offset-1,current_set))
         current_set.remove(symbol)
         last_start = offset

# Finish off
if last_start is not None:
    ranges.append((last_start,offset-1,current_set)) 
```

显然，完全未经测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-10-18T02:50:29.487

对 Edmunds 的类似回答，经过测试，包括对 (1,1) 等间隔的支持：

```
class MultiSet(object):
    def __init__(self, intervals):
        self.intervals = intervals
        self.events = None

    def split_ranges(self):
        self.events = []
        for start, stop, symbol in self.intervals:
            self.events.append((start, True, stop, symbol))
            self.events.append((stop, False, start, symbol))

        def event_key(event):
            key_endpoint, key_is_start, key_other, _ = event
            key_order = 0 if key_is_start else 1
            return key_endpoint, key_order, key_other

        self.events.sort(key=event_key)

        current_set = set()
        ranges = []
        current_start = -1

        for endpoint, is_start, other, symbol in self.events:
            if is_start:
                if current_start != -1 and endpoint != current_start and \
                       endpoint - 1 >= current_start and current_set:
                    ranges.append((current_start, endpoint - 1, current_set.copy()))
                current_start = endpoint
                current_set.add(symbol)
            else:
                if current_start != -1 and endpoint >= current_start and current_set:
                    ranges.append((current_start, endpoint, current_set.copy()))
                current_set.remove(symbol)
                current_start = endpoint + 1

        return ranges

if __name__ == '__main__':
    intervals = [
        (0, 100, 'a'), (0, 75, 'b'), (75, 80, 'd'), (95, 150, 'c'), 
        (120, 130, 'd'), (160, 175, 'e'), (165, 180, 'a')
    ]
    multiset = MultiSet(intervals)
    pprint.pprint(multiset.split_ranges())

[(0, 74, {'b', 'a'}),
 (75, 75, {'d', 'b', 'a'}),
 (76, 80, {'d', 'a'}),
 (81, 94, {'a'}),
 (95, 100, {'c', 'a'}),
 (101, 119, {'c'}),
 (120, 130, {'d', 'c'}),
 (131, 150, {'c'}),
 (160, 164, {'e'}),
 (165, 175, {'e', 'a'}),
 (176, 180, {'a'})] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T03:25:59.537

我会说创建一个端点列表并对其进行排序，还可以通过起点和终点索引范围列表。然后遍历排序的端点列表，并为每个端点检查范围以查看哪些端点在该点开始/停止。

这可能在代码中更好地表示......如果您的范围由元组表示：

```
ranges = [(0,100,'a'),(0,75,'b'),(95,150,'c'),(120,130,'d')]
endpoints = sorted(list(set([r[0] for r in ranges] + [r[1] for r in ranges])))
start = {}
end = {}
for e in endpoints:
    start[e] = set()
    end[e] = set()
for r in ranges:
    start[r[0]].add(r[2])
    end[r[1]].add(r[2])
current_ranges = set()
for e1, e2 in zip(endpoints[:-1], endpoints[1:]):
    current_ranges.difference_update(end[e1])
    current_ranges.update(start[e1])
    print '%d - %d: %s' % (e1, e2, ','.join(current_ranges)) 
```

虽然回想起来，如果没有更有效（或至少看起来更干净）的方法来做到这一点，我会感到惊讶。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T04:07:40.170

你描述的是集合论的一个例子。有关计算集合的并集、交集和差集的通用算法，请参见：

[www.gvu.gatech.edu/~jarek/graphics/papers/04PolygonBooleansMargalit.pdf](http://www.gvu.gatech.edu/~jarek/graphics/papers/04PolygonBooleansMargalit.pdf)

虽然本文针对的是图形，但它也适用于一般集合论。不完全是轻阅读材料。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T04:01:29.187

伪代码：

```
unusedRanges = [ (each of your ranges) ]
rangesInUse = []
usedRanges = []
beginningBoundary = nil

boundaries = [ list of all your ranges' start and end values, sorted ]
resultRanges = []

for (boundary in boundaries) {
    rangesStarting = []
    rangesEnding = []

    // determine which ranges begin at this boundary
    for (range in unusedRanges) {
        if (range.begin == boundary) {
            rangesStarting.add(range)
        }
    }

    // if there are any new ones, start a new range
    if (rangesStarting isn't empty) {
        if (beginningBoundary isn't nil) {
            // add the range we just passed
            resultRanges.add(beginningBoundary, boundary - 1, [collected values from rangesInUse])
        }

        // note that we are starting a new range
        beginningBoundary = boundary

        for (range in rangesStarting) {
            rangesInUse.add(range)
            unusedRanges.remove(range)
        }
    }

    // determine which ranges end at this boundary
    for (range in rangesInUse) {
        if (range.end == boundary) {
            rangesEnding.add(range)
        }
    }

    // if any boundaries are ending, stop the range
    if (rangesEnding isn't empty) {
        // add the range up to this boundary
        resultRanges.add(beginningBoundary, boundary, [collected values from rangesInUse]

        for (range in rangesEnding) {
            usedRanges.add(range)
            rangesInUse.remove(range)
        }

        if (rangesInUse isn't empty) {
            // some ranges didn't end; note that we are starting a new range
            beginningBoundary = boundary + 1
        }
        else {
            beginningBoundary = nil
        }
    }
} 
```

单元测试：

最后，resultRanges 应该有您正在寻找的结果，unusedRanges 和 rangeInUse 应该是空的，beginningBoundary 应该是 nil，并且 usedRanges 应该包含未使用的Ranges 曾经包含的内容（但按 range.end 排序）。

# php - 如何在 Mac OS X 10.5 Leopard 上设置 PEAR

> ID：628838
> 
> 赞同：10
> 
> 时间：2009-03-10T03:23:17.687
> 
> 标签：php, macos, pear, osx-leopard

我最终尝试安装 PEAR，以便可以轻松安装 PHPUnit。我想建立一个 Mac、Apache、MySQL、PHP、PHPUnit 开发环境，这样我就可以在本地进行测试。我已经有 Apache、MySQL 和 PHP 工作。现在我只需要 PHPUnit，这意味着我需要 PEAR 来安装它。

我已经到处搜索了，关于如何在 Mac OS X 10.5 上安装 PEAR 的“教程”有一些变体。但是，我似乎无法让它们中的任何一个工作！有没有人在这方面取得成功？我并不完全相信我已按应有的方式设置了所有内容，因此，如果您可以包含“默认” Mac OS X 10.5 包含路径，或者对所有内容的位置进行简单说明，我将不胜感激。

按照[本](http://clickontyler.com/blog/2008/01/how-to-install-pear-in-mac-os-x-leopard/)教程，我执行以下操作：

```
curl http://pear.php.net/go-pear > go-pear.php
sudo php -q go-pear.php 
```

我按回车键，直到进入包含 7 个包含路径的列表：

```
1\. Installation prefix ($prefix) : /Users/andrew
2\. Temporary files directory     : $prefix/temp
3\. Binaries directory            : $prefix/bin
4\. PHP code directory ($php_dir) : $prefix/PEAR
5\. Documentation base directory  : $php_dir/docs
6\. Data base directory           : $php_dir/data
7\. Tests base directory          : $php_dir/tests 
```

我改成`Installation prefix`，`/usr/local`按回车继续，输入`Y`也安装`PEAR_Frontend_Web-beta, PEAR_Frontend_Gtk2, MDB2`。最终，一切都安装好了。

下一个...

在第一次尝试时，我认为`include_path`php.ini 文件被注释掉了，但由于我已经更改了这一行，而且这不是我第一次尝试安装，我收到以下消息：

```
WARNING!  The include_path defined in the currently used php.ini does not
contain the PEAR PHP directory you just specified:
</usr/local/PEAR>
If the specified directory is also not in the include_path used by
your scripts, you will have problems getting any PEAR packages working.

Would you like to alter php.ini </private/etc/php.ini>? [Y/n] : 
```

我输入`Y`并让 pear 自动更新我的包含路径：

```
php.ini </private/etc/php.ini> include_path updated.

Current include path           : .:/usr/share/pear
Configured directory           : /usr/local/PEAR
Currently used php.ini (guess) : /private/etc/php.ini 
```

我按 Enter 继续，并收到以下消息：

```
The 'pear' command is now at your service at /usr/local/bin/pear

** The 'pear' command is not currently in your PATH, so you need to
** use '/usr/local/bin/pear' until you have added
** '/usr/local/bin' to your PATH environment variable.

Run it without parameters to see the available actions, try 'pear list'
to see what packages are installed, or 'pear help' for help.

For more information about PEAR, see:

  http://pear.php.net/faq.php
  http://pear.php.net/manual/

Thanks for using go-pear!

PHP Warning:  rmdir(/usr/local/temp): Not a directory in /Users/andrew/go-pear.php on line 1237

Warning: rmdir(/usr/local/temp): Not a directory in /Users/andrew/go-pear.php on line 1237 
```

**更新：**我想我知道为什么会出现最后两个警告。以前，我尝试通过创建指向 /tmp 的符号链接来解决临时目录问题，但如果我理解正确，PEAR 正在尝试创建自己的临时目录以进行安装，然后它将在完成后将其删除。所以我不应该创建这个符号链接，因为它会在安装完成后尝试删除临时目录。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-10T06:41:19.257

这里有几件事可能会出错，这些只是猜测。

首先，您需要担心**两个包含路径。**第一个是您的 PHP 包含路径。PEAR 库（大部分）只是 PHP 代码，特别打包。当您安装 PEAR 模块时，您正在下载该库所需的所有 PHP 代码，以及您正在安装的库所依赖的任何其他 PEAR 库（对不起那句话，但我不确定是否有更好的说法那）。此包含路径在您的 php.ini 文件中设置（一个文件用于您的命令行 php，另一个用于 yoru Web 服务器 php；通常是同一个文件）。

您需要担心的第二个包含路径是您的 UNIX/shell 包含路径。当您从终端输入命令时，这是您的计算机将在其中搜索命令的路径。'pear' 命令是一个命令行命令。

所以，我们需要确保

1.  您网站的 php.ini 文件在其包含路径中包含 PEAR 目录
2.  命令行 php 应用程序的 php.ini 文件在其包含路径中包含 PEAR 目录
3.  您的 shell 应用程序（终端，可能是您在 OS X 上的 BASH）在其包含路径中有 PEAR 目录

因此，对于数字 1，在您的服务器上放置一个包含函数调用的 PHP 页面

```
phpinfo(); 
```

这将列出有关您的服务器的一堆信息。查找 php.ini 的位置。在文本编辑器中打开此文件，查找 include_path 变量，并将路径添加到您的 PEAR 目录（不要删除其他路径，只需添加您的路径）。

对于数字 2，从命令行运行以下命令

```
php -r "phpinfo();" | grep '.ini' 
```

会打印出一堆行，寻找类似“加载的配置文件”之类的行。在文本编辑器中打开此文件，查找 include_path 变量，并将路径添加到您的 PEAR 目录（不要删除其他路径，只需添加您的路径）。

最后，这就是我认为您的问题所在，我们需要确保 pear 命令行命令位于您的 shell/bash 路径中。这就是这个错误所指的

```
** The 'pear' command is not currently in your PATH, so you need to 
```

您的主目录中应该有一个名为“.bash_profile”的文件。这是一个隐藏文件，因此它不会显示在 Finder 中。用文本编辑器打开它。如果您因为这是一个隐藏文件而遇到问题，请使用命令行 pico 编辑器。Ctrl-X 将从 pico 保存

```
cd ~
pico .bash_profile 
```

每次打开终端窗口时，shell 都会执行此文件。我们要将 /usr/local/bin 添加到您的 PATH 中，这意味着当您尝试运行命令时，您的计算机将在此文件夹中搜索该命令。将以下行添加到 .bash_profile 的底部

```
export PATH=/usr/local/bin:$PATH 
```

这或多或少等同于以下 PHP 代码

```
$PATH = '/usr/local/bin:'.$PATH 
```

您将添加 /usr/local/bin 作为第一个以冒号分隔的位置来查找命令，然后将其余现有路径添加到它。添加该行后，关闭终端，重新打开它，然后键入

```
pear 
```

这应该会给你一个有效的 pear 命令列表，但更重要的是会让你知道 pear 在你的路径中。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T07:47:28.693

我想到了。您“必须”在要安装 pear 的位置运行 go-pear.php，因此如果要将 pear 二进制文件安装在 /usr/local/bin 下，则需要在 /usr/local 下运行它

:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-04T23:29:01.697

用户“bryan kennedy”（上图）想知道“php.ini”中所需的“include_path”更改的语法

（我遇到了与 OP 类似的问题，我只是在这篇文章的帮助下解决了这个问题。）

对 php.ini 的更改看起来像...

```
include_path=".:/path_to_pear_dir/PEAR" 
```

这就是您允许“go-pear.php”进行更改时的外观......

```
;***** Added by go-pear
include_path=".:/usr/local/bin/PEAR"
;***** 
```

# bug-tracking - 满足用户报告错误的最佳方式是什么？

> ID：628840
> 
> 赞同：2
> 
> 时间：2009-03-10T03:23:46.237
> 
> 标签：bug-tracking, issue-tracking

好吧，[Bugzilla](http://www.bugzilla.org/)会吓跑普通最终用户的。即使是像[螳螂](http://www.mantisbt.org/)这样的东西对于外行来说也有点吓人。

我可以实施什么方法、Web 包（首选）、界面，以使我的最终用户和客户以可理解的方式报告错误变得简单、直观且一点也不吓人？

我喜欢基于表单或点击式的想法，而不是像 Bugzilla 这样全面而令人生畏的东西所需的先验知识。

电子邮件，虽然对于普通的下注者来说是平易近人的，但似乎不太理想，因为它不会提示用户我需要尝试找出哪些信息是坏的。

到目前为止[Bugs - Bug Genie](http://www.thebuggenie.com/)似乎是普通用户面对的最不可怕的选择。我搜索但没有找到像我这样的问题。

请提出建议，想法，见解！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T04:12:58.660

你是绝对正确的——使用 bugzilla 不取决于用户。那是给开发者的。

如果您希望用户使用它，来自用户端的错误报告需要非常简单。（即，当我看到“向 MS 报告此错误”时，我通常会点击取消，即使它是一键式机制。）

这不仅是为了获取跟踪错误所需的信息，还在于让用户感觉某事正在完成，就像他们正在被照顾一样，所以请记住这一点。

作为所有这一切的结果，我会选择适合您作为开发人员的任何错误跟踪包，然后从专为您的最终用户构建的漂亮、简单、友好的 Web 表单界面中提供信息。

然后，当发生错误时，尝试只询问您无法以编程方式回答的用户问题。理想情况下，您的异常处理应该已经跟踪它们的当前操作（保存发票）、当前上下文（发票屏幕）、被操作的实体（发票#10013）以及程序中的所有异常信息。如果您无法捕获并远程检索它，请在用户单击“报告此问题”时将其提供给您的 Web 表单（以 URL 参数或其他方式）。确保您注意任何敏感数据要求。

那么您应该只需要向您的用户询问诸如“我们如何才能最好地就这个问题与您联系？”之类的人为问题。（方法/时间/等），并让他们知道他们需要多长时间才能得到人类的回应。

我意识到这并没有提供软件推荐，但希望它仍然是处理您的问题的好建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T03:34:43.870

我没有要推荐的特定产品，但提供我们工作软件的公司在他们的网站上有一个“客户”区域。您登录，单击“报告问题”，然后填写一个简单的表格，您可以在其中选择产品并在文本框中填写问题所在。它还可以附加屏幕截图/文件。

用户可以查看他们报告的问题以及状态（新的、已分配的、已修复的）。我假设一旦我提交了表单，它就会向相应的组发送一封电子邮件，但我不确定。

当然，当我填写错误报告时，我会包括重现步骤等；但就“不可怕”而言，我认为这种方式非常简单，无论是对于编码还是对于最终用户。办公室里其他没有计算机技能的人提交报告没有问题。

* * *

相反，我使用[Digsby](http://www.digsby.com)作为我的聊天客户端，他们在帮助菜单下提供了“提交错误报告”选项。这将打开一个窗口，我可以在其中输入我的问题，我可以选择包含Digsby 打开的窗口的快照（很酷，因为教用户“打印屏幕”，粘贴到 MS Paint 等，*不是*容易），然后当我发送它时，它会同时提取诊断日志。

我也喜欢这种方式，因为它具有向某人显示问题的内置功能（尤其是显示错误）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T03:58:40.910

Bug Genie 中的屏幕截图对于普通用户来说看起来有点高级。不确定这是一个网络应用程序还是桌面应用程序，但我会尝试设置一些只需点击几下的东西，并描述错误发生时他们正在做什么。

如果可能的话，给他们一个自动发送日志文件和机器规格的选项会很好，但这取决于是否可用。

我们使用 FogBugz 作为我们的错误跟踪软件，并制作了一个提交错误对话框，允许用户随堆栈跟踪一起发送消息。显然，如果这是一个可能不是一个选项的网络应用程序，但尝试获取尽可能多的自动化信息

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T02:29:08.020

答案就在这一页的底部，正盯着我看。UserVoice 等服务是最终用户提名和投票支持错误、更改等的好方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T03:40:03.777

好吧，我想说这是 QA 的工作——普通用户不是填写错误报告的合适人选。但是，如果您需要一种方法来捕获用户问题，我会尝试在 vBulletin 或 phpBB 或类似中使用专门的论坛主题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-19T21:57:40.897

我已经破解了一些[螳螂](http://www.mantisbt.org/)。

*   电子邮件到螳螂功能（开箱即用还不太稳定）。
*   mantis 的简单错误报告表的简化版本，只是去掉了 mantis 不需要的所有内容来保存新问题

螳螂错误报告表可能不适合企业客户（即不现实），但它对我的非技术同事（甚至我的共同开发人员......）很有用

并且很容易将客户电子邮件发送给 mantis，包括传入 (fw) 和传出 (bcc)。

# apache-flex - 在 flex 中从 XML 动态渲染表单

> ID：628841
> 
> 赞同：0
> 
> 时间：2009-03-10T03:23:46.983
> 
> 标签：apache-flex, forms, render

我有一个类似这样的xml代码

```
<root>
<render>
 <head>
<transition id="fadeIn" type="fade" subtype="" dur="3s"/>
<transition id="fadeOut" type="fade" subtype="" dur="3s"/>
<layout>
  <root-layout width="480px" height="360px" backgroundColor="0"/>
  <region id="rootRegion" dur="15s">
    <region id="background" soundLevel="100%" top="0px" left="0px"   width="480px"          height="360px" z-index="0"/>
    <region id="foreground" soundLevel="100%" top="0%" left="0%" width="480px" height="360px" z-index="1"/>
  </region>
</layout>
</head>
<body>
<par region="background" begin="0s">
  <img>
    <meta name="assetsource" content="stock"/>
    <src>http://s3.amazonaws.com/JivoxStockImage/000003296736.jpg</src>
    <width>102.49999999999999%</width>
    <height>97.5%</height>
    <left>0%</left>
    <top>0%</top>
    <clipBegin/>
    <clipEnd/>
    <begin>0s</begin>
    <dur>15</dur>
  </img>
  <audio>
    <meta name="assetsource" content="stock"/>
    <src>http://audio.mp3</src>
    <clipBegin/>
    <clipEnd/>
    <begin>0s</begin>
    <dur>15s</dur>
  </audio>
</par>
<par region="foreground" begin="0s">
  <img>
    <meta name="assettype" content="user"/>
    <src>http://image.png</src>
    <width>20%</width>
    <height>20%</height>
    <left>41.5%</left>
    <top>25.555555555555557%</top>
    <begin>2s</begin>
    <dur>10s</dur>
    <id>BA6B7CF0BD9080CAD7A02199483224EA61A6E08A</id>
  </img>
  </par>
  </body>
 </render>

<form>

<map formId="BA6B7CF0BD9080CAD7A02199483224EA61A6E08A" type="image" label="Logo" />  
<map formId="F635A9123082A15834389030382683C55EB29E75" type="text" label="Company Name" />

</form>
</root> 
```

这里我需要将'form'中的formId与'render'中的'id'匹配，并在flex中动态创建表单。

我可以通过 httpservice 获取 xml 文件。我只需要知道如何匹配它并动态呈现表单！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-04-12T02:55:30.277

如果我没记错的话，你有 ID，你需要它与表单 ID 匹配，表单 ID 又是动态的，表单将具有基于 ID 的元素。

**我的问题：**

1.  为什么不创建整个表单而不使用任何 ID 进行匹配。您可以通过解析 XML 文件直接使用元素创建整个表单。

在我花更多时间在此之前，请告诉我您是否正在查看此解决方案或其他内容。

# c# - 测试最后机会异常处理

> ID：628842
> 
> 赞同：0
> 
> 时间：2009-03-10T03:24:07.263
> 
> 标签：c#, unit-testing, exception-handling

我正在尝试编写一个单元测试来涵盖在我们的“最后机会异常处理程序”中找到的代码。

当提到最后机会异常处理时，我指的是事件的事件处理程序：

Application.ThreadException AppDomain.CurrentDomain.UnhandledException

我或多或少正在验证是否正在生成日志，详细说明异常产生的信息。我的测试类似于：

```
 [Test]
 public void TestMethod() 
 {
    //Setup log4net ConsoleAppender here
    //hooking a MemoryStream to the Console.SetOut done here

    ExceptionHandler.InstallExceptionHandler();
    Thread exceptionThread = new Thread(ThrowException);
    Thread.Start();

    //read stream here

    Assert.That(streamContainsExceptionText);
 }

private void ThrowException() {
 throw new Exception("Unhandled Exception");
} 
```

异常处理程序是一个单例，当“安装”时只是将处理程序添加到先前给定的事件中。奇怪的是，我没有一致的结果。中断和调试似乎不是一种选择，因为它似乎介于异常和 ExceptionHandler 之间。

我在整个代码中放置了几个“Console.WriteLine()”语句来验证代码失败的地方，但这并不一致。我相信这与测试框架杀死线程或可能某种垃圾收集有关。

有没有人有过测试这样一段代码的经验？或者你对我为什么会看到这种行为有任何见解吗？

我正在使用 NUnit 2.4 并使用 ReSharper 在 IDE 中运行它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T03:41:14.023

这是一个竞争条件，您的线程可能并不总是有时间执行异常+记录它。

加入线程，以便在线程完成后继续。

```
 Thread exceptionThread = new Thread(ThrowException);
    exceptionThread.Start();
    exceptionThread.Join();
    //read stream, and rest of the test 
```

此外，您可能希望在加入呼叫时设置超时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T03:38:15.640

您是否有可能在线程开始然后完成之前尝试从流中读取值？

对于这种事情，我们会将读取的流放在一个循环中（伪代码）：

```
while (!timed out) {
    read from stream;
    if (message is in stream) {
        set success flag;
        break;
    }
    sleep;
 }
 if (!success flag) {
     throw test failure;
 } 
```

# c# - C#中结构的字节序列化字节

> ID：628843
> 
> 赞同：9
> 
> 时间：2009-03-10T03:24:31.367
> 
> 标签：c#, serialization

我正在寻找 C# 中序列化的语言支持。我可以从 ISerializable 派生并通过在字节缓冲区中复制成员值来实现序列化。但是，我更喜欢一种更自动化的方式，就像在 C/C++ 中可以做的那样。

考虑以下代码：

```
using System;
using System.Text;
using System.Runtime.Serialization;
using System.Runtime.Serialization.Formatters.Binary;
using System.IO;

namespace XBeeHelper
{
    class XBee
    {
        [Serializable()]
        public struct Frame<FrameType> where FrameType : struct
        {
            public Byte StartDelimiter;
            public UInt16 Lenght;
            public Byte APIIdentifier;
            public FrameType FrameData;
            public Byte Checksum;
        }

        [Serializable()]
        public struct ModemStatus
        {
            public Byte Status;
        }

        public Byte[] TestSerialization()
        {
            Frame<ModemStatus> frame = new Frame<ModemStatus>();
            frame.StartDelimiter = 1;
            frame.Lenght = 2;
            frame.APIIdentifier = 3;
            frame.FrameData.Status = 4;
            frame.Checksum = 5;

            BinaryFormatter formatter = new BinaryFormatter();
            MemoryStream stream = new MemoryStream();
            formatter.Serialize(stream, frame);
            Byte[] buffer = stream.ToArray();
            return buffer;
        }
    }
} 
```

我有一个通用的 Frame 结构，用作许多类型有效负载的包装器，用于串行传输。ModemStatus 是此类有效负载的一个示例。

但是，运行 TestSerialization() 会返回一个**382**字节长的缓冲区（没有预期的内容）！它应该包含 6 个字节。是否可以在不手动序列化的情况下正确序列化这些数据？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-02T16:52:59.657

只需使用这两种方法：

```
public static class StructTools
{
    /// <summary>
    /// converts byte[] to struct
    /// </summary>
    public static T RawDeserialize<T>(byte[] rawData, int position)
    {
        int rawsize = Marshal.SizeOf(typeof(T));
        if (rawsize > rawData.Length - position)
            throw new ArgumentException("Not enough data to fill struct. Array length from position: "+(rawData.Length-position) + ", Struct length: "+rawsize);
        IntPtr buffer = Marshal.AllocHGlobal(rawsize);
        Marshal.Copy(rawData, position, buffer, rawsize);
        T retobj = (T)Marshal.PtrToStructure(buffer, typeof(T));
        Marshal.FreeHGlobal(buffer);
        return retobj;
    }

    /// <summary>
    /// converts a struct to byte[]
    /// </summary>
    public static byte[] RawSerialize(object anything)
    {
        int rawSize = Marshal.SizeOf(anything);
        IntPtr buffer = Marshal.AllocHGlobal(rawSize);
        Marshal.StructureToPtr(anything, buffer, false);
        byte[] rawDatas = new byte[rawSize];
        Marshal.Copy(buffer, rawDatas, 0, rawSize);
        Marshal.FreeHGlobal(buffer);
        return rawDatas;
    }
} 
```

并像这样指定您的结构（指定确切的大小并按一个字节打包（对齐）。默认为 8）：

```
[StructLayout(LayoutKind.Explicit, Size = 11, Pack = 1)]
private struct MyStructType
{
    [FieldOffset(0)]
    public UInt16 Type;
    [FieldOffset(2)]
    public Byte DeviceNumber;
    [FieldOffset(3)]
    public UInt32 TableVersion;
    [FieldOffset(7)]
    public UInt32 SerialNumber;
} 
```

现在您可以使用反序列化

```
StructTools.RawDeserialize<MyStructType>(byteArray, 0); // 0 is offset in byte[] 
```

并使用序列化

```
StructTools.RawSerialize(myStruct); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-10T06:33:47.450

正如[Chris 所说](https://stackoverflow.com/questions/628843/byte-for-byte-serialization-of-a-struct-in-c/628856#628856)，您可以使用不安全的代码 - 在这种情况下，您最好确保明确指定布局。在这一点上，你当然会降低 CLR 的优化能力——你最终会得到不对齐的访问、原子性的丢失等。这可能与你无关，但值得牢记。

就个人而言，我认为这是一种非常脆弱的序列化/反序列化方式。如果有任何变化，您的数据将无法读取。如果您尝试在使用不同字节序的架构上运行，您会发现所有值都搞砸了等等。此外，一旦您需要使用引用类型，使用内存布局就会失败——这很可能影响您自己的类型设计，鼓励您在原本会使用类的地方使用结构。

我更喜欢明确地读取和写入值（例如使用 BinaryWriter，或者最好[是允许您设置字节序的二进制写入器版本](http://www.yoda.arachsys.com/csharp/miscutil)）或使用可移植的序列化框架，如[Protocol Buffers](http://code.google.com/p/protobuf/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-14T22:42:42.793

请参阅此链接。这使用 Marshal 机制来获取结构的实际数据并将它们复制到 Byte[]。另外，如何将它们复制回来。这些函数的好处是它们是通用的，因此它将适用于您的所有结构（除非它们具有可变大小的数据类型，如字符串）

[http://dooba.net/2009/07/c-sharp-and-serializing-byte-arrays/](http://dooba.net/2009/07/c-sharp-and-serializing-byte-arrays/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-10T03:48:12.637

也许通用的序列化/反序列化方法：

```
public static string SerializeObject<T>(T obj)
{
      string xmlString = null;
      using(MemoryStream memoryStream = new MemoryStream())
      {
        using(XmlSerializer xs = new XmlSerializer(typeof(T)))
        {
            XmlTextWriter xmlTextWriter = new XmlTextWriter(memoryStream, Encoding.UTF8);
            xs.Serialize(xmlTextWriter, obj);
            memoryStream = (MemoryStream)xmlTextWriter.BaseStream;
            xmlString = UTF8ByteArrayToString(memoryStream.ToArray());      
        }
      }
      return xmlString;
}

public static T DeserializeObject<T>(string xml)
{
   XmlSerializer xs = new XmlSerializer(typeof(T));
   MemoryStream memoryStream = new MemoryStream(StringToUTF8ByteArray(xml));
   XmlTextWriter xmlTextWriter = new XmlTextWriter(memoryStream, Encoding.UTF8);
   return (T)xs.Deserialize(memoryStream);
} 
```

原来在[这里](http://geekswithblogs.net/paulwhitblog/archive/2007/07/20/114076.aspx)找到。

# mysql - MySQL - 查找重复的元组

> ID：628844
> 
> 赞同：2
> 
> 时间：2009-03-10T03:24:33.427
> 
> 标签：mysql

我有一个包含多个字段的 MySQL 表，我想找到任何重复元组的条目。

我最初认为我可以做到这一点

```
select f1, f2, f3 from mytable t1 left join mytable t2 
where t1.f1 = t2.f1 and t1.f2 = t2.f2 and t1.f3 = t2.f3; 
```

但后来我意识到这只会返回表中的所有行（我认为）。

我在元组上建立了一个索引。我的表中有 120 万行，如果这有所作为的话。

我的 SQL 不是很强大。帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T03:33:01.987

也许是这样的：

```
select f1, f2, f3, count(*)
from mytable
group by f1, f2, f3
having count(*) > 1 
```

我使用 MS SQL，所以语法可能会关闭。

# javascript - JavaScript 中的堆栈操作

> ID：628855
> 
> 赞同：0
> 
> 时间：2009-03-10T03:29:14.960
> 
> 标签：javascript, data-structures, stack

我正在用 JavaScript 实现一个堆栈。

考虑：

```
Stack{0,1,2,3} Top:0 
```

现在用户弹出值 2：

```
Stack{0,1,3} Top:0 
```

这是堆栈的可接受行为吗？我正在滚动自己的堆栈，但是是否有任何内置代码可以为我做到这一点？

### 我的代码：

```
function Stack() //Creating Stack Object
{
    // Create an empty array of cards.
    this.cards = new Array();  //Cards array inside stack object
    this.push  = pushdata;     //Call pushdata function on push operation
    this.pop   = popdata;      //Call popdata function on pop operation
    this.printStack = showStackData; //Call showStackData function on printstack operation
}

function pushdata(data)
{
    this.cards.push(data);
}

function popdata(data)
{
    return this.cards.pop();
}

function showStackData()
{
    return this.cards;
}

var a = new Stack(); //Create stack Object
a.push(12);          //Push Data onto Stack
a.push(32);
a.push(42);
var z = a.pop();
document.write("Data Popped: " + z);
document.write("Stack Output: " + a.printStack()); 
```

如果堆栈不是此应用程序的正确数据结构类型，那么正确的数据结构是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-10T03:36:44.190

> 在堆栈中进行上述操作是否合法？

这不是传统的堆栈操作。允许您这样做的数据结构实际上不能称为堆栈；它更像是一个普通的旧列表。

> 如果堆栈不允许删除顶部和开始之间的数据。javascript 中用于上述逻辑的更改数据结构是什么？

[一个简单的Array](http://docs.sun.com/source/816-6408-10/array.htm)有什么问题吗？它为您提供所需的随机访问项目写作：

```
var a= [0, 1, 2, 3];
a.splice(1, 1);
// a==[0, 2, 3] 
```

加上堆栈式便利方法，用于访问前端加载和尾部堆栈（以及因此，队列）：push/pop/shift/unshift。

当 Array() 已经涵盖了 IMO 时，创建自己的 Stack() 包装类没有多大意义。虽然计算机科学家可能对堆栈链表的算法复杂性等问题感兴趣，但在实践中，您将无法从更高级别的代码改进现代 JavaScript 解释器中内置的优化数组实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T03:34:47.893

不可能用 Pop 做到这一点（在此过程中不弹出其他东西）。您应该考虑为用户提供另一种方法来查找数字 2 的位置，并为用户提供另一种方法来提取它，例如使用数组拼接。但到那时，这不再是一个堆栈。

[http://www.w3schools.com/jsref/jsref_splice.asp](http://www.w3schools.com/jsref/jsref_splice.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T03:41:58.203

如果您确实必须使用堆栈，您可以多次弹出，通过推送将弹出的数据临时存储在另一个堆栈中，然后当您完成后，执行相反的操作以将堆栈的末尾放回原位。

类似的事情通常由 GUI 应用程序中的 Undo/Redo 操作完成——它们有一个 Undo 操作堆栈和一个相反的 Redo 操作堆栈。Undo 将一个动作从堆栈 A 移动到 B，而 Redo 将一个动作从堆栈 B 移动到 A。一个新的动作压入 Undo 堆栈并完全清除 Redo 堆栈。

另一个使用它的地方是在浏览器的后退/前进列表中。

# windows - 类型不匹配错误代码不是 13

> ID：628869
> 
> 赞同：0
> 
> 时间：2009-03-10T03:37:58.137
> 
> 标签：windows

对于类型不匹配错误，是否有可能收到除 13 以外的错误代码（例如 0）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T03:50:28.870

我认为这可能是一个 VB 错误，我也相信运行时错误 13 是一个“类型不匹配”错误..期间。只有一种“类型不匹配”错误。例如，运行时错误 7 是“内存不足”错误。

# java - 从 Java 连接到 CDMA 网络 IN

> ID：628880
> 
> 赞同：1
> 
> 时间：2009-03-10T03:44:09.510
> 
> 标签：java, networking, sms, vpn

我正在使用 java 开发接收和处理 SMS 消息的程序。我已经能够对收到的 SMS 消息的处理进行编码，并且它工作得很好。现在我面临的挑战是接收来自 CDMA 网络的 SMS 消息。当应用程序即将上线时，CDMA 网络将建立一个 VPN 连接，这将使我的应用程序能够连接到它的 IN 或它的 IN 连接到我的应用程序，以通过 VPN 将 SMS 消息传递给我的应用程序。现在，SMS 将以什么格式发送到应用程序？还是我只需要在 VPN 上收听并在数据可用时读取数据？非常感谢您的宝贵时间。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-10T09:01:21.073

我假设您的意思是[智能网络](http://en.wikipedia.org/wiki/Intelligent_network)？通常 IN 与发送/接收 SMS 消息无关 - 您需要连接到 SMS[服务中心](http://en.wikipedia.org/wiki/Short_message_service_center)(SMSC)（或某些代理/网关）才能执行此操作。

正如 Bombe 所指出的，由于历史原因，您可以使用多种协议连接到移动运营商 SMSC，它们都是特定于供应商的。常见的协议有：

*   [SMPP](http://en.wikipedia.org/wiki/SMPP)（最流行，成为事实上的标准）。有两个 SMPP java 库：
    *   [SourceForge 的 SMPP API](http://sourceforge.net/projects/smppapi) - 非常稳定和成熟的库，我个人在多个项目中使用过，可以推荐。
    *   [Logica OpenSMPP](http://opensmpp.logica.com/) - 来自开发 SMPP 规范的公司的库。我从未使用过它，所以我无法评论它的成熟度或稳定性。
*   [UCP](http://en.wikipedia.org/wiki/Universal_Computer_Protocol)（[规范](http://www.nowsms.com/discus/messages/1/EMI%5FUCP%5FSpecification%5F40-8156.pdf)）- 相当古老的标准。我不知道该协议有任何开放的 Java 库。但是，由于它都是基于 ASCII 的，因此您自己实现起来相当容易（只要您喜欢搞乱字节 :-)）。
*   [CIMD2](http://en.wikipedia.org/wiki/CIMD) - 与诺基亚 SMSC 通信的规范。它正在成为传统，因为我听说较新的诺基亚 SMSC 版本也支持 SMPP。对此也没有已知的开放 Java 库。
*   最后，实施了数以百万计的自定义协议，以使第 3 方开发人员“更容易”连接到 SMSC。这些通常基于 HTTP 和 XML（如果幸运的话，是 SOAP）。

总而言之，协议的选择不是你的事。它通常由 SMSC 供应商或移动运营商规定（如果他们开发了某种“代理/网关”，以保护他们的 SMSC 免受外部开发人员可能犯的潜在编程错误的影响）。

PS 如果您不限于 java，您还可以看看[Kannel - 开源 WAP 和 SMS 网关](http://www.kannel.org/)。我自己没有使用过它，但据我所知，它们应该涵盖所有主要协议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T07:56:03.040

可以使用不同的协议，如 SMPP ( [1](http://en.wikipedia.org/wiki/Short_message_peer-to-peer_protocol) , [2](http://smsforum.net/) )、UCP ( [1](http://en.wikipedia.org/wiki/Universal_Computer_Protocol) , [2](http://www.nowsms.com/discus/messages/1/EMI_UCP_Specification_40-8156.pdf) )，甚至 HTTP 来将 SMS 从一方传输到另一方。您需要与上游提供商核实他们提供的协议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T09:09:17.997

如果消息通过 SMPP 进入您，请查看 SMPPAPI。

[http://smppapi.sourceforge.net/](http://smppapi.sourceforge.net/)

与您的移动网络交谈，他们会告诉您消息将以何种格式传送。

# data-structures - 深度优先搜索，如何检测钻石依赖关系？

> ID：628881
> 
> 赞同：1
> 
> 时间：2009-03-10T03:45:30.350
> 
> 标签：data-structures, graph

我想知道是否有人可以提供一些关于如何在对图执行深度优先搜索时检查钻石依赖关系的指示......我有以下图表`A -> B, A -> F, B -> C, B-> E, C -> D, E -> D`。

我正在尝试构建代表指定图形的容器层次结构，但是当我达到菱形依赖项时，我不确定该怎么做。例如，在我的图中，`C`and`E`都是 的子容器`B`，当我解决 时`D`，我需要引用`C`and `E`。我可以检测到钻石依赖关系并将其组合`C`到`E`一个容器中吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T04:06:00.423

我发现最容易想到使用颜色的图形算法。

所有节点都以白色开始。

正在处理的节点是灰色的。

处理完节点后，将其着色为黑色。

一旦遇到节点，您就将它涂成灰色。

处理完其子节点后，您将节点着色为黑色。

如果您遇到黑色节点，那么您就遇到了菱形依赖项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T11:31:41.953

Rohan，您可以使用深度优先搜索通过查找交叉或前向边缘来检测“钻石深度”。如果您在 boost-graph-library 主页上[查看深度优先搜索](http://www.boost.org/doc/libs/1_38_0/libs/graph/doc/depth_first_search.html)的伪代码实现。

... else if (color[v] = BLACK) (u,v) 是十字边或前边...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T04:29:16.077

Rohan，因为我有时会教算法和数据结构，所以我可能会有偏见，但我怀疑你需要看一本图算法书。有很多不同的方法来做这似乎暗示的事情，但并不完全清楚你真正想要*做什么*。是的，在这种情况下，您有两个节点，其传入边和传出边到/来自相同节点（这里，（B，E），（B，C）（C，D），（E，D））将两个节点 C 和 E 组合成一个“C，E”节点是合法的。将 D 分解为 D [1]和 D [2]也是合法的，使其成为树而不是 DAG。

也就是说，*根据*问题这样做是合法的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T04:05:18.553

我不知道您如何定义图形的节点。让我们说一种表示节点的方法如下 -

```
public interface Node {
            int getValue();
            List<Node> getChildren();
        } 
```

这种实现的问题是——我们不知道一个节点的父节点。如果我们有办法知道谁是一个节点的父节点，我们就可以找出菱形依赖关系。

例如，在你的情况下，我们应该从树的底部开始，我们可以看到 D 有两个 Parenet，它们来自 B。所以我会说建立你的图，它不仅照顾孩子，而且照顾父母. 然后在一次通过中，找出哪些节点有多个父节点（如 D 有），以及这些父节点（C 和 E）是否具有相同的父节点（B）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T04:12:13.263

我不太确定您要做什么，但最迟当您的图表包含循环时，您确实需要检测在搜索过程中重复找到的节点。通常这是通过在处理节点时以某种方式标记节点来完成的，这样您可以稍后查看您之前是否已经访问过它们。这在您的情况下效果如何取决于您的实现以及这些节点的外观......

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-10T04:09:32.210

图论是一个非常庞大而复杂的数学领域。这是一些知识可能是危险的事情之一:) 即使是图论的基本应用也很难找到简单的解释。很有可能你可能遇到的任何图表都被打死了，并且有 5 倍于你在解决问题时想象的陷阱和陷阱。

我猜你会在这里看到一些非常合理的建议，然后稍后它们会被确定为部分甚至大部分是错误的。小心地走。

# linq-to-sql - 为什么在事务范围内调用 SQL Server 2008 中的全文搜索失败？

> ID：628891
> 
> 赞同：0
> 
> 时间：2009-03-10T03:55:46.063
> 
> 标签：linq-to-sql, sql-server-2008, full-text-search, transactions, user-defined-functions

以下代码：

```
var foo = Users.Join(
                tvf_SearchUsers(queryString),
                u => u.User_Id,
                s => s.User_Id,
                (u, s) => u); 
```

根据使用全文搜索的表值函数 (tvf_SearchUsers) 选择与查询字符串匹配的用户。此代码片段是在生产中使用时成功运行的更大方法的一部分。但是，当我在具有回滚属性的 MBUnit 测试中调用相同的方法时，搜索无法返回预期结果。如果我删除回滚属性，它可以正常工作。单元测试创​​建虚拟用户等，然后由回滚清理。似乎这些创建的项目没有被表值函数看到，就好像它在事务范围之外一样。有谁知道如何解决这个问题？

**更新**

如果我在 tvf 中用更简单的查询替换全文搜索功能，则操作按预期进行。所以这个问题与全文搜索有关。我正在使用 SQL Server 2008，因此 afaik SQL Server 应该能够将全文查询保留在事务范围内。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T04:32:20.797

可能是由于全文搜索/交易组合。如果是 sql 2005，我认为全文搜索不会在您进行事务时看到更改。请查看此帖子[https://blog.stackoverflow.com/2008/11/sql-2008-full-text- search-problems/](https://blog.stackoverflow.com/2008/11/sql-2008-full-text-search-problems/)，当提到 sql server 2008 现在可以处理全文搜索的事务时，这在前一段时间给 SO 造成了一些问题。

# html - 定位问题和 CSS 菜单不会通过 IE7 中的嵌套 Div 显示

> ID：628894
> 
> 赞同：0
> 
> 时间：2009-03-10T03:56:34.533
> 
> 标签：html, css

对于这个网站：[http ://writershore.com/ltlaw/](http://writershore.com/ltlaw/)

我将该站点验证为 XHTML 1.0 过渡，现在绝对定位似乎不起作用，最糟糕的是，IE 中的所有菜单无法正常工作，它似乎显示在 Div 下方。在 Firefox 和 Chrome 中，菜单运行良好。

1.  关于我在“主要”Div 中的定位有什么问题有什么想法吗？

2.  菜单问题是溢出问题吗？z-index 问题？我已经尝试了两者的变体，但没有修复 IE 中的结果。

再次感谢您的任何想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T04:10:40.240

然后是验证 CSS 的时候了。36 个错误和 9 个警告：

[http://jigsaw.w3.org/css-validator/validator?uri=http%3A%2F%2Fwritershore.com%2Fltlaw%2F&profile=css21&usermedium=all&warning=1&lang=en](http://jigsaw.w3.org/css-validator/validator?uri=http%3A%2F%2Fwritershore.com%2Fltlaw%2F&profile=css21&usermedium=all&warning=1&lang=en)

文本后面显示的菜单是 IE7 问题，它在 IE8 中运行良好。我会看看那个和定位，看看我能不能找到一些东西......

编辑：
您忘记了所有定位上的单位，这就是定位不起作用的原因。例如：

```
left: 40; 
```

应该：

```
left: 40px; 
```

编辑 2：
我认为 z-index 可以解决 IE7 中的菜单问题，您只需在正确的元素上设置 z-index。现在您已经在菜单项上设置了它，这些菜单项的深度级别与您想要将它们放在前面的元素完全不同。同一级别的元素具有类`colorbigbar`和`main`，您应该在其中设置 z-index。

# python - 迭代器的性能优势？

> ID：628903
> 
> 赞同：26
> 
> 时间：2009-03-10T04:05:59.393
> 
> 标签：python, performance, iterator

使用迭代器提供了哪些（如果有的话）性能优势。这似乎是解决许多问题的“正确方法”，但它是否创建了更快/更注重内存的代码？我正在专门考虑 Python，但不要将答案仅限于此。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-10T18:16:59.350

在 python 邮件列表中实际上有一个非常好的邮件： [Iterators vs Lists](http://markmail.org/message/t2a6tp33n5lddzvy)。它有点过时（从 2003 年开始），但据我所知，它仍然有效。

这是摘要：

> 对于小型数据集，基于迭代器和列表的方法具有相似的性能。对于较大的数据集，迭代器既节省时间又节省空间。

我从中得出的结论是：如果可能的话，迭代器优先于将数据加载到列表中。但是除非你有一个大数据集，否则不要扭曲你的代码来制作应该适合列表的东西来使用迭代器。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-10T07:07:24.637

迭代器将更快并且具有更好的内存效率。想想一个`range(1000)`vs的例子`xrange(1000)`。（这在 3.0 中已更改，`range`现在是一个迭代器。）`range`您预先构建列表，但`xrange`它是一个迭代器，并在需要时产生下一个项目。

小东西的性能差异不是很大，但是一旦你开始处理它们，得到越来越多的信息集，你就会很快注意到它。此外，不仅必须生成然后逐步执行，您还将为预构建的项目消耗额外的内存，而使用迭代器，一次只能生成 1 个项目。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-10T05:00:05.927

迭代器的主要好处不是性能之一。以我的经验，最高效的解决方案是创建一个嵌入您选择的数据结构的算法。迭代器的好处是它们允许您将数据和算法解耦，因此可以泛化和重用两者。如果这也可以在没有（或很少）性能下降的情况下完成，那么这是一个净收益。

我最喜欢的迭代器使用示例可以在 C++[标准模板库](http://www.sgi.com/tech/stl/)中找到。它通过在不牺牲性能的情况下干净地分离容器和算法来设法展示抽象的力量和美感。理解这种设计对我思考代码的方式产生了深远的影响。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-10T04:42:36.747

迭代器只是实现[特定接口的](http://docs.python.org/library/stdtypes.html#iterator-types)类，特别是用于*进入下一个*接口的接口。在 Python 中，列表、元组、字典、字符串和文件都实现了这个接口。如果它们实现得不好，可能会导致性能不佳，但接口本身并没有暗示性能好坏的东西。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-10T19:31:53.897

要备份[@Christian Witts 的答案](https://stackoverflow.com/questions/628903/performance-advantages-to-iterators/629169#629169)：

### `range`与`xrange`性能

```
python25 -mtimeit "for i in xrange(1000): pass"
10000 loops, best of 3: 56.3 usec per loop

python25 -mtimeit "for i in range(1000): pass"
10000 loops, best of 3: 80.9 usec per loop

python26 -mtimeit "for i in xrange(1000): pass"
10000 loops, best of 3: 48.8 usec per loop

python26 -mtimeit "for i in range(1000): pass"
10000 loops, best of 3: 68.6 usec per loop 
```

顺便说一句，迭代器`range()`也不是：`xrange()`

```
>>> hasattr(range(1), 'next')
False
>>> hasattr(xrange(1), 'next')
False
>>> iter(xrange(1))
<rangeiterator object at 0x0097A500>
>>> iter(range(1))
<listiterator object at 0x00A7BFD0>
>>> iter([])
<listiterator object at 0x00A7BE30>
>>> iter(i for i in (1,))
<generator object at 0x00A7F940>
>>> (i for i in (1,))
<generator object at 0x00A7FDC8> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-09T12:45:50.497

我从上面的许多答案中得出的推论是“使用列表进行编码。如有必要，使用迭代器进行重构”除非您拥有大型数据集，否则差异并不明显。

另一件需要注意的是，即使经常使用列表，我们操作的数据集也越来越小。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-10T05:00:04.023

迭代器只是一个提供允许遍历集合的方法的对象。您可以使用相同的接口遍历数组的所有元素或树的所有节点。树和数组是非常不同的数据结构，需要不同的方法来遍历......但是使用迭代器，您可以以相同的方式遍历所有元素。

对于一种类型的集合，也可能有不同的方法来遍历它，单个集合可以有多个迭代器。你可以有一个深度优先迭代器或一个广度优先迭代器遍历树结构并以不同的顺序返回节点. 迭代器不是为了性能......但通常用于为遍历结构提供一致的接口。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-11-04T17:25:14.323

我认为有一个答案有点混淆了生成器和迭代器的概念。所以我决定尝试用一个隐喻的例子来回答这个问题。

我在厨房工作，我的老板给我一个任务，将 10 个（或 100 个或一百万个）面包的重量相加。我有一个秤和一个计算器（我的算法的魔术）。下面是可迭代对象、生成器、迭代器、方法的区别：

1.  可迭代对象：每个面包都存储在一个盒子（内存）中，我称第一个（或第0个）面包，放下它的重量，把面包放回盒子里，然后去下一个，称重放它回来了，继续，等等，等等。最后，我得到了整体重量，10（100或百万）个面包仍然在他们的盒子里。

2.  发电机：没有足够的盒子来存放所有这些面包，所以我请了面包师（发电机）的帮助，他制作了第一个面包，给我，我称重，放下结果，扔掉那个面包走开再问他要另一个，不断地，等等，直到我得到最后一个面包（或者也许面包师的面粉用完了）。最后，我得到了结果，没有面包。但是谁在乎呢，我的老板只让我称这些面包的重量，他没有说我不能把它们扔掉（多么聪明的服务生）。

3.  迭代器：我请人（迭代器）帮我把第一个面包放到秤上，我称它，把结果记下来。这个人会去拿下一个来测量，不断地等等。我实际上不知道有人（迭代器）是从盒子里还是从面包师那里得到面包。最终，我得到了整体重量，这对我来说并不重要。

总之，总结一下：

1.  可迭代对象需要一些内存来存储数据。最后，数据仍然存在。

2.  生成器开始时不需要内存来存储数据，它可以随时随地生成数据。

3.  迭代器是算法与其数据之间的通道。该数据可能已经存在并存储在内存中，或者可能由生成器在运行中生成。在第一种情况下，随着迭代器不断迭代，该内存将被一点一点地释放。所以我非常同意上面的回答，即迭代器很好，因为它的抽象可以隔离算法和数据。

python 并不完全像这样工作。希望它有助于澄清一点。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-11-20T23:43:09.163

稍微偏离主题，但总体上增加了列表在迭代器上的使用权重：使用迭代器更容易产生副作用，考虑一下：

```
def foo(arg: Iterable[str]):
  print(list(arg)) # side effect: arg is exhausted at this point
  ... 
```

你可以说测试应该捕捉到这一点，但有时它不会。列表没有这个问题，因为它们是无状态的（在迭代的意义上）。

# c# - 如何使用 ItemSource 向 WPF ListBox 添加其他项目？

> ID：628905
> 
> 赞同：6
> 
> 时间：2009-03-10T04:07:21.950
> 
> 标签：c#, .net, wpf, xaml

我有一个 WPF 表单，其中包含项目的 ListBox 绑定到获取列表框项目的方法。我想要的是 ListBox 顶部的一个附加项目，它的行为与其余项目不同。

例如，假设我有一个作者列表（数据绑定到列表），当我选择一个作者时，它会用该作者的书籍填充另一个列表框。我想在 lstAuthors 列表框中添加一个名为 Show All 的项目，它将用所有书籍填充另一个列表框。如何将此附加项添加到我的列表框中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-10T05:55:22.143

使用 CompositeCollection 将您的收藏与包含您的专业项目的另一个收藏合并。然后，为您的特殊全选选项使用强类型数据模板，该选项在该部分中执行您想要的操作。

其他选项包括禁用列表视图中的滚动，将列表视图放在堆栈面板中，连同您的全选一起，然后将该堆栈面板放在滚动查看器中，或者只是在 UI 中放置一个按钮:)

# iphone - iphone sqlite静态链接？

> ID：628908
> 
> 赞同：4
> 
> 时间：2009-03-10T04:08:47.033
> 
> 标签：iphone, sqlite, static, crash, jailbreak

那里有人静态链接sqlite（而不是使用动态链接）？

我遇到的问题是越狱手机的用户没有与库存 iPhone 假定的相同版本的 sqlite（因此导致崩溃）。我假设在我的应用程序中静态链接已知版本的 sqlite 是答案......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T06:29:53.887

我需要全文支持（使用 FTS3 模块）

我所做的就是从这里获取 Sqlite Amalgamation： [http](http://www.sqlite.org/amalgamation.html) : //www.sqlite.org/amalgamation.html 并将 .h 和 .c 放入我的项目中，它可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T18:30:13.780

你找到崩溃的确切原因了吗？您确定这不是由不同版本的 SQLite 暴露的代码中的错误吗？

当[我遇到与此类似的问题](https://stackoverflow.com/questions/608608/why-does-cocoa-return-an-empty-string-occasionally)时，我发现它实际上是我的代码中的一个错误——我`sqlite3_reset`过早地编写了一个准备好的语句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T05:25:21.247

您可以下载源代码并自己创建一个静态库吗？

# sql-server - 恢复的数据库中的主键违规

> ID：628917
> 
> 赞同：-2
> 
> 时间：2009-03-10T04:14:14.383
> 
> 标签：sql-server, replication, identity, increment

我在 sql server 2005 数据库之间设置了事务复制（不可更新订阅者）。已发布数据库中的表具有标识列。表被复制没有问题。但是当我备份和恢复订阅者数据库时，我无法在包含标识增量字段的表中插入行，并且它说，发生主键冲突。如果我在删除和重新创建此标识属性或将标识种子值重置为表的行数后尝试，它允许插入。我需要指导在事务复制下备份和恢复订阅者数据库以避免此类问题。

谢谢，P.Gopalakrishnan。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T05:34:04.567

我的出版商倒闭了。所以，我喜欢在另一台服务器中使用订阅者数据库作为发布者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T04:39:25.243

在事务复制场景中，您通常不会对订阅者数据库进行任何数据更改（您仍然可以创建额外的索引）。[可以使用[事务复制的可更新订阅](http://msdn.microsoft.com/en-us/library/ms151718(SQL.90).aspx)来完成]

为什么要备份和恢复订阅者数据库？

有关 SQL Server 复制的概述，请参见[此处](http://technet.microsoft.com/hi-in/sqlserver/bb331775(en-us).aspx)。

# asp.net - 在 ASP.NET 中调试 Javascript

> ID：628919
> 
> 赞同：1
> 
> 时间：2009-03-10T04:15:48.263
> 
> 标签：asp.net, javascript, debugging

我想知道是否可以将 javascript 错误的类型分为不同的类别，以及是否有一种简单的调试方法。在处理 ASP.NET 应用程序时，我通常会看到 2 种不同类型的 JS 错误：

1.  那些说“xx发生错误。你想调试”吗？

2.  在浏览器左下角用图标显示错误的那些（双击时会显示错误）

是否有针对所有 JS 错误的良好调试器（尤其是类型 1 的错误？）

编辑-

```
If I use Visual Studio to debug JS, can I have it setup to automatically open the line that caused the error in VS when I am not in debug mode? (We have a large .NET solution and to get to the JS debugger, I have to start in debug mode (The script explorer does not show up if I simply attach the debugger later)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T04:20:31.247

当然有：[Firebug](http://www.getfirebug.com/)。它是 Firefox 的插件，没有它你根本无法开发网站。

编辑以获取更多信息。

您所说的“类型 1”错误仅发生在 IE 中。您可以使用 Visual Studio 的副本对其进行调试。

然而，并不是你想要的。只需获得 Firebug，您就会想知道以前没有它是如何开发的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T04:23:30.100

Javascript 在客户端上运行，因此使用 ASP.NET 并不重要。调试器有多种选择，在大多数情况下，它只取决于您使用的浏览器。firefox 插件[Firebug](http://getfirebug.com/ "萤火虫")被许多人认为是最好的 javascript 调试器。在 IE7 中调试可能会很痛苦。您可以使用 Visual Studio 调试“类型 1”错误。我在 IE7 兼容模式下运行 IE8。IE8 有一个不错的内置脚本调试器。不幸的是，它的所有功能都与 IE7 不完全相同。

# linux - 连接两个 digium 卡和星号框时的 IRQ 问题

> ID：628920
> 
> 赞同：3
> 
> 时间：2009-03-10T04:15:52.210
> 
> 标签：linux, debian, interrupt, asterisk, irq

我有两个 Digium Wildcard TDM800P，每个都有 8 个 FXO 端口。当我同时连接两者时，IRQ 未命中开始出现，使我的计算机无响应且无法使用。

一张卡可以正常工作，但我需要所有 16 个 FXO 端口才能接听来自电信公司的电话。有没有办法让卡片相互通信，这样它们就不会产生尽可能多的中断。或者一种调整 Linux 为每张卡专用单独的 IRQ 的方法。

我尝试禁用音频、ACPI 和 USB 端口。仍然有太多的 IRQ 未命中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-30T19:20:04.017

这个问题最好在 serverfault 上发布，因为这是一个纯硬件问题。

您遇到的问题通常是典型的高中断 PCI 卡，特别是 Digium 电话卡。请记住，问题源于两个卡在**同一**PCI 总线上，您的目标是不让它们共享 IRQ 中断。

您可以尝试以下几件事来解决您的问题：

**1) 升级到 DAHDI 驱动程序**。他们有更好的 IRQ 争用。

**2) 将其中一张卡更换为另一个 PCI 插槽**。主板上的一些 PCI 插槽共享通道。你想避免这种情况。检查您的主板手册。此外，您可以执行以下操作

```
cat /proc/interrupts 
```

你应该收到这样的输出

```
 CPU0       CPU1       CPU2       CPU3
  0:         37          2          5          8   IO-APIC-edge      timer
  1:          1          1          0          0   IO-APIC-edge      i8042
  8:          0          0          1          0   IO-APIC-edge      rtc0
  9:          0          0          0          0   IO-APIC-fasteoi   acpi
 12:          1          0          0          3   IO-APIC-edge      i8042
 14:         33         35         31         30   IO-APIC-edge      ide0
 20:          0          0          0          0   IO-APIC-fasteoi   uhci_hcd:usb2
 21:         37         37         41         38   IO-APIC-fasteoi   uhci_hcd:usb1, uhci_hcd:usb3, ehci_hcd:usb4
1269:      14357      14387      14387      14372   PCI-MSI-edge      eth0
1270:       2523       2490       2489       2503   PCI-MSI-edge      ioc0
NMI:          0          0          0          0   Non-maskable interrupts
LOC:     487635     236288     376032      88504   Local timer interrupts
RES:        507        516        571        701   Rescheduling interrupts
CAL:        205        281        237        201   function call interrupts
TLB:       2835       2190       2221       1737   TLB shootdowns
TRM:          0          0          0          0   Thermal event interrupts
THR:          0          0          0          0   Threshold APIC interrupts
SPU:          0          0          0          0   Spurious interrupts
ERR:          0 
```

看看中断 21 是如何被 usb1、usb3 和 usb4 共享的？您不希望这种情况发生在您的 Digium 卡上。顺便说一句，Digium 卡通常显示为 TDPXXX。

**3) CPU 之间的负载平衡中断**- 如果您的 PC 有多个 CPU，并且您的内核和主板支持 IO-APIC，您可以在不同 CPU 之间负载平衡中断。这也将大大减轻 CPU 上的中断负载。如果您查看我之前发布的代码，您会发现本地定时器中断在 CPU 之间均匀分布。如果您的 Digium 卡只敲击一个 CPU（发生这种情况），您可以尝试以下方法来分散负载。假设我们想更改 IRQ 21（前面提到的 USB）

```
cat /proc/irq/21/smp_affinity
ffffffff 
```

所有这些“f”都告诉我们来自 IRQ 21 的中断负载在所有 CPU 之间是负载平衡的。如果要将其分配给某个 CPU，请将该 nuber 以十六进制形式添加到右侧。例如，假设我希望 USB 只中断 CPU0。

```
echo 1 > /proc/irq/21/smp_affinity 
cat /proc/irq/21/smp_affinity 
00000001 
```

所以现在只有第一个 CPU (CPU0) 可以接收这些中断。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T16:17:05.923

当您尝试在同一台计算机上安装多个 PCI Digium 卡时，PCI Digium 卡将无法正常工作。我在同一台计算机中使用 2 块 TE405 卡时遇到了类似的问题，因此不得不切换到 Sangoma 卡（我只需要 1 个 Sangoma，因为它们在同一张卡中最多支持 8 个 E1，这就是我所需要的）。或者您可以尝试 AEX800，它与 TDM800 类似，但它是 PCI-X 而不是普通的旧 PCI。IIRC 的问题与 PCI 相关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T16:37:32.253

JorgeO：听起来你需要更新你的驱动程序。最新的 zaptel 和 DAHDI 版本包括用于 TDM800P 的驱动程序，这些驱动程序以允许系统更能容忍主机系统中断延迟的方式配置电路板。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-08T04:01:42.963

我有 Debian 但不工作，更改 irq eth0 -> cpu0 a cpu2 cat /proc/irq/xxx/smp_affinity 00000003 但不工作进程继续 cpu0

# sql-server - 有什么方法可以在已安装的 sql2008 上启用全文搜索，而无需再次卸载它

> ID：628928
> 
> 赞同：1
> 
> 时间：2009-03-10T04:22:51.383
> 
> 标签：sql-server

有什么方法可以在已安装的 sql2008 上启用全文搜索，而无需再次卸载它

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T15:26:44.470

如果您在安装时没有将其安装为可选组件，那么再次运行安装程序应该会检测到现有的 SQL Server 实例。然后，您可以选择它作为安装的附加选项，它只会安装该组件。

您应该能够从添加/删除程序或 SQL Server DVD 重新运行安装程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T09:11:32.547

如果您认为您安装了它但它无法正常工作，您可能会发现您的“SQL Server Full-text Daemon Launcher”服务已被禁用。转到控制面板-> 管理工具-> 服务。找到“SQL Server Full-text Daemon Launcher”条目，右键单击并选择属性，然后启用它并启动服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T04:26:02.013

全文搜索默认开启，但可以在特定表格上切换。 [这](http://technet.microsoft.com/en-us/library/ms142536.aspx)是关于如何在 SQL Server 2008 中启用和禁用全文搜索的教程。

# c++ - CStatusBarCtrl GetItemRect XP 清单

> ID：628933
> 
> 赞同：1
> 
> 时间：2009-03-10T04:25:50.360
> 
> 标签：c++, mfc

在 MFC 中使用 CStatusBarCtrl 时，我使用 GetItemRect 来获取 CStatusBar 中每个项目的边界。

但是我现在看到了一个问题，我在 exe 中使用了 XP 清单。它不会返回正确的矩形，因此当鼠标位于控件的最右侧时，我不再正确识别。

这个问题可以用这样的方法来测试：

```
GetStatusBarCtrl().SetTipText(n - 1, _T("Test")); 
```

当创建一个 CStatusBarCtrl 并创建一个窗格`SetPaneInfo`时，当您将鼠标悬停在最右侧的窗格上时，上面设置的文本将不可见。

此问题已在[其他地方](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/fea7624d-da4c-4957-9de7-7cca7d56e8ef/)报告。但一直没有得到满意的答复。

我需要一个解决方案或解决方法会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T01:10:52.113

我的第一个猜测是 Vista 和 XP 中的“主题”之间的差异。请记住，如果您使用的是 CFrameWnd，则在状态栏最右侧的最后一个窗格中会有一个抓手控件。因此，看起来 ComCtl32.dll 中的更改可能会导致此问题，从而为您提供更小的矩形。我假设您只是看到比以前更小的 rect.Width() 吗？您不是同时在谈论较小的 X 和 Y 吗？

如果必须，您可能需要寻找正确的版本并将其与您的应用程序一起部署，或者让您的清单反映要使用的版本...

抱歉，我没有明确的答案，但我唯一想到的就是主题，因为如果我没记错的话，在 VC6 中，抓手被添加到状态栏的顶部，或者状态栏被缩小了足够显示它...

您可以使用的一个建议是检测您正在运行的 Windows 版本，并假设操作系统的抓手。抓手将与 VScroll 条的大小相同，因此您可以在运行时自然地从最后一个单元格中删除那么多 DLU（或像素），并基于此渲染文本。我得回家启动 VC6，看看它是如何根据你在这里所说的内容运行的......

我没有方便的 Vista 虚拟机来查看它默认安装的 ComCtl32.dll 版本，但我猜他们在其中放入了一些代码来处理抓手。

如果你有完整的示例代码，那真的会让我的事情变得更容易......否则，我必须开始挖掘我所有的旧 VC6 生成的代码并从那里开始......

一个有趣的测试是在我们认为可能对此产生影响的部分上调用 GetSystemMetrics，并查看它们在不同系统之间的差异。如果您将 Vista 置于“Windows 经典”模式，您还会看到相同的结果吗？

另外，您的开发箱是哪台机器？Vista还是XP？

# iphone - 如何在 iPhone 上执行 NTLM 挑战

> ID：628935
> 
> 赞同：10
> 
> 时间：2009-03-10T04:26:09.690
> 
> 标签：iphone, ntlm

我正在尝试访问 iPhone 应用程序中的一些网络服务。

如果我`GET`访问 .asmx 页面，我会按预期进行身份验证并获取 WSDL。

但是，如果我`POST`进入 .asmx 页面，设置 SOAPAction、Content-Type、Content-Length 和 HTTPBody，我只会不断收到`didReceiveAuthenticationChallenge`消息。

此外，我正在尝试使用集成 Windows 身份验证 (IWA) 发布到 IIS，这意味着我正在尝试协商 NTLM 质询。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-11T15:44:24.667

不幸的是，我找到了答案。NSURLConnection 无法进行 NTLM 身份验证。这是一篇关于如何使用 CFNetwork 堆栈进行 NTLM 身份验证的文章。

[通过 CFNetwork 堆栈的 HTTP Post](http://jameswilliams.me/developer/blog/2008/08/http-post-via-the-cfnetwork-stack/)

找到了比做所有这些乏味的事情更好的东西：已经做过的人！
[ASIHTTP请求](http://allseeing-i.com/ASIHTTPRequest-CFNetwork-wrapper-for-HTTP-requests)

**[更新： iOS 4](http://github.com/pokeb/asi-http-request/issues#issue/52)有一个解决方法，允许再次进行 NTLM 身份验证**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T05:22:06.043

在我看来，您的网络服务具有不同的读取（获取）和写入（发布）权限。我认为这根本不是 iPhone 或 NSURLConnection 的问题。

# optimization - 什么是写时复制？

> ID：628938
> 
> 赞同：166
> 
> 时间：2009-03-10T04:27:26.317
> 
> 标签：optimization, design-patterns, data-structures, copy-on-write, proxy-pattern

我想知道什么是*写时复制*以及它的用途。Sun JDK 教程中多次提到该术语。

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2009-03-10T04:29:57.590

我打算写我自己的解释，但[这篇维基百科文章](http://en.wikipedia.org/wiki/Copy-on-write)几乎总结了它。

**这是基本概念：**

> Copy-on-write（有时称为“COW”）是计算机编程中使用的一种优化策略。基本思想是，如果多个调用者请求最初无法区分的资源，您可以给他们指向同一资源的指针。这个函数可以一直保持到调用者试图修改其资源的“副本”，此时会创建一个真正的私有副本以防止更改对其他人可见。所有这些都对调用者透明地发生。主要优点是，如果调用者从不进行任何修改，则不需要创建私有副本。

**这里还有一个常用的 COW 应用程序：**

> COW 概念还用于维护数据库服务器（如 Microsoft SQL Server 2005）上的即时快照。即时快照通过在更新底层数据时存储数据的修改前副本来保留数据库的静态视图。即时快照用于测试用途或与时刻相关的报告，不应用于替换备份。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2009-03-10T04:32:17.320

“写入时复制”或多或少的意思是：每个人都拥有相同数据的一个共享副本，*直到它被写入*，然后复制。通常，写时复制用于解决并发问题。例如，在[ZFS中，磁盘上的数据块被分配写时复制；](https://en.wikipedia.org/wiki/ZFS)只要没有变化，你就保留原来的块；更改仅更改了受影响的块。这意味着分配了最少数量的新块。

这些更改通常也被实现为*事务性*的，即它们具有[ACID](https://en.wikipedia.org/wiki/ACID)属性。这消除了一些并发问题，因为这样可以保证所有更新都是原子的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-10T05:08:10.227

我不会在 Copy-on-Write 上重复相同的答案。我认为[安德鲁的回答](https://stackoverflow.com/a/628943/5501940)和[查理的回答](https://stackoverflow.com/a/628945/5501940)已经说得很清楚了。我会给你一个来自操作系统世界的例子，只是提到这个概念的使用范围有多广。

我们可以使用`fork()`或`vfork()`创建一个新的进程。vfork 遵循写时复制的概念。例如，vfork 创建的子进程会与父进程共享数据和代码段。这加快了分叉时间。如果您在执行 exec 后执行 vfork，则应使用 vfork。因此 vfork 将创建子进程，该子进程将与其父进程共享数据和代码段，但是当我们调用 exec 时，它将在子进程的地址空间中加载新可执行文件的映像。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-09-24T05:08:41.020

再举一个例子，[Mercurial 使用写](http://hgbook.red-bean.com/read/a-tour-of-mercurial-the-basics.html#ftn.id346621)时复制使克隆本地存储库成为一项真正“便宜”的操作。

原理与其他示例相同，只是您谈论的是物理文件而不是内存中的对象。最初，克隆不是复制品，而是与原件的[硬链接。](http://en.wikipedia.org/wiki/Hard_link)当您更改克隆中的文件时，会写入副本以表示新版本。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-04-14T00:31:08.357

Erich Gamma 等人的《[*设计模式：可重用的面向对象软件的元素》一书。*](https://en.wikipedia.org/wiki/Design_Patterns)清楚地描述了*写时复制*优化（“后果”部分，“代理”一章）：

> 代理模式在访问对象时引入了一定程度的间接性。附加间接有很多用途，具体取决于代理的类型：
> 
> 1.  远程代理可以隐藏对象驻留在不同地址空间的事实。
> 2.  虚拟代理可以执行优化，例如按需创建对象。
> 3.  保护代理和智能引用都允许在访问对象时执行额外的内务处理任务。
> 
> 代理模式可以对客户端隐藏另一个优化。它被称为**写时复制**，它与按需创建有关。复制一个大而复杂的对象可能是一项昂贵的操作。如果从不修改副本，则无需产生此费用。通过使用代理来推迟复制过程，我们确保只有在对象被修改时才支付复制对象的代价。
> 
> 要使写时复制工作，必须对主题进行引用计数。复制代理只会增加这个引用计数。只有当客户端请求修改主题的操作时，代理才会真正复制它。在这种情况下，代理还必须减少主题的引用计数。当引用计数变为零时，主题将被删除。
> 
> Copy-on-write 可以显着降低复制重量级主题的成本。

下面是使用[代理模式](https://en.wikipedia.org/wiki/Proxy_pattern)的写时复制优化的 Python 实现。这种设计模式的目的是为另一个对象提供一个代理来控制对它的访问。

代理模式的类图：

[![代理模式的类图](https://i.stack.imgur.com/cvmmq.png)](https://i.stack.imgur.com/cvmmq.png)

Proxy模式的对象图：

[![代理模式的对象图](https://i.stack.imgur.com/KEhhM.png)](https://i.stack.imgur.com/KEhhM.png)

首先我们定义主题的接口：

```
import abc

class Subject(abc.ABC):

    @abc.abstractmethod
    def clone(self):
        raise NotImplementedError

    @abc.abstractmethod
    def read(self):
        raise NotImplementedError

    @abc.abstractmethod
    def write(self, data):
        raise NotImplementedError 
```

接下来我们定义实现主题接口的真实主题：

```
import copy

class RealSubject(Subject):

    def __init__(self, data):
        self.data = data

    def clone(self):
        return copy.deepcopy(self)

    def read(self):
        return self.data

    def write(self, data):
        self.data = data 
```

最后我们定义实现主题接口并引用真实主题的代理：

```
class Proxy(Subject):

    def __init__(self, subject):
        self.subject = subject
        try:
            self.subject.counter += 1
        except AttributeError:
            self.subject.counter = 1

    def clone(self):
        return Proxy(self.subject)  # attribute sharing (shallow copy)

    def read(self):
        return self.subject.read()

    def write(self, data):
        if self.subject.counter > 1:
            self.subject.counter -= 1
            self.subject = self.subject.clone() # attribute copying (deep copy)
            self.subject.counter = 1
        self.subject.write(data) 
```

然后，客户端可以通过使用代理作为真实主题的替身，从写时复制优化中受益：

```
if __name__ == '__main__':
    x = Proxy(RealSubject('foo'))
    x.write('bar')
    y = x.clone()  # the real subject is shared instead of being copied
    print(x.read(), y.read())  # bar bar
    assert x.subject is y.subject
    x.write('baz')  # the real subject is copied on write because it was shared
    print(x.read(), y.read())  # baz bar
    assert x.subject is not y.subject 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-11-15T12:44:04.860

我发现[这篇](https://entwickler.de/webandphp/how-php-manages-variables-125644.html)关于 PHP 中 zval 的好文章也提到了 COW：

> Copy On Write（缩写为“COW”）是一种旨在节省内存的技巧。它更普遍地用于软件工程。这意味着当你写入一个符号时，PHP 将复制内存（或分配新的内存区域），如果这个符号已经指向一个 zval。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T05:24:08.210

它还用于 Ruby“企业版”作为节省内存的巧妙方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-09-14T18:44:40.873

一个很好的例子是 Git，它使用一种策略来存储 blob。为什么它使用哈希？部分是因为这些更容易执行差异，但也因为使优化 COW 策略更简单。当您使用少量文件更改进行新提交时，绝大多数对象和树都不会更改。因此，提交时，会通过各种由哈希组成的指针引用一堆已经存在的对象，使得存储整个历史所需的存储空间更小。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-12-31T06:55:27.167

这是一个内存保护概念。在这个编译器中创建额外的副本来修改子数据，并且这个更新的数据不会反映在父数据中。

# asp.net-mvc - 为 Amazon S3（或其他 CDN）扩展/替换 Html.Image

> ID：628940
> 
> 赞同：0
> 
> 时间：2009-03-10T04:28:43.943
> 
> 标签：asp.net-mvc, amazon-s3, html-helper

只是想确认没有编写替换函数就无法扩展或替换 Html.Image 功能。

我想编写一个函数，它将使用 Amazon 的 S3 服务来托管图像。

我想出的最好方法是一个辅助方法`Html.SmartImage`，它会检查配置属性，看看我是否想去亚马逊。它甚至可以检查远程托管的文件数据库，如果它们在该列表中，则仅“将它们排除在外”。

当我完成它时，我会发布我所拥有的 - 但对任何“开箱即用”的想法感到好奇。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T06:06:40.307

这就是我所做的——至少现在是这样：

**搜索和替换：**

```
 html.image("~ 
```

为了

```
 Html.CDNImage("~ 
```

然后在静态类中创建了一个助手`ImageExtensions`：

```
public static string CDNImage(this HtmlHelper htmlHelper, string imageRelativeUrl)
        {
            return CDNImage(htmlHelper, imageRelativeUrl, null, null);
        }

        public static string CDNImage(this HtmlHelper htmlHelper, string imageRelativeUrl, object htmlAttributes)
        {
            return CDNImage(htmlHelper, imageRelativeUrl, null, htmlAttributes);

        }

        public static string CDNImage(this HtmlHelper htmlHelper, string imageRelativeUrl, string alt, object htmlAttributes)
        {
            string url = Regex.Replace(imageRelativeUrl, "~/content/", "http://s3.amazon.com/", RegexOptions.Compiled | RegexOptions.IgnoreCase);

            return htmlHelper.Image(url, alt, htmlAttributes);

        } 
```

显然我在`s3.amazon.com`这里用作占位符 - 无论它是什么，您都必须填写 CDN 的 URL。

如果需要，您可以使用某种配置属性来确定您是否实际进行替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T04:35:50.930

不，你是对的，你需要创建自己的扩展方法来处理这样的自定义场景。

# networking - 在网络上定位设备的最佳方法是什么？

> ID：628949
> 
> 赞同：2
> 
> 时间：2009-03-10T04:35:51.460
> 
> 标签：networking, multicast, zeroconf, service-discovery

我正在为一家销售硬件设备的公司开发软件。他们希望该软件能够定位网络上的所有设备，而不限制他们的任何一个 IP。

最好的方法是什么？我在想硬件可以订阅一个“已知的”多播地址，让软件广播给它，硬件会回复。设备和软件将驻留在同一个 LAN 上，所以我不担心多播被阻止。我只是担心将来我会发现“已知”地址已经在使用中。一旦我在野外拥有设备，我就不可能更改此协议。请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T04:44:10.380

[通用即插即用](http://en.wikipedia.org/wiki/Universal_Plug_and_Play)、Bonjour 或其他[零配置网络](http://en.wikipedia.org/wiki/Zeroconf)技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T04:39:53.480

您可以查看构建[零配置网络](http://en.wikipedia.org/wiki/Zero_configuration_networking)的各种方法。

# oop - 构造函数与工厂方法

> ID：628950
> 
> 赞同：201
> 
> 时间：2009-03-10T04:38:29.020
> 
> 标签：oop, ooad

建模类时，首选的初始化方式是什么：

1.  构造函数，或
2.  工厂方法

使用其中任何一个的考虑因素是什么？

在某些情况下，如果无法构造对象，我更喜欢使用返回 null 的工厂方法。这使代码整洁。在采取替代操作之前，我可以简单地检查返回的值是否不为空，而不是从构造函数中抛出异常。（我个人不喜欢例外）

比如说，我在一个需要 id 值的类上有一个构造函数。构造函数使用此值从数据库中填充类。在具有指定 id 的记录不存在的情况下，构造函数会抛出 RecordNotFoundException。在这种情况下，我将不得不将所有此类类的构造包含在 try..catch 块中。

与此相反，我可以在那些类上使用静态工厂方法，如果找不到记录，它将返回 null。

在这种情况下，构造函数或工厂方法哪种方法更好？

* * *

## 回答 #1

> 赞同：241
> 
> 时间：2009-03-10T05:18:28.923

问问自己它们是什么以及我们为什么拥有它们。他们都在那里创建对象的实例。

```
ElementarySchool school = new ElementarySchool();
ElementarySchool school = SchoolFactory.Construct(); // new ElementarySchool() inside 
```

到目前为止没有区别。现在假设我们有各种学校类型，我们想从使用 ElementarySchool 切换到 HighSchool（它派生自 ElementarySchool 或实现与 ElementarySchool 相同的 ISchool 接口）。代码更改将是：

```
HighSchool school = new HighSchool();
HighSchool school = SchoolFactory.Construct(); // new HighSchool() inside 
```

如果是接口，我们将拥有：

```
ISchool school = new HighSchool();
ISchool school = SchoolFactory.Construct(); // new HighSchool() inside 
```

现在，如果您在多个地方都有此代码，您会看到使用工厂方法可能非常便宜，因为一旦您更改了工厂方法，您就完成了（如果我们使用带有接口的第二个示例）。

这是主要的区别和优势。当您开始处理复杂的类层次结构并希望从这样的层次结构中动态创建类的实例时，您会得到以下代码。然后，工厂方法可能会接受一个参数，该参数告诉该方法要实例化哪个具体实例。假设您有一个 MyStudent 类，您需要实例化相应的 ISchool 对象，以便您的学生成为该学校的成员。

```
ISchool school = SchoolFactory.ConstructForStudent(myStudent); 
```

现在，您的应用程序中有一个位置包含确定要为不同的 IStudent 对象实例化的 ISchool 对象的业务逻辑。

所以 - 对于简单的类（值对象等），构造函数就可以了（你不想过度设计你的应用程序），但对于复杂的类层次结构，工厂方法是一种首选方式。

这样，您就可以遵循[四本书](https://rads.stackoverflow.com/amzn/click/com/0201633612)“程序到接口，而不是实现”中的第一个设计原则。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2009-03-10T07:26:10.053

您需要阅读（如果您有权访问）[Effective Java 2](https://rads.stackoverflow.com/amzn/click/com/0321356683) **第 1 项：考虑静态工厂方法而不是构造函数**。

静态工厂方法的优点：

1.  他们有名字。
2.  每次调用它们时都不需要创建新对象。
3.  它们可以返回其返回类型的任何子类型的对象。
4.  它们减少了创建参数化类型实例的冗长。

静态工厂方法的缺点：

1.  当仅提供静态工厂方法时，不能对没有公共或受保护构造函数的类进行子类化。
2.  它们不容易与其他静态方法区分开来

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2009-03-10T04:43:27.213

[来自Gamma、Helm、Johnson 和 Vlissides](https://rads.stackoverflow.com/amzn/click/com/0201633612)的 Design Patterns: Elements of Reusable Object-Oriented Software 第 108 页。

使用工厂方法模式

*   一个类不能预测它必须创建的对象类
*   一个类希望它的子类指定它创建的对象
*   类将责任委托给几个助手子类之一，并且您希望本地化哪个助手子类是委托的知识

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2009-03-10T04:41:21.633

默认情况下，应该首选构造函数，因为它们更易于理解和编写。但是，如果您特别需要将对象的构造细节与其客户端代码所理解的语义分离，则最好使用工厂。

构造函数和工厂之间的区别类似于变量和指向变量的指针。还有另一个间接级别，这是一个缺点。但是还有另一个级别的灵活性，这是一个优势。因此，在做出选择时，建议您进行成本与收益分析。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-03-10T07:12:38.323

仅当您需要对对象创建进行额外控制时才使用工厂，这是构造函数无法完成的。

例如，工厂可以进行缓存。

使用工厂的另一种方法是在您不知道要构造的类型的情况下。您经常在插件工厂场景中看到这种类型的用法，其中每个插件都必须从基类派生或实现某种接口。工厂创建从基类派生或实现接口的类的实例。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2010-11-27T22:50:50.913

引用自“Effective Java”，第 2 版，第 1 项：考虑静态工厂方法而不是构造函数，p。5：

“请注意，**静态工厂方法与设计模式**[Gamma95, p. 107] 中的工厂方法模式不同。本项目中描述的静态工厂方法在设计模式中没有直接等效项。”

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2018-09-04T14:47:04.597

除了*“有效的java”*（在另一个答案中提到），[另一本经典书籍](https://rads.stackoverflow.com/amzn/click/com/0132350882)也建议：

> 与重载的构造函数相比，更喜欢静态工厂方法（具有描述参数的名称）。

例如。不要写

```
Complex complex = new Complex(23.0); 
```

而是写

```
Complex complex = Complex.fromRealNumber(23.0); 
```

这本书甚至建议将`Complex(float)`构造函数设为私有，以强制用户调用静态工厂方法。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-03-10T12:30:42.350

来自 CAD/CAM 应用程序的具体示例。

将使用构造函数制作切割路径。它是一系列定义切割路径的线和弧。虽然一系列线和弧可以不同并且具有不同的坐标，但通过将列表传递给构造函数可以轻松处理。

将使用工厂制作形状。因为虽然有一个形状类，但每个形状的设置都会有所不同，具体取决于它的形状类型。在用户做出选择之前，我们不知道要初始化什么形状。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2015-09-22T10:17:06.157

> 比如说，我在一个需要 id 值的类上有一个构造函数。构造函数使用此值从数据库中填充类。

这个过程绝对应该在构造函数之外。

1.  构造函数不应访问数据库。

2.  构造函数的任务和原因是*初始化数据成员*并使用传递给构造函数的值*建立类不变量。*

3.  对于其他一切，更好的方法是使用*静态工厂方法*，或者在更复杂的情况下使用单独的*工厂*或*构建器*类。

[来自 Microsoft 的一些构造函数指南](https://msdn.microsoft.com/en-us/library/vstudio/ms229060%28v=vs.100%29.aspx)：

> 在构造函数中做最少的工作。除了捕获构造函数参数之外，构造函数不应该做太多工作。任何其他处理的成本应延迟到需要时。

和

> 如果所需操作的语义不直接映射到新实例的构造，请考虑使用静态工厂方法而不是构造函数。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-03-29T14:34:24.893

有时您必须在创建对象时检查/计算一些值/条件。如果它可以抛出异常-constructro 是非常糟糕的方法。所以你需要做这样的事情：

```
var value = new Instance(1, 2).init()
public function init() {
    try {
        doSome()
    }
    catch (e) {
        soAnotherSome()
    }
} 
```

所有额外的计算都在 init() 中。但只有作为开发人员的你才真正了解这个 init()。当然，几个月后你就会忘记它。但是，如果你有一个工厂——只需在一种方法中完成所有你需要的操作，即从直接调用中隐藏这个 init()——所以没有问题。使用这种方法在创建和内存泄漏方面没有问题。

有人告诉你关于缓存。很好。但是您还必须记住 Flyweight 模式，它非常适合与 Factory 方式一起使用。

# python - Web 环境中的文件访问权限提升

> ID：628956
> 
> 赞同：1
> 
> 时间：2009-03-10T04:42:25.140
> 
> 标签：python, linux, permissions, serial-port, cgi

我有一种情况，我想提升我在 Web 环境中的权限，以便我可以访问串行设备。

具体情况是我有一个用于配置调制解调器的 Web 界面`/dev/ttyUSB[0-9]`。

最终用户将插入零个或多个调制解调器。我正在编写一些软件，该软件能够通过`/sys/devices`使用一些 AT 命令读取和与调制解调器交谈来辨别哪个是 USB 无线调制解调器。

我希望能够打开设备并执行以下操作：

```
ser = serial.Serial(tty, baudrate=115200, timeout=10)
ser.write('AT+CGSN\r\n')
imei = ser.readline() 
```

问题在于这样`pyserial`做：`self.fd = os.open(self.portstr, os.O_RDWR|os.O_NOCTTY|os.O_NONBLOCK)`打开 portstr 所在的串行端口，`/dev/ttyUSB0`但它`nobody`是以非特权用户身份进行的。

此系统上的串行端口归 root:uucp 所有，并设置为 0660（即`rw-rw----`）。

对于用户（例如`nobody`应该拥有尽可能少的权限）在 dev 中打开文件的用户来说，最好的方法是什么？

我会考虑的想法：

*   使用`sudo`.
*   更改文件的权限`/dev/`（感谢有关如何使用 udev 正确执行此操作的说明！）
*   使用我没有考虑过的其他 API 或软件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T07:48:12.573

在这种情况下，我会编写一个由系统用户运行的守护进程，它接受套接字连接并将它们中继到适当的设备，然后使用 Web 应用程序中的套接字与守护进程对话。这也有助于在打开尚未准备好与用户打交道的设备时防止 Web 应用程序阻塞，比使用 CGI 更理智地解决锁定等问题。

但是，如果您希望应用程序能够直接与设备对话，请授予它们与 null 相同的权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T10:18:07.177

还有另一种方法：Unix/Linux 允许通过 Unix 套接字发送文件描述符。甚至还有一个 Perl 模块：[PassAccessRights.pm](http://search.cpan.org/~sampo/Socket-PassAccessRights-0.03/PassAccessRights.pm)。没有找到类似的 Python 模块，但可以轻松实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T09:54:11.087

“对于应该拥有尽可能少权限的用户（例如 nobody ）在 dev 中打开文件的最佳方式是什么？”

实际上，您最好在 Web 应用程序的守护程序模式下使用 mod_wsgi。mod_wsgi 用户可以是您提供的任何用户名（和组）。

您可以以具有适当定义权限的用户身份运行。

请参阅[http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIDaemonProcess](http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIDaemonProcess)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T22:02:29.767

如果允许通过 Web 界面进行的每次访问都允许对设备进行相同的访问，则配置*udev*规则以将新设备*chgrp为**nobody 。*这是我在文件 /etc/udev/rules.d/99-bpw.rules 中放入我的*eee-bpw**包*的内容。

```
# Sierra Wireless AirCard 880 U
BUS=="usb", KERNEL=="ttyUSB2*", ACTION=="add", \
   PRODUCT=="1199/6855/0", DEVNAME=="/dev/tts/USB2", \
   OWNER="root", GROUP="dialout", \
   SYMLINK+="bpw", RUN="/usr/sbin/bpw" 
```

用*nobody*代替*dialout*。此特定规则假定设备名称为*/dev/ttyUSB2*，但您可以大大扩展该规则，请参阅*udev*文档。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-10T05:34:16.577

sudo 的想法是可能的。IIRC，您可以将特定命令设置为 sudo-able，但不需要密码。

另一种选择是放入`nobody`一个可以访问所需设备的组，或者将 Apache 作为可以访问的组启动。

如果您使用的是 fastcgi（或等效），我认为您可以让它以拥有用户的身份运行脚本（一些共享主机会这样做）。

要更改 中文件的权限`/dev`，只需 chmod 它们。

# java - 春天框架

> ID：628963
> 
> 赞同：11
> 
> 时间：2009-03-10T04:44:10.613
> 
> 标签：java, hibernate, spring

什么是 Spring 框架？它对 Hibernate 有什么贡献？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-10T10:17:33.463

Hibernate 是一个对象关系映射工具，是 Sun 的 Entity Beans 2.0 的替代品。多年来，Hibernate 已成为 Java 中对象持久性的“事实上的标准”，今天的 JPA API 深受 Hibernate 的启发（可用作 JPA 实现）。

Spring 是一个依赖注入框架，它允许您连接组件并受益于附加服务，如声明式事务管理、声明式安全、与许多其他框架的集成、抽象层等。创建 Spring 是为了简化企业 Java 应用程序的开发并使其在没有 EJB 和“重量级”容器的情况下是可能的。使用 Spring 和 Hibernate 以及例如 Tomcat，您将获得一个不错的 Enterprise 堆栈。Spring 是一个“轻量级”的容器。

Spring 和 Hibernate 极大地影响了我们构建 Java 应用程序的方式，它们的采用证明了简化的必要性。尽管如此，我仍将 Java EE 5 视为 Sun 对这些“非标准”解决方案的回答，以简化 Java Enterprise 开发。

所以是的，Spring Hibernate 被广泛使用，Spring 提供 Hibernate（和 JPA）集成，但 Spring 和 Hibernate 是两个不同的项目，具有独立的董事会和治理。他们有共同的利益，但 IMO Hibernate 团队管理 Hibernate，Spring 团队管理 Spring。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-13T19:27:38.610

Spring 框架 ( [http://www.springframework.org](http://www.springframework.org) ) 是基于 Java EE 的应用程序的开发堆栈。最初的[依赖注入](http://martinfowler.com/articles/injection.html)容器已经发展成为基于[POJO](http://www.martinfowler.com/bliki/POJO.html)的企业应用程序编程模型，提供开箱即用的常用服务和抽象（事务管理、缓存、批处理等）。

[与 Hibernate（它是一个对象关系映射](http://en.wikipedia.org/wiki/Object-relational_mapping)框架）没有直接关系，但在其 ORM 模块中，Spring 为其提供了一个集成层。将它与 Hibernate 结合使用的好处包括：

*   能够使用声明式事务划分（通过 Spring 的 AOP 机制透明地应用）

*   数据访问层的异常转换（从用于实现 DAO 接口的实际持久性技术中抽象出来）

因此，虽然 Spring 实际上并没有对 Hibernate 做出贡献（据我所知），但它与 Hibernate 配合得很好，并提供了一些方便的好处。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-10T04:45:36.053

以下是一些应该可以帮助您的链接：

[http://en.wikipedia.org/wiki/Spring_framework](http://en.wikipedia.org/wiki/Spring_framework)
[http://www.springsource.org/](http://www.springsource.org/)
[http://static.springframework.org/spring/docs/2.0.x/reference/index.html](http://static.springframework.org/spring/docs/2.0.x/reference/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T15:28:32.740

Spring 和 Hibernate 是两个独立的框架，可以一起使用，但除此之外彼此无关。

Hibernate 是一个对象-关系映射工具。它可以帮助想要使用与关系数据库表相关的域对象的开发人员。如果使用 Hibernate，则以编程方式连接到数据库或解析结果集等任务的复杂性会大大降低。

Spring 框架是一个提供多种工具的框架，它们都基于少量的核心概念。这些概念中最著名的是依赖注入，它允许对象的松散耦合，有助于简化开发和测试。

开箱即用，Spring 提供了多种工具来帮助与其他框架很好地配合使用——Hibernate 就是其中之一。尽管 Hibernate 是一个很棒的工具，但在编写执行数据库操作的代码以及异常处理方面存在一定程度的复杂性。Spring 的 Hibernate Template 试图解决这个问题。这可能就是您所说的他们的“贡献”，尽管据我所知，Hibernate 背后的人并不是这种支持的忠实拥护者。

您可以在没有 Hibernate 的情况下使用 Spring 或在没有 Spring 的情况下使用 Hibernate。您甚至可以拥有一个使用 Hibernate 和 Spring 但不使用 Spring Hibernate 模板的项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-10T23:05:50.200

Spring 是一个轻量级容器（和框架），它使 J2EE 开发更容易、更快且可扩展。它与 Hibernate 有很好的集成功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-02T09:19:13.273

**弹簧框架**

*   强大的开源。
*   轻量级应用程序框架。
*   降低整体复杂性。
*   综合工具。
*   框架的框架。
*   利用一系列资源。

**为什么春天如此受欢迎？**

*   MVC
*   灵活，因为它使用接口。
*   更容易测试。
*   国际奥委会。
*   与视图技术更好地集成。

# delphi - Delphi - 从由无类型指针填充的动态数组访问数据

> ID：628965
> 
> 赞同：3
> 
> 时间：2009-03-10T04:45:41.140
> 
> 标签：delphi, arrays, dynamic, pointers, pascal

我使用的是**Delphi 2009**，并不是说它对我正在做的事情有很大影响。如果我还在**2007 年**，我想我会遇到同样的情况。

我有一个将数据输出到指针的 scsi 调用（错误的查看方式，但我无法解释）。

最初我使用**Move**用返回的数据填充**静态字节数组**，但我想切换到在调用时已知长度的**动态数组。**我已经尝试了几件事，结果各不相同，有些得到了数据，但有疯狂的访问冲突，有些没有错误，但得到了无效的数据。

将**setlength**添加到数组，然后使用**move**，首先导致设置长度为空数组，然后第二次无法通过像**OutputData[0]**那样访问数据，就像我在静态时所做的那样，在移动后的调试器中一切都显示为无价之宝或其他任何东西。

下面是我在阅读一篇文章后尝试的，该文章确实反对采用动态数组并给出了该地址的指针。它提到了像孤立数据这样的错误。

```
var
  Output: Pointer;
  OutputData: Array of byte;
  I: Integer;
begin
GetMem(Output, OutputLength.Value);
if SendPSPQuery(Char(DriveLetter[1]), cbxQuery.Items.IndexOf(cbxQuery.Text), Output, OutputLength.Value) = 0 then
  begin
    OutputData := @Output;
    for I := 0 to OutputLength.Value - 1 do
    begin
      edtString.Text := edtString.Text + Char(OutputData[I]);
    end; 
```

输出数据还有很多其他用途，因为它以字符串和十六进制等形式输出。

无论如何，我如何使用指针将该数据放入动态数组中，然后以您寻址数组的方式获取该数据。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-10T07:24:40.370

[要在`Move`过程](http://www.delphibasics.co.uk/RTL.asp?Name=Move)中使用动态数组，您需要传递数组的*第一个元素*。例如：

```
var
  Source: Pointer;
  SourceSize: Integer;
  Destination: array of Byte;

SetLength(Destination, SourceSize);
Move(Source^, Destination[0], SourceSize); 
```

另请注意，第二个参数取消引用指针。那是因为`Move`获取您正在复制的*值*，而不是指向该值的指针。你正在复制你的指针指向的东西，所以这就是你需要传递给`Move`.

顺便说一句，如果`Destination`是静态数组，同样的语法也适用。你是对的，这并不是 Delphi 2009 特有的。一直到 Delphi 4 都是如此，那是引入动态数组的时候。并且永远`Move`具有相同的奇怪的[无类型参数](http://www.cs.wisc.edu/~rkennedy/untyped)语法。

* * *

不要分配您自己的内存`GetMem`然后进行类型转换以使编译器认为您拥有的是动态数组。**不是**。动态数组具有普通字节缓冲区没有的引用计数和长度字段，并且由于您无法控制编译器为访问假定的动态数组而生成的所有代码，因此您的程序可能会尝试访问数据结构中不存在的数据。

您可以让 PSP 函数将其数据直接存储到动态数组中。这是一些代码：

```
var
  Output: array of Byte;

SetLength(Output, OutputLength.Value);
if SendPSPQuery(Char(DriveLetter[1]),
                cbxQuery.Items.IndexOf(cbxQuery.Text),
                @Output[0],
                OutputLength.Value) = 0
then 
```

之后无需释放内存；当`Output`超出范围并且没有其他对数组的引用时，编译器会插入代码以释放动态数组。此代码接受一个动态数组并将其作为普通缓冲区传递。这有效且安全，因为动态数组实际上是普通旧缓冲区的子类型。该函数将接受指向数组第一个元素的指针，并将指针视为指向一堆字节的指针，因为这正是它的本质。该函数不需要知道与程序用于动态数组簿记的那些字节相邻的其他内容。

* * *

如果您将数据放在缓冲区中，并且希望将该缓冲区视为数组，而*不是*将数据复制到单独的数据结构中，那么您有两种选择。

1.  声明一个静态数组*指针*，然后将缓冲区指针类型转换为该类型。这是经典的技术，你可以看到它在很多地方的代码中使用，尤其是在 Delphi 4 之前的代码。例如：

    ```
    type
      PByteArray = ^TByteArray;
      TByteArray = array[0..0] of Byte;
    var
      ByteArray: PByteArray;

    ByteArray := PByteArray(Output);
    for i := 0 to Pred(OutputLength.Value) do begin
      {$R-}
      edtString.Text := edtString.Text + Chr(ByteArray[i]);
      {$R+}
    end; 
    ```

    这些`$R`指令是为了确保该代码的范围检查被关闭，因为数组类型被声明为长度为 1。该数组被声明为具有该大小，部分是为了作为您不应该真正声明的线索该类型的变量。只能通过指针使用它。另一方面，如果您知道合适的最大数据大小，您可以使用该大小来声明数组类型，然后您可以保持打开范围检查。（如果您通常禁用范围检查，那么您只是在自找麻烦。）

2.  将缓冲区声明为`PByte`，`Pointer`然后使用 Delphi 的新（自 Delphi 2009 起）[支持将任意指针类型视为数组指针](http://blogs.embarcadero.com/abauer/2008/01/24/38852)。在以前的版本中，只有`PChar`、`PAnsiChar`和`PWideChar`支持这种语法。例如：

    ```
    var
      Output: PByte;

    for i := 0 to Pred(OutputLength.Value) do begin
      edtString.Text := edtString.Text + Chr(Output[i]);
    end; 
    ```

    `$POINTERMATH`不需要编译器指令来启用此功能，因为`PByte`该类型是在该指令生效时*声明的。*如果您想对*其他*指针类型执行类似 C 的指针操作，请放在`{$POINTERMATH ON}`使用新扩展语法的代码之前。

* * *

最后一点，您不需要一次构建一个字符的字符串。浪费在两个方面。首先，您正在构建大量字符串，每个字符串仅比前一个字符串大两个字节。其次，由于您将字符串结果存储在编辑控件中，因此您也强制该控件的操作系统实现分配一堆新字符串。将您的数据放入*一个*字符串中，然后一次将其全部附加到您的编辑控件中：

```
var
  OutputString: AnsiString;

SetString(OutputString, PAnsiChar(Buffer), OutputLength.Value);
edtString.Text := edtString.Text + OutputString; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T05:40:44.173

没关系...哈哈，在搞砸了 2 个半小时后，我终于想通了。我尝试过的事情有点混乱，但它也能正常工作。

```
 type
  PDynByteArray = ^TDynByteArray;
  TDynByteArray = array of byte;

procedure TfrmMain.btnQueryClick(Sender: TObject);
var
  Output: Pointer;
  OutputData: PDynByteArray;
  WorkingData: Array of byte;
  DriveLetter: ShortString;
  I: Integer;
  HexOutput: String;
begin
edtSTRING.Clear;
memHEX.Clear;
GetMem(Output, OutputLength.Value);
DriveLetter := edtDrive.Text;
if SendPSPQuery(Char(DriveLetter[1]), cbxQuery.Items.IndexOf(cbxQuery.Text), Output, OutputLength.Value) = 0 then
  begin
    //Move(Output^,OutputData,56);
    OutputData := PDynByteArray(@Output);
    for I := 0 to OutputLength.Value - 1 do
    begin
      edtString.Text := edtString.Text + Char(OutputData^[I]);
    end;
    for I := 0 to OutputLength.Value - 1 do
    begin
      HexOutput := HexOutput + InttoHex(OutputData^[I],2) + ' ';
    end;
    memHex.Lines.Append(HexOutput);
    FreeMem(Output);
    memHex.SelStart := 0;
  end
else edtSTRING.Text := 'SCSI Command Failed';
end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T06:35:15.900

您可以使用 PByte。使用 {$POINTERMATH ON} 指令，您可以将此指针用作字节数组。

```
{$POINTERMATH ON}
var
  Output: Pointer;
  ar: PByte;
begin
  GetMem(Output, 100);
  ar:=Output;
  ShowMessage(IntToStr(ar[0])+IntToStr(ar[1])+'...');
end; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-02T08:08:17.070

无论如何，输出绘图需要时间的原因是您正在查看 edtString.text 分配。这应该只分配一次，而不是循环分配。每次重新分配它时，都必须处理许多级别的内容，从字符串连接一直到屏幕上的操作系统绘图。您可以先建立一个字符串，然后在最坏的情况下在最后分配它。

# javascript - 如何使用 jQuery 获取该元素的索引？

> ID：628967
> 
> 赞同：5
> 
> 时间：2009-03-10T04:46:59.623
> 
> 标签：javascript, jquery, html, xhtml

我正在尝试使用 jQuery 获取元素的索引以发送到 PHP 脚本。

**这是我的 XHTML**

```
<form action="/accreditation/questions/" method="post" id="questions-form">
  <fieldset id="question-0">
    <legend>Question</legend>
    <h3>What colour is grass?</h3>    
    <ul>
      <li>
        <input type="radio" name="answer[0]" value="0" id="radio-0-0" />
        <label for="radio-0-0">Green</label>
      </li>
      <li>
        <input type="radio" name="answer[0]" value="1" id="radio-0-1" />
        <label for="radio-0-1">Red</label>
      </li>
      <li>
        <input type="radio" name="answer[0]" value="2" id="radio-0-2" />
        <label for="radio-0-2">Orange</label>
      </li>
    </ul>
  </fieldset>
  <fieldset id="question-1">
    <legend>Question</legend>
    <h3>how old is alex</h3>    
    <ul>
      <li>
        <input type="radio" name="answer[1]" value="0" id="radio-1-0" />
        <label for="radio-1-0">21</label>
      </li>
      <li>
        <input type="radio" name="answer[1]" value="1" id="radio-1-1" />
        <label for="radio-1-1">11</label>
      </li>
      <li>
        <input type="radio" name="answer[1]" value="2" id="radio-1-2" />
        <label for="radio-1-2">23</label>
      </li>
    </ul>
  </fieldset>
</form> 
```

我需要获取字段集元素的索引。我目前正在使用这个每个迭代器（我不想改变它，因为它里面有很多其他的功能）。

```
$('#questions-form ul li').each(function() {
    qIndex = $('fieldset').index($('fieldset', $(this).parent()))
}); 
```

我希望 qIndex 成为字段集相对于表单的索引。例如，在这种情况下，我应该让它等于 0 和 1（尽管会有 6 个值，因为它正在遍历列表元素）。

我已经玩了一段时间并且无法获得正确的索引。我一直找不到（-1）。

如果有帮助，这是我用来获取列表项相对于它包含 ul 元素的索引的代码。

```
index = $('li', $(this).parent()).index(this); 
```

### 我的字段集索引抓取代码有什么问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-10T04:57:45.697

的`LI`父级是`UL`，而不是`fieldset`。
我认为这将为`qIndex`您设置：

```
qIndex = $('fieldset').index($(this).parents('fieldset')); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T05:02:47.213

您还可以使用以下方法获取索引：

```
$("form fieldset").each(function(I) { 
    console.log("fieldset index"+ I);
}); 
```

# php - 如何在 Mac OS X 10.5 上不使用 PEAR 安装 PHPUnit？

> ID：628986
> 
> 赞同：7
> 
> 时间：2009-03-10T05:03:32.157
> 
> 标签：php, phpunit, pear

我在安装 PEAR 时遇到问题，但我真的只想安装 PHPUnit。有没有人有这样做的经验？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-08-09T18:30:19.193

# 通过 GIT 安装

您可以按照 Git README 中的说明进行操作：[https ://github.com/sebastianbergmann/phpunit/](https://github.com/sebastianbergmann/phpunit/)

## “git”文件并将它们放在你的主目录中

```
cd ~ && mkdir phpunit && cd phpunit
git clone git://github.com/sebastianbergmann/phpunit.git
git clone git://github.com/sebastianbergmann/dbunit.git
git clone git://github.com/sebastianbergmann/php-file-iterator.git
git clone git://github.com/sebastianbergmann/php-text-template.git
git clone git://github.com/sebastianbergmann/php-code-coverage.git
git clone git://github.com/sebastianbergmann/php-token-stream.git
git clone git://github.com/sebastianbergmann/php-timer.git
git clone git://github.com/sebastianbergmann/phpunit-mock-objects.git
git clone git://github.com/sebastianbergmann/phpunit-selenium.git 
```

## 设置个人二进制路径

```
cd ~ && mkdir bin
vi ~/.profile
>> export PATH=$HOME/bin:$PATH
>> :wq
source ~/.profile 
```

## 创建可执行文件

```
touch ~/bin/phpunit
chmod 755 ~/bin/phpunit 
```

## 编写可执行文件

```
#!/usr/bin/env php
<?php

// set main method
define('PHPUnit_MAIN_METHOD','PHPUnit_TextUI_Command::main');

// add phpunit to the include path
$paths = scandir($_ENV['HOME'].'/phpunit');
$includes = array();
foreach($paths as $path){
    if (!preg_match('/^\./', $path)){
        $includes[] = $_ENV['HOME'].'/phpunit/' . $path;
    }
}
set_include_path(implode(PATH_SEPARATOR,$includes).PATH_SEPARATOR.get_include_path());

// set the auto loader
require 'PHPUnit/Autoload.php';

// execute
PHPUnit_TextUI_Command::main(); 
```

## 测试可执行文件

```
which phpunit
phpunit --version 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-10T08:55:58.417

从[PHPUnit 安装指南](http://www.phpunit.de/manual/current/en/installation.html)：

> 虽然使用 PEAR 安装程序是安装 PHPUnit 的唯一支持方式，但您可以手动安装 PHPUnit。对于手动安装，请执行以下操作：

1.  [从http://pear.phpunit.de/get/](http://pear.phpunit.de/get/)下载发布存档并将其解压缩到 php.ini 配置文件的 include_path 中列出的目录。
2.  准备 phpunit 脚本：
    1.  将 phpunit.php 脚本重命名为 phpunit。
    2.  将其中的 @php_bin@ 字符串替换为 PHP 命令行解释器的路径（通常是 /usr/bin/php）。
    3.  将其复制到路径中的目录并使其可执行（chmod +x phpunit）。
3.  准备 PHPUnit/Util/Fileloader.php 脚本：
    1.  将其中的 @php_bin@ 字符串替换为 PHP 命令行解释器的路径（通常是 /usr/bin/php）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-18T18:31:15.920

我今天刚安装。我的步骤如下：

*   从 /get/ 下载 - 我用的是 3.3.9.tgz
*   将所有文件解压到 pear 目录（pear-phpunit、PHPUnit/ 等...）
*   将@php_bin@ 更改为指向上述文件中的我的php 二进制文件（/usr/bin/php）
*   创建从 pear-phpunit 到 /usr/local/bin/phpunit ( `ln -s /usr/share/php/pear/pear-phpunit /usr/local/bin/phpunit`)的符号链接

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T12:47:31.110

安德鲁，我目前正在努力安装 PHPUnit。发现在更新 php.ini 中的 include_path 后重新启动 Web 服务器会有很大帮助。现在寻找 PHP 命令行解释器的确切位置（这就是我到达这里的方式）。有消息通知你。

萨宾

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-27T00:19:07.193

我最近制作了一个phpunit 的[github 分支](https://github.com/gewthen/phpunit)，目前（大部分）不使用 pear 即可工作。它可能对你有用。

# .net - 如何添加新的数据库行，然后使用 GridView 控件对其进行编辑？

> ID：628988
> 
> 赞同：1
> 
> 时间：2009-03-10T05:04:48.317
> 
> 标签：.net, gridview

在我的应用程序中，我使用的是网格视图控件。

我正在使用以下代码在我的网格视图控件中创建一个新的空行：

```
string co = ConfigurationSettings.AppSettings["MyLogin"];
            SqlConnection connection = new SqlConnection(co);
            connection.Open();                
string sql = "insert into TeamMember_table "
          + "values('','','','','','','','','','','','')";                
SqlDataAdapter dp = new SqlDataAdapter(sql, connection);                
DataSet ds = new DataSet();                
dp.Fill(ds);                
gridview1.DataBind();               
connection.Close(); 
```

空行已成功添加，但我的问题是我想在此空行中输入值并在单击保存按钮时将此值保存到表中。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T05:22:07.650

a 的第一个参数`SqlDataAdapter`是要使用的`SELECT`语句；每次查询数据时，您的代码都会添加一个新的数据库行（这听起来非常非常错误），而且我预计由于对`INSERT`vs的混淆，查询本身不会真正起作用`SELECT`。

你真的应该只是做一个`SELECT`from `TeamMember_table`，然后*可能在**本地*数据表中添加一行：

```
string sql = "SELECT * FROM TeamMember_table";
SqlDataAdapter dp = new SqlDataAdapter(sql, connection);                
DataSet ds = new DataSet();   
dp.Fill(ds);
DataTable table = ds.Tables[0];
table.Rows.Add("", "", ..., "") 
```

就个人而言，我*不会*添加假行，除非它对绑定是绝对必要的；恐怕我不能就此提出建议……但是您需要小心不要意外添加空行。也许检查回发（假设为 ASP.NET），并且仅在其中包含有用的内容时才保存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T05:23:39.380

您可能希望使用 RowDataBoudn 和 RowDataDelete 等事件来实现这些行为。例如：

```
protected void Page_Load(object sender, EventArgs e) {
    GridView1.RowDataBound += GridView1_RowDataBound;
    GridView1.RowUpdated += GridView1_RowUpdated;
    if (!IsPostBack) {
        string co = ConfigurationManager.ConnectionStrings["MyConnectionString"];
        using (SqlConnection connection = new SqlConnection(co)) {
            connection.Open();
            string sql = "select ....";
            SqlDataAdapter dp = new SqlDataAdapter(sql, connection);
            DataSet ds = new DataSet();
            dp.Fill(ds);

            GridView1.DataSource = ds.Tables["MyTable"];
            GridView1.DataKeyNames = new string[] { "Id" };
            GridView1.DataBind();
        }                
    }
}

void GridView1_RowUpdated(object sender, GridViewUpdatedEventArgs e) {
    throw new NotImplementedException();
}

protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e) {
    if (e.Row.RowType == DataControlRowType.DataRow) {
        Label l = (Label)e.Row.FindControl("Label1");
        l.Text = "some text value";
    }
} 
```

# php - 帮助修复一个关于 mod_rewrite 的 htaccess 小问题

> ID：628989
> 
> 赞同：1
> 
> 时间：2009-03-10T05:06:06.007
> 
> 标签：php, apache, .htaccess, mod-rewrite

> RewriteCond %{HTTP_HOST} ^[az]+.orbno.com$
> RewriteCond %{HTTP_HOST} !^(www.)?orbno.com$
> RewriteCond %{REQUEST_URI} 下载/
> RewriteRule (.*) /download.php\?action =$1&用户=%1 [L]

两个小问题，这是输出：

数组(2) { ["action"]=> string(23) "下载/email-logo.png" ["user"]=> string(0) "" }

1.  我希望用户成为他们正在访问的子域，我有通配符 DNS，我如何通过它，因为 %1 不起作用。

2.  有没有办法只传递 email-logo.png 而不是 download/email-logo.png。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T05:14:57.967

在 freenode 上的 #apache 中的 Lump 帮助了我。

RewriteCond %{HTTP_HOST} ^([az]+).orbno.com$ RewriteCond %{HTTP_HOST} !^(www.)?orbno.com$ RewriteRule download/(.+) download.php?action=$1&user=% 1

不过谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T05:10:36.400

试试 $1 而不是 %1

# c# - 检索列表视图中的项目

> ID：628995
> 
> 赞同：0
> 
> 时间：2009-03-10T05:11:49.737
> 
> 标签：c#, .net, winforms

我正在使用`ListView.GetItemAt(x,y)`从 中检索项目`ListView`，但是当我将`FullRowSelect`选项设置为 时无法获取该项目`false`。

我不确定如何在 .NET 1.1 中执行此操作。有没有人有任何指示？

这是一个代码片段：

```
public int GetListViewSubItem(ListView listView1, Point pt)
{
     const int LVM_FIRST  = 0x1000;
     const int LVM_GETSUBITEMRECT  = (LVM_FIRST + 56);
     const int LVIR_BOUNDS = 0;

     RECT myrect;
     ListViewItem lvitem = listView1.GetItemAt(pt.X, pt.Y);
     if(lvitem == null && listView1.SelectedItems.Count > 0)
         lvitem = listView1.SelectedItems[0];

     int intLVSubItemIndex = -1;
     ListViewItem.ListViewSubItem LVSubItem = null;

     if(lvitem != null)
     {
         int intSendMessage;
         for ( int i = 1; i <= lvitem.SubItems.Count - 1; i++)
         {
             LVSubItem = lvitem.SubItems[i];
             myrect = new RECT();
             myrect.top = i;
             myrect.left = LVIR_BOUNDS;
             intSendMessage = SendMessage(listView1.Handle, 
                                          LVM_GETSUBITEMRECT,
                                          lvitem.Index, ref myrect);
             if (pt.X < myrect.left)
             {
                 LVSubItem = lvitem.SubItems[0];
                 intLVSubItemIndex = 0;
                 break;
             }
             else if (pt.X >= myrect.left & pt.X <= myrect.right)
             {
                 intLVSubItemIndex = i;
                 break;
             }
             else
                 LVSubItem = null;
         }
    }

    if (LVSubItem == null || lvitem == null)
    {
        intLVSubItemIndex = -1;
    }

    return intLVSubItemIndex;
} 
```

这个方法应该告诉我点击了哪个单元格。Tt 有效，但如果我将 to 更改`fullrowselect`为`false`，它会返回一个`null`值。

我什至尝试过`getitemat(0,e.y)`，但它没有用。

每当我在 中选择一个项目时`ListView`，它都会以蓝色突出显示，因此无法查看选择的内容。我正在尝试删除那个蓝色突出显示。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T05:24:49.517

你能详细说明你想要做什么吗？

您的 ListView 的 ViewStyle 是否设置为 Details？既然你提到将 FullRowSelect 设置为 false，我认为它是。

GetItemAt(x, y) 仅在鼠标单击属于某个项目的实际文本时才有效。因此，如果您单击了与项目相同的行，但在没有文本的列中单击，它将返回 null。

解决方法是简单地将 0 作为 x 参数传入：

```
private void listView1_MouseUp(object sender, MouseEventArgs e)
{
    ListViewItem item = listView1.GetItemAt(0, e.Y);
    if (item == null)
    {
        MessageBox.Show("Null");
    }
    else
    {
        MessageBox.Show(item.Text);
    }
} 
```

我可以确认这工作正常 - 即使只有第一列中有文本，它也会返回该行上的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T14:41:07.230

```
private int getSelectedSubItemIndex(ListView listView)
{
    if (listView.SelectedItems.Count == 1)
    {
        int x = 0;
        ListViewItem item = listView.SelectedItems[0];
        Point pt = listView.PointToClient(Control.MousePosition);
        for (int idx = 0; idx < item.SubItems.Count; ++idx)
        {
            x += listView.Columns[idx].Width;
            if (pt.X < x)
                return idx;
        }
    }
    return -1;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-05T02:50:55.620

```
 private void listView1_MouseClick(object sender, MouseEventArgs e)
    {
        int column = 0;
        ListViewItem item = listView1.GetItemAt(e.X, e.Y);
        for (column = 0; column < item.SubItems.Count; column++)
        {
            if (item.SubItems[column].Bounds.X > e.X) break;   
        }
        if (item != null)
        {
            textBox1.Text = item.SubItems[column-1].Text;
        }

    } 
```**********