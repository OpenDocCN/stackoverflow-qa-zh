# StackOverflow 问答 12338000-12338999

# html - 是什么导致使用 960 网格系统在我的 div 中出现额外空间和随机对齐？

> ID：12338004
> 
> 赞同：0
> 
> 时间：2012-09-09T09:36:12.213
> 
> 标签：html, css, 960.gs

我有一个问题，div 中的元素看似随机对齐，不响应任何对齐标记，并且 div 在其元素上方或下方创建额外空间。我正在使用 960 网格系统，并且我没有更改股票 CSS 文件，以免我的手指把它炸毁。

我在[这里](http://www.tomrankinmusic.com/test.html)放了一个测试页面，请原谅一些不可靠的代码:-D

它仍处于非常早期的阶段（就像我一样），但我觉得我不能继续前进，直到我能够轻松理解导致问题的原因。

该页面上最好的例子是底部的水平条和下面的元素。该条添加了几个像素的死区，其下方的元素与各自 div 的不同部分对齐。

为什么在没有指令的情况下元素似乎没有标准化它们的对齐方式，是什么导致在没有指令的情况下再次出现额外的空间？

我自己的想法是相对单独地定位所有内容，但我担心这会导致问题并“破坏”网格。除此之外，我不知道。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T09:47:42.263

问题之一是它`#horizontal-bar-footer`的高度`25px`超过了`hr`线的需要。设置`height`为`0px`，然后添加一些`padding-bottom`以使页脚上方有一点空间。

这应该带来“汤姆·兰金自己的设计”部分。对于 Facebook 喜欢按钮，将其添加到`main.css`：

```
.fb_iframe_widget span {
    vertical-align: top;
} 
```

# c# - 在 WinRT 中更改系统卷

> ID：12338005
> 
> 赞同：3
> 
> 时间：2012-09-09T09:36:14.350
> 
> 标签：c#, .net, vb.net, windows-runtime, volume

我的 WinRT 应用程序中有一个音量滑块，我想与系统音量同步。有没有办法做到这一点？iOS 允许开发人员提供此功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:10:52.447

可以使用[MediaElement.Volume](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.mediaelement.volume)属性控制播放音量。我找不到具体的支持报价，但我自己的观察表明音量是每个 MediaElement 对象[，就像它在 SilverLight 中一样，](http://forums.silverlight.net/t/13034.aspx/1)并且无法更改应用程序中的系统音量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T12:12:56.827

可以使用 MediaElement.Volume 属性控制播放音量，因为该属性是介于 0 和 1 之间的双精度值。

在这种情况下，您可以使用滑块来控制音量：

```
private void slider_ValueChanged(object sender, RangeBaseValueChangedEventArgs e)
{
    if(mute)
    {
        MediaElement.IsMuted = false;
        mute = false;
        MediaElement.Volume = (slider.Value)/100;
    }
    else
    {
        MediaElement.Volume = (slider.Value) / 100;
    }
} 
```

静音变量是布尔数据类型，控制声音是否被剪切

# java - 为在 Ubuntu 上运行的 java 服务器运行 flurry

> ID：12338006
> 
> 赞同：0
> 
> 时间：2012-09-09T09:36:27.130
> 
> 标签：java, flurry

我有一个在 EC2 上运行拼车服务的 Java 服务器。我在我的 Android 和 iOS 应用程序上使用 Flurry，但我找不到在 java 服务器上运行 Flurry 的方法。对于这种特殊情况，有关 stackoverflow 的所有问题都已针对 Android 得到解答（我想知道为什么）。

有没有人尝试在他们的 java 服务器、Java EE 或 ASP.NET 上运行 flurry？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T14:17:18.460

这根本不支持。使用 Java 服务器端应用程序运行 Android SDK 将非常困难，因为它依赖于 Android 库。

# php - 当使用 jquery 更改 div 内容时，div 中的表单操作进入主页

> ID：12338011
> 
> 赞同：1
> 
> 时间：2012-09-09T09:37:05.693
> 
> 标签：php, javascript, jquery

我正在使用 jquery 更改 main.php 文件中的 div 内容而不刷新页面，但这里的问题是加载的新 div 包含一个表单，在表单操作中我希望将表单提交到同一页面(div) ，但被重定向到我不想要的 main.php。我必须对操作进行哪些更改才能保持在具有相同 div 的同一页面上。

这是我用来动态更改 div 的代码。

主.php：

```
<li id="nav-home"><a class="button" href="main.php">Home</a></li>
<li id="nav-page1"><a class="button" href="page1.php">Page1</a></li>    
<li id="nav-page2"><a class="button" href="page2.php">Page2</a></li>
<li id="nav-page3"><a class="button" href="page3.php">Page3</a></li>

<script>
    $(function(){
        $('.button').on('click', function(e){
            e.preventDefault();
            $('#content').load($(this).attr('href'));
        });
    })
</script> 
```

示例：当我单击 main.php 中的 Page1 时，div 内容被 page1 替换，在 page1 中我有一个表单，当我提交表单时，我想留在同一页面中。

这是处理 page1 中的表单的代码：

```
<form name="form" id="form" method="POST" action=""> //my form elements </form>

    <script type="text/javascript">
        $(document).ready(function(){
            $("#form").validate({
                debug: false,
                rules: {

                    //rules
                },
                messages: {

                    //messages
                },
                submitHandler: function(form) {
                    // do other stuff for a valid form
                    $.post('scripts/formhandler.php', $("#form").serialize(), function(data) {
                        $('#results').html(data);
                    });
                }
            });
    });
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T09:42:19.643

您可以使用 form.submit 函数，并使用 ajax 在其中处理提交

```
$('#form_id').submit(function() 
{
     e.preventDefault(); // Prevent the default form action 

     /*now add ajax code here to do form submit*/
}); 
```

当然，如果您在页面加载后加载表单，则需要使用 jquery.live 或 jquery.on 函数来设置表单处理程序，而不是上面的代码。例子：

```
$('#form_id').on('submit', function()
{
    // Code in here
}); 
```

您可以从 jquery 站点了解更多关于 .live 和 .on 的信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T10:02:46.630

您似乎正在使用 validate 插件，并且您可以使用`ajaxSubmit`基本上用 preventDefault 包装提交调用的方法，处理所有表单序列化等。

[http://docs.jquery.com/Plugins/Validation/validate](http://docs.jquery.com/Plugins/Validation/validate)

IE

```
submitHandler: function(form) {
  $(form).ajaxSubmit();
} 
```

# php - php simplexml foreach 和 while 循环

> ID：12338012
> 
> 赞同：0
> 
> 时间：2012-09-09T09:37:40.847
> 
> 标签：php

我正在使用 php simplexml 和 foreach 来循环一个 xml 文件。代码就像

```
$xml = simplexml_load_file(myfile.xml);
foreach($xml->contents as $list){
     $name= $list->name;
         $price=$list->price;
         $prob=$list->Price;

    echo $name, $price, $prob;
} 
```

如果我有 100 个项目，如何为每 5 个项目插入一个类？

输出像

```
<div id="showup"> 
$name, $price, $prob (1)
$name, $price, $prob (2)
$name, $price, $prob (3)
$name, $price, $prob (4)
$name, $price, $prob (5)
</div>
<div id="showup"> 
$name, $price, $prob (6)
$name, $price, $prob (7)
$name, $price, $prob (8)
$name, $price, $prob (9)
$name, $price, $prob (10)
</div>
............... 
```

我必须使用while而不是foreach吗？foreach 的优点是，我不需要计算 xml 文件中有多少项。或者我可以同时使用

希望有人能帮忙，谢谢:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T09:50:57.867

尝试：

```
<?php $counter = 0; ?>
<div id="showup">
<?php foreach($xml->contents as $list) {

    $name= $list->name;
    $price=$list->price;
    $prob=$list->Price;

   echo $name, $price, $prob;
   $counter++;
   if( $counter % 5 == 0) { 
?>
</div><div id='showup'> 
<?php } } ?> 
```

# colors - 将 8 位颜色转换为 RGB 值

> ID：12338015
> 
> 赞同：7
> 
> 时间：2012-09-09T09:37:45.323
> 
> 标签：colors, bit-manipulation, rgb, 8-bit

我正在使用“反射阴影贴图”在我的游戏引擎中实现全局照明。RSM 具有 ia 颜色纹理。为了节省内存。我将 24 位值打包成 8 位值。行。我知道怎么打包。但是我该如何解压呢？我想用 8 位调色板创建一个 1D 纹理，有 255 种不同的颜色。我的 8 位颜色将是该纹理中像素的索引。我不确定如何生成这种纹理。是否有任何数学方法可以将 8 位值转换为 rgb？

@edit 颜色采用这种格式：
`RRR GGG BB`

@edit2：我正在像这样包装我的颜色：

```
int packed = (red / 32 << 5) + (green / 32 << 2) + (blue / 64);
//the int is actually a byte, c# compiler is bitching if it's byte. 
```

@edit3：
好吧，我想我找到了一种方法。告诉我是不是错了。

@edit4 错了……

```
int r = (packed >> 5) * 32;    
int g = ((packed >> 2) << 3) * 32;    
int b = (packed << 6) * 64; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-08-12T07:15:13.247

在 JavaScript 中

编码

```
encodedData = (Math.floor((red / 32)) << 5) + (Math.floor((green / 32)) << 2) + Math.floor((blue / 64)); 
```

解码

```
red = (encodedData >> 5) * 32;
green = ((encodedData & 28) >> 2) * 32;
blue = (encodedData & 3) * 64; 
```

在解码时，我们使用 AND Gate/Operator 来提取所需的位并丢弃前导位。使用绿色，我们将不得不向右移动以丢弃右侧的位。

虽然编码 Math.floor 用于截断小数部分，但如果四舍五入，则会产生大于 255 的总值，使其成为 9 位数字。

**更新 1**
如果我们将颜色除以 32 或 64，它不会提供准确的结果。

RRRGGGBB

R/G = 3bit，最大值为二进制 111，十进制为 7。B = 2bit，最大值为二进制 11，十进制为 3。

我们应该将 R/G 除以等于或大于 255/7 的值，将 B 除以等于或大于 255/3 的值。我们还应该注意，我们应该使用 Math.round 代替 Math.floor，因为四舍五入可以提供更准确的结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-06-17T05:45:52.793

要将 8bit [0 - 255] 值转换为 3bit [0, 7]，0 没有问题，但记住 255 应该转换为 7，所以公式应该是 Red3 = Red8 * 7 / 255。

要将 24 位颜色转换为 8 位，

```
8bit Color = (Red * 7 / 255) << 5 + (Green * 7 / 255) << 2 + (Blue * 3 / 255) 
```

扭转，

```
Red   = (Color >> 5) * 255 / 7
Green = ((Color >> 2) & 0x07) * 255 / 7
Blue  = (Color & 0x03) * 255 / 3 
```

# wordpress - 无法显示简码内容

> ID：12338016
> 
> 赞同：1
> 
> 时间：2012-09-09T09:37:46.330
> 
> 标签：wordpress, shortcode

我使用以下简码在我的网站上显示播放和下载按钮。但是当内容展开时短代码工作正常，但当内容最小化时它显示为代码，不知道如何修复它，请帮助。你可以去[**网站**](http://lightsandmusic.transwebsolutions.com/)看看那里的问题。

```
add_shortcode('myplaylist','playlist_function');
function playlist_function($atts)
{
    extract( shortcode_atts( array(
        'title'=>'',
        'url'=>'#',
        ),$atts));

$output='<div class="songlinks" style="margin:5px 5px; width:30px; height:30px; float:left;">
<a href="'.$url.'" title="'.$title.'" name="'.$title.'" class="playbutton">  </a>
</div>
<div class="songdownloadlinks" style="margin:5px 5px; width:40px; float:left; height:30px;">
<a href="#" target="_blank" title="Download-'.$title.'" track_raw_url="'.$url.'">  </a>
</div>
<div style="padding:10px 5px;">'.$title.'</div>';
return $output;
} 
```

# python - Python http 服务器交互

> ID：12338017
> 
> 赞同：0
> 
> 时间：2012-09-09T09:37:57.923
> 
> 标签：python, http

我有一个项目，我正在整理它到目前为止运行良好。

但是我对从哪里开始明智地开始 python 有点迷茫。项目的基础是一个照明系统，由 Arduino 通过无线链路控制（已设置），该系统通过 xBee 网络通过串行接收来自 python 程序的命令（这部分已编码并且正在工作）。我希望项目可以通过互联网控制。

我正在考虑运行它，以便 python 程序运行一个相当容易设置的 http 服务器。

这是我遇到麻烦的地方，因为我过去没有玩过 python。如何让程序响应请求并根据页面上单击的内容运行代码？

谁能指出我正确的方向

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T10:21:17.377

您可以使用 Tornado 之类的框架编写服务器应用程序，该框架在任意端口上侦听消息。

但是，听起来您想构建一个 Web 界面。为此，您应该只选择一个 Web 框架。我最喜欢的微框架是[Flask](http://flask.pocoo.org/docs/quickstart/#quickstart)。我刚刚链接到的他们的快速入门展示了运行一个简单的站点是多么容易。

然后，您将为用户界面中的每个操作编写一个函数。当用户单击访问相关 URL 的链接（或按钮）时，这些功能中的每一个都将被激活。

```
@app.route('/')
def index():
    return render_template('index.html')

@app.route('/dim_lights/<room>')
def dim_lights(**kwargs):
    dim_lights_for_room(kwargs['room']) 
```

该`'index.html'`模板将包含如下链接`<a href="/dim_lights/lounge">Dim the Lights in the Lounge</a>.`

这有意义吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T10:50:43.943

如果您在单个 python 应用程序中使用串行端口和 Web 应用程序，那么我会使用 twisted。它的事件循环处理串行端口以及网络请求等......它也是一种框架。大多数其他“框架”不支持开箱即用的串行端口（作为事件循环的一部分 - 即接收数据时的回调）。 [http://twistedmatrix.com/trac/](http://twistedmatrix.com/trac/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T10:32:42.280

如果您正在尝试创建与您的项目链接的基于 Web 的应用程序，您可以尝试使用[Flask](http://flask.pocoo.org/docs/)作为框架，也许使用[Gunicorn](http://gunicorn.org/)作为 http 服务器。阅读 Flask 文档以更好地了解 Flask。该网站上有一个针对 python web 开发新手的教程。

然后你需要为你的硬件编写一些脚本，你可以将它与你的网络应用程序集成。

# iphone - 本地化将新语言添加到列表中

> ID：12338022
> 
> 赞同：-3
> 
> 时间：2012-09-09T09:38:47.917
> 
> 标签：iphone, cocoa-touch, localization

我正在尝试本地化我的应用程序，但我一直在为我的项目添加一种新语言。

我遵循了一个教程，但它说您应该单击图像中的 + 按钮。 [http://www.madmob.co.za/wp-content/uploads/2011/05/Screen-shot-2011-05-04-at-10.11.01-PM.png](http://www.madmob.co.za/wp-content/uploads/2011/05/Screen-shot-2011-05-04-at-10.11.01-PM.png)

但我没有看到这些按钮。如何向我的 Localizable.strings 文件添加新语言？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:05:19.277

您必须首先在项目“信息”选项卡的“本地化”部分添加本地化。添加到项目后，新的本地化可用于字符串文件。

# android - 无法创建选项卡内容，因为在 Android Eclipse 中找不到 ID -1 XML 错误的视图？

> ID：12338023
> 
> 赞同：4
> 
> 时间：2012-09-09T09:38:50.993
> 
> 标签：android, xml, android-layout, tabs, android-tabhost

我有一个包含 TabHost 的 XML 文件。我通过右键单击布局图 -> 新建 -> Android XML -> TabHost 直接创建它。代码似乎没问题，但每当我在 Eclipse 中进行图形布局时，它都会给我错误（见标题）。我使用的是安卓 2.2。这是我的 XML 代码：

```
<?xml version="1.0" encoding="utf-8"?>

<TabHost xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/tabhost"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <LinearLayout
        android:id="@+id/linearLayout1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical" >

        <TabWidget
            android:id="@android:id/tabs"
            android:layout_width="match_parent"
            android:layout_height="wrap_content" >
        </TabWidget>

        <FrameLayout
            android:id="@android:id/tabcontent"
            android:layout_width="match_parent"
            android:layout_height="match_parent" >

            <LinearLayout
                android:id="@+id/tab1"
                android:layout_width="match_parent"
                android:layout_height="match_parent" >
            </LinearLayout>

            <LinearLayout
                android:id="@+id/tab2"
                android:layout_width="match_parent"
                android:layout_height="match_parent" >
            </LinearLayout>

            <LinearLayout
                android:id="@+id/tab3"
                android:layout_width="match_parent"
                android:layout_height="match_parent" >
            </LinearLayout>
        </FrameLayout>
    </LinearLayout>

</TabHost> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T11:08:10.137

我的解决方案是为每个选项卡的视图提供 id。在以下示例中，需要为每个 textView 提供 id（如 android:id="@+id/tab1" ...）

```
<?xml version="1.0" encoding="utf-8"?>
<TabHost xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@android:id/tabhost"
android:layout_width="fill_parent"
android:layout_height="fill_parent">
<LinearLayout
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <TabWidget
        android:id="@android:id/tabs"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content">

        <TextView
            android:tag="tab1"
            android:text="@string/tab1"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:textSize="12sp"
            />
        <TextView
            android:tag="tab2"
            android:text="@string/tab2"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:textSize="12sp"
            />
        <TextView
            android:tag="tab3"
            android:text="@string/tab3"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:textSize="12sp"
            />
        <TextView
            android:tag="tab4"
            android:text="@string/tab4"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:textSize="12sp"
            />
        <TextView
            android:tag="tab5"
            android:text="@string/tab5"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:textSize="12sp"
            />

    </TabWidget>

    <FrameLayout
        android:id="@android:id/tabcontent"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">

        <TextView
            android:id="@+id/tab1"
            android:text="Hallo3"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" />
        <TextView
            android:id="@+id/tab2"
            android:text="Hallo2"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" />
        <TextView
            android:id="@+id/tab3"
            android:text="Hallo3"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" />
        <TextView
            android:id="@+id/tab4"
            android:text="Hallo3"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" />
        <TextView
            android:id="@+id/tab5"
            android:text="Hallo3"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" />

    </FrameLayout>
</LinearLayout>
</TabHost> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T16:14:23.740

我刚刚提交了一份 Android 工具[错误报告](http://code.google.com/p/android/issues/detail?id=37631)：

> 以下用户和我在使用布局编辑器的图形布局选项卡时看到了此错误，即使在最简单和正确的布局上也是如此。
> 
> “无法创建标签内容，因为找不到 ID -1 的视图”
> 
> 当我将另一个 xml 文件包含为选项卡时，我在 API20 中看到了它。如果我复制并粘贴包含文件的内容，则不会显示错误。
> 
> 请参阅以下有关此错误的其他报告：
> 
> [无法创建选项卡内容，因为在 Android Eclipse 中找不到 ID -1 XML 错误的视图？](https://stackoverflow.com/q/12338023/403455)
> 
> [https://stackoverflow.com/a/4807779/403455](https://stackoverflow.com/a/4807779/403455)（请参阅对raybritton提出的答案的评论）
> 
> [https://groups.google.com/d/topic/android-developers/DRY4fsbwgDA/discussion](https://groups.google.com/d/topic/android-developers/DRY4fsbwgDA/discussion)

# ruby-on-rails - 页面加载后加载 Javascript 和 Css

> ID：12338026
> 
> 赞同：1
> 
> 时间：2012-09-09T09:39:39.597
> 
> 标签：ruby-on-rails, ruby, web, twitter-bootstrap

在你去网站之前，我希望你也去寻找这个。您会注意到网站加载时，前一秒或两秒...它以列表格式在导航栏中显示链接，并且看起来有问题... bc 当它完成加载时看起来还不错。

网站：www.powerliftingbasics.com 每次刷新/加载页面时都会发生这种情况。我在 twitter 引导程序上使用 ruby​​ on rails。我想不通。

这是我的导航栏代码：

```
 <div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
          <a href="/" class="navlogo pull-left"><img src="assets/logosmall.png" alt="Small Logo"></a>
          <a class="brand navfont" href="/">Powerlifting Basics</a>
      <div class="container nav-collapse">
        <ul class="nav pull-right"> 
            <li><%= link_to "Bench Press", "/benchpress"  %></li>
            <li><%= link_to "Deadlift", "/deadlift"  %></li>
            <li><%= link_to "Squat", "/squat"  %></li>
            <li><%= link_to "Equipment", "/equipment"  %></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"> more<b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li class="divider"></li>
                  <li><%= link_to "Subscribe", "/subscribe"  %></li>
                  <li><a href="mailto:contact@powerliftingbasics.com"> Contact Us</a> </li> 
                </ul>
            </li>
        </ul> 
      </div><!--/.nav-collapse -->
    </div>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:18:03.517

在你的 layouts/application.html.erb 添加 application.css 和 application.js 在顶部

```
<!DOCTYPE HTML>
<html lang="en">
  <head>
    <title>PowerLiftingBasics</title>
    <%= stylesheet_link_tag "application" %>
    <%= javascript_include_tag "application" %>
  </head>
  <body>

    <%= yield %>

  </body>

</html> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-09T09:45:21.750

发生这种情况是因为您在页面底部放置了指向您的 css 文件的链接。您应该在页面正文之前加载它。至少，放

```
<link href="/assets/application-65943938be14c000984bcb9478d30563.css" media="all" rel="stylesheet" type="text/css"> 
```

内部`<head></head>`标签。

最佳做法是将 css 和 favicon 链接放在页面头部。Javascripts 链接位于正文底部（结束`</body>`标记之前）。

# objective-c - 使用大中央调度切换视图

> ID：12338030
> 
> 赞同：1
> 
> 时间：2012-09-09T09:40:10.797
> 
> 标签：objective-c, ios, grand-central-dispatch

我已经看过很多主题，但我仍然无法弄清楚。

我有一个 UITableview 可以在线下载其内容。每个单元格都有一个图像，我使用 GCD 让图像下载。下载的图像将保存到磁盘，每次加载单元之前都会检查文件是否已存在，如果不存在 -> gcd、nsdata 等。

如果有人有良好的互联网连接（wifi），一切都会很好，但是如果我要在视图之间跳来跳去（来回），用我蹩脚的 3G 连接，会发生什么是它想要完成它的队列（大约4 个单元格），但已经分配了一个新单元格，一个新单元格，一个新单元格，最终用户必须等待很长时间才能执行其他单元格（他没有看到），然后才能填充实际的 UITableview。使用 NSLog 我可以看到，即使我在不​​同的视图中，它仍在下载和制作屏幕上可见的 uiimage。每个任务大约 100 kb，而且速度很慢（甚至没有互联网连接？！）如果你有很多可能需要一段时间。

我知道不可能取消它，但我在其他主题中阅读了有关使用 BOOL 变量的信息，但我并没有真正理解。即使当用户离开屏幕时 BOOL 变量发生变化，单元格已经在队列中，对吗？

是否有可能当用户点击我的导航控制器中的后退按钮，所以他离开视图时，我更改了队列中块使用的数据（清空它），所以没有什么可下载的，块将立即执行（没有什么可以做的）。就像，使数组newsitems中的每个值都为零？是否可以更改数据源，或者等待的块在等待时是否已经拥有它们的数据源？

然后还有一个问题，这对当前执行的块没有影响。

有人可以为我指出一个好的方向吗？

谢谢你。

普拉斯托

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:37:19.033

您可以使用`NSBlockOperation`并`NSOperationQueue`创建可取消的下载任务。你`NSBlockOperation`通过给它一个执行一些工作的块来创建一个。在您的情况下，该块将下载 URL 的内容。

在您的视图控制器中，您将存储已提交到队列的操作列表。如果用户决定离开当前视图，您可以调用`cancel`每个挂起的操作以防止发生任何不必要的工作。但是，当前正在运行的操作将运行完成。为了取消当前正在运行的操作，您需要在执行工作的块中存储对 NSOperation 对象的弱引用。然后在块体内的适当时间间隔，您可以检查操作是否已被取消并提前退出。

```
// Create a queue on which to run the downloads
NSOperationQueue* queue = [NSOperationQueue new];

// Create an operation without any work to do
NSBlockOperation* downloadImageOperation = [NSBlockOperation new];

// Make a weak reference to the operation. This is used to check if the operation
// has been cancelled from within the block
__weak NSBlockOperation* operation = downloadImageOperation;

// The url from which to download the image
NSURL* imageURL = [NSURL URLWithString:@"http://www.someaddress.com/image.png"];

// Give the operation some work to do
[downloadImageOperation addExecutionBlock: ^() {
    // Download the image
    NSData* imageData = [NSData dataWithContentsOfURL:imageURL];

    // Make sure the operation was not cancelled whilst the download was in progress
    if (operation.isCancelled) {
        return;
    }

    // Do something with the image
}];

// Schedule the download by adding the download operation to the queue
[queue addOperation:imageDownloadOperation];

// As necessary
// Cancel the operation if it is not already running
[imageDownloadOperation cancel]; 
```

今年在 WWDC 上就这个主题进行了一次很好的演讲，题为“在 iOS 上构建并发用户界面”。[你可以在这里](https://developer.apple.com/videos/wwdc/2012/)找到视频和幻灯片

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T10:12:46.300

我在不久前开发的应用程序中遇到了类似的问题，发现完成您需要的所有事情的最佳方法是使用[https://github.com/MugunthKumar/MKNetworkKit](https://github.com/MugunthKumar/MKNetworkKit)

我花了一天中最好的时间来学习和理解转换，然后又花了几天时间将它调整到我所需要的。

如果您决定使用它或想要全面了解这些功能，请从这里开始 [http://blog.mugunthkumar.com/products/ios-framework-introducing-mknetworkkit/](http://blog.mugunthkumar.com/products/ios-framework-introducing-mknetworkkit/)

# php - 奇怪的 MySQL 语法错误：在以前可以工作的代码中

> ID：12338031
> 
> 赞同：0
> 
> 时间：2012-09-09T09:40:20.710
> 
> 标签：php, mysql, sql

我在 SQL 中遇到语法错误，我尝试了所有方法，但找不到代码有什么问题。

```
$register_user = "INSERT INTO '".$this->users_table."' ( '".$this->username_collumn."', '".$this->email_collumn."','".$this->password_collumn."' ) VALUES ( '".$username."','".$email."','".$password."')"; 
```

所有变量都被转义，我也尝试使用 mysql_real_escape_string 函数，但它没有任何帮助。似乎电子邮件出了问题，因为在错误报告中它没有完全用@符号显示，但我不知道为什么。

错误是：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在 ''profiles'（'username'、'email'、'password'）附近使用的正确语法 VALUES（第 1 行的 'Corten'、'attrac'

我尝试以多种方式转义变量，但都没有解决错误。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T09:42:14.887

不要在列名或表名周围使用单引号，而是使用反引号：

```
$register_user = "INSERT INTO 
`".$this->users_table."` 
( `".$this->username_collumn."`, `".$this->email_collumn."`,`".$this->password_collumn."` ) 
VALUES ( '".$username."','".$email."','".$password."')"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T09:42:23.927

尝试这个：

从表名和列中删除所有单引号

```
$register_user = "INSERT INTO ".$this->users_table." ( ".$this->username_collumn.", ".$this->email_collumn.",".$this->password_collumn.") VALUES ( '".$username."','".$email."','".$password."')"; 
```

# c++ - 什么 C++ 类型用于最快的“循环”？

> ID：12338034
> 
> 赞同：0
> 
> 时间：2012-09-09T09:41:28.947
> 
> 标签：c++, performance, types, for-loop

我认为这个网站上还没有回答。

我做了一个代码，它经历了 4 个数字的许多组合。数值是从 0 到 51，所以它们可以存储在 6 位中，所以在 1 字节中，对吗？我在嵌套循环中使用这 4 个数字，然后在循环的最低级别使用它们。那么从那些可以存储至少 52 个值的 c++ 类型中，哪种 c++ 类型对于迭代 4 个嵌套 for 循环是最快的呢？

```
The code looks like: 
for(type first = 0; first != 49; ++first)
 for(type second = first+1; second != 50; ++second)
  for(type third = second+1; third != 51; ++third)
   for(type fourth = third+1; fourth != 52; ++fourth) {
    //using those values for about 1 bilion bit operations made in another for cycles 
   } 
```

该代码非常简化，也许这种迭代还有更好的方法，您也可以帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T09:45:17.960

`std::uint_fast8_t`使用标头中的 typedef `<cstdint>`。它应该是至少 8 位的“最快”无符号整数类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T10:31:10.023

最快的是底层处理器 ALU 可以原生使用的任何东西。现在寄存器可以以多种格式寻址。在这种情况下，所有这些格式都同样快。

所以这变得非常特定于处理器架构而不是特定于 C++。如果您正在使用现代 PC 处理器，那么对于您的 for 循环，int 与其他任何东西一样快。

在嵌入式系统上，需要考虑的事情更多。例如。变量是否存储在对齐的位置？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T10:54:03.907

在大多数机器上，`int`是最快的整数类型。在我使用的所有计算机上，`int`都比 快`unsigned`，明显快于`signed char`。

另一个问题，也许是更大的问题，是您对这些数字所做的事情。你没有显示代码，所以没有办法告诉。`int`如果您希望`first*second`产生预期的积分值，请使用。

另一个问题是您希望此代码具有多广泛的可移植性。将移植到许多不同架构、不同编译器的代码与将在有限和受控环境中使用的代码之间存在巨大差异。如果是后者，请编写一些基准测试，并使用基准测试表现最佳的类型。如果您正在为广泛消费而编写一些东西，那么问题就有点棘手了。

# php - PHP：在不重载 PHP 的情况下对文件使用解包？

> ID：12338038
> 
> 赞同：0
> 
> 时间：2012-09-09T09:41:46.883
> 
> 标签：php, arrays, memory, time

我正在尝试使用 PHP 的 unpack 函数从文件中创建一个数组。问题是 PHP 在处理更大的文件时会耗尽内存。完成后，该脚本应处理 3 到 4 MB 之间的文件，但仍保持相当快的速度。这是基本思想：

```
<?php
$file = 'uploads/file.pcg';
$array = unpack('C*', file_get_contents($file));
?> 
```

有没有一种方法可以在不重载 PHP 的情况下一次从整个文件中生成数组，或者我唯一的选择是使用每个脚本实例的合理数据量？- 大约 1 MB 似乎相当快。- 是不是即使是单独的数组也需要比允许的限制更多的内存？

另外...抱歉，如果此处已经发布了类似的内容-不过，我认为不是。:D

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T10:26:09.593

看起来您必须增加ini 文件中的[memory_limit](http://www.php.net/manual/en/ini.core.php#ini.memory-limit)，因为 file_get_contents 会将整个文件加载到内存中。基本上，如果你想获得一个大数组——无论如何你都必须这样做。或者您可能会寻找其他方式来读取文件并逐步解压缩，而无需将整个文件读入内存。

# xcode - 关于 XCode 中“其他 C 标志”的 LLVM 编译标志“-mlong-calls”。

> ID：12338039
> 
> 赞同：0
> 
> 时间：2012-09-09T09:41:57.023
> 
> 标签：xcode, llvm

这个标志是什么意思？它将如何使用？出于什么目的需要启用此标志？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T09:54:56.870

根据[GCC 的 ARM 选项页面；](http://gcc.gnu.org/onlinedocs/gcc/ARM-Options.html)

> 告诉编译器通过首先将函数的地址加载到寄存器中然后在该寄存器上执行子例程调用来执行函数调用。如果目标函数位于基于偏移量版本的子程序调用指令的 64 兆字节寻址范围之外，则需要此开关。

基本上，这意味着如果您的二进制文件很小，您可能永远不会遇到运行默认值的问题，`-mno-long-calls`而不必担心该选项。

**如果链接**器给你错误`Relocation truncated to fit: R_ARM_PC24`，你已经达到了默认值的限制，需要使用.**`-mlong-calls`**

# c++ - 逗号运算符的右操作数无效 std::cout

> ID：12338047
> 
> 赞同：2
> 
> 时间：2012-09-09T09:43:01.313
> 
> 标签：c++

> **可能重复：**
> [为什么此代码会产生涉及逗号运算符的警告？](https://stackoverflow.com/questions/5665611/why-does-this-code-produce-a-warning-referring-to-the-comma-operator)

为什么我在尝试在 gcc 中编译此示例时收到此警告？

```
#include <iostream>

int main()
{
   std::cout << "str" < 0;
} 
```

> 警告：逗号运算符的右操作数无效 [-Wunused-value]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T09:57:30.673

因为你应该使用：

```
std::cout << "str" << 0; 
```

代替

```
std::cout << "str" < 0; 
```

也许您已经知道这一点，但值得澄清！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T09:45:14.507

因为它被解析为

```
(std::cout << "str") < 0; 
```

比较是没有用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T09:45:52.997

1.  你有一个<
2.  你为什么做这个？

# ruby-on-rails - 可以从美沙酮的 App 类中调试/撬动吗？

> ID：12338049
> 
> 赞同：0
> 
> 时间：2012-09-09T09:43:14.027
> 
> 标签：ruby-on-rails, ruby, rspec, cucumber, aruba

我用美沙酮开始了一个空白项目，[美沙酮](https://github.com/davetron5000/methadone)是一个用于构建命令行应用程序的很棒的框架。唯一的问题是我无法从所在的`App`类中进行调试`bin/my_app`

该类`App`是您运行美沙酮时创建的文件。这是我尝试使用 pry 的方式

```
#!/usr/bin/env ruby

require 'optparse'
require 'methadone'
require 'my_app'
require 'pry'

class App
  include Methadone::Main
  include Methadone::CLILogging

  main do
     binding.pry    #  <= pry here
  end

  ... 
```

当我运行时，`rake features`我可以告诉正在运行的进程正在尝试用 pry 做一些事情，因为它会暂停几秒钟。我收到以下错误，然后 rake/cucumber 中止。

```
process still alive after 3 seconds (ChildProcess::TimeoutError) 
```

我可以从黄瓜步骤、rspec 或任何其他地方很好地使用 pry，只是不能从这个`App`类的任何地方使用。

一件非常有趣的事情是，如果我从控制台运行我的命令行应用程序，它将在 pry 所在的位置停止。使用黄瓜时，它只是不会被撬开。

**我如何在运行时让应用程序与 pry 一起工作`rake features`？**

## 更新

抱歉，我应该澄清一下美沙酮是随 aruba 一起提供的。所以我的黄瓜场景看起来像这样

```
When I successfully run `my_app arg1` 
```

但是，如果我运行它，它将进入调试/撬动

```
bundle exec bin/my_app 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T02:27:07.603

Aruba 在一个完全独立的进程中运行应用程序，所以我猜发生的情况是，当 aruba 运行您的应用程序时，pry 会在提示符下启动并等待输入。由于它没有得到任何信息，因此 aruba 会在三秒后超时（默认情况下它将等待应用程序完成）。这就是为什么您会看到“进程仍然存在”问题。

I'm not 100% sure how you could get the standard input of your shell that's running `rake features` to connect to your app's standard input so you could issue pry commands, but I don't think aruba was designed to allow this.

You have a couple of options:

*   Tag your scenario with @announce, and use `When I run interactively...` followed by several `When I type` - these commands *should* go to the interactive pry console that's waiting. Kind of kludgy, but it might work
*   Execute a unit test of your `App` class. You'll need to replace the call to `go!` with something like `go! if $0 == __FILE__` so that you can `require` your executable in a test and manipulate `App` directly.

I have not tried either of these, but the second option feels a bit better and could also be improved with support from the library, if you can figure out a good way to do this.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T02:37:10.613

Use [pry-remote](https://github.com/Mon-Ouie/pry-remote) to connect to a pry session in the Aruba-managed subprocess.

(Disclosure: I paired with @Dty to come to this solution)

# asp.net - 如何使这个 asp .net 代码工作？

> ID：12338051
> 
> 赞同：-1
> 
> 时间：2012-09-09T09:43:20.053
> 
> 标签：asp.net

谁能告诉我我做错了什么？

```
//--- menuFac ---
public void UpdatePageById()
{
    db.ModifyData("UPDATE tblsider SET colOverskrift=@1, colTekst=@2  WHERE colID=@3", _overskrift, _tekst, _id);
}

//--- where i'm trying to get some from db to edit and save the edited ---
menuFac objTekst = new menuFac();
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        objTekst._id = int.Parse(Request.QueryString["colID"]);

        DataRow value = objTekst.GetPageById();

        txtOverskrift.Text = value["colOverskrift"].ToString();
        txtTekst.Text = value["colTekst"].ToString();
    }

}
protected void btnSubmit_Click(object sender, EventArgs e)
{

    objTekst._id = int.Parse(Request.QueryString["colID"]);

    objTekst._overskrift = txtOverskrift.Text;
    objTekst._tekst = txtTekst.Text;

    objTekst.UpdatePageById();

    Response.Redirect("Protected.aspx");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:42:44.937

替换此调用方法

```
objTekst.UpdatePageById(); 
```

和

```
this.UpdatePageById(); 
```

UpdatePageById 是您的方法`Page Class`，而不是您的财产 objTekst

# c# - ANTLR 规则跳过方法体

> ID：12338054
> 
> 赞同：2
> 
> 时间：2012-09-09T09:43:51.750
> 
> 标签：c#, antlr, rule, skip

我的任务是创建 ANTLR 语法，分析 C# 源代码文件并生成类层次结构。然后，我将使用它来生成类图。

我编写了解析命名空间、类声明和方法声明的规则。现在我有跳过方法体的问题。我不需要解析它们，因为身体在我的任务中毫无用处。

我写了简单的规则：

```
body:
'{' .* '}'
; 
```

但它不能正常工作，当方法看起来像：

```
void foo()
{
  ...
  {
    ...
  }
  ...
} 
```

规则匹配第一个大括号没问题，然后匹配

```
... 
{
  ... 
```

作为 'any'(.*) 然后第三个大括号作为最后一个大括号，什么是不正确的，规则结束。

任何人都可以帮助我为方法主体编写适当的规则吗？正如我之前所说，我不想解析它们 - 只是跳过。

**更新：**

这是基于 Adam12 答案的我的问题的解决方案

```
body:
'{' ( ~('{' | '}') | body)* '}'
; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T00:45:06.637

您必须使用匹配括号对的递归规则。

```
rule1 : '(' 
  (
    nestedParan
  | (~')')*
  )
  ')';

nestedParan : '('
  (
    nestedParan
  | (~')')*
  )
  ')'; 
```

此代码假定您在此处使用解析器，因此字符串和注释已被排除在外。ANTLR 不允许在解析器规则中否定多个备选方案，因此上面的代码依赖于按顺序尝试备选方案的事实。它应该给出一个警告，即选项 1 和 2 都匹配 '(' 并因此选择第一个选项，这就是我们想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T12:38:06.023

您可以在词法分析器中处理（嵌套）块的递归。诀窍是让你的类定义也包括开头`{`，这样就不会被这个递归词法分析器规则吞噬掉类的全部内容。

一个快速演示，毫无疑问是不完整的，但它是“模糊解析/lex”Java（或 C# 稍作修改）源文件的一个不错的开始：

```
grammar T;

parse
 : (t=. {System.out.printf("\%-15s '\%s'\n", tokenNames[$t.type], $t.text.replace("\n", "\\n"));})* EOF
 ;

Skip
 : (StringLiteral | CharLiteral | Comment) {skip();}
 ;

PackageDecl
 : 'package' Spaces Ids {setText($Ids.text);}
 ;

ClassDecl
 : 'class' Spaces Id Spaces? '{' {setText($Id.text);}
 ;

Method
 : Id Spaces? ('(' {setText($Id.text);}
              | /* no method after all! */ {skip();}
              )
 ;

MethodOrStaticBlock
 : Block {skip();}
 ;

Any
 : . {skip();}
 ;

// fragments
fragment Spaces 
 : (' ' | '\t' | '\r' | '\n')+
 ;

fragment Ids
 : Id ('.' Id)*
 ;

fragment Id 
 : ('a'..'z' | 'A'..'Z' | '_') ('a'..'z' | 'A'..'Z' | '_' | '0'..'9')*
 ;

fragment Block
 : '{' ( ~('{' | '}' | '"' | '\'' | '/')
       | {input.LA(2) != '/'}?=> '/'
       | StringLiteral
       | CharLiteral
       | Comment
       | Block
       )*
   '}'
 ;

fragment Comment
 : '/*' .* '*/'
 | '//' ~('\r' | '\n')*
 ;

fragment CharLiteral
 : '\'' ('\\\'' | ~('\\' | '\'' | '\r' | '\n'))+ '\''
 ;

fragment StringLiteral
 : '"' ('\\"' | ~('\\' | '"' | '\r' | '\n'))* '"'
 ; 
```

我针对以下 Java 源文件运行生成的解析器：

```
/*
    ... package NO.PACKAGE; ...
*/
package foo.bar;

public final class Mu {

  static String x;

  static {
    x = "class NotAClass!";
  }

  void m1() {
    // {
    while(true) {
      double a = 2.0 / 2;
      if(a == 1.0) { break; } // }
      /* } */
    }
  }

  static class Inner {
    int m2   () {return 42; /*comment}*/ }
  }
} 
```

产生以下输出：

```
PackageDecl 'foo.bar'
ClassDecl 'Mu'
方法'm1'
ClassDecl '内部'
方法'm2'
```

# http - Ubuntu 服务器托管

> ID：12338057
> 
> 赞同：0
> 
> 时间：2012-09-09T09:44:26.893
> 
> 标签：http, dns

我有一个学校老师的网页，可以在 localhost 上找到。( `192.168.1.1`) 我也可以在校外访问该页面。( `example.com`) 我想解决以下问题：如果他们在学校并且想要打开`example.com`，不必去互联网并带着请求回到学校。
我想在内部服务器上托管所有`example.com`请求。`192.168.1.1`如果有人打电话`example.com`到学校，它会通过局域网，如果不在学校，它会通过互联网。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T09:58:41.710

您可以选择（我宁愿选择第二个）：

1）修改每台机器中的“hosts”文件（手动）强制example.com为192.168.1.1（很难）

你可以找到这个文件：

Windows：%SystemRoot%\system32\drivers\etc\hosts（默认情况下系统根目录是 c:\windows，所以如果你使用的是 Windows，你的 hosts 文件很可能是 c:\windows\system32\drivers\etc\hosts )

Linux：/etc/hosts

Mac OS X：/private/etc/hosts

2）在学校设置一个透明代理，所以所有的请求都会通过这个代理，你只需要在你的新代理机器上添加这个规则。

# java - 通过套接字将服务器应用程序中的 cmd.exe 管道传输到客户端应用程序

> ID：12338062
> 
> 赞同：1
> 
> 时间：2012-09-09T09:45:08.233
> 
> 标签：java, sockets, process, cmd, pipe

我有 2 个应用程序 - 一个服务器和一个客户端。基本上我想要做的是从我的客户端应用程序远程控制服务器机器上的 cmd.exe - 只需将客户端输入传送到 cmd.exe 并将 cmd.exe 的输出传送到客户端应用程序。

一开始我收到：

```
Microsoft Windows [Version 6.1.7600]
Copyright (c) 2009 Microsoft Corporation. Alle Rechte vorbehalten. 
```

所以一切似乎都很好，但我无法从客户端应用程序向 cmd.exe 发送命令。服务器应用程序收到 cmd，例如“帮助”，但命令没有到达 cmd.exe，我不知道为什么。我希望有人能够帮助我解决这个问题。

**服务器代码**

```
package net.api.windows.command.shell;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.lang.ProcessBuilder.Redirect;
import java.net.ServerSocket;
import java.net.Socket;

public class CommandShellServer implements Runnable {

// - Init - //
private Socket socket;
private ServerSocket serverSocket;
private InputStream IN;
private OutputStream OUT;
private ObjectInputStream ObjIN;
private ObjectOutputStream ObjOUT;

// ___________________________________ //

public static void main(String[] args) {
    new CommandShellServer();
}

public CommandShellServer() {
    Thread thread = new Thread(this);
    thread.start();
}

@Override
public void run() {
    try {
        System.out.println("Starting server..");
        serverSocket = new ServerSocket(65000);
        System.out.println("Server started!");
        socket = serverSocket.accept();
        System.out.println("\n" + "Client connected!");

        ProcessBuilder processBuilder = new ProcessBuilder("cmd.exe").redirectInput(Redirect.PIPE)
                .redirectOutput(Redirect.PIPE).redirectError(Redirect.PIPE);
        Process process = processBuilder.start();
        final BufferedReader ProcessIN = new BufferedReader(new InputStreamReader(process.getInputStream()));
        final BufferedReader ProcessERROR = new BufferedReader(new InputStreamReader(process.getErrorStream()));
        final BufferedWriter ProcessOUT = new BufferedWriter(new OutputStreamWriter(process.getOutputStream()));

        // Socket OutputStream
        Thread P_OUT = new Thread(new Runnable() {

            @Override
            public void run() {
                try {
                    while(true) {
                        String x = "";
                        if((x = ProcessIN.readLine()) != null) {
                            System.out.println("Process says: " + x);
                            OUT = socket.getOutputStream();
                            ObjOUT = new ObjectOutputStream(OUT);

                            ObjOUT.writeObject(x);
                            ObjOUT.flush();
                        }
                    }
                } catch(IOException e) {
                    System.out.println(e.getMessage().toString());
                }
            }
        });
        P_OUT.start();

        // Socket Error OutputStream
        Thread P_ERROR = new Thread(new Runnable() {

            @Override
            public void run() {
                try {
                    while(true) {
                        String x = "";
                        if((x = ProcessERROR.readLine()) != null) {
                            OUT = socket.getOutputStream();
                            ObjOUT = new ObjectOutputStream(OUT);

                            ObjOUT.writeObject(x);
                            ObjOUT.flush();
                        }
                    }
                } catch(IOException e) {
                    System.out.println(e.getMessage().toString());
                }
            }
        });
        P_ERROR.start();

        // Socket InputStream
        Thread P_IN = new Thread(new Runnable() {

            @Override
            public void run() {
                try {
                    while(true) {
                        IN = socket.getInputStream();
                        ObjIN = new ObjectInputStream(IN);

                        String x = "";
                        if((x = ObjIN.readObject().toString()) != null) {
                            System.out.println("Client says: " + x);
                            ProcessOUT.write(x);
                            ProcessOUT.flush();
                        }
                    }
                } catch(IOException e1) {
                    System.out.println(e1.getMessage().toString());
                } catch(ClassNotFoundException e2) {
                    System.out.println(e2.getMessage().toString());
                }
            }
        });
        P_IN.start();

    } catch(IOException e1) {
        System.out.println(e1.getMessage().toString());
    }
}
} 
```

* * *

**客户代码**

```
package net.api.windows.command.shell;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.OutputStream;
import java.net.InetSocketAddress;
import java.net.Socket;
import java.net.SocketAddress;

public class CommandShellClient {

// - Init - //
private static Socket socket;
private static InputStream IN;
private static OutputStream OUT;
private static ObjectInputStream ObjIN;
private static ObjectOutputStream ObjOUT;

// ___________________________________ //

public static void main(String[] args) {
    try {
        System.out.println("Connceting to server..");
        SocketAddress sockAddr = new InetSocketAddress("192.168.1.21", 65000);
        socket = new Socket();
        socket.connect(sockAddr, 5000);

        if(socket.isConnected()) {
            System.out.println("Connected!" + "\n");

            // Socket InputStream
            Thread Thread_IN = new Thread(new Runnable() {

                @Override
                public void run() {
                    try {
                        while(true) {
                            IN = socket.getInputStream();
                            ObjIN = new ObjectInputStream(IN);

                            String x = "";
                            if((x = ObjIN.readObject().toString()) != null) {
                                System.out.println("Process says: " + x);
                            }
                        }
                    } catch(IOException e1) {
                        System.out.println(e1.getMessage().toString());
                    } catch(ClassNotFoundException e2) {
                        System.out.println(e2.getMessage().toString());
                    }
                }
            });
            Thread_IN.start();

            // Socket OutputStream
            Thread Thread_OUT = new Thread(new Runnable() {

                @Override
                public void run() {
                    try {
                        BufferedReader SYSTEM_IN = new BufferedReader(new InputStreamReader(System.in));

                        while(true) {
                            String x = "";
                            if((x = SYSTEM_IN.readLine()) != null) {
                                OUT = socket.getOutputStream();
                                ObjOUT = new ObjectOutputStream(OUT);

                                ObjOUT.writeObject(x);
                                ObjOUT.flush();
                            }
                        }
                    } catch(IOException e1) {
                        System.out.println(e1.getMessage().toString());
                    }
                }
            });
            Thread_OUT.start();
        }
    } catch(IOException e1) {
        System.out.println(e1.getMessage().toString());
    }
}
} 
```

* * *

**解决方案**

在服务器代码中，在最后一个线程 (P_IN) 中，您必须键入：

```
ProcessOUT.write(x);
ProcessOUT.newLine();
ProcessOUT.flush(); 
```

..代替：

```
ProcessOUT.write(x);
ProcessOUT.flush(); 
```

ProcessOUT.newLine() 很**重要**！

# entity-framework - 实现存储库模式并进行测试

> ID：12338068
> 
> 赞同：2
> 
> 时间：2012-09-09T09:45:42.453
> 
> 标签：entity-framework, unit-testing, integration-testing, repository-pattern

我已经阅读了几乎所有关于存储库模式及其不同实现的文章。他们中的许多人判断不良做法（例如：使用`IQueryable<T>`而不是`IList<T>`）等，这就是为什么我仍然被卡住并且无法最终找到正确的做法。

所以：

*   我是否需要存储库模式才能在我的 MVVM 应用程序中应用 IoC？

*   如果是，什么是 EF 实体的有效 IRepository 实现，这是一种良好的实践和更好的可测试性？

*   如何测试我的存储库和 UnitofWork 行为？针对内存存储库的单元测试？集成测试？

**编辑**：根据答案，我添加了第一个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T11:32:10.057

Ayende Rahien 有很多关于存储库的帖子[http://ayende.com/blog/search?q=repository](http://ayende.com/blog/search?q=repository)以及为什么在使用 ORM 时它不好。我认为存储库是要走的路。也许是，在 2004 年。不是现在。ORM 已经实现了存储库。在 EF 的情况下，它是 IDbSet。而 DbContext 是 UnitOfWork。创建一个存储库来包装 EF 或其他 ORM 会增加很多不必要的复杂性。

对将与数据库交互的代码进行集成测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T11:09:44.130

当您使用 EF 时，存储库模式添加了一个额外的层，因此您应该确保您需要这个额外的间接级别。

存储库模式的最初想法是保护上面的层免受数据库结构的复杂性和了解。在许多方面，EF 的 ORM 模型保护代码免受数据库中物理实现的影响，因此对存储库的需求较少。

有 2 个基本的替代方案：

*   让业务层直接与 EF 模型对话
*   构建一个实现 Repository 模式的数据层，该层将 EF 对象映射到 POCO

对于测试：

*   当我们直接使用 EF 时，我们使用带有回滚功能的事务范围，因此测试不会更改数据。
*   当我们使用存储库模式时，我们使用 Rhino Mocks 来模拟存储库

我们使用这两种方法，存储库模式提供了更清晰的分层应用程序，因此可能有更多的控制权，直接使用 EF 可以提供更少代码的应用程序，因此构建速度更快。

# php - PHP 中的“imagettfbbox()”是如何工作的？

> ID：12338072
> 
> 赞同：13
> 
> 时间：2012-09-09T09:46:42.303
> 
> 标签：php, gd

您能否解释一下究竟是什么`imagettfbbox()`意思的返回值？[手册说](http://www.php.net/manual/en/function.imagettfbbox.php#refsect1-function.imagettfbbox-returnvalues)：

> imagettfbbox() 返回一个包含 8 个元素的数组，代表四个点，成功时为文本的边界框，错误时为 FALSE。[...此处的点表...] 这些点与文本无关，与角度无关，因此“左上角”表示在左上角水平查看文本。

但是，我发现它不是很清楚。例如，返回值：

```
array(-1, 1, 61, 1, 61, -96, -1, -96) 
```

指以下几点：

```
(-1, -96) ------ (61, -96)
    |                |
    |                |
    |                |
    |                |
    |                |
    |                |
 (-1, 1) -------- (61, 1) 
```

我应该如何解释它们？

为什么会有负值？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-09T10:18:27.020

您应该查看[手册页](http://www.php.net/manual/en/function.imagettfbbox.php#68518)[上“marclaz”的评论`imagettfbbox`](http://www.php.net/manual/en/function.imagettfbbox.php#68518)：

> 请注意，由于 imageTTFBbox 和 imageTTFText 函数返回可能是负数的坐标数组，因此必须注意计算高度和宽度。
> 
> 正确的方法是使用 abs() 函数：
> 
> 对于水平文本：
> 
> ```
> $box = @imageTTFBbox($size,0,$font,$text); $width = abs($box[4] -
> $box[0]); $height = abs($box[5] - $box[1]); 
> ```
> 
> 然后将您的文本居中在 ($x,$y) 位置，代码应该是这样的：
> 
> ```
> $x -= $width/2; $y += $heigth/2;
> 
> imageTTFText($img,$size,0,$x,$y,$color,$font,$text); 
> ```
> 
> 这是因为 (0,0) 页面原点是左上角，而 (0,0) 文本原点是左下角可读文本角。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T10:17:32.160

以下资源对此进行了解释： [http://www.tuxradar.com/practicalphp/11/2/6（通过archive.org）](http://web.archive.org/web/20120917063647/http://www.tuxradar.com/practicalphp/11/2/6)

只需使用[abs()](http://www.php.net/abs)。这来自上面的资源：“[函数]从文本字符串基线的左下角返回它的值，而不是绝对的左下角。如果你是，字母的基线是它所在的位置手写在横格纸上”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-14T06:49:38.993

Alain Tiemblo 和 Charles 的回答对我来说只是部分有效，一些字符，比如“1”不是像素完美的。

但是同一页面上[simail dot it 的 blackbart 的评论非常好：](http://php.net/manual/en/function.imagettfbbox.php#97357)

> 我写了一个简单的函数来计算*精确的*边界框（单像素精度）。该函数返回一个具有以下键的关联数组：left，top：您将传递给 imagettftext 的坐标 width，height：您必须创建的图像的尺寸
> 
> `function calculateTextBox($font_size, $font_angle, $font_file, $text) { $box = imagettfbbox($font_size, $font_angle, $font_file, $text); if( !$box ) return false; $min_x = min( array($box[0], $box[2], $box[4], $box[6]) ); $max_x = max( array($box[0], $box[2], $box[4], $box[6]) ); $min_y = min( array($box[1], $box[3], $box[5], $box[7]) ); $max_y = max( array($box[1], $box[3], $box[5], $box[7]) ); $width = ( $max_x - $min_x ); $height = ( $max_y - $min_y ); $left = abs( $min_x ) + $width; $top = abs( $min_y ) + $height; // to calculate the exact bounding box i write the text in a large image $img = @imagecreatetruecolor( $width << 2, $height << 2 ); $white = imagecolorallocate( $img, 255, 255, 255 ); $black = imagecolorallocate( $img, 0, 0, 0 ); imagefilledrectangle($img, 0, 0, imagesx($img), imagesy($img), $black); // for sure the text is completely in the image! imagettftext( $img, $font_size, $font_angle, $left, $top, $white, $font_file, $text); // start scanning (0=> black => empty) $rleft = $w4 = $width<<2; $rright = 0; $rbottom = 0; $rtop = $h4 = $height<<2; for( $x = 0; $x < $w4; $x++ ) for( $y = 0; $y < $h4; $y++ ) if( imagecolorat( $img, $x, $y ) ){ $rleft = min( $rleft, $x ); $rright = max( $rright, $x ); $rtop = min( $rtop, $y ); $rbottom = max( $rbottom, $y ); } // destroy img and serve the result imagedestroy( $img ); return array( "left" => $left - $rleft, "top" => $top - $rtop, "width" => $rright - $rleft + 1, "height" => $rbottom - $rtop + 1 ); }`

# php - 如何处理 MySQL、HTML 和 PHP 之间的特殊字符“&”

> ID：12338074
> 
> 赞同：1
> 
> 时间：2012-09-09T09:46:59.633
> 
> 标签：php, html, special-characters

> **可能重复：**
> [PHP：将特殊字符转换为 HTML 字符代码](https://stackoverflow.com/questions/3882567/php-convert-special-characters-to-html-character-codes)

我在 DB 中有一个字符串列，它可以有特殊字符“&”。

此列值用于以下选项：

```
<select onChange="display()">
echo "<option value='".$products."' </option>"; 
```

**补充：** 在此之后生成的 HTML 是正确的：

```
<option value="{"varId":"2 & 4 wheel","month":"June"}"> two and four wheel </option> 
```

并将其发送到 PHP 脚本。如果 $products 的值是“2 & 4 wheel”，那么在 PHP 中我得到的只是“2”并且我的查询失败了。

我知道这是因为 HTML 无法处理特殊字符，但如何解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T09:50:39.863

使用[htmlentities](http://ca3.php.net/manual/en/function.htmlentities.php)对字符串进行编码。

```
echo "<option value='". htmlentities($products) ."' </option>"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T09:50:52.403

HTML*可以*处理“特殊字符”。每种语言都有自己的“特殊字符”，每种语言都有自己的处理规则。HTML 具有用于此目的的 HTML 实体。在将任意值回显*到*HTML 之前，始终使用 HTML 实体对它们进行编码[`htmlspecialchars`](http://php.net/htmlspecialchars)。

有关该主题的更深入信息，请参阅[The Great Escapism（或：使用文本中的文本您需要知道的内容）](http://kunststube.net/escapism/)。

* * *

关于您的更新：

```
<option value="{"varId":"2 & 4 wheel","month":"June"}"> two and four wheel </option> 
```

这绝不是正确的 HTML。`value`contains `"`，它是完全模棱两可的，它围绕`"`着`value="..."`属性，哪些是值的一部分。它需要看起来像这样：

```
<option value="{&quot;varId&quot;:&quot;2 &amp; 4 wheel&quot;,&quot;month&quot;:&quot;June&quot;}"> two and four wheel </option> 
```

看看这里语法高亮的区别。你会得到这个：

```
$value = '{"varId":"2 & 4 wheel","month":"June"}';
echo '<option value="' . htmlspecialchars($value); .'"> two and four wheel </option>'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T09:51:16.333

将您的数据库存储`&amp;`在您的数据库中是一种方法.. 使用`str_replace('&', '&amp;', $str)`或仅使用类似的东西进行转换`htmlentities()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T09:51:23.297

您可以使用 htmlentities (http://php.net/manual/en/function.htmlentities.php) 在输出字符串之前对其进行编码。

例子：

```
$products = htmlentities($products);
echo "<option value='".$products."' </option>"; 
```

或者

```
echo "<option value='". htmlentities($products) ."' </option>"; 
```

# ms-access - 无法使用 vba 从访问中打开 word 文件进行编辑

> ID：12338076
> 
> 赞同：2
> 
> 时间：2012-09-09T09:47:38.160
> 
> 标签：ms-access, vba, ms-access-2010, word-2010

以下代码一直运行到标记的行。然后 Word 会显示锁定文件以进行编辑/打开只读提示。我需要能够编辑文档（这是代码的重点）。

抱歉，代码块太长了——我觉得展示所有内容很重要，这样更容易找到问题。

对于多个记录集，代码也有点笨拙，如果有人有更好的想法会喜欢这里。

```
Option Explicit
Option Compare Database

Sub InputSafetyData()

Dim dbCur As Database

Dim appCur As Word.Application
Dim docCur As Word.Document
Dim dlgCur As FileDialog

Dim rngCcCur As Range

Dim varDlgCur As Variant

Dim strDocName As String
Dim strDocPath As String
Dim strSQL As String

Dim rsIt As DAO.Recordset
Dim rsHc As DAO.Recordset
Dim rsHz As DAO.Recordset
Dim rsPr As DAO.Recordset

Dim strHc As String
Dim strHz As String
Dim strPr As String

Set dbCur = CurrentDb()
Set dlgCur = Application.FileDialog(msoFileDialogFolderPicker)

With dlgCur
    .AllowMultiSelect = False
    If .Show <> -1 Then End
    varDlgCur = .SelectedItems(1)
End With

strDocPath = CStr(varDlgCur) & "\"
strDocName = Dir(strDocPath & "*.docx")

Set appCur = New Word.Application
    appCur.Visible = True
Set dlgCur = Nothing

Do While strDocName <> ""

    'Runs as far here
    Set docCur = appCur.Documents.Open(FileName:=strDocPath & strDocName, ReadOnly:=False, Visible:=False)

    If docCur.ReadOnly = False Then

        Set rngCcCur = docCur.ContentControls(6).Range
        rngCcCur = ""
        appCur.ActiveDocument.Tables.Add Range:=rngCcCur, NumRows:=1, NumColumns:=4
        With rngCcCur.Tables(0)
            If .Style <> "Table Grid" Then
                .Style = "Table Grid"
            End If
            .ApplyStyleHeadingRows = True
            .ApplyStyleLastRow = False
            .ApplyStyleFirstColumn = True
            .ApplyStyleLastColumn = False
            .ApplyStyleRowBands = True
            .ApplyStyleColumnBands = False
            .Style = "Light Shading"
            .AutoFitBehavior wdAutoFitWindow
            .Cell(1, 1).Range.InsertAfter "Item"
            .Cell(1, 2).Range.InsertAfter "Hazcard"
            .Cell(1, 3).Range.InsertAfter "Hazard"
            .Cell(1, 4).Range.InsertAfter "Precaution"

            'select distinct item based on filename
            strSQL = "Select Distinct Item From IHR where filename is"
            strSQL = strSQL & strDocName
            Set rsIt = dbCur.OpenRecordset(strSQL, dbOpenDynaset)
            If Not (rsIt.BOF And rsIt.EOF) = True Then
                While Not rsIt.EOF
                    .Rows.Add
                    .Cell(rsIt.AbsolutePosition + 2, 1).Range.InsertAfter rsIt.Fields(1).Value
                    'select distinct hazcard based on item
                    strSQL = "Select Distinct Hazcard From IHR where item is"
                    strSQL = strSQL & rsIt.Fields(1).Value
                    Set rsHc = dbCur.OpenRecordset(strSQL, dbOpenDynaset)
                    If Not (rsHc.BOF And rsHc.EOF) = True Then
                        While Not rsHc.EOF
                            strHc = strHc & " " & rsHc.Fields(2).Value
                            .Cell(rsIt.AbsolutePosition + 2, 2).Range.InsertAfter strHc
                            rsHc.MoveNext
                        Wend
                    End If
                    rsHc.Close
                    Set rsHc = Nothing

                    'select distinct hazard based on item
                    strSQL = "Select Distinct Hazard From IHR where item is"
                    strSQL = strSQL & rsIt.Fields(1).Value
                    Set rsHz = dbCur.OpenRecordset(strSQL, dbOpenDynaset)
                    If Not (rsHz.BOF And rsHz.EOF) = True Then
                        While Not rsHz.EOF
                        strHc = strHz & " " & rsHz.Fields(2).Value
                            .Cell(rsIt.AbsolutePosition + 2, 3).Range.InsertAfter strHz
                            rsHz.MoveNext
                        Wend
                    End If
                    rsHz.Close
                    Set rsHz = Nothing

                    'select distinct precaution based on item
                    strSQL = "Select Distinct Precaution From IHR where item is"
                    strSQL = strSQL & rsIt.Fields(1).Value
                    Set rsPr = dbCur.OpenRecordset(strSQL, dbOpenDynaset)
                    If Not (rsPr.BOF And rsPr.EOF) = True Then
                        While Not rsPr.EOF
                            strPr = strPr & " " & rsPr.Fields(4).Value
                            .Cell(rsIt.AbsolutePosition + 2, 4).Range.InsertAfter strPr
                            rsPr.MoveNext
                        Wend
                    End If
                    rsPr.Close
                    Set rsPr = Nothing

                    rsIt.MoveNext
                Wend
            End If
        End With
        rsIt.Close
        Set rsIt = Nothing
    Debug.Print (docCur.Name)
    docCur.Save
    End If
    docCur.Close
    Set docCur = Nothing
    strDocName = Dir
Loop

Set appCur = Nothing

End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T17:13:30.910

关注眼前的问题---“*无法打开word文件进行编辑*”。

我创建了一个文件夹，`C:\share\testdocs\`并添加了 Word 文档。下面的代码示例使用一个常量作为文件夹名称。我想要一个简单的测试，所以摆脱了`FileDialog`. 我还丢弃了所有记录集代码。

我在打开 Word 文档时使用了 Visible:=True。我不明白为什么您的 Word 应用程序可见，但个别文档不可见。无论逻辑是什么，我都选择让它们可见，这样我就可以观察到内容的变化。

我用 Access 2007 对此进行了测试，它可以正常工作。如果它不适合您，请仔细检查当前用户对文件夹和目标文档的文件系统权限。

```
Public Sub EditWordDocs()
Const cstrFolder As String = "C:\share\testdocs\"
Dim appCur As Word.Application
Dim docCur As Word.Document
Dim strDocName As String
Dim strDocPath As String
Dim strMsg As String

On Error GoTo ErrorHandler

strDocPath = cstrFolder
strDocName = Dir(strDocPath & "*.docx")

Set appCur = New Word.Application
appCur.Visible = True

Do While strDocName <> ""
    Debug.Print "strDocName: " & strDocName
    Set docCur = appCur.Documents.Open(FileName:=strDocPath & strDocName, _
        ReadOnly:=False, Visible:=True)
    Debug.Print "FullName: " & docCur.FullName
    Debug.Print "ReadOnly: " & docCur.ReadOnly
    ' add text to the document ... '
    docCur.content = docCur.content & vbCrLf & CStr(Now)
    docCur.Close SaveChanges:=wdSaveChanges
    Set docCur = Nothing
    strDocName = Dir
Loop

ExitHere:
    On Error Resume Next
    appCur.Quit SaveChanges:=wdDoNotSaveChanges
    Set appCur = Nothing
    On Error GoTo 0
    Exit Sub

ErrorHandler:
    strMsg = "Error " & Err.Number & " (" & Err.Description _
        & ") in procedure EditWordDocs"
    MsgBox strMsg
    Debug.Print strMsg
    GoTo ExitHere
End Sub 
```

假设您能够克服只读问题，我认为您将面临更多挑战。你的`SELECT`陈述在我看来非常可疑......

```
'select distinct item based on filename '
strSQL = "Select Distinct Item From IHR where filename is"
strSQL = strSQL & strDocName 
```

例如，如果`strDocName`包含“ *temp.docx* ”，`strSQL`将包含此文本...

```
Select Distinct Item From IHR where filename istemp.docx 
```

这不是一个有效的 SELECT 语句。我想你可能需要更多这样的东西......

```
SELECT DISTINCT [Item] FROM IHR WHERE filename = 'temp.docx' 
```

`Item`是一个保留字，所以我将它括在方括号中以避免混淆数据库引擎。使用相等运算符 ( `=`) 而不是 "is" 进行字符串比较。

`Debug.Print`它对您的字符串非常有用`strSQL`，因此您可以直接检查您要求数据库引擎运行的完整语句......查看它而不是依靠您的想象力来猜测它的样子。当它失败时，您可以从立即窗口复制`Debug.Print`输出并将其粘贴到新查询的 SQL 视图中以进行测试。

但是，在您克服 Word 文档的只读问题之前，这些 Access 查询问题并不重要。

为了跟进可见性与只读的问题，我的代码打开了 Word 文档并在包含这两个更改中的一个或两个时对其进行了修改，而不会引发错误：

```
appCur.Visible = False 
```

和

```
Set docCur = appCur.Documents.Open(FileName:=strDocPath & strDocName, _
    ReadOnly:=False, Visible:=False) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-04-12T17:17:25.473

我对只读打开的文件有同样的问题。您可以尝试输入以下代码：

```
appcur.ActiveWindow.View.ReadingLayout = False 
```

# ruby-on-rails - Rails - 在嵌套资源中干燥新/编辑页面

> ID：12338085
> 
> 赞同：0
> 
> 时间：2012-09-09T09:49:02.363
> 
> 标签：ruby-on-rails, forms, routes, dry, nested-resources

当我有一个扁平的资源结构时，我的多层嵌套资源的新页面和编辑页面都可以正常工作。由于嵌套资源是为了使结构更具逻辑性，因此这些页面已经有点破损。对于每个模型，我都有一个表单模板，其开头如下：

```
<%= simple_form_for @contact, html: {:class => "well form-vertical"} do |f| %> 
```

这对于非嵌套资源（如上面的联系人）非常有效，允许创建和更新操作按预期工作。

但是，对于嵌套资源（例如 Service，如下所示），新操作将停止工作。当我浏览到“新”页面时，出现错误：

```
Error 500: undefined method `services_path' for #<#<Class:0x0b3512b4>:0xb42b2c58> 
```

我的相关部分的 routes.rb 如下：

```
resources :contacts,   shallow: true,     :except => [ :destroy ] do
  resources :accounts, shallow: true,     :except => [ :destroy ] do
    resources :services,                  :except => [ :destroy ]
  end
end 
```

联系人和服务的新建和编辑控制器操作是：

接触：

```
def new
  @contact = Contact.new
...
def edit
  @contact = Contact.find(params[:id]) 
```

服务：

```
def new
  @service = Service.new(account_id: params[:account_id])
...
def edit
  @service = Service.find(params[:id]) 
```

相关输出`rake routes`是：

```
 account_services        GET    /accounts/:account_id/services(.:format)         services#index
                           POST   /accounts/:account_id/services(.:format)         services#create
new_account_service        GET    /accounts/:account_id/services/new(.:format)     services#new
       edit_service        GET    /services/:id/edit(.:format)                     services#edit
            service        GET    /services/:id(.:format)                          services#show
                           PUT    /services/:id(.:format)                          services#update
           contacts        GET    /contacts(.:format)                              contacts#index
                           POST   /contacts(.:format)                              contacts#create
        new_contact        GET    /contacts/new(.:format)                          contacts#new
       edit_contact        GET    /contacts/:id/edit(.:format)                     contacts#edit
            contact        GET    /contacts/:id(.:format)                          contacts#show
                           PUT    /contacts/:id(.:format)                          contacts#update 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:34:13.120

`<%= simple_form_for(@contact, :html => {:class => "well form-vertical"}) do |f| %>`使用代替

```
<%= simple_form_for @contact, html: {:class => "well form-vertical"} do |f| %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T07:36:47.207

事实证明，这完全是解决这个问题的错误方法。相反，我将我的创建路线重写为 POST 直接到`/:controller`，然后它只使用`simple_form_for @contact, html: {class: "well form-vertical"} do |f|`

# mysql - mysql：如何获取所选日期的下一个日期？

> ID：12338087
> 
> 赞同：4
> 
> 时间：2012-09-09T09:49:26.983
> 
> 标签：mysql

我的问题是，我有一个名为“每周休息设置”的表格，我在其中选择一两天作为每周休息。如果我在星期六每周休息，那么我想找出即将到来的第一个星期六日期在所选月份的第一周。所以谁能告诉我这个问题的 mysql 查询。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T17:17:10.770

你的陈述有点不清楚，但你想找到下周六？

```
select date_add(now(), interval 7-dayofweek(now()) day); 
```

如果您在星期六，不幸的是*今天会返回，因此顺序变为：*

```
SET @OFFSET = 7-dayofweek(now());
SET @OFFSET = IF(@OFFSET = 0, 7, @OFFSET);
select date_add(now(), interval @OFFSET day); 
```

可以合并为一个：

```
select date_add(now(), interval IF(7-dayofweek(now()) = 0, 7, 7-dayofweek(now())) day) as next; 
```

# javascript - JavaScript中的正则表达式应该是什么

> ID：12338088
> 
> 赞同：0
> 
> 时间：2012-09-09T09:49:33.847
> 
> 标签：javascript

我有字符串

```
 str = "Value((10 20,30 40),(50 60,70 80,90 100))" 
```

获取以下格式的值的正则表达式应该是什么：

选项1：

```
strArray[0]  = 10 20 , 30 40;
strArray[1] = 50 60 , 70 80 , 90 100; 
```

选项 2

```
strArray[0][0] = 10 20
strArray[0][1] = 30 40
strArray[1][0] = 50 60
strArray[1][1] = 70 80
strArray[1][2] = 90 100 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T09:56:32.810

尝试类似的东西

```
"Value((10 20,30 40),(50 60,70 80,90 100))"
  .split('),(')
  .map(function(x){
    return x.replace(/value|\(|\)/gi,'').split(',')
  });
//=>[["10 20", "30 40"], ["50 60", "70 80", "90 100"]] 
```

# python - Django：基于类的视图中的模型对象“没有属性'_meta'”

> ID：12338091
> 
> 赞同：13
> 
> 时间：2012-09-09T09:50:12.707
> 
> 标签：python, django, meta, django-class-based-views

嗨 Stackoverflow 人，

我正在使用基于类的视图，对于一个测试站点，我按照[文档](https://docs.djangoproject.com/en/dev/topics/class-based-views/generic-editing/)设置了基于类的视图。对于一个项目站点（基于下面的项目模型），我只想为下面的简单项目模型创建一个快速的 CRUD 应用程序。

**模型.py**

```
class Project(models.Manager):
    name =  models.CharField(_('Name of the Project'), max_length = 100,)
    slug = models.SlugField(max_length=100,)
    ... 
```

**视图.py**

```
from django.views.generic.edit import CreateView, UpdateView, DeleteView
from django.core.urlresolvers import reverse_lazy
from project.models import Project

class ProjectCreate(CreateView):
    model = Project

class ProjectUpdate(UpdateView):
    model = Project 
```

当我现在加载`\project\add`应该调用`ProjectCreate`该类时，我收到以下错误： **类型对象'Project'没有属性'_meta'**

我不明白为什么。模型类通常不需要元信息。在其他基于类的项目中，我没有遇到这个问题。

谢谢你的建议！

**追溯**

```
Django Version: 1.4.1
Python Version: 2.7.1

Traceback:
File "/Users/neurix/Development/vir_project_2.0/lib/python2.7/site-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/Users/neurix/Development/vir_project_2.0/lib/python2.7/site-packages/django/views/generic/base.py" in view
  48\.             return self.dispatch(request, *args, **kwargs)
File "/Users/neurix/Development/vir_project_2.0/lib/python2.7/site-packages/django/views/generic/base.py" in dispatch
  69\.         return handler(request, *args, **kwargs)
File "/Users/neurix/Development/vir_project_2.0/lib/python2.7/site-packages/django/views/generic/edit.py" in get
  168\.         return super(BaseCreateView, self).get(request, *args, **kwargs)
File "/Users/neurix/Development/vir_project_2.0/lib/python2.7/site-packages/django/views/generic/edit.py" in get
  130\.         form_class = self.get_form_class()
File "/Users/neurix/Development/vir_project_2.0/lib/python2.7/site-packages/django/views/generic/edit.py" in get_form_class
  89\.             return model_forms.modelform_factory(model)
File "/Users/neurix/Development/vir_project_2.0/lib/python2.7/site-packages/django/forms/models.py" in modelform_factory
  407\.     return form_metaclass(class_name, (form,), form_class_attrs)
File "/Users/neurix/Development/vir_project_2.0/lib/python2.7/site-packages/django/forms/models.py" in __new__
  206\.                                       opts.exclude, opts.widgets, formfield_callback)
File "/Users/neurix/Development/vir_project_2.0/lib/python2.7/site-packages/django/forms/models.py" in fields_for_model
  146\.     opts = model._meta

Exception Type: AttributeError at /project/add/
Exception Value: type object 'Project' has no attribute '_meta' 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-09T09:56:28.243

改变：

```
class Project(models.Manager) 
```

到：

```
class Project(models.Model) 
```

因为`models.Model`是实际类，您必须扩展才能创建自定义模型，并且管理器实际上用于覆盖涉及的数据库操作模型。

# r - 迭代向量的笛卡尔积

> ID：12338092
> 
> 赞同：6
> 
> 时间：2012-09-09T09:50:14.150
> 
> 标签：r, vector, cartesian-product

我有以下嵌套循环：

```
for (x in xs) {
    for (y in ys) {
        # Do something with x and y
    }
} 
```

我想将其展平，所以我想构建两个向量的笛卡尔积`xs`并`ys`迭代结果。在 Python 中，这将是微不足道的：

```
for xy in product(xs, ys):
    # x, y = xy[0], xy[1] 
```

但在 R 中，我发现的最简单的等价物看起来令人生畏：

```
xys <- expand.grid(xs, ys)
for (i in 1 : nrow(xys)) {
    xy <- as.vector(xys[i, ])
    # x <- xy[1], y <- xy[2]
} 
```

肯定有更好的方法，不是吗？（澄清一下，我不想迭代*索引*......我认为必须有一种方法可以直接迭代产品中的元组。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-09T10:15:07.000

R 与 Python 有不同的范式，所以不要指望它有生成器或元组——我们有向量和索引。

这样，要在笛卡尔积上映射函数，只需调用

```
outer(xs,ys,function(x,y) ...) 
```

如果你愿意，可以取消结果。

编辑：如果`xs`或`ys`比基向量更复杂，一种选择是使用索引，即

```
outer(seq(a=xs),seq(a=ys),function(xi,yi) ... xs[[xi]]/ys[xi,]/etc. ...) 
```

或者在一个手工制作的产品上使用`mapply`

```
mapply(function(x,y) ...,xs,rep(ys,each=length(xs))) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-09T10:18:59.343

您可以使用该`apply`函数将函数应用于数据框的每一行。只需替换`"your function"`为您的实际功能。

```
# example data
xs <- rnorm(10)
ys <- rnorm(10)    

apply(expand.grid(xs, ys), 1, FUN = function(x) {"your function"}) 
```

这是一个非常基本的例子。在这里，计算一行中两个值的总和：

```
apply(expand.grid(xs, ys), 1, FUN = function(x) {x[1] + x[2]}) 
```

* * *

这是一个使用命名参数 ( `xs`, `ys`) 而不是索引 ( `x[1]`, `x[2]`) 的变体：

```
myfun <- function(xs, ys) xs + ys
arguments <- expand.grid(xs = rnorm(10), ys = rnorm(10))
apply(arguments, 1, function(x)do.call(myfun, as.list(x))) 
```

# matlab - matlab遗传算法求解器复杂输入输出

> ID：12338106
> 
> 赞同：0
> 
> 时间：2012-09-09T09:52:44.607
> 
> 标签：matlab, optimization, genetic-algorithm

我的 Matlab 程序有多个输入作为结构（`in.a`,`in.b`等）和多个输出（`out.a`,`out.b`等）

我想使用优化工具箱中的遗传算法求解器来找到最佳输入`in.a`，而所有其他输入都是恒定的。适应度是输出之一，例如`out.b(2,3)`。

我如何“告诉”求解器？

谢谢丹尼尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T05:28:44.203

在编程中，遇到对您的函数最方便的内容与某些库调用对它的期望不相符的情况并不少见。解决此类问题的正常方法是在两者之间写一个小层，以允许两者进行对话；一个*界面*。

来自`help ga`：

> X = GA(FITNESSFCN,NVARS) 使用 GA 找到 FITNESSFCN 的局部无约束最小值 X。[...] FITNESSFCN 接受大小为 1×NVARS 的向量 X，并返回在 X 处计算的标量。

所以，`ga`期望向量输入，标量输出，而你有一个进出的结构。您必须编写以下（子）函数：

```
function Y = wrapper_Objfun(X, in)
    in.a = X; %# variable being optimized
    out  = YOUR_REAL_FUNCTION(in); %# call to your actual function
    Y    = out.b(2,3); %# objective value
end 
```

然后调用`ga`看起来像

```
X = ga(@(x) wrapper_Objfun(x,in), N); 
```

`N`然而`in.a`应该在哪里。

[还可以在Matlab 自己的有关该主题的文档](http://www.mathworks.nl/help/toolbox/optim/ug/brhkghv-7.html)中阅读它。

# validation - 使用惰性属性注册了一个 NHibernate 代理工厂 fot IDataErrorInfo 行为

> ID：12338108
> 
> 赞同：0
> 
> 时间：2012-09-09T09:52:52.013
> 
> 标签：validation, nhibernate, castle-dynamicproxy

我已经使用 Castle.DynamicProxy IIterceptor 实现了 IDataErrorInfo 接口。我还实现了一个 NHibernate 拦截器，它使用这个拦截器实例化我的实体。

我希望为延迟加载属性实现 IDataErrorInfo，如此处[所述](https://stackoverflow.com/questions/4525046/implementing-idataerrorinfo-using-castle-dynamicproxy-in-lazy-loading-scenario-u)

在上面的链接中，将 DataBindingProxyFactory 注册为 NHibernate 代理工厂所需的解决方案

我使用 NH 3.2，不知道如何以及在哪里注册

谁能帮帮我？

谢谢大家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:37:02.740

```
.ExposeConfiguration(c => c.SetProperty(Environment.ProxyFactoryFactoryClass, typeof(DataBindingProxyFactory).AssemblyQualifiedName)) 
```

感谢 João Manso][1] [1]: joao.manso.eu/index.php/2011/08/… – 2012-09-09 13:35:35

# java - 在 Spring MVC 中实现 XSLT 视图

> ID：12338113
> 
> 赞同：0
> 
> 时间：2012-09-09T09:53:35.777
> 
> 标签：java, xml, spring, xslt, spring-mvc

我是 Spring Tools Suite 3 的新手，我正在尝试实现 XSLT 视图。到目前为止，我只进行了以下更改：

**servlet-context.xml**

```
<bean class="org.springframework.web.servlet.view.xslt.XsltViewResolver">
    <property name="prefix" value="/WEB-INF/views/" />
    <property name="suffix" value=".xsl" />
</bean> 
```

**控制器.java**

```
@Controller
public class HomeController
{
@RequestMapping(value = "/", method = RequestMethod.GET)
public String home(HttpSession session, Model model)
{
    return "home";
}
} 
```

我的问题是如何创建 XML 数据源并将其传递给 XSLT？我想看代码示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:02:34.537

也许用你的模型返回一个 DOMSource() ，如下所示：

```
@RequestMapping 
public String overview(Model model) {
model.addAttribute("obj", new DOMSource());
return "list";
} 
```

您在[SpringSource 论坛上有](http://forum.springsource.org)[一个示例](http://forum.springsource.org/showthread.php?64198-XsltView-vs-AbstractXsltView-need-help&p=285253#post285253)。

不要忘记 SimpleFormController（来自我链接中的示例，在 Spring 3.0.x 中已弃用，但实现 XSL 视图的逻辑是相同的。

[你可以在官方文档](http://static.springsource.org/spring/docs/3.1.2.RELEASE/spring-framework-reference/htmlsingle/spring-framework-reference.html#view-xslt)中找到一些非常有用的东西。

特别是以下部分： [17.5.1.3 将模型数据转换为 XML](http://static.springsource.org/spring/docs/3.1.2.RELEASE/spring-framework-reference/htmlsingle/spring-framework-reference.html#view-xslt-subclassing) [17.5.1.4。定义视图属性](http://static.springsource.org/spring/docs/3.1.2.RELEASE/spring-framework-reference/htmlsingle/spring-framework-reference.html#view-xslt-viewdefinitions) [17.5.1.5。文档转换](http://static.springsource.org/spring/docs/3.1.2.RELEASE/spring-framework-reference/htmlsingle/spring-framework-reference.html#view-xslt-transforming)

你的控制器：

```
package xslt; 
```

// 为简洁起见省略了导入

```
public class HomePage extends AbstractXsltView {

protected Source createXsltSource(Map model, String rootName, HttpServletRequest
    request, HttpServletResponse response) throws Exception {

    Document document = DocumentBuilderFactory.newInstance().newDocumentBuilder().newDocument();
    Element root = document.createElement(rootName);

    List words = (List) model.get("wordList");
    for (Iterator it = words.iterator(); it.hasNext();) {
        String nextWord = (String) it.next();
        Element wordNode = document.createElement("word");
        Text textNode = document.createTextNode(nextWord);
        wordNode.appendChild(textNode);
        root.appendChild(wordNode);
    }
    return new DOMSource(root);
} 
```

你的`view.properties`文件：

```
home.(class)=xslt.HomePage
home.stylesheetLocation=/WEB-INF/xsl/home.xslt
home.root=words 
```

您的 XSLT 样式表文件：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:output method="html" omit-xml-declaration="yes"/>

    <xsl:template match="/">
        <html>
            <head><title>Hello!</title></head>
            <body>
                <h1>My First Words</h1>
                <xsl:apply-templates/>
            </body>
        </html>
    </xsl:template>

    <xsl:template match="word">
        <xsl:value-of select="."/><br/>
    </xsl:template>

</xsl:stylesheet> 
```

祝你好运！

添加了关于[Apache FOP 项目和使用 Servlets 进行 XSL 转换的](http://xmlgraphics.apache.org/fop/1.1rc1/servlets.html)信息：

```
private FopFactory fopFactory = FopFactory.newInstance();
private TransformerFactory tFactory = TransformerFactory.newInstance();

public void init() throws ServletException {
    //Optionally customize the FopFactory and TransformerFactory here
}

[..]

//Setup a buffer to obtain the content length
ByteArrayOutputStream out = new ByteArrayOutputStream();

//Setup FOP
Fop fop = fopFactory.newFop(MimeConstants.MIME_PDF, out);

//Setup Transformer
Source xsltSrc = new StreamSource(new File("foo-xml2fo.xsl"));
Transformer transformer = tFactory.newTransformer(xsltSrc);

//Make sure the XSL transformation's result is piped through to FOP
Result res = new SAXResult(fop.getDefaultHandler());

//Setup input
Source src = new StreamSource(new File("foo.xml"));

//Start the transformation and rendering process
transformer.transform(src, res);

//Prepare response
response.setContentType("application/pdf");
response.setContentLength(out.size());

//Send content to Browser
response.getOutputStream().write(out.toByteArray());
response.getOutputStream().flush(); 
```

# php - 哪个是使用 MVC 模板的最佳方式

> ID：12338114
> 
> 赞同：-1
> 
> 时间：2012-09-09T09:53:36.387
> 
> 标签：php, templates

有这样的模板会更好吗

```
<html>
<head>
<title><?php echo $this->data['title']; ?></title>
</head>
<body>
   <?php echo $this->data['content']; ?>
</body>
</html> 
```

或拥有类似的东西：

```
require('head.php');
require('header.php');
require('content.php');
require('footer.php'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T10:27:52.767

这只是一个偏好问题。我个人喜欢将页眉、正文和页脚分开。在我自己的小世界里似乎更干净。我还使用一个模板文件将它们一起解析，既然你提到了 mvc，我猜你已经做了一个。

# php - XAMPP 不使用 PHP 包括？

> ID：12338115
> 
> 赞同：1
> 
> 时间：2012-09-09T09:53:46.183
> 
> 标签：php, include, xampp, localhost

我已经在我的笔记本电脑上安装了 XAMPP，并就这个问题提出了很多不同的建议，但没有一个能解决它。

我的 PHP 包含根本不显示在页面上。

我在 XAMPP 文件夹中的 HTPDOCS 中创建了一个名为 mysite 的文件夹，当我转到 localhost/ 时，它会很好地显示 xampp 索引页面。当我键入 localhost/mysite/index.php 时，我得到了我的页面，但我的样式是一个 include，它是 contains/styles.php，它包含了我所有的样式表，这些样式表都放在我的 index.php 的头部。

我试过在Skype上更改我的端口，但没有帮助。

如果我希望我的包含文件开始工作，我还需要做什么？

在此先感谢，希望这是足够的信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T10:00:54.983

试试这个包含在你的 index.php 中：

```
include dirname(__FILE__) . "/includes/styles.php"; 
```

# c++ - 避免在 vs2010 中重建的最佳实践

> ID：12338124
> 
> 赞同：0
> 
> 时间：2012-09-09T09:55:25.327
> 
> 标签：c++, visual-studio-2010, rebuild, pre-build-event, prebuild

我有一个解决方案，它的一个项目编译时间太长而且很少更改。这意味着如果开发人员“重建”整个解决方案将需要时间（尽管在这个特定项目中没有任何改变）。

有人建议我可能添加一些“预构建事件命令行”，但我将如何检查是否需要编译（我确实希望它编译它已更改）？并且 - 如果我能失败 - 这是一个好习惯吗？（在持续集成等方面）

如果不需要，即使某些开发人员确实意味着要为整个解决方案重建，也可以随意提出任何其他我可以避免重建的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T10:01:11.570

VS 通常会找出需要重新构建的内容，然后只编译相应的项目。不过，您可以采取一些步骤：

*   避免更改标题，这些会触发包含它们的所有翻译单元的重新构建
*   使用预编译的头文件
*   使用前向声明而不是包含在头文件中（如果可能）
*   将大型解决方案分解为相互动态链接的模块化项目

# php - 使用 JQuery Ajax 防止 Ajax CSS 破坏主 CSS

> ID：12338125
> 
> 赞同：4
> 
> 时间：2012-09-09T09:56:01.860
> 
> 标签：php, jquery, css, ajax

我正在开发一个网页，该网页调用具有出色 jquery ajax 功能的另一个页面。我的问题是：ajax 页面中有一个 css 文件。被调用的页面需要它，但我不想在我的主页中看到子页面的 css 样式。

这是我如何调用子页面的摘要：

```
<script>
$.ajax({
type: "GET",
    url: "subpage.html",
    success: function(msg){
       $('#box').html(msg);
    }
});
</script>

<div id='box'>
</div> 
```

所以，subpage.html 是我项目的另一个模块的一种接口，它有自己的 CSS 文件。有什么很棒的知识或技巧可以防止该 css 文件出现在我的主页上吗？PHP 解决方案也是可以接受的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T09:59:01.710

您可以使用`iframe`s（[W3C 参考](http://www.w3schools.com/tags/tag_iframe.asp)，[MDN 参考](https://developer.mozilla.org/en-US/docs/HTML/Element/iframe)）。要使用 JavaScript 加载特定页面`iframe`，请使用类似 HTML 的内容：

```
<iframe id = "iframeID" height = "300px" width = "300px"></iframe> 
```

然后，当您要加载页面时：

```
document.getElementById("iframeID").src = "subpage.html"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T10:01:37.987

取而代之的是，您可以像这样使用 jQuery.load：

```
$('#box').load('subpage.html #the_id_of_something'); 
```

此示例将在您的页面上加载`#the_id_of_something`from `subpage.html`into的内容。`#box`

# ajax - 获取由 Google 索引的 AJAX 加载内容

> ID：12338126
> 
> 赞同：1
> 
> 时间：2012-09-09T09:56:04.877
> 
> 标签：ajax

好的，关于stackoverflow的第一个问题！

我有点进退两难，我最近创建了一个电子商务网站，并将其设置为使用 AJAX 很好地加载所有内容，以提高速度、UX 和 UI。然而，搜索引擎（谷歌）似乎没有为内容编制索引。做一些研究，返回的流行答案/修复是在此处实施 Google 指南：[https ://developers.google.com/webmasters/ajax-crawling/](https://developers.google.com/webmasters/ajax-crawling/)

长话短说，我真的不想在整个网站上使用“hash bangs”，我目前使用的 URL 简单而干净，并用 #! 就是不好看！在我开始走这条路之前，有没有其他选择？我目前在类别页面上使用 history.pushState，但我需要一些主要用于产品详细信息页面的东西，不涉及更改 URL。

这是加载产品详细信息的当前设置：

```
$(document).ready(function(){
    LoadContent();
});

function LoadContent() {
     Services.Content.GetProduct(productid, OnSuccess, OnFailure);
}
function OnSuccess(result) {
     $('#ContentLoading').css("display", "none");
     $('#Content').hide();
     $('#Content').html(result);
     $('#Content').delay(200).fadeIn();
} 
```

# bots - 注册 IP 地址但排除机器人

> ID：12338127
> 
> 赞同：0
> 
> 时间：2012-09-09T09:56:06.923
> 
> 标签：bots, web-crawler

我存储每个请求的 IP 地址，以查看我收到了多少访问者视图。

```
Dim clientIPAddress As String = Request.ServerVariables("REMOTE_ADDR")
locationsDAL.AddLocationView(locationId, "", User.Identity.Name, clientIPAddress, "website") 
```

但我注意到这也存储了爬取我网站的 MSN/Google 机器人等。

我怎样才能只存储非机器人的 IP 地址，所以真正的访客？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:10:55.727

官方模式是

[http://www.bing.com/community/site_blogs/b/webmaster/archive/2012/08/31/how-to-verify-that-bingbot-is-bingbot.aspx](http://www.bing.com/community/site_blogs/b/webmaster/archive/2012/08/31/how-to-verify-that-bingbot-is-bingbot.aspx)

[http://googlewebmastercentral.blogspot.com.es/2006/09/how-to-verify-googlebot.html](http://googlewebmastercentral.blogspot.com.es/2006/09/how-to-verify-googlebot.html)

此外，您可以通过用户代理或范围 ips 检测机器人。

通用用户代理：

```
Googlebot
  Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)
Googlebot-Mobile
  Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_1 like Mac OS X; en-us) AppleWebKit/532.9 (KHTML, like Gecko) Version/4.0.5 Mobile/8B117 Safari/6531.22.7 (compatible; Googlebot-Mobile/2.1; +http://www.google.com/bot.html)         
bingbot
    Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)
MSNBot  
    msnbot-media/1.1 (+http://search.msn.com/msnbot.htm)        
MSRBOT  
    MSRBOT 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T22:16:44.953

好的，所以我所做的是：

```
Dim clientIPAddress As String = Request.ServerVariables("REMOTE_ADDR")
If Not CheckIfCrawler(Dns.GetHostEntry(clientIPAddress).HostName) Then
 'log view
end 

Public Shared Function CheckIfCrawler(ByVal hostname As String) As Boolean
    If hostname.Contains("googlebot") Then
        Return True
    ElseIf hostname.Contains("msnbot") Then
        Return True
    ElseIf hostname.Contains("baiduspider") Then
        Return True
    ElseIf hostname.Contains("nipple3.mail.ru") Then
        Return True
    ElseIf hostname.Contains("reverse.wowrack.com") Then
        Return True
    ElseIf hostname.Contains("crawl") Then
        Return True
    ElseIf hostname.Contains("spider") Then
        Return True
    ElseIf hostname.Contains("nipple2.mail.ru") Then
        Return True
    Else
        Return False
    End If
 End Function 
```

这样我就可以通过主机名排除大多数机器人。每 6 个月我会再次检查数据库，看看是否有任何特定的主机名有很多浏览量。然后，我使用 IP GeoDB 手动检查该主机名/IPAddress 是否属于机器人，如果是，则手动将其添加到 CheckIfCrawler 函数中。

# php - 调整代码从给定的 URL 检索 DOM

> ID：12338128
> 
> 赞同：0
> 
> 时间：2012-09-09T09:56:27.193
> 
> 标签：php, html

你好 ，

我使用以下代码从 URL 中检索 DOM ind 所有“A”标签并打印它们的 HREF 现在我的输出包含“A”我不希望它在这里 [http://trend.remal.com/parsing.php](http://trend.remal.com/parsing.php) 一些元素重复，我需要清除我的只有“A”，其中包括 [https://twitter.com/](https://twitter.com/) $namehere，因为你可以看到我有 2 种 url 我只需要 twitter url 并避免重复任何调整提示编码

```
<?php
include('simple_html_dom.php');

 $html = file_get_html('http://tweepar.com/sa/1/');
 foreach($html->find('a') as $e) 
 echo $e->href . '<br>';
 ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:04:12.840

```
$urls = array();

foreach ( $html->find('a') as $e )
{
    // If it's a twitter link
    if ( strpos($e->href, '://twitter.com/') !== false )
    {
        // and we don't have it in the array yet
        if ( ! in_array($e->href, $urls) )
        {
            // add it to our array
            $urls[] = $e->href;
        }
    }
}

echo implode('<br>', $urls); 
```

以下是 PHP 文档中的一些参考资料：

*   [`strpos`](http://us2.php.net/manual/en/function.strpos.php)
*   [`in_array`](http://php.net/manual/en/function.in-array.php)
*   [`implode`](http://us2.php.net/manual/en/function.implode.php)

# android - 从 SqliteDatabase 检索数据时出现异常

> ID：12338131
> 
> 赞同：0
> 
> 时间：2012-09-09T09:56:36.693
> 
> 标签：android, image, android-sqlite

我已经编写了将图像存储在 sqlitedatabase 中的代码，还编写了获取所有记录的方法，但是在获取数据时，我得到了异常为 Nullpointer 异常。我在 selectall 方法中做错了什么？

```
public class DBUserAdapter {

    private static final String DATABASE_NAME = "users"; 
    private static final int DATABASE_VERSION = 1; 

    private static final String USERDETAILS=
            "create table userdetails(usersno integer primary key autoincrement,photo BLOB,date text not null);";

    private Context context = null; 
    private DatabaseHelper DBHelper; 
    private SQLiteDatabase db; 
    public DBUserAdapter(Context context) {
        this.context = context;  
        DBHelper = new DatabaseHelper(context);

    }
    private static class DatabaseHelper extends SQLiteOpenHelper 
    { 
        DatabaseHelper(Context context) 
        { 
            super(context, DATABASE_NAME, null, DATABASE_VERSION); 
        }

        public void onCreate(SQLiteDatabase db) {
            db.execSQL(USERDETAILS);

        }

        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            // TODO Auto-generated method stub
            db.execSQL("DROP TABLE IF EXISTS users"); 
            onCreate(db); 
        } 
    }

    public void open() throws SQLException 
    { 
        db = DBHelper.getWritableDatabase(); 
        return;
    } 

    public void close() 
    { 
        DBHelper.close(); 
    }     

    public long insert(byte[] photo, String date) 
    { 

        ContentValues initialValues = new ContentValues(); 
        initialValues.put("photo", photo); 
        initialValues.put("date", date); 
        // initialValues.put(KEY_TIME, time); 
        Log.d("inotvaluessssssssss",initialValues.toString());
        Log.d("dbbbbbbbbbb++++++*******", db.toString());
        return db.insert("userdetails", null, initialValues);

    } 

    public Cursor selectAll(String TABLE_NAME, String COLUMNS, String SELECTION, String[] SELECTION_ARGS,
            String GROUP_BY, String HAVING, String OREDER_BY) {
        // TODO Auto-generated method stub
        Cursor cursor = this.db.query(TABLE_NAME, new String[] { COLUMNS }, 
                SELECTION, SELECTION_ARGS, GROUP_BY, HAVING, OREDER_BY);
        return cursor;

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T06:29:18.010

创建一个 ArrayList 来保存从数据库收集的所有数据。

```
ArrayList<ArrayList<Object>> dataArrays = new ArrayList<ArrayList<Object>>(); 
```

这是一个创建“光标”对象的数据库调用。游标对象存储从数据库收集的信息，用于遍历数据。

在这里完成代码...

```
public ArrayList<ArrayList<Object>> getAllRowsAsArrays()
    {

        ArrayList<ArrayList<Object>> dataArrays = new ArrayList<ArrayList<Object>>();

        Cursor cursor;

        try
        {
            // ask the database object to create the cursor.
            cursor = db.query(
                    TABLE_NAME,
                    new String[]{TABLE_ROW_ID, TABLE_ROW_ONE, TABLE_ROW_TWO},
                    null, null, null, null, null
            );

            // move the cursors pointer to position zero.
            cursor.moveToFirst();

            // if there is data after the current cursor position, add it
            // to the ArrayList.
            if (!cursor.isAfterLast())
            {
                do
                {
                    ArrayList<Object> dataList = new ArrayList<Object>();

                    dataList.add(cursor.getLong(0));
                    dataList.add(cursor.getString(1));
                    dataList.add(cursor.getString(2));

                    dataArrays.add(dataList);
                }
                // move the cursor's pointer up one position.
                while (cursor.moveToNext());
            }
        }
        catch (SQLException e)
        {
            Log.e("DB Error", e.toString());
            e.printStackTrace();
        }

        // return the ArrayList that holds the data collected from
        // the database.
        return dataArrays;
    } 
```

# spring - 如何使用 Spring 3.0 服务实现工厂模式

> ID：12338138
> 
> 赞同：0
> 
> 时间：2012-09-09T09:58:12.653
> 
> 标签：spring, design-patterns, factory

在我的项目中，我有一个用 org.springframework.stereotype.Service 标签注释的界面。

对于这个接口，我有两种不同的实现。

在我的管理 bean 中，我正在注入接口服务类并使用它的方法。

现在我的要求是，在运行时我必须选择特定的实现（比如说基于登录用户组），以便可以调用相应的逻辑。

根据我的理解，我们可以在 java 中使用工厂模式来实现这一点并实现相同的目标。

我们如何在 SPRing 中实现这一点？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T16:11:44.963

除了上面建议的相关主题外，[JavaRanch 上有一个很好的线程](http://www.coderanch.com/t/568815/Spring/multiple-implementations-interface-default-implementation)。

您可以使用

1.  @Qualifier("myServiceImpl1") 注释与@Autowired 一起使用。在这种情况下，接口的这个特定实现将被注入。您还应该在 @Component、@Service 或 @Repository 注释中使用相同的名称，例如

    ```
    @Service("myServiceImpl1") 
    public class MyServiceImpl1 implements MyService{}

    public class Consumer{
      @Autowired
      @Qualifier("myServiceImpl1") 
      public MyService myServiceImpl1;
    } 
    ```

2.  @Primary 与您的实现类中的@Component、@Service 或@Repository 注释一起，在这种情况下，默认情况下会注入此实现。

3.  如果您使用@Autowired 标记某个接口类型的列表，则该接口的所有可用实现都将被注入。

    ```
    @Autowired 
    public List<MyService> allAvailableImplementations; 
    ```

# matlab - 在 MATLAB 中使用希腊字母（或任何非 ANSI 字母）作为变量名

> ID：12338141
> 
> 赞同：3
> 
> 时间：2012-09-09T09:58:19.627
> 
> 标签：matlab, syntax

是否可以使用希腊字母表示 MATLAB 中的变量？

例如，我想在 MATLAB 中使用希腊字符 epsilon 作为变量。我尝试插入`\epsilon`，但收到错误消息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-09T10:04:49.307

这不可能。

我参考了 Matlab 文档的以下部分：

> 有效名称
> 
> 有效的变量名称以字母开头，后跟字母、数字或下划线。MATLAB 区分大小写，因此 A 和 a 不是同一个变量。变量名的最大长度是 namelengthmax 命令返回的值。

字母定义为 和 之间的 ANSI`a-z`字符`A-Z`。例如，以下希伯来字母`Aleph`返回`false`（**在 Matlab R2018a 中返回 true**）：

```
isletter('א') 
```

顺便说一句，您始终可以使用`genvarname`.

```
genvarname('א')

ans =

x0x1A 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-10T09:33:28.017

虽然安德烈的回答对于变量名是正确的，但对于数字来说则是另一回事。

`title('\epsilon\omega')`将实际工作并生成一个 epsilon 和一个 omega 作为标题（尽管 matlab 字体用不同的符号替换它们）。如果您将图形导出为 eps 或 pdf 文件，您会看到标题确实是 epsilon omega。实际上任何 LaTeX 控制序列都可以工作！

对于所有图形文本对象（例如图例和轴标签）也是如此。

# java - 覆盖 Wicket 中 DropDownChoice 的选择

> ID：12338146
> 
> 赞同：0
> 
> 时间：2012-09-09T09:59:07.050
> 
> 标签：java, wicket, dropdownchoice

我对 Wicket 在模型中搜索 DropDownChoice 的选择的方式有疑问。

例子

```
//User Bean
public class Users {
  private Long language_id;
  public Long getLanguage_id() {
    return language_id;
  }
  public void setLanguage_id(Long language_id) {
    this.language_id = language_id;
  }
}

//Language Bean
public class Language {
  private Long language_id;
  private String name;
  public Long getLanguage_id() {
    return language_id;
  }
  public void setLanguage_id(Long language_id) {
    this.language_id = language_id;
  }
  public String getName() {
    return name;
  }
  public void setName(String name) {
    this.name = name;
  }
} 
```

检票口 HTML

```
<form wicket:id="form">
  <select wicket:id="language_id"/>
</form> 
```

呈现/编译 Wicket 表单的 Jave 代码：

```
public class UserForm extends Form<Users> {
  public UserForm(String id, Users user) {
    add(new DropDownChoice<Language>("language_id", Application
      .getBean(LanguageDaoImpl.class).getLanguages(),
      new ChoiceRenderer<Language>("name", "language_id")));
  }
} 
```

问题是渲染效果很好，所有语言都在下拉选择中。但是，只要将任何用户加载到表单中，Wicket 就会在 Long 值“language_id”中搜索属性“language”并抛出一些异常，例如“No get method defined for class: java.lang.Long ...” Wickets 希望我将完整的 Bean“语言”放入 Users 对象中。但是，我只有用户对象中的 ID，而不是完整的 Bean。

我怎样才能让 Wicket 只使用 ID 而不是期望整个对象都可用？我想我需要覆盖 DropDownChoice 中的一些方法，但我找不到合适的方法。

谢谢！塞巴斯蒂安

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T10:38:11.167

问题是您试图`Language`在字段中设置 a `language_id`。您需要使用`IModel`将 映射`Language`到 id。这是一些工作示例代码：

```
public class UserForm extends Form<Users> {
    public UserForm(String id, final Users user) {
        super(id);
        final List<Language> l = new ArrayList<HomePage.Language>();
        l.add(new Language(1L, "English"));
        l.add(new Language(2L, "German"));
        add(new DropDownChoice<Language>("language_id", new IModel<Language>() {
            public Language getObject() {
                for (Language lang : l) {
                    if (lang.getLanguage_id().equals(user.getLanguage_id())) {
                        return lang;
                    }
                }
                return null;
            }

            public void setObject(Language object) {
                user.setLanguage_id(object.getLanguage_id());
            }

            public void detach() {
            }
        }, l, new ChoiceRenderer<Language>("name", "language_id")));
    }
} 
```

我认为不可能只覆盖一个方法，`DropDownChoice`因为它的泛型类型始终与选择列表和模型类型相同。这意味着您不能将 a 传递`List<Language>`给 a`DropDownChoice`并期望在`Long`没有知道如何转换值的模型的情况下得到回报。

**编辑：**另一种选择是使用 a`DropDownChoice<Long>`并实现一个自定义`ChoiceRenderer`，它知道如何将其转换`Long`为语言的名称。我认为这是在这种情况下最简单的解决方案。

# c++ - QT Creator 的 LNK4099 链接器警告

> ID：12338147
> 
> 赞同：6
> 
> 时间：2012-09-09T09:59:12.490
> 
> 标签：c++, qt, linker-errors

所以每次我建立我的程序时，我都会收到以下警告信息；

```
qtmaind.lib(qtmain_win.obj):-1: warning: LNK4099: PDB 'vc100.pdb' was not found with 'qtmaind.lib(qtmain_win.obj)' or at 'D:\Projects\Test-2\blah-build-desktop-Qt_4_8_1_for_Desktop_-_MSVC2010__Qt_SDK__Debug\debug\vc100.pdb'; linking object as if no debug info 
```

我可以按照这里的问题所述忽略它； [全新安装 Qt SDK 和 Visual C++ 2008 时出现 LNK4099 链接器警告](https://stackoverflow.com/questions/8359550/lnk4099-linker-warning-with-clean-install-of-qt-sdk-and-visual-c-2008)

但是总是看到它变得相当烦人，事实上 vc100.pdb 被构建但没有进入调试文件夹。如下图所示；

![在此处输入图像描述](../Images/42f82b21a581b0223ddae0f07f0da16a.png)

所以链接器在调试文件夹中寻找“vc100.pdb”，但“vc100.pdb”文件位于顶层目录中。所以我想知道我实际上如何在 QT 创建者中更改查找目录，或者实际上是否可以将“vc100.pdb”移动到调试文件夹中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T10:46:32.603

啊，如果你从 Visual Studio 的命令提示符启动 Qt Creator，一堆问题会自动解决。刚开始

```
%comspec% /k ""C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"" x86 
```

（或在您的开始菜单中找到它）并在其中键入 Qt Creator 的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-23T17:15:13.230

Vc100.pdb 是库的默认 pdb 名称。此问题可能是由在同一目录中构建多个 .lib 文件引起的。

这是由 /Fdname.pdb 作为 cl 选项修复的。

# html - 在居中的表格中居中不均匀的行

> ID：12338151
> 
> 赞同：0
> 
> 时间：2012-09-09T10:00:30.563
> 
> 标签：html, css

我正在尝试在 CSS 中将表格及其行居中。

我可以使用以下方法使表格居中：

```
table.Center
{
    margin-left:auto; 
    margin-right:auto;
} 
```

但是当我尝试在表格行上调用类似的东西时，我最终得到以下结果：

[![http://i45.tinypic.com/259va.jpg](../Images/bc5178f353e133c84ff9630e44fc22be.png)](https://i.stack.imgur.com/IiGAc.jpg)

期望的结果是：

```
 XX
XXXX
XXXX 
```

为了视觉，使用两个而不是三个。

如何将表格行居中到页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T11:47:38.400

CSS解决方案：

```
table {
    text-align:center
}
td {
    display:inline-block
}​ 
```

[http://jsfiddle.net/gz3X2/](http://jsfiddle.net/gz3X2/)

# git - 当我使用 git difftool --cached 时，p4merge 显示错误“nul 是（或指向）无效文件”

> ID：12338158
> 
> 赞同：6
> 
> 时间：2012-09-09T10:01:47.917
> 
> 标签：git, p4merge

我刚刚决定并安装了 p4merge 作为我的 git 可视化合并工具。为了做到这一点，我使用这个命令配置了我的 git

```
git config --global merge.tool p4merge
git config --global mergetool.p4merge.cmd 'p4merge $BASE $LOCAL $REMOTE $MERGED' 
```

然后我对它们进行了测试并运行了`git difftool`命令，它工作得很好。但是当我运行时`git difftool --cached`，p4merge 显示一条错误消息：

```
nul is (or points to) an invalid file 
```

我也尝试按照此[博客](http://www.geekgumbo.com/2010/05/12/installing-and-using-p4merge-in-git-for-windows/)中的说明进行操作，但无法解决问题。

顺便说一句，我在 Windows 7 上使用 git & p4merge。有人知道这个问题的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-23T10:58:38.670

根据给定的信息很难说，但由于比较文件中的空格，我遇到了同样的问题。我改用 Linux，感谢这篇[文章](https://unix.stackexchange.com/questions/108635/why-i-cant-escape-spaces-on-a-bash-script)，我修复了它：

只需搜索：`bar "$@"`

# php - 图片上传创建问题

> ID：12338159
> 
> 赞同：0
> 
> 时间：2012-09-09T10:01:58.867
> 
> 标签：php, mysql, html

我是 php 新手，我正在使用 php 的图像上传脚本来更新我的徽标，每当用户选择图像文件时，现有图像文件应该被新的上传文件替换并且也应该在屏幕上更新，因为这个 iam 使用这个脚本但它没有做任何事情，我的意思是它也没有替换图像，也没有将新图像放入文件夹...... :(请帮助我摆脱这个问题，几个月以来我一直在这个问题中......

这是 setup.php

```
<?php include("../includes/config.php"); ?>
<?php
 if ($_SESSION["isadmin"])
 {

 $con=mysql_connect($dbserver,$dbusername,$dbpassword);
if (!$con) { die('Could not connect: ' . mysql_error()); }

mysql_select_db($dbname, $con);

$result = mysql_query("SELECT * FROM setup WHERE (id=".$_SESSION["id"].")");
while($row = mysql_fetch_array($result))
{
   $title = $row['title'];
   $theme = $row['theme'];
}
mysql_close($con);
?>

<!DOCTYPE HTML>
<html>
<head>
<title>Admdin Home</title>
<link rel="StyleSheet" href="css/style.css" type="text/css" media="screen">
</head>
<body>
<?php include("includes/header.php"); ?>
<?php include("includes/nav.php"); ?>
<?php include("includes/aside.php"); ?>
<div id="maincontent">

<div id="breadcrumbs">
    <a href="">Home</a> >
    <a href="">Setup</a> >
    Customization
</div>
<h2>Customize</h2>
<?php
if (isset($_GET["status"]))
{
if($_GET["status"]==1)
{
echo("<strong>Customization Done!</strong>");
}
if($_GET["status"]==2)
{
echo("<strong>Customization Error!!</strong>");
}
}

?>
<form method="post"  action="setup-action.php" enctype="multipart/form-data" >
<label>Title Of Your Organization:</label>  <input type="text" name="title" value="<?    php       echo $title; ?>" /> <br /> <br />
<label>Select Theme</label>
<select name="theme" value="<?php echo $theme; ?>">
<option value="Default">Default</option>
<option value="Dark">Dark</option>
<option value="White">White</option>
</select>
<br /> <br />
<label>Choose Your Logo Here</label><input type="file" name="file"/><br /> <br />      
<input type="submit" name="Upload" value="Upload" />
</form>

</div>

</body>
<?php include("includes/footer.php"); ?>
</html>
<?php
}
else
{
    header("Location: ".$fullpath."login/unauthorized.php");

}
?> 
```

这是 setup-action.php

```
<?php include("../includes/config.php");?>
<?php
if(isset($_FILES["file"]))
{
if ((($_FILES["file"]["type"] == "image/gif") || ($_FILES["file"]["type"] ==   "image/jpeg") || ($_FILES["file"]["type"] == "image/pjpeg"))
 && ($_FILES["file"]["size"] < 1000000))
 {
 if ($_FILES["file"]["error"] > 0)
  {
     echo "Return Code: " . $_FILES["file"]["error"] . "<br />";
  }

    if (file_exists("../graphics/" . $_FILES["file"]["name"]))
      {
          echo $_FILES["file"]["name"] . " already exists. ";
      }
    else
      {
          move_uploaded_file($_FILES["file"]["name"],
          "../graphics/" . $_FILES["file"]["name"]);
          echo "Stored in: " . "../graphics/" . $_FILES["file"]["name"];
      }
   }
 }
 else
  {
  echo "Invalid file";
  }
 ?>
 <?php
 $title=$_POST["title"];
$theme=$_POST["theme"];
$con=mysql_connect($dbserver,$dbusername,$dbpassword);
if (!$con) { die('Could not connect: ' . mysql_error()); }

mysql_select_db($dbname, $con);
$result=mysql_query("SELECT * FROM setup WHERE id=".$_SESSION['id']);
$num_rows = mysql_num_rows($result);
if ($num_rows > 0)
 {
 {
 mysql_query("UPDATE setup  SET title='".$title."' , theme='".$theme."'WHERE   id=".$_SESSION['id']);
 header("Location:setup.php?status=1");
 }
}
else {
header("Location:setup.php?status=2");
}
mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:09:26.410

看到这个网址

[http://www.tizag.com/phpT/fileupload.php](http://www.tizag.com/phpT/fileupload.php)

尝试这个：-

```
<form enctype="multipart/form-data" action="uploader.php" method="POST">
<input type="hidden" name="MAX_FILE_SIZE" value="100000" />
Choose a file to upload: <input name="uploadedfile" type="file" /><br />
<input type="submit" value="Upload File" />
</form> 
```

上传者.php

```
$target_path = "uploads/";

$target_path = $target_path . basename( $_FILES['uploadedfile']['name']); 

if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) {
    echo "The file ".  basename( $_FILES['uploadedfile']['name']). 
    " has been uploaded";
} else{
    echo "There was an error uploading the file, please try again!";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T15:22:17.113

```
 STEP1: Create file upload.php
     ############### Code

    `<table width="500" border="0" align="center" cellpadding="0" cellspacing="1"           bgcolor="#CCCCCC">
      <tr>
   <form action="upload_ac.php" method="post" enctype="multipart/form-data"       name="form1" id="form1">
  <td>
  <table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FFFFFF">
  <tr>
 <td><strong>Single File Upload </strong></td>
 </tr>
 <tr>
 <td>Select file 
<input name="ufile" type="file" id="ufile" size="50" /></td>
</tr>
 <tr>
 <td align="center"><input type="submit" name="Submit" value="Upload" /></td>
 </tr>
 </table>
 </td>
 </form>
</tr>
</table>
`
 STEP2: Create file upload_ac.php
  ############### Code

   <?php
  //set where you want to store files
  //in this example we keep file in folder upload 
  //$HTTP_POST_FILES['ufile']['name']; = upload file name
  //for example upload file name cartoon.gif . $path will be upload/cartoon.gif

  $path= "upload/".$HTTP_POST_FILES['ufile']['name'];
  if($ufile !=none)
 {
 if(copy($HTTP_POST_FILES['ufile']['tmp_name'], $path))
 {
 echo "Successful<BR/>"; 

 //$HTTP_POST_FILES['ufile']['name'] = file name
 //$HTTP_POST_FILES['ufile']['size'] = file size
 //$HTTP_POST_FILES['ufile']['type'] = type of file

 echo "File Name :".$HTTP_POST_FILES['ufile']['name']."<BR/>"; 
 echo "File Size :".$HTTP_POST_FILES['ufile']['size']."<BR/>"; 
 echo "File Type :".$HTTP_POST_FILES['ufile']['type']."<BR/>"; 
 echo "<img src=\"$path\" width=\"150\" height=\"150\">";
 }
 else
{
 echo "Error";
 }
 }
 ?> 
```

# android - 获取从列表视图中选择的联系人的详细信息

> ID：12338160
> 
> 赞同：1
> 
> 时间：2012-09-09T10:02:15.063
> 
> 标签：android, listview, checkbox, contact

我正在设计应用程序，我希望允许用户选择多个联系人来发送消息。我已经使用以下代码成功检索了带有复选框的列表视图中的用户列表。现在我希望当用户单击“完成”按钮时，**应在 EDITTEXT**中检索所有选定联系人的电话号码，格式为**John <+919898xxxxxx>、Rick <+919988xxxxxx>**以及所有包含的电话号码**只有 10 位数字，即“9898xxxxxx”应该自动存储在一个用逗号分隔的字符串中（9898xxxxxx，9988xxxxxx）**。我怎样才能完成要求。

```
public class ContactsActivity extends ListActivity {

protected static final String TAG = null;
public String[] Contacts = {};
public int[] to = {};
public ListView myListView;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_contacts);
    final Button done_Button = (Button) findViewById(R.id.done_Button);
    final Button clear_Button =(Button) findViewById(R.id.clear_Button);
    Cursor mCursor = getContacts();
    startManagingCursor(mCursor);
    ListAdapter adapter = new SimpleCursorAdapter(this, android.R.layout.simple_list_item_multiple_choice, mCursor,
            Contacts = new String[] {ContactsContract.Contacts.DISPLAY_NAME },
            to = new int[] { android.R.id.text1 });
    setListAdapter(adapter);
    myListView = getListView();
    myListView.setItemsCanFocus(false);
    myListView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);
    clear_Button.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            Toast.makeText(getApplicationContext(),"Selections Cleared", Toast.LENGTH_SHORT).show();
            ClearSelections();
        }
    });

    /** When 'Done' Button Pushed: **/
    done_Button.setOnClickListener(new View.OnClickListener() {
        public void onClick (View v){
            Log.i(TAG,":Done Button Selected:");
            SparseBooleanArray selectedPositions = myListView.getCheckedItemPositions();
            Log.i(TAG,"Number of Checked Positions: " + selectedPositions.size());
            for (int i=0; i<selectedPositions.size(); i++) {
                if (selectedPositions.get(selectedPositions.keyAt(i)) == true) {
                    //do stuff

                }
            }
        }
    });
}

private void ClearSelections() {
    int count = this.myListView.getAdapter().getCount();
    for (int i = 0; i < count; i++) {
        this.myListView.setItemChecked(i, false);
    }
}

private Cursor getContacts() {
    // Run query
    Uri uri = ContactsContract.Contacts.CONTENT_URI;
    String[] projection = new String[] { ContactsContract.Contacts._ID,
                                    ContactsContract.Contacts.DISPLAY_NAME};
    String selection = ContactsContract.Contacts.HAS_PHONE_NUMBER + " = '"
            + ("1") + "'";
    String[] selectionArgs = null;
    String sortOrder = ContactsContract.Contacts.DISPLAY_NAME
            + " COLLATE LOCALIZED ASC";

    return managedQuery(uri, projection, selection, selectionArgs,
            sortOrder);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_contacts, menu);
    return true;
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-22T05:01:00.513

终于配置好了

```
 done_Button.setOnClickListener(new View.OnClickListener() {
        public void onClick (View v){
            String name = null;
            String number = null;
            long [] ids = myListView.getCheckedItemIds();
            for(long id : ids) {
                Cursor contact = getContentResolver().query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI, null, 
                        ContactsContract.CommonDataKinds.Phone.CONTACT_ID + " = ?", new String[] { id + "" }, null);
                while(contact.moveToNext()){
                    name = contact.getString(contact.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));
                    //name+=name;
                    number = contact.getString(contact.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER));
                    //number+=number;
                }
                Toast.makeText(getApplicationContext(), "Name: " +name + "\n" + "Number: " + number , Toast.LENGTH_LONG).show();
            }
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:32:29.320

```
String numberListString = "";

for (int i=0; i<selectedPositions.size(); i++) {
                if (selectedPositions.get(selectedPositions.keyAt(i)) == true) {
                    //do stuff
                    numberListString  = numberListString + "," + numberAtCurrentSelectedPostion;

                }
            }

mEditText.setText(numberListString); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T09:59:52.947

在您按下完成按钮时尝试此操作：-

```
done_Button.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            name.clear();
            number.clear();
            Log.i(TAG, ":Done Button Selected:");
            SparseBooleanArray selectedPositions = myListView
                    .getCheckedItemPositions();
            Log.i(TAG,
                    "Number of Checked Positions: "
                            + selectedPositions.size());
            Cursor cur = getContacts();
            for (int i = 0; i < selectedPositions.size(); i++) {
                if (selectedPositions.get(selectedPositions.keyAt(i)) == true) {
                    // do stuff
                    cur.moveToPosition(selectedPositions.keyAt(i));
                    name.add(cur.getString(1));
                }
            }
            for (int i = 0; i < name.size(); i++) {
                Cursor lCursor = getContentResolver().query(
                        ContactsContract.CommonDataKinds.Phone.CONTENT_URI,
                        null, "DISPLAY_NAME = ? ",
                        new String[] { name.get(i) }, null);
                lCursor.moveToFirst();
                number.add(lCursor.getString(lCursor
                        .getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER)));
                lCursor.close();
            }

        }
    }); 
```

其中 name 和 number 是 String 类型的数组列表。您将获得所有选定的名称和数字。现在，您可以根据需要在“编辑文本”中显示它们。

我想这会对你有所帮助。

# html - 边缘 css 属性的特殊行为

> ID：12338165
> 
> 赞同：3
> 
> 时间：2012-09-09T10:02:47.217
> 
> 标签：html, css, margin

情况是：

CSS：

```
<style>
#aux1{
    position:relative;      
    background-color:#ccc;
    width:100%;
    height:200px;
}
#aux2{
    display:block;
    background-color:#F00;
    width:100px;
    height:100px;
    margin:20px;
}

</style> 
```

的HTML：

```
<html><head></head>
<body>
    "...some content (div with height: auto)"
    <div id="aux1">
        <div id="aux2">
        </div>
    </div>
</body>
</html> 
```

问题是来自 aux2 的 margin 属性的行为很奇怪，如下图所示：

![不寻常的边缘照片 1](../Images/0782ccd8782a8cb3d4de7de7bbd8b7f3.png)

如果我将溢出：隐藏在 aux1 中，结果趋于正常：

![不寻常的边缘照片 2](../Images/269268f95593316f5892f1cf5c6aa22f.png)

为什么我什至需要使用溢出：隐藏边距（尤其是边距顶部）才能正常运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T10:12:11.230

答案是，**margin collapsing**就像这个问题一样：[为什么这种 CSS margin-top 样式不起作用？](https://stackoverflow.com/questions/9519841/why-does-this-css-margin-top-style-not-work)

另一个问题参考：[CSS折叠边距有什么意义？](https://stackoverflow.com/questions/3069921/what-is-the-point-of-css-collapsing-margins)

# javascript - 使用 FB.ui 的 Facebook 提要对话框提供 API 错误 191

> ID：12338167
> 
> 赞同：2
> 
> 时间：2012-09-09T10:03:16.170
> 
> 标签：javascript, facebook, api, mobile

我想在我的网站上添加一个自定义 Facebook 分享按钮，就像您在 BBC 新闻报道顶部看到的按钮一样，例如[http://www.bbc.co.uk/news/uk-19535236](http://www.bbc.co.uk/news/uk-19535236)。他们为此使用了 Facebook Feed Dialog。因此，当您单击链接时，您会看到一个对话框，允许您将当前所在页面的 URL 发布到时间轴上。

FB.ui 方法似乎是调用对话框的最佳方式，因为它会自动为您的设备创建正确类型的弹出窗口。因此，使用手机的人会看到一个适合他们设备的弹出窗口。这个方法还允许我们指定一个回调，所以一旦用户分享了一个链接，我们就可以在他们分享的页面上增加分享次数。

我正在尝试遵循[http://developers.facebook.com/docs/reference/dialogs/feed/](http://developers.facebook.com/docs/reference/dialogs/feed/)上的第一个示例。

```
<div id='fb-root'></div>

<script src='http://connect.facebook.net/en_US/all.js'></script>

<p><a href="#" onclick='postToFeed(); return false;'>Post to Feed</a></p>

<p id='msg'></p>

<script>
    FB.init({appId: "00000000000", status: true, cookie: true});

    function postToFeed() {

        // calling the API ...
        var obj = {
            method: 'feed',
            link: 'http://example.com/',
            picture: 'http://fbrell.com/f8.jpg',
            name: 'Facebook Dialogs',
            caption: 'Reference Documentation',
            description: 'Using Dialogs to interact with users.'
        };

        function callback(response) {
            document.getElementById('msg').innerHTML = "Post ID: " + response['post_id'];
            if (response && response.post_id) {
                alert('Post was published.');
            } else {
                alert('Post was not published.');
            }
        }

        FB.ui(obj, callback);

    }

</script> 
```

（将我的实际 app_id 替换为 00000000000 并将站点 URL 替换为[http://example.com/](http://example.com/)）。但是当我单击链接时出现此错误：

```
API Error Code: 191
API Error Description: The specified URL is not owned by the application
Error Message: redirect_uri is not owned by the application. 
```

即使“链接”参数与我的 Facebook 应用程序设置中的应用程序的“站点 URL”完全匹配，我也会得到这个。

谁能告诉我如何让它工作？我希望人们能够分享我网站上的任何页面，而不仅仅是与我的 Facebook 应用程序对应的 URL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T14:59:24.960

为了共享工作，应用程序配置中的最低要求是至少设置

**应用程序域**（在基本信息下）

**网站 URL**（在使用 Facebook 登录的网站下）

IE

```
App Domains : example.com
Site URL : http://example.com 
```

设置其他参数也可以像**移动站点 URL**等一样工作。

# android - Android ListView滚动到位置

> ID：12338171
> 
> 赞同：0
> 
> 时间：2012-09-09T10:04:04.300
> 
> 标签：android, listview, scroll, winamp

```
private void setListviewSelection(final ListView list, final int pos) {
    list.post(new Runnable() {
        @Override
        public void run() {

            list.setSelection(pos);

            for (int i = 0; i < list.getChildCount(); i++)  {
                    View v = list.getChildAt(i);

                    if (i == pos && v != null)
                        v.setBackgroundColor(Color.argb(200, 51, 181, 229));
                    else if (v != null)
                        v.setBackgroundColor(Color.BLACK);
            }
        }
    });
} 
```

这是我用来模仿音乐播放器中的选择的代码。这个想法是，当用户按下 Next 或 Previous 按钮时，一个元素会在 中突出显示`ListView`，但这不是我想要的方式，因为`setSelection`滚动不顺畅并且基本上某些元素没有正确突出显示。为了更好地解释，我实际上要实现的是一个 Winamp 应用程序，当您按下下一个/上一个按钮（查看播放列表时）时，它具有滚动方式。

使用`setSelectionFromTop()`,`smoothScrollToPosition()`也无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:09:06.070

您只能`Views`从主线程更新。将您的代码移动到主线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T11:39:18.397

[http://bestsiteinthemultiverse.com/2009/12/android-selected-state-listview-example/](http://bestsiteinthemultiverse.com/2009/12/android-selected-state-listview-example/)

这是完美的解决方案。

# php - PHP mysql 查询语法错误

> ID：12338173
> 
> 赞同：3
> 
> 时间：2012-09-09T10:04:12.927
> 
> 标签：php, mysql, sql

我对 PHP/MySQL 还很陌生，我似乎遇到了新手问题。

无论我进行什么更改，以下代码都会不断向我抛出错误，而且我感觉它一定是在我搞砸的语法中的某个地方。这一切都在家里“本地主机”工作，但现在我试图在网上托管它，它似乎对空间和诸如此类的东西更有气质。

这是一个简单的登录系统，问题代码如下：

```
<?php
session_start();
require 'connect.php';
echo "Test";

//Hash passwords using MD5 hash (32bit string).
$username=($_POST['username']);
$password=MD5($_POST['password']);

//Get required information from admin_logins table
$sql=mysql_query("SELECT * FROM admin_logins WHERE Username='$username' ");
$row=mysql_fetch_array($sql);

//Check that entered username is valid by checking returned UserID
if($row['UserID'] === NULL){
    header("Location: ../adminlogin.php?errCode=UserFail");
}
//Where username is correct, check corresponding password
else if ($row['UserID'] != NULL && $row['Password'] != $password){
    header("Location: ../adminlogin.php?errCode=PassFail");
}
else{
    $_SESSION['isAdmin'] = true;
    header("Location: ../admincontrols.php");
}

mysql_close($con);

?> 
```

测试就在那里，所以我知道为什么页面会抛出错误，即：

```
`Warning: mysql_fetch_array(): supplied argument is not a valid MySQL result resource in 'THISPAGE' on line 12` 
```

它似乎不喜欢我的 SQL 查询。

任何帮助深表感谢。

### 编辑：

`connect.php`页面是：

```
<?php
$con = mysql_connect("localhost","username","password");
if(!$con) {
    die('Could not connect: ' . mysql_error());
}
    mysql_select_db("dbname", $con);
?> 
```

是的`mysql_*`，哈哈，我也会解决这个问题的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T10:06:21.983

您应该使用反引号转义列名`username`，尝试

```
SELECT * 
FROM admin_logins 
WHERE `Username` = '$username' 
```

您的代码很容易发生**[SQL 注入](http://bobby-tables.com/)**。使用**[PDO](http://php.net/manual/en/book.pdo.php)**或**[MYSQLI](http://php.net/manual/en/book.mysqli.php)**

使用 PDO 扩展的示例：

```
<?php
$stmt = $dbh->prepare("SELECT * FROM admin_logins  WHERE `Username` = ?");
$stmt->bindParam(1, $username);
if ($stmt->execute(array($_GET['name']))) {
  while ($row = $stmt->fetch()) {
    print_r($row);
  }
}
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T10:05:45.657

肖恩，您必须在变量周围使用点，如下所示：

`$sql = mysql_query("SELECT * FROM admin_logins WHERE Username = '". mysql_real_escape_string($username)."' ");`

如果你像这样使用你的代码，那么它很容易受到 SQL 注入的攻击。我强烈建议您在将数据插入数据库时​​使用[mysql_real_escape_string](http://www.php.net/manual/en/function.mysql-real-escape-string.php)以防止[SQL 注入](https://stackoverflow.com/questions/11939226/sql-injections-and-adodb-library-general-php-website-security-with-examples/11941396)，作为一种快速解决方案或更好地使用[PDO](http://php.net/manual/en/book.pdo.php)或[MySQLi](http://php.net/manual/en/book.mysqli.php)。

此外，如果您用于`mysql_*`连接到数据库，那么我建议您阅读有关`mysql_*`函数的 PHP 手册章节，他们指出，不建议使用此扩展来编写新代码。相反，他们说，您应该使用[MySQLi](http://www.php.net/manual/en/book.mysqli.php)或[PDO_MySQL](http://www.php.net/manual/en/ref.pdo-mysql.php)扩展。

### 编辑：

我还检查了你的`mysql_connect`，发现了一个奇怪的规律，那就是 - 如果你`"`在`mysql_connect`参数上使用，那么它无法连接，在我的情况下，当我为你测试它时，它发生的只是描述的方式，所以，请试试这个：

`$con = mysql_connect('localhost','username','password');`

尝试替换`"`为[PHP 手册](http://php.net/manual/en/function.mysql-connect.php)`'`示例中显示的那样，我认为它会起作用！

如果它仍然不起作用，只需 print `$row`，`print_r($row);`然后`$sql=mysql_query()`查看`$row`数组或变量上的内容。

# php - 会话变量在 Chrome 中丢失

> ID：12338178
> 
> 赞同：0
> 
> 时间：2012-09-09T10:05:12.750
> 
> 标签：php, google-chrome, session-variables

这是我的 php 文件的内容：

```
<?php   
session_start();
print_r($_SESSION); 
 ?> 
```

为什么在 chrome 中我看到空会话值，而在其他浏览器中我可以正确看到它们？

# java - 使用 j2me 发送数据报

> ID：12338180
> 
> 赞同：2
> 
> 时间：2012-09-09T10:05:21.680
> 
> 标签：java, networking, java-me, datagram

我正在编写一个简单的手机应用程序（使用 j2me），使用数据报协议进行客户端-服务器交互。移动应用程序将一些文本发送到服务器，服务器将该文本打印到标准输出。下面是发送数据报的代码（用手机）：

```
String ip;
String port;
String msg;
//Loading ip, port and msg from the user input, I won't write it here, 'cause it
//does not matter

//Below is a simple code snippet for sending msg to the ip:port address
connection = (DatagramConnection) Connector.open(
        "datagram://" + ip + ":" + port);

Datagram datagram = connection.newDatagram(msg.getBytes(),
            msg.getBytes().length);
connection.send(datagram); 
```

以下是接收数据报的代码（使用 PC）：

```
DatagramSocket s = new DatagramSocket(7777);        
DatagramPacket p = new DatagramPacket(new byte[1024], 1024);

s.receive(p);
System.out.println(new String(p.getData())); 
```

因此，当我使用模拟器启动第一个代码片段（用于发送数据报）时，一切正常：服务器成功接收并打印数据报。但是当发送数据报的程序从手机启动时，数据报并没有到达服务器。

通过模拟器测试程序时，IP地址是我的本地网络IP，而通过真机测试时，IP地址是从[http://www.whatismyip.com/获取](http://www.whatismyip.com/)的。当使用以前的 IP 进行模拟器测试时，数据报也不会到达服务器。端口始终设置为 7777。

那么，我能解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:43:48.580

您的服务器必须具有真实的公共 IP 才能访问它。如果它位于代理/防火墙后面，Java ME 应用程序将无法访问它。

如果可能，请尝试将您的服务器托管在某个虚拟化服务（亚马逊、谷歌等）上。

# uiview - 在 viewDidAppear 中设置 UIView Frame，以解决 iPad 中 Launch 方向模式 Landscape 的框架问题

> ID：12338188
> 
> 赞同：-1
> 
> 时间：2012-09-09T10:06:53.270
> 
> 标签：uiview, frame, uiinterfaceorientation, viewwillappear, viewdidappear

我正在横向模式下启动我的应用程序（iPhone 和 iPand）。

**我发现viewDidAppear**中 iPad 框架的框架发生了变化，而不是**viewWillAppear**中的那个。

* * *

***IOS IPAD 5.1模拟器***

在 viewWillAppear 中，它是 0.000000 20.000000 768.000000 1004.000000。

而在 viewDidAppear 中它是 0.000000 0.000000 748.000000 1024.000000

* * *

***IOS IPAD 6.0 模拟器***[但对 ios 6 ipad 模拟器非常满意]

在 viewWillAppear 中它是 0.000000 0.000000 748.000000 1024.000000

而在 viewDidAppear 中，它与 viewWillAppear 相同。

* * *

那么，我可以**在 viewDidAppear 中为我的子视图设置框架吗？**因为这里是完美的框架。

对于 iphone，两种方法的结果都是相同的 20.000000 0.000000 300.000000 480.000000。

为什么我在***iPad***和***iPhone***中出现不同的行为？

Info.plist 具有横向左和右的“支持的界面方向”，并且“初始界面方向”设置为 LandscapeLeft。

AppLaunch 方法如下：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

         self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];

         self.viewController=[[ViewController alloc] init];

         self.window.rootViewController = self.viewController;
} 
```

ViewController.m 有以下方法

```
 - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
     if(UIInterfaceOrientationIsLandscape(interfaceOrientation)){
         return YES;
     }
     return NO;
} 
```

[请在此链接中找到项目](https://www.dropbox.com/s/5lal7dmuxcm64tr/ScreenSizeIssue.zip)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:11:00.467

> 我可以在 viewDidAppear 中为我的子视图设置框架吗？

您可以在任何地方设置框架。为什么你不能？

# python - 为什么一些很可能了解 PEP8 的开发人员将他们的包名大写？（例如：Django、Sphinx、Fabric、...）

> ID：12338189
> 
> 赞同：3
> 
> 时间：2012-09-09T10:07:30.017
> 
> 标签：python, naming-conventions, capitalization, pep8

[PEP8](http://www.python.org/dev/peps/pep-0008/#package-and-module-names)建议模块和包名称使用全小写的名称。PyPI 上的大多数包似乎都遵循这个规则。然而，有一些明显非常有能力和 PEP8 意识的开发人员的包已经大写了他们的包名。

**例子：**

*   `Sphinx`并`Pygments`通过`Georg Brandl`
*   `Django`通过`Simon Willison`, `Jacob-Kaplan Moss`, ...
*   `Fabric`经过`Jeff Forcier`

为什么这些开发人员将他们的包名大写？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-09T11:08:18.390

在所有示例情况下，您提供的包都遵循 PEP-8 命名约定：

*   Sphinx 的顶层包被称为`sphinx`
*   Pygments 的顶级包被称为`pygments`
*   Django的顶层包被调用`django`
*   Fabric的顶层包被称为`fabric`

What you see using capitals is the *distribution package*, not the python package in the PEP-8 sense. Naturally, these projects have chosen to capitalize their project names and the distribution package reflects that project name.

Python distribution packages do not need to be named the same as the python package that they contain. This is by design; you can put multiple packages into a distribution, for example, and thus the contents should not dictate the distribution name.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T10:22:09.517

因为整个 PEP8 中最有见地的一段是关于*“[愚蠢的一致性是 Little Minds](http://www.python.org/dev/peps/pep-0008/#a-foolish-consistency-is-the-hobgoblin-of-little-minds)的妖精”*的一段：

```
A style guide is about consistency.
Consistency with this style guide is important.
Consistency within a project is more important. 
Consistency within one module or function is most important. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T10:50:09.663

简短的回答：没人在乎

更长的答案：

*   如果你有一个像 xyz 这样的命名空间包，那么 name 应该是小写的

*   如果你有一个包代表像“Django”这样的“品牌”，那么我也可以将该包命名为“Django”作为元数据的一部分。请记住，包名不能代表包
    内的实际包结构。

# java - 如何从android中的java获取对“root-only”文件夹的root访问权限

> ID：12338192
> 
> 赞同：0
> 
> 时间：2012-09-09T10:07:36.757
> 
> 标签：java, android, permissions, root

我正在尝试（但失败）找出例如文件浏览器应用程序如何访问*仅根*文件夹，例如`/data`.
从我到目前为止所读到的，似乎唯一的方法是生成一个新进程并使用`su`和处理标准输出执行普通终端命令，
但问题是我已经看到了许多应用程序，例如显示`.apk`存储的图标在`/data/app`文件夹中。
你是怎么做到的，因为我不知道程序如何在标准输出中返回它。
在我看来，他们似乎以某种方式可以直接从 java 访问它，而无需使用外部进程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T02:49:19.750

中的APK`/data/app`是全球可读的，因此您实际上不需要 root 访问权限来读取它们，您只需要知道实际的文件名（因为您没有列出文件的权限），这很容易找到。简而言之，除非您前向锁定 APK，否则它是世界可读的，这是设计使然。

如果不启动新进程，就无法以 root 权限运行应用程序，而“root explorer”风格的应用程序正在使用巧妙的技巧来使之成为可能。他们要么将文件复制到临时文件夹以让您编辑它们，然后将它们复制回来，要么将整个管道管道以在内存中解析它，或使用其他类似的方法。

因此，问题通常会变成：您想做什么以及为什么？

# python - 从 App Engine 获取源代码

> ID：12338193
> 
> 赞同：0
> 
> 时间：2012-09-09T10:07:47.663
> 
> 标签：python, google-app-engine, webapp2

是否可以从 Google App Engine 服务器下载我们应用程序代码的副本？

使用`appcfg.py`我们上传文件。想知道是否有类似的东西可以用来从 App Engine 下载源代码？

例如，如果我们在本地丢失源代码，是否可以从运行 python 应用程序的 Google App Engine 服务器获取它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T10:10:38.033

你可以..如果它没有被管理员禁用

你在使用 python、java 还是 go ？

[https://developers.google.com/appengine/docs/python/tools/uploadinganapp?hl=en#Downloading_Source_Code](https://developers.google.com/appengine/docs/python/tools/uploadinganapp?hl=en#Downloading_Source_Code)

也见`./appcfg.sh help download_app`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T10:10:02.853

是的你可以。

1.  创建一个新目录来存储下载的文件。App Engine 运行时要求目录为空，然后才能将文件下载到该目录。
2.  切换到您计算机上安装 App Engine 的目录。它通常位于以下路径下：`C:\Program Files\Google\google_appengine`
3.  执行以下命令下载项目。请记住将 MyAppName 替换为您自己的 App Engine 项目的 ID。 `appcfg.py download_app - A MyAppName -V 1 c:\AppEngine\SourceCode`

它会询问您的 Google 帐户凭据，一旦通过身份验证，所有源代码文件将立即下载到指定目录。

（来自：[http](http://www.labnol.org/software/download-appengine-files/19348/) ://www.labnol.org/software/download-appengine-files/19348/ ）

# protobuf-net - Protobuf-net Protogen 为 int32 生成 DataFormat.TwosComplement

> ID：12338195
> 
> 赞同：1
> 
> 时间：2012-09-09T10:07:52.917
> 
> 标签：protobuf-net, protogen

我正在使用 protobuf-net r580 中包含的 Protogen 来编译以下 .proto 文件：

```
message TestMessage2 {
  required int32 someint = 1; 
} 
```

而且我发现生成的代码使用 TwosComplement 线格式很奇怪：

```
Private _someint As Integer
<Global.ProtoBuf.ProtoMember(1, IsRequired:=True, Name:="someint", DataFormat:=Global.ProtoBuf.DataFormat.TwosComplement)> _
Public Property someint As Integer 
```

而不是更优化的默认 varint 类型。这是预期的行为吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T10:16:09.967

这是与“核心”protobuf 文档相匹配的行为。从[“更多值类型”](https://developers.google.com/protocol-buffers/docs/encoding#types)部分：

> **有符号整数**
> 
> 正如您在上一节中看到的，与线类型 0 关联的所有协议缓冲区类型都被编码为 varint。但是，在编码负数时，带符号的 int 类型（sint32 和 sint64）与“标准”int 类型（int32 和 int64）之间存在重要区别。如果您使用 int32 或 int64 作为负数的类型，则生成的 varint 始终为 10 个字节长——实际上，它被视为一个非常大的无符号整数。如果您使用其中一种有符号类型，则生成的 varint 将使用 ZigZag 编码，这种编码效率更高。

“默认 varint 类型”是用于可能为负值的*低效线路格式。*

根据文档，用于`sint32`使用 ZigZag 编码。

基本上，在我看来，protobuf-net 的行为绝对正确。

# c# - 将winform放在屏幕左下角

> ID：12338199
> 
> 赞同：12
> 
> 时间：2012-09-09T10:08:54.367
> 
> 标签：c#, .net, windows, winforms

我正在尝试在屏幕的左下角（在开始按钮上）放置一个表单就在开始按钮上方：

```
int x = Screen.PrimaryScreen.WorkingArea.Left + this.Width;
int y = Screen.PrimaryScreen.WorkingArea.Bottom - this.Height;
this.Location = new Point(x, y); 
```

下面是一个演示/屏幕，以进一步演示我正在尝试做的事情：

![[演示屏幕](http://i.stack.imgur.com/9mTjj.png)](../Images/87e4bdbfc9967bae0681db9b4db5a47c.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-09T10:25:12.747

使用`Screen.PrimaryScreen.Bounds`属性并设置`this.TopMost = true`. 这有效：

```
int y = Screen.PrimaryScreen.Bounds.Bottom - this.Height;
this.Location = new Point(0, y);
this.TopMost = true; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-09T10:23:28.137

工作区通常不包括任何任务栏、停靠的窗口和停靠的工具栏。使用`Screen.PrimaryScreen.Bounds`可为您提供屏幕的完整高度和宽度。

示例代码如下：

```
public Form1()
        {
            InitializeComponent();
            Rectangle r = Screen.PrimaryScreen.WorkingArea;
            this.StartPosition = FormStartPosition.Manual;
            this.Location = new Point(0, Screen.PrimaryScreen.Bounds.Height - this.Height);
            this.TopMost = true;
        } 
```

这很可能会显示在任务栏下方，因为通常任务栏默认设置在顶部。我记得有一个选项可以在 Windows XP 中关闭该选项，但不确定。

编辑：

在 windows XP 中，您可以使任务栏位于 windows 后面。点击链接：[始终在顶部任务栏](http://www.homeandlearn.co.uk/bc/bcs4p9.html)

正如 Ria 所指出的，将其设置`this.TopMost`为 true 是一个更好的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T10:19:40.860

您可以尝试使用此代码

```
Rectangle workingArea = Screen.GetWorkingArea(this);
this.Location = new Point(0, 
                          workingArea.Bottom - Size.Height); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T11:20:40.500

[Ria 的答案](https://stackoverflow.com/a/12338287/359170)是正确的，但它没有添加任务栏高度。
如果您想要显示图像中的确切内容，则应使用以下代码：

```
int nTaskBarHeight = Screen.PrimaryScreen.Bounds.Bottom - 
                                            Screen.PrimaryScreen.WorkingArea.Bottom;
Rectangle workingArea = Screen.GetWorkingArea(this);
this.Location = new Point(0, workingArea.Bottom - Size.Height + nTaskBarHeight);
this.TopMost = true; 
```

# java - 在 Java NIO 中，选择器对客户端 SocketChannel 有用吗？

> ID：12338204
> 
> 赞同：9
> 
> 时间：2012-09-09T10:09:42.480
> 
> 标签：java, css-selectors, nio

在 Java NIO 中，很容易理解为什么一个 ServerSocketChannel 必须有一个选择器。选择器可以从准备好进行 I/O 操作的多个客户端通道中进行检查。

但是，在我在网上阅读的一些评论中，选择器机制应用于客户端 SocketChannel。我不明白为什么选择器对客户有用。谁能解释为什么在只有一台服务器的通常情况下使用它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-09T23:04:15.923

除非您连接到数百台服务器，否则很难在客户端中看到非阻塞 NIO 的意义。但是如果你使用的是非阻塞 NIO，你肯定必须使用 a `Selector`，否则你不知道什么时候读取通道，或者在不完整的写入后它何时再次变为可写。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-09T10:21:39.437

选择器允许您使用单个线程跨多个通道提供并发通信服务。当您必须同时与多个服务器进行通信时，或者当您以客户端角色与对等计算机进行通信时（例如读取种子文件时），它在客户端上可能很有用。

# java - 如何允许用户从 JTextArea 复制、剪切和粘贴选定的单词？

> ID：12338206
> 
> 赞同：4
> 
> 时间：2012-09-09T10:10:03.150
> 
> 标签：java, swing, user-interface, copy-paste, jtextarea

假设我创建了一个 GUI，其主面板为 JTextArea 和上方的菜单栏（其中包含复制和粘贴按钮，由 ctrl+c 和 ctrl+v 快捷键）。

可能在一些工作之后，程序会在 JTextArea 上吐出一堆数据，然后我想让用户从 JTextArea 复制、剪切或粘贴选定的（突出显示的）单词到记事本等其他地方。

那么我应该使用什么样的监听器来感知选择，将选择的单词取出并将它们放入操作系统存储复制内容的位置？请具体一点，非常感谢您的帮助！:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-09T10:23:06.793

默认情况下，用于剪切、复制和粘贴的操作系统快捷方式在`JTextArea`.

但是，如果您想为这些操作添加自定义操作（行上下文菜单或顶部菜单项或工具栏按钮），您可以调用哪些`JTextArea extends JTextComponent`方法。`cut()``copy()``paste()`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-09T12:32:42.913

添加到 Dan 的回复中，`JTextArea`确实提供了`cut()`,`copy()`和`paste()`方法来为您处理实际的操作系统特定操作。

[roseindia.net 有一些代码供参考](http://roseindia.net/java/example/java/swing/copy-data-from-ms.shtml)。

还有其他复制方法，这些方法记录在类似的堆栈溢出线程中，例如[这个](https://stackoverflow.com/questions/9123358/what-is-the-best-way-to-cut-copy-and-paste-in-java):)

# css - CSS：如何只有 100% 具有流畅的布局和边框？

> ID：12338216
> 
> 赞同：4
> 
> 时间：2012-09-09T10:11:34.803
> 
> 标签：css, layout

我正在尝试了解 CSS 布局的基础知识，并且在添加边框时遇到了页面太高的问题。

这是我的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="stylesheet" type="text/css" href="KKF_00005.css">
<title>KKF 5: Border coping</title>
</head>
<body>
    <div class="links_aussen">
        <div class="innen">Rechts</div>
    </div>
    <div class="mitte_aussen">
        <div class="innen">Mitte</div>
    </div>
    <div class="rechts_aussen">
        <div class="innen">Links</div>
    </div>
</body>
</html> 
```

我使用以下样式表：

```
@CHARSET "ISO-8859-1";

* {
    height: 100%;
    margin: 0;
    padding: 0;
}

html,body {
    background-color: grey;
    width: 100%;
}

.innen {
    border: 1px solid black;
}

.links_aussen {
    float: left;
    background-color: green;
    width: 33%;
    height: 100%;
}

.mitte_aussen {
    float: left;
    background-color: yellow;
    height: 100%;
    width: 34%;
}

.rechts_aussen {
    float: left;
    background-color: red;
    height: 100%;
    width: 33%;
} 
```

这是[jsFiddle](http://jsfiddle.net/tt13/997zC/)

我的问题是这段代码给了我一个很好的 100% 水平布局，但创建了一个垂直高的滚动条。我希望没有滚动条，但也希望看到边框（所以溢出：隐藏；我认为这对我没有帮助）-在 Chrome 和 Firefox 中进行了测试。

那么：我怎样才能告诉我的小浏览器它应该从高度中删除 2 个像素，以便我可以有边框并且没有滚动条？

在此先感谢您的任何想法和答案安德烈

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T10:18:04.707

这是您使用的解决方案`box-sizing: border-box`。它还消除了对`.inner`div 的需求。

[http://jsfiddle.net/mqchen/xHFvG/](http://jsfiddle.net/mqchen/xHFvG/)

编辑：如果有人想知道为什么会这样，请看 Joakim Johansson 的帖子。现在，回到这篇文章。该`box-sizing`属性只是重新定义浏览器如何计算元素的大小。更多信息在这里：[https ://developer.mozilla.org/en-US/docs/CSS/box-sizing](https://developer.mozilla.org/en-US/docs/CSS/box-sizing)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T10:22:32.293

这是因为默认的盒子模型是 content-box，它的工作原理是这样的：

![来自 w3schools](../Images/d6f642964d911c7fca36633d44d48290.png)

您设置的高度会更改“内容”部分。因此，如果您将高度设置为 100%，边框设置为 1%，则加起来为 101%。

根据您要执行的操作，可以通过不同的方式解决此问题。

例如，您可以设置 box-sizing 属性：[http](http://www.quirksmode.org/css/box.html) ://www.quirksmode.org/css/box.html以使 height 属性以不同的方式工作。

我现在无法找到一个好的解决方案（因为依赖 box-sizing 不是那么兼容），但这是一个糟糕的解决方案，使用绝对定位：http: [//jsfiddle.net/XhfmR/](http://jsfiddle.net/XhfmR/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T10:17:34.130

你的问题是边界：

代替

```
.innen {
    border: 1px solid black;
} 
```

[http://jsfiddle.net/tt13/997zC/](http://jsfiddle.net/tt13/997zC/)

采用

```
 .innen {
    border-left: 1px solid black;
    border-right: 1px solid black; 
 } 
```

[http://jsfiddle.net/tt13/997zC/1/](http://jsfiddle.net/tt13/997zC/1/)

当你只写`border`它时，它会为 div 的所有边添加边框。在你的情况下，底部和顶部边框需要额外的 1px，你得到的结果是高 2px。这就是你看到滚动条的原因。

并且总是使用[jsfiddle](http://jsfiddle.net/)来解决这类问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T10:19:22.760

```
.innen {
    border: 1px solid black;
} 
```

是你的问题。它创建垂直滚动条。要解决此问题，请使用以下代码：

```
.innen {
    border-left: 1px solid black;
    border-right: 1px solid black;
} 
```

[http://jsfiddle.net/yrLtz/](http://jsfiddle.net/yrLtz/)

编辑：也许最好的解决方案是`box-sizing: border-box`@mqchen 建议的。

# android - 如何绘制具有低位图内存影响的平铺游戏板

> ID：12338219
> 
> 赞同：3
> 
> 时间：2012-09-09T10:12:06.970
> 
> 标签：android, performance

我正在开发一款类似于最著名的文字游戏。棋盘有 15 x 15 块。瓷砖有 5 种可能的颜色。

棋盘可以放大。也就是说，您可以看到棋盘的全视图，也可以放大 2 倍。

我已经在我的活动中实现了两种绘制板的方法。两者都在我的 Galaxy S 和各种模拟器上测试过。两者似乎都可以在绝大多数设备上正常工作。**但是**，它们都会给少数用户带来问题（这是我在这里试图解决的问题）。

以下是对 2 种设计的描述：

## 选项 1：“大图”

**描述：** 这是最简单的一种。该板是一个独特的`ImageView`（子类以处理双击缩放和拖动）。图片PNG资源是高分辨率的：大约。最大屏幕尺寸的两倍，以避免放大时放大。

**问题：** 有时在大屏幕上似乎会出现 OutOfMemory 问题，尤其是在 10" Asus TF101 平板电脑上。

**评论：** TF101 的测试表明 RAM 使用率是 Galaxy S 的 3 倍。考虑到必须绘制的巨大比例位图，这似乎是合乎逻辑的。

## 选项 2：重复 5 个小图像

**描述：** 我试图减少位图使用的 RAM，并利用板只是 5 种小方块的重复这一事实。为了方便调整板视图的大小，我选择将其设为自定义 LinearLayout，其中包含 15 个嵌套的 LinearLayout，每个包含 15 个图像（这当然不是性能方面的最佳选择）。

这是我的 XML 布局对于 4 x 4 板的样子：

```
 <MyCustomLinearLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:orientation="vertical" >
            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="0dp"
                android:layout_weight="1"
                android:orientation="horizontal" >
                <ImageView
                    android:layout_width="0dp"
                    android:layout_height="fill_parent"
                    android:layout_weight="1" >
                </ImageView>

                <ImageView
                    android:layout_width="0dp"
                    android:layout_height="fill_parent"
                    android:layout_weight="1" >
                </ImageView>
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="0dp"
                android:layout_weight="1"
                android:orientation="horizontal" >
                <ImageView
                    android:layout_width="0dp"
                    android:layout_height="fill_parent"
                    android:layout_weight="1" >
                </ImageView>

                <ImageView
                    android:layout_width="0dp"
                    android:layout_height="fill_parent"
                    android:layout_weight="1" >
                </ImageView>
            </LinearLayout>
        </MyCustomLinearLayout> 
```

**问题：** 某些用户的一些崩溃或视觉故障。（我仍然没有太多关于这个的信息）

**评论：** *优点：*选项之一是优化了内存占用： 5 个小位图中的每一个只有一个实例保存在内存中。调整板的大小很简单：当我调整 MyCustomLinearLayout 的大小时，Android 会调整位图和嵌套的 LinearLayouts 的大小。

*缺点：*视图太多，系统必须在每次缩放时重新计算哪些尺寸。

**如何改进选项 2 以保持较低的 RAM 占用，同时尊重其他性能良好实践（例如没有数百个视图）？**

* * *

## 编辑：最终（？）实施

而不是一个`SurfaceView`，我去一个简单的自定义`View`。

怕在方法中做大量的位图绘制`onDraw()`会导致板子的拖拽滞后（因为`onDraw()`板子移动的时候不断调用）。

事实证明它非常平滑（甚至可能比选项 2 更平滑）。至于 RAM 使用率，它只是比选项 2 重一点（使用 Eclipse Memory Analyzer 进行的比较），因此令人满意。我仍然有一些关于 OutOfMemory 错误的报告（“位图超出最大 VM 堆大小”），但我认为使用位图是不可避免的。

这是最重要的代码，我在其中绘制 15x15 位图（从视图构造函数中的资源初始化）来构建游戏板：

```
public void drawTileAtCoordsOnCanvas(Bitmap bm, Canvas canvas, int x, int y) {
    _rect.set(x * _sizeOfTile, y * _sizeOfTile, (x + 1) * _sizeOfTile, (y + 1) * _sizeOfTile);
    canvas.drawBitmap(bm, null, _rect, _paint);
}

public void onDraw(Canvas canvas) {
    for (int i = 0; i < _rules.BOARD_SIZE; i++) {
        for (int j = 0; j < _rules.BOARD_SIZE; j++) {
            switch (_rules._boardOfMultiplicators.get(i).get(j)) {
            case NL:
                drawTileAtCoordsOnCanvas(_bitmapNormalTile, canvas, i, j);
                break;
            case DL:
                drawTileAtCoordsOnCanvas(_bitmapDlTile, canvas, i, j);
                break;
            case TL:
                drawTileAtCoordsOnCanvas(_bitmapTlTile, canvas, i, j);
                break;
            case DW:
                drawTileAtCoordsOnCanvas(_bitmapDwTile, canvas, i, j);
                break;
            case TW:
                drawTileAtCoordsOnCanvas(_bitmapTwTile, canvas, i, j);
                break;
            }
        }
    }
    drawTileAtCoordsOnCanvas(_bitmapStarTile, canvas, 7, 7);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T10:45:56.973

您的第二个选项是最好的（重复 5 个图像），但不是使用 ImageViews，而是直接在自定义视图上绘制会更有效。性能会好很多。

A[`SurfaceView`](http://developer.android.com/reference/android/view/SurfaceView.html)可能是最好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T10:34:38.443

我根本没有 Android 开发经验，所以对此持保留态度，但仅基于查看相关问题和一些谷歌搜索，在我看来，a[`GridView`](http://developer.android.com/guide/topics/ui/layout/gridview.html)可能是你想要的。

# oauth - 如何在 MVC 4 中实现自定义 OpenID 依赖方

> ID：12338224
> 
> 赞同：3
> 
> 时间：2012-09-09T10:13:49.217
> 
> 标签：oauth, openid, asp.net-mvc-4, dotnetopenauth

我喜欢新的 MVC OpenID/OAuth 登录功能，但我想知道如何添加新的登录按钮，例如我希望我的用户使用他们的 StackExchange 帐户或使用他们的 OpenID url 登录，就像在 stackoverflow [http:// puu.sh/13rm0](http://puu.sh/13rm0)

怎么做？是否有任何示例在步骤中显示了这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T00:51:28.283

不幸的是，Microsoft 公开的 API 仅限于硬编码到特定 URL 的登录提供程序，而不是在登录用户之前可以接受用户输入的登录提供程序，而 OpenID 需要这样做。

`DotNetOpenAuth.AspNet.IAuthenticationClient`您可以通过创建一个实现并硬编码以使用 StackExchange的类来添加对特定 OpenID 提供程序（例如 StackExchange）的支持。[微软自己的 Yahoo! 提供商](https://github.com/AArnott/dotnetopenid/blob/master/src/DotNetOpenAuth.AspNet/Clients/OpenID/YahooOpenIdClient.cs)的源代码就是一个很好的例子。. 看看它，看看它有多简单，然后创建你自己的，简单地硬编码，`https://openid.stackexchange.com/`而不是`https://me.yahoo.com/`你有 StackExchange 登录支持。

# iphone - 使滚动视图始终可见？

> ID：12338225
> 
> 赞同：-2
> 
> 时间：2012-09-09T10:13:54.243
> 
> 标签：iphone, objective-c, ios, ios4

如何在我的 iPhone 应用程序中制作始终可见、从不隐藏视图的滚动视图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T05:55:28.897

我从您的问题中了解到，您的滚动视图隐藏在其他视图后面。你可以使用 [self.view bringSubviewToFront:myScrollView]; 每当您在滚动视图上添加新视图时。

如果每次添加另一个视图时都难以调用bringSubviewToFront: 方法，您可以在appDelegate.Window 上添加您的scrollView。我为我的自定义微调器做了这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T17:03:18.513

简单的，

```
[self.view addSubview:myScrollView]; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-09T17:22:11.413

添加 后`UIScrollView`，将属性设置`hidden`为`NO`，以便滚动视图永远不会隐藏。

```
[myScrollView setHidden:NO]; 
```

# c++ - shared_ptr 和循环引用

> ID：12338226
> 
> 赞同：9
> 
> 时间：2012-09-09T10:14:18.763
> 
> 标签：c++, shared-ptr, weak-ptr, cyclic-reference

我正在尝试使用 的循环引用`boost::shared_ptr`，并设计了以下示例：

```
class A{ // Trivial class
public:
    i32 i;
    A(){}
    A(i32 a):i(a){}
    ~A(){
        cout<<"~A : "<<i<<endl;
    }
};

shared_ptr<A> changeI(shared_ptr<A> s){
    s->i++;
    cout<<s.use_count()<<'\n';

    return s;
}

int main() {

    shared_ptr<A> p1 = make_shared<A>(3);
    shared_ptr<A> p2 = p1;
    shared_ptr<A> p3 = p2;
    shared_ptr<A> p4 = p3;

    p1 = p4; // 1) 1st cyclic ref.
    cout<<p1.use_count()<<'\n';

    p1 = changeI(p4); // 2) 2nd cyclic ref.

    cout<<p1.use_count()<<'\n';

//  putchar('\n');
    cout<<endl;
} 
```

哪个输出

```
4
5
4

~A : 4 
```

是不是我误解了提到的循环引用`boost::shared_ptr`？因为，我期望间接引用`p1`后评论`1)`和`2)`. 所以这段代码不需要`boost::weak_ptr`！那么`weak_ptr`需要 s 的循环引用是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-09T12:01:24.867

是的，你误解了这一点。在您的示例中，所有指针都指向同一个对象，而不是形成任何循环。

p4 到 p2 的分配是无操作的，因为这些指针在开始时就已经相等了。

这是一个带有真实循环引用的示例，也许可以解决问题：

```
struct A
{
  std::shared_ptr<A> ptr;
};

void main()
{
  std::shared_ptr<A> x=std::make_shared<A>();
  std::shared_ptr<A> y=std::make_shared<A>();

  x->ptr = y; // not quite a cycle yet
  y->ptr = x; // now we got a cycle x keeps y alive and y keeps x alive
} 
```

你甚至可以让这更简单：

```
void main()
{
  std::shared_ptr<A> x=std::make_shared<A>();

  x->ptr = x; // never die! x keeps itself alive
} 
```

在这两个示例中，shared_ptrs 中的对象永远不会被破坏，即使在您离开 main 之后也是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-10-26T19:12:10.813

只是想指出：输出的第二行之所以是a`5`而不是a `4`，不是因为`s->i++`增加了，而是因为`shared_ptr<A> s`参数是传值的。

调用时

```
p1 = changeI(p4); // 2) 2nd cyclic ref. 
```

`p4`将被复制到另一个，在函数范围内`shared_pointer`临时增加一个。`use_count`

也许我在这里扮演队长的角色很明显（;

# string - 使用带有 std::string 的预构建库中的类时，NDK 崩溃

> ID：12338227
> 
> 赞同：1
> 
> 时间：2012-09-09T10:14:30.250
> 
> 标签：string, android-ndk, shared-libraries, prebuild

我有两个共享库：lib1 和 lib2。lib1 预编译到 lib2。

我在 lib1 中有类：

```
#include <android/log.h>

#include "stdlib.h"
#include <string>

class Foo
{
public:
    Foo()
    {
        __android_log_print(ANDROID_LOG_VERBOSE, "Two Libs", "Foo::Foo()"); 
    }

    ~Foo();

private:
    std::string str;
}; 
```

.cpp 文件中定义的析构函数。

```
#include "first.h"

Foo::~Foo()
{
    __android_log_print(ANDROID_LOG_VERBOSE, "Two Libs", "Foo::~Foo()");    
} 
```

比我在 lib2 中使用这个类：

```
#include <string.h>
#include <jni.h>
#include <android/log.h>

#include "first.h"

extern "C" 
{

JNIEXPORT void JNICALL Java_com_example_twolibs_TwoLibs_nativeMethod( JNIEnv* env )
{
    __android_log_print(ANDROID_LOG_VERBOSE, "Two Libs", "Test std::string bug 1");

    Foo* newFoo = new Foo();

    __android_log_print(ANDROID_LOG_VERBOSE, "Two Libs", "Test std::string bug 2");

    delete newFoo;

    __android_log_print(ANDROID_LOG_VERBOSE, "Two Libs", "Test std::string bug 3"); 

    return;
}

} 
```

日志：

```
09-09 12:48:14.089: V/Two Libs(13512): Test std::string bug 1
09-09 12:48:14.089: V/Two Libs(13512): Foo::Foo()
09-09 12:48:14.089: V/Two Libs(13512): Test std::string bug 2
09-09 12:48:14.089: V/Two Libs(13512): Foo::~Foo() 
```

如果我删除 std::string - 不会发生崩溃。所以问题看起来像 std::string 析构函数。

如果我在 lib2 中定义类或仅在 lib1 中使用它 - 不会发生崩溃

如果我只在标题中定义析构函数 - 不会发生崩溃

我使用 ndk-r8b。水晶 r7 上的同样问题。通过 CygWin 在 Windows 上构建。

崩溃日志：

```
09-09 12:48:14.199: I/DEBUG(10548): Build fingerprint: 'samsung/GT-S5660/GT-S5660:2.3.3/GINGERBREAD/XXKPK:user/release-keys'
09-09 12:48:14.199: I/DEBUG(10548): pid: 13512, tid: 13512  >>> com.example.twolibs <<<
09-09 12:48:14.199: I/DEBUG(10548): signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr deadbaad
09-09 12:48:14.209: I/DEBUG(10548):  r0 deadbaad  r1 0000000c  r2 00000027  r3 00000000
09-09 12:48:14.209: I/DEBUG(10548):  r4 00000080  r5 afd46688  r6 0000a000  r7 4428fce8
09-09 12:48:14.209: I/DEBUG(10548):  r8 beb75470  r9 4428fce0  10 4428fcc8  fp 44ff5970
09-09 12:48:14.209: I/DEBUG(10548):  ip ffffffff  sp beb753e0  lr afd19385  pc afd15f00  cpsr 00000030
09-09 12:48:14.209: I/DEBUG(10548):  d0  3f8000003f800000  d1  3ff0000040000000
09-09 12:48:14.209: I/DEBUG(10548):  d2  bfd3441350baf6de  d3  c1493000c1323800
09-09 12:48:14.209: I/DEBUG(10548):  d4  4900000040dcb000  d5  000000000006e580
09-09 12:48:14.209: I/DEBUG(10548):  d6  4515a00000000800  d7  40800000c48ee000
09-09 12:48:14.219: I/DEBUG(10548):  d8  0000000000000000  d9  0000000000000000
09-09 12:48:14.219: I/DEBUG(10548):  d10 0000000000000000  d11 0000000000000000
09-09 12:48:14.219: I/DEBUG(10548):  d12 0000000000000000  d13 0000000000000000
09-09 12:48:14.219: I/DEBUG(10548):  d14 0000000000000000  d15 0000000000000000
09-09 12:48:14.219: I/DEBUG(10548):  scr 60000012
09-09 12:48:14.279: I/DEBUG(10548):          #00  pc 00015f00  /system/lib/libc.so
09-09 12:48:14.279: I/DEBUG(10548):          #01  pc 00013862  /system/lib/libc.so
09-09 12:48:14.279: I/DEBUG(10548): code around pc:
09-09 12:48:14.279: I/DEBUG(10548): afd15ee0 68241c23 d1fb2c00 68dae027 d0042a00 
09-09 12:48:14.279: I/DEBUG(10548): afd15ef0 20014d18 6028447d 48174790 24802227 
09-09 12:48:14.279: I/DEBUG(10548): afd15f00 f7f57002 2106eb56 ec92f7f6 0563aa01 
09-09 12:48:14.279: I/DEBUG(10548): afd15f10 60932100 91016051 1c112006 e818f7f6 
09-09 12:48:14.279: I/DEBUG(10548): afd15f20 2200a905 f7f62002 f7f5e824 2106eb42 
09-09 12:48:14.279: I/DEBUG(10548): code around lr:
09-09 12:48:14.279: I/DEBUG(10548): afd19364 b0834a0d 589c447b 26009001 686768a5 
09-09 12:48:14.279: I/DEBUG(10548): afd19374 220ce008 2b005eab 1c28d003 47889901 
09-09 12:48:14.279: I/DEBUG(10548): afd19384 35544306 d5f43f01 2c006824 b003d1ee 
09-09 12:48:14.279: I/DEBUG(10548): afd19394 bdf01c30 000281b8 ffffff88 1c0fb5f0 
09-09 12:48:14.279: I/DEBUG(10548): afd193a4 43551c3d a904b087 1c16ac01 604d9004 
09-09 12:48:14.279: I/DEBUG(10548): stack:
09-09 12:48:14.279: I/DEBUG(10548):     beb753a0  00000015  
09-09 12:48:14.279: I/DEBUG(10548):     beb753a4  afd18417  /system/lib/libc.so
09-09 12:48:14.279: I/DEBUG(10548):     beb753a8  afd4272c  
09-09 12:48:14.279: I/DEBUG(10548):     beb753ac  afd426d8  
09-09 12:48:14.279: I/DEBUG(10548):     beb753b0  00000000  
09-09 12:48:14.279: I/DEBUG(10548):     beb753b4  afd19385  /system/lib/libc.so
09-09 12:48:14.279: I/DEBUG(10548):     beb753b8  802182c0  /system/lib/libdvm.so
09-09 12:48:14.279: I/DEBUG(10548):     beb753bc  afd183e9  /system/lib/libc.so
09-09 12:48:14.279: I/DEBUG(10548):     beb753c0  4428fc50  
09-09 12:48:14.279: I/DEBUG(10548):     beb753c4  00000000  
09-09 12:48:14.279: I/DEBUG(10548):     beb753c8  afd46688  
09-09 12:48:14.279: I/DEBUG(10548):     beb753cc  0000a000  
09-09 12:48:14.279: I/DEBUG(10548):     beb753d0  4428fce8  
09-09 12:48:14.279: I/DEBUG(10548):     beb753d4  afd18687  /system/lib/libc.so
09-09 12:48:14.279: I/DEBUG(10548):     beb753d8  df002777  
09-09 12:48:14.279: I/DEBUG(10548):     beb753dc  e3a070ad  
09-09 12:48:14.279: I/DEBUG(10548): #00 beb753e0  ffffffff  
09-09 12:48:14.279: I/DEBUG(10548):     beb753e4  7fffffd2  
09-09 12:48:14.279: I/DEBUG(10548):     beb753e8  afd46628  
09-09 12:48:14.279: I/DEBUG(10548):     beb753ec  afd11020  /system/lib/libc.so
09-09 12:48:14.279: I/DEBUG(10548):     beb753f0  80d1cf00  
09-09 12:48:14.279: I/DEBUG(10548):     beb753f4  fffffbdf  
09-09 12:48:14.279: I/DEBUG(10548):     beb753f8  000000da  
09-09 12:48:14.279: I/DEBUG(10548):     beb753fc  afd46470  
09-09 12:48:14.279: I/DEBUG(10548):     beb75400  000001b4  
09-09 12:48:14.279: I/DEBUG(10548):     beb75404  afd13867  /system/lib/libc.so
09-09 12:48:14.279: I/DEBUG(10548): #01 beb75408  afd46470  
09-09 12:48:14.279: I/DEBUG(10548):     beb7540c  afd13867  /system/lib/libc.so
09-09 12:48:14.279: I/DEBUG(10548):     beb75410  802182c0  /system/lib/libdvm.so
09-09 12:48:14.279: I/DEBUG(10548):     beb75414  0000cec8  
09-09 12:48:14.279: I/DEBUG(10548):     beb75418  00000000  
09-09 12:48:14.279: I/DEBUG(10548):     beb7541c  903884f9  
09-09 12:48:14.279: I/DEBUG(10548):     beb75420  000000da  
09-09 12:48:14.279: I/DEBUG(10548):     beb75424  80c1ce44  
09-09 12:48:14.289: I/DEBUG(10548):     beb75428  000f1200  
09-09 12:48:14.289: I/DEBUG(10548):     beb7542c  80d1cf00  
09-09 12:48:14.289: I/DEBUG(10548):     beb75430  4428fce8  
09-09 12:48:14.289: I/DEBUG(10548):     beb75434  afd14779  /system/lib/libc.so
09-09 12:48:14.289: I/DEBUG(10548):     beb75438  80c1ce44  
09-09 12:48:14.289: I/DEBUG(10548):     beb7543c  80c08097  /mnt/asec/com.example.twolibs-1/lib/libfirst.so
09-09 12:48:14.289: I/DEBUG(10548):     beb75440  00000000  
09-09 12:48:14.289: I/DEBUG(10548):     beb75444  460247e3  
09-09 12:48:14.289: I/DEBUG(10548):     beb75448  000f1200  
09-09 12:48:14.289: I/DEBUG(10548):     beb7544c  00000000 
```

如果它在这个论坛上被分配，我可以附上示例项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:24:59.643

我在 cygwin 上使用 NDK-r8b 进行了尝试，效果很好，外观上的变化很小。`APP_STL=gnustl_static`它可以在带有or`gnustl_shared`或`stlport_static`or的 Andorid 2.2 上正常工作`stlport_shared`。请注意，您需要插入`System.loadLibrary("gnustl_shared")`或`System.loadLibrary("stlport_shared")`放入`TwoLibs.java`文件中。

# android - 如何去掉通知栏中的短信图标

> ID：12338229
> 
> 赞同：1
> 
> 时间：2012-09-09T10:14:45.067
> 
> 标签：android, notifications, sms

我正在使用 SMSReceiver，当消息到达时，将显示一个对话框来显示 SMS 的地址、消息和时间。当用户单击自定义对话框中的确定按钮时，我想删除通知图标。请让我知道我该怎么做。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:35:21.450

无法直接删除通知。这是因为通知是由不同的应用程序（系统消息应用程序或自定义 SMS 应用程序）生成的。只有生成通知的应用程序才能删除它们。

但是，您可以尝试做一些事情。

您可以为传入的 SMS 使用系统广播，而不是进一步传播它，这意味着负责处理 SMS 消息的其他应用程序不会被告知正在传递的新消息。

为此，您应该：

**增加接收器的优先级：**

```
 <receiver android:name=".SmsReceiver">
         <intent-filter android:priority="1000">
             <action android:name="android.provider.Telephony.SMS_RECEIVED" />
         </intent-filter>
     </receiver> 
```

**`onReceive()`在您的实现中中止广播：**

```
 public void onReceive(Context context, Intent intent) {
     if (intent.getAction().equals(SMS_RECEIVED)) {
         // Do whatever with the message
         abortBroadcast(); // Stop the broadcast from being propagated further
     }
 } 
```

# java - 泛型类型擦除 ClassCastException

> ID：12338232
> 
> 赞同：2
> 
> 时间：2012-09-09T10:15:23.700
> 
> 标签：java, generics

```
package practice;

class Node<T> {

    T data;

    public Node(T data) { this.data = data; }

    public void setData(T data) {
        System.out.println("Node.setData");
        this.data = data;
    }
}

class MyNode extends Node<Integer> {
    public MyNode(Integer data) { super(data); }

    @Override
    public void setData(Integer data) {
        System.out.println("MyNode.setData");
        super.setData(data);
    }
}

public class Practice {
    public static void main(String[] s)
    {
        MyNode mn = new MyNode(5);
        Node n = mn;            // A raw type - compiler throws an unchecked warning
        n.setData("Hello");     // Causes a ClassCastException to be thrown.
        Integer x = mn.data;    
    }
} 
```

为什么这段代码在`n.setData("Hello");`实际应该抛出异常的时候抛出异常`Integer x = mn.data;`？

[http://docs.oracle.com/javase/tutorial/java/generics/bridgeMethods.html](http://docs.oracle.com/javase/tutorial/java/generics/bridgeMethods.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T10:22:04.413

因为您正在尝试将 String 值设置为 Integer 变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T10:22:27.317

您已经通过调用定义`T`了类型`Node`

```
MyNode mn = new MyNode(5); 
```

即`Integer`类型。通过调用`n.setData("Hello");`，您正在尝试为 Integer 字段传入 String 变量。Node`n`只是`Integer`类型化 Node的一个引用`mn`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T10:59:32.987

我认为教程中有一个小错误：他们应该说错误是在行抛出的`n.setData("Hello");`

那是因为当你调用时，`n.setData("Hello");`你调用了 bridge 方法：`n.setData(Object object)` **在`MyNode`**类上，否则你会遇到编译时错误。

但是桥接方法看起来像这样：

```
// Bridge method generated by the compiler
//
public void setData(Object data) {
    setData((Integer) data);
} 
```

您会看到桥试图`setData(Integer anInt)`调用`data`. 而这个演员失败是因为你提供了一个`String`.

在这个示例中还有一点有趣的是，`@Override`即使您在技术上没有覆盖，但编译器稍后会覆盖，使用注释时也不会出现编译时错误。注释在这里非常有用，用于通知`setData(Object object)`将被调用 on`MyNode`而不是 on `Node`。这解释了为什么您看不到任何`System.out`消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T10:23:43.540

因为它的类型`n`实际上是`Integer`从它接收到的`mn`。

原理是一样的`List list = new ArrayList();`

这里的列表实际上是一个`ArrayList`，但仅使用 List 接口引用。同样，即使`n`是 a `Node`，它的实现也是 a`MyNode`只接受`Integer`。`String`这就是为什么你可以放入`setData()`

**阅读编辑示例后**

该页面说创建了一个桥接方法，如下所示：

```
class MyNode extends Node {

    // Bridge method generated by the compiler
    //
    public void setData(Object data) {
        setData((Integer) data);
    }

    public void setData(Integer data) {
        System.out.println("MyNode.setData");
        super.setData(data);
    }

    // ...
} 
```

桥接方法执行以下操作

```
public void setData(Object data) {
            setData((Integer) data);
        } 
```

在这里，它试图将作为`String`“Hello”的数据转换为`Integer`. 因此抛出错误。

# linux - 单击选项卡时出现shell init问题，getcwd有什么问题？

> ID：12338233
> 
> 赞同：159
> 
> 时间：2012-09-09T10:15:32.490
> 
> 标签：linux, bash, shell, pwd, getcwd

一旦我在 bash 上单击 Tab，就会出现错误消息，这是怎么回事？

```
symlink-hook: error retrieving current directory: getcwd: cannot access parent directories: No such file or directory
symlink-hook: error retrieving current directory: getcwd: cannot access parent directories: Success
symlink-hook: error retrieving current directory: getcwd: cannot access parent directories: Success
symlink-hook: error retrieving current directory: getcwd: cannot access parent directories: Success
symlink-hook: error retrieving current directory: getcwd: cannot access parent directories: No such file or directory
symlink-hook: error retrieving current directory: getcwd: cannot access parent directories: Success
symlink-hook: error retrieving current directory: getcwd: cannot access parent directories: Success
symlink-hook: error retrieving current directory: getcwd: cannot access parent directories: Success 
```

有时，错误消息是：

```
shell-init: error retrieving current directory: getcwd: cannot access parent directories: No s uch file or directory 
```

如何解决shell初始化问题？

* * *

## 回答 #1

> 赞同：300
> 
> 时间：2012-09-09T10:28:16.180

这通常发生在您的当前目录不再存在时。最有可能的是，您从另一个终端删除该目录（从脚本或其他内容中）。为了摆脱这种情况，如果您的当前目录在此期间被重新创建，只需`cd`到另一个（现有）目录，然后再`cd`返回；最简单的是：`cd; cd -`.

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2014-06-25T18:43:36.003

只需将目录更改为另一个目录并返回即可。可能那个已经被删除或移动了。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-09-02T20:53:30.633

碰巧，这是否发生在使用 OverlayFS（或其他一些特殊文件系统类型）的目录上？

我刚刚遇到了这个问题，我的 bash 的交叉编译版本将使用一个内部实现，`getcwd`该实现与 OverlayFS 存在问题。我在这里找到了有关此的信息：

> 这似乎可以追溯到 bash 中 getcwd() 的内部实现。交叉编译时，无法检查getcwd()对malloc的使用，所以谨慎设置GETCWD_BROKEN并使用getcwd()的内部实现。这个内部实现似乎不适用于 OverlayFS。
> 
> [http://permalink.gmane.org/gmane.linux.embedded.yocto.general/25204](http://permalink.gmane.org/gmane.linux.embedded.yocto.general/25204)

您可以使用配置和重建 bash `bash_cv_getcwd_malloc=yes`（如果您实际上正在构建 bash 并且您的 C 库确实 malloc 一个 getcwd 调用）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-09-28T23:55:48.017

是的，光盘；和 cd - 会工作。它可以看到的原因是，目录正在从任何其他终端或任何其他程序中删除并重新创建它。因此 i-node 条目被修改，因此程序无法访问旧的 i-node 条目。

# html - 缩进的表格边框

> ID：12338237
> 
> 赞同：0
> 
> 时间：2012-09-09T10:16:10.357
> 
> 标签：html, css

我目前正在研究像这样打开一个普通的 html 表：

![原来的](../Images/5d50e601891c6eb6dcee62384d0f541a.png)

缩进版本如下：

![在此处输入图像描述](../Images/2c6dc9fd9a5038d0dc81dd1b4ce528e0.png)

即使我不能在 html 中设置它，也有人可能知道我可以隐藏边框的初始部分以匹配文本开头的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T10:31:22.853

我敢肯定，有几种不好的方法可以做到这一点。你只需要发挥创造力。

这是一个执行此操作的示例，其中包含一些类、空表格单元格和 colspan：http: [//jsfiddle.net/ESFuC/](http://jsfiddle.net/ESFuC/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T10:40:14.150

您可以通过使用表格单元格并利用`display:inline-block;`其他方法来实现这一点，但这应该适用于大多数浏览器。

[摆弄演示](http://jsfiddle.net/27VEb/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T10:56:35.903

也许像这样在单元格内使用div；

[http://jsfiddle.net/UdF98/](http://jsfiddle.net/UdF98/)

我把底线涂成红色，除了底部的那条之外看起来还不错。也许你可以修改以满足你的需要。

# github - 当我已经分叉了一个不同的分叉时，我如何分叉原始存储库

> ID：12338240
> 
> 赞同：75
> 
> 时间：2012-09-09T10:16:27.797
> 
> 标签：github, git-fork

我之前已经分叉了 jockm/vert.x 并向他发送了一个拉取请求。现在我想分叉 vert-x/vert.x（jockm/vert.x 的上游）并向他们发送不同的拉取请求。但是当我单击 Fork 按钮时，不出所料，我最终进入了 jockm/vert.x 的 tjcrowder/vert.x 叉子。是否可以同时分叉 vert-x/vert.x 和 jockm/vert.x 以便我可以适当地发送每个拉取请求？

我担心答案可能与[这个关于相反情况的问题](https://stackoverflow.com/questions/8290678/how-do-you-fork-a-repo-whose-upstream-youve-already-forked)相同（“没有 GitHub 方式，但你可以添加远程仓库”）但我希望不是这样 - 尤其是因为我不明白答案如何那里将允许我向新的遥控器发送拉取请求。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-09T13:18:48.853

没有 GitHub 方式（小谎言，见下文），但也没什么好害怕的。

根据定义，您的 fork 的 fork**是**原始的 fork。打开拉取请求时，您可以选择为拉取请求选择来源和目的地。那里可用的选择显然取决于 fork 图，但只要图中 2 个存储库之间存在路径，您就应该是安全的。此外，由于拉取请求存在于网站端，只要您不想从 git 使用它，您甚至不需要添加远程。

当然，现在您可能想重新考虑您在该图中的位置，并让自己成为真正上游的直接孩子，但这大多是无关的。

如前所述，实际上有一种扭曲的方式来拥有多个分叉，即创建组织并在其中分叉。这样您就可以在同一个图中“拥有”多个存储库。但是真的没必要去那里。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-09-10T09:20:36.020

多亏了[sigma 的回答](https://stackoverflow.com/a/12339396/157247)，我看到当我在 jockm/vert.x 存储库上执行拉取请求时，不仅上游存储库可用，上游存储库的所有其他分支也可用。所以我最终做的是：

1.  删除我的 jockm/vert.x 的 fork，而不是 fork vert-x/vert.x，因为大多数情况下我想在主要的上游 repo 中工作，而不是 jockm 的版本。
2.  为我想要发送到 jockm 的提交创建一个分支，并为我想要发送到 vert-x 的提交创建一个单独的分支。
3.  对每个分支进行相关更改。
4.  将每个分支的拉取请求发送到相关的存储库，因为 jockm/vert.x 存储库被列为请求的可能目标（以及大约 200 个其他分支）。

我使用了单独的分支（基本上是主题分支），以便这些提交将仍然是那些拉取请求中的唯一内容，因为同一分支上的后续提交会自动添加到拉取请求中，并且这些更改需要保持隔离直到/除非合并。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-09T13:28:48.677

似乎更好的选择是在您的 fork 上创建一个分支，并从该分支创建一个拉取请求。您可以使用分支来“分叉”您的版本

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-12-16T19:25:44.857

如果要创建 GitHub 存储库的多个分叉，可以使用[此替代方法](https://handong1587.github.io/linux_study/2015/12/18/create-multi-forks.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-09T10:36:24.537

我没有看到关于“多叉”的任何细节，所以我最终可能会创建另一个 GitHub 帐户，在该帐户下我将进行第二次克隆，并将不同的拉取请求发送到`vert.x/vert.x`.

由于您可以拥有“[同一台计算机上的多个 github 帐户](https://stackoverflow.com/questions/3860112/multiple-github-accounts-on-the-same-computer)”（使用正确的[ssh 配置文件](https://stackoverflow.com/questions/3225862/multiple-github-accounts-ssh-config)，也在[此处描述](https://stackoverflow.com/a/7925764/6309)），这是一种可能的解决方法。

* * *

但是请注意，GitLab 支持[GitLab 14.0](https://about.gitlab.com/releases/2021/06/22/gitlab-14-0-released/#edit-default-path-and-project-name-when-forking)（2021 年 6 月）：

> ## 分叉时编辑默认路径和项目名称
> 
> 分叉时编辑默认路径和项目名称
> 
> 复刻项目使您能够拥有原始存储库的精确副本，您可以在其中进行试验、应用更改以及向父项目提交贡献。
> 你的分叉应该有有意义的名字来解释他们的目标，如果你的项目是不同的，你可能需要一个项目的多个分叉。
> 
> 在这个版本中，GitLab 现在支持在创建分叉时直接编辑项目名称和项目 slug。
> 
> **您现在可以为同一个项目创建多个分支，每个分支都有不同的名称，都在同一个组中！**
> 
> [![https://about.gitlab.com/images/14_0/edit_default_path_and_project_name_when_forking.png -- fork 时编辑默认路径和项目名称](../Images/05bc823c166d55220302a7819b0a2a0e.png)](https://i.stack.imgur.com/RlKa4.png)
> 
> 请参阅[文档](https://docs.gitlab.com/ee/user/project/repository/forking_workflow.html#creating-a-fork)和[问题](https://gitlab.com/gitlab-org/gitlab/-/issues/15013)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-04T16:10:41.057

您也可以在您的个人资料/设置下创建一个新组织。然后你可以通过同一个账户 fork 同一个原始 repo 的不同状态。

# .net - WinForms标签页不会在表单调整大小时重新绘制

> ID：12338241
> 
> 赞同：5
> 
> 时间：2012-09-09T10:16:44.003
> 
> 标签：.net, winforms, resize, tabcontrol, paint

`TabPage`当我调整表单大小时，.NET WinForms 没有完全重新绘制其背景是否有原因？它应该是完全白色的（在 Windows 7 中），但一部分仍然是灰色的（`SystemColors.Control`很可能）。每当我点击最大化按钮时，当前可见的`TabPage`背景都不会重绘。此外，如果我调整它的大小，我需要将表单移动到屏幕边界之外，以便它被绘制。

如果我最小化然后恢复表单，也会发生同样的事情。在这种情况下，`TabPage`背景仍然是灰色的。子控件被正确呈现（例如，标签保持其白色背景）。

我正在使用 Windows 7 32 位、.NET 3.5。选项卡控件是使用 Visual Studio 设计器添加的，它包含几个标签和两个文本框。我没有更改任何与绘制消息相关的原生样式标志。

**[编辑]**

我创建了一个测试项目，源代码[在这里上传](http://pastebin.com/LJNE3c20)。

这是窗口最初的样子：

![形成初始状态](../Images/e05af20774c80f611dba8f1e82b110c3.png)

这是我最小化它然后恢复它后窗口的外观：

![最小化，然后恢复](../Images/e66139a56d401c6ea19c6ced63e034c5.png)

注意`TabPage`背景颜色的变化。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T20:10:02.770

我通过在 tabControl 的 ClientSizeChanged 方法中添加对 tabControl.Refresh() 的调用来解决此问题。请注意，这适用于整个选项卡控件，而不是每个单独的选项卡页。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-09T12:22:23.460

好的，我认为您的问题可以通过执行以下步骤来解决：

对于`tabPage`设置`UseVisualStyleBackColor`为`False`，只需将其设置`BackColor`为您想要的颜色，在这种情况下`White`

另外，不要将锚设置到所有侧面，只需设置`Dock`为`Fill`. 通常避免为标签设置大小，只尝试为它们设置锚点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T12:05:54.010

此视觉样式错误已在 .NET 4.0 中修复。

# android - Eclipse 安装错误：INSTALL_FAILED_UID_CHANGED

> ID：12338242
> 
> 赞同：15
> 
> 时间：2012-09-09T10:16:44.610
> 
> 标签：android, eclipse

我在真正的 android 设备上从 eclipse 运行 android 应用程序时遇到问题

当我单击运行时，它只显示此错误：安装错误：`INSTALL_FAILED_UID_CHANGED`

日志猫：

```
[2012-09-09 14:38:26 - SearchApp] Android Launch!
[2012-09-09 14:38:26 - SearchApp] adb is running normally.
[2012-09-09 14:38:26 - SearchApp] Performing com.example.MainActivity activity launch
[2012-09-09 14:38:26 - SearchApp] Automatic Target Mode: using device 'cff192abd7f551f'
[2012-09-09 14:38:26 - SearchApp] Uploading SearchApp.apk onto device 'cff192abd7f551f'
[2012-09-09 14:38:27 - SearchApp] Installing SearchApp.apk...
[2012-09-09 14:38:28 - SearchApp] Installation error: INSTALL_FAILED_UID_CHANGED
[2012-09-09 14:38:28 - SearchApp] Please check logcat output for more details.
[2012-09-09 14:38:28 - SearchApp] Launch canceled! 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-30T16:14:36.287

**我最终找到了 INSTALL_FAILED_DEXOPT 和 INSTALL_FAILED_UID_CHANGED 错误的解决方案**

在徒劳地测试了各种技巧之后，我终于找到了永远解决这个棘手问题的主要解决方案！

我认为问题是由 Eclipse 错误引起的！，实际上eclipse不能仅仅因为一个字符串名称而复制和安装构建的APK文件（进一步描述）

我应该补充一点，当您在互联网上使用诸如删除数据/数据中的包名称文件夹之类的技巧时，您将面临一个新的粘性错误“ **INSTALL_FAILED_DEXOPT** ”

那么让我们看看如何解决**INSTALL_FAILED_DEXOPT**和**INSTALL_FAILED_UID_CHANGED**

就我而言，当我检查日志猫时，我注意到以下几行：

```
09-30 19:03:19.882: I/PackageManager(314): Running dexopt on: com.example.searchapp
09-30 19:03:19.921: E/dalvikvm(6129): Invalid name: 'search_‌country_name'
09-30 19:03:19.921: E/dalvikvm(6129): Trouble with item 226 @ offset 0x2094
09-30 19:03:19.921: E/dalvikvm(6129): Cross-item verify of section type 0004 failed
09-30 19:03:19.921: E/dalvikvm(6129): ERROR: Byte swap + verify failed
09-30 19:03:19.961: E/dalvikvm(6129): Optimization failed
09-30 19:03:19.961: W/installd(144): DexInv: --- END '/data/app/com.example.searchapp-1.apk' --- status=0xff00, process failed
09-30 19:03:19.961: E/installd(144): dexopt failed on '/data/dalvik-cache/data@app@com.example.searchapp-1.apk@classes.dex' res = 65280
09-30 19:03:19.961: W/PackageManager(314): Package couldn't be installed in /data/app/com.example.searchapp-1.apk 
```

如您所见，第二行是：**Invalid name: 'search_‌country_name'**

这是我在 String.xml 中的字符串名称之一

所以我删除了这个字符串并注释了所有引用的代码

然后我删除 /data/data 中的包名称文件夹（如果您使用的是实际设备，则应该具有 root 访问权限，如果您使用的是模拟器，只需在打开模拟器或制作新的 AVD 之前擦除数据）

现在问题解决了！

您可以轻松地继续编码！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-17T13:36:55.357

这个解决方案终于在没有根的情况下对我有用：

```
$ platform-tools/adb -d install /path/to/proj/bin/foo.apk
797 KB/s (4872885 bytes in 5.963s)
pkg: /data/local/tmp/foo.apk
Success
$ platform-tools/adb -d uninstall com.example.foo.bar
Success 
```

我不完全明白为什么从 Eclipse 安装时这对同一个 APK 不起作用，但我很高兴继续前进......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-07-02T16:01:38.900

我尝试了所有这些答案，但没有效果

正确卸载。

解决方法：**重启pad**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-18T04:57:32.917

应用程序可能未正确卸载。可能有遗漏的数据文件夹。所以尝试手动删除应用程序的数据文件夹并尝试再次安装应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T07:49:27.583

或者，删除模拟器并重新重新配置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-18T18:29:15.240

有一个解决方法。如果您没有根设备并且您也无法访问 /data/data/ 文件夹，那么只需重置您的设备。它将从数据文件夹中删除所有内容，您可以再次安装干净的应用程序。唯一的缺点是所有内容都会从您的手机中删除。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-03T23:44:34.777

我在模拟器上遇到了这个问题。我删除了 avd 并创建了一个新的。问题消失了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-24T17:30:27.320

可能有人帮忙...

我有用于调试的根设备。有时我从 /data/data/my.package 备份我的应用程序数据，然后通过 adb shell 恢复。在还原之前，我删除了 my.package 文件夹，重新创建并复制其他子文件夹和文件。在下次更改并从 Eclipse 运行项目之后，得到 INSTALL_FAILED_UID_CHANGED 错误。

我的错误：我不应该删除 my.package 文件夹。我必须只删除此文件夹中的所有内容，因为在重新创建文件夹时，我得到了新的所有者文件夹 my.package。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-09-09T15:37:39.787

已经有一个数据目录，其名称为您尝试安装的包的名称，并分配了不同的 UID。获取 root 访问权限，然后尝试在 cmd 中使用以下命令删除已存在的目录

```
 rm -r /data/data/com.your.package 
```

或者尝试重命名您的应用程序包以在您的设备上运行它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-11T08:24:30.083

这个解决方案对我有用：

1.  将您的 APK 放入设备的存储/SD 卡

2.  `adb shell pm install -l -r "/sdcard/<apk_filename>.apk"`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-11-07T23:51:54.693

所以如果你下来找到这个.. 没有什么可能对你有用。然而，有一个简单的解决方法。这显然是因为卸载不当（可能是由于电缆连接错误）。

**解决方案**从 play-store 下载[SDMaid](https://play.google.com/store/apps/details?id=eu.thedarken.sdm)，并删除尸体文件（垃圾文件）。重新运行应用程序。（但你需要让你的设备植根）

# iphone - 与 UIKit 相关的罕见且不可重现的崩溃

> ID：12338243
> 
> 赞同：2
> 
> 时间：2012-09-09T10:16:47.037
> 
> 标签：iphone, objective-c, ios, crash, uikit

我有一个与 UIKit 相关的随机崩溃，我似乎无法弄清楚出了什么问题。

有没有人在这里看到熟悉的模式，或者您认为这可能是与操作系统相关的随机崩溃？有没有办法找出这里涉及哪些按钮或 UI 元素？

```
Thread 0 Crashed:
0   libobjc.A.dylib                     0x35260f78 objc_msgSend + 15
1   UIKit                               0x312363d7 -[UIView(Hierarchy) superview] + 50
2   UIKit                               0x31239abb -[UIView nextResponder] + 82
3   UIKit                               0x31354011 forwardTouchMethod + 36
4   UIKit                               0x3124f97d -[UIWindow _sendTouchesForEvent:] + 400
5   UIKit                               0x3124f319 -[UIWindow sendEvent:] + 380
6   UIKit                               0x31235695 -[UIApplication sendEvent:] + 356
7   UIKit                               0x313e762f __42-[UIApplication _cancelTouches:withEvent:]_block_invoke_0 + 54
8   UIKit                               0x312a5d0d -[UIApplication _cancelTouches:withEvent:includingGestures:notificationBlock:] + 544
9   UIKit                               0x312a5ae9 -[UIApplication _cancelTouches:withEvent:] + 84
10  UIKit                               0x31234eb1 _UIApplicationHandleEvent + 5688
11  GraphicsServices                    0x33c7722b PurpleEventCallback + 882
12  CoreFoundation                      0x37535523 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 38
13  CoreFoundation                      0x375354c5 __CFRunLoopDoSource1 + 140
14  CoreFoundation                      0x37534313 __CFRunLoopRun + 1370
15  CoreFoundation                      0x374b74a5 CFRunLoopRunSpecific + 300
16  CoreFoundation                      0x374b736d CFRunLoopRunInMode + 104
17  GraphicsServices                    0x33c76439 GSEventRunModal + 136
18  UIKit                               0x31263cd5 UIApplicationMain + 1080 
```

# android - 使资源主题依赖

> ID：12338244
> 
> 赞同：28
> 
> 时间：2012-09-09T10:17:19.900
> 
> 标签：android, android-theme

现在我们有两个图标（深色和浅色），如[ActionBar Icon Guide](http://developer.android.com/guide/practices/ui_guidelines/icon_design_action_bar.html)中所述。

```
@drawable/ic_search_light 
@drawable/ic_search_dark 
```

如何在 XML 菜单资源中引用这些图标：

`<item android:title="Search" android:icon="`哪个drawable在这里？ `"/>`

每次在 Light 和 Dark 之间切换应用程序主题时，我是否必须更新所有这些可绘制引用？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-09-09T14:26:30.880

有一种方法可以将 android *drawables （以及**res/values*中的许多其他元素）定义为依赖于主题。

假设我们有两个*可绘制对象*，在这种情况下是菜单图标：

```
res/drawable/ic_search_light.png
res/drawable/ic_search_dark.png 
```

我们希望使用`ic_search_dark.png`默认`Theme`或扩展它的应用程序主题，同样，`ic_search_light.png`如果我们的应用程序主题更改为默认`Theme.Light`或扩展它的某个主题，我们希望。

*在/res/attrs.xml*中定义一个具有唯一名称的通用属性，例如：

```
<resources>
<attr name="theme_dependent_icon" format="reference"/>
</resources> 
```

这是一个全局属性，格式类型是参考，如果是自定义视图，它可以与样式属性一起定义：

```
<resources>
    <declare-styleable name="custom_menu">
        <attr name="theme_dependent_icon" format="reference"/>
    </declare-styleable>
</resources> 
```

*接下来，在res/styles.xml*或*res/themes.xml*中定义两个主题，扩展默认`Theme`和`Theme.Light`（或从这些主题继承的主题）：

 **```
<resources>
    <style name="CustomTheme" parent="android:Theme">
        <item name="theme_dependent_icon" >@drawable/ic_search_dark</item>
    </style>

    <style name="CustomTheme.Light" parent="android:Theme.Light">
        <item name="theme_dependent_icon" >@drawable/ic_search_light</item>
    </style>
</resources> 
```

最后，使用我们定义的引用属性来引用这些图标。在这种情况下，我们在定义菜单布局时使用

```
<menu xmlns:android="http://schemas.android.com/apk/res/android">
<item android:title="Menu Item"  android:icon="?attr/theme_dependent_icon"/>
</menu> 
```

`?attr`指当前正在使用的主题的属性。

现在，我们可以使用以上两个主题进行应用：

```
<application android:theme="@style/CustomTheme"> 
```

或者

```
<application android:theme="@style/CustomTheme.Light"> 
```

并相应地使用相应的资源。

主题也可以在代码中应用，通过将其设置在 Activity 的开头`onCreate()`。

**更新**

[此答案](https://stackoverflow.com/a/3679026/1531054)中解释了从代码访问这些主题相关资源的方法。**

# c - 测试 emalloc 的返回状态

> ID：12338253
> 
> 赞同：0
> 
> 时间：2012-09-09T10:19:22.090
> 
> 标签：c, php-extension

我正在编写几个 PHP 扩展作为个人项目。（几十年前我曾经专业地使用 C 来开发实时和过程控制应用程序，所以我对总是检查内存分配器返回并确保错误路径不会泄漏内存有点偏执。但是后来 C++ 的世界和异常处理程序。）现在我有一个简单的问题：

我是否需要在以下情况下进行 NULL 检查`buf`：

```
buf = emalloc(rec->len); 
```

通常在 FLOSS 项目中，我只会使用现有的源代码作为模板来回答这种问题，但是 PHP 扩展不一致。静态分析复杂的 C 预处理代码是不切实际的，我只能轻松测试自己的 LAMP 堆栈。基本上，据我所知，emalloc 代码确实会在堆耗尽时调用 zend 错误例程，但代码会继续并返回 0。一些扩展代码案例确实会检查 NULL 返回，但您也可以在以下示例中找到`PHPAPI void php_basename()`示例`ext/standard/string.c`：

```
if (p_ret) {
    ret = emalloc(len + 1);
    memcpy(ret, comp, len);
    ret[len] = '\0';
    *p_ret = ret;
} 
```

如果 emalloc 确实返回而不是抛出一个 zend 异常，这将产生一个硬内存异常。

如果有人知道官方 PHP 开发人员的答案，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T10:28:21.077

[该文件](http://php.net/manual/en/internals2.memory.management.php)明确指出：

> 注意：与 C 标准库的对应物不同，Zend 引擎的内存管理函数不会在分配请求的内存时出现问题时返回 NULL，而是退出并终止当前请求。

# android - 项目中的清单文件错误

> ID：12338257
> 
> 赞同：0
> 
> 时间：2012-09-09T10:19:43.240
> 
> 标签：android

当我尝试解决 GCM 问题时，清单文件出现错误：

> 错误
> 
> 错误：错误：未找到与给定名称匹配的资源（在“标签”处，值为“@string/title_activity_main”）。

错误出现在这里：

```
android:label="@string/title_activity_main" > 
```

**显现：**

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.elarabygroup"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <permission
        android:name="com.example.elarabygroup.permission.C2D_MESSAGE"
        android:protectionLevel="signature" />

    <uses-permission android:name="com.example.elarabygroup.permission.C2D_MESSAGE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

    <!-- App receives GCM messages. -->
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    <!-- GCM connects to Google Services. -->
    <uses-permission android:name="android.permission.INTERNET" />
    <!-- GCM requires a Google account. -->
    <uses-permission android:name="android.permission.GET_ACCOUNTS" />
    <!-- Keeps the processor from sleeping when a message is received. -->
    <uses-permission android:name="android.permission.WAKE_LOCK" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <service
            android:name="com.example.elarabygroup"
            android:enabled="true" />

        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <receiver
            android:name="com.google.android.gcm.GCMBroadcastReceiver"
            android:permission="com.google.android.c2dm.permission.SEND" >
            <intent-filter>
                <action android:name="com.google.android.c2dm.intent.RECEIVE" />
                <action android:name="com.google.android.c2dm.intent.REGISTRATION" />

                <category android:name="com.example.elarabygroup.gcm2" />
            </intent-filter>
        </receiver>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:36:36.693

您应该将字符串`res/values/strings.xml`作为一个项目：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>

    <string name="title_activity_main">My Main Activity</string>   

</resources> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T10:37:31.060

请添加`@string/title_activity_main`到您的字符串资源。

# php - 字符串不支持 [] 运算符。它只发生在一页

> ID：12338263
> 
> 赞同：1
> 
> 时间：2012-09-09T10:21:25.113
> 
> 标签：php, ajax, arrays, string

我写了（也感谢 Stackoverflow 的帮助）一个 PHP 脚本（称为 wunder_temp.php），它显示了给定数量 Weatherunderground.com 站的温度和位置。

我在页脚中包含了这个脚本，它运行良好，但在一个页面上。如果我打开[http://www.flapane.com/guestbook/guestbook.php](http://www.flapane.com/guestbook/guestbook.php)温度将不会显示在我的页脚中，并且 error.log 说：[09-Sep-2012 09:46:45 UTC] PHP Fatal错误：第 47 行 /home/xxx/public_html/wunder_temp.php 中的字符串不支持 [] 运算符

```
$display = file($cachename, FILE_IGNORE_NEW_LINES); //ignore \n for non-reporting stations
foreach ($display as $key=>$value){
    if($key % 2 == 0){  
         $temperature[] = $value; // EVEN (righe del file cache pari)
    }else{
         $location[] = $value;  // ODD - **HERE IS LINE 47**
    }
} 
```

奇怪的是，guestbook.php 是我网站上 wunder_temp.php 不起作用的唯一页面。

上面的代码所做的是读取缓存文件并将偶数行放入 $temperature[] 数组中，将奇数行放入 $location[] 数组中。这是我的缓存文件中的一个示例：

```
26.8
Stadio San Paolo di Napoli, Napoli
24.4
Pozzuoli 
```

老实说，我不知道为什么我只在我的留言簿页面上看到这些错误。

事实证明，“罪魁祸首”是函数 loadmore.php，它使用 twitter 风格的 ajax 函数加载留言簿评论（并且包含在 guestbook.php 中）。如果我不包含它，wunder_temp.php 运行良好，并且不会产生任何错误。

加载更多.php：

```
<div id='contcomment'>
<div class="timeline" id="updates">
<?php
$sql=mysql_query("select * from gbook_comments ORDER BY id DESC LIMIT 9");
while($row=mysql_fetch_array($sql))
{
$msg_id=$row['id'];
$name=$row['name'];
$url=$row['url'];
$email=$row['email'];
$location=$row['location'];
$date= strtotime($row['dt']); //unix timestamp
$country_code=$row['country_code'];
$message=$row['body'];

        $link_open = '';
        $link_close = '';

        if($url){

            // If the person has entered a URL when adding a comment,
            // define opening and closing hyperlink tags

            $link_open = '<a href="'.$url.'" target="_blank" rel="nofollow">';
            $link_close =  '</a>';
        }

// Needed for the default gravatar image:
        $url_grav = 'http://'.dirname($_SERVER['SERVER_NAME'].$_SERVER["REQUEST_URI"]).'/img/default_avatar.gif';

        // Show flags
        $image = strtolower($country_code) . ".png";
        if (file_exists("./img/flags/" . $image)){
        $show_image = true;
        $image_link = "<img src='/guestbook/img/flags/$image' alt='user flag' />";
        }else{
        $show_image = false;
        }

        echo    '<div class="comment">
                <div class="avatar">
                    '.$link_open.'
                    <img src="http://www.gravatar.com/avatar/'.md5($email).'?size=50&amp;default='.urlencode($url_grav).'" alt="gravatar icon" />
                    '.$link_close.'
                </div>

                <div class="name">'.$link_open.$name.$link_close.' </div><div class="location"><i>(da/from '.$location.' '.$image_link.' )</i></div>
                <div class="date" title="Added at '.date('H:i \o\n d M Y',$date).'">'.date('d M Y',$date).'</div>
                <p>'.$message.'</p>

            </div>' ;
} ?>
</div>
<div id="more<?php echo $msg_id; ?>" class="morebox">
<a href="#" class="more" id="<?php echo $msg_id; ?>">Carica Commenti pi&ugrave; vecchi / Load older entries</a>
</div>
</div> 
```

ajax_more.js AJAX twitter-style load-more-comments 函数：

```
$(function() {
//More Button
$('.more').live("click",function() 
{
var ID = $(this).attr("id");
if(ID)
{
$("#more"+ID).html('<img src="moreajax.gif" />');

$.ajax({
type: "POST",
url: "ajax_more.php",
data: "lastmsg="+ ID, 
cache: false,
success: function(html){
$("div#updates").append(html);
$("#more"+ID).remove();
}
});
}
else
{
$(".morebox").html('Nessun altro commento / No more comments');

}

return false;

});
}); 
```

ajax_more.php（上述脚本需要）：

```
<? 

include "connect.php"; 

if(isSet($_POST['lastmsg']))
{
$lastmsg=$_POST['lastmsg'];
$lastmsg=mysql_real_escape_string($lastmsg);
$result=mysql_query("select * from gbook_comments where id<'$lastmsg' order by id desc limit 9");
$count=mysql_num_rows($result);
while($row=mysql_fetch_array($result))
{
$msg_id=$row['id'];
$name=$row['name'];
$url=$row['url'];
$email=$row['email'];
$location=$row['location'];
$date= strtotime($row['dt']); //unix timestamp
$country_code=$row['country_code'];
$message=$row['body'];

        $link_open = '';
        $link_close = '';

        if($url){

            // If the person has entered a URL when adding a comment,
            // define opening and closing hyperlink tags

            $link_open = '<a href="'.$url.'" target="_blank" rel="nofollow">';
            $link_close =  '</a>';
        }

// Needed for the default gravatar image:
        $url_grav = 'http://'.dirname($_SERVER['SERVER_NAME'].$_SERVER["REQUEST_URI"]).'/img/default_avatar.gif';

        // Show flags
        $image = strtolower($country_code) . ".png";
        if (file_exists("./img/flags/" . $image)){
        $show_image = true;
        $image_link = "<img src='/guestbook/img/flags/$image' alt='user flag' />";
        }else{
        $show_image = false;
        }

    echo    '<div class="comment">
                <div class="avatar">
                    '.$link_open.'
                    <img src="http://www.gravatar.com/avatar/'.md5($email).'?size=50&amp;default='.urlencode($url_grav).'" alt="gravatar icon" />
                    '.$link_close.'
                </div>

                <div class="name">'.$link_open.$name.$link_close.' </div><div class="location"><i>(da/from '.$location.' '.$image_link.' )</i></div>
                <div class="date" title="Added at '.date('H:i \o\n d M Y',$date).'">'.date('d M Y',$date).'</div>
                <p>'.$message.'</p>

            </div>' ;       

}

?>

<div id="more<?php echo $msg_id; ?>" class="morebox">
<a href="#" id="<?php echo $msg_id; ?>" class="more">Carica Commenti pi&ugrave; vecchi / Load older entries</a>
</div>

<?php
}
?> 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T10:28:18.443

`$location`已经是该页面上的一个字符串。这就是在使用变量之前正确*初始化变量的原因：*

```
$temperature = $location = array();

foreach ($display as $key => $value){
    if ($key % 2 == 0){  
         $temperature[] = $value;
    } else {
         $location[] = $value;
    }
} 
```

更好的是，更好地分离你的变量范围，这样你就不会遇到这样的名称冲突。使用具有私有变量范围的函数和类，不要将所有内容都放在全局范围内。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T10:27:57.937

这似乎是一个可变范围的问题。

当您包含在内`loadmore.php`时，`guestbook.php`您将隐式声明`$location`为字符串：

```
$location=$row['location']; 
```

所以你的循环的这一行：

```
 $location[] = $value;  // ODD - **HERE IS LINE 47** 
```

不是在第一次迭代时隐式声明一个新的数组变量，而是试图将 $value 附加到先前声明的字符串变量，因此出现错误。

尝试在 loadmore.php 或 guestbook.php 中为 $location 赋予不同的名称，或者使 loadmore.php 成为一个函数（因此它在自己的范围内运行），然后在包含其代码后从 guestbook.php 脚本中调用它。或者，如果您想将 $location 变量作为数组重用（只需`$location = array();`在循环之前添加），请使用显式声明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T10:27:45.283

我认为 loadmore.php 和/或 ajaxmore.php 正在将全局变量 ( `$location`) 设置为字符串。当留言簿页面尝试索引此变量时，您会收到错误消息。

解决方案：使用函数和局部变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T10:28:51.230

`$location=$row['location'];` 是问题。因为 PHP 没有块级作用域，所以您实际上是在预先设置此变量并尝试使用 [] 设置它的数组索引。因为它是一个字符串，它会断开。

您应该始终初始化变量以避免这些类型的冲突：即 `$location = array();`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-09T10:29:15.093

为其中一个脚本重命名 $location。您在某处有 $location=$row['location'] 。此外，在将变量用作数组时声明变量：

```
$array = array();
$array[] = 'item'; // when you add an item here, $array will always accept an array push. 
```

# c++ - 序列化函数对象

> ID：12338265
> 
> 赞同：16
> 
> 时间：2012-09-09T10:21:53.213
> 
> 标签：c++, serialization, c++11, closures, function-object

是否可以`std::function`在 C++ 中序列化和反序列化 a 、函数对象或闭包？如何？C++11 是否促进了这一点？是否有任何库支持可用于此类任务（例如，在 Boost 中）？

例如，假设一个 C++ 程序`std::function`需要与驻留在另一台机器上的另一个 C++ 程序进行通信（比如通过 TCP/IP 套接字）。在这种情况下你有什么建议？

* * *

**编辑：**

澄清一下，要移动的函数应该是纯的且无副作用的。所以我没有安全或状态不匹配的问题。

该问题的解决方案是构建一个小型嵌入式领域特定语言并序列化其抽象语法树。我希望我能找到一些语言/库支持来移动与机器无关的函数表示。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-03-31T21:08:49.220

是的，用于函数指针和闭包。不为`std::function`。

函数指针是最简单的——它只是一个和其他指针一样的指针，因此您可以将其读取为字节：

```
template <typename _Res, typename... _Args>
std::string serialize(_Res (*fn_ptr)(_Args...)) {
  return std::string(reinterpret_cast<const char*>(&fn_ptr), sizeof(fn_ptr));
}

template <typename _Res, typename... _Args>
_Res (*deserialize(std::string str))(_Args...) {
  return *reinterpret_cast<_Res (**)(_Args...)>(const_cast<char*>(str.c_str()));
} 
```

但令我惊讶的是，即使不重新编译，函数的地址也会在程序的每次调用时发生变化。如果您想传输地址，则不是很有用。这是由于[ASLR](https://en.wikipedia.org/wiki/Address_space_layout_randomization)`your_program`造成的，您可以在 Linux 上以.开头将其关闭`setarch $(uname -m) -LR your_program`。

现在您可以将函数指针发送到运行相同程序的不同机器，然后调用它！（这不涉及传输可执行代码。但除非您在运行时生成可执行代码，否则我认为您不会在寻找那个。）

lambda 函数完全不同。

```
std::function<int(int)> addN(int N) {
  auto f = [=](int x){ return x + N; };
  return f;
} 
```

的值`f`将是捕获的`int N`. 它在内存中的表示与`int`! 编译器为 lambda 生成一个未命名的类，它`f`是一个实例。这个类已经`operator()`用我们的代码重载了。

未命名的类给序列化带来了问题。它还提出了从函数返回 lambda 函数的问题。后一个问题由`std::function`.

`std::function`据我了解是通过创建一个模板化的包装类来实现的，该类通过模板类型参数有效地保存对 lambda 函数背后的未命名类的引用。（这是`_Function_handler`在[函数](https://github.com/mirrors/gcc/blob/master/libstdc%2B%2B-v3/include/std/functional)式中。）`std::function`接受一个指向`_M_invoke`这个包装类的静态方法（）的函数指针，并存储它加上闭包值。

不幸的是，所有内容都隐藏在`private`成员中，并且没有存储闭包值的大小。（它不需要，因为 lambda 函数知道它的大小。）

所以`std::function`不适合序列化，但可以很好地作为蓝图。我遵循它的做法，对其进行了很多简化（我只想序列化 lambda，而不是无数其他可调用的东西），将闭包值的大小保存在 a 中`size_t`，并添加了用于（反）序列化的方法。有用！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-09T14:04:36.683

不。

C++ 没有对序列化的内置支持，并且从未设想过将代码从一个进程传输到另一个进程的想法，以免将一台机器传输到另一台机器。可以这样做的语言通常同时具有 IR（与机器无关的代码的中间表示）和反射。

因此，您只需要自己编写一个协议来传输您想要的操作，而 DSL 方法当然是可行的……这取决于您希望执行的任务的种类和对性能的需求。

另一种解决方案是使用现有语言。例如 Redis NoSQL 数据库嵌入了一个 LUA 引擎并且可以执行 LUA 脚本，你也可以这样做并在网络上传输 LUA 脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-10T08:54:48.380

不，但有一些受限的解决方案。

您最希望的是在发送代码和接收代码（在不同的计算机或序列化前后）通用的某种全局映射（例如，使用键字符串）中注册函数。然后，您可以序列化与函数关联的字符串并在另一端获取它。

作为一个具体的例子，HPX 库在[HPX_ACTION](http://stellar.cct.lsu.edu/files/hpx-0.9.10/html/hpx/manual/applying_actions/action_invocation.html)中实现了类似的东西。

这需要大量协议，并且在代码更改方面很脆弱。

但毕竟这与试图用私有数据序列化一个类的东西没有什么不同。在某种意义上，函数的代码是它的私有部分（参数和返回接口是公共部分）。

让您望而却步的是，根据您组织代码的方式，这些“对象”可以是全局的或通用的，如果一切顺利，它们可以在序列化和反序列化期间通过某种预定义的运行时间接使用。

这是一个粗略的例子：

序列化代码：

```
// common:
class C{
  double d;
  public:
  C(double d) : d(d){}
  operator(double x) const{return d*x;}
};
C c1{1.};
C c2{2.};
std::map<std::string, C*> const m{{"c1", &c1}, {"c2", &c2}};
// :common

main(int argc, char** argv){
   C* f = (argc == 2)?&c1:&c2;
   (*f)(5.); // print 5 or 10 depending on the runtime args
   serialize(f); // somehow write "c1" or "c2" to a file
} 
```

解串器代码：

```
// common:
class C{
  double d;
  public:
  operator(double x){return d*x;}
};
C c1;
C c2;
std::map<std::string, C*> const m{{"c1", &c1}, {"c2", &c2}};
// :common

main(){
   C* f;
   deserialize(f); // somehow read "c1" or "c2" and assign the pointer from the translation "map"
   (*f)(3.); // print 3 or 6 depending on the code of the **other** run
} 
```

（代码未经测试）。

请注意，这会强制使用许多通用且一致的代码，但取决于环境，您可能能够保证这一点。代码中最轻微的变化都会产生难以检测的逻辑错误。

另外，我在这里玩过全局对象（可以在自由函数上使用），但同样可以用作用域对象来完成，更棘手的是如何在本地建立映射（`#include`本地范围内的公共代码？）

# php - 在 application.ini 中设置 Zend Framework DB 垃圾收集？（和引导程序？）

> ID：12338273
> 
> 赞同：1
> 
> 时间：2012-09-09T10:22:45.640
> 
> 标签：php, zend-framework

我在 application.ini 中将我的所有会话存储到数据库中

```
/* Session */
resources.session.use_only_cookies = on
resources.session.gc_maxlifetime = 864000
resources.session.remember_me_seconds = 864000
resources.session.cookie_lifetime = 864000
resources.session.name= "sessionName"

resources.session.saveHandler.class = "Zend_Session_SaveHandler_DbTable"

resources.session.saveHandler.options.name = "sessions"
resources.session.saveHandler.options.primary = "id"
resources.session.saveHandler.options.modifiedColumn = "modified"
resources.session.saveHandler.options.dataColumn = "data"
resources.session.saveHandler.options.lifetimeColumn = "lifetime" 
```

过期的会话不会在数据库中被删除。我错过了什么？引导程序中应该有一些东西吗？如果有人可以提供帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T01:14:41.773

`read`当会话被调用或被调用时，看起来过期的会话被从数据库中删除`destroy`。

```
//from Zend_Session_SaveHandler_DbTable
 public function read($id)
    {
        $return = '';

        $rows = call_user_func_array(array(&$this, 'find'), $this->_getPrimary($id));

        if (count($rows)) {
            if ($this->_getExpirationTime($row = $rows->current()) > time()) {
                $return = $row->{$this->_dataColumn};
            } else {
                $this->destroy($id);
            }
        }

        return $return;
    }

 public function destroy($id)
    {
        $return = false;

        if ($this->delete($this->_getPrimary($id, self::PRIMARY_TYPE_WHERECLAUSE))) {
            $return = true;
        }

        return $return;
    } 
```

可能存在删除数据库记录但我没有找到它们的其他情况。

# mysql - Mysql对索引的全表扫描

> ID：12338277
> 
> 赞同：0
> 
> 时间：2012-09-09T10:23:20.140
> 
> 标签：mysql, ajax, select, limit, full-table-scan

我在消息列中有 3,090,590 行，我正在使用此代码一次获取 3000 行。

我正在尝试将我的 SQL 转换为 NoSQL，为此我用 Ajax 编写了一个 PHP 脚本。Ajax 请求`$page`每次乘以；例如 3000、9000、12000...

```
SELECT * FROM mesajciklar order by id ASC LIMIT $page,3000 
```

不知何故，即使我限制查询，它总是会扫描整个表，这使得 MySQL 使用 100% 的可用 CPU。我对每一列都有完整的索引，但它仍然很慢。

你能告诉我一个如何优化它的方法吗？

```
mysql> | mesajciklar | CREATE TABLE `mesajciklar` (
->   `id` int(11) NOT NULL AUTO_INCREMENT,
->   `sira` int(11) NOT NULL DEFAULT '0',
->   `mesaj` text NOT NULL,
->   `yazar` varchar(255) NOT NULL DEFAULT '',
->   `ip` varchar(255) NOT NULL DEFAULT '',
->   `tarih` varchar(255) NOT NULL DEFAULT '',
->   `gun` int(11) NOT NULL DEFAULT '0',
->   `ay` int(11) NOT NULL DEFAULT '0',
->   `yil` int(11) NOT NULL DEFAULT '0',
->   `saat` varchar(255) NOT NULL DEFAULT '',
->   `oy` varchar(255) NOT NULL DEFAULT '',
->   `update2` varchar(255) NOT NULL DEFAULT '',
->   `updater` varchar(255) NOT NULL DEFAULT '',
->   `updatesebep` varchar(255) NOT NULL DEFAULT '',
->   `statu` varchar(255) NOT NULL DEFAULT '',
->   `silen` varchar(255) NOT NULL DEFAULT '',
->   `silsebep` varchar(255) NOT NULL DEFAULT '',
->   PRIMARY KEY (`id`),
->   UNIQUE KEY `id` (`id`) USING BTREE,
->   KEY `sira` (`sira`),
->   KEY `yazar` (`yazar`),
->   KEY `ip` (`ip`),
->   KEY `tarih` (`tarih`),
->   KEY `gun` (`gun`),
->   KEY `ay` (`ay`),
->   KEY `yil` (`yil`),
->   KEY `saat` (`saat`),
->   KEY `oy` (`oy`),
->   KEY `update2` (`update2`),
->   KEY `statu` (`statu`),
->   KEY `silsebep` (`silsebep`),
->   KEY `gun_2` (`gun`,`ay`,`yil`),
->   FULLTEXT KEY `mesaj` (`mesaj`),
->   FULLTEXT KEY `yazar_2` (`yazar`)
-> ) ENGINE=MyISAM AUTO_INCREMENT=1062473327 DEFAULT CHARSET=latin5 | 
```

# jquery - 当我使用母版页时，为什么这个 Jquery 键盘不起作用？

> ID：12338283
> 
> 赞同：0
> 
> 时间：2012-09-09T10:24:14.257
> 
> 标签：jquery, asp.net

单击[此处](http://keith-wood.name/keypad.html)获取 jquery 键盘的来源。

我在我的项目中以单独的形式使用了这个键盘，它可以工作，但是每当我在另一个带有母版页的形式中使用相同的东西时，它就不起作用。在我的母版页中，他添加了所有必要的参考资料（同样的参考资料也在表格的头部添加，以防万一！）

```
<script src="../App_Themes/Default/js/jquery-1.6.1.js" type="text/javascript"></script>

<%--<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>--%>

<script src="../App_Themes/Default/js/jquery.keypad.js" type="text/javascript">    </script>

<script type="text/javascript">
$(function () {
$('#txtFTP').keypad();

});
</script> 
```

即使我删除了相同表单的母版页引用并将内容占位符替换为 HTML 标记，jquery 键盘也能正常工作。

谁能建议我为什么它不起作用？

**更新 1**

为了测试有关此问题的更多信息，我创建了一个新的测试母版页。编码：

```
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="TestMasterPage.master.cs" 

 Inherits="Member_TestMasterPage" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org

/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
 <title>Untitled Page</title>
 <asp:ContentPlaceHolder id="head" runat="server">
 </asp:ContentPlaceHolder>
</head>
<body>
 <form id="form1" runat="server">
  <div>
    <asp:ContentPlaceHolder id="ContentPlaceHolder1" runat="server">

    </asp:ContentPlaceHolder>
  </div>
 </form>
</body>
</html> 
```

如您所见，jquery 的母版页中没有参考。

然后我创建了一个新的 test.aspx 页面。编码：

```
<%@ Page Language="C#" MasterPageFile="~/Member/TestMasterPage.master" 

AutoEventWireup="true" CodeFile="2.aspx.cs" Inherits="_2" %>

<asp:Content ContentPlaceHolderID="head" runat="server">
 <script src="../App_Themes/Default/js/jquery-1.6.1.js" type="text/javascript"> 
 </script>

 <script src="../App_Themes/Default/js/jquery.keypad.js" type="text/javascript">
 </script>

 <script type="text/javascript">
   $(function () {
$('#txtFTP').keypad();

   });
 </script>
</asp:Content>

<asp:Content ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
 <div>
  <asp:TextBox ID="txtFTP" SkinID="Mini" runat="server" TextMode="Password"   
  ForeColor="Gray" />
 </div>
</form>

</asp:Content> 
```

但是 jquery 键盘不起作用。但是，如果我删除母版页引用并相应地更改页面，键盘就可以工作了！编码：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="2.aspx.cs" Inherits="_2" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org 
/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title>Untitled Page</title>

<script src="../App_Themes/Default/js/jquery-1.6.1.js" type="text/javascript"></script>

<script src="../App_Themes/Default/js/jquery.keypad.js" type="text/javascript">  
</script>

<script type="text/javascript">
$(function () {
$('#txtFTP').keypad();

});
</script>

</head>
<body>
<form id="form1" runat="server">
<div>
<asp:TextBox ID="txtFTP" SkinID="Mini" runat="server" TextMode="Password"  
ForeColor="Gray" />
</div>
</form>
</body>
</html> 
```

**我究竟做错了什么？为什么我不能让它与母版页一起工作？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:52:48.567

您的脚本 src 路径并不总是有效。它们仅在您的页面位于根文件夹内的文件夹中时才有效，但如果您已经在根文件夹中或更深，则它们不会起作用。

母版页机制使问题更加复杂。如果您不使用母版页，那么不难看出您的链接是否有效。您只需要查看您的页面路径是否与 src 值一致，例如，如果您的页面位于一个文件夹中，它会起作用。但是，当您访问母版页时，您的链接将相对于该页面起作用，而不是母版页，因此当您编写母版页时，您对您在树中的位置一无所知。

解决方案是在服务器的帮助下从根目录指定链接，如下所示：

```
<script runat="server" src="~/App_Themes/Default/js/jquery-1.6.1.js" type="text/javascript"></script> 
```

（您的“App_Themes”文件夹应该在根文件夹中）

# php - 在 FB 页面选项卡应用程序中重定向后无法获得正确的 signed_request 信息

> ID：12338284
> 
> 赞同：0
> 
> 时间：2012-09-09T10:24:30.420
> 
> 标签：php, facebook, facebook-php-sdk

最初登陆应用程序时，$facebook->getSignedRequest(); 为我提供了我正在寻找的正确信息，例如有关当前页面的信息等。但是在单击应用程序中的链接后，来自 $facebook->getSignedRequest() 的返回数组是不同的。它包含 [code] 但没有关于页面是否被喜欢等

我该如何解决这个问题？通过 parent.location.href 更改应用程序内的页面是最佳实践吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:28:56.490

您的应用程序内的重定向将不会收到该`signed_request`参数。您必须自己管理保存该数据（例如在会话变量中）。

# java - 在 MOXy 中，如果元素包含子元素和属性，则无法合并元素

> ID：12338288
> 
> 赞同：2
> 
> 时间：2012-09-09T10:25:14.313
> 
> 标签：java, json, jaxb, eclipselink, moxy

这是我的 Xml 输出

```
<worklist>
  <work>
    <relation-list target-type="artist">
      <relation type="composer">
        <name>Пётр Ильич Чайковский</name>
        <sort-name>Пётр Ильич Чайковский</sort-name>
      </relation>
      <relation type="writer">
        <name>Frank Turner/name>
        <sort-name>Turner Frank</sort-name>
      </relation>
    </relation-list>
  </work>
</worklist> 
```

我正在尝试使用 EclipseLInk Moxy 来获取这个 json 输出

```
{
   "work" : [ {
       "relations" : [ {
          "type" : "composer",
          "name" : "Пётр Ильич Чайковский",
          "sort-name" : "Пётр Ильич Чайковский"
       }, {
          "type" : "writer",
          "name" : "frank turner",
          "sort-name" : "turner, frank"
       } ]
    } ]
} 
```

但我能做的最好的就是

```
{
   "work" : [ {
      "relationList" : [ {
         "relations" : [ {
            "type" : "composer",
             "name" : "Пётр Ильич Чайковский",
             "sort-name" : "Пётр Ильич Чайковский"
         }, { 
            "type" : "writer",
             "name" : "frank turner",
             "sort-name" : "turner, frank"

         } ]
      } ],
   } ]
} 
```

注意我已经删除了关系列表的目标类型属性，并且我已经将关系重命名为关系，但是如果我尝试将关系列表与其父级合并使用

```
<java-type name="Work">
  <java-attributes>
    <xml-element java-attribute="relationList" xml-path="."/>
  </java-attributes>
</java-type> 
```

我得到以下异常

```
Caused by: java.lang.NullPointerException
    at java.io.Writer.write(Writer.java:140)
    at org.eclipse.persistence.oxm.record.JSONWriterRecord.writeKey(JSONWriterRecord.java:580)
    at org.eclipse.persistence.oxm.record.JSONFormattedWriterRecord.openStartElement(JSONFormattedWriterRecord.java:147)
    at org.eclipse.persistence.internal.oxm.XPathNode.startElement(XPathNode.java:359)
    at org.eclipse.persistence.internal.oxm.XMLCompositeCollectionMappingNodeValue.marshalSingleValue(XMLCompositeCollectionMappingNodeValue.java:292)
    at org.eclipse.persistence.internal.oxm.XMLCompositeCollectionMappingNodeValue.marshal(XMLCompositeCollectionMappingNodeValue.java:91)
    at org.eclipse.persistence.internal.oxm.NodeValue.marshal(NodeValue.java:151)
    at org.eclipse.persistence.internal.oxm.NodeValue.marshal(NodeValue.java:104)
    at org.eclipse.persistence.internal.oxm.record.ObjectMarshalContext.marshal(ObjectMarshalContext.java:60)
    at org.eclipse.persistence.internal.oxm.XPathNode.marshal(XPathNode.java:350)
    at org.eclipse.persistence.internal.oxm.TreeObjectBuilder.buildRow(TreeObjectBuilder.java:467)
    at org.eclipse.persistence.internal.oxm.XMLCompositeCollectionMappingNodeValue.marshalSingleValue(XMLCompositeCollectionMappingNodeValue.java:299)
    at org.eclipse.persistence.internal.oxm.XMLCompositeCollectionMappingNodeValue.marshal(XMLCompositeCollectionMappingNodeValue.java:91)
    at org.eclipse.persistence.internal.oxm.NodeValue.marshal(NodeValue.java:151)
    at org.eclipse.persistence.internal.oxm.NodeValue.marshal(NodeValue.java:104)
    at org.eclipse.persistence.internal.oxm.record.ObjectMarshalContext.marshal(ObjectMarshalContext.java:60)
    at org.eclipse.persistence.internal.oxm.XPathNode.marshal(XPathNode.java:350)
    at org.eclipse.persistence.internal.oxm.TreeObjectBuilder.buildRow(TreeObjectBuilder.java:467)
    at org.eclipse.persistence.internal.oxm.XMLCompositeObjectMappingNodeValue.marshalSingleValue(XMLCompositeObjectMappingNodeValue.java:224)
    at org.eclipse.persistence.internal.oxm.XMLCompositeObjectMappingNodeValue.marshal(XMLCompositeObjectMappingNodeValue.java:144)
    at org.eclipse.persistence.internal.oxm.NodeValue.marshal(NodeValue.java:104)
    at org.eclipse.persistence.internal.oxm.record.ObjectMarshalContext.marshal(ObjectMarshalContext.java:60)
    at org.eclipse.persistence.internal.oxm.XPathNode.marshal(XPathNode.java:350)
    at org.eclipse.persistence.internal.oxm.TreeObjectBuilder.buildRow(TreeObjectBuilder.java:467)
    at org.eclipse.persistence.oxm.XMLMarshaller.marshal(XMLMarshaller.java:1074)
    at org.eclipse.persistence.oxm.XMLMarshaller.marshal(XMLMarshaller.java:689)
    at org.eclipse.persistence.oxm.XMLMarshaller.marshal(XMLMarshaller.java:602)
    at org.eclipse.persistence.jaxb.JAXBMarshaller.marshal(JAXBMarshaller.java:584) 
```

我想我理解这个问题。因为 Relation-List 元素同时包含关系元素和目标类型属性，所以直接转换为 json 需要关系列表元素来封装这两个元素，即我认为如果 Relation-List 元素没有目标类型属性在模型中它不会有问题。

但是我无论如何都不想输出目标类型，所以它应该可以工作，有没有办法解决这个问题？

**编辑：** 感谢您的回答，但它似乎与我正在做的事情相同，除了我尝试过的示例代码可以正常工作。我尝试在示例代码中添加更多元素以尝试破坏它但没有成功。

我最初的问题显示了一个比现实更简单的情况，所以在下面我实际上输出了完整的输出，以防有人可以看到可能导致问题的原因

```
{
   "count" : 1,
   "offset" : 0,
   "work" : [ {
      "id" : "4ff89cf0-86af-11de-90ed-001fc6f176ff",
      "type" : "Opera",
      "score" : "100",
      "title" : "Symphony No. 5",
      "language" : "eng",
      "iswcs" : [ "T-101779304-1", "B-101779304-1" ],
      "disambiguation" : "demo",
      "aliases" : [ "Symp5" ],
      "relation-list" : [ {
         "relations" : [ {
            "type" : "composer",
            "direction" : "backward",
            "attributes" : [ "additional" ],
            "artist" : {
               "id" : "1f9df192-a621-4f54-8850-2c5373b7eac9",
               "name" : "Пётр Ильич Чайковский",
               "sort-name" : "Пётр Ильич Чайковский"
            }
         }, {
            "type" : "writer",
            "direction" : "backward",
            "artist" : {
               "id" : "abcdefgh-a621-4f54-8850-2c5373b7eac9",
               "name" : "frank",
               "sort-name" : "turner"
            }
         } ]
      } ],
      "tags" : [ {
         "count" : 10,
         "name" : "classical"
      } ]
   } ]
} 
```

工作正常，但添加

```
<java-type name="Work">
    <java-attributes>
        <xml-element java-attribute="relationList" xml-path="."/>
    </java-attributes>
</java-type> 
```

导致堆栈跟踪。

也许堆栈跟踪包含解决方案

**更新**

完整的项目可在线获取

数据模型在[http://svn.musicbrainz.org/mmd-schema/trunk/brainz-mmd2-jaxb/](http://svn.musicbrainz.org/mmd-schema/trunk/brainz-mmd2-jaxb/) 下载并运行 mvn install

然后使用这个的项目在[http://svn.musicbrainz.org/search_server/trunk/](http://svn.musicbrainz.org/search_server/trunk/) 下载并运行 mvn 包，

这包含三个子项目，问题之一是 servlet 项目，以复制问题：

光盘小服务程序

编辑 src/main/resources/oxml.xml 更改

```
<xml-element java-attribute="relationList" name="relationList"/> 
```

至

```
<xml-element java-attribute="relationList" xml-path="."/> 
```

mvn包

src/test/java/org/musicbrainz/search/servlet/FindWorkTest 现在将在 testOutputAsJsonNew() 和 testOutputAsJsonNewPretty() 上失败

**进一步更新** Blaise 解决了示例没有显示的问题（我不知道）你实际上可以有多个关系列表元素，即 Xml 可能是

```
<worklist>
    <work>
        <relation-list target-type="artist">
            <relation type="composer">
                <name>Jane Doe</name>
                <sort-name>Doe Jane</sort-name>
            </relation>
            <relation type="writer">
                <name>Frank Turner</name>
                <sort-name>Turner Frank</sort-name>
            </relation>
        </relation-list>
        <relation-list target-type="release">
            <relation type="cover">
                <name>Hey Jude</name>
                <sort-name>Hey Jude</sort-name>
            </relation>
        </relation-list>
    </work>
</worklist> 
```

我想要输出的是

```
{
   "work" : [ {
         "relations" : [ {
            "type" : "composer",
            "name" : "Jane Doe",
            "sort-name" : "Doe Jane"
         }, {
            "type" : "writer",
            "name" : "Frank Turner",
            "sort-name" : "Turner Frank"
         }, {
            "type" : "cover",
            "name" : "Hey Jude",
            "sort-name" : "Hey Jude"
         } ]
   } ]
} 
```

而我能得到的最好的

```
{
   "work" : [ {
      "relationLists" : [ {
         "relations" : [ {
            "type" : "composer",
            "name" : "Jane Doe",
            "sort-name" : "Doe Jane"
         }, {
            "type" : "writer",
            "name" : "Frank Turner",
            "sort-name" : "Turner Frank"
         } ]
      }, {
         "relations" : [ {
            "type" : "cover",
            "name" : "Hey Jude",
            "sort-name" : "Hey Jude"
         } ]
      } ]
   } ]
} 
```

所以本质上我想合并所有的关系，这样它们就在一个列表中并丢失了关系列表标签。我们合并了不同的关系列表并丢弃了标识每个关系列表的目标类型属性，但我们不需要能够识别这些子列表，这可能看起来很奇怪。

是否有可能做到这一点 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T11:57:30.967

**更新#2**

根据调查结果，我更新了示例代码以使用 an`XmlAdapter`而不是`.`XPath。这种方法将更适合您的用例。

* * *

**更新#1**

从堆栈跟踪看来，您可能正在对不允许的集合属性设置 self (".") XPath（我们将更改代码以便抛出更好的异常）。

在`Work`类中，您有一个名为的集合属性`relationList`

```
@XmlElement(name = "relation-list")
protected List<RelationList> relationList; 
```

出现问题是因为在元数据文件中您试图`xml-path`将`'.'`.

```
<xml-element java-attribute="relationList" xml-path="."/> 
```

相反，您需要在`'.`引用包含集合的对象的属性上使用 ' 路径。请参见下面的示例：

* * *

**XML 适配器**

代替使用`.`XPath，您的用例将由`XmlAdapter`. An`XmlAdapter`允许我们将一个对象结构转换为另一个更好地映射到所需输入/输出的对象结构。对于这个用例，`XmlAdapter`它将看起来像。

```
package forum12338288;

import java.util.*;
import javax.xml.bind.annotation.adapters.XmlAdapter;

public class WorkAdapter extends XmlAdapter<WorkAdapter.AdaptedWork, Work> {

    public static class AdaptedWork {
        public List<Relation> relations = new ArrayList<Relation>();
    }

    @Override
    public AdaptedWork marshal(Work work) throws Exception {
        AdaptedWork adaptedWork = new AdaptedWork();
        for(RelationList relationList : work.relationList) {
            for(Relation relation : relationList.relation) {
                adaptedWork.relations.add(relation);
            }
        }
        return adaptedWork;
    }

    @Override
    public Work unmarshal(AdaptedWork adaptedWork) throws Exception {
        Work work = new Work();
        RelationList relationList = new RelationList();
        for(Relation relation : adaptedWork.relations) {
            relationList.relation.add(relation);
        }
        work.relationList.add(relationList);
        return work;
    }

} 
```

* * *

**绘图文件**

您的映射文档应如下所示：

**oxm.xml**

```
<?xml version="1.0"?>
<xml-bindings
    xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    package-name="forum12338288">
    <java-types>
        <java-type name="WorkList">
            <java-attributes>
                <xml-element java-attribute="work">
                    <xml-java-type-adapter value="forum12338288.WorkAdapter"/>
                </xml-element>
            </java-attributes>
        </java-type>
        <java-type name="RelationList">
            <java-attributes>
                <xml-transient java-attribute="targetType"/>
                <xml-element java-attribute="relation" name="relations"/>
            </java-attributes>
        </java-type>
    </java-types>
</xml-bindings> 
```

* * *

**演示代码**

下面的演示代码演示了如何利用映射文档来读取 XML 并输出所需的 JSON。

***演示***

```
package forum12338288;

import java.io.File;
import java.util.*;
import javax.xml.bind.*;
import org.eclipse.persistence.jaxb.JAXBContextProperties;

public class Demo {

    public static void main(String[] args) throws Exception {
        // XML
        JAXBContext jc = JAXBContext.newInstance(WorkList.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum12338288/input.xml");
        WorkList workList = (WorkList) unmarshaller.unmarshal(xml);

        // JSON
        Map<String, Object> properties = new HashMap<String, Object>();
        properties.put(JAXBContextProperties.OXM_METADATA_SOURCE, "forum12338288/oxm.xml");
        properties.put(JAXBContextProperties.MEDIA_TYPE, "application/json");
        properties.put(JAXBContextProperties.JSON_INCLUDE_ROOT, false);
        JAXBContext jsonJC = JAXBContext.newInstance(new Class[] {WorkList.class}, properties);

        Marshaller marshaller = jsonJC.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(workList, System.out);
    }

} 
```

***输入.xml***

```
<worklist>
    <work>
        <relation-list target-type="artist">
            <relation type="composer">
                <name>Jane Doe</name>
                <sort-name>Doe Jane</sort-name>
            </relation>
            <relation type="writer">
                <name>Frank Turner</name>
                <sort-name>Turner Frank</sort-name>
            </relation>
        </relation-list>
        <relation-list target-type="release">
            <relation type="cover">
                <name>Hey Jude</name>
                <sort-name>Hey Jude</sort-name>
            </relation>
        </relation-list>
    </work>
</worklist> 
```

***输出***

```
{
   "work" : [ {
      "relations" : [ {
         "type" : "composer",
         "name" : "Jane Doe",
         "sort-name" : "Doe Jane"
      }, {
         "type" : "writer",
         "name" : "Frank Turner",
         "sort-name" : "Turner Frank"
      }, {
         "type" : "cover",
         "name" : "Hey Jude",
         "sort-name" : "Hey Jude"
      } ]
   } ]
} 
```

* * *

**JAVA模型**

下面是我用来确保一切正常的 Java 模型。

***工作清单***

```
package forum12338288;

import java.util.List;
import javax.xml.bind.annotation.*;

@XmlRootElement(name="worklist")
@XmlAccessorType(XmlAccessType.FIELD)
public class WorkList {

    List<Work> work;

} 
```

***工作***

```
package forum12338288;

import java.util.*;

import javax.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
public class Work {

    @XmlElement(name="relation-list")
    List<RelationList> relationList = new ArrayList<RelationList>();

} 
```

***关系表***

```
package forum12338288;

import java.util.List;

import javax.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
public class RelationList {

    @XmlAttribute(name="target-type")
    String targetType;

    List<Relation> relation;

} 
```

***关系***

```
package forum12338288;

import javax.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
public class Relation {

    @XmlAttribute
    String type;

    String name;

    @XmlElement(name="sort-name")
    String sortName;

} 
```

***jaxb.properties***

要将 MOXy 指定为您的 JAXB 提供程序，您需要包含一个`jaxb.properties`在与域模型相同的包中调用的文件，其中包含以下条目（请参阅： [http ://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as -your.html](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html) )。

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

# python - TypeError：“builtin_function_or_method”对象不可订阅？

> ID：12338294
> 
> 赞同：0
> 
> 时间：2012-09-09T10:26:23.633
> 
> 标签：python, text, types

嗨，我遇到了一个问题，我不明白为什么会出现类型错误，请解释它是什么以及如何解决它提前谢谢！

```
abb = raw_input("Abbreviation: ")
text = raw_input("Text: ")
text = text.lower().split()
abb = abb.lower().split
list1 = []
i = 0
j = 0

while i < len(text):
    for i in range(len(text)):
        if text[i].startswith(abb[0]):
            list1.append(text[i])
            for i in range(len(text)):
                if text[i].startswith(abb[1]):
                    list1.append(text[i])
                    for i in range(len(text)):
                        if text[i].startswith(abb[2]):
                            list1.append(text[i]) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-09T10:30:49.490

查看您的线路

```
abb = abb.lower().split 
```

（并将其与上面的正确线进行比较）。您不调用该函数，只需将其分配给与方法本身`abb`相同的对象。`split`

因此，当您尝试时`abb[0]`，它会尝试为函数本身下标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T10:29:04.000

更改`abb = abb.lower().split`为`abb = abb.lower().split()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T10:30:00.747

这意味着在您的代码中使用方括号表示法（即“下标”一个可迭代对象）的某个时刻，该事物是不可迭代的。在某个你认为你有一个字符串的地方，你实际上有一个函数。

无论如何，这就是错误消息告诉您的内容。当您像这样调试一些代码时，只需将大量打印语句放入其中，看看哪里出了问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T12:39:15.773

在第 4 行，你把

```
abb = abb.lower().split 
```

这将为您提供小写 abb 字符串的拆分函数，而不是调用它。只需将上面的代码更改为：

```
abb = abb.lower().split() 
```

就像您在上一行中使用字符串文本处理代码一样。

# c# - 在十进制的 RDLC 报告中使用 SUM 会产生奇怪的结果

> ID：12338301
> 
> 赞同：5
> 
> 时间：2012-09-09T10:28:12.107
> 
> 标签：c#, rdlc

我正在尝试生成一个 RDLC 报告，其中一列 Amount 将在底部有一个“总计”行。这不是什么奇怪的东西，它是一个非常基本的 RDLC 报告，但是我没有在底部获得正常的“总”值，而是得到了其他东西，请允许我演示一下：

![在此处输入图像描述](../Images/dc0c867c85244a9738dfc965b28f8590.png)

它不应该说 97,140.00，应该说 971,40，所以我有点困惑。专栏总结如下：

**=总和（CDec（字段！金额。值））**

由于某种原因，我必须先转换它，否则我会得到 #Error 而不是错误的数字。这很奇怪，模型属性是小数，而我使用的 DataTable 属性是小数。

我唯一的猜测是，这与我是瑞典语并使用逗号作为小数分隔符而不是句点有关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T11:11:45.487

问题显然出在 CDec 函数中。如果您确定没有其他方法可以不使用 CDec，请尝试以下操作：CDec(Sum(Fields!Oil_Gas.Value)) 或此：FormatNumber(CDec(Sum(Fields!Oil_Gas.Value)),2) 或此： FormatNumber(Sum(Fields!Oil_Gas.Value),2)

我无法真正重现您的问题，但所有提到的解决方案都对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-10-23T07:39:20.783

这个解决方案对我有用。试试这个

```
=ROUND(Sum(Fields!Outros.Value, "DataSet1"),2) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T11:23:33.933

解决了问题，因为错误在**数据表**中。当我生成要放入的数据表时，我没有设置 DataColumn**类型**，所以它们都默认为字符串。出于某种原因，即使数据表将它们作为字符串处理，CDec() 和 FormatNumber() 也不起作用。

无论如何，在为它工作的每一列正确创建具有正确数据类型的数据表之后。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-13T23:09:05.063

试试这个表达式，它对我有用：

```
=Format(Sum(CDec(Fields!Outros.Value)),"#,##0.00") 
```

# javascript - 如何使浏览器在单个页面布局上来回工作？

> ID：12338302
> 
> 赞同：4
> 
> 时间：2012-09-09T10:28:14.030
> 
> 标签：javascript, html, browser, cross-browser, user-experience

作为后续问题：[进行水平滑动布局的最有效方法](https://stackoverflow.com/questions/12221141/most-efficient-way-to-do-a-horizontal-sliding-layout)，是否可以在使用这样的单页布局时使浏览器的后退和前进按钮工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T10:31:48.093

您可以使用 HTML5 中的历史 API 来实现这一点。

以下是一些帮助您入门的资源：

*   [http://diveintohtml5.info/history.html](http://diveintohtml5.info/history.html)
*   [http://html5demos.com/history](http://html5demos.com/history)
*   [https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)

为了在较旧的浏览器中也获得支持，有一些 JavaScript 库可以实现这一点：

*   [https://github.com/browserstate/History.js/](https://github.com/browserstate/History.js/)

Chrome 团队的高级示例，它使用了历史 API：

*   [http://www.20thingsilearned.com/en-US](http://www.20thingsilearned.com/en-US)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T10:32:06.347

是的，您可以使用 HTML5 历史 API 来实现它。

*   演示：[http ://html5demos.com/history](http://html5demos.com/history)
*   文档：[http ://diveintohtml5.info/history.html](http://diveintohtml5.info/history.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T11:24:07.523

以较旧的方式，您可以尝试使用书签，例如

```
 <html>
    <head>
        <script type="text/javascript">
            function goPage (v) {
                var idisplay = v == 'i',
                    adisplay = v == 'a',
                    bdisplay = v == 'b';
                document.getElementById('anchor_i').style.display = idisplay? 'none' : 'block';
                document.getElementById('anchor_a').style.display = adisplay? 'none' : 'block';
                document.getElementById('anchor_b').style.display = bdisplay? 'none' : 'block';

                document.getElementById('content_i').style.display = idisplay? 'block' : 'none';
                document.getElementById('content_a').style.display = adisplay? 'block' : 'none';
                document.getElementById('content_b').style.display = bdisplay? 'block' : 'none';
            }
        </script>
    </head>
    <body>
        <a name="index"></a>
        <div id="content_i">
            index
        </div>

        <a id="anchor_i" href="#index" onclick="goPage('i');" style="display: none">to index</a>
        <a id="anchor_a" href="#page_a" onclick="goPage('a');">to page_a</a>
        <a id="anchor_b" href="#page_b" onclick="goPage('b');">to page_b</a>

        <a name="page_a"></a>
        <div id="content_a" style="display: none">
            page a
        </div>
        <a name="page_b"></a>
        <div id="content_b" style="display: none;">
            page b
        </div>
    </body>
</html> 
```

# iframe - 将 iframe 嵌入 HTML5 Canvas

> ID：12338306
> 
> 赞同：0
> 
> 时间：2012-09-09T10:28:30.177
> 
> 标签：iframe, canvas

对于我正在处理的项目，我正在考虑在 HTML5 画布元素中加载 iframe。

有人会知道这样做涉及的任何限制/发布吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:59:24.460

您不能在画布“中”加载 iframe。我假设您的意思是在 iframe 中加载画布？

这应该没有问题。将画布视为动态图像。

# mysql - MySQL datediff() 函数总是返回相同的结果，无论其值如何

> ID：12338308
> 
> 赞同：1
> 
> 时间：2012-09-09T10:28:35.060
> 
> 标签：mysql, phpmyadmin

我正在运行以下查询，但似乎无法让`datediff()`过滤器工作。查询成功执行，但即使我将其更改`datediff()`为不同的值，我仍然得到相同的结果。

```
SELECT project_id
     , google_rank
     , COALESCE(
        ( SELECT google_rank
            FROM eig_ranking mi
           WHERE mi.project_id = m.project_id
           ORDER BY project_id limit 1
                 )
         , 0) - google_rank AS movement
     , keyword
     , domain
  FROM eig_ranking m
 WHERE (DATEDIFF(rank_date, NOW())) / 7 <= 12
   AND google_rank != 0
 ORDER BY movement DESC 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T18:36:51.383

感谢您的回复。我想到了。我不确定它是否是 MYSQL 错误或文档错误，但将 datediff() 函数中的变量交换为 DATEDIFF(NOW(), rank_date) 使其适用于我的所有查询并且结果都是正确的

# c# - 无法将样式触发器属性设置为自定义依赖属性

> ID：12338310
> 
> 赞同：0
> 
> 时间：2012-09-09T10:28:40.150
> 
> 标签：c#, wpf, xaml, triggers, dependency-properties

我在使用我的 usercontrol 的 xaml 文件时遇到了另一个问题 -.-'

我试图为`IsChecked`我的自定义按钮实现一个属性，以便在选中按钮时设置不同的背景颜色。

所以我创建了一个`DependencyProperty`这样的：

```
public static readonly DependencyProperty IsCheckedProperty = DependencyProperty.Register("IsChecked", typeof(bool), typeof(LeftMenuBtn));

public bool IsChecked
{
    get { return (bool)GetValue(IsCheckedProperty); }
    set { SetValue(IsCheckedProperty, value); }
} 
```

然后我设置了一个新的样式触发器来处理这个属性：

```
<Style x:Key="ButtonEnableStates" TargetType="{x:Type Grid}">
    <Style.Triggers>
        <Trigger Property="IsChecked" Value="True">
            <Setter Property="Background" Value="{DynamicResource CheckedStateGradient}" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

Expression Blend 现在强调`Property="IsChecked"`并说：

`The member "IsChecked" is not recognized or is not accessible.`

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:39:26.173

好吧，`Style`'s`TargetType`是`Grid`并且属性是为 定义的`LeftMenuBtn`，不会像那样工作。

# eclipse - 如何离线安装eclipse插件？

> ID：12338311
> 
> 赞同：1
> 
> 时间：2012-09-09T10:28:45.683
> 
> 标签：eclipse, plugins, eclipse-plugin, eclipse-rcp

我如何知道并下载所有插件依赖项，以便以后离线安装

无需互联网

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T14:29:29.073

您可以使用[p2 镜像](http://help.eclipse.org/juno/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/p2_mirror.html&cp=2_0_20_3_0)工具来创建所需 p2 存储库的本地副本。然后您可以稍后离线安装它。

我使用 ant 镜像脚本来镜像 p2 存储库（例如：[mirror-jface.xml](http://git.eclipse.org/c/e4/org.eclipse.e4.releng.git/tree/org.eclipse.e4.builder/builder/general/mirror-jface.xml)），它们可以像这样运行：

```
bash$ eclipse/eclipse -noSplash \
-application org.eclipse.ant.core.antRunner \
-DbaseDir=/some/useful/basedir -buildfile mirror-jface.xml 
```

您必须指定要搜索的所有存储库才能获取所有依赖项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T10:02:11.367

如果您从在线安装插件开始，则打开以下视图：

```
Window->Show View->Other->Plug-in Development->Plug-in Registry 
```

在该视图中找到您感兴趣的插件，展开它们，并记下“先决条件”部分下的所有插件。请注意，它仅列出了直接依赖项，因此您可能需要按照这些内容查找整个依赖项层次结构。

相当手动的过程，希望其他人可以指出一种更简单的方法，但这应该会给你一个完整的插件列表，然后你可以离线安装。

# actionscript-3 - AS3 - MovieClip 中的按钮触发 MC 的事件

> ID：12338320
> 
> 赞同：2
> 
> 时间：2012-09-09T10:29:37.227
> 
> 标签：actionscript-3, button, mouseevent, movieclip

在舞台上，我有一个名为“mc”的电影剪辑，里面画了一个简单的矩形。mc 还有一个名为“btn”的子按钮，它是另一个简单的矩形（明显小于 mc 的矩形）。然后我在舞台上有这个代码。

```
function mcDown( _e:MouseEvent):void{
    trace( "mc" );
}
function btnClick( _e:MouseEvent):void{
    trace( "btn" );
}
mc.addEventListener( MouseEvent.MOUSE_DOWN, mcDown );
mc.btn.addEventListener( MouseEvent.CLICK, btnClick ); 
```

我遇到的问题是当单击按钮时，mcDown 事件也被触发并跟踪“mc”和“btn”。

我怎样才能做到这一点，当我单击按钮时，它只会触发 btnClick 而不会触发 mcDown？我试过 MOUSE_UP 而不是 CLICK，同样的问题。并且 mcDown 事件必须保持 MOUSE_DOWN。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T11:55:01.097

除了在 dispatchEvent 中将 bubbles 参数设置为 false 之外，没有其他方法可以防止冒泡。

```
dispatchEvent(EVENT_TYPE, BUBBLES,....); 
```

但是，您可以通过检查来避免冒泡。只需将下面的行作为侦听器函数的第一行，它就可以避免从除目标之外的所有对象调度的事件。

```
if(e.eventPhase != EventPhase.AT_TARGET) return; 
```

因此，对于您的示例代码，当您单击按钮时，两个事件都会分派，但在**mcDown**函数中，它不会在上述行之后执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:40:35.363

如果在 MC 中添加按钮，并且单击按钮，您也单击了 MC，因为按钮下方的 MC 部分仍然存在，它运行整个 MC 的功能，您可以不要删除它。

所以最好创建一个函数来检查按钮是否被按下，否则它将为整个 MC 运行该函数。

这个应该做。

```
//add this in you constructor

mc.addEventListener(MouseEvent.MOUSE_DOWN, myReleaseFunc);
function myReleaseFunc(e:MouseEvent):void {
    if(e.currentTarget.name == Btn1) //Btn1 is instance name for a button
    {
         Btn_func1();
    }
    else if(e.currentTarget.name == Btn2) //Btn2 is another button.
    {
         Btn_func2();
         //For every button you'll need to add another function and if statement to check if that button was clicked.
    }
    else
    {
         Mc_func();
    }

} 

// this outside the main class

function Mc_func():void{
    //you code here
}
function Btn_func1():void{
    //you code here
}
function Btn_func2():void{
    //you code here
} 
```

我认为这种方式效率更高，并且会更好更快地工作，并且系统过载的机会要小得多。

# sql - 简单的子选择

> ID：12338321
> 
> 赞同：-1
> 
> 时间：2012-09-09T10:29:53.803
> 
> 标签：sql

嗨，这些天不要做大量的 sql，所以很难完成一个简单的任务

我有 table-A，它有一个名为 table-B-ids 的字段，它看起来像一个数组 =1、4、5 等。

我有table-B，它有table-B-id 作为主键

我想要做的是从表-A 中选择，然后使用表-B-ids 从表-B 中获取所有记录，可能使用子选择

```
select fields 
from table-A 
where id=1 (select fields from table-B where table-B-id IN table-B-ids) 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:48:54.803

您可以使用 join 代替，如下所示：

select A.[B-ids], B.* from [table-A] A join [table-B] B on A.[B-ids]=B.[table-B-id]

# asp.net-mvc - 在 ASP.NET MVC Razor 视图中转换 @helper 的输出

> ID：12338325
> 
> 赞同：0
> 
> 时间：2012-09-09T10:30:33.327
> 
> 标签：asp.net-mvc, razor, view-helpers

是否可以在@helper 的输出上实现自定义转换？我的意思是要找到一个解决方案，让我有一些类似的东西：

```
@helper RenderCombinedStylesheetsWithColorOverride(string color)
{
    <link rel="stylesheet" type="text/css" href="menu.css" />
    <link rel="stylesheet" type="text/css" href="site.css" />
    <style type="text/css">
        * { color: @color; }
    </style>
} 
```

扭曲是在助手的名称（RenderCombinedStylesheets...），它暗示了我想在这里做什么。也就是说，获取帮助程序的正常 HTML 编码输出，并将其通过我的自定义代码传递。在那里，我想把它拆开，然后重新组装，以便最终输出是`<link rel="stylesheet" ... />`对生成的组合和缩小 css 文件的单个引用。

**请注意，这是一个简化的示例！**实际上，有多个参数，并且输出转换不​​仅限于组合样式表片段。我也想以这种方式生成 JavaScript 代码。

主要目标是想出一些东西，让我可以**将普通的 Razor 模板应用到**我的视图的特定部分，**然后**在发出最终输出之前对这些部分执行额外的转换。

任何想法表示赞赏！

**更新**：我偶然发现了[这个](https://stackoverflow.com/questions/5433531/using-sections-in-editor-display-templates)SO question，这表明实现这一点的方法是通过普通的 HtmlHelper 扩展。看来我对他们的所作所为并不完全了解，或者至少低估了他们的力量。我将报告实施情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:19:45.903

是的！我在更新的问题中链接的帖子是正确的！这是解决方案：

```
public static class ResourceCombiningHelper
{
    private static string MakeKey(string type)
    {
        return "CombinableResource" + (type ?? "").ToLowerInvariant();
    }

    public static IHtmlString CombinableResource(this HtmlHelper helper, dynamic template, string type)
    {
        var key = MakeKey(type);
        var context = helper.ViewContext.HttpContext;
        var resources = (List<dynamic>)context.Items[key];

        if (resources == null)
        {
            resources = new List<dynamic> { template };
            context.Items[key] = resources;
        }
        else
        {
            resources.Add(template);
        }

        return new HtmlString(String.Empty);
    }

    public static IHtmlString RenderCombinableResources(this HtmlHelper helper, string type)
    {
        var key = MakeKey(type);
        var context = helper.ViewContext.HttpContext;
        var resources = (List<dynamic>)context.Items[key];

        if (resources != null)
        {
            foreach (var resource in resources)
            {
                if (resource is HelperResult)
                {
                    // Add in-line content to combined resource here.
                }
                else if (resource is string)
                {
                    // Add external reference to combined resource here.
                }
            }
        }

        // Return a single reference to the combined resource (<link>, <script>, etc.)
    }
} 
```

Razor 视图中的用法：

```
@helper ColorOverridingStyle(string color)
{
    <style type="text/css">
        * { color: @color; }
    </style>
}

@{ var color = ViewBag.TextColor; }
@Html.CombinableResource(Url.Content("~/Content/site.css"), "css")
@Html.CombinableResource(Url.Content("~/Content/menu.js"), "js")
@Html.CombinableResource(ColorOverridingStyle(color), "css") 
```

最后的 HTML 输出示例：

```
<head>
    <link href="/Content/combined-css.css" rel="stylesheet" type="text/css" />
    <script src="/Content/combined-js.js" type="text/javascript"></script>
</head> 
```

效果很好！去扩展这个小宝石的极限...... :)

# iphone - 自定义警报应用程序在本地通知中断时从媒体库播放声音

> ID：12338336
> 
> 赞同：0
> 
> 时间：2012-09-09T10:32:17.160
> 
> 标签：iphone, objective-c, ios5

我想制作自定义警报应用程序，它可以从 iphone 的媒体库中播放声音。在本地通知中断时在用户选择的日期播放声音。

[我想要与应用商店上的应用类似的应用](http://itunes.apple.com/pl/app/alarm-clock%2a/id514529508?mt=8&ls=1)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:49:02.390

考虑阅读 iOS App Programming Guide -> App States and Multitasking：http:
[//developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html)

阅读以下部分：*“实现长时间运行的后台任务”*和**播放后台音频**

你不能用普通的本地通知来做到这一点，因为它们有 30 秒的限制，你不能让用户选择文件。您必须将其导入您的应用程序包并将其包含在您的代码中！！！

我真的认为除了滥用后台音频播放系统来让您的应用程序在后台运行，然后在没有声音的情况下显示本地通知并使用系统库（核心音频等...）

# cordova - PhoneGap - 后退按钮上的 android 退出

> ID：12338337
> 
> 赞同：41
> 
> 时间：2012-09-09T10:32:22.980
> 
> 标签：cordova, back-button

我正在尝试使用 jquery mobile 和 cordova 对 RSS 阅读器进行编程。我的 RSS 阅读器由 3 页组成（在同一个 HTML 文档中：page1、page2、page3）。我正在尝试覆盖（硬件）后退按钮行为，以便退出程序。为了检查我在项目设置中没有犯任何错误，我使用了 PhoneGap 示例项目并将其加载到 Eclipse 中。每个示例函数都有效，因此我将 index.html 和 res 文件夹移至 phonegap 示例。在我的 index.html 中，我导入了以下脚本：

```
<script src="res/jquery-1.7.1.min.js"></script>
<script src="res/jquery.mobile-1.1.1.min.js"></script>
<script type="text/javascript" charset="utf-8" src="cordova-2.0.0.js"></script>
<script type="text/javascript" charset="utf-8" src="main.js"></script> 
```

我的 main.js 文件如下所示：

```
document.addEventListener("backbutton", function(e){
if($.mobile.activePage.is('#homepage')){
    e.preventDefault();
    navigator.app.exitApp();
}
else {
    navigator.app.backHistory()
}
}, false); 
```

您可以在第一个代码示例中检查我的脚本版本。关于如何让代码工作的任何想法，以便在我按下 Xperia Arc 上的后退按钮时它会简单地退出应用程序？如果需要，我可以上传我的完整代码。

编辑：我已经在我的 android 手机上测试了 phonegap(cordova) beep 功能，它可以工作，所以这没有任何脚本实现错误。它必须在 main.js 文件中。可能与 jquerymobile 后退按钮功能和 phonegap 后退按钮功能存在一些兼容性问题。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-09-11T15:04:18.177

您需要等待设备准备好添加事件侦听器：

```
document.addEventListener("deviceready", onDeviceReady, false);

function onDeviceReady(){
    document.addEventListener("backbutton", function(e){
       if($.mobile.activePage.is('#homepage')){
           e.preventDefault();
           navigator.app.exitApp();
       }
       else {
           navigator.app.backHistory();
       }
    }, false);
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-06-02T18:56:23.720

如果您不想使用任何库，可以使用 window.location.hash 来获取您的应用所在的“面板”。例子 ：

```
function onDeviceReady(){
    document.addEventListener("backbutton", function(e){
        if(window.location.hash=='#home'){
            e.preventDefault();
            navigator.app.exitApp();
        } else {
            navigator.app.backHistory()
        }
    }, false);
}
document.addEventListener("deviceready", onDeviceReady, false); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-05-29T22:15:08.520

如果您不想使用 Jquery Mobile，请将 @mornaner 答案上的 $.mobile.activePage.is('#homepage') 更改为 document.getElementById('#homepage') ，如下面的代码所示：

```
document.addEventListener("deviceready", onDeviceReady, false);

function onDeviceReady(){
    document.addEventListener("backbutton", function(e){
       if(document.getElementById('#homepage')){
           e.preventDefault();
           navigator.app.exitApp();
       }
       else {
           navigator.app.backHistory()
       }
    }, false);
} 
```

通过这种方式，不需要只为此目的下载Jquery Mobile 乱码。[此外，activePage 自 JQuery mobile 1.4.0 起已弃用，](http://api.jquerymobile.com/jQuery.mobile.activePage/)将从 1.5.0 中删除。（[改用 pagecontainer 小部件中的 getActivePage() 方法](http://api.jquerymobile.com/pagecontainer/#method-getActivePage)）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-24T21:31:10.493

要在 android 设备上禁用后退按钮的默认行为，只需为后退按钮注册一个事件处理程序。这将防止后退按钮关闭应用程序。

下面显示的代码专门用于 Framework7

```
$(document).on('page:beforeinit', function (e) {
if( $.fn.hyellaIMenu.mainView.history && $.fn.hyellaIMenu.mainView.history.length > 1 ){
    document.addEventListener( "backbutton", disableBackButton, false );
}
});

function disableBackButton( e ){
    if( $.fn.hyellaIMenu.mainView.history && $.fn.hyellaIMenu.mainView.history.length < 3 ){
        document.removeEventListener("backbutton", disableBackButton );
    }

if( $.fn.hyellaIMenu.mainView.history && $.fn.hyellaIMenu.mainView.history.length > 1 ){
    $.fn.hyellaIMenu.mainView.router.back();
}
}; 
```

要覆盖默认的后退按钮行为，请为后退按钮事件注册一个事件侦听器。

注意：不再需要调用任何其他方法来覆盖后退按钮行为。

[https://cordova.apache.org/docs/en/latest/cordova/events/events.html#backbutton](https://cordova.apache.org/docs/en/latest/cordova/events/events.html#backbutton)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-21T06:51:17.807

```
function onLoad() {
        document.addEventListener("deviceready", onDeviceReady, false);
    }

    //enter code here enter code heredevice APIs are available
    //enter code here
    function onDeviceReady() {
        // Register the event listener
        document.addEventListener("backbutton", onBackKeyDown, false);
    }

    // Handle the back button
    //
    function onBackKeyDown() {
    } 
```

# indexing - 删除 Lucene 中不存在的文档

> ID：12338340
> 
> 赞同：2
> 
> 时间：2012-09-09T10:32:56.103
> 
> 标签：indexing, lucene, document, delete-file

我创建了一个 Lucene 索引，我想知道如何删除计算机上尚不存在的文件索引条目。Lucene 有什么方法或者必须逐个文件打开文件并检查 java 吗？

编辑：

示例如下：我有一个包含 lucene 5 个文件索引的目录，当我物理删除一个文件时，我想更新要删除的索引，该索引记录了 lucene 索引。我所知道的是提高让您入门的逻辑，或者如果 Lucene 提供了一些自动执行此操作的选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-07T01:32:56.767

如果一个文件对应于一个 Lucene 文档，您可以在 Lucene 中删除该文档，从而将该文件从索引中删除。

# php - 从 url security 获取 id

> ID：12338342
> 
> 赞同：0
> 
> 时间：2012-09-09T10:33:02.280
> 
> 标签：php, mysql, get

我正在创建一个基本博客，并且正在使用以下代码。

它正在从 url 中收集 id（总是一个数字），在我使用之前，我想知道是否有人可以检查代码的安全性并让我知道它是否可以？

我真的不想要任何注射等，我想尽可能保证它的安全。

```
<?php
    if(is_numeric($_GET['id']) && $_GET['id'] > 0){

        include("connectionfile.php");

        $ia = intval($_GET['id']);
        $ib = mysql_real_escape_string($ia);
        $ic = strip_tags($ib);

        $qProfile = "SELECT * FROM #### WHERE id='$ic'  ";
        $rsProfile = mysql_query($qProfile);
        $row = mysql_fetch_array($rsProfile);
        extract($row);
        $title = trim($title);
        $post = trim($post);
        $date = trim($date);
        mysql_close();
    }else{
       echo 'hack error here';
    }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:36:54.583

```
$ia = intval($_GET['id']);
$ib = mysql_real_escape_string($ia);
$ic = strip_tags($ib); 
```

`strip_tags`没用，因为它只在 HTML 上下文中相关。其他两种方法中的任何一种都足以防止 SQL 注入。通常，只需为您正在处理的语言使用适当的转义机制。在这种情况下，您正在处理 SQL，所以`mysql_real_escape_string`单独使用就可以了。请参阅[The Great Escapism（或：使用文本](http://kunststube.net/escapism/)中的文本需要知道的内容），了解逐步的转义方法。

更好的是，使用准备好的语句而不是弃用的`mysql_`函数来学习 PDO，这样可以更好地解决 SQL 注入问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T10:37:35.007

1.  不要使用`mysql_`函数。它们已被弃用。使用 mysqli 或 PDO。
2.  使用*参数化查询*
3.  不要使用“提取”，因为它会污染本地范围。在极少数情况下它是安全的，通常在 ORM 内部，在对象中。否则这是很危险的，因为可能会引入所有形式的讨厌的变量名，尤其是在成功的 SQL 注入的情况下。
4.  进行异常处理，以便数据库错误不会完全破坏页面，并且在通过 SQL 注入以某种方式强制执行的错误查询的情况下，不会显示任何内容来指示查询被破坏。
5.  即使您完成了上述所有操作，在显示之前仍要确保使用`htmlentities()`或以其他方式验证数据是您所期望的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T10:57:20.303

这段代码一团糟；-)

1.  if 语句可以简化为 "if (($id = (int)$_GET['id']) > 0) {"
2.  如果您承认我的 1\. 点，则可以删除 $ia、$ib 和 $ic
3.  不要 trim() 数据库数据！在 INSERT 到数据库之前应该修剪数据。
4.  阅读@FilmJ 回答你的内容

# java - 获取所有图像 src 值而不仅仅是第一个？

> ID：12338347
> 
> 赞同：1
> 
> 时间：2012-09-09T10:34:05.370
> 
> 标签：java, android, image, jsoup

比如我有这一堆img标签，我想获取所有的src值。我怎样才能做到这一点？`Elements img = doc.select("img")`我当时试过了`String imgSrc = img.attr("src")`。结果是，我只得到了第一个 src。如何获取所有图像 src？

```
<img src="blah blah.jpg"></img>
<img src=".........jpg"></img>
...........
<img src="end.jpg></img> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:42:15.830

也许是这样的：

```
Elements images = doc.select("img[src]");

print("\nImages: (%d)", images.size());
for (Element src : images) {
        print(
            " * %s: <%s> %sx%s (%s)", 
            src.tagName(), src.attr("abs:src"), src.attr("width"), src.attr("height"),
            trim(src.attr("alt"), 20)
        );
} 
```

JSoup [Cookbook](http://jsoup.org/cookbook/extracting-data/example-list-links)可以帮助您！

装饰部分：

```
private static String trim(String s, int width) {
    if (s.length() > width)
        return s.substring(0, width-1) + ".";
    else
        return s;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T10:42:27.933

类`Elements`是一个集合。这意味着您应该能够简单地迭代它并获取它包含`src`的每个`<img>`元素的值。

尝试这个：

```
for(Element imgElement : img) {
    String imgSrc = imgElement("src");
} 
```

# events - JSF 2.1 preRenderEvent 不适用于 GET 请求

> ID：12338358
> 
> 赞同：0
> 
> 时间：2012-09-09T10:36:22.760
> 
> 标签：events, jsf, jsf-2

我无法让 preRenderView 事件侦听器处理 JSF 2.1 中的 GET 请求。

我发现了很多关于它的信息，但似乎没有任何效果，例如：
[JSF 中的条件重定向](https://stackoverflow.com/questions/8399045/conditional-redirection-in-jsf)
[http://andyschwartz.wordpress.com/2009/07/31/whats-new-in-jsf-2/#get-prerenderview-event](http://andyschwartz.wordpress.com/2009/07/31/whats-new-in-jsf-2/#get-prerenderview-event)
[http://developer.am/j2eetutorial/jsf/?page=jsf-2-prerenderviewevent-example](http://developer.am/j2eetutorial/jsf/?page=jsf-2-prerenderviewevent-example)
[JSF、Spring 和 PreRenderViewEvent](https://stackoverflow.com/questions/6842330/jsf-spring-and-the-prerenderviewevent)
[http://balusc.blogspot.dk/2011/09/communication-in-jsf-20 .html#ProcessingGETRequestParameters](http://balusc.blogspot.dk/2011/09/communication-in-jsf-20.html#ProcessingGETRequestParameters)

我有一个带有 4 个插入块的模板，我试图在所有这些地方插入事件代码，但没有任何运气。我已经尝试过使用和不使用 f:metadata 围绕它的标签。

```
<f:event type="preRenderView" listener="#{applicationData.redirectIfNoResults}" /> 
```

豆：

```
@ManagedBean
@ApplicationScoped
public class ApplicationData implements Serializable {
    public void redirectIfNoResults() throws IOException { 
        if (getTotal() < 1) { 
            ExternalContext ec = FacesContext.getCurrentInstance().getExternalContext(); 
            ec.redirect(ec.getRequestContextPath() + "/noResults.xhtml"); 
        } 
    } 
    ...
} 
```

模板：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core">
    <ui:insert name="beforeHeader" />
    <f:view>
        <ui:insert name="inView" />
    </f:view>
    <h:head>
        <meta http-equiv="cache-control" content="no-store" />
        <link href="style.css" rel="stylesheet" type="text/css" />
        <title>Quick Poll</title>
        <ui:insert name="header" />
    </h:head>
    <h:body>
        <h1>Quick Poll</h1>
        <ui:insert name="content" />
    </h:body>
</html> 
```

看法：

```
 <ui:define name="content">
        #{applicationData.question}?<p/>
        <h:panelGrid columns="3" border="0">
                Yes: 
                <h:panelGrid bgcolor="black" height="20" width="#{300*applicationData.yes/applicationData.total}"/>
                #{applicationData.yes}
                <h:outputText value="No:"/> 
                <h:panelGrid bgcolor="black" height="20" width="#{300*applicationData.no/applicationData.total}"/>
                #{applicationData.no}
        </h:panelGrid>
    </ui:define>
</ui:composition> 
```

**请帮我弄清楚如何让它工作..**

**更新 1：**
我按照 BalusC 的建议进行了更改，但仍然无法正常工作..

模板：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core">
    <h:head>
        <meta http-equiv="cache-control" content="no-store" />
        <link href="style.css" rel="stylesheet" type="text/css" />
        <title>Quick Poll</title>
        <ui:insert name="header" />
    </h:head>
    <h:body>
        <h1>Quick Poll</h1>
        <ui:insert name="content" />
    </h:body>
</html> 
```

看法：

```
<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:f="http://java.sun.com/jsf/core"
     template="template.xhtml">
    <ui:define name="content">
        <f:event listener="#{applicationData.redirectIfNoResults}" type="preRenderView"></f:event> 
        #{applicationData.question}?<p/>
        <h:panelGrid columns="3" border="0">
                Yes: 
                <h:panelGrid bgcolor="black" height="20" width="#{300*applicationData.yes/applicationData.total}"/>
                #{applicationData.yes}
                <h:outputText value="No:"/> 
                <h:panelGrid bgcolor="black" height="20" width="#{300*applicationData.no/applicationData.total}"/>
                #{applicationData.no}
        </h:panelGrid>
    </ui:define>
</ui:composition> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:08:47.160

这`<f:view>`没有正确使用，它必须包装*整个*视图。删除它（JSF 会隐式创建一个），或者至少让它包裹整个视图，包括`<h:head>`和`<h:body>`标签。

顺便说一句，`<f:event>`不需要进入`<f:metadata>`. 这仅适用于`<f:viewParam>`. 一个`<f:event>`依赖于结果的听众`<f:viewParam>`确实经常出于单独的自我记录目的*也*放置在同`<f:metadata>`一块中，但这不是`<f:event>`它自己的要求。

在你的情况下，把它放进去会更容易`<ui:define name="content">`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T11:56:35.220

方法签名中似乎缺少 ComponentSystemEvent。

方法需要如下所示：

```
public void newRequest(final ComponentSystemEvent event) {
System.out.println("Someone requested me");
} 
```

然后在模板或单独的视图中放置一个调用者，这不会有任何区别。

```
<f:event listener="#{userSessionAction.newRequest}" type="preRenderView"></f:event> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T13:42:59.637

我最终在视图范围 bean 中使用 PostConstruct 方法制作了一个解决方案。
像这样：[使用 JSF 2.0 在页面加载时使用参数初始化支持 Bean](https://stackoverflow.com/questions/6341462/initializng-a-backing-bean-with-parameters-on-page-load-with-jsf-2-0)

豆：

```
@ManagedBean 
@ViewScoped
public class ResultsController {
    @ManagedProperty(value="#{applicationData.total}")  
    private int total; 
    @ManagedProperty(value="#{applicationData.yes}")  
    private int yes; 
    @ManagedProperty(value="#{applicationData.no}")  
    private int no; 

    @PostConstruct 
    public void postConstruct() {
        if (getTotal() < 1) { 
            ExternalContext ec = FacesContext.getCurrentInstance().getExternalContext(); 
            try {
                ec.redirect(ec.getRequestContextPath() + "/noResults.jsf");
            } catch (IOException e) {
                System.out.println("noResults.jsf redirect failed.");
                e.printStackTrace();
            } 
        } 
    }
    ...
} 
```

看法：

```
<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:f="http://java.sun.com/jsf/core"
     template="template.xhtml">
    <ui:define name="content">
        #{applicationData.question}?<p/>
        <h:panelGrid columns="3" border="0">
                Yes: 
                <h:panelGrid bgcolor="black" height="20" width="#{300*resultsController.yes/resultsController.total}"/>
                #{resultsController.yes}
                <h:outputText value="No:"/> 
                <h:panelGrid bgcolor="black" height="20" width="#{300*resultsController.no/resultsController.total}"/>
                #{resultsController.no}
        </h:panelGrid>
    </ui:define>
</ui:composition> 
```

# html - 博客文章中的图片

> ID：12338364
> 
> 赞同：0
> 
> 时间：2012-09-09T10:37:17.613
> 
> 标签：html, css

我想在该部分定义我的图像的外观（我正在尝试为图像添加边框 - 但我无法直接引用图像，因为图像是动态添加的 - 作为博客文章的内容。）你能告诉我怎么做吗？我是否必须创建一个新的部分/id/div？我怎么能对机器说：在我创建的 section/id/div 中，我希望你将这些样式应用于图像。”？谢谢，D。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:38:55.553

如果内容是动态添加的，样式会在新内容添加到 DOM 时自动应用，您无需担心这一点。注入你想要的内容，只要有与该内容匹配的 CSS 规则，浏览器就会处理其余的。

**更新**

我意识到我一开始可能误解了你的问题。如果用户完全控制博客文章的标记，我想最好的方法是使用选择器，它选择包装每个博客文章的容器中的每个图像。

假设每篇博客文章都在一个带有 class 的元素中呈现`post`。然后你可以做这样的事情：

```
.post img {
   border: 1px solid #000;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T10:45:17.040

是的，您需要获得对图像或将在其中显示图像的块的引用。然后将 css 规则应用于图像或块，然后您将获得图像上的样式。`class=""`如果有很多并且`id=""`只有一个，我会更喜欢。

如果你在下面的任何元素中有 img，

```
<div class="someclass">
     <img src="" />
</div> 
```

然后在CSS，

```
.someclass{
    your rules go here.    
} 
```

或者如果您想直接在图像上设置样式，那么您的 HTMl 将如下所示，CSS 与上述相同。

```
<img class="someclass" src="" /> 
```

# css - 使用 Safari 6.0 在 Retina 显示器上以大尺寸正确呈现字体文本

> ID：12338365
> 
> 赞同：0
> 
> 时间：2012-09-09T10:37:17.800
> 
> 标签：css, fonts, safari, rendering, retina-display

我刚开始编写自己的网站，因为我喜欢印刷网页设计，所以我试图为徽标使用非常大的自定义字体。不幸的是，在我使用带有 Retina 显示器的 MacBook Pro 对 Safari 进行测试时，我注意到字体渲染中有一些伪影：/ 首先我认为我有一些错误，但后来我发现它发生在任何字体上，如果它是足够大...

[这种行为在诸如http://fittextjs.com](http://fittextjs.com)之类的网站上可见，其中标题的轮廓未正确呈现。对于没有视网膜显示器的任何人，这里是我正在谈论的内容的屏幕截图[http://cl.ly/JL0j](http://cl.ly/JL0j)

奇怪的是，Chrome 上不存在这个奇怪的错误，而且由于它们都是基于 Webkit 的，我认为后者可能使用了正确呈现文本的 CSS 默认值。

在我填写 rdar 之前，任何知道如何解决这种情况的 CSS 大师 :) 吗？

更新：我应该注意到我已经尝试过使用 -webkit-font-smoothing: antialiased; 它不起作用：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T10:33:49.960

我昨天填了一个关于它的雷达，今天得到了答案（从来没有这么快得到回应！）。

Apple 工程师已经意识到它并认为这是一个严重的错误，所以我希望它会尽快得到修复。与此同时，除了使用图像之外，没有其他可用的解决方法：/

# php - PHP - 回显受保护的类属性

> ID：12338368
> 
> 赞同：0
> 
> 时间：2012-09-09T10:37:35.067
> 
> 标签：php

对于这样的数据结构：

`Google_Maps_Bounds Object [min_lon:protected] => -124.15252917 [min_lat:protected] => 36.39249130`

你如何回显受保护的变量？

以下通常的方法似乎不起作用：

`echo $obj->'min_lon:protected' ;`

产生错误：

`'Parse error: syntax error, unexpected T_CONSTANT_ENCAPSED_STRING, expecting T_STRING or T_VARIABLE or '{' or '$' '`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:40:08.707

查看您正在使用的类的文档。它应该有一些您可以调用的*方法*来获取所需的数据，例如，`getMinLon()`或者类似的东西。您不能直接访问`protected`变量，这就是它们的`protected`用途。

# php - 在ajax中传递php文件

> ID：12338370
> 
> 赞同：0
> 
> 时间：2012-09-09T10:38:03.740
> 
> 标签：php, ajax

这是我的代码

```
<script>
$(document).ready(function() {

    // delete the entry once we have confirmed that it should be deleted

    $('.delete').click(function() {

        var parent = $(this).closest('tr');

        $.ajax({

            type: 'POST',

            url: 'delete.php', 

            data: 'ajax=1&delete=' + $(this).attr('id'),

            success: function() {

                parent.fadeOut(300,function() {

                    parent.remove();

                });

            }

        });        

    });

    $('.delete').confirm({

    });    

});

</script> 
```

我的问题是为什么 delete.php 没有执行？它在同一个文件夹中，我需要在这个文件中输入绝对 url 吗？但最好的是表中的行正在删除，但 php 文件没有执行。第二个问题是为什么这段代码没有这一行就不能工作：

```
 $('.delete').confirm({

        }); 
```

在 php 文件中，我知道它是否已执行：

```
<script>
alert('aaaa');
</script> 
```

甚至我已经改变它`echo 'something';`但仍然无法正常工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T11:42:55.367

我会添加一个错误处理程序来查看 ajax 调用发生了什么，如下所示：

```
error: function(jqXHR, textStatus, errorThrown) {
    console.log(errorThrown);
} 
```

请记住，ajax 调用会将当前目录附加到您设置的相对 uri 中。我假设您正在将请求发送到工作中的 Web 服务器，即使用 HTTP 协议。

据我所知，没有 confirm() jQuery 函数。你通常这样做：

```
if (confirm('Are you sure you want to delete this item?')) do_delete(); 
```

当用户选择 OK 时，confirm() 方法返回 true，否则返回 false。

干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T11:47:39.510

如果该行被删除，则肯定会执行 php 文件，并且您必须按照@Saifuddin 的描述检查 url 数据。

使用 firebug 控制台查看您的结果。而且您没有将参数传递给成功函数

所以改变这个

```
data: { ajax: 1, delete: $(this).attr('id')}, 
```

还有这个

```
success: function(msg) {
   alert(msg)
   parent.fadeOut(300,function() {
      parent.remove();
   });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T11:05:28.340

我假设在您的情况下执行 php 文件，而更好的方法是使用绝对路径定义 url，例如[http://www.example.com/delete.php](http://www.example.com/delete.php)。但是，您传递数据的方式并不符合标准。

所以替换这条线。

```
data: 'ajax=1&delete=' + $(this).attr('id'), 
```

和

```
data: { ajax: 1, delete: $(this).attr('id')}, 
```

并在您的 php 文件中调试 print $_POST 变量。

希望能帮助到你。

# c - 继续在预期 char 的地方获得 ascii 值

> ID：12338373
> 
> 赞同：0
> 
> 时间：2012-09-09T10:38:24.427
> 
> 标签：c, ascii

选择坐标时，应将其替换为“~”。但是，它被替换为 ~ 的 ascii 值（126）。我尝试了一些不同的东西，但我总是得到 126 而不是 ~。有任何想法吗？谢谢您的帮助！

```
int board_is_empty(int N, int board[ROWS][COLS])
{
    int i = 0, j = 0;
    for (i = 0; i < N; i++)
    {
        for (j = 0; j < N; j++)
        {
            if (board[i][j] != '~')
            {
                return 0;
            }
        }
    }
    return 1;
}

//updates the board to replace each selected coordinate with a ~.
//returns nothing
void update_board (int board[ROWS][COLS], int row_target, int column_target)
{

    board[row_target][column_target] = '~';
}

int main(void)
{
    int game_board[ROWS][COLS] = {0};
    int rows, columns = 0;
    int players_turn = 1, target_column = -1, target_row = -1, value = 0;
    int row_selection = 0, column_selection = 0;
    int i = 0;

    initialize_game_board(game_board);
    display_board(game_board);
    generate_starting_point(game_board, &rows, &columns);

    printf ("\nPlease hit <Enter> to continue.\n");
    getchar ();

    while (board_is_empty(ROWS, game_board) != 1)
    {
        select_target (&target_row, &target_column, players_turn);
        value += game_board[target_row][target_column];
        update_board (game_board, target_row, target_column); //should cause the coordinates at target_row && target_column to be replaced with a ~
        display_board(game_board);
    }
    printf("\n%d", value);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:57:42.150

为了存储您的坐标，您使用的是整数数组。当你执行

`board[row_target][column_target] = '~'`; 波浪号的 ascii 值 (126) 分配给 LHS。您无法将字符分配给整数值。我认为你应该使用一些特殊的数字而不是波浪号。如果我是你，我会使用 INT_MIN 或 INT_MAX。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T11:00:49.103

就 C 语言而言，字符 '~' 和数字 126 之间没有区别，'~' == 126。（您使用了我通常用于字符串的“~”，但我假设你实际上并不是那个意思）。

如果要显示一个值，则必须使用正确的格式字符串。%d 用于十进制整数， %c 用于字符（保存值的变量也应该是字符）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T11:01:12.720

在 C 中，字符只是整数。在输出时它们被表示为字符，但在内部它们只保存该字符的 ASCII 码。

由于您的板是*int*的矩阵，因此当您分配时，`'~'`您实际上是将数字 126 分配给板的位置。如果你检查那个位置，预期的结果是得到一个等于 126的*int 。*

但是，如果您想将该值*视为*一个字符，可以通过将该数字转换为字符来实现：

```
printf("%c", value); 
```

看一看：

```
#include <stdio.h>

int main()
{
    int i = '~';
    char c = '~';

    printf("Integer: %d\n", i); /* outputs: 126 */
    printf("Char: %c\n", c); /* outputs: ~ */
    printf("Integer casted to char: %c\n", i); /* outputs: ~ */
} 
```

也就是说，你的价值是对的。你只需要得到你想要的*表示*。（如果您希望能够同时将值 126 存储在棋盘*和*角色`~`中，那么您就不走运了，因为对于 C，它们是相同的——您可以使用您知道的其他值board 不会持有，比如 -1 或类似的东西）。

**更新：**

因此，如果我没有弄错，您要做的是从随机整数的二维矩阵中读取数字，并在阅读时*标记*每个数字。

如果那是您想要实现的目标，那么您使用“~”来标记读取位置的想法**是行不通的**。我之前的意思是，*在 C 中*，126 和字符 '~' 是完全相同的东西。因此，您将无法区分您写入“~”字符的位置和偶然存储随机 126 的位置。

如果您碰巧在数组中存储*正*整数，请使用`-1`而不是`'~'`. 这将告诉您该职位是否已被阅读。

**如果您正在存储任何**可能的随机整数，那么您可以在该数组中存储任何可用于将位置*标记*为已读的内容。在这种情况下，一种可能的解决方案是像这样定义您的数组：

```
typedef struct {
    int value;
    char marked;
} Position;

Position board[ROWS][COLS]; 
```

因此，对于每个位置，您可以存储如下值：

```
board[row][col].value = 23123; 
```

您可以将其标记为已读，如下所示：

```
board[row][col].marked = 'y'; 
```

`board[row][col].marked = 'n';`只是，当你用随机整数填充矩阵时，不要忘记将位置标记为未读 ( )。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T15:53:47.667

**'~'**是一个**字符**，您已将**board 声明为二维整数数组。**

所以当你写**board[row_target][column_target] = '~';**

它将“~”转换为整数，即转换为 126 的 ascii 值，因此它变为**board[row_target][column_target] = 126**

我建议**将板子做成二维字符数组**。希望它能解决你的问题。

如果您只想将其作为整数，则将 126 视为特殊的 no，这意味着通过声明“~”

# java - Android rss 无法解析带有属性的 XML

> ID：12338374
> 
> 赞同：0
> 
> 时间：2012-09-09T10:38:30.307
> 
> 标签：java, android, xml, dom, rss

```
Document doc = getDomElement(response); // getting DOM element
            NodeList nl = doc.getElementsByTagName(KEY_ITEM);
            // looping through all item nodes <item>
            for (int i = 0; i < nl.getLength(); i++) {
                Element e = (Element) nl.item(i);
                String name = getValue(e, KEY_NAME);
                String description = getValue(e, KEY_DESC);
                Log.e("description:", description);
            }

public String getValue(Element item, String str) {
    NodeList n = item.getElementsByTagName(str);
    return this.getElementValue(n.item(0));
}

public final String getElementValue(Node elem) {
    Node child;
    if (elem != null) {
        if (elem.hasChildNodes()) {
            for (child = elem.getFirstChild(); child != null; child = child.getNextSibling()) {
                if ((child.getNodeType() == Node.TEXT_NODE) || (child.getNodeType() == Node.ELEMENT_NODE) ) {
                    return child.getNodeValue();
                }
            }
        }
    }
    return "";
} 
```

在上面，响应是一个 XML RSS 提要，下面是一个子项。发生的事情是我能够获得标题、发布、更新。但是当我使用 getValue(e, "content") 我得到空字符串。我也想得到作者的名字。

```
<entry>
  <title>Title1</title>
  <link rel="alternate" type="text/html" href="http://www.example.com" />
  <id>ID</id>

  <published>2012-09-08T18:45:40Z</published>
  <updated>2012-09-08T18:43:01Z</updated>
  <author>
      <name>Author name</name>
      <uri>http://www.example.com</uri>
  </author>
  <content type="html" xml:lang="en" xml:base="http://www.example.com/">
      &lt;p&gt;Test Test</content>
</entry> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:19:44.753

在代码中

```
public final String getElementValue(Node elem) {
    Node child;
    if (elem != null) {
        if (elem.hasChildNodes()) {
            for (child = elem.getFirstChild(); child != null; child = child.getNextSibling()) {
                if ((child.getNodeType() == Node.TEXT_NODE) || (child.getNodeType() == Node.ELEMENT_NODE) ) {
                    return child.getNodeValue();
                }
            }
        }
    }
    return "";
} 
```

您只从第一个子文本节点获取文本。内容可以拆分为多个文本节点。您可能希望从所有子文本节点中收集文本。

```
public final String getElementValue(Node elem) {
    Node child;
    StringBuilder sb = new StringBuilder();
    if (elem != null) {
        if (elem.hasChildNodes()) {
            for (child = elem.getFirstChild(); child != null; child = child.getNextSibling()) {
                if ((child.getNodeType() == Node.TEXT_NODE) || (child.getNodeType() == Node.ELEMENT_NODE) ) {
                    sb.append(child.getNodeValue());
                }
            }
        }
    }
    return sb.toString();
} 
```

要获取作者姓名值，您首先需要在层次结构中下一层，因为“姓名”标签嵌套在“作者”标签内。当您遍历顶级节点以定位“作者”节点然后获取其子“名称”节点时，这将意味着一些特殊处理。

# javascript - 在 iFrame 中使用 HTML 时防止页面移动

> ID：12338377
> 
> 赞同：0
> 
> 时间：2012-09-09T10:39:07.063
> 
> 标签：javascript, html, css

我正在使用 # 链接（如`http://<location>/page.html#part1`. 每次我在 iframe 内单击时，整个页面（iframe 外）都会滚动到 # 所在的位置，如何防止这种情况发生？我只希望 iFrame 中的菜单根据需要移动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:41:34.387

您可以使用`preventDefault()`javascript 函数来更改此行为。像这样的东西

```
$('#my-navigation-block a').click(function (event){ event.preventDefault(); }) 
```

# php - 调整 PHP 代码 从给定 URL 检索 DOM

> ID：12338381
> 
> 赞同：0
> 
> 时间：2012-09-09T10:39:17.173
> 
> 标签：php, html

你好 ，

我使用以下代码从 URL 中检索 DOM 所有“A”标签并打印它们的 HREF 现在我的输出包含“A”我不希望它的输出在这里 [http://trend.remal.com/parsing.php](http://trend.remal.com/parsing.php)

我需要把我的名字清除为[http://twitter.com/namehere之后的名字](http://twitter.com/namehere)

所以输出“namehere”的打印列表

```
 include('simple_html_dom.php');

 // Retrieve the DOM from a given URL
 $html = file_get_html('http://tweepar.com/sa/1/');
 $urls = array();

  foreach ( $html->find('a') as $e )
  {
  // If it's a twitter link
  if ( strpos($e->href, '://twitter.com/') !== false )
  {
    // and we don't have it in the array yet
    if ( ! in_array($urls, $e->href) )
    {
        // add it to our array
        $urls[] = $e->href;
    }
   }
   }

  echo implode('<br>', $urls);

echo $e->href . '<br>'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T10:50:19.417

不要简单地使用`$urls[] = $e->href`，而是使用[正则表达式来匹配](http://php.net/manual/en/function.preg-match.php)用户名：

```
preg_match('~twitter.com/(.+)~', $e->href, $matches);
$urls[] = $matches[1]; 
```

# drools - Drools Fusion CEP 中的测试事件到期

> ID：12338385
> 
> 赞同：2
> 
> 时间：2012-09-09T10:40:02.780
> 
> 标签：drools, complex-event-processing, drools-fusion

Ciao，我测试了好几种方法，但还是无法测试验证Drools Fusion中的Event过期机制，求指点一下，好吗？

我已阅读手册，并且对此功能感兴趣：

> 换句话说，一旦一个事件被插入到工作内存中，引擎就有可能发现一个事件何时不再匹配其他事实并自动收回它，释放其相关资源。

我在 Eclipse 5.4.0.Final 中使用 Drools IDE，我修改了由“New Drools Project”向导创建的模板代码来测试和验证事件过期。

下面的代码。我理解使“生命周期”正常工作的方式是：

*   您必须在 STREAM 模式下设置 KBase - 检查
*   您必须按时间顺序插入事件 - 检查
*   您必须定义事件之间的时间约束 - 在我的情况下检查是最后一个 Message()

但是，当我最后检查 EventFactHandle 时，没有一个 Event() 已过期。谢谢你的帮助。

爪哇：

```
public class DroolsTest {

    public static final void main(String[] args) {
        try {
            KnowledgeBase kbase = readKnowledgeBase();
            // I do want the pseudo clock
            KnowledgeSessionConfiguration conf = KnowledgeBaseFactory.newKnowledgeSessionConfiguration();
            conf.setOption(ClockTypeOption.get("pseudo"));
            StatefulKnowledgeSession ksession = kbase.newStatefulKnowledgeSession(conf, null);
            SessionPseudoClock clock = ksession.getSessionClock();
            KnowledgeRuntimeLogger logger = KnowledgeRuntimeLoggerFactory.newFileLogger(ksession, "test");
            // Insert of 2 Event:
            Message message = new Message();
            message.setMessage("Message 1");
            message.setStatus(Message.HELLO);
            ksession.insert(message);
            ksession.fireAllRules();
            clock.advanceTime(1, TimeUnit.DAYS);
            Message message2 = new Message();
            message2.setMessage("Message 2");
            message2.setStatus(Message.HELLO);
            ksession.insert(message2);
            ksession.fireAllRules();
            clock.advanceTime(1, TimeUnit.DAYS);
            ksession.fireAllRules();
            // Now I do check what I have in the working memory and if EventFactHandle if it's expired or not:
            for (FactHandle f : ksession.getFactHandles()) {
                if (f instanceof EventFactHandle) {
                    System.out.println(((EventFactHandle)f)+" "+((EventFactHandle)f).isExpired());
                } else {
                    System.out.println("not an Event: "+f);
                }
            }
            logger.close();
        } catch (Throwable t) {
            t.printStackTrace();
        }
    }

    private static KnowledgeBase readKnowledgeBase() throws Exception {
        KnowledgeBuilder kbuilder = KnowledgeBuilderFactory.newKnowledgeBuilder();
        kbuilder.add(ResourceFactory.newClassPathResource("Sample.drl"), ResourceType.DRL);
        KnowledgeBuilderErrors errors = kbuilder.getErrors();
        if (errors.size() > 0) {
            for (KnowledgeBuilderError error: errors) {
                System.err.println(error);
            }
            throw new IllegalArgumentException("Could not parse knowledge.");
        }
        KnowledgeBase kbase = KnowledgeBaseFactory.newKnowledgeBase();
        kbase.addKnowledgePackages(kbuilder.getKnowledgePackages());
        // following 2 lines is the template code modified for STREAM configuration
        KnowledgeBaseConfiguration config = KnowledgeBaseFactory.newKnowledgeBaseConfiguration();
        config.setOption( EventProcessingOption.STREAM );
        return kbase;
    }

    /*
     * This is OK from template, as from the doc:
     * By default, the timestamp for a given event is read from the Session Clock and assigned to the event at the time the event is inserted into the working memory.
     */
    public static class Message {

        public static final int HELLO = 0;
        public static final int GOODBYE = 1;

        private String message;

        private int status;

        public String getMessage() {
            return this.message;
        }

        public void setMessage(String message) {
            this.message = message;
        }

        public int getStatus() {
            return this.status;
        }

        public void setStatus(int status) {
            this.status = status;
        }

    }

} 
```

流口水：

```
package com.sample

import com.sample.DroolsTest.Message;

declare Message
@role(event)
end

declare window LastMessageWindow
    Message() over window:length(1)
end

rule "Hello World"
    when
       accumulate( $m : Message(status==Message.HELLO) from window LastMessageWindow,
                $messages : collectList( $m ) )
    then
        System.out.println( ((Message)$messages.get(0)).getMessage() );
end 
```

请注意：即使我在 Message 事件中添加了 1 秒的过期时间，通过

```
@expires(1s) 
```

我仍然没有得到预期的结果，即插入的第一个 Message 事件，我原以为现在已经过期了？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T16:49:57.263

找到解决方案！显然是我很愚蠢，没有意识到我正在使用 Drools 5.4.0.Final，同时仍然参考 5.2.0.Final 的旧文档。在 Drools Fusion 5.4.0.Final 的更新文档中，为**2.6.2 添加了此框。滑动长度窗口**：

> 请注意，基于长度的窗口不会为会话中的事件到期定义时间约束，引擎不会考虑它们。如果事件没有其他定义时间约束的规则，也没有明确的过期策略，引擎将无限期地将它们保留在会话中。

因此，我最初提出的“您必须定义事件之间的时间约束”的第三个要求显然没有得到满足，因为我现在了解 Drools 5.4.0.Final 中的滑动长度窗口：

```
Message() over window:length(1) 
```

确实不是会话中事件到期的时间约束的定义。

更新这个答案希望有人会发现它有帮助。另外，就您所知，我实际上是愚蠢的依靠谷歌搜索才能找到文档，有时您不会被重定向到当前的发布文档，所以看起来......

# php - 动态更改代码点火器中输入文本的可见性

> ID：12338389
> 
> 赞同：1
> 
> 时间：2012-09-09T10:40:44.643
> 
> 标签：php, codeigniter, validation

我有一个变量，我将从我的控制器传递到我的视图，让我们调用这个变量`$validate`。这个变量将帮助我们了解用户处于什么状态（更新或保存）。我会要求用户在**保存**状态下输入 ID 和密码（**输入文本 id = 启用，密码 = 可见**）但在**更新**状态下，我不希望用户更新他们的 ID，他们看不到他们的密码（**输入文本 id = 禁用，密码=隐形**）。现在对于输入文本 ID，我可以这样做： `<input type="text" name="ID_user" class="text" <?php if($validate!='add'){echo "disabled";} ?>` 所以**输入文本 ID 中不需要 javascript** 我的问题是：

1.  如何根据`$validate`值使输入的文本密码不可见？

2.  我可以使用与输入文本 ID 相同的方式吗？（所以不需要 javascript）谢谢：D

**注意：我使用相同的表格进行更新和保存：D**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:55:04.113

像这样的东西 - 只需使用一个简单的“if”开关语句

```
<html>
   <p>stuff</p>
   <input type="text" name="id" id="id">
   <?php if ($validate!='add') {?>
           <input type="text" name="id" id="id">
           <input type="password" name="password" id="password">
   <?php } else { ?>
           <input type="text" name="id" id="id" disabled="disabled">
   <?php } ?>

</html> 
```

编辑：我假设您不想在更新时将密码“发布”回给自己。

# java - CSV 生成、日期和长数字格式

> ID：12338394
> 
> 赞同：0
> 
> 时间：2012-09-09T10:42:44.003
> 
> 标签：java, jsf, csv

我正在使用 JSF 动态/运行时生成 CSV 文件，代码如下

```
FacesContext context = FacesContext.getCurrentInstance();
HttpServletResponse response = HttpServletResponse)context.getExternalContext().getResponse();

int read = 0;
byte[] bytes = new byte[1024];

response.setContentType("text/csv");
response.setHeader("Content-Disposition", "attachment;filename=\"" + fileName + "\"");

ServletOutputStream os = null;

StringBuffer stringBuffer1 = new StringBuffer("");

stringBuffer1.append("Disconnect Time");
stringBuffer1.append(',');
stringBuffer1.append("Calling Number");

stringBuffer1.append("01/06/2010 01:00:35 AM");
stringBuffer1.append(", ");
stringBuffer1.append("447744369900");

ByteArrayInputStream bis1;
try {
    bis1 = new ByteArrayInputStream(stringBuffer1.toString().getBytes("UTF-8"));

    os = response.getOutputStream();

    while ((read = bis1.read(bytes)) != -1) {
        os.write(bytes, 0, read);
    }

    os.flush();
    os.close();
} catch (UnsupportedEncodingException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
}

FacesContext.getCurrentInstance().responseComplete(); 
```

以下是打开时文件的内容

```
Disconnect Time Calling Number
1/6/2010 1:00   4.47744E+11 
```

实际预期结果将是完整的日期格式 wrt AM/PM 和完整长度的数字。

我已经尝试过给定[Excel CSV - 数字单元格格式](https://stackoverflow.com/questions/137359/excel-csv-number-cell-format)和其他一些添加空格的双引号示例，但它们没有用。用户还将对数字列执行算术运算。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:51:36.970

我不是 JSF 专家，但这似乎与 Excel 如何读取这些信息完全相关。

我尝试对数据进行一些处理，但无法使其在 CSV 中执行您希望它执行的操作。

我创建了一个包含此内容的示例 CSV 文件（使用 Nopepad++）：

```
Disconnect Time, Calling Number
01/06/2010 01:00:35 AM,447744369900 
```

当我使用 Excel 查看它时，它给了我相同的输出 - 所以你面临的问题与在 Excel 中显示 CSV 有关 - 而不是 JSF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T22:39:16.080

您已经提到您正在动态生成文件。如果您要从 dataTable 导出数据，您可能需要考虑使用 PrimeFaces 中的[p:dataExporter](http://www.primefaces.org/showcase-labs/ui/exporter.jsf)组件（尽管您必须使用[p:dataTable](http://www.primefaces.org/showcase-labs/ui/datatableHome.jsf)）。如果它已经在您的 dataTable 中的正确结构中，它可以节省您以编程方式创建 excel 文件。

然后就像将 p:dataExporter 附加到链接并将其指向您的 dataTable 一样简单（`tbl`在这种情况下）。

```
<h:commandLink>  
    <p:graphicImage value="/images/excel.png" />  
    <p:dataExporter type="xls" target="tbl" fileName="cars" />  
</h:commandLink> 
```

顺便说一下，它还支持 CSV 和 PDF。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T11:16:15.660

RonK 是对的。使用 CSV 文件时，您无法告诉 Excel 如何格式化数据。Excel 只是对 CSV 列中的数据进行最佳猜测，然后为该类型的数据应用默认格式。
Excel 很可能仍然有正确的数据（即仍然有您的时间列的秒数），这只是 Excel 中的格式问题。
您是否尝试过在 Excel 中应用不同的格式？

您要么必须告诉用户如何在 Excel 中正确格式化数据，要么必须直接创建一个 Excel 文件（例如使用[Apache POI](http://poi.apache.org/)）并以这种方式应用正确的格式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T12:54:44.270

抱歉，看起来像是 Excel 中的错误（“功能”、“不足”）。

它假设任何看起来像数字的东西都是数字（并且在读取时会丢失精度）。

最简单的方法可能是确保电话号码看起来*不像*数字。例如通过包含`(`和相似的字符。

`'=123+456`请记住，在 Excel 中，如果您不希望它计算方程，有时您需要编写它。也试试这个。

日期可能只是格式化，尝试格式化列以包含秒数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-09T13:26:30.477

为了在 CSV 中显示正确的日期和数字格式，我使用了 =("447744369900") 方法。缺点是我们无法对单元执行算术运算。现在正如与 RonK 和 Turismo 讨论的那样，我现在转移到 Apache Excel 库，它允许您定义 Excel 文件的格式并创建 XLS 文件而不是 CSV。它比 CSV 慢一点，但满足我的要求。请参阅[API 以使用 java 编写巨大的 excel 文件](https://stackoverflow.com/questions/1486120/api-to-write-huge-excel-files-using-java)

再次感谢 RonK 和 Turismo

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-09T14:55:07.853

在 Excel 中打开 CSV 后，您可以将“主叫号码”单元格的格式更改为数字。选择列 -> 格式化单元格 -> 更改为数字

# php - 如何从我的循环中排除 MySQL 查询（限制不必要的查询）

> ID：12338397
> 
> 赞同：1
> 
> 时间：2012-09-09T10:43:01.347
> 
> 标签：php, mysql

我正在向 MySQL 询问数据，但它减慢了整个脚本的速度。但是我不知道如何摆脱这个循环。我尝试将其转换为 PHP 数组，但老实说，经过一天的尝试我失败了。

```
<?php

$id = '1';

include_once 'include_once/connect.php';

for ($x = 1; $x <= 5; $x++) {
for ($y = 1; $y <= 5; $y++) {

    $xy = $x."x".$y;

    $pullMapInfo = "SELECT value FROM mapinfo WHERE id='".$id."' AND xy='".$xy."'";
    $pullMapInfo2 = mysql_query($pullMapInfo) or die('error here');

    if ($pullMapInfo3 = mysql_fetch_array($pullMapInfo2)) {
        #some code
    } else {
        #some code
    }
}
}

?> 
```

如何`$pullMapInfo2`通过询问一次来使 MySQL 查询脱离循环以缩短加载时间？

如果你想在你的本地主机上触发脚本，你可以 c&p 整个事情:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:02:00.917

我不确定您的表中有什么，但考虑到您基本上是在遍历其中的几乎所有内容，我会说对给定的 Id 进行一次查询，然后从更大的数据集中整理出您需要的内容。

尤其是如果您总是从本质上拉回每个 id 的完整数据集，那么甚至没有理由为`IN`查询而烦恼，只需将其全部拉回单个 PHP 数组中，然后根据需要对其进行迭代。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T10:57:20.477

使用[MySQL IN](http://www.tutorialspoint.com/mysql/mysql-in-clause.htm)子句

```
<?php

$id = '1';

include_once 'include_once/connect.php';

// first we create an array with all xy
$array = array();
for ($x = 1; $x <= 5; $x++) {
    for ($y = 1; $y <= 5; $y++) {
        $xy = $x."x".$y;
        $array[] = $xy;
    }
}

$in = "'" . implode("', '", $array) . "'";
$pullMapInfo = "SELECT xy, value FROM mapinfo WHERE id='".$id."' AND xy IN ({$in})";
$pullMapInfo2 = mysql_query($pullMapInfo) or die('error here');

// we create an associative array xy => value
$result = array();
while (($pullMapInfo3 = mysql_fetch_assoc($pullMapInfo2)) !== false) {
    $result[ $pullMapInfo3['xy'] ] = $pullMapInfo3['value'];
}

// we make a loop to display expected output
foreach ($array as $xy)
{
    if (array_key_exists($xy, $result)) {
        echo '<div class="castle_array" style="background-image: url(tiles/'.$result[$xy].'.BMP)" id="'.$xy.'">'. $result[$xy] .'</div>';
    } else {
        echo '<div class="castle_array" id="'.$xy.'"></div>';
    }
    echo '<div class="clear_both"></div>';
}

?> 
```

# java - JSF (JavaServer Faces) 支持 html5 history.pushState() 进行页面导航，无需重新加载

> ID：12338398
> 
> 赞同：4
> 
> 时间：2012-09-09T10:43:24.700
> 
> 标签：java, html, jsf, jsf-2

这是否可以使用 html5 history.pushState() 在 JSF 页面之间导航而无需重新加载整个页面，就像在以下示例中所做的那样？ [https://github.com/defunkt/jquery-pjax](https://github.com/defunkt/jquery-pjax)

# javascript - 使用 jQuery 控制图像中的音频

> ID：12338404
> 
> 赞同：0
> 
> 时间：2012-09-09T10:44:53.217
> 
> 标签：javascript

我有三张图片，每张图片都有三首对应的歌曲。我正在尝试使用 jQuery 来控制`<audio>`图像`<a href>`。

我试图使用[这个脚本](https://stackoverflow.com/questions/5697974/dynamically-control-html5-audio-with-javascript/12337894#12337894)。但是，我得到了错误`Uncaught ReferenceError: $ is not defined`。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:50:13.617

尝试包括 jQuery 库。[jQuery 下载](http://docs.jquery.com/Downloading_jQuery):)

# php - 有人可以帮助调试我的 XML 的“XML Parsing Error: not well-formed”问题吗？

> ID：12338405
> 
> 赞同：0
> 
> 时间：2012-09-09T10:45:08.147
> 
> 标签：php, xml-parsing, deep-linking

在开始之前，我已经阅读了以下讨论：

[XML 解析错误：格式不正确](https://stackoverflow.com/questions/6792088/xml-parsing-error-not-well-formed)

[XML 格式不正确的错误](https://stackoverflow.com/questions/1959571/xml-not-well-formed-error)

[错误：解析 XML 时出错：格式不正确（无效令牌）...？](https://stackoverflow.com/questions/7089718/error-error-parsing-xml-not-well-formed-invalid-token)

所有这些问题似乎都不适用于我的问题。

我已经构建了一个带有`$xml=simplexml_load_file('somefile.xml');`函数的 php 文件，用于构建产品展示、商家附属网站。

然后我编码了一个（几个）$feed(s)，echo，整个九码。

所有 XML 数据都是关于特定产品的信息（产品名称、描述、价格、尺寸、图片 url、其他关键字相关数据等）。

一个数据条目的示例是：

```
<?xml version="1.0" encoding="utf-8"?>
<root>
    <product>
        <productName>Name</productName>
        <productCode>someCode</productCode>
        <productDescription>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat.</productDescription>
        <productSort>someSort</productSort>
        <productCategory>someCategory</productCategory>
        <productUrl>http://www.someMerchantUrl.com/someFolderOrCategory/someProduct</productUrl>
        <productImageUrl01>http://www.someMerchantUrl.com/imageOne.jpg</productImageUrl01>
        <productImageUrl02>http://www.someMerchantUrl.com/imageTwo.jpg</productImageUrl02>
        <productImageUrl03>http://www.someMerchantUrl.com/imageThree.jpg</productImageUrl03>
        <productPrice>£26.50</productPrice>
        <productPriceSale></productPriceSale>
        <deliveryCost>$5.00</deliveryCost>
        <deliveryMethod>courier</deliveryMethod>
        <availability>In Stock</availability>
        <purchaseAgreement>http://www.someMerchantUrl.com/terms-and-conditions.html</purchaseAgreement>
        <mainColour>blue</mainColour>
        <secondaryColour>black</secondaryColour>
        <keyword01>keywordOne</keyword01>
        <keyword02>keywordTwo</keyword02>
        <keyword03>keywordthree</keyword03>
    </product>
</root> 
```

一切都通过产品链接的示例 URL 及其图像位置进行了完美测试。

只有在插入实际的深层链接 URL（“点击重定向”编码）后才会弹出解析错误。

所以，我得到的错误是：

```
XML Parsing Error: not well-formed
Location: http://www.someAffiliateWebSite.com/productsXML/MainPageProducts.xml
Line Number 11, Column 68:
<productUrl>http://www.awin1.com/cread.php?awinmid=XXXX&awinaffid=XXXXXX&clickref=&p=http%3A%2F%2Fwww.someMerchantWebSite.com%2Fcatalog%2Fproduct.xml%3Fproduct_id%3D2577714%3Bcategory_id%3D2003473</productUrl>
---------------------------------------------------------------------------------^ 
```

**（（会员网络是Affiliate Window，商家和会员ID显然不是X，域名显然不是这里的。））**

所以，通过演绎（我认为这是演绎推理......无论如何）我认为深度链接 URL 语法中有一些有趣的东西，因为在我添加“点击重定向”链接之前它工作得很好。

我看到它为我提供了有关解析错误位置的具体信息，但由于我在 Web 开发方面明显迟缓，这没什么用。

那么有人能在这里找到汤里的苍蝇吗？

谢谢！

/布莱恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T10:56:29.977

Xml 规范不允许纯形式的“&”。见[http://www.w3.org/TR/xml/#syntax](http://www.w3.org/TR/xml/#syntax)

使用 CDATA 封装 url，然后应该可以正常工作

编辑：如果您确定没有任何其他有问题的字符，只需对 to 进行字符串替换`&`就`&amp;`足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T10:53:24.473

您必须正确转义 XML 中的 URL。

请参阅：[我需要在 XML 文档中转义哪些字符？](https://stackoverflow.com/questions/1091945/where-can-i-get-a-list-of-the-xml-document-escape-characters)

# jquery - JQuery在多个图像的鼠标悬停时切换可见性

> ID：12338406
> 
> 赞同：3
> 
> 时间：2012-09-09T10:45:12.703
> 
> 标签：jquery, css, hover, toggle, mouseover

使用简单的 jquery 鼠标悬停功能时遇到问题。

我有许多动态生成的图标，当我悬停时会显示隐藏的 div，当我 mouesout 时会隐藏 div。

```
 <div class='lister1'>
   <img src='"+path+stat1+"' />
   <img src='"+path+stat2+"' />
   <img src='"+path+stat3+"' />
   <img src='"+path+stat4+"' />
   <img src='"+path+stat5+"' />
   <img src='"+path+stat6+"' />
 </div> 
```

查询：

```
$('.hover_pop').hide();

$(document).on('hover','.lister1 img', function(){
$('.hover_pop').show(), function(){
    $('.hover_pop').hide();
}
}); 
```

这将显示 div 但不幸的是不会隐藏它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T11:02:34.253

从 jQuery 1.8 开始，不推荐使用`hover`带有方法的事件`on`，您可以编写以下代码：

```
$(document).on({
   mouseenter: function() {
       $('.hover_pop').show()
   },
   mouseleave: function() {
       $('.hover_pop').hide()
   } 
}, '.lister1 img'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T10:48:44.743

尝试这个

```
$(document).on('hover','.lister1 img', function(){
$('.hover_pop').show()}, function(){
    $('.hover_pop').hide();
}); 
```

您之前已经在末尾关闭了第一个函数的花括号

**已编辑**

```
$(document).on({
   mouseover: function() {
       $('.hover_pop').show()
   },
   mouseout: function() {
       $('.hover_pop').hide()
   } 
}, '.lister1 img');​ 
```

[在这里演示](http://jsfiddle.net/coosal/KVA9a/)

# extjs - Extjs 4网格排序后的自定义函数调用

> ID：12338407
> 
> 赞同：1
> 
> 时间：2012-09-09T10:45:15.310
> 
> 标签：extjs, extjs4

我有一个`Extjs 4`具有排序功能的网格。每次用户按下排序按钮后，我想调用一个 custum 函数。

在我的自定义函数中，我想导航到我的网格的第一页（我的网格使用分页并且它利用服务器端排序）我认为我必须`store.loadPage(1)`在我的自定义函数中使用（如果我错了，请纠正我）

我应该把我的自定义函数放在哪里？

这是我的`Ext.OnReady()`功能：

```
Ext.onReady(function() {
Ext.tip.QuickTipManager.init();

var url = {
    local:  'grid-filter.json',  // static data file
    remote: 'grid-filter.php'
};
var paging = true;
var encode = false;
var local = false;
Ext.define('UserDirectoryDataModel', {
    extend : 'Ext.data.Model',
    fields : [ 'uname', 'fname', 'lname', 'postcode', 'mail', {
        name : 'pass'
    }, 'hasAccess', 'isActive', 'lastVisit' , 'deleteUser'],
    idProperty : 'uname'
});

var itemsPerPage = 20;   

var store = Ext.create('Ext.data.Store', {
    pageSize : itemsPerPage,
    autoLoad: false,
    local: false,
    autoDestroy: true,
    model : 'UserDirectoryDataModel',
    autoSync : true,
    sortOnLoad : true,
    remoteSort:true,
    sorters : {
        property : 'uname',
        direction : 'ASC'
    },
    listeners: {
        beforeload: function(){
            store.loadPage(1);
        }
    },

    proxy : {
        type : 'ajax',
        url: (local ? url.local : url.remote),
        api : {
            read : 'read.php',
            update : 'update.php'

        },
        reader : {
            type : 'json',
            root : 'users',
            successProperty : 'success',
            totalProperty : 'totalCount'
        },
        writer : {
            type : 'json',
            writeAllFields : true,
            encode : false,
            root : 'users'
        },
        afterRequest : function(request, success) {
            if (request.action == 'update') {
                if (success) {
                    Ext.MessageBox.alert('alert',
                            'data updated!');

                }
            }

        }
    }
});

store.load({
    params:{
        start:0,
        limit: itemsPerPage
    }
});

 var filters = {
    ftype: 'filters',
    encode: encode, // json encode the filter query
    local: local,   // defaults to false (remote filtering)
    filters: [
        {
        }
    ]
};
var createColumns = function (finish, start) {

    var columns = [ {
        text : "username",
        dataIndex : 'uname',
        width : 150,
        filterable: true,
        align : 'right'
    }, {
        text : "name",
        dataIndex : 'fname',
        width : 150,
        align : 'right',
        hidden : false,
        sortable : true,
        filterable: true,
        editor : {
            xtype : 'textfield',
            allowBlank : false
        }
    }, {
        text : "last name",
        dataIndex : 'lname',
        width : 150,
        align : 'right',
        sortable : true,
        filterable: true,
        editor : {
            xtype : 'textfield',
            allowBlank : false
        }
    }, {
        text : "PostalCode",
        dataIndex : 'postcode',
        width : 110,
        align : 'right',
        sortable : true,
        filterable: true,
        editor : {
            xtype : 'textfield',
            allowBlank : false
        }
    }, {
        text : "email",
        dataIndex : 'mail',
        width : 200,
        align : 'right',
        sortable : true,
        filterable: true,
        editor : {
            xtype : 'textfield',
            allowBlank : false
        }
    }, {
        text : "password",
        width : 150,
        align : 'right',
        sortable : false,
        filterable: true,
        hidden : true,
        dataIndex : 'pass',
        editor : {
            xtype : 'textfield',
            inputType : 'password',
            allowBlank : true
        }
    }, {
        text : "access to system",
        dataIndex : 'hasAccess',
        renderer:function(value){
            if(value[0]=="1"){
                return "<a href=\"?action=access&type=revoke&cn="+value.substring(1,value.length)+"\">has</a>";
            }else{
                return "<a href=\"?action=access&type=grant&cn="+value.substring(1,value.length)+"\">doens't have</a>";
            }
        },
        width : 100,
        align : 'center',
        sortable : false,
        filterable: false
    }, {
        text : "active",
        dataIndex : 'isActive',
        renderer:function(value){
            if(value==null)
                return;
            if(value[0]=="1"){
                return "<a href=\"?action=activation&type=grant&cn="+value.substring(1,value.length)+"\">no</a>";
            }else if(value[0]=="0"){
                return "<a href=\"?action=activation&type=revoke&cn="+value.substring(1,value.length)+"\">yes</a>";
            }else if(value[0]=="2"){
                return "Not in portal!";
            }
        },
        width : 100,
        align : 'center',
        sortable : false,
        filterable: false
    }, {
        text : "last visit",
        dataIndex : 'lastVisit',
        width : 120,
        hidden : true,
        align : 'right',
        sortable : true,
        filterable: true
    }, {
        text : " ",
        dataIndex : 'uname',
        renderer:function(value){
            return "<a href=\"?action=delete&type=deleteUser&cn="+value+"\">delete</a>";
        },
        width : 120,
        hidden : true,
        align : 'right'
    } ];

    return columns.slice(start || 0, finish);
};

var pluginExpanded = true;
var grid = Ext.create('Ext.grid.Panel', {
    border: false,
    width : 1200,
    height : 620,
    title : '',
    store: store,
    disableSelection : false,
    seltype : 'rowmodel',
    loadMask : true,
    viewConfig : {
        id : 'gv',
        trackOver : false,
        stripeRows : false,
        plugins : [ {
            ptype : 'preview',
            bodyField : 'excerpt',
            expanded : true,
            pluginId : 'preview'
        } ]
    },
    columns: createColumns(),

    features: [filters],
     dockedItems: [Ext.create('Ext.toolbar.Paging', {
        dock: 'bottom',
        store: store
    })],
    plugins : [ Ext.create('Ext.grid.plugin.RowEditing', {
        clicksToEdit : 2
    }) ],
    renderTo : 'userdatagrid'
});
grid.child('pagingtoolbar').add([
           {
        text: 'show filters',
        handler: function () {
            var data = Ext.encode(grid.filters.getFilterData());
            Ext.Msg.alert('show filters',data);
        } 
    },{
        text: 'delete filters',
        handler: function () {
            grid.filters.clearFilters();
        } 
    }
]);

store.loadPage(1);
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T12:20:23.320

或者你可以使用这个：

```
grid.on('sortchange', function() {
    grid.getStore().loadPage(1);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-30T20:24:44.603

请求发送到服务器后触发 sortchange 事件。对于解决方案看这里 [http://www.sencha.com/forum/showthread.php?145779-Reset-page-for-paginator-on-sort-change](http://www.sencha.com/forum/showthread.php?145779-Reset-page-for-paginator-on-sort-change)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T12:04:32.063

忘记我写的一切： [ExtJS GridPanel 中的服务器端排序](https://stackoverflow.com/questions/5421723/server-side-sorting-in-an-extjs-gridpanel)

您应该将自定义函数放在网格事件中：[sortchange](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.panel.Table-event-sortchange)。

我刚刚重新阅读了您的问题-我以为您有无限分页。
如果您的排序是在服务器端完成的，那么是的，您需要调用 loadPage(1)。
您还需要发送排序参数。

```
listeners: {
            sortchange: function(){
                var grid = Ext.ComponentQuery.query('my-grid-alias')[0];
                grid.getStore().loadPage(1);
            }
        } 
```

我希望这有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T02:38:58.190

我想出了一个解决方案，我`"remoteSort:false"`在商店里设置了

```
"sortchange: {fn:function(){
    var time = (new Date()).getTime()/1000;
    // after {remoteSort:false} is set, sortchange event will be fired twice when column header is clicked, so I had to set a parameter for time record
    if('undefined' == typeof(this.last_sort_time) || this.last_sort_time+1 < time){
        this.getStore().loadPage(1);
        this.last_sort_time = time;
    }
}, scope:this}" 
```

在网格中。但它不能正常工作，因为接收到的数据在显示之前由网格重新排序

* * *

最后，我这样解决问题：

```
Ext.override(Ext.grid.column.Column, {
    doSort:function(){
        var ds = this.up('tablepanel').store;
        ds.currentPage = 1;
        this.callParent(arguments);
    }
}); 
```

到目前为止它运行良好

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-26T02:22:16.690

我只是在 sortchange 事件中放了一个 loadPage(1)，但它发出了两次服务器请求（网格自动使用排序参数制作了第一个），怎么可能只有一次？

# wordpress - 如何在 index.php 中显示 img

> ID：12338411
> 
> 赞同：1
> 
> 时间：2012-09-09T10:45:25.333
> 
> 标签：wordpress

我有模板，它工作正常没问题。

当我尝试将主题板转换为主题 wordpress 时，我将所有内容复制到内容中的 `index.php`主题中，我得到以下代码：

```
<ul>
                                <li>
                                    <div class="box-1">
                                        <img src="images/page1-img1.jpg" alt="" /> <a href="#">bora-bora</a>
 <span>from $458</span> 
                                        <p>Praesent vestibulum aenean
                                            <br>nonummy hendrerit mauris.</p>
                                    </div>
                                </li>
                                <li>
                                    <div class="box-1">
                                        <img src="images/page1-img2.jpg" alt="" /> <a href="#">Hawaii</a>
 <span>from $458</span> 
                                        <p>Praesent vestibulum aenean
                                            <br>nonummy hendrerit mauris.</p>
                                    </div>
                                </li> 
```

图像不显示在屏幕上。

我可以在 url 中看到我的主题：`http://127.0.0.1/www/www1/wordpress/Heb/wordpress/

看到我可以看到完整路径的img：

`http://127.0.0.1/www/www1/wordpress/Heb/wordpress/wp-content/themes/yossi_theme/images/page1-img1.jpg`

如果我在看不到的图片上单击鼠标右键，然后复制目标网址，我得到了地址：

```
http://127.0.0.1/www/www1/wordpress/Heb/wordpress/images/slide-1.jpg 
```

和错误：`The requested URL /www/www1/wordpress/Heb/wordpress/images/slide-1.jpg was not found on this server.`

我应该在这里更改什么`<img src="images/page1-img1.jpg" alt="" />`以显示 img ？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:51:32.827

既然你说你的形象的完整路径是

```
http://127.0.0.1/www/www1/wordpress/Heb/wordpress/wp-content/themes/yossi_theme/images/page1-img1.jpg 
```

那么你可以试试这个

```
<img src="<?php echo get_template_directory_uri()?>/images/yourImageName.png" alt="" /> 
```

代替

```
<img src="images/yourImageName.png" alt="" /> 
```

`get_template_directory_uri()`将返回您`theme`文件夹的路径，即

```
http://127.0.0.1/www/www1/wordpress/Heb/wordpress/wp-content/themes/yossi_theme 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T10:53:46.783

如果此图像是您布局的一部分（不是内容的一部分），您可以使用整个路径（例如 . `http://localhost/image.jpg`）或将其放在主题的目录中（比如说，`[your theme]/images`然后使用`<img src="<?php bloginfo('template_directory'); ?>/images/image.jpg" alt="">`.

如果这是您的内容（帖子、页面等）的一部分，请通过 WordPress 管理员上传此文件并从那里放置。

# oracle - 将 IN 更改为 EXISTS

> ID：12338412
> 
> 赞同：2
> 
> 时间：2012-09-09T10:45:31.777
> 
> 标签：oracle, exists

我有这两个查询：

查询 #1

```
SELECT A1.clrn_id  ,A1.gpgroup ,A1.cl_id
FROM p_dtl A1
WHERE A1.PYMT_DT = TO_DATE(:1 ,'YYYY-MM-DD') 
and A1.clrn_id in (
                     select clrn_id  
                     from gp_cl_rn run  
                     where run.clrn_id = a1.clrn_id 
                     and run.finalized_ind = :2
                  )
                    AND cl_id IN 
                        ( 
                            SELECT cl_id 
                            FROM hm_sal 
                            WHERE oprt_id ='004038'  
                            AND runctrl_id = :3
                        ) 
```

查询 #2

```
SELECT B.eid
FROM JBB B
WHERE B.eid IN 
(
    (
        SELECT eid
        FROM pbank A
        WHERE (bankid,branchid) IN 
        (
            SELECT bankid  ,branchid  
            FROM pbranch 
            WHERE sourceid = :1
            AND estat=:2
        )
        AND ESTAT = :2
        AND acct_type = :3
        AND acct_id = (
                select max(D.acct_id) 
                from pbank D 
                where D.eid = A.eid
                AND D.ESTAT = :2
                AND D.acct_type = :3)
     )
) 
```

如何`clrn_id`将第一个查询和`B.eid`第二个查询更改为 EXISTS 函数？和是否`bankid`也可以更改`branchid`为`acct_id`EXISTS 函数？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T10:53:40.510

您*可以*将其更改为 a `where exists`，但您可能希望`join`改为：

```
SELECT B.eid
  FROM JBB B
  JOIN ( SELECT eid, estat, acct_type, acct_id
              , max(acct_id) over ( partition by eid ) as max_acct
           FROM pbank 
                ) A
    ON b.eid = a.eid
  JOIN pbranch C
    ON a.bankid = c.bankid
   AND a.branchid = c.brahchid
 WHERE c.sourceid = :1
   AND c.estat = :2
   AND a.ESTAT = :3
   AND a.acct_type = :4
   AND a.acct_id = a.max_acct 
```

通过使用分析功能`max()`，您无需进行子选择；我认为，以这种方式做事也更清楚。

* * *

而且，您新添加的查询变为：

```
SELECT A1.clrn_id, A1.gpgroup, A1.cl_id
  FROM p_dtl A1
  JOIN gp_cl_rn run
    ON A1.clrn_id = run.clrn_id
 WHERE A1.PYMT_DT = TO_DATE(:1 ,'YYYY-MM-DD') 
   AND run.clrn_id = a1.clrn_id 
   AND run.finalized_ind = :2 
```

我注意到您明确使用了该`to_date()`函数，这意味着您将日期存储为字符串。这是不好的做法，从长远来看可能会给您带来麻烦......如果可能的话，请避免它。

* * *

```
max(acct_id) over ( partition by eid ) 
```

是[解析函数](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions004.htm#SQLRF06174)；这与聚合函数完全相同`max()`，除了不需要 GROUP BY，它为结果集中的*每一*行返回相同的结果。

`acct_id`这种特殊用途返回每个的最大值`eid`。有很多分析函数，但最好的办法是自己尝试一下。网上也有[几个例子。](http://www.orafaq.com/node/55)

使用 JOIN*不一定*比 a 快`where exists`，它只取决于你所追求的。与所有事情一样，我建议您尝试两者并查看更适合您的特定情况的内容。

一般来说，它们有不同的目的；`where exists`旨在在找到满足条件的单行时停止“计算”行。加入，做一切。在您的情况下，因为您想要所有东西，它们之间*可能*几乎没有选择，但我总是会使用 JOIN；只需确保您的索引是正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T10:53:31.187

我希望，它会帮助你：

```
SELECT B.eid
FROM JBB B
where exists
(
    SELECT 1
    FROM pbank A
    WHERE exists
        (
            SELECT 1 
            FROM pbranch PB
            WHERE PB.sourceid = :1
            AND PB.estat=:2
            and PB.bankid  = A.bankid
            AND PB.branchid  = A.branchid
        )
        AND ESTAT = :2
        AND acct_type = :3
        AND A.eid = B.eid
        AND acct_id = (
                select max(D.acct_id) 
                from pbank D 
                where D.eid = A.eid
                AND D.eid = B.eid
                AND D.ESTAT = :2
                AND D.acct_type = :3)
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T10:47:49.437

```
SELECT B.eid
FROM JBB B
JOIN
(
    (
        SELECT eid
        FROM pbank A
        WHERE (bankid,branchid) IN 
        (
            SELECT bankid  ,branchid  
            FROM pbranch 
            WHERE sourceid = 'BNIATB'
            AND estat='A'
        )
        AND ESTAT = 'A'
        AND acct_type = 'S'
        AND acct_id = (
                select max(D.acct_id) 
                from pbank D 
                where D.eid = A.eid
                AND D.ESTAT = 'A'
                AND D.acct_type = 'S')
     )
) C on B.eid = c.EID 
```

# c - C -- 结构体和指针基本问题

> ID：12338413
> 
> 赞同：1
> 
> 时间：2012-09-09T10:45:42.867
> 
> 标签：c, struct

所以我现在正在尝试学习 C，并且我有一些基本的结构问题想要解决：

基本上，一切都围绕着这段代码：

```
#include <stdio.h>
#include <stdlib.h>

#define MAX_NAME_LEN 127

typedef struct {
    char name[MAX_NAME_LEN + 1];
    unsigned long sid;
} Student;

/* return the name of student s */
const char* getName (const Student* s) { // the parameter 's' is a pointer to a Student struct
    return s->name; // returns the 'name' member of a Student struct
}

/* set the name of student s
If name is too long, cut off characters after the maximum number of characters allowed.
*/
void setName(Student* s, const char* name) { // 's' is a pointer to a Student struct |     'name' is a pointer to the first element of a char array (repres. a string)
    char temp;
int i;
for (i = 0, temp = &name; temp != '\0'; temp++, i++) {
    *((s->name) + i) = temp;
}

/* return the SID of student s */
unsigned long getStudentID(const Student* s) { // 's' is a pointer to a Student struct
    return s->sid;
}

/* set the SID of student s */
void setStudentID(Student* s, unsigned long sid) { // 's' is a pointer to a Student struct | 'sid' is a 'long' representing the desired SID
    s->sid = sid;
} 
```

我已经对代码进行了注释，以巩固我对指针的理解；我希望他们都是准确的。

另外，我还有一个方法，

```
Student* makeAndrew(void) {
    Student s;
    setName(&s, "Andrew");
    setStudentID(&s, 12345678);
    return &s;
} 
```

我确定在某种程度上是错误的......我也认为我的 setName 实施不正确。

任何指针？（没有双关语）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T10:52:53.710

这是非常错误的。如果你坚持不使用`strcpy`做这样的事情（未经测试）

```
int iStringLength = strlen(name);
for (i = 0; i < iStringLength; i++) {
    s->name[i] = name[i];
} 
```

但请确保长度不超过您的数组大小。

这也是错误的

```
Student* makeAndrew(void) {
   Student s;
   setName(&s, "Andrew");
   setStudentID(&s, 12345678);
   return &s; 
} 
```

因为该`s`对象在函数退出时被销毁 - 它在函数范围内是本地的，但您返回一个指向它的指针。因此，如果您尝试使用此指针访问结构，它将无效，因为实例不再存在。如果你想这样做，你应该使用动态分配它`malloc`。或者根本不返回指针并使用 @Andrew 的替代选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T10:52:42.523

在您的“另一种方法”中，您在本地声明`Student s`，它将动态分配空间（通常在堆栈上），并且您在完成时返回该地址。

但是，该堆栈空间将在返回时被释放，因此不能保证数据未损坏 - 事实上很可能是这样！

在对您的方法的调用中声明`Student s`，并将指针传递给 makeAndrew：

```
void makeAndrew(Student *s) {
    setName( s, "Andrew");
    setStudentID( s, 12345678);
}

...

Student s;
makeAndrew( &s );

... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T10:56:40.783

您的函数`makeAndrew`返回指向局部变量的指针。它仅在作用域结束之前有效，因此一旦函数完成，它就会在内存被覆盖时发生变化——即几乎立即发生变化。您必须动态分配它（使用`Student *s = new Student;`, 或者如果您真的想坚持纯 C, `Student *s = malloc (sizeof Student );`，然后在不需要它以避免内存泄漏之后将其释放到函数之外。

或者按照安德鲁的建议去做，这样更不容易出错。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T14:58:13.843

我会将 makeAndrew() 函数更改为只返回一个结构，而不是一个指向结构的指针，以纠正与返回指向临时变量的指针有关的错误：

```
Student makeAndrew(void) 
{
    Student s;
    setName(&s, "Andrew");
    setStudentID(&s, 12345678);
    return s;
}

Student aStudent = makeAndrew(); 
```

您的 setName 确实有关于 temp 的错误，它应该是一个 char *，因为您在循环中递增它以指向输入 c 字符串中的另一个字符。我认为它也缺少空终止。正如您在评论中提到的那样，应该检查学生中名称字符数组的溢出：

```
void setName(Student* s, const char* name) { // 's' is a pointer to a Student struct |     
    // 'name' is a pointer to the first element of a char array (repres. a string)
    const char *temp;
    int i;
    for (i = 0, temp = name; *temp != '\0' && i <= MAX_NAME_LEN; temp++, i++) 
    {
       *((s->name) + i) = *temp;
    }
    s->name[i] = '\0';
} 
```

您可以使用 strncpy 来简化 setName：

```
void setName2(Student *s,const char *name)
{
    #include <string.h>
    strncpy(s->name, name,MAX_NAME_LEN);
    s->name[MAX_NAME_LEN] = '\0';
} 
```

# javascript - 如何使用jquery ui 进度条？

> ID：12338415
> 
> 赞同：1
> 
> 时间：2012-09-09T10:46:39.990
> 
> 标签：javascript, jquery, jquery-ui

我正在尝试将 jquery ui 进度条与 value 文件上传插件一起使用。代码 ：

```
 <div id="pb"></div>

       .....
    onProgress: function (id, fileName, uploadedBytes, totalBytes) {
        $("#pb").progressbar({ value : uploadedBytes });
    },
    . .... . 
```

但这不起作用，任何人都可以指导我，如何正确使用进度条？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:15:45.613

您需要以百分比计算上传的字节数。

```
var percentValue = (uploadedBytes / totalBytes) * 100

$("#pb").progressbar({
        value: percentValue
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T12:38:01.663

假设您有一个带有`<div id="progressbar"></div>`

以下代码将每 10 毫秒遍历一次进度条，直到达到 100：

```
<script type="text/javascript">
    var i = 0; //variable used to count the steps
    function myclick(){ // function called on a button click for example
        var int = self.setInterval(
            function(){
                if (i == 100) window.clearInterval(int);
                $( "#progressbar" ).progressbar("value", i);
                i++;
            }
            , 10);
    }

    $('button').button().click(myclick); // a button element which will 
                                         // start the progress bar
    $( "#progressbar" ).progressbar(); //this part sets up the progressbar
</script> 
```

注意：其他答案也是有效的，我只发布了这个答案作为 IMO 尚未回答的问题的“如何正确使用进度条”部分的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T11:00:38.943

进度条以百分比显示。您需要转换`uploadedBtyes`为 %，`totalBytes`然后将其作为数字传递给选项的 value 属性。

# apache - 如何让地图服务器工作

> ID：12338416
> 
> 赞同：3
> 
> 时间：2012-09-09T10:47:12.377
> 
> 标签：apache, gis, mapserver

我已经使用 MapServer 大约 2 个小时了，但是上手似乎有点复杂。所以这是我的问题
有没有办法让 mapserver 显示一个简单的整个世界地图，我可以在其中移动地图以查看世界的不同部分？
（从我目前学到的知识来看，它只是向您显示您通过 mapserv cgi 的地图，并且地图是静态的，不能移动！）

编辑：我仍然想知道我是否可以为整个世界或一个国家或其他任何地方制作一张简单的地图！我应该自己为所有内容编写 .Map 文件吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T13:20:05.213

好的，所以在查找并挣扎了一下之后，我找到了一些 JS 库来执行此操作，其中之一是[Open Layers](http://openlayers.org/)。您只需在 html 页面的开头引用它，例如：

```
<script src="http://openlayers.org/api/OpenLayers.js"></script> 
```

然后您可以通过将 MapServer 数据如下绑定到 OpenLayers 初始化函数来为您的地图设置缩放和移动选项。

```
Var map, layer;

function init(){
    map = new OpenLayers.Map( 'map' );
    layer = new OpenLayers.Layer.MapServer( "NAME",
       "http://localhost/cgi-bin/mapserv", {map: 'PATH_TO_.MAP'} );
    map.addLayer(layer);
    map.zoomToMaxExtent();
} 
```

[在spatialhorizo​​ns.com](http://spatialhorizons.com/2007/11/14/using-mapserver-2-generating-map-tiles/)中可以找到很多很酷的教程。
希望这可以帮助某人:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T20:24:38.410

MapServer 就是这样，一个 MAP SERVER。听起来您当前正在使用 cgi 脚本来显示托管地图。可以使用 WMS 客户端应用程序查看的 WMS 提供程序（如 MapServer）托管数据。有很多这样的应用程序。您将需要一个更复杂的客户端应用程序来连接到 MapServer 以执行更复杂的地图操作。

看看[谷歌地球](http://www.data.gov.bc.ca/dbc/geo/wms/google_earth_connect.page)

或[NASA WorldWind](http://www.worldwindcentral.com/wiki/WMS)

或者我还没有使用[它](http://mapserver.refractions.net/phpwms/phpwms-cvs/)，但它看起来可能是最简单的，如果最不可靠的话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-08T19:45:29.233

首先 MapServer 是 GIS 服务器端技术。在我看来，放大/平移是客户端行为。

当我们查看用户在一个 Web 应用程序上平移/缩放的那一刻时，真正发生的是前端应用程序获取平移/缩放事件并调用 mapserver 以获取新地图返回客户端。

因此，您的传单、谷歌地图 API、Openlayers 等更有可能正在处理客户端移动的检测并将其解析为新的 getmap 请求并将请求发送到 mapserver 以获取响应。

您使用 get 请求从 MapServer 看到的内容是静态的，并且应该是这样。动态部分发生在客户端，从前端应用程序进行动态调用以进行这些静态调用。当客户端动态发送请求并从响应中刷新地图时，这是交互式的。

# vim - 从屏幕获取 pos_x 和 pos_y

> ID：12338423
> 
> 赞同：0
> 
> 时间：2012-09-09T10:48:33.850
> 
> 标签：vim, plugins, macvim

我想在 Vim 中编写一个特殊的插件，它根据 vim 光标的位置打开一个自定义应用程序。

有什么方法可以从屏幕上获取位置吗？

示例：当我调用自定义插件 ColorPicker 时，会打开一个以光标为中心的 ColorPicker 应用程序。截图：[https ://docs.google.com/file/d/0B6tc60GuFE4WbGxuaTV6OVlCSzg/edit](https://docs.google.com/file/d/0B6tc60GuFE4WbGxuaTV6OVlCSzg/edit)

这是一个非常基本的示例，但我希望能够向 vim 添加强大的 gui 功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T11:22:57.100

如果你真的想创建一个 Vim 插件，你应该从更接近帮助系统开始。`:help functions`将为您提供所有可用功能的详细列表。

你在找`getpos('.')`，看`:help getpos()`。

# magento - nginx 设置位置

> ID：12338426
> 
> 赞同：0
> 
> 时间：2012-09-09T10:48:54.353
> 
> 标签：magento, nginx

我在 nginx 中有更多我的 magento 存储这样的配置：

```
server {
listen 80;

server_name domain.com;
root /www-data/domain.com/www;
access_log /www-data/domain.com/logs/nginx.access.log main;
error_log  /www-data/domain.com/logs/nginx.error_log info;
index index.php;

location / {
    index index.html index.php;
    try_files $uri $uri/ @handler;
}

location /app/                { deny all; }
location /includes/           { deny all; }
location /lib/                { deny all; }
location /media/downloadable/ { deny all; }
location /pkginfo/            { deny all; }
location /report/config.xml   { deny all; }
location /var/                { deny all; }

location ~* "^.+\.(jpg|jpeg|gif|css|png|js|ico|pdf|zip|tar|t?gz|mp3|wav|swf)$" {
    expires    max;
    add_header Cache-Control public;
    access_log off;
}

location  /. {
    return 404;
}

location @handler {
    rewrite / /index.php;
}

location ~ .php/ {
    rewrite ^(.*.php)/ $1 last;
}

location ~ .php$ {
    if (!-e $request_filename) { rewrite / /index.php last; }

    fastcgi_read_timeout 60;
    expires        off;
    fastcgi_pass   unix:/var/run/php-fpm/php-fpm.sock;
    fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
    include        fastcgi_params;
}
} 
```

我需要为管理区域创建新的位置部分，它运行在标准 index.php 上，但超时时间很长。

所以我需要像 /admin/* 或 /index.php/admin/* 这样的路径有超时 600

任何人都可以帮助我并获取此类位置的样本吗？

据我了解，它一定是这样的：

```
# Magento Admin
location ^~ /index.php/backoffice/ {
    if (!-e $request_filename) { rewrite / /index.php last; }
    fastcgi_read_timeout 600;
    expires        off;
    fastcgi_pass   unix:/var/run/php-fpm/php-fpm.sock;
    fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
    include        fastcgi_params;
} 
```

但是这个配置让我**Access denied**，所以我认为**fastcgi_param SCRIPT_FILENAME**必须具有其他值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:54:27.823

# Nginx 超时

*以下是我知道*的超时命令的完整列表。我认为[fastcgi_read_timeout](http://nginx.org/en/docs/http/ngx_http_fastcgi_module.html#fastcgi_read_timeout)是您所需要的。

```
# Magento Admin
location ^~ /admin/ {
    proxy_read_timeout 600;
    proxy_connect_timeout 600;
    fastcgi_pass 127.0.0.1:8080;
    client_header_timeout 600;
    client_body_timeout 600;
    send_timeout 600;
} 
```

你也可以试试 `location ^ /admin/ {`

**变化**：考虑到 nginx wiki，[send_timeout 指令](http://wiki.codemongers.com/NginxHttpCoreModule#send_timeout)负责设置响应的一般超时。对于 FastCGI，有`fastcgi_read_timeout`哪些影响[fastcgi 进程响应超时](http://wiki.codemongers.com/NginxHttpFcgiModule#fastcgi_read_timeout)。

# algorithm - 在prestashop中为载体模块计算多个产品的盒子大小

> ID：12338431
> 
> 赞同：3
> 
> 时间：2012-09-09T10:49:21.240
> 
> 标签：algorithm, prestashop

我目前正在为日本送货上门公司[Kuroneko开发一个载体模块。](http://www.kuronekoyamato.co.jp/en/)该承运人连同重量一起考虑了箱子的大小。但它不使用音量，那太容易了。它使用三个维度（高度、重量和深度）的总和。

如果您只有一种产品要装箱，这仍然很容易，但是当您需要装箱 2 种产品时会发生什么？假设您有两个尺寸为 (x1,y1,z1) 和 (x2,y2,z2) 的乘积，您如何以使 X+Y+Z 最小的方式计算最终的盒子尺寸 X,Y,Z？

这是我的临时解决方案，但请告诉我是否有更好的计算方法：让 m1 成为第一个产品的最小尺寸，min(x1,y1,z1) 和第二个产品的最小尺寸。您必须考虑盒子中产品的旋转以最佳方式适合它们，从而为两种产品定义新尺寸 nx,ny,nz。假设 nx = m。如果 m = x 则 ny = y，nz = z，否则如果 m=y，则 ny= x，nz = z，否则如果 m=z，ny = y，nz= x。因此，总框大小变为 2*nx,max(ny1,ny2),max(nz1,nz2)。

但据我所知，我认为这种方法不适用于 2 种以上的产品。任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-02-14T09:54:22.550

*   [在这里](http://openovate.com/lbc.php)回答演示。
*   您可以在[此处](http://pastie.org/4124524)查看代码（我添加了画布以进行可视化）

逻辑：

1.  **查找**总体积 (w*h*d)[+(w*h*d)..]

2.  **收集**所有可能的宽度高度和深度值，从最低到最高排序

3.  **找到**所有可能的宽度和排列，然后是高度，然后是宽度

    3a。**示例**：宽度范围 1、2、3 的和排列将是 1、2、3、4、5、6

    3b。我们需要这个，因为根据示例 (3a.)，宽度的最终值绝不可能是 1.5。

4.  **根据 (3.) 计算的排列，**找到宽度、高度和深度的所有可能组合****

***   **存储**总交易量等于或大于来自 (1.) 的总交易量的所有组合

    5a。这是因为最终成交量不可能小于实际成交量 (1.)

    5b。对于大于 (1.) 的卷，这意味着这是死空间。

    *   **从 (5.) 升序对所有组合进行排序**，第一个结果将是最准确的 Volume*   最准确的体积仍然可能具有不同的尺寸

    7a。**示例**：第 16 卷可以是 2x2x4 或 4x4x1 或 2x1x8 或 16x1x1

    7b。**找到**每个的 W+H+D 的总和，最小的总和将是更准确的尺寸。

    7c。(7a.) 2+2+4 = 8, 4+4+1 = 9, 2+1+8 = 11, 16+1+1 = 18 .... 所以我们的脚本会选择 2 x 2 x 4** 

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-03-14T01:25:37.217

我一直在寻找这种算法，但链接已关闭，但是我可以使用回程机器找到它。

无论如何，我会在这里发布它，因为它可能对其他人有用

```
<?php

$test = '1,2,3|4,2,1|0.1,0.9,0.01';

$dimensions = explode("|", $test);

//1\. Find total volume
$volume = 0;
//2\. Find WHD ranges
$widthRange     = array();
$heightRange    = array();
$depthRange     = array();
foreach($dimensions as $dimension) {
    list($width, $height, $depth) = explode(',', $dimension);

    $volume += $width * $height * $depth;

    $widthRange[] = $width;

    $heightRange[] = $height;

    $depthRange[] = $depth;
}

//3\. Order the WHD ranges
sort($widthRange);
sort($heightRange);
sort($depthRange);

echo 'Volume: '.$volume.'<br />';
echo 'Width Range: '.implode(', ', $widthRange).'<br />';
echo 'Height Range: '.implode(', ', $heightRange).'<br />';
echo 'Depth Range: '.implode(', ', $depthRange).'<br />';

//4\. Figure out every combination with WHD
$widthCombination   = array();
$heightCombination  = array();
$depthCombination   = array();

function combination($list) {
    $combination = array();
    $total = pow(2, count($list)); 
    for ($i = 0; $i < $total; $i++) {   
        $set = array();
        //For each combination check if each bit is set  
        for ($j = 0; $j < $total; $j++) {  
           //Is bit $j set in $i?  
            if (pow(2, $j) & $i) $set[] = $list[$j];       
        }  

        if(empty($set) || in_array(array_sum($set), $combination)) {
            continue;
        }

        $combination[] = array_sum($set);
    }

    sort($combination);

    return $combination;
}

$widthCombination = combination($widthRange);
$heightCombination = combination($heightRange);
$depthCombination = combination($depthRange);

echo 'Width Combination: '.implode(', ', $widthCombination).'<br />';
echo 'Height Combination: '.implode(', ', $heightCombination).'<br />';
echo 'Depth Combination: '.implode(', ', $depthCombination).'<br />';

$stacks = array();
foreach($widthCombination as $width) {
    foreach($heightCombination as $height) {
        foreach($depthCombination as $depth) {
            $v = $width*$height*$depth;
            if($v >= $volume) {
                $stacks[$v][$width+$height+$depth] = array($width, $height, $depth);
            }
        }
    }
}

ksort($stacks);

foreach($stacks as $i => $dims) {
    ksort($stacks[$i]);
    foreach($stacks[$i] as $j => $stack) {
        rsort($stack);
        break;
    }

    break;
}

echo '<pre>'.print_r($stacks, true).'</pre>'; 
```

所有的功劳都属于[克里斯蒂安·布兰克拉](https://stackoverflow.com/users/1241871/christian-blanquera)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-20T17:50:45.903

用python实现了算法，Macr1408翻译了代码，感谢算法的原作者Christian Blanquera。

```
from functools import reduce
from itertools import product

def combination(dim: list) -> list:
    """Calculate all possible sum permutations for a given list
    of numbers.

    Args:
        dim (list): A list of numbers

    Returns:
        list: All possible sum permutations
    """
    combination = []
    total = pow(2, len(dim))
    for i in range(total):
        set_v = []
        for j in range(total):
            if (pow(2, j) & i):
                set_v.append(dim[j])

        if len(set_v) == 0 or sum(set_v) in combination:
            continue

        combination.append(sum(set_v))
    return sorted(combination)

# dimensions => [(w1, h1, l1), (w2, h2, l2), ...]
def calculate_volumetric_total(dimensions: list[tuple[float, float, float]]) -> tuple:
    """Calculate the volumetric dimensions of the box needed to store products
    with sizes stored as tuples of (width, height, length). Based on the following
    algorithm:

    1\. Find total Volume (w*h*d)[+(w*h*d)..]
    2\. Collect all possible width height and depth values, sort each from lowest to highest
    3\. Find all possible sum permutations for width, then for height, then for width
        3a. Example: sum permutations for width ranges 1,2,3 would be 1, 2, 3, 4, 5, 6
        3b. we need this because in no way could the final value for width be 1.5 for example based on the example (3a.)
    4\. Find all possible combinations of Width, Height and Depth based on the permutations calculated on (3.)
    5\. Store all combinations where the total volume is equal or greater than the total Volume from (1.)
        5a. This is because it is not possible that the final volume could be less than the actual Volume (1.)
        5b. For Volumes greater than (1.) it means that's dead space.
    6\. Sort all combinations from (5.) Ascending, the first result will be the most accurate Volume
    7\. It is possible that the most accurate volume still could have different dimensions
        7a. Example: Volume 16 can be 2x2x4 or 4x4x1 or 2x1x8 or 16x1x1
        7b. Find the sum of W+H+D for each and the smallest sum would be the even more accurate dimensions.
        7c. Example from (7a.) 2+2+4 = 8, 4+4+1 = 9, 2+1+8 = 11, 16+1+1 = 18 .... So our script would choose 2 x 2 x 4

    Args:
        dimensions (list[tuple[float, float, float]]): A list of all products/boxes
        to store together in the form width, height, length.

    Returns:
        tuple: A tuple of width, height, length values representing the box needed to
        store all the provided dimensions in.
    """
    # 1
    total_volume = sum([reduce(lambda x, y: x*y, t) for t in dimensions])

    # 2, sorting happens when combining values
    all_widths = [t[0] for t in dimensions]
    all_heights = [t[1] for t in dimensions]
    all_lengths = [t[2] for t in dimensions]

    # 3
    width_combination = combination(all_widths)
    height_combination = combination(all_heights)
    length_combination = combination(all_lengths)

    # 4
    vals = {}
    for perm in product(width_combination, height_combination, length_combination):
        # 5
        volume = reduce(lambda x, y: x*y, perm)
        if volume >= total_volume:
            vals[sum(perm)] = perm

    # 6
    return vals[sorted(vals.keys())[0]] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-26T11:56:47.977

上述算法不适用于维度： `$test = '100,10,10|50,50,50';` 第一个结果是：

```
(
  [0] => 50
  [1] => 60
  [2] => 50              
) 
```

但第一个产品不适合。组合数组应仅包含大于或等于最大维度大小的大小总和（宽度组合不应包含 50）。**

# linux - 如何反编译 ELF 32 位 LSB 可执行文件？

> ID：12338432
> 
> 赞同：15
> 
> 时间：2012-09-09T10:49:32.867
> 
> 标签：linux

我有一个 ELF 32 位 LSB 可执行文件，Intel 80386，版本 1 (SYSV)，动态链接（使用共享库），它也被剥离，我想探索它。有谁知道如何反编译这样的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T20:44:15.063

[IDA](https://www.hex-rays.com/products/ida/index.shtml) plus [Hex-Rays 反编译器](https://www.hex-rays.com/products/decompiler/index.shtml)可以[反编译](https://www.hex-rays.com/products/decompiler/compare_vs_disassembly.shtml)（到伪 C 代码）大部分 32 位 x86 代码，包括 Linux ELF 文件。

免责声明：我为 Hex-Rays 工作。

# image - 将 bean.method 放入 img src 标签

> ID：12338438
> 
> 赞同：0
> 
> 时间：2012-09-09T10:50:25.113
> 
> 标签：image, jsp, methods, input, tags

我的方法有一个输入值，即

```
<h:inputText id="image_id" value="#{bean1.ID}" required="true" styleClass="input_text"> 
```

但是，我需要将 #{bean1.ID} 放在图像标签中

```
<img src="/portal/view?image_id='#{bean1.ID}'" width="650" height="450" alt="Small image" /> 
```

它不工作。有没有人知道如何将值放入图像标签中。太感谢了 ：）

# google-chrome-devtools - 启动 Chrome 开发工具时出现 XMLHttpRequest 异常 101

> ID：12338439
> 
> 赞同：0
> 
> 时间：2012-09-09T10:50:27.637
> 
> 标签：google-chrome-devtools

我试图对 chrome 开发人员工具进行修改，因此我按照此处列出的步骤操作：[https ://developers.google.com/chrome-developer-tools/docs/contributing 并从](https://developers.google.com/chrome-developer-tools/docs/contributing)[持续构建存档](http://storage.googleapis.com/chromium-browser-continuous/index.html) 安装了 chrome build 155617 。然后我按如下方式启动 chrome：

```
chrome.exe --debug-devtools-frontend=C:\path\to\155617\devtools_frontend --remote-debugging-port=9222 
```

当我尝试检查一个元素时，我得到了开发工具面板，但是，“元素”、“资源”等面板都没有功能。因此，为了调试它，我检查了 devtools，我在控制台中看到了以下错误：

```
Uncaught Error: NETWORK_ERR: XMLHttpRequest Exception 101 utilities.js:855
Uncaught TypeError: undefined is not a function Panel.js:314 
```

知道如何解决这个问题吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T18:44:46.923

我提交了一个错误[https://bugs.webkit.org/show_bug.cgi?id=96211](https://bugs.webkit.org/show_bug.cgi?id=96211)

并非所有必需的文件都被压缩到 devtools_frontend.zip 中，这可能是因为我们已经切换到延迟加载模式。明天我会尝试修复它。

解决此问题的最简单方法是将 WebKit/Source/WebCore/inspector/front-end 的内容从存储库复制到您的 devtools 前端的解压缩版本中。

`svn checkout https://svn.webkit.org/repository/webkit/trunk/Source/WebCore/inspector/front-end`您可以在命令的帮助下从存储库中获取当前前端

# android - 由其他现有视图组成的自定义小部件

> ID：12338440
> 
> 赞同：1
> 
> 时间：2012-09-09T10:50:33.077
> 
> 标签：android, android-widget

我想创建一个具有以下布局的小部件：

```
<LinearLayout orientation="horizontal">
<CheckBox />
<EditText />
<SeekBar />
</LinearLayout> 
```

当搜索栏被移动时，它应该选中复选框并使用当前搜索栏值更新编辑框。

我在应用程序中一遍又一遍地使用类似的东西，并且厌倦了重新实现相同的东西。

将所有这些封装到自己的类中以供重用的最佳方法是什么？

* * *

```
public class SeekChoice extends LinearLayout {

    public SeekChoice(Context context) {
        super(context);
        LayoutInflater inflater = (LayoutInflater) context.getSystemService( Context.LAYOUT_INFLATER_SERVICE );
        LinearLayout ll = (LinearLayout) inflater.inflate(R.id.widget_item, null);
        this.addView(ll);
    }
}

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" 
    android:id="@+id/widget_item"
    >

    <CheckBox
        android:id="@+id/checkBox_item_name"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Item Name" />

    <EditText
        android:id="@+id/editText_item_count"
        android:layout_width="82dp"
        android:layout_height="wrap_content"
        android:enabled="false"
        android:ems="10" >

    </EditText>

    <SeekBar
        android:id="@+id/seekBar_item_count"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1" />

</LinearLayout> 
```

然后在我的布局中我放了：

```
<com.example.lobsternav.widget.SeekChoice
    android:layout_width="match_parent"
    android:layout_height="wrap_content"/> 
```

例外情况如下：

```
09-09 20:23:08.759: E/AndroidRuntime(21888): FATAL EXCEPTION: main
09-09 20:23:08.759: E/AndroidRuntime(21888): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.lobsternav/com.example.lobsternav.MarkActivity}: android.view.InflateException: Binary XML file line #344: Error inflating class com.example.lobsternav.widget.SeekChoice
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.app.ActivityThread.access$600(ActivityThread.java:130)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.os.Handler.dispatchMessage(Handler.java:99)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.os.Looper.loop(Looper.java:137)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.app.ActivityThread.main(ActivityThread.java:4745)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at java.lang.reflect.Method.invokeNative(Native Method)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at java.lang.reflect.Method.invoke(Method.java:511)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at dalvik.system.NativeStart.main(Native Method)
09-09 20:23:08.759: E/AndroidRuntime(21888): Caused by: android.view.InflateException: Binary XML file line #344: Error inflating class com.example.lobsternav.widget.SeekChoice
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.view.LayoutInflater.createView(LayoutInflater.java:596)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:687)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:749)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:749)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:256)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.app.Activity.setContentView(Activity.java:1867)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at com.example.lobsternav.MarkActivity.onCreate(MarkActivity.java:85)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.app.Activity.performCreate(Activity.java:5008)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
09-09 20:23:08.759: E/AndroidRuntime(21888):    ... 11 more
09-09 20:23:08.759: E/AndroidRuntime(21888): Caused by: java.lang.NoSuchMethodException: <init> [class android.content.Context, interface android.util.AttributeSet]
09-09 20:23:08.759: E/AndroidRuntime(21888):    at java.lang.Class.getConstructorOrMethod(Class.java:460)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at java.lang.Class.getConstructor(Class.java:431)
09-09 20:23:08.759: E/AndroidRuntime(21888):    at android.view.LayoutInflater.createView(LayoutInflater.java:561)
09-09 20:23:08.759: E/AndroidRuntime(21888):    ... 24 more 
```

* * *

疯狂......如果我没有定义以下构造函数，它会引发异常：

```
public SeekChoice(Context context, AttributeSet attrs) {
    super(context, attrs);

} 
```

我猜 LinearLayout 的所有构造函数都需要定义并且需要调用超级构造函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T23:30:10.310

终于有这个工作了。

我的 Java 代码：

```
package com.example.lobsternav.widget;

import java.util.ArrayList;
import java.util.List;

import com.example.lobsternav.R;

import android.content.Context;
import android.content.res.TypedArray;
import android.util.AttributeSet;
import android.view.LayoutInflater;
import android.widget.CheckBox;
import android.widget.CompoundButton;
import android.widget.CompoundButton.OnCheckedChangeListener;
import android.widget.EditText;
import android.widget.LinearLayout;
import android.widget.SeekBar;
import android.widget.RelativeLayout.LayoutParams;
import android.widget.SeekBar.OnSeekBarChangeListener;

public  class SeekChoice extends LinearLayout implements OnSeekBarChangeListener, OnCheckedChangeListener{

    CheckBox checkbox = null;
    EditText editBox =null;
    SeekBar seekbar = null;

    boolean isChecked = false;
    int curValue = 0;
    List <String> mappings = new ArrayList<String>();
    int startRange = 0;
    int endRange = 50;
    int defaultValue = 0;

    private void init(Context context)
    {
        this.setOrientation(LinearLayout.HORIZONTAL);
        LayoutInflater inflater = (LayoutInflater) context.getSystemService( Context.LAYOUT_INFLATER_SERVICE );

        LinearLayout layout = (LinearLayout)inflater.inflate(R.layout.item_widget, null);
        layout.setOrientation(LinearLayout.HORIZONTAL);
        layout.setLayoutParams(new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT,LinearLayout.LayoutParams.WRAP_CONTENT));

        checkbox = (CheckBox)layout.findViewById(R.id.checkBox_item_name);
        checkbox.setOnCheckedChangeListener(this);
        //this.addView(checkbox);

        editBox = (EditText)layout.findViewById(R.id.editText_item_count);
        editBox.setEnabled(false);
        editBox.setText(getMappedValue(defaultValue));

        int ems = (new Integer(endRange)).toString().length()+1;
        editBox.setEms(ems);
        //this.addView(editBox);

        seekbar = (SeekBar)layout.findViewById(R.id.seekBar_item_count);
        seekbar.setMax(endRange);
        seekbar.setProgress(defaultValue);
        //seekbar.setLayoutParams(new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT,LinearLayout.LayoutParams.WRAP_CONTENT));
        seekbar.setOnSeekBarChangeListener(this);
        //this.addView(seekbar);    
        this.addView(layout);

    }

    public void readAttributes(Context context, AttributeSet attrs)
    {
        TypedArray a = context.obtainStyledAttributes(attrs, R.styleable.SeekChoice);
        this.startRange = a.getInteger(R.styleable.SeekChoice_startRange, 0);
        this.endRange = a.getInteger(R.styleable.SeekChoice_endRange, 100);
        this.defaultValue = a.getInteger(R.styleable.SeekChoice_defaultValue, 0);
        this.isChecked = a.getBoolean(R.styleable.SeekChoice_isChecked, false);
        a.recycle();
    }

    public SeekChoice(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        readAttributes( context,  attrs);
        init(context);

    }

    public SeekChoice(Context context, AttributeSet attrs) {
        super(context, attrs);
        readAttributes( context,  attrs);
        init(context);

    }
    public SeekChoice(Context context) {
        super(context);
        init(context);
    }

    public SeekChoice(Context context,int startRange, int endRange, int defaultValue) {
        super(context);
        init(context);
    }
    @Override
    public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser) 
    {
        this.editBox.setText("" + getMappedValue(progress));

        if (progress > 0)
        {
            this.checkbox.setChecked(true);
            isChecked = true;
        }

    }

    @Override
    public void onStartTrackingTouch(SeekBar seekBar) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onStopTrackingTouch(SeekBar seekBar) {
        // TODO Auto-generated method stub

    }

    public int getStartRange() {
        return startRange;
    }

    public void setStartRange(int startRange) {
        this.startRange = startRange;
    }

    public int getEndRange() {
        return endRange;
    }

    public void setEndRange(int endRange) {
        this.endRange = endRange;
    }

    public int getDefaultValue() {
        return defaultValue;
    }

    public void setDefaultValue(int defaultValue) {
        this.defaultValue = defaultValue;
    }

    @Override
    public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) 
    {

        this.isChecked = isChecked;

        if (isChecked == false)
        {
            this.seekbar.setProgress(0);
        }

        this.editBox.setText("" + getMappedValue(0));
    }

    public String getMappedValue(int current)
    {
        if (current < this.getMappings().size())
        {
            return this.getMappings().get(current);
        }

        return "" + current;

    }

    public List<String> getMappings() {
        return mappings;
    }

    public void setMappings(List<String> mappings) {
        this.mappings = mappings;
    }

    public void addMappings(String mapping) {
        this.mappings.add(mapping);
    }
    public boolean isChecked() {
        return isChecked;
    }

    public String getCurrentValue()
    {
        return this.editBox.getText().toString();
    }
    public void setChecked(boolean isChecked) {
        this.isChecked = isChecked;
    }

} 
```

我在构造函数中膨胀的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" 
    android:id="@layout/item_widget">

   <CheckBox
        android:id="@+id/checkBox_item_name"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Item Name" />

    <EditText
        android:id="@+id/editText_item_count"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:enabled="false"
        android:ems="10" >

    </EditText>

    <SeekBar
        android:id="@+id/seekBar_item_count"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1" />
</LinearLayout> 
```

/res/values/attr.xml（用于将自定义属性传递给小部件）：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
       <declare-styleable name="SeekChoice">
            <attr name="startRange" format="integer"/>
            <attr name="endRange" format="integer"/>
            <attr name="defaultValue" format="integer"/>                
            <attr name="isChecked" format="boolean"/>       

       </declare-styleable>

</resources> 
```

我包含小部件的布局文件：

```
 <RelativeLayout android:layout_width="fill_parent"
        android:layout_height="match_parent" 
        xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:custom="http://schemas.android.com/apk/res/com.example.lobsternav">
.....
.....

<com.example.lobsternav.widget.SeekChoice
android:layout_width="match_parent"
android:layout_height="wrap_content"
custom:defaultValue="10"
/>

.....
.....

</RelativeLayout> 
```

浪费我时间的事情，所以我会与大家分享：

1）。确保添加要覆盖的类的所有构造函数

2）。命名空间（在我的示例中是“xmlns:custom="http://schemas.android.com/apk/res/com.example.lobsternav"）必须是您的 R 所在的包名称，而不是小部件驻留。

3）。在 attr.xml 文件中，标签 declare-styleable 不会在 eclipse xml 编辑器中自动完成，因此它看起来不像是一个有效的标签 - 但它是。我读了其他 2 篇文章说要使用它，但是 android eclipse 插件没有将它显示为资源下的有效标签，所以我几乎没有尝试使用该标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T12:01:12.483

选项 #1：不要将其打包到自定义小部件中，而是打包到片段中。

选项＃2：创建一个子类`LinearLayout`，将其方向设置为水平并将布局文件膨胀到自身中，其中包含您上面所拥有的内容，并用 `merge`标签替换`LinearLayout`（或直接在Java代码中添加其子类，如果您愿意并且不需要布局-水平可定制性）。然后`LinearLayout`可以将事件侦听器连接到其子代等。

# lotus-notes - Sametime Rest API 好友列表

> ID：12338442
> 
> 赞同：1
> 
> 时间：2012-09-09T10:50:39.783
> 
> 标签：lotus-notes, lotus-domino, sametime

我正在使用sametime rest api。我通过 URL = "http://servername:port/stwebapi/user/connect?" 连接到我的服务器 我有一个返回码 200 OK。所以我是正确的。

当我尝试使用 URL =“http://servername:port/stwebapi/buddylist”恢复 mu buddylist 时，我总是收到错误 11：即“请登录 Sametime”。

有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T10:29:56.350

您必须发送登录后获得的 LtpaToken 或 LtpaToken2 cookie 以及您的请求。

# android - 如何在 EditText 中输入数字时自动添加千位分隔符

> ID：12338445
> 
> 赞同：69
> 
> 时间：2012-09-09T10:51:11.543
> 
> 标签：android, android-layout, android-edittext, android-emulator, number-formatting

我正在创建一个转换器应用程序。 我想设置EditText以便当用户输入要转换`,`的数字时，一旦数字增加 3 位，千位分隔符（
低于 4 位数字恢复正常。
有什么帮助吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2015-12-14T11:04:41.290

**终于解决了问题**

即使答案为时已晚。我已经研究了很多来完成任务以获得正确的结果但不能。所以我终于解决了我们正在搜索的问题，并为谷歌搜索者提供了这个答案，以节省他们的搜索时间。

**以下代码的特征**

1.  `EditText`在文本更改时放入千位分隔符。

2.  `0.`在按下句点 (.) 时自动添加。

3.  在开始时忽略`0`输入。

只需复制以下名为的类

**NumberTextWatcherForThousand****实现** **TextWatcher** _

 **```
import android.text.Editable;
import android.text.TextWatcher;
import android.widget.EditText;
import java.util.StringTokenizer;

/**
 * Created by skb on 12/14/2015.
 */
public class NumberTextWatcherForThousand implements TextWatcher {

    EditText editText;

    public NumberTextWatcherForThousand(EditText editText) {
        this.editText = editText;

    }

    @Override
    public void beforeTextChanged(CharSequence s, int start, int count, int after) {

    }

    @Override
    public void onTextChanged(CharSequence s, int start, int before, int count) {

    }

    @Override
    public void afterTextChanged(Editable s) {
        try
        {
            editText.removeTextChangedListener(this);
            String value = editText.getText().toString();

            if (value != null && !value.equals(""))
            {

                if(value.startsWith(".")){
                    editText.setText("0.");
                }
                if(value.startsWith("0") && !value.startsWith("0.")){
                    editText.setText("");

                }

                String str = editText.getText().toString().replaceAll(",", "");
                if (!value.equals(""))
                editText.setText(getDecimalFormattedString(str));
                editText.setSelection(editText.getText().toString().length());
            }
            editText.addTextChangedListener(this);
            return;
        }
        catch (Exception ex)
        {
            ex.printStackTrace();
            editText.addTextChangedListener(this);
        }

    }

    public static String getDecimalFormattedString(String value)
    {
        StringTokenizer lst = new StringTokenizer(value, ".");
        String str1 = value;
        String str2 = "";
        if (lst.countTokens() > 1)
        {
            str1 = lst.nextToken();
            str2 = lst.nextToken();
        }
        String str3 = "";
        int i = 0;
        int j = -1 + str1.length();
        if (str1.charAt( -1 + str1.length()) == '.')
        {
            j--;
            str3 = ".";
        }
        for (int k = j;; k--)
        {
            if (k < 0)
            {
                if (str2.length() > 0)
                    str3 = str3 + "." + str2;
                return str3;
            }
            if (i == 3)
            {
                str3 = "," + str3;
                i = 0;
            }
            str3 = str1.charAt(k) + str3;
            i++;
        }

    }

    public static String trimCommaOfString(String string) {
//        String returnString;
        if(string.contains(",")){
            return string.replace(",","");}
        else {
            return string;
        }

    }
} 
```

**`EditText`在你的下面使用这个类**

```
editText.addTextChangedListener(new NumberTextWatcherForThousand(editText)); 
```

**将输入作为纯双文本**

像这样使用`trimCommaOfString`同一个类的方法

```
NumberTextWatcherForThousand.trimCommaOfString(editText.getText().toString()) 
```

*[吉特](https://github.com/shreekrishnaban/NumberTextWatcherForThousand)*

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2012-09-09T11:53:28.097

您可以`String.format()`在[`TextWatcher`](http://developer.android.com/reference/android/text/TextWatcher.html#afterTextChanged%28android.text.Editable%29). **格式说明符中的逗号可以解决问题。**

这不适用于浮点输入。并且注意不要使用 TextWatcher 设置无限循环。

```
public void afterTextChanged(Editable view) {
    String s = null;
    try {
        // The comma in the format specifier does the trick
        s = String.format("%,d", Long.parseLong(view.toString()));
    } catch (NumberFormatException e) {
    }
    // Set s back to the view after temporarily removing the text change listener
} 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2013-12-25T17:08:13.070

```
public static String doubleToStringNoDecimal(double d) {
    DecimalFormat formatter = (DecimalFormat) NumberFormat.getInstance(Locale.US);
    formatter.applyPattern("#,###");
    return formatter.format(d);
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-08-06T08:39:31.140

这个[示例应用程序](http://www.devexchanges.info/2016/04/android-tip-format-number-in-edittext.html)清楚地解构了格式数字。

总结一下上面的链接，`TextWatcher`在`afterTextChanged()`方法格式中使用 a 和`EditText`具有以下逻辑的视图：

```
@Override
public void afterTextChanged(Editable s) {
    editText.removeTextChangedListener(this);

    try {
        String originalString = s.toString();

        Long longval;
        if (originalString.contains(",")) {
            originalString = originalString.replaceAll(",", "");
        }
        longval = Long.parseLong(originalString);

        DecimalFormat formatter = (DecimalFormat) NumberFormat.getInstance(Locale.US);
        formatter.applyPattern("#,###,###,###");
        String formattedString = formatter.format(longval);

        //setting text after format to EditText
        editText.setText(formattedString);
        editText.setSelection(editText.getText().length());
    } catch (NumberFormatException nfe) {
        nfe.printStackTrace();
    }

    editText.addTextChangedListener(this);
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-12-08T22:21:23.593

我知道我参加聚会很晚，但它可能对未来的用户非常有用。我的回答是[Shree Krishna](https://stackoverflow.com/a/34265406/6748052)回答的延伸。

改进：

1.  数千个分隔符和十进制标记是区域设置感知的，即它们根据`Locale`设备的使用。
2.  在中间删除或添加元素后光标位置也不会改变（在他的答案中光标被重置到最后）。
3.  代码的整体质量得到了特别的改进`getDecimalFormattedString`。

代码：

```
 import android.text.Editable;
    import android.text.TextWatcher;
    import android.widget.EditText;

    import java.text.DecimalFormat;

    /**
     * Created by srv_twry on 4/12/17.
     * Source: https://stackoverflow.com/a/34265406/137744
     * The custom TextWatcher that automatically adds thousand separators in EditText.
     */

    public class ThousandSeparatorTextWatcher implements TextWatcher {

        private DecimalFormat df;
        private EditText editText;
        private static String thousandSeparator;
        private static String decimalMarker;
        private int cursorPosition;

        public ThousandSeparatorTextWatcher(EditText editText) {
            this.editText = editText;
            df = new DecimalFormat("#,###.##");
            df.setDecimalSeparatorAlwaysShown(true);
            thousandSeparator = Character.toString(df.getDecimalFormatSymbols().getGroupingSeparator());
            decimalMarker = Character.toString(df.getDecimalFormatSymbols().getDecimalSeparator());
        }

        @Override
        public void beforeTextChanged(CharSequence charSequence, int start, int count, int after) {
            cursorPosition = editText.getText().toString().length() - editText.getSelectionStart();
        }

        @Override
        public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {}

        @Override
        public void afterTextChanged(Editable s) {
            try {
                editText.removeTextChangedListener(this);
                String value = editText.getText().toString();

                if (value != null && !value.equals("")) {
                    if (value.startsWith(decimalMarker)) {
                        String text = "0" + decimalMarker;
                        editText.setText(text);
                    }
                    if (value.startsWith("0") && !value.startsWith("0" + decimalMarker)) {
                        int index = 0;
                        while (index < value.length() && value.charAt(index) == '0') {
                            index++;
                        }
                        String newValue = Character.toString(value.charAt(0));
                        if (index != 0) {
                            newValue = value.charAt(0) + value.substring(index);
                        }
                        editText.setText(newValue);
                    }
                    String str = editText.getText().toString().replaceAll(thousandSeparator, "");
                    if (!value.equals("")) {
                        editText.setText(getDecimalFormattedString(str));
                    }
                    editText.setSelection(editText.getText().toString().length());
                }

                //setting the cursor back to where it was
                editText.setSelection(editText.getText().toString().length() - cursorPosition);
                editText.addTextChangedListener(this);
            } catch (Exception ex) {
                ex.printStackTrace();
                editText.addTextChangedListener(this);
            }
        }

        private static String getDecimalFormattedString(String value) {

            String[] splitValue = value.split("\\.");
            String beforeDecimal = value;
            String afterDecimal = null;
            String finalResult = "";

            if (splitValue.length == 2) {
                beforeDecimal = splitValue[0];
                afterDecimal = splitValue[1];
            }

            int count = 0;
            for (int i = beforeDecimal.length() - 1; i >= 0 ; i--) {
                finalResult = beforeDecimal.charAt(i) + finalResult;
                count++;
                if (count == 3 && i > 0) {
                    finalResult = thousandSeparator + finalResult;
                    count = 0;
                }
            }

            if (afterDecimal != null) {
                finalResult = finalResult + decimalMarker + afterDecimal;
            }

            return finalResult;
        }

        /*
        * Returns the string after removing all the thousands separators.
        * */
        public static String getOriginalString(String string) {
            return string.replace(thousandSeparator,"");
        }
    } 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-09-01T03:41:43.753

与其他答案相比，此解决方案具有一些优势。例如，即使用户编辑数字的开头或中间，它也会保留用户的光标位置。*其他解决方案总是将光标跳到数字的末尾*。它处理**小数和整数**，以及使用除`.`小数分隔符和`,`千位分组分隔符以外的字符的语言环境。

```
class SeparateThousands(val groupingSeparator: String, val decimalSeparator: String) : TextWatcher {

    private var busy = false

    override fun afterTextChanged(s: Editable?) {
        if (s != null && !busy) {
            busy = true

            var place = 0

            val decimalPointIndex = s.indexOf(decimalSeparator)
            var i = if (decimalPointIndex == -1) {
                s.length - 1
            } else {
                decimalPointIndex - 1
            }
            while (i >= 0) {
                val c = s[i]
                if (c == groupingSeparator[0] ) {
                    s.delete(i, i + 1)
                } else {
                    if (place % 3 == 0 && place != 0) {
                        // insert a comma to the left of every 3rd digit (counting from right to
                        // left) unless it's the leftmost digit
                        s.insert(i + 1, groupingSeparator)
                    }
                    place++
                }
                i--
            }

            busy = false
        }
    }

    override fun beforeTextChanged(s: CharSequence?, start: Int, count: Int, after: Int) {
    }

    override fun onTextChanged(s: CharSequence?, start: Int, before: Int, count: Int) {
    }
} 
```

然后在xml中：

```
 <EditText
    android:id="@+id/myNumberField"
    android:digits=",.0123456789"
    android:inputType="numberDecimal"
    .../> 
```

最后注册观察者：

```
findViewById(R.id.myNumberField).addTextChangedListener(
    SeparateThousands(groupingSeparator, decimalSeparator)) 
```

处理 。vs ，在不同的语言环境中使用 groupingSeparator 和 decimalSeparator，它们可以来自 DecimalFormatSymbols 或本地化字符串。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-09-14T03:43:22.930

这是我的`ThousandNumberEditText`课

```
public class ThousandNumberEditText extends android.support.v7.widget.AppCompatEditText {
    // TODO: 14/09/2017 change it if you want 
    private static final int MAX_LENGTH = 20;
    private static final int MAX_DECIMAL = 3;

    public ThousandNumberEditText(Context context) {
        this(context, null);
    }

    public ThousandNumberEditText(Context context, AttributeSet attrs) {
        this(context, attrs, android.support.v7.appcompat.R.attr.editTextStyle);
    }

    public ThousandNumberEditText(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
        init();
    }

    private void init() {
        addTextChangedListener(new ThousandNumberTextWatcher(this));
        setInputType(InputType.TYPE_CLASS_NUMBER | InputType.TYPE_NUMBER_FLAG_DECIMAL);
        setFilters(new InputFilter[] { new InputFilter.LengthFilter(MAX_LENGTH) });
        setHint("0"); // TODO: 14/09/2017 change it if you want 
    }

    private static class ThousandNumberTextWatcher implements TextWatcher {

        private EditText mEditText;

        ThousandNumberTextWatcher(EditText editText) {
            mEditText = editText;
        }

        @Override
        public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {
        }

        @Override
        public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
        }

        @Override
        public void afterTextChanged(Editable editable) {
            String originalString = editable.toString();
            String cleanString = originalString.replaceAll("[,]", "");
            if (cleanString.isEmpty()) {
                return;
            }
            String formattedString = getFormatString(cleanString);

            mEditText.removeTextChangedListener(this);
            mEditText.setText(formattedString);
            mEditText.setSelection(mEditText.getText().length());
            mEditText.addTextChangedListener(this);
        }

        /**
         * Return the format string
         */
        private String getFormatString(String cleanString) {
            if (cleanString.contains(".")) {
                return formatDecimal(cleanString);
            } else {
                return formatInteger(cleanString);
            }
        }

        private String formatInteger(String str) {
            BigDecimal parsed = new BigDecimal(str);
            DecimalFormat formatter;
            formatter = new DecimalFormat("#,###");
            return formatter.format(parsed);
        }

        private String formatDecimal(String str) {
            if (str.equals(".")) {
                return ".";
            }
            BigDecimal parsed = new BigDecimal(str);
            DecimalFormat formatter;
            formatter =
                    new DecimalFormat("#,###." + getDecimalPattern(str)); //example patter #,###.00
            return formatter.format(parsed);
        }

        /**
         * It will return suitable pattern for format decimal
         * For example: 10.2 -> return 0 | 10.23 -> return 00 | 10.235 -> return 000
         */
        private String getDecimalPattern(String str) {
            int decimalCount = str.length() - 1 - str.indexOf(".");
            StringBuilder decimalPattern = new StringBuilder();
            for (int i = 0; i < decimalCount && i < MAX_DECIMAL; i++) {
                decimalPattern.append("0");
            }
            return decimalPattern.toString();
        }
    }
} 
```

**使用**

```
<.ThousandNumberEditText
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    /> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-10-26T03:46:49.907

我只是想`comma`被安置，这对我有用：

```
String.format("%,.2f", myValue); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-03-31T18:41:08.910

您可以使用此方法：

```
myEditText.addTextChangedListener(new TextWatcher() {
                @Override
                public void beforeTextChanged(CharSequence s, int start, int count, int after) {
                }

                @Override
                public void onTextChanged(CharSequence s, int start, int before, int count) {

                    String input = s.toString();

                    if (!input.isEmpty()) {

                        input = input.replace(",", "");

                        DecimalFormat format = new DecimalFormat("#,###,###");
                        String newPrice = format.format(Double.parseDouble(input));

                        myEditText.removeTextChangedListener(this); //To Prevent from Infinite Loop

                        myEditText.setText(newPrice);
                        myEditText.setSelection(newPrice.length()); //Move Cursor to end of String

                        myEditText.addTextChangedListener(this);
                    }

                }

                @Override
                public void afterTextChanged(final Editable s) {
                }
            }); 
```

要获取原始文本，请使用以下命令：

```
String input = myEditText.getText().toString();
input = input.replace(",", ""); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-08-16T12:08:34.073

由于我有同样的问题，我决定找到解决方案

在下面找到我的功能我希望它可以帮助人们找到解决方案

```
securityDeposit.addTextChangedListener(new TextWatcher() {

            @Override
            public void onTextChanged(CharSequence s, int start,
                    int before, int count) {
                // TODO Auto-generated method stub

            }

            @Override
            public void beforeTextChanged(CharSequence s, int start,
                    int before, int count) {
                // TODO Auto-generated method stub

            }

            @Override
            public void afterTextChanged(Editable s) {
                // TODO Auto-generated method stub
                if (s.toString().trim().length() > 0) {
                    int rentValue = Integer.parseInt(s.toString()
                            .replaceAll(",", ""));
                    StringBuffer rentVal = new StringBuffer();
                    if (rentValue > 10000000) {
                        s.clear();
                        s.append("10,000,000");
                    } else {

                        if (s.length() == 4) {
                            char x[] = s.toString().toCharArray();

                            char y[] = new char[x.length + 1];
                            for (int z = 0; z < y.length; z++) {

                                if (z == 1) {
                                    y[1] = ',';

                                } else {
                                    if (z == 0)
                                        y[z] = x[z];
                                    else {
                                        y[z] = x[z - 1];
                                    }
                                }

                            }

                            for (int z = 0; z < y.length; z++) {
                                rentVal = rentVal.append(y[z]);
                            }

                            s.clear();
                            s.append(rentVal);

                        }

                    }
                }

            }
        }); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-01-19T12:41:13.177

你可以在你的程序中以多种方式使用这个代码，你给它一个字符串，它将每三个从右边分开并在那里放置空间。

```
private String Spacer(String number){
    StringBuilder strB = new StringBuilder();
    strB.append(number);
    int Three = 0;

    for(int i=number.length();i>0;i--){
        Three++;
        if(Three == 3){
            strB.insert(i-1, " ");
            Three = 0;
        }
    }
    return strB.toString();
}// end Spacer() 
```

你可以稍微改变一下并在textchangelistener上使用它。祝你好运

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-05-28T13:11:23.753

这里的答案缺乏处理实际用户输入的方法，例如删除字符或复制和粘贴。这是一个 EditText 字段。如果要添加格式，则需要支持编辑该格式化值。

根据您的用例，此实现仍然存在缺陷。我不关心十进制值，并假设我只会处理整数。关于如何处理这个页面以及如何处理实际的国际化已经足够了，我将把它作为练习留给读者。如果您需要这样做，添加“。”应该不会太难。到正则表达式保持小数；您只需要小心确认数字字符串仍然具有非数字字符。

这旨在用于多个活动。新建一次，给它你的编辑文本和数据模型，然后忽略它。如果不需要，可以删除模型绑定。

```
public class EditNumberFormatter implements TextWatcher {

    private EditText watched;
    private Object model;
    private Field field;
    private IEditNumberFormatterListener listener;

    private ActiveEdit activeEdit;

    /**
     * Binds an EditText to a data model field (Such as a room entity's public variable)
     * Whenever the edit text is changed, the text is formatted to the local numerical format.
     *
     * Handles copy/paste/backspace/select&delete/typing
     *
     * @param model An object with a public field to bind to
     * @param fieldName A field defined on the object
     * @param watched The edit text to watch for changes
     * @param listener Another object that wants to know after changes & formatting are done.
     */
    public EditNumberFormatter(Object model, String fieldName, EditText watched, IEditNumberFormatterListener listener) {

        this.model = model;
        this.watched = watched;
        this.listener = listener;

        try {
            field = model.getClass().getDeclaredField(fieldName);
        } catch(Exception e) { }

        watched.addTextChangedListener(this);
    }

    @Override
    public void beforeTextChanged(CharSequence s, int start, int count, int after) {
        activeEdit = new ActiveEdit(s.toString(), start, count);
    }

    @Override
    public void onTextChanged(CharSequence s, int start, int before, int count) {
        activeEdit.recordChangedText(s.toString(),count);
    }

    @Override
    public void afterTextChanged(Editable s) {
        this.watched.removeTextChangedListener(this);

        activeEdit.processEdit(); // Override the user's edit of the formatted string with what the user intended to do to the numeral.

        watched.setText(activeEdit.getCurrentFormattedString());
        watched.setSelection(activeEdit.getCursorPosition());
        updateDataModel(activeEdit.getCurrentRawValue());

        listener.FormatUpdated(watched.getId(), activeEdit.getCurrentRawValue(), activeEdit.getCurrentFormattedString());

        this.watched.addTextChangedListener(this);
    }

    private void updateDataModel(int rawValue) {
        try {
            field.set(model, rawValue);
        } catch (IllegalAccessException e) { }
    }

    /**
     * Tracks the active editing of an EditText formatted for integer input
     */
    private class ActiveEdit {

        private String priorFormattedString;
        private String currentFormattedString;
        private String currentNumericalString;
        private int currentRawValue;

        private boolean removal;
        private boolean addition;

        private int changeStart;
        private int removedCount;
        private int additionCount;

        private int numeralCountBeforeSelection;
        private int numeralCountAdded;
        private int numeralCountRemoved;

        /**
         * Call in beforeEdit to begin recording changes
         *
         * @param beforeEdit string before edit began
         * @param start start position of edit
         * @param removed number of characters removed
         */
        public ActiveEdit(String beforeEdit, int start, int removed) {
            removal = (removed > 0);

            priorFormattedString = beforeEdit;
            changeStart = start;
            removedCount = removed;

            numeralCountBeforeSelection = countNumerals(priorFormattedString.substring(0, changeStart));
            numeralCountRemoved = countNumerals(priorFormattedString.substring(changeStart, changeStart + removedCount));
        }

        /**
         * Call in onTextChanged to record new text and how many characters were added after changeStart
         *
         * @param afterEdit new string after user input
         * @param added how many characters were added (same start position as before)
         */
        public void recordChangedText(String afterEdit, int added) {
            addition = (added > 0);
            additionCount = added;
            numeralCountAdded = countNumerals(afterEdit.substring(changeStart, changeStart + additionCount));

            currentNumericalString = afterEdit.replaceAll("[^0-9]", "");
        }

        /**
         * Re-process the edit for our particular formatting needs.
         */
        public void processEdit() {
            forceRemovalPastFormatting();
            finalizeEdit();
        }

        /**
         * @return Integer value of the field after an edit.
         */
        public int getCurrentRawValue() {
            return currentRawValue;
        }

        /**
         * @return Formatted number after an edit.
         */
        public String getCurrentFormattedString() {
            return currentFormattedString;
        }

        /**
         * @return Cursor position after an edit
         */
        public int getCursorPosition() {
            int numeralPosition = numeralCountBeforeSelection + numeralCountAdded;
            return positionAfterNumeralN(currentFormattedString,numeralPosition);
        }

        /**
         * If a user deletes a value, but no numerals are deleted, then delete the numeral proceeding
         * their cursor. Otherwise, we'll just add back the formatting character.
         *
         * Assumes formatting uses a single character and not multiple formatting characters in a row.
         */
        private void forceRemovalPastFormatting() {
            if (removal && (!addition) && (numeralCountRemoved == 0)) {
                String before = currentNumericalString.substring(0, numeralCountBeforeSelection - 1);
                String after = currentNumericalString.substring(numeralCountBeforeSelection);

                currentNumericalString =  before + after;
                numeralCountRemoved++;
                numeralCountBeforeSelection--;
            }
        }

        /**
         * Determine the result of the edit, including new display value and raw value
         */
        private void finalizeEdit() {
            currentFormattedString = "";
            currentRawValue = 0;
            if (currentNumericalString.length() == 0) {
                return; // There is no entry now.
            }
            try {
                currentRawValue = Integer.parseInt(currentNumericalString);
            } catch (NumberFormatException nfe) {
                abortEdit();  // Value is not an integer, return to previous state.
                return;
            }
            currentFormattedString = String.format("%,d", currentRawValue);
        }

        /**
         * Current text, same as the old text.
         */
        private void abortEdit() {
            currentFormattedString = priorFormattedString;
            currentNumericalString = currentFormattedString.replaceAll("[^0-9]", "");
            numeralCountRemoved = 0;
            numeralCountAdded = 0;
            try {
                currentRawValue = Integer.parseInt(currentNumericalString);
            } catch (Exception e) { currentRawValue = 0; }
        }

        /**
         * Determine how many numerical characters exist in a string
         * @param s
         * @return the number of numerical characters in the string
         */
        private int countNumerals(String s) {
            String newString = s.replaceAll("[^0-9]", "");
            return newString.length();
        }

        /**
         * Determine how to place a cursor after the Nth Numeral in a formatted string.
         * @param s - Formatted string
         * @param n - The position of the cursor should follow the "Nth" number in the string
         * @return the position of the nth character in a formatted string
         */
        private int positionAfterNumeralN(String s, int n) {
            int numeralsFound = 0;

            if (n == 0) {
                return 0;
            }

            for (int i = 0; i < s.length(); i++) {
                if(s.substring(i,i+1).matches("[0-9]")) {
                    if(++numeralsFound == n) {
                        return i + 1;
                    }
                }
            }
            return s.length();
        }
    }
} 
```

在高层次上，它的作用是：

*   确定在编辑后哪些数字实际上在字符串中
*   如果未编辑数字，则处理对字符串的数字版本的编辑
*   将数字转换回格式化字符串
*   根据编辑开始的位置和添加的文本量来确定光标的位置

它还可以很好地处理边缘情况，例如完全删除的输入、整数溢出和错误输入。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-01-18T14:58:47.190

您可以使用自定义**TextInputEditText**：

```
public class NumberTextInputEditText extends TextInputEditText {

public NumberTextInputEditText(@NonNull Context context) {
    super(context);
}

public NumberTextInputEditText(@NonNull Context context, @Nullable AttributeSet attrs) {
    super(context, attrs);
}

public NumberTextInputEditText(@NonNull Context context, @Nullable AttributeSet attrs, int defStyleAttr) {
    super(context, attrs, defStyleAttr);
}

@Override
protected void onAttachedToWindow() {
    super.onAttachedToWindow();
    addTextChangedListener(textWatcher);
}

public String formatNumber(double number) {
    DecimalFormat decimalFormat = new DecimalFormat("#,###");
    return decimalFormat.format(number);
}

public TextWatcher textWatcher = new TextWatcher() {
    @Override
    public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

    }

    @Override
    public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {

    }

    @Override
    public void afterTextChanged(Editable editable) {
        removeTextChangedListener(this);
        String text = getText().toString();
        String format = "";
        if (!TextUtils.isEmpty(text)) {
            try {
                format = formatNumber(Double.parseDouble(new BigDecimal(text.replaceAll(",", "")).toString()));
            } catch (NumberFormatException e) {
                format = "";
            }
            setText(format);
            setSelection(format.length());
        }
        addTextChangedListener(this);
    }
};} 
```

就像在你的布局中使用它一样：

```
<com.your.package.name.NumberTextInputEditText
  android:layout_width="match_parent"
  android:layout_height="wrap_content"/> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-09-14T11:34:01.040

在这里，我测试了我的应用程序代码。text-watcher 如何在千币、湖币中添加逗号。

```
 private TextWatcher textWatcherAmount = new TextWatcher() {
        @Override
        public void beforeTextChanged(CharSequence s, int start, int count, int after) {

        }

        @Override
        public void onTextChanged(CharSequence s, int start, int before, int count) {
            String initial = s.toString();

            if (inputEdtHawalaRate == null) return;

            if (!TextUtils.isEmpty(initial)) {

                initial = initial.replace(",", "");

                NumberFormat formatter = new DecimalFormat("##,##,###");

                inputEdtHawalaRate.removeTextChangedListener(this);

                double myNumber = Double.parseDouble(initial);
                String processed = formatter.format(myNumber);

                //Assign processed text
                inputEdtHawalaRate.setText(processed);

                try {
                    inputEdtHawalaRate.setSelection(processed.length());
                } catch (Exception e) {
                    e.printStackTrace();
                }

                //Give back the listener
                inputEdtHawalaRate.addTextChangedListener(this);

            }

        }

        @Override
        public void afterTextChanged(Editable s) {

        }
    };

 if (inputEdtHawalaRate != null) {
            inputEdtHawalaRate.addTextChangedListener(textWatcherAmount);
        } 
```

// 获取 double 类型变量的数量（在 textwatcher editetxt value get 上）。

```
String amount = Objects.requireNonNull(inputEdtHawalaRate.getText()).toString().trim();
double hawalaAmount = 0.0;

 String[] a = amount.split(",");
            finalAmount = TextUtils.join("", a);
            hawalaAmount = Double.parseDouble(finalAmount); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-10-03T09:37:18.017

由于我们的客户遍布全球，因此我一直在寻找一种区域设置感知解决方案。所以我建立在[dr0pdb](https://stackoverflow.com/a/47723018/5017972)的答案之上。

这是我为解决此问题而创建的 TextWatcher 类（在 kotlin 中）。

[https://github.com/abhilashd-locus/edittext-locale-aware-thousands-separator](https://github.com/abhilashd-locus/edittext-locale-aware-thousands-separator)

特征：

*   在用户键入时动态添加千位分隔符
*   在字符串之间启用编辑，而不仅仅是在结尾处
*   千位分隔样式基于区域设置（例如：100,000 与 1,00,000）
*   千位分隔符和十进制标记的符号基于区域设置（例如：100,000.00 与 100.000,00）
*   支持所有语言和地区

缺点：

*   不支持复制/粘贴操作
*   在从右到左的语言（例如阿拉伯语）中，光标会在删除第一个数字时跳到末尾

.

```
// ThousandsSeparatorTextWatcher.kt --> add this TextWatcher to the 
// EditText you want to add the functionality of dynamic locale aware thousands separator
class ThousandsSeparatorTextWatcher(private var editText: EditText?, private val callback: TextChangedCallback) : TextWatcher {

//keeping a count of the digits before the cursor to reset the cursor at the correct place
private var digitsBeforeCursor = -1
private val thousandSeparator: Char = DecimalFormatSymbols(Locale.getDefault()).groupingSeparator
private val decimalMarker: Char = DecimalFormatSymbols(Locale.getDefault()).decimalSeparator

init {
    editText?.apply {

        addTextChangedListener(this@ThousandsSeparatorTextWatcher)

        //disabling copy/paste to avoid format and parse errors
        disableTextSelection(this)

        //diabling text selection
        isLongClickable = false
        setTextIsSelectable(false)

        //ensuring correct input type
        keyListener = DigitsKeyListener.getInstance("0123456789$decimalMarker");
    }
}

private fun disableTextSelection(editText: EditText) {

    editText.customSelectionActionModeCallback = object : android.view.ActionMode.Callback {

        override fun onActionItemClicked(mode: android.view.ActionMode?, item: MenuItem?) = false

        override fun onCreateActionMode(mode: android.view.ActionMode?, menu: Menu?) = false

        override fun onPrepareActionMode(mode: android.view.ActionMode?, menu: Menu?) = false

        override fun onDestroyActionMode(mode: android.view.ActionMode?) {}
    }
}

/***
 * We are going to calculate the number of numeric digits before the cursor when user starts editing
 * We will keep a count of this number to reset the cursor to the correct position after editing is complete
 */
override fun beforeTextChanged(sequenceBeforeEdit: CharSequence, startPos: Int, count: Int, after: Int) {

    val textBeforeEdit = sequenceBeforeEdit.toString()

    if (textBeforeEdit.isEmpty()) {
        //in an empty string, cursor position is at 1 if a character is being added (after == 1)
        //if a character is not being added, cursor position remains at the beginning
        digitsBeforeCursor = if (after == 0) -1 else 1
        return
    }

    digitsBeforeCursor = if (after == 0) {
        //if characters are being removed
        //count will always be 1 since we have disabled selection (in which case count will be equal to the number of characters selected)
        val textBeforeNewCursor = textBeforeEdit.substring(0, startPos)
        textBeforeNewCursor.count { it != thousandSeparator }
    } else {
        //if characters are being added
        //after will always be 1 since we have disabled pasting (in which case after will be equal to the number of characters being pasted)
        if (startPos == textBeforeEdit.length) {
            //if adding a character to the end of the string
            textBeforeEdit.count { it != thousandSeparator } + 1
        } else {
            //if adding a character in between the string
            val textBeforeNewCursor = textBeforeEdit.substring(0, startPos + 1)
            textBeforeNewCursor.count { it != thousandSeparator }
        }
    }
}

override fun onTextChanged(textAfterEdit: CharSequence, start: Int, before: Int, count: Int) {}

/***
 * We will get the numeric value in the editText after stripping all the formatting
 * We will then reformat this number to add the correct thousands separation and decimal marker according to the locale
 * We then set the cursor to the correct position as we calculated in beforeTextChanged()
 */
override fun afterTextChanged(editable: Editable) {

    val text = editable.toString()

    //if the EditText is cleared, trigger callback with a null value to indicate an empty field
    if (text.isEmpty()) {
        digitsBeforeCursor = -1
        callback.onChanged(null)
        return
    }

    //get the double value of the entered number
    val numberValue = getNumberFromFormattedCurrencyText(text)

    //re-format the number to get the correct separation format and symbols
    var newText = getCurrencyFormattedAmountValue(numberValue)

    //If user was inputting decimal part of the number, reformatting will return a string without decimal point.
    //So we need to add it back after the reformatting is complete
    if (text.endsWith(decimalMarker)) {
        newText += decimalMarker
    } else if (text.endsWith(decimalMarker + "0")) {
        newText += decimalMarker + "0"
    }

    //removing the listener to prevent infinite triggers
    editText?.removeTextChangedListener(this)

    //set the reformatted text
    editText?.setText(newText)

    //send the number typed to the callback
    callback.onChanged(numberValue)

    //set the cursor to the right position after reformatting the string
    if (digitsBeforeCursor != -1) {
        var numbersParsed = 0
        for (i in newText.indices) {
            if (newText[i] != thousandSeparator) {
                numbersParsed++
            }
            if (numbersParsed == digitsBeforeCursor) {
                editText?.setSelection(i + 1)
                break
            }
        }
        digitsBeforeCursor = -1
    }

    //add the listener back
    editText?.addTextChangedListener(this)
}

/***
 * Function to remove the listener and release reference to the EditText
 */
fun removeWatcherFromEditText() {
    editText?.removeTextChangedListener(this)
    editText = null
}

interface TextChangedCallback {
    fun onChanged(newNumber: Double?)
}

companion object{

    @JvmStatic
    fun getNumberFromFormattedCurrencyText(formattedText: String?) = formattedText?.let {
        val numberFormat = NumberFormat.getNumberInstance(Locale.getDefault())
        try {
            numberFormat.parse(it)?.toDouble()
        } catch (exception: ParseException) {
            0.0
        }
    } ?: 0.0

    @JvmStatic
    fun getCurrencyFormattedAmountValue(amount: Double?) = amount?.let {
        val numberFormat = NumberFormat.getNumberInstance(Locale.getDefault())
        numberFormat.maximumFractionDigits = 2
        numberFormat.format(amount)
    } ?: ""
}
} 
```**

# ruby - Ruby：如何在查询结果中获取数组而不是 DataMapper::Collection

> ID：12338448
> 
> 赞同：0
> 
> 时间：2012-09-09T10:51:49.883
> 
> 标签：ruby, arrays, collections, datamapper, ruby-datamapper

这是我的代码：

`today_ids_from_db = Rating.all(:fields => 'my_id', :ts_d => Time.now)`

`today_ids_from_db.class == DataMapper::Collection`

但我需要获得带有 my_id 值的简单 ruby​​ 数组

如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:38:13.890

你也可以试试这个叫做**Activerecord**的美[`pluck`](http://api.rubyonrails.org/classes/ActiveRecord/Calculations.html#method-i-pluck)

```
Rating.where(:ts_d => Time.now).pluck(:my_id) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T10:58:54.797

试试这个代码

```
Rating.all(:ts_d => Time.now).map(&:my_id) 
```

# scala - 在类型系统的上下文中，什么是“种类”？

> ID：12338450
> 
> 赞同：6
> 
> 时间：2012-09-09T10:52:39.777
> 
> 标签：scala, types, higher-kinded-types, type-constructor

我已经阅读了维基百科的文章并搜索了明显的地方，但我被困住了。有人可以简单地告诉我 Kind 到底是什么吗？这有什么用途 ？

Scala 示例最受赞赏

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-09T12:22:59.373

简而言之：一种*类型*对*类型*的意义就像*类型*对*值*的意义一样。

什么是*价值*？`1`, `2`,`3`是值。`"Hello"`和`"World"`、`true`和`false`等等也是如此。

值属于*类型*。类型描述了一组值。`1`,属于类型`2`,属于类型,属于类型。`3``Nat``"Hello"``"World"``Text``true``false``Boolean`

*函数*将一个或多个值作为参数并产生一个或多个值作为结果。为了有意义地对参数做一些事情，函数需要对它们做出一些假设，这是通过约束它们的类型来完成的。因此，函数参数和返回值通常也有类型。

现在，一个函数也有一个类型，它由它的输入和输出的类型来描述。例如，`abs`计算数字绝对值的函数具有以下类型

```
Number -> NonNegativeNumber 
```

两个数相加的函数`add`有类型

```
(Number, Number) -> Number 
```

该函数`divmod`具有类型

```
(Number, Number) -> (Number, Number) 
```

好的，但是如果函数将值作为参数并产生值作为结果，并且函数是值，那么函数也可以将函数作为参数并将函数作为结果返回，对吗？这种函数的类型是什么？

假设我们有一个函数`findCrossing`可以找到其他一些函数（数字）穿过 y 轴的点。它将函数作为参数并生成一个数字作为结果：

```
(Number -> Number) -> Number 
```

或者一个`makeAdder`产生一个函数的函数，该函数接受一个数字并向其添加一个特定的数字：

```
Number -> (Number -> Number) 
```

还有一个计算另一个函数导数的函数：

```
(Number -> Number) -> (Number -> Number) 
```

让我们看看这里的抽象级别：值是非常具体的东西。它只意味着一件事。如果我们在这里对抽象级别进行排序，我们可以说一个值的顺序为 0。

一个函数，OTOH 更抽象：一个函数可以产生许多不同的值。所以，它有订单 1。

返回或接受函数的函数更加抽象：它可以产生许多不同的函数，这些函数可以产生许多不同的值。它有订单 2。

通常，我们将所有阶数 > 1 的东西称为“*高阶*”。

好的，但是*种类*呢？好吧，我们在上面说过`1`, `2`,`"Hello"`等`false`有类型。但是 的类型是`Number`什么？或者`Text`？或者`Boolean`？

好吧，它的类型`Type`当然是 ！这种“类型的类型”称为*kind*。

就像我们可以拥有从值构造值的函数一样，我们也可以拥有从类型构造类型的函数。这些函数称为*类型构造函数*。

就像函数有类型一样，类型构造函数也有种类。例如，`List`类型构造函数，它接受一个元素类型并为该元素生成一个列表类型，它有 kind

```
Type -> Type 
```

类型构造`Map`函数，它接受一个键类型和一个值类型并产生一个映射类型

```
(Type, Type) -> Type 
```

现在，继续类比，如果我们可以拥有将函数作为参数的函数，我们是否也可以拥有将类型构造函数作为参数的类型构造函数？当然！

一个例子是`Functor`类型构造函数。它接受一个类型构造函数并产生一个类型：

```
(Type -> Type) -> Type 
```

注意我们总是在这里写`Type`吗？上面，我们有许多不同的类型，例如,`Number`等。在这里，我们*总是*只有一种类型，即。这对（警告，双关语不好）类型来说很乏味，所以我们不用到处写，而是写. 即有那种`Text``Boolean`*`Type``Type``*``Functor`*

 *```
(* -> *) -> * 
```

并且`Number`有那种

```
* 
```

继续类比，`Number`和`Text`所有其他种类`*`的顺序为 0，`List`所有其他种类`* -> *`或更一般地`(*, …) -> (*, …)`具有顺序 1，`Functor`并且所有种类`(* -> *) -> *`或`* -> (* -> *)`（等等）具有顺序 2。除了在这种情况下，我们有时也称它为*等级*而不是订单。

高于 order/rank 1 的所有内容都称为high *-order*、*higher-rank*或*high-kinded*。

我希望这个类比现在很清楚了：类型描述了一组值；种类描述了类型的集合。

* * *

旁白：我完全忽略了柯里化。基本上，柯里化意味着您可以将任何接受两个值的函数转换为一个接受一个值并返回一个接受另一个值的函数，对于三个、四个、五个……参数也是如此。这意味着您只需要处理只有一个参数的函数，这使语言变得更加简单。

但是，这也意味着从技术上讲，`add`它是一个混淆定义的高阶函数（因为它返回一个函数）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-09T22:23:15.847

The most eloquent explanation for kinds/higher-kinds I've seen so far and also in the context of Scala is [Daniel Spiewak's High Wizardry in the Land of Scala](http://vimeo.com/28793245). There are many versions, he gave this talk a few times, here I've chosen the longest one, but you can quickly google and find others.

The most important message from this talk is exactly the answer given by @Jörg W Mittag:

"kind is to types what a type is to values"

Another place for a more theoretical view on the subject is the paper [Generics of a Higher Kind](http://adriaanm.github.com/files/higher.pdf), also in the context of Scala.*

# asp.net - 是否可以将 HTML 转换为 Richtext 格式？

> ID：12338454
> 
> 赞同：0
> 
> 时间：2012-09-09T10:53:01.507
> 
> 标签：asp.net, freetext

我有一个`freetextbox`并且想将它的输出转换为`richtext`格式。例如，这是我的自由文本的文本：

```
<b>loblob</b> 
```

如何将其转换为 Richtext 格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T15:09:51.137

嗯，之前有人问过这个问题： [HTML to RTF Converter for .NET](https://stackoverflow.com/questions/2042843/html-to-rtf-converter-for-net)

CodeProject 中有一个非常基本的示例：http: [//www.codeproject.com/Articles/11252/Gios-WORD-NET-Library-using-RTF-specification](http://www.codeproject.com/Articles/11252/Gios-WORD-NET-Library-using-RTF-specification)

不过，你需要工作一点，这并不容易

# eclipse - eclipse : 过滤 System.out.print 调用

> ID：12338455
> 
> 赞同：1
> 
> 时间：2012-09-09T10:53:01.913
> 
> 标签：eclipse

我想检查一下，这样当我检查我的代码时，任何打印命令都不会被检查到 svn 中。我在 Eclipse 上安装了“Checkstyle”插件，但问题是即使打印命令已被注释掉，它也会出错。

我的要求是忽略注释中的打印命令，而不是主代码中的打印命令。

这方面的任何信息都会对 gr8 有所帮助。

问候 Lokesh

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:52:28.003

正如您在评论中告诉我的，您使用了使用正则表达式的自定义规则`"System\.out\.println"`。这似乎匹配包含该字符串的每一行，即使它之前有注释。您必须更改您的正则表达式以仅匹配命令之前不包含`//`的行。`"(?!//).*System\.out\.println"`应该管用。

**编辑**

只记得 PMD 有一个使用的集成规则`System.out.println()`。您可以将其用作自定义检查样式规则的替代方法。遗憾的是，Eclipse 插件还不适用于 Juno，但如果您使用早期版本，您应该没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T16:27:55.547

我可以通过使用“Miscellaneous”[Preferences -> checkstyle->Miscellaneous->Regex] 下的“Regex”选项来解决这个问题，因为它可以选择忽略注释。

谢谢大家的帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-14T14:08:05.377

我已经过滤了对“System.out”和“System.err”的调用，使用[RegexpSingleLineJava](http://checkstyle.sourceforge.net/config_regexp.html#RegexpSinglelineJava)检查并`^System\.(out|err)\.print(ln|f){0,1}\(.*\)`作为正则表达式参数

# compiler-construction - gtkmm 编译器错误代码块窗口

> ID：12338457
> 
> 赞同：2
> 
> 时间：2012-09-09T10:53:19.057
> 
> 标签：compiler-construction, gtk, codeblocks, gtkmm

试图在代码块中编译一个简单的 gtkmm 应用程序，但只是得到有关 ustring.h 文件的错误

```
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h|861|error: ISO C++ forbids declaration of `wostringstream' with no type|
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h|861|error: expected `;' before "StreamType"|
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h|865|error: `StreamType' does not name a type|
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h|906|error: expected constructor, destructor, or type conversion before '&' token|
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h|906|error: expected `,' or `;' before '&' token|
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h|912|error: expected constructor, destructor, or type conversion before '&' token|
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h|912|error: expected `,' or `;' before '&' token|
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h||In member function `void Glib::ustring::FormatStream::stream(const T&)':|
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h|1057|error: `stream_' undeclared (first use this function)|
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h|1057|error: (Each undeclared identifier is reported only once for each function it appears in.)|
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h||In member function `void Glib::ustring::FormatStream::stream(const char*)':|
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h|1063|error: `stream_' undeclared (first use this function)|
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h||In member function `void Glib::ustring::FormatStream::stream(char*)':|
C:\gtkmm\include\glibmm-2.4\glibmm\ustring.h|1069|error: `stream_' undeclared (first use this function)|
||=== Build finished: 11 errors, 0 warnings ===| 
```

`pkg-config --libs gtkmm-2.4`使用我添加到链接器选项和编译器的构建选项`pkg-config --cflags gtkmm-2.4`-> 其他选项。

我使用的代码是一个简单的例子

```
#include <gtkmm.h>

int main(int argc, char *argv[])
{
  Glib::RefPtr<Gtk::Application> app =
    Gtk::Application::create(argc, argv,
      "org.gtkmm.examples.base");

  Gtk::ApplicationWindow window;

  return app->run(window);
} 
```

任何帮助将不胜感激，我正在运行 win7 x64

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T18:31:19.077

如果要使用`Gtk::Application`et al，至少需要使用gtkmm-3.4。应用程序是 gtk 3.x 类，直到 gtkmm-3.4 才正确包装。

# android - 尝试从 android 活动访问 url

> ID：12338459
> 
> 赞同：0
> 
> 时间：2012-09-09T10:53:27.763
> 
> 标签：android, httpurlconnection

我想在我的 android 活动中访问一个 url，用于存储一个字符串，该字符串作为参数传递给 url 本身，并带有我构建的 web 服务。此时，我只想访问 url 并查看它是否发生，稍后我会担心对结果做一些事情（请求返回什么）。我正在使用 HttpURLConnection。我收到此错误：

```
D/SntpClient(   59): request time failed: java.net.SocketException: Address fami
ly not supported by protocol 
```

我的代码是：

```
public void storeScore()
{
    Log.d("storeScore","is running");
    HttpURLConnection con = null;
    //DefaultHttpClient
    try {
        URL url = new URL("http://www.google.com");
        con = (HttpURLConnection) url.openConnection();
        con.setReadTimeout(10000);
        con.setConnectTimeout(15000);
        con.setRequestMethod("GET");
        con.setDoInput(true); //also tried without this
        con.setDoOutput(true); //also tried without this
        con.connect();
        Log.d("storeScore","got to connect");
        //not really reading the result at this point:
        //BufferedReader reader = new BufferedReader(new InputStreamReader(con.getInputStream(), "UTF-8"));
        //String payload = reader.readLine();
        //reader.close();
    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        Log.d("MalformedURLException",e.getMessage());
    } catch (IOException e) {
        // TODO Auto-generated catch block
        Log.d("IOException",e.getMessage());
        e.printStackTrace();
    }

} 
```

应用程序 android 清单包含两个权限：

```
<uses-permission android:name="android.permission.INTERNET"></uses-permission>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"></uses-permission> 
```

此方法 storeScore() 从创建 onCreate 并启动的线程运行。我在这里做错了吗？如果您需要我没有在此处添加的更多相关信息，请告诉我，我将编辑问题。谢谢，我很感激任何帮助。

# java - 如何处理 Bean 验证异常

> ID：12338463
> 
> 赞同：2
> 
> 时间：2012-09-09T10:53:59.587
> 
> 标签：java, bean-validation

我有一个根据：

```
@Entity
public class Car {

    @Id
    @GeneratedValue
    private Long id;

    @NotNull
    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "OWNER_ID")       
    private Owner owner;

    @NotNull()
    @Column(nullable = false)
    private String make;

    @NotNull() 
    @Column(nullable = true)
    private String model;

    @Column(nullable = false)
    private String gears;

    // More fields 
```

假设我正在尝试 percist 对象和一个字段，例如 make field ，它不应该是 null 。抛出以下异常：

```
WARNING: EJB5184:A system exception occurred during an invocation on EJB CarEJB, method: public se.while_se.domain.Car se.while_se.business.CarEJB.createCar(se.while_se.domain.Car)
Sep 09, 2012 12:37:37 PM com.sun.ejb.containers.BaseContainer postInvoke
WARNING: 
javax.ejb.EJBException
        at com.sun.ejb.containers.BaseContainer.processSystemException(BaseContainer.java:5215)
        at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5113)
        at com.sun.ejb.containers.BaseContainer.postInvokeTx(BaseContainer.java:4901)
        at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:2045)
        at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:1994)
        at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:222)
        at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:88)
        at $Proxy137.createCar(Unknown Source)
        at se.while_se.business.__EJB31_Generated__CarEJB__Intf____Bean__.createCar(Unknown Source)
        at test.CarTest.populate(CarTest.java:197)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
        at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
        at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
        at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)
        at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
        at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:45)
        at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:123)
        at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:104)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:164)
        at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:110)
        at org.apache.maven.surefire.booter.SurefireStarter.invokeProvider(SurefireStarter.java:175)
        at org.apache.maven.surefire.booter.SurefireStarter.runSuitesInProcessWhenForked(SurefireStarter.java:107)
        at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:68)
Caused by: javax.validation.ConstraintViolationException: Bean Validation constraint(s) violated while executing Automatic Bean Validation on callback event:'prePersist'. Please refer to embedded ConstraintViolations for details. 
```

我想做的是找到一个最佳实践来验证实体，然后再将其保存在数据库中。当然，我可以在实体类中实现一个帮助方法，例如：

```
public boolean validate() {
        if(owner == null) {            
            return false;
        }
        if(make == null) {
            return false;
        }
        if(model == null) {
            return false;
        } 
        return true;
    } 
```

但这感觉不是正确的方法。你能指导我吗？

此致

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-09T12:23:43.093

您可以并且应该在像这样持久化之前验证实体并返回适当的错误：

```
Validator validator = Validation.buildDefaultValidatorFactory().getValidator();
Set<ConstraintViolation<Car>> constraintViolations = validator.validate(myCar);

if (constraintViolations.size() > 0) {
    Set<String> violationMessages = new HashSet<String>();

    for (ConstraintViolation<T> constraintViolation : constraintViolations) {
        violationMessages.add(constraintViolation.getPropertyPath() + ": " + constraintViolation.getMessage());
    }

    throw new RuntimeException("Car is not valid:\n" + StringUtils.join(violationMessages, "\n"));
} 
```

# algorithm - 表达式的计算复杂度

> ID：12338468
> 
> 赞同：0
> 
> 时间：2012-09-09T10:54:52.757
> 
> 标签：algorithm, complexity-theory, time-complexity, matrix-multiplication

我想知道以下表达式的时间复杂度是多少：

![在此处输入图像描述](../Images/36d935030f3d2a4a6e4e0e3368ddd3da.png)

其中`A` 和`Y` 是 非零的`n×n` 稀疏矩阵， 和 是 向量。`nnz``x``y``n×1`

我发现`(A*A*A)*x`如果我们将其计算为`A*(A*(A*x))`. 那么有没有一些记忆技术可以用来有效地计算这个表达式？

# scala - 隐式参数不适用于 unapply。如何从提取器中隐藏无处不在的参数？

> ID：12338469
> 
> 赞同：4
> 
> 时间：2012-09-09T10:55:01.153
> 
> 标签：scala, pattern-matching, implicit, extractor

显然，提取器对象中的 unapply/unapplySeq 不支持隐式参数。假设这里有一个有趣的参数 a，以及一个令人不安的无处不在的参数 b，当提取 c 时，它会很好地隐藏起来。

[**编辑**]：似乎我的 intellij/scala-plugin 安装中出现了一些问题，导致了这种情况。我无法解释。我的智能最近遇到了许多奇怪的问题。重新安装后，我无法再重现我的问题。确认 unapply/unapplySeq 确实允许隐式参数！谢谢你的帮助。

**这不起作用（**编辑**：是的，确实如此）：**

```
trait A; trait C; trait B { def getC(a: A): C }

def unapply(a:A)(implicit b:B):Option[C] = Option(b.getC(a)) 
```

根据我对理想提取器应该是什么样子的理解，其中意图对于 Java 人员来说也很直观，这个限制基本上禁止了依赖于附加参数的提取器对象。

**您通常如何处理此限制？**

到目前为止，我有这四种可能的解决方案：

1）我想改进的最简单的解决方案：不要隐藏b，提供参数b和a，作为元组形式的unapply的普通参数：

```
object A1{ 
    def unapply(a:(A,B)):Option[C] = Option(a._2.getC(a._1)) } 
```

在客户端代码中：

```
 val c1 = (a,b) match { case A1(c) => c1 } 
```

我不喜欢它，因为这里有更多的噪音偏离将 a 解构为 c 很重要。此外，由于必须说服 Java 人员实际使用此 scala 代码，因此面临着一种额外的语法新颖性（元组大括号）。他们可能会得到反 scala 攻击“这都是什么？......为什么不首先使用正常方法并检查是否？”。

2) 在封装了对特定 B 的依赖的类中定义提取器，导入该实例的提取器。在导入站点对于 java 人来说有点不寻常，但是在模式匹配站点 b 被很好地隐藏了，并且直观地很明显会发生什么。我最喜欢的。我错过了一些缺点？

```
class BDependent(b:B){ 
   object A2{ 
    def unapply(a:A):Option[C] = Option(b.getC(a))
         } } 
```

客户端代码中的用法：

```
val bDeps = new BDependent(someB)
import bDeps.A2 
val a:A = ...
val c2 = a match { case A2(c) => c }
} 
```

3) 在客户端代码范围内声明提取器对象。b 是隐藏的，因为它可以在本地范围内使用“b”。妨碍代码重用，严重污染客户端代码（此外，在代码使用之前必须说明）。

4) 具有函数 B => C 的 unapply return 选项。这允许导入和使用依赖于参数的提取器，而无需将 b 直接提供给提取器，而是在使用时提供结果。Java 人可能对函数值的使用感到困惑，b 不是隐藏的：

```
 object A4{
  def unapply[A,C](a:A):Option[B => C] = Option((_:B).getC(a))
   } 
```

然后在客户端代码中：

```
 val b:B = ...
 val soonAC: B => C = a match { case A4(x) => x }
 val d = soonAC(b).getD ... 
```

补充说明：

*   正如[这个答案](https://stackoverflow.com/questions/6736569/scala-implicit-conversion-with-unapply)所建议的，“视图边界”可能有助于让提取器与隐式*转换*一起工作，但这对隐式*参数*没有帮助。出于某种原因，我不喜欢使用隐式转换来解决。
*   调查了“上下文边界”，但它们似乎有相同的限制，不是吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T11:40:22.743

你的第一行代码在什么意义上不起作用？对于提取器方法的隐式参数列表当然没有任意禁止。

考虑以下设置（我使用普通的旧类而不是案例类来表明这里没有发生额外的魔法）：

```
class A(val i: Int)
class C(val x: String)
class B(pre: String) { def getC(a: A) = new C(pre + a.i.toString) } 
```

现在我们定义一个隐式`B`值并使用您的方法创建一个提取器对象`unapply`：

```
implicit val b = new B("prefix: ")

object D {
  def unapply(a: A)(implicit b: B): Option[C] = Option(b getC a)
} 
```

我们可以这样使用：

```
scala> val D(c) = new A(42)
c: C = C@52394fb3

scala> c.x
res0: String = prefix: 42 
```

完全符合我们的预期。我不明白为什么你需要一个解决方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T11:52:19.637

您遇到的问题是隐式参数是编译时（静态）约束，而模式匹配是运行时（动态）方法。

```
trait A; trait C; trait B { def getC(a: A): C }

object Extractor {
  def unapply(a: A)(implicit b: B): Option[C] = Some(b.getC(a))
}

// compiles (implicit is statically provided)
def withImplicit(a: A)(implicit b: B) : Option[C] = a match { 
  case Extractor(c) => Some(c)
  case _            => None
}

// does not compile
def withoutImplicit(a: A) : Option[C] = a match { 
  case Extractor(c) => Some(c)
  case _            => None
} 
```

所以这是一个概念问题，解决方案取决于您实际想要实现的目标。如果你想要一些类似于可选隐式的东西，你可以使用以下内容：

```
sealed trait FallbackNone {
  implicit object None extends Optional[Nothing] {
    def toOption = scala.None
  }
}
object Optional extends FallbackNone {
  implicit def some[A](implicit a: A) = Some(a)
  final case class Some[A](a: A) extends Optional[A] { 
    def toOption = scala.Some(a)
  }
}
sealed trait Optional[+A] { def toOption: Option[A]} 
```

那么你拥有的地方`implicit b: B`将拥有`implicit b: Optional[B]`：

```
object Extractor {
   def unapply(a:A)(implicit b: Optional[B]):Option[C] = 
      b.toOption.map(_.getC(a))
}

def test(a: A)(implicit b: Optional[B]) : Option[C] = a match { 
   case Extractor(c) => Some(c)
   case _            => None
} 
```

以下都编译：

```
test(new A {}) // None

{
  implicit object BImpl extends B { def getC(a: A) = new C {} }
  test(new A {}) // Some(...)
} 
```

# memory - CUDA 对二维块的合并访问

> ID：12338471
> 
> 赞同：3
> 
> 时间：2012-09-09T10:55:08.877
> 
> 标签：memory, cuda

对于一维案例，我已经非常了解 CUDA 中全局内存的整个合并访问要求。

但是我对二维情况有点卡住了（也就是说，我们有一个二维网格，由二维块组成）。

假设我有一个向量`in_vector`，并且在我的内核中我想以合并的方式访问它。像这样：

```
__global__ void my_kernel(float* out_matrix, float* in_vector, int size)
{
   int i = blockIdx.x * blockDim.x + threadIdx.x;
   int j = blockIdx.y * blockDim.y + threadIdx.y;
   // ...
   float vx = in_vector[i]; // This is good. Here we have coalesced access
   float vy = in_vector[j]; // Not sure about this. All threads in my warp access the same global address. (See explanation)
   // ...
   // Do some calculations... Obtain result
} 
```

在我对这种 2D 案例的理解中，块内的线程以列为主的方式“排列”。例如：假设一个 (threadIdx.x, threadIdx.y) 符号：

*   第一个扭曲是：(0, 0), (1, 0), (2, 0), ..., (31, 0),
*   第二个扭曲将是：(0, 1), (1, 1), (2, 1), ..., (31, 1),
*   等等...

在这种情况下，调用`in_vector[i]`给了我们一个合并的访问，因为同一个 warp 中的每个连续线程都将访问连续的地址。然而调用`in_vector[j]`似乎是一个坏主意，因为每个连续线程将访问全局内存中的相同地址（例如，warp 0 中的所有线程都将访问 in_vector[0]，这将给我们 32 个不同的全局内存请求）

我理解正确吗？如果是这样，我怎样才能使用合并访问全局内存`in_vector[j]`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-09T12:25:33.603

您在问题中显示的内容仅适用于某些块大小。您的“合并”访问权限：

```
int i = blockIdx.x * blockDim.x + threadIdx.x;
float vx = in_vector[i]; 
```

仅当大于或等于 32时才会导致`in_vector`从全局内存的合并访问。即使在合并的情况下，共享相同值的块中的每个线程都会从全局内存中读取相同的单词，这似乎是违反直觉的和浪费。`blockDim.x``threadIdx.x`

确保每个线程的读取是唯一的并合并的正确方法是计算块内的线程数和网格内的偏移量，可能类似于：

```
int tid = threadIdx.x + blockDim.x * threadIdx.y; // must use column major order
int bid = blockIdx.x + gridDim.x * blockDim.y; // can either use column or row major
int offset = (blockDim.x * blockDim.y) * bid; // block id * threads per block
float vx = in_vector[tid + offset]; 
```

如果您的意图确实不是为每个线程读取唯一值，那么您可以节省大量内存带宽*并*使用共享内存实现合并，如下所示：

```
__shared__ float vx[32], vy[32]; 

int tid = threadIdx.x + blockDim.x * threadIdx.y;

if (tid < 32) {
    vx[tid] = in_vector[blockIdx.x * blockDim.x + tid];
    vy[tid] = in_vector[blockIdx.y * blockDim.y + tid];
}
__syncthread(); 
```

并且您将获得一次将唯一值读取到共享内存中的单一扭曲。然后其他线程可以从共享内存中读取值，而无需任何进一步的全局内存访问。`in_vector`请注意，在上面的示例中，我遵循了代码的约定，即使以这种方式阅读两次不一定有那么大的意义。

# c# - 无法将“System.Data.DataColumn”类型的对象转换为“System.IConvertible”类型

> ID：12338472
> 
> 赞同：0
> 
> 时间：2012-09-09T10:55:11.677
> 
> 标签：c#, ado.net

我试图将查询中的记录保存到 中`DataRow`，但没有成功。我可能需要一些帮助。这是我的代码：

```
private DataSet CreateDataSet()
{
    DataSet ds = new DataSet();

    // create Countries table and columns
    DataTable dtApplications = ds.Tables.Add("Applications");
    DataColumn dtApplicationID = dtApplications.Columns.Add("ApplicationID", typeof(int));
    DataColumn dtApplicationName= dtApplications.Columns.Add("ApplicationName", typeof(string));

    DataTable dt = new DataTable();
    SqlConnection con = new SqlConnection(MoahannedConnectionString);
    SqlCommand cmd1 = new SqlCommand("select AppID,AppName from Application", con);
    SqlDataAdapter da = new SqlDataAdapter();
    SqlDataReader sdr = null;
    dt.TableName = "Application";
    con.Open();
    sdr = cmd1.ExecuteReader();
    while (sdr.Read())
    {
       AddDataToTable(dtApplicationID, dtApplicationName, dtApplications, ds);
    }
}

private void AddDataToTable(DataColumn ID, DataColumn Name, DataTable myTable,DataSet ds)
{
    DataRow row;
    row = myTable.NewRow();
    row["ApplicationID"] = ID;
    row["ApplicationName"] = Name;
    myTable.Rows.Add(row);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T10:58:56.793

您可以使用`DataAdapter`直接[加载`DataTable`](http://msdn.microsoft.com/en-us/library/905keexk.aspx)：

```
using(var da = new SqlDataAdapter("select AppID,AppName from Application", con))
{
    da.Fill(dt);
} 
```

在我看来，上面的其余代码是多余的。

旁注：您遇到异常是因为您想将记录的字段传递给 DataRow 的字段。但实际上你正在通过`DataColumn`.

这会起作用，但没有必要：

```
row["ApplicationID"] = sdr.GetInt32(sdr.GetOrdinal("ApplicationID"));
row["ApplicationName"] = sdr.GetString(sdr.GetOrdinal("ApplicationName")); 
```

你`sdr`的`DataReader`.

# c - 在 C 中创建图形的替代方法

> ID：12338473
> 
> 赞同：2
> 
> 时间：2012-09-09T10:55:21.363
> 
> 标签：c, arrays, loops, graph, if-statement

我最近创建了一个程序，它计算通过管道的流量并逐行生成输出的散点图。我对 C 的了解是初级的（从 python 开始），我觉得我可能使代码过于复杂。因此，我问是否有人可以替代以下代码。也欢迎对代码结构等提出批评！

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <string.h>

#define PI 3.1415926

double 
flow_rate(double diameter, double k, double slope){
    double area, w_perimeter, hyd_rad, fr;

    area = (PI*pow(diameter,2.0))/8.0;
    w_perimeter = (PI*diameter)/2.0;
    hyd_rad = area/w_perimeter;

    fr = (1.0/k)*area*pow(hyd_rad,(2.0/3.0))*pow(slope,(1.0/2.0));

return fr;
}

int 
main(int argc, char **argv) {
    double avg_k=0.0312, min_slope=0.0008;
    float s3_diameter; 
    int i=0, num=0, flow_array[6] ,rows, align=29;
    char graph[] = "                             ";
    char graph_temp[]= "                             ";

    printf("\nFlow Rate (x 10^-3) m^3/s\n");

    for (s3_diameter=0.50;s3_diameter>0.24;s3_diameter-=0.05){
        flow_array[i] = (1000*(flow_rate(s3_diameter, avg_k, min_slope))+0.5);
        i += 1;
    }

    for (rows=30;rows>0;rows--){
        strcpy(graph_temp,graph);
        for (num=0;num<6;num++){
            if (rows==flow_array[num] && rows%5==0){
                graph_temp[align] = '*';
                printf("%d%s\n",rows,graph_temp);
                align -= 5;
                break;
            }
            else if (rows==flow_array[num]){
                graph_temp[align] = '*';
                printf("|%s\n",graph_temp);
                align -= 5;
                break;
            }
            else {
                if (rows%5==0 && num==5){
                    printf("%d%s\n",rows,graph_temp);
                } 
                else if (rows%5!=0 && num==5){
                    printf("|%s\n",graph_temp);
                }
            }
        }
    }

    printf("|----2----3----3----4----4----5----\n");
    printf("     5    0    5    0    5    0\n");
    printf("       Diameter (x 10^-2) m\n");

    return 0;
} 
```

输出如下。

```
Flow Rate (x 10^-3) m^3/s
30                             
|                             
|                             
|                             
|                             
25                             
|                             
|                             
|                             *                             
|                             
20                             
|                             
|                             
|                        *    
|                             
15                             
|                             
|                             
|                   *         
|                             
10                             
|              *              
|                             
|                             
|         *                   
5                             
|    *                        
|                             
|                             
|                             
|----2----3----3----4----4----5----
     5    0    5    0    5    0
       Diameter (x 10^-2) m 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T10:35:15.143

GNUPlot 是迄今为止用 C 绘制图形最简单的方法。它可以从简单的绘图绘制到复杂的 3d 图形，甚至提供 ASCII Art 输出（如果确实需要 ASCII 输出）

您可以在此处找到有关如何在 C 程序中使用 GNUPlot 的更多信息：http: [//ndevilla.free.fr/gnuplot/](http://ndevilla.free.fr/gnuplot/)

# c++ - 如何从 `std::istream` 加载 XML 文档？

> ID：12338476
> 
> 赞同：1
> 
> 时间：2012-09-09T10:55:32.290
> 
> 标签：c++, std, tinyxml

我想从中加载 TinyXml 文档`std::istream`，但它不包含这样的方法：

```
/** Load a file using the current document value.
    Returns true if successful. Will delete any existing
    document data before loading.
*/
bool LoadFile( TiXmlEncoding encoding = TIXML_DEFAULT_ENCODING );
/// Save a file using the current document value. Returns true if successful.
bool SaveFile() const;
/// Load a file using the given filename. Returns true if successful.
bool LoadFile( const char * filename, TiXmlEncoding encoding = TIXML_DEFAULT_ENCODING );
/// Save a file using the given filename. Returns true if successful.
bool SaveFile( const char * filename ) const;
/** Load a file using the given FILE*. Returns true if successful. Note that this method
    doesn't stream - the entire object pointed at by the FILE*
    will be interpreted as an XML file. TinyXML doesn't stream in XML from the current
    file location. Streaming may be added in the future.
*/
bool LoadFile( FILE*, TiXmlEncoding encoding = TIXML_DEFAULT_ENCODING ); 
```

我看到它包含使用的功能`FILE`，是否可以转换`std::istream`为`FILE`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:04:13.353

我在[这里](http://www.grinninglizard.com/tinyxmldocs/index.html)找到了明确的解决方案：

> C++ 风格输入：
> 
> *   基于 std::istream
> *   运营商>>
> 
> 从流中读取 XML，使其可用于网络传输。棘手的部分是知道 XML 文档何时完成，因为流中几乎肯定会有其他数据。TinyXML 将在读取根元素后假定 XML 数据是完整的。换句话说，包含多个根元素的结构不良的文档将无法正确读取。另请注意，由于 STL 的实现和 TinyXML 的限制，operator>> 比 Parse 慢一些。

例子：

```
std::istream *in = ResourceManager::getInstance().getResource(resourceName);
if(in) {
   TiXmlDocument doc;
   // load document from resource stream
   *in >> doc;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T11:02:41.490

从 加载整个数据`istream`，然后使用[`TiXmlDocument::Parse`](http://www.grinninglizard.com/tinyxmldocs/classTiXmlDocument.html#17ebabe36926ef398e78dec0d0ad0378).

# php - 安装了 PHP5 GD，Wordpress 图像大小调整仍然无法正常工作

> ID：12338477
> 
> 赞同：5
> 
> 时间：2012-09-09T10:55:54.320
> 
> 标签：php, wordpress, ubuntu, gd

我已经安装了 Ubuntu 10.10，我使用 LAMP 进行了配置，并在上面安装了 WordPress。除了上传时未生成图像缩略图外，几乎所有东西都可以正常工作。起初我追查到它缺少 php-gd 但我已经安装了该模块（通过`apt-get install php5-gd`然后重新启动 Apache）这似乎让 WordPress 认为它​​正在调整大小，因为所有选项不再显示为灰色，而是查看上传目录我可以看到没有生成其他文件。

运行`php -m`将 GD 显示为一个模块，它也显示在 phpinfo() 中。我读过的关于这个特定问题的几乎每一篇文章都说它通过安装 GD 解决了，但在我的情况下并没有奏效。PHP 或 Apache 错误日志中没有任何内容可以让我继续做任何事情，所以我不太确定要做什么。这是一个 VPS，我有完全的 root 访问权限，所以如果你需要我运行任何命令，这不会有问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-01T16:18:56.630

确保您还安装了 php5-imagick，而不仅仅是 GD

# java - 在 XML 中保存数字列表

> ID：12338478
> 
> 赞同：-3
> 
> 时间：2012-09-09T10:56:13.657
> 
> 标签：java, xml, xml-parsing, integer

我正在制作一个从工作室预订设备的程序。我将所有内容都保存到 XML 中（我最终会让它在线同步），并且我可以保存除整数的 ArrayList 之外的所有内容。这些整数是正在使用的设备的唯一 ID。

我的问题是，如何在 XML 中存储和检索它们？我可以保存它们，但是我在阅读它们时遇到了麻烦，这是保存设备的摘录：

```
for(Integer i : b.getEquipment()){ 
                Element equipmentID = doc.createElement("EquipmentID");
                equipmentID.appendChild(doc.createTextNode(i.toString()));
                theEquipment.appendChild(equipmentID);

            } 
```

在 XML 中，这看起来像..（来自 < Equipment >）

```
<Booking>
<Person>1</Person>
<Project>Current</Project>
<Equipment>
    <EquipmentID>2</EquipmentID>
</Equipment>
<DateOut>09/09 11:24:15</DateOut>
</Booking> 
```

我现在的麻烦是如何读取 < EquipmentID > 标签？可能有很多 < EquipmentID > 标签，因为很多设备可能会被预订一空。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:05:20.913

如果`Booking`节点包含`Equipment ID`'s 列表，并且您需要保留这些 ID，而不需要为每个设备 ID 提供其他信息，则将您的设备 ID 列表转换为逗号分隔的字符串。像那样：`<EquipmentIDS>1, 2, 3, 4, 5, 6, 7</EquipmentIDS>`

并在解析时`StringTokenizer`从该字符串中提取每个设备 ID。

# c# - 如何引用 C# 数组中的值

> ID：12338481
> 
> 赞同：3
> 
> 时间：2012-09-09T10:56:32.627
> 
> 标签：c#

我有以下数组：

```
int[] myArray = {21,21,364,658,87}; 
```

以及对第二个元素的引用，如下所示：

```
int rr = myArray[1]; 
```

我想要类似的东西： `rr = 500`

```
Console.writeLine(myArray[1]);// ---> should print 500 ! 
```

我希望你们明白我的想法，我可以像上面的例子一样在 python 中轻松地做到这一点。那么
如何在 C# 中做到这一点

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T11:11:22.787

我的解决方案可能是创建属性`arr[1]`作为其支持属性

就像是：

```
 public int rr
  {
    set{ arr[1] = value;}
    get{ return arr[1];}
  } 
```

而比`rr=500;`将与`arr[1]=500;`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-09T11:07:24.530

你可以使用这样的东西：

```
public static class ArrayExtensions
{
    public static Action<int> CreateSetter(this int[] array, int index)
    {
        return (value) => array[index] = value;
    }
}

[TestFixture]
public class ArrayTest
{
    [Test]
    public void Test()
    {
        int[] myArray = {21,21,364,658,87};
        Action<int> rr = myArray.CreateSetter(1);
        rr(500);
        Assert.AreEqual(500, myArray[1]);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-09T11:47:23.167

当你这样做时：

```
int[] myArray = {21,21,364,658,87};
int rr = myArray[1];
rr = 500; 
```

您只会覆盖 rr 中的值，您无法获取数组内部元素的实际内存地址，从而对其进行更新。

因此，我的回答必须是：

```
myArray[1] = 500; 
```

我试图理解你想要做什么，如果你想将你的更改封装在一个函数中，你可以通过这种方式传递引用，但这完全取决于你想用它做什么：

```
 public void Proc()
    {
        var ints = new [] { 1, 2, 3, 4 };
        FunctionChangingByReference(ref ints[1]);
    }

    public void FunctionChangingByReference(ref int x)
    {
        x = 500;
    } 
```

在 C# 中没有指针，只有引用。

（我有点撒谎，如果你创建一个不安全的上下文，你可以使用指针，但我们不会在 C# 中这样做，你也不应该这样做。当我们编写 C++ 代码时，我们会这样做，但那是 C++，我们在成本，我们使代码更脆弱和容易出错。当我编写 C# 代码时，我尝试在比内存地址改组更高的级别上优化代码。如果你真的需要在那个级别上进行优化，你应该用 C++ 编写代码并将该代码作为 dll 导入，然后您就可以很好地分离关注点，并且不要忘记试驾开发！）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-09T11:13:49.780

简直了`myArray[1] = 500`！如果您特别想要引用数组中的特定整数，则可以使用 Nahum Litvin 建议的属性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-10T12:10:23.873

你想要的是一个基本上指向变量的指针。很难解释“值类型”（如`int`or `struct`）、引用和指针之间的区别。我只能推荐学习C。

这是可行的解决方案，尽管它可能需要对您的代码进行大量更改。

```
//a class that will hold an int inside
public class myIntWrapper
{
    //this is the value wrapper holds
    public int theValue;
    //constructor taking the value
    public myIntWrapper(int argument)
    {
        theValue = argument;
    }

    //operator to convert an int into brand-new myIntWrapper class
    public static implicit operator myIntWrapper(int argument)
    {
        return new myIntWrapper(argument);
    }

    //operator to convert a myIntWrapper class into an int
    public static implicit operator int(myIntWrapper wrapper)
    {
        return wrapper.theValue;
    }
} 
```

现在你可以写：

```
//create an array -
//setting values to every item in array works 
//thanks to operator myIntWrapper(int argument)
myIntWrapper[] myArray = new myIntWrapper[5]{1,2,3,4,5};

//now take a "reference"
myIntWrapper rr = myArray[1];

//change the value
rr.theValue = 500;
//from now on myArray[1].theValue is 500;

//thanks to operator int(myIntWrapper wrapper)
//you can write:
int ss = rr;//it works! 
```

请记住永远不要这样做： `rr = 600;` 因为这实际上会创建全新的 myIntWrapper，它不会在任何地方“连接”。所以请记住：

```
rr.theValue = 500;//this changes the value somewhere
rr = myArray[3];//this changes where rr is "pointing" to 
```

是的，这很复杂，但我怀疑如果没有不安全的代码，它可以做得更简单。我很抱歉没有更多地解释它。我会在评论中回答所有问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-09T11:24:22.797

@des 的回答引起了我的兴趣。所以我尝试了他的解决方案，它按预期工作：

```
int[] numbers = new[] { 1, 2, 3 };
fixed (int* number = &numbers[0])
{
  *number = 10;
}
Console.WriteLine(String.Join(", ", numbers)); // Outputs "10, 2, 3" 
```

您必须使用该`/unsafe`选项编译它。

我希望你看到这可能会带来一些问题。
因此**我不推荐这个解决方案**。

# php - 动态刷新div的问题

> ID：12338484
> 
> 赞同：0
> 
> 时间：2012-09-09T10:56:44.483
> 
> 标签：php, jquery, html, refresh

我让 div 在文件更新时刷新。但它不断刷新（每秒钟淡出和淡出）。
我不是源 test2.php

```
 <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js>
    </script>                          
    <script> 
    $(document).ready(function() {
       $('#loaddiv').load('check.chat.php');
     });

    var auto_refresh = setInterval( function() {
    $.ajax(
        {
        type: 'POST',
        data:"id=100",
        url: "check.chat.php",
        success: function(result) 
        {
            if($("#loaddiv").html() != result)
            {
                $("#loaddiv").fadeOut("fast")
                $("#loaddiv").html(result);
                $("#loaddiv").fadeIn("slow");
           }
        }
    });
    }, 1000);
    </script>

    <div id="loaddiv"></div> 
```

并现场归档：***** ***

谁知道是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T10:59:31.260

这部分：

```
$("#loaddiv").fadeOut("fast")
$("#loaddiv").html(result);
$("#loaddiv").fadeIn("slow"); 
```

应该：

```
$("#loaddiv").fadeOut("fast", function(){
        $("#loaddiv").html(result);
        $("#loaddiv").fadeIn("slow");
}); 
```

在您的情况下，两个淡入淡出同时被调用，形成一个动画队列，导致它在间隔再次触发的大约同一时间从一个阶段进入另一个阶段。

* * *

更新

要查看日志，请执行以下操作：`console.log("html: ", $("#loaddiv").html(), "result: ", result);`

# delphi - TComboBox 使用 csOwnerDrawFixed 或 csOwnerDrawVariable 时如何模拟 Windows Theme 行为？

> ID：12338486
> 
> 赞同：3
> 
> 时间：2012-09-09T10:57:10.257
> 
> 标签：delphi, winapi

[显示与Items](http://docwiki.embarcadero.com/Libraries/en/Vcl.StdCtrls.TCustomCombo.Items)不同的字符串值的一种非常简单的方法是将[Style](http://docwiki.embarcadero.com/Libraries/en/Vcl.StdCtrls.TCustomComboBox.Style)属性[`csDropDown`设置`csOwnerDrawFixed`](http://docwiki.embarcadero.com/Libraries/en/Vcl.StdCtrls.TComboBoxStyle)为[Andreas Rejbrand](https://stackoverflow.com/users/282848/andreas-rejbrand)几年[前回答的](https://stackoverflow.com/a/3022956/29290)那样。

问题是：一旦你这样做，你就会失去对 Windows 主题的支持。
同样的限制适用于使用`csOwnerDrawVariable`

这两个`Style`值被转换为添加`CBS_OWNERDRAWFIXED`或`CBS_OWNERDRAWVARIABLE`（除了`CBS_DROPDOWNLIST`）Windows [COMBOBOX 控件的](http://msdn.microsoft.com/en-us/library/windows/desktop/aa380889)[样式](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775796)。

反过来，`CBS_OWNERDRAWFIXED`或者`CBS_OWNERDRAWVARIABLE`导致您[立即失去对 Windows 主题的支持](https://stackoverflow.com/questions/10031621/cbs-dropdownlist-combo-fails-to-respond-to-wm-ctlcolor-under-windows-ux-themi)。

当您[像颜色选择器一样](http://www.codeforge.cn/read/9851/XColorPickerXP.cpp__html)进行完全自定义绘画时，一切都很好。但是当你只想替换绘制的文本时，它不是。

[Windows COMBOBOX 控件似乎没有办法解决这个问题](https://stackoverflow.com/questions/2125090/ownerdraw-combobox-is-not-styled-anymore)，所以我想知道：如何从 Delphi 模拟 Windows 主题？

我认为它与[DrawThemedBackground](http://msdn.microsoft.com/en-us/library/windows/desktop/bb773289)有关，但是自从我完成了认真的 Delphi Control 工作以来已经有一段时间了，所以任何关于如何开始的指示也很好（即使它们使我的假设无效）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T22:16:13.533

如果人们真的想尝试这个，一些链接（你可能不应该因为它太多的工作）。

*   [绘制自定义 Windows 控件的问题](https://stackoverflow.com/questions/5275619/problem-with-drawing-custom-windows-controls)
*   [绘制一个主题组合框](http://www.tech-archive.net/Archive/VC/microsoft.public.vc.mfc/2006-09/msg00851.html)
*   [标准控件和窗口的部件和状态](http://msdn.microsoft.com/en-us/library/windows/desktop/bb773210)
*   [Vista UI 最大的变化：下拉列表现在看起来像按钮](http://social.msdn.microsoft.com/Forums/hr/windowsuidevelopment/thread/ce35e3d4-cd23-41f5-9204-bbfd279651e9)
*   [如何最好地在右上角创建一个带有关闭“十字”按钮的 TPanel？](https://stackoverflow.com/questions/6550249/how-best-to-create-a-tpanel-with-a-close-cross-button-in-the-top-right)
*   [我如何在 Delphi 的 ComboBox 中使用不同的项目文本文本](https://stackoverflow.com/questions/11247745/how-i-can-use-different-text-of-item-text-in-combobox-in-delphi)
*   [TComboBox TOwnerDrawState OnDrawItem odComboBoxEdit](https://www.google.com/search?q=TComboBox%20TOwnerDrawState%20OnDrawItem%20odComboBoxEdit)
*   [具有 csOwnerDrawFixed 样式的 Combobox 如何表现得像 csDropDown 样式？](https://stackoverflow.com/questions/9797961/how-a-combobox-with-the-csownerdrawfixed-style-can-behave-like-the-csdropdown-st)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T20:45:16.220

几年前，我为[TurboPower Orpheus ComboBox](https://sourceforge.net/p/tporpheus/code/HEAD/tree/trunk/source/ovccmbx.pas)添加了主题支持。查看 {$IFDEF VERSION2010}...{$ENDIF} 部分中的代码。这应该让您对需要什么有一个很好的了解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-09T09:20:45.760

我在drawitem中修复了它

```
procedure Tfrmxxx.cbTypeDrawItem(Control: TWinControl; Index: Integer;
  Rect: TRect; State: TOwnerDrawState);
begin
    with (Control as TCombobox).Canvas do
    begin
    if odSelected in State then
      Brush.Color := StyleServices.GetSystemColor(clHighlight);// $00FFD2A6;

    FillRect(Rect);
    TextOut(Rect.Left, Rect.Top, (Control as TCombobox).Items[Index]);
    if odFocused In State then
    begin
      Brush.Color := (Control as TCombobox).Color;
      DrawFocusRect(Rect);
    end;
  end;
end; 
```

# ruby-on-rails - button_to 提交带有参数的帖子以创建记录

> ID：12338489
> 
> 赞同：0
> 
> 时间：2012-09-09T10:57:23.160
> 
> 标签：ruby-on-rails

我正在尝试使用一个按钮或链接来创建投票，我认为我必须使用一个帖子，所以我使用的是 button_to，我当前的代码只是将 :song 和 :user_id 添加到按钮元素本身，因此没有工作，我做错了什么？

```
<% @songs.each do |song| %>
  <tr>
    <td class="plusvote"><%= button_to '+', {:controller => "votes", :action => "create"}, :song => song.id, :user=> session[:user_id] , :method=>:post  %></td>
    <td><%= song.votes.count %></td>
    <td><%= song.name %></td>
    <td><%= song.code %></td>
    <td><%= song.album %></td>
<% end %> 
```

没有错误，按下/提交时的按钮/表单将无法正确发布，因为生成的 html 是：

```
<form action="/votes" class="button_to" method="post">
    <div>
        <input song="5" type="submit" user="1" value="+" />
        <input name="authenticity_token" type="hidden" value="tucB4fQ4XbrnzF3lFcQnMq/1rSaPrcsc/tFJ1SQttns=" />
    </div>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:55:22.380

在我看来，您只是将 :song 和 :user_id 值放在了 url 哈希之外。尝试用这个替换你的按钮：

```
<%= button_to '+', {:controller => "votes", :action => "create", :song => song.id, :user=> session[:user_id]}, :method=>:post  %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T11:08:20.340

最简单的方法是使用 rails 经典助手，但为每个属性`form_for`设置输入类型。`hidden`此外，您还需要为每个输入设置默认值（据我所知，只有一个 – `:song`）。然后将 button_to 更改为通常的提交按钮。

# android - Android - 在背景图像上定位元素

> ID：12338493
> 
> 赞同：0
> 
> 时间：2012-09-09T10:58:10.167
> 
> 标签：android, background, android-linearlayout

我有一个带有背景图像的线性布局。我如何在它上面设置任何元素（按钮，..）的位置？

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:02:01.547

使用 `android:gravity=""

参数并设置为**顶部**，**底部**等'

# php - time_since 函数显示 -1 年

> ID：12338495
> 
> 赞同：2
> 
> 时间：2012-09-09T10:58:19.023
> 
> 标签：php

我有以下时间戳`1347216222`，它是当天的，并且正在使用它与一个`time_since`函数来检查它在几小时之前是多久......分钟等。

```
<?php

/* Works out the time since the entry post, takes a an argument in unix time (seconds) */
function time_since($original) {
    // array of time period chunks
    $chunks = array(
        array(60 * 60 * 24 * 365 , 'year'),
        array(60 * 60 * 24 * 30 , 'month'),
        array(60 * 60 * 24 * 7, 'week'),
        array(60 * 60 * 24 , 'day'),
        array(60 * 60 , 'hour'),
        array(60 , 'minute'),
    );

    $today = time(); /* Current unix time  */
    $since = $today - $original;

    // $j saves performing the count function each time around the loop
    for ($i = 0, $j = count($chunks); $i < $j; $i++) {

        $seconds = $chunks[$i][0];
        $name = $chunks[$i][1];

        // finding the biggest chunk (if the chunk fits, break)
        if (($count = floor($since / $seconds)) != 0) {
            // DEBUG print "<!-- It's $name -->\n";
            break;
        }
    }

    $print = ($count == 1) ? '1 '.$name : "$count {$name}s";

    if ($i + 1 < $j) {
        // now getting the second item
        $seconds2 = $chunks[$i + 1][0];
        $name2 = $chunks[$i + 1][1];

        // add second item if it's greater than 0
        if (($count2 = floor(($since - ($seconds * $count)) / $seconds2)) != 0) {
            $print .= ($count2 == 1) ? ', 1 '.$name2 : ", $count2 {$name2}s";
        }
    }
    return $print;
}

echo time_since(1347216222);

?> 
```

输出是`-1 years, 12 months`。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-10T13:15:00.693

我定制了要使用的函数`DateTime`and `DateInterval`，这使它更具可读性。

它与您发布的关于如何处理时差的功能不同。在您的情况下，您测试了两次值（每个“单位”一次）。这需要您进行复杂的计算。

另一方面，下面的函数利用了这样一个事实，即为`DateInterval`您提供年、月、日、小时、分钟和秒的即用型差异（例如，2015 年和 2014 年之间的差异是 1 年和**0 秒**，而不是 UNIX 时间戳）。此外，使用`DateTime`允许您优雅地处理时区。

话虽如此，您只需要关心如何打印差异，这正是`for`循环的用途 - 我们提取两个值并使用额外的项目（我们称此类项目监护人），以便在我们保存额外的条件时想提取第二项。

这是功能：

```
<?php
function pluralize($number, $unit) {
    return $number . ' ' . $unit . ($number !== 1 ? 's' : '');
}

function time_since(DateTime $original) {
    $now = new DateTime('now');
    $diff = $now->diff($original);

    //is from the past?
    if ($diff->invert) {
        $chunks = [
            [$diff->y, 'year'],
            [$diff->m, 'month'],
            [$diff->d, 'day'],
            [$diff->h, 'hour'],
            [$diff->i, 'minute'],
            [$diff->s, 'second'],
            [0, 'guardian'],
        ];

        for ($i = 0; $i < count($chunks) - 1; $i ++) {
            list ($value, $unit) = $chunks[$i];
            if ($value !== 0) {
                $text = pluralize($value, $unit);

                //append next unit as well, if it's available and nonzero
                list ($nextValue, $nextUnit) = $chunks[$i + 1];
                if ($nextValue !== 0) {
                    $text .= ' ' . pluralize($nextValue, $nextUnit);
                }

                return $text;
            }
        }
    }

    return 'just now';
} 
```

和测试：

```
echo time_since(new DateTime('2014-01-01')) . PHP_EOL;
echo time_since(new DateTime('2014-10-09')) . PHP_EOL;
echo time_since(new DateTime('2014-11-09')) . PHP_EOL;
echo time_since(new DateTime('2014-11-10')) . PHP_EOL;
echo time_since(new DateTime('2014-11-10 13:05')) . PHP_EOL;
echo time_since(new DateTime('2114-11-10 13:05')) . PHP_EOL; //future 
```

结果：

```
rr-@work:~$ php test.php
10 months 9 days
1 month 1 day
1 day 13 hours
13 hours 5 minutes
38 seconds
just now 
```

# c# - 调用“运行”命令

> ID：12338502
> 
> 赞同：1
> 
> 时间：2012-09-09T10:59:09.787
> 
> 标签：c#, .net, windows

我正在尝试调用“开始”菜单上经常出现的“运行”对话框——我做了一些研究，只找到了一种访问它的方法（使用“Windows 键”+ R）。

所以我假设模拟击键，例如：

```
SendKeys.Send("{TEST}") 
```

会做这项工作吗？虽然你怎么能模拟键盘上的“Windows”键呢？

我确信有一种更简单的方法可以做到这一点 - 不使用 sendkeys - 任何人有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:08:29.760

您可以使用 PInvoke 来调用运行对话框。

```
[Flags()]
public enum RunFileDialogFlags : uint
{

    /// <summary>
    /// Don't use any of the flags (only works alone)
    /// </summary>
    None = 0x0000,    

    /// <summary>
    /// Removes the browse button
    /// </summary>
    NoBrowse = 0x0001,

    /// <summary>
    /// No default item selected
    /// </summary>
    NoDefault = 0x0002,

    /// <summary>
    /// Calculates the working directory from the file name
    /// </summary>
    CalcDirectory = 0x0004,

    /// <summary>
    /// Removes the edit box label
    /// </summary>
    NoLabel = 0x0008,

    /// <summary>
    /// Removes the separate memory space checkbox (Windows NT only)
    /// </summary>
    NoSeperateMemory = 0x0020
} 
```

我们需要使用 DllImport 属性导入 DLL。

```
[DllImport("shell32.dll", CharSet = CharSet.Auto, EntryPoint = "#61", SetLastError = true)]

static extern bool SHRunFileDialog(IntPtr hwndOwner, 
                                   IntPtr hIcon, 
                                   string lpszPath,
                                   string lpszDialogTitle, 
                                   string lpszDialogTextBody, 
                                   RunFileDialogFlags uflags); 
```

**执行：**

```
private void ShowRunDialog(object sender, RoutedEventArgs e)
{
    SHRunFileDialog(IntPtr.Zero, 
                    IntPtr.Zero, 
                    "c:\\",
                    "Run Dialog using PInvoke",
                    "Type the name of a program, folder or internet address 
            and Windows will open that for you.",
                    RunFileDialogFlags.CalcDirectory); 
```

}

# spring - 即使使用 OpenSessionInViewFilter 也会出现另一个 LazyInitializationException

> ID：12338512
> 
> 赞同：1
> 
> 时间：2012-09-09T11:01:09.990
> 
> 标签：spring, hibernate

我在使用 Spring 3/Hibernate 3.6 和 jsp 的 Web 应用程序中遇到了可怕的 LazyInitializationException。我的 web.xml 中有 OpenSessionInViewFilter，但我的 HSession 似乎仍然以某种方式关闭或失效。我还检查了我的应用程序没有引起异常。

这是我的 web.xml

```
 <filter>
        <filter-name>hibernateFilter</filter-name>
        <filter-class>org.springframework.orm.hibernate3.support.OpenSessionInViewFilter</filter-class>
        <init-param>
            <param-name>sessionFactoryBeanName</param-name>
            <param-value>sessionFactory</param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>hibernateFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>hibernateFilter</filter-name>
        <servlet-name>hedgebenefits</servlet-name>
    </filter-mapping> 
```

Context.xml 是：

```
<mvc:annotation-driven/>
<tx:annotation-driven/>
<context:component-scan base-package="com.hedgebenefits.*"/>
<bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/jsp/"/>
    <property name="suffix" value=".jsp"/>
</bean>
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
    <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
    <property name="url" value="jdbc:mysql://localhost:3306/managerie"/>
    <property name="username" value="root"/>
    <property name="password" value=""/>
</bean>

<bean id="transactionManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory"/>
</bean>
<bean id="namingStrategy" class="org.hibernate.cfg.ImprovedNamingStrategy"/>

    <bean id="validator" class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"/>

<bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <property name="packagesToScan" value="com.hedgebenefits.domain"/>
    <property name="dataSource" ref="dataSource"/>
    <property name="namingStrategy" ref="namingStrategy"/>
    <property name="hibernateProperties">
        <value>
            hibernate.dialect=org.hibernate.dialect.MySQLDialect
            hibernate.show_sql=true
        </value>
    </property>
</bean> 
```

jsp是：

```
<tr>
    The list is :
    <td>
    <c:forEach var="admin" items="${admins}">
        Admin is ${admin.username},
        <c:forEach var="sector" items="${admin.sectors}">
            sector is ${sector.name}
        </c:forEach>
    </c:forEach>
    </td>
</tr> 
```

服务使用@Transactional 注释：

```
@Service
@Transactional
public class AdminServiceImpl implements AdminService {

    private AdminDao adminDao;

    @Autowired
    public AdminServiceImpl(AdminDao adminDao) {
        this.adminDao = adminDao;
    }
    ...

    @Override
    public List<Admin> listAllAdmins() {
        return adminDao.listAllAdmins();
    }
} 
```

道是：

```
@Repository
public class AdminDaoImpl implements AdminDao{

    private SessionFactory sessionFactory;

    @Autowired
    public AdminDaoImpl(SessionFactory sessionFactory) {
        this.sessionFactory = sessionFactory;
    }

    ....

    @Override
    public List<Admin> listAllAdmins() {
        List<Admin> adminList = sessionFactory.getCurrentSession().createCriteria(Admin.class)
                .setMaxResults(5)
                .list();
        return adminList;
    }
} 
```

编辑：添加了控制器和堆栈跟踪

控制器是：

```
 @Controller
@RequestMapping(value = "/admin")
@SessionAttributes(value = "admin")
public class AdminRegistrationController {

    ...    
    @Autowired
    private AdminService adminService;

    @RequestMapping(value = "/list")
    public ModelAndView listRegisteredAdmins() {
        List<Admin> admins = adminService.listAllAdmins();
        return new ModelAndView(LIST_ADMINS.getViewName()).addObject("admins", admins);  
    } 
```

堆栈跟踪是：

```
 org.apache.jasper.JasperException: An exception occurred processing JSP page /WEB-INF/jsp/list.jsp at line 15

12:         <td>
13:         <c:forEach var="admin" items="${admins}">
14:             Admin is ${admin.username},
15:             <c:forEach var="sector" items="${admin.sectors}">
16:                 sector is ${sector.name}
17:             </c:forEach>
18:         </c:forEach>

    Stacktrace:
        org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:521)
        org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:430)
        org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
        org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
        org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)
        org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1157)
        org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:927)
        org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:827)
        org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
        org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:70)
        org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:198)
        org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    root cause

    org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.hedgebenefits.domain.Admin.sectors, no session or session was closed
        org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:383)
        org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationExceptionIfNotConnected(AbstractPersistentCollection.java:375)
        org.hibernate.collection.AbstractPersistentCollection.initialize(AbstractPersistentCollection.java:368)
        org.hibernate.collection.AbstractPersistentCollection.read(AbstractPersistentCollection.java:111)
        org.hibernate.collection.PersistentBag.iterator(PersistentBag.java:272)
        org.apache.taglibs.standard.tag.common.core.ForEachSupport.toForEachIterator(ForEachSupport.java:348)
        org.apache.taglibs.standard.tag.common.core.ForEachSupport.supportedTypeForEachIterator(ForEachSupport.java:224)
        org.apache.taglibs.standard.tag.common.core.ForEachSupport.prepare(ForEachSupport.java:155)
        javax.servlet.jsp.jstl.core.LoopTagSupport.doStartTag(LoopTagSupport.java:256)
        org.apache.jsp.WEB_002dINF.jsp.list_jsp._jspx_meth_c_005fforEach_005f1(list_jsp.java:149)
        org.apache.jsp.WEB_002dINF.jsp.list_jsp._jspx_meth_c_005fforEach_005f0(list_jsp.java:112)
        org.apache.jsp.WEB_002dINF.jsp.list_jsp._jspService(list_jsp.java:70)
        org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:388)
        org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
        org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
        org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)
        org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1157)
        org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:927)
        org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:827)
        org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
        org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:70)
        org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:198)
        org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76) 
```

似乎我在这里遗漏了一些明显的东西，但不知道是什么？

# c# - 字符串加密/解密密码 c# Metro Style

> ID：12338514
> 
> 赞同：3
> 
> 时间：2012-09-09T11:01:14.770
> 
> 标签：c#, windows-8, microsoft-metro, encryption

我想用密码加密和解密字符串。我使用 C# 和 WinRT (MetroStyle)。有人上加密/解密课程吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-09T11:08:28.527

Metro 中不存在正常的 .Net System.Security.Cryptography 命名空间。您可以改用 [Windows.Security.Cryptography.Core命名空间中的](http://msdn.microsoft.com/en-us/library/windows/apps/br241547.aspx)[CryptographicEngine](http://msdn.microsoft.com/en-us/library/windows/apps/windows.security.cryptography.core.cryptographicengine%28v=win.10%29.aspx)类。

如果密码只是被验证/认证，不要加密它。相反，请使用以下内容：

```
using Windows.Security.Cryptography.Core;
using Windows.Security.Cryptography;
using Windows.Storage.Streams;

...
// Use Password Based Key Derivation Function 2 (PBKDF2 or RFC2898)
KeyDerivationAlgorithmProvider pbkdf2 = 
    KeyDerivationAlgorithmProvider.OpenAlgorithm(
        KeyDerivationAlgorithmNames.Pbkdf2Sha256);

// Do not store passwords in strings if you can avoid them. The
// password may be retained in memory until it is garbage collected.
// Crashing the application and looking at the memory dump may 
// reveal it.
IBuffer passwordBuffer = 
     CryptographicBuffer.ConvertStringToBinary("password", 
         BinaryStringEncoding.Utf8);
CryptographicKey key = pbkdf2.CreateKey(passwordBuffer);

// Use random salt and 10,000 iterations. Store the salt along with 
// the derviedBytes (see below).
IBuffer salt = CryptographicBuffer.GenerateRandom(32);
KeyDerivationParameters parameters = 
    KeyDerivationParameters.BuildForPbkdf2(salt, 10000);

// Store the returned 32 bytes along with the salt for later verification
byte[] derviedBytes = 
    CryptographicEngine.DeriveKeyMaterial(key, parameters, 32).ToArray(); 
```

当提供密码时，使用相同的盐运行相同的过程并比较派生字节。像存储加密密钥一样存储秘密。

如果将使用密码，例如连接到另一个服务：

```
// Use AES, CBC mode with PKCS#7 padding (good default choice)
SymmetricKeyAlgorithmProvider aesCbcPkcs7 = 
    SymmetricKeyAlgorithmProvider.OpenAlgorithm(SymmetricAlgorithmNames.AesCbcPkcs7);

// Create an AES 128-bit (16 byte) key
CryptographicKey key = 
    aesCbcPkcs7.CreateSymmetricKey(CryptographicBuffer.GenerateRandom(16));

// Creata a 16 byte initialization vector
IBuffer iv = CryptographicBuffer.GenerateRandom(aesCbcPkcs7.BlockLength);

// Encrypt the data
byte[] plainText = Encoding.UTF8.GetBytes("Hello, world!"); // Data to encrypt
byte[] cipherText = CryptographicEngine.Encrypt(
    key, plainText.AsBuffer(), iv).ToArray();

// Decrypt the data
string newPlainText = new string(
    Encoding.UTF8.GetChars(CryptographicEngine.Decrypt(
        key, cipherText.AsBuffer(), iv).ToArray()));

// newPlainText contains "Hello, world!" 
```

与任何密码学一样，请确保适当保护您的密钥并遵循最佳实践。链接的文档还提供了示例。

# javascript - 弯角 IE 7,8 问题

> ID：12338522
> 
> 赞同：0
> 
> 时间：2012-09-09T11:02:28.480
> 
> 标签：javascript, html, css

我试图将边框半径设置为 td 元素，但它不适用于 IE7 和 IE8 我尝试了所有可能的解决方案，但它仍然无法正常工作这是我的 css 类：

```
padding: 5 5 5 5;
background-color: gray;
-webkit-border-radius: 5px;
-moz-border-radius: 5px;
border-radius: 5px;
-moz-box-shadow: 0 0 5px 5px #888;
-webkit-box-shadow: 0 0 5px 5px#888;
box-shadow: 0 0 5px 5px #888;
zoom: 1;
filter: alpha(opacity=70);
opacity: 0.7; 
behavior: url(../Bin/PIE.htc); 
```

我尝试使用 PIE.js，但它也无法正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:04:41.813

IE7 和 IE8 不支持 CSS3 圆角。如果您想效仿这一点，您将需要查看其他 IE 特定的解决方案。

[如何在 ie 8 和 < 中创建圆角](http://cookbooks.adobe.com/post_Cross_Browser_CSS3_Rounded_Corners-16638.html)是使用 .htc 控件用于 IE 的一种方法。

我需要补充一点，我所发现的任何问题的解决方案都不是 100%，它们都有缺点，并且永远无法拥有 CSS3 提供的全部功能。

# javascript - 是什么导致了 512 字节的限制 - openkeyval 或其他

> ID：12338527
> 
> 赞同：1
> 
> 时间：2012-09-09T11:03:05.890
> 
> 标签：javascript, jquery, post

嘿！

我在[http://openkeyval.org](http://openkeyval.org)找到了用于存储来自任何 webapps 的简单键值的一流服务。从文档来看，它似乎允许 64kBytes 的数据，从我看到的情况来看，它只能存储 512 个字节。

请参阅下面的示例（按加载以从我的密钥加载数据，并保存以存储回密钥）

[http://jsfiddle.net/larsi/h8Mbg/](http://jsfiddle.net/larsi/h8Mbg/)

任何想法可能导致限制？

问候拉斯·埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:09:23.700

问题是你正在做`GET`请求而不是`POST`发送你必须使用的大部分数据`POST`。这段代码在我的 Chrome 上工作，但它可能只是 Chrome 的实现，所以其他浏览器不能支持这样的数据传输`GET`

**更新**

关于您的问题有一个问题，这里是 openkeyval 的 github 上现有问题的链接：
[https ://github.com/shinyplasticbag/openkeyval/issues/14](https://github.com/shinyplasticbag/openkeyval/issues/14)

# scheme - 方案报价流程

> ID：12338529
> 
> 赞同：1
> 
> 时间：2012-09-09T11:03:35.437
> 
> 标签：scheme, echo, quote

练习题：

> 传递给过程的参数不必总是相同的类型。定义一个过程 echo，它接受任何类型的值并返回该值。

我目前做了：

```
(define echo
  (lambda (x)
     (quote x))) 
```

但问题是，如果我输入数字或值，程序不会打印 x。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T13:56:11.960

您被要求实现[身份功能](http://en.wikipedia.org/wiki/Identity_function)。如果您的解释器提供它，则该`echo`过程可以作为别名实现：

```
(define echo identity) 
```

或者作为`values`Racket 的别名：

```
(define echo values) 
```

如果没有，从头开始实现非常简单`echo`：只需返回作为参数传递的内容，无需使用`quote`：

```
(define (echo x) x) 
```

或明确使用 a `lambda`：

```
(define echo (lambda (x) x)) 
```

上述所有过程都将接受任何类型的值并返回该值，例如：

```
(echo "hello")
> "hello"
(echo 42)
> 42
(echo (quote x))
> 'x 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T12:07:59.720

(quote x) 阻止对符号 x 求值，因此返回的值不是 x 的值，而是符号本身。

身份函数接受一个参数并返回它：

```
(lambda (x) x) 
```

应用时：

```
((lambda (x) x) 4)
;=> 4

((lambda (x) (quote x)) 4)
;=> x 
```

# c++ - AStyle 嵌套类格式

> ID：12338531
> 
> 赞同：4
> 
> 时间：2012-09-09T11:04:14.260
> 
> 标签：c++, vim, formatting, astyle

我的项目中有以下代码：

```
class RangeConverter {
private:
    struct Converter {
                    double MinimumInput;
                    double MaximumInput;

                    double MinimumOutput;
                    double MaximumOutput;

                    template <typename RangeType>
                    RangeType Convert ( RangeType invalue ) const {
                        double v = static_cast<double> ( invalue );
                        if ( v < MinimumInput ) {
                            v = MinimumInput;
                        } else if ( v > MaximumInput ) {
                            v = MaximumInput;
                        }
                        double interpolationfactor = ( v - MinimumInput ) / ( MaximumInput - MinimumInput );
                        return static_cast<RangeType> ( ( interpolationfactor * ( MaximumOutput - MinimumOutput ) ) + MinimumOutput );
                    }
                };
..... 
```

使用 AStyle 格式化该代码后，我得到以下信息：

```
class RangeConverter {
private:
    struct Converter {
        ngeConverter {
        private:
            struct Converter {
                double MinimumInput;
                double MaximumInput;

                double MinimumOutput;
                double MaximumOutput;

                template <typename RangeType>
                RangeType Convert ( RangeType invalue ) const {
                    double v = static_cast<double> ( invalue );
                    if ( v < MinimumInput ) {
                        v = MinimumInput;
                    } else if ( v > MaximumInput ) {
                        v = MaximumInput;
                    }
                    double interpolationfactor = ( v - MinimumInput ) / ( MaximumInput - MinimumInput );
                    return static_cast<RangeType> ( ( interpolationfactor * ( MaximumOutput - MinimumOutput ) ) + MinimumOutput );
                }
            };
..... 
```

astyle 命令：

```
astyle
    \   --style=java
    \   --indent=force-tab=2
    \   --indent-classes
    \   --indent-switches
    \   --indent-labels
    \   --indent-preprocessor
    \   --indent-col1-comments
    \   --pad-oper
    \   --pad-paren
    \   --delete-empty-lines
    \   --add-brackets
    \   --align-pointer=type
    \   --align-reference=type 
```

这是风格的错误，还是我忘记了任何选择？如果它是一个错误，你会建议用 VIM 格式化 C++ 代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T07:01:31.990

当然，这是一个错误。如今，AStyle 并没有得到很好的支持。有很多 bug 一直存在，从未得到解决。你不应该期望在最近的将来情况会有所改善。我强烈建议切换到[Uncrustify](https://github.com/bengardner/uncrustify)。当然，它也有一些问题，但它们并没有那么讨厌，也不会像 AStyle 那样破坏你的代码。它有数百个配置选项 - 比 AStyle 灵活得多 - 所以请耐心等待，您将不得不花费相当多的时间来调整它以适应您的口味和惯例。

完成后，如果您想将它与 Vim 正确集成，您可以在这里添加可以添加到您的代码`.vimrc`：

```
" Restore cursor position, window position, and last search after running a
" command.
function! Preserve(command)
  " Save the last search.
  let search = @/

  " Save the current cursor position.
  let cursor_position = getpos('.')

  " Save the current window position.
  normal! H
  let window_position = getpos('.')
  call setpos('.', cursor_position)

  " Execute the command.
  execute a:command

  " Restore the last search.
  let @/ = search

  " Restore the previous window position.
  call setpos('.', window_position)
  normal! zt

  " Restore the previous cursor position.
  call setpos('.', cursor_position)
endfunction

" Specify path to your Uncrustify configuration file.
let g:uncrustify_cfg_file_path =
    \ shellescape(fnamemodify('~/.uncrustify.cfg', ':p'))

" Don't forget to add Uncrustify executable to $PATH (on Unix) or 
" %PATH% (on Windows) for this command to work.
function! Uncrustify(language)
  call Preserve(':silent %!uncrustify'
      \ . ' -q '
      \ . ' -l ' . a:language
      \ . ' -c ' . g:uncrustify_cfg_file_path)
endfunction 
```

现在，您可以将此函数 ( `Uncrustify`) 映射到键组合，也可以使用我使用的方便技巧。创建一个文件`~/.vim/after/ftplugin/cpp.vim`，您可以在其中覆盖任何 Vim 设置，特别是针对 C++ 的设置，并在其中添加以下行：

```
autocmd BufWritePre <buffer> :call Uncrustify('cpp') 
```

这基本上添加了一个预保存挂钩。现在，当您使用 C++ 代码保存文件时，Uncrustify 将使用您之前提供的配置文件自动对其进行格式化。

**注意**：这里介绍的所有内容都经过我的充分测试和每天使用。

# asp.net - 生成一个非英语字母数组，并在 C# 或 VB.net 中为每个字母添加不同的值

> ID：12338532
> 
> 赞同：0
> 
> 时间：2012-09-09T11:04:15.067
> 
> 标签：asp.net, vb.net

如何生成一个字母表（strAbc）并向每个字母（strAbc）添加不同的值（strAbcVal），其中一些字母有两个字符，如（DŽ，NJ，LJ），而不是总和字符串sName你能帮我吗？

```
dim sName as string ="LJILJANA"

dim strAbc as string ="A,B,C,D,Đ,DŽ,E,F,G,H,I,J,K,L,LJ,M,N,NJ,O,P,R,S,Š,T,U,V,Z,Ž"

dim strAbcVal as string="11,2,7,14,5,9,7,15,9,10,16,12,9,3,5,4,12,11,22,70,61,22,50,14,1,2,7,15,19,40" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T14:55:44.637

现在这只是一个猜测，因为我不确定您的目标是什么，但您是否考虑过使用`Dictionary`对象？

A`Dictionary`就像现实世界中的字典一样工作。您拥有唯一的键，并且对于每个这样的键，您都有相应的值。在您的情况下，字母（或字母组合）将是键，数字是实际值。

（当然，由于 ut 似乎是一对一的关系，所以这些数字也可以用作键。）

请详细说明你的目标。

# java - Java 中 ClassFileTransformer 的使用

> ID：12338533
> 
> 赞同：1
> 
> 时间：2012-09-09T11:04:19.027
> 
> 标签：java, profiling

java.lang.instrument.ClassFileTransformer 实时的目的是什么。这仅在分析期间使用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T11:22:18.320

在[javadoc API](http://docs.oracle.com/javase/6/docs/api/java/lang/instrument/ClassFileTransformer.html)中说：

> 代理提供此接口的实现以转换类文件。转换发生在 JVM 定义类之前。请注意，术语类文件按照 Java 虚拟机规范的类文件格式一章中的定义使用，表示类文件格式中的字节序列，无论它们是否驻留在文件中。

并且可以在[http://docs.oracle.com/javase/specs/jvms/se5.0/html/Overview.doc.html#32310找到类文件规范](http://docs.oracle.com/javase/specs/jvms/se5.0/html/Overview.doc.html#32310)

通常，您不需要`java.lang.instrument.*`打包。

# sql - 复杂条件的 INNER JOIN 显着增加了执行时间

> ID：12338534
> 
> 赞同：1
> 
> 时间：2012-09-09T11:04:20.697
> 
> 标签：sql, sql-server, performance, inner-join

我有 2 个表，其中有几个相同的字段需要在 JOIN 条件下链接。例如，在每个表中都有字段：P1、P2。我想编写以下连接查询：

```
SELECT ... FROM Table1
   INNER JOIN
   Table2
      ON    Table1.P1 = Table2.P1
         OR Table1.P2 = Table2.P2
         OR Table1.P1 = Table2.P2
         OR Table1.P2 = Table2.P1 
```

在我有巨大表的情况下，这个请求执行了很多时间。

我试图测试仅具有一个条件的查询请求多长时间。首先，我以这种方式修改了表格，所有来自 P2 和 P1 的数据都作为新行复制到了 Table1 和 Table2 中。所以我的查询很简单：

```
SELECT ... FROM Table1 INNER JOIN Table2 ON Table1.P = Table2.P 
```

结果更令人惊讶：执行时间从数小时（第一种情况）减少到 2-3 秒！

为什么如此不同？这是否意味着复杂的条件总是会降低性能？我该如何改善这个问题？可能是 P1,P2 索引会有所帮助吗？我想保留第一个数据库模式，而不是移动到一个字段 P。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T23:51:06.160

查询不同的原因是优化器使用了连接策略。基本上有四种方法可以连接两个表：

1.  “哈希连接”：在其中一个表上创建一个哈希表，用于查找第二个表中的值。
2.  “Merge join”：按 key 对两个表进行排序，然后按顺序读取 join 的结果。
3.  “索引查找”：使用索引在一个表中查找值。
4.  “嵌套循环”：将每个表中的每个值与另一个表中的所有值进行比较。

（而且还有一些变化，例如使用索引而不是表、使用分区以及处理多个处理器。）不幸的是，在 SQL Server Management Studio 中，(3) 和 (4) 都显示为嵌套循环连接。如果仔细观察，可以从节点中的参数中看出区别。

无论如何，您的原始连接是前三个连接之一——而且速度很快。这些连接基本上只能用于“等连接”。也就是说，当连接两个表的条​​件包括相等运算符时。

当您从单个相等切换到“in”或一组“or”条件时，连接条件已从等连接变为非等连接。我的观察是，在这种情况下，SQL Server 在优化方面做得很糟糕（而且，公平地说，我认为其他数据库也做同样的事情）。您的性能影响是从一个好的连接算法到嵌套循环算法的影响。

如果不进行测试，我可能会建议以下一些策略。

1.  在两个表中的 P1 和 P2 上建立索引。SQL Server 甚至可以将索引用于非等连接。
2.  使用另一个解决方案中建议的联合查询。每个查询都应该正确优化。
3.  假设这些是 1-1 连接，您也可以将其作为一组多个连接来执行：

    从 t1.p1 上的 table1 t1 左外连接 table2 t2_11 = t2_11.p1 t1.p1 上的左外连接 table2 t2_12 = t2_12.p2 t1.p2 上的左外连接 table2 t2_21 = t2_21.p2 t1 上的左外连接 table2 t2_22。 p2 = t2_22.p2

然后在 SELECT 中使用 case/coalesce 逻辑来获得您真正想要的值。尽管这可能看起来更复杂，但它应该非常有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T11:30:56.243

你可以使用 4 查询和联合那里的结果

```
SELECT ... FROM Table1
INNER JOIN
Table2
  ON    Table1.P1 = Table2.P1
UNION
SELECT ... FROM Table1
INNER JOIN
Table2
  ON   Table1.P1 = Table2.P2
UNION
SELECT ... FROM Table1
INNER JOIN
Table2
  ON    Table1.P2 = Table2.P1
UNION
SELECT ... FROM Table1
INNER JOIN
Table2
  ON   Table1.P2 = Table2.P2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T14:35:56.783

使用 CTE 是否有助于提高绩效？

```
;WITH Table1_cte 
AS
(
SELECT 
      ...
      [P] = P1
FROM Table1
UNION   
SELECT 
      ...
      [P] = P2
FROM Table1
)
, Table2_cte 
AS
(
SELECT 
      ...
      [P] = P1
FROM Table2
UNION   
SELECT 
      ...
      [P] = P2
FROM Table2
)
SELECT ... FROM Table1_cte x
   INNER JOIN
   Table2_cte y
      ON x.P = y.P 
```

我怀疑，就处理器而言，以上只是相同复杂条件的不同语法。

# c# - 将字符串从 db 解析为 HTML

> ID：12338535
> 
> 赞同：0
> 
> 时间：2012-09-09T11:04:20.697
> 
> 标签：c#, html, parsing, razor

我在创建主页时遇到了以下问题。

我有一个数据库，其中包含来自用户的评论。该注释应该能够包含用于格式化和高度灵活性的 HTML 元素。

数据库单元格中的文本（类型：ntext）：

```
Hi, I'm a <b>Comment</b> 
```

.cshtml 文件中的代码：

```
<p>@textfromdb</p> 
```

网站上显示的内容：

你好，我是`<b>`评论`</b>`

网站上应该显示的内容：

你好，我是**评论**

是否有可能以某种方式将该字符串呈现为有效的 HTML 字符串？遗憾的是，我在 Google 上没有找到任何有用的信息，主要是因为我认为缺少正确的关键字。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:10:53.800

尝试以下操作：

```
 @Html.Raw(textfromdb) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T12:26:04.367

这可能不是正确的方法，因为我不使用剃须刀（所以我对支持和不支持的东西很模糊），但这是一种在旧式 asp.net/C# 中实现的方法

所以这是我的实现，当我需要将 HTML 直接从服务器发送到页面时，我使用面板（这是我不知道是否存在于剃须刀中的面板）。

服务器端：

```
PanelID.Controls.Add(new LiteralControl("<p>Hi, I'm a <b>Comment</b></p>")); 
```

客户端：

```
<asp:Panel ID="PanelID" runat="server"></asp:Panel> 
```

输出将是

> 你好，我是**评论**

如果这是一种糟糕的方法，我只会欢迎替代方法（但我还没有找到更好的方法）。

# objective-c - 使用objective-c重启系统到windows

> ID：12338539
> 
> 赞同：1
> 
> 时间：2012-09-09T11:05:12.867
> 
> 标签：objective-c, macos, operating-system, osx-mountain-lion

如果用户想要从 OS X 重新启动到 Windows，他/她需要：

*   a) 重启按住 ALT 键并选择 windows
*   b) 转到`System settings`-> `Startup disk`-> `Select windows`->`Reboot`

*（假设用户已经安装了 bootcamp 分区和 windows）。*

因为我时不时地玩一些游戏，并且更喜欢直接在 Windows 中进行，而不是使用例如 VMWare Fusion。我想开发一种更智能、更简单的重启方法。我知道如何使用 Objective-c 重新启动机器，但是如何选择启动分区并重新启动到它？基本上系统重启功能在系统设置中的工作方式（选择分区并重启）​​。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:15:17.563

不知道有没有程序化界面，不过可以用`bless`命令设置启动盘，见“man bless”。

# python - 跟踪文件夹更改/Dropbox 更改

> ID：12338544
> 
> 赞同：10
> 
> 时间：2012-09-09T11:05:36.087
> 
> 标签：python, ruby, dropbox, inotify

首先：我知道[pyinotify](https://github.com/seb-m/pyinotify)。

我想要的是使用 Dropbox 将上传服务上传到我的家庭服务器。

我将在我的家庭服务器上有一个 Dropbox 的共享文件夹。每次共享该文件夹的其他人将任何内容放入该文件夹时，我希望我的家庭服务器等到它完全上传并将所有文件移动到另一个文件夹，然后从 Dropbox 文件夹中删除这些文件，从而保存 Dropbox空间。

这里的问题是，我不能只跟踪文件夹中的更改并立即移动文件，因为如果有人上传了一个大文件，Dropbox 将已经开始下载，因此会在我的家庭服务器上显示文件夹中的更改。

有一些解决方法吗？Dropbox API 有可能吗？

自己没有尝试过，但[Dropbox CLI 版本](http://www.dropboxwiki.com/Using_Dropbox_CLI)似乎有一个“文件状态”方法来检查当前文件状态。当我自己尝试过时会报告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T20:52:39.953

正如您在问题中提到的，有一个 Python Dropbox CLI 客户端。它在不主动处理文件时返回“空闲...”。我能想象的实现你想要的最简单的机制是一个 while 循环，它检查输出`dropbox.py filestatus /home/directory/to/watch`并执行内容的 scp，然后如果成功则删除内容。然后睡了五分钟左右。

就像是：

```
import time
from subprocess import check_call, check_output
DIR = "/directory/to/watch/"
REMOTE_DIR = "user@my_server.com:/folder"

While True:
    if check_output(["dropbox.py", "status", DIR]) == "\nIdle...":
        if check_call(["scp", "-r", DIR + "*", REMOTE_DIR]):
            check_call(["rm", "-rf", DIR + "*"])
    time.sleep(360) 
```

当然，在测试这样的东西时我会非常小心，在第二个 check_call 中放错东西，你可能会丢失你的文件系统。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T22:02:49.147

您可以运行 incrond 并让它等待 Dropbox 文件夹中的 IN_CLOSE_WRITE 事件。然后它只会在文件传输完成时触发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T11:15:43.520

这是一个 Ruby 版本，它不等待 Dropbox 空闲，因此实际上可以开始移动文件，同时它仍在同步。它也忽略`.`and `..`。它实际上检查给定目录中每个文件的文件状态。

然后我会将此脚本作为 cronjob 或在单独的[屏幕](http://kb.iu.edu/data/acuy.html)中运行。

```
directory = "path/to/dir"
destination = "location/to/move/to"

Dir.foreach(directory) do |item|
    next if item == '.' or item == '..'
    fileStatus = `~/bin/dropbox.py filestatus #{directory + "/" + item}`
    puts "processing " + item
    if (fileStatus.include? "up to date")
        puts item + " is up to date, starting to move file now."
        # cp command here. Something along this line: `cp #{directory + "/" + item + destination}`
        # rm command here. Probably you want to confirm that all copied files are correct by comparing md5 or something similar.
    else
        puts item + " is not up to date, moving on to next file."
    end
end 
```

这是完整的脚本，我最终得到：

```
# runs in Ruby 1.8.x (ftools)

require 'ftools'

directory = "path/to/dir"
destination = "location/to/move/to"

Dir.glob(directory+"/**/*") do |item|
    next if item == '.' or item == '..'
    fileStatus = `~/bin/dropbox.py filestatus #{item}`
    puts "processing " + item
    puts "filestatus: " + fileStatus
    if (fileStatus.include? "up to date")
        puts item.split('/',2)[1] + " is up to date, starting to move file now."
        `cp -r #{item + " " + destination + "/" + item.split('/',2)[1]}`

        # remove file in Dropbox folder, if current item is not a directory and 
        # copied file is identical.
        if (!File.directory?(item) && File.cmp(item, destination + "/" + item.split('/',2)[1]).to_s)
            puts "remove " + item
            `rm -rf #{item}`
        end
    else
        puts item + " is not up to date, moving to next file."
    end
end 
```

# php - 我是否正确实施了我的 DAO？

> ID：12338545
> 
> 赞同：0
> 
> 时间：2012-09-09T11:05:42.233
> 
> 标签：php, mysql, dao

我将在这里大大缩短实际代码以使其快速。我已经拿出了大量的支票和其他东西，只是为了让它更容易理解。

这是我的用户类：

```
class User {

    private $userId;
    private $userDAO;

    public function __construct($dbh, $userId) {

        $this->userId = (int) $userId;
        //Create the UserDAO object
        $this->userDAO = new UserDAO($dbh, $this);

        //Get the up to date details of the user
        $userData = $this->userDAO->getUserData()

    }

} 
```

这是我的 UserDAO 类：

```
class UserDAO {

    private $dbh;
    private $user;

    public function __construct($dbh, $user) {

        $this->dbh = $dbh;
        $this->user = $user;

    }

    public function getUserData() {

        $stmt = $this->dbh->prepare("SELECT username FROM " . USERS_TABLE . " WHERE userId = :userId LIMIT 1");
        $stmt->bindParam(':userId', $this->user->getUserId(), PDO::PARAM_INT);
        $stmt->execute();
        return $stmt->fetch(PDO::FETCH_ASSOC);

    }

} 
```

这是正确的方法吗？如您所见，DAO 从 User 类的实例中获取用于数据库查询的变量，因此 DAO 方法不需要任何争论。

我的 getUserData() 方法是否应该对 userId 有争论并使用提供的 userId 来获取 userdata，以便 DAO 对象在每次需要获取用户数据时都不需要依赖 User 类的实例，因为任何 userId 都可以在方法签名中提供？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T15:52:31.820

我看到 User 和 UserDAO 都是紧密耦合的。用户拥有 UserDAO 并且 UserDAO 拥有 User 类。

在 DAO 设计模式中，它的 DAO 提供域对象或传输对象。

我认为更好的方法是从 User 类中删除 UserDAO，然后将 User 对象传递给 UserDAO 类以执行必要的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T11:11:03.307

提供类 User 的对象称为“依赖注入” - 有点。从我的角度来看，这实际上是一个很好的方法。这样，您就可以将其留给您的 UserDAO 类来决定将哪些数据用于查询。

虽然我会使用 $user 作为 getUserData 函数的参数，而不是通过构造函数 - 但这可能只是我个人的偏好。

# asp.net - 尽管编写了调试器-Visual Studio 2008，但无法在 Javascript 中达到断点

> ID：12338546
> 
> 赞同：0
> 
> 时间：2012-09-09T11:06:10.703
> 
> 标签：asp.net, debugging, breakpoints

我已经阅读了几篇关于如何在调试模式下在 java 脚本函数中放置断点的帖子。`debugger`一个简单的解决方案是在需要断点的地方编写。但不幸的是，这对我不起作用。我`<compilation debug="true">`在 web.config 中给出了 - 并在需要断点的任何地方用 javascript 编写了调试器。但是没有用。

我到底做了什么的屏幕截图：

![在此处输入图像描述](../Images/5a77035b94c0a9e7990f8ac8dcbd20e8.png)

我在按钮单击时调用了这个 drouote() 并且它确实执行了，但是没有命中断点。我哪里错了？此外，在到达断点时，在 chrome 控制台或 Visual Studio 中，此代码将显示在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:21:50.863

您在 2 个浏览器中有 2 个选项

如果您需要在 Visual Studio 中进行调试，则必须使用 IE，还必须在 VS 中按 Run 并放置断点。

我认为这是一个艰难的方式

最简单的方法是在 FireFox 上下载 firefox 浏览器，然后从 firefox addons 网站添加 FireBug 插件 使用 F12 运行 firebug 并启用 Consol 和 Script Pans 然后打开您的页面并调试您的 javascript 但请注意，您必须在此处放置调试器在这种情况下使用关键字，直到您对 firebug 了解很多，然后您才会知道如何在 firebug 中放置断点，而不是放置 debugger 关键字

如果您需要更多帮助，请联系我

# c# - Wcf 服务不返回 cookie

> ID：12338547
> 
> 赞同：1
> 
> 时间：2012-09-09T11:06:46.823
> 
> 标签：c#, .net, wcf, windows-phone-7.1

我正在开发一个 Windows Phone 应用程序。它需要对站点进行身份验证。我将用户名和密码发送到 WCF 服务，该服务将检查身份验证。

服务端代码：

**服务.svc.cs**

```
public CookieContainer GetConnect(string uid, string password)
//public string GetConnect(string uid, string password)
{
    try
    {
         HttpWebRequest req = (HttpWebRequest)WebRequest.Create("http://example.com/Login1.action");
        req.Method = "POST";
        CookieContainer con = new CookieContainer();
        req.CookieContainer = con;
        req.CookieContainer.Add(GetCookies());
        req.KeepAlive = true;

        req.UserAgent = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11";
        req.ContentType = "application/x-www-form-urlencoded";
        req.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";

        req.Referer = "http://example.com/content/index.html";

        byte[] data = Encoding.Default.GetBytes("username=" + uid + "&password=" + password);
        req.Credentials = new NetworkCredential(uid, password);
        req.ContentLength = data.Length;
        req.AllowAutoRedirect = true;
        req.ServicePoint.Expect100Continue = true;

        string str = req.GetRequestStream();
        str.Write(data, 0, data.Length);
        str.Close();

        HttpWebResponse res = (HttpWebResponse)req.GetResponse();

        string iduri = System.Web.HttpUtility.ParseQueryString(res.ResponseUri.Query).Get("id");
        if (iduri != "")
        {
            return con; 
            //return "Success";
        }
        else
        {
            res.Close();
            str.Close();

            return null;
            //return "Fail";
        }
    }
    catch (Exception)
    {
        return null;
    }
} 
```

**IService.cs**

```
[ServiceContract]
public interface IService1
{
    [OperationContract]
    CookieCollection GetCookies();

    [OperationContract]
    CookieContainer GetConnect(string uname, string password);
    //string GetConnect(string uname, string password);
} 
```

客户端代码：

**登录.xaml.cs**

```
void svc_Get_Connected(object send, GetConnectCompletedEventArgs e)
{
    var cc = new CookieContainer();
    cc=e.Result;
} 
```

当我重新调整**con**对象时，它会给出以下错误：

> 在[http://example.com:3922/Service1.svc](http://example.com:3922/Service1.svc)上没有可以接受消息的端点监听。这通常是由不正确的地址或 SOAP 操作引起的。有关更多详细信息，请参阅 InnerException（如果存在）。”

如何返回`CookieContainer`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T14:32:26.693

您需要装饰您的返回对象类，以便 WCF 可以对其进行序列化，例如：

```
[DataContract]
public class CookieContainer 
{
    [DataMember]
    public string SomeProperty { get; set; }
    [DataMember]
    public string SomeOtherProperty { get; set; }
    // you get the idea...
} 
```

不要忘记构建您的服务，运行它，然后刷新客户端服务参考或手动重新生成客户端代理代码和配置。

# qt - Qt Widget 暂时全屏

> ID：12338548
> 
> 赞同：5
> 
> 时间：2012-09-09T11:07:05.737
> 
> 标签：qt, widget, fullscreen, qtgui

考虑一个 QWidget，通常是某个布局中的子级。

假设我想让它全屏一段时间，然后让它回到原来的位置。

`QWidget::setFullScreen()`要求小部件必须是一个独立的窗口 - 任何想法如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T12:14:16.723

我能看到的最简单的方法是重新设置为 0。这样的事情：

```
#include <QApplication>
#include <QPushButton>

class MyButton : public QPushButton
{
public:
   MyButton(QWidget* parent) : QPushButton(parent) {}

   void mousePressEvent(QMouseEvent*) {
      this->setParent(0);
      this->showMaximized();
      this->show();
   }
};

int main(int argc, char *argv[])
{
   QApplication a(argc, argv);

   QWidget mainWidget;
   MyButton button(&mainWidget);
   mainWidget.show();

   return a.exec();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T08:52:46.097

我已经修改了前面的示例。前面的示例永远不会回到正常屏幕。

只需复制粘贴代码，它就会运行。

```
 #include <QApplication>
        #include <QPushButton>

        class MyButton : public QPushButton
        {
        public:
           MyButton(QWidget* parent) : QPushButton(parent) {
               m_pParent = parent;
               maxMode = false;
           }
           QWidget * m_pParent;
           bool maxMode;
           Qt::WindowFlags m_enOrigWindowFlags;
           QSize m_pSize;

           void mousePressEvent(QMouseEvent*) {
               if (maxMode== false)
               {
                   m_enOrigWindowFlags = this->windowFlags();
                   m_pSize = this->size();
                    this->setParent(0);
                    this->setWindowFlags( Qt::FramelessWindowHint|Qt::WindowStaysOnTopHint);
                    this->showMaximized();
                    maxMode = true;
               }
               else
               {
                   this->setParent(m_pParent);
                   this ->resize(m_pSize);
                   this->overrideWindowFlags(m_enOrigWindowFlags);
                   this->show();
                   maxMode =  false;
               }
           }
        };

        int main(int argc, char *argv[])
        {
           QApplication a(argc, argv);

           QWidget mainWidget;
           MyButton button(&mainWidget);
           mainWidget.show();

           return a.exec();
        } 
```

# php - PHP simplexml 计数字符串

> ID：12338549
> 
> 赞同：0
> 
> 时间：2012-09-09T11:07:06.243
> 
> 标签：php

我正在研究 XML，我使用了 simplexml。

```
$xml = simplexml_load_file(a xml file); //this website is just chosen randomly 

    if(!in_array($iindex,$category_type)){
        $category_type[] = $iindex;
        $category_type[$iindex] = 1;
    } else {
        $category_type[$iindex] = $category_type[$iindex] + 1;
    }
}

foreach($category_type as $key=> $value){
    echo " number of $key is ". $value;
} 
```

我目前得到的结果是

```
number of 0 is Really Funny Jokes
number of Really Funny Jokes is 13
number of 1 is Clean jokes 
```

我期待的结果是

```
 number of Really Funny Jokes is 13
    number of Clean jokes is 6
    number of Good jokes is 2 
```

有人可以帮助我的代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:09:39.870

```
if(!array_key_exists($iindex, $category_type)){
//$category_type[] = $iindex; //**remove this line**
$category_type[$iindex] = 1;
} else { 
```

该行所做的是在数组中插入一个条目，索引为 0,1,2.. 和值作为您的键..

并使用 array_key_exists ..

# iphone - CALayer shouldRasterize 是否传播到所有子层？

> ID：12338553
> 
> 赞同：15
> 
> 时间：2012-09-09T11:07:39.937
> 
> 标签：iphone, ios, ipad, core-animation, calayer

如果我在 CALayer 上设置了 shouldRasterize = YES，如果我希望将整个层次结构展平以获得更好的动画性能，是否也必须在每个子层上设置它？

我问是因为当我在根图层上设置 shouldRasterize = YES 并在仪器中启用“颜色混合图层”时，所有子图层仍然存在并标记为混合。它没有使任何东西变平。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-12T13:53:33.167

设置`shouldRasterize`并没有完全按照您的想法进行。为了合成父视图的外观，无论是否光栅化，它必须检查子视图以查看它们是否`opaque`透明。当子对象是 时`opaque`，它们不需要混合。当它们是透明的时，视图需要与它们后面的任何东西（或层次结构中的更高层）混合。

因此，`shouldRasterize`不会影响您使用 Instruments 看到的绿色/红色。为了让所有东西都变成绿色，您需要不使用透明度并将所有子对象都设置为`opaque`. 有时，根据您的设计，仍然不可避免地会有红色区域。该工具可帮助您优化*可能*`opaque`的工具并减少 GPU 必须执行的混合量。

编辑：为了进一步解释，假设你有一个`UILabel`和它坐在照片上。您只想看到文本而不是其背景颜色，因此将其设置`backgroundColor`为 clear，并将`opaque`属性设置为 NO。在仪器中，这将显示为红色。GPU 必须在其背后的图像上混合这种透明度，执行两个绘制操作而不是一个。

如果我们设置并`opaque`给`YES`它一个纯色的背景颜色，该视图现在将在仪器中显示为绿色，因为它不必将该视图与任何其他视图混合。

因此，无论图层是否被光栅化，它仍然必须合成其子视图，因此`shouldRasterize`对于您在 Instruments 中看到的内容实际上没有任何影响。

# security - 注册用户时的密码哈希

> ID：12338555
> 
> 赞同：0
> 
> 时间：2012-09-09T11:07:42.023
> 
> 标签：security, login, web

我知道有类似的问题，但我找不到能回答我问题的东西。

当新用户注册（客户端-服务器）时，是否有一种通用的方法可以在发送这些详细信息时对其进行保护？

目前我只是连接用户名-密码-时间​​戳，然后通过 https 作为 Base64 发送到服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:22:55.823

常见和最好的方法是https。Https 已经在客户端和服务器之间建立了安全通道。你不再需要任何东西了。

请原谅我的简短回答。但是，如果您真的想要长答案，请查看： [如何在没有 HTTPS 的情况下使用 Javascript 通过 HTTP 安全地发送密码？](https://stackoverflow.com/questions/2003262/how-to-send-password-securely-via-http-using-javascript-in-absence-of-https)

# c# - 在 Web 主机上部署网站时出现“..allowDefinition='MachineToApplication' 超出应用程序级别”错误

> ID：12338559
> 
> 赞同：0
> 
> 时间：2012-09-09T11:08:25.753
> 
> 标签：c#, asp.net, deployment, web, web-config

**我在整个互联网和 Stackoverflow 上都遇到了这个遗传问题的解决方案，但没有一个在部署后/部署**后谈论相同的问题。我也读过这篇著名的[文章](http://scottonwriting.net/sowblog/archive/2010/02/17/163375.aspx)。所以，我的网站通过 VS 2010 运行得非常好。但是，当我使用 VS 2010 的复制工具部署我的**网站**时，我遇到了这个问题。

里面有三个`web.config`文件`1- root, 2- Users folder, 3- accounts folder`。。该标记存在于根目录的 web.config 文件中。其层次结构如下所示：`domain.com / httpdocs / websitefolder / web.config`. 在`websitefolder`文件夹中进一步包含 web.configs，但它们都没有标签`Accounts`。`Users`

从开发机器到部署可能会出现什么问题？我得到的错误是在线的：

```
Line 16:  <authentication mode="Forms"> 
```

在 httpdocs 中，还有**其他**带有 web.configs 的项目，这可能是个问题吗？在那种情况下，我也删除了他们的内容，但没有帮助（但也许我应该做得更好？我不知道这是否是必需的？）。

另外，这是一个**网站**，所以**没有**创建 bin 或 obj 文件夹，没有那种问题。请建议，我无法找出问题所在。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T11:12:00.213

通常当您在一个站点的子目录中有多个站点时，尽管您删除了 web.config，但问题仍然存在。在这种情况下，即使是子文件夹也应标记为应用程序。

您拥有此网站的文件夹是否在 IIS 中部署了应用程序？这是可能发生此错误的主要原因之一。

如果不是，请将其作为应用程序，问题应该得到解决。

**更新：**似乎您在开发网站时使用了文件系统。

[首先像“ this](http://www.howtogeek.com/howto/windows-vista/how-to-install-iis-on-windows-vista/) ”一样安装IIS服务器。

接下来，您应该在 IIS 中创建一个虚拟目录。见“[本](http://msdn.microsoft.com/en-us/library/bb763173%28v=vs.100%29.aspx)”。（在物理路径中，选择您的部署文件夹的路径）

现在运行网站。如果您的问题得到解决，则意味着问题出在远程服务器中的虚拟目录上。所以举报他们。

# php - MAMP 上的 PDOException“找不到驱动程序”

> ID：12338561
> 
> 赞同：1
> 
> 时间：2012-09-09T11:08:29.000
> 
> 标签：php, pdo, mamp

我正在尝试在我的本地主机上使用 PDO。我在 OSX 10.7.4 上运行 MAMP。

我检查了 phpinfo()，据我所知，我应该没问题。

![在此处输入图像描述](../Images/c1dfa835f2ff5d76cf137182787ac768.png)

我检查了 php.ini，发现“extension=pdo_mysql.so”实际上没有注释。

我读到一些是我必须使用以下内容制作文件 PROJECTFOLDER/config/parameters.ini 所以我做了，但没有运气。（更改它以反映我的原因设置）

```
database_driver   = pdo_mysql
database_host     = localhost
database_port     =
database_name     = databasename
database_user     = msqlusername
database_password = mysqlpassword//if not make blank

mailer_transport  = smtp
mailer_host       = localhost
mailer_user       =
mailer_password   =

locale            = en

secret            = ThisTokenIsNotSoSecretChangeIt 
```

**关于如何启动和运行 PDO 的任何想法？**

顺便说一句，我正在使用以下代码进行连接：

```
try {  
    $host = 'localhost';
    $dbname = 'ifjernsyn';
    $user = 'root';
    $pass = 'root';

    # MS SQL Server and Sybase with PDO_DBLIB  
    $DBH = new PDO("mssql:host=$host;dbname=$dbname, $user, $pass");  
    $DBH = new PDO("sybase:host=$host;dbname=$dbname, $user, $pass");  

    # MySQL with PDO_MYSQL  
    $DBH = new PDO("mysql:host=$host;dbname=$dbname", $user, $pass);  

    # SQLite Database  
    $DBH = new PDO("sqlite:my/database/path/database.db");  
}  
catch(PDOException $e) {  
    echo $e->getMessage();  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:11:42.180

所以没有`mssql`and`sybase`的驱动程序。

您需要[PDO_DBLIB](http://www.php.net/manual/en/ref.pdo-dblib.php)才能访问 Microsoft SQL Server 和 Sybase 数据库。

# autofac - 如何在运行时解析泛型类型

> ID：12338564
> 
> 赞同：2
> 
> 时间：2012-09-09T11:08:36.130
> 
> 标签：autofac

我正在尝试构建一个命令处理器，它可以接受任何实现标记接口（或者可能来自基类）的命令。处理器将处理它被要求处理的命令。但是，我正在努力解决真正的泛型类型，因为 Resolve(Type) 返回一个对象。如果可能的话，我不确定如何投射这个？

```
public void Process(ICommand command)
{
    var c = command.GetType();
    var t = typeof(ICommandHandler<>).MakeGenericType(new[] { c });
    var o = container.Resolve(t);
    //((ICommandHandler)o).Handle(command);  *** This doesn't work
} 
```

调用代码将是这样的 -

```
Dispatcher.Process(new SomeCommand(Guid.NewGuid(),"Param1",12345)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:06:56.510

如果您绝对必须调用该`ICommandHandler<T>.Handle`方法并且您对系统的设计没有其他控制权，那么**反射可能是您唯一的选择**。没有很好的方法来处理从通用到非通用的转换。

否则，您可能有几个选择。

首先，如果你**`Dispatcher.Process`可以通用**，你可以保存所有的铸件。

```
public static class Dispatcher
{
  public static void Process<T>(T command) where T : ICommand
  {
    var handler = container.Resolve<ICommandHandler<T>>();
    handler.Handle(command);
  }
} 
```

对于我在野外看到的此类问题，这是一个非常常见的解决方案。

如果你不能这样做，那么你可以**让你的`ICommandHandler<T>`接口实现一个非通用的`ICommandHandler`基本接口**。

```
public interface ICommandHandler
{
  void Handle(ICommand command);
}

public interface ICommandHandler<T> : ICommandHandler
{
  void Handle(T command);
} 
```

在后一种情况下，您必须切换强类型命令处理程序实现以调用相同的内部逻辑进行通用或基本处理，否则您将根据调用获得不同的处理，这将是不好的：

```
public class SomeCommandHandler : ICommandHandler<SomeCommand>
{
  public void Handle(ICommand command)
  {
    var castCommand = command as SomeCommand;
    if(castCommand == null)
    {
      throw new NotSupportedException("Wrong command type.");
    }
    // Hand off to the strongly-typed version.
    this.Handle(castCommand);
  }

  public void Handle(SomeCommand command)
  {
    // Here's the actual handling logic.
  }
} 
```

然后，当您解决强类型`ICommandHandler<T>`转换时`ICommandHandler`（如您的问题的示例代码所示）将起作用。

这也是一个非常常见的解决方案，但我在泛型可用之前存在的系统中看到了更多，其中正在添加更新的 API。

但是，在这里的所有情况下，问题实际上不在于 Autofac 正在返回一个对象。这是一个影响任何泛型到非泛型转换方案的类/类型设计问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T13:55:19.443

使用反射 - 但这是解决这个问题的最佳方法吗？

```
 public void Process(Command command)
    {
        var c = command.GetType();
        var ot = typeof(ICommandHandler<>);
        var type = ot.MakeGenericType(new[] { c });
        var mi = type.GetMethod("Handle");
        var o = container.Resolve(type);
        mi.Invoke(o, new object[] { command });
    } 
```

# c# - 用c#和OOP概念实现一对多关系

> ID：12338565
> 
> 赞同：0
> 
> 时间：2012-09-09T11:08:42.077
> 
> 标签：c#, one-to-many

我正在做一个项目。

有一些表 CIRCLE、DIVISION、SUBDIVISION 和 FEEDERS。现在，这些表的层次结构是 CIRCLE 有很多 DIVISIONS，DIVISION 有很多细分，Subdivision 有很多 FEEDERS。所以这些表之间存在一对多的关系。

现在，我必须使用 c# 和 OOP 的概念来构建应用程序。

任何人都可以帮助我如何使用 OOP 概念在 c# 应用程序中实现这个表层次结构吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:22:43.357

我强烈建议使用[ORM 框架](https://stackoverflow.com/questions/132676/which-orm-for-net-would-you-recommend)，例如[LINQ to SQL](http://msdn.microsoft.com/en-us/library/vstudio/bb386976.aspx)或更高级的[Entity Framework](http://msdn.microsoft.com/en-us/library/bb386964.aspx)。

由于这听起来很像家庭作业，无论如何让我们以一种对 OOP 友好的方式来解决它，通过定义一个抽象基类来避免冗余：

```
public abstract class OneToMany<TMany>
{
    private readonly IList<TMany> children = new List<TMany>();
    public IList<TMany> Children { get { return children; }}  
}

public class Circle : OneToMany<Division>
{   
}

public class Division : OneToMany<Subdivision>
{   
}

public class Subdivision : OneToMany<Feeder>
{   
}

public class Feeder
{    
} 
```

* * *

**用法**

```
var circle = new Circle();
circle.Children.Add(new Division());
var subdivision = new Subdivision();
subdivision.Children.Add(new Feeder());
subdivision.Children.Add(new Feeder());
circle.Children.First().Children.Add(subdivision); 
```

* * *

**解释**

`OneToMany<T>`是所有具有一对多关系的类派生自的[通用抽象基类。](http://msdn.microsoft.com/en-us/library/512aeb7t%28v=vs.110%29.aspx)它接受类型参数 ,`TMany`表示一对多关系的*多侧元素的类型。*

所以，`Circle` **is a** `OneToMany<Division>`（一个圆圈有多个分区），while `Division` **is a** `OneToMany<Subdivision>`，依此类推。

定义了此类层次结构后，我们现在可以构建表示数据库行的对象树，如“*使用*”部分所示。我们可以这样想象：

```
     圆圈
       |
    分配
       |
   细分
   / \
 喂料机

```

# c++ - 提升精神规则 - 规则串联

> ID：12338566
> 
> 赞同：3
> 
> 时间：2012-09-09T11:08:50.830
> 
> 标签：c++, boost-spirit, boost-spirit-qi

我有一个字符串规则对的映射，我想以某种方式创建它们的“联合规则”（rule_t joint_rule;）。如果我这样做：

```
joint_rule = convert_logformat["%h"] >> convert_logformat["%t"]; 
```

比与 parse_phrase 的联合规则匹配字符串

```
std::string entry = "127.0.0.1 [16/Aug/2012:01:50:02 +0000]"; 
```

但是，如果我以这种方式创建联合规则：

```
for (it = convert_logformat.begin(); it != convert_logformat.end(); it++)
{
   joint_rule = joint_rule.copy() >> (*it).second.copy();
} 
```

它不匹配相同的字符串。为什么？我怎样才能实现与后者类似的东西？

* * *

相关代码：

```
 template <typename Iterator>
bool parse_logentry(Iterator first, Iterator last, std::vector<char>& ip, std::vector<char>& timestamp, std::vector<char>& req, unsigned int& status, unsigned int& transferred_bytes, std::vector<char>& referer, std::vector<char>& ua)
{
    using boost::spirit::qi::char_;
    using boost::spirit::qi::int_;
    using boost::spirit::qi::uint_;
    using boost::spirit::qi::phrase_parse;
    using boost::spirit::ascii::space;
    using boost::spirit::ascii::space_type;
    using boost::phoenix::ref;
    using boost::phoenix::push_back;
    using boost::spirit::qi::_1;
    using boost::spirit::qi::lexeme;
    using boost::spirit::qi::rule;

    typedef boost::spirit::qi::rule<Iterator, std::string(), space_type> rule_t;
    rule_t ip_rule, timestamp_rule, user_rule, req_rule, ref_rule, ua_rule, bytes_rule, status_rule;
    ip_rule %= lexeme[(+char_("0-9."))[ref(ip) = _1]];
    timestamp_rule %= lexeme[('[' >> +(~char_(']')) >> ']')[ref(timestamp) = _1]];
    user_rule %= lexeme[(+~char_(" "))];
    req_rule %= lexeme[('"' >> +(~char_('"')) >> '"')[ref(req) = _1]];
    ref_rule %= lexeme[('"' >> +(~char_('"')) >> '"')[ref(referer) = _1]];
    ua_rule %= lexeme[('"' >> +(~char_('"')) >> '"')[ref(ua) = _1]];
    bytes_rule %= uint_[ref(transferred_bytes) = _1];
    status_rule %= uint_[ref(status) = _1];
    std::map<std::string, rule_t> convert_logformat;
    typename std::map<std::string, rule_t>::iterator it;

    convert_logformat.insert(std::pair<std::string, rule_t>("%h", ip_rule));
    convert_logformat.insert(std::pair<std::string, rule_t>("%t", timestamp_rule));
    //convert_logformat.insert(std::pair<std::string, rule_t>("%r", req_rule));
    //convert_logformat.insert(std::pair<std::string, rule_t>("%>s", status_rule));
    //convert_logformat.insert(std::pair<std::string, rule_t>("%b", bytes_rule));
    //convert_logformat.insert(std::pair<std::string, rule_t>("%u", user_rule));
    //convert_logformat.insert(std::pair<std::string, rule_t>("%{User-agent}i", ua_rule));
    //convert_logformat.insert(std::pair<std::string, rule_t>("%{Referer}i", ref_rule));

    rule_t joint_rule;

    //joint_rule = convert_logformat["%h"] >> convert_logformat["%t"];

    for (it = convert_logformat.begin(); it != convert_logformat.end(); it++)
    {
        joint_rule = joint_rule.copy() >> (*it).second.copy();
        std::cout << (*it).first << ": " << typeid((*it).second).name() << "\n";
    }

    std::cout << "convert_logformath: " << typeid(convert_logformat["%h"]).name() << "\n";

    bool r = phrase_parse(first, last, joint_rule, space);
    if (first != last)
        return false;
    return r;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T08:40:20.593

咳咳。这真的很简单。你应该初始化你的变量:)

```
rule_t joint_rule; // what is it initialized to?

for (auto it = convert_logformat.begin(); it != convert_logformat.end(); it++)
{
    joint_rule = joint_rule.copy() >> (*it).second.copy();
} 
```

将第一行更改为

```
rule_t joint_rule = qi::eps; 
```

它有效：

```
sehe@mint12:/tmp$ ./test 
127.0.0.1
16/Aug/2012:01:50:02 +0000 
```

您的解析器缺乏一些（好的）常见做法。请参阅下面的整理源代码 (C++11)。

> 请注意，使用 a`map`来存储规则看起来很奇怪，因为映射迭代将按键排序，而不是插入顺序。

**[在http://liveworkspace.org/code/a7f2f94840d63fce43d8c3f56236330e](http://liveworkspace.org/code/a7f2f94840d63fce43d8c3f56236330e)**查看代码

```
// #define BOOST_SPIRIT_DEBUG
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix.hpp>
#include <typeinfo>

namespace qi = boost::spirit::qi;
namespace phx = boost::phoenix;

template <typename Iterator>
struct Grammar : qi::grammar<Iterator, std::string(), qi::space_type>
{
    Grammar() : Grammar::base_type(joint_rule)
    {
        using namespace qi;
        ip_rule        %= lexeme[ (+char_("0-9."))[phx::ref(ip)                      =  _1] ]; 
        timestamp_rule %= lexeme[ ('[' >> +(~char_(']')) >> ']')[phx::ref(timestamp) =  _1] ]; 
        user_rule      %= lexeme[ (+~char_(" "))                                ]; 
        req_rule       %= lexeme[ ('"' >> +(~char_('"')) >> '"')[phx::ref(req)       =  _1] ]; 
        ref_rule       %= lexeme[ ('"' >> +(~char_('"')) >> '"')[phx::ref(referer)   =  _1] ]; 
        ua_rule        %= lexeme[ ('"' >> +(~char_('"')) >> '"')[phx::ref(ua)        =  _1] ]; 
        bytes_rule     %= uint_[phx::ref(transferred_bytes)                          =  _1  ]; 
        status_rule    %= uint_[phx::ref(status)                                     =  _1  ]; 

        auto convert_logformat = std::map<std::string, rule_t> {
            { "%h"            , ip_rule }       ,
            { "%t"            , timestamp_rule },
        //  { "%r"            , req_rule }      ,
        //  { "%>s"           , status_rule }   ,
        //  { "%b"            , bytes_rule }    ,
        //  { "%u"            , user_rule }     ,
        //  { "%{User-agent}i", ua_rule }       ,
        //  { "%{Referer}i"   , ref_rule }
        };

        joint_rule = eps;

        for (auto const& p: convert_logformat)
        {
            joint_rule = joint_rule.copy() >> p.second.copy();
        }

        BOOST_SPIRIT_DEBUG_NODE(ip_rule);
        BOOST_SPIRIT_DEBUG_NODE(timestamp_rule);
        BOOST_SPIRIT_DEBUG_NODE(user_rule);
        BOOST_SPIRIT_DEBUG_NODE(req_rule);
        BOOST_SPIRIT_DEBUG_NODE(ref_rule);
        BOOST_SPIRIT_DEBUG_NODE(ua_rule);
        BOOST_SPIRIT_DEBUG_NODE(bytes_rule);
        BOOST_SPIRIT_DEBUG_NODE(status_rule);
    }

    typedef qi::rule<Iterator, std::string(), qi::space_type> rule_t;
    rule_t ip_rule, timestamp_rule, user_rule, req_rule, ref_rule, ua_rule, bytes_rule, status_rule;
    rule_t joint_rule;

    std::vector<char> ip;
    std::vector<char> timestamp;
    std::vector<char> req;
    unsigned int status;
    unsigned int transferred_bytes;
    std::vector<char> referer;
    std::vector<char> ua;
};

template <typename Iterator>
bool parse_logentry(Iterator first, Iterator last, 
        Grammar<Iterator>& parser)
{
    bool r = phrase_parse(first, last, parser, qi::space);

    return (r && (first == last));
}

int main(void)
{
    std::string entry = "127.0.0.1 [16/Aug/2012:01:50:02 +0000]";
    //std::string entry = "127.0.0.1 [16/Aug/2012:01:50:02 +0000] \"GET /check.htm HTTP/1.1\" 200 17 \"-\" \"AgentName/0.1 libwww-perl/5.833\"";

    Grammar<std::string::iterator> parser;

    if (parse_logentry(entry.begin(), entry.end(), parser))
    {
        for (auto i : parser.ip)
            std::cout << i;
        std::cout << "\n";

        for (auto ts: parser.timestamp)
            std::cout << ts;
        std::cout << "\n";
    }
    else
    {
        std::cout << "not ok\n";
    }

    return 0;
} 
```

请注意，除其他外，此设置允许您通过在开始时简单地定义 BOOST_SPIRIT_DEBUG 来启用语法调试。

# oracle - 从 Oracle 函数返回表

> ID：12338573
> 
> 赞同：3
> 
> 时间：2012-09-09T11:09:46.253
> 
> 标签：oracle, function, plsql, oracle11g

我在这里查看了许多解决方案来尝试解决这个问题，他们已经走了很远，但现在我陷入了一些我似乎无法克服的错误中。

我在 Oracle 11g 上。我需要一个函数来返回一个记录集（表）。这是我正在使用的代码：

```
CREATE TYPE T_TABLE IS OBJECT
(
    Field1 int
    , Field2 int
);

CREATE TYPE T_TABLE_COLL IS TABLE OF T_TABLE;

CREATE OR REPLACE FUNCTION FN_MyFunction
RETURN T_TABLE_COLL 
IS
BEGIN
  FOR I IN (SELECT Field1, Field2 FROM Table1) LOOP
    IF I.Field1 = 1 THEN
        BEGIN           
            INSERT INTO T_TABLE     
            SELECT Field1, Field2
            FROM Table2
            WHERE Field2 = I.Field2;
        END;
    ELSIF I.Field1 = 2 THEN
        BEGIN           
            INSERT INTO T_TABLE     
            SELECT Field1, Field2
            FROM Table2
            WHERE Field2 = I.Field2;
        END;  
  END IF;
  END LOOP;
  RETURN T_SMRYACCT_TABLE_COLL;
END; 
```

我从中收到的错误是：

1.  在 FUNCTION FN_MyFunction 行和 PL/SQL 上忽略的语句：ORA-04044：在每一行上都不允许使用过程、函数、包或类型 INSERT INTO T_TABLE_COLL 行

2.  PLS-00330：在 RETURN 行上无效使用类型名称或子类型名称

我对表格类型做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T12:10:04.943

`T_TABLE_COLL`是一个集合。您不能在集合上使用**插入。**

```
CREATE OR REPLACE FUNCTION FN_MyFunction
RETURN T_TABLE_COLL
IS
  l_res_coll T_TABLE_COLL;
  l_index number;
BEGIN
  l_res_coll := T_TABLE_COLL();
  FOR I IN (SELECT col1, col2 FROM Table1)
  LOOP
    IF I.col1 = 1 THEN
      l_res_coll.extend;
      l_index := l_res_coll.count;  
      l_res_coll(l_index):= T_TABLE(i.col1, i.col2);
    END IF;
  END LOOP;
  return l_res_coll;
END; 
```

功能在行动

```
select *
  from table(FN_MyFunction()) 
```

要获取有关什么是集合以及如何使用它们的更多信息，请阅读[此](http://docs.oracle.com/cd/E11882_01/appdev.112/e25519/composites.htm#CIHIEBJC)

# c# - wpf silverlight 多目标资源字典

> ID：12338575
> 
> 赞同：1
> 
> 时间：2012-09-09T11:10:18.763
> 
> 标签：c#, wpf, silverlight

我正在编写一些**多目标**应用程序（.net 4.0）。我有 ResourceDictionay 的问题。 **场景：** 创建 WPF CustomControlLibrary - 将其命名为“WpfLib”，默认命名空间“test” 在 WpfLib 创建 UserControl - 将其命名为“uc”

```
<UserControl x:Class="test.uc"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="res.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>   
    <Grid>
        <Button Style="{StaticResource bStyle}" Content="Button" Height="23"  Width="75" />
    </Grid>
</UserControl> 
```

“res.xaml”的代码

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Style x:Key="bStyle" TargetType="{x:Type Button}">
        <Setter Property="Background" Value="Red" /> 
    </Style>
</ResourceDictionary> 
```

现在一切都很好......按钮是红色的

现在让我们添加新的 Project Silverlight 应用程序并将其命名为“SlApp”（Silverlight 5）（命名空间“test”）让我们从“WpfLib”中添加“uc”作为链接（“uc.xaml”“uc.xaml.cs”）。在“SlApp”中创建新的 ResourceDictionary 并将其命名为 res.xaml，如下所示：

```
 <ResourceDictionary
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
        <Style x:Key="bStyle" TargetType="Button">
            <Setter Property="Background" Value="Blue" />
        </Style>
    </ResourceDictionary> 
```

新 ResourceDictionary 具有 TargetType="Button"，因为 SilverLight 不支持 x:Type。背景设置为蓝色而不是红色。

问题就从这里开始了。
我如何使它工作？控制 uc 在合并时显示错误（在 Silverlight 版本中）。我在 Wpf 和 Silverlight 版本的用户控件上需要不同的 ResourceDictionary。ClassLibrary 不支持 app.xaml，我不能使用默认样式。

# c++ - 重新转换数组以存储在向量中

> ID：12338577
> 
> 赞同：0
> 
> 时间：2012-09-09T11:10:33.770
> 
> 标签：c++, arrays

我有一个奇怪的问题。我有一个需要返回到另一个函数的数组。问题是它必须被输出/转换为

```
(unsigned)(unsigned char) 
```

处理数据的函数是 char* 类型。这是我在其中转换数据的函数：

```
char* Wav::readHeader(ifstream &file)
{
file.read(this->chunkId,                                 4);
file.read(reinterpret_cast<char*>(&this->chunkSize),     4);
file.read(this->format,                                  4);

file.read(this->formatId,                                4);
file.read(reinterpret_cast<char*>(&this->formatSize),    4);
file.read(reinterpret_cast<char*>(&this->format2),       2);
file.read(reinterpret_cast<char*>(&this->numChannels),   2);
file.read(reinterpret_cast<char*>(&this->sampleRate),    4);
file.read(reinterpret_cast<char*>(&this->byteRate),      4);
file.read(reinterpret_cast<char*>(&this->align),         2);
file.read(reinterpret_cast<char*>(&this->bitsPerSample), 4);

char testing[4] = {0};
int testingSize = 0;

while(file.read(testing, 4) && (testing[0] != 'd' ||
                                testing[1] != 'a' ||
                                testing[2] != 't' ||
                                testing[3] != 'a'))
{

    file.read(reinterpret_cast<char*>(&testingSize), 4);
    file.seekg(testingSize, std::ios_base::cur);

}

this->dataId[0] = testing[0];
this->dataId[1] = testing[1];
this->dataId[2] = testing[2];
this->dataId[3] = testing[3];

file.read(reinterpret_cast<char*>(&this->dataSize),     4);

this->data = new char[this->dataSize];

file.read(data,                           this->dataSize);

for(unsigned i=0; (i < 20); i++)
{
    //cout << (unsigned)(unsigned char)data[i] << endl; 

}

return (unsigned)(unsigned char) data;
} 
```

在另一个函数中，我有这个：

```
unsigned char* data = this->readHeader(file); 
```

谁能看到我哪里出错了？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:22:00.110

```
this->data = new char[this->dataSize]; 
```

所以，大概，`this->data`有 type `char*`。很好：这也是函数的返回类型。所以`return data`似乎是正确的代码。

# javascript - 如何将对象传递给这个js函数？

> ID：12338580
> 
> 赞同：1
> 
> 时间：2012-09-09T11:11:10.530
> 
> 标签：javascript, jquery

代码：

```
function setMaps() {
    var geocoder = new google.maps.Geocoder();
    var result = "";

    $('.map_canvas').each(function(){

        geocoder.geocode( {
            'address': $(this).attr('address'), 
            'region': 'de'
        }, function(results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                result += results[0].geometry.location.lng()+",";
                result += results[0].geometry.location.lat();
            } else {
                result = "Unable to find address: " + status;
            }
            $(this).gmap({ 'center': result });
        });
    });
} 
```

此方法应在一页上显示多个地图。

HTML：

```
<div class="map_canvas" address="Berlin, Zoo">

</div> 
```

问题是它`$(this).gmap({ 'center': result });`不起作用：

```
Uncaught TypeError: Cannot set property 'position' of undefined 
```

知道如何将 map_canvas 对象传递给回调函数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:14:13.710

试试这个：

```
function setMaps() {
    var geocoder = new google.maps.Geocoder();
    var result = "";

    $('.map_canvas').each(function(){
       var _this = $(this); // <------ here
        geocoder.geocode( {
            'address': $(this).attr('address'), 
            'region': 'de'
        }, function(results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                result += results[0].geometry.location.lng()+",";
                result += results[0].geometry.location.lat();
            } else {
                result = "Unable to find address: " + status;
            }
            _this.gmap({ 'center': result }); // <---- and here
        });
    });
} 
```

# android - 如何移动和更改片段视图大小

> ID：12338583
> 
> 赞同：3
> 
> 时间：2012-09-09T11:11:32.073
> 
> 标签：android, android-layout

我有一个包含两个片段的活动，如下图所示： [状态 A](http://img96.imageshack.us/img96/1083/astatus.png) 片段 B 是一个 ListFragment。当用户单击片段 B 中的一行时。我已显示详细信息。UI 应该是这样的： [状态 B](http://img338.imageshack.us/img338/1984/bstatus.png)

如何移动和调整片段 B 的大小？

我尝试过这种方式，但不知道这是正确的方式还是hacky方式。我为活动设置了这个布局。

```
<LinearLayout
    android:id="@+id/linearLayoutMainPart"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_above="@+id/scrollViewBottomMenu"
    android:layout_toRightOf="@+id/scrollViewLeftMenu"
    android:background="@android:color/white"
    android:orientation="horizontal" >

    <FrameLayout
        android:id="@+id/leftContainer"
        android:layout_width="wrap_content"
        android:layout_height="match_parent" >
    </FrameLayout>

    <FrameLayout
        android:id="@+id/rightContainer"
        android:layout_width="0dip"
        android:layout_height="match_parent">
    </FrameLayout>
</LinearLayout> 
```

我创建了 3 个片段 A、B、C 类。创建活动时，我将两个片段 A、B 添加到 leftContainer 和 rightContainer。（片段A的布局宽度是固定的）。当用户单击片段 B 中的一行时。我将片段 A 替换为片段 B 的另一个实例（具有不同的布局，并使用与旧片段 B 实例相同的数据）。并用片段 C 的实例替换 rightContainer 中的片段 B。

在片段 B 类中。调用 onCreateView 方法时，我有选择布局的标志，例如：

```
if(rightPosition) 
    return B_right_pos_layout;
else
    return B_left_pos_layout; 
```

我想我可以使用 Fragment B 的相同实例。通过这样做：

```
 FragmentB fragmentB = (FragmentB) getSupportFragmentManager().findFragmentByTag(FRAGMENT_B_TAG);
    fragmentB.setRightPos(false);
    FragmentTransaction transaction = getSupportFragmentManager().beginTransaction();
    transaction.replace(rightContainer, fragmentC);
    transaction.replace(leftContainer, fragmentB);
    transaction.commit(); 
```

我认为这种方式更像是一种黑客方式。什么是最好的方法？

# c - c中的二进制到十进制

> ID：12338584
> 
> 赞同：3
> 
> 时间：2012-09-09T11:11:36.970
> 
> 标签：c, binary

我有一个简单的代码来将二进制数转换为十进制数。在我的编译器中，对于小于 1000 的数字，分解工作得很好，超过输出总是相同的 1023。有人知道吗？

```
#include <stdio.h>
#include <stdlib.h>

// how many power of ten is there in a number 
// (I don't use the pow() function to avoid trouble with floating numbers)
int residu(int N)
{
    int i=0;
    while(N>=1){
        N=N/10;
        i++;
    }
    return i;
}

//exponentiating a number a by a number b
int power(int a, int b){
    int i;
    int res=1;
    for (i=0;i<b;i++){res=a*res;}
    return res;
}

//converting a number N
int main()
{
    int i;

    //the number to convert
    int N;
    scanf("%d",&N);

    //the final decimal result
    int res=0;
    //we decompose N by descending powers of 10, and M is the rest
    int M=0;

    for(i=0;i<residu(N);i++){
        // simple loop to look if there is a power of (residu(N)-1-i) in N, 
        // if yes we increment the binary decomposition by 
        // power(2,residu(N)-1-i)
        if(M+ power(10,residu(N)-1-i) <= N)
        {
            M = M+power(10,residu(N)-1-i);
            res=power(2,residu(N)-1-i)+res;
        }
    }
    printf("%d\n",res);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-09T12:15:13.977

是的，试试这个：

```
#include <stdio.h>
int main(void) 
{ 
char bin; int dec = 0;

while (bin != '\n') { 
scanf("%c",&bin); 
if (bin == '1') dec = dec * 2 + 1; 
else if (bin == '0') dec *= 2; } 

printf("%d\n", dec); 

return 0;

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T11:19:24.100

这很可能是因为您使用的`int`是存储二进制数。An`int`不会存储 2^31 以上的数字，即 10 位长，而 1023 是 10 位二进制数字所能得到的最大数字。

将输入数字作为字符串读取，然后处理字符串的每个字符会容易得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T11:42:35.443

经过一些实验，我认为您的程序旨在仅接受由 1 和 0 组成的数字作为基数为 10 的数字（`%d`读取十进制数）。例如，给定输入`10`，它输出`2`；给定`1010`，它输出`10`；给定`10111001`，它输出`185`。

到目前为止，一切都很好。不幸的是，给定`1234`，它输出`15`，这有点出乎意料。

如果您在一台`int`32 位有符号值的机器上运行，那么您不能输入超过 10 位的数字，因为您超出了 32 位的限制`int`（可以处理 ±20 亿，条款）。该`scanf()`函数不能很好地处理溢出。

您可以通过回应您的输入来帮助自己；这是一种标准的调试技术。确保计算机获得了您期望的值。

我不会尝试修复代码，因为我认为您正在以完全错误的方式解决问题。（我什至不确定是否最好将其描述为二进制到十进制，或十进制到二进制，或十进制到二进制到十进制！）您最好将输入读取为（最多 31 个）字符的字符串，然后验证每个都是 0 或 1。假设这是正确的，那么您可以非常直接地处理字符串以生成一个可以格式化`printf()`为小数的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-13T13:33:33.293

```
#include <stdio.h>  //printf
#include <string.h> //strlen
#include <stdint.h> //uintX_t or use int instead - depend on platform.

/* reverse string */
char *strrev(char *str){
    int end = strlen(str)-1;
    int start = 0;

    while( start<end ){
        str[start] ^= str[end];
        str[end]   ^= str[start];
        str[start] ^= str[end];
        ++start;
        --end;
    }
    return str;
}

/* transform binary string to integer */
uint32_t binstr2int(char *bs){
    uint32_t ret = 0;
    uint32_t val = 1;

    while(*bs){
       if (*bs++ == '1') ret = ret + val;
       val = val*2;
    }
    return ret;
}

int main(void){
    char binstr[] = "1010101001010101110100010011111"; //1428875423
    printf("Binary: %s, Int: %d\n", binstr, binstr2int(strrev(binstr)));
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-09T15:56:39.427

左移与乘以 2 相同，效率更高，所以我认为这是一个更像 c 的答案：

```
#include <stdio.h>
#include <stdlib.h>

int bin2int(const char *bin) 
{
    int i, j;
    j = sizeof(int)*8;
    while ( (j--) && ((*bin=='0') || (*bin=='1')) ) {
        i <<= 1;
        if ( *bin=='1' ) i++;
        bin++;
    }
    return i;
}

int main(void) 
{ 
    char* input = NULL;
    size_t size = 0;

    while ( getline(&input, &size, stdin) > 0 ) {
        printf("%i\n", bin2int(input)); 
    }
    free(input);
} 
```

# matlab - MATLAB 上的 LIBSVM 问题

> ID：12338589
> 
> 赞同：1
> 
> 时间：2012-09-09T11:12:19.487
> 
> 标签：matlab, machine-learning, svm, libsvm

我一直在 Windows 和 Linux 上的 Matlab 中使用[LIBSVM ，并得到不同的结果。](http://www.csie.ntu.edu.tw/~cjlin/libsvm/)Linux 版本只是不断地重新启动而不是迭代并且得到非常糟糕的结果。我尝试重新编译并完成了 README 文件中的所有内容，任何想法可能是什么问题？

# java - 如何知道从网格中单击了哪个组件？

> ID：12338591
> 
> 赞同：1
> 
> 时间：2012-09-09T11:12:37.623
> 
> 标签：java, button, grid

我使用二维数组创建了一个包含 10x10 按钮的网格。我试过 x.getSource().getLabel() 但编译器说它们不兼容。我也想获得被点击的特定按钮。

我想获取从我制作的网格中单击的确切按钮并获取其标签。我需要使用什么方法？

```
import javax.swing.JFrame; //imports JFrame library
import javax.swing.JButton; //imports JButton library
import java.awt.GridLayout; //imports GridLayout library
import javax.swing.*;
import java.awt.event.*;
import java.util.*;

public class ButtonGrid extends JFrame implements ActionListener
{
    JFrame frame=new JFrame(); //creates frame
    JButton[][] grid; //names the grid of buttons
    public int x;
    public int y;
    public ButtonGrid(int width, int length)
    { //constructor
        char temp;
        String charput;
        frame.setLayout(new GridLayout(width,length)); //set layout
        grid = new JButton[width][length]; //allocate the size of grid
        for(int y=0; y<length; y++)
        { //start
            for(int x=0; x<width; x++) 
            {
                temp=charRand(); //get random character
                charput = ""+temp; //converts character to string
                grid[x][y]=new JButton(); //creates new button
                frame.add(grid[x][y]); //adds button to grid
                grid[x][y].addActionListener(this);
                grid[x][y].setLabel(charput); //set charput as label
            }
        }
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack(); //sets appropriate size for frame
        frame.setVisible(true); //makes frame visible
    }
    /* generates  randomiz letter for the button of the grid*/
    public char charRand()
    {
        String consonantList = new String("BCDFGHL"); //list 1
        String consonantList2 = new String("MNPRSTWY"); //list 2
        String consonantList3= new String("JQXZVK"); //list 3
        String vowelList = new String("AEIOU"); //list of vowels
        int vowelOrConsonant; //holder of random number 
        int chosen; //selects the chosen random letter
        Random randGen = new Random(); //generates random int value
        char selected; //gets the random letter chosen by variable chosen

        vowelOrConsonant = randGen.nextInt(4);
        if (vowelOrConsonant == 0)
        {
            chosen = randGen.nextInt(5); //list of vowels
            selected = vowelList.charAt(chosen); //selects a char from vowels
        }
        else if(vowelOrConsonant == 1)
        {
            chosen = randGen.nextInt(7); //list 1
            selected = consonantList2.charAt(chosen); //selects a char
        }
        else if(vowelOrConsonant == 2)
        {
            chosen = randGen.nextInt(8); //list 2
            selected = consonantList2.charAt(chosen); //selects a char
        }
        else
        {
            chosen = randGen.nextInt(6); //list 3
            selected = consonantList.charAt(chosen);
        }
        return selected; //returns the random letter
    }

    public static void main(String[] args) 
    {
        new ButtonGrid(10,10);//makes new ButtonGrid with 2 parameters
    }

    public void actionPerformed(ActionEvent x)
    {
        /* i get wrong output on this line. 
         * i want to get the exact button that was clicked and get its label.
         */ 
        if (x.getSource()==grid[x][y])
            JOptionPane.showMessageDialog(null,x.getSource().getLabel);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T11:21:29.997

[`getSource()`](http://docs.oracle.com/javase/7/docs/api/java/util/EventObject.html#getSource%28%29)返回 an `Object`，因此您需要将其转换为`JButton`，如下所示：

```
public void actionPerformed(ActionEvent x) {
    JOptionPane.showMessageDialog(null, ((JButton)x.getSource()).getText());
} 
```

另请注意，`getLabel()`and`setLabel()`已弃用，应替换为`getText()`and `setText()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-25T18:37:49.387

您可以创建一个扩展 Jbutton 的类。并向其中添加两个 int(X & Y) 类型的字段。构造函数将如下所示： public MyButton(int x, y);

当你填充你的网格时，不要直接使用 Jbutton 类。使用您的类并为 X 和 Y 提供您正在使用的周期的两个 i 和 j 参数。现在，当您为按钮使用 Action Listener 时，您可以使用他的 X 和 Y 字段，因为它们代表了它在网格上的位置。希望这可以帮助！它完全对我有用，而且非常简单。

# jquery - 如何知道哪个元素有另一个元素失去焦点？

> ID：12338593
> 
> 赞同：0
> 
> 时间：2012-09-09T11:12:41.637
> 
> 标签：jquery, jquery-ui

```
$('.xys').live('blur', function() {
}); 
```

说我有一个`input textfield`with `class xyz`。这个函数成功地告诉我元素失去了焦点。但是我怎么知道它失去了焦点到哪个元素呢？

进一步解释如果说我单击其他地方或按下`tab`移动到另一个文本字段，我怎么知道它去了哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:16:20.337

您可以使用对象`target`的属性`event`：

```
$(document).on('blur', '.xys', function(event) {
     alert('blur: ' + event.target.id)
     // or alert(event.target.localName)
});

$(document).on('focus', '.xys', function(event) {
     alert('focus: ' + event.target.id)
     // or alert(event.target.tagName)
}); 
```

请注意，`live`不推荐使用方法，您可以使用`on`方法。

# video-streaming - 可以从 RTP 流中提取 profile-level-id 和 sprop-parameter-sets 吗？

> ID：12338594
> 
> 赞同：4
> 
> 时间：2012-09-09T11:13:14.133
> 
> 标签：video-streaming, h.264, rtsp, rtp

我正在尝试将实时视频从我的 android 手机流式传输到我 PC 上的桌面 RTSP 服务器。流式视频可以在另一台设备上播放。我正在使用 H.264 视频编码器，因此服务器返回的 SDP（作为`DESCRIBE`请求的回复）应该包含`profile-level-id`and`sprop-parameter-sets`字段。

Spydroid项目展示了如何通过解析（从块中）从记录到 SD 卡的虚拟文件中提取这些信息[。](http://code.google.com/p/spydroid-ipcamera/)`avcC`但我不能那样做。在 Spydroid 中，媒体记录器和 RTSP 服务器位于同一设备上，因此服务器始终可以在流式传输之前记录具有与记录器相同配置的测试文件。但我将视频作为 RTP 流直接从手机流式传输到远程服务器。

所以我的问题是：

1.  如何将这些值提供给维护协议的服务器？
2.  有没有办法从 RTP 流中找出这两个字段？

**编辑：**

我正在使用 android 手机生成流，但服务器可以从任何来源接收 RTP 流。那么，是否有任何通用的方法来获取这些值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-09T18:51:03.910

您可以`profile-level-id`从序列参数集 NAL 单元中提取 （如果事实上，参数集甚至在流中发送），它是 NAL 标头之后的前 3 个字节。即来自 3.0 级基线配置文件流的 SPS NAL 单元的前四个字节如下所示：

`67` `42` `00` `1E`

忽略第一个字节，这只是表明它是一个 SPS NAL 单元（`0x67 & 0x1F == 0x7`SPS 是 NAL Type 7，PPS 是 NAL Type 8）。其他 3 个字节为您提供配置文件、约束标志和级别（实际上，它只是第 3 个字节中的级别乘以 10）。

`sprop-parameter-sets`是Base64编码的Sequence Parameter Sets和Picture Parameter Sets，用逗号隔开。所以只需 Base64 编码 SPS 和 PPS NAL 单元（Nal 类型 7 和 NAL 类型 8）并用逗号分隔，你应该很高兴。

# android - 限制 Horizo ntalScrollView 的滚动

> ID：12338595
> 
> 赞同：0
> 
> 时间：2012-09-09T11:13:24.990
> 
> 标签：android, horizontalscrollview

我通过参考谷歌上的一些教程使用水平滚动视图实现了画廊。我尝试了带有画廊小部件的画廊，但它在 ics 上崩溃了。所以我选择了水平滚动视图。我成功地实现了它，但我想像我们在画廊中所做的那样，一次将它的滚动限制为 1 个图像。请帮我解决一下这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T10:19:56.093

使用 ViewPager 更容易。我现在找到了。Pager 一次只移动一个项目。我 [在 Android 开发中关注了 View Pager Example](http://www.edumobile.org/android/android-beginner-tutorials/view-pager-example-in-android-development/)

# php - 用 br 错误替换新行

> ID：12338598
> 
> 赞同：0
> 
> 时间：2012-09-09T11:13:49.343
> 
> 标签：php

我正在使用评论框提交评论。用户在输入任何评论并按 Enter 换行时，然后在提交后`$update=mysql_real_escape_string($update);`出于安全目的将其更新到数据库。

但是当显示该评论时，新行被字母“n”替换，整个句子应该是这样的

```
John is awesome
He loves food 
```

就像：

```
John is awesome nHe loves food 
```

我在堆栈中搜索了错误并找到了解决方案：

我`<?php echo $message; ?>`用`<?php echo str_replace('\n',"<br/>", $message); ?>`which 做了这项工作。但是当我尝试发表评论时`'n'`，它可以`\'n\'`解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T11:15:25.190

[`nl2br`](http://php.net/manual/en/function.nl2br.php)会成功的。这是一个内置函数，将使用`<br>`标签添加换行符。

```
echo nl2br($message); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T11:57:25.343

更新：

```
$output = htmlspecialchars($message);
$output = str_replace('\\n','<br/>', $output);
$output = stripslashes($output);
echo $output; 
```

[stripslashes](http://php.net/manual/en/function.stripslashes.php)应该`\'n\'`像许多其他问题一样解决这个问题。

请注意，这些命令的顺序很重要。如果你先去掉斜线，你会弄乱**str_replace**。如果你在**str_replace**之后使用**htmlspecialchars**，它会弄乱你的.**`<br/>`**

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T11:16:30.617

为什么不使用本机`nl2br()`功能？

```
$foo = nl2br("I love\n yo"); 
```

产量`I love<br /> you`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T11:21:38.863

尝试使用 `<?php $var = preg_replace("[\n]","<br/>",$comment); ?>`

例子 ：

```
<?php
$text = "John is awesome
He loves food";
$echo = preg_replace("[\n]","<br/>",$text);
echo $echo;

?> 
```**

# android - android：如何创建带有食谱的列表，打开时会在 textviews 中显示来自 xml 资源文件的字符串？

> ID：12338604
> 
> 赞同：0
> 
> 时间：2012-09-09T11:14:42.480
> 
> 标签：android, xml, listview

我正在尝试为食谱创建一个 android 应用程序。问题是我不知道如何使用单击的内容来搜索 xml 资源文件。顺便说一句，忽略奇怪的语言:)

```
lv.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

                // selected item
                String product = ((TextView) view).getText().toString();
                String sastojci = ***WHAT DO I PUT HERE DO DISPLAY THE INGREDIENTS FROM A XML RESOURCE FILE BASED ON WHAT I CLICKED ( name of the recipe is what is clicked) ?***

                // sad tu stavit nesto da cita xml po string productu.

                Intent i = new Intent(getApplicationContext(), Recept.class);
                i.putExtra("product", product);
                i.putExtra("sastojci", sastojci);
                startActivity(i); 
```

XML 资源文件示例：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string-array name="Naan"> 
       <item>PripremaTežina:Jednostavno
1
Germu zamutiti sa vodom i secerom i ostaviti da nadodje
2
Brasno prosijati, dodati nadoslu germu, jaje , mljieko i so.
Dodavati postepeno toplu vodu dok se ne dobije glatko tijesto ljepljivo za prste.
Ostaviti da nadodje, zatim podijeliti na manje loptice ( meni je izaslo osam).
3
Oblikovati ih i ostaviti da nadodju jos 15-tak minuta.
Razvuci lagano tijesto, oklagijom ili rukama, debljine oko 1 cm.
4
U medjuvremenu zagrijati rernu na visoku temperaturu( ja sam pekla na 550F).
Peci nekoliko minuta i kad porumene okrenuti na drugu stranu i peci par minuta.
(ja sam ih pekla na kamenoj ploci za pizzu, koju sam ugrijala u rerni, a moze i na poledjini tepsije)
5
Peceni naan premazati sa puterom po zelji.</item>

    </string-array>  
        <string-array name="Americano"> 
       <item>PripremaTežina:Jednostavno
1
Germu zamutiti sa vodom i secerom i ostaviti da nadodje
2
Brasno prosijati, dodati nadoslu germu, jaje , mljieko i so.
Dodavati postepeno toplu vodu dok se ne dobije glatko tijesto ljepljivo za prste.
Ostaviti da nadodje, zatim podijeliti na manje loptice ( meni je izaslo osam).
3
Oblikovati ih i ostaviti da nadodju jos 15-tak minuta.
Razvuci lagano tijesto, oklagijom ili rukama, debljine oko 1 cm.
4
U medjuvremenu zagrijati rernu na visoku temperaturu( ja sam pekla na 550F).
Peci nekoliko minuta i kad porumene okrenuti na drugu stranu i peci par minuta.
(ja sam ih pekla na kamenoj ploci za pizzu, koju sam ugrijala u rerni, a moze i na poledjini tepsije)
5
Peceni naan premazati sa puterom po zelji.</item>

    </string-array>  
</resources> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T11:24:26.267

我希望您的 xml 文件位于服务器中，并且您正试图在您的 android 应用程序中显示该 xml 文件。我有几个建议

*   采用`ListView`
*   使用 XML Parser 从服务器解析 xml
*   将结果填充到`ListView`
*   创建另一个`Activity`以显示 xml parent 的子值

看看这个： [http ://www.androidhive.info/2011/11/android-xml-parsing-tutorial/](http://www.androidhive.info/2011/11/android-xml-parsing-tutorial/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T11:25:07.197

[这](http://developer.android.com/guide/topics/resources/string-resource.html)是你需要的。

如果您只有一个项目，为什么要使用“字符串数组”？改用“字符串”。

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="Naan"> 
       PripremaTežina:Jednostavno
1
Germu zamutiti sa vodom i secerom i ostaviti da nadodje
2
Brasno prosijati, dodati nadoslu germu, jaje , mljieko i so.
Dodavati postepeno toplu vodu dok se ne dobije glatko tijesto ljepljivo za prste.
Ostaviti da nadodje, zatim podijeliti na manje loptice ( meni je izaslo osam).
3
Oblikovati ih i ostaviti da nadodju jos 15-tak minuta.
Razvuci lagano tijesto, oklagijom ili rukama, debljine oko 1 cm.
4
U medjuvremenu zagrijati rernu na visoku temperaturu( ja sam pekla na 550F).
Peci nekoliko minuta i kad porumene okrenuti na drugu stranu i peci par minuta.
(ja sam ih pekla na kamenoj ploci za pizzu, koju sam ugrijala u rerni, a moze i na poledjini tepsije)
5
Peceni naan premazati sa puterom po zelji.

    </string>  
        <string name="Americano"> 
       PripremaTežina:Jednostavno
1
Germu zamutiti sa vodom i secerom i ostaviti da nadodje
2
Brasno prosijati, dodati nadoslu germu, jaje , mljieko i so.
Dodavati postepeno toplu vodu dok se ne dobije glatko tijesto ljepljivo za prste.
Ostaviti da nadodje, zatim podijeliti na manje loptice ( meni je izaslo osam).
3
Oblikovati ih i ostaviti da nadodju jos 15-tak minuta.
Razvuci lagano tijesto, oklagijom ili rukama, debljine oko 1 cm.
4
U medjuvremenu zagrijati rernu na visoku temperaturu( ja sam pekla na 550F).
Peci nekoliko minuta i kad porumene okrenuti na drugu stranu i peci par minuta.
(ja sam ih pekla na kamenoj ploci za pizzu, koju sam ugrijala u rerni, a moze i na poledjini tepsije)
5
Peceni naan premazati sa puterom po zelji.

    </string>  
</resources> 
```

然后，只需执行以下操作：

```
String sastojci = "";
if(product.equals("Naan"))
    sastojci = getString(R.string.naan);
... 
```

# java - 将 Cargo 启动/停止目标绑定到 Maven 集成测试阶段时使用 tomcat7x

> ID：12338607
> 
> 赞同：2
> 
> 时间：2012-09-09T11:15:25.627
> 
> 标签：java, tomcat, maven, pom.xml, cargo

我已在 pom.xml 中成功配置 Cargo 以在执行“mvn cargo:run”命令时启动 tomcat7x。这是我使用的 Cargo 插件配置：

```
<plugin>
    <groupId>org.codehaus.cargo</groupId>
    <artifactId>cargo-maven2-plugin</artifactId>
    <version>1.2.3</version>
    <configuration>
        <containerId>tomcat7x</containerId>
        <containerUrl>http://archive.apache.org/dist/tomcat/tomcat-7/v7.0.30/bin/apache-tomcat-7.0.30.zip</containerUrl>
    </configuration>
</plugin> 
```

这很好，效果很好。但是，我现在想将 Cargo 启动和停止目标绑定到 maven 预集成测试和集成测试后阶段。我使用与上面相同的配置，但也向插件添加执行，如下所示：

```
<plugin>
    <groupId>org.codehaus.cargo</groupId>
    <artifactId>cargo-maven2-plugin</artifactId>
    <version>1.2.3</version>
    <configuration>
        <containerId>tomcat7x</containerId>
        <containerUrl>http://archive.apache.org/dist/tomcat/tomcat-7/v7.0.30/bin/apache-tomcat-7.0.30.zip</containerUrl>
    </configuration>
    <executions>
        <execution>
            <id>start-container</id>
            <phase>pre-integration-test</phase>
            <goals>
                <goal>start</goal>
            </goals>
        </execution>
        <execution>
             <id>stop-container</id>
             <phase>post-integration-test</phase>
             <goals>
                 <goal>stop</goal>
             </goals>
        </execution>
    </executions>
</plugin> 
```

这也很好地工作，在预集成测试中启动容器，执行我的集成测试，然后在后集成测试阶段停止容器。唯一的问题是它不是我配置的 tomcat7x 容器，它启动了默认的 Jetty 容器并且似乎忽略了我的 tomcat7x 配置。

如何让这些执行与我配置的 tomcat7x 容器一起工作？

谢谢。

# html - 可能有基于 % 的元素大小，但有最大的 PX 宽度它将转到？

> ID：12338609
> 
> 赞同：0
> 
> 时间：2012-09-09T11:15:48.280
> 
> 标签：html, css

我正在设计一个移动网站，我希望我使用的图像是流畅的，以匹配个人的浏览器大小。但是，我不希望有人以巨大的浏览器分辨率或刚从我的下一个媒体查询中出现的东西来到该网站并让它看起来很糟糕。所以我想知道图像是否可以有最大宽度？例如，如果我将图像设置为 90% 的宽度，但它可以说是这样的，但是，它最多只能是 500px 长，之后它只会说 500px 长。（我也想用其他元素来做这个，比如 div 包装器）

此外，使用 % 时，图像是否保持相同的纵横比？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:23:18.613

的正确行为`max-width`应该覆盖图像的`width`. 像这样：

```
img {
    width: 90%;
    max-width: 500px;
} 
```

MDN 页面：[https ://developer.mozilla.org/en-US/docs/CSS/max-width#Notes](https://developer.mozilla.org/en-US/docs/CSS/max-width#Notes)

# html - CSS：一个带有悬挂缩进和隐藏溢出的元素，不会切断它？

> ID：12338610
> 
> 赞同：4
> 
> 时间：2012-09-09T11:16:04.567
> 
> 标签：html, css

我想知道如何制作一个带有[悬挂缩进](http://www.computerhope.com/jargon/h/hanginde.htm)的元素，以及一个不隐藏所述缩进的隐藏溢出。

这说明了我的问题：http: [//jsfiddle.net/Skofo/qgd2p/](http://jsfiddle.net/Skofo/qgd2p/)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:53:27.570

请看这个小提琴：http: [//jsfiddle.net/saSna/](http://jsfiddle.net/saSna/)

这是你想要达到的结果吗？

我已将 15px 填充添加到`li`，然后将其删除`:first-child`，因此两者`ul`具有相同的样式：

```
ul li {
    width:120px;
    text-indent:-15px;
    margin-left:15px;
    margin-bottom:10px;
    padding-left:15px;
}

ul li {
    overflow:hidden;
    text-overflow:ellipsis;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T11:33:59.960

根据您的小提琴，在您的元素上交换`margin-left: 15px;`for 。`padding-left: 15px;``li`

请注意，我只在 chrome 中检查过这个。您可能必须设置`box-sizing`一些一致的东西才能使其跨浏览器工作，例如`box-sizing: border-box;`

# c# - 使用 CQL 3 创建复合列（不是键）

> ID：12338616
> 
> 赞同：3
> 
> 时间：2012-09-09T11:16:57.997
> 
> 标签：c#, cassandra, composite, cql

[本文](https://issues.apache.org/jira/browse/CASSANDRA-2474)讨论了 CQL 3 可用于在 Cassandra 1.1 中创建复合列的可能方式。它们只是想法。没有什么是官方的，Datastax 文档也没有涵盖这一点（只有复合键）。

据我了解，复合列是许多列一起只有一个值。

您如何使用 CQL 创建它们？

**编辑**

我将使用 C# 连接到 Cassandra。CQL 看起来使用起来很简单，这就是我想使用它的原因。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T05:41:11.153

我想你有几个概念混淆了。这很可能是 Datastax 文档的错误；如果您有任何好的建议可以在您获得更好的图片后使其更清晰，我很乐意将它们发送出去。

Datastax 文档中的“复合键”*实际上*是在谈论复合 Cassandra 列。造成混淆的原因是 CQL 3 中的行不直接映射到存储引擎行（使用 thrift 接口时使用的内容）。CQL表上下文中的“复合键”只是指由多个列组成的主键，由存储层*的复合列实现。*

[本文](http://www.datastax.com/dev/blog/schema-in-cassandra-1-1)是关于映射如何发生以及为什么 CQL 模型通常更容易思考的更好解释之一。

通过这种使用，第一个 CQL 列成为存储引擎分区键。

从 Cassandra 1.2（开发中）开始，还可以使用 CQL 创建复合存储引擎键，方法是在将存储在分区键中的 CQL 列周围的 PRIMARY KEY 定义中放置额外的括号（请参阅[CASSANDRA-4179](https://issues.apache.org/jira/browse/CASSANDRA-4179)），但是这可能是例外，而不是规则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T15:23:53.190

使用 Cassandra，您可以将数据存储在行中。每行都有一个行键和一些列。每列都有一个名称和一个值。通常，列名和值（以及行键）是单个值（int、long、UTF8 等），但您可以在行键、列名和列值中使用复合值。复合值只是一些以某种方式序列化在一起的值。

随着时间的推移，已经开发了许多特定于语言的 API。这些 API 从我上面描述的理解开始，并相应地提供对列族的访问。Hector，Java 客户端 API，是我最熟悉的，但还有其他的。

引入 CQL 是作为一种以 SQL/JDBC 方式使用 Cassandra 表的方法。起初，并非所有 Cassandra 功能都通过 CQL 得到支持，尽管随着时间的推移 CQL 变得越来越实用。

我不怀疑您需要复合列名称和值（我相信这就是您的要求）。问题是 CQL 尚未发展（据我了解）到该级别的本机支持。我不知道它是否会发生。

我建议您完成所需列族模式的定义，并在必要时使用复合值。完成此操作后，请查看可用于访问 Cassandra 列族的各种 API，并选择最能支持所需架构的 API。

你还没有说你使用的是什么语言。如果您使用 Java 进行编码，那么我会推荐 Hector 而不是 CQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T13:53:00.910

您确定要使用 CQL 创建它们吗？你的用例是什么？

# c - Bit-Size 结构域

> ID：12338617
> 
> 赞同：0
> 
> 时间：2012-09-09T11:17:01.587
> 
> 标签：c

我有两个问题：

这段代码：

```
 struct employee
   {
      char name[20];
      int married :1;
   }; 
```

结婚的记忆有多少？

如果我有多个位大小的字段，将它们放在同一个变量中以保持它们独立是否很好？

喜欢：

```
struct employee
{
 char name[31];
 int married :1;
 int manager :2;
 int children :4;
}; 
```

或者

```
struct employee
{
 char name[31];
 int flage; /* one bit for married, one for manager, and 4 bits for children */
}; 
```

哪一个在内存使用方面更好，为什么？？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T11:24:11.253

> 结婚的记忆有多少？

`int : 1`占用存储单元中的一位内存`sizeof(int)`。注意，因为`int`是有符号的并且位域只有一位，所以这样的位域只能取两个值：-1 和 0。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T11:20:26.910

这取决于编译器，可能还取决于您在构建时为编译器提供的选项。

紧密地打包字段可能会降低访问性能，同时提高存储效率，这就是为什么如果您告诉编译器优化速度，它可能会改变。

位域在内存中占用的位永远不能少于`CHAR_BITS`位，因为否则每个`struct`实例的起始地址不会落在一个确切的`char`地址上，这是它必须做的。

所以第一个例子：

```
struct employee
{
    char name[20];
    int married :1;
}; 
```

可能意味着`sizeof (struct employee)`占用 24 个字节，假设`sizeof (int)`在您的系统上是 4 个字节。这意味着如果您在 之后添加更多位域成员`married`，则在您添加 31 位字段之前，大小不会改变。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-09T12:25:31.907

当您`int flage`用于存储有关已婚经理和孩子的信息时，一个对象可能**需要 2 个字节的内存**，并且每次您必须**访问**特定信息时，您都必须对变量**执行按位运算。**`flage`因此这将需要一些处理。

通过使用位域，比如`int married:1;`（你最好使用`unsigned int`），这意味着它可能只占用**1 字节的内存**，因此你可以节省内存（假设你的结构没有被填充）。作为奖励，您可以**直接访问它的位**。

所以它应该是关于内存和处理的更好方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-09T11:34:59.170

选择最容易阅读、最准确地捕捉编码意图的那个。这种微优化谈话完全不合适。如果您处于性能关键的内-内-循环中，这可能会变得很重要，但是其他技术会影响您的算法、CPU 的缓存性能、循环展开、循环流水线等。

只是为了重新迭代：要阅读您的代码的人的代码。

您甚至可能想考虑以下内容：

```
struct employee
{
    char name[31];
    bool married;
    enum manager_t manager;
    ...
}; 
```

如果您尝试将 a `bool`（比如说）分配给`employee::manager`.

# php - 使用FB连接时如何制作唯一的用户名

> ID：12338618
> 
> 赞同：0
> 
> 时间：2012-09-09T11:17:08.527
> 
> 标签：php, facebook

大家好，我想确保用户名是唯一的！

首先我得到用户名并检查是否已经存在。如果不将它们添加到数据库中，但如果使用用户名，我将在其后面添加数字。

例子：`JoshSmith, JoshSmith1`

如果没有用户名，用户仍然使用该`id`版本。我会到达那里的名字和姓氏。然后重复上述步骤。

问题：如果`JoshSmith`被占用，我会在它后面添加数字，但如果`JoshSmith1`也被占用。

如果我使用

```
SELECT count(*) FROM users WHERE username LIKE '%JoshSmith%' 
```

它会返回类似的名称`JoshSmithing`，这是错误的。如果我使用

```
MATCH () AGAINST () 
```

返回相同的结果。

首先我想计算用户名存在多少次并添加数字+1

```
JoshSmith14 
```

但这将是错误的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T12:49:41.220

您可以使用[正则表达式](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)过滤 JoshSmith[numbers] 并找到最大的数字。但是，就我而言，这是一种不好的方式，因为您的数据库服务器将有很多负载。我认为将计数存储在某个表中会更好（特别是如果正确的数字对您很重要）。

# javascript - Javascript：DLNA 客户端

> ID：12338619
> 
> 赞同：6
> 
> 时间：2012-09-09T11:17:16.563
> 
> 标签：javascript, video, upnp, dlna

我打算用javascript编写一个DLNA（upnp）客户端。我想首先知道这是否可能。

如果是，那么我可以从哪里开始？我需要知道什么才能开始？任何文档和教程的链接都将受到高度赞赏。我试过谷歌搜索，但没有找到太多有用的内容。

我只需要一个正确方向的刺激。

谢谢！:)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-10T08:09:59.453

最好的起点是来自 UPnP 论坛的[文档包中的 UPnP 设备架构文档。](http://upnp.org/resources/upnpresources.zip)这将协议拆分为多个区域：

*   发现。这需要能够发送多播 UDP 数据包和接收单播 UDP。您*无法*从 JavaScript 执行此操作，因此如果您想搜索网络并提供控制在其上找到的任何设备，则需要本机帮助应用程序来覆盖这部分。或者，如果您以某种方式已经知道目标设备的地址，则可以跳过此部分。
*   描述。给定一个设备地址，获取（http 获取）其功能的 xml 概览。您可以通过 JavaScript 轻松完成此操作。
*   控制。指示给定设备执行给定动作。使用http post和soap实现。您可以通过 JavaScript 轻松完成此操作。
*   赛事。通知设备状态变化的机制。要求您运行 tcp 服务器，因此*无法*通过 JavaScript 完成。幸运的是，这通常是可选的，因为大多数设备服务被设计为允许客户端轮询状态获取器作为事件处理的替代方案。因此，您可以从 JavaScript 中执行此操作，尽管您的应用程序的效率将低于原生应用程序。
*   介绍。一些设备提供允许他们控制的网络应用程序。这是托管在浏览器中的，因此将使用 JavaScript，并且是一个很好的例子，说明您想要编写的那种控制应用程序是可能的。

总而言之，JavaScript UPnP 客户端只有在您可以使用本机代码来处理设备发现时才有可能。如果您决定尝试这一点，则存在开源 UPnP 堆栈来为您处理大部分发现工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-07-16T21:44:41.127

看看 Plug.Play.js - 一个 JavaScript API，用于与通过 W3C 网络服务发现 API 获得的通用即插即用 (UPnP) 服务进行通信

[https://github.com/rexboy7/plug.play.js](https://github.com/rexboy7/plug.play.js)

和 ssdp.js - (Simple Service Discovery Protocol) 基于 W3C Raw Socket API 的网络服务发现 API 实现

[https://github.com/schien/ssdp.js](https://github.com/schien/ssdp.js)

这是使用上述内容的 DLNA 客户端的示例实现：[https ://github.com/mozilla-b2g/gaia/tree/master/tv_apps/dlna-player](https://github.com/mozilla-b2g/gaia/tree/master/tv_apps/dlna-player)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-02T01:00:42.833

编辑：基于火狐操作系统。

环顾这个主题并根据 André Fiedler 的回答，我发现他发布的库位于[MDN webarchive](https://web.archive.org/web/20160528173706/https://developer.mozilla.org/en-US/docs/Mozilla/B2G_OS/API/UDPSocket)上`UDPSocket`。

在主页中，您可以看到发现示例：

```
var SSDP_PORT = 1900;
var SSDP_ADDRESS = "239.255.255.250";
var SSDP_DISCOVER_MX = 2;
var SEARCH_TARGET = "urn:schemas-upnp-org:service:ContentDirectory:1";

var SSDP_DISCOVER_PACKET =
    "M-SEARCH * HTTP/1.1\r\n" +
    "HOST: " + SSDP_ADDRESS + ":" + SSDP_PORT + "\r\n" +
    "MAN: \"ssdp:discover\"\r\n" +
    "MX: " + SSDP_DISCOVER_MX + "\r\n" +
    "ST: " + SEARCH_TARGET + "\r\n" +
    "\r\n";

var searchSocket = new UDPSocket({
    loopback: true
});

searchSocket.joinMulticastGroup(SSDP_ADDRESS);

searchSocket.onmessage = function (e) {

    var msg = String.fromCharCode.apply(null, new Uint8Array(e.data));

    console.log(msg);
};

searchSocket.opened.then(function() {

    searchSocket.send(SSDP_DISCOVER_PACKET, SSDP_ADDRESS, SSDP_PORT);

    setTimeout(function () { searchSocket.close(); }, SSDP_DISCOVER_MX * 1000);
}); 
```

# linux - 没有脉冲音频的 A2DP 接收器

> ID：12338621
> 
> 赞同：12
> 
> 时间：2012-09-09T11:17:32.120
> 
> 标签：linux, bluetooth, alsa, a2dp

所以我试图让我的 linux 服务器使用蓝牙播放从我的 Android 手机发送的音乐（linux 机器是 A2DP 接收器，手机是源）。到目前为止，我所做的是：

*   安装 bluez 并启用 audiosource/audiosink
*   配对电话和服务器
*   从手机连接到服务器（手机说它正在通过蓝牙传输音频）

但我什么也听不见。此外，互联网上的大多数指南都假设使用 Pulseaudio，我更喜欢使用 ALSA。

我目前在 /etc/asound.conf 中有以下内容：

```
pcm.!default{
    type bluetooth
    profile "auto"
} 
```

我正在运行 Bluez v4.99 和 Alsa v1.0.25。有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-03-24T09:15:37.573

*我知道这是一篇旧帖子，但希望答案对目前从事此工作的人有用。*

您可以使用 /etc/bluetooth/audio.conf，这是系统范围的文件，或 ~/.asoundrc，这是您的本地文件。两者都由 BlueZ/ALSA 读取。但是，我认为您需要在配置文件 zB 中包含 MAC 地址：

```
pcm.btheadset {
    type bluetooth
    device "XX:XX:XX:XX:XX:XX" #MAC address
    profile "auto"
} 
```

我为此找到的最佳资源是：

1) James B 的博文：[Bluez 一定是 Linux 中保存最完好的秘密之一](http://www.lightofdawn.org/blog/?viewDetailed=00031)
*他解释了 BlueZ 和 ALSA 之间的结构和接口，这是我在 Internet 上其他任何地方都找不到的。*

2）他的第二篇代码：[Bluez A2DP AudioSink for ALSA](http://www.lightofdawn.org/blog/?viewDetailed=00032)

3) ALSA 站点，它介绍了 pcm 插件的结构，但并没有很好地解释它们。

4) 一些 ALSA 插件教程：[ALSA wiki](http://alsa.opensrc.org/Asoundrc)

一些有用的命令：

```
$sudo service bluetooth restart
$sudo alsa force-reload 
```

在更改 asoundrc 或 audio.conf 文件后运行这些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-10T20:36:25.930

在这里您可以找到**使用 ALSA 或 Pulseaudio 配置蓝牙的手册**：

-在 Linux Mint 17.3 Mate，64 位/Ubuntu 14.04 Mate，64 位上测试-

**如何在没有 PA 的情况下使 ALSA 和蓝牙一起工作**

这部分适用于没有 Pulseaudio 的纯 ALSA 系统，例如 KXStudio、QStudio64、Tango studio..！

确保已卸载 Pulseaudio，并且您的声卡已在 ALSA 中正确配置！

*   删除 /home/USERNAME/.config/pulse 中的脉冲音频 cookie 和文件

    1.  修改你的**bluetooth-audio.conf**：输入：

    gksudo puma /etc/bluetooth/audio.conf

    放

    ```
    # This section contains options which are not specific to any
    # particular interface 
    ```

    [常规] Enable=Socket

保存文件。

2.  设置**~/.asoundrc**文件类型：

> 须藤 hcitool 扫描

正在扫描... XX:XX:XX:XX:XX:XX 立体声耳机

在您的主文件夹中创建一个名为 .asoundrc 的隐藏文件！并写入：

```
 pcm.!default {
        type plug
        slave.pcm {
             type bluetooth
             device "XX:XX:XX:XX:XX:XX"
             profile "auto"

        }
} 
```

将“XX:XX..”替换为您设备的地址。

保存文件！

更改 asoundrc 或 audio.conf 文件后运行这些：

```
sudo service bluetooth restart
sudo alsa force-reload 
```

或重新启动您的计算机！—————————————————————————————————————————————

转到任务栏上的**blueman-applet**，搜索并设置您的新设备！注意：某些蓝牙设备默认需要密码（例如 0000）

*   而其他一些则采用随机配对。让您找到并配对的设备保持“信任”！

通过**A2DP**将您的设备连接为音频！

———————————————————————————————————————</p>

如果您的设备与您的系统连接，您可以通过蓝牙使用 totem (gui)、vlc (gui+终端)、mplayer (终端)、qmmp (gui)、banshee 和浏览器播放声音，同时将播放器中的输出设置为“默认” ！

———————————————————————————————————————</p>

**将主文件夹中的 .ASOUNDRC 重命名为“.ASOUNDRC_OFF”，以在不使用蓝牙的情况下获取旧系统设置！**

输入：`mv /home/USERNAME/.asoundrc /home/USERNAME/.asoundrcOFF` -> 禁用蓝牙特定的 asoundrc

输入：`mv /home/USERNAME/.asoundrcOFF /home/USERNAME/.asoundrc` -> 启用它！

**替代方案**：

在您的主文件夹中使用 .asoundrc 制作两个“脚本”来激活/停用蓝牙：

创建一个空文件并写入/粘贴：

```
#!/bin/bash
mv /home/USERNAME/.asoundrc /home/USERNAME/.asoundrcOFF
or:
#!/bin/bash
cd /home/USERNAME/
mv .asoundrc .asoundrcOFF 
```

要再次为蓝牙激活 .asoundrc，请使用以下条目创建另一个文件：

```
#!/bin/bash
mv /home/USERNAME/.asoundrcOFF /home/USERNAME/.asoundrc 
```

或者：

```
#!/bin/bash
cd /home/USERNAME/
mv .asoundrcOFF .asoundrc 
```

使文件可执行并使用“用终端打开”运行它们！现在你有两个“按钮”来打开或关闭蓝牙声音。

给他们单独的图标：;-)

———————————————————————————————————————-

**球员**

——————</p>

推荐使用totem、Qmmp 或Banshee-player——因为没有什么比玩和听更多的了！图腾播放器也显示视频。

VLC 播放器需要“默认”声音驱动才能使蓝牙正常工作！

签入：/home/USERNAME/.config/vlc/vlcrc

>>line1666<< 中的 alsa-audio-device 是：

```
# ALSA Device Name (string)
alsa-audio-device=default 
```

使用此命令通过终端使用播放器：要播放音乐，请键入：

**播放器**

———––</p>

```
mplayer /home/USERNAME/Musik/1.mp3 
```

如果您听不到声音或出现错误，请尝试：

```
mplayer -ao alsa:device=default /home/USERNAME/Musik/1.mp3 
```

**VLC-播放器**

—————-

```
cvlc /home/USERNAME/Musik/1.mp3
vlc /home/USERNAME/Musik/1.mp3
rvlc /home/USERNAME/Musik/1.mp3
To add whole directories type:
rvlc add /home/USERNAME/Musik/ 
```

类型：开始/停止/下一步...导航！

或使用 vlc-gui。

————————————————————————————————————————————

要使用带有图形界面的**mplayer**，您必须安装 gui-package: 输入：

```
sudo apt-get install mplayer-gui 
```

通过 Ctrl-Alt-T 打开终端并使用以下命令。使用这些行并一一键入/复制以避免混淆（！）：

```
cd /usr/share/mplayer/skins/default

for FILE in *.png; do sudo convert “$FILE” -define png:format=png24 “$FILE”; done

cd /usr/share/mplayer/skins; sudo rm default; sudo ln -s Blue default 
```

————————————————————————————————————————</p>

现在您可以启动 mplayer-gui 而不会出错！

如果您更喜欢终端类型：

```
gmplayer /home/USERNAME/Musik/1.mp3 
```

或者

```
gmplayer -ao alsa:device=default /home/USERNAME/Musik/1.mp3
if you have problems! 
```

没有 gui 的终端命令：

```
mplayer /DIRECTION/TO/FILE 
```

可用的输出模块和驱动器：

```
mplayer -vo help 
```

——————————————————————————

**带 PULSEAUDIO 的蓝牙**

———————————————————--------

**对于带有 pulseaudio 的 Linux 系统：**

(1.) 编辑 /etc/bluetooth/audio.conf 并取消注释以下行：

```
AutoConnect=true 
```

2.  运行以下命令为 blueman 和相关模块安装最新的软件包：

    sudo add-apt-repository ppa:blueman/ppa

    sudo apt-get 更新

    sudo apt-get upgrade blueman 在此处输入代码

(3.) 检查 /etc/pulse/default.pa 中是否添加了以下行：

```
.ifexists module-bluetooth-discover.so
load-module module-bluetooth-discover
.endif 
```

如果没有，请添加行。

重启！

4.  运行新的**blueman-applet**。

右键单击面板小程序并打开蓝牙。你的蓝牙设备的旧配置仍然存在，删除它。右键单击 blueman-panel 小程序并选择设置新设备。完成您设备的向导。（如果您在“配对”时遇到问题，请重新启动系统并跳过此步骤！）

现在你得到一个连接的蓝牙设备！

要通过它发送/收听音频，只需按照以下两个步骤操作：

*   在任务栏中右键单击打开**Mate-volume control-settings（或 pavucontrol）**，浏览至“硬件” - 并使用下拉菜单“关闭”所有其他声卡的内置音频配置文件</p>

*   以便蓝牙设备激活！

*   使用其他下拉菜单将蓝牙设备设置为使用**A2DP**

现在启动totem-player或vlc（带有pulseaudio-output）将音频发送到蓝牙！

享受你的声音！;-)

**WLAN问题**：

————————— 如果您在连接到蓝牙设备后看到 WiFi 连接断开，请运行以下命令：

```
$ echo “options iwlwifi 11n_disable=1 bt_coex_active=0 power_save=0 auto_agg=0 swcrypto=1” |
sudo tee -a /etc/modprobe.d/iwlwifi.conf > /dev/null 
```

* * *

chalee 为 LM 17.3 (Rosa) MATE 和 Ubuntu 14.04 测试了 2017 年：

[http://mayastudio.tumblr.com/bluetooth](http://mayastudio.tumblr.com/bluetooth)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T15:03:30.300

我的猜测是您的音频路径没有将蓝牙路由到您的扬声器。我已经看到了类似的问题，这是通过从以下链接手动执行步骤 5“将 PulseAudio 蓝牙源连接到 PulseAudio ALSA 接收器”修复的：http: [//jprvita.wordpress.com/2009/12/15/1-2-3- 4-a2dp-流/](http://jprvita.wordpress.com/2009/12/15/1-2-3-4-a2dp-stream/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-07-16T23:47:53.610

我只是尝试做同样的事情，我使用的是 Fedora 19，所以你的里程数会有所不同。这些是我采取的步骤。

1.  使计算机可被发现
2.  将手机与电脑配对（旁边有耳机标志）
3.  在我的 HTC 手机上，我在配对时点击了“连接”
4.  进入 gnome3 的声音设置
5.  转到输入选项卡
6.  为您的手机选择蓝牙项目
7.  可能调音量...

# c++ - 使用 C++ 的 VS2012 中的奇怪智能感知行为。忽略#include？

> ID：12338622
> 
> 赞同：1
> 
> 时间：2012-09-09T11:17:32.660
> 
> 标签：c++, visual-studio-2010, intellisense

我有一个定义如下的标题

## 标题

```
#pragma once

#include <map>      
#include <string>
#include "gl\glew.h"
#include "glm\glm\glm.hpp"

class TextureAtlas
{
public:
    TextureAtlas(std::string fileName);
    ~TextureAtlas(void);

    // Returns the index of a sprite from its name
    //int getIndex(std::string name);

    // Returns the source rectangle for a sprite
    glm::vec4 getSourceRectangle(std::string name);

    // Returns the OpenGL texture reference
    GLuint getTexture();

    float getTextureHeight();
    float getTextureWidth();

private:
    float m_height;

    // Holds the sprite name and its index in the texture atlas
    //std::map<std::string, int> m_indices;

    // Holds the source rectangle for each sprite in the texture atlas
    std::map<std::string, glm::vec4> m_sourceRectangles;

    // The texture containing all of the sprite images
    GLuint m_texture;

    float m_width;
}; 
```

我在关联源的以下构造函数中遇到错误

## 资源

```
#include "TextureAtlas.h"
#include "Content\Protobuf\TextureAtlasSettings.pb.h"
#include <iostream> 
#include <fstream>                                      // ifstream

#define LOCAL_FILE_DIR "Content\\"

TextureAtlas::TextureAtlas(std::string fileName)
{
    TextureAtlasSettings::TextureAtlasEntries settings;

    std::string filePath(LOCAL_FILE_DIR);
    filePath.append(fileName);

    ifstream file(filePath, ios::in | ios::binary);     // ERROR!

    if (file.is_open())
    {
        if (!settings.ParseFromIstream(&file)) 
        {
            printf("Failed to parse TextureAtlasEntry");
        }
    }

    int numEntries = settings.entries().size();

    for (int i = 0; i < numEntries; i++)
    {
        m_sourceRectangles[settings.entries(i).name()] = glm::vec4(
            settings.entries(i).x(),
            settings.entries(i).y(),
            settings.entries(i).height(),
            settings.entries(i).width()
            );
    }
}

TextureAtlas::~TextureAtlas(void)
{
} 
```

问题是

*IntelliSense：标识符“ifstream”未定义*

如果我将 std:: 放在它前面（std::ifstream），那么这会消除上面的错误，但会导致以下错误

*错误 C2653：“ios”：不是类或命名空间名称*

到底是怎么回事？这没有任何意义，因为我认为我已经包含了我需要的一切？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:26:42.933

在您发布的代码中，您*必须*在类型前面加上命名空间名称，即`std::ifstream`和`std::ios`.

# joomla - 流行的文章模块的工作情况如何？

> ID：12338625
> 
> 赞同：0
> 
> 时间：2012-09-09T11:18:20.137
> 
> 标签：joomla, module

`/modules/mod_articles_popular/tmpl/default.php`

有人可以解释一下，这是如何工作的吗？我不明白这些`$item->link`并`$item->title`得到正确的信息？MySQL查询在哪里？是全局变量吗？如果是，它们在哪里被描述？

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T11:49:09.967

因此，像大多数模块一样`/tmpl/default.php`，模块入口点文件的最后一行包含，即`mod_articles_popular.php`

在该文件`helper.php`中首先包含

```
$list = modArticlesPopularHelper::getList($params); 
```

如您所见，这调用了`getList()`辅助类的方法，该方法执行检索`$list`文章的任务。

它 ( `modArticlesPopularHelper`) 依次加载`ContentModel`并设置`$model`基于默认应用程序参数和模块设置的状态。

它向模型询问该行所需的实际项目`$items = $model->getItems()`。

之后，它遍历模型返回的项目，并在`link`将每篇文章返回到模块之前为每篇文章创建一个值。

结果是填充了在文件循环中`$list`单独拉出的每个文章项目。`foreach``/tmpl/default.php`

# jquery - 我想同时延迟下拉隐藏和动画

> ID：12338626
> 
> 赞同：1
> 
> 时间：2012-09-09T11:18:24.920
> 
> 标签：jquery

这是代码，当将鼠标悬停在`li`项目上时，选项卡会动画并增长以`270px`同时打开`div`包含输入字段的相同宽度的下拉列表，但是当我将鼠标移出`dropdown`div 或尝试从选项列表中选择某些内容时，下拉列表关闭，我想要一些延迟或其他解决方案来解决这个问题

```
$(function() {
            /**
             * the menu
             */
            var $menu = $('#ldd_menu');

            /**
             * for each list element,
             * we show the submenu when hovering and
             * expand the span element (title) to 270px
             */
            $menu.children('li').each(function(){
                var $this = $(this);
                var $span = $this.children('span');
                $span.data('width',$span.width());

                $this.bind('mouseenter',function(){
                    $menu.find('.ldd_submenu').stop(true,true).hide();
                    $span.stop().animate({'width':'270px'},300,function(){
                        $this.find('.ldd_submenu').slideDown(300);
                    });
                }).bind('mouseleave',function(){
                    $this.find('.ldd_submenu').stop(true,true).hide();

                    $span.stop().animate({'width':$span.data('width')+'px'},300);
                });
            });
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T11:29:47.863

在 jQuery 中不完全确定，但是在直接的 javascript 中单击该项目会使其获得焦点，并且焦点会一直保留，直到您单击其他地方，所以您要做的是测试是否失去焦点（我猜 mouseenter/mouseleave 检查是否鼠标悬停在项目上）。

计时器并不是真正解决这个问题的方法，因为不同的人可能会比其他人更长时间地思考菜单上的选项，而您希望让他们自由地这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T11:31:06.057

尝试添加`delay()`：

```
....bind('mouseleave',function(){
         $this.find('.ldd_submenu').delay(300).stop(true,true).hide();
         $span.delay(300).stop().animate({'width':$span.data('width')+'px'},300);
       }); 
```

# perl - 将第一个文件的标题添加到 Perl 中的所有其他拆分文件

> ID：12338630
> 
> 赞同：1
> 
> 时间：2012-09-09T11:19:31.617
> 
> 标签：perl

我需要将第一个主文件的标题添加到所有拆分文件中。即我能够获取第一个拆分文件的标题，但我需要所有拆分文件的标题，这里我正在拆分 DAT 文件。以下是我这样做的目的：

```
#!usr/bin/perl -w

my $chunksize  = 25000000; # 25MB
my $filenumber = 0;
my $infile     = "Test.dat";
my $outsize    = 0;
my $eof        = 0;

my $line = $_;

open INFILE, $infile;
open OUTFILE, ">outfile_".$filenumber.".dat";

while (<INFILE>) {
    chomp;

    if ($outsize > $chunksize) {

        close OUTFILE; 
        $outsize = 0;
        $filenumber++;

        open (OUTFILE, ">outfile_".$filenumber.".dat")
            or die "Can't open outfile_".$filenumber.".dat";

    }

    print OUTFILE "$_\n";
    $outsize += length;
}
close INFILE; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T12:31:26.857

*   您应该*始终* `use warnings`（优先于命令行`-w`）和 `use strict`. 这样，您可能会忽略的许多简单错误将被标记

*   `open`使用带有词法文件句柄的三参数形式

*   检查*所有*打开调用的结果并标记包含字符串`$!`中的值的错误`die`

*   使用pragma 父亲定义*常*量值，而不是作为 Perl 变量`use constant`

*   可以使用该`tell`函数评估打印到文件句柄的字节数，因此无需保留自己的计数

为了解决您的特定问题，您应该阅读并记住输入文件的第一行，并在每次打开新输出文件时将其打印到新的输出文件中

`open`如果您在有新数据要写入且没有打开文件时跟踪输出文件，以及`close`当它们已满或已到达输入数据的末尾时，跟踪输出文件会更容易

该程序演示了这些想法并执行了所需的操作

```
use strict;
use warnings;

use constant INFILE    => 'Test.dat';
use constant CHUNKSIZE => 25_000_000;  # 25MB

open my $infh, '<', INFILE or die $!;

my $header = <$infh>;

my $outfh;
my $filenumber = 0;

while (my $line = <$infh>) {

  unless ($outfh) {
    my $outfile = "outfile_$filenumber.dat";
    open $outfh, '>', $outfile or die "Can't open '$outfile': $!";
    print { $outfh } $header;
    $filenumber++;
  }

  print { $outfh } $line;

  if (tell $outfh > CHUNKSIZE or eof $infh) {
    close $outfh or die $!;
    undef $outfh;
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T12:07:41.683

您需要存储输入文件的标题并在每次打开新文件时打印它：

```
use strict;
use warnings;
use autodie;

# initializations ...

open my $in,  '<', $infile;
open my $out, '>', "outfile_${file_number}.dat";

my $header = <$in>;    # Save the header...
chomp $header;         # ... not strictly necessary

while ( <$in> ) {

    chomp;             # Not strictly necessary

    if ( $outsize > $chunksize) {

        close $out; 
        $outsize = 0;
        $filenumber++;

        open $out, '>', "outfile_${file_number}.dat";

        print $out $header, "\n";    # Prints header at beginning of file
                                     # Newline needed if $header chomped

    }

    print $out $_, "\n";             # Newline needed if $_ chomped
    $outsize += length;
} 
```

# jquery - 附加到列表视图的项目不可点击

> ID：12338631
> 
> 赞同：0
> 
> 时间：2012-09-09T11:19:52.083
> 
> 标签：jquery, listview, jquery-mobile

当我在 jQuery Mobile 中将内容添加到我的列表视图时，它们在单击时不会触发单击事件。在下面的示例中，“凯迪拉克”不可点击。难道我做错了什么？

HTML：

```
<div data-role="page" id="p1">
    <ul data-role="listview" data-theme="b">
        <li><a href="#">Acura</a></li>
        <li><a href="#">Audi</a></li>
        <li><a href="#">BMW</a></li>
    </ul>
</div> 
```

jQuery：

```
$('li').on('click',function(){
    alert('clicked');            
});

$('ul').append('<li><a href="#">Cadillac</a></li>');
$('ul').listview('refresh'); 
```

[jsFiddle的问题](http://jsfiddle.net/88NHA/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T11:25:43.337

尝试将您的代码更改为此

```
$('ul').on('click', 'li', function(){   # <-- That's the trick
    alert('clicked');            
});

$('ul').append('<li><a href="#">Cadillac</a></li>');
$('ul').listview('refresh'); 
```

编辑：在这种情况下，即使 DOM 发生变化，`on`函数也会自动绑定`click`到列表中的每个元素。`li`因此，您可以随时添加列表项。它们都将具有单击事件绑定。

使用具有几乎相同功能的旧`live`jQuery 方法是一个坏主意，因为它的性能非常低。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T11:26:15.777

在编译 javascript 时，li 不存在，因此处理程序未应用在其上，您需要将其委托给当时存在的元素。

```
$('ul').on('click','li', function(){
    alert('clicked');            
});

$('ul').append('<li><a href="#">Cadillac</a></li>');
$('ul').listview('refresh'); 
```

或者您可以使用`live()`, 或`delegate()`, 但`on()`在性能方面是最好的

​<a href="http://jsfiddle.net/88NHA/1/" rel="nofollow">工作小提琴

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T12:07:38.813

现在正在工作，请参阅[此编辑](http://jsfiddle.net/88NHA/2/)

```
$('ul').append(
    $('<li>').append(
        $('<a>').attr('href','#').append('Cadillac'
))); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T12:53:13.127

# ruby-on-rails - 使用热键重新加载 rails 控制台

> ID：12338642
> 
> 赞同：1
> 
> 时间：2012-09-09T11:22:41.797
> 
> 标签：ruby-on-rails, hotkeys, irb, rails-console

是否可以使用热键重新加载 Rails 控制台？`reload!`绑定到`CMD`+之类的东西`r`（例如在浏览器中重新加载页面）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:42:53.273

在 iTerm2 中，您可以执行以下操作：

首选项 -> 键 -> 全局快捷键 -> +

并添加以下内容：![在此处输入图像描述](../Images/2701b4270f1b506a2fd75e95551237e7.png)

# android - 我无法重新创建 java.lang.NullPointerException Android

> ID：12338646
> 
> 赞同：0
> 
> 时间：2012-09-09T11:23:03.463
> 
> 标签：android

我有一个奇怪的问题，让我把头撞到砖墙上。在我的 android 应用程序中，我有一种方法可以检查移动状态，并根据结果从网上提取图像。我开始在开发者控制台中收到 java.lang.NullPointerException。这是由于没有可检查的移动状态引起的。很简单，并用 if 语句修复。

这种方法在几个活动中，并且修复适用于所有活动。出于某种原因，我仍然在控制台中收到错误，但仅针对其中一项活动。错误消息与上次相同，并且我已经通过代码一百万次它不应该这样做它具有与其他活动相同的修复。我也无法重新创建错误，这使得无法修复。据我所知，它没有坏。

在这种情况下该怎么做有什么建议吗？试一试合适吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:16:19.203

尝试清理（在 Eclipse 中，Project -> Clean...）你的项目。我发现这有时会解决应用程序在对源进行更改时无缝更新的问题......无论源是资源还是源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T12:14:03.590

也许检查是否有任何未明确定义的上下文。或者，如果您只是写了“（this）”之一，请尝试更明确：“（mainactivity.this）”

# python - mlab.griddata 错误？

> ID：12338649
> 
> 赞同：2
> 
> 时间：2012-09-09T11:23:58.303
> 
> 标签：python, numpy, matplotlib, python-2.7, matplotlib-basemap

当我遇到一个奇怪且看起来像浮点精度的错误时，我正在使用 mlab.griddata 插入一些数据。这是调用序列：

```
nvals = matplotlib.mlab.griddata(lon_old.ravel(),
                                 lat_old.ravel(),               
                                 ivals.ravel(),             
                                 lon_new,                      
                                 lat_new,interp='linear').T
lat_old = array([ 19.62606908,  18.50457985,  17.38309053,  16.26160115,
    15.14011169,  14.01862218,  12.8971326 ,  11.77564298,
    10.65415331,   9.53266359,   8.41117384,   7.28968406,
     6.16819425,   5.04670442,   3.92521457,   2.8037247 ,
     1.68223483,   0.56074494,  -0.56074494,  -1.68223483,
    -2.8037247 ,  19.62606908,  18.50457985,  17.38309053,
    16.26160115,  15.14011169,  14.01862218,  12.8971326 ,
    11.77564298,  10.65415331,   9.53266359,   8.41117384,
     7.28968406,   6.16819425,   5.04670442,   3.92521457,
     2.8037247 ,   1.68223483,   0.56074494,  -0.56074494,
    -1.68223483,  -2.8037247 ,  19.62606908,  18.50457985,
    17.38309053,  16.26160115,  15.14011169,  14.01862218,
    12.8971326 ,  11.77564298,  10.65415331,   9.53266359,
     8.41117384,   7.28968406,   6.16819425,   5.04670442,
     3.92521457,   2.8037247 ,   1.68223483,   0.56074494,
    -0.56074494,  -1.68223483,  -2.8037247 ,  19.62606908,
    18.50457985,  17.38309053,  16.26160115,  15.14011169,
    14.01862218,  12.8971326 ,  11.77564298,  10.65415331,
     9.53266359,   8.41117384,   7.28968406,   6.16819425,
     5.04670442,   3.92521457,   2.8037247 ,   1.68223483,
     0.56074494,  -0.56074494,  -1.68223483,  -2.8037247 ,
    19.62606908,  18.50457985,  17.38309053,  16.26160115,
    15.14011169,  14.01862218,  12.8971326 ,  11.77564298,
    10.65415331,   9.53266359,   8.41117384,   7.28968406,
     6.16819425,   5.04670442,   3.92521457,   2.8037247 ,
     1.68223483,   0.56074494,  -0.56074494,  -1.68223483,
    -2.8037247 ,  19.62606908,  18.50457985,  17.38309053,
    16.26160115,  15.14011169,  14.01862218,  12.8971326 ,
    11.77564298,  10.65415331,   9.53266359,   8.41117384,
     7.28968406,   6.16819425,   5.04670442,   3.92521457,
     2.8037247 ,   1.68223483,   0.56074494,  -0.56074494,
    -1.68223483,  -2.8037247 ,  19.62606908,  18.50457985,
    17.38309053,  16.26160115,  15.14011169,  14.01862218,
    12.8971326 ,  11.77564298,  10.65415331,   9.53266359,
     8.41117384,   7.28968406,   6.16819425,   5.04670442,
     3.92521457,   2.8037247 ,   1.68223483,   0.56074494,
    -0.56074494,  -1.68223483,  -2.8037247 ,  19.62606908,
    18.50457985,  17.38309053,  16.26160115,  15.14011169,
    14.01862218,  12.8971326 ,  11.77564298,  10.65415331,
     9.53266359,   8.41117384,   7.28968406,   6.16819425,
     5.04670442,   3.92521457,   2.8037247 ,   1.68223483,
     0.56074494,  -0.56074494,  -1.68223483,  -2.8037247 ,
    19.62606908,  18.50457985,  17.38309053,  16.26160115,
    15.14011169,  14.01862218,  12.8971326 ,  11.77564298,
    10.65415331,   9.53266359,   8.41117384,   7.28968406,
     6.16819425,   5.04670442,   3.92521457,   2.8037247 ,
     1.68223483,   0.56074494,  -0.56074494,  -1.68223483,
    -2.8037247 ,  19.62606908,  18.50457985,  17.38309053,
    16.26160115,  15.14011169,  14.01862218,  12.8971326 ,
    11.77564298,  10.65415331,   9.53266359,   8.41117384,
     7.28968406,   6.16819425,   5.04670442,   3.92521457,
     2.8037247 ,   1.68223483,   0.56074494,  -0.56074494,
    -1.68223483,  -2.8037247 ,  19.62606908,  18.50457985,
    17.38309053,  16.26160115,  15.14011169,  14.01862218,
    12.8971326 ,  11.77564298,  10.65415331,   9.53266359,
     8.41117384,   7.28968406,   6.16819425,   5.04670442,
     3.92521457,   2.8037247 ,   1.68223483,   0.56074494,
    -0.56074494,  -1.68223483,  -2.8037247 ,  19.62606908,
    18.50457985,  17.38309053,  16.26160115,  15.14011169,
    14.01862218,  12.8971326 ,  11.77564298,  10.65415331,
     9.53266359,   8.41117384,   7.28968406,   6.16819425,
     5.04670442,   3.92521457,   2.8037247 ,   1.68223483,
     0.56074494,  -0.56074494,  -1.68223483,  -2.8037247 ,
    19.62606908,  18.50457985,  17.38309053,  16.26160115,
    15.14011169,  14.01862218,  12.8971326 ,  11.77564298,
    10.65415331,   9.53266359,   8.41117384,   7.28968406,
     6.16819425,   5.04670442,   3.92521457,   2.8037247 ,
     1.68223483,   0.56074494,  -0.56074494,  -1.68223483,
    -2.8037247 ,  19.62606908,  18.50457985,  17.38309053,
    16.26160115,  15.14011169,  14.01862218,  12.8971326 ,
    11.77564298,  10.65415331,   9.53266359,   8.41117384,
     7.28968406,   6.16819425,   5.04670442,   3.92521457,
     2.8037247 ,   1.68223483,   0.56074494,  -0.56074494,
    -1.68223483,  -2.8037247 ,  19.62606908,  18.50457985,
    17.38309053,  16.26160115,  15.14011169,  14.01862218,
    12.8971326 ,  11.77564298,  10.65415331,   9.53266359,
     8.41117384,   7.28968406,   6.16819425,   5.04670442,
     3.92521457,   2.8037247 ,   1.68223483,   0.56074494,
    -0.56074494,  -1.68223483,  -2.8037247 ,  19.62606908,
    18.50457985,  17.38309053,  16.26160115,  15.14011169,
    14.01862218,  12.8971326 ,  11.77564298,  10.65415331,
     9.53266359,   8.41117384,   7.28968406,   6.16819425,
     5.04670442,   3.92521457,   2.8037247 ,   1.68223483,
     0.56074494,  -0.56074494,  -1.68223483,  -2.8037247 ,
    19.62606908,  18.50457985,  17.38309053,  16.26160115,
    15.14011169,  14.01862218,  12.8971326 ,  11.77564298,
    10.65415331,   9.53266359,   8.41117384,   7.28968406,
     6.16819425,   5.04670442,   3.92521457,   2.8037247 ,
     1.68223483,   0.56074494,  -0.56074494,  -1.68223483,
    -2.8037247 ,  19.62606908,  18.50457985,  17.38309053,
    16.26160115,  15.14011169,  14.01862218,  12.8971326 ,
    11.77564298,  10.65415331,   9.53266359,   8.41117384,
     7.28968406,   6.16819425,   5.04670442,   3.92521457,
     2.8037247 ,   1.68223483,   0.56074494,  -0.56074494,
    -1.68223483,  -2.8037247 ,  19.62606908,  18.50457985,
    17.38309053,  16.26160115,  15.14011169,  14.01862218,
    12.8971326 ,  11.77564298,  10.65415331,   9.53266359,
     8.41117384,   7.28968406,   6.16819425,   5.04670442,
     3.92521457,   2.8037247 ,   1.68223483,   0.56074494,
    -0.56074494,  -1.68223483,  -2.8037247 ,  19.62606908,
    18.50457985,  17.38309053,  16.26160115,  15.14011169,
    14.01862218,  12.8971326 ,  11.77564298,  10.65415331,
     9.53266359,   8.41117384,   7.28968406,   6.16819425,
     5.04670442,   3.92521457,   2.8037247 ,   1.68223483,
     0.56074494,  -0.56074494,  -1.68223483,  -2.8037247 ,
    19.62606908,  18.50457985,  17.38309053,  16.26160115,
    15.14011169,  14.01862218,  12.8971326 ,  11.77564298,
    10.65415331,   9.53266359,   8.41117384,   7.28968406,
     6.16819425,   5.04670442,   3.92521457,   2.8037247 ,
     1.68223483,   0.56074494,  -0.56074494,  -1.68223483,  -2.8037247 ])

lon_old = array([ 228.375,  228.375,  228.375,  228.375,  228.375,  228.375,
    228.375,  228.375,  228.375,  228.375,  228.375,  228.375,
    228.375,  228.375,  228.375,  228.375,  228.375,  228.375,
    228.375,  228.375,  228.375,  229.5  ,  229.5  ,  229.5  ,
    229.5  ,  229.5  ,  229.5  ,  229.5  ,  229.5  ,  229.5  ,
    229.5  ,  229.5  ,  229.5  ,  229.5  ,  229.5  ,  229.5  ,
    229.5  ,  229.5  ,  229.5  ,  229.5  ,  229.5  ,  229.5  ,
    230.625,  230.625,  230.625,  230.625,  230.625,  230.625,
    230.625,  230.625,  230.625,  230.625,  230.625,  230.625,
    230.625,  230.625,  230.625,  230.625,  230.625,  230.625,
    230.625,  230.625,  230.625,  231.75 ,  231.75 ,  231.75 ,
    231.75 ,  231.75 ,  231.75 ,  231.75 ,  231.75 ,  231.75 ,
    231.75 ,  231.75 ,  231.75 ,  231.75 ,  231.75 ,  231.75 ,
    231.75 ,  231.75 ,  231.75 ,  231.75 ,  231.75 ,  231.75 ,
    232.875,  232.875,  232.875,  232.875,  232.875,  232.875,
    232.875,  232.875,  232.875,  232.875,  232.875,  232.875,
    232.875,  232.875,  232.875,  232.875,  232.875,  232.875,
    232.875,  232.875,  232.875,  234\.   ,  234\.   ,  234\.   ,
    234\.   ,  234\.   ,  234\.   ,  234\.   ,  234\.   ,  234\.   ,
    234\.   ,  234\.   ,  234\.   ,  234\.   ,  234\.   ,  234\.   ,
    234\.   ,  234\.   ,  234\.   ,  234\.   ,  234\.   ,  234\.   ,
    235.125,  235.125,  235.125,  235.125,  235.125,  235.125,
    235.125,  235.125,  235.125,  235.125,  235.125,  235.125,
    235.125,  235.125,  235.125,  235.125,  235.125,  235.125,
    235.125,  235.125,  235.125,  236.25 ,  236.25 ,  236.25 ,
    236.25 ,  236.25 ,  236.25 ,  236.25 ,  236.25 ,  236.25 ,
    236.25 ,  236.25 ,  236.25 ,  236.25 ,  236.25 ,  236.25 ,
    236.25 ,  236.25 ,  236.25 ,  236.25 ,  236.25 ,  236.25 ,
    237.375,  237.375,  237.375,  237.375,  237.375,  237.375,
    237.375,  237.375,  237.375,  237.375,  237.375,  237.375,
    237.375,  237.375,  237.375,  237.375,  237.375,  237.375,
    237.375,  237.375,  237.375,  238.5  ,  238.5  ,  238.5  ,
    238.5  ,  238.5  ,  238.5  ,  238.5  ,  238.5  ,  238.5  ,
    238.5  ,  238.5  ,  238.5  ,  238.5  ,  238.5  ,  238.5  ,
    238.5  ,  238.5  ,  238.5  ,  238.5  ,  238.5  ,  238.5  ,
    239.625,  239.625,  239.625,  239.625,  239.625,  239.625,
    239.625,  239.625,  239.625,  239.625,  239.625,  239.625,
    239.625,  239.625,  239.625,  239.625,  239.625,  239.625,
    239.625,  239.625,  239.625,  240.75 ,  240.75 ,  240.75 ,
    240.75 ,  240.75 ,  240.75 ,  240.75 ,  240.75 ,  240.75 ,
    240.75 ,  240.75 ,  240.75 ,  240.75 ,  240.75 ,  240.75 ,
    240.75 ,  240.75 ,  240.75 ,  240.75 ,  240.75 ,  240.75 ,
    241.875,  241.875,  241.875,  241.875,  241.875,  241.875,
    241.875,  241.875,  241.875,  241.875,  241.875,  241.875,
    241.875,  241.875,  241.875,  241.875,  241.875,  241.875,
    241.875,  241.875,  241.875,  243\.   ,  243\.   ,  243\.   ,
    243\.   ,  243\.   ,  243\.   ,  243\.   ,  243\.   ,  243\.   ,
    243\.   ,  243\.   ,  243\.   ,  243\.   ,  243\.   ,  243\.   ,
    243\.   ,  243\.   ,  243\.   ,  243\.   ,  243\.   ,  243\.   ,
    244.125,  244.125,  244.125,  244.125,  244.125,  244.125,
    244.125,  244.125,  244.125,  244.125,  244.125,  244.125,
    244.125,  244.125,  244.125,  244.125,  244.125,  244.125,
    244.125,  244.125,  244.125,  245.25 ,  245.25 ,  245.25 ,
    245.25 ,  245.25 ,  245.25 ,  245.25 ,  245.25 ,  245.25 ,
    245.25 ,  245.25 ,  245.25 ,  245.25 ,  245.25 ,  245.25 ,
    245.25 ,  245.25 ,  245.25 ,  245.25 ,  245.25 ,  245.25 ,
    246.375,  246.375,  246.375,  246.375,  246.375,  246.375,
    246.375,  246.375,  246.375,  246.375,  246.375,  246.375,
    246.375,  246.375,  246.375,  246.375,  246.375,  246.375,
    246.375,  246.375,  246.375,  247.5  ,  247.5  ,  247.5  ,
    247.5  ,  247.5  ,  247.5  ,  247.5  ,  247.5  ,  247.5  ,
    247.5  ,  247.5  ,  247.5  ,  247.5  ,  247.5  ,  247.5  ,
    247.5  ,  247.5  ,  247.5  ,  247.5  ,  247.5  ,  247.5  ,
    248.625,  248.625,  248.625,  248.625,  248.625,  248.625,
    248.625,  248.625,  248.625,  248.625,  248.625,  248.625,
    248.625,  248.625,  248.625,  248.625,  248.625,  248.625,
    248.625,  248.625,  248.625,  249.75 ,  249.75 ,  249.75 ,
    249.75 ,  249.75 ,  249.75 ,  249.75 ,  249.75 ,  249.75 ,
    249.75 ,  249.75 ,  249.75 ,  249.75 ,  249.75 ,  249.75 ,
    249.75 ,  249.75 ,  249.75 ,  249.75 ,  249.75 ,  249.75 ,
    250.875,  250.875,  250.875,  250.875,  250.875,  250.875,
    250.875,  250.875,  250.875,  250.875,  250.875,  250.875,
    250.875,  250.875,  250.875,  250.875,  250.875,  250.875,
    250.875,  250.875,  250.875])

lon_new = array([ 229.078125,  229.78125 ,  230.484375,  231.1875  ,  231.890625,
    232.59375 ,  233.296875,  234\.      ,  234.703125,  235.40625 ,
    236.109375,  236.8125  ,  237.515625,  238.21875 ,  238.921875,
    239.625   ,  240.328125,  241.03125 ,  241.734375,  242.4375  ,
    243.140625,  243.84375 ,  244.546875,  245.25    ,  245.953125,
    246.65625 ,  247.359375,  248.0625  ,  248.765625,  249.46875 ,
    250.171875])
lat_new = array([ 18.95804884,  18.25492384,  17.55179884,  16.84867384,
    16.14554884,  15.44242384,  14.73929884,  14.03617384,
    13.33304884,  12.62992384,  11.92679884,  11.22367384,
    10.52054884,   9.81742384,   9.11429884,   8.41117384,
     7.70804884,   7.00492384,   6.30179884,   5.59867384,
     4.89554884,   4.19242384,   3.48929884,   2.78617384,
     2.08304884,   1.37992384,   0.67679884,  -0.02632616,
    -0.72945116,  -1.43257616,  -2.13570116])

dlon_new = dx = array([-0.7, -0.7, -0.7, -0.7, -0.7, -0.7, -0.7, -0.7, -0.7, -0.7, -0.7,
   -0.7, -0.7, -0.7, -0.7, -0.7, -0.7, -0.7, -0.7, -0.7, -0.7, -0.7,
   -0.7, -0.7, -0.7, -0.7, -0.7, -0.7, -0.7, -0.7])
dlat_new = dy = array([ 0.7,  0.7,  0.7,  0.7,  0.7,  0.7,  0.7,  0.7,  0.7,  0.7,  0.7,
    0.7,  0.7,  0.7,  0.7,  0.7,  0.7,  0.7,  0.7,  0.7,  0.7,  0.7,
    0.7,  0.7,  0.7,  0.7,  0.7,  0.7,  0.7,  0.7])
epsy = 1.0000000000000001e-15
epsx = 1.0000000000000001e-15

ivals = array([[  1.51914963e-03,   4.84249834e-03,   1.24178734e-02,
      1.78842712e-02,   2.73387861e-02,   3.49708572e-02,
      3.76453847e-02,   3.83761562e-02,   3.42653096e-02,
      2.37101801e-02,   1.05387643e-02,   6.25021639e-04,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
   [  2.35232967e-03,   6.95531536e-03,   1.20530156e-02,
      1.50254052e-02,   2.06609517e-02,   2.70908102e-02,
      2.68270355e-02,   1.82730909e-02,   1.43693918e-02,
      1.78140309e-02,   1.54578537e-02,   4.77255462e-03,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
   [  5.49260434e-03,   1.21264756e-02,   1.16909835e-02,
      1.09791821e-02,   1.34972855e-02,   1.25683891e-02,
      7.35369883e-03,   5.41831227e-03,   4.72079264e-05,
      6.89811632e-03,   7.71775097e-03,   2.97224917e-03,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
   [  1.13926865e-02,   1.21114589e-02,   8.51153489e-03,
      5.64892637e-03,   4.42338269e-03,   2.71651126e-03,
      6.50693983e-05,   1.18285546e-03,   1.15790730e-03,
      1.27750791e-05,   1.16404856e-03,   3.87609383e-04,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
   [  9.99477133e-03,   7.84504320e-03,   4.12580743e-03,
      1.95651152e-03,   6.27938076e-04,   3.64340417e-06,
      0.00000000e+00,   5.80144624e-05,   9.30973620e-05,
      6.09520539e-05,   3.19228930e-05,   2.95944778e-06,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
   [  5.62612992e-03,   3.11897229e-03,   1.35576469e-03,
      2.72712990e-04,   2.18278728e-08,   2.77736224e-04,
      2.15023640e-04,   2.99098410e-05,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      5.45696821e-09,   6.18456397e-08,   1.00044417e-07],
   [  1.80969934e-03,   7.60903757e-04,   3.29161890e-06,
      5.94062985e-05,   9.03553300e-05,   1.88442812e-06,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   8.96955896e-07,
      5.46621823e-06,   6.86217982e-06,   9.91616434e-06],
   [  5.55361272e-04,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   7.27595761e-09,
      1.27329258e-08,   8.64968388e-06,   3.59374013e-07,
      9.28682766e-06,   9.36674860e-06,   5.86172609e-06,
      3.51247800e-05,   1.05878571e-04,   2.21810909e-03],
   [  4.81493998e-07,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   3.76954704e-05,
      3.13774217e-06,   4.10084112e-06,   1.22585889e-05,
      1.23064645e-04,   3.22126038e-02,   4.12977114e-03,
      4.40907385e-03,   8.58011283e-03,   1.13403024e-02,
      1.39989899e-02,   1.55630931e-02,   1.62743106e-02],
   [  3.06865149e-06,   1.18992730e-05,   2.90403641e-05,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   3.26428679e-04,
      5.05644502e-03,   7.92237557e-03,   8.84909835e-03,
      9.39421635e-03,   4.13218886e-02,   5.75748496e-02,
      1.31889293e-02,   1.34845898e-01,   1.13798976e-01,
      1.20008864e-01,   1.56037509e-01,   1.93280712e-01],
   [  5.33699116e-04,   1.72329973e-03,   3.17315105e-03,
      1.14819378e-01,   4.43908386e-02,   0.00000000e+00,
      0.00000000e+00,   5.74506557e-05,   5.10447251e-04,
      1.71848107e-03,   5.27862227e-03,   1.52162453e-02,
      8.03043172e-02,   7.01455697e-02,   1.05249695e-01,
      1.42122656e-01,   2.22821265e-01,   2.02459455e-01,
      2.06677437e-01,   2.46986017e-01,   2.63066918e-01],
   [  7.62831494e-02,   1.11132614e-01,   1.37192637e-01,
      1.43570632e-01,   1.15425527e-01,   0.00000000e+00,
      2.89876079e-05,   3.49933194e-04,   9.58649849e-04,
      2.01611011e-03,   4.83151386e-03,   1.83595419e-02,
      1.03671178e-01,   9.63126644e-02,   5.50910681e-02,
      1.36725232e-01,   1.64533973e-01,   7.98287913e-02,
      1.73291177e-01,   1.81056723e-01,   2.02676117e-01],
   [  1.07610516e-01,   1.21951140e-01,   1.01695523e-01,
      4.15301125e-04,   0.00000000e+00,   0.00000000e+00,
      2.18786477e-06,   3.11349390e-06,   1.33068315e-04,
      3.67084111e-04,   1.08024117e-03,   3.34545830e-03,
      8.69611651e-03,   1.37638608e-02,   2.27879807e-02,
      4.41205539e-02,   5.16842529e-02,   3.70345488e-02,
      5.38833812e-02,   6.32722452e-02,   1.56152964e-01],
   [  1.10440794e-02,   3.89250601e-03,   2.37991480e-05,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      1.04574056e-07,   8.74274861e-07,   2.26301170e-04,
      8.31953774e-04,   1.92522176e-03,   4.67427028e-03,
      1.10447202e-02,   1.51307033e-02,   1.29928729e-02,
      2.08757464e-02,   2.11046692e-02,   3.58685926e-02],
   [  1.40534030e-04,   6.79020388e-07,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   6.55058902e-05,   2.59673747e-04,
      7.57753383e-04,   1.35594222e-03,   1.73954351e-03,
      4.76868916e-03,   5.21047926e-03,   9.71581228e-03],
   [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   3.23413442e-05,   3.17198865e-05,
      3.07607057e-04,   2.70675024e-04,   1.48168497e-03],
   [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   6.51265509e-05],
   [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
   [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
   [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
   [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
      0.00000000e+00,   0.00000000e+00,   0.00000000e+00]], dtype=float32) 
```

这是标记错误的 mlab 代码部分：

```
dx.max()-dx.min() = 1.7763568394002505e-15
dy.max()-dy.min() = 0.0
epsy = np.finfo(yi.dtype).resolution 
if dx.max()-dx.min() > epsx or dy.max()-dy.min() > epsy:
   raise ValueError("output grid must have constant spacing"
                    " when using interp='linear'") 
```

我很想知道如何解决这个问题。我不拥有这个 python 安装，所以我不能修改 if 语句。有时这有效，有时无效，它似乎取决于数据输入，但在这种情况下，当它确实中断时，dy 和 dy 都是相同的。这是mlab中的错误吗？如果我改为“nn”而不是线性，问题就会消失，但我需要“线性”插值。

谢谢，/Shejo284

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T18:01:22.267

我对 mlab 没有运气。改用 scipy.interpolate.griddata 。它似乎有效，结果看起来不错。

```
nvals = scipy.interpolate.griddata((lon_old.ravel(),     
                                   lat_old.ravel()),    
                                   tmp.ravel(),          
                                   (lon_new,lat_new),    
                                   method='linear') 
```

感谢您的贡献。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T15:59:50.360

奇怪的是，在我的机器上，从输出中复制和粘贴输入数组效果很好。这表明以下内容将解决您的问题：

```
lat_new = numpy.round(lat_new, 10)
lon_new = numpy.round(lon_new, 10) 
```

它还建议您可以更改最初创建它们的代码。

# performance - 将所有奇数定位元素移动到左半边，偶数定位到右半边就地

> ID：12338654
> 
> 赞同：11
> 
> 时间：2012-09-09T11:24:34.707
> 
> 标签：performance, algorithm, data-structures, time-complexity, in-place

给定一个包含正整数和负整数的数组，将所有奇数索引元素移到左侧，将偶数索引元素移到右侧。

问题的难点在于在保持秩序的同时就地进行。

例如

```
7, 5, 6, 3, 8, 4, 2, 1 
```

输出应该是：

```
5, 3, 4, 1, 7, 6, 8, 2 
```

如果顺序无关紧要，我们可以使用快速排序的 partition() 算法。

如何在 O( N ) 中做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-09T13:22:52.357

1.  ^(获取大小为 3 k) +1的最大子数组
2.  将循环领导算法应用于该子数组的各个部分，从位置 1、3、9、... 3 ^(k-1)开始：将元素移动到子数组中的正确位置（偶数索引元素到子数组的左侧） -array，奇数索引 - 向右），被替换的元素也应该移动到它的正确位置，等等，直到这个过程回到起始位置。[本文](http://arxiv.org/abs/0805.1598)给出了数论解释为什么这样的起始位置选择将子阵列打乱到正确的顺序。
3.  使用步骤 1 和 2 递归处理数组的其余部分。
4.  现在我们只需要将重新排序的部分连接在一起。从整个数组末尾的较小子数组开始。要交换子数组的一半，请使用反向算法：reverse(reverse(a), reverse(b)); 或者，对于大小相等的子数组，使用成对交换。
5.  现在所有偶数定位的元素都在左边。为了使它们在右边，根据需要，将元素 i 和 i+N/2 交换为所有 i = 0 .. N/2-1。

算法就地，时间复杂度为 O(N)。

例子：

```
0 1 2 3 4  5 6 7 8 9   10 11 (the original array)
0 1 2 3 4  5 6 7 8 9 # 10 11 (split to sub-arrays)
0 2 4 3 8  1 6 5 7 9 # 10 11 (first cycle leader iteration, starting with 1)
0 2 4 6 8  1 3 5 7 9 # 10 11 (second cycle leader iteration, starting with 3)
0 2 4 6 8  9 7 5 3 1 # 10 11(2nd half of 1st part& 1st half of 2nd part reversed)
0 2 4 6 8 10 1 3 5 7    9 11 (both halves reversed together) 
```

此算法的变体，不需要步骤 5：

*   在第 1 步，获得大小为 3 ^k -1 的最大子数组。
*   在步骤 2 中，将偶数索引元素移动到子数组的右侧，奇数索引元素 - 向左移动。使用起始位置 0, 2, 8, ... 3 ^(k-1) -1 进行循环引导算法。

这是不同的 O(N log N) 就地算法，它不需要数论证明：

1.  将您的数组重新解释为一系列单元素 2*2 矩阵，转置这些矩阵。
2.  将结果重新解释为二元素 2*2 矩阵的序列并将它们转置。
3.  在矩阵大小小于数组大小时继续。
4.  现在我们只需要将重新排序的部分连接在一起（与之前的算法完全相同）。
5.  交换数组左右两半的元素（与之前的算法完全相同）。

例子：

```
0  1   2 3   4 5   6 7  (the original array)
[0 2] [1 3] [4 6] [5 7] (first transposition)
[0 2] [4 6] [1 3] [5 7] (second transposition) 
```

[这个问题只是In-place matrix transposition](http://en.wikipedia.org/wiki/In-place_matrix_transposition)的一个特例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T14:34:42.757

我试图按照 Evgeny Kluev 所说的那样实现，结果如下：

```
#pragma once

#include <iterator>
#include <algorithm>
#include <type_traits>
#include <limits>
#include <deque>
#include <utility>

#include <cassert>

template< typename Iterator >
struct perfect_shuffle_permutation
{

    static_assert(std::is_same< typename std::iterator_traits< Iterator >::iterator_category, std::random_access_iterator_tag >::value,
                  "!");

    using difference_type = typename std::iterator_traits< Iterator >::difference_type;
    using value_type = typename std::iterator_traits< Iterator >::value_type;

    perfect_shuffle_permutation()
    {
        for (difference_type power3_ = 1; power3_ < std::numeric_limits< difference_type >::max() / 3; power3_ *= 3) {
            powers3_.emplace_back(power3_ + 1);
        }
        powers3_.emplace_back(std::numeric_limits< difference_type >::max());
    }

    void
    forward(Iterator _begin, Iterator _end) const
    {
        return forward(_begin, std::distance(_begin, _end));
    }

    void
    backward(Iterator _begin, Iterator _end) const
    {
        return backward(_begin, std::distance(_begin, _end));
    }

    void
    forward(Iterator _begin, difference_type const _size) const
    {
        assert(0 < _size);
        assert(_size % 2 == 0);
        difference_type const left_size_ = *(std::upper_bound(powers3_.cbegin(), powers3_.cend(), _size) - 1);
        cycle_leader_forward(_begin, left_size_);
        difference_type const rest_ = _size - left_size_;
        if (rest_ != 0) {
            Iterator middle_ = _begin + left_size_;
            forward(middle_, rest_);
            std::rotate(_begin + left_size_ / 2, middle_, middle_ + rest_ / 2);
        }
    }

    void
    backward(Iterator _begin, difference_type const _size) const
    {
        assert(0 < _size);
        assert(_size % 2 == 0);
        difference_type const left_size_ = *(std::upper_bound(powers3_.cbegin(), powers3_.cend(), _size) - 1);
        std::rotate(_begin + left_size_ / 2, _begin + _size / 2, _begin + (_size + left_size_) / 2);
        cycle_leader_backward(_begin, left_size_);
        difference_type const rest_ = _size - left_size_;
        if (rest_ != 0) {
            Iterator middle_ = _begin + left_size_;
            backward(middle_, rest_);
        }
    }

private :

    void
    cycle_leader_forward(Iterator _begin, difference_type const _size) const
    {
        for (difference_type leader_ = 1; leader_ != _size - 1; leader_ *= 3) {
            permutation_forward permutation_(leader_, _size);
            Iterator current_ = _begin + leader_;
            value_type first_ = std::move(*current_);
            while (++permutation_) {
                assert(permutation_ < _size);
                Iterator next_ = _begin + permutation_;
                *current_ = std::move(*next_);
                current_ = next_;
            }
            *current_ = std::move(first_);
        }
    }

    void
    cycle_leader_backward(Iterator _begin, difference_type const _size) const
    {
        for (difference_type leader_ = 1; leader_ != _size - 1; leader_ *= 3) {
            permutation_backward permutation_(leader_, _size);
            Iterator current_ = _begin + leader_;
            value_type first_ = std::move(*current_);
            while (++permutation_) {
                assert(permutation_ < _size);
                Iterator next_ = _begin + permutation_;
                *current_ = std::move(*next_);
                current_ = next_;
            }
            *current_ = std::move(first_);
        }
    }

    struct permutation_forward
    {

        permutation_forward(difference_type const _leader, difference_type const _size)
            : leader_(_leader)
            , current_(_leader)
            , half_size_(_size / 2)
        { ; }

        bool
        operator ++ ()
        {
            if (current_ < half_size_) {
                current_ += current_;
            } else {
                current_ = 1 + (current_ - half_size_) * 2;
            }
            return (current_ != leader_);
        }

        operator difference_type () const
        {
            return current_;
        }

    private :

        difference_type const leader_;
        difference_type current_;
        difference_type const half_size_;

    };

    struct permutation_backward
    {

        permutation_backward(difference_type const _leader, difference_type const _size)
            : leader_(_leader)
            , current_(_leader)
            , half_size_(_size / 2)
        { ; }

        bool
        operator ++ ()
        {
            if ((current_ % 2) == 0) {
                current_ /= 2;
            } else {
                current_ = (current_ - 1) / 2 + half_size_;
            }
            return (current_ != leader_);
        }

        operator difference_type () const
        {
            return current_;
        }

    private :

        difference_type const leader_;
        difference_type current_;
        difference_type const half_size_;

    };

    std::deque< difference_type > powers3_;

}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-04T05:09:52.417

[我在这里](http://www.geeksforgeeks.org/an-in-place-algorithm-for-string-transformation/)修改了代码以获得这个算法：

```
void PartitionIndexParity(T arr[], size_t n)
{
    using std::swap;
    for (size_t shift = 0, k; shift != n; shift += k)
    {
        k = (size_t)pow(3, ceil(log(n - shift) / log(3)) - 1) + 1;
        for (size_t i = 1; i < k; i *= 3)  // cycle-leader algorithm
        {
            size_t j = i;
            do { swap(arr[(j = j / 2 + (j % 2) * (k / 2)) + shift], arr[i + shift]); } while (j != i);
        }

        for (size_t b = shift / 2, m = shift, e = shift + (k - k / 2), i = m; shift != 0 && k != 0; )  // or just use std::rotate(arr, b, m, e)
        {
            swap(arr[b++], arr[i++]);
            if (b == m && i == e) { break; }
            if (b == m) { m = i; }
            else if (i == e) { i = m; }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-03T06:31:23.743

这是 Peiyush Jain 算法的 Java 实现：

```
import java.util.Arrays;

public class InShuffle {
    public static void main(String[] args) {
        Integer[] nums = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 };

        inShuffle(nums);

        System.out.println(Arrays.toString(nums));
    }

    public static <T> void inShuffle(T[] array) {
        if (array == null) {
            return;
        }

        inShuffle(array, 0, array.length - 1);
    }

    private static <T> void inShuffle(T[] array, int startIndex, int endIndex) {
        while (endIndex - startIndex + 1 > 1) {
            int size = endIndex - startIndex + 1;
            int n = size / 2;
            int k = (int)Math.floor(Math.log(size + 1) / Math.log(3));
            int m = (int)(Math.pow(3, k) - 1) / 2;

            rotateRight(array, startIndex + m, startIndex + n + m - 1, m);

            for (int i = 0, cycleStartIndex = 0; i < k; ++i, cycleStartIndex = cycleStartIndex * 3 + 2) {
                permuteCycle(array, startIndex, cycleStartIndex, 2 * m + 1);
            }

            endIndex = startIndex + 2 * n - 1;
            startIndex = startIndex + 2 * m;
        }
    }

    private static <T> void rotateRight(T[] array, int startIndex, int endIndex, int amount) {
        reverse(array, startIndex, endIndex - amount);
        reverse(array, endIndex - amount + 1, endIndex);
        reverse(array, startIndex, endIndex);
    }

    private static <T> void reverse(T[] array, int startIndex, int endIndex) {
       for (int leftIndex = startIndex, rightIndex = endIndex; leftIndex < rightIndex; ++leftIndex, --rightIndex) {
           swap(array, leftIndex, rightIndex);
       }
    }

    private static <T> void swap(T[] array, int index1, int index2) {
        T temp = array[index1];
        array[index1] = array[index2];
        array[index2] = temp;
    }

    private static <T> void permuteCycle(T[] array, int offset, int startIndex, int mod) {
        for (int i = ((2 * startIndex + 2) % mod) - 1; i != startIndex; i = ((2 * i + 2) % mod) - 1) {
            swap(array, offset + i, offset + startIndex);
        }
    }
} 
```

做一个洗牌很简单：

```
public static <T> void outShuffle(T[] array) {
    if (array == null) {
       return;
    }

    inShuffle(array, 1, array.length - 1);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-27T01:00:16.133

```
public class OddToLeftEvenToRight {

    private static void doIt(String input){

        char[] inp = input.toCharArray();
        int len = inp.length;

        for(int j=1; j< len; j++)
        {
            for(int i=j; i<len-j; i+=2)
            {

                swap(inp, i, i+1);

            }
        }

        System.out.print(inp);

    }

    private static void swap(char[] inp, int i, int j) {

        char tmp = inp[i];
        inp[i]= inp[j];
        inp[j]=tmp;

    }

    public static void main(String[] args)
    {

        doIt("a1b");
    }

} 
```

这个程序在 O(n^2) 中完成。

# c# - linq选择月份之间的日期范围

> ID：12338657
> 
> 赞同：-1
> 
> 时间：2012-09-09T11:25:38.440
> 
> 标签：c#, linq

我有以下日期列表：

```
List<Datetime> listOfDates = new List<DateTIme>();

listofDates.add(new DateTime(2012,01,04));
listofDates.add(new DateTime(2012,01,05));
listofDates.add(new DateTime(2012,01,06));
..
listofDates.add(new DateTime(2012,01,31));
listofDates.add(new DateTime(2012,02,01));
..
listofDates.add(new DateTime(2012,02,28));
listofDates.add(new DateTime(2012,03,01));
..
listofDates.add(new DateTime(2012,03,16)); 
```

我需要按月份范围过滤上述列表，如下所示：

```
var filterdListByMonth = listofDates.Where(x.DateTime.Month => 1 and x.DateTime.Month <=2).ToList(); 
```

但这似乎并没有返回正确的结果。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T11:32:12.657

如果您修复编译器错误，它会按预期工作：

```
List<DateTime> listOfDates = new List<DateTime>();
listOfDates.Add(new DateTime(2012, 01, 04));
listOfDates.Add(new DateTime(2012, 01, 05));
listOfDates.Add(new DateTime(2012, 01, 06));
listOfDates.Add(new DateTime(2012, 01, 31));
listOfDates.Add(new DateTime(2012, 02, 01));
listOfDates.Add(new DateTime(2012, 02, 28));
listOfDates.Add(new DateTime(2012, 03, 01));
listOfDates.Add(new DateTime(2012, 03, 16));
var filterdListByMonth = listOfDates.Where(date => date.Month >= 1 && date.Month <= 2);

// Outputs each date except the two in March.
Console.WriteLine(String.Join(Environment.NewLine, filterdListByMonth)); 
```

# java - 警报管理器不启动android

> ID：12338668
> 
> 赞同：1
> 
> 时间：2012-09-09T11:27:01.963
> 
> 标签：java, android, alarmmanager

那么在我的应用程序中，我正在尝试以下功能。我希望根据日期和时间，用户接收一些通知。

例如：

1.  19.13 年 9 月 9 日收到带有 message1 的通知
2.  9 月 10 日，07.30，带有消息 2，
3.  同一天，但 11.50，消息 3 等等......

我使用了警报和推送栏通知，但它仅适用于第一个。所以我为此进行了搜索，并且据说我必须使用重复警报管理器。

在我发布我的代码之前，我想澄清一些事情：1）我认为它应该像这样工作：我必须每 1-2 分钟检查一次，现在是几点，从事件的数组中获取我的下一个“时间”被存储，并为此设置警报，对吗？然后鉴于这段代码将每 1-2 分钟运行一次，我将再次检查，获取下一个事件，为该时间设置警报等等。

我对么？

因此，首先，我正在尝试实现一个重复的警报管理器，它每 1 分钟将向我显示一条 Toast 消息（如果我这样做并用 get_next_event() 和 set_next_notification() 替换 toast 消息将完成我认为的工作。-这些功能在我的项目中运行良好，只设置了一个警报）。

但问题是，当我开始服务时，我什么也看不到。

这是我的代码：

**报警器.java**

```
public class Alarm extends BroadcastReceiver 
    {    
         @Override
         public void onReceive(Context context, Intent intent) 
         {   
             Toast.makeText(context, "Starting Alarm Manager", Toast.LENGTH_LONG).show(); // For example

             PowerManager pm = (PowerManager) context.getSystemService(Context.POWER_SERVICE);
             PowerManager.WakeLock wl = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, "");
             wl.acquire();

             // Put here YOUR code.
             Toast.makeText(context, "Alarm !!!!!!!!!!", Toast.LENGTH_LONG).show(); // For example

             wl.release();
         }

     public void SetAlarm(Context context)
     {
         Toast.makeText(context, "Setting Alarm Manager", Toast.LENGTH_LONG).show(); // For example

         AlarmManager am=(AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
         Intent i = new Intent(context, Alarm.class);
         PendingIntent pi = PendingIntent.getBroadcast(context, 0, i, 0);
         am.setRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis(), 1000 * 60 , pi); // Millisec * Second * Minute
     }

     public void CancelAlarm(Context context)
     {
         Intent intent = new Intent(context, Alarm.class);
         PendingIntent sender = PendingIntent.getBroadcast(context, 0, intent, 0);
         AlarmManager alarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
         alarmManager.cancel(sender);
     } 
```

你的服务.java

```
public class YourService extends Service
{
    Alarm alarm = new Alarm();
    public void onCreate()
    {
        super.onCreate();    
        Toast.makeText(YourService.this, "Service Created", Toast.LENGTH_LONG).show(); // For example

    }

    public void onStart(Context context,Intent intent, int startId)
    {
        Toast.makeText(YourService.this, "Setting from Service", Toast.LENGTH_LONG).show(); // For example

        alarm.SetAlarm(context);
    }

    @Override
    public IBinder onBind(Intent intent) 
    {
        return null;
    }
} 
```

DemoActivity.java

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    buttonStart = (Button) findViewById(R.id.buttonStart);
    buttonStop = (Button) findViewById(R.id.buttonStop);

    buttonStart.setOnClickListener(this);
    buttonStop.setOnClickListener(this);
  }

  public void onClick(View src) {
    switch (src.getId()) {
    case R.id.buttonStart:
        Toast.makeText(ServicesDemo.this, "Button Pressed", Toast.LENGTH_LONG).show(); // For example
      Log.d(TAG, "onClick: starting srvice");
      startService(new Intent(this, YourService.class));
      break;
    case R.id.buttonStop:
      Log.d(TAG, "onClick: stopping srvice");
      stopService(new Intent(this, YourService.class));
      break;
    }
  } 
```

所以我按下按钮，我看到“按钮被按下”，我看到“服务已创建”，但是没有显示警报开始的祝酒词。当然，我每 1 分钟都看不到任何东西。

这是我的清单。

```
<application android:icon="@drawable/ic_launcher" android:label="@string/app_name">

    <activity android:name=".ServicesDemo" android:label="@string/app_name">
      <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
      </intent-filter>
    </activity>
    <service android:enabled="true" android:name=".YourService" />
<receiver  android:process=":remote" android:name="Alarm"></receiver>

  </application>
  <uses-sdk android:minSdkVersion="8" />
      <uses-permission android:name="android.permission.WAKE_LOCK"></uses-permission>

</manifest> 
```

那么我需要在代码或清单中进行哪些更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T12:38:33.503

我建议你使用`AlarmManager`这个：http: [//developer.android.com/reference/android/app/AlarmManager.html](http://developer.android.com/reference/android/app/AlarmManager.html)。

# android - Kivy：声音开始播放，但在 Android 上“不可阻挡”，但在 Windows 上有效

> ID：12338672
> 
> 赞同：0
> 
> 时间：2012-09-09T11:27:39.187
> 
> 标签：android, python, audio, button, kivy

我在 kivy 中获得了一系列 ToggleButtons，每个都加载了不同的声音文件。

当我在 Windows 中尝试我的代码时，一切都按预期工作，但在 Android 上通过 Kivy Launcher 时，声音不会停止。

```
class AudioButton(ToggleButton):
    sound = ObjectProperty(None)

    def killsound(self, state, dt):
        self.sound.stop()
        if 'Click to stop' in self.text:
            self.text = self.text.strip('\nClick to stop')
            self.height = 60
        else:
            pass

    def on_press(self):
        self.bind(state=self.killsound)
        if self.state == 'normal':
            self.sound.stop()
        else:
            self.sound.play()
            self.text = self.text+'\nClick to stop'
            self.height=240 
```

这是它的作用/应该做的：

*   使用先前指定的声音文件创建一个`AudioButton`实例（也指定：`size_hint`，`font_size`和`group`（作为单选按钮）
*   `on_press``killsound`当 Button 的状态改变时触发回调
*   当按钮是`state=='down'`声音播放时，按钮的文本会附加一个标题
*   如果按钮是`state=='normal'`它会停止当前播放的声音，如果相关按钮被按下，如果另一个按钮被按下，则有回调：

回调（killsound）：

*   状态改变时直接停止声音
*   删除之前添加的 Caption 并调整 Button 的大小

在 Windows 上，此代码一切正常。然而，在 Android 上，当`killsound`get 被调用时，它会删除标题并调整按钮的大小，但不会停止声音 - 旧声音（应该停止）仍在播放，新声音开始，所以我得到了两个声音同时播放，相同的有两个以上的声音。

你能帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T10:19:20.127

这已在 Kivy 1.4.1 中修复。您应该通过邮件列表与我们交谈，或者报告 github 问题而不是在这里发布 :)

# android - Tabris - 识别设备 ID

> ID：12338673
> 
> 赞同：0
> 
> 时间：2012-09-09T11:27:42.560
> 
> 标签：android, iphone, ipad, unique, identification

RAP 应用程序如何检索设备（Android、iPad、iPhone、浏览器）的唯一标识号？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T12:21:05.443

目前这是不可能的。我们将把它放在我们的功能请求列表中。

# arrays - node.js websocket 聊天来处理平行颜色

> ID：12338677
> 
> 赞同：0
> 
> 时间：2012-09-09T11:28:27.860
> 
> 标签：arrays, node.js, websocket, chat, process

我正在做一些需要聊天应用程序的项目。我决定在这里测试一些 node.js/websocket 版本：[http ://martinsikora.com/nodejs-and-websocket-simple-chat-tutorial](http://martinsikora.com/nodejs-and-websocket-simple-chat-tutorial)

一切都很完美，但正如他在教程末尾提到的那样：

> 与 Apache 不同，Node.js 不为每个连接使用进程。

这意味着在 7 个用户登录后，将使用每种硬编码颜色，然后使用白色作为用户名样式。

```
// Array with some colors
var colors = [ 'red', 'green', 'blue', 'magenta', 'purple', 'plum', 'orange' ];
// ... in random order
colors.sort(function(a,b) { return Math.random() > 0.5; } );

 userName = htmlEntities(message.utf8Data);
 // get random color and send it back to the user
  userColor = colors.shift();
  connection.sendUTF(JSON.stringify({ type:'color', data: userColor }));
  console.log((new Date()) + ' User is known as: ' + userName
          + ' with ' + userColor + ' color.'); 
```

是否有可能允许两个用户使用相同的颜色？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T15:33:00.340

您最好在每个请求上随机选择一种颜色（这意味着您不必预先调整颜色数组）。是的，这意味着有时两个连续的用户会得到相同的颜色；这是真正随机性的固有属性，而不是人们错误地想象的随机性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T16:51:28.907

你不应该使用 Array.shift()，因为它会从你的颜色数组中删除一个元素，所以基本上在 7 个用户之后你的数组是空的。

只生成一个随机id

```
var idx = Math.floor(Math.random()*colors.length)
.....
({ type:'color', data: colors[idx] }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T17:34:59.873

做完之后：

```
usercolor = colors.shift(); 
```

添加这一行：

```
colors.push(usercolor); 
```

这会将返回的颜色放回另一端的数组中。最终结果是它会一遍又一遍地循环你的七种颜色。

# java - Android - Sqlite 还是 Xml？

> ID：12338678
> 
> 赞同：1
> 
> 时间：2012-09-09T11:28:30.780
> 
> 标签：java, android, xml, sqlite, healthvault

我正在开发一个 android 应用程序，该应用程序从类似的活动中采取措施

`date + time + int1 + int2 + int3 + string`.

我想保存这些措施，然后：

1) 活动以在按日期+时间排序的列表中显示它们并仅显示

```
 date + time + int1 + int 2 
```

当我单击以显示新活动或祝酒词或对话框中的所有字段时

2) 活动能够发送附加到电子邮件的最后一天/过去 7 天/过去 30 天记录

3) 使用记录绘制 2-3 个图表（如饼图/其他）的活动

4）我希望能够将这些记录发送到 Microsoft Healthsvault（它需要它们以特定的 xml 模式）

现在我不知道如何继续。我应该使用 xml 来保存这些记录还是 sqlite。这对于我想要做的图表等更好如果我将它们保存在 sqlite db 中，我可以轻松地将数据导出到 xml文件？或者我应该只使用 xml。对于我想做的事情来说，它是方便的 xml？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:06:55.613

我最近一直在为我的应用程序研究这个问题，我想我终于决定 SQLite 是要走的路。看起来 xml 最初更简单，但出于性能原因，SQLite 可能是最好的。或者我认为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T11:36:25.890

关于 SQLite 和 XML 之间的选择有一个线程：

[Xml 或 Sqlite，何时为数据库删除 Xml？](https://stackoverflow.com/questions/77726/xml-or-sqlite-when-to-drop-xml-for-a-database)

对于您的情况，您希望存储数据，然后按特定顺序提取它们：SQLite 原生提供此功能......

此外，我认为您可以轻松地从 ResultSet 构建 XML 实例（我不知道如何精确地做到这一点，但我认为这并不难）。

# php - 在 PHP 中使用动态配置文件有什么问题？

> ID：12338679
> 
> 赞同：1
> 
> 时间：2012-09-09T11:28:49.383
> 
> 标签：php, .htaccess, configuration

我最近开始将我的网站文件转换为适用于任何路径的文件。我正在使用虚拟主机来维护与`.htaccess`主生产服务器上相同的文件。包含我所有模型的初始化文件是动态编写的，以找出确切的系统文件路径并相应地更新网站，以便我可以将整个网站上传到任何地方。

问题在于配置文件。根据我是在开发还是在生产，我连接到不同的数据库。因此，我先做一个小检查，看看我是否正在运行本地服务器。为此，我将开发人员的命名约定存储在一个数组中，并循环遍历该数组以查看 HTTP_HOST 是否与某个值匹配。

例子：

```
$dev_names = array('localhost','.dev'); 
```

然而，当我前几天在 Chat 中提到这一点时，[一位受人尊敬的用户告诉我](https://chat.stackoverflow.com/transcript/message/5281114#5281114)他从不这样做。相反，他有 2 个配置文件并在正确的时间包含正确的文件？我不明白我的方法有什么问题？

你能指出我计划中的缺陷以帮助我了解专家吗？

（PS。作为奖励，你可以让我快速了解引导程序是如何工作的，听到这个词被抛出，不确定它是用 PHP 还是什么写的。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:35:40.830

我认为您的方法没有任何问题，我想不出不这样做的充分理由。

我个人在我的 php 文件中执行此操作；

```
 if ($_SERVER['SERVER_NAME'] == 'localhost')
 {
    define('ENVIRONMENT', 'development');
 }
 else
 {
    define('ENVIRONMENT', 'production');
 } 
```

然后我所有的配置都挂了。工作得非常好 - 意味着我在开发和生产之间移动时配置更改为零

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T11:40:00.563

我怀疑他的意思是您试图使您的网站可移植实际上并不是那么便携。如果将其移动到新服务器，则必须编辑配置文件。

具体来说，当您将配置文件检查到某种版本控制系统中时，这会成为一个问题，并且会影响其他人。理想情况下，你会使用这样的东西：

```
<?php // global config file which is checked into VCS
    $SETTING = "FOO";
    @include "config/local_settings.php"; // overrides go here
 ?> 
```

您将所有本地设置覆盖都放在本地文件中，并且不要将其提交给 VCS。提交类似的东西是很常见的`local_settings_example.php`，让其他用户提前了解他们需要定制什么。如果你觉得很慷慨，你可以用评论的例子来填充它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T12:42:52.303

我只能在我喜欢的设置上投入 2 美分。主要是为了避免不希望的版本控制覆盖或冲突。在我看来，应该由服务器决定它是生产服务器还是开发服务器，而不是脚本中应该更改的变量。类似下面示例的方法甚至可以在完全不同的开发设置中为个人设置环境。

从设置变量开始

```
$_SERVER['SERVER_ADMIN']; 
```

检查生产或开发环境。本地到您自己的名字，使用一个虚拟域，如 @dev.elop.loc（例如 dbf@dev.elop.loc），它永远不会真正存在。像这样的功能

```
// environment development check
function __env_dev($check) {
  return substr($_SERVER['SERVER_ADMIN'], -(strlen($check))) === $check; 
}
// false = production
// true = development
__env_dev("@dev.elop.loc"); 
```

可以判断环境。根据我的经验，生产服务器总是有一个 SERVER_ADMIN 变量集（如果没有，他们真的应该，即使它必须是默认的 you@example.com）到一个真实的地址，避免默认的 you@example.com。如果对实时服务器的支持在您自己的服务/维护中，将其更改为真实地址以将其与开发服务器区分开来并不是什么大不了的事；）

# php - PHP库不工作

> ID：12338680
> 
> 赞同：0
> 
> 时间：2012-09-09T11:28:50.043
> 
> 标签：php, image-gallery

我正在为我的网站创建 PHP 库。它将显示在普通 HTML 页面内的 iFrame 内。

```
<html>
<head><title></title></head>
<body>
<table><tr>
<?php
define('Photo_dir','img');
define('Columns',2);
$x=0;
$y=0;
$results = scandir(Photo_dir);
foreach ($results as $result) 
{
    if ($result === '.' or $result === '..') continue;
    if (is_dir(Photo_dir.'/'.$result))
    {
        if($y > 2)
        {
            echo "</tr><tr>";
            $y=0;
            $x=&x+1;
        }
        echo "<td><img src='image.php?photo=".Photo_dir."/".$result."/1.jpg'/></td>";
        echo "kod w html";
    }
}
?>
</tr>
</table>
</body>
</html> 
```

由于某种原因，它不起作用。浏览器甚至看不到`<table>`

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:31:02.823

假设常量和变量都是旧的正确信息，你不会错过开场白：

```
<img src='image.php?photo=".Photo_dir."/".$result."/1.jpg'/>
         ^ that one. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T13:15:24.650

你有一个错字，在你增加`$x`你试图增加的变量的那一行`&x`。它应该是：

```
$x = $x +1; 
```

另一种将变量递增一个的简单方法是：

```
$x++; 
```

至于你根本看不到任何输出的原因，它看起来像是一个 500 错误（这就是 Chrome 报告的内容），这意味着服务器本身正在做一个 boo-boo。检查您的服务器配置。

# visual-studio-2010 - wxWidgets（静态库）在 VC++ 2010 下不会链接

> ID：12338682
> 
> 赞同：0
> 
> 时间：2012-09-09T11:28:54.337
> 
> 标签：visual-studio-2010, visual-studio-2008, visual-c++, wxwidgets

我无法获得使用 wxWidgets 静态库在 VC++ 2010 下正确编译和链接的 wxWidgets 程序。在 VC++ 2008 下，这很好。（WxWidgets 仍然附带 vc++ 2008 项目文件。）

我编译并运行了 wxWidgets 附带的“最小”示例程序。这是一个 GUI hello world。没问题。我使用 VC++ 2010 将 .vsproj 转换为 .vsxproj 并尝试在 VC++ 2010 下编译和链接。问题。

请放心，除了运行 VC++ 2010 转换以创建 minimum.vsxproj 之外，我没有进行任何更改。

我收到了许多链接器警告和错误，都与 wxWidgets 库中的 STL wchar_t 字符串有关。这就是我认为正在发生的事情。我相信 wxWidgets 代码中必须有 #ifdefs 根据预处理器符号选择 __declspec(import) 与否。当 VC++ 2010 转换项目时，它必须将符号更改为愚弄 wxWidgets 的东西。如果是这样，错误可能在任何一个地方，或者 wxWidgets 对预处理器定义做出了无效的假设，或者 VC++ 2010 转换把它们搞砸了。用于编译项目中单独的 .cpp 文件的命令行与我预期的不同。

*2008 命令行*

> /Od /I ".....\lib\vc_lib\mswud" /I ".....\include" /I "." /I ".....\samples" /D "WIN32" /D "_D​​EBUG" /D "_CRT_SECURE_NO_DEPRECATE=1" /D "_CRT_NON_CONFORMING_SWPRINTFS=1" /D "_SCL_SECURE_NO_WARNINGS=1" /D " **WXMSW** " /D " _UNICODE" /D "_WINDOWS" /D "NOPCH" /D "UNICODE" /FD /EHsc /RTC1 /MDd /Fo"vc_mswud\minimal\" /Fd"vc_mswud\minimal.pdb" /W4 /nologo /c /Zi /TP /errorReport:提示 /MP

*2010 命令行*

> /I".....\lib\vc_lib\mswud" /I".....\include" /I"." /I".....\samples" /Zi /nologo /W4 /WX- /Od /Oy- /D "WIN32" /D "_D​​EBUG" /D "_CRT_SECURE_NO_DEPRECATE=1" /D "_CRT_NON_CONFORMING_SWPRINTFS=1" / D "_SCL_SECURE_NO_WARNINGS=1" /D " **WXMSW** " /D "_UNICODE" /D "_WINDOWS" /D "NOPCH" /Gm- /EHsc /RTC1 /MDd /GS /fp:precise /Zc:wchar_t /Zc:forScope / GR /Fp"vc_mswud\minimal\minimal.pch" /Fa"vc_mswud\minimal\" /Fo"vc_mswud\minimal\" /Fd"vc_mswud\minimal.pdb" /Gd /analyze- /errorReport:queue

*示例 2010 警告和错误*

```
1>wxbase29ud.lib(ipcbase.obj) : warning LNK4049: locally defined symbol ??1?$basic_string@_WU?$char_traits@_W@std@@V?$allocator@_W@2@@std@@QAE@XZ (public: __thiscall std::basic_string<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> >::~basic_string<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> >(void)) imported

1>wxbase29ud.lib(mimecmn.obj) : error LNK2001: unresolved external symbol "__declspec(dllimport) public: class std::basic_string<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> > & __thiscall std::basic_string<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> >::assign(class std::_String_const_iterator<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> >,class std::_String_const_iterator<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> >)" (__imp_?assign@?$basic_string@_WU?$char_traits@_W@std@@V?$allocator@_W@2@@std@@QAEAAV12@V?$_String_const_iterator@_WU?$char_traits@_W@std@@V?$allocator@_W@2@@2@0@Z) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:35:07.020

您绝对**必须**使用相同版本的编译器构建 wxWidgets 和使用它的应用程序，不同的 MSVC 版本使用不同的、不兼容的 CRT 版本，因此您根本没有机会使用 VC10 构建应用程序并将其链接到用 VC9 构建的 wxWidgets。

至于用VC10自己构建wx，在导入VC9项目时确实有时会出现一些问题，自定义构建规则会莫名其妙地被破坏。如果发生这种情况（尽管 AFAIK 还没有人报告 wx 2.9.4 项目文件），只需手动复制自定义构建规则`setup.h`或手动执行它们。

FWIW 我们希望在 3.0 版本（即将推出）中拥有“原生”VC10 和 VC11 项目。

# ios - 如何在后台使用地理围栏方法

> ID：12338684
> 
> 赞同：3
> 
> 时间：2012-09-09T11:28:59.840
> 
> 标签：ios, core-location, geofencing

我正在尝试制作一个应用程序，当他进入某个区域时通知用户。我在应用程序处于活动状态时做到了，但我不知道如何在后台进行。任何人都可以帮助我吗？
这是我使用的代码：

```
self.locationManager = [[[CLLocationManager alloc] init] autorelease];
locationManager.delegate = self;

locationManager.desiredAccuracy=kCLLocationAccuracyBestForNavigation;

[locationManager startUpdatingLocation];

if ([CLLocationManager regionMonitoringAvailable] && [CLLocationManager regionMonitoringEnabled])
{ 

     loc = CLLocationCoordinate2DMake(30.794686, 31.012309);
     alslamMosque =[[CLRegion alloc]initCircularRegionWithCenter:loc radius:10 identifier:@"alslam"];

     CLLocationAccuracy acc = kCLLocationAccuracyNearestTenMeters;

    [locationManager startMonitoringForRegion:alslamMosque desiredAccuracy:acc];
     [locationManager startMonitoringSignificantLocationChanges];
}

- (void)locationManager:(CLLocationManager *)manager didEnterRegion:(CLRegion *)region
{ 
    UIAlertView *alr=[[UIAlertView alloc] initWithTitle:[NSString stringWithFormat: @"you've enterd region and you are %f meters from",dd]  
                                            message:region.identifier delegate:nil cancelButtonTitle:nil otherButtonTitles:@"Ok",nil];

    [alr show];

    [alr release];
    NSLog(@"enter region");

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-14T22:59:39.260

这是您正在寻找的堆栈上的直接链接：

[带有本地通知（如提醒）的地理位置](https://stackoverflow.com/questions/9063627/geolocation-with-local-notification-like-reminder)

剪辑>

```
UILocalNotification *notification = [[UILocalNotification alloc] init]; 
notification.fireDate = [NSDate date]; 
NSTimeZone* timezone = [NSTimeZone defaultTimeZone]; 
notification.timeZone = timezone; 
notification.alertBody = @"Notification message"; 
notification.alertAction = @"Show"; 
notification.soundName = UILocalNotificationDefaultSoundName; 
[[UIApplication sharedApplication] scheduleLocalNotification:notification];
[notification release]; // release if not using ARC 
```

之后继续并确保您在 App Delegate 中处理通知

# ipad - 为 iPad 编写替换“应用程序启动器”/“主屏幕”

> ID：12338685
> 
> 赞同：3
> 
> 时间：2012-09-09T11:29:21.710
> 
> 标签：ipad, ios5

学校和企业有没有办法用定制的替代品替换 iPad“应用程序启动器”或“主屏幕”？

是否可以为 iOS 开发一个允许这样做的应用程序？还是 SDK 被锁定以防止开发此类应用程序。

非常感谢所有指针和见解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:54:53.387

您可以将加载屏幕从深黑色更改为图像，但不能更改 iOS 设备上应用程序菜单的布局。至少不是没有越狱。这是因为苹果不希望你编辑他们的菜单，让他们看起来很干净，或者看到他们的软件。

应用程序启动器不是应用程序的一部分，尽管它仍然主要由目标 c 中的可可制成，但它仍然是不同的，你仍然无法合法地访问它。因此，由于我不赞成越狱，而且我很确定大多数开发人员都会这样做，因此我建议您专注于您的应用程序，而不是已经运行良好的主菜单。

在此处查看[应用程序启动器定义。](http://gizmodo.com/5920312/what-is-an-app-launcher)

* * *

sdk 已完全锁定，但您仍然可以制作一个大应用程序，例如一个包含多个应用程序的应用程序框。该应用程序可以是基于网络的，无需更新应用程序即可获得更多访问权限，这意味着无需等待苹果批准更新。

另一种选择是，您可以制作免费的自定义应用程序，学生或任何人都可以轻松下载它们，但它们需要学生密码才能解锁。

**不要编辑操作系统，它可能永远对设备软件造成严重损害。**

# jquery - IE jquery 无法加载

> ID：12338688
> 
> 赞同：2
> 
> 时间：2012-09-09T11:30:02.347
> 
> 标签：jquery, wordpress, internet-explorer

我在一个 Wordpress 网站上工作，我遇到了 IE 问题。似乎它根本不加载 jQuery，因为所有 jQuery 函数都不起作用。它甚至搞砸了整个网站。它在 Chrome 和 FF 中看起来应该是这样，但 IE 确实把它搞砸了，并且没有任何动画和滑块工作。

更奇怪的是，当它只是一个带有 css 和一些 jquery 函数的普通 html 文件时，它工作得很好……因为我将它集成到 Wordpress 中，所以一切都搞砸了。以前有人遇到过这样的问题吗？请帮忙..也许这只是我没有看到的一个小错误或其他什么......

这是网站的链接[http://matoweb.com](http://matoweb.com)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T11:36:17.280

查看控制台 (F12) 以查看您遇到的错误：

```
 nextText: "Next",               
}); 
```

如果对象字面量不跟随另一个属性，IE 不支持在对象字面量中使用前导逗号。

# c# - 无法读取测试项目中的配置文件

> ID：12338690
> 
> 赞同：0
> 
> 时间：2012-09-09T11:30:25.907
> 
> 标签：c#, unit-testing, app-config

运行单元测试时，无法正确读取配置文件。但是，当从控制台应用程序上下文运行时，会读取配置文件。

在下面的代码中，在赋值后访问***var 部分***时，运行测试 TestIoCInit() 时为空，从控制台应用程序调用 InitIoC() 时不为空。

```
 [TestMethod]
    public void TestIocInit()
    {
        InitIoC();
    }
    internal static void InitIoC()
    {
        IUnityContainer unityContainer = new UnityContainer(); // the host app domain creates the unity container and pass it to the resolver, the resolver is a static member of IoC class, thus the container is static

        ServiceLocator.SetLocatorProvider(unityContainer);

        var section = (UnityConfigurationSection)ConfigurationManager.GetSection("unity");
        section.Configure(unityContainer);

        var unityResolver = new UnityDependencyResolver(unityContainer);
        IoC.Initialize(unityResolver);
        new IoCTypeRegistrationTask(unityContainer).Execute();
    } 
```

感谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T15:37:20.797

或者，您可以添加一个构建后步骤，将正在测试的项目的 app.config 复制到测试项目的目录中（首先将 app.config 添加到测试项目 - 它将被项目中的 app.config 覆盖正在测试中）。这样，每次构建解决方案时，您都会获得一份复制到测试项目中的最新最好的 app.config 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T16:15:14.333

您可以使用 ClassInit 将缺少的资源（配置文件、非托管程序集、数据文件）从测试的 source/bin 目录复制到测试结果输出目录。

去做这个：

1.  从 textContext.DeploymentDirectory 开始，向上遍历目录，直到到达解决方案的目录（使用目录名称，而不是完整路径，因此它可以在其他机器上工作）。

    1.1。如果您没有到达它（如果测试正在构建服务器上运行），则仅上升到比“TestResults”高的一个目录，然后进入子目录“Sources”。

2.  使用相对于解决方案目录的路径计算测试项目的目录。

3.  从项目目录或 bin 复制所需资源（如果从 bin 复制，请不要忘记检查配置和平台）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T11:34:02.943

您是否尝试在测试项目的 bin 目录中复制配置文件。您应该将其重命名为

> Your_test_project_name.dll.config

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T06:48:05.383

我最终添加了一个新的类库项目，并向其中添加了 [TestClass] 属性。无需复制 app.config 文件即可完美运行。谢谢。

# c++ - C++11 风格的回调？

> ID：12338695
> 
> 赞同：38
> 
> 时间：2012-09-09T11:31:13.263
> 
> 标签：c++, c++11

我在一个类中有一个 void 函数。在旧的 C++ 中，我会制作一个静态函数，将类名作为参数，并拥有我自己的类，该类采用静态 void 函数 + void*，以便我轻松调用它。

然而，这感觉老派。它也不是模板化的，感觉我可以做更多。创建对 myclassVar.voidReturnVoidParamFunc 的回调的更现代的方法是什么

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-09-09T11:45:27.970

使用[`std::function`和 lambdas (or `std::bind()`)](http://en.cppreference.com/w/cpp/utility/functional)来存储可调用对象：

```
#include <functional>
#include <iostream>

class Test
{
public:
      void blah() { std::cout << "BLAH!" << std::endl; }
};

class Bim
{
public:
      void operator()(){ std::cout << "BIM!" << std::endl; }
};

void boum() { std::cout << "BOUM!" << std::endl; }

int main()
{
    // store the member function of an object:
    Test test;  
    std::function< void() > callback = std::bind( &Test::blah, test );
    callback();

    // store a callable object (by copy)
    callback = Bim{};
    callback();

    // store the address of a static function
    callback = &boum;
    callback();

    // store a copy of a lambda (that is a callable object)
    callback = [&]{ test.blah(); }; // often clearer -and not more expensive- than std::bind()
    callback();
} 
```

结果：

> 废话！
> 
> 建筑信息模型！
> 
> 砰！
> 
> 废话！

编译运行：http: [//ideone.com/T6wVp](http://ideone.com/T6wVp)

`std::function`可以用作任何可复制的对象，因此可以随意将其作为回调存储在某个地方，例如在对象的成员中。这也意味着您可以自由地将其放入标准容器中，例如`std::vector< std::function< void () > >`.

另请注意，等效的[boost::function 和 boost::bind](http://www.boost.org/doc/libs/1_51_0/doc/html/function.html)已经存在多年了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-05-15T02:31:28.587

有关使用 Lambda 和向量将参数传递给 C++ 11 回调的示例，请参阅[http://ideone.com/tcBCeO](http://ideone.com/tcBCeO)或以下内容：

```
class Test
{
public:
      Test (int testType) : m_testType(testType) {};
      void blah() { std::cout << "BLAH! " << m_testType << std::endl; }
      void blahWithParmeter(std::string p) { std::cout << "BLAH1! Parameter=" << p << std::endl; }
      void blahWithParmeter2(std::string p) { std::cout << "BLAH2! Parameter=" << p << std::endl; }

      private:
         int m_testType;

};

class Bim
{
public:
      void operator()(){ std::cout << "BIM!" << std::endl; }
};

void boum() { std::cout << "BOUM!" << std::endl; }

int main()
{
    // store the member function of an object:
    Test test(7);  
    //std::function< void() > callback = std::bind( &Test::blah, test );
    std::function< void() > callback = std::bind( &Test::blah, test );
    callback();

    // store a callable object (by copy)
    callback = Bim{};
    callback();

    // store the address of a static function
    callback = &boum;
    callback();

    // store a copy of a lambda (that is a callable object)
    callback = [&]{ test.blah(); }; // might be clearer than calling std::bind()
    callback();

    // example of callback with parameter using a vector
    typedef std::function<void(std::string&)> TstringCallback;

    std::vector <TstringCallback> callbackListStringParms;
    callbackListStringParms.push_back( [&] (const std::string& tag) {     test.blahWithParmeter(tag); }); 
    callbackListStringParms.push_back( [&] (const std::string& tag) { test.blahWithParmeter2(tag); }); 

    std::string parm1 = "parm1";
    std::string parm2 = "parm2";
    int i = 0;
    for (auto cb : callbackListStringParms ) 
    {
        ++i;
        if (i == 1)
            cb(parm1);
        else
            cb(parm2);

    }
} 
```

# c++ - 如何更改位于类中的对象向量中的对象变量的值？

> ID：12338696
> 
> 赞同：0
> 
> 时间：2012-09-09T11:31:18.210
> 
> 标签：c++

我正在摆脱我的常规领域来做到这一点，而且我遇到了一些愚蠢的复杂情况。我已经声明了一个具有变量“int activacion”的类，然后我创建了另一个具有前一种类型对象向量的类。然后我做了另一个类，它有一个最新的向量。如果我无法继续，我会发现它完全正常，但问题是我在使用 getValue() 读取值时没有遇到问题，而且我似乎无法使用同一行更改它带有 setValue() 的代码；

```
getElementoVectorCapas(i).getElementoVectorNeuronas(j).getActivacion()<<endl; 
```

这行得通。

```
getElementoVectorCapas(1).getElementoVectorNeuronas(0).setActivacion(1); 
```

这没有。这就像价值是固定的。它可以编译，它只是不改变值。提前致谢。我只剪切并粘贴了似乎相关的部分。仅在签名上添加 & 符号不会让我编译。

```
class CNeurona{
  private:      
      int activacion;
  public:
     void setActivacion(int x){
            activacion = x;
            }
       int getActivacion(){
           return activacion;
 }
 };  
 class CCapa{
  private:          
      std::vector<CNeurona> vectorNeuronas;
  public:
         CCapa(int i_numNeuronas, int i_numeroInputsPorNeurona){
             setNumNeuronas(i_numNeuronas);
             for(c=0;c<i_numNeuronas;c++){                        
                    vectorNeuronas.push_back(CNeurona(i_numeroInputsPorNeurona));                   
                   }             
             }                 
         CNeurona getElementoVectorNeuronas(int x){
                return vectorNeuronas[x];
                }
};
   class CRed{
  private:              
          std::vector<CCapa> vectorCapas;
 public:
 void setVectorEntrada(){                 

              for(j=0;j<numNeuronasEntrada;j++){
                   cout<<"Introduce activaciones de capa de entrada, N"<<j<<": "<<endl;
                   cin >> i;       
getElementoVectorCapas(0).getElementoVectorNeuronas(j).setActivacion(i);                                          
                   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T13:25:54.093

```
CNeurona getElementoVectorNeuronas(int x) 
```

返回向量中对象的**副本。**`CNeurona`你打电话时

```
getElementoVectorNeuronas(j).setActivacion(i); 
```

您在对象的**副本**上调用该`setActivation`方法，由 返回，该**副本**随后被丢弃。**`CNeurona``getElementoVectorNeuronas`**

 ****您需要改用参考；你的功能应该是

```
CNeurona& getElementoVectorNeuronas(int x) 
```

如果`getElementoVectorCapas`也返回一个副本 - 在你的情况下这是一个错误，它应该返回一个引用。****

# sql-server - 无法执行 COMPUTE 语句

> ID：12338697
> 
> 赞同：12
> 
> 时间：2012-09-09T11:31:35.917
> 
> 标签：sql-server, database, tsql, sql-server-2012

我正在尝试在 Northwind 数据库上执行这个简单的语句

```
USE Northwind
SELECT  productid, orderid,quantity 
FROM [order details]
ORDER BY productid, orderid
COMPUTE SUM(quantity)
GO 
```

但是我这不能执行，我得到了这个错误

> *消息 156，级别 15，状态 1，第 5 行
> 关键字“计算”附近的语法不正确。*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-09T20:13:19.627

[SQL Server 2012 不再支持](http://msdn.microsoft.com/en-us/library/ms144262.aspx)COMPUTE 子句。文档建议改用[ROLLUP](http://msdn.microsoft.com/en-us/library/ms177673.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-14T20:35:30.993

简单的计算方法：

```
Select columnname, count(*)
From tablename
Group by columnname
Order by columnname
Select 'SUM' , COUNT(columnname) from tablename 
```

# iphone - 使用我的应用程序首次启动时未显示推送通知警报视图的用户同意

> ID：12338699
> 
> 赞同：0
> 
> 时间：2012-09-09T11:32:09.810
> 
> 标签：iphone, push-notification

在我的应用程序中，我创建了一个启用推送通知的开发配置文件，并通过添加代码使其工作

```
[application registerForRemoteNotificationTypes:  UIRemoteNotificationTypeBadge|UIRemoteNotificationTypeAlert]; 
```

在我的应用程序中`-(BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`

推送通知工作正常。问题是：我第一次在我的设备上运行我的应用程序时，应该有一个警报视图来询问用户是否允许推送通知。但是这个警报选项没有显示，我已经从我的 iphone 中删除了我的应用程序并重新安装了很多次，第一次运行时从来没有时间显示这个警报视图，应用程序只是直接注册推送通知。

如应用审核指南中所述： 5.3 未经用户同意就发送推送通知的应用将被拒绝。由于这个问题，我的应用程序将被拒绝。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T13:33:52.647

请检查以下条件：

1.  您可以在代码中使用“[UIApplication sharedApplication]”，而不是使用“应用程序”。

    例如：-

    [[UIApplication sharedApplication] registerForRemoteNotificationTypes: (UIRemoteNotificationTypeAlert | UIRemoteNotificationTypeBadge | UIRemoteNotificationTypeSound)];

2.  它通常发生在苹果设备上，如果您单击允许通知确认并且虽然您删除了该应用程序，但下次它不会要求确认（不显示通知警报）。但这仅发生在开发配置文件的情况下。如果您从应用商店（使用分发配置文件）安装应用程序，每次安装后都会要求确认。

3.  还要检查您正在测试通知的设备的设置，通知中心应始终为通知“打开”。

# php - isset 复选框返回空代码点火器

> ID：12338701
> 
> 赞同：0
> 
> 时间：2012-09-09T11:32:18.933
> 
> 标签：php, codeigniter

我试图在这段代码中为我的复选框（1 = 选中或 0 = 未选中）获取值（这是我在 Code Igniter 中的视图）：

```
<input type="checkbox" name="Visible" class="text" value="1"
                <?php $visible = isset($_POST['Visible'])? '1' : '0';?>/> 
```

我的问题是：

1.  有人可以向我解释为什么 $visible 的结果总是 NULL 吗？
2.  在这种情况下的功能是什么`value="1"`？我正在搜索这个案例，但人们只是说我们总是需要添加价值。
3.  如何获得正确的值？（1 = 选中或 0 = 未选中）

谢谢，我知道这是一个非常简单的问题，但自昨天以来一直给我一些错误@_@

**这是代码的较大部分：** 添加功能用于保存（在控制器中）：

```
function add(){

    $data['title'] = 'Tambah Category baru';
    $data['action'] = site_url('category/add');
    $data['link_back'] = anchor('category/index/', 'Back to Category list', array('class'=>'back'));

    //bedakan add/update
    $data['validate'] = 'add';

    $this->_set_rules();
    //run validation
    if($this->form_validation->run() == false){
        $data['message'] = '';

        $data['title'] = 'Add new Category';
        //$data['message'] = '';
        $data['category']['ID_category'] = '';
        $data['category']['ID_user'] = '';
        $data['category']['Nama_category'] = '';
        $data['category']['Description'] = '';
        $data['category']['Visible'] = '';
        $data['link_back'] = anchor('category/index/', 'Lihat daftar Category', array('class'=>'back'));

        $this->load->view('category_form_v', $data);
    }

    else{
        //save data
        $category = array('ID_category'=>$this->input->post('ID_category'),
        'ID_user'=>'TESTING USER',
        'Nama_category'=>$this->input->post('Nama_category'),
        'Description'=>$this->input->post('Description'),
        'Visible'=>($$this->input->post('Visible') !== false ? '1' : '0'),
        'tgl_buat '=>date('Y-m-d H:i:s'));

        $ID_category = $this->category_m->save($category);

        $this->validation->ID_category = $ID_category;

        redirect('category/index/add_success');
    }
} 
```

还有我的 HTML 代码（在视图中）：

```
<td valign="top">Visible<span style="color:red;">*</span></td>
                <td><input type="checkbox" name="Visible" class="text"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T11:37:43.843

请改用[输入库](http://codeigniter.com/user_guide/libraries/input.html)。

特别是 post 功能

```
$visible = ($this->input->post('Visible') !== false ? 1 : 0); 
```

* * *

## 问题更新后更新

```
function add(){

    $data['title'] = 'Tambah Category baru';
    $data['action'] = site_url('category/add');
    $data['link_back'] = anchor('category/index/', 'Back to Category list', array('class'=>'back'));

    //bedakan add/update
    $data['validate'] = 'add';

    $this->_set_rules();
    //run validation
    if($this->form_validation->run() == false){
        $data['message'] = '';

        $data['title'] = 'Add new Category';
        //$data['message'] = '';
        $data['category']['ID_category'] = '';
        $data['category']['ID_user'] = '';
        $data['category']['Nama_category'] = '';
        $data['category']['Description'] = '';
        $data['category']['Visible'] = '';
        $data['link_back'] = anchor('category/index/', 'Lihat daftar Category', array('class'=>'back'));

        $this->load->view('category_form_v', $data);
    }

    else{
        //save data
        $category = array('ID_category'=>$this->input->post('ID_category'),
        'ID_user'=>'TESTING USER',
        'Nama_category'=>$this->input->post('Nama_category'),
        'Description'=>$this->input->post('Description'),
        'Visible'=>($this->input->post('Visible') !== false ? '1' : '0'),
        'tgl_buat '=>date('Y-m-d H:i:s'));

        $ID_category = $this->category_m->save($category);

        $this->validation->ID_category = $ID_category;

        redirect('category/index/add_success');
    }
} 
```

# asp.net-mvc - ASP.NET MVC：post-redirect-get 模式，具有两个重载的操作方法

> ID：12338704
> 
> 赞同：4
> 
> 时间：2012-09-09T11:33:47.960
> 
> 标签：是否可以在asp.net-mvc, asp.net-mvc, asp.net-mvc, model-view-controller, design-patterns, web-applications, post-redirect-get

[是否可以在asp.net-mvc](/questions/tagged/asp.net-mvc "显示标记为“asp.net-mvc”的问题")中使用两个重载的操作方法（一个用于 GET 操作，另一个用于 POST 操作）实现 post-redirect-get 模式。

在所有 MVC post-redirect-get 模式示例中，我看到了 post-redirect-get 过程的三种不同的操作方法（对应于 Initial Get、Post 和 Redirection Get），每种方法都有不同的名称。这真的需要在[asp.net-mvc](/questions/tagged/asp.net-mvc "显示标记为“asp.net-mvc”的问题")中具有至少三个不同名称的操作方法吗？

例如：（下面显示的代码是否遵循 Post-Redirect-Get 模式？）

```
public class SomeController : Controller
{
    // GET: /SomeIndex/
    [HttpGet]
    public ActionResult Index(int id)
    {
        SomeIndexViewModel vm = new SomeIndexViewModel(id) { myid = id };
        //Do some processing here
        return View(vm);
    }

    // POST: /SomeIndex/
    [HttpPost]
    public ActionResult Index(SomeIndexViewModel vm)
    {
        bool validationsuccess = false;
        //validate
        if (validationsuccess)
            return RedirectToAction("Index", new {id=1234 });
        else
            return View(vm);
        }
    }
} 
```

谢谢你的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T10:43:10.147

从单元测试的角度思考。

如果一切都在一个动作中，那么代码将很难测试和阅读。我认为您的代码没有任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T16:53:37.693

你的代码对我来说似乎很好。遵循模式，这就是我们在所有项目中的做法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T17:05:35.323

如果您有相同的操作名称，那么您应该区分哪个操作是 GET，哪个是 POST。此外，您的方法签名必须不同以避免编译错误。

这两个“要求”在您的代码中都可以，因此在 PRG 中使用这些操作没有问题。

# ssl - .arm 和 .csr 文件 (SSL) 之间的区别

> ID：12338705
> 
> 赞同：1
> 
> 时间：2012-09-09T11:33:49.333
> 
> 标签：ssl, keytool

我正在生成两个 CSR（证书签名请求）

1\. 使用 java keytool 我得到一个 .csr 格式的文件。

1.  使用 IBM 密钥管理工具我得到 .arm 文件。

尽管这两个文件都包含相同类型的数据（即，base64 编码的公钥详细信息）

我的问题“我可以将 .csr 文件重命名为 .arm”会不会是一样的......

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T06:30:53.283

CSR 最常见的语法是[PKCS#10](https://www.rfc-editor.org/rfc/rfc2986)，可以用二进制或文本格式表示。CSR 包含许多信息，包括：公钥、主题专有名称、签名和可选属性。如果您可以在文本编辑器中查看文件并且它们看起来类似于以下内容：

> ```
> -----BEGIN CERTIFICATE REQUEST-----
> MIIBnTCCAQYCAQAwXTELMAkGA1UEBhMCU0cxETAPBgNVBAoTCE0yQ3J5cHRvMRIw
> EAYDVQQDEwlsb2NhbGhvc3QxJzAlBgkqhkiG9w0BCQEWGGFkbWluQHNlcnZlci5l
> eGFtcGxlLmRvbTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAr1nYY1Qrll1r
> uB/FqlCRrr5nvupdIN+3wF7q915tvEQoc74bnu6b8IbbGRMhzdzmvQ4SzFfVEAuM
> MuTHeybPq5th7YDrTNizKKxOBnqE2KYuX9X22A1Kh49soJJFg6kPb9MUgiZBiMlv
> tb7K3CHfgw5WagWnLl8Lb+ccvKZZl+8CAwEAAaAAMA0GCSqGSIb3DQEBBAUAA4GB
> AHpoRp5YS55CZpy+wdigQEwjL/wSluvo+WjtpvP0YoBMJu4VMKeZi405R7o8oEwi
> PdlrrliKNknFmHKIaCKTLRcU59ScA6ADEIWUzqmUzP5Cs6jrSRo3NKfg1bd09D1K
> 9rsQkRc9Urv9mRBIsredGnYECNeRaK5R1yzpOowninXC
> -----END CERTIFICATE REQUEST----- 
> ```

那么它们是文本（又名 PEM）编码的 CSR。可以使用以下 openssl 命令对这些文本编码的 CSR 进行解码和查看：

```
openssl req -in your-csr-filename -noout -text 
```

重命名文件不会影响 openssl 解码它们的能力。但是，一些处理 CSR 的应用程序可能需要特定的文件扩展名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T21:54:56.710

您可以通过以下命令使用 OpenSSL 检查您的证书签名请求 (csr)：

```
openssl x509 -req -in yourfile.csr -text -noout 
```

我假设 IBM 的东西是 openssl 的包装器，所以我希望你的 .arm 是一个使用不同名称的 x509 证书。有兴趣听听你得到什么......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T19:29:59.460

答案是肯定的。.arm 文件的格式与 .csr 相同。正如您所说，它们都包含相同类型的数据，因此可以简单地重命名。此外，常见的 CSR 请求类型是 PKCS#10 和 PKCS#12。

@snow60y：'openssl x509 -req -in yourfile.csr -text -noout' 你不会看到任何东西，因为 CSR 中没有包含私钥并且没有签名，所以它还不是 x509。CSR 永远不应包含私钥，因此，使用该命令进行分析应该会失败。您可以使用带有签名证书的命令，​​但不能使用请求。对于请求，请使用：

```
openssl req -in your-csr-filename -noout -text 
```

# qt - qt 4.8.2 qpa QGraphicsView ( QGLWidget ) 渲染产生黑屏

> ID：12338706
> 
> 赞同：3
> 
> 时间：2012-09-09T11:33:51.573
> 
> 标签：qt, opengl-es, lighthouse

我正在尝试渲染一些简单的 qt 应用程序，它在 ( )`QGraphicsView`上 `QGLWidget`用作`viewport`( 稍作修改的 collidingmice )。像这样启动应用程序：`armv7 embedded platform``beagleboard`

```
collidingmice -platform eglfs 
```

但屏幕总是保持黑暗。（纹理示例工作正常）。qt lighthouse 是否能够使用像 elgfs 这样的平台通过 opengles 渲染绘画？我找不到任何关于它的确切信息。
提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:50:10.377

我只是看看[这里](http://qt.gitorious.org/qt/qt/blobs/4.8/src/plugins/platforms/eglfs/qeglfsscreen.cpp)的来源。驱动程序不会对您的 Windows 系统做出任何假设，因此它使用 0 作为默认的本机窗口句柄，这通常是正确的。您的平台可能并非如此。您必须修改源，以便为函数 eglCreateWindowSurface 传递一个有效的本机窗口句柄。我怀疑这可能是黑屏的原因。

编辑：我不知道 libpvrPVR2D_FRONWSEGL.so 库到底是做什么的，但根据名称可能会在帧缓冲区上提供本机窗口。阅读该库的手册。

EDIT2：该库实际上提供了窗口系统。看这里： http: [//processors.wiki.ti.com/index.php/SGXDbg](http://processors.wiki.ti.com/index.php/SGXDbg)。您也可以使用 Qt Embedded 而不是 Qt QPA，因为 PowerVR 有一个工作驱动程序：http: [//qt.gitorious.org/qt/qt/trees/4.8/src/plugins/gfxdrivers/powervr](http://qt.gitorious.org/qt/qt/trees/4.8/src/plugins/gfxdrivers/powervr)。

# django - 在 Django 中呈现（和验证）相关的选择表单字段

> ID：12338709
> 
> 赞同：1
> 
> 时间：2012-09-09T11:34:06.587
> 
> 标签：django, django-forms

我正在尝试找出在 django 中实现表单的最佳方法，该表单上有两个选择字段，其中一个会影响另一个中可用的选择。一个例子——表单域第一个是一个单选按钮（只能选择一个选项），叫做“cuisine”，第二个是一个多选域，叫做“menu”。如果您从“cuisine”中选择“french”，那么您会在菜单列表中看到法国菜，但如果您选择“chinese”，您会得到不同的选择。

我如何在表单验证过程中使用此服务器端。如何“绑定”这两个控件，以便只接受与美食选项相关的菜肴？

以及如何呈现这个 - 我应该为每种类型的美食传递一个 ModelForm，还是有一个包含所有内容的菜单 ModelForm，并在客户端显示/隐藏内容？

所有菜单选项都存储在数据库中并作为固定装置加载，并且美食被硬编码到应用程序中：

```
CUISINE = ((0,'French'),(1,'Chinese'),(2,'Italian'))

class MenuItem(models.Model):
    description = models.CharField(max_length=200)
    cuisine = models.IntegerField('Cuisine', choices=CUISINE) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T12:47:56.937

1.  **对于渲染**，您可以使用[django-selectable](http://django-selectable.readthedocs.org/en/version-0.5.2/advanced.html#chained-selection)或[django-autocomplete-light](http://django-autocomplete-light.readthedocs.org/en/latest/dependant.html)，

2.  **对于服务器端验证**，django 有[完整的文档记录](https://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-and-validating-fields-that-depend-on-each-other)。

# java - 悬停注释时更改鼠标悬停图标

> ID：12338710
> 
> 赞同：-1
> 
> 时间：2012-09-09T11:34:24.157
> 
> 标签：java, itext, pdf-annotations

我正在创建的 pdf 文件中使用 PdfAnnotaion 添加指向附件的链接。

我如何更改鼠标的光标，以便当它悬停链接（PdfAnnotation）时，光标会变成像手一样的东西，所以用户会知道他可以按下它？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T11:12:46.453

您在谈论*可移植*文档格式，要求提供依赖于操作系统或 PDF 查看应用程序的功能。这是一个矛盾。

在 PDF 中，当鼠标光标悬停在注释上时，您可以更改注释的外观，但您无权访问应用程序或操作系统来更改光标。由于 ISO-32000-1 中没有定义此类光标的值，因此 PDF 不可能知道任何给定操作系统上的任何给定查看器是否支持手形光标。

简而言之：您要求的是不可能的事情。

# c++ - ERROR_ACCESS_DENIED 设置文件所有者

> ID：12338711
> 
> 赞同：1
> 
> 时间：2012-09-09T11:34:26.720
> 
> 标签：c++, winapi, ntfs, file-security

我正在尝试在 C++ 中以编程方式将文件的所有者设置为另一个用户。

我已经为我的流程启用了`SeRestorePrivilege`。我可以使用 Process Explorer 确认这一点。我启动进程，它被禁用，我运行我的代码来启用它，ProcExp 将它报告为启用，我一直到要设置所有者的点，它仍然是启用的（即我不是不小心禁用了它）。

此访问被拒绝消息还有什么其他原因？我没有考虑什么？

```
std::wstring fileSystemObject = L"C:\test.txt";
*status_code = SetNamedSecurityInfo((wchar_t*)fileSystemObject.c_str(), SE_FILE_OBJECT, OWNER_SECURITY_INFORMATION, pSID, NULL, NULL, NULL);
if (*status_code == ERROR_SUCCESS)
{
    Log(L"Successfully set owner for " + fileSystemObject);
    return true;
}
else
{
    Log(L"Failed to set owner for " + fileSystemObject + L". Error code: ", *status_code);
    return false;
} 
```

谢谢你。

**编辑：**非常感谢您的持续帮助。非常感谢。

我将您的代码用于以下所有测试。基本上，我也从您的代码中收到拒绝访问消息，但是，我已经对其进行了更多跟踪。

首先，“C:\test.txt”不是我真正的代码，不幸的是缺少的反斜杠不是我的问题的原因。不过谢谢你敏锐的眼睛：）

另外，我正在运行禁用 UAC 的管理员帐户，并且我的程序在清单中设置了 requireAdministrator 。

但是，我注意到我的代码和您的代码都适用于简单文件。经过大量测试，我发现我只在以下情况下收到 AccessDenied 消息：

1：我不是所有者，并且“Take Ownership”权限设置为拒绝，例如所有人。

2：我是所有者，并且“Take Ownership”权限设置为拒绝，例如所有人。奇怪的是，在第二个实例中，尽​​管出现了故障代码，但所有权更改确实发生了。

我不明白为什么会这样。我和你已经在进程令牌中设置了 SE_RESTORE_NAME。我应该被允许任意设置所有者 SID。但好像我做不到。

似乎对 TakeOwnership DACL 的任何拒绝都会覆盖我获得所有权的能力。但是，在获得所有权之前，我无法更改权限！*叹息*。

我可能会尝试按照您最初的建议设置 SeTakeOwnershipPrivilege，将所有权归于自己，更改权限，在外部设置所有权。多么痛苦。而且我什至不是很有信心它会起作用。

我还发现了这个：[http ://us.generation-nt.com/setnamedsecurityinfo-failing-rc-1307-help-59729462.html](http://us.generation-nt.com/setnamedsecurityinfo-failing-rc-1307-help-59729462.html)

他似乎处于类似的情况（如果我没有正确设置进程令牌，我会得到 1307）。但是 CreatePrivateObjectSecurityEx 需要进行更多设置。

嗯。谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T17:17:27.197

这里的问题是安全子系统和模型正在保护对象免受不合理的所有权更改，甚至需要拥有管理员权限才能正确克服障碍。

获取文件的所有权涉及两个特权：`SE_TAKE_OWNERSHIP_NAME`和`SE_RESTORE_NAME`. 前者允许获取某人的对象，后者允许设置不是设置者本人的所有者。

它可能看起来`SE_RESTORE_NAME`是一个更强大的特权并且足以完成任务，但它似乎不是。是的，它允许设置某人的所有权，[正如 MSDN 所述](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379579%28v=vs.85%29.aspx)：

> 如果调用者没有 SeRestorePrivilege 常量（请参阅 Privilege Constants），则此 SID 必须包含在调用者的令牌中，并且必须启用 SE_GROUP_OWNER 权限。SecurityInfo 参数必须包含 OWNER_SECURITY_INFORMATION 标志。要设置所有者，调用者必须对对象具有 WRITE_OWNER 访问权限或启用 SE_TAKE_OWNERSHIP_NAME 权限。

但是，它不会让您克服明确阻止所有权更改的 DACL 项。在这种情况下，您还需要其他特权（即，您需要同时启用两者），这使您能够在决定将其授予谁之前从某人那里获得所有权。

我正在从上面的评论中复制指向 C++/ATL 源代码的链接：[SetFileOwner.cpp](http://www.alax.info/trac/public/browser/trunk/Utilities/Miscellaneous/SetFileOwner/SetFileOwner.cpp#L36)。当权限/DACL 具有拒绝项时，会发生异常，启用第二个权限可以解决问题。

# c++ - c++ 全局变量

> ID：12338712
> 
> 赞同：3
> 
> 时间：2012-09-09T11:34:37.730
> 
> 标签：c++, windows, linker, global-variables

我有一个头文件`global.h`，我在其中声明了一些我打算在其他文件中使用的变量。

```
#ifndef GLOBAL_H_
#define GLOBAL_H_

#include <stdio.h>

typedef struct tag_KG_Data
{
   int nKGStationID;
   int nKGComPort;

 }GLOBAL_VAR;

 GLOBAL_VAR g_GlobalVar;

 BOOL b_newDataReady;
 BOOL b_startedSocketClient;

#endif 
```

起初我只`GLOBAL_VAR g_GlobalVar`在文件`test1.cpp`中声明`extern GLOBAL_VAR g_GlobalVar;`，并且工作得很好。然后我声明了 2`BOOL`并在其中使用了它们`test2.cpp`，但是我得到了一个`error LNK2005: "struct tag_KG_Data g_GlobalVar" (?g_GlobalVar@@3Utag_KG_Data@@A) already defined in test1.obj`并且对于我拥有的每个全局变量，我都会得到一个类似的错误。问题是我不使用`GLOBAL_VAR g_GlobalVar`in`test2.cpp`或任何`BOOL`s in `test1.cpp`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-09T11:37:03.843

这是因为您在标头中*定义*全局变量，而您应该只*声​​明*它们。

在您的全局定义前面添加`extern`，并在单个 cpp 文件中创建定义。

在标题中：

```
// Declarations
extern GLOBAL_VAR g_GlobalVar;
extern BOOL b_newDataReady;
extern BOOL b_startedSocketClient; 
```

在一个 cpp 文件中：

```
// Definitions
GLOBAL_VAR g_GlobalVar;
BOOL b_newDataReady;
BOOL b_startedSocketClient; 
```

# python - 具有动态功能的 Python 嵌套范围

> ID：12338713
> 
> 赞同：13
> 
> 时间：2012-09-09T11:34:37.500
> 
> 标签：python, name-binding

需要帮助理解[PEP 227](http://www.python.org/dev/peps/pep-0227/)和[Python 语言参考中的以下句子](http://docs.python.org/reference/executionmodel.html#interaction-with-dynamic-features)

> 如果在封闭范围内引用了变量，则删除该名称是错误的。编译器将为“del name”引发 SyntaxError。

缺少示例导致我无法在编译时重现错误，因此非常需要使用示例进行解释。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-09T11:45:23.737

以下引发了执行：

```
def foo():
    spam = 'eggs'
    def bar():
        print spam
    del spam 
```

因为该`spam`变量正在以下范围内使用`bar`：

```
>>> def foo():
...     spam = 'eggs'
...     def bar():
...         print spam
...     del spam
... 
SyntaxError: can not delete variable 'spam' referenced in nested scope 
```

Python 检测到它`spam`正在被引用，`bar`但没有为该变量分配任何东西，因此它在`foo`. 它*被*分配在那里，使`del spam`语句成为语法错误。

这个限制在 Python 3.2 中被移除；您现在有责任自己不删除嵌套变量；你会得到一个运行时错误（`NameError`）而不是：

```
>>> def foo():
...     spam = 'eggs'
...     def bar():
...         print(spam)
...     del spam
...     bar()
... 
>>> foo()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 6, in foo
  File "<stdin>", line 4, in bar
NameError: free variable 'spam' referenced before assignment in enclosing scope 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-09T11:46:29.907

一个例子可以是这个：

```
>>> def outer():
...     x = 0
...     y = (x for i in range(10))
...     del x
... 
SyntaxError: can not delete variable 'x' referenced in nested scope 
```

基本上这意味着您不能删除内部块中使用的变量（在这种情况下是 genexp）。

请注意，这适用于 python <= 2.7.x 和 python < 3.2。在 python3.2 中，它不会引发语法错误：

```
>>> def outer():
...     x = 0
...     y = (x for i in range(10))
...     del x
... 
>>> 
```

有关更改的全部内容，请参阅[此](http://bugs.python.org/issue4617)链接。

我认为 python3.2 语​​义更正确，因为如果你在函数之外编写相同的代码，它就可以工作：

```
#python2.7
>>> x = 0
>>> y = (x for i in range(10))
>>> del x
>>> y.next()     #this is what I'd expect: NameError at Runtime
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 1, in <genexpr>
NameError: global name 'x' is not defined 
```

将相同的代码放入函数中时，不仅会更改异常，而且会在编译时出现错误。

# ssh - 如何从仅允许端口 80 和 443 的本地计算机通过 ssh 连接到我的 EC2 实例？

> ID：12338716
> 
> 赞同：2
> 
> 时间：2012-09-09T11:35:00.940
> 
> 标签：ssh, amazon-ec2, amazon-web-services, firewall

我最近出演了 EC2。目前我正在使用免费层来测试和了解它。但是，由于我在仅允许端口 80 和 443 连接的代理后面，我无法连接 EC2 实例。有没有办法克服这个问题？

到目前为止，我猜想在 EC2 实例上运行 sslh，如此处所述[可能](https://stackoverflow.com/questions/410995/client-firewall-blocks-all-ports-but-80-and-443-need-away-to-forward-requets-on)会有所帮助。但是我不确定一旦实例终止并重新启动（因为我使用的是免费套餐），这种行为是否应该保持持续存在。有没有一种方法可以在使用免费层时在设置和已安装资源（如 sslh（和许多其他））方面实现持久性？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:45:52.013

有一次，在只允许在 80 等端口上进行传出通信的防火墙后面时，我只是在服务器上的另一个端口上运行了一个 sshd。您将无法在防火墙后面进行设置，您必须去其他地方，ssh in，然后重新配置 ssh。

除了在非标准端口上运行 sshd，您还可以将流量从其他端口重定向到端口 22。

如果您的 ec2 实例未运行 Web 服务器，您可以将端口 80 或 443 用于 sshd。如果您不使用 https，请使用 443。

您说他们只允许到远程端口 80 和 443 的传出流量，但通常 1024 以上的端口也被畅通。

确保您还在 ec2 实例上正确配置了安全组，因为它也有防火墙。您必须确保将其配置为允许从您的 IP 地址提供 sshd 的端口上的传入流量。这可以通过 aws 管理控制台完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T14:16:42.430

[这里](http://alestic.com/2010/12/ec2-ssh-port-80)有一个巧妙的解决方案。我没试过。这个想法是传递一个脚本来启动实例，并将 ssh 绑定到端口 80。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T03:12:28.677

转到正在运行的实例列表顶部的实例，您应该看到“实例操作”在该菜单中，您应该看到“连接”选择“使用 Java ssh 客户端从浏览器连接”

请注意，您需要安装 Java。

# ruby-on-rails - 无法访问多个项目 xml api wunderground

> ID：12338718
> 
> 赞同：0
> 
> 时间：2012-09-09T11:35:08.133
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我有这个代码：

模型：

```
class WeatherLookup 
    attr_accessor :temperature, :icon, :condition, :zip, :fcttext

    def fetch_weather(city)
      HTTParty.get("http://api.wunderground.com/api/api_key/forecast/lang:NL/q/IT/#{city.slug}.xml")
     end

    def initialize
      weather_hash = fetch_weather
    end

    def assign_values(weather_hash)
      hourly_forecast_response = weather_hash.parsed_response['response']['forecast']['txt_forecast']['forecastdays']['forecastday'].first 
      self.fcttext = hourly_forecast_response['fcttext']
      self.icon = hourly_forecast_response['icon_url']

   end

   def initialize(city)  
    @city = city
    weather_hash = fetch_weather(city)
    assign_values(weather_hash)
   end

end 
```

城市控制器：

```
@weather_lookup = WeatherLookup.new(@city) 
```

城市景观：

```
 = @weather_lookup.fcttext 
        = image_tag @weather_lookup.icon 
```

这项工作很好......我得到了 forecastdays 容器的第一个数据集。来自 api 的 xml 如下所示：

```
<response>
<version>0.1</version>
<termsofService>
http://www.wunderground.com/weather/api/d/terms.html
</termsofService>
<features>
<feature>forecast</feature>
</features>
<forecast>
<txt_forecast>
<date>2:00 AM CEST</date>
<forecastdays>
<forecastday>
<period>0</period>
<icon>clear</icon>
<icon_url>http://icons-ak.wxug.com/i/c/k/clear.gif</icon_url>
<title>zondag</title>
<fcttext>
<![CDATA[ Helder. Hoog: 86F. Light Wind. ]]>
</fcttext>
<fcttext_metric>
<![CDATA[ Helder. Hoog: 30C. Light Wind. ]]>
</fcttext_metric>
<pop>0</pop>
</forecastday>
<forecastday>
<period>1</period>
<icon>clear</icon>
<icon_url>http://icons-ak.wxug.com/i/c/k/clear.gif</icon_url>
<title>zondagnacht</title>
<fcttext>
<![CDATA[ Helder. Laag: 61F. Light Wind. ]]>
</fcttext>
<fcttext_metric>
<![CDATA[ Helder. Laag: 16C. Light Wind. ]]>
</fcttext_metric>
<pop>0</pop>
</forecastday>
<forecastday>
<period>2</period>
<icon>partlycloudy</icon>
<icon_url>http://icons-ak.wxug.com/i/c/k/partlycloudy.gif</icon_url>
<title>maandag</title>
<fcttext>
<![CDATA[ Gedeeltelijk bewolkt. Hoog: 84F. Light Wind. ]]>
</fcttext>
<fcttext_metric>
<![CDATA[ Gedeeltelijk bewolkt. Hoog: 29C. Light Wind. ]]>
</fcttext_metric>
<pop>20</pop>
</forecastday>
<forecastday>
<period>3</period>
<icon>clear</icon>
<icon_url>http://icons-ak.wxug.com/i/c/k/clear.gif</icon_url>
<title>maandagnacht</title>
<fcttext>
<![CDATA[ Gedeeltelijk bewolkt. Laag: 63F. Light Wind. ]]>
</fcttext>
<fcttext_metric>
<![CDATA[ Gedeeltelijk bewolkt. Laag: 17C. Light Wind. ]]>
</fcttext_metric>
<pop>0</pop>
</forecastday> 
```

我想通过循环访问预测容器中的所有预测，但是当我将 hourly_forecast 变量（.first）更改为 .all 或 none 时，我收到错误消息“无法将字符串转换为整数”

有人想解决这个问题吗？\

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T12:47:20.717

从**hourly_forecast**中删除**.first 后**，您现在将返回一个集合，而不是单个项目。这意味着您的视图将无法正常工作，因此您需要更新视图以呈现集合。这最好用部分来完成。

city_view 将变为：

```
= render partial: "weather_lookup", collection: @weather_lookup 
```

然后创建一个名为**_weather_lookup.html.haml**的部分并包括以下内容：

```
= @weather_lookup.fcttext 
        = image_tag @weather_lookup.icon 
```

部分文件名前面的下划线很重要，因为这是 Rails 约定，所以不要忽略它。查看时，将为集合中的每个项目多次呈现部分。

# php - php - 按键排序数组以匹配另一个数组的按键顺序

> ID：12338719
> 
> 赞同：11
> 
> 时间：2012-09-09T11:35:21.247
> 
> 标签：php, arrays, sorting

我有两个数组，它们都有相同的键（不同的值），但是数组 #2 的顺序不同。我希望能够使用第二个数组，使其与第一个数组的顺序相同。

有没有可以快速做到这一点的功能？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-09T11:44:41.900

我想不出任何想法，但是如果两个数组的键相同，那么为什么不循环第一个数组并使用其键顺序使用第二个数组的值创建一个新数组一？

```
$arr1 = array(
    'a' => '42', 
    'b' => '551',
    'c' => '512',
    'd' => 'gge',
) ;

$arr2 = array(
    'd' => 'ordered',
    'b' => 'is',
    'c' => 'now',
    'a' => 'this', 
) ;

$arr2ordered = array() ;

foreach (array_keys($arr1) as $key) {
    $arr2ordered[$key] = $arr2[$key] ;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-02-25T17:46:08.650

您可以使用[`array_replace`](http://php.net/manual/en/function.array-replace.php)

```
$arr1 = [
    'x' => '42',
    'y' => '551',
    'a' => '512',
    'b' => 'gge',
];

$arr2 = [
    'a' => '有序',
    'x' => '这个',
    'y' => '是',
    'b' => '现在',
];

$arr2 = array_replace($arr1, $arr2);

```

`$arr2`就是现在

```
[
    'x' => 这个，
    'y' => 是，
    'a' => 有序，
    'b' => 现在，

]

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T11:49:48.150

```
foreach(array_keys($array1) as $key)
{
  $tempArray[$key] = $array2[$key];
}
$array2 = $tempArray; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T12:31:48.017

我不完全确定这是否是你的追求。无论如何，只要数组保持相同的大小，这应该对你有用。

```
$gamey = array ("wow" => "World of Warcraft", "gw2" => "Guild Wars2", "wiz101" => "Wizard 101");
$gamex = array ("gw2" => "best game", "wiz101" => "WTF?", "wow" => "World greatest");

function match_arrayKeys ($x, $y)
{
    $keys    = array_keys ($x);
    $values  = array_values ($y);

    for ($x = 0; $x < count ($keys); $x++)
    {
        $newarray [$keys[$x]] = $y[$keys[$x]];
    }
    return $newarray;
}

print_r (match_arrayKeys ($gamey, $gamex)); 
```

输出

```
[wow] => World greatest
[gw2] => best game
[wiz101] => WTF? 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-09T11:41:54.057

试试这个
**代码**

```
$fruits = array("d"=>"lemon", "a"=>"orange", "b"=>"banana", "c"=>"apple");
ksort($fruits);
foreach ($fruits as $key => $val) {
    echo "$key = $val\n";
} 
```

**输出**

```
a = orange
b = banana
c = apple
d = lemon 
```

检查[php](http://php.net/manual/en/function.ksort.php)手册`ksort()`

# ruby-on-rails - 翻译数据库 rails 中的条目

> ID：12338720
> 
> 赞同：0
> 
> 时间：2012-09-09T11:35:21.413
> 
> 标签：ruby-on-rails, ruby, internationalization

在我们的应用程序中，**用户**可以创建一组类别。这些类别中的每一个都包含产品。**然后，客户**可以在网站上看到类别——目前只有一种语言。

我们想添加翻译，以便客户可以查看不同语言的数据。这意味着用户必须能够将翻译添加到实际数据中。

基于这个问题：[Rails I18n via database column](https://stackoverflow.com/questions/6700054/rails-i18n-via-database-column)我应该为每个语言环境添加几个数据库列。

有没有人解决过类似的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T12:36:40.683

我已经多次使用[globalize3](https://github.com/svenfuchs/globalize3)并且一直很喜欢它。也许它也可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T11:49:22.270

我有类似的要求，这一[集](http://railscasts.com/episodes/256-i18n-backends)对我有帮助。我没有更改语言，但我想随着每个国家/地区的货币变化而将一些货币参数外部化。这是我的示例应用程序[代码](https://github.com/ankit8898/translation-with-redis)

# ruby-on-rails - Rails 计算时差

> ID：12338721
> 
> 赞同：2
> 
> 时间：2012-09-09T11:35:23.950
> 
> 标签：ruby-on-rails, ruby

我试过这样的代码，但它不起作用：

```
require 'time_diff'

cur_time = Time.now.strftime('%Y-%m-%d %H:%M')
time_diff_components = Time.diff(@art.datetime_of_update, Time.parse(cur_time))
if  @art.PRICEM.to_f >= eprice.to_f || @art.PRICEM.blank? && time_diff_components[:hour] < 3 && 
```

但 timediff 为 0，在 db 时间看起来像这样：

> 2012-08-28 19:53:12

如何计算现在和db之间的小时差？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T11:41:55.847

首先，你应该看看这两行：

```
cur_time = Time.now.strftime('%Y-%m-%d %H:%M')
time_diff_components = Time.diff(@art.datetime_of_update, Time.parse(cur_time)) 
```

为什么要*格式化*时间，然后只使用该值作为解析操作的输入？当然，这样写会更简单——也更不脆弱——

```
time_diff_components = Time.diff(@art.datetime_of_update, Time.now) 
```

我不知道为什么`Time.diff`不适合你（我不是 Ruby 开发人员），但如果目的是检查文章是否在“不到 3 小时前”更新，那么有一个更简单的方法：减去三个小时从当前时间开始，并将文章的更新时间与该限制进行比较：

```
limit_time = Time.now + 3.hours
if @art.PRICEM.to_f >= eprice.to_f || @art.PRICEM.blank? && @art.datetime_of_update >= limit_time 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T15:17:19.140

如果你不需要精确，你可以使用 Rails 的`time_ago_in_words`助手。

```
time_ago_in_words(Time.now - 3.hours)
#=> about 3 hours 
```

当然，根据时差，这也可以返回“分钟”、“天”等。

# ruby-on-rails-3 - 如何从 url 中获取 url 参数

> ID：12338725
> 
> 赞同：0
> 
> 时间：2012-09-09T11:36:14.527
> 
> 标签：ruby-on-rails-3

我想获取如下所示的 url 参数。

```
http://localhost:3000/g/http://google.com 
```

所以，我设置 config/routes.rb 如下

```
get '/g/:url' => "urls#show" 
```

但我无法在 urls#show 中获取 params[:url]。

我怎样才能得到参数？

# html - 如何向 CSS 添加基于百分比的图像？（用于流体布局）

> ID：12338727
> 
> 赞同：0
> 
> 时间：2012-09-09T11:36:17.357
> 
> 标签：html, css

好的，所以我希望通过 CSS 选择一个基于流体的图像，但是，这是我遇到的问题。

这是我认为我必须做的事情，但是，它不起作用：

```
#image { background-image:pic.jpg; height:100%; width:100%; } 
```

但是，你不能让这个标签使用“height:100%;”，对吗？您必须将其设置为像素宽度。但是如果我希望它是流畅的..那么我不能将它设置为像素宽度，对吗？

还有另一种方法可以做到这一点吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:58:46.313

如果您的意思是我所想的“流体”（响应式设计的“流体”），那么将“最大宽度”设置为“100%”应该确保图像永远不会溢出其容器（或者换句话说，超过 100% 的宽度）。

```
img { max-width: 100%; } 
```

编辑：如果您的问题是使高度保持纵横比，请不要指定高度属性，或者如果您需要覆盖属性设置，请将高度也设置为自动（！重要）：

```
img { max-width: 100%; height: auto !important; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T12:19:38.127

如果你这样做，它将是流畅的：

**HTML：**

`<img src="http://news.bbcimg.co.uk/media/images/62777000/jpg/_62777247_62777242.jpg" alt="" />`

**CSS：**

​<code>img { 宽度：100%; }​</code>

[http://jsfiddle.net/7hMbQ/1/](http://jsfiddle.net/7hMbQ/1/)

或者如果你想将宽度和高度拉伸到 100%，试试这个（但比例不正确）：

[http://jsfiddle.net/7hMbQ/3/](http://jsfiddle.net/7hMbQ/3/)

# javascript - Javascript for 循环后的代码，Ajax 未执行

> ID：12338730
> 
> 赞同：0
> 
> 时间：2012-09-09T11:36:56.057
> 
> 标签：javascript, jquery

为什么这段代码末尾的“hello”警报没有执行？其他一切工作正常，但警报不会触发。我错过了什么？PS，我是 Javascript 的初学者...

```
$('.save_button').click(function(){
  var numItems = dataseries.length;
  var item;
  var sequence;
  var question = <%=@question.id%>;
  for (i=0;i<numItems;i++){
    var requestObj = {
      question_id: "<%=@question.id%>",
      user_id: "1",
    }
    item = $('.item_list li[data-seq='+i+']').attr('id');
    requestObj["item_id"] = item.toString();
    requestObj["x"]= dataseries[i][0][0];
    requestObj["y"]= dataseries[i][0][1];
    if (requestObj["item_id"]!="null"){
      var a = $.ajax({
        url: "<%=responses_path%>",
        data: requestObj,
        type: "POST",
        dataType: 'script',
        success: function(data, textStatus, jqXHR) {
        },
        error: function(jqXHR, textStatus, errorThrown) {
          alert('error!');
        },
        headers: {
          'X-CSRF-Token': '<%= form_authenticity_token.to_s %>'
        }
      });
    }
  }
  alert("hello");
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T12:17:04.837

问题出在 requestObj["item_id"] = item.toString();

在某些情况下，这是 null 并且它正在退出并出现错误。感谢所有回复的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T11:57:39.767

`var question = <%=@question.id%>;`应该是`var question = "<%=@question.id%>";`（一个字符串）。

我使用以下附加代码进行了尝试，效果很好：

```
<!-- HTML -->
<input type="button" class="save_button" value="Save" />
<ul class="item_list">
    <li id="item1" data-seq="0">item1</li>
    <li id="item2" data-seq="1">item2</li>
    <li id="item3" data-seq="2">item3</li>
</ul>​ 
```

* * *

```
// JS:
var dataseries = [
    [[1 /* x */, 2 /* y */]],
    [[2, 3]],
    [[3, 4]]
]; 
```

# phpmyadmin - 我想从表中选择最后一行。请看下面的表格结构

> ID：12338736
> 
> 赞同：0
> 
> 时间：2012-09-09T11:37:31.770
> 
> 标签：phpmyadmin

看起来像：

**表格1**

```
id   eid

1    49

2    49

3    50

4    51

5    50

6    52

7    53 
```

........ 等等

我的**第二个表**结构如下。（id与上面相同）

```
id    status

1     ok

2     v.good

3     fine

4     ok     

5     good

6     fine

7     v.good 
```

我想要所有开斋节的最新状态意味着 49 v.good 和 50 good 的当前状态等等....

请帮我写下这个查询。

thnks in adv。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T11:43:27.873

我将假设这是在 mysql 中完成的。如果是这种情况，那么类似

```
select * from yourtable where eid=yourvalue order by eid desc limit 1; 
```

# java - 你将如何构造一个 for 循环来找到每个这些数组的第一个索引的总和

> ID：12338739
> 
> 赞同：1
> 
> 时间：2012-09-09T11:37:49.830
> 
> 标签：java, loops, for-loop

```
 static final int[] HotDogdb = {30, 45, 44, 37,51};
    static final int[] ToastedChickendb = {25, 30, 45, 15,33};
    static final int[] ToastedSteakdb = {10, 15, 12, 16,17};
    static final int[] ToastedEggTdb = {14, 12, 17, 20,16};
    static final int[] ToastedSteakEdb ={5, 8, 3, 8,6};
    static final int[] ChickenRolldb = {27, 28, 23,20,21};
    static final int[] SteakRolldb = {19, 22, 23, 21,18};
    static final int[] EggTomatodb = {15, 16,10, 12,11};
    static final int[] CheeseTomatodb = {18, 19, 22, 21,20};
    static final int[] SteakEggdb = {10, 16, 13, 17,15};
    static final int[] tCheeseTomatodb = {23, 30, 27, 40,37};
    static final int[][] sales = new int[][] { HotDogdb, ToastedChickendb, ToastedSteakdb, ToastedEggTdb, ToastedSteakEdb,ChickenRolldb,SteakRolldb,EggTomatodb,CheeseTomatodb, SteakEggdb, tCheeseTomatodb }; 
```

所以基本上通过我到目前为止找到的 index @ 0 的总和

```
int total8 = 0;
int i;

for (i=0; i <= 11; i++){
total8 = total8 +  MyConstants.sales[i][0];}
                                jTextArea6.setText(""+total8); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:39:52.970

而不是`i <= 11`，使用`i < 11`：

```
for (i=0; i < 11; i++) { 
```

否则，您将得到一个`ArrayOutOfBoundsException`, since `sales.length`is `11`，并且您正在使用`i <= 11`，因此，您的最后一次迭代将尝试访问`sales[11]`不存在的（注意 Java 中的数组是**0-indexed**）。

另一种选择是使用`i < sales.length`. 这样，如果您向数组添加更多元素，则无需更改`for`-loop 的代码：

```
for (i=0; i < sales.length; i++) { 
```

# android - 如何在没有证书的情况下发布我的 android 应用程序？

> ID：12338742
> 
> 赞同：2
> 
> 时间：2012-09-09T11:39:07.063
> 
> 标签：android, certificate, apk

我已经用服务器构建了一个 .apk，但我无法在 android 设备 keytool 上安装它：

```
INSTALL_FAILED_NO_CERTIFICATES 
```

如何在没有证书的情况下发布我的应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T11:43:06.053

你不能。没有应用商店会允许您上传未签名的 apk，即使他们这样做了，运行未修改版本的 Android 的 Android 设备也不会让您在没有签名的情况下安装 apk。

这就是为什么 eclipse 在开发过程中使用调试证书来签署您的应用程序的原因。此外，如果没有签名的二进制文件，某些 API 和库（如 Google Maps）将无法使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T11:51:09.023

做起来并不难。[这是一个链接](http://developer.android.com/tools/publishing/app-signing.html)，其中包含您需要的几乎所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T11:54:06.780

如果您想将其上传到任何应用商店，则不能。
如果您想将其发送给认识您并信任您的人，则可以这样做...

*   在**最终用户**电话系统菜单上，选择`Settings/Applications/Unknown sources`，然后从 SD 卡、电子邮件附件或任何其他来源安装
*   您可以按照此处的说明**自行签署您的应用程序**：[http ://www.androiddevelopment.org/tag/apk/](http://www.androiddevelopment.org/tag/apk/)

# c# - 设计安全的 Intranet (ASP.NET) 应用程序

> ID：12338743
> 
> 赞同：0
> 
> 时间：2012-09-09T11:39:13.270
> 
> 标签：c#, asp.net, sql-server, vb.net, web-services

> ***我想知道是否需要在这个 asp.net 应用程序上添加任何其他类型的安全性 - Web 表单（仅在网络域和通过 VPN 连接可用）？***

**应用环境：** Asp.net 4.0, Vb.net, Oracle 10g, Web Services, Window server 2003 or 2008, Hosted on domain

**用户认证模式**：窗口（不使用 asp.net 会员）

**认证场景：**
应用程序可通过内网站点访问，系统使用系统用户名对用户进行认证。在默认页面系统会先获取当前用户名（HttpContext.Current.User.Identity.Name），然后在用户表（oracle DB）中匹配，如果匹配，则存储过程将返回所有访问权限（菜单详细信息）与此用户组相关。oracle DB中有一个用户组和权限表。在存储过程中，系统还将在任何 DML 事务之前检查用户权限。

**主要安全问题**

**Major：**限制人们访问信息取决于他们的权限。普通用户不应该访问其他人的数据。

**Minor：**我们不希望任何人在办公网络之外进入我们的系统。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:01:40.467

正如 Joachim 所说，这种安排只支持在本地网络上运行的 Windows 系统。转向基本身份验证将允许更多客户端连接，但会在没有 HTTPS 的情况下在网络上公开密码（有效地以明文形式）。表单身份验证类似。

如果没有服务器身份验证，用户可能会在不知情的情况下被重定向到类似的服务器，或者遭受中间人攻击。HTTPS 为您提供服务器证书。这在本地网络上可能不是问题，但用户的`hosts`（在 c:\windows\system32\drivers\etc 中）文件通常很容易受到攻击。

如果没有加密，任何用户都可以嗅探通过网络发送和转发的信息，假设他们在同一个子网上。对于大多数应用程序来说，这可能是一个可接受的风险，但如果信息是敏感的，例如包含敏感信息或个人信息，则不是。

如果人们正在执行诸如批准之类的重要操作，请考虑重放攻击（例如，请参阅[如何防止重放攻击？ ）。](https://stackoverflow.com/questions/44391/how-do-i-prevent-replay-attacks)

考虑审核对数据库的访问，尤其是用户组和权限表。有人可以添加自己或将他们移动到一个组中，执行操作然后删除自己。检查您的页面是否有可能实现此目的的 SQL 注入和类似攻击。

总而言之，人们妥协或干扰系统的可能性有多大，您愿意投资多少来保护它？假设服务器可以处理负载，HTTPS 作为第一步很难通过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T23:29:26.497

不确定您使用的是哪种 ASP.Net 技术（MVC/Razor/Web 表单）。

如果您使用的是**Web 窗体**，那么您可以立即利用像[LoginView控件这样的](http://msdn.microsoft.com/en-us/library/ms178329%28v=vs.100%29.aspx#the_loginview_control)[ASP.NET 登录控件](http://msdn.microsoft.com/en-us/library/ms178329%28v=vs.100%29.aspx)。它们使用[ASP.Net 表单身份验证](http://msdn.microsoft.com/en-us/library/xdt4thhy%28v=vs.100%29.aspx)（使用或不使用 ASP.net 成员身份）。您还可以利用[Roles](http://www.asp.net/web-forms/tutorials/security/roles/creating-and-managing-roles-cs)。

如果您的 Intranet 服务器没有公开（以任何方式）在您的网络中公开，则它应该受到“保护”。当然，这是一个大胆的声明，完全取决于您的网络实施 - 例如子网划分、内部网络/无 nat/路由/无端口转发、无 dns 等。这使**VPN**成为您从外部暴露的**唯一**点，那么您必须为您的 VPN 基础设施实施适当的安全策略 - 例如一次性密码、客户端检查等。

* * *

更新：

如果您使用 Active Directory，您可以在 AD 中创建用户/组以提供相应的访问权限（例如 Finance AD 组只能访问“finance”文件夹）。但是，我没有跟上 Internet Explorer 之外的浏览器对 NTLM 的支持。

但是，您确实提到了用户数据在 Oracle 数据库中（？）。我不熟悉使用 db/Oracle 不允许登录屏幕访问（*网络*资源）的解决方案.....

此外，这意味着用于 VPN 访问的一次性密码可能不可用。研究基于令牌的 VPN，这样用户仍然可以使用他们的 AD 凭据，但每次都需要一个新的令牌——这将有助于减轻“黄色便签中的密码”（因为您可以更严格地控​​制令牌）。

# cuda - 如何在 CUDA 中使用 L2 缓存

> ID：12338747
> 
> 赞同：3
> 
> 时间：2012-09-09T11:39:53.250
> 
> 标签：cuda, nvidia

我已经搜索了有关在 CUDA 中使用 L2 缓存的其他线程。但是，找不到解决办法。如何使用 L2 缓存？是否有任何调用函数或声明供其使用？就像，为了使用共享内存，我们使用`__device__ __shared__`. L2 Cache有类似的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T15:01:43.403

L2 缓存对设备代码是透明的。所有未在 L1 中命中的内存访问（全局、局部、表面、纹理、常量和指令）都转到 L2。所有写入都通过 L2。

CUDA C 编程指南 F.4.2：全局内存

本节提供有关 L2 的更多详细信息。

编译器标志 -dlcm=cg 可用于使全局访问在 L1 中不缓存并在 L2 中缓存。

CUDA C 编程指南 B.5：内存栅栏函数

函数 __threadfence() 可用于确保对全局内存的所有写入在 L2 中都是可见的。

函数 __threadfence_system() 可用于确保对全局内存的所有写入对主机线程都是可见的。

# android - 无法单击 ListView 项目，没有任何其他侦听器被调用

> ID：12338750
> 
> 赞同：1
> 
> 时间：2012-09-09T11:40:21.380
> 
> 标签：android, android-listview, custom-adapter

我做了一个自定义`ListView`，但它没有调用我注册的任何 onclick 侦听器或上下文菜单。

这是我的自定义适配器：

```
class AdapterContactsActivity extends BaseAdapter {

    private Activity activity;
    private ArrayList<HashMap<String, String>> rowdata;
    private static LayoutInflater inflater = null;
    public ArrayList<String> checkedContacts = new ArrayList<String>();

    public AdapterContactsActivity(Activity a,
        ArrayList<HashMap<String, String>> d) {
        activity = a;
        rowdata = d;
        inflater = (LayoutInflater) activity
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }

    public int getCount() {
        return rowdata.size();
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(final int position, View convertView, ViewGroup parent) {

        if (convertView == null)
             convertView = inflater.inflate(R.layout.item_listview_contacts,
                null);
         final ViewHolder holder = new ViewHolder();
         holder.txtTitle = (TextView) convertView.findViewById(R.id.textView1);
         holder.chkBox = (CheckBox) convertView.findViewById(R.id.checkBox1);
         final HashMap<String, String> row = rowdata.get(position);
         // Setting all values in listview
         holder.txtTitle.setText(row.get(EmsContactsActivity.KEY_TITLE));
         final String contact_id = row.get(EmsContactsActivity.KEY_ID);
         convertView.setTag(contact_id);
         holder.txtTitle.setTag(contact_id);
         if (checkedContacts.contains(contact_id))
             holder.chkBox.setChecked(true);
         else
             holder.chkBox.setChecked(false);
         holder.chkBox.setOnClickListener(new OnClickListener() {

         public void onClick(View v) {
             // TODO Auto-generated method stub
             if (!holder.chkBox.isChecked()
            && checkedContacts.contains(contact_id))
                 checkedContacts.remove(contact_id);
             else {
                 checkedContacts.add(contact_id);
             }
         }
    });
    return convertView;
    }
    static class ViewHolder {
        public TextView txtTitle;
        public CheckBox chkBox;
    }
} 
```

还有我行的项目视图：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLayout1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@android:color/black" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_toRightOf="@+id/checkBox1"
        android:padding="5dp"
        android:textAppearance="@android:style/TextAppearance.Large"
        android:textColor="@android:color/white" />

    <CheckBox
        android:id="@+id/checkBox1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:padding="5dp" />

</RelativeLayout> 
```

现在我已将所有联系人添加到适配器，但是单击`ListView`项目时我什至无法获得 logcat 通知，所以单击事件我没有调用。

`ListView`代码 ：

```
Cursor allContacts = getAllContacts();
if (allContacts != null && allContacts.getCount() > 0) {

    txtEmptyText.setVisibility(View.GONE);
    registerForContextMenu(listViewContacts);
    listViewContacts.setVisibility(View.VISIBLE);
    listViewContacts.setFastScrollEnabled(true);
    listViewContacts.setTextFilterEnabled(true);
    listViewContacts.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);
    listViewContacts.setBackgroundColor(Color.TRANSPARENT);
    searchList = new ArrayList<HashMap<String, String>>();
    searchList = getArrayListWithContacts(allContacts);

    txtTotalContacts.setText("Displaying " + allContacts.getCount()
                + " contacts");

    // Wrap your adapter within the SimpleSectionAdapter
    searchAdapter = new AdapterContactsActivity(this, searchList);
    // Set the adapter to your ListView
    listViewContacts.setAdapter(searchAdapter);

    listViewContacts.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> arg0, View v,
                    int position, long arg3) {
            // TODO Auto-generated method stub
            Log.i("CLICKED", position + " clicked");
    }
    });
} else // No Contacts Found
{
    String text = "<div>You don't have any contacts to display.<br /><br />"
            + "To add a contacts, <b>Menu</b> and touch:<br /><br />"
            + "&#8226; <b style='color:#FFFFFF;'>Accounts</b> to add or configure and account with contacts you can sync to the phone<br /><br />"
            + "&#8226; <b>New Contact</b> to create a new contact from scratch<br /><br />"
            + "&#8226; <b>Import/Export</b></div>";
    txtEmptyText.setVisibility(View.VISIBLE);
    listViewContacts.setVisibility(View.GONE);
    txtEmptyText.setText(Html.fromHtml(text));
    editSearchContacts.setEnabled(false);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T11:48:06.177

将`focusable`属性设置`CheckBox`为`false`：

```
<CheckBox
        android:id="@+id/checkBox1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:padding="5dp"
        android:focusable="false"  /> 
```

此外，您可能希望像这样膨胀行布局：

```
convertView = inflater.inflate(R.layout.item_listview_contacts, parent, false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T11:55:35.953

1.  你`CheckBox`有`onClickListener`，所以它可以获取 listview 的点击事件。
2.  当您尝试处理点击事件时，您是否正在使用`OnItemClickListener`您的( ) ？`ListView``listView.setOnItemClickListener(...)`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T15:22:18.510

如果您正在为列表项创建任何自定义行布局，那么。

里面 `Row.xml`

在父线性布局或相对布局中，您应该放置一行

```
android:descendantFocusability="blocksDescendants" 
```

这对我来说很好。

# c - 杀死一个进程组

> ID：12338754
> 
> 赞同：0
> 
> 时间：2012-09-09T11:40:34.593
> 
> 标签：c, linux, unix, process

我有一个进程树为 P1 ⟶ P2 ⟶ P3 ⟶ P4 ⟶ P5（所以 P2 是 P1 的子进程，P3 是 P2 的子进程，依此类推）。

*   进程 P1 和 P2 属于同一个进程组。
*   进程 P3 和 P4 和 P5 属于其他进程组。

在进程 P1 中，我们知道 P3、P4 和 P5 的进程组（它是值 P3），我们正在向该进程组发送 SIGKILL。使用`kill(-P3, SIGKILL)`. 预期这会杀死 P3、P4 和 P5，但不会杀死 P2，但观察结果是 P2 也被杀死了。我在这里有两个问题：

1.  为什么P2会被杀死？
2.  我们将在 P1 中获得 P2 的退出状态是什么。

# javascript - iPad 虚拟键盘 - 哪一个 - javasctript 解决方案？

> ID：12338756
> 
> 赞同：1
> 
> 时间：2012-09-09T11:41:44.443
> 
> 标签：javascript, ipad

当 iPad 虚拟键盘出现时，它似乎有几种不同的布局，例如用户单击网站上的文本字段......有没有办法确定显示的是哪个？

例如，我有一个登录页面，要求用户输入他们的电子邮件地址，因此，我希望虚拟键盘在第一页上显示 @ 符号，而不是在用户点击时选择符号移位用于输入其电子邮件地址的文本字段。

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T11:46:27.983

我建议你阅读[这篇文章](http://uxmovement.com/forms/input-types-give-users-the-right-keyboard-on-mobile-forms/)。您可以向用户显示多少种不同的键盘非常完整...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T11:44:01.313

尝试

```
<input type="email" /> 
```

您可以通过相应地调整输入类型来控制显示的键盘。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T11:48:09.190

Html5 引入了几种新的输入类型，它们可以显示不同的虚拟键盘。

检查[http://www.w3schools.com/html5/att_input_type.asp](http://www.w3schools.com/html5/att_input_type.asp)

# azure - 应用织物隐喻天蓝色

> ID：12338757
> 
> 赞同：0
> 
> 时间：2012-09-09T11:41:51.780
> 
> 标签：azure

谁能提供一个简单的比喻来理解 Windows azure 中的应用程序结构。例如，如果您希望向普通学生解释这一点，以便他们容易记住。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T20:34:41.700

您是在问 AppFabric 吗？我认为这个品牌已经消失了。它曾经包含服务总线和缓存服务。

# gradle - 如何访问我的 gradle 编译依赖项的源工件？

> ID：12338761
> 
> 赞同：2
> 
> 时间：2012-09-09T11:42:11.817
> 
> 标签：gradle

我编写了以下任务，它为我的每个子项目提取所有编译依赖项并将它们放在每个子项目目录中：

```
task exportCompileLibs << {
  subprojects.each { iSubProject ->
    iSubProject.configurations.findAll{it.name == "compile"}.each{ jConfig ->
      println "copying compile libs for ${iSubProject.name}..."
      copy {
        into "${iSubProject.buildDir}/gradle-lib-export"
        from jConfig
        eachFile {println it.name}
      }
    }
  }
} 
```

我想扩展它以导出 Gradle 已经知道的源工件（我可以在缓存目录中看到源 jar），我只是不知道如何使用对象模型来处理他们。

IDEA 和 Eclipse 插件似乎能够做到这一点（他们将他们构建的项目文件直接指向 gradle 缓存），但我无法弄清楚如何做到这一点 - 并且查看 IDE 插件源代码，它看起来......棘手。我希望 gradle DSL 或 API 中缺少一些明显的东西。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T11:50:43.103

对于任何寻求至少临时解决方案的人来说，以下似乎正在做我目前想要的。

对于要导出依赖项的每个项目，您必须将 IDEA 插件应用于 build.gradle 文件：

> 应用插件：“想法”

然后定义这个任务：

```
task exportDependencies << {
  def deps = project.extensions.getByType(IdeaModel).module.resolveDependencies()
  copy {
    from deps*.classes.file
    into "${buildDir}/gradle-lib-export/libs"
  }

  copy {
    from deps*.sources.file
    into "${buildDir}/gradle-lib-export/sources"
  }
} 
```

这是我可怕的 hack，所以我不必为每个子项目应用插件：

```
task exportDependencies(description: "export project dependency jars") << {
  subprojects.each { Project iSubProject ->
    String target = "${iSubProject.buildDir}/gradle-lib-export"

    IdeaPlugin ideaPlugin = new IdeaPlugin()
    ideaPlugin.apply(iSubProject)
    Set<Dependency> deps = ideaPlugin.model.module.resolveDependencies()

    println "exporting dependencies for $iSubProject.name into $target"
    copy {
      from deps*.classes.file
      into "${target}/libs"
      eachFile { println "lib -> $it.name" }
    }
    copy {
      from deps*.sources.file
      into "${target}/sources"
      eachFile{ println "source -> $it.name" }
    }
  }
} 
```

+10 分，因为我的构建任务列表中没有我不想要的东西，- 几百*万分 ewwwww*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T12:20:31.997

目前没有比 IDE 插件更简单的方法了。这有望在未来有所改变。

# jsp - £ 符号显示为中间带有问号的菱形

> ID：12338763
> 
> 赞同：-2
> 
> 时间：2012-09-09T11:42:43.540
> 
> 标签：jsp, spring-mvc, utf-8, character-encoding, spring-roo

我正在创建一个涉及向用户显示财务数据的网络应用程序。来自英国并使用 GBP £ 作为货币，这个字符被大量使用。

但是，不时地，£ 显示为中间带有问号的菱形，并且在网页上它会抛出一个无效字符 UTF-8 byte 1 of 1 byte string。

是否有 UTF 安全的方式来显示`£`标志？这是我目前正在做的一个例子：

```
 "Rent Per Annum: £" + '${tenant.currentRent}' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T14:47:38.020

特定问题可能至少有以下一个或多个原因：

1.  JSP 文件不是由编辑器（Eclipse、Netbeans、Notepad 等）使用 UTF-8 编码保存的。

2.  在通过网络发送之前，服务器没有使用 UTF-8 将 JSP 生成的字符解码为字节流。

3.  浏览器没有使用 UTF-8 将来自网络的字节流编码为字符。

这些问题可以通过以下方式解决：

1.  配置编辑器以使用 UTF-8 保存 JSP 文件。我不熟悉 STS，但我知道它是基于 Eclipse 的，所以它可能与标准 Eclipse 中的相同。转到*Window > Preferences > General > Workspace > Text File Encoding*，然后在下拉列表中选择正确的编码。

    ![在此处输入图像描述](../Images/70ab3405e14795ebf50f8df00ba8618d.png)

    另一种方法是使用 HTML 实体`&pound;`（如其他回答者所建议的那样），这样保存 JSP 文件的编码不再相关。字符串中涉及的所有字符`&pound;`都已由基本 ASCII 编码支持（世界上使用的每个体面的字符编码基本上都“扩展”了 ASCII，因此它总是可以工作）并且 HTML 解释器（webbrower）会将 HTML 实体转换为正确的性格。

2.  必须指示服务器使用 UTF-8 来解码 JSP 输出。这可以在每个 JSP 的基础上由

    ```
    <%@page pageEncoding="UTF-8" %> 
    ```

    或在应用程序范围内通过

    ```
    <jsp-config>
        <jsp-property-group>
            <url-pattern>*.jsp</url-pattern>
            <page-encoding>UTF-8</page-encoding>
        </jsp-property-group>
    </jsp-config> 
    ```

3.  必须指示浏览器使用 UTF-8 对 HTTP 响应进行编码。这将通过将`charset`HTTP 响应`Content-Type`标头的属性设置为 UTF-8 来解决，这已由导致 #2 的解决方案隐式完成。

### 也可以看看：

*   [Unicode - 如何让字符正确？](http://balusc.blogspot.com/2009/05/unicode-how-to-get-characters-right.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:12:43.963

在 HTML 中将其作为实体编写的一种可移植方式是`&pound;`或在一般情况下通过其字符代码`&#163;`或`&#xA3;`£。这样，您的源是纯 7 位 ASCII，因此基本上独立于编码（忽略 EBCDIC 等深奥）。另见[http://www.fileformat.info/info/unicode/char/a3/index.htm](http://www.fileformat.info/info/unicode/char/a3/index.htm)

# java - 寻找等待对象

> ID：12338767
> 
> 赞同：3
> 
> 时间：2012-09-09T11:42:58.190
> 
> 标签：java, debugging, concurrency, profiling

我们使用 jvisualvm 分析了我们的应用程序，发现它在 Object.wait() 中花费了很多时间。

如何找到调用此方法的对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T10:26:11.500

如果您不限于 jvisualvm，在[JProfiler](http://www.ej-technologies.com/products/jprofiler/overview.html)中，您可以右键单击锁定图中的对象并在堆遍历器中检查它。

![在此处输入图像描述](../Images/782dcf4d6cd584edb76ca9e2521a4b89.png)

这是针对当前锁定情况的，但历史视图将使您能够访问以前的锁定情况，并且还有一个监视器统计视图将按其类分解监视器：

![在此处输入图像描述](../Images/d42794dfe856d1d25bd4d5bb0e81fb16.png)

免责声明：我公司开发 JProfiler。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T12:26:01.480

事实上，Java SE SDK 带有一个有用的类[ThreadInfo](http://docs.oracle.com/javase/6/docs/api/java/lang/management/ThreadInfo.html)，您可以检查它以了解线程被阻塞的原因以及它正在等待什么，包括到等待点的完整堆栈跟踪，以及等待的总时间（以毫秒为单位）。

您可以通过`java.lang.management`包使用此类，特别是`ManagementFactory.getThreadMXBean()`您可以使用此类以编程方式检查阻塞的线程。

这是来自 JConsole 的相关屏幕截图：

![在此处输入图像描述](../Images/7c6eec4fe795bfa4030e73bf82c49f23.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T12:22:54.120

挂起`Object.wait()`是完全合法和安全的情况，例如，当某个线程正在等待[`BlockingQueue`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html). 这种等待所花费的时间不应影响应用程序的性能，除非它是死锁。

# ruby-on-rails - 如何创建用户友好的标记路线

> ID：12338772
> 
> 赞同：0
> 
> 时间：2012-09-09T11:43:32.627
> 
> 标签：ruby-on-rails, ruby-on-rails-3, url, routes, tagging

我有一个模型图像：

```
class Image < ActiveRecord::Base
  attr_accessible :description, :name, :size, :image, :tag_ids

  has_many :taggings, :dependent => :destroy
  has_many :tags, :through => :taggings
end 
```

然后我有我的标签模型：

```
class Tag < ActiveRecord::Base
  attr_accessible :name
  has_many :taggings, :dependent => :destroy
  has_many :images, :through => :taggings

end 
```

我的 routes.rb 目前是：

```
resources :images do
    get 'confirm_destroy', :on => :member
end
resources :tags 
```

现在假设我为图像创建了几个标签“蓝色”、“红色”和“黄色”。在某些页面上，我想显示一个标签列表，然后将它们链接到例如 www.example.com/yellow，其中所有标记为黄色的图像都应显示。此标签列表的视图 (haml) 当前为：

```
- @tags.each do |tag|
  = link_to(tag.name, tag) 
```

但它会生成一个指向 www.example.com/tags/2 的链接（其中 2 是 tag_id）。

如何创建正确的资源以链接到 www.example.com/yellow 而不是 www.example.com/tags/2。在这种情况下，带有“link_to”的视图是否相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:53:42.003

您可以使用`to_param`模型中的方法或`friendly_id`gem 来执行此操作。Ryan Bates 有关于这个[http://railscasts.com/episodes/314-pretty-urls-with-friendlyid的完美截屏视频](http://railscasts.com/episodes/314-pretty-urls-with-friendlyid)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T11:55:06.757

您将无法创建到**www.example.com/yellow**的路由，因为它不引用特定资源，随后可能会产生冲突。想象一下，如果您有一个名为“images”的标签，Rails 将不知道**www.example.com/images**的 url 是否引用了特定标签或图像资源。

我们能做的最好的事情是创建一个资源，它使用名称作为 URL 中的标识符，这样**www.example.com/tags/yellow**将显示带有“黄色”作为其名称属性的标签。

为此，您需要在模型中为 Tag 定义以下**to_param**方法。

```
class Tag < ActiveRecord::Base
  attr_accessible :name
  has_many :taggings, :dependent => :destroy
  has_many :images, :through => :taggings

    def to_param
        name
    end
end 
```

这将告诉 Rails 使用**name**属性而不是默认**id**进行路由。您的**link_to**不需要更新，但是，您的标签控制器现在需要按名称而不是 ID 查找标签，如下所示：

```
class TagsController < ApplicationController

    def show
        @tag = Tag.find_by_name(params[:id])
    end

    ...

end 
```

# objective-c - 当用户多次生成相同的动作等待下载时怎么办？

> ID：12338777
> 
> 赞同：5
> 
> 时间：2012-09-09T11:44:23.663
> 
> 标签：objective-c, multithreading, web-services

我正在设计一个 iPhone 应用程序。用户搜索一些东西。我们从网上获取数据。然后我们更新表。

伪代码将是

```
[DoThisAtbackground ^{
  LoadData ();
  [DoThisAtForeground ^{
    UpdateTableAndView();
  }];
}]; 
```

如果在第一次搜索完成之前用户搜索别的东西怎么办。

解决问题的行业标准方法是什么？

1.  跟踪哪个线程仍在运行，仅在所有线程完成后才更新表？
2.  每次线程完成时更新视图？

我们究竟是如何做到这一点的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:34:28.703

我建议你看看[iOS Human Interface Guidelines](http://developer.apple.com/library/ios/#DOCUMENTATION/UserExperience/Conceptual/MobileHIG/Introduction/Introduction.html)。Apple 认为所有应用程序的行为方式大致相同非常重要，因此他们编写了一份关于此类问题的详尽文档。

在指南中，有两件事与您的问题相关：

*   [**让搜索快速而有价值**](http://developer.apple.com/library/ios/#DOCUMENTATION/UserExperience/Conceptual/MobileHIG/UEBestPractices/UEBestPractices.html#//apple_ref/doc/uid/TP40006556-CH20-SW14)：“如果可能，在用户输入时过滤远程数据。虽然过滤用户输入可以带来更好的搜索体验，但如果响应时间可能，请务必通知他们并让他们有机会选择退出将结果延迟一两秒以上。”
*   [**反馈**](http://developer.apple.com/library/ios/#DOCUMENTATION/UserExperience/Conceptual/MobileHIG/Principles/Principles.html#//apple_ref/doc/uid/TP40006556-CH5-SW5)：“反馈承认人们的行为，并向他们保证正在进行处理。人们在操作控件时期望立即得到反馈，并且他们欣赏在长时间操作期间的状态更新。”

虽然这些指南当然有很多废话，但我认为以上几点实际上是一个好主意。作为用户，我希望搜索时会发生一些事情，并且当您在每次线程完成时更新视图时，用户将看到最快的响应。是的，这可能是用户不想要的结果，但有些事情正在发生！例如，以 iOS 中的 Safari 网络浏览器为例：Google 自动完成功能即使在您输入时也会显示结果，而不仅仅是在您输入完搜索查询时。

所以我认为最好选择第二个选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T12:39:16.710

如果您正在对远程服务器执行 REST 数据请求，您可以随时取消请求并启动新请求，而无需更新表，这是一种可行的方法。有时间完成的请求将更新 UI，而其他请求则不会。例如使用 ASIHTTPRequest

```
- (void)serverPerformDataRequestWithQuery:(NSString *)query andDelegate:(__weak id <ServerDelegate)delegate {
  [currentRequest setFailedBlock:nil];
  [currentRequest cancel];
  currentRequest = [[ASIHTTPRequest alloc] initWithURL:kHOST];
  [currentRequest startAsynchronous];
} 
```

如果您也需要本地 SQLite 数据库的答案，请告诉我，因为它要复杂得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T13:33:00.903

您可以使用`NSOperationQueue`取消所有挂起的操作，但它仍然不会取消现有的操作。您仍然需要执行一些操作来取消现有操作......这也可以提前中止队列中的操作。

我通常更喜欢直接 GCD，除非在我的用例中有其他更适合`NSOperationQueue`.

此外，如果您的加载具有外部取消机制，您希望取消任何挂起的 I/O 操作。

如果操作是独立的，请考虑并发队列，因为它将允许较新的请求在其他请求被取消时同时执行。

此外，如果它们都是 I/O，请考虑是否可以使用`dispatch_io`而不是阻塞线程。正如[蒙克](http://www.usanetwork.com/series/monk/)所说，“你以后会感谢我的。”

考虑这样的事情：

```
- (void)userRequestedNewSearch:(SearchInfo*)searchInfo {
    // Assign this operation a new token, that uniquely identifies this operation.
    uint32_t token = [self nextOperationToken];

    // If your "loading" API has an external abort mechanism, you want to keep
    // track of the in-flight I/O so any existing I/O operations can be canceled
    // before dispatching new work.

    dispatch_async(myQueue, ^{
        // Try to load your data in small pieces, so you can exit as early as
        // possible.  If you have to do a monolithic load, that's OK, but this
        // block will not exit until that stops.  
        while (! loadIsComplete) {
            if ([self currentToken] != token) return;
            // Load some data, set loadIsComplete when loading completes
        }

        dispatch_async(dispatch_get_main_queue(), ^{
            // One last check before updating the UI...
            if ([self currentToken] != token) return;

            // Do your UI update operations
        });
    });

} 
```

它将提前中止任何不是最后提交的操作。如果您使用过`NSOperationQueue`，您可以调用`cancelAllOperations`，但您仍然需要一种类似的机制来提前中止当前正在执行的机制。

# magento - 检查具有特定 AttributeSetName 的产品的 Magento 购物车

> ID：12338783
> 
> 赞同：2
> 
> 时间：2012-09-09T11:45:23.643
> 
> 标签：magento

在 Magento 结帐/购物车中，我想检查是否将来自六个特定属性集的产品添加到 Magento 购物车中。

我已经创建了下面的函数来检查这些属性集名称的产品视图页面，但是我如何对结帐/购物车中的项目进行相同的检查？

```
$attribute_set = Mage::getModel('eav/entity_attribute_set')->load( $_product->getAttributeSetId() ); 
$attributeset_name = $attribute_set->getAttributeSetName();
if ($attributeset_name =="Sko" or $attributeset_name =="beklaedning" or $attributeset_name =="Banz_solhat" or $attributeset_name =="Soltoj" or $attributeset_name =="solhat" or $attributeset_name =="fodtoj") { 
    echo "<b>Fragt</b>: <span style='color:red'>Fri Fragt p&aring; varen samt resten af ordren</span><br>"; 
} 
```

最好的问候，杰斯珀

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T16:01:37.847

```
$attributeSetNames = array('Sko', 'beklaedning', 'Banz_solhat', 'Soltoj', 'solhat', 'fodtoj');

$quote = Mage::getSingleton('checkout/session')->getQuote();
$itemCollection = Mage::getModel('sales/quote_item')->getCollection();
$itemCollection->getSelect()
    ->joinLeft( 
        array('cp' => Mage::getSingleton('core/resource')->getTableName('catalog/product')), 
        'cp.entity_id = main_table.product_id', 
        array('cp.attribute_set_id'))
    ->joinLeft( 
        array('eas' => Mage::getSingleton('core/resource')->getTableName('eav/attribute_set')), 
        'cp.attribute_set_id = eas.attribute_set_id', 
        array('eas.attribute_set_name'))
;
$itemCollection->setQuote($quote);

foreach($itemCollection as $item) {
    if (in_array($item->getData('attribute_set_name'), $attributeSetNames)) {
       //... Match
    }
} 
```

* * *

**或者**……

使用属性集 ID 而不是名称。这将避免任何潜在的措辞问题，并稍微清理代码......

```
$attributeSetIds = array(1, 2, 3, 4, 5, 6);

$quote = Mage::getSingleton('checkout/session')->getQuote();
$itemCollection = Mage::getModel('sales/quote_item')->getCollection();
$itemCollection->getSelect()
    ->joinLeft( 
        array('cp' => Mage::getSingleton('core/resource')->getTableName('catalog/product')), 
        'cp.entity_id = main_table.product_id', 
        array('cp.attribute_set_id'))
;
$itemCollection->setQuote($quote);

foreach($itemCollection as $item) {
    if (in_array($item->getData('attribute_set_id'), $attributeSetIds)) {
       //... Match
    }
} 
```

# google-search - Google 自定义搜索 API - 排序/过滤

> ID：12338785
> 
> 赞同：2
> 
> 时间：2012-09-09T11:45:27.223
> 
> 标签：google-search, google-search-api

反正有没有按页面标题标签或某些元标签过滤结果......我阅读了文档......但它是一团糟:-(有人有想法吗？？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T21:25:46.463

是的，您可以对自定义元标记进行排序和过滤。

首先，将要过滤的数据放入[元标记](https://developers.google.com/custom-search/docs/structured_data#metatags)中： `<meta name="color" value="blue">`

[接下来，通过使用Rich Snippet Tool](http://www.google.com/webmasters/tools/richsnippets)测试您的 URL 来测试 Google 是否可以找到标签在“用于过滤搜索结果的结构化数据”下，您应该会看到`more:pagemap:metatags-color:blue`。

最后，使用上面的结构化数据字符串查询您的自定义搜索引擎。放入搜索框是可行的，或者将它与URL 中`more:pagemap:metatags-color:blue`的查询参数（通常是）一起使用。`q`

对于数字元标记，您可以使用`sort=more:pagemap:metatags-sales_rank`（或任何您的属性）进行排序。

要搜索页面标题，应该使用 Google 的标准`intitle:`运算符。

# scala - 在数组中查找索引的功能代码

> ID：12338787
> 
> 赞同：3
> 
> 时间：2012-09-09T11:45:27.983
> 
> 标签：scala, functional-programming

我想以函数式风格重构这段*Scala*代码：

```
var k = -1
for (i <- 0 until array.length)
  if ((i < array.length - 1) && array(i) < array(i + 1))
    k = i 
```

*Scala*中的数组有`indexWhere`，可用于类似`val index = array.indexWhere(c => c == 'a')`. 我正在寻找类似的东西，它会考虑到数组的两个连续元素。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-09T11:54:49.313

当您需要查看集合中的相邻元素时，通常的函数式方法是用尾部“压缩”集合。考虑以下简化示例：

```
scala> val xs = List(5, 4, 2, 3, 1)
xs: List[Int] = List(5, 4, 2, 3, 1)

scala> val tail = xs.tail
tail: List[Int] = List(4, 2, 3, 1)

scala> xs.zip(tail)
res0: List[(Int, Int)] = List((5,4), (4,2), (2,3), (3,1) 
```

现在我们可以使用`indexWhere`：

```
scala> res0.indexWhere { case (x, y) => x < y }
res1: Int = 2 
```

在您的情况下，以下内容基本上等同于您的代码：

```
val k = (array zip array.tail) lastIndexWhere { case (x, y) => x < y } 
```

我使用`lastIndexWhere`而不是`indexWhere`，因为在您的代码中，当您遇到谓词成立的一对时，您不会停止循环。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-09T12:01:29.377

`sliding`为您提供进入集合的滑动窗口，即

```
scala> Array(1,2,2,4,5,6, 6).sliding(2).toList
res12: List[Array[Int]] = List(Array(1, 2), Array(2, 2), Array(2, 4), Array(4, 5), Array(5, 6), Array(6, 6)) 
```

所以这将使查找第一个匹配对的索引变得容易：

```
Array(1,2,2,4,5,6, 6).sliding(2).indexWhere { case Array(x1, x2) => x1 == x2 } 
```

那只会给你第一个索引，`collect`用来捕捉所有的！

```
Array(1,2,2,4,5,6, 6)
  .sliding(2)     //splits each in to pairs
  .zipWithIndex   //attaches the current index to each pair
  .collect { case (Array(x1, x2), index) if (x1 == x2) => index }  //collect filters out non-matching pairs AND transforms them to just the inde 
```

# android - 抱歉，此视频无法在 Android VideoView 中播放

> ID：12338788
> 
> 赞同：0
> 
> 时间：2012-09-09T11:45:34.757
> 
> 标签：android, android-videoview

我想在我的 Android 应用中播放视频，并使用以下代码：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    showVideo();
}
private void showVideo()
{
    VideoView vd = (VideoView)findViewById(R.id.videoview);
    Uri uri = Uri.parse("android.resource://package/"+R.raw.movie);
    MediaController mc = new MediaController(this);
    vd.setMediaController(mc);
    vd.setVideoURI(uri);
    vd.start();
} 
```

使用此代码，我收到无法播放视频的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:57:08.863

Just a thought...should your URI really have "package" in the path? shouldn't you replace that with your actual application package: "com.whatever.something"?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T16:20:47.900

您想要获取PackageName，或手动提供它以使其工作：

```
Uri uri=Uri.parse("android.resource://"+getPackageName()+"/"+R.raw.movie); 
```

# emacs - 自动加载 Emacs ESS

> ID：12338789
> 
> 赞同：2
> 
> 时间：2012-09-09T11:45:39.733
> 
> 标签：emacs, load, autoload, ess

如何在 Emacs 中自动加载 ESS（适用于 Windows）？

它总是以打开的 ESS 缓冲区启动，我怀疑加载 ESS 会使加载 emacs 的速度降低大约 1 秒（使用计时器）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:32:04.890

暂时不可能。入口点太多了。在将 ESS 与 package.el 集成方面已经完成了一些工作，但由于 Emacs 24.1 中 package.el 的限制，尚未完成，希望在 ESS 的下一个版本（13.03）中解决。

你编译吗？它大大加快了加载速度。您可以使用终端`make`或`make lisp`在终端中执行此操作。或者在 ESS/lisp 目录中打开 dired 标记所有 .el 文件（使用`*.`el `RET`）并执行`M-x dired-do-byte-compile`.

# sql - 与 SQL 语法冲突的表或表键名的最佳实践

> ID：12338791
> 
> 赞同：1
> 
> 时间：2012-09-09T11:46:01.007
> 
> 标签：sql, syntax

如果这是一个愚蠢的问题或者我的标题措辞有点错误，我很抱歉，但是在为我的作业创建我的数据库时，我看到他们想要分别作为表名和表键名之`Returns`类的名称。`Address`

它编译没有问题：

```
CREATE TABLE Returns 
(
..
) 
```

和

```
CREATE TABLE Customers 
(
..
Address varchar(30) NOT NULL,
..
) 
```

但是我看到我的 MS SQL Server 2008 sp1 语法编辑器使单词`Returns`和与语句`Address`相同的颜色`CREATE TABLE`（蓝色），因此我猜这些是 SQL 语言的关键字。

那么这是一个很好的命名约定还是我应该切换到类似的东西： `CustomerAddress`和`ProductReturns`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T11:54:16.850

阅读MSDN 上的 SQL-Server[保留关键字](http://msdn.microsoft.com/en-us/library/aa238507%28v=sql.80%29.aspx)页面。

`RETURNS`位于“*未来关键字*”列表中，其中：

> 随着新功能的实现，可以在 SQL Server 的未来版本中保留以下关键字。考虑避免使用这些词作为标识符。

# objective-c - Objective-C RegEx-Password-Check 始终为真

> ID：12338792
> 
> 赞同：0
> 
> 时间：2012-09-09T11:46:16.690
> 
> 标签：objective-c, regex, xcode, passwords, expression

我想用正则表达式检查密码的复杂性。但它总是返回`true`？

密码的复杂性如下。允许的是：

*   AZ
*   阿兹
*   0-9
*   特殊字符： - _ ， ; . : # + * ? =！§ $ % & / ( ) @
*   *没有*空白字符

这是我的代码：

```
NSString *regExPwd = @"[a-zA-Z_0-9\\-_,;.:#+*?=!§$%&/()@]+";
NSPredicate *pwdCheck = [NSPredicate predicateWithFormat:@"SELF MATCHES %@", regExPwd];
bool isValid = [pwdCheck evaluateWithObject:txtPassword.text]; 
```

希望你能再次帮助我:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:01:47.220

您应该要求从头到尾**只有允许的字符：**

```
NSString *regExPwd = @"^[a-zA-Z_0-9\\-_,;.:#+*?=!§$%&/()@]+$"; 
```

# python - 这个 Python 代码对于斐波那契数列的效率如何？

> ID：12338802
> 
> 赞同：1
> 
> 时间：2012-09-09T11:47:52.557
> 
> 标签：python, python-2.7, fibonacci, performance

几天前我写了这个，它似乎工作正常，但速度很慢。生成斐波那契数列中的第 100 万个数字需要 25 秒。有没有办法让这更有效？

```
def main():
    num1 = 0
    num2 = 1
    var = 0
    num = int(raw_input("What fibonacci number do you want to know? "))
    while 1:
        num3 = num1
        num1 = num1 + num2
        num2 = num3
        var+=1
        if var>=num:
            print num3
            return main()
        else:
            None

main() 
```

请注意，我是python初学者，所以我不会理解高级概念

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T11:52:44.720

我发现使用卢卡斯数字可以让我得到最快的结果：

```
def powLF(n):
    if n == 1:     return (1, 1)
    L, F = powLF(n//2)
    L, F = (L**2 + 5*F**2) >> 1, L*F
    if n & 1:
        return ((L + 5*F)>>1, (L + F) >>1)
    else:
        return (L, F)

def fib(n):
    if n & 1:
        return powLF(n)[1]
    else:
        L, F = powLF(n // 2)
        return L * F 
```

像矩阵指数一样，它具有 O(NlogN) 复杂度，但它的常数成本较低，因此“在点上”击败它：

```
>>> timeit.timeit('fib(1000)', 'from __main__ import fibM as fib', number=10000)
0.40711593627929688
>>> timeit.timeit('fib(1000)', 'from __main__ import fibL as fib', number=10000)
0.20211100578308105 
```

是的，速度是原来的两倍。

我不能将上述实现归功于我与之比较的矩阵指数算法；两者都列在[literateprograms.org](http://en.literateprograms.org/Fibonacci_numbers_%28Python%29)上。

计算第 1,000,000 个斐波那契数需要：

```
>>> timeit.timeit('fib(1000000)', 'from __main__ import fib', number=100)/100
0.09112384080886841 
```

不到十分之一秒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T13:16:04.230

不是严格的答案，但新程序员的一个非常普遍的习惯是违反[关注点分离](http://en.wikipedia.org/wiki/Separation_of_concerns)。

更好的是：

```
def fibonacci(n):
    ...

def main():
    num = int(raw_input("What fibonacci number do you want to know? "))
    print fibonacci(num) 
```

这使斐波那契不会被用户界面代码弄乱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T12:03:38.463

如果你想快速计算斐波那契数，你应该使用封闭表达式或矩阵求幂。如果您希望能够生成任意大的数字，请使用矩阵求幂。

一个示例实现：

```
>>> def matrix_mul(A, B):
...     return ([A[0][0] * B[0][0] + A[0][1] * B[1][0],
...              A[0][0] * B[0][1] + A[0][1] * B[1][1]],
...             [A[1][0] * B[0][0] + A[1][1] * B[1][0],
...              A[1][0] * B[0][1] + A[1][1] * B[1][1]])
... 
>>> def matrix_exp(A, e):
...     if not e:
...             return [[1,0],[0,1]]
...     elif e % 2:
...             return matrix_mul(A, matrix_exp(A, e-1))
...     else:
...             sq= matrix_exp(A, e//2)
...             return matrix_mul(sq, sq)
... 
>>> def fibo(n):
...     M = [[1,1],[1,0]]
...     return matrix_exp(M, n)[0][0]
>>> fibo(1)
1
>>> fibo(2)
2
>>> fibo(3)
3
>>> fibo(4)
5
>>> fibo(5)
8
>>> fibo(115)
781774079430987230203437L
>>> fibo(123456)
#instantaneus output of a HUGE number 
```

还有这个不可读的版本要快得多：

```
>>> fibs = {0: 0, 1: 1}
>>> def fib(n):
...     if n in fibs: return fibs[n]
...     if n % 2 == 0:
...         fibs[n] = ((2 * fib((n / 2) - 1)) + fib(n / 2)) * fib(n / 2)
...         return fibs[n]
...     else:
...         fibs[n] = (fib((n - 1) / 2) ** 2) + (fib((n+1) / 2) ** 2)
...         return fibs[n]
... 
>>> timeit.timeit('fib(1000000)', 'from __main__ import fib', number=100)/100
0.0012753009796142578     # 1 millisecond for the millionth fibonacci number :O 
```

这是 literateprograms.org 的最后一个（链接在另一个答案中）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-09T11:49:44.813

您可以使用在整数运算中完成的[矩阵指数](http://en.wikipedia.org/wiki/Fibonacci_number#Matrix_form)，或者使用以幂函数的速度完成的[封闭形式表达式。](http://en.wikipedia.org/wiki/Fibonacci_number#Closed-form_expression)（注意使用封闭形式表达式的[数字错误](http://en.wikipedia.org/wiki/Numerical_error)）。`O(logn)`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-27T18:15:26.683

这是非常有效的：

```
import numpy as np

M = np.matrix([[1, 1], [1, 0]])

def fib(n):
  if n < 2:
    return 1
  MProd = M.copy()
  for _ in xrange(n-2):
    MProd *= M
  return MProd[0,0] + MProd[0,1] 
```

# c - 什么范围的机器的二进制兼容性？

> ID：12338811
> 
> 赞同：5
> 
> 时间：2012-09-09T11:49:18.547
> 
> 标签：c, ubuntu, compiler-construction, shared-libraries

我用 C 编写了一个简单的程序，并在 Ubuntu 上使用 GCC 编译它。这个文件可以在另一台机器上工作吗？

*   输出二进制文件的内容及其外部依赖项是什么？
*   它可以在其他 Linux 发行版上运行，在什么情况下运行？
*   它可以在其他操作系统上运行吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-09T12:11:48.347

二进制不兼容有几个级别/来源。

### 首先，解决库不兼容问题

通常，如果您在另一台机器上运行二进制文件，使用不同版本的“相同操作系统”（无论这意味着什么......），那么它会运行良好。完全地。问题不在于代码不起作用，而是缺少代码：二进制文件所依赖的操作系统位在目标机器上不存在。找不到要运行的代码，而不是运行代码（这完全可以，直到它尝试使用丢失的位！）

因此，来自 Ubuntu gcc 的二进制文件很可能会在不比编译它的机器旧的任何 linux 系统上运行。这完全取决于二进制文件依赖于操作系统和系统库的功能。

很少有二进制文件没有外部依赖。检查`ldd`输出中使用的依赖项。最有可能导致问题的是 libgcc 依赖项。libc 和朋友很少更改，因此几乎不会造成兼容性问题。GCC 经常更改，因此会限制您的二进制文件将在其上运行的目标机器。

一般规则是：使用您想要运行的最古老的发行版作为您的构建机器。因此，使用 RHEL 2 构建机器，您将能够在任何不旧的系统上运行二进制文件（有一些例外）。这是一个让事情变得简单的通用准则。如果您需要跨许多发行版的二进制兼容性，静态链接到 libstdc++（如果您使用 C++）是一个很好的选择。静态链接到 libgcc 是危险的，除非您真的知道自己在做什么，否则不要尝试。

最后，请注意库兼容性在其他 UNIX 平台上要简单得多；只有 linux 这么痛苦。在 AIX 6（比如说）或 SunOS 5.8 或 HP-UX 11.00 上编译的任何东西，或者在所有更高版本上运行都没有问题的任何东西。环境足够同质，他们可以在他们的系统库中附带一堆遗留的垃圾，以保证旧版本中存在的每个符号都可以在最新版本中使用，并且具有相同的语义。

### 其次，跨操作系统二进制文件：操作系统之间的运行时差异

这只是机器代码，所以你可能认为二进制文件应该在其他操作系统上工作。他们不会。一个重要的原因是系统调用：当您需要从内核调用某些东西（这对于大多数重要功能来说是必需的）时，您必须知道如何“与内核对话”。也就是说，您进行系统调用并告诉操作系统，“做 42 件事，你知道的”。

系统调用的数量取决于内核。因此，Solaris 二进制文件在 linux 上是可以的，除了会停止几乎所有工作的小问题。

事实上，一些操作系统确实支持其他内核的系统调用。FreeBSD 知道 linux 系统调用，当你告诉它“做 42 件事”时，它会检查 ELF 标头中的一个标志，如果 ELF 被标记为 linux 系统调用号，它会对 linux 系统调用号执行适当的操作。整洁的。（当然，您还需要链接 linux 库......但是，静态链接的 linux 二进制文件将在 FreeBSD 中运行良好，无需外部。）

### 三、加载时跨操作系统兼容性

二进制不是“只是一个二进制”；它包含一整套元数据，这些元数据在内核运行之前会被内核解释。大多数二进制文件是一团代码和数据，以及链接器信息。但是，即使是没有任何外部依赖关系的东西也必须由内核解析。

一些内核理解多种二进制格式，例如 PE、ELF 或 a.out（已过时）。linux 二进制文件永远不会在 Windows 上运行，即使它们没有进行任何系统调用（这样的二进制文件不能干净地退出，但为了举例......）。这是因为 MS 不打算在其内核中添加 ELF 支持：Windows 无法读取描述如何加载和启动它的代码的包装器，因此不会运行其中的代码：Windows 不会'不知道文件的哪些位是偶数代码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T12:24:02.717

( `a.out`)`.o`文件在类 Unix 操作系统机器上工作。（@Nicholas Wilson 上面给出的操作系统细节）

`.o`包括文件中提到的所有库`.c`。被调用函数的副本从库中复制并`.o`与文件中给出的代码一起放入`.c`文件中。

再次编译`.o`文件以获得可执行文件。

文件的使用`.o`是，如果您正在处理一个大型项目，其中每个部门都有自己的源文件（`.c`）并且需要制作一个可执行文件。您可以通过编译`.c`文件来获取它。编译后得到`.o`文件。现在，您可以将所有这些`.o`文件组合成一个可执行文件。

# c++ - 如何将双引号放入字符串文字中？

> ID：12338818
> 
> 赞同：40
> 
> 时间：2012-09-09T11:50:12.807
> 
> 标签：c++, c, string, escaping, string-literals

我使用`printf()`语句创建了以下输出：

```
printf("She said time flies like an arrow, but fruit flies like a banana."); 
```

但我想把实际的报价放在双引号中，所以输出是

> 她说：“时光如箭，果如香蕉”。

不干扰用于在`printf()`语句中包装字符串文字的双引号。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-09-09T11:51:48.283

用反斜杠转义引号：

```
printf("She said \"time flies like an arrow, but fruit flies like a banana\"."); 
```

您可以在字符串文字中使用特殊的[转义字符](http://gillius.org/ctut/app_a.htm)，这些字符用前导反斜杠表示。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2018-01-22T12:22:56.520

值得庆幸的是，对于 C++11，还有更令人愉悦的使用原始字符串文字的方法。

```
printf("She said \"time flies like an arrow, but fruit flies like a banana\"."); 
```

变成：

```
printf(R"(She said "time flies like an arrow, but fruit flies like a banana".)"); 
```

关于在开始引号之后和结束引号之前添加括号，请注意它们几乎可以是最多 16 个字符的任意组合，有助于避免组合出现在字符串本身中的情况。具体来说：

> 基本源字符集的任何成员，除了：空格、左括号（、右括号）、反斜杠和表示水平制表符、垂直制表符、换页符和换行符的控制字符”（N3936 §2.14.5 [lex .string] 语法）和“最多 16 个字符”（§2.14.5/2）

它使这个短字符串变得多么清晰可能值得商榷，但是当用于 HTML 或 JSON 等较长格式的字符串时，它无疑要清晰得多。

# python - 为 django 管道安装 yui 压缩机

> ID：12338820
> 
> 赞同：1
> 
> 时间：2012-09-09T11:50:55.610
> 
> 标签：python, django, compression, yui-compressor

我正在尝试使用 django 管道，应该能够让它工作，但我只是不确定如何在我的系统上安装 yui 压缩器以便管道识别它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:48:21.177

您可以[下载](http://yuilibrary.com/download/yuicompressor/)它并手动安装，也可以使用您的系统包管理器（例如在 Debian: 中`sudo apt-get install yui-compressor`）。之后，您需要在设置中指向二进制文件：

```
PIPELINE_YUI_BINARY = '<path to yuicompressor>' 
```

# java - Spring ClassPathXmlApplicationContext 数据连接

> ID：12338823
> 
> 赞同：0
> 
> 时间：2012-09-09T11:51:14.147
> 
> 标签：java, spring, jdbc, connection

我正在尝试使用 Spring 3.2.0 创建连接，但我得到 NullPointerException：

```
ApplicationContext ctx = new ClassPathXmlApplicationContext("conexao/conexao.xml") 
```

我的文件 conexao.xml 在`conexao`包中。我的 xml 文件配置如下：

```
<beans>
    <bean id="banco" class="modelo.Banco">
        <property name="usuario">
            <value>root</value>
        </property>
        <property name="senha">
            <value>""</value>
        </property>
        <property name="url">
            <value>jdbc:mysql://localhost:3306/agenda</value>
        </property>
        <property name="classForName">
            <value>com.mysql.jdbc.Driver</value>
        </property>
    </bean>
</beans> 
```

它总是在调试时停止：

```
ApplicationContext ctx = new ClassPathXmlApplicationContext("conexao/conexao.xml") 
```

我的代码：

```
package dao;

import com.mysql.jdbc.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Statement;
import model.Banco;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class Conexao {

    private static Banco banco;

    private static Conexao instance;

    public static Conexao getInstance() {
        if (Conexao.instance == null) {
            Conexao.instance = new Conexao();
        }
        return Conexao.instance;

    }

    private Conexao() {

    }

    public Connection abrirConexao() {
        ApplicationContext ctx = new ClassPathXmlApplicationContext(
                "conexao/conexao.xml");
        Connection con = null;
        banco = (Banco) ctx.getBean("Banco");
        try {
            Class.forName(banco.getClassForName()); // Carrega o driver
            con = (Connection) DriverManager.getConnection(banco.getUrl(),
                    banco.getUsuario(), banco.getSenha()); // obtem a conexao
                                                            // com o banco
        } catch (Exception ex) {
            System.out.println(ex.getMessage());
        }

        return con;
    }

    public Statement getStatement() throws SQLException, ClassNotFoundException {
        return abrirConexao().createStatement();
    }

    public PreparedStatement getPreparedStatement(String sql)
            throws InterruptedException {

        PreparedStatement ps = null;
        try {
            ps = this.abrirConexao().prepareStatement(sql);
        } catch (Exception e) {
            System.out
                    .println("Erro com a conexao. Verifique se sua conexao esta ativa.");
        }
        return ps;
    } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:25:59.483

据我所见，您的班级名称不同：

```
import model.Banco; 
```

在xml配置中你有：

```
<bean id="banco" class="modelo.Banco"> 
```

您可以更改 xml 文件`model.Banco`来纠正此问题。

Ivan 已经评论的另一点是区分大小写的名称。由于您正在请求具有名称的 bean，因此`Banco`您也需要将 bean id 更改为`Banco`。

```
banco = (Banco) ctx.getBean("Banco"); // here your request it with upper B 
```

声明是：

```
<bean id="banco" class="modelo.Banco"> 
```

尝试将您的 XML 更改为：

```
<bean id="Banco" class="modelo.Banco"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T11:50:05.077

你能试试这个方法吗

```
ApplicationContext ctx = new ClassPathXmlApplicationContext("classpath:conexao/conexao.xml"); 
```

# less - Ant-Build-Script 不会从 index.html 中删除 less.js 引用

> ID：12338825
> 
> 赞同：0
> 
> 时间：2012-09-09T11:51:37.480
> 
> 标签：less, html5boilerplate

我使用 html5boilerplate ant-build-script

对于 css 我使用较少，这就是我绑定它的方式：

```
<!-- <link rel="stylesheet" href="less/style.css"> -->
<!-- Less: Nur für Dev Setup -->
<link rel="stylesheet/less" type="text/css" href="css/style.less">
<script src="less/less-1.3.0.min.js" type="text/javascript"></script>

<link rel="stylesheet" href="css/normalize.css">
<link rel="stylesheet" href="css/main.css">
<script src="js/vendor/modernizr-2.6.2.min.js"></script> 
```

构建脚本仅更改 *.less -> *.css 但将 less.js 留在 html 中。

对于 cfg，我将这两行添加到我的 build/config/project.properties

```
build.css.less = true
file.root.stylesheet = style.less 
```

有没有办法从 index.html 中删除这条线？

```
<script src="less/less-1.3.0.min.js" type="text/javascript"></script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T12:15:40.287

刚刚在 Wiki 上找到：

[https://github.com/h5bp/ant-build-script/wiki/Compiling-LESS-CSS](https://github.com/h5bp/ant-build-script/wiki/Compiling-LESS-CSS)

# c# - 使用 linq 将 XML 元素连接到 C# 中的类属性

> ID：12338828
> 
> 赞同：1
> 
> 时间：2012-09-09T11:51:56.047
> 
> 标签：c#, xml, linq

我正在学习c#！我想知道是否有一种方法可以定义一个代表 XML 元素的 Class 属性，以及如何从 XML 文件中读取该属性！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T11:58:11.343

那么你当然可以声明一个类型的属性`XElement`：

```
public class Foo
{
    public XElement Bar { get; set; }
} 
```

您可以使用如下代码从 XML 文件中读取它：

```
XDocument doc = XDocument.Load("file.xml");
Foo foo = new Foo();
foo.Bar = doc.Root; // The root element of the file... 
```

显然你可以得到其他元素，例如

```
foo.Bar = doc.Descendants("SomeElementName").First(); 
```

...但没有更具体的问题，很难给出更具体的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T12:02:20.750

假设你有这样的 XML 文件：

```
<Root>
<ExampleTag1>Hello from Minsk.</ExampleTag1>
<ExampleTag2>Hello from Moskow.</ExampleTag2>
...
</Root> 
```

您可以创建如下内容：

```
public class Class1 : IDisposable
    {
        private string filePath;
        private XDocument document;

        public Class1(string xmlFilePath)
        {
            this.filePath = xmlFilePath;
            document = XDocument.Load(xmlFilePath);
        }

        public XElement ExampleTag1
        {
            get
            {
                return document.Root.Element("ExampleTag1");
            }
        }

        public void Dispose()
        {
            document.Save(filePath);
        }
    } 
```

然后使用它：

```
new Class1(filePath).ExampleTag1.Value; 
```

# c# - Pivot-Page SelectionChanged 没有反应

> ID：12338829
> 
> 赞同：1
> 
> 时间：2012-09-09T11:51:59.077
> 
> 标签：c#, windows-phone, pivot

我在 MainPage.cs 中编写了一个 selectionChanged 事件处理程序，但是当我更改数据透视页面时它没有反应：

```
 private void MainPage_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    Debug.WriteLine("Pivot selection changed");
    switch (((Pivot)sender).SelectedIndex)
    {
        case 0:
            Debug.WriteLine("LoginAppBar launched");
            ApplicationBar = ((ApplicationBar)Application.Current.Resources["LoginAppBar"]);
            break;

        case 1:
            Debug.WriteLine("DefaultAppBar launched");
            ApplicationBar = ((ApplicationBar)Application.Current.Resources["AppBar"]);
            break;

        case 2:
            Debug.WriteLine("DefaultAppBar launched");
            ApplicationBar = ((ApplicationBar)Application.Current.Resources["AppBar"]);
            break;
    }
} 
```

为什么这个事件处理程序不起作用？它是方法的名称吗？我试图将方法头更改为私有 void`myNameSpaceHere_SelectionChanged(object sender, SelectionChangedEventArgs e)`

但它仍然没有捕捉到事件。

有小费吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:57:49.710

好吧，明白了。我没有编辑 XAML：

```
 <controls:Pivot Title="APP"
                        x:Name="Pivot"
                        SelectionChanged="Pivot_SelectionChanged"
                        Foreground="#FF72BCE6"
                        BorderThickness="2"> 
```

我必须添加一个 SelectionChanged 属性。

# php - 动态 WordPress 小部件创建

> ID：12338830
> 
> 赞同：3
> 
> 时间：2012-09-09T11:52:15.457
> 
> 标签：php, eval, wordpress

我正在寻找一种更好的方法来为我的插件动态创建小部件。我已经阅读[了这篇文章](http://www.makeuseof.com/tag/how-to-create-wordpress-widgets/)，并且相信我已经掌握了如何创建自定义小部件的基本用法。

现在我的问题是如何根据预定义的选项动态创建多个小部件。我能想到的一种方法是使用`eval()`声明每个扩展类，但是随着类变得越来越大，它会太复杂。我不认为我可以处理作为函数参数传递的 php 代码；转义字符的工作量太大。也有人说使用 eval() 是不安全的，如果可能的话应该避免。

下面的代码已准备好作为插件运行。只需添加标题注释并激活它，您就会看到添加了两个小部件。

```
add_action( 'widgets_init', 'load_mywidgets');
function load_mywidgets() {

    // prepare widgets
    $arrWidgets = array(
        array('id' => 'Bar', 'description' => 'This is a description for Bar', 'title' => 'This is Bar'),
        array('id' => 'Foo', 'description' => 'This is a description for Foo', 'title' => 'This is Foo')
    );

    // define widget class(es) 
    foreach ($arrWidgets as $arrWidget) {
        eval('
            class ' . $arrWidget["id"] . ' extends WP_Widget {

                function ' . $arrWidget["id"] . '() {
                    $widget_ops = array("classname" => "' . $arrWidget["id"] . '"
                                        , "description" => "' . $arrWidget["description"] . '" );
                    $this->WP_Widget("' . $arrWidget["id"] . '", "' . $arrWidget["title"] . '", $widget_ops);           
                }

                function form($instance) {
                    $instance = wp_parse_args( (array) $instance, array( "title" => "" ) );
                    $title = $instance["title"];
                    echo "<p><label for=\"" . $this->get_field_id("title") . "\">Title: <input class=\"widefat\" id=\"";
                    echo $this->get_field_id("title") . "\" name=\"" . $this->get_field_name("title") . "\" type=\"text\" value=\"" . attribute_escape($title) . "\" /></label></p>";
                }

                function update($new_instance, $old_instance) {
                    $instance = $old_instance;
                    $instance["title"] = $new_instance["title"];
                    return $instance;
                }

                function widget($args, $instance) {
                    extract($args, EXTR_SKIP);

                    echo $before_widget;
                    $title = empty($instance["title"]) ? " " : apply_filters("widget_title", $instance["title"]);

                    if (!empty($title))
                        echo $before_title . $title . $after_title;

                    // WIDGET CODE GOES HERE
                    echo "<h1>This is my new widget!</h1>";

                    echo $after_widget;
                }           
            }
        ');
        register_widget($arrWidget["id"]);
    }
} 
```

有没有更简单的方法来做到这一点？我认为在实例化类时将选项传递给构造函数的参数更有意义。但是当我查看核心时，构造函数已经定义并且想知道如何覆盖它。看来 WP_Widget 不是为实例化而设计的。

感谢您的信息。

[编辑]在这里发现了一个类似的问题：[widget create dynamiclly in wordpress plugin](https://stackoverflow.com/questions/11226116/widget-create-dynamiclly-in-wordpress-plugin) 但是建议的解决方案也使用`eval()`，基本上它与我上面介绍的方式相同。当我继续阅读核心时，它似乎`register_widget()`只接受参数的类名，调用`WP_Widget_Factory::register()`. 所以`eval()`可能是这样做的唯一方法。但这并不直观。我仍在寻找一种更简单的方法来做到这一点。

# asp.net - Web.config 影响共享主机帐户中的其他域

> ID：12338834
> 
> 赞同：0
> 
> 时间：2012-09-09T11:52:35.437
> 
> 标签：asp.net, mysql, web-config, shared-hosting

我可以选择在共享主机帐户上托管多个域。我必须将我的主域托管在根文件夹中，而其他域可以托管在该根文件夹中，每个托管域都有单独的文件夹。主域 domain1.com 运行良好。但是，当我为我的 domain2.com 创建一个新文件夹时，它的配置文件夹名称为“domain2”，并上传了一个静态welcome.html 页面，它显示以下错误：

```
Server Error in '/domain2' Application.

Configuration Error

Description: An error occurred during the processing of a configuration file required to service this request. Please review the specific error details below and modify your configuration file appropriately. 

Parser Error Message: Could not load file or assembly 'MySql.Web' or one of its dependencies. The system cannot find the file specified.

Source Error: 

Line 37:            <providers>
Line 38:                <clear/>
Line 39:                <add connectionStringName="domain1MembershipDB" applicationName="/" autogenerateschema="true" name="MySqlRoleProvider" type="MySql.Web.Security.MySQLRoleProvider, MySql.Web"/>
Line 40:            </providers>
Line 41:        </roleManager>

Source File: D:\Hosting\4343434\html\web.config    Line: 39 

Assembly Load Trace: The following information can be helpful to determine why the assembly 'MySql.Web' could not be loaded.

WRN: Assembly binding logging is turned OFF.
To enable assembly bind failure logging, set the registry value [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) to 1.
Note: There is some performance penalty associated with assembly bind failure logging.
To turn this feature off, remove the registry value [HKLM\Software\Microsoft\Fusion!EnableLog].

Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

但这是与我的主域 domain1.com 的 web.config 文件相对应的行，并且 domain1.com 仍然可以正常工作。

我错过了任何一点信息吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:07:53.667

这是因为您的辅助域继承了 web.config 定义，但它没有对必要的 dll 的引用`MySql.Web.dll`。

如果在二级域中添加，可以清除上一级的连接字符串：

```
<roleManager>
   <providers>
     <clear/>
   </providers>
</roleManager> 
```

# linux - 如何使用相同的环境生成新的 xterm

> ID：12338835
> 
> 赞同：2
> 
> 时间：2012-09-09T11:52:34.530
> 
> 标签：linux, shell, virtualenv

我正在使用`virtualenv`（它设置了一些环境变量）。现在，我想生成一个具有相同环境的新终端窗口。如果我尝试：

```
xterm & 
```

我得到一个新终端，但环境是默认环境，即在新终端上输入以下行时：

```
pserve --reload development.ini 
```

我得到：

```
>> pserve: Command not found. 
```

另一方面，如果我执行：

```
xterm -e pserve --reload development.ini & 
```

它会打开一个运行 pserve 的新终端。所以，我的问题是：

1.  一般如何在相同环境下打开一个新的终端
2.  `pserve`当我使用`-e`switch运行新终端时，它如何找到？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T12:00:43.483

要回答您的第一个问题，一种快速而肮脏的方法是使用 sh 内置的“设置”命令（更多信息请参见“帮助设置”）。

从旧外壳：

```
set > ~/env.tmp 
```

然后

```
xterm & 
```

从新外壳：

```
. ~/env.tmp && rm ~/env.tmp 
```

你可能想把它包装在一个脚本中，或者在你的“bash.rc”中添加几个函数。您可能还想使用 'mktemp(1)' 或类似的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T10:35:44.187

根据@dmp 的建议，我在 ~/.bashrc 中添加了以下内容：

```
# save the environment, apart from readonly variables that can not be restored
alias cloneterm='set |egrep -v "^(BASHOPTS|BASH_COMPLETION_COMPAT_DIR|BASH_VERSINFO|EUID|PPID|SHELLOPTS|UID)=" > /tmp/env.tmp && $TERM &'
# restore a previously saved environment, if any
[ -f /tmp/env.tmp ] && source /tmp/env.tmp
[ -f /tmp/env.tmp ] && rm /tmp/env.tmp 
```

现在我可以简单地运行

```
$ cloneterm 
```

我得到一个新的终端窗口，环境相同

希望这可以帮助

笔记：

*   这只是 bash，但也应该适用于其他终端（即使我只在 xterm 上测试过）
*   这可能会在多用户系统中中断，但对于台式机/笔记本电脑配置来说已经足够了

# c# - 在 WPF 中创建测量条

> ID：12338840
> 
> 赞同：0
> 
> 时间：2012-09-09T11:53:21.463
> 
> 标签：c#, .net, wpf, controls

我正在开发一个测量系统，我需要以一种很好的图形方式向用户表示测量级别。我在 Photoshop 中设计了一个测量栏，现在我正在尝试在 WPF 中实现它。

有谁知道如何最好地实施这种控制？我虽然它应该有一个最大值/最小值，并且根据它会通过使用变换移动的有界值，这是更容易的部分，但实际的图形在这里很棘手......

我正在考虑的控件如下所示：

![在此处输入图像描述](../Images/afee9c5c9d26e548a627e559c692f589.png)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:26:38.807

您很可能需要 ProgressBar 控件。

或者从头开始制作你自己的，只需[在谷歌中搜索这个](http://kishor-naik-dotnet.blogspot.co.uk/2011/03/wpf-custom-progress-bar-in-wpf.html)展示如何创建你自己的自定义控件的网站作为第一个列表出现

[http://kishor-naik-dotnet.blogspot.co.uk/2011/03/wpf-custom-progress-bar-in-wpf.html](http://kishor-naik-dotnet.blogspot.co.uk/2011/03/wpf-custom-progress-bar-in-wpf.html)

# css - CakePHP 调用非常古老的 css 文件。如何刷新

> ID：12338843
> 
> 赞同：1
> 
> 时间：2012-09-09T11:53:33.763
> 
> 标签：css, cakephp-2.1

我有我的 default.ctp 文件

```
...
<?php echo $this->Html->css('style.css'); ?>
...
<style type="text/css">
      // other css rules
</style>
... 
```

如果我在 style.css 末尾合并“其他 css 规则”，则永远不会使用此规则。为什么？我不知道该怎么做。我已经手动删除了cakephp的缓存，清除了firefox的缓存，甚至在我调用css文件时尝试追加`?v=0.1`，但没有任何改变。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-02T17:23:23.693

nonsone 的回答很好，但这将禁用使用缓存的优势，它会在每次加载页面时加载新的 css 文件。不要使用`time()`函数，而是尝试使用`filemtime()`函数，该函数将输出文件的最后修改日期时间，因此浏览器只会在 css 文件被修改或（绝对）chace 为空时加载 css。

```
<?php echo $this->Html->css('style.css?'.filemtime('style.css')); ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T09:12:34.867

你确定更新后的css文件真的上传到服务器了吗？

在浏览器中加载 css 文件时会发生什么？域名.com/css/style.css

尝试以下强制浏览器禁用缓存

`<?php echo $this->Html->css('style.css?'.time()); ?>`

# c# - MVC 3 - 视图模型的子对象上的客户端验证

> ID：12338847
> 
> 赞同：1
> 
> 时间：2012-09-09T11:54:24.660
> 
> 标签：c#, asp.net-mvc-3

我有一个看起来像这样的视图模型 -

```
public class upgradeViewModel
{
    public Cart Cart { get; set; }
    public RegisterModel RegisterModel { get; set; }
} 
```

视图模型包含一个名为模型对象的属性`RegisterModel`，`RegisterModel`看起来与此类似 -

```
public class RegisterModel
{
    [Required]
    [Display(Name = "Your name")]
    public string UserName { get; set; }

    [Required]
    [DataType(DataType.EmailAddress)]
    [Display(Name = "Your email address")]
    public string Email { get; set; }

    ...
} 
```

我使用视图模型上的属性在使用对象作为模型`RegisterModel`的视图中设置表单。`upgradeViewModel`在提交表单时，我没有得到任何客户端验证，尽管我确实得到了`RegisterModel`对象的服务器端验证。

我相信我已经正确配置了所有内容，以便不显眼的客户端验证正常工作，并且它可以在网站的其他区域工作。我需要做一些额外的事情来让客户端验证为视图模型的子对象工作吗？

这是我的视图代码 -

```
@model upgradeViewModel

@{
    ViewBag.Title = "Title";
    Layout = "~/Views/Shared/_LayoutNormal.cshtml";
}

<h2>Title</h2>

Some text ....

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true, "Account creation was unsuccessful. Please correct the errors and try again.")
    <div>
        <fieldset>
            <legend>Your Information</legend>

            <div class="editor-label">
                @Html.LabelFor(m => m.RegisterModel.UserName)
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(m => m.RegisterModel.UserName)
                @Html.ValidationMessageFor(m => m.RegisterModel.UserName)
            </div>

            <div class="editor-label">
                @Html.LabelFor(m => m.RegisterModel.Email)
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(m => m.RegisterModel.Email)
                @Html.ValidationMessageFor(m => m.RegisterModel.Email)
            </div>

            <div class="editor-label">
                @Html.LabelFor(m => m.RegisterModel.Password)
            </div>
            <div class="editor-field">
                @Html.PasswordFor(m => m.RegisterModel.Password)
                @Html.ValidationMessageFor(m => m.RegisterModel.Password)
            </div>

            <div class="editor-label">
                @Html.LabelFor(m => m.RegisterModel.ConfirmPassword)
            </div>
            <div class="editor-field">
                @Html.PasswordFor(m => m.RegisterModel.ConfirmPassword)
                @Html.ValidationMessageFor(m => m.RegisterModel.ConfirmPassword)
            </div>

            <p>
                <input type="submit" value="Save Details" class="inputbutton" />
            </p>
        </fieldset>
    </div>
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:07:11.667

您应该确保以下 appsettings 在您的 web.config 文件中。你已经在你的页面上引用了 jquery.validate.unobtrusive.min.js 。（当你创建它时，它应该在你的 MVC 项目的 Scripts 文件夹中）

```
<add key="ClientValidationEnabled" value="true" />
<add key="UnobtrusiveJavaScriptEnabled" value="true" /> 
```

# python - 将文本添加到 python 生成的图像

> ID：12338848
> 
> 赞同：2
> 
> 时间：2012-09-09T11:54:27.760
> 
> 标签：python, image, qr-code

我有一个 python 读取一个串行端口，然后从这个数据创建一个 QR 码。我想要做的是将用于制作二维码的数据添加到生成的图像中。

```
qr = qrcode.QRCode(
    version=1,
    box_size=10,
)
data1 = arduino.readline()
shadata1 = hashlib.sha1(data1).hexdigest()

qrdata = data1 + shadata1[0] + shadata1[1] + shadata1[2] + shadata1[3] + shadata1[4] + shadata1[5]
qr.add_data(qrdata)
qr.make(fit=True)

img = qr.make_image()
img_file = "/" + data1 + ".png"
img.save(img_file, 'PNG') 
```

所以目前我得到一个生成并保存的二维码，我想要以下

```
 _____________
|             |  "Title"
|             |  Data1
|             |  "Pin Code"
|             |  shadata1[0] shadata1[1] shadata1[2] shadata1[3] shadata1[4] shadata1[5]
|             |
|_____________| 
```

我不知道我将如何实际执行该操作。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T11:58:01.443

使用[Python 图像库](http://www.pythonware.com/products/pil/)，您可以操作图像，包括向图像添加文本。

请注意，PIL 仅适用于 Python 2.x。v3 支持即将推出。

# python - 在 django 中使用 oauth 和 send_mail 发送电子邮件

> ID：12338849
> 
> 赞同：5
> 
> 时间：2012-09-09T11:54:47.210
> 
> 标签：python, django, oauth-2.0

我已按照以下步骤操作： [http ://code.google.com/p/google-mail-xoauth-tools/wiki/XoauthDotPyRunThrough](http://code.google.com/p/google-mail-xoauth-tools/wiki/XoauthDotPyRunThrough)

并生成了 oauth_token、oauth_token_secret 和 xoauth。

现在的问题是 - 我如何发送包含上述信息的电子邮件？我已经配置了 smtp 主机和端口，它可以工作，但我不想处理原始密码。

我的意思是：

```
send_mail('Subject here', 'mesage here', 'me@gmail.com',
        ['you@gmail.com','him@gmail.com'], fail_silently=False,
        auth_user="me@gmail.com", auth_password="password") 
```

完美运行。

将不胜感激任何帮助。

# android - 在较低 api 级别的设备中使用较高的 api 级别功能

> ID：12338858
> 
> 赞同：2
> 
> 时间：2012-09-09T11:56:10.663
> 
> 标签：android

我使用 sdk 版本 10 开发了我的应用程序。在较低版本中没有较高版本中可用的功能。是否有任何 api 可用于在较低 api 级别的设备中使用较高级别的 api 功能。

注意：例如我们无法在 api 级别 8 中获取相机数量，但我们可以在 api 级别 9 中获取详细信息。如果我们尝试使用该功能应用程序会显示异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T11:57:47.827

这是不可能的，你需要实现它，或者使用一些兼容性包来获得功能。

但请注意，并非一切都可以模仿。例如，实现 Base64 类很容易，但由于缺少所需的硬件，因此不可能将 NFC 功能添加到旧版本中。

您可以简单地检查实际的 android 版本并构建一个开关，这样您就不会调用该设备不可用的任何功能。这可以通过常量[android.os.Build.VERSION](http://developer.android.com/reference/android/os/Build.VERSION.html)实现。

# vaadin - Vaadin Field.class 接口扩展了 Focusable.class 和 Component.class！！为什么？

> ID：12338860
> 
> 赞同：0
> 
> 时间：2012-09-09T11:57:08.497
> 
> 标签：vaadin

我很困惑为什么 Vaadin 中的 Feild 接口扩展了 Focusable 和组件接口？因为 Focusable 接口扩展了组件本身！它足以让 Field 接口扩展可聚焦性。我在这里错过了什么吗？这有什么理由吗？

谁能帮我吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:00:43.763

不，这没有语义上的原因。这可能是风格问题，或者可能是该类显式扩展它已经隐式扩展的接口的历史原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T07:30:22.127

反正我找到了原因:)！当他们在库的下一个版本中更改代码时，似乎这只是一个错误

# java - RTSP 描述标头没有响应

> ID：12338866
> 
> 赞同：1
> 
> 时间：2012-09-09T11:57:52.093
> 
> 标签：java, android, header, rtsp, sdp

我正在编写 RTSP 流媒体服务器，我需要一些帮助。我想我已经尝试了一切并阅读了主题：

[从 android 上的 IP 摄像头接收视频流](https://stackoverflow.com/questions/10685625/receiving-video-stream-from-an-ip-camera-on-android)

[在 VLC 播放器中播放 RTSP 流](https://stackoverflow.com/questions/5880739/playing-rtsp-stream-in-vlc-player)

[Android 本地 RTSP 服务器（欺骗），PVPlayer 在发送 DESCRIBE 回复后关闭 TCP 套接字](https://stackoverflow.com/questions/7973065/android-local-rtsp-server-spoof-pvplayer-closes-tcp-socket-after-describe-rep)

和其他与他们类似的。当然，我也阅读了许多 pdf 和 RFC。

我的故事：我写了 rtsp 服务器，当我向 DESCRIBE 标头发送响应时出现问题：

```
responseHeader.append(HeaderStates.OK);
responseHeader.append(CRLF);
responseHeader.append(CSeq);
responseHeader.append(CRLF);
responseHeader.append("session: ");
responseHeader.append(Long.valueOf(sessionID));
responseHeader.append(CRLF);
Date date = new Date();
responseHeader.append("Date: ");
responseHeader.append(date.toGMTString());
responseHeader.append(CRLF);
responseHeader.append("Content-Type: application/sdp");
responseHeader.append(CRLF);
responseHeader.append("Content-Base: ");
responseHeader.append(localAddress.getHostAddress());
responseHeader.append(":");
responseHeader.append(Integer.valueOf(localPort));
responseHeader.append(CRLF);
responseHeader.append(CRLF);
responseHeader.append("v=0");
responseHeader.append(CRLF);
responseHeader.append("o=- ");
responseHeader.append(date.getTime());
responseHeader.append(" ");
responseHeader.append(date.getTime());
responseHeader.append(" IN IP4 ");
responseHeader.append(localAddress.getHostAddress());
responseHeader.append(CRLF);
responseHeader.append("a=control:rtsp://192.168.1.143:55555");
responseHeader.append(CRLF);
responseHeader.append("s=RTSPSession");
responseHeader.append(CRLF);
responseHeader.append("m=video 55555 RTP/AVP 26");
responseHeader.append(CRLF);
responseHeader.append("a=rtpmap:26 JPEG/90000");
responseHeader.append(CRLF);
responseHeader.append("a=mimetype:video/JPEG");
responseHeader.append(CRLF);
//responseHeader.append("a=control:trackID=1");
responseHeader.append(CRLF);
responseHeader.append(CRLF); 
```

其中 HeaderStates.OK 是“200 OK”，SessionID 是 System.currentTimeMillis()，CRLF = “\r\n”，responseHeader 以“RTSP/1.0”开头

然后 VLC（我的 PC 上的客户端抛出未处理的异常并崩溃），SMPlayer 读取标题并将其显示在日志中但不响应。

有时我会在 SMPlayer 日志中显示 SDP 中的错误，但我认为此错误的原因是调试时间过长。

我的问题：我做错了什么？为什么客户端没有 SETUP 标头？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:36:00.080

您缺少`CSeq`RtspResponse 中的标头，因此它是无效的。

同样在您的示例中，您正在返回一个 SDP，因此您需要`Content-Length`标题！

查看我的服务器[@http://net7mma.codeplex.com/](http://net7mma.codeplex.com/)以查看现有实现的代码，虽然它是在 C# 中，但您应该能够获得您需要的东西。

# java - Java中的循环链表实现

> ID：12338868
> 
> 赞同：12
> 
> 时间：2012-09-09T11:58:04.990
> 
> 标签：java, linked-list, circular-list

这是一个任务。我必须创建一个循环链表并删除列表中的每三个数字。当我的程序到达列表的末尾时，它应该回到头部并继续该过程，直到只剩下一个数字。

我在网上和其他一些参考书上搜索过，但无法解决我的问题。我发现的大多数参考资料都说：

> 除了循环列表没有尽头之外，它们与常规列表完全相同

或（取自我的教科书）：

> 如果最后一个节点的后继节点是第一个，则单链表是循环链接的

但是这些并没有告诉如何去做。我也尝试过使用我在这个网站上找到的一些代码，但这并没有解决任何问题。

我可以创建一个列表（我不知道它是否是一个循环链表）并显示它，但是元素的顺序很奇怪：

*   如果列表有 6 个数字，则列表将为 1、6、5、4、3、2。
*   如果列表有 8 个数字，则列表将为 1,8,7,6,5,4,3,2。

如果没有正确的列表，我可以正确地进行删除。以下代码有什么问题：

```
public class LastNumberDemo {
    public static void main(String[] args) {
        LastNumberNode ll=new LastNumberNode();
        System.out.println("how long is the list: ");
        Scanner keyboard = new Scanner(System.in);
        int input = keyboard.nextInt();

        if(input<=0) {
            System.out.println("no number to creat list");
        }
        if(input==1) {
            System.out.println("The Last number is 1.");
        }
        else {
            String[] n=new String[input];
            for(int index=0; index<n.length; index++)
                n[index]=Integer.toString(index+1);
            for(String e:n)
                ll.add(e);
            System.out.print("The list contains: \n");
            ll.print();
            System.out.print("\nThe last number is: ");
            ll.remove();
            ll.print();
        }
    }
} 
```

* * *

```
//The circular linked list class
class LastNumberNode{
    private class Node{
        String value;  
        Node next;     

        Node(String val, Node n){
            value = val;
            next = n;
        }

        Node(String val){
            value=val;
            next=null;
        }
    } //This brace was missing - Edd

    private Node first;

    public LastNumberNode(){
      first = null;
    }

    public boolean isEmpty(){        
       return first == null;
    }

    public int size(){
        int count = 0;
        Node p = first.next;   
        while (p != first){
            count ++;
            p = p.next;
        }
        return count;
    }

    public void add(String e) {
        Node p=new Node(e);
        if(first==null){
            first=p;
            first.next=first;
        }
        else{
            first.next=new Node(e,first.next);
        }
    }

    public void remove(){
        while(size()>0){
            Node target=first.next.next;   
            Node temp=first;               
            target=target.next;          
            last.next=temp;
            first=target;
        }
    }

    public void print(){
        Node ref=first;
        for(int index=-1; index<size();index++)
            System.out.print(ref.value+" ");
        ref=ref.next;
    }
} //Extra brace removed - Edd 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T15:35:14.510

当您`Node`向列表中添加一个新节点时，您将新节点添加`Node`到第二个位置（`first.next`指向您新添加的节点），但是这个新添加的节点`first`作为其下一个节点，使列表的其余部分未被引用（因此被垃圾收集并销毁）。使用您的`add`方法，您的列表不可能包含除 0、1 或 2 之外`Node`的任何内容。`Node`在列表中间添加 new 有点奇怪；要么将其添加到前面（`newnode.next = first; first = newnode; last.next = first;`），要么保留对列表后面的引用（如其他人所建议的那样），然后将其添加到那里。

就个人而言，我会重组`LastNumberNode`该类，使其具有以下操作链表的方法：

*   `private void addNode(Node node)`
*   `private void removeNode(Node node)`
*   `private Node findNode(Node nextNode)`

如果您维护对列表中最后一个节点的引用，那么您的`addNode(Node node)`方法可能类似于以下内容：

```
if(isEmpty()) {
    first = node;
    last = node;
}
else {
    Node tail = last;
    tail.next = node;
    node.next = first;
    last = node;
} 
```

`removeNode(Node node)`基于以下几点：

```
Node prevNode = findNode(node);

if(node == first) {
    first = node.next;
    last.next = first;
}
else if(node == last) {
    prevNode.next = first;
    last = prevNode;
}
else {
    prevNode.next = node.next;
} 
```

`Node`如果我要实现这一点，我可能会使用这种方法将列表减少到一个：

```
public String reduceList() {
    Node curNode = first;
    while(first != last) {
        removeNode(curNode.getNext().getNext());
        curNode = curNode.getNext().getNext();
    }

    return first.getValue();
} 
```

最后一点，我不会费心用序列号填充数组，然后遍历它以将元素添加到列表中。我会直接进行以下操作：

```
for(int i = 1; i <= input; i++) {
    linkedlist.add(new Integer(i).toString());
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-09T12:05:40.313

如果 first 已设置，您的`add`方法会直接在之后插入元素：`first`

```
first.next = new Node(e, first.next); 
```

这导致观察到的行为。

您需要跟踪列表的**最后一个**元素并添加新元素，就`last.next`好像要将新元素附加到列表的末尾一样。一种方法是简单地将对最后一个元素的引用保存在列表类的成员变量中，另一种方法是遍历列表，直到找到链接到的节点，该节点`first`将是最后一个节点。

# ruby - 使用正则表达式和 ruby 拆分方法名称

> ID：12338873
> 
> 赞同：2
> 
> 时间：2012-09-09T11:59:27.410
> 
> 标签：ruby, regex

我想使用正则表达式来获取方法名称的每个变体，如下所示：

```
method_name = "my_special_title"
method_name_variants = ["my_special_title", "special_title", "title"] 
```

我可以这样做：

```
r = /((?:[^_]*_)?((?:[^_]*_)?(.*)))/
r.match("my_special_title").to_a.uniq
=> ["my_special_title", "special_title", "title"] 
```

是否可以有任意的方法长度，所以我们可以有：

```
"my_very_special_specific_method" => ["my_very_special_specific_method", "very_special_specific_method", "special_specific_method", "specific_method", "method"] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T12:21:38.973

这是一种方法：

```
s = "my_very_special_specific_method"
a = s.split('_')
a.length.times.map { |n| a.from(n).join('_') }

=> ["my_very_special_specific_method", "very_special_specific_method", 
    "special_specific_method", "specific_method", "method"] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T12:17:12.267

我会这样做：

```
method_name = "my_special_title"
parts = method_name.split('_')
arr = []
(0..parts.length-1).each { |i| arr << parts[i..-1].join('_') } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-09T13:38:38.220

```
method_name_variants = [method_name]
while last = method_name_variants.last.split("_", 2)[1]
    method_name_variants.push(last)
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T12:22:30.190

```
def my_method (str,split_by,join_by)
    results = Array.new    
    arr = str.send(:split,split_by)
    arr.count.times do |element|
    results << arr.send(:join,join_by) unless arr.blank?
   arr.pop
 end
results
end 
```

呼叫人

```
my_method("my_special_title",'_','_') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-09T12:27:44.740

`"very_special_name".split /_/`=>`["very","special","name"]`然后重新组装怎么样：

```
method_name = "my_very_special_method_name"
(*pref, base) = method_name.split /_/
a = [base]
pref.reverse.each do |prefix|
    a << (prefix + "_" + a[-1])
end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-09T12:30:05.443

在一行中：

```
str = "my_very_special_specific_method"
str.split('_').reverse.reduce([]){|acc, s| acc << s+'_'+acc.last.to_s}.reverse.map!{|s| s[0..-2]} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-09T23:04:02.397

```
a = "some_method_name".split '_'
a.map {|element| a[(a.index element)...a.length].join '_' }

# => ["some_method_name", "method_name", "name"] 
```

# python - 使用 minidom 解析 xml

> ID：12338877
> 
> 赞同：0
> 
> 时间：2012-09-09T12:00:31.483
> 
> 标签：python, xml, minidom

嗨，我无法理解 Python 的 minidom 模块。

我有看起来像这样的xml：

```
<Show>
<name>Dexter</name>
<totalseasons>7</totalseasons>
<Episodelist>
<Season no="1">
<episode>
<epnum>1</epnum>
<seasonnum>01</seasonnum>
<prodnum>101</prodnum>
<airdate>2006-10-01</airdate>
<link>http://www.tvrage.com/Dexter/episodes/408409</link>
<title>Dexter</title>
</episode>
<episode>
<epnum>2</epnum>
<seasonnum>02</seasonnum>
<prodnum>102</prodnum>
<airdate>2006-10-08</airdate>
<link>http://www.tvrage.com/Dexter/episodes/408410</link>
<title>Crocodile</title>
</episode>
<episode>
<epnum>3</epnum>
<seasonnum>03</seasonnum>
<prodnum>103</prodnum>
<airdate>2006-10-15</airdate>
<link>http://www.tvrage.com/Dexter/episodes/408411</link>
<title>Popping Cherry</title>
</episode> 
```

更漂亮：[http ://services.tvrage.com/feeds/episode_list.php?sid=7926](http://services.tvrage.com/feeds/episode_list.php?sid=7926)

这是我试图从中读取的python代码：

```
xml = minidom.parse(urlopen("http://services.tvrage.com/feeds/episode_list.php?sid=7926"))
for episode in xml.getElementsByTagName('episode'):
    for node in episode.attributes['title']:
        print node.data 
```

我无法获取实际的剧集数据，因为我想获取每集的所有数据。我尝试了不同的变体，但我无法让它工作。大多数情况下，我得到了`<DOM Element: asdasd>`回报。我只关心每一集里面的数据。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:21:42.330

`title`不是属性，而是标签。一个属性就像`src`在`<img src="foo.jpg" />`

```
>>> parsed = parseString(s)
>>> titles = [n.firstChild.data for n in parsed.getElementsByTagName('title')]
>>> titles
[u'Dexter', u'Crocodile', u'Popping Cherry'] 
```

您可以扩展上述内容以获取其他详细信息。[`lxml`](http://codespeak.net/lxml/)不过更适合这个。正如您从上面的代码片段中看到的那样，minidom 并不是那么友好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T12:22:53.560

每个`episode`元素都有子元素，包括一个`title`元素。但是，您的代码正在寻找*属性*。

要从 minidom 元素中获取文本，您需要一个辅助函数：

```
def getText(nodelist):
    rc = []
    for node in nodelist:
        if node.nodeType == node.TEXT_NODE:
            rc.append(node.data)
    return ''.join(rc) 
```

然后您可以更轻松地打印所有标题：

```
for episode in xml.getElementsByTagName('episode'):
    for title in episode.getElementsByTagName('title'):
        print getText(title) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T12:24:16.657

感谢 Martijn Pieters 向我推荐了 ElementTree API，我解决了这个问题。

```
xml = ET.parse(urlopen("http://services.tvrage.com/feeds/episode_list.php?sid=7296"))
                print 'xml fetched..'
                for episode in xml.iter('episode'):
                    print episode.find('title').text 
```

谢谢

# binary - (初级) 二进制转换程序问题

> ID：12338878
> 
> 赞同：0
> 
> 时间：2012-09-09T12:00:41.633
> 
> 标签：binary, flowchart

我是开发的初学者，并且在 RAPTOR 中制作了一个可以运行的流程图。该程序将 8 位二进制值转换为十进制，但是无论何时运行，它始终输出 0 作为最终答案。

我认为的问题是红色圈出的 if 语句，由于某种原因，它似乎总是评估为 0。

![我在 Raptor of Binary Conversion 程序中的流程图](../Images/bfb951e87d2b4e6dfc44a62adfb11792.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-18T10:19:34.597

通过@Jtaylor-Pentacle、@Rotem 的对话摘要来回答。

基于[RAPTOR 流程图的编程](http://raptor.martincarlisle.com/)似乎有一些独特的语法，主要用作一些大学的培训工具。如果您想学习编程，建议您离开 Raptor 并潜心研究并找到一种语言来学习。

# django - Django：包含多个参数的标签

> ID：12338882
> 
> 赞同：1
> 
> 时间：2012-09-09T12:01:04.557
> 
> 标签：django

我编写了一个包含标签来显示带有许多（可选）参数的专辑评论。这是标签：

```
@register.inclusion_tag('reviews/review_trail.html')
def review_trail(review, coverPosition='left', scoreMode='corner', showLargeHeadings=False, wordsToShow=30):
return {
    'r' : review, 
    coverPosition: coverPosition, 
    scoreMode: scoreMode, 
    showLargeHeadings: showLargeHeadings, 
    wordsToShow: wordsToShow 
} 
```

我这样称呼标签：

```
{% review_trail review=r coverPosition="right" %} 
```

`reviews`除了/`r`值之外，似乎没有任何参数传递到我的 HTML 模板。如果我在包含标签中记录参数，我会看到它们正确传递，但是当我在其中输出它们时`review_trail.html`它们都是空白的。我使用了错误的语法，还是不能以这种方式使用多个参数？使用 Django 1.4 和[文档似乎表明这很好](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#inclusion-tags)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:20:58.940

您没有对字典中的所有键使用单引号，因此 python 使用变量的值作为键的名称。

将其更改为：

```
return {
    'r': review, 
    'coverPosition': coverPosition, 
    'scoreMode': scoreMode, 
    'showLargeHeadings': showLargeHeadings, 
    'wordsToShow': wordsToShow 
} 
```

# php - 如何合并 2 个 PHP 'for' 循环？

> ID：12338884
> 
> 赞同：0
> 
> 时间：2012-09-09T12:01:13.707
> 
> 标签：php, loops, for-loop

> **可能重复：**
> [Php for 循环有 2 个变量？](https://stackoverflow.com/questions/1172553/php-for-loop-with-2-variables)

有没有办法让它更短：

```
for ($x = 1; $x <= 5; $x++) {
for ($y = 1; $y <= 5; $y++) {
    echo $x, ' ', $y, '<br>';
}
} 
```

2 for 循环似乎很尴尬

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:03:49.360

不是真的，嵌套循环没有错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T12:04:33.470

如果不知道循环内部发生了什么，就很难说清楚。为什么你首先有两个循环？

如果你只需要循环 25 次，你可以在一个循环中做到这一点：

```
for ($x = 1; $x <= 25; $x++) {
    //Looped code
{ 
```

但是，如果您需要不同的变量 (`$x`和`$y`)，那就更难说了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T12:04:54.553

没关系。当你有 4 或 5 个 for 循环时，你应该考虑优化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T12:09:11.883

您还可以在一个 for 循环中使用逗号分隔的多个变量。

```
for ($i = 1, $j = 0; $i <= 10 && $j < 5; $i++, $j++) 
```

# java - 如何从 java 代码在 unix 终端中执行外部工具？

> ID：12338891
> 
> 赞同：1
> 
> 时间：2012-09-09T12:01:43.980
> 
> 标签：java, shell, unix, command

我尝试在 java 代码中执行一个基本命令，即“java -version”。我的代码适用于 shell 命令，例如“ls”、“echo $PATH”等。我的代码：

```
import java.io.*;

public class cmd {
    public static void main(String[] args) {

        String command = "java -version";
        Process proc = null;
        try {
            proc = Runtime.getRuntime().exec(command);
        } catch (IOException e1) {
            System.out.println( "IOException 1" );
        }

        BufferedInputStream buffer = new BufferedInputStream( proc.getInputStream() );
        BufferedReader commandOutput= new BufferedReader( new InputStreamReader( buffer ) );
        String line = null;
        try {
            while ( ( line = commandOutput.readLine() ) != null ) {
                System.out.println( line );
            }
            commandOutput.close(); 
        } catch ( IOException e) {
            System.out.println( "IOException 2" );
        }
    }
} 
```

代码正常工作，没有异常或错误，但没有输出。

如果 String command = "ls"，则代码可以运行，并且可以在控制台中看到输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:06:20.787

检查您拥有的 Process 对象的[.getErrorStream()](http://docs.oracle.com/javase/6/docs/api/java/lang/Process.html#getErrorStream%28%29)和[.getOutputStream() 。](http://docs.oracle.com/javase/6/docs/api/java/lang/Process.html#getOutputStream%28%29)您可能会在那里看到一条错误消息，告诉您需要指定 java 可执行文件的完整路径才能使其正常工作。但是，如果原因有所不同，您在输出上述流的内容时也应该看到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T12:06:54.820

Redirect the command's output to a tempfile like "ls > tempt.txt". That might fix the problem

# c# - 未调用 ServiceStack ResponseFilterAttribute

> ID：12338894
> 
> 赞同：4
> 
> 时间：2012-09-09T12:02:25.363
> 
> 标签：c#, asp.net, aop, servicestack

```
//---------------------------------------------------------------------
//Aspect Filters
public class RequestAspectAttribute : RequestFilterAttribute {
  public RequestAspectAttribute() { } //debug point was hit
  public RequestAspectAttribute(ApplyTo applyTo) : base(applyTo) { }
  public override void Execute(IHttpRequest req, IHttpResponse res, object reqDto) {
      //This code is executed before the service 
      //debug point was hit
  }
}
public class ResponseAspectAttribute : ResponseFilterAttribute {
  public ResponseAspectAttribute() { } //debug point was NOT hit
  public ResponseAspectAttribute(ApplyTo applyTo) : base(applyTo) { }
  public override void Execute(IHttpRequest req, IHttpResponse res, object resDto) {
      //This code is executed after the service 
      //debug point was NOT hit
  }
}
//---------------------------------------------------------------------
//REST Service
[RequestAspect]
[ResponseAspect]
public class TodoService : RestServiceBase<Todo> { ... 
```

我正在使用上面的代码测试 ToDo List 示例项目中的 Req/Res 过滤器属性。因此，除了两个附加属性外，示例项目（我认为）没有任何其他更改。

当我添加一个待办事项时，只调用了请求属性。响应属性没有被触发。

在这种情况下，他们不应该在休息呼叫之前和之后成对启动吗？是我的理解不正确还是我做错了什么？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-19T05:37:51.207

将您的请求和响应过滤器与相应的请求和响应 DTO 一起使用

```
 [Route("/Hello")]
    [RequestAspect]
    public class HelloRequest
    {
        public string hello { get; set; }
    }
    [ResponseAspect]
    public class HelloResponse
    {
        public string hello { get; set; }
    }
    public class HelloService : Service
    {
        public object Any(HelloRequest req)
        {
            return new HelloResponse
            {
                hello = req.hello
            };
        }
    } 
```

# android - 布局上的动画？

> ID：12338895
> 
> 赞同：1
> 
> 时间：2012-09-09T12:02:29.097
> 
> 标签：android, animation, layout, view

当我启动我的应用程序时，您会看到布局 (color.black) 和一个按钮。现在在按钮下，我有一个以图像为背景的视图（30dp x 30dp）。这个视图应该从左到右移动。就是这样。我搜索并发现，有例如Transition Drawable。但我不知道，这是最好的解决方案吗？我的意思是，我只想要一个小的背景动画。我不希望这样，当我单击按钮时，应用程序会有点冻结。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:11:18.743

如果您的 apk 版本低于 3.0，请使用此链接[http://nineoldandroids.com/](http://nineoldandroids.com/)中的库，否则使用对象动画师

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T12:08:03.447

您应该将视图动画用于简单动画。它易于设置，您可以根据需要对其进行配置。

查看动画：http: [//developer.android.com/guide/topics/graphics/view-animation.html](http://developer.android.com/guide/topics/graphics/view-animation.html)

示例教程（旋转，但线性运动同样简单）： [http ://www.edumobile.org/android/android-programming-tutorials/rotating-text-animation/](http://www.edumobile.org/android/android-programming-tutorials/rotating-text-animation/)

# windows - 访问外部 Windows 窗体应用程序并读取其内容

> ID：12338896
> 
> 赞同：0
> 
> 时间：2012-09-09T12:02:30.850
> 
> 标签：windows, forms, external-application

我正在尝试生成一个应用程序，它扫描另一个应用程序并找到它在其表单上显示的电话号码。我事先不知道它将是哪个外部应用程序，但我知道它将是一个 Windows 窗体应用程序。

这可能吗？如果可以，最好的方法是什么？

# python - 使用 Whoosh 我无法搜索包含多字查询的文档。

> ID：12338898
> 
> 赞同：1
> 
> 时间：2012-09-09T12:02:45.427
> 
> 标签：python, search, documents, whoosh

使用 Whoosh 我无法搜索包含多字查询的文档。[我使用了http://packages.python.org/Whoosh/quickstart.html#the-searcher-object](http://packages.python.org/Whoosh/quickstart.html#the-searcher-object)中描述的 And 运算符， 但它显示错误。单字搜索有效。

```
from whoosh.index import create_in
from whoosh.fields import *
from whoosh.qparser import QueryParser
from whoosh.fields import Schema, TEXT, KEYWORD, ID, STORED
from whoosh.analysis import StemmingAnalyzer
from whoosh.query import *
import os.path

##Schema

schema = Schema(title=TEXT(stored=True), path=ID(stored=True), content=TEXT)

##Indexing

if not os.path.exists("index"):
    os.mkdir("index")

ix = create_in("index", schema)

writer = ix.writer()
writer.add_document(title=u"First document", path=u"/a", content=u"Michael Jackson")
writer.add_document(title=u"Second document", path=u"/b", content=u"Roger Federer")
writer.add_document(title=u"Third document", path=u"/c", content=u"Michael Jordan")
writer.add_document(title=u"Fifth document", path=u"/d", content=u"Michael Phelps")
writer.add_document(title=u"Sixth document", path=u"/e", content=u"Michael Schumacher")
writer.add_document(title=u"Seventh document", path=u"/f", content=u"Michael Dell")
writer.add_document(title=u"Eigth document", path=u"/g", content=u"Michael Akerfeldt")
writer.commit()

##Searching

searcher = ix.searcher()

#Single Word Search:
#myquery = u'Michael'

#Multiword Search:
myquery = And([Term("content", u'Roger'), Term("content", u'Michael')])

#query = QueryParser("content", schema=ix.schema).parse(myquery)

parser = QueryParser("content", ix.schema)
query = parser.parse(myquery)

#with ix.searcher() as searcher:

results = searcher.search(query, limit=None)

print "Length of Results :", len(results)
print "\nResults : "
for i in range (0,len(results)):
    print results[i] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T12:13:56.297

我认为您对查询解析器的功能感到困惑。查询解析器将*创建*`And`您通过调用显式构造的查询：

```
query = parser.parse("Roger and Michael") 
```

或者，如果您真的想自己创建查询结构，则直接传递`myquery`给`searcher.search`而不是`query`.

更多信息在这里：[http ://packages.python.org/Whoosh/parsing.html](http://packages.python.org/Whoosh/parsing.html)

# sql-server - SQL没有优化我的参数化查询

> ID：12338903
> 
> 赞同：3
> 
> 时间：2012-09-09T12:04:15.773
> 
> 标签：sql-server, sql-server-2008

我有一个这样的查询：

```
select top(10) * from dbo.myTable where DisplayName like 'farm%' 
```

这会导致在 DisplayName 上进行索引查找，因为通配符在尾随。但是，当我这样做时，情况并非如此：

```
declare @val varchar(200) = 'farm'
select top(10) * from dbo.myTable where DisplayName like @val + '%' 
```

或这个：

```
declare @val varchar(200) = 'farm%'
select top(10) * from dbo.myTable where DisplayName like @val 
```

在这些情况下，SQL 会依靠慢得多的索引扫描操作。定位的值是在运行时提供的参数，因此显然我不能仅将第一个查询用于我的目的。

有什么办法可以：

1.  确保 SQL 索引寻找该值，并且
2.  将此逻辑存储在预编译的存储过程中。查询需要快速，所以我不想求助于每次执行都会强制重新编译的方法（即使编译开销 + 索引查找仍然比索引扫描快）

我意识到通配符的存在或不存在会影响执行计划，但 SQL 似乎并不理解通配符总是被使用，即使你将它连接到值，如查询 #2。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T12:22:00.763

SQL Server[可以对这些查询使用范围搜索](http://web.archive.org/web/20170303101108/http://sqlblog.com/blogs/paul_white/archive/2012/01/18/dynamic-seeks-and-hidden-implicit-conversions.aspx)（如果变量包含前导通配符，则范围最终会成为整个索引）。

如果在这种情况下不选择这样做，很可能是因为使用变量意味着它不能准确地估计选择性。您可以尝试添加`OPTION (RECOMPILE)`提示，以便考虑实际变量值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T13:25:12.037

我认为 Martin 是正确的，因为当我只用主键和 DisplayName 列替换 select * 时，SQL 实际上确实进行了索引查找，从而消除了键查找。

此外，LIKE 'farm%' 被实现为 DisplayName >= 'farm' AND DisplayName < 'farN'，所以我决定完全放弃 LIKE 运算符。

```
select top(10) * from dbo.EPFSuppliers with(forceseek) 
where DisplayName >= @str and DisplayName < left(@str,len(@str)-1) + char(ascii(right(@str,1)) + 1) 
```

forceeek 提示是必要的，因为 SQL 估计匹配的行数为 729，在我的情况下，这是一个完全不切实际的数字。

我相信这种方法优于使用通配符，后者需要预处理字符串以删除转义字符。

# .net-assembly - .NET 4.0 和 .NET 4.5 程序集版本冲突

> ID：12338905
> 
> 赞同：1
> 
> 时间：2012-09-09T12:04:24.123
> 
> 标签：.net-assembly, .net-4.5

我的 App.exe 是为 .NET 4.5 编译的，并引用 SomeLib.dll，这是一个 .NET 4.0 程序集，它引用 Reactive Extensions 程序集（为 .NET 4.0 编译）。

我的 App.exe 也直接引用 Reactive Extensions 程序集（为 .NET 4.5 编译）。bin 文件夹中的 Reactive Extensions 程序集是 .NET 4.5。

尝试运行程序时，出现异常：无法加载文件或程序集“System.Reactive.PlatformServices，版本 2.0.283.0 .... 定位程序集的清单定义与程序集引用不匹配”。

是否可以强制 SomeLib.dll 程序集将 RX 用于 .NET 4.5 而无需为 .NET 4.5 重新编译它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T13:07:32.350

升级到 RX 2.1 时解决了这个问题

# c++ - “'<' 标记之前的预期初始值设定项”尝试模板成员特化

> ID：12338912
> 
> 赞同：3
> 
> 时间：2012-09-09T12:05:22.827
> 
> 标签：c++, generic-programming, explicit-specialization, class-template

我正在尝试在模板类中定义模板成员。

这是头文件的片段：

```
template <typename Type>
class Queue
{
private:
// class scope definitions
    // Node is a nested structure definition local to this class
    struct Node {Type item; struct Node* next;};
    enum {Q_SIZE = 10};
    template <typename Type2> class DeepCopy // template member
    {
    public:
        void docopy(Type2& d, const Type2& s);
    };
... 
```

因此定义了模板成员，但我想对 docopy 方法进行显式特化，以便在类型为指针时进行深度复制。我将使用方法模板和特化从头文件中放入另一个片段：

```
// template member
template <typename Type>
    template <typename Type2>
void Queue<Type>::DeepCopy<Type2>::docopy(Type2& d, const Type2& s)
{
    d = s;
}

// template member specialization for pointers
template <typename Type>
    template <typename Type2>
void Queue<Type*>::DeepCopy<Type2*>::docopy(Type2* d, const Type2* s)
{
    if (s)
        d = new (*s);
    else
        d = 0;
} 
```

编译器向我发送以下错误：*“<”标记之前的预期初始化程序。*

我无法弄清楚我做错了什么。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:37:59.623

对于您的示例，您应该

1.  的部分专业化`Queue`课程`T*`。
2.  `Queue<T*>`在struct的写入定义的部分专业化中`DeepCopy`。
3.  `Queue<T*>::DeepCopy`编写for 的专业化`U*`。
4.  写函数`Queue<T*>::DeepCopy<U*>::docopy`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T12:50:43.863

您应该在 Queue 之外编写 DeepCopy 作为顶级模板。仅在您的队列中使用它。

```
 template <typename T>
   class Queue { 
      DeepCopy<T> myCopy;
      ....
          myCopy.doCopy(n.item, newItem); 
```

# c# - C# 中我的 Windows 窗体应用程序中业务逻辑的正确方法

> ID：12338913
> 
> 赞同：2
> 
> 时间：2012-09-09T12:05:35.180
> 
> 标签：c#

我是一名学生，正在 Visual Studio 2010 中开发一个简单的作业 - Windows 窗体应用程序。

该应用程序假设根据用户要求构建公式。

过程：它必须从 Microsoft Access 数据库的列中选择数据，并且用户应该能够像我们在下拉菜单中那样按列名称选择数据。并在其中创建可重用的公式（配置一次并可以再次更改）。以下是来自数据库的列标题，例如可以选择。

例如

> ```
>  Col -1  : Marks in Maths
>   Col -2  : Total Marks in Maths
>   Col -3  : Marks in science
>   Col -4  : Total marks in science 
> ```

最后，我们应该能够在 UI 中构造任何公式，例如

> （列 1 + 列 3）/（列 2 + 列 4）= 公式 1

一旦设置并由用户为其分配名称。

他将能够通过仅在 UI 层上操作底层数据来计算他想要的数字......

问题：

看起来我必须创建一个通过 UI 设置规则的应用程序......这意味着不需要存储过程......请提出正确的方法。

# php - 如何在 php 中由 swig 包装的 C 方法中调用引用

> ID：12338916
> 
> 赞同：0
> 
> 时间：2012-09-09T12:06:07.593
> 
> 标签：php, c++, pointers, reference, swig

我在我的 php 代码中调用引用有一个严重的问题。我用 swig 包装了我的 c++ 类并想调用该方法，在阅读了手册后我发现，在 SWIG 中，当 c++ 参数中有引用时，我们有：

```
class foo {
Public;
double bar(double &a);
} 
```

在 swig 包装类中，我们有：

```
double foo_bar(foo *obj,double *a) {
obj->bar(*a);} 
```

我完全理解，我的问题是如何在 PHP 代码中调用方法栏？我开始：

```
$ptr_a = &$a
$obj->bar($ptr_a); 
```

但它不起作用。任何想法？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T14:31:32.590

我尝试使用 phppointers.i 和`REF`typemap 来创建使用 PHP 引用概念的东西。我无法让它工作，但是使用 cpointer.i 处理此类事情的标准、语言中立的 SWIG 方法工作得很好：

```
%module test

%include <cpointer.i>

%pointer_class(double,Double);

%inline %{
  void func(double& a) {
    a = -666.0;
  }
%} 
```

按预期工作：

```
<?php
include('test.php');
echo "testing\n";
$a=new Double(0.0);
test::func($a);
echo "In PHP: " . $a->value() . "\n";
?> 
```

# php - 将表单变量传递给控制器

> ID：12338922
> 
> 赞同：0
> 
> 时间：2012-09-09T12:07:05.583
> 
> 标签：php, codeigniter

嘿，伙计们只是想将一些东西传递到我的控制器中。使用codeigniter，下面的表格实际上并没有将我重定向到任何地方，有什么问题？

我的第二个问题是如何简单地获取控制器中的数据..？

```
$data = $this->input->$post('search'); 
```

* * *

```
<?php
$options = array(
                  'small'  => 'Small Shirt',
                  'med'    => 'Medium Shirt',
                  'large'   => 'Large Shirt',
                  'xlarge' => 'Extra Large Shirt',
                );

$shirts_on_sale = array('small', 'large');
echo form_dropdown('shirts', $options, 'large');

?>
 <form  action="<?php echo site_url('home/id_search');?>" method="post"><input type="submit" value="submit" id="" name="" >
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:11:43.150

您将表单开始标签放置在错误的位置，请执行以下操作：

```
 <form  action="<?php echo site_url('home/id_search');?>" method="post">
<?php
$options = array(
                  'small'  => 'Small Shirt',
                  'med'    => 'Medium Shirt',
                  'large'   => 'Large Shirt',
                  'xlarge' => 'Extra Large Shirt',
                );

$shirts_on_sale = array('small', 'large');
echo form_dropdown('shirts', $options, 'large');

?>
<input type="submit" value="submit" id="" name="btnSubmit" />
</form>

And to get POST date in you controller, do:
$data = $this->input->post('shirts'); //for getting shirts form field value 
```

# python - Sqlalchemy 和 PostgreSql：以后如何手动设置主键而不会发生冲突？

> ID：12338923
> 
> 赞同：1
> 
> 时间：2012-09-09T12:07:20.983
> 
> 标签：python, postgresql, sqlalchemy

我有这样的表：

```
class Tag(Base):
    __tablename__ = 'tag'

    id = Column(Integer, primary_key=True)
    name = Column(Unicode(50), nullable=False)

    def __init__(self, name):
        self.name = name 
```

假设表是空的。比我以这种方式插入一些数据：

```
t = Tag('first tag')
t.id = 2
dbsession.add(t)
dbsession.commit() 
```

没关系：我的 postgresql 表中有一行 id = 2。下一步：

```
t = Tag('second tag')
dbsession.add(t)
dbsession.commit() 
```

比我有 2 行： {id: 1, name: 'second tag'} 和 {id: 2, name: 'first_tag'}

下一步（最后一步）：

```
t = Tag('third tag')
dbsession.add(t)
dbsession.commit() 
```

> **IntegrityError**：（IntegrityError）重复键值违反唯一约束“tag_pkey”
> 
> （它想创建 id = 2 的行，但它已经使用第一个标签）

是否有可能以某种方式对 postgres 说：如果存在这样的 pkey，请尝试下一步直到它可用？

在使用转储时非常有用。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T07:23:18.380

我不知道有任何安全、有效的方式来做你想做的事。您真的应该选择是要自己定义密钥还是使用生成的密钥并坚持一种策略或另一种策略。

如果你不介意可怕的并发，你可以`LOCK TABLE thetable`做你的工作，`setval`表的标识符序列到你插入后的下一个空闲值，并`commit`释放锁。但是，这仍然会导致显式调用`nextval`（如许多 ORM）的应用程序出现问题，而不是让数据库通过从`?INSERT`列列表中省略它来定义值或将其显式命名为`DEFAULT`.

否则，您可以让您的代码（或 PL/PgSQL 辅助函数）在重试循环中执行插入操作，该循环会增加密钥并在遇到完整性错误时再次尝试。如果您需要做的不仅仅是每个事务的一次插入，则此策略将不起作用。此外，在`SERIALIZABLE`隔离模式下，我认为您不能使用 PL/PgSQL 来做到这一点，您必须使用客户端重试循环来处理序列化失败。

这是一个可怕的想法。要么一致地使用应用程序定义的键，要么一致地使用数据库定义的键。不要将两者混为一谈。

# php - 在 WordPress 主页上显示最新的 2 个置顶帖子

> ID：12338924
> 
> 赞同：3
> 
> 时间：2012-09-09T12:07:33.447
> 
> 标签：php, wordpress

我正在定制我的 WordPress 主题，我想在我的 WordPress 主页顶部添加最新的 2 个置顶帖子。为此，我使用以下代码：

```
<div class="trending-right">
   <?php
     $sticky = get_option( 'sticky_posts' ); // Get all sticky posts
     rsort( $sticky ); // Sort the stickies, latest first
     $sticky = array_slice( $sticky, 0, 2 ); // Number of stickies to show
     query_posts( array( 'post__in' => $sticky, 'caller_get_posts' => 1 ) ); // The query

     if (have_posts() ) { while ( have_posts() ) : the_post(); ?>
     <div class="trend-post">
     <div class="thumb"><?php the_post_thumbnail(array(150,100)); ?></div>
     <div class="title"><a href="<?php the_permalink() ?>"><?php the_title(); ?></a></div>
     </div>
     <?php endwhile;?>
     <?php } else { echo ""; }?>

</div> 
```

现在代码可以正常工作并显示最新的 2 个置顶帖子，但是它也会从主页中删除所有其他列出的帖子，并且只显示这 2 个置顶帖子。我尝试替换`query_posts`为，`new WP_Query`但在这种情况下，它显示所有粘性帖子而不是仅 2 个。

任何建议如何调整上述代码并使其工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T12:47:42.843

查看您的代码，我假设您刚刚向我们展示了粘性循环，并且还有另一个查询可以显示模板中其他位置的其他帖子？您应该使用 wp_reset_query(); 在您的自定义查询之后，这里是 Codex 中的条目；

[Wordpress - 重置自定义查询](http://codex.wordpress.org/Function_Reference/wp_reset_query)

# java - 当前连接信息 - Java

> ID：12338931
> 
> 赞同：1
> 
> 时间：2012-09-09T12:08:37.003
> 
> 标签：java, network-programming, ipv6, subnet, inetaddress

我试图让我的程序显示`ipconfig`命令在 Windows 中显示的内容。我已经设法获取主机名和 IPv4 地址，我怎样才能获取 IPv6 地址和子网掩码？到目前为止，我尝试了各种方法无济于事。我的代码是：

```
try {
    InetAddress addr = InetAddress.getLocalHost();
    String ipAddr = addr.getHostAddress();
    String hostname = addr.getHostName();
    gsc.mainWindow.printf("Host name: ",hostname,"\n");
    gsc.mainWindow.printf("IP Address: ",ipAddr,"\n");
} catch (Exception e) {
    gsc.mainWindow.printf("Error: ",e,"\n");
} 
```

考虑一下`gsc.mainWindow`我打印任何类型对象的输出流。提前致谢！

（PS.如果有人可以添加一些我想不到的标签，我将不胜感激！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:30:03.900

如果您想要ipconfig 提供给我们的**所有**信息，我认为您无法通过 java.net 包获得它。如果您要查找的只是 IPv6 和 IPv4 地址，那么您可以使用`java.net.Inet6Address.getHostAddress()`

如果您想要其他信息，例如 DHCP、默认网关、DNS，那么最好的办法是从 java 调用 ipconfig 并捕获输出。此 hack 是特定于操作系统的，因此您还可以包含一些代码以在执行之前检查操作系统。

```
String os = System.getProperty("os.name");        
try {
    if(os.indexOf("Windows 7")>=0) {
       Process process = Runtime.getRuntime().exec("ipconfig /all");
       process.waitFor();
       InputStream commandOut= process.getInputStream();
       //Display the output of the ipconfig command
       BufferedReader in = new BufferedReader(new InputStreamReader(commandOut));
       String line;
       while((line = in.readLine()) !=null) 
          System.out.println(line);
    }
}
catch(IOException ioe) {    }
catch(java.lang.InterruptedException utoh) {   }        
} 
```

如果您只想显示此信息的某些子集，则可以在 while 循环中放置一些代码来查找诸如“主机名”或“物理地址”之类的内容，并仅显示包含这些字符串的行。

# c# - Catch 仅在一个异常后退出

> ID：12338936
> 
> 赞同：1
> 
> 时间：2012-09-09T12:09:21.857
> 
> 标签：c#, append, try-catch, stringbuilder

在下面显示的我的 try/catch 中，应用程序循环遍历用户输入到文本框中的单词。（我已经验证了这部分是否有效。）当它遍历单词时，它会将每个单词传递给下面的函数。

```
private string runQuery(string data)
    {
        // Step 1 - Declare the query and parameters
        SqlCeConnection connection = new SqlCeConnection(@"Data Source=keywordDB.sdf");
        SqlCeCommand cmd = new SqlCeCommand("SELECT abbrev, description FROM abbreviations WHERE abbrev LIKE @abbrev", connection);
        cmd.Parameters.AddWithValue("@abbrev", data);
        SqlCeDataReader reader;

        try
        {
            // Step 2 - Opens the connection
            connection.Open();

            // Step 3- Execute query and assign the data to abbrevQueryResult and results
            reader = cmd.ExecuteReader();
            reader.Read();
            abbrevQueryResult = reader[0].ToString();
            results = reader[1].ToString();

            // Step 4 compare abbrevQueryResult to data entered by user in textbox
            if (abbrevQueryResult.ToLower().Equals(data.ToLowerInvariant()))
            {
                returnResults.Append(" " + results + ",");
            }
        }

        catch (InvalidOperationException e)
        {
            badData = new StringBuilder();
            badData.Append(" " + data);
        }

        finally
        {
            if (connection != null)
            {
                connection.Close();
            }
        }

        return returnResults.ToString();
    } 
```

我注意到，如果我输入 6 个单词，其中 3 个应该可以正常工作，而 3 个应该被 catch 语句捕获，即 catch 语句只会捕获最后一个。知道为什么它只捕捉其中一个词吗？我希望它能够捕获所有这些并将它们全部添加到 StringBuilder badData。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T12:14:50.187

在这样的普通情况下，您真的不应该使用 try/catch 和异常机制来确定数据的有效性。这就是为什么它被称为“异常”的原因，因为它旨在处理可能导致程序崩溃的异常情况。如果您希望输入的某个百分比无效，请对其进行普通逻辑测试。

```
 if (valid(word) {function(word);} else {addToErrorList(word);} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T12:12:51.133

您没有显示`badData`声明的位置。但是，每次调用 catch 块时，都会重置`badData`为新的 StringBuilder - 这意味着它的旧实例（以及其中包含的任何值）都将被丢弃。如果您在 catch 块中删除此行：

```
badData = new StringBuilder(); 
```

你可能会更接近你想去的地方。

当您在执行此操作后最终遇到空指针异常时，您需要确保将`badData`其实例化到`= new StringBuilder();`（如您所拥有的那样）任何您已经声明它的地方 - IE，作为方法外部的实例变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T12:15:37.130

您`badData = new StringBuilder();`每次都在 catch 块中进行设置。所以，它确实被抓了 3 次，但你只看到你的最后一个坏词`StringBuilder`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-09T12:18:13.480

如果要`badData`包含所有错误，则不能在 catch 子句中初始化变量，因为您正在为每个捕获的异常重置变量。如果您在其他地方初始化它，这可以工作。

在类的顶部初始化它：

```
public class MyClass {
     private StringBuilder badData = new StringBuilder();

     // Other code
} 
```

在构造函数中初始化它：

```
public class MyClass {
     private StringBuilder badData;

     public MyClass() {
          badData = new StringBuilder();
     }
} 
```

通过这样做，只要对象存在，变量就会存在，然后您只需删除catch子句中的初始化，以便`StringBuilder`每次捕获异常时变量不会重置为新对象（从而所有错误都将被附加，而不仅仅是最后一个）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-09T12:44:34.410

SQL 访问代码非常脆弱，我猜这就是原因，但关键是，您的异常处理不够充分，因为您只捕获 InvalidOperationException。在 Exception 类型的末尾添加另一个捕获，以找出早期爆炸的原因。（正如齐泽默所说，停止重新初始化某人。）

# iphone - Retina 显示屏与常规显示屏

> ID：12338941
> 
> 赞同：-5
> 
> 时间：2012-09-09T12:10:09.730
> 
> 标签：iphone

Apple 希望我用视网膜显示/常规显示修复我的界面。使用相同的图片 320x480，图片在 iOS 模拟器上对于视网膜和常规作为背景看起来是一样的。但是当我为视网膜做 960x640 和普通的 320x480 时，视网膜看起来像是全部放大了。我在这里错过了什么哈哈。是因为它是背景层吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T12:23:34.310

如果您使用 UIImageView 作为背景，那么您可能需要将 contentMode 设置更改为 UIViewContentModeScaleAspectFit 或 UIViewContentModeScaleAspectFill，以便在 UIImageView 的范围内正确缩放图像。

# jpa - 为什么我们需要 JPA 中的空构造函数。??

> ID：12338942
> 
> 赞同：0
> 
> 时间：2012-09-09T12:10:11.283
> 
> 标签：jpa

现在，我正在学习 JPA。JPA 建议我们必须有公共方法和私有字段，并且没有静态和最终变量。还有空构造函数..为什么我们需要这种格式.???

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T18:13:56.580

实际上规范不推荐，它是相当规范的以下（除其他外）：

1.  公共或受保护的无参数构造函数必须存在。额外的构造函数很好。
2.  持久性字段不应该是公共的（受保护的、包可见的和私有的都是大声的）。
3.  最终的持久性属性或方法是不大声的。

这些限制的一些原因是：

1.  JPA 提供者需要创建实体实例。如果类只包含带有任意参数的构造函数，则 JPA 提供程序无法计算出这些参数的值。
2.  可能公共可见性根本没有大声，因为不应从课堂外直接访问字段。或者也许有更好的理由，但我没有意识到这一点。
3.  Provider 想创建代理，如果方法是 final 是不可能的。属性也不应该是最终的，因为这样提供者就不能为它们赋值。

此外，静态持久属性没有太大意义，因为为什么一个值会被所有实体实例共享。

# android - 如何从 userdictionary 内容提供者中检索单词

> ID：12338943
> 
> 赞同：1
> 
> 时间：2012-09-09T12:10:36.427
> 
> 标签：android, android-contentprovider

我在使用内容解析器从 UserDictionary.words 内容提供者获取数据时遇到问题。

这是我的要求： 1\. 我想找出与给定单词匹配的 UserDictionary 单词。

我的实现；1.我的应用程序有两个屏幕（活动） 2.我在第一个屏幕上输入一个单词并将其作为意图传递给第二个屏幕。在第二个屏幕上，我想显示与第一个屏幕上的给定单词匹配的 Userdictionary 单词列表。

我的问题是......我能够将这个词传递给第二个活动，但错过了检索 userDicitnary 的记录。我给它的任何词都是返回记录。这是我的两个活动的代码。请帮助我解决问题。

第一项活动：

```
public void onCreate(Bundle savedInstanceState) {

    Log.d(TAG,"onCreate");
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_content_user_demo);
}

public void SendWord(View view){
    Log.d(TAG,"SendWord");
    EditText SearchWord = (EditText) findViewById(R.id.mSearchWord);
    String mSearchString = SearchWord.getText().toString();    
    Intent intent = new Intent(this, WordListActivity.class);
    Log.d(TAG,"EXTRA_MESSAGE");
    intent.putExtra(EXTRA_MESSAGE, mSearchString);
    startActivity(intent);
} 
```

第二个活动：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Log.d(TAG,"onCreate");
    setContentView(R.layout.activity_word_list);
    Intent intent = getIntent();
    Log.d(TAG,"getIntent() EXTRA_MESSAGE");

    String searchWord = intent.getStringExtra(ContentUserDemo.EXTRA_MESSAGE);
   textView = new TextView(this);
    Log.d(TAG,"searchWord " +searchWord);
    textView.setTextSize(20);
    setContentView(textView);
    Log.d(TAG,"textSize " +textView.length());
       String[] mProjection =
        {
            UserDictionary.Words._ID,    
            UserDictionary.Words.WORD,                                                                      
            UserDictionary.Words.LOCALE  
        };
    String mSelectionClause = null;
    String[] mSelectionArgs = {""};
    String mSortOrder=null;
    ContentResolver cr = getContentResolver();
    if (TextUtils.isEmpty(searchWord)) {
        mSelectionClause = null;
        mSelectionArgs[0] = "";
    } 
    else {       
        mSelectionClause = UserDictionary.Words.WORD + " = ?";
        mSelectionArgs[0] = searchWord;
    }
    Cursor mCursor = cr.query(UserDictionary.Words.CONTENT_URI,
            mProjection,
            mSelectionClause, 
            mSelectionArgs,
            mSortOrder);
    startManagingCursor(mCursor);

    int count = mCursor.getCount();

    if (null == mCursor) {
       Log.d(TAG, "cursor.getCount()=" + count);
        String message="No word matches with "+ searchWord;
        textView.setText(message);
    } 
    else if (mCursor.getCount() < 1) {
       Log.d(TAG, "cursor.getCount()=" + count);
        String message="getCount is less than 1 " + "No word matches with "+ searchWord;
        textView.setText(message);

    } 
    else {
        String message="Else part of the code";
        textView.setText(message);
          String[] mWordListColumns ={UserDictionary.Words.WORD,UserDictionary.Words.LOCALE};
          int[] mWordListItems = { R.id.dictWord, R.id.locale};
          SimpleCursorAdapter mCursorAdapter = new SimpleCursorAdapter(
                getApplicationContext(),               
                R.layout.wordlistrow,                  
                mCursor,                               
                mWordListColumns,                      
                mWordListItems,                        
                0); 
          ListView mWordList = (ListView) findViewById(R.id.mWordList);
          mWordList.setAdapter(mCursorAdapter);

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-26T21:00:51.427

在`TextUtils.isEmpty() {}`条款中，我建议更改：

`mSelectionArgs[0] = "";`至 `mSelectionArgs = null;`

因为可能存在非法参数异常：

```
java.lang.IllegalArgumentException: 
Cannot bind argument at index 1 because the index is out of range. 
The statement has 0 parameters. 
```

# xslt - 总结每个客户的发票总额

> ID：12338944
> 
> 赞同：-1
> 
> 时间：2012-09-09T12:10:45.037
> 
> 标签：xslt, xslt-1.0

我需要一种方法来计算每个客户的发票总数，（添加三张发票，然后相应地显示总数），尝试过 sum(/*/(PriceUnit*Ordered))，但它不起作用,.---[一张发票的总和=PriceUnit*Ordered],.so总结三张发票然后显示结果,.这对我来说很难所以请帮忙

# 样本输入文件

```
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="Nom.xslt"?>
<customers>
  <customer>
    <clientname>troy madison</clientname>
    <invoices>
    <invoiceDate>8/8/98</invoiceDate>
      <product>
         <PriceUnit>1000</PriceUnit>
         <Ordered>2</Ordered>
     </product>
     <product>
         <PriceUnit>5400</PriceUnit>
         <Ordered>3</Ordered>
     </product>
   </invoices>
   <invoices>
     <invoiceDate>1/4/98</invoiceDate>
       <product>
          <PriceUnit>300</PriceUnit>
          <Ordered>4</Ordered>
       </product>
      <product>
        <PriceUnit>6000</PriceUnit>
        <Ordered>1</Ordered>
     </product>
   </invoices>
  <invoices>
    <invoiceDate>03/5/99</invoiceDate>
      <product>
        <PriceUnit>549</PriceUnit>
        <Ordered>1</Ordered>
     </product>
     <product>
       <PriceUnit>320</PriceUnit>
       <Ordered>2</Ordered>
    </product>
   </invoices>
 </customer>
 <customer>
   <clientname>Morris</clientname>
    <invoices>
      <invoiceDate>1/1/00</invoiceDate>
        <product>
           <PriceUnit>59</PriceUnit>
           <Ordered>3</Ordered>
        </product>
      <product>
          <PriceUnit>55</PriceUnit>
          <Ordered>1</Ordered>
      </product>
    </invoices>
    <invoices>
     <invoiceDate>11/1/01</invoiceDate>
       <product>
         <PriceUnit>10</PriceUnit>
         <Ordered>2</Ordered>
      </product>
      <product>
         <PriceUnit>54</PriceUnit>
         <Ordered>1</Ordered>
       </product>
    </invoices>
    <invoices>
      <invoiceDate>03/2/01</invoiceDate>
        <product>
          <PriceUnit>30</PriceUnit>
          <Ordered>1</Ordered>
        </product>
       <product>
         <PriceUnit>299</PriceUnit>
         <Ordered>1</Ordered>
       </product>
    </invoices>
</customer>
</customers> 
```

# 预期产出

[OP 在此处列出预期输出。]

# 到目前为止我尝试过的样式表

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
<xsl:template match="customers">
    <html>
        <head>
            <h1>CUSTOMER REFERENCE</h1>
        </head>
        <body bgcolor="#DAF52C">
            <table border="1">
                <tr>
                    <th width="50">NAME</th>
                    <th width="50">INVOICE DATE</th>
                    <th width="50">PRODUCT UNIT</th>
                    <th width="50">ORDERED </th>
                    <th width="50">PRODUCT UNIT</th>
                    <th width="50">ORDERED </th>
                    <th width="50">INVOICE DATE</th>
                    <th width="50">PRODUCT UNIT</th>
                    <th width="50">ORDERED </th>
                    <th width="50">PRODUCT UNIT</th>
                    <th width="50">ORDERED </th>
                    <th width="50">INVOICE DATE</th>
                    <th width="50">PRODUCT UNIT</th>
                    <th width="50">ORDERED </th>
                    <th width="50">PRODUCT UNIT</th>
                    <th width="50">ORDERED </th>
                    <th width="50">INVOICE TOTAL</th>
                </tr>
                <xsl:for-each select="customer">
                    <tr>
                        <td><xsl:value-of select="clientname"/></td>
                        <xsl:for-each select="invoices">
                            <td><xsl:value-of select="invoiceDate"/></td>
                            <xsl:for-each select="product">
                                <td><xsl:value-of select="PriceUnit"/></td>
                                <td><xsl:value-of select="Ordered"/></td>
                            </xsl:for-each>
                        </xsl:for-each>
                    </tr>
                </xsl:for-each>
            </table>
        </body>
    </html>
</xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T15:30:37.573

**Here is a pure XSLT 1.0 solution that doesn't require any extension functions:**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*">
  <html>
    <table border="1">
     <thead>
       <tr>
         <td>Name</td><td>Total</td>
       </tr>
     </thead>
     <xsl:apply-templates/>
    </table>
  </html>
 </xsl:template>

 <xsl:template match="customer">
  <tr>
    <td><xsl:value-of select="clientname"/></td>
    <td>
      <xsl:call-template name="sumProducts">
       <xsl:with-param name="pNodes" select="invoices/product"/>
       <xsl:with-param name="pName1" select="'PriceUnit'"/>
       <xsl:with-param name="pName2" select="'Ordered'"/>
      </xsl:call-template>
    </td>
  </tr>
 </xsl:template>

 <xsl:template name="sumProducts">
   <xsl:param name="pNodes"/>
   <xsl:param name="pName1"/>
   <xsl:param name="pName2"/>
   <xsl:param name="pAccum" select="0"/>

   <xsl:choose>
     <xsl:when test="not($pNodes)">
       <xsl:value-of select="$pAccum"/>
     </xsl:when>
     <xsl:otherwise>
      <xsl:call-template name="sumProducts">
        <xsl:with-param name="pNodes" select="$pNodes[position() >1]"/>
        <xsl:with-param name="pName1" select="$pName1"/>
        <xsl:with-param name="pName2" select="$pName2"/>
        <xsl:with-param name="pAccum" select=
        "$pAccum + $pNodes[1]/*[name()=$pName1] * $pNodes[1]/*[name()=$pName2]"/>
      </xsl:call-template>
     </xsl:otherwise>
   </xsl:choose>
 </xsl:template>
</xsl:stylesheet> 
```

**When this transformation is applied on the provided XML document:**

```
<customers>
    <customer>
        <clientname>troy madison</clientname>
        <invoices>
            <invoiceDate>8/8/98</invoiceDate>
            <product>
                <PriceUnit>1000</PriceUnit>
                <Ordered>2</Ordered>
            </product>
            <product>
                <PriceUnit>5400</PriceUnit>
                <Ordered>3</Ordered>
            </product>
        </invoices>
        <invoices>
            <invoiceDate>1/4/98</invoiceDate>
            <product>
                <PriceUnit>300</PriceUnit>
                <Ordered>4</Ordered>
            </product>
            <product>
                <PriceUnit>6000</PriceUnit>
                <Ordered>1</Ordered>
            </product>
        </invoices>
        <invoices>
            <invoiceDate>03/5/99</invoiceDate>
            <product>
                <PriceUnit>549</PriceUnit>
                <Ordered>1</Ordered>
            </product>
            <product>
                <PriceUnit>320</PriceUnit>
                <Ordered>2</Ordered>
            </product>
        </invoices>
    </customer>
    <customer>
        <clientname>Morris</clientname>
        <invoices>
            <invoiceDate>1/1/00</invoiceDate>
            <product>
                <PriceUnit>59</PriceUnit>
                <Ordered>3</Ordered>
            </product>
            <product>
                <PriceUnit>55</PriceUnit>
                <Ordered>1</Ordered>
            </product>
        </invoices>
        <invoices>
            <invoiceDate>11/1/01</invoiceDate>
            <product>
                <PriceUnit>10</PriceUnit>
                <Ordered>2</Ordered>
            </product>
            <product>
                <PriceUnit>54</PriceUnit>
                <Ordered>1</Ordered>
            </product>
        </invoices>
        <invoices>
            <invoiceDate>03/2/01</invoiceDate>
            <product>
                <PriceUnit>30</PriceUnit>
                <Ordered>1</Ordered>
            </product>
            <product>
                <PriceUnit>299</PriceUnit>
                <Ordered>1</Ordered>
            </product>
        </invoices>
    </customer>
</customers> 
```

**the wanted, correct result is produced**:

```
<html>
   <table border="1">
      <thead>
         <tr>
            <td>Name</td>
            <td>Total</td>
         </tr>
      </thead>
      <tr>
         <td>troy madison</td>
         <td>26589</td>
      </tr>
      <tr>
         <td>Morris</td>
         <td>635</td>
      </tr>
   </table>
</html> 
```

**Explanation**:

1.  A recursively called named template (`sumProducts`), which takes as parameters a node-set (`$pNodes`) of the nodes whose children's products should be summed and the names of the two children elements (`$pName1` and `$pName2`), the products of whose values should be summed. There is a last, auxiliary parameter `$pAccum` with initial value 0, that is used to store the accumulated result between each recursive call.

2.  Stop condition is when the passed `pNodes` nodeset is empty. In this case we output the accumulated sum (`$pAccum`).

3.  If the stop condition is false, we call ourselves with `$pNodes` in which the first node is removed, and with a new value of `$pAccum`, to which we have added the current product.

**Do note**:

The `sumProducts` template is very generic and can be used in any case where sum of products is required.

**Thus it deserves to be placed in its own stylesheet file, that will be *imported* by other stylesheets** whenever sum of products is needed.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:15:53.740

这是[Dimitre](https://stackoverflow.com/a/12334253/10823)对您第一次发布此问题的回答的 XSLT 1.0 等效版本。

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:exsl="http://exslt.org/common"
  xmlns:so="https://stackoverflow.com/questions/12338944"
  exclude-result-prefixes="xsl exsl so">
<xsl:output method="html" />
<xsl:strip-space elements="*" />

 <xsl:template match="/*">
  <html>
    <table border="1">
     <thead>
       <tr>
         <td>Name</td><td>Total</td>
       </tr>
     </thead>
     <xsl:apply-templates/>
    </table>
  </html>
 </xsl:template>

 <xsl:template match="customer">
  <tr>
    <td><xsl:value-of select="clientname"/></td>
    <td>
      <xsl:variable name="sales">
        <xsl:for-each select="invoices/product">
          <so:sale><xsl:value-of select="PriceUnit * Ordered"/></so:sale>
        </xsl:for-each>
      </xsl:variable>
      <xsl:value-of select="sum(exsl:node-set($sales)/so:sale)"/>
      </td>
  </tr>
 </xsl:template>
</xsl:stylesheet> 
```

在示例文档中，这会产生输出...

```
<html>
  <table border="1">
    <thead>
      <tr>
        <td>Name</td>
        <td>Total</td>
      </tr>
    </thead>
    <tr>
      <td>troy madison</td>
      <td>26589</td>
    </tr>
    <tr>
      <td>Morris</td>
      <td>635</td>
    </tr>
  </table>
</html> 
```

# applescript - 使用applescript我想将文件夹中的每个文件移动到根文件夹

> ID：12338945
> 
> 赞同：5
> 
> 时间：2012-09-09T12:10:45.047
> 
> 标签：applescript

我一直在尝试制作一个脚本来将文件夹中的每个文件移动到根文件夹以包含每个子文件夹。我不想创建一个新文件夹，只需将其移动到根文件夹即可。

我希望能够选择文件夹，然后仅在该特定文件夹上完成操作。

原因是为了组织，我的确切情况是我有超过 TB 的电影，并且文件夹中的文件夹中有文件。我想要根文件夹中的所有这些文件，以便我可以按照我认为合适的方式组织它们。此外，我想复制和删除而不是移动，因为研究让我相信这是最好的路线。

好吧，我无法让脚本正常工作，但我确实找到了一个指向工作流的链接，该工作流正是我正在寻找的：

[http://www.macworld.com/article/1160660/automator_filesfromsubfolders.html](http://www.macworld.com/article/1160660/automator_filesfromsubfolders.html)

* * *

***我在上面更新了保留此部分以用于历史记录，此虚线之间的所有内容都是我在编辑后将删除的内容***

我试图在下面对这个脚本进行逆向工程，但我发现它无法让它像我想要的那样工作。任何和所有的帮助都会非常感激，我对脚本非常陌生，而且我已经陷入困境。

第二次尝试告诉应用程序“finder”将 main_folder 设置为（选择带有提示“选择主文件夹”的文件夹）将 sub_folders 设置为 main_folder 的文件夹重复 sub_folders 中的 each_folder 将（每个文件夹的每个文件）移动到 main_folder 并替换 end repeat try end try end告诉

第一次尝试告诉应用程序“Finder”将 sourceFolder 设置为文件夹“MOVE ME”——磁盘“blah”等。我的 moveFilesFrom(sourceFolder) end tell

on moveFilesFrom(thisFolder) 告诉应用程序“Finder”设置 filesToMove 到 thisFolder 的每个文件与 filesToMove 中的 aFIle 重复将 aFIle 移动到文件夹 destFolder end repeat 将 subFolders 设置为（thisFolder 的每个文件夹）在 subFolders 中使用 aFolder 重复 my moveFilesFrom(aFolder) end repeat end 告诉 end moveFilesFrom

**当我在包含大量信息和子文件夹的文件夹上使用它时，查找器超时，我昨天在测试文件夹上使用了它，它可以正常工作，但要小得多。**

我现在正在使用 adayzdone 提供的这个脚本

```
 set myFolder to (choose folder with prompt "choose the main folder")
    tell application "Finder"
    set myfiles to get every item of (entire contents of folder myFolder) whose kind ≠ "Folder"
    move myfiles to myFolder
    end tell 
```

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:15:26.753

你可以尝试这样的事情：

```
set myFolder to (path to desktop as text) & "testFolder"
tell application "Finder"
    set myFiles to get every item of (entire contents of folder myFolder) whose kind ≠ "Folder"
    move myFiles to myFolder
end tell 
```

或者您可以使用 Lri 建议的 shell 脚本：

```
set myFolder to quoted form of (choose folder with prompt "choose the main folder")'s POSIX path
do shell script "cd " & myFolder & "; find . -type f -exec mv {} " & myFolder & " \\;" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-06T18:02:50.743

一个快速的递归子程序将处理这个问题：

```
set theFolder to POSIX path of (choose folder with prompt "Choose a folder")

tell application "System Events"
    set theFiles to my recursiveSearch(folder theFolder)
    move theFiles to folder theFolder
end tell

on recursiveSearch(theFolder)
    tell application "System Events"
        set theFiles to every file of theFolder whose visible is true
        set theSubFolders to every folder of theFolder
        repeat with thisFolder in theSubFolders
            set theFiles to theFiles & my recursiveSearch(thisFolder)
        end repeat
        return theFiles
    end tell
end recursiveSearch 
```

如果您想完成其他事情（例如，删除空子文件夹、仅移动特定类型的文件等），这很容易修改。让我知道它是否需要调整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T13:18:18.603

文件夹有一个`entire contents`属性：

```
tell application "Finder"
    set f to choose folder
    move files of entire contents of f to f
end tell 
```

你也可以`find`在 shell 中使用：

```
cd ~/Movies/Folder/; find . -type f -exec echo mv '{}' . \; 
```

# c - 使用 ctime 的分段错误

> ID：12338947
> 
> 赞同：0
> 
> 时间：2012-09-09T12:10:52.990
> 
> 标签：c, gcc, segmentation-fault

我正在进行一个 stat() 调用，它返回一个包含我想要提取的信息的结构。到目前为止，我成功地得到了我想要的，直到获得文件的访问时间、修改时间和最后更改时间。

我想用ctime来获取，然后用printf打印出来。

```
 printf("File: %s",argv[1]);
    printf("\nSize: %d",result.st_size);
    printf("        Blocks: %d",result.st_blocks);
    printf("        IO Block: %d",result.st_blksize);
    printf("\nDevice: 0x%x",result.st_dev);
    printf("        Inode: %d",result.st_ino);
    printf("        Links: %d",result.st_nlink);
//  printf("\nAccess: %s",ctime(result.st_atime)); 
```

此代码运行良好，并提供以下输出：

```
File: /etc/passwd
Size: 2250043           Blocks: 4416            IO Block: 4096
Device: 0x6804          Inode: 9738432          Links: 1 
```

如果我取消注释要获取访问时间的最后一行，我会得到以下输出：

```
File: /etc/passwd
Size: 2250043           Blocks: 4416            IO Block: 4096
Segmentation fault 
```

我怎样才能解决这个问题？另外，我怎么会在设备、Inode 和链接打印出来**之前出现分段错误？**不应该打印然后生成分段错误吗？

我的 C 语言经验几乎为零。我在之前的课程中学习过汇编，但非常简短。我试图阅读 time.h 的 API，但我无法真正找到解决方案。

我非常感谢我能得到的任何帮助或提示！

谢谢，Z

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T12:17:06.863

该函数[`ctime`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/ctime.html)需要一个`const time_t *`. 你可能想要：

```
printf("\nAccess: %s",ctime(&result.st_atime));
                            ^ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T12:21:52.263

请用

```
ctime(&result.st_atime) 
```

不要忘记

```
#include <time.h> 
```

# makefile - 我的库无法构建并出现 libtool 错误

> ID：12338948
> 
> 赞同：2
> 
> 时间：2012-09-09T12:10:58.267
> 
> 标签：makefile, autoconf, automake, libtool

我正在尝试让我的 HTML Tidy c++ 包装器库在 linux 上构建（目前在 Ubuntu 上测试），但 make 失败并出现 libtool 错误：“libtool: link: you must specify an output file”

这是我的 Makefile.am：

```
## tidypp:
## A c++ wrapper around HTML Tidy Lib

AUTOMAKE_OPTIONS = subdir-objects
ACLOCAL_AMFLAGS = ${ACLOCAL_FLAGS} -I m4

lib_LTLIBRARIES = libtidypp-@TIDYPP_API_VERSION@.la

libtidypp_@TIDYPP_API_VERSION@_la_CPPFLAGS = $(DEPS_CFLAGS)
libtidypp_@TIDYPP_API_VERSION@_la_LIBADD = -ltidy $(DEPS_LIBS)

libtidypp_@TIDYPP_API_VERSION@_la_SOURCES = src/attribute.cpp src/buffer.cpp \
    src/document.cpp src/inputsource.cpp src/mem.cpp src/node.cpp src/option.cpp \
    src/outputsink.cpp src/tidypp.cpp include/tidypp/attribute.hpp \
    include/tidypp/basic_wrapper.hpp include/tidypp/buffer.hpp \
    include/tidypp/document.hpp include/tidypp/inputsource.hpp \
    include/tidypp/io.hpp include/tidypp/mem.hpp include/tidypp/node.hpp \
    include/tidypp/option.hpp include/tidypp/outputsink.hpp include/tidypp/tidypp.hpp

libtidypp_@TIDYPP_API_VERSION@_la_LDFLAGS = -version-info $(tidypp_SO_VERSION)

tidypp_includedir=$(includedir)/tidypp-@TIDYPP_API_VERSION@/tidypp
tidypp_include_HEADERS = include/tidypp/attribute.hpp \
    include/tidypp/basic_wrapper.hpp include/tidypp/buffer.hpp \
    include/tidypp/document.hpp include/tidypp/inputsource.hpp \
    include/tidypp/io.hpp include/tidypp/mem.hpp include/tidypp/node.hpp \
    include/tidypp/option.hpp include/tidypp/outputsink.hpp include/tidypp/tidypp.hpp

tidypp_libincludedir = $(libdir)/tidypp-$(TIDYPP_API_VERSION)/include
nodist_tidypp_libinclude_HEADERS = tidyppconfig.h

pkgconfigdir = $(libdir)/pkgconfig
pkgconfig_DATA = tidypp-$(TIDYPP_API_VERSION).pc

dist_noinst_SCRIPTS = autogen.sh 
```

和我的configure.ac：

```
## libtidypp:
## a c++ wrapper around html tidy lib

AC_INIT([libtidypp], [1.0], [francesco1149@gmail.com], [tidypp],
        [http://code.google.com/p/tidypp/])
AC_PREREQ([2.59])
AM_INIT_AUTOMAKE([1.10 -Wall no-define])

AC_CONFIG_MACRO_DIR([m4])

AC_CONFIG_HEADERS([config.h tidyppconfig.h])
AC_PROG_CXX
LT_INIT([disable-static])

AC_SUBST([TIDYPP_SO_VERSION], [0:0:0])
AC_SUBST([TIDYPP_API_VERSION], [1.0])

AC_CONFIG_FILES([Makefile
                 tidypp-${TIDYPP_API_VERSION}.pc:tidypp.pc.in])
AC_OUTPUT 
```

这是make的输出：

```
make  all-am

make[1]: Entering directory `/home/francesco/tidypp'

depbase=`echo src/attribute.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
    /bin/bash ./libtool --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I.     -g -O2 -MT src/attribute.lo -MD -MP -MF $depbase.Tpo -c -o src/attribute.lo src/attribute.cpp &&\
    mv -f $depbase.Tpo $depbase.Plo

libtool: compile:  g++ -DHAVE_CONFIG_H -I. -g -O2 -MT src/attribute.lo -MD -MP -MF src/.deps/attribute.Tpo -c src/attribute.cpp  -fPIC -DPIC -o src/.libs/attribute.o

depbase=`echo src/buffer.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
    /bin/bash ./libtool --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I.     -g -O2 -MT src/buffer.lo -MD -MP -MF $depbase.Tpo -c -o src/buffer.lo src/buffer.cpp &&\
    mv -f $depbase.Tpo $depbase.Plo

libtool: compile:  g++ -DHAVE_CONFIG_H -I. -g -O2 -MT src/buffer.lo -MD -MP -MF src/.deps/buffer.Tpo -c src/buffer.cpp  -fPIC -DPIC -o src/.libs/buffer.o

depbase=`echo src/document.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
    /bin/bash ./libtool --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I.     -g -O2 -MT src/document.lo -MD -MP -MF $depbase.Tpo -c -o src/document.lo src/document.cpp &&\
    mv -f $depbase.Tpo $depbase.Plo

libtool: compile:  g++ -DHAVE_CONFIG_H -I. -g -O2 -MT src/document.lo -MD -MP -MF src/.deps/document.Tpo -c src/document.cpp  -fPIC -DPIC -o src/.libs/document.o

depbase=`echo src/inputsource.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
    /bin/bash ./libtool --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I.     -g -O2 -MT src/inputsource.lo -MD -MP -MF $depbase.Tpo -c -o src/inputsource.lo src/inputsource.cpp &&\
    mv -f $depbase.Tpo $depbase.Plo

libtool: compile:  g++ -DHAVE_CONFIG_H -I. -g -O2 -MT src/inputsource.lo -MD -MP -MF src/.deps/inputsource.Tpo -c src/inputsource.cpp  -fPIC -DPIC -o src/.libs/inputsource.o

depbase=`echo src/mem.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
    /bin/bash ./libtool --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I.     -g -O2 -MT src/mem.lo -MD -MP -MF $depbase.Tpo -c -o src/mem.lo src/mem.cpp &&\
    mv -f $depbase.Tpo $depbase.Plo

libtool: compile:  g++ -DHAVE_CONFIG_H -I. -g -O2 -MT src/mem.lo -MD -MP -MF src/.deps/mem.Tpo -c src/mem.cpp  -fPIC -DPIC -o src/.libs/mem.o

depbase=`echo src/node.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
    /bin/bash ./libtool --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I.     -g -O2 -MT src/node.lo -MD -MP -MF $depbase.Tpo -c -o src/node.lo src/node.cpp &&\
    mv -f $depbase.Tpo $depbase.Plo

libtool: compile:  g++ -DHAVE_CONFIG_H -I. -g -O2 -MT src/node.lo -MD -MP -MF src/.deps/node.Tpo -c src/node.cpp  -fPIC -DPIC -o src/.libs/node.o

depbase=`echo src/option.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
    /bin/bash ./libtool --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I.     -g -O2 -MT src/option.lo -MD -MP -MF $depbase.Tpo -c -o src/option.lo src/option.cpp &&\
    mv -f $depbase.Tpo $depbase.Plo

libtool: compile:  g++ -DHAVE_CONFIG_H -I. -g -O2 -MT src/option.lo -MD -MP -MF src/.deps/option.Tpo -c src/option.cpp  -fPIC -DPIC -o src/.libs/option.o

depbase=`echo src/outputsink.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
    /bin/bash ./libtool --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I.     -g -O2 -MT src/outputsink.lo -MD -MP -MF $depbase.Tpo -c -o src/outputsink.lo src/outputsink.cpp &&\
    mv -f $depbase.Tpo $depbase.Plo

libtool: compile:  g++ -DHAVE_CONFIG_H -I. -g -O2 -MT src/outputsink.lo -MD -MP -MF src/.deps/outputsink.Tpo -c src/outputsink.cpp  -fPIC -DPIC -o src/.libs/outputsink.o

depbase=`echo src/tidypp.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
    /bin/bash ./libtool --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I.     -g -O2 -MT src/tidypp.lo -MD -MP -MF $depbase.Tpo -c -o src/tidypp.lo src/tidypp.cpp &&\
    mv -f $depbase.Tpo $depbase.Plo

libtool: compile:  g++ -DHAVE_CONFIG_H -I. -g -O2 -MT src/tidypp.lo -MD -MP -MF src/.deps/tidypp.Tpo -c src/tidypp.cpp  -fPIC -DPIC -o src/.libs/tidypp.o

/bin/bash ./libtool --tag=CXX   --mode=link g++  -g -O2 -version-info   -o libtidypp-1.0.la -rpath /usr/local/lib src/attribute.lo src/buffer.lo src/document.lo src/inputsource.lo src/mem.lo src/node.lo src/option.lo src/outputsink.lo src/tidypp.lo  

libtool: link: you must specify an output file
libtool: link: Try `libtool --help --mode=link' for more information.
make[1]: *** [libtidypp-1.0.la] Error 1
make[1]: Leaving directory `/home/francesco/tidypp'
make: *** [all] Error 2 
```

完整的项目和来源：[http ://code.google.com/p/tidypp/](http://code.google.com/p/tidypp/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-09T20:39:35.110

您没有将参数传递给`-version-info`，因此`libtool`将 解释`-o`为该选项的必需参数。似乎错误在行

```
libtidypp_@TIDYPP_API_VERSION@_la_LDFLAGS = -version-info $(tidypp_SO_VERSION) 
```

那应该是`$(TIDYPP_SO_VERSION)`。中的变量名`make`区分大小写。

# opengl - 第四个纹理 = 分割错误

> ID：12338950
> 
> 赞同：0
> 
> 时间：2012-09-09T12:11:35.833
> 
> 标签：opengl, segmentation-fault, textures

每次**加载第四个纹理**时，我都会遇到**分段错误**- 什么类型的纹理，我的意思是文件名，并不重要。我检查了 value原来是**10**所以远远超过**4**，不是吗？**`GL_TEXTURES_STACK_SIZE`**

 ******这是代码片段：

*从png*加载纹理的功能

 *```
static GLuint gl_loadTexture(const char filename[]) {
    static int iTexNum = 1; 
    GLuint texture = 0;
    img_s *img = NULL;

    img = img_loadPNG(filename);
    if (img) {
        glGenTextures(iTexNum++, &texture);
        glBindTexture(GL_TEXTURE_2D, texture);
        glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR);
    glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_LINEAR);
        glTexImage2D(GL_TEXTURE_2D, 0, img->iGlFormat, img->uiWidth, img->uiHeight, 0, img->iGlFormat, GL_UNSIGNED_BYTE, img->p_ubaData);
        img_free(img); //it may cause errors on windows
    } else printf("Error: loading texture '%s' failed!\n", filename);

    return texture;
} 
```

实际加载

```
static GLuint textures[4];

static void gl_init() {
    (...) //setting up OpenGL

    /* loading textures */
    textures[0] = gl_loadTexture("images/background.png");
    textures[1] = gl_loadTexture("images/spaceship.png");
    textures[2] = gl_loadTexture("images/asteroid.png");
    textures[3] = gl_loadTexture("images/asteroid2.png"); //this is causing SegFault no matter which file I load!
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T15:10:21.370

生成纹理的方式至少存在一个问题。你写了：

```
static GLuint gl_loadTexture(const char filename[]) {
    static int iTexNum = 1; 
    GLuint texture = 0;
    img_s *img = NULL;

    img = img_loadPNG(filename);
    if (img) {
        glGenTextures(iTexNum++, &texture); 
```

第一个参数`glGenTextures`是您希望生成的纹理数量。您只为堆栈上的 1 个纹理分配了空间，但每次调用此方法时，都会多分配 1 个纹理。（因此，在第二次调用中，您分配了 2 个纹理，在第三次调用中，分配了 3 个纹理等。）`img`一旦超过 1，您很可能会覆盖指向的指针。调用应该是：

```
glGenTextures (1, &texture); 
```*******

# windows-runtime - WinRT 应用程序有什么方法可以测量自己的 CPU 使用率？

> ID：12338953
> 
> 赞同：1
> 
> 时间：2012-09-09T12:12:36.213
> 
> 标签：windows-runtime, cpu-usage

我正在尝试用不同的方法在 WinRT 中制作游戏图形，如果我的测试应用程序可以测量和显示它自己的 CPU 使用率，那就太好了，这样我就可以比较不同的方法（ItemsControl 与手动移动图像与 DirectX ）。

在成熟的 .NET 中，我可以在两个已知时间点读取[Process.TotalProcessorTime](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.totalprocessortime.aspx)，然后将增量处理器时间除以增量时间（必要时根据处理器数量进行调整）。如果应用程序以完全信任的方式运行，我什至可以找到[dwm.exe](http://msdn.microsoft.com/en-us/library/windows/desktop/aa969540%28v=vs.85%29.aspx)的进程实例（因为它完成了将 GUI 放在屏幕上的所有繁重工作）并将其添加到我的 CPU 时间中。这是我在[游戏图形测试套件](https://github.com/joewhite/Game-graphics)的 WinForms 和 WPF 版本中采用的方法。

但在 WinRT 中，System.Diagnostics.Process 类不存在。如果有备用 API，我不确定在哪里可以找到它。

我可以打开任务管理器并将其设置为保持在顶部，并在我的应用程序运行时密切关注它。这不太理想，因为（a）它覆盖了我的窗口的一部分，因此可能会稍微扭曲结果；(b) 我不能对结果进行任何自己的聚合或记录（例如，“这是十秒内的平均 CPU 使用率”）。因此，如果有某种方法可以让我以编程方式获取 CPU 使用率，我更愿意这样做，因为它为我提供了额外的灵活性。

**WinRT 应用程序有没有办法确定自己的 CPU 使用率？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:04:34.917

我不知道有任何“已批准”的 API 可以从 Windows 应用商店应用程序中获取此信息。

但是，如果您只想在测试应用程序中执行此操作，则可以使用“未经批准”的 API。如果你使用未经批准的 API，你的程序将无法通过 WACK 认证，无法上传到商店，但在本地进行测试是可以的。请注意，当您调用未经批准的 API 时无法保证，因此该行为在形式上是未定义的，但许多函数都可以正常工作——至少在当前版本中是这样。

`AllocConsole`我在今年夏天早些时候写的一篇文章[“Metro 风格应用程序中的 printf 调试”中](http://seaplusplus.com/2012/06/25/printf-debugging-in-metro-style-apps/)演示了如何调用。您可以在 C# 中执行类似的操作，使用 P/Invoke 调用本机函数，或编写可从 C# 调用的 C++ Windows 运行时组件。

对于您的场景，我建议调用[`GetCurrentProcess`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683179.aspx)以获取当前进程的句柄并将其传递给以[`GetProcessTimes`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683223.aspx)获取用户和内核时间。我进行了一个简短的测试，并用这种方法得到了合理的结果。

这是一个使用 P/Invoke 进行调用的完整 C# 类：

```
static class DebugProcessTimes
{
    [StructLayout(LayoutKind.Sequential)]
    private struct FileTime
    {
        public UInt32 Low;
        public UInt32 High;
    }

    private static UInt64 ToUInt64(FileTime time)
    {
        return ((UInt64)time.High << 32) + time.Low;
    }

    [DllImport("kernel32.dll")]
    private static extern IntPtr GetCurrentProcess();

    [DllImport("kernel32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool GetProcessTimes(
        IntPtr hProcess,
        out FileTime lpCreationTime,
        out FileTime lpExitTime,
        out FileTime lpKernelTime,
        out FileTime lpUserTime);

    public struct ProcessTimes
    {
        public UInt64 CreationTime;
        public UInt64 ExitTime;
        public UInt64 KernelTime;
        public UInt64 UserTime;
    }

    public static ProcessTimes GetProcessTimes()
    {
        FileTime creation, exit, kernel, user;

        if (!GetProcessTimes(GetCurrentProcess(),
                out creation, out exit, out kernel, out user))
            throw new Exception(":'(");

        return new ProcessTimes
        {
            CreationTime = ToUInt64(creation),
            ExitTime     = ToUInt64(exit),
            KernelTime   = ToUInt64(kernel),
            UserTime     = ToUInt64(user)
        };
    }
} 
```

用法：

```
var times = DebugProcessTimes.GetProcessTimes(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T12:27:04.303

不幸的是，WinRT 中没有等效的 System.Diagnostics.Process 类，至少目前没有（[缺少对 System.Diagnostics.Process 的引用](https://stackoverflow.com/questions/11845828/missing-reference-to-system-diagnostics-process)并[在 Win8 Metro 风格的应用程序中访问其他进程](https://stackoverflow.com/questions/7787038/accessing-other-processes-in-win8-metro-style-app)）。一些本机 API 向 WinRT 公开（请参阅[如何获取 WinRT 上的逻辑 CPU 数量？](https://stackoverflow.com/questions/10115283/how-can-i-get-the-number-of-logical-cpus-on-winrt)例如），但我找不到列表。

# android - 如何在不使用计算机的情况下读取设备上的 db 文件

> ID：12338956
> 
> 赞同：2
> 
> 时间：2012-09-09T12:12:54.643
> 
> 标签：android, sqlite, root, runas

我刚开始在 android 上开发，目前只使用了不起的应用程序 AIDE 在我的设备（galaxy nexus 和 nexus 7）上直接编码。

在这里查看有很多使用 adb 将数据库拉到您的计算机上的答案，但我没有使用计算机。

我看到了以可调试模式构建应用程序并使用“运行方式”的答案，但我收到了无权限错误。我没有 root 权限，也不是完全反对安装它，但想确保没有非 root 权限的方法可以做到这一点。

我正在尝试使用 connectbot 运行的东西。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:20:21.890

[http://sourceforge.net/projects/asqlitemanager/](http://sourceforge.net/projects/asqlitemanager/)等工具可以读取和写入位于 sd 卡上的本地 sql 文件。（无需root手机）
在root手机上，许多应用程序甚至可以读取/写入系统数据库。

**我建议不要在没有先加密的情况下将任何重要数据放在本地数据库中**

* * *

编辑：
如果我理解正确，您有一个 SQLite 应用程序，并且您想从您的应用程序外部访问**您的**sqlite 数据库（但在您的设备上）

如果是这种情况，我会尝试在我的应用程序（仅适用于调试版本）上有一个“秘密”选项，该选项将从`external sqlite browser application`.
或者您可以进行活动，将您的数据库复制到 SD 卡上的文件夹中，您可以在其中轻松编辑它
但是您**真正需要**的是什么？
您只需要查看值吗？
你需要检查结构吗？
您需要对数据库进行完整编辑吗？
您可能只需转储（写入 SD 卡上的 txt 文件）数据，而无需处理完整的 sqlite 编辑器（基于您对这些问题的回答）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T12:22:35.663

> 我没有 root 权限，也不是完全反对安装它，但想确保没有非 root 权限的方法可以做到这一点。

如果您不做任何工作，就没有非 root 的方法可以做到这一点。一个应用程序（例如 AIDE）无权访问另一个应用程序（例如您的应用程序）的内部存储。

非根选项包括：

*   为您的应用程序添加备份功能，将数据库复制到外部存储，此时您可以使用上一篇文章中提到的 aSQLiteManager 之类的应用程序（也可以[直接在 Play Store 上获得](https://play.google.com/store/apps/details?id=dk.andsen.asqlitemanager&feature=search_result)）。

*   在开发过程中暂时将某种 SQLite 编辑器烘焙到您的应用程序中，在您投入生产时将其删除。

# sql-server - 如何使用 sql server 2008 按日期时间将表记录从一个数据库发送到另一个数据库

> ID：12338957
> 
> 赞同：1
> 
> 时间：2012-09-09T12:12:56.300
> 
> 标签：sql-server, sql-server-2008

我计划通过表中的 Datetime 列将表记录从一个数据库移动到另一个数据库，请建议执行该任务的最佳方法，因为每天表将收到 2000 - 5000 条记录，所以它正在变得庞大

例子

```
Database (X)
table (xx) 

copy the records from table(xx) of database (X) by fetching 3 months old data by targeting Datetime column in the Table(xx) 

To 

Database(Y)
table(yy) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:37:50.067

您是否考虑过 SSIS 包？构建完成后，您可以手动运行它或安排它在特定时间间隔运行。这里有一些材料，我必须承认，它很容易构建，特别是对于像你描述的那样简单的任务。

[http://www.mssqltips.com/sqlservertutorial/207/creating-a-simple-ssis-package/](http://www.mssqltips.com/sqlservertutorial/207/creating-a-simple-ssis-package/)

[http://msdn.microsoft.com/en-us/library/ms169917(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms169917(v=sql.105).aspx)

[http://www.katieandemil.com/create-ssis-package-find-an-example-how-to-create-an-ssis-package-a-simple-one](http://www.katieandemil.com/create-ssis-package-find-an-example-how-to-create-an-ssis-package-a-simple-one)

# sql - 更新多行获取最大值

> ID：12338961
> 
> 赞同：1
> 
> 时间：2012-09-09T12:14:20.400
> 
> 标签：sql, sql-server-2008

我有一张桌子。

```
ID       SID     CID      Number
----------------------------------
1237      1       5        NULL
1236      1       5        NULL
1235      1       NULL      2
1234      1       NULL      2
1233      1       NULL      1
1232      1       NULL      1 
```

我想获得最大数值。并更新为 NULL 的 Number 列

```
DECLARE @Number INT;
SELECT @Number =  max([Number]) FROM STACKOVERFLOW WHERE [Number] IS NOT NULL AND SID = 1
SELECT @Number 
```

此 SQL 语句将返回 2。

正如我所说，我想更新数字列，`null`但它应该是`"maximum value of number column"`+ 1，也就是说在我的情况下它应该是 3。

```
DECLARE SID INT = 1;

UPDATE STACKOVERFLOW 
SET
Number = (
          SELECT TOP 1 CASE 
          WHEN Number IS NULL THEN 1 ELSE @Number + 1 END 
          FROM STACKOVERFLOW 
          WHERE SID = @SID AND Number IS NULL
         )
FROM STACKOVERFLOW WHERE ID = 1237 
```

该表将如下所示：

```
ID       SID     CID      Number
----------------------------------
1237      1       5         3
1236      1       5        NULL
1235      1       NULL      2
1234      1       NULL      2
1233      1       NULL      1
1232      1       NULL      1 
```

之后，当再次使用 sql 语句`ID = 1236` 时，@Number 将返回 3，记录将如下所示。

```
ID       SID     CID      Number
----------------------------------
.
1236      1       5        4
.
. 
```

但我想要的结果是

```
ID       SID     CID      Number
----------------------------------
.
1236      1       5      3
. 
```

在操作结束时，表格应该像

```
ID       SID     CID      Number
----------------------------------
1237      1       5         3
1236      1       5         3
1235      1       NULL      2
1234      1       NULL      2
1233      1       NULL      1
1232      1       NULL      1
1231      2       5         5
1230      2       5         5
1229      2       NULL      4
1228      2       NULL      4 
```

任何想法？感谢您的回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T12:20:23.013

```
UPDATE STACKOVERFLOW
   SET Number = (SELECT MAX(number) + 1 FROM STACKOVERFLOW WHERE SID = 1)
 WHERE Number IS NULL
   AND SID = 1 
```

然后对 SID = 2 做同样的事情

```
UPDATE STACKOVERFLOW
   SET Number = (SELECT MAX(number) + 1 FROM STACKOVERFLOW WHERE SID = 2)
 WHERE Number IS NULL
   AND SID = 2 
```

或者让它更优雅一点：

```
UPDATE STACKOVERFLOW
   SET Number = (SELECT MAX(number) + 1 FROM STACKOVERFLOW WHERE SID = A.SID)
  FROM STACKOVERFLOW A
 WHERE Number IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T12:22:45.323

一次全部设置或检查 CID 是否为 NULL

# c# - 使用 Xunit 测试多个派生类型的最佳方法是什么？

> ID：12338962
> 
> 赞同：2
> 
> 时间：2012-09-09T12:14:38.433
> 
> 标签：c#, unit-testing, xunit

我有一个界面`IFoo`

```
public interface IFoo
{
    void DoSomeStuff();
} 
```

我有两种派生类型`FooImpl1`和`FooImpl2`：

```
public class FooImpl1 : IFoo
{
    public void DoSomeStuff()
    {
        //...
    }
}

public class FooImpl2 : IFoo
{
    public void DoSomeStuff()
    {
        //Should do EXACTLY the same job as FooImpl1.DoSomeStuff()
    }
} 
```

我有一个测试类测试`IFoo`合同`FooImpl1`：

```
 private static IFoo FooFactory()
    {
        return new FooImpl1();
    }

    [Fact]
    public void TestDoSomeStuff()
    {
        IFoo foo = FooFactory();

        //Assertions.
    } 
```

我怎样才能重用这个测试类来测试`FooImpl1`和`FooImpl2`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T12:26:03.800

`IFoo`使用抽象方法返回适当实现的测试基类怎么样？

```
public abstract class FooTestsBase
{
    protected abstract IFoo GetTestedInstance();

    [Fact]
    public void TestDoSomeStuff()
    {
        var testedInstance = GetTestedInstance();
        // ...
    }
} 
```

现在，所有派生类型只需提供一个实例：

```
public class FooImpl1Tests : FooTestsBase
{
    protected override IFoo GetTestedInstance()
    {
        return new FooImpl1();
    }
} 
```

# ios - 如何将手势识别器添加到 UIImageview？

> ID：12338964
> 
> 赞同：5
> 
> 时间：2012-09-09T12:14:56.827
> 
> 标签：ios, uiview, uigesturerecognizer

在项目中，myView 后面有一个`UIView`myView 和一个`UIImageView`myImage，视图层次结构：

UIWindow
|-- UIImageView (myImage)
|-- UIView (myView) [全屏]

然后在 ViewController 中的 myImage 中添加一个手势识别器

```
UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleSingleTap:)];
        tapGesture.numberOfTapsRequired = 1;
        [myImage addGestureRecognizer:tapGesture]; 
```

但是手势不影响 myImage，myImage 有`setUserInteractionEnabled:YES`. 只有当myImage放在myView前面时才会有影响，请问这个问题怎么解决？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-09T12:17:47.180

您`UIView`显然在触摸到达之前拦截了触摸`UIImageView`。

你可以把你放在你`UIImageView`的前面`UIView`，或者禁用用户交互，`UIView`这样它就不会拦截触摸。

如果您需要更精细地捕捉触摸事件，您可以：

*   如果出于设计目的必须这样做（例如，如果它掩盖了`UIView`一点），但使它不捕获事件（`UIImageView``UIImageView``userInteractionEnabled = NO``UIView``UIImageView``UIImageView`
*   保持你`UIView`的顶部`UIImageView`并保持它捕捉事件（`userInteractionEnabled = YES`），但过滤通过它的事件，通过子类化你的`UIView`并覆盖`pointInside:withEvent:`或`hitTest:withEvent:`方法。

有关更多信息**，您应该真正阅读[与事件处理相关的专用 Apple 编程指南](http://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/Introduction/Introduction.html)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-23T07:00:13.993

我的代码：

```
UILongPressGestureRecognizer *press = [[UILongPressGestureRecognizer alloc] 
initWithTarget:self action:@selector(hasLongPressed)];
[press setMinimumPressDuration:0.1f]; //1ms
press.delegate = (id)self;
[self.DGEMLogo addGestureRecognizer:press]; 
```

有两个属性是必须做的

1.) 将 GestureRecognizer 添加到您的 UIImageView (self.DGEMLogo) [self.DGEMLogo addGestureRecognizer:press];

2.) 设置你的 UIImage 属性 Interaction enabled 为 TRUE

就这样。

# php - 如果仅使用 tmp 文件内容，允许上传 .php 文件是否危险？

> ID：12338965
> 
> 赞同：1
> 
> 时间：2012-09-09T12:15:12.223
> 
> 标签：php, security, file-upload

我根本没有将 tmp 文件移动到“实时”（网络可访问）目录，只是`file_get_contents`对 tmp 文件执行一个操作并针对它运行一些正则表达式（代码*永远不会*执行/运行）。

这会是危险的还是会带来任何风险？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T12:36:42.540

这在一定程度上取决于您的环境。

文件上传本身不会有害，除非您的环境不是 Windows。在这种情况下，我会使用防病毒程序来检查文件，然后再对其进行任何处理。

此外，文件大小很重要。`file_get_contents`将立即将**整个文件**读入服务器的内存。因此，如果文件太大或您的资源太少，您可能会遇到错误。

如果我不向用户展示上传的内容，这可能就是我担心的全部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T12:40:54.557

由于您没有执行它，因此该文件只不过是一个纯文本文件。像检查任何其他数据文件一样检查文件大小和类型，您应该是安全的。

如果您稍后决定使其可通过 Web 访问（无论出于何种原因），请确保对其设置权限（在 Linux 环境中）或更改文件扩展名（在 Windows 下），以使其无法执行。

# solr - 如何使用 nutch 解析 html 并将特定标签索引到 solr？

> ID：12338967
> 
> 赞同：5
> 
> 时间：2012-09-09T12:15:32.650
> 
> 标签：solr, nutch, apache-tika

我已经安装了 nutch 和 solr 来抓取网站并在其中搜索；如您所知，我们可以使用 nutch 的解析元标签插件将网页的元标签索引到 solr 中。（http://wiki.apache.org/nutch/IndexMetatags）现在我想知道有没有办法抓取另一个 html 标签到solr 不是元？（插件或无论如何）像这样：

```
<div id=something>
      me specific tag
</div> 
```

实际上，我想在此页面中向 solr（某物）添加一个值为“我特定标签”的字段。

任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T09:30:02.087

我为您想要的类似东西制作了自己的插件。将 NutchDocument 映射到 SolrDocument 的配置文件位于 $NUTCH_HOME/conf/ **solrindex-mapping.xml 中**。在这里您可以添加自己的标签。但是您仍然必须在某处填写自己的标签。

以下是插件的一些提示：

*   阅读[http://wiki.apache.org/nutch/WritingPluginExample](http://wiki.apache.org/nutch/WritingPluginExample)，在这里您可以找到如何非常简单地制作您的插件
*   在您的插件中扩展**ParseFilter**和**IndexingFilter。**
*   在*YourParseFilter*中，您可以使用**NodeWalker**找到您的特定 div
*   您的解析信息像这样放入页面元数据中

    `page.putToMetadata(new Utf8("yourKEY"), ByteBuffer.wrap(YourByteArrayParsedFromMetaData));`

*   在*YourIndexingFilter*中，将页面 (page.getMetadata) 中的元数据添加到 NutchDocument

    `doc.add("your_specific_tag", value);`

*   **最重要的！！！！！**

*   将**your_specific_tag**放入以下文件：

    *   **Solr**配置文件**schema.xml**（并重新启动 Solr）

    字段名称=“您的特定标签”类型=“字符串”存储=“真”索引=“真”

    *   **Nutch**配置文件**schema.xml**（不知道是否真的有必要）
    *   **Nutch**配置文件**solrindex-mapping.xml**

    字段 dest="your_specific_tag" 源="your_specific_tag"

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-15T07:01:49.197

你必须尝试[http://lifelongprogrammer.blogspot.in/2013/08/nutch2-crawl-and-index-extra-tag.html](http://lifelongprogrammer.blogspot.in/2013/08/nutch2-crawl-and-index-extra-tag.html) 教程说img标签如何获取以及所有步骤都提到.. .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-30T09:49:07.763

您可以使用这些自定义插件之一来解析基于 xpath（或 css 选择器）的 xml 文件：

*   [https://github.com/BayanGroup/nutch-custom-search](https://github.com/BayanGroup/nutch-custom-search)
*   [http://www.atlantbh.com/precise-data-extraction-with-apache-nutch/](http://www.atlantbh.com/precise-data-extraction-with-apache-nutch/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T14:26:49.300

您可能需要检查[Nutch 插件](https://issues.apache.org/jira/browse/NUTCH-978)，它应该允许您从网页中提取元素。

# c# - 如何指定 C# 泛型类型必须支持 Parse(string)？

> ID：12338968
> 
> 赞同：2
> 
> 时间：2012-09-09T12:15:34.493
> 
> 标签：c#, generics

我正在尝试为包含 SQL 查询结果的 XML 字符串创建一个解析器框架。目的是从通用类继承，这些类是用列数据类型实例化的。包含的代码适用于单列品种。两列将有额外的类，等等。

我需要能够指定泛型类型必须支持 Parse(string) 方法。我该怎么做呢？

```
abstract class OneColumnParser<Col1>
{
    abstract string Column1;

    List<Col1> ParseQueryResult(string queryResult)
    {
        XmlDocument xDoc = new XmlDocument();
        xDoc.LoadXml(queryResult);
        List<Col1> results = new List<Col1>();

        foreach (XmlNode xNode in xDoc.GetElementsByTagName(Column1))
        {
            results.Add(Col1.Parse(xNode.InnerText));
        }
    }
} 
```

当我编译上面的内容时，我在 results.Add() 行上得到“'Col1' is a 'type parameter', which is not valid in the given context”，因为我没有指定类型必须支持该方法. 但是怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-09T12:23:48.520

一种方法是为您的`Col1`类型定义无参数构造函数和接口：

```
interface IParseable
{
    void Parse(string text);
}

abstract class OneColumnParser<T> where T : IParseable, new
{
    abstract string Column1;

    List<T> ParseQueryResult<T>(string queryResult)
    {
        XmlDocument xDoc = new XmlDocument();
        xDoc.LoadXml(queryResult);
        var results = new List<T>();

        foreach (XmlNode xNode in xDoc.GetElementsByTagName(Column1))
        {
            var col = new T();
            col.Parse(xNode.InnerText);
            results.Add(col);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T12:30:34.237

因为接口不能有静态方法，所以你不能（直接）做你所要求的。反射是解决问题的一种方法，但它只在运行时验证，而不是由编译器强制执行。例如

```
abstract class OneColumnParser<TCol>
{
    private static MethodInfo ParseInfo = typeof(TCol).GetMethod("Parse", BindingFlags.Public | BindingFlags.Static, null, new[] { typeof(string) }, null);
    abstract string Column1;

    static OneColumnParser()
    {
        if (typeof(TCol) != typeof(string) && (ParseInfo == null || !typeof(TCol).IsAssignableFrom(ParseInfo.ReturnType)))
            throw new InvalidOperationException("Invalid type, must contain public static TCol Parse(string)");
    }

    private static TCol Parse(string value)
    {
        if (typeof(TCol) == typeof(string))
            return (TCol)(object)value;
        else
            return (TCol)ParseInfo.Invoke(null, new[] { value });
    }

    public List<TCol> ParseQueryResult(string queryResult)
    {
        XmlDocument xDoc = new XmlDocument();
        xDoc.LoadXml(queryResult);
        List<TCol> results = new List<TCol>();

        foreach (XmlNode xNode in xDoc.GetElementsByTagName(Column1))
        {
            results.Add(Parse(xNode.InnerText));
        }

        return results;
    }
} 
```

与定义自己的接口不同，这将适用于具有`Parse`方法的现有类型，例如`int`和`DateTime`。 **更新**添加的代码，使其也能正常工作`string`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T12:28:02.430

也许这会有所帮助。当您声明泛型函数时，您可以指定泛型必须实现接口。通过此接口，您可以设置 Parse() 支持。例如：

```
public void SomeFunction<T>(T variable) where T : IDisposable
       {
           variable.Dispose();
       } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T15:15:27.423

不是对您的问题的直接回答，但这是我用来从自定义配置部分处理程序返回类型值的通用字符串拆箱器类的代码，可能会给您一些想法...

```
using System.ComponentModel;
using System.Data.SqlTypes;
using System.Threading;

public static class StringUnboxer<T> {
    private static readonly object _lock = new object();
    private static T m_convertedValue = default(T);

    public static T unBox(string value) {
        try {
            Monitor.Enter(_lock);
            // Test to see if value is valid to convert to supplied type
            if (canUnBox(value)) {
                // value is valid, return conversion
                return m_convertedValue;
            }
            else {
                // Conversion not possible with given string data, return default value for supplied type
                switch (typeof(T).ToString()) {
                    // In our case, if the supplied type is System.DateTime, we want to return 
                    // System.Data.SQLTypes.SQLDateTime.MinValue (01/01/1753) instead of
                    // System.DateTime.MinValue (01/01/0001) which is the normal default value
                    case "System.DateTime":
                        return (T)TypeDescriptor.GetConverter(typeof(T)).ConvertFrom(SqlDateTime.MinValue.ToString());
                    // Return the .NET default value for all other types
                    default:
                        return default(T);
                }
            }
        }
        finally {
            Monitor.Exit(_lock);
        }
    }

    private static bool canUnBox(string value) {
        try {
            Monitor.Enter(_lock);
            m_convertedValue = (T)TypeDescriptor.GetConverter(typeof(T)).ConvertFrom(value);
            return true;
        }
        catch {
            return false;
        }
        finally {
            Monitor.Exit(_lock);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-21T18:55:12.883

在 .NET 6 中，您可以使用`IParseable<T>`提供静态抽象方法的接口（也是 .NET 6 中的新方法）`Parse`。

以下是它可能会为您寻找的方式：

```
abstract class OneColumnParser<Col1> where Col1 : IParseable<Col1>
{
    public abstract string Column1 { get; }

    List<Col1> ParseQueryResult(string queryResult)
    {
        XmlDocument xDoc = new XmlDocument();
        xDoc.LoadXml(queryResult);
        List<Col1> results = new List<Col1>();

        foreach (XmlNode xNode in xDoc.GetElementsByTagName(Column1))
        {
            results.Add(Col1.Parse(xNode.InnerText, CultureInfo.InvariantCulture));
        }

        return results;
    }
} 
```

这是使其运行的方法，因为截至目前 .NET 6 只有一个候选版本，并且功能处于预览阶段 - [https://devblogs.microsoft.com/dotnet/preview-features-in-net-6-generic -数学/](https://devblogs.microsoft.com/dotnet/preview-features-in-net-6-generic-math/)

# javascript - 模态提示 - 如何重写此代码？

> ID：12338972
> 
> 赞同：-4
> 
> 时间：2012-09-09T12:15:51.347
> 
> 标签：javascript, jquery, modal-dialog

我有以下 javascript 确认对话框，我想让它成为模态的，所以我可以根据我的页面设计来设置它的样式。对话框按原样工作，我只想使用普通的 javascript 或 jquery 使其成为模态，但不使用 jquery 用户界面。

这是我的代码：

```
$(".oneUser").submit(function() {    
    var agree=confirm("Record will be deleted! \n Are you sure?");
    if (agree)
        return true ;
    else
        return false ;       
}); 
```

问候，佐兰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:28:27.337

您可以使用在[不同问题](https://stackoverflow.com/questions/4743751/jquery-modal-dialog-box-isnt-submitting-my-form/12380436#12380436)中找到的相同结构并在此处应用它。

**HTML：**

```
<div id="confirm" style="display:none;"></div> 
```

**JavaScript：**

```
function showConfirmDialog(message) {
    $("#confirm").html(message);
    $("#confirm").dialog('open');
}

$(function() {
    var submitForm = $('.oneUser');
    var submit = false;

    $("#confirm").dialog({
        resizable: false,
        height: 140,
        modal: true,
        autoOpen: false,
        buttons: {
            'Submit': function() {
                $(this).dialog('close');
                submit = true;
                submitForm.submit();
            },
            'Cancel': function() {
                $(this).dialog('close');
            }
        }
    });
    $("#confirm").parent().appendTo($(".oneUser")); 

    submitForm.submit(function() {
        if (submit) {
            return true;
        } else {
            showConfirmDialog("Record will be deleted! <BR /> Are you sure?");
            return false;
        }
    });
}); 
```

# gcc - 将二叉搜索树转换为双向链表 - 代码运行良好 gdb 但运行时崩溃

> ID：12338976
> 
> 赞同：0
> 
> 时间：2012-09-09T12:16:29.627
> 
> 标签：gcc, gdb, linked-list, binary-search-tree

以下代码是将二叉搜索树转换为双向链表的代码。它在 GDB 中运行良好，但在运行时崩溃。当我只有 2 个输入到二叉搜索树时，当有 2 个以上的输入时它会崩溃，它工作正常。代码可能有什么问题。双向链表不是循环链表。所以第一个节点的前一个是NULL，最后一个节点的下一个是NULL。

```
#include<stdio.h>
struct node{
int data;
struct node* large;
struct node* small;
};

typedef struct node* Node;

void add_to_tree(Node *root, int num){
Node current = *root;
Node temp_store;
Node new_node = malloc(sizeof(Node));
new_node->data = num;
new_node->large = NULL;
new_node->small = NULL;

if(current == NULL){
    current = new_node;
    *root = current;
}
else
{
    while(current != NULL){
        temp_store = current;
        if(num > current->data)
            current = current->large;
        else
            current = current->small;
    }

    if(num <= temp_store->data)
        temp_store->small = new_node;
    else
        temp_store->large = new_node;
}
}
void display_list(Node head){
Node current = head;
if(head == NULL){
    printf("\nThe list is empty");
}
else{
    printf("\nThe list is:\n");
    while(current !=NULL){
        printf("%d\t", current->data);
        current = current->large;
    }
}
}

void join(Node a, Node b){
a->large = b;
b->small = a;
}

Node append(Node a, Node b){
Node aLast;
Node current;

if(a == NULL) return (b);
if(b == NULL) return (a);

current = a;
while(current->large != NULL)
    current = current->large;
aLast = current;

join(aLast, b);

return (a);
}

Node bst_to_dll(Node root){
Node aList;
Node bList;
if(root == NULL)
    return NULL;

aList = bst_to_dll(root->small);
bList = bst_to_dll(root->large);

root->small = NULL;
root->large = NULL;

aList = append(aList, root);
aList = append(aList, bList);

return aList;
}

int main(){
Node bin_tree = NULL;
Node d_list;

add_to_tree(&bin_tree, 1);
add_to_tree(&bin_tree, 2);
add_to_tree(&bin_tree, 3);

d_list = bst_to_dll(bin_tree);

display_list(d_list);

return 0;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T00:27:55.207

您的程序在编译时会生成警告：

```
gcc -g t.c
t.c: In function ‘add_to_tree’:
t.c:13: warning: incompatible implicit declaration of built-in function ‘malloc’ 
```

在 Valgrind 下也会产生 32 个错误，其中第一个是：

```
==29346== Invalid write of size 8
==29346==    at 0x4005E9: add_to_tree (/tmp/t.c:15)
==29346==    by 0x400820: main (/tmp/t.c:97)
==29346==  Address 0x51b6078 is 0 bytes after a block of size 8 alloc'd
==29346==    at 0x4C2A4D6: malloc (coregrind/m_replacemalloc/vg_replace_malloc.c:263)
==29346==    by 0x4005D7: add_to_tree (/tmp/t.c:13)
==29346==    by 0x400820: main (/tmp/t.c:97) 
```

这应该足以让您找出您的错误。

# symfony - symfony2.1 bundle 版本混淆，用于symfony 和sonata admin/knp menu bundle

> ID：12338982
> 
> 赞同：6
> 
> 时间：2012-09-09T12:17:16.350
> 
> 标签：symfony, symfony-2.1, composer-php, sonata-admin, knpmenubundle

我想将 symfony2.1 用于一个新项目。我尝试用 composer 安装 symfony2。但是有多个错误/问题，所以我对**粗体样式**中的每个问题也有疑问。有时我不知道我这样做是否正确。

我想使用稳定的版本，所以我选择了 2.1.0 版本而不是 dev/master。

```
php composer.phar create-project symfony/framework-standard-edition symfony v2.1.0 
```

结果是这样的：

```
Installing symfony/framework-standard-edition (v2.1.0)
  - Installing symfony/framework-standard-edition (v2.1.0)
    Downloading: 100%

    Created project in symfony
    Loading composer repositories with package information
    Installing dependencies from lock file
    Your requirements could not be resolved to an installable set of packages.

      Problem 1
        - Installation request for symfony/symfony == 2.1.9999999.9999999-dev -> satisfiable by                                               symfony/symfony 2.1.x-dev.
        - Can only install one of: symfony/symfony dev-master, symfony/symfony 2.1.x-dev.
        - Installation request for symfony/symfony == 9999999-dev -> satisfiable by symfony/sym                                              fony dev-master. 
```

所以我做了一个`php composer.phar update`并且依赖项安装没有错误。

但我注意到大多数捆绑包都没有稳定版本。例如教义/普通（2.3.x-dev），这里是完整列表

```
Loading composer repositories with package information
Updating dependencies
  - Installing doctrine/common (2.3.x-dev 605b1b8)
    Cloning 605b1b8b5a7bc8daf9111fb35483e5708e30de35

  - Installing doctrine/dbal (2.3.x-dev 239630b)
    Cloning 239630b61f03f39d198441eced1bfffb7b0e61d1

  - Installing twig/twig (dev-master 68b8c46)
    Cloning 68b8c4619c5bbe82bd345fe56070dec8c356610a

  - Installing symfony/symfony (2.1.x-dev e7059b4)
    Cloning e7059b44c78ca8e1e892adb4d93b5a482f4eb9b3

  - Installing swiftmailer/swiftmailer (dev-master e12e4ef)
    Cloning e12e4ef3a9d6dd60fb734a01984a6e6627aea764

  - Installing doctrine/orm (2.3.x-dev 4d9f24b)
    Cloning 4d9f24b2eef3af3a3e76c773994c19bbb0706f88

  - Installing doctrine/doctrine-bundle (dev-master v1.0.0)
    Cloning v1.0.0

  - Installing twig/extensions (dev-master f904575)
    Cloning f904575642b1213db69b4a98f08397e722ba1cae

  - Installing kriswallsmith/assetic (dev-master dfbb776)
    Cloning dfbb776288baf9319d1693195af2cb6e00729901

  - Installing symfony/assetic-bundle (dev-master 4e7e8a0)
    Cloning 4e7e8a039fa19434f04558473adbb201118af942

  - Installing symfony/swiftmailer-bundle (dev-master d2eae93)
    Cloning d2eae9385c029cbac031a90e6d2abc74b889a562

  - Installing monolog/monolog (dev-master a929570)
    Cloning a929570bb7688b39fefe4106f0ecf0ac35f37647

  - Installing symfony/monolog-bundle (dev-master v2.1.0-RC2)
    Cloning v2.1.0-RC2

  - Installing sensio/distribution-bundle (dev-master 9892129)
    Cloning 98921298951598e8707258cba2b6180b96faa91c

  - Installing sensio/framework-extra-bundle (dev-master v2.1.0)
    Cloning v2.1.0

  - Installing sensio/generator-bundle (dev-master v2.1.0-RC2)
    Cloning v2.1.0-RC2

  - Installing jms/metadata (1.1.1)
    Downloading: 100%

  - Installing jms/cg (1.0.0)
    Downloading: 100%

  - Installing jms/aop-bundle (1.0.0)
    Downloading: 100%

  - Installing jms/di-extra-bundle (1.1.x-dev af21952)
    Cloning af219527024c584d7311aa855d7522429c5bdb67

  - Installing jms/security-extra-bundle (1.2.x-dev 9ab6ace)
    Cloning 9ab6aceda50fc7a2b07d741ba4b3f0695508afcb 
```

**1a) 这是对的吗？还是有其他解决方案？我的意思是使用稳定且不在开发模式下的捆绑包**

第二天，我再次进行了作曲家更新，并注意到一些库已更新：dev-master 分支的所有库在最后一天有新的更改。
**1b）所以我应该在开发我的应用程序时定期更新作曲家，合并新的错误修正等？**

```
$ php composer.phar update
Loading composer repositories with package information
Updating dependencies
  - Updating swiftmailer/swiftmailer dev-master (e12e4e => c97353)
    Checking out c97353b1ebffe25a224146f69d17efe24c093def

  - Updating monolog/monolog dev-master (a92957 => e5bf7b)
    Checking out e5bf7ba5d1df622b68d004b3c0277bc94286e1b7

  - Updating friendsofsymfony/user-bundle dev-master (24edb2 => 878b7c)
    Checking out 878b7c8320159fb09e8e94d446c498b00142b206

  - Updating sonata-project/notification-bundle dev-master (5e7b50 => 9cef7d)
    Checking out 9cef7d224f224b4e4327f200f9bd57b798d4ab0a

  - Updating knplabs/gaufrette dev-master (861110 => 5ac439)
    Checking out 5ac439cd46eb461043e6bb73dae717528f674a57

  - Updating sonata-project/media-bundle dev-master (d04a61 => 233511)
    Checking out 2335114dab6ea9680d174df157f5a7b4551a54dc 
```

因为我没有找到另一个解决方案，所以我继续并通过将此行添加`"friendsofsymfony/user-bundle": "*"`到 composer.json 来安装 FOS UserBundle。我做了整个安装工作​​，而且效果很好。

然后我开始通过添加`"sonata-project/admin-bundle": "dev-master"`到 composer.json 来安装 Sonata AdminBundle。我选择了 dev-master 版本，因为在[http://packagist.org/packages/sonata-project/admin-bundle](http://packagist.org/packages/sonata-project/admin-bundle)我发现 2.0.x-dev 版本不适用于 symfony2.1。
此外，AdminBundle 对 knplabs/knp-menu-bundle 具有依赖关系：1.1.*
在[http://packagist.org/packages/knplabs/knp-menu-bundle](http://packagist.org/packages/knplabs/knp-menu-bundle)上，我看到 v1.1.0 版本存在另一个依赖项knplabs/knp-menu: 1.1.*
然后在[http://packagist.org/packages/knplabs/knp-menu](http://packagist.org/packages/knplabs/knp-menu)我发现了 4 个以 1.1 开头的版本：

*   1.1.x-dev
*   v1.1.2
*   v1.1.1
*   v1.1.0

**2a) 版本号前是否有前导`v`？**

**2b) 当依赖项为 1.1* 时，将使用这四个版本中的哪个版本？**

当我开始加载管理包 deps 时，我看到了结果：

```
$ php composer.phar update
Loading composer repositories with package information
Updating dependencies
  - Installing knplabs/knp-menu (1.1.x-dev v1.1.2)
    Cloning v1.1.2

  - Installing knplabs/knp-menu-bundle (v1.1.0)
    Downloading: 100%

  - Installing sonata-project/admin-bundle (dev-master 20d5e4a)
    Cloning 20d5e4a659bddb5fc0bcfc4755643dbc4e3f7ec1 
```

我安装了更多奏鸣曲捆绑包（doctrine-orm-admin-bundle、user-bundle、page-bundle、media-bundle），但出现错误

```
 - Installing imagine/imagine (v0.3.0)
    Downloading: 100%

  [ErrorException]
  rename(C:\wamp\www\symfony\vendor/imagine/Imagine/avalanche123-Imagine-a23b4f5,afcc946468d0cf073686fe7e1ae19eb2): access denied
   (code: 5) 
```

**3）但是当我重复该步骤时，错误消失了。这是正常的吗？**

```
$ php composer.phar update
Loading composer repositories with package information
Updating dependencies
  - Installing imagine/imagine (v0.3.0)
    Downloading: 100%

  - Installing knplabs/gaufrette (dev-master 8611109)
    Cloning 8611109aeb0bd43fd88485c20fec7fc85b021b84

  - Installing sonata-project/media-bundle (dev-master d04a617)
    Cloning d04a617d81383a6e1ba65ee99c2ea4379e7daf4e 
```

然后我继续配置sonata admin bundle。添加创建 Post 实体和 PostAdmin 并为其配置服务后（顺便说一句：服务配置有点差），注意到我忘记安装 Knp 菜单（错误是`non-existent service "knp_menu.factory`：）

我继续[https://github.com/KnpLabs/KnpMenuBundle/blob/master/Resources/doc/index.md](https://github.com/KnpLabs/KnpMenuBundle/blob/master/Resources/doc/index.md)并查看安装说明的详细信息。屁股已经过时了。从smyfony2.1开始。`$loader`autoload.php 中的 不再有任何功能`registerNamespaces`，因为这不是 UniversalClassLoader 类，而是 composer 类加载器。所以我必须创建一个自己的 UniversalClassLoader 实例。而且路径完全不同，现在有一个父`knplabs`目录，子目录也发生了变化。

```
use Symfony\Component\ClassLoader\UniversalClassLoader;
use Doctrine\Common\Annotations\AnnotationRegistry;

$loader = require __DIR__.'/../vendor/autoload.php';

// intl
if (!function_exists('intl_get_error_code')) {
    require_once __DIR__.'/../vendor/symfony/symfony/src/Symfony/Component/Locale/Resources/stubs/functions.php';

    $loader->add('', __DIR__.'/../vendor/symfony/symfony/src/Symfony/Component/Locale/Resources/stubs');
}

$universalLoader = new UniversalClassLoader();
$universalLoader->registerNamespaces(array(
        'Knp\Menu' => __DIR__.'../vendor/knplabs/knp-menu/src',
        'Knp\Bundle' => __DIR__.'/../vendor/knplabs/knp-menu-bundle'
));
$universalLoader->register();

AnnotationRegistry::registerLoader(array($loader, 'loadClass'));

return $loader; 
```

**4) 为什么 KnpMenu 安装结构已经过时，为什么 github 上只有一个 master 分支，而[http://packagist.org](http://packagist.org)上存在的版本没有？**

我是 symfony2 和作曲家的新手，有时真的很难理解这一切。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-09T20:26:13.030

> 1a) 这是对的吗？还是有其他解决方案？我的意思是使用稳定且不在开发模式下的捆绑包

Symfony21 将标准为您选择最佳版本。[`composer.json`](https://github.com/symfony/symfony-standard/blob/v2.1.0/composer.json)您可以在包的文件中看到这些版本`symfony/framework-standard-edition`（`symfony/symfony-standard`在 github 上）。

如您所见，它使用的是`2.1.*`版本而不是`dev-master`版本，但因为包的最新版本以它开头，`2.1`它将加载`dev-master`. 后来，使用 symfony2.2 它不应该使用 . `dev-master`，而是使用最新`2.1`版本的包。

如果你想要一个静态版本，你可以`*`用你想要的 subversion 替换，但我不推荐这样做，因为你没有得到错误修复。

> 1b）所以我应该在开发我的应用程序时定期更新作曲家，合并新的错误修正等？

是的，不时更新您的依赖关系是件好事。例如，如果您认为您发现了一个错误，或者您将其推入`production`.

> 2a) 版本号前是否有前导 v 有区别吗？

正如我们在[packagist 文档](http://packagist.org/about)中看到的（在*管理包版本*下）没有区别。你可以同时使用它们，如果你使用`2.1.4`它会寻找一个`2.1.4`版本或`v2.1.4`.

> 2b) 当依赖项为 1.1.* 时，将使用这四个版本中的哪个版本？

最新的`1.1`颠覆。例如，如果您`foobar`的软件包有以下版本：1.1.1、1.1.2 .. 1.1.6。并且您需要安装`1.1.*`最新的 ( `1.1.6`)。

> 3）但是当我重复该步骤时，错误消失了。这是正常的吗？

看起来 CLI 无法访问该文件，您可能在程序中打开了它。当您第二次尝试它时，它可以访问。

> 4) 为什么 KnpMenu 安装结构已经过时，为什么 github 上只有一个 master 分支，而[http://packagist.org](http://packagist.org)上存在的版本没有？

第一个问题：我不知道为什么文档已经过时。您应该进入`vendor/composer/autoload_namespaces.php`文件并将名称空间放在那里，然后它应该可以工作。或者，更好的选择是将这些命名空间添加到文件中的`require`设置中`composer.json`。有关更多信息，请参阅[作曲家自动加载文档](http://getcomposer.org/doc/04-schema.md#autoload)。

第二个问题：它也使用github 上的[标签。](https://github.com/KnpLabs/KnpMenu/tags)

# jquery - Jquery Chrome 动画问题

> ID：12338985
> 
> 赞同：0
> 
> 时间：2012-09-09T12:17:47.473
> 
> 标签：jquery, html, css

[http://inspiredthinkinggroup.com/micro/](http://inspiredthinkinggroup.com/micro/)

单击右上角的联系按钮时，动画在所有其他浏览器中都可以正常工作，但在 chrome 中，它卡在了中途。当鼠标指针从按钮上移开时，动画就完成了。这仅发生在 chrome 中，无法解决问题，

```
$('.btnContact').live('click', function(event) {
        event.preventDefault(); 
        $(".sliderHome").animate({ top: "-570px"},500);
        $(".contactUsPage").animate({ top: "0px"},500);
        $("#internalPage").animate({ top: "-570px"},500);
        $('.btnContact').addClass("contactSelected");
        $('.scrollnav').removeClass("selected");
        $('.internalTitle').hide(0);
        $(".logoCont h1").html("Overview for Simon Ward").fadeIn(300);
    }); 
```

任何的想法？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:53:46.073

当您删除这部分代码时，它可以完美运行：

```
$('.btnContact').addClass("contactSelected");
$('.scrollnav').removeClass("selected");
$('.internalTitle').hide(0);
$(".logoCont h1").html("Overview for Simon Ward").fadeIn(300); 
```

只留下：

```
$('.btnContact').live('click', function(event) {
    $(".sliderHome").animate({ top: "-570px"},500);
    $(".contactUsPage").animate({ top: "0px"},500);
    $("#internalPage").animate({ top: "-570px"},500);
}); 
```

所以尝试用另一种方式来做

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T08:28:23.597

我仍然找不到解决方案，无论如何我发现这与 bg 视频有关。它是使用 sw 对象嵌入的。似乎chrome无法同时处理两者。

谢谢大家的帮助。！！

# php - 删除括号但保持 CDATA 不变

> ID：12338988
> 
> 赞同：0
> 
> 时间：2012-09-09T12:18:09.300
> 
> 标签：php, cdata

是否可以删除里面的括号但保持 CDATA 标签不变？如何？

```
<![CDATA[

This is some Text with [brackets inside]

]]> 
```

编辑：我使用 PHP，对不起。

编辑二：我看到我可以使用环视断言，但有点不知道如何做 AND 连接器，即左括号可能在 CDATA 之前或之后，以及如何连接最后两个块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T13:15:32.457

这是您需要的正则表达式：

```
$subject = 'your_input_text';
$matchPattern = '/(<!\[CDATA\[[^[]*)\[(.*?)\]([^\]]*\]\]>)/s';
$replacePattern = '$1$2$3';
$result = preg_replace($matchPattern, $replacePattern, $subject); 
```

你可以在**[这里](http://regexr.com?323du)**看到结果。

这是正则表达式模式的解释：

```
# (<!\[CDATA\[[^\[]*)\[(.*?)\]([^\]]*\]\]>)
# 
# Options: dot matches newline
# 
# Match the regular expression below and capture its match into backreference number 1 «(<!\[CDATA\[[^\[]*)»
#    Match the characters “&lt;!” literally «<!»
#    Match the character “[” literally «\[»
#    Match the characters “CDATA” literally «CDATA»
#    Match the character “[” literally «\[»
#    Match any character that is NOT a [ character «[^\[]*»
#       Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
# Match the character “[” literally «\[»
# Match the regular expression below and capture its match into backreference number 2 «(.*?)»
#    Match any single character «.*?»
#       Between zero and unlimited times, as few times as possible, expanding as needed (lazy) «*?»
# Match the character “]” literally «\]»
# Match the regular expression below and capture its match into backreference number 3 «([^\]]*\]\]>)»
#    Match any character that is NOT a ] character «[^\]]*»
#       Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
#    Match the character “]” literally «\]»
#    Match the character “]” literally «\]»
#    Match the character “&gt;” literally «>» 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T12:27:35.840

```
// uses MFC CString syntax but any string library will have the same essential functions

CString myCDATA;
CString workString;
int iTagStart;

iTagStart = String.Find("<![CDATA[") + 9 // 9 = length of "<![CDATA["
// get the string without the endpoints
workString = CString.Mid(iTagStart,myCDATA.GetLength() - 9 - 3); // 3 = length of "]]>"
workString.Replace("[","");
workString.Replace("]","");
// reassemble
myCDATA = "<![CDATA[" + workString + "]]>"; 
```

# android - 圆形移动文本作为活动标签

> ID：12338990
> 
> 赞同：0
> 
> 时间：2012-09-09T12:18:47.817
> 
> 标签：android

我有一个用于显示文章的活动，我想将文章的标题设置为活动标题标签。

由于文章的标题可能很长，我想为文本设置移动效果，从右到左，圆形。可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T12:29:09.913

您可能需要创建**自定义标题栏**

检查本[教程](http://www.londatiga.net/it/how-to-create-custom-window-title-in-android/)

# jquery - jscrollpane ：更改 ArrowSizes

> ID：12338991
> 
> 赞同：0
> 
> 时间：2012-09-09T12:19:05.473
> 
> 标签：jquery, jscrollpane

我看到可以在此处使用“arrowSize：30”更改大小或箭头：http: [//www.kelvinluck.com/assets/jquery/jScrollPane/examples.html](http://www.kelvinluck.com/assets/jquery/jScrollPane/examples.html)（旧版本的 jscrollpane）

但是如何更改新版本中箭头的大小？我需要新版本，因为它支持箭头的不同位置：

[http://jscrollpane.kelvinluck.com/arrow_positions.html](http://jscrollpane.kelvinluck.com/arrow_positions.html)

我没有看到任何更改箭头大小的选项，即使我在旧版本中使用“arrowSize”，也没有任何变化。

提前致谢！

克莱门斯

# java - 三星 Galaxy S3 的 SoundPool 重复问题

> ID：12338992
> 
> 赞同：1
> 
> 时间：2012-09-09T12:19:11.843
> 
> 标签：java, android, audio

我正在尝试为我的应用程序播放背景声音，我使用`SoundPool`类，我的问题是，只有当我将***循环***参数设置为零值时，声音才能正常播放，但它不适用于任何其他值。

我的初始化代码是：

```
 soundpool = new SoundPool(4, AudioManager.STREAM_MUSIC, 0);
    soundsMap = new HashMap<Integer, Integer>();
    soundsMap.put(1, soundpool.load(this, R.raw.soundfile_1, 1));
    soundsMap.put(2, soundpool.load(this, R.raw.soundfile_2, 1)); 
```

我玩的代码是

```
 soundpool.play(1,  0.9f, 0.9f, 1, -1, 1f); 
```

正如我提到的，当我将 (0) 而不是 (-1) 作为循环值时，声音有效，任何人都知道为什么 (-1) 或 (0) 以外的任何值都不起作用（没有输出声音） ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T09:36:23.487

文件大小可能太大而无法循环，正如此处所报告的那样：[http ://www.talkandroid.com/android-forums/android-development-answers-tutorials-code-snippets/5132-soundpool-setloop-possible-bug .html](http://www.talkandroid.com/android-forums/android-development-answers-tutorials-code-snippets/5132-soundpool-setloop-possible-bug.html)

一般来说，SoundPool 的文件大小似乎相当大，所以也许应该将声音剪辑切成更小的剪辑和/或使用 MediaPlayer。

# php - 循环遍历动态 mysql 数据数组时遇到问题

> ID：12338997
> 
> 赞同：0
> 
> 时间：2012-09-09T12:19:59.313
> 
> 标签：php, mysql, arrays, multidimensional-array

我有一个数组，一个例子是..

```
Array
(
    [cats] => Resource id #54
    [listings] => Array
        (
            [home-and-garden] => Resource id #55
            [professional-services] => Resource id #56
            [community] => Resource id #57
            [education-and-instruction] => Resource id #58
            [automotive] => Resource id #59
            [legal-and-financial] => Resource id #60
        )

) 
```

现在，关键是一个 MySQL 数据集，使用;`cats`循环没有问题。`mysql_fetch_array`但是一旦进入该循环，我尝试在列表数组的某个键上运行另一个循环，例如`home-and-garden`，列表数组下的所有键都是动态的，所以我必须传入一个带有键名的变量，但是它不会t 进入循环。

下面是我的代码示例..

```
protected function makePopularCategoryHTML($sql) {

    while (list($main_category,$slug,$image)=mysql_fetch_array($sql['cats'])) {

        // Make lowercase category slug
        $main_category_slug = URLSafe($main_category);

        while (list($category,$name,$tag1,$newurl)=mysql_fetch_array($sql['listings'][$main_category_slug])) {

            // It won't enter this loop                

        }

    }

} 
```

**编辑：**一个例子`$sql['listings'][$main_category_slug]`的转储如下：

```
resource(55) of type (mysql result) 
```

转储`$sql['listings']`如下：

```
array(6) {
  ["professional-services"]=>
  resource(55) of type (mysql result)
  ["home-and-garden"]=>
  resource(56) of type (mysql result)
  ["community"]=>
  resource(57) of type (mysql result)
  ["food-and-dining"]=>
  resource(58) of type (mysql result)
  ["real-estate"]=>
  resource(59) of type (mysql result)
  ["business-to-business"]=>
  resource(60) of type (mysql result)
} 
```

它们似乎都是有效的资源，我检查了密钥名称是否正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:42:35.247

它不会进入的数组是空的，因为我假设因为我没有从相应的查询中得到任何错误，所以查询没问题，但事实并非如此 - 搜索参数之一是空白的。

如果您遇到这样的问题，请*始终*输出相应的查询并手动运行它以查看您是否有一个空的结果集。

# sharepoint - GoogleEarth API / Web 部件 - 使用 fectchKML 从文档库获取 KML 时获取用户名|密码对话框

> ID：12338999
> 
> 赞同：2
> 
> 时间：2012-09-09T12:20:06.583
> 
> 标签：sharepoint, authentication, popup, request

问题：我域中 1/10 的用户从我构建的 Google 地球 Web 部件中弹出“身份验证请求”。我已将其追踪到 fetchKML() 调用。它还会在动态加载地标图像时进行提示。请务必注意，KML 和图像位于文档库中。如果我将两者都放入 14 蜂巢中，则效果很好。

配置：SharePoint 2010、Windows 7、谷歌地球插件 5.2.1、Windows 9

备注：

1.  我们的 Internet Explorer 设置由组策略管理，并且没有看到他们的 IE 和我的 IE 之间有任何区别。
2.  我们的网络不允许使用 FireFox 和 Opera。
3.  身份验证提示不是典型的 SharePoint (Windows) 身份验证对话框。它是一个 Google 地球对话框。
4.  我已确保所有用户都可以访问文档库以及 KML 和图像文件。我已确保它们已“签入”并已发布。依然没有。
5.  它可以从 14 配置单元加载它（这是不可行的，因为它将是一个 Web 部件，理论上可以用用户 KML 和地标图标填充 14 配置单元。）
6.  一切似乎都指向 IE 设置。我们的设置非常受限，我无法查看许多 IE 设置。
7.  我还注意到，我无法在提示输入用户名|密码的客户端上进行注册表编辑（有或没有特权帐户）。但是，我可以修改 GPEdit.msc。只是不确定要改变什么。

提前感谢您的任何回复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T20:48:09.793

因此，我在其中一个有问题的客户端上删除了 google-earth 插件，然后重新安装了它。这解决了这个问题。几周前我在另一个盒子上做过这个，它没有解决问题，但我不记得我重新安装了哪个版本的 GE。

我也不确定我删除了哪个版本，但我安装了 5.2 版（由于防火墙，我无法下载最新版本的 GE）。

显然，网络上有几台计算机具有旧图像。我将在另一个遇到此问题的客户端上检查 GE-Plugin 的版本，并使用有问题的版本更新帖子。

希望我们的网络管理员会在 GP 中推出工作版本，但我不会把农场押在它上面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T21:51:52.927

可能是 cookie 存储问题。如果不能在受影响的机器上运行 Fiddler，很难说。

您可以使用服务器发出 http 请求，添加[cookie 容器](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.cookiecontainer%28v=vs.90%29.aspx)

看看您是否可以获得创建具有相同权限的服务帐户来复制问题，然后使用 Fiddler 进行调试。