# StackOverflow 问答 000403000-000403999

# internet-explorer-8 - 您对在您的页面中包含 ie7.js 或 ie8.js 感觉如何？

> ID：403011
> 
> 赞同：30
> 
> 时间：2008-12-31T13:56:53.243
> 
> 标签：internet-explorer-8, internet-explorer-7, cross-browser

见这里：[http ://code.google.com/p/ie7-js/](http://code.google.com/p/ie7-js/)

有没有人对此javascript有任何经验或评论？值得包括吗​​？你推荐它吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-31T14:04:00.890

我认识很多人，包括我自己在内，他们正在使用各种 IE hack 来获得透明的 PNG 支持。这看起来有点帮助，只要它有效，而且尺寸相当小，我不会反对使用它。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-06T16:06:15.240

我以前用过，结果好坏参半。这些脚本会导致 IE 在页面加载时出现一些问题。基本上，您必须将其视为遍历元素和样式表规则，以对特定渲染引擎中存在缺陷的区域应用“修复”。在某些情况下，根据您的标记或样式表的复杂程度，这可能需要一些时间，您会看到浏览器挂起。

也就是说，如果您可以权衡性能成本，您将节省开发时间，因为您将花费更少的时间来破解 IE6 的怪癖；IE7/IE8 将提供足够的缺失功能，您可以避免某些极端情况，可以更好地使用标准进行开发（最小宽度/最小高度、多个类名选择器等），并且某些渲染问题将消失。

但是，如果您只需要 24 位透明 PNG 支持，请使用为此构建的工具。仅包括 IE7/IE8.js 来支持 PNG 就像用坦克敲钉子一样。为此使用 DD_belatedPNG。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-19T17:36:19.510

它可以工作，但值得记住的是，ie7.js 和 ie8.js 不仅仅提供透明的 PNG 支持。即使有透明 PNG 支持，值得记住的是，透明背景图像不能使用 background-repeat 平铺（重复）或使用 background-position 定位。这阻碍了使用背景位置使用 CSS 翻转的任何能力。我只在我做过的一个网站上使用它，现在我正在更新网站，我无法删除 ie8.js，因为如果我这样做整个网站会破坏 IE 中的布局。我不相信我将来会使用它，而是依靠简单的 CSS hack 或者只是让我的网站在 IE6 中“优雅地降级”。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-15T16:37:20.163

我知道有一些解决透明 PNG 问题的工具比这更灵活。例如，jQuery 插件[ifixpng2](http://plugins.jquery.com/project/iFixPng2)将支持背景位置，而 ie7-js 不支持。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-31T14:46:04.940

只要您确切地知道它修复了什么，我会说去吧。我不确定这个库到底是什么，但是如果你有一个大型 DOM，一些库会变得非常昂贵，因为它们往往会在每个 DOM 元素上挂钩 HTC 文件基础行为。这会导致可怕的“Loading x of y”状态栏消息在初始加载和任何新生成的 DOM 内容时不断闪烁。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-16T09:04:03.543

好吧，它的美丽和工作方式你可以使用像 li:hover 这样的 cs3 功能。我们上次使用 ie8.js 确实丢失了项目，而且效果很好。

# database-connection - 从 Microsoft 数据应用程序块连接到 MySQL

> ID：403018
> 
> 赞同：1
> 
> 时间：2008-12-31T14:01:54.170
> 
> 标签：database-connection, application-blocks

l 我使用数据应用程序块进行大部分数据访问，特别是使用 SqlHelper 类来调用 ExecuteReader、ExecuteNonQuery 等方法。在每个数据库调用中传递连接字符串。

我如何修改它以启用与 MySQL 数据库的连接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T07:12:03.260

如果您已经安装了 Enterprise Library 并且已经知道如何连接到 SQL Server 数据库，那么连接到 MySQL 数据库并不难。

一种方法是使用 ODBC。这就是我所做的：

1.  转到 MySQL.com 并下载最新的 MySQL ODBC 连接器。在我写这篇文章时，它是 5.1.5。我使用的是 64 位版本，因为我有 64 位 Vista。
2.  安装 ODBC 连接器。我选择使用无安装程序版本。我只是解压缩它并在管理员的命令提示符下运行 Install.bat。MSI 版本可能工作正常，但我在安装 3.51 连接器时就这样做了。
3.  通过打开 ODBC 控制面板并检查驱动程序选项卡来验证安装。您应该会看到那里列出的 MySQL ODBC 5.1 驱动程序。如果您已经拥有它，它似乎甚至可以与旧的 3.51 版本和平共存。此外，如果也安装了 .NET 连接器，它也可以和平共存。
4.  此时，您将完成连接到 SQL Server 数据库的操作。您只需要知道连接字符串的用途。
5.  这是我的样子：
6.  当然，您可以将“名称”设置为您想要的任何内容。
7.  如果这是您唯一的数据库，您可以将其设置为 defaultDatabase，如下所示：
8.  像往常一样访问代码中的数据！这是一个纯文本 sql 示例：

```
    公共列表<联系人> Contact_SelectAll()
    {
        列表<联系人> 联系人列表 = 新列表<联系人>();
        数据库 db = DatabaseFactory.CreateDatabase("MySqlDatabaseTest");
        DbCommand dbCommand = db.GetSqlStringCommand("select * from Contact");
        使用 (IDataReader dataReader = db.ExecuteReader(dbCommand))
        {
            而（dataReader.Read（））
            {
                联系人联系人 = 新联系人（）；
                contact.ID = (int) dataReader["ContactID"];
                client.FirstName = dataReader["ContactFName"].ToString();
                client.LastName = dataReader["ContactLName"].ToString();
                客户端列表。添加（客户端）；
            }
        }

        返回客户端列​​表；
    }

```

另一种方法是构建和使用 MySql 提供程序。[这家伙就是这么做的](http://www.codeproject.com/KB/database/MySql_with_Ent_Lib.aspx)。[我通过调整这些说明](http://davidhayden.com/blog/dave/archive/2007/01/28/EnterpriseLibraryDAABMicrosoftAccess2007.aspx)以连接到 Access 来学习如何做到这一点。[哦，这里还有一些 MySql 连接字符串示例](http://www.connectionstrings.com/mysql)。

# jquery - 如何使用 jQuery 和 ASP.NET MVC 从 AJAX 调用返回错误消息？

> ID：403025
> 
> 赞同：2
> 
> 时间：2008-12-31T14:04:50.747
> 
> 标签：jquery, asp.net-mvc

如果我有一个从需要引发错误的 jQuery .ajax 调用调用的 ASP.NET MVC 控制器操作，我该怎么做？我知道我可以创建一个 JSON 对象并将其传递一个“错误”属性，但是如果 .ajax 调用的响应不是 JSON 而是 HTML 怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T14:20:58.017

使用 HandleError 属性，并将 View 设置为返回相应 HTML 片段的视图。

```
[HandleError(View="AjaxErrorFragment")]
public ActionResult ICallThisWithjQuery() { 
```

# asp.net - 从 ASP.NET 代码更改 CSS 样式

> ID：403031
> 
> 赞同：21
> 
> 时间：2008-12-31T14:09:18.413
> 
> 标签：asp.net, css, vb.net, html

> **可能的重复：**
> [动态更改 CSS](https://stackoverflow.com/questions/1501577/change-css-dynamically)

我需要从 ASP.NET 代码 (VB) 更改 div 容器的高度（CSS 属性高度）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-12-31T14:13:09.483

C#，因为我不想打错 VB 语法。

标记：

> ```
> <div runat="server" id="divControl">...</div> 
> ```

页面类别：

> ```
> protected System.Web.UI.HtmlControls.HtmlGenericControl divControl; 
> ```

OnLoad/其他功能：

> ```
> divControl.Style.Add("height", number / anotherNumer); 
> ```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-31T14:51:22.497

VB版：

班级：

```
Protected divControl As System.Web.UI.HtmlControls.HtmlGenericControl 
```

OnLoad/其他功能：

```
divControl.Style("height") = "200px" 
```

我从未尝试过使用样式的 Add 方法。如果高度已经存在于 DIV 上怎么办？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-31T14:23:20.477

作为一个不做 - 另一种方法是使用：

```
divControl.Attributes.Add("style", "height: number"); 
```

但是不要把它当作它的杂乱无章，AviewAnew 的答案是正确的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T14:23:40.087

如果您的 div 是带有 runat="server" 的 ASP.NET 控件，那么 AviewAnew 的答案应该可以做到。如果它只是一个 HTML div，那么您可能想要使用 JavaScript。您可以将实际的 div 标签添加到您的问题中吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T18:44:46.970

我发现当使用 C# 代码修改 CSS 值时，代码会很快变得混乱。也许更好的方法是让您的代码在 div 标签上动态设置 class 属性，然后将任何特定的 CSS 设置存储在样式表中。

这可能不适用于您的情况，但如果您需要在服务器端代码中动态更改样式，这是一个不错的默认位置。

# c# - C# MySqlCommand 多次删除外键问题

> ID：403047
> 
> 赞同：0
> 
> 时间：2008-12-31T14:17:18.040
> 
> 标签：c#, mysql, foreign-keys

我希望有人可以帮助我解决这个问题。

我有一个小应用程序来“修补”我们的数据库，因为我们需要增强功能并修复错误。它读取只是带有 SQL 语句的文件的补丁，并进行一些内部管理，查询数据库并应用尚未应用的补丁。无论如何，这是我们拥有的解决方案，无论好坏，它都运作良好......直到现在。

我发现有必要删除许多表上的现有外键约束，并用 ON DELETE CASCADE 子句代替它们当前拥有的 ON DELETE RESTRICT 子句。这个想法是删除这些其他表引用的表上的 PK 将导致所有其他表的清理。

本质上，补丁文件中包含以下内容：

```
ALTER TABLE `mydb`.`table2` DROP FOREIGN KEY `fk_table2_id`;
ALTER TABLE `mydb`.`table3` DROP FOREIGN KEY `fk_table3_id`;
ALTER TABLE `mydb`.`table4` DROP FOREIGN KEY `fk_table4_id`; 
```

和相关的

```
ALTER TABLE `mydb`.`table2` ADD CONSTRAINT `fk_table2_id` FOREIGN KEY `fk_table_id` (`fk_the_id`) REFERENCES `mydb` (`id`)
ON DELETE CASCADE
ON UPDATE RESTRICT;

etc... 
```

在 C# 端，当我传递这个字符串（补丁文件中的 SQL 语句）时，如下所示：

```
MySqlCommand myCommand = new MySqlCommand(thePatch);
myCommand.Connection = connection;
myCommand.ExecuteNonQuery(); 
```

我收到以下错误消息：

*将“.\mydb\table2”重命名为“.\mydb#sql2-6a8-3f”时出错（错误号：152）*

只有当我在字符串中有两个 DROP FOREIGN KEY 行时，我才会得到这个。

我已经确保 DROP 行上列出的键是键而不是列名，并且其他所有内容（至少对我来说）都可以。

我在一个 MySqlCommand 中包含了多个 SQL 语句并且没有任何问题，所以我有点沮丧。

我可以获取相同的文件并将其从命令行通过管道传输到 mysql.exe，它工作正常，因此在处理语句的方式上似乎有所不同。

有人对此有任何想法吗？

谢谢，马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T17:44:04.810

我不知道完整的答案，但这可能有助于更深入地解决问题。当您更改表时，MySQL 使用以下步骤：

1.  使用新规范创建表 newTableName
2.  SELECT * FROM oldTableName INTO newTableName
3.  将 oldTableName 重命名为一些 middleTableName
4.  将 newTableName 重命名为 OldTableName
5.  DROP TABLE 中间表名

您提到的错误看起来可能在此处的第 3 步失败。您可以检查文件权限。除此之外，我将听从那些对 MySQL 内部结构有更深入了解的人。

# asp.net - 从 ASP.NET 用户控件引发 javascript 事件并在 ASP.NET 页面中处理

> ID：403048
> 
> 赞同：4
> 
> 时间：2008-12-31T14:17:24.343
> 
> 标签：asp.net, javascript, events

在 ASP.NET 页面中，我有一个用户控件，我想使用 javascript 在其中执行一些操作。当该操作完成时，我想引发一个事件（再次在 javascript 中）由包含的 ASP.NET 页面（再次在 javascript 中）拾取。

我想要这样做的原因是因为我在页面上有多个用户控件，并且我需要在一个用户控件中执行的操作来实例化另一个用户控件中的操作而不进行回发。

有谁知道如何做到这一点？

非常感谢。

* * *

您好，感谢您的回复。我想做的是创建某种形式的封装。因此，如果 javascript 代码在一个用户控件中执行某些操作，那么该用户控件不应该知道其他地方的影响。它会在 javascript 中引发一个事件，该事件可以被 asp.net 页面呈现的 javascript 拾取，如果需要，它可以反过来调用另一个用户控件中的 javascript 方法。这里的想法也是消除任何回发的需要。

希望这能更好地解释它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-31T14:44:03.803

我认为实现您所描述的简单方法是忘记 JavaScript 事件，只需为用户控件提供“回调”函数。

我将实现它的方式是在用户控件上公开一个公共属性，该属性采用此 JavaScript“回调函数”的名称。然后，用户控件在完成其客户端工作后负责调用此函数。

因此，使用用户控件的页面必须实现这个 JavaScript“回调函数”，然后将属性中的名称提供给用户控件。

说得通？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T14:24:51.253

您可以简单地从您的用户控件呈现的 HTML 中运行所需的 javascript。

```
`<a href="javascript:doSomething();">Click Me</a>` 
```

`听起来你想在 JavaScript 中创建某种形式的控制器。当页面加载时，您的每个控件都会向控制器注册。然后，您的一个控件中的一个动作在控制器上运行一个函数，该函数对向其注册的控件执行某些操作。`

 `你的 JavaScript 可以很简单：

```
`var oControls = new Array();

doSomething = function() {
  for(var i=0;i<oControls.length;i++) {
    var oControl = document.getElementById(oControls[i]);
    oControl......
  }
}` 
```

`所以你需要在你的用户控件渲染方法中使用 ScriptManager 来注册你的控件。`

 ````
`ScriptManager.RegisterStartupScript(Me, Me.GetType(), "Startup", String.Format("oControls.push('{0}');", ClientID), True);` 
```

# `c# - OO 样式参数与类型参数`

 `> ID：403058
> 
> 赞同：3
> 
> 时间：2008-12-31T14:24:02.143
> 
> 标签：c#, oop, methods

假设你有这两种方法：

1号：

```
void AddPerson(Person person)
{
  // Validate person
  if(person.Name != null && IsValidDate(person.BirthDate)
    DB.AddPersonToDatabase(person);
} 
```

2号：

```
void AddPerson(string name, DateTime birthDate)
{
  Person p = new Person(name, birthDate);
  DB.AddPersonToDatabase(person);
} 
```

这两种方法中哪一种是最好的？我知道第一个在 OO 方面更正确，但我觉得第二个更具可读性，您不必确保对象有效，因为参数可以确保这一点。我只是不喜欢在将对象作为参数传递的任何地方验证对象。还有其他方法吗？

编辑：谢谢所有的答案。澄清一下，在构造函数和 IsValid 方法中进行验证当然是一种好方法，但在我的代码中，人的有效状态通常取决于上下文，并且可能因方法而异。这当然可能是糟糕设计的标志。

该代码只是描述问题的示例。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-31T14:28:41.993

第一个不必验证 person.Name 和 person.BirthDate - 它们应该由`Person`构造函数自动验证。换句话说，如果你传递了一个 Person，你应该知道它是有效的。

另一方面，您必须检查这`person`不是空引用。

有时值得拥有像第二个版本这样的便利方法，以避免经常显式调用构造函数。它通常应该只调用`Person`构造函数，然后将工作委托给第一个表单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T14:27:38.097

第一个的优点是允许您在不破坏现有代码的情况下更改 Person 定义，只需要重新编译。您可能认为第二个更具可读性，但第一个更易于维护，这是您的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-31T14:31:23.563

另一种选择是：

```
void AddPerson(Person person)
{  // Validate person  
   if(person.IsValid)
   {
     DB.AddPersonToDatabase(person);
   }
} 
```

假设 Person 在构造时不验证自己。如果对象在瞬态时可以是无效状态，则在某些情况下这是可行的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T14:28:42.977

我更喜欢前者（传递对象），因为它减少了 API 与对象的耦合。如果您更改`Person`对象，例如添加一个`Nickname`以前不需要的新属性，那么在第一种情况下您不需要更改公共 API，而在第二种情况下您需要更改方法或添加一个新的过载。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T14:35:41.933

我同意这完全取决于上下文，对此没有绝对的规则。在我看来，有这样的方法是无稽之谈：

```
person.SetBirthDate(Person person)
person.ResetPassword(Person person) 
```

但在这种情况下，我确实更喜欢前者，因为正如 Greg Beech 所说，该方法不需要（必须）了解有关域对象的任何信息。

顺便说一句，考虑重载（DRY - 不要重复自己）：

```
void AddPerson(Person person)
{
  if(person.Name != null && IsValidDate(person.BirthDate)
    DB.AddPersonToDatabase(person);
}

void AddPerson(string name, DateTime birthDate)
{
  Person p = new Person(name, birthDate);
  this.AddPerson(p);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-31T15:50:29.363

绝对更好地传递一个 Person 对象，而不是一堆原始类型作为参数。比较以下两种方法

```
 public static void Withdrawal(Account account, decimal amount)
{
    DB.UpdateBalance(account.AccountNumber, amount);
}

public static void Withdraw(int accountNumber, decimal amount)
{
    DB.UpdateBalance(accountNumber, amount);
} 
```

这两种方法看起来几乎相同，但第二种方法不安全。一个 int 可以来自任何地方，所以如果你这样写，你会被搞砸的：

```
私人无效CloseTransaction（Transaction tran）
{
    BankAccounts.Withdrawal(tran.Account.RoutingNumber, tran.Amount);
        // 逻辑错误：本意是传递 Account.AccountNumber 而不是 Account.RoutingNumber
}

```

这是最糟糕的错误，因为它不会引发编译错误或运行时异常。如果你写得足够好，你可能会在你的自动化测试中发现这个错误，但是这个错误很容易被忽略，并且可能会隐藏几个月而不被发现。

我在一家编写银行软件的公司工作，我们确实在生产中遇到了这种类型的错误。它只发生在特定类型的金库转账期间，并且只有在我们的一家银行发现他们的 GL 余额每次运行月末流程时都会减少 100 美元时才被发现。银行怀疑员工盗窃数月之久，但只有通过仔细的代码审查，才有人将问题追溯到我们软件中的错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T14:29:00.950

大多数时候我会选择第一个。

第二个会破坏 Person 的每次更改的签名

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-31T14:29:23.133

这取决于上下文。

如果您的所有调用方法都处理 Person 对象，那么第一个是正确的解决方案。

但是，如果您的一些调用方法处理姓名和出生日期，而一些处理 Person 对象，那么第二个示例是正确的解决方案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-31T14:30:30.290

我只会为两者创建重载。特别是考虑到它们可以自动创建。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-31T14:37:02.117

我假设这些方法不是`Person`类型的一部分。`Person`考虑到这一点，我觉得他们俩都对另一种类型 ( ) imo了解得太多了。第一个版本不必验证有效人员实例的创建。如果这是调用者的责任，那么每个调用者都必须这样做。那是脆的。

第二个版本对另一个类型有很强的依赖性，因为它创建了这个类型的一个实例。

我肯定更喜欢第一个版本，但我会从那段代码中移走验证部分。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-31T14:40:44.590

我认为乔恩几乎做到了。`Person`应该有责任确保在其构造函数中创建一个有效的 Person。

关于创建或不创建`Person`对象的责任（无论是 AddPerson 方法还是它的调用者），请阅读

[http://en.wikipedia.org/wiki/GRASP_%28Object_Oriented_Design%29#Creator](http://en.wikipedia.org/wiki/GRASP_%28Object_Oriented_Design%29#Creator)

这是关于 OOP 中的责任问题。在您的特定情况下，如果 AddPerson 将调用包装到数据库接口，我不太确定。这取决于该 Person 对象在该上下文之外用于什么。如果它只是为了包含要添加到数据库的数据，在 AddPerson 方法中创建它可能是一个好主意，因为它使您的类的用户不必了解 Person 类。.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-31T15:05:50.720

如果使用对象，则更好的封装；这就是他们的目的。我认为人们在过度使用原语时会遇到麻烦。

应该不可能创建一个无效的人。构造函数应检查有效参数并抛出 IllegalArgumentException 或如果它们无效则使断言失败。这就是契约式编程的意义所在。

# javascript - XSLT 能否与 AJAX 一起工作？

> ID：403067
> 
> 赞同：7
> 
> 时间：2008-12-31T14:26:17.867
> 
> 标签：javascript, xml, ajax, xslt

这可能是一个愚蠢或明显的问题，但我们的整个网站是使用 XSLT 呈现的，以转换从数据库查询和其他部分动态创建的 xml。我开始将大量 ajax 推入网站以使其更具动态性，是否有关于 xslt 和 ajax 的好教程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T15:31:33.070

您是在服务器上还是在浏览器中使用 XSLT？

现代浏览器现在支持从浏览器内部进行 XML 转换，一种方法是使用 AJAX 来获取 XML 及其样式表。然后，您可以将样式表的处理卸载到客户端机器上。一定要缓存样式表，甚至可以发送压缩的 XML。

如果您已经知道如何进行 AJAX，那么编码应该是直截了当的。5 年前我曾在这样的系统上工作过，这是一种可行的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T15:24:28.917

我绝对同意之前的评论者的观点，他一想到 XSLT 会为您承担繁重的工作，就会不寒而栗。这不会是所有的表现。不要误会我的意思，我非常喜欢 XSL，但是......

没有那么多的教程，但 Mulberry Tech 的人员（不知道他们做什么，也不知道他们是谁）维护了一系列 XSLT 快速参考指南（以及许多其他指南），我认为这些指南非常宝贵。

[http://www.mulberrytech.com/quickref/](http://www.mulberrytech.com/quickref/)

希望这可以帮助...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-04-29T20:16:01.157

我认为大多数答案都缺少OP的要求。我认为 OP 是在询问是否有办法使用 AJAX 获取 XSLT 生成的 HTML。

我在 Umbraco 上采用这种方法。

1.  创建生成 HTML 的 XSLT 宏

2.  将 XSLT 宏放在空白页中

3.  使用 AJAX 调用页面

4.  替换现有的 HTML 内容

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T20:24:02.200

我在客户端和服务器端都广泛使用了这种技术。我的经验是它在大多数情况下都能充分发挥作用（但后来我将它的服务器端性能与 ASP 页面中的 VBScript 进行了对比）。

在性能成为问题的情况下，尽可能将 XML 解析和 XSLT 编译排除在操作之外是非常重要的。如果您有一个使用 XSLT 动态呈现页面中的元素的客户端方法，请确保它不会在每次调用时都加载和编译 XSLT。如果您使用服务器端 XSLT，请将 XSLT 处理器对象缓存在您的服务器环境支持的任何集合中。

通过使用 Javascript 和 JSON 而不是 XML 和 XSLT，您可以获得明显更好的客户端性能。我还没有对它进行基准测试，但我敢打赌，最大的性能提升来自解析 JSON 比解析 XML 占用更少的 CPU 资源这一事实。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T15:04:29.723

> 我们的整个网站是使用 XSLT 来转换 xml 呈现的

这个想法让我不寒而栗。我曾在两个使用 XSLT 来动态生成频繁访问的页面的网站上工作过，在这两种情况下，每次访问都需要更多的开发工作和 CPU 时间。

不管怎样，[www.w3schools.com](http://www.w3schools.com)有很多关于许多网络技术的优秀教程。他们甚至有测试。

如果您想在保持对多个 Web 浏览器的支持的同时进行 AJAX，我强烈建议您查看：[JQuery](http://jquery.com/)、[Prototype](http://www.prototypejs.org/)和[Dojo](http://dojotoolkit.org/)

我认为 JQuery 是最好的，但我会把这个决定留给你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T20:07:21.183

尝试使用[tox](http://tox.sourceforge.net/)作为示例。没有教程，但如果您看一下提供的示例，它的注释很好并且包括 AJAX。

# c# - 表达式树的实际使用

> ID：403088
> 
> 赞同：70
> 
> 时间：2008-12-31T14:36:13.743
> 
> 标签：c#, expression-trees

表达式树是一个不错的功能，但它的实际用途是什么？它们可以用于某种代码生成或元编程等吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-12-31T15:32:46.343

正如 Jon 所说，我使用它们为.NET 3.5提供[通用运算符。](http://www.yoda.arachsys.com/csharp/miscutil/usage/genericoperators.html)我还使用它们（再次在 MiscUtil 中）提供对非默认构造函数的快速访问（您不能`Delegate.CreateDelegate`与构造函数一起使用，但`Expression`工作正常）。

手动创建的表达式树的其他用途：

*   [对象克隆](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/d9722a51b04300a/0edae91abc1c0f1a#0edae91abc1c0f1a)
*   [动态 LINQ 排序](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/9ca28e3f0205bb87/7d931ec0e2356d21#7d931ec0e2356d21)
*   [作为编译器](http://www.infoq.com/articles/expression-compiler)

但实际上，Expression 是一种非常通用的编写任何动态代码的方式。比 CodeDOM简单得多`Reflection.Emit`，而且对我来说，比 CodeDOM 更容易理解。在 .NET 4.0 中，您可以使用[更多选项](http://marcgravell.blogspot.com/2008/11/future-expressions.html)。`Expression` [我在我的博客上](http://marcgravell.blogspot.com/2008/10/express-yourself.html)展示了编写代码的基础知识。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-31T14:48:48.023

Marc Gravell 在[MiscUtil](http://pobox.com/~skeet/csharp/miscutil)中使用它们实现了[泛型运算符](http://www.yoda.arachsys.com/csharp/genericoperators.html)，效果非常好。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-12-09T11:57:33.743

我刚刚使用我想与你们分享的表达式树创建了一个通用过滤器函数......

**开始**

```
var allFiltered= Filter(AllCustomer, "Name", "Moumit");

public static List<T> Filter<T>(this List<T> Filterable, string PropertyName, object ParameterValue)
{
    ConstantExpression c = Expression.Constant(ParameterValue);
    ParameterExpression p = Expression.Parameter(typeof(T), "xx");
    MemberExpression m = Expression.PropertyOrField(p, PropertyName);
    var Lambda = Expression.Lambda<Func<T, Boolean>>(Expression.Equal(c, m), new[] { p });
    Func<T, Boolean> func = Lambda.Compile();
    return Filterable.Where(func).ToList();
} 
```

**多一个**

```
string singlePropertyName=GetPropertyName((Property.Customer p) => p.Name);

public static string GetPropertyName<T, U>(Expression<Func<T, U>> expression)
{
        MemberExpression body = expression.Body as MemberExpression;
        // if expression is not a member expression
        if (body == null)
        {
            UnaryExpression ubody = (UnaryExpression)expression.Body;
            body = ubody.Operand as MemberExpression;
        }
        return string.Join(".", body.ToString().Split('.').Skip(1));
} 
```

**使其更具扩展性**

```
string multiCommaSeparatedPropertyNames=GetMultiplePropertyName<Property.Customer>(c => c.CustomerId, c => c.AuthorizationStatus)

public static string GetMultiplePropertyName<T>(params Expression<Func<T, object>>[] expressions)
{
        string[] propertyNames = new string[expressions.Count()];
        for (int i = 0; i < propertyNames.Length; i++)
        {
            propertyNames[i] = GetPropertyName(expressions[i]);
        }

        return propertyNames.Join();
} 
```

我知道它也可以使用反射来完成，但是这个速度非常快，或者，我可以说，相当于第一次编译后的 lambda。第一次迭代平均只需要 10 毫秒。这就是表达式树的魔法。简单而奇妙（我认为）！

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-12-31T15:38:08.437

我使用它们来创建动态查询，无论是用于排序还是过滤数据。举个例子：

```
IQueryable<Data.Task> query = ctx.DataContext.Tasks;

if (criteria.ProjectId != Guid.Empty)
      query = query.Where(row => row.ProjectId == criteria.ProjectId);

if (criteria.Status != TaskStatus.NotSet)
      query = query.Where(row => row.Status == (int)criteria.Status);

if (criteria.DueDate.DateFrom != DateTime.MinValue)
      query = query.Where(row => row.DueDate >= criteria.DueDate.DateFrom);

if (criteria.DueDate.DateTo != DateTime.MaxValue)
     query = query.Where(row => row.DueDate <= criteria.DueDate.DateTo);

if (criteria.OpenDate.DateFrom != DateTime.MinValue)
     query = query.Where(row => row.OpenDate >= criteria.OpenDate.DateFrom);

var data = query.Select(row => TaskInfo.FetchTaskInfo(row)); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-12-31T14:49:41.453

LINQ 提供程序的实现主要是通过处理表达式树来完成的。我还使用它们从我的代码中删除文字字符串：

*   [单轨电车](http://bugsquash.blogspot.com/2008/07/in-same-spirit-as-my-previous-post-i.html)
*   [休眠](http://bugsquash.blogspot.com/2008/03/strongly-typed-nhibernate-criteria-with.html)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-31T14:47:17.230

您可以使用它们为 Google、Flickr 或 Amazon 等网站、您自己的网站或其他数据提供商构建您自己的 linq 提供商。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-31T16:06:08.677

Originally by [Jomo Fisher](http://blogs.msdn.com/jomo_fisher/archive/2007/03/28/fast-switching-with-linq.aspx), [Gustavo Guerra](http://blog.codebeside.org/archive/2008/08/28/staticstringdictionary-fast-switching-with-linq-revisited.aspx) published a revised version of the [static string dictionary](http://blog.codebeside.org/blog/2008/08/28/staticstringdictionary-fast-switching-with-linq-revisited/).

Where through Expression trees, a dynamic expression that provides a really (read: ridiculously) Dictionary.

The implementation creates a dynamic decision tree that select the corrent value according to the length of the input string, then by the first letter, then the second letter and so on.

This ultimately runs much faster than the equivalent Dictionary.

# ios - Objective C NSString* 属性保留计数奇数

> ID：403112
> 
> 赞同：5
> 
> 时间：2008-12-31T14:45:57.327
> 
> 标签：ios, objective-c, xcode, cocoa, cocoa-touch

我有以下示例类：

测试.h：

```
@interface Test : UIButton {
    NSString *value;
}
- (id)initWithValue:(NSString *)newValue;
@property(copy) NSString *value; 
```

测试.m：

```
@implementation Test
@synthesize value;
- (id)initWithValue:(NSString *)newValue {
    [super init];   
    NSLog(@"before nil value has retain count of %d", [value retainCount]);
    value = nil;
    NSLog(@"on nil value has retain count of %d", [value retainCount]);
    value = newValue;
    NSLog(@"after init value has retain count of %d", [value retainCount]);
    return self;
} 
```

产生以下输出：

```
2008-12-31 09:31:41.755 Concentration[18604:20b] before nil value has retain count of 0
2008-12-31 09:31:41.756 Concentration[18604:20b] on nil value has retain count of 0
2008-12-31 09:31:41.757 Concentration[18604:20b] after init value has retain count of 2147483647 
```

我这样称呼它：

```
Test *test = [[Test alloc] initWithValue:@"some text"]; 
```

value 不应该保留计数为 1 吗？我错过了什么？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-01T01:59:18.467

不要看保留计数。它们没有用，只会误导你——你不能确定没有其他东西保留了一个对象，你从某个地方得到的一个对象没有被共享。

相反，专注于**对象所有权**并严格遵守[Cocoa 内存管理规则](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/Tasks/MemoryManagementRules.html)。这样，无论 Cocoa 在幕后为您做什么优化，您的内存管理都是正确的。（例如，`-copy`仅`-retain`针对不可变对象实现。）

此外，了解对象的**属性**与对象中的**实例变量**之间的区别也很**重要**。在您的问题代码中，您正在为实例变量赋值。该实例变量就是这样：一个变量。分配给它的行为与任何其他变量分配一样。要使用该属性，您必须使用点语法或括号语法来实际调用该属性的 setter 方法：

 ****```
self.value = newValue;     // this is exactly equivalent to the next line
[self setValue:newValue];  // this is exactly equivalent to the previous line 
```

为点语法和括号语法生成的代码是相同的，都不会直接访问实例变量。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-31T15:09:16.577

您正在传递一个文字字符串。编译器可能会将其分配在静态内存中并将保留计数设置为最大可能值。

尝试使用动态分配的字符串，看看会发生什么。

```
NSString* string = [[NSString alloc] initWithString: @"some text"];
Test* test = [[Test alloc] initWithValue: string]; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-31T16:02:25.863

你有一个不可变字符串的引用。赋值不需要复制值（字符串数据），因为它是不可变的。如果您执行可变操作，例如 value = [newValue uppercaseString] 那么它应该将位复制到 value 中，并且 value 的保留计数增加。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-31T15:09:51.240

你传入一个字符串常量，它不能真正被释放。我觉得2147483647大概是UINT_MAX，基本就是说对象不能被释放。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-31T15:32:59.680

我想你想这样做：

```
self.value = newValue; 
```

这将调用属性设置器并导致复制发生。“value = newValue”只是将指针值分配给实例变量。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-01T02:53:04.973

您不应该关注保留计数，只需遵循 Cocoa 内存管理规则即可。[http://iamleeg.blogspot.com/2008/12/cocoa-memory-management.html](http://iamleeg.blogspot.com/2008/12/cocoa-memory-management.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T15:44:07.460

嗯..我们越来越近了。

看来 newValue 的保留计数也是 2147483647。

我尝试使用相同的保留计数结果动态分配字符串。

我在这里找到了一篇有用的文章：http: [//www.cocoadev.com/index.pl?NSString](http://www.cocoadev.com/index.pl?NSString)

自由贸易协定：

*@"" 返回的 NSString 是否需要释放，还是自动释放？两者都不。@""-strings 属于 NSConstantString? 类，因此就像 lisp 中的原子；他们闲逛。也就是说，如果您在代码中的两个不同位置使用 @"cow"，它们将引用同一个对象。我认为 -release 或 -autorelease 对它们中的任何一个都没有任何作用。*

如果我在属性上有“复制”，它不应该将目标内存的内容复制到保留计数为 1 的新内存中吗？在这种情况下，复制属性似乎什么都不做？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-12T14:24:33.860

```
#import <Foundation/Foundation.h>

int main (int argc, const char * argv[]) {
    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

    char *cstr = "this is a c string";

    NSString *str = [[NSString alloc] initWithUTF8String:cstr];
    NSLog(@"rc1: %d", [str retainCount]);

    [pool drain];
    return 0;
} 
```

如果您运行上述代码，它将显示保留计数为 1

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-12T14:41:07.530

在 Cocoa 中，当您在同一区域内请求副本时，许多不可变对象将简单地保留自己。如果保证对象不会改变（即它的不可变性），那么精确复制是多余的。

在 Objective-C 中，常量字符串类与 Cocoa 的类是分开的`NSString`，尽管它可能是`NSString`（我不太确定）的子类。这个常量字符串类可能会覆盖`NSObject`的方法，比如`retain`,`release`并且`dealloc`它们什么都不做，也可能会覆盖，`retainCount`所以它总是返回相同的数字，`UINT_MAX`或者如此。这是因为在静态内存中创建了一个 Objective-C 常量字符串。它必须具有 Cocoa 对象的整体一般行为（使用 Cocoa 时），以便可以将其添加到数组中，用作字典的键等，除了内存管理方面，因为它的分配方式不同。

免责声明：我实际上不知道我在说什么。

# ms-office - 我是否必须强制我的客户安装 Office Xxxx Primary Interop Assemblies？

> ID：403114
> 
> 赞同：5
> 
> 时间：2008-12-31T14:46:52.817
> 
> 标签：ms-office

似乎如果您尝试引用 Office COM 对象（就像您在其他开发环境中所做的那样），Visual Studio 会出错 -[它只是无法工作](http://msdn.microsoft.com/en-us/library/15s06t57(VS.80).aspx)。

所以你必须使用微软手工转换并提供[下载](http://www.microsoft.com/downloads/details.aspx?familyid=59DAEBAA-BED4-4282-A28C-B864D8BFA513&displaylang=en)、[下载](http://www.microsoft.com/downloads/details.aspx?FamilyId=3C9A983A-AC14-4125-8BA0-D36D67E0F4AD&displaylang=en)、[下载](http://www.microsoft.com/downloads/details.aspx?FamilyID=c41bd61e-3060-4f71-a6b4-01feba508e52&displaylang=en)的转换类型库。

现在看来，为了让我的应用程序运行，它需要包含在程序集中的 Office 互操作代码。

现在我不想强迫我的客户安装 Office 2007 主互操作程序集、Office 2003 主互操作程序集或 Office XP 主互操作程序集。我想要一个 xcopy 部署。

如果我设法获得 Microsoft 的互操作程序集副本，我可以将它们复制到 Bin/Debug 和 Bin/Release 文件夹吗？

如果我包含 Office 2007 互操作程序集，如果客户安装了 Office 95，它是否可以工作，或者我是否必须包含 Microsoft 曾经发布的所有版本的 Office Interop dll？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T15:14:59.360

这是一个常见的问题，答案相当复杂。MSFT 的 Mary Lee 是一个很好的资源，可以提供有关这方面的信息：

[http://blogs.msdn.com/vsto/archive/tags/Deployment/default.aspx](http://blogs.msdn.com/vsto/archive/tags/Deployment/default.aspx)

使用 ClickOnce 进行部署是最接近基于 VSTO 构建的任何应用程序的 XCopy 安装。

另外，请查看此帖子：

[http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/1666d2b0-a4d0-41e8-ad86-5eab3542de1e/](http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/1666d2b0-a4d0-41e8-ad86-5eab3542de1e/)

最后，Misha 有一个很棒的博客：

[http://blogs.msdn.com/mshneer/archive/2006/01/05/deployment-articles.aspx](http://blogs.msdn.com/mshneer/archive/2006/01/05/deployment-articles.aspx)

PIA 特定于您所针对的 Office 版本，因此 2003 PIA 是定位 2003 所必需的，而 2007 PIA 是 2007 所必需的。通过托管代码自动化 Office 95 是我以前没有做过的事情，但我可以想象你直接引用类型库，因此会为您生成 RCW，与 PIA 无关。

高温高压

科尔比非洲 (MSFT)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T17:08:51.810

根据我自己的经验：

如果您想以 Office 2003 及更高版本为目标，那么您将使用 Office 2003 PIA - 并将自己限制为 Office 2003 API。该代码将在 Office 2003*或更高版本*上运行。您仍然可以使用反射调用 Office 2007 函数，但这并不令人愉快。

我想如果您的基准版本是 Office 2000，情况大致相同——尽管我没有尝试过，而且我相信 Microsoft 自己提供 PIA 的最早版本是 Office 2002 (XP)。

您可以为 2000 创建自己的 Interop 程序集，我没有理由相信您不能在 95 年这样做，尽管您是我见过的第一个要求 95 支持的人！不用说，如果您创建自己的 Interop 程序集，则需要将它们与您的应用程序一起部署。

在任何情况下，您都希望使用可以使用的*最高*Office 版本作为基准，这样您就可以支持尽可能多的功能，而无需借助反射。*您应该在仅*安装了该版本 Office的机器上开发代码。

在我的情况下，我为 Office 2003 开发并且知道我的用户也有 2003。所以，我要求他们确保他们启用了“.NET 可编程性支持”功能（您可以通过添加/删除通过 Office 2003 设置来完成程序，如果您选择更改选项）。该选项基本上将 PIA 安装到 GAC。对于那些无法做到这一点的用户，我的安装程序会检测到缺少 PIA 并在安装我的应用程序之前安装它们（就像 .NET 框架一样）。

XCOPY 部署？是的，我也想要那个——但算了吧。一方面，如果您的加载项将在“高”安全模式下工作，那么您将需要一个代码签名的 COM“垫片”来位于您的代码和 Office 之间，并且需要注册。我相信 VSTO 提供了自己的 shim，如果您选择走这条路（我没有，因为我需要能够从头开始“驱动”Office，而不是依赖用户来启动应用程序）。

部署 - 以及处理安装和安全问题 - 是使用 .NET 进行 Office 插件开发中最困难的部分之一，当您认为自己已经完成时，它会在最后出现，这是一个真正的挑战。

我的**强烈**建议是省去几天和几周的麻烦，看看[Add-in Express](http://www.add-in-express.com/add-in-net/)。我自己最近才遇到这个问题，从那以后一直在踢自己，因为它可以为我节省很多时间。它有几个我认为对你有用的好处：

1.  它允许您创建针对 Office 2000 到 Office 2007（抱歉，不是 '95）的单个加载项，无论您的开发 PC 上碰巧有什么版本。
2.  它为您创建了一个安装程序（甚至可以在 Vista 上运行！），这本身就是物有所值的。
3.  它带有自己的 COM shim，并且集成到您无需担心的程度。
4.  它将允许您拥有一个加载项，该加载项在 2003 及之前的 Office 版本中具有菜单/工具栏界面，但在 2007 中具有功能区界面。

请注意，我与 Add-in Express 没有任何关系（除了作为最近的客户），但同样我还没有将我的项目转换为使用它。我所做的初步测试让我相信它非常好——而且*绝对*是中小型项目的必经之路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T16:08:01.917

如果我设法获得 Microsoft 的互操作程序集副本，我可以将它们复制到 Bin/Debug 和 Bin/Release 文件夹吗？

它对我有用。当我编译程序时，我让它引用 bin 中的互操作 (PIA) dll，然后以这种方式将其部署给客户。

如果我包含 Office 2007 互操作程序集，如果客户安装了 Office 95，它会工作吗？

不，您必须拥有您所针对的 Word 版本的互操作 dll。我想可能可以编写您的代码，以便它检查该机器上运行的单词版本并在运行时选择正确的互操作，但您需要将它们全部包含在内。

# c# - .NET：如果我的 .NET 使 Office 自动化，客户是否必须安装 Office？

> ID：403118
> 
> 赞同：2
> 
> 时间：2008-12-31T14:48:25.013
> 
> 标签：c#, com, ms-office

如果我创建一个程序，它在一个小的偏僻区域，使用 Excel 自动化：

需要 Excel 时应用程序会失败吗

还是应用程序无法启动？

* * *

## 更新

让我问同样的问题，但以更冗长的方式：

该应用程序是否可以使用

*   > 99.9% 的用户从不使用需要 Excel 的功能

*   0% 的用户，因为没有安装 Excel。

* * *

*让我用另一种方式问同样的问题：*

引用 COM 互操作 dll 的应用程序是否会无法初始化？

* * *

*让我用另一种方式问同样的问题：*

不使用 Excel 但引用 COM 互操作 DLL 的应用程序会无法启动吗？

* * *

*让我用另一种方式问同样的问题：*

如果未安装 Excel，如果该应用程序依赖于 Office Primary Interop dll，那么不使用 Excel 的应用程序是否可以使用？

* * *

*让我用另一种方式问同样的问题：*

如果我的应用程序不使用 Excel，用户是否必须安装 Excel？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T15:47:16.970

代码将正确执行，直到它尝试调用自动化库，那时它将生成异常。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-31T16:06:29.083

我有一个使用 Excel 自动化的应用程序，我可以肯定地说它会在运行时失败，而不是在加载时失败。事实上，我们会检查它是否已安装，如果找到它，则仅显示“在 Excel 中显示数据”按钮（但 PIA 已部署到所有安装中）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-31T14:50:41.997

我认为它会在运行时失败，因为互操作程序集应该能够在没有客户端系统上可用的 COM 组件的情况下加载。

更新：运行时应该意味着您需要它！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-31T14:50:57.783

如果您使 Office 自动化...您必须拥有 Office！

话虽如此，但如果您将问题扭曲为：我可以在客户端没有 Excel 的情况下创建 Excel 电子表格吗？

有许多第三方控件可以做到这一点；您可以直接写入 MS SpreadML XML 规范（[http://msdn.microsoft.com/en-us/library/aa140066(office.10).aspx](http://msdn.microsoft.com/en-us/library/aa140066(office.10).aspx)；或使用第三方库（如[http:// www.carlosag.net/Tools/ExcelXmlWriter/](http://www.carlosag.net/Tools/ExcelXmlWriter/) )。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T14:52:27.563

在 Win32 中使用 COM，它会在需要时失败。

# c# - 移动到另一个项目时无法识别类型化数据集

> ID：403122
> 
> 赞同：2
> 
> 时间：2008-12-31T14:49:38.317
> 
> 标签：c#, asp.net, ado.net, dataset, strongly-typed-dataset

我将一个类型化的数据集从一个项目移动到一个 ASP Web 应用程序项目。我将键入的数据集放入现有目录之一，就像它在上一个站点的 App_Code 目录中一样，但在此项目中看不到创建该 asp.net 文件夹的选项。

现在，当我尝试实例化类型化数据集时，编译器说“找不到类型或命名空间名称”（您是否缺少 using 指令或程序集引用？）。

想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-31T15:06:57.627

您可能需要重新生成 DataSet。移动 .xsd 时，您只移动了 DataSet 的 xml 布局。

删除任何生成的代码文件，打开 xsd，移动一些东西，然后保存。保存操作调用生成器。或者您可以右键单击 .xsd 文件并直接调用生成器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T21:11:51.307

我将我的网站移至 Web 应用程序项目并遇到了同样的问题。我采用了第一个答案中提到的方法，最终能够编译项目。我想在第一个答案中添加更多细节。

明确地说：我首先删除了与 xsd 文件关联的所有文件，除了 xsd 文件本身（xss、xsc、cs、...）。然后我右键单击 xsd 文件，选择“查看设计器”，然后选择“查看代码”，然后选择“运行自定义工具”。重新生成所有文件并编译参考。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-24T19:21:29.520

确保编译器知道它是一个数据集，而不仅仅是一个 Xml 文件。在解决方案资源管理器中选择 DataSet.xsd，然后在项目窗口中确保将“自定义工具”设置为 MSDataSetGenerator。

之后，不要猜测，而是在 Reflector 中打开 dll 文件并查找您的 DataSet 类。确保它在您认为的名称空间中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-10T22:35:36.557

在 Visual Studio 2015 中，我所做的是

1.  在我右键单击添加的数据集以包含在项目中之前，我删除了 .xss 和 .xsc 文件并保留了其余文件。

2.  然后我右键单击 .xsd 文件并将其包含在项目中并解决了问题。

希望我解决了某人的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T14:56:44.653

您是否在新代码中包含了“使用命名空间”语句？

# sql-server - 如何捕获 SQL 服务器破解者？

> ID：403135
> 
> 赞同：0
> 
> 时间：2008-12-31T14:53:20.433
> 
> 标签：sql-server, tsql

快速简介：

我团队中的人一直在研究生产数据库（sql server 2005）。我们添加了各种东西，例如约束、添加的触发器等。

现在我们发现有人或某事在不同时间回滚了我们的更改。问题是我们都共享一个共同的管理员登录。（愚蠢，是的，我知道，我们正在解决这个问题）。它引起了很多挫败感，在这一点上，我们只想找出谁。

你将如何追查有罪的一方？

注意：我不是在寻找解决此问题的方法，这已经完成。我正在寻找一种方法来追查罪魁祸首。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-31T14:58:24.383

远离生产数据库。创建您的脚本并将它们通过电子邮件发送给负责的 DBA（如果您没有，请获取）。可以访问生产数据库的开发人员是灾难的根源——我没有它，也不想拥有它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-31T15:05:33.370

跟踪您的问题显然是一种症状，而不是原因：因为它是一个 SQL Server 2005 数据库，所以应该有一个“默认”跟踪，开箱即用。它非常轻量级，但确实包括一些对象的创建和删除。您可以`sys.traces`使用以下查询从视图中查看它：

```
SELECT *
FROM sys.traces
WHERE id = 1 
```

它仅在几 MB 后翻转，因此它的有用性将取决于服务器上的活动量。

据推测，真正的原因是您的更改没有编写脚本和版本控制。

同意其他发帖人的观点，他们提到对生产数据库的所有更改都只能由管理员完成，而不是由单个开发人员完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-31T15:01:54.893

我假设您有一个具有变更数据捕获功能的审计日志。这将跟踪每次更改的人员、内容和时间。

回滚是间歇性的还是一致的？您是否有机会关闭自动提交并忘记提交您的更改？

不可能有那么多人有足够的权限来做这样的事情。找出谁可以做到并询问。比您可以实施的任何技术都要好。

黑客？里面应该有人。如果防火墙外的人可以访问该数据库，您需要与您的网络人员交谈。

尝试将监视器添加到该 URL 和端口，以查看通过了哪些请求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-31T15:03:44.873

您需要注意的是，如果有人恶意更改数据库，并且他们具有管理员访问权限，您必须假设他们足够聪明，可以掩盖他们的踪迹。此时，您可以阻止进一步的破坏，但如果攻击者有任何好处，您要么责怪错误的人，因为日志文件将被更改，要么所有指向正确人的证据都将消失。

最好的方法是拥有它，这样没有人可以直接管理员访问生产数据库。我们设置了一个系统，默认情况下没有帐户具有管理权限，每个人都有自己的帐户。没有人可以使用 SA 帐户。

必须有人授予该帐户访问权限，并在被授予 24 小时后自动将其删除。理想情况下，授予访问权限的同一个人不应该是获得对数据库的管理访问权限的人。这样一来，必须始终让两个人参与才能对系统进行更改。

理想情况下，两个人应该始终参与做出改变。这样第二个人就可以验证第一个人做了什么。（工作几个小时后晚上10点很容易出错）。

人们会通过说有时他们“需要”能够做出快速改变来反驳这一点。在大多数地方，情况并非如此。让第二个人参与并解释情况可能需要额外的 10 分钟。清理某人窃取/更改公司数据的声誉需要数年时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T14:57:52.933

通过添加您应该拥有的用户级安全性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-31T14:59:03.993

您能否将回滚时间与团队中人员的行踪进行交叉引用？

或者 - 只是问每个人？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-31T15:11:19.380

SQL Server 2005 添加了 DDL 和 DML 触发器，因此您可以跟踪谁在修改数据以及数据结构。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-31T15:43:35.697

如果您正在修复它——并且通过“修复它”我的意思是锁定生产数据库并遵循这里提到的一些其他做法——那么不要担心找到罪魁祸首。无论如何，这可能是偶然的，当您将其锁定时，有人会开始想知道为什么某些东西不起作用。

追踪这样做的用户不会解决任何问题。如果是恶意的，他们会撒谎说这是偶然的。

根本原因是数据库的安全性，因此故障组是允许数据库如此易受攻击的组。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-31T15:03:41.597

问每个人没有用，人们撒谎和/或不知道他们在搞砸这件事。我们假设它是恶意的，但希望不是。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-31T15:10:56.573

哇，那你有一个真正的问题。如果你不能相信自己的人...

是时候关闭除一个之外的所有 ID。确保那个人知道他们在做什么并且不撒谎。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-31T15:26:06.527

除了你已经收到的回复之外，我的投票是没有人；您只是误会了如何使用该系统。

现在，不要误会我的意思，我在这里不是在谈论无能。不过，我的意思是，很可能有一些脚本会定期运行，有人正确地提到*有时*自动提交可能是打开还是关闭，有人会被愚弄。

我也相信你在生产环境中混合任何开发工作是在自找麻烦。磁盘空间很便宜——这些天一 TB 不到 300 美元！在大多数情况下，您不需要出色的性能来进行开发工作......

# css - 突出显示活动选项卡 - CSS

> ID：403138
> 
> 赞同：5
> 
> 时间：2008-12-31T14:55:16.903
> 
> 标签：css, navigation

我有一个使用 CSS 的小型选项卡式导航设置。将鼠标悬停在选项卡上时，颜色会发生变化，很棒。但是，当我单击一个选项卡并导航到相应的页面时，我希望该选项卡（活动选项卡？）保持突出显示，指示当前页面。

我目前正在通过使用一个类（.currenttab）然后在每个 HTML 文件中使用这个类来做到这一点。我没有使用：

```
active 
```

有没有办法让我使用活动，而不是在每个单独的 HTML 文件中使用一个类，或者我做的是否正确？

先感谢您。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-31T15:06:00.860

你在做什么是正确的。: [active](http://www.w3.org/TR/CSS2/selector.html#dynamic-pseudo-classes)伪选择器意味着别的东西——激活控件的事件（即，用户按下鼠标按钮和释放鼠标按钮之间的时间）。

使用类来表示选定的项目是要走的路。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T15:09:02.070

这远非理想，但如果你给每个页面和每个选项卡一个 id，你可以在 css 而不是 html 中定义突出显示。我在查找活动属性时遇到了完整的解释：

[使用 CSS 突出显示当前页面](http://www.hicksdesign.co.uk/journal/highlighting-current-page-with-css)

[我用这种技术设计的网站](http://southelginmartialarts.com/)（页面，而不是标签）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T15:11:18.400

这里有一些更多的例子[Brainjar 演示](http://www.brainjar.com/css/tabs/demo.html)
更多来自[Brainjar](http://www.brainjar.com/css/tabs/)

# ruby-on-rails - 未定义的方法'cache_sweeper'

> ID：403143
> 
> 赞同：1
> 
> 时间：2008-12-31T14:56:42.017
> 
> 标签：ruby-on-rails, caching

我正在尝试在我的网站上设置一些缓存，但无法让缓存清扫器正常工作。我关注了[Railscast](http://railscasts.com/episodes/89)，但是当我尝试使用模型加载页面时，出现错误。这是我到目前为止所做的：

1.) 添加 app/sweepers 目录并在其中放置一个基本的清扫器：

```
class TeamMemberSweeper < ActionController::Caching::Sweeper
  observe TeamMember

  def after_create(team_member)
    expire_nav_menus
  end

  def after_destroy(team_member)
    expire_nav_menus
  end

  private

  def expire_nav_menus(athlete_id)
    expire_fragment(...)
  end
end 
```

2.) 将以下行添加到 TeamMember 模型中：

```
cache_sweeper :team_member_sweeper, :only => [:create, :destroy] 
```

3.) 将以下行添加到 config/environment.rb 并重新启动我的服务器：

```
config.load_paths += %W( #{RAILS_ROOT}/app/sweepers ) 
```

此时，每当我访问 TeamMember 模型时，都会收到以下错误：

```
undefined method `cache_sweeper' for #<Class:0x23128cc> 
```

我想念什么才能让它工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T18:04:24.197

我认为因为

“cache_sweeper :team_member_sweeper, :only => [:create, :destroy]”

应该进入您想要过期的控制器而不是模型。

我遇到了类似的问题，因为我特别想从模型中过期，但显然这在 Rails 中是不可能或很难做到的。

# javascript - 未调用 onreadystatechange 函数

> ID：403165
> 
> 赞同：2
> 
> 时间：2008-12-31T15:08:15.020
> 
> 标签：javascript, html, ajax

由于某种原因，onreadystatechange 回调函数没有在异步模式下被调用。我在同步模式下测试了帖子并确认帖子本身工作正常（注释掉我用来在同步模式下检查帖子的测试代码）。该问题出现在 safari 和 firefox 最新版本中。有人可以告诉我我在这里做错了什么吗？谢谢你。

```
 <html>
    <head>
    <script>
    function recordScore(str)
    {

    if (str.length==0)
    { 

        return;
    }

    xmlHttp=GetXmlHttpObject();
    if (xmlHttp==null)
    {
        alert ("Your browser does not support AJAX!");
        return;
    } 

    var url="http://hellworld3.appspot.com/findcountry";
    var params = "screenname="+document.getElementById("screenname1").value+"&score="+document.getElementById("score1").value;
    alert("params: "+params);
    xmlHttp.open("POST",url,true);

    xmlHttp.onreadystatechange = function() 
    {
        alert("entered call back function. readstate value is: "+xmlHttpreadyState+". Response Text is: "+xmlHttp.responseText);

    if (xmlHttp.readyState==4)
    { 
        document.getElementById("message").innerHTML=xmlHttp.responseText;
    }
    }
    xmlHttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
    xmlHttp.send(params);

    //Testing code for synchronous mode
    //alert("Http get status is: "+xmlHttp.status);
    //alert("Http ready state value is: "+xmlHttp.readyState);
    //alert("Http get response text is: "+xmlHttp.responseText);
    //document.getElementById("message").innerHTML=xmlHttp.responseText;
    }

    function GetXmlHttpObject()
    {
        var xmlHttp=null;
        try
        {
            // Firefox, Opera 8.0+, Safari
            xmlHttp=new XMLHttpRequest();
        }
        catch (e)
        {
            // Internet Explorer
            try
            {
                xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");
            }
            catch (e)
            {
                xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
            }
        }
        return xmlHttp;
    }

    </script>

    </head>

    <body>

    <form name="testform">
        Screename: 
        <input type="text" id="screenname1" name="screenname">
        <br/>
        Score:
        <input type="text" id="score1" name="score" onchange="recordScore(this.value)"> 
        <br/>
        <p id="message">test</p>

        <input type="submit" value="Submit">
    </form>

    </body>

    </html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-31T15:40:18.123

你在 onreadystatechange 函数中有一个错误：

```
alert("entered call back function. readstate value is: "+xmlHttpreadyState+". Response Text is: "+xmlHttp.responseText); 
```

`xmlHttpreadyState`应该`xmlHttp.readyState`

在我修复它之后，它在 FF3 中对我有用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T15:37:24.617

如果我错了，请纠正我，但对于 POST，你不需要像这样为 Content-Length 做一个 setRequestHeader；

```
xmlHttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
xmlHttp.setRequestHeader('Content-length',(params?params.length:0));
xmlHttp.send(params); 
```

这可能会纠正您的问题。

# security - 将 .pfx 转换为 .cer

> ID：403174
> 
> 赞同：178
> 
> 时间：2008-12-31T15:10:50.740
> 
> 标签：security, certificate, pfx

是否可以将 .pfx（个人信息交换）文件转换为 .cer（安全证书）文件？除非我弄错了，.cer 不是以某种方式嵌入到 .pfx 中吗？如果可能的话，我想要一些方法来提取它。

* * *

## 回答 #1

> 赞同：247
> 
> 时间：2009-01-01T22:09:55.790

PFX 文件是[PKCS#12 个人信息交换语法标准](http://en.wikipedia.org/wiki/PKCS12)捆绑包。它们可以包含任意数量的私钥以及随附的 X.509 证书和证书颁发机构链（设置证书）。

如果要提取客户端证书，可以使用[OpenSSL 的 PKCS12 工具](http://www.openssl.org/docs/apps/pkcs12.html)。

```
openssl pkcs12 -in input.pfx -out mycerts.crt -nokeys -clcerts 
```

上面的命令将以 PEM 格式输出证书。“.crt”文件扩展名由 macOS 和 Window 处理。

您在问题中提到了“.cer”扩展名，该扩展名通常用于 DER 编码文件。二进制编码。首先尝试“.crt”文件，如果它不被接受，很容易从 PEM 转换为 DER：

```
openssl x509 -inform pem -in mycerts.crt -outform der -out mycerts.cer 
```

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2008-12-31T15:22:54.710

我相信的简单方法是使用 Windows 管理控制台中的证书管理器将其导入然后导出。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2015-03-10T23:25:03.277

如果你在 PowerShell 中工作，你可以使用类似下面的东西，给定一个 pfx 文件**InputBundle.pfx**，生成一个 DER 编码（二进制）证书文件**OutputCert.der**：

```
Get-PfxCertificate -FilePath InputBundle.pfx | 
Export-Certificate -FilePath OutputCert.der -Type CERT 
```

*为清楚起见添加了换行符，但您当然可以将所有这些都放在一行中。*

如果您需要 ASCII/Base64 编码的 PEM 格式的证书，您可以按照其他地方的说明采取额外的步骤，例如此处：[https ://superuser.com/questions/351548/windows-integrated-utility-to-convert -der-to-pem](https://superuser.com/questions/351548/windows-integrated-utility-to-convert-der-to-pem)

如果您需要导出为不同于 DER 编码的格式，您可以更改`-Type`Export-Certificate 的参数以使用 .NET 支持的类型，如下所示`help Export-Certificate -Detailed`：

```
-Type <CertType>
    Specifies the type of output file for the certificate export as follows. 
     -- SST: A Microsoft serialized certificate store (.sst) file format which can contain one or more certificates. This is the default value for multiple certificates. 
     -- CERT: A .cer file format which contains a single DER-encoded certificate. This is the default value for one certificate. 
     -- P7B: A PKCS#7 file format which can contain one or more certificates. 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2014-06-06T14:08:31.533

我想添加一个我认为最简单的方法。

1.  只需右键单击 pfx 文件，按照向导单击“安装”，然后将其添加到商店（我添加到个人商店）。

2.  在开始菜单中键入 certmgr.msc 并转到 CertManager 程序。

3.  找到您的 pfx 证书（顶部的选项卡是各个商店），单击导出按钮并按照向导进行操作（有导出为 .CER 的选项）

本质上，它与 Andrew 的回答做同样的事情，但它避免使用 Windows 管理控制台（直接进入导入/导出）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-26T15:54:32.643

可能与 OP 的 Q 无关，但我尝试*了所有带有**所有*不同标志的openssl 语句，同时尝试连接 PHP `\SoapClient(...)`，3 天后我终于找到了一个适合我的解决方案。

## GitBash

```
$ cd path/to/certificate/
$ openssl pkcs12 -in personal_certificate.pfx -out public_key.pem -clcerts 
```

首先您必须输入`YOUR_CERT_PASSWORD`一次，然后输入`DIFFERENT_PASSWORD!`两次。后者可能对所有有权访问代码的人都可用。

## PHP

```
<?php

$wsdlUrl   = "https://example.com/service.svc?singlewsdl";
$publicKey = "rel/path/to/certificate/public_key.pem";
$password  = "DIFFERENT_PASSWORD!";

$params = [
    'local_cert' => $publicKey,
    'passphrase' => $password,
    'trace' => 1,
    'exceptions' => 0
];

$soapClient = new \SoapClient($wsdlUrl, $params);

var_dump($soapClient->__getFunctions()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-28T14:11:17.310

1.  从 OpenSSL\bin 文件夹启动 OpenSSL。
2.  打开命令提示符并转到包含 .pfx 文件的文件夹。
3.  运行以下命令提取私钥： openssl pkcs12 -in [yourfile.pfx] -nocerts -out [drlive.key] 系统将提示您输入导入密码。键入创建 .pfx 文件时用于保护密钥对的密码。系统将再次提示您提供新密码以保护您正在创建的 .key 文件。将密钥文件的密码存储在安全的地方以避免误用。
4.  运行以下命令提取证书： openssl pkcs12 -in [yourfile.pfx] -clcerts -nokeys -out [drlive.crt]
5.  openssl rsa -in [drlive.key] -out [drlive-decrypted.key]

将 .pfx 文件转换为 .pem 格式

在某些情况下，您可能必须将 .pfx 文件转换为 .pem 格式。运行以下命令将其转换为 PEM 格式。

openssl rsa -in [keyfile-encrypted.key] -outform PEM -out [keyfile-encrypted-pem.key]

source :[https://www.ibm.com/docs/en/arl/9.7?topic=certification-extracting-certificate-keys-from-pfx-file](https://www.ibm.com/docs/en/arl/9.7?topic=certification-extracting-certificate-keys-from-pfx-file)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-12T16:49:14.200

```
openssl rsa -in f.pem -inform PEM -out f.der -outform DER 
```

# vb.net - 在 vb.net 中显示加载屏幕

> ID：403202
> 
> 赞同：4
> 
> 时间：2008-12-31T15:26:16.387
> 
> 标签：vb.net, visual-studio, visual-studio-2005

我需要显示一个屏幕或其他东西，说“正在加载”或其他长时间的过程正在运行。

我正在使用 Windows Media Encoder SDK 创建一个应用程序，初始化编码器需要一段时间。我希望在启动编码器时弹出一个屏幕说“正在加载”，然后在编码器完成后它消失，他们可以继续使用应用程序。

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-31T15:59:41.657

创建一个用作“加载”对话框的表单。当您准备好初始化编码器时，使用该`ShowDialog()`方法显示此表单。这会导致它阻止用户与显示加载对话框的表单进行交互。

加载对话框的编码方式应该是，当它加载时，它使用 a`BackgroundWorker`在单独的线程上初始化编码器。这确保加载对话框将保持响应。以下是对话框表单的示例：

```
Imports System.ComponentModel

Public Class LoadingForm ' Inherits Form from the designer.vb file

    Private _worker As BackgroundWorker

    Protected Overrides Sub OnLoad(ByVal e As System.EventArgs)
        MyBase.OnLoad(e)

        _worker = New BackgroundWorker()
        AddHandler _worker.DoWork, AddressOf WorkerDoWork
        AddHandler _worker.RunWorkerCompleted, AddressOf WorkerCompleted

        _worker.RunWorkerAsync()
    End Sub

    ' This is executed on a worker thread and will not make the dialog unresponsive.  If you want
    ' to interact with the dialog (like changing a progress bar or label), you need to use the
    ' worker's ReportProgress() method (see documentation for details)
    Private Sub WorkerDoWork(ByVal sender As Object, ByVal e As DoWorkEventArgs)
        ' Initialize encoder here
    End Sub

    ' This is executed on the UI thread after the work is complete.  It's a good place to either
    ' close the dialog or indicate that the initialization is complete.  It's safe to work with
    ' controls from this event.
    Private Sub WorkerCompleted(ByVal sender As Object, ByVal e As RunWorkerCompletedEventArgs)
        Me.DialogResult = Windows.Forms.DialogResult.OK
        Me.Close()
    End Sub

End Class 
```

而且，当您准备好显示对话框时，您可以这样做：

```
Dim frm As New LoadingForm()
frm.ShowDialog() 
```

有更优雅的实现和更好的实践可以遵循，但这是最简单的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T15:35:24.280

有很多方法可以做到这一点。最简单的可能是显示一个模态对话框，然后启动另一个进程，一旦完成，然后关闭显示的对话框。您将需要处理标准 X 的显示以关闭。但是，在标准 UI 线程中执行所有这些操作会锁定 UI，直到操作完成。

另一种选择可能是有一个“加载”屏幕来填充您的默认表单，将其带到前面，然后在辅助线程上触发长时间运行的进程，一旦完成，您可以通知 UI 线程并删除加载屏幕。

这些只是一些想法，这实际上取决于您在做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T15:54:06.800

你可以尝试两件事。

设置标签后（如对 Mitchel 的评论中所述）调用`Application.DoEvents()`

另一个选择是在 BackgroundWorker 进程中运行编码器的初始化代码。

# sharepoint - FieldRef 的 Alias 属性有什么作用？

> ID：403203
> 
> 赞同：1
> 
> 时间：2008-12-31T15:26:46.823
> 
> 标签：sharepoint

MSDN 没有描述性：

[http://msdn.microsoft.com/en-us/library/ms442728.aspx](http://msdn.microsoft.com/en-us/library/ms442728.aspx)

别名 - 可选文本。

根据用户请求，我试图重命名自定义视图标题中显示的字段名称。所以我将 schema.xml 中的 ViewFields 部分更改为如下所示：

```
<ViewFields>
  <FieldRef Name="DocIcon" Alias="Form" DisplayName="Form">
  </FieldRef>
  <FieldRef Name="Employee" Alias="Name" DisplayName="Name">
  </FieldRef>
  <FieldRef Name="Modified">
  </FieldRef>
  <FieldRef Name="Editor">
  </FieldRef>
</ViewFields> 
```

我重新部署了我的解决方案并且......没有任何变化。仍然显示原始的 DisplayNames（在本例中为 Type 和 Employee）。

但现在，我很好奇。Alias 属性应该做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-31T23:50:37.070

据我了解，Alias 字段属性仅用于数据检索服务适配器，即在 Microsoft.SharePoint.Dsp 命名空间下。

[http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.dsp.field.alias.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.dsp.field.alias.aspx)

.b

# asp.net-mvc - 在 ASP.NET MVC 网站上实现搜索有哪些选择？

> ID：403209
> 
> 赞同：0
> 
> 时间：2008-12-31T15:30:10.920
> 
> 标签：asp.net-mvc, search, seo

我目前正在完成我的第一个 ASP.NET MVC 应用程序，并希望实现站点搜索。允许访问者搜索网站的选项有哪些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T17:14:50.927

[Lucene.NET](http://incubator.apache.org/lucene.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T16:07:44.680

Answers to the following questions may help...

1.  Is most/all content public, or login-protected? (i.e. can Google index it?) Or, would a "search appliance" be an alternative (though $$)?
2.  If you want to use full-text search, how many different tables/columns need to be searched? What would your queries look like, if using LINQ? :)
3.  Are common search terms represented in the page URLs? If doing custom searching, can you also search these, possibly with higher weight than in-page content?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T17:10:14.243

You could use [Microsoft Search Server 2008 Express](http://www.microsoft.com/enterprisesearch/). Its free and works of intranet apps.

# php - 如何进行版本控制、部署和开发 php 和 mySQL

> ID：403210
> 
> 赞同：5
> 
> 时间：2008-12-31T15:30:15.613
> 
> 标签：php, mysql, version-control

我正在一个项目中工作，我们使用 mySQL 数据库在 Zend 上开发 php，并且该项目即将达到需要对实际代码和数据库使用版本控制的地步。

我们也得到了一个好的生产服务器（实际的生产服务器将是一个测试服务器）。

所以我想知道你们是否认为标准化程序员使用的 IDE 并让他们在他们的盒子里安装 apache/php/mySQL 来测试代码是一个好主意，从而在每台计算机上都有一个开发人员环境，一个测试服务器和生产服务器。

如果是这样，您会向此过程的每个部分推荐什么设置，尤其是 mysql 版本控制（我从未这样做过）以及如何进行部署？

我知道这是一个非常大的问题，并且大多数问题已经在不同的问题中得到了回答，但我想要一个全球性的答案，关于如何更快、更好（更难、更强大）的设置以及我们需要多长时间来停止编程真正让所有这些工作！（是的，聘请该领域的专家几乎是禁忌）

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-01T10:23:49.040

不，我不会强制所有开发人员在 IDE 上进行标准化。您应该标准化编码风格，而不是 IDE。

在开发人员的机器上安装 PHP/Apache/MySQL 是个好主意。您可能遇到的唯一问题是开发人员的机器可能没有与测试和生产服务器完全相同的配置/运行时环境。使用虚拟映像可以解决此问题。

至于 MySQL 版本控制，请将您的模式放入源代码管理系统（CVS、SVN、Perforce 等）。为了应对变化，您可能需要研究 Rails 迁移以获取灵感。

部署是一个巨大的问题。我只能说有很多工具可供您使用。[Capistrano](http://www.capify.org/) , [Phing](http://phing.info/trac/)等

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T15:34:11.317

您使用 MySQL 进行版本化的东西将是用于创建、更改和加载数据库的 DDL 和 DML SQL 脚本。“敏捷数据库”成名的 Scott Ambler 对如何做到这一点有一些很好的想法。

如果你有一个每个人都可以使用的 IDE，那么标准化 IDE 是一件好事。但我认为无论您是否拥有标准 IDE，版本控制都是必要的。

在同一台服务器上测试和生产？我认为这是个坏主意。它们应该相同但分开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T15:45:28.313

> 所以我想知道你们是否认为标准化程序员使用的 IDE 并让他们在他们的盒子里安装 apache/php/mySQL 来测试代码是一个好主意，从而在每台计算机上都有一个开发人员环境，一个测试服务器和生产服务器。

是的，这是一个好主意，这就是我们所做的事情。

# .net - 检查 DataReader 中是否存在列或不使调试器在某些异常上中断

> ID：403215
> 
> 赞同：3
> 
> 时间：2008-12-31T15:32:13.957
> 
> 标签：.net, visual-studio, datareader

我的代码如下所示：

```
 //System.Data.IDataRecord dr
  try
  {
       Consolidated = Utility.NullConvert.ToBool(dr[Constants.Data.Columns.cConsolidated], false);
  }
  catch (IndexOutOfRangeException) { } //swallow 
```

我不知道合并列是否会出现在数据读取器中，所以我这样做是为了检查。它工作正常（虽然有点骇人听闻）。

但是，当我附加一个调试器时，它会在抛出异常时中断。非常烦人。

有没有更好的方法来编写该代码？或者是否有一些 Visual Studio 方法告诉它忽略异常而不中断（但仅在此处；并非无处不在）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T15:38:16.707

是的，您可以使用 datareader 的 GetSchemaTable() 方法获取列列表，然后您可以查看该列是否存在。

您可能会发现[这个非常相似的问题](https://stackoverflow.com/questions/373230/check-for-column-name-in-a-sqldatareader-object)很有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T15:44:47.363

我会简单地`GetOrdinal()`在循环开始时首先使用来查找列索引（并存储在变量中）。然后只需检查它是否是`>=0`. 这也具有提高性能的优点（只要您随后将此整数用于所有访问，而不是名称）。

不，没有忽略特定异常的优雅方法。您可以抓住并吞下，但这不是一个好方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-07T12:27:02.480

您可以简单地使用以下代码：

```
reader.GetSchemaTable().Columns.Contains("Your_Column") 
```

这将返回一个布尔值。

```
If reader.GetSchemaTable().Columns.Contains("ContactID") Then
   ' Do something
End If 
```

# c# - C# .NET 是否支持 IDispatch 后期绑定？

> ID：403218
> 
> 赞同：28
> 
> 时间：2008-12-31T15:33:16.700
> 
> 标签：c#, late-binding, idispatch

* * *

## 问题

我的问题是：**C# 是否天生支持后期绑定 IDispatch？**

* * *

*假装*我正在尝试自动化 Office，同时与客户安装的任何版本兼容。

在 .NET 世界中，如果您在安装 Office 2000 的情况下进行开发，那么从现在到结束，每个开发人员和每个客户都必须拥有 Office 2000。

在 .NET 之前的世界中，我们使用**COM**与 Office 应用程序通信。

例如：

1) 使用与版本无关的 ProgID

```
"Excel.Application" 
```

解决为：

```
clsid = {00024500-0000-0000-C000-000000000046} 
```

然后使用 COM，我们要求将这些类之一实例化为一个对象：

```
IUnknown unk;
CoCreateInstance(
    clsid, 
    null,
    CLSCTX_INPROC_SERVER | CLSCTX_LOCAL_SERVER,
    IUnknown, 
    out unk); 
```

现在我们要参加比赛了——能够在我的应用程序中使用 Excel。当然，如果*真的*要使用对象，就得调用有某种调用方式的方法。

我们*可以*得到各种**接口**声明，翻译成我们的语言。这种技术很好，因为我们得到

*   早期绑定
*   代码洞察力
*   编译类型语法检查

一些示例代码可能是：

```
Application xl = (IExcelApplication)unk;
ExcelWorkbook workbook = xl.Workbooks.Add(template, lcid);
Worksheet worksheet = workbook.ActiveSheet; 
```

* * *

但是使用接口有一个缺点：我们必须掌握各种接口声明，并翻译成我们的语言。而且我们被困在使用基于方法的调用中，必须指定所有参数，例如：

```
ExcelWorkbook workbook = xl.Workbooks.Add(template, lcid);
xl.Worksheets.Add(before, after, count, type, lcid); 
```

事实证明，在现实世界中，它有一些我们愿意放弃的缺点：

*   早期绑定
*   代码洞察力
*   编译时语法检查

而是使用**IDispatch**后期绑定：

```
Variant xl = (IDispatch)unk;
Variant newWorksheet = xl.Worksheets.Add(); 
```

因为 Excel 自动化是为 VB 脚本设计的，所以可以省略很多参数，即使没有它们就不会出现重载。

**注意：**不要将我的 Excel 示例与我想使用 IDispatch 的原因混淆。并非每个 COM 对象都是 Excel。某些 COM 对象除了通过 IDispatch 之外没有其他支持。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-28T20:47:42.240

您可以相对地在 C# 中使用后期绑定 IDispatch 绑定。

[http://support.microsoft.com/kb/302902](http://support.microsoft.com/kb/302902)

这是使用 Excel 的一些示例。这样你就不需要对微软臃肿的 PIA 添加不必要的依赖：

```
//Create XL
Object xl = Activator.CreateInstance(Type.GetTypeFromProgID("Excel.Application"));

//Get the workbooks collection.
//   books = xl.Workbooks;
Object books = xl.GetType().InvokeMember( "Workbooks", 
      BindingFlags.GetProperty, null, xl, null);

//Add a new workbook.
//   book = books.Add();
Objet book = books.GetType().InvokeMember( "Add", 
      BindingFlags.InvokeMethod, null, books, null );

//Get the worksheets collection.
//   sheets = book.Worksheets;
Object sheets = book.GetType().InvokeMember( "Worksheets",
      BindingFlags.GetProperty, null, book, null );

Object[] parameters;

//Get the first worksheet.
//   sheet = sheets.Item[1]
parameters = new Object[1];
parameters[0] = 1;
Object sheet = sheets.GetType().InvokeMember( "Item", 
      BindingFlags.GetProperty, null, sheets, parameters );

//Get a range object that contains cell A1.
//   range = sheet.Range["A1];
parameters = new Object[2];
parameters[0] = "A1";
parameters[1] = Missing.Value;
Object range = sheet.GetType().InvokeMember( "Range",
      BindingFlags.GetProperty, null, sheet, parameters );

//Write "Hello, World!" in cell A1.
//   range.Value = "Hello, World!";
parameters = new Object[1];
parameters[0] = "Hello, World!";
objRange_Late.GetType().InvokeMember( "Value", BindingFlags.SetProperty, 
      null, range, parameters );

//Return control of Excel to the user.
//   xl.Visible = true;
//   xl.UserControl = true;
parameters = new Object[1];
parameters[0] = true;
xl.GetType().InvokeMember( "Visible", BindingFlags.SetProperty,
      null, xl, Parameters );
xl.GetType().InvokeMember( "UserControl", BindingFlags.SetProperty,
      null, xl, Parameters ); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-31T15:43:30.300

您必须等待 C# 4.0 发布才能获得您正在寻找的后期绑定。每当我需要互操作功能时，我都会切换回 VB.Net 模式，这样我就可以利用 C# 似乎缺乏的 COM 功能。

我使用的简单方法是在 VB.Net 中创建一个执行 IDispatch 工作的类，然后公开我想用作包装器方法的方法，然后我可以从我的 C# 代码中随意调用它们。不是最优雅的解决方案，但在过去的几个月里，它让我摆脱了一两次的困境。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-31T15:36:37.257

C# 4 的`dynamic`关键字支持 IDispatch 和后期绑定。您可以阅读 Sam Ng 的[动态系列](http://blogs.msdn.com/samng/archive/tags/Dynamic/default.aspx)以获取更多信息

哦，C# 4 目前仅作为 CTP 提供。您必须等待 Visual Studio vNext 或使用测试版（在 Windows Server 2008 Virtual PC 上运行）才能使用它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-11-09T18:33:44.960

As others have said - using c#4's "dynamic" keyword rocks. Here's a simple example - it so much more succint than using "InvokeMethod"

```
dynamic xl = Activator.CreateInstance(Type.GetTypeFromProgID("Excel.Application"));
dynamic books = xl.Workbooks;
dynamic book = books.Add();

Console.WriteLine(books.Count);     //Writes 1

foreach (dynamic b in books)        
{
Console.WriteLine(b.Name);      //Writes "Book1"
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-31T20:31:59.227

如果您花时间编写一个包含您想要的对象的方法和属性的接口并添加一些属性（我从内存中编写它，所以细节可能不是），您可能可以在 C# 2.0/3.0正确，但我发誓它对我有用......）

```
 using System.Runtime.Interopservices;

    [Guid("00024500-0000-0000-C000-000000000046")]
    [InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]
    interface IExcel
    {
      // sample property
      string Name{get;}
      // more properties
    }

    // and somewhere else
    void main()
    {
      Object xl = Activator.CreateInstance(Type.GetTypeFromProgID("Excel.Application"));
      IExcel excel = (IExcel)xl;
      string name = xl.name
    } 
```

如前所述，代码不会开箱即用，它更多的是提示在 msdn 中挖掘什么。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-28T12:35:53.840

嘿伙计，我目前有 2 个 codeplex 项目来解决这个问题。

第一个是将 LateBindingApi.Excel [http://excel.codeplex.com](http://excel.codeplex.com) 映射到众所周知的对象模型的后期绑定调用调用。这是以下项目的测试项目。

the second one is a CodeGenerator [http://latebindingapi.codeplex.com](http://latebindingapi.codeplex.com) the tool creates c# projects from COM Type libraries. the generated projects includes mapper objects with latebind accessing the COM Server. the highlight is the tool converts COM type libs in different versions to one single project(for example excel 9,10,11) and marked all entities with an self defined SupportByLibrary Attribut. i have analyzed all office apps in version 9,10,11,12,14 with this this tool now and generate a c# solution, its available as tested beta with sample code on main page.

# ruby - 如何使用 Ruby 移动文件？

> ID：403239
> 
> 赞同：183
> 
> 时间：2008-12-31T15:40:48.277
> 
> 标签：ruby, file

我想用 Ruby 移动一个文件。我怎么做？

* * *

## 回答 #1

> 赞同：283
> 
> 时间：2008-12-31T15:46:57.267

您可以使用 FileUtils 来执行此操作。

```
#!/usr/bin/env ruby

require 'fileutils'

FileUtils.mv('/tmp/your_file', '/opt/new/location/your_file') 
```

记住; 如果您要跨分区移动，“mv”会将文件复制到新目标并取消链接源路径。

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2012-11-04T18:01:14.230

一个老问题，我很惊讶没有人回答这个简单的解决方案。您不需要 fileutils 或系统调用，只需将文件重命名为新位置即可。

```
File.rename source_path, target_path 
```

快乐编码

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-12-31T15:43:22.077

[FileUtils.move](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/fileutils/rdoc/FileUtils.html#method-c-mv)

```
require 'fileutils'
FileUtils.move 'stuff.rb', '/notexist/lib/ruby' 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-12-31T15:43:34.590

使用模块“fileutils”并使用 FileUtils.mv：

[http://www.ruby-doc.org/stdlib-2.0/libdoc/fileutils/rdoc/FileUtils.html#method-c-mv](http://www.ruby-doc.org/stdlib-2.0/libdoc/fileutils/rdoc/FileUtils.html#method-c-mv)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-12T20:28:59.990

这是一个模板。

```
 src_dir = "/full_path/to_some/ex_file.txt"

 dst_dir = "/full_path/target_dir"

 #Use the method below to do the moving
 move_src_to_target_dir(src_dir, dst_dir)

 def archive_src_to_dst_dir(src_dir, dst_dir)

     if File.exist ? (src_dir)

     puts "about to move this file:  #{src_dir}"

     FileUtils.mv(src_dir, dst_dir)
 else

     puts "can not find source file to move"

 end
 end 
```

* * *

## 回答 #6

> 赞同：-10
> 
> 时间：2016-06-04T09:55:33.840

你可以像这样移动你的文件

Rails.root.join('foo','bar')

# visual-studio - Visual Source Safe - 从 Web 项目中删除文件

> ID：403240
> 
> 赞同：0
> 
> 时间：2008-12-31T15:41:10.117
> 
> 标签：visual-studio, version-control, visual-sourcesafe

我会尽量做到这一点。

1.  目前我们的团队有一个存储我们项目的 VSS 数据库。
2.  开发人员获取代码并放置在他们的本地主机上并在本地进行开发。
3.  指定开发者抓取最新版本并推送到开发服务器。

问题是，当从项目中删除一个文件（通过在 VS2008 中删除它）然后下一次另一个开发人员（不是删除它的人）签入时，它会提示他们签入那些已删除的文件，因为他们仍然有一个复制到他们的本地机器上。

有没有解决的办法？让 VSS 指示客户端计算机删除这些文件而不提示他们重新签入？对此的首选方法是什么？

* * *

编辑注释：

1.  我同意 SVN 比 VSS 好
2.  我同意 Web 应用程序项目比网站项目好
3.  **问题**：从类库中删除的文件也会发生同样的情况。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T15:47:00.603

解决此问题的首要方法是停止使用网站项目。网站项目使 Visual Studio 自动将它在项目路径中找到的任何内容添加到项目中。

相反，请转到没有此行为问题的 Web 应用程序项目。

网站项目适合单人开发。

**更新：**

过去的 VB 商店也有类似的问题，因为他们安装的任何东西都会影响构建过程。您可能会从他们的剧本中获取一页并拥有一台“干净”的构建机器。在进行部署之前，您将删除所有项目文件夹，然后执行获取最新的。通过这种方式，您可以确保部署的唯一内容就是您在源代码控制中拥有的内容。

顺便说一句，这也是 TFS 构建服务器的工作方式。它会删除工作区，然后创建一个新工作区并下载必要的项目文件。

此外，您可能会考虑使用诸如[Cruise Control](http://cruisecontrol.sourceforge.net/)之类的东西来处理构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T15:54:23.647

也许开发人员应该注意只签入或添加他们一直在做的事情。如果他们添加了他们甚至没有使用的东西，那就有点草率了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T15:52:07.723

您最好的解决方案是切换到更好的版本控制系统，例如 SVN。

在我的工作中，我们最近从一家外包公司那里获得了一个项目，该公司确实使用 VSS 作为他们的版本控制。我们能够从 VSS 将所有更改历史记录导入 SVN，然后使用 SVN 快速启动并运行。

使用 SVN，您可以为文件和文件夹设置忽略，因此您的 Web 项目中的文件不会被放入 SVN，并且忽略属性会被检出到每个开发人员的机器上

我相信我们使用 VSSMigrate 迁移到 SVN [http://www.poweradmin.com/sourcecode/vssmigrate.aspx](http://www.poweradmin.com/sourcecode/vssmigrate.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T17:28:17.110

VSS 是一个糟糕的版本控制系统，您应该切换到 SVN，但这与问题的症结无关。项目文件包含对哪些文件实际上是项目的一部分的引用。如果 Visual Studio 项目没有连同对它的更改一起签入，则任何其他开发人员都无法完全更新，因此在他们从 VSS 获取最新文件时查询删除文件。从那里你有多种选择......

1.  使 vbproj 成为存储库的一部分。任何项目级别的更改都将成为提交的一部分，并且可以通知其他开发人员。这里的问题是它也将在开发服务器上。理想情况下，您可以使用几乎相同的过程来部署到开发，就像部署为发布一样。这导致了另一种方式......

2.  SVN 为您提供了几乎所有重大事件的挂钩，其中挂钩实际上只是一个正确命名的批处理文件/exe。出于您的目的，您可以使用提交后挂钩在每次提交时将适当的文件（例如通过 ftp）推送到服务器。文件问题解决了，更重要的是更接近持续集成的概念。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T22:27:33.260

您可能想要考虑做的事情：

1.  获取最新（递归）
2.  报到 ...

它是一个手动过程，但它可能会给你想要的结果，另外，如果 VS 谈到已删除的文件，你知道它们应该在步骤 1 中从本地计算机中删除。

# java - 如何从 Java jar 文件中读取资源文件？

> ID：403256
> 
> 赞同：63
> 
> 时间：2008-12-31T15:46:20.293
> 
> 标签：java, jar, resources

我正在尝试从作为桌面应用程序运行的单独 jar 访问 jar 文件中的 XML 文件。我可以获得我需要的文件的 URL，但是当我将它传递给 FileReader（作为字符串）时，我得到一个 FileNotFoundException 说“文件名、目录名或卷标语法不正确。”

作为参考，我可以毫无困难地从同一个 jar 中读取图像资源，将 URL 传递给 ImageIcon 构造函数。这似乎表明我用来获取 URL 的方法是正确的。

```
URL url = getClass().getResource("/xxx/xxx/xxx/services.xml");
ServicesLoader jsl = new ServicesLoader( url.toString() ); 
```

在 ServicesLoader 类里面我有

```
XMLReader xr = XMLReaderFactory.createXMLReader();
xr.setContentHandler( this );
xr.setErrorHandler( this );
xr.parse( new InputSource( new FileReader( filename ))); 
```

使用这种技术读取 XML 文件有什么问题？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-12-31T15:52:54.383

看起来你想用`java.lang.Class.getResourceAsStream(String)`，看

[https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html#getResourceAsStream-java.lang.String-](https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html#getResourceAsStream-java.lang.String-)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-31T15:51:39.783

您不会说这是桌面应用程序还是网络应用程序。如果它是桌面，我会使用`getResourceAsStream()`适当的 ClassLoader 中的方法，如果它是 Web 应用程序，我会使用 Context。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-31T16:00:43.120

看起来好像您正在使用`URL.toString`结果作为`FileReader`构造函数的参数。`URL.toString`有点坏了，你通常应该使用`url.toURI().toString()`. 在任何情况下，字符串都不是文件路径。

相反，您应该：

*   传递`URL`to`ServicesLoader`并让它调用`openStream`或类似的。
*   使用`Class.getResourceAsStream`并只是将流传递过来，可能在`InputSource`. （记得检查空值，因为 API 有点乱。）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-11T20:38:24.940

问题是我在调用 XMLReader 的 parse 方法时走得太远了。parse 方法接受 InputSource，因此甚至没有理由使用 FileReader。将上面代码的最后一行更改为

```
xr.parse( new InputSource( filename )); 
```

工作得很好。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-10-13T19:07:57.503

我想指出一个问题是，如果相同的资源位于多个 jar 文件中怎么办。假设您要读取 /org/node/foo.txt，但不是从一个文件中读取，而是从每个 jar 文件中读取。

我之前曾多次遇到过同样的问题。我希望在 JDK 7 中有人会编写一个类路径文件系统，但可惜还没有。

Spring 有 Resource 类，它允许您很好地加载类路径资源。

我写了一个小原型来解决这个从多个 jar 文件中读取资源的问题。原型并不处理所有边缘情况，但它确实处理在 jar 文件中的目录中查找资源。

我使用 Stack Overflow 已经有一段时间了。这是我记得回答问题的第二个答案，如果我回答的时间太长，请原谅我（这是我的天性）。

这是一个原型资源阅读器。该原型缺乏稳健的错误检查。

我有两个已设置的原型 jar 文件。

```
 &lt;pre>
         &lt;dependency>
              &lt;groupId>invoke&lt;/groupId>
              &lt;artifactId>invoke&lt;/artifactId>
              &lt;version>1.0-SNAPSHOT&lt;/version>
          &lt;/dependency>

          &lt;dependency>
               &lt;groupId>node&lt;/groupId>
               &lt;artifactId>node&lt;/artifactId>
               &lt;version>1.0-SNAPSHOT&lt;/version>
          &lt;/dependency> 
```

每个 jar 文件在 /org/node/ 下都有一个名为 resource.txt 的文件。

这只是一个带有 classpath:// 的处理程序的原型我在我的本地资源中也有一个 resource.foo.txt 用于这个项目。

它把它们全部捡起来并打印出来。

```
   package com.foo;

    import java.io.File;
    import java.io.FileReader;
    import java.io.InputStreamReader;
    import java.io.Reader;
    import java.net.URI;
    import java.net.URL;
    import java.util.Enumeration;
    import java.util.zip.ZipEntry;
    import java.util.zip.ZipFile;

    /**
    * Prototype resource reader.
    * This prototype is devoid of error checking.
    *
    *
    * I have two prototype jar files that I have setup.
    * <pre>
    *             <dependency>
    *                  <groupId>invoke</groupId>
    *                  <artifactId>invoke</artifactId>
    *                  <version>1.0-SNAPSHOT</version>
    *              </dependency>
    *
    *              <dependency>
    *                   <groupId>node</groupId>
    *                   <artifactId>node</artifactId>
    *                   <version>1.0-SNAPSHOT</version>
    *              </dependency>
    * </pre>
    * The jar files each have a file under /org/node/ called resource.txt.
    * <br />
    * This is just a prototype of what a handler would look like with classpath://
    * I also have a resource.foo.txt in my local resources for this project.
    * <br />
    */
    public class ClasspathReader {

        public static void main(String[] args) throws Exception {

            /* This project includes two jar files that each have a resource located
               in /org/node/ called resource.txt.
             */

            /* 
              Name space is just a device I am using to see if a file in a dir
              starts with a name space. Think of namespace like a file extension 
              but it is the start of the file not the end.
            */
            String namespace = "resource";

            //someResource is classpath.
            String someResource = args.length > 0 ? args[0] :
                    //"classpath:///org/node/resource.txt";   It works with files
                    "classpath:///org/node/";                 //It also works with directories

            URI someResourceURI = URI.create(someResource);

            System.out.println("URI of resource = " + someResourceURI);

            someResource = someResourceURI.getPath();

            System.out.println("PATH of resource =" + someResource);

            boolean isDir = !someResource.endsWith(".txt");

            /** Classpath resource can never really start with a starting slash.
             * Logically they do, but in reality you have to strip it.
             * This is a known behavior of classpath resources.
             * It works with a slash unless the resource is in a jar file.
             * Bottom line, by stripping it, it always works.
             */
            if (someResource.startsWith("/")) {
                someResource = someResource.substring(1);
            }

              /* Use the ClassLoader to lookup all resources that have this name.
                 Look for all resources that match the location we are looking for. */
            Enumeration resources = null;

            /* Check the context classloader first. Always use this if available. */
            try {
                resources = 
                    Thread.currentThread().getContextClassLoader().getResources(someResource);
            } catch (Exception ex) {
                ex.printStackTrace();
            }

            if (resources == null || !resources.hasMoreElements()) {
                resources = ClasspathReader.class.getClassLoader().getResources(someResource);
            }

            //Now iterate over the URLs of the resources from the classpath
            while (resources.hasMoreElements()) {
                URL resource = resources.nextElement();

                /* if the resource is a file, it just means that we can use normal mechanism
                    to scan the directory.
                */
                if (resource.getProtocol().equals("file")) {
                    //if it is a file then we can handle it the normal way.
                    handleFile(resource, namespace);
                    continue;
                }

                System.out.println("Resource " + resource);

               /*

                 Split up the string that looks like this:
                 jar:file:/Users/rick/.m2/repository/invoke/invoke/1.0-SNAPSHOT/invoke-1.0-SNAPSHOT.jar!/org/node/
                 into
                    this /Users/rick/.m2/repository/invoke/invoke/1.0-SNAPSHOT/invoke-1.0-SNAPSHOT.jar
                 and this
                     /org/node/
                */
                String[] split = resource.toString().split(":");
                String[] split2 = split[2].split("!");
                String zipFileName = split2[0];
                String sresource = split2[1];

                System.out.printf("After split zip file name = %s," +
                        " \nresource in zip %s \n", zipFileName, sresource);

                /* Open up the zip file. */
                ZipFile zipFile = new ZipFile(zipFileName);

                /*  Iterate through the entries.  */
                Enumeration entries = zipFile.entries();

                while (entries.hasMoreElements()) {
                    ZipEntry entry = entries.nextElement();
                    /* If it is a directory, then skip it. */
                    if (entry.isDirectory()) {
                        continue;
                    }

                    String entryName = entry.getName();
                    System.out.printf("zip entry name %s \n", entryName);

                    /* If it does not start with our someResource String
                       then it is not our resource so continue.
                    */
                    if (!entryName.startsWith(someResource)) {
                        continue;
                    }

                    /* the fileName part from the entry name.
                     * where /foo/bar/foo/bee/bar.txt, bar.txt is the file
                     */
                    String fileName = entryName.substring(entryName.lastIndexOf("/") + 1);
                    System.out.printf("fileName %s \n", fileName);

                    /* See if the file starts with our namespace and ends with our extension.        
                     */
                    if (fileName.startsWith(namespace) && fileName.endsWith(".txt")) {

                        /* If you found the file, print out 
                           the contents fo the file to System.out.*/
                        try (Reader reader = new InputStreamReader(zipFile.getInputStream(entry))) {
                            StringBuilder builder = new StringBuilder();
                            int ch = 0;
                            while ((ch = reader.read()) != -1) {
                                builder.append((char) ch);

                            }
                            System.out.printf("zip fileName = %s\n\n####\n contents of file %s\n###\n", entryName, builder);
                        } catch (Exception ex) {
                            ex.printStackTrace();
                        }
                    }

                    //use the entry to see if it's the file '1.txt'
                    //Read from the byte using file.getInputStream(entry)
                }

            }

        }

        /**
         * The file was on the file system not a zip file,
         * this is here for completeness for this example.
         * otherwise.
         *
         * @param resource
         * @param namespace
         * @throws Exception
         */
        private static void handleFile(URL resource, String namespace) throws Exception {
            System.out.println("Handle this resource as a file " + resource);
            URI uri = resource.toURI();
            File file = new File(uri.getPath());

            if (file.isDirectory()) {
                for (File childFile : file.listFiles()) {
                    if (childFile.isDirectory()) {
                        continue;
                    }
                    String fileName = childFile.getName();
                    if (fileName.startsWith(namespace) && fileName.endsWith("txt")) {

                        try (FileReader reader = new FileReader(childFile)) {
                            StringBuilder builder = new StringBuilder();
                            int ch = 0;
                            while ((ch = reader.read()) != -1) {
                                builder.append((char) ch);

                            }
                            System.out.printf("fileName = %s\n\n####\n contents of file %s\n###\n", childFile, builder);
                        } catch (Exception ex) {
                            ex.printStackTrace();
                        }

                    }

                }
            } else {
                String fileName = file.getName();
                if (fileName.startsWith(namespace) && fileName.endsWith("txt")) {

                    try (FileReader reader = new FileReader(file)) {
                        StringBuilder builder = new StringBuilder();
                        int ch = 0;
                        while ((ch = reader.read()) != -1) {
                            builder.append((char) ch);

                        }
                        System.out.printf("fileName = %s\n\n####\n contents of file %s\n###\n", fileName, builder);
                    } catch (Exception ex) {
                        ex.printStackTrace();
                    }

                }

            }
        }

    } 

```

[您可以在此处使用示例输出查看更完整的示例。](http://rick-hightower.blogspot.com/2013/10/classpath-resource-reader.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-06-11T18:39:57.337

这是一个关于如何在 jar 文件中正确读取文件的示例代码（在本例中为当前正在执行的 jar 文件）

如果它不是当前正在运行的，只需使用您的 jar 文件的路径更改可执行文件。

然后将filePath更改为jar文件中要使用的文件的路径。IE 如果你的文件在

> someJar.jar\img\test.gif

. 将文件路径设置为“img\test.gif”

```
File executable = new File(BrowserViewControl.class.getProtectionDomain().getCodeSource().getLocation().toURI());
JarFile jar = new JarFile(executable);
InputStream fileInputStreamReader = jar.getInputStream(jar.getJarEntry(filePath));
byte[] bytes = new byte[fileInputStreamReader.available()];

int sizeOrig = fileInputStreamReader.available();
int size = fileInputStreamReader.available();
int offset = 0;
while (size != 0){
    fileInputStreamReader.read(bytes, offset, size);
    offset = sizeOrig - fileInputStreamReader.available();
    size = fileInputStreamReader.available();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T15:51:39.910

在你的技术之外，为什么不使用标准的 Java [JarFile 类](http://java.sun.com/javase/6/docs/api/java/util/jar/JarFile.html)来获取你想要的引用呢？从那里你的大部分问题应该会消失。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-04-10T17:39:16.170

如果您广泛使用资源，您可能会考虑使用 [Commons VFS](http://commons.apache.org/vfs/filesystems.html)。

还支持： * 本地文件 * FTP、SFTP * HTTP 和 HTTPS * 临时文件“支持正常的 FS” * Zip、Jar 和 Tar（未压缩、tgz 或 tbz2） * gzip 和 bzip2 * 资源 * ram - “ramdrive” * mime

还有[JBoss VFS](http://java.dzone.com/news/jboss-virtual-file-system) - 但它的文档并不多。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-08-02T13:40:31.427

我有 2 个用于读取数据的 CSV 文件。java 程序导出为可运行的 jar 文件。当你导出它时，你会发现它不会用它导出你的资源。

我在 eclipse 中的项目下添加了一个名为 data 的文件夹。在那个文件夹中，我存储了我的 csv 文件。

当我需要引用这些文件时，我会这样做......

```
private static final String ZIP_FILE_LOCATION_PRIMARY = "free-zipcode-database-Primary.csv";
private static final String ZIP_FILE_LOCATION = "free-zipcode-database.csv";

private static String getFileLocation(){
    String loc = new File("").getAbsolutePath() + File.separatorChar +
        "data" + File.separatorChar;
    if (usePrimaryZipCodesOnly()){              
        loc = loc.concat(ZIP_FILE_LOCATION_PRIMARY);
    } else {
        loc = loc.concat(ZIP_FILE_LOCATION);
    }
    return loc;
} 
```

然后，当您将 jar 放在某个位置以便可以通过命令行运行时，请确保将包含资源的数据文件夹添加到与 jar 文件相同的位置。

# workflow - Microsoft Windows Workflow 能否路由到特定工作站？

> ID：403270
> 
> 赞同：3
> 
> 时间：2008-12-31T15:51:14.933
> 
> 标签：workflow

我想编写一个将链接路由到文档的工作流应用程序。路由基于机器而不是用户，因为我不知道谁会出现在给定的职位上。例如，我有一个表格。它最初是在位置 A 填写的。我现在希望它转到位置 B 并让他们填写其余部分。最后，它会到达主管将批准的位置 C。

这些位置都没有已知用户。那就是不知道会是谁。我只知道授权给谁（他们被分配到工作站并被批准在那里。）

Microsoft Windows Workflow 会执行此操作，还是我需要基于 SQL Server、IP 地址等构建自己的工作流？

此外，如何通知工作站上的用户文档已发送到他们的机器？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-02T08:22:41.030

您可能还想查看人工工作流引擎，因为它们旨在执行诸如此类（以及更多）之类的事情，我最熟悉[PNMsoft](http://www.pnmsoft.com)的 Sequence

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T22:56:01.770

我认为，如果我正在处理这个问题，工作流程就可以做到。这是您想要的具有三种状态的状态机：

*   一个开始
*   B 完成
*   C 批准

然而工作流需要在一个中心位置工作（相信我，你只想让一个工作流运行时同时运行，否则可以多次完成相同的工作，[请参阅我们在 MSDN 论坛上的问题](http://social.msdn.microsoft.com/Forums/en-US/windowsworkflowfoundation/thread/ae848f70-2b34-4d74-8c59-ff5045a744f0/)）。因此，运行工作流的中央服务器就是答案。

您可以通过多种方式将其呈现给用户。[Dave](https://stackoverflow.com/questions/403270/can-microsoft-windows-workflow-route-to-specific-workstations#403328)建议使用 ASP.NET 站点来识别正在执行该工作的机器，这可能是我的做法。但是，您也可以编写一个 Windows 窗体客户端来做同样的事情。这将需要使用 SOAP / WCF 之类的东西来促进客户端表单应用程序和中央工作流服务之间的通信。这样做的好处是您可以使用系统尝试图标来提醒用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T16:10:12.680

您可以设计一个通用的“路由”工作流，它会导致数据进入工作站。最简单的方法是将工作流嵌入到 ASP.NET 应用程序中。每个工作站都应该使用查询字符串中的工作站 ID 访问应用程序：

[http://myapp/default.aspx?wid=01](http://myapp/default.aspx?wid=01)

在工作站 A 填写表格后，在 Web 应用程序中运行的工作流可以将其输入到下一个工作站的“工作箱”中。任何坐在该表格的计算机前的人都会看到它出现在他们要查看的表格列表中。您可以使用 AJAX 使其流畅和自动更新。

# ide - Mercurial 实践：与 IDE 和可扩展性一起使用

> ID：403279
> 
> 赞同：9
> 
> 时间：2008-12-31T15:53:20.700
> 
> 标签：ide, mercurial, scalability

我不是 SCM 工具的经验丰富的用户，尽管我确信它们的用处，当然。我在以前的工作中使用了一些不起眼的商业工具，在当前的工作中使用了 Perforce，并在我的小型个人项目中使用了 TortoiseSVN，但我不喜欢到处都有很多 .svn 文件夹，进行搜索、备份等等难的。然后我发现了分布式 SCM 的兴趣，我选择了明显更简单（比 git）的 Mercurial 方式，仍然是为了我个人的个人需求。我正在学习如何正确使用它，阅读了 wiki 的一部分，并且正在阅读这本优秀的 PDF 书籍。

我经常看到重复，例如在[Mercurial 工作实践](http://www.selenic.com/mercurial/wiki/index.cgi/WorkingPractices?highlight=%28practices%29 "水银的工作实践")中，“*不要犹豫在本地使用多棵树。Mercurial 使这变得快速且轻量级。* ”和“*为您处理的每个功能创建一棵新树。* ”。这些是有趣且明智的建议，但它们有点伤害了我使用集中式 SCM 的小习惯，在那里我们有一个“神圣的”中央存储库，其中分支经过精心规划（并由管理员处理），变更列表必须由（高级）同行检查和不得破坏构建等 :-) 开始在新分支上工作需要相当长的时间......

因此，鉴于上述情况，我有两个问题：

*   在 IDE 等环境中进行大量克隆有多实用？如果项目有配置/设置文件、makefile 或 Ant 脚本或 shell 脚本或其他需要路径更新的东西怎么办？（是的，可能是个坏主意...）例如，在 Eclipse 中，如果我想编译并运行一个克隆，我必须再做一个项目，调整 Java 构建路径、运行/调试目标等等. 除非 Eclipse 插件可以简化该任务。我想念这里的一些设施吗？

*   那怎么缩放？我读过 Hg 对于大型代码库是可以的，但我很困惑。在我的工作中，我们有一个大约 200 万行的 Java 应用程序（嗯，几个围绕一个大型通用内核），仅代码就占 110MB。在我的旧（2004）Windows 工作站上进行干净编译需要大约 15 分钟才能生成 50MB 的类文件！我没有看到自己克隆整个项目来更改 3 个文件。那么这里的做法是什么？

我还没有在我的阅读中看到这些问题，所以我希望这将成为一个有用的线程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T21:16:31.787

你提出了一些好点！

> *   在 IDE 等环境中进行大量克隆有多实用？

没错，当 IDE 和其他工具依赖于绝对路径时，可能很难管理许多克隆。部分问题可以通过始终在配置文件中使用相对路径来解决——确保源代码检出可以从任何位置编译本身就是一个很好的目标，无论您使用什么版本控制系统:-)

但是当您不能或不想打扰多个克隆时，请注意[单个克隆可以处理多个分支](https://stackoverflow.com/a/890892/110204)。“hgbook”强调了许多克隆，因为这是一种概念上简单且非常安全的工作方式。当您获得更多经验时，您会发现您可以在单个存储库中使用多个头（可能通过使用[书签](http://www.selenic.com/mercurial/wiki/Bookmarks)命名它们）来做同样的事情。

> *   那怎么缩放？

克隆 110 MB 的存储库应该很快：这取决于将 110 MB 写入磁盘需要多长时间。在[最近发给 Mercurial 邮件列表](http://markmail.org/message/3tbgalmgcns5qcgt)的消息中，据报道克隆 6.3 GB 需要 4 分钟——将其缩小到 110 MB 大约需要 4 秒。这应该足够快，你的茶仍然是温暖的 :-) 诀窍的一部分是历史数据只是硬链接（是的，也在 Windows 上），所以只需写出工作中的文件复制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-02T20:27:45.080

PhiLo：我是这方面的新手，但 mercurial 也有“内部分支”，您可以在单个存储库中使用它而不是克隆它。

代替

```
hg clone toto toto-bug-434 
```

你可以做

```
cd toto
hg branch bug-434
hg update bug-434
...
hg commit
hg update default 
```

创建一个分支并来回切换。当您切换分支时，不受 rev 控制的构建文件不会消失，其中一些会随着基础源的修改而过时。您的 IDE 将重建所需的内容，仅此而已。它的工作方式很像 CVS 或颠覆。

除了“工作”存储库之外，您还应该拥有干净的“传入”和“传出”存储库。只是你的“工作”可以服务于多种目的。

也就是说，您应该在尝试任何复杂的操作之前克隆您的工作存储库。如果出现任何问题，您可以扔掉克隆并重新开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T17:41:08.267

问题一：

[PIDA IDE](http://pida.co.uk/)有很好的 Mercurial 集成。我们还使用 Mercurial 进行开发本身。就我个人而言，我有大约 15 个并发克隆一些项目，IDE 可以很好地应对。我们没有调整构建脚本等的麻烦，我们可以“克隆并运行”。

这很容易，在很多情况下我会克隆到错误编号，例如：

```
hg 克隆 http://pida.co.uk/hg pida-345

```

对于错误 #345，我已准备好修复。

如果您必须根据应用程序的实际检出目录调整构建脚本，我可能会认为您的构建脚本应该使用某种项目相对路径，而不是硬编码路径。

# sql - 查找缺失值

> ID：403291
> 
> 赞同：1
> 
> 时间：2008-12-31T15:59:08.490
> 
> 标签：sql

我有一个表，有 2 个重要列 DocEntry、WebId

样本数据就像

```
DocEntry  WebId
1         S001
2         S002
3         S003
4         S005 
```

现在我们可以注意到，在 WebId 列中，缺少 S004。我们如何才能找到这样丢失的号码，通过查询。

进一步说明：

如果缺少中间的任何数字，则网络 ID 应该按递增顺序排列，例如 S001、S002、S003、S004、S005，而不是缺少的数字。对于可能的条目，我没有任何单独的表格，因为那是不切实际的。我必须逐月查找缺失的数字，以每个月的开始值和结束值作为边界，而不是找到缺失的数字（如果有）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T23:31:32.773

一个非常简单的方法:)

```
mysql> select * from test;
+----------+-------+
| DocEntry | WebId |
+----------+-------+
| 1        | S001  |
| 2        | S002  |
| 3        | S003  |
| 4        | S005  |
| 5        | S006  |
| 6        | S007  |
| 7        | S008  |
| 8        | S010  |
+----------+-------+
8 rows in set (0,00 sec)

mysql> SELECT right(t1.webid,3) +1 as missing_WebId FROM test t1 left join test t2 on right(t1.webid,3)+1 = right(t2.webid,3) where t2.webid is null;
+---------------+
| missing_WebId |
+---------------+
| 4             |
| 9             |
| 11            |
+---------------+
3 rows in set (0,01 sec) 
```

祝你好运，莫里斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T17:05:08.870

有一个生成整数的标准技巧需要您创建一个 10 行实用程序表，即：

```
create table Pivot (i int)

insert into Pivot values (0)
insert into Pivot values (1)
insert into Pivot values (2) 

/* ... down to */

insert into Pivot values (9) 
```

完成此操作后，例如

```
select u.i + 10*t.i + 100*h.i from Pivot u, Pivot t, Pivot h 
```

将为您提供从 0 到 999 的所有数字。

添加一个 where 子句来限制您在一个范围内，并且一些字符串函数会将您带到上面 Rob 答案中的 PossibleEntries 表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T17:49:06.847

（*旁白：为什么人们一般（拉胡尔不是唯一一个，无论如何）从问题中省略他们的桌子的名字？*）

以关系方式很难做到这一点，因为它本质上依赖于数据的排序，而关系代数则适用于（无序的）集合。我认为我们应该假设 DocID 列没有意义，它不能用来帮助解决问题。

在示例中，您有 S003 和 S005，但缺少 S004。我们如何判断存在缺失值？大概是因为有一个比较运算告诉我们“小于”、“等于”、“大于”，也因为有一个差分函数告诉我们S003和S005之间的差距是2。我们假设' >' 和朋友进行比较（此处适用于字符串），您可以生成一个存储过程 webid_diff() ，它接受两个 WebID 值并返回差异。

然后，您可以编写一个查询，例如：

```
SELECT a.webid, MIN(b.webid) AS min_next
    FROM AnonymousTable AS a, AnonymousTable AS b
    WHERE a.webid < b.webid
    GROUP BY a.webid; 
```

这使用表和自身之间的非等值连接来查找每个项目的最小后继 WebID 值。

以此为核心，我们可以过滤结果以仅选择那些 WebID 和 Min_Next 之间的差距大于 1 的行。所以，我认为我们得到（*第一次尝试）*：

```
SELECT x.webid, y.min_next, webid_diff(x.webid, y.min_next) AS gap
    FROM AnonymousTable AS x,
         (SELECT a.webid, MIN(b.webid) AS min_next
             FROM AnonymousTable AS a, AnonymousTable AS b
             WHERE a.webid < b.webid
             GROUP BY a.webid
         ) AS y
    WHERE x.webid = y.webid
      AND webid_diff(x.webid, y.min_next) > 1; 
```

外层的连接真的给我们带来了什么有用的东西吗？我不这么认为，所以我们可以删除它，导致（*第二次尝试）*：

```
SELECT y.webid, y.min_next, webid_diff(y.webid, y.min_next) AS gap
    FROM (SELECT a.webid, MIN(b.webid) AS min_next
             FROM AnonymousTable AS a, AnonymousTable AS b
             WHERE a.webid < b.webid
             GROUP BY a.webid
         ) AS y
    WHERE webid_diff(y.webid, y.min_next) > 1; 
```

**这确实有效**。尝试将 webid_diff() 函数放入内部查询会给我带来问题 - 至少 GAP 表达式必须包含在 GROUP BY 子句中，但这会给出错误的答案。

HAVING 子句用于将过滤条件应用于聚合，因此看起来有点好像查询可以简化为：

```
SELECT a.webid, MIN(b.webid) AS min_next, webid_diff(a.webid, b.webid) AS gap
    FROM AnonymousTable AS a, AnonymousTable AS b
    WHERE a.webid < b.webid
    GROUP BY a.webid
    HAVING webid_diff(a.webid, b.webid) > 1; 
```

但是，这不起作用（对我来说，使用我的 DBMS - IBM Informix Dynamic Server），因为 webid_diff() 不是聚合。

这是我用于 webid_diff() 函数的代码（您必须调整以适应 DBMS 的语法）和辅助 webid_num() 函数：

```
CREATE FUNCTION webid_num(a CHAR(4)) RETURNING INTEGER;
    DEFINE i INTEGER;
    LET i = substr(a, 2, 3);
    RETURN i;
END FUNCTION;

CREATE FUNCTION webid_diff(a CHAR(4), b CHAR(4)) RETURNING INTEGER;
    DEFINE i, j INTEGER;
    LET i = webid_num(a);
    LET j = webid_num(b);
    RETURN (j - i);
END FUNCTION; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T16:04:51.677

您需要定义“失踪”的含义。您不能指望您的数据库服务器理解这个抽象概念。也许存储过程是最好的方法，从那时起您可以更精确地定义您的逻辑。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T16:07:28.317

除非您已经定义了特定的数字布局（看起来像您一样），否则有一个包含所有可能性的表格（虽然不是很省时），您可以执行以下操作：

获取一个包含所有可能名称的表PossibleEntries，然后执行以下操作：

```
SELECT pe.WebID from PossibleEntries pe 
WHERE pe.WebID Not In (Select WebID from SampleData) 
```

我认为这应该有效，但我不知道它的效率如何。我同意上述观点，如果数字不连续，您将无法执行此操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T17:05:08.870

就个人而言，我会在 PHP 或您使用 SQL 的任何编程语言中执行此操作。如果您无法为每个可能的值创建一个单独的表（顺便说一句，为什么不呢？），那么我将采取的方法是进行简单的查询以获取表中的值：

```
select WebID from table order by WebID; 
```

然后使用一个简单的循环来查找缺少哪些。例如，在 php 中：

```
$values = Array();
$query = "select WebID from table order by WebID;";
$dataset = mysql_query ($query) or die (mysql_error());
while ($data = mysql_fetch_assoc($dataset))
{
  $values[$data['WebID'] = 1;
}

$last_line = $data['WebID'];
$matches = Array();
ereg("S([0-9]+)", $last_line, $matches))

$max_value = $matches[0];
$missing = Array();

for ($count = 0; $count < $max_value; $count ++)
{
  if (!isset($values[$count])
  { 
    echo "value $count is missing\n";
    $missing[$count] = true;
  }
} 
```

我还没有测试过，但如果你碰巧在使用 PHP，那么它可能会满足你的需求。

本

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T18:32:39.287

我的猜测是您的数据库存在严重的设计缺陷，因为看起来您的 WebID 实际上至少是您组合在一起的两列。数字部分显然具有某种含义，因为您希望它是连续的，但如果是这种情况，那么“S”是什么意思？由于这个设计缺陷，您的问题的解决方案将比它需要的更复杂。此外，您说存储对数据库重要的数据是不“实际的”，这是一个很大的危险信号。

除此之外，以下查询应为您提供任何缺失值：

```
SELECT
     (
          SELECT
               SUBSTRING(MAX(T4.WebID), 1, 1) +
               RIGHT('000' + CAST(CAST(SUBSTRING(MAX(T4.WebID), 2, 3) AS INT) + 1 AS VARCHAR), 3)
           FROM My_Table T4
           WHERE T4.WebID < T1.WebID
     ) AS min_range,
     SUBSTRING(T1.WebID, 1, 1) + RIGHT('000' + CAST(CAST(SUBSTRING(T1.WebID, 2, 3) AS INT) - 1 AS VARCHAR), 3) AS max_range
FROM
     My_Table T1
LEFT OUTER JOIN My_Table T2 ON
     T2.WebID = SUBSTRING(T1.WebID, 1, 1) +
                RIGHT('000' + CAST(CAST(SUBSTRING(T1.WebID, 2, 3) AS INT) - 1 AS VARCHAR), 3)

WHERE
     T2.WebID IS NULL AND
     T1.WebID <> (SELECT MIN(WebID) FROM My_Table) 
```

它为您提供了每个缺失值范围的开始和结束，而不是每个缺失值的不同列表。为此，您需要一个 cindi 和 Rob 已涵盖的数字表。

# parsing - parse html code to find a field

> ID：403303
> 
> 赞同：1
> 
> 时间：2008-12-31T16:02:58.810
> 
> 标签：parsing

I have these page [http://www.elseptimoarte.net/](http://www.elseptimoarte.net/). The page have a search field, If I put for instance "batman" it give me some searchs results with a url of every result: [http://www.elseptimoarte.net/busquedas.html?cx=003284578463992023034%3Alraatm7pya0&cof=FORID%3A11&ie=ISO-8859-1&oe=ISO-8859-1&q=batman#978](http://www.elseptimoarte.net/busquedas.html?cx=003284578463992023034%3Alraatm7pya0&cof=FORID%3A11&ie=ISO-8859-1&oe=ISO-8859-1&q=batman#978)

I would like to parse the html code to get the url for example of the firse link: Example: www.elseptimoarte.net/peliculas/batman-begins-1266.html

The problem it is that I use curl (in bash) but when I do a curl -L -s [http://www.elseptimoarte.net/busquedas.html?cx=003284578463992023034%3Alraatm7pya0&cof=FORID%3A11&ie=ISO-8859-1&oe=ISO-8859-1&q=batman#978](http://www.elseptimoarte.net/busquedas.html?cx=003284578463992023034%3Alraatm7pya0&cof=FORID%3A11&ie=ISO-8859-1&oe=ISO-8859-1&q=batman#978) it doesn't give the link.

Any help?

Many thanks and sorry for my english!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T16:16:53.883

您无法使用 cURL 获取链接，因为该页面使用 Javascript 来获取该数据。

使用 FireBug，我发现真正的 URL 在[这里](http://www.google.com/cse?cx=003284578463992023034%3Alraatm7pya0&cof=FORID%3A11&ie=ISO-8859-1&oe=ISO-8859-1&q=batman&ad=w9&num=10&rurl=http%3A%2F%2Fwww.elseptimoarte.net%2Fbusquedas.html%3Fcx%3D003284578463992023034%253Alraatm7pya0%26cof%3DFORID%253A11%26ie%3DISO-8859-1%26oe%3DISO-8859-1%26q%3Dbatman)- 非常可怕！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T16:34:05.173

这可能不是您正在寻找的东西，但它给了我与您的示例相同的响应。也许您可以调整它以满足您的需求：

在 bash 中，键入：

```
$ wget -U 'Mozilla/5.0' -O - 'http://www.google.com/search?q=batman+site%3Awww.elseptimoarte.net' | sed 's/</\
</g' | sed -n '/href="http:\/\/www\.elseptimoarte\.net/p' 
```

"</g" 开始一个新行。不要包括提示符 ($)。更熟悉 sed 的人可能会比我做得更好。您可以替换查询字符串“batman”和/或重复的站点 url 字符串以满足您的需要。

以下是我的输出：

```
<a href="http://www.elseptimoarte.net/peliculas/batman-begins-1266.html" class=l>
<a href="http://www.elseptimoarte.net/peliculas/batman:-the-dark-knight-30.html" class=l>El Caballero Oscuro (2008) - El Séptimo Arte
<a href="http://www.elseptimoarte.net/-batman-3--y-sus-rumores-4960.html" class=l>&#39;
<a href="http://www.elseptimoarte.net/esp--15-17-ago--batman-es-lider-y-triunfadora-aunque-no-bate-record-4285.html" class=l>(Esp. 15-17 Ago.) 
<a href="http://www.elseptimoarte.net/peliculas/batman-gotham-knight-1849.html" class=l>
<a href="http://www.elseptimoarte.net/cine-articulo541.html" class=l>Se ponen en marcha las secuelas de &#39;
<a href="http://www.elseptimoarte.net/trailers-de-buena-calidad-para--indiana--e--batman--3751.html" class=l>Tráilers en buena calidad de &#39;Indiana&#39; y &#39;
<a href="http://www.elseptimoarte.net/usa-8-10-ago--impresionante--batman-sigue-lider-por-4%C2%AA-semana-consecutiva-4245.html" class=l>(USA 8-10 Ago.) Impresionante. 
<a href="http://www.elseptimoarte.net/usa-25-27-jul--increible--batman-en-su-segunda-semana-logra-75-millones-4169.html" class=l>(USA 25-27 Jul.) Increíble. 
<a href="http://www.elseptimoarte.net/cine-articulo1498.html" class=l>¿Aparecerá Catwoman en &#39; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-01T09:18:38.483

curl 和 wget 有很多用途。我相信人们有他们的偏好，但我倾向于先去 wget 进行爬行，因为它可以自动跟踪到指定深度的链接，并且在我使用 curl 时往往对常见的文本网页更加通用当我需要一个不太常见的协议或者我必须与表单数据交互时。

如果你有一些偏好，你可以使用 curl，虽然我认为 wget 更适合。在上面的命令中，只需将“wget”替换为“curl”，将“-U”替换为“-A”。省略“-O -”（我相信 curl 默认为标准输出，如果不在您的机器上，请使用其适当的标志）并保持其他所有内容相同。你应该得到相同的输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T10:04:33.773

Java有[Watir](http://wtr.rubyforge.org/)

如果您使用的是 .NET C#/VB，您可以使用[WatiN](http://watin.sourceforge.net/)，它是一个很棒的浏览器操作工具。

它是一种测试框架，带有用于操作浏览器 DOM 并围绕它进行操作的工具，但我相信您也可以在“测试”上下文之外使用这些工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T16:08:12.043

I'll give you a more thorough command-line answer in a second, but in the mean time, have you considered using Yahoo Pipes? It's little more than a proof-of-concept now, but it has everything you need.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T23:48:54.983

佩佩，

这是您可以用来获得所需内容的命令：

```
$ wget -U 'Mozilla/5.0' -O - 'http://www.google.com/search?q=batman+site%3Awww.elseptimoarte.net' | sed 's/</\                                                            
</g' | sed -n 's/<a href="\(http:\/\/www\.elseptimoarte\.net[^"]*\).*$/\1/gp' > myfile.txt 
```

这是对上述命令的轻微改动。在 url 之间放置换行符，但更改它以提供准确的输出并不难。

# php - PHP - Javascript 控件

> ID：403310
> 
> 赞同：1
> 
> 时间：2008-12-31T16:05:25.810
> 
> 标签：php, javascript, controls

我目前正在用 PHP 开发（另一个）开源 CMS，我想使用 javascript 控件，特别是用于管理面板。问题是，是否有任何具有 PHP 接口的开源、可自由分发的控件（用于创建 javascript 可编辑网格、树、选项卡等）？

我过去曾尝试过[ExtJs](http://extjs.com/)，但尽管在用 php 实现它时它的可用性和美感，但令人沮丧。我也尝试过 PHP-EXT 和 ExtPHP 库，但我对它们生成的代码、ExtJs 的有限实现以及缺乏适当的文档感到失望。

[Coolite](http://www.coolite.com/)是 .NET 的一个很好的实现，但我还没有找到任何与 php 类似的东西。考虑到市场上 php 开发的多年，这让我感到惊讶。

当然，总是可以选择为每个组件实现不同的库，但这将成为一项艰巨的任务，除了将出现的不兼容性和外观差异之外。

有什么建议么？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T16:24:11.870

我真的很喜欢带有新[jQuery](http://jquery.com/) [UI](http://ui.jquery.com/)的 jQuery 。此外，浏览他们的[插件列表](http://plugins.jquery.com/)以获取更多工具。

但你可能也喜欢[mootools](http://mootools.net/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T16:37:37.803

最好的办法就是自己编写 JS 库和 PHP 之间的 JavaScript 交互。整体生成的代码永远不会完全改变，大多数 JS 库只需要一天的时间来学习如何使用。

最好的办法是使用 jQuery 和 jQuery UI，因为它有很多文档和支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T16:30:12.297

您可能还喜欢[Yahoo!](http://developer.yahoo.com/yui/) 可能更接近 Coolite 的[用户界面库。](http://developer.yahoo.com/yui/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T17:51:32.117

我见过一个用于生成厚客户端 Web 应用程序的框架，称为[Cappuccino](http://cappuccino.org/)。对于您想要实现的目标可能有点过头了，但演示看起来很美味。

# nant - 如何使用 nAnt 将文件复制到非域机器

> ID：403318
> 
> 赞同：2
> 
> 时间：2008-12-31T16:07:01.797
> 
> 标签：nant

我有一个 nAnt 脚本，可以完美地构建网站并将其复制到另一台域机器。但是，当我尝试将网站复制到不在域中的计算机上时，会出现安全错误。

我知道这是因为我设置为运行 nAnt 的用户在远程计算机上没有权限。

尝试将文件复制到非域计算机时，是否可以指定远程用户进行身份验证？在 nAnt 官方文档中似乎没有任何选项。

还有哪些其他选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T23:08:55.253

我们通过在副本中涉及的所有服务器上拥有一个具有相同用户名和密码的帐户来解决这个问题。然而，我们反其道而行之。我们从工作组中的机器复制到域中的机器，它工作正常。

例如工作组计算机上的用户帐户：.\CruiseControl password1

域上的用户帐户：域\CruiseControl 密码1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-05T12:07:54.753

我偶然发现了同样的问题。最终使用[PsExec](http://technet.microsoft.com/en-us/sysinternals/bb897553)调用 XCOPY。工作正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T16:39:41.590

我回答[了一个](https://stackoverflow.com/questions/344591/how-to-use-nant-teamcity-to-deploy-across-dmz#347775)与此类似的问题。

可以使用 exec 任务启动[runas](http://technet.microsoft.com/en-us/library/bb490994.aspx)命令，将文件复制（或 xcopy）到具有不同用户名/密码的计算机上。如果这是一个非域帐户，您可能必须使用本地管理员帐户进行身份验证。我不是100％的那个。

这应该允许您留在 NAnt 内。如果这还不够，请告诉我，我们可以尝试解决其他问题。

# user-interface - 错误消息应该有多详细？

> ID：403333
> 
> 赞同：7
> 
> 时间：2008-12-31T16:12:56.340
> 
> 标签：user-interface, error-handling, custom-errors

我想知道关于错误消息的普遍共识是什么。它们应该有多详细？

我参与过一些项目，其中输入一个太大、太小、有小数、是字符串等的数字时会出现不同的错误消息。这对用户来说非常好，因为他们知道哪里出了问题，但错误处理代码开始在大小上与实际业务逻辑相媲美，并开始开发一些自己的错误。

另一方面，我从事过一个项目，您会遇到非常普遍的错误，例如

> 编译失败原因 3

不用说几乎完全没用，因为原因 3 原来意味着链接错误。

那么中间地带在哪里呢？我如何知道我是否添加了足够多的描述性错误消息？我如何知道用户是否能够理解他们哪里出错了？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-31T16:20:24.110

错误消息有两种可能的目标受众，用户和开发人员。

通常应该让消息针对用户。

o 问题的原因是什么。
o 为什么程序不能解决问题
o 用户可以做些什么来解决问题。
o 如何报告问题。

如果要报告问题，报告应包括尽可能多的程序上下文信息。

o 模块名称
o 函数名称
o 行号
o 问题的一般领域中感兴趣的变量
o 甚至可能是核心转储。

瞄准正确的受众。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-31T16:19:17.747

你应该用尽可能少的语言来传达发生了什么，以及用户的选择是什么。错误消息越长，用户阅读它的可能性就越小。出于同样的原因，简短的错误消息是神秘而无用的。在长度方面有一个最佳点，并且在每种情况下都不同。

太短：

> 输入无效。

太长：

> 请输入格式正确的 IP 地址，例如 192.168.0.1。IP 地址是用于在网络上识别您的计算机的数字。

正好：

> 请输入有效的 IP 地址。

就代码膨胀而言，如果一些额外的代码会阻止用户致电支持或感到沮丧，那么这是一项很好的投资。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-31T16:20:45.730

有两种类型的错误消息：用户可以看到的错误消息和程序员可以看到的错误消息。

“我怎么知道用户是否能够理解他们哪里出错了？” 我假设这些消息只会被用户看到，而不是非常技术性的消息，`COMPILE FAILED REASON 3`也不是典型的最终用户错误消息。这是程序员会看到的东西（用户通常不会编译东西）。

因此，如果是用户会看到它：

1.  提供简短的“这是一条错误消息”（“操作！出了点问题！”等）
2.  提供错误的简短通用描述（“您尝试连接的站点似乎不可用”/“您似乎没有足够的权限来执行 XYZ 任务”/等等。）
3.  添加一个“详细信息>>”按钮，以防您的用户碰巧对计算机有很好的理解，包括详细信息（异常堆栈跟踪、错误代码等）

最后，为用户提供一些简单易懂的命令（“再试一次”、“取消”等）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-31T16:21:17.820

关于错误消息的真正问题是是否应该显示它们。向用户显示了许多错误消息，但他们无法更正它们。

只要有办法纠正错误，就可以向用户提供足够的信息，让他们自己纠正错误。如果他们无法自行纠正，是否有任何理由告诉他们崩溃的技术原因？不只是将其记录到文件中以便以后进行故障排除。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-31T16:21:48.100

尽可能详细；）

我知道这听起来像是一个聪明的答案，但这在很大程度上取决于您的目标受众和错误的类型。对于由无效用户输入引起的错误，您可以向他们展示什么是有效输入。对于用户无法控制的错误，通用的“我们正在处理它”类型的消息可能会起作用。

我也同意 Jon B 关于长度的评论。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-31T16:25:40.557

错误消息应该详细但清晰。这可以通过组合来自多个级别的错误消息来实现：

```
Failed to save the image
Permission denied: /foo.jpg 
```

这里我们有两个层次。可以有更多。首先我们讲大局，然后我们讲细节。顺序是这样的，首先我们有大多数人理解的部分，然后是较少人理解的部分，但两者仍然可以看到。

此外，可能会有修复建议。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T16:20:41.240

我会在更详细的方面犯错，但我认为你回答了你自己的问题。为了避免代码膨胀，请在代码/错误消息中提供有用的信息，但您可以在文档中或帮助文件或常见问题解答中提供更多详细信息。

在我看来，信息太少会更糟。

如果您使用的是具有丰富自省或其他功能的语言，则带有未通过检查的行的日志将很有用。然后，用户可以转发给技术支持或以其他方式获取详细信息，这不是额外的代码膨胀，而是使用您自己的代码来提供信息。

# sql - 在 JPA 中获取查询交集？

> ID：403336
> 
> 赞同：1
> 
> 时间：2008-12-31T16:14:50.750
> 
> 标签：sql, jpa

我有：“图像”1：许多“imageToTag”许多：1“标签”

我想发出一个查询，该查询将返回*至少*具有标签 [a, b, c] 的所有图像。我不清楚如何在 JPQL 中对此进行建模。我可以动态构建查询字符串，但这对性能和安全性不利。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T18:20:17.160

在**伪代码中：**

```
SELECT * FROM IMAGES 
  INNER JOIN IMAGETAGS A
    ON IMAGE.ID = A.IMAGEID AND A.TAGID = 'A'
  INNER JOIN IMAGETAGS B
    ON IMAGE.ID = B.IMAGEID AND B.TAGID = 'B'
  INNER JOIN IMAGETAGS C
    ON IMAGE.ID = C.IMAGEID AND C.TAGID = 'C' 
```

只是猜测，但 JPQL 中的等价物是

```
Select img from Image img 
 JOIN img.tag ta 
 JOIN img.tag tb 
 JOIN img.tag tc 
  WHERE ta.description = 'A' and tb.description = 'B' and tc.description = 'C' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T20:45:33.187

这是jpa查询语言怎么样

```
Select img from Image img where img.tag.description in ('A','B','C'); 
```

# com - C# Visual Studio: How to have multiple developers on a solution that references Office?

> ID：403338
> 
> 赞同：3
> 
> 时间：2008-12-31T16:14:59.923
> 
> 标签：com, interop, automation, ms-office

When I add a reference to Office COM Library, I to go:

*   References
*   Add Reference
*   Select the **COM tab**
*   Select **Microsoft Office 12.0 Object Library**

And magically named reference appears:

Microsoft.Office.Core

The **Project.csproj** file shows the details of the reference:

```
<COMReference Include="Microsoft.Office.Core">
   <Guid>{2DF8D04C-5BFA-101B-BDE5-00AA0044DE52}</Guid>
   <VersionMajor>2</VersionMajor>
   <VersionMinor>4</VersionMinor>
   <Lcid>0</Lcid>
   <WrapperTool>primary</WrapperTool>
   <Isolated>False</Isolated>
</COMReference> 
```

i check the project into source control, and now nobody else can build the solution; they do not have Office 12, they only have Office 11\.

Another guy checks out the .csproj file, deletes the reference to:

```
Microsoft Office 12.0 Object Library 
```

and re-adds the COM reference as:

```
Microsoft Office 11.0 Object Library 
```

After that, and new reference appears in the Solution:

```
Microsoft.Office.Core 
```

and the `Project.csproj` file shows the details of the reference:

```
<COMReference Include="Microsoft.Office.Core">
  <Guid>{2DF8D04C-5BFA-101B-BDE5-00AA0044DE52}</Guid>
  <VersionMajor>2</VersionMajor>
  <VersionMinor>3</VersionMinor>
  <Lcid>0</Lcid>
  <WrapperTool>primary</WrapperTool>
  <Isolated>False</Isolated>
</COMReference> 
```

**Note:** Readers who read the question will understand the problem. It's the same type library, but version 2.3 as opposed to version 2.4.

The project is then checked into source control, and now developers with Office 2007 (and Office 2000 for that matter) cannot build it, because Visual Studio cannot resolve the reference to:

```
{2DF8D04C-5BFA-101B-BDE5-00AA0044DE52}\2.3\0\primary 
```

* * *

We obviously need a version independant way to reference Office.

How do we reference the version of Office that the developer building it on his machine has intsalled?

How do we have multiple developers work on a solution that references Office?

* * *

**Note:** This question is identical to, but fundamentally different from, another Stackoverflow question [How to use Office from Visual Studio C#?](https://stackoverflow.com/questions/401637/how-to-use-office-from-visual-studio-c)

That question deals with the entire set of problems from trying to use Office from Visual Studio. This question only focuses on one specific problem.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T16:19:40.787

抽象您的代码，以便所有涉及 Office 的代码都在一个单独的项目中。然后您可以有两个项目 - 一个用于 Office 11，一个用于 Office 12。然后从您的应用程序中引用这两个项目。如果两个类都实现了一个通用接口，那么您可以使用工厂模式来实例化适当的接口并使用这些特性而无需重新编译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T16:29:45.557

您可能可以为此使用后期绑定。

看看这里： [http ://www.hanselman.com/blog/BackToBasicsVarDim.aspx](http://www.hanselman.com/blog/BackToBasicsVarDim.aspx)

或在这里：http: [//support.microsoft.com/kb/302902](http://support.microsoft.com/kb/302902)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T16:32:47.453

后期绑定到存在的任何类型库，以及针对旧接口的代码 - 如果您使用的是 v11 接口，那么当您在机器上安装 v12 时应该没问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T16:36:05.403

如果您将接口抽象为一个单独的项目，那么您可以使用 vb.net 及其内置的后期绑定支持来提供功能和管理资源。

# linux - 窗口放置：适用于 Linux (KDE) 的类似 WinSplit Revolution 的应用程序？

> ID：403348
> 
> 赞同：6
> 
> 时间：2008-12-31T16:18:12.040
> 
> 标签：linux, user-interface, kde

什么是类似 WinSplit Revolution 的 Linux (KDE) 应用程序？或者也许我缺少 KDE 中的某个功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T16:27:10.820

我猜这不是一个真正与编程相关的问题。

无论如何......似乎有一个名为[grid](http://wiki.compiz-fusion.org/Plugins/Grid)的 compiz-fusion 插件，根据作者的说法，它基于 WinSplit Revolution 提供的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T16:40:02.400

平铺通常是窗口管理器的功能。据我所知，KWin 不做平铺。不过，那里有许多平铺管理器：

*   dwm (C) (( 也是，由于简单，我更喜欢什么 ))
*   xmonad (haskell)
*   很棒（我认为 lua，基于 dwm）
*   wmii (C) ((“老大哥”转dwm))

另外，我不知道这是否是谣言，但我听说过几次 Openbox 将获得平铺功能。您可以使用 openbox 作为 WM 运行 KDE 桌面。这将允许您拥有平铺 + 桌面环境

但是是的..与编程无关

# c++ - unicode char 与非 unicode char 比较，但没有警告也没有错误

> ID：403349
> 
> 赞同：1
> 
> 时间：2008-12-31T16:18:44.067
> 
> 标签：c++, string, unicode

为什么下面的代码没有给出错误，也没有任何类型的关于隐式转换的警告？

```
std::wstring str = L"hi";
if(str[0] == 'h')
      cout<<"strange"<<endl; 
```

正确的正常代码是：

```
std::wstring str = L"hi";
if(str[0] == L'h')
      cout<<"strange"<<endl; 
```

编译器：视觉工作室 2005

警告级别：4级（最高）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-31T16:23:26.880

它不会发出警告，因为比较是有效的。通常，您始终可以比较整数类型，它们只是根据需要提升为更广泛的类型。

而且我很确定一些编译器会对此发出警告。你用的是哪一个？（在任何情况下，警告都是特定于编译器的，它们不需要警告这个或其他任何事情）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T16:23:58.893

> 为什么下面的代码没有给出错误...

不是因为 C++ 允许隐式转换吗？例如，以下内容是否也合法：

```
if (str[0] == 104) //C++ allows various implicit type conversions 
```

> ...也没有任何关于隐式转换的警告？

这个问题是特定于编译器的：您使用的是哪个编译器？可能有一个编译器选项会影响您从编译器获得的警告类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-02T14:09:47.903

很难确定为什么编译器不发出警告。他们可能出于任何原因这样做，并且在代码可疑时应该这样做。但是，由于代码在技术上是正确的，因此会出现错误。

在这种情况下，我的假设是编译器不会发出警告，因为编译器使用 Unicode`wchar_t`和 ISO-8859-1 字符。Unicode 子集 U+0000 到 U+00FF 等于 ISO 8859-1 字符 0-FF。因此，每个 char 都具有与其对应的 wchar_t 相同的数值。结果，`wchar_t('a')==L'a'`.

# javascript - Mozilla 客户端 XSLT 不显示。（也使用 jQuery）

> ID：403351
> 
> 赞同：1
> 
> 时间：2008-12-31T16:19:23.567
> 
> 标签：javascript, jquery, firefox, xslt

我想使用 firebug 来调试并帮助快速完成一些 XSLT 布局问题，但我无法获得以下代码来在 Firefox 中执行和显示客户端 XSLT（在 IE 中一切都很好）：

```
$().ready(function() {

   var oXMLHTTP
   var oXSLT

   if ($.browser.mozilla){
     oXMLHTTP = document.implementation.createDocument("","",null);
     oXSLT = document.implementation.createDocument("","",null);
   }else{            
     oXMLHTTP = new ActiveXObject("Microsoft.XMLDOM");
     oXSLT  = new ActiveXObject("Microsoft.XMLDOM");
   }
   oXMLHTTP.async = false; 
   oXSLT.async = false;
   oXSLT.load('Layout.xslt');

   var sURL = "somepage"

   /**/
   $.get(sURL,function(data){
      var sTranformedXML = "";
      if ($.browser.mozilla){
         oXMLHTTP.load(data);
         var xsltProcessor = new XSLTProcessor();
         xsltProcessor.importStylesheet(oXSLT);
         var mDoc = document.implementation.createDocument("","",null);
         sTranformedXML = xsltProcessor.transformToFragment(oXMLHTTP,mDoc);
      }else{
         oXMLHTTP.loadXML(data);
         sTranformedXML = oXMLHTTP.transformNode(oXSLT)
      }
      $("#main").html(sTranformedXML);
      $("#tbl_Not Grouped").insertAfter("tbl_Social Sciences");
   })// $.get           
}) 
```

有什么我在这里忽略的吗？

我真的只需要 Firefox 代码测试。所以，它不需要漂亮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T21:21:17.050

这本身并不能真正回答您的问题，但您可以考虑查看 Google AJAXSLT，它包含了各种浏览器的功能并“填补了空白：”[链接](http://goog-ajaxslt.sourceforge.net/ "关联")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T10:46:07.060

众所周知，Gecko 的 XSL-T 实现会错误地处理默认名称空间。尝试在 XML 文档中添加前缀元素和/或在 XSL 文档中的 XPath 查询中添加前缀元素（不要忘记绑定新前缀）

# .net - 如何通过 WCF 使用 LinqToSql 维护子对象？

> ID：403365
> 
> 赞同：3
> 
> 时间：2008-12-31T16:22:28.817
> 
> 标签：.net, wcf, linq-to-sql, data-access-layer

我目前被困在这个解决方案的设计中。

数据层设计包括以下内容：

*   配方（父高级对象）
    *   语言详细信息（名称，按语言描述）（很多）
        *   标头（很多）
        *   步骤（很多）
            *   成分（很多）
            *   数量（许多）
            *   手续（多）
        *   笔记（很多）

我面临的挑战是如何创建一个数据访问设计，当从 WCF SaveRecipe(recipe) 方法填充对象时，该设计将添加/删除数据库中的子对象？

这都是因为管理层要求我们在应用中增加一个通信层，现在我们的UI耦合到我们的业务层，而BL直接耦合到DAL，我们基本上需要在BL和DAL之间注入WCF .

我在[这个线程](https://stackoverflow.com/questions/135339/linqtosql-and-wcf)中读到，使用 L2S 不是 WCF 的好主意，但由于设计不是新的，我们必须使用这种类型的方法，然后一旦我们可以重构大量用户界面工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T16:34:07.623

如果您尝试使用 WCF 发送内容，我建议您创建一个要在域中移动的数据模型。据我发现，您无法序列化 IQueryable 对象，但您可以创建一组 Linq 填充的类，然后对其进行序列化。例如：

```
[DataContract]
public class Recipe {

    [DataMember]
    public string Name { get; set; }

    [DataMember]
    public string Description { get; set; }

    [DataMember]
    public List<Ingredient> Ingredients { get; set; }

} 
```

然后用

```
List<Recipe> recipes = (from r in dc.recipe
                           select new Recpie {
                               Name = r.name,
                               Description = r.description,
                               Ingredients = (Linq code to make list of ingredients)
                           }).ToList(); 
```

然后使用 WCF 发送列表就变得轻而易举了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T16:32:28.640

我喜欢 Karl 在您引用的[线程](https://stackoverflow.com/questions/135339/linqtosql-and-wcf)上的回答：

> 最好创建自己的类来传输数据对象。当然，这些类将作为 DataContracts 实现。在您的服务层中，您将在 linq-to-sql 对象和数据载体对象的实例之间进行转换。这很乏味，但它将服务的客户端与数据库模式分离。它还具有让您更好地控制系统中传递的数据的优势。

看起来你无论如何都必须重构——就像在你的 UI 层中重构对 linq2sql 的依赖一样开始。

我认为您没有快速简便的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T16:35:09.120

我不建议通过 WCF 公开 L2S 类。创建 DataContract 对象的层次结构，并通过 WCF 传递这些对象。这样做的缺点是您必须将 L2S 对象“深度复制”到 DataContract 层次结构中，但好处是您只能包含通过网络传输所需且适当的字段。例如，在我现在正在处理的一个项目中，我通过网络传递了一个 EmployeeData 对象，该对象包括我的大部分 L2S 员工字段，但不包括员工的加盐哈希和密码盐之类的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T16:45:23.873

创建包含和排除子条目的类也可能是一个想法。我有时会创建这样的类：

```
class Recipe {
    [DataMember] public string Name;
    [DataMember] public string Description;
}

class RecipeWithIngredients : Recipe {
    [DataMember] public IList<Ingredient> Ingredients;
} 
```

编辑：在帖子完成之前无意中发布。

# javascript - Javascript/Ajax - 从 Sys.EventHandlerList() 中手动删除事件处理程序

> ID：403370
> 
> 赞同：1
> 
> 时间：2008-12-31T16:25:27.920
> 
> 标签：javascript, ajax, event-handling, scriptcontrol

我有两个脚本控件，一个持有另一个，并且我已经成功地能够使用以下方法处理来自父级的子级事件：

```
initialize: function() 
{
    this._autoComplete = $get(this._autoCompleteID);

    this._onAutoCompleteSelected = Function
      .createDelegate(this, this.handleAutoCompleteSelected);

    var autoControl = this._autoComplete.control;
    autoControl.addItemSelected(this._onAutoCompleteSelected);
    ...
} 
```

其中 addItemSelected(on the child) 是：

```
addItemSelected: function(handler) 
{

    list = this.getEvents();
    list.addHandler('userItemSelected', handler);

}, 
```

和 getEvents 是：

```
getEvents: function() 
{

    if (this._events == null) 
    {
        this._events = new Sys.EventHandlerList();
    }

    return this._events;
}, 
```

问题是在处置父母时，我想做同样的事情：

```
dispose: function() 
{
    var autoControl = this._autoComplete.control;
    autoControl.removeItemSelected(this._onAutoCompleteSelected);
    ...
} 
```

但是，.control 不再存在。我猜这是因为子控件已经被释放，因此 .control 属性不再起作用。

鉴于此，我决定运行子事件列表并删除其中的所有事件处理程序。

```
dispose: function() 
{
    list = this.getEvents();
    for(var item in list._list)
    {
        var handler;

        handler = list.getHandler(item);

        list.removeHandler(item, handler);
    }

    ....
} 
```

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-09T14:50:17.310

I'm not sure that the "control" expando property on the DOM element is the right way to reference the control object. It is managed by the framework and as you're seeing, I think it's already munged by the time your dispose is called.

Have you tried using `$find` instead of `$get` and reworking your references this way?:

```
initialize: function() 
{
    this._autoControl = $find(this._autoCompleteID);

    this._onAutoCompleteSelected = Function
      .createDelegate(this, this.handleAutoCompleteSelected);

    this._autoControl.addItemSelected(this._onAutoCompleteSelected);
}

dispose: function() 
{
    this._autoControl.removeItemSelected(this._onAutoCompleteSelected);
    this._autoControl = null;
} 
```

Oh yeah and where you reference the DOM element stored in `this._autoComplete` you instead go through the control object itself:

```
this._autoControl.get_element(); 
```

So basically invert the logic of "get element => get control object" to "get control object => get element".

# php - 如何使用 php 旋转 pdf 文档？

> ID：403372
> 
> 赞同：5
> 
> 时间：2008-12-31T16:25:56.407
> 
> 标签：php, pdf

如何使用 php 和 linux 旋转 pdf 文档？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-21T04:36:15.033

将整个 PDF 文档的页面旋转 180 度

```
 $command = "pdftk in.pdf cat 1-endS output out.pdf";
 system($command); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T11:06:04.700

您可以使用 PDFjam 中的[pdf90](http://go.warwick.ac.uk/pdfjam)。

要解决其他一些建议：

*   我会警惕直接调整 Rotate 属性，因为此属性存储为文本，而“90”或“270”显然使用与“0”不同的字节数。我相信插入所需的字节会使出现在 PDF 文件末尾的索引表变得一团糟。之后，您将依赖能够解释损坏文件的查看器。

*   将 PDF 渲染为图像并旋转将光栅化任何文本或矢量图形，从而导致文件更大或质量更低。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T16:31:37.003

您必须使用这样的外部库[来](http://www.tecnick.com/public/code/cp_dpage.php?aiocp_dp=tcpdf)提取信息并生成图像，然后将其放回 pdf（或新的）

编辑：如果您要获得徽标或图表，这是一个不错的选择，如果它是一个带有文本和大量图像的大文档......这将非常困难，您能否编辑 OP 并提供有关您的内容的更多信息需要？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T20:51:55.997

您必须以二进制文件的形式访问 PDF，然后查找并调整每个页面的“Rotate”属性（可能还有“MediaBox”属性）。我不知道任何允许对现有文件进行这种直接操作的 PHP 的 PDF 库。此方法不需要更改有关页面内容的任何内容，它只是更改查看者显示页面的方向（类似于 JPEG 图像中的 EXIF 方向信息）。

[这个 perl 片段](http://www.perlmonks.org/?node_id=485615)应该有助于说明您正在查找文件的哪些部分。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-24T11:13:46.247

有一些库可以用 PHP 处理 PDF。

这是使用此类库的一个很好的代码示例。我通过谷歌搜索“PHP PDF”找到了它：

[http://www.fpdf.org/en/script/script2.php](http://www.fpdf.org/en/script/script2.php)

# java - Java找不到符号编译错误

> ID：403378
> 
> 赞同：0
> 
> 时间：2008-12-31T16:27:29.307
> 
> 标签：java, eclipse, classpath

Java新手。我想使用 org.apache.commons.lang.WordUtils 包。尝试导入它。尝试下载它并将其添加到我的构建路径中。当我对 Eclipse auto 这个词使用智能感知时，`WordUtils`会将 import 语句放在文件的顶部。

编译时出现以下错误：

```
ConvertToUrl.java:3：包 org.apache.commons.lang
导入 org.apache.commons.lang.WordUtils；
                              ^

ConvertToUrl.java:36：找不到符号
符号：变量 WordUtils
位置：类 d6.common.ConvertToUrl
                url = WordUtils.capitalizeFully(url);
                      ^
2 个错误

```

当我删除顶部的导入语句时，我得到：

```
ConvertToUrl.java:34：找不到符号
符号：变量 WordUtils
位置：类 d6.common.ConvertToUrl
                url = WordUtils.capitalizeFully(url);
                      ^
1 个错误

```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T16:36:01.503

那是正确的 java，正确使用 WordUtils 函数。这很可能是一个日食问题。我会检查 jar 是否已导入并且是否在编译路径上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T16:39:49.657

进入您的项目属性并在Java Build Path（我认为）下，您需要将commons jar添加为外部Jar，一旦您在属性中找到正确的选项卡，这非常简单，一旦您可以浏览到您下载 jar 并添加它的位置，这应该可以解决您的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T16:53:34.480

感谢大家。该类位于构建路径中。

我在下面粘贴了我正在使用的类（减去一些不必要的部分）。

正如我所说，Eclipse 在这个导入语句中添加了内容。

```
import org.apache.commons.lang.WordUtils; 
```

如果我已经下载了 JAR，我还需要这个吗？
顺便说一句：我没有使用类路径 101，我只是在进行过程中弄清楚它，对 Java 来说是全新的。

```
package d6.common;

public class ConvertToUrl {
    private static String url;

    public String getUrl() {
        return url;
    }

    public void setUrl(String url) {
        url = WordUtils.capitalizeFully(url);
        this.url = url;

    }
} 
```

谢谢您的帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T17:01:51.047

当你得到编译器错误时，你从哪里得到这个？这是当您尝试在命令行上编译源代码时吗？如果是这样，那么您需要确保 jar 设置在您的 CLASSPATH 变量中或在命令行中使用或添加到您的 build.xml 或设置为您用于编译类的任何机制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T17:14:31.007

Ah fantastic, that was the one Suppressingfire, thanks.

I was compiling via command line. I still need to learn about ant. Am used to php, its a lot simpler to start off with!

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-04T10:54:32.790

如果您使用 ant 脚本在 Eclipse 中构建代码，请检查 build.xml 文件中是否也提到了类路径。您可以在构建文件中的 javac 标记下使用类似的内容。这里的 pathelement 是依赖库：

```
<target name="compile" depends="init" description="compile the source " >
    <javac srcdir="${src}" destdir="${classsfiles}" >
        <classpath>
            <pathelement path="${libdir}/common-io.jar"/>
            <pathelement path="${libdir}/xerces.jar"/>
        </classpath>
    </javac>
</target> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T16:40:44.863

这是类路径 101。包含该类的 JAR 不在构建路径中。在 Eclipse 中添加很容易：右键单击项目属性，它应该在列表中。的选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-31T16:58:12.177

您永远不会“需要”使用单个导入。它所做的只是节省您的输入：您可以在想要使用该类时输入“WordUtils”而不是“org.apache.commons.lang.WordUtils”。

如果您仍然遇到问题，则说明该类不在构建路径中，您仍然必须弄清楚如何将其带到那里。

# tomcat - 我如何知道我的 tomcat Web 应用程序何时停止？

> ID：403379
> 
> 赞同：1
> 
> 时间：2008-12-31T16:27:53.643
> 
> 标签：tomcat

我想在 tomcat 停止我的 Web 应用程序之前获得一个“事件”。
我的应用程序需要在关闭之前“打包”一些东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-01-21T18:04:23.517

一个除了响应什么都不做的 servlet`destroy()`是功能性的，但有点 hack。Servlet 旨在处理 Web 请求。

正确的做法是实现一个[ServletContextListener](http://docs.oracle.com/javaee/5/api/javax/servlet/ServletContextListener.html)并在方法中完成你的工作`contextDestroyed()`。

`ServletContextListener`在 web.xml 中注册您的，例如：

```
<listener>
    <listener-class>com.foo.MyListener</listener-class>
</listener> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T22:04:55.787

我想我找到了，我创建了一个 servlet 并实现了

```
public void destroy(); 
```

我验证了当我从 tomcat 管理页面停止应用程序时调用了这个方法，即使我关闭了 tomcat 服务器

[Servlet 上的 JavaEE 6 文档](http://docs.oracle.com/javaee/6/api/javax/servlet/Servlet.html#destroy%28%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T16:38:56.273

您可以编写一个响应部署/取消部署事件的 ContextListener。也许您可以让它在取消部署上下文时发送一封电子邮件。

我只是不确定如果应用服务器停止，该事件是否会被触发。

# indexing - 索引和聚集索引对数据库性能有多重要？

> ID：403393
> 
> 赞同：3
> 
> 时间：2008-12-31T16:34:25.250
> 
> 标签：indexing, clustered-index

最近有几个关于数据库索引和聚集索引的问题，直到最近几周，这对我来说都是新的。我想知道它的重要性以及创建它们可以获得什么样的性能提升。

**编辑：**当您第一次开始时放入聚集索引时，通常最好查看的字段类型是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-31T16:35:58.650

**非常非常^([A](http://en.wikipedia.org/wiki/Ackermann_function)（[G](http://en.wikipedia.org/wiki/Graham%27s_number)，[G](http://en.wikipedia.org/wiki/Graham%27s_number)）)重要**。在我看来，明智的索引是数据库性能优化中绝对最重要的事情。

这不是一个容易在一个答案中涵盖的主题。良好的索引需要了解数据库上将发生的查询，进行大量权衡并了解特定数据库引擎中特定索引的含义。但这仍然非常重要。

**编辑：**基本上，聚集索引通常应该有很短的长度。它们应该在反映范围的查询上创建。他们不应该有重复的条目。但这些指导方针非常笼统，绝不是正确的。正确的做法是分析将要执行的查询。仔细对执行计划进行基准测试和分析，并了解执行计划的最佳方法。这需要多年的经验和知识，绝不是一个段落就能解释的事情。这是使 DB 专家成为专家的首要因素（这不是唯一的事情，但它对于其他重要的事情是原始的，例如并发问题、可用性......）！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T16:40:07.033

索引：非常重要。拥有错误的索引会使查询变得更加困难，有时甚至无法在合理的时间内完成。

索引也会影响插入性能和磁盘使用（负面），因此在大型表上保留大量多余的索引也是一个坏主意。

集群是值得考虑的事情，我认为它真的取决于特定数据库的行为。如果您可以正确地对数据进行聚类，则可以显着减少满足对不在内存中的行的请求所需的 IOP 数量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T16:37:23.840

如果没有适当的索引，您将强制 RDBMS 进行表扫描以查询任何内容。效率极低。

我还推断您没有主键，这是关系设计中的一个大罪。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T16:42:51.100

当表包含许多行时，索引非常重要。
使用少量 rws，没有索引时性能会更好。
对于较大的表，索引对于获得良好的性能非常重要。
定义它们并不容易。聚集意味着数据以聚集索引顺序存储。
要获得良好的索引提示，您可以使用 Toad

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T16:43:57.963

索引**非常重要**。

查询的正确索引可以显着提高性能，这看起来像是**巫术**。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-31T18:35:00.907

正如其他答案所说，索引至关重要。

正如您可能从其他答案中推断的那样，聚集索引的重要性要小得多。

体面的索引为您提供一阶性能提升 - 数量级很常见。

聚集索引是二阶或增量性能增益 - 通常会提供较小 (<100%) 的性能提升百分比。

（我们还会遇到“什么是 100% 性能提升”的问题；我将百分比解释为 ((oldtime - newtime)/newtime) * 100，所以如果旧时间是 10 秒，新时间是 5秒，性能提升100%。）

不同的 DBMS 对聚集索引的含义有不同的解释。谨防。特别是，一些 DBMS 对数据进行一次聚类，之后聚类会随着时间的推移而衰减，直到数据被重新聚类。我相信，其他人对集群的看法更为积极。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T19:08:21.743

聚集索引通常但并不总是您的主键。查看聚集索引的一种方法是考虑基于聚集索引的值对数据进行物理排序。

实际情况可能并非如此，但是引用聚集索引通常会为您带来以下性能奖励：

1.  当从聚集索引命中解析时，表的所有列都可以免费访问，就好像它们包含在覆盖索引中一样。（仅使用索引数据即可解决的查询，无需重新引用表本身的数据页）

2.  可以直接对聚集索引进行更新操作，无需中间处理。如果您要对表进行大量更新，您通常希望引用聚集列。

3.  根据实现的不同，可能会有顺序访问的好处，其中存储在磁盘上的数据可以通过更少的昂贵磁盘查找操作更快地检索。

4.  根据实施情况，在不需要物理索引的情况下，可能会有免费索引优势，因为可以通过简单的猜谜游戏算法来解决数据访问问题。

不要指望#3，尤其是#4。#1 和 #2 在大多数 RDBMS 平台上通常是安全的选择。

# encryption - 识别加密算法

> ID：403394
> 
> 赞同：2
> 
> 时间：2008-12-31T16:34:55.920
> 
> 标签：encryption

首先，我想问一下你们中是否有人知道使用密钥来加密数据但没有密钥来解密数据的加密算法。这对我来说似乎不太可能，如果不是不可能的话，如果这是一个愚蠢的问题，我很抱歉。

我的最后一个问题是，假设您可以在加密之前访问纯文本数据、用于加密纯文本数据的密钥以及生成的加密数据，那么确定用于加密数据的算法是否可行？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-31T16:45:13.200

> 首先，我想问一下你们中是否有人知道使用密钥来加密数据但没有密钥来解密数据的加密算法。

不会。有些算法使用不同的密钥进行解密而不是加密，但是无密钥方法将依赖于算法的保密性，这通常被认为是一个糟糕的主意。

> 我的最后一个问题是，假设您可以在加密之前访问纯文本数据、用于加密纯文本数据的密钥以及生成的加密数据，那么确定用于加密数据的算法是否可行？

很可能是的，特别是考虑到密钥。一个好的加密算法依赖于密钥的保密性，并且仅依赖于密钥。参见[克尔霍夫原理](http://en.wikipedia.org/wiki/Kerckhoffs%27_principle)。

此外，如果使用通用算法，这将是一个简单的试错问题，而且除了密码文本之外，通常还伴随着元数据，它会告诉你算法的详细信息。

*编辑：根据评论，您可能正在考虑[数字签名](http://en.wikipedia.org/wiki/Digital_signature)（仅在发送方需要秘密）、[哈希算法](http://en.wikipedia.org/wiki/Cryptographic_hash_function)（不需要密钥但不是加密）或[零知识证明](http://en.wikipedia.org/wiki/Zero_knowledge_proof)（可以证明知道一个秘密而不透露它）。*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-01T02:26:29.800

抽象地说，我们可以这样想加密系统：

```
 -------------------
plaintext ---> | algorithm & key | ---> ciphertext
               ------------------- 
```

系统*必须*保证以下几点：

***解密***（***加密***（明文，算法，密钥），算法，密钥）=明文

> 首先，我想问一下你们中是否有人知道使用密钥来加密数据但没有密钥来解密数据的加密算法。

是的，在这样的系统中，密钥是多余的；所有的“秘密”都在于算法。

> 我的最后一个问题是，假设您可以在加密之前访问纯文本数据、用于加密纯文本数据的密钥以及生成的加密数据，那么确定用于加密数据的算法是否可行？

在实践中，您可能只有很小的算法空间，因此简单的蛮力搜索是可行的。但是，可能有不止一种算法适合给定信息。考虑以下示例：

我们定义如下加解密操作，其中明文、密文、算法、密钥为实数（假设算法非零）：

***加密***（明文，算法，密钥）=算法x（明文+密钥）=密文

***解密***（密文、算法、密钥）= 密文/算法 - 密钥 = 明文

现在，假设明文 + 密钥 = 0。对于任何算法选择，我们都有密文 = 0。因此，我们无法推断所使用的算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T17:49:33.447

> First off, I would like to ask if any of you know of an encryption algorithm that uses a key to encrypt the data, but no key to decrypt the data.

What are you getting at? It's trivial to come up with a pair of functions that fits the letter of the specification, but without knowing the intent it's hard to give a more helpful answer.

> say you have access to the plain text data before it is encrypted, the key used to encrypt the plain text data, and the resulting encrypted data, would figuring out which algorithm used to encrypt the data be feasible?

If the algorithm is any good the output will be indistinguishable from random noise, so there is no analytic solution to this. As a practical matter, there are only so many trusted algorithms in wide use. Trying each one in turn would be quick, but would be complicated by the fact that an implementation has some freedom with regard to things like byte order (little-endian vs big-endian), key derivation (if you had a pass-phrase instead of the actual cryptographic key itself), encryption modes and padding.

As frankodwyer points out, this situation is not part of usual threat models. This would work in your favor, as it makes it more likely that the algorithm is a well-known one.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-27T19:27:54.100

如果没有解码器中的已知密钥，您可以做的最好的事情就是添加一些晦涩难懂的东西。例如，如果解码算法的第一步是去除除每 10 个字符之外的所有内容，那么您的编码密钥可用于为每 10 个字符中的 9 个随机垃圾播种。因此，使用不同的密钥，您可以获得不同的编码结果，这些结果将被解码为相同的消息，而解码器不需要密钥。

然而，这并没有增加太多真正的安全性，不应该仅仅依靠它来保护关键数据。我只是在考虑可以这样做的情况，是的，我想可以-如果您只是想证明一个观点或增加一个安全级别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T16:42:47.433

我不相信有这样一种算法会使用密钥进行加密，而不是解密。（愚蠢的答案就像 26 个字符的[凯撒密码](http://en.wikipedia.org/wiki/Caesar_cipher)一样......）

对于你的第二个问题，是的；这仅取决于您愿意花多少时间在上面。在理论密码学中，假设算法总是可以确定的。无论是通过盗窃算法还是物理机器，还是在您的情况下拥有纯文本和密文对。

# c# - C# MySQL 连接问题

> ID：403398
> 
> 赞同：1
> 
> 时间：2008-12-31T16:35:16.093
> 
> 标签：c#, .net, mysql

我正在尝试将 C# 应用程序（使用 Visual C# 2008 Express Edition）连接到远程 MySQL 服务器。我有这个的驱动程序，但是当我按照教程（包括添加池和连接重置属性）时，我收到一个错误：*对象引用未设置为对象的实例。*我已经包含了应该建立连接的两行代码。错误在第二行抛出。

```
 MySqlConnection connect = new MySqlConnection("database=d*******;Data Source=mysql.netfirms.com;user id=*******;pwd=*****;pooling=false;connection reset=false");
        connect.Open(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T17:33:01.890

我会尝试在构造函数之外设置连接字符串以帮助缩小问题范围：

```
MySqlConnection connect = new MySqlConnection();
//Do you get the null exception in this next line?
connect.ConnectionString = "your conn string here";
connect.Open(); //-> If you get the exception here then the problem is with the connection string and not the MySqlConnection constructor. 
```

如果您确实在 connect.ConnectionString = ... 行中遇到异常，那么问题出在驱动程序上，听起来您需要重新安装它。

我也会尝试一个更简单的连接字符串，没有池和重置键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T19:02:25.287

您可以发布更多代码吗？由于编译器优化或相关原因，异常行可能有点偏离。构造函数*必须*返回一个对象或抛出一个异常。这是不可能的

```
MyType item = new MyType();
Debug.Fail(item == null); // will never fail. 
```

空引用可能就在您的实例化上方。

# java - 创建 nunit 测试而不使用 api 导出它们

> ID：403408
> 
> 赞同：0
> 
> 时间：2008-12-31T16:38:12.793
> 
> 标签：java, unit-testing, tdd, nunit

我是使用 nunit（以及一般的 Java 开发）进行单元测试的新手。在为类上的私有方法创建单元测试时，看起来测试文件必须与被测试的类在同一个包中。避免导出单元测试 API 的典型方法是什么？我可以使类/测试方法受包保护吗？还是开发人员通常有一个单独的发布版本，不包括单元测试文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T16:43:05.280

我可以告诉 IntelliJ 或 Ant 不要在部署中打包 JUnit 测试。我在与源代码不同的目录中进行了测试，这使得它成为可能。

不要将源类和测试类混在一起。将它们分开以使您使用的工具/脚本更容易部署。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T16:44:11.020

测试文件不必与被测试的类在同一个包中。事实上，将测试文件放在一个完全独立的包中是一种很好的做法，允许它们测试公共 API 而无需关心包级实现细节。

或者，您可以设置构建脚本（例如 Nant）以在构建发布可执行文件时忽略包含“测试”的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T17:00:03.250

就我个人而言，我的方法只是测试暴露的功能，因此您最终只能测试封装良好的部分。

这通常会导致我的设计包含具有明确定义的功能的小类，这些小类更容易测试。

通常，在进行单元测试时，您不应该关心您正在测试的内部结构，所以我发现这是处理它的最佳方法。

我也同意最好将测试和生产代码分开。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T21:31:59.893

将测试源代码保留在应用程序源代码之外。一般来说，只测试暴露的功能。如果您确实需要测试私有行为，请创建一个扩展真实对象并允许公共访问私有行为的测试对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-02T02:00:21.083

我认为将您的测试代码移出 CUT（被测类）的包是错误的。在某些时候，您可能想要测试受保护的方法或类，而将您的测试代码放在另一个包中会使这变得困难或不可能。

更好的解决方案是为您的测试代码创建一个单独的**目录**，该目录仅反映您的生产代码的包结构。这就是我所做的：

```
src/main/java/com/example/Foo.java
src/test/java/com/example/FooTest.java 
```

`src/test/**`然后，在打包和部署时，您的构建脚本可以非常简单地忽略。

# delphi - Delphi 2009 ShellTreeView/ShellListView 修复

> ID：403411
> 
> 赞同：3
> 
> 时间：2008-12-31T16:39:22.120
> 
> 标签：delphi, delphi-2009

当 Delphi 2009 项目在 IDE 索引中的 mainform 上使用 ShellTreeView/ShellListView 关闭时，会生成越界 (0) 异常。是否有针对 ShellTreeView/ShellListView 的修复程序，以便可以消除异常？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T16:57:39.963

这是我第一次听说这个。如果有什么安慰的话，我可以在这里复制它。

您应该做的第一件事可能是在[Quality Central 中](http://qc.codegear.com)提交错误报告，并在 Codegear NNTP 新闻组上提问。

另外，尝试将 TCustomShellListView.GetFolder 更改为下面的代码，看看你是如何开始的。您需要重新构建包 - 并注意 D2009 出于某种原因在 Windows\System32 中安装了此包的第二个副本。我将其重命名为（到目前为止）没有任何不良影响。

```
function TCustomShellListView.GetFolder(Index: Integer): TShellFolder;
begin
  if Index < FFolders.Count then
    Result := TShellFolder(FFolders[Index])
  else
    Result := NIL;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T14:51:32.323

到目前为止，没有任何建议可以解决问题......但是如果我从演示项目中删除 ShellListView 组件然后关闭项目，则不会创建异常。我认为问题出在 ShellListView 组件而不是 ShellTreeView。

问题可能比看起来要大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-14T14:50:32.027

该问题**仅**在设计时出现。

`TShellListView`这是组件在文件中应用的解决方案`ShellCtrls.pas`：

```
destructor TCustomShellListView.Destroy;
begin
  ClearItems;
  if not (csDesigning in ComponentState) then // Avoid design time error
  FFolders.Free;
  FreeAndNil(FRootFolder);
  inherited;
end;

procedure TCustomShellListView.DestroyWnd;
begin
  ClearItems;

  // Avoid error in inherited DestroyWnd procedure :
  if csDesigning in ComponentState then
  Items.Count := 0;
  inherited DestroyWnd;
end; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T01:26:01.183

```
{ TCustomShellTreeView }
...
  TCustomShellTreeView = class(TCustomTreeView, IShellCommandVerb)
  public
    constructor Create(AOwner: TComponent); override;
    destructor Destroy; override; //$$jp shellctrl.pas 26.08.2007: missing "override"
    procedure Refresh(Node: TTreeNode);
...

destructor TCustomShellTreeView.Destroy;
begin
  //$$jp: ClearItems;
  //$$jp: raises EInvalidOperation and access-violations (shellctrl.pas 26.08.2007)
  FRootFolder.Free;
  inherited;
end; 
```

# asp.net - 如何在 ASP.Net 中将自定义文本设置为 DropdownList

> ID：403419
> 
> 赞同：1
> 
> 时间：2008-12-31T16:40:52.320
> 
> 标签：asp.net, drop-down-menu

我的一个应用程序中有下拉列表控件，当我从数据库中添加项目时，默认情况下它会将第一个项目显示到下拉列表中，但我想在其中显示其他文本，例如“从列表中选择项目”有什么办法我可以做这个 。

另外你能帮我从javascript设置相同的值吗

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-31T16:48:17.703

在 ASP.NET 方面，您可以使用 AppendDataBoundItems="true" 创建 DropDownList ，并且您绑定到它的任何项目都将在默认值之后出现：

```
<asp:DropDownList AppendDataBoundItems="true" ID="yourListId" runat="server">
    <asp:ListItem Text="Select something" Value="-1" />
</asp:DropDownList> 
```

至于完全用 Javascript 做同样的事情，你可以用这样的函数来做：

```
function addFirstItem(list, text, value)
{
    var newOption = document.createElement("option");
    newOption.text = text;
    newOption.value = value;
    list.options.add(newOption);
}

addFirstItem(document.getElementById("yourListId"), "Select something", "-1"); 
```

或者使用 jQuery（可能有一些更清洁的东西，特别是对于创建新的选项标签，但这有效）：

```
$("#yourListId option:first").before("<option value='-1'>Select something</option>"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-02T12:42:12.067

Patridge 的回答是正确的，但是如果您使用 asp 方法并且仍然遇到问题，请将 items 标签添加到 listitem。

```
<asp:DropDownList AppendDataBoundItems="true" ID="yourListId" runat="server">
  <items>   
    <asp:ListItem Text="Select something" Value="-1">--Select Something--</asp:ListItem>
  </items>
</asp:DropDownList> 
```

# c# - 将 XSD 转换为 SQL 关系表

> ID：403420
> 
> 赞同：16
> 
> 时间：2008-12-31T16:41:14.193
> 
> 标签：c#, c++, sql, visual-studio, xsd

有什么东西可以帮助我将 XSD 转换为 SQL 关系表吗？XSD 相当大（无论如何在我的世界中），如果有什么东西推动我前进而不是从头开始，我可以节省时间和无聊的打字。

如果您想看看，XSD 就[在这里。](http://www.grip.no/kjemikalier/XMLstandardformat/hmsdatablad.xsd)这是交换 MSDS 的标准化/本地化格式。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-31T16:51:11.443

Altova 的[XML Spy](http://www.altova.com/features_database.html)具有从 XSD 文件生成 SQL DDL 脚本的功能。XML Spy 会花费你一些钱。

有趣的是，开发人员使用了一个非常聪明的技巧，即使用 XSLT 转换从 XSD 文件创建 DDL 脚本。[他们在这里](http://annlewkowicz.blogspot.com/2007/03/create-ddl-from-dataset-xsd-file.html)和[这里](http://annlewkowicz.blogspot.com/2008/01/create-ddl-from-xsd-file-part-ii.html)分两部分对其进行了概述。

我可能不得不自己尝试一下以备将来使用...

编辑：刚刚发现这个问题以前[在这里](https://stackoverflow.com/questions/138575/how-can-i-create-database-tables-from-xsd-files)问过......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-25T12:57:24.213

有一个名为[XSD2DB](http://xsd2db.sourceforge.net/)的命令行工具，它从 xsd 文件生成数据库，可在 sourceforge 获得。

有关更多信息：请参阅这个现有问题[如何从 XSD 文件创建数据库表](https://stackoverflow.com/questions/138575/how-can-i-create-database-tables-from-xsd-files)？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-12T22:45:33.427

您可以使用 XSLT 转换。例如，请参见此处：[使用 XSLT 从 XSD 和 XSL 样式表生成 SQL](http://www.academia.edu/661966/Generating_SQL_schema_XSL_stylesheets_and_XQuery_for_processing_XML_data_based_on_XML_Schema_model_2006_)。

Microsoft 有一个用于执行 XSLT 转换的命令行工具：[Microsoft Command-Line tool for XSLT](http://www.microsoft.com/en-us/download/details.aspx?id=21714)。

使用 MSBuild 或 Grunt 将转换集成到构建过程中也很容易。

这是 Microsoft 文档的参考：[XML 标准参考，包括 XSD、XSLT 等。](https://msdn.microsoft.com/en-us/library/ms256177(v=vs.110).aspx)

# python - 如何根据对象的属性对对象列表进行排序？

> ID：403421
> 
> 赞同：1030
> 
> 时间：2008-12-31T16:41:32.833
> 
> 标签：python, list, sorting, oop, count

我有一个 Python 对象列表，我想按对象本身的属性对其进行排序。该列表如下所示：

```
>>> ut
[<Tag: 128>, <Tag: 2008>, <Tag: <>, <Tag: actionscript>, <Tag: addresses>,
 <Tag: aes>, <Tag: ajax> ...] 
```

每个对象都有一个计数：

```
>>> ut[1].count
1L 
```

我需要按计数降序对列表进行排序。

我已经看到了几种方法，但我正在寻找 Python 中的最佳实践。

* * *

## 回答 #1

> 赞同：1652
> 
> 时间：2008-12-31T16:42:59.820

```
# To sort the list in place...
ut.sort(key=lambda x: x.count, reverse=True)

# To return a new list, use the sorted() built-in function...
newlist = sorted(ut, key=lambda x: x.count, reverse=True) 
```

更多关于[按键排序的](http://wiki.python.org/moin/HowTo/Sorting#Sortingbykeys)信息。

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2008-12-31T17:48:21.937

一种最快的方法是使用`operator.attrgetter("count")`. 但是，这可能会在 Python 的预操作员版本上运行，因此最好有一个回退机制。然后，您可能想要执行以下操作：

```
try: import operator
except ImportError: keyfun= lambda x: x.count # use a lambda if no operator module
else: keyfun= operator.attrgetter("count") # use operator since it's faster than lambda

ut.sort(key=keyfun, reverse=True) # sort in-place 
```

* * *

## 回答 #3

> 赞同：82
> 
> 时间：2009-06-12T19:54:58.770

读者应该注意到 key= 方法：

```
ut.sort(key=lambda x: x.count, reverse=True) 
```

比向对象添加丰富的比较运算符要快很多倍。我很惊讶地读到这个（“Python in a Nutshell”的第 485 页）。您可以通过在这个小程序上运行测试来确认这一点：

```
#!/usr/bin/env python
import random

class C:
    def __init__(self,count):
        self.count = count

    def __cmp__(self,other):
        return cmp(self.count,other.count)

longList = [C(random.random()) for i in xrange(1000000)] #about 6.1 secs
longList2 = longList[:]

longList.sort() #about 52 - 6.1 = 46 secs
longList2.sort(key = lambda c: c.count) #about 9 - 6.1 = 3 secs 
```

我的，非常小的测试显示第一种慢了 10 倍以上，但书上说它通常只慢 5 倍。他们说的原因是由于 python ( **timsort** ) 中使用的高度优化的排序算法。

尽管如此，.sort(lambda) 比普通的旧 .sort() 更快，这很奇怪。我希望他们能解决这个问题。

* * *

## 回答 #4

> 赞同：71
> 
> 时间：2018-02-11T11:35:22.877

**面向对象的方法**

如果适用，最好将对象排序逻辑作为类的属性，而不是在需要排序的每个实例中合并。

这确保了一致性并消除了对样板代码的需求。

至少，您应该为此指定`__eq__`和`__lt__`操作。然后只需使用`sorted(list_of_objects)`.

```
class Card(object):

    def __init__(self, rank, suit):
        self.rank = rank
        self.suit = suit

    def __eq__(self, other):
        return self.rank == other.rank and self.suit == other.suit

    def __lt__(self, other):
        return self.rank < other.rank

hand = [Card(10, 'H'), Card(2, 'h'), Card(12, 'h'), Card(13, 'h'), Card(14, 'h')]
hand_order = [c.rank for c in hand]  # [10, 2, 12, 13, 14]

hand_sorted = sorted(hand)
hand_sorted_order = [c.rank for c in hand_sorted]  # [2, 10, 12, 13, 14] 
```

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2008-12-31T19:00:33.507

```
from operator import attrgetter
ut.sort(key = attrgetter('count'), reverse = True) 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2008-12-31T17:10:00.843

它看起来很像 Django ORM 模型实例的列表。

为什么不在这样的查询中对它们进行排序：

```
ut = Tag.objects.order_by('-count') 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-12-31T16:45:15.260

将丰富的比较运算符添加到对象类中，然后使用列表的 sort() 方法。
在 python 中查看[丰富的比较](http://docs.python.org/reference/datamodel.html#object.__lt__)。

* * *

**更新**：虽然这种方法可行，但我认为 Triptych 的解决方案更适合您的情况，因为它更简单。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2019-09-24T15:21:15.690

如果要排序的属性是*property*，则可以避免导入`operator.attrgetter`并改用 property 的[`fget`](https://docs.python.org/3/library/functions.html#property)方法。

例如，对于`Circle`具有属性的类，`radius`我们可以按半径对列表进行排序`circles`，如下所示：

```
result = sorted(circles, key=Circle.radius.fget) 
```

这不是最知名的功能，但经常为我节省了导入的一行。

# python - 使一个表的值等于另一个表中的另一个值

> ID：403433
> 
> 赞同：-1
> 
> 时间：2008-12-31T16:44:27.463
> 
> 标签：python, mysql

我正在编写的程序有一个小问题。我有一张表格 - 库存，其中包含有关存储在冰箱中的物品的信息（产品、条形码等）。然后我有另一个表 - 商店，它就像一个商店，包含大量产品及其条形码。商店表中的一些产品目前在库存表中，并且有一个名为 stock 的布尔字段告诉我们是否该产品是否在库存表中，如果等于1，则在冰箱中，如果等于0，则不在冰箱中。库存表中的两个字段是数量和数量。数量是目前冰箱里的东西，数量是冰箱里必须一直存在的东西。当从冰箱中取出某物时，该产品的数量会减少 1。stocks 表中的每个条形码在 shop 表中都有一个匹配的条形码。我需要从 python 程序查询数据库，当数量（冰箱里的东西）少于数量（冰箱里的东西）时，它将从商店表中订购产品。所以你需要把stocks表中数量小于数量的一行的条码与shops表中的条码相匹配。然后在该匹配条形码的行中，您需要设置 stock = 1。

如果有人能帮我解决这个问题，我会非常高兴，因为我真的发现很难编写这个函数。如果有帮助，下面是签入和结帐功能。

**报到**

```
def check_in(): 
    db = MySQLdb.connect(host='localhost', user='root', passwd='$$', db='fillmyfridge')
    cursor=db.cursor(MySQLdb.cursors.DictCursor)
    user_input=raw_input('please enter the product barcode that you wish to checkin to the fridge: \n')
    cursor.execute("""update shop set stock = 1 where barcode = %s""", (user_input))
    db.commit()
    numrows = int(cursor.rowcount)
    if numrows >= 1:
        row = cursor.fetchone()
        print row["product"]
        cursor.execute('update stock set amount = amount + 1 where product = %s', row["product"])
        db.commit()
        cursor.execute('udpate shop set stock = 1 where barcode = user_input')
        db.commit()
    else:
        new_prodname = raw_input('what is the name of the product and press enter: \n')
        cursor.execute('insert into shop (product, barcode, category) values (%s, %s, %s)', (new_prodname, user_input, new_prodname))
        cursor = db.cursor()
        query = ('select * from shop where product = %s', (new_prodname))
        cursor.execute(query):
        db.commit()
        numrows = int(cursor.rowcount)
        if numrows<1:
            cursor.execute('insert into atock (barcode, quantity, amount, product) values (%s, 1, 1, %s)', (user_input, new_prodname))
            db.commit()
            cursor.execute('insert into shop (product, barcode, category, stock) values (%s, %s, %s, 1)', (new_prodname, user_input, new_prodname))
            print new_prodname 
            print 'has been added to the fridge stock'
        else:
            cursor.execute('update atock set amount = amount + 1 where product = %s', (new_prodname))
            db.commit()
            cursor.execute('insert into shop (product, barcode, category, stock) values (%s, %s, %s, 1)', (new_prodname, user_input, new_prodname))
            print new_prodname 
            print 'has been added to the fridge stock' 
```

**查看**

```
import MySQLdb

def check_out():
    db = MySQLdb.connect(host='localhost', user='root', passwd='$$', db='fillmyfridge')
    cursor=db.cursor()
    user_input=raw_input('please enter the product barcode you wish to remove from the fridge: \n')
    query = cursor.execute('update stock set instock=0, howmanytoorder=howmanytoorder + 1, amount = amount - 1 where barcode = %s', (user_input))
    if cursor.execute(query):
        db.commit()
        print 'the following product has been removed from the fridge nd needs to be ordered'
        cursor.execute('update shop set stock = 0 where barcode = %s' (user_input)
        db.commit()
    else:
        return 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T17:08:34.137

所以，如果我做对了，你有以下表格：

**至少有*条码*、*数量*和*数量*栏的**库存****

 ****商店**至少有*条码*和*库存*栏

我不明白为什么您需要商店表中的*库存*列，因为您可以通过使用如下连接轻松获取库存产品：

```
SELECT barcode, ... FROM Stock ST JOIN Shop SH ON ST.barcode = SH.barcode; 
```

显然，您还应该从 Shop 表中选择一些其他列，否则您可以从 Stock 表中选择所有内容。

您可以获得需要订购的产品列表（数量少于数量）：

```
SELECT barcode FROM Stock ST WHERE ST.amount < ST.quantity; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T17:08:00.957

尽量缩短问题。我猜这会产生更多的反应。

# jpa - 迁移 EJB2.x BMP 实体 bean

> ID：403441
> 
> 赞同：3
> 
> 时间：2008-12-31T16:45:51.577
> 
> 标签：jpa, jakarta-ee, bmp, ejb-2.x

我们使用带有 BMP（bean 管理的持久性）的 EJB2.x 实体 bean。EJB3 似乎不支持 BMP。我们曾希望保持最新状态并升级到 EJB3。有谁知道 3.0 中是否有任何 BMP 选项可用？

据我所知，使用 3.0，所有实体 bean 都必须使用 JPA 和定义为 ORM。有一些使用本机 SQL 的选项，但这仍然只是使用 JPA 实现 ORM 的一种方式。

我不确定是否有另一种 EJB3 方法可以实现与 EJB2.x BMP 实体 bean 相同的功能。我们目前使用标准的 ejbStore 方法通过本机 SQL 更新数据库，使用 ejbLoad 方法查找所有 bean 并在事务回滚时刷新 bean。我认为您可以使用 EJB3 会话 bean 来做到这一点，但我不确定。

也许我们应该迁移到 Spring 而不是迁移到 EJB3 bean。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-09-02T00:44:49.880

如果您真的想手动编写 SQL，请选择 POJO 和原始 JDBC DAO。但这也可能是一个重新思考您做事方式并拥抱 ORM/JPA 的机会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-02T00:53:00.567

过去，我使用 JTA 混合使用 Hibernate + EJB2 (CMP + BMP) 共享事务上下文，没有任何问题。

这个问题非常相似......看看[https://cwiki.apache.org/GMOxDOC22/developing-bean-managed-persistence-with-jpa.html](https://cwiki.apache.org/GMOxDOC22/developing-bean-managed-persistence-with-jpa.html)。您可以实现自己的 EntityManager。

运气好的话，您甚至可以共享事务上下文。

# sql-server - 如何设置对 MSSQL 2005 数据库邮件的访问？

> ID：403443
> 
> 赞同：2
> 
> 时间：2008-12-31T16:46:21.937
> 
> 标签：sql-server, roles, database-mail

我刚刚在 MSSQL 2005 中设置了数据库邮件。我已经能够从服务器上的管理员帐户并通过 SQL Server 代理作业发送电子邮件。但是，当我尝试通过仅有权访问我们的 Web 应用程序的数据库的登录名发送电子邮件时，我无法发送电子邮件。

设置对数据库邮件的访问的最佳方式是什么？

我有 2 个要发送电子邮件的 senerios。

1.  通过 SQL Server 代理安排作业以运行存储过程，该过程执行某些过程，然后发送电子邮件。（这不是问题）
2.  有一个从 Web 应用程序调用的存储过程，该应用程序调用另一个可以发送电子邮件的存储过程。（这是我的权限问题）

***可能的解决方案***

1.  我发现授予登录权限的唯一方法是将登录名映射到**msdb**数据库并授予**public**和**DatabaseMailUserRole**。这真的让我很担心，因为我认为这会提供对**msdb**数据库的很多访问权限。

2.  将我要发送的电子邮件存储在一个表中，然后让 SQL Server 代理作业每隔一段时间查看该表以发送任何排队的电子邮件。这样，Web 应用程序的数据库登录不会执行 [msdb].[dbo].[sp_send_dbmail] 调用，因此不需要对**msdb**数据库的任何权限。

还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T18:07:13.457

您应该能够**使用 EXECUTE AS OWNER**选项创建一个存储过程，以便它在所有者而不是调用者的上下文中运行。

```
CREATE PROCEDURE [dbo].[sp_SendMail]
(
    @To nvarchar(1000),
    @Subject nvarchar(100),
    @Body nvarchar(max)
)
WITH EXECUTE AS OWNER
AS
BEGIN
    exec msdb.dbo.sp_send_dbmail @profile_name = 'MailProfile', 
                @recipients = @To, 
                @subject = @Subject, 
                @body = @Body
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T22:04:33.777

我正在尝试做同样的事情，但正在执行

```
GRANT EXECUTE ON dbo.sp_SendMail TO User1 
```

没有解决这个问题。唯一使此程序起作用的不是添加

```
EXECUTE AS OWNER 
```

（我仅使用“WITH ENCRYPTION”创建它）并将运行此过程的用户添加到 msdb DatabaseMailUserRole 角色：

```
USE msdb
GO
EXEC sp_adduser @loginame='USERNAME', @grpname='DatabaseMailUserRole'
GO 
```

谢谢

# vb.net - 是否有 C# 的 '??' 的 VB.NET 等价物 操作员？

> ID：403445
> 
> 赞同：191
> 
> 时间：2008-12-31T16:46:57.783
> 
> 标签：vb.net, operators, null-coalescing-operator

C# 的运算符是否有 VB.NET 等价物`??`？

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2008-12-31T16:51:16.090

使用`If()`带有两个参数的运算符（[Microsoft 文档](https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/if-operator#if-operator-called-with-two-arguments)）：

```
' Variable first is a nullable type.
Dim first? As Integer = 3
Dim second As Integer = 6

' Variable first <> Nothing, so its value, 3, is returned.
Console.WriteLine(If(first, second))

second = Nothing
' Variable first <> Nothing, so the value of first is returned again. 
Console.WriteLine(If(first, second))

first = Nothing second = 6
' Variable first = Nothing, so 6 is returned.
Console.WriteLine(If(first, second)) 
```

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2008-12-31T16:53:06.710

操作员应该为`IF()`您解决问题：

```
value = If(nullable, defaultValueIfNull) 
```

[http://visualstudiomagazine.com/listings/list.aspx?id=252](http://visualstudiomagazine.com/listings/list.aspx?id=252)

* * *

## 回答 #3

> 赞同：75
> 
> 时间：2013-12-19T16:08:18.443

*接受的答案没有任何解释，只是一个链接。
因此，我想我会留下一个答案来解释`If`操作员是如何工作的，取自 MSDN：*

* * *

# [If 运算符 (Visual Basic)](http://msdn.microsoft.com/en-us/library/bb513985.aspx)

> 使用短路评估有条件地返回两个值之一。**If**运算符可以用三个参数或两个参数调用。
> 
> ```
> If( [argument1,] argument2, argument3 ) 
> ```

## 如果使用两个参数调用运算符

> **If**的第一个参数可以省略。这使得操作符可以通过仅使用两个参数来调用。以下列表仅在使用两个参数调用**If运算符时适用。**

## 部分

```
Term         Definition
----         ----------

argument2    Required. Object. Must be a reference or nullable type. 
             Evaluated and returned when it evaluates to anything 
             other than Nothing.

argument3    Required. Object.
             Evaluated and returned if argument2 evaluates to Nothing. 
```

> 当省略**布尔**参数时，第一个参数必须是引用或可为空的类型。如果第一个参数的计算结果为 **Nothing**，则返回第二个参数的值。在所有其他情况下，返回第一个参数的值。以下示例说明了此评估的工作原理。

## VB

```
' Variable first is a nullable type. 
Dim first? As Integer = 3
Dim second As Integer = 6

' Variable first <> Nothing, so its value, 3, is returned.
Console.WriteLine(If(first, second))

second = Nothing 
' Variable first <> Nothing, so the value of first is returned again.
Console.WriteLine(If(first, second))

first = Nothing
second = 6
' Variable first = Nothing, so 6 is returned.
Console.WriteLine(If(first, second)) 
```

如何处理两个以上值（嵌套`if`s）的示例：

```
Dim first? As Integer = Nothing
Dim second? As Integer = Nothing
Dim third? As Integer = 6
' The LAST parameter doesn't have to be nullable.
'Alternative: Dim third As Integer = 6

' Writes "6", because the first two values are "Nothing".
Console.WriteLine(If(first, If(second, third))) 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-12-31T16:55:24.927

您可以使用扩展方法。这一个像 SQL 一样工作`COALESCE`，对于您要测试的内容可能有点过分，但它确实有效。

```
 ''' <summary>
    ''' Returns the first non-null T based on a collection of the root object and the args.
    ''' </summary>
    ''' <param name="obj"></param>
    ''' <param name="args"></param>
    ''' <returns></returns>
    ''' <remarks>Usage
    ''' Dim val as String = "MyVal"
    ''' Dim result as String = val.Coalesce(String.Empty)
    ''' *** returns "MyVal"
    '''
    ''' val = Nothing
    ''' result = val.Coalesce(String.Empty, "MyVal", "YourVal")
    ''' *** returns String.Empty
    '''
    ''' </remarks>
    <System.Runtime.CompilerServices.Extension()> _
    Public Function Coalesce(Of T)(ByVal obj As T, ByVal ParamArray args() As T) As T

        If obj IsNot Nothing Then
            Return obj
        End If

        Dim arg As T
        For Each arg In args
            If arg IsNot Nothing Then
                Return arg
            End If
        Next

        Return Nothing

    End Function 
```

内置`If(nullable, secondChoice)`只能处理**两个**可为空的选择。在这里，可以`Coalesce`根据需要设置任意多个参数。将返回第一个非空参数，之后不评估其余参数（短路，如`AndAlso`/`&&`和`OrElse`/ `||`）

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2016-02-26T06:34:51.980

大多数这些解决方案的一个重要限制是它们不会短路。因此，它们实际上并不等同于`??`。

除非前面的参数计算结果为空，否则内置[`If`](https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/if-operator)运算符不会计算后续参数。

以下语句是等效的：

C＃

```
var value = expression1 ?? expression2 ?? expression3 ?? expression4; 
```

VB

```
dim value = if(expression1,if(expression2,if(expression3,expression4))) 
```

这将适用于所有有效的情况`??`。任何其他解决方案都必须极其谨慎地使用，因为它们很容易引入运行时错误。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-06-15T19:56:41.517

在此处查看有关 If Operator (Visual Basic) 的 Microsoft 文档：[https ://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/if-operator](https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/if-operator)

```
If( [argument1,] argument2, argument3 ) 
```

以下是一些示例（VB.Net）

```
' This statement prints TruePart, because the first argument is true.
Console.WriteLine(If(True, "TruePart", "FalsePart"))

' This statement prints FalsePart, because the first argument is false.
Console.WriteLine(If(False, "TruePart", "FalsePart"))

Dim number = 3
' With number set to 3, this statement prints Positive.
Console.WriteLine(If(number >= 0, "Positive", "Negative"))

number = -1
' With number set to -1, this statement prints Negative.
Console.WriteLine(If(number >= 0, "Positive", "Negative")) 
```

# asp.net - 使用数据模块 --- pass-Store-use a connection inside a可重用的数据模块

> ID：403448
> 
> 赞同：1
> 
> 时间：2008-12-31T16:49:04.910
> 
> 标签：asp.net, data-access, state-management

我想将站点的数据模块分成一个程序集（单个 dll 文件），在处理 Web 应用程序时**获取存储和传递**站点的**ConnectionString的最佳方法是什么。**在数据程序集中，我创建了一个名为 ConnectionManager 的静态类。它有一个名为**DatabaseConnectionName**的属性 ，我想传递并存储位于 Web.Config 文件中的连接名称。在这个策略中，我决定在网站的加载时间在 Global.asax 文件中获取名称并建立连接，并在我之前提到的属性 (DatabaseConnectionName) 中进行连接。但是，这只是我使用的策略，我不知道做这项工作的**常见模式是什么。**

**部分代码：** ======================================= [ -------- ---- **Global.asax** ------------ ]

```
the code in the site that makes the Data module accessible for the site
    void Application_Start(object sender, EventArgs e) 
    {
         OurCompany.Data.ConnectionManager.DatabaseConnectionName = "MasterConnection";
    } 
```

[ ------------ **ConnectionManager Class** ------------ ] 这是在数据模块中，除了站点

```
public static class ConnectionManager
{

    public static SqlConnection  GetMasterConnection()
    {
        string connectionString = ConfigurationManager.ConnectionStrings[**DatabaseConnectionName**].ConnectionString;
        SqlConnection conn;     
        //conn.Open();
        conn = new SqlConnection(connectionString);
        return  conn;
    }

    private static string **databaseConnectionName**;
    public static string DatabaseConnectionName
    {
        get
        {
            return databaseConnectionName;
        }
        set
        {
            databaseConnectionName = value;
        }
    } 
```

==结束================================================ =============

**--- 问题是： ---**

1.  在哪里存储连接？（这是 ConnectionManager 类中的一个属性，theCompany.Data.ConnectionManager.DatabaseConnectionName）

2.  什么时候建立这种联系？（这里是 Global.asax 应用程序加载时间）

3.  哪种方法最适合存储此类信息：SessionState 或 ViewState 或简单属性

4.  这个策略好不好？你知道任何更好的方法或常见的模式吗？

感谢您提供任何信息 - MHM -

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-31T17:04:54.597

一些想法...

1.  您不应该存储并挂在打开的数据库连接上。打开连接，进行数据库操作，然后立即关闭。应用晚获取，早发布的规则。

2.  见第 1 点。

3.  不要将数据库连接存储在会话状态中。再次参见第 1 点。如果您指的是连接字符串，那么只需在需要时从配置管理器中读取它。它已经为您缓存，不要重新发明或包装轮子。

4.  我建议您看一下模式和实践企业库，它抽象出许多管理数据访问的常见模式：

[http://www.codeplex.com/entlib](http://www.codeplex.com/entlib)

# javascript - JavaScript：“禁止在标识符中以 _ 开头”作为 JSLint 中的一个选项

> ID：403454
> 
> 赞同：1
> 
> 时间：2008-12-31T16:51:24.750
> 
> 标签：javascript, jslint

我刚刚开始编写自己的*JavaScript 框架*（只是为了学习经验），并在一些私有成员前面加上**_**，如下所示：

```
var _isFireBugEnabled = function () {
    return (window.console && window.console.firebug);
}; 
```

[当我针对 Crockford 的JSLint](http://jslint.com/)（一如既往）运行我的代码`Recommended Options`时，我被告知不要使用 _ 作为标识符。

我的问题是，**为什么 JSLint 会警告我不要使用 _ 作为标识符？**

我在这里遗漏了一些副作用或影响吗？

*PS。据我刚才扫描，这[本书中没有记录](https://rads.stackoverflow.com/amzn/click/com/0596517742)*

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-31T16:59:44.530

原因是 Douglas Crockford 讨厌 78% 的 Javascript*。许多人认为他有点严格，实际上许多库确实在生产代码中使用前导下划线。我看不出有多大问题。没有副作用。

[此外，'$'，而不是下划线，是ECMA 规范](http://www.ecma-international.org/publications/standards/Ecma-262.htm)为“系统”代码预留的符号。

> **来自 ECMA 262，第 7.6 节：**
> 
> 该标准规定了与 Unicode 标准中给出的语法的一个不同之处：在标识符中的任何位置都允许使用美元符号 ($) 和下划线 (_)。美元符号仅用于机械生成的代码。

*注意：我在开玩笑。他真的只讨厌一半，而且他通常有充分的理由。我不同意 Crockford 的观点，但他通常是对的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-31T16:54:23.323

实际上，我已经就此向 Crockford 发送了电子邮件。这是他的回应：

> 我认为 _ 应该保留用于系统代码实现，而不是由应用程序使用。

我有点不同意他的观点，我倾向于在我自己的类中使用 _ 作为真正私有成员的前缀，因为它让我清楚什么是私有的。Google 的 Caja 有一些关于使用 _ 的规则，但没有什么会导致您所描述的内容出现问题。

# c# - 在 C# 中使用“var”声明变量

> ID：403455
> 
> 赞同：9
> 
> 时间：2008-12-31T16:51:28.243
> 
> 标签：c#, .net

在 C# 中使用“var”声明变量时，是否进行了装箱/拆箱？

使用 var 声明变量时是否存在运行时类型不匹配的可能性？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-31T16:52:21.283

不，使用 var 的编译方式与您指定了确切的类型名称一样。例如

```
var x = 5; 
```

和

```
int x = 5; 
```

被编译为相同的 IL 代码。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-31T16:56:26.487

var 只是一个方便的关键字，它告诉编译器找出类型是什么并将“var”替换为该类型。

当与 LINQ 等技术一起使用时，它最有用，其中查询的返回类型有时难以确定。

在使用嵌套泛型声明或其他长声明时，它也很有用（节省一些输入）：

```
var dic = new Dictionary<string, Dictionary<int, string>>(); 
```

# php - 如何使用 javascript/html/css 模拟 struts 验证

> ID：403457
> 
> 赞同：0
> 
> 时间：2008-12-31T16:52:24.840
> 
> 标签：php, javascript, html, css, struts

在过去的几年中，我一直专注于后端开发，因此缺乏 javascript 和 css 技能。我自愿担任一个网站的网站管理员，并希望完善表单验证（目前没有）。
我的问题：基本上我有一个包含几个姓名字段、一个电子邮件地址和一个电话号码的表格。提交表单后，我会验证所有字段。如果数据无效，我想将该字段的标签颜色更改为红色（类似于 struts 验证）。最简单的方法是什么？

编辑：我也有后端 PHP 验证。我希望在前端让它更漂亮、更用户友好。PHP 验证位于不同的服务器上。如果后端验证失败，它会显示一条消息，并强制用户使用“后退”按钮。我希望重新定向回原始页面并显示无效字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T17:27:17.017

当您构建页面服务器端时，请标记所有包含错误的字段：

```
<input type="text" name="phone_number" class="error_field">
   555-121
</input> 
```

然后在页面的 CSS 中包含如下条目：

```
input.error_field { color: #FFF; bgcolor: #C00; } 
```

（句点是“类选择器”，意味着它适用于具有类属性“error_field”的所有输入。如果您已经为输入标签使用类，则可以为元素提供多个类，只需使用空格分隔即可。）

如果您想知道 Struts 生成什么样的代码来为页面着色，一种简单的方法是使用 Firefox 的[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843 "萤火虫")扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T17:34:55.927

假设标签与输入位于 DOM 层次结构的同一级别，并且它紧邻标记中的输入，您可以执行类似的操作。

首先，一些示例 HTML：

```
<html>
    <body>
        <form onsubmit="return validation()" action="submit.php" method="post">
            <label for="name">Name:</label>
            <input type="text" value="" id="name" />
            <label for="email">Email:</label>
            <input type="text" value="" id="email" />

            <input type="submit" value="Submit" />
        </form>
    </body>
</html> 
```

如您所见，所有输入前面都有一个带有正确 for 属性的标签。

现在对于 Javascript，它将进入头脑：

```
<script type="text/javascript">
    function validation() {
        //So we have a validation function.
        //Let's first fetch the inputs.
        name = document.getElementById("name");
        email = document.getElementById("email");

        //The variable error will increment if there is a validation error.
        //This way, the form will not submit if an error is found.
        error = 0; 

        //Now for validation.
        if(name.value.length < 6) {
            //We've found an error, so increment the variable
            error++;

            //Now find the corresponding label.
            nameLabel = name.previousSibling;

            //If we found the label, add an error class to it.
            if(nameLabel && nameLabel.for = name.id) {
                nameLabel.className = "error";
            }
        }

        ///////////////////
        //Do the same with the email...
        ///////////////////

        //Now, if there are no errors, let the form submit.
        //If there are errors, prevent it from doing so.
        return (error == 0) ? true : false;
    }
</script> 
```

现在只需添加一些 CSS：

```
<style type="text/css">
.error {
  background-color: red;
}
</style> 
```

编辑——我猜你不想要这种解决方案，但如果你想让它在去服务器之前验证，你就去吧。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T17:43:49.917

正如其他人所建议的那样，您可以自己将其组合在一起。但我似乎记得 Struts 有自己的 JavaScript 验证。它可以配置为生成 JavaScript 函数，这些函数执行与服务器端相同的检查。检查[文档](http://struts.apache.org/1.2.4/userGuide/struts-html.html#javascript)——这可能是一种快速入门的方法，尽管它可能不像您想要的那样可定制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T16:54:24.213

Struts 验证发生在服务器端；JavaScript 验证在客户端上运行。区别很重要，因为即使您的客户端关闭浏览器中的 JavaScript（据报道约有 10% 的人这样做），服务器端验证仍然有效。

如果可以的话，最好两者兼得。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T17:47:00.993

我建议你学习一个 JavaScript 框架，比如 JQuery 或 Prototype。JQuery 可以帮助您轻松地从过滤元素中获取值、修改它们的 CSS、添加视觉效果等。

我不太了解您网站的 PHP 逻辑，但是如果操作提交给自身，您可以在同一页面中进行验证，尽管我不知道这是否是一个好习惯。例如，您将以下内容放在顶部：

```
if( $_SERVER['REQUEST_METHOD'] == 'POST' ){
//field validation code... 
```

要使用 PHP 重定向，您只需说：

```
header("Location: THE_PAGE.php"); 
```

尽管在此之前您不应该输出任何内容。您可能可以将一个参数传回您的页面（即：THE_PAGE.php?valMsg=1）以告诉它显示验证消息或类似的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T18:18:55.493

我以前绝对没有使用过 struts，但是我在使用和不使用 javascript 的情况下进行了很多表单验证。

在我看来，您应该始终同时拥有 javascript 和服务器端验证，因此它应该适用于所有人。

在服务器端，您应该执行上述[glaziusf.myopenid.com 之](https://stackoverflow.com/users/34384/glaziusf-myopenid-com)类的操作，只需将一个类添加到以红色显示的元素即可。

在 javascript（和 ajax）中，只需将相同的类添加到您将在服务器端使用的元素中，但是是动态的。

# html - 如何叠加图像

> ID：403478
> 
> 赞同：129
> 
> 时间：2008-12-31T17:00:08.337
> 
> 标签：html, css

我想使用 CSS 将一个图像与另一个图像重叠。这方面的一个例子是第一张图片（如果你喜欢背景）将是产品的缩略图链接，该链接打开一个灯箱/弹出窗口，显示图像的更大版本。

在这个链接的图像之上，我想要一个放大镜的图像，向人们展示可以单击该图像来放大它（显然，如果没有放大镜，这并不明显）。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2008-12-31T17:15:14.390

我刚刚在一个项目中完成了这件事。HTML 端看起来有点像这样：

```
<a href="[fullsize]" class="gallerypic" title="">
  <img src="[thumbnail pic]" height="90" width="140" alt="[Gallery Photo]" class="pic" />
  <span class="zoom-icon">
      <img src="/images/misc/zoom.gif" width="32" height="32" alt="Zoom">
  </span>
</a> 
```

然后使用CSS：

```
a.gallerypic{
  width:140px;
  text-decoration:none;
  position:relative;
  display:block;
  border:1px solid #666;
  padding:3px;
  margin-right:5px;
  float:left;
}

a.gallerypic span.zoom-icon{
  visibility:hidden;
  position:absolute;
  left:40%;
  top:35%;
  filter:alpha(opacity=50);
  -moz-opacity:0.5;
  -khtml-opacity: 0.5;
  opacity: 0.5;
}

a.gallerypic:hover span.zoom-icon{
  visibility:visible;
} 
```

我在 CSS 上留下了很多示例，所以你可以看到我是如何决定做这个样式的。请注意，我降低了不透明度，以便您可以通过放大镜看到。

希望这可以帮助。

编辑：为了澄清你的例子 - 如果你愿意，你可以忽略`visibility:hidden;`并终止`:hover`执行，这就是我这样做的方式。

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2008-12-31T17:10:54.833

[本文](http://www.tjkdesign.com/articles/png_overlay_with_no_extra_markup.asp)建议的一种技术是这样做：

```
<img style="background:url(thumbnail1.jpg)" src="magnifying_glass.png" /> 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-06-23T00:54:06.773

> 此处显示了仅使用 CSS 而不使用其他标签修改内容的简单方法（带有代码和示例）： [http ://soukie.net/2009/08/20/typography-and-css/#example](http://soukie.net/2009/08/20/typography-and-css/#example)

只要父元素不使用静态定位，这就是有效的。只需将其设置为相对定位即可。此外，IE <8 不支持**:before**选择器或**content**。

编辑：上面的链接不再有效，但在 WayBack 机器上可见： [https ://web.archive.org/web/20120213121217/https://soukie.net/2009/08/20/typography-and-css/](https://web.archive.org/web/20120213121217/https://soukie.net/2009/08/20/typography-and-css/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-31T17:26:25.117

这是我最近的做法。在语义上并不完美，但可以完成工作。

```
<div class="container" style="position: relative">
<img style="z-index: 32; left: 8px; position: relative;" alt="bottom image" src="images/bottom-image.jpg">
<div style="z-index: 100; left: 72px; position: absolute; top: 39px">
<img alt="top image" src="images/top-image.jpg"></div></div> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-31T17:45:00.507

您可能想查看本教程： [http ://www.webdesignerwall.com/tutorials/css-decorative-gallery/](http://www.webdesignerwall.com/tutorials/css-decorative-gallery/)

在其中，作者使用一个空的 span 元素来添加一个覆盖图像。如果您想保持代码尽可能干净，可以使用 jQuery 注入所述跨度元素。上述文章中也给出了一个例子。

希望这可以帮助！

-戴夫

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-31T17:40:11.703

如果您只想要悬停时的放大镜，那么您可以使用

```
a:hover img { cursor: url(glass.cur); } 
```

[http://www.javascriptkit.com/dhtmltutors/csscursors.shtml](http://www.javascriptkit.com/dhtmltutors/csscursors.shtml)

如果您希望它永久存在，您可能应该将其包含在原始缩略图中，或者使用 JavaScript 添加它而不是将其添加到 HTML 中（这纯粹是样式，不应该出现在内容中）。

如果您需要 JavaScript 方面的帮助，请告诉我。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-03-24T21:36:17.943

在 CSS3 中，您可以执行以下操作：

```
.double-image {
    background-image: url(images/img1.png), url(images/img2.png);
} 
```

取自[Can I have multiple background images using CSS?](https://stackoverflow.com/questions/423172/can-i-have-multiple-background-images-using-css)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-10-24T21:35:39.160

我们想要的只是父母高于孩子。这就是你的做法。

您将两个元素`img`放入`span`，设置，并为跨度添加`z-index & position`额外内容。`display`添加悬停，`span`这样你就可以测试它并且你得到了它！

HTML：

```
<span><img src="/images/"></span> 
```

CSS

```
span img {
    position:relative;
    z-index:-1;
}
span {
    position:relative;
    z-index:initial;
    display:inline-block;
}
span:hover {
    background-color:#000;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-31T17:23:03.907

除非您使用`<img>`单独显示图像的标签，否则仅使用纯 CSS 将无法实现此目的。您还需要两个 HTML 元素 - 每张图片一个。这是因为通过 CSS 使元素显示图片的唯一方法是使用`background-image`属性，并且每个元素只能有一个背景图像。您选择哪两个元素以及如何定位它们取决于您。有很多方法可以将一个 HTML 元素置于另一个元素之上。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-11T17:08:07.713

这是一种在图像链接上显示以半透明背景为中心的叠加图像的好方法：

## HTML

```
<div class="image-container">
    <a class="link" href="#" >  
        <img class="image" src="/img/thumbnail.png"/>
        <span class="overlay-image"><img src="/img/overlay.png"></span>
    </a>    
</div> 
```

## CSS

```
div.image-container{
    position: relative;
}
a.link{
    text-decoration: none;  
    position: relative;
    display: block;
}

a.link span.overlay-image{
    visibility: hidden;
    position: absolute;
    left: 0px;
    top: 0px;
    bottom: 0px;
    right: 0px;
    background-color: rgba(0,0,0,0.2); /* black background with 20% alpha */
}

a.link span.overlay-image:before {    /* create a full-height inline block pseudo=element */
    content: ' ';
    display: inline-block;
    vertical-align: middle;  /* vertical alignment of the inline element */
    height: 100%;   
}

a.link:hover span.overlay-image img{
    display: inline-block;  
    vertical-align: middle;     
}

a.link:hover span.overlay-image{
    visibility: visible;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-08-05T14:14:04.750

这是一个具有半透明背景的 JQuery 技术。

**HTML**

```
<html>
<head>
    <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" title="no title" charset="utf-8">
    <title>Image Gallery</title>
</head>
<body>
    <h1>Image Gallery</h1>

    <ul id="imageGallery">
        <li><a href="images/refferal_machine.png"><img src="images/refferal_machine.png" width="100" alt="Refferal Machine By Matthew Spiel"></a></li>
        <li><a href="images/space-juice.png"><img src="images/space-juice.png" width="100" alt="Space Juice by Mat Helme"></a></li>
        <li><a href="images/education.png"><img src="images/education.png" width="100" alt="Education by Chris Michel"></a></li>
        <li><a href="images/copy_mcrepeatsalot.png"><img src="images/copy_mcrepeatsalot.png" width="100" alt="Wanted: Copy McRepeatsalot by Chris Michel"></a></li>
        <li><a href="images/sebastian.png"><img src="images/sebastian.png" width="100" alt="Sebastian by Mat Helme"></a></li>
        <li><a href="images/skill-polish.png"><img src="images/skill-polish.png" width="100" alt="Skill Polish by Chris Michel"></a></li>
        <li><a href="images/chuck.png"><img src="images/chuck.png" width="100" alt="Chuck by Mat Helme"></a></li>
        <li><a href="images/library.png"><img src="images/library.png" width="100" alt="Library by Tyson Rosage"></a></li>
        <li><a href="images/boat.png"><img src="images/boat.png" width="100" alt="Boat by Griffin Moore"></a></li>
        <li><a href="images/illustrator_foundations.png"><img src="images/illustrator_foundations.png" width="100" alt="Illustrator Foundations by Matthew Spiel"></a></li>
        <li><a href="images/treehouse_shop.jpg"><img src="images/treehouse_shop.jpg" width="100" alt="Treehouse Shop by Eric Smith"></a></li>
    </ul>

    <script src="http://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/app.js" type="text/javascript" charset="utf-8"></script>
</body>
</html> 
```

**CSS**

```
/** Start Coding Here **/
#overlay {
  background:rgba(0,0,0,0.7);
  width:100%;
  height:100%;
  position:absolute;
  top:0;
  left:0;
  display:none;
  text-align:center;
}

#overlay img {
 margin-top: 10%; 
}

#overlay p {
 color:white; 
} 
```

**应用程序.js**

```
var $overlay = $('<div id="overlay"></div>');
var $image = $("<img>");
var $caption = $("<p></p>");

// 1\. Capture the click event on a link to an image
$("#imageGallery a").click(function(event){
  event.preventDefault();

  var imageLocation = $(this).attr("href");

  // 1.1 Show the overlay.
  $overlay.show();

  // 1.2 Update overlay with the image linked in the link
  $image.attr("src", imageLocation);

  // 1.3 Get child's alt attribute and set caption
  var captionText = $(this).children("img").attr("alt");
  $caption.text(captionText);

 // 2\. Add overlay
 $("body").append($overlay);

    // 2.1 An image to overlay
    $overlay.append($image);

    // 2.2 A caption to overlay
    $overlay.append($caption);

});

//When overlay is clicked
$overlay.click(function(){
  //Hide the overlay
  $overlay.hide();
}); 
```

# c# - 使用自定义 URL 重写器、IIS6 和带有 .htm、.html 等的 url

> ID：403480
> 
> 赞同：1
> 
> 时间：2008-12-31T17:01:08.630
> 
> 标签：c#, .net-3.5, iis-6, url-rewriting, windows-server-2003

我有一个自定义网站，我正在使用自定义引擎自动重写 url。只要页面 url 不以 .htm 或 .html 之类的结尾，重写就可以正常工作。对于这些页面，它直接进入 iis 404 页面，而不是先访问我的重写引擎。

我在该网站的 IIS6 配置的“主目录”部分有 * 通配符处理程序，但这些 url 似乎被它忽略了（尽管 css、jpg、js 等内容被发送到我的 web 中的 url 处理程序项目）。如何设置 IIS6 以强制将这些 url 发送到处理程序，同时在页面正常存在的情况下仍为页面提供服务？

处理程序基本上是这样做的

```
if (!File.Exists(Request.Path))
{
    doMyRewriting();
} 
```

我必须假设如果请求的文件不存在，则使用这样的块（例如，真正的块做一些其他的东西来格式化Request.Path以适合所有内容）应该运行“doMyRewriting（）”它将正常提供页面。我弄错了吗？

如果我专门告诉 IIS 将 .htm 和 .html 页面通过 .NET 处理程序发送到 .NET 处理程序，则重写工作，但如果页面实际上在那里，它将不会提供它。

任何帮助将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T17:47:24.497

不知道您是否可以或想要这样做，但是您可以使用 Ionics Isapi url 重写器。

[http://www.codeplex.com/IIRF](http://www.codeplex.com/IIRF)

基本上安装它，然后设置一个规则来删除 .html ，这样它就会碰到你的重写引擎。我在 IIS 6 上使用它和我的几个博客。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T17:28:11.353

我认为如果您让 IIS 将所有请求发送到 .NET 和您的处理程序，那么您的处理程序将需要检测页面是否存在并提供它而不是重写。

UrlRewriting.NET 可以选择执行此操作 - 您可能想查看他们的代码以了解他们如何处理这种情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-03T06:43:24.950

In my opinion, rewriting URLs with IIS 6 is best handled with an ISAPI filter written as unmanaged native code. Otherwise, you run into the issues you've mentioned - having to map all extensions to ASP.Net and losing the ability for simple file handling. With an ISAPI filter, you can choose to not rewrite some URLs and let IIS handle them as normal.

To get started, I suggest reading the [ISAPI Filter Overview](http://msdn.microsoft.com/en-us/library/ms524610.aspx "ISAPI Filter Overview") on MSDN.

If your filter absolutely needs the .Net framework runtime, it is possible to write a small ISAPI filter shell that hosts the CLR and forwards the requests to some managed code. The [Filter.Net Framework](http://www.codeplex.com/filterdotnet "Filter.Net Framework") takes this approach and may be suitable for your needs. There is the small drawback to this approach in that you will have to use the same .Net version as any ASP.Net applications that are run in the main IIS process.

# iphone - 什么是 Cocoa 或 Cocoa-touch 的好向量库？

> ID：403481
> 
> 赞同：2
> 
> 时间：2008-12-31T17:01:16.540
> 
> 标签：iphone, cocoa-touch, vector-graphics

我正在寻找一个很好的矢量库，用于在 iPhone 上显示动画图形。可能显示 SVG 的东西。任何人有任何想法或见解？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-31T18:54:26.887

Quartz，即已经内置在手机中的矢量图形库。根据需求，您可以为您实际计划使用的 SVG 规范部分编写解析器。例如，您的应用程序可能只需要 Tiny SVG 规范。

抱歉，这个答案并没有指向一个已经存在的框架，但取决于你真正需要它的程度，推出你自己的或开始一个开源项目可能是有意义的（特别是因为这是人们的那种项目可能会很乐意为之做出贡献）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T17:08:10.643

*   网络套件
*   libsvg
*   开罗

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T01:20:11.023

[GCDrawKit](http://apptree.net/drawkit.htm)是一个出色的矢量图框架，但它还没有原生支持 SVG 并且是围绕 AppKit 构建的，所以它不兼容 iPhone。它也不适合动画。

WebKit 在 Mac 上提供了对 SVG 的原生支持，甚至可以让你操作 DOM 来修改或保存 SVG，但我不相信你在 iPhone 上没有足够的访问权限来做同样的事情。

最好的办法是为 SVG XML 编写解析器（这种格式并不太难），使用 Quartz 进行绘图，并使用 Core Animation 支持动画元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T22:41:40.883

github.com/SVGKit/SVGKit - iOS 上几乎但不完全符合标准的 SVG 库。（仅供参考，我是维护者之一）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-10T06:25:18.633

UIWebView 非常适合 SVG。只需将其放入 IB 的应用程序中，将文件加载到其中即可。

然后您可以从 ObjC 调用 JavaScript，这对于操作非常有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-05T21:19:13.790

我刚刚回答了另一个 cocoa-touch SVG 问题： [在 iphone 上绘制矢量图形](https://stackoverflow.com/questions/1520768/drawing-vector-graphics-on-iphone/4110159#4110159)

但我的一般建议是查看 GitHub 以获得答案（Objective-c 和 SVG 搜索）

[https://github.com/search?type=Everything&language=objective-c&q=SVG](https://github.com/search?type=Everything&language=objective-c&q=SVG)

# .net - Silverlight 安全吗？

> ID：403489
> 
> 赞同：4
> 
> 时间：2008-12-31T17:06:32.457
> 
> 标签：.net, flash, silverlight, security

我们需要在最终用户的机器上运行并为我们提供评分结果的应用程序，并且我们需要结果准确（即不被篡改）。目前，Flash 和 Silverlight 之间存在争论，看起来 Silverlight 将成为赢家。

除了最终用户机器上的任何东西都必须被认为受到损害的说法之外，攻击 SilverLight 应用程序有多难？我知道这取决于代码的编写方式等，而我的问题实际上是攻击底层平台有多难。是否有文章介绍如何轻松地执行诸如引导silverlight 应用程序和更改运行代码（或其他方法）之类的事情？我在想类似缓冲区溢出攻击来插入其他可执行代码？

我还听说 Flash 应用程序很难攻击内存和执行任意代码。这是真的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-31T17:22:42.283

我的理解是 Silverlight 在名为 CoreCLR 的公共语言运行时 (CLR) 版本上运行。与在浏览器中运行的任何应用程序一样，主要的安全方案是防止恶意代码攻击应用程序的其他实例或用户计算机上的应用程序/数据。

您描述的这种情况与此不同，我想说几乎没有采取积极措施来防止您的代码被劫持。具有足够知识的用户可以轻松地在汇编级别编辑代码。

您可以尝试通过以下方式缓解这些攻击：

*   阻止访问复杂的调试工具（除非您控制客户端机器，否则不可能）。
*   为每个用户甚至每个会话生成模糊或随机的 Silverlight 代码。从理论上讲，这可能会阻止用户共享黑客。如果您可以使代码超时，则通过在 30 分钟后使其陈旧，您会使其变得更加困难。
*   减少应用程序中的逻辑量，并在服务器端为其提供 Web 服务。

专家攻击者攻击在 Flash VM 中运行的应用程序就像攻击 Silverlight 一样容易。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-31T17:10:34.790

在用户机器上运行的任何东西都可以修改。这只是用户努力的问题。

如果您想查找一些示例，有无数关于如何“破解”Flash 游戏的教程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-31T17:12:56.360

无论您提供什么机制来在客户端和服务器之间进行通信，都可能被黑客入侵。即使您使用 SSL，用户也可以执行中间人攻击（安全性由浏览器处理，因此如果用户覆盖 SSL 证书，它将被允许），以访问您的数据协议.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-31T17:17:14.493

作为您特定场景中的攻击者，我首先会考虑简单地运行一个代理来修改从应用程序发送回您的站点的数据内容。在我致力于破坏可执行文件本身之前，我会尝试那么久。即使使用加密，从您的应用程序中提取证书/密钥以进行代理可能仍然更容易，而不是完全破坏可执行文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T17:13:01.460

老实说，我认为这两个平台都是安全的。直到今天，我还不**知道**Silverlight（1.0 或 2.0）曾经有任何安全漏洞。也就是说，如果在任何平台上发现了任何问题，我相信这两个问题都会很快得到解决。

但是，给你一个问题。您为什么要在客户端计算机上而不是托管服务器上存储任何内容？Silverlight 2.0 对 .NET 框架有一个特殊的“精简”实现，据我所知，出于安全原因，所有文件系统访问都已被删除。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T17:15:31.690

我认为 Silverlight 在沙盒方面相当不错，但它是相当新的，因此从安全角度来看，它不太可能像 Flash 那样深入探讨。

如您所知，您根本不会在客户端上找到有保证的安全平台，因此明智的做法是确保您的数据以一种很难妥协的方式在两者之间传递。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-31T17:22:02.283

我同意 foxxtrot 的观点，即 Silverlight 应用程序和您的服务器之间的通信将与任何其他 Web 服务架构一样安全。这是您的主要攻击媒介，因为客户端恶意软件不太可能在 Silverlight 的情况下造成问题，至少不会窃取数据。

您可以对 Web 服务调用进行加密，并且可能会尽可能地使用客户端证书来防止向您的 Web 服务发送虚假帖子。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-15T06:07:51.957

下载有关 silverlight 安全性的白皮书。告诉你所有你需要知道的：

编写和部署 Silverlight Applications.docx 的安全指南：http: [//www.microsoft.com/downloads/details.aspx? displaylang=en&FamilyID=7cef15a8-8ae6-48eb-9621-ee35c2547773](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=7cef15a8-8ae6-48eb-9621-ee35c2547773)

如果您无法打开 docx，只需删除“x”，它将在 word 2003 中打开；-)

作为一个

# linq-to-sql - C# LINQ 相当于一个有点复杂的 SQL 查询

> ID：403505
> 
> 赞同：1
> 
> 时间：2008-12-31T17:13:20.710
> 
> 标签：linq-to-sql

所以我有一个 SQL 查询如下

```
SELECT P.Date, P.CategoryName, P.ProductName, SUM(Quantity) Quantity, SUM(Sales) TotalSales, IsLevelThree
FROM Products P LEFT JOIN LevelThreeTracking LTT
    ON P.Date = LTT.Date AND P.CategoryName = P.CategoryName AND P.SecurityID = LTT.SecurityID
WHERE P.Date = '12-31-2007' AND P.CategoryName= 'CategoryName'
GROUP BY P.Date, P.CategoryName, P.ProductName, LTT.IsLevelThree
HAVING SUM(Quantity) <> 0
ORDER BY P.ProductName 
```

我正在尝试将其转换为 C# LINQ 语法并使用 2 个表设置 DataContext。我已经尝试了几次（下面的最新版本），但是生成的 sql 看起来非常复杂并且超时。dtpBeginning 是一个 DateTimePicker。

```
var results = from p in dbFAS.Products
group p by new {p.Date, p.CategoryName, p.ProductName}
into gp
join ltt in dbFAS.LevelThreeTracking on
new {gp.Key.Date, gp.Key.CategoryName, gp.Key.ProductName} equals
new {ltt.Date, ltt.CategoryName, ltt.ProductName} into everything
from e in everything.DefaultIfEmpty()
where gp.Key.Date == dtpBeginning.Value.Date && gp.Key.CategoryName == "CategoryName" && gp.Sum(p=>p.Quantity) != 0
select new
{
    gp.Key.Date,
    gp.Key.CategoryName,
    gp.Key.ProductName,
    Quantity = gp.Sum(hp=>hp.Quantity),
    TotalSales = gp.Sum(hp=>hp.Sales),
    e.Level3
}; 
```

我缺少一些简单的东西吗？关于如何重构 LINQ 语句以获得更好的东西的任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-31T17:15:51.517

它真的需要转换为 LINQ 吗？我建议您将该查询放在存储过程中，因为等效的 LINQ 查询非常难以阅读和维护。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-31T18:52:56.440

试试这个查询，让我知道它是否有效。我将连接更改为 where 子句，这应该消除 LINQ 在转换为 SQL 时生成的所有复杂子查询。

我不确定我的 LEFT OUTER JOIN 部分是否正确。我只是包含了一个 OR 条件来测试一侧是否存在。

```
from p in dbFAS.Products
from ltt in dbFAS.LevelThreeTracking
where p.CategoryName == "CategoryName"
    && (p.Date == ltt.Date || p.Date)
    && (p.CategoryName == ltt.CategoryName || p.CategoryName)
    && (p.ProductName == ltt.ProductName || p.ProductName)
    && p.Quantity > 0
group p by new {p.Date, p.CategoryName, p.ProductName, p.Quantity, p.Sales, ltt.Level3}
into gp
select new
{
    gp.Key.Date,
    gp.Key.CategoryName,
    gp.Key.ProductName,
    Quantity = gp.Sum(hp=>hp.Quantity),
    TotalSales = gp.Sum(hp=>hp.Sales),
    ltt.Level3
}; 
```

**编辑：** 我想了更多，这可能会更清楚一点，甚至可以编译！（最后一个不会因为 || 子句）

```
from gp in
    (from p in dbFAS.Products
    join ltt in dbFAS.LevelThreeTracking on 
        new {p.Date, p.CategoryName, p.ProductName}
        equals new {ltt.Date, ltt.CategoryName, ltt.ProductName}
        into temp
    where p.CategoryName == "CategoryName"
        && p.Quantity > 0
    from t in temp.DefaultIfEmpty()
    select new
    {
        p.Date,
        p.CategoryName,
        p.ProductName,
        p.Quantity,
        p.Sales,
        t.Level3
    })
group gp by new {gp.Date, gp.CategoryName, gp.ProductName, gp.Level3}
select new
{
    gp.Key.Date,
    gp.Key.CategoryName,
    gp.Key.ProductName,
    Quantity = gp.Sum(hp=>hp.Quantity),
    TotalSales = gp.Sum(hp=>hp.Sales),
    gp.Level3
} 
```

# asp.net-mvc - 使用 ASP.NET MVC 将数据从控制器传递到用户控件视图

> ID：403509
> 
> 赞同：1
> 
> 时间：2008-12-31T17:15:09.490
> 
> 标签：asp.net-mvc, user-controls

我有一个视图类（OrderView.aspx），它通过Repeater 控件显示订单的详细信息（帐户名称、订单日期）以及订单行列表。每个订单行由一个用户控制视图 (OrderLineView.ascx) 表示，该视图显示了订单行的详细信息（项目名称、数量、价格）。我有一个名为 Order 的模型对象，我将其用作所有这些的数据源，我将其作为视图的模型对象传递。

每个 OrderLineView 用户控件都有一个保存和删除按钮。我有 Save 按钮将 OrderLine 控件中的表单内容发布到 Controller 上的 Save 方法，然后 RedirectToAction 回到同一个 Order 页面（这会刷新整个页面，没有关于它的 AJAXy）。我将删除按钮链接到控制器上尝试删除的方法，然后将 RedirectToAction 返回到同一订单页面。但是，如果删除失败，我希望当页面再次呈现时，删除按钮旁边会显示一个小错误消息（请记住，页面上的每个订单行都有一个删除按钮，所以我只希望消息旁边我点击的那个）。我的问题：

1 - 如何将此数据从我的控制器方法传递到特定的用户控件？我应该以某种方式将其添加到模型中吗？似乎是个坏主意（因为它确实不是模型的一部分）。

2 - 我应该有一个用于 OrderLine 操作的 OrderLineController 以及一个用于 Order 操作的 OrderController 吗？我只想知道最佳实践是否为每个视图都有一个单独的控制器。

3 - 我看到有些人可能会使用这样的匿名类型值调用 RedirectToAction：

```
RedirectToAction("ViewOrder", new { Id = 1234, Message = "blabla"}); 
```

但这会使 Message 值显示在 URL 字符串中。我对此表示同意，但如果可能的话，我希望它不显示。

4 - 另外，为了从视图中访问模型的属性，我发现自己一直在这样做：

```
foo(((someModelType) this.ViewData.Model).SomeProperty); 
```

我不喜欢这个有很多原因，其中之一是我不希望我的视图与我的模型类型相结合（这就是我使用 ViewPage 而不是 ViewPage 的原因）。我更希望能够有这样的电话：

```
foo(ModelEval("SomeProperty")); 
```

有这样的事吗？我自己写了，但如果我不需要的话，我会喜欢它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T17:44:20.460

# 1

查看模型状态。

```
ViewData.ModelState.AddModelError("something.Name", "Please enter a valid Name"); 
```

ModelState 实际上是一个字典，因此您可以在每个控件的基础上识别错误。我不知道这是否是最佳做法，但它可能会奏效。尝试一些类似的东西

```
ViewData.ModelState.AddModelError("something#3.Name", "Please enter a valid Name"); 
```

在你看来，你可以把

```
<%= Html.ValidationMessage(string.format({"something{0}.Name", YourUniqueId))%> 
```

# 4

您可以强烈键入您的视图，因此您不需要该强制转换，但如果您担心紧密耦合，这可能会让您望而却步。但是拥有强类型没有比让一个魔术字符串指向模型的那个属性更紧密的耦合了。前者只是给你类型安全和智能感知的荣耀。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T17:36:38.840

由于您的 OrderLine 有一个唯一的 ID，您可以使用它来构造一个放置在 ModelState 错误容器中的键。

```
public ActionResult Delete(int? Id)
{
    ModelState.AddModelError("OrderLine" + Id.Value, "Error deleting OrderLine# " + Id.Value);

    ...    
} 
```

然后使用 ValidatinoMessage 助手。这将检查 ModelState 以查看是否存在错误，如果存在，它将显示消息。否则它是空白的。

```
<%= Html.ValidationMessage ("OrderLine" + Id)%> 
```

在 MVC 的下一个版本中，模型将成为顶级属性，因此以下

```
foo(((someModelType) this.ViewData.Model).SomeProperty); 
```

可以写成

```
foo(Model.SomeProperty); 
```

除非您将*公共对象*用作属性，否则应该已经键入模型对象？

# php - PHP - 查找包含当前文档的脚本的 URL

> ID：403516
> 
> 赞同：3
> 
> 时间：2008-12-31T17:16:59.487
> 
> 标签：php, url, include

我制作了一个模板，它设置了很少更改的变量，调用我的标题，调用我的横幅和侧边栏，加载一个显示各个页面的变量，然后调用页脚。在我的一个标题中，我想要用户地址栏中的页面 URL。有没有办法做到这一点？

目前：

```
<?php
$title = "MySite - Contacts";
include("header.php");
.
.
.
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T17:58:56.377

您将感兴趣的主要变量是：

`$_SERVER['REQUEST_URI']`保存访问的路径，例如`/foo/bar` `$_SERVER['PHP_SELF']`是主 PHP 文件的路径（*不是*您所在的文件，因为它可能是包含但实际的基本文件）

在 $_SERVER 中还有很多其他有用的变量值得记住，所以要么：

```
print_r($_SERVER); 
```

或者只是访问[http://php.net/manual/en/reserved.variables.server.php的文档](http://php.net/manual/en/reserved.variables.server.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-13T17:55:14.473

被调用的Page的Web地址，可以通过以下函数获得::

```
function curPageURL() {
 $pageURL = 'http';
 if ($_SERVER["HTTPS"] == "on") {$pageURL .= "s";}
 $pageURL .= "://";
 if ($_SERVER["SERVER_PORT"] != "80") {
  $pageURL .= $_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER["REQUEST_URI"];
 } else {
  $pageURL .= $_SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];
 }
 return $pageURL;
} 
```

我在很多地方都用过这个，在谷歌上找到的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T17:22:10.193

这听起来像是`$_SERVER['REQUEST_URI']`你所追求的。

# asp.net-mvc - ASP.NET MVC and .NET 3.5 SP1 on Windows Server 2003 and IIS

> ID：403524
> 
> 赞同：3
> 
> 时间：2008-12-31T17:19:03.803
> 
> 标签：asp.net-mvc, windows-server-2003, .net-3.5

I am writing a website for a client who says their servers run the following: "Windows 2003 with the latest IIS". What do I need to do to get them ready for hosting my ASP.NET MVC website built with .NET 3.5SP1?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-31T17:32:24.667

您可能还会在 Win2k3 上遇到 IIS6 的问题。Phil Haack 在他的博客[Asp.Net MVC on IIS 6 Walkthrough](http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx)上发表了一篇出色的演练。

您还需要以下先决条件：

*   [.Net 3.5 SP1](http://msdn.microsoft.com/en-us/vstudio/products/cc533447.aspx)
*   [Asp.Net MVC 测试版](http://www.asp.net/MVC/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T17:20:54.627

让他们安装 .Net 3.5 SP1 redist。

**编辑**他们将不得不为您的 Web 应用程序创建虚拟目录，在该目录上创建应用程序，提供适当的权限，并可能手动将 ASP.Net 设置为 v2.0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-23T06:02:35.457

装有最新 IIS 的 Windows 2003？嗯，这是不可能的，因为您无法在 Windows Server 2003 上运行 IIS7。您需要升级到 Windows Server 2008 才能运行最新的 IIS。

也就是说，如果您正在运行 IIS6，则必须跳过一些障碍。[Phil Haack 记录](http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx)了一些最佳实践（网址文件扩展名或通配符应用程序映射），这将有助于让您的应用程序正确运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T17:23:33.547

如果要对 MVC 进行 bin 部署，只需安装 .NET 3.5 SP1。如果你想在 GAC 中安装 MVC，他们也应该安装 MVC beta。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T17:39:33.497

创建一个 Web 设置项目并添加 .net 3.5 作为先决条件。安装程序询问要安装到哪个虚拟目录。

# python - 在两个表中进行 SQL 查询

> ID：403527
> 
> 赞同：0
> 
> 时间：2008-12-31T17:20:11.557
> 
> 标签：python, sql

我想知道，是否可以进行与 `'select products where barcode in table1 = barcode in table2`'. 我正在 python 程序中编写这个函数。调用该函数后，该表将永久连接还是仅在该函数运行时连接？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-31T17:22:52.487

```
SELECT t1.products
FROM [Table1] t1
INNER JOIN [Table2] t2 ON t2.barcode = t1.barcode 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-31T17:22:26.777

我想你想加入两个表：

[http://www.w3schools.com/Sql/sql_join.asp](http://www.w3schools.com/Sql/sql_join.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T17:21:53.067

就像是：

```
SELECT * FROM table1 WHERE barcode IN (SELECT barcode FROM table2) 
```

那是你要找的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T19:26:14.547

这是基于两个表中的公共字段内部连接两个表的示例。

SELECT table1.Products FROM table1 INNER JOIN table2 on table1.barcode = table2.barcode WHERE table1.Products 不为空

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T19:48:49.477

在这些情况下，这是一种基于对象角色建模的表格设计方式。（是的，我意识到这只是与问题间接相关。）

你有产品和条形码。产品由产品代码唯一标识（例如“A2111”；条形码由值唯一标识（例如1002155061）。

一个产品有一个条形码。问题：产品可以没有条形码吗？同一个产品可以有多个条码吗？多个产品可以有相同的条形码吗？（如果您对 UPC 标签有任何经验，您就会知道所有这些问题的答案都是正确的。）

所以你可以做出一些断言：

一个产品（代码）有零个或多个条形码（值）。
条形码（值）具有一个或多个产品（代码）。-- 假设：如果条形码与产品没有/没有/不会与产品相关，我们的条形码就没有独立存在）。

这直接（通过您的 ORM 模型）导致具有两个表的模式：

产品
ProductCode(PK) 描述等

ProductBarcode
ProductCode(FK) BarcodeValue
-- 带有两部分自然主键，ProductCode + BarcodeValue

然后按照其他答案中的描述将它们联系在一起。

类似的断言可用于确定哪些字段进入您设计中的各个表中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T17:57:07.580

```
SELECT table1.*, table2.* FROM table1 left join table2 on table1.barcode = table2.barcode 
```

# .net - 什么是扩展方法？

> ID：403539
> 
> 赞同：55
> 
> 时间：2008-12-31T17:24:29.673
> 
> 标签：.net, extension-methods

.NET 中的扩展方法是什么？

[编辑：我在扩展方法](https://stackoverflow.com/questions/403619/usage-of-extension-methods)的使用上发布了一个后续问题

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-12-31T17:28:39.417

> **扩展方法**允许开发人员向现有 CLR 类型的公共协定添加新方法，而无需对其进行子类化或重新编译原始类型。
> 
> 扩展方法有助于将当今动态语言中流行的“鸭子类型”支持的灵活性与强类型语言的性能和编译时验证相结合。

*参考：[http ://weblogs.asp.net/scottgu/archive/2007/03/13/new-orcas-language-feature-extension-methods.aspx](http://weblogs.asp.net/scottgu/archive/2007/03/13/new-orcas-language-feature-extension-methods.aspx)*

这是一个扩展方法的示例（注意`this`第一个参数前面的关键字）：

```
public static bool IsValidEmailAddress(this string s)
{
    Regex regex = new Regex(@"^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$");
    return regex.IsMatch(s);
} 
```

现在，可以直接从任何字符串调用上述方法，如下所示：

```
bool isValid = "so@mmas.com".IsValidEmailAddress(); 
```

添加的方法也将出现在 IntelliSense 中：

[![替代文字](https://i.stack.imgur.com/vjsGG.jpg)](https://i.stack.imgur.com/vjsGG.jpg)
[（来源：[scottgu.com](http://www.scottgu.com/blogposts/extensionmethods/step1.jpg)）]

至于扩展方法的实际用途，您可以在不派生新类的情况下向类添加新方法。

看看下面的例子：

```
public class Extended {
    public int Sum() {
        return 7+3+2;
    }
}

public static class Extending {
    public static float Average(this Extended extnd) {
        return extnd.Sum() / 3;
    }
} 
```

如您所见，该类`Extending`正在向 class 添加一个名为 average 的方法`Extended`。要获得平均值，请调用`average`方法，因为它属于`extended`类：

```
Extended ex = new Extended();

Console.WriteLine(ex.average()); 
```

*参考：[http ://aspguy.wordpress.com/2008/07/03/a-practical-use-of-serialization-and-extension-methods-in-c-30/](http://aspguy.wordpress.com/2008/07/03/a-practical-use-of-serialization-and-extension-methods-in-c-30/)*

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-04-22T05:57:18.480

## 扩展方法 - 简单说明

即使您无权访问原始源代码，您也可以为某些东西添加方法。让我们考虑一个例子来解释这一点：

### 例子：

假设我有一条狗。所有的狗——所有类型的狗——做某些事情：

1.  吃
2.  WagsTail
3.  喊“汪/弓/汪！” ETC

狗能做的事，统称为“方法”。现在让我们假设 OO Heaven 中的 Great Programmer 忘记在 dog 类中添加一个方法：FetchNewspaper()。你希望能够说：

```
rex.FetchNewspaper(); // or
beethoven.FetchNewspaper(); 
```

......即使您*无权*访问源代码。

**你是如何让你的狗这样做的？**您唯一的解决方案是创建一个“扩展方法”。

## 创建扩展方法

（注意下面第一个参数前面的“this”关键字）：

```
public static void FetchNewsPaper(this Dog familyDog)
{
     Console.Writeline(“Goes to get newspaper!”)
} 
```

如果你想让你的狗得到报纸，只需这样做：

```
Dog freddie_the_family_dog = new Dog();

freddie_the_family_dog.FetchNewspaper(); 
```

*您可以在没有源代码*的情况下将方法添加到类中。这非常方便！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-31T17:28:33.100

扩展方法是开发人员向他们无法控制的对象“添加”方法的方式。

例如，如果您想向 System.Windows.Forms 对象添加“DoSomething()”方法，因为您无权访问该代码，您只需使用以下语法为表单创建扩展方法。

```
Public Module MyExtensions

    <System.Runtime.CompilerServices.Extension()> _
    Public Sub DoSomething(ByVal source As System.Windows.Forms.Form)
        'Do Something
    End Sub

End Module 
```

现在，您可以在一个表单中调用“Me.DoSomething()”。

总之，这是一种无需继承即可向现有对象添加功能的方法。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-31T17:39:37.583

扩展方法是一种“编译器技巧”，它允许您模拟将方法添加到另一个类，即使您没有它的源代码。

例如：

```
using System.Collections;
public static class TypeExtensions
{
    /// <summary>
    /// Gets a value that indicates whether or not the collection is empty.
    /// </summary>
    public static bool IsEmpty(this CollectionBase item)
    {
        return item.Count == 0;
    } 
} 
```

理论上，所有集合类现在都包含一个`IsEmpty`方法，如果该方法没有项目则返回 true（前提是您已包含定义上述类的命名空间）。

如果我错过了任何重要的事情，我相信有人会指出它。（请！）

当然，关于扩展方法的声明有一些规则（它们必须是静态的，第一个参数必须在`this`关键字之前，等等）。

扩展方法实际上并不修改它们看起来正在扩展的类；相反，编译器会破坏函数调用以在运行时正确调用该方法。但是，扩展方法正确地显示在带有独特图标的智能感知下拉列表中，您可以像使用普通方法一样记录它们（如上所示）。

**注意：**如果已存在具有相同签名的方法，则扩展方法*永远不会替换方法。*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T18:46:04.363

这是 VB.Net 中的示例；注意 Extension() 属性。将其放在项目中的模块中。

```
Imports System.Runtime.CompilerServices
<Extension()> _
Public Function IsValidEmailAddress(ByVal s As String) As Boolean
    If String.IsNullOrEmpty(s) Then Return False

    Return Regex.IsMatch(email, _
         "^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$")
End Function 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-07-12T17:45:08.713

扩展方法是我们可以将方法添加到现有数据类型的技术。下面是我们如何向现有数据类型添加方法的示例。

1.  我们创建了一个扩展方法类，我们在其中创建了各种扩展方法

代码：

```
public static class ExtensionMethods
{
    public static int WordCount(this string str)
    {
        return str.Split(' ').Count();
    }

    public static int LongestWord(this string str)
    {
        return str.Split(' ').Select(x =>
                x.Length).OrderByDescending(y =>
                y).FirstOrDefault();
    }
} 
```

2.  下面是我们调用上述类中指定的扩展方法的程序类。

代码：

```
public static void Main(String[] args)
{
    string str = "this is my name    punit";
    int i = str.LongestWord();
} 
```

关键点：

*   扩展方法类需要是静态的

*   扩展方法的第一个参数将具有 this 关键字，并且该方法也应该是静态的

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-01-12T12:30:19.760

扩展方法是一种特殊的静态方法。它允许我们在现有类型中添加方法，而无需修改现有类型。例如，如果您有 Customer 类，并且您需要在其中添加一个方法而无需在 Customer 类中进行修改，对于这种情况，我们有扩展方法。有关更多示例，请参阅此链接 [https://princesid85.wixsite.com/website/home/you-ve-been-holding-your-pen-wrong-your-entire-life](https://princesid85.wixsite.com/website/home/you-ve-been-holding-your-pen-wrong-your-entire-life)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-10T22:10:35.083

这个问题已经得到解答，但我想补充一点，如果您有另一个项目中的类型并且您不想返回该项目以添加一些功能，这将非常有用。我们正在使用 NHibernate，并且有一个项目用于我们的数据持久层，人们希望保持清洁。为了在这些对象上获得好的和可发现的附加方法，我能够使用扩展方法，它真的让我的一天变得更加美好。

此外，由于没有其他人发布它，这是 MSDN 上一篇关于它的好文章 - [http://msdn.microsoft.com/en-us/library/bb383977.aspx](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-12T09:15:33.260

我想我会添加一个更具概念性且更少依赖代码的解释。

想象一辆福特汽车从施工线上滚下来。您无法使用施工线，但您希望所有福特汽车都能够在汽车后部添加额外的扰流板（展示时看起来更酷）。你打算怎么做？在计算世界中，除非您可以使用福特工厂内的原始施工线，否则您不能只是将东西用螺栓固定到福特上。现在你可以：输入扩展方法。

现在您可以执行以下操作：

```
Ford hilux = new Ford();

hilux.DisplayRearFoiler(); // you can now do this even though you don't have access to the Ford source code. 
```

您必须创建扩展方法。参考上面的答案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-07-02T19:22:25.980

我想用**Sealed class**来回答扩展方法。

假设您有一个包含重要方法的**密封类。**您现在想向它添加一个新方法。假设这个类在一个外部 DLL 中，所以你不能向它添加新方法。你会做什么 ？

再举一个例子。假设您的项目经理或安全大师在您的应用程序中构建了该类。只有在获得项目经理或安全大师的许可后，您才能编辑该类。

> 您的解决方案可能是从此类中删除密封关键字并在其他类中继承它。然后在子类（继承此类）中，您可以添加新方法。

但是等待 -> 您不能简单地删除密封关键字，因为这会危及整个应用程序的安全性。我敢打赌，您的 PM 或安全专家永远不会以安全问题为由授予您该权限。

那么在这里可以做什么呢？

答案是可以添加到静态类中的**扩展方法**，您甚至不需要再接触密封类。

**例子：-**

```
sealed class MyData
{
    private double D1, D2, D3;
    public MyData(double d1, double d2, double d3)
    { D1 = d1; D2 = d2; D3 = d3; }
    public double Sum() { return D1 + D2 + D3; }
}

static class ExtendMyData
{
    public static double Average(this MyData md)
    {
        return md.Sum() / 3;
    }
} 
```

我向一个新的静态类添加了一个名为**Average的公共静态方法。**这个方法有主类的参数，前面有'this'关键字。

现在调用 Average 方法，我使用父密封类的对象而不是子类。

```
 MyData md = new MyData(3, 4, 5);
 double exAverage = md.Average(); 
```

希望您发现扩展方法有用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-04-09T13:32:43.767

**C# 中的扩展方法**

什么是扩展方法？

```
Extension method means Class name and method name are having with Static Key word. 
```

使用“this”关键字的扩展方法，应该是第一个签名是提及识别地址，这个类型必须与like相同，

公共静态字符串方法（**此字符串**i，int j）

和

字符串 res = **"ae"** .Meth(num);

粗体部分为识别地址。命名空间应该相同。

**为什么我们需要扩展？**

我们在很多地方都使用相同的功能，之后找不到我们在这里使用的原因。为此使用地址标识。静态意味着单个实例。这只能访问静态成员函数。甚至在静态类中没有静态类方法如何访问？例如：参见“Sal”方法中的抛出错误，

静态类 Emp { public int Sal(int i,int j) { return i * j; } }

仅访问静态成员。和

[在此处输入图像描述](https://i.stack.imgur.com/zAQjK.jpg)

以下代码我们无法在静态类中为非静态类创建对象。那么如何将非静态方法访问到静态类中。因此，我们遵循不继承的扩展方法。

例如，在此处使用 Extension 方法添加或什至功能，

使用系统。文本;

使用 System.Threading.Tasks；

命名空间 Extension_Method { 静态类程序 {

```
 public static string Meth (this string i,int j)
    {
        if (j % 2 == 0)
        {
            return "Even";
        }
        else
        {
            return "ODD";

        }
    }

}
class program2
{
    static void Main (string [] args)
    {
        Console. WriteLine ("Enter Integer");
        int num = Convert.ToInt32(Console.ReadLine());

        string res = "ae".Meth(num);

        Console. WriteLine(res);
        Console.ReadLine();
    }
} 
```

结果：

[在此处输入图像描述](https://i.stack.imgur.com/WxYSC.jpg)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-12-29T14:19:51.013

有时我们想将我们自己的附加功能添加到一个类型中，并将它们用作该类型上的常用实例方法。如果我们有源代码，我们可以轻松添加新功能而无需创建扩展方法。但是当我们没有源代码并且仍然想添加和调用附加功能作为类型上的实例方法时，就会出现问题；扩展方法用于将我们自己的功能添加到类型中并在源代码不可用时将它们用作类型上的实例方法。

当我们想要添加我们自己的功能时，我们甚至可以**创建一个单独的静态类**并在我们的代码中调用它的静态方法，而不是创建扩展方法，但问题可能是**代码可读性**。

**LINQ**极大地受益于扩展方法。

它们在开发时非常有用，因为使用 Intellisense 可以很容易地为多个开发人员提供所需的方法；而对于静态方法，我们每次都必须在代码中编写*className.MethodName() 。*

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-01-23T18:06:36.603

```
/// <summary>
/// External Library Code
/// </summary>
namespace ExternalLibrary
{
    public class Calculator
    {
        public int Number1 { get; set; }
        public int Number2 { get; set; }

        public int Addition()
        {
            return Number1 + Number2;
        }

        public int Subtraction()
        {
            return Number1 - Number2;
        }
    }
} 
```

* * *

```
using ExternalLibrary;
using System;

namespace StackOverFlow
{
    class Program
    {
        static void Main(string[] args)
        {
            Calculator calc = new Calculator()
            {
                Number1 = 5,
                Number2 = 3
            };
            Console.WriteLine(calc.Addition());
            Console.WriteLine(calc.Subtraction());

            // Here we want multiplication also. but we don't have access Calculator
            // class code, so we can't modify in that.
            // In order to achieve this functionality we can use extension method.
            Console.WriteLine(calc.Multiplication());

            Console.ReadLine();
        }
    }

    /// <summary>
    /// Extension Method for multiplication
    /// </summary>
    public static class CalculatorExtension
    {
        public static int Multiplication(this Calculator calc)
        {
            return calc.Number1 * calc.Number2;
        }
    }
} 
```

# java - 具有 OID 的值对象

> ID：403549
> 
> 赞同：2
> 
> 时间：2008-12-31T17:27:52.443
> 
> 标签：java, pojo, oid

您能否描述在代表模型中实体的[POJO中包含](http://en.wikipedia.org/wiki/Plain_Old_Java_Object)[OID](http://en.wikipedia.org/wiki/Object_identifier)（通常是数据库行标识符）的优缺点？

事实上，我不是在谈论与 equals/hashcode 等相关的问题，我应该更好地描述我的问题（我的错误:)）...

我们有一些代表业务对象的实体类（如产品、目录等......）。有时他们有一个“企业 id”，例如可以通过其唯一的 ProductId 找到产品（它有 3 个字段：id、类型、存储库）。

在我们的数据库中，除了 3 个业务列（id、type、repository）之外，Product 表还有一个代理主键列 (OID)，以方便外键引用并减少连接子句。

Product/ProductId 类是我们向其他应用程序公开的 API 的一部分。例如，他们可以调用：

```
productManager.findProductById(ProductId productId); 
```

问题是，知道我们的客户应该使用 ProductId 标识符，是否应该将 OID 包含在 Product 或 ProductId 类中。

**优点：**

*   我可以使用 OID 进行另一个查找，例如

    ```
    Product p = productManager.findProductById(ProductId productId);
    Catalog c = productManager.findAllCatalogsContainingProduct(p.getOid()); 
    ```

我们习惯于通过 ProductId 在应用程序中查找很多内容，因此这可以节省每次往返数据库的时间，以避免找到与 ProductId 匹配的 OID。

**缺点：**

*   我刚刚向客户公开了 OID（希望他不要使用它而不是业务密钥！！）

你能列出其他优点和缺点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T17:34:31.900

数据库行标识符 = 主键？如果是这样，则没有优点或缺点，您必须拥有它，否则您无法将 POJO 关联回其相应的数据库行。

要检索产品和目录，标准的 SQL 方法是进行联接。例如，使用我的 DAL，我可以：

```
SearchCriteria sc = new SearchCriteria();
sc.AddBinding("ProductId", productId);
List<Entity> Products = SQL.Read(sc, new Product(new Catalog()); 
```

或者

```
List<Entity> Products = SQL.Read(sc, new Catalog(new Product()); 
```

这样就不需要向调用者透露任何信息，也不需要往返。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T17:38:48.350

如果您的 equals() 或 hashCode() 的实现基于标识符，您可能会遇到问题，因为它最初可能为 null，然后在对象持久化后更改。见下文：

[http://java.sun.com/javase/6/docs/api/java/util/Set.html](http://java.sun.com/javase/6/docs/api/java/util/Set.html)

注意：如果将可变对象用作集合元素，则必须非常小心。如果对象的值以影响等于比较的方式更改，而对象是集合中的一个元素，则不指定集合的​​行为。此禁令的一个特殊情况是不允许集合包含自身作为元素。

假设您的 hashCode() 实现基于标识符，而 equals() 在其比较中使用 hashCode()。如果您将对象添加到 Set 并且其标识符为 null，则等于比较将以一种方式执行。如果您随后将对象保存在集合中，则其标识符值可能会更改，从而更改 equals() 和 hashCode() 的行为。如上所述，这打破了 Set 的“合同”。

这有点极端，但值得注意。

# regex - 正则表达式如何在 selenium 中工作？

> ID：403560
> 
> 赞同：8
> 
> 时间：2008-12-31T17:30:33.673
> 
> 标签：regex, selenium, fitnesse, selenium-fitnesse-bridge

我想存储一个id的一部分，把剩下的扔掉。例如，我有一个 id 为“element-12345”的 html 元素。我想扔掉'元素-'并保留'12345'。我怎样才能做到这一点？

我可以捕获并回显该值，如下所示：

```
| 商店属性 | //pathToMyElement@id | 我的身份证 |
| 回声 | ${!-myId-!} | |
```

当我运行测试时，我得到如下信息：

```
| 商店属性 | //pathToMyElement@id | 我的身份证 |
| 回声 | ${myId} | 元素12345 |
```

我正在使用 Selenium IDE 进行录制，并使用 Selenium Bridge 夹具将测试复制到 Fitnesse 中。问题是我每次运行测试时都使用一个干净的数据库，我需要在整个测试过程中捕获和使用随机 id。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-05T18:02:20.643

解决方案是使用 JavaScript`replace()`函数`storeEval`：

```
| storeAttribute | //pathToMyElement@id                                   | elementID |
| storeEval      | '${elementID}'.replace("element-", "")                 | myID      | 
```

现在，如果我回`myID`显，我只会得到 ID：

```
| echo | ${myID} | 12345 | 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T17:44:06.517

/元素-(\d+)/i

这是一个正则表达式，它将捕获破折号后的数字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T23:33:39.307

像这样的东西*可能会*起作用：

```
| storeAttribute | fn:replace(//pathToMyElement@id,"^element-","") | myId | 
```

执行正则表达式需要 XPath 2.0 - 不确定 Selenium 实现了哪个版本。

# java - 您可以通过击键在 Eclipse 中组织整个项目的导入吗？

> ID：403569
> 
> 赞同：145
> 
> 时间：2008-12-31T17:33:49.390
> 
> 标签：java, eclipse, keyboard-shortcuts

只敲击一个键并让 eclipse 组织所有 java 类中的所有导入，而不是只组织你正在查看的类，这不是很好吗？这可能吗？有按键吗？

* * *

## 回答 #1

> 赞同：273
> 
> 时间：2008-12-31T17:46:35.200

在包资源管理器中选择项目并按`Ctrl`+ `Shift`+ `O`（与单类版本相同的按键）。应该适用于包裹等。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-31T17:35:38.857

您可以在保存时编辑清理选项以使其组织导入。这样，您的所有导入将始终被组织。

在 Eclipse 3.4 中，只需进入 Window - Preferences。在树视图中查看 Java -- Editor -- Save Actions。

这就是我一直保持我的导入井井有条的方式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-06-09T11:10:55.773

对于 Eclipse Helios，打开“Project Explorer”视图，在 src 文件夹上单击，进入源菜单，然后单击应该适用于所有项目的“组织导入”。或者只是点击 src 文件夹上的组合++ `Ctrl`。`Shift``O`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-26T11:10:47.580

如果要对整个项目运行保存操作，可以右键单击该项目，然后选择*Source* ，然后选择*Clean Up...*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-10T09:38:23.570

我的 Android 应用中有 Leadbolt 广告。在每个 Leadbolt 版本上，Leadbolt 都会强制我重新更新 java 导入的名称。例如，在我的应用程序中是：

```
import com.kwswsuyruzouggmtbzxb.* 
```

然后在更新时，他们给了我一个名为：

```
import com.izwevyqazy.* 
```

因此，我必须在大约 20 个或更多的 Java 源代码文件上将旧名称更改为新名称。所以，我所做的是在 Eclipse IDE 中使用这种方式重新组织导入：

1.  在您的应用程序中选择包名称，即项目文件夹中“src”文件夹下的那个。
2.  右键单击包名称并选择“组织导入”
3.  请不要忘记在 AndroidManifest.xml 中也更改名称；否则，您的应用程序将崩溃。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-20T21:10:39.597

对于 mac ，您可以使用`Cmd`++ `Shift`。`O`或者，您可以通过菜单进行操作：`Source -> Optimize Imports`

您可以在单个文件或每个源文件夹上运行它。如果您在项目资源管理器的项目级别尝试，该选项将显示为灰色。所以如果你有一堆模块和源文件夹，你可能需要做几次。:)

# c# - 如何从随机字节数组值中获取随机双值？

> ID：403572
> 
> 赞同：5
> 
> 时间：2008-12-31T17:34:54.037
> 
> 标签：c#, .net, random

我想使用 RNGCryptoServiceProvider 作为我的随机数来源。因为它只能将它们作为字节值数组输出，我如何将它们转换为 0 到 1 双精度值，同时保持结果的一致性？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-31T18:00:49.117

```
byte[] result = new byte[8];
rng.GetBytes(result);
return (double)BitConverter.ToUInt64(result,0) / ulong.MaxValue; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-10-25T09:54:15.587

我就是这样做的。

```
private static readonly System.Security.Cryptography.RNGCryptoServiceProvider _secureRng;
public static double NextSecureDouble()
{
  var bytes = new byte[8];
  _secureRng.GetBytes(bytes);
  var v = BitConverter.ToUInt64(bytes, 0);
  // We only use the 53-bits of integer precision available in a IEEE 754 64-bit double.
  // The result is a fraction, 
  // r = (0, 9007199254740991) / 9007199254740992 where 0 <= r && r < 1.
  v &= ((1UL << 53) - 1);
  var r = (double)v / (double)(1UL << 53);
  return r;
} 
```

> 巧合`9007199254740991 / 9007199254740992 is ~= 0.99999999999999988897769753748436`的是，该`Random.NextDouble`方法将返回的最大值是什么（请参阅[https://msdn.microsoft.com/en-us/library/system.random.nextdouble(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.random.nextdouble(v=vs.110).aspx)）。

一般来说，连续均匀分布的标准差为 (max - min) / sqrt(12)。

使用 1000 的样本量，我可以可靠地控制在 2% 的误差范围内。

使用 10000 的样本量，我可以可靠地控制在 1% 的误差范围内。

以下是我验证这些结果的方法。

```
[Test]
public void Randomness_SecureDoubleTest()
{
  RunTrials(1000, 0.02);
  RunTrials(10000, 0.01);
}

private static void RunTrials(int sampleSize, double errorMargin)
{
  var q = new Queue<double>();

  while (q.Count < sampleSize)
  {
    q.Enqueue(Randomness.NextSecureDouble());
  }

  for (int k = 0; k < 1000; k++)
  {
    // rotate
    q.Dequeue();
    q.Enqueue(Randomness.NextSecureDouble());

    var avg = q.Average();

    // Dividing by n−1 gives a better estimate of the population standard
    // deviation for the larger parent population than dividing by n, 
    // which gives a result which is correct for the sample only.

    var actual = Math.Sqrt(q.Sum(x => (x - avg) * (x - avg)) / (q.Count - 1));

    // see http://stats.stackexchange.com/a/1014/4576

    var expected = (q.Max() - q.Min()) / Math.Sqrt(12);

    Assert.AreEqual(expected, actual, errorMargin);
  }
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-12-31T17:49:52.680

您可以使用 BitConverter.ToDouble(...) 方法。它接受一个字节数组并将返回一个 Double。大多数其他原始类型都有相应的方法，以及从原始类型到字节数组的方法。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-12-31T17:54:48.520

使用 BitConverter 将随机字节序列转换为 Double：

```
byte[] random_bytes = new byte[8];  // BitConverter will expect an 8-byte array
new RNGCryptoServiceProvider().GetBytes(random_bytes);

double my_random_double = BitConverter.ToDouble(random_bytes, 0); 
```

# java - java中包级保护有什么用？

> ID：403583
> 
> 赞同：22
> 
> 时间：2008-12-31T17:39:08.693
> 
> 标签：java

我知道 java 中的包级保护是如何工作的。我*读*了很多代码（包括很多开源的东西），似乎没有人在使用它。整个保护级别对我来说似乎有点错误（一周中的任何一天我都会有 c# 的内部）。

是否有任何普遍使用的合法真实用例？

编辑：在问了这个问题之后有点晚了，我意识到我忘记排除包保护实现类的“标准”模式，可能提供公共接口的实现。正如在回复中多次指出的那样，每个人都使用这些。我仍然认为这个问题有很多很好的回答。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-02T04:41:12.413

包级别的可见性有两个很好的用途（根据我的经验）：

1) 在公共 API 中定义“内部”类。通常，您会将接口和核心工厂定义为公共的，而将“内部”实现定义为包级别。然后公共工厂可以构造包级实现类并将它们作为公共接口的实例返回。这很好地允许用户只访问他们应该访问的东西。

缺点是您必须将所有这些东西放在同一个包中，这对于任何大小合理的 API 几乎都不是一个好主意。 [Java 7 中的JSR 294](http://tech.puredanger.com/java7#jsr294) /modules/ [Project Jigsaw](http://tech.puredanger.com/java7#jigsaw)有望通过指定新的可见性修饰符 ( ) 提供替代方案，该修饰符`module`可用于跨包访问模块内的类，而不会使它们在模块外可见。[您可以在本文](http://www.javaworld.com/javaworld/jw-12-2008/jw-12-year-in-review-2.html)中找到一个如何工作的示例。

2）单元测试是另一个常见的用例。您经常会看到一个 src 树和一个测试树，而原本私有的东西是包级别的，因此同一（并行）包中的单元测试能够访问其他隐藏的方法来检查或操作状态。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-31T17:53:39.630

您是在谈论 Java 中的包私有保护吗？这是默认情况下对类成员有效的保护。如果您的类以需要其他信息或方法可见的方式密切交互，则它有时会很有用。

假设您有一个 Sink 类，并且有几个类可以写入该类。Sink 有一个接受基本数据类型的公共方法和一个接受原始字节数组的包私有方法。您不想公开该方法，因为您认为它对其用户来说太低级了，但是您想让写入该 Sink 的其他类（在 Sink 的包中）使用它。因此，您将接受字节数组包的方法设为私有，并且包的类（例如 ByteStreamSource）可以使用它。现在，您的保护看起来像这样：

```
 User   Code using the package   User
------ | -----------------------------|----- package public Interface
       |                              |
    Sink <-   package priv. iface  -> Sources 
```

包私有接口与公共方法建立的公共接口正交。包私有性增加了封装性，因为它鼓励您*不要*公开不应该公开的内容。它类似于`friend`C++ 中的`internal`关键字和 C# 中的关键字。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-31T17:56:14.883

一方面，它可以用于实现类。例如，[`EnumSet`](http://java.sun.com/javase/6/docs/api/java/util/EnumSet.html)是一个抽象类，文档中没有显示实现类。为什么？因为有两个实现类——一个用于包含 64 个或更少元素的枚举，一个用于 65 个或更多元素——你并不需要知道你正在使用哪一个。事实上，您甚至不需要知道有多个实现。事实上，你甚至不需要知道它`EnumSet`是抽象的——你只需要知道你可以调用其中一个静态方法并得到一个`Set`返回。

在这种情况下，私有内部类可能就足够了（虽然笨拙，尤其是对于大型类）。但有时包中的其他类需要访问此类实现细节。`protected`可以工作，但是他们也会对子类开放。

简而言之，它涵盖了其他三个保护级别未处理的封装区域。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-31T18:23:27.620

我认为原则上包级保护很有意义。它允许您创建接近模块（包）的东西，但只公开核心类。

例如，我的许多项目都使用公共接口和实现它们的“隐藏”类。用户使用工厂，并接收到对应于“隐藏”具体实现的接口的引用。通过包保护，理论上我应该只能公开接口和工厂。

不幸的是，由于包保护不适用于子包，它并不真正适合我的工作方式。我喜欢为我的“内部”东西使用其他包，特别是子包（与 Eclipse 的组织方式相同）。结果，我的包无法访问子包中的包级受保护的东西。我真希望这一天能改变。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-31T17:58:17.953

默认保护，即“包”保护意味着它是包私有的，但可以“看到”包中的类不私有的任何内容。一种用途是用于包的辅助类；假设您有一个类管理您不想使其可见的池化资源，您可以将它放在默认保护类中。现在它可以被包中的所有东西使用，它可以访问其他类的任何受保护的内部，但它不是用户可见包的一部分。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-31T18:08:26.793

Java 中默认保护的另一个用途是提高性能。

允许内部类访问其包含类的私有成员，但这是通过混淆访问器方法实现的。在 JIT 编译器优化它之前（或在没有 JIT 的环境中，例如 J2ME），这会导致小的性能损失。使用默认保护声明所需的方法消除了对这些访问器方法调用的需要，但不需要使成员完全公开。

请记住，这仅在已知性能至关重要并且您不能指望 JVM 为您解决问题的情况下才重要。但至少它并没有像许多其他微优化那样真正损害可读性/可维护性。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-31T18:46:05.360

在我看来，方法和字段的包私有（默认）访问是没有用的。事实上，它比无用更糟糕，它是有害的，因为它通常用于提供对某些应该是私有但不是出于方便原因的成员的访问权限。

但是，包私有类*很有*用。您可能希望使用包私有类提供接口的实现。可以声明工厂方法以返回实现给定接口的对象。在这种情况下，知道哪个类为接口提供实现并不重要。通过使类包私有，它不是公共 API 的一部分，因此可以在未来的版本中修改或替换。

在后来成为 Java 的语言 Oak 中，[只有 3 个访问级别](http://www.javaspecialists.eu/archive/Issue055.html)。

如果我现在重新设计 Java，我会摆脱当前的默认值（包私有）并将私有设为默认值。私有类将是在其封闭范围（包）内私有的类，它将完全按照包私有类的工作方式工作*，并且*与成员使用“私有”更加一致。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-31T19:03:27.557

没有人使用包级别访问的原因可能是一种心理影响。每个java介绍都宣扬封装，这被理解为声明所有字段都是私有的。私有访问通常过于狭窄，因此必须添加公共 getter/setter。然后在整个代码库中重复这种模式：私有字段和公共方法无处不在。具有讽刺意味的是，该模式颠覆了封装，因为整个实现基本上是由 getter/setter 对确定的。

类主要是内存分配的单元，在许多情况下，它太小而无法为程序的其余部分提供有意义的接口。使用包作为封装单元并专注于为它们提供定义良好的公共接口是一个更好的主意。

1.7 中的超级包可能会改变游戏规则。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-31T17:57:39.810

我有需要相互访问的对象。在包中，他们可以调用这些受保护的方法，但是当有人试图访问这些受保护的方法时，它们是不允许的。

在我看来，这是一种基本的保护机制，保护层次结构将是一个不错的功能。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-31T18:00:40.960

如今，包通常用于对“软件组件”进行建模，即包是一组以某种方式相关的类。由于“公共”方法定义了软件组件的外部接口，而“私有”方法/成员是类的实现细节，默认的“包”可见性相当于组件内部方法。

类比可能是 C++ 中的“朋友”方法。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-31T23:43:17.943

我认识 5 到 10 年以上的 Java 资深人士，他们没有意识到这`protected`意味着包私有访问。对我来说，仅这一点就使包私有成为一种可怕的语言功能。就个人而言，我认为无论如何都没有任何正当理由使用包私有。让我们考虑用例：

*   封装私有类：使用内部类。另一位发帖人建议内部类与包私有类相比存在（小）性能损失，但对我而言，这不是糟糕设计的好理由。封装私有类和内部类我认为是**实现细节**，因此，我认为最好将它们“隐藏”为内部类；
*   封装私有数据成员：我完全看不出有这些原因；和
*   包私有方法：这些几乎等同于 C++ 友元方法。C++ 朋友有一个很好的存在理由，那就是在类之外外部化运算符重载，这允许第一个参数不是类本身。在 Java 中，没有这样的用例，它只是围绕封装和抽象进行最终运行。

将此与受保护的方法进行比较，这在设计扩展类时是完全合理的。我见过程序员**无意中**在同一个包中不相关的类中使用受保护方法的情况，只是因为它们出现在自动完成列表中。

**绝对没有办法阻止这种情况。**

C# 具有更好的访问系统，因为受保护并不意味着内部访问。但我认为这 - 以及可变的 Date 类 - 是相当大的缺陷。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-04T17:17:39.003

大多数情况下，对于源文件和测试文件在同一个包中的单元测试，测试可以访问类的内部而不暴露它。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-08-02T12:04:11.517

我目前正在脑海中辩论许多这些问题，这是一个很好的讨论。我一直选择以应有的方式将所有私有事物设为私有，但随后我正在编写大量反射来对私有范围的代码进行单元测试。这是，我认为纯粹的面向对象的方式来做到这一点。但是，我发现可以密封 jar 文件，以便将包范围限制在模块 (jar) 内部。在我看来，这使得包范围更加可口。我可能愿意打破良好的封装，以换取将我的单元测试代码减少到原来的一小部分。想法是，如果有人在同一个库和同一个包中工作，他们将与代码库足够亲密，不会在没有合理设计辩论的情况下从类外部访问包范围成员。这仍然是一个艰难的决定。最好为这种类型的实例指定一个朋友类类型，以便我的单元测试代码代码可以访问我的私有代码，但不能被其他类访问。我刚刚通过maven在这个项目中密封了我的jar文件：

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>2.3.2</version>
            <configuration>
                <archive>
                    <index>true</index>
                    <manifest>
                        <addClasspath>true</addClasspath>
                    </manifest>
                    <manifestEntries>
                        <sealed>true</sealed>
                    </manifestEntries>
                </archive>
            </configuration>
        </plugin> 
```

现在我正在讨论在我的单元测试中提取一堆反射代码。

我仍然处于辩论的边缘。包范围真的很开放，特别是如果你有很多开发人员在代码库中蹦蹦跳跳。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-31T18:43:46.817

通常，默认/包保护可用于使“公共”类和变量受到更多限制。

您只需从类中导出一些方法（如果您是一名优秀的程序员），只需将它们标记为公共，同时尽可能保持私有。

包保护允许您只从包中导出几个类，将其余的类保持为私有。

从理论上讲，这是一个好主意，在实践中你几乎看不到它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-01T11:01:58.870

“我知道 java 中的包级保护是如何工作的……而且似乎没有人使用它。”

他们在用什么？

他们是否将所有课程都公开？

负担原则有两种形式。

强形式表明，转换实体集合的负担是转换实体数量的函数。弱形式表明转换实体集合的最大潜在负担是转换实体的最大潜在数量的函数。

国际标准化组织将封装定义为对象中包含的信息只能通过对象支持的接口上的交互来访问的属性。

在更高的抽象层次上，程序单元也可以封装在子系统中，由此子系统中包含的信息只能通过子系统中包含的公共程序单元访问。

创建或修改任何软件系统的负担是创建或修改的程序单元数量的函数。

与不依赖于修改后的程序单元的程序单元相比，依赖于特定修改程序单元的程序单元受到影响的概率更高。

修改后的程序单元可能施加的最大潜在负担是对依赖它的所有程序单元的影响。

因此，减少对修改后的程序单元的依赖性降低了其更新将影响其他程序单元的可能性，从而减少了该程序单元可以施加的最大潜在负担。

减少系统中所有程序单元之间的最大潜在依赖关系因此减少了对特定程序单元的影响将导致对其他程序单元进行更新的可能性，从而减少了所有更新的最大潜在负担。

封装理论展示了如何使用封装来减少所有程序单元之间的最大潜在依赖数。

因此，封装理论展示了如何使用封装来减轻负担原则的弱形式。

在 Java 中，使类包私有化是减少系统中最大潜在依赖项数量的关键机制之一，从而减少对该系统进行任何软件修改的最大可能负担。

然而你提到这在你阅读的代码中没有使用。

听起来……很奇怪。

# asp.net - 当前负载测试和分析 ASP.NET Web 应用程序的最佳实践是什么？

> ID：403590
> 
> 赞同：1
> 
> 时间：2008-12-31T17:39:49.597
> 
> 标签：asp.net, testing, stress-testing, baseline

我的任务是提高网站特定页面的性能，该页面响应时间非常长，正如谷歌分析所报告的那样。

做一些谷歌搜索，发现了一个 VS2003 附带的产品，称为 ACT（应用程序中心测试），它进行了负载测试。这似乎不再分发

在我尝试优化它之前，我希望能够对此页面进行基线测试，这样我就可以看到我的更改在做什么。

分析应用程序（例如来自 Jetbrains 的 dotTrace）可能会发挥作用，我已经使用 trace 隔离了一些在页面内需要一段时间的操作。

围绕性能和负载测试的最佳实践和工具是什么？我主要是希望能够看到结果，而不是如何完成它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T05:25:25.763

这是一篇展示如何使用 VSTS 分析器进行分析的文章。

[如果坏了，你应该修复它](http://blogs.msdn.com/tess/archive/2008/10/07/using-vsts-test-and-profilers-to-troubleshoot-a-high-cpu-in-gc-issue.aspx)

除了所有工具之外，为什么不尝试启用 asp.net 的“健康监控”功能。

它为分析提供了一些很好的信息。它发出与进程、内存、磁盘使用、计数器等相关的基本信息。带有 VSTS 负载测试的 HM 为您提供了一个很好的分析平台。

看看下面的链接。。

[如何配置健康监测？](http://msdn.microsoft.com/en-us/library/ms998306.aspx)

此外，为了参考一些清单，请查看雅虎的以下规则/提示......

[高性能网站规则/提示](http://developer.yahoo.com/performance/rules.html)

HttpWatch 也是识别特定性能问题的好工具。

[HttpWatch - 链接](http://developer.yahoo.com/performance/rules.html)

也看看这里的一些技巧.. [10 ASP.NET 性能和可扩展性的秘密](http://www.codeproject.com/KB/aspnet/10ASPNetPerformance.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T17:47:59.613

看看 Red Gate 的[ANTS Profiler](http://www.red-gate.com/products/ANTS_Profiler/index.htm)。我使用了一系列 Red Gate 产品，非常满意！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T17:48:55.443

你可以走很多不同的路。假设一个 MS 环境，您可以利用一些团队系统工具（例如 MS Team Tester）来记录测试并对您的站点执行负载测试。这些可以设置为作为自动构建过程的一部分运行。

工具列表位于： http: [//www.softwareqatest.com/qatweb1.html#LOAD](http://www.softwareqatest.com/qatweb1.html#LOAD)

现在，您可以从简单开始。在这种情况下，请安装两个 firefox 插件：Firebug 和 YSlow for Firebug。这些将提供统计信息并指出诸如页面大小、获取页面的请求数等问​​题。他们还将就一些需要解决的问题提出建议。

此外，您可以使用单元测试来执行大量背后的代码，以查看哪些功能正在伤害您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T18:15:10.570

如果您拥有带有 TFS 和 Visual Studio Team Edition 的完整 MS 开发系统，您可以进行各种测试。根据我[在这里看到的](http://msdn.microsoft.com/en-us/library/bb385832.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T18:33:38.287

我最近有一个很好的 .Net 错误，它正在猖獗。这个工具有点帮助，但在你的情况下，我可以看到它运行良好..

[http://www.jetbrains.com/profiler/](http://www.jetbrains.com/profiler/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T05:07:45.707

大多数时候，我们使用的是 Microsoft 的 WCAT。如果您的搜索显示 ACT，那么如果您正在寻找每秒请求等，这可能是您想要获取的工具。[Mike Volodarsky](http://mvolo.com/blogs/serverside/archive/2007/05/17/WCAT-6.3-web-performance-and-scalability-test-tool-released.aspx)很好地指出了如何抓住这一点。

在测试我们的网络基础设施或新的 Web 应用程序时，我们在内部使用了很多，一旦你开始使用它，它就会非常灵活。似乎微软为我们所做的每一个演示都使用了新的网络技术，他们似乎正在淘汰 WCAT 来炫耀这些改进。

它是命令行驱动的，所以它有点老派，但如果你想要力量和定制，它就无法被击败。特别是免费的。

现在，当我们试图追踪性能问题时，我们也在我们自己的应用程序上使用 DotTrace，而且 RedGate 工具也很不错。我绝对会推荐他们两者的组合。它们都为您提供了一些非常可靠的数字来追踪您的应用程序的哪一部分是减速，我无法想象没有 DotTrace 的生活。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-08T21:14:34.770

Visual Studio 测试版（2008 或 2010）为 ASP.NET 应用程序提供了一个非常好的负载测试组件。它允许您获取服务器的所有 perfmon 统计信息（从 CPU 和磁盘等待等基础知识到垃圾收集和 SQL 锁）

为页面创建负载测试并运行它，将统计信息存储在数据库中作为基线。可以比较后续运行。

# silverlight - 有没有办法在 Silverlight 库项目中共享资源？

> ID：403594
> 
> 赞同：0
> 
> 时间：2008-12-31T17:41:11.793
> 
> 标签：silverlight, resources

在 Silverlight 应用程序中，您有 App.xaml，但在 Silverlight 库中，您没有。我尝试使用 generic.xaml，但我认为这有助于根据类型将样式应用于所有控件的特定目的。以防万一，我只想要一个地方来放置我将在整个库中重用的路径或对象之类的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-10T20:18:20.477

看看 Silverlight Toolkit 的[SharedResources.cs](http://silverlight.codeplex.com/sourcecontrol/changeset/view/25992?projectName=Silverlight#636822)文件，它有点老套，但可能对您的方案有所帮助。

它与共享 XAML 资源不同，但它可以帮助您访问图像和其他嵌入式内容类型。

# .net - 扩展方法的使用

> ID：403619
> 
> 赞同：13
> 
> 时间：2008-12-31T17:52:48.433
> 
> 标签：.net, extension-methods

*   什么时候使用扩展方法有意义？*   向类型添加扩展方法会影响性能吗？

    [这些问题是我之前提出的关于Extension Methods](https://stackoverflow.com/questions/403539/what-are-extension-methods)的问题的后续问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-31T18:07:02.070

## 什么时候使用扩展方法有意义？

当您使用 LINQ 并希望将功能输出从一个函数链接或管道传输到另一个函数时，它们是有意义的。它提高了代码的可读性，并允许您更优雅地表达一个概念（无论其价值如何）。

它们还允许您在您喜欢的任何类型上给出实例方法的外观，而无需修改该类型的源代码，这通常有助于合理使用代码的可读性和表现力

## 向类型添加扩展方法会影响性能吗？

请注意，扩展方法调用如下：

```
instance.SomeExtensionMethod() 
```

被编译为：

```
StaticExtensionMethodClass.SomeExtensionMethod(instance); 
```

因此性能将与任何其他静态方法调用相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T17:56:48.033

*[从我在这里](https://stackoverflow.com/questions/403539/what-are-extension-methods#403556)的回答：*

至于扩展方法的实际用途，您可以在不派生新类的情况下向类添加新方法。

看看下面的例子：

```
public class extended {
    public int sum() {
        return 7+3+2;
    }
}

public static class extending {
    public static float average(this extended extnd) {
        return extnd.sum() / 3;
    }
} 
```

如您所见，该类`Extending`正在向 class 添加一个名为 average 的方法`Extended`。要获得平均值，请调用`average`方法，因为它属于`extended`类：

```
extended ex = new extended();

Console.WriteLine(ex.average()); 
```

*参考：[http ://aspguy.wordpress.com/2008/07/03/a-practical-use-of-serialization-and-extension-methods-in-c-30/](http://aspguy.wordpress.com/2008/07/03/a-practical-use-of-serialization-and-extension-methods-in-c-30/)*

* * *

至于*Performance*，我认为您可以看到 Extension 方法的改进，因为它们永远不会动态调度，但这完全取决于动态方法的实现方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T17:57:24.290

它用于扩展（添加）现有类的功能，而无需实际更改它们。

您可以在 LINQ（System.Linq 命名空间和其他命名空间）如何为所有集合添加大量功能中看到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T18:11:36.630

扩展方法的另一个有趣用途是当您希望将某些功能添加到一个命名空间下的类而不是另一个命名空间下。一个具体的例子是添加简化单元测试的方法——您不希望它们使您的生产程序集变得混乱，但是在编写单元测试时拥有它们是很棒的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T19:20:39.800

除了其他答案之外，扩展方法是将样板实现添加到接口的好方法。例如，如果您希望所有列表都可排序，请为`IList<T>`.

您也可以（如前所述）使用扩展方法将方法添加到您无法控制的类中；曾经想要一个`Reverse()`方法`string`吗？加一个！

唯一的区别是扩展方法不使用虚拟，并且没有空检查。如果你喜欢，你可以利用它来发挥你的优势：

```
public static void ThrowIfNull<T>(this T obj, string name) where T : class
{
    if(obj == null) throw new ArgumentNullException(name);
} 
```

与常规实用方法不同，它们使编写流畅的接口变得非常容易；这是它们存在的原因之一 - 即使用 LINQ：

```
var foo = source.Where(predicate).OrderBy(selector); 
```

比以下更具可读性：

```
var foo = Enumerable.OrderBy(Enumerable.Where(source,predicate),selector); 
```

对于常规方法，要使用第一种方法，它必须是常规实例方法，这将需要（例如）更改为`IEnumerable<T>`- 不可取的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-05T03:49:17.417

扩展方法在使用函数式编程的地方大放异彩。

考虑一下您在应用程序中已经拥有的几乎所有模块级函数，以及当您将它们标记为扩展方法时它们会变成什么。它们成为“主动语态”而非“被动语态”的机会。主动语音意味着代码读起来好像实例提供了自己的方法来执行特定任务，而不是让函数被动地对其执行操作。

```
ExtendUnlimitedCredit(AddVIP(tblCustomer, "Bill Gates")) 
```

对比

```
tblCustomer.AddVIP("Bill Gates").ExtendUnlimitedCredit() 
```

扩展方法使这种转换变得简单。使用“主动语音”代码消除嵌套函数调用通常是一种改进。另外，由于我们的商店锁定了它的核心类，我们只能在扩展方法之前使用嵌套函数调用。

关于扩展方法的其他好处：

1.  它们使您的功能（因为 Intellisense）更容易被发现。如果您提供了描述函数用途和用途的内联标记，Intellisense 甚至会向发现它的开发人员提供描述该方法及其用途的有用工具提示（只需按下点）。未标记为扩展方法的函数不容易被发现，可能会被闲置，因此，其他人可能会发明他们自己对所述函数的风格。

2.  尽管您实际上无法为接口实现方法，但扩展方法提供了另一种方法，使您看起来已经这样做了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T17:58:01.883

我不知道任何性能影响。当您无法访问源代码并因此无法直接将方法添加到类中时，使用扩展方法最有意义，并且该方法*可以*作为函数实现。这转到我对您之前的问题所做的评论，其中另一个人提供了“字符串”类上的扩展方法的示例，该方法根据字符串是否为有效电子邮件返回布尔值。IMO，这是不使用扩展方法的示例，因为该函数不是字符串类型的基础。但是，将 Left(int) 和 Right(int) 函数添加到 'string' 确实有意义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-05T04:14:34.403

我使用它们来重用我的对象模型类。我有一堆代表我在数据库中拥有的对象的类。这些类在客户端仅用于显示对象，因此基本用法是访问属性。

```
public class Stock {
   public Code { get; private set; }
   public Name { get; private set; }
} 
```

由于这种使用模式，我不想在这些类中包含业务逻辑方法，因此我将每个业务逻辑都作为扩展方法。

```
public static class StockExtender {
    public static List <Quote> GetQuotesByDate(this Stock s, DateTime date)
    {...}
} 
```

通过这种方式，我可以将相同的类用于业务逻辑处理和用户界面显示，而不会用不必要的代码使客户端超载。

关于这个解决方案的一个有趣的事情是我的对象模型类是使用[Mono.Cecil](http://www.mono-project.com/Cecil)动态生成的，所以即使我想要添加业务逻辑方法也会非常困难。我有一个编译器，它读取 XML 定义文件并生成这些存根类，这些存根类代表我在数据库中拥有的一些对象。在这种情况下，唯一的方法是扩展它们。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-30T17:45:49.887

解决你的第二个问题：我的经验法则是扩展方法应该是类型上的“功能的自然扩展”，或者它应该是流畅接口的可维护和可读部分。

“功能的自然扩展”的一个示例是扩展数据读取器以在遇到 DBNull 时返回默认值。扩展数据读取器以返回由多个字段中的数据表示的实体的实例并不是那么自然。在后一种情况下，您将错误的职责注入到可怜的对象中:)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-01-23T18:03:22.607

```
/// <summary>
/// External Library Code
/// </summary>
namespace ExternalLibrary
{
    public class Calculator
    {
        public int Number1 { get; set; }
        public int Number2 { get; set; }

        public int Addition()
        {
            return Number1 + Number2;
        }

        public int Subtraction()
        {
            return Number1 - Number2;
        }
    }
}

--------------------------------------------------------------------------------------

using ExternalLibrary;
using System;

namespace StackOverFlow
{
    class Program
    {
        static void Main(string[] args)
        {
            Calculator calc = new Calculator()
            {
                Number1 = 5,
                Number2 = 3
            };
            Console.WriteLine(calc.Addition());
            Console.WriteLine(calc.Subtraction());

            // Here we want multiplication also. but we don't have access Calculator
            // class code, so we can't modify in that.
            // In order to achieve this functionality we can use extension method.
            Console.WriteLine(calc.Multiplication());

            Console.ReadLine();
        }
    }

    /// <summary>
    /// Extension Method for multiplication
    /// </summary>
    public static class CalculatorExtension
    {
        public static int Multiplication(this Calculator calc)
        {
            return calc.Number1 * calc.Number2;
        }
    }
} 
```

# selenium - Selenium：是否可以将 xpath 与变量连接起来？

> ID：403622
> 
> 赞同：2
> 
> 时间：2008-12-31T17:53:50.613
> 
> 标签：selenium, fitnesse

我的元素的 xpath 变得非常难以阅读。

//div[@id='main_content']/div[2]/div[2]/div[2]/div[4]/table/tbody/tr[2]/td/form/fieldset/p[1 ]/输入

如果我可以将其中的大部分存储为变量并在以后像这样使用它，那就太好了：

| 断言元素呈现 | ${myForm} 。/fieldset/p[1]/输入 |

这样的事情可能吗？这将使我的测试更容易阅读！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T19:19:33.857

你*真的*应该将你的 selenium espressions 锚定在元素的 ID 中。在 2 个月内，没有人会对 xpath 指向的内容有丝毫的了解，尤其是在您需要找出原因时测试被破坏的情况下。我们经常将 id 添加到元素中，以使测试更容易。我们已经学会接受我们以一种特殊的方式编写 Java 代码以使其可测试，而且我认为 HTML 也可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-23T08:15:35.563

你可以写：

```
store | //div[@id='main_content']/div[2]/div[2]/div[2]/div[4]/table/tbody/tr[2]/td/form | myForm
assertElementPresent | xpath=${myForm}/fieldset/p[1]/input 
```

然而，正如 Krosenvold 所说，长 xpath 可能非常脆弱。如果您担心代码的可读性，并希望将所有定位器放在一个文件中，您可以在其中进行级联更改，您可能需要考虑使用 UI-Element 映射。

# wpf - 如何用图形路径完全替换 WPF 按钮的内容？

> ID：403629
> 
> 赞同：2
> 
> 时间：2008-12-31T17:57:15.613
> 
> 标签：wpf, button, path, styles, contentpresenter

我已经使用 Blend 解构了一个标准 WPF 按钮，并设法创建了一个样式精美的按钮，但我无法弄清楚如何使路径填充按钮空间的内部（按钮宽度和高度）。我也不确定是否需要指定 ContentPresenter 或者它是否正确。我在按钮中间的文本之后（正常），但后面有我的图形路径。

谁能给我有关如何完成此任务的反馈？样式定义为；

```
 <ControlTemplate x:Key="CurvedButton" TargetType="{x:Type Button}">
        <Grid>
            <Path Fill="#ff951c1f" Data="F1 M 64,16 C 64,24 56,31 48,31 L 15,31 C 7,31 0,24 0,16 C 0,7 7,0 15,0 L 48,0 C 56,0 64,7 64,16 Z" />
            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Width="Auto" />
        </Grid>
    </ControlTemplate> 
```

这个按钮的用途是；

```
<StackPanel>
    <Button Template="{StaticResource CurvedButton}" FontFamily="MS Trebuchet" FontSize="40" Width="200" Height="120" Foreground="Black">XXXXXXXXXXX</Button>
</StackPanel> 
```

完成后，它应该看起来像一个弯曲的红色按钮。

提前致谢

瑞安

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-31T18:15:32.490

您可以做几件事来获得您正在寻找的结果。

将路径放在视图框中并拉伸以填充：

```
<ControlTemplate x:Key="CurvedButton" TargetType="{x:Type Button}">
    <Grid>
        <Viewbox Stretch="Fill">
            <Path Fill="#ff951c1f" Data="F1 M 64,16 C 64,24 56,31 48,31 L 15,31 C 7,31 0,24 0,16 C 0,7 7,0 15,0 L 48,0 C 56,0 64,7 64,16 Z" />
        </Viewbox>
        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Width="Auto" />
    </Grid>
</ControlTemplate> 
```

使用边框而不是路径：

```
<ControlTemplate x:Key="CurvedButton" TargetType="{x:Type Button}">
    <Grid>
        <Border CornerRadius="40" Background="#ff951c1f">
            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Width="Auto" />
        </Border>
    </Grid>
</ControlTemplate> 
```

# sql-server - 在 SQL Server 2008 中跨多个表、列使用全文搜索

> ID：403630
> 
> 赞同：18
> 
> 时间：2008-12-31T17:57:23.883
> 
> 标签：sql-server, sql-server-2008, full-text-search

我需要使用全文搜索从我的数据库中的两个表中搜索多个列。有问题的两个表已对相关列进行了全文索引。

我选择全文搜索的原因： 1\. 能够轻松搜索带重音的单词（cafè） 2\. 能够根据单词接近度等进行排名 3\. “您是说 XXX 吗？” 功能性

这是一个**虚拟**表结构，用于说明挑战：

```
表书
书号
名称（全文索引）
注释（全文索引）

桌架
货架编号
书号

桌架作者
作者ID
货架编号

表作者
作者ID
名称（全文索引）

```

**我需要搜索书名、书注和作者姓名。**

我知道有两种方法可以做到这一点：

1.  **使用全文索引视图：**这本来是我的首选方法，但我不能这样做，因为要对视图进行全文索引，它需要是模式绑定的，没有任何外部连接，有唯一的索引. 我需要获取数据的视图不满足这些约束（它包含我需要从中获取数据的许多其他连接表）。

2.  **在存储过程中使用连接**：这种方法的问题是我需要按等级对结果进行排序。如果我跨表进行多个连接，默认情况下 SQL Server 不会搜索多个字段。我可以在两个链接表上组合两个单独的 CONTAINS 查询，但我不知道如何从两个搜索查询中提取**组合**排名。例如，如果我搜索“Arthur”，则应考虑 Book 查询和 Author 查询的结果并相应地加权。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-31T18:24:27.777

使用 FREETEXTTABLE，您只需要设计一些算法来计算每个连接表结果的合并排名。下面的示例将结果偏向书籍表中的命中。

```
SELECT b.Name, a.Name, bkt.[Rank] + akt.[Rank]/2 AS [Rank]
FROM Book b
INNER JOIN Author a ON b.AuthorID = a.AuthorID
INNER JOIN FREETEXTTABLE(Book, Name, @criteria) bkt ON b.ContentID = bkt.[Key] 
LEFT JOIN FREETEXTTABLE(Author, Name, @criteria) akt ON a.AuthorID = akt.[Key]
ORDER BY [Rank] DESC 
```

请注意，我为此示例简化了您的架构。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-08-08T16:05:09.347

我和你有同样的问题，但它实际上涉及 10 个表（一个用户表和其他几个表以供参考）

我在每个表的 WHERE 子句中使用 FREETEXT 进行了第一次查询，但查询时间太长了。

然后我看到了几个关于使用 FREETEXTTABLE 并检查每个表的键列中的非空值的回复，但这也需要很长时间才能执行。

我通过结合使用 FREETEXTTABLE 和 UNION 选择来修复它：

```
SELECT Users.* FROM Users INNER JOIN
(SELECT Users.UserId FROM Users INNER JOIN FREETEXTTABLE(Users, (column1, column2), @variableWithSearchTerm) UsersFT ON Users.UserId = UsersFT.key
UNION
SELECT Table1.UserId FROM Table1 INNER JOIN FREETEXTTABLE(Table1, TextColumn, @variableWithSearchTerm) Table1FT ON Table1.UserId = Table1FT.key
UNION
SELECT Table2.UserId FROM Table2 INNER JOIN FREETEXTTABLE(Table2, TextColumn, @variableWithSearchTerm) Table2FT ON Table2.UserId = Table2FT.key
... --same for all tables
) fts ON Users.UserId = fts.UserId 
```

事实证明，这快得令人难以置信。

我希望它有所帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-27T19:31:55.487

我认为接受的答案不会解决问题。如果您尝试查找某个作者的所有书籍，并因此使用作者姓名（或其中的一部分）作为搜索条件，则查询返回的唯一书籍将是那些以其自己的名称具有搜索条件的书籍.

我看到解决此问题的唯一方法是复制您希望在 Book 表中搜索的作者列并索引这些列（或列，因为将作者的相关信息存储在 Book 的 XML 列中可能很聪明桌子）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-02-19T18:04:17.210

FWIW，在类似的情况下，我们的 DBA 创建了 DML 触发器来维护专用的全文搜索表。由于存在许多限制，因此无法使用物化视图。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T18:15:22.240

我会使用存储过程。全文方法或任何返回您可以排序的排名。我不确定它们将如何相互权衡，但我相信你可以修补一段时间并弄清楚。例如：

```
Select SearchResults.key, SearchResults.rank From FREETEXTTABLE(myColumn, *, @searchString) as SearchResults Order By SearchResults.rank Desc 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-30T23:51:51.203

这个答案早就该回答了，但是如果您无法修改主表，一种方法是创建一个新表，并将搜索参数添加到一列。

然后在该列上创建全文索引并查询该列。

**例子**

```
SELECT 
    FT_TBL.[EANHotelID]                 AS HotelID, 
    ISNULL(FT_TBL.[Name],'-')           AS HotelName,
    ISNULL(FT_TBL.[Address1],'-')       AS HotelAddress,
    ISNULL(FT_TBL.[City],'-')           AS HotelCity,
    ISNULL(FT_TBL.[StateProvince],'-')  AS HotelCountyState,
    ISNULL(FT_TBL.[PostalCode],'-')     AS HotelPostZipCode,
    ISNULL(FT_TBL.[Latitude],0.00)      AS HotelLatitude,
    ISNULL(FT_TBL.[Longitude],0.00)     AS HotelLongitude,
    ISNULL(FT_TBL.[CheckInTime],'-')    AS HotelCheckinTime,
    ISNULL(FT_TBL.[CheckOutTime],'-')   AS HotelCheckOutTime,
    ISNULL(b.[CountryName],'-')         AS HotelCountry,
    ISNULL(c.PropertyDescription,'-')   AS HotelDescription,
    KEY_TBL.RANK 

    FROM [EAN].[dbo].[tblactivepropertylist] AS FT_TBL INNER JOIN
     CONTAINSTABLE ([EAN].[dbo].[tblEanFullTextSearch], FullTextSearchColumn, @s)
      AS KEY_TBL
    ON FT_TBL.EANHotelID = KEY_TBL.[KEY]
    INNER JOIN [EAN].[dbo].[tblCountrylist] b
    ON FT_TBL.Country = b.CountryCode
    INNER JOIN [EAN].[dbo].[tblPropertyDescriptionList] c
    ON FT_TBL.[EANHotelID] = c.EANHotelID 
```

在 [EAN].[dbo].[tblEanFullTextSearch] 上面的代码中，FullTextSearchColumn 是添加了字段的新表和列，您现在可以通过连接到要显示数据的表对新表进行查询.

希望这可以帮助

# .net - GAC 包含的程序集中共享的处理

> ID：403634
> 
> 赞同：0
> 
> 时间：2008-12-31T17:58:12.900
> 
> 标签：.net, thread-safety, gac

我知道在创建 DLL 并将项目声明为“共享”（C# 中的静态）时，它们在第一次调用时被实例化，然后该对象引用作为单个引用继续存在。

因此，一旦设置了共享字符串属性，就可以再次调用以检索相同的值。然后，线程安全是应用程序域中的一个主要问题。

在应用程序域之外会发生什么。如果我们将程序集放在全局应用程序缓存 (GAC) 中，将存在多少个实例？

例如，GAC'ed .dll 中名为“MyFileName”的静态属性。

然后我们有两个应用程序调用 GAC 的 .dll。将存在多少个“MyFileName”实例？应用程序一对 MyFileName 的更改是否会复制到应用程序二使用的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T20:33:07.377

dll 在 AppDomain 中实例化，因此有多少个 AppDomain 就有多少个不同的副本。数据不会在 AppDomain 之间传输。将 DLL 放在 GAC 中只是使它在一个地方对所有东西都可用，它不会改变 .net 的内存模型。

# .net - 属性集应该抛出什么异常？

> ID：403643
> 
> 赞同：1
> 
> 时间：2008-12-31T18:04:49.593
> 
> 标签：.net, language-agnostic, exception

`set { }`在 .NET 中，如果有人将非法值传递给属性的一部分，应该抛出什么类型的异常？

例子：

```
public string Provider
{
    get { return _provider; }
    set
    {
        if (String.IsNullOrEmpty(value)) throw new Exception("Provider cannot be null or empty."); //what type of exception should be thrown here instead?
        _provider = value;
    }
} 
```

* * *

**笔记：**

我在问这个问题，因为它适用于 .NET，但它也适用于许多其他语言。因此，如果您有一个适用于 .NET 框架以外的东西的好答案，请发布！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-31T18:08:32.533

[ArgumentException](http://msdn.microsoft.com/en-us/library/system.argumentexception.aspx)、ArgumentOutOfRangeException、ArgumentNullException 或类似的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T17:35:26.113

一般来说，我不同意 Jon B 关于何时抛出异常的观点——如果它是在调用 set() 时抛出的，它将捕获设置无效值时的上下文。另一方面，如果您只是将其设置为某个虚拟值并在其他地方抛出异常，那么根据您采用的方法，客户端将看到虚拟值而没有任何迹象表明这不是实际设置的值，或者他们将收到一个异常，不会让他们知道谁对无效状态负责或如何纠正它。

现在在某些情况下，这种技术可能是有意义的——如果由于某种不可避免的原因属性非常不稳定，并且您已经决定暂时设置非法属性是可以的，但是（基于一些外部同步）客户端是不允许的取回财产，直到它被认为是合法的、稳定的价值。这也不是很好，但我敢肯定，你可能无法帮助这种情况。

并且由于您询问了 .NET 以外的语言，因此在 Java 中，我会在一般情况下使用 IllegalArgumentException - 如果参数为 null，则可能是一个很好的旧 NullPointerException。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-21T07:49:30.037

我同意安德烈的观点。应该在“set”中抛出异常，因为永远不应将属性设置为无效值，并且您需要“捕获设置无效值时的上下文”

我使用 ArgumentException 类之一，因为“在后台”，“set”是对名为 'CLASSNAME'.set_'PROPERTYNAME'(value) 的自动创建方法的调用

例如

```
class MyClass
{
  string name;

  public string Name {
    get {
      return name;
    }
    set {
      if (value==null) {
        throw new ArgumentNullException("value", "The value of the property Name cannot be set to null.");
      }
      name = value;
    }
  }

} 
```

这在内部创建了两个方法

```
public string get_Name() 
```

和

```
public void set_Name(string value) 
```

如果您显示堆栈跟踪，这就是引发异常的地方。

这就是为什么我总是在消息中包含诸如“属性名称的值...”之类的文本，以便属性的用户可以看到引发异常的位置，因为不会有一个名为 set_SOMEPROPERTY(SOMETYPE value) 的方法对可见类库的用户。

（此外，根据“NET Framework 4 -Design Guidelines for Exceptions, Catching and Throwing Standard Exception Types ( [Here](http://msdn.microsoft.com/en-us/library/ms229007.aspx) ) 大约在页面的中间位置，在“ArgumentException、ArgumentNullException 和 ArgumentOutOfRangeException”下，这是您应该做的事情，它指出“请使用 value 作为属性设置器的隐式 value 参数的名称")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T18:09:06.323

在这种情况下，我不会抛出异常。如果属性是字符串，那么我可以将其设置为“”或 null。当我尝试使用该属性时（例如在 Connect() 函数中），应该抛出异常，并显示该函数失败的消息，因为该属性无效。

# iphone - 如何让 Xcode 刷新我的项目图像文件的本地副本？

> ID：403645
> 
> 赞同：5
> 
> 时间：2008-12-31T18:06:26.173
> 
> 标签：iphone, xcode

我在使用 Xcode 时遇到了一些奇怪的问题，仅仅通过谷歌搜索几乎不可能找到答案。

我的 Xcode 项目中有一些图标图像文件（只是 PNG），当我在 Photoshop 中修改其中一些时，当我在 Xcode 中进行另一个构建时，它们不会得到更新。为了解决这个问题，我必须再次将文件重新添加到项目中，然后删除 Xcode 中已经存在的旧版本文件。

我在这里做错了什么？我正在直接从 Photoshop 更新/替换存储在我的项目目录中的图像文件，所以我认为它只会重新加载并且会显示新版本。

更新：看起来发生的事情是当我第一次将图像文件导入我的项目时，它们被添加到我的“类/”子目录中。所以当我更新它们时，它只是将它们添加到我的项目的根目录中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T21:31:43.540

我有同样的问题。以下为我修复了它：在 Xcode 中，转到 Project --> Clean

这将从 xcode 缓存中清除旧图像并显示您的新图像

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T18:10:39.410

这很奇怪。我建议两件事：

1.  检查您没有将 Photoshop 文件保存到错误的目录中。我知道这看起来很简单，但值得一试。确保您没有将它们保存到 build/ 目录或类似目录中。

2.  在模拟器中再次运行之前，请先尝试**清理**所有构建目标，以确保您的项目在启动模拟器之前再次真正构建。

# java - 从 java 中确定 Outlook.exe 的路径？

> ID：403660
> 
> 赞同：0
> 
> 时间：2008-12-31T18:09:13.733
> 
> 标签：java, outlook

我想从命令行调用 Outlook（出于各种原因），并想知道如何发现 Outlook.exe 文件的路径。

我很确定它存储在注册表中，但想知道如何从 Java 中读取它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T18:23:27.573

我找到了一个描述该过程的[Microsoft 页面](http://support.microsoft.com/kb/q240794/)，只是不是在 Java 中。

所以我想问题变成了如何从java访问注册表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T18:28:21.760

我发现[这个网站](http://javabyexample.wisdomplug.com/java-concepts/34-core-java/62-java-registry-wrapper.html)可能对你有帮助。它是一个 Java Registry 包装器，似乎有很多特性，但不知道实现有多健壮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T17:25:23.357

使用 Otis 的答案，以下代码可以很好地完成。

```
static String getOutlookPath() {
  // Message message = new Message();
  final String classID;
  final String outlookPath;

  { // Fetch the Outlook Class ID
    int[] ret = RegUtil.RegOpenKey(RegUtil.HKEY_LOCAL_MACHINE,   "SOFTWARE\\Classes\\Outlook.Application\\CLSID", RegUtil.KEY_QUERY_VALUE);
    int handle = ret[RegUtil.NATIVE_HANDLE];
    byte[] outlookClassID = RegUtil.RegQueryValueEx(handle, "");

    classID = new String(outlookClassID).trim(); // zero terminated bytes
    RegUtil.RegCloseKey(handle);
  }

  { // Using the class ID from above pull up the path
    int[] ret = RegUtil.RegOpenKey(RegUtil.HKEY_LOCAL_MACHINE, "SOFTWARE\\Classes\\CLSID\\" + classID + "\\LocalServer32", RegUtil.KEY_QUERY_VALUE);
    int handle = ret[RegUtil.NATIVE_HANDLE];
    byte[] pathBytes = RegUtil.RegQueryValueEx(handle, "");

    outlookPath = new String(pathBytes).trim(); // zero terminated bytes
    RegUtil.RegCloseKey(handle);
  }

  return outlookPath;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-15T20:20:57.973

以下是从类似问题略微修改的解决方案： [https](https://stackoverflow.com/a/6194710/854664) ://stackoverflow.com/a/6194710/854664 注意我使用的是 .pst 而不是 .xls

```
import java.io.*;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class ShowOutlookInstalled {
    public static void main(String argv[]) {
        try {
            Process p = Runtime.getRuntime()
                    .exec(new String[] { "cmd.exe", "/c", "assoc", ".pst" });
            BufferedReader input = new BufferedReader(new InputStreamReader(p.getInputStream()));
            String extensionType = input.readLine();
            input.close();
            // extract type
            if (extensionType == null) {
                outlookNotFoundMessage("File type PST not associated with Outlook.");
            } else {
                String fileType[] = extensionType.split("=");

                p = Runtime.getRuntime().exec(
                        new String[] { "cmd.exe", "/c", "ftype", fileType[1] });
                input = new BufferedReader(new InputStreamReader(p.getInputStream()));
                String fileAssociation = input.readLine();
                // extract path
                Pattern pattern = Pattern.compile("\".*?\"");
                Matcher m = pattern.matcher(fileAssociation);
                if (m.find()) {
                    String outlookPath = m.group(0);
                    System.out.println("Outlook path: " + outlookPath);
                } else {
                    outlookNotFoundMessage("Error parsing PST file association");
                }
            }

        } catch (Exception err) {
            err.printStackTrace();
            outlookNotFoundMessage(err.getMessage());
        }

    }

    private static void outlookNotFoundMessage(String errorMessage) {
        System.out.println("Could not find Outlook: \n" + errorMessage);

    }
} 
```

# c++ - 如何将 C++ 或 C 中的字符串转换为整数数组？

> ID：403662
> 
> 赞同：-2
> 
> 时间：2008-12-31T18:10:12.797
> 
> 标签：c++, c

如何将字符串转换为整数数组？我可以使用吗`sstream`，因为`atoi`不起作用？！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T18:17:45.323

正如您在评论中所说，您有一个二进制字符串，并且您想将其转换为整数。为此使用 bitset：

```
std::istringstream is(str);
std::bitset<32> bits; // assuming each num is 32 bits long

while(is >> bits) {
    unsigned long number = bits.to_ulong();
    // now, do whatever you want with that long.
    v.push_back(number);
} 
```

如果该字符串中只有一个二进制数，`str`则可以逃脱

```
unsigned long number = std::bitset<32>(str).to_ulong(); 
```

在 C 中转换它也是可能的......

```
long value;
char const *c = str;
for(;;) {
    char * endp;
    value = strtol(c, &endp, 2);
    if(endp == c)
        break;

    /* huh, no vector in C. You gotta print it out maybe */
    printf("%d\n", value);
    c = endp;
} 
```

`atoi`无法解析二进制数。但是`strtol`如果你告诉它正确的基础，可以解析它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T18:16:28.883

您希望转换如何工作？您只是想要一个包含数组中每个字符的 ASCII 值的数组吗？（所以“abc”变成 [97, 98, 99, 0]）？

或者你想以某种方式解析字符串？("1, 2, 3" 变成数组 [1, 2, 3])

在第一种情况下，在 C++ 中，我会做这样的事情：

```
struct convert {
  int operator()(char c) {
    return static_cast<int>(c);
  }
};

std::string str = "hello world";
std::vector<int> result;
std::transform(str.begin(), str.end(), std::back_inserter(result), convert()) 
```

当然，您可以使用原始数组而不是向量，但由于字符串的长度可能是可变的，因此数组只是在自找麻烦。

如果这不是您想要的，您可能需要编辑您的问题以更具体。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T18:24:56.400

据我了解，输入字符串“110013”将转换为数组 {1,1,0,0,1,3}。以下是如何在 C++ 中执行此操作：

```
string a = "1110011000";
vector<int> v;
for(int i = 0 ; i < a.length() ; i++){
    v.push_back(a[i] -'0');
}

// Check the result
for(int i = 0 ; i < v.size() ; i++){
    cout << v[i] << endl;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T23:03:52.423

Language: C

Header:

```
#include <stdlib.h> 
```

Function Prototype:

```
long int strtol(const char *nptr, char **endptr, int base); 
```

Example Usage:

```
strtol(nptr, (char **) NULL, 10); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T19:04:01.580

将 istream_iterator 与字符串流结合使用。

通过数组我假设你真的是一个 std::vector 因为你不知道编译时整数的数量。但是可以很容易地修改代码以使用数组而不是向量。

```
#include <iostream>
#include <sstream>
#include <string>
#include <vector>
#include <iterator>
#include <algorithm>

int main()
{
    std::string     data = "5 6 7 8 9";
    std::vector<int>    store;

    std::stringstream   dataStream(data);
    std::copy(std::istream_iterator<int>(dataStream),
              std::istream_iterator<int>(),
              std::back_inserter(store)
             );

    // This line just copies the store to the std::cout
    // To verify it worked.
    std::copy(store.begin(),
              store.end(),
              std::ostream_iterator<int>(std::cout,",")
             );
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T18:22:50.477

快速字符串拆分器例程：

```
convert(string str, string delim, vector<int>& results)
{
  int next;
  char buf[20];
  while( (next= str.find_first_of(delim)) != str.npos ) {
    if (next> 0) 
      results.push_back(atoi(str.substr(0,next), buf, 10));
    str = str.substr(next+1);
  }
  if(str.length() > 0)
    results.push_back(atoi(str.substr(0,next), buf, 10));
} 
```

您可以使用 stringstream 而不是 atoi （它确实有效，一次在一个 int 上）

```
int i;
stringstream s (input_string)
s >> i; 
```

如果你结合我和 jalf 的代码，你会得到一些非常好的东西。

# windows - SQLite 用于只读应用程序？

> ID：403668
> 
> 赞同：1
> 
> 时间：2008-12-31T18:14:17.953
> 
> 标签：windows, sqlite

对于数据库驻留在 Windows 网络驱动器上的多用户只读应用程序，SQLite 是否可以正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T18:20:11.683

我认为，如果您只是阅读，那么可以。根据[SQLite FAQ](http://www.sqlite.org/faq.html#q5)写作可能是一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T18:18:15.837

大多数 SQLite 工作都是在内存中完成的。如果你有足够的可用内存，SQLite 除了读取数据库一次之外不会做太多的 I/O。

# ruby-on-rails - .build、.create 和 .create 之间的区别！什么时候应该使用它们？

> ID：403671
> 
> 赞同：174
> 
> 时间：2008-12-31T18:14:50.057
> 
> 标签：ruby-on-rails

所以我最近越来越多地看到人们在他们的控制器中使用`.build`,`.create`和。`.create!`与仅使用`.new`和传递 param'd 对象 then 有什么区别`.save`？有优点和缺点吗？使用这些其他方法是否有好处？

* * *

## 回答 #1

> 赞同：243
> 
> 时间：2008-12-31T18:26:54.183

有一些差异，但它们并不大：

1.  `.create`相当于`.new`后面跟着`.save`。它只是更简洁。
2.  `.create!`等价于（如果保存失败`.new`则`.save!`抛出错误）。它也只是有点短
3.  我认为`.build`主要*是*`.new`. 它[在 Rails 3 中以](https://stackoverflow.com/questions/4954313/build-vs-new-in-rails-3)一种方式工作，在 Rails < 3.x 中以另一种方式工作

然而，最重要的部分是可以通过关联（`has_many`等）调用这些方法来自动链接两个模型。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-03-08T08:53:14.340

虽然`create`call是正确的，但是在它们的返回值上，两个替代方案`new`之间`save`存在很大差异。

`Save`根据对象是否成功保存到数据库中返回`true`或返回。`false`然后可以根据上述问题中的第一个示例将其用于流量控制。

`Create`无论对象是否已保存，都将返回模型。这对上面的代码有影响，因为`if`即使对象未通过验证并且未保存，语句的顶部分支也将始终执行。

如果您使用`create`分支逻辑，您将面临静默失败的风险，如果您使用`new`+则不会出现这种情况`save`。

`create!`如果记录无效，则不会遇到与引发和异常相同的问题。

`create`替代方法在`respond_with`用于 API (JSON/XML) 响应的控制器中很有用。在这种情况下，对象上存在错误将导致错误在响应中返回，状态为`unprocessable_entity`，这正是您希望从 API 获得的。

我总是对 html 使用`new`+`save`选项，尤其是当您依赖返回值进行流量控制时。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-31T18:25:09.037

#create 是 new 和 save 的较短版本。＃创造！如果验证不是肯定的，则抛出异常。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-04-05T05:19:37.693

我会支持上述答案。另外`create`，一个不能`false`作为您可以使用的参数传递`save`。`false`作为参数传递将跳过所有 Rails 验证

# user-interface - 切换 OK-Cancel 和 Cancel-OK 以强制用户交互？

> ID：403687
> 
> 赞同：9
> 
> 时间：2008-12-31T18:18:26.133
> 
> 标签：user-interface, usability

[这是由OK-Cancel 或 Cancel-OK?](https://stackoverflow.com/questions/50335/ok-cancel-or-cancel-ok)问题启发的。.

我记得在某处读过关于在某些情况下切换 OK-Cancel/Cancel-OK 的概念，以防止用户在未阅读其内容的情况下单击信息弹出窗口或对话框。据我记得，这还包括移动“确定”按钮的位置（水平，从左到右），以防止用户只记得点击的位置。

这真的有意义吗？这是强迫用户“先思考/阅读，然后点击”的好方法吗？还有其他适用于这种情况的概念吗？

我特别想到了一个与安全相关的应用程序，在这种应用程序中，出于习惯而轻率地按下 OK 可能会导致潜在的危险情况，而 Cancel 会导致安全状态。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-31T18:22:54.470

请不要这样做，除非你真的，真的，*真的*确定它是绝对需要的。这是一个试图通过技术手段解决粗心和愚蠢的案例，而这种事情几乎永远不会奏效。

您可以做的是使用动词或名词，而不是典型的 Windows 确定/取消按钮标题。这将在不牺牲可预测性的情况下为您带来即时的关注收益。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-31T18:23:20.960

不不不不不不不不不不！

在我们的一款产品中，我们有一个用户选项，要求使用 Ctrl+Click 来执行与安全相关的命令。

但是在我的书中，用交换位置或四处移动的按钮让用户吃惊是糟糕的设计。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-31T18:41:45.120

不。如果你让用户更难错误地点击 OK 并强迫他们思考，他们*仍然*只会更加努力地思考如何点击 OK——他们不会考虑他们正在尝试执行的实际操作。请参阅可用性专家 Aza Raskin 的文章：[当您的意思是 Undo 时，切勿使用警告](http://www.alistapart.com/articles/neveruseawarning/)。引用：

 **> **如何使警告无法忽略？如果是人的习惯导致了问题，为什么不设计界面让我们无法形成习惯。这样，在回答问题之前，我们总是会被迫停下来思考，所以我们总是会选择我们想要的答案。那会解决问题的，对吧？
> 
> 这种思维方式并不新鲜：它是这种句子的第 n 个单词的类型以继续的方法。例如，在游戏激战中，删除一个角色需要先点击一个“删除”按钮，然后输入角色的名字作为确认。不幸的是，它并不总是有效。尤其：** 
> 
> ***   它使我们专注于手头的非习惯性任务，而不是我们是否想放弃我们的工作。因此，不可能忽略的警告比正常警告要好一点：无论哪种方式，我们最终都会丢失我们的工作。这（失去我们的工作）是最糟糕的软件罪过。*   它非常烦人，而且因为它总是需要我们的注意力，它必然会分散我们的工作注意力（这是软件中第二大罪过）。**
> 2.  **它总是比标准警告更慢且工作量更大。因此，它犯了第三大罪——要求我们做更多的工作而不是必要的。**

[如果你想要一个微软风格的，[这个 MSDN 上的 .NET 家伙](http://msdn.microsoft.com/en-us/magazine/cc163835.aspx)说的也是一样的！]

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-31T18:34:22.687

如果您必须使用对话框，请在对话框内的按钮上添加描述性标题。

例如，让他们说“发送发票”和“返回”，而不是“确定”和“取消”按钮，或者在对话上下文中适当的任何内容。

这样，文本就在他们的光标下，他们有很好的理解机会。

Apple Human Interface Guideline 站点是一个很好的参考，并且非常易读。 [该站点上的此页面讨论了对话框。](https://developer.apple.com/library/mac/documentation/UserExperience/Conceptual/OSXHIGuidelines/WindowDialogs.html#//apple_ref/doc/uid/20000957-CH43-SW1)

这是一个示例图像：（[来源：][[apple.com](https://developer.apple.com/library/mac/documentation/UserExperience/Conceptual/OSXHIGuidelines/Art/sheet_example_2x.png)][）][![带有命名按钮的模态](https://i.stack.imgur.com/4gRZU.png)](https://i.stack.imgur.com/4gRZU.png)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-31T18:25:37.307

不，这没有意义。你不会“让”用户阅读。如果决定如此重要，那么你最好找到一种方法来减轻危险，而不是把一把上膛的枪交给一个假定粗心的用户。

无论如何，将“安全”按钮设置为默认值（由输入/空格键/等触发）是一个好主意，因为如果它们让用户感到惊讶，那么针对预期窗口的击键不会意外触发意外操作。但即使在这种情况下，您也必须意识到，当用户意识到他们所做的事情时，选择已经消失（以及对话框上的任何解释性文本）。同样，您最好找到另一种向他们提供信息的方法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-31T18:40:01.037

在某些情况下，我所做的是将显示消息框的时间与关闭它的时间进行比较。如果它少于“x”秒，它会立即弹出。在大多数情况下，这迫使他们实际阅读屏幕上的内容，而不是盲目地点击它。

做起来也挺简单的......

像这样的东西：

```
Dim strStart As DateTime = Now
While Now < strStart.AddSeconds(5)
    MessageBox.Show("Something just happened", "Pay Attention", MessageBoxButtons.OK)
    If Now < strStart.AddSeconds(5) Then strStart = Now Else Exit While
End While 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-31T19:26:15.887

归根结底，您不能强迫用户做他们不愿意做的事情……他们总能找到解决方法

*   快捷键绕过将鼠标移动到移动按钮的要求。
*   向下滚动到 EULA 的底部而不阅读它以启用继续。
*   启动软件，然后在等待 nag 屏幕启用 OK 按钮时去喝杯茶。

我见过的最可靠的方法是根据所写的内容给出一个多项选择题。如果他们没有得到正确的答案，他们就无法继续……当然，在几次之后，他们会意识到他们可以依次选择每个答案，直到按钮启用然后单击它。再次意味着他们不阅读所写的内容。

在您必须为用户的行为承担责任之前，您只能走这么远。告诉用户他们的行为被记录下来会让他们更加小心——如果他们被追究责任，他们更有可能做正确的事情。尤其是如果有一条精心设计的消息说：

> 这将被记录下来，您将对此决定的任何影响负责。您已指示我删除表 ALL_CORPORATE_DATA。这样做会导致整个公司的数据库停止工作，从而使整个公司陷入停顿。
> 您必须选中复选框以声明您接受此责任，然后才能选择继续...

然后是一个带有“是的，我接受我的行为的责任”的复选框和两个按钮：

*   “是的，我想删除它”这个按钮只有在复选框被选中时才应该被启用。
*   “哦，废话，这根本不是我的意思”这个按钮总是可以启用的。

如果他们删除表格并且公司网格停止，他们就会被解雇。然后备份被恢复，每个人都再次像拉里（无论拉里是谁）一样高兴。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-19T19:31:29.037

请不要这样做。这不会产生任何积极影响：您试图避免人们单击“确定”而不是“取消”，让他们可能会单击“取消”而不是“确定”（好吧，他们可能会再试一次）。但！当人们真正想取消时，您还不如实现他们单击“确定”，这可能是一场真正的灾难。就是不好。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-19T19:45:58.190

为什么不重新设计 UI 以使 OK 成为“安全选择”？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-19T20:34:58.773

结合良好的反馈、系统模型的沟通和内置公差，可以更好地解决这个问题。

赞成确认机制的说法是实现的简单性。从程序员的角度来看，这是将责任转移到用户身上最简单的方法：“嘿，我问过你是否真的想把自己踢到脚上，不是吗？现在除了你自己，没有人可以责备...... 。”

从用户角度：

1.  即使实际错误只占操作总数的一小部分，每次都必须确认操作两次，这会降低生产力，任何按钮切换、打破习惯性工作流程或在确认中插入暂停只会增加惩罚。
2.  该机制并没有真正为那些反应在有意识的头脑之前工作的频繁用户提供太多的安全网。就我个人而言，我曾多次完成一系列复杂的动作，但过了一会儿，当我观察到我的大脑不知何故走错路的后果时才意识到！

对用户更好但更复杂（从软件开发的角度来看）的解决方案是：

*   在可能的情况下，提前沟通该操作将对系统产生的确切影响（例如 Stack Overflow 在“发布您的答案”按钮上方显示消息预览）。

*   一旦操作发生，立即提供反馈以确认（SO突出显示新提交的答案，gmail在发送消息时显示确认等）。

*   允许撤消或更正可能的错误（即在这种情况下删除或编辑答案，Windows 允许从回收站等恢复文件）。对于某些不可逆的操作，仍然可以提供撤消功能，但仅限于有限的时间范围（即允许在提交后的前 10 分钟内取消或更改在线订单，或允许在第一个“发送”后 60 秒，但实际上在发件箱中排队等）。

当然，这比插入确认消息框要多得多，但不是转移责任，而是试图解决问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-31T18:23:49.070

但是如果 OK/Cancels 不一致，那可能会让用户感到厌烦或不安。

并且不要像某些 EULA 那样强制用户在“同意”按钮变为可点击之前将面板滚动到底部。有时您无法让用户仔细阅读所有内容。

如果他们真的需要阅读它，也许应该在按钮出现之前发生短暂的延迟？这也可能让用户感到恼火，但如果这是一个非常关键的问题，那就值得了。

编辑：或者需要某种额外的机制，而不仅仅是单击“接受”非常重要的决定。复选框、按键、密码等。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-31T18:25:58.537

我建议通过使用红色文本来告知用户这是一项关键操作，并解释为什么这是一个不安全的操作。

此外，不是两个按钮，而是有两个单选按钮和一个“确定”按钮，默认选择“不继续”单选按钮。

这将为用户提供一个不常见的界面，增加认知负荷并减慢他的速度。这就是你想要的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-31T18:27:43.167

与任何与用户交互一样，您在帮助用户和烦人之间只有很小的空间。我不知道你的确切要求，但你的想法对我来说似乎没问题（双关语）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-31T18:29:40.230

听起来您的用户正在通过安全应用程序中的一种输入向导。

作为移动按钮的替代方案的一些想法。

1.  在按下最后的确定之前，有一个最终屏幕来查看所有输入。

2.  在他们点击确定后有一个确认框，解释此操作的结果将是什么。

3.  免责声明要求您在用户继续之前通过选中一个框来同意它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-31T18:37:44.207

不要改变它 - 你只会混淆而不是帮助。

相反，像 FireFox 一样，在 5 秒内不激活控件。- 只要确保您包含一个计时器或某种指示器，您就可以让他们有机会阅读它。如果他们点击它，它会切断计时器，但需要他们再点击一次。

不知道它会好多少，但它可能会有所帮助。

请记住，正如那个人所说：你不能解决愚蠢的问题。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-31T18:38:16.920

这会让我头疼。特别是当我不小心关闭应用程序并忘记保存我的文件时:(

我看到另一个强制用户在点击之前“阅读”的好例子：Firefox 总是将“确定”按钮**变灰（也就是禁用）。**因此，用户必须等待大约 5 秒才能继续执行任何操作。我认为这是我在强迫用户阅读（和*思考*）方面看到的最大努力

我看到的另一个例子是安装程序的“许可和协议”页面。其中一些要求用户向下滚动到页面末尾，然后才能继续下一步。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-31T18:40:06.980

键盘快捷键仍然会像以前一样运行（您会惊讶于很少有人真正使用鼠标（尤其是在 LOB 应用程序中）。

Vista（和 OSX IIRC）已经转向为每个问题使用特定动词的想法（例如当应用程序想要崩溃并想要向 MS 提交故障转储时使用“发送”/“不发送”）

在我看来，我喜欢 Outlook 在应用程序尝试通过 COM 发送电子邮件时使用的方法，在允许使用按钮之前使用计时器（也会影响键盘快捷键）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-31T19:25:02.177

如果您使用**Ok**和**Cancel**作为界面，您将始终允许用户跳过您的消息或屏幕。如果您然后重新排列**确定**和**取消**，您只会惹恼您的用户。

如果您的目标是确保用户理解，则解决方案是：

*   向用户询问内容。如果您单击“确定”即表示您同意选项 1，或者如果您单击“确定”则表示您同意选项 2。如果他们选择了正确的答案，则允许该操作。
*   这会惹恼用户，因此如果您可以跟踪用户，则每条消息只对他们执行一次。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-12-31T22:37:04.210

这就是我对[提交/重置按钮订单问题](https://stackoverflow.com/questions/349375/submit-reset-buttons-order-in-the-form#349467)的回应，我认为这里可以使用相同的原则。只要您确保用户可以区分这两个按钮，顺序并不重要。过去我所做的是使用（提交/确定）按钮的按钮并使用（重置/取消）按钮的链接。用户可以立即看出这两个项目在功能上是不同的，因此可以这样对待它们。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-04-19T19:56:43.953

我真的不赞成/取消。它被过度使用了，需要您阅读咿呀声才能说出您正在接受或取消的内容。遵循 MacOSX UI 的理念：按钮包含一个简单易懂且本身就有意义的短语。Exampleç 您更改文件扩展名并弹出一个对话框说：

```
"Are you sure you want to change the extension from .py to .ps?"
If you perform the change, the document could be opened by a different application.

(Use .ps)   (Keep .py) 
```

它比 OK/Cancel 更具交流性，而且您的问题几乎是多余的，也就是说，您只需要保持最右边的按钮处于活动状态，这似乎是标准。

因为它涉及您提出的原始问题。永远不要这样做。曾经。甚至在枪口下也没有。一致性是 GUI 的重要要求。如果您不一致，您将破坏用户体验，并且您的用户很可能会将其视为错误而不是功能（实际上这将是错误）。一致性非常重要。要打破它，你必须有很好的理由，并且不能有另一种不同的、标准的方式来达到同样的效果。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-04-19T20:26:57.950

我想知道您是否正在考虑 Visual Basic 中存在的选项，您可以在其中设置各种提示和响应选项；一种选择是允许您根据默认值切换取消和确定；所以用户可以直接按回车键，大多数时候都能得到正确的操作。

如果您真的想朝这个方向前进（我认为这是一个坏主意，而且我相信您也会在稍加思考并阅读所有其他帖子之后），最好包含一个验证码显示以显示 OK。

# javascript - 有谁知道可以从 JavaScript 调用以创建和保存桌面屏幕截图的无 GUI 应用程序？

> ID：403689
> 
> 赞同：0
> 
> 时间：2008-12-31T18:19:00.563
> 
> 标签：javascript, user-interface, screen-scraping

虽然这个主题听起来像是我想做一些狡猾的事情，但我不是；我维护一个由数百家电话运营商使用的内部网站，并希望添加以下功能：

我想在所有网页的标题中添加一个控件，该控件将捕获整个桌面的图像并将图像作为文件保存到共享网络驱动器，以帮助解决生产问题。此屏幕捕获应用程序将由 JavaScript 调用。

我在这个站点上研究了许多与捕获屏幕截图有关的线程，并且所有提供的应用程序都无法通过以下两种方式之一满足我的需求：

1.  屏幕捕获应用程序有一个弹出的 GUI，用户可以调整某种捕获控件的大小或与窗口交互以进行捕获。用户不是很懂计算机，不能信任正确使用“弹出式”应用程序 - 并且不可能强制他们使用通用文件命名约定保存图像文件。我希望用户在网站上按下单个 UI 控件并让 JavaScript 调用以获取屏幕截图并保存图像，而无需任何进一步的用户交互。

2.  一些自动化应用程序通过将 HTML 重新发布到站点并将各个 HTML 元素“重新组合”成图像来保存 HTML。这将不起作用，因为操作员输入的输入数据需要在图像中，该站点使用 AJAX，因此网页的视觉“状态”将与从 POST 重新获得的不同，并且某些应用程序尝试与我们的（安全）网站交互时遇到（活动目录）安全问题。

如果没有可以满足此需求的应用程序，我将在 C# 中滚动我自己的控件。但我宁愿获得第三方控制。所以我不必支持自己对生活的控制。:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-31T23:23:06.533

Some alternatives to ActiveX / Java:

*   You can create a flash program to do the screen capture. I haven't done this and don't know the details, but I'm fairly sure it can be done.

*   You can setup a [custom protocol](http://blog.ryaneby.com/archives/firefox-protocol-handlers/) for screen capture (eg. screencapture:// ), and in your header include a

    <a href="screencapture://this/">Screen Capture</a>

link. You'll need to find a gui-less screen capture program to do the actual capturing and set it up as the handler for that custom protocol.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T18:25:45.107

由于存在安全风险，Javascript 不为此功能提供对本地系统的访问。

我相信在网页上执行此操作的唯一方法可能是通过活动的 X 控件或 Java 小程序（类似于[screencast-o-matic](http://www.screencast-o-matic.com/)），但即便如此，安全性也可能是一个问题。

我还想像，除非您自己的 c# 控件位于 Windows 窗体应用程序中，否则它将无法工作，因为作为网站一部分的 c# 控件将在服务器而不是客户端上运行。

希望这个对你有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T18:26:47.147

要做到这一点，您需要一些东西来与桌面交互，而这不能仅由 javascript 完成。

您需要有一个 Active X 对象才能与客户端的机器进行交互。一旦你有了它，就很容易让对象拍照并将其保存到目录中。

我相信我有 C# 代码来截屏。如果你愿意，我会发布它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-26T19:11:49.833

做过一次。我找不到直接的方法，所以它将 HTML 渲染到画布，然后使用 html2canvas 将画布渲染到图像。画布到图像是一个更常见的主题，因此您会找到许多有关的教程。

[HTML 到画布](http://html2canvas.hertzen.com/)

[画布图像](http://www.html5canvastutorials.com/advanced/html5-canvas-save-drawing-as-an-image/)

注意：从 HTML 渲染到画布可能会留下一些元素，例如 SVG。但总的来说，它的表现和预期的一样多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-07T14:41:10.300

PSR（问题步骤记录器）是用于在客户端机器上进行调试的绝佳工具，默认情况下可在所有 Windows 机器上使用。

试试下面，看看它是否适合你。

转到开始-> 运行并键入 psr.exe（或只是 psr），这应该会打开记录器。这相当容易使用，因此即使是用户/客户也可以使用它。如果可行，请尝试以下步骤进行设置。

**第一步**：注册 PSR 协议。这告诉浏览器当页面上的链接引用 PSR 协议（我们将使用它来打开此记录器）时要做什么。- 创建注册表值如下

```
HKEY_CLASSES_ROOT/
  PSR/
    (Default)    "URL:PSR Protocol"
    URL Protocol ""
    shell/
      open/
        command/
          (Default) psr.exe 
```

如果您对创建注册表值不满意，请下载并双击[此](https://www.dropbox.com/s/3zdryuttoi4t35g/RegisterProtocol.reg?dl=0)文件。

*   使用[此](https://msdn.microsoft.com/en-us/library/aa767914%28v=vs.85%29.aspx)链接了解更多信息。

**第 2 步**：现在创建一个示例 html 文件来测试启动 PSR。将以下代码保存到 index.html 文件并打开它。

```
<html>
   <head>
      <head>
   </head>
   <body>
      <a href="psr:start">Start Recording</a>
   </body>
   </head>
</html> 
```

或者下载[这个](https://www.dropbox.com/s/vxk262ag92uktr6/index.html?dl=0)文件并打开它。

这应该会打开您的 PSR。它易于使用，可以记录调试所需的所有信息。

# wpf - WPF 中的 MaxAutoWidth

> ID：403702
> 
> 赞同：0
> 
> 时间：2008-12-31T18:23:28.527
> 
> 标签：wpf, layout

有没有限制元素或网格列的自动宽度的好方法？我只想限制自动宽度，但允许任何用户更改。

比如我想让GridSplitter任意调整列的大小，但是初始（Auto）Width不应该超过一个特定的值。元素也是如此——我想允许调整大小，但如果从未调整大小，则限制它们的宽度。

MaxWidth 完全相反——它不会影响网格列的自动宽度（它可能是一个错误），但会限制调整后的宽度。

有没有适用于（几乎）任何元素或网格部分的好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T18:41:44.650

尝试将 the 绑定`MaxWidth`到 the`Width`并使用 a对从特定值`IValueConverter`的更改做出反应。`Auto`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-05T23:14:48.167

In the grid column set the width you want the column to start at. Any changes to the column width made by the user using the grid splitter will overwrite the width you start with.

# php - 如何在 Zend 框架中使用 mod_rewrite？

> ID：403703
> 
> 赞同：2
> 
> 时间：2008-12-31T18:23:45.267
> 
> 标签：php, apache, zend-framework, mod-rewrite

我刚刚使用 Zend Framework 部署了一个新站点。由于我的教程很受欢迎，我想将任何教程请求重定向到新站点上的相关页面。到目前为止，这就是我所拥有的：

重写前的 URL：http: [//neranjara.org/tutorials/ ?tid=56](http://neranjara.org/tutorials/?tid=56)

重写后的网址：http: [//neranjara.org/article/id/56](http://neranjara.org/article/id/56)

我尝试使用的 .htaccess 文件如下所示：

```
  $ 猫 html/.htaccess
  重写引擎开启

  RewriteRule 教程/\?tid=(.*)$ /article/id/$1 [R=301]
  RewriteRule !\.(js|ico|gif|jpg|png|css|xml|phps)$ index.php

```

但是此规则不匹配任何 URL ... :'(

有人看到这里有问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T19:34:21.393

查询字符串（传递给您的文件的参数）不会在 RewriteRule 中。

取自[http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewriterule](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewriterule)：

> 模式不会与查询字符串匹配。相反，您必须使用带有 %{QUERY_STRING} 变量的 RewriteCond。但是，您可以在包含查询字符串部分的替换字符串中创建 URL。只需在替换字符串中使用问号，即可指示应将以下文本重新注入到查询字符串中。当您想删除现有的查询字符串时，只用问号结束替换字符串。要将新查询字符串与旧查询字符串组合，请使用 [QSA] 标志。

你有两种可能：

1.  删除您的第一个 RewriteRule 并在您的 index.php 中进行验证，然后再继续您的框架。初始查询应该在`$_SERVER['REQUEST_URI']`或类似的地方可用。所以验证它是否是**tutorials**，获取**tid**参数，然后继续重定向：

    ```
    header("Location: http://http://neranjara.org/article/id/$id");
    exit(); 
    ```

2.  如 Apache 文档中所述，使用 RewriteCond 和 %{QUERY_STRING} 代替。[这个解决方案在这样](http://www.webmasterworld.com/apache/3752570.htm)的线程中讨论。

**// 编辑：**

看看[Chris 的回答](https://stackoverflow.com/questions/403703/modrewrite-with-zend-framework#406079)，他很友好地使用 QUERY_STRING 详细说明了解决方案。这可能是您想要使用的。谢谢克里斯。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-02T05:08:16.413

根据您之前的条目：

```
 $ cat html/.htaccess
  RewriteEngine on

  RewriteRule tutorials/\?tid=(.*)$ /article/id/$1 [R=301]
  RewriteRule !\.(js|ico|gif|jpg|png|css|xml|phps)$ index.php 
```

我建议改用这个：

```
 $ cat html/.htaccess
  RewriteEngine on

  RewriteCond %{QUERY_STRING} ^tid=([^&]*)
  RewriteRule tutorials/ /article/id/%1 [R=301, L]

  RewriteRule !\.(js|ico|gif|jpg|png|css|xml|phps)$ index.php [L] 
```

顺便说一句，这只是使用`QUERY_STRING`mod_rewrite 中的变量可以做的许多事情的一个例子。我的投票投给了“lpfavreau”，因为这是他们回答中的选项#2。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-31T19:39:52.490

Zend 使用了 htaccess 可以提供的所有 htaccess 功能，因此有一个非常方便（可链接且有趣且没有很好的文档记录）的方法来在引导程序中实现这一点！

您必须在引导程序 (index.php) 中使用 Zend 路由器。可能是这样的：（这将是 foo.com/article/23

> $router = $frontController->getRouter();
> 
> $route = new Zend_Controller_Router_Route('article/:id', array('id' => 1) ); $router->addRoute('article', $route);

更多信息[在这里](http://framework.zend.com/manual/en/zend.controller.router.html)

# c# - 强名称验证失败

> ID：403731
> 
> 赞同：34
> 
> 时间：2008-12-31T18:34:16.693
> 
> 标签：c#, c++-cli, code-signing

两台机器。.NET 3.5 和 VS 2008 VC++ SP1 可再发行组件

一个使用两个签名 DLL 的单个 exe，一个在 C++/CLI 中，一个在 C# 中

exe 在一台机器上加载并运行良好。

另一方面，我在 C++ 可执行文件（HRESULT 0x8013141A）上得到“强名称验证失败”

有任何想法吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2015-12-07T12:16:52.167

以管理员身份打开命令提示符并输入以下命令：

```
reg DELETE "HKLM\Software\Microsoft\StrongName\Verification" /f
reg ADD "HKLM\Software\Microsoft\StrongName\Verification\*,*" /f
reg DELETE "HKLM\Software\Wow6432Node\Microsoft\StrongName\Verification" /f
reg ADD "HKLM\Software\Wow6432Node\Microsoft\StrongName\Verification\*,*" /f 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-09-12T09:22:39.740

**以管理员身份**打开命令提示符并输入以下命令：

> "C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bin\x64\sn.exe" -Vr <dllpath>

请注意参数区分大小写。更多详细信息的来源：http: [//blogs.msdn.com/b/keithmg/archive/2012/03/20/strong-name-validation-failed-exception-from-hresult-0x8013141a.aspx](http://blogs.msdn.com/b/keithmg/archive/2012/03/20/strong-name-validation-failed-exception-from-hresult-0x8013141a.aspx)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-10-20T19:10:56.597

您必须在 64 位计算机上使用 64 位版本的 sn.exe。(C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bin\x64\sn.exe)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-24T12:55:45.360

是代码在“开发”机器上运行的那个，您可能在某个阶段运行“sn.exe -Vr AssemblyName.dll”，这将允许您使用延迟签名的程序集，就好像它已完全签名一样。当您将延迟签名的程序集传输到另一台机器并运行它时，它将无法通过强名称验证，因为它没有完全签名。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-04-05T11:20:24.207

就我而言，我遇到了同样的问题，`Visual Studio 2015`并且我已经签署了程序集。

我通过这种方式修复了它：**右键单击导致问题的项目->“属性”->“构建”->更改“平台目标”字段的值。**

我不得不将它从更改为`Any CPU`，`x86`但我想在项目功能和失败的库中，您应该将其值更改为`x64`.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-01-14T10:01:37.297

较新版本的 Visual Studio 中缺少 SN.EXE。在 Visual Studio 2012 中，我们必须使用“Visual Studio 2012 的开发人员命令提示符”。然后运行命令“sn”。

语法：sn -Vr *,2d58152b8e842be2

其中“2d58152b8e842be2”是错误消息中显示的公钥令牌。不知何故，仅此一项并不能解决我的问题。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-11-15T15:33:46.290

您可以通过进入项目设置 -> 签名 -> 并取消选中“签署程序集”来绕过开发。

我今天在针对实体框架的源代码副本进行调试时遇到了这个问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-10-07T09:10:23.937

如果有人找不到 64 位版本`sn.exe`，请在此处查看： `C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.7.2 Tools\x64\sn.exe`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-02-27T11:34:36.480

我今天遇到了这个问题，偶然发现了[http://timgeerts.blogspot.co.uk/2009/08/strong-name-validation-failed.html](http://timgeerts.blogspot.co.uk/2009/08/strong-name-validation-failed.html)，这似乎是解决方案。

选项 1）关闭代码覆盖（在 VS 2010 中，转到测试设置 -> 数据和诊断 -> 取消选中代码覆盖旁边的“启用”框）。

选项2）将签名密钥文件添加到代码覆盖配置中（在VS 2010中，进入测试设置->数据和诊断->选择代码覆盖并单击顶部的“配置”。这对应于“keyFile”属性对于 .testsettings 文件中的 CodeCoverage 标记。）

在 VS 2012 中，默认启用代码覆盖。可以通过具有适当排除项的 .runsettings 文件禁用它。有关详细信息和示例文件，请参阅[http://msdn.microsoft.com/en-us/library/jj159530.aspx](http://msdn.microsoft.com/en-us/library/jj159530.aspx)。对于选项 2，尽管 .runsettings 文件中似乎没有可用的明确设置，但在签名 (YMMV) 方面似乎会自动发生正确的事情。但是，如果您引用的是 VS 2010 .testsettings 文件，则需要按上述方式进行编辑。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-09-13T08:31:40.040

右键单击项目→属性→构建选项卡→平台目标→选择“x64”

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-11-26T17:26:07.070

我正在使用 VS.Net Ultimate 2012

这个解决方案帮助了我：

右键单击项目->属性->构建选项卡->将生成序列化程序集切换为关闭->完成

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-05-08T08:34:34.280

我通过转到“构建”菜单（顶部窗格）并仅针对该特定项目说“重建 xxxProject.plugin”来解决此问题，这与构建整个解决方案相反。

# .net - 找不到 Dotnet 安装优化器，有什么想法吗？

> ID：403734
> 
> 赞同：2
> 
> 时间：2008-12-31T18:36:56.550
> 
> 标签：.net, installation, windows-installer

早在 2005 年，我就从事 dotnet 桌面应用程序的工作。当时我正在寻找安装程序来创建安装包。在我的搜索过程中，我发现了一个简洁的工具，它将您的应用程序与 dotnet 本身绑定，仅包括应用程序运行所需的 dotnet 部分。它使用依赖解析来做到这一点。许可起价约为 5000 美元，大约是项目预算的一半，所以我从未购买过它。

我不记得安装程序的名称，我用谷歌搜索过，但一无所获。你接触过这个产品吗？你记得名字或有他们网站的链接吗？

编辑：澄清一下，在使用此产品时，您不需要检查是否安装了 dotnet 或安装了哪个版本并且需要安装 dotnet。dotnet 只是链接到应用程序本身，因此应用程序和 dotnet 无法区分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T19:27:02.190

从[乔恩的常见问题解答](http://www.yoda.arachsys.com/csharp/faq/#framework.required)：

> 如上所述，有些产品可以将您所需的一切从您的应用程序框架以及您的应用程序本身构建到一个大捆绑包中：

*   [RemoteSoft 的链接器和小型部署工具](http://www.remotesoft.com/linker/index.html)
*   [安装工作室](https://thinstall.com/solutions/net_virtual.php)
*   [异码](http://www.xenocode.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T18:45:36.703

不完全是您想要的，但可以实现您的目标：有人将 .Net 1.1 和 .Net 2.0 以及所有更新重新打包成支持静默安装的更小的 EXE。您可以检查用户是否拥有 .NET，如果没有，则静默使用它们来安装它。它实际上比您使用的更好，因为用户拥有所有 .NET，而不是一些手动残缺的版本。这些文件的大小还不错，这个包中的 .NET 2.0 只有 16MB。

[http://www.ryanvm.net/msfn/](http://www.ryanvm.net/msfn/)

# rss - 在另一个中包含一个 RSS 提要，可能吗？如何？

> ID：403735
> 
> 赞同：0
> 
> 时间：2008-12-31T18:37:02.663
> 
> 标签：rss

我正在使用[JAlbum](http://jalbum.net)创建我的网络相册，并且由于 8.1 版 JAlbum 支持相册的 RSS 源。但是，JAlbum 生成的 RSS 提要不适用于包含文件夹层次结构的相册。他们试图在 RSS 提要中做的是通过包含一个元素来包含子文件夹的 RSS 提要（参见下面的示例）。这在 NetNewsWire 和 GoogleReader 中不起作用，而 feedvalidator.org 也报告了这方面的警告。可以更改 JAlbum 使用的 RSS 模板来生成 RSS 提要。我正在尝试解决这个（和其他）问题，但真的怀疑是否有可能从一个 RSS 提要引用另一个 RSS 提要并将子提要的条目包含在主提要中。

*   是否可以在另一个提要中包含 RSS 提要？如何？（找不到示例，也没有在 JAlbum 论坛上得到回复。）

如果不可能，我会采取另一种方法，但是如果可以为每个文件夹创建一个提要并让父文件夹通过简单地引用它来包含子文件夹的提要，那感觉非常好。

```
<channel>
    <title>test</title>
    <link>.</link>
    <generator>Jalbum 8.1</generator>
            <description></description>

    <jalbum:link rel="sub" href="aaa/album.rss" />                  

</channel> 
```

问候，格罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T18:50:39.143

[您可能可以使用Yahoo Pipes](http://pipes.yahoo.com/)实现您正在寻找的东西。它具有操作和组合提要的设施。通过一些试验和错误，你可以用它做一些非常复杂的事情。

# html - 使用 CSS 将整个页面居中

> ID：403736
> 
> 赞同：0
> 
> 时间：2008-12-31T18:37:42.007
> 
> 标签：html, css

我正在尝试仅使用 CSS 将整个页面居中，事实证明它比我最初预期的要复杂。目前我的代码可以在 IE 中运行，但不能在 Firefox 中进行更改。该页面可以在[这里](http://www.ronnieweb.co.cc/test/index.html)看到。以下是涉及的代码部分：

```
#wrap {
    width: 960px;
    margin: 0 auto;
    padding: 6px;
    background: #FFFFFF;
} 
```

我的 HTML 的结构是：

```
<body>
<div id="wrap">
    Gubbins in here.
</div>
</body> 
```

似乎在 Firefox 中，wrap div 之后的所有内容都是在它之外创建的。如果我在包装 div 中添加“浮动：向左”，则此问题得到解决，但显然所有内容都向左浮动而不是居中。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T18:39:12.347

将您的标记更改为

```
<body>
<div id="wrap">
    Gubbins in here.
</div>
</body> 
```

编辑：查看链接，您已经完成了。您需要添加溢出：自动；#wrap 或在 wrap div 的结束标记之前的末尾添加一个清除 div。

此外，在您的示例页面上，包装 div 缺少其结束标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T18:45:24.270

使用这个 CSS：

```
body { text-align:center;}
#wrap {text-align:left; margin: 0 auto; width:960px;} 
```

然后，让我们从您的问题中检查此陈述：

> wrap div 之后的所有内容都是在它之外创建的

这就是它的工作方式。 *不要把任何东西放在你的 wrap div 之外。* 把它想象成一个代理机构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T19:20:05.463

如果您知道页面的宽度 - 并且它是固定的，您可以使用以下方法。

*   使用 div 包含您的页面内容（它将充当包装器）
*   给这个 'wrapper' div 的宽度' **W** '
*   使用 'left: 50%;' 定位包装器 div

*现在，利用可能有负边距的事实......*

*   使用 'margin-left: -( **W/2** );'拉回包装 div 的位置

# c++ - C++ 跨平台应用程序中本地化文本的最佳实践？

> ID：403747
> 
> 赞同：28
> 
> 时间：2008-12-31T18:40:14.373
> 
> 标签：c++, localization

在当前的 C++ 标准 (C++03) 中，关于文本本地化的规范太少了，这使得 C++ 开发人员在处理本地化文本时比平时更加​​困难（当然 C++0x 标准稍后会有所帮助）。

### 假设以下场景（来自真实的 PC-Mac 游戏开发案例）：

1.  **响应式（实时）应用程序**：应用程序必须将非响应时间降至“不明显”，因此执行速度很重要。
2.  **本地化文本**：显示的文本被本地化为两种以上的语言，可能更多——不要指望固定数量的语言，应该很容易扩展。
3.  **运行时定义的语言**：文本不应在应用程序中编译（也不应每种语言有一个应用程序），您会在应用程序启动时获得选择的语言信息 - 这意味着某种文本加载。
4.  **跨平台**：应用程序的编码考虑到跨平台（Windows - Linux/Ubuntu - Mac/OSX），因此本地化的文本系统也必须是跨平台的。
5.  **独立应用程序**：应用程序提供运行它所需的一切；它不会使用任何环境库或要求用户安装操作系统以外的任何东西（例如大多数游戏）。

## 在此类应用程序中管理 C++ 本地化文本的最佳实践是什么？

去年我对此进行了研究，我唯一确定的是您应该使用`std::wstring`或`std::basic_string<ABigEnoughType>`操作应用程序中的文本。我停止了我的研究，因为我更多地研究“文本显示”问题（在实时 3D 的情况下），但我想还有一些最佳实践可以在原始 C++ 中管理本地化文本并“使用 Unicode” .

因此，欢迎所有最佳实践、建议和信息（我认为跨平台很难）！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-31T19:49:30.473

在一家名为 Black Lantern Studios 的小型视频游戏公司，我是一款名为 Lionel Trains DS 的游戏的首席开发人员。我们本地化为英语、西班牙语、法语和德语。我们预先知道所有的语言，所以在编译时包括它们是唯一的选择。（它们被刻录到 ROM 中，你看）

我可以向您提供我们所做的一些事情的信息。我们的字符串在启动时根据播放器的语言选择加载到一个数组中。每种单独的语言都进入一个单独的文件，所有字符串都以相同的顺序排列。字符串 1 始终是游戏的标题，字符串 2 始终是第一个菜单选项，依此类推。我们将数组从 中键控出来`enum`，因为`integer`索引非常快，而在游戏中，速度就是一切。（在其他答案之一中链接的解决方案使用`string`查找，我倾向于避免。）显示字符串时，我们使用`printf()`类型函数将标记替换为值。“*火车 3 正在离开城市 1。* ”

现在谈谈一些陷阱。

1）在语言之间，短语顺序是完全不同的。“*火车 3 正在离开城市 1。* ”翻译成德语并返回结果是“*从城市 1，火车 3 正在离开*”。如果你使用类似的东西`printf()`并且你的字符串是“*火车 %d 正在离开城市 %d。* ”德国人最终会说“*从城市 3，火车 1 正在离开。* ”这是完全错误的。我们通过强制翻译保留相同的词序解决了这个问题，但我们最终得到了一些非常糟糕的德语。如果我再做一次，我会编写一个函数，将字符串和一个从零开始的值数组放入其中。然后我会使用 and 之类的标记`%0`，`%1`基本上将数组索引嵌入到字符串中。 ***更新：@Jonathan Leffler 指出符合 POSIX 的`printf()`支持使用`%2$s`类型标记，其中该`2$`部分指示`printf()`使用第二个附加参数填充该标记。这将非常方便，只要它足够快。自定义解决方案可能仍然更快，因此您需要确保并测试两者。***

2) 语言的长度差异很大。英文的 30 个字符有时会变成德文的 110 个字符。这意味着它通常不适合我们放置的屏幕。对于 PC/Mac 游戏来说，这可能不是一个问题，但是如果您正在做任何文本必须适合定义的框的工作，您将需要考虑这一点。为了解决这个问题，我们从文本中尽可能多地去除了其他语言的形容词。这缩短了句子，但保留了意思，如果失去了一点味道。后来我设计了一个我们可以使用的应用程序，它包含字体和框大小，并允许翻译人员进行自己的修改以使文本适合框。不确定他们是否曾经实施过。如果您遇到此问题，您也可以考虑使用滚动文本区域。

3) 就跨平台而言，我们为本地化系统编写了几乎纯 C++。我们编写了要加载的自定义编码二进制文件，以及将语言文本的 CSV 转换为`.h`带有枚举和文件到语言映射的自定义程序，以及`.lang`每种语言的 a。我们使用的最特定于平台的东西是字体和`printf()`功能，但是您将拥有适合您正在开发的任何地方的东西，或者如果需要也可以编写自己的东西。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-07-19T22:19:04.180

我强烈不同意接受的答案。首先，关于使用静态数组查找来加速文本查找的 [部分是适得其反的过早优化](https://stackoverflow.com/questions/385506/when-is-optimisation-premature/385529)- 计算所述文本的布局并渲染所述文本使用比哈希查找多 2-4 个数量级的时间。如果有人想实现自己的语言库，它永远不应该基于静态数组，因为这样做会以实际好处（翻译者不需要访问代码）换取想象中的好处（速度增加约 0.01%）。

接下来，[编写自己的语言库以在自己的游戏中使用](https://en.wikipedia.org/wiki/Not_invented_here)比过早优化更糟糕。[永远不要编写自己的本地化库](https://stackoverflow.com/questions/1236256/how-do-you-decide-whether-to-use-a-library-or-write-your-own-implementation)有一些非常好的理由：

1.  计划使用现有本地化库的时间比计划编写本地化库的时间要容易得多。本地化库存在，它们工作，并且许多人使用它们。

2.  本地化很棘手，所以你会弄错。每种语言都会增加一个新的怪癖，这意味着每当您向自己的本地化库添加新语言时，您都需要再次更改代码以解决这些怪癖。您是否知道某些语言有超过 2 种复数形式，具体取决于相关项目的数量？超过 2 个性别（甚至超过 10 个）？此外，许多语言中的数字和日期格式也有很大差异。

3.  当您的应用程序成功时，您将需要添加对更多语言的支持。语言 你的团队中没有人能说流利的语言。如果他们已经知道他们正在使用的工具，那么雇用某人编写翻译会**便宜得多。**

一个非常著名且完整的本地化库是[GNU Gettext](http://www.gnu.org/software/gettext/manual/gettext.html)，它使用 GPL，因此应避免用于商业工作。您可以改为使用与 Gettext 文件一起使用的 boost 库[boost.locale](http://www.boost.org/doc/libs/1_58_0/libs/locale/doc/html/messages_formatting.html)，并且可以免费使用和修改任何类型的商业和非商业项目。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-31T18:43:19.330

[GNU Gettext](http://www.gnu.org/software/gettext/manual/gettext.html)做到了这一切。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T19:04:12.813

据我所知，C++0x 标准中不会有任何附加功能。我怀疑委员会认为这是第三方图书馆的问题。

# cocoa-touch - 如何自定义 UITableViewCell 中的附件披露图像？

> ID：403748
> 
> 赞同：52
> 
> 时间：2008-12-31T18:40:35.013
> 
> 标签：cocoa-touch, uitableview

我想在我的 UITableView 中使用标准披露附件图像的自定义版本。我怎样才能做到这一点？我希望子类 UITableViewCell 对于这个基本的东西不是必需的。

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2008-12-31T19:01:33.050

您需要创建一个自定义视图并将其分配给对象的`accessoryView`属性`UITableViewCell`。就像是：

```
myCell.accessoryView = [[ UIImageView alloc ] 
                       initWithImage:[UIImage imageNamed:@"Something" ]]; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-08-20T04:55:54.780

```
- (UITableViewCell *)tableView:(UITableView *)tView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    UIImage *indicatorImage = [UIImage imageNamed:@"Arrow.png"];
    cell.accessoryView =[[[UIImageView alloc]  initWithImage:indicatorImage] autorelease];

    return cell;
} 
```

好吧，我使用上面给出的帮助代码来做到这一点

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-01-08T08:08:30.713

我遇到了与 Greg 相同的问题——附件视图不跟踪（如果您使用 UIImageView）

我是这样解决的：

```
UIImage * image = [ UIImage imageNamed:@"disclosure-button-grey.png" ] ;
UIControl * c = [ [ UIControl alloc ] initWithFrame:(CGRect){ CGPointZero, image.size } ] ;

c.layer.contents = (id)image.CGImage ;
[ c addTarget:self action:@selector( accessoryTapped: ) forControlEvents:UIControlEventTouchUpInside ] ;
cell.accessoryView = c ;
[ c release ] ; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-02T05:56:32.820

我会这样做：

```
UIImageView *chevronImgVw = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"chevron_accessory_vw_img.png"]];
chevronImgVw.frame = CGRectMake(cell.accessoryView.frame.origin.x, cell.accessoryView.frame.origin.y, 10, 20);
cell.accessoryView = chevronImgVw; 
```

请在投反对票之前尝试一下！因为目前它有 2 个赞成票和 2 个反对票！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-14T08:27:48.670

[Apple](https://developer.apple.com/library/ios/samplecode/Accessory/Introduction/Intro.html)提供了一个很好的示例，展示了如何使用`UIControl`来实现这种附件视图自定义。

`- (void)drawRect:(CGRect)rect`在 UIControl 中覆盖并不是最简单的方法，但它为您提供了很大的灵活性来设计漂亮的附件视图。

![在此处输入图像描述](https://i.stack.imgur.com/1xsNl.png)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-07-19T13:29:07.760

### 斯威夫特 4 和 5：

这对我有用：

```
class MyCell: UITableViewCell {

// boilerplate...

    fileprivate func commonInit() {
        // This is the button we want, just need to change the image.
        accessoryType = .detailButton
    }

    open override func layoutSubviews() {
        super.layoutSubviews()
        // Grab the "detail" button to change its icon. Functionality is set in the delegate.
        if let submitButton = allSubviews.compactMap({ $0 as? UIButton }).first {
            submitButton.setImage(#imageLiteral(resourceName: "icons8-enter-1"), for: .normal)
        }
    }

   // everything else...
} 
```

最重要的是，这让我可以使用[tableView(_:accessoryButtonTappedForRowWith:)](https://developer.apple.com/documentation/uikit/uitableviewdelegate/1614996-tableview#)来处理按钮操作。

我将它用于按钮，但相同的技术适用于显示图像，[因为/只要]在您要触摸的元素的层次结构树的该分支中只有一个类。

* * *

哦，对了，我的代码是这样的：

```
extension UIView {
    var allSubviews: [UIView] {
        return subviews.flatMap { [$0] + $0.allSubviews }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-28T02:43:30.697

在迅速 4 & 5

```
myCell.accessoryView = UIImageView(image: UIImage(named: "Something")) 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-02-13T16:44:50.960

注意：不要将自定义单元格设置为 tag:0。该标签是为 textLabel 视图保留的。如果您在 Xcode Storyboard 中**设置标签，则必须将自定义视图/标签的标签设置为 1 或更高。**

注意苹果的例子：

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath (NSIndexPath *)indexPath
{
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"MyIdentifier"];

    UILabel *label;

    label = (UILabel *)[cell viewWithTag:1];
    label.text = [NSString stringWithFormat:@"%d", indexPath.row];

    label = (UILabel *)[cell viewWithTag:2];
    label.text = [NSString stringWithFormat:@"%d", NUMBER_OF_ROWS - indexPath.row];

    return cell;
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-07-28T18:35:34.000

我尝试了上面的代码，但它似乎不再工作了，可能是由于这篇文章的年龄，所以我将放弃我的行，它给了我定制的附件视图。

```
[cell setAccessoryView:[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"arrowBtn"]]]; 
```

希望有人觉得这很有用。

# operating-system - 操作系统是如何“制造”的？

> ID：403754
> 
> 赞同：47
> 
> 时间：2008-12-31T18:43:42.993
> 
> 标签：operating-system, low-level, osdev

创建操作系统似乎是一个**庞大的**项目。怎么会有人开始呢？

**例如，当我将 Ubuntu 弹出到我的驱动器中时，我的计算机如何才能*运行*它？** （我想，这才是我真正想知道的。）

或者，从另一个角度来看，可以在磁盘上并且仍然作为操作系统“运行”的最少字节数是多少？

（如果这含糊不清，我很抱歉。我*对*这个主题一无所知，所以我不能很具体。我假装对计算机的工作原理有相当多的了解，但我对这个主题一无所知。 )

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-12-31T21:17:07.927

好吧，答案就在书中：**[现代操作系统](http://www.cs.vu.nl/~ast/books/mos2/)- Andrew S. Tanenbaum**是一个非常好的操作系统。下面的封面图。

最简单但完整的操作系统内核，适合学习或只是好奇，是**[Minix](http://en.wikipedia.org/wiki/MINIX)**。
[在这里](http://cvs.sourceforge.jp/cgi-bin/viewcvs.cgi/minixr/minix/)您可以浏览[源代码](http://cvs.sourceforge.jp/cgi-bin/viewcvs.cgi/minixr/minix/)。

[![现代操作系统](https://i.stack.imgur.com/dPJNI.jpg)](https://i.stack.imgur.com/dPJNI.jpg)
[（来源：[cs.vu.nl](http://www.cs.vu.nl/~ast/books/mos2/big_cover.jpg)）]

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-31T18:52:58.967

操作系统是一个巨大的话题，如果您想深入了解操作系统的设计和构建方式，我可以向您推荐最好的东西，这是一本好书：

![操作系统概念](https://i.stack.imgur.com/nTjMt.jpg)

[操作系统概念](http://www.os-book.com/)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-31T18:50:43.057

如果你真的很好奇，我会引导你[从 Scratch 到 Linux，](http://www.linuxfromscratch.org/)这是一个学习操作系统的完整细节以及所有部分如何组合在一起的好地方。如果这比您正在寻找的信息更多，那么[这篇](http://en.wikipedia.org/wiki/Operating_system)关于操作系统的维基百科文章可能是一个不错的起点。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-12-31T18:49:44.947

PC 知道要查看磁盘的特定扇区以获取启动指令。然后，这些指令将告诉处理器，在给定的处理器中断上，将调用特定的代码。例如，在周期性滴答声中，调用调度程序代码。当我从设备获取某些东西时，调用设备驱动程序代码。

现在操作系统如何设置系统的所有内容？那么硬件也有API。它们是在考虑系统程序员的情况下编写的。

我见过很多简单的操作系统，这确实是绝对核心。有许多嵌入式的本土操作系统，这就是他们所做的一切，仅此而已。

附加功能，例如要求应用程序向操作系统请求内存，或要求特定操作的特殊权限，甚至进程和线程本身，虽然在大多数 PC 架构上实现，但实际上都是可选的。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-12-31T19:03:18.897

简单地说，操作系统就是使您的软件能够管理硬件的东西。显然，有些操作系统比其他操作系统更复杂。

在其核心，计算机从固定地址开始执行，这意味着当计算机启动时，它将程序计数器设置为预定义的地址，然后开始执行机器代码。

在大多数计算机中，这种“引导”过程会立即初始化已知的外围设备（例如，磁盘驱动器）。初始化后，引导过程将使用一些预定义的序列来利用这些外围设备。再次使用磁盘驱动程序，该进程可能会从硬盘驱动器的第一个扇区读取代码，将其放置在 RAM 内的已知空间中，然后跳转到该地址。

这些预定义的顺序（CPU 的启动，磁盘的加载）允许程序员在 CPU 启动的早期阶段添加越来越多的代码，随着时间的推移，最终可以启动非常复杂的程序。

在现代世界中，由于具有复杂的外围设备、先进的 CPU 架构和大量的资源（GB 或 RAM、TB 的磁盘和非常快的 CPU），操作系统可以为开发人员支持非常强大的抽象（多进程、虚拟内存） ，可加载的驱动程序等）。

但是对于一个资源有限的简单系统，你并不需要太多的“操作系统”。

举个简单的例子，许多小型控制器计算机都有非常小的“操作系统”，有些可能只是被视为“监视器”，提供的只是对串行端口（或终端或 LCD 显示器）的轻松访问。当然，在这些条件下，对大型操作系统的需求并不多。

但也可以考虑类似经典的 Forth 系统。在这里，您有一个带有“OS”的系统，它为您提供磁盘 I/O、控制台 I/O、内存管理，以及实际的编程语言和一个汇编程序，这适合一个不到 8K 的内存8位机。

或者 CP/M 的 BIOS 和 BDOS 的旧时代。

CP/M 是一个很好的例子，说明简单的操作系统可以作为抽象层很好地工作，允许可移植程序在大量硬件上运行，但即便如此，系统启动和运行所需的 RAM 也不到 8K。

与现代操作系统使用的 MB 内存相去甚远。但是，公平地说，我们有 MB 的内存，因此我们的生活要简单得多（主要是），功能也多得多。

编写操作系统很有趣，因为让硬件打印“Hello World”一次将数据 1 字节推向某个模糊的 I/O 端口，或者将其填充到某个神奇的内存地址是很有趣的。

获得一个 x86 仿真器，然后聚会，让一个引导扇区说出你的名字。这是一种欢快的款待。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-31T20:24:09.733

基本上......您的计算机可以运行磁盘，因为：

BIOS 在引导顺序中包含该磁盘设备。

在启动时，BIOS 按顺序扫描所有可启动设备，例如软盘驱动器、硬盘驱动器和 CD ROM。每个设备访问其媒体并检查硬编码位置（通常是磁盘或 cd 设备上的扇区）是否有识别媒体的指纹，并列出要跳转到的磁盘（或媒体）上指令开始的位置。BIOS 告诉设备将其头部（或其他）移动到媒体上的指定位置，并读取大量指令。BIOS 将这些指令交给 CPU。

CPU 执行这些指令。在您的情况下，这些说明将启动 Ubuntu 操作系统。它们也可以是停止指令，或添加 10+20 等。

通常，操作系统会从占用大量内存开始（同样，直接从 CPU 获取，因为像“GlobalAlloc”等库命令不可用，因为它们是由尚未加载的操作系统提供的) 并开始为操作系统本身创建结构。

操作系统为应用程序提供了一系列“功能”：内存管理、文件系统、输入/输出、任务调度、网络、图形管理、打印机访问等。这就是在您“获得控制权”之前它正在做的事情：创建/启动所有服务，以便以后的应用程序可以一起运行，而不是相互占用内存，并为操作系统提供的服务提供一个很好的 API。

操作系统提供的每个“功能”都是一个大主题。操作系统提供了所有这些，因此应用程序只需要担心调用正确的操作系统库，并且操作系统可以管理两个程序同时尝试打印的情况。

例如，如果没有操作系统，每个应用程序都必须处理另一个程序正在尝试打印的情况，并且无论如何都要“做一些事情”，比如打印，或者取消另一个作业等。相反，只有操作系统必须处理它，应用程序只是对操作系统说“打印这些东西”，操作系统确保打印一个应用程序，而所有其他应用程序只需要等到第一个应用程序完成或用户取消它。

作为操作系统的最少字节数并没有真正意义，因为“操作系统”可能意味着许多或很少的功能。如果您只想从 CD 执行程序，那将是非常少的字节。但是，这不是操作系统。操作系统的工作是提供服务（我一直称它们为功能）以允许许多其他程序运行，并管理程序对这些服务的访问。这很难，而且您添加的共享资源（网络、wifi、CD 刻录机、操纵杆、iSight 视频和双显示器等）越多，就越难。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-31T18:52:37.157

[http://en.wikipedia.org/wiki/Linux_startup_process](http://en.wikipedia.org/wiki/Linux_startup_process)你可能正在寻找这个。 [http://en.wikipedia.org/wiki/Windows_NT_startup_process](http://en.wikipedia.org/wiki/Windows_NT_startup_process)或这个。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-31T18:57:56.163

我见过的最近有一个得到大力支持的操作系统项目是一个名为[Singularity](http://en.wikipedia.org/wiki/Singularity_(operating_system))的 MS Research 项目，它完全是用 C#.NET 从头开始​​编写的。

为了了解这需要多少工作，有 2 名核心开发人员，但他们在任何时候都有多达 12 名实习生，而且他们仍然需要两年时间才能让操作系统达到可以启动和运行的地步显示 BMP 图像（这是他们用来进行演示的方式）。他们甚至需要做更多的工作才能达到有命令行的程度（大约 4 年）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-31T18:46:18.370

*基本上，关于操作系统实际上是*什么存在许多争论。如果你让每个人都同意操作系统具体是什么（它只是内核吗？所有在内核模式下运行的东西？是操作系统的外壳部分吗？是操作系统的 X 部分吗？Web 浏览器是操作系统的一部分吗？），你的问题已回答！否则，您的问题没有具体的答案。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-31T18:52:33.740

哦，这很有趣。我曾经在某一时刻完成了整件事，并且经历了大部分的演变。

通常，您从小处着手编写新的操作系统。最简单的是引导加载程序，它是一小段代码，可以将一大段代码拉入并运行它。曾几何时，使用 Nova 或 PDP 计算机，您可以通过前面板进入引导加载程序：您通过十六进制数字输入指令十六进制数字。引导加载程序将一些介质读入内存，并将程序计数器设置为该代码的起始地址。

那段代码通常会加载其他内容，但它不是必须的：您可以编写一个旨在在裸机上运行的程序。这种程序本身就可以做一些有用的事情。

一个真正的操作系统更大，并且有更多的部分。您需要加载程序，将它们放入内存并运行它们；您需要提供代码来运行 IO 设备；随着它变大，您需要管理内存。

如果您想真正了解它的工作原理，请查找[Doug Comer 的 Xinu 书籍](http://www.cs.purdue.edu/homes/comer/osbooks.html)，以及 Andy [Tannenbaum的关于](http://www.cs.vu.nl/~ast/)[Minix](http://www.minix3.org/)的最新操作系统书籍。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-31T19:19:14.437

您可能想要获取*FreeBSD 操作系统的设计和实现*一书以获得非常详细的答案。你可以从 Amazon 或者这个指向 FreeBSD.org 网站的链接在我记忆中看起来像这本书：[link text](http://www.freebsd.org/doc/en/books/design-44bsd/)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-31T19:53:09.377

尝试[使用同一博客](http://duartes.org/gustavo/blog/)中的[计算机如何启动](http://duartes.org/gustavo/blog/post/how-computers-boot-up)、[内核启动过程](http://duartes.org/gustavo/blog/post/kernel-boot-process)和其他相关文章，*简要了解*计算机启动时的功能。

 *当计算机的启动严重依赖（可能很明显？）[CPU 设计](http://en.wikipedia.org/wiki/CPU_design)和其他“低级东西”时，计算机会做什么；因此，很难预测*您的*计算机在启动时会做什么。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-01T09:26:12.790

我不敢相信这没有被提及...但是操作系统设计概述的经典书籍是由 MINIX 的创建者 Andrew S Tanenbaum 撰写的[操作系统 - 设计和实现。](https://rads.stackoverflow.com/amzn/click/com/0131429388)书中的许多示例也直接针对 MINIX。

如果您想了解更多信息，[OS Dev](http://www.osdev.org/)是一个很好的起点。尤其是维基。该站点充满了信息以及为小型项目/爱好编写个人操作系统的开发人员。这也是一个很好的学习资源，因为在 OSDev 上有很多人和你一样想了解操作系统的内容。您最终也可能最终自己尝试一下！

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-31T18:51:02.650

操作系统 (OS) 是控制硬件的软件层。硬件越简单，操作系统就越简单，反之亦然；-)

如果是早期的微型计算机，您可以将操作系统装入 16K ROM 并硬连线主板以在 ROM 地址空间的开头开始执行机器代码指令。然后，此“引导”过程将加载其他设备（如键盘、显示器、软盘驱动器等）的驱动程序代码，并在几秒钟内启动您的机器并准备好使用。

如今......同样的原则，但越来越复杂的硬件;-)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-31T18:52:04.273

好吧，您有一些东西将芯片的启动链接到“bios”，然后链接到操作系统，这通常是由许多代码服务完成的非常复杂的任务。

如果您真的想了解更多关于此的信息，我建议您阅读一本书...关于微控制器，尤其是您在 c 中为 8051 等创建一个小型操作系统的书。或者学习一些 x86 程序集并创建一个非常小的“引导加载程序操作系统”。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-31T19:33:29.977

你可能想看看[这个问题](https://stackoverflow.com/questions/254149/how-do-you-write-a-basic-operating-system)。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-31T20:28:39.273

操作系统是一个程序，就像您编写的任何其他应用程序一样。该程序的主要目的是它允许您运行其他程序。现代操作系统利用现代硬件来确保程序不会相互冲突。

如果您有兴趣编写自己的操作系统，请在此处查看我自己的问题：

[如何开始操作系统开发](https://stackoverflow.com/questions/43180/how-to-get-started-in-operating-system-development)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-31T22:54:50.507

你问**你可以在磁盘上放多少字节并且仍然作为操作系统运行**？答案取决于您对操作系统的期望，但我所知道的最小的*有用操作系统适合 1.7 兆字节。*它是[Tom 的 Root 引导盘，如果带有“救援”应用程序的小型操作系统可以](http://www.toms.net/rb/)**放在一张软盘上**，它是非常好的。早在每台机器都有软盘驱动器而不是每台机器都有 CD-ROM 驱动器的时代，我曾经经常使用它。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-01T03:56:24.110

我的看法是，它就像你自己的生活。起初，你知道的很少——仅仅够相处。这类似于 BIOS 提供的内容——它知道的足够多，可以查找磁盘驱动器并从中读取信息。当你上小学时，你会学到更多东西。这就像将引导扇区读入内存并获得控制权。然后你上高中，这就像操作系统内核加载。然后你去上大学（司机和其他申请） **。当然，这是你容易崩溃的地方。** 呵呵。

底线是越来越多的能力层被慢慢加载。操作系统没有什么神奇之处。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-01-01T09:17:43.073

通读这里将使您了解创建 Linux [https://netfiles.uiuc.edu/rhasan/linux/需要什么](https://netfiles.uiuc.edu/rhasan/linux/)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-03-18T19:19:55.673

另一个可以放在一个磁盘上的非常小的操作系统是 QNX（当我很久以前最后一次看到它时，整个操作系统，带有 GUI 界面、Web 浏览器、磁盘访问和一个内置的 Web 服务器，都可以放在一个软盘驱动器上） .

从那以后我就没有听到太多关于它的消息，但它是一个实时操作系统，所以它的设计速度非常快。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-10-08T15:02:11.133

实际上，有些人访问一所四年制大学是为了对此有一个粗略的了解。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2014-05-02T17:55:04.800

操作系统的核心是非常简单。以下是成功操作系统应该做什么的初学者指南： 1\. 使用调度程序管理 CPU，调度程序决定要调度哪个进程（程序的运行实例）。2\. 管理内存以决定哪些进程使用它来存储指令（代码）和数据（变量）。3、管理磁盘驱动器、报警器、键盘、鼠标等I/O接口。现在，以上 3 个要求引起了进程需要进行通信（而不是打架！），与外部世界交互，帮助应用程序做他们想做的事情。要深入了解它是如何做到的，请阅读《恐龙》一书：）

因此，只要您设法处理所有硬件资源，您就可以将操作系统做得尽可能小。当您启动时，BIOS 告诉 CPU 开始读取引导加载程序（它加载驻留在内存中固定地址的 OS 的第一个函数——类似于小型 C 程序的 main()）。然后这会创建函数、进程和线程并开始大爆炸！

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-12-15T16:23:16.190

首先，阅读阅读和阅读，什么是操作系统；那么不同操作系统的用途/类型/性质/目标/需求/是什么。部分链接如下；新手会喜欢这些链接：

[现代操作系统](http://materias.fi.uba.ar/7508/MOS4/Operating.Systems.4th.Edi.pdf)- 这给出了关于通用操作系统的想法。

[操作系统的开始](https://web.archive.org/web/20120506110242/http://osix.net/modules/article/?id=359)- 这提供了 MAKE OS 真正需要的基础知识，我们如何制作它以及如何自己修改现有的 OS 开源代码。

[Wiki OS](http://wiki.osdev.org/Main_Page) - 提供关于不同领域中使用的不同操作系统及其用途的想法（操作系统的对象/功能。）

让我们大致了解一下操作系统包含的内容*（不是复杂的Linux 或 Windows）*

操作系统需要一个 CPU，并且要在其中转储代码，您需要一个`bootloader`. 操作系统必须具有要实现的目标，并且这些目标必须在称为`Kernel` 内部的包装器中定义，您可以拥有`scheduling time`并且`ISR's` *（取决于您需要制作的目标和操作系统）*

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-03-13T11:51:06.210

操作系统开发很复杂。有一些网站，如 osdev 或 lowlevel.eu（德语）专门讨论该主题。还有一些书，其他人已经提到过。

我忍不住还要参考 youtube 上的“编写你自己的操作系统”视频系列，因为我是制作它的人 :-)

见[https://www.youtube.com/playlist?list=PLHh55M_Kq4OApWScZyPl5HhgsTJS9MZ6M](https://www.youtube.com/playlist?list=PLHh55M_Kq4OApWScZyPl5HhgsTJS9MZ6M)

# php - 使用构造函数的好处？

> ID：403756
> 
> 赞同：6
> 
> 时间：2008-12-31T18:44:04.023
> 
> 标签：php, oop, constructor

在我试图了解更多关于 PHP 中的 OOP 的过程中。我已经多次遇到构造函数，根本无法再忽略它。在我的理解中，构造函数在我创建对象的那一刻被调用，这是正确的吗？

但是，如果我可以使用“普通”函数或方法作为它们的调用，我为什么需要创建这个构造函数呢？

干杯，基思

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-12-31T18:56:00.503

构造函数允许您确保在尝试使用对象之前将其置于特定状态。例如，如果您的对象具有使用它所需的某些属性，您可以在构造函数中初始化它们。此外，构造函数允许一种有效的方式来初始化对象。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-31T18:47:59.367

是的，在创建对象时调用构造函数。

构造函数有用的一个小例子是这个

```
class Bar
{
    // The variable we will be using within our class
    var $val;

    // This function is called when someone does $foo = new Bar();
    // But this constructor has also an $var within its definition,
    // So you have to do $foo = new Bar("some data")
    function __construct($var)
    {
        // Assign's the $var from the constructor to the $val variable 
        // we defined above
        $this->val = $var
    }
}

$foo = new Bar("baz");

echo $foo->val // baz

// You can also do this to see everything defined within the class
print_r($foo); 
```

更新：一个问题还问为什么应该使用它，一个真实的例子是一个数据库类，你用用户名和密码以及要连接的表调用对象，构造函数将连接到该对象。然后，您就拥有了在该数据库中完成所有工作的功能。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-12-28T02:58:20.507

构造函数的思想是为对象准备最初的一堆数据，这样它就可以按预期运行。

`Just call a method`不是交易，因为您可能会忘记这样做，并且不能在语法中将其指定为“工作前必需”-因此您将获得“损坏”对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-12-28T02:58:41.927

构造函数适用于各种各样的事情。他们在你的类中初始化变量。假设您正在创建一个 BankAccount 类。$b = 新银行账户（60）；有一个构造函数，它给银行账户一个初始值。他们基本上在类中设置变量，或者他们也可以初始化其他类（继承）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-28T02:58:59.053

构造函数用于在创建对象时进行初始化。

您不希望在新创建的对象上调用任意方法，因为这违背了封装的想法，并且需要使用该对象的代码对其内部工作有固有的了解（并且需要更多的努力）。

# user-interface - 尝试将 ToolStrip 与现有 ToolStrip 并排添加到 ToolStripPanel

> ID：403769
> 
> 赞同：5
> 
> 时间：2008-12-31T18:49:11.297
> 
> 标签：user-interface, visual-studio-2005, .net-2.0, toolstrip, toolstrippanel

我将 .net 2.0 与 Visual Studio 2005 一起使用，我试图在表单顶部添加两个不同的工具条，以便它们并排显示。我希望它像 Word 2003 一样，您可以在其中将多个工具条添加到同一行并让它们彼此对齐显示，而不是为每个工具条指定一行。

所以我添加了一个 ToolStripPanel 并将其停靠在表单的顶部（我没有使用 ToolStripContainer，因为我不需要所有额外的面板；我只需要顶部的那个）。我添加了两个工具条并将它们的 Stretch 属性设置为 False。我可以让它们并排显示在设计器窗口中，但在运行时 ToolStripPanel 将工具条分开并为每个工具条提供自己的专用行。仿佛雪上加霜，当我停止调试并返回给设计师时，我发现设计师也在将工具条移动到他们自己的行！我在这里做错了吗？

我整天都在谷歌搜索，发现了一些关于 ToolStripPanelRow 对象的信息，但我没有看到一种简单的方法来向它添加工具条（即它没有 ToolStripPanelRow.Controls.Add 方法或类似的方法），所有它有一个 Controls() 属性，它返回一个控件对象数组，我没有太多运气尝试将项目添加到该数组中。我还找到了一些关于 ToolStripPanel.Join 方法的文档，听起来它应该可以完成这项工作，所以我尝试了所有 3 个重载，但它们并没有像宣传的那样工作。无论我做什么或尝试哪个选项，它总是将新工具条添加到面板顶部的单独行，并将其他所有内容向下推。

为了全面披露，我应该警告您，我已将 ToolStripPanel 和其中一个工具条添加到基类表单中，并且我正在尝试将另一个工具条添加到从基类表单继承的子类表单中。基类表单中的 ToolStripPanel 和 ToolStrip 都被声明为“受保护的朋友”，所以这应该可以工作。正如我所提到的，子类表单的设计器窗口将允许我这样做（至少有一段时间）。

如果有人可以帮助我完成这项工作，或者至少说明为什么不这样做，我将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T16:36:55.550

我创建了一个自定义 ToolStripPanel，以便我可以重载 LayoutEngine；

```
using System.Drawing;
using System.Windows.Forms;
using System.Windows.Forms.Layout;

namespace CustomGUI
{
  class CustomToolStripPanel : ToolStripPanel
  {
    private LayoutEngine _layoutEngine;

    public override LayoutEngine LayoutEngine
    {
      get
      {
        if (_layoutEngine == null) _layoutEngine = new CustomLayoutEngine();
        return _layoutEngine;
      }
    }

    public override Size GetPreferredSize(Size proposedSize)
    {
      Size size = base.GetPreferredSize(proposedSize);

      foreach(Control control in Controls)
      {
        int newHeight = control.Height + control.Margin.Vertical + Padding.Vertical;
        if (newHeight > size.Height) size.Height = newHeight;
      }

      return size;
    }
  }
} 
```

然后自定义 LayoutEngine 对 ToolStrips 进行布局；

```
using System.Drawing;
using System.Windows.Forms;
using System.Windows.Forms.Layout;

namespace CustomGUI
{
  class CustomLayoutEngine : LayoutEngine
  {
    public override bool Layout(object container, LayoutEventArgs layoutEventArgs)
    {
      Control parent = container as Control;

      Rectangle parentDisplayRectangle = parent.DisplayRectangle;

      Control [] source = new Control[parent.Controls.Count];
      parent.Controls.CopyTo(source, 0);

      Point nextControlLocation = parentDisplayRectangle.Location;

      foreach (Control c in source)
      {
        if (!c.Visible) continue;

        nextControlLocation.Offset(c.Margin.Left, c.Margin.Top);
        c.Location = nextControlLocation;

        if (c.AutoSize)
        {
          c.Size = c.GetPreferredSize(parentDisplayRectangle.Size);
        }

        nextControlLocation.Y = parentDisplayRectangle.Y;
        nextControlLocation.X += c.Width + c.Margin.Right + parent.Padding.Horizontal;
      }

      return false;
    }
  }
} 
```

需要一段时间的一件事是更改一个 ToolStrip 项目的位置/大小将导致布局重新触发，控件重新排序。所以我在布局循环之前复制了一个控件。由于某种原因，您不能使用 AddRange(...) 将项目添加到自定义面板 - 需要一次添加（...）它们。

希望有帮助（它基于[MSDN LayoutEngine Example](http://msdn.microsoft.com/en-us/library/system.windows.forms.layout.layoutengine.aspx "MSDN")，为 ToolStripPanels 修复）

维兹芬

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-26T06:35:23.713

System.Windows.Forms.FlowLayoutPanel 可以完成这项工作。

只需按照正确的顺序将 ToolStrip 控件放入其中即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T15:14:49.127

我认为在您的情况下，您只需将 ToolStrip 上的 LayoutStyle 设置为 ToolStripLayoutStyle.Horizo​​ntalStackWithOverflow，而不需要您自己的自定义 LayoutEngine。

我问了一个关于如何处理带有动态项目的布局以更好地控制溢出的类似主题的[不同问题。](https://stackoverflow.com/questions/604713/change-toolstrippanel-overflow-behavior-for-dynamically-added-toolstripitems)

# python - Python 中的优化——注意事项和经验法则

> ID：403794
> 
> 赞同：8
> 
> 时间：2008-12-31T18:57:59.860
> 
> 标签：python, optimization

好吧，我正在阅读这篇[文章](http://handyfloss.wordpress.com/2008/02/17/summary-of-my-python-optimization-adventures/)，然后我遇到了一个代码：

```
jokes=range(1000000)
domain=[(0,(len(jokes)*2)-i-1) for i in range(0,len(jokes)*2)] 
```

我认为在列表理解之外计算 len(jokes) 的值不是更好吗？

好吧，我尝试了并计时了三个代码

```
jv@Pioneer:~$ python -m timeit -s 'jokes=range(1000000);domain=[(0,(len(jokes)*2)-i-1) for i in range(0,len(jokes)*2)]'
10000000 loops, best of 3: 0.0352 usec per loop
jv@Pioneer:~$ python -m timeit -s 'jokes=range(1000000);l=len(jokes);domain=[(0,(l*2)-i-1) for i in range(0,l*2)]'
10000000 loops, best of 3: 0.0343 usec per loop
jv@Pioneer:~$ python -m timeit -s 'jokes=range(1000000);l=len(jokes)*2;domain=[(0,l-i-1) for i in range(0,l)]'
10000000 loops, best of 3: 0.0333 usec per loop 
```

观察到第一个和第二个之间 2.55% 的边际差异让我想到 - 是第一个列表理解

```
domain=[(0,(len(jokes)*2)-i-1) for i in range(0,len(jokes)*2)] 
```

由python内部优化？还是 2.55% 是一个足够大的优化（假设 len(jokes)=1000000）？

如果这是 - Python 中的其他隐式/内部优化是什么？

是什么`developer's rules of thumb for optimization in Python`？

**Edit1**：由于大多数答案都是“不要优化，如果它很慢，请稍后再做”，我从do's`Triptych`和`Ali A`for the **do's**获得了一些提示和链接。我会稍微改变一下问题并要求**不要**。

**我们能否从面临“缓慢**”的人那里获得一些经验，问题是什么以及如何纠正？

**Edit2**：对于那些还没有在这里的人来说，这是一个[有趣的阅读](http://www.python.org/doc/essays/list2str/)

**Edit3：**有问题的使用不正确，`timeit`请参阅**dF 的**正确使用答案以及三个代码的时间。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-31T19:13:19.423

您使用不[`timeit`](http://docs.python.org/library/timeit.html)正确：`-s`(setup) 的参数是最初要执行一次的语句，因此您实际上只是在测试一个空语句。你想做

```
$ python -m timeit -s "jokes=range(1000000)" "domain=[(0,(len(jokes)*2)-i-1) for i in range(0, len(jokes)*2)]"
10 loops, best of 3: 1.08 sec per loop
$ python -m timeit -s "jokes=range(1000000)" "l=len(jokes);domain=[(0,(l*2)-i-1) for i in range(0, l*2)]"
10 loops, best of 3: 908 msec per loop
$ python -m timeit -s "jokes=range(1000000)" "l=len(jokes*2);domain=[(0,l-i-1) for i in range(0, l)]"
10 loops, best of 3: 813 msec per loop 
```

虽然加速仍然不显着，但更为显着（分别为 16% 和 25%）。因此，由于它不会使代码变得更复杂，因此这种简单的优化可能是值得的。

为了解决实际问题...... Python 中通常的经验法则是

1.  编码时喜欢直接和可读的代码而不是优化。

2.  分析您的代码（[`profile / cProfile`并且`pstats`](http://docs.python.org/library/profile.html)是您的朋友）以找出您需要优化的内容（通常是紧密循环之类的东西）。

3.  作为最后的手段，将这些重新实现为 C 扩展，使用[pyrex](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/)和[cython](http://www.cython.org/)等工具会更容易。

需要注意的一件事：与许多其他语言相比，Python 中的函数调用相对昂贵，这就是为什么您的示例中的优化会产生影响，即使`len`列表的 O(1) 也是如此。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-31T19:05:40.033

阅读本文：[Python 速度/性能提示](http://wiki.python.org/moin/PythonSpeed/PerformanceTips)

此外，在您的示例中，总时间非常短，以至于误差幅度将超过任何实际的速度差异。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-31T19:18:08.370

这适用于所有编程，而不仅仅是 Python：

1.  轮廓
2.  识别瓶颈
3.  优化

而且我什至会补充说，除非您遇到导致您疼痛的缓慢问题，否则不要费心去做任何事情。

也许最重要的是单元测试将在实际过程中为您提供帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T19:03:40.253

在切线相关的注释中，将生成器链接在一起比将列表推导链接在一起更有效，而且通常更直观。

至于开发人员在 Python 中优化的经验法则，它们与所有语言中的相同。

1.  不要优化。
2.  （高级）稍后优化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T19:05:23.153

列表的 len 是 O(1)。它不需要扫描整个列表来查找长度，因为列表的大小是为查找而存储的。但显然，将其提取到局部变量中仍然稍微快一些。

不过，要回答您的问题，我永远不会关心大约 5% 的性能变化，除非我在某些模拟或其他东西中进行了一些疯狂的紧密内部循环优化。在这种情况下，您可以通过完全不使用范围来加快速度。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-31T19:22:57.283

最重要的是编写惯用的、清晰的、漂亮的 Python 代码。许多常见任务已经在 stdlib 中找到，因此您不必重写较慢的版本。（我在这里专门考虑字符串方法和 itertools。）也可以自由使用 Python 的内置容器。例如 dict 已经“优化了鼻涕”，据说使用 dicts 的 Python 代码将比普通 C 更快！

如果这还不够快，您可以使用一些技巧，但这也表明您可能应该将一些工作卸载到 C 扩展模块。

关于列表推导：CPython 能够对常规累加器循环进行一些优化。即 LIST_APPEND 操作码使附加到列表本机操作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-05-07T22:18:16.467

我有一个解析日志文件并生成数据仓库的程序。典型的运行涉及大约 200M 的日志文件行，并且运行一天的大部分时间。非常值得优化！

因为它是一个解析器，并且解析一些相当多变、特殊和不可信的文本，所以大约有 100 个正则表达式，预先尽职尽责地 re.compiled()，并应用于 200M 日志文件行中的每一行。我很确定他们是我的瓶颈，并且一直在思考如何改善这种情况。有一些想法：一方面，做更少，更高级的RE；另一方面，更多更简单；类似的东西。

我使用 CProfile 进行了分析，并在“runsnake”中查看了结果。

RE 处理仅占代码执行时间的 10% 左右。不是这个！

事实上，runnake 显示屏上的一个大方形斑点立即告诉我，我大约 60% 的时间都花在了我一天添加的那些臭名昭著的“一行更改”中，消除了非打印字符（偶尔出现，但总是代表一些如此虚假的东西，我真的不在乎）。这些使我的解析感到困惑并抛出异常，我*确实*关心这些，因为它停止了我一天的日志文件分析。

> line = ''.join([c for c in line if curses.ascii.isprint(c) ])

你去吧：那条线触及这 200M 行中的每一行的每个**字节**（这些行平均有几百个字节长）。难怪这是我执行时间的 60%！

我现在知道有更好的方法来处理这个问题，比如 str.translate()。但是这样的行很少见，无论如何我都不关心它们，它们最终会抛出异常：现在我只是在正确的位置捕获异常并跳过该行。瞧！该程序的速度提高了大约 3 倍，瞬间！

所以剖析

1.  在大约一秒钟内突出显示问题实际出在哪里
2.  把我的注意力从关于问题出在哪里的错误假设上转移开（这可能是更大的回报）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-31T20:52:32.703

> 我们能否从面临“缓慢”的人那里获得一些经验，问题是什么以及如何纠正？

问题是 GUI 应用程序中的数据检索缓慢。通过向表中添加索引，我获得了 50 倍的加速，并被广泛誉为英雄和救世主。

# ruby-on-rails - 如何查找不属于字母表的项目

> ID：403798
> 
> 赞同：1
> 
> 时间：2008-12-31T19:02:40.147
> 
> 标签：ruby-on-rails

在我看来，我有一个基于字母的选择器，可以通过名称的第一个字母来选择制造商。我得到了那个部分的工作。但是我有名称以数字开头的制造商，例如 3M 或 3DLabs。在视图中，我有字符“#”来对所有这些进行分组。我的查询/查找方法应该如何检索所有不以字母开头的名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T19:08:29.230

您可能想使用正则表达式。

您使用什么语言？

下面是SQL2005版本：

```
select *
from myTable
where myField like '[^a-z]%' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T19:38:21.433

我想我明白了

SELECT * FROM `manufacturers`WHERE (name REGEXP '^[0-9]') 按名称排序

# php - 从“干净”和“脏”网址获取数据的最佳方式

> ID：403815
> 
> 赞同：1
> 
> 时间：2008-12-31T19:08:55.017
> 
> 标签：php

我正在编写一个从 URL 获取数据的应用程序，但我想让它成为用户是否使用“干净” URL（例如：[http](http://example.com/hello/world) ://example.com/hello/world ）或“脏” URL的选项（例如：[http](http://example.com/?action=hello&sub=world) ://example.com/?action=hello&sub=world ）。

从两个 URL 方案中获取变量的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T19:29:26.147

如果您的 mod_rewrite 有如下规则：

```
RewriteRule ^hello/world /?action=hello&sub=world [NC,L] 
```

或者，更概括地说：

```
// Assuming only lowercase letters in action & sub..
RewriteRule ^([a-z]+)/([a-z]+) /?action=$1&sub=$2 [NC,L] 
```

然后调用相同的 PHP 脚本，`$_REQUEST`无论用户以何种方式访问​​页面（脏或干净的 url），变量都可用。

我们最近将网站的很大一部分移动到了清理 url（仍然支持旧的、“脏”的 url）和上面的规则意味着我们不必重写任何依赖`$_REQUEST`参数的代码，只需要重写 mod_rewrite 规则。

**更新**

Mod_rewrite 是一个 Apache 模块，但也有许多[可用于 IIS](http://en.wikipedia.org/wiki/Rewrite_engine#IIS)的选项。

无论您决定支持哪种 Web 服务器，mod_rewrite 方法都可能为您带来最少的工作量。没有它，您可能必须创建大量文件来模拟干净 url 的结构，例如，在您的网络服务器根目录中，您将创建一个目录`hello`，将文件`world`放入其中，其中包含如下内容：

```
// Set the $_REQUEST params to mimic dirty url
$_REQUEST['action'] = 'hello';
$_REQUEST['sub'] = 'world';
// Include existing file so we don't need to re-do our logic
// (assuming index.php at web root)
include('../index.php'); 
```

随着您希望“干净”处理的参数数量的增加，您需要的目录和存根文件的数量也会增加，这将大大增加您的维护负担。

mod_rewrite 正是为这类问题而设计的，现在 IIS 和 Apache 都支持它，所以我强烈建议朝这个方向发展！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T19:31:26.253

如果您的应用程序在 Apache 服务器中运行，我建议使用 mod_rewrite。

基本上，您编写应用程序以在内部使用“脏”URL。我的意思是您仍然可以在模板等中使用“干净”的 URL，但在解析 URL 时使用“脏”版本。就像，你是真实的，“脏”的 URL 是 www.domain.com/index.php?a=1&b=2，在你的代码中你仍然要使用 $_GET['a'] 和 $_GET[' b']。然后，借助 mod_rewrite 的强大功能，只需将 www.domain.com/1/2/ 之类的 URL 指向“脏” URL。（这只是如何做事的一个例子）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T19:15:02.620

听起来很痛苦，但我想创建一个分析每个请求的 URL 的函数。首先确定它是“脏”还是“干净”的 URL。为此，我会首先寻找问号字符的存在并从那里开始（显然需要额外的检查）。对于“脏” URL，使用 PHP 的常规 Get 方法检索功能 ($variable_name)。对于“干净”的，我会使用正则表达式。这将是解析 URL 和提取潜在变量的最灵活（和有效）的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T19:31:30.400

一种快速而肮脏的方法可能是简单地检查 GET 变量。有的话就是脏的，没有的话就是干净的。当然，这取决于脏 URL 的确切含义。

# cocoa-touch - 如何自定义 UITableViewCell 中标准标签的背景颜色？

> ID：403820
> 
> 赞同：0
> 
> 时间：2008-12-31T19:11:44.653
> 
> 标签：cocoa-touch

在过去的几个小时里，我一直在尝试弄清楚如何做到这一点，但没有运气。搜索 Google 时有几种潜在的解决方案，但似乎没有任何效果。

我正在尝试自定义 UITableViewCell 中标准 UILabel 的背景颜色（因为我已经自定义了单元格本身的背景颜色），但我所做的一切似乎都不起作用。

我正在创建自己的 UILabel 来自定义 -tableView:cellForRowAtIndexPath 中的颜色：

```
UILabel* label = [[[UILabel alloc] init] autorelease];
label.textColor = [UIColor blueColor];
label.backgroundColor = [UIColor redColor];
label.opaque = YES;
[cell.contentView addSubview:label];
cell.text = @"Sample text here"; 
```

但这不起作用，生成的表格视图仍然有一堆单元格，其中包含带有黑色文本和白色背景的标签。

关于我在这里做错了什么的任何线索？

更新：如果我尝试执行以下操作：

```
UILabel* label = [[[UILabel alloc] init] autorelease];
label.textColor = [UIColor blueColor];
label.backgroundColor = [UIColor redColor];
label.opaque = YES;
[cell.contentView addSubview:label];
label.text = @"Sample text here"; 
```

我得到一堆没有文字的 UITableViewCells。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T19:17:11.350

您似乎将文本分配给单元格而不是标签。你可能想要：

```
label.text = @"Sample text here"; 
```

此外，您需要将标签的框架设置为您需要的内容：

```
label.frame = CGRectMake(10,10, 80, 40); 
```

或直接在构造函数中：

```
label = [[UILabel alloc] initWithFrame:myFrame]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T19:23:40.793

我不会在代码中这样做。我会用一个自定义的 XIB 文件来做，然后把它加载到你的

```
- (UITableViewCell *)tableView:(UITableView *)tv cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

委托功能。这样您就可以根据您的确切规格设计 XIB 文件，并对其进行调整。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T21:02:56.677

您以前曾问过这个问题，并得到了正确的答案；

[如何自定义 UITableViewCell 的背景颜色？](https://stackoverflow.com/questions/281515/how-to-customize-the-background-color-of-a-uitableviewcell)

# python - 从python中的父文件调用

> ID：403822
> 
> 赞同：3
> 
> 时间：2008-12-31T19:14:59.733
> 
> 标签：python

我有一个名为 main.py 的文件和一个名为 classes.py 的文件

main.py 包含应用程序和正在发生的事情，而 class.py 包含一些类。

main.py 有以下代码

**主文件**

```
import classes

def addItem(text):
    print text

myClass = classes.ExampleClass() 
```

然后我们有 classes.py

**类.py**

```
class ExampleClass (object):
    def __init__(self):
        addItem('bob') 
```

令人惊讶的是，这不是我正在使用的实际代码，因为我已经删除了任何会妨碍你看到我想做的事情的东西。我希望能够从 classes.py 中的类调用 main.py 中定义的方法。我该怎么做呢？

提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-31T19:20:03.030

我无法比[Alex Martelli 的这篇文章](http://mail.python.org/pipermail/python-list/2000-December/059926.html)更好地回答这个问题。基本上你尝试这样做的任何方式都会导致麻烦，你最好重构代码以避免两个模块之间的相互依赖......

如果您有两个相互依赖的模块 A 和 B，最简单的方法是将它们都依赖的部分代码隔离到第三个模块 C 中，并让它们都导入 C。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T19:38:23.010

重构的建议是好的。如果您必须保留文件原样，则可以编辑 main.py 以确保仅通过导入文件不执行任何操作，然后在需要它的函数中导入 main：

```
class ExampleClass (object):
    def __init__(self):
        import main
        main.addItem('bob') 
```

这避免了循环导入，但不如一开始的重构那么好......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T19:22:40.823

我建议将常用函数放在 classes.py 中，或者可能更好地放在第三个模块中，也许是 utils.py。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T19:26:31.630

你所有的可执行代码都应该在一个`if __name__ == "__main__"`. 这将防止它在作为模块导入时被执行。在 main.py

```
if __name__=="__main__":
    myClass = classes.ExampleClass() 
```

然而，正如 dF 所说，在这个阶段进行重构可能比尝试解决循环依赖关系更好。

# java - 为简单的 Java Web 应用程序使用框架是否有意义？

> ID：403825
> 
> 赞同：9
> 
> 时间：2008-12-31T19:15:50.260
> 
> 标签：java, jsp, servlets, frameworks, web-applications

我已经使用 jsps 和 servlet 进行了大量的 Java Web 开发，我发现这种方法简单而灵活。但是，其中涉及的一些基础工作（例如管理数据库连接）相当乏味，而且仅仅为了启动一个新的 Web 应用程序就需要大量的工作。

因此，我第一次考虑使用框架，但我对框架的印象是它们主要用于大型 J2EE 应用程序并且涉及很多复杂的配置。我正在寻找的是一些简单的东西（在最初的学习曲线之后）将使我能够尽快启动并运行一个新的网络应用程序。

所以我的问题是 - 为简单的 Java Web 应用程序使用框架是否有意义？

[请注意，我不是在问要使用哪个框架（如果确实推荐了一个框架），因为这里](https://stackoverflow.com/questions/116978/can-anyone-recommend-a-simple-java-web-app-framework)已经问过了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-01T20:29:49.393

如果你不使用 web 框架，你通常会写一个——很糟糕。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-31T19:33:46.887

是的，出于以下原因，我会使用 Web 框架：

1.  增加导航功能和控制。即使您可能不需要它们，但如果您在任何时候需要它们，它们就在那里供您使用
2.  正如其他人所指出的那样，应用程序会随着时间的推移而增长，并且您会在未来的某个时间点感觉到对框架的需求。当您需要添加其他页面和导航时
3.  允许您插入其他框架的功能，例如安全性和数据库访问框架。Spring 是 Java 世界中的一个典型例子。您永远不必使用 Spring，但它与 Struts、Spring MVC、Hibernate、Acegi 等的插件非常好。它最终为您省去了自己做所有管道的麻烦。
4.  支持！！！好的框架几乎总是有一个充满活力的社区来支持它们并提出和回答问题。

一开始可能看起来很麻烦，但绝对可以在将来为您节省很多时间

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-31T19:53:06.847

这很有道理。我的团队已经在我们的开源堆栈上度过了五年的大部分时间，无论如何，我们有一个“种子”项目（像 appfuse 一样工作），我们用它来创建所有新的 Web 应用程序。即使是从维护应用程序的角度来看的简单的两个寻呼机，它看起来也和其他应用程序一样，只是更小。

简而言之，您现在不会获得任何投资回报，但随着项目的发展和维护，您将获得回报。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-31T19:34:45.950

*我会说你选择哪个*框架实际上很重要。像 Spring MVC 这样的东西在您的代码中相当不显眼，并且允许您现有的东西按原样运行。其他框架对您应该如何做事有更具体的想法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-31T19:23:39.980

是的，它确实有道理。应用程序可以增长和变化，并且可能需要框架将来可以轻松提供的东西。

例如，在我的工作场所，我们有简单的 jsp / servlet 应用程序。由于我上面解释的原因，它需要重写。如果有人花时间来完成框架设置，我们今天的状态会更好。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-31T19:41:35.263

是的，这是有道理的。然而，您的问题隐含的是，错误的（对您而言）框架可能比它的价值更痛苦 - 这是真的。一些繁重的 J2EE 框架和一些轻巧而愉快的框架（如 grails）之间有着天壤之别。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-31T21:15:51.673

有什么选择？自己滚？在 JSP 中嵌入所有导航和逻辑？

我同意那些说 Web 框架值得的人的观点。现在确实有数百个（例如，Struts、JSF、Spring、Wicket 等）。选择一个适合你的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-31T21:36:03.520

有两种应用：

1）你扔掉并且不再使用的那种，因此不应该担心模块化，可维护性和清晰度。

2）真实的种类。

有时看起来您的应用程序可能永远不必增长、扩展或服务于比您当前计划的更大的功能集/用户群......我向您保证，这种看法总是错误的。

框架，特别是像 Java 中的 Struts for MVC、Spring for MVC 和 Dependency Injection、Hibernate for Object-Relational Modeling 都是非常有价值的工具，它们可以使您的代码具有模块化、可维护性和清晰性。所以，回答你原来的问题....是的，强调。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-11-21T11:14:36.620

不，除非：

1.  你的团队没有任何 Java 经验
2.  你只是在做一个必须在几个小时内准备好的原型
3.  您不够信任您的开发人员，无法让他们编写您的应用程序
4.  您不打算让您的开发人员学习和改进

使用框架的危险包括但不限于：

1.  您将自行解决所有框架缺陷
2.  在您完全了解框架之前，您将无法进行现实的估计
3.  您的团队不会学习如何编写 Web 服务器
4.  您会发现您的团队在 google 上花费的时间越来越多，而不是通过编写代码来解决问题。

唯一比选择开源框架最糟糕的是，公司里有一个独立的研发团队，应该创建“大完整的终极公司框架”。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-01T05:31:40.347

> 但我对框架的印象是，它们主要用于大型 J2EE 应用程序并且涉及很多复杂的配置

不一定是真的。好的框架可以很好地扩展，以便它们将您从小型应用程序带到非常大的应用程序。今天的许多框架都在朝着零配置发展，因此您会发现它们更容易使用。

您是对的，学习框架本身确实需要初步努力，但是在您构建的第一个应用程序中，这种投资就可以收回成本。[像AppFuse](http://www.appfuse.org/display/APF/Home)这样的元框架让您更容易上手，因为它为您预先配置了框架。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-01T05:43:18.763

框架对大多数应用程序都有意义。您可能需要构建自己的框架或采用其他一些框架。最重要的问题是数据结构的粒度。我的意思是你只需要输入数据还是需要解析、编译和执行动态代码？

如果您将框架视为衡量标准，左侧是所有现成的开源或封闭框架，右侧是所有自定义框架，那么将您的代码超级强加于复杂程度增加的框架之上向右。您越往右走，您在框架 (IMO) 上的挣扎就越大。

但是，您也可以慢慢地从现有框架迁移到自定义框架。

还有关于您的业务的问题。如果您为一家不将软件视为其核心能力的企业工作，例如银行或医院，那么您需要将其纳入您想要构建的框架的多少。

归根结底，某种类型的框架总是有用的。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-02T16:47:05.183

由于学习曲线，使用框架可能会为您的 Web 应用程序开发增加一些开销。但是，根据您选择的框架，您可能能够实现以下好处：

1.  可扩展性
2.  可维护性
3.  清除模型的划分（例如 MVC）
4.  开箱即用的组件（会话管理、身份验证等）
5.  第三方插件
6.  从框架继承的模块化
7.  好多其它的。

此外，学习曲线是一个可变因素。根据您的技能，某些框架可能比其他框架更容易学习。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-04-30T13:36:57.013

考虑使用框架绝对是有意义的，即使没有其他原因，它会给你一个新的知识领域。如果您有时间花时间学习一个框架，那么您很可能会及时发现，无论多么简单，将其用于新项目都会更容易、更快捷。

另外，如果我可以投票给 SamBeran 的帖子，那么我会的。开始使用框架将涉及“哦，太好了！我不需要再写所有的样板！”的时刻。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-31T19:23:03.647

我会说使用一个 - 就像你说的那样，即使是一个简单的 java web 应用程序，启动和运行东西也是相当乏味的。如果该框架可以帮助您更快地完成工作并提供您需要的服务，我会说这是有道理的。

# c# - 返回多个值

> ID：403836
> 
> 赞同：1
> 
> 时间：2008-12-31T19:21:22.683
> 
> 标签：c#, function, parameters, return-value

我有一个识别页面坐标的函数，我将它们作为

```
Dictionary<int, Collection<Rectangle>> GetDocumentCoordinates(int DocumentId) 
```

但是，稍后我需要有关每个页面的信息 - 如果已验证，页面分辨率是多少，颜色/bw 等。我可以创建另一个函数并运行与前一个函数几乎相同的结果集并获取该信息。

```
Dictionary<int, PageInfo> GetDocumentAttributes(int DocumentId) 
```

另一种选择是添加一个`ref`参数，以便我可以取回这些值。

```
Dictionary<int, Collection<Rectangle>> GetCoordinates(int DocumentId, ref Dictionary<int, PageInfo> PageAttributes) 
```

另一种选择是创建一个包含字典和页面信息的包含类：

```
class DocumentInfo
{
    Dictionary<int, Collection<Rectangle>> Coordinates { get; set;}
    Dictionary<int, PageInfo> PageAttributes { get; set; }
} 
```

然后定义：

```
DocumentInfo GetDocumentInfo(int DocumentId); 
```

我倾向于最后一个选项，但非常感谢您的见解。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-31T19:38:03.757

最后一个选项绝对是最好的。我发现，在获取或返回具有多种含义的复杂数据时，出于多种原因，创建一个复杂类型来封装这些数据是最佳实践。

首先，您的返回数据可能会随着您的设计更改而更改。将这些数据封装在一个对象中允许您更改它携带的内容以及您的方法如何操作这些数据，而无需更改对象的*接口*。显然，您的数据对象不应该实现接口；最多有一个具有最小接口的基类，然后传递对基类的引用。

其次，您可能会发现您的数据变得复杂到需要对其执行验证的程度。您可以轻松地将其包装在数据类中，而不是在您对这些数据进行操作的类的所有方法中进行此验证。单一责任等

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T19:33:34.827

看来您需要大量数据。最后一个选项应该没问题，并且是可扩展的；如果你想要（为了简化`Dictionary<,>`使用），你可以封装更多东西，但是 C# 不直接支持命名索引属性的事实意味着你需要一些类，除非你只用如下方法包装：

```
class DocumentInfo {
    Dictionary<int, Collection<Rectangle>> rectangles = ...
    public Collection<Rectangle> GetRectangles(int index) {
        return rectangles[index]; // might want to clone to
                                  // protect against mutation
    }
    Dictionary<int, PageInfo> pages = ...
    public PageInfo GetPageInfo(int index) {
        return pages[index];
    }

 } 
```

我不太清楚它`int`是什么，所以我不能说这是否明智（所以我就不管它了）。

另外-使用第一个选项，您可能不需要`ref`-使用`out`.

# jquery - 带 jQuery 的单选按钮检查

> ID：403846
> 
> 赞同：4
> 
> 时间：2008-12-31T19:24:20.930
> 
> 标签：jquery, html

循环浏览我页面上的所有单选按钮并在其中一个未选中特定问题时提醒用户的最佳方法是什么？

注意：一页有多个问题。

```
<li>
  <fieldset>
  <h3>What music do you listen to?</h3>  

        <ul class="answerList">
            <li>
                <input type="radio" id="choice_22" name="answer8" value="1" class=""/>
                <label for="choice_22" class="">Heavy Metal  </label>
            </li>
            <li>
                <input type="radio" id="choice_23" name="answer8" value="2" class=""/>
                <label for="choice_23" class="">Pop music</label>
            </li>
            <li>
                <input type="radio" id="choice_24" name="answer8" value="3" class=""/>
                <label for="choice_24" class="">Oh, a mix of stuff </label>
            </li>
         </ul>
       </fieldset>   
      </li> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-31T20:01:41.323

```
if (undefined === $("input[name='answer8']:checked").val()) {
    // do something
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-31T19:41:39.477

试试这些：

[查找所有未选择](https://stackoverflow.com/questions/249214/find-all-radio-groups-which-havent-been-selected) [的单选组 使用 jQuery 验证插件验证单选按钮组](https://stackoverflow.com/questions/277589/validation-of-radio-button-group-using-jquery-validation-plugin)

# asp.net - 当用户关闭浏览器等待长时间运行的 Web 服务调用时会发生什么？

> ID：403853
> 
> 赞同：10
> 
> 时间：2008-12-31T19:27:47.693
> 
> 标签：asp.net, web-services, biztalk

我有一个类似的问题：http: [//social.msdn.microsoft.com/forums/en-US/biztalkgeneral/thread/87d5a6ec-04ee-4c6f-8267-f526ee105f0b](http://social.msdn.microsoft.com/forums/en-US/biztalkgeneral/thread/87d5a6ec-04ee-4c6f-8267-f526ee105f0b)

我有一个调用 BizTalk Web 服务的 asp.net 网页。BizTalk 业务流程执行其工作并向 asp.net 页面返回响应。该过程可能需要一两分钟。我收到很多超时，但 BizTalk 业务流程似乎平均在 30 秒内返回。

我想知道，如果用户提交他们的请求然后立即关闭他们的浏览器会发生什么。asp.net 客户端是否停止等待 BizTalk 的请求（并导致超时），或者即使用户关闭了浏览器，它仍会等待请求吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-31T19:58:57.180

ASP.NET 请求继续执行，不知道最初提交 GET/POST 的浏览器不再等待这一事实。该请求将完成，除非出现任何其他错误，例如服务器超时。

# .net - WCF - 谁在连接我

> ID：403855
> 
> 赞同：2
> 
> 时间：2008-12-31T19:29:50.310
> 
> 标签：.net, wcf

使用 WCF，我如何确定谁正在连接到我的服务器？

背景：我有一组 WCF 客户端和服务器。我怀疑一个客户端指向了错误的服务器，所以我想记录到该服务器的所有连接。我不知道它是哪个客户端，所以我必须在服务器端检查它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T19:39:50.883

这在 3.5 中通过[RemoteEndpointMessageProperty](http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.remoteendpointmessageproperty.aspx)是最简单的；看[这里](http://nayyeri.net/blog/detect-client-ip-in-wcf-3-5/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T19:40:42.597

```
OperationContext opCtx = OperationContext.Current;
EndpointAddress from = opCtx.IncomingMessageHeaders.From; 
```

# c# - 在 asp.net 中处理动态生成的控件

> ID：403860
> 
> 赞同：1
> 
> 时间：2008-12-31T19:32:34.783
> 
> 标签：c#, asp.net

处理通过 ASP.NET 中动态生成的控件输入的数据的最佳方法是什么？

目前，我有一组在 Page_Load 阶段生成的控件，我需要从中访问数据。似乎可以只使用在回发时读取和解析的隐藏字段，但我想知道是否有更好的方法可以更好地利用框架。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T19:36:27.427

关键是在回发时重新创建控件。

[旧但很好的文章](http://aspnet.4guysfromrolla.com/articles/092904-1.aspx)来解释如何以及为什么。

您还可以使用 request.form 集合来获取发布的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T19:59:17.477

[红方](https://stackoverflow.com/users/6440/redsquare)是对的。如果你能记住 ASP.Net 是一个围绕 Http 的谎言，那么你会没事的。浏览器并不真正关心 MS 以 Web 控件的形式巧妙地将 Http 请求/响应从您那里抽象出来。它只知道它需要将每个表单变量及其各自的值包装起来，然后通过 Http 发送回服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T22:03:55.103

您希望将创建的动态控件保持在最低限度，特别是如果您将事件附加到它们。

我在 ASP.NET MVC 建议中支持@redsquare。

# algorithm - 总结所有组合的数字列表的算法

> ID：403865
> 
> 赞同：21
> 
> 时间：2008-12-31T19:34:31.800
> 
> 标签：algorithm

我有一个数字列表，我想把所有不同的组合加起来。例如：

*   数字为 1,4,7 和 13
*   输出将是：

```
1+4=5
1+7=8
1+13=14
4+7=11
4+13=17
7+13=20
1+4+7=12
1+4+13=18
1+7+13=21
4+7+13=24
1+4+7+13=25 
```

有没有公​​式可以用不同的数字来计算？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-31T19:40:34.423

一个简单的方法是创建一个与数字一样多的位集。在您的示例 4 中。

然后从 0001 数到 1111 并对集合中每个具有 1 的数字求和：

数字 1、4、7、13：

```
0001 = 13=13
0010 = 7=7
0011 = 7+13 = 20

1111 = 1+4+7+13 = 25 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-01T01:25:23.713

下面是一个简单的**递归**解决方案在 Java 中的样子：

```
public static void main(String[] args)
{
    f(new int[] {1,4,7,13}, 0, 0, "{");
}

static void f(int[] numbers, int index, int sum, String output)
{
    if (index == numbers.length)
    {
        System.out.println(output + " } = " + sum);
        return;
    }

    // include numbers[index]
    f(numbers, index + 1, sum + numbers[index], output + " " + numbers[index]);

    // exclude numbers[index]
    f(numbers, index + 1, sum, output);
} 
```

输出：

```
{ 1 4 7 13 } = 25
{ 1 4 7 } = 12
{ 1 4 13 } = 18
{ 1 4 } = 5
{ 1 7 13 } = 21
{ 1 7 } = 8
{ 1 13 } = 14
{ 1 } = 1
{ 4 7 13 } = 24
{ 4 7 } = 11
{ 4 13 } = 17
{ 4 } = 4
{ 7 13 } = 20
{ 7 } = 7
{ 13 } = 13
{ } = 0 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-31T19:49:40.927

最著名的算法需要指数时间。如果有多项式时间算法，那么您将解决[子集和问题](http://en.wikipedia.org/wiki/Subset_sum_problem)，从而解决[P=NP 问题](http://en.wikipedia.org/wiki/P_%3D_NP_problem)。

这里的算法是创建长度等于您的一组数字的基数的位向量。修复`(n_i)`您的一组数字的枚举。然后，枚举位向量的所有可能值。对于位向量的每个枚举`(e_i)`，计算 的总和`e_i * n_i`。

这里的直觉是，您用位向量表示数字集的子集，并生成数字集的所有可能子集。当位`e_i`等于一时，`n_i`在子集中，否则不在。

Knuth 的 TAOCP 的第四卷提供了生成位向量所有可能值的算法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-31T21:52:13.130

C＃：

我试图找到更优雅的东西 - 但这现在应该可以解决问题......

```
//Set up our array of integers
int[] items = { 1, 3, 5, 7 };

//Figure out how many bitmasks we need... 
//4 bits have a maximum value of 15, so we need 15 masks.
//Calculated as:
//    (2 ^ ItemCount) - 1
int len = items.Length;
int calcs = (int)Math.Pow(2, len) - 1;

//Create our array of bitmasks... each item in the array
//represents a unique combination from our items array
string[] masks = Enumerable.Range(1, calcs).Select(i => Convert.ToString(i, 2).PadLeft(len, '0')).ToArray();

//Spit out the corresponding calculation for each bitmask
foreach (string m in masks)
{
    //Get the items from our array that correspond to 
    //the on bits in our mask
    int[] incl = items.Where((c, i) => m[i] == '1').ToArray();

    //Write out our mask, calculation and resulting sum
    Console.WriteLine(
        "[{0}] {1}={2}", 
        m, 
        String.Join("+", incl.Select(c => c.ToString()).ToArray()), 
        incl.Sum()
    );
} 
```

输出为：

```
[0001] 7=7
[0010] 5=5
[0011] 5+7=12
[0100] 3=3
[0101] 3+7=10
[0110] 3+5=8
[0111] 3+5+7=15
[1000] 1=1
[1001] 1+7=8
[1010] 1+5=6
[1011] 1+5+7=13
[1100] 1+3=4
[1101] 1+3+7=11
[1110] 1+3+5=9
[1111] 1+3+5+7=16 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-01T02:51:30.093

这是一个简单的递归 Ruby 实现：

```
a = [1, 4, 7, 13]

def add(current, ary, idx, sum)
    (idx...ary.length).each do |i|
        add(current + [ary[i]], ary, i+1, sum + ary[i])
    end
    puts "#{current.join('+')} = #{sum}" if current.size > 1
end    
add([], a, 0, 0) 
```

哪个打印

```
1+4+7+13 = 25
1+4+7 = 12
1+4+13 = 18
1+4 = 5
1+7+13 = 21
1+7 = 8
1+13 = 14
4+7+13 = 24
4+7 = 11
4+13 = 17
7+13 = 20 
```

如果您不需要在每一步都打印数组，则代码可以变得更简单、更快，因为不会创建额外的数组：

```
def add(ary, idx, sum)
    (idx...ary.length).each do |i|
        add(ary, i+1, sum + ary[i])
    end
    puts sum
end
add(a, 0, 0) 
```

我不认为你能有比这更简单的了。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-31T21:32:52.247

这个 Perl 程序似乎做你想做的事。它通过不同的方式[从](http://mathworld.wolfram.com/Combination.html)[*k个项目中选择*](http://mathworld.wolfram.com/Combination.html)[*n*个项目](http://mathworld.wolfram.com/Combination.html)*。计算有多少组合很容易，但是获得每个组合的总和意味着您最终必须将它们相加。当我问[如何计算正确的邮票组合时，我在](http://www.perlmonks.org/index.pl?node_id=726121)[Perlmonks](http://www.perlmonks.org)上有一个类似的问题？.*

 *[Math::Combinatorics](http://search.cpan.org/dist/Math-Combinatorics)模块还可以处理许多其他情况。即使您不想使用它，文档也有很多指向有关该问题的其他信息的指针。其他人可能会为您想要的语言推荐合适的库。

```
#!/usr/bin/perl

使用 List::Util qw(sum);
使用数学::组合学；

我的@n = qw(1 4 7 13);

foreach 我的 $count ( 2 .. @n ) {
    我的 $c = Math::Combinatorics->new(
        count => $count, # 要选择的数字
        数据 => [@n]，
        );

    打印“$count 的组合来自：[”。加入（“”，@n）。"]\n";

    而（我的@combo = $c->next_combination）{
        打印连接（''，@combo），“=”，sum（@combo），“\n”；
        }
    }

```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-31T22:20:06.833

数学解决方案：

```
{#, Total@#}& /@ Subsets[{1, 4, 7, 13}] //MatrixForm

```

输出：

```
{}  0
{1} 1
{4} 4
{7} 7
{13}    13
{1,4}   5
{1,7}   8
{1,13}  14
{4,7}   11
{4,13}  17
{7,13}  20
{1,4,7} 12
{1,4,13}    18
{1,7,13}    21
{4,7,13}    24
{1,4,7,13}  25 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-31T19:40:24.363

您可以使用位向量枚举所有子集。

在 for 循环中，从 0 到 2 的 N 次方减 1（如果您不关心空集，则从 1 开始）。

在每次迭代中，确定设置了哪些位。第 N 位表示集合的第 N 个元素。对于每个设置位，取消引用集合的适当元素并添加到累积值。

ETA：因为这个问题的性质涉及指数复杂性，所以你可以枚举的集合的大小有一个实际限制。如果事实证明您不需要所有子集，则可以查找“n 选择 k”以了解枚举 k 个元素的子集的方法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-10-03T02:31:35.990

**PHP：**这是一个非递归实现。我并不是说这是最有效的方法（这确实是指数 2^N - 请参阅 JasonTrue 的回复和评论），但它适用于一小部分元素。我只是想快速写一些东西来获得结果。我根据 Toon 的回答来建立算法。

```
$set = array(3, 5, 8, 13, 19);

$additions = array();
for($i = 0; $i < pow(2, count($set)); $i++){
    $sum = 0;
    $addends = array();
    for($j = count($set)-1; $j >= 0; $j--) {
        if(pow(2, $j) & $i) {
            $sum += $set[$j];
            $addends[] = $set[$j];
        }
    }
    $additions[] = array($sum, $addends);
}

sort($additions);

foreach($additions as $addition){
    printf("%d\t%s\n", $addition[0], implode('+', $addition[1]));
} 
```

这将输出：

```
0   
3   3
5   5
8   8
8   5+3
11  8+3
13  13
13  8+5
16  13+3
16  8+5+3
18  13+5
19  19
21  13+8
21  13+5+3
22  19+3
24  19+5
24  13+8+3
26  13+8+5
27  19+8
27  19+5+3
29  13+8+5+3
30  19+8+3
32  19+13
32  19+8+5
35  19+13+3
35  19+8+5+3
37  19+13+5
40  19+13+8
40  19+13+5+3
43  19+13+8+3
45  19+13+8+5
48  19+13+8+5+3 
```

例如，这种情况可能是一组用于锻炼的阻力带。假设你有 5 个波段，每个波段都有不同的阻力，以磅为单位，你可以组合波段来总结总阻力。带阻力为 3、5、8、13 和 19 磅。这组为您提供了 32 (2^5) 种可能的配置，减去零。在此示例中，算法返回按总阻力升序排序的数据，优先考虑有效的波段配置，并且对于每个配置，波段按阻力降序排序。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-31T20:00:46.613

这不是生成和的代码，而是生成排列的代码。在你的情况下：

1个；1,4; 1,7; 4,7; 1,4,7; ...

如果我周末有时间，如果有趣的话，我可以修改它以得出总和。

这只是 Igor Ostrovsky 博客中的一段有趣的 LINQ 代码，标题为“使用 LINQ 简化程序的 7 个技巧”（[http://igoro.com/archive/7-tricks-to-simplify-your-programs-with-linq/](http://igoro.com/archive/7-tricks-to-simplify-your-programs-with-linq/)）。

```
T[] arr = …;
var subsets = from m in Enumerable.Range(0, 1 << arr.Length)
              select
                  from i in Enumerable.Range(0, arr.Length)
                  where (m & (1 << i)) != 0
                  select arr[i]; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-21T01:37:51.150

如果您想避免维护成本，您可能有兴趣查看 GNU 科学库。对较长序列求和的实际过程将变得非常昂贵（比基于步骤生成单个排列更昂贵），大多数架构都有 SIMD/向量指令，可以提供相当令人印象深刻的加速（我会提供这种实现的示例，但我还不能发布网址）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-01-11T23:33:02.900

谢谢扎克，

我正在创建一个银行对账解决方案。我将您的代码放入 jsbin.com 以进行一些快速测试并用 Javascript 生成：

```
function f(numbers,ids, index,  sum, output, outputid, find )
{
    if (index == numbers.length){
          var x ="";
          if (find == sum) {
              y= output + " } = " + sum + "  " + outputid + " }<br/>" ;
          }
        return;
    }
    f(numbers,ids, index + 1, sum + numbers[index], output + " " + numbers[index], outputid + " " + ids[index], find);
    f(numbers,ids, index + 1, sum, output, outputid,find);
}

var y;

f( [1.2,4,7,13,45,325,23,245,78,432,1,2,6],[1,2,3,4,5,6,7,8,9,10,11,12,13], 0, 0, '{','{', 24.2);
if (document.getElementById('hello')) {
  document.getElementById('hello').innerHTML = y;
} 
```

我需要它来生成要从下一个匹配号码中排除的 ID 列表。

我将使用 vb.net 发回我的最终解决方案

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-08-27T18:33:38.557

```
public static void main(String[] args) {
        // this is an example number
        long number = 245L;
        int sum = 0;

        if (number > 0) {
            do {
                int last = (int) (number % 10);
                sum = (sum + last) % 9;
            } while ((number /= 10) > 0);
            System.err.println("s = " + (sum==0 ? 9:sum);
        } else {
            System.err.println("0");
        }
    } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-10-22T17:00:13.327

```
v=[1,2,3,4]#variables to sum
i=0
clis=[]#check list for solution excluding the variables itself
def iterate(lis,a,b):
    global i
    global clis
    while len(b)!=0 and i<len(lis):
        a=lis[i]
        b=lis[i+1:]
        if len(b)>1:
            t=a+sum(b)
            clis.append(t)
        for j in b:
            clis.append(a+j)
        i+=1
        iterate(lis,a,b)
iterate(v,0,v) 
```

它是用python编写的。这个想法是将列表分解为一个整数和一个列表，例如。[1,2,3,4] 转换为 1,[2,3,4]。我们现在通过添加剩余列表的整数和总和来追加总和。我们也采用每个单独的总和，即 1,2;1,3;1,4。checklist 现在应该是 [1+2+3+4,1+2,​​1+3,1+4] 然后我们递归地调用新列表，即现在 int=2,list=[3,4]。清单现在将追加 [2+3+4,2+3,2+4] 因此我们追加清单直到列表为空。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-07-18T19:40:25.490

set 是总和的集合，list 是原始数字的列表。

它的Java。

```
public void subSums() {
    Set<Long> resultSet = new HashSet<Long>();
    for(long l: list) {
        for(long s: set) {
            resultSet.add(s);
            resultSet.add(l + s);
        }
        resultSet.add(l);
        set.addAll(resultSet);
        resultSet.clear();
    }
} 
```

# asp.net - 如何避免使用 jQuery ajax 在快速结果上出现“闪烁”的进度 div？

> ID：403868
> 
> 赞同：7
> 
> 时间：2008-12-31T19:35:22.843
> 
> 标签：asp.net, jquery, ajax

我正在使用 jQuery 对使用[这种方法](http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/)的 ASP.NET 后端进行 AJAX 调用。我正在使用 .ajaxStart 和 .ajaxStop 来显示和隐藏进度指示器。当 AJAX 请求很快完成时，进度指示器会“闪烁”，因为它显示的时间不够长。

一种可能的解决方案是仅在最短时间后显示（如 MS AJAX 中的 UpdateProgress.DisplayAfter）。另一种方法是确保指标显示时间最短。不幸的是，jQuery [Pause 插件](http://blog.mythin.net/projects/jquery.php)似乎不起作用，像[这样](http://www.learningjquery.com/2007/01/effect-delay-trick)的效果延迟技巧也不起作用。[类似于this SO answer](https://stackoverflow.com/questions/89051/queuing-actions-not-effects-to-execute-after-an-amount-of-time)的某种基于JavaScript setTimeout 的解决方案似乎最有可能，但问题是Ajax调用一直在处理。因此，当进度指示器仍然可见时，结果就会显示出来。

那么，可以做到吗？如果是这样，怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T11:07:13.977

尝试以下操作：

```
$("#spinner")
    .bind("ajaxSend", function() {
            $(this).fadeIn(1000);
    })
    .bind("ajaxComplete", function(){
        $(this).stop();
        $(this).hide();
    }); 
```

这个想法是你淡入微调器有一个时间延迟（在本例中为 1000）并取消动画并隐藏在 ajaxComplete 上。

如果您想进行延迟显示，您可以尝试使用 animate() 而不是 fade() 并链接调用（例如 $(this).animate(/* 此处的某些内容 */).show()）

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T19:47:26.173

在使用带有进度指示器的 Ajax 的项目的早期阶段，您当然会有闪烁的效果，因为您（希望）在测试时没有处理大量数据。您会发现随着您的项目获得越来越多的数据，进度指示器会停留的时间越来越长。我不建议故意创建延迟以将进度指示器保留在那里，因为它会降低用户体验。尝试使用 javascript setTimeout() 函数。

# .net - 如何正确记录扩展方法

> ID：403887
> 
> 赞同：4
> 
> 时间：2008-12-31T19:41:30.647
> 
> 标签：.net, documentation, extension-methods, coding-style

因此，对于常用的东西，我有一些扩展方法，并且在记录它们时，我突然想到我*不知道*如何`summary`在 XML 注释中一致地编写标记。例如：

```
 /// <summary>
    ///     Gets a subset of characters from the left-hand side of a string.
    /// </summary>
    public static string Left(this string value, int length) 
```

对比

```
 /// <summary>
    ///     Gets the name of the month for this date.
    /// </summary>
    public static string MonthName(this DateTime value) 
```

所以，问题似乎是我不知道如何始终如一地引用那个讨厌的`this`参数。此外，我不知道如何清楚地表明这是一种扩展方法（因为我不确定 Sandcastle 和其他工具是否已经赶上它们并且可以自动注释文档以显示它）；我不想以后不得不撕掉所有的手动文档。

所以问题是，对于记录扩展方法有什么指导？如果没有正式的指导，你们都是怎么处理的？如果我们还没有，我们可以对某事进行投票，以便我有事可做吗？作为一个强迫性控制狂，这种不一致让我发疯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T19:51:09.737

不支持扩展方法的 .NET 语言将要求用户直接调用该方法并传入已扩展的对象。因此，记录此参数并准确描述为什么需要它以及方法将如何作用于它是很重要的。

从扩展方法方面考虑这可能有点困难，但是如果您从另一方设想方法，人们正在调用静态方法，那就更容易了。

另一件事...有时您可能会发现自己（例如 MVC 中的 HtmlHelper）在扩展对象时超出了*惯例*而不是必要性。这意味着被扩展的对象是否为空并不重要，因为该方法不会对其进行操作。虽然约定（我相信）是在`this`对象为空时抛出，但我更喜欢让方法正常完成并在帮助中记录这一事实（即，“......这可以是空的”或“......空是此参数的有效值。”）

# python - 在另一个 sql 查询中使用 python 程序中的 sql 查询的结果

> ID：403897
> 
> 赞同：0
> 
> 时间：2008-12-31T19:44:58.377
> 
> 标签：python, sql

很抱歉我之前的问题非常模棱两可，但我想如果我得到这个问题的答案，我可以解决。在下面的程序中，我选择了数量少于数量的产品条形码。我想说，如果条形码（在冰箱表中）与另一个表（产品）中的条形码匹配，请将库存字段设置为 0。我遇到的问题是程序正在尝试匹配它找到的所有条形码在针对产品表中的单个条形码的查询中（这就是我的想法）。有谁知道该怎么做。太感谢了。林肯。

```
import MySQLdb

def order():
    db = MySQLdb.connect(host='localhost', user='root', passwd='$$', db='fillmyfridge')
    cursor = db.cursor()
    cursor.execute('select barcode from fridge where amount < quantity')
    db.commit()
    row = cursor.fetchall()
    cursor.execute('update products set stock = 0 where barcode = %s', row) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T20:03:09.353

```
UPDATE products SET stock = 0 WHERE barcode IN ( 
    SELECT fridge.barcode FROM fridge WHERE fridge.amount < fridge.quantity ); 
```

我知道这并不能准确回答问题，但不需要两个 SQL 语句。

在python中做到这一点：

```
import MySQLdb

def order():
    db = MySQLdb.connect(host='localhost', user='root', passwd='$$', db='fillmyfridge')
    cursor = db.cursor()
    cursor.execute('select barcode from fridge where amount < quantity')
    db.commit()
    rows = cursor.fetchall()
    for row in rows
        cursor.execute('update products set stock = 0 where barcode = %s', row[0]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-31T20:09:21.340

这比 Python 更多的是 SQL 查询，但我仍然会尝试回答这个问题：（我没有使用过 MySQL，而是使用过 PostgreSQL，因此这里对事物的解释可能会略有不同）。

当你这样做的时候

```
cursor.execute('select barcode from fridge where amount < quantity')
db.commit()
row = cursor.fetchall() 
```

变量 'row' 现在是一个结果集（理解：数据库中的行列表）类似于 [(barcode1), (barcode2), (barcode3)..]

当您执行更新语句时

```
cursor.execute('update products set stock = 0 where barcode = %s', row) 
```

这变成了类似的东西：

```
update products set stock = 0 where barcode = [(barcode1), (barcode2), (barcode3)..] 
```

这不是正确的 SQL 语句。

你应该这样做：

```
cursor.execute('update products set stock = 0 where barcode in (%s)', ','.join([each[0] for each in row])) 
```

或者更好，优化的东西：

```
import MySQLdb

def order():
    db = MySQLdb.connect(host='localhost', user='root', passwd='$$', db='fillmyfridge')
    cursor = db.cursor()
    cursor.execute('update products set stock = 0 where barcode in (select barcode from fridge where amount < quantity)')
    db.commit() 
```

好吧，要添加更多内容，您在选择查询之后而不是在更新查询之后有一个 db.commit()，这是一个基本错误。Select 是幂等的，不需要提交，而 Update 需要。我强烈建议您在继续之前先完成一些 SQL。

# java - 在 Java 构建过程中更改常量的最佳方法

> ID：403902
> 
> 赞同：5
> 
> 时间：2008-12-31T19:47:20.417
> 
> 标签：java, configuration, tomcat, ant, build-automation

我继承了一个在 Tomcat 下运行的 Java 应用程序（servlet）。由于历史原因，代码具有不同的“外观”选项，具体取决于应用程序的部署位置（本质上是品牌问题）。

有几个常量控制着这个品牌化过程，它们有不同的功能，不应该被压缩成一个常量（即BRAND、MULTI-LANGUAGE，加上图标和css 样式表的位置等）。

目前，开发团队必须手动更改常量（它们至少在一个数据类中本地化并且有据可查），然后使用 ANT 重新编译应用程序。

假设至少 Ant 1.8 和 Java 6.x，自动化此过程的最佳方法是什么？

我知道使用编译器参数没有任何好的解决方案（就像在 C 或 C++ 中可以做的那样），并且倾向于使用某种“最佳方式”来编辑包含常量的源文件，或者将它们放入另一个文件和使用 ant 构建过程交换它们。我想要一个可以使用“ant build brand-x”之类的东西的结果，其中更改品牌会更改生成的版本。

谢谢，

-理查德

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-31T20:16:58.733

将您的值放入属性文件中，例如“myapp.properties”，然后在启动时从类路径将它们加载到您的常量中（请参阅下文了解如何适应构建过程）：

```
public class Constants
{
    private static final Properties props = new Properties();
    public static final String MY_CONSTANT;

    static
    {
        InputStream input = Constants.class.getResourceAsStream("/myapp.properties");
        if(input != null)
        {
           try
           {
              properties.load(input);
           }
           catch(IOException e)
           {
              // TODO log error
           }
        }

        // Initialize constants (dont' forget defaults)
        MY_CONSTANT = properties.getProperty("constant", "default");
        // .. other constants ...
    }
} 
```

现在，为每个品牌创建一个单独的属性文件。通过 -D 或 build.properties 将其名称传递给 ANT，并在 jar （或战争）之前将文件复制到您的构建目录。

*显然，上面的代码可以工作，但是有很多方法可以清理它并使其防弹。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T19:49:46.510

使用 Ant 中的替换任务来更改这些值。

*   [蚂蚁替换](http://ant.apache.org/manual/Tasks/replace.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T20:00:31.543

还有一种“弹簧”方式，即使用属性文件和从属性中提取值并将它们注入到需要它们的类中的 bean，例如：

```
<bean id="propertyPlaceholder"  class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location" value="classpath:configuration.properties" />
</bean> 
```

然后，您可以使用“ant-like”语法注入属性：

```
<bean id="connectionPool"  class="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
    <property name="databaseName" value="mydb" />
    <property name="url" value="${db.url}" />
    ... 
```

这可能需要比你想要的更多的重写。如果您要在每次编译时更改常量，我会注意这个问题（如果您使用的是静态决赛，那就是）。

```
public class Foo {
 public static final int SOME_CONSTANT=1;
..
}

public class Bar {
  ...
   int x=5+Foo.SOME_CONSTANT;
  ...
} 
```

如果您随后将 Foo 中的 SOME_CONSTANT 更改为 2 但不重新编译 Bar，Bar 将保留 SOME_CONSTANT 的值 1，因为静态决赛已被编译（因为编译器认为它不应该再次计算出来） ）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T20:12:03.127

我更喜欢使用 ant 的[expandproperties](http://ant.apache.org/manual/Types/filterchain.html#expandproperties)过滤器而不是替换任务。通过替换任务，构建文件往往会增长为主要是标记化。expandproperties 允许您将 ant 属性直接嵌入到文本中。

```
<copy file="from" tofile="to">
  <filterchain>
    <expandproperties />
  </filterchain>
</copy> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-02T05:00:53.590

我有一个解决方案可以根据需要用于这种特殊情况。我将 Ant 替换任务与常量类的“已保存”版本结合使用：

```
<target name="one" description="constant substitution #1">
  <delete file="./tme3/MyConst.java" />
  <copy file="./save/MyConst.java" tofile="./tme3/MyConst.java" />
  <replace file="./tme3/MyConst.java" token="@BRANDING@" value="ONE_BRAND"/>
  <replace file="./tme3/MyConst.java" token="@STYLESHEET@"
           value="../stylesheet/onebrand.css"/>
  <replace file="./tme3/MyConst.java" token="@FAVICON@" value="../images/onebrand.ico"/>
  <replace file="./tme3/MyConst.java" token="@SHOW_LANGUAGES@" value="false"/>
</target> 
```

我只是复制这个块并更改我需要的情况的替换 - 在我的特殊情况下，现在有 3 套，但更多的是预期的。

感谢大家的精彩回复。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T19:55:23.490

使用 Ant[属性文件](http://ant.apache.org/manual/Tasks/loadproperties.html)，并使用“-Dbrand=X”构建。

# gcc - 使用 gcc/g++ 和 ld 的配置文件链接时间

> ID：403914
> 
> 赞同：2
> 
> 时间：2008-12-31T19:52:27.300
> 
> 标签：gcc, profiling, g++, linker, ld

我正在使用 g++ 编译和链接一个由大约 15 个 c++ 源文件和 4 个共享对象文件组成的项目。最近链接时间增加了一倍多，但我没有可用的 makefile 的历史记录。有什么方法可以分析 g++ 以查看链接的哪一部分需要很长时间？

**编辑：**在我注意到 makefile 一直在使用 -O3 优化之后，我设法通过删除该开关将链接时间减半。有没有什么好方法我可以在没有反复试验的情况下找到这个？

**编辑：**我实际上对分析 ld 的工作原理并不感兴趣。我有兴趣知道如何将链接时间的增加与特定的命令行开关或目标文件相匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T07:59:27.280

如果您刚刚达到 RAM 限制，您可能会听到磁盘工作的声音，系统活动监视器会告诉您这一点。但是如果链接仍然受 CPU 限制（即如果 CPU 使用率仍然很高），那不是问题。如果链接是 IO 绑定的，那么最常见的罪魁祸首可能是运行时信息。无论如何，看看可执行文件的大小。

以不同的方式回答您的问题：您是否正在大量使用模板？对于具有不同类型参数的模板的每次使用，都会生成整个模板的新实例，因此您可以为链接器做更多的工作。但是，要使这一点真正引人注目，您需要使用一些非常重模板的库。Boost 项目中的许多项目都符合条件——当使用具有复杂语法的 Boost::Spirit 时，我得到了基于模板的代码膨胀。大约 4000 行代码编译为 7,7M 可执行文件 - 更改一行使所需的专业化数量和最终可执行文件的大小增加了一倍。不过，内联帮助很大，导致 1,9M 的输出。

共享库可能会导致其他问题，您可能需要查看 -fvisibility=hidden 的文档，无论如何它都会改进您的代码。来自 -fvisibility 的 GCC 手册：

> ```
>  Using this feature can very substantially
>  improve linking and load times of shared object libraries, produce
>  more optimized code, provide near-perfect API export and prevent
>  symbol clashes.  It is *strongly* recommended that you use this in
>  any shared objects you distribute. 
> ```

事实上，链接器通常必须支持应用程序或其他库覆盖定义到库中的符号的可能性，而这通常不是预期的用途。请注意，使用它不是免费的，但是它确实需要（微不足道的）代码更改。

文档建议的链接是： http: [//gcc.gnu.org/wiki/Visibility](http://gcc.gnu.org/wiki/Visibility)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T20:33:48.827

gcc 和 g++ 都支持`-v`详细标志，这使得它们输出当前任务的详细信息。

如果您对真正分析这些工具感兴趣，您可能需要查看[Sysprof](http://www.daimi.au.dk/~sandmann/sysprof/)或[OProfile](http://oprofile.sourceforge.net/news/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T08:19:13.770

分析`g++`将证明是徒劳的，因为`g++`链接器不执行链接`ld`。

分析`ld`也可能不会向您显示任何有趣的东西，因为链接时间通常由磁盘 I/O 支配，如果您的链接不是，除非您了解`ld`内部结构，否则您将不知道如何处理分析数据。

如果您的链接时间很明显，链接中只有 15 个文件，那么您的开发系统 [1] 可能有问题；要么它的磁盘已处于最后阶段并且不断重试，要么您没有足够的内存来执行链接（链接通常是 RAM 密集型的），并且您的系统交换疯狂。

假设您在基于 ELF 的系统上，您可能还希望尝试新的`gold`链接器（binutils 的一部分），它通常比 GNU 快几倍`ld`。

[1] 我的典型链接涉及 1000 个对象，生成 200+MB 的可执行文件，并且在不到 60 秒内完成。

# sql - 是否有 PRODUCT 函数，例如 Oracle SQL 中的 SUM 函数？

> ID：403924
> 
> 赞同：13
> 
> 时间：2008-12-31T19:55:56.157
> 
> 标签：sql, oracle

我有一个同事在找这个，我不记得曾经遇到过这样的事情。

有没有一种合理的技术可以让你模拟它？

```
SELECT PRODUCT(X)
FROM
(
    SELECT 3 X FROM DUAL
    UNION ALL 
    SELECT 5 X FROM DUAL
    UNION ALL
    SELECT 2 X FROM DUAL
) 
```

将产生 30

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-01T09:06:07.887

```
select exp(sum(ln(col)))
  from table; 
```

编辑：

如果 col 总是 > 0

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T19:57:41.457

```
DECLARE @a int
SET @a = 1
-- re-assign @a for each row in the result
-- as what @a was before * the value in the row
SELECT @a = @a * amount
FROM theTable 
```

有一种方法可以进行类似的字符串连接：

```
DECLARE @b varchar(max)
SET @b = ""

SELECT @b = @b + CustomerName
FROM Customers 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-31T21:15:51.453

这是另一种方法。这绝对是更长的方法，但它是一个有趣的项目的一部分。

你必须回到学校才能拿到这个，哈哈。这里要记住的关键是 LOG 是指数的倒数。

LOG10(X*Y) = LOG10(X) + LOG10(Y)

或者

ln(X*Y) = ln(X) + ln(Y)（ln = 自然对数，或简单地以 10 为底对数）

示例
如果 X=5 且 Y=6

X * Y = 30

ln(5) + ln(6) = 3.4

ln(30) = 3.4

e^3.4 = 30，5 x 6 也是如此

经验（3.4）= 30

所以上面，如果 5 和 6 各占表中的一行，我们取每个值的自然对数，对各行求和，然后取和的指数得到 30。

下面是 SQL Server 的 SQL 语句中的代码。可能需要进行一些编辑才能使其在 Oracle 上运行。希望这不是一个很大的区别，但我怀疑至少 CASE 语句在 Oracle 上是不一样的。您会注意到那里有一些额外的东西来测试该行的符号是否为负。

```
CREATE TABLE DUAL (VAL INT NOT NULL)
INSERT DUAL VALUES (3)
INSERT DUAL VALUES (5)
INSERT DUAL VALUES (2)

    SELECT 
           CASE SUM(CASE WHEN SIGN(VAL) = -1 THEN 1 ELSE 0 END) % 2 
               WHEN 1 THEN -1 
               ELSE 1 
           END
         * CASE 
                WHEN SUM(VAL) = 0           THEN 0 
                WHEN SUM(VAL) IS NOT NULL   THEN EXP(SUM(LOG(ABS(CASE WHEN SIGN(VAL) <> 0 THEN VAL END)))) 
                ELSE NULL 
           END
         * CASE MIN(ABS(VAL)) WHEN 0 THEN 0 ELSE 1 END
        AS PRODUCT 
      FROM DUAL 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-09-16T07:59:12.810

[tuinstoel 接受](https://stackoverflow.com/a/404761/521799)的答案当然是正确的：

```
select exp(sum(ln(col)))
  from table; 
```

但请注意，如果`col`是 type `NUMBER`，则在使用时会发现*巨大*的性能提升`BINARY_DOUBLE`。理想情况下，您`BINARY_DOUBLE`的表中应该有一列，但如果这不可能，您仍然可以`col`转换为`BINARY_DOUBLE`. [我在这里记录的一个简单测试中得到了 100 倍的改进](https://blog.jooq.org/2019/09/11/oracles-binary_double-can-be-much-faster-than-number/)，对于这个演员：

```
select exp(sum(ln(cast(col as binary_double))))
  from table; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-02-08T22:16:03.117

> 有没有一种合理的技术可以让你模拟它？

一种技术可以`LISTAGG`用来生成 product_expression 字符串和`XMLTABLE`+`GETXMLTYPE`来评估它：

```
WITH cte AS (
  SELECT grp, LISTAGG(l, '*') AS product_expression
  FROM t
  GROUP BY grp
)
SELECT c.*, s.val AS product_value
FROM cte c
CROSS APPLY(
    SELECT *
    FROM XMLTABLE('/ROWSET/ROW/*' 
         PASSING dbms_xmlgen.getXMLType('SELECT ' || c.product_expression || ' FROM dual')
         COLUMNS val NUMBER PATH '.')
) s; 
```

**[db<>小提琴演示](https://dbfiddle.uk/?rdbms=oracle_18&fiddle=fa22a22ea196d02ca3d7d8a0f3896d2b)**

输出：

```
+------+---------------------+---------------+
| GRP  | PRODUCT_EXPRESSION  | PRODUCT_VALUE |
+------+---------------------+---------------+
| b    | 2*6                 |            12 |
| a    | 3*5*7               |           105 |
+------+---------------------+---------------+ 
```

* * *

处理组中单个 NULL 值的更强大的版本：

```
WITH cte AS (
  SELECT grp, LISTAGG(l, '*') AS product_expression
  FROM t
  GROUP BY grp
)
SELECT c.*, s.val AS product_value
FROM cte c
OUTER APPLY(
   SELECT *
   FROM XMLTABLE('/ROWSET/ROW/*' 
        passing dbms_xmlgen.getXMLType('SELECT ' || c.product_expression || ' FROM dual')
        COLUMNS val NUMBER PATH '.')
   WHERE c.product_expression IS NOT NULL
) s; 
```

**[db<>小提琴演示](https://dbfiddle.uk/?rdbms=oracle_18&fiddle=883963d0637e37e3263a6a78cdf8b8c4)**

`*`CROSS/OUTER APPLY(Oracle 12c) 用于方便，可以用嵌套子查询替换。

* * *

**这种方法可用于生成不同的聚合函数。**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T20:47:57.767

“SQL”有许多不同的实现。当您说“sql 有”时，您指的是特定的 ANSI 版本的 SQL，还是特定于供应商的实现。DavidB 的答案是在我测试过的几种不同环境中工作的答案，但根据您的环境，您可以编写或找到与您所要求的完全一样的功能。假设您使用的是 Microsoft SQL Server 2005，那么一个可能的解决方案是在 .net 代码中编写一个名为 PRODUCT 的自定义聚合器，它可以让您的原始查询完全按照您编写的方式工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-24T00:11:03.157

在 c# 中，您可能必须这样做：

```
SELECT EXP(SUM(LOG([col]))) 
  FROM table; 
```

# c++ - 哪个编译器对于以下重载/专业化行为是正确的？

> ID：403929
> 
> 赞同：4
> 
> 时间：2008-12-31T19:57:57.510
> 
> 标签：c++, standards, specialization, overloading

考虑以下代码：

```
#include <stdio.h>

namespace Foo {
  template <typename T>
  void foo(T *, int) { puts("T"); }

  template <typename T>
  struct foo_fun {
    static void fun() { foo((T *)0, 0); };
  };
}

namespace Foo {
  void foo(int *, int) { puts("int"); }
}

using namespace Foo;

int main() {
  foo_fun<int> fun;
  fun.fun();
} 
```

预期的输出是多少？“T”还是整数？

一个编译器（来自 Apple Xcode 3.1.2 的 gcc 4.0.1）输出“int”，另外两个编译器（gcc 4.1.2 和 4.1.3）输出“T”。

如果我在 foo(T *, int) 版本之前移动 foo(int *, int) 声明/定义，则所有输出“int”。在这种情况下，重载/专业化的顺序是否由当前标准定义？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-31T20:16:37.800

第二个`void foo(...`是重载（而不是特化），它在定义中不可见，`foo_fun::fun`因此不会在模板定义的上下文中找到。因为`T*`是依赖类型，`foo`表达式中的解析`foo((T*)0, 0)`将延迟到模板实例化时间，并且实例化的上下文也将被考虑。但是，标准的 14.6.4.2 规定，如果函数名称是非*限定 ID*而不是*模板 ID*，则对于非 ADL 查找，仅考虑在模板定义点可见的函数。命名空间中没有函数参数，`Foo`因此不会发生依赖于参数的查找，因此模板版本`foo`被调用而不是非模板重载。

非常感谢 litb 对此答案的更正。

如果您将其设为如下特化，则由于在模板实例化时选择了特化，因此只要相关特化在函数模板第一次实例化时可见，就可以调用特化`int`。

```
namespace Foo {
    template<>
    void foo<int>(int *, int) { puts("int"); }
} 
```

当前标准的第 14 章，但可读性不强:)

Edit: If I had to pick the most relevant part of the standard it would probably be 14.6 [temp.res] para 9\. (Slightly abbreviated) If a name does not depend on a *template-parameter*, a declaration for that name shall be in scope at the point at where the name appears in the template definition; the name is bound to the declaration found at that point and this binding is not affected by declarations that are visible at the point of instantiation.

Edit, edit: But you also need to take into account 14.6.4.2 [temp.dep.candidate]. It is very difficult and dangerous to try and reference the standard because of all the interdependencies, this answer is a case in point.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T20:30:16.743

As a general rule, of two versions of a compiler, the later is more likely to be more standard.

# python - All code in one file

> ID：403934
> 
> 赞同：4
> 
> 时间：2008-12-31T19:59:29.330
> 
> 标签：python, version-control, project-management

After asking [organising my Python project](https://stackoverflow.com/questions/391879/organising-my-python-project) and then [calling from a parent file in Python](https://stackoverflow.com/questions/403822/calling-from-a-parent-file-in-python) it's occurring to me that it'll be so much easier to put all my code in one file (data will be read in externally).

I've always thought that this was bad project organisation but it seems to be the easiest way to deal with the problems I'm thinking I will face. Have I simply gotten the wrong end of the stick with file count or have I not seen some great guide on large (for me) projects?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-31T20:04:33.643

If you are planning to use any kind of SCM then you are going to be screwed. Having one file is a guaranteed way to have lots of collisions and merges that will be painstaking to deal with over time.

Stick to conventions and break apart your files. If nothing more than to save the guy who will one day have to maintain your code...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-31T20:11:12.413

If your code is going to work together all the time anyway, and isn't useful separately, there's nothing wrong with keeping everything in one file. I can think of at least popular package (BeautifulSoup) that does this. Sure makes installation easier.

Of course, if it seems, down the road, that you could use part of your code with another project, or if maintainance starts to be an issue, then worry about organizing your project differently.

It seems to me from the questions you've been asking lately that you're worrying about all of this a bit prematurely. Often, for me, these sorts of issues are better tackled a little later on in the solution. Especially for smaller projects, my goal is to get a solution that is correct, and *then* optimal.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-31T20:14:52.157

It's always a now verses then argument. If you're under the gun to get it done, do it. Source control will be a problem later, as with many things there's no black and white answer. You need to be responsible to both your deadline and the long term maintenance of the code.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-31T20:40:50.497

If that's the best way to organise it, you're probably doing something wrong.

If it's more than just a toy program or a simple script, then you should break it up into separate files, etc. It's the only sane way of doing it. When your project gets big enough that you need someone else helping on it, then it will make the SCM a whole bunch easier.

Additionally, sooner or later you are going to need to add a separate utility to your project, that is going to need some common code/structures. It's far easier to do this if you have separate source files than if you have just one big one.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-31T21:42:25.177

Since [Calling from a parent file in Python](https://stackoverflow.com/questions/403822/calling-from-a-parent-file-in-python) indicates serious design problems, I'd say that you have two choices.

1.  Don't have a library module try to call back to main. You'll have to rewrite things to fix this.

    [An imported component calling the main program is an improper dependency. And Python doesn't support it because it's a poor design.]

2.  Put it all in one file until you figure out a better design with proper one-way dependencies. Then you'll have to rewrite it to fix the dependency problems.

A module (a single file) should be a logical piece of related code. Not everything. Not a single class definition. There's a middle ground of modularity.

Additionally, there should be a proper one-way dependency graph from main program to components (which do NOT depend on the main program) to utility libraries and what-not (that do not know about the components OR the main program.

Circular (or mutual) dependencies often indicate a design problem. Callbacks are one way out of the problem. Another way is to decompose the circular elements to get a proper one-way graph.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-31T23:02:44.623

Looking at your earlier questions I would say **all code in one file would be a good intermediate state** on the way to a **complete refactoring of your project**. To do this you'll need a **regression test suite** to make sure you don't break the project while refactoring it.

**Once all your code is in one file**, I suggest iterating on the following:

1.  Identify a small group of interdependent classes.

2.  Pull those classes into a separate file.

3.  **Add unit tests** for the new separate file.

4.  Retest the entire project.

Depending on the size of your project, **it shouldn't take too many iterations** for you to reach something reasonable.

# wcf - 如何为启用 Silverlight 的 WCF 服务配置仅获取属性

> ID：403943
> 
> 赞同：2
> 
> 时间：2008-12-31T20:04:22.393
> 
> 标签：wcf, silverlight, service, properties

我不确定错误是在哪里导致的（来自silverlight、来自wcf、其他......）但是，我有一个从Silverlight 调用的WCF 服务。该方法返回一个类，其属性没有设置器。这会引发错误。如果我向属性添加一个设置器，那么它不会给出错误。

该错误是通常难以理解且无用的 Silverlight 错误消息，但是...

```
[Serializable]  
[DataContract]  
public SomeClass {  
    DataMember]  
    public string PropertyA { get; set; }  
    public string PropertyB { get { return "Hi There"; } }  
} 
```

抛出错误...

但将其更改为：

```
[Serializable]  
[DataContract]  
public SomeClass {  
     [DataMember]  
     public string PropertyA { get; set; }  
     public string PropertyB { get { return "Hi There"; } set {} }  
} 
```

没有错误。

包括通常的 ISomeService.svc 和 SomeService.svc 类、在 Silverlight 中调用客户端异步等更新的引用等。

配置属性（“DataMember”以外的某些属性以允许仅获取或私有设置属性）通过网络传递它的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-02T19:19:03.987

谢谢。私人套装似乎就足够了。我不喜欢在不需要时使用 set 方法，但如果访问它，我会抛出错误。

```
[DataMember]  
public PropertyB {  
    get {  
         return "Hi there";  
    }  
    private set {  
         throw new Exception("Empty setter for use by WCF Service.");
    }  
} 
```

管他呢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T08:23:53.120

在您的示例中，PropertyB 未使用 DataMember 属性进行标记，这意味着它不会在 WSDL 中公开并被序列化程序忽略。但是，如果您使用 DataMember 标记 PropertyB，那么您必须有一个 setter（私有、受保护或公共）才能正确序列化它，否则您可能会遇到异常。有两种方法可以考虑通过网络对只读属性进行序列化：

```
[DataContract]
public class SomeClass
{ 
    public SomeClass()
    {
        _propertyB = "Hi there";
    }

    [DataMember(Name="PropertyB")]
    private readonly string _propertyB;

    public string PropertyB
    {
        get { return _propertyB; }
    }
} 
```

或这个：

```
[DataContract]
public class SomeClass
{ 
    public SomeClass()
    {
        PorpertyB = "Hi there";
    }

    [DataMember]
    public string PropertyB
    {
        get;
        private set;
    }
} 
```

请注意，如果您使用[svcutil.exe](http://msdn.microsoft.com/en-us/library/aa347733.aspx)，生成的代理类将同时具有公共 getter 和 setter 属性，这可能不是您要查找的。在这种情况下，您可以在客户端使用服务合同和数据合同程序集。

# c++ - 试图摆脱 C++ 增强警告

> ID：403946
> 
> 赞同：5
> 
> 时间：2008-12-31T20:08:24.197
> 
> 标签：c++, boost

每当我在我的项目中加入 boost 时，我都会收到一百万条这样的警告。有谁知道我怎样才能摆脱警告？

> ../depends\boost/config/abi_prefix.hpp(19) : 警告 C4103: 'depends\boost\config\abi_prefix.hpp' : 包含标题后对齐方式发生变化，可能是由于缺少 #pragma pack(pop)

我知道我可以执行#pragma 来禁用警告，但我想知道这些警告的原因。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-31T20:15:18.630

原因是 boost 不会在每个需要打包数据的文件中推送/弹出这些 pragma。他们#include 一个单独的文件进行推送（abi_prefix.hpp），然后是另一个（abo_suffix.hp），然后进行弹出。

这允许他们在任何地方重用相同的#pragma pack 代码，这很方便，因为它可能因编译器而异。

虽然它是完全安全的。#pragma push 后面跟着一个 pop，它只是包含在不同的文件中。因此，您可能应该禁用该错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T20:27:53.330

是的，您可以从 config/abi/msvc_prefix.hpp 中的#pragma pack 指令中得到它。这表明你的项目的默认打包不是8。这很不寻常，这是故意的吗？由于包装差异导致的错误可能有点难以诊断。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T01:22:24.517

我找到了摆脱这个警告的方法。

您需要编辑文件 boost_1_**\boost\config\user.hpp 并使用 BOOST_DISABLE_ABI_HEADERS 取消注释该行

所以你应该在这个文件中定义：

```
#define BOOST_DISABLE_ABI_HEADERS 
```

完成后，只需[像往常一样使用 bjam 构建](https://stackoverflow.com/questions/289909/boost-137)。

**请参阅下面的评论以了解此解决方案的危险**

# javascript - 如何引用加载当前执行脚本的脚本标签？

> ID：403967
> 
> 赞同：351
> 
> 时间：2008-12-31T20:22:12.687
> 
> 标签：javascript, element, parent

如何引用加载当前正在运行的 javascript 的脚本元素？

这是情况。我在页面的高处加载了一个“主”脚本，首先是在 HEAD 标记下。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script type="text/javascript" src="scripts.js"></script> 
```

“scripts.js”中有一个脚本，需要能够按需加载其他脚本。普通方法对我来说不太适用，因为我需要在不引用 HEAD 标记的情况下添加新脚本，因为 HEAD 元素尚未完成渲染：

```
document.getElementsByTagName('head')[0].appendChild(v); 
```

我想要做的是引用加载当前脚本的脚本元素，这样我就可以将新的动态加载的脚本标签附加到它之后的 DOM 中。

```
<script type="text/javascript" src="scripts.js"></script>
loaded by scripts.js--><script type="text/javascript" src="new_script1.js"></script>
loaded by scripts.js --><script type="text/javascript" src="new_script2.js"></script> 
```

* * *

## 回答 #1

> 赞同：764
> 
> 时间：2014-03-30T15:02:49.060

# 如何获取当前脚本元素：

# 1.使用`document.currentScript`

[`document.currentScript`](https://developer.mozilla.org/en-US/docs/Web/API/document.currentScript)将返回`<script>`当前正在处理其脚本的元素。

```
<script>
var me = document.currentScript;
</script> 
```

### 好处

*   简单明了。可靠的。
*   不需要修改脚本标签
*   适用于异步脚本 ( `defer`& `async`)
*   适用于动态插入的脚本

### 问题

*   不适用于旧版浏览器和 IE。
*   不适用于模块`<script type="module">`

# 2.通过id选择脚本

给脚本一个 id 属性将使您可以轻松地从 using 中通过 id 选择它[`document.getElementById()`](https://developer.mozilla.org/en-US/docs/Web/API/document.getElementById)。

```
<script id="myscript">
var me = document.getElementById('myscript');
</script> 
```

### 好处

*   简单明了。可靠的。
*   几乎普遍支持
*   适用于异步脚本 ( `defer`& `async`)
*   适用于动态插入的脚本

### 问题

*   需要向脚本标签添加自定义属性
*   `id`在某些边缘情况下，属性可能会导致某些浏览器中的脚本出现奇怪的行为

# 3.使用`data-*`属性选择脚本

给脚本一个[`data-*`](https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Using_data_attributes)属性将使您可以轻松地从内部选择它。

```
<script data-name="myscript">
var me = document.querySelector('script[data-name="myscript"]');
</script> 
```

与之前的选项相比，这几乎没有什么好处。

### 好处

*   简单明了。
*   适用于异步脚本 ( `defer`& `async`)
*   适用于动态插入的脚本

### 问题

*   需要向脚本标签添加自定义属性
*   HTML5，`querySelector()`并非在所有浏览器中都兼容
*   不如使用`id`属性得到广泛支持
*   将解决`<script>`边缘`id`情况。
*   如果页面上的另一个元素具有相同的数据属性和值，可能会感到困惑。

# 4.通过src选择脚本

您可以使用选择器按源选择脚本，而不是使用数据属性：

```
<script src="//example.com/embed.js"></script> 
```

在 embed.js 中：

```
var me = document.querySelector('script[src="//example.com/embed.js"]'); 
```

### 好处

*   可靠的
*   适用于异步脚本 ( `defer`& `async`)
*   适用于动态插入的脚本
*   无需自定义属性或 ID

### 问题

*   不适用于本地**脚本**
*   会在不同的环境中引起问题，例如开发和生产
*   静态而脆弱。更改脚本文件的位置将需要修改脚本
*   不如使用`id`属性得到广泛支持
*   如果您两次加载相同的脚本会导致问题

# 5.遍历所有脚本以找到您想要的

我们还可以遍历每个脚本元素并单独检查每个元素以选择我们想要的：

```
<script>
var me = null;
var scripts = document.getElementsByTagName("script")
for (var i = 0; i < scripts.length; ++i) {
    if( isMe(scripts[i])){
      me = scripts[i];
    }
}
</script> 
```

这让我们可以在不太支持`querySelector()`属性的旧浏览器中使用之前的两种技术。例如：

```
function isMe(scriptElem){
    return scriptElem.getAttribute('src') === "//example.com/embed.js";
} 
```

这继承了采用任何方法的优点和问题，但不依赖`querySelector()`于旧浏览器。

# 6.获取最后执行的脚本

由于脚本是按顺序执行的，最后一个脚本元素通常是当前正在运行的脚本：

```
<script>
var scripts = document.getElementsByTagName( 'script' );
var me = scripts[ scripts.length - 1 ];
</script> 
```

### 好处

*   简单的。
*   几乎普遍支持
*   无需自定义属性或 ID

### 问题

*   不适用于**异步**脚本 ( `defer`& `async`)
*   不适用于动态插入的**脚本**

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2010-07-24T19:29:04.380

由于脚本是按顺序执行的，因此当前执行的脚本标签始终是页面上的最后一个脚本标签。因此，要获取脚本标签，您可以执行以下操作：

```
var scripts = document.getElementsByTagName( 'script' );
var thisScriptTag = scripts[ scripts.length - 1 ]; 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-31T20:29:42.110

可能最简单的事情就是给你的脚本标签一个`id`属性。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2010-09-12T16:56:02.407

仅当脚本没有“defer”或“async”属性时才会按顺序执行。在这些情况下，了解脚本标记的可能 ID/SRC/TITLE 属性之一也可以工作。所以 Greg 和 Justin 的建议都是正确的。

`document.currentScript`WHATWG 列表中已经有一个提案。

**编辑**：Firefox > 4 已经实现了这个非常有用的属性，但它在 IE11 中不可用，我上次检查过，仅在 Chrome 29 和 Safari 8 中可用。

**编辑**：没有人提到“document.scripts”集合，但我相信以下可能是获取当前正在运行的脚本的一个很好的跨浏览器替代方案：

```
var me = document.scripts[document.scripts.length -1]; 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-09-13T15:29:55.577

这是一个 polyfill，`document.CurrentScript`如果它存在，它会利用它并回退到通过 ID 查找脚本。

```
<script id="uniqueScriptId">
    (function () {
        var thisScript = document.CurrentScript || document.getElementByID('uniqueScriptId');

        // your code referencing thisScript here
    ());
</script> 
```

如果您在每个脚本标记的顶部包含它，我相信您将能够始终如一地知道正在触发哪个脚本标记，并且您还可以在异步回调的上下文中引用脚本标记。

未经测试，因此如果您尝试，请留下反馈给其他人。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-10-18T00:59:01.503

它必须在页面加载和使用 javascript 添加脚本标记时工作（例如使用 ajax）

```
<script id="currentScript">
var $this = document.getElementById("currentScript");
$this.setAttribute("id","");
//...
</script> 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-02-25T02:24:41.887

要获取脚本，您可以使用当前加载的脚本

```
var thisScript = document.currentScript; 
```

您需要在脚本的开头保留引用，以便稍后调用

```
var url = thisScript.src 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-02-26T07:44:44.427

按照以下简单步骤获取对当前正在执行的脚本块的引用：

1.  在脚本块中放置一些随机的唯一字符串（在每个脚本块中必须是唯一的/不同的）
2.  迭代 document.getElementsByTagName('script') 的结果，查看每个内容的唯一字符串（从 innerText/textContent 属性获得）。

*示例（ABCDE345678 是唯一 ID）*：

```
<script type="text/javascript">
var A=document.getElementsByTagName('script'),i=count(A),thi$;
for(;i;thi$=A[--i])
  if((thi$.innerText||thi$.textContent).indexOf('ABCDE345678'))break;
// Now thi$ is refer to current script block
</script> 
```

顺便说一句，对于您的情况，您可以简单地使用老式的 document.write() 方法来包含另一个脚本。正如您提到的 DOM 尚未呈现，您可以利用浏览器始终以线性顺序执行脚本的事实（除了稍后将呈现的延迟脚本），因此您的文档的其余部分仍然“不存在”。您通过 document.write() 编写的任何内容都将放在调用者脚本之后。

*原始 HTML 页面示例*：

```
<!doctype html>
<html><head>
<script src="script.js"></script>
<script src="otherscript.js"></script>
<body>anything</body></html> 
```

*script.js 的内容*：

```
document.write('<script src="inserted.js"></script>'); 
```

渲染后，DOM结构会变成：

```
HEAD
  SCRIPT script.js
  SCRIPT inserted.js
  SCRIPT otherscript.js
BODY 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-08-06T21:32:13.023

处理异步和延迟脚本的一种方法是利用 onload 处理程序 - 为所有脚本标签设置一个 onload 处理程序，第一个执行的应该是你的。

```
function getCurrentScript(callback) {
  if (document.currentScript) {
    callback(document.currentScript);
    return;
  }
  var scripts = document.scripts;
  function onLoad() {
    for (var i = 0; i < scripts.length; ++i) {
      scripts[i].removeEventListener('load', onLoad, false);
    }
    callback(event.target);
  }
  for (var i = 0; i < scripts.length; ++i) {
    scripts[i].addEventListener('load', onLoad, false);
  }
}

getCurrentScript(function(currentScript) {
  window.console.log(currentScript.src);
}); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-06-12T18:43:55.030

考虑这个算法。当您的脚本加载时（如果有多个相同的脚本），请查看 document.scripts，找到具有正确“src”属性的第一个脚本，并将其保存并使用数据属性或唯一类名将其标记为“已访问”。

当下一个脚本加载时，再次扫描 document.scripts，传递任何已标记为已访问的脚本。获取该脚本的第一个未访问实例。

这假设相同的脚本可能会按照它们的加载顺序执行，从头到体，从上到下，从同步到异步。

```
(function () {
  var scripts = document.scripts;

  // Scan for this data-* attribute
  var dataAttr = 'data-your-attribute-here';

  var i = 0;
  var script;
  while (i < scripts.length) {
    script = scripts[i];
    if (/your_script_here\.js/i.test(script.src)
        && !script.hasAttribute(dataAttr)) {

        // A good match will break the loop before
        // script is set to null.
        break;
    }

    // If we exit the loop through a while condition failure,
    // a check for null will reveal there are no matches.
    script = null;
    ++i;
  }

  /**
   * This specific your_script_here.js script tag.
   * @type {Element|Node}
   */
  var yourScriptVariable = null;

  // Mark the script an pass it on.
  if (script) {
    script.setAttribute(dataAttr, '');
    yourScriptVariable = script;
  }
})(); 
```

这将扫描所有脚本以查找未标记特殊属性的第一个匹配脚本。

然后使用数据属性标记该节点（如果找到），以便后续扫描不会选择它。这类似于图遍历 BFS 和 DFS 算法，其中节点可能被标记为“已访问”以防止重新访问。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-31T21:12:16.627

我有这个，它在 FF3、IE6 和 7 中工作。在页面加载完成之前，按需加载脚本中的方法不可用，但这仍然非常有用。

```
//handle on-demand loading of javascripts
makescript = function(url){
    var v = document.createElement('script');
    v.src=url;
    v.type='text/javascript';

    //insertAfter. Get last <script> tag in DOM
    d=document.getElementsByTagName('script')[(document.getElementsByTagName('script').length-1)];
    d.parentNode.insertBefore( v, d.nextSibling );
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-09-08T00:15:04.003

`script`我使用这种通常的替代方法动态插入标签，并在添加到 DOM 之前`eval`简单地设置一个全局属性。`currentComponentScript`

```
 const old = el.querySelector("script")[0];
  const replacement = document.createElement("script");
  replacement.setAttribute("type", "module");
  replacement.appendChild(document.createTextNode(old.innerHTML));
  window.currentComponentScript = replacement;
  old.replaceWith(replacement); 
```

虽然不能循环工作。DOM 在下一个宏任务之前不会运行脚本，因此它们中的一批只会看到最后一个值集。您必须阅读`setTimeout`整个段落，然后`setTimeout`在前一个完成后的下一个段落。即链接setTimeouts，而不仅仅是`setTimeout`从循环中连续多次调用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-11-11T02:05:20.970

如果您可以假设脚本的文件名，则可以找到它。到目前为止，我只在 Firefox 中真正测试过以下功能。

```
 function findMe(tag, attr, file) {
    var tags = document.getElementsByTagName(tag);
    var r = new RegExp(file + '$');
    for (var i = 0;i < tags.length;i++) {
      if (r.exec(tags[i][attr])) {
        return tags[i][attr];
      }
    }
  };
  var element = findMe('script', 'src', 'scripts.js'); 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2018-08-20T18:22:17.597

我发现以下代码是最一致、最高效且最简单的。

```
var scripts = document.getElementsByTagName('script');
var thisScript = null;
var i = scripts.length;
while (i--) {
  if (scripts[i].src && (scripts[i].src.indexOf('yourscript.js') !== -1)) {
    thisScript = scripts[i];
    break;
  }
}
console.log(thisScript); 
```

# soap - 我对 SOAP 命名空间感到困惑

> ID：403980
> 
> 赞同：79
> 
> 时间：2008-12-31T20:26:33.800
> 
> 标签：soap

我正在学习 SOAP 实现，并且对 SOAP 1.2 信封的适当名称空间 URI 感到有些困惑。

SOAP的[w3c 规范](http://www.w3.org/TR/soap12-part1)引用了`"http://www.w3.org/2003/05/soap-envelope"`命名空间。但是，我看到了其他引用`"http://schemas.xmlsoap.org/soap/envelope/"`命名空间的示例。

在我看来，应该使用一个或另一个命名空间。这两个中哪一个是要使用的正确命名空间 URI？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-01-01T00:58:26.390

它与 SOAP 版本有关。SOAP 1.2 使用`http://www.w3.org/2003/05/soap-envelope`命名空间，而 SOAP 1.1 使用`http://schemas.xmlsoap.org/soap/envelope/`.

有关参考，请参阅[http://www.w3.org/TR/soap/](http://www.w3.org/TR/soap/)并查看不同版本规范中的信封部分。

此外，您可以浏览到每个信封 URL 并检查版本号以准确查看您使用的规范版本。**********```