# StackOverflow 问答 000245000-000245999

# winapi - 通过 API 设置菜单热键的下划线（windows）

> ID：245012
> 
> 赞同：3
> 
> 时间：2008-10-28T21:51:53.220
> 
> 标签：winapi

默认情况下，Windows (XP)仅在按下 ALT 时显示**带下划线的热键。**这可以在子对话框“效果”中的显示属性中进行更改，以便热键**始终带有下划线**

如何以编程方式更改它？可以使用哪个 API 调用或注册表设置来更改此设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T23:13:12.607

我找到了解决方案，如何查询和设置：

```
BOOL b
SystemParametersInfo(SPI_GETKEYBOARDCUES, 0, &b, 0);
if (!b) {
    b = TRUE;
    SystemParametersInfo(SPI_SETKEYBOARDCUES, 0, &b, 0);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T22:40:49.703

你的意思是你想改变这个系统范围的设置，或者你想能够只覆盖你的程序中的行为？

如果是后者并且您使用的是 Win32 API，看起来您可能能够捕获 WM_CHANGEUISTATE 通知：http: [//blogs.msdn.com/oldnewthing/archive/2005/05/03/414317.aspx](http://blogs.msdn.com/oldnewthing/archive/2005/05/03/414317.aspx)我我自己没有尝试过，但似乎可行。

如果你的目标是前者，我还没有找到方法。

# c# - 400: BadRequest with .Net Mass Downloader 1.5.0.1

> ID：245019
> 
> 赞同：1
> 
> 时间：2008-10-28T21:53:39.767
> 
> 标签：c#, .net, visual-studio-2008

Has anybody else had trouble with getting the .Net Framework source code? Google doesn't have anything to say about this error message, and neither does the CodePlex issue tracker.

Here is the command I'm using to get the source code for the modules that make up mscorlib.dll. Am I doing something obviously wrong?

NetMassDownloader.exe -o source -f "C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorlib.dll"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T16:49:13.260

400 Bad Request 错误是一个 HTTP 状态代码，这意味着您发送到网站服务器的请求格式不正确，因此服务器无法理解或处理该请求。

解析度

1.  检查 URL 中的错误。400 Bad Request 错误的最常见原因是 URL 输入错误或点击的链接指向的 URL 存在某种错误。

2.  虽然很少见，但 400 Bad Request 错误可能是您尝试访问的网站服务器的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T16:52:13.940

在另一台计算机上下载它并将该文件夹复制/粘贴到您自己的计算机上。我的工具也有类似的问题，这就是我的解决方法。

# c# - 为什么 User.IsInRole 在这种情况下不起作用？

> ID：245027
> 
> 赞同：3
> 
> 时间：2008-10-28T21:56:21.680
> 
> 标签：c#, asp.net, authentication, roles

...我想在用户是管理员时显示“删除”按钮，并在用户是贡献者时显示“添加项目”按钮：

```
<!-- More code above -->
<asp:BoundField DataField="Description" HeaderText="Description" SortExpression="Description" />
            <asp:TemplateField ShowHeader="False">
                <ItemTemplate>
                    <asp:LinkButton CSSClass="TableRightLink" ID="LinkButton1" runat="server" CausesValidation="False" CommandName="Delete"
                        Visible=<%# User.IsInRole(@"DOMAIN\CMDB_ADMIN") %>
                        Text="Delete" 
                        OnClientClick="return confirm('Are you certain you want to delete this item?');"></asp:LinkButton>
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
        <SelectedRowStyle VerticalAlign="Top" />
        <HeaderStyle ForeColor="White" CssClass="TableHeader" BackColor="SteelBlue" />
    </asp:GridView>
    <asp:table width="100%" runat="server" CSSclass="PromptTable" Visible=<%# User.IsInRole(@"DOMAIN\CMDB_CONTRIBUTE") %> >
    <asp:tablerow><asp:tablecell HorizontalAlign=Center>
      <asp:HyperLink ID="HyperLink1" runat="server" NavigateUrl="AddConfigItem.aspx" ForeColor="LightCyan">Add Item</asp:HyperLink>
    </asp:tablecell></asp:tablerow></asp:table> 
```

删除按钮“可见”属性工作正常。但是，“添加项目”超链接没有。它总是显示。查看源告诉我 %# User.IsInRole(@"DOMAIN\CMDB_CONTRIBUTE") %> 没有评估任何东西。知道这是为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T23:33:29.300

尝试在 Page_Load 中的代码后面而不是标记中设置它。假设 id 是 promptTable （在您的示例中没有给出），只需添加：

```
promptTable.Visible = User.IsInRole(@"DOMAIN\CMDB_CONTRIBUTE"); 
```

大概无论是否是回发，都需要这样做。

FWIW，@Keltex 关于控件没有被数据绑定是正确的，因此`<%# %>`无法正常工作。不幸的是，`<%= %>`语法也不会，因为它总是返回一个字符串，你需要一个布尔值。我找不到在这种情况下可以使用的任何其他语法。您可能可以通过使用 javascript 关闭显示来做到这一点，但我怀疑如果表格不在正确的组中，您不希望将表格呈现到页面上（而不是在客户）。在后面的代码中做这件事，我认为是正确的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T21:58:22.083

尝试：

```
Visible='<%= User.IsInRole(@"DOMAIN\CMDB_CONTRIBUTE") %>' 
```

asp:table 似乎没有数据绑定。

# visual-studio - 你用什么来开发 PowerShell？

> ID：245043
> 
> 赞同：11
> 
> 时间：2008-10-28T22:03:22.243
> 
> 标签：visual-studio, powershell

我没有看到它的 Visual Studio 插件（虽然我看起来不那么难，所以我可能错过了它），并且搜索出现了随机的第三方解决方案，但是 PowerShell 或其他东西有什么插入 Visual Studio？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-28T22:32:18.503

Visual Studio 模板可[在此处](http://channel9.msdn.com/playground/Sandbox/249904-Windows-PowerShell-Visual-Studio-2005-Templates-C-and-VBNET/)获得。Server 2008 SDK 中有用于开发提供程序和主机的示例。

如果您正在谈论用于脚本的 IDE，请参阅[此问题（如何开始使用 PowerShell）](https://stackoverflow.com/questions/33559/how-to-get-started-with-powershell)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T06:38:41.917

我主要使用 PowerGui 脚本编辑器。它允许我使用多文件编辑和调试以及直接命令行的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T22:25:28.550

PowerShell v2 CTP 有一个不错的 GUI 界面，其中包括运行多个运行空间以及编辑和运行脚本的能力。脚本编辑器具有语法高亮功能，非常有用。PSH v2 还具有其他有用的功能，例如脚本 cmdlet。这很酷。PowerGUI 应该也很整洁，虽然我没有亲自使用过。虽然在 PSH v2 之前，我曾经将 Textpad 与为 PowerShell 的预发布版本 - Monad 创建的语法文件一起使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T22:31:15.883

您是否看过[powershell.com](http://powershell.com/)，其中有一些[令人兴奋的评论](http://www.hanselman.com/blog/FreePowerShellIDE.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-29T13:41:28.123

PS的美妙之处在于命令行。老实说，我的大部分开发工作都是在命令行上完成的。使用来自 //\O// 的[PowerTab](http://thepowershellguy.com/blogs/posh/archive/2007/10/28/powertab-version-0-99-beta-2-released.aspx)管理单元，我拥有与我在任何 PS IDE 中找到的一样好的智能感知。一旦我在命令行中完成了所有部分，然后我使用[VIM](http://www.vim.org/)将它们全部放入脚本中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T19:43:46.253

Sapien 的 PrimalScript 很好。不过是收费的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-26T17:05:51.853

取决于您所说的“发展”是什么意思。

无需编写脚本即可从命令行非常有效地使用 PowerShell。但是，如果您确实接触过脚本，产品包括 PowerShell Plus、PrimalScript 和 PowerGUI。

如果您正在开发 cmdlet 和管理单元，Visual Studio 不需要任何插件，但您确实需要 Windows SDK 中可用的参考程序集。

Visual Studio 没有计划将 PowerShell 作为脚本编辑器托管 - Visual Studio 团队认为大多数管理员不会拥有 Visual Studio，他们的目标是制作更好的开发工具，而不是脚本工具（这在您需要更高效的功能）。因此，不要期待 PowerShell 脚本出现在 Visual Studio 中，至少在不久的将来不会。有一些第三方的东西可以把它放进去，但没有我上面列出的专用脚本编辑器那么好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-29T19:57:48.237

ISE 是 PowerShell 附带的（因此您无需安装任何东西）。这就是你如何得到它。

1.  从开始菜单转到 Powershell 命令行。
2.  键入 ise ，您应该会看到如下内容：

![在此处输入图像描述](https://i.stack.imgur.com/f0cRU.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-06-29T21:47:01.633

实际上，我发现在 Powershell 中编写脚本时，Notepad++ 对我非常有用。我发现使用智能标记（包括 If-Then-Else 和 For 循环标记）更容易导航和直观地理解脚本的整体流程。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-12-14T06:19:22.200

Sapiens Powershell Studio 2012 - 最好的 Powershell 特定 IDE。

[http://www.sapien.com/software/powershell_studio](http://www.sapien.com/software/powershell_studio)

# c# - 将关闭按钮（红色 x）添加到 .NET 工具提示

> ID：245045
> 
> 赞同：12
> 
> 时间：2008-10-28T22:03:51.510
> 
> 标签：c#, .net, winforms, tooltip

我正在寻找一种将关闭按钮添加到类似于 NotifyIcon 的.NET ToolTip 对象的方法。我将工具提示用作使用 Show() 方法以编程方式调用的消息气球。这很好用，但没有 onclick 事件或关闭工具提示的简单方法。您必须在代码中的其他地方调用 Hide() 方法，我希望工具提示能够自行关闭。我知道网络上有几个气球工具提示，它们使用管理和非托管代码通过 Windows API 执行此操作，但我宁愿呆在我舒适的 .NET 世界中。我有一个调用我的 .NET 应用程序的第三方应用程序，它在尝试显示非托管工具提示时崩溃。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-28T22:31:46.057

您可以尝试通过覆盖现有的工具提示窗口并自定义 onDraw 函数来实现自己的工具提示窗口。我从未尝试过添加按钮，但之前使用工具提示进行了其他自定义。

```
 1    class MyToolTip : ToolTip
    2     {
    3         public MyToolTip()
    4         {
    5             this.OwnerDraw = true;
    6             this.Draw += new DrawToolTipEventHandler(OnDraw);
    7 
    8         }
    9 
   10         public MyToolTip(System.ComponentModel.IContainer Cont)
   11         {
   12             this.OwnerDraw = true;
   13             this.Draw += new DrawToolTipEventHandler(OnDraw);
   14         }
   15 
   16         private void OnDraw(object sender, DrawToolTipEventArgs e)
   17         {
                      ...Code Stuff...
   24         }
   25     } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-10T16:50:57.090

您可以使用自己的设置 TTS_CLOSE 样式的 CreateParams 子类化 ToolTip 类：

```
private const int TTS_BALLOON = 0x80;
private const int TTS_CLOSE = 0x40;
protected override CreateParams CreateParams
{
    get
    {
       var cp = base.CreateParams;
       cp.Style = TTS_BALLOON | TTS_CLOSE;
       return cp;
    }
} 
```

TTS_CLOSE 样式还[需要](http://msdn.microsoft.com/en-us/library/windows/desktop/bb760248(v=vs.85).aspx)TTS_BALLOON 样式，并且您还必须在工具提示上设置 ToolTipTitle 属性。

要使此样式生效，您需要[使用应用程序清单](http://blog.kalmbachnet.de/?postid=103)启用 Common Controls v6 样式。

添加一个新的“应用程序清单文件”并在 <assembly> 元素下添加以下内容：

```
<dependency>
  <dependentAssembly>
    <assemblyIdentity
        type="win32"
        name="Microsoft.Windows.Common-Controls"
        version="6.0.0.0"
        processorArchitecture="*"
        publicKeyToken="6595b64144ccf1df"
        language="*"
      />
  </dependentAssembly>
</dependency> 
```

至少在 Visual Studio 2012 中，这些东西包含在默认模板中，但被注释掉了——你可以取消注释它。

![带有关闭按钮的工具提示](https://i.stack.imgur.com/4ShRa.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-11T17:37:27.363

您可以尝试在 ToolTip 类的实现中覆盖 CreateParams 方法...即

```
 protected override CreateParams CreateParams
    {
        get
        {
           CreateParams cp = base.CreateParams;
           cp.Style = 0x80 | 0x40; //TTS_BALLOON & TTS_CLOSE

           return cp;
        }
    } 
```

# c# - 您如何使用反射获得一个类及其基类（在层次结构中）的所有属性？（C＃）

> ID：245055
> 
> 赞同：28
> 
> 时间：2008-10-28T22:08:21.127
> 
> 标签：c#, reflection, getproperties

所以我现在拥有的是这样的：

```
PropertyInfo[] info = obj.GetType().GetProperties(BindingFlags.Public); 
```

某物在哪里`obj`。

问题是我想要的一些属性不在`obj.GetType()`它们中，它们位于更进一步的基类之一中。如果我停止调试器并查看 obj，我必须挖掘一些“基础”条目才能查看我想要获取的属性。是否可以设置一些绑定标志让它返回这些标志，还是我必须递归地挖掘`Type.BaseType`层次结构并`GetProperties`在所有这些标志上执行？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-28T22:27:34.487

用这个：

```
PropertyInfo[] info = obj.GetType().GetProperties(BindingFlags.Public | BindingFlags.Instance); 
```

编辑：当然，正确的答案是[Jay](https://stackoverflow.com/questions/245055/how-do-you-get-the-all-properties-of-a-class-and-its-base-classes-up-the-hierar#245131)的答案。`GetProperties()`不带参数等价于`GetProperties(BindingFlags.Public | BindingFlags.Instance | BindingFlags.Static )`. 在`BindingFlags.FlattenHierarchy`这里没有任何作用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-28T22:32:41.420

我觉得没那么复杂。

如果您将`BindingFlags`参数删除到 GetProperties，我认为您会得到您正在寻找的结果：

```
 class B
    {
        public int MyProperty { get; set; }
    }

    class C : B
    {
        public string MyProperty2 { get; set; }
    }

    static void Main(string[] args)
    {
        PropertyInfo[] info = new C().GetType().GetProperties();
        foreach (var pi in info)
        {
            Console.WriteLine(pi.Name);
        }
    } 
```

生产

```
    我的属性 2
    我的财产

```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-28T22:22:50.613

如果您访问`Type.BaseType`，您可以获得基本类型。您可以递归访问每种基本类型，并且当您的类型为`System.Object`.

```
Type type = obj.GetType();
PropertyInfo[] info = type.GetProperties(BindingFlags.Public);
PropertyInfo[] baseProps = type.BaseType.GetProperties(BindingFlags.Public); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-28T22:43:29.807

我倾向于同意 Nicolas 的观点。除非您知道需要反射，否则这`ComponentModel`是一个可行的替代方案，其优点是即使对于运行时模型（例如`DataView`/ `DataRowView`），您也可以获得正确的元数据。

例如：

```
 foreach (PropertyDescriptor prop in TypeDescriptor.GetProperties(obj))
    {
        Console.WriteLine("{0}={1}", prop.Name, prop.GetValue(obj));
    } 
```

顺便说一句，您还可以用它做一些简单的[性能技巧](http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx)；你可以对反射和做同样的事情`Delegate.CreateDelegate`，但是没有集中的地方来隐藏逻辑，不像`TypeDescriptor`a `TypeDescriptionProvider`（如果这些不熟悉，不要担心；你可以“按原样”使用代码；-p）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-28T22:35:20.183

采用：

```
TypeDescriptor.GetProperties(obj); 
```

# c# - 测试 XML 文件中是否存在 XPath 的最佳方法？

> ID：245058
> 
> 赞同：6
> 
> 时间：2008-10-28T22:09:19.937
> 
> 标签：c#, xml

最近我一直在使用 XPathDocument 和 XNavigator 为给定的 XPath 和属性解析 XML 文件。当我提前知道 XPath 是什么时，它一直运行良好。

但有时，XPath 将是几个可能的 XPath 值之一，我希望能够测试给定的 XPath 是否存在。

万一我弄错了命名法，这就是我所说的 XPath - 给定这个 XML blob：

```
<foo>
    <bar baz="This is the value of the attribute named baz">
</foo> 
```

我可能正在寻找我称之为“//foo/bar”的XPath，然后读取属性“baz”以获取值。

我用来执行此操作的代码示例：

```
XPathDocument document = new XPathDocument(filename);
XPathNavigator navigator = document.CreateNavigator();
XPathNavigator node = navigator.SelectSingleNode("//foo/bar");
if(node.HasAttributes)
{
    Console.WriteLine(node.GetAttribute("baz", string.Empty));
} 
```

现在，如果对 navigator.SelectSingleNode 的调用失败，它将返回 NullReferenceException 或 XPathException。我可以同时捕获这两个并将上面的内容重构为一个测试，以查看给定的 XPath 是否返回异常，但我想知道是否有更好的方法？

我在 Intellisense 中没有看到任何明显的东西。XPathNavigator 具有 .HasAttributes 和 .HasChildren 但没有一次遍历一个节点的路径，我没有看到更好的使用方法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-28T22:14:48.587

如果您提供了有效的 XPath，但它不匹配任何内容，则`SelectSingleNode`不会*抛出*`NullReferenceException`- 它只会返回 null。

如果您传递`SelectSingleNode`了一些语法上无效的 XPath，那么它将抛出一个`XPathException`.

所以通常，您只需要测试返回的值是否为空。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T22:30:30.317

```
 var baz = navigator.SelectSingleNode("//foo/bar/@baz");
 if (baz != null) Console.WriteLine(baz); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-21T16:01:25.137

我认为通过执行 navigator.SelectSingleNode(...) 创建 XMLNode 对象并不好。

您必须改用 navigator.Evaluate() ：

```
if (Convert.ToBoolean(navigator.Evaluate(@"boolean(//foo/bar)"))) {...} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T22:17:02.450

根据记忆，可能包含错误。

```
XDocument doc = XDocument.Load("foo.xml");

var att = from a in doc.Descendants("bar")
          select a.Attribute("baz")

foreach (var item in att) {
    if (item != null) { ... }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T22:18:44.957

如果`node == null`then`node.HasAttributes`将抛出一个`NullReferenceException`. `//foo/bar`当XML 文档中的任何元素都不匹配时，就会出现这种情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T22:25:41.403

```
var node = XDocument.Load(filename)
                    .Descendants("bar")
                    .SingleOrDefault(e=>e.Attribute("baz") != null);

if (node != null) Console.WriteLine(node.Attribute("baz").Value); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-28T22:34:31.930

我可能会在我的 xpath 中更具体。

```
 var doc = XDocument.Load(fileName);

        var results = from r in doc.XPathSelectElements("/foo/bar[count(@baz) > 0]")
                      select r.Attribute("baz");

        foreach (String s in results)
            Console.WriteLine(s); 
```

# java - JavaScript 和 Java 有什么区别？

> ID：245062
> 
> 赞同：77
> 
> 时间：2008-10-28T22:10:11.013
> 
> 标签：java, javascript

JavaScript 和 Java 有什么区别？

* * *

## 回答 #1

> 赞同：573
> 
> 时间：2008-10-28T22:12:15.003

Java 和 Javascript 很相似，就像 Car 和 Carpet 很相似。

* * *

## 回答 #2

> 赞同：408
> 
> 时间：2008-10-28T22:14:08.167

一个本质上是一个玩具，专为编写小段代码而设计，传统上被缺乏经验的程序员使用和滥用。

另一种是用于 Web 浏览器的脚本语言。

* * *

## 回答 #3

> 赞同：188
> 
> 时间：2008-10-28T22:12:35.737

以下是两种语言之间的一些区别：

*   Java 是一种静态类型语言；JavaScript 是动态的。
*   Java 是基于类的；JavaScript 是基于原型的。
*   Java 构造函数是只能在对象创建时调用的特殊函数；JavaScript“构造函数”只是标准函数。
*   Java 要求所有非块语句以分号结尾；JavaScript 在某些行的末尾插入分号。
*   Java 使用基于块的作用域；JavaScript 使用基于函数的范围。
*   Java 具有`this`非静态方法的隐式作用域和隐式类作用域；JavaScript 具有隐式全局范围。

以下是一些我认为是 JavaScript 的特殊优势的功能：

*   JavaScript 支持闭包；Java 可以使用匿名类模拟某种“闭包”。（Java 的未来版本可能会支持真正的闭包。）
*   所有的 JavaScript 函数都是可变的；Java 函数只有在显式标记时才是可变参数。
*   JavaScript 原型可以在运行时重新定义，并对所有引用对象立即生效。Java 类不能以影响任何现有对象实例的方式重新定义。
*   JavaScript 允许独立于其原型重新定义对象中的方法（想想 Ruby 中的 eigenclasses，但在类固醇上）；Java 对象中的方法与其类绑定，并且不能在运行时重新定义。

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2008-10-28T22:17:20.577

看看[维基百科的链接](http://en.wikipedia.org/wiki/JavaScript)

> JavaScript，尽管有名字，但本质上与 Java 编程语言无关，尽管两者都有共同的 C 语法，并且 JavaScript 复制了许多 Java 名称和命名约定。该语言最初被命名为“LiveScript”，但在 Netscape 和 Sun 的联合营销协议中重新命名，以换取 Netscape 将 Sun 的 Java 运行时与当时占主导地位的浏览器捆绑在一起。JavaScript 中的关键设计原则继承自 Self 和 Scheme 编程语言。

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2008-10-28T22:11:54.130

一切。

网景以这种方式命名 JavaScript 是为了让粗心的人误以为它与当时的流行词 Java 有关，并且它成功了。

这两种语言完全不同。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2011-03-03T17:40:07.480

![在此处输入图像描述](https://i.stack.imgur.com/TsJyw.jpg)
[Java 之于 JavaScript 就像 ham 之于仓鼠](http://coding.smashingmagazine.com/2009/07/29/misunderstanding-markup-xhtml-2-comic-strip/)

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2008-10-28T22:16:43.247

JavaScript 是一种面向对象的*脚本*语言，它允许您创建动态 HTML 页面，允许您处理输入数据和维护数据，通常在浏览器中进行。

Java 是一种编程语言、核心库集和虚拟机平台，它允许您创建几乎可以在每个平台上运行的编译程序，而无需以原始形式分发源代码或重新编译。

虽然两者名称相似，但它们实际上是两种完全不同的编程语言/模型/平台，用于解决完全不同的问题集。

此外，这直接来自 Wikipedia [Javascript 文章](http://en.wikipedia.org/wiki/JavaScript)：

> 一个常见的误解是 JavaScript 与 Java 相似或密切相关。事实并非如此。两者都有类似 C 的语法，面向对象，通常是沙盒，并且广泛用于客户端 Web 应用程序，但相似之处到此为止。Java有静态类型；JavaScript 的类型是动态的（意味着一个变量可以保存任何类型的对象并且不能被限制）。Java 是从编译后的字节码中加载的；JavaScript 被加载为人类可读的代码。C 是他们最后的共同祖先语言。

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2008-12-07T09:49:48.640

除了完全不同的语言之外，根据我的经验：

*   Java起初看起来不错，但后来变得很烦人。
*   JavaScript 一开始看起来很糟糕而且毫无希望，然后逐渐你就开始真正喜欢它了。

（但这可能与我更喜欢函数式编程而不是 OO 编程有关……；）

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2008-10-28T22:11:54.050

一切。它们是不相关的语言。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2008-10-28T22:14:45.230

它们是具有无关血统的独立语言。Brendan Eich 最初是在 Netscape 创建 Javascript。它最初被称为摩卡。如果您愿意的话，选择 Javascript 作为名称是对当时由 Patrick Naughton、James Gosling 等人在 Sun 开发的占主导地位的 Java 编程语言的一种认可。人。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-10-29T19:43:55.083

就像每个人都说的那样，它们几乎完全不同。

*但是，如果您的Java*应用程序需要*脚本*语言，Javascript 实际上是一个非常好的选择。有一些方法可以让 Javascript 在 JVM 中运行，并且一旦你这样做了，你就可以非常无缝地访问和操作 Java 类。

 ** * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-28T22:18:07.550

他们彼此没有任何关系。

Java 是静态类型的，可在其自己的 VM 上编译和运行。

Javascript 是在浏览器中动态输入、解释和运行的。它还具有 Java 所没有的一流函数和匿名函数。它可以直接访问网页元素，这对于进行客户端处理很有用。

它们在语法上也有些相似，但仅此而已。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-10-31T18:51:53.687

不要与名称混淆
。Java 是在 Sun Microsystems（现为 Oracle）创建的。
但是，JavaScript 是在 Web 的早期由 Netscape（现为 Mozilla）创建的，从技术上讲，“Java-Script”是 Sun Microsystems 许可的商标，用于描述 Netscape 对该语言的实现。Netscape 将该语言提交给 ECMA（欧洲计算机制造商协会）进行标准化，由于商标问题，该语言的标准化版本被困在了尴尬的名称“ECMAScript”上。出于同样的商标原因，微软的语言版本正式称为“JScript”。实际上，几乎每个人都将语言称为 JavaScript。真正的名字是“ECMAScript”。

**两者是完全不同的语言！！！**

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-01-11T13:42:06.317

几乎世界上每台 PC 都安装了至少一个 JavaScript 解释器。

大多数（但不是“几乎所有”）PC 都安装了 Java VM。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-09-12T23:08:24.683

Mozilla 团队（他们制作 Firefox）[对 Javascript 的重新介绍应该可以解释它。](https://developer.mozilla.org/en/a_re-introduction_to_javascript)

# shell - 查找二元组的 Shell 脚本

> ID：245082
> 
> 赞同：3
> 
> 时间：2008-10-28T22:16:37.147
> 
> 标签：shell, grep, nlp

我正在制作一个 shell 脚本来查找二元组，这在某种程度上是可行的。

```
#tokenise words
tr -sc 'a-zA-z0-9.' '\012' < $1 > out1
#create 2nd list offset by 1 word
tail -n+2 out1 > out2
#paste list together
paste out1 out2 
#clean up
rm out1 out2 
```

唯一的问题是它将前一句的结尾和开头的单词配对。

例如对于两个句子“你好世界”。和“富吧”。我会与 'world. 富'。是否有可能用 grep 或其他东西过滤掉这些？

我知道我可以找到所有包含 grep [.] 句号的二元组，但这也能找到合法的二元组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T22:29:55.590

只需将粘贴行替换为：

```
paste out1 out2 | grep -v '\..' 
```

这将过滤掉任何包含句点的行，该句点不是一行的最后一个字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T22:57:26.753

Shell 脚本可以使用管道。

```
cat "$@" |
tr -cs "a-zA-Z0-9." '\012' |
{
old="aaa."
while read new
do
    case "$old" in
    *.) : OK;;
    *)  echo "$old $new";;
    esac
    old="$new"
done
} 
```

该代码`cat`用作数据的通用收集器 -`tr`是一个不接受任何文件名参数的纯过滤器。基本思想是变量old包含第一个单词，new读取新单词。当 old 以句点结尾时（就像开头一样），根据您的规则，它不会形成有效的二元组。如果要从句子结尾的二元组中删除点，可以使用：

```
 echo "$old ${new%.}" 
```

朴素的版本（与点相呼应）与 Bourne shell 以及衍生物一起使用；具有 Korn shell 和衍生工具的唯一工作人员的版本`${new%.}`- 不是原始的 Bourne shell。

如果必须使用临时文件，则使它们的名称包含进程 ID ($$) 并使用陷阱删除它们：

```
tmp=${TMPDIR:-/tmp}/bigram.$$
trap 'rm -f $tmp.?; exit 1' 0 1 2 3 13 15

...code using $tmp.1, $tmp.2, etc...

rm -f $tmp.?
trap 0 
```

信号1为挂断（HUP），2为中断（INT），3为退出（QUIT），13为管道（PIPE），15为终止（TERM）；0 是“任何出口”，在这种情况下几乎是 juju。在真正退出之前，记得取消退出陷阱，如图。

# python - 升级 Google Application Engine 程序以使用 unicode

> ID：245094
> 
> 赞同：3
> 
> 时间：2008-10-28T22:20:23.223
> 
> 标签：python, google-app-engine, unicode

我有一个简单的 Google App Engine 应用程序，我使用普通字符串编写。我意识到我想让它处理 unicode。这有什么问题吗？我正在考虑我目前在实时数据库中已经拥有的所有字符串。（来自我不想打扰的真实用户。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T22:53:14.763

[Alexander Kojevnikov](https://stackoverflow.com/questions/245094/upgrading-google-application-engine-program-to-use-unicode#245159)说：“数据存储在内部将所有字符串保存在 unicode 中。”

换句话说，您的应用程序已经在各处使用 unicode。感谢谷歌的人提供了一个合理的 API。无需进一步工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T22:43:27.687

数据存储在内部将所有字符串保存[在 unicode 中](http://code.google.com/appengine/docs/datastore/typesandpropertyclasses.html#str)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-04T03:53:15.263

存储到 db.TextProperty() 时，您需要使用 db.Text() ，例如：

`instance.xml = db.Text(xml_string, encoding="utf_8")`

如果字符串上没有 BOM，请指定正确的编码。就像您从 XML 流中获得意外的 unicode 数据一样。

这发生在我使用 Amazon.com 的产品 API 时。

谷歌的 urlfetch 也有处理该流的 unicode 问题。所以我最终在 urllib.urlopen() 的返回上运行 minidom 的 parse() 函数而不是 parseString() ，它就像一个流一样来解决问题：

```
response = urllib.urlopen(url)
xml = minidom.parse(response) 
```

# nhibernate - NHibernate 多对一映射更新未更改的表

> ID：245102
> 
> 赞同：1
> 
> 时间：2008-10-28T22:22:15.403
> 
> 标签：nhibernate, mapping

我有两个实体共享一个主键（Transaction 和 TransactionDetail）。我使用从 Transaction 到 TransactionDetail 以及从 TransactionDetail 到 Transaction 的多对一关系将它们映射。交易明细为每笔交易保存一个记录。

但是，当我创建一个新的事务详细信息对象并将其添加到事务中时，NHibernate 会尝试使用类似 'update transaction set id = ? 哪里 id = ？每个参数具有相同的值。

由于映射位于主键列上，因此我不希望更新事务。事实上，由于主键是一个标识列，当它尝试更新值时我得到一个错误。创建新的 TransactionDetail 记录时，如何防止 NHibernate 更新 Transaction 表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T22:31:44.200

您可能想查看`one-to-one`或`join-table`类型的映射。`many-to-one`意味着特定的东西，看起来您的情况可能更适合其他两种映射类型之一的配置文件。

# c# - 确定关机正在关闭我的应用程序

> ID：245111
> 
> 赞同：5
> 
> 时间：2008-10-28T22:25:29.000
> 
> 标签：c#, .net, shutdown

在 .NET 中是否可以确定我的应用程序是否由于 Windows 被关闭命令（而不是任何旧的应用程序关闭）而关闭，以便写出一些临时缓存文件甚至阻止关闭足够长的时间以提示用户输入？

虽然我目前的范围涉及 Winform 应用程序和 Windows 服务，但如果可能，我有兴趣以通用方式理解这一点

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-28T22:32:52.513

[SystemEvents.SessionEnding](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.sessionending.aspx)对您来说是一个很好的起点。那篇文章讨论了发生注销/关闭时所涉及的事件序列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-28T22:33:58.063

通常，您需要处理[`WM_QUERYENDSESSION`](http://msdn.microsoft.com/en-us/library/aa376890(VS.85).aspx)Windows 消息。这将使您的应用程序有机会进行清理，或者在确实需要时阻止关闭。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T22:34:34.833

处理 Microsoft.Win32.SystemEvents 类型上的 SessionEnded 事件。

# asp.net - 战略建议：升级 Web 应用程序的设计

> ID：245120
> 
> 赞同：0
> 
> 时间：2008-10-28T22:29:06.653
> 
> 标签：asp.net, architecture

我有一个专门用于报告 PBX 扩展统计信息的 ASP.NET 网站。它包含许多报表页面，HTML 几乎完全由代码隐藏生成（设置 Label 控件的 Text 属性而不是使用 Response.Write），使用通过引用 DataTable 参数填充的未参数化字符串文字 SQL 查询。

维护页面至少包含 DataGrids 和详细信息表单，但使用相同的 DAL，可以说它支持多个 DB 服务器，每个子类都使用自己的字符串文字查询覆盖这些访问方法。

我需要考虑什么来清理这个烂摊子？我已经做出了一个几乎显而易见的决定，即使用第三方报告解决方案，并将查询移动到各自数据库语言的存储过程中，缩小不同 DAL 类的多样性，并将 CSS 分离到共享文件中，就像很多它非常隐藏在 C# 文件中！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T22:39:42.933

对于您的后端设计，我建议使用一个类来表示数据库的每个主表（例如，一个 Report 类和一个 User 类）。任何不是事件处理程序的东西都应该放在后端类文件/命名空间中。

对于您的 GUI，看起来您在使用 ASP.NET 控件而不是仅仅将数据流式传输给用户时走在正确的轨道上。但是，您可以考虑将页面区域客观化。例如，我最喜欢的技巧之一是在需要用户输入时打开半透明的“弹出”面板，或者在显示短消息时打开信息栏之类的东西。

考虑 AJAX 和 AJAX 控制工具包。它很容易实现（特别是在重写的情况下）并且提供了很大的灵活性。具体来说，我发现 Accordions - 有时甚至嵌套在其他 Accordions 中 - 非常擅长组织过多的信息。

编辑：

请注意，如果您要使用 AJAX，您基本上甚至不能再考虑使用 response.write。

至于屏幕上的内容太多，请记住面板有一个“滚动条”属性，而 DIV 也不会没有一些重大变化。

此外，我倾向于按命名空间分隔我的代码文件；但流行的趋势是按类这样做。如果您有许多开发人员，或者如果命名空间中的多个类可能会被不同的人检出或同时修改，这是一个更好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T22:54:13.937

我会考虑放弃任何自定义编写的 DAL 并使用以下之一：

*   [iBATIS.NET](http://ibatis.apache.org/dotnetdownloads.cgi)
*   [休眠](http://www.hibernate.org/343.html)
*   [亚音速](http://www.codeplex.com/subsonic/Release/ProjectReleases.aspx?ReleaseId=14067)

你甚至可能最终完全放弃存储过程。

如果你有胆量，你可以尝试使用[微软的 MVC](http://www.asp.net/mvc/)实现重新设计。

无论您采用哪种方法，请确保在重构​​任何代码之前编写单元测试，并在重构之前和之后验证测试是否通过。

# html - 将 ANSI 转义（终端格式/颜色代码）转换为 HTML 的库

> ID：245121
> 
> 赞同：84
> 
> 时间：2008-10-28T22:29:50.317
> 
> 标签：html, terminal-color, ansi-escape

我正在寻找一个通过普通标签或 CSS 将 ANSI 转义序列转换为 HTML 颜色的代码库。例如，可以转换它的东西：

```
ESC[00mESC[01;34mbinESC[00m
ESC[01;34mcodeESC[00m
ESC[01;31mdropbox-lnx.x86-0.6.404.tar.gzESC[00m
ESC[00mfooESC[00m
```

进入这个：

```
<span style="color:blue">bin</span>
<span style="color:blue">code</span>
<span style="color:red">dropbox-lnx.x86-0.6.404.tar.gz</span>
foo 
```

将中断转换为 <br/> 不是必需的，它只是我不知道的转义码。我可以自己破解它，但我可能会错过一些重要的东西，比如下划线或搞乱背景颜色的工作方式。我宁愿只是坐在别人的代码之上。

是否存在这样的工具（命令行 linux）或库（最好是 perl、python 或 ruby​​）？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2010-06-04T16:06:29.783

`aha`是一个 C 语言程序，在 Ubuntu 包中可用，在[http://ziz.delphigl.com/tool_aha.php](http://ziz.delphigl.com/tool_aha.php)或在 github [https://github.com/theZiz/aha](https://github.com/theZiz/aha)上，它接受终端颜色的输入管道或文件，并将（符合 w3c 的）HTML 文件放入标准输出。例子：

```
ls --color=always | aha > ls-output.htm 
```

或者

```
ls --color=always | aha --black > ls-output.htm 
```

具有黑色背景的类似终端的外观。

通过“make”编译它并将它放在你想要的任何地方。

获得反馈会很棒。;-)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-11-29T15:36:37.390

仍在维护的成熟 Python 库和命令行工具：[pycontribs/ansi2html](https://github.com/pycontribs/ansi2html)

或者，对于 Bourne shell：[ansi2html.sh](https://github.com/pixelb/scripts/blob/master/scripts/ansi2html.sh)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-31T02:31:00.283

似乎有[一个 HTML::FromANSI Perl 模块](http://search.cpan.org/perldoc?HTML::FromANSI)。

# javascript - Setting OnLoad event for newly opened window in IE6

> ID：245124
> 
> 赞同：3
> 
> 时间：2008-10-28T22:31:07.087
> 
> 标签：javascript, internet-explorer, onload

I need to set the onload attribute for a newly popped-up window. The following code works for Firefox:

```
<a onclick="printwindow=window.open('www.google.com');printwindow.document.body.onload=self.print();return false;" href='www.google.com'> 
```

However, when I try this in IE, I get an error - "printwindow.document.body null or not defined'

The goal is to pop open a new window, and call up the print dialog for that window once it's been opened.

Any clues on how to make this work? It is important not to use javascript elsewhere on the target page, as I do not have control over it. All functionality must be contained in the link I posted above.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-03-30T22:28:19.233

虽然较早的答案正确地指出新窗口必须来自同一个域，但他们错误地回答了为什么他收到错误“printwindow.document.body null or not defined”。这是因为 IE 不会从 window.open() 返回任何状态，这意味着您可以在 onload 可用之前打开页面并尝试访问它。

出于这个原因，您需要使用 setTimeout 之类的东西来检查。例如：

```
printwindow = window.open('print.html');
var body;
function ieLoaded(){
    body = printwindow.document.getElementsByTagName("body");
    if(body[0]==null){
        // Page isn't ready yet!
        setTimeout(ieLoaded, 10);
    }else{
        // Here you can inject javascript if you like
        var n = printwindow.document.createElement("script");
        n.src = "injectableScript.js";
        body.appendChild(n);

        // Or you can just call your script as originally planned
        printwindow.print();
    }
}
ieLoaded(); 
```

[这将在此处](http://flightschool.acylt.com/devnotes/window-open-onload-window-events/)进一步讨论

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T23:28:18.500

除非两个页面都在同一个域中，否则这是不可能的。您的代码在 FF 中不起作用，而是打印当前页面。如果页面在同一个域上，那么你会写：

```
printwindow=window.open('/mypage.html');
printwindow.onload = function() {
  printwindow.focus();
  printwindow.print();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T23:02:49.020

您依赖“printwindow.document.body.onload=self.print();” 在子文档完成加载之前执行的行。我认为你不能保证这一点。

这是一个想法：在 iframe 中准备 HTML 或只有您需要的页面的页面。此页面将有 body.onload=self.print()。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T23:06:14.253

onload 是 window 对象而不是 body 元素的属性，尽管 HTML 属性可能会让您相信。这是参考：

```
printwindow.onload 
```

但是，在这种情况下，您不能将 JavaScript 字符串传递给它 - 您需要将函数传递给它。所以，完整的脚本看起来像这样

```
printwindow.onload=function(){self.print();} 
```

现在，把它们放在一起

```
<a href="www.google.com" onclick="var printwindow=window.open(this.href,'printwindow');printwindow.onload=function(){self.print();};return false;" >try it</a> 
```

然而！这不适用于 URL “www.google.com”。浏览器安全模型阻止父窗口访问子窗口的窗口对象，除非它们都驻留在同一个域名下。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T23:12:17.533

检查我们的 jQuery。特别是文档就绪功能。

[http://docs.jquery.com/Tutorials:How_jQuery_Works#Launching_Code_on_Document_Ready](http://docs.jquery.com/Tutorials:How_jQuery_Works#Launching_Code_on_Document_Ready)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-29T18:36:36.107

适用于所有浏览器的最终（诚然，糟糕的）解决方案是使用 setTimeout 并以这种方式调用 print() ，而不是修改 onload 属性：

```
<a onclick="self.printwindow=window.open('print.html');setTimeout('self.printwindow.print()',3000);return false;" href='print.html'> 
```

# svn - How can I get the functionality of svn:externals in a read-only fashion?

> ID：245149
> 
> 赞同：18
> 
> 时间：2008-10-28T22:40:34.040
> 
> 标签：svn

svn:externals can be great for sucking in central libraries or IP into a project, so that they can be kept in one location accessible for all.

But if I'm asking people to external tags of common IP (so it doesn't change on them) it opens the possibility of them inadvertently committing changes to the tag.

How can I make svn:externals read-only? It's acceptable if there is some extra argument or some way of making the external that we can add to the procedure for everyone to follow.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-12-10T08:49:39.467

使用 svn 存储库挂钩来避免进入特殊目录，例如标签

如果您使用 ttb（主干、标签、分支）命名约定并且只读 svn:external 访问的代码位于标签目录中，则可以使用 pre-commit 挂钩来避免提交到这些目录。

以下是详细信息： [SVN 预提交挂钩，用于避免更改标签子目录](https://stackoverflow.com/questions/464384/svn-pre-commit-hook-for-avoiding-changes-to-tags-subdirectories)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-28T22:48:20.827

Make the external repositories read-only to everyone except their maintainers.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-28T00:02:42.673

> 使外部存储库对除其维护者之外的所有人都是只读的。

我完全同意上面[J. John](https://stackoverflow.com/questions/245149/how-can-i-get-the-functionality-of-svnexternals-in-a-read-only-fashion/245166#245166)的回答。创建一个预提交钩子是多余的。svn:externals （只是对外部存储库的引用，因此得名），所以仍然在一个单独的存储库中（您可以通过转到签出的外部并执行“svn info|grep URL”来验证这一点）所以只是在该外部回购中放置必要的许可。就像是：

```
[external_repo]
@maintainer = rw
@others = r 
```

从定义为“外部”的 repo（我们称之为 repoA）（我们将外部 repo 称为 repoB），你不需要做任何事情。当某人（不是@maintainers 的一部分的人）尝试通过他/她从 repoA 签出的代码提交到外部 repo 时，提交将被定向到外部 repoB，因此，您设置的权限类似于上面那个 repo 将启动并阻止提交。

希望这有助于清除事情。

伊斯梅尔·卡西潘 :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T23:27:52.900

实际上，TortoiseSVN 通过 commit 钩子检测到你正在尝试提交标签，并警告用户，这基本上满足了我对减速带的要求。所以我们已经很好了。

# apache-flex - Flex 脚本文件中的默认命名空间范围警告 (1084)

> ID：245155
> 
> 赞同：7
> 
> 时间：2008-10-28T22:42:27.733
> 
> 标签：apache-flex, actionscript-3, mxml

我有一个 MXML 文件，它为所有事件处理程序引用了一个外部脚本文件：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
    <mx:Script source="LoginExample.as" />
    <mx:Button id="btnGoodLogin" click="btnGoodLogin_onClick()"  label="Good Login" enabled="true" y="28"/>
    <mx:Button id="btnBadLogin" click="btnBadLogin_onClick()"  label="Bad Login" enabled="true" y="28" x="112"/>
    <mx:Button id="btnLogout" click="btnLogout_onClick()"  label="Logout" enabled="true" y="28" x="219"/>
    <mx:Button id="btnCheck" click="btnCheck_onClick()"  label="Check" enabled="true" y="28" x="325"/>
    <mx:Text id="txtResult"  y="58" width="263"/>
</mx:Application> 
```

外部文件定义了处理程序：

```
// LoginExample.as
import flash.events.*;
import flash.net.*;
function btnGoodLogin_onClick():void
{
   // ...
}
function btnBadLogin_onClick():void
{
  // ...
}
// etc. for other handlers 
```

这些处理程序中的每一个，加上脚本中定义的所有其他函数，都会导致编译器发出警告消息：

> 1084: 函数 'btnBadLogin_onClick' 将被限定为默认命名空间：LoginExample: internal。它在这个包之外是不可见的。LoginExample/src LoginExample.as 第 27 行 1225162212118 189

摆脱这些警告的最佳方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-29T09:40:40.043

在函数声明之前加上, `private`, `protected`or `internal`：`public`

```
private function btnBadLogin_onClick():void 
```

这应该够了吧。

# keyboard - 如何在 Solaris 10 Java Desktop 中选择 dvorak 布局

> ID：245163
> 
> 赞同：1
> 
> 时间：2008-10-28T22:45:16.700
> 
> 标签：keyboard, solaris, x11, dvorak

我正在学习使用 Dvorak 键盘布局，但我还不足以输入密码，所以我需要能够偶尔切换回 qwerty。在 KDE 中这工作得很好，Windows 以一种我可以忍受的方式来处理它，但我无法更改运行 Solaris 10 Java 桌面的工作箱。它似乎没有“setxkbmap”命令。

我可以更改 X11.conf 文件，但是（*见第二句*）

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T22:50:51.320

试试这个让 setxkbmap 工作：[http ://bugs.opensolaris.org/view_bug.do?bug_id=6676221](http://bugs.opensolaris.org/view_bug.do?bug_id=6676221)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T22:38:30.983

setxkbmap 已添加到 Solaris Express 和 OpenSolaris（即比 Solaris 10 更新的 Solaris 版本），但尚未向后移植到 Solaris 10。

在 Solaris 10 上，您可以尝试直接使用 xkbcomp 来修改 XKB 布局，但您可能会发现使用经典的 xmodmap 方法设置 dvorak 布局更简单。显示如何执行此操作的一些示例位于：

*   [X-Windows 中的德沃夏克](http://www.strout.net/info/dvorak/xwinsetup.html)
*   [介绍 Dvorak 键盘 - xmodmap 键盘映射](http://www.mwbrooks.com/dvorak/unix.html#xmod)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T08:51:42.113

现在我可以在 Dvorak 模式下输入密码了，我刚刚更改了 Xorg.conf ！感谢您的建议。

# c# - Linq-to-SQL ToDictionary()

> ID：245168
> 
> 赞同：83
> 
> 时间：2008-10-28T22:50:06.720
> 
> 标签：c#, linq, linq-to-sql

如何使用 Linq 将 SQL (2008) 中的两列正确转换为字典（用于缓存）？

我目前遍历 IQueryable b/c 我无法让 ToDictionary 方法工作。有任何想法吗？这有效：

```
var query = from p in db.Table
            select p;

Dictionary<string, string> dic = new Dictionary<string, string>();

foreach (var p in query)
{
    dic.Add(sub.Key, sub.Value);
} 
```

我真正想做的是这样的事情，这似乎不起作用：

```
var dic = (from p in db.Table
             select new {p.Key, p.Value })
            .ToDictionary<string, string>(p => p.Key); 
```

但我收到此错误：无法从 'System.Linq.IQueryable' 转换为 'System.Collections.Generic.IEnumerable'

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2008-10-28T22:53:56.243

```
var dictionary = db
    .Table
    .Select(p => new { p.Key, p.Value })
    .AsEnumerable()
    .ToDictionary(kvp => kvp.Key, kvp => kvp.Value)
; 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-28T22:57:49.637

您只定义键，但还需要包含值：

```
var dic = (from p in db.Table
             select new {p.Key, p.Value })
            .ToDictionary(p => p.Key, p=> p.Value); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-28T23:07:38.417

谢谢大家，您的回答帮助我解决了这个问题，应该是：

```
var dic = db
        .Table
        .Select(p => new { p.Key, p.Value })
        .AsEnumerable()
        .ToDictionary(k=> k.Key, v => v.Value); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-18T19:46:53.547

为什么要为表中的每个项目创建一个匿名对象只是为了转换它？

你可以简单地使用类似的东西： `IDictionary<string, string> dic = db.Table.ToDictionary(row => row.Key, row => row.Value);` 你可能需要在 Table 和 ToDictionary() 之间包含一个 AsEnumerable() 调用。我不知道 db.Table 的确切类型。

* * *

还要更正第一个示例，您的第二个循环变量在声明和使用时不匹配。

# unit-testing - VS.Net 单元测试可以在 IDE 之外运行吗？

> ID：245176
> 
> 赞同：3
> 
> 时间：2008-10-28T22:54:13.577
> 
> 标签：unit-testing, command-line, mstest

有没有办法可以针对 IDE 之外的已编译 DLL 运行 UnitTest 项目？基本上，我们有测试程序在投入生产之前验证代码。
我不想在 IDE 中运行测试。我希望将编译后的代码准备好投入生产，并能够在最终副本之前对 .dll 运行最终测试。

是否有某种命令行实用程序可以做到这一点？只需提供两个 .dll 并获得某种“一切都好”的报告。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-28T22:56:57.377

我认为您可能正在寻找 [MSTest]( [http://msdn.microsoft.com/en-us/library/ms182486(VS.80).aspx)](http://msdn.microsoft.com/en-us/library/ms182486(VS.80).aspx))

要在特定容器中运行所有测试，您可以在命令行中执行以下操作：

> MSTest /testcontainer:MyTestProject\bin\debug\MyTestProject.dll

*   [.NET 2.0 的 MSTest 命令行选项]( [http://msdn.microsoft.com/en-us/library/ms182489(VS.80).aspx)](http://msdn.microsoft.com/en-us/library/ms182489(VS.80).aspx))

*   [.NET 3.5 的 MSTest 命令行选项](http://msdn.microsoft.com/en-us/library/ms182489.aspx)

*   [其他与 Stack Overflow 相关的 MSTest 问题](https://stackoverflow.com/questions/tagged/mstest)

# .net - .NET：从字符串到对象

> ID：245178
> 
> 赞同：4
> 
> 时间：2008-10-28T22:54:25.980
> 
> 标签：.net

我从 xml 文件中读取了一些属性，其中有一个引用 llblgen 对象的字符串，例如“article”。现在我已经建立了一个相当长的

```
Select Case myString
  Case "article"
    return New ArticleEntity() 
```

等等，随着它变得越来越长，它变得越来越难看；）。有一个更好的方法吗 ？

（上面是vb.net，但c#例子也很好）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T23:43:01.840

您可以创建一个字典，将字符串映射到工厂方法，例如

```
Dictionary<string, Func<Animal>> _map = new Dictionary
{
  ("cat", () => new Cat()),
  ("dog", () => new Dog())
  ...
} 
```

然后你的案例陈述变成

```
return _map[myString](); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T22:56:43.103

您可以将类型名称存储在文件中并使用：

```
return Activator.CreateInstance(Type.GetType("Some.Type.String")); 
```

（只要`Some.Type.String`有一个默认的无参数构造函数，它就可以工作。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T22:58:26.453

字符串是否完全代表对象类型的名称。如果是这样，你可能会这样做。

```
 Object obj = Activator.CreateInstance("AssemblyName", "TypeName"); 
```

所以如果你有从列表中返回的类型，你可以做......

```
List<object> list = new List<object>();

foreach(string typename in GetFromXMLFile())
{
   list.Add(Activator.CreateInstance("AssemblyName", typename);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T22:59:54.220

请注意，`Activator.CreateInstance`它有一个通用版本，不需要对基类进行强制转换（如果这样的基类或接口可用）：

```
public static IMyTrait MakeMyTrait(Type t) {
    return Activator.CreateInstance<IMyTrait>(t);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T23:01:30.550

很不错啊。不确定对象是否与文件中的完全相同，但我宁愿编辑该文件，也不愿继续使用那个丑陋的选择案例 :)。

感谢您的建议！

# mysql - 在 MySQL 的 LIMIT 子句中使用变量

> ID：245180
> 
> 赞同：53
> 
> 时间：2008-10-28T22:55:06.897
> 
> 标签：mysql, limit, clause, variables

我正在编写一个存储过程，其中有一个名为*my_size*的输入参数，它是一个*INTEGER*。我希望能够在语句的`LIMIT`子句中使用它`SELECT`。显然这不受支持，有没有办法解决这个问题？

```
# I want something like:
SELECT * FROM some_table LIMIT my_size;

# Instead of hardcoding a permanent limit:
SELECT * FROM some_table LIMIT 100; 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-06-12T06:58:08.880

对于那些不能使用 MySQL 5.5.6+ 并且不想编写存储过程的人，还有另一种变体。我们可以在带有 ROWNUM 的子选择上添加 where 子句。

```
SET @limit = 10;
SELECT * FROM (
  SELECT instances.*, 
         @rownum := @rownum + 1 AS rank
    FROM instances, 
         (SELECT @rownum := 0) r
) d WHERE rank < @limit; 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-05T08:54:37.027

**存储过程**

```
DELIMITER $
create PROCEDURE get_users(page_from INT, page_size INT)
begin
SET @_page_from = page_from;
SET @_page_size = page_size;
PREPARE stmt FROM "select u.user_id, u.firstname, u.lastname from users u limit ?, ?;";
EXECUTE stmt USING @_page_from, @_page_size;
DEALLOCATE PREPARE stmt;
end$
DELIMITER ; 
```

**用法**

```
call get_users(1, 10); 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-28T23:04:53.803

搜索出现了[这篇文章](http://bugs.mysql.com/bug.php?id=8094)。我在下面粘贴了相关的文字。

> 这是一个论坛帖子，显示了一个准备好的语句示例，可让您将变量值分配给限制子句：
> 
> [http://forums.mysql.com/read.php?98,126379,133966#msg-133966](http://forums.mysql.com/read.php?98,126379,133966#msg-133966)
> 
> 但是，我认为这个错误应该引起一些注意，因为我无法想象过程中的准备好的语句将允许任何过程编译时优化。我有一种感觉，准备好的语句是在程序运行时编译和执行的，这可能会对效率产生负面影响。如果限制子句可以接受正常的过程变量（例如，过程参数），那么数据库仍然可以在过程中对查询的其余部分执行编译时优化。这可能会产生更快的过程执行。虽然我不是专家。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2011-08-13T16:38:48.807

我知道这个答案来晚了，但试试 SQL_SELECT_LIMIT。

例子：

```
Declare rowCount int;
Set rowCount = 100;
Set SQL_SELECT_LIMIT = rowCount;
Select blah blah
Set SQL_SELECT_LIMIT = Default; 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-01-22T15:46:43.493

此功能已添加到 MySQL 5.5.6。检查此[链接](http://bugs.mysql.com/bug.php?id=11918)。

我已经升级到 MySQL 5.5 只是为了这个功能并且效果很好。5.5 也有很多性能升级，我完全推荐它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-02-13T15:08:50.533

另一种方式，与写“Pradeep Sanjaya”相同，但使用 CONCAT：

```
CREATE PROCEDURE `some_func`(startIndex INT, countNum INT)
READS SQL DATA
  COMMENT 'example'
BEGIN
  SET @asd = CONCAT('SELECT `id` FROM `table` LIMIT ',startIndex,',',countNum);
  PREPARE zxc FROM @asd;
  EXECUTE zxc;
END; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-06-03T06:07:53.490

从 MySQL 5.5.6 版开始，您可以使用变量/参数指定**`LIMIT`**和。**`OFFSET`**

如需参考，请参阅[5.5 Manual](http://dev.mysql.com/doc/refman/5.5/en/select.html#idm140195666212032)、[5.6 Manual](http://dev.mysql.com/doc/refman/5.6/en/select.html#idm140462371147952)和 @Quassnoi 的[回答](https://stackoverflow.com/a/2875365/506879)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-02-06T20:21:43.503

我在使用 MySql 5.0 时遇到了同样的问题，并在@ENargit 的回答的帮助下编写了一个程序：

```
CREATE PROCEDURE SOME_PROCEDURE_NAME(IN _length INT, IN _start INT)
BEGIN
    SET _start = (SELECT COALESCE(_start, 0));
    SET _length = (SELECT COALESCE(_length, 999999)); -- USING ~0 GIVES OUT OF RANGE ERROR
    SET @row_num_personalized_variable = 0;

    SELECT
    *,
    @row_num_personalized_variable AS records_total         
    FROM(
        SELECT
        *,
        (@row_num_personalized_variable := @row_num_personalized_variable + 1) AS row_num
        FROM some_table
    ) tb
    WHERE row_num > _start AND row_num <= (_start + _length);
END; 
```

还包括通过 records_total 查询获得的总行数。

# asp.net - 如何在不依赖扩展名的情况下检查上传文件的内容？

> ID：245183
> 
> 赞同：4
> 
> 时间：2008-10-28T22:56:49.780
> 
> 标签：asp.net, file-upload

您如何在不使用扩展名的情况下可靠地验证上传文件的类型？我猜你必须检查标题/读取一些字节，但我真的不知道该怎么做。我使用 c# 和 asp.net。

感谢您的任何建议。

* * *

好的，所以从上面的链接我现在知道我正在寻找'ff d8 ff e0'来肯定地识别一个.jpg文件。

在我的代码中，我可以毫无问题地读取前 20 个字节：

```
 FileStream fs = File.Open(filePath, FileMode.Open);
                Byte[] b = new byte[20];
                fs.Read(b, 0, 20); 
```

所以（请原谅我在这里完全没有经验）但是我如何检查字节数组是否包含'ff d8 ff e0'？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-29T01:21:06.307

这是对您发布的后续问题的快速而肮脏的回应：

```
byte[] jpg = new byte[] { 0xFF, 0xD8, 0xFF, 0xE0 };
bool match = true;
for (int i = 0; i < jpg.Length; i++)
{
    if (jpg[i] != b[i])
    {
        match = false;
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T23:01:42.813

这确实是 Unix`file`程序所做的，具有或多或少的可靠性。在某种程度上，这取决于您尝试检测其文件的程序是否发出文件头；该计划`tar`因不这样做而臭名昭著。这取决于您计划尝试识别的文件类型，但使用 ; 的实现可能是最简单的`file`。它可以识别许多文件类型，并且现代版本可以通过可以处理多种场景的额外文件类型定义文件进行扩展。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T23:00:07.107

文件的前几个字节通常会告诉您文件类型。例如，
[参见 http://www.garykessler.net/library/file_sigs.html](http://www.garykessler.net/library/file_sigs.html)
[http://www.astro.keele.ac.uk/oldusers/rno/Computing/File_magic.html](http://www.astro.keele.ac.uk/oldusers/rno/Computing/File_magic.html)

上传后使用 System.IO 将字节读取为二进制。

不过，我很好奇，为什么不能依赖 ContentType 标头？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T23:31:50.880

[Wotsit](http://www.wotsit.org/)是查找各种文件类型的幻数的好资源。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-21T00:30:00.243

读取文件的内容是万无一失的方法。由于您是在 .Net 中构建它，因此您可能会检查上传文件的 MIME 类型。

你可以通过 DllImport urlmon.dll 来帮助。请参考以下帖子： [http ://coding-passion.blogspot.com/2008/11/validating-file-type.html](http://coding-passion.blogspot.com/2008/11/validating-file-type.html)

为了澄清内容类型，它总是由文件的扩展名驱动。因此，即使将 .zip 文件的扩展名重命名为 .txt，内容类型仍会显示纯文本。

# python - 什么是“一流”对象？

> ID：245192
> 
> 赞同：236
> 
> 时间：2008-10-28T22:58:47.733
> 
> 标签：python, language-agnostic

在给定的编程语言中，什么时候对象或其他东西被称为“一流的”，为什么？它们与没有它们的语言有什么不同？

当有人说“一切都是对象”（就像在 Python 中一样）时，他们真的是指“一切都是一流的”吗？

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2008-10-28T23:04:22.590

简而言之，这意味着对对象的使用没有任何限制。它与任何其他对象相同。

第一类对象是可以动态创建、销毁、传递给函数、作为值返回并拥有编程语言中其他变量的所有权利的实体。

> 根据语言，这可能意味着：
> 
> *   可表示为匿名文字值
> *   可存储在变量中
> *   可存储在数据结构中
> *   具有内在身份（独立于任何给定名称）
> *   与其他实体具有可比性
> *   可作为参数传递给过程/函数
> *   作为过程/函数的结果可返回
> *   在运行时可构造
> *   可打印
> *   可读
> *   可在分布式进程之间传输
> *   可存储在正在运行的进程之外

[来源](http://en.wikipedia.org/wiki/First-class_object)。

然而，在 C++ 中，函数本身并不是一流的对象：

*   您可以覆盖“（）”运算符，从而可以拥有一个对象函数，这是一等的。
*   函数指针是第一类。
*   boost bind、lambda 和 function 确实提供了一流的功能

在 C++ 中，类不是第一类对象，而是这些类的实例。在 Python 中，类*和*对象都是第一类对象。（有关作为对象的类的更多详细信息，请参阅[此答案](https://stackoverflow.com/a/6581949/1612701)）。

这是 Javascript 第一类函数的示例：

```
// f: function that takes a number and returns a number
// deltaX: small positive number
// returns a function that is an approximate derivative of f
function makeDerivative( f, deltaX )
{
    var deriv = function(x)
    { 
       return ( f(x + deltaX) - f(x) )/ deltaX;
    }
    return deriv;
}
var cos = makeDerivative( Math.sin, 0.000001);
// cos(0)     ~> 1
// cos(pi/2)  ~> 0 
```

[来源](http://en.wikipedia.org/wiki/First-class_function)。

不是第一类对象的实体称为第二类对象。C++ 中的函数是二等的，因为它们不能被动态创建。

**关于编辑：**

> 编辑。当一个人说“一切都是对象”（就像在 Python 中一样）时，他真的是指“一切都是一流的”吗？

术语对象可以松散地使用，并不意味着是一流的。将整个概念称为“一流实体”可能更有意义。但在 Python 中，他们的目标是让一切都成为一流的。我相信发表你的言论的人的意图是一流的。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-10-28T23:49:30.580

“当一个人说“一切都是对象”（就像在 Python 中一样）时，他的意思是不是真的是“一切都是一流的”？

是的。

Python 中的一切都是正确的对象。甚至是其他语言中的“原始类型”。

你会发现像这样的对象`2`实际上有一个相当丰富和复杂的界面。

```
>>> dir(2)
['__abs__', '__add__', '__and__', '__class__', '__cmp__', '__coerce__', '__delattr__', '__div__', '__divmod__', '__doc__', '__float__', '__floordiv__', '__getattribute__', '__getnewargs__', '__hash__', '__hex__', '__index__', '__init__', '__int__', '__invert__', '__long__', '__lshift__', '__mod__', '__mul__', '__neg__', '__new__', '__nonzero__', '__oct__', '__or__', '__pos__', '__pow__', '__radd__', '__rand__', '__rdiv__', '__rdivmod__', '__reduce__', '__reduce_ex__', '__repr__', '__rfloordiv__', '__rlshift__', '__rmod__', '__rmul__', '__ror__', '__rpow__', '__rrshift__', '__rshift__', '__rsub__', '__rtruediv__', '__rxor__', '__setattr__', '__str__', '__sub__', '__truediv__', '__xor__'] 
```

因为一切都是 Python 中的一等对象，所以很少有晦涩的特殊情况。

例如，在 Java 中，有些原始类型（int、bool、double、char）不是正确的对象。这就是为什么 Java 必须引入 Integer、Boolean、Double 和 Character 作为一等类型。这可能很难教给初学者——为什么原始类型和类必须并排存在并不明显。

这也意味着一个对象的类——它本身——一个对象。这与 C++ 不同，在 C++ 中，类在运行时并不总是有不同的存在。

的类型`2`是`type 'int'`对象，它具有方法、属性和类型。

```
>>> type(2)
<class 'int'> 
```

内置类型 like 的类型`int`是`type 'type'`对象。这也有方法和属性。

```
>>> type(type(2))
<class 'type'> 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-10-28T23:04:36.347

“一流”意味着您可以以通常的方式对它们进行操作。大多数时候，这只是意味着您可以将这些一等公民作为参数传递给函数，或者从函数中返回它们。

这对于对象来说是不言而喻的，但对于函数甚至类来说并不总是那么明显：

```
void f(int n) { return n * 2; }

void g(Action<int> a, int n) { return a(n); }

// Now call g and pass f:

g(f, 10); // = 20 
```

这是 C# 中的一个示例，其中函数实际上*不是*一流的对象。因此，上面的代码使用了一个小的解决方法（即一个名为的通用委托`Action<>`）来传递一个函数作为参数。其他语言，例如 Ruby 或 Python，甚至允许将类和代码块视为普通变量（或者对于 Ruby，常量）。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-01-06T19:03:53.767

[来自计算机程序结构和解释的](http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/)幻灯片，第 2A 课（1986 年），其中又引用了[Christopher Stracey](http://en.wikipedia.org/wiki/Christopher_Strachey)：

**一等公民的权利和特权：**

*   以变​​量命名。
*   作为参数传递给过程。
*   作为过程的值返回。
*   被合并到数据结构中

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-28T23:16:37.243

IMO 这是用来用自然语言描述事物的隐喻之一。该术语本质上是在将函数描述为第一类对象的上下文中使用的。

如果您考虑面向对象的语言，我们可以为对象赋予各种特性，例如：继承、类定义、传递给其他代码部分的能力（方法参数）、存储在数据结构中的能力等。如果我们能做到与通常不被视为对象的实体相同，例如 java 脚本中的函数，此类实体被视为第一类对象。

第一类本质上是指，不作为第二类处理（行为退化）。本质上，嘲笑是完美的或无法区分的。

# java - 在 Java 中从 MySQL 中检索记录

> ID：245199
> 
> 赞同：1
> 
> 时间：2008-10-28T23:01:29.660
> 
> 标签：java, mysql, arraylist

我正在用 Java 构建一个应用程序来从 MySQL 数据库中检索数据。执行查询后，我得到一个 ResultSet 并执行以下操作来提取记录：

```
while (rs.next())
        {
            for (int column = 1; column <= rm.getColumnCount(); column++) {
                row.add(rs.getObject(column));
            }
            result.add(row.toString());
            row.clear();
        } 
```

其中**rs** = ResultSet 和**rm** = ResultSetMetaData

问题是我必须做**result.add(row.toString());** 而不仅仅是**result.add(row);** （我想用它创建一个二维 ArrayList）。否则我会得到空的结果。

我试过把**row.clear();** 在开始时，在*for*循环之前，但这会导致我的所有结果都被最后一条记录的多个实例填充。就像*row*直到最后才添加到**结果**中，当它等于最后一条记录时。**在将 ArrayList行**作为元素添加到另一个 ArrayList 之前，我是否需要“提交”它？如果是这样，怎么做？另外，出于好奇，为什么**.toString()**工作方式不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T23:35:07.957

通过添加 row.toString()，您正在创建一个新的 String 对象以添加到结果中。

另一方面，通过添加行，您将相同的对象添加到结果中，因此，每次调用 row.clear() 时，都会清空结果中的所有行。

您应该做的是在 for 循环之前创建一个新的行对象，并且不要执行 row.clear()。下面是一个例子。

```
while (rs.next())
        {
            row = new ArrayList();

            for (int column = 1; column <= rm.getColumnCount(); column++) {
                row.add(rs.getObject(column));
            }

            result.add(row);
        } 
```

# .net - wcftestclient.exe - 编辑默认配置

> ID：245222
> 
> 赞同：5
> 
> 时间：2008-10-28T23:10:13.577
> 
> 标签：.net, wcf

`WCFTestClient``maxNameTableCharCount`如果 的大小大于默认值 (16384) ，则该工具似乎不起作用。

有没有办法在工具生成之前修改这个工具生成的配置文件的设置？

建立服务连接*后*，我可以修改配置文件内容。`maxNameTableCharCount`但是当这个工具试图检索服务元数据时，我收到一个抱怨大小的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-30T10:37:22.320

您是否尝试在服务配置中增加相同的值？AFAIK`maxNameTableCharCount`应该作为服务策略的一部分公开 - 并且应该在生成时传播到生成的客户端配置。

--larsw

# file - 文件的 CRC 检查

> ID：245223
> 
> 赞同：8
> 
> 时间：2008-10-28T23:10:42.873
> 
> 标签：file, filesystems, checksum, crc

我正在使用一个小型 FAT16 文件系统，我想为存储配置信息的单个 XML 文件生成 CRC 值。如果数据更改或损坏，我希望能够检查 CRC 以确定文件仍处于原始状态。

问题是，如何在不改变文件本身的 CRC 值的情况下，将 CRC 值放入文件中？我可以想到几个解决方案，但我认为这个问题必须有一个相当标准的解决方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-28T23:13:39.137

您可以将 CRC 值附加到文件的末尾。然后，在稍后计算 CRC 值进行校验时，省略最后四个字节。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-28T23:14:17.263

定义一个标头，生成除标头之外的所有内容的 CRC，然后将值放入标头中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-28T23:39:22.767

一个常见的解决方案是只使用不同的文件。每个文件旁边只有一个文件名相同但扩展名不同的文件。例如：foobar.txt 和 foobar.txt.md5（或 .crc）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-29T00:41:54.450

通信协议中广泛使用的常见解决方案是将 CRC 字段设置为 0，计算 CRC，然后将其替换为 0。校验码应该做相反的过程 - 读取 CRC，将字段归零，计算CRC 和比较。

此外，对于文件校验和，我强烈推荐 MD5 而不是 CRC。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-28T23:19:40.047

一种解决方案是使用 dsofile.dll 将扩展属性添加到您的文件中。您可以将 CRC 值（转换为字符串）保存为扩展文件属性。这样你就不会改变文件的结构。

dsofile.dll 是一个 ActiveX dll，因此可以从各种语言中调用它，但是它限制了您在 Windows 上运行。以下是有关 dsofile.dll 的更多信息：http: [//support.microsoft.com/kb/224351](http://support.microsoft.com/kb/224351)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-28T23:51:12.137

我不会将 CRC 存储在文件本身中。我将有一个您的程序使用的文件（我将使用 XML 格式），其中包含文件名列表及其关联的 CRC 值。没必要把它弄得那么复杂。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-28T23:15:08.947

没有办法做到这一点。您可以使文件的前 x 个字节（CRC 使用 32 位整数，因此 4 个字节）包含 CRC，然后在计算您的 CRC 时，您只能考虑最初 4 个字节之后的字节。

另一种解决方案是将 CRC 包含在文件名中。所以 MyFile.Config 最终会成为 MyFile.CRC1234567.Config。

# java - 我应该使用哪个库从 Linux / Python 编写 XLS？

> ID：245225
> 
> 赞同：7
> 
> 时间：2008-10-28T23:11:54.430
> 
> 标签：java, python, xls, jexcelapi, hssf

我想要一个*好的*原生 Python 库来编写 XLS，但它似乎不存在。令人高兴的是，Jython 做到了。

所以我试图在 jexcelapi 和 Apache HSSF 之间做出决定： [http ://www.andykhan.com/jexcelapi/tutorial.html#writing](http://www.andykhan.com/jexcelapi/tutorial.html#writing) [http://poi.apache.org/hssf/quick-guide.html](http://poi.apache.org/hssf/quick-guide.html)

（我不能使用 COM 自动化，因为我不在 Windows 上，即使我在，我也买不起 Office 许可证。）

我最初的想法是 POI/HSSF 非常彻底，但也非常 Java —— 一切似乎都比它需要的要难一些。很好的文档，但是试图弥合它所描述的内容和我需要完成的内容之间的差距让我头疼。

jexcepapi 似乎有一个更简单、更好（对我来说）的界面，但没有很好的文档或社区。

你会使用哪个，为什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-28T23:37:26.110

[xlwt](http://pypi.python.org/pypi/xlwt)有什么问题？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T02:14:27.527

+1 xlwt。[有关如何使用 xlwt](http://panela.blog-city.com/pyexcelerator_xlwt_cheatsheet_create_native_excel_from_pu.htm)以及[如何处理大型电子表格](http://panela.blog-city.com/creating_large_excel_spreadsheets_xlwt_in_python.htm)的帖子，请参见 Matt Harrison 的博客。另外，请查看 Google 上的[python-excel](http://groups.google.com.au/group/python-excel?lnk=li&hl=en)组“如果您使用 Python 读取、写入或以其他方式操作 Excel 文件”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T23:34:49.267

我会使用 JExcelApi，但这只是因为我以前使用过它。从来没有接触过HSSF。我能回忆起的最大的障碍是 JExcelApi 不支持一个单元格中的多种格式（例如，一半的文本为粗体，另一半为斜体或类似的东西）。我认为总的来说 JExcelApi 比 HSSF 更受限制，但这些限制从未妨碍我。

是的，接口的文档很少（并且底层机制不存在），但我认为这是可行的......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-21T12:26:55.657

如果您打算使用比非常简单的文本更多的东西来表现出色，我个人不建议使用 JExcel，反之亦然。

更高级的功能是从底层（基本上未记录的）低级代码/（记录的）Excel规范中抽象出来的。

我们遇到的另一个问题是 jexcel 在遇到无效公式时会严重失败。如果您需要解析客户提供的电子表格，这是一个问题。

新的 POI 版本（几乎）同时支持 xls 和 xlsx。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T23:33:20.813

Excel 将 VBA 使用的相同 OLE 自动化 API 公开给任何支持 COM 的东西。您可以使用 win32com（默认情况下包含在 ActiveState Python 中）以与在 VBA 中相同的方式操作电子表格。

# c# - 从 .Net 控制 ffdshow

> ID：245232
> 
> 赞同：6
> 
> 时间：2008-10-28T23:14:09.637
> 
> 标签：c#, .net, ffdshow

ffdshow 有这个[很棒的小 API](http://ffdshow-tryout.svn.sourceforge.net/viewvc/ffdshow-tryout/trunk/src/ffdshowRemoteAPI.cpp?view=markup)用于控制视频文件的播放。它允许您更改字幕、快进、获取正在播放的文件的名称等...

它实现为一个 Windows 消息循环，接受用户消息并使用 WM_COPYDATA 回发数据。

我想要允许我执行所有控制的 ac#/vb 类。（发送和接收消息）。我知道怎么写这个。我可能会创建一个隐藏窗口来连接 Windows 消息循环并来回发送消息。

我想知道是否有人已经这样做了，因为实现它有点繁琐，而且这是一个开源项目，所以我的工作时间非常有限。

### 这个问题仍然没有答案，赏金系统为这个问题选择了错误的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-09T20:58:52.180

看起来 FFDShow-tryout 的家伙已经构建了一个包装器。我还没有测试过（可能今晚），但它看起来很有希望。

[FFDShow 维基页面上的 FFDShowAPI](http://ffdshow-tryout.sourceforge.net/wiki/devel:controlling?s[]=ffdshowapi)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T17:01:12.447

类中的插件已创建并可在此处获得： http: [//damienbt.free.fr/Information.htm](http://damienbt.free.fr/Information.htm)

# java - jsp：在Java中转发而不使用JSP标签？

> ID：245236
> 
> 赞同：11
> 
> 时间：2008-10-28T23:15:12.787
> 
> 标签：java, jsp, jsp-tags, forward

我可以在 <% ... %> 块中使用与 <jsp:forward page="..." /> 等效的纯 Java 吗？

例如，我目前有一个类似这样的 JSP 页面：

```
<%
    String errorMessage = SomeClass.getInstance().doSomething();
    if (errorMessage != null) {
        session.setAttribute("error", errorMessage);
%>
<jsp:forward page="error.jsp" />
<%
    } else {
        String url = response.encodeRedirectURL("index.jsp");
        response.sendRedirect(url);
    }
%> 
```

必须打破 <% ... %> 块才能使用 jsp:forward 是丑陋的，并且由于缩进等原因使其更难阅读。

那么，我可以在不使用 JSP 标签的情况下在 Java 代码中进行转发吗？

像这样的东西是理想的：

```
<%
    String errorMessage = SomeClass.getInstance().doSomething();
    if (errorMessage != null) {
        session.setAttribute("error", errorMessage);
        someObject.forward("error.jsp");
    } else {
        String url = response.encodeRedirectURL("index.jsp");
        response.sendRedirect(url);
    }
%> 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-28T23:28:50.480

`someObject`您正在寻找的是[pageContext](http://java.sun.com/products/jsp/2.1/docs/jsp-2_1-pfd2/javax/servlet/jsp/PageContext.html#forward(java.lang.String))。

这个对象是在 JSP 中隐式定义的，所以你可以像这样使用它：

```
pageContext.forward("<some relative jsp>"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-29T01:37:26.790

如果可以的话，你真的应该尽量避免使用脚本，而且在你的情况下，你正在做的很多事情都可以用 JSTL 代码代替。您的示例的以下替换更清洁，IMO：

```
<%
  // Consider moving to a servlet or controller/action class
  String errorMessage = SomeClass.getInstance().doSomething();
  pageContext.setAttribute("errorMessage", errorMessage);
%>
<c:choose>
  <c:when test="${not empty errorMessage}">
    <c:set var="error" scope="session" value="${errorMessage}" />
    <jsp:forward page="error.jsp" />
  </c:when>
  <c:otherwise>
    <c:redirect url="index.jsp" />
  </c:otherwise>
</c:choose> 
```

理想情况下，您应该修改 error.jsp，以便甚至不需要在会话中设置错误消息，但我不想过多地更改您的设计。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-29T11:41:54.773

一个简单的方法：

```
<%@page errorPage="Error.jsp" %>

<%
 String errorMessage = SomeClass.getInstance().doSomething();
 if (errorMessage != null) {
       throw new Exception(errorMessage); // Better throw the exception from doSomething()
 }
 pageContext.forward("index.jsp");
%>

Error.jsp
.........
<%@ page isErrorPage='true' %>
<%
out.print("Error!!!");  
out.print(exception.getMessage());
%> 
```

更好的方法：

从 servlet 调用 doSomething()。在 web.xml 中设置错误页面

```
<error-page>
        <exception-type>java.lang.Exception</exception-type>
        <location>/WEB-INF/jsp/Error.jsp</location>
</error-page> 
```

# python - 使用 FastCGI 或 mod_python 运行 Django

> ID：245237
> 
> 赞同：20
> 
> 时间：2008-10-28T23:16:23.000
> 
> 标签：python, django, apache, fastcgi

你会推荐哪个？哪个更快，更可靠？apache mod_python 还是 nginx/lighttpd FastCGI？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-29T03:06:03.943

我都做过，而且 Apache/mod_python 往往更容易使用和更稳定。但是这些天我跳到了 Apache/mod_wsgi，这是我想要的一切，还有更多：

*   轻松管理守护进程。
*   结果，**更好的**进程隔离（使用 mod_python 在同一个 Apache 配置中运行多个站点几乎总是以麻烦告终——当你这样做时，环境变量和 C 扩展在站点之间泄漏）。
*   轻松重新加载代码（设置正确，您只需触摸`.wsgi`文件即可重新加载，而不是重新启动 Apache）。
*   更可预测的资源使用。使用 mod_python，给定的 Apache 子进程的内存使用可以跳跃很多。使用 mod_wsgi 它非常稳定：一旦加载了所有内容，您就知道它将使用多少内存。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-28T23:32:27.807

使用 FastCGI 的 lighttpd 名义上会更快，但实际上运行 python 代码所花费的时间和它所做的任何数据库访问都绝对会让你在 Web 服务器之间获得的任何性能优势相形见绌。

如果您想在 django 之外编写执行摘要身份验证或任何花哨的 HTTP 标头获取/设置之类的代码，mod_python 和 apache 将在功能方面为您提供更多的灵活性。也许您想使用 apache 的其他内置功能，例如 mod_rewrite。

如果内存是一个问题，远离 apache/mod_python 会有很大帮助。Apache 倾向于使用大量的 RAM，并且粘合到所有 apache 功能中的 mod_python 代码也占用了大量的内存空间。更不用说 apache 的多进程特性往往会消耗更多的 RAM，因为每个进程都会增长到它最密集的请求的大小。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-03T08:51:51.727

带有 mod_wsgi 的 Nginx

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-28T23:29:58.950

就我个人而言，我已经使用 FastCGI 工作了一段时间（大约 6 个月），并且在加载页面时响应时间“似乎”比 mod___python 更快。不过，对我来说，关键原因是我看不到从同一个 apache / mod_python 安装中创建多个站点的明显方法，而 FastCGI 是相对简单的。

不过，我还没有进行任何特别彻底的实验:-)

**[编辑]**不过从经验来看，第一次设置 FastCGI 可能会有点痛苦。我一直想写一个指南..！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-29T01:14:18.177

我将它与 nginx 一起使用。不确定它是否真的更快，但肯定会减少 RAM/CPU 负载。此外，运行多个 Django 进程并让 nginx 将每个 URL 前缀映射到不同的套接字也更容易。仍然没有充分利用 nginx 的 memcached 模块，但第一次测试显示出*巨大的*速度优势。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-29T01:25:43.240

还有 mod_wsgi，它似乎比 mod_python 更快，并且守护模式的操作类似于 FastCGI

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-20T05:01:46.343

我推荐 WSGI 配置；我一直想放弃 apache，但服务器上总有一些遗留应用程序似乎需要它。此外，WSGI 应用程序生态非常多样化，它允许在服务器和应用程序之间以菊花链方式连接 WSGI“中间件”等巧妙的技巧。

[但是，一些应用程序和 apache mod_wsgi](http://groups.google.com/group/modwsgi/browse_thread/thread/a488d2551c4c7df0)目前存在已知问题，尤其是一些 ctypes 应用程序，因此如果您尝试运行广泛使用 ctypes 的[geodjango ，请务必小心。](http://geodjango.org/)我目前正在通过自己回到 fastcgi 来解决这些问题。

# javascript - 使用 jQuery 对象的 jQuery 祖先

> ID：245241
> 
> 赞同：7
> 
> 时间：2008-10-28T23:18:52.637
> 
> 标签：javascript, jquery

我想使用两个 jQuery 对象检查祖先。它们没有 ID，只能作为 jQuery 对象（或 DOM 节点，如果您调用`get()`）。jQuery `is()`仅适用于表达式，因此此代码将是理想的，但不会工作：

```
var someDiv = $('#div');

$('a').click(function() {
    if ($(this).parents().is(someDiv)) {
        alert('boo');
    }
} 
```

只是想看看一个元素是否是另一个元素的子元素，如果可能的话，我想避免回到 DOM 领域。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-28T23:33:16.523

您可以使用 index() 方法来检查一个元素是否存在于列表中，那么下面的方法会起作用吗？

```
var someDiv = $('#div');

$('a').click(function() {
    if ($(this).parents().index(someDiv) >= 0) {
        alert('boo');
    }
} 
```

来自[#index 参考](http://docs.jquery.com/Core/index#subject)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-29T02:54:06.260

`(this).parents().index(someDiv) >= 0`正如@Gareth 建议的那样，检查会正常工作。

但是，使用[jQuery 祖先插件](http://plugins.jquery.com/project/ancestry)**更快/更**有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T23:44:43.240

按照这些思路， parents() 可以选择接受选择器本身：

```
$('a').click(function() {
  if ($(this).parents("#div").length) {
    alert('boo');
  }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T23:54:59.990

一种方法是使用过滤器功能

```
$('a').click(function() {
    $(this).parents().filter(function() {
       return this == someDiv[0];
    }).each(function() {
       alert('foo');
    })
} 
```

我认为您也可以使用 jQuery.inArray

```
if ($.inArray( someDiv, $(this).parents() ) ) {
        alert('boo');
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-29T00:00:09.823

仅仅使用 CSS 选择器不会得到你想要的结果吗？

```
$( '#div a' ).click( function() { ... } ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-29T07:44:01.150

试试这个：

```
var someDiv = $('#div');

$('a').click(function() {
    if ($.inArray($(this).parents().get(), someDiv.get(0)) {
        alert('boo');
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-09-01T05:52:08.030

```
var $element = $('a');
while ($element && !$element.is('someDiv')) {
   var $element = $element.parent();
}; 
```

# java - 在Java中创建给定大小的文件

> ID：245251
> 
> 赞同：55
> 
> 时间：2008-10-28T23:26:31.110
> 
> 标签：java, file

有没有一种**有效**的方法可以在 Java 中创建具有给定大小的文件？

在 C 中，它可以用[ftruncate](http://linux.die.net/man/2/ftruncate)来完成（参见[那个答案](https://stackoverflow.com/questions/139261/how-to-create-a-file-with-a-given-size-in-linux#245239)）。

大多数人只会将**n 个**虚拟字节写入文件，但必须有更快的方法。我在考虑[ftruncate](http://linux.die.net/man/2/ftruncate)以及[稀疏文件](http://en.wikipedia.org/wiki/Sparse_file)……</p>

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2008-10-28T23:38:16.170

创建一个新的[RandomAccessFile](https://docs.oracle.com/javase/8/docs/api/java/io/RandomAccessFile.html)并调用 setLength 方法，指定所需的文件长度。底层 JRE 实现应该使用您的环境中可用的最有效的方法。

以下程序

```
import java.io.*;

class Test {
     public static void main(String args[]) throws Exception {
           RandomAccessFile f = new RandomAccessFile("t", "rw");
           f.setLength(1024 * 1024 * 1024);
     }
} 
```

在 Linux 机器上将使用 ftruncate(2) 分配空间

```
6070  open("t", O_RDWR|O_CREAT, 0666)   = 4
6070  fstat(4, {st_mode=S_IFREG|0644, st_size=0, ...}) = 0
6070  lseek(4, 0, SEEK_CUR)             = 0
6070  ftruncate(4, 1073741824)          = 0 
```

而在 Solaris 机器上，它将使用 fcntl(2) 系统调用的 F_FREESP64 函数。

```
/2:     open64("t", O_RDWR|O_CREAT, 0666)               = 14
/2:     fstat64(14, 0xFE4FF810)                         = 0
/2:     llseek(14, 0, SEEK_CUR)                         = 0
/2:     fcntl(14, F_FREESP64, 0xFE4FF998)               = 0 
```

在这两种情况下，这都会导致创建稀疏文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-28T23:34:35.273

您可以打开文件进行写入，寻找偏移量 (n-1)，然后写入单个字节。操作系统会自动将文件扩展到所需的字节数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-10-06T20:44:23.730

从 Java 8 开始，此方法适用于 Linux 和 Windows：

```
final ByteBuffer buf = ByteBuffer.allocate(4).putInt(2);
buf.rewind();

final OpenOption[] options = { StandardOpenOption.WRITE, StandardOpenOption.CREATE_NEW , StandardOpenOption.SPARSE };
final Path hugeFile = Paths.get("hugefile.txt");

try (final SeekableByteChannel channel = Files.newByteChannel(hugeFile, options);) {
    channel.position(HUGE_FILE_SIZE);
    channel.write(buf);
} 
```

# sql - 如何将 SQL Server 数据库上传到共享托管环境？

> ID：245252
> 
> 赞同：5
> 
> 时间：2008-10-28T23:26:53.510
> 
> 标签：sql, database, upload

我们有一个常见的问题是将我们的开发 SQL 2005 数据库移动到网站托管公司的共享 Web 服务器上。

理想情况下，我们想要一个将数据库结构和数据作为精确副本传输的系统。

这通常可以通过恢复备份来实现。但是因为它们是共享的 SQL 服务器，我们无法恢复备份——我们无法访问实际的机器。

我们可以生成一个脚本来创建数据库结构，但是我们不能通过菜单项 Tasks/Import Data 进行数据传输，因为我们可能会违反外键约束，因为表是按照与数据库模式冲突的顺序导入的。此外，如果将索引设置为自动生成，则可能不会复制索引。

因此，我们留下了一个混乱的操作：

1.  在 SQL 2005 中创建一个脚本，以生成 SQL 2000 格式的数据库。
2.  运行脚本以在 SQL 2000 中创建 SQL 2000 数据库。
3.  在 SQL 2000 中创建一个脚本，生成没有索引和外键的数据库结构。
4.  在生产服务器上运行此脚本。您现在有一个可以上传数据的数据库结构。
5.  使用 SQL 2005 将数据传输到带有任务/导入数据的生产服务器。
6.  使用 SQL 2000 生成一个脚本，该脚本使用索引和键创建数据库。
7.  仅复制生成索引和外键的命令。这些位于表创建命令之后。注意：在 SQL 2005 中，索引和外键是一体生成的，不能轻易分开。
8.  在生产数据库上运行此脚本。

瞧！上载数据库时，所有数据和键/约束都已到位。多么混乱和容易出错的系统。

有更好的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-28T23:30:15.563

Scott Gu 写了几篇关于这个主题的文章：

[用于 Web 托管的 SQL Server 数据库发布工具包](http://weblogs.asp.net/scottgu/archive/2007/04/19/update-of-sql-server-database-publishing-toolkit-for-web-hosting.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T09:12:46.293

生成脚本适用于创建数据库对象，但不适用于传输数据库信息。例如，开发人员需要预先填充某些数据的客户端特定数据库。

我遇到的问题之一是 SQL Server 2005+ 中的新 MAX 类型。（nvarchar(max)、varchar(max) 等）当然，当您实际使用 Sql Server Express 时，情况会更糟，除了创建自己的脚本来创建数据之外，它不允许导出。

我建议切换到允许您能够 FTP 备份文件并且不需要您使用自己的脚本的托管公司。这就是 SQL Server 的全部意义所在，对吧？提供更多使用更友好的工具。如果托管公司把它拿走，你不妨转移到 MySql 以便于倾销信息。

WebHost4Life 是此类别的救生员。他们提供 FTP 到数据库服务器以上传您的备份文件或 MDF 和 LDF 文件以供附件！当我看到 GoDaddy 有你提到的类似限制时，我非常沮丧。他们的工具并没有告诉我这是一个错误的导入，我无法弄清楚为什么我的网站返回 500 个错误。

另一个注意事项：我不确定哪个被认为更安全。我在 GoDaddy 中启用了外部连接并与 Management Studio 连接，我能够看到该服务器上的每个数据库！我无法访问它们，但我现在有了这些信息。双重打击是 GoDaddy 要求 DB 的用户名与 DB 相同！现在您需要做的就是针对这数百个数据库的垃圾邮件密码！

另一方面，Webhost4life 仅在 Management Studio 中显示您的特定数据库。他们让您选择自己的数据库名称和用户名，彼此独立。他们只在用户和数据库名称的末尾附加相同的唯一 ID，以防止它们与其他人发生冲突。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T23:33:06.913

您不应依赖恢复备份来复制/传输数据库。你需要使用脚本——相信我你会做得更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T23:56:02.140

我已将 RedGate 比较工具与共享主机一起使用，并且效果很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T01:03:56.123

数据库生成脚本*很*杂乱，但它们也有几个优点……嗯，让痛苦更容易忍受。

首先，如果您将 DB 脚本本身视为真正的编程任务，您可以封装这些混乱。如果您生成一次脚本（使用数据库工具），您可以将表结构方面与约束方面（键、索引等）分开。同样，您可以将数据导出一次，但将其拆分为不经常更改但正确操作所必需的“系统”数据（税收或运费等数据）、易于识别的“测试”数据和“需要从旧数据库版本移动到新数据库版本的操作数据（上周的订单）。

完成之后的前 3 分钟，一切都很棒：您可以在几分钟内重新生成一个带有或不带有测试数据的新数据库。不幸的是，3 分钟后，数据库不同步了，至少在数据方面，如果在结构方面不那么频繁的话。

我个人喜欢将每个表的结构作为一个单独的 SQL 文件（它是一个单独目录中的单独文件的约束，一个文件中的测试数据，另一个文件中的系统数据等）。一方面，这意味着在进行更改时必须触及几个不同的文件，但另一方面，它可以更容易地查看更改的粒度：在版本控制日志中就可以了。（我可能会相信多文件是一种错误的策略......）

所有这一切都基于这样的假设，即您有一些工具可以实际运行涉及许多文件的复杂脚本，并且不仅限于某些基于 Web 的控制面板，当您说“我们不是可以访问实际机器。” 我觉得您不能进行自定义软件开发，并且在服务器上没有*某种*shell 访问权限；托管业务具有足够的竞争力，您当然可以很容易地找到一个脚本友好的主机。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-15T08:00:51.750

检查 webhsoting 公司是否提供[myLittleBackup](http://mylittlebackup.com/mlb/en/spotlight.aspx) 这绝对是从开发服务器“安装”数据库到共享 sql 服务器的最简单的解决方案

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-13T06:33:37.743

SQL Server 2008 用户的答案。

我遇到了与 OP 完全相同的问题，但我使用的是 SQL Server 2008，而我的共享托管公司是 GoDaddy。这是将 DB + 数据复制到 GoDaddy 数据库的解决方案......

在 Visual Studio 2010 中，转到服务器资源管理器（在 VS Express 中，我认为它称为数据库资源管理器）。右键单击数据库并选择发布到提供者...这将打开数据库发布向导...通过向导，它将在您的本地计算机上创建一个 xxx.sql 文件...

打开 SQL Server Management Studio 并连接到 GoDaddy 数据库（您应该已经通过他们网站中的 GoDaddy 控制面板创建了它）...

打开 Windows 资源管理器并找到 xxx.sql 文件并双击它。该脚本应在 SSMS 中打开。在“适当的数据库内”执行脚本......瞧，完成了。

# svn - 颠覆与 CVS

> ID：245290
> 
> 赞同：51
> 
> 时间：2008-10-28T23:44:21.773
> 
> 标签：svn, version-control, cvs

我已经使用了一些 SVN 和 CVS，但需要为我将要开始的新项目选择一个。

任何人都可以广泛使用这两种方法，请提供一些优点和缺点，他们认为哪个更好？最好的学习资源也将不胜感激。

这将是一个小项目，只有一两个开发人员开始。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-10-28T23:51:31.167

我都用过。没有可比性；你想要svn。使用 CVS 的唯一原因是因为您正在进入或接管一个不想改变现状的管理层的遗留系统。如果您开始一个新项目，那么从逻辑上讲 CVS 比 Subversion 更好几乎是不可能的。

如果你用谷歌搜索，你会发现很多比较，以及使用 Subversion 而不是 CVS 的基本原理。Subversion 相对于 CVS 的一些优势：

*   可以干净地移动或重命名文件或目录
*   原子提交
*   “便宜”的复制和分支
*   提交是整个树上的变更集（不仅仅是单个文件的历史）

说了这么多，我建议你也探索一些分布式的 VCS，比如 Bazaar、Mercurial 和 git。我个人在所有项目中都使用 git。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-29T01:51:12.860

Subversion 比 CVS 有一些实质性的胜利：

1.  好的远程选项 http/https/svn vs pserver
2.  原子提交
3.  无处不在的工具支持
4.  改名
5.  目录版本控制

但是它有严重的缺点。到目前为止最大的是分支和标签不是 svn 中的一等公民，它们只是遵守约定的目录。除了失去真正分支和标记的一些好处（在其他评论中提到）之外，它产生的最大问题是 if 很容易搞砸。

Subversion 使用约定而不是配置意味着您需要提前考虑您的存储库结构并确保每个人都遵守它。否则你会为子孙后代创造一个伤害的世界，更不用说任何需要了解你的回购的工具了。

合并和镜像几乎不存在（很好的帮助）pre 1.5。1.5 已采取措施解决这两个问题，但仍有改进的余地。在颠覆中合并仍然比它需要的要困难得多。

SVN over CVS 几乎是轻而易举的事。但是，如果您没有考虑 DVCS 必须提供的功能（Git、Hg、Bzr），或者如果您的预算允许，那么您可能会失职，而如果您的预算允许的话，那么有一些商业工具具有良好的声誉（Accurev、Perforce）。

Subversion 可能是正确的选择，但您必须做好功课才能获得最佳结果。从红皮书开始[http://svnbook.red-bean.com/](http://svnbook.red-bean.com/)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-29T00:02:11.723

尽管在大多数情况下我会选择 Subversion 而不是 CVS，但您应该知道 Subversion 缺少什么：

*   CVS 将标签和分支视为不同的事物；颠覆没有。这意味着建立在 Subversion 之上的第三方工具（例如，集成了源代码控制的 IDE）很难知道其中的区别。你通常需要做一些特殊的配置来告诉它你的标签和分支在哪里，你必须确保你的用户坚持特定的文件系统布局。

*   Subversion 不能查看一个文件并告诉你某人在什么时候从它创建了一个分支或标签。CVSGraph 之类的工具可以使用此信息来绘制文件历史记录树。要使用 Subversion 做到这一点，您需要搜索所有分支/标签目录，而我还没有看到任何工具可以很好地做到这一点。

*   根据我的经验，CVS 存在的时间更长，而且第三方工具更稳定。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-29T00:01:52.583

称我为老式的，但我更喜欢 CVS 下的分支/标记模型。

在 CVS 中，分支和标签是不同的*东西*。标签是修订的标签。它们对于标记*PRODUCTION*标记以将文件同步到您的网络服务器等事情非常有用。您不必合并来更新*PRODUCTION*文件——您只需移动标签。

分支与主文件位于相同的“命名空间”中——很容易追踪特定文件的所有模块。

在 SVN 中没有标签之类的东西。只有树枝。如果你想要标签，你需要创建一个分支并假装它是一个标签。分支基本上是文件的副本。上次我使用 SVN 进行分支/合并时，如果您希望将其重新合并在一起，则必须记录预分支文件的修订版（注意，我不是 SVN 专家，所以这可能已经改变）。

话虽如此，我认为 SVN 在其他方面都更好，您可能不应该使用 CVS 开始一个新项目。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-28T23:49:42.247

我怀疑你会得到很多答案。他们甚至可能都同意。

在这两个选择之间，我相信毫无疑问您应该使用 Subversion。Subversion 被构建为“更好的 CVS”，因此，没有人再积极维护 CVS。Subversion 能够重命名和移动文件而不会丢失历史记录，支持原子提交，具有更强大的存储库格式，具有更现代的访问方法，具有更好的第三方工具支持，等等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-28T23:49:35.603

Subversion 就像“一个更好的 CVS”。它可以很好地处理移动文件和目录。它具有分支支持，尽管不如分布式 VCS。

您也可以考虑使用分布式 VCS，例如 git、bazaar 或 mercurial。

编辑：这是[一个类似问题的链接](https://stackoverflow.com/questions/1261/what-are-the-advantages-of-using-svn-over-cvs)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T23:45:23.650

一般来说 Subversion .. 但是你应该注意资源问题。

当我在一家游戏公司工作时，我们有几个目录包含数百个小文件，而其他目录包含数百个 meg 文件。当我们从 CVS 切换到 Subversion 时，检查 repo 的速度从一小时减少到四五个小时。更新速度也慢得多。

与原生 csv pserver 相比，这几乎可以肯定是由于使用 http 或 ssh 传输文件数据，但是由于通过 ssh 或 webdav 设置 svn 非常容易，人们往往不会考虑协议开销。但是，您可以使用本机 svn 协议，这应该可以缓解问题，我们没有在我的旧公司进行测试。

另一个经常被忽略的问题是存储空间，我们发现 subversion 在本地使用的存储空间确实是 CVS 的数倍。我似乎记得它存储了存储库数据的本地副本以加速差异，除非您在存储库中存储数 GB，否则这不会是一个大问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-16T04:27:25.863

我已经使用 subversion 3.5 年了，现在我搬到了另一家使用 CVS 进行源代码控制的公司。起初，两者之间没有太多区别，但谈到合并操作（这是我最关心的问题），我可以说 CVS 做得更好。SVN 中的分支/标签的概念令人困惑，而在 CVS 中却非常清晰。在 CVS 中合并（在我的例子中是集成一个分支）也比在 SVN 中容易得多。到目前为止，CVS 的弱点在我看来只有原子提交。否则，这将是一个不错的选择。

# apache-flex - 在 Flex 中调整容器大小以仅遵守父容器的显式尺寸的最佳方法

> ID：245292
> 
> 赞同：7
> 
> 时间：2008-10-28T23:46:22.253
> 
> 标签：apache-flex, flash, layout

近一年来我一直在使用 Flex 遇到这个问题，每次我都想出一个暂时有效的快速破解解决方案。我想看看是否有人有更好的主意。

以下是问题的条件：

```
|------Container  ------------|
|  explicitHeight:  400 (or whatever)
|                             |
|  |-------- VBox  -------|   |
|  |  percentHeight: 100  |   | 
|  |                      |   |
|  |  |-Repeater------|   |   |
|  |  | Potentially   |   |   |
|  |  | a lot of stuff.   |   |
|--|--|---------------|---|---| 
```

问题是，与我希望发生的相反，VBox 将始终扩展以容纳其中的内容，而不是坚持其父级的显式高度并创建滚动条。

我的解决方案是在对父项的引用中进行硬编码（或者无论我们需要在显示列表的多远位置找到一个明确设置的值而不是百分比）。

我什至考虑在实用程序类中使用它：

```
public static function getFirstExplicitHeightInDisplayList(comp:UIComponent):Number{
    if (!isNaN(comp.explicitHeight)) return comp.explicitHeight;
    if (comp.parent is UIComponent) return    
         getFirstExplicitHeightInDisplayList(UIComponent(comp.parent));
    else return 0;
} 
```

请告诉我有更好的方法。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-17T16:32:47.607

设置 minHeight = 0 就是您需要做的所有事情。

这告诉 VBox 在调整自身大小时忽略它的孩子的测量值，并根据它自己/它的父母约束来计算它的高度。像往常一样设置其他所有内容，滚动和其他所有内容都将完美运行。

一年前花了几天时间在这上面——这并不直观，他们本可以更好地命名该属性。希望这可以节省你们一些时间...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-29T10:40:02.963

您必须在 VBox 上使用“autoLayout”参数，因为文档说：

*“默认情况下，VBox 容器的大小足以将图像保持在原始大小。如果禁用布局更新，并使用缩放效果放大图像，或使用移动效果重新定位图像，图像可能会超出 VBox 容器的边界。*

*您将 autoLayout 属性设置为 false，因此 VBox 容器不会随着图像大小而调整大小。如果图像变大调整到超出 VBox 容器边界的大小时，容器会添加滚动条并在其边界处剪切图像。*

我希望这会对你有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T17:54:00.740

AutoLayout=false 似乎只防止在孩子的*大小*改变时重新运行布局。但是，如果您添加或删除子项，布局仍将重新运行。

设置 minHeight=0 确实将 VBox 的（外部）大小与子项的大小和数量完全断开，这正是我想要的。

翻阅 Flex 源代码，我没有看到设置 minHeight=0 使其按我想要的方式工作的机制，所以我向 Yarin 的发现致敬。谢谢！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T01:13:11.993

设置容器的属性：

```
clipContent = true;
verticalScrollPolicy = "off" 
```

然后你的 VBox 应该在它有时自动剪辑`percentHeight = 100`；

在 Flex 3 中为我工作。

如果您需要真正花哨，可以在对象上设置 scrollRect ：

```
scrollRect = new Rectangle(x, y, w, h); 
```

取决于你需要它做什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T13:47:03.947

事实上，Yarin Kessler 在这里为我们带来了唯一正确的答案（不幸的是，我无权评论它的帖子，这就是我在这里这样做的原因）。

当您的 HBox 大小基于百分比值时，您希望只有它的容器会影响它的大小。那是错误的，还有一条规则，一条更强大的规则。事实上，容器（HBox 是）具有最小尺寸，这是它自己的子组件的默认/显式尺寸的添加。

因此，如果您的百分比值导致的值小于最小尺寸，则最小尺寸获胜并应用于 HBox。由于 HBox 正在显示其所有子项，因此不需要滚动条。

所以使用：

```
minHeight = 0;
minWidth = 0; 
```

就像告诉 HBox 它的最小尺寸是 0 而不是它的子默认尺寸。您正在重新定义它，这样最小尺寸小于百分比值并输掉战斗。

我在 Adob​​e 文档中找到的唯一一个解释这一点的短语是：

> 基于百分比的容器大小是建议性的。Flex 使容器足够大以适应其最小尺寸的子级。

希望我说清楚了，

（随时纠正我不正确的英文句子......）

# python - 如何从 Python 函数或方法中获取函数或方法的名称？

> ID：245304
> 
> 赞同：43
> 
> 时间：2008-10-28T23:52:09.997
> 
> 标签：python

我觉得我应该知道这一点，但我一直无法弄清楚......

我想从它内部获取一个方法的名称——恰好是一个集成测试——这样它就可以打印出一些诊断文本。当然，我可以在字符串中硬编码方法的名称，但如果可能的话，我想让测试更干一点。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-10-29T00:13:35.663

这似乎是使用模块的最简单方法`inspect`：

```
import inspect
def somefunc(a,b,c):
    print "My name is: %s" % inspect.stack()[0][3] 
```

您可以将其概括为：

```
def funcname():
    return inspect.stack()[1][3]

def somefunc(a,b,c):
    print "My name is: %s" % funcname() 
```

感谢通过 google 找到的 Stefaan [Lippens 。](http://stefaanlippens.net/python_inspect)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-10-29T02:09:48.300

涉及自省via`inspect`等的答案是合理的。但可能还有另一种选择，具体取决于您的情况：

如果您的集成测试是使用[unittest](http://docs.python.org/library/unittest.html)模块编写的，那么您可以`self.id()`在您的 TestCase 中使用。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-29T00:07:24.443

此装饰器通过将方法名称作为关键字参数传递，使方法名称在函数内部可用。

```
from functools import wraps
def pass_func_name(func):
    "Name of decorated function will be passed as keyword arg _func_name"
    @wraps(func)
    def _pass_name(*args, **kwds):
        kwds['_func_name'] = func.func_name
        return func(*args, **kwds)
    return _pass_name 
```

你会这样使用它：

```
@pass_func_name
def sum(a, b, _func_name):
    print "running function %s" % _func_name
    return a + b

print sum(2, 4) 
```

但也许你想直接在装饰器内部写你想要的东西。然后代码是在装饰器中获取函数名称的方法的示例。如果您提供有关您想在函数中执行的操作的更多详细信息，这需要名称，也许我可以提出其他建议。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-29T01:58:33.657

```
# file "foo.py" 
import sys
import os

def LINE( back = 0 ):
    return sys._getframe( back + 1 ).f_lineno
def FILE( back = 0 ):
    return sys._getframe( back + 1 ).f_code.co_filename
def FUNC( back = 0):
    return sys._getframe( back + 1 ).f_code.co_name
def WHERE( back = 0 ):
    frame = sys._getframe( back + 1 )
    return "%s/%s %s()" % ( os.path.basename( frame.f_code.co_filename ),     
                            frame.f_lineno, frame.f_code.co_name )

def testit():
   print "Here in %s, file %s, line %s" % ( FUNC(), FILE(), LINE() )
   print "WHERE says '%s'" % WHERE()

testit() 
```

输出：

```
$ python foo.py
Here in testit, file foo.py, line 17
WHERE says 'foo.py/18 testit()' 
```

使用“back = 1”查找有关两个级别的信息返回堆栈等。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-28T23:56:35.277

我认为该[`traceback`](http://www.python.org/doc/2.5.2/lib/module-traceback.html)模块可能具有您正在寻找的内容。特别是，该`extract_stack`功能看起来可以完成这项工作。

# c# - 在仍以 .NET 3.5 运行时为目标时，可以使用哪些 C# 4.0 功能？

> ID：245306
> 
> 赞同：2
> 
> 时间：2008-10-28T23:54:07.357
> 
> 标签：c#

使用 C# 3.0，您可以使用它的许多特性（对象初始化器、var 变量、lambda 表达式），同时仍然面向 .NET 2.0 或 3.0。

在仍以 .NET 2.0、3.0 或 3.5 运行时为目标时，可以使用哪些新的 C# 4.0 功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T00:14:31.357

*   动态特性：可能不是。我想他们可以在没有 DLR 的情况下实现动态功能，但这似乎不太可能。

*   新的通用约束：CLR 支持它们

*   可选和命名：CLR 已经支持它（VB 风格）

更新：我刚刚听说 C# 4 编译器不支持 4.0 框架下的任何内容。

# svn - Subversion 存储库错误

> ID：245308
> 
> 赞同：3
> 
> 时间：2008-10-28T23:54:35.297
> 
> 标签：svn, version-control

这个让我摸不着头脑。

我在 Ubuntu 上运行 Subversion 1.3.1 (r19032)。直到最近，当我尝试在转储之前运行 svnadmin verify 时，一切都很好。这是错误消息：

> svnadmin：无效的差异流：insn 0 无法解码

我四处寻找解释和修复，但似乎找不到。颠覆专家，我需要你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T00:05:16.477

您应该确保`svnadmin`为您的存储库版本使用正确的版本。使用错误的版本可能会出现这样的错误。

话虽如此，1.3.x 版本现在已经很老了，您应该考虑升级到最新的 1.5.x。

我也通过google发现[有些版本的SVNKit](http://www.nabble.com/Re:-svn:-Invalid-diff-stream:-insn-0-cannot-be-decoded-p17756765.html)会导致这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T11:31:08.527

不幸的是，我不知道如何解决您的实际问题。

关于未来的预防措施：我同意 Greg Hewgill 的观点：在 subversion 1.3.1 中有几个已知的数据存储库损坏错误。最后一个已知的补丁在 1.4.6 中（当然也在所有 1.5.x 和所有未来版本中打了补丁）。因此，如果可能的话，您可以升级到 Ubuntu 8.04 (dapper drake)，它带有 subversion 1.4.6（以及一些 ext3 文件系统补丁）。如果您升级到 dapper drake，请确保使用 e2fslibs 的 dapper drake 版本重新格式化您的 ext3 分区，并对其进行坏块检查（在大分区上这可能需要几个小时）： e2fsck -c -c -j /开发/

此外，在许多情况下，对存储库损坏负责的不是颠覆，而是底层平台（即大多数情况下的硬件）。Subversion 信任底层平台，它自己不做校验和。这意味着，如果您确实有一个有价值的源代码存储库，并且不想不时播放未损坏的存储库备份版本的备份，那么您应该投入一些钱并将存储库放在具有 ECC 内存的专用盒子上， Solaris 操作系统和 ZFS 文件系统位于 3 路 RAID-1 ZFS 镜像（三个驱动器上的冗余 zfs softare RAID 镜像）。ZFS 在进入存储控制器之前对每一位进行校验和，而 ext3 不会。

**硬件位错误**在现实生活中确实会一次又一次地发生。Subversion 没有检测到这些。因此，您必须使用带有执行校验和以及 ECC 内存的文件系统的操作系统。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T15:05:30.230

在重命名文件和目录后不久，我在 svnadmin 1.5 上遇到了同样的错误。具体来说，我将一些文件从“文件名”重命名为“文件名”，SVN 假装这没问题……只是后来当我尝试重新结帐时吓坏了。当我尝试重新结帐时，我收到一条关于文件不存在的奇怪中止消息。

所以这自然导致我做了一个 svnadmin 转储，然后 svnadmin verify 只是为了得到你指定的相同消息。

我不知道修复。我像这样解决这个问题：

1.  转储存储库的下一个先前版本并在转储上运行 svnadmin verify。
2.  如果仍然出现错误，请转到步骤 1。
3.  在验证了良好的转储后，我删除了整个 SVN 存储库，重新创建它，并从良好的转储文件中导入。

确保您的转储文件具有所有增量，以便您将更改历史记录到最后一个好点。

我丢失了一些代码，但并没有太痛苦。

# javascript - Google Analytics 域跟踪 API _link() 方法

> ID：245317
> 
> 赞同：2
> 
> 时间：2008-10-28T23:57:31.017
> 
> 标签：javascript, google-analytics

有没有其他人在使用谷歌的域跟踪 API 时遇到任何问题，我特意谈论的是 _link() 方法。

[文档在这里](http://code.google.com/apis/analytics/docs/gaJS/gaJSApiDomainDirectory.html#_gat.GA_Tracker_._link)

提供的示例显示应该在 onclick 事件中使用 _link() 方法，如下所示：

```
<a href="http://www.newsite.com" onclick="pageTracker._link('http://www.newsite.com');return false;">Go to our sister site</a> 
```

但是，这实际上只是使链接...什么都不做（很可能是因为“返回错误”）。

我的理解是 pageTracker._link() 方法“应该”向 url 添加其他参数并执行它自己的 document.location 样式重定向。

任何想法/捕获/以前的帖子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T00:25:45.733

很抱歉这个明显的问题，但是您是否在目标页面上启用了链接：

> 您还必须在目标站点 ( `pageTracker._setAllowLinker(true);`) 上启用链接才能使链接正常工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T02:25:32.153

显然是对文档的错误解释：

> 您**还**必须在目标站点上启用链接

**所以让我们也**澄清一下

 ***   pageTracker._setAllowLinker(true); 在 ORIGINATING 页面上设置
*   pageTracker._setAllowLinker(true); 在目标页面上设置

正如文档所示，我只在目标页面上启用了它。

# dynamic - C#4 动态关键字 - 为什么不呢？

> ID：245318
> 
> 赞同：6
> 
> 时间：2008-10-28T23:57:49.110
> 
> 标签：dynamic, c#-4.0

在阅读了[对该主题](https://stackoverflow.com/questions/244302/what-do-you-think-of-the-new-c-40-dynamic-keyword)的许多回复后，我发现许多不喜欢它的人都提到了滥用新关键字的可能性。我的问题是，什么样的虐待？这怎么可能被滥用得如此糟糕，以至于人们非常讨厌它？仅仅是纯粹主义吗？还是有一个我没有看到的真正陷阱？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-29T02:44:30.210

我认为人们对这个特性表达的很多反感归结为“这是一个糟糕的语言特性，因为它会让糟糕的开发人员编写糟糕的代码。” 如果您考虑一下，按照这种逻辑，*所有*语言功能都很糟糕。

当我遇到一些天才以 为前缀的 VB 代码块时`On Error Resume Next`，我诅咒的不是 VB。也许我应该，我想。但根据我的经验，一个决心在保险丝盒里放一分钱的人会找到办法。就算你掏空他的口袋，他也会自己掏腰包。

我，我期待 C# 和 Python 之间有更有用的互操作方式。我正在编写越来越多的代码来做到这一点。对于`dynamic`那个特定的用例，关键字不能很快出现，因为目前的做法让我觉得我是 1950 年代前往西方参加会议的苏联学者：有大量的规则和在我离开之前的文书工作，我很确定有人会一直看着我在那里，我在那里捡到的大部分东西都会在我回来时在边境被带走。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-29T00:01:05.283

有些人认为它是一种会被滥用的工具。就像 VB 中的“Option Strict Off”和“On Error Resume Next”，C# 和 Java 等“纯”语言从未有过。

许多人对“var”关键字也这么说，但我没有看到它被滥用，一旦它被理解为与 VB 的“Variant”不同

在懒惰的开发人员不想对类进行类型检查而只是尝试捕获动态调用而不是写“if blah is Blah ...”的地方可能会滥用它。

我个人觉得它可以在我最近回答的[这个问题的情况下正确使用。](https://stackoverflow.com/questions/252355/how-to-write-asynchronous-linq-query)

我认为真正理解它的力量的是那些对动态 .NET 语言非常感兴趣的人。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-29T01:47:56.800

**动态**是不好的，因为这样的代码会到处出现：

```
public dynamic Foo(dynamic other) {
  dynamic clone = other.Clone();
  clone.AssignData(this.Data);
  return clone ;
} 
```

代替：

```
public T Foo<T>(T other) where T: ICloneable, IAssignData{
    T clone = (T)other.Clone();
    clone.AssignData(this.Data);
    return clone;
} 
```

第一个，没有静态类型信息，没有编译时检查，它不是自我记录，没有类型推断，所以人们将被迫在调用站点使用动态引用来存储结果，导致更多的类型丢失，以及所有这呈螺旋式下降。

我已经开始害怕**动态**了。

**编辑**：危险已经过去（呼！）......毕竟动态并没有被滥用，3年后不需要投票给我:)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-29T00:02:03.940

真正的陷阱？严重缺乏文档。整个应用程序的架构存在于编写它的人（或多个人）的脑海中。至少使用强类型，您可以通过其类定义查看对象的作用。使用动态类型，您充其量只能从它的使用中推断出含义。在最坏的情况下，您不知道对象是什么。这就像用 JavaScript 编写所有东西一样。确认！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-29T02:04:16.907

当人们意识到他们无法通过 获得良好的 IntelliSense 时`dynamic`，他们会从“`dynamic`快乐”转变为“`dynamic`在必要时”和`var`“在所有其他时间”。

目的`dynamic`包括：与 COM/C++ 和 DLR/IronPython/IronRuby 等动态语言和平台的互操作性；以及将 C# 本身变成 IronSmalltalkWithBraces 并实现`IDynamicObject`.

所有人都会有美好的时光。（除非您需要维护其他人编写的代码。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-19T10:55:51.983

这有点像讨论公共摄像机，当然它们可以并且将会被滥用，但拥有它们也有好处。

如果你不需要它们，你没有理由不能在你自己的编码指南中取缔“动态”关键字。所以有什么问题？我的意思是，如果你想用“动态”关键字做一些疯狂的事情，并假装 C# 是 JavaScript 的一些突变表亲，请做我的客人。只需将这些实验排除在我的代码库之外。;)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-10-29T02:47:56.817

我看不出当前动态调用方法的方式存在缺陷的原因：

它需要三行来完成，或者您可以在 System.Object 上添加一个扩展方法来为您完成：

```
class Program
{
    static void Main(string[] args)
    {
        var foo = new Foo();            
        Console.WriteLine(foo.Invoke("Hello","Jonathan"));
    }        
}

static class DynamicDispatchHelper
{
    static public object Invoke(this object ot, string methodName, params object[] args)
    {
        var t = ot.GetType();
        var m = t.GetMethod(methodName);
        return m.Invoke(ot, args);
    }
}

class Foo
{
    public string Hello(string name)
    {
        return ("Hello World, " + name);
    }
} 
```

# ruby-on-rails - 无法激活 Rake (> 0.0.0)？

> ID：245334
> 
> 赞同：2
> 
> 时间：2008-10-29T00:07:36.423
> 
> 标签：ruby-on-rails, ruby, rake

好吧，这很奇怪。我正在尝试进行数据库迁移，突然之间，我收到了这些错误：

```
[C:\source\fe]: rake db:migrate --trace
（在 C:/source/fe 中）
** 调用 db:migrate (first_time)
** 调用设置（first_time）
** 调用 gems:install (first_time)
** 调用 gems:set_gem_status (first_time)
** 执行 gems:set_gem_status
** 执行 gems:install
耙中止！
无法激活 rake (> 0.0.0)，已激活 rake-0.8.3]
c:/ruby/lib/ruby/site_ruby/1.8/rubygems.rb:139:in `activate'
c:/ruby/lib/ruby/site_ruby/1.8/rubygems.rb:155:in `activate'
c:/ruby/lib/ruby/site_ruby/1.8/rubygems.rb:154:in `每个'
c:/ruby/lib/ruby/site_ruby/1.8/rubygems.rb:154:in `activate'
c:/ruby/lib/ruby/site_ruby/1.8/rubygems.rb:49:in `gem'
C:/source/fe/config/../vendor/rails/railties/lib/rails/gem_dependency.rb:36:in `add_load_paths'
C:/source/fe/config/../vendor/rails/railties/lib/initializer.rb:245:in `add_gem_load_paths'
C:/source/fe/config/../vendor/rails/railties/lib/initializer.rb:245:in `each'
C:/source/fe/config/../vendor/rails/railties/lib/initializer.rb:245:in `add_gem_load_paths'
C:/source/fe/config/../vendor/rails/railties/lib/initializer.rb:97:in `send'
C:/source/fe/config/../vendor/rails/railties/lib/initializer.rb:97:in `run'
C:/source/fe/config/gems.rb:45:in `init_dependencies'
C:/source/fe/lib/tasks/overridegems.rake:15
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:617:in `call'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:617:in `execute'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:612:in `each'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:612:in `execute'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:578:in `invoke_with_call_chain'
c:/ruby/lib/ruby/1.8/monitor.rb:242:in `同步'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:571:in `invoke_with_call_chain'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:588:in `invoke_prerequisites'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:585:in `each'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:585:in `invoke_prerequisites'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:577:in `invoke_with_call_chain'
c:/ruby/lib/ruby/1.8/monitor.rb:242:in `同步'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:571:in `invoke_with_call_chain'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:588:in `invoke_prerequisites'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:585:in `each'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:585:in `invoke_prerequisites'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:577:in `invoke_with_call_chain'
c:/ruby/lib/ruby/1.8/monitor.rb:242:in `同步'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:571:in `invoke_with_call_chain'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:564:in `invoke'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:2019:in `invoke_task'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:1997:in `top_level'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:1997:in `each'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:1997:in `top_level'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:2036:in `standard_exception_handling'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:1991:in `top_level'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:1970:in `run'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:2036:in `standard_exception_handling'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/lib/rake.rb:1967:in `run'
c:/ruby/lib/ruby/gems/1.8/gems/rake-0.8.3/bin/rake:31
c:/ruby/bin/rake:19:in `load'
c:/ruby/bin/rake:19
[C:\源\fe]：

```

有什么建议么？我试过卸载和重新安装 rake，以及更新 rails。

仅供参考，我使用的是 Gem 1.1.1。

我还尝试过 gem update rails、gem update rake 和其他任何东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T18:57:37.530

Interestingly, the solution here was that i needed to downgrade my rake version. The local version (in my C:\ruby dir) was overriding the one in the source directory, and couldn't be loaded. I had done gem update and updated all my local gems.

命令是：

```
gem uninstall rake
gem install rake -v ('= 1.5.1') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T18:40:49.370

I had a problem similar to this, which I ended up working around by hacking my rails version to not initialize active resource (by modifying the components method in /rails/railties/builtin/rails_info/rails/info.rb )

This is clearly a hack, but I didn't have a chance to work out why active_resource specifically was causing the rake conflict, and since I wasn't using active_resource anyway, it got me through the night.

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2008-10-29T00:11:21.360

```
rake aborted!
can`'t activate rake 
```

It is mid-Autumn - perhaps too many leaves have fallen and the rake can't be used. Try using the leaf-blower instead.

Next time, keep up with the raking to prevent this.

# svn - 如何在 SVN 中分支并让它分支我的 svn:external 文件夹？

> ID：245337
> 
> 赞同：22
> 
> 时间：2008-10-29T00:10:44.453
> 
> 标签：svn, tortoisesvn, branch

我在 Windows 中使用乌龟 svn。

如何在 SVN 中分支并让它分支我的 svn:external 文件夹？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-29T20:49:52.873

您应该使用来自不同存储库`svn:externals`的**外部引用。**所以`svn:externals`应该指组件、模块、3rd 方工具等。

您不应该**通过**使用`svn:externals`外部指向同一个存储库来模拟“符号链接”行为。大多数情况下，您可以通过修改构建结构或使用签出脚本和稀疏签出功能来解决此类问题。

svn:externals 有很多问题，其中大部分都很难看到、跟踪和修复： [请参见此处的示例](https://stackoverflow.com/questions/223355/i-cannot-commit-changes-after-merge-in-svn)

*   提交不能跨越外部（没有原子提交）
*   分支不会分支它们的外部（正如你所指出的）
*   标签不会“冻结”它们的外部，因此后面的构建可能会导致不同/损坏的构建
*   合并和重新整合合并不适用于外部

如果您使用 externals 指向其他存储库，则大多数时候您不会遇到这些问题。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-29T00:28:04.167

您必须在外部存储库中手动创建一个分支，然后更改您的 svn:external 属性以指向正确的分支。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-29T00:20:21.750

当你在 Subversion 中创建一个分支时，你只是创建了一个主干、分支或标签的廉价副本。这个便宜的副本将包含与您分支的主干、分支或标签相同的所有文件和属性，直到您开始修改新分支的属性或文件。

但是，您可以修改“提交”挂钩之一，以便在提交分支后自动修改设置。[http://svnbook.red-bean.com/en/1.1/ch05s02.html](http://svnbook.red-bean.com/en/1.1/ch05s02.html)

否则，如果您希望在分支上修改您的外部，您将需要手动进行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-29T08:39:55.373

现在有相对的外部因素。虽然你应该知道 :) 我现在正在使用它们 - 在解决我遇到的一些麻烦的过程中，但我正在进步。我只是在其中创建了相对外部后标记了一个项目。现在它很奇怪 - 当我检查分支时，它通知我外部来自修订版“主干的最高修订版”，但外部本身是原始的 - 这就是我想要的:)

# sharepoint - Sharepoint Webpart 中的超链接

> ID：245338
> 
> 赞同：0
> 
> 时间：2008-10-29T00:11:02.190
> 
> 标签：sharepoint, dynamic, hyperlink, web-parts

我一直在处理一个 SharePoint 项目，并且我已经通过自定义 Web 部件加载了用户控件。

我有几个 Web 控件，我需要在其中动态生成超链接（在数据库的循环中），这些超链接将在单击时调用用户控件的某些功能。

当我构建自己的 ASP.NET 站点时，我只需将参数添加到超链接并检查页面加载以查看在单击超链接时是否需要运行任何其他代码。

我开始意识到这在 SharePoint 环境中可能不太可靠，因为我无法控制网页 URL 的形成方式。

我希望在单击超链接并传递一些值时将其发回，但我不确定解决此问题的最佳方法。

有人能指出我正确的方向吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T21:13:40.953

If you want to avoid the complexity of dealing with and parsing URL's then you need to be using the ASP.NET server controls - the whole idea of them is to abstract out complexity such as that.

[http://msdn.microsoft.com/en-us/library/seey0yt3(VS.85).aspx](http://msdn.microsoft.com/en-us/library/seey0yt3(VS.85).aspx) [http://www.startvbdotnet.com/aspsite/controls/linkbutton.aspx](http://www.startvbdotnet.com/aspsite/controls/linkbutton.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T01:53:13.293

您仍然可以将查询字符串参数添加到任何 url 的末尾，并且您的 webpart 会选择它们。您创建 url 的方式必须更复杂一点，因为您不能假设您的方式将是 url 上唯一的查询参数。

SPHttpUtility[有](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.utilities.sphttputility_members.aspx)一些有用的功能。

# excel - Excel 内置对话框

> ID：245342
> 
> 赞同：1
> 
> 时间：2008-10-29T00:12:51.843
> 
> 标签：excel, vba, dialog, built-in

有人知道如何`import data`从宏（vba）调用内置对话框 excel 吗？

我试过`Application.Dialogs.Item(...).Show`了，但我找不到正确的对话框。请帮忙。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T00:29:48.860

使用对话系统我能找到的最接近的是：

```
Application.Dialogs(xlDialogImportTextFile).Show 
```

您可以通过以下方式获得对命令栏按钮的引用（至少对我而言，在 2k3 和 2k7 中）：

```
Set button = Application.CommandBars.FindControl(ID:=6262) 
```

但是在按钮上调用该`Execute`方法失败。可悲的是，简短的回答似乎是不可能的。

您可以手动添加 QueryTable 对象。虽然不是最佳路径，但您可以设计自己的简单界面来选择源数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T00:27:10.660

如果您选择对象浏览器并搜索 xlDialogImportTextFile，您将获得可能的对话框列表。

编辑：也许这些线上的东西适合：

```
'Allow user to select text file
sf = Application _
    .GetOpenFilename("Text Files (*.txt), *.txt")
If sf <> False Then
    'Open text file
    Workbooks.OpenText sf
End If 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T07:35:25.787

我认为没有等效的 VBA，因为在一种情况下，您将数据返回到工作表，而在另一种情况下，数据被放入内存中的记录集中。

但是，这个 kludge 应该会为您弹出对话框：

```
SendKeys "%ddd" 
```

# c#-3.0 - 可查询的 vs IEnumerable 使用 Lambda，该选择哪个？

> ID：245343
> 
> 赞同：8
> 
> 时间：2008-10-29T00:12:52.950
> 
> 标签：c#-3.0, lambda

我用 Lambda 做越来越多的练习，但我不明白为什么有时`.AsQueryable();`使用 IQueryable 的示例，有时却省略`.AsQueryable();`并使用 IEnumerable。

我已经阅读了[MSDN](http://msdn.microsoft.com/en-us/library/bb351562.aspx)，但我没有看到“执行表达式树”比没有优势。

谁能给我解释一下？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-29T00:20:24.323

IQueryable 实现了 IEnumerable，因此立即使用 IQueryable，您可以完成使用 IEnumerable 可以完成的所有操作。IQueryables 处理将一些 lambda 表达式转换为对底层数据源的查询——这可能是 SQL 数据库或对象集。

基本上，您通常不必关心它是 IQueryable 还是 IEnumerable。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-03T17:30:00.573

作为用户，您通常不必关心，这实际上与数据源的实现者有关。如果数据提供者只是实现 IEnumerable，那么您基本上是在执行 LINQ 对象执行，即它在集合上的内存操作中。IQueryable 为数据源提供了在执行表达式后将表达式树转换为备用表示的能力（通常通过枚举），这就是 Linq2Sql、Linq2Xml 和 Linq2Entities 所做的。

我唯一能看到最终用户关心的情况是，他们是否希望检查将要执行的表达式树，因为 IQueryable 公开了表达式。另一种用途可能是检查提供者。但是这两种情况都应该留给其他查询提供者的实现者并希望转换表达式。Linq 的重点是您不必关心要使用的表达式执行的实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T13:43:37.893

我同意 Arne Claassen 的观点，在某些情况下，您需要考虑数据源提供的底层实现。例如查看这篇[博客文章](http://jonkruger.com/blog/2007/10/19/iqueryable-vs-ienumerable-in-linq-to-sql-queries/)，它显示了 IEnumerable 和 IQueryable 生成的 SQL 在某些情况下是如何不同的。

# regex - 正则表达式匹配草率分数/混合数字

> ID：245345
> 
> 赞同：13
> 
> 时间：2008-10-29T00:13:32.560
> 
> 标签：regex

我有一系列包含混合数字的文本（即：整数部分和小数部分）。问题是文本充满了人类编码的草率：

1.  整个部分可能存在也可能不存在（例如：“10”）
2.  小数部分可能存在也可能不存在（例如：“1/3”）
3.  这两个部分可以用空格和/或连字符分隔（例如：“10 1/3”、“10-1/3”、“10 - 1/3”）。
4.  分数本身在数字和斜线之间可能有也可能没有空格（例如：“1 / 3”、“1/ 3”、“1 / 3”）。
5.  需要忽略的分数后面可能还有其他文本

我需要一个可以解析这些元素的正则表达式，以便我可以从这个混乱中创建一个适当的数字。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-29T00:16:33.457

这是一个正则表达式，它将处理我可以扔给它的所有数据：

```
(\d++(?! */))? *-? *(?:(\d+) */ *(\d+))?.*$ 
```

这会将数字放入以下组：

1.  混合数的整个部分，如果存在的话
2.  分子，如果有分数存在
3.  分母，如果存在分数

此外，这是对元素的 RegexBuddy 解释（在构建它时对我有很大帮助）：

```
Match the regular expression below and capture its match into backreference number 1 «(\d++(?! */))?»
   Between zero and one times, as many times as possible, giving back as needed (greedy) «?»
   Match a single digit 0..9 «\d++»
      Between one and unlimited times, as many times as possible, without giving back (possessive) «++»
   Assert that it is impossible to match the regex below starting at this position (negative lookahead) «(?! */)»
      Match the character “ ” literally « *»
         Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
      Match the character “/” literally «/»
Match the character “ ” literally « *»
   Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
Match the character “-” literally «-?»
   Between zero and one times, as many times as possible, giving back as needed (greedy) «?»
Match the character “ ” literally « *»
   Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
Match the regular expression below «(?:(\d+) */ *(\d+))?»
   Between zero and one times, as many times as possible, giving back as needed (greedy) «?»
   Match the regular expression below and capture its match into backreference number 2 «(\d+)»
      Match a single digit 0..9 «\d+»
         Between one and unlimited times, as many times as possible, giving back as needed (greedy) «+»
   Match the character “ ” literally « *»
      Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
   Match the character “/” literally «/»
   Match the character “ ” literally « *»
      Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
   Match the regular expression below and capture its match into backreference number 3 «(\d+)»
      Match a single digit 0..9 «\d+»
         Between one and unlimited times, as many times as possible, giving back as needed (greedy) «+»
Match any single character that is not a line break character «.*»
   Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
Assert position at the end of the string (or before the line break at the end of the string, if any) «$» 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T00:35:59.503

我认为将不同的情况（完全混合、仅分数、仅数字）分开处理可能更容易。例如：

```
sub parse_mixed {
  my($mixed) = @_;

  if($mixed =~ /^ *(\d+)[- ]+(\d+) *\/ *(\d)+(\D.*)?$/) {
    return $1+$2/$3;
  } elsif($mixed =~ /^ *(\d+) *\/ *(\d+)(\D.*)?$/) {
    return $1/$2;
  } elsif($mixed =~ /^ *(\d+)(\D.*)?$/) {
    return $1;
  }
}

print parse_mixed("10"), "\n";
print parse_mixed("1/3"), "\n";
print parse_mixed("1 / 3"), "\n";
print parse_mixed("10 1/3"), "\n";
print parse_mixed("10-1/3"), "\n";
print parse_mixed("10 - 1/3"), "\n"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T04:02:33.267

如果你正在使用`Perl 5.10`，我会这样写。

```
米{
  ^
  \s* # 跳过前导空格

  （？'所有的'
   \d++
   (?! \s*[\/] ) # 整数后面不应该有斜线
  )

  \s*

  (?: # 其余的应该作为一个组失败或成功

    -？# 忽略可能的负号
    \s*

    （？'分子'
     \d+
    )

    \s*
    [\/]
    \s*

    (?'分母'
     \d+
    )
  )?
}X

```

然后您可以像这样访问`%+`变量中的值：

```
$+{whole};
$+{numerator};
$+{denominator}; 
```

# iphone - 如何在 iphone UIImage 或 UIImageView 中拉伸图像大小

> ID：245349
> 
> 赞同：8
> 
> 时间：2008-10-29T00:14:31.980
> 
> 标签：iphone, cocoa-touch

我想在 iPhone 应用程序中显示图像，但我使用的图像太大。我想缩放它以适应 iPhone 屏幕，我找不到任何类来处理它。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-29T00:21:48.063

```
UIImageView* view = [[UIImageView alloc] initWithImage: [UIImage imageNamed: @"your_image.png"]];
view.frame = CGRectMake(0, 0, width, height); 
```

要获取 iPhone 屏幕的框架，您可以使用

```
CGRect frame = [[UIScreen mainScreen] bounds]; 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-29T01:19:09.820

在 Interface Builder 中，选择您的 UIImageView。从“工具”菜单中，选择“属性检查器”。在 Image View Attributes 面板中，从 Mode 弹出窗口中选择“Scale to Fill”。那应该缩放您的图像以适合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T01:11:30.210

我的 ImageView 是在 IB 中设置的，我需要显示多个图像，所以设置 imageView 的图像，而不是为单个图像创建 ImageView。

在我设置图像视图框架大小后，我仍然看到相同的结果，图像太大，以至于只有部分图像显示在屏幕上。

# c# - 在 C# 中将字符串索引为 L 值

> ID：245352
> 
> 赞同：1
> 
> 时间：2008-10-29T00:16:52.707
> 
> 标签：c#, .net

我有以下故意微不足道的功能：

```
void ReplaceSome(ref string text)
{
    StringBuilder sb = new StringBuilder(text);
    sb[5] = 'a';
    text = sb.ToString();
} 
```

将其转换为 StringBuilder 以索引并替换某些字符只是将其复制回 ref'd 参数似乎效率低下。是否可以将文本参数作为 L 值直接索引？

或者我还能如何改进这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T00:25:26.387

C# 字符串是“不可变的”，这意味着它们不能被修改。如果您有一个字符串，并且想要一个相似但不同的字符串，则必须创建一个新字符串。像上面那样使用 StringBuilder 可能与任何方法一样简单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T01:05:23.513

配备 Reflector 和反编译的 IL - 在纯 LOC 基础上，StringBuilder 方法绝对是最有效的。例如，跟踪 StringBuilder 在内部进行的 IL 调用与对 String::Remove 和 String::Insert 等的 IL 调用。

我不会费心测试每种方法的内存开销，但可以想象它会与反射器结果一致 - StringBuilder 方法将是最好的。

我认为 StringBuilder 使用构造函数设置了内存大小这一事实

```
StringBuilder sb = new StringBuilder(text); 
```

总体上也会有所帮助。

就像其他人提到的那样，这将归结为可读性与效率......

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-29T00:24:35.423

我不知道这是否更有效，但它有效。无论哪种方式，您都必须在每次更改后重新创建字符串，因为它们是不可变的。

```
 string test = "hello world";
    Console.WriteLine(test);

    test = test.Remove(5, 1);
    test = test.Insert(5, "z");

    Console.WriteLine(test); 
```

或者，如果您希望它更简洁：

```
string test = "hello world".Remove(5, 1).Insert(5, "z"); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-29T00:27:40.470

```
text = text.Substring(0, 4) + "a" + text.Substring(5); 
```

与您的 StringBuilder 解决方案没有太大区别，但比 Remove(), Insert() 答案稍微简洁一些。

# c# - 温莎城堡在哪里以及如何建立伐木设施

> ID：245354
> 
> 赞同：10
> 
> 时间：2008-10-29T00:17:33.347
> 
> 标签：c#, .net, logging, inversion-of-control, castle-windsor

我是温莎城堡的新手，正在调查伐木设施的进出。这似乎相当令人印象深刻，但我唯一无法解决的是 Windsor 在我的类上设置 Logger 属性的位置。如以下代码所示，如​​果尚未设置类但在 Resolve 完成运行时设置了 Logger 属性，则将 Logger 设置为 nullLogger。

```
private ILogger logger;

public ILogger Logger
{
    get
    {
        if (logger == null) 
            logger = NullLogger.Instance;
        return logger;
    }
    set { logger = value; }
} 
```

所以我想知道的是 Windsor 如何以及在何处设置我的 Logger 属性。

干杯安东尼

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-29T01:20:21.097

记录器由配置部分中的记录工具设置`<facilities>`。例如，要使用 log4net，您的应用程序或 web.config 将如下所示：

```
<?xml version="1.0"?>
<configuration>
    <configSections>
        <section name="castle" type="Castle.Windsor.Configuration.AppDomain.CastleSectionHandler, Castle.Windsor"/>
    </configSections>
<Configuration>

<castle>

    <facilities>
        <facility id="loggingfacility" 
             type="Castle.Facilities.Logging.LoggingFacility, Castle.Facilities.Logging" 
             loggingApi="log4net" 
             configFile="logging.config" />
    </facilities>

</castle>
</configuration> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-10-15T12:41:30.690

您还可以在初始化 Windsor 时以编程方式进行配置（例如，从您的 global.asax.cs 中）：

```
container.AddFacility("logging",  new LoggingFacility(LoggerImplementation.Log4net)); 
```

您当然可以选择任何记录器实现。

每当 Windsor 实例化任何期望记录器的类时，这将被连接起来。我不会把它放在构造函数中，因为它是一个横切关注点 - 最好像你在我看来建议的那样做。你可以稍微简化一下：

```
 private ILogger logger = NullLogger.Instance;
    public ILogger Logger
    {
        get { return logger; }
        set { logger = value; }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T14:40:00.277

由于您有一个带有 Setter 的公共属性，因此每次您从 Windsor 解析对象时，它还将尝试从容器中设置任何具有适当值的公共属性（在您的情况下，您的设施将填充到 Windsor 中的 ILogger）。

意思是，如果你从 Windsor 解决 Class，这将被设置。但如果你执行 new Class() 则不会。

至少我是这么理解的。

另一种方法是使用构造函数，这意味着如果你有一个名为

public Class(ILogger logger) 它将使用 ILogger 作为参数进行实例化。

例子：

```
var yourClassObject = Kernel.Resolve<IClass>();

```

如果您没有接口规范（并已注册），如果您想使用该具体类型（而不是通过接口）解析它，则需要将您的组件注册为具体类型。

# javascript - 如何判断我的页面是否设置为用户的主页？

> ID：245355
> 
> 赞同：5
> 
> 时间：2008-10-29T00:17:44.280
> 
> 标签：javascript

有什么方法可以检测我的页面何时在浏览器中设置为用户的主页？

我对 javascript 中的某些东西最感兴趣，但我也很乐意听到其他方法。

**编辑**：我不是在寻找任何鬼鬼祟祟的东西。我想知道是否有任何明确允许通过浏览器查找此信息的内容。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-29T00:20:54.930

不可能有万无一失的方法，因为这会侵犯用户的隐私。

想到的一件事是检查推荐人。如果用户在没有点击链接的情况下到达您的页面，他们 a) 键入了 url，b) 跟随了书签，或者 c) 将您的页面设置为他们的主页。但这是我能做的最好的了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T00:21:50.763

没有。您可以通过点击链接来判断他们是否到达了您的页面。检查推荐人。但是，将您的页面作为主页的浏览器与在您的页面中键入或使用书签的用户没有任何不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T00:31:16.673

简单的解决方案，您不应该检查您或其他任何人的网站是否设置为用户的主页。如果他们想要它作为他们的主页，他们就会这样做。

但是，如果您有一些 Javascript 可以检查他们的电子邮件并查看他们是否已将指向您网站的链接发送给他们的朋友或同事，我会对该功能**非常**感兴趣 ;-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T02:41:28.377

Mozilla/Firefox 有一个[`window.home()`](https://developer.mozilla.org/En/DOM/Window.home)加载用户主页的方法。这种方法可以与服务器访问日志结合使用（可能在 iframe 中），以查看当前用户是否立即请求加载站点的主页。

但是，其他浏览器似乎不支持这种 javascript 方法。

# c# - 如何使用 LINQ 从字符串中获取重复字符数组？

> ID：245369
> 
> 赞同：3
> 
> 时间：2008-10-29T00:23:50.383
> 
> 标签：c#, linq, algorithm

如果我有以下字符串：

```
string s = "abcdefghab"; 
```

那么我如何获得一个字符串（或 char[]），它只包含使用 C# 和 LINQ 在原始字符串中重复的字符。在我的示例中，我想以“ab”结尾。

虽然没有必要，但我试图在一行 LINQ 中执行此操作，并且到目前为止提出了：

```
s.ToCharArray().OrderBy(a => a)... 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-29T00:30:41.243

```
String text = "dssdfsfadafdsaf";
var repeatedChars = text.ToCharArray().GroupBy(x => x).Where(y => y.Count() > 1).Select(z=>z.Key); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-29T00:33:13.080

```
string theString = "abcdefghab";

//C# query syntax
var qry = (from c in theString.ToCharArray()
           group c by c into g
           where g.Count() > 1
           select g.Key);

//C# pure methods syntax
var qry2 = theString.ToCharArray()
            .GroupBy(c => c)
            .Where(g => g.Count() > 1)
            .Select(g => g.Key); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-29T00:43:09.817

此外，字符串已经是 IEnumerable，因此您实际上不需要调用 ToCharArray();

```
var qry = (from c in theString
           group c by c into g           
           where g.Count() > 1           
           select g.Key); 
```

这将 qry 保留为 IEnumerable，但如果您真的需要 char[]，那么就像`qrt.ToArray()`.

# flash - 与正在运行的 Flash 进程交互？

> ID：245374
> 
> 赞同：2
> 
> 时间：2008-10-29T00:25:37.010
> 
> 标签：flash

是否可以编写一个与正在运行的 Flash 实例交互的程序？

在最近的 Java 版本中，有一种将您自己的进程“附加”到正在运行的 JVM 的概念。通过使用反射等编写一些有点难看的代码，您可以挖掘、获取对对象的引用、打印变量的值、调用方法等。显然 Flash 不是 Java（呃），但它是有可能实现类似的东西吗？

我已经看过的几件事是各种 SWF 反编译器（当然相关，但与附加进程不同）和 ptrace（这似乎可行，但级别很低）。

有人对如何做到这一点有其他想法/建议吗？就语言、操作系统等而言，任何事情都可以。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T08:15:25.783

您可以查看[Xray](http://osflash.org/xray)采用的方法，它使用 localConnection 连接到检查工具。

# visual-studio-2008 - 帮助！Visual Studio 2008 在调试期间刚刚停止步进！

> ID：245386
> 
> 赞同：2
> 
> 时间：2008-10-29T00:29:55.333
> 
> 标签：visual-studio-2008, debugging

大问题。我不确定我做了什么，但似乎我不能再调试函数了。

它发生在没有特定的地方，只是在整个代码中发生。我设置了一个断点，然后尝试“跳过”以转到下一个类似的代码。现在，调试器似乎将其解释为“继续”。

甚至更好！如果我在那之后立即设置断点，调试器会忽略断点并继续。

关于可能导致这种情况的任何想法？在这一点上，调试对我来说或多或少变得毫无用处——我认为这是一场灾难性的失败。

我已经完全删除了我的项目并同步到源，所以这不是本地用户配置问题。我已经检查了调试器选项，（选项-> 调试器）并且我没有检查任何异常）。

任何帮助表示赞赏...

编辑：下面害羞的答案不正确。我正在正确地做所有这些事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T00:36:59.093

相当多的可能性
- 您在没有调试符号而不是调试的版本中编译 - 检查您正在编译的配置
- 由于某些其他原因，您没有调试符号 - 检查设置
- 您正在运行的二进制版本不是与正在编译的相同 - 检查正在运行的可执行文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T15:07:06.077

啊! 我想到了！

这可能是也可能不是视觉工作室中的错误。

假设我有一个从 0 到 5 的案例枚举。假设我有一个字典，其中枚举作为键，另一个整数作为值。如果然后我有一个组合框，其中包含字典中所有可能的值作为下拉列表的内容，那么当我选择正确的索引时，我不能只将整数转换回枚举。例如，如果我在字典的枚举中有元素 4 和 5，则使用 Keys 集合创建下拉列表，当我获得 combobox.selectedIndex 属性时，结果是 0 或 1。字典，因此抛出异常。

这就是我发现错误的方式。但是，如果我不使用字典，而是使用包含 (enumeration, integer) 作为内容的对象列表，则找不到错误转换的枚举，但代码继续运行。与其抛出异常（我不确定应该抛出哪个异常），不如说是 IDE 踩到了自己。

当我实现上面的字典版本时，抛出了异常，一旦它得到修复，我可以再次调试。

# cocoa - NSApplication 和 -applicationDidFinishLaunching：

> ID：245390
> 
> 赞同：4
> 
> 时间：2008-10-29T00:32:21.507
> 
> 标签：cocoa, macos

我有一个应用程序，我有一个`main.m`返回`NSApplicationMain(argc, (const char **) argv);`.

我想在 上运行代码`-applicationDidFinishLaunching:`，但我只是不知道该怎么做。

任何人都可以提供帮助或举个例子吗？

谢谢！-杰森

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-29T01:04:17.370

当应用程序完成加载时，将调用 NSApplication 委托的 applicationDidFinishLaunching: 方法。许多项目模板设置了一个委托。如果您正在使用一个，只需向其中添加适当的方法。

如果您的项目没有设置应用程序委托，您需要自己设置。首先，创建一个新类作为您的委托（如果有逻辑上合适的内容，您可以使用现有的类）。现在确保在 MainMenu.nib 中实例化了该类。最后，将“文件所有者”对象的委托属性挂钩到 IB 中的实例化委托。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T18:19:48.340

路易斯的回答简洁明了。但是，如果委托方法的概念对您来说是新的，您最好查看[相关文档](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaFundamentals/CommunicatingWithObjects/chapter_6_section_4.html "Cocoa 基础指南：代表和数据源")。

# windows - Windows批处理文件的隐藏功能

> ID：245395
> 
> 赞同：232
> 
> 时间：2008-10-29T00:34:22.390
> 
> 标签：windows, batch-file, hidden-features

Windows 批处理文件有哪些鲜为人知但重要且有用的功能？

指导方针：

*   每个答案一个功能
*   提供特性的简短**描述**和**示例**，而不仅仅是文档链接
*   **限制对本机功能**的回答，即不需要额外的软件，如*Windows 资源工具包*

澄清：我们在这里指的是由 cmd.exe 处理的脚本，这是 WinNT 变体的默认设置。

（另请参阅：[Windows 批处理文件：.bat 与 .cmd？](https://stackoverflow.com/questions/148968/windows-batch-files-bat-vs-cmd)）

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2008-10-29T00:50:52.733

续行：

```
call C:\WINDOWS\system32\ntbackup.exe ^
    backup ^
    /V:yes ^
    /R:no ^
    /RS:no ^
    /HC:off ^
    /M normal ^
    /L:s ^
    @daily.bks ^
    /F daily.bkf 
```

* * *

## 回答 #2

> 赞同：150
> 
> 时间：2008-10-29T00:43:00.783

```
PUSHD path 
```

将您带到*path*指定的目录。

```
POPD 
```

带您回到您“推送”的目录。

* * *

## 回答 #3

> 赞同：109
> 
> 时间：2008-10-29T02:54:07.523

不确定这在*批处理*文件中会有多大用处，但在命令提示符下使用它是一个非常方便的命令：

```
C:\some_directory> start . 
```

这将在“some_directory”文件夹中打开 Windows 资源管理器。

我发现这是一个很好的节省时间的方法。

* * *

## 回答 #4

> 赞同：87
> 
> 时间：2008-10-29T00:35:13.700

我一直发现很难阅读每行上用关键字标记的注释：

```
REM blah blah blah 
```

更容易阅读：

```
:: blah blah blah 
```

* * *

## 回答 #5

> 赞同：79
> 
> 时间：2008-10-29T00:41:33.390

可变子串：

```
> set str=0123456789
> echo %str:~0,5%
01234
> echo %str:~-5,5%
56789
> echo %str:~3,-3%
3456 
```

* * *

## 回答 #6

> 赞同：72
> 
> 时间：2008-10-29T00:43:14.917

[FOR命令](http://www.robvanderwoude.com/ntfor.html)！虽然我讨厌编写批处理文件，但我很感激它。

```
FOR /F "eol=; tokens=2,3* delims=, " %i in (myfile.txt) do @echo %i %j %k 
```

将解析 myfile.txt 中的每一行，忽略以分号开头的行，将每行的第二个和第三个标记传递给 for 正文，标记由逗号和/或空格分隔。请注意 for body 语句引用 %i 来获取第二个标记，%j 获取第三个标记，以及 %k 获取第三个之后的所有剩余标记。

您还可以使用它来迭代目录、目录内容等...

* * *

## 回答 #7

> 赞同：60
> 
> 时间：2008-11-03T20:41:04.523

我没有在脚本中乱扔 REM 或 :: 行，而是在每个脚本的顶部执行以下操作：

```
@echo OFF
goto :START

Description of the script.

Usage:
   myscript -parm1|parm2 > result.txt

:START 
```

请注意如何使用管道和重定向字符而不转义它们。

* * *

## 回答 #8

> 赞同：54
> 
> 时间：2008-10-29T00:39:01.947

脚本所在的路径（带驱动器）：~dp0

```
set BAT_HOME=%~dp0
echo %BAT_HOME%
cd %BAT_HOME% 
```

* * *

## 回答 #9

> 赞同：49
> 
> 时间：2009-02-10T23:29:18.050

%~dp0 部分已经提到过，但实际上还有更多内容：~ 之后的字符定义了提取的信息。
没有字母导致返回补丁文件名
d - 返回驱动器号
p - 返回路径
s - 返回短路径
x - 返回文件扩展名
所以如果你从 c:\Temp 执行下面的脚本 test.bat \long dir name\ 文件夹，

```
@echo off
echo %0
echo %~d0
echo %~p0
echo %~dp0
echo %~x0
echo %~s0
echo %~sp0 
```

你得到以下输出

> ```
> test
> c:
> \Temp\long dir name\
> c:\Temp\long dir name\
> .bat
> c:\Temp\LONGDI~1\test.bat
> \Temp\LONGDI~1\ 
> ```

如果像在
test c:\temp\mysrc\test.cpp
中一样将参数传递到您的脚本中，则可以使用 %1 变量进行相同的操作。

但是 %0 的扩展结果取决于位置！
在批处理的“顶层”，它扩展为当前批处理文件名。
在函数（调用）中，它扩展为函数名。

```
@echo off
echo %0
call :test
goto :eof

:test
echo %0
echo %~0
echo %~n0 
```

输出是（批处理文件以 myBatch.bat 开头）

```
myBatch.bat
:test
:test
myBatch 
```

* * *

## 回答 #10

> 赞同：43
> 
> 时间：2008-10-29T00:46:23.960

通过使用 CALL、EXIT /B、SETLOCAL 和 ENDLOCAL，您可以使用局部变量实现子例程。

例子：

```
@echo off

set x=xxxxx
call :sub 10
echo %x%
exit /b

:sub
setlocal
set /a x=%1 + 1
echo %x%
endlocal
exit /b 
```

这将打印

```
11
xxxxx 
```

即使 :sub 修改了 x。

* * *

## 回答 #11

> 赞同：42
> 
> 时间：2008-10-29T01:09:02.447

等待 N 秒的诡计（不是 cmd.exe 的一部分，但不是额外的软件，因为它与 Windows 一起提供），请参阅 ping 行。您需要 N+1 次 ping，因为第一次 ping 会立即发出。

```
 echo %time%
    call :waitfor 5
    echo %time%
    goto :eof
:waitfor
    setlocal
    set /a "t = %1 + 1"
    >nul ping 127.0.0.1 -n %t%
    endlocal
    goto :eof 
```

* * *

## 回答 #12

> 赞同：37
> 
> 时间：2008-10-31T16:45:47.027

逃离“管道”：

```
echo ^| ^< ^> ^& ^\ ^^ 
```

* * *

## 回答 #13

> 赞同：31
> 
> 时间：2008-10-29T01:38:56.177

能够运行命令并处理输出（如 bash 中的 '$()' 的反引号）。

```
for /f %i in ('dir /on /b *.jpg') do echo --^> %i 
```

如果文件名中有空格，请使用：

```
for /f "tokens=*" %i in ('dir /on /b *.jpg') do echo --^> %i 
```

* * *

## 回答 #14

> 赞同：30
> 
> 时间：2008-10-29T00:45:24.320

创建一个空文件：

```
> copy nul filename.ext 
```

* * *

## 回答 #15

> 赞同：28
> 
> 时间：2008-10-29T12:59:44.167

隐藏命令重定向到 >nul 2>&1 的所有输出。

例如，即使您重定向到 >nul，某些命令行程序也会显示输出。但是，如果您像下面的行那样重定向输出，则所有输出都将被抑制。

```
PSKILL NOTEPAD >nul 2>&1 
```

编辑：有关其工作原理的说明，请参阅[忽略命令的输出。](http://blogs.msdn.com/myocom/archive/2005/06/08/427043.aspx)

* * *

## 回答 #16

> 赞同：25
> 
> 时间：2008-10-29T00:47:50.307

```
PAUSE 
```

停止执行并显示以下提示：

```
按任意键继续 。. .
```

如果您想通过在 Windows 资源管理器中双击它来运行批处理并希望实际查看输出而不仅仅是命令窗口的闪烁，这很有用。

* * *

## 回答 #17

> 赞同：25
> 
> 时间：2008-12-17T12:09:22.633

相当于 bash（和其他 shell）

```
echo -n Hello # or
echo Hello\\c 
```

它输出 " `Hello`" 没有尾随换行符。执行此操作的 cmd hack：

```
<nul set /p any-variable-name=Hello 
```

`set /p`是一种提示用户输入的方式。它发出给定的字符串，然后等待（在同一行，即没有 CRLF），让用户输入响应。

`<nul`只需将空响应传递给`set /p`命令，因此最终结果是发出的提示字符串。（由于空响应，使用的变量保持不变。）

问题是：不可能输出前导等号，并且在 Vista 上会删除前导空白字符，但在 XP 上不会。

* * *

## 回答 #18

> 赞同：18
> 
> 时间：2008-10-31T02:23:57.600

设置环境变量时搜索替换：

```
> @set fname=%date:/=% 
```

...从日期中删除“/”以用于带时间戳的文件名。

还有子字符串...

```
> @set dayofweek=%fname:~0,3% 
```

* * *

## 回答 #19

> 赞同：17
> 
> 时间：2008-10-29T00:44:28.207

整数运算：

```
> SET /A result=10/3 + 1
4 
```

* * *

## 回答 #20

> 赞同：16
> 
> 时间：2008-12-02T14:07:17.737

命令分隔符：

```
cls & dir
copy a b && echo Success
copy a b || echo Failure 
```

在第 2 行，&& 之后的命令仅在第一个命令成功时运行。

在第 3 行，|| 之后的命令 仅在第一个命令失败时运行。

* * *

## 回答 #21

> 赞同：15
> 
> 时间：2008-10-29T01:30:33.120

输出一个空行：

```
echo. 
```

* * *

## 回答 #22

> 赞同：15
> 
> 时间：2008-10-31T01:55:01.823

您可以链接 if 语句以获得类似短路布尔值“和”的效果。

```
if foo if bar baz 
```

* * *

## 回答 #23

> 赞同：14
> 
> 时间：2008-10-29T02:48:32.947

快速将 Unicode 文本文件 (16bit/char) 转换为 ASCII DOS 文件 (8bit/char)。

```
C:\> type unicodeencoded.txt > dosencoded.txt 
```

作为奖励，如果可能的话，字符被正确映射。

* * *

## 回答 #24

> 赞同：14
> 
> 时间：2008-10-29T04:13:57.737

if 块结构：

```
if "%VS90COMNTOOLS%"=="" (
  echo: Visual Studio 2008 is not installed
  exit /b
) 
```

* * *

## 回答 #25

> 赞同：12
> 
> 时间：2008-10-29T00:56:02.503

变量的延迟扩展（为了很好的措施，加入了子字符串）：

```
 @echo off
    setlocal enableextensions enabledelayedexpansion
    set full=/u01/users/pax
:loop1
    if not "!full:~-1!" == "/" (
        set full2=!full:~-1!!full2!
        set full=!full:~,-1!
        goto :loop1
    )
    echo !full!
    endlocal 
```

* * *

## 回答 #26

> 赞同：12
> 
> 时间：2008-11-04T20:14:07.573

不提供太多功能，但您可以将 title 命令用于多种用途，例如在任务栏中的长脚本上提供状态，或仅用于增强用户反馈。

```
@title Searching for ...
:: processing search
@title preparing search results
:: data processing 
```

* * *

## 回答 #27

> 赞同：11
> 
> 时间：2008-10-31T01:55:38.060

字符串减法示例`date`并`time`获取名为“YYYY-MM-DD HH:MM:SS.txt”的文件

> `echo test > "%date:~0,4%-%date:~5,2%-%date:~8,2% %time:~0,2%_%time:~3,2%_%time:~6,2%.txt"`

我`color`通过更改文本和背景的颜色来指示我的脚本是否成功、失败或需要一些输入。当您的视野范围内有一些机器但距离很远时，这真的很有帮助

> 颜色 XY

其中 X 和 Y 是从`0`to的十六进制值`F`，其中 X - 背景，Y - 文本，当 X = Y 颜色不会改变。

> 颜色 Z

将文本颜色更改为“Z”并设置黑色背景，“颜色 0”将不起作用

颜色名称调用

> 颜色 ？

* * *

## 回答 #28

> 赞同：11
> 
> 时间：2009-02-11T00:09:15.427

手边没有编辑器，需要创建批处理文件？

```
copy con test.bat 
```

只需输入命令，按回车换行。按 Ctrl-Z 和 Enter 关闭文件。

* * *

## 回答 #29

> 赞同：10
> 
> 时间：2008-10-29T00:48:37.450

使用空格和转义字符完全控制输出。：

```
echo.    ^<resourceDir^>/%basedir%/resources^</resourceDir^> 
```

* * *

## 回答 #30

> 赞同：9
> 
> 时间：2008-10-29T09:23:24.087

TheSoftwareJedi 已经提到了 for 命令，但我将再次提及它，因为它非常强大。

以下以 YYYYMMDD 格式输出当前日期，我在生成备份目录时使用它。

```
for /f "tokens=2-4 delims=/- " %a in ('DATE/T') do echo %c%b%a 
```

* * *

## 回答 #31

> 赞同：8
> 
> 时间：2008-11-18T22:40:14.943

您可以稍后使用 call 来评估名称，从而获得一些有用的属性。

```
call set SomeEnvVariable_%extension%=%%%somevalue%%% 
```

使用 call 设置名称依赖于其他变量的变量。如果与一些变量命名规则一起使用，您可以通过使用谨慎的命名规则来模拟数组或字典等数据集合。somevalue 周围的三个 % 是这样，因此它将在调用之后和调用 set 之前评估为一个由单个 % 包围的变量名。这意味着连续两个 % 转义为单个 % 字符，然后它将再次扩展它，因此 somevalue 实际上是一个名称指针。

```
call set TempVar=%%SomeEnvVariable_%extension%%% 
```

将它与临时变量一起使用来检索值，然后您可以在逻辑中使用它。这在与延迟变量扩展结合使用时最有用。

要正确使用此方法，需要启用延迟变量扩展。因为默认情况下它是关闭的，所以最好通过将其作为第一条指令之一在脚本中启用它：

```
setlocal EnableDelayedExpansion 
```

* * *

## 回答 #32

> 赞同：7
> 
> 时间：2008-12-17T12:10:59.993

在路径上搜索可执行文件（或其他类似路径的字符串，如有必要）：

```
c:\> for %i in (cmd.exe) do @echo. %~$PATH:i
C:\WINDOWS\system32\cmd.exe

c:\> for %i in (python.exe) do @echo. %~$PATH:i
C:\Python25\python.exe

c:\> 
```

* * *

## 回答 #33

> 赞同：7
> 
> 时间：2008-12-19T22:02:45.067

关于使用`::`而不是`REM`评论：小心！`::`是 CALL 标签的特例，其作用类似于注释。当在括号内使用时，例如在 FOR 或 IF 循环中，函数将过早退出。调试非常令人沮丧！

有关完整说明，请参阅[http://www.ss64.com/nt/rem.html](http://www.ss64.com/nt/rem.html)。

*（作为新的答案而不是对[上面第一次提到的](https://stackoverflow.com/questions/245395/underused-features-of-windows-batch-files#245398)评论添加，因为我还不值得：0）*

* * *

## 回答 #34

> 赞同：6
> 
> 时间：2009-07-02T23:40:48.213

现在很多人使用 GOTO :EOF 来终止他们的批处理文件，但你也可以使用 EXIT /B 来达到这个目的。

使用 EXIT /B 的好处是您可以在 EXIT /B 之后添加一个错误级别，它将以该错误级别退出。

* * *

## 回答 #35

> 赞同：6
> 
> 时间：2009-07-03T00:07:30.280

仍然为 ENDLOCAL 使用的行解析局部变量。这允许使用以下技巧：

```
ENDLOCAL & SET MYGLOBAL=%SOMELOCAL% & SET MYOTHERGLOBAL=%SOMEOTHERLOCAL% 
```

这是将结果传输到调用上下文的有用方法。具体来说，一旦 ENDLOCAL 完成，%SOMELOCAL% 就会超出范围，但到那时 %SOMELOCAL% 已经展开，因此 MYGLOBAL 在调用上下文中分配有局部变量。

出于同样的原因，如果您决定这样做：

```
ENDLOCAL & SET MYLOCAL=%MYLOCAL% 
```

您会发现您的新 MYLOCAL 变量现在实际上是作为常规环境变量出现的，而不是您可能想要的本地化变量。

* * *

## 回答 #36

> 赞同：5
> 
> 时间：2008-10-29T00:52:03.447

子程序（输出 42）：

```
 @echo off
    call :answer 42
    goto :eof
:do_something
    echo %1
    goto :eof 
```

和返回值的子程序（输出 0、1、2 等）：

```
 @echo off
    setlocal enableextensions enabledelayedexpansion
    call :seq_init seq1
:loop1
    if not %seq1%== 10 (
        call :seq_next seq1
        echo !seq1!
        goto :loop1
    )
    endlocal
    goto :eof

:seq_init
    set /a "%1 = -1"
    goto :eof
:seq_next
    set /a "seq_next_tmp1 = %1"
    set /a "%1 = %seq_next_tmp1% + 1"
    set seq_next_tmp1=
    goto :eof 
```

* * *

## 回答 #37

> 赞同：5
> 
> 时间：2008-10-31T13:28:19.143

cmd.exe 中的快速编辑模式是我的最爱。这有点离题，但是当与命令 shell 交互时，它可以成为救命稻草。不，我不是在夸大其词——在你死之前你只会看到一定次数的**caret-capitol-v ；**你看到的越多，你死得越快。

1.  打开 regedit（小心，不是我的错，蓝屏等）
2.  前往 HKCU/控制台
3.  将快速编辑设置为 1

（您也可以从 UI 中进行设置，这可能是更好的方法。请参阅注释以获取说明。还有一个不错的单行脚本也可以执行此操作。）

现在，要复制，只需左键单击并拖动以选择并右键单击以复制。要粘贴，只需右键单击。

没有了^V^V^V^V^V^V^V^V^V^V^V^V^V^V！！！

废话，我想我刚刚杀了人。对不起！

* * *

## 回答 #38

> 赞同：5
> 
> 时间：2010-09-20T14:18:02.170

Call Set - 将环境变量扩展几个级别。

[在http://ss64.com/nt/call.html#advanced](http://ss64.com/nt/call.html#advanced) from answer to another SO question找到这个 在[for循环中初始化的批处理文件变量](https://stackoverflow.com/questions/691047/batch-file-variables-initialized-in-a-for-loop)

```
set VarName=Param
set Param=This

call set Answer=%%%Varname%%%
Echo %Answer% 
```

给

```
set VarName=Param
set Param=This
call set Answer=%Param%
Echo This
This 
```

* * *

## 回答 #39

> 赞同：4
> 
> 时间：2008-10-29T01:31:37.143

“删除目录”上的子目录选项：

```
rd /s /q junk 
```

* * *

## 回答 #40

> 赞同：4
> 
> 时间：2008-12-09T02:49:20.907

```
SHIFT 
```

这是一种迭代传递给命令行脚本（或子例程）的可变数量参数的方法。在最简单的用法中，它将 %2 转换为 %1，将 %3 转换为 %2，依此类推。（您也可以将参数传递给 SHIFT 以跳过多个参数。）这使命令“具有破坏性”（即 %1 永远消失），但它允许您避免硬编码最大数量的受支持参数。

这是一个处理命令行参数的简短示例：

```
:ParseArgs

if "%1"=="" (
    goto :DoneParsingArgs
)

rem ... do something with %1 ...

shift

goto :ParseArgs

:DoneParsingArgs

rem ... 
```

* * *

## 回答 #41

> 赞同：4
> 
> 时间：2009-01-07T23:57:59.897

将输出重定向到控制台，即使批处理的输出已经通过`> con`语法重定向到文件。

示例：foo.cmd：

```
echo a
echo b > con 
```

来电：

```
foo.cmd > output.txt 
```

这将导致`"a"`进入`output.txt`控制台`"b"`。

* * *

## 回答 #42

> 赞同：4
> 
> 时间：2010-07-21T05:11:27.720

您可以使用 errorlevel 检查给定程序是否在您的批处理文件将运行的系统（当前目录或路径）上可用。为此，您正在测试的程序必须运行、退出并设置退出代码。在我使用的示例中 -? 作为 myExe 的 arg，大多数 CLI 程序都有类似的 arg，例如 -h、--help、-v 等……这确保它简单地运行并退出离开或设置错误级别 0

```
myExe -? >nul 2>&1 
Set errCode=%errorlevel%
@if %errCode% EQU 0 (
    echo myExe -? does not return an error (exists)
) ELSE (
    echo myExe -? returns an error (does not exist)
) 
```

是的，您可以直接测试 errorlevel 而不是将其分配给 errCode 但这样您就可以在测试和条件之间使用命令，并根据需要重复测试条件。

* * *

## 回答 #43

> 赞同：3
> 
> 时间：2008-11-03T11:01:40.043

带有数字变量的循环的正确格式是

```
for /l %%i in (startNumber, counter, endNumber) do echo %%i 
```

更多详情 > [http://www.ss64.com/nt/for.html](http://www.ss64.com/nt/for.html)

* * *

## 回答 #44

> 赞同：3
> 
> 时间：2008-11-07T01:33:50.610

要从脚本内部解析**标准输入**，您需要使用 FOR 和 FIND 命令的技巧：

```
for /f "tokens=*" %%g in ('find /V ""') do (
     :: do what you want with %%g
     echo %%g
) 
```

* * *

## 回答 #45

> 赞同：3
> 
> 时间：2009-01-07T23:53:55.270

[CHOICE](http://www.ss64.com/nt/choice.html)命令提示用户选择多个选项之一（通过单个按键）

```
@echo off
echo Please choose one of the following options
echo 1\. Apple
echo 2\. Orange
echo 3\. Pizza
echo a, b, c. Something else
choice /c:123abc /m "Answer?"
set ChoiceLevel=%ErrorLevel%
echo Choice was: %ChoiceLevel% 
```

`%ChoiceLevel%`将是选择的第 n 个选项（在上面的示例中，`b=5`）。

更多详情，请访问[SS64.com上的](http://www.ss64.com/nt/)[CHOICE](http://www.ss64.com/nt/choice.html)参考页面。

* * *

## 回答 #46

> 赞同：3
> 
> 时间：2009-09-09T06:08:57.643

当您想在分支之间复制文件时，一个方便的技巧：

```
C:\src\branch1\mydir\mydir2\mydir3\mydir4>xcopy %cd:branch1=branch2%\foo*
Overwrite C:\src\branch1\mydir\mydir2\mydir3\mydir4\foo.txt (Yes/No/All)? y
C:\src\branch2\mydir\mydir2\mydir3\mydir4\foo.txt 
```

这同时使用 %cd% 环境变量和环境变量替换。

* * *

## 回答 #47

> 赞同：3
> 
> 时间：2010-09-24T12:23:24.600

获取当前日期、月份和年份（与区域无关）：

```
for /f "tokens=1-4 delims=/-. " %%i in ('date /t') do (call :set_date %%i %%j %%k %%l)
goto :end_set_date

:set_date
if ("%1:~0,1%" gtr "9") shift
for /f "skip=1 tokens=2-4 delims=(-)" %%m in ('echo,^|date') do (set %%m=%1&set %%n=%2&set %%o=%3)
goto :eof

:end_set_date

echo day in 'DD' format is %dd%; month in 'MM' format is %mm%; year in 'YYYY' format is %yy% 
```

* * *

## 回答 #48

> 赞同：2
> 
> 时间：2008-10-29T00:55:29.917

我发现您可以轻松地将命令的输出重定向到文件非常有用：

```
DIR *.txt > tmp.txt
DIR *.exe >> tmp.txt 
```

单箭头创建或覆盖文件，双箭头附加到它。现在我可以在我的文本编辑器中打开 tmp.txt 并做各种好事。

* * *

## 回答 #49

> 赞同：2
> 
> 时间：2008-10-31T02:41:27.657

**/c** cmd.exe 本身的参数，告诉它运行然后执行这些命令。

我曾经发现自己经常这样做：

**win+r** , **cmd**返回, **ping google.com**返回

但现在我只是这样做：

**win+r** , **cmd /c ping google.com**返回

快多了。如果您使用 pstools 并且想要使用 psexec 在远程计算机上执行某些命令行功能，这也很有帮助。

**编辑：** **/k**工作相同，但保持提示打开。这可能会更频繁地派上用场。

* * *

## 回答 #50

> 赞同：2
> 
> 时间：2010-09-24T11:49:14.257

使用`&::`.

```
:: This is my batch file which does stuff.
copy thisstuff thatstuff  &:: We need to make a backup in case we screw up!

:: ... do lots of other stuff 
```

这是如何运作的？这是一个丑陋的黑客。`&`是大致近似于`;`UNIX shell的命令分隔符。这`::`是另一个有点模仿`REM`声明的丑陋黑客。最终结果是您执行命令，然后执行无操作命令，从而近似于注释。

这并非在所有情况下都有效，但它通常足以成为一个有用的黑客。

* * *

## 回答 #51

> 赞同：2
> 
> 时间：2010-09-24T12:37:56.430

对于它的价值，[这](http://ss64.com/nt/)是一个很好的 Windows CMD 或批处理文件的在线参考。我从中学到了一些我不知道的东西。

* * *

## 回答 #52

> 赞同：2
> 
> 时间：2011-03-24T13:04:32.173

[forfiles](http://technet.microsoft.com/nl-nl/library/cc753551%28WS.10%29.aspx "文件")非常有用，例如，递归删除所有超过两天的文件

```
forfiles /D -2 /P "C:\Temp" /S /C "cmd /c del @path" 
```

* * *

## 回答 #53

> 赞同：2
> 
> 时间：2011-03-24T13:30:58.353

Findstr 支持正则表达式：

```
findstr "^[0-9].*" c:\windows\system32\drivers\etc\hosts 
```

* * *

## 回答 #54

> 赞同：2
> 
> 时间：2011-03-24T14:48:03.990

使用 pushd 到 UNC 路径将创建一个临时驱动器映射（从 Z 开始并向后工作以查找下一个可用字母）并将您置于该驱动器和路径中。当您 popd 或退出命令提示符时，临时映射就消失了。

```
 C:\>pushd \\yourmom\jukebox

   Z:\>pushd \\yourmom\business

   Y:\> 
```

此外，与其说是批处理提示，不如说是命令行环境提示，但是当您在命令行中使用 pushd 和 popd 以及网络共享时，使用 $+ 修改提示很有用（显示 pushd 堆栈深度）和$M（显示网络共享路径）。

```
 C:\utils>prompt $+$m$p$g

   C:\utils>pushd m:

   +\\yourmom\pub M:\>pushd c:\

   ++c:\>pushd
   M:\
   C:\utils  

   ++c:\>popd

   +\\yourmom\pub M:\>popd

   C:\utils> 
```

* * *

## 回答 #55

> 赞同：2
> 
> 时间：2011-03-24T14:50:12.723

使用管道“|”在文件夹中的文件中查找字符串 命令：

```
dir /b *.* | findstr /f:/ "thepattern" 
```

* * *

## 回答 #56

> 赞同：2
> 
> 时间：2011-03-24T19:20:33.793

批处理文件中的数组。

设置一个值：

```
set count=1
set var%count%=42 
```

在命令行中提取一个值：

```
call echo %var%count%% 
```

在批处理文件中提取一个值：

```
call echo %%var%count%%% 
```

注意额外的扫射 % 符号。

该技术可能看起来有点毛茸茸，但它非常有用。如我们所解释的，上面将打印*var1*的内容（即 42）。如果我们想将其他变量设置为*var1*中的值，我们也可以用**set替换****echo**命令。这意味着以下是命令行中的有效分配：

 ***```
call set x=%var%count%% 
```

然后查看*va1*的值：

```
echo %x% 
```

* * *

## 回答 #57

> 赞同：2
> 
> 时间：2011-03-24T19:32:18.793

Doskey 宏。

我早就失去了这个参考，但我仍然认为这是一个好主意，值得分享。

我们可以将批处理文件和 doskey 脚本合并到一个文件中。这可能看起来有点过于聪明，但它确实有效。

```
;= @echo off
;= rem Call DOSKEY and use this file as the macrofile
;= %SystemRoot%\system32\doskey /listsize=1000 /macrofile=%0%
;= rem In batch mode, jump to the end of the file
;= goto end

;= Doskey aliases
h=doskey /history

;= File listing enhancements
ls=dir /x $*

;= Directory navigation
up=cd ..
pd=pushd

;= :end
;= rem ******************************************************************
;= rem * EOF - Don't remove the following line.  It clears out the ';' 
;= rem * macro. Were using it because there is no support for comments
;= rem * in a DOSKEY macro file.
;= rem ******************************************************************
;= 
```

它通过定义一个假的 doskey 宏';'来工作 当它被解释为批处理文件时，它会被优雅地（或静默地）忽略。

我已经缩短了这里列出的版本，如果你想要更多，去[这里](http://ben.versionzero.org/wiki/Doskey_Macros)。

* * *

## 回答 #58

> 赞同：1
> 
> 时间：2008-10-29T21:55:07.080

这里如何通过扫描给定目录来构建 CLASSPATH。

```
setlocal ENABLEDELAYEDEXPANSION
if defined CLASSPATH (set CLASSPATH=%CLASSPATH%;.) else (set CLASSPATH=.)
FOR /R .\lib %%G IN (*.jar) DO set CLASSPATH=!CLASSPATH!;%%G
Echo The Classpath definition is %CLASSPATH% 
```

适用于 XP（或更好）。使用 W2K，您需要使用几个 BAT 文件来获得相同的结果（请参阅[在类路径定义中包含所有 jar](http://www.rgagnon.com/javadetails/java-0587.html)）。

1.6 不需要它，因为您可以直接在 CLASSPATH 中指定通配符（例如 -cp ".\lib*"）。

* * *

## 回答 #59

> 赞同：1
> 
> 时间：2008-10-31T01:02:17.357

一行中的多个命令，在许多情况下都很有用：

& 用于组合两个命令，先执行 command1，然后执行 command2
&& 条件组合，如果 command1 成功执行，则执行 command2
¦¦ command2 只有在 command1 未成功完成时才执行。

例子：

```
:: ** Edit the most recent .TXT file and exit, useful in a .CMD / .BAT **
FOR /F %%I IN ('DIR *.TXT /B /O:-N') DO NOTEPAD %%I & EXIT

:: ** If exist any .TXT file, display the list in NOTEPAD, if not it 
:: ** exits without any error (note the && and the 2> error redirection)
DIR *.TXT > TXT.LST 2> NUL && NOTEPAD TXT.LST 
```

* * *

## 回答 #60

> 赞同：1
> 
> 时间：2008-12-11T00:54:48.780

允许您根据环境变量更改目录，而无需指定 '%' 指令。如果指定的变量不存在，则尝试目录名称。

```
@if defined %1 (call cd "%%%1%%") else (call cd %1) 
```

* * *

## 回答 #61

> 赞同：1
> 
> 时间：2009-06-29T23:25:40.390

我会说 DEBUG.EXE 是批处理文件的一个非常有用且未充分利用的功能。

DEBUG 命令允许您...

1.  汇编和反汇编 16 位代码
2.  读/写内存（现代受保护的内存大大降低了它的用处。）
3.  从硬盘读取数据扇区，原始
4.  十六进制编辑

简而言之，这个工具非常强大。这些天可能不再使用它，但是从批处理脚本调用和控制此功能的功能为批处理脚本增加了惊人的功能。

注意：据我所知，Microsoft 已从 64 位版本的 Windows Xp 和 Vista 中删除了此命令，并打算将其从 Windows 7 中完全删除。

* * *

## 回答 #62

> 赞同：1
> 
> 时间：2009-07-02T23:46:43.770

从文件中设置环境变量`SET /P`

```
SET /P SVNVERSION=<ver.tmp 
```

* * *

## 回答 #63

> 赞同：1
> 
> 时间：2009-07-22T22:05:05.557

将错误级别设置为您想要的任何数字的方法：

```
CMD /C 退出号
```

* * *

## 回答 #64

> 赞同：1
> 
> 时间：2009-08-04T17:34:22.030

goto :eof 粘贴板

我在脚本末尾添加“goto :eof”作为代码片段的方便空间。这样我就可以快速复制/粘贴到该区域，而无需评论/取消评论。

```
goto :eof
:: code scraps
call this.bat
call that.bat
set TS=%DATE:~10%%DATE:~4,2%%DATE:~7,2%-%TIME:~0,2%%TIME:~3,2%%TIME:~6%%
for /R C:\temp\ %%G in (*.bak) DO del %%G 
```

* * *

## 回答 #65

> 赞同：1
> 
> 时间：2010-09-24T11:40:38.197

隐藏交互式批处理脚本的输入：

```
 @echo off

  echo hP1X500P[PZBBBfh#b##fXf-V@`$fPf]f3/f1/5++u5>in.com

  set /p secret_password="Enter password:"<nul

  for /f "tokens=*" %%i in ('in.com') do (set secret_password=%%i)

  del in.com 
```

* * *

## 回答 #66

> 赞同：1
> 
> 时间：2010-09-24T11:51:25.440

列出所有驱动器：

```
fsutil fsinfo drives 
```

* * *

## 回答 #67

> 赞同：1
> 
> 时间：2011-03-24T12:29:03.680

创建并开始编辑新文件

```
copy con new.txt
This is the contents of my file
^Z 
```

Ctrl+Z 发送 ASCII EOF 字符。这就像 bash 中的 heredocs：

```
cat <<EOF > new.txt
This is the contents of my file
EOF 
```

* * *

## 回答 #68

> 赞同：1
> 
> 时间：2011-03-24T12:38:41.953

删除周围的报价。

```
for /f "useback tokens=*" %%a in ('%str%') do set str=%%~a 
```

我最近必须编写一个由 VS prebuild 事件调用的批处理文件，并且我想将项目目录作为参数传递。在批处理文件中，我需要将路径与嵌套的子文件夹名称连接起来，但首先需要删除周围的引号。

* * *

## 回答 #69

> 赞同：1
> 
> 时间：2011-03-24T14:05:00.833

错误保释。

```
IF "%errorlevel%" NEQ "0" (
   echo "ERROR:  Something broke.  Bailing out."
   exit /B 1
) 
```

* * *

## 回答 #70

> 赞同：1
> 
> 时间：2011-03-24T14:59:32.567

符号链接：

```
mklink /d directorylink ..\realdirectory
mklink filelink realfile 
```

该命令在 Windows Server 2008 和更新版本（包括 Vista 和 Windows 7）上是本机的。（它也包含在某些 Windows 资源工具包中。）

* * *

## 回答 #71

> 赞同：1
> 
> 时间：2011-03-24T17:35:39.887

使用副本附加文件：

```
copy file1.txt+file2.txt+file3.txt append.txt 
```

此外，要将所有 CLI 参数设置为单个变量：

```
SET MSG=%* 
```

这将获取以空格分隔的每个单词（或符号）并将其保存到单个批处理文件变量中。从技术上讲，每个参数是 %1、%2、$3 等，但是这个 SET 命令使用通配符来引用标准输入中的每个参数。

批处理文件：

```
@SET MSG=%*
@echo %MSG% 
```

命令行：

```
C:\test>test.bat Hello World!
Hello World! 
```

* * *

## 回答 #72

> 赞同：1
> 
> 时间：2011-03-24T18:02:06.667

递归搜索目录树中的字符串：

```
findstr /S /C:"string literal" *.* 
```

您还可以使用正则表达式：

```
findstr /S /R "^ERROR" *.log 
```

递归文件搜索：

```
dir /S myfile.txt 
```

* * *

## 回答 #73

> 赞同：1
> 
> 时间：2011-03-24T21:31:49.123

与上面非常相似，使用 CALL、EXIT /B、SETLOCAL 和 ENDLOCAL，您可以使用局部变量和返回值来实现函数。

例子：

```
@echo off

set x=xxxxx
call :fun 10
echo "%x%"
echo "%y%"
exit /b

:fun
setlocal
set /a y=%1 + 1
endlocal & set x=%y%
exit /b 
```

这将打印：

```
"11"
"" 
```

y 变量永远不会离开本地作用域，但是由于 CMD 一次解析一行的方式，您可以将值提取到父作用域中的 x 变量中。

* * *

## 回答 #74

> 赞同：0
> 
> 时间：2008-10-29T01:34:33.533

对于带有数字计数器的循环（输出 1 到 10）：

```
for /l %i in (1,1,10) do echo %i 
```

* * *

## 回答 #75

> 赞同：0
> 
> 时间：2008-10-29T06:40:28.800

这是我用来连续运行 My Nant Build 脚本的一个技巧，而不必一遍又一遍地单击批处理文件。

```
:CODELINE
NANT.EXE -buildfile:alltargets.build -l:build.log build.product
@pause
GOTO :CODELINE 
```

将会发生的是，在您的解决方案完成构建后，它将被暂停。然后，如果您按任意键，它将再次重新运行构建脚本。我必须说非常方便。

* * *

## 回答 #76

> 赞同：0
> 
> 时间：2008-11-03T20:29:16.827

```
HELP 
```

当使用不同的操作系统版本时，了解本机可用的命令很重要。在命令提示符下键入 HELP 会显示可用的命令，并简要说明它们的作用。

```
cmd.exe /? 
```

这将列出用于启动命令提示符的所有命令行参数以及更改系统范围行为的注册表调整。

* * *

## 回答 #77

> 赞同：0
> 
> 时间：2008-11-07T01:48:59.270

在脚本中使用**命令扩展**shell 选项时，强烈建议您在脚本开头执行以下技巧。

[-- 从http://www.ss64.com/nt/setlocal.html](http://www.ss64.com/nt/setlocal.html "http://www.ss64.com/nt/setlocal.html")粘贴的信息

> 如果给定一个参数，SETLOCAL 将设置一个 ERRORLEVEL。如果给出两个有效参数之一，则它将为零，否则为零。
> 
> 您可以在批处理文件中使用它来确定命令扩展是否可用，使用以下技术：

```
VERIFY errors 2>nul
SETLOCAL ENABLEEXTENSIONS
IF ERRORLEVEL 1 echo Unable to enable extensions 
```

> 这是因为“验证错误”将 ERRORLEVEL 设置为 1，然后如果扩展不可用（例如，如果脚本在 command.com 下运行），SETLOCAL 将无法重置 ERRORLEVEL 值
> 
> 如果命令扩展被永久禁用，则 SETLOCAL ENABLEEXTENSIONS 将不会恢复它们。

* * *

## 回答 #78

> 赞同：0
> 
> 时间：2008-11-20T10:16:10.200

获取环境变量总大小的一个非常古老的（约 1990 年）技巧​​：

```
set > test
dir test
del test 
```

* * *

## 回答 #79

> 赞同：0
> 
> 时间：2008-11-24T18:19:23.297

此批处理文件**既可**用于简单**文件**，也可用于**目录**作为命令行参数（您可以按任何顺序混合它们）。循环在任何指定的文件上运行命令（在本例中为“echo”），如果参数是目录，它会在其中的每个文件上递归地运行命令。

```
@echo off
for /f "delims=" %%f in ('dir %* /a-d /b /s') do echo %%f 
```

* * *

## 回答 #80

> 赞同：0
> 
> 时间：2009-05-24T17:46:11.100

IF 命令！没有它，我的批处理文件就是垃圾！

```
@echo off
IF exist %windir%\system32\iexplore.exe goto end

echo Hmm... it seems you do not have Internet Explorer.
echo Great! You seem to understand ;)

:end
echo Hmm... You have Internet Explorer.
echo That is bad :) 
```

* * *

## 回答 #81

> 赞同：0
> 
> 时间：2009-05-24T18:20:45.663

我真的很喜欢这个[Windows XP 命令](http://www.ss64.com/nt/)参考，以及顶部的[语法链接；](http://www.ss64.com/nt/syntax.html)它涵盖了其他答案中已经发现的许多提示和技巧。

* * *

## 回答 #82

> 赞同：0
> 
> 时间：2009-06-29T23:36:11.760

还有 EDLIN 命令。虽然它可能是一个曾经用于基于行的文本编辑的老混蛋工具，但它可以从命令行控制这一事实使得它对批处理脚本非常有用，主要是因为，就像您使用 EDLIN 的任何其他情况一样，它是唯一可用的工具。毕竟，EDLIN 不是您通常想要用于文本编辑的工具，除非您有点自虐倾向。引用蒂姆·帕特森（编写它的人）的话：“当我听说 IBM 正在使用它而不是把它扔到窗外时，我惊呆了。”

注意：EDLIN 将老式的 EOF (1A) 标记添加到它编辑的文件中。如果您需要删除它们，您可能必须使用 DEBUG。

* * *

## 回答 #83

> 赞同：0
> 
> 时间：2009-10-11T00:46:58.780

当将未知数量的参数传递给批处理文件时，例如，当将多个文件拖放到批处理文件上以启动它时，您可以按名称引用每个参数变量，例如

```
TYPE %1
TYPE %2
TYPE %3
TYPE %4
TYPE %5
...etc 
```

但是当您要检查每个参数是否存在时，这会变得非常混乱：

```
if [%1] NEQ [] (
TYPE %1
)
if [%2] NEQ [] (
TYPE %2
)
if [%3] NEQ [] (
TYPE %3
)
if [%4] NEQ [] (
TYPE %4
)
if [%5] NEQ [] (
TYPE %5
)
...etc 
```

此外，您只能使用这种方法接受有限数量的参数。

相反，请尝试使用 SHIFT 命令：

```
:loop
IF [%1] NEQ [] (
TYPE %1
) ELSE (
GOTO end
)
SHIFT
GOTO loop
:end 
```

SHIFT 会将所有参数向下移动 1，因此 %2 变为 %1 并且 %3 变为 %2 等等。

* * *

## 回答 #84

> 赞同：0
> 
> 时间：2009-10-23T12:39:25.340

`FIND`作为grep的替代品。
我用 find 为自己破解了一个小“电话簿”。非常有用：

```
@echo off
:begin
set /p term=Enter query: 
type phonebookfile.txt |find /i "%term%"
if %errorlevel% == 0 GOTO :choose
echo No entry found
set /p new_entry=Add new entry: 
echo %new_entry% >> phonebookfile.txt 
:choose
set /p action=(q)uit, (n)ew query or (e)dit? [q] 
if "%action%"=="n" GOTO anfang
if "%action%"=="e" (
    notepad phonebookfile.txt
    goto :choose
) 
```

非常快速有效。

* * *

## 回答 #85

> 赞同：0
> 
> 时间：2011-03-24T17:20:10.050

基于行的执行

虽然在大多数情况下不是一个明显的好处，但它可以在尝试更新正在运行的东西时提供帮助。例如：

更新源.bat

```
copy UpdateSource.bat Current.bat
echo "Hi!" 
```

当前.bat

```
copy UpdateSource.bat Current.bat 
```

现在，执行 Current.bat 会产生这个输出。

```
HI! 
```

*但请注意*，批处理执行按行号进行。如果基本行没有完全相同的行号，这样的更新最终可能会跳过或移回一行。

* * *

## 回答 #86

> 赞同：0
> 
> 时间：2011-03-24T18:35:10.543

我将它们用作常用目录的快捷方式。一个名为“sandbox.bat”的示例文件，它位于我的 PATH 目录中

```
EXPLORER "C:\Documents and Settings\myusername\Desktop\sandbox" 
```

调用脚本只需 WIN+R --> 沙箱

* * *

## 回答 #87

> 赞同：0
> 
> 时间：2011-03-24T18:46:54.913

要获取用于日志文件等的当前日期/时间，我在批处理文件中使用它：

```
for /f "usebackq tokens=1,2,3,4,5,6,7 delims=/:. " %%a in (`echo %DATE% %TIME%`) do set NOW=%%d%%b%%c_%%e%%f%%g
set LOG=output_%NOW%.log 
```

* * *

## 回答 #88

> 赞同：0
> 
> 时间：2012-02-21T22:08:23.110

您可以在批处理文件运行时对其进行修改。例如，`pause`如果您想在批处理文件退出之前查看结果，可以在文件运行时在文件末尾添加忘记。

请参阅[在运行时更改批处理文件](https://stackoverflow.com/questions/906586/changing-a-batch-file-when-its-running)

我个人认为这更像是一个陷阱而不是一个功能。

* * *

## 回答 #89

> 赞同：-1
> 
> 时间：2011-03-24T18:51:31.497

要从文件的第一行设置环境变量，我使用以下命令：

```
rem a.txt contains one line: abc123
set /p DATA=<a.txt
echo data: %DATA% 
```

这将输出：abc123

* * *

## 回答 #90

> 赞同：-1
> 
> 时间：2011-03-24T20:59:29.450

**批处理脚本最**常见的要求之一是记录生成的输出以供以后查看。是的，您可以将 stdout 和 stderr 重定向到一个文件，但是除非您跟踪日志文件，否则您将看不到发生了什么。

因此，请考虑使用像 logger 这样的 stdout/stderr 日志记录实用程序运行批处理脚本，该实用程序将使用时间戳记录输出，并且您仍然可以在脚本发生时看到脚本进度。

[另一个 stdout/stderr 日志记录实用程序](http://code.google.com/p/mulder/downloads/list?sort=-uploaded)

```
Yet another stdout/stderr logging utility [2010-08-05]
Copyright (C) 2010 LoRd_MuldeR <MuldeR2@GMX.de>
Released under the terms of the GNU General Public License (see License.txt)

Usage:
  logger.exe [logger options] : program.exe [program arguments]
  program.exe [program arguments] | logger.exe [logger options] : -

Options:
  -log <file name>  Name of the log file to create (default: "<program> <time>.log")
  -append           Append to the log file instead of replacing the existing file
  -mode <mode>      Write 'stdout' or 'stderr' or 'both' to log file (default: 'both')
  -format <format>  Format of log file, 'raw' or 'time' or 'full' (default: 'time')
  -filter <filter>  Don't write lines to log file that contain this string
  -invert           Invert filter, i.e. write only lines to log file that match filter
  -ignorecase       Apply filter in a case-insensitive way (default: case-sensitive)
  -nojobctrl        Don't add child process to job object (applies to Win2k and later)
  -noescape         Don't escape double quotes when forwarding command-line arguments
  -silent           Don't print additional information to the console
  -priority <flag>  Change process priority (idle/belownormal/normal/abovenormal/high)
  -inputcp <cpid>   Use the specified codepage for input processing (default: 'utf8')
  -outputcp <cpid>  Use the specified codepage for log file output (default: 'utf8') 
```

* * *

## 回答 #91

> 赞同：-2
> 
> 时间：2009-05-24T18:49:03.150

提取随机文本行

```
@echo off

:: Get time (alas, it's only HH:MM xM

for /f %%a in ('time /t') do set zD1=%%a

:: Get last digit of MM

set zD2=%zD1:~4,1%

:: Seed the randomizer, if needed

if not defined zNUM1 set /a zNUM1=%zD2%

:: Get a kinda random number

set /a zNUM1=zNUM1 * 214013 + 2531011

set /a zNUM2=zNUM1 ^>^> 16 ^& 0x7fff

:: Pull off the first digit

:: (Last digit would be better, but it's late, and I'm tired)

set zIDX=%zNUM2:~0,1%

:: Map it down to 0-3

set /a zIDX=zIDX/3

:: Finally, we can set do some proper initialization

set /a zIIDX=0

set zLO=

set zLL=""

:: Step through each line in the file, looking for line zIDX

for /f "delims=@" %%a in (c:\lines.txt) do call :zoo  %zIDX%  %%a

:: If line zIDX wasn't found, we'll settle for zee LastLine

if "%zLO%"=="" set zLO=%zLL%

goto awdun

:: See if the current line is line zIDX

:zoo

:: Save string of all parms

set zALL=%*

:: Strip off the first parm (sure hope lines aren't longer than 254 chars)

set zWORDS=%zALL:~2,255%

:: Make this line zee LastLine

set zLL=%zWORDS%

:: If this is the line we're looking for, make it zee LineOut

if {%1}=={%zIIDX%} set zLO=%zWORDS%

:: Keep track of line numbers

set /a zIIDX=%zIIDX% + 1

goto :eof

:awdun

echo ==%zLO%==

:: Be socially responsible

set zALL=

set zD1=

set zD2=

set zIDX=

set zIIDX=

set zLL=

set zLO=

:: But don't mess with seed

::set zNUM1=

set zNUM2=

set zWORDS= 
```

# c# - 如何使用反射获取对象的属性？

> ID：245401
> 
> 赞同：2
> 
> 时间：2008-10-29T00:38:22.837
> 
> 标签：c#, reflection

我知道我能做到

```
foreach (PropertyInfo property in myobject.GetType().GetProperties())
{
    if (property.DeclaringType.ToString() == myobject.GetType().ToString())
    {
         // only have my object properties here
         // and not parent of my object properties
    }
} 
```

但是我怎样才能得到**myobject**的属性而不是父对象的属性呢？即不必做额外的 if 语句。

编辑回答，（感谢@Greg Beech）这有效：-

```
foreach (PropertyInfo property in 
             myobject.GetType().GetProperties
                 (BindingFlags.Public | 
                  BindingFlags.DeclaredOnly | 
                  BindingFlags.Instance))
{
    // only properties of my object not parent of myobject
} 
```

我还找到了这个链接 [http://msdn.microsoft.com/en-us/library/4ek9c21e.aspx](http://msdn.microsoft.com/en-us/library/4ek9c21e.aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T00:43:57.363

签出`BindingFlags.DeclaredOnly`并将其传递给`GetProperties`（您可能至少希望将其与`BindingFlags.Public`and结合使用）。`BindingFlags.Instance`

# bash - 如何删除/移除 shell 函数？

> ID：245406
> 
> 赞同：188
> 
> 时间：2008-10-29T00:40:48.010
> 
> 标签：bash, shell, zsh

我已经这样做了：

```
$ z() { echo 'hello world'; } 
```

我该如何摆脱它？

* * *

## 回答 #1

> 赞同：288
> 
> 时间：2008-10-29T00:42:16.417

```
unset -f z 
```

将取消设置名为 z 的函数。几个人的回答是：

```
unset z 
```

但是如果您有一个函数和一个名为 z 的变量，则只有该变量将被取消设置，而不是该函数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-12-19T19:49:49.547

在 Zsh 中：

```
unfunction z 
```

`unhash -f z`这是or的另一个（可以说是更好的）名称，`unset -f z`并且与以下家族的其他成员一致：

*   `unset`
*   `unhash`
*   `unalias`
*   `unlimit`
*   `unsetopt`

如果对此类事情有疑问，请键入`un<tab>`以查看完整列表。

*（稍微相关：如果您已将它们分开/分组，那么使用 , , , 等函数/别名来“重新”各个`realiases`文件`refunctions`也`resetopts`很好。`reenv`）`source`*

# asp.net - ASP.NET——如何使用来自 ASHX 处理程序的 XML 数据响应填充 TreeView 控件

> ID：245418
> 
> 赞同：4
> 
> 时间：2008-10-29T00:44:51.137
> 
> 标签：asp.net, xml, treeview, xmldatasource

我有一个返回 XML 响应 (FileStructureXML.ashx) 的 ASHX 处理程序。

现在我需要从 ASHX 处理程序获取 XML 响应并将其用作我的 ASPX 页面的数据源。

如果我将 XMLDataSource 指向服务器上的静态 XML 文件，则树视图会按预期填充。但是，如果我将 XMLDataSource 指向 ASHX 处理程序而不是服务器上的静态 XML 文件，它就不起作用。

任何帮助，将不胜感激。

```
<body>
    <form id="form1" runat="server">
    <div>

        <asp:TreeView ID="TreeView_Folders" runat="server" DataSourceID="FileXML">
            <DataBindings>
                <asp:TreeNodeBinding DataMember="Directory" TextField="Name" />
                <asp:TreeNodeBinding DataMember="File" TextField="Name" />
            </DataBindings>        
        </asp:TreeView> 
    </div>
    <div>
        <asp:XmlDataSource ID="FileXML" runat="server" DataFile="FileStructureXML.ashx">
        </asp:XmlDataSource>
    </div>
    </form>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T03:11:43.447

我认为 XmlDataSource 仅适用于实际文件，而不适用于 URL。您可以通过不指定 DataFile 属性并在后面的代码中动态加载 Data 属性来解决此问题。我认为 FirstChild.OuterXml 选择是正确的，但您可能需要进行试验。我不在可以测试它的地方。

```
XmlDocument treeDoc = new XmlDocument();
treeDoc.Load( "~/FileStructureXML.ashx" ); // this takes a URL
FileXml.Data = treeDoc.FirstChild.OuterXml; // everything after the xml definition 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-28T19:39:24.253

```
将 oDataSet 变暗为新数据集
    公共子 PopulateTree（ByVal ParentId 作为字符串，ByVal TVNode 作为 TreeNode）
        将 oDataView 调暗为新 DataView(oDataSet.Tables(0), "ParentID='" & ParentId & "'",
        "数据"，DataViewRowState.OriginalRows)
        将 oDataRow 变暗为 DataRowView
        对于 oDataView 中的每个 oDataRow
            将 oTreeNode 调暗为新 TreeNode(oDataRow("DATA"))
            将 oComboBox 调暗为新的 ComboBox
            如果 TVNode 什么都不是，那么
            别的
                TVNode.Nodes.Add(oTreeNode)
                填充树（oDataRow（“ID”），oTreeNode）
            万一
        下一个
    结束子

这就是你调用上述函数的方式
PopulateTree(0, tvPost.TopNode)
tvPost - 它的名称 TreeView T

阅读更多点击此链接
http://muruganad.com/ASP.NET/ASP_.NET_How_to_Populate_a_TreeView_Control_With_TreeNode_s_Using_recursive_algorithm_or_recursion_.html

```

# actionscript-3 - 加载 swf 阶段的尺寸

> ID：245420
> 
> 赞同：8
> 
> 时间：2008-10-29T00:45:25.397
> 
> 标签：actionscript-3, flash, external

情况是这样的——我有一个加载外部.swf 的shell。现在，.swf 是 800x600，但它是一个动画片段，并且有一些元素延伸到舞台之外。当我将 .swf 加载到 shell 中并调用它的 width 属性时，它返回 1200 - 因为它包括脱离舞台的元素。

这不是我想要的——理想情况下，会有两个属性，一个返回“计算的宽度”，一个返回“默认宽度”。这些属性是否存在，如果不存在，最好的解决方法是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-29T14:46:41.267

由创建它的 FLA 定义的已加载 SWF 的宽度和高度可以`Loader`在您已将 SWF 加载到的对象中找到。

```
swfLoader.contentLoaderInfo.width
swfLoader.contentLoaderInfo.height 
```

这将始终显示 FLA 属性中定义的尺寸。如果有任何图像、MovieClips 或您从舞台上延伸出来的东西，这没有什么区别。

`stage.stageWidth`和属性将`stage.stageHeight`始终返回舞台的宽度，舞台始终是最顶部的 SWF。换句话说，它将始终代表外壳舞台的尺寸。Flash 应用程序中只有一个阶段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T23:15:52.580

Mark 很可能是正确的，[内容加载器信息](http://livedocs.adobe.com/flex/3/langref/flash/display/LoaderInfo.html#width)对象将包含正确的宽度和高度。我从来没有检查过自己，所以我不能保证。文档说“名义”并将其与“实际”进行对比，因此看起来很合理。

还有其他几个选项。您可以屏蔽外部 swf。创建一个与舞台大小相同的蒙版，并将所有内容放在其下方。另一个想法是创建一个基于矩形形状的动画剪辑，将其 alpha 设置为 0 将其放置在 x:0, y:0 并将其宽度和高度与舞台相匹配。给它一个实例名称，然后在加载它时使用该值作为大小。

# .net - 在 DataGridView 中留下一行之前检查错误的最佳方法是什么

> ID：245421
> 
> 赞同：1
> 
> 时间：2008-10-29T00:45:29.123
> 
> 标签：.net, winforms, data-binding

据我所知，最好的方法是在 DataTable.RowChanging 事件中进行。但是如果我想取消操作怎么办？没有 EventArgs.Cancel 选项...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T00:53:38.390

从 DataTable.RowChanging 事件处理程序中，您可以引发异常以取消更改。异常将被抛出到进行更改的代码段，您可以在其中适当地处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T10:46:50.360

的情况下`DataGridView`，如果在中抛出异常`DataTable.RowChanging`，可以在中处理`DataGridView.OnError`。设置`EventArgs.Cancel`为`true`保留数据输入。

# javascript - XUL（特别是 firefox）状态栏定位是如何工作的？

> ID：245422
> 
> 赞同：1
> 
> 时间：2008-10-29T00:46:09.857
> 
> 标签：javascript, firefox, xul

当我去创建我的状态栏覆盖时，我注意到我可以包含一个位置属性。我希望能够动态更改此属性。据我所知，仅使用 JavaScript 查找元素并更改位置属性不会在状态栏上移动状态栏面板。

关于如何做到这一点的任何建议？

谢谢，内森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-11T21:15:27.993

你是对的，改变位置似乎没有任何效果；我假设 XUL 引擎仅在将节点插入主文档的 DOM 树时才查看它。

看起来 DOM 元素操作的东西会起作用。

```
var nodeToMove = ...;
var parent = nodeToMove.parentNode;
parentNode.removeChild(nodeToMove);
parentNode.insertBefore(nodeToMove, someOtherNode); 
```

将从任何地方获取节点并将其粘贴在 someOtherNode 之前。

# c# - 将 DataSource 属性添加到自定义 WinForms 控件

> ID：245441
> 
> 赞同：5
> 
> 时间：2008-10-29T00:55:55.640
> 
> 标签：c#, winforms, data-binding

我想将复杂的数据绑定添加到我的自定义 winforms 控件中，因此我可以执行以下操作：

```
myControl.DisplayMember = "Name";
myControl.ValueMember = "Name";
myControl.DataSource = new List<someObject>(); 
```

有谁知道必须实现哪些接口等才能实现这一目标？

我看过它，我发现的只是`IBindableComponent`，但这似乎是针对简单绑定而不是复杂绑定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2018-12-14T07:14:13.650

将以下属性之一应用于您的自定义控件，具体取决于您需要哪种数据绑定：

*   对于复杂的数据绑定：[`ComplexBindingPropertiesAttribute`](https://docs.microsoft.com/dotnet/api/system.componentmodel.complexbindingpropertiesattribute "文档")
*   对于查找数据绑定：[`LookupBindingPropertiesAttribute`](https://docs.microsoft.com/dotnet/api/system.componentmodel.lookupbindingpropertiesattribute "文档")

（这个问题特别提到了*复杂*的数据绑定，但给定的代码示例对我来说看起来像是*查找*数据绑定，所以我将两者都包括在内。）

例如实现，请查看[.NET Framework 源代码](https://referencesource.microsoft.com/ "源代码")：

*   `ComplexBindindPropertiesAttribute`实施于[`DataGridView`](https://referencesource.microsoft.com/#System.Windows.Forms/winforms/Managed/System/WinForms/DataGridView.cs "源代码")
*   `LookupBindingPropertiesAttribute`实施于[`ListControl`](https://referencesource.microsoft.com/#System.Windows.Forms/winforms/Managed/System/WinForms/ListControl.cs "源代码")

* * *

但这些实现对我来说看起来非常复杂，因此将现有控件（例如 a或）嵌入到您自己的自定义控件中以利用其现有的数据绑定实现可能更容易，而不是编写您自己的`DataGridView`。（如有必要，您可以使嵌入式控件不可见。）这是 Microsoft 在以下指南中展示的方法：`ListBox``ComboBox`

*   [创建支持复杂数据绑定的 Windows 窗体用户控件](https://docs.microsoft.com/visualstudio/data-tools/create-a-windows-forms-user-control-that-supports-complex-data-binding)
*   [创建支持查找数据绑定的 Windows 窗体用户控件](https://docs.microsoft.com/visualstudio/data-tools/create-a-windows-forms-user-control-that-supports-lookup-data-binding)

在这些指南中，他们创建了一个数据源来将自定义控件绑定到外部数据库，但看起来您只是在尝试将自定义控件绑定到内部集合，例如`List<T>`. 在这种情况下，下面的改编代码可能对您有用。

* * *

在 Visual Studio 的 Windows 窗体项目中，添加一个新的`UserControl`.

对于*复杂*的数据绑定，应用`ComplexBindingPropertiesAttribute`到自定义控件。给它添加一个`DataGridView`控件。添加`DataSource`和`DataMember`属性，并将它们挂钩到`DataGridView`自己的属性中。

```
// ComplexBindingControl.cs
// Adapted from https://docs.microsoft.com/visualstudio/data-tools/create-a-windows-forms-user-control-that-supports-complex-data-binding

using System.ComponentModel;
using System.Windows.Forms;

namespace BindingDemo
{
    [ComplexBindingProperties("DataSource", "DataMember")]
    public partial class ComplexBindingControl : UserControl
    {
        public ComplexBindingControl()
        {
            InitializeComponent();
        }

        // Use a DataGridView for its complex data binding implementation.

        public object DataSource
        {
            get => dataGridView1.DataSource;
            set => dataGridView1.DataSource = value;
        }

        public string DataMember
        {
            get => dataGridView1.DataMember;
            set => dataGridView1.DataMember = value;
        }
    }
} 
```

对于*查找*数据绑定，将 应用于`LookupBindingPropertiesAttribute`自定义控件。向其添加一个`ListBox`或`ComboBox`控件。添加`DataSource`、和属性`DisplayMember`，并将它们挂接到' 或' 自己的属性中。`ValueMember``LookupMember``ListBox``ComboBox`

```
// LookupBindingControl.cs
// Adapted from https://docs.microsoft.com/visualstudio/data-tools/create-a-windows-forms-user-control-that-supports-lookup-data-binding

using System.ComponentModel;
using System.Windows.Forms;

namespace BindingDemo
{
    [LookupBindingProperties("DataSource", "DisplayMember", "ValueMember", "LookupMember")]
    public partial class LookupBindingControl : UserControl
    {
        public LookupBindingControl()
        {
            InitializeComponent();
        }

        // Use a ListBox or ComboBox for its lookup data binding implementation.

        public object DataSource
        {
            get => listBox1.DataSource;
            set => listBox1.DataSource = value;
        }

        public string DisplayMember
        {
            get => listBox1.DisplayMember;
            set => listBox1.DisplayMember = value;
        }

        public string ValueMember
        {
            get => listBox1.ValueMember;
            set => listBox1.ValueMember = value;
        }

        public string LookupMember
        {
            get => listBox1.SelectedValue?.ToString();
            set => listBox1.SelectedValue = value;
        }
    }
} 
```

（*编辑：*感谢[弗兰克的回答](https://stackoverflow.com/a/56788463/10366669)提醒我`listBox1.SelectedValue`可能是`null`。）

要对其进行测试，请在 Visual Studio 中构建项目，然后将自定义控件的一个实例添加到`Form`. 创建一些示例数据，并使用其相关属性将其绑定到自定义控件。

```
// Form1.cs

using System.Collections.Generic;
using System.Windows.Forms;

namespace BindingDemo
{
    public partial class Form1 : Form
    {
        private readonly List<SomeObject> data;

        public Form1()
        {
            InitializeComponent();

            // Prepare some sample data.
            data = new List<SomeObject>
            {
                new SomeObject("Alice"),
                new SomeObject("Bob"),
                new SomeObject("Carol"),
            };

            // Bind the data to your custom control...

            // ...for "complex" data binding:
            complexBindingControl1.DataSource = data;

            // ...for "lookup" data binding:
            lookupBindingControl1.DataSource = data;
            lookupBindingControl1.DisplayMember = "Name";
            lookupBindingControl1.ValueMember = "Name";
        }
    }

    internal class SomeObject
    {
        public SomeObject(string name)
        {
            Name = name;
        }

        public string Name { get; set; }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-06T17:56:05.943

您的类需要继承 DataBoundControl 类而不是 UserControl。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-27T09:52:45.647

要运行非常有用的 Chris Tollefson BindingDemo 示例而不会出现问题，请在 LookupMember getter 周围放置一个 try/catch 块，如下所示：

```
public string LookupMember {
       get {
            try {
                return listBox1.SelectedValue.ToString();
            }
            catch { return null; }
        }
        set => listBox1.SelectedValue = value;
    } 
```

# python - 如何使用 python 的 PIL 以一定角度绘制文本？

> ID：245447
> 
> 赞同：35
> 
> 时间：2008-10-29T01:04:48.977
> 
> 标签：python, python-imaging-library, imaging

使用 Python 我希望能够使用 PIL 以不同的角度绘制文本。

例如，假设您在时钟的表面画数字。数字**3**将按预期出现，而**12**我们将逆时针旋转 90 度。

因此，我需要能够以许多不同的角度绘制许多不同的字符串。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-10-29T05:31:25.397

将文本绘制到临时空白图像中，旋转它，然后将其粘贴到原始图像上。您可以将这些步骤包装在一个函数中。祝你好运，弄清楚要使用的确切坐标——我冷酷的大脑现在无法应对。

此演示在图像上倾斜写入黄色文本：

```
# Demo to add rotated text to an image using PIL

import Image
import ImageFont, ImageDraw, ImageOps

im=Image.open("stormy100.jpg")

f = ImageFont.load_default()
txt=Image.new('L', (500,50))
d = ImageDraw.Draw(txt)
d.text( (0, 0), "Someplace Near Boulder",  font=f, fill=255)
w=txt.rotate(17.5,  expand=1)

im.paste( ImageOps.colorize(w, (0,0,0), (255,255,84)), (242,60),  w) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-12T10:48:23.223

在创建 Image 对象之前了解文本的像素大小也很有用。我在绘制图表时使用了这样的代码。然后我没有遇到问题，例如数据标签的对齐（图像与文本一样大）。

```
(...)
img_main = Image.new("RGB", (200, 200))
font = ImageFont.load_default()

# Text to be rotated...
rotate_text = u'This text should be rotated.'

# Image for text to be rotated
img_txt = Image.new('L', font.getsize(rotate_text))
draw_txt = ImageDraw.Draw(img_txt)
draw_txt.text((0,0), rotate_text, font=font, fill=255)
t = img_value_axis.rotate(90, expand=1) 
```

本页已经描述了将两个图像连接在一起的其余部分。当您以“不规则”角度旋转时，您必须稍微改进此代码。它实际上适用于 90、180、270 ......

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-02-23T19:44:14.707

这是一个工作版本，受答案启发，但无需打开或保存图像即可工作。

这两个图像有彩色背景和不同于零的 alpha 通道，以显示正在发生的事情。将两个 Alpha 通道从 92 更改为 0 将使它们完全透明。

```
from PIL import Image, ImageFont, ImageDraw

text = 'TEST'
font = ImageFont.truetype(r'C:\Windows\Fonts\Arial.ttf', 50)
width, height = font.getsize(text)

image1 = Image.new('RGBA', (200, 150), (0, 128, 0, 92))
draw1 = ImageDraw.Draw(image1)
draw1.text((0, 0), text=text, font=font, fill=(255, 128, 0))

image2 = Image.new('RGBA', (width, height), (0, 0, 128, 92))
draw2 = ImageDraw.Draw(image2)
draw2.text((0, 0), text=text, font=font, fill=(0, 255, 128))

image2 = image2.rotate(30, expand=1)

px, py = 10, 10
sx, sy = image2.size
image1.paste(image2, (px, py, px + sx, py + sy), image2)

image1.show() 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-07-21T00:55:34.933

这是对角线水印的更完整示例。通过计算对角线的角度和字体大小来处理任意图像比例、大小和文本长度。

```
from PIL import Image, ImageFont, ImageDraw
import math

# sample dimensions
pdf_width = 1000
pdf_height = 1500

#text_to_be_rotated = 'Harry Moreno'
text_to_be_rotated = 'Harry Moreno (morenoh149@gmail.com)'
message_length = len(text_to_be_rotated)

# load font (tweak ratio based on your particular font)
FONT_RATIO = 1.5
DIAGONAL_PERCENTAGE = .5
diagonal_length = int(math.sqrt((pdf_width**2) + (pdf_height**2)))
diagonal_to_use = diagonal_length * DIAGONAL_PERCENTAGE
font_size = int(diagonal_to_use / (message_length / FONT_RATIO))
font = ImageFont.truetype(r'./venv/lib/python3.7/site-packages/reportlab/fonts/Vera.ttf', font_size)
#font = ImageFont.load_default() # fallback

# target
image = Image.new('RGBA', (pdf_width, pdf_height), (0, 128, 0, 92))

# watermark
opacity = int(256 * .5)
mark_width, mark_height = font.getsize(text_to_be_rotated)
watermark = Image.new('RGBA', (mark_width, mark_height), (0, 0, 0, 0))
draw = ImageDraw.Draw(watermark)
draw.text((0, 0), text=text_to_be_rotated, font=font, fill=(0, 0, 0, opacity))
angle = math.degrees(math.atan(pdf_height/pdf_width))
watermark = watermark.rotate(angle, expand=1)

# merge
wx, wy = watermark.size
px = int((pdf_width - wx)/2)
py = int((pdf_height - wy)/2)
image.paste(watermark, (px, py, px + wx, py + wy), watermark)

image.show() 
```

这是在 colab 中[https://colab.research.google.com/drive/1ERl7PiX6xKy5H9EEMulBKPgglF6euCNA?usp=sharing](https://colab.research.google.com/drive/1ERl7PiX6xKy5H9EEMulBKPgglF6euCNA?usp=sharing)您应该向 colab 提供示例图像。 [![500 乘 300](https://i.stack.imgur.com/l4yeq.png)](https://i.stack.imgur.com/l4yeq.png)[![300 乘 500](https://i.stack.imgur.com/4vKrT.png)](https://i.stack.imgur.com/4vKrT.png)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-29T04:55:33.097

我并不是说这会很容易，或者这个解决方案对您来说一定是完美的，但请查看此处的文档：

[http://effbot.org/imagingbook/pil-index.htm](http://effbot.org/imagingbook/pil-index.htm)

尤其要注意 Image、ImageDraw 和 ImageFont 模块。

这是一个可以帮助您的示例：

```
 import Image
im = Image.new("RGB", (100, 100))
import ImageDraw
draw = ImageDraw.Draw(im)
draw.text((50, 50), "hey")
im.rotate(45).show() 
```

为了做你真正想做的事情，你可能需要制作一堆单独的正确旋转的文本图像，然后通过一些更花哨的操作将它们组合在一起。毕竟，它仍然可能看起来不太好。例如，我不确定如何处理抗锯齿等，但它可能并不好。祝你好运，如果有人有更简单的方法，我也有兴趣知道。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-04-27T15:20:47.113

前面的答案绘制成一个新图像，旋转它，然后将它绘制回源图像。这会留下文本伪影。我们不希望那样。

这是一个版本，它改为裁剪将要绘制到的源图像的区域，旋转它，绘制到该区域，然后将其旋转回来。这意味着我们可以立即在最终表面上绘制，而无需使用蒙版。

```
def draw_text_90_into (text: str, into, at):
    # Measure the text area
    font = ImageFont.truetype (r'C:\Windows\Fonts\Arial.ttf', 16)
    wi, hi = font.getsize (text)

    # Copy the relevant area from the source image
    img = into.crop ((at[0], at[1], at[0] + hi, at[1] + wi))

    # Rotate it backwards
    img = img.rotate (270, expand = 1)

    # Print into the rotated area
    d = ImageDraw.Draw (img)
    d.text ((0, 0), text, font = font, fill = (0, 0, 0))

    # Rotate it forward again
    img = img.rotate (90, expand = 1)

    # Insert it back into the source image
    # Note that we don't need a mask
    into.paste (img, at) 
```

支持其他角度、颜色等很容易添加。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2020-02-06T09:04:12.970

对于 Linux，我能够使用以下方法让字体在 debian 上工作：

```
fnt = ImageFont.truetype('LinLibertine_RB.otf', 40) 
```

或您在下面看到的任何字体库

```
ls -lR /usr/share/fonts 
```

如果您安装了 Gimp，字体的名称和示例也包含在 Gimp 中。

# java - 重构这个递归方法？

> ID：245453
> 
> 赞同：5
> 
> 时间：2008-10-29T01:08:25.333
> 
> 标签：java, recursion

我对递归的想法很陌生，这实际上是我第一次尝试编写递归方法。

我试图实现一个递归函数 Max，它传递一个数组，以及一个保存数组大小的变量，以便打印最大的元素。

它有效，但*感觉*不对！

我还注意到，我似乎比一般同学更多地使用静态修饰符......

任何人都可以提供任何一般提示以及有关如何改进代码的反馈吗？

```
public class RecursiveTry{

static int[] n = new int[] {1,2,4,3,3,32,100};
static int current = 0;
static int maxValue = 0;
static int SIZE = n.length;

public static void main(String[] args){
    System.out.println(Max(n, SIZE));
}   

public static int Max(int[] n, int SIZE) {
    if(current <= SIZE - 1){
        if (maxValue <= n[current]) {
            maxValue = n[current];
            current++;
            Max(n, SIZE);                       
        }
        else {
            current++;
            Max(n, SIZE);
        }
    }
    return maxValue;
} 
```

}

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-29T01:17:42.850

您使用静态变量来保持函数外部的状态将是一个困难的来源。

在伪代码中递归实现 max() 函数的示例可能是：

```
function Max(data, size) {
    assert(size > 0)
    if (size == 1) {
        return data[0]
    }
    maxtail = Max(data[1..size], size-1)
    if (data[0] > maxtail) {
        return data[0]
    } else {
        return maxtail
    }
} 
```

这里的关键是对 Max() 的递归调用，您可以在其中传递*除*第一个元素之外的所有元素，并且比大小小一个。一般的想法是这个函数说“这个数据中的最大值是第一个元素，或者是数组其余部分中的最大值，以较大者为准”。

此实现不需要函数定义之外的静态数据。

递归实现的标志之一是所谓的“终止条件”，它可以防止递归永远进行（或者，直到堆栈溢出）。在上述情况下，测试为`size == 1`终止条件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-29T01:28:45.887

让你的函数依赖于静态变量并不是一个好主意。这是递归 Max 函数的可能实现：

```
int Max(int[] array, int currentPos, int maxValue) {
    // Ouch!
    if (currentPos < 0) {
        raise some error
    }
    // We reached the end of the array, return latest maxValue
    if (currentPos >= array.length) {
        return maxValue;
    }
    // Is current value greater then latest maxValue ?
    int currentValue = array[currentPos];
    if (currentValue > maxValue) {
        // currentValue is a new maxValue
        return Max(array, currentPos + 1, currentValue);
    } else {
        // maxValue is still a max value
        return Max(array, currentPos + 1, maxValue);
    }
}
...

int[] array = new int[] {...};
int currentPos = 0;
int maxValue = array[currentPos] or minimum int value;  
    maxValue = Max(array, currentPos, maxValue); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-29T01:14:03.777

“max”函数是编写递归函数的错误类型 - 而且您使用“current”和“maxValue”的静态值这一事实使您的函数不是真正的递归函数。

为什么不做一些更适合递归算法的事情，比如阶乘？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-29T01:28:38.117

“不做作业”？

反正。第一件事。这

```
static int[] n = new int[] {1,2,4,3,3,32,100};
static int SIZE = n.length; 
```

与它们共享名称的 Max() 的参数无关。将这些移到 main 并丢失“静态”说明符。当从 main() 内部调用 Max() 的第一个实例时，它们只使用一次。它们的范围不应超出 main()。

没有理由让 Max() 的所有调用共享一个“当前”索引。“当前”应该是 Max() 的本地。但是，Max() 的连续重复如何知道要使用的“当前”值是什么？（提示：Max() 已经在传递其他 Max() 的下线一些数据。将“当前”添加到此数据。）

maxValue 也是如此，尽管这里的情况有点复杂。您不仅需要将当前的“maxValue”向下传递，而且当递归完成时，您必须将其一直传递回第一个 Max() 函数，该函数会将其返回给 main()。您可能需要查看其他一些递归示例并花一些时间研究这个。

最后，Max() 本身是静态的。但是，一旦您消除了引用外部数据（静态变量）的需要；没关系。这只是意味着您可以调用 Max() 而无需实例化对象。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-29T01:29:40.703

正如其他人所观察到的，实现 Max 函数*不需要*递归，但使用熟悉的算法来试验新概念可能是有益的。所以，这里是简化的代码，下面有解释：

```
public class RecursiveTry
{
    public static void main(String[] args)
    {
        System.out.println(Max(new int[] {1,2,4,3,3,32,100}, 0, 0));
    }   

    public static int Max(int[] n, int current, int maxValue) 
    {
        if(current < n.Length)
        {
            if (maxValue <= n[current] || current == 0))
            {
                return Max(n, current+1, n[current]);
            }
            return Max(n, current+1, maxValue);
        }
        return maxValue;
   }
} 
```

所有的静态都没有必要了；相反，所有内容都在堆栈上传递。Max函数的内部逻辑是流线型的，我们用两种不同的方式递归只是为了好玩

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-29T02:44:36.233

这是适合您的 Java 版本。

```
public class Recursion {

    public static void main(String[] args) {
        int[] data = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };
        System.out.println("Max: " + max(0, data));
    }

    public static int max(int i, int[] arr) {
        if(i == arr.length-1) {
            return arr[i];
        }

        int memo = max(i+1, arr);
        if(arr[i] > memo) {
            return arr[i];
        }
        return memo;
    }
} 
```

递归关系是数组的最大元素要么是第一个元素，要么是数组其余部分的最大值。当您到达数组的末尾时，就达到了停止条件。请注意使用 memoization 将递归调用（大致）减少一半。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-29T01:19:51.253

您实际上是在编写迭代版本，但使用尾递归进行循环。此外，通过将这么多变量设为静态，您实际上是在使用全局变量而不是对象。这是一种更接近典型递归实现的尝试。当然，在现实生活中，如果您使用像 Java 这样不优化尾调用的语言，您将使用循环实现“Max”函数。

```
public class RecursiveTry{
  static int[] n;

  public static void main(String[] args){
        RecursiveTry t = new RecursiveTry(new int[] {1,2,4,3,3,32,100});
        System.out.println(t.Max());
  }       

  RecursiveTry(int[] arg) {
    n = arg;
  }

  public int Max() {
    return MaxHelper(0);
  }

  private int MaxHelper(int index) {
    if(index == n.length-1) {
      return n[index];
    } else {
      int maxrest = MaxHelper(index+1);
      int current = n[index];
      if(current > maxrest)
        return current;
      else
        return maxrest;
    }
  }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-29T01:49:02.677

在 Scheme 中，这可以非常简洁地写成：

```
(define (max l)
    (if (= (length l) 1)
        (first l)
        (local ([define maxRest (max (rest l))])
          (if (> (first l) maxRest)
              (first l)
              maxRest)))) 
```

当然，这使用了链表而不是数组，这就是为什么我没有将 size 元素传递给它的原因，但我觉得这将问题提炼到了本质。这是伪代码定义：

```
define max of a list as:
    if the list has one element, return that element
    otherwise, the max of the list will be the max between the first element and the max of the rest of the list 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-29T03:12:39.763

递归获取数组最大值的更好方法是实现[快速排序](http://en.wikipedia.org/wiki/Quicksort)（这是一种很好的递归排序算法），然后只返回第一个值。

这是一些[用于快速排序的 Java 代码](http://www.cs.princeton.edu/introcs/42sort/QuickSort.java.html)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-29T03:45:51.897

我能得到的最小代码大小：

```
public class RecursiveTry {
    public static void main(String[] args) {
        int[] x = new int[] {1,2,4,3,3,32,100};
        System.out.println(Max(x, 0));
    }   

    public static int Max(int[] arr, int currPos) {
        if (arr.length == 0) return -1;
        if (currPos == arr.length) return arr[0];
        int len = Max (arr, currPos + 1);
        if (len < arr[currPos]) return arr[currPos];
        return len;
    }
} 
```

一些东西：

1/ 如果数组大小为零，则返回最大值 -1（您可以使用另一个标记值，例如 -MAX_INT，或引发异常）。为了代码清晰，我在这里假设所有值都为零或更多。否则我会在代码中加入各种不必要的东西（关于回答问题）。

2/如果终止情况是无数据而不是最后一个数据，我认为大多数递归是“更干净”的，因此当我们完成数组时，我返回一个保证小于或等于最大值的值。其他人的看法可能不同，但这不会是他们第一次或最后一次犯错:-)。

3/ 递归调用只获取列表其余部分的最大值并将其与当前元素进行比较，返回两者中的最大值。

4/“理想”的解决方案是在每次递归调用时传递一个修改后的数组，这样您只需将第一个元素与列表的其余部分进行比较，从而无需 currPos。但这将是低效的，并且会平息 SO 的愤怒。

5/ 这不一定是最好的解决方案。可能是由于过度使用 LISP 及其 CAR、CDR 和那些无休止的括号而损害了灰质。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2008-10-29T01:18:53.893

首先，让我们处理静态范围问题......您的类正在定义一个对象，但从未实际实例化一个对象。由于 main 是静态作用域的，首先要做的是获取一个对象，然后执行它的方法，如下所示：

```
public class RecursiveTry{

    private int[] n = {1,2,4,3,3,32,100};

    public static void main(String[] args){
        RecursiveTry maxObject = new RecursiveTry();
        System.out.println(maxObject.Max(maxObject.n, 0));
    }

    public int Max(int[] n, int start) {
        if(start == n.length - 1) {
            return n[start];
        } else { 
            int maxRest = Max(n, start + 1);
            if(n[start] > maxRest) {
                return n[start];
            }
            return maxRest;
        }
    }

} 
```

所以现在我们有一个名为 maxObject 的 RecursiveTry 对象，它不需要静态范围。我不确定使用递归找到最大值是否有效，因为传统循环方法中的迭代次数大致相等，但使用递归时使用的堆栈量更大。但是对于这个例子，我会减少很多。

递归的优点之一是您的状态通常不需要像在迭代中那样在重复测试期间保持不变。在这里，我承认使用变量来保存起点，因为传递一个包含除第一个项目之外的所有项目的新 int[] 的 CPU 密集度较低。

# asp.net - 获取 ASP.NET 表单名称

> ID：245456
> 
> 赞同：2
> 
> 时间：2008-10-29T01:09:14.567
> 
> 标签：asp.net, javascript, forms

我正在寻找一种方法来获取主 HTML 表单的名称，以便我可以从 JavaScript 提交它。

我可以只设置表单名称的原因是因为 JavaScript 位于用户控件上，可以将其添加到具有不同表单名称的许多不同站点。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-29T01:32:18.437

我不完全确定这会解决你的要求，所以请评论它：

在您的脚本中，当用户控件呈现时，您可以将其放置在那里。只要脚本没有“runat”属性，你就应该很好。

```
<script type="text/javascript">

var formname = '<%=this.Page.Form.Name %>';

</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T01:27:08.587

我不确定，试试“YourUserControl.Page.Form”

但是为什么你需要表单名称，你的 .aspx 页面上是否会有多个表单，如果没有，你可以获得整个回发 JS 代码，用于使用“回发（提交）”的控件Page.ClientScript.GetPostBackEventReference()”并使用它来设置您将用于提交页面的任何内容的“OnClick”属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T01:31:09.890

在 aspx 页面上不能有多个带有 runat="server" 的表单控件，因此您可以使用 document.forms[0]

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-29T01:28:21.613

ASP.NET 页面只能有一个表单，所以这样做是安全的：

```
 document.forms[0].submit(); 
```

# cx-oracle - cx_Oracle & 远程连接到 Oracle DB

> ID：245465
> 
> 赞同：29
> 
> 时间：2008-10-29T01:14:20.813
> 
> 标签：cx-oracle

您如何通过 IP 地址连接到远程服务器，就像 TOAD、SqlDeveloper 能够仅使用 IP 地址、用户名、SID 和密码连接到数据库一样？

每当我尝试指定 IP 地址时，它似乎都在本地使用。

换句话说，cx_Oracle.connect() 的字符串应该如何格式化为非本地数据库？

之前有一篇文章列出了通过 cx_Oracle 模块连接到 Oracle 的答案，代码如下：

```
#!/usr/bin/python

import cx_Oracle
connstr='scott/tiger'
conn = cx_Oracle.connect(connstr)
curs = conn.cursor()

curs.execute('select * from emp')
print curs.description
for row in curs:
    print row
conn.close() 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-12-09T00:27:27.430

我喜欢这样做：

```
ip = '192.168.0.1'
port = 1521
SID = 'YOURSIDHERE'
dsn_tns = cx_Oracle.makedsn(ip, port, SID)

db = cx_Oracle.connect('username', 'password', dsn_tns) 
```

我喜欢这种方法的主要原因之一是我通常在某个地方有一个 TNSNAMES.ORA 文件，我可以通过以下操作检查`dsn_tns`对象是否会做正确的事情：

```
print dsn_tns 
```

并将输出与我的 TNSNAMES.ORA 进行比较

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-07-25T09:18:09.707

您可以在连接字符串中指定服务器，例如：

```
import cx_Oracle
connstr = 'scott/tiger@server:1521/orcl'
conn = cx_Oracle.connect(connstr) 
```

*   “server”是服务器，如果需要，也可以是 IP 地址。
*   “1521”是数据库正在侦听的端口。
*   “orcl”是实例（或数据库服务）的名称。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-06-17T13:28:57.137

```
import cx_Oracle

CONN_INFO = {
    'host': 'xxx.xx.xxx.x',
    'port': 12345,
    'user': 'user_name',
    'psw': 'your_password',
    'service': 'abc.xyz.com',
}

CONN_STR = '{user}/{psw}@{host}:{port}/{service}'.format(**CONN_INFO)

connection = cx_Oracle.connect(CONN_STR) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-10-11T18:45:14.800

[您可以创建一个 dsn 并通过 service_name 连接](http://cx-oracle.readthedocs.io/en/latest/module.html#cx_Oracle.makedsn)，而不是指定 SID，例如：

```
import cx_Oracle
ip = '192.168.0.1'
port = 1521
service_name = 'my_service'
dsn = cx_Oracle.makedsn(ip, port, service_name=service_name)

db = cx_Oracle.connect('user', 'password', dsn) 
```

使用服务名称而不是特定实例标识符 (SID) 的好处是它也可以在 RAC 环境中工作（使用 SID 不会）。此参数自[cx_Oracle 版本 5.1.1](https://bitbucket.org/anthony_tuininga/cx_oracle/commits/b81bd10992eb6a4fb2a3e618cfdf865c72148859)（2011 年 8 月 28 日）起可用

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-09-18T03:24:11.390

```
import cx_Oracle
dsn = cx_Oracle.makedsn(host='127.0.0.1', port=1521, sid='your_sid')
conn = cx_Oracle.connect(user='your_username', password='your_password', dsn=dsn)
conn.close() 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-02-22T03:27:31.280

```
import cx_Oracle
ip = '172.30.1.234'
port = 1524
SID = 'dev3'
dsn_tns = cx_Oracle.makedsn(ip, port, SID)

conn = cx_Oracle.connect('dbmylike', 'pass', dsn_tns)
print conn.version
conn.close() 
```

# c++ - 如何创建通用 std::vector 析构函数？

> ID：245475
> 
> 赞同：4
> 
> 时间：2008-10-29T01:19:39.540
> 
> 标签：c++, stl, vector, destructor

拥有一个包含指向对象的指针的向量，然后使用 clear 函数不会调用向量中对象的析构函数。我创建了一个函数来手动执行此操作，但我不知道如何将其作为向量中可能存在的任何类型对象的通用函数。

```
void buttonVectorCleanup(vector<Button *> dVector){
    Button* tmpClass;
    for(int i = 0; i < (int)dVector.size(); i++){
        tmpClass = dVector[i];

        delete tmpClass;
    }
} 
```

这是我拥有的函数，它适用于向量中的特定类型的对象，但我想要一个可以采用任何类型的向量和对象指针的函数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-29T02:03:25.520

您可能想使用 boost 的[指针容器](http://www.boost.org/doc/libs/1_36_0/libs/ptr_container/doc/ptr_container.html)。它们高效且安全。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-29T01:24:38.547

最好的办法是使用智能指针，例如来自[Boost](http://www.boost.org/doc/libs/1_36_0/libs/smart_ptr/smart_ptr.htm)的。然后对象将被自动删除。

或者你可以制作一个模板功能

```
template <class T>
void vectorCleanup(vector<T *>& dVector){
    T* tmpClass;
    for(vector<T*>::size_type i = 0; i < dVector.size(); i++){
        tmpClass = dVector[i];

        delete tmpClass;
    } 
```

}

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-29T01:35:38.040

其他几点-您可能希望传递对向量的引用，而不是副本。不需要 tmpClass - 您可以直接删除指针。您应该在删除后将向量的大小调整为 0 或用 NULL 替换指针 - 否则您可以在调用函数中访问未分配的内存。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-29T07:24:28.727

我使用一个特殊的仿函数来删除指针并将其设置为 NULL：

```
struct delete_ptr
{
    template <typename T>
    void operator()(T& p)
    {
        delete p;
        p = 0;
    }
}; 
```

与`std::for_each`（也不要忘记`#include <algorithm>`）一起使用：

```
int wmain(int, wchar_t*[])
{
    std::vector<int*> items;
    items.push_back(new int(1));
    items.push_back(new int(2));
    items.push_back(new int(3));
    std::for_each(items.begin(), items.end(), delete_ptr());
}; 
```

# asp.net-mvc - asp.net mvc 以相同的形式发布到不同的视图

> ID：245482
> 
> 赞同：3
> 
> 时间：2008-10-29T01:23:47.020
> 
> 标签：asp.net-mvc, model-view-controller

在我看来，我有表单区域。如果我点击按钮`A`，我想提交`/Books/1`，如果我点击按钮`B`，我想提交给`/Books/2`

如何使用 MVC 实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T03:36:40.107

```
<form id="form1" name="form1" action="/Books/" method="get">
<input type="text" name="search" value="">
<input type="submit" name="id" value="1">
<input type="submit" name="id" value="2">
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T01:31:15.037

MVC 视图在一个“页面”上可以有多个表单，因此只需创建单独的部分并为每个部分提供自己的表单操作。

```
<form id="form1" name="form1" action="/Books/1" method="get">
<!--...form fields-->
</form>

<form id="form2" name="form2" action="/Books/2" method="get">
<!--...form fields-->
</form> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T03:12:34.617

听起来你想做的是调用 Books Controller，比如 Search 操作。因此，例如，您可能想要调用 /Books/Search/<search expression>/1 或 /Books/Search/<search expression>/2 等（有几种不同的方法可以格式化这些 URL，但它是我认为主要是个人喜好问题）如果您希望 URL 像上面那样显示（没有 URL 中的操作），可以通过路由来完成，如下所示：

```
routes.MapRoute(
    "Books",
    "Books/{searchExpr}/{pageId}",
    new { controller = "Books", action = "Search", searchExpr = "", pageId = 1 }
); 
```

我认为主要问题是您尝试使用 WebForms PostBack 一切范式，在这种情况下您可能最好将信息通过 URL 或查询字符串发送到服务器。您真正要在此处发布表单数据的唯一时间是用户实际在搜索框中键入内容并单击`Search`按钮 - 此时，控制器将通过将搜索表达式填充到 ViewData 中将其传递给适当的视图，从那里，视图可以将其拉出并重新填充结果页面上的该文本框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T02:08:23.433

我从未见过将表单域附加到两个表单的能力，似乎它不起作用。您可以做的是在第二个表单中放置一个隐藏字段，该字段在提交时从第一个表单的文本框中获取信息。

# c - 学习在 Intel/AMD 64 位上用 C 语言预取缓冲区的最佳资源

> ID：245503
> 
> 赞同：9
> 
> 时间：2008-10-29T01:31:35.630
> 
> 标签：c, optimization, sse, prefetch

我有兴趣掌握与预取相关的功能，例如

_mm_prefetch(...)

所以当我执行遍历数组的操作时，内存带宽被充分利用了。学习这方面的最佳资源是什么？

我在英特尔 linux 平台上使用 GCC 4 系列在 C 中完成这项工作。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-29T03:47:42.627

还有一篇由 Ulrich Drepper 撰写的优秀论文，[What Every Programmer Should Know About Memory](http://people.redhat.com/drepper/cpumemory.pdf)。他涵盖了预取，以及处理内存性能优化的许多其他主题。它于 2007 年 11 月发布，与当今的处理器极为相关。如果您正在对非常大的数组执行操作，并且认为您的瓶颈是内存，您应该阅读它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-29T01:56:06.580

该[站点](http://gcc.gnu.org/projects/prefetch.html)包含有关 gcc 预取支持的详细信息，包括预取选项和功能，并包含有关包括 Intel 在内的多种架构的详细信息。gcc[手册](http://gcc.gnu.org/onlinedocs/gcc-4.3.2/gcc/)在 5.46 节中包含有关`__builtin_prefetch`内置函数的详细信息。

# html - 如何在 HTML 文本区域中显示样式

> ID：245507
> 
> 赞同：6
> 
> 时间：2008-10-29T01:33:08.780
> 
> 标签：html, wysiwyg, styles

我正在尝试在 textarea 中添加不同的样式，例如粗体、不同的颜色等

网页中使用的 WYSIWYG 编辑器（例如 tinyMCE）通常会这样做，但我无法弄清楚它们是如何做到的。

你不可以做这个：

[替代文字 http://www.yart.com.au/test/html.gif](http://www.yart.com.au/test/html.gif)

那么他们是如何实现的呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-29T01:48:49.557

通常他们会用自己的显示组件（如 div）覆盖 textarea。当用户输入时，javascript 将获取输入的内容并在显示区域应用样式。textarea 的值是以指定样式呈现它所需的带有 html 标记的文本。如此明显地用户看到了样式化的文本。

这当然是一个简化的解释。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-29T03:53:15.440

欧文的想法是正确的。这些库将 textarea 替换为 iframe，然后将 iframe 的文档置于`designMode`or`contentEditable`模式。这实际上使您可以在 iframe 中编辑 html 文档，而浏览器随后会为您处理光标和所有击键，并为您提供一个可以调用以进行样式更改（粗体、斜体等）的 api。然后，当用户提交表单时，他们会将 iframe 中的 innerHTML 复制到原始文本区域中。有关如何启用此模式以及您可以使用它做什么的更多详细信息，请参阅：[https ://developer.mozilla.org/En/Rich-Text_Editing_in_Mozilla](https://developer.mozilla.org/En/Rich-Text_Editing_in_Mozilla)

但是，如果您希望在您的站点上使用此功能，我对您的建议是使用现有的富文本控件库之一。我之前构建了一个，发现您将花费大量时间来处理浏览器的不一致问题，以便获得运行良好的东西。除了启用编辑功能的方式不同之外，您还需要规范化创建的 html。例如，IE 会`<br>`在用户按下回车键时创建元素，而 FF 会创建`<p>`标签。对于样式更改，IE 使用`<b>`,`<i>`等，而 FF 使用带有样式属性的跨度。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-29T01:50:51.100

我相信 tinymce 专门使用 table/iframe 来显示目的（它被替换为现有的 textarea）。准备好保存后，将所有信息复制回 textarea 进行处理。

# algorithm - 判断两个数组是否具有相同成员的算法

> ID：245509
> 
> 赞同：30
> 
> 时间：2008-10-29T01:33:44.813
> 
> 标签：algorithm

比较两个数组以查看它们是否具有相同成员的最佳算法是什么？

假设没有重复，成员可以按任何顺序排列，并且都没有排序。

```
compare(
    [a, b, c, d],
    [b, a, d, c]
) ==> true

compare(
    [a, b, e],
    [a, b, c]
) ==> false

compare(
    [a, b, c],
    [a, b]
) ==> false 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-29T01:39:26.457

显而易见的答案是：

1.  对两个列表进行排序，然后检查每个元素以查看它们是否相同
2.  将一个数组中的项目添加到哈希表中，然后遍历另一个数组，检查每个项目是否在哈希表中
3.  nickf 的迭代搜索算法

您将使用哪一个取决于您是否可以首先对列表进行排序，以及您是否有一个好的哈希算法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-29T01:39:17.440

您可以将一个加载到哈希表中，跟踪它有多少元素。然后，遍历第二个，检查它的每个元素是否都在哈希表中，并计算它有多少元素。如果第二个数组中的每个元素都在哈希表中，并且两个长度匹配，则它们相同，否则它们不匹配。这应该是 O(N)。

要在存在重复项的情况下进行这项工作，请跟踪每个元素的查看次数。循环第一个数组时递增，循环第二个数组时递减。在第二个数组的循环过程中，如果您在哈希表中找不到某些内容，或者如果计数器已经为零，则它们是不相等的。还要比较总计数。

在存在重复项的情况下可以使用的另一种方法是对两个数组进行排序并进行线性比较。这应该是 O(N*log(N))。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-29T01:52:41.157

假设您不想干扰原始数组和空间是一个考虑因素，另一个 O(n.log(n)) 解决方案比对两个数组进行排序使用更少的空间是：

1.  如果数组大小不同，则返回 FALSE
2.  对第一个数组进行排序——O(n.log(n)) 时间，需要的额外空间是一个数组的大小
3.  对于第二个数组中的每个元素，使用二进制搜索检查它是否在第一个数组的排序副本中 - O(n.log(n)) 时间

如果您使用这种方法，请使用库例程进行二进制搜索。二进制搜索对于手工编码非常容易出错。

[在查看建议字典/集合/哈希查找的解决方案后添加：]

在实践中，我会使用哈希。有几个人断言哈希的 O(1) 行为，导致他们得出结论，基于哈希的解决方案是 O(N)。典型的插入/查找可能接近 O(1)，并且一些散列方案保证最坏情况下的 O(1) 查找，但最坏情况下的插入 - 在构造散列时 - 不是 O(1)。给定任何特定的散列数据结构，都会有一些输入集会产生病态行为。我怀疑存在散列数据结构，其中最坏的情况是 O(N.log(N)) 时间和 O(N) 空间的 [insert-N-elements then lookup-N-elements]。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-17T01:25:08.703

在数组通常不同的情况下，您可以使用签名（对数组成员的交换操作）进一步优化这一点，从而节省`o(n log n)`内存分配。签名可以是布隆过滤器的形式，甚至可以是简单的交换操作，如加法或异或。

一个简单的例子（假设一个 long 作为签名端和 gethashcode 作为一个好的对象标识符；如果对象是整数，那么它们的值是一个更好的标识符；并且一些签名会比 long 大）

```
public bool MatchArrays(object[] array1, object[] array2)
{
   if (array1.length != array2.length)
      return false;
   long signature1 = 0;
   long signature2 = 0;
   for (i=0;i<array1.length;i++) {
       signature1=CommutativeOperation(signature1,array1[i].getHashCode());
       signature2=CommutativeOperation(signature2,array2[i].getHashCode());
   }

   if (signature1 != signature2) 
       return false;

   return MatchArraysTheLongWay(array1, array2);
} 
```

where（使用加法运算；如果需要，使用不同的交换运算，例如布隆过滤器）

```
public long CommutativeOperation(long oldValue, long newElement) {
    return oldValue + newElement;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-17T01:04:08.403

这可以通过不同的方式完成：

1 - 蛮力：对于 array1 中的每个元素，检查该元素是否存在于 array2 中。请注意，这需要记下位置/索引，以便正确处理重复项。这需要 O(n^2) 复杂的代码，根本就不要想它......

2 - 对两个列表进行排序，然后检查每个元素以查看它们是否相同。O(n log n) 用于排序，O(n) 用于检查，所以基本上 O(n log n)，如果弄乱数组不是问题，排序可以就地完成，如果不是，你需要 2n 大小的内存复制排序列表。

3 - 将项目和计数从一个数组添加到哈希表，然后遍历另一个数组，检查每个项目是否在哈希表中，在这种情况下，如果计数不为零，则减少计数，否则将其从哈希表中删除。O(n) 创建一个哈希表，O(n) 检查哈希表中的其他数组项，所以 O(n)。这引入了一个最多具有 n 个元素的内存的哈希表。

4 - Best of Best（以上）：减去或取两个数组相同索引中每个元素的差，最后将减去的值相加。例如 A1={1,2,3}, A2={3,1,2} Diff={-2,1,1} 现在将 Diff = 0 相加，这意味着它们具有相同的整数集。这种方法需要一个没有额外内存的 O(n)。一个 c# 代码如下所示：

```
 public static bool ArrayEqual(int[] list1, int[] list2)
    {
        if (list1 == null || list2 == null)
        {
            throw new Exception("Invalid input");
        }

        if (list1.Length != list2.Length)
        {
            return false;
        }

        int diff = 0;

        for (int i = 0; i < list1.Length; i++)
        {
            diff += list1[i] - list2[i];
        }

        return (diff == 0);
    } 
```

4根本不行，最差

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-08-26T17:27:28.080

如果数组的元素是不同的，则对两个数组的所有元素进行异或（按位异或），如果答案为零，则两个数组具有相同的一组数字。时间复杂度为 O(n)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-29T01:39:46.877

我建议先使用排序并先排序。然后您将比较每个数组的第一个元素，然后是第二个元素，依此类推。

如果您发现不匹配，您可以停止。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-29T01:40:03.320

如果你先对两个数组进行排序，你会得到 O(N log(N))。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-29T02:22:10.880

什么是“最佳”解决方案显然取决于您有什么限制。如果它是一个小数据集，那么排序、散列或蛮力比较（如[nickf](https://stackoverflow.com/questions/245509/algorithm-to-tell-if-two-arrays-have-identical-members#245510)发布的）都将非常相似。因为您知道您正在处理整数值，所以您可以获得 O(n) 排序时间（例如基数排序），并且哈希表也将使用 O(n) 时间。与往常一样，每种方法都有缺点：如果您想节省空间，排序将要求您复制数据或破坏性地对数组进行排序（丢失当前排序）。哈希表显然会产生用于创建哈希表的内存开销。如果你使用 nickf 的方法，你可以用很少甚至没有内存开销来做到这一点，但你必须处理 O(n ² ) 运行时。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-29T02:59:47.870

在这里深水，但是：

**排序列表** 排序可以`O(nlogn)`指出。只是为了澄清一下，有两个列表并不重要，因为：`O(2*nlogn) == O(nlogn)`，然后比较每个元素是另一个 O(n)，因此对两者进行排序然后比较每个元素是 O(n)+O(nlogn)，即：**`O(nlogn)`**

**哈希表：** 将第一个列表转换为哈希表是 O(n) 用于读取 + 存储在哈希表中的成本，我猜可以估计为 O(n)，给出 O(n)。然后你必须检查生成的哈希表中另一个列表中每个元素的存在，这是（至少？）O（n）（假设检查一个元素的存在，哈希表是恒定的）。总而言之，我们最终得到**`O(n)`**了检查。

Java List 接口[将equals 定义](http://java.sun.com/j2se/1.4.2/docs/api/java/util/List.html#equals(java.lang.Object))为每个**对应**的元素都相等。

有趣的是，Java Collection 接口定义[几乎不鼓励实现 equals()](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Collection.html#equals(java.lang.Object))函数。

最后，[每个文档的 Java Set 接口都实现](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Set.html#equals(java.lang.Object))了这种行为。实现应该非常有效，但文档没有提到性能。（没找到源码的链接，可能是严格授权的。自己下载看看。JDK自带的）看源码，HashSet（是Set的常用实现）委托equals () 对 AbstractSet 的实现，它使用 AbstractCollection 的 containsAll() 函数，再次使用 hashSet 中的 contains() 函数。所以 HashSet.equals() 按预期在 O(n) 中运行。（循环遍历所有元素并在哈希表中以恒定时间查找它们。）

如果您知道更好，请编辑以免让我感到尴尬。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-11-11T12:26:35.540

伪代码：

```
A:array
B:array
C:hashtable

if A.length != B.length then return false;

foreach objA in A
{
H = objA;
if H is not found in C.Keys then
C.add(H as key,1 as initial value);
else
C.Val[H as key]++;
}

foreach objB in B
{
H = objB;
if H is not found in C.Keys then
return false;
else
C.Val[H as key]--;
}

if(C contains non-zero value)
return false;
else
return true; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-29T01:43:34.500

最好的方法可能是使用哈希图。由于插入哈希图是 O(1)，从一个数组构建哈希图应该花费 O(n)。然后你有 n 次查找，每一次都需要 O(1)，所以还有另一个 O(n) 操作。总而言之，它是 O(n)。

在蟒蛇中：

```
def comparray(a, b): 
    sa = set(a)
    return len(sa)==len(b) and all(el in sa for el in b) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-29T01:50:28.090

忽略在 C# 中执行此操作的内置方法，您可以执行以下操作：

最好的情况是 O(1)，最坏的情况是 O(N)（每个列表）。

```
public bool MatchArrays(object[] array1, object[] array2)
{
   if (array1.length != array2.length)
      return false;

   bool retValue = true;

   HashTable ht = new HashTable();

   for (int i = 0; i < array1.length; i++)
   {
      ht.Add(array1[i]);
   }

   for (int i = 0; i < array2.length; i++)
   {
      if (ht.Contains(array2[i])
      {
         retValue = false;
         break;
      }
   }

    return retValue;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-29T10:00:28.833

在大多数情况下，在发生冲突时，哈希图是 O(n)，因为它使用链表来存储冲突。但是，有更好的方法，无论如何你几乎不应该发生冲突，因为如果你这样做，哈希图将毫无用处。在所有常规情况下，它只是 O(1)。除此之外，在单个哈希图中不可能有超过 n 次碰撞，因此性能不会那么糟糕；您可以放心地说它是 O(1) 或*几乎是*O(1)，因为 n 太小了，可以忽略不计。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-03-11T21:21:40.707

这是另一种选择，让我知道你们的想法。在最坏的情况下应该是 T(n)=2n*log2n ->O(nLogn)。

```
private boolean compare(List listA, List listB){
    if (listA.size()==0||listA.size()==0) return true;
    List runner = new ArrayList();
    List maxList = listA.size()>listB.size()?listA:listB;
    List minList = listA.size()>listB.size()?listB:listA;
    int macthes = 0;
    List nextList = null;;
    int maxLength = maxList.size();
    for(int i=0;i<maxLength;i++){
        for (int j=0;j<2;j++) {
            nextList = (nextList==null)?maxList:(maxList==nextList)?minList:maList;
            if (i<= nextList.size()) {
                MatchingItem nextItem =new MatchingItem(nextList.get(i),nextList)
                int position = runner.indexOf(nextItem);
                if (position <0){
                    runner.add(nextItem);
                }else{
                    MatchingItem itemInBag = runner.get(position);
                    if (itemInBag.getList != nextList)   matches++;
                    runner.remove(position);
                }
            }
        }
    }
    return maxLength==macthes;
}

public Class MatchingItem{
private Object item;
private List itemList;
public MatchingItem(Object item,List itemList){
    this.item=item
    this.itemList = itemList
}
public boolean equals(object other){
    MatchingItem otheritem = (MatchingItem)other;
    return otheritem.item.equals(this.item) and otheritem.itemlist!=this.itemlist
}

public Object getItem(){ return this.item}
public Object getList(){ return this.itemList} 
```

}

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2008-10-29T01:33:55.877

我想我能想到的最好的是 O(n^2)。

```
function compare($foo, $bar) {
    if (count($foo) != count($bar)) return false;

    foreach ($foo as $f) {
        foreach ($bar as $b) {
            if ($f == $b) {
                // $f exists in $bar, skip to the next $foo
                continue 2;
            }
        }
        return false;
    }
    return true;
} 
```

# windows - 检查文件是否有错误

> ID：245526
> 
> 赞同：2
> 
> 时间：2008-10-29T01:41:29.153
> 
> 标签：windows, filesystems

我有很多不同格式的文件（主要是 pdf 文件），我需要检查它们是否可以正确打开并获取损坏的文件列表。

除了单独打开它们之外，有没有办法找出哪些不会打开/已损坏？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T02:12:39.247

不是真的，不。因为文件类型太多，如果不打开文件就不可能知道文件是否损坏。它可能会毫无错误地打开，但仍然会损坏，因此即使这样也无济于事。您可以尝试像 [KeyView](http://www.autonomy.com/content/Products/idol-modules-keyview-viewing/index.en.html)这样可以打开大多数文件格式的通用文件打开解决方案。如果失败，则文件可能已损坏。

# web - 一个网站如何建立知名度？

> ID：245528
> 
> 赞同：3
> 
> 时间：2008-10-29T01:42:17.997
> 
> 标签：web, popularity, ads

所以，我的问题是人们如何知道他们的网站或博客存在？博主会投资广告吗？只是通过口耳相传吗？还是用谷歌搜索？我只是好奇一个网站是如何建立它的受欢迎程度的。您是否只是将您的网站放在网上并希望人们找到它？我知道您可以使您的网站 SEO 友好，创建站点地图等，但是使用了哪些其他技术？

谢谢，约翰

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-29T03:25:41.313

重要的是，建立一个好的网站！有高质量的相关内容。搜索引擎优化和页面链接将有所帮助。大多数搜索流量来自谷歌恕我直言。我建议 [http://www.google.com/webmasters/start](http://www.google.com/webmasters/start) 提交一个站点地图将在我的待办事项列表中居高不下。还使用相关且独特的页面标题、友好的 url 和相关的 H1 标签

希望有帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T04:24:06.703

我的博客已经运行了大约一年半。我尝试了一些从互联网上阅读的促销技巧或技巧。当然，你可以从其他地方的推广中获得一些活动爆发，但我发现**博客的首要因素就是拥有高质量的内容**。你可以用聪明的 reddit 或 digg 标题欺骗人们访问，但他们永远不会变成重复访问者。有了高质量的帖子，搜索引擎和推荐人的流入将是稳定的。

如果您只是为了知名度或金钱而写博客，并不真正关心发布有价值的内容，它会显示出来，人们不会访问您的网站。我很早就从数量重于质量转变为质量重于数量。毕竟，问问自己：您是否宁愿订阅一个每月一次给您带来精彩阅读的博客，而不是一个让您的读者收件箱充斥着肤浅、强迫帖子的博客？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-29T01:46:39.483

在业余爱好者中，通常的做法是在相关论坛上发表礼貌的声明，当某个主题出现在您在博客或网站上提到的论坛或博客上时，请在回复中包含一个链接。

在专业人士之间，广告，广告，广告。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-29T01:50:06.903

[Hacker News 上的这个帖子](http://news.ycombinator.com/item?id=341138)是一个很好的起点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T02:13:12.893

嗯，这个网站是由 Jeff Atwood 和 Joel Spolsky 创立的（如果我没记错的话），所以他们都在他们的博客上提到了它。然后他们要求那些博客上的人加入测试版。现场版出来的时候，人已经来了。然后……等待口口相传。如果您的网站很棒，他们会来的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-29T03:30:32.957

加入[ASP](http://www.asp-shareware.org/)，阅读并参与他们的论坛……我从他们那里学到了很多东西，并强烈推荐他们。无视政治。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-29T03:59:32.477

我使用 Myspace 作为我自己的免费广告引擎，也许有点不道德，但它起到了作用，直到我的服务器着火了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-29T04:40:22.333

拥有一个用户社区对于拥有一个受欢迎的网站非常重要。通常，您的网站会有某种留言板，用户可以在其中进行互动。拥有大量参考信息来源也很重要。建立网站后，您需要出去推广它。这需要时间，要有耐心，但永远不要放弃推广它。

# php - 管理一个应用的多个专业版本的最佳实践

> ID：245532
> 
> 赞同：3
> 
> 时间：2008-10-29T01:45:25.040
> 
> 标签：php, oop, inheritance, directory-structure

我有一个有很多面孔的 Web 应用程序，到目前为止，我已经通过创建主题来实现它。主题是一组要与通用后端一起使用的 html、css 和图像。

事情是这样布置的：

```
code/
themes/theme1
themes/theme2 
```

Web 应用程序的每个实例都有一个配置文件，说明应该使用哪个主题。例子：

```
theme="theme1" 
```

现在新的业务规则要求我对某些主题进行更改，而这些主题无法通过简单地更改 html/css/images 并需要更改后端来实现。在某些情况下，这些更改需要应用于一组主题。

我想知道如何最好地将它放在磁盘上，以及如何在代码中处理它。我敢肯定，其他人一定遇到了这个问题。

一个想法是：

```
code/common
code/theme1
code/theme2
themes/theme1
themes/theme2 
```

然后让我的通用代码设置首先搜索的`include_path`内容`code/theme1`，然后`code/common`.

然后，如果我想专门说`LogoutPage`类`theme2`，我可以简单地将页面从复制`code/common`到相同的路径下`code/theme2`，它会选择专门的版本。

这个想法的一个问题是会有多个具有相同名称的类。尽管理论上它们永远不会包含在同一个执行中，但我无法扩展原始基类。

那么，如果我要为基类起一个唯一的名称呢？例如`Theme1LogoutPage extends LogoutPage`。我可以预见的一个问题是当一些通用代码（比如 Dispatcher）引用`LogoutPage`. 我可以向调度程序添加条件，但我想知道是否有更透明的方式来处理这个问题？

我能想到的另一个选择是为每个主题维护单独的分支，但我认为这可能需要大量工作。

最后要考虑的一件事是，功能可能源自一个主题，然后需要合并到公共代码库中。

非常感谢任何输入。如果有什么不同，那就是 LAMP 环境。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T02:41:42.620

我没有具体的建议。但是，我强烈建议**不要**走捷径……使用您会觉得很舒服的解决方案来添加第三个主题或明年更改某些内容。
重复是可维护性的敌人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T03:33:16.413

我将研究使用策略模式作为在不同版本的站点中实现不同功能的一种手段。拥有一个工厂，它接受您的配置并基于它提供适当的代码策略。每个策略都可以实现一些通用接口，以便从调用类的角度来看它们是可互换的。这将隔离您的更改以对 Factory 类、Configuration 类以及您需要实现以进行更改的任何新策略类实施新策略。您可以对需要在不同版本之间有所不同的任何用户控件执行相同（或类似）操作。

我将用伪代码进行说明（可能看起来很像 C#）

```
public interface ILogoutStrategy
{
   void Logout();
}

public abstract class AbstractLogoutStrategy : ILogoutStrategy
{
   public virtual void Logout()
   {
      // kill the sesssion
   }
}

public class SingleSiteLogoutStrategy : AbstractLogoutStrategy
{
   public void Logout()
   {
      base.Logout();
      // redirect somewhere
   }
}

public class CentralAuthenticationSystemLogoutStrategy : AbstractLogoutStrategy
{
   public void Logout()
   {
      base.Logout();
      // send a logout request to the CAS
      // redirect somewhere
   }
}

public static class StrategyFactory
{
   public ILogoutStrategy GetLogoutStrategy(Configuration config)
   {
      switch (config.Mode)
      {
         case Mode.CAS:
            return new CentralAuthenticationSystemLogoutStrategy();
            break;
         default:
         case Mode.SingleSite:
           return new SingleSiteLogoutStrategy();
           break;

      }
   }
} 
```

示例用法：

```
ILogoutStrategy logoutStrategy = StrategyFactory.GetLogoutStrategy( config );
logoutStrategy.Logout(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-11T03:02:26.610

您需要的是模板。

然后，您可以将代码与演示文稿分开。

我强烈推荐 smarty 模板。还有 PEAR template_it。

[http://www.smarty.net/](http://www.smarty.net/)

这也使您的代码更易于维护。目的是在您的 php 中没有 html，并且在您的 html 中没有 php。

那么您需要做的就是更改用于每个主题的 html 模板。或模板文件夹。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T04:05:29.737

您在使用母版页吗？如果您需要不同的布局和 UI 内容，您可以为每个实例设置一组不同的母版页。如果您需要自定义行为，那么您可能需要研究依赖注入。Spring.NET 等

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T02:14:52.897

我会做：

[主题名称]/[子文件夹] default/common default/common/html default/common/css red/code red/common red/common/html red/common/css red/code green/common green/common/html

因此，如果代码或任何其他组件不存在，它将回退到默认值。

但实际上我会在 svn 中对网站进行分支，所以如果它发展了通用代码，我可以合并它等等。请参阅 Subversion：[http ://subversion.tigris.org/](http://subversion.tigris.org/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T16:58:02.687

你可以有：/common/code

并且：/站点名称/代码

/common/code 中的所有文件都是抽象类。对于 /common/code 中的每个文件，只需在 /sitename/code 中创建一个相应的非抽象类文件，该文件继承自 /common/code 中的抽象类。

这样，您只需要在 /sitename/code 中实现 CHANGES 其他所有内容都是仅存在于 /common/code 中的核心功能

这里要做的重要事情是确保您只向抽象类添加**公共**方法。这样，所有站点都可以使用这些方法，并且可以相同地处理/处理来自所有站点的类。

# algorithm - 查找两个集合是否相交的算法

> ID：245557
> 
> 赞同：13
> 
> 时间：2008-10-29T01:56:15.800
> 
> 标签：algorithm, language-agnostic

假设我有两个数组：

> int ArrayA[] = {5, 17, 150, 230, 285};
> 
> int ArrayB[] = {7, 11, 57, 110, 230, 250};

两个数组都是排序的，可以是任意大小。我正在寻找一种有效的算法来查找数组之间是否包含任何重复的元素。我只想要一个真/假的答案，我不在乎共享哪个元素或有多少。

天真的解决方案是遍历 ArrayA 中的每个项目，并在 ArrayB 中对其进行[二进制搜索](http://en.wikipedia.org/wiki/Binary_search)。我相信这种复杂性是 O(m * log n)。

因为这两个数组都是排序的，所以似乎应该有一个更有效的算法。

我还想要一个不假设数组包含数字的通用解决方案（即该解决方案也应该适用于字符串）。但是，比较运算符定义明确，并且两个数组都按从小到大排序。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-29T01:59:07.417

假装您正在执行合并排序，但不要将结果发送到任何地方。如果您到达任一来源的尽头，则没有交集。每次比较每个的下一个元素时，如果它们相等，则存在交集。

例如：

```
counterA = 0;
counterB = 0;
for(;;) {
    if(counterA == ArrayA.length || counterB == ArrayB.length)
        return false;
    else if(ArrayA[counterA] == ArrayB[counterB])
        return true;
    else if(ArrayA[counterA] < ArrayB[counterB])
        counterA++;
    else if(ArrayA[counterA] > ArrayB[counterB])
        counterB++;
    else
        halt_and_catch_fire();
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-29T20:08:27.687

因为有人想知道stl。开箱即用的 set_intersection 算法会做的比你想要的更多：它会找到所有的公共值。

```
 #include <vector>
    #include <algorithm>
    #include <iterator>
    using namespace std;
//    ...    
      int ArrayA[] = {5, 17, 150, 230, 285};
      int ArrayB[] = {7, 11, 57, 110, 230, 250};
      vector<int> intersection;
      ThrowWhenWritten output_iterator;
        set_intersection(ArrayA, ArrayA + sizeof(ArrayA)/sizeof(int),
                         ArrayB, ArrayB + sizeof(ArrayB)/sizeof(int),
                         back_insert_iterator<vector<int> >(intersection));

        return !intersection.empty(); 
```

这在 O(m+n) 时间内运行，但它需要存储所有重复项，并且在找到第一个 dup 时不会停止。

现在，从 stl 的 gnu[实现](http://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/)中修改代码，我们可以更准确地得到你想要的。

```
 template<typename InputIterator1, typename InputIterator2>
 bool 
 has_intersection(InputIterator1 first1, InputIterator1 last1,
             InputIterator2 first2, InputIterator2 last2)
    {
       while (first1 != last1 && first2 != last2) 
       {
          if (*first1 < *first2)
             ++first1;
          else if (*first2 < *first1)
             ++first2;
          else
             return true;
       }
       return false;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-31T14:13:59.690

如果一个列表比另一个短得多，那么二分搜索就是要走的路。如果列表的长度相似并且您对 O(m+n) 感到满意，那么标准的“合并”就可以了。有更灵活的更高级的算法。我在自己的搜索中遇到的一篇论文是：

[http://www.cs.uwaterloo.ca/~ajsaling/papers/paper-spire.pdf](http://www.cs.uwaterloo.ca/~ajsaling/papers/paper-spire.pdf)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-29T01:59:30.003

如果您不关心内存消耗，则可以通过使用哈希来获得良好的性能，即使用键 = 一个数组的值创建哈希，并针对该哈希测试第二个数组的值

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T05:18:46.310

如果您使用的是 C# 3.0，那么为什么不在这里利用 LINQ？

```
ArrayA.Intersect(ArrayB).Any() 
```

这不仅是通用的（适用于任何可比较的类型），引擎盖下的实现也非常有效（使用散列算法）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-29T02:02:57.843

如果值的范围很小，您可以为其中一个构建一个查找表（时间成本 = O(N)），然后检查该位是否从另一个列表中设置（时间成本 = O(N)）。如果范围很大，您可以使用哈希表执行类似的操作。

来自 Glomek 的归并排序技巧是一个更好的主意。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-29T02:05:17.263

Glomek 是在正确的轨道上，但有点掩盖了算法。

首先比较 ArrayA[0] 和 ArrayB[0]。如果他们是平等的，你就完成了。如果 ArrayA[0] 小于 ArrayB[0]，则移动到 ArrayA[1]。如果 ArrayA[0] 大于 ArrayB[0]，则移动到 ArrayB[1]。

继续前进，直到到达一个数组的末尾或找到匹配项。

# project-management - 有什么好的类比来解释邪恶问题的概念？

> ID：245565
> 
> 赞同：4
> 
> 时间：2008-10-29T02:00:13.950
> 
> 标签：project-management

大多数开发人员都理解[棘手问题](http://en.wikipedia.org/wiki/Wicked_problem)的概念。在向项目经理解释这个概念时，可以使用什么类比？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-29T02:28:01.477

如果你想要一个类比，我会选择 NASA 的时间线。仍然基于技术，但您不需要任何编码技能即可了解所涉及的困难。我还使用了一个邪恶问题的[编码恐怖](http://www.codinghorror.com/blog/archives/000071.html)定义：

> Horst Rittel 和 Melvin Webber 将“邪恶”问题定义为只有通过解决或解决部分问题才能明确定义的问题。从本质上讲，这个悖论意味着您必须“解决”一次问题以便清楚地定义它，然后再次解决它以创建一个有效的解决方案。

当美国国家航空航天局成立时，他们的任务是让一个人登上月球。我敢肯定，当时他们对如何完成这项任务有想法，但他们无法在一开始就确定第一次登月任务。他们必须开发火箭并找出所有可能出错的灾难性事件。他们必须让轨道器绕地球飞行，然后将宇航员安全带回家。最终他们到达了登上月球的地步，但仍然是回家的问题。

我希望这对您的项目经理来说似乎是一个非编程的邪恶问题。如果不是，我同意格洛梅克。你注定要失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T02:04:27.810

每一个不断变化的需求都会导致无法管理设计。把他送到这里：[温彻斯特神秘屋](http://www.winchestermysteryhouse.com/)。房子里到处都是通往无处可去的楼梯和通向砖墙的门。它完全按照规范构建，但实际上并不是您所说的可用。

当然，在新英格兰，一个“邪恶的问题”需要一个邪恶的优秀工程师想出一个邪恶的聪明解决方案:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T02:20:33.380

有一个由来已久的“试图击中移动目标”的类比

你可以提升到邪恶的水平

```
trying to hit a moving taget that changes shape, 
wears disguises, hides in shadows, recruits minions,
and shoots back 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T02:05:35.360

试着让他们用“我想知道你对这篇文章的想法……”来阅读这篇文章。

确实，您的项目经理应该知道这些东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-29T02:06:12.627

如果你的项目经理没有编程经验，那么你注定要找一个新的工作地点。

如果您的项目经理没有编程经验，并且不愿意将架构决策留给具有一定编程经验的人，那么您就注定要失败，并且非常迫切地需要寻找新的工作场所。

# c# - .net 紧凑型框架 4.0

> ID：245566
> 
> 赞同：9
> 
> 时间：2008-10-29T02:00:58.643
> 
> 标签：c#, .net, compact-framework

它们会是 VS2010 和 .net 4.0 的紧凑框架的新版本吗？如果是，它将包含哪些新功能？WPF？LINQ到SQL？ETC

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-11-11T00:28:23.860

Visual Studio 2010 只支持windows phone 7 的开发。这是一个基于silver light 的框架，它不支持win 表单或本机代码。

VS2010 不能用于开发 Windows Mobile 6.5 或更低版本。

但是，您可以在 VS2010 旁边安装 VS2008。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-17T20:49:32.450

根据我从雷德蒙德的人那里听到的消息，windows mobile 和 nokia（我认为是 symbian）都会有一个移动 silverlight 平台。“silverlight mobile”平台应该建立在紧凑的框架之上，所以它不会是桌面版本的移植。

现在似乎对 Windows Mobile 进行了信息禁运，但我认为一旦 Windows Mobile 7 发布，事情就会变得更加清晰。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-13T10:39:37.463

我不确定紧凑型设备的 4.0（尽管看起来很可能），我也不了解 WPF，但我可以告诉您，他们将为移动设备提供 Silverlight，让您可以访问 WPF 的子集。

还没有找到其他参考...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-27T18:57:59.833

你可以去[这里](https://connect.microsoft.com/VisualStudio/feedback/details/595712/no-support-for-windows-ce-and-compact-framework-development-in-vs2010?wa=wsignin1.0)投票让微软为 Visual Studio 2010 添加 Compact Framework 支持。

**更新**：MS 或多或少地放弃了 Connect 中的现有功能请求。请到新的[用户语音网站投票](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2145313-bring-back-support-for-smart-device-extensions)支持此功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-16T08:33:21.813

有一个非官方的 CF 3.7 版本围绕着 intertubes：

[http://www.google.com/search?q=compact+framework+3.7&rls=com.microsoft:en-us&ie=UTF-8&oe=UTF-8&startIndex=&startPage=1](http://www.google.com/search?q=compact+framework+3.7&rls=com.microsoft:en-us&ie=UTF-8&oe=UTF-8&startIndex=&startPage=1)

似乎有人将其从 ROM 映像中撕下并放入洪流中。

# asp.net - Asp.net MVC 中 QueryString 值的安全性

> ID：245569
> 
> 赞同：5
> 
> 时间：2008-10-29T02:03:05.597
> 
> 标签：asp.net, asp.net-mvc, security, query-string

您如何正确确保用户不会篡改查询字符串值或操作 url 值？例如，您可能在您的 CommentController 上有一个 Delete Comment 操作，该操作采用 CommentID。操作 url 可能看起来像 /Comments/Delete/3 以删除 id 为 3 的评论。

现在显然您不希望任何人能够删除评论 3。通常在评论的所有者或管理员有权这样做。我已经看到这种安全性以不同的方式实施，并且想知道你们中的一些人是如何做到的。

您是否进行多次数据库调用以检索评论并检查评论的作者是否与调用删除操作的用户匹配？

您是否改为将 CommentID 和 UserID 传递给执行删除操作的存储过程并执行 Delete，其中 UserID 和 CommentID 等于传入的值？

加密查询字符串值更好吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-29T02:11:45.003

你没有。

这是编程的基本规则，尤其是在这个时代，*你永远不要相信来自用户、浏览器、客户端等的任何输入。*

除非你真的知道自己在做什么，否则你可能不应该尝试自己实现加密和安全性，这也是编程的一个基本规则。即使你知道你在做什么，你也只会比油炸机领先一步。聪明的人仍然会嘲笑你。

执行额外查询以确保登录用户具有正确的权限集。这将使每个人的生活变得更加简单。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-06-30T21:27:30.040

加密和解密查询参数是一个简单的过程，在 StackOverflow 上有一些很好的例子来说明如何使用 HttpModule 来做到这一点。

“你不要”、“你不能”或“这不容易”在当今时代根本不是可接受的回答......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-19T00:24:50.837

Vyrotek：输入法并不重要。GET、POST、加密/混淆的 GET - 没有真正的区别。无论您的应用程序以何种方式接收命令，要执行管理操作，它必须确保允许发出用户做他想做的事情。权限检查必须在收到命令之后和执行之前进行。否则根本就没有安全感。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-08T23:58:20.247

考虑使用 Stephen Walther 的文章[Tip #46 中概述的技术——不要使用删除链接，因为它们会创建](http://stephenwalther.com/blog/archive/2009/01/21/asp.net-mvc-tip-46-ndash-donrsquot-use-delete-links-because.aspx)使用 [AcceptVerbs(HttpVerbs.Delete)] 的安全漏洞

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T03:24:57.600

您还可以使用 Accept Verbs 属性仅允许 Post 请求删除控制器操作，如下所示。

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Delete(int? id)
{
    //Delete
} 
```

然后，您还可以使用此处讨论的防伪令牌：

[http://blog.codeville.net/2008/09/01/prevent-cross-site-request-forgery-csrf-using-aspnet-mvcs-antiforgerytoken-helper/](http://blog.codeville.net/2008/09/01/prevent-cross-site-request-forgery-csrf-using-aspnet-mvcs-antiforgerytoken-helper/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-29T02:11:38.403

我做了一些时髦的事情，获取查询字符串，压缩它，Base64 或者只是十六进制编码，所以“commentid=4&userid=12345”变成了“code=1a2b23de12769”

它基本上是“通过默默无闻的安全”，但它确实为试图破解网站的人做了很多工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-29T02:12:04.863

你不能轻易做到这一点。

我对使用操作 URL 进行删除的网站有着美好的回忆。

一切都很好，直到他们开始在 Intranet 上进行搜索。

哎呀，再见数据。

我会推荐一个解决方案，您不要将查询字符串用于您不希望编辑的任何内容。

# templates - D 模板：最酷的黑客

> ID：245584
> 
> 赞同：22
> 
> 时间：2008-10-29T02:11:21.493
> 
> 标签：templates, metaprogramming, d

你用 D 编程语言做过或见过的最酷的**、实用的元编程技巧是什么？**有点实用意味着排除，例如，编译时光线追踪器。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-04T18:45:54.193

[任意精度类型](http://www.dsource.org/projects/scrapple/wiki/BigNum)它在编译时生成 ASM 代码（在编译器之前）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-29T17:40:25.737

Scrapple 工具中的 DParse 是一个模板化的解析器生成器。然而，ldc 是唯一一个具有正常运行的编译时 GC 的 D 编译器（但即便如此，它也有一些奇怪的随机崩溃）。我玩了一点，你可以做一些有趣的事情，比如配置文件解析和其他东西，但是在编译时 GC 完全运行之前你不能做大事。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-01T10:44:28.443

在最酷的方面，我不得不说 Kirk McDonald 的[PyD](http://pyd.dsource.org/ "PyD")（和其他类似的绑定），因为它们在检测和处理许多不同的类型以及复杂的代码生成方面做了大量的工作。

也就是说，PyD 之所以获胜，是因为[BLADE](http://www.digitalmars.com/d/archives/digitalmars/D/BLADE_0.2Alpha_Vector_operations_with_mixins_expression_templates_51617.html)在技术上使用的是 CTFE，而不是模板。

就个人而言，D 模板已在我的一个研究项目中得到广泛使用。这是一个模拟框架，模块可以在其中定义自己的私有数据类型。向框架公开一个新的用户类型需要一行代码，它为该类型以及相关的网络序列化/反序列化代码创建一个 XML 解析器。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-29T03:49:23.527

[D/Objective-C 桥](http://michelf.com/projects/d-objc-bridge/)使用模板让您在 D 中操作 Cocoa 对象。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-29T17:51:21.223

我最喜欢的是来自 tools.base 的 ElemType 和 KeyType：

```
template ElemType(T) {
  alias typeof((function() {
    foreach (elem; Init!(T)) return elem; assert(false);
  })()) ElemType;
}

template KeyType(T) {
  alias typeof((function() {
    foreach (key, elem; Init!(T)) return key; assert(false);
  })()) KeyType;
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-30T15:00:21.037

[编译时字符串散列](http://www.digitalmars.com/d/2.0/templates-revisited.html)。您可以使用它来混淆代码中的嵌入字符串。只需搜索“哈希”。该页面上还有很多其他有趣的示例。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-11-04T18:44:15.803

一个[统一类型的模板结构](http://www.dsource.org/projects/scrapple/browser/trunk/units)（它不会让你犯单元错误。）

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-01-04T14:00:34.453

一个例子是D 标准库中的[位域工具，它为从用户指定的布局开始的位域操作生成代码。](http://dlang.org/phobos/std_bitmanip.html)

[Tuple 设施](http://dlang.org/phobos/std_typecons.html)是另一个例子。它根据用户提供的类型和可选名称生成一个元组。除了注入命名字段之外，没有很多生成性的umph，但我认为这是一个说明性的例子。

在不知道 Lambert 的漏洞利用的情况下，我只是将 memoize 添加到标准库中 - 请参阅[此处](http://dlang.org/phobos/std_functional.html#.memoize)的文档，[此处](http://www.dsource.org/projects/phobos/changeset/2271)的代码，以及相关[的](http://web.archive.org/liveweb/http://forum.dlang.org/thread/ifu70u$2dvs$1@digitalmars.com)新闻组讨论。

我研究的另一个工具是一个高阶函数，它将积分或实值函数制成表格（例如提供快速指数）。那还没有准备好发布。

一旦在编译期间允许创建对象，将很容易创建例如在编译期间执行所有自动机生成的正则表达式引擎。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2010-02-09T03:49:41.273

我会回答我自己的问题，因为当我问这个问题时，这个问题并不存在。我为垃圾收集器写了一个补丁，它使用模板和编译时自省来为任意复杂的用户定义类型生成指针偏移信息，以允许精确的堆扫描，而不是在编译器中完成。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2010-12-14T09:51:34.870

我写了一个 memoize() 函数，它的头是这样的（代码有点长，粘贴在这里）：

自动记忆（TFunc）（TFunc func）；

它的作用是，你给它一个函数的地址，它返回一个强类型的委托（与原始函数相同的签名和返回类型）缓存原始函数的返回值，以便使用相同的参数调用它两次只调用底层函数一次。例如，这是一个以线性而非指数时间执行的斐波那契数列的记忆化“递归”定义：

uint fib(uint n) { 返回 n > 0 ？n > 1 ? 记忆（&fib）（n - 1）+记忆（&fib）（n - 2）：1：0；}

可以正常调用，如：fib(1000);

* * *

编辑：我发布的前一个代码的链接相当可怕；[这个版本要优雅得多](http://gist.github.com/741782#file_memoize.d)。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-01-04T15:52:22.490

[用于从Stream](http://www.digitalmars.com/d/1.0/phobos/std_stream.html)对象读取和写入简单结构的Mixins：

```
template TStructReader() {
        private alias typeof(*this) T;
        static T opCall(Stream stream) {
                assert(stream.readable);
                T ret; stream.readExact(&ret, T.sizeof);
                return ret;
        }
}

template TStructWriter() {
        private alias typeof(*this) T;
        void write(Stream stream) {
                assert(stream.writeable);
                stream.writeExact(this, T.sizeof);
        }
} 
```

像这样使用它：

```
align (1) struct MyStruct {
        ... definitions here ...
        mixin TStructReader;
        mixin TStructWriter;
}

auto ms = MyStruct(stream);
ms.write(stream); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-02-03T09:53:51.297

[LuaD](https://github.com/JakobOvrum/LuaD)还广泛使用元编程与 Lua 无缝交互。您可以使用单个命令注册整个类。

# sql - 为什么在 DB2 中可以有一个名为 ORDER 的列？

> ID：245592
> 
> 赞同：0
> 
> 时间：2008-10-29T02:16:04.497
> 
> 标签：sql, database, db2

在 DB2 中，您可以将列命名为 ORDER 并编写如下 SQL

```
SELECT ORDER FROM tblWHATEVER ORDER BY ORDER 
```

甚至不需要在列名周围放置任何特殊字符。这让我感到痛苦，我不会进入，但我的问题是：为什么数据库允许对对象名称使用 SQL 关键字？当然，不允许这样做会更有意义吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-29T16:19:23.827

我在很大程度上同意不应允许关键字作为标识符的观点。大多数现代计算语言都有 20 或 30 个关键字，在这种情况下，暂停将它们用作标识符是完全合理的。不幸的是，SQL 来自旧的 COBOL 语言学校（“计算语言应尽可能与英语相似”）。因此，SQL（如 COBOL）有数百[个关键字](http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/topic/com.ibm.db2.luw.sql.ref.doc/doc/r0001095.html)。

我不记得 SQL 标准是否说明了是否*必须*允许保留字作为标识符，但考虑到广泛的（过多的！）词汇，几个 SQL 实现允许它并不奇怪。

话虽如此，使用关键字作为标识符并不像 SQL 中引用标识符的整个概念那样愚蠢（而且这些不是 DB2 特定的）。允许区分大小写的标识符是一回事，但带引号的标识符允许各种废话，包括空格、变音符号以及在某些实现中（是的，包括 DB2），控制字符！试试下面的例子：

```
创建表“我的
表”（一个整数非空）；

```

是的，这是标识符中间的换行符以及末尾的 e-acute ......（这导致了对数据库元数据使用什么编码以及因此非 Unicode 数据库是否允许的有趣猜测，比如说，包含日文列名的表定义）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T02:19:58.700

许多 SQL 解析器（尤其是我使用的 DB2/z）比某些有时完全分离词法和语义分析的常规解析器更智能（这种分离主要是一件好事）。

SQL 解析器可以根据上下文确定关键字是否有效或应被视为标识符。

因此，您可以获得称为 ORDER 或 GROUP 或 DATE 的列（这是一个特别常见的列）。

当一些语法着色编辑器用关键字颜色标记标识符时，它确实让我很恼火。他们的解析器不像 DB2 中的解析器那么“聪明”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T02:20:47.153

因为对象名称是...*名称*。所有数据库系统都允许您使用带引号的名称来防止您遇到麻烦。

如果您遇到问题，问题不在于允许对象名称为*names*的做法，而在于错误的实现，或者错误的代码库不会自动引用所有内容或无法根据需要引用名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-29T16:36:57.410

有趣的是，您也可以在 SqlServer 中使用关键字作为字段名称。您需要在字段名称中使用括号的唯一区别

所以你可以做类似的事情

```
create table [order](
id int,
[order] varchar(50) ) 
```

进而 ：）

```
select 
    [order] 
from 
    [order]
order by [order] 
```

这当然是一个极端的例子，但至少使用括号你可以看到 [order] 不是关键字。

我会看到人们使用已经被关键字保留的名称的原因是当列名或表名与数据表示之间存在直接映射时。你可以称之为懒惰或方便。

# .net - 在 ASP.NET 中向下钻取图表

> ID：245597
> 
> 赞同：2
> 
> 时间：2008-10-29T02:20:43.333
> 
> 标签：.net, charts

我正在尝试在（VB）ASP.NET 项目中运行一组报告，作为其中的一部分，我想显示一些可视化数据的图表。我能够生成图表，并在不同时间使用过 Flotr、Plotr、Google Charts 和一些 CSS 技术，因为我已经对此进行了实验。

理想情况下，我想要实现的是使单个元素（饼图中的切片或条形图中的条形）可单击，以便使用该父元素作为过滤器深入到较低级别的数据。我见过的最接近的是一些关于使用 ReportViewer 控件执行此操作的教程，但仅通过文本元素进行链接，我已经自己实现了这一点。

这是我必须求助于 Flash 的事情吗，因为我宁愿尽可能避免这种情况。如果这是唯一的解决方案，那么我可能需要接受它。

值得一提的是，所有数据都存储在数据库中，因此任何图表生成都是动态完成的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T02:22:42.127

一个可点击的图像地图可能会成功......

...或者你可以买 Dundas

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T04:25:55.357

如果您自己构建，我同意图像映射的想法。

如果您希望它开箱即用，[Dundas Charts](http://www.dundas.com)和可能其他一些优秀的图表工具都支持这种类型的向下钻取功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T02:47:28.020

看看 jqChart，一个 jQuery 插件——你可以用这个插件做什么似乎没有任何非创造性的限制：

[http://plugins.jquery.com/project/jQchart](http://plugins.jquery.com/project/jQchart)

# c - 使用单个 system() 调用在 C 中执行多个命令

> ID：245600
> 
> 赞同：8
> 
> 时间：2008-10-29T02:21:41.457
> 
> 标签：c, security, system, exploit

在我正在从事的信息安全实验室中，我的任务是通过一次调用“system()”（用 C 语言编写，在 Fedora 上运行）执行多个命令。什么语法可以让我通过 system() 执行更多命令？（如果程序通过 system() 调用与操作系统交互，那么您可以通过在远程计算机上运行的程序执行任意命令。）

IE：

```
char command[] = "????? \r\n"; 
system(command); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-29T02:27:30.277

这取决于调用 shell 来执行命令，但通常大多数 shell 用于`;`分隔命令，所以这样的东西应该可以工作：

```
command1; command2; command3 
```

[编辑]

正如@dicroce 提到的，您可以使用which`&&`代替`;`which 将在第一个返回非零值的命令处停止执行。这可能需要也可能不需要（并且某些命令可能在成功时返回非零值），但是如果您尝试处理可能失败的命令，您可能不应该在 system() 调用中将多个命令串在一起，因为您没有任何确定故障发生位置的方法。在这种情况下，您最好的选择是一次执行一个命令，或者创建一个 shell 脚本来执行适当的错误处理并调用它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-29T02:47:13.217

在命令之间使用 &&。它的优点是它只继续执行命令，只要它们返回成功的错误代码。例子：

“cd /proc && cat cpuinfo”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T02:28:01.337

一种可能性立即浮现在脑海中。您可以将所有命令写入脚本，然后使用以下命令运行它：

```
system ("cmd.exe /c \"x.cmd\""); 
```

或者，现在我注意到您正在 Fedora 上运行：

```
system ("x.sh"); 
```

# c# - C# 4.0 中如何实现泛型协方差和逆变换？

> ID：245607
> 
> 赞同：108
> 
> 时间：2008-10-29T02:27:19.323
> 
> 标签：c#, c#-4.0, covariance, contravariance, generic-variance

我没有参加 PDC 2008，但我听说 C# 4.0 宣布支持通用协变和逆变换的消息。也就是说，`List<string>`可以分配给`List<object>`。怎么可能？

在 Jon Skeet 的***C# in Depth***一书中，解释了为什么 C# 泛型不支持协变和逆变。它主要用于编写安全代码。现在，C# 4.0 更改为支持它们。会不会带来混乱？

有人知道有关 C# 4.0 的详细信息可以给出一些解释吗？

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2008-10-29T08:16:55.220

仅以*安全*的方式支持 Variance - 事实上，使用 CLR 已有的功能。因此，我在书中给出的尝试将 a`List<Banana>`用作`List<Fruit>`（或其他任何东西）的示例仍然不起作用 - 但其他一些场景会起作用。

首先，它只支持接口和委托。

其次，它要求接口/委托的作者将类型参数装饰为`in`（用于逆变）或`out`（用于协变）。最明显的例子是`IEnumerable<T>`它只允许你从其中“取出”值——它不允许你添加新的值。那会变成`IEnumerable<out T>`. 这根本不会损害类型安全，但可以让您`IEnumerable<string>`从声明为返回的方法中返回一个`IEnumerable<object>`例如。

逆变很难给出使用接口的具体示例，但使用委托很容易。考虑一下`Action<T>`- 这只是表示一个带有`T`参数的方法。能够无缝转换使用 an `Action<object>`as an会很好`Action<string>`- 任何采用`object`参数的方法在使用 a 时都会很好`string`。当然，C# 2 已经在某种程度上具有委托的协变和逆变，但是通过从一种委托类型到另一种委托类型的实际转换（创建一个新实例） - 参见 P141-144 示例。C# 4 将使这更通用，并且（我相信）将避免为转换创建新实例。（这将是一个参考转换。）

希望这能澄清一点 - 如果它没有意义，请告诉我！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-04-16T16:24:07.770

并不是说 Jon 还没有介绍过它，但这里有一些指向 Eric Lippert 的博客和视频的链接。他用例子很好地解释了它。

[https://blogs.msdn.microsoft.com/ericlippert/2007/10/16/covariance-and-contravariance-in-c-part-one/](https://blogs.msdn.microsoft.com/ericlippert/2007/10/16/covariance-and-contravariance-in-c-part-one/)

视频：

[https://www.youtube.com/watch?v=3MQDrKbzvqU](https://www.youtube.com/watch?v=3MQDrKbzvqU)

[https://www.youtube.com/watch?v=XRIadQaBYlI](https://www.youtube.com/watch?v=XRIadQaBYlI)

[https://www.youtube.com/watch?v=St9d2EDZfrg](https://www.youtube.com/watch?v=St9d2EDZfrg)

# sql-server - 如何处理@p LINQtoSQL 参数？无论如何，@p 是什么？

> ID：245614
> 
> 赞同：1
> 
> 时间：2008-10-29T02:36:47.590
> 
> 标签：sql-server, asp.net-mvc, linq-to-sql

好的，仍然在我的 Asp.net MVC 应用程序中做一些 SqlCacheDependecy

我从 Microsoft 获得了这段代码来缓存 LINQtoSQL，基本上它的作用是从 LINQ 查询中获取 SqlCommand 文本并通过 SqlDependecy 需要的 System.Data.SqlClient.SqlCommand 执行该文本......

但是，这有一个小问题，那就是每当您在 LINQ 中执行 where 子句时，生成的 SQL 就像这样

```
SELECT [t0].[MemberID], [t0].[Aspnetusername], [t0].[Aspnetpassword], [t0].[EmailAddr], [t0].[DateCreated], [t0].[Location], [t0].[DaimokuGoal], [t0].[PreviewImageID], [t0].[LastDaimoku] AS [LastDaimoku], [t0].[LastNotefied] AS [LastNotefied], [t0].[LastActivityDate] AS [LastActivityDate], [t0].[IsActivated]
FROM [dbo].[Members] AS [t0]
INNER JOIN [dbo].[MemberStats] AS [t1] ON [t0].[MemberID] = [t1].[MemberID]
WHERE [t1].[TotalDeterminations] > @p0 
```

注意 where [t1].[TotalDeterminations] > @p0，SqlCommand 对我大喊大叫，因为它要我声明一个 @p0 的标量变量......显然我不能

那么提供此代码来缓存 Linq 查询的微软到底是如何期望人们使用 where 子句的呢？有人对此有任何想法吗？

**编辑**加上当只是像正常一样执行LINQ时，SQL到底是如何知道@p是什么，上面的查询是什么被传递到数据库中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T03:07:16.390

`@something`是一个 SQL 参数，.NET 通过添加到 SqlCommand 对象的 SqlParameter 集合来处理它。

您可以使用任何名称创建参数，Linq to SQL 只是生成它们 named `p#`，其中`#`表示其在集合中的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T02:50:43.583

为什么不能在将 SqlParameter 对象添加到 SqlDependecy 之前将它们添加到 SqlCommand 对象的 Parameters 集合中？

# c++ - 如何在构造函数中初始化 char 数组样式字符串

> ID：245619
> 
> 赞同：2
> 
> 时间：2008-10-29T02:39:39.487
> 
> 标签：c++, arrays, string

我有一个类，我正在序列化它以通过 unix 套接字发送，它必须有一个字符串，我存储为一个 char 数组。我可以在构造函数中以不同于我在这里的方式对其进行初始化吗？

```
typedef struct SerialFunctionStatus_t {
    SerialFunctionStatus_t() 
        : serial_rx_count(0), serial_tx_count(0), socket_rx_count(0), socket_tx_count(0) 
        { port[0] = '\0'; }
    uint32_t serial_rx_count;
    uint32_t serial_tx_count;
    uint32_t socket_rx_count;
    uint32_t socket_tx_count;
    char port[20];
} SerialFunctionStatus_t; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-29T02:43:51.617

放入`port()`初始化列表。这会导致端口被“值初始化”（12.6.2），这对于内置数组意味着零初始化（8.5）。

# build-process - 在 scons 中检测 CPU 架构（32 位 / 64 位）？

> ID：245624
> 
> 赞同：4
> 
> 时间：2008-10-29T02:43:42.380
> 
> 标签：build-process, scons, cpu-architecture

是否有任何“标准”插件可用于检测**scons**中的 CPU 架构？

顺便说一句，这个问题已经[在这里](https://stackoverflow.com/questions/152016/detecting-cpu-architecture-compile-time)以更一般的形式提出......只是想知道是否有人已经花时间将这些信息合并到 scons 中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T11:00:33.677

使用**i386**相当依赖于编译器，并且不会检测到非 x86 32 位拱门。假设 scons 使用的 python 解释器在您感兴趣的 CPU 上运行（并非总是如此 - 考虑交叉编译），您可以只使用 python 本身。

```
import platform
print platform.machine()
print platform.architecture() 
```

如果您需要更复杂的东西，那么也许您将不得不编写自己的配置函数 - 但直接在代码中处理它可能会更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T00:08:48.253

像这样的东西？

```
env = Environment()
conf = Configure(env)
if conf.CheckDeclaration("__i386__"):
    conf.Define("MY_ARCH", "blahblablah")
env = conf.Finish() 
```

# c++ - C++二叉搜索树递归搜索函数

> ID：245628
> 
> 赞同：2
> 
> 时间：2008-10-29T02:44:52.037
> 
> 标签：c++, binary-search-tree

```
template <class T>
bool BST<T>::search(const T& x, int& len) const
{
    return search(BT<T>::root, x);
}

template <class T>
bool BST<T>::search(struct Node<T>*& root, const T& x)
{
   if (root == NULL)
       return false;
   else
      {
         if (root->data == x)
             return true;
         else if(root->data < x)
             search(root->left, x);
         else 
             search(root->right, x);                 
      }             
} 
```

所以这是我对带有 T 节点的 BST 类的搜索功能。x 是在树中搜索的数据，len 只是它必须经过的节点数量才能找到匹配节点（如果存在）。我还没有实现这一点，我只是在逐步发展我的任务。我通过这样做来调用它：

```
if(t.search(v[1], len) == true)
       cout << endl << "true"; 
```

v 只是我必须创建的一个向量来比较它，所以这只是为它提供一个 int。我得到的错误：

```
BST.h: In member function âbool BST<T>::search(const T&, int&) const [with T = int]â:
prog5.cc:24:   instantiated from here    
BST.h:78: error: no matching function for call to âBST<int>::search(Node<int>* const&, const int&) constâ    
BST.h:76: note: candidates are: bool BST<T>::search(const T&, int&) const [with T = int]
BST.h:83: note:                 bool BST<T>::search(Node<T>*&, const T&) [with T = int] 
```

所以我不确定我做错了什么或哪里做错了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T02:49:38.763

好的，`bool BST<T>::search(struct Node<T>*& root, const T& x)`应该像这样在它之后有 const：`bool BST<T>::search(struct Node<T>*& root, const T& x) const`。基本上，您已经从 const 函数调用了非常量函数，这是一个禁忌。

顺便说一句，这对我来说看起来很可疑“ `struct Node<T>*&`”......我可能会放弃 & 并使用`Node<T>*`......但也许你需要它，因为*struct*？

此外，这是 C++，没有理由将 Node 作为结构体......需要在参数定义中包含**结构体**看起来很糟糕，恕我直言。为什么不让 Node 成为一个类？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-31T20:18:03.623

您的搜索代码存在多个问题：

*   排序顺序是倒序的，如果节点数据比你搜索的少，你应该在右分支中搜索，而不是左分支。

*   您应该返回递归调用的结果

*   也不清楚你为什么`root`通过引用传递。它应该作为`const`合格的指针传递，并且方法体也应该是`const`合格的。

这是一个替代方案：

```
template <class T>
bool BST<T>::search(const struct Node<T> *root, const T& x) const {
    if (root == NULL)
        return false;
    else
    if (root->data == x)
        return true;
    else
    if (root->data < x)
        return search(root->right, x);
    else 
        return search(root->left, x);
} 
```

这是一个更简单的非递归实现：

```
template <class T>
bool BST<T>::search(const struct Node<T> *root, const T& x) const {
    while (root != NULL) {
        if (root->data == x)
            return true;
        if (root->data < x)
            root = root->right;
        else 
            root = root->left;
    }
    return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-05T18:30:25.133

**算法 ：**

1.  取节点值数据；
2.  重复第 3 步到第 5 步，直到找到值或超出树。
3.  如果数据等于根节点值，则搜索成功并终止算法。
4.  如果数据小于根节点值，我们必须搜索左子树。
5.  否则数据小于根节点值，我们必须搜索左子树。
6.  输出打印消息“找到”或“未找到”。

* * *

## C++ 实现

```
 node* search(node* root, int data)
    {
     if (root==NULL || root->data==data) return root;

     if (root->data < data)   return search(root->right, data);

     return search(root->left, data);
   } 
```

# ajax - 在 OFBiz 中使用 Prototype.js 的 Ajax

> ID：245634
> 
> 赞同：3
> 
> 时间：2008-10-29T02:48:18.720
> 
> 标签：ajax, prototypejs, ofbiz

我需要在 OFBiz 框架内使用`prototype.js`. 我正在从一个`.ftl`文件中做到这一点。我对如何处理服务器端感到困惑 - 通过 Java 事件或 Java 服务？最佳做法是什么？而且我在让框架识别`prototype.js`文件时遇到问题。脚本标签中的路径名存在一些问题。根据 OFBiz 框架标准，它必须是一些特殊的命名。

我搜索了谷歌，但我只找到了关于如何使用原型的链接，但没有找到关于原型 + OFBiz 组合的链接。如果有人在 OFBiz 做过这样的事情，请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T20:22:10.843

服务器像处理任何其他请求一样处理 AJAX 请求。它可能包含或不包含事件，并且您的 js 函数将获得的响应是​​ HTML 输出（如果响应是视图）。如果要使用 JSON，则必须使用`type="jsonservice"`( 并且必须在控制器文件中包含 jsonservice 处理程序 ) 创建一个事件。通过这种方式，您可以使用 AJAX 发送和接收数据结构。

# grails - 如何解析、持久化和检索带有空格分隔的标签的字符串？

> ID：245654
> 
> 赞同：3
> 
> 时间：2008-10-29T03:01:18.103
> 
> 标签：grails, groovy, tags, tokenize

我的数据库由 3 个表组成（一个用于存储所有项目，一个用于标签，一个用于两者之间的关系）：

表：帖子列：PostID、名称、描述

表：标签列：标签 ID、名称

表：PostTag 列：PostID、TagID

将空格分隔的字符串（例如“smart funny wonderful”）保存到上面显示的 3 个数据库表中的最佳方法是什么？

最终，我还需要检索标签并将其再次显示为字符串。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-29T21:28:22.017

大致是这样的：

```
class Post {
    static hasMany [tags:Tag]
}

class Tag {
    static belongsTo = Post
    static hasMany [posts:Post]
}

class someService {

    def createPostWithTags(name, desc, tags) {      
        def post = new Post(name: name, desc: desc).save()
        tags.split(' ').each { tagName ->
            def tag = Tag.findByName(tag) ?: new Tag(name: tagName)
            post.addToTags(tag).save()
        }       
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T04:06:05.757

如果你有一个标签表，你不是每个标签都有一行吗？

```
tag.id = 1; tag.name = 'smart'
tag.id = 2; tag.name = 'funny'
tag.id = 3; tag.name = 'wonderful' 
```

在 Groovy/Grails 中，您可以将它们作为一个列表来检索，可能会将它们连接到一个空格分隔的列表中以供显示。

除非我真的误解了这个问题，否则 Groovy/Grails/GORM 将使用默认脚手架处理这个问题，只需很少或没有代码，不需要真正的编码。

# graphics - JavaFX 中的 2D Cel-Shading

> ID：245655
> 
> 赞同：0
> 
> 时间：2008-10-29T03:02:41.250
> 
> 标签：graphics, javafx

我正在用 JavaFX 编写一个非常简单的 2D 游戏，虽然目前它只是预览版，但我希望尝试在我的游戏对象上实现（甚至基本上）某种 Cel-Shading。

有谁知道是否有我可以使用的 cel-shading 的参考实现，或者在这个领域给我一些建议？

我想它不必是特定于 JavaFX 的，但这会有所帮助。

我在图形编程方面没有太多经验，但是，我是一位经验丰富的 java/c# 程序员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T12:27:24.990

对我来说，2D 和 cel-shading 是反义词…… [Cel-shading](http://en.wikipedia.org/wiki/Cel-shaded_animation "Cel 着色动画 - 维基百科，免费的百科全书")是一种 3D 技术，看起来像 2D，所以这种技术在 2D 图形中没有位置。

如果我错了，或者你的意思是别的，那就大喊大叫吧！:-)

# vb.net - Not keyword vs = False 在检查 false 布尔条件时

> ID：245666
> 
> 赞同：12
> 
> 时间：2008-10-29T03:08:21.783
> 
> 标签：vb.net

当我使用 If 语句并且我想检查布尔值是否为假时，我应该使用“Not”关键字还是 = false，就像这样

```
If (Not myboolean) then 
```

对比

```
If (myboolean = False) then 
```

哪个是更好的实践和更具可读性？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-29T03:11:02.823

当然，使用“不”。而对于交替，使用“If (myboolean)”而不是“If (myboolean = true)”

如果你给布尔值一个可读的名字，效果最好：

```
 if (node.HasChildren) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-29T03:10:49.533

由于两种风格之间没有功能差异，因此这只是归结为个人喜好的事情之一。

如果您正在使用已经设定标准的代码库，那么请坚持下去。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-29T05:27:17.200

使用`True`and`False`设置变量，而不是测试它们*。*如其他答案中所述，这提高了可读性，但它也提高了可移植性，特别是在不遵循最佳实践的情况下。

某些语言允许您交换`bool`整数类型。考虑一个人为的例子：

```
int differentInts(int i, int j)
{
   返回 ij；// 如果 int 不同，则返回非零 (true)。
}

. . .
如果（不同的整数（4, 8）== 真）
   printf("四和八不一样！\n");
别的
   printf("四和八相等！\n");

```

可怕的风格，但我见过更糟糕的潜入生产。当然，在*别人*的手表上。:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-29T03:53:01.803

！（健康）状况

在 C 和 pre-STL C++ 中，“！condition”意味着条件评估为假真值，而“condition == FALSE”意味着条件值必须等于系统设计为 FALSE 的值。由于不同的实现以不同的方式定义它，因此使用 !condition 被认为是更好的做法。

更新：正如评论中指出的那样——FALSE 总是 0，它是 TRUE 可能很危险。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T04:36:26.473

绝对使用“不”，考虑大声朗读。

如果你大声朗读：

If X is false Then Do Y Do Y

相对

如果不是 X 那么做 Y

我想你会发现“非”路线更自然。特别是如果您选择好的变量名或函数。

Code Complete 对变量名有一些很好的规则。 [http://cc2e.com/Page.aspx?hid=225](http://cc2e.com/Page.aspx?hid=225)（可能需要登录）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-09T10:34:00.863

除了共识，当同时存在真例和假例时，请使用

```
if (condition)
    // true case
else
    // false case 
```

而不是

```
if (not condition)
    // false case
else
    // true case 
```

（但是我永远不确定python`x is not None`是真还是假。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-09T11:37:21.720

别的东西：省略括号，它们在 VB 中是多余的，因此构成语法垃圾。

另外，我对有多少人通过用其他语言提供技术示例而争论不休，而这些示例根本*不适*用于 VB。`If Not x` 在 VB 中，使用not 的唯一原因`If x = False`是可读性和逻辑性。并不是说你需要其他理由。

完全不同的原因适用于 C(++)，是的。由于存在真正以不同方式处理此问题的框架，因此更是如此。但是在VB的上下文中*具有误导性！*

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-07-11T15:52:02.973

只要您只处理 VB 就没有任何区别，但是如果您碰巧使用诸如 Win32 API 之类的 C 函数，则绝对不要在测试 false 时使用“NOT”而只使用“==False”，而是在测试时对于 true，不要使用“==True”，而是使用“if(function())”。

原因是 C 和 VB 在定义布尔值方面的差异。

1.  在 C 中为 true == 1 而在 VB 中为 true == -1（因此您不应将 C 函数的输出与 true 进行比较，因为您正在尝试将 -1 与 1 进行比较）

2.  Not in Vb 是按位 NOT（等于 C 的 ~ 运算符而不是 ! 运算符），因此它否定每个位，结果否定 1（在 C 中为真）将导致一个非零值，这是真的，不仅适用于 -1 的 VB true （根据二进制补码规则 [111111111] 的位格式全为 1）并且否定所有位 [0000000000] 等于零。

为了更好地理解，请参阅我[对 C# 是否有 VB.net 等价物的回答！操作员？](https://stackoverflow.com/questions/279208/is-there-a-vb-net-equivalent-for-cs-operator/17580187#17580187)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-08-26T19:14:25.930

在 vb 2010/12 中与这些行有所不同 在顶行中，必须关闭 Option Strict。

```
If InStr(strLine, "=") = False Then _
If Not CBool(InStr(strLine, "=")) Then 
```

感谢您为我回答问题。（我在学）

# lisp - 您使用过 Scheme 宏的一些事情是什么？

> ID：245677
> 
> 赞同：13
> 
> 时间：2008-10-29T03:12:28.827
> 
> 标签：lisp, scheme, macros, racket

宏的许多示例似乎是关于隐藏 lambda，例如 CL 中的 with-open-file。我正在寻找宏的一些更奇特的用途，特别是在 PLT 方案中。我想了解何时考虑使用宏与使用函数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-04T18:56:56.263

需要宏来实现新的控制结构和新的绑定结构。

[因此，在http://planet.plt-scheme.org](http://planet.plt-scheme.org)上寻找这些类型的结构。在 PLaneT，您既可以浏览文档也可以浏览代码。

新控制结构的示例：

[http://planet.plt-scheme.org/package-source/soegaard/control.plt/2/0/planet-docs/manual/index.html](http://planet.plt-scheme.org/package-source/soegaard/control.plt/2/0/planet-docs/manual/index.html)

要查找新绑定形式的示例，请查找以“with-”开头的宏。在 PLaneT 的 math.plt 中也可以找到一个有用的示例。

```
 ; Within a (with-modulus n form1 ...) the return values of
  ; the arithmetival operations +, -, * and ^ are automatically
  ; reduced modulo n. Furthermore (mod x)=(modulo x n) and
  ; (inv x)=(inverse x n).

  ; Example: (with-modulus 3 (^ 2 4)) ==> 1

  (define-syntax (with-modulus stx)
    (syntax-case stx ()
      [(with-modulus e form ...)
       (with-syntax ([+   (datum->syntax-object (syntax with-modulus) '+)]
                     [-   (datum->syntax-object (syntax with-modulus) '-)]
                     [*   (datum->syntax-object (syntax with-modulus) '*)]
                     [^   (datum->syntax-object (syntax with-modulus) '^)]
                     [mod (datum->syntax-object (syntax with-modulus) 'mod)]
                     [inv (datum->syntax-object (syntax with-modulus) 'inv)])
         (syntax (let* ([n e]
                        [mod    (lambda (x)   (modulo x n))]
                        [inv    (lambda (x)   (inverse x n))]
                        [+      (compose mod +)]
                        [-      (compose mod -)]
                        [*      (compose mod *)]
                        [square (lambda (x) (* x x))]
                        [^      (rec ^ (lambda (a b)
                                         (cond
                                           [(= b 0)   1]
                                           [(even? b) (square (^ a (/ b 2)))]
                                           [else      (* a (^ a (sub1 b)))])))])
                   form ...)))])) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-29T07:42:24.617

我开始回答最后一个问题。何时使用宏而不是函数。宏做函数不能做的事情，而函数做宏不能做的事情，所以很难混合它们，但让我们更深入。

当您想要评估参数时使用函数，当您想要不评估参数时使用宏。这不是很有用，是吗？当您想以不同的方式编写某些东西时，当您看到一个模式并想要抽象时，您会使用宏。例如：我为 foo 的不同值和类似的主体定义了三个函数，称为 foo-create、foo-process 和 foo-destroy，其中唯一的变化是 foo。有一个模式，但函数级别太高，所以你创建一个宏。

以我的拙见，Scheme 中的宏与其他 Lisp 中的宏使用一样多，例如 Common Lisp 或[Clojure](http://clojure.org)。我想这证明了卫生宏可能不是一个好主意，在这里我不同意保罗格雷厄姆的原因。这不是因为有时您想弄脏（不卫生），而是因为卫生宏最终变得复杂或令人费解。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-29T15:23:48.383

我只将 Scheme 宏 ( `define-syntax`) 用于更好的 lambda 语法之类的小事：

```
(define-syntax [: x]
  (syntax-case x ()
    ([src-: e es ...]
     (syntax-case (datum->syntax-object #'src-: '_) ()
       (_ #'(lambda (_) (e es ...))))))) 
```

这让你写

```
[: / _ 2]  ; <-- much better than (lambda (x) (/ x 2)) 
```

Dan Friedman 使用宏实现了令人费解的 OO：[http ://www.cs.indiana.edu/~dfried/ooo.pdf](http://www.cs.indiana.edu/~dfried/ooo.pdf)

但老实说，我定义的所有*有用宏都是从*[Paul Graham 的 On Lisp](http://paulgraham.com/onlisp.html)中偷来的，并且通常更容易编写`defmacro`（`define-macro`在 PLT 方案中）。例如，`aif`与`define-syntax`.

```
(define-syntax (aif x)
  (syntax-case x ()
    [(src-aif test then else)
     (syntax-case (datum->syntax-object (syntax src-aif) '_) ()
       [_ (syntax (let ([_ test]) (if (and _ (not (null? _))) then else)))])])) 
```

`define-syntax`奇怪的是，它只适用于非常简单的宏，您很高兴无法捕获变量；和非常复杂的宏 DSL，您很高兴无法*轻松*捕获变量。在第一种情况下，您想编写代码而不考虑它，而在第二种情况下，您对 DSL 有足够的考虑，您愿意用不是 Scheme的`syntax-rules`/语言编写其中的一部分，以避免神秘的错误`syntax-case`.

* * *

但我在Scheme 中并没有太多使用宏。Idiomatic Sc​​heme 功能如此强大，以至于很多时候您只想编写一个函数式程序，然后隐藏一些 lambda。我上了函数式训练，现在相信如果你有一种惰性语言或 lambda 的良好语法，即使那样也没有必要，所以宏在纯函数式风格中并不是那么有用。

所以我推荐[Practical Common Lisp](http://gigamonkeys.com/book/)和[On Lisp](http://paulgraham.com/onlisp.html)。如果您想使用 PLT Scheme，我认为他们的大多数`defmacro`宏都可以与`define-macro`. 或者只使用 Common Lisp。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-29T11:27:13.463

Peter Seibel 的 Practical Common Lisp 对宏有很好的介绍。Paul Graham 的 On Lisp 可能是更复杂示例的良好来源。另外，看看 Common Lisp 中的内置宏。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-01T07:35:11.600

[Automata via Macros](http://www.cs.brown.edu/~sk/Publications/Papers/Published/sk-automata-macros/)论文介绍了通过 Scheme 中的宏实现有限状态机的函数式编程珍珠。

本书[The Reasoned Schemer](http://www.amazon.com/exec/obidos/tg/detail/-/0262562146/)以一个完整的基于宏的 miniKanren 实现作为结尾，miniKanren 是书中使用的逻辑编程语言。[与书中相比，本文](http://scheme2006.cs.uchicago.edu/12-byrd.pdf)更正式、更简洁地介绍了 miniKanren 及其实现。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-29T18:36:05.623

一个不是变相的 lambda 形式的更高级宏的示例是 Common Lisp 的宏**with-slots**，它使对象槽访问看起来像普通的变量访问：

```
(with-slots (state door) car
  (when (eq state :stopped)
    (setq state :driving-around)
    (setq door :closed))) 
```

请注意，这与将插槽值绑定到局部变量并访问它们不同，因为**with-slots**允许您通过 SETQ 更改插槽并立即查看外部更改。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-01T08:10:22.450

`curry`当我以前在我的手掌上做很多计划时，我有一个宏。这很方便。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-10T20:33:17.017

Scheme 宏允许您添加原始语言作者自己未包含的功能；这就是宏背后的全部哲学。

这是一个小例子：PLT Scheme 提供了一种用于编写演示文稿的语言，称为幻灯片。我使用宏将幻灯片编号与幻灯片相关联，以便我可以更轻松地管理它们。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-30T20:42:35.770

我编写了一个提供中缀语法的宏。没有什么太花哨的；没有优先权。虽然我通常对前缀语法很好，但我更喜欢 < 和 > 的中缀。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-01T08:00:54.170

当程序不够用时，我会使用它们。

# visual-studio - 管理团队中 x86 和 x64 工作站之间的参考路径

> ID：245687
> 
> 赞同：5
> 
> 时间：2008-10-29T03:20:56.033
> 
> 标签：visual-studio, 64-bit

我想知道当不是每个人都可以立即升级到 x64 操作系统时，.NET 团队如何处理程序集引用路径。现在的关键问题是 x64 版本的 Windows 会将 32 位安装植入 C:\Program Files (x86)\ 而不是常规的 C:\Program Files。这意味着来自第三方的许多额外组件和框架最终位于 C:\Program Files (x86) 中。

因此，当将在 x86 工作站中创建/修改的源项目下载到 x64 工作站时，需要进行一些修改工作才能使参考路径正确。很典型的是，x64 用户可能会保存修改并将他们的“偏好”提交回版本控制存储库，从而打破 x86 用户的节奏。

有哪些好的方法可以在不同的团队中保持和谐？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-29T04:40:42.707

要么在每台机器上的 GAC 中安装程序集，要么在解决方案根目录下有一个特殊的 LIB 文件夹，其中包含所有 3rd 方程序集。LIB 文件夹是我最近几年自己使用的。我什至将程序集放在源代码管理中，以便其他/新开发人员无需考虑即可获得它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-29T13:08:53.617

将 3rd 方程序集添加到 lib 目录也有助于确保团队中的每个人都使用完全相同的版本，而不是他们构建开发机器时使用的最新版本。如果您没有将它们签入源代码管理中的公共位置，那么很容易不同步。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T23:06:10.570

这更像是一个后续问题而不是答案，但我认为这个小组可能知道。

如果我们有一些开发人员在 64 位机器上工作，而一些开发人员在 32 位机器上工作，但我们需要引用非托管程序集，其中一半团队需要在 x86 中，而另一半需要在 x64 中？除了每次 64 位钻机上的某人获得最新版本时手动更新引用之外，还有其他解决方案吗？

# linux - 在 Linux CLI 中以相对于当前目录的路径递归列出文件

> ID：245698
> 
> 赞同：243
> 
> 时间：2008-10-29T03:28:06.190
> 
> 标签：linux, unix, recursion, ls

这类似于[这个问题](https://stackoverflow.com/questions/105212/linux-recursively-list-all-files-in-a-directory-including-files-in-symlink-dire)，但我想在 unix 中包含相对于当前目录的路径。如果我执行以下操作：

```
ls -LR | grep .txt 
```

它不包括完整路径。例如，我有以下目录结构：

```
test1/file.txt
test2/file1.txt
test2/file2.txt 
```

上面的代码将返回：

```
file.txt
file1.txt
file2.txt 
```

如何使用标准 Unix 命令包含相对于当前目录的路径？

* * *

## 回答 #1

> 赞同：332
> 
> 时间：2008-10-29T03:34:44.853

使用查找：

```
find . -name \*.txt -print 
```

在使用 GNU find 的系统上，像大多数 GNU/Linux 发行版一样，您可以省略 -print。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2010-04-28T00:45:02.277

将`tree`, 与`-f`（完整路径）和`-i`（无缩进线）一起使用：

```
tree -if --noreport .
tree -if --noreport directory/ 
```

然后，您可以使用它`grep`来过滤掉您想要的那些。

* * *

如果找不到该命令，您可以安装它：

键入以下命令在 RHEL/CentOS 和 Fedora linux 上安装树命令：

```
# yum install tree -y 
```

如果您使用的是 Debian/Ubuntu，Mint Linux 在您的终端中键入以下命令：

```
$ sudo apt-get install tree -y 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-10-29T03:33:53.527

试试`find`。您可以在手册页中准确查找它，但它有点像这样：

`find [start directory] -name [what to find]`

所以对于你的例子

`find . -name "*.txt"`

应该给你你想要的。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-29T03:36:09.733

您可以使用 find 代替：

```
find . -name '*.txt' 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-12-30T05:49:47.030

要使用 find 命令获取所需文件的实际完整路径文件名，请将其与 pwd 命令一起使用：

```
find $(pwd) -name \*.txt -print 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-03-14T21:41:55.333

这就是诀窍：

`ls -R1 $PWD | while read l; do case $l in *:) d=${l%:};; "") d=;; *) echo "$d/$l";; esac; done | grep -i ".txt"`

但是它通过解析 . 来“犯罪” `ls`，这被 GNU 和 Ghostscript 社区认为是不好的形式。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-10-15T11:04:31.737

```
DIR=your_path
find $DIR | sed 's:""$DIR""::' 
```

'sed' 将从所有 'find' 结果中删除 'your_path'。并且您收到相对于“DIR”路径的信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-11-27T09:45:37.537

这是一个 Perl 脚本：

```
sub format_lines($)
{
    my $refonlines = shift;
    my @lines = @{$refonlines};
    my $tmppath = "-";

    foreach (@lines)
    {
        next if ($_ =~ /^\s+/);
        if ($_ =~ /(^\w+(\/\w*)*):/)
        {
            $tmppath = $1 if defined $1;    
            next;
        }
        print "$tmppath/$_";
    }
}

sub main()
{
        my @lines = ();

    while (<>) 
    {
        push (@lines, $_);
    }
    format_lines(\@lines);
}

main(); 
```

用法：

```
ls -LR | perl format_ls-LR.pl 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-03-30T18:50:16.967

您可以创建一个 shell 函数，例如在您的`.zshrc`or中`.bashrc`：

```
filepath() {
    echo $PWD/$1
}

filepath2() {
    for i in $@; do
        echo $PWD/$i
    done
} 
```

显然，第一个仅适用于单个文件。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-02-23T02:11:36.980

从根目录“/”开始搜索，在文件系统上找到名为“filename”的文件。“文件名”

```
find / -name "filename" 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-08-21T14:41:25.307

如果您想保留输出中带有文件大小等 ls 的详细信息，那么这应该可以工作。

```
sed "s|<OLDPATH>|<NEWPATH>|g" input_file > output_file 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-04-23T17:31:59.020

在[fish](https://fishshell.com/) shell中，您可以这样做以递归地列出所有pdf，包括当前目录中的pdf：

```
$ ls **pdf 
```

如果您想要任何类型的文件，只需删除“pdf”。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-04-13T05:49:50.870

您可以像这样实现此功能
首先，使用指向目标目录的 ls 命令。稍后使用 find 命令过滤结果。从你的情况来看，这听起来像 - 文件名总是以一个单词开头 `file***.txt`

```
ls /some/path/here | find . -name 'file*.txt'   (* represents some wild card search) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-03-05T09:33:49.467

在我的情况下，使用树命令

相对路径

```
tree -ifF ./dir | grep -v '^./dir$' | grep -v '.*/$' | grep '\./.*' | while read file; do
  echo $file
done 
```

绝对路径

```
tree -ifF ./dir | grep -v '^./dir$' | grep -v '.*/$' | grep '\./.*' | while read file; do
  echo $file | sed -e "s|^.|$PWD|g"
done 
```

# login - 用作登录名或用户名的电子邮件地址的正确名称是什么？

> ID：245705
> 
> 赞同：2
> 
> 时间：2008-10-29T03:32:23.110
> 
> 标签：login

我正在尝试决定在一个对话框中放入什么内容，告诉用户他们的登录无效，可能有重复。系统使用电子邮件地址作为用户名，然后需要密码。

现在，我正在使用“电子邮件登录”，但这听起来很愚蠢。

例如：

1）应用程序启动，承认它从未运行过。2) 提示用户创建一个新帐户。3) 用户输入电子邮件地址和密码以用作他们的新凭据。4) 好吧，看起来他们可能已经有一个帐户了。（这是帐户创建最有可能失败的情况，但我使用的是 API，我不能 100% 这就是失败的原因） 5）我要求他们使用不同的“电子邮件登录”再试一次。

```
Could not create account - try a different email login ! 
```

在与 API 提供商核实后，我可能会尝试检测它实际上是一个重复的帐户，并要求他们尝试使用密码验证该帐户。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-29T03:34:46.147

明确告诉他们他们的电子邮件地址已被使用。

称它为电子邮件地址，这就是用户的想法。您将其用作 id 或数据库主键或哈希键的事实与它们无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T03:36:42.290

我只想称它为：电子邮件地址。不过，我不建议他们尝试不同的方法。只需询问他们是否已经有帐户，如果有，请尝试使用地址/密码登录。如果他们仍然有问题，请给他们一个可以用来寻求帮助的联系方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-29T03:53:35.687

可能： *此电子邮件地址已存在一个帐户。如果您已有账号但忘记密码，请点击**[这里]**，否则请选择其他邮箱地址。*

我同意 mgb 的观点，即最好的选择是解释问题以及用户应该如何进行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-03T11:59:38.400

身份验证过程（即登录/登录）与用户可以使用的选项（即）之间存在区别。用户名、用户 ID 或电子邮件地址。

As more websites are having allowing users to login with email address it doesn't pay to be ambiguous, do your users a favour and label the field 'Email Address:'. This way your users are clear on what is expected in the field. If you label it "login:" or something else vague they'll be subtly fooled into thinking they might have created a username when creating their account and try all the usernames they usually use before trying email addresses.

# php - PHP：my_thread_global_end() 中的错误：1 个线程未退出

> ID：245709
> 
> 赞同：3
> 
> 时间：2008-10-29T03:33:31.920
> 
> 标签：php, mysql

在 CLI 模式下运行 PHP 时，*大多数*情况下（并非总是如此），脚本将在执行结束时挂起大约 5 秒，然后输出：

> `Error in my_thread_global_end(): 1 threads didn't exit`

它似乎实际上对脚本本身没有任何影响。

一些网络搜索出现了建议用不同版本替换 php_mysql.dll 的博客，但这并没有解决我的问题，我怀疑这些博客中的信息现在已经过时了。

我的设置：

*   PHP 版本 5.2.4
*   Apache/2.2.4 (Win32)
*   Windows Vista 家庭高级版 SP1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T03:40:02.850

这是 windows fast-cgi 实现中某些 PHP 5.2.X 版本的已知错误

[http://bugs.php.net/bug.php?id=41350&edit=1](http://bugs.php.net/bug.php?id=41350&edit=1)

我之前遇到过这个错误，将我的 PHP 安装降级到 5.2.0 解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T01:40:15.450

无需降级整个 ​​PHP 版本，只需从**PHP 5.2.1 版本中替换****libmysql.dll**就可以了:) 有关更多信息，请参阅[**此链接**](http://www.eukhost.com/forums/f15/fix-error-my_thread_global_end-1-thread-didnt-exit-5612/)。**[](http://www.eukhost.com/forums/f15/fix-error-my_thread_global_end-1-thread-didnt-exit-5612/)**

 ***** * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T04:46:58.607

你看过[这个资源](http://www.eukhost.com/forums/f15/fix-error-my_thread_global_end-1-threads-didnt-exit-5612/)吗？您可能需要仔细检查您是否有一个不受此影响的特定 libmysql.dll (5.2.1)，并且还要仔细检查您周围是否没有任何 PHP 可能会拾取的杂散 mysql 库。或者，如果您愿意，可以从 FastCGI 切换。

出于利益考虑，[这里](http://bugs.mysql.com/bug.php?id=25621)的错误似乎是最好的详细信息。问题的总体思路（来自 mysql bug 链接）似乎是：

```
Whenever a new thread is created libmysql is told about that by Windows. It then     
increases a thread counter and initializes some data. When libmysql is being unloaded
it checks whether all threads have finished, if not it tries to tell them "close now"
and gives them 5 seconds for that. In general this works in a nice way. 
```

# .net - 将 Objective-C 支持添加到 .NET 公共语言运行时需要什么？

> ID：245721
> 
> 赞同：12
> 
> 时间：2008-10-29T03:38:56.077
> 
> 标签：.net, objective-c, clr

.NET CLR 是否可以支持 Objective-C？是否有任何理由（从法律或实施）的角度来看这是不可能的？

本着跨平台应用程序开发的精神，如果能够在 Windows 机器上编写和运行 Objective-C 应用程序，那就太好了。至少我认为会。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-29T04:10:31.847

Objective-C 是 C 的严格超集。因此，它有很多特性，比如指针，在 .NET 上的转换效果很差。当然，在实践中，大多数 Objective-C 程序的编写方式可能是它们也可以针对更严格定义的语言规范版本进行编译，该版本限制性更强，但可以翻译成安全的代码。

假设是这种情况，Objective-C 的方法调度部分自然适合[DLR](http://en.wikipedia.org/wiki/Dynamic_Language_Runtime)的动态功能。我实际上已经考虑过创建这样一个端口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T04:36:56.957

在 CLR 之上托管 Objective-C 应该没有问题。您可能可以在 DLR 之上实现运行时，或者在最坏的情况下实现您自己的。这仍然与为 CLR 编译任何实质性的 Objective-C 代码库有很大不同，因为您可能感兴趣的绝大多数 Objective-C 代码都依赖于 Apple 的框架。

最后，您将需要重新实现它们，或者将 Objective-C 桥接到 .NET 框架，这将允许您编写 Objective-C 代码，但它不会使用与任何现有 Objective-C 兼容的框架代码。您可能想看看[Cocotron](http://www.cocotron.org/)，它是一个交叉编译环境，允许 Mac 开发人员将一些 Objective-C 应用程序迁移到 Windows。这应该为 Windows 提供了一个相当好的 Objective-C 运行时示例，并且可能提供一些必要的框架，以便在您启动一个可以针对 .NET 的编译器后使合理数量的 Objective-C 代码可用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-29T11:33:00.317

如果您的意思是能够使用 Objective-C 语法编写 .NET 应用程序并且能够使用来自 Foundation 框架（例如 NSArray）的数据结构，那么这很容易完成（尽管很长）。这与添加对任何语言的支持没有什么不同。

然而，在 Mac 上使 Objective-C 开发变得出色的不是语法，而是 Apple 提供的其他 API，例如：

*   [核心数据](http://developer.apple.com/documentation/Cocoa/Conceptual/CoreData/cdProgrammingGuide.html)
*   [核心音频](http://developer.apple.com/audio/)
*   [石英](http://developer.apple.com/documentation/graphicsimaging/Conceptual/drawingwithquartz2d/dq_intro/chapter_1_section_1.html)
*   [核心动画](http://developer.apple.com/documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html)

除了这些更难实现的 API 之外，您还必须考虑诸如[Bindings](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaBindings/CocoaBindings.html)支持和[Key Value Observing](http://developer.apple.com/documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html)之类的事情，这在 CLR 中实现起来要困难得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-29T03:46:12.690

不，真的没有。.NET 编译为[IL](https://en.wikipedia.org/wiki/Common_Intermediate_Language)（或 CIL 或 MSIL），它基本上是虚拟机的机器代码。你可以像在汇编中那样在 IL 中编程（不是我见过有人这样做）。如果你有经验、知识和进取心，那么编写一个 Objective-C 到 IL 编译器是没有问题的。见鬼，.NET 甚至还有[函数式编程语言 (F#)](http://research.microsoft.com/fsharp/fsharp.aspx)。除了消息传递功能和库之外，它与 C#、VB.NET 等没有太大区别。

多么棒的主意！Objective-C# 之类的。

您可以从这里开始：[Microsoft IL 上的维基百科](http://en.wikipedia.org/wiki/Common_Intermediate_Language)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T12:44:59.420

正如其他人所说，是的，这是可能的。这是否是一个好主意（尤其是“本着跨平台开发的精神”）是另一回事。

同样，正如已经指出的那样，没有它的库，该语言并不多。由于 Objective-C 现在几乎只在 Mac 和 iPhone 环境中使用，并且如果它们是您的目标，能够在 Windows 上编写代码并不会为您带来太多好处。

此外，您已经可以在 Windows 上编写 Objective-C - 我相信通常与[Xcode一起使用的](https://en.wikipedia.org/wiki/Xcode)[GCC](https://en.wikipedia.org/wiki/GNU_Compiler_Collection)也将在 Windows 上编译 Objective-C 以及[GNUstep](https://en.wikipedia.org/wiki/GNUstep)。

仅剩下在 .NET 上运行 Objective-C 是否有优势？

*Objective-C的*一些不错的特性在典型的 .NET 语言中是没有的。就个人而言，我非常喜欢参数的方法名称标签。

但是，我认为这不足以让它值得带过来。大多数 Objective-C 擅长的事情，C# 都有自己的解决方案。现在，如果他们愿意拒绝实现命名参数...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-02T13:37:50.843

使用[NObjective](https://en.wikipedia.org/wiki/NObjective)桥，您可以在 C# 中使用现有的 Objective-C 类或创建新的类。

[此外，在Visual Studio 2010](https://en.wikipedia.org/wiki/Microsoft_Visual_Studio#2010)和 .NET 4最终发布之后，我将为 NObjective 添加 DLR 支持。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-22T21:36:40.263

.Net的[Objective-J](https://en.wikipedia.org/wiki/Objective-J)和[Cappuccino](https://en.wikipedia.org/wiki/Cappuccino_(software))，而不是 Objective-C 和[Cocoa](https://en.wikipedia.org/wiki/Cocoa_%28API%29)呢？Objective-J 与 Objective-C 一样吸引人，然而，Objective-J 比 Objective-C 更接近 C#（没有指针、垃圾回收等）

我最近在 Cappuccino 开发者论坛上询问了这个问题，他们向我介绍了 Jurassic（一个用于 .NET 的 JavaScript 编译器）。他们还说卡布奇诺在 IronJS 上运行良好。因此，看起来组件已经存在（Objective-J → JavaScript → .NET），但必须构建将它们连接在一起的桥梁。

# database - 您最喜欢的与数据库相关的讨论论坛是什么？

> ID：245722
> 
> 赞同：-3
> 
> 时间：2008-10-29T03:38:58.603
> 
> 标签：database, forum

可以肯定的是，Stack Overflow 正在获得巨大的动力！

你想分享你的其他最爱吗？我知道数据库论坛有不同的性质。仅举几例：

*   供应商特定
*   特定于编程
*   特定于管理
*   业务性质特定

等等......如果你能提到你最喜欢的垂直领域，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T04:11:41.720

对于甲骨文：

[http://asktom.oracle.com/](http://asktom.oracle.com/)

不完全是一个论坛，而是一个带有回复的问答（很像 SO）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T04:13:55.740

Oracle-L 列表中潜伏着一些真正顶尖的人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T04:42:39.207

[http://www.sqlteam.com/forums/](http://www.sqlteam.com/forums/) - 乐于助人且友好的用户群随时准备帮助使用 SQL Server。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-29T11:47:42.830

[dbForums](http://www.dbforums.com)很好。有所有主要 DBMS 的论坛，以及我特别喜欢的通用论坛[数据库概念和设计](http://www.dbforums.com/forumdisplay.php?f=116)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T11:50:11.950

[Google Groups](http://groups.google.com/groups/dir?sel=usenet%3Dcomp.databases)有一些很好的数据库论坛，包括[comp.databases.theory](http://groups.google.com/group/comp.databases.theory/topics?lnk&safe=on)供那些喜欢考虑关系模型等理论基础的人使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-29T16:20:57.347

[SQLServerCentral](http://www.sqlservercentral.com/Forums/)顾名思义，它的主要关注点是 MS SQL Server。

这项出色服务的唯一缺点是需要注册。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-29T16:37:03.603

[DBA Village](http://www.dba-village.com/village/dvp_base.main)是专门针对 Oracle 的，但内容的质量比您对论坛的期望要好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-29T14:58:25.320

SQL Server 和 Oracle 都有专门的 Stack Exchange 站点。这些由 Simple Talk Publishing 维护。

[http://ask.sqlservercentral.com/](http://ask.sqlservercentral.com/)

[http://www.oracleoverflow.com/](http://www.oracleoverflow.com/)

# java - 从数据库中获取对象时 JPA (Hibernate) 如何处理事务

> ID：245723
> 
> 赞同：0
> 
> 时间：2008-10-29T03:39:47.603
> 
> 标签：java, hibernate, jpa, transactions

我目前正在使用 Hibernate 作为持久性管理器和 JPA 作为持久性管理休眠的抽象在 java 中开发应用程序。

我想知道围绕事务包装结果查询的影响。我知道实体管理器必须为延迟获取的字段错误保持打开状态，这一切中的事务呢？

这是一个具有事务激活/停用能力的代码示例。

```
public List<Exportdata> get(Integer max, EntityManager em, Boolean withTransaction) {
    EntityTransaction tx = null;
    try {
        if (withTransaction) {
            tx = em.getTransaction();
            tx.begin();
        }

        Query query = em.createQuery("from Exportdata");
        query.setMaxResults(10);
        List<Exportdata> list = query.getResultList();

        if (withTransaction)
            tx.commit();

        return list;
    } catch (RuntimeException re) {
        if (withTransaction)
            if (tx != null && tx.isActive())
                tx.rollback();

        throw re;
    }
} 
```

调用此函数时启用或禁用 withTransaction 有什么区别？

谢谢大家，弗雷德

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-29T10:44:12.550

这里没有实际区别，因为您没有更改任何数据。您执行的查询将生成一个 SQL 选择。事务允许您将 ACID 属性应用于插入、更新等的集合。

*但是*，如果您开始操作从此方法返回的列表中的对象、调用 setter 等，这些更改将通过临时事务传播回数据库。换句话说，您将有效地在自动提交模式下使用数据库。这不太可能是您想要的。

要理解的重要一点是，持久性上下文和事务的持续时间可以分开管理。通常，尽管您希望将它们一起管理。

# python - 在 Django 中上传文件，然后通过 REST 将其发送到其他地方？

> ID：245725
> 
> 赞同：1
> 
> 时间：2008-10-29T03:45:09.167
> 
> 标签：python, django, api, rest, scribd

我正在构建一个简单的 Django 应用程序，它将使用 scribd 来显示文档。我想要一个页面，管理员可以通过该网站将文档上传到 scribd，因为在它进入 scribd 之前我需要了解一些关于它的事情。最好/最简单的方法是什么，显示一个上传页面，然后获取上传的文件并通过他们的 api 的[docs.upload](http://www.scribd.com/publisher/api?method_name=docs.upload)方法将其发送到 scribd？我对这个 Python/Django/REST API 有点陌生，如果一次有太多问题，我很抱歉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T04:45:06.630

这是相当多的问题。

使用 Django 处理文件上传非常简单，请参阅[文件上传文档](http://docs.djangoproject.com/en/dev/topics/http/file-uploads/)以获取示例。简而言之，您可以通过`request.FILES['file']`.

要调用 scribd api，您可以使用 urllib2；有关说明，请参阅此[Hackoarama 页面](http://www.hackorama.com/python/upload.shtml)。urllib2 可能有点复杂，但一旦你掌握了它，它就可以工作。

您可以直接从 Django 视图中调用 scribd api，但最好将其分开：从 Django 视图中将文件保存在磁盘上的某个位置并在消息传递系统上放置“上传此”消息（例如。[豆茎](http://xph.us/software/beanstalkd/)）。让一个单独的进程接收消息并将文件上传到 scribd。这样您就可以保护您的 http 进程和用户免受访问 API 和相关延迟的任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T04:41:23.097

您想要做的（至少从我在此处和 Django 文档站点上阅读的内容来看）是创建[自定义存储系统。](http://docs.djangoproject.com/en/dev/howto/custom-file-storage/#howto-custom-file-storage)

这应该可以为您提供您所需要的 - 毕竟这是他们开始示例的动机！

# asp.net - IIS 工作进程使用大量内存？

> ID：245727
> 
> 赞同：18
> 
> 时间：2008-10-29T03:46:08.823
> 
> 标签：asp.net, iis, memory, worker-process

我的服务器上有一个网站，我的 IIS 工作进程一直使用 4GB RAM。我应该检查什么？

```
c:\windows\system32\inetsrv\w3wp.exe 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-29T05:18:44.737

我会检查Gulzar 提到的[文档中的 CLR Tuning Section。](http://msdn.microsoft.com/en-us/library/ms998583.aspx#scalenetchapt17_topic9)

正如其他海报所指出的那样，任何实现的对象都`IDispose`应该`Dispose()`在完成时调用它，最好使用`using`构造。

启动`perfmon.exe`并添加这些计数器：

> *   进程\私有字节
> *   .NET CLR 内存# 所有堆中的字节数
> *   流程\工作集
> *   .NET CLR 内存\大对象堆大小
> 
> 在所有堆计数器中的字节数保持不变的情况下，私有字节的增加表示非托管内存消耗。
> 
> 两个计数器的增加表示托管内存消耗

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-29T03:48:33.123

[查看Tuning .NET Application Performance](http://msdn.microsoft.com/en-us/library/ms998583.aspx#scalenetchapt17_topic9)中有关解决内存瓶颈问题的部分

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-29T08:42:30.503

创建 w3wp 进程的小型转储并使用 WinDbg 查看内存中的对象。这就是微软的 IIS 支持团队在遇到此类问题时所做的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-29T04:06:17.470

如果您有权访问源代码，您可能需要检查实现 IDisposable 的任何对象是否在`using`语句内部被引用或在您完成它们时被正确处置。

`Using`是一个 C# 构造，但基本思想是在完成后释放资源。

要检查的另一件事是大型对象被置于“进行中”会话状态或缓存中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-29T04:15:40.010

更多细节肯定会有所帮助。应用程序池中有多少应用程序正在运行？池中是否有 ASP.NET 应用程序？

如果您正在运行 ASP.NET，请仔细查看您在会话和缓存变量中存储的内容。使用 PerfMon 检查发生了多少第 0 代、第 1 代和第 2 代收集。小心将 UI 元素存储在会话状态或缓存中，因为这会阻止收集整个页面实例以及页面实例的所有子项。最后，检查您是否正在执行大量字符串连接。这会导致大量对象实例化，因为 .NET 字符串是不可变的。考虑改用 StringBuilder 。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-29T05:38:32.153

[正如其他人所指出的，此问题的常见原因是资源泄漏，win2k3 服务器和 IIS6 KB916984](http://support.microsoft.com/kb/916984)也存在一个已知问题

# jquery - 在 Rails 中使用 jquery

> ID：245733
> 
> 赞同：8
> 
> 时间：2008-10-29T03:49:57.100
> 
> 标签：jquery, ruby-on-rails

我打算在 Rails 中使用 jquery 而不是原型。

我不确定使用 jRails 或使用纯 jquery 并远离 RJS。

你怎么看待这件事？

编辑：两周后我发现了这个[http://www.loudthinking.com/posts/32-myth-3-rails-forces-you-to-use-prototype](http://www.loudthinking.com/posts/32-myth-3-rails-forces-you-to-use-prototype)

编辑：[这个](http://railscasts.com/episodes/136-jquery)截屏视频也很有趣。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-29T04:02:31.003

如果你问我，远离 RJS 是个好主意。RJS 是一个非常酷的 hack，但是对于生产代码来说，测试和调试是一件很痛苦的事情。我建议坚持使用 UJS（Unobtrusive JavaScript），而 jQuery 是实现 UJS 的好方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T05:20:23.640

我第二次在没有 Rails 帮助的情况下使用 jQuery，使用不显眼的 Javascript 作为一种技术。我建议使用[Low Pro](http://www.danwebb.net/2008/2/3/how-to-use-low-pro-for-jquery)库来设置行为控制器以将 CSS 伪类（事件）绑定到您的函数。

jQuery 在没有 Rails 的情况下也可以很好地进行 DOM 操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T04:54:33.193

我使用 JRails，它非常好。

我认为使用 RJS 进行简单操作是有一定价值的……许多开箱即用的功能非常适合简单的用例，它可以帮助您快速完成成品。您始终可以在稍后阶段转换代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-15T10:35:17.537

当我将 Rails 3+RJS 从 Prototype 迁移到 JQuery 时，JRais 对我来说不是开箱即用的。所以我只是对 JRails 的片段进行了猴子修补，而不使用它的其余部分，[就像这里描述的那样](http://snippets.dzone.com/posts/show/13129)

* * *

## 回答 #5

> 赞同：-7
> 
> 时间：2008-10-29T05:05:33.407

Prototype 和 Scriptaculous 是 Rails 框架的一部分。恕我直言，您可以删除这些库并插入其他库，但这将不是 Rails 框架和 Rails 项目。

另一个变体是将 jQuery 添加到标准 Rails 配置中。之后，您必须修复这些库之间的一些兼容性问题。jQuery 已经发布了制作它的小脚本。

# algorithm - 相邻数算法分组器

> ID：245735
> 
> 赞同：9
> 
> 时间：2008-10-29T03:52:35.550
> 
> 标签：algorithm, language-agnostic

我的意思是：

给定输入的一组数字：

1,2,3,4,5 变为“1-5”。

1,2,3,5,7,9,10,11,12,14 变为 "1-3, 5, 7, 9-12, 14"

这是我想出的最好的：[C#]

*这对我来说有点草率，所以问题是，是否有某种更具可读性和/或优雅的解决方案？*

```
public static string[] FormatInts(int[] ints)
{
    if (ints == null)
        throw new ArgumentNullException("ints"); // hey what are you doing?

    if (ints.Length == 0)
        return new string[] { "" }; // nothing to process

    if (ints.Length == 1)
        return new string[] { ints[0].ToString() }; // nothing to process

    Array.Sort<int>(ints); // need to sort these lil' babies
    List<string> values = new List<string>();

    int lastNumber  = ints[0]; // start with the first number
    int firstNumber = ints[0]; // same as above

    for (int i = 1; i < ints.Length; i++)
    {
        int current     = ints[i];
        int difference  = (lastNumber - current ); // compute difference between last number and current number

        if (difference == -1) // the numbers are adjacent
        {
            if (firstNumber == 0) // this is the first of the adjacent numbers
            {
                firstNumber = lastNumber;
            }
            else // we're somehow in the middle or at the end of the adjacent number set
            {
                lastNumber = current;
                continue;
            }
        }
        else
        {
            if (firstNumber > 0 && firstNumber != lastNumber) // get ready to print a set of numbers
            {
                values.Add(string.Format("{0}-{1}", firstNumber, lastNumber));
                firstNumber = 0; // reset
            }
            else // print a single value
            {
                values.Add(string.Format("{0}", lastNumber));
            }
        }

        lastNumber = current;
    }

    if (firstNumber > 0) // if theres anything left, print it out
    {
        values.Add(string.Format("{0}-{1}", firstNumber, lastNumber));                
    }

    return values.ToArray();
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-29T04:22:25.427

我已经像这样重写了你的代码：

```
 public static string[] FormatInts(int[] ints)
    {
        Array.Sort<int>(ints);
        List<string> values = new List<string>();

        for (int i = 0; i < ints.Length; i++)
        {
            int groupStart = ints[i];
            int groupEnd = groupStart;
            while (i < ints.Length - 1 && ints[i] - ints[i + 1] == -1)
            {
                groupEnd = ints[i + 1];
                i++;
            }
            values.Add(string.Format(groupEnd == groupStart ? "{0}":"{0} - {1}", groupStart, groupEnd));
        }
        return values.ToArray();
    } 
```

进而：

```
/////////////////
int[] myInts = { 1,2,3,5,7,9,10,11,12,14 };
string[] result = FormatInts(myInts); // now result haves "1-3", "5", "7", "9-12", "14" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T07:53:17.717

纯函数式 Python：

```
#!/bin/env python

def group(nums):
    def collect((acc, i_s, i_e), n):
        if n == i_e + 1: return acc, i_s, n
        return acc + ["%d"%i_s + ("-%d"%i_e)*(i_s!=i_e)], n, n
    s = sorted(nums)+[None]
    acc, _, __ = reduce(collect, s[1:], ([], s[0], s[0]))
    return ", ".join(acc)

assert group([1,2,3,5,7,9,10,11,12,14]) == "1-3, 5, 7, 9-12, 14" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-29T08:08:23.503

请参阅[如何将整数数组显示为一组范围？（算法）](https://stackoverflow.com/questions/117691/how-would-you-display-an-array-of-integers-as-a-set-of-ranges-algorithm)

[我](https://stackoverflow.com/questions/117691/how-would-you-display-an-array-of-integers-as-a-set-of-ranges-algorithm#233811)对上述问题的回答：

```
void ranges(int n; int a[n], int n)
{
  qsort(a, n, sizeof(*a), intcmp);
  for (int i = 0; i < n; ++i) {
    const int start = i;
    while(i < n-1 and a[i] >= a[i+1]-1)
      ++i;
    printf("%d", a[start]);
    if (a[start] != a[i])
      printf("-%d", a[i]);
    if (i < n-1)
      printf(",");
  }
  printf("\n");
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-12-16T20:57:23.113

我参加聚会有点晚了，但无论如何，这是我使用 Linq 的版本：

```
public static string[] FormatInts(IEnumerable<int> ints)
{
 var intGroups = ints
  .OrderBy(i => i)
  .Aggregate(new List<List<int>>(), (acc, i) =>
  {
   if (acc.Count > 0 && acc.Last().Last() == i - 1) acc.Last().Add(i);
   else acc.Add(new List<int> { i });

   return acc;
  });

 return intGroups
  .Select(g => g.First().ToString() + (g.Count == 1 ? "" : "-" + g.Last().ToString()))
  .ToArray();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T03:59:18.093

对我来说看起来清晰明了。如果您假设输入数组已排序，或者在进一步处理之前自行排序，则可以稍微简化一下。

我建议的唯一调整是反转减法：

> ```
> int差异=（当前-lastNumber）；
> ```

...仅仅是因为我发现处理积极的差异更容易。但是您的代码很高兴阅读！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-29T05:18:37.777

## Perl

带输入验证/预排序

如果您需要做一些比仅仅返回字符串更花哨的事情，您可以轻松地将结果作为 LoL 获得。

```
#!/usr/bin/perl -w

use strict;
use warnings;

use Scalar::Util qw/looks_like_number/;

sub adjacenify {
    my @input = @_;  

    # Validate and sort
    looks_like_number $_ or
        die "Saw '$_' which doesn't look like a number" for @input;
    @input = sort { $a <=> $b } @input;

    my (@output, @range);
    @range = (shift @input);
    for (@input) {
        if ($_ - $range[-1] <= 1) {
            push @range, $_ unless $range[-1] == $_; # Prevent repetition
        }
        else {
            push @output, [ @range ];
            @range = ($_); 
        }
    }   
    push @output, [ @range ] if @range;

    # Return the result as a string. If a sequence is size 1, then it's just that number.
    # Otherwise, it's the first and last number joined by '-'
    return join ', ', map { 1 == @$_ ? @$_ : join ' - ', $_->[0], $_->[-1] } @output;
}

print adjacenify( qw/1 2 3 5 7 9 10 11 12 14/ ), "\n";
print adjacenify( 1 .. 5 ), "\n";
print adjacenify( qw/-10 -9 -8 -1 0 1 2 3 5 7 9 10 11 12 14/ ), "\n";
print adjacenify( qw/1 2 4 5 6 7 100 101/), "\n";
print adjacenify( qw/1 62/), "\n";
print adjacenify( qw/1/), "\n";
print adjacenify( qw/1 2/), "\n";
print adjacenify( qw/1 62 63/), "\n";
print adjacenify( qw/-2 0 0 2/), "\n";
print adjacenify( qw/-2 0 0 1/), "\n";
print adjacenify( qw/-2 0 0 1 2/), "\n"; 
```

输出：

```
1 - 3, 5, 7, 9 - 12, 14
1 - 5
-10 - -8, -1 - 3, 5, 7, 9 - 12, 14
1 - 2, 4 - 7, 100 - 101
1, 62
1
1 - 2
1, 62 - 63
-2, 0, 2
-2, 0 - 1
-2, 0 - 2
-2, 0 - 2 
```

还有一个很好的递归解决方案：

```
sub _recursive_adjacenify($$);
sub _recursive_adjacenify($$) {
    my ($input, $range) = @_;

    return $range if ! @$input;

    my $number = shift @$input;

    if ($number - $range->[-1] <= 1) {
        return _recursive_adjacenify $input, [ @$range, $number ];
    }
    else {
        return $range, _recursive_adjacenify $input, [ $number ];
    }
}

sub recursive_adjacenify {
    my @input = @_;

    # Validate and sort
    looks_like_number $_ or
        die "Saw '$_' which doesn't look like a number" for @input;
    @input = sort { $a <=> $b } @input;

    my @output = _recursive_adjacenify \@input, [ shift @input ];

    # Return the result as a string. If a sequence is size 1, 
    # then it's just that number.
    # Otherwise, it's the first and last number joined by '-'
    return join ', ', map { 2 == @$_ && $_->[0] == $_->[1] ? $_->[0] : 
                            1 == @$_ ? @$_ : 
                            join ' - ', $_->[0], $_->[-1] } @output;

} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-29T07:28:34.880

正如我在评论中所写，我不喜欢使用值 0 作为标志，使 firstNumber 既是值又是标志。

我用Java快速实现了算法，大胆地跳过了你已经正确覆盖的有效性测试......

```
public class IntListToRanges
{
    // Assumes all numbers are above 0
    public static String[] MakeRanges(int[] numbers)
    {
        ArrayList<String> ranges = new ArrayList<String>();

        Arrays.sort(numbers);
        int rangeStart = 0;
        boolean bInRange = false;
        for (int i = 1; i <= numbers.length; i++)
        {
            if (i < numbers.length && numbers[i] - numbers[i - 1] == 1)
            {
                if (!bInRange)
                {
                    rangeStart = numbers[i - 1];
                    bInRange = true;
                }
            }
            else
            {
                if (bInRange)
                {
                    ranges.add(rangeStart + "-" + numbers[i - 1]);
                    bInRange = false;
                }
                else
                {
                    ranges.add(String.valueOf(numbers[i - 1]));
                }
            }
        }
        return ranges.toArray(new String[ranges.size()]);
    }

    public static void ShowRanges(String[] ranges)
    {
        for (String range : ranges)
        {
            System.out.print(range + ","); // Inelegant but quickly coded...
        }
        System.out.println();
    }

    /**
     * @param args
     */
    public static void main(String[] args)
    {
        int[] an1 = { 1,2,3,5,7,9,10,11,12,14,15,16,22,23,27 };
        int[] an2 = { 1,2 };
        int[] an3 = { 1,3,5,7,8,9,11,12,13,14,15 };
        ShowRanges(MakeRanges(an1));
        ShowRanges(MakeRanges(an2));
        ShowRanges(MakeRanges(an3));
        int L = 100;
        int[] anr = new int[L];
        for (int i = 0, c = 1; i < L; i++)
        {
            int incr = Math.random() > 0.2 ? 1 : (int) Math.random() * 3 + 2;
            c += incr;
            anr[i] = c;
        }
        ShowRanges(MakeRanges(anr));
    }
} 
```

当然，我不会说它比您的算法更优雅/高效……只是有些不同。

请注意，1,5,6,9 可以写成 1,5-6,9 或 1,5,6,9，不确定哪个更好（如果有的话）。

我记得做过类似的事情（在 C 中）将消息编号分组到 Imap 范围，因为它更有效。一个有用的算法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-29T09:46:36.270

短而甜美的红宝石

```
def range_to_s(range)
  return range.first.to_s if range.size == 1
  return range.first.to_s + "-" + range.last.to_s
end

def format_ints(ints)
  range = []
  0.upto(ints.size-1) do |i|
    range << ints[i]
    unless (range.first..range.last).to_a == range
      return range_to_s(range[0,range.length-1]) + "," + format_ints(ints[i,ints.length-1])
    end
  end
  range_to_s(range)  
end 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-29T15:22:47.950

我的第一个想法，在 Python 中：

```
def seq_to_ranges(seq):
    first, last = None, None
    for x in sorted(seq):
        if last != None and last + 1 != x:
            yield (first, last)
            first = x
        if first == None: first = x
        last = x
    if last != None: yield (first, last)
def seq_to_ranges_str(seq):
    return ", ".join("%d-%d" % (first, last) if first != last else str(first) for (first, last) in seq_to_ranges(seq)) 
```

可能会更清洁，但它仍然很容易。

Haskell 的简单翻译：

```
import Data.List
seq_to_ranges :: (Enum a, Ord a) => [a] -> [(a, a)]
seq_to_ranges = merge . foldl accum (id, Nothing) . sort where
    accum (k, Nothing) x = (k, Just (x, x))
    accum (k, Just (a, b)) x | succ b == x = (k, Just (a, x))
                             | otherwise   = (k . ((a, b):), Just (x, x))
    merge (k, m) = k $ maybe [] (:[]) m
seq_to_ranges_str :: (Enum a, Ord a, Show a) => [a] -> String
seq_to_ranges_str = drop 2 . concatMap r2s . seq_to_ranges where
    r2s (a, b) | a /= b    = ", " ++ show a ++ "-" ++ show b
               | otherwise = ", " ++ show a 
```

差不多。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-30T03:09:11.597

交互式[J](http://www.jsoftware.com/)会话的记录（用户输入缩进 3 个空格，ASCII 框中的文本是 J 输出）：

```
 g =: 3 : '<@~."1((y~:1+({.,}:)y)#y),.(y~:(}.y,{:y)-1)#y'@/:~"1
   g 1 2 3 4 5
+---+
|1 5|
+---+
   g 1 2 3 5 7 9 10 11 12 14
+---+-+-+----+--+
|1 3|5|7|9 12|14|
+---+-+-+----+--+
   g 12 2 14 9 1 3 10 5 11 7
+---+-+-+----+--+
|1 3|5|7|9 12|14|
+---+-+-+----+--+
   g2 =: 4 : '<(>x),'' '',>y'/@:>@:(4 :'<(>x),''-'',>y'/&.>)@((<@":)"0&.>@g)
   g2 12 2 14 9 1 3 10 5 11 7
+---------------+
|1-3 5 7 9-12 14|
+---------------+
   (;g2) 5 1 20 $ (i.100) /: ? 100 $ 100
+-----------------------------------------------------------+
|20 39 82 33 72 93 15 30 85 24 97 60 87 44 77 29 58 69 78 43|
|                                                           |
|67 89 17 63 34 41 53 37 61 18 88 70 91 13 19 65 99 81  3 62|
|                                                           |
|31 32  6 11 23 94 16 73 76  7  0 75 98 27 66 28 50  9 22 38|
|                                                           |
|25 42 86  5 55 64 79 35 36 14 52  2 57 12 46 80 83 84 90 56|
|                                                           |
| 8 96  4 10 49 71 21 54 48 51 26 40 95  1 68 47 59 74 92 45|
+-----------------------------------------------------------+
|15 20 24 29-30 33 39 43-44 58 60 69 72 77-78 82 85 87 93 97|
+-----------------------------------------------------------+
|3 13 17-19 34 37 41 53 61-63 65 67 70 81 88-89 91 99       |
+-----------------------------------------------------------+
|0 6-7 9 11 16 22-23 27-28 31-32 38 50 66 73 75-76 94 98    |
+-----------------------------------------------------------+
|2 5 12 14 25 35-36 42 46 52 55-57 64 79-80 83-84 86 90     |
+-----------------------------------------------------------+
|1 4 8 10 21 26 40 45 47-49 51 54 59 68 71 74 92 95-96      |
+-----------------------------------------------------------+ 
```

旁观者眼中的可读性和优雅性：D

那是一个很好的锻炼！它建议 Perl 的以下部分：

```
sub g {
    my ($i, @r, @s) = 0, local @_ = sort {$a<=>$b} @_;
    $_ && $_[$_-1]+1 == $_[$_] || push(@r, $_[$_]),
    $_<$#_ && $_[$_+1]-1 == $_[$_] || push(@s, $_[$_]) for 0..$#_;
    join ' ', map {$_ == $s[$i++] ? $_ : "$_-$s[$i-1]"} @r;
} 
```

## 附录

用简单的英语来说，这个算法找到前一个项目不是少的所有项目，将它们用作下限；查找下一项不大于一个的所有项，将它们用作上限；并将两个列表逐项组合在一起。

由于 J 非常晦涩难懂，这里简要解释一下该代码的工作原理：

`x /: y`对数组`x`进行排序`y`。 `~`可以将二元动词变成反身单子，因此`/:~`意味着“对自身进行排序”。

`3 : '...'`声明一个单子动词（J 的说法“函数接受一个参数”）。 `@`表示函数组合，因此`g =: 3 : '...' @ /:~`表示“`g`设置为我们正在定义的函数，但其​​参数首先排序”。 `"1`说我们操作的是数组，而不是表或任何更高维的东西。

注意：`y`始终是一元动词的唯一参数的名称。

`{.`获取数组的第一个元素（head），并`}:`获取除最后一个元素之外的所有元素（curtail）。 `({.,}:)y`有效地复制了第一个元素`y`并删除了最后一个元素。 `1+({.,}:)y`全部加 1，并`~:`比较两个数组，如果它们不同则为真，相同则为假，因此在元素不等于前一个元素`y~:1+({.,}:)y`的所有索引中为真的数组也是如此`y`它。 选择上句所述属性为真的`(y~:1+({.,}:)y)#y`所有元素。`y`

类似地，`}.`取除数组的第一个元素以外的所有元素（斩首）并`{:`取最后一个元素（尾部），`}.y,{:y`除第一个元素外的所有元素也是如此`y`，最后一个元素重复。 `(}.y,{:y)-1`全部减去 1，然后在挑选时再次`~:`逐项比较两个数组的不相等性。`#`

`,.`将两个数组压缩在一起，形成一个由两个元素数组组成的数组。 `~.`nubs 一个列表（消除重复项），并被赋予`"1`排名，因此它对内部的二元素数组而不是顶级数组进行操作。这是`@`由 组成的`<`，它将每个子数组放入一个盒子中（否则 J 将再次扩展每个子数组以形成一个 2D 表）。

`g2`是一团乱七八糟的装箱和拆箱（否则 J 会将字符串填充到相等的长度），并且非常无趣。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-31T08:29:39.577

这是我的 Haskell 条目：

```
runs lst = map showRun $ runs' lst

runs' l = reverse $ map reverse $ foldl newOrGlue [[]] l 

showRun [s] = show s
showRun lst = show (head lst) ++ "-" ++ (show $ last lst)

newOrGlue [[]] e = [[e]]
newOrGlue (curr:other) e | e == (1 + (head curr)) = ((e:curr):other)
newOrGlue (curr:other) e | otherwise              = [e]:(curr:other) 
```

和示例运行：

```
T> runs [1,2,3,5,7,9,10,11,12,14]

["1-3","5","7","9-12","14"] 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-08-25T19:21:43.220

Erlang 还对输入执行排序和唯一性，并且可以生成以编程方式可重用的对以及字符串表示形式。

```
group(List) ->
    [First|_] = USList = lists:usort(List),
    getnext(USList, First, 0).
getnext([Head|Tail] = List, First, N) when First+N == Head ->
    getnext(Tail, First, N+1);
getnext([Head|Tail] = List, First, N) ->
    [ {First, First+N-1} | getnext(List, Head, 0) ];
getnext([], First, N) -> [{First, First+N-1}].
%%%%%% pretty printer
group_to_string({X,X}) -> integer_to_list(X);
group_to_string({X,Y}) -> integer_to_list(X) ++ "-" ++ integer_to_list(Y);
group_to_string(List) -> [group_to_string(X) || X <- group(List)]. 
```

测试以编程方式获得可重用对：

外壳>测试：组（[34,3415,56,58,57,11,12,13,1,2,3,3,4,5]）。

结果> [{1,5},{11,13},{34,34},{56,58},{3415,3415}]

测试得到“漂亮”的字符串：

外壳>测试：group_to_string（[34,3415,56,58,57,11,12,13,1,2,3,3,4,5]）。

结果> ["1-5","11-13","34","56-58","3415"]

希望对你有帮助

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-01-04T18:56:25.853

VBA

```
Public Function convertListToRange(lst As String) As String
    Dim splLst() As String
    splLst = Split(lst, ",")
    Dim x As Long
    For x = 0 To UBound(splLst)
        Dim groupStart As Integer
        groupStart = splLst(x)
        Dim groupEnd As Integer
        groupEnd = groupStart
        Do While (x <= UBound(splLst) - 1)
            If splLst(x) - splLst(x + 1) <> -1 Then Exit Do
            groupEnd = splLst(x + 1)
            x = x + 1
        Loop
        convertListToRange = convertListToRange & IIf(groupStart = groupEnd, groupStart & ",", groupStart & "-" & groupEnd & ",")
    Next x
    convertListToRange = Left(convertListToRange, Len(convertListToRange) - 1)
End Function 
```

convertListToRange("1,2,3,7,8,9,11,12,99,100,101")
返回："1-3,7-9,11-12,99-101"

# c++ - 在 C/C++ 中进行数学运算时，我应该对哪些变量进行类型转换？

> ID：245740
> 
> 赞同：20
> 
> 时间：2008-10-29T03:55:06.777
> 
> 标签：c++, c, casting

例如，当我将两个整数相除并希望返回一个浮点数时，我迷信地写了这样的东西：

```
int a = 2, b = 3;
float c = (float)a / (float)b; 
```

如果我不强制转换`a`并`b`浮动，它将进行整数除法并返回一个 int。

同样，如果我想将带符号的 8 位数字与无符号的 8 位数字相乘，我会在相乘之前将它们转换为有符号的 16 位数字，以免溢出：

```
u8 a = 255;
s8 b = -127;
s16 = (s16)a * (s16)b; 
```

当根本不进行转换或仅转换其中一个变量时，编译器在这些情况下的行为究竟如何？我真的需要显式地转换所有变量，或者只是左边的一个，还是右边的那个？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-29T06:42:47.827

### 问题一：浮点除法

```
int a = 2, b = 3;
float c = static_cast<float>(a) / b;  // need to convert 1 operand to a float 
```

### 问题 2：编译器的工作原理

要记住的五个经验法则：

*   算术运算总是对相同类型的值执行。
*   结果类型与操作数相同（提升后）
*   对 int 执行的最小类型算术运算。
*   ANSCI C（以及 C++）使用值保留整数提升。
*   **每个操作都是独立完成的**。

ANSI C 规则如下：
这些规则中的大多数也适用于 C++，尽管并非所有类型都得到官方支持（目前）。

*   如果任一操作数是**long double**，则另一个操作数将转换为**long double**。
*   如果任一操作数是**double**，则另一个操作数将转换为**double**。
*   如果任一操作数是**浮点数**，则另一个操作数将转换为**浮点数**。
*   如果任一操作数是**unsigned long long**，则另一个操作数将转换为**unsigned long long**。
*   如果任一操作数是**long long**，则另一个操作数将转换为**long long**。
*   如果任一操作数是**unsigned long**，则另一个操作数将转换为**unsigned long**。
*   如果任一操作数为**long**，则将另一个操作数转换为**long**。
*   如果任一操作数是**unsigned int**，则另一个操作数将转换为**unsigned int**。
*   **否则，两个**操作数都将转换为**int**。

### 溢出

溢出总是一个问题。笔记。结果的类型与输入操作数相同，因此所有操作都可能溢出，所以是的，您确实需要担心它（尽管该语言没有提供任何明确的方法来捕捉这种情况。

附带说明：
无符号除法不能溢出，但有符号除法可以。

```
std::numeric_limits<int>::max() / -1  // No Overflow
std::numeric_limits<int>::min() / -1  // Will Overflow 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-29T04:25:27.027

通常，如果操作数属于不同类型，编译器会将所有操作数提升为最大或最精确的类型：

```
如果一个数字是……而另一个是……编译器将提升为……
------------------- -------- ------------ ------------------
char int int
有符号 无符号 无符号
char 或 int float 浮点数
浮动双双

```

例子：

```
字符 + 整数 ==> 整数
有符号整数 + 无符号字符 ==> 无符号整数
浮点数 + 整数 ==> 浮点数

```

但请注意，该提升仅在每个中间计算所需时发生，因此：

```
4.0 + 5/3 = 4.0 + 1 = 5.0
```

这是因为首先执行整数除法，然后将结果提升为浮点数以进行加法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-29T04:02:00.477

你可以只施放其中一个。不过不管是哪一个。

每当类型不匹配时，“较小”类型会自动提升为“较大”类型，浮点比整数类型“更大”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-29T04:01:29.230

整数除法：强制转换任何一个操作数，不需要同时转换它们。如果两个操作数都是整数，则除法运算为整数除法，否则为浮点除法。

至于溢出问题，无需显式转换，因为编译器会为您隐式执行此操作：

```
#include <iostream>
#include <limits>

using namespace std;
int main()
{
    signed int a = numeric_limits<signed int>::max();
    unsigned int b = a + 1; // implicit cast, no overflow here
    cout << a << ' ' <<  b << endl;
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T04:02:52.673

在浮点除法的情况下，只要一个变量是浮点数据类型（float 或 double），那么另一个变量应该扩展为浮点类型，并且应该发生浮点除法；所以没有必要将两者都转换为浮点数。

话虽如此，无论如何，我总是将两者都转换为浮动。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-29T04:04:39.393

我认为只要您只转换两个变量之一，编译器就会正常运行（至少在我知道的编译器上）。

所以所有的：

浮动 c = (浮动)a / b;

浮动 c = a / (float)b;

浮动 c = (float)a / (float)b;

将有相同的结果。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-29T05:45:34.900

还有一些像我这样的大脑受损的人，他们不得不使用老式的语言，只是不假思索地写出类似的东西

```
int a;
int b;
float z;

z = a*1.0*b; 
```

当然这不是通用的，仅适用于这种情况。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-29T05:48:01.963

在从事安全关键系统工作后，我倾向于偏执并总是同时考虑两个因素：float(a)/float(b)——以防万一以后有一些微妙的陷阱计划咬我。无论编译器被认为有多好，无论官方语言规范中的细节定义多么明确。偏执狂：程序员最好的朋友！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-29T11:33:56.040

您需要铸造一侧或两侧吗？答案不是由编译器决定的。它必须知道确切的、精确的规则。相反，答案应该由稍后阅读代码的人来决定。仅出于这个原因，将双方都转换为相同的类型。隐式截断可能足够明显，因此强制转换可能是多余的。

例如这个cast float->int 是显而易见的。

```
int a = float(foo()) * float(c); 
```

# c++ - C 或 C++ 中好的 goto 示例

> ID：245742
> 
> 赞同：79
> 
> 时间：2008-10-29T03:58:30.967
> 
> 标签：c++, c, goto

在这个线程中，我们看一下`goto`在 C 或 C++ 中良好使用的示例。它的灵感来自人们投票赞成[的答案](https://stackoverflow.com/questions/244445/best-refactoring-for-the-dreaded-while-true-loop#244644)，因为他们认为我在开玩笑。

摘要（标签从原来的改变，使意图更加清晰）：

```
infinite_loop:

    // code goes here

goto infinite_loop; 
```

为什么它比替代品更好：

*   这是具体的。 `goto`是导致无条件分支的语言结构。替代方案取决于使用支持条件分支的结构，具有退化的始终为真条件。
*   标签记录了意图，没有额外的注释。
*   读者不必扫描 early `break`s 的介入代码（尽管没有原则的黑客仍然可以 `continue`使用 early进行模拟`goto`）。

**规则：**

*   假装gotophobes没有赢。据了解，以上内容不能在实际代码中使用，因为它违反了既定的习惯用法。
*   假设我们都听说过“Goto 被认为有害”并且知道 goto 可用于编写意大利面条式代码。
*   如果您不同意某个示例，请仅根据技术优点批评它（“因为人们不喜欢 goto”不是技术原因）。

让我们看看我们是否可以像成年人一样谈论这个问题。

**编辑**

这个问题现在似乎结束了。它产生了一些高质量的答案。感谢大家，尤其是那些认真对待我的小循环示例的人。大多数怀疑论者担心缺乏块范围。正如@quinmars 在评论中指出的那样，您始终可以在循环体周围放置大括号。我顺便指出`for(;;)`，`while(true)`也不要免费给你大括号（省略它们会导致令人烦恼的错误）。无论如何，我不会再在这件小事上浪费你的脑力——我可以忍受无害和惯用的`for(;;)`和`while(true)`（如果我想保住工作也一样）。

考虑到其他回应，我看到许多人认为`goto`你总是必须以另一种方式重写。当然你可以`goto`通过引入一个循环、一个额外的标志、一堆嵌套`if`的 s 或其他什么来避免 a，但是为什么不考虑是否`goto`可能是这项工作的最佳工具呢？换句话说，人们准备忍受多少丑陋以避免将内置语言功能用于其预期目的？我的看法是，即使添加一面旗帜也付出了高昂的代价。我喜欢我的变量来代表问题或解决方案域中的事物。'仅仅为了避免`goto`'并没有削减它。

我会接受第一个答案，它给出了用于分支到清理块的 C 模式。IMO，这为`goto`所有已发布的答案提供了最有力的案例，当然，如果您通过扭曲来衡量它，那么仇恨者必须通过这些扭曲来避免它。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2008-10-29T04:08:39.463

这是我听说人们使用的一个技巧。不过我从来没有在野外见过它。它仅适用于 C，因为 C++ 具有 RAII 可以更惯用地执行此操作。

```
void foo()
{
    if (!doA())
        goto exit;
    if (!doB())
        goto cleanupA;
    if (!doC())
        goto cleanupB;

    /* everything has succeeded */
    return;

cleanupB:
    undoB();
cleanupA:
    undoA();
exit:
    return;
} 
```

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2008-10-29T04:31:43.787

C中GOTO的经典需求如下

```
for ...
  for ...
    if(breakout_condition) 
      goto final;

final: 
```

没有 goto 就没有直接的方法来打破嵌套循环。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-10-29T04:07:39.293

这是我的非愚蠢示例（来自 Stevens APITUE），用于可能被信号中断的 Unix 系统调用。

```
restart:
    if (system_call() == -1) {
        if (errno == EINTR) goto restart;

        // handle real errors
    } 
```

另一种方法是退化循环。这个版本读起来像英语“如果系统调用被信号中断，请重新启动它”。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-10-29T04:08:23.723

如果 Duff 的设备不需要 goto，那么您也不需要！;)

```
void dsend(int count) {
    int n;
    if (!count) return;
    n = (count + 7) / 8;
    switch (count % 8) {
      case 0: do { puts("case 0");
      case 7:      puts("case 7");
      case 6:      puts("case 6");
      case 5:      puts("case 5");
      case 4:      puts("case 4");
      case 3:      puts("case 3");
      case 2:      puts("case 2");
      case 1:      puts("case 1");
                 } while (--n > 0);
    }
} 
```

以上代码来自维基百科[条目](http://en.wikipedia.org/wiki/Duffs_device)。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-10-29T07:17:10.097

Knuth 写了一篇论文“Structured programming with GOTO statements”，你可以从[这里](http://pplab.snu.ac.kr/courses/adv_pl05/papers/p261-knuth.pdf)得到它。你会在那里找到很多例子。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-10-29T04:01:57.527

一般来说，我对 goto 没有任何反对意见，但我可以想到几个原因，为什么你不想像你提到的那样将它们用于循环：

*   它不限制范围，因此您在内部使用的任何临时变量直到稍后才会被释放。
*   它不限制范围，因此可能导致错误。
*   它不限制范围，因此您不能在以后的代码中在同一范围内重复使用相同的变量名。
*   它不限制范围，因此您有机会跳过变量声明。
*   人们不习惯它，它会使你的代码更难阅读。
*   这种类型的嵌套循环会导致意大利面条代码，法线循环不会导致意大利面条代码。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2008-10-29T04:18:02.097

很普通的。

```
do_stuff(thingy) {
    lock(thingy);

    foo;
    if (foo failed) {
        status = -EFOO;
        goto OUT;
    }

    bar;
    if (bar failed) {
        status = -EBAR;
        goto OUT;
    }

    do_stuff_to(thingy);

OUT:
    unlock(thingy);
    return status;
} 
```

我唯一用过的情况`goto`是向前跳跃，通常是跳出街区，从不进入街区。这避免了滥用`do{}while(0)`和其他增加嵌套的构造，同时仍保持可读的结构化代码。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-10-29T04:09:17.607

使用 goto 的一个好地方是在可以在多个点中止的过程中，每个点都需要不同级别的清理。Gotophobes 总是可以用结构化代码和一系列测试来替换 goto，但我认为这更直接，因为它消除了过多的缩进：

```
如果（！openDataFile（））
  退出；

如果（！getDataFromFile（））
  转到关闭文件并退出；

if (!allocateSomeResources)
  转到免费资源并退出；

// 在这里做更多的工作....

freeResourcesAndQuit：
   // 释放资源
关闭文件并退出：
   // 关闭文件
辞职：
   // 辞职！

```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-10-29T04:15:40.683

@fizzer.myopenid.com：您发布的代码片段相当于以下内容：

```
 while (system_call() == -1)
    {
        if (errno != EINTR)
        {
            // handle real errors

            break;
        }
    } 
```

我绝对喜欢这种形式。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-10-29T05:07:00.720

尽管随着时间的推移我越来越讨厌这种模式，但它已经根植于 COM 编程中。

```
#define IfFailGo(x) {hr = (x); if (FAILED(hr)) goto Error}
...
HRESULT SomeMethod(IFoo* pFoo) {
  HRESULT hr = S_OK;
  IfFailGo( pFoo->PerformAction() );
  IfFailGo( pFoo->SomeOtherAction() );
Error:
  return hr;
} 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-10-29T04:01:13.160

这是一个很好的 goto 示例：

```
// No Code 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-29T11:09:54.527

我已经看到 goto 使用正确，但情况通常很丑陋。只有当它`goto`本身的使用比原来的差很多时。@Johnathon Holland 问题是你的版本不太清楚。人们似乎害怕局部变量：

```
void foo()
{
    bool doAsuccess = doA();
    bool doBsuccess = doAsuccess && doB();
    bool doCsuccess = doBsuccess && doC();

    if (!doCsuccess)
    {
        if (doBsuccess)
            undoB();
        if (doAsuccess)
            undoA();
    }
} 
```

我更喜欢这样的循环，但有些人更喜欢`while(true)`.

```
for (;;)
{
    //code goes here
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-29T04:11:44.793

我对此的抱怨是你失去了块范围；如果循环中断，则在 goto 之间声明的任何局部变量仍然有效。（也许您假设循环永远运行；不过，我认为这不是最初的问题作者要问的。）

作用域的问题更多地是 C++ 的问题，因为某些对象可能取决于它们的 dtor 在适当的时间被调用。

对我来说，使用 goto 的最佳理由是在多步骤初始化过程中，如果一个失败，所有初始化都退出是至关重要的，例如：

```
if(!foo_init())
  goto bye;

if(!bar_init())
  goto foo_bye;

if(!xyzzy_init())
  goto bar_bye;

return TRUE;

bar_bye:
 bar_terminate();

foo_bye:
  foo_terminate();

bye:
  return FALSE; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-29T05:53:48.753

我自己不使用 goto，但是我曾经与一个在特定情况下会使用它们的人一起工作。如果我没记错的话，他的理由是围绕性能问题——他也有具体的*规则*。始终在同一个函数中，并且标签始终位于 goto 语句的下方。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-01-09T21:58:52.753

```
#include <stdio.h>
#include <string.h>

int main()
{
    char name[64];
    char url[80]; /*The final url name with http://www..com*/
    char *pName;
    int x;

    pName = name;

    INPUT:
    printf("\nWrite the name of a web page (Without www, http, .com) ");
    gets(name);

    for(x=0;x<=(strlen(name));x++)
        if(*(pName+0) == '\0' || *(pName+x) == ' ')
        {
            printf("Name blank or with spaces!");
            getch();
            system("cls");
            goto INPUT;
        }

    strcpy(url,"http://www.");
    strcat(url,name);
    strcat(url,".com");

    printf("%s",url);
    return(0);
} 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2008-10-29T04:15:06.610

@格雷格：

为什么不这样做：

```
void foo()
{
    if (doA())
    {    
        if (doB())
        {
          if (!doC())
          {
             UndoA();
             UndoB();
          }
        }
        else
        {
          UndoA();
        }
    }
    return;
} 
```

# sql-server - 如何以编程方式创建列名/描述符

> ID：245747
> 
> 赞同：1
> 
> 时间：2008-10-29T04:01:33.033
> 
> 标签：sql-server

在 SQL Server 给定的表/视图中，您如何生成表单中的表/视图的定义：

> C1 int、
> C2 varchar(20)、
> C3 双精度

执行此操作所需的信息包含在 SQL Server 的元表中，但是否有标准脚本/IDE 工具以上述形式输出其中包含的数据？

对于好奇的我想要这个，因为我必须维护一些包含 Table 对象的 SP（这是 SQL Server 使用的一种临时表形式）。Table 对象需要与数据库中已有的 Tables 或 Views 的定义相匹配——如果这些定义可以自动生成，将会变得更加容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T11:12:22.870

以下是列出表中列的名称和类型的示例：

```
select 
    COLUMN_NAME, 
    COLUMN_DEFAULT, 
    IS_NULLABLE, 
    DATA_TYPE, 
    CHARACTER_MAXIMUM_LENGTH, 
    NUMERIC_PRECISION, 
    NUMERIC_SCALE
from 
    INFORMATION_SCHEMA.COLUMNS
where 
    TABLE_NAME = 'YOUR_TABLE_NAME_HERE' 
order by 
    Ordinal_Position 
```

从该信息生成 DDL 更加困难。[SQLTeam](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=53007)似乎有一些建议

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T06:07:19.473

如果要复制表定义，可以使用：

```
select top 0
  *
into
  newtable
from
  mytable 
```

编辑：对不起，只是重新阅读您的问题，并意识到这可能无法回答。你能清楚你在做什么，你想要一个完全重复的表定义，还是一个包含关于表定义信息的表？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T22:28:11.477

感谢您的回复。是的，我确实想要 DDL 的精确副本，但我意识到我错误地陈述了我所需要的。它是 DDL，它将创建一个与视图的列匹配的临时表。

我在查看 Duckworths 的建议时意识到了这一点——这很好，但不幸的是没有涵盖视图的情况。

> 从 INFORMATIONSCHEMA.VIEWS 中选择 VIEWDEFINITION

...将为您提供视图中的列列表，并且（假设视图中的所有列都直接从表中派生）然后应该可以使用 Duckworths 建议的修订版本将相关 DLL 组合在一起。

我只是很惊讶这并不容易！我期待有人告诉我，鉴于 TABLE 对象需要完全定义所有列（而不是 Oracle 这样做的方式，也就是说 - “给我一些看起来像表 X ”。

无论如何，再次感谢您的帮助，欢迎任何进一步的建议。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T22:53:27.150

在[这个发布](https://stackoverflow.com/questions/181909/tool-for-scripting-table-data#181942)到另一个问题的帖子中，我有一个数据库逆向工程脚本，它将执行表、视图、PK、UK 和索引定义以及外键。这个是针对 SQL Server 2005 的，是我最初为 SQL Server 2000 编写的一个端口。如果您需要 SQL Server 2000 版本，请在这篇文章中添加评论，我会在此处发布。

# sql - 如何计算 SQL 查询中已经使用过 count、group by 和 have 的行数？

> ID：245765
> 
> 赞同：5
> 
> 时间：2008-10-29T04:09:37.777
> 
> 标签：sql, count

例如，使用这个问题的答案：

[如何选择提交超过 10 次](https://stackoverflow.com/questions/152024/how-to-select-all-users-who-made-more-than-10-submissions) 的所有用户 “如何选择提交超过 10 次的所有用户。”

```
select userId
from submission   
group by userId
having count(submissionGuid) > 10 
```

假设现在我想知道这条 sql 语句输出的行数。计算行数的解决方案的可扩展性如何？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-29T04:20:31.373

先前发布的示例中的小错误，需要子查询的表名的别名：

```
 select count(*) from
  (select userId
   from submission 
   group by userId
   having count(submissionGuid) > 10) t 
```

我不确定可扩展性，但这是解决方案。如果这对您来说扩展性不够好，您需要考虑重大的设计更改，例如可能跟踪那些在一个单独的表中提交超过 10 个提交的人，您通过填充提交的应用程序更新该表格。或许多其他可能的解决方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-29T04:15:19.153

嵌套查询：

```
select count(*) from
  (select userId
   from submission   
   group by userId
   having count(submissionGuid) > 10) n 
```

编辑以合并 mbrierst 关于嵌套子查询需要别名（末尾的“n”）的评论。Oracle 不需要，但 SQL Server 需要。随意添加有关其他数据库平台使用情况的评论。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-29T04:11:37.633

在 SQL Server 中你可以做

```
select @@ROWCOUNT 
```

紧跟在您发布的查询之后。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-08T08:09:28.133

你可以试试这个方法：我希望能帮助你。 `select top(1) row_number() over(partition by count(userId) order by count(userId)) as RowNumber from submission group by userId having count(submissionGuid) > 10 order by userId desc`

# web-applications - 当浏览器中的页面加载被取消时，服务器会发生什么？

> ID：245766
> 
> 赞同：5
> 
> 时间：2008-10-29T04:10:28.430
> 
> 标签：web-applications

在一个虚构的 Web 应用程序中...

1.  用户点击链接
2.  服务器开始准备响应，但需要几秒钟
3.  用户取消页面加载

请求会发生什么？服务器是否继续准备响应？响应是否到达浏览器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-29T04:26:29.803

服务器将继续准备响应。当它尝试向客户端发送响应时，它会失败。这实际发生的时间可能取决于实际的应用程序服务器实现，响应是否被缓冲等。

在 Java EE 应用服务器（Tomcat 和 WebLogic，可能还有其他服务器）中，您将收到以下异常：

```
java.net.SocketException: Connection reset by peer: socket write error 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T04:34:25.450

PHP 理解连接的三种状态：NORMAL、ABORTED 和 TIMEOUT。[您可以使用ignore_user_abort()](http://www.php.net/ignore_user_abort)函数更改 PHP 关于 ABORTED 连接的策略（默认情况下，脚本被终止） 。从**注释**部分：

“在尝试向客户端发送信息之前，PHP 不会检测到用户已中止连接。”

请注意，如果您的服务器的输出被缓冲，发送可能不会立即发生。

See [PHP's page on connection handling](http://au.php.net/manual/en/features.connection-handling.php) for more details.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T04:50:27.647

If the connection was broken before the request was completely sent to the server, the response processing won't occur.

If the request was sent completely, this triggers the server-side processing, and the response generation will continue despite the broken connection.

In ASP.NET, you can detect this by using Response.IsClientConnected to halt the processing if the client is not connected anymore, saving CPU time and returning the thread immediately to the thread pool.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T04:18:03.097

我认为实际的 TCP 连接已被浏览器关闭，因此 Web 服务器将无法发送数据，除非专门对其进行编程以在准备数据时检测断开的连接，否则页面将被完全处理，即使用户取消。

虽然我对这些事情知之甚少，但这是我的猜测。

# javascript - 滚动浏览器窗口以扩展元素的最佳方式是什么？

> ID：245768
> 
> 赞同：0
> 
> 时间：2008-10-29T04:10:49.320
> 
> 标签：javascript, window, scroll

我想要做的是在我展开页面中的元素时向下滚动窗口。

我想要达到的效果就像 Stack Overflow 的评论。如果它扩展到页面之外，它会向下滚动以适应窗口中的所有评论。

这样做的最佳方法是什么？

编辑：我正在使用 JQuery。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T03:44:17.850

这个 jQuery 插件对我很有效：http: [//demos.flesler.com/jquery/scrollTo/](http://demos.flesler.com/jquery/scrollTo/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T04:15:39.700

如果你有使用 Prototype 的优势，你可以使用`$(element).scrollTo()`.

否则，一般的想法是计算元素的累积偏移量，然后相应地设置`window.scrollTop`(and `window.scrollLeft`)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T12:38:10.027

[您可以使用Scriptaculous （建立在](http://script.aculo.us/)[Prototype](http://prototypejs.org)之上）很好地做到这一点：

```
new Effect.ScrollTo('someDiv',{...some parameters...}) 
```

它为您提供比 Prototype 单独的更好的控制（延迟开始前、持续时间和回调事件（例如 afterFinish），允许您触发其他效果或您选择的任何内容。您可以使其平滑流畅地滚动，因此页面不会突然跳。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T21:48:51.927

如果您知道源代码中的下一个元素是什么，您实际上可以直接跳转到该元素（location.href="#..."）。这将使用浏览器的本机“滚动”而不使用任何库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T22:09:31.137

您可以使用此代码，这还可以，但并不完美。根据 blonkm 的建议

```
function scrollTo( Selector ){
  $(Selector).before("<a name='scroll' id='scroll'></a>");
  document.location.hash = 'scroll';
  $('scroll').remove();
} 
```

这应该有效。需要 jQuery，但您已经说过您正在使用它。

# mfc - Direct3D MDI 项目：MFC 还是 .NET？

> ID：245772
> 
> 赞同：1
> 
> 时间：2008-10-29T04:13:14.073
> 
> 标签：mfc, direct3d

我正在研究一个新项目，其中 Native 和 Managed 方法听起来都是个好主意。这是一个应支持 MDI 接口的 Windows 桌面应用程序。客户区将广泛使用 Direct3D。该项目的开发人员同样精通 C#、C++/CLI 和 MFC。

MFC 优势：

*   文档/视图架构
*   大多数 Direct3D 在线资源仍然使用 C++

托管代码优势：

*   .NET 框架
*   C＃

我还能在上面的列表中添加什么？不要烧这个。两个清单。只需添加它们即可。

注意：我有很好的理由（与 IDE 和调试有关）不使用混合模式。所以算了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T21:38:59.400

为什么不两者都用？

您可以使用 C#/VB.NET 编写 UI（表单）并使用 C++ 呈现窗口。

基本上，您需要做的就是将 HWND（窗口句柄）从 C# 传递到 C++，并使用该值初始化 C++。

你可以在我的博客上看到一个例子：[How-to Render managed (.NET) form using native DirectX](http://blogs.microsoft.co.il/blogs/dhelper/archive/2008/11/24/how-to-render-managed-net-form-using-native-directx.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T04:24:41.303

这不会直接添加到任一列表中，但当前使用 .NET 进行 3D 的“推荐”方式是使用 XNA - 托管 DirectX 已被弃用。

编辑：当然，WPF 3D 也是一种选择！忘记了：}

# user-interface - 图结构（在 CS 意义上的图、节点、边）的（Web）用户界面的一个很好的例子是什么？

> ID：245783
> 
> 赞同：3
> 
> 时间：2008-10-29T04:18:41.020
> 
> 标签：user-interface, graph-theory

比如说，假设我有一个树形结构，那么我自然会使用一个树形控件，因为该 GUI 元素完美地映射到该结构。

但我所拥有的是一个图表，可能太宽而无法放入一个网页。我想不出真正匹配结构的 GUI 示例。我有一些不太合适的想法是，网络本身，带有超链接、浏览器后退按钮和前进按钮。但这一次只显示一个节点。我想尽可能多地显示节点，并允许导航到图表的新区域。像谷歌地图这样的东西可能是一个很好的模型，因为你可以完全自由地向任何方向滚动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T04:26:47.650

*Facebook 过去常常这样*做，以可视化您的朋友。正如预期的那样，他们将节点绘制成小盒子，用线连接它们。他们将图形绘制成 SVG 图像，因此您可以轻松放大和缩小。

另一种选择可能是绘制`<canvas>`标签并以某种方式对其进行缩放。我想这是可能的，但我不太了解`<canvas>`

另一种选择是将其绘制到内联框架或其他允许用户水平和垂直滚动的框中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T05:43:39.257

对于由小区域显示的巨大图形的一个很好的动态示例，您可以查看：[Visuwords](http://www.visuwords.com/)。它们将自己呈现为一个图形字典，显示单词之间的多个链接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T05:50:45.170

我认为没有一个现有的小部件可以满足您的需求，就像树控件适合树结构一样。

也就是说，我绝对推荐[其中一款 yWorks](http://www.yworks.com/en/index.html)产品。

通过尝试 yEd 来了解它的功能，然后查看看起来非常好的文档。他们还为他们的库提出了一个 ajax 和 flex 前端，这将为您提供与 Web 兼容的表示，包括像拖放一样的谷歌地图，请参阅图形查看器演示： http: [//live.yworks.com/yfiles-ajax/Examples/Graph_Viewer .html](http://live.yworks.com/yfiles-ajax/Examples/Graph_Viewer.html) ) 我不为他们工作，我什至不是付费客户，但 yEd 给我留下了深刻的印象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-29T04:49:01.707

基本上我见过的最好的东西是Flash或Java，它可以让你拖动节点，它会根据边缘的张力值自动拉伸、移动、扩展。

简要谷歌揭示[了这一点](http://www.yworks.com/en/products_yfilesajax_about.html)。我尝试了 Java 应用程序版本，似乎可以在基本级别上工作，但对于您的需求来说可能有点过分了。:) 检查 AJAX 版本，也许？

也许查看[使用 jQuery 拖动的方法](http://www.google.com/search?q=jquery+drag)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T05:35:43.800

[GraphViz](http://www.graphviz.org/)是我见过的最好的。[在桌面和网络上工作，这里](http://www.graphviz.org/Resources.php)有很多例子。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T21:14:21.917

你可以试试[prefuse](http://prefuse.org/)。它是一个开源的交互式数据可视化工具包。它有一个非常好的布局集合，可用于显示节点图以及其他可视化效果。该工具包有两种不同的风格，一种是 Java，另一种是 Actionscript，可用于 Flash/Flex。

# jython - Jython - javaos.getenv() 给出“获取环境失败，环境将为空”

> ID：245787
> 
> 赞同：3
> 
> 时间：2008-10-29T04:20:32.920
> 
> 标签：jython

每当我在 Eclipse 中运行任何 jython 程序时，在输出的开头都会出现以下错误：

> " 获取环境失败, environ 将为空: (0, 'Failed to execute command ([\'sh\', \'-c\', \'env\']): java.io.IOException: 无法运行程序“sh”：创建进程错误=2，系统找不到指定的文件'）

首先，我的环境是：

视窗 2008

JDK 1.6.0u10

jython 2.2.1

我做了一些挖掘，我意识到这条消息是在函数 javaos.getenv() 中产生的。每当我调用 javaos.getenv() 函数时，它都会引发以下错误：

C:\jython2.2.1>java -jar jython.jar

> > > 导入 javaos
> > > 
> > > 打印 javaos.getenv("user.name")
> 
> 获取环境失败，environ将为空：(0, 'Failed to execute command ([\'sh\', \'-c\', \'env\']): java.io.IOException: Cannot run program "sh": CreateProcess error=2, 系统找不到指定的文件')

这很奇怪，因为我目前使用的是 Windows 机器，而不是 Unix。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-29T09:05:12.377

尝试取消注释并更改“注册表”文件中的操作系统设置

（它与您的 jython.jar / 我希望位于同一目录中）

```
# python.os determines operating-specific features, similar to and overriding the
# Java property "os.name".
# Some generic values are also supported: 'nt', 'ce' and 'posix'.
# Uncomment the following line for the most generic OS behavior available.
#python.os=None
python.os=nt
# try nt or dos 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T05:16:40.963

有趣的。好吧，我似乎在这里找到了相关代码： [http://www.koders.com/python/fid4B7C33153C1427D2CE19CE361EA9519D1652F802.aspx?s=self](http://www.koders.com/python/fid4B7C33153C1427D2CE19CE361EA9519D1652F802.aspx?s=self)

如果您向下看，似乎在设置环境命令时 jython 认为您的操作系统是 posix。您说您使用的是“Windows 2008”。我不确定那是什么。你的意思是Windows Server 2008？如果是这样，它是相当新的，如果您查看同一模块中的 _getOsType 函数，它看起来对于该模块来说可能太新了。您可能需要升级到最新版本的 jython 或 Eclipse。但很有可能他们还没有发布支持这个操作系统的版本。如果是这种情况，您可能只需要向他们报告错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-25T21:20:37.973

我在 Windows 7 上运行。我在 Websphere wsadmin 工具中将 Jython 作为脚本运行。我遇到了同样的错误。我将 javaos.py 中的这些行剪切并粘贴到我的脚本中：os 或 sys.registry.getProperty("python.os") 或 \java.lang.System.getProperty("os.name") 并返回“ Windows Vista”。所以我执行了与上面建议的相同的手术，即将 Windows Vista 添加到 javaos.py 并解决了我的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-25T17:42:54.877

我遇到了同样的错误，在 Eclipse/PyDev 下使用 Windows Vista 和 Jython 2.5.1 通过编辑 javaos.py，在 getOsType 的 OR 语句中包含“Windows Vista”；我修复了错误。（我在 SourceForge 的 PyDev Tracker 下提交了一个修复错误。）

细节：

我安装了完整版的 Jython，但没有帮助。我还尝试编辑 Jython 树中的“注册表”文件。那也没有帮助。

然后我查看了以下文件：

`C:\eclipse-platform-3.5-win32\eclipse\plugins\org.python.pydev.jython_1.4.8.2881\Lib`

找到“javaos.py”并添加一些代码来阅读：

```
def _getOsType( os=None ):
   os = os or sys.registry.getProperty( "python.os" ) or \
               java.lang.System.getProperty( "os.name" )

_osTypeMap = (
    ( "nt", r"(nt)|(Windows NT)|(Windows NT 4.0)|(WindowsNT)|"
            r"(Windows 2000)|(Windows XP)|(Windows CE)|(Windows Vista)" ),
    ( "dos", r"(dos)|(Windows 95)|(Windows 98)|(Windows ME)" ),
    ( "mac", r"(mac)|(MacOS.*)|(Darwin)" ),
    ( "None", r"(None)" ),
    ( "posix", r"(.*)" ), # default - posix seems to vary mast widely
    )
for osType, pattern in _osTypeMap:
    if re.match( pattern, os ):
        break
return osType 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-02T16:22:11.603

我使用了 Dave Brands 博客中的这个技巧：http: [//dbrand666.wordpress.com/2010/04/08/fix1/](http://dbrand666.wordpress.com/2010/04/08/fix1/)

```
try:
    import javaos
    if javaos._osType == 'posix' and \
            java.lang.System.getProperty('os.name').startswith('Windows'):
        sys.registry.setProperty('python.os', 'nt')
        reload(javaos)
except:
    pass 
```

# python - 什么时候不适合使用 python 生成器？

> ID：245792
> 
> 赞同：89
> 
> 时间：2008-10-29T04:25:02.957
> 
> 标签：python, optimization, iterator, generator

这与[您可以使用 Python 生成器函数做什么？](https://stackoverflow.com/questions/102535/what-can-you-use-python-generator-functions-for): python 生成器、生成器表达式和`itertools`模块是我最近最喜欢的 python 功能。它们在设置操作链以对大量数据执行时特别有用——我经常在处理 DSV 文件时使用它们。

**那么什么时候*不*适合使用生成器、生成器表达式或`itertools`函数呢？**

*   我应该什么时候更喜欢`zip()`，`itertools.izip()`或者
*   `range()`超过`xrange()`, 或
*   `[x for x in foo]`结束了`(x for x in foo)`？

显然，我们最终需要将生成器“解析”为实际数据，通常是通过创建一个列表或使用非生成器循环对其进行迭代。有时我们只需要知道长度。这不是我要问的。

我们使用生成器，这样我们就不会为临时数据分配新列表到内存中。这对于大型数据集尤其有意义。它对小型数据集也有意义吗？是否存在明显的内存/cpu 权衡？

[鉴于列表理解性能与 map() 和 filter()](http://www.gossamer-threads.com/lists/python/python/76267)的令人大开眼界的讨论，如果有人对此进行了一些分析，我特别感兴趣。（[替代链接](https://mail.python.org/pipermail//python-list/2001-December/096256.html)）

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2014-10-29T16:36:57.670

**在以下情况下使用列表而不是生成器：**

1）您需要多次访问数据**（**即缓存结果而不是重新计算它们）：

```
for i in outer:           # used once, okay to be a generator or return a list
    for j in inner:       # used multiple times, reusing a list is better
         ... 
```

2）您需要**随机访问**（或除前向顺序之外的任何访问）：

```
for i in reversed(data): ...     # generators aren't reversible

s[i], s[j] = s[j], s[i]          # generators aren't indexable 
```

3）您需要**连接**字符串（这需要两次传递数据）：

```
s = ''.join(data)                # lists are faster than generators in this use case 
```

4) 您正在使用**PyPy**，它有时无法像普通函数调用和列表操作那样优化生成器代码。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-10-29T04:42:05.870

一般来说，当你需要列表操作时不要使用生成器，比如 len()、reversed() 等。

有时您可能不希望延迟评估（例如，预先进行所有计算，以便您可以释放资源）。在这种情况下，列表表达式可能会更好。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-10-29T11:37:31.913

简介，简介，简介。

分析您的代码是了解您正在做的事情是否有任何影响的唯一方法。

xrange、生成器等的大多数用法都超过了静态大小的小数据集。只有当您处理大型数据集时，它才会真正发挥作用。range() 与 xrange() 主要只是让代码看起来更丑一点，并且不会丢失任何东西，并且可能会获得一些东西。

简介，简介，简介。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-10-29T04:28:58.643

您永远不应该偏爱[`zip`](http://docs.python.org/2/library/functions.html#zip)over [`izip`](http://docs.python.org/2/library/itertools.html#itertools.izip)、`range`over`xrange`或 list 推导而不是生成器推导。在 Python 3.0中，`range`有`xrange`-like 语义和-like 语义。`zip``izip`

列表推导实际上更清晰，就像`list(frob(x) for x in foo)`您需要一个实际列表的时候一样。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-29T08:50:47.117

正如您提到的，“这对大型数据集尤其有意义”，我认为这回答了您的问题。

如果您在性能方面没有遇到任何问题，您仍然可以坚持使用列表和标准功能。然后，当您遇到性能问题时，请进行切换。

然而，正如@u0b34a0f6ae 在评论中提到的那样，在开始时使用生成器可以让您更轻松地扩展到更大的数据集。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-01T05:53:31.667

关于性能：如果使用 psyco，列表可能比生成器快很多。在下面的示例中，使用 psyco.full() 时，列表的速度几乎快 50%

```
import psyco
import time
import cStringIO

def time_func(func):
    """The amount of time it requires func to run"""
    start = time.clock()
    func()
    return time.clock() - start

def fizzbuzz(num):
    """That algorithm we all know and love"""
    if not num % 3 and not num % 5:
        return "%d fizz buzz" % num
    elif not num % 3:
        return "%d fizz" % num
    elif not num % 5:
        return "%d buzz" % num
    return None

def with_list(num):
    """Try getting fizzbuzz with a list comprehension and range"""
    out = cStringIO.StringIO()
    for fibby in [fizzbuzz(x) for x in range(1, num) if fizzbuzz(x)]:
        print >> out, fibby
    return out.getvalue()

def with_genx(num):
    """Try getting fizzbuzz with generator expression and xrange"""
    out = cStringIO.StringIO()
    for fibby in (fizzbuzz(x) for x in xrange(1, num) if fizzbuzz(x)):
        print >> out, fibby
    return out.getvalue()

def main():
    """
    Test speed of generator expressions versus list comprehensions,
    with and without psyco.
    """

    #our variables
    nums = [10000, 100000]
    funcs = [with_list, with_genx]

    #  try without psyco 1st
    print "without psyco"
    for num in nums:
        print "  number:", num
        for func in funcs:
            print func.__name__, time_func(lambda : func(num)), "seconds"
        print

    #  now with psyco
    print "with psyco"
    psyco.full()
    for num in nums:
        print "  number:", num
        for func in funcs:
            print func.__name__, time_func(lambda : func(num)), "seconds"
        print

if __name__ == "__main__":
    main() 
```

结果：

```
without psyco
  number: 10000
with_list 0.0519102208309 seconds
with_genx 0.0535933367509 seconds

  number: 100000
with_list 0.542204280744 seconds
with_genx 0.557837353115 seconds

with psyco
  number: 10000
with_list 0.0286369007033 seconds
with_genx 0.0513424889137 seconds

  number: 100000
with_list 0.335414877839 seconds
with_genx 0.580363490491 seconds 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-29T16:44:36.833

我从未发现发电机会阻碍您尝试做的事情的情况。然而，在很多情况下，使用生成器对你没有任何帮助，而不仅仅是不使用它们。

例如：

```
sorted(xrange(5)) 
```

不提供任何改进：

```
sorted(range(5)) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-01T23:49:09.560

如果您以后需要保留其他值并且集合的大小不太大，您应该更喜欢列表推导式。

例如：您正在创建一个列表，稍后您将在程序中循环多次。

在某种程度上，您可以将生成器视为迭代（循环）的替代品，而不是将列表推导视为一种数据结构初始化。如果要保留数据结构，请使用列表推导。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-29T11:44:06.313

就性能而言，我想不出任何时候你会想要在生成器上使用列表。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-05-27T17:36:53.053

生成器构建和可枚举的值列表。当迭代过程可以按需使用值时，可枚举项很有用。构建你的生成器需要时间，所以如果列表是数百万条记录，使用 sql server 处理 sql 中的数据可能更有用。

# linux - SSH、屏幕和 XDISPLAY

> ID：245798
> 
> 赞同：9
> 
> 时间：2008-10-29T04:29:09.093
> 
> 标签：linux, ssh, gnu-screen

我使用屏幕来保持我的工作会话并从多台机器连接到同一个会话。如何设置 SSH 和屏幕，以便我的持久屏幕会话中的 XDISPLAY 变量*始终*设置为我当前连接的机器？

IE。我在工作时启动屏幕会话并使用 gvim，它使用在我的工作机器上运行的 X 服务器。后来，我从家里连接到同一个会话，也想使用 gvim。但是这一次，我希望 gvim 使用我家机器上的 X 服务器。我意识到每次从不同的机器连接时我都可以手动更新 XDISPLAY，但我宁愿拥有一个自动化系统。

*如果我可以在运行时将*gvim 从我的工作机器移动到我的家用机器上，则可以获得奖励积分。我尝试[了 xmove](http://manpages.ubuntu.com/manpages/hardy/man1/xmove.html)，但永远无法让它发挥得很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-22T13:08:11.253

以下是手动解决方案，但是当您远程登录时，没有理由不能使用别名或脚本自动完成它。

假设您的本地 shell 适当地设置了 DISPLAY 变量，您可以`screen -X`在连接之前使用将以下命令发送到远程屏幕。

```
# set future remote shells started by screen to have the correct XDISPLAY
% screen -X "setenv XDISPLAY $DISPLAY" #...

# set up the keystroke F1 to update the XDISPLAY in current shells
% screen -X "bindkey -k k1 stuff export XDISPLAY=$DISPLAY\015" #... 
```

如果您知道您的所有窗口都留在了 shell（不是正在运行的编辑器或类似的）中，您可以使用`:at`更改`XDISPLAY`而不是键绑定：

```
# update the XDISPLAY in all current windows
% screen -X "at % stuff export XDISPLAY=$DISPLAY\015" #... 
```

或者，如果您知道某种获取父进程的环境变量值的方法，那么您可以将它与 shell 的提示挂钩一起使用来获取 SCREEN 的 XDISPLAY 值（由 setenv 设置）并为 shell 更新它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T07:31:21.177

没有“简单”的方法可以更改外部进程中的环境变量。

一个简单的解决方案可能是`XDISPLAY`在登录时将您保存到一个文件中，并`PROMPT_COMMAND`在打印下一个提示之前使用 a 来读取该文件。

* * *

要移动 X 应用程序，请查看类似[`X11vnc`](http://en.wikipedia.org/wiki/X11vnc)或[`Xvnc`](http://www.realvnc.com/products/free/4.1/man/Xvnc.html).

# oop - 面试期间用于编码测试的 OOP 问题

> ID：245800
> 
> 赞同：13
> 
> 时间：2008-10-29T04:31:42.257
> 
> 标签：oop

作为第二次面试，我让人们坐下来写代码……我试图让问题真正独立于技术。

我遇到的编程问题并没有真正锻炼人们的 OO 能力。我倾向于尝试在 2 小时内解决编码问题。因此，我一直在努力寻找一个足够小且涉及足够多的问题，以暴露人们的 OO 设计技能。

有什么建议么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-29T05:07:42.120

这是我在一些培训中使用的问题，看起来很简单，但在 OOP 方面很棘手：

创建将正确表示以下构造的模型类：

1.  定义一个 Shape 对象，该对象是任意二维图形，具有以下特征：名称、周长和表面积。
2.  定义一个Circle，保留并准确输出上述Shape的特征值。
3.  定义一个三角形。这一次，三角形的名称应该考虑它是等边的（所有 3 条边长度相同）、等腰线（只有 2 条边长度相同）或不等边（没有 2 条边长度相同）。

您可以继续使用四边形（包括正方形、矩形、菱形等）和其他多边形。

他们解决上述问题的方式将揭示了解 OOP 的人和不了解 OOP 的人。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-29T05:03:15.920

理想情况下，你想提出一个看起来很困难的问题，但*如果你用 OO 术语思考的话，它有一个简单、优雅、明显的解决方案*

也许：

*   我们需要控制对客户网站的访问
*   每个客户可能有一个或多个人访问该站点
*   来自不同客户的不同人可能能够查看网站的不同部分
*   同一个人可以为多个客户工作
*   客户希望根据人员、部门、团队或项目来管理权限

使用面向对象技术为此设计一个解决方案

* * *

一个 OO 解决方案是有一个人、一个客户、一个帐户和 AccountPermissions，其中帐户指定了一个人和一个客户以及一个可选的父帐户。递归 Account 对象的使用使原本繁琐的人员/团队/部门/项目结构崩溃，直接 ERD 解决方案可能会产生

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-29T05:07:03.310

我使用了[FizzBu​​zz Programming Test](http://www.codinghorror.com/blog/archives/000781.html)。并且令人震惊地可以证实文章的说法。作为第二次跟进，我要求候选人计算模拟时钟上指针之间的角度。我们设置了一台笔记本电脑，安装了 VS 2008 并且存根就位。他们所要做的就是填写执行。

我总是对候选人在这两个问题上的糟糕表现感到震惊。我真的是。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-29T07:11:37.083

设计社会保障应用程序是我在面试时问过很多人的问题。

这样做的好处是每个人都知道它是如何工作的以及要跟踪什么。他们还必须证明他们的设计是合理的，这真的有助于我进入他们的头脑:)（因为这里有很多灵活性）

亲切的问候，

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T20:25:18.587

Whether or not people do some coding in the interview, I make it a point to ask this: **Tell me about a problem you solved recently using object oriented programming.** You'd be surprised how often people cannot answer that simple question. A lot of times I get a blank stare, or they say something like "what do you mean? I program in .NET, which is all object oriented."

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-29T07:07:36.013

你可能比要求他们设计一个具有单进程实现的 MapReduce 库做得更糟。该接口仍然适用于分布式实现吗？异常处理策略是什么？是否应该特别支持在管道中链接 MapReduce 作业？输入和输出的接口是什么？输入是如何分块的？一项工作中的不同输入可以转到不同的映射器吗？什么默认值是合理的？

Python 中的一个好的解决方案大约需要一页代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-29T04:53:15.130

这些不是专门的 OO 问题，但请查看标记[为 interview-questions的其他问题](https://stackoverflow.com/questions/tagged/interview-questions)

编辑：如何实现一些[设计模式](http://en.wikipedia.org/wiki/Software_design_pattern)？我在该领域没有最好的知识，但似乎你会以一个的价格得到两个问题。您可以在一个问题中同时测试 OO 和设计模式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-29T05:50:52.347

某种简单的 GUI 怎么样。它有继承，覆盖，可能是事件。如果您的意思是让他们实际实施作为测试的一部分，那么您可以给他们一个带有 OnPaint() 的空白窗口窗体并告诉他们去做。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-29T05:01:42.460

我有一套超级简单的。这个想法主要是用它们来过滤*掉*那些真的不知道他们的东西的人，而不是过滤掉*摇滚*明星。

这些都是 5 分钟的白板式问题，所以它们真的没有那么难。但是编写代码并通过它进行交谈的行为揭示了很多关于候选人的信息——并且非常适合揭露那些本来可以通过谈话来胡说八道的人。

*   编写一个以圆的半径为参数的方法，并返回圆的面积（你会惊讶于有多少人在这个问题上苦苦挣扎！）
*   编写一个程序，从命令行接受一系列数字作为参数。将它们相加，并打印总和
*   编写一个充当键控计数器的类（基本上是一个跟踪每个键被“计数”多少次的映射）

# c - 使 fscanf 忽略可选参数

> ID：245802
> 
> 赞同：2
> 
> 时间：2008-10-29T04:32:21.820
> 
> 标签：c, scanf

我正在使用 fscanf 读取一个文件，该文件具有像
Number <-whitespace-> string <-whitespace-> optional_3rd_column 这样的行

我希望从每列中提取数字和字符串，但如果存在则忽略 3rd_column

示例数据：
12 foo something
03 bar
24 something #randomcomment

我想提取 12,foo; 03,酒吧; 24、某事而忽略“某事”和“#randomcomment”

我目前有类似的东西

```
while(scanf("%d %s %*s",&num,&word)>=2)
{ 
assign stuff 
} 
```

但是，这不适用于没有第 3 列的行。如何让它忽略第二个字符串之后的所有内容？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-29T05:02:12.430

问题是`%*s`当没有第三列时，下一行正在吃数字，然后下一个`%d`失败，因为下一个标记不是数字。`gets()`要在不使用后跟的情况下修复它`sscanf()`，可以使用指定的字符类：

```
while(scanf("%d %s%*[^\n]", &num, &word) == 2)
{ 
    assign stuff 
}
```

`[^\n]`说要匹配尽可能多的不是换行符的字符，并且像`*`以前一样抑制分配。另请注意，您不能在 the`%s`和之间放置空格`%*[\n]`，否则格式字符串中的空格将匹配换行符，导致`%*[\n]`匹配整个后续行，这不是您想要的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-29T04:36:27.537

使用 fgets() 一次读取一行，然后使用 sscanf() 查找您感兴趣的两列，更健壮，您无需执行任何特殊操作即可忽略尾随数据。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-29T04:44:27.830

在我看来，最简单的解决方案是 scanf("%d %s", &num, &word) 然后 fgets() 吃掉该行的其余部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T04:37:13.760

我经常在字符串上使用gets()，然后是sscanf()，呃，gots。

奖励：您可以将输入结束的测试与解析分开。

# java - 在带有 J2SE 6.0 的 Mac OS 上启动 Eclipse MAT 时，JVM 终止

> ID：245803
> 
> 赞同：0
> 
> 时间：2008-10-29T04:33:53.390
> 
> 标签：java, macos, jvm, memoryanalyzer

我最近发现了非常有用的[Eclipse 内存分析工具](http://www.eclipse.org/mat/)，它可以快速查找 Java 应用程序中的内存泄漏。不幸的是，在将我的 JDK 切换到 1.6（在 Mac OS 10.5 下）之后，JVM 在启动时立即终止。出现的只是一个对话框，用“退出代码 = -1”声明“JVM 已终止”。

还有人遇到这个吗？也许有一种方法可以将其配置为使用不同的 JDK？（例如 1.5：它被证明是兼容的）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T13:57:13.677

要将 Eclipse 配置为使用另一个 VM，请使用以下命令行：

```
eclipse -vm <path to java> 
```

您还可以在 Eclipse.app/Contents/Info.plist 中指定路径。有这样一段：

```
<!-- to use a specific Java version (instead of the platform's default) uncomment one of the following options:
    <string>-vm</string><string>/System/Library/Frameworks/JavaVM.framework/Versions/1.4.2/Commands/java</string>
    <string>-vm</string><string>/System/Library/Frameworks/JavaVM.framework/Versions/1.5.0/Commands/java</string>
--> 
```

对于内存分析器，您可以在 MemoryAnalyzer.app/Contents 下找到 Info.plist 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T09:15:18.660

Mac 的官方 Java 6 只有 64 位数据模型。不幸的是，Eclipse 在 Mac 上使用了 Carbon，它只提供 32 位版本。简而言之，使用官方 Java 6 发行版运行 Eclipse 是不可能的。

对此的经典解决方案是将默认 VM 设置为 Java 5，然后在 Eclipse 中选择 Java 6 作为 JRE/JDK。

如果你真的需要用 Java 6 运行 Eclipse，那么你可以看看[SoyLatte](http://landonf.bikemonkey.org/static/soylatte/)，它是 OpenJDK 的一个版本，它同时支持 32 位和 64 位模式。

# c# - InitializeComponent() 有什么作用，它在 WPF 中是如何工作的？

> ID：245825
> 
> 赞同：169
> 
> 时间：2008-10-29T04:48:37.277
> 
> 标签：c#, .net, wpf, attached-properties

有什么作用`InitializeComponent()`，它在 WPF 中是如何工作的？

一般来说，首先，但我特别想知道构造顺序的血腥细节，以及当有附加属性时会发生什么。

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2008-10-29T05:21:20.660

调用`InitializeComponent()`（通常在至少`Window`和的默认构造函数中`UserControl`调用）实际上是对控件的部分类的方法调用（而不是像我最初预期的那样调用对象层次结构）。

`Window`此方法为正在加载的/定位 XAML 的 URI `UserControl`，并将其传递给`System.Windows.Application.LoadComponent()`静态方法。`LoadComponent()`加载位于传入 URI 处的 XAML 文件，并将其转换为由 XAML 文件的根元素指定的对象的实例。

更详细地说，`LoadComponent`创建 的实例`XamlParser`，并构建 XAML 的树。每个节点都由`XamlParser.ProcessXamlNode()`. 这被传递给`BamlRecordWriter`班级。在此之后的一段时间，我对如何将 BAML 转换为对象有点迷茫，但这可能足以帮助您走上启蒙之路。

注意：有趣的`InitializeComponent`是， 是接口上的一个方法`System.Windows.Markup.IComponentConnector`，其中`Window`/`UserControl`在部分生成的类中实现。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-10-29T14:31:03.030

查看代码也总是有帮助。也就是说，您实际上可以通过执行以下操作来查看生成的部分类（调用**LoadComponent**）：

1.  转到您感兴趣的 Visual Studio 解决方案中的解决方案资源管理器窗格。
2.  解决方案资源管理器的工具栏中有一个按钮，标题为“显示所有文件”。切换该按钮。
3.  现在，展开**obj**文件夹，然后展开**Debug**或**Release**文件夹（或您正在构建的任何配置），您将看到一个名为*YourClass* .g.cs 的文件。

*YourClass* .g.cs ... 是生成的部分类的代码。同样，如果您打开它，您可以看到 InitializeComponent 方法以及它如何调用 LoadComponent ...等等。

# c# - 在 C# 中打开到文件描述符的管道连接

> ID：245827
> 
> 赞同：5
> 
> 时间：2008-10-29T04:49:10.897
> 
> 标签：c#, .net, winapi, pinvoke, file-descriptor

我有一个旧版应用程序，它从文件描述符 3 中的客户端程序读取消息。这是一个外部应用程序，所以我无法更改它。客户端是用 C# 编写的。我们如何在 C# 中打开与特定文件描述符的连接？我们可以使用像 AnonymousPipeClientStream() 这样的东西吗？但是我们如何指定要连接的文件描述符呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T22:27:48.317

不幸的是，如果不先 P/Invoking 到本机 Windows API，您将无法做到这一点。

首先，您需要使用本机 P/Invoke 调用打开文件描述符。这是由 OpenFileById WINAPI 函数完成的。这是在 MSDN[上使用它的方法](http://msdn.microsoft.com/en-us/library/aa365432(VS.85).aspx)，这是在 MSDN 论坛上详细解释它[的另一个链接](http://social.msdn.microsoft.com/forums/en-US/windowssearch/thread/4b71fcb3-bea9-4cfb-bdb7-2f1a91522ea6/)，这里是关于如何构建 P/Invoke 调用[的一些帮助 (pinvoke.net) 。](http://www.pinvoke.net/)

获得文件句柄后，您需要将其包装在 SafeFileHandle 中，这次使用安全的托管 C#：

```
// nativeHandle is the WINAPI handle you have acquired with the P/Invoke call
SafeFileHandle safeHandle = new SafeFileHandle(nativeHandle, true); 
```

现在您可以直接打开文件流：

```
Stream stream = new FileStream(safeHandle, FileAccess.ReadWrite); 
```

从这一点开始，您可以将其用作 C# 中的任何其他文件或流。完成后不要忘记处理您的物品。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-19T11:36:32.397

我能够通过使用[`_get_osfhandle`](https://msdn.microsoft.com/en-us/library/ks2530z6.aspx). 例子：

```
using System;
using System.IO;
using Microsoft.Win32.SafeHandles;
using System.Runtime.InteropServices;

class Comm : IDisposable
{
    [DllImport("MSVCRT.DLL", CallingConvention = CallingConvention.Cdecl)]
    extern static IntPtr _get_osfhandle(int fd);

    public readonly Stream Stream;

    public Comm(int fd)
    {
        var handle = _get_osfhandle(fd);
        if (handle == IntPtr.Zero || handle == (IntPtr)(-1) || handle == (IntPtr)(-2))
        {
            throw new ApplicationException("invalid handle");
        }

        var fileHandle = new SafeFileHandle(handle, true);
        Stream = new FileStream(fileHandle, FileAccess.ReadWrite);
    }

    public void Dispose()
    {
        Stream.Dispose();
    }       
} 
```

# asp.net - ASP.NET WebPermission 安全异常

> ID：245834
> 
> 赞同：3
> 
> 时间：2008-10-29T04:53:49.700
> 
> 标签：asp.net, system.security

我通常讨厌发布这些类型的问题，因为通常我发现真正学习的最佳方法是自己找出答案。

但是，我需要非常快地回答这个问题，因为我有一个客户由于这个问题而无法经营她的业务。

昨天，我的 ASP.NET 主机提供商将我的应用程序从运行 .NET 1.1 的服务器移至运行 .NET 1.1 和 2.0 的服务器。我的问题是，当我测试移动时，主站点页面（Default.aspx）不会加载

**“描述：应用程序试图执行安全策略不允许的操作。要授予此应用程序所需的权限，请联系您的系统管理员或在配置文件中更改应用程序的信任级别。**

**异常详细信息：System.Security.SecurityException：请求“System.Net.WebPermission，System，Version=2.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”类型的权限失败。”**

**[SecurityException：请求类型'System.Net.WebPermission，System，Version = 2.0.0.0，Culture = Neutral，PublicKeyToken = b77a5c561934e089'的权限失败。] System.Security.CodeAccessSecurityEngine.Check（对象需求，StackCrawlMark＆stackMark，布尔isPermSet) +0 System.Security.CodeAccessPermission.Demand() +59 System.Net.HttpWebRequest..ctor(Uri uri, ServicePoint servicePoint) +147 System.Net.HttpRequestCreator.Create(Uri Uri) +26 System.Net.WebRequest .Create(Uri requestUri, Boolean useUriBase) +298 System.Net.WebRequest.Create(Uri requestUri) +28 System.Web.Services.Protocols.WebClientProtocol.GetWebRequest(Uri uri) +30 System.Web.Services.Protocols.HttpWebClientProtocol .GetWebRequest(Uri uri) +12 System.Web.Services.Protocols.SoapHttpClientProtocol.GetWebRequest(Uri uri) +4 System.Web。Services.Protocols.SoapHttpClientProtocol.Invoke(String methodName, Object[] 参数) +52 PilatesPlusDublin.PilatesPlusDublinws.PilatesPlus.InsertException(String sModuleName, String sException, Int32 iUserID) +97 PilatesPlusDublin.MainDefault.Page_Load(Object sender, EventArgs e) + 144 System.Web.UI.Control.OnLoad(EventArgs e) +99 System.Web.UI.Control.LoadRecursive() +47 System.Web.UI.Page.ProcessRequestMain(布尔 includeStagesBeforeAsyncPoint, 布尔 includeStagesAfterAsyncPoint) +7350 System.Web .UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +213 System.Web.UI.Page.ProcessRequest() +86 System.Web.UI.Page.ProcessRequestWithNoAssert(HttpContext context) +18 System.Web.UI.Page .ProcessRequest（HttpContext 上下文）+49 ASP.maindefault_aspx。ProcessRequest(HttpContext context) +4 System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +358 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +64"**

如果托管站点上没有 WebPermission，如何配置我的站点以允许访问该页面？是否有一些标签需要放入 web.config 中？注意 - 我们无权访问 machine.config 或任何其他 IIS 设置。

我知道人们讨厌阅读和回答这些类型的问题，但是对于我或我的托管网站需要做些什么来解决这个问题的任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T23:17:57.437

不确定这是否会有所帮助，但我曾经有一个客户遇到过同样类型的问题。他们的虚拟主机公司进行了一些更改，导致他们的网站出现类似的错误。通过在 web.config 的 System.Web 部分中添加以下内容，设法使事情再次正常运行：

```
<trust level="Full" /> 
```

如果这不能解决您的问题并且网络托管在新的一年之前无法解决问题，我会认真考虑更换托管服务提供商。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T23:07:26.163

就像对可能遇到相同问题的任何人的仅供参考一样 - 我收到了这个确切的错误消息，但由于我没有更改本地机器上的任何设置，所以无法弄清楚出了什么问题。

几分钟后，我意识到我不小心从 Windows Server 2008 上的网络共享打开了该项目。当然权限不正确！真是愚蠢的举动，但如果它对某人有帮助，我愿意被羞辱:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-29T22:21:24.687

我发布这个以防它帮助其他人。在他们将您的提供商托管的现有 ASP.NET 站点移动到另一台服务器之前，请注意。

**确保您向他们询问有关网络许可和信任级别的信息。**

这是我的供应商回复....

“谢谢您的来信。

它失败了，因为 WebPermission 在中等信任环境中不可用。

我们目前无法对这些服务器进行任何更改，因为我们计划在今年年底之前将所有站点迁移到一对新集群上。我相信新的 Windows 集群将提供可用的 WebPermission，因为它已在当前的 Namesco Windows 集群上启用。"

所以他们希望我客户的网站在新年之前一直处于离线状态并失去业务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-29T05:01:42.353

您的 Web 应用程序是调用 Web 服务还是访问外部网站？如果是这样，您可能需要与您的托管服务提供商交谈，并要求将 URI 添加到允许的连接端点列表中。

# asp.net - 如何获得已经（基本）经过身份验证的上下文来调用相同身份验证后的 Web 服务？

> ID：245835
> 
> 赞同：3
> 
> 时间：2008-10-29T04:54:32.663
> 
> 标签：asp.net, web-services, authentication, http-status-code-401

我有一个支持基本身份验证（IIS6）的网站。

该站点的一部分调用了一个 Web 服务，该 Web 服务也是该站点的一部分，因此也支持基本身份验证。

但是，当这种情况发生时，调用代码会收到 401 身份验证错误。

我尝试了几件事，一般建议是这样的代码：

```
Service.ServiceName s = new Service.ServiceName();
s.PreAuthenticate = true;
s.Credentials = System.Net.CredentialCache.DefaultCredentials;
s.Method("Test"); 
```

但是，这似乎并不能解决我的问题。

有什么建议吗？

**编辑**

这似乎是一个并不少见的问题，但到目前为止我还没有找到解决方案。这是关于该主题的[一个线程。](http://forums.iis.net/t/1146546.aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T23:09:39.113

## 解决方案：（我几乎可以肯定这会对某人有所帮助）

**请参阅[此链接](http://forums.asp.net/t/1172902.aspx)以获取此解决方案在 VB 中的来源（感谢 jshardy！），我所做的只是转换为 C#。**

**注意：**您必须在 IIS 上仅使用基本身份验证才能使其正常工作，但它可能会被调整。您还需要传递一个 Page 实例，或者至少传递 Request.ServerVariables 属性（如果直接从 Page 代码隐藏调用，则使用“this”）。我会整理一下，可能会删除引用的使用，但这是对原始解决方案的忠实翻译，您可以进行任何必要的修改。

```
public static void ServiceCall(Page p)
{
    LocalServices.ServiceName s = new LocalServices.ServiceName();
    s.PreAuthenticate = true; /* Not sure if required */

    string username = "";
    string password = "";
    string domain = "";
    GetBasicCredentials(p, ref username, ref password, ref domain);

    s.Credentials = new NetworkCredential(username, password, domain);
    s.ServiceMethod();
}

/* Converted from: http://forums.asp.net/t/1172902.aspx */
private static void GetBasicCredentials(Page p, ref string rstrUser, ref string rstrPassword, ref string rstrDomain)
{
    if (p == null)
    {
        return;
    }

    rstrUser = "";
    rstrPassword = "";
    rstrDomain = "";

    rstrUser = p.Request.ServerVariables["AUTH_USER"];
    rstrPassword = p.Request.ServerVariables["AUTH_PASSWORD"];

    SplitDomainUserName(rstrUser, ref rstrDomain, ref rstrUser);

    /* MSDN KB article 835388
       BUG: The Request.ServerVariables("AUTH_PASSWORD") object does not display certain characters from an ASPX page */
    string lstrHeader = p.Request.ServerVariables["HTTP_AUTHORIZATION"];
    if (!string.IsNullOrEmpty(lstrHeader) && lstrHeader.StartsWith("Basic"))
    {
        string lstrTicket = lstrHeader.Substring(6);
        lstrTicket = System.Text.Encoding.Default.GetString(Convert.FromBase64String(lstrTicket));
        rstrPassword = lstrTicket.Substring((lstrTicket.IndexOf(":") + 1));
    }

    /* At least on my XP Pro machine AUTH_USER is not set (probably because we're using Forms authentication 
       But if the password is set (either by AUTH_PASSWORD or HTTP_AUTHORIZATION)
       then we can use LOGON_USER*/
    if (string.IsNullOrEmpty(rstrUser) && !string.IsNullOrEmpty(rstrPassword))
    {
        rstrUser = p.Request.ServerVariables["LOGON_USER"];
        SplitDomainUserName(rstrUser, ref rstrDomain, ref rstrUser);
    }
}

/* Converted from: http://forums.asp.net/t/1172902.aspx */
private static void SplitDomainUserName(string pstrDomainUserName, ref string rstrDomainName, ref string rstrUserName)
{
    rstrDomainName = "";
    rstrUserName = pstrDomainUserName;

    int lnSlashPos = pstrDomainUserName.IndexOf("\\");
    if (lnSlashPos > 0)
    {
        rstrDomainName = pstrDomainUserName.Substring(0, lnSlashPos);
        rstrUserName = pstrDomainUserName.Substring(lnSlashPos + 1);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T06:18:34.757

线路：

```
s.Credentials = System.Net.CredentialCache.DefaultCredentials();
```

也许你应该尝试：

```
s.Credentials = HttpContext.Current.User.Identity;
```

# c++ - 二叉搜索树删除（Inorder Pred 方法）C++

> ID：245838
> 
> 赞同：1
> 
> 时间：2008-10-29T04:56:55.280
> 
> 标签：c++, binary-search-tree

好的，所以我认为它已修复，但我得到的结果完全不一致。我从头开始重写它，这是我的结果。我没有错误，没有崩溃，只是没有删除它们。它完全把树弄乱了，给了我更多的叶子，把所有的东西都混在一起了。不知道还能去哪里

```
template <class T>
void BST<T>::remove(struct Node<T>*& root, const T& x)
{
   Node<T>* ptr = root;
   bool found = false;
   Node<T>* parent;

   while (ptr != NULL && !found)
   {
       if (x < ptr->data)
       {
           parent = ptr;
           ptr = ptr->left;
       }
       else if (x > ptr->data)
       {
           parent = ptr;
           ptr = ptr->right;
       }
       else
           found = true;
   }

   if (found == false)
       return;
   else
   {
       if(ptr->left != NULL && ptr->right != NULL)
       {
           Node<T>* inOrderPtr = ptr->left;
           parent = ptr;
           while (inOrderPtr->right != NULL)
           {
               parent = inOrderPtr;
               inOrderPtr = inOrderPtr->right;
           }

           ptr->data = inOrderPtr->data;
           ptr = inOrderPtr;
       }
    Node<T>* subPtr = ptr->left;
    if (subPtr == NULL)
        subPtr = ptr->right;

    else if (parent->left == ptr)
        parent->left = subPtr;

    else
        parent->right = subPtr;

    delete ptr;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T07:09:09.427

实际发生的情况是可能的搜索被反转了，所以它实际上会继续正确，但数据并没有真正正确匹配，所以它似乎会撞墙。

```
if (root->data < x)
        remove(root->left, x);
    else 
        remove(root->right, x); 
```

本来应该

```
if(x < root->data)
remove(root->left, x);
else
remove(root->right, x); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T05:22:29.190

你不应该`remove()`在第三种情况下递归调用（你的“不确定这是否正确”的评论是）。在要删除的节点有两个孩子的情况下，您要做的是找到左孩子的最右边的孩子（正如您所做的那样；结果节点存储在 中`parent`）。该节点没有右孩子 - 使其右孩子成为要删除的节点的右孩子。然后只需将`root`变量更改为其左孩子；无需更改`data`任何节点中的成员或`remove`递归调用。

在图片中：

```
前：
         r <- 这里的根点
       / \
      / \
     抗体
    / \ / \
   xcyy
      / \
     xd
        /
       X

后：
      a <-- 这里的根点
     / \
    xc
       / \
      xd
         / \
        xb
           / \
          年年

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T05:57:56.107

在树中找到的每个 T 都是唯一的吗？看起来它们来自您的代码...

看起来这应该有效：

在其他情况下删除根节点：

```
Node<T> *tmp_r = root->left;
Node<T> *parent = root;
while (tmp_r->right != NULL)
{
    parent = tmp_r;
    tmp_r = tmp_r->right;
}
Node<T> *tmp_l = tmp_r;
while (tmp_l->left != NULL)
    tmp_l = tmp_l->left;

tmp_l->left = root->left;
tmp_r->right = root->right;
parent->right = NULL;

parent = root;
root = tmp_r;
delete parent; 
```

# windows - 如何重命名子目录中的文件？

> ID：245840
> 
> 赞同：42
> 
> 时间：2008-10-29T04:57:44.467
> 
> 标签：windows, file-io, batch-rename

有没有办法批量重命名子目录中的文件？

例如：

重命名`*.html`为`*.htm`包含目录和子目录的文件夹。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2008-10-29T05:14:39.173

Windows 命令提示符：（如果在批处理文件中，请将 %x 更改为 %%x）

```
for /r %x in (*.html) do ren "%x" *.htm 
```

这也适用于重命名文件的中间

```
for /r %x in (website*.html) do ren "%x" site*.htm 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-29T05:15:11.140

```
find . -regex ".*html$" | while read line;
 do 
    A=`basename ${line} | sed 's/html$/htm/g'`;
    B=`dirname ${line}`;
    mv ${line} "${B}/${A}";
 done 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-29T05:17:27.763

在蟒蛇

```
import os

target_dir = "."

for path, dirs, files in os.walk(target_dir):
    for file in files:
        filename, ext = os.path.splitext(file)
        new_file = filename + ".htm"

        if ext == '.html':
            old_filepath = os.path.join(path, file)
            new_filepath = os.path.join(path, new_file)
            os.rename(old_filepath, new_filepath) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-29T05:08:53.540

在 Bash 中，您可以执行以下操作：

```
for x in $(find . -name \*.html); do
  mv $x $(echo "$x" | sed 's/\.html$/.htm/')
done 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-11-23T13:59:13.987

如果你有 forfiles（我认为它与 Windows XP 和 2003 以及更新的东西一起提供）你可以运行：

```
forfiles /S /M *.HTM /C "cmd /c ren @file *.HTML" 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-29T05:10:43.160

我确信有一种更优雅的方式，但这是我脑海中突然出现的第一件事：

```
for f in $(find . -type f -name '*.html'); do 
    mv $f $(echo "$f" | sed 's/html$/htm/')
done 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-29T19:43:09.047

```
In bash use command rename :)

 rename 's/\.htm$/.html/' *.htm

 # or

 find . -name '*.txt' -print0 | xargs -0 rename 's/.txt$/.xml/'

 #Obs1: Above I use regex \. --> literal '.'  and  $ --> end of line
 #Obs2: Use find -maxdepht 'value' for determine how recursive is
 #Obs3: Use -print0 to avoid 'names spaces asdfa' crash! 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-29T06:11:29.217

在 Linux 上，您可以使用“ [rename](http://linux.die.net/man/1/rename) ”命令批量重命名文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-29T07:07:20.710

Linux 上的 AWK。对于第一个目录，这是您的答案...通过在 dir_path 上递归调用 awk 进行推断，也许可以通过编写另一个 awk 来将这个确切的 awk 写在下面...等等。

```
ls dir_path/. | awk -F"." '{print "mv file_name/"$0" dir_path/"$1".new_extension"}' |csh 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-07T07:35:25.840

在 Unix 上，您可以使用[rnm](https://github.com/neurobin/rnm)：

```
rnm -rs '/\.html$/.htm/' -fo -dp -1 * 
```

或者

```
rnm -ns '/n/.htm' -ss '\.html$' -fo -dp -1 * 
```

解释：

1.  `-ns`: 名称字符串（新名称）。`/n/`是一个名称字符串规则，它扩展为不带扩展名的文件名。
2.  `-ss`：搜索字符串（正则表达式）。搜索匹配的文件。
3.  `-rs`: 替换表单的字符串`/search_regex/replace_part/modifier`
4.  `-fo`: 仅文件模式
5.  `-dp`: 目录深度（-1 表示无限制）。

# .net - 我应该什么时候在 .NET 中处理我的对象？

> ID：245856
> 
> 赞同：20
> 
> 时间：2008-10-29T05:10:13.847
> 
> 标签：.net, garbage-collection, dispose

对于一般代码，我真的需要处置一个对象吗？我可以在大多数情况下忽略它，还是在您 100% 确定不再需要它时始终处置它是个好主意？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-29T05:36:35.713

处理完物品后立即处理它。一次性对象表示持有 CLR 本质上不知道的有价值资源的对象。因此，GC 也不知道资源，也无法就何时应该收集一次性对象并因此释放底层资源做出明智的决定。

最终 GC 会感到内存压力并巧合地收集您的对象（仅此而已）。如果您不以确定的方式处理对象，那么完全有可能进入几乎没有内存压力的资源匮乏状态。

这是如何发生的快速示例。让我们将底层资源视为 Win32 句柄。这些是非常有限且相当小的。您运行一个创建大量 Foo 对象的操作。Foo 对象实现 IDisposable 并负责创建和处置 Win32 句柄。它们不是手动释放的，而是通过不同的怪癖使其进入 Gen2 堆。这个堆很少被释放。随着时间的推移，足够多的 Foo 实例进入 Gen2 堆以占用所有可用句柄。因此，无论使用多少内存，都无法创建新的 Foo 对象。

实际上，要释放句柄，需要在单个操作期间分配相当大量的内存才能提供足够的压力来释放实例。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-29T05:14:57.647

如果对象实现了 IDisposable，则应在完成后立即处理它。[最简单的方法是用using](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)块包围它：

```
using (SqlCommand cmd = new SqlCommand(conn)) {
    cmd.ExecuteNonQuery();
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-29T05:34:53.750

您应该始终调用`Dispose()`任何实现的类型的原因`IDisposable`是它通常用于表示该类型获取非托管资源。尤其重要的是要尽可能早地释放它们。正如其他人所提到的，`using`这是执行此操作的首选方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-29T05:34:44.657

有几种方法可以查看它。一种方法试图确定是否真的有必要在不再需要对象时立即处理它，例如使用 Reflector 来查看它是否*真的*持有非托管资源，或者如果它们被偶然处置。另一种观点是假设如果一个对象实现了 IDisposable，那么确定是否真的需要调用 Dispose() 不是你的事——你总是调用它。我认为这是正确的方法。窥视对象的私有实现以决定如何使用它们会增加与可能更改的实现耦合的风险。一个例子是 LINQ to SQL DataContext。它实现了 IDispose，但主要是在不需要显式调用 Dispose() 的情况下自行清理。我的偏好是编写无论如何都明确处理的代码，但其他人认为它没有必要。

当然，这一切都适用于实现 IDisposable 的对象。确实，GC 会在您没有任何明确操作的情况下处理大多数其他事情，但是值得阅读一下关于 GC 行为的微妙之处（我现在太累了，无法考虑细节）以了解何时显式地处理对象，更重要的是，何时实现 IDispose。网上有很多关于这件事的好文章。

如前所述， using(..) { ... } 是 IDisposable 实现者的朋友。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T06:38:11.783

如果对象实现了 IDisposable，那么它很可能会占用非托管资源。因此，经验法则是在您完成对象的那一刻调用 Dispose，直接或通过 using 块。不要依赖 GC，因为这就是 IDisposable 的用途 - 资源的确定性释放。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-29T08:21:19.017

不，在您没有持有非托管资源的情况下，您可以通过调用 Dispose 逃脱。但是如果你的类持有一个非托管资源，比如一个需要删除的临时文件，那么你将不得不显式调用 Dispose。

您可以通过在 Finalize 方法中编写释放代码来避免调用 Dispose，但是您依赖于垃圾收集器，因为您永远无法确定垃圾收集器何时会完成您的对象。为了安全起见，如果您正在设计这样一个包含非托管资源的类，您可以在 Dispose 和 Finalize 方法中编写相同的对象释放代码，但如果这样做，请始终在您的 dispose 方法中使用 SuppressFinalize()因为如果您的对象已经在终结队列中，它将阻止调用 Finalize() 方法。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-29T05:15:58.017

在大多数情况下，依靠 GC '工作'。典型的例外是当您有大量资源交互时 - 在这种情况下，最好明确处置。

明显的例如。

```
using (var conn = new SqlConnection(connString)) {} 
```

“使用”块绝对是确保正确处理对象的最干净、最可靠的方法。“使用”块可以与任何实现 IDisposable 的对象一起使用。

* * *

## 回答 #8

> 赞同：-7
> 
> 时间：2008-10-29T05:20:31.270

当你完成一个对象时，你可以忘记它。只要它没有在任何地方被引用，那么它就和消失一样好。当垃圾收集器喜欢它时，它使用的内存就会被释放。

# multithreading - 判断“elapsed”事件线程是否仍在运行？

> ID：245866
> 
> 赞同：1
> 
> 时间：2008-10-29T05:15:58.173
> 
> 标签：multithreading, timer

给定一个 System.Timers.Timer，有没有办法从主线程判断运行经过的事件代码的工作线程是否仍在运行？

换句话说，在停止计时器或计时器正在运行的主应用程序/服务线程之前，如何确保工作线程中运行的代码当前没有运行？

这是放弃使用状态的线程定时器的问题，还是直接使用线程的时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T07:06:18.823

查找 ManualResetEvent，因为它专门用于执行您的要求。

您的线程创建一个新的重置事件，并将其添加到一个可访问的队列中，您的主线程可以使用该队列来查看是否有任何线程仍在运行。

```
// main thread owns this
private List<ManualResetEvent> _resetEvents;
...
// main thread does this to wait for executing threads to finish
WaitHandle.WaitAll(_resetEvents.ToArray(), 2000, false)
...
// worker threads do this to signal the thread is done
myResetEvent.Set(); 
```

如果您愿意，我可以为您提供更多示例代码，但我基本上只是从大约一年前我不得不这样做时阅读的几篇文章中复制它。

* * *

忘了提一下，您不能将此功能添加到计时器触发时将获得的默认线程。所以你应该让你的计时器处理程序非常精简，除了准备和启动一个新的工作线程之外什么都不做。

```
...
ThreadPool.QueueUserWorkItem(new WaitCallback(MyWorkerDelegate),
  myCustomObjectThatContainsAResetEvent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T05:56:54.580

对于开箱即用的解决方案，没有办法。主要原因是运行 TimerCallback 函数的线程很可能仍然活着，即使运行回调的代码已经完成。TimerCallback 由线程池外的线程执行。当任务完成时，线程不会死亡，而是回到队列中等待下一个线程池任务。

为了让它工作，您将不得不使用一种线程安全的信号方式来检测操作是否已完成。

[计时器文档](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)

# javascript - 将 JavaScript 代码放入.

> ID：245868
> 
> 赞同：87
> 
> 时间：2008-10-29T05:16:23.710
> 
> 标签：javascript, html, href

 我见过以下将 JavaScript 代码放入`<a>`标签的方法：

```
function DoSomething() { ... return false; } 
```

1.  `<a href="javascript:;" onClick="return DoSomething();">link</a>`
2.  `<a href="javascript:DoSomething();">link</a>`
3.  `<a href="javascript:void(0);" onClick="return DoSomething();">link</a>`
4.  `<a href="#" onClick="return DoSomething();">link</a>`

我理解尝试放置有效 URL 而不仅仅是 JavaScript 代码的想法，以防万一用户没有启用 JavaScript。但出于本次讨论的目的，我需要假设 JavaScript 已启用（没有它他们无法登录）。

我个人喜欢选项 2，因为它允许您查看将要运行的内容——在调试有参数传递给函数的位置时特别有用。我已经使用了很多，但没有发现浏览器问题。

我读过人们推荐 4，因为它为用户提供了一个真正的链接来关注，但实际上，# 不是“真实的”。它绝对不会去哪里。

当您知道用户启用了 JavaScript 时，是否有一个不支持或非常糟糕？ 

相关问题：**[JavaScript 链接的 Href：“#”还是“javascript:void(0)”？](https://stackoverflow.com/questions/134845/href-for-javascript-links-or-javascriptvoid0)*.*

 ** * *

## 回答 #1

> 赞同：69
> 
> 时间：2008-10-29T05:35:58.320

我非常喜欢[Matt Kruse 的 Javascript Best Practices 文章](http://web.archive.org/web/20190822202858/http://www.javascripttoolbox.com/bestpractices/)。在其中，他指出使用该`href`部分执行 JavaScript 代码是一个坏主意。即使您已经声明您的用户必须启用 JavaScript，但`href`如果有人在登录后碰巧关闭了 JavaScript，您也没有理由不能拥有一个简单的 HTML 页面，您的所有 JavaScript 链接都可以指向他们的部分。我强烈鼓励您仍然允许这种后备机制。这样的事情将遵循“最佳实践”并实现您的目标：

```
<a href="javascript_required.html" onclick="doSomething(); return false;">go</a> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-29T05:24:44.740

`addEventListener`当您可以使用/时，为什么要这样做`attachEvent`？如果没有`href`- 等效项，请不要使用 a `<a>`，使用 a`<button>`并相应地对其进行样式设置。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-29T05:25:20.353

您忘记了另一种方法：

```
5: <a href="#" id="myLink">Link</a> 
```

使用 JavaScript 代码：

```
document.getElementById('myLink').onclick = function() {
    // Do stuff.
}; 
```

我无法评论哪个选项具有最好的支持或哪个在语义上是最好的，但我只想说我更喜欢这种风格，因为它将你的内容与你的 JavaScript 代码分开。它将所有 JavaScript 代码放在一起，这更容易维护（特别是如果您将其应用于许多链接），您甚至可以将其放在外部文件中，然后可以将其打包以减小文件大小并由客户端浏览器缓存。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-29T05:25:29.823

```
<a href="#" onClick="DoSomething(); return false;">link</a> 
```

我会这样做，或者：

```
<a href="#" id = "Link">link</a>
(document.getElementById("Link")).onclick = function() {
    DoSomething();
    return false;
}; 
```

视情况而定。对于较大的应用程序，第二个是最好的，因为它整合了您的事件代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T07:19:58.127

方法 #2 在 FF3 和 IE7 中存在语法错误。我更喜欢方法#1 和#3，因为#4 用'#' 弄脏了URI，尽管会减少打字......显然，正如其他响应所指出的，最好的解决方案是将html 与事件处理分开。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-01T17:48:48.617

我注意到这之间的一个区别：

```
<a class="actor" href="javascript:act1()">Click me</a> 
```

还有这个：

```
<a class="actor" onclick="act1();">Click me</a> 
```

如果在任何一种情况下你都有：

```
<script>$('.actor').click(act2);</script> 
```

那么对于第一个示例，`act2`将在第二个示例之前运行，`act1`而在第二个示例中，它将是相反的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-06-01T07:26:17.850

## 仅限现代浏览器

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript">
(function(doc){
    var hasClass = function(el,className) {
        return (' ' + el.className + ' ').indexOf(' ' + className + ' ') > -1;
    }
    doc.addEventListener('click', function(e){
      if(hasClass(e.target, 'click-me')){
          e.preventDefault();
          doSomething.call(e.target, e);
      }
    });
})(document);

function doSomething(event){
  console.log(this); // this will be the clicked element
}
</script>
<!--... other head stuff ...-->
</head>
<body>

<!--buttons can be used outside of forms https://stackoverflow.com/a/14461672/175071 -->
<button class="click-me">Button 1</button>
<input class="click-me" type="button" value="Button 2">

</body>
</html> 
```

## 跨浏览器

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript">
(function(doc){
    var cb_addEventListener = function(obj, evt, fnc) {
        // W3C model
        if (obj.addEventListener) {
            obj.addEventListener(evt, fnc, false);
            return true;
        } 
        // Microsoft model
        else if (obj.attachEvent) {
            return obj.attachEvent('on' + evt, fnc);
        }
        // Browser don't support W3C or MSFT model, go on with traditional
        else {
            evt = 'on'+evt;
            if(typeof obj[evt] === 'function'){
                // Object already has a function on traditional
                // Let's wrap it with our own function inside another function
                fnc = (function(f1,f2){
                    return function(){
                        f1.apply(this,arguments);
                        f2.apply(this,arguments);
                    }
                })(obj[evt], fnc);
            }
            obj[evt] = fnc;
            return true;
        }
        return false;
    };
    var hasClass = function(el,className) {
        return (' ' + el.className + ' ').indexOf(' ' + className + ' ') > -1;
    }

    cb_addEventListener(doc, 'click', function(e){
      if(hasClass(e.target, 'click-me')){
          e.preventDefault ? e.preventDefault() : e.returnValue = false;
          doSomething.call(e.target, e);
      }
    });
})(document);

function doSomething(event){
  console.log(this); // this will be the clicked element
}
</script>
<!--... other head stuff ...-->
</head>
<body>

<!--buttons can be used outside of forms https://stackoverflow.com/a/14461672/175071 -->
<button class="click-me">Button 1</button>
<input class="click-me" type="button" value="Button 2">

</body>
</html> 
```

您可以在文档准备好之前运行它，单击按钮将起作用，因为我们将事件附加到文档。

资料来源：

*   [测试一个元素是否包含一个类？](https://stackoverflow.com/questions/5898656/test-if-an-element-contains-a-class)
*   [event.preventDefault() 函数在 IE 中不起作用](https://stackoverflow.com/questions/1000597/event-preventdefault-function-not-working-in-ie)
*   [https://gist.github.com/eduardocereto/955642](https://gist.github.com/eduardocereto/955642)

# algorithm - 如何在哈希表和 Trie（前缀树）之间进行选择？

> ID：245878
> 
> 赞同：155
> 
> 时间：2008-10-29T05:19:04.640
> 
> 标签：algorithm, data-structures, hashtable, trie

因此，如果我必须在哈希表或前缀树之间进行选择，那么导致我选择其中一个的区别因素是什么。从我自己幼稚的角度来看，似乎使用 trie 有一些额外的开销，因为它没有存储为数组，但就运行时间而言（假设最长的键是最长的英文单词）它本质上可以是 O (1) (关于上限)。也许最长的英文单词是50个字符？

*一旦获得索引*，哈希表就会立即查找。然而，散列密钥以获取索引似乎可以轻松完成近 50 个步骤。

有人可以为我提供一个更有经验的观点吗？谢谢！

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2008-10-29T06:38:06.697

尝试的优点：

基础：

*   可预测的 O(k) 查找时间，其中 k 是键的大小
*   如果不存在，查找可能需要不到 k 时间
*   支持有序遍历
*   不需要哈希函数
*   删除很简单

新操作：

*   您可以快速查找键的前缀，枚举具有给定前缀的所有条目等。

链接结构的优点：

*   如果有许多公共前缀，则它们所需的空间是共享的。
*   不可变尝试可以共享结构。您可以构建一个仅沿一个分支不同的新 trie，而不是更新就地的 trie，其他地方指向旧 trie。这对于并发、表的多个同时版本等很有用。
*   不可变的 trie 是可压缩的。也就是说，它也可以通过 hash-consing共享*后缀的结构。*

哈希表的优点：

*   每个人都知道哈希表，对吧？你的系统已经有了一个很好的优化实现，比大多数目的的尝试都要快。
*   您的密钥不需要有任何特殊结构。
*   比明显的链接特里结构更节省空间（**见下面的评论**）

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-10-29T05:25:20.137

这完全取决于您要解决的问题。如果您需要做的只是插入和查找，请使用哈希表。如果您需要解决更复杂的问题，例如与前缀相关的查询，那么 trie 可能是更好的解决方案。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2012-04-15T05:57:34.530

每个人都知道哈希表及其用途，但它并不是完全恒定的查找时间，这取决于哈希表有多大，哈希函数的计算复杂度。

在大多数工业场景中，即使是很小的延迟/可扩展性也很重要（例如：高频交易），为高效查找创建巨大的哈希表并不是一个优雅的解决方案。您必须关心要优化的数据结构，以便在内存中占用空间以减少缓存未命中。

trie 更适合需求的一个很好的例子是消息中间件。您有一百万个不同类别的消息订阅者和发布者（在 JMS 术语中 - 主题或交换），在这种情况下，如果您想根据主题（实际上是字符串）过滤掉消息，您肯定不想创建哈希表拥有百万主题的百万订阅。更好的方法是将主题存储在 trie 中，因此当基于主题匹配完成过滤时，其复杂性与主题/订阅/发布者的数量无关（仅取决于字符串的长度）。我喜欢它，因为您可以创造性地使用这种数据结构来优化空间需求，从而降低缓存未命中率。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-01-12T10:27:47.747

使用树：

1.  如果您需要自动完成功能
2.  查找所有以“a”或“axe”开头的单词，依此类推。
3.  后缀树是树的一种特殊形式。后缀树有一系列哈希无法涵盖的优点。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-10-16T12:40:26.170

我没有看到任何人明确提到过一些我认为很重要的事情要牢记在心。哈希表和各种尝试通常都有`O(k)`操作，其中`k`是字符串的长度，以位为单位（或等效地以字符为单位）。

这是假设你有一个好的散列函数。如果您不希望“农场”和“农场动物”散列到相同的值，那么散列函数将不得不使用密钥的所有位，因此散列“农场动物”大约需要两倍的时间“农场”（除非您处于某种滚动散列场景中，但也有一些类似的操作保存场景与尝试）。有了香草树，就很清楚为什么插入“农场动物”所需的时间大约是“农场”的两倍。从长远来看，压缩尝试也是如此。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-11-19T17:16:23.157

对 trie 的插入和查找与输入字符串 O(s) 的长度呈线性关系。

哈希将为您提供查找和插入的 O(1)，但首先您必须根据再次为 O(s) 的输入字符串计算哈希。

结论，渐近时间复杂度在这两种情况下都是线性的。

从数据的角度来看，trie 有更多的开销，但您可以选择一个压缩的 trie，它会让您再次或多或少地与哈希表平起平坐。

要打破平局，请问自己这个问题：我只需要查找完整的单词吗？还是我需要返回与前缀匹配的所有单词？（如在预测文本输入系统中）。对于第一种情况，请使用哈希。它是更简单、更干净的代码。更容易测试和维护。对于前缀或后缀很重要的更详细的用例，请尝试一下。

And if you do it just for fun, implementing a trie would put a Sunday afternoon to a good use.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-06-18T16:05:39.103

****与基本的Trie**实现相比，**HashTable**实现更节省空间。但是对于字符串，在大多数实际应用中都需要排序。但是 HashTable 完全打乱了字典顺序。现在，如果您的应用程序正在执行基于字典顺序的操作（如部分搜索、所有具有给定前缀的字符串、所有单词按排序顺序），您应该使用 Tries。对于仅查找，应使用 HashTable（可以说，它提供了最短的查找时间）。**

 ****PS：**除此之外，**三元搜索树（TST）**将是一个很好的选择。它的查找时间比 HashTable 长，但在所有其他操作中都具有时间效率。此外，它比尝试更节省空间。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-10-29T05:31:49.810

一些（通常是嵌入式的、实时的）应用程序要求处理时间与数据无关。在这种情况下，哈希表可以保证已知的执行时间，而 trie 会根据数据而变化。

# vba - 使用 vba 代码清除页面文件

> ID：245882
> 
> 赞同：1
> 
> 时间：2008-10-29T05:21:36.930
> 
> 标签：vba

我有一个 vba 宏，它循环运行大约 200 次迭代，在运行时用完 ram 页面文件。

我需要某种快速修复来在每次迭代后清除页面文件。我知道最好的解决办法是清理代码，但时间是一个限制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T05:53:44.230

在每次循环迭代结束时，将要重新创建的所有对象设置为`Nothing`.

这篇[文章](http://www.vbi.org/Items/article.asp?id=106)详细解释了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T07:19:44.413

我从未见过这种情况。听起来您有一个不断扩展的数组，并且可能内存不足。我会在运行期间在几个地方停止它，看看发生了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-14T03:50:01.897

使用擦除和数组名称。这将擦除所有数组内容。

# .net - .Net 3.5 SP1 的交付

> ID：245913
> 
> 赞同：11
> 
> 时间：2008-10-29T05:48:26.250
> 
> 标签：.net, .net-3.5, installation

如果我要在我的应用程序中包含 .Net Framework 安装文件（安装过程由我们自己的技术人员完成），在没有事先安装任何框架的情况下安装在干净的 Windows（XP SP2/SP3 或 Vista SP1）上，哪个.Net Framework 设置是否需要按顺序安装才能升级到 3.5 SP1？目前我有以下设置文件：

1.  .Net 2.0
2.  .Net 2.0 SP1
3.  .Net 3.0
4.  .Net 3.5
5.  .Net 3.5 SP1

所有可再发行版本。

编辑：我需要完整安装，客户端配置文件将无法工作，因为我们客户的机器可能无法访问互联网。基本上我需要一个安装后忘记它的过程，所以当我们决定在以后使用 3.5 SP1 中的任何新内容时，我们可以放心，我们可以简单地应用更新我们的应用程序，而无需安装另一个先决条件

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-12T14:48:02.907

.Net Framework 3.5 SP1 可再发行组件（大约 230MB）包含所有支持架构（x86、x64、ia64）中的所有内容（2.0 + SP1 + SP2、3.0 + SP1 + SP2、3.5 + SP1）。**这是您唯一需要的下载。**

[从这里下载](http://www.microsoft.com/downloads/details.aspx?FamilyId=AB99342F-5D1A-413D-8319-81DA479AB0D7&displaylang=en)（点击[.NET Framework 3.5 Service Pack 1 (Full Package)](http://download.microsoft.com/download/2/0/e/20e90413-712f-438c-988e-fdaa79a8ac3d/dotnetfx35.exe)）：

然后，您可能想要安装[这些更新](http://go.microsoft.com/fwlink/?LinkId=136730)：

> 重要提示：安装 .NET Framework 3.5 SP1 包（引导程序或完整包）后，您应立即安装更新[KB959209](http://go.microsoft.com/fwlink/?LinkId=136730)以解决一组已知的应用程序兼容性问题。

对于 3 个架构（x86、x64 或 ia64）的 2 个操作系统“组”（XP/2003 或 Vista/2008）有 3 个更新（针对 2.0、3.0 和 3.5），总共... 16 次下载！（我知道，3 * 2 * 3 = 18，但 Server 2003 ia64 最多只支持 2.0）。您需要按顺序安装 3 个更新。或者您可以在安装 3.5 SP1 后运行 Windows 更新并让它自己解决。

* * *

编辑：需要明确的是，.Net 3.5 要求安装 2.0 和 3.0 并将其更新到 SP1 级别。.Net 3.5 SP1 要求将 2.0/3.0 更新到 SP2 级别。但是 3.5(SP1) 安装程序会自动执行此操作。也就是说，通过安装 3.5 SP1，您无需担心安装和更新 2.0 和 3.0 到 SP1 或 SP2。**只需安装 3.5 SP1 即可！**（以及额外的更新，3.5 SP1.1？）

About the Client Profile, it can only be installed on x86 client machines that don't have ANY version of .Net installed, so it won't install on Vista (it already comes with .Net 3.0), any Windows Server version, nor any x64/ia64 OS. You can only install it on a Windows XP SP2+ (x86) that doesn't have any version of .Net installed, otherwise a full installation is done. The offline Client Profile installer is 255MB because it will try to do a client install first, if it can't it will fallback to a full install. Personally, I would just do a full install anyway.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-29T05:51:50.847

NET 3.5 SP1 为构建 .NET 客户端应用程序的开发人员引入了一个新的安装程序包选项，称为“ [.NET Framework 客户端配置文件](http://weblogs.asp.net/scottgu/archive/2008/05/12/visual-studio-2008-and-net-framework-3-5-service-pack-1-beta.aspx)”。这提供了一个新的安装程序安装程序，可为计算机上的 .NET 客户端应用程序提供更小、更快和更简单的安装体验尚未安装 .NET Framework。

.NET Framework 客户端配置文件设置仅包含 .NET Framework 中通常用于客户端应用程序方案的程序集和文件。例如：它包括 Windows 窗体、WPF 和 WCF。它不包括 ASP.NET 以及主要用于服务器方案的那些库和组件。我们预计此安装包大小约为**26MB**，下载和安装速度比完整的 .NET Framework 安装包快得多。

# regex - 从 ifconfig 的输出中提取 MAC 地址的最佳方法？

> ID：245916
> 
> 赞同：62
> 
> 时间：2008-10-29T05:50:08.730
> 
> 标签：regex, linux, command-line-interface

`ifconfig`从的输出中提取 MAC 地址的最佳方法是什么？

样本输出：

```
bash-3.00# ifconfig eth0        
eth0      Link encap:Ethernet  HWaddr 1F:2E:19:10:3B:52    
          inet addr:127.0.0.66  Bcast:127.255.255.255  Mask:255.0.0.0    
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          ....
          .... 
```

我应该使用 cut、[AWK](http://en.wikipedia.org/wiki/AWK)还是其他任何方法，一种方法相对于另一种方法的优缺点是什么。

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2011-06-13T17:53:40.520

你可以在下面做一只猫`/sys/class/`

```
cat /sys/class/net/*/address 
```

专门针对`eth0`

```
cat /sys/class/net/eth0/address 
```

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2008-10-29T05:56:42.523

我会使用：

```
ifconfig eth0 | grep -o -E '([[:xdigit:]]{1,2}:){5}[[:xdigit:]]{1,2}' 
```

-o 将导致 grep 仅打印与表达式匹配的行的一部分。 `[[:xdigit:]]{1,2}`将匹配 1 或 2 个十六进制数字（Solaris 不输出前导零）。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-10-29T11:58:40.623

我喜欢将 /sbin/ip 用于这类任务，因为它更容易解析：

```
$ ip link show eth0
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 00:0c:29:30:21:48 brd ff:ff:ff:ff:ff:ff 
```

您可以使用 awk 轻松地从此输出中获取 mac 地址：

```
$ ip link show eth0 | awk '/ether/ {print $2}'
00:0c:29:30:21:48 
```

如果您想花更多的精力，并解析出更多数据，我建议在 ip 命令中使用 -online 参数，它可以让您将每一行视为一个新设备：

```
$ ip -o link 
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue \    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000\    link/ether 00:0c:29:30:21:48 brd ff:ff:ff:ff:ff:ff
3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000\    link/ether 00:0c:29:30:21:52 brd ff:ff:ff:ff:ff:ff
4: tun0: <POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 100\    link/[65534] 
5: sit0: <NOARP> mtu 1480 qdisc noop \    link/sit 0.0.0.0 brd 0.0.0.0 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-29T05:55:18.767

不确定是否真的有任何优势，但您可以简单地使用 awk：

```
ifconfig eth0 | awk '/HWaddr/ {print $5}' 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-02-13T20:44:13.590

由于 OP 的示例指的是 Bash，因此这里提供了一种无需使用其他工具即可提取 HWaddr 等字段的方法：

```
x=$(ifconfig eth0) && x=${x#*HWaddr } && echo ${x%% *} 
```

在第一步中，这会将 ifconfig 的输出分配给 x。第二步删除“HWaddr”之前的所有内容。在最后一步中，“”（MAC 后面的空格）之后的所有内容都被删除。

参考：[http ://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-06-02T00:25:37.087

对于 Ubuntu/Debian

```
ifconfig | grep HW | awk '{print $5}' 
```

对于 Rhat 或 CentOs 试试

```
ip add | grep link/ether | awk '{print $2}' 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-09-28T13:16:36.043

我更喜欢这里描述的方法（稍作修改）：[http ://www.askdavetaylor.com/how_do_i_figure_out_my_ip_address_on_a_mac.html](http://www.askdavetaylor.com/how_do_i_figure_out_my_ip_address_on_a_mac.html)

```
ifconfig | grep "inet " | grep -v 127.0.0.1 | cut -d " " -f2 
```

然后您可以将其别名为简短的“myip”命令以供将来使用：

```
echo "alias myip=\"ifconfig | grep 'inet ' | grep -v 127.0.0.1 | cut -d ' ' -f2\"" >> ~/.bash_profile 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-09-30T13:57:43.897

在终端中的 Ubuntu 14.04 上

```
ifconfig | grep HW 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-05-11T04:14:42.437

这个怎么样：

```
ifconfig eth0 | grep -Eo ..\(\:..\){5} 
```

或更具体地说

```
ifconfig eth0 | grep -Eo [:0-9A-F:]{2}\(\:[:0-9A-F:]{2}\){5} 
```

也是一个简单的

```
ifconfig eth0 | head -n1 | tr -s ' ' | cut -d' ' -f5` 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-09-15T10:59:34.080

```
ifconfig en1 | grep -o -E '([[:xdigit:]]{1,2}:){5}[[:xdigit:]]{1,2}' 
```

*   用网卡“eth0”的名称替换“en1”或完全删除“en1” - 简单而有用的解决方案。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-03-06T03:05:34.097

这适用于我在 Mac OS X 上：

```
ifconfig en0 | grep -Eo ..\(\:..\){5} 
```

也是如此：

```
ifconfig en0 | grep -o -E '([[:xdigit:]]{1,2}:){5}[[:xdigit:]]{1,2}' 
```

两者都是上述示例的变体。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-09T10:29:21.030

```
ifconfig | grep -i hwaddr | cut -d ' ' -f11 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-03-27T10:15:51.397

又好又快的一个：

```
ifconfig eth0 | grep HWaddr | cut -d ' ' -f 11 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-08-29T14:44:10.327

注意：在 OS X eth0 上可能无法正常工作。使用 p2p0：

```
ifconfig p2p0 | grep -o -E '([[:xdigit:]]{1,2}:){5}[[:xdigit:]]{1,2}' 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-08-27T19:51:12.900

这对我有用

```
ifconfig eth0 | grep -o -E ..:..:..:..:..:.. 
```

而不是`eth0`你可以写你需要的接口它的mac地址

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-05-09T21:19:37.963

我需要获取活动适配器的 MAC 地址，所以最终使用了这个命令。

```
ifconfig -a | awk '/^[a-z]/ { iface=$1; mac=$NF; next } /inet addr:/ { print mac }' | grep -o -E '([[:xdigit:]]{1,2}:){5}[[:xdigit:]]{1,2}' 
```

希望能帮助到你。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-09-19T08:56:27.823

ifconfig en0 | grep ether - 用于有线 MAC 地址

ifconfig en1 | grep ether - 用于无线 MAC 地址

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2014-06-17T12:04:23.567

利用：

```
ifconfig eth0 | grep HWaddr 
```

或者

```
ifconfig eth0 |grep HWaddr 
```

这将只提取 MAC 地址，而不提取其他任何内容。

您可以将您的 MAC 地址更改为您想要的任何内容：

```
ifconfig eth0 down,
ifconfig eth0 hw ether (new MAC address),
ifconfig eth0 up 
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2013-06-14T12:21:06.243

ifconfig 的输出：

```
$ifconfig

eth0      Link encap:Ethernet  HWaddr 00:1b:fc:72:84:12
      inet addr:172.16.1.13  Bcast:172.16.1.255  Mask:255.255.255.0
      inet6 addr: fe80::21b:fcff:fe72:8412/64 Scope:Link
      UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
      RX packets:638661 errors:0 dropped:20 overruns:0 frame:0
      TX packets:93858 errors:0 dropped:0 overruns:0 carrier:2
      collisions:0 txqueuelen:1000
      RX bytes:101655955 (101.6 MB)  TX bytes:42802760 (42.8 MB)
      Memory:dffc0000-e0000000

lo        Link encap:Local Loopback
      inet addr:127.0.0.1  Mask:255.0.0.0
      inet6 addr: ::1/128 Scope:Host
      UP LOOPBACK RUNNING  MTU:16436  Metric:1
      RX packets:3796 errors:0 dropped:0 overruns:0 frame:0
      TX packets:3796 errors:0 dropped:0 overruns:0 carrier:0
      collisions:0 txqueuelen:0
      RX bytes:517624 (517.6 KB)  TX bytes:517624 (517.6 KB) 
```

提取MAC地址的最佳方法是：

```
ifconfig | sed '1,1!d' | sed 's/.*HWaddr //' | sed 's/\ .*//' | sed -e 's/:/-/g' > mac_address 
```

# c# - C# 中基于事件的异步；任何通用的重构可能吗？

> ID：245929
> 
> 赞同：2
> 
> 时间：2008-10-29T06:01:03.323
> 
> 标签：c#, asynchronous, closures, continuations

一些 API，如 WebClient，使用[基于事件的异步模式](http://msdn.microsoft.com/en-us/library/wewwczdw.aspx)。虽然这看起来很简单，并且可能在松散耦合的应用程序中运行良好（例如 UI 中的 BackgroundWorker），但它并不能很好地链接在一起。

例如，这是一个多线程程序，因此异步工作不会阻塞。（想象一下，这是在一个服务器应用程序中调用数百次——你不想阻塞你的 ThreadPool 线程。）我们得到 3 个局部变量（“状态”），然后进行 2 个异步调用，结果是首先馈入第二个请求（因此它们不能并行）。状态也可能发生变异（易于添加）。

使用 WebClient，事情最终会像下面这样（或者你最终创建了一堆对象来充当闭包）：

```
using System;
using System.Net;

class Program
{
    static void onEx(Exception ex) {
        Console.WriteLine(ex.ToString());
    }

    static void Main() {
        var url1 = new Uri(Console.ReadLine());
        var url2 = new Uri(Console.ReadLine());
        var someData = Console.ReadLine();

        var webThingy = new WebClient();
        DownloadDataCompletedEventHandler first = null;
        webThingy.DownloadDataCompleted += first = (o, res1) => {
            if (res1.Error != null) {
                onEx(res1.Error);
                return;
            }
            webThingy.DownloadDataCompleted -= first;
            webThingy.DownloadDataCompleted += (o2, res2) => {
                if (res2.Error != null) {
                    onEx(res2.Error);
                    return;
                }
                try {
                    Console.WriteLine(someData + res2.Result);
                } catch (Exception ex) { onEx(ex); }
            };
            try {
                webThingy.DownloadDataAsync(new Uri(url2.ToString() + "?data=" + res1.Result));
            } catch (Exception ex) { onEx(ex); }
        };
        try {
            webThingy.DownloadDataAsync(url1);
        } catch (Exception ex) { onEx(ex); }

        Console.WriteLine("Keeping process alive");
        Console.ReadLine();
    } 
```

}

有没有一种通用的方法来重构这种基于事件的异步模式？（即不必为每个这样的 API 编写详细的扩展方法？） BeginXXX 和 EndXXX 使它变得容易，但这种事件方式似乎没有提供任何方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-29T10:13:04.657

在过去，我使用迭代器方法实现了这一点：每次您想要请求另一个 URL 时，您都使用“yield return”将控制权传递回主程序。请求完成后，主程序回调到您的迭代器以执行下一个工作。

您正在有效地使用 C# 编译器为您编写状态机。优点是您可以在迭代器方法中编写看起来很正常的 C# 代码来驱动整个事情。

```
using System;
using System.Collections.Generic;
using System.Net;

class Program
{
    static void onEx(Exception ex) {
        Console.WriteLine(ex.ToString());
    }

    static IEnumerable<Uri> Downloader(Func<DownloadDataCompletedEventArgs> getLastResult) {
        Uri url1 = new Uri(Console.ReadLine());
        Uri url2 = new Uri(Console.ReadLine());
        string someData = Console.ReadLine();
        yield return url1;

        DownloadDataCompletedEventArgs res1 = getLastResult();
        yield return new Uri(url2.ToString() + "?data=" + res1.Result);

        DownloadDataCompletedEventArgs res2 = getLastResult();
        Console.WriteLine(someData + res2.Result);
    }

    static void StartNextRequest(WebClient webThingy, IEnumerator<Uri> enumerator) {
        if (enumerator.MoveNext()) {
            Uri uri = enumerator.Current;

            try {
                Console.WriteLine("Requesting {0}", uri);
                webThingy.DownloadDataAsync(uri);
            } catch (Exception ex) { onEx(ex); }
        }
        else
            Console.WriteLine("Finished");
    }

    static void Main() {
        DownloadDataCompletedEventArgs lastResult = null;
        Func<DownloadDataCompletedEventArgs> getLastResult = delegate { return lastResult; };
        IEnumerable<Uri> enumerable = Downloader(getLastResult);
        using (IEnumerator<Uri> enumerator = enumerable.GetEnumerator())
        {
            WebClient webThingy = new WebClient();
            webThingy.DownloadDataCompleted += delegate(object sender, DownloadDataCompletedEventArgs e) {
                if (e.Error == null) {
                    lastResult = e;
                    StartNextRequest(webThingy, enumerator);
                }
                else
                    onEx(e.Error);
            };

            StartNextRequest(webThingy, enumerator);
        }

        Console.WriteLine("Keeping process alive");
        Console.ReadLine();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T16:23:24.717

你可能想调查一下`F#`。`F#`可以通过其«工作流程»功能为您自动执行此编码。'08 PDC 演示文稿`F#`使用名为 的标准库工作流处理异步 Web 请求`async`，该工作流处理`BeginXXX`/`EndXXX`模式，但您可以轻松地为事件模式编写工作流，或者找到一个固定的工作流。F# 与 C# 配合得很好。

# linux - SNMP 有效负载地址转换

> ID：245931
> 
> 赞同：3
> 
> 时间：2008-10-29T06:02:33.367
> 
> 标签：linux, networking, snmp, iptables, nat

我`iptables`在 linux 下使用 NAT SNMP 流量。一些 SNMP 数据包具有 VARBIND，其中包含生成它们的设备的（真实）IP 地址。这会混淆标准管理工具，这些工具需要查看 VARBIND 中的 NAT 化地址。因此，除了标题中的地址之外，我还需要翻译*有效载荷中的地址。*

标准工具是`nf_nat_snmp_basic.ko`内核模块，但原始版本只翻译地址的第一个八位字节，最新版本完全破坏了数据包。这显然是网络上的“常识”（www.netfilter.org），我已经在自己的设备上验证了它。

在我深入内核之前，有没有其他人研究过这个问题并提出了合适的解决方案？现在，只翻译那些 OID 将其类型指定为 IP 地址的 VARBIND 就足够了。换句话说，我不需要翻译嵌入在字符串数据中的地址，这要困难得多。

感谢您的建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T03:46:18.643

Robert Gamble 可能的 DIY 解决方案：[除了 iptables 之外的数据包处理工具？](https://stackoverflow.com/questions/260757/packet-mangling-utilities-besides-iptables)

经过一些单元测试后，更新和更多赞美即将到来——谢谢，罗伯特！

# maven-2 - 如何在 Maven 中发布依赖于 3rd 方 SNAPSHOT 项目的项目

> ID：245932
> 
> 赞同：57
> 
> 时间：2008-10-29T06:04:55.953
> 
> 标签：maven-2, versioning, release, snapshot, maven-release-plugin

我想使用 maven 发布插件发布一个快照项目“foo-1.0-SNAPSHOT”。该项目依赖于尚未发布的第 3 方模块“bar-1.0-SNAPSHOT”。我在项目的 pom.xml 中使用选项“allowTimestampedSnapshots”来允许时间戳快照，但我假设第 3 方模块（栏）没有时间戳，除非我自己构建它，因为 maven 仍然抱怨未解决的 SNAPSHOT 依赖项。

无论依赖的 SNAPSHOT 项目如何，有没有办法发布项目 foo，如果没有，我如何向第 3 方项目添加时间戳？

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2010-10-18T13:14:48.513

问题在于`allowTimestampedSnapshots`参数名称，它在文档中，但插件的源在表达式 - 中使用了不同的参数名称`ignoreSnapshots`。

因此，只需使用`-DignoreSnapshots=true`并且发布插件的准备目标将忽略快照依赖项。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-05-11T12:26:59.220

使用 maven-release-plugin 选项

```
-DignoreSnapshots=true 
```

代替

```
-DallowTimestampedSnapshots=true 
```

在我的情况下有所帮助，这将允许使用具有快照版本的依赖项来准备和执行发布。

应该非常小心地处理此选项，因为在发布中使用快照版本可能会在以后破坏您的发布，如果更新了快照依赖项，这在通常情况下不是您想要的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-31T17:26:53.637

简短的答案是看[下面的答案](https://stackoverflow.com/a/3959507/31480)....长答案是你可以解决它。

我过去应对的唯一方法是有效地分叉 3rd 方库并自己删除一个版本。这当然说起来容易做起来难，如果图书馆又大又复杂，如果 3rd 方图书馆是封闭源代码的，这就是不可能的。更简单的方法可能是接近第 3 方并要求他们取消发布。

另一种选择可能是复制他们的 pom（确保它没有快照）更改版本信息并在您的存储库中手动安装 pom 和工件。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-08T16:26:41.980

先前的答案建议更改组和工件 id...不要这样做，因为 maven 稍后在释放此依赖项时不会将其识别为相同的工件，并且您最终会在类路径上得到两个副本。我的首选方法是仅更改版本，我将执行以下操作：[原始版本]-[我的组织名称]-[我从中提取的 svn 版本]，所以我得到类似 1.0-SONATYPE-3425 的内容。通过使用 svn rev，我可以随时再次拉取源代码并在需要时对其进行修补，并且确切地知道我正在使用什么，而无需将整个源代码拉入我自己的 svn。

更新 - 我[不久前在博客](http://www.sonatype.com/people/2009/01/best-practices-for-releasing-with-3rd-party-snapshot-dependencies/)上写过这个。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-10-31T21:27:38.520

只需使用您拥有的 pom 安装 jar。我通常会更改组和工件 ID，以明确这不是正式版本，但这通常是解决您问题的最佳方法。

# asp.net - 跨子域共享数据有哪些选择？

> ID：245947
> 
> 赞同：2
> 
> 时间：2008-10-29T06:19:18.530
> 
> 标签：asp.net, session, subdomain

我有`www.example.com`，还有`store.example.com`。（是的，它们是同一个父域的子域）

`store.example.com`在 ASP.NET 1.1 上

`www.example.com`在 ASP.NET 3.5 上

我想知道有哪些选项可用于在两个站点之间共享“会话”数据。我需要某种共享登录以及跟踪用户活动的能力，无论他们从哪个站点开始。

*   显然，当从一个站点转换到另一个站点时，我可以发送一个 GUID。

*   我也相信我可以设置一个可以跨子域共享的 cookie。我从未尝试过，但这很可能是我会做的。我还不清楚这是一个真正的“会话”cookie，还是我只是设置了一个低到期日期？

这些是我最好的选择还是有别的选择？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-13T11:41:06.003

如果您想在不同的应用程序之间共享会话，您需要做一些事情。

首先，您需要在 SQL 模式下运行会话状态。在这一点上，我发现 SQL 会话状态使用机器密钥和您的 _appDomainAppId 为您的应用程序生成一个密钥以访问它自己的会话数据。因此，我们需要在您的所有应用程序之间保持这些相同。

在您的应用程序的网络配置中，您需要使用相同的机器密钥。这可以是 system.web 标签内的任何位置，例如：

```
 <machineKey decryptionKey="EDCDA6DF458176504BBCC720A4E29348E252E652591179E2" validationKey="CC482ED6B5D3569819B3C8F07AC3FA855B2FED7F0130F55D8405597C796457A2F5162D35C69B61F257DB5EFE6BC4F6CEBDD23A4118C4519F55185CB5EB3DFE61"/> 
```

添加一个 appSetting "ApplicationName" 并为其命名（这两个应用程序必须相同）然后您需要创建一个共享会话模块，该模块将更改 _appDomainAppId。下面这个是我用的。

```
 namespace YourApp
{
  using System.Configuration;
  using System.Reflection;
  using System.Web;

  /// <summary>class used for sharing the session between app domains</summary>
  public class SharedSessionModule : IHttpModule
  {
    #region IHttpModule Members
    /// <summary>
    /// Initializes a module and prepares it to handle requests.
    /// </summary>
    /// <param name="context">An <see cref="T:System.Web.HttpApplication"/>
    /// that provides access to the methods,
    /// properties, and events common to all application objects within an ASP.NET
    /// application</param>
    /// <created date="5/31/2008" by="Peter Femiani"/>
    public void Init(HttpApplication context)
    {
      // Get the app name from config file...
      string appName = ConfigurationManager.AppSettings["ApplicationName"];
      if (!string.IsNullOrEmpty(appName))
      {
        FieldInfo runtimeInfo = typeof(HttpRuntime).GetField("_theRuntime", BindingFlags.Static | BindingFlags.NonPublic);
        HttpRuntime theRuntime = (HttpRuntime)runtimeInfo.GetValue(null);
        FieldInfo appNameInfo = typeof(HttpRuntime).GetField("_appDomainAppId", BindingFlags.Instance | BindingFlags.NonPublic);
        appNameInfo.SetValue(theRuntime, appName);
      }
    }

    /// <summary>
    /// Disposes of the resources (other than memory) used by the module that
    /// implements <see cref="T:System.Web.IHttpModule"/>.
    /// </summary>
    /// <created date="5/31/2008" by="Peter Femiani"/>
    public void Dispose()
    {
    }
    #endregion
  }
} 
```

在网络配置中，您需要添加此模块：

```
 <add name="SharedSessionModule" type="YourApp.SharedSessionModule, YourApp, Version=1.0.0.0, Culture=neutral" /> 
```

最后要做的是允许会话cookie在域之间传递......就像这样

> ```
>  var session = HttpContext.Current.Session;
>   var request = HttpContext.Current.Request;
>   var cookie = request.Cookies["ASP.NET_SessionId"];
>   if (cookie != null && session != null && session.SessionID != null)
>   {
>     cookie.Value = session.SessionID;
>     cookie.Domain = "yourappdomain.com";
> 
>     // the full stop prefix denotes all sub domains
>     cookie.Path = "/"; // default session cookie path root
>   } 
> ```

这应该可以解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T07:10:45.367

重要的是要正确设置 cookie 域。

如果域设置为**.example.com**（注意前导句点），那么它应该包含在对 example.com 以及所有子域的请求中。

我假设您有一种在不同子域之间共享数据的方法。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-10-29T06:34:14.427

以下是您在 PHP 中的操作方式：

[http://php.dtbaker.com.au/post/keeping_cookies_across_multiple_sub_domains.html](http://php.dtbaker.com.au/post/keeping_cookies_across_multiple_sub_domains.html)

# .net - 在 .NET 解决方案中查找未使用的资源

> ID：245956
> 
> 赞同：60
> 
> 时间：2008-10-29T06:27:08.513
> 
> 标签：.net, resources

如何在 .resx 文件中查找可能已“孤立”且不再需要的未使用图标、图像、字符串？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2014-09-04T13:12:17.753

最近[ResXManager 1.0.0.41](https://github.com/tom-englert/ResXResourceManager)添加了一个功能来显示对字符串资源的引用数。

![显示新参考列的屏幕截图](https://i.stack.imgur.com/X3fwm.png)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-10-27T23:41:15.147

我找不到任何可以在 XAML 文件中搜索字符串资源引用并批量删除未使用的资源引用的现有解决方案。

所以我写了这个：[https ://github.com/Microsoft/RESX-Unused-Finder](https://github.com/Microsoft/RESX-Unused-Finder)

[![RESX 未使用的 Finder 屏幕截图](https://i.stack.imgur.com/5AvvO.png)](https://i.stack.imgur.com/5AvvO.png)

它在项目目录中搜索对字符串资源的引用，然后显示找不到匹配项的列表。您可以指定要搜索的模板，以便它可以在 XAML 文件中找到引用。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-03-23T07:40:25.727

我创建了一个免费的开源 VS 扩展，用于查找项目中未使用的图像，刚刚发布了第一个版本：[https ://marketplace.visualstudio.com/items?itemName=Jitbit1.VSUnusedImagesFinder](https://marketplace.visualstudio.com/items?itemName=Jitbit1.VSUnusedImagesFinder)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-29T07:13:39.513

这不是算法可以可靠计算的信息。被检查的程序可以获取所有资源的列表并对它们做一些事情，比如让用户从几个图标中进行选择。

您最好的选择可能是搜索对您选择的资源访问 API 的所有引用并手动检查这些引用。使用`grep`/`sed`您可以通过处理所有使用简单字符串的“简单”站点来减少必须手动检查的站点。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-12-09T10:03:40.323

由于我还没有找到一个*简单*而*快速*的解决方案，我至少找到了一个解决方案，它可以让我得到我正在寻找的结果，即使它需要一些时间（非常适合慵懒的周日下午）。

该解决方案涉及 Visual Studio .NET 2010 和 ReSharper（我使用的是 7.1 版），如下所示。

**分步解决方案**

**1.)**右键单击​​ VS.NET 中的主 RESX 文件，然后从上下文菜单中选择“查找用法”：

![在此处输入图像描述](https://i.stack.imgur.com/MlvHI.png)

这将打开 ReSharper 的“查找结果”窗口。

**2.)**双击解决方案窗口中的每个事件：

![在此处输入图像描述](https://i.stack.imgur.com/3RKDS.png)

这将打开包含资源的源代码窗口。

**3.)**从源代码窗口中重命名此资源：

![在此处输入图像描述](https://i.stack.imgur.com/FTPAC.png)

它将调出 ReSharper 的“重命名资源”对话框。

**4.)**给资源一个带有**唯一前缀**的新名称。在我的示例中，这是“TaskDialog_”：

![在此处输入图像描述](https://i.stack.imgur.com/9o5Gp.png)

它将重命名资源以及自动生成的 C# 包装器/访问类。

**5.)**对“使用”窗口中的所有资源重复上述步骤 2、3 和 4。

**6.)**在 Visual Studio 的资源编辑器中打开 RESX 文件并选择所有不带前缀的文件：

![在此处输入图像描述](https://i.stack.imgur.com/tyQ2A.png)

**7.)**现在单击窗口顶部的“删除资源”按钮或只需按下`Del`键：

![在此处输入图像描述](https://i.stack.imgur.com/UHmkg.png)

您终于有了一个 RESX 文件，其中仅包含文件中实际使用的资源。

**8.)**（可选）如果您有多种语言的资源（例如，德语的“Resources.de.resx”），也对这些 RESX 文件重复步骤 7 和 8。

**警告**

请注意，如果您通过强类型、自动生成的 C# 类以外的方式访问字符串，这将不起作用`Resources`。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-10-28T19:19:35.940

我最近构建了一个工具来检测和删除未使用的字符串资源。我使用这篇文章中的信息作为参考。该工具可能并不完美，但它完成了繁重的工作，如果您有一个历史悠久的大项目，它将很有用。我们在内部使用此工具来整合资源文件，并删除未使用的资源（我们从 10,000 个资源中删除了 4,000 多个资源）。

您可以查看源代码，或者从这里安装 ClickOnce：[https ://resxutils.codeplex.com/](https://resxutils.codeplex.com/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-02-13T22:36:43.623

我有一个类似的问题。我为翻译表创建了数千个资源字符串，其中许多不再需要或通过代码引用。由于有大约 180 个依赖代码文件，我无法手动检查每个资源字符串。

以下代码（在 vb.net 中）将通过您的项目查找孤立资源*（在**项目资源**中，而不是任何单个表单的资源*中）。我的项目花了大约 1 分钟。可以修改它以查找字符串、图像或任何其他资源类型。

总而言之；

*   1) 使用解决方案项目文件收集所有包含的代码模块并将它们附加到单个字符串变量中；
*   2）循环遍历所有项目资源对象，并创建一个列表（在我的情况下）是字符串；
*   3) 是否在组合项目文本变量中查找资源字符串代码的字符串搜索；
*   4) 报告未被引用的资源对象。

该函数返回 Windows 剪贴板上的对象名称，以便粘贴到电子表格中或作为资源名称的列表数组。

***编辑***：模块中的示例调用：modTest
`? modTest.GetUnusedResources("C:\Documents and Settings\me\My Documents\Visual Studio 2010\Projects\myProj\myProj.vbproj", True, true)`

```
'project file is the vbproj file for my solution
Public Function GetUnusedResources(projectFile As String, useClipboard As Boolean, strict As Boolean) As List(Of String)

    Dim myProjectFiles As New List(Of String)
    Dim baseFolder = System.IO.Path.GetDirectoryName(projectFile) + "\"

    'get list of project files 
    Dim reader As Xml.XmlTextReader = New Xml.XmlTextReader(projectFile)
    Do While (reader.Read())
        Select Case reader.NodeType
            Case Xml.XmlNodeType.Element 'Display beginning of element.
                If reader.Name.ToLowerInvariant() = "compile" Then ' only get compile included files
                    If reader.HasAttributes Then 'If attributes exist
                        While reader.MoveToNextAttribute()
                            If reader.Name.ToLowerInvariant() = "include" Then myProjectFiles.Add((reader.Value))
                        End While
                    End If
                End If
        End Select
    Loop

    'now collect files into a single string
    Dim fileText As New System.Text.StringBuilder
    For Each fileItem As String In myProjectFiles
        Dim textFileStream As System.IO.TextReader
        textFileStream = System.IO.File.OpenText(baseFolder + fileItem)
        fileText.Append(textFileStream.ReadToEnd)
        textFileStream.Close()
    Next
    '  Debug.WriteLine(fileText)

    ' Create a ResXResourceReader for the file items.resx.
    Dim rsxr As New System.Resources.ResXResourceReader(baseFolder + "My Project\Resources.resx")
    rsxr.BasePath = baseFolder + "Resources"
    Dim resourceList As New List(Of String)
    ' Iterate through the resources and display the contents to the console.
    For Each resourceValue As DictionaryEntry In rsxr
        ' Debug.WriteLine(resourceValue.Key.ToString())
        If TypeOf resourceValue.Value Is String Then ' or bitmap or other type if required
            resourceList.Add(resourceValue.Key.ToString())
        End If
    Next
    rsxr.Close()  'Close the reader.

    'finally search file string for occurances of each resource string
    Dim unusedResources As New List(Of String)
    Dim clipBoardText As New System.Text.StringBuilder
    Dim searchText = fileText.ToString()
    For Each resourceString As String In resourceList
        Dim resourceCall = "My.Resources." + resourceString ' find code reference to the resource name
        Dim resourceAttribute = "(""" + resourceString + """)" ' find attribute reference to the resource name
        Dim searchResult As Boolean = False
        searchResult = searchResult Or searchText.Contains(resourceCall)
        searchResult = searchResult Or searchText.Contains(resourceAttribute)
        If Not strict Then searchResult = searchResult Or searchText.Contains(resourceString)
        If Not searchResult Then ' resource name no found so add to list
            unusedResources.Add(resourceString)
            clipBoardText.Append(resourceString + vbCrLf)
        End If
    Next

    'make clipboard object
    If useClipboard Then
        Dim dataObject As New DataObject ' Make a DataObject clipboard
        dataObject.SetData(DataFormats.Text, clipBoardText.ToString())        ' Add the data in string format.
        Clipboard.SetDataObject(dataObject) ' Copy data to the clipboard.
    End If

    Return unusedResources

End Function 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-06-13T08:33:06.283

我使用 ReSharper 查找未使用的资源字段，然后如果项目包含少量资源，则手动删除它们。如果我们已经有未使用项目的列表，可以使用一些简短的脚本。

接下来是解决方案：

*   显示[本文所述的所有未使用的成员](http://chrisseroka.wordpress.com/2013/10/28/find-unused-private-and-public-methods-with-resharper/)
*   从生成的文件掩码中临时删除 *.Designer.cs (ReSharper → 选项 → CodeInspection → GeneratedCode)
*   还要从附加到资源文件的 Designer.cs 文件顶部注释或删除注释（表示代码是自动生成的）。

您将获得所有未使用资源的列表，以便将它们从 resx 中删除。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-30T19:01:29.310

我自己一直在考虑这个问题，我相信我有两个选择。这两者都依赖于我使用辅助方法从资源文件中提取所需资源的事实。

1.  **记录**
    向“getresource”方法或方法添加一些代码，以便每次访问资源时，将资源键写入日志。然后尝试访问站点的每个部分（测试脚本在这里可能会有所帮助）。生成的日志条目应该给出所有活动资源键的列表，其余的可以被垃圾。

2.  **代码分析**
    我正在查看[T4](http://msdn.microsoft.com/en-us/library/bb126445.aspx "T4")是否能够完成解决方案并创建对“getresource”辅助方法的所有引用的列表。结果键列表将处于活动状态，其余的可以删除。

这两种方法都有局限性。日志记录方法仅与测试覆盖的代码一样好，并且代码分析可能并不总是找到键而不是包含键的字符串，因此那里需要一些额外的手动工作。

我想我会尝试两个。我会让你知道情况如何。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-02-03T22:48:00.917

重命名您当前的图像目录，然后创建一个新目录，在 VS 中进行文件查找搜索您的图像路径，即“/content/images”，多选所有使用的图像并将它们拖到新的图像文件夹中。然后，您可以从项目中排除旧目录，或者将其删除。

# .net - C++/CLI 参考变量

> ID：245957
> 
> 赞同：2
> 
> 时间：2008-10-29T06:27:29.450
> 
> 标签：.net, c++-cli

```
void f(cli::array<PointF> ^points){
    PointF& a = points[0];
    // and so on...
} 
```

第 2 行的编译错误。

```
.\ndPanel.cpp(52) : error C2440: 'initializing' : cannot convert from 'System::Drawing::PointF' to 'System::Drawing::PointF &'
        An object from the gc heap (element of a managed array) cannot be converted to a native reference 
```

声明引用变量的托管方式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T13:18:24.987

如果您只想声明对数组中第一个 PointF 的引用，则需要使用[跟踪引用](http://msdn.microsoft.com/en-us/library/8903062a(VS.80).aspx)(%)：

```
void f(cli::array<PointF>^ points)
{    
    PointF% a = points[0];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-29T06:40:21.950

您需要使用文件中的`gcroot`模板`vcclr.h`：

这些是来自 MSDN 的示例：

```
// mcpp_gcroot.cpp
// compile with: /clr
#include <vcclr.h>
using namespace System;

class CppClass {
public:
   gcroot<String^> str;   // can use str as if it were String^
   CppClass() {}
};

int main() {
   CppClass c;
   c.str = gcnew String("hello");
   Console::WriteLine( c.str );   // no cast required
}

// mcpp_gcroot_2.cpp
// compile with: /clr
// compile with: /clr
#include <vcclr.h>
using namespace System;

struct CppClass {
   gcroot<String ^> * str;
   CppClass() : str(new gcroot<String ^>) {}

   ~CppClass() { delete str; }

};

int main() {
   CppClass c;
   *c.str = gcnew String("hello");
   Console::WriteLine( *c.str );
}

// mcpp_gcroot_3.cpp
// compile with: /clr
#include < vcclr.h >
using namespace System;

public value struct V {
   String^ str;
};

class Native {
public:
   gcroot< V^ > v_handle;
};

int main() {
   Native native;
   V v;
   native.v_handle = v;
   native.v_handle->str = "Hello";
   Console::WriteLine("String in V: {0}", native.v_handle->str);
} 
```

[你会在这里](http://msdn.microsoft.com/en-us/library/aeb4be4k.aspx)找到更多

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T07:53:20.383

这是您的代码更改为使用 gcroot：

```
void f(cli::array<gcroot<PointF ^>> points){
     gcroot<PointF ^> a = points[0];
     // and so on... } 
```

# c# - 查找未使用的代码

> ID：245963
> 
> 赞同：218
> 
> 时间：2008-10-29T06:32:27.660
> 
> 标签：c#, .net, refactoring

我不得不重构一个大型的 C# 应用程序，我发现很多从未使用过的函数。如何检查未使用的代码，以便删除所有未使用的功能？

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2010-08-05T19:20:22.573

是的，ReSharper 就是这样做的。右键单击您的解决方案并选择“查找代码问题”。结果之一是“未使用的符号”。这将向您显示未使用的类、方法等。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-10-29T06:43:15.783

这是一个很好的问题，但请注意，你在这里涉足危险水域。当您删除代码时，您必须确保经常编译和测试。

我想到了一个很棒的工具：

NDepend - 这个工具真是太棒了。摸索需要一点时间，在最初的 10 分钟之后，我认为大多数开发人员只会说“去死吧！” 并删除该应用程序。一旦你对 NDepend 有了一个好的感觉，它就会让你对你的应用程序是如何耦合的有惊人的洞察力。看看：[http](http://www.ndepend.com/) ://www.ndepend.com/ 。最重要的是，此工具将允许您查看没有任何直接调用者的方法。它还将向您展示相反的情况，即程序集中（甚至程序集之间）任何方法的完整调用树。

无论您选择什么工具，都不能掉以轻心。特别是如果您正在处理库类型程序集上的公共方法，因为您可能永远不知道应用程序何时引用它们。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-29T06:50:25.923

就像其他人所说的那样，Resharper 对此有好处。但要小心，这些工具不会找到反射使用的代码，例如无法知道某些代码是否未被反射使用。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-09-01T14:49:06.133

正如 Jeff 所指出的，工具[NDepend](http://www.NDepend.com)可以帮助查找未使用的方法、字段和类型。

详细说明一下，NDepend 建议[在 LINQ 查询 (CQLinq) 上编写代码规则](http://www.ndepend.com/Features.aspx#CQL)。提出了大约[200 条默认代码规则](http://www.ndepend.com/DefaultRules/webframe.html)，其中 3 条专用于*未使用/死代码*检测

基本上这样的规则来检测未使用的方法，例如：

```
// <Name>Dead Methods</Name>
warnif count > 0 
from m in Application.Methods where !m.MethodsCallingMe.Any()
select m 
```

[![NDepend 规则查找未使用的方法（死方法）](https://i.stack.imgur.com/LLfeT.png)](https://i.stack.imgur.com/LLfeT.png)

但这条规则很幼稚，会返回微不足道的误报。在许多情况下，一个方法从未被调用但它未被使用（入口点、类构造函数、终结器......）这就是为什么 3 个默认规则更加详细的原因：

*   [潜在的死类型](http://www.ndepend.com/DefaultRules/webframe.html?Q_Potentially_dead_Types.html)（因此检测未使用的类、结构、接口、委托......）
*   [可能死掉的方法](http://www.ndepend.com/DefaultRules/webframe.html?Q_Potentially_dead_Methods.html)
*   [潜在死区](http://www.ndepend.com/DefaultRules/webframe.html?Q_Potentially_dead_Fields.html)

NDepend 集成在 Visual Studio 2017、2015、2013、2012、2010 中，因此可以[在 IDE 中检查/浏览/编辑](http://www.ndepend.com/Doc_VS_CQL.aspx)这些规则。该工具还可以集成到您的 CI 流程中，它可以构建[报告](http://www.ndepend.com/SampleReports.aspx)，显示违反规则和罪魁祸首代码元素。NDepend 还有一个[VS Team Services 扩展](https://marketplace.visualstudio.com/items?itemName=ndepend.ndependextension)。

如果你点击上面这3个链接查看这些规则的源代码，你会发现关于类型和方法的部分有点复杂。这是因为它们不仅检测未使用的类型和方法，还检测*仅*由未使用的死类型和方法（递归）使用的类型和方法。

这是*静态分析*，因此规则名称中的前缀*可能是。*如果*仅*通过反射使用代码元素，则这些规则可能会将其视为未使用，但事实并非如此。

除了使用这 3 条规则之外，我还建议通过测试来衡量代码覆盖率并争取完全覆盖。通常，您会看到测试无法覆盖的代码实际上是可以安全丢弃的*未使用/死代码。*这在不清楚代码分支是否可达的复杂算法中特别有用。

*免责声明：我为 NDepend 工作。*

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-09-02T17:46:09.037

我还要提到，使用 IOC aka Unity 可能会使这些评估产生误导。我可能犯了错误，但据 ReSharper 所知，通过 Unity 实例化的几个非常重要的类似乎没有实例化。如果我遵循 ReSharper 的建议，我会被淹没！

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-29T06:38:01.503

[ReSharper](http://www.jetbrains.com/resharper/)在查找未使用的代码方面做得很好。

在 VS IDE 中，您可以右键单击定义并选择“查找所有引用”，但这仅适用于解决方案级别。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-23T22:59:25.240

事实是，该工具永远无法为您提供 100% 确定的答案，但覆盖率工具可以为您提供相当不错的收益。

如果您使用全面的单元测试套件，那么您可以使用测试覆盖工具来准确查看在测试运行期间没有执行哪些代码行。您仍然需要手动分析代码：消除您认为无效的代码或编写测试以提高测试覆盖率。

一个这样的工具是[NCover ，它是](http://www.ncover.com/)[Sourceforge](http://ncover.sourceforge.net/)上的开源先驱。另一种选择是[PartCover](http://sourceforge.net/projects/partcover/)。

在stackoverflow上查看这个[答案。](https://stackoverflow.com/questions/276829/code-coverage-for-c-net)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-02-11T12:49:17.737

我遇到过 AXTools CODESMART .. 尝试一次。在评论部分使用代码分析器。它将列出无效的本地和全局函数以及其他问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-29T12:01:06.593

FXCop 是一个代码分析器......它所做的不仅仅是查找未使用的代码。我使用了 FXCop 一段时间，对它的建议迷失了方向，所以我卸载了它。

我认为 NDepend 看起来更有可能成为候选人。

# sql-server-2005 - 在会话中多次更新“SiteVisit”行的注意事项

> ID：245964
> 
> 赞同：0
> 
> 时间：2008-10-29T06:33:08.783
> 
> 标签：sql-server-2005, session, performance

SQL Server 2005：

我有`SiteVisit`一行包含有关用户访问的信息，例如`HttpRefer`，他们是否下订单、浏览器等。

目前为了报告，我加入了这个表，`SiteEvent`其中包含有关访问的每个“部分”的信息。然后，这会生成一个视图，该视图显示有关每个用户访问了多少部分的统计信息。显然这不是一种可持续的方式来做到这一点，现在我正在做一些重构。

我想将`SectionsVisited`列从我的视图移动到`SiteVisit`. 然后，每次用户参加该会话时，我都会对其进行更新。

**现在我的实际问题**是：在每个会话多次更新一行时，我需要考虑哪些因素。显然，我在该行上有一个索引（当前由 GUID 索引以防止大多数恶意篡改）。

**我只想知道我应该做哪些不明显的事情（如果有的话）。我应该做些什么来优化表吗？或者 SQL Server 2005 会自行处理吗？**

注意：这是一个 Flash 网站，所以请不要只推荐一个跟踪工具。我想做一些“疯狂”的数据挖掘并开发了跟踪。这主要是一个数据库问题，而不是关于“如何跟踪”的问题。

请求的表定义：

```
USE [RazorSite]
GO
/****** Object:  Table [dbo].[SiteVisit]    Script Date: 10/29/2008 14:35:56 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[SiteVisit](
    [SiteVisitId] [int] IDENTITY(1,1) NOT NULL,
    [SiteUserId] [int] NULL,
    [ClientGUID] [uniqueidentifier] ROWGUIDCOL  NULL CONSTRAINT [DF_SiteVisit_ClientGUID]  DEFAULT (newid()),
    [ServerGUID] [uniqueidentifier] NULL,
    [UserGUID] [uniqueidentifier] NULL,
    [SiteId] [int] NOT NULL,
    [EntryURL] [varchar](100) NULL,
    [CampaignId] [varchar](50) NULL,
    [Date] [datetime] NOT NULL,
    [Cookie] [varchar](50) NULL,
    [UserAgent] [varchar](255) NULL,
    [Platform] [int] NULL,
    [Referer] [varchar](255) NULL,
    [RegisteredReferer] [int] NULL,
    [FlashVersion] [varchar](20) NULL,
    [SiteURL] [varchar](100) NULL,
    [Email] [varchar](50) NULL,
    [FlexSWZVersion] [varchar](20) NULL,
    [HostAddress] [varchar](20) NULL,
    [HostName] [varchar](100) NULL,
    [InitialStageSize] [varchar](20) NULL,
    [OrderId] [varchar](50) NULL,
    [ScreenResolution] [varchar](50) NULL,
    [TotalTimeOnSite] [int] NULL,
    [CumulativeVisitCount] [int] NULL CONSTRAINT [DF_SiteVisit_CumulativeVisitCount]  DEFAULT ((0)),
    [ContentActivatedTime] [int] NULL CONSTRAINT [DF_SiteVisit_ContentActivatedTime]  DEFAULT ((0)),
    [ContentCompleteTime] [int] NULL,
    [MasterVersion] [int] NULL CONSTRAINT [DF_SiteVisit_MasterVersion]  DEFAULT ((0)),
 CONSTRAINT [PK_SiteVisit] PRIMARY KEY CLUSTERED 
(
    [SiteVisitId] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
ALTER TABLE [dbo].[SiteVisit]  WITH CHECK ADD  CONSTRAINT [FK_SiteVisit_Platform] FOREIGN KEY([Platform])
REFERENCES [dbo].[Platform] ([PlatformId])
GO
ALTER TABLE [dbo].[SiteVisit] CHECK CONSTRAINT [FK_SiteVisit_Platform]
GO
ALTER TABLE [dbo].[SiteVisit]  WITH CHECK ADD  CONSTRAINT [FK_SiteVisit_Site] FOREIGN KEY([SiteId])
REFERENCES [dbo].[Site] ([SiteId])
GO
ALTER TABLE [dbo].[SiteVisit] CHECK CONSTRAINT [FK_SiteVisit_Site]
GO
ALTER TABLE [dbo].[SiteVisit]  WITH CHECK ADD  CONSTRAINT [FK_SiteVisit_SiteUser] FOREIGN KEY([SiteUserId])
REFERENCES [dbo].[SiteUser] ([SiteUserId])
GO
ALTER TABLE [dbo].[SiteVisit] CHECK CONSTRAINT [FK_SiteVisit_SiteUser] 
```

当前指标：

```
IX_CampaignId - non unique, non clustered
IX_ClientGUID - Unique, non clustered     <-- this is how a user is identified for updates
IX_UserGUID - non unique, non clustered
PK_SiteVisit - (SiteVisitId column) - clustered 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-29T08:15:30.323

我能给出的最好建议是：保持桌子小。

如何？拥有一张包含所有“实时”数据（即活动会话）的表。当会话到期时：将数据移出“存档”表甚至另一个数据库服务器以进行挖掘。

“实时”表（会话 id）上只有很少的索引。您可以在“存档”表上拥有所有您想要的索引，以便更快地检索数据。

# windows - 用于在 Windows 中编程的编码配色方案，而不仅仅是 Visual Studio

> ID：245966
> 
> 赞同：1
> 
> 时间：2008-10-29T06:34:25.910
> 
> 标签：windows, visual-studio, themes

像许多 SO 人一样，我几乎整天都在电脑前。我喜欢为 Visual Studio 设置一个深色主题（更直观），但由于其他 Windows 和应用程序（资源管理器、对话框、Outlook）具有全白色背景，因此更难在漂亮的深色 VS 和阳光明亮之间切换视窗。

我尝试了一个 UXTheme.dll 补丁，但找不到任何适用于 Visual Studio 和 Windows 应用程序的深色主题。有什么建议么？

编辑：要清楚，我不喜欢或几乎不喜欢白色。没有滚动条、菜单等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-29T07:50:50.077

我认为您不会找到可以完成任务的 Windows 主题。许多软件应用程序不遵循 Windows 首选项中指定的颜色，并且根本无法自定义 - 例如，记事本是白色背景上的黑色文本，故事结束。

对于一般主题，微软在去年发布了两个可能值得一看的官方 XP 主题：

*   [祖尼](http://go.microsoft.com/fwlink/?LinkID=75078)
*   [嵌入式](http://www.mediafire.com/download.php?aywudxvynnq)

如果您打算使用[修改后的 uxtheme.dll](http://lifehacker.com/5056544/how-to-use-custom-windows-visual-styles)文件，您可以查看[Luna Element Black](http://gelosea.deviantart.com/art/Luna-Element-v5-1-Black-57571128)，这是我已经使用了一年多的一个。

如果您热衷于在您使用的某些程序中不显示白色区域，那么您可能需要找到新的应用程序，这些应用程序提供了类似的功能，但也提供了字体和颜色方面的自定义功能——例如，使用[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)而不是 Notepad ，这为您提供了几乎详尽的自定义可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T06:51:12.520

可能不完全是您正在寻找的，但这[是 Visual Studio（2005 或 2008）的深色方案](http://www.mohundro.com/blog/CommentView,guid,0a1943d0-c755-41bc-bc1a-246d0f38b6a1.aspx)，您可以在 UXTheme 的补充中使用。

当然，它们是 Visual Studio 的其他 dar 配色方案，比如[这个](http://www.agileprogrammer.com/dotnetguy/archive/2006/09/07/19030.aspx)（Jeff[也有一个](http://www.codinghorror.com/blog/archives/000682.html)）。

但我不确定是否有*一种*工具适用于所有窗口，包括 Visual Studio。

# fiddler - 为什么 Fiddler 会破坏我网站的重定向？

> ID：245972
> 
> 赞同：0
> 
> 时间：2008-10-29T06:37:17.027
> 
> 标签：fiddler

为什么使用 Fiddler 有时会在页面转换时破坏我的网站。

在服务器端重定向之后——在 http 响应中（在 Fiddler 中找到）我得到这个：

对象移动

## 对象转移到了这里。

该站点是一个 ASP.NET 1.1 / VB.NET 1.1 [原文如此] 站点。

为什么 Fiddler 不直接找我？我不明白。

我在开发时对这个问题很好，但我担心其他代理服务器可能会导致“真正的客户”出现这个问题。我什至不清楚到底发生了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-29T06:45:27.400

这实际上就是 Response.Redirect 所做的。它向用户代理发送 302 - 对象移动响应。然后，用户代理会自动转到 302 响应中指定的 URL。如果您需要真正的服务器端重定向而不需要往返客户端，请尝试使用 Server.Transfer。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T04:18:48.200

如果您只是使用请求构建器构建请求，您将不会看到 Fiddler 自动遵循返回的重定向。

相反，如果您使用的是 IE 或其他浏览器，它通常会检查重定向标头并跟随它。

特别是对于 IE，我相信存在时间极端情况，即浏览器在不明确的情况下无法遵循重定向。您通常可以通过单击工具/提琴手选项并启用“服务器”和“客户端”套接字重用设置来解决此问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-21T21:30:18.973

感谢 user15310，它适用于 Server.Transfer

```
Server.Transfer("newpage.aspx", true); 
```

* * *

首先，使用 Server.Transfer 转移到另一个页面可以节省服务器资源。它不是告诉浏览器重定向，而是简单地改变 Web 服务器上的“焦点”并传输请求。这意味着您不会收到那么多的 HTTP 请求，从而减轻了您的 Web 服务器的压力并使您的应用程序运行得更快。

但要注意：因为“转移”过程只能在服务器上运行的那些站点上工作，所以不能使用 Server.Transfer 将用户发送到外部站点。只有 Response.Redirect 可以做到这一点。

其次，Server.Transfer 维护浏览器中的原始 URL。这确实有助于简化数据输入技术，尽管在调试时可能会造成混乱。

这还不是全部：Server.Transfer 方法还有第二个参数——“preserveForm”。如果将此设置为 True，使用诸如 Server.Transfer("WebForm2.aspx", True) 之类的语句，现有的查询字符串和任何表单变量仍可用于您要转移到的页面。

**在这里阅读更多：http:** [//www.developer.com/net/asp/article.php/3299641/ServerTransfer-Vs-ResponseRedirect.htm](http://www.developer.com/net/asp/article.php/3299641/ServerTransfer-Vs-ResponseRedirect.htm)

# dynamic - 你如何实现 C#4 的 IDynamicObject 接口？

> ID：245975
> 
> 赞同：6
> 
> 时间：2008-10-29T06:38:02.110
> 
> 标签：dynamic, c#-4.0, dynamic-language-runtime, idynamicobject

要在 C# 4.0 中实现“方法缺失”语义等，您必须实现 IDynamicObject：

```
public interface IDynamicObject
{
  MetaObject GetMetaObject(Expression parameter);
} 
```

据我所知，IDynamicObject 实际上是 DLR 的一部分，所以它不是新的。但是我还没有找到很多关于它的文档。

那里有一些非常简单的示例实现（fx [here](http://blogs.msdn.com/cburrows/archive/2008/10/28/c-dynamic-part-ii.aspx)和[here](http://code.msdn.microsoft.com/csharpfuture/Release/ProjectReleases.aspx?ReleaseId=1686)），但是谁能指出我更完整的实现或一些真实的文档？

特别是，您应该如何处理“参数”参数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-29T13:00:14.727

简短的回答是 MetaObject 负责实际生成将在调用站点运行的代码。它使用的机制是 LINQ 表达式树，它在 DLR 中得到了增强。所以它不是从一个对象开始，而是从一个表示对象的表达式开始，最终它需要返回一个描述要采取的动作的表达式树。

玩这个时，请记住 CTP 中的 System.Core 版本是从 8 月底的快照中获取的。它与 IronPython 的任何特定测试版都不是完全对应。从那时起，DLR 已经进行了许多更改。

此外，为了与 CLR v2 System.Core 兼容，从 beta 4 或 beta 5 开始的 IronPython 版本现在将 System 命名空间中的所有内容重命名为 Microsoft 命名空间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T00:25:26.100

如果您想要一个包含源代码的端到端示例，从而生成一个动态对象，该对象将任意属性的值存储在 Dictionary 中，那么[我的帖子“A first look at Duck Typing in C# 4.0”](http://saftsack.fs.uni-bayreuth.de/~dun3/archives/first-look-ducktyping-c-4-0-idynamicobject-metaobject/202.html "初看 C# 4.0 中的 Duck Typing")可能适合您。我写那篇文章是为了展示如何将动态对象转换为静态类型的接口。它有一个完整的 Duck 工作实现，它是一个 IDynamicObject 并且可以像一个 IQuack 一样工作。

如果您需要更多信息，请在我的博客上与我联系，我会尽我所能帮助您。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T09:49:47.950

我刚刚在这里写了关于如何做到这一点的博客：

[http://mikehadlow.blogspot.com/2008/10/dynamic-dispatch-in-c-40.html](http://mikehadlow.blogspot.com/2008/10/dynamic-dispatch-in-c-40.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T12:39:25.173

这是我到目前为止所知道的：

动态语言运行时目前作为[IronPython 项目](http://www.codeplex.com/IronPython)的一部分进行维护。所以这是获取信息的最佳场所。

实现支持 IDynamicObject 的类的最简单方法似乎是从[Microsoft.Scripting.Actions.Dynamic](http://www.codeplex.com/IronPython/SourceControl/FileView.aspx?itemId=650479&changeSetId=42603)派生并覆盖相关方法，例如实现函数调用语义的 Call-method。看起来 Microsoft.Scripting.Actions.Dynamic 没有包含在 CTP 中，但 IronPython 2.0 中的那个看起来可以工作。

我仍然不清楚“参数”参数的确切含义，但它似乎为动态对象的绑定提供了上下文。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-29T12:41:26.073

该演示文稿还提供了有关 DLR 的大量信息：

*   [深入探讨：](http://channel9.msdn.com/pdc2008/TL10/) Jim Hugunin 的 Microsoft .NET 中的动态语言。

# asp.net - 如何在 ASP.NET 中使用位置信息实现搜索功能？

> ID：245977
> 
> 赞同：1
> 
> 时间：2008-10-29T06:38:11.143
> 
> 标签：asp.net, search, lucene.net

我目前正在研究使用 Lucene.NET 为我正在开发的 Web 应用程序上的搜索功能提供支持。但是，我正在实现的搜索功能不仅需要进行全文搜索，还需要根据与指定地址的接近程度对结果进行排名。

Lucene.NET 可以处理这个要求吗？或者我是否需要先实现某种方式将点击分组到不同的位置（例如，小于 5 英里、小于 10 英里等），然后使用 Lucene.NET 对这些组中的项目进行排名？还是我忽略了完全不同的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T13:27:53.933

您可以实现自定义记分器以按距离顺序对结果进行排名，但您必须先过滤结果才能提高效率。您可以使用边界框方法，在您的地址周围 20 英里的正方形中过滤结果，然后应用排名。

如果我没记错的话，在 lucene in action book 中有一个距离相关算法的例子。它适用于 java lucene，但 api 是相同的，您可以轻松转换为 c# 或 vb.net

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T07:19:18.423

您正在寻找的是所谓的空间搜索。我不确定 Lucene.Net 是否有扩展来做到这一点，但你可以看看[NHibernate Spatial](http://www.codeplex.com/NHibernateSpatial)。除此之外，这些查询通常在数据库中完成。至少 PostGreSQL、MySQL 和 SQL Server 2008 具备空间查询能力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T15:40:33.233

经过一些额外的研究，我想我可能已经找到了答案。我将使用 Lucene.NET 按其他因素过滤搜索结果，然后使用来自 Google 或 Yahoo 的地理编码信息按距离对结果进行排序。*************