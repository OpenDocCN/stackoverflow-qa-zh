# StackOverflow 问答 000422000-000422999

# vb.net - 在 VB.net 2005 中打开 FoxPro 表

> ID：422002
> 
> 赞同：4
> 
> 时间：2009-01-07T20:43:03.987
> 
> 标签：vb.net, oledb, foxpro, visual-foxpro

我需要使用 oledb 连接在 vb.net 中打开 foxpro 免费表。

但是...我只需要获取列名。我真的不需要“选择”任何东西。我正在尝试动态浏览我们所有的空闲表，并设置每个文件中每一列的列表，并将其外部参照到另一个包含每列描述的空闲表。

我现在有一个工作模型，但它要求我这样做......

```
SELECT TOP 1 FROM "File" ORDER BY 1 
```

但在最大的表上，仅读取第一条记录就需要两分钟多的时间，并且有超过 250 个表。总的来说，它需要 15 到 20 分钟。

或者，是否有另一种方法可以只获取表的第一条记录而不使用“ORDER BY”？

这是我到目前为止所拥有的。“文件”作为参数传入。
它将包含诸如“C:\data\table1.dbf”之类的信息

```
Dim filePath As String
filePath = IO.Path.GetDirectoryName(file)
myOledbConnection = New OleDbConnection("Provider=VFPOLEDB.1;Data Source=" & filePath & ";Collating Sequence=MACHINE")
myOledbCommand = New OleDbCommand
myOledbDataAdapter = New OleDbDataAdapter
Dim fields, from, order As String

fields = "select top 1 *"
from = " from " & file
order = " order by 1"

myOledbCommand.CommandText = fields & from & order
myOledbCommand.Connection = myOledbConnection

myOledbDataAdapter.SelectCommand = myOledbCommand
myOledbDataAdapter.Fill(dt) 
```

然后我获取数据表（dt）并循环获取列信息。

当我创建数据集并通过向导从目录加载所有表时，我希望它像 Visual Studio 一样快。它能够非常快速地找到所有列信息，而无需从表中读取数据。

如果您需要更多信息，请与我们联系。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T21:02:24.260

为什么您需要获取任何记录？你应该可以说：

```
SELECT * FROM "File" where 1 = 0 
```

这会给你一个空的结果集，也会给你返回投影的元数据。

您可能还想查看[class](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbconnection.aspx)上的[`GetOleDbSchemaTable`方法](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbconnection.getoledbschematable.aspx)，因为它允许您获取有关数据库模式的信息，而无需执行查询。[`OleDbConnection`](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbconnection.aspx)

您还可以通过 COM 互操作 (mxADOX.dll) 使用[Microsoft ADO Extensions for Data Definition Language and Security](http://msdn.microsoft.com/en-us/library/windows/desktop/ms678270.aspx)来获取架构信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T21:08:10.973

我没试过这个/。但是，它看起来像要走的路。

特别是 OleDbConnection 实例上的“GetSchema”方法。 [http://msdn.microsoft.com/en-us/library/ms254934(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms254934(VS.80).aspx)

# .net - 如何创建支持插件的 .NET 客户端应用程序的最佳方法？

> ID：422005
> 
> 赞同：1
> 
> 时间：2009-01-07T20:43:33.020
> 
> 标签：.net, plugins, add-on

我发现 .net 插件架构非常复杂，无法用作插件平台。我认为对于第 3 位编码人员的开发来说，插件接口需要很简单。

你知道/使用/等一些更简单有效的插件技术吗？更准确地说，假设我们将开发一个像记事本这样的文本编辑器，它需要（通过示例）用于不同语法高亮、界面更改、shell 集成等的插件。

你会使用内置的 .net 插件代码，还是会构建/使用一些不同的代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T20:46:01.750

看看[MEF](http://www.codeplex.com/MEF)。它正是为此而设计的，而且使用起来非常简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T20:59:30.600

任何 IoC 框架 + 一些动态程序集加载。

# asp.net - 轮询 Web 服务性能 - 这行得通吗？

> ID：422008
> 
> 赞同：0
> 
> 时间：2009-01-07T20:44:13.953
> 
> 标签：asp.net, performance, web-services, notifications, xbap

我们的应用需要即时通知，所以很明显我应该使用一些 WCF 双工或套接字通信。问题是应用程序是部分信任 XBAP，因此我不允许使用除 BasicHttpBinding 之外的任何东西。因此，我需要轮询更改。

问题来了：我的 PM 说更新间隔应该是 2 秒左右，并且在单个 Web 服务器上的具有 500 个用户的 Intranet 上运行。

你们中是否有人体验过轮询会如何影响 Web 服务器。

该服务非常简单，它将一个 guid 作为 arg，并返回一个 guid 列表。所有数据访问都被缓存，所以我猜服务器上的负载对于一次调用来说是最小的，但是对于 500 ......

除了轮询之外，网络服务器几乎没有工作。

那么，基于这个小信息（假设一个标准的服务器硬件，不管是什么），是否有可能做出一个合格的猜测？

*   是否有可能实现这一点，它会起作用吗？

是的，我知道估计这很困难，但如果你们中的一些人能就此分享一些想法，我会非常高兴

问候

拉尔西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T21:32:56.990

不要估计，基准。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T20:52:55.607

尝试使用web 服务测试工具[soapu](http://www.soapui.org/) i 来检查您的 web 服务的性能。有付费版本和免费的开源版本。

干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T20:54:04.917

我不认为这将是一个特别的问题。我想每个请求的响应时间会很短，除非你要撤回大量数据，所以 2 秒内分布的 500 个连接不应该太严重。

在提交此设计之前，您可以使用压力测试工具来验证您的网络服务器是否可以处理负载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T20:58:50.320

如果您确实尽量减少来回发送的数据，那么 250 qps 可能在相当适中的硬件和网络带宽下是可行的。我假设您正在客户端上缓存这些 GUID 列表，因此您可以在正常情况下发送一个小的“无更新”响应。

用一个简单的原型应该很容易测量，但更自信。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T22:41:30.550

轮询.. 不好，但如果你别无选择，那么它是理想的 :)

请记住，毫无疑问，您将启用 keep-alives，因此您将拥有 500 个永久连接的用户。其内存使用量可能比处理器使用量更重要。我无法想象网络访问（即使在相对臃肿的 Web 服务中）会占用大量网络容量，但是您的网络延迟可能会成为一个问题——尤其是当我们都看到 Web 应用程序“暂停”一段时间时。

最后，你可能会没事，但你必须自己检查一下。Web服务压力测试器有很多，你可以使用[微软的WAS工具](http://support.microsoft.com/kb/815160)，这里[有一些其他的链接](http://www.testingfaqs.org/t-load.html)。

# asp.net - ASP.NET Datagrid - 隐藏特定的行/列

> ID：422010
> 
> 赞同：0
> 
> 时间：2009-01-07T20:44:30.100
> 
> 标签：asp.net, datagrid

我正在使用具有多列数据（称为 myDG）的 Datagrid，其中一列是绑定到数据源的 DateTime。它的值取决于完成作业并分配日期时间值的“作业”对象。由于这通常需要一分钟，因此该值在开始时未分配。

该列的 asp.net 定义为：

```
<asp:boundcolumn 
  DataField="CompletedDate" 
  HeaderText="Date Completed" 
  DataFormatString="{0:dd-MMM-yyyy <br> hh:mm:ss tt}" /> 
```

因此，当“工作”完成并设置时间时，该功能可以正常工作。但在此之前，在显示该行时，它显示为

01-1-0001 12:00:00 AM

我想隐藏它并确定最好的方法是用空白掩盖特定的行和列，或暂时覆盖该值。我在执行此操作并找到访问该特定行和列的方法时遇到问题。

它是数据网格的 [3] 列，并且始终位于第一行（因为在顶部添加了新行）。

有没有办法直接访问这个单元格并暂时“隐藏”它的内容，或者掩盖它们？理想情况下，如果有一种方法可以清除列中值等于此值的所有行，但操作特定单元格的方法也可以。

-提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T20:48:15.803

我可能会挂钩 OnItemDataBound，检查值，并在需要时替换/重新格式化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T20:56:53.273

[我问了一个关于在此处](https://stackoverflow.com/questions/416861/asp-net-gridview-value-set-to-null-when-column-is-not-visible)隐藏列的类似问题。

我不得不使用 RowCreated 事件向用户隐藏某些列（PK 列），这也可能对您有所帮助（尤其是隐藏数据绑定列）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T20:49:48.497

我过去做过类似的事情，这就是我所做的。

将数据绑定到根本不可见的列。为要显示的数据添加可见列。在填充网格时，循环遍历记录，对于任何值不是 01-Jan-0001 12:00:00 AM 的记录，将可见行设置为该值。如果它等于 01-Jan-0001 12:00:00 AM，则将可见行的值设置为空字符串或您选择的某个值。（您甚至可以将文本颜色设置为与背景颜色相同，这样它就不会出现在用户面前）

# javascript - 如何使用 JavaScript 禁用滚动条？

> ID：422028
> 
> 赞同：4
> 
> 时间：2009-01-07T20:49:10.120
> 
> 标签：javascript, internet-explorer-7, scrollbar

当我仅在 Internet Explorer 7 中显示表示模式窗口的 div 时，我需要锁定浏览器滚动条。谷歌搜索我发现我可以使用`document.body.style.overflow='hidden'`，但这不适用于 IE7。我也尝试了`document.body.scroll="no"`which 工作，但只有在我将鼠标悬停在滚动条上之后：-S

有人知道更好的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-07T21:05:57.280

为了回答您的各种问题（包括您其他评论中的问题），我认为您使用了错误的定位方法。

试试`position:fixed`。`position:absolute`除了相对于绝对视口之外，它基本相同。即：如果用户滚动，该项目将停留在屏幕上的相同位置。

因此，考虑到这一点，您可以布置`position:fixed`叠加层。在其中你可以拥有你的`position:absolute`（或者`fixed`再次，如果你愿意的话——它*不应该*有所作为）模态框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T20:55:19.127

设置您的模态覆盖 div 以填充主体，因此即使他们滚动也无能为力，因为一切都隐藏在它下面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T21:55:27.430

你也可以通过使用隐藏滚动条，`overflow:hidden`这样用户就不会看到scollbars，所以它不会被诱惑到处乱跑:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-25T19:21:21.717

这可以帮助您：

```
documentOBJ = {
    /*Width and Height of the avaible viewport, what you'r seeing*/
    window : {
        x : function(){return (document.documentElement && document.documentElement.clientWidth) || window.innerWidth || self.innerWidth || document.body.clientWidth; },
        y : function(){return (document.documentElement && document.documentElement.clientHeight) || window.innerHeight || self.innerHeight || document.body.clientHeight;}
    },

    /*Scroll offset*/ 
    scroll : {
        x : function(){return ( document.documentElement && document.documentElement.scrollLeft) || window.pageXOffset || self.pageXOffset || document.body.scrollLeft; },
        y : function(){return ( document.documentElement && document.documentElement.scrollTop) || window.pageYOffset || self.pageYOffset || document.body.scrollTop; }
    },

    /*Height and width of the total of the xhtml in a page*/
    page : {
        x : function(){return (document.documentElement && document.documentElement.scrollWidth) ? document.documentElement.scrollWidth : (document.body.scrollWidth > document.body.offsetWidth) ? document.body.scrollWidth : document.body.offsetWidth; },
        y : function(){return (document.documentElement && document.documentElement.scrollHeight) ? document.documentElement.scrollHeight : (document.body.scrollHeight > document.body.offsetHeight) ? document.body.scrollHeight : document.body.offsetHeight; }
    },
    pointer : {}
} 
```

# asp.net - 当我使用代理自动生成时，如何让 Flex 查看 .NET Webservice 会话？

> ID：422032
> 
> 赞同：1
> 
> 时间：2009-01-07T20:49:49.450
> 
> 标签：asp.net, apache-flex, actionscript-3, web-services, session

所以我有一个我希望 Flex 使用的 Stateful .NET webservice (C#)。唯一的问题是我没有看到正在传递的 cookie，即使我的 WebMethods 装饰有：

```
WebMethod(EnableSession=true) 
```

我似乎无法弄清楚这是否是 Flex 或 .NET 的问题。

Flex 3 (as3) 是否使用生成的 Web 服务类自动关注会话 cookie？如果不是，我可以做些什么来最小化我必须编写的代码才能让生成的代理类支持它。

代码示例，请:)

## 编辑 1

我找到了自己的[解决方案](https://stackoverflow.com/questions/422032/how-to-get-flex-to-see-a-net-webservice-session-when-i-use-the-proxy-auto-genera#435846)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T20:58:15.783

我相信 Flex 专家很快就会出现，但是如果您使用浏览器连接到它，cookie 会被创建/传递吗？

有点跑题了，但是 Flex 在反序列化方面并不是特别快，所以您是否考虑过使用[WebORB](http://www.themidnightcoders.com/products.html)之类的东西进行连接？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T15:54:42.640

我发现了我的问题。我没有为会话设置任何值，因此 .NET 不会传递 cookie。我必须明确设置一个值，然后它完美地传递了会话标头信息：

```
IE. Session["isActive"] = true; 
```

# data-warehouse - 逆转（或撤消）对仓库事实表的大量负载

> ID：422041
> 
> 赞同：0
> 
> 时间：2009-01-07T20:52:35.373
> 
> 标签：data-warehouse

目前，我们计划为我们加载的每批事实记录一个“batch id”。这样，我们可以在发现问题时退出负载。

我们是否也应该考虑在维度行上跟踪批次 ID？

似乎维度行有不同的规则。如果我们将它们视为缓慢变化的，并使用保留历史的 SCD 算法之一，那么重新加载实际上并没有多大意义。

典型场景。符合尺寸，处理 SCD。加载事实。完毕。

延期。符合尺寸，处理 SCD。加载事实。发现问题。删除这批事实。解决问题。重新加载事实。完毕。

可能的情景。符合尺寸，处理 SCD。加载事实。发现问题。删除这批事实和维度行。解决问题。符合尺寸，处理 SCD。加载事实。完毕。

跟踪尺寸变化似乎没有多大帮助。关于如何最好地处理数据仓库负载的“撤消”或“回滚”的任何指导？

我们的 ETL 工具完全是本地开发的 Python 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T23:30:55.003

从我的角度来看，只要您不滥用您的维度（例如跟踪时间到毫秒），跟踪维度以进行回滚并没有太多好处。您还可以构建一个工具来每月清理一次未引用的维度。

# asp.net - 将数据拆分为页面

> ID：422045
> 
> 赞同：1
> 
> 时间：2009-01-07T20:53:14.747
> 
> 标签：asp.net, pagination

如何在 ASP.Net 上将数据拆分为页面？

我正在寻找类似于 Google 在您有太多搜索结果并将它们分成 x 个页面时所做的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T20:55:45.630

这完全取决于内容。如果它是一个简单的数据网格，您可以使用内置的数据网格分页。但是，如果数据来自 SQL，我建议构建一个通用的“分页控件”并使用 SQL 的分页功能仅拉回您想要查看的数据。

如果是 SQL 2005（或更高版本）分页又好又简单：

```
SELECT  Description, Date
FROM     (SELECT  ROW_NUMBER() OVER (ORDER BY MyCol DESC) AS Row, Desc, Date FROM MyTable)
AS MyTableWithRowNumbers
WHERE  Row >= 1 AND Row <= 10 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T21:07:57.680

分页数据网格或中继器将是您的最佳选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-24T22:15:22.487

使用 GridView 和 LinqDataSource。

它会为你做这一切。

看：

[http://msdn.microsoft.com/en-us/library/bb470363.aspx](http://msdn.microsoft.com/en-us/library/bb470363.aspx)

和：

[http://msdn.microsoft.com/en-us/library/bb547113.aspx](http://msdn.microsoft.com/en-us/library/bb547113.aspx)

# build-process - 构建服务器最佳实践

> ID：422054
> 
> 赞同：4
> 
> 时间：2009-01-07T20:55:41.030
> 
> 标签：build-process, build-automation, build-server

我听说谷歌有一些这样的自动化过程：

*   当您签入时，您的代码会签入一个临时位置。
*   它是建造的。
*   样式检查运行。
*   测试运行。
*   如果没有问题，代码将转到实际存储库。
*   您会收到一封电子邮件，其中包含测试结果、性能图表、样式检查结果以及您的代码是否已签入。

因此，如果您想了解您是否破坏了某些东西，或者您预期的性能提升是否发生了，您只需签入并收到一封电子邮件，告诉您您需要了解的内容。

您最喜欢的构建服务器最佳实践是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T21:02:43.153

你为谷歌描述的是每个基本构建过程所做的。特定项目可能有额外的需求，例如——我们如何将 Web 应用程序从登台部署到生产：

*   构建开始
*   实时站点脱机（Apache 重定向到包含“正在建设”页面的不同目录）
*   为生产服务器运行 SVN 更新
*   运行数据库模式增量
*   针对更新的源和模式运行测试
*   如果失败：运行回滚（SVN 还原和数据库模式 UNDO）
*   网站重新上线
*   构建结束

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T21:14:28.387

在 java 平台上，我尝试了所有主要的 CI 系统。我的建议是，为商业支持的解决方案*付费*是我见过的最便宜的构建系统。这些事情需要*时间*来维护、支持和排除故障。尤其是在一直运行大量构建的情况下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-28T09:39:35.287

您提供的示例工作流程类似于[TeamCity](http://www.jetbrains.com/teamcity/)提出的工作流程。这个想法是：

1.  **代码**
2.  **签到**“预测试”
3.  CI 服务器**测试**“预提交”
4.  如果（且仅当）测试通过，**CI 服务器**会将代码更改提交到主存储库

这是一场宗教战争，但我更喜欢：

1.  **代码**-**测试**-**重构**（循环）
2.  **犯罪**
3.  CI 服务器也会**验证**你的提交

每个负责任的程序员都应该在提交之前运行所有测试。

第一种方式的主要论点是它保证 SCM 中没有损坏的代码。但是，我认为：

*   您应该**信任**您的开发人员在提交之前进行测试
*   如果测试需要很长时间，**问题在于您的测试速度较慢**，而不是工作流程
*   开发人员热衷于**保持快速测试**
*   依赖 CI 服务器运行测试会给你**错误的安全感**

# iphone - iPhone 上 UIView 和 UILabels 上的渐变

> ID：422066
> 
> 赞同：220
> 
> 时间：2009-01-07T20:58:30.117
> 
> 标签：iphone, ios, cocoa-touch, gradient

> **可能重复：**
> [在 iPhone 应用程序中手动绘制渐变？](https://stackoverflow.com/questions/227005/manually-drawing-a-gradient-in-iphone-apps)

我的应用程序需要在 a`UIView`或中显示文本，`UILabel`但背景必须是渐变而不是 true `UIColor`。使用图形程序创建所需的外观并不好，因为文本可能会因服务器返回的数据而异。

有谁知道解决这个问题的最快方法？非常感谢您的想法。

* * *

## 回答 #1

> 赞同：780
> 
> 时间：2009-12-19T00:38:31.747

我意识到这是一个较旧的线程，但供将来参考：

从 iPhone SDK 3.0 开始，自定义渐变可以很容易地实现，无需子类或图像，通过使用新的`CAGradientLayer`：

```
 UIView *view = [[[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 100)] autorelease];
 CAGradientLayer *gradient = [CAGradientLayer layer];
 gradient.frame = view.bounds;
 gradient.colors = [NSArray arrayWithObjects:(id)[[UIColor blackColor] CGColor], (id)[[UIColor whiteColor] CGColor], nil];
 [view.layer insertSublayer:gradient atIndex:0]; 
```

看看 CAGradientLayer 文档。您可以选择指定起点和终点（以防您不想要从顶部直接到底部的线性渐变），甚至可以指定映射到每种颜色的特定位置。

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2009-01-07T21:39:21.503

正如迈克的回应所指出的，您可以使用 Core Graphics 来绘制渐变。作为更详细的示例，您可以创建一个`UIView`子类用作`UILabel`. 在该`UIView`子类中，重写该`drawRect:`方法并插入类似于以下内容的代码：

```
- (void)drawRect:(CGRect)rect 
{
    CGContextRef currentContext = UIGraphicsGetCurrentContext();

    CGGradientRef glossGradient;
    CGColorSpaceRef rgbColorspace;
    size_t num_locations = 2;
    CGFloat locations[2] = { 0.0, 1.0 };
    CGFloat components[8] = { 1.0, 1.0, 1.0, 0.35,  // Start color
         1.0, 1.0, 1.0, 0.06 }; // End color

    rgbColorspace = CGColorSpaceCreateDeviceRGB();
    glossGradient = CGGradientCreateWithColorComponents(rgbColorspace, components, locations, num_locations);

    CGRect currentBounds = self.bounds;
    CGPoint topCenter = CGPointMake(CGRectGetMidX(currentBounds), 0.0f);
    CGPoint midCenter = CGPointMake(CGRectGetMidX(currentBounds), CGRectGetMidY(currentBounds));
    CGContextDrawLinearGradient(currentContext, glossGradient, topCenter, midCenter, 0);

    CGGradientRelease(glossGradient);
    CGColorSpaceRelease(rgbColorspace); 
} 
```

这个特定的示例创建了一个从顶部`UIView`到垂直中心绘制的白色光泽样式渐变。您可以将`UIView`'s设置`backgroundColor`为您喜欢的任何值，并且该光泽将绘制在该颜色之上。您还可以使用该`CGContextDrawRadialGradient`函数绘制径向渐变。

您只需要`UIView`适当地调整它的大小并将您的添加`UILabel`为它的子视图即可获得您想要的效果。

编辑（2009 年 4 月 23 日）：根据 St3fan 的建议，我已经用代码中的边界替换了视图的框架。这更正了视图原点不是 (0,0) 的情况。

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2011-01-13T03:18:51.877

**注意：**以下结果适用于旧版本的 iOS，但在 iOS 13 上进行测试时，不会发生步进。我不知道删除了哪个版本的 iOS。

* * *

`CAGradientLayer`与 相比，使用时`CGGradient`，渐变不平滑，但有明显的步进。见![这个例子](https://i.stack.imgur.com/NlPaw.png)：

为了获得更有吸引力的结果，最好使用`CGGradient`.

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2009-01-08T00:59:40.553

您还可以使用一个像素宽的图形图像作为渐变，并设置视图属性以扩展图形以填充视图（假设您正在考虑简单的线性渐变而不是某种径向图形）。

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2012-06-17T00:41:44.040

Mirko Froehlich 的回答对我有用，除非我想使用自定义颜色。诀窍是使用色调、饱和度和亮度而不是 RGB 来指定 UI 颜色。

```
CAGradientLayer *gradient = [CAGradientLayer layer];
gradient.frame = myView.bounds;
UIColor *startColour = [UIColor colorWithHue:.580555 saturation:0.31 brightness:0.90 alpha:1.0];
UIColor *endColour = [UIColor colorWithHue:.58333 saturation:0.50 brightness:0.62 alpha:1.0];
gradient.colors = [NSArray arrayWithObjects:(id)[startColour CGColor], (id)[endColour CGColor], nil];
[myView.layer insertSublayer:gradient atIndex:0]; 
```

要获得颜色的色调、饱和度和亮度，请使用内置的 xcode 颜色选择器并转到 HSB 选项卡。在此视图中，色调以度数为单位，因此将该值除以 360 即可获得您要在代码中输入的值。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2012-05-25T03:54:01.097

这就是我在 xCode 的 IB 中将工作集 UIButton 设置为透明/清晰，并且没有背景图像。

```
UIColor *pinkDarkOp = [UIColor colorWithRed:0.9f green:0.53f blue:0.69f alpha:1.0];
UIColor *pinkLightOp = [UIColor colorWithRed:0.79f green:0.45f blue:0.57f alpha:1.0];

CAGradientLayer *gradient = [CAGradientLayer layer];
gradient.frame = [[shareWordButton layer] bounds];
gradient.cornerRadius = 7;
gradient.colors = [NSArray arrayWithObjects:
                   (id)pinkDarkOp.CGColor,
                   (id)pinkLightOp.CGColor,
                   nil];
gradient.locations = [NSArray arrayWithObjects:
                      [NSNumber numberWithFloat:0.0f],
                      [NSNumber numberWithFloat:0.7],
                      nil];

[[recordButton layer] insertSublayer:gradient atIndex:0]; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-12T06:35:45.783

我在一个带有 UIImageView 子视图的视图中实现了这一点。ImageView 指向的图像是渐变的。然后我在 UIView 中设置了一个背景颜色，我有一个彩色渐变视图。接下来我根据需要使用视图，我绘制的所有内容都将在这个渐变视图下。通过在 ImageView 顶部添加第二个视图，您可以选择一些选项，无论您的绘图是低于还是高于渐变...

# .net - 列表框中带有 TargetNullValue 的 DataTemplate

> ID：422078
> 
> 赞同：4
> 
> 时间：2009-01-07T21:02:14.260
> 
> 标签：.net, wpf, xaml, targetnullvalue

我在列表框中有以下 DataTemplate

```
<ListBox Grid.Column="1" Grid.Row="2" ItemsSource="{Binding People}" SelectedItem="{Binding SelectedPerson}">
<ListBox.ItemTemplate>
    <DataTemplate>
        <TextBlock OverridesDefaultStyle="True"
               Background="{x:Null}"
               Margin="0"
               Padding="0"
               IsHitTestVisible="True"
               Text="{Binding TargetNullValue=None}"
        />
    </DataTemplate>
</ListBox.ItemTemplate> 
```

这完美地工作，显示“无”代替绑定列表中的任何空（无）值。问题是我无法单击 Null 值来选择它们。使用键盘进行选择可以完美地工作，而不是使用鼠标。我该怎么做才能使列表中的 Null 值像任何其他值一样起作用？

**编辑：**我还应该补充一点，我可以将 TextBlock 的背景更改为红色，它的显示方式和其他的一样，所以我认为这不是没有可点击的情况。我也用 Snoop 查看了它，在可视树中没有看到 Null 项目和普通项目之间有任何不同的属性。

**编辑2：**我应该补充一点，人实际上是一个代表数据库表的类。默认情况下，它使用 ToString 方法显示 People 对象。如果我使用 Path 选项绑定到正确的字段，我会得到相同的效果，我认为这会更容易阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T05:03:26.760

如果您正在寻找解决方案，也许您可​​以在这里找到您想要的： [为什么我不能在 ComboBox 中选择空值？](https://stackoverflow.com/questions/518579/why-cant-i-select-a-null-value-in-a-combobox)

Combobox 具有与 ListBox 相同的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-04T09:18:59.427

下面的博客使用附加属性提供了一个很好的解决方案，这对我来说效果很好

[http://danylaporte.blogspot.com/2008/07/wpf-combobox-and-null-values.html](http://danylaporte.blogspot.com/2008/07/wpf-combobox-and-null-values.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T14:35:33.930

这就是我认为正在发生的事情：-

我假设 ItemSource 是一个简单的裸字符串值集合（即未封装在另一个类中）。当您在对象上按下鼠标按钮时，代码隐藏将集合中项目的对象引用复制到列表框的 SelectedItem 字段。

因此，如果集合是：-“Fred”、null、“Jane”、“Mary”并且您在“Fred”上按下鼠标，则“Fred”的对象引用被复制到 SelectedItem。如果您按下第二个项目，该对象引用 (null) 将被复制到 SelectedItem。

问题是 SelectedItem 中的 NULL 值实际上意味着没有选择任何项目的特殊情况。

即使在 TargetNullValue 属性中指定了“无”，您也不会将其复制到 SelectedItem。这只是集合元素包含 NULL 值时的视觉表示。列表框只对集合的对象引用感兴趣，而不是 UI 中显示的内容。

解决此问题的一种方法是使用名为“name”的字符串字段创建一个非空对象集合。

例如

```
class People
{
   string Name {get;set;}  
}

...
...

var list = new List<People> {new People {Name = "Fred"},
                             new People {Name = null},
                             new People {Name = "Jane"},
                             }; 
```

这将意味着 List 中的任何项目都不会具有 NULL 值。

然后在 DataTemplate 的绑定中使用：-

```
Text="{Binding Path=Name, TargetNullValue=None}" 
```

即使名称为 NULL，每个元素的 SelectedItem 现在也将不为 NULL，但对您而言，缺点是 SelectedItem 现在不再是所选名称的字符串，而是对所选 People 对象的引用。

# c++ - CEditView 不显示文本

> ID：422081
> 
> 赞同：0
> 
> 时间：2009-01-07T21:03:00.500
> 
> 标签：c++, mfc

我有一个派生自 CEditView 的视图。它是只读的。我想将文本设置为一种日志记录，但屏幕上没有显示任何内容。如果我在看到文本确实在内部发生变化`temp`后在调试器中进行检查，但我在屏幕上什么也看不到。`GetEditCtrl().GetWindowText(temp);`

```
// HistoryView.cpp : implementation file
//

#include "stdafx.h"
#include "HistoryView.h"

// CHistoryView

IMPLEMENT_DYNCREATE(CHistoryView, CEditView)

CHistoryView::CHistoryView()
{

}

CHistoryView::~CHistoryView()
{
}

BEGIN_MESSAGE_MAP(CHistoryView, CEditView)
END_MESSAGE_MAP()

// CHistoryView diagnostics

#ifdef _DEBUG
void CHistoryView::AssertValid() const
{
    CEditView::AssertValid();
}

#ifndef _WIN32_WCE
void CHistoryView::Dump(CDumpContext& dc) const
{
    CEditView::Dump(dc);
}
#endif
#endif //_DEBUG

// CHistoryView message handlers

void CHistoryView::OnInitialUpdate()
{
    CEditView::OnInitialUpdate();

    // TODO: Add your specialized code here and/or call the base class
    GetEditCtrl().SetReadOnly(TRUE);
}

//!
/*!
*/
void CHistoryView::AddRow(CString message)
{
    CString temp;
    GetEditCtrl().GetWindowText(temp);

    if(temp.IsEmpty())
    {
        GetEditCtrl().SetWindowText(message);
    }
    else
    {
        GetEditCtrl().SetWindowText(temp + "\r\n" + message);
    }

    GetEditCtrl().LineScroll(2, 0);
    //GetEditCtrl().UpdateWindow(); // no effect
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T21:43:17.923

问题似乎出在您发布的代码之外的其他地方。我使用从 CEditView 派生的视图创建了一个新的 MFC 应用程序，并且您用于添加文本的代码工作正常，尽管我确实必须将文字包装`"\r\n"`在一个显式的临时文件`CString`中，如下所示：

```
GetEditCtrl().SetWindowText(temp + CString("\r\n") + message); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T21:59:26.283

正如乔尔所说，问题出在其他地方。但是，你正在做的事情有一个更大的问题。从控件复制文本，附加到字符串，然后设置文本一旦您向控件添加超过几行文本，就会产生糟糕的性能。

过去，当我需要一个窗口来显示日志消息时，我创建了一个包含`CListBox`控件的视图。要添加一行，请调用`CListBox::AddString`，然后当列表框达到某个最大行数时，调用`CListBox::DeleteString`以删除最旧的项目。这样，添加行总是很快，控件使用的内存量不会无限增长。

如果文本仅用于显示并且您不需要它是可编辑的，我建议您考虑使用 a`CListBox`代替。

我希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T11:59:16.510

除了 ChrisN 的回答，如果你想保留一个 CEdit，你可以使用

```
// sets cursor to end of text
int nCurrentLength= GetEditCtrl().GetWindowTextLength();
GetEditCtrl().SetSel(nCurrentLength,nCurrentLength); 

// appends text
GetEditCtrl().ReplaceSel("\r\nMynew line"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-09T19:46:31.987

结果是第三方 UI 工具包正在重建视图（谁知道为什么？）所以我指向它的指针已经过时了。因此，我实际上刷新了不同的视图！

# c# - 在 C# 中检查文件名是否*可能*有效（不存在）

> ID：422090
> 
> 赞同：130
> 
> 时间：2009-01-07T21:06:56.670
> 
> 标签：c#, validation, file

System.IO 命名空间中是否有检查文件名有效性的方法？

例如，`C:\foo\bar`将验证并且`:"~-*`不会

或者有点棘手，`X:\foo\bar`会验证系统上是否有`X:`驱动器，否则不会。

我想我可以自己编写这样的方法，但我对内置方法更感兴趣。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-01-07T21:11:38.780

做就是了;

```
System.IO.FileInfo fi = null;
try {
  fi = new System.IO.FileInfo(fileName);
}
catch (ArgumentException) { }
catch (System.IO.PathTooLongException) { }
catch (NotSupportedException) { }
if (ReferenceEquals(fi, null)) {
  // file name is not valid
} else {
  // file name is valid... May check for existence by calling fi.Exists.
} 
```

要创建`FileInfo`实例，该文件不需要存在。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-01-07T21:11:06.037

[你可以从这个问题](https://stackoverflow.com/questions/62771/how-check-if-given-string-is-legal-allowed-file-name-under-windows)中[`Path.GetInvalidPathChars`](https://docs.microsoft.com/en-us/dotnet/api/system.io.path.getinvalidpathchars)得到一个无效字符列表。[`GetInvalidFileNameChars`](https://docs.microsoft.com/en-us/dotnet/api/system.io.path.getinvalidfilenamechars)

正如 jberger 所指出的，此方法的响应中不包含其他一些字符。有关 Windows 平台的更多详细信息，请查看MSDN上的[命名文件、路径和命名空间。](https://docs.microsoft.com/en-us/windows/win32/fileio/naming-a-file)

正如 Micah[指出的那样](https://stackoverflow.com/questions/422090/in-c-check-that-filename-is-possibly-valid-not-that-it-exists#422131)，[`Directory.GetLogicalDrives`](https://docs.microsoft.com/en-us/dotnet/api/system.io.directory.getlogicaldrives)需要获取有效驱动器的列表。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-07-24T17:20:38.203

您可以使用 System.Uri 类。Uri 类不仅对 Web URL 有用，它还处理文件系统路径。使用 Uri.TryCreate 方法查找路径是否为根，然后使用 IsLoopback 属性确定 Uri 是否引用本地计算机。

这是一个简单的方法，用于确定字符串是否是有效的、本地的和根文件路径。

```
public bool IsPathValidRootedLocal(String pathString) {
    Uri pathUri;
    Boolean isValidUri = Uri.TryCreate(pathString, UriKind.Absolute, out pathUri);
    return isValidUri && pathUri != null && pathUri.IsLoopback;
} 
```

我相信这会奏效。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-07T21:16:58.037

您可以使用命名空间中存在的几种方法`System.IO`：

```
Directory.GetLogicalDrives() // Returns an array of strings like "c:\"
Path.GetInvalidFileNameChars() // Returns an array of characters that cannot be used in a file name
Path.GetInvalidPathChars() // Returns an array of characters that cannot be used in a path. 
```

正如建议的那样，您可以这样做：

```
bool IsValidFilename(string testName) {
    string regexString = "[" + Regex.Escape(Path.GetInvalidPathChars()) + "]";
    Regex containsABadCharacter = new Regex(regexString);
    if (containsABadCharacter.IsMatch(testName)) {
        return false;
    }

    // Check for drive
    string pathRoot = Path.GetPathRoot(testName);
    if (Directory.GetLogicalDrives().Contains(pathRoot)) {
        // etc
    }

    // other checks for UNC, drive-path format, etc

    return true;
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-09-26T14:40:44.250

以为我会发布一个解决方案，我在寻找相同问题的可靠解决方案后找到的一些答案拼凑而成。希望它可以帮助别人。

```
using System;
using System.IO;
//..

public static bool ValidateFilePath(string path, bool RequireDirectory, bool IncludeFileName, bool RequireFileName = false)
{
    if (string.IsNullOrEmpty(path)) { return false; }
    string root = null;
    string directory = null;
    string filename = null;
    try
    {
        // throw ArgumentException - The path parameter contains invalid characters, is empty, or contains only white spaces.
        root = Path.GetPathRoot(path);

        // throw ArgumentException - path contains one or more of the invalid characters defined in GetInvalidPathChars.
        // -or- String.Empty was passed to path.
        directory = Path.GetDirectoryName(path);

        // path contains one or more of the invalid characters defined in GetInvalidPathChars
        if (IncludeFileName) { filename = Path.GetFileName(path); }
    }
    catch (ArgumentException)
    {
        return false;
    }

    // null if path is null, or an empty string if path does not contain root directory information
    if (String.IsNullOrEmpty(root)) { return false; }

    // null if path denotes a root directory or is null. Returns String.Empty if path does not contain directory information
    if (String.IsNullOrEmpty(directory)) { return false; }

    if (RequireFileName)
    {
        // if the last character of path is a directory or volume separator character, this method returns String.Empty
        if (String.IsNullOrEmpty(filename)) { return false; }

        // check for illegal chars in filename
        if (filename.IndexOfAny(Path.GetInvalidFileNameChars()) >= 0) { return false; }
    }
    return true;
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-07T21:12:20.043

即使文件名有效，您仍可能希望`touch`它确保用户具有写入权限。

如果您不会在短时间内用数百个文件破坏磁盘，我认为创建一个空文件是一种合理的方法。

如果你真的想要更轻的东西，比如检查无效字符，然后将你的文件名与 Path.GetInvalidFileNameChars() 进行比较。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-07T21:11:41.370

[使用命名空间](http://msdn.microsoft.com/en-us/library/29kt2zfk.aspx)中[类](http://msdn.microsoft.com/en-us/library/system.io.path.aspx)的静态[`GetInvalidFileNameChars`方法](http://msdn.microsoft.com/en-us/library/system.io.path.getinvalidfilenamechars.aspx)来确定文件名中的哪些字符是非法的。[`Path`](http://msdn.microsoft.com/en-us/library/system.io.path.aspx)[`System.IO`](http://msdn.microsoft.com/en-us/library/29kt2zfk.aspx)

要在路径中执行此操作，请在同一类上调用静态[`GetInvalidPathChars`方法。](http://msdn.microsoft.com/en-us/library/system.io.path.getinvalidpathchars.aspx)

要确定路径的根是否有效，您将调用类上的静态[`GetPathRoot`方法](http://msdn.microsoft.com/en-us/library/system.io.path.getpathroot.aspx)`Path`来获取根，然后使用[`Directory`该类](http://msdn.microsoft.com/en-us/library/system.io.directory.aspx)来确定它是否有效。然后您可以正常验证路径的其余部分。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-07T21:16:34.963

如果路径或文件名无效，一些 System.IO.Path 方法将引发异常：

*   Path.IsPathRooted()
*   Path.GetFileName()

[http://msdn.microsoft.com/en-us/library/system.io.path_methods.aspx](http://msdn.microsoft.com/en-us/library/system.io.path_methods.aspx)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-02-12T06:24:51.330

试试这个方法，它会尝试覆盖所有可能的异常情况。它适用于几乎所有与 Windows 相关的路径。

```
/// <summary>
/// Validate the Path. If path is relative append the path to the project directory by default.
/// </summary>
/// <param name="path">Path to validate</param>
/// <param name="RelativePath">Relative path</param>
/// <param name="Extension">If want to check for File Path</param>
/// <returns></returns>
private static bool ValidateDllPath(ref string path, string RelativePath = "", string Extension = "") {
    // Check if it contains any Invalid Characters.
    if (path.IndexOfAny(Path.GetInvalidPathChars()) == -1) {
        try {
            // If path is relative take %IGXLROOT% as the base directory
            if (!Path.IsPathRooted(path)) {
                if (string.IsNullOrEmpty(RelativePath)) {
                    // Exceptions handled by Path.GetFullPath
                    // ArgumentException path is a zero-length string, contains only white space, or contains one or more of the invalid characters defined in GetInvalidPathChars. -or- The system could not retrieve the absolute path.
                    // 
                    // SecurityException The caller does not have the required permissions.
                    // 
                    // ArgumentNullException path is null.
                    // 
                    // NotSupportedException path contains a colon (":") that is not part of a volume identifier (for example, "c:\"). 
                    // PathTooLongException The specified path, file name, or both exceed the system-defined maximum length. For example, on Windows-based platforms, paths must be less than 248 characters, and file names must be less than 260 characters.

                    // RelativePath is not passed so we would take the project path 
                    path = Path.GetFullPath(RelativePath);

                } else {
                    // Make sure the path is relative to the RelativePath and not our project directory
                    path = Path.Combine(RelativePath, path);
                }
            }

            // Exceptions from FileInfo Constructor:
            //   System.ArgumentNullException:
            //     fileName is null.
            //
            //   System.Security.SecurityException:
            //     The caller does not have the required permission.
            //
            //   System.ArgumentException:
            //     The file name is empty, contains only white spaces, or contains invalid characters.
            //
            //   System.IO.PathTooLongException:
            //     The specified path, file name, or both exceed the system-defined maximum
            //     length. For example, on Windows-based platforms, paths must be less than
            //     248 characters, and file names must be less than 260 characters.
            //
            //   System.NotSupportedException:
            //     fileName contains a colon (:) in the middle of the string.
            FileInfo fileInfo = new FileInfo(path);

            // Exceptions using FileInfo.Length:
            //   System.IO.IOException:
            //     System.IO.FileSystemInfo.Refresh() cannot update the state of the file or
            //     directory.
            //
            //   System.IO.FileNotFoundException:
            //     The file does not exist.-or- The Length property is called for a directory.
            bool throwEx = fileInfo.Length == -1;

            // Exceptions using FileInfo.IsReadOnly:
            //   System.UnauthorizedAccessException:
            //     Access to fileName is denied.
            //     The file described by the current System.IO.FileInfo object is read-only.-or-
            //     This operation is not supported on the current platform.-or- The caller does
            //     not have the required permission.
            throwEx = fileInfo.IsReadOnly;

            if (!string.IsNullOrEmpty(Extension)) {
                // Validate the Extension of the file.
                if (Path.GetExtension(path).Equals(Extension, StringComparison.InvariantCultureIgnoreCase)) {
                    // Trim the Library Path
                    path = path.Trim();
                    return true;
                } else {
                    return false;
                }
            } else {
                return true;

            }
        } catch (ArgumentNullException) {
            //   System.ArgumentNullException:
            //     fileName is null.
        } catch (System.Security.SecurityException) {
            //   System.Security.SecurityException:
            //     The caller does not have the required permission.
        } catch (ArgumentException) {
            //   System.ArgumentException:
            //     The file name is empty, contains only white spaces, or contains invalid characters.
        } catch (UnauthorizedAccessException) {
            //   System.UnauthorizedAccessException:
            //     Access to fileName is denied.
        } catch (PathTooLongException) {
            //   System.IO.PathTooLongException:
            //     The specified path, file name, or both exceed the system-defined maximum
            //     length. For example, on Windows-based platforms, paths must be less than
            //     248 characters, and file names must be less than 260 characters.
        } catch (NotSupportedException) {
            //   System.NotSupportedException:
            //     fileName contains a colon (:) in the middle of the string.
        } catch (FileNotFoundException) {
            // System.FileNotFoundException
            //  The exception that is thrown when an attempt to access a file that does not
            //  exist on disk fails.
        } catch (IOException) {
            //   System.IO.IOException:
            //     An I/O error occurred while opening the file.
        } catch (Exception) {
            // Unknown Exception. Might be due to wrong case or nulll checks.
        }
    } else {
        // Path contains invalid characters
    }
    return false;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-07T21:14:16.107

我不知道任何开箱即用的东西可以为您验证所有这些，但是`Path`课程`.NET`可以极大地帮助您。

首先，它具有：

```
char[] invalidChars = Path.GetInvalidFileNameChars(); //returns invalid charachters 
```

或者：

```
Path.GetPathRoot(string); // will return the root. 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-07T21:38:04.750

正如其他人所展示的那样，我很幸运地使用了正则表达式。

要记住的一件事是，Windows 至少禁止某些包含合法字符的文件名。我想到了几个：com、nul、prn。

我现在没有它，但我有一个将这些文件名考虑在内的正则表达式。如果你愿意，我可以发布它，否则我相信你可以像我一样找到它：谷歌。

-杰伊

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-07T21:13:32.427

可能最糟糕的方法是构建一个自定义方法，混合正则表达式和文件系统上的小查找（例如，查看驱动器）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-07T21:24:04.340

这将为您提供机器上的驱动器：

```
System.IO.DriveInfo.GetDrives() 
```

这两种方法会让你检查坏字符：

```
System.IO.Path.GetInvalidFileNameChars();
System.IO.Path.GetInvalidPathChars(); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-06-10T07:11:19.830

认为现在回答为时已晚，但是... :) 如果路径带有卷名，您可以编写如下内容：

```
using System;
using System.Linq;
using System.IO;

// ...

var drives = Environment.GetLogicalDrives();
var invalidChars = Regex.Replace(new string(Path.GetInvalidFileNameChars()), "[\\\\/]", "");
var drive = drives.FirstOrDefault(d => filePath.StartsWith(d));
if (drive != null) {
    var fileDirPath = filePath.Substring(drive.Length);
    if (0 < fileDirPath.Length) {
        if (fileDirPath.IndexOfAny(invalidChars.ToCharArray()) == -1) {
            if (Path.Combine(drive, fileDirPath) != drive) {
                // path correct and we can proceed
            }
        }
    }
} 
```

# python - 用户如何使用 shell 与我的 python 脚本通信？

> ID：422091
> 
> 赞同：3
> 
> 时间：2009-01-07T21:07:23.750
> 
> 标签：python

如何在 python 中实现以下内容？

```
#include <iostream>

int main() {
   std::string a; 
   std::cout <<  "What is your name? ";
   std::cin >> a; 
   std::cout << std::endl << "You said: " << a << std::endl;
} 
```

输出：

> 你叫什么名字？缺口
> 
> 你说：尼克

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T21:14:14.190

称呼

```
name = raw_input('What is your name?') 
```

和

```
print 'You said', name 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T21:09:19.863

查看`print`语句和`raw_input()`函数。

或查看`sys.stdin.read()`和`sys.stdout.write()`。

使用时`sys.stdout`，不要忘记冲洗。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T21:25:01.703

```
print "You said:", raw_input("What is your name? ") 
```

编辑：正如 Swaroop 提到的，这不起作用（我猜`raw_input`刷新标准输出）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T00:14:53.233

python 2.x 最简单的方法是

```
var = raw_input()
print var 
```

另一种方法是使用 input() 函数；nb input()，不像 raw_input() 期望输入是一个有效的 python 表达式。在大多数情况下，您应该首先使用 raw_input() 并对其进行验证。你也可以使用

```
import sys
var = sys.stdin.read()
lines = sys.stdin.readlines()
more_lines = [line.strip() for line sys.stdin]

sys.stdout.write(var)
sys.stdout.writelines(lines+more_lines)
# important
sys.stdout.flush() 
```

然而，从 python 3.0 开始， input() 替换 raw_input() 并且 print 成为一个函数，所以

```
var = input()
print(var) 
```

# sql - 在 SQL 中维护 LastUpdatedDate 列的最佳方法是什么？

> ID：422102
> 
> 赞同：7
> 
> 时间：2009-01-07T21:08:45.340
> 
> 标签：sql, sql-server, database, sql-server-2005, triggers

假设我有一个数据库表，其中包含上次更新或插入的时间日期列。哪个更可取：

1.  让触发器更新字段。
2.  让执行插入/更新的程序设置该字段。

第一个选项似乎是最简单的，因为我什至不必重新编译即可，但这并不是什么大不了的事。除此之外，我很难想出任何理由去做一个而不是另一个。有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T21:14:58.027

第一个选项可能更健壮，因为数据库将维护该字段。这伴随着使用触发器的可能开销。

如果将来您可以让其他应用程序通过它们自己的接口写入此表，我会使用触发器，这样您就不会在其他任何地方重复该逻辑。

如果您的应用程序差不多，或者任何其他应用程序将通过相同的数据层访问数据库，那么我会避免触发器可以诱导并将逻辑直接放入您的数据层（SQL、ORM、存储过程等）的噩梦。 ）。

当然，无论哪种情况，您都必须确保您的时间来源（您的应用程序、您的用户的个人电脑、您的 SQL 服务器）是准确的。

* * *

关于为什么我不喜欢触发器：

也许我称他们为噩梦是轻率的。像其他一切一样，它们是适度的。如果您将它们用于此类非常简单的事情，我可以加入。

当触发器代码变得复杂（且昂贵）时，触发器开始导致很多问题。它们是您执行的每个插入/更新/删除查询的隐藏税（取决于触发器的类型）。如果该税是可以接受的，那么它们可以成为这项工作的正确工具。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-07T23:29:28.037

您没有提到**3\. 使用存储过程更新表。**该过程可以根据需要设置时间戳。

也许这对你来说不可行，但我没有看到它提到。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T21:20:06.597

只要我使用我信任的触发器的 DBMS，我总是会选择触发器选项。它允许 DBMS 处理尽可能多的事情，这通常是一件好事。

它可以确保在任何情况下时间戳列具有正确的值。开销可以忽略不计。

唯一不利于触发器的是可移植性。如果这不是问题，我认为不存在该往哪个方向发展的问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T21:18:19.250

我会说触发器以防万一有人使用除您的应用程序之外的其他东西来更新表，您可能还希望拥有一个 LastUpdatedBy 并为此使用 SUSER_SNAME() ，这样您就可以看到谁进行了更新

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-08T00:05:27.353

我是所有事情的存储过程的支持者。您的更新过程可能包含该列的 GETDATE()。

而且我不喜欢这种更新的触发器。缺乏对触发器的可见性往往会导致混乱。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-08T00:15:07.553

这对我来说听起来像是业务逻辑......我更愿意将其放入代码中。让数据库管理数据的存储……不多也不少。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-08T00:46:47.553

触发器是一种祝福和诅咒。

祝福：您可以使用它们来启用各种自定义约束检查和数据管理，而无需后端系统知识或更改。

诅咒：你不知道背后发生了什么。附加对象导致的并发问题/死锁带入了最初未预期的事务。幻象行为，包括会话环境更改、不可靠的行数。过度触发条件..额外的热点/性能损失。

这个问题的答案（隐式（触发）或显式（代码）更新日期）通常在上下文中占很大比重。例如，如果您使用上次更改日期作为信息字段，您可能只想在“用户”实际对行进行显着更改时才更改它，而不是自动更新用户不关心的某种内部标记.

如果您使用触发器进行更改同步，或者您无法控制正在执行触发器的代码，则更有意义。

我对触发器的建议使用它要小心。大多数系统允许您根据更改的操作和字段过滤执行。正确使用“之前”和“之后”触发器会对性能产生重大影响。

最后，一些系统能够对多个更改（在事务中影响多行）执行单个触发器，您的代码应该准备好将自身作为批量更新应用于多行。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-07T21:23:41.160

通常我会说做数据库端，但这取决于你的应用程序。如果您使用的是 LINQ-to-SQL，您只需将该字段设置为 Timestamp 并让您的 DAL 使用 Timestamp 字段进行并发。它会自动为您处理它，因此必须重复代码是非事件。

如果您自己编写 DAL，那么我更有可能在数据库端处理这个问题，因为它使编写用户界面更加灵活——尽管，我可能会在具有“公共" 访问和表被锁定 - 您不希望任何小丑出现并通过直接写入表来绕过您的存储过程......除非您计划使您的 DAL 成为任何未来应用程序必须用来访问的独立组件数据库，在这种情况下，您可以将其直接编码到 DAL 中 - 当然，只有在您可以保证访问数据库的每个人都通过您的 DAL 组件这样做的情况下，您才应该这样做。

如果您要允许对数据库的“公共”访问以插入表中，那么您将不得不使用触发器，因为否则任何人都可以插入/更新表中的单个字段，并且更新的字段永远不会更新.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-07T23:14:31.700

我会在数据库中维护日期，即触发器、存储过程等。在大多数数据库驱动的应用程序中，用户应用程序不会成为业务用户获取数据的唯一方式。有报告工具、数据提取、用户 SQL 等。还有由 DBA 完成的更新和更正，应用程序也不会提供日期。

但老实说，我不会从应用程序中执行此操作的#1 原因是您无法控制客户端计算机上的日期/时间。他们可能会回滚它以从试用许可证中获得更多天数，或者可能只是想对您的程序做坏事。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-07T23:22:06.287

如果您的数据库支持字段的默认值，您可以在没有触发器的情况下执行此操作。例如，在 SQL Server 2005 中，我有一个表，其中的字段创建如下：

```
create table dbo.Repository
   (
    ...
   last_updated     datetime default getdate(),
    ...
   ) 
```

然后插入代码只是将该字段留在插入字段列表之外。

我忘记了这只适用于第一个插入 - 我也有一个更新触发器，用于更新日期字段并将更新记录的副本放在我的历史记录表中 - 我会发布......但编辑器不断出错在我的代码上...

最后：

```
create trigger dbo.Repository_Upd on dbo.Repository instead of update
as
--**************************************************************************
--   Trigger: Repository_Upd
--    Author: Ron Savage
--      Date: 09/28/2008
--
-- Description:
-- This trigger sets the last_updated and updated_by fields before the update
-- and puts a copy of the updated row into the Repository_History table.
--
-- Modification History:
-- Date        Init  Comment
-- 10/22/2008  RS    Blocked .prm files from updating the history as they
--                   get updated every time the cfg file is run.
-- 10/21/2008  RS    Updated the insert into the history table to use the
--                   d.last_updated field from the Repository table rather
--                   than getdate() to avoid micro second differences.
-- 09/28/2008  RS    Created.
--**************************************************************************
begin
   --***********************************************************************
   -- Update the record but fill in the updated_by, updated_system and
   -- last_updated date with current information.
   --***********************************************************************
   update cr set
      cr.filename           = i.filename,
      cr.created_by         = i.created_by,
      cr.created_system     = i.created_system,
      cr.create_date        = i.create_date,
      cr.updated_by         = user,
      cr.updated_system     = host_name(),
      cr.last_updated       = getdate(),
      cr.content            = i.content
   from
      Repository cr

      JOIN Inserted i
         on (i.config_id = cr.config_id);

   --***********************************************************************
   -- Put a copy in the history table
   --***********************************************************************
   declare @extention varchar(3);
   select @extention = lower(right(filename,3)) from Inserted;

   if (@extention <> 'prm')
      begin
      Insert into Repository_History
         select
            i.config_id,
            i.filename,
            i.created_by,
            i.created_system,
            i.create_date,
            user           as updated_by,
            host_name()    as updated_system,
            d.last_updated,
            d.content
         from
            Inserted i

            JOIN Repository d
               on (d.config_id = i.config_id);
      end
end 
```

罗恩

# wcf - 创建 WCF 服务

> ID：422103
> 
> 赞同：0
> 
> 时间：2009-01-07T21:08:46.900
> 
> 标签：wcf

一个类能否具有“服务契约”属性及其方法“操作契约”。或者这些是否需要应用于类必须实现的接口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T21:17:35.307

您可以将 ServiceContract 和 OperationContract 属性放在一个类上，但这被认为是不好的做法。最好抽象出一个接口，然后将属性（与合同相关，而不是与实现相关，因为 WCF 中确实存在这些属性）放在合同上。

# firefox - 停止 Firefox 扩展弹出集自动隐藏

> ID：422104
> 
> 赞同：1
> 
> 时间：2009-01-07T21:09:09.677
> 
> 标签：firefox, popup

我正在构建一个 Firefox 扩展。我有一个弹出集，当按下工具栏按钮时显示，并且还有工作代码来手动关闭弹出集。

我遇到的问题是，每当我单击其他地方时，弹出集就会消失。我想禁用这种自动关闭行为。我确定我已经看到了一个弹出集或面板属性来控制它，但再也找不到参考了。有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T22:14:28.077

排序。我是个笨蛋。原来有一个 noautohide 属性可以放在面板上：

```
<popupset>
    <panel noautohide="true">
        <!-- insert further content here -->
    </panel>
</popupset> 
```

我正在寻找popupset属性无济于事。

# ruby-on-rails - 如何在 Ruby on Rails 中动态地将方法添加到 Math 类？

> ID：422108
> 
> 赞同：1
> 
> 时间：2009-01-07T21:10:15.617
> 
> 标签：ruby-on-rails, ruby, metaprogramming, introspection

我正在尝试将以下方法添加到 Ruby on Rails 中的 Math 类：

```
class Math
  def self.round_with_precision(number, precision)
    scalar = 10.0 ** precision
    number = number * scalar
    number = number.round
    number = number / scalar
    return number;
  end
end 
```

然后我将以下内容添加到我的 environment.rb 中：

```
require 'lib/math' 
```

当我打开 Rails 控制台时，我收到以下错误：'./lib/math.rb:2:TypeError Math is not a class'

似乎我忽略了一些非常简单的事情。

有什么想法吗？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-07T21:12:50.400

数学是一个模块，只需将类重命名为模块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T21:23:17.417

您可以将包含此代码的文件放在 config/initializers 中，它将自动包含在内。~ 仅供参考。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-09T05:32:33.963

如果使用`instance_eval`，则不必担心是否使用`class`或`module`：

```
Math.instance_eval do
  def round_with_precision(number, precision)
    scalar = 10.0 ** precision
    (number * scalar).round / scalar
  end
end 
```

# objective-c - Objective-C Cocoa 应用程序中的正则表达式

> ID：422138
> 
> 赞同：173
> 
> 时间：2009-01-07T21:18:54.507
> 
> 标签：objective-c, regex, cocoa

最初的谷歌搜索表明在 Objective-C Cocoa 应用程序中没有内置的方法来执行正则表达式。

所以四个问题：

1.  这是真的吗？

2.  你在跟我开玩笑吗？

3.  好的，那有没有你推荐的不错的开源库？

4.  有什么方法可以在不导入库的情况下足够接近，也许使用 NSScanner 类？

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2010-08-24T07:56:14.680

我注意到从 iOS 4.0 开始，Apple 提供了一个[NSRegularExpression 类](https://developer.apple.com/library/ios/documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)。此外，从 10.7 开始，该类[在 OS X 下](https://developer.apple.com/library/mac/documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)可用。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-01-08T10:34:30.487

1.  是的，Cocoa 中没有正则表达式支持。如果您只对布尔匹配感兴趣，您可以使用支持 ICU 正则表达式语法的[NSPredicate 。](http://snipplr.com/view/5165/testing-regular-expressions-for-nsstring/)但是通常你对匹配的位置或子表达式的位置感兴趣，而你不能用 NSPredicate 得到它。
2.  如前所述，您可以使用[正则表达式 POSIX 函数](http://developer.apple.com/DOCUMENTATION/DARWIN/Reference/ManPages/man3/regcomp.3.html)。[但是它们被认为很慢，并且与其他解决方案（ICU/ pcre](http://pcre.org) ）相比，正则表达式语法是有限的。
3.  有许多 OSS 库，[CocoaDev 有一个广泛的列表](http://cocoadev.com/RegularExpressions)。
4.  [例如RegExKitLite](http://regexkit.sourceforge.net/RegexKitLite/index.html)不需要任何库，只需将 .m 和 .h 添加到您的项目中。

    （我对 RegExKitLite 的抱怨是它通过类别扩展了 NSString，但它也可以被视为一个特性。它还使用了操作系统附带的非公共 ICU 库，Apple 不推荐这种库。）

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-01-07T21:26:53.523

RegexKit 是我发现的最好的。非常可可：是的。我在我们的几个 iPhone 应用程序中使用“Lite”版本：

[源锻造](http://regexkit.sourceforge.net/)

[林戈尼科尔](http://lingonikorg.com)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-07T21:25:20.733

您可以使用 POSIX 正则表达式库（适用于 POSIX 兼容的操作系统）。尝试

```
man 3 regex 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-04-06T15:51:36.023

我用来解决 REGEX 和 JSON 解析问题的廉价而肮脏的 hack 解决方案是创建一个 UIWebView 对象并注入 Javascript 函数来进行解析。然后，javascript 函数返回我关心的值（或值列表）的字符串。事实上，您可以存储为特定任务定制的一组小型函数库，然后根据需要调用它们。

我不知道这种技术是否可以扩展到大量的重复解析请求，但是对于快速事务性的东西，它可以在不依赖任何您可能不理解的额外外部资源或代码的情况下完成工作。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-07T23:20:38.787

我喜欢使用 PCRE 的 AGRegex 框架，如果你习惯了 PCRE 语法，它会很方便。该框架的最佳版本是 Colloquy IRC 客户端中的版本，因为它已升级为使用 PCRE 6.7：

[http://colloquy.info/project/browser/trunk/Frameworks/AGRegex](http://colloquy.info/project/browser/trunk/Frameworks/AGRegex)

它非常轻巧，比 RegExKit 轻得多（尽管当然没有那么强大）。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-02-18T18:15:24.653

`NSRegularExpression`自 Mac OS X v10.7 和 IOS 4.0 起可用。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-21T07:59:44.440

在我搜索这个主题的过程中，我遇到了使用[Oniguruma的](http://www.geocities.jp/kosako3/oniguruma/)[CocoaOniguruma](http://limechat.net/cocoaoniguruma/) ，这是 Ruby1.9 和 PHP5 背后的正则表达式引擎。[与现有的OregKit](http://www8.ocn.ne.jp/~sonoisa/OgreKit/index.html)（日文）相比，它似乎更新了一些。不确定这些如何与其他绑定叠加。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-03-05T20:41:59.050

谷歌搜索了一下，找到了这个库： [RegexOnN​​SString](https://github.com/carlbrown/RegexOnNSString)

开源库，包含以下功能：

```
-(NSString *) stringByReplacingRegexPattern:(NSString *)regex withString:(NSString *) replacement caseInsensitive:(BOOL)ignoreCase 
```

并使用`NSRegularExpression`类。非常易于使用，无需担心任何事情。

请注意`NSRegularExpression`，正如 Datasmid 提到的，自 Mac OS X v10.7 和 IOS 4.0 起可用。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-06-18T16:27:51.383

我让它变得容易。我将一个新的 C++ 文件添加到我的 Objective C 项目中，将其重命名为 .mm，然后在其中创建一个标准 C++ 类。然后，我在“public:”部分为一个 C++ 函数创建了一个静态类方法，该函数接受一个 NSString 并返回一个 NSString（或 NSArray，如果你想要的话）。然后我将 NSString 转换为 C++ std::string，如下所示：

```
// If anyone knows a more efficient way, let me know in the comments.
// The "if" condition below is because ObjC crashes if converting to
// std::string if the string is nil or empty.
// assume #include <string>
std::string s = "";
if (([sInput != nil]) && (!([sInput isEqualTo:@""]))) {
  std::string sTemp([sInput UTF8String]);
  s = sTemp;
} 
```

从那里，我可以像这样使用 regex_replace：

```
// assume #include <regex>
std::string sResult = std::regex_replace(sSource,sRegExp,sReplaceWith); 
```

然后，我可以将该 std::string 转换回 NSString ：

```
NSString *sResponse2 = @(sResult.c_str()); 
```

如果你只是为了这个功能而使用这个C++，那么你可能会发现调用这个文件extra.mm（类名Extra）并将这个静态类方法放入其中，然后在情况到来时添加其他静态类方法是合适的在 C++ 中这样做才有意义，因为在某些情况下它不那么麻烦。（在某些情况下，ObjC 用更少的代码行来做某事，而在某些情况下，C++ 用更少的代码行来做这件事。）

PS 还有另一种方法是使用 .mm 文件，但围绕 std::string 和 std::regex_replace()（或 regex_match()）的使用创建一个 Objective C 包装器。

# python - 如何访问 Django 模板中的用户配置文件？

> ID：422140
> 
> 赞同：94
> 
> 时间：2009-01-07T21:19:13.993
> 
> 标签：python, django, django-templates

我正在使用[`AUTH_PROFILE_MODULE`](http://docs.djangoproject.com/en/dev/topics/auth/#storing-additional-information-about-users).

我们可以使用 Django 模板访问用户，`{{ request.user }}`但是我们如何访问配置文件中的字段，因为配置文件只能通过函数访问`user.get_profile()`？

是否真的需要每次都将配置文件显式传递到模板中？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2009-01-07T21:24:09.583

使用`{{ request.user.get_profile.whatever }}`. Django 的模板语言会自动调用可调用的东西——在本例中是`.get_profile()`方法。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2010-01-22T17:00:28.043

不知道为什么它对我不同，但我需要使用 {{user}} 而不是 {{request.user}}。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-07T21:41:55.757

是的，可以使用 request.user.get_profile 从模板访问配置文件

但是有一个小**警告**：并非所有用户都有个人资料，在我的情况下是管理员用户。所以在这种情况下直接从模板调用 `{{ request.user.get_profile.whatever }}`会导致错误。

如果您确定所有用户始终拥有配置文件，则可以安全地从模板调用，否则`get_profile()`从视图中的 try-except 块中调用并将其传递给模板。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-04-16T17:34:26.583

如果它对任何人有帮助，我在模板中使用了以下内容：

用户名：`{{ user.username }}`

用户全名：`{{ user.get_full_name }}`

用户组：`{{ user.groups.all.0 }}`

电子邮件：`{{ user.email }}`

会议开始于：`{{ user.last_login }}`

**示例结果如下：**

> 用户：审计员ezio
> 
> 用户组：auditGroup
> 
> 用户名：testUser03
> 
> 邮箱：testuser03@auditor.com
> 
> 会议于 2018 年 4 月 16 日晚上 9:38 开始

谢谢 ：）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-03-26T22:33:24.190

如果您使用 Django > 1.5，则不能再使用`get_profile`.

如果您有旧版应用程序，则应`AUTH_PROFILE_MODULE = 'myapp.profile'`从`settings.py`.

如果您`models.OneToOneField(User)`在 Profile 类中使用，您可以简单地使用

```
{{ request.user.profile.whatever }} 
```

在你的 Django 模板中

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-08-28T10:10:59.080

在职的 ！

在您的个人资料模型中提供related_name

```
user = models.OneToOneField(AUTH_USER_MODEL, related_name="user_profile", on_delete=models.CASCADE) 
```

然后在模板中使用。这里 company_name 是配置文件表中的字段

```
{{ request.user.user_profile.company_name }} 
```

# wcf - 了解 WCF

> ID：422142
> 
> 赞同：7
> 
> 时间：2009-01-07T21:19:32.837
> 
> 标签：wcf

谁能给我指出一个用图片和简单的代码片段解释 WCF 的资源。我厌倦了谷歌搜索并在所有搜索结果中找到相同的“ABC”文章。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-31T19:32:31.527

WCF 是一项非常复杂的技术，在我看来，它的文档记录非常少。启动和运行起来非常容易，但是运行大型应用程序的性能调整可能非常复杂，并且需要大量的试验和错误。有一天一切正常，然后您发现只有一个 Channel 一直在等待新连接，并且您需要在自定义绑定上调整一个配置设置，以允许更多通道等待以便调用在使用通道和启动下一个通道之间不会失败。

一般来说，Nicholas Allen 的博客是信息的金矿。然而，Windbg 一直是我最好的朋友，试图解释来自 WCF 的一些非常奇怪的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T21:28:17.187

[这是一个非常简单的例子](http://community.opennetcf.com/articles/cf/archive/2007/11/29/an-introduction-to-wcf-for-device-developers.aspx)。它特定于 CE/移动设备，但这个概念与 PC 和 PC 没有什么不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-31T18:58:05.103

我发现以下两本书非常适合快速了解 WCF：

*   编程 WCF 服务 (Lowy - O'Reilly)
*   Pro WCF (Peiris, Mulder - Apress)

它们都从更多的 WCF 概念描述开始，因此您可以理解这些概念和术语。这非常有用，因为它允许您将任何 google 搜索范围缩小到更具体的概念。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T21:31:53.250

这篇文章打破了[对 WCF](http://debasishpramanik.wordpress.com/2008/01/30/understanding-wcf/)的理解以及为什么它是在一个简单的项目符号列表中开发的。

# version-control - 源代码控制的最佳实践是什么？

> ID：422143
> 
> 赞同：6
> 
> 时间：2009-01-07T21:19:45.740
> 
> 标签：version-control

在最近一次工作中的“事故”之后，重新引入了一些以前已修复的错误，我被要求记录一组使用源代码控制（在本例中为 CVS）的指南。

您认为使用源代码控制的最佳实践是什么？特别是，您如何管理分支和标签，以及如何确保在继续开发新功能的同时可以修补当前的生产版本？就上下文而言，团队规模为两个地点的最多 10 名开发人员。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T21:27:55.970

[源代码管理的 8 条诫命](http://scottonwriting.net/sowblog/archive/2008/11/13/163320.aspx)几乎总结了这一点。

关于分支和标记我们在工作中所做的主题是：

**标签**

每当环境释放完成时，它至少会标有释放日期。然后设置所有（相关）错误，以便“在发布中解决”是这个标签。

**分枝**

仅根据需要创建。一个分支是从标签上完成的，以便可以对先前发布的版本进行更改（即，在生产中修复一个错误，而不包括所有其他错误修复）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T21:27:09.827

Eric Sink 已经在他的[Source Control Howto](http://www.ericsink.com/scm/source_control.html)中整合了一个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T21:49:41.293

我不确定我是否会将“CVS”和“最佳实践”放在同一个句子中。对于源代码控制，还有许多其他更好、更现代的选择，这些选择得到了社区的大力支持。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T23:52:25.497

主线模型。豆腐秤。

阅读：http: [//oreilly.com/catalog/practicalperforce/chapter/ch07.pdf](http://oreilly.com/catalog/practicalperforce/chapter/ch07.pdf)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T00:32:35.130

我们非常非常努力地不分支。如果我们确实创建了一个分支，那是一个团队的决定，并且会经过仔细审查。所以我想这种做法是“不要轻易分支”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T21:30:21.567

尽可能频繁地更新（取决于项目的增长速度）这样固定文件将无法重新引入。指导开发人员在提交之前执行更新。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T21:31:17.727

有不同类型的[工作流程](http://bazaar-vcs.org/Workflows)，您必须考虑哪种工作流程最能满足您的团队需求。

我也总是推荐[SVN Book](http://svnbook.red-bean.com/en/1.4/svn-book.html)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T21:34:09.470

“实用版本控制（使用 Subversion）”一书是一个非常好的起点。尽管它的示例是特定于 Subversion 的，但它是对所有重要概念和实践的一个很好的介绍。

# time - 有没有人推荐一个好的任务/时间管理工具？

> ID：422158
> 
> 赞同：5
> 
> 时间：2009-01-07T21:25:15.633
> 
> 标签：time, time-management, task-tracking

有没有人推荐一个好的任务/时间管理工具。

理想情况下，这将只跟踪编程任务/项目以及花费的时间以及生成周末报告的选项将是有利的

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T22:27:45.040

在低端，对于免费软件，有[ToDoList](http://www.abstractspoon.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T21:28:58.917

[FogBugz](http://www.fogcreek.com/FogBUGZ)也是您的朋友。FB6 是一个很棒的 PM 跟踪工具，我一直在使用 5 来管理我的团队，我正试图从那些拿着钱包的人身上撬出 FB 6 的钱。

对于开源/ 1 dev 它也是免费的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T07:20:19.557

具有协作功能的好工具：http: [//www.producteev.com/](http://www.producteev.com/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-07-23T11:32:20.207

我们一直在使用[Eylean](http://www.eylean.com/)进行项目管理。它具有您正在寻找的所有功能，然后是一些功能。您将能够将您的任务可视化为任务板上的便笺，估计它们将花费多少时间，然后跟踪它们以查看它们实际占用了多少时间。它可能比您正在寻找的东西多一点，但我真的很喜欢这个软件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T21:27:06.533

JIRA 具有日志工作功能。您根据每个任务/问题记录您的工作。我的老板很喜欢这些报告。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T22:37:01.840

如果您与大型团队一起工作，Team Foundation 拥有一切。工作项跟踪（可以与签入和构建相关联！）、报告、各种指标。对于一个小型组织来说，虽然成本可能太高了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T21:34:09.843

[Voo2do](http://voo2do.com/)很不错。我以前用过，很好用，因为上手非常简单，但是你可以根据需要使用扩展的功能。还有一个 API，可以填补缺失的功能。

*   按项目组织任务
*   跟踪花费和剩余的时间
*   通过电子邮件添加任务
*   发布任务列表
*   像纸一样简单，但在网络上 24x7
*   支持软件大师 Joel Spolsky 的 Painless Software Scheduling 方法
*   花哨的“ajax”界面
*   用于自定义应用程序的 API

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T22:36:33.617

对于基本的命令行任务跟踪，我使用[http://wtime.sourceforge.net/](http://wtime.sourceforge.net/)它简单但有效，但只有顶级任务。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-14T06:04:06.700

这是对 FogBugz 的另一票。最初我购买它是为了管理客户项目，但我已经成长为使用它来跟踪我生活中几乎所有相关的待办事项——简单的任务、要记住的东西、小型个人/家庭项目、要阅读的书籍等. 它功能丰富，有一些很好的集成点，虽然它仍然非常面向软件类型任务，但很方便。价格非常合理。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-14T07:04:28.653

对于我自己的任务管理 - Outlook

*   它是中心化的
*   我必须打开我的电子邮件，所以我不需要担心另一个应用程序
*   同步到服务器，这样我就可以在有浏览器的任何地方获取它
*   与手机同步，以便我不在办公桌时收到提醒
*   电子邮件可以标记为任务

用于团队的任务管理 - 带有 SP 1 的 TFS 2008。其中有一些很好的增强功能，其中的警报会产生很大的不同。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-14T07:28:37.170

我们使用[Smartsheet](http://www.smartsheet.com)作为任务和协作工具。它非常基于电子表格的想法，您可以将自己的列添加到其中。工作表可以在团队成员之间共享，当有任何更改时它会向您发送电子邮件，它具有文件共享（无限制） - 您还可以授予外部人员访问权限，以便他们可以提出错误通知等，然后通知团队。非常适合我们，因为它非常灵活

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-21T19:19:03.123

我推荐[Task Coach](http://www.taskcoach.org)，一个开源的、单人的、分层的任务管理器，它允许时间跟踪、类别、提醒等等。

# cocoa-touch - 在随机页面上启动 Horizo ntal UIScrollView

> ID：422168
> 
> 赞同：1
> 
> 时间：2009-01-07T21:27:27.580
> 
> 标签：cocoa-touch

我有一个水平的 UIScrollView，上面有一堆不同的页面。我想以编程方式显示每个用户选择的某个页面。目前，我不知道如何开始在页面中间显示它。

有人对这个有经验么？任何帮助将不胜感激。

谢谢。

编辑：我想我可以通过设置 UIScrollView 对象的 contentOffset.x 来做到这一点。但是，该属性不可设置。有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T21:52:06.220

你会想要使用`setContentOffset`.

```
CGFloat offsetX = kPageWidth * pageIndex;
[scrollView setContentOffset:CGPointMake(offsetX, 0)
                    animated:YES]; 
```

# java - 如何限制 java 哈希表中的条目数？

> ID：422181
> 
> 赞同：9
> 
> 时间：2009-01-07T21:32:09.833
> 
> 标签：java, hashtable

是否有一种技术可以让我指定一个数字 n，以便在插入第 (n + 1) 个条目时，首先删除最旧的条目，确保哈希表的大小始终限制为 n？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-07T22:11:48.457

[LinkedHashMap](http://java.sun.com/javase/6/docs/api/java/util/LinkedHashMap.html)正是这样做的，请参阅 javadoc 中的[removeEldestEntry](http://java.sun.com/javase/6/docs/api/java/util/LinkedHashMap.html#removeEldestEntry(java.util.Map.Entry))方法。

像这样的东西应该可以解决问题，这将删除最旧的插入条目：

```
Map map = new LinkedHashMap() {
    @Override
    protected boolean removeEldestEntry(Entry eldest) {
        return size() > N;
    }
}; 
```

您还可以通过在构造函数中指定它来删除最旧的访问条目：

```
 Map map = new LinkedHashMap(16, 0.75f, true) {
        @Override
        protected boolean removeEldestEntry(Entry eldest) {
            return size() > N;
        }
    }; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T21:34:15.663

您可能正在寻找[LRU 缓存](http://en.wikipedia.org/wiki/Cache_algorithms)？这是一篇基于[LinkedHashMap](http://www.khanspot.com/2006/11/27/a-simple-lru-cache-in-5-lines/)的博客文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T21:37:30.727

您可能需要考虑使用 Apache Collections。他们有一堆 LRU 实现。否则，您可以轻松地为标准库集合编写类似的包装器；我不认为有一个你可以直接使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T21:41:41.543

您可以使用双端队列或[Deque](http://en.wikipedia.org/wiki/Deque)，并在达到最大计数时删除第一项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-22T21:05:25.040

如果你有并发需求，不要试图自己解决这个问题。Guava 的[CacheBuilder](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/cache/CacheBuilder.html)有一个 .maximumSize() 方法，允许您限制地图的大小，尽管我的理解是在您实际达到限制之前可能会清除旧条目。

有[一个关于数据结构设计的有趣页面](http://code.google.com/p/concurrentlinkedhashmap/wiki/Design)，它应该让读者印象深刻，要做得比谷歌的实现更好是多么困难。:)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-07T21:57:30.530

如果您正在缓存，您可以使用 Wea​​kHashMap 或 WeakReference，然后不必担心缓存的大小。

# algorithm - 如何计算两个正态分布的总和

> ID：422186
> 
> 赞同：2
> 
> 时间：2009-01-07T21:33:30.610
> 
> 标签：algorithm, language-agnostic, statistics, algebra

我有一个表示高斯分布的值类型：

```
struct Gauss {
    double mean;
    double variance;
} 
```

我想对一系列这些值进行积分：

```
Gauss eulerIntegrate(double dt, Gauss iv, Gauss[] values) {
    Gauss r = iv;
    foreach (Gauss v in values) {
        r += v*dt;
    }
    return r;
} 
```

我的问题是如何为这些正态分布实现加法。

标量 ( `dt`) 的乘法看起来很简单。但这并不简单！感谢[FOOSHNICK](https://stackoverflow.com/questions/422186/how-to-calculate-the-sum-of-two-normal-distributions#422229)的帮助：

```
public static Gauss operator * (Gauss g, double d) {
    return new Gauss(g.mean * d, g.variance * d * d);
} 
```

然而，加法让我望而却步。我想我可以添加手段；这是给我带来麻烦的差异。这些定义中的任何一个对我来说似乎都是“合乎逻辑的”。

```
public static Gauss operator + (Gauss a, Gauss b) {
    double mean = a.mean + b.mean;
    // Is it this? (Yes, it is!)
    return new Gauss(mean, a.variance + b.variance);        
    // Or this? (nope)
    //return new Gauss(mean, Math.Max(a.variance, b.variance));
    // Or how about this? (nope)
    //return new Gauss(mean, (a.variance + b.variance)/2);
} 
```

任何人都可以帮助定义一个统计上正确的 - 或者至少是“合理的” -`+`运营商版本吗？

我想我可以将代码切换为使用区间算术，但我希望留在概率和统计的世界中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T21:40:47.957

两个正态分布之和本身就是一个正态分布：

*N（均值1，方差1）+ N（均值2，方差2）〜N（均值1 +均值2，方差1 +方差2）*

这都在[维基百科页面上](http://en.wikipedia.org/wiki/Normal_distribution#Related_distributions)。

请注意，这些确实是方差而不是标准偏差。

```
// X + Y
public static Gauss operator + (Gauss a, Gauss b) {
    //NOTE: this is valid if X,Y are independent normal random variables
    return new Gauss(a.mean + b.mean, a.variance + b.variance);
}

// X*b
public static Gauss operator * (Gauss a, double b) {
    return new Gauss(a.mean*b, a.variance*b*b);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T15:19:53.443

更准确地说：

如果一个随机变量 Z 被定义为两个不相关的高斯随机变量 X 和 Y 的线性组合，那么 Z 本身就是一个高斯随机变量，例如：

如果 Z = aX + bY，则均值 (Z) = a * 均值 (X) + b * 均值 (Y)，方差 (Z) = a ² * 方差 (X) + b ² * 方差 (Y)。

如果随机变量是*相关*的，那么你必须考虑到这一点。Variance(X) 由期望值 E([X-mean(X)] ² ) 定义。对 Z = aX + bY 进行处理，我们得到：

方差(Z) = a ² * 方差(X) + b ² * 方差(Y) + 2ab * 协方差(X,Y)

如果您将两个不相关且不具有高斯分布的随机变量相加，则和的分布是两个分量分布的[卷积](http://en.wikipedia.org/wiki/Convolution)。

如果要对两个相关的非高斯随机变量求和，则必须自己处理适当的积分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T21:41:33.247

哈，我以为你不能把高斯分布加在一起，但你可以！

[http://mathworld.wolfram.com/NormalSumDistribution.html](http://mathworld.wolfram.com/NormalSumDistribution.html)

实际上，均值是各个分布的总和，而方差是各个分布的总和。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T21:45:00.680

好吧，您乘以标量是错误的-您应该将方差乘以 d 的平方。如果您要添加一个常数，则只需将其添加到均值中，方差保持不变。如果要添加两个分布，则添加均值并添加方差。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-19T12:46:34.737

> 任何人都可以帮助定义 + 运算符的统计正确 - 或至少“合理” - 版本吗？

可以说不是，因为添加两个分布意味着不同的东西——在可靠性和可维护性方面工作后，我对标题的第一反应是系统的 mtbf 的分布，如果每个部分的 mtbf 是正态分布的并且系统没有冗余。您说的是两个正态分布独立变量之和的分布，而不是两个正态分布效应的（逻辑）和。很多时候，运算符重载具有令人惊讶的语义。除非您的代码具有非常特定的目标受众，否则我会将其保留为函数并将其称为“normalSumDistribution”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T21:46:46.777

我不确定我是否喜欢你所说的对一系列价值观的“整合”。你是指微积分意义上的那个词吗？您是否正在尝试进行数值积分？还有其他更好的方法可以做到这一点。你的在我看来不合适，更不用说最佳了。

高斯分布是一个很好的平滑函数。我认为一个很好的正交方法或 Runge-Kutta 会是一个更好的主意。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-19T15:44:11.490

我原以为这取决于您正在执行的添加类型。如果您只想获得属性（均值、标准差等）等于两个分布之和的正态分布，那么添加其他答案中给出的属性就可以了。这是PERT之类的假设，如果将大量正态概率分布相加，则得到的概率分布是另一个正态概率分布。

当添加的两个发行版不相似时，问题就出现了。例如，添加一个平均值为 2、标准差为 1 的概率分布和一个标准差为 2 的概率分布 10。如果将这两个分布相加，您将得到一个具有两个峰值的概率分布，一个峰值为 2ish一个在 10 点左右。因此，结果不是正态分布。仅当原始分布非常相似或您有很多原始分布以使波峰和波谷可以平衡时，添加分布的假设才真正有效。

# web-services - REST URIs and operations on an object that can be commented on, tagged, rated, etc

> ID：422188
> 
> 赞同：7
> 
> 时间：2009-01-07T21:33:49.937
> 
> 标签：web-services, rest

I'm doing research into a web API for my company, and it's starting to look like we might implement a RESTful one. I've read a couple of books about this now (O'Reilly's "RESTful web services" seeming the most useful) and have come up with the following set of URIs and operations for an object that can be commented on, tagged, and rated.

It doesn't really matter what the object is, as this scenario applies to many things on the net, but for the sake of argument lets say it's a movie.

Some of these seem to fit quite naturally, but others seem a bit forced (rating and tagging particularly) so does anybody have any suggestions about how these could be improved? I'll list them with the URI and then the supported verbs, and what I propose they would do.

```
/movies 
```

GET = List movies

```
/movies/5 
```

GET = Get movie 5

```
/movies/5/comments 
```

GET = List comments on movie 5

POST = Create a new comment on movie 5

```
/movies/5/comments/8 
```

GET = Get comment 8 on movie 5

POST = Reply to comment 8 on movie 5

PUT = Update comment 8 on movie 5

```
/movies/5/comments/8/flag 
```

GET = Check whether the movies is flagged as inappropriate (404 if not)

PUT = Flag movie as inappropriate

```
/movies/5/rating 
```

GET = Get the rating of the movie

POST = Add the user rating of the movie to the overall rating

*Edit: My intention is that the movie object would contain its rating as a property, so I wouldn't really expect the GET method to be used here. The URI really exists so that the rating can be an individual resource that can be updated using the POST verb. I'm not sure if this is the best way of doing it, but I can't think of a better one*

```
/movies/5/tags/tagname 
```

GET = Check whether the movies is tagged with *tagname* (404 if not; but if it is tagged with the tag name should it return the actual tag resource by redirecting to something like `/tags/tagname`?)

PUT = Add tag *tagname* to the movie, creating the tag resource `/tags/tagname` if required

DELETE = Remove tag *tagname* from the movie, deleting the tag resource `tags/tagname` if nothing is tagged with it after this removal

* * *

Note that these wouldn't be the entire URIs, for example the URI to list the movies would support filtering, paging and sorting. For this I was planning on something like:

```
/movies/action;90s/rating,desc/20-40 
```

Where:

action;90s is a semi-colon delimited set of filter criteria

rating,desc is the sort order and direction

20-40 is the range of item indices to get

Any comments about this API scheme too?

* * *

**Edit #1**

This post is getting quite long now! After reading some of the answers and comments, this is the changes from above I'm planning on making:

Tags will be handled as a group rather than individually, so they will be at:

```
/movies/5/tags 
```

GET = List tags

POST = Union of specified tags and existing tags

PUT = Replace any current tags with specified tags

DELETE = Delete all tags

I'm still really not sure how to handle flagging a comment though. One option is that instead of POSTing to a comment replying to it, a comment object will include its parent so it can be POSTed to the general URI, i.e.

```
/movie/5/comment 
```

POST = Create a new comment (which may be a reply to a comment)

I could then use the POST to a comment to flag it. But this still doesn't feel quite right.

```
/movie/5/comment/8 
```

POST = Flag comment

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T22:23:47.997

Most of what you have looks good. There were just a couple of strange things I saw. When I put my URLs together, I try to follow these four principles.

## Peel the onion

If you make the R in REST really be a resource then the resource URL should be able to be peeled back and still be meaningful. If it doesn't make sense you should rethink how to organize the resource. So in the case below, each makes sense. I am either looking at a specific item, or a collection of items.

```
/movies/horror/10/
/movies/horror/
/movies/ 
```

The following seems funny to me because `flag` isn't a resource, it's a property of the `movie`.

```
/movies/5/comments/8/flag -> Funny
/movies/5/comments/8/     -> Gives me all properties of comment including flag 
```

## Define the View

The last peice of the URL describes how to show the resource. The URL `/movies/horror/` tells me I will have a collection of movies refined by horror. But there might be different ways I want to display that collection.

```
/movies/horror/simple
/movies/horror/expanded 
```

The simple view might just be the title and an image. The expanded view would give a lot more information like description, synopsis, and ratings.

## Helpers

After the resource has been limited and the proper view figured out, query string parameters are used to help the UI with the little stuff. The most common query string parameters I use are

```
p => Page
n => number of items to display
sortby => field to sort by
asc => sort ascending 
```

So I could end up with a URL like

```
/movies/horror/default?p=12&n=50&sortby=name 
```

This will give me the list of `movies` limited to horror movies with the default view; starting on page 12 with 50 movies per page where the movies are sorted by name.

## Actions

The last thing needed are your action on the resource. The action are either collection based or item based.

```
/movies/horror/
GET -> Get resources as a list
POST -> Create, Update

/movies/horror/10/
GET -> Get resource as item
POST -> Update 
```

I hope this helps.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T21:45:48.040

Well, the way I see it some of the information you return now as objects could simply be added to the metadata of its parent object.

For instance, rating could be part of the response of /movies/5

```
<movie>
   <title>..</title>
   ..
   <rating url="movies/ratings/4">4</rating>
   <tags>
      <tag url="movies/tags/creative">creative</tag>
      ... 
```

Removing a tag simply means posting the above response without that tag.

Also queries should go in URL variables, I believe: `/movies/?startsWith=Forrest%20G&orderBy=DateAdded`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T22:05:42.260

I disagree with the edit. Queries should be defined by querystrings as per Martijn Laarman's post. i.e.:

```
/movies?genre=action&timeframe=90s&lbound=20&ubound=40&order=desc 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T22:01:51.613

Based on my understanding of ROA (I'm only on chapter five of RESTful Web Services) it looks good to me.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T22:59:44.633

This is an awesome initial draft for a spec of a REST API. The next step would to specify expected return codes (like you did with "404 No Tag Available"), acceptable Content-Types, and available content-types (e.g., HTML, JSON). Doing that should expose any additional chinks you'll need to hammer out.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T19:02:47.573

@Nelson LaQuet:

Using the HTTP methods as they are actually defined gives you the safety of knowing that executing a GET on anything on a web site or service won't eat your data or otherwise mangle it. As an example (pointed out in [**RESTful Web Services**](http://oreilly.com/catalog/9780596529260/)) Google's Web Accelerator expects this behaviour -- as stated in the [FAQ](http://webaccelerator.google.com/webmasterhelp.html#prefetch3) -- and presumably other services do too.

Also it gets you [idempotency](http://oreilly.com/catalog/9780596529260/) for free. That is doing a GET, DELETE, HEAD or PUT on a resource more than once is the same as doing it only once. Thus if your request fails then all you have to do is run it again.

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-07-20T19:50:01.387

This is not REST.

> A REST API must not define fixed resource names or hierarchies (an obvious coupling of client and server). Servers must have the freedom to control their own namespace. Instead, allow servers to instruct clients on how to construct appropriate URIs, such as is done in HTML forms and URI templates, by defining those instructions within media types and link relations. [Failure here implies that clients are assuming a resource structure due to out-of band information, such as a domain-specific standard, which is the data-oriented equivalent to RPC's functional coupling].

[http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)

# macos - 在 Mac OS 上枚举 USB 驱动器和 USB 层次结构

> ID：422199
> 
> 赞同：9
> 
> 时间：2009-01-07T21:36:21.710
> 
> 标签：macos, usb

发现连接了哪些 USB 驱动器、它们的安装位置以及它们的独特详细信息（如序列号、PID 和它们连接到哪个 USB 集线器端口）的最佳方法是什么？类似于[USBlyzer](http://www.usblyzer.com/)为 Windows 所做的事情，但以编程方式。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2010-09-29T09:22:07.937

您可以使用终端并执行：

```
system_profiler SPUSBDataType 
```

它将显示所有连接的 USB 设备以及详细信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T20:02:57.733

Finder 在左上角的 Apple 下方有一个“关于此 Mac”的选项。询问更多信息并按照设备===> USB 树找到您的答案。在外壳或其他执行模块中，我不知道如何检索此信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-07-28T23:14:38.623

USB Prober 是最有用的工具。它可以在 /Developer/Applications/Utilities/USB Prober 中找到。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T09:31:46.477

我不是 Mac OS X 上的 I/O 专家，但我听说过[I/O Kit](http://developer.apple.com/documentation/devicedrivers/conceptual/IOKitFundamentals/)，这可能是一个很好的起点。

# javascript - 通过 JavaScript 在匿名 DOM 元素上设置属性？

> ID：422207
> 
> 赞同：1
> 
> 时间：2009-01-07T21:39:05.607
> 
> 标签：javascript, dom

假设我正在通过服务器端代码生成标记。我正在生成一堆 HTML 标签，但我想添加自定义客户端行为。

使用 JavaScript（如果我有对 DOM 节点的引用）我可以写：

```
var myDOMNode = ...
myDOMNode.myCustomAttribute = "Hi!"; 
```

现在这里的问题是我不想仅仅为了初始化数据而用唯一的 id 限定每个元素。对我来说真的很奇怪，没有一种更简单且不引人注目的方式来附加客户端行为。

如果我没记错的话，这是有效的 IE 内容。

```
<div onload="this.myCustomAttribute='Hi!'"></div> 
```

如果我能够做到这一点，我应该能够通过标识符“myCustomAttribute”访问它的“数据上下文”，这正是我想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T21:50:20.637

以下将有效但不验证：

```
<div myattribute="myvalue"></div> 
```

但是，如果您使用 Javascript 将其注入到 HTML 中，那么您可能不必担心。否则，您可以在将元素添加到 DOM 之前使用 jQuery 之类的东西来处理它们：

```
$(elements).each(function(){
     $(this).attr('myattribute','myvalue');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T21:52:03.223

首先，如果您希望您的代码在 IE 以外的其他浏览器上运行，您应该使用`getAttribute`和方法访问自定义属性。`setAttribute`

至于您的事件处理程序问题，这实际上取决于您如何添加事件处理程序。将函数直接分配给元素的 onXXXX 属性将允许您通过`this`.

如果你使用 IE 的 attachEvent 你不能使用`this`，你可以访问生成事件的元素，`event.srcElement`但它可能是 div 的子元素。因此，您将需要测试 myCustomAttribute 的存在并搜索祖先，直到找到它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-09T18:00:02.363

我确实应用了输入，但我终于明白了这一点，这是我进行*初始化*的方式一直是我的眼中钉。

你永远不想做的是用一堆短暂的标识符污染你的全局命名空间。任何时候你穿上`id=""`一个元素，你都在做同样的事情（任何顶级功能都是一样的）。通过依赖 jQuery、HTML5 数据和 CSS，我的问题有一个解决方案，我认为它非常优雅。

我所做的是为特定行为保留一个 CSS 类，然后使用 HTML5 数据来参数化该行为。文档准备好后，我在文档中（使用 Query）查询代表行为的 CSS 类并初始化客户端行为。

我一直在做很多 ASP.NET，在这种情况下，两者都`id=""`属于`name=""`ASP.NET，除了内部 ASP.NET 的东西之外，它对其他任何东西都毫无用处。您通常会发现自己在做的是获取一个名为的服务器端属性，`ClientID`您可以从客户端 JavaScript 中引用它，这很麻烦。他们在 4.0 中让它变得更容易，但从根本上说，我认为它已经被打破了。

使用这种 CSS、HTML5 数据和 jQuery 的混合体完全解决了这个问题。这是使用正则表达式验证文本框输入的附加行为示例。

```
<input type="text" class="-input-regex" data-regex="^[a-z]+$" /> 
```

这是脚本：

```
$(function () {

    function checkRegex(inp) {
        if (inp.data("regex").test(inp.val()))
            inp.data("good-value", inp.val());
        else
            inp.val(inp.data("good-value"));
    }

    $(".-input-regex")
        .each(function () {
            // starting with jQuery 1.5 
            // you can get at HTML5 data like this
            var inp = $(this);
            var pattern = inp.data("regex");
            inp.data("regex", new RegExp(pattern));
            checkRegex(inp);
        })
        .keyup(function (e) {
            checkRegex($(this));
        })
        .change(function (e) {
            checkRegex($(this));
        })
        .bind("paste", undefined, function (e) {
            checkRegex($(this));
        })
        ;

}); 
```

完全干净，没有时髦`id=""`或突兀的依赖。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T21:15:39.570

在 HTML5 中，专门针对这种情况引入了[HTML5 数据属性。](http://ejohn.org/blog/html-5-data-attributes/)

```
<!DOCTYPE html>
<div data-my-custom-attribute='Hi!'></div> 
```

现在是正确的，正在验证 html。您可以使用`data-`以任何数量开头的任何名称。

有[jQuery`.data`](http://api.jquery.com/data/)方法可以与它们交互。用于`.data( key )`获取、`.data(key, value)`设置`data-key`属性。例如，

```
$('div').each(function () {
     $(this).html($(this).data('myCustomAttribute')).data('processed', 'OK');
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T21:45:56.480

这个怎么样？

```
<script>
    function LoadElement(myDiv)
    {
        alert(this.myCustomAttribute);
    }
</script>

<div onload="LoadElement(this)"></div> 
```

顺便说一句，未经测试

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T21:51:23.053

由于您尝试对多个元素执行此操作，因此您可以尝试使用`name`属性和`getElementsByName`.

```
<div name="handleonload">...</div>

window.onload = function () {
    var divs = document.getElementsByName('handleonload');
    for (var i = 0; i < divs.length; i += 1) {
        divs[i].foo = 'bar';
    }
}; 
```

或者，您可以使用***选择器***，使用库（例如 jQuery 和 Prototype）及其各自的迭代器。这也将允许您按其他属性（例如`class`）进行搜索。

* * *

不过，请谨慎使用您的术语：

```
obj.property = value;

<tag attribute="value"> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T21:54:16.620

```
<div style="width:100px;height:100px;border:solid black 1px" myCustomAttribute='Hi!' onclick="alert(myCustomAttribute);"></div> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T21:55:37.257

onload 事件用于服务器端事件。它不是标准 html 元素事件的一部分。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-18T15:10:18.697

看看以下函数（尤其是*walk_the_dom*函数）：

```
// walk_the_DOM visits every node of the tree in HTML source order, starting
// from some given node. It invokes a function,
// passing it each node in turn. walk_the_DOM calls
// itself to process each of the child nodes.
var walk_the_DOM = function walk(node, func) {
    func(node);
    node = node.firstChild;
    while (node) {
        walk(node, func);
        node = node.nextSibling;
    }
};

// getElementsByAttribute takes an attribute name string and an optional
// matching value. It calls walk_the_DOM, passing it a
// function that looks for an attribute name in the
// node. The matching nodes are accumulated in a
// results array.
var getElementsByAttribute = function (att, value) {
    var results = [];

    walk_the_DOM(document.body, function (node) {
        var actual = node.nodeType === 1 && node.getAttribute(att);
        if (typeof actual === 'string' &&
                (actual === value || typeof value !== 'string')) {
            results.push(node);
        }
    });
    return results;
}; 
```

有了上面的两个函数，现在我们可以做这样的事情：

```
<a href="#" dreas="">some link</a>
<script>
var els = getElementsByAttribute('dreas');
if (els.length > 0) {
    els[0].innerHTML = 'changed text';
}
</script> 
```

请注意，现在我如何在`dreas`不使用 id 或类名...甚至标签名的情况下查找特定元素（具有名为 的属性）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-05-06T08:34:01.203

根据我的搜索，看起来 jQuery 是最好的选择。您可以通过以下方式将对象绑定到 DOM 节点：

```
var domNode = ...
var myObject = { ... }
$(domNode).data('mydata', mymyObj); 
```

然后您可以使用您的密钥以相同的方式调用数据备份。

```
var myObect = $(domNode).data('mydata'); 
```

我假设您也可以在此对象中存储对此的引用，但这可能是您真正想要的更多信息。希望我能帮上忙。

# ruby-on-rails - Rails 1.2“服务已弃用”

> ID：422211
> 
> 赞同：2
> 
> 时间：2009-01-07T21:39:53.170
> 
> 标签：ruby-on-rails, deprecated

我的应用程序在 Rails 1.2.6 上，我希望将其升级到 2.2 我在日志中看到此警告：弃用警告：服务已弃用，将从 Rails 2.0 中删除，请参阅[http://www.rubyonrails.org/deprecation](http://www.rubyonrails.org/deprecation)细节。（从 .... application.rb:14 调用）

该行是问题是服务：通知

有人可以告诉我什么服务，因为我找不到任何关于此的文档。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T02:19:10.423

`service`是一种指定控制器依赖关系的方法。依赖加载已移至 ActiveSupport。

从 1.2.0 代码：

```
 # Specifies a variable number of services that this controller depends on. 
  # Services are normally singletons or factories, like
  # Action Mailer service or a Payment Gateway service.
  def service(*services)
    require_dependencies(:service, services)
    depend_on(:service, services)
  end
  deprecate :service 
```

# vb.net - 继承的公共属性未显示在 Intellisense 中

> ID：422219
> 
> 赞同：0
> 
> 时间：2009-01-07T21:41:57.440
> 
> 标签：vb.net, visual-studio-2008, oop, inheritance, intellisense

我在 vb.net 中继承了一个类，当我创建对象时，我只在智能感知中看到一个继承的公共属性。这个问题有什么解决办法吗？

```
print("Public Class CompanyMailMessage
    Inherits MailMessage 

    Private AdobeDisclaimer As String = "You will need Adobe Acrobat to read this file. If it is not installed on your computer go to http://www.adobe.com/support/downloads/main.html to download. Thank You"
    Private _Body As String
    Private _IncludeAdobeDisclaimer As Boolean = False

    ''' <summary>
    ''' Gets or sets the body of the message
    ''' </summary>
    ''' <returns>A System.String that contains the body content.</returns>
    Public Property Body() As String
        Get
            If _IncludeAdobeDisclaimer Then
                _Body = _Body + AdobeDisclaimer
            End If

            Return _Body

        End Get
        Set(ByVal value As String)
            _Body = value
        End Set
    End Property
    ''' <summary>
    ''' Gets or sets a value that determines if a message that states that Adobe Acrobat must be used to open the attached files is included in the body of the message 
    ''' </summary>
    ''' <value></value>
    ''' <returns>True if ;otherwise, false</returns>
    ''' <remarks></remarks>
    Public Property IncludeAdobeDisclaimer() As Boolean
        Get
            Return _IncludeAdobeDisclaimer
        End Get
        Set(ByVal value As Boolean)
            _IncludeAdobeDisclaimer = value
        End Set
    End Property
    ''' <summary>
    ''' Initializes an instance of the CompanyMailMessageclass
    ''' </summary>
    ''' <remarks></remarks>
    Public Sub New()

    End Sub
    ''' <summary>
    ''' Initializes an instance of the CompanyMailMessageclass with plain text in the body
    ''' </summary>
    ''' <param name="from">The email address of the sender</param>  
    ''' <param name="fromName">The name of the sender</param>              
    ''' <param name="to"></param>
    ''' <param name="subject"></param>
    ''' <param name="body"></param>
    ''' <remarks></remarks>
    Public Sub New(from as String,fromName As String,[to] as String,subject As String,body As String)

        MyBase.FromAddress = New EmailAddress(from,fromName)
        MyBase.ToAddresses.Add([to])
        MyBase.Subject = subject
        _Body = body
        MyBase.Items.Add(New MessageContent(MimeType.MessageRfc822,body))   

    End Sub"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T22:10:24.590

我建议打开 Reflector 并打开第 3 方 dll。我猜这些属性将是内部的（我认为是 vb.net 中的朋友），这就是原因。

# api - Haskell REST/GDATA API 库

> ID：422221
> 
> 赞同：8
> 
> 时间：2009-01-07T21:43:03.103
> 
> 标签：api, rest, haskell, gdata

haskell 有可用的 REST api 库吗？

我需要它主要用于 google gdata 客户端，但也可能将它用于其他目的。

我知道有 HTTP 库，但我需要更高级的东西，它支持 json 编码/解码等东西......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-09T08:01:04.553

根据“cabal list”，Hackage 上的库中没有这样的东西。悲伤，但真实。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T14:06:53.533

现在在 2013 年， Hackage 上有了[handa-gdata](http://hackage.haskell.org/package/handa-gdata)包。

# triggers - 最后更新日期：反模式？

> ID：422222
> 
> 赞同：4
> 
> 时间：2009-01-07T21:43:16.550
> 
> 标签：triggers, anti-patterns, last-modified

我不断看到问题浮出水面，这些问题引用了数据库表中名为 DateLastUpdated 之类的列。我不明白。

我见过的唯一伴随字段是 LastUpdateUserId 之类的。从来没有迹象表明为什么会发生更新；甚至更新是什么。

最重要的是，该字段有时是从触发器中写入的，其中可用的上下文更少。

当然，它甚至远不及审计线索。所以这不能成为理由。如果在日志或其他任何地方有**审计**线索，这个字段将是多余的。

我错过了什么？为什么这种模式如此受欢迎？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T21:47:44.123

这样的字段可用于检测是否存在由不同进程进行的冲突编辑。当您从数据库中检索记录时，您将获得先前的 DateLastUpdated 字段。对其他字段进行更改后，您将记录提交回数据库层。数据库层检查您提交的 DateLastUpdated 是否与仍在数据库中的*相匹配。*如果匹配，则执行更新（并将 DateLastUpdated 更新为当前时间）。但是，如果不匹配，则其他进程同时更改了记录，可以中止当前更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T21:50:04.867

这取决于具体情况，但是像这样的时间戳对于自动生成的数据可能非常有用 - 如果稍后依赖关系发生了变化，您可以确定是否需要重新计算某些内容（这是构建系统计算哪些文件需要重新编译的方式）。

此外，许多网站的页面上都会有数据标记“上次更改”，尤其是可能编辑内容的新闻网站。确切的原因不是必需的（并且可能存在备份，以防确实需要审计跟踪），但最终用户需要看到这些数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T15:54:46.633

如果您必须将提要发送给作为增量提要的客户端，这也非常有用，即仅在发送最后一个提要的数据后已更改或插入的记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T21:50:37.690

这些类型的东西通常用于需要用户操作来启动更新的业务应用程序。通常，会有某种业务应用程序（例如 CRM 桌面应用程序），并且对于大多数更新，往往只有一种进行更新的方法。

如果您正在查看地址数据，那是通过“维护地址”屏幕等完成的。

这种数据库审计是为了增强业务级别的审计，而不是取代它。呼叫中心有时会（或者总是在澳大利亚的金融服务提供商的情况下，例如）记录电话。这也是审计跟踪的一部分，但就桌面应用程序（和相关基础架构）而言，它往往不是 IT 解决方案的一部分，尽管这绝不是一个硬性规定。

呼叫中心工作人员通常还具有某种“注释”或“日志”功能，他们可以在其中键入自由格式的文本，说明客户呼叫的原因以及采取了哪些操作，以便下一位接线员可以在客户响铃时从他们离开的地方接听背部。

触发器通常用于准确记录更改的内容（例如，将旧记录写入审计表）。所有这些的目的是利用所有信息（注释、记录的呼叫、数据库审计跟踪和日志）可以重建数据的先前状态以及生成的操作。这可能是为了查找/解决系统中的错误，或者只是作为与客户的冲突解决过程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T21:50:42.900

它当然很受欢迎 - 例如，rails 有它的简写，以及创建时间戳 (:timestamps)。

在应用程序级别它非常有用，因为相同的模式在视图中非常常见 - 例如查看这里的问题（56 秒前回答等）。

它也可以在报告中追溯使用以生成统计信息（例如，数据库中记录数的增长曲线是什么）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T21:57:23.620

有几种情况

假设您有一个客户的地址表您有您的 CRM 应用程序，客户称他的地址在一个月前已更改，通过 LastUpdate 列您可以看到该客户的这一行在 4 个月内没有被触及

通常您使用触发器来填充历史记录表，以便您可以查看所有其他历史记录，如果您看到创建日期和更新日期相同，则没有必要点击历史记录表，因为您将找不到任何内容

你计算指数（股票市场），你可以很容易地看到它只是通过查看这个列重新计算的

有 2 个数据库服务器，通过比较日期列，您可以了解是否所有更改都已复制等等等等

# c# - C# 复选框事件处理程序

> ID：422224
> 
> 赞同：0
> 
> 时间：2009-01-07T21:43:19.763
> 
> 标签：c#, checkbox

```
 private void CheckBox_CheckedChanged(object sender, EventArgs e)
    {
        CheckBox chk = (CheckBox)sender;
        SetValuesInDB( System.Security.Principal.WindowsIdentity.GetCurrent().Name,
                       DateTime.Today.Date);

    } 
```

现在，只有当我直接单击复选框时，我才想在数据库中设置我的 id 和当前日期的值。

如果其他一些事件触发此事件处理程序，我不想更新数据库中的这些值。例如：每次加载时，复选框被选中，但该复选框的数据库值未选中。因此，每次触发此事件处理程序并更新数据库值时。我该如何照顾它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T21:58:04.007

请改用 CheckBox.Click 事件。如果用户单击复选框或使用空格来切换复选框，它就会被触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T15:58:08.043

我不确定你想做什么。

如果您希望数据库和用户界面中的值始终是最新的，您可以尝试 DataBindings ...

 `````
internal class MyDataSource {

    public bool MyBooleanValue {
        get { return ReadValueFromDB("MyUser", "MyBool"); }
        set { SaveValueToDB("MyUser", value); }
    }

}

...

internal class MyControl {

    internal MyControl() {
        dataSource = new MyDataSource();

        InitializeComponents();

        myCheckbox.DataBindings.Add(
            "Checked", dataSource, "MyBooleanValue"
        );
    }

    private MyDataSource dataSource;

} 
````  `否则，您可能希望仅在用户完成操作时将值写入数据库。例如关闭表单的事件处理程序或 okButton 单击事件处理程序。

# windows - 在 Adob e AIR 中运行本机程序

> ID：422225
> 
> 赞同：1
> 
> 时间：2009-01-07T21:44:05.237
> 
> 标签：windows, macos, air

我需要运行本机程序并在仅 Adob​​e AIR 客户端应用程序中检索输出。我知道 AIR 不允许访问本机应用程序，那么实现这一点的最佳方法是什么？我遇到了[这个](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&productId=4&postId=11187)适用于 Windows 的解决方案，但我也需要一些适用于 Mac 的解决方案。如果可能的话，我宁愿没有两个单独的解决方案。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T21:56:24.417

我相信[舒](http://www.shu-player.com/)可能是你要找的。它需要花钱，但它是 AIR 应用程序的 API 和捆绑器，为它们提供了额外的功能。

引用他们的网站：

> Shu 为开发人员提供了一个命令工具包来扩展您的 AIR 应用程序的系统功能，功能包括控制外部应用程序、打开外部文件、数据库连接和控制、系统路径检索和屏幕捕获功能。

我相信它也是跨平台的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T19:47:26.710

另见

[http://www.merapiproject.net/](http://www.merapiproject.net/)

[http://aperture.fluorinefx.com/](http://aperture.fluorinefx.com/)

# php - 我可以在浏览器中以编程方式从多个网站打开、搜索和返回结果吗？

> ID：422227
> 
> 赞同：1
> 
> 时间：2009-01-07T21:44:42.553
> 
> 标签：php, search, automation, osx-leopard

目前，我有一个书签列表，其中包含我在其中查找内容的网站，并在新窗口、选项卡中打开它们，然后搜索我想要查找的字符串。

有没有办法以编程方式执行此操作，最终得到一个包含站点结果页面的浏览器窗口？其中大约有20个。

我在 Mac OS X Leopard 上运行 Safari 3。我有使用 PHP 的经验，但即使是像使用 AppleScript 这样简单的东西也可以。我只是想加快我的工作流程。:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T18:04:46.777

这里有几篇关于用 perl 编写网络爬虫的文章：

*   [http://www.linuxjournal.com/article/2200](http://www.linuxjournal.com/article/2200)
*   [http://www.devshed.com/c/a/Perl/Web-Mining-with-Perl/](http://www.devshed.com/c/a/Perl/Web-Mining-with-Perl/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T21:51:13.913

好吧，如果您了解红宝石，那就是 ScRUBYt！

[http://www.softwaredeveloper.com/features/scrubyt-ruby-web-scraping-tool-051007/](http://www.softwaredeveloper.com/features/scrubyt-ruby-web-scraping-tool-051007/)
[http://scrubyt.org/](http://scrubyt.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T19:03:20.043

不完全与编程相关，但您可以使用 Google 的[自定义搜索引擎](http://www.google.com/coop/cse/ "自定义搜索引擎")工具创建类似的内容（假设您计划搜索的所有网站都可以公开访问）。

然后，您可以将提供的片段插入到您选择的 HTML 文件中，甚至可以将其设置为 Firefox 中的“主页”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T00:05:50.713

试试[Yahoo Pipes](http://pipes.yahoo.com)，可能有一个已经完成了你想要的一半。

我搜索了“搜索”，这是结果。

[http://pipes.yahoo.com/pipes/search?q=search&x=0&y=0](http://pipes.yahoo.com/pipes/search?q=search&x=0&y=0)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T21:49:31.717

您将必须指定您使用的浏览器，因为我确信每个浏览器都有不同的自动化功能。

# c# - 如何在 ConfigurationElement 中包含 CDATA 部分？

> ID：422230
> 
> 赞同：8
> 
> 时间：2009-01-07T21:45:01.430
> 
> 标签：c#, configuration, configuration-files

我正在使用 .NET Fx 3.5 并编写了自己的配置类，这些配置类继承自 ConfigurationSection/ConfigurationElement。目前，我最终在我的配置文件中得到了如下所示的内容：

```
<blah.mail>
    <templates>
        <add name="TemplateNbr1" subject="..." body="Hi!\r\nThis is a test.\r\n.">
            <from address="blah@hotmail.com" />
        </add>
    </templates>
</blah.mail> 
```

我希望能够将主体表示为`template`（上`add`例中的节点）的子节点，最终得到如下所示的内容：

```
<blah.mail>
    <templates>
        <add name="TemplateNbr1" subject="...">
            <from address="blah@hotmail.com" />
            <body><![CDATA[Hi!
This is a test.
]]></body>
        </add>
    </templates>
</blah.mail> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-21T12:35:28.657

在您的自定义配置元素类中，您需要覆盖 method `OnDeserializeUnrecognizedElement`。

例子：

```
public class PluginConfigurationElement : ConfigurationElement
{
    public NameValueCollection CustomProperies { get; set; }

    public PluginConfigurationElement()
    {
        this.CustomProperties = new NameValueCollection();
    }

    protected override bool OnDeserializeUnrecognizedElement(string elementName, XmlReader reader)
    {
        this.CustomProperties.Add(elementName, reader.ReadString());
        return true;
    }
} 
```

我不得不解决同样的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T20:02:56.517

在您的 ConfigurationElement 子类中，尝试使用 XmlWriter.WriteCData 覆盖 SerializeElement 以写入数据，并使用 XmlReader.ReadContentAsString 覆盖 DeserializeElement 以将其读回。

# asp.net - 使用 JavaScript 访问 ASP.net 会话数据的最佳方式是什么？

> ID：422234
> 
> 赞同：2
> 
> 时间：2009-01-07T21:46:06.433
> 
> 标签：asp.net, javascript, session

如何使 ASP.net 会话数据可用于 JavaScript 方法？当我用谷歌搜索时，我发现[了这个](http://blogs.msdn.com/mattgi/archive/2006/11/15/accessing-session-data-from-javascript.aspx)链接。任何人都有不使用 ScriptManager 的更好的技巧吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T21:53:42.317

如果放弃 ScriptManager 是您的目标，那么公开页面方法仍然是一个不错的选择，只需使用不依赖 ScriptManager js 库的 javascript。

我喜欢链接页面中提出的解决方案，但它可能过于开放。也许您想为您希望允许访问的任何/所有 Session 项目创建一个强类型和受控的 PageMethod。这样您就不会意外访问某些秘密 Session 值。

另外，我认为您需要将 PageMethod 标记为

VB

```
WebMethod(EnableSession:=True) 
```

C＃

```
WebMethod(true) 
```

因为我不认为 EnableSession 默认情况下是打开的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T21:53:04.407

会话的目的是向客户端隐藏详细信息。在我看来，您应该将其转换为使用 cookie，这对于通过 javascript 检索显然是微不足道的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T21:48:36.163

您必须以某种方式将其放入页面中。使用隐藏的表单域是一种方法。使用像您的链接这样的 webmethods 是一种更复杂的方法，它为您提供了一些 ajax 功能。

如果您实际上不需要从服务器更新此值，除非在回发时，您可以使用隐藏的输入控件`HtmlInputHidden`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T21:50:14.943

对实现[IRequiresSessionState的 ASHX 的常规 AJAX 调用](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.irequiressessionstate.aspx)

你到底为什么要这样做？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T21:51:26.440

老实说，ScriptManager 方法看起来很简单。滚动您自己的解决方案将需要服务器端的 HttpHandler 和 Ajax 调用，在这种情况下，这似乎不值得麻烦。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T21:53:05.983

我可以看到两种选择：

1.  生成您希望 JavaScript 有权访问的 Session 数据的 JSON 对象。在初始页面生成期间或作为 JSON 回调的结果将其发送到浏览器。
2.  创建一个可以通过 AJAX 调用的 ASPX 页面，该页面将返回具有给定键的会话变量的值。

#2 可能是 ScripManager 代码所包含的内容，无论如何您都应该使用它。但我会小心决定您想要发送给客户端的会话数据，并且我会使用白名单仅返回我实际需要发送给客户端的会话数据。

# spring - Spring AOP：通过方面应用属性

> ID：422236
> 
> 赞同：2
> 
> 时间：2009-01-07T21:46:41.487
> 
> 标签：spring, aop

这里的目的是处理资源的混淆密码。

我们有一个 Advisor 拦截对 setPassword 的调用并解密参数。

我们设置了一个看起来有点像这样的模板：

```
<bean id="pwAdvisor" class="org.springframework.aop.support.NameMatchMethodPointcutAdvisor">
   <property name="advice"><bean class="our.advice.bean.class"/></property>
   <property name="mappedName" value="setPassword"/>
</bean>
<bean id="passwordHandlerTemplate" class="org.springframework.aop.framework.ProxyFactoryBean" abstract="true">
   <property name="interceptorNames"><list><value>pwAdvisor</value></list></property>
</bean> 
```

我不清楚使用它的确切语法。最明显的方法是：

```
<bean id="myPasswordProtectedThing" parent="passwordHandlerTemplate">
   <property name="target">
      <bean class="the.target.class.name">
         <property name="password" value="encrypted garbage"/>
      </bean>
    </property>
 </bean> 
```

但这不能正常工作，因为密码属性应用于内部 bean，这意味着顾问将不会完成它的工作。

那么，这个呢：

```
<bean id="myPasswordProtectedThing" parent="passwordHandlerTemplate">
   <property name="target"><bean class="the.target.class.name"/></property>
   <property name="password" value="encrypted garbage"/>
</bean> 
```

没有。Spring 抱怨 ProxyFactoryBean 没有密码属性。当然，事实并非如此。具有密码属性的东西是工厂 bean*创建*的东西。

布勒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T01:09:22.810

我的第一次努力很糟糕，但我很着急。我道歉。现在我想我知道它应该如何工作了，因为我相信我自己已经实现了你想要的。

我从一个 Credential 类开始（注意：没有接口）：

```
 package aop;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class Credential
{
   private static final String DEFAULT_USERNAME = "username";
   private static final String DEFAULT_PASSWORD = "password";

   private String username;
   private String password;

   public static void main(String[] args)
   {
      Credential cred1 = new Credential("foo", "bar");
      System.out.println("created using new: " + cred1);

      ApplicationContext context = new ClassPathXmlApplicationContext("classpath:aop-context.xml");
      Credential cred2 = (Credential) context.getBean("credential");

      System.out.println("created using app context: " + cred2);

      String password = ((args.length > 0) ? args[0] : "baz");
      cred2.setPassword(password);

      System.out.println("initialized using setter: " + cred2);      
   }

   public Credential()
   {
      this(DEFAULT_USERNAME, DEFAULT_PASSWORD);
   }

   public Credential(String username, String password)
   {
      this.setUsername(username);
      this.setPassword(password);
   }

   public String getUsername()
   {
      return username;
   }

   public void setUsername(String username)
   {
      this.username = username;
   }

   public String getPassword()
   {
      return password;
   }

   public void setPassword(String password)
   {
      this.password = password;
   }

   public String toString()
   {
      return new StringBuilder().append("Credential{").append("username='").append(username).append('\'').append(", password='").append(password).append('\'').append('}').toString();
   }
} 
```

我创建了一个 Decryptor 接口：

```
 package aop;

public interface Decryptor
{
   String decrypt(String encrypted);
} 
```

还有一个 DecryptorImpl：

```
 package aop;

public class DecryptorImpl implements Decryptor
{
   public static final String DEFAULT_DECRYPTED_VALUE = " - not secret anymore";

   public String decrypt(String encrypted)
   {
      // Any transform will do; this suffices to demonstrate
      return encrypted + DEFAULT_DECRYPTED_VALUE;
   }
} 
```

我需要 DecryptorAdvice 来实现 Spring 的 MethodBeforeAdvice：

```
 package aop;

import org.springframework.aop.MethodBeforeAdvice;

import java.lang.reflect.Method;

public class DecryptionAdvice implements MethodBeforeAdvice
{
   private Decryptor decryptor;

   public DecryptionAdvice(Decryptor decryptor)
   {
      this.decryptor = decryptor;
   }

   public void before(Method method, Object[] args, Object target) throws Throwable
   {
      String encryptedPassword = (String) args[0];

      args[0] = this.decryptor.decrypt(encryptedPassword);
   }
} 
```

我将它连接到一个 aop-context.xml 中。（如果你告诉我如何让 XML 显示，我会发布它。）注意 passwordDecryptionAdvisor：它只匹配 setPassword 方法。

有趣的部分发生在我运行它时。这是我在控制台中看到的：

```
 created using new: Credential{username='foo', password='bar'}
created using app context: Credential{username='stackoverflow', password='encrypted-password'}
initialized using setter: Credential{username='stackoverflow', password='baz - not secret anymore'} 
```

这告诉我的是：

1.  如果我使用 new 创建一个不受 Spring 控制的对象，则不会应用建议。
2.  如果我在初始化应用上下文之前在 ctor 中调用 setPassword，则不会应用建议。
3.  如果我在应用上下文初始化后在我的代码中调用 setPassword，则会应用建议。

我希望这可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T22:23:20.790

我以为您希望 beforeMethod 建议使用传递给 setPassword 方法的加密密码字符串。您想解密它并让建议的班级获得解密版本。

我也没有在您的代理工厂中看到代理接口设置。“Spring In Action”说“......使用接口创建代理比代理类更受欢迎......”代理类应该是例外，而不是规则。

发布您的建议课程。

# c++ - 使用 C++ 在 Linux 中停止并重新开始运行进程

> ID：422241
> 
> 赞同：2
> 
> 时间：2009-01-07T21:47:22.750
> 
> 标签：c++, linux, process, controls

我有两个进程和一个共享内存区，我的工作流程是这样的。进程A在共享内存中写入一些数据，之后它应该等待并向其他进程B发送信号开始运行。进程B应该从共享内存中读取一些数据做一些事情写入结果，并向进程A发送信号以继续运行，之后进程B应该等待。

谁能提供一个例子或一个地方，我可以找到如何停止进程以及如何重新开始运行该进程？我在 Linux 和 C++ 中工作。

我已经有了信号量，但我不喜欢的是，一个进程停止从共享内存中一直读取几秒钟，直到它检测到它可以运行。这就是为什么我只想在正确的时刻发出信号

**更新解决方案**

我选择了 stefan.ciobaca 的答案作为最喜欢的答案，因为它是一个完整的解决方案，它可以工作并且它有一个很好的解释。但在所有其他答案中，还有其他有趣的选择。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-08T14:08:48.010

这是如何完成的概念验证：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/shm.h>
#include <unistd.h>
#include <assert.h>

typedef void (*sighandler_t)(int); 

#define SHM_SIZE 8  /* size of shared memory: enough for two 32 bit integers */

volatile int cancontinue = 0;

void halt(char *err) { perror(err); exit(1); }
void handler(int signum) { assert(signum == SIGUSR1); cancontinue = 1; }

int main(void)
{
  key_t key;
  int id;
  int *data;
  pid_t otherpid;

  printf("Hi, I am the %s process and my pid is %d\n", 
#ifdef PRODUCER_MODE
  "writer"
#else
  "reader"
#endif
, getpid());
  printf("Please give me the pid of the other process: ");
  scanf("%d", &otherpid);

  // get a pointer to the shared memory
  if ((key = ftok("test_concur.c", 'R')) == -1) halt("ftok");
  if ((id = shmget(key, SHM_SIZE, 0644 | IPC_CREAT)) == -1) halt("shmget");
  if ((data = shmat(id, (void *)0, 0)) == (int *)(-1)) halt("shmat");

  sighandler_t oldhandler = signal(SIGUSR1, handler);

  while (1) {
#ifdef PRODUCER_MODE
    printf("Enter two integers: ");
    scanf("%d %d", data, data + 1);

    printf("Sending signal to consumer process\n");
    kill(otherpid, SIGUSR1);

    printf("Waiting for consumer to allow me to continue\n");
    while (!cancontinue);
    cancontinue = 0;

    if (*data + *(data + 1) == 0) { printf("Sum was 0, exiting...\n"); break; }
#else
    printf("Waiting for producer to signal me to do my work\n");
    while (!cancontinue);
    cancontinue = 0;

    printf("Received signal\n");
    printf("Pretending to do a long calculation\n");
    sleep(1);
    int sum = *data + *(data + 1);
    printf("The sum of the ints in the shared memory is %d\n", sum);

    printf("Signaling producer I'm done\n");
    kill(otherpid, SIGUSR1);

    if (sum == 0) break;
#endif
  }

  signal(SIGUSR1, oldhandler);

  /* detach from the segment: */
  if (shmdt(data) == -1) {
    perror("shmdt");
    exit(1);
  }

  // don't forget to remove the shared segment from the command line with

  // #sudo ipcs
  // ... and look for the key of the shared memory segment

  // #ipcrm -m <key>

  return 0;
} 
```

上面的程序实际上是两个程序，一个消费者和一个生产者，这取决于你如何编译它。

通过确保定义 PRODUCER_MODE 宏来编译生产者：

```
# gcc -Wall -DPRODUCER_MODE -o 生产者 test_concur.c

```

编译消费者时未定义 PRODUCER_MODE 宏：

```
# gcc -Wall -o 消费者 test_concur.c

```

消费者和生产者共享一些全局内存（数据指向的 8 个字节）；生产者的作用是从标准输入中读取两个 32 位整数并将它们写入共享内存。消费者从共享内存中读取整数并计算它们的总和。

将数据写入共享内存后，生产者向消费者发出信号（通过 SIGUSR1）它可以开始计算。计算完成后，消费者向生产者发出信号（再次通过 SIGUSR1）它可以继续。

当总和为 0 时，两个过程都停止。

目前，每个程序首先输出其 pid 并从 stdin 读取另一个程序的 pid。这应该可能 :D 被更聪明的东西取代，这取决于你在做什么。

此外，在实践中，“while (!cancontinue);”-like 循环应该被其他东西替换：D，比如信号量。至少你应该在每个循环内做一个小睡眠。另外，我认为您并不真正需要共享内存来解决这个问题，使用消息传递技术应该是可行的。

这是一个示例会话，并行显示：

```
    # ./producer # ./consumer
    嗨，我是 writer 进程，我的 pid 是 11357 你好，我是 reader 进程，我的 pid 是 11358
    请给我其他进程的pid：11358 请给我其他进程的pid：11357
    输入两个整数： 2 等待生产者通知我做我的工作
    3
    向消费者进程发送信号接收到的信号
    等待消费者允许我继续 假装做一个很长的计算
                                        ...有些时候过去了...
                                                            共享内存中的整数之和为 5
                                                            信号制作人 我完成了
    输入两个整数：0 等待生产者通知我做我的工作
    0
    向消费者进程发送信号接收到的信号
    等待消费者允许我继续 假装做一个很长的计算
                                        ...有些时候过去了...
                                                            共享内存中的整数之和为0
                                                            信号制作人 我完成了
    总和为 0，正在退出...                                 

```

我希望这有帮助。（运行程序时，请确保文件 test_concur.c 存在（它用于建立共享内存密钥（ftok 函数调用）））

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T21:53:28.587

不完全符合您的要求，但是您可以使用管道（命名或其他方式）来影响同步吗？这将锁定负担放在已经知道如何操作的操作系统上。

只是一个想法。

* * *

**对评论的回应：**我的想法是使用管道而不是共享内存来获取更多数据，并免费获得同步。

例如：

1.  进程 A 启动，设置双向管道**并**使用`popen (3)`.
2.  分叉后立即：

    *   A 做了一些工作并写入管道

    *   B 尝试读取管道，该管道将阻塞，直到进程 A 写入...

3.  下一个：

    *   尝试读取管道，这将阻塞直到数据可用...

    *   B 做了一些工作并写入管道

4.  转到第 2 步，直到达到结束条件。

这不是你要求的。没有共享内存，没有信号，但它应该可以解决问题......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T22:21:58.267

为 IPC使用[Unix 域套接字](http://en.wikipedia.org/wiki/Unix_domain_sockets)而不是共享内存怎么样？这样，每个进程都可以阻止从套接字读取，而另一个进程则在工作。

**编辑：**这类似于[dmckee 的答案](https://stackoverflow.com/questions/422241/stop-and-start-running-again-processes-in-linux#422279)，但提供了对阻塞和 IPC 的更多控制。然而，这种`popen`方法肯定更容易实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T21:54:16.573

你真的需要停止进程（退出它），然后重新启动它，还是只想让它等到某个事件发生？

如果是后者，您应该阅读 IPC 和进程同步（例如信号量、互斥锁）。

如果是前者，请查看linux 中类似*init的源代码。*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T22:09:40.693

您要查找的内容称为阻塞。进程 B 应该阻塞来自进程 A 的调用，进程 A 应该阻塞来自进程 B 的调用。如果一个进程被阻塞（等待来自另一个进程的调用），它会闲置在后台，只有在收到时才会唤醒一个消息。

[Select](http://linux.die.net/man/2/select)可能是您正在寻找的功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T22:15:01.133

我建议使用信号量来同步进程。

阅读标题，我认为 SIGSTOP 和 SIGCONT 可能是可能的，但这可能不是一个好主意；当他们在正确（安全）的地方停下来时，您希望他们停下来。这就是信号量的用途。

许多其他 IPC 机制也可以实现类似的结果，但信号量是跨进程通信机制（您可以在单个进程中的不同线程之间使用互斥锁）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T18:08:19.323

您可能还想查看将在后台使用共享内存但隐藏所有困难部分的[boost 消息队列。](http://www.boost.org/doc/libs/1_37_0/doc/html/interprocess/synchronization_mechanisms.html#interprocess.synchronization_mechanisms.message_queue)它提供阻塞和非阻塞功能（听起来你想要阻塞）。

# objective-c - Cocoa / Objective-C 中的简单字符串解析：将命令行解析为命令和参数

> ID：422242
> 
> 赞同：3
> 
> 时间：2009-01-07T21:47:23.920
> 
> 标签：objective-c, regex, cocoa, parsing, command-line

这是一段代码，用于获取`input`表示命令行的字符串（NSString 或 NSAttributedString）并将其解析为两个字符串，命令`cmd`和参数`args`：

```
NSString* cmd = [[input mutableCopy] autorelease];
NSString* args = [[input mutableCopy] autorelease];
NSScanner* scanner = [NSScanner scannerWithString:[input string]];
[scanner scanUpToCharactersFromSet:[NSCharacterSet 
                                    whitespaceAndNewlineCharacterSet] 
                        intoString:&cmd];
if (![scanner scanUpToString:@"magicstring666" intoString:&args]) args = @""; 
```

这似乎可行，但魔术字符串是一个非常荒谬的黑客。另外，我完全不确定我在使用自动发布时做对了。

添加：该解决方案还应该对初始空白具有鲁棒性。另外，我最初有一个名为 both`input`和的输入字符串`inStr`。很抱歉造成这种混乱。

补充：我相信上面的代码正确的一件事是到目前为止的答案不应该是 args 不应该有任何初始空格。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-07T22:39:46.873

```
NSString *cmd;
NSScanner *scanner = [NSScanner scannerWithString:[inStr string]];
[scanner scanUpToCharactersFromSet:[NSCharacterSet
                                    whitespaceAndNewlineCharacterSet] 
                        intoString:&cmd];
NSString *args = [[scanner string] substringFromIndex:[scanner scanLocation]]; 
```

您的自动释放没问题，但首先分配字符串是不必要的，因为 NSScanner 通过引用返回一个新字符串。由于 NSScanner 的 charactersToBeSkipped 默认包含空格，所以它不应该被初始空格绊倒。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T21:58:56.457

像这样的东西？

```
int index = [input rangeOfString:@" "].location;
NSString *cmd = [input substringToIndex:index]);
NSString *args = [input substringFromIndex:index + 1]); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T23:40:07.030

您提到的自动释放实际上没有任何意义，您所做的只是创建一个可以正确自动释放的可变副本（NSMutableString *），但是由于您将其转换为 NSString *，因此没有实际区别，只需说`cmd = input;`. 尽管如此，args 也不需要这样做，因为 NSScanner 无论如何都会覆盖那里的内容。

`rangeOfString:`如果你想走这条路，你可以使用 NSString 的方法修剪前导空格（`stringByTrimmingCharactersInSet`我也会测试以确保参数和命令都存在，否则你会得到一个错误）。我会做的是使用 NSString`componentsSeparatedByCharactersInSet:`方法。这将为您提供一个 NSArray 对象，其中包含单独索引中的命令和每个参数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-20T20:01:38.143

如果要将字符串扩展为完整的参数数组，例如“main”的输入，则可以使用 wordexp。

```
#import <wordexp.h>

+ (NSMutableArray*) splitArgumentString:(NSString*)strArgs
{
    wordexp_t expandedArgs;
    NSMutableArray *argArray = [NSMutableArray array];

    if(strArgs != nil && 0 == wordexp([strArgs UTF8String], &expandedArgs, 0))
    {
        for(size_t i = 0; i < expandedArgs.we_wordc; ++i)
        {
            NSString arg = [NSString stringWithCString:expandedArgs.we_wordv[i] encoding:NSUTF8StringEncoding];
            [argArray addObject:arg];
        }
        wordfree(&expandedArgs);
    }
    return argArray;        
} 
```

# c# - 提供继承的静态属性（概念上）

> ID：422246
> 
> 赞同：5
> 
> 时间：2009-01-07T21:47:50.440
> 
> 标签：c#, inheritance

我有一个 C# 基类，我要在每个类型（而不是每个实例）的基础上关联信息。本质上，我希望所有子类都呈现一个 Icon 和一个代表该类型的 FriendlyName。我希望*不必*创建类型实例来获取此信息，并且我希望要求所有子类都提供此信息。理想情况下，它将位于基础派生的接口中。

我尝试使用类属性，但它需要一个常量值，所以虽然我可以设置 FriendlyName，但我无法设置图标，而且我看不到任何方法来使属性成为必需，所以子类可以摆脱没有它（直到运行时间）。

我在基础上添加了一个静态属性，孩子们可以隐藏，但这有点难看，基础的值真的很荒谬。它不知道给孩子取什么名字。我可以在属性中进行基础投掷，但同样，直到运行时才会被捕获。

有人对我如何实现这样的事情有任何想法吗？有没有我错过的模式？也鼓励任何开箱即用的想法。

**编辑：**我真正需要的是能够沿继承树要求类属性并能够使用嵌入式资源来设置这些属性。将返回的所有信息实际上都是静态的并且在编译时是已知的。我只是想不出一种很好地暴露它的方法。

**编辑2：**这是我需要的一个更具体的例子：

假设我有一个基类：

```
abstract class Vehicle { ... } 
```

然后我有两个孩子：

```
class Car : Vehicle { ... }

class Truck : Vehicle { ... } 
```

我希望能够获得一个代表“汽车”或“卡车”的图标，而不必创建一个实例（a la Car.Icon），因为给定类型的所有车辆都将具有相同的图标。

我还想确保*所有*车辆派生类型都以相同的方式公开获取此图标，以防将来有人出现并添加新类

```
class Airplane : Vehicle  { ... } 
```

**编辑3：**为什么我需要这个？好吧，我们有一个可以使用插件的应用程序。插件由一个类型定义，当类型被加载时，我们向用户显示一个图标和名称。当他们单击该图标时，它会创建该类型的实例（并为他们提供一个用于命名实例的对话框等）。我不需要或不想必须创建该类型的实例来获取图标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T21:52:59.040

如果您想绝对要求孩子实现这一点，那么我认为这样做的唯一方法是使基类抽象，并公开实例属性以返回图标和友好名称。

这些将是抽象的，而不是虚拟的，因此您强制派生类实现。我知道它不干净，因为它是更好地存储在类型级别的信息，但这是我可以看到在编译时强制执行此要求的唯一方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T22:01:06.483

我认为你可能错过的一点是你不能重写静态属性是有充分理由的——也就是说，当你编写代码来调用它时，你没有实例，所以编译器会静态链接它那时——如果您需要多态性，您需要使用运行时的实例来确定要调用哪个版本的方法。

**编辑：（**响应您的 EDIT2）

你想从什么场景中调用它？

如果你想在一个实例上显示你的图标，你有一个实例，那么为什么不把它作为实例上的一个属性（因为毕竟，有人可能会覆盖你`Car`来创建一个`SportsCar`并想要一个不同的图标它）——实际上你是在要求你的对象的一个​​属性，尽管它与概念模型相匹配（所以它不是轮子的数量、最大速度等；而是将它可视化给最终用户的东西）

**EDIT2：（**响应您的EDIT3）

我要做的方法是使用属性来识别要用作相应类型的图标的嵌入式资源（因此您不需要实例），并使用反射来读取值。*您可以*定义自己的自定义属性，或查看可能有用的[ToolboxItemAttribute](http://msdn.microsoft.com/en-us/library/system.componentmodel.toolboxitemattribute(VS.71).aspx)。

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T16:44:03.690

也许您可以做的是定义一个属性，该属性将用于在您的插件系统中注册该对象。

这样，您将强制类的开发人员分配属性，以便在您的插件系统中工作。

也许您可以使用[ToolboxBitmapAttribute](http://msdn.microsoft.com/en-us/library/system.drawing.toolboxbitmapattribute.aspx)之类的方法，您可以在其中将找到的图像设置到您的 dll 的资源中。

# python - 定点算术

> ID：422247
> 
> 赞同：10
> 
> 时间：2009-01-07T21:48:13.107
> 
> 标签：python, math

有谁知道在 Python 中进行定点运算的库？或者，有人有示例代码吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-07T22:00:42.317

如果你有兴趣做定点运算，Python 标准库有一个可以做 的[十进制模块。](http://docs.python.org/library/decimal.html)

实际上，它也比内置的具有更灵活的浮点能力。我所说的灵活是指：

*   具有各种异常情况的“信号”（这些可以设置为在信号上做各种事情）

*   具有正无穷和负无穷，以及 NaN（不是数字）

*   可以区分正负 0

*   允许您设置不同的舍入方案。

*   允许您设置自己的最小值和最大值。

总而言之，它对于一[百万个家庭用途](http://www.skepticfiles.org/en001/monty16.htm)都很方便。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-12-17T19:57:35.750

deModel包听起来像您正在寻找的东西[。](http://www.dilloneng.com/demodel.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-25T06:56:29.247

如果您想模拟简单算术运算之外的*二进制*定点数的行为，另一个值得考虑的选项是[spfpm](https://pypi.python.org/pypi/spfpm)模块。这将允许您使用固定位数计算平方根、幂、对数和三角函数。它是一个纯 python 模块，因此不提供终极性能，但每秒可以对 256 位数字执行数十万次算术运算。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-21T09:09:41.693

最近我正在做类似的项目，[https://numfi.readthedocs.io/en/latest/](https://numfi.readthedocs.io/en/latest/)

```
>>> from numfi import numfi  
>>> x = numfi(0.68751,1,6,3)
>>> x + 1/3
numfi([1.125]) s7/3-r/s
>>> np.sin(x)
numfi([0.625     ]) s6/3-r/s 
```

# php - PHP框架或模板引擎或其他什么？

> ID：422250
> 
> 赞同：8
> 
> 时间：2009-01-07T21:49:19.843
> 
> 标签：php, frameworks

我有一个相对简单的应用程序，并使用我作为一个项目构建的一些基本功能。我现在想在此基础上添加一些更复杂的功能，包括登录。

代码非常复杂，而且是用纯 php 编写的，所以所有的演示代码都与逻辑混合在一起。我已经决定，在我走得更远之前，我想重新分解它以将其分离出来，因此更容易维护和添加。我一直在研究 MVC，并认为这就是我应该走的路。

我决定试一试 zend 框架，并花了一段时间试图掌握它，但是我发现学习曲线非常陡峭，因为我没有面向对象的经验。

是否有其他任何人都可以推荐的框架或选项？我正在考虑根据阅读本论坛中的其他帖子来看看蛋糕，但我会接受任何指导——我的“要求”是

*   非 OO 经验最容易学习
*   包括一些登录/身份验证功能
*   轻松处理与 mysql 的数据库交互。

所有建议表示赞赏！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T22:14:56.220

正如[这里已经](https://stackoverflow.com/questions/350053/php-frameworks-are-they-solely-personal-preference)非常雄辩地陈述的那样，框架是好的，除非你想做一些他们不适合的事情，而且它们可以[将语言抽象](https://stackoverflow.com/questions/313364/should-a-beginning-php-programmer-consider-frameworks)到你有效学习它们的地步，而不是你正在编码的语言。

我会鼓励你自己动手。如果您了解 MVC 的原理，并且您对 PHP 有中等程度的了解，那么它不会太难（[周围](https://stackoverflow.com/questions/385335/how-to-use-php-for-large-projects)[已经有](https://stackoverflow.com/questions/62605/php-as-a-template-language-or-some-other-php-templating-script) [几个](https://stackoverflow.com/questions/62617/whats-the-best-way-to-separate-php-code-and-html) [指针](https://stackoverflow.com/questions/113077/keeping-my-php-pretty) ），而且您会比如果您更领先于它d只是用了别人的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T22:05:24.383

Smarty 模板引擎。

[http://www.smarty.net/](http://www.smarty.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T22:02:06.120

我个人使用过[Symfony](http://www.symfony-project.org/ "Symfony")。这是一个非常完整且支持良好的框架，相对容易上手。我对框架的经验是，对于更简单的项目，它们可能是一个负担。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T00:42:25.517

我工作场所的人对蛋糕发誓。一旦您知道它，它似乎确实非常灵活并且肯定可以快速开发。但是，我会附和 da5id 并说构建自己的总是最安全的 - 你确切地知道它是如何工作的，你获得了一些良好的 PHP 经验（而不是 Cake 经验），而且你不必花费数小时来与之抗争让它做你想做的事，或者首先阅读如何使用它。

我完全不相信“MVC”真的作为一种范式存在于 PHP 中——在大多数情况下，V 和 C 是如此绝望地交织在一起，因为形式*就是*视图。

自己构建一个代码生成器，它将根据您的数据库表输出 PHP 类。如果你真的很聪明，你可以让它检查数据库的关系，甚至用 PHP 构建连接。然后创建第二组类，每个类都继承自基于表的类，可让您自定义其行为。在您的业务代码中依赖这些辅助类。（这是代沟模式的一种形式）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-17T17:16:36.927

除了作为一个框架之外，[Fat-Free](http://fatfree.sf.net/)还拥有自己的模板引擎，不仅限于变量替换。它允许您调用函数和类/对象方法以及熟悉的类似 PHP 的表达式。

# ms-access - DBEngine.BeginTrans 和 DBEngine.Workspaces(0).BeginTrans 之间的区别

> ID：422270
> 
> 赞同：6
> 
> 时间：2009-01-07T21:52:13.630
> 
> 标签：ms-access, transactions

在 Access 中，这两个语句有什么区别？

```
DBEngine.BeginTrans 
```

和

```
DBEngine.Workspaces(0).BeginTrans 
```

两者的文档都指向同一个地方。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T22:10:33.390

看看这里： [DAO 工作区](http://msdn.microsoft.com/en-us/library/aa293491(VS.60).aspx)
然后这里： [DAO 工作区：打开一个单独的事务空间](http://msdn.microsoft.com/en-us/library/aa293489(VS.60).aspx)

（这些链接适用于 MFC，但它们适用于您正在编码的任何内容。）

`DBEngine.Workspaces(0)`是默认工作区。可以创建其他工作区，让您使用单独的会话；这个想法是适用于整个工作区，但如果您需要在该事务之外做一些事情，您可以创建另一个工作区并独立于第一个工作区中的事务使用它`BeginTrans`。`EndTrans`

就个人而言，在 VBA 中进行 DAO 时，我从来没有机会使用多个工作区。*耸耸肩*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T17:02:16.240

我自己的回答：

似乎 DBEngine.BeginTrans 和 DBEngine.Workspaces(0).BeginTrans 做同样的事情，因为这段代码有效（见下文）。“Workspaces”是 DBEngine 的默认成员。

```
Dim db As Database
Set db = CurrentDb

DBEngine.BeginTrans
db.Execute "Update Table1 SET CITY='Newark'"
DBEngine.Workspaces(0).Rollback 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T02:57:13.973

在 Access 应用程序界面中，一次只能打开一个数据库容器。在 VBA 代码中，您可以在一个工作区中打开多个数据库实例。有关在一个工作区中打开多个数据库的示例，请参阅 Workspace.OpenDatabase 方法（或 [http://msdn.microsoft.com/en-us/library/bb243164.aspx ）的帮助文件文档。](http://msdn.microsoft.com/en-us/library/bb243164.aspx)

可以推断，当工作空间中打开的所有底层数据库都支持事务时，工作空间的 BeginTrans 方法将适用于所有数据库。我怀疑那里有龙，但我确信它可以与一个工作区中的两个 MDB 一起使用。当 Workspace 中只打开一个数据库时，Workspace.BeginTrans 和 Database.BeginTrans 确实是一样的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T15:54:07.593

正如Spock曾经说过的，没有区别的区别就是没有区别……

# api - 通过 TFS API 识别“当前”打开的工作区？

> ID：422293
> 
> 赞同：13
> 
> 时间：2009-01-07T21:55:24.840
> 
> 标签：api, tfs

有没有办法使用 TFS API 以编程方式确定 Visual Studio 中打开的 sln/proj 的当前工作区？我已经看到 VersionControlServer 如何检索所有已知的工作区，但是有什么我可以用来将其与用户当前已打开（或未打开）的内容联系起来的吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-03-03T21:42:36.347

实例化对象的`GetWorkspace`方法还有另一个覆盖。`VersionControlServer`您可以`GetWorkspace`像 Bernhard 状态那样使用本地路径调用，但也可以使用工作区名称和工作区所有者调用它。由于工作区名称默认为本地计算机名称，因此您通常可以使用`Environment.MachineName`，但总会有开发人员更改工作区名称。

例子：

```
TeamFoundationServerFactory _tfs = TeamFoundationServerFactory.GetServer(server);
            _tfs.EnsureAuthenticated();

VersionControlServer _vcs = (VersionControlServer)_tfs.GetService(typeof(VersionControlServer));
Workspace _ws = _vcs.GetWorkspace(Environment.MachineName, Environment.UserName); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T22:54:05.080

如果您可以确定解决方案或项目文件的物理路径，那么您可以在 TFS 中查询该文件，您应该会看到哪个工作区已映射到该本地文件位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-15T07:56:19.367

Dave Teply 的方法的问题在于，它假设您已经有一个 a`VersionControlServer`或至少`TeamFoundationServerUri`.

不过，还有一种更强大的方法，[使用`Workstation`class](https://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.versioncontrol.client.workstation.aspx)。[Ricci Gian Maria 写了一篇](http://www.codewrecks.com/blog/index.php/2010/09/13/how-to-get-tfs-server-address-from-a-local-folder-mapped-to-a-workspace/)关于这个主题的相当广泛的博客文章。以下片段是该帖子的要点：

使用 Workstation 类获取您要查找的路径的 WorkspaceInfo，这将搜索在该工作站上注册的所有 TFS 服务器的工作区，以查看是否有匹配项：

```
Workstation workstation = Workstation.Current;
WorkspaceInfo info = workstation.GetLocalWorkspaceInfo(path); 
```

现在您有了 WorkspaceInfo，您可以将其连接到 TFS，工作区信息包含该特定团队项目集合的 ProjectCollectionUri。并由此 Workspace 实例：

```
TfsTeamProjectCollection collection = new TfsTeamProjectCollection(info.ServerUri);
Workspace workspace = info.GetWorkspace(collection); 
```

然后使用集合或工作区访问 VersionControlServer：

```
VersionControlServer versionControlServer = collection.GetService<VersionControlServer>(); 
```

# c# - 如何在 .NET 中确定监视器的真实像素大小？

> ID：422296
> 
> 赞同：11
> 
> 时间：2009-01-07T21:55:43.717
> 
> 标签：c#, .net, windows

我想在我的应用程序中以“真实大小”显示图像。为此，我需要知道显示器的像素大小。

我知道 Windows 显示分辨率名义上是 96dpi，但出于我的目的，我想要一个更好的猜测。我知道这些信息可能并不总是可用或准确的（例如旧的 CRT 显示器），但我想随着 LCD 显示器的普及，这应该是可能的！

有没有办法获得我的显示器的像素大小？

有没有办法确定像素大小是否准确？

.NET API 的首选（我找不到它们），但 Win32 也可以，我很高兴 P/Invoke。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-07T23:06:38.020

对于您想要的显示尺寸（或）。[`Screen`](http://msdn.microsoft.com/en-us/library/system.windows.forms.screen.aspx)`.PrimaryScreen.Bounds.Size``Screen.GetBounds(myform)`

如果需要 DPI，请使用[Graphics的](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.aspx)[DpiX](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.dpix.aspx)和[DpiY](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.dpiy.aspx)属性：

```
PointF dpi = PointF.Empty;
using(Graphics g = this.CreateGraphics()){
    dpi.X = g.DpiX;
    dpi.Y = g.DpiY;
} 
```

* * *

等一下！您想要实际的，将尺子举到显示器上并测量尺寸？！不可以。不能使用*任何*操作系统服务。操作系统不知道显示器的实际尺寸，也不知道用户如何校准它。其中一些信息在理论上是可以检测到的，但它的确定性不足以让操作系统可靠地使用它，所以它没有。

作为一种解决方法，您可以尝试几件事。

*   您可以尝试查询已安装监控设备的显示字符串（我不知道该怎么做），看看您是否可以从中解析出合理的大小。例如，显示器可能是“ValueBin E17p”，您*可以*从中推断出它是 17" 显示器。当然，这个显示字符串很可能是“即插即用显示器”。这个方案充其量是相当粗略的.
*   你可以*问*用户他们有什么尺寸的显示器。 *也许*他们会知道。

一旦您知道（或*认为*您知道）显示器的对角线尺寸，您就需要找到它的物理纵横比。同样，有几件事：

*   假设当前像素纵横比与显示器的物理纵横比相匹配。这假设 (A) 用户选择了适合其显示器的分辨率，并且 (B) 显示器具有方形像素。我不知道当前没有方形像素的面向消费者的计算机显示器，但旧的有，新的可能有。
*   询问用户。 *也许*他们会知道。

一旦您知道（或*认为*您知道）显示器的对角线尺寸和物理纵横比是多少，您就可以计算它的物理宽度和高度。A ² + B ² = C ²，所以一些计算会给你带来好处：

> 如果你发现这是一个17"显示器，其当前的分辨率是1280×1024：
> 1280 ² + 1024 ² = 2686976 SQRT
> （2686976）= 1639.1998047828092637409837247032
> 17" * 1280 / 1639.2 = 13.274768179599804782820888238165"
> 17" * 1024 / 1639.2 = 10.619814543679843826256710590532 "

这使物理宽度为 13.27 英寸，物理高度为 10.62 英寸。这使得像素为 13.27" / 1280 = 10.62" / 1024 = 0.01037" 或约 0.263 mm。

当然，如果用户没有合适的分辨率，显示器有古怪的非方形像素，或者它是较旧的模拟显示器并且控件没有正确调整以使显示器充满整个物理，所有这些都是无效的屏幕。或者更糟糕的是，它可能是一台投影仪。

最后，您最好执行校准步骤，让用户*实际将尺子举到屏幕上*，并为您测量某物的大小。你可以：

*   让用户在相距一英寸（或一厘米）的任意两点上单击鼠标。
*   在屏幕上画一个盒子，让用户按上下箭头调整它的高度，按左右箭头调整它的宽度，直到按照他们的尺子，这个盒子正好是一英寸（或厘米）的正方形。
*   在屏幕上画一个框，让用户告诉你每个维度有多少英寸/厘米。

**无论您做什么**，都不要期望您的结果是 100% 准确的。对于您（或用户）来说，有太多的因素在起作用，以至于每次都无法完全正确地做到这一点。

请注意，96 dpi 通常*非常接近*准确。非投影屏幕上的现代像素都趋向于大约 0.25 毫米，给或取，所以如果显示器设置为其原始分辨率，通常每英寸*大约有100 个物理像素，给或取。*（当然，这是一个巨大的概括，并不**适用**于所有显示器。例如，Eee PC 的像素大小约为 0.19 毫米，如果我没记错规格的话。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T22:01:21.427

抱歉，您必须通过 P/Invoke 获取此信息。

这是我不久前使用的链接： [http ://www.davidthielen.info/programming/2007/05/get_screen_dpi_.html](http://www.davidthielen.info/programming/2007/05/get_screen_dpi_.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T22:03:46.210

您可以通过从屏幕尺寸手动计算来检查

```
cos(45)*LCD_SCREEN_DIAGONAL_IN_INCHES/sqrt(HORZ_RES^2 + VERT_RES^2) 
```

这会给你以英寸为单位的像素宽度

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T22:07:36.033

[`GetDeviceCaps`](http://msdn.microsoft.com/en-us/library/ms533266(VS.85).aspx)可以 P/Invoke'd 获得一些数字，但我从来不知道这些数字是那么值得信赖的......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-08T15:51:59.883

您可以使用注册表中存储的 EDID 信息获取显示器的物理尺寸。您可以使用 EnumDisplayDevices windows API 调用获取适当的监视器注册表项。

[屏幕对象的物理尺寸](https://connect.microsoft.com/VisualStudio/feedback/details/526951/screen-object-physicalwidthincentimeters-physicalheightincentimeters-displaymode)：

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-29T16:24:34.880

# TL;博士

WPF 的真实尺寸 = 像素 * DPI 放大率

DPI 放大倍数：

```
Matrix dpiMagnification
= PresentationSource.FromVisual(MyUserControl).CompositionTarget.TransformToDevice;
double magnificationX = dpiMagnification.M11;
double magnificationY = dpiMagnification.M22; 
```

# 讨论

我在 2020 年仍然无法解决这个问题。当这个问题在 2009 年被问/回答时，.NET C# 可能意味着 Windows 窗体。但是`WPF`当时的实际标准是...

通过询问“真实尺寸”，您可能已经发现操作系统使用实际像素（比如 1366x768，我理解这是通常的笔记本电脑分辨率）和 DPI（很难找到）进行一些计算，以提供控制的真实性尺寸。你正在尝试制作一个可以扩展到不同显示器的应用程序。

这个 DPI 实际数字似乎是隐藏的，但它已被标准化（转换为百分比）。假设 100% = 96 DPI，因为实际数字不再重要。人们可以通过转到 Windows 10 上的桌面 > 右键单击​​ > 显示设置 > 部分缩放和布局 > 更改百分比以放大文本和其他元素来轻松增加系统范围的文本大小。

[![Windows10_RightClickDesktop](https://i.stack.imgur.com/jG9M6.png)](https://i.stack.imgur.com/jG9M6.png)

[![Windows10_DisplaySettings_150PercentMagnification_3840x2160](https://i.stack.imgur.com/9pZ5C.png)](https://i.stack.imgur.com/9pZ5C.png)

您可以通过另一种方式找到像素，然后将像素乘以/除以 DPI 百分比以获得真实大小。例如，我想用鼠标在 WPF 窗口的画布元素周围拖动 UserControl。用户控件的像素计数和鼠标 xy 坐标被标准化 DPI 关闭。为了使鼠标以与用户控件相同的速率移动，我使用：

```
double newXCoord = System.Windows.Forms.Cursor.Position.X;
double newYCoord = System.Windows.Forms.Cursor.Position.Y;
double deltaX = newXCoord - oldXCoord;
double deltaY = newYCoord - oldYCoord;

double magnificationX = 1;
double magnificationY = 1;
Matrix dpiMagnification
= PresentationSource.FromVisual(visual).CompositionTarget.TransformToDevice;
if (magnificationMatrix != null)
{
    magnificationX = dpiMagnification.M11;
    magnificationY = dpiMagnification.M22;
}
PixelsFromLeft += deltaX / m_magnificationX;
PixelsFromTop += deltaY / m_magnificationY; 
```

# c# - 从 URL 获取匹配的路由

> ID：422304
> 
> 赞同：0
> 
> 时间：2009-01-07T21:57:37.330
> 
> 标签：c#, asp.net-mvc

如何检索 URL 的匹配路由（以字符串格式）？

基本上像...

```
Routes.GetMatchingRoute("http://mysite.com/foo/bar/1"); 
```

没有 HttpContext。

基本上我想 RedirectToAction 使用引用 URL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T22:01:57.290

你*可以*只返回 Redirect(url); 而不是 RedirectToAction();

我记得以前看到有人在 SO 上问过这个问题，但我找不到问题。

编辑：[在这里](https://stackoverflow.com/questions/87221/asp-net-urlrewriting-and-constructing-page-links#87263)（注意OP的编辑），那里也没有答案。

# visual-studio-2005 - 使用 VS2005 编译 openttd - freetype 中的链接器错误

> ID：422312
> 
> 赞同：1
> 
> 时间：2009-01-07T21:59:30.963
> 
> 标签：visual-studio-2005, linker-errors

嗯，这是一个很好的模糊的。我正在尝试在 Visual Studio 2005 中编译最新的开放式传输大亨源代码。（这是一个使用 zlib、dx8 和其他一些相当常见的库的 C++ 应用程序）。

我收到一些与 freetype 依赖项有关的链接器错误：

```
Error   1   error LNK2001: unresolved external symbol @FT_Done_Face@4   fontcache.obj   
Error   2   error LNK2001: unresolved external symbol @FT_Load_Char@12  fontcache.obj   
Error   3   error LNK2001: unresolved external symbol @FT_Init_FreeType@4   fontcache.obj   
Error   4   error LNK2001: unresolved external symbol @FT_Select_Charmap@8  fontcache.obj   
Error   5   error LNK2001: unresolved external symbol @FT_Set_Charmap@8 fontcache.obj   
Error   6   error LNK2001: unresolved external symbol @FT_New_Face@16   fontcache.obj   
Error   7   error LNK2001: unresolved external symbol @FT_Render_Glyph@8    fontcache.obj   
Error   8   error LNK2001: unresolved external symbol @FT_Set_Pixel_Sizes@12    fontcache.obj   
Error   9   fatal error LNK1120: 8 unresolved externals ..\objs\Win32\Release\\openttd.exe 
```

我已经下载了最新的 freetype stable 并编译它（也在 VS2005 中），并将 ft2build.h 和 freetype 包含目录放入我的 VS8/VC/include 目录中，并将 libfreetype2.lib 库如此编译到我的 VS8/ VC/lib 目录。我会错过什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T22:27:09.050

`@`损坏的函数名称开头的符号表明您的文件`fontcache.obj`期望这些函数具有`__fastcall`调用约定，这是不寻常的，因为默认调用约定是`__cdecl`. 我怀疑用于构建库的编译器设置和用于构建应用程序的编译器设置不匹配。有关更多信息，请参见[此处](http://en.wikipedia.org/wiki/Name_mangling)和[此处](http://msdn.microsoft.com/en-us/library/46t77ak2.aspx)。

# visual-studio - Visual Studio Team Foundation Server 真的需要在它自己的机器上吗？

> ID：422315
> 
> 赞同：0
> 
> 时间：2009-01-07T22:00:02.507
> 
> 标签：visual-studio, configuration, tfs, installation

所以我们决定使用 Visual Studio Team Foundation Server 进行版本控制等。今天准备部署并阅读安装指南：

“您不能在域控制器或运行其他服务器产品（如 Exchange Server 或主机集成服务器）的计算机上安装 Team Foundation Server。”

指南中的该评论和其他评论使我认为 ms 不希望我将 tfs 安装在专用于托管 tfs 的服务器之外的任何东西上（即不要将其放在我的前端网络服务器或后端 dc 之一上）。

我计划进行单服务器部署（主要是为了简单起见）。任何人都可以验证 tfs 必须在专用机器上吗？如果是这样，我应该将它虚拟化并将其挂在其中一台前端机器上吗？

谢谢大家...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T22:09:58.290

性能对于 TFS 非常重要——例如，签入应该是即时的，否则会对开发人员的工作效率产生巨大影响。

也就是说 - 它不需要很多马力 - 这是[服务器要求](http://msdn.microsoft.com/en-us/library/ms400670.aspx)的链接 我当前的客户端正在“虚拟” - 没有理由不 - 假设您知道如何“调整”虚拟服务器以执行等同于所述硬件规格。

要记住的关键事项之一是，TFS 中的所有数据都存储在 SQL Server 中，因此在同一硬件上运行的任何可能影响 SQL Server 性能的东西都会影响 TFS 的性能。这就是为什么将构建服务器分布在另一台机器上很重要的原因。软件构建是非常“文件系统”密集型操作，并且可能对 SQL Server 性能产生非常负面的影响 - 因此将其移至另一个“盒子”很重要

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T22:09:05.560

根据我的经验，这是因为域控制器附带的用户成员身份在域控制器上创建必要的 TFS 组会提供不正确的权限。

但是，有一个解决方法：

> 在域控制器上安装 TFS 数据层组件
> 
> 1.  将 \dt 的内容复制到临时文件中。目录，例如 C:\TEMP\dt。
> 2.  在记事本或任何支持 XML 的编辑器中打开文件 hcpackage.xml
> 3.  搜索短语“域控制器”。
> 4.  将第一个匹配后的第一个 WQL 更改为
>     
>     
>     
>     ```
>      <WQL
>       namespace="\\.\root\cimv2"
>       query="SELECT * FROM Win32_ComputerSystem WHERE Domain !='' 
>     ```
>     
>     
>     
>     AND DomainRole >3" action="=" count="1" />
>     
>     
>     
>     您必须将 count="0" 更改为 count="1"。
>     
>     
> 5.  重新启动设置。

# php - 与 ISP 无关的速度测试

> ID：422327
> 
> 赞同：0
> 
> 时间：2009-01-07T22:02:24.450
> 
> 标签：php, mysql, performance, testing, lamp

在不考虑用户连接的情况下，测试基于 LAMP 的站点速度的最佳方法是什么？

换句话说，我有一个 CMS，我想看看 PHP 和 MySQL 完成所有工作需要多长时间。

此外，我没有对服务器的 shell 访问权限，它位于共享托管环境中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T22:07:34.283

在这种情况下，最好的方法是让服务器自己计算。包装您的 CMS 代码以存储操作开始的时间，然后在脚本末尾从当前时间中减去它并打印它。

您可以使用此代码读取时间值：

```
function curtime()
{
        $tm = explode(' ', microtime());
        return $tm[1] + $tm[0];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T18:30:52.703

如果您想要一个对用户而不是工程师重要的答案，这实际上可能是一件相当复杂的测试。[Keynote Systems](http://www.keynote.com/) 专业地做这种事情。（免责声明：很久以前我差点和他们一起工作，但多年来没有和他们交谈过。）

# firefox - 页面大小：Firefox 添加

> ID：422328
> 
> 赞同：9
> 
> 时间：2009-01-07T22:02:28.633
> 
> 标签：firefox, firefox-addon

有谁知道任何可以显示当前查看页面大小的 Firefox 插件？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-07T22:04:11.483

你不需要一个。右键单击页面，选择`View Page Info`，列出大小。

[![页面大小](https://i.stack.imgur.com/QN69P.png)](https://i.stack.imgur.com/QN69P.png)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-07T22:32:13.127

如果您正在优化页面大小（以千字节为单位，而不是像素！），如果您的服务器正在压缩您的输出，您需要知道每个元素的压缩大小。您无法使用标准的网络浏览器“右键单击--> 属性”来获得它。

在另一个回复中提到的 Web Developer Toolbar 扩展就是这样做的。

[https://addons.mozilla.org/en-US/firefox/addon/60](https://addons.mozilla.org/en-US/firefox/addon/60)

我还没有找到另一个工具可以如此方便地报告每个页面元素的压缩和未压缩大小。

安装 Web Developer Toolbar 并转到 Tools-->Web Developer-->Page Information-->View Document Size。非常便利！

```
Scripts (7 files)   82 KB (243 KB uncompressed)

- http://stackoverflow.com/Content/Js/jquery.package.master.js?d=20081101   39 KB (109 KB uncompressed)
- http://stackoverflow.com/Content/Js/wmd-base.js   15 KB (59 KB uncompressed)
- http://www.google-analytics.com/ga.js 9 KB (22 KB uncompressed)
- http://stackoverflow.com/content/js/jquery.package.question.js?cachebreaker=20090107  8 KB (27 KB uncompressed)
- http://stackoverflow.com/Content/Js/showdown.js   4 KB (10 KB uncompressed)
- http://stackoverflow.com/Content/Js/jquery.package.editor.js?cachebreaker=20081008.1  3 KB (9 KB uncompressed)
- http://stackoverflow.com/Content/Js/wmd-plus.js   3 KB (7 KB uncompressed)

Style Sheets (3 files)  7 KB (27 KB uncompressed)

- http://stackoverflow.com/Content/all.css?d=20081101   6 KB (26 KB uncompressed)
- http://stackoverflow.com/Content/print.css    705 bytes (1 KB uncompressed) 
```

如果有更好的工具，我很想听听。这个功能是唯一让我不会完全放弃 Web Developer Toolbar 以使用 Firebug 的东西。也许 YSlow 会这样做；需要更多研究。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-07T22:04:06.180

[Firebug 的Web 开发工具栏](https://addons.mozilla.org/en-US/firefox/addon/60)（尺寸）或[YSlow](http://developer.yahoo.com/yslow/)（用于页面大小和加载时间）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-07T22:07:01.290

如果您想要深入分析，请使用[Firebug 。](https://addons.mozilla.org/en-US/firefox/addon/1843)如果您只想要最终数字，请右键单击并“查看页面信息”。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-03-06T18:41:45.753

`Inspect Element (Q)`右键菜单中的内置可以做到这一点。转到`Network`选项卡，重新加载并查看：

[![在此处输入图像描述](https://i.stack.imgur.com/fRPtz.png)](https://i.stack.imgur.com/fRPtz.png)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-07T22:19:26.600

FireFox 视图页面是 HTML 的大小。WebDeveloper add on 分解页面中嵌入的其他请求，例如 CSS、图像、javascripts ......等。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-07T22:07:28.170

FireBug 允许您查看页面大小和所有附加下载（css 文件、图像等）的大小。它还允许你做各种很酷的调试事情。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-01-10T19:08:55.620

您可以使用此插件：lori：请求生命周期信息：- [https://addons.mozilla.org/en-US/firefox/addon/1743](https://addons.mozilla.org/en-US/firefox/addon/1743)

它显示完全检索页面所需的时间、总大小（包括浏览器缓存中的项目）以及获取页面的请求数。

# com - 当应用程序不返回时指向 COM 对象的指针

> ID：422332
> 
> 赞同：4
> 
> 时间：2009-01-07T22:03:46.087
> 
> 标签：com

我正在使用第三方应用程序，并进行调用以创建**我的**COM 对象的实例。这个调用成功了，但是第三方应用程序上的函数*没有*返回指向创建对象的指针（我不知道为什么）。有没有办法获得指向我的对象的指针？

为了澄清，这里有一些伪代码：

```
// This function has no return value!
ThirdPartyApp.CreateObject("MyObject"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T22:11:56.867

当你的对象被创建时，让它在一个全局变量或一些其他类型的可共享存储位置中存储一个对自身的引用。然后从您的 COM DLL 中导出一个函数，该函数将从该位置读取，以便您可以调用它并获取对先前创建的对象的引用。

这个共享引用不应该*增加*对象的引用计数，否则它永远不会被破坏。当您的对象被销毁时，请确保清除该共享引用。

如果您可以在同一个进程中拥有该对象的多个实例，那么您可能需要管理一个列表，而不仅仅是一个全局变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T22:23:34.627

1.  存储您的返回值 HRESULT（这是 C++ 吗？），它可能会产生一个线索。
2.  如果您正在调用存在于另一个公寓中的工厂类型对象，有时会出现一些棘手的编组/创建问题。

# .net - 如何使用 .NET 以编程方式修改存储在 Active Directory 中的信息？

> ID：422338
> 
> 赞同：2
> 
> 时间：2009-01-07T22:04:15.557
> 
> 标签：.net, active-directory

我想编写一个 .net 程序来更新现有字段中的活动目录数据，或扩展架构以添加新字段。

有谁知道解决这个问题的最佳方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T01:28:48.480

要更新字段，您需要为要更新的对象新建一个[DirectoryEntry](http://msdn.microsoft.com/en-us/library/system.directoryservices.directoryentry.aspx)，将属性（查看 Properties 集合）设置为其新值，然后调用 CommitChanges() 以永久保存更改。并注意多值属性。

我不知道我是否会建议以编程方式扩展架构。我宁愿安全起见，让 IT 管理员改用 Active Directory Schema MMC 管理单元或 ldifde。[无论如何，微软在这里](http://msdn.microsoft.com/en-us/library/847bt562(VS.80).aspx)有一个关于模式编程的示例。 如果你必须，无论你走哪条路，你都应该练习 ADAM。

恕我直言，这是使用 .NET 进行 AD 编程的权威书籍： [目录服务编程的 .NET 开发人员指南](https://rads.stackoverflow.com/amzn/click/com/0321350170)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T22:06:22.383

您正在寻找命名空间和 dll System.DirectoryServices。

这个命名空间的实际使用是相当复杂的，你并没有指出你是否需要它的具体帮助，所以我会留在那里。

我一直使用系统工具进行字段扩展，并且没有对字段进行任何编程更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T22:07:28.623

尝试使用 PowerShell 修改 Active Directory。这是一个介绍：[http](http://technet.microsoft.com/en-us/magazine/2007.06.powershell.aspx) ://technet.microsoft.com/en-us/magazine/2007.06.powershell.aspx 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T22:08:18.573

对于编辑数据，我过去使用过[System.DirectoryServices](http://msdn.microsoft.com/en-us/library/system.directoryservices.aspx)。还没有完成字段的扩展。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T22:09:38.773

您可能还想研究 ADAM（Active Directory 应用程序模式）。我已将其用作开发环境，并且相当成功。

# c# - MVC View Inheritance

> ID：422342
> 
> 赞同：2
> 
> 时间：2009-01-07T22:04:42.590
> 
> 标签：c#, asp.net-mvc, model-view-controller, inheritance

For Example: Let's say that I want to return a **view** that displays a list of cars and also show a section of dealers in your area. These are two disjointed pieces of data.

My **view** inherits a list of cars like the following:

```
public partial class CarLot : ViewPage<List<Cars>>
{

} 
```

Now from the **controller** I can return the **view** like the following:

```
return View(Model.GetCars()); 
```

To render this, my markup would look something like the following:

```
<% foreach (Car myCar in ViewData.Model)
{some html here}
%> 
```

This takes care of the list of cars, but my question is, how do I handle the list of dealers? Does the **view** support multiple inheritance or am I going to have to hit the **model** again form the markup? I know it can be done that way, but am not sure if it is the best practice.

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-07T22:09:06.217

Create a data transfer object

```
public class CarLotViewModel
{
     public List<Car> Cars { get; set; }
     public List<Dealer> NearbyDealers { get; set; }
} 
```

Set your view to use the view model:

```
public partial class CarLot : ViewPage<CarLotViewModel>
{    
} 
```

Then in your controller:

```
var model = new CarLotViewModel();

model.Cars = GetCars();
model.NearbyDealers = GetDealers();

return View(model); 
```

Then enumerate each collection in your view:

```
<% foreach (Car car in ViewData.Model.Cars) { %>
....
<% foreach (Dealer dealer in ViewData.Model.NearbyDealers) { %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T17:39:07.677

> Set your view to use the view model:
> 
> public partial class CarLot : ViewPage { }

There is no code-behind in MVC 1.0\. How do you set the view to use view model?

# c# - 如何使安装程序的版本号与已安装程序集的版本号保持同步？

> ID：422344
> 
> 赞同：24
> 
> 时间：2009-01-07T22:05:07.270
> 
> 标签：c#, visual-studio, deployment

在我当前的项目中，我每周发布一次。我一直在使用[这篇文章](http://jebsoft.blogspot.com/2006/04/consistent-version-numbers-across-all.html)中描述的技术来保持我项目中所有程序集的版本号同步。（我目前没有任何充分的理由单独跟踪程序集的版本号，尽管我确信那一天最终会到来。）

当我推出一个版本时，我会构建一个新版本的安装程序。与可以从共享的 SolutionInfo.cs 文件中获取其版本号的所有程序集不同，安装程序的版本号不是，据我所知，程序集属性。所以我的发布过程包括在安装项目中手动推进版本号。

或者，我应该说，*通常*包括这样做。我想把它变成我不能搞砸的东西。我发现设置和部署项目的文档令人惊讶地不透明（如果用户将 MSI 安装到非默认路径，则很难找到如何正确卸载它，即一个非常可怕的常见用例没有记录）并且不知道是否有可能做到这一点。

有任何想法吗？

**编辑：**

澄清一下，这是我正在谈论的 Visual Studio 设置和部署项目。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-07T22:43:30.763

CodeProject 有一个脚本来设置 MSI 文件的版本号，您可以在安装项目的预构建步骤中运行该脚本。你在这里找到它：

> [http://www.codeproject.com/KB/install/NewSetupVersion.aspx](http://www.codeproject.com/KB/install/NewSetupVersion.aspx)

**更多细节**

请注意，使用 Windows Installer 时，事情会稍微复杂一些。MSI 文件（作为您使用 VS 设置和部署项目创建的文件）不仅具有版本号，而且还具有作为 GUID 值的产品代码。此产品代码由 Windows Installer 用于唯一标识您的产品，例如在控制面板 -> 添加或删除程序中，您可以决定卸载或修复产品。

但是，在更改您的 MSI 版本号时，在许多情况下也必须更改此产品代码。MSI 技术的文档很少，但您可以在以下 MSDN 页面上找到一些何时更改产品代码的建议：http: [//msdn.microsoft.com/en-us/library/aa367850](http://msdn.microsoft.com/en-us/library/aa367850(VS.85).aspx) (VS.85).aspx 。

在我的项目中，我总是为每个新版本生成一个新的产品代码。CodeProject 上的脚本也会为您更改产品代码。

还有一件事：Windows Installer 只检查版本号 afaik 的前三位，第四位的任何内容都将被忽略，即 2.3.0.1234 被认为等于 2.3.0.5678。（[产品版本](http://msdn.microsoft.com/en-us/library/aa370859%28v=vs.85%29.aspx)）

（有一篇关于 CodeProject 的相关文章，您可能也会感兴趣：http: [//www.codeproject.com/KB/install/VersionVDProj.aspx](http://www.codeproject.com/KB/install/VersionVDProj.aspx)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T22:19:15.930

它取决于您使用的安装程序工具包。

我们使用 TFS Team Build 和[WiX v3](http://wix.sourceforge.net/)。我有一个自定义构建任务，它增加 Team build 中的构建号（例如 5.0.0.X），然后将此版本号推送到公共 AssemblyInfo.cs AssemblyFileVersion 字段。它也由 MSBuild 作为属性传递给我们的解决方案/项目，然后传递到 WiX 并用于更新安装程序版本。

总有一天，我们可能还需要在汇编版本控制方面做得更好，但现在这对我们来说效果很好。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-06-12T23:32:42.580

我对 VS2010 安装项目（.MSI + setup.exe）使用了一种解决方法。在记事本中打开 .vdproj 并编辑 ProductVersion 分配值（下例中为 3.2.1）。通过双击 .vdproj 文件保存文件并启动 VS2010。

```
 "Product"
    {
    "Name" = "8:Microsoft Visual Studio"
    "ProductName" = "..."
...
    "ProductVersion" = "8:3.2.1"
    "Manufacturer" = "..."
...
    } 
```

# c# - 滚动我自己的 ASP.NET 注册向导

> ID：422349
> 
> 赞同：0
> 
> 时间：2009-01-07T22:05:59.297
> 
> 标签：c#, asp.net

我想如果不坐下来查看所有源代码，这是一个很难回答的问题，但我想我还是会发布它，看看你们是否对我们在我公司使用的流程有任何概念性的想法。

我目前正在从事的项目是为我们的最终用户提供的自助注册页面。以前，我们为每个不同的注册过程使用了 3 个单独的 ASP.NET 向导控件。我们的客户一致表示该过程非常混乱，他们不知道应该完成三个不同过程中的哪一个。所以在被要求将三个应用程序合二为一后，我很快发现注册向导控件的扩展性不是很好。新流程需要非常动态，因此静态的、单一路径的向导无法满足需求。

因此，为了实现更加动态的流程，我推出了自己的注册应用程序，该应用程序依赖于会话状态来引导用户完成注册。我目前设置它的方式是使用二进制标志值来进行注册中的可能步骤。然后我在 SessionState 中有一个整数值，在用户完成一个步骤后我会更新它。

**例子：**

```
 const int accountNumberStep = 1;
const int userPassStep = 2;
const int usernameReclaimStep = 4;

/* code snipped */

// Code at the end of step Username/Password selection
// at the end of Username/Password selection step, update session state to record that step was finished
SessionState("stepsCompleted") = (int)SessionState("stepsCompleted") | userPassStep;

/* code snipped */

// Code at the beginning of each step to verify previous step was completed
if (!((int)SessionState("stepsCompleted") & userPassStep == userPassStep))
{
    RedirectToPreviousPage(previousStep:=userPassStep);
} 

```

另一个主要部分（这是动态部分发挥作用的地方）是使用会话变量来跟踪他们正在经历的注册类型。换句话说，他们可以通过三种不同类型的注册：

1.  正常注册
2.  帐户更新注册
3.  获取禁用用户帐户注册

用户正在完成的注册类型是在他们完成注册时确定的。例如，在用户输入帐号后，我确定他们不是新用户，因此他们将要么更新，要么重新启用。此路径存储在会话状态的注册类型变量中。

应用程序的最后一个主要部分跟踪文本框值、单选框选择等。这些也都存储在 SessionState 中，因此如果在此过程中的任何时候，用户希望备份一两步，他们将不会丢失他们之前输入的值。这些值也用于注册过程的最后一步，在该步骤中，客户实际上是在后端数据库上注册的。

如您所见，所有这些都与 ASP.NET 向导控件所做的不同。注册类型变量除外。这允许我在过程中的任何给定点将注册分支到不同的路径。

无论如何，如果这令人困惑，再次抱歉。我主要希望有人会来做类似的事情，也许能给我一些建议。

在此先感谢您的帮助。

CJAM

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T22:15:54.627

向导控件基于 MultiView 控件，它基本上提供了一次显示一个（且仅一个）视图的方法。唯一的区别是您需要使用 MultiView 手动控制导航，因此允许您通过这些步骤进行非线性进展。

有了MultiView，所有视图中的所有控件的值都会存储在ViewState中，因此不需要将它们存储在Session中。每个视图中的按钮都可以回传，并且根据其他控件的值，您可以显示特定视图。

查看[关于 MultiView 和 View 控件的 ASP.NET 快速入门](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/multiview.aspx)

# javascript - 是否有与 Ruby 的 andand 等效的 Javascript？

> ID：422355
> 
> 赞同：5
> 
> 时间：2009-01-07T22:07:08.530
> 
> 标签：javascript, ruby, andand

为了使我的 Javascript 不引人注目，我正在使用`onLoad`s 向`<input>`s 等添加功能。使用 Dojo，这看起来像：

```
var coolInput = dojo.byId('cool_input');
if(coolInput) {
  dojo.addOnLoad(function() {
    coolInput.onkeyup = function() { ... };
  });
} 
```

或者，大致等价：

```
dojo.addOnLoad(function() {
  dojo.forEach(dojo.query('#cool_input'), function(elt) {
    elt.onkeyup = function() { ... };
  });
}); 
```

有没有人编写了 Ruby 的[andand](http://github.com/raganwald/andand/tree/master)的实现，以便我可以执行以下操作？

```
dojo.addOnLoad(function() {
  // the input's onkeyup is set iff the input exists
  dojo.byId('cool_input').andand().onkeyup = function() { ... };
}); 
```

或者

```
dojo.byId('cool_input').andand(function(elt) {
  // this function gets called with elt = the input iff it exists
  dojo.addOnLoad(function() {
    elt.onkeyup = function() { ... };
  });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T23:12:06.260

我不知道 Dojo，但你的第一个例子不应该读

```
dojo.addOnLoad(function() {
    var coolInput = dojo.byId('cool_input');
    if(coolInput)
        coolInput.onkeyup = function() { ... };
}); 
```

否则，您最终可能会在 DOM 构建之前尝试访问该元素。

回到您的问题：在 JavaScript 中，我将实现`andand()`为

```
function andand(obj, func, args) {
    return obj && func.apply(obj, args || []);
} 
```

你的例子可以写成

```
dojo.addOnLoad(function() {
    andand(dojo.byId('cool_input'), function() {
        this.onkeyup = function() { ... };
    });
}); 
```

这实际上并没有比使用显式`if`语句短得多——那何必呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T21:04:18.093

您想要的确切语法在 JavaScript 中是不可能的。JavaScript 的执行方式需要以一种非常基本的方式改变。例如：

```
var name = getUserById(id).andand().name;
//                        ^
//                        |-------------------------------
// if getUserById returns null, execution MUST stop here |
// otherwise, you'll get a "null is not an object" exception 
```

然而，JavaScript 不是这样工作的。它根本没有。

以下行几乎完全符合您的要求。

```
var name = (var user = getUserById(id)) ? user.name : null; 
```

但是可读性不会扩展到更大的示例。例如：

```
// this is what you want to see
var initial = getUserById(id).andand().name.andand()[0];
// this is the best that JavaScript can do
var initial = (var name = (var user = getUserById(id)) ? user.name : null) ? name[0] : null; 
```

还有那些不必要的变量的副作用。我使用这些变量来避免双重查找。变量正在混淆上下文，如果这很重要，您可以使用匿名函数：

```
var name = (function() {return (var user = getUserById(id)) ? user.name : null;})(); 
```

现在，用户变量已正确清理，每个人都很高兴。但是哇！多打字啊！:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T21:25:55.310

你想要[dojo.behavior](http://dojocampus.org/content/2008/03/26/cleaning-your-markup-with-dojobehavior/)。

```
dojo.behavior.add({
    '#cool_input': {
        onKeyUp: function(evt) { ... }
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T22:40:15.513

像这样的东西怎么样：

```
function andand(elt, f) {
  if (elt)
    return f(elt);
  return null;
} 
```

像这样调用：

```
andand(dojo.byId('cool_input'), function(elt) {
  // this function gets called with elt = the input iff it exists
  dojo.addOnLoad(function() {
    elt.onkeyup = function() { ... };
  });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T22:19:24.993

据我所知，没有具有相同功能的内置 JavaScript 函数。我认为最好的解决方案是按类而不是 id 查询并使用 dojo.forEach(...) ，因为您将保证在 forEach 闭包中有一个非空元素。

您总是可以使用 JavaScript 等价物：

```
dojo.byId('cool_input') && dojo.byId('cool_input').whateverYouWantToDo(...); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T22:25:42.407

我从未使用过 dojo，但大多数 javascript 框架（在处理 DOM 时）在从元素对象调用方法时返回调用元素（措辞不佳，抱歉）。所以 andand() 是隐含的。

```
dojo.addOnLoad(function() {
  dojo.byId('cool_input').onkeyup(function(evt) { /*event handler code*/
  });
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-14T20:38:13.040

对于列表：

```
Array.prototype.andand = function(property, fn) {

    if (this.filter(property).length > 0) this.map(fn);
} 
```

# java - 在 JDBC 中使用命名参数时是否有任何非法字符？

> ID：422369
> 
> 赞同：3
> 
> 时间：2009-01-07T22:09:35.093
> 
> 标签：java, sql, jdbc, prepared-statement

我在查询中使用命名参数来匹配类似地图的数据结构中的字段。数据结构可以有字段，或者其他类似地图的数据结构。这种嵌套结构是可重复的，令人作呕。

我想使用类似 XPath 的语言来命名查询中的参数，可以对其进行解析以指示进一步的嵌套查找。

所以问题是，在命名参数声明中哪些字符是合法的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:26:34.583

命名参数至少应该与数据库中对参数名的限制兼容。

对于 Oracle，参数名称由一个字母（可选地后跟更多字母、数字、美元符号、下划线和数字符号）组成。参数名称不应超过 30 个字符。因此，不允许使用连字符、斜杠和空格等字符。

# delphi - 如何使用 DUnit 测试私有方法？

> ID：422379
> 
> 赞同：17
> 
> 时间：2009-01-07T22:10:49.613
> 
> 标签：delphi, unit-testing, dunit

我有一门课，我正在用 DUnit 对它进行单元测试。它有许多方法一些公共方法和私有方法。

```
type
  TAuth = class(TDataModule)
  private
    procedure PrivateMethod;
  public
    procedure PublicMethod;
  end; 
```

为了为此类编写单元测试，我必须公开所有方法。

是否有不同的方法来声明私有方法，以便我仍然可以测试它们但它们不是公共的？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-07T22:16:46.420

您无需将它们公开。受保护就行。然后，您可以对类进行子类型化以进行单元测试并显示受保护的方法。例子：

```
type
  TAuth = class(TDataModule)
  protected
    procedure MethodIWantToUnitTest;
  public
    procedure PublicMethod;
  end; 
```

现在您可以为您的单元测试子类型化它：

```
interface

uses
  TestFramework, Classes, AuthDM;

type
  // Test methods for class TAuthDM
  TestAuthDM = class(TTestCase)
     // stuff
  end;

  TAuthDMTester = class(TAuthDM)
  public
    procedure MethodIWantToUnitTestMadePublic;
  end;

implementation

procedure TAuthDMTester.MethodIWantToUnitTestMadePublic;
begin
  MethodIWantToUnitTest;
end; 
```

但是，如果您要进行单元测试的方法与数据模块的关系如此密切，以至于除了私有之外，它们是不安全的，那么您真的应该考虑重构方法以分离需要成为单元的代码测试和访问数据模块内部的代码。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-09-13T20:33:55.177

这有点hacky，但我认为这是最简单，更清晰的方法。使用这个条件编译指令：

```
 {$IfNDef TEST}
  private
  {$EndIf} 
```

您的单元测试项目必须在`project → conditional defines`. 如果没有可见性规范，它们就会被发布。

注意：如果私有可见性不是类声明中的第一个可见性，它将获得先前的定义。一种更安全但更冗长且不太清晰的方法是：

```
 private
  {$IfDef TEST}
  public
  {$EndIf} 
```

与子类化或其他方法相比，这有很多优点：

*   没有额外的复杂性：代码中没有额外的类。
*   没有人可以“错误地”继承和覆盖你的类：你保留你的架构。
*   当你说一个方法被保护时，你有点期望它会被覆盖。你是在告诉谁在阅读你的代码。一个不应该被覆盖的受保护的方法会让你的代码读者感到困惑，这违反了我的第一个编程原则：*“必须编写代码才能被其他人阅读。”*
*   DUnit 是在他们自己的单元中，而不是无处不在。
*   你不要碰凌乱的 RTTI。

我认为这是一个更清晰的解决方案，并且比选定的答案更好。

当我使用它时，我还将测试项目配置为将构建对象放在主项目的不同目录中。这可以防止带有 TEST 指令的二进制文件与其他代码混合。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-03-13T09:50:55.953

我推荐 Gerard Meszaros 的“ [XUnit 测试模式](http://xunitpatterns.com/)”一书：

**[测试特定子类](http://xunitpatterns.com/Test-Specific%20Subclass.html)**

> **问题**：当我们需要访问 SUT 的私有状态时，如何使代码可测试？
> 
> **答案**：添加将测试所需的状态或行为暴露给 SUT 的子类的方法。
> 
> ...如果被测系统 (SUT) 不是专门为可测试而设计的，我们可能会发现测试无法访问必须在测试中的某个时间点进行初始化或验证的状态。

文章还解释了何时使用它以及它会带来哪些风险。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-03-15T00:29:44.030

将 DUnit 代码放入您的单元中。然后，您可以访问任何您喜欢的内容。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-02-07T12:03:11.780

一般来说，当我遇到这种情况时，我经常意识到我违反了单一责任原则。当然，我对您的具体情况一无所知，但也许，私有方法应该在他们自己的类中。TAuth 将在其私有部分中引用这个新类。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-15T12:34:47.253

使用**扩展 RTTI**（Delphi 2010 和更新版本），通过 RTTI 调用私有方法是另一种选择。[此解决方案也是如何测试具有私有方法、字段或内部类的类中](https://stackoverflow.com/questions/34571/whats-the-proper-way-to-test-a-class-with-private-methods-using-junit)最受好评的答案？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-08-24T17:36:12.807

```
{$IFNDEF UNITEST}
private
{$ENDIF} 
```

简单的解决方案，这几乎不是一个黑客。我经常需要测试私有方法，而这种技术会尽可能减少复杂性。

# c++ - 递归 C++ 调用中的内存分配

> ID：422389
> 
> 赞同：2
> 
> 时间：2009-01-07T22:13:28.283
> 
> 标签：c++, memory, memory-leaks, recursion

我在递归 C++ 程序中分配和释放内存时遇到问题。因此，如果不使用自动内存管理解决方案，我想知道是否有人可以帮助我解决我遇到的内存泄漏问题。

下面的代码基本上解释了这个问题（虽然这是一个人为的例子，请纠正我所做的任何错误或简化）。

保存数字值的数字类：

```
class Number {
    public:
        Number() { value = 1; };
        Number& operator + (const Number& n1) const {
            Number result = value + n1.value;
            return result;
        };
        int value;
}; 
```

执行递归的两个函数：

```
Number& recurse(const Number& v1) {
    Number* result = new Number();
    Number one = Number();
    *result = *result + recurse(one);
    return *result;
}

int main(...) {
    Number answer = Number();
    answer = recurse(result);
} 
```

如您所见，递归函数中分配的内存已泄漏，但我不确定根据递归的性质我可以从哪里释放这些内存？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-07T22:18:43.560

问题在这里：

```
Number& operator + (const Number& n1) const {
    Number result = value + n1.value;
    return result;
}; 
```

您`result`通过引用返回一个局部变量 ( )，这是一个很大的 NO-NO。局部变量在栈上分配，当函数退出时，变量就消失了。返回对局部变量的引用是将指针返回到堆栈中，该堆栈现在正用于其他用途，这将导致很多问题。

相反，您应该做的是按值返回（只需将返回类型从更改`Number&`为`Number`）。确保您有适当的复制构造函数，或者编译器自动生成的复制构造函数适合您的需要。这意味着当`operator+`返回时，它会创建一个副本（通常可以通过优化来消除），并且由于不涉及指针或引用，因此您无法获得损坏的返回值。

要修复内存泄漏，您可以使用智能指针，例如`boost::shared_ptr`. 或者，完全放弃指针和动态内存，只需从`recurse()`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T22:21:26.753

我不明白你为什么要在堆上分配内存：

```
Number& recurse(const Number& v1) {
    Number result;
    Number one;

    // I assume there is a step here to determine if the recursion should stop

    result += recurse(one);
    return result;
} 
```

通过仅在堆栈上分配，您可以保证在函数返回时清理变量。

否则我认为你必须使用某种智能指针。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T23:07:31.323

因此，除了返回 Adam Rosenfield 指出的局部变量的地址之外，我在代码中看到了其他三个问题。

首先，你的递归函数永远不会结束。在 recurse() 中的某个时刻，您必须检查导致它不再调用 recurse() 并返回的值。这是递归的基本部分。传递的参数 v1 也没有被使用。

其次，operator+() 实际上不起作用。没有办法将 int 分配给 Number() 对象。

第三，主要是传递一个从未声明过的名为 result 的东西。

忘记这些错误，我假设您想要分配堆上的所有对象以避免堆栈溢出，该函数将递归多次，或者实际使用的对象比 Number 大得多。在这种情况下，通过在 recurse() 内的堆上分配返回变量，您将强制调用者删除返回的对象。因此，在 recurse() 和 main() 中调用 recurse() 之后，您必须删除返回的值。向调用者指示的约定是返回指针而不是引用。所以 recurse() 和 main() 看起来像这样：

```
Number* recurse(const Number& v1) {
    Number* result = new Number();
    Number one;
    if(v1.value >= 2) {
        Number temp;
        temp.value = v1.value - 1;
        Number* partialResult = recurse( temp ); //capture the object to delete
        *result = *partialResult + one;
        delete partialResult;                    //delete the object
    }
    return result;
}

int main() {    
    Number result;
    result.value = 15;
    Number *answer;
    answer = recurse(result);
    delete answer;
} 
```

注意：无论递归实际计算什么都是荒谬的。我不知道意图是什么，但这只是可行的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T23:17:13.630

您是否有某些原因动态分配内存？

```
Number recurse(const Number& v1) {
    Number result;
    Number one;
    retun result + recurse(one);
} 
```

另外我注意到您没有使用值 v1

但最大的错误是递归**没有转义**子句。
这实际上是一个无限递归，基本上会耗尽内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T22:26:47.070

智能指针是您的朋友。至少快速阅读一下 auto_ptr。

另外，请阅读 Adam Rosenfield 对您的其他问题的评论（返回对不再存在的值的引用）。

# c# - WCF 和多个主机标头

> ID：422401
> 
> 赞同：10
> 
> 时间：2009-01-07T22:17:09.570
> 
> 标签：c#, wcf, iis, iis-6

我的雇主网站有多个主机名，它们都访问同一个服务器，我们只是出于品牌目的显示不同的皮肤。

不幸的是，WCF 在这种情况下似乎不能很好地工作。

我尝试[使用自定义主机工厂覆盖默认主机](http://www.robzelt.com/blog/2007/01/24/WCF+This+Collection+Already+Contains+An+Address+With+Scheme+Http.aspx)。

这不是一个可接受的解决方案，因为它需要在所有主机上工作，而不仅仅是 1。

我也看过[这篇博文，](http://blogs.msdn.com/rampo/archive/2008/02/11/how-can-wcf-support-multiple-iis-binding-specified-per-site.aspx)但要么我无法让它工作，要么它不是为了解决我的问题。

我得到的错误是“这个集合已经包含一个带有 http 方案的地址”

必须有一种方法来配置它，请帮助:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T22:41:57.460

如果您没有在端点中放置地址，那么它应该解析为任何服务器访问该服务。我使用此代码，它从 IIS 解析为我的 .local 地址和我的 .com 地址。

```
<system.serviceModel>
    <services>
        <service name="ServiceName" behaviorConfiguration="ServiceName.Service1Behavior">
            <endpoint address="" binding="wsHttpBinding" contract="iServiceName">
            </endpoint>
            <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
        </service>
    </services>
    <behaviors>
        <serviceBehaviors>
            <behavior name="ServiceName.Service1Behavior">
                <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
                <serviceMetadata httpGetEnabled="true"/>
                <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
                <serviceDebug includeExceptionDetailInFaults="true"/>
            </behavior>
        </serviceBehaviors>
    </behaviors>
</system.serviceModel> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-11-11T16:42:12.020

我认为上面发布的**主机基地址**解决方案不适用于 IIS 托管的网站（OP 确实提到这是针对他雇主的*网站*的）。

请参阅[此博客文章](http://www.pluralsight.com/community/blogs/aaron/archive/2006/07/13/31879.aspx "这篇博文")

此外，**thaBadDawg**进一步提出的另一个答案在指定多个主机标头的情况下不起作用 - 您只会得到 OP 提到的错误（“此集合已经包含带有方案 http 的地址”。）

我认为到目前为止提到的任何解决方案都不会起作用，因为 WCF 似乎不允许单个站点访问单个服务，该站点具有来自所有站点的多个主机标头。对于 .Net 3.5（及更低版本），我能找到的唯一解决方法是为每个主机标头创建不同的合同，并使用自定义 ServiceHostFactory 根据指定的合同使用正确的主机标头。这根本不实用。显然[.Net 4.0 将解决这个问题](http://blogs.msdn.com/rampo/archive/2008/02/11/how-can-wcf-support-multiple-iis-binding-specified-per-site.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-02-04T11:49:14.737

几天前我遇到了这个问题。实际上，我的情况与 Ryu 在他的问题中最初描述的情况相同。我们为许多客户提供一个虚拟目录，但每个客户都有自己的绑定。如“ [http://company1.product.com](http://company1.product.com) ”、“ [http://company2.product.com](http://company2.product.com) ”等。

[此处](http://blogs.msdn.com/rampo/archive/2008/02/11/how-can-wcf-support-multiple-iis-binding-specified-per-site.aspx)描述的解决方案有效。但是价格是多少！每次需要添加新绑定时，我们都应该更改 web.config。而且 web.config 应该包含绝对路径前缀，比如`<add prefix=”http://company1.product.com”/>`.

可以绕过第一个问题。我为 WCF 服务编写了自己的 CustomHostFactory，我在其中动态添加端点。我从 IIS 绑定中检索到这个端点（有一种从 IIS 获取信息的方法）。

这是示例代码：

```
protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
{
    var serviceHost = base.CreateServiceHost(serviceType, baseAddresses);
    var webHttpBinding = new WebHttpBinding();
    var serviceEndpoint1 = serviceHost.AddServiceEndpoint(typeof(IService), webHttpBinding,
                                                         "http://company2.product.com/WCFService/Service.svc");

    var serviceEndpoint2 = serviceHost.AddServiceEndpoint(typeof(IService), webHttpBinding,
                                                 "http://company1.product.com/WCFService/Service.svc");

    var webHttpBehavior = new WebHttpBehavior();

    serviceEndpoint1.Behaviors.Add(webHttpBehavior);
    serviceEndpoint2.Behaviors.Add(webHttpBehavior);

    return serviceHost;
} 
```

您可以从 IIS 中检索它们，而不是硬编码端点 url。但是 ServiceHost 在应用程序启动时创建一次。所以如果你需要添加新的绑定，你应该重启 IIS。这不是我们的解决方案。

这就是我们决定迁移到 asmx 的原因（就像[这里](http://kjellsj.blogspot.com/2006/12/how-to-expose-wcf-service-also-as-asmx.html)所描述的那样）。等到 Framework 4.0 发布，应该支持多个绑定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-27T23:53:21.523

一个不涉及任何代码或配置更改的简单解决方法是在 IIS 中创建另一个网站，该网站指向相同的物理目录和相同的应用程序池，但具有不同的主机头绑定。可以对尽可能多的不同主机名执行此操作。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-25T19:57:46.717

我相信你现在已经弄清楚了，但只是为了好玩，我还是会在这里发帖。

我遇到了这个确切的问题，并且一直在试图解决这个问题。最好的解决方案是将**主机基地址**放在您的服务定义中，这允许服务在这些多个地址下运行。要使此解决方案起作用，您仍然需要覆盖 ServiceHostFactory。既然你已经这样做了，就把它留在那儿。

```
<service behaviorConfiguration="ServiceBehaviour" name="Api.Service">
    <endpoint address="soap" binding="basicHttpBinding" contract="Api.IService" />
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="http://host1.com/Api" />
        <add baseAddress="http://host2.com/Api" />
      </baseAddresses>
    </host>
  </service> 
```

# windows - 从 Windows 上的 Web 浏览器无需用户名和密码即可登录

> ID：422403
> 
> 赞同：4
> 
> 时间：2009-01-07T22:18:18.443
> 
> 标签：windows, single-sign-on, ntlm, browser

我听说在 Windows 上，您可以从 Web 浏览器登录到 Web 服务器，而无需通过通常的登录方式输入用户名和密码，而是使用 NTLM 协议直接使用来自 Windows 的凭据。

这是如何实现的？Web 服务器是否需要支持一些额外的身份验证？

**更新：**我要求一个通用的 Web 服务器，而不仅仅是 IIS。例如，如何在 Apache 上做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T22:22:18.513

Web 服务器只需要配置为支持 Windows 身份验证（如果客户端和服务器都是 W2K 或更高版本，则将是 NTLM，或者 - 更好 - Kerberos）。我相信可以配置 IIS 或 Apache 来做到这一点。

浏览器也必须支持这一点 - 至少 IE 支持（不确定其他的，它可能是可能的）。*编辑：看起来firefox对此也有一些支持，MacOS上的safari*

*编辑：有关 apache 的详细信息，用于 NTLM 身份验证的谷歌模块。Kerberos 模块也存在。根据其他答案，这实际上仅适用于 Intranet - 不仅因为浏览器需要位于 Intranet 区域（仅适用于 IE），而且因为任何干预防火墙通常会停止此工作，并且因为必要的域间信任将可能不存在。如果 apache 服务器在 UNIX 上，特别是如果您在 UNIX 上也有 Kerberos 服务器，则工作起来也有点棘手，但仍然可能。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T22:25:42.237

它只会在特定情况下是无缝的；即网络服务器需要支持 NTLM（例如，IIS），并且它需要位于客户端配置为信任的区域（IE 用语中的“Intranet 区域”，除非最终用户调整了他们的设置）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T22:22:28.310

如果您的网络服务器和客户端电脑位于由 Active Directory 或类似网络保护的网络上，您可以在网络服务器上的 IIS 中为网站设置“Windows 集成安全性”，该网站会自动登录所有 IE 客户端（允许）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T22:45:29.077

如前所述，如果您的后端是 Windows 托管 (MS Active Directory)，则通常使用 NTLM。但是，也有一些可用于 Apache 的模块与此相关：[mod_ntlm](http://modntlm.sourceforge.net/)。

由于这是它自己的协议，因此要求浏览器能够理解该协议并回复身份验证挑战。我不知道哪些浏览器支持这一点，但我的假设是大多数浏览器都支持。

根据我的经验，kerberos 更像是一种首选方法，但我并没有太多地使用它，所以不幸的是，就此而言，我没有太多建议。

在旁注中，我记得在某处读到 JRE 也有一些方法可以绑定到您的 Web 服务器上的 NTLM，以便获取经过身份验证的用户的身份信息。如前所述，.NET 也对此提供支持。

此外，Firefox 默认不支持 NTLM，但可以使用以下 tut 进行配置：[http://www.crossedconnections.org/w/?p=89](http://www.crossedconnections.org/w/?p=89)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T22:22:00.323

如果您将 IIS 设置设置为需要身份验证，那么您的用户将需要登录才能访问该页面。然后，如果他们以正常方式（从控制台）登录，他们将拥有对该服务器上任何内容的任何权利（如果不是接口）。

除此之外，我不确定您指的是什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T22:34:22.297

是的，这是可能的。它通常用于用户所在的Intranet应用程序中。windows 使用*NTLM*或*Kerberos*授权用户使用中央服务，通常是 windows 平台上的*Active Directory 。*在 .NET 平台上，可以通过*System.Threading.Thread.CurrentPrincipal.Identity*实例访问当前用户信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-08-16T14:18:07.633

您可能还想研究 Jespa。它似乎比 Kerberos 更直接一些，但提供了良好的 ntlm sso 功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-03-13T12:51:21.310

我一直在寻找有关 Kerberos 的更多信息（因为 NTLM，甚至 v2，在 AD 2008 中都已弃用），我找到了这篇文章，解释了如何使它与 Apache 一起工作（正如你提到的那样）。 [http://blog.scottlowe.org/2006/08/10/kerberos-based-sso-with-apache/](http://blog.scottlowe.org/2006/08/10/kerberos-based-sso-with-apache/)

这个问题可能已经过时（或至少已解决），但如果它可以帮助某人......

# c# - LINQ to SQL，泛化

> ID：422411
> 
> 赞同：1
> 
> 时间：2009-01-07T22:20:07.880
> 
> 标签：c#, asp.net-mvc, linq-to-sql

我正在努力解决这个问题。

我正在开发一个 ASP.NET MVC 项目，将 LINQ to SQL 用于我的数据层。该数据库由大约 10 个不同的“异常”表组成，例如“Exceptions.LADM”、“Exceptions.USB”、“Exceptions.GPO”。基本上，这些表正在跟踪用户+机器信息，以放松各种安全程序。

我的 LINQ to SQL 模型已经生成。对于我可用的每张桌子，我都有不同的课程。但是，我不确定如何在控制器中使用它们，而不必为每种异常类型生成单独的控制器操作。对于`List`行动，我想做这样的事情：

```
// Example Request:  /Exceptions/List/ladm
// Routing:   Controller = "Exceptions", Action = "List", type = "ladm"

// Controller Action:

public ActionResult List(string type)
{
    string viewname = "List-" + type;   // refer to "List-ladm" view.
    if(type == "ladm")
    {
       var items = _repository.ListAllLADMExceptions();
    }

    return View(viewname, items);
} 
```

我的存储库`ListAll<XXXXXX>Exceptions`为每个表实现方法。有没有办法避免 10 种不同的 if/else 语句？它看起来很丑，我敢肯定有一种我想不出的更好的方法。可能是我从不正确的角度接近它。

任何建议都会受到欢迎。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T22:42:08.910

典型的模式是每个表一个控制器。如何使用公共基类将可变性重新划分为多个控制器类？像这样的东西：

```
public abstract class ExceptionsBaseController<T> : Controller where T:class 
{
    protected abstract Table<T> ExceptionsTable { get; }

    public virtual ActionResult List()
    {
        var items = ExceptionsTable;
        return View(items);
    }
} 
```

我看到的一个好处是更容易处理异常类之间的差异并添加新的。虽然它可能不会帮助您的总代码行数，但也许它可以唤醒想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T22:31:20.960

您可以尝试使用反射进行动态方法分派（这非常昂贵，性能方面）：

```
object items = _repository.GetType().GetMethod("ListAll"+type+"Exceptions")
                          .Invoke(_repository, null); 
```

但是，我会为 10 个案例写一个`switch`声明（不是）。`if/else`它没有那么坏。

```
switch (type) {
    case "ladm": return View("ladm", _repository.ListAllLADMExceptions());
    case "....": return View(....);
} 
```

# delphi - 德尔福win32的ORM

> ID：422426
> 
> 赞同：33
> 
> 时间：2009-01-07T22:23:35.237
> 
> 标签：delphi, orm, bold-delphi

有谁知道德尔福 Win32 的 ORM 或类似的东西。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-07T22:26:31.423

Marco Cantu 是 InstantObjects 的忠实信徒：

[http://www.instantobjects.org/](http://www.instantobjects.org/)

其他包括 DObject：

[http://www.macrobject.com/en/dobject/](http://www.macrobject.com/en/dobject/)

和 tiOPF

[http://tiopf.sourceforge.net/Doc/overview/index.shtml](http://tiopf.sourceforge.net/Doc/overview/index.shtml)

您可能还对 G 框架感兴趣：

[http://code.google.com/p/g-framework/](http://code.google.com/p/g-framework/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-01-24T10:58:11.033

Delphi 6-XE2 的另一个开源 ORM，它基于 JSON 和客户端/服务器。

可以使用自己的内存数据库层或嵌入式 SQLite3 数据库引擎：http: [//blog.synopse.info/category/Open-Source-Projects/SQLite3-Framework](http://blog.synopse.info/category/Open-Source-Projects/SQLite3-Framework)

*编辑：*对这个活动框架进行了很多改进，因为这个问题得到了回答。它现在能够连接到任何第三方数据库，并且正在更改其名称：它现在称为[mORMot 框架](http://blog.synopse.info/tag/mORMot)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-07T22:33:45.713

有一些，一些更久经考验的是......

[胆大](http://dn.codegear.com/article/33058)

[二氧化钛](http://tiopf.sourceforge.net/)

而且[RemObjects](http://www.remobjects.com/da.aspx)也有值得研究的schema Mapping技术

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-11-22T13:35:20.920

TMS Software 正在为 Delphi 开发一个 ORM 框架：TMS Aurelius 应该很快就会发布：

[TMS 奥勒留](http://www.tmssoftware.com/site/blog.asp?post=208)

编辑：已经发布，官方网站是[http://www.tmssoftware.com/site/aurelius.asp](http://www.tmssoftware.com/site/aurelius.asp)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-11-05T06:49:42.470

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-11-23T13:08:08.393

2011 年的新功能：宿舍 - [http://code.google.com/p/delphi-orm/](http://code.google.com/p/delphi-orm/)。一些文档可以在[作者的博客](http://www.danieleteti.it/category/programming/the-delphi-orm/)上找到。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-07T22:53:35.660

Jazz SDK，ORM 是 OPF 部分的一部分

[http://jazz-sdk.googlecode.com](http://jazz-sdk.googlecode.com)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-10-17T21:45:46.283

在这里你有一个：[http ://code.google.com/p/delphiorm/](http://code.google.com/p/delphiorm/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-05-09T05:47:25.367

如果您沉迷于 Delphi 2010 或更高版本，请访问[http://code.google.com/p/persiphi/ 。](http://code.google.com/p/persiphi/)

**编辑**： *`Dead link`*因为所有者可能已经放弃开源它。尽管如此，他的葡萄牙语（pt-br）硕士论文仍然可以[在这里找到](http://deschamps.blog.com/files/2011/03/Framework-ORM-Delphi-Monografia.pdf)。对于那些在对象持久性领域使用 Delphi (Annotation, Rtti...) 的最新前沿特性寻找样本的人来说，这是一个很好的灵感来源。

* * *

# 更新 1：

DevArt 发布了**[EntityDAC](http://www.devart.com/entitydac)** - 一个支持 LINQ 的 Delphi ORM！

![实体DAC](https://i.stack.imgur.com/ikKFv.jpg)

它甚至适用于 D11 (Delphi 2007)。

* * *

# 更新 2：

**[Linas Naginionis 的Marshmallow ORM 框架](https://bitbucket.org/soundvibe/marshmallow/wiki/Home)**。

它已加入出色的**[Spring4D](https://bitbucket.org/sglienke/spring4d)**项目，作为[此处](http://www.soundvibe.net/blog/me-marshmallow-and-spring4d/)宣布的*功能分支*。

要了解最新消息，请访问 Marshmallow **Google+**蓬勃发展的[社区页面](https://plus.google.com/communities/109564074300215925680)。

它被作者称为**MM** ORM 框架，是一个很有前途的框架。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-05-18T18:55:39.197

我在一些现实世界的项目中尝试了 Remobject **[Data Abstract 1-2 年。](http://www.dataabstract.com/da/)**

有些特性很好（一个非常好的二进制通信协议），有些则只是缺陷（它添加了一些混乱的代码，你必须逐个对话地传递你对模式所做的每次更改）。

定义模型的模式很好，但错过了 SQL 的大部分功能（es grouping by，易于使用的 join，ecc），这很糟糕。

我认为很难在旧的 VCL 和 TDataSet 之上安装一个好的 ORM。

DatAbstact 是一个尝试，但最后我用另一种语言重写了我的应用程序，因为一个好的 ORM 和一个好的框架是一个好的应用程序必须具备的。

VCL 太老了，不能很好地适应现代应用程序开发的概念。

无论如何，我尝试了 InstantObject 和 Bold，它们是两个很好的 ORM 框架，但没有更多的支持。

# domain-driven-design - 在模型视图 Presenter 和领域驱动设计项目中使用 Presenters 中的工厂

> ID：422440
> 
> 赞同：0
> 
> 时间：2009-01-07T22:25:44.780
> 
> 标签：domain-driven-design, factory, mvp

在域驱动设计中，使用工厂在域层中创建域对象似乎是一种很好的做法（而不是使用直接构造函数或 IoC）。

但是在表示层中使用域对象工厂呢？例如，假设我正在根据从演示者获得的用户输入创建域对象。

这是一个示例，假设我有一个配置域对象，该对象具有许多十进制设置。

公共类配置：PersistantObject {

```
 public decimal temperature {get;set;}

 ...(times 20)

 public decimal gravity {get;set;} 
```

}

为了在域层而不是演示者层中创建这个对象，我必须将这些十进制值中的每一个作为函数参数传递。创建一个笨拙的函数定义和调用。

即 ConfigurationService.CreateConfiguration(温度, ...(x20), 重力);

也许更好的解决方案是在演示者层创建配置对象，并直接从用户输入分配配置对象的所有值，跳过冗长的函数调用。

配置配置 = ConfigurationFactory.CreateNewConfiguration();

配置温度=温度；

..(x20).. = ...;

config.gravity = 重力；

ConfigurationService.SaveNewConfiguration(config);

但我想知道这种方法是否错误，为什么？如果这两种方法都是错误的，那么从用户输入创建长对象的最佳方法是什么？为什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T03:24:05.877

我建议不要让您的域对象离开域层并进入表示层。让表现层专注于表现。

出于这个原因，我构造了数据传输对象来在域和表示层之间进行数据混洗。在您的情况下，让对话框填充传递给您的服务并转换为相应域对象的 DTO。

You wouldn't want to construct domain objects from DTOs every time, though. [Consider the case where a DTO represents only a subset of a domain object](http://moffdub.wordpress.com/2008/10/29/one-domain-object-and-multiple-dtos-enter-one-solution-leaves/). Re-constructing an existing domain object from such a DTO would give you a partial domain object. You'd probably want to maintain a light-weight cache that held the full domain object so you could do a proper update.

Essentially, you'd arrive at the DTO solution if you applied the [Introduce Parameter Object](http://www.refactoring.com/catalog/introduceParameterObject.html) refactoring.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T22:36:44.133

我有两种主要的方法来处理这个

1）如果这是通过对话框设置的，我将创建实现命令模式的类并将对话框与相关对象绑定。例如 CmdCreateConfigurationService 和 CmdEditConfigurationService。

CmdCreateConfigurationService 将依赖于您选择正确配置服务所需的工厂类和最小参数。

您设置一个 IConfigurationServiceEditor 接口并将其作为参数之一传递给 CmdEditConfiguration 参数。使用 IConfigurationServiceEditor 接口，您可以根据需要定义尽可能多的方法，以尽可能轻松地在对话框之间进行信息传输。我建议使用键和值的集合。命令对象知道如何从这个集合中设置配置服务。对话框知道在设置时期望这个集合。

无论数据结构如何，您都将完成在命令对象中填写配置服务的工作。通过让非对话框/表单/屏幕对象实现 IConfigurationServiceEditor，您可以自动化您的测试，并在某些情况下使复杂对象的配置更容易。

我为 CAD/CAM 软件开发了这种方法，该软件有几十个参数形状，每个形状有 4 到 40 个条目。

# c# - 蓝牙到串行适配器 - 连接异常

> ID：422452
> 
> 赞同：0
> 
> 时间：2009-01-07T22:27:28.910
> 
> 标签：c#, windows-mobile, compact-framework, bluetooth

目前正在编写一个应用程序连接到设备“BTLink Bluetooth to Serial Adapter”

有关设备的更多信息：[设备规范](http://cgi.ebay.pl/Bluetooth-to-RS232-Serial-Adapter-Dongle-100m-UK_W0QQitemZ300266522534QQcmdZViewItem?hash=item300266522534&_trkparms=72%3A1399|39%3A1|66%3A2|65%3A12|240%3A1318&_trksid=p3286.c0.m14) 创建了这样的代码：

```
 BluetoothAddress btAddress = null;
    if (!BluetoothAddress.TryParse(comboBoxDevices.SelectedValue.ToString().Trim(), out btAddress))
            throw new Exception(String.Format("Adress: {0} wrong !", comboBoxDevices.SelectedValue.ToString().Trim()));
    BluetoothEndPoint endPoint = new BluetoothEndPoint(btAddress, BluetoothService.DialupNetworking);
    _bluetoothClient.Connect(endPoint); 
```

我测试了两种类型的 GUID：BluetoothService.DialupNetworking、BluetoothService.SerialPort。我收到这条消息：“无法建立连接，因为目标机器主动拒绝了它”这是怎么回事？

最好的问候， mykhaylo

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T23:47:23.537

您是否在 32Feet.net 或[他们的支持论坛](http://inthehand.com/forums/default.aspx?GroupID=29)（[您正在使用的课程](http://inthehand.com/content/32feet.aspx)的提供者）上查看过？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T08:32:16.040

我会首先尝试使用设备的内置蓝牙功能连接到目标机器。只有在这成功之后，我才会尝试以编程方式连接到它。

为了能够连接到蓝牙设备，您需要了解以下内容：

*   要使用的蓝牙配置文件。您已经尝试过 Serial 和 Dialup，但它们中的哪一个实际上是想要的？许多设备只支持一个配置文件，并且会拒绝连接到另一个请求不受支持的服务的设备。
*   认证信息。某些设备需要预定义密码。
*   许多设备只能与单个 BT 设备建立连接。目标设备是否已经连接到其他地方？

您遇到的错误很可能与上述之一有关，与蓝牙库的使用无关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-03T19:23:15.943

我使用标准[串行蓝牙适配器](http://www.usconverters.com/index.php?main_page=product_info&cPath=65&products_id=228)进行了类似的设置和程序，没有问题。您需要确保使用正确的蓝牙配置文件，端口必须可用并且必须接受验证码。只是一些建议。

# sql-server - 分离 SQL Server 数据库

> ID：422475
> 
> 赞同：4
> 
> 时间：2009-01-07T22:34:44.260
> 
> 标签：sql-server, backup, filegroup

我使用的是 SQL Server 2008。我的数据库大小接近 2GB。其中 90% 是一张表（根据 sp_spaceused），我的大部分工作都不需要这张表。

我想知道是否可以使用这张表，并将其备份在一个单独的文件中，这样我就可以比这张表更频繁地传输重要数据。

我的猜测是最简单的方法是创建一个新数据库，在那里创建表，将表内容复制到新数据库，删除表关系，删除表，创建一个指向另一个数据库的视图并使用该视图在我的应用程序中。

但是，我想知道您是否对我目前可能不知道的不同策略有任何指示。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-07T22:39:08.357

**在不同的FileGroup**中创建表。

[这是一个包含一些很好例子的链接。](http://www.mssqltips.com/tip.asp?tip=1112)

这将为该表创建第二个物理文件。它可以放置在不同的物理驱动器上以提高性能。您可以只备份或恢复特定的文件组，这听起来像是您需要的。

这是“数据分区”这一更大主题的一个示例，其中涉及将大表划分为多个文件的各种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T22:39:09.557

我建议使用文件组解决方案。但是，要将表从数据库复制到另一个，您可以执行以下操作：

```
SELECT * INTO MyNewDatabase..MyTable FROM MyOldDatabase..MyTable 
```

# javascript - 通过原型对象或构造函数设置方法，区别？

> ID：422476
> 
> 赞同：18
> 
> 时间：2009-01-07T22:34:46.070
> 
> 标签：javascript, constructor, prototype

你能解释一下在构造函数中设置方法和通过原型对象设置方法的区别吗？以下代码显示了这两种设置方法的方式 -`say_hello`并且`say_bye`都可以正常工作：

```
function MessageClass() {
  this.say_bye = function() { alert('see ya'); };
}

MessageClass.prototype.say_hello = function() { alert('hello'); };

x = new MessageClass();
x.say_hello();
x.say_bye(); 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-07T22:55:50.367

foxxtrot 和 anakata 都是正确的，但我会投入 2 美分。

如果您使用原型，那么“MessageClass”的每个实例实际上都在引用相同的函数。这些函数只在内存中存在一次，并用于所有实例。如果您在构造函数中声明方法（或将其添加到特定实例）而不是原型，则将为 MessageClass 的每个实例创建一个新函数。

话虽如此，在大多数情况下可能没有任何明显的性能差异，您也不太可能看到内存使用差异。除非您有令人信服的理由不这样做，否则我会使用原型方法。你可能想要在构造函数中声明一个方法的唯一原因是你是否需要一个闭包。例如，如果你有事件处理程序或者你想用 getter/setter 模拟私有属性，你可以这样做：

```
function MessageClass() {
    var self = this;
    this.clickHander = function(e) { self.someoneClickedMe = true; };

    var _private = 0;
    this.getPrivate = function() { return _private; };
    this.setPrivate = function(val) { _private = val; };
} 
```

**编辑：**因为已经讨论过这如何影响另一个对象扩展的对象，并在构造函数中分配了函数，所以我添加了更多细节。我可能会使用“类”这个词来简化讨论，但重要的是要注意 js 不支持类（这并不意味着我们不能做好的 OO 开发），否则我们不会讨论这个问题。

大多数 javascript 库在基类和子类上调用构造函数。（例如 Prototype.js 的 Object.extend）这意味着在每个构造函数中分配的方法将在结果对象上可用。但是，如果您自己扩展对象，则可能会产生意想不到的后果。

如果我采用上面的 MessageClass 并扩展它：

```
function ErrorMessageClass() {}
ErrorMessageClass.prototype = new MessageClass();

errorMsg = new ErrorMessageClass(); 
```

然后 errorMsg 将有一个 getPrivate 和 setPrivate 方法，但它们的行为可能与您预期的不同。因为这些函数在分配时是有作用域的（即在“ErrorMessageClass.prototype = new MessageClass()”处，不仅 get/setPrivate 方法是共享的，_private 变量也会在 ErrorMessageClass 的所有实例之间共享。这实际上使 _private 成为ErrorMessageClass 的静态属性。例如：

```
var errorA = new ErrorMessageClass();
var errorB = new ErrorMessageClass();
errorA.setPrivate('A');
console.log(errorA.getPrivate()); // prints 'A'
console.log(errorB.getPrivate()); // prints 'A'
errorB.setPrivate('B');
console.log(errorA.getPrivate()); // prints 'B' 
```

与 clickHandler 函数和 someoneClickedMe 属性类似：

```
errorA.clickHandler();
console.log(errorA.someoneClickedMe); // prints 'true'
console.log(errorB.someoneClickedMe); // prints 'true' 
```

但是，将这些函数定义更改为使用 this._private：

```
this.getPrivate = function() { return this._private; };
this.setPrivate = function(val) { this._private = val; }; 
```

并且 ErrorMessageClass 实例的行为变得更像您所期望的：

```
errorA.setPrivate('A');
errorB.setPrivate('B');
console.log(errorA.getPrivate()); // prints 'A'
console.log(errorB.getPrivate()); // prints 'B' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-07T22:41:27.493

如果您通过原型 JS 绑定方法只需执行一次并绑定到对象类（这使得它可以用于 OO JS 扩展）。

如果您在“类”函数中进行绑定，则 JS 必须为每个实例完成创建和分配的工作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-07T22:36:57.517

不同之处在于从 Message Class 派生类。只有在原型上声明的方法才能在 Message 的子类上可用。

# c# - 缺少字典 .KeyCollection 扩展方法 .NET 3.5 (C#)

> ID：422486
> 
> 赞同：2
> 
> 时间：2009-01-07T22:37:09.543
> 
> 标签：c#, .net-3.5

也许我错过了扩展方法的概念，但我无法访问此处定义的 KeyCollection 类中的扩展方法：http: [//msdn.microsoft.com/en-us/library/dk7e2d8e.aspx](http://msdn.microsoft.com/en-us/library/dk7e2d8e.aspx)。

使用以下代码摘录：

```
 Dictionary<int, int> foo = new Dictionary<int,int>();
   foo.Add(1,1);
   Dictionary<int, int>.KeyCollection kc = foo.Keys; 
```

我只能访问“标准”KeyCollection 方法（CopyTo、Equals、Finalize 等），但无法访问扩展方法（Aggregate、All、Any 等）。

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T22:39:46.420

我刚试过，看起来我可以。

你没有忘记

```
using System.Linq; 
```

你是否？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T22:39:54.313

您是否错过了`using System.Linq`班级顶部的声明？

# jquery - 无法从 jqGrid（jQuery）中的单元格获取对象

> ID：422504
> 
> 赞同：2
> 
> 时间：2009-01-07T22:42:07.257
> 
> 标签：jquery, dom, select, jqgrid, ddl

这就是问题所在，当我定义 ddl（下拉列表或选择框）时，我不知道所选值。当用户编辑一行时，用户可以从列表中选择一个项目。但未设置所选项目。我想在用户单击按钮编辑行时设置所选项目。

我认为正确的方法是获取构建 jqGrid 时创建的 ddl 并设置所选值。

```
$("#list").jqGrid({
  datatype: 'clientSide',
  colNames: ['Edit', 'Delete', 'Save', 'Cancel', 'Location'],
  colModel: [
             ....
             ....
        { name: 'Location', index: 'Location', width: 90, editable: true, edittype: "select", editoptions: { value: SI:System Integration ; IM:Information Management ; IA:Industrial Automation ; CI:Custom Instrumentation}}]
}); 
```

当用户单击编辑按钮时，我从 ddl 列表中获取数据

```
var locationText = $("#list").getRowData(rowNum).Location;

locationText  =    
<SELECT id=1_Location class=editable><OPTION value="R         ">Rochester</OPTION><OPTION selected value="MA        ">Massachusetts</OPTION><OPTION value="DL        ">Data Librarian</OPTION><OPTION value="Buff      ">Buffalo /  Niagara Falls</OPTION><OPTION value="Bing      ">Binghamton / Owego / Southern Tier</OPTION><OPTION value="Other     ">All other locations</OPTION><OPTION value="Alb       ">Albany and all points East</OPTION><OPTION value=""></OPTION></SELECT> 
```

而不是从 jqGrid 中的单元格获取数据，我宁愿获取 dom ddl 元素对象。

我有的另一个想法，但不认为是正确的，是使用 locationText 并使用它来创建一个新的 ddl dom 元素。

像这样的东西。

```
var locationTmp2 = document.createElement("select");
locationTmp2.innerHTML = locationText;
or 
locationTmp2.text= locationText; 
```

有没有一种简单的方法来做我想做的事情。我知道我可以创建一个新的 dom 选择元素，然后向其中添加每个选项，就像这样

```
 //populate and set the selected item for locations.
        var locationSelect = document.createElement("select");
        var arrayLocations = ('R:Rochester;MA:Massachusetts;DL:Data Librarian;Buff:Buffalo/Niagara Falls;Bing :Binghamton / Owego / Southern Tier;Other:All other locations;Alb:Albany and all points East;').split(";");
        for (var i = 0; i < arrayLocations.length - 1; i++) {
            var optionItem = document.createElement("option");
            optionItem.value = trim(arrayLocations[i].split(":")[0]);
            optionItem.text = trim(arrayLocations[i].split(":")[1]);
            //check if this should be the selected item.
            if (arrayLocations[i].indexOf(rowData.Location) != -1)
                optionItem.selected = true;
            locationSelect.add(optionItem);
        } 
```

但是应该有一种方法可以从 jqGrid 中获取整个 dom 元素。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T02:54:22.340

元素 id 将等于您在 colModel 中定义的列名。在你的情况下， $("#Location") 会给你你想要的元素，你可以从那里开始。

此外，请确保您使用正确的事件来处理此问题 - beforeShowForm 或 onInitializeForm 取决于您的需要。这是一个很好的讨论[例子](http://www.trirand.com/blog/?page_id=18/help/combobox-dynamic-in-a-subgrid/page-1&value=select%251&search=2&ret=all)。

# documentum - 使用 Documentum API 调用获取有关工作流项的信息

> ID：422512
> 
> 赞同：1
> 
> 时间：2009-01-07T22:45:43.083
> 
> 标签：documentum

**根据工作流的package_id**获取有关工作流中包信息的 API 调用是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T18:43:26.033

您具体要检索什么信息。工作流信息存储在许多不同的对象中，很难追踪。请张贴您特别想找到的内容，我可能会提供更多帮助。首先，这些对象包括：

*   dm_workflow
*   dmi_workitem
*   dmi_wf_attachment

但也有其他人。

# vb.net - VB.Net/黑莓

> ID：422514
> 
> 赞同：1
> 
> 时间：2009-01-07T22:46:13.007
> 
> 标签：vb.net, blackberry

我有一个为 PDA 编写的 vb.net 应用程序。

是否可以为黑莓编写 VB.net 应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T22:50:35.133

不，Blackberry 使用 Java，用于标准 J2ME 或 RIM 自己的 API。

查看他们的[入门](http://na.blackberry.com/eng/developers/started/bbdevapproach.jsp)页面。

非常古老的 Mobitex 寻呼机使用 C++，但同样不支持 VB.net。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T23:08:15.443

事实上，你可以。有一种名为 CrossFire 的产品是由一家名为 AppForge 的公司生产的，该公司现已不复存在。但是，有几篇文章介绍了如何使用它。我相信甲骨文购买了这些权利。我认为没有人在卖它。该产品绝对有效。我不知道为什么公司倒闭了。

不过，我相信 CrossFire 的最新版本是 6.0。很遗憾你在任何地方都买不到它。但是，这可能会解决您的需求。假设您可能会找到它，它可能是 58MB。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T13:57:24.387

En la pagin de blackberry encontre un plugin que se puede instalar en Visual Studio 2005 - 2008 y sirve para trabjar con Blackberry。米拉埃斯特链接[http://na.blackberry.com/eng/developers/rapidappdev/devtools.jsp](http://na.blackberry.com/eng/developers/rapidappdev/devtools.jsp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T22:52:39.373

我已经使用他们的自定义 API 和 Java 以及（几乎没有）J2ME 为 BlackBerry 编程。这是一个巨大的混乱，尤其是当他们当时没有 Eclipse 插件时。最近他们确实发布了一个 Eclipse 插件，它应该让生活更轻松。

VB.NET 没有得到官方支持，抱歉。

# sql-server - 从现有数据库生成 SQL DDL 和内容的工具

> ID：422525
> 
> 赞同：2
> 
> 时间：2009-01-07T22:51:26.053
> 
> 标签：sql-server, ddl

有谁知道一个价格合理的工具，它将创建 DDL 语句来创建 SQL Server 数据库*和*适当的插入语句来重新创建数据？我使用 Red Gate 工具进行数据库比较（包括内容比较），这很接近（我总是可以与空模式进行比较），但我想知道是否有其他人认为有用的工具可以一步完成。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-04T13:34:06.643

迟到的答案......希望有人会发现它有用......

Red Gate 有一个名为 SQL Multi Script 的工具，可以根据您的需要编写脚本。不知道当问题被问到时它是否存在:)

另一个好作品是[ApexSQL 的 SQL 构建工具，](http://www.apexsql.com/sql_tools_build.aspx)它还可以执行各种插入和其他脚本……</p>

免责声明：我不隶属于上述任何公司。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T23:01:45.843

[SQL 发布向导](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en)

看到[Austin Solonen](https://stackoverflow.com/questions/378559/import-existing-stored-procedures-in-sql-server#378578)在一个有点相关的线程中发布了这个工具。Express 版本似乎没有导入和导出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T23:03:04.657

你看过[SQL Publishing Wizard](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en)吗？它将为所有数据库元素（表、视图、SP、用户等）创建您需要的所有 DDL 语句。

如果您使用的是 SQL 2008，它会内置在管理工作室中。[有关 2008 的更多信息](http://blogs.msdn.com/webdevtools/archive/2007/10/15/sql-database-publishing-wizard-is-now-in-visual-studio-orcas.aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T23:08:00.263

Visual Studio 2008 中包含的**[数据库发布向导执行此功能。](http://blogs.msdn.com/webdevtools/archive/2007/10/15/sql-database-publishing-wizard-is-now-in-visual-studio-orcas.aspx)**

它还可以[通过 CodePlex](http://www.codeplex.com/sqlhost/)作为 Visual Studio 早期版本的附加组件使用。

# javascript - IE7 不发送 Cookie

> ID：422526
> 
> 赞同：1
> 
> 时间：2009-01-07T22:51:29.860
> 
> 标签：javascript, internet-explorer, internet-explorer-7, cookies

我有两个 IE7 副本，完全相同的安全设置和完全相同的版本。两台不同的机器，都运行 WinXP。在我的应用程序中，我的 cookie 标头正在一个版本的 IE 上正确发送到服务器。在其他版本中没有发送其他 cookie。

在这种情况下有哪些问题需要解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T01:18:42.323

尝试 Fiddler 来追踪正在发生的事情，它比 Wireshark 更适合（并且更简单）用于此目的。

[http://www.fiddlertool.com/fiddler/](http://www.fiddlertool.com/fiddler/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T23:40:35.797

您可能想要获取类似[wireshark](http://www.wireshark.org/)的东西来查看通过线路发送的内容。FIrebug 有一些这样的网络实用程序，但您的问题似乎特定于 IE。尽管如此，尝试使用其他浏览器来解决此问题并没有什么坏处。

其他要查找的项目是 IE 安装的高级属性和网站所在的区域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T23:49:02.537

小心您访问的链接。我花了将近一天的时间才发现为什么同一个浏览器有时会发送会话 cookie，而有时却没有。

通过[http://www.example.com访问页面将创建与](http://www.example.com)[http://example.com](http://example.com)不同的 cookie （没有“www”），因为浏览器将它们视为两个不同的访问点:)

还要小心你的浏览器设置。你应该确保它们是相同的。

# shell - 从 shell 写入 fifo/pipe，超时

> ID：422530
> 
> 赞同：2
> 
> 时间：2009-01-07T22:52:18.453
> 
> 标签：shell, timeout, named-pipes

我有一对通过命名管道进行通信的 shell 程序。阅读器在启动时创建管道，并在退出时将其删除。

有时，写入者会在读取器停止读取和移除管道之间尝试写入管道。

```
reader: while condition; do read data <$PIPE; do_stuff; done
writer: echo $data >>$PIPE
reader: rm $PIPE 
```

发生这种情况时，作家将永远挂起，试图打开管道进行写作。

有没有一种**干净**的方法可以让它超时，这样它就不会一直挂起，直到被手动杀死？我知道我能做到

```
#!/bin/sh
# timed_write <timeout> <file> <args>
# like "echo <args> >> <file>" with a timeout

TIMEOUT=$1
shift;
FILENAME=$1
shift;
PID=$$

(X=0; # don't do "sleep $TIMEOUT", the "kill %1" doesn't kill the sleep
 while [ "$X" -lt "$TIMEOUT" ];
 do sleep 1; X=$(expr $X + 1);
 done; kill $PID) &

echo "$@" >>$FILENAME
kill %1 
```

但这有点恶心。是否有内置的 shell 或命令可以更干净地执行此操作（不破坏 C 编译器）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T00:39:28.877

这个问题会定期出现（尽管我无法通过搜索找到它）。我编写了两个 shell 脚本用作超时命令：一个用于读取标准输入的内容，一个用于不读取标准输入的内容。这很臭，我一直想写一个 C 程序，但我还没有开始。我绝对建议`timeout`一劳永逸地用 C 语言编写命令。但与此同时，这是两个 shell 脚本中更简单的一个，如果命令读取标准输入，它就会挂起：

```
#!/bin/ksh

# our watchdog timeout in seconds
maxseconds="$1"
shift

case $# in
  0) echo "Usage: `basename $0` <seconds> <command> [arg ...]" 1>&2 ;;
esac

"$@" &
waitforpid=$!

{
    sleep $maxseconds
    echo "TIMED OUT: $@" 1>&2 
    2>/dev/null kill -0 $waitforpid && kill -15 $waitforpid
} &
killerpid=$!

>>/dev/null 2>&1 wait $waitforpid
# this is the exit value we care about, so save it and use it when we
rc=$?

# zap our watchdog if it's still there, since we no longer need it
2>>/dev/null kill -0 $killerpid && kill -15 $killerpid

exit $rc 
```

另一个脚本在[http://www.cs.tufts.edu/~nr/drop/timeout](http://www.cs.tufts.edu/~nr/drop/timeout)在线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T04:42:21.663

处理这个问题的 UNIX“标准”方式是使用[Expect](http://expect.nist.gov/)，它带有定时运行的例子：只运行一个程序给定的时间。

Expect 可以为脚本创造奇迹，非常值得学习。如果你不喜欢 Tcl，还有一个[Python Expect](http://www.noah.org/wiki/Pexpect)模块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T16:21:38.757

这对程序在使用 Unix 域套接字而不是命名管道在 Perl 中重新编写后工作得更好。这个问题中的特殊问题完全消失了，因为如果/当一端死了，连接就会消失而不是挂起。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-09T18:58:13.930

```
trap 'kill $(ps -L $! -o pid=); exit 30' 30
echo kill -30 $$ 2\>/dev/null | at $1 2>/dev/null
shift; eval $@ &
wait 
```

# ruby - ruby：块可以影响方法中的局部变量吗？

> ID：422536
> 
> 赞同：11
> 
> 时间：2009-01-07T22:56:06.450
> 
> 标签：ruby, closures

我只是在学习 ruby​​ 并试图了解块中执行的代码的范围。例如，我希望能够创建一个影响它附加到的方法的块，如下所示：

```
def test(&block)
  block.call() if block_given?
  puts "in test, foo is #{foo}"
  puts "in test, bar is #{bar}"
end

test() {
  foo="this is foo"
  bar="this is bar"
} 
```

在这种情况下，我根本不想修改块——我希望能够使用简单的变量引用而不是参数来编写它。*只有对上例中的“测试”方法进行更改*，是否可以访问块中定义的变量？

同样，目标是不修改块，但能够在块执行后从“测试”中访问创建的变量。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T23:09:00.353

首先，`block.call()`用 完成`yield`，你不需要那样的`&block`参数。

你通常不能做你想做的事，块在创建时是绑定的，在块内你可以看到当时定义的局部变量；做你想做的最简单的方法，这不是你通常使用块的方式，是这样的：

```
def test()
  foo = yield if block_given?
  puts "in test, foo is #{foo}"
end

test() {
  foo="this is foo"
} 
```

但这只是一个副作用，因为`foo`它被块“返回”了。如果您改为这样做：

```
def test()
  foo = yield if block_given?
  puts "in test, foo is #{foo}"
end

test() {
  foo="this is foo"
  "ha ha, no foo for you"
} 
```

你会注意到它做了一些不同的事情。

这里有更多的魔法：

```
def test(&block)
   foo = eval "foo", block.binding
   puts foo
   block.call
   foo = eval "foo", block.binding
   puts foo
end

foo = "before test"
test() {
  foo = "after test"
  "ha ha, no foo for you"
} 
```

这会起作用，但如果你删除它会中断，`foo = "before test"`因为它`foo`成为块中的局部变量并且不存在于绑定中。

摘要：您不能从块中访问局部变量，只能访问定义块的局部变量和块的返回值。

即使这样也行不通：

```
def test(&block)
   eval "foo = 'go fish'", block.binding
   block.call
   bar = eval "foo", block.binding
   puts bar
end 
```

因为`foo`绑定中的 与块中的本地不同（我不知道，谢谢）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T08:34:03.787

不，一个块不能影响它被调用的地方的局部变量。

Ruby 中的块是*闭包*，这意味着它们在创建时捕获它们周围的范围。创建块时可见的变量就是它看到的变量。如果在代码的顶部有一个`foo`and ，在任何方法之外，该块在被调用时*会*改变那些。`bar`

 ** * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T08:50:16.017

你可以通过更详细一点来做你想做的事：

```
class Test
  def foo(t)
    @foo = t
  end
  def bar(t)
    @bar = t
  end
  def test(&block)
    self.instance_eval &block if block_given?
    puts "in test, foo is #{@foo}"
    puts "in test, bar is #{@bar}"
  end
end

Test.new.test() {
  foo "this is foo"
  bar "this is bar"
} 
```

您可以创建这样的方法`attr_accessor`，将生成适当的设置器（`foo`和`bar`方法）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-07T23:10:17.980

```
def test(&block)
  foo = yield
  puts "in test, foo is #{foo}"
end

test { "this is foo" } 
```

印刷`in test, foo is this is foo`

产量的价值是块的价值。

您也可以将参数传递给 yield，然后块可以使用 |param,another| 访问它 在块的开头。

另外，检查过程。

```
foo = "this is foo"
p = Proc.new { "foo is #{foo}" }
p.call 
```

印刷`"foo is this is foo"`

```
def test(p) 
  p.call
end

test p 
```

印刷`"foo is this is foo"`

```
def test2(p)
  foo = "monkey"
  p.call
end

test2 p 
```

印刷`"foo is this is foo"`

# sharepoint - 如何在 SharePoint 列表上自动启用内容审批？

> ID：422542
> 
> 赞同：2
> 
> 时间：2009-01-07T23:01:04.193
> 
> 标签：sharepoint, configuration

我正在尝试创建一个功能，该功能既可以创建列表模板又可以创建该列表的实例（使用`<ListTemplate`> 和`<ListInstance`> 元素。我希望默认打开内容审批。根据[ListTemplate 上的文档](http://msdn.microsoft.com/en-us/library/ms462947.aspx)，设置EnableModeration 属性为 TRUE 应该可以做到。但是，当我尝试安装解决方案时，我收到以下错误：

> “EnableModeration”属性无效-根据其数据类型“ [http://schemas.microsoft.com/sharepoint/:TrueFalseMixed](http://schemas.microsoft.com/sharepoint/:TrueFalseMixed) ”，值“TRUE”无效-枚举约束失败。

更多搜索表明接受的值实际上是“真”，而不是“真”。安装得很好，但是在创建列表时似乎没有效果 - 它仍然不需要内容批准。知道我做错了什么吗？

编辑：如果有人甚至可以为我确认他们以前是否见过“真”或“真”的工作，那至少会缩小我的搜索范围。

更新：我发现我可以使用功能接收器中的代码启用内容批准：

```
list.EnableModeration = true;
list.Update(); 
```

这有点小技巧，所以能够通过 XML 来实现这一点仍然很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T02:59:49.840

我最终只使用了特征接收器方法，因为我只需要继续前进。但是，我后来发现用于定义列表架构的[List 元素](http://msdn.microsoft.com/en-us/library/ms415091.aspx)也具有 ModeratedList 和 ModerationType 属性，看起来它们可能与此有关。因此，如果其他人遇到同样的问题，我建议您试一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T13:53:24.250

您的自定义列表上是否有“ModStat”类型的字段？

> ModStat 指定内容批准状态。对应于 SPFieldModStat 类和在 Field 元素上指定的 ModStat 字段类型。值 = 23。

来自[SPFieldType 枚举文档](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfieldtype.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-10T17:54:08.123

我为 List 元素设置了 ModeratedList="TRUE" ModerationType="TRUE" ，为 ListTemplate 元素设置了 EnableModerate="True" 。这个对我有用。好吧，使用 TRUE 或 True 都没有关系。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-24T12:20:54.417

您只需为 List 元素设置 ModeratedList="TRUE"，为 ListTemplate 元素设置 EnableModerate="True"。我刚刚检查了一下，对我来说工作正常。但这只会影响新的列表实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-24T12:17:12.780

我有类似的问题 - 从代码中启用版本控制和审核的位置。

在`ListInstance`中，转到`<ListTemplate>`并设置以下属性： `VersioningEnabled="TRUE"`版本控制和`EnableModeration="True"`自动审核。

链接：http: [//msdn.microsoft.com/en-us/library/ms462947.aspx](http://msdn.microsoft.com/en-us/library/ms462947.aspx)

# c# - 在 C# 中确定声音何时完成播放

> ID：422543
> 
> 赞同：2
> 
> 时间：2009-01-07T23:01:10.200
> 
> 标签：c#, .net, audio

情况如下：
用户查找内容。

*   播放提示音，因为他查找的项目上有通知
*   用户关闭通知 - 应用程序继续检索信息
*   用户收到一个“叮”，告诉他们信息已完成检索
*   应用程序开始向 TextToSpeech 发送某些属性
*   应用程序遇到第二个通知，对数据进行内部通知并发送另一个警报（texttospeech 暂停，然后在警报完成后恢复）
*   文字转语音完成，播放另一个“叮”，让用户知道已阅读所有内容

我们目前使用队列以有序的方式处理声音，以防止声音重叠。我们目前仅在调用 SoundAdded 事件时播放队列中的声音。这是我们在向队列中添加声音时触发的自定义事件。目前，每次调用事件只会播放一种声音。我们遇到了一个问题，在播放某些声音后，它们会“锁定”队列，阻止进一步的声音被处理。即使没有播放声音，我们也总是通过“解锁”队列来解决这个问题。然而，这仍然给我们留下了队列得到播放声音的问题。

我能想到的解决此问题的唯一方法是添加一个循环以在仍有声音等待播放时继续尝试播放声音。目前，主线程正在处理声音，我可能需要将声音处理移至单独的线程，但我不确定处理声音的最佳方法是什么。

所以...我的问题...是否有一个很好的声音库可供我们使用，其中包括声音结束的事件。或者......创造这样一个东西的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T02:59:23.370

我不知道是否已经有一个 .NET 库可以让你这样做，但我认为你可以很容易地从 Windows API 中 P/Invoke [PlaySound](http://msdn.microsoft.com/en-us/library/ms712879.aspx)并使用它来播放你的声音。只要您不指定 SND_ASYNC 标志，它就应该阻塞，直到声音播放完毕，此时您可以播放下一个声音。正如您所提到的，您肯定希望在不同的线程中执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T05:04:34.007

扩展 Jon 的答案：在 .NET 2.0 及更高版本中，您可以将[My.Computer.Audio.Play](http://msdn.microsoft.com/en-us/library/cf1shcah.aspx)与[AudioPlayMode.WaitToComplete](http://msdn.microsoft.com/en-us/library/17c3wc6k.aspx)选项一起使用。

编辑：要在 C# 上下文中使用它，请参阅Microsoft[的 How to: Use the My Namespace (C# Programming Guide)](http://msdn.microsoft.com/en-us/library/ms173136.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T07:49:28.433

如果您同步播放声音（在您管理的新线程上），您将知道它们何时完成。

但是您似乎有两个问题；一个是知道声音何时结束，另一个是队列的建立。如果您有可以自定义的声音，如果您的用户选择非常长的录音（例如 10 秒以上）作为声音，您的应用程序将受到什么影响？

我建议您应该采用与在处理期间在 UI 上显示文件名相同的方法。也就是说，您显示的是最新的文件名，而不是每个文件名（否则文件名队列会增长并且您的 UI 会滞后）。如果可以，您应该在事件发生时播放声音（允许重叠声音），或者如果声音不是队列中最新的声音，则应该丢弃（不播放）声音。

# asp.net - 如何在 ASP.NET 应用程序中创建类的实例

> ID：422553
> 
> 赞同：5
> 
> 时间：2009-01-07T23:05:33.683
> 
> 标签：asp.net, reflection

当在 ASP.NET v2 应用程序中将类名作为字符串给出时，如何创建对象的实例？例如，我在应用程序的 app_code 部分定义了一个名为 SystemLog 的类。该类在 Reports 命名空间中定义。要创建对象的实例，我执行以下操作：

将 MyObject 调暗为新的 Global.Reports.SystemLog

但是，我想使用一个字符串来创建这个对象来定义类型。类型名称作为字符串存储在 SQL 数据库中。我认为这可能与 Activator.CreateInstance(AssemblyName, TypeName) 有关，但我不知道在这些字符串中传递什么。ASP.NET Web 应用程序的程序集名称是什么？

帮助！

谢谢，罗伯。

PS。我不想要硬编码的 Select 语句:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T23:11:42.440

```
string typeName = "Your Type Name Here";
Type t = Type.GetType(typeName);
object o = Activator.CreateInstance(t); 
```

这会给你一个实例化的类型。如果将由您决定将其转换为正确的类型并调用您的适当方法。

如果您需要创建一个没有无参数构造函数的类型，则 CreateInstance 上有一个重载，它将对象的参数传递给构造函数。[此MSDN 文章](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)中的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-14T15:36:02.177

以下能够创建类型，即使它来自另一个程序集：

```
public object CreateInstance(string typeName) {
   var type = AppDomain.CurrentDomain.GetAssemblies()
              .SelectMany(a => a.GetTypes())
              .FirstOrDefault(t => t.FullName == typeName);

   return type.CreateInstance();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T23:39:54.380

您可以使用它从特定程序集中获取它：

程序集程序集 = Assembly.Load("myAssembly");

Type ObjectType = assembly.GetType("此处输入名称");

然后.....object o = Activator.CreateInstance(ObjectType);

# asp.net - ASP.NET 在 Firefox 中破坏了验证客户端代码的呈现

> ID：422554
> 
> 赞同：1
> 
> 时间：2009-01-07T23:05:46.163
> 
> 标签：asp.net, javascript, iis, validation

这对我来说是一个障碍。尽管是一个相当晦涩的问题，但它很容易复制。它是在我在网页上做一些 javascript 工作时出现的，同时还利用了 ASP.NET 提供的验证控件。

前面的一些细节：使用基于 Vista 的开发机器和 3.5 框架和 IIS 7。我还有一台运行 windows server 2003 的 QA 机器，也使用 3.5 框架但运行 IIS 6。

使用一个简单的文本框、验证控件和按钮获取一个页面以提交它们。例如：

```
<asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>  
<asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" ErrorMessage="Text is Required" ControlToValidate="TextBox1"></asp:RequiredFieldValidator>  
<asp:Button ID="btnSubmit" runat="server" Text="Submit" /> 
```

这里有简单的 ASP.NET 验证控制代码...这里的想法是为必填字段生成客户端验证代码，除非文本框有字段，否则不会进行回发。如果浏览器不支持客户端脚本，那么 ASP.NET 将使用 Page.IsValid 属性在服务器端捕获它。

当我从基于 Vista 的开发机器上运行它时，会为 IE 和 Firefox 生成客户端脚本代码，并且**运行**良好。

当我从基于 win2003 的 QA 机器运行时，还会为两种浏览器生成验证器控件的客户端代码。IE 的验证代码工作正常……但**不适**用于 Firefox。当按下提交按钮（带有一个空文本框）时，客户端代码似乎被忽略并执行回发。现在验证错误在服务器端被捕获 - 但我想*知道为什么它首先不能在客户端工作。*

这里有趣的怪癖是，如果我在 Firefox 下从开发机器（可以工作的机器）和 QA 机器（不工作的机器）获取页面源视图并比较它们 - 客户端验证代码会大不相同。

关于如何更改以使客户端验证代码在 Firefox 中与 QA 机器一起工作的想法？

更新：有一些评论要求查看生成的源代码。我已将 Dev 和 QA 源代码保存为 .htm 文件并将它们压缩。您可以在[http://www.optsolutions.com/testvalidation.zip获得它们](http://www.optsolutions.com/testvalidation.zip)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T12:40:57.190

检查您的 web.config 的 xhtmlconformance 并确保它没有设置为 legacy。

[http://aspadvice.com/blogs/rbirkby/archive/2006/11/01/Client_2D00_side-validation-in-Firefox.aspx](http://aspadvice.com/blogs/rbirkby/archive/2006/11/01/Client_2D00_side-validation-in-Firefox.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T01:52:07.530

我在类似的设置中遇到了同样的问题。到目前为止，browserCaps 设置的差异是我遇到的最有希望的可能性。

[http://msdn.microsoft.com/en-us/library/sk9az15a(VS.80).aspx](http://msdn.microsoft.com/en-us/library/sk9az15a(VS.80).aspx)

# python - 在 PIL 中使用 Webdings 绘图

> ID：422555
> 
> 赞同：3
> 
> 时间：2009-01-07T23:05:58.503
> 
> 标签：python, fonts, python-imaging-library

我有一个使用 PIL 呈现文本的 Python 程序，它适用于各种字体。但它只绘制带有翼或网的“缺失字形”矩形。

这是一个尝试绘制每个 unicode 字符的示例：

```
# Run this with .ttf file path as an argument, and also an encoding if you like.
# It will make 16 PNGs with all the characters drawn.
import sys
import Image, ImageDraw, ImageFont

size = 20
per = 64

chars = 0x10000
perpage = per*per

fontfile = sys.argv[1]
encoding = sys.argv[2] if len(sys.argv) > 2 else ''

font = ImageFont.truetype(sys.argv[1], size, encoding=encoding)

for page in range(0, chars//perpage):

    im = Image.new("RGB", (size*per+30, size*per+30), '#ffffc0')
    draw = ImageDraw.Draw(im)

    for line in range(0, per):
        for col in range(0, per):
            c = page*perpage + line*per + col
            draw.text((col*size, line*size), unichr(c), font=font, fill='black')

    im.save('allchars_%03d.png' % page) 
```

使用 Arial.ttf（或者更好的是 ArialUni.ttf），我得到了 16 个有趣的 PNG。搜索 PIL 的问题时，一些符号字体需要指定其编码。如果我使用 Symbol.ttf，我会得到所有丢失的字形，直到我指定“symb”作为编码。

我如何让机翼工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T23:33:28.900

我之前一定做错了什么。“symb”作为编码也适用于wingdings！对不起，噪音...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T23:41:44.953

并非所有的wingdings都映射到unicode：见[http://www.alanwood.net/demos/wingdings.html](http://www.alanwood.net/demos/wingdings.html)

此外，您仅涵盖[基本多语言平面](http://www.j-a-b.net/web/char/char-unicode-bmp?characterRange=9984X10175)（[维基百科](http://en.wikipedia.org/wiki/Mapping_of_Unicode_characters)）

# .net - wmi .net 设置串口？

> ID：422576
> 
> 赞同：3
> 
> 时间：2009-01-07T23:12:43.717
> 
> 标签：.net, wmi, serial-port

我有一个 USB 串行适配器，可以在许多系统上以 COM9 或更高版本即插即用。我在我的软件中使用的第三方包最多只能连接到 COM8。有没有办法使用 WMI 或其他方法将 COM9 设置为较低的端口？我知道我可以在设备管理器的端口设置对话框中执行此操作，但如果我可以在软件中为他们静默执行此操作，对我的最终用户来说会更容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-09T15:34:45.363

我使用[这个例子](http://www.codeproject.com/KB/vb/toggleNetworkConn.aspx?display=Print)来打开和关闭网络适配器。我不是 100% 肯定的，因为我还没有这样做，但是您可以使用相同的方法以编程方式导航控制面板并为它们执行“端口对话框”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T03:46:19.873

这可能会有所帮助，不确定这是否适合您

[http://com0com.sourceforge.net/](http://com0com.sourceforge.net/)

我想你可以得到源代码，这样你就可以看到如何自己做。

# sql-server - SQL Server：如果您要寻求专门的解决方案，需要学习什么

> ID：422585
> 
> 赞同：0
> 
> 时间：2009-01-07T23:16:11.183
> 
> 标签：sql-server

今天我们使用的是共享的 SQL Server 数据库，这非常完美，因为我对 SQL Server 维护一无所知。但出于经济原因，我们需要升级到专用服务器。

鉴于我没有时间阅读整个文档，我绝对需要了解有关 SQL Server 的哪些信息才能不搞砸？

资源建议赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T23:28:09.443

[备份！](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-1043671.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T00:01:49.063

答案可能与您的应用程序的数据密集程度有关。如果它像大多数业务应用程序一样，您可能可以阅读一些快速入门指南并进行学习（只要您定期备份......这很重要，因此请仔细阅读）。SQL Server 通常是非常自我调整的，如果您不是在谈论数百万行和高 TPS，那么您可能暂时还可以。

如果它*是*一个数据密集型应用程序，或者具有高可用性或吞吐量需求......即使只是在合同上，也可以找一个 DBA。不要把所有的鸡蛋都放在一个你不能携带的篮子里。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T01:51:19.513

哦，是偶然的DBA！

Brent Ozar 有一些有用的文章：[http ://www.brentozar.com/sql/](http://www.brentozar.com/sql/)

不要忘记 SQLServerPedia - [http://sqlserverpedia.com/wiki/Main_Page](http://sqlserverpedia.com/wiki/Main_Page)

干杯!

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T17:48:10.640

在备份方面，不要忘记备份事务日志和数据库，除非您希望事务日志增长直到它接管整个驱动器。

我还阅读了有关索引、统计和重建的内容。

此外，您可能应该对数据库安全性的工作原理有一个很好的了解。

如果可能的话，获得一个开发服务器和一个产品服务器。在 dev 上测试更改比直接在生产中测试要好得多！然后将 prod 访问权限限制为仅几个人，并通过测试脚本对生产进行所有更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T00:31:21.157

按重要性排序：

1.  如何安排备份
2.  如何创建索引
3.  如何重建索引

Profiler and Tuning 向导可以帮助您完成 2 和 3。

如果您正在对数据库进行编程而不仅仅是管理它，我会推荐[Robert Vieira 的书](https://rads.stackoverflow.com/amzn/click/com/0764584332)。这是一个很棒的介绍。

# c# - 在 C# 代码中从与 Table1 的关系中获取 Table2 数据

> ID：422586
> 
> 赞同：2
> 
> 时间：2009-01-07T23:16:15.783
> 
> 标签：c#, dataset, relation

我在 DataSet 中有两个表，每个表的 ID 字段都相同。我有两个表之间的关系。如何在 C# 代码中从 Table2 中提取与 Table1 上的信息相关的信息？

我尝试使用新的 DataRow 并使用 GetChildRow 对其进行分配，但由于某种原因，我似乎无法使其工作。

另外，我知道这个问题可能没有那么丰富，请告诉我，我会尽力提供更多说明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T23:27:49.100

如果您的 DataSet 是强类型的（即从 .xsd 文件生成），答案就不同了（而且容易得多）。我假设下面不是这种情况，但如果是说出来的话。

对于一般的 DataSet 对象，答案很大程度上取决于您开始掌握的内容。如果您只有一个 ID，那么在相关 DataTable 上的选择中使用该 ID 可能是最简单的。这适用于任何一个（或两个）表，因为它将返回包含您正在查找的信息的 DataRows 数组。

如果您有一个父 DataRow（您似乎有），那么使用的最佳方法取决于关系——即哪个是父级。如果 Table1 是您的父级并且您想要导航到相关的 Table2 子行，那么您正在寻找 GetChildRow （最好尽可能具体地告诉它要遵循哪个关系）。如果 Table2 是父级，并且您要从 Table1 DataRow 导航到 Table2 中的父级，您将需要使用 GetParentRow（同样，尽可能具体地识别关系 - 如果您方便，请使用关系对象）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T23:52:52.840

在强类型 DataSet 中，每个 DataRow 对象对于每个关系都有特定的方法或属性。如果您有一个父DataRow 并且想要导航到Table2 中的子项，它将是一个复数方法（即“row.GetTable2Rows()”）。如果您有一个孩子并且想要导航到父母，它将是一个单一的属性（“row.Table2Row”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T16:21:01.333

所以这就是我所做的。让我知道如果或有更快的东西，这是否是最好的。我创建了一个与表 2 完全相同的新表，并编写了以下代码：

```
currentDataSet.GroupTableOneRow.Clear();
currentDataSet.GroupAttendingEventTable[groupAttendingEventCounter].GetGroupTableRows().CopyToDataTable(currentDataSet.GroupTableOneRow, LoadOption.OverwriteChanges); 
```

然后我可以调用记录为零的一张表并获得我需要的名称。它有效，但有没有更有效的方法？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T22:17:35.887

对此回复的评论不够长，所以我将做出另一个答案：

无需使用新表。只需使用一组行对象并从那里开始。假设您的 DataSet 命名空间是“EventData”，我将把它分解一下，这样它就不会全部在一行上。

```
// The parent row
EventData.GroupAttendingEventRow groupAttendingEvent = currentDataSet.GroupAttendingEventTable[groupAttendingEventCounter];
// an array of children rows
EventData.GroupTableRow[] eventGroup = groupAttendingEvent.GetGroupTableRows(); 
```

然后，您可以根据需要对“eventGroup”数组进行操作，包括使用 eventGroup[0] 获取第一个元素。

# delphi - 如何通过代理使用 ADO 访问 SQL Server？

> ID：422588
> 
> 赞同：2
> 
> 时间：2009-01-07T23:17:09.947
> 
> 标签：delphi, proxy, ado

我有一个 Delphi 应用程序，它使用 ADO 连接到托管在 Internet 上的 SQL 服务器。运行此应用程序的用户希望通过内部代理访问 SQL 服务器。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-09-16T23:03:27.027

在实际应用中没有什么特别需要做的，这是一个网络问题，你必须在防火墙上打开一些端口（默认为1433）才能通信通过（出去）

# c++ - C/C++ 中的衍生物？

> ID：422594
> 
> 赞同：21
> 
> 时间：2009-01-07T23:18:54.127
> 
> 标签：c++, c, math, numerical, symbolic-math

我有一些表达式，例如`x^2+y^2`我想用于一些数学计算的表达式。我想做的一件事是取表达式的偏导数。

因此，如果`f(x,y) = x^2 + y^2`then 的部分`f`相对于`x`将是`2x`，则相对于的部分`y`将是`2y`。

我使用有限差分法编写了一个极小的函数，但我遇到了很多浮点精度问题。例如，我最终得到`1.99234`而不是`2`. 有没有支持符号微分的库？还有其他建议吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-07T23:57:05.530

我已经用几种不同的语言实现了这样的库，但不幸的是不是 C。如果你只处理多项式（和、乘积、变量、常数和幂），这很容易。三角函数也不错。任何更复杂的事情，你可能最好花时间掌握别人的图书馆。

如果您决定自己动手，我有一些建议可以简化您的生活：

*   使用不可变数据结构（纯函数数据结构）来表示表达式。

*   使用[Hans Boehm 的垃圾收集器](http://www.hpl.hp.com/personal/Hans_Boehm/gc/)为您管理内存。

*   为了表示线性和，使用有限映射（例如，二叉搜索树）将每个变量映射到其系数。

如果您愿意将[Lua](http://www.lua.org/)嵌入到您的 C 代码中并在那里进行计算，我已将 Lua 代码放在[http://www.cs.tufts.edu/~nr/drop/lua](http://www.cs.tufts.edu/~nr/drop/lua)上。一个更好的特性是它可以接受一个符号表达式，区分它，并将结果编译到 Lua 中。您当然不会找到任何文档:-(

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-12T12:42:00.200

如果您正在进行数值微分（“评估*f(x)*在*x* = *x0*处的导数”）并且您事先知道自己是方程式（即，不是用户输入），那么我建议您使用[FADBAD++](http://www.fadbad.com/fadbad.html)。[它是一个 C++ 模板库，用于使用自动微分](http://en.wikipedia.org/wiki/Automatic_differentiation)求解数值导数。它非常快速，准确。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-07T23:45:03.620

获得“正确”的数值微分（在最小化错误的意义上）可能非常棘手。要开始使用，您可能需要查看有关[数值导数](http://www.nrbook.com/a/bookcpdf/c5-7.pdf)的 Numerical Recipies 部分。

对于免费的符号数学包，您应该查看[GiNaC](http://www.ginac.de/)。您还可以查看[SymPy](http://code.google.com/p/sympy/)，这是一个自包含的纯 Python 符号数学包。您会发现 SymPy 更易于探索，因为您可以从 Python 命令行交互地使用它。

在商业端，Mathematica 和 Maple 都有 C API。您需要安装/许可版本的程序才能使用这些库，但两者都可以轻松完成您所追求的符号区分类型。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-12T21:51:35.523

您可以通过两种简单的方式提高数值微分的准确性

1.  使用较小的增量。您似乎使用了 around 的值`1e-2`。从 开始`1e-8`，并测试是否有任何较小的伤害或帮助。显然你不能太接近机器精度——大约`1e-16`是两倍。

2.  使用中心差异而不是前向（或后向）差异。即`df_dx =(f(x+delta) - f(x-delta)) / (2.0*delta)` 由于取消较高截断项的原因，中心差异估计中的误差是阶数`delta^2`而不是前向差异的增量。见[http://en.wikipedia.org/wiki/Finite_difference](http://en.wikipedia.org/wiki/Finite_difference)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T03:19:01.003

如果这确实是您想要使用的那种函数，那么编写一个类库就很容易了。从一个 Term 开始，带有一个系数和一个指数。有一个由一组项组成的多项式。

如果您为感兴趣的数学方法定义了一个接口（例如，add/sub/mul/div/differentiate/integrate），那么您正在查看一个 GoF 复合模式。项和多项式都将实现该接口。多项式将简单地迭代其集合中的每个项。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T04:52:50.427

利用现有的包肯定比编写自己的包更容易，但如果你决心编写自己的包，并且准备花一些时间了解 C++ 的一些黑暗角落，你可以使用[Boost.Proto](http://boost-sandbox.sourceforge.net/libs/proto/doc/html/index.html)从[Boost](http://www.boost.org/)到设计您自己的库。

基本上，Boost.Proto 允许您将任何有效的 C++ 表达式转换为`x * x + y * y`表达式[模板](http://www.google.co.nz/search?q=expression+template)（基本上是使用嵌套`struct`s 表示该表达式的解析树），然后稍后对该解析树执行任何任意计算时间通过调用`proto::eval()`它。默认情况下，`proto::eval()`用于评估树，就好像它已经直接运行一样，尽管没有理由不能修改每个函数或运算符的行为以取而代之的是符号导数。

尽管这对于您的问题来说是一个*极其*复杂的解决方案，但它仍然比尝试使用 C++ 模板元编程技术滚动您自己的表达式模板要容易得多。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-12-02T08:30:12.527

很抱歉在 6 年后提出这个问题。但是，我一直在为我的项目寻找这样的库，并且我看到 @eduffy 建议[FADBAD++](http://www.fadbad.com/fadbad.html)。我已阅读文档并回到您的问题。我觉得我的回答会有所帮助，因此，以下代码适用于您的情况。

```
#include <iostream>
#include "fadiff.h"

using namespace fadbad;

F<double> func(const F<double>& x, const F<double>& y)
{
    return x*x + y*y;
}

int main()
{
    F<double> x,y,f;     // Declare variables x,y,f
    x=1;                 // Initialize variable x
    x.diff(0,2);         // Differentiate with respect to x (index 0 of 2)
    y=1;                 // Initialize variable y
    y.diff(1,2);         // Differentiate with respect to y (index 1 of 2)
    f=func(x,y);         // Evaluate function and derivatives

    double fval=f.x();   // Value of function
    double dfdx=f.d(0);  // Value of df/dx (index 0 of 2)
    double dfdy=f.d(1);  // Value of df/dy (index 1 of 2)

    std::cout << "    f(x,y) = " << fval << std::endl;
    std::cout << "df/dx(x,y) = " << dfdx << std::endl;
    std::cout << "df/dy(x,y) = " << dfdy << std::endl;

    return 0;
} 
```

输出是

```
 f(x,y) = 2
df/dx(x,y) = 2
df/dy(x,y) = 2 
```

另一个例子，假设我们对 的一阶导数感兴趣`sin()`。分析，是`cos`。这很好，因为我们需要比较给定函数的真实导数及其数值对应物来计算真实误差。

```
#include <iostream>
#include "fadiff.h"

using namespace fadbad;

F<double> func(const F<double>& x)
{
    return sin(x);
}

int main()
{
    F<double> f,x;
    double dfdx;
    x = 0.0;
    x.diff(0,1);
    f = func(x);
    dfdx=f.d(0);

    for (int i(0); i < 8; ++i ){
        std::cout << "       x: " << x.val()        << "\n"
                  << "    f(x): " << f.x()          << "\n" 
                  << " fadDfdx: " << dfdx           << "\n"
                  << "trueDfdx: " << cos(x.val())   << std::endl;
        std::cout << "=========================="   << std::endl;

        x += 0.1;
        f = func(x);
        dfdx=f.d(0);
    }

    return 0;
} 
```

结果是

```
 x: 0
    f(x): 0
 fadDfdx: 1
trueDfdx: 1
==========================
       x: 0.1
    f(x): 0.0998334
 fadDfdx: 0.995004
trueDfdx: 0.995004
==========================
       x: 0.2
    f(x): 0.198669
 fadDfdx: 0.980067
trueDfdx: 0.980067
==========================
       x: 0.3
    f(x): 0.29552
 fadDfdx: 0.955336
trueDfdx: 0.955336
==========================
       x: 0.4
    f(x): 0.389418
 fadDfdx: 0.921061
trueDfdx: 0.921061
==========================
       x: 0.5
    f(x): 0.479426
 fadDfdx: 0.877583
trueDfdx: 0.877583
==========================
       x: 0.6
    f(x): 0.564642
 fadDfdx: 0.825336
trueDfdx: 0.825336
==========================
       x: 0.7
    f(x): 0.644218
 fadDfdx: 0.764842
trueDfdx: 0.764842
========================== 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T23:46:11.247

这是一种旁白，因为它适用于 Lisp 而不是 C/C++，但它可以帮助其他人寻找类似的任务，或者您可能会获得一些想法，以自己在 C/C++ 中实现类似的东西。SICP 有一些关于 lisp 主题的讲座：

1.  衍生规则[3b](http://video.google.com/videoplay?docid=5571878527594356342)
2.  代数规则[4a](http://video.google.com/videoplay?docid=6196234900528730258)

在 Lisp 中，它非常简单（在其他具有强大模式匹配和多态类型的函数式语言中）。在 C 中，您可能不得不大量使用枚举和结构来获得相同的功能（更不用说分配/解除分配）。一个小时内就可以明确地在 ocaml 中编写你需要的代码——我想说打字速度是限制因素。如果你需要 C，你实际上可以从 C 调用 ocaml（反之亦然）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-03-06T03:06:36.820

看看 Theano，它支持符号微分（在神经网络的上下文中）。该项目是开源的，所以你应该能够看到他们是如何做到的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-06-01T16:15:53.257

只计算一阶导数是很容易实现的。但它是一门艺术，使其快速。你需要一个类，其中包含

*   价值
*   一组导数值与自变量

然后，您将编写用于加法和减法等的运算符以及诸如 sin() 之类的函数，它们实现了此操作的基本和众所周知的规则。

要计算高阶导数，应使用截断的泰勒级数。您也可以将上述类应用于自身——值和派生值的类型应该是模板参数。但这意味着不止一次地计算和存储衍生品。

截断的 taylor 系列——有两个库可用于此：

[http://code.google.com/p/libtaylor/](http://code.google.com/p/libtaylor/)

[http://www.foelsche.com/ctaylor](http://www.foelsche.com/ctaylor)

# vim - 在 (g)Vim 中隐藏（或折叠）文本列（水平）

> ID：422597
> 
> 赞同：5
> 
> 时间：2009-01-07T23:21:00.907
> 
> 标签：vim, hide, folding, temporary

有没有办法在 Vim 中编辑缓冲区时隐藏缓冲区的列（文本文件，你知道我的意思）吗？例如，在隐藏第 2 列和第 3 列之前缓冲区中可见的文本：

```
abbcccccc
accdddddd 
```

在隐藏它们之后：

```
acccccc
adddddd 
```

（更不用说我正在处理非常大的文件（有时超过 200 GB）。）

是的，我找到了 foldcol.vim，但它需要一个补丁，而且我没有 gcc 来作为服务器上的用户编译它。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-10T00:43:40.967

无法在股票 vim 中完成；有一个隐藏补丁未被接受。最新版本仅适用于 vim7，而不适用于 7.2（更不用说 7.2+补丁），因此最好认为它已死。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T23:26:06.217

foldcol.vim[可能](http://www.vim.org/scripts/script.php?script_id=1161)是您需要的吗？不知道它是否适用于您的大文件。200GB！以一种令人讨厌的方式令人印象深刻。=)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-12-29T09:34:34.790

到目前为止我见过的最好的版本如下：

[https://github.com/paulhybryant/foldcol](https://github.com/paulhybryant/foldcol)

这个 github 项目基于 [http://vim.sourceforge.net/scripts/script.php?script_id=1161](http://vim.sourceforge.net/scripts/script.php?script_id=1161)

但是它有一些改进 - 它实际上将隐藏列显示为“*”

它需要 vim-maktaba 插件，所以为了在你的 vim 中安装它，然后执行以下操作：

添加到您的 ~/.vimrc 文件中：

```
" set the runtime path to include Vundle and initialize                                                    
set rtp+=~/.vim/bundle/Vundle.vim                                                                          
call vundle#begin()                                                                                        

" let Vundle manage Vundle, required                                                                       
Plugin 'VundleVim/Vundle.vim'                                                                              

" Install vim-maktaba plugin for plugin developers - used in foldcol                                       
Plugin 'google/vim-maktaba'                                                                                
" Install foldcol - folding columns using <ctrl-v> visual mark, then :VFoldCol                           
Plugin 'paulhybryant/foldcol'                                                                              

" All of your Plugins must be added before the following line                                              
call vundle#end()            " required 
```

注意 vundle.begin -> vundle.end 部分中添加的两个插件；vim-maktaba 和 foldcol

将此添加到您的 ~/.vimrc 文件后，然后以管理员身份启动 vim，或者如果您在 ubuntu 上运行，则编写 sudo vim

然后写 :PluginInstall ，如果需要，然后写下你的 GitHub 帐户的用户名和密码 - 这将使你可以从 github 下载和安装 vim 插件

终端 vim 中的示例用法已启动；使用`<ctrl-v>`并标记列： [![折叠前](https://i.stack.imgur.com/UwE5g.png)](https://i.stack.imgur.com/UwE5g.png) [![折叠后](https://i.stack.imgur.com/ml5Sf.png)](https://i.stack.imgur.com/ml5Sf.png) [![折叠清晰后](https://i.stack.imgur.com/m2q4i.png)](https://i.stack.imgur.com/m2q4i.png)

它可能看起来很麻烦，但实际上只是在 ~/.vimrc 文件中添加两行并运行 :PluginInstall

请享用

# c++ - 规范运算符重载？

> ID：422600
> 
> 赞同：7
> 
> 时间：2009-01-07T23:21:21.780
> 
> 标签：c++, operator-overloading

是否有规范或推荐的模式用于在 C++ 类数字类中实现算术运算符重载？

在 C++ FAQ 中，我们有一个异常安全的赋值运算符，可以避免大多数问题：

```
class NumberImpl;

class Number {
   NumberImpl *Impl;

   ...
};

Number& Number::operator=(const Number &rhs)
{
   NumberImpl* tmp = new NumberImpl(*rhs.Impl);
   delete Impl;
   Impl = tmp;
   return *this;
} 
```

但是对于其他运算符（+、+= 等），除了让它们表现得像内置类型上的运算符外，几乎没有给出什么建议。

有定义这些的标准方法吗？这就是我想出的 - 有没有我没有看到的陷阱？

```
// Member operator
Number& Number::operator+= (const Number &rhs)
{
    Impl->Value += rhs.Impl->Value; // Obviously this is more complicated
    return *this;
}

// Non-member non-friend addition operator
Number operator+(Number lhs, const Number &rhs)
{
     return lhs += rhs;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T23:51:53.217

在 Bjarne Stroustrup 的书“ [C++ 编程语言](https://rads.stackoverflow.com/amzn/click/com/0201700735)”的第 11 章（专门讨论运算符重载的那一章）中，他经历了一个复数类型的类（第 11.3 节）。

我从该部分注意到的一件事是他实现了混合类型操作......这可能是任何数字类的预期。

一般来说，你所拥有的看起来不错。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T01:06:29.667

编写任何运算符时要考虑的一件大事是成员运算符不会对左侧参数进行转换：

```
struct example {
  example(int);
  example operator + (example);
};

void foo() {
  example e(3), f(6);
  e + 4; // okay: right operand is implicitly converted to example
  e + f; // okay: no conversions needed.
  6 + e; // BAD: no matching call.
} 
```

这是因为转换从不适`this`用于成员函数，而这延伸到运算符。如果运算符`example operator + (example, example)`位于全局命名空间中，它将编译（或者如果使用 pass-by-const-ref）。

因此，对称运算符喜欢`+`和`-`通常实现为非成员，而复合赋值运算符喜欢`+=`和`-=`实现为成员（它们也会更改数据，这意味着它们应该是成员）。而且，由于您想避免代码重复，因此可以根据复合赋值运算符来实现对称运算符（如您的代码示例中所示，尽管约定建议在函数内部使用临时运算符）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T23:52:32.700

惯例是用and来写`operator+(const T&)`and 。如果对原始类型进行添加和减去是有意义的，那么您应该编写一个构造函数，从原始类型构造对象。然后重载的运算符也适用于原始类型，因为编译器会隐式调用适当的构造函数。`operator-(const T&)``operator+=(const T&)``operator-=(const T&)`

正如您自己提到的，您应该避免为不需要的功能授予访问权限。但是在您上面的代码中，`operator+(Number, const Number&)`我个人将两个参数都设为 const 引用并使用 temp。我认为您问题下方的评论者错过了这一点并不奇怪；除非您有充分的理由不这样做，否则请避免意外和诡计，并尽可能明显。

如果您希望您的代码与其他数字类型集成，例如`std::complex`，请注意循环转换。也就是说，`operator OtherNumeric()`如果`Numeric`提供`OtherNumeric`了一个带`Numeric`参数的构造函数，则不要提供。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-08T00:28:59.367

将运算符 X 写成运算符 =X
是传统的做法 标准运算符的所有参数都是 const 也是传统的

```
// Member operator
// This was OK
Number& Number::operator+= (Number const& rhs) 
{
    Impl->Value += rhs.Impl->Value; // Obviously this is more complicated
    return *this;
}

// Non-member non-friend addition operator
Number operator+(Number const& lhs,Number const& rhs)
{
     // This I would set the lhs side to const.
     // Make a copy into result.
     // Then use += add the rhs
     Number result(lhs);
     return result += rhs;
} 
```

你提到了赋值运算符。
但是您没有提到复制构造函数。由于您的班级拥有 RAW 指针的所有权，我希望您也可以定义它。赋值运算符传统上是根据复制构造函数编写的。

# cocoa-touch - 如何在 iPhone 文本字段中设置字体大小？

> ID：422608
> 
> 赞同：1
> 
> 时间：2009-01-07T23:25:04.987
> 
> 标签：cocoa-touch

我在视图中有一个 UITextField（在 iPhone 上），但输入文本看起来非常小。我在 Interface Builder 中看不到设置大小的选项。

有没有办法以声明方式设置它还是我必须求助于代码？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-07T23:44:35.883

您也可以在代码中执行此操作：

```
 myUITextField.font = [UIFont systemFontOfSize:12.0f]; 
```

干杯。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T23:29:56.023

按 Cmd-T 进入字体面板。

# pointers - What are the practical advantages of learning Assembly?

> ID：422613
> 
> 赞同：7
> 
> 时间：2009-01-07T23:28:07.447
> 
> 标签：pointers, assembly

Most people suggest that learning assembly is essential, its important to know the underlying workings of the computer, and so forth. But what I'm looking for are some practical suggestions that will make the effort of learning Assembly to be worth it.

What are your suggestions? What am I missing out on by not learning Assembly and pointers/memory management in general?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T23:57:56.590

I think the main practical advantage to learning low-level things like assembly language, pointers, and memory management is that when you're writing or reviewing high-level code you're better able to instinctively or subconsciously spot performance issues or other pitfalls.

An average developer, might write a simple loop and think, "This code iterates over a set of integers and writes each to the console."

An expert developer might write the same loop and think, "This code iterates over a set of integers, and has to box each element to call the ToString method and ToString has to format the string in base 10 which is somewhat non-trivial, and then both the boxed integer and the formatted string will soon be eligible for garbage collection as no references will remain, and the first time this method runs, it will need to be JIT'ed..." and so on.

9 times out of 10, it may not matter. But that 1 time out of 10, the expert developer is likely to notice a problem in code that the average developer would never think to consider.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T23:40:38.653

You need to learn to read assembly so you can figure out what goes wrong when a complex statement bombs out. The CPU debug window shouldn't be a mysterious place.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T23:32:34.660

Pointers/memory management are more general than assembly language. You need to understand them for C and C++ as well, which you might need if you have to maintain code written in C.

For assembly language, it is sometimes useful to read the assembler code that the C compiler generates, to find out whether it generates correct and efficient code.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T23:35:31.253

I think it's great to learn new languages. It opens my mind. Some languages are more mind-opening than others. I'd say assembler is one of those. It forces you to think about stuff like the call stack and instruction pointer. And it'll make you appreciate higher level languages even more. Another fun language to learn is PostScript.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T23:40:09.170

I don't think you *need* to learn assembly for anything *practical.* However, it will ensure that you understand the real roots of what you are doing as a developer. In essence, assembly programming is a discipline for learning chip logic and architecture. I haven't programmed assembly in over two decades but it still informs the kinds of choices I make when programming C#.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-07T23:34:19.990

This is sort of one of those questions that will always be asked: "Why should I know anything." etc. Well, perhaps you could get a job doing something besides building the next generic CRUD application or something like that. If you want to do any sort of system development, having a working knowledge of assembly is very helpful, if not vital. As far as what you're "missing out" perhaps you are missing out on actually knowing how computers work. Some people think this is desirable. Some people don't. Some people build processors. Some people dig ditches. It's all a matter of personal preference :)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T23:37:54.697

> But what I'm looking for are some practical suggestions that will make the effort of learning Assembly to be worth it.

Learn what assembly is. Really learn how to read (and understand) small fragments of it: how to walk/step through it in your mind. Perhaps too, step through some of it with a debugger (including seeing memory and registers being changed). Ideally, find some annotated assembly.

But, don't bother to learn how to write assembly: instead, learning to write C or C++ is probably 'low' enough for most practical purposes.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-08T00:11:22.693

Pointers and memory management are really a different question than assembly. If you want to do C/C++, then you need to learn pointers and memory management, because those are part of the language. But, even if you plan to use nothing but (say) Java all your life, you should learn something about memory management to keep from writing a memory leak despite the GC, and pointers are just the difference between atomic types and object references. You need the concepts or you'll write programs that don't work!

Practical reasons for learning assembly: debugging and optimization. Even if you don't write any assembly, one of these days you may need to optimize C/C++ code for performance. In that case, you'll need to be able to *read* the assembly for your inner loop, even if you never need to write another line of it.

Ultimately, I think your distinction between "knowing the underlying workings of your computer" and "practical suggestions that will make the effort of learning assembly worth it" is a false one. Ignorance does not pay. Learning how your computer works *is* a practical suggestion worth the effort!

I have a prophecy: someday soon, your program will run far too slowly to be practical, and crash intermittently with an out-of-memory exception. On that day, the sheer screaming anxiety of not knowing what the hell is going on or where to start looking in order to fix it will refund your karma debt, with interest...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T23:31:15.957

These days many assembly languages are actually fairly high level.

And it's always been true that if you learn 'C', that's close enough to assembly to get most of the learning benefits.

*edit: thinking about this a bit more, in Knuth's books he describes an idealised assembly language. You won't go far wrong learning that, and reading those books.*

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-07T23:52:21.030

Another practical reason I can think of is reverse engineering application code to modify it for educational purposes ONLY, since this is widely used by crackers to bypass shareware application protections like time-limit or serial numbers.

An application like win32Dasm can convert executables into assembly code that can later be modified with a Hex editor like hiew. You can learn quite a lot about the flow of the program.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-07T23:55:00.777

Well, on a practical level I did a class in 6502 assembler when I was first learning to code the early 80s. I also did some 8088 assembler. It's been of occasional use of the years since but I can't say it's ever *really* got my out of a hole on more than one or two occasions in 25 years. Groking C at a pretty fundamental level is of far more use. YMMV and it's certainly helpful as background, but as a direct practical benefit? Marginal really.

Perversely though one thing that has proved useful is at an even lower level. I did a class on chip design (NAND gates and the like) and as part of that was taught formal Boolean logic at some depth. That's been massively useful ever since - it's surprising the number of coders who don't really know what they are doing with ands, ors and nots :-)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-08T00:37:41.080

I think learning about computer architecture, in conjunction of assembly, would open your mind quite a bit.

It would help explain lots of performance issues - e.g. parser's slow because there's lots of branches, and pipeline gets flushed very easily, branch predictor cannot compensate for everything.

Also, different architectures have their quirks. Someone talked about an assembly trick to swap 2 registers in place, involving xor's. It works, and it would run great for in-order execution core (most recent example would be the Intel Atom, and the Via C7 in netbooks), but not so great in out-of-order cores.

Knowing that may help you to detect poorly compiled code by inspecting it in assembly, and possibly be able to write code in higher-level language to sidestep the imperfection of compiler optimizers. I'm not trying to diss them, but they just can't be perfectly in tuned.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-12-24T04:02:45.443

I have some practical examples of why you need to know what is under the hood. Some useful links that you may find useful in this context are -

[Assembly And The Art Of Debugging](http://mohit.io/blog/assembly-and-the-art-of-debugging/)

[Debugging – Modifying Code At Runtime](http://mohit.io/blog/debugging-modifying-code-at-runtime/)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-12-24T04:05:22.833

The biggest practical advantage to learning Assembly is performance. You can optimize to near perfection when its required.

# windows-xp - 是否可以在 Windows XP 中保存窗口布局？

> ID：422616
> 
> 赞同：0
> 
> 时间：2009-01-07T23:29:21.950
> 
> 标签：windows-xp

当我处理项目中的文件时，我通常会打开四个窗口，查看屏幕四个象限中的四个不同文件夹。我早上的习惯涉及必须手动打开这四个文件夹，只需要几分钟，但我希望找到一种使用 Windows XP 自动执行此操作的方法？

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T23:36:45.150

您可以使用以下命令编写批处理文件：

```
start c:\myfolder1
start c:\myfolder2
start c:\myfolder3
start c:\myfolder4 
```

或者，由于 Bart 在对此答案的评论中说，他使用这种方法：

```
explorer c:\myfolder1  (etc...) 
```

然后以您希望的任何方式运行（在启动时，通过快捷方式...）

至于在屏幕上保存他们的位置，我对此了解不多，但您可以尝试使用[Winsplit Revolution](http://www.winsplit-revolution.com/)。这将让您使用热键重新定位窗口（Ctrl+Alt+Numpad 7 将窗口移动到左上角）。

# asp.net-mvc - 什么时候应该在 ASP.NET MVC 中创建一个新的控制器类？

> ID：422622
> 
> 赞同：8
> 
> 时间：2009-01-07T23:31:04.630
> 
> 标签：asp.net-mvc, design-patterns

我正在学习 MVC，但在决定何时创建新控制器而不是仅添加与现有控制器关联的操作和视图时遇到了麻烦。一方面，Single Responsibility 似乎是说控制器应该被限制在几个动作上。但是，当我尝试这个时，类的数量呈指数级增长（每个类的模型、视图和控制器）——以至于我想知道我是否太过分了。

例如，默认 AccountController 具有 Login、ChangePassword 和 Register 操作。我倾向于创建一个 LoginController、PasswordController 和 ProfileController 以及相关的模型类。因此，如果有 1 个班级，就会有 3-6 个班级。

这有什么好的经验法则吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-07T23:36:20.987

您应该为您正在操作的每种模型类型指定一个控制器。控制器充当作用于这些模型的动作集合。这通常是经验法则，但有时控制器的范围会超越单个模型。

AccountController 处理所有与身份验证相关的事情。这是一个超出单个模型范围以涵盖一般身份验证的示例。认证的关键部分是什么？检索用户、更改密码等。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-08T05:31:49.613

我认为你需要务实。我正在开发一个由 StatsController 组成的项目。动作的数量不断增长（RandomStat、MostPopular、MostViewed、MostVoted 等），这个列表还在继续。这些操作很容易满足，因为 StatsController 的依赖关系不会改变。我正在使用 IoC 来满足我的控制器的需求，当我开始看到我的控制器需要对新对象的引用时，这表明它们需要被分解。

如果您的 LoginController、PasswordController 和 ProfileController 都依赖于相同的对象，为什么要将它们分开？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T06:03:59.097

我当前的 AccountController 有 12 种方法，对我来说是完全可以管理的。

我有另一个控制器，它目前有 34 种方法，但它们都绑定到一个视图，并且它们每个都有大约 8-10 行代码（检查所需的参数，更新模型，并根据需要重定向）。

*它们的关键是将您的业务逻辑*封装在一个完全独立的模块中。这将使您的操作处理程序保持极轻的重量，并且可以使测试您的业务逻辑更容易。

# c# - 重载方法调用重载方法

> ID：422625
> 
> 赞同：3
> 
> 时间：2009-01-07T23:31:58.997
> 
> 标签：c#, .net, overloading

我有一个正在编写的方法，它在其中调用另一个重载方法。我只想写一个外部方法，因为外部方法的参数被传递给内部方法。有没有办法做到这一点？

我尝试使用泛型，但我对此知之甚少，因此它不起作用：

```
public void OuterMethod<T>(T parameter)
{
    InnerMethod(parameter); // InnerMethod accepts an int or a string
} 
```

我知道我可以这样做：

```
public void OuterMethod(string parameter)
{
    InnerMethod(parameter);
}

public void OuterMethod(int parameter)
{
    InnerMethod(parameter);
} 
```

但我宁愿以正确的方式做到这一点，而不是复制/粘贴代码。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T23:44:05.387

您可以在 C++ 中执行此操作，但不能在 C# 中执行此操作（除非内部方法也可以是泛型而不是重载）。

* * *

或者（如果您不接受“否”作为答案），您可以在类型上进行运行时切换，例如...

```
public void OuterMethod(object parameter)
{
    if (parameter is int)
        InnerMethod((int)parameter);
    else if (parameter is string)
        InnerMethod((string)parameter);
    else
        throw new SomeKindOfException();
} 
```

...但显然这是运行时检查，而不是编译时检查。

> 但我宁愿以正确的方式做到这一点，而不是复制/粘贴代码。

您还可以编写软件来编写您的外部方法（例如使用 System.CodeDom 类）而不是手动编写它们，但这可能比它的价值更麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T00:06:34.700

就像其他人说的那样，您不能真正做您想做的事情，而您在问题中陈述的选项是最好的选择。

如果您使用泛型，您实际上必须转换该值。否则，您可以通过接受 ChrisW 建议的 Object 来沮丧。

```
 public void OuterMethod<T>(T parameter) 
            {
                T temp = parameter;
                if (temp is string )
                    InnerMethod(Convert.ToString(temp));
                if (temp is int)
                    InnerMethod(Convert.ToInt32(temp));// InnerMethod accepts an int or a string
            } 
```

这是泛型概述的链接：http: [//msdn.microsoft.com/en-us/library/ms172193.aspx](http://msdn.microsoft.com/en-us/library/ms172193.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T00:57:47.390

根据您的描述，这似乎是过度优化。

怎么样：

```
public void OuterMethod(string parameter)
{
    InnerMethod(parameter);
}

public void OuterMethod(int parameter)
{
    InnerMethod(parameter**.ToString()**);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-01T17:31:15.103

您可以使用`dynamic`类型将重载决议推迟到运行时。

```
public void OuterMethod(dynamic parameter)
{
    InnerMethod(parameter);
}

public void InnerMethod(int parameter) { }
public void InnerMethod(string parameter) { } 
```

**警告** [动态类型的表达式不会被编译器解析或类型检查。](http://msdn.microsoft.com/en-us/library/dd264741.aspx)并且可能还会有性能损失。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T23:59:31.143

如果 OuterMethod 总是调用 InnerMethod，而 InnerMethod 只接受一个 int 或 string，那么 OuterMethod<T> 没有任何意义。

如果*唯一*的区别是一个调用 InnerMethod(int) 而另一个调用 InnerMethod(string) 你可以这样做：

```
public void OuterMethod(string parameter)
{
    InnerMethodA(parameter);
}

public void OuterMethod(int parameter)
{
    InnerMethodA(parameter);
}

private void InnerMethodA(object parameter)
{
    // Whatever other implementation stuff goes here

    if (parameter is string)
    {
        InnerMethodB((string) parameter);
    }
    else if (parameter is int)
    {
        InnerMethodB((string) parameter);
    }
    else
    {
        throw new ArgumentException(...);
    }
}

private void InnerMethodB(string parameter)
{
    // ...
}

private void InnerMethodB(int parameter)
{
    // ...
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T12:33:21.173

好的，我有类似的情况，它是我业务逻辑中的一种访问控制方法。

有一个保存功能可以应用于我的任何持久层对象。

所以看起来像这样

```
public static Save<T>(AccessControl.User user,T entity) where T:PersistanceLayerBaseClass
{
    if(CanWrite(user, entity))
    {
        entity.save();
    }
    else
    {
        throw new Exception("Cannot Save");
    }
} 
```

我如何在访问控制方面为某些实体提供一些自定义代码，所以我编写了以下内容，它使用 System.Reflection 寻找更适合问题的方法，“这个实体可以由这个用户编写吗？”

```
public static Boolean CanWrite<T>(AccessControl.User user, T entity) where T : PersistanceLayerBaseClass
        {
            int? clubId = null;
            MethodInfo methodInfo = entity.GetType().GetMethod("CanWrite", new Type[] { typeof(AccessControl.User), entity.GetType() });
            if(methodInfo != null)
            {
                return (Boolean)methodInfo.Invoke(null, new object[] { user, entity }) ;
            }
            else 
            {
                //generic answer
            }
            return HasRole(user.UserID, "Administrator") || (clubId.HasValue && user.MemberObject.ClubId == clubId.Value && HasRole(user.UserID, "AdministerClub"));
        } 
```

现在每次我添加或删除一个方法时，我只需要在一个地方添加或删除它

# c# - 如何监控麦克风的噪音？

> ID：422628
> 
> 赞同：6
> 
> 时间：2009-01-07T23:32:52.427
> 
> 标签：c#, windows-mobile, compact-framework, audio

我试图找到一种算法来检测用户何时在使用 C# 的 WM6 设备上对麦克风（如 Ninentdo DS 或 iPhone）吹气。

我正在考虑使用 Waveform 将麦克风实时读取到一个小缓冲区中，但我对如何识别吹气的声音有点迷茫，我猜这听起来像白噪声。任何人都知道如何做到这一点？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T23:42:49.117

如果我要解决这个问题，我会对着麦克风吹气并[记录下来](http://opennetcf.com/library/sdf/html/d3b2ecbb-49b8-965a-89c2-d78c3781e7a1.htm)。然后对波形数据运行[FFT](http://opennetcf.com/library/sdf/html/bad60a38-17ed-0b07-dd56-93ea054d631c.htm)以获得主频率（或几个）。我会这样做几次“打击”，看看它们是否产生类似的结果。如果他们这样做（我很确定他们会这样做），那么我会使用一种算法来寻找相同的频率。

这不是一项微不足道的任务，但由于已经完成了大量的记录和数学工作，您可能可以毫不费力地让它工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T03:06:40.530

麦克风中的一击不一定会显示高频（10,00hz +）中的主要频率。在 PC 麦克风中吹气很可能会导致信号饱和和失真，这也有很多低频。产生的信号将只是一个大的饱和突发。

几年前我不得不做一个类似的项目，我所做的只是寻找远高于正常口语水平的音量峰值。工作得很好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T04:53:30.940

sthg's answer提到失真是吹入麦克风的可能结果。我刚刚做了一个快速测试，我的吹气录音（在便宜的麦克风上）显示了大量的最小和最大值样本（例如 16-bits-per-sample WAV 文件上的 32767 和 -32768），这看起来每个山峰都应用了平顶。检测吹气声的一种非常简单的方法可能是计算所有处于最小值/最大值的样本，如果它们代表超过总数的 5%（或某个其他阈值），则假设正在发生吹气。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T06:25:22.750

I haven't looked at the spectrum of this, but I think you should see a band-limited noise spectrum with most energy below a few hundred Hz. This means you don't need a full audio bandwidth FFT, and 16K points is overkill. Even on a 256 point FFT over a small bandwidth you should be able to tell the noise from blowing in the microphone apart from speech.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T02:19:58.940

这并不完全相同，但这是我对有关音符开始检测的问题的回答：

[注意发病检测](https://stackoverflow.com/questions/294468/note-onset-detection#294724)

答案描述了一种依赖于信号强度高于给定阈值的方法。这种方法可以用来检测吹出的噪音，尽管它也会对任何噪音做出反应，所以说话等也会触发它。

您可以使用 FFT，但我认为这对于实时使用来说太慢了，尤其是在 Windows Mobile 设备上（不过它可能足够快）。然而，吹奏噪音不太可能具有主导频率，除非鼓风机正在吹口哨特定的音符。如果 FFT 足够快，您可能实际上想要寻找没有主频率的噪声（您会假设任何具有主频率或频率的任何东西都是语音或某种乐器）并且权重很大接近可听范围的上限（超过 10,000 赫兹左右）。

# asp.net - 如何部署 ASP.net 自定义 MembershipProvider？

> ID：422631
> 
> 赞同：2
> 
> 时间：2009-01-07T23:33:53.940
> 
> 标签：asp.net, asp.net-membership, membership-provider

我编写了一个自定义 MembershipProvider，它使用自定义数据库模式来存储成员，但我无法弄清楚如何部署提供程序。我的目标服务器正在运行 IIS7，我可以导航到一个对话框以添加一个 .NET 用户提供程序，但不是让我选择包含提供程序的程序集和类，而是提供一个下拉菜单几个 MS 书面提供商。

我是否需要将程序集放在特定位置，以便 IIS 发现我的 MembershipProvider 类？如果是这样，.dll 需要去哪里？否则，如何告诉 ASP.Net 使用我的 MembershipProvider？我看到的每个示例都只是引用了完全限定的类名，但没有提及需要如何部署文件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T23:48:22.600

如果您查看应用程序的 web.config 文件，您应该有一个名为 system.web 的部分。其中有一个带有提供者列表的成员资格元素。您应该能够添加您的提供者并在那里设置默认提供者。以这种方式注册您的成员资格提供程序后，您应该也可以从 IIS 中选择它作为该应用程序的默认值。

```
<system.web>
    ...
    <membership defaultProvider="MyMembershipProvider" 
                    userIsOnlineTimeWindow="15">
        <providers>
            <add name="MyMembershipProvider"
                             type="Common.Auth.MyMembershipProvider, Common" 
                             connectionStringName="MyAuthDBConnectionString" 
                             enablePasswordRetrieval="true" 
                             enablePasswordReset="true" 
                             requiresQuestionAndAnswer="true" 
                             writeExceptionsToEventLog="false" />
        </providers>
    </membership>
    ...
</system.web> 
```

提供者元素允许您注册多个提供者以供选择。另一个功能是您可以清除在机器上其他配置文件中注册的会员提供者。这可以使以后配置您的应用程序更不容易出错。为此，请在列表中的第一个成员资格提供程序（<add/> 元素）之前添加 <clear/> 元素。

```
<system.web>
    ...
    <membership defaultProvider="MembershipProvider1">
        <providers>
            <clear />
            <add name="MembershipProvider1" ... />
            <add name="MembershipProvider2" ... />
        </providers>
    </membership>
    ...
</system.web> 
```

如果您想仅使用 IIS 管理器向多个 Web 应用程序注册同一个提供程序，则需要将程序集放入 GAC 并将提供程序添加到机器配置文件之一。在部署单个应用程序时，这通常是更多的工作而没有什么好处。

# sql - 关于何时使用 WITH RECOMPILE 选项的经验法则

> ID：422632
> 
> 赞同：15
> 
> 时间：2009-01-07T23:34:12.503
> 
> 标签：sql, sql-server, options

我知道 WITH RECOMPILE 选项会强制优化器为存储过程重建查询计划，但是您希望什么时候发生呢？

关于何时使用 WITH RECOMPILE 选项以及何时不使用，有哪些经验法则？

将它放在每个存储过程上的有效开销是多少？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-07T23:58:27.713

正如其他人所说，您不想简单地包含`WITH RECOMPILE`在每个存储过程中作为习惯问题。通过这样做，您将消除存储过程的主要好处之一：它保存了查询计划这一事实。

为什么这可能是一件大事？计算查询计划比编译常规过程代码要密集得多。因为 SQL 语句的语法只指定**了**您想要的内容，而不是（通常）**如何**获取它，这使得数据库在创建物理计划时具有很大程度的灵活性（即逐步说明实际收集和修改数据）。数据库查询预处理器可以做很多“技巧”以及它可以做出的选择——连接表的顺序、要使用的索引、是否`WHERE`在连接之前或之后应用子句等。

对于一个简单的 SELECT 语句，它可能没有什么不同，但对于任何不平凡的查询，数据库将花费一些时间（以毫秒为单位，而不是通常的微秒）来提出最佳计划。对于非常复杂的查询，它甚至不能保证一个*最优*的计划，它只能使用启发式来提出一个*很好的*计划。因此，通过强制它每次重新编译，你是在告诉它它必须一遍又一遍地经历这个过程，即使它之前得到的计划非常好。

根据供应商的不同，应该有用于重新编译查询计划的自动触发器 - 例如，如果表上的统计信息发生显着变化（例如，某个列中值的直方图开始随着时间的推移均匀分布变得高度倾斜），那么数据库应该注意到并重新编译计划。但一般来说，数据库的实现者总体上会比你更聪明。

与任何与性能相关的事情一样，不要在黑暗中拍摄；找出消耗 90% 性能的瓶颈在哪里，并首先解决它们。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-07T23:51:15.260

将它放在每个存储过程上并不是一个好主意，因为编译查询计划是一项相对昂贵的操作，而且您不会从缓存和重用查询计划中看到任何好处。

在存储过程中构建的动态 where 子句的情况可以通过`sp_executesql`执行 TSQL 来处理，而不是添加`WITH RECOMPILE`到存储过程中。

另一种解决方案（SQL Server 2005 及更高版本）是使用带有特定参数的提示使用`OPTIMIZE FOR`提示。如果行中的值是静态的，这很有效。

SQL Server 2008 引入了一个[鲜为人知的特性](http://blogs.msdn.com/sqlprogrammability/archive/2008/11/26/optimize-for-unknown-a-little-known-sql-server-2008-feature.aspx)，叫做“ `OPTIMIZE FOR UNKNOWN`”：

> 如果根本没有将参数值传递给查询，则此提示指示查询优化器使用它一直使用的标准算法。在这种情况下，优化器将查看所有可用的统计数据来确定用于生成查询计划的局部变量的值应该是什么，而不是查看应用程序传递给查询的特定参数值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T23:40:23.160

最常见的用途是当您在过程中可能有一个动态 WHERE 子句时......您不希望该特定查询计划被编译并保存以供后续执行，因为下次它很可能不是完全相同的子句该过程被调用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-10-20T11:43:42.033

通常一个更好的选择`WITH RECOMPILE`是`OPTION(RECOMPILE)` 你可以在下面的解释中看到，取自[这个问题的答案here](https://dba.stackexchange.com/questions/75842/when-to-use-with-recompile)

> 当遇到参数敏感问题时，论坛和问答网站上的一条常见建议是“使用重新编译”（假设前面介绍的其他调整选项不合适）。不幸的是，该建议经常被误解为向存储过程添加 WITH RECOMPILE 选项。
> 
> 使用 WITH RECOMPILE 可以有效地将我们返回到 SQL Server 2000 行为，其中整个存储过程在每次执行时都会重新编译。在 SQL Server 2005 及更高版本上，更好的替代方法是仅对遭受参数嗅探问题的语句使用 OPTION (RECOMPILE) 查询提示。此查询提示仅导致重新编译有问题的语句；存储过程中其他语句的执行计划被缓存并照常重用。
> 
> 使用 WITH RECOMPILE 还意味着存储过程的编译计划不会被缓存。因此，在 sys.dm_exec_query_stats 等 DMV 中不会维护任何性能信息。相反，使用查询提示意味着可以缓存已编译的计划，并且 DMV 中提供了性能信息（尽管它仅限于最近的执行，仅限受影响的语句）。
> 
> 对于至少运行 SQL Server 2008 build 2746（带有累积更新 5 的 Service Pack 1）的实例，使用 OPTION (RECOMPILE) 与 WITH RECOMPILE 相比具有另一个显着优势：只有 OPTION (RECOMPILE) 启用参数嵌入优化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T23:46:28.780

只有在使用代表性数据和上下文进行测试时才应该使用它，证明不这样做会产生无效的查询计划（无论可能的原因是什么）。不要事先假设（未经测试）SP 不会正确优化。

仅手动调用的唯一例外（即不要将其编码到 SP 中）：当您知道您已经大幅更改了目标表的特征时。例如 TRUNCATE、批量加载等。

这是过早优化的又一个机会。

*注意：我有很多积分。如果新手在下面提交了相同的答案，并且您同意，请为他们的答案投票。*

# windows - Windows 编程：从哪里开始？

> ID：422645
> 
> 赞同：4
> 
> 时间：2009-01-07T23:38:09.750
> 
> 标签：windows

我是 Mac 的老用户，有相当多的编程经验，我想尝试为 windows 编程。问题是我不知道从哪里开始，我应该先学习什么？.Net，Win32？

**[澄清]**：我的最终目标是使用最新的 API 创建一个或多或少复杂的应用程序，但是我想知道我正在处理的内容的基础。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-07T23:42:15.763

从圣经开始，Windows 5 版编程。它仍然非常相关。

[http://www.charlespetzold.com/pw5/](http://www.charlespetzold.com/pw5/)

你将开始用 Win32 做 C。一旦你明白了，你也可以学习 .NET。尽管有些人可能会告诉您跳过 Win32 并直接使用 .NET。但是，使用 Win32，您将非常了解 Windows 的实际工作原理。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-07T23:44:43.433

我将看一下获取其中一个[Visual Studio Express Edition](http://www.microsoft.com/express/product/default.aspx)的副本并从那里开始。它拥有在 Windows 上构建 Windows/Web 应用程序所需的所有工具。

您可以从 win32 级别开始，但是根据您想要做什么，您可能会发现您可以使用 .net 和 Visual Studio 完成所需的一切。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T23:47:36.080

读完推荐的 Windows 编程圣经后，开始阅读Raymond Chen 的博客[The Old New Thing 。](http://blogs.msdn.com/oldnewthing/)

关于窗户的内部工作原理，有很多有趣的见解，为什么会这样等等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T23:51:39.347

对于 Windows 上的快速应用程序开发，.NET 似乎是当今最有效的解决方案。但是，如果您渴望从应用程序中获得额外的性能，我建议您通读一遍[Programming Windows](https://rads.stackoverflow.com/amzn/click/com/157231995X)和[Windows via C/C++ 。](http://wintellect.com/BookInformation.aspx?ASIN=0735624240)尽管其中一些材料已经过时，但其中很多仍然与今天的 Windows 编程相关。如果您选择 .NET 路线，可以查看一些书籍，包括[Illustrated C# 2008](https://rads.stackoverflow.com/amzn/click/com/1590599543)、[Accelerated C# 2008](https://rads.stackoverflow.com/amzn/click/com/1590598733)，当然还有我们自己的 Jon Skeet 的[深度 C#。](http://www.manning.com/skeet/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T23:40:55.797

.Net 更容易。

> 我的最终目标是使用最新的 API 创建或多或少复杂的应用程序

最新的 API 是 .Net（Win32 较旧）。

> 但是我想知道我正在处理的事情的基础。

Win32 是 .Net 的基础（尽管在 .Net 环境中编程时您可能几乎看不到 Win32 伪影……例如，Mono 项目或多或少地成功地将 .Net API 移植到了非 Windows）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T11:44:55.320

阅读 Petzold 并查看 Advanced Win32 api 新闻组，了解所有未记录的内容 news://comp.os.ms-windows.programmer.win32（所有 Win32 api 的源代码...）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T00:13:27.587

我建议开始使用 .NET（C# 或任何其他 .NET 语言）进行编程，因为这是 Microsoft 最现代的通用应用程序平台。我个人喜欢 Richter 的书籍、[CLR via C#](https://rads.stackoverflow.com/amzn/click/com/0735621632)和[Applied Microsoft .NET Programming](https://rads.stackoverflow.com/amzn/click/com/0735614229)。尽管第二本书有点旧并且不包含较新的 .NET 功能，但起点还是不错的。

要真正学习 Windows 平台，我完全同意 Bobby 的建议，阅读 Petzold 的[Programming Windows](https://rads.stackoverflow.com/amzn/click/com/157231995X)。

# agile - 已完成的用户故事 - 丢弃？档案？

> ID：422699
> 
> 赞同：5
> 
> 时间：2009-01-07T23:59:09.100
> 
> 标签：agile, scrum, user-stories

我们开始使用 Scrum 流程进行开发。我们现在有很多用户故事。不过我想知道，一旦用户故事完成、测试和部署，你还会用它做其他事情吗？我们现在正在使用小索引卡，我认为将它们扔进垃圾桶就可以了。

如果你保留它们，你以后如何处理它们？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-08T00:09:40.497

将它们存档以供将来项目参考。当您必须估计故事点时，它们将很有用。很多时候，听起来相似的故事会发生在项目中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-08T00:15:55.197

嗯 - 保留它们并将它们放入项目文件中。CYA 在所有情况下。你永远不知道客户什么时候会回来问你“为什么会这样？”，或者“谁决定是这样的？”。然后，您可以提取用户故事并进行备份。

始终保留这样的所有内容，直到您的软件的保修期到期……除非您想被置于可能被要求“修复”某些真正免费更改的位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T00:01:16.707

垃圾桶似乎是一个合适的地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T00:11:54.767

PEZ 几乎是对的。回收卡片而不是丢弃它们。:)

保留它们确实没有意义。如果您需要更改历史记录，可以从 SCM 和测试脚本中获取。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T02:09:15.793

再次投票保留他们。我知道这是一个肮脏的词，但是用户故事是您文档的一部分，并且具有重要目的。

三年后，当您（或继承人）对系统进行更改时，拥有历史文件以了解您为什么以您的方式做事会很有帮助。

当情况发生变化并且您必须重写以便能够回顾应用程序满足的用户故事并确定这些相同的故事是否适用于新版本时，它也会有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-09T13:59:11.580

我通常将每个迭代价值的用户故事（和任务）包裹在橡皮筋中，并在前面放一张新卡片，说明速度和估计点。我从来没有用过它们，除了怀旧的放松。所以把它们留作我想说的存档：-9

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-02-01T00:14:39.567

**坚持住他们！**

我编写需求（而不是代码），但我经常发现自己重读旧的用户故事和验收测试（我的和其他人的）。

回顾旧故事可以帮助我为复杂的概念找到最清晰的措辞，而不是重新发明轮子。它们有时可以作为有用的提醒，提醒我可能会忘记记录的细节。其他人写的故事可以帮助我快速了解我没有参与的功能，并且可能是新员工的一个很好的学习工具。

我可以继续说下去，但让我这么说吧：
哪一个更可能导致更大的问题——保留故事而不需要它们，还是需要故事而不拥有它们？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-08T00:02:08.220

保留它们（存档），以便将来如果对某事有争议或争论，您可以参考它，并且可以保护自己。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-08T02:28:22.277

完成的用户故事本质上是您项目的最终规范。如果您从正式的需求文档或规范开始，通过将您完成的用户故事与该文档进行比较，可以学到很多经验教训。如果您没有初始文档，那么您完成的用户故事会记录您项目的功能。无论是哪种情况，我认为保留它们以供将来参考非常有价值，无论是在项目事后分析中还是在估算和计划后续项目时。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-08T03:14:19.470

我发现我们永远不知道将来会有什么用处，所以我的建议是标记它们并将它们归档。如果您使用的是实体卡，请扫描它们，然后执行一些简单的操作，例如在图像文件中添加标签。想象一下稍后查看标签云以查找常见线程或定位和重用您的内容。

然而，就像所有的事情一样，如果它开始花费太多时间，那么你可能不值得付出努力。不要让它成为一个疯狂的过程，只需快速归档并忘记它。

干杯，里夫斯

# javascript - Ruby on Rails Ajax 橡皮筋

> ID：422701
> 
> 赞同：4
> 
> 时间：2009-01-08T00:00:36.320
> 
> 标签：javascript, ruby-on-rails, ruby, ajax

我希望我的用户能够在 Ruby on Rails 应用程序的图像中进行橡皮筋选择。有没有人看到任何好的插件可以做到这一点或让我很容易实现它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T00:24:14.617

我使用了具有该功能的[图像裁剪](http://www.defusion.org.uk/code/javascript-image-cropper-ui-using-prototype-scriptaculous/)器，并且它使用[Prototype](http://prototypejs.org)，因此使用 ROR 应该很好。如果您只想要松紧带元素，代码很容易弄清楚。

如果您想自己动手，将[Scriptaculous](http://script.aculo.us/) Draggable 对象粘贴到 DIV 并调整 DIV 的大小/移动 DIV 并不难。看我蹩脚的[演示](http://jameslab.moveable.com/ajaxio)。

# php - 自动增量在 MySQL 中停止了吗？

> ID：422713
> 
> 赞同：0
> 
> 时间：2009-01-08T00:06:53.903
> 
> 标签：php, mysql, database, phpmyadmin

我正在编写一个可悲的是我继承的脚本 - 没有评论或任何东西。啊！出于测试目的，我复制了数据库中具有自动递增 ID 的表之一。但是，当数据保存到数据库时，ID 号只是读取“0”——这是该列的默认值。我不确定为什么它不再自动增加......有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T00:08:48.080

您确定将重复表中的字段设置为自动递增吗？尝试运行：

```
 ALTER TABLE `duplicate_table` CHANGE `ai_key` `ai_key` INT( key_length ) NOT NULL AUTO_INCREMENT 
```

并查看它是否已设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T00:11:20.963

您是从头开始创建新表还是将其作为真实副本？如果该列应该自动递增，则它应该是主键（或至少是唯一键），没有默认值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T00:22:24.917

只是为了仔细检查使用 sql 语句来显示两个表的[show create table](http://dev.mysql.com/doc/refman/5.0/en/show-create-table.html)语法并进行比较。

```
show create table <table> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T00:26:07.843

听起来您的专栏实际上`auto_increment`不再存在。这发生在我身上好几次了，因为我用来创建备份的 phpMyAdmin 中有一个错误（？）：它不会将`auto_increment`关键字添加到 CREATE TABLE 语句中。*那*是一个巨大的臀部疼痛......

# python - 如何获取“python setup.py”提交的新鲜肉类信息？

> ID：422717
> 
> 赞同：0
> 
> 时间：2009-01-08T00:09:01.450
> 
> 标签：python, setuptools

这可以在 pypi 上提交有关您的软件的信息：

```
python setup.py register 
```

但是没有类似的命令可以将信息提交给freshmeat。我怎么能写一个 distutils.Command 让我做以下事情？

```
python setup.py freshmeat-submit 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T10:28:09.097

这应该相当容易；我想说freshmeat API 很简单。

对于 python 站点，对于 setup.py 中的 setup() 函数，给出以下参数：

```
entry_points = {
    'distutils.commands' : [
        'freshmeat-submit = freshsubmitter.submit:SubmitToFreshMeat',
    ],
}, 
```

其中freshsubmitter 是您的新pakcage，submit 是其中的模块，SubmitToFreshMeat 来自distutils.command.config.config 子类。

请注意 entry_points 是全局的，因此您应该将命令作为单独的包分发；将它与每个包捆绑在一起会导致冲突。

# debugging - 如何在没有堆栈跟踪引用源代码的情况下调试应用程序崩溃？

> ID：422720
> 
> 赞同：2
> 
> 时间：2009-01-08T00:10:35.863
> 
> 标签：debugging

[http://support.microsoft.com/kb/953102](http://support.microsoft.com/kb/953102)

我们在圣诞节期间花了大约 50 个小时来确定这个问题，导致我们的关键业务生产应用程序随机崩溃。

问题是源代码没有堆栈跟踪，只有堆栈跟踪底部的 NativeWindow.Callback 之类的本机代码。

有什么工具可以用来调试这类问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T00:43:39.010

如果您可以容忍它，请添加大量日志记录。

猜测它发生的位置并将代码括起来`entered Foo`并`exited Foo`记录。然后，如果您在崩溃中看到一个但没有看到另一个，您就知道它在某处，因此根据需要开始一个二进制（或 n 元）搜索深入到函数中。在某种程度上，您需要卷起身后的地毯以保持原木的大小，但只要可以合理频繁地产生崩溃，您就应该能够以这种方式将其归零。

我有一个应用程序，我已经完成了这个（我无法在它的预期环境中以任何其他方式调试它）并发现它是有效的，而且说你已经使用了 1M+ 行日志文件（到很多日志记录，以及一个大的测试用例`<g>`）

# iphone - Iphone SDK - 我可以通过 SDK 在 iphone 的 ipod 功能中启动文件（歌曲）吗？

> ID：422724
> 
> 赞同：3
> 
> 时间：2009-01-08T00:11:36.437
> 
> 标签：iphone

我想在我的 iphone 应用程序中有一个功能，它可以开始在我的 iphone 的 ipod 部分播放文件。SDK 允许调用这个吗？除了使用 iphone 的本机界面之外，有没有一种简单的方法可以从我的应用程序开始播放歌曲？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T00:13:13.890

不，我认为官方的 iPhone OS 2.0 SDK 不允许这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T00:57:05.330

您无法从您的应用程序启动 iPod 应用程序。但是您可以轻松播放歌曲。

使用[AVFoundation](http://developer.apple.com/iphone/library/documentation/AVFoundation/Reference/AVFoundationFramework/index.html)框架中的[AVAudioPlayer 。](http://developer.apple.com/iphone/library/documentation/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html)

Ars Technica 有一篇很好的文章，[在这里](http://arstechnica.com/journals/apple.ars/2008/11/25/iphone-sdk-watch-new-avfoundation-framework)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T05:50:03.273

这现在可以在 3.0 中实现，但由于 NDA 问题，我不会进一步讨论。该信息可在开发人员网站上找到。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-01T01:20:20.123

现在它是公开的，你正在寻找 MPMediaPickerController 和 MPMediaPickerControllerDelegate

[http://developer.apple.com/iphone/library/documentation/MediaPlayer/Reference/MPMediaPickerController_ClassReference/Reference/Reference.html](http://developer.apple.com/iphone/library/documentation/MediaPlayer/Reference/MPMediaPickerController_ClassReference/Reference/Reference.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T03:30:12.387

不，您不能从媒体库中触发歌曲，但您可以播放嵌入在应用程序中的歌曲或从网络下载的歌曲，这里有一些示例

[苹果 - 示例](http://developer.apple.com/iphone/library/samplecode/oalTouch/)

[AppsAmuck - 示例](http://appsamuck.com/day21.html)

# c++ - Visual Studio _CrtDumpMemoryLeaks 总是跳过对象转储

> ID：422738
> 
> 赞同：3
> 
> 时间：2009-01-08T00:18:16.377
> 
> 标签：c++, visual-studio, memory-leaks, msvcrt, crtdbg.h

我正在尝试使用 CRT 内存泄漏检测，但在 Microsoft Visual Studio 中不断收到以下消息：“检测到内存泄漏 - 跳过对象转储。” 我永远无法让它实际执行和对象转储。

我按照微软关于内存泄漏检测的文章 ( [http://msdn.microsoft.com/en-us/library/e5ewb1h3(VS.80).aspx](http://msdn.microsoft.com/en-us/library/e5ewb1h3(VS.80).aspx) ) 中的说明进行操作，但没有成功。

在我的 stdafx.h 我有（重建整个项目）：

```
#define _CRTDBG_MAP_ALLOC
#include <stdlib.h>
#include <crtdbg.h> 
```

在我的应用程序的入口点，我有：

```
_CrtSetDbgFlag ( _CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF ); 
```

我也希望它会以微软宣传的格式显示文件名和行号：

```
Detected memory leaks!
Dumping objects ->
C:\PROGRAM FILES\VISUAL STUDIO\MyProjects\leaktest\leaktest.cpp(20) : {18} 
normal block at 0x00780E80, 64 bytes long.
 Data: <                > CD CD CD CD CD CD CD CD CD CD CD CD CD CD CD CD
Object dump complete. 
```

虽然我什至无法获得对象转储，但我注意到其他人说他们看到了这些方面的东西（即使定义了 _CRTDBG_MAP_ALLOC ）：

```
Detected memory leaks!
Dumping objects ->
{18} normal block at 0x00780E80, 64 bytes long.
 Data: <                > CD CD CD CD CD CD CD CD CD CD CD CD CD CD CD CD
Object dump complete. 
```

我真的不想花时间覆盖 new 和 delete 运算符，所以我希望 CRT 调试能帮助我。如果这不起作用，我可能最终会覆盖 new 和 delete 运算符，但我真的想获得带有文件名和行号的分配信息（交叉手指）。

谢谢，基里尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-03-22T00:45:14.713

在使用 _CrtDumpMemoryLeaks 方法获得大量没有文件名/行号的泄漏对象后，我刚刚使用了[Visual Leak Detector 。](http://vld.codeplex.com/)VLD 像宣传的那样工作（它是免费的），我对此非常满意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T00:26:06.347

我的机器上没有它，但是当您安装 MSVC 时，您可以选择为 C 运行时库（即 MSVCRTxx.xxx）安装（大部分）源代码。如果您在该源代码中查找“跳过对象转储”，那么您可能能够弄清楚为什么要跳过对象转储。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T11:52:50.967

打印文件名和行的原因是因为分配是使用通过的`new`宏完成的`__FILE__`，`__LINE__.`如果您不想 touch `new`，您将不会传递`__FILE__`and`__LINE__`到 CRT 并且它将无法打印。这里没有什么大魔法，真的。

# database-design - 时钟 - 表设计

> ID：422743
> 
> 赞同：3
> 
> 时间：2009-01-08T00:21:09.990
> 
> 标签：database-design

打卡/打卡桌的最佳设计是什么？

您会将打卡/打卡存储在同一张表中还是单独的表中？为什么？

**编辑**- 每小时员工在轮班开始时打卡，在轮班结束时打卡。每小时 - 除了在一天的开始/结束时进/出之外，豁免员工必须在午餐时打出/进出。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-08T00:30:16.447

只需将其视为一个“事件”表，具有通常的*谁、什么*（打入或打出）、*何时*和*何*地的属性。（*在*这种情况下可能不适用。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T01:24:10.083

假设您的程序将具有 PUNCH IN 和 PUNCH OUT 按钮，那么带有用户 id、punch-in 和 punch-out 字段的时钟表是一个好方法

您可以按照其他人的建议使用事件表对此进行建模，但是该模型的问题是您必须有一个类型字段（输入或输出），或者您必须尝试确定用户是在输入还是输出; 不妨将所有内容放在一行中 - 这样如果有人试图打卡但从未打卡，这是一个简单的查询来解决这个问题，您不必为每个输入设置两条记录和一个类型 -出对

总结：一张带入/出日期的表存储更少，查询更简单

请注意，对单个打卡事件进行建模不仅需要一个额外的（浪费的）事件类型字段，它还会使处理不必要地复杂化，并在记录之间引入只能通过时间比较找到的 1:1 关系

编辑：在这一点上，我们真的不知道 OP 是使用哑打卡时钟设备还是智能打卡时钟程序。如果是前者，那就别无选择，只能记录打卡事件，以后再和好；如果是后者，则可以在打孔发生时进行协调/检测。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T00:38:51.267

到过那里。您需要一个简单的事件表。不要将打入和打出合并到同一个记录中。人们不可避免地会尝试在没有打卡记录的情况下打卡，而您无法在找出原因时锁定系统。只需记录您可以记录的内容并标记管理错误。

编辑：这可能是彼得所说的。如果是这样，请支持他的 - 他首先在这里，我已经有很多积分了。

编辑：这是现存最古老、调试最彻底的范例之一。去找一个现有的（也许是机械的）时钟系统并复制它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T01:59:39.650

用户/输入/输出是，IMO，更好的选择。它可以通过使用以下算法轻松处理不匹配的拳：

打孔：

*   总是创造一个新的记录。

冲出：

*   如果用户最近的 Punch In 没有附加 Punch Out，则在该记录上记录当前时间作为 Punch Out。
*   否则，创建一个新记录。

计算记录时间现在很简单（将每条记录的 Punch Out 减去 Punch In 相加），以及识别不匹配的打孔（查找任一字段为空的任何记录），所有这些都无需扫描表以尝试匹配所有内容每次检查时间相邻的记录。

当然，在某些情况下，Punch Out 可能最终与错误的 Punch In 相关联 - 但相同的出拳序列在使用另一种方法时会产生相同的结果，除非它使用更智能的算法来匹配它们。当用户不提供严格交替的 In/Out/In/Out... 序列时，正确匹配它们纯粹是用于进行匹配的算法的问题，而不是用于存储出拳的数据结构的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-08T02:03:07.303

正如您从评论中看到的那样，有两种不同的方法：基于事件的模型，其中每个事件（无论是“in”还是“out”）都是一个不同的记录；和一致的输入/输出模型，其中每个“输入”必须在同一记录中后跟一个“输出”。

哪个更好取决于它将如何使用。您的打孔系统是否确定打孔和打孔之间的区别？有些（如刷卡进入系统）没有。如果你没有，你可能会在基于事件的系统上遇到麻烦，因为有人第一次忘记打卡时，他们突然工作了 24 小时，然后他们每天工作 16 小时。哎呀。

如果他们确实知道进出之间的区别，则基于事件的捕获更容易，并且干扰人类行为的机会更小（许多门禁卡系统，例如停车场，采用进/出模型，他们可以获得如果您使用一个人的徽章退出而另一个人的徽章退出，则会感到困惑）。

但是，通常，您预先获得的简单性会导致算法变得更加复杂，以便在异常情况下弄清楚如何处理生成的打孔数据。如果您真的需要成对输入/输出，并且您可以在前端强制执行（例如，在人们输出之前不让人们再次输入），那么输入/输出单记录方法将使您的生活后端要简单得多。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T00:29:32.733

```
Table name: Sessions
Columns   : ID, UserID, Timestamp_IN, Timestamp_OUT 
```

根据您提供的信息，我喜欢这种简单的设计。但是确实没有足够的信息。系统会自动检测是打卡还是打卡？用户会指定吗？ETC..

您似乎想要存储某种会话以及会话开始和结束的时间。不打卡可以连续打两次吗？这些问题很重要。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-08T02:08:35.953

我会使用包含 UserID、Date、TimeIn、TimeOut、LunchStart 和 LunchEnd 作为字段的表。对于非小时豁​​免员工，LunchStart 和 LunchEnd 将保留为 NULL。

有些人可能会抱怨某些员工的午餐字段总是为空，但这是一个非常微不足道的问题。这是一个非常简单的设计，可确保每位员工每天有一个记录，并且使计算每天的总工作时间变得非常容易。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-09T18:27:49.010

Waves 在工作中与他进行了简短讨论后，发布了关于打卡/打卡桌最佳设计的原始问题。我们在公司的 IT 部门一起工作，而我正在致力于替代当前的纸质考勤卡流程。所以当波浪告诉我他代表我发布了一个问题时，我想我会在这里放弃。

目前，我们为在工厂工作的非豁免小时工配备了机械打卡钟。非豁免小时工办公室员工（穿着干净衬衫的员工）手工填写时间表，而不是打卡。

我的老板希望我为工厂工​​人编写一个使用近距离阅读器的系统。该系统还将允许工厂和办公室工作人员在 PC 上使用他们的公司登录 ID 打卡/打卡。

我们在建筑物的所有入口处使用感应读取器，并且使用专有软件将进出时间记录在 SQL Server 表中。我可以访问 SQL Server 表，并且已经编写了一个配套网页，该网页在接待员的办公桌上显示了一个输入/输出板。

入口处的阅读器成对出现：每个入口处的建筑物外部一个，每个入口内部的一个对应的阅读器。因此，阅读器根据阅读器的物理位置记录员工是否正在进入或离开建筑物。

我应该使用其中一个“哑”读卡器作为考勤卡更换计划的读卡器。因此它不***知道***一拳是“进”还是“出”拳。

我推测我们可以使用两个阅读器来让工厂人员以与使用当前进入/退出阅读器类似的方式进行打孔；也就是说，在打卡时，刷***这个***阅读器，当打卡时，刷***那个***阅读器。但由于要求允许任何非豁免员工在 PC 上打卡/打卡，我一直对如何处理办公室工作人员的进/出指定以匹配双读卡器种植人。

所以这是我到目前为止想出的：

1.  包含 EmployeeNumber、TimeStamp 和 PunchDevice 的“原始”打卡表——无论是感应读卡器还是 PC。这张表将包括***任何***拳头，即使是员工在几秒钟内连续刷读器三到四次的拳头。
2.  包含 EmployeeNumber、InTimeStamp 和 OutTimeStamp 的 In/Out 表。
3.  一个 Personnel 表，其中包含每个员工的单个记录。该记录还包含 LastTimestamp、“原始”打卡记录键和 In/Out 表记录的键的字段。

如果 Personnel 表中的 In/Out 键字段为空/NULL，则必须将新记录插入到 In/Out 表中，并用“原始”表中的 TimeStamp 填充 InTimeStamp。然后使用新创建的 In/Out 记录中的键更新 Personnel 表的 In/Out 键字段。

如果 Personnel 表中的 In/Out 键字段包含键值，则查找 In/Out 表中的相应记录并使用 OutTimeStamp 字段中“原始”表中的最新 TimeStamp 进行更新。然后从 Personnel 表中删除 In/Out 键字段值。

这是一个相当大的问题，好吧。现在，在你问为什么我们不只使用进入/退出系统中的信息之前，我会告诉你，因为人力资源部门的政策。在这里，我们允许人们在轮班之前进入大楼。但员工***不得***在轮班开始前超过 7 分钟打卡。因此，员工已经“习惯于”在打卡钟前闲逛，直到轮班开始前 7 分钟；然后他们迅速接连冲进来。

我们这样做是因为如果员工在轮班开始前 8 分钟打卡，公司必须向他支付额外一刻钟的费用。同样，如果一名员工在轮班结束后 8 分钟下班，公司必须向他支付额外一刻钟的工资。

我为这篇文章的长度道歉，但我觉得对这里给出的优秀答案有一个更全面的上下文解释很重要。再次，wave 代表我发布了一个问题，而我基本上是在“劫持”该线程。我希望他没事。

真挚地，

史蒂夫·厄巴赫·
尼纳，威斯康星州

PS，我想感谢那些有帮助的答案。我可以作为“线程劫持者”这样做吗？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-08T03:08:32.883

底线 - 这应该是一个制造/购买的选择，只有一个真正的选择。它丑陋、混乱，最终面向用户，并且被一遍又一遍地解决。拜托，请不要从第一原则再做一次。无论如何，您都需要购买硬件，而且它们都带有软件。

至少我**希望**你不会重新发明硬件......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-21T06:18:08.313

我在这件事上使用 jquery[很容易进/出](https://i.stack.imgur.com/NWpzZ.png)

我刚才做了一个简单的程序，为了简单起见，我保存的所有变量都来自这个简单的代码

```
function getClock(){
  var d = new Date();
  var nhour = d.getHours(),nmin=d.getMinutes(),nsec=d.getSeconds(),ap;

  if (nhour == 0) {
    ap = " AM";
    nhour = 12;
  } else if (nhour < 12) {
    ap = " AM";
  } else if (nhour == 12) {
    ap = " PM";
  } else if (nhour > 12) {
    ap = " PM";
    nhour -= 12;
  }

  var nminTot = nmin <= 9 ? nmin = "0" + nmin : nmin;
  var nsecTot = nsec <= 9 ? nsec = "0" + nsec : nsec;

  $("#clockbox").html(nhour + ":" + nminTot + ":" + nsecTot + ap);
}
setInterval(getClock, 1000) 
```

很短的时间时钟设计容易得到变量。 [http://jsfiddle.net/2pqn6a1z/6/](http://jsfiddle.net/2pqn6a1z/6/)

# .net - 是否可以优化该代码？

> ID：422747
> 
> 赞同：1
> 
> 时间：2009-01-08T00:23:15.977
> 
> 标签：.net, vb.net, algorithm

我对速度感兴趣，而不是好看的代码，这就是为什么我使用数组而不是列表（整数）。

我有一个数组看起来像：0,1,0,1,1,0,1,0,1,1,1,0,0,1

我对每个数字的位置很感兴趣，所以我以后可以随机选择一个。

所以我要做的是遍历数组以获取每个 1 的位置编号，然后创建一个新数组，如下所示：2,4,5,7,9,10,11,14

可以在这里使用按位吗？我不知道

代码如下：

```
Private Function theThing() As Integer()
    Dim x As Integer
    'arIn() would be a parameter
    Dim arIn() As Integer = {0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1}
    Dim ar() As Integer = Nothing
    Dim arCount As Integer = -1

    For x = 1 To arIn.GetUpperBound(0)
        If arIn(x) = 1 Then
            arCount += 1
        End If
    Next

    If arCount > -1 Then
        'using redim preseve is slower than the loop above
        ReDim ar(arCount)

        arCount = 0
        For x = 1 To arIn.GetUpperBound(0)
            If arIn(x) = 1 Then
                ar(arCount) = x
                arCount += 1
            End If
        Next
    End If

    Return ar
End Function 
```

*** 编辑 ***

当前的解决方案（快 10% 到 15%）现在是

```
Private Function theThing() As Integer
    Dim ar() As Integer = {0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1}
    Dim arLenght As Integer = ar.GetUpperBound(0)
    Dim arCount As Integer = 0
    Dim x As Integer

    For x = 1 To arLenght
        If ar(x) = 1 Then
            ar(arCount) = x
            arCount += 1
        End If
    Next

    dim r As New Random()

    Return ar(r.Next(arCount))
End Function 
```

我不认为它可以被优化得更多，除非有人找到一种方法来完全按照解决方案的功能，但速度更快

在这个问题之前，我的整个事情能够每 10 秒运行大约 25500 次。

现在，它可以一直超过 32250，增加 21%，谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T00:30:01.003

与其存储整数数组，不如将它们全部放入一个整数中？

```
oldArray = [0, 1, 1, 0, 1]
newValue =  22     (binary 10110) 
```

如果要检查是否设置了特定位位置，请与该位置的 2 进行按位比较：

```
is position 2 set?
value:    10110
4 (2^2):  00100
result:   00100 --> true

is position 0 set?
value:    10110
1 (2^0):  00001
result:   00000 --> false 
```

搜索按位比较，您应该会找到很多帮助。

这里有一些很好的 Stack Overflow 问题可能会有所帮助：
[什么是位运算符？](https://stackoverflow.com/questions/276706/what-are-bitwise-operators)
[您如何设置、清除和切换单个位？](https://stackoverflow.com/questions/47981/how-do-you-set-clear-and-toggle-a-single-bit-in-c)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T01:04:48.687

关于原始算法的一些提示：

1.  尝试将 arIn.GetUpperBound(0) 的结果存储在变量中。我不知道 VB 如何使其成为循环，但有可能每次迭代都会调用一次该函数。你应该检查一下。
2.  这`If arCount > -1`将永远是真的。去掉它。

如果您希望保持相同的输入/输出，那么我认为没有什么可以改进的。

现在，如果您想要一个也可以进行随机选择的函数，那么它可能会更好一些。我会用 C# 编写，因为我更了解它。你应该能够理解：

```
public static int GetRandomSetBit(int[] AllBits)
{
    // Perhaps check here if AllBits is null/empty. I'll skip that for now.

    int L = AllBits.Length;
    int SetBitCount = 0;

    // No point to save a few bytes here. Also - you can make a global array
    // large enough for all occasions and skip allocating it every time.
    // In that case consider automatic resizing and watch out for
    // multithreading issues (if you use several threads).
    int[] GoodPositions = new int[L];

    for ( int i = 0; i < L; i++ )
        if ( AllBits[i] != 0 )
        {
            GoodPositions[SetBitCount] = i;
            SetBitCount++;
        }
     Random r = new Random(); // Should use one global instance
     return GoodPositions[r.Next(SetBitCount)];
} 
```

恐怕没有比这更好的了。除非你能以某种方式改变输入/输出或要求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T01:26:01.950

我很难相信 redim 保留会比您的循环慢，除非它本身在循环内。

在这种情况下，对于原始速度，不要只计算 arIn 中 1 的数量来设置 ar 的大小。由于 ar**永远不会**比 arIn 大，只需将其设置为相同的大小并在最后进行 redim-preserve （不会变慢，因为它在循环之外并且总是会修剪，而不是扩展 - VB 希望可以做到这一点 -放置而不是分配更多的内存）。此外，arIn 的缓存大小，以防 VB 每次通过循环计算它（可能是允许 ReDim 的）。

```
Private Function theThing() As Integer()
    Dim x As Integer
    'arIn() would be a parameter
    Dim arIn() As Integer = {0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1}
    Dim ar(arIn.GetUpperBound(0)) As Integer
    Dim arCount As Integer
    Dim arInCount As Integer

    arCount = 0
    arInCount = arIn.GetUpperBound(0)
    For x = 1 To arInCount
        If arIn(x) = 1 Then
            ar(arCount) = x
            arCount += 1
        End If
    Next

    ReDim Preserve ar(arCount)
    Return ar
End Function 
```

或者，如果您稍微调整返回的内容，您可以完全删除 redim。使返回数组比输入数组大一个，并使用第一个元素来控制您将随机选择数组的哪些部分。

对于您的示例，返回的数组将是：

```
{8,2,4,5,7,9,10,11,14,?,?,?,?,?,?} (? values are irrelevant).
 ^ <-------+--------> <----+---->
 |         |               |
 |         |               +-- These are unused.
 |         |
 |         +-- These are used.
 |
 +-- This is the count of elements to use. 
```

该代码将是：

```
Private Function theThing() As Integer()
    Dim x As Integer
    'arIn() would be a parameter
    Dim arIn() As Integer = {0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1}
    Dim ar(arIn.GetUpperBound(0)+1) As Integer
    Dim arCount As Integer
    Dim arInCount As Integer

    arCount = 0
    arInCount = arIn.GetUpperBound(0)
    For x = 1 To arInCount
        If arIn(x) = 1 Then
            ar(arCount) = x
            arCount += 1
        End If
    Next

    ar(0) = arCount
    Return ar
End Function 
```

然后，在您从 ar 中选择随机值的代码中，而不是：

```
rndval = rnd(ar.GetUpperBound) 
```

采用：

```
rndval = rnd(ar(0) + 1) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T02:07:36.453

禁用溢出检查。
项目属性 -> 编译 -> 高级编译选项 -> 删除整数溢出检查。
如果您需要对项目的其余部分进行溢出检查，您可以将代码移动到新项目（例如 DLL）并禁用该新项目的溢出检查。

还要确保您正在运行发布版本（启用优化）并且您没有调试它。

编辑：调用函数 50 次，我得到 8.5 秒（如果我在用于测试的 For 中声明数组，则为 12 秒）。如果你只得到 32000 或者你正在使用非常大的输入或者某些东西正在减慢你的代码。例如，如果您正在计算程序内部的时间并且您在分析器中运行它，您将得到错误的结果，因为分析会显着减慢程序的速度。[像这种慢速方法调用](https://stackoverflow.com/questions/383735/slow-methods-calls)的故障也可能会影响性能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T02:19:29.893

我认为当 Recursive 引用 BitArray 时，他的意思是这样的：

```
using System.Collections.Generic;
using System;
using System.Collections;

class Program
{
    static void Main(string[] args)
    {
        var input = new BitArray(new byte[] { 0x5A /*01011010b*/
                                        , 0xE4 /*11100100b*/ });
        var output = new List<int>();
        var offset = 1;
        foreach (var bit in input)
        {
            if (bit)
            {
                output.Add(offset);
            }
            offset++;
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T00:28:39.897

多少项目的速度？

改变项目？

编译时间还是执行时间？

有什么空间限制？

一个已知的策略是将几个组合在一起并写出所有组合及其结果：0000 -> 0001 -> 4 0010 -> 3 0011 -> 3,4 0100 -> 2 0101 -> 2,4 0110 -> 2 ,3 ...

为什么要从这种二进制表示转换为随机选择一位？这不太可能有助于提高性能。最好将它们按 8 位分组，使用表格告诉您组中有多少个 1，然后重复 5 次。那么你知道有多少。做一个随机的，然后查找选定的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T00:36:01.520

您可能会发现使用 For Each 和初始化为至少输入数组长度的列表比索引器更快：

```
If arIn.Length > 0 Then
  Dim lstOut As New List(Of Integer)(arIn.Length)
  Dim ix As Integer = 0
  For Each val As Integer In arIn
    If val = 1 Then
      lstOut.Add(ix)
    End If
    ix = ix + 1
  End If
  Return lstOut.ToArray()
Else
  Return Nothing
End If 
```

但是你必须测试它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-08T00:50:29.823

这就是[BitArray](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.aspx)的用途。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-08T02:06:18.467

也许您可以通过使用转换表来获得最大性能。然后应用下面的算法：

对不起，我不再流利地使用 VB，所以我将不得不编写 C#。这是整个代码的一部分，因为整个 lookupTable 将有 256 个项目。

```
using System.Collections.Generic;

class Program
{
    static void Main(string[] args)
    {
        var input = new byte[] { 0x5A /*01011010b*/, 0xE4 /*11100100b*/ };
        var output = new List<int>();
        var lookupTable = new int[][] { new int[0] /*00000000b*/
                                           , new int[] { 8 }    /*00000001b*/
                                           , new int[] { 7 }    /*00000010b*/
                                           , new int[] { 7,8 }  /*00000011b*/
                                           , new int[] { 6 }    /*00000100b*/
                                           , new int[] { 6,8 }  /*00000101b*/
                                           , new int[] { 6,7,8 }  /*00000111b*/
                                          };
        int offset = 0;
        foreach (var value in input)
        {
            foreach (var position in lookupTable[(int)value])
            {
                output.Add(position + offset);
            }
            offset += 8;
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-08T02:12:41.123

如果很容易生成一个略大于数组长度的素数（取决于它的大小，这可能会也可能不会容易），并且您不关心完全均匀随机，那么您可以生成一个随机数该范围内的数字并生成该循环。它应该在几次迭代中找到答案（基于 1s 的密度）。c# 中的源代码，因为我不记得 vb 语法：

```
int RandomInArray(int[] ar)
{
    int p = GenerateSlightlyLargerPrime(ar.Length);

    int x = random.nextInt(p);
    int i = x;
    do
    {
       if (i < ar.Length && ar[i] == 1)
           return i;
       i = (i + x) % p;
    } while (i != x);
    return -1;
} 
```

请注意，这不是 100% 均匀随机的，但应该相当接近。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-08T04:08:12.670

我尝试了不同的方法。这个想法是在找到对应于 1 的条目时不断获得随机条目并退出。这个解决方案并不完美，因为没有使用一些随机数，这可能会或可能不会破坏随机性。此外，速度很大程度上取决于“1”的密度。代码如下：

```
public static int GetRandomSetBit(int[] AllBits)
{
    int L = AllBits.Length;
    Random r = new Random();    // Better use a global instance as this hurt performance a lot
    do
    {
         selected = r.Next(L);

    } while (AllBits[selected] == 0);
    return selected;
} 
```

在我的 PC 中，如果将 Random 对象的创建移到全局中，如果 30 个中有 5 个“1”，它可以在大约 11 秒内运行 50000000 次试验。如果最多有 15 个“1”，它的时间时间缩短到 5 秒左右。

与 Vilx 建议的代码相比，他的代码可以在 13 秒左右在我的 PC 上运行 50000000 次试验

# sql - 数据库表重构

> ID：422751
> 
> 赞同：0
> 
> 时间：2009-01-08T00:24:43.790
> 
> 标签：sql, sql-server, database, nhibernate

您好我正在使用 ms2005 作为一个简单的日历系统。我们有三个“旧”表：Groups、Units 和 Staff。

我需要为表中的每条记录提供一个唯一标识符（包含所有 3 个表）。

解决这个问题的最佳方法是什么？我正在使用 NHibernate 并且想知道这是否可以为我做。

无论如何，对正确方向的任何点头表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T00:27:42.457

通常的做法是使用带有 IDENTITY(1,1) 的 int 在每个表上创建代理主键。

如果您需要跨系统的唯一值，请使用 UNIQUEIDENTIFIER 列 (GUID)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T00:32:26.007

你是说同一个标识符不应该出现在一个以上的表中吗？这将是一个可疑的断言，表明需要进行更多讨论。

从重构的意义上说，这将是一种“难闻的气味”。

# .net - .net 2.0 和 3.5 会并排运行吗？

> ID：422767
> 
> 赞同：7
> 
> 时间：2009-01-08T00:30:29.393
> 
> 标签：.net, configuration

我们是一家开发商店，仍然在 .net 2.0 中进行大部分开发。我们开始考虑使用 3.5 中的一些新东西（LINQ 等），我们正在研究其他一些需要 WPF 的软件包等等。

我们希望在我们的测试服务器上启动并运行 3.5，但不会破坏我们已经运行的任何 2.0 站点（我们希望它们继续在 2.0 下运行）。有没有我应该知道的隐藏问题，或者我可以在我们的 Server 2003 机器上安装 3.5 就可以了？

（具体的担忧是，尽管微软声称 .net 2.0 组件在 3.5 中是相同的，但它们实际上改变了一些打破游戏规则的东西。）

更新：在每个人的评论和其他阅读的支持下，我们决定硬着头皮在服务器上安装 3.5，“只是为了看看会发生什么。”

在运行安装程序时，我们发现（令我们惊讶的是）.net 3.5 早在 8 月就已安装 - 我们都不知道。

实际上，这是您所要求的无缝升级。

谢谢大家！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-08T00:32:40.187

2.0 将与 3.5 配合得很好。.NET 3.5 实际上只是在 2.0 之上添加了一些额外的类，所以一切都是兼容的。我将一堆项目从 2.0 迁移到 3.5，一切都迁移得非常顺利，只需要重新编译。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-08T01:27:48.203

.Net 3.5 本质上是一组与 2.0 库并行运行的附加程序集。任何现有的 2.0 库都没有发生任何重大更改。您可以直接将所有 2.0 应用程序转换为 3.5，而不会出现任何问题。这包括在 3.5 框架上运行 2.0 应用程序。对 2.0 进行了一些优化和错误修复，但所有公共接口保持不变。这适用于所有命名空间，包括 System.Web。

在 3.0 和 3.5 版本的框架中添加了很多新功能，例如 WPF、实体框架和其他几个“框架”。类被添加到现有的命名空间中，但它们实际上存在于单独的 dll 中。

[FryGuy](https://stackoverflow.com/users/28776/fryguy)指出的一件事需要注意：

> 安装 3.5 SP1 时要小心，因为它还安装了 2.0 SP2，它增加了一些额外的功能。这很好，除了 Visual Studio 将使用 IntelliSense 并且一切都可以正常编译并在开发人员机器上运行良好，但在“仅”2.0 的计算机上完全失败并出现一个模糊的错误。
> 
> 这方面的一个示例是方法 ManualResetEvent.WaitOne。SP1 添加了重载 WaitOne(int)，而没有它，您需要调用 WaitOne(int, false)。

正如[CMS](https://stackoverflow.com/users/5445/cms)从[4GuysFromRolla](http://www.4guysfromrolla.com)发布的那样：

[![.NET Frameworks 的附加版本](https://i.stack.imgur.com/BAZeW.gif)](https://i.stack.imgur.com/BAZeW.gif)
[（来源：[4guysfromrolla.com](http://aspnet.4guysfromrolla.com/images/NewIn35.gif)）]

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T01:41:59.610

是的，但有一个警告。

安装 3.5 SP1 时要小心，因为它还安装了 2.0 SP2，它增加了一些额外的功能。这很好，除了 Visual Studio 将使用 IntelliSense 并且一切都可以正常编译并在开发人员机器上运行良好，但在“仅”2.0 的计算机上完全失败并出现一个模糊的错误。

这方面的一个示例是方法 ManualResetEvent.WaitOne。SP1 添加了重载 WaitOne(int)，而没有它，您需要调用 WaitOne(int, false)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T00:31:43.057

3.5 是 2.0 的扩展。没有 2.0 就没有 3.5。它实际上是一个不同的 dll (Core.dll)。这与从 1.1 到 2.0 的转变不同；如果您的旧站点不引用新的 dll，那么这些站点不会被任何更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T00:33:39.217

补充一点，.NET 版本旨在协同工作，而不仅仅是 2.0/3.0/3.5 的东西。您也可以同时运行 1.1，它会很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T01:34:55.037

在过去的几年里，我在两个非常大的系统上完成了这项工作，并且在任何一种情况下都绝对没有问题。3.5 在 2.0 运行时之上运行。

3.0 真的应该是 2.1，而 3.5 应该是 2.5。如果这有帮助的话。3.0 和 3.5 实际上只是对 2.0 的功能扩展，不包括它们自己的运行时。2.0 的服务包版本是对 2.0 进行更改的地方。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-08T01:44:03.850

除了提供的所有答案，并且由于您必须将工作置于危险之中，您应该先在测试服务器中尝试，然后再部署到生产服务器中。

根据我的经验，我们在 Web 服务器上升级到 .NET 3.5 没有问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-08T01:46:31.627

正如所有人所说，你不会有任何问题：

[![.NET Frameworks 的附加版本](https://i.stack.imgur.com/Nx0rS.gif)](https://i.stack.imgur.com/Nx0rS.gif)
[（来源：[4guysfromrolla.com](http://aspnet.4guysfromrolla.com/images/NewIn35.gif)）]

:-)

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-01-08T00:44:45.327

你不能。它可能会起作用，但是 3.5 替换了某些 2.0 部分，因此您需要进行回归测试。

[编辑]如果您不喜欢答案，请不要投反对票。

我在 TechEd 专门问了这个问题。保持相同的 API 并不意味着实现的行为相同。当时，演讲者的反应是：性能改进（没有细节）。

重复我自己，因为它似乎没有注册：API 是相同的，实现是不同的（您可以在评论中的 Hanselman 链接中看到）。Micah，你似乎不知道你在说什么。

# c# - 调试期间在 Visual Studio 中自动附加到子进程

> ID：422768
> 
> 赞同：36
> 
> 时间：2009-01-08T00:30:30.503
> 
> 标签：c#, .net, visual-studio, debugging, visual-studio-debugging

为媒体中心编写插件时，您的插件托管在`ehexthost.exe`此 exe 中`ehshell.exe`，您无法直接启动它，而是传递一个特殊参数，`ehshell.exe`该参数将在单独的进程中启动插件。

当我们调试[媒体浏览器](http://code.google.com/p/videobrowser/source/checkout)时，我发现附加到第二个进程的过程有点笨拙，我知道 Debugger.Attach 以及我可以使用的一些[特殊注册表项。](http://msdn.microsoft.com/en-us/library/a329t4ed.aspx)

这两种方法都不完全符合我的要求。我想要的是按 F5 并让我当前的 Visual Studio 实例自动附加到子进程。这可以做到吗？

如果 VS 有一个插件可以让我实现这个功能，我会很高兴的。

**编辑**

我最终使用了以下宏：

```
Public Sub CompileRunAndAttachToEhExtHost()

    DTE.Solution.SolutionBuild.Build(True)
    DTE.Solution.SolutionBuild.Debug()

    Dim trd As System.Threading.Thread = New System.Threading.Thread(AddressOf AttachToEhExtHost)
    trd.Start()

End Sub

Public Sub AttachToEhExtHost()
    Dim i As Integer = 0
    Do Until i = 50
        i = i + 1
        Try

            For Each proc As EnvDTE.Process In DTE.Debugger.LocalProcesses
                If (proc.Name.IndexOf("ehexthost.exe") <> -1) Then
                    proc.Attach()
                    Exit Sub
                End If
            Next
        Catch e As Exception
            ' dont care - stuff may be busy 
        End Try
        Threading.Thread.Sleep(100)
    Loop
End Sub 
```

另外，我在我的博客 上概述了如何实现[这一点的过程。](http://www.samsaffron.com/archive/2009/01/28/Simpler+debugging+of+Vista+Media+Center+plugins)

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-01-27T15:19:19.220

我会使用宏。我重新定义了我的 F5 函数以附加到 asp.net 进程，而不是它通常执行的长时间构建/验证。这对我来说效果很好，而且真的很容易。

```
 For Each process In DTE.Debugger.LocalProcesses
        If (process.Name.IndexOf("aspnet_wp.exe") <> -1) Then
            process.Attach()
            Exit Sub
        End If
    Next 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-11-26T02:49:27.003

对于 VS2012，宏已被删除，但您仍然可以使用标准键盘快捷键快速完成。例如，要附加到 iisexpress.exe：

`Ctrl`+ `Alt`+ `p`- 显示附加到进程对话框

`i`- 跳转到列表中以 i 开头的第一个进程（对我来说这是 iisexpress.exe）

`Enter`- 附上

为了超级速度，您还可以[在调试 IIS 时关闭 Visual Studio 附加安全警告](https://stackoverflow.com/questions/1414769/turn-off-visual-studio-attach-security-warning-when-debugging-iis)。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-27T11:26:09.113

查看我编写的名为[Lazy](http://www.codeplex.com/lazy)的 VisualStudio 插件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-15T17:34:31.727

我在一个外部生成的进程中调试了一个 C++ 插件，该进程在启动时抛出异常而崩溃，这对我来说非常有效：

添加免费的[Reattach Extension for Visual Studio](https://visualstudiogallery.msdn.microsoft.com/8cccc206-b9de-42ef-8f5a-160ad0f017ae)。要求它在启动之前重新附加到进程名称。它将弹出一个模式对话框，说明它正在等待进程名称启动。

现在启动该进程，Visual Studio 调试器将立即附加，捕获异常并命中断点。

（这也在媒体插件中，异常通常在 Delphi 上下文中被主机进程捕获并重新抛出，因此我需要在此之前中断）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T00:51:47.153

如果您在 Visual Studio 中设置了类似的设置，则可以通过按 F5 自动附加到进程：

[http://vvcap.net/db/ujYL7zeN_n_RgeprqCSM.htp](http://vvcap.net/db/ujYL7zeN_n_RgeprqCSM.htp)

注意：“Command”填写为可执行文件名，“Attach”必须为“yes”

# c++ - C ++如何获得返回引用并将引用保存为函数中的局部变量？

> ID：422774
> 
> 赞同：2
> 
> 时间：2009-01-08T00:32:16.473
> 
> 标签：c++, pointers, reference

我在一个类中有一个函数，它返回对成员变量的引用。

```
std::vector<uint8> & getBuffer() const
{
   return m_myBuffer;
} 
```

现在说在另一个类中我调用这个方法：

```
int someFunction()
{
   std::vector<uint8> myFileBuffer = myFile.getBuffer();
} 
```

此行调用vector 的复制构造函数并使我成为本地缓冲区。我不想要这个，我该如何设置 myFileBuffer 来引用 myFile.getBuffer()。

我知道我可以通过指针来做到这一点，但如果可能的话，我想使用引用。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T00:43:02.457

请注意，由于您的成员方法是 const ，因此您应该返回一个 const 引用。

```
// Note the extra const on this line.
std::vector<uint8> const& getBuffer() const
{
    return m_myBuffer;
} 
```

因此，要通过引用使用返回值，请执行以下操作：

```
std::vector<uint8> const& myFileBuffer = myFile.getBuffer(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T00:36:07.387

将您的局部变量声明为引用类型而不是值类型，即像这样......

```
std::vector<uint8>& myFileBuffer = myFile.getBuffer(); 
```

...而不是像这样...

```
std::vector<uint8> myFileBuffer = myFile.getBuffer(); 
```

# asp.net - 在 Telerik RadGrid（服务器端）中访问行数据

> ID：422783
> 
> 赞同：9
> 
> 时间：2009-01-08T00:36:26.903
> 
> 标签：asp.net, telerik

我使用 Javascript 读取 Telerik radgrid 组件的行没有问题，但我似乎可以在回发发生时找到访问行数据服务器端的方法。我花了很长时间寻找解决方案，但没有运气。任何指针将不胜感激。

托尼

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-08T04:58:26.857

您可能想查看 OwnerTableView 对象的[DataKeyValues](http://www.telerik.com/help/aspnet/grid/radgrid-telerik.webcontrols.gridtableview-datakeyvalues.html)属性，它可以让您访问表示给定行中的字段的值的集合。我在 EditCommand 事件处理程序期间使用它，因为如果我的站点用户单击链接以编辑网格中的一行，他们将被定向到编辑页面，并且我需要传递有关查询中给定行的某些信息细绳。

如果事实证明这是您所需要的，您还需要定义哪些字段应通过此属性可用。为此，请查看网格属性表中的 MasterTableView.DataKeyNames 属性。您基本上指定了一个以逗号分隔的字段名称列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T21:50:57.417

服务器端是简单的部分：

```
GridItemCollection gridRows = TestGrid.Items;
foreach (GridDataItem data in gridRows)
{
    ItemClass obj = (ItemClass)data.DataItem;
} 
```

这是我不知道的客户端部分！:[

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-21T23:43:04.497

```
private Int32 GetID()
{
    foreach (Telerik.Web.UI.GridDataItem dataItem in radGrid.MasterTableView.Items)
    {
        if (dataItem.Selected == true)
        {
            Int32 ID = (Int32)dataItem.GetDataKeyValue("ID");
            return ID;
        }
    }
    throw new ArgumentNullException("Id Not found");
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-12T20:37:32.460

这是对我有用并使用 RadGrid.SelectedItems 集合的那个。

```
protected void LinkButton1_Click(object sender, EventArgs e)
    {
        List<Guid> OrderIdList = new List<Guid>();

        foreach (GridDataItem OrderItem in this.RadGrid1.SelectedItems)
        {
            OrderIdList.Add(new Guid(OrderItem.GetDataKeyValue("OrderId").ToString()));
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-16T23:34:48.950

如果您在标记或页面初始化中为动态控件正确创建了控件，则 RadGrid 将正确恢复状态。

您可以像下面的示例一样访问从数据源加载的初始值，前提是您告诉有问题的表视图将列保留在数据键中。

```
protected T GetInitialGridData<T>(GridDataItem item, string uniqueColumnName) {
   item.ThrowIfNull("item");
   uniqueColumnName.ThrowIfNullOrEmpty("uniqueColumnName");

   return (T)item.OwnerTableView.DataKeyValues(gridItem.ItemIndex)(columnName);
} 
```

如果您使用的是动态自定义模板列，并且需要获取现在可能处于其状态的任何值，则可以使用：

```
protected string GetCustomTextBoxValue(GridDataItem item, string controlID) {
   item.ThrowIfNull("item");
   controlID.ThrowIfNullOrTrimmedEmpty("controlID");

   return ((TextBox)item.FindControl(controlID)).Text;
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-06-04T07:47:57.433

```
private Int32 GetID()
{
    foreach (Telerik.Web.UI.GridDataItem dataItem in radGrid.MasterTableView.Items)
    {
        if (dataItem.Selected == true)
        {
           // Int32 ID = (Int32)dataItem.GetDataKeyValue("ID");
Int32 ID =Convert.ToInt32(dataItem.GetDataKeyValue("ID"));
            return ID;
        }
    }

}
//this will work 
```

# flash - 如何解决 ActionScript 3 (AS3) 中的关闭问题

> ID：422784
> 
> 赞同：25
> 
> 时间：2009-01-08T00:37:02.470
> 
> 标签：flash, apache-flex, actionscript-3, closures

在下面的代码中，我试图加载一些图像，并在它们单独加载后立即将它们放在舞台上。但它是错误的，因为只显示最后一张图像。我怀疑这是一个关闭问题。我该如何解决？AS3 中的闭包行为与 Java Script 中的行为不一样吗？

```
var imageList:Array = new Array();
imageList.push({'src':'image1.jpg'});
imageList.push({'src':'image2.jpg'});
var imagePanel:MovieClip = new MovieClip();
this.addChildAt(imagePanel, 0);

for (var i in imageList) {
    var imageData = imageList[i];
    imageData.loader = new Loader();

    imageData.loader.contentLoaderInfo.addEventListener(
        Event.COMPLETE, 
        function() {
            imagePanel.addChild(imageData.loader.content as Bitmap);
            trace('Completed: ' + imageData.src);             
        });

    trace('Starting: ' + imageData.src);
    imageData.loader.load(new URLRequest(imageData.src));   
} 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-08T02:43:50.077

> AS3 中的闭包行为与 Java Script 中的行为不一样吗？

是的，JavaScript 做同样的事情。和 Python 一样。和别的。

尽管您在“for”中定义了“var imageData”，但 for 循环不会在这些语言中引入新的范围；实际上，变量 imageData 绑定在包含范围内（外部函数，或者在这种情况下，它似乎是全局范围）。您可以通过在循环完成执行后查看 imageData 并在其中找到 imageList 的最后一个元素来验证这一点。

所以只有一个 imageData 变量，而不是循环的每次迭代都有一个。当 COMPLETE 触发时，它进入闭包并读取 imageData *now*具有的任何值，而不是在定义函数时（*）。通常，for 循环将在 COMPLETE 触发点完成，并且 imageData 将保存最后一次迭代中的最后一个元素。

（* - 存在“早期绑定”语言，它们*将*在您定义闭包时评估变量的值。但 ActionScript 不是其中之一。）

可能的解决方案往往涉及使用外部函数来引入新范围。例如：

```
function makeCallback(imageData) { return function() {
    imagePanel.addChild(imageData.loader.content as Bitmap);
    trace('Completed: ' + imageData.src);                                                                                                     
} }
...
imageData.loader.contentLoaderInfo.addEventListener(Event.COMPLETE, makeCallback(imageData)); 
```

你/可以/把这个内联，但是双重嵌套的 function() 开始变得更难阅读。

另请参阅 Function.bind() 以获得可用于实现此目的的通用部分函数应用程序功能。它很可能成为未来 JavaScript/ActionScript 版本的一部分，同时可以通过原型设计添加到语言中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-10-19T19:08:35.717

在 Array 类上使用更实用的 forEach 方法可以避免这个问题。这已经提到过，但我会在这里展开。

```
imageList.forEach( function ( item:MovieClip, index:int, list:Array) {
    // add your listener with closure here
}) 
```

使用此方法，传递给 forEach 的函数在每次迭代时定义一个新范围。现在您可以在此范围内添加一个闭包，它会根据需要记住每个实例。

在相关说明中：

一直输入这 3 个参数是一件很痛苦的事情，所以......您还可以使用适配器函数使其变得更少/更难看：

```
// just give me the item please
imageList.forEach ( itrAdpt( function ( image: ImageData ) {
    // add your listener with closure here
}))

// give me the item and it's index
imageList.forEach ( itrAdpt( function ( image: ImageData, index:int ) {
    // add your listener with closure here
}))

// give me the item, index and total list length
imageList.forEach ( itrAdpt( function ( image: ImageData, index:int, length:int ) {
    // add your listener with closure here
})) 
```

其中 itrAdpt 是一个（可能是全局的）函数，定义如下：

```
public function itrAdpt(f: Function): Function
{
    var argAmount:int = f.length

    if (argAmount == 0)
    {
        return function (element:*, index:int, colection:*):* {
            return f(element)
        }
    }
    else if (argAmount == 1)
    {
        return function (element:*, index:int, colection:*):* {
            return f(element)
        }
    }
    else if (argAmount == 2)
    {
        return function (element:*, index:int, colection:*):* {
            return f(element, index)
        }
    }
    else if (argAmount == 3)
    {
        return function (element:*, index:int, colection:*):* {
            return f(element, index, colection.length)
        }
    }
    else
    {
        throw new Error("Don't know what to do with "+argAmount+"arguments. Supplied function should have between 1-3 arguments")
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-13T10:19:13.660

```
(function() {
  var imageData = imageList[i];
  imageData.loader.contentLoaderInfo.addEventListener(Event.COMPLETE, function() {
    // use imageData;
  });
}).apply(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-01T17:15:25.003

如果创建命名函数对您没有吸引力，bobince 的答案可以转换为此而不会牺牲可读性：

```
var makeCallback = function(imageData:String) 
  { 
    return function(evt:Event) 
    {
      imagePanel.addChild(imageData.loader.content as Bitmap);
      trace('Completed: ' +  imageData.src);
    } 
  }

...

imageData.loader.contentLoaderInfo.addEventListener(Event.COMPLETE, makeCallback(imageData)); 
```

只是我的偏好，您的里程可能会有所不同。

# c# - 使用 WCF 为托管 Windows 服务生成 App.Config 文件

> ID：422787
> 
> 赞同：0
> 
> 时间：2009-01-08T00:37:37.773
> 
> 标签：c#, wcf

我的下一个项目将使用 Windows Communication Foundation 来托管托管 Windows 服务，因此我一直在尝试遵循 msdn 上的 HOWTO - [How to: Host a WCF Service in a Managed Windows Service](http://msdn.microsoft.com/en-us/library/ms733069.aspx)。听上去是绝配。

一切都很好，直到它开始提到一个 App.Config 文件，但没有首先概述它是如何生成的。

正如我在那里发布的那样，可能有一些假设的先验知识（可能来自另一个教程），但经过一番搜索后我找不到答案。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T00:44:13.377

你是在说#5 吗？app.config 文件由您生成。您可以通过右键单击项目并选择添加新的配置文件，将项目添加到 VS.NET 中的项目中。然后，您可以按照步骤所示添加部分。

# .net - Passing focus of child element in a UserControl to parent in WPF

> ID：422798
> 
> 赞同：11
> 
> 时间：2009-01-08T00:42:30.087
> 
> 标签：.net, wpf, xaml

I have a complex WPF UserControl made of other ContentControl templates which contain sets of buttons, textfields, and other elements.

The parent UC is focusable so I have a style with a property trigger to update (gratuitous OuterGlowBitmapEffect) when the UC has focus. However when the user clicks or tabs to any of the buttons inside the UC the focus is lost. I would like to maintain the glow while using the UC.

Can I pass the focus from the child controls up to the UC?

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-08T01:03:08.877

You should be able to base your property trigger on the [IsKeyboardFocusWithin](http://msdn.microsoft.com/en-us/library/system.windows.uielement.iskeyboardfocuswithin.aspx) property, which returns true if any child element has focus.

# windows - 在 Win XP 64 位上，无法连接到 XAMPP 下的本地 apache 安装。帮助！

> ID：422803
> 
> 赞同：2
> 
> 时间：2009-01-08T00:43:46.123
> 
> 标签：windows, apache, 64-bit, xampp

我在 Win XP-64 位机器上使用 XAMPP v1.7，我的 Symantec AV 和我的 Windows 防火墙一样被关闭，我无法从浏览器连接到 localhost。

我最初有这些错误：
[Wed Jan 07 16:24:55 2009] [error] (OS 10038) 尝试对不是套接字的东西进行操作。: Child 2716: 在接受客户端连接时遇到太多错误。可能原因：动态地址更新，或不兼容的 VPN 或防火墙软件。尝试使用 Win32DisableAcceptEx 指令

在我将 Win32DisableAcceptEx 指令添加到 httpd.conf 后，这些错误消失了，但最终结果保持不变：没有乐趣。

现在，我收到这些错误：
[Wed Jan 07 16:40:15 2009] [notice] Apache/2.2.11 (Win32) DAV/2 mod_ssl/2.2.11
OpenSSL/0.9.8i mod_autoindex_color PHP/5.2.8 已配置 - - 恢复正常操作
[Wed Jan 07 16:40:15 2009] [notice] 服务器建立：Dec 10 2008 00:10:06
[Wed Jan 07 16:40:15 2009] [notice] Parent: Created child process 5916
[ 2009 年 1 月 7 日星期三 16:40:15] [通知] 已禁用 AcceptEx() WinSock2 API
[2009 年 1 月 7 日星期三 16:40:15] [通知] 摘要：为摘要身份验证生成秘密
... [16 年 1 月 7 日星期三:40:15 2009] [notice] 摘要：完成
[Wed Jan 07 16:40:15 2009] [notice] Child 5916：子进程正在运行
[Wed Jan 07 16:40:15 2009] [notice] Child 5916：获得了启动互斥锁。
[Wed Jan 07 16:40:15 2009] [notice] Child 5916：启动 250 个工作线程。
[2009 年 1 月 7 日星期三 16:40:15] [通知]子 5916：在端口 443 上侦听。
[2009 年 1 月 7 日星期三 16:40:15] [通知]子 5916：在端口 80 上侦听。
[1 月 7 日星期三： 2009 年 40:15] [错误] (OS 10038) 尝试对
不是套接字的东西进行操作。: 选择循环中的错误太多。子进程退出。
[Wed Jan 07 16:40:15 2009] [notice] Child 5916：退出事件发出信号。子进程正在结束。
[2009 年 1 月 7 日星期三 16:40:16] [通知] 子 5916：释放了启动互斥体
[2009 年 1 月 7 日星期三 16:40:17] [通知] 子 5916：所有工作线程都已退出。
[Wed Jan 07 16:40:17 2009] [notice] Child 5916: Child process is exiting
[Wed Jan 07 16:40:17 2009] [notice] 父进程：子进程以状态 0 退出——正在重新启动。
[2009 年 1 月 7 日星期三 16:40:17] [通知] 摘要：为摘要身份验证生成秘密 ...
[2009 年 1 月 7 日星期三 16:40:17] [通知] 摘要：完成

而且，apache 似乎正在崩溃（Windows 告诉我，我可以在系统事件中看到崩溃。）

我是apache的n00b，但需要让它运行。想法？马库斯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-20T00:06:57.670

如果有人遇到这种情况，请尝试运行

netsh winsock RESET

从命令行。它对我有用。

# c# - C# 套接字异常延迟

> ID：422809
> 
> 赞同：1
> 
> 时间：2009-01-08T00:47:09.003
> 
> 标签：c#, sockets, latency

我正在使用 C# 和 XNA 开发一个小型在线多人乒乓球游戏。

我使用套接字在我的个人 LAN 上的两台计算机之间传输数据。它工作正常。

问题在于速度：传输速度很慢。

当我 ping 第二台计算机时，它显示 2 毫秒的延迟。我在我的代码中设置了一个小计时器，它显示大约 200 毫秒的延迟。即使服务器和客户端在同一台计算机上（使用 127.0.0.1），延迟仍然在 15 毫秒左右。我认为这很慢。

这是我的代码的一些片段：

```
server = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
server.Bind(new IPEndPoint(IPAddress.Any, port));
server.Listen(1);
// Begin Accept
server.BeginAccept(new AsyncCallback(ClientAccepted), null); 
```

在 ClientAccepted 中，我设置了一个 NetworkStream、一个 StreamReader 和一个 StreamWriter。当我想更新玩家的位置时，这就是我发送消息的方式：

```
string message = "P" + "\n" + player.Position + "\n";
byte[] data = Encoding.ASCII.GetBytes(message);
ns.BeginWrite(data, 0, data.Length, new AsyncCallback(EndUpdate), null); 
```

EndUpdate 唯一要做的就是调用 EndWrite。这就是我接收数据的方式：

```
message = sr.ReadLine(); 
```

它不会阻止我的游戏，因为它在第二个线程上。

这些是我尝试过的东西： - 使用 IP 而不是 TCP - 使用二进制消息而不是文本 - 使用 IPv6 而不是 IPv4 没有任何帮助。

关于如何改善延迟的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-08T01:04:25.927

您看到的延迟很可能是由于[Nagle 的算法](http://en.wikipedia.org/wiki/Nagles_algorithm)，该算法用于在使用 TCP 发送大量小数据包时提高效率。本质上，TCP 堆栈将小数据包收集在一起，并在传输之前将它们合并成一个更大的数据包。这显然意味着在发送输出缓冲区中等待的内容之前延迟一小段时间 - 最多 200 毫秒 - 以查看是否发送了更多数据。

[因此，尝试通过在套接字上将 NoDelay](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.nodelay.aspx)属性设置为 true 来关闭 Nagle 。

但是，请注意，如果您对套接字进行大量小型写入，则可能会因为 TCP 标头开销和每个数据包的处理而降低性能。在这种情况下，如果可能的话，您会想尝试将您的写入分批收集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T00:54:29.330

大多数网络游戏不使用 TCP 而是使用 UDP 进行通信。这样做的问题是数据很容易被丢弃，这是你必须考虑的事情。

使用 TCP，主机/服务器之间有许多交互来保证数据以有序的方式（使用 UDP 时您必须考虑的另一件事，即数据没有排序的事实）。

最重要的是，您代码中的计时器必须等到字节从非托管套接字层通过非托管代码等冒泡，等等。那里会有一些您无法克服的开销（非托管到托管的过渡）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T01:07:50.817

还有其他几个元问题需要考虑：

1.  计时器精度：许多系统计时器仅每 15 毫秒左右更新一次。我不记得确切的值，但是如果您的时间总是大约 15 毫秒的倍数，请怀疑您的计时器精度不高。这“可能”不是您的问题，但请记住。

2.  如果您在同一台计算机上进行测试，并且只运行单核机器，则线程/进程切换频率将支配您的 ping 时间。没什么可做的，只是尝试添加 Sleep(0) 调用以在发送数据后允许线程/进程交换。

3.  TCP/IP 传输设置。正如前面在 SocketOptionName.NoDelay 中提到的。同样如前所述，如果您不断更新状态，请考虑使用 UDP。不能保证顺序，但是对于易失性数据，丢失数据包是可以接受的，因为无论如何状态都会很快被覆盖。为避免使用过时的数据包，请向数据包添加一个递增值，并且永远不要使用标记早于当前状态的数据包。tcp 和 udp 之间的差异不应占 200 ms，但其他因素的组合可以。

4.  轮询与选择。如果您正在轮询接收到的数据，那么轮询频率自然会干扰接收速率。我在一个专门的网络线程中使用 Socket.Select 来等待传入的数据并尽快处理它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T00:59:43.267

您说您尝试了“IP”，并且您可能通过指定 ProtocolType.Ip 来做到这一点，但我不知道这真正意味着什么（即我不知道在“幕后”选择了什么协议）使用 SocketType.Stream。

正如 casperOne 所说，如果您使用的是 TCP，请查看设置 SocketOptionName.NoDelay 是否对您有任何影响。

# iis-6 - 以编程方式配置 IIS 6 网站 SSL 端口？

> ID：422812
> 
> 赞同：5
> 
> 时间：2009-01-08T00:49:16.143
> 
> 标签：iis-6

我正在尝试以编程方式为 IIS 6.0 中的网站配置网站 SSL 端口。

IIS 7.0 提供了 API ServerManager 来执行此操作，但我不确定 IIS 6.0 或命令行实用程序是否有类似的东西。

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-08T04:19:56.420

如果您的意思只是以编程方式设置端口号，您可以使用元数据库命令行工具（默认情况下在 C:\Inetpub\AdminScripts 中）：

```
cscript adsutil.vbs set w3svc/1/securebindings ":nnn:" 
```

其中 nnn 是端口号（例如，“:443:”）。（如果服务器上有多个站点，则需要替换 w3svc/x/securebindings，其中 x 是网站 ID。）

如果您确实需要以编程方式安装 CERTIFICATE，据我所知，[IIS 6.0 Resource Kit](http://www.microsoft.com/downloads/details.aspx?familyid=56FC92EE-A71A-4C73-B628-ADE629C89499&displaylang=en)中有一个脚本可以执行此操作（IISCertDeploy.vbs），但我没有尝试过。

# php - 在 MySQL 中是否可以只更新第 n 次出现？

> ID：422828
> 
> 赞同：0
> 
> 时间：2009-01-08T00:58:43.877
> 
> 标签：php, mysql

我的表有这样的数据

```
 products_parent_id | products_quantity
        2               5
        2               7
        2               9
        2               4 
```

我的 SQL 语句看起来像这样（到目前为止）：

```
UPDATE ' . TABLE_PRODUCTS . ' SET products_quantity = products_quantity +' . $order['products_quantity'] . ', products_ordered = products_ordered - ' . $order['products_quantity'] . ' WHERE products_parent_id = ' . (int)$order['products_id'] 
```

现在我想做的是更新只说 products_parent_id 的第 3 次出现（在这种情况下，从顶部开始的第 3 次是 9）

为了选择第 3 次出现，我在语句 LIMIT($grade, 1) 的末尾使用了它

有没有办法使用 MySQL 更新但只有第 3/4/etc 发生？会可靠吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T01:42:29.513

简短的回答：没有

长答案：

有点。因为返回行的顺序不是由 SQL 定义的。
从技术上讲，对数据库的两个不同请求可能会以不同的顺序返回行。因此，即使您更新第三行，也就是第三行，也将取决于实现。

减轻这种情况的唯一方法是对行应用特定的排序。（订购者）

我不认为它是语言规范的一部分，但大多数 SQL 实现允许您从查询中获取特定行。我不确定 MYSQL 的具体细节是什么，但一个快速的谷歌得到了这个页面：

[http://forums.mysql.com/read.php?10,36490,36511](http://forums.mysql.com/read.php?10,36490,36511)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-10T10:27:57.357

您的问题并没有完全清楚地说明您进行此更新的原因，但它确实让我想起了我何时在数据库表中生成示例条目并希望将其中一些条目移至 A 类或 B 类。

您的 SQL 查询未指定 ORDER BY，因此 Martin 的回答是正确的，即您可能不会每次都获得相同的结果顺序。但是，如果您的 ORDER BY 基于特定 ID，并且该 ID 是连续的，您将能够使用[模数](http://en.wikipedia.org/wiki/Modulo_operation)来访问每三个记录。

例如：

```
mysql> create table foo ( id int ) ;
Query OK, 0 rows affected (0.01 sec)

mysql> insert into foo values (1), (2), (3), (4), (5), (6), (7), (8), (9), (10), (11), (15) ;
Query OK, 12 rows affected (0.00 sec)
Records: 12  Duplicates: 0  Warnings: 0

mysql> select * from foo where id%3=0;
+------+
| id   |
+------+
|    3 | 
|    6 | 
|    9 | 
|   15 | 
+------+
4 rows in set (0.00 sec) 
```

如果该方法适合您，您可以使用更新来命中每三个条目

```
UPDATE [ ... ] WHERE id % 3 = 0 ; 
```

（更新，其中 id / 3 的[余数](http://en.wikipedia.org/wiki/Remainder)为 0）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T01:23:24.700

您也可以在将 UPDATE 与单个表引用一起使用时使用 LIMIT 关键字，但是我自己没有对此进行测试。

资料来源：[MySQL 更新语法](http://dev.mysql.com/doc/refman/5.0/en/update.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T01:32:55.323

您还可以使用记录计数子查询，如

```
 Update Table T Set
     Col = value 
   Where (Select Count(*) From Table 
          Where products_quantity <= T.products_quantity)
          = 3 
```

# c++ - 内存中 C++ 对象的结构与结构

> ID：422830
> 
> 赞同：56
> 
> 时间：2009-01-08T00:59:19.307
> 
> 标签：c++, struct

如果我有如下课程

```
 class Example_Class 
   {
       private:
         int x; 
         int y; 
       public: 
         Example_Class() 
         { 
             x = 8;
             y = 9;
         }
       ~Example_Class() 
       { } 
   }; 
```

结构如下

```
struct
{
   int x;
   int y;
} example_struct; 
```

记忆中的结构 `example_struct`与`Example_Class`

例如，如果我执行以下操作

```
struct example_struct foo_struct;
Example_Class foo_class = Example_Class();

memcpy(&foo_struct, &foo_class, sizeof(foo_struct)); 
```

将`foo_struct.x = 8`和`foo_struct.y = 9`（即：与 foo_class 中的 x,y 值相同的值）？

我问的原因是我有一个 C++ 库（不想更改它），它与 C 代码共享一个对象，我想使用一个结构来表示来自 C++ 库的对象。我只对对象的属性感兴趣。

我知道理想的情况是让 Example_class 围绕 C 和 C++ 代码之间的公共结构进行包装，但要更改正在使用的 C++ 库并不容易。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-01-08T05:30:13.643

C++ 标准*保证*`struct`C和 C++ `class`（或-- 相同的东西）的内存布局`struct`将是相同的，只要 C++ `class`/`struct`符合**POD**（“普通旧数据”）的标准。那么 POD 是什么意思呢？

如果满足以下条件，则类或结构是 POD：

*   所有数据成员都是公共的，它们本身是 POD 或基本类型（但不是引用或指向成员的类型），或此类的数组
*   它没有用户定义的构造函数、赋值运算符或析构函数
*   它没有虚函数
*   它没有基类

关于唯一允许的“C++ 主义”是非虚拟成员函数、静态成员和成员函数。

由于您的类同时具有构造函数和析构函数，因此正式地说不是 POD 类型，因此保证不成立。（尽管正如其他人所提到的，实际上这两种布局在您尝试的任何编译器上都可能是相同的，只要没有虚函数）。

[有关更多详细信息，请参阅C++ FAQ Lite](http://www.dietmar-kuehl.de/mirror/c++-faq/intrinsic-types.html#faq-26.7)的第 [26.7] 节。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-08T01:02:35.180

> example_struct 的内存结构是否与 Example_Class 中的结构相似

该行为无法保证，并且取决于编译器。

话虽如此，答案是“是的，在我的机器上”，前提是 Example_Class 不包含虚拟方法（并且不从基类继承）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-08T01:02:45.990

在您描述的情况下，答案是“可能是”。但是，如果该类有任何虚函数（包括可以从基类继承的虚析构函数），或者使用多重继承，那么类布局可能会有所不同。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-08T01:49:25.350

添加到其他人所说的内容（例如：特定于编译器，只要您没有虚函数就可能会起作用）：

如果你这样做，我强烈建议 sizeof(Example_class) == sizeof(example_struct) 的静态断言（编译时检查）。请参阅 BOOST_STATIC_ASSERT，或等效的编译器特定或自定义构造。如果有人（或某事，例如编译器更改）修改类以使匹配无效，这是一个很好的第一道防线。如果您需要额外检查，您还可以在运行时检查成员的偏移量是否相同，这（与静态大小断言一起）将保证正确性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-12-22T09:06:30.367

在 C++ 编译器的早期，有编译器首先用 class 更改 struct 关键字然后编译的例子。关于相似之处太多了。

差异来自类继承，尤其是虚函数。如果类包含虚函数，那么它必须在其布局的开头有一个指向类型描述符的指针。另外，如果 B 类继承自 A 类，那么 A 类的布局首先出现，然后是 B 类自己的布局。

因此，关于将类实例转换为结构实例的问题的确切答案是：取决于类内容。对于具有方法（构造函数和非虚拟析构函数）的特定类，布局可能是相同的。如果析构函数被声明为虚拟的，那么结构和类之间的布局肯定会变得不同。

这是一篇文章，它表明从 C 结构到 C++ 类不需要做太多工作：[第 1 课 - 从结构到类](http://www.sysexpand.com/?path=ooplessons/lesson01)

这里是解释如何将虚函数表引入具有虚函数的类的文章：[第 4 课 - 多态性](http://www.sysexpand.com/?path=ooplessons/lesson04)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T01:52:40.507

C++ 中的类和结构是等价的，除了结构的所有成员默认情况下都是公共的（类成员默认情况下是私有的）。这可确保在 C++ 编译器中编译遗留 C 代码将按预期工作。

没有什么能阻止您在结构中使用所有花哨的 C++ 功能：

```
struct ReallyAClass
{
    ReallyAClass();
    virtual !ReallAClass();

    /// etc etc etc
}; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T05:43:58.590

当您想将数据传递给 C 时，为什么不将类的成员显式分配给结构？这样你就知道你的代码可以在任何地方工作。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-01-08T06:39:00.587

您可能只是公开或私下从结构派生类。然后强制转换它会在 C++ 代码中正确解析。

# perl - Perl 有 andand 吗？

> ID：422837
> 
> 赞同：4
> 
> 时间：2009-01-08T01:02:40.623
> 
> 标签：perl, andand

我宁愿这样做：

```
say $shop->ShopperDueDate->andand->day_name(); 
```

与这个：

```
say $shop->ShopperDueDate->day_name() if $shop->ShopperDueDate; 
```

有任何想法吗？

（这个想法的灵感来自 Ruby 的[andand](http://andand.rubyforge.org/)扩展。）

（实际上它是受到 Groovy 语言的启发，但大多数人并不知道 ;-)

**更新**：我认为 Maybe() 和 eval {} 都是很好的解决方案。这不是红宝石，所以我不能指望从左到右阅读所有的方法/功能，所以也许肯定会有所帮助。然后当然 eval 确实是 perl 的方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-08T01:32:06.337

您可以使用 Perl 的`eval`语句来捕获异常，包括那些试图在未定义参数上调用方法的异常：

```
eval {
    say $shop->ShopperDueDate->day_name();
}; 
```

由于`eval`返回评估的最后一条语句，或者`undef`失败时，您可以将日期名称记录在变量中，如下所示：

```
my $day_name = eval { $shop->ShopperDueDate->day_name(); }; 
```

如果您确实希望检查异常，可以查看特殊变量`$@`。这通常是 Perl 内置异常的简单字符串，但如果异常源自[autodie](http://search.cpan.org/perldoc?autodie)或其他使用对象异常的代码，则可能是完整的异常对象。

```
eval {
    say $shop->ShopperDueDate->day_name();
};

if ($@) {
    say "The error was: $@";
} 
```

`eval`也可以使用块将一系列命令串在一起。下面将仅检查是否是周末，前提是我们在查找时没有抛出任何异常`$day_name`。

```
eval {
    my $day_name = $shop->ShopperDueDate->day_name();

    if ($day_name ~~ [ 'Saturday', 'Sunday' ] ) {
        say "I like weekends";
    }
}; 
```

您可以认为与其他语言`eval`相同`try`；实际上，如果您使用 CPAN 中的[Error](http://search.cpan.org/perldoc?Error)模块，那么您甚至可以拼写它`try`。还值得注意的是 eval 的块形式（我在上面已经演示过）不会带来性能损失，而是与您的其余代码一起编译。的字符串形式`eval`（我没有显示）完全是一种不同的野兽，应该谨慎使用，如果有的话。

`eval`从技术上讲，它被认为是 Perl 中的一个语句，因此是少数几个在块末尾会看到分号的地方之一。如果您不`eval`经常使用，很容易忘记这些。

*保罗*

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-08T01:32:36.697

我认为你的第二个例子应该更好：

```
say $shop->ShopperDueDate ? $shop->ShopperDueDate->day_name() : undef; 
```

而不是它实际所说的。

无论如何，如果没有源过滤器，您就不能*完全*使用该语法，因为`undef`它不是对象，而是一元运算符，因此它不能有任何方法。

相反，考虑一下：

```
package noop; 
our $maybe = bless [], 'noop';
sub AUTOLOAD { undef }; 
```

这`$noop::maybe`是一个对象；它的所有方法都会返回`undef`。在其他地方，您将拥有这样的常规功能：

```
sub maybe { $_[0] || $noop::maybe; } 
```

然后你可以这样写：

```
say maybe($shop->ShopperDueDate)->day_name() 
```

这是有效的，因为如果“可能”返回为真，则返回其参数，否则返回我们的`$noop::maybe`对象，该对象具有始终返回 undef 的方法。

*编辑*：更正！`->andand->`语法*可以*在没有源过滤器的情况下使用，通过使用与Perl 的内部结构混在一起的[XS 。](http://search.cpan.org/src/CHOCOLATE/autobox-2.55/autobox.xs)[Leon Timmermans](https://stackoverflow.com/questions/422837/is-there-an-andand-for-perl#424902)做了一个采用这条路线的实现。它全局替换了`undef()`函数，所以它可能比我的方法慢很多。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T16:25:07.673

I think I've just written it. I've just uploaded it to CPAN, you can find it [here](http://search.cpan.org/perldoc?Scalar::Andand).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T06:03:09.130

类似（未经测试）：

```
use Object::Generic::False;
sub UNIVERSAL::andand { $_[0] || Object::Generic::False->false } 
```

UNIVERSAL 自动成为所有其他类的子类，因此它为所有对象提供 andand。（显然，在 UNIVERSAL 中创建方法有可能在远处产生冲突或令人惊讶的动作，因此不应随意使用它。）如果调用 andand 方法的对象为 true，则返回它；否则返回一个通用的 false 对象，该对象为对其使用的任何方法调用返回自身。

# c# - C# MouseEventArgs“e.Delta”不工作

> ID：422839
> 
> 赞同：1
> 
> 时间：2009-01-08T01:02:52.807
> 
> 标签：c#, events

您好我有一个 MDI 应用程序，其中子窗口处理许多鼠标事件。一切都没有问题（e.Button、e.Location 等），直到我尝试从 e.Delta（鼠标棘爪数）中获取值。

e.Delta 总是返回 0。

我的事件触发没问题，只是 e.Delta 的值始终为零，而其他一切似乎都有效。

我在我的子窗体中尝试了以下事件：
MouseClick
MouseDown
MouseMove
MouseUp

我什至尝试在主父 MDI 窗口中处理一些鼠标事件，看看它是否有帮助，但结果相同...... e.Delta 始终 = 0。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T01:39:45.433

好吧，除非通过 MouseWheel 事件（我在上面的列表中没有看到），否则该属性可能不会有效。

尝试附加到它，当轮子转动时你应该得到事件。

# linux - 如何在linux下使用命令行将字符串转换为二进制整数文件

> ID：422840
> 
> 赞同：3
> 
> 时间：2009-01-08T01:02:59.827
> 
> 标签：linux, binary, integer

我想要的是取一个表示为字符串的整数，例如“1234”，并将其转换为一个名为 int 的文件，其中包含一个 32 位大端整数，值为 1234。

我想出这样做的唯一方法是

```
echo 1234 | awk '{printf "0: %08X", $1}' | xxd -r > int 
```

这有点讨厌！

有谁知道更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T01:14:16.687

一个稍微简单的方法是：

```
printf "0: %08X" 1234 | xxd -r > int 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T12:34:49.440

好吧，看到马克威廉姆斯似乎已经离开了，我将发布他的答案的更正版本

```
echo 1234 | perl -e 'print pack("N", <STDIN>); > int 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T01:23:18.773

这似乎在我的系统上产生相同的输出。一定要检查`perldoc -f pack`。

`echo '1234' | perl -e 'print pack("nn", 0,<STDIN>);' > int`

# sql - 是否有任何免费工具可以在 MS SQL Server 中生成“INSERT INTO”脚本？

> ID：422847
> 
> 赞同：17
> 
> 时间：2009-01-08T01:05:31.353
> 
> 标签：sql, sql-server

在使用 SQL Server 时，我唯一没有自动化工具的是可以创建`INSERT INTO`脚本的程序。我不是很需要它，所以我不会花钱买它。我只是想知道是否有任何东西可以用来在给定现有数据库的情况下生成 INSERT INTO 脚本而无需花费大量资金。

我已经通过 SQL Server Management Studio Express 进行了搜索，但没有找到这样的功能。如果它存在于 SSMSE 中，那么我从未找到它。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-08T01:11:42.337

这个网站有很多有用的脚本，包括[生成插入](http://vyaskn.tripod.com/code.htm#inserts)。

您可以使用`sp_msforeachtable`它为整个数据库生成。

**更新**：在 SQL Server Management Studio 2008（更高版本）中有将数据脚本化为 INSERT 的内置功能。

**SQL Server 2008**：

在 SSMS 中右键单击您的数据库，选择`Tasks –&gt; Generate Scripts`，确保您的数据库突出显示，然后单击下一步。向下滚动选项列表到“表/视图选项”部分，并将“脚本数据”更改为 True。

![在此处输入图像描述](https://i.stack.imgur.com/kFTiC.png)

**SQL Server 2012**：

在 SSMS 中右键单击您的数据库，选择`Tasks –&gt; Generate Scripts`. 选择要为其生成脚本插入的表，然后单击`Next`。选择要将输出发送到的位置（例如新的查询窗口），然后单击`Advanced`按钮（出于某种原因，该按钮位于“保存到文件”部分！）。向下滚动选项列表到“脚本的数据类型”选项，并将其更改为“仅数据”或“架构和数据”。单击`Next`两次。

![在此处输入图像描述](https://i.stack.imgur.com/Npt2w.png)

![在此处输入图像描述](https://i.stack.imgur.com/fdZmY.png)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-08T10:43:06.367

您还可以将此加载项用于提供此功能的 SSMS： [http ://www.ssmstoolspack.com/](http://www.ssmstoolspack.com/)

它还提供其他有用的功能。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T01:19:56.673

有一个名为“sp_generateinserts”的存储过程，你可以用谷歌搜索它。它将获取一个表并将其转换为插入语句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T01:14:27.560

不确定 SMSS 的快速版而是普通版，您可以右键单击选项卡并将表格编写为选择，将更新插入新窗口、剪贴板或文件。

您还可以将 MyGeneration 或 CodeSmith 视为代码生成器。我相信它们是免费的，并且应该有一些模板，给定数据库将为您创建一堆存储的过程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T05:43:45.793

如果您只是想插入测试数据，并且要插入的行数少于 64K，则可以使用 Excel（我就是这样做的）。

例如，如果您将值放入单元格 A1、B1 和 C1 中，然后在 D1 中输入以下公式，您将获得一个可用的插入语句：

="插入测试 (col1, col2, col3) 值 ("&a1&","&b1&","&c1&");"

然后只需填写，您可以随时修改数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-09T06:26:58.393

知道这一点的人不多，但您可以使用 sub sonic ( [http://subsonicproject.com/](http://subsonicproject.com/) ) 编写数据库结构和其中的数据的脚本。

命令非常简单（我使用命令行），例如。

sonic.exe 脚本数据 /server testserver /db testdb 。

这将为您将所有数据编写到插入语句中:)，既漂亮又干净。如果您想让它更容易而不使用命令行，您还可以将其挂接到 Visual Studio。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-21T05:10:34.303

试试 DBSourceTools。[http://dbsourcetools.codeplex.com](http://dbsourcetools.codeplex.com)
它可以为数据库中的任何表生成插入脚本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-04-11T16:53:35.077

Microsoft 有一个可以安装的免费应用程序。

[http://www.microsoft.com/downloads/en/results.aspx?freetext=Microsoft+SQL+Server+Database+Publishing+Wizard&displaylang=en&stype=s_basic](http://www.microsoft.com/downloads/en/results.aspx?freetext=Microsoft+SQL+Server+Database+Publishing+Wizard&displaylang=en&stype=s_basic)[在这里下载](http://www.microsoft.com/downloads/en/results.aspx?freetext=Microsoft%20SQL%20Server%20Database%20Publishing%20Wizard&displaylang=en&stype=s_basic)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-12-20T12:43:24.347

您可以从此存储过程生成 insert into 语句。 [http://raresql.com/2011/12/20/how-to-generate-insert-statements-from-table-data-using-sql-server/](http://raresql.com/2011/12/20/how-to-generate-insert-statements-from-table-data-using-sql-server/) 但通常我们会生成这样的插入语句：

```
 Insert into [table] (...) values (...) 
```

但是，在这个过程中，您可以像这样生成插入语句

```
 Insert into [table]
    select * from [table] Union ALL
    select * from [table] 
```

因此，您可以在插入之前查看数据。

伊姆兰

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-01-08T01:15:18.710

在 SQL Server Management Studio Express 中，右键单击对象资源管理器侧栏中的表，然后选择“将表编写为/插入到/新建查询编辑器窗口”。

# java - ANT：如何在构建文件中修改 java.library.path

> ID：422848
> 
> 赞同：7
> 
> 时间：2009-01-08T01:05:41.337
> 
> 标签：java, ant

java.library.path 属性似乎是只读的。例如，当您在以下构建文件上运行 ant 时

```
<project name="MyProject" default="showprops" basedir=".">
    <property name="java.library.path" value="test"/>
    <property name="some.other.property" value="test1"/>
    <target name="showprops">
        <echo>java.library.path=${java.library.path}</echo>
        <echo>some.other.property=${some.other.property}</echo>
    </target>
</project> 
```

你得到

```
> ant -version
Apache Ant version 1.6.5 compiled on June 2 2005

> ant -Djava.library.path=commandlinedefinedpath
Buildfile: build.xml
showprops:
    [echo] java.library.path=commandlinedefinedpath
    [echo] some.other.property=test1
BUILD SUCCESSFUL
Total time: 0 seconds 
```

输出表明**java.library.path**没有更改，但 **some.other.property**设置正确。

我想知道如何修改构建文件中的 java.library.path。在 ant 命令行中指定 java.library.path 并不是一个简单的选择，因为当时还不知道库路径的位置。

注意：我希望它能够工作，以便我可以指定单元测试中使用的本机库的位置。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T01:37:30.163

Ant 属性不会按照您期望的方式工作：它们是不可变的，也就是说，一旦设置了属性值，您就无法更改它。如果你跑

> ant -Dsome.other.property=commandlinedefinedpath

输出将不再显示

> [回声] some.other.property=test1

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T01:20:01.353

如果您在“java”任务中使用 fork=true，我认为您可以修改它。您可以提供 java.library.path 作为嵌套的 sysproperty 标记。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T01:18:12.247

我认为这是不可能的，主要是因为在修改这个值的时候JVM已经启动了。

但是，您可以尝试使用正确的环境变量启动新进程（请参阅 exec 或 ant 任务）

我认为您想要的是在运行时计算库的值，然后使用它来运行测试。通过创建一个新流程，您可以让该新流程使用正确的路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T17:32:10.047

如果您真的想更改属性，可以在 Java 任务或脚本语言中执行此操作。

下面是一个使用 Groovy 的示例：

```
<?xml version="1.0"?>
 <project name="example" default="run">
 <taskdef name="groovy"
          classname="org.codehaus.groovy.ant.Groovy"
          classpath="lib/groovy-all-1.1-rc-1.jar"/>

 <target name="run">
   <echo>java.library.path = ${java.library.path}</echo>
   <groovy>
     properties["java.library.path"] = "changed"
    </groovy>
    <echo>java.library.path = ${java.library.path}</echo>
  </target>
</project> 
```

注意，这违反了 Ant 的“不可变属性”属性。使用风险自负。

# c# - 模仿和委托

> ID：422858
> 
> 赞同：2
> 
> 时间：2009-01-08T01:12:15.817
> 
> 标签：c#, asp.net, iis-6, impersonation, delegation

我正在使用模拟用于访问 UNC 共享上的文件，如下所示。

```
 var ctx = ((WindowsIdentity)HttpContext.Current.User.Identity).Impersonate();
  string level = WindowsIdentity.GetCurrent().ImpersonationLevel); 
```

在使用 IIS6 的两台 Windows 2003 服务器上，我得到了不同的模拟级别：一台服务器上的*委派和另一台服务器上的**模拟*。

这会导致我无法以“模拟”级别访问服务器上的 UNC 共享。

什么可能导致这种差异？我搜索了应用程序池、站点和虚拟目录的 machine.config 和 IIS 设置 - 但无法找到此问题的原因。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-04-28T03:40:02.080

听起来您的 Active Directory 信任其中一台计算机进行委派，但另一台计算机不是。如果应用程序池标识是网络服务，请确保计算机帐户在 AD 中标记为“信任委派”。

您可能需要让您的 AD 管理员强制进行复制，然后注销/登录到您的工作站以刷新您的 Kerberos 票证缓存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T05:24:37.760

如果您使用 localhost 作为网络服务器进行测试并且它可以正常工作，但在部署时您收到错误，您可能会遇到双跳问题......在这篇[博文中概述](http://blogs.msdn.com/knowledgecast/archive/2007/01/31/the-double-hop-problem.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-25T16:33:06.490

对于我们执行 Impersonate() 的应用程序之一，我们发现我们必须修改应用程序池所有者的本地安全策略，并将该帐户添加到以下策略/组：

1.  作为操作系统特权的一部分。
2.  身份验证后模拟客户端。

在服务器上，运行开始 > 所有程序 > 管理工具 > 本地安全策略，然后导航到本地安全策略 > 用户权限分配并查找上述两个策略。

# asp.net - Best way to show critical instructions to a user in a web app?

> ID：422861
> 
> 赞同：2
> 
> 时间：2009-01-08T01:15:00.460
> 
> 标签：asp.net, user-interface

I'm also interested in more general thoughts, but here is my specific problem. In an ASP.NET web app, I am connecting to a 3rd-party via API. The 3rd-party requires that the user login and answer a few configuration questions to set this up. All of the questions except one the user can just choose the default. On one question if the user chooses the default option, my app won't work with the 3rd-party. It is a limitation of their API. It is on their list to fix, but who knows when or if they actually will?

So what is the most effective way to give the user instructions in my app that they will follow once they go to this other site? Right now I have a screenshot with the option circled in red, follow by some descriptive text. What other techniques have you used in a similar situation?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T01:40:05.243

Red text is the default mechanic in UI design to indicate importance (which is why it's used for errors so often).

Asterisks are the default choice for indicating required input.

Avoid flashing, and other garish-looking visual mechanics.

If this extends beyond a one-time inquiry, you should look at reading some good GUI books, like [Don't Make Me Think: A Common Sense Approach to Web Usability](https://rads.stackoverflow.com/amzn/click/com/0321344758) and [Designing Web Usability](https://rads.stackoverflow.com/amzn/click/com/156205810X), both seminal books in the field.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T02:08:14.347

I think you're headed in the right direction. I would make sure that your illustrative screenshot is large and easy to see the relevant details on. Also, some highlighted (classic yellow background ala 37 signals?) text to emphasize the importance of NOT selecting the offending option would be helpful.

Also, make this screenshot and highlighted instruction text, the VERY last thing they see before you forward them to or present the 3rd party site. Maybe make the action link (button, link, etc.) explicitly outline their acknowledgment of the thing not to do.

Maybe even, have fun with the caption like...

"I understand that choosing the default option above won't work."

Just some thoughts.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T01:20:59.060

Unfortunately, nothing you can do will prevent idiots from choosing the wrong thing anyway. Basically, you can't make it idiot-proof.

This is more for GUIs but (depending on how critical this is) you can force users to type "I will choose xyz" before a redirect.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T01:19:29.390

Is there a way to set a default on your end to get around this problem altogether? For example, picking some random setting initially that they could change in a profile of some kind that you can store on your end.

I've typically seen a red asterik(*) used for marking required fields on web forms if you want to not pre-select some value for the user for another way to try to solve this issue.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T13:32:08.007

I know you want abstract, generalizations but there is no one true answer for what you're asking. I mean, what kind of content are we dealing with? Is the content broken up over multiple pages (or should it)? What kind of users generally use the form?

I know I've dealt with similar problems in dozens of different ways. Ideally you want not start treating your users as complete retards straight out of the box (just move to that progressively as they fail tasks), but you also want to be clear on what's going on.

The really high level (and obvious) ideal is that you want to make the instructions stand out to your punters. Colour change and standard icons do this (often poorly). However, changing the background colour of instruction text (to say a light gray) with a large icon (like a yellow sign with an exclamation mark) tends to focus the eye.

Another idea in your situation is to break the content in two. This might be done physically (press next to continue) or you might just colour code that hole part of the element a different colour to notify the user that they need to treat this differently.

# c# - 我可以让 DataGridView.EndEdit 触发 CellValidating 事件吗？

> ID：422865
> 
> 赞同：9
> 
> 时间：2009-01-08T01:16:13.420
> 
> 标签：c#, winforms, datagridview

我在我的 WinForms 应用程序中使用 DataGridView。我的主要目标是使 Enter 键不会移动到网格中的下一行。我仍然希望输入键来验证和结束编辑模式。

我发现[这个 FAQ 条目](http://social.msdn.microsoft.com/forums/en-US/winformsdatacontrols/thread/a44622c0-74e1-463b-97b9-27b87513747e/#faq9)和子类 DataGridView 来覆盖 ProcessDialogKey()。如果按下的键是 Enter，我调用 EndEdit()，否则我调用 base.ProcessDialogKey()。

它工作得很好，除了不触发 CellValidating 事件。

目前，我只是在调用 EndEdit 之前手动调用我的验证逻辑，但似乎我遗漏了一些东西。

我想我可以调用 OnCellValidating，但我会担心我会错过其他一些事件。我真正想要的是 EndEdit() 的某种风格，其行为就像在添加禁用的网格的最后一行上按 Enter 一样。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-02T00:09:17.850

在您更改 CurrentCell 之前不会调用 CellValidating。所以我解决这个问题的方法是更改​​ CurrentCell，然后切换回当前的。

```
 protected override bool ProcessDialogKey(Keys keyData)
    {
        if (keyData == Keys.Enter)
        {
            DataGridViewCell currentCell = CurrentCell;
            EndEdit();
            CurrentCell = null;
            CurrentCell = currentCell;
            return true;
        }
        return base.ProcessDialogKey(keyData);
    } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-03-20T13:48:40.843

如果单元格处于编辑模式，JJO 的代码将崩溃。下面避免验证异常：

```
DataGridViewCell currentCell = AttachedGrid.CurrentCell;
        try
        {             
            AttachedGrid.EndEdit();
            AttachedGrid.CurrentCell = null;
            AttachedGrid.CurrentCell = currentCell;
        }
        catch 
        {
            AttachedGrid.CurrentCell = currentCell;
            AttachedGrid.CurrentCell.Selected = true; 
        } 
```

资料来源：[肯尼特哈里斯在这里的回答](http://social.msdn.microsoft.com/Forums/en/winforms/thread/1f5d313a-203d-4e7a-ac46-eee65347a9f4)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-05T08:55:16.053

如果您的 DataGridView 的 DataSource 是 BindingSouce，请执行此操作（将其放入您的[Key processing events 中](http://social.msdn.microsoft.com/forums/en-US/winformsdatacontrols/thread/a44622c0-74e1-463b-97b9-27b87513747e/#faq9)）：

```
bds.EndEdit(); 
```

如果您的 DataGridView 的 DataSource 是 DataTable：

```
this.BindingContext[dgv.DataSource].EndCurrentEdit(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-05T08:20:28.600

感谢您的解决方案。我的版本与您的版本略有不同，因为当我移动到另一个单元格时，并且我的代码在单元格验证事件中返回 e.cancel=false 时，会生成一个错误，说：“操作没有成功，因为程序无法提交或退出单元格值更改”。所以我尝试捕捉来克服这个问题。

这是我的代码：

```
Protected Overrides Function ProcessDialogKey(ByVal keyData As System.Windows.Forms.Keys) As Boolean

    Dim key As Keys = (keyData And Keys.KeyCode)

    If key = Keys.Enter Then
        If MyBase.CurrentCell.ColumnIndex = 1 Then
            Dim iRow As Integer = MyBase.CurrentCell.RowIndex

            MyBase.EndEdit()
            Try
                MyBase.CurrentCell = Nothing
                MyBase.CurrentCell = MyBase.Rows(iRow).Cells(1)
                frmFilter.cmdOk_Click(Me, New EventArgs)
            Catch ex As Exception
            End Try

            Return True
        End If
    End If

    Return MyBase.ProcessDialogKey(keyData)
End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T17:25:31.640

不，但您可以手动触发 CellValidating 事件。只需创建适当的参数。所有事件都是使用观察者模式的类，它们与任何其他方法没有什么不同。如果这不起作用，您可以在单元格上创建一个 KeyPress 事件并模拟在单元格上按 Enter，但这可能会与用户 UI 混淆，只需将克拉放回原处即可。

# agile - 使用 Scrum 的敏捷方法相对于瀑布方法的一个优势

> ID：422876
> 
> 赞同：5
> 
> 时间：2009-01-08T01:19:54.117
> 
> 标签：agile, scrum, waterfall

如果你必须选择 Scrum 相对于瀑布式流程的一项优势，你会选择什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-08T01:23:35.810

您构建了客户想要的东西，而不是客户在收集需求时认为他们想要的东西。

**编辑：**这是敏捷方法的一般属性，强调早期和经常交付 - 与瀑布完全相反（延迟和一次交付）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T01:24:51.313

它为您提供了一个流程，可以尽早且经常地交付可用的业务功能，从而增加客户对您的结果感到满意的可能性。它的成本也相对较低，并降低了失败的风险。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-08T02:33:22.470

瀑布假设你事先知道一切，这是不可能的。

一个好的 Scrum 流程以瀑布式的方式开始，列出您想要构建的所有内容。不过，scrum 的优势在于，您在每次迭代后重新排列该列表，您总是在构建客户想要的东西。

当我们为我们的一种产品构建测试版时，我们允许测试版客户帮助推动下一个周期的堆栈排名。最终结果是客户想要的产品，而不是我们向他们口授的产品。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-08T01:25:55.773

您可以快速交付可用的软件，以便在项目偏离轨道之前确定您是否走在正确的轨道上。

当然，这适用于任何敏捷过程，而不是瀑布式，而不仅仅是 Scrum。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T15:07:23.540

我认为真正的瀑布时代已经一去不复返了。Spiral 接管了瀑布，许多团队甚至在不知情的情况下都在螺旋式运行。在我之前的一个标签中，我提到敏捷是从螺旋演变而来的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T01:24:25.697

可能有一些软件开发实现在瀑布框架中使用了大部分 Scrum，因此您的部分问题可能是基于错误信息。

我在 Scrum 中看到的主要优势是它提供的日常沟通和问责制，因此团队中的每个人都可以知道其他人在做什么，并分享他或她的位置。假设您正在与可以相处并且乐于制定自己的规则的人一起工作，那么这提供了查看正在发生的事情以及告诉您正在做什么的责任感，这可以使 Scrum 成为开发软件的一个非常好的部分在一定程度上。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-08T01:25:51.157

快乐的开发者

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-08T01:29:24.423

我喜欢 SCRUM 的第一个原因是燃尽概念。没人关心你花了多少时间，他们只需要知道你还剩下多少时间。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-08T01:30:43.517

我发现这是一个很好的动力，整个团队都参与了规划过程，而不仅仅是几个人（以前就是这样）。通常，根据我的经验，这也相当于更精确的估计，这对于保持项目正确发展至关重要。

此外，很好地了解团队目前实际发生的事情，在某种程度上了解每个人正在做什么，而不是让项目负责人单独分配任务。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-18T07:24:49.263

首先，如果我们同意正确的问题更像是“敏捷”与“瀑布”......

作为一名前开发经理，我对此的主要看法实际上有些不同。我喜欢敏捷方法的“工程实践”优势，例如燃尽、JIT 设计等。然而，研究表明，流程选择和成功率之间的相关性低于许多人的预期（[一个示例](http://www.ambysoft.com/surveys/success2007.html)）。当然，敏捷相当一致地被证明要好一些，但尚不清楚这些研究是否会针对敏捷项目中倾向于拥有更好的开发人员这一事实进行调整——要么是因为更好的开发人员倾向于推动敏捷，要么是因为敏捷倾向于吸引更好的开发人员。
如果你看一下 Cockburn 的一些东西，很明显软件项目的主要成功驱动因素是项目**人员的质量**——而不是过程。

[![敏捷软件开发](https://i.stack.imgur.com/fUMBZ.jpg)](https://i.stack.imgur.com/fUMBZ.jpg)
有关这方面的一些非常好的基本解释，请参阅[Cockburn 的书](https://rads.stackoverflow.com/amzn/click/com/0321482751)（这不是一本指南书，而是解释了基本概念以及为什么应该使用敏捷的东西）。

在我看来，敏捷方法有助于**创造一个优秀程序员想要工作的环境**。因为他们是流程的一部分，因为他们被允许使用他们的大脑，等等。因此，
作为一家企业，您**更有可能吸引和留住顶尖人才**，这意味着您**更有可能拥有一个成功的项目**。

在业务层面上，这确实是合理的——其他一切都非常好，但这是对底线很重要的一件事，也是你可以向上销售的一件事。众所周知，真正优秀的开发人员的生产力是普通开发人员的许多倍，但他们的成本不会高出很多倍。所以，如果你能吸引并留住真正优秀的开发人员，你就能以同样的钱获得更多的产出。哦，在这个过程中你会有更多的乐趣。

更好的环境 => 更好的开发人员 => 更成功的项目

**一句话警告**；如果你碰巧有一个没有明显亮点的普通开发人员团队，我会担心实施敏捷。至少，不要指望它能解决你的问题——你可能会得到同样的结果（在磨合期之后），尽管有燃尽的好处。但是敏捷依赖于真正优秀的开发人员，他们真正知道自己在做什么，并且不断更新自己的技能——或者至少是一个包含这样一些人的团队。敏捷是由一群传奇的程序员和非常非常聪明的人发明的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-09-08T15:25:13.647

其他人说 Scrum 给了我们“快乐的开发者”和“有动力的开发者”。对我来说，这是最引人注目的观察。我不同意 Scrum 只会放大（精英/糟糕）程序员的表现的观点：根据我的经验，它不断提高开发人员的表现。

为什么，好吧：

*   感觉自己是团队的一员是令人振奋的。他们支持你。你有他们的。
*   你能感觉到你的工作有一种意义。采购订单会确保。
*   你致力于实现触手可及的目标，你感觉自己在掌控之中
*   你不会被困很长时间，你不会感到孤独
*   看到自己的劳动成果，立马感到自豪

请注意，这些不是“技术性的”，而是非常“情绪化的”。我认为这是“快乐”。毕竟，增加幸福感的唯一途径*就是*努力成为一个更好的程序员……我看到这种情况一次又一次地发生。

总结一下：

Scrum 使**开发人员获得更高的成就，表现更好，并具有内在的乐趣。**

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-08-02T06:14:28.207

与瀑布方法相比，敏捷方法具有明显的优势。对我来说，敏捷和瀑布方法是软件开发的两种不同方法。在敏捷方法中，将整个模块划分为小子模块，并以快速和模块化的方式进行开发，而不是像瀑布模型那样的整个大模块。在敏捷方法中，设计和需求的更改可以很容易地适应，而在瀑布的情况下很难。与瀑布模型不同，敏捷的上市时间也非常快。敏捷方法减少了测试周期。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-08T03:27:49.100

您将看到的最大好处之一是您拥有迭代周期。客户会改变他们的想法、预算等。保持灵活性是有帮助的，而不是得到回应，“这不是我要求的，所以我不付钱”

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-09-13T20:30:15.680

我喜欢敏捷的一个原因是它可以让你**更快、更快、更便宜地失败**（这意味着，如果项目要失败，你会更快地发现它）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-13T21:55:34.533

'后期绑定'。在敏捷方法中，推迟决策。当您真正掌握相关知识时，您会在项目周期的后期进行调用，而不是在您没有相关知识时进行调用。这可以提高您决策的质量。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-08T02:01:20.693

我经常看到这种混乱，所以让我们具体一点：

1.  [Scrum](http://en.wikipedia.org/wiki/Scrum_%28development%29)是一种*项目管理方法*，
2.  “瀑布”是一种*软件开发方法*

两者不等价。

之所以会产生混淆，是因为 Scrum 经常作为敏捷开发过程的项目管理部分来实践，但 Scrum 和敏捷不是一回事

所以从技术上讲，你的问题是一个错误的假设！也许你想改写它？

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-08T02:19:17.147

Waterfall 是第一次尝试使用通用工程方法解决软件开发问题。换句话说，这对每个人来说都是可怕的。

SCRUM 的主要优势？它实际上计划用于软件开发。

主要是带有新信息的代码“增长”，只有在有人说您拥有的信息足够（永远不会）之后才“组装”。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-01-08T01:30:30.367

没有死亡行军。

定义每个 sprint 可以交付的内容。
如果你没有做到这一点，就会通过将功能（抱歉的故事）从后续的 sprint 中推出来立即反映出来。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-08T01:31:51.517

用户（产品负责人）参与决定下一步需要什么。

因此，您可以立即从用户那里购买。
当故事与他们的预期不符时立即反馈。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-01-08T02:35:46.443

SCRUM（以及所有遵循敏捷宣言的敏捷方法）承认软件开发人员是人。瀑布从业者更有可能相信软件是由可互换的人月机器人开发的。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-08T02:36:15.257

它有助于紧急设计/紧急架构。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-01-08T03:11:56.667

在不显着影响进度、成本或性能的情况下改变方向或处理路线修正的能力。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-11-25T10:06:24.307

Scrum over 瀑布的最大例子？几乎每天都能看到项目状态/进度，或缺乏项目状态/进度。大多数瀑布项目都被高兴地声明为按计划进行，直到非常接近检查点/阶段门......然后他们被发现迟到了一些未知的数量。使用 Scrum，您始终知道自己的立场，并且您可以及早了解问题，以便您可以实际采取一些措施。最重要的是，Scrum 项目状态跟踪比瀑布项目状态跟踪更容易，并且本质上更准确，因为度量单位是剩余功能而不是工作时间。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2010-03-08T05:20:43.760

团队在没有与瀑布中的变更控制流程相关的所有创伤的情况下接受变更。

# windows - 如何在 Vista x64 上卸载 Intel C++ Compiler (ICC) 11？

> ID：422888
> 
> 赞同：0
> 
> 时间：2009-01-08T01:25:17.380
> 
> 标签：windows, compiler-construction, uninstallation, intel, icc

我为 x86 和 x64 目标安装了 ICC 11.0.066 的组合包，带有所有选项（IPP、TBB、MKL）。尝试从“控制面板”>“程序和功能”运行卸载程序会立即出现错误并显示对话框：

> 启动了另一个卸载实例。
> 完成后请稍等...

这发生在还卸载了 VTune（成功）后，但在重新启动后无法自行解决，等等。

如何强制英特尔编译器自行卸载和清理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T01:28:38.483

英特尔软件开发工具的可下载安装程序默认将其安装包解压缩到：

```
c:\Program Files (x86)\Intel\Download 
```

可以重新运行

```
C:\Program Files (x86)\Intel\Download\C++CompilerPro11.0\Setup.exe 
```

手动。这将包括修复和卸载选项，这两个选项都应该成功完成。如果提取的安装文件仍然不完整，应该可以通过重新运行下载的相同版本的安装程序包来重新创建它们。

# eclipse - 用 Aptana 在 Eclipse 中查看 dojo 的 javascript 源文件的好方法是什么？

> ID：422900
> 
> 赞同：1
> 
> 时间：2009-01-08T01:30:33.640
> 
> 标签：eclipse, dojo, aptana, code-formatting

我在 Eclipse 中安装了 Aptana。我正在开发一个安装了 dojo 1.2 JavaScript 库的项目。

当我打开一个dojo 的dijit .js 文件时，代码以一种相当难以阅读的方式格式化。Eclipse 的“大纲”视图显示了一个函数列表，名称为“_2”和“ew”。不是很人性化。

我说的是看起来像这样的源代码：

> )){ this.displayNode.setAttribute("tabIndex",0); } this.attr("value",this.value||this.displayNode.innerHTML); },setDisabled:function(_4){ dojo.deprecated("dijit.InlineEditBox.setDisabled() 已弃用。请改用 attr('disabled', bool)。","","2.0"); this.attr("已禁用",_4);

如何获得这样一个 .js 文件的更清晰、“更友好”的视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T01:38:50.177

您应该能够在[dojotoolkit.org](http://www.dojotoolkit.org)下载该库的未压缩版本。 [这](http://download.dojotoolkit.org/release-1.2.2/dojo-release-1.2.2/)是 1.2.2 的源代码树。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-06T23:22:46.040

您应该下载 dojo 源代码分发，因为“标准”版本是使用 dojo ShrinkSafe 工具（类似于基于 Rhino 的 yui 压缩方法）压缩的，它 100% 安全并节省大约 20% 的空间使用。在源存档中，您会发现一个 Util 文件夹，其中包含用于单元测试、压缩、构建和记录的 utils 工具 :)

[http://download.dojotoolkit.org/](http://download.dojotoolkit.org/) - 在这里您可以找到所有可下载发行版的列表

# image - 网络漫画的图像压缩

> ID：422902
> 
> 赞同：3
> 
> 时间：2009-01-08T01:31:06.463
> 
> 标签：image, compression, png, jpeg, image-compression

可能这里有很多人，我读了一些网络漫画。[Drowtales](http://www.drowtales.com)是我最喜欢的，但这不是重点。

很长一段时间以来，一个想法一直萦绕在我的脑海中：网络漫画是画出来的。它们不是照片。应该有很多冗余（更少的颜色，更平坦的颜色区域等），因此它们应该很容易以相当高的速率压缩，同时仍然保持无损质量。似乎压缩它们的最佳工具仍然是相同的旧有损 JPEG。

怎么会这样？没有更好的东西被发明出来吗？我不是数据压缩方面的专家，所以我自己寻找更好算法的微薄尝试都没有结果。我能找到的最好的是[Pngcrush](http://pmt.sourceforge.net/pngcrush/)，但它在压缩方面仍然落后于 JPEG。

我想听听专家对此的意见。我的这个想法是愚蠢的，注定要失败吗？或者是否有一些人们已经找到或我可以研究的方法？

当然，这来自于减少加载时间的自私愿望。:)

**补充：**有些人似乎没有抓住重点，所以我会澄清一下：

网络漫画图像应该有很多冗余，所以它们应该很容易压缩。**是否不可能以某种方式压缩它们以使它们既无损又小于JPEG？**或者至少比 JPEG 更好地压缩它们，同时仍然保持质量。

由于它们将用于**网络**，因此专用压缩器仍可能会发出 PNG 或 JPEG - 只需使用修改后的算法进行压缩以获得更好的结果。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-08T02:15:58.357

毫无疑问，这是外观和性能之间的平衡。除非有专门针对漫画的自定义压缩算法，否则我认为您能做的最好的事情就是尝试使用 JPEG 压缩级别，直到您得到一个合理的大小，但对于特定漫画来说仍然看起来不错。

![PNG与JPEG](https://i.stack.imgur.com/0Z9qT.png)

来自[lbrandy.com](http://lbrandy.com/blog/2008/10/my-first-and-last-webcomic/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-08T01:40:49.830

漫画的问题是使用了很多渐变色。例如，使用 Photoshop 在计算机上为漫画上色时的一种常用技术是首先将您提到的纯色区域屏蔽掉。然而，这些实体区域随后会使用各种技术进行细化，从使用喷枪工具进行手触摸到叠加渐变填充、闪避和燃烧工具等。

结果是一个更像自然图像的图像 - 这当然是漫画艺术家正在努力的目标 - 因此它使用有损算法（例如 JPEG 使用的算法）可以更好地压缩。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-08T02:02:11.970

一种完全不同的方法是使用像 SVG 这样的矢量格式来渲染漫画图像。这将捕获绘图的本质（在此处填充、此处为弧线、此处为线条等），而无需尝试对生成的图像进行光栅压缩。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-08T02:21:30.823

**你的假设没有得到我的数据的证实。**我[最喜欢的网络漫画](http://www.questionablecontent.net/)已经以 PNG 格式分发。使用默认压缩质量将 167K PNG 文件转换为 JPEG 会生成 199K JPEG 文件。收支平衡介于`-quality 60`和之间`-quality 65`，这对于 JPEG 来说是相当低的质量。因此，可疑内容*已经被*无损压缩并且比 JPEG 更小。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-08T02:04:44.523

我在为网络使用图像时学到了一些东西-

*   在 JPEG 上使用`jpegtran -optimise`- 它会无损地重新压缩它们，并且可以将压缩不良的图像减少几个百分点。
*   我运行PNG文件`pngnq`（使它们成为8位），然后`optipng -i0`（重新压缩并删除任何隔行扫描）。我知道你说过你不喜欢有损，但是 pngnq 在将图像转换为调色板方面做得非常好——最好的办法是自己尝试一下，看看输出是否足够好。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-08T02:26:51.517

在某些情况下，JPEG 图像会比 PNG 图像大。

例如，在有一个*非常简单*的图像的情况下，PNG 最终可能会更好地压缩图像并提供更好的图像质量。

下面是一些 Java 代码的示例：

```
public static void main(String[] args)
{
    BufferedImage img = new BufferedImage(
            256,
            256,
            BufferedImage.TYPE_INT_RGB
    );

    Graphics g = img.getGraphics();

    g.setColor(Color.white);
    g.fillRect(0, 0, 256, 256);
    g.setColor(Color.black);
    g.drawLine(0, 0, 255, 255);
    g.drawLine(255, 0, 0, 255);

    try
    {
        ImageIO.write(img, "jpg", new File("output.jpg"));
        ImageIO.write(img, "png", new File("output.png"));
    }
    catch (IOException e) {} // Don't usually ignore exceptions!

    g.dispose();
} 
```

上面的代码生成了一个尺寸为 256 x 256 像素的图像，并以“X”的形式绘制了两条相交的对角线。

256 x 256 图像用于将图像大小保持为 8 的倍数，因为[JPEG 压缩](http://en.wikipedia.org/wiki/JPEG)对图像的 8 x 8 像素部分执行[2D DCT 变换](http://en.wikipedia.org/wiki/JPEG#Discrete_cosine_transform)。通过保持图像大小和线条位置在 8 x 8 像素部分内对齐，可以减少[压缩伪影](http://en.wikipedia.org/wiki/Compression_artifact)的数量并提高图像质量。

（选择 256 x 256 是凭经验的——我最初使用 100 x 100 并注意到 JPEG 图像很糟糕，所以我尝试了 64 x 64 并且看起来更好，所以我将其放大以模拟更逼真的图像尺寸。）

绘制图像后，程序会生成 JPEG 文件和 PNG 文件。（[Java ImageIO 库](http://java.sun.com/j2se/1.4.2/docs/guide/imageio/spec/imageio_guideTOC.fm.html)`0.75f`使用JPEG 的压缩质量的默认压缩比。）

结果：

```
output.png : 1,308 bytes
output.jpg : 3,049 bytes 
```

看一下图像本身，JPEG 有一点伪影，但直到我用图像编辑器放大后才很明显。当然，PNG 图像是无损的，因此它是原始图像的精确表示。

总而言之，使用 PNG 或 JPEG 是否更小图像实际上取决于源 - 在某些情况下 JPEG 可以比 PNG 大，但 PNG 可以更好的质量。当然，在实践中，对于给定的图像，通常 PNG 会比 JPEG 大。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-08T02:02:41.503

您可能希望减少在图像中编码的颜色数量。尝试仅使用 256 种颜色保存您的漫画，并观察尺寸减小很多。根据您的具体绘画风格，我就足够了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-08T17:05:09.840

我绘制了许多大型手绘电路图，我将其扫描为灰度图，以用于计算机化文档；LZW 压缩的 TIFF 在可视质量和文件大小方面总是胜过 JPEG，我认为是因为 TIFF 可以利用 RLE 编码来处理空白。我不确定PNG是否也可以做到这一点，或者RLE是否可以扩展为多色图像而不仅仅是黑白图像。

编辑：我刚试了一张我的灰度手绘图；TIFF 可以以大约 2:1 击败 PNG（43K 与 83K 使用 ImageMagick 转换从原始 TIFF -> PNG -> TIFF 再次再次检查 ImageMagick 是否生成两种文件格式并确保我的原始程序没有这样做制作 TIFF 的工作很糟糕），但这仅仅是因为 TIFF 使用 8 位/像素（灰度）而 PNG 使用 24 位/像素（RGB）。

**编辑2**：没关系，我只是能够用来`pngcrush -c 0`确保图像是灰度的。PNGcrush 将 RGB 版本降至 67K，灰度降至 34K。好的！

编辑3：只是一个程序点：在我看来，选择这种类型的许多不同图像作为标准基准，并在基准集中尝试不同的技术，这会更有意义，而不仅仅是一堆堆溢出的东西。这似乎是一个需要经过充分测试的经验解决方案的问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-08T01:40:36.757

对于笔墨图像，GIF 中的压缩方案可以创造奇迹。

JPEG 压缩不适合这种图像。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-08T01:48:43.463

无论无损压缩有多好，有损压缩总是更好，因为它的限制更少。

想象一下，有一天他们为漫画发明了一些比 jpeg 更好的无损压缩，显然第二天有人会修改它以压缩更多，甚至可能，如果这意味着一些信息丢失了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-08T02:01:31.583

绘制与未绘制，网络漫画与任何其他类型的图像......这不相关。网络漫画的绘制方式或颜色布局的细节或您认为不同的任何东西。但你可以打赌，几十年的图形研究和开发已经充分考虑到了这一点，而以图形优化为生的人们已经突破了极限。

如果有比 JPEG、GIF、PNG 等更好的压缩算法，那么您不认为它会被广泛使用吗？如果您正在寻找最近的突破，那么我认为您可能是在浪费时间，因为 1) 您必须花费相当多的精力来使您的前端压缩与人们使用的任何查看器兼容（例如浏览器) 和 2) 如果它从当前格式中获得显着收益，那么它将很快得到广泛传播。

* * *

如果我被否决了，我一定没有很好地解释自己。

认为网络漫画属于某个特殊领域，因为它们是手绘或有很多颜色重复，这有点愚蠢。找到相同颜色的大块是图像压缩的绝对基础之一。

为自己找一个好的图形程序，并使用您的特定图像，看看它的哪种导出格式产生最小的图像尺寸，同时保持您想要的质量。对于不同的图像，它会有所不同。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-08T02:16:10.337

在抗锯齿和渐变之间，图像中的颜色可能比您想象的要多。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-08T03:31:34.397

作为一个为漫画做过很多着色工作的人，以及照片处理工作，我可以肯定地说，与普通照片相比，普通网络漫画内部经常发生很多事情。

假设图像是在 Photoshop 或 Painter（通常来自平板电脑）中完成的，那么在一般的网络漫画中通常会有许多过滤器或图层在起作用。阴影，反射，不透明度，背景图像等等都进入了方程式，其中许多直接来自过滤器或图层叠加，通常有许多颜色。

很多时候你必须考虑你的听众。如果您每天有 20 个访问者，那么优化您的图像真的值得吗？我可能会争辩说，这完全取决于您的网络漫画的大小和内容。如果您可以摆脱PNG，那么我会坚持使用它。在网络漫画中，通常很少有理由使用 JPG。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-08T03:33:11.773

我使用 OPTIPNG 来获得最佳过滤器（具有健全的水平），然后运行 ​​ADVDEF -4 -z
[http://advancemame.sourceforge.net/comp-readme.html](http://advancemame.sourceforge.net/comp-readme.html)（不是 Advpng，因为 Advpng 删除了过滤器）以优化放气。

你也可以试试 pngout [http://www.advsys.net/ken/utils.htm](http://www.advsys.net/ken/utils.htm) 有一个 Irfanview 插件。它使用与 Kzip 相同的 deflate 实现，通常甚至比 7-zip 更好，但速度要慢得多。

编辑：
okcancel20031003.gif[你最喜欢的“程序员”卡通片是什么？](https://stackoverflow.com/questions/84556/whats-your-favorite-programmer-cartoon?answer=94658#94658)256 色 147KB
PNG（油漆） 126KB
PNG（Irfanview） 120KB

PNG (Irfanview) +
Optipng -o5 120KB（小 525 字节） 9s
Optipng + ADVDEF 114 KB 9s+0.9s
PngOut 114 KB 6s

273 KB

BMP +
7z (LZMA -fb 273) 107 KB
RAR (最佳) 116 KB
BMF -S 90 KB 0.3s
Paq8o10t -4 79 KB 35s

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-01-08T02:35:39.330

我认为这里缺少的信息是**Image Compression is Tied to the Format**。当然，有人可以提出一种非常适合网络漫画家创作的图像的压缩算法。但是，一旦您采用新的 uber-comic-image 格式并发出 PNG、JPG 或 GIF，颜色信息将受制于 PNG、JPG 或 GIF 压缩机制的规则，您将失去您的所有好处新的图像格式。

这是另一种思考方式。

1.  将照片另存为低质量 JPEG
2.  注意文件大小
3.  把那个低质量的 jpeg 保存为 24/32 位 PNG
4.  注意*较大的*文件大小

这种神话般的超级漫画图像格式也会发生同样的事情。

另一种选择是让主要的浏览器供应商支持超级漫画图像的诞生。我将把不作为练习的原因留给观众。

# c - 访问 C 库的最 Pythonic 方式是什么——例如，OpenSSL？

> ID：422903
> 
> 赞同：3
> 
> 时间：2009-01-08T01:31:35.963
> 
> 标签：c, encryption, openssl, python

我需要访问 OpenSSL 的加密功能以在 CBC 流中编码 Blowfish 数据。我用谷歌搜索并找到了一些 Blowfish 库（手写）和一些 OpenSSL 包装器（似乎都不完整。）

最后，我需要访问某些 OpenSSL 功能，例如完整的 blowfish.h[命令](http://www.openssl.org/docs/crypto/blowfish.html)库。访问它们的pythonic/正确方法是什么？使用 SWIG 之类的东西来允许 Python/C 绑定，还是有更好的方法？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T01:48:17.273

[ctypes](http://docs.python.org/library/ctypes.html)是开始的地方。它允许您调用 DLL，使用 C 声明的类型等。我不知道是否有限制会阻止您做您需要的一切，但它非常有能力，并且包含在标准库中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T03:08:23.163

在 Python 中有很多方法可以与 C（和 C++）交互。ctypes 对于快速的小扩展来说非常好，但它有将编译时错误转换为运行时段错误的习惯。如果您想编写自己的扩展程序，SIP 非常好。SWIG 非常普遍，但拥有更多的追随者。当然，你应该做的第一件事是看看你是否真的需要接口。你看过 PyCrypto 吗？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-06T18:27:35.270

我对河豚的 M2Crypto（一个 OpenSSL 包装器）很满意。

```
import M2Crypto
from M2Crypto import EVP
import base64
import struct

key = '0' * 16 # security FTW
iv = '' # initialization vector FTW
dummy_block =  ' ' * 8

encrypt = EVP.Cipher('bf_cbc', key, iv, M2Crypto.encrypt)
decrypt = EVP.Cipher('bf_cbc', key, iv, M2Crypto.decrypt)

binary = struct.pack(">Q", 42)
ciphertext = encrypt.update(binary)

decrypt.update(ciphertext) # output is delayed by one block
i = struct.unpack(">Q", decrypt.update(dummy_block))

print i 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T01:59:23.210

SWIG 几乎是规范的方法。效果也不错。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-09T20:37:31.977

我在 Cython 上也取得了很好的成功。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-07T00:11:19.243

I would recommend [M2Crypto](http://chandlerproject.org/Projects/MeTooCrypto) as well, but if the code sample by joeforker looks a bit strange you might have an easier time understanding the M2Crypto cipher unit tests, which include Blowfish. Check out the CipherTestCase in [test_evp.py](http://svn.osafoundation.org/m2crypto/trunk/tests/test_evp.py).

# java - 自动生成 HTTP 屏幕抓取 Java 代码

> ID：422913
> 
> 赞同：6
> 
> 时间：2009-01-08T01:37:15.610
> 
> 标签：java, http, selenium, screen-scraping

我需要筛选从网站上抓取一些数据，因为它不能通过他们的网络服务获得。当我以前需要这样做时，我已经使用 Apache 的 HTTP 客户端库自己编写了 Java 代码，以进行相关的 HTTP 调用来下载数据。[在使用Charles Web 代理](http://www.charlesproxy.com/)记录相应的 HTTP 调用时，我通过在浏览器中单击相关屏幕来找出我需要进行的相关调用。

正如您可以想象的那样，这是一个相当乏味的过程，我想知道是否有一个工具可以实际生成与浏览器会话相对应的 Java 代码。我希望生成的代码不会像手动编写的代码那样漂亮，但我总是可以在之后整理它。有谁知道这样的工具是否存在？Selenium 是我知道的一种可能性，但我不确定它是否支持这个确切的用例。

谢谢，唐

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-09T16:38:00.137

我还会为 HtmlUnit 添加 +1，因为它的功能非常强大：如果您需要“就像真正的浏览器正在抓取并使用页面一样”的行为，那绝对是最好的选择。HtmlUnit 执行（如果您愿意）页面中的 Javascript。

它目前对所有主要的 Javascript 库都有[全功能支持](http://daniel.gredler.net/2008/12/31/htmlunit-24-released/)，并将使用它们执行 JS 代码。与此相对应，您可以在测试中以编程方式获取页面中 Javascript 对象的句柄。

但是，如果您尝试做的事情的范围更小，更多的是阅读一些 HTML 元素并且您不太关心 Javascript，那么使用[NekoHTML](http://java-source.net/open-source/html-parsers/nekohtml)就足够了。它类似于[JDom](http://www.jdom.org/)以编程方式（而不是 XPath）访问树。您可能需要使用 Apache 的[HttpClient](http://hc.apache.org/httpclient-3.x/)来检索页面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T14:51:11.467

managementability.org[博客](http://www.manageability.org)有一个条目，其中列出了一大堆 Java 网页抓取工具。但是，我现在似乎无法访问它，但我确实在[此处](http://74.125.45.132/search?q=cache:7NcuMd6Ak2YJ:www.manageability.org/blog/stuff/screen-scraping-tools-written-in-java+java+web+page+scraping+data+source&hl=en&gl=us&strip=1)的 Google 缓存中找到了纯文本表示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-07T08:36:20.837

我想说我个人喜欢使用 HtmlUnit 和 Selenium 作为我最喜欢的两种屏幕抓取工具。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T04:27:46.390

你应该看看[HtmlUnit——](http://htmlunit.sourceforge.net/)它是为测试网站而设计的，但非常适合屏幕抓取和浏览多个页面。它负责 cookie 和其他与会话相关的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T15:29:58.457

一个名为[The Grinder](http://grinder.sourceforge.net/ "Grinder，一个 Java 负载测试框架")的工具允许您通过其代理编写与站点的会话脚本。输出是 Python（可在 Jython 中运行）。

# c++ - 如何为 _RTC_InitData 和 _RTC_Shutdown 解析未解析的符号 (LNK2001)

> ID：422918
> 
> 赞同：0
> 
> 时间：2009-01-08T01:39:12.970
> 
> 标签：c++, visual-studio-2008, build, linker

我正在 Visual Studio 2008 中构建一个 x64 库，并将其单独链接到一个 x64 DLL（在这种情况下特别使用 WDK Build.exe 工具链）。大多数通用 C 运行时符号链接正常，表明库版本匹配得很好，但这两个 RTC_* 符号特别失败。强制使用不同的运行时库版本，以及在 lib 的链接器选项中包含激进的符号并不能解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T02:10:21.987

这些`RTC_*`符号在 Google 上的多个地方都提到过，但没有很好的记录。它们是 VC9 编译器的新运行时检查 (RTC) 功能使用的入口点。`[Project Property Pages] > Configuration Properties > C/C++ > Code Generation`通过设置`Basic Runtime Checks`from `Both (/RTC1, equiv. to /RTCsu)`to禁用运行时签入`Default`。

# asp.net-mvc - 在 Mvc 中使用 Html.ActionLink 时如何绕过 HTML 编码？

> ID：422929
> 
> 赞同：42
> 
> 时间：2009-01-08T01:42:21.357
> 
> 标签：asp.net-mvc, html-encode

每当我使用 Html.ActionLink 它总是 Html 编码我的显示字符串。例如，我希望我的链接看起来像这样：

```
<a href="/posts/422/My-Post-Title-Here">More&hellip;</a> 
```

它的输出是这样的：[更多…](/posts/422/My-Post-Title-Here)

&hellip 是“...”，以防您想知道。

然而，actionlink 输出实际的文本“…” 作为链接文本。如果我想输出这个，我有同样的问题：

```
<a href="/posts/422/My-Post-Title-Here"><em>My-Post-Title-Here</em></a> 
```

我结束了： [<em>My-Post-Title-Here</em>](/posts/422/My-Post-Title-Here)

知道怎么做吗？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-01-08T02:00:10.680

看起来 ActionLink 总是在链接文本上使用调用 HttpUtility.Encode。您可以使用 UrlHelper 生成 href 并自己构建锚标记。

```
<a href='@Url.Action("Posts", ...)'>More&hellip;</a> 
```

或者，您可以“解码”传递给 ActionLink 的字符串。用 HTML 构建链接似乎更具可读性（对我而言）——尤其是在 Razor 中。下面是比较的等价物。

```
@Html.ActionLink(HttpUtility.HtmlDecode("More&hellip;"), "Posts", ...) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-13T18:24:08.840

Sam 给出的答案实际上是正确的，我在我的解决方案中使用了它，因此我自己尝试了它。您可能想要删除额外的括号，使其变为如下所示：

```
@Html.ActionLink(HttpUtility.HtmlDecode("&amp;"), "Index", "Home") 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-08T02:18:46.383

或者，只需使用普通的 Unicode 省略号字符 \u2026 并让 MVC 担心如何对其进行编码。除非有一些特别令人信服的理由，否则您特别需要一个 hellip 实体引用而不是字符引用，或者只是将字符包含为简单的 UTF-8 字节。

或者：只使用三个句点。省略号 (U+2026) 是一个兼容字符，仅包含在与 pre-Unicode 编码之间的往返行程中。与简单的点相比，它给你带来的好处很少。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-04-30T18:38:37.323

看看这个：

```
 <p>Some text   @(new HtmlString(stringToPaste)) </p> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-08-19T02:01:21.080

在传递值之前对其进行解码。只是遇到了同样的问题（不同的字符），它工作正常：

例如：

```
@Html.ActionLink(HttpUtility.HtmlDecode(_("&amp;")), "Index", "Home") 
```

虽然烦人

# .net - 如何在仅执行一次命令时检查 DBNull？

> ID：422932
> 
> 赞同：7
> 
> 时间：2009-01-08T01:43:40.120
> 
> 标签：.net, sql, database, ado.net

当我从数据库中检索任何标量值时，我通常会为可空字段编写这样的代码。

```
cmd.ExecuteScalar() == DBNull.Value ? 0 : (int)cmd.ExecuteScalar() 
```

但我不喜欢它，因为它执行 Executescalar 语句两次。对于我的网站来说，这是一次额外的服务器之旅，为了提高性能，我不想这样做。

有什么办法可以摆脱这个额外的 ExecuteScalar() 吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-08T01:48:41.763

给自己写一个 sql 命令的扩展方法。

```
public static T ExecuteNullableScalar<T>(this SqlCommand cmd)
    where T : struct
{
    var result = cmd.ExecuteScalar();
    if (result == DBNull.Value) return default(T);
    return (T)result;
} 
```

用法变为：

```
int value = cmd.ExecuteNullableScalar<int>(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-08T01:46:05.827

只需使用一个变量来缓存结果：

```
var o = cmd.ExecuteScalar();
return o == DBNull.Value ? 0 : (int)o; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T01:46:57.493

```
 object o = cmd.ExecuteScalar();
 return (o== DBNull.Value) ? 0 : (int)o; 
```

# f# - print_int 和其他 F# 打印函数

> ID：422940
> 
> 赞同：1
> 
> 时间：2009-01-08T01:48:09.707
> 
> 标签：f#

我正在尝试在 Visual Studio 中做简单的教程 let someNumber = (2 + 2) print_int someNumber 但它说 print_int 是未定义的。printfn 有效。我正在使用的书会过时吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T01:54:02.533

print_int 是 F# 电源组的一部分。添加对 PowerPack 的引用（我的机器上的 c:\program files\FSharp-1.9.6.2\bin\FSharp.PowerPack.dll）应该可以解决这个问题。

这是 Don 的一篇博客文章，其中提到了 Power Pack 的当前计划：

[http://blogs.msdn.com/dsyme/archive/2008/12/10/fsharp-to-ship-as-part-of-visual-studio-2010.aspx](http://blogs.msdn.com/dsyme/archive/2008/12/10/fsharp-to-ship-as-part-of-visual-studio-2010.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-22T23:03:06.553

实际上，print_int 不在 FSharp.PowerPack.dll 中，至少在最新版本（PowerPack 版本 1.9.9.9）中没有。它在 FSharp.PowerPack.Compatibility.dll 中。

仅供参考，要在 F# Interactive 窗口中使用 print_int、print_endline 等（并关闭有关 ML 兼容性的警告），请使用以下命令：

```
#r "FSharp.PowerPack.Compatibility.dll";;
#nowarn "62";; 
```

# .net - 使用服务应用程序删除文件

> ID：422948
> 
> 赞同：1
> 
> 时间：2009-01-08T01:50:40.357
> 
> 标签：.net, file, windows-services

我在 VS2005 中使用 FileSystemWatcher 来监视目录并考虑将应用程序更改为服务。在服务尝试删除文件之前，一切都很好。将异常发送到事件查看器，我得到一个 System.UnauthorizedAccessException。在表单中运行时，可以通过相同的 FileSystemWatcher 代码删除有问题的文件（测试）。我已经检查了文件夹的 LocalService 权限，甚至更改了运行该服务的人员。我注释掉了有关 FileSystemWatcher 的代码，但仍然无法使用我尝试使用 File.Delete(filename) 的服务删除文件。认为问题可能与“文件”有关，我尝试了 File.Copy(filename, newfilename) 并且效果很好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T01:52:42.553

尝试为服务使用普通的旧用户帐户，而不是使用 LocalSystem。这样，您可以授予服务的特定权限，而不是让它访问 LocalSystem 所做的所有事情。

此外，我发现 FileSystemWatcher 是一种痛苦而不是它的好处。通常它会在文件完全写入之前检测到文件的存在，这会在处理文件时导致各种问题。尝试对新文件使用轮询（每隔几秒钟检查一次文件夹 - 不要使用 Timer 类 -[它有自己的问题](https://stackoverflow.com/questions/397744/-net-windows-service-with-timer-stops-responding)！）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T15:15:18.443

“更改了运行服务的人”是谁启动了服务或服务被配置为运行的帐户？

一般来说，当一个服务作为标准应用程序运行时出现权限问题时，问题总是服务的配置帐户。

# sql - 在 sqlite 数据库中保留日志表？

> ID：422951
> 
> 赞同：11
> 
> 时间：2009-01-08T01:51:53.363
> 
> 标签：sql, sqlite

我正在寻找一种方法来设置（通过 SQL）一个日志表，其中包含对我的 sqlite 数据库所做的一切（最好是在向数据库发出的插入、创建表等语句方面）。我确信有办法通过在每个表上设置触发器来做到这一点，但这只是工作量太大，如果我稍后更改数据库的架构，这不是好兆头。是否有适用于数据库的包罗万象的全局事物（例如数据库本身的触发器）？

我也愿意接受其他建议来记录对 sqlite 数据库所做的更改，以便我可以在几个月后回顾这些更改。

（当然有编程方式，但我不能确定我的程序是唯一写入数据库的程序）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-10T03:48:48.940

尽管以下内容不能满足您的所有要求，但您可能希望看到一种方法。[Mike Chirico 的 SQLite 教程](http://souptonuts.sourceforge.net/readme_sqlite_tutorial.html)有一个关于**记录所有插入、更新和删除**的部分，它模仿了 MySQL 的二进制日志的功能。

它依赖于触发器，这些触发器必须与您希望跟踪其更改的每个表的架构相匹配。也就是说，如果您的表有一个名为“a”的字段，那么日志记录表需要跟踪“aOLD”和“aNEW”。通过这种方式，触发器能够记录对该特定表中的字段所做的更新、插入和删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T05:15:55.417

这些功能可能有用

```
void *sqlite3_update_hook(
  sqlite3*, 
  void(*)(void *,int ,char const *,char const *,sqlite3_int64),
  void*
);

void *sqlite3_trace(sqlite3*, void(*xTrace)(void*,const char*), void*);

void *sqlite3_profile(
   sqlite3*,
   void(*xProfile)(void*,const char*,sqlite3_uint64), void*
); 
```

他们似乎对单个数据库起作用

我能看到的唯一全局方式是使用

```
sqlite3_vfs *sqlite3_vfs_find(const char *zVfsName);
int sqlite3_vfs_register(sqlite3_vfs*, int makeDflt);
int sqlite3_vfs_unregister(sqlite3_vfs*); 
```

# c# - C#编译器在翻译LINQ表达式时如何选择SelectMany？

> ID：422958
> 
> 赞同：9
> 
> 时间：2009-01-08T01:56:30.017
> 
> 标签：c#, select, expression, linq

Enumerable.SelectMany 有 4 个重载签名。为了简单起见，我们忽略了两个带有*int*参数的签名。所以我们有 2 个 SelectMany 的签名：

```
public static IEnumerable<TResult> SelectMany<TSource, TResult>(
    this IEnumerable<TSource> source,
    Func<TSource, IEnumerable<TResult>> selector
)

public static IEnumerable<TResult> SelectMany<TSource, TCollection, TResult>(
    this IEnumerable<TSource> source,
    Func<TSource, IEnumerable<TCollection>> collectionSelector,
    Func<TSource, TCollection, TResult> resultSelector
) 
```

我的问题是：在将 LINQ 表达式转换为扩展方法调用时，C# 编译器如何选择 SelectMany？

基本上，如果 LINQ 表达式中有多个**from**，就会有 SelectMany。但是，似乎 C# 编译器只选择了第二个签名。从未使用过第一个签名。

```
 IEnumerable<int> en1 = Enumerable.Range(1, 3);
        IEnumerable<double> en2 = new double[] { 1.0, 3.14 };

        IEnumerable<string> en3 =
            from i1 in en1
            from i2 in en2
            select (i1 * i2).ToString();

        foreach (var i in en3)
        {
            Console.WriteLine(i);
        } 
```

在Reflector的帮助下，我可以看到上面的LINQ表达式被翻译成

```
en1.SelectMany<int, double, string>(delegate (int i1) {
        return en2;
    }, delegate (int i1, double i2) {
        double CS$0$0000 = i1 * i2return CS$0$0000.ToString();
    }) 
```

上面的例子涉及 3 种类型。因此，选择第二个 SelectMany 签名是合理的。但是，对于下面的示例，仅涉及一种类型，它仍然选择第二个签名。

```
 IEnumerable<int> en4 =
            from i1 in en1
            from i2 in Enumerable.Range(0, i1)
            select i2; 
```

它被翻译成：

```
en1.SelectMany<int, int, int>(delegate (int i1) {
        return Enumerable.Range(0, i1);
    }, delegate (int i1, int i2) {
        return i2;
    }) 
```

因此，我找不到将 LINQ 表达式转换为第一个 SelectMany 签名的情况。有没有这样的情况？

如果不使用第一个 SelectMany 签名，那么它存在只是因为它是函数式编程中 monad 的 BIND 吗？

也许问题是：为什么我们有 2 个 SelectMany 签名？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T02:56:04.750

根据 C# 规范，编译器不会对 SelectMany 的第一个版本生成重载调用。SelectMany 的第一个版本对于将列表列表扁平化为单个扁平列表很有用。

```
public IEnumerable<string> Example(IEnumerable<IEnumerable<string>> enumerable) {
  return enumerable.SelectMany(x => x);
} 
```

它在查询表达式中没有强等价物。

有关详细信息，请参阅 C# 语言规范的第 7.15.2 节。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-09T15:29:31.413

> 为什么我们有 2 个 SelectMany 签名？

所以我可以在我的代码中使用第一个。

```
var orders = Customers.SelectMany(c => c.Orders) 
```

# bash - 使用 bash 删除带有空格的目录

> ID：422963
> 
> 赞同：1
> 
> 时间：2009-01-08T01:58:29.827
> 
> 标签：bash, find

我正在使用以下命令删除名为“Test Folder”的文件夹中的每个“.dummy”目录：

```
rm -rf `find "Test Folder" -type d -name .dummy` 
```

但是，这不起作用，因为它扩展为：

```
rm -rf Test Folder/.dummy 
```

由于没有转义空格，因此失败。

我也尝试过这样的事情：

```
find "Test Folder" -type d -name .dummy -exec rm -rf {} \; 
```

它有效，但它给出了一个恼人的错误，如下所示：

```
find: Test Folder/.dummy: No such file or directory 
```

有没有办法使任何一种解决方案都能成功？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-08T02:03:48.550

有几件事。最简单的就是改变和使用

```
$ find 'Test Folder' -type d -print0 | xargs -0 rm -rf 
```

另一种选择是

```
$ find 'Test Folder' -type d -exec \'{}\' \; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T02:02:31.283

尝试

```
find "Test Folder" -type d -name .dummy -exec rm -rf \"{}\" \; 
```

请注意选项中`rm -rf "{}"`arg 中的额外引号。`-exec`它们是必需的，因为名称`Test Folder/.dummy`中有一个空格。所以你需要报价。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-18T17:36:37.573

找到“测试文件夹”-type d -name '.dummy' -delete

# php - 如何用php识别机器人？

> ID：422969
> 
> 赞同：18
> 
> 时间：2009-01-08T02:00:12.723
> 
> 标签：php, bots, statistics

我正在为我的用户建立统计数据，并且不希望计算来自机器人的访问。

现在我有一个基本的php，每次调用页面时mysql都会增加1。

但机器人也被添加到计数中。

有没有人能想到办法？

主要是那些把事情搞砸的主要因素。谷歌、雅虎、Msn 等

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-08T02:07:32.600

可以检查User Agent字符串，空字符串，或者包含'robot'、'spider'、'crawler'、'curl'的字符串很可能是机器人。

> `preg_match('/robot|spider|crawler|curl|^$/i', $_SERVER['HTTP_USER_AGENT']));`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-08T02:04:02.123

您应该按用户代理字符串进行过滤。您可以在此处找到机器人提供的大约 300 个常见用户代理的列表：[http](http://www.robotstxt.org/db.html) ://www.robotstxt.org/db.html运行该列表并在运行 SQL 语句之前忽略机器人用户代理应该可以解决您的问题出于所有实际目的。

如果您甚至不希望搜索引擎到达该页面，请使用基本的[robots.txt](http://www.robotstxt.org/)文件来阻止它们。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-04-20T09:06:37.233

我们有一个与您自己类似的用例，我们最近发现非常有用的一个选项是来自[user-agent-string.info的](http://www.user-agent-string.info)[UASParser 类](http://user-agent-string.info/download/UASparser-for-PHP)。

这是一个 PHP 类，它提取最新的用户代理字符串定义集并将它们缓存在本地。该类可以配置为根据您认为合适的频率或频率提取定义。像这样自动获取它们意味着您不必密切关注机器人用户代理或市场上新出现的各种变化，尽管您依靠 UAS.info 准确地做到这一点。

当类被调用时，它解析当前访问者的用户代理并返回一个关联数组，分解组成部分，例如

```
Array
(
    [typ] => browser
    [ua_family] => Firefox
    [ua_name] => Firefox 3.0.8
    [ua_url] => http://www.mozilla.org/products/firefox/
    [ua_company] => Mozilla Foundation
    ........
    [os_company] => Microsoft Corporation.
    [os_company_url] => http://www.microsoft.com/
    [os_icon] => windowsxp.png
) 
```

该字段`typ`设置为`browser`当 UA 被识别为可能属于人类访问者时，在这种情况下，您可以更新您的统计信息。

这里有几个警告：

*   您依赖 UAS.info 提供的用户代理字符串是准确和最新的
*   像 google 和 yahoo 这样的机器人在他们的用户代理字符串中声明自己，但这种方法仍然会计算来自伪装成人类访客的机器人的访问（发送欺骗性的 UA）
*   正如上面提到的[@amdfan](https://stackoverflow.com/questions/422969/how-to-recognize-bots-with-php/422982#422982)，通过 robots.txt 阻止机器人应该会阻止大多数机器人到达您的页面。如果您需要对内容进行索引但不增加统计信息，那么 robots.txt 方法将不是一个现实的选择

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T02:06:16.160

在增加页面查看计数之前检查[用户代理](http://en.wikipedia.org/wiki/User_agent)，但请记住这可能会被欺骗。PHP 在 中公开用户代理`$_SERVER['HTTP_USER_AGENT']`，假设 Web 服务器向它提供了此信息。有关更多信息`$_SERVER`，[请访问 http://www.php.net/manual/en/reserved.variables.server.php](http://www.php.net/manual/en/reserved.variables.server.php)。

[您可以在http://www.user-agents.org](http://www.user-agents.org/)找到用户代理列表；谷歌搜索还将提供属于主要提供商的名称。第三种可能的来源是您的 Web 服务器的访问日志，如果您可以汇总它们的话。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T02:03:14.277

您是否尝试过通过他们的用户代理信息来识别他们？一个简单的谷歌搜索应该会给你谷歌等使用的用户代理。

当然，这并不是万无一失的，但大公司的大多数爬虫都提供了一个独特的用户代理。

编辑：假设您不想限制机器人访问，但只是不计算它在您的 statistc 中的访问。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-04T10:19:33.297

**100% 工作机器人检测器。**它正在我的网站上检测机器人、爬虫、蜘蛛和复印机。

```
function isBotDetected() {

    if ( preg_match('/abacho|accona|AddThis|AdsBot|ahoy|AhrefsBot|AISearchBot|alexa|altavista|anthill|appie|applebot|arale|araneo|AraybOt|ariadne|arks|aspseek|ATN_Worldwide|Atomz|baiduspider|baidu|bbot|bingbot|bing|Bjaaland|BlackWidow|BotLink|bot|boxseabot|bspider|calif|CCBot|ChinaClaw|christcrawler|CMC\/0\.01|combine|confuzzledbot|contaxe|CoolBot|cosmos|crawler|crawlpaper|crawl|curl|cusco|cyberspyder|cydralspider|dataprovider|digger|DIIbot|DotBot|downloadexpress|DragonBot|DuckDuckBot|dwcp|EasouSpider|ebiness|ecollector|elfinbot|esculapio|ESI|esther|eStyle|Ezooms|facebookexternalhit|facebook|facebot|fastcrawler|FatBot|FDSE|FELIX IDE|fetch|fido|find|Firefly|fouineur|Freecrawl|froogle|gammaSpider|gazz|gcreep|geona|Getterrobo-Plus|get|girafabot|golem|googlebot|\-google|grabber|GrabNet|griffon|Gromit|gulliver|gulper|hambot|havIndex|hotwired|htdig|HTTrack|ia_archiver|iajabot|IDBot|Informant|InfoSeek|InfoSpiders|INGRID\/0\.1|inktomi|inspectorwww|Internet Cruiser Robot|irobot|Iron33|JBot|jcrawler|Jeeves|jobo|KDD\-Explorer|KIT\-Fireball|ko_yappo_robot|label\-grabber|larbin|legs|libwww-perl|linkedin|Linkidator|linkwalker|Lockon|logo_gif_crawler|Lycos|m2e|majesticsEO|marvin|mattie|mediafox|mediapartners|MerzScope|MindCrawler|MJ12bot|mod_pagespeed|moget|Motor|msnbot|muncher|muninn|MuscatFerret|MwdSearch|NationalDirectory|naverbot|NEC\-MeshExplorer|NetcraftSurveyAgent|NetScoop|NetSeer|newscan\-online|nil|none|Nutch|ObjectsSearch|Occam|openstat.ru\/Bot|packrat|pageboy|ParaSite|patric|pegasus|perlcrawler|phpdig|piltdownman|Pimptrain|pingdom|pinterest|pjspider|PlumtreeWebAccessor|PortalBSpider|psbot|rambler|Raven|RHCS|RixBot|roadrunner|Robbie|robi|RoboCrawl|robofox|Scooter|Scrubby|Search\-AU|searchprocess|search|SemrushBot|Senrigan|seznambot|Shagseeker|sharp\-info\-agent|sift|SimBot|Site Valet|SiteSucker|skymob|SLCrawler\/2\.0|slurp|snooper|solbot|speedy|spider_monkey|SpiderBot\/1\.0|spiderline|spider|suke|tach_bw|TechBOT|TechnoratiSnoop|templeton|teoma|titin|topiclink|twitterbot|twitter|UdmSearch|Ukonline|UnwindFetchor|URL_Spider_SQL|urlck|urlresolver|Valkyrie libwww\-perl|verticrawl|Victoria|void\-bot|Voyager|VWbot_K|wapspider|WebBandit\/1\.0|webcatcher|WebCopier|WebFindBot|WebLeacher|WebMechanic|WebMoose|webquest|webreaper|webspider|webs|WebWalker|WebZip|wget|whowhere|winona|wlm|WOLP|woriobot|WWWC|XGET|xing|yahoo|YandexBot|YandexMobileBot|yandex|yeti|Zeus/i', $_SERVER['HTTP_USER_AGENT'])
    ) {
        return true; // 'Above given bots detected'
    }

    return false;

} // End :: isBotDetected() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-08-03T01:22:35.757

这个功能对我有用，我在[https://www.cult-f.net/detect-crawlers-with-php/](https://www.cult-f.net/detect-crawlers-with-php/)网站上找到：

```
<?php
  $crawlers = array(
    'Google'=>'Google',
    'MSN' => 'msnbot',
    'Rambler'=>'Rambler',
    'Yahoo'=> 'Yahoo',
    'AbachoBOT'=> 'AbachoBOT',
    'accoona'=> 'Accoona',
    'AcoiRobot'=> 'AcoiRobot',
    'ASPSeek'=> 'ASPSeek',
    'CrocCrawler'=> 'CrocCrawler',
    'Dumbot'=> 'Dumbot',
    'FAST-WebCrawler'=> 'FAST-WebCrawler',
    'GeonaBot'=> 'GeonaBot',
    'Gigabot'=> 'Gigabot',
    'Lycos spider'=> 'Lycos',
    'MSRBOT'=> 'MSRBOT',
    'Altavista robot'=> 'Scooter',
    'AltaVista robot'=> 'Altavista',
    'ID-Search Bot'=> 'IDBot',
    'eStyle Bot'=> 'eStyle',
    'Scrubby robot'=> 'Scrubby',
    );

function crawlerDetect($USER_AGENT)
{
    // to get crawlers string used in function uncomment it
    // it is better to save it in string than use implode every time
    // global $crawlers
    // $crawlers_agents = implode('|',$crawlers);
    $crawlers_agents = 'Google|msnbot|Rambler|Yahoo|AbachoBOT|accoona|AcioRobot|ASPSeek|CocoCrawler|Dumbot|FAST-WebCrawler|GeonaBot|Gigabot|Lycos|MSRBOT|Scooter|AltaVista|IDBot|eStyle|Scrubby';

    if ( strpos($crawlers_agents , $USER_AGENT) === false )
       return false;
    // crawler detected
    // you can use it to return its name
    /*
    else {
       return array_search($USER_AGENT, $crawlers);
    }
    */
}

// example

$crawler = crawlerDetect($_SERVER['HTTP_USER_AGENT']);

if ($crawler )
{
   // it is crawler, it's name in $crawler variable
}
else
{
   // usual visitor
} 
```

# java - 在java中获取网站的源代码

> ID：422970
> 
> 赞同：3
> 
> 时间：2009-01-08T02:00:23.707
> 
> 标签：java, url

我想使用 java 来获取网站的来源（安全），然后解析该网站以获取其中的链接。我已经找到了如何连接到该 url，但是我怎样才能轻松地获得源代码，最好是作为 DOM 文档 os，以便我可以轻松地获得我想要的信息。

或者有没有更好的方法来连接到 https 站点，获取源（我需要这样做来获取数据表......它非常简单）然后这些链接是我要下载的文件。

我希望它是 FTP 但这些是存储在我的 tivo 上的文件（我想以编程方式将它们下载到我的计算机上（

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T02:45:14.363

您可以获得低级别，只需使用套接字请求它。在java中它看起来像

```
// Arg[0] = Hostname
// Arg[1] = File like index.html
public static void main(String[] args) throws Exception {
    SSLSocketFactory factory = (SSLSocketFactory) SSLSocketFactory.getDefault();

    SSLSocket sslsock = (SSLSocket) factory.createSocket(args[0], 443);

    SSLSession session = sslsock.getSession();
    X509Certificate cert;
    try {
        cert = (X509Certificate) session.getPeerCertificates()[0];
    } catch (SSLPeerUnverifiedException e) {
        System.err.println(session.getPeerHost() + " did not present a valid cert.");
        return;
    }

    // Now use the secure socket just like a regular socket to read pages.
    PrintWriter out = new PrintWriter(sslsock.getOutputStream());
    out.write("GET " + args[1] + " HTTP/1.0\r\n\r\n");
    out.flush();

    BufferedReader in = new BufferedReader(new InputStreamReader(sslsock.getInputStream()));
    String line;
    String regExp = ".*<a href=\"(.*)\">.*";
    Pattern p = Pattern.compile( regExp, Pattern.CASE_INSENSITIVE );

    while ((line = in.readLine()) != null) {
        // Using Oscar's RegEx.
        Matcher m = p.matcher( line );  
        if( m.matches() ) {
            System.out.println( m.group(1) );
        }
    }

    sslsock.close();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T03:46:54.210

极其相似的问题：

*   [如何使用 Java 从网站检索 URL？](https://stackoverflow.com/questions/359439/how-do-i-retrieve-a-url-from-a-web-site-using-java)
*   [你如何以编程方式在 Java 中下载网页](https://stackoverflow.com/questions/238547/how-do-you-programmatically-download-a-webpage-in-java)
*   [一个在 Java 中进行 URL 操作的好库](https://stackoverflow.com/questions/218608/a-good-library-to-do-url-manipulation-in-java)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T02:05:45.973

尝试[HttpUnit](http://httpunit.sourceforge.net/)或[HttpClient](http://hc.apache.org/httpclient-3.x/)。尽管前者表面上是用于编写集成测试，但它有一个方便的 API 用于以编程方式迭代网页的链接，类似于以下使用[WebResponse.getLinks()](http://httpunit.sourceforge.net/doc/api/com/meterware/httpunit/WebResponse.html#getLinks())：

```
WebConversation wc = new WebConversation();
WebResponse resp = wc.getResponse("http://stackoverflow.com/questions/422970/");
WebLink[] links = resp.getLinks();
// Loop over array of links... 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-08T03:12:04.670

可能您可以从 Pete 或 sktrdie 选项中获得更好的结果。如果您想知道如何*“通过 had”做到这一点，这是另一种方法*

我不太擅长正则表达式，所以在这种情况下，它返回一行中的最后一个链接。嗯，这是一个开始。

```
import java.io.*;
import java.net.*;
import java.util.regex.*;

public class Links { 
    public static void main( String [] args ) throws IOException  { 

        URL url = new URL( args[0] );
        InputStream is = url.openConnection().getInputStream();

        BufferedReader reader = new BufferedReader( new InputStreamReader( is )  );

        String line = null;
        String regExp = ".*<a href=\"(.*)\">.*";
        Pattern p = Pattern.compile( regExp, Pattern.CASE_INSENSITIVE );

        while( ( line = reader.readLine() ) != null )  {
            Matcher m = p.matcher( line );  
            if( m.matches() ) {
                System.out.println( m.group(1) );
            }
        }
        reader.close();
    }
} 
```

**编辑**

糟糕，我完全错过了“安全”部分。无论如何我忍不住，我不得不写这个样本：P

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T02:07:35.643

您可以使用[javacurl](http://sourceforge.net/projects/javacurl)获取站点的 html，并使用[java DOM](http://java.sun.com/j2se/1.4.2/docs/api/org/w3c/dom/package-summary.html)对其进行分析。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-21T09:59:40.390

尝试使用 jsoup 库。

```
import java.io.IOException;
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;

public class ParseHTML {

    public static void main(String args[]) throws IOException{
        Document doc = Jsoup.connect("https://www.wikipedia.org/").get();
        String text = doc.body().text();

        System.out.print(text);
    }
} 
```

[您可以在此处](http://jsoup.org/download)下载 jsoup 库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T10:00:22.647

在 web 上下文中，souce 有两种含义：

**HTML 源代码：**如果您通过 URL 请求网页，您总是会得到 HTML 源代码。事实上，您无法从 URL 中获得任何其他信息。网页总是以源代码的形式传输，不存在*编译网页*这种东西。对于您正在尝试的内容，这应该足以完成您的任务。

**脚本来源：**如果网页是动态生成的，那么它是用某种服务器端脚本语言（如 PHP、Ruby、JSP...）编码的。此级别还*存在*源代码。但是使用 HTTP 连接您无法获得这种源代码。这不是*缺少的功能*，而是完全出于目的。

**解析：**话虽如此，您将需要以某种方式解析 HTML 代码。如果您只需要链接，使用 RegEx（如 Oscar Reyes 所示）将是最实用的方法，但您也可以“手动”编写一个简单的解析器。这会很慢，更多的代码......但有效。

如果您想在更合乎逻辑的级别上访问代码，则将其解析为 DOM 将是可行的方法。如果代码是*有效的 XHTML*，您只需将其解析为 org.w3c.dom.Document 并对其执行任何操作。如果它至少是*有效的 HTML*，您可能会应用一些技巧将其转换为 XHTML（在极少数情况下，将 <br> 替换为 <br/> 并更改文档类型就足够了）并将其用作 XML。

如果它不是有效的 XML，则需要一个 HTML DOM 解析器。我不知道 Java 是否存在这样的东西，以及它是否表现良好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-11T21:42:38.533

可以在您的 Tivo 上安装 FTP 服务器以允许下载节目，请参见此处[http://dvrpedia.com/MFS_FTP](http://dvrpedia.com/MFS_FTP)

问题的表述方式不同（如何在 java 中处理 http/html），但最后你提到你想要的是下载节目。Tivo 使用自己独特的文件系统（MFS - 媒体文件系统），因此将驱动器安装在另一台机器上并不容易 - 相反，在 Tivo 上运行 http 或 ftp 服务器并从这些服务器下载更容易

# payment-gateway - 接受信用卡/电子支票付款

> ID：422976
> 
> 赞同：2
> 
> 时间：2009-01-08T02:02:50.817
> 
> 标签：payment-gateway, credit-card

我每月向客户收取服务费用，并希望他们能够访问我的网站并通过信用卡或电子支票付款。我可以与 Authorize.net/ach direct/paypal/etc 进行集成，但是如果有一些开源的东西或一些示例代码可以开始，那会容易得多。我基本上需要用户输入姓名或号码，以便我可以识别付款以及他们想要支付的金额。然而，我唯一能找到的是购物车软件，它看起来不像我需要的那样。有什么我可以用的吗？（免费最好）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T02:22:23.427

我认为这就是很多人使用 PayPal 和 Google Checkout 的原因。他们制作了一些不错的集成按钮，您可以使用它们。

我个人使用过一些 Google Checkout，他们的 API 非常易于使用。您可以在幕后定制整个事情，然后将用户踢到 Google 上，为您在网站上生成的任何“产品”实际支付费用。

此外，您可以直接从 Google 向用户发送发票，这将提示他们前往 Google CO 向您付款。

我发现他们的收费是合理的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T02:17:41.363

请注意，虽然代码可能是免费提供的，但您几乎肯定会向支付处理服务支付交易费用；我建议首先选择其中一个，因为它可能会严重影响您如何进行编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T02:39:09.027

出于几个原因，我可能会建议不要选择开源方法；

1.  客户对“已知”支付方式的信心——
2.  电子支付的责任越来越大
3.  行业举措需要努力保持合规性。（以签证 CISP 为例）
4.  **需要时**提供支持。**（你的名声和好名声就行了）**

 **鉴于您仍然需要一个商家帐户来管理您的交易，因此净节省的资金将微不足道，如果有的话。但是，在上述所有项目中，我会推荐一个可靠的、经过验证的处理器来限制您的责任。

希望能帮助到你。

# c# - 将空对象实例公开为属性

> ID：422984
> 
> 赞同：0
> 
> 时间：2009-01-08T02:04:47.347
> 
> 标签：c#, coding-style

今天我正在查看 Nikhil Kothari 的 Facebook.NET API 中的一些代码。我只是想看看他是如何在那里做一些事情的。

我遇到的一件事是一个对我来说真的很奇怪的属性。

看一下这个：

FacebookRequest.cs 定义一个属性并在构造函数中将其设置为自定义类的新实例：

```
 public FacebookRequest(FacebookSession session) {
        ....
        _parameters = new FacebookRequestParameterList();
    } 
```

私人领域：

私人 FacebookRequestParameterList _parameters;

和财产：

```
 public FacebookRequestParameterList Parameters {
        get {
            return _parameters;
        }
    } 
```

现在 FacebookRequestParameterList 实际上是一个通用字典，因为它继承和扩展字典：

```
public sealed class FacebookRequestParameterList : Dictionary<string, string> {
...
} 
```

好的，基本上当您实例化 FacebookRequest 时，它会自动附带 FacebookRequestParameterList 类的自动实例化实例。因此，Property 本质上是返回 FacebookRequestParameterList 的一个实例。

这正常吗？我不认为我见过很多。对我来说似乎很偷偷摸摸，或者这是标准的东西吗？这似乎是一种奇怪的方式。我发布这个不是为了让他失望，而是要了解这是标准的还是偷偷摸摸的/邪恶的。

在我看来，要求开发人员通过 FacebookRequest 的构造函数传入 FacebookRequestParameterList 的实例会更好。然后通过构造函数初始化私有字段 _parameters 来处理它。为什么我认为这更好？因为那时开发人员确切地知道发生了什么。他们知道该类需要一个参数列表。只是通过适当的方式向我公开这样的实例似乎很奇怪。

我在这儿不准吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T02:13:34.320

我一点也不觉得这很奇怪。它为客户端省去了必须实例化实例的麻烦`FacebookRequestParameterList`，并且`FacebookRequest`保证该类`_parameters`包含该类的有效实例`FacebookRequestParameterList`，而不是`null`.

这对客户来说是方便的问题，也是对类本身的对象有效性的问题。

这里没什么可看的，人们，继续前进。

（编辑：澄清了第一段中的具体实例）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T02:14:08.373

用法是完全有效的。该类只是在`Dictionary<string,string>`内部使用 a 并将其作为属性公开。大概不需要将预烘焙的字典传递给构造函数。

更好的办法是将它公开为`IDictionary<string,string>`而不是具体类的实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T02:14:08.857

你用过数据表吗？当您实例化一个新的 DataTable 时，您会自动拥有一组行和列。必须实例化 DataTable 然后将其传递到您自己的行和列集合中是否有意义？显然不是。它们已经为您准备好了，您可以根据需要向它们添加内容。

（我刚刚选择了一个 DataTable，因为我认为这很容易理解。我相信还有很多其他的例子。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T02:15:12.147

我这很正常，一点也不偷偷摸摸。由于公开的集合属性是只读的（您不能一次替换整个集合），它向您保证您有一个可以使用的实例（除非拥有的类对它做了一些时髦的事情）。

我确实同意这可能是一个更好的设计，但我不知道 API 的其余部分，所以我无法评论它*在这种情况下*是好是坏。一般来说，我同意，应该传入参数（坦率地说，并复制到另一个字典，因为会话对象似乎有某种生命周期）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T02:15:30.400

我不认为这有什么问题。然后，您可以`fbreq.Parameters["param"]="value"`以非常直观的方式执行类似的操作，而要求在构造时提供字典可能会更加混乱（或分散注意力），并且您甚至可能现在还没有创建请求之前的所有参数。

# asp.net - 您将如何从 ASPX 代码中重构页面成员？

> ID：422989
> 
> 赞同：0
> 
> 时间：2009-01-08T02:06:21.510
> 
> 标签：asp.net, refactoring

我继承了一个项目，该项目使用以下模式将参数从后面的代码传递到 aspx 页面。我知道这是错误的，但我对重构它的最佳方式持怀疑态度。

代码背后：

```
using System;
using System.Web;

namespace BadPassing
{
    public partial class _Default : System.Web.UI.Page
    {
        private Random rnd = new Random(); //Is this bad?

        protected int numberOne; //this is bad
        protected int numberTwo; //this is bad

        protected void Page_Load(object sender, EventArgs e)
        {
            numberOne = rnd.Next(100);
            numberTwo = rnd.Next(100);
        }
    }
} 
```

ASPX 页面：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="BadPassing._Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title>Bad Page</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <a href="http://www.google.com/search?q=<%=this.numberOne %>%2B<%=this.numberTwo %>">
            Add <%=this.numberOne %> and <%=this.numberTwo %> using google.
        </a>
    </div>
    </form>
</body>
</html> 
```

我的理解是 numberOne 和 numberTwo 不是线程安全的，如果两个人同时加载页面，可能会导致错误的行为。此外，如果页面依赖 numberOne 和 numberTwo 在回发之间存储值，多个同时用户会导致意外结果。

我对为什么上述技术如此糟糕的理解是否正确，如果是，您将如何最好地重构此代码？

附带说明一下，将无状态页面级服务（如 Random）存储为页面类的成员变量是否不正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T02:16:35.797

这段代码没问题。每次加载页面时都会实例化成员变量，因为每次加载页面时都会创建一个类的新实例。如果变量是静态的，那么只有两个人同时加载页面时才会出现问题。

想想你放在页面上的控件。它们是成员变量，但它们对于不同请求同时加载的页面没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T02:14:33.070

在正常情况下，如果两个用户同时加载页面，他们将使用页面的不同实例。由于 numberOne 和 numberTwo 是实例变量，所以不会有共享状态和线程问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T03:06:29.890

虽然如果您想重构代码（如前所述）并没有真正的错误，但我可能会按照以下方式做一些事情

使用系统；使用 System.Web；

```
namespace BadPassing
{
    public partial class _Default : System.Web.UI.Page
    {
        private Random rnd = new Random(); //Is this bad?

        protected int numberOne; //this is bad
        protected int numberTwo; //this is bad

        protected void Page_Load(object sender, EventArgs e)
        {
            numberOne = rnd.Next(100);
            numberTwo = rnd.Next(100);
            searchLink.NavigationUrl = String.Format("http://www.google.com/search?q={0}%2B{1}", numberOne, numberTwo);
            searchLink.Text = String.Format("Add {0} and {1} using google", numberOne, numberTwo);
        }
    }
} 
```

然后在你的 aspx 页面上添加一个`<asp:hyperlink>`控件

# c++ - std::list 与 std::map 属性？

> ID：422991
> 
> 赞同：0
> 
> 时间：2009-01-08T02:06:25.877
> 
> 标签：c++, stl, list, maps

基本上，我想要一个 std::list 但具有 std::map 属性，例如 find()，我真的需要遍历每个列表条目以找到我需要的内容吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-08T02:09:03.110

如果你想要 std::map 的属性，为什么不使用 std::map 呢？这将比遍历每个元素更有效。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-08T02:42:50.827

Checkout [Boost.MultiIndex](http://www.boost.org/doc/libs/1_37_0/libs/multi_index/doc/index.html)，它比使用带有指针的多个容器更容易和更有效。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-08T02:40:01.020

如果你想要一个容器：

1）插入顺序不重要（这是一个列表）
2）搜索速度是。

然后使用一个

标准::设置<>

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-08T02:09:23.983

使用[std::find](http://www.cppreference.com/wiki/stl/algorithm/find)或[std::find_if](http://www.cppreference.com/wiki/stl/algorithm/find_if)在某个迭代器范围内查找某个值的第一个位置。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-08T02:13:25.240

如果您担心搜索时间但想保留订单，您可以保留两个具有相同数据的容器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-08T02:41:37.460

std::list 的目的是不查找/搜索。这就是 std::map 的用途。列表非常适合插入、提取、移动和使用排序算法。如果您只需要存储数据并随机找到它，请使用地图。如果您想构建数据的存储方式和存储位置，请使用列表。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-08T03:52:43.450

### 选项1

听起来您想要的是单个元素的映射，而不是成对的映射。使用`std::set<T>`，这是一个实现为 的适配器`std::map<T,void>`。这意味着您的所有元素都是独一无二的；也就是说，您的容器中不会有重复项。这也意味着您的元素不会被严格排序；也就是说，您不能在任何给定时间依赖任何元素的位置。然后您可以使用 的`find()`成员函数`std::set<T>`，它将在对数时间内执行快速搜索元素。

### 选项 2

如果您想要的是一个可以快速访问最小或最大元素的容器，那么您可以使用您选择`std::priority_queue<T,C>`的容器`C`。如果未指定，则使用的默认容器是`std::vector<T>`. `std::priority_queue<T>`使用`make_heap()`,`push_heap()`和`pop_heap()`算法，因此需要底层容器支持随机访问迭代器； `std::list<T>`在这种情况下是不够的。`top()`使用成员函数在恒定时间内访问“第一个”（最大或最小）元素。`push()`使用和成员函数推送和弹出第一个元素`pop()`，它们以对数时间运行（实际上是 2*log(n)，因为它们需要搜索和冒泡）。

### 选项 3

如果您想要的只是一个包含对的列表，只需将其声明为：

```
std::list<std::pair<T> > the_list; 
```

这只会给出一个链表，它具有任何其他链表的限制和好处，但会像地图一样保存对。因此，您将使用标准算法来操作列表。您可能需要使用此列表将专门的函数或仿函数传递给算法，以取消引用该对中的键或值。

如果您只想在列表中搜索一个项目，而不考虑效率，您可以使用`std::find()`算法在 O(n) 时间内完成此操作。这正是这个算法的目的，为任何容器提供线性时间搜索功能，而不是做得比这更好。这是我们对未排序的数组或向量、列表等使用的方法。这应该是你最后的选择，因为它可能比其他方法慢得多，尽管它本身会变慢。如果您不经常搜索，如果您知道元素在第一个迭代器附近，如果容器很小，没有更快的替代方案等，请使用此方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-27T11:26:24.387

我需要完全相同的东西，所以我写了一些列表和地图的组合。我称它为 map_list<> 和 hash_map_list<>。基本上，我把源代码放到了 xmap.h 和 xlist.h 中，并将两者结合起来制作了 xmap_list.h。此类的工作方式是将键存储在给定的映射中，但与指向包含该值的节点的指针配对。该节点包含一个指向地图的迭代器。节点保存在单独的链表中。以这种方式，您可以像通常使用地图类一样使用 find 函数，但您也可以按照插入元素的顺序迭代元素，就像列表类一样。您甚至可以像在列表中一样迭代键本身。我没有实现每一个最后的等效列表函数，但你最常使用的大多数函数都在那里（例如，我不处理自定义分配器，尽管您可以自己轻松添加）。它有点像带有 find() 函数的 list<> 。

对于我写这篇文章的项目，我最终转向了 boost::multi_index，但我仍然尽可能使用上面的 map_list<> 类，因为它更轻量级并且更接近 std::list<>界面。

我没有将代码上传到任何地方，但是如果我看到有人对此答案添加了评论，我会尝试将其发布到某个地方，并在此处记下位置。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-24T19:46:19.793

@obecalp 有一个很好的答案。boost MultiIndex 是一个很好的建议。@Bklyn：这*不是*一个“非常愚蠢”的问题。

# c# - C# 在集合上动态应用评估规则

> ID：422999
> 
> 赞同：1
> 
> 时间：2009-01-08T02:08:40.303
> 
> 标签：c#

我有一个固定长度的数据文件需要持久化到数据库中。我使用 XML 文件来定义字段的长度，并使用 FieldItem 类的列表来存储数据。

```
 class FieldItem
   {
        public string ObjectName {get; set;}
        public string ObjectProperty {get; set;}
        public string ObjectValue {get; set;}

        public FieldItem()
       {
       }
   } 
```

所以 FieldItem 看起来像

```
var fieldItem = new FieldItem
                {
                   ObjectName = "Company",
                   ObjectProperty = "Name",
                   ObjectValue = "ABC Corp."
                } 
```

获得 FieldItem 的列表后，我将重新创建 Company 和其他域对象以将它们保存到数据库中。

但在将它们保存到数据库之前，我需要应用一些业务规则来验证数据线。我的数据线将如下所示：

```
var fieldItemList = new List<FieldItem>(){
                new FieldItem {
                    ObjectName="Company",
                    ObjectProperty = "Name",
                    ObjectValue = "ABC"
                }

                new FieldItem{
                    ObjectName = "Product",
                    ObjectProperty = "ProductCode",
                    ObjectValue ="XYZ0123"

                    new FieldItem{
                    ObjectName = "Product",
                    ObjectProperty = "ProductName",
                    ObjectValue ="Christmas Tree"       
                }

                    // other FieldItem objects...

            } 
```

例如，我的规则是检查 company == "ABC" 和 ProductCode == "XYZ0123"。这些规则由用户创建并作为字符串存储在数据库中。我现在正在做的是使用微软的 System.Linq.Dynamic 来评估规则，例如

```
string validationRule = " (ObjectName == \"Company\" And ObjectProperty=\"CompanyName\" And ObjectValue = \"ABC Corp.\") And (ObjectName == \"Product\" And ObjectProperty=\"ProductCode\" And ObjectValue = \"XYZ0123\") ";

  var query = fieldItemList.AsQuerable().Where(validationRule); 
```

然后检查它是否有一行返回以判断该数据行是否通过了规则。显然，它太冗长了。你有更好的建议吗？如果我只喜欢我的规则表达式，我应该怎么做：“Company.CompanyName = 'ABC Corp.' 和 Product.ProductCode = 'XYZ001'"？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T02:57:31.047

考虑使用[FileHelpers](http://www.filehelpers.com)库将文件直接解析为常规 .NET 域对象。我相信这与您的 Dynamic Linq 方法相结合，将为您提供您正在寻找的语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T09:13:32.567

RE：“如果我只喜欢我的规则表达式，例如：“Company.CompanyName = 'ABC Corp' and Product.ProductCode = 'XYZ001'”，我应该怎么做？

将此用户友好的查询：“Company.CompanyName = 'ABC Corp' **AND** Product.ProductCode = 'XYZ001'”映射到对您的数据结构（FieldItem）友好的内容：

“ObjectName = 'Company' AND ObjectProperty = 'CompanyName' AND ObjectValue = 'ABC Corp' **OR** ObjectName = 'Product' AND ObjectProperty = 'ProductCode' AND ObjectValue = 'XYZ001'”

如何知道用户的规则是否通过了规则？统计条件个数，如果匹配到fieldItemList.AsQueryable().Where(itemFieldFriendlyQuery)的结果个数，则数据行根据用户规则有效。

* * *

一些基本的映射器（使用正则表达式或滚动您自己的解析器以使以下代码真正有效）：

```
public Form3()
{
    InitializeComponent();

    string userFriendlyQuery = "Company.CompanyName = 'ABC Corp' AND Product.ProductCode = 'XYZ001'";

    string[] queryConditions = userFriendlyQuery.Split(new string[]{" AND "},StringSplitOptions.None);
    int conditionsCount = queryConditions.Length;

    string itemFieldFriendlyQuery = string.Join(" OR ", 
        queryConditions.Select(condition =>
            {
                var conditionA = condition.Split(new string[] { " = " }, StringSplitOptions.None);

                var left = conditionA[0];
                var leftA = left.Split('.');

                string objectName = leftA[0];
                string objectProperty = leftA[1];

                var right = conditionA[1];

                return string.Format("ObjectName = '{0}' AND ObjectProperty = '{1}' AND ObjectValue = {2}",
                    objectName, objectProperty, right);
            }
        ).ToArray());

    MessageBox.Show(itemFieldFriendlyQuery);

    // outputs: "ObjectName = 'Company' AND ObjectProperty = 'CompanyName' AND ObjectValue = 'ABC Corp' OR ObjectName = 'Product' AND ObjectProperty = 'ProductCode' AND ObjectValue = 'XYZ001'"

    bool isValid = fieldItemList.AsQueryable().Where(itemFieldFriendlyQuery).Count() == conditionsCount;

    MessageBox.Show(isValid.ToString());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T02:29:36.253

您可以让他们将其作为 C# 代码表达式存储在数据库中，然后使用 CodeDom 类将其解析并编译成一个类型，该类型公开了一个将运行比较的方法。

这将创建很多临时程序集，这将是一个要管理的 PITA，IMO。

相反，我仍将 C# 表示法用于表达式语法，但不是将其编译为代码，而是动态创建一个 lambda 表达式（通过 Expression 类），然后编译为一个接受所有参数的委托（您将需要一个映射机制在这里），然后只需使用您创建的类型调用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T02:58:34.370

对于您的`FieldItem`课程，您不能创建一个可以注入 Predicate 委托方法的属性，例如：

```
class FieldItem
{
    public string ObjectName {get; set;}
    public string ObjectProperty {get; set;}
    public string ObjectValue {get; set;}
    public Predicate<FieldItem> EvalMethod { private get; set; }

    public FieldItem()
    {
    }

    public bool Evaluate()
    {
        return EvalMethod(this);
    }
} 
```

然后，为了构建您的`FieldItem`对象，您可以使用以下内容：

```
new FieldItem { ObjectName = "SomeObject",
                ObjectProperty = "SomeProperty",
                ObjectValue = "SomeValue",
                EvalMethod = GetEvalMethodFor("SomeObject")
               } 
```

当然，您必须有某种解析器（`GetEvalMethodFor`上面的方法）才能将您的validationRule 字符串转换为布尔评估方法。

然后，在您的集合中，您可以调用`Evaluate()`内部循环，例如`foreach`循环。

**更新**

如果您需要评估列表中的每个对象，您可以这样做：

```
bool areAllItemsValid = true;

foreach (var f in fieldItemList)
{
    areAllItemsValid = areAllItemsValid && f.Evaluate();

    if (areAllItemsValid)
    {
        continue;
    }
    else
    {
        return false;
    }
}

return true; 
```

您可以选择继承`List<FieldItem>`并创建一个`EvaluateAll()`包含上述内容的方法，或者将其声明为一个单独的对象中的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T03:02:30.617

顺便说一句：为什么是类而不是结构？

数据的值类型，行为的引用类型。****``