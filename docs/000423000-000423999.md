# StackOverflow 问答 000423000-000423999

# java - OpenOffice .xls 导出为 PDF 导致复选框重叠

> ID：423004
> 
> 赞同：3
> 
> 时间：2009-01-08T02:10:05.403
> 
> 标签：java, pdf, openoffice.org, xls

[OpenOffice](http://en.wikipedia.org/wiki/OpenOffice.org) Excel 文件导出到 PDF 正在以编程方式完成，我想知道是否有办法通过在转换过程中传递某种标志或其他东西来解决此问题，这将使 PDF 文档中的单元格背景透明。

请注意示例 PDF 输出。原始 Excel 文件根本不重叠边缘：[http ://www.freeimagehosting.net/uploads/4ab8dd9af0.jpg](http://www.freeimagehosting.net/uploads/4ab8dd9af0.jpg)

这是PDF导出前的原始Excel文件：[http ://www.freeimagehosting.net/uploads/0cdcaad47a.jpg](http://www.freeimagehosting.net/uploads/0cdcaad47a.jpg)

OpenOffice 2.4 和 3.0 都有同样的缺陷。

建议将是最受欢迎的，这是支持这个项目的最后一件事。

按照以下链接获取 OpenOffice 网站上的示例：[http ://user.services.openoffice.org/en/forum/viewtopic.php?f=20&t=13528](http://user.services.openoffice.org/en/forum/viewtopic.php?f=20&t=13528)

这是问题跟踪链接：[http ://www.openoffice.org/issues/show_bug.cgi?id=97856](http://www.openoffice.org/issues/show_bug.cgi?id=97856)

还有一些代码，它是[Jython](http://en.wikipedia.org/wiki/Jython) 2.2.1 和 Java 2.5。

```
def _save_as_pdf(self, docSource):
    dirName=os.path.dirname(docSource)
    baseName=os.path.basename(docSource)
    baseName, ext=os.path.splitext(baseName)
    dirTmpPdfConverted=os.path.join(dirName + DIR + PDF_TEMP_CONVERT_DIR)
    if not os.path.exists(dirTmpPdfConverted):
        os.makedirs(dirTmpPdfConverted)
    pdfDest=os.path.join(dirTmpPdfConverted + DIR + baseName + ".pdf")
    url_save=self._create_UNO_File_URL(pdfDest)
    properties=self._create_properties(ext)
    try:
        try:
            self._xstorable=UnoRuntime.queryInterface(XStorable, self._doc)
            self._xstorable.storeToURL(url_save, properties)
        except AttributeError,e:
                self.logger.info("saving as pdf has problem: (" + str(e) + ")")
                raise e
        except:
            self.logger.info("storeToURL exception")
            raise
    finally:
        self.logger.info("converted document " + baseName + ext)
        if not self._doc:
            xCloseable = UnoRuntime.queryInterface(XCloseable, self._doc)
            if not xCloseable:
                try:
                    xCloseable.close(false)
                except CloseVetoException, (ex):
                    xComp = UnoRuntime.queryInterface(XComponent, self._doc)
                    xComp.dispose()
        else:
            xComp = UnoRuntime.queryInterface(XComponent, self._doc)
            xComp.dispose()
        self._doc=None

def _create_properties(self,ext):
    properties=[]
    p=PropertyValue()
    p.Name="Overwrite"
    p.Value=True
    properties.append(p)
    p=PropertyValue()
    p.Name="FilterName"
    if   ext==".doc":
        p.Value='writer_pdf_Export'
    elif ext==".rtf":
        p.Value='writer_pdf_Export'
    elif   ext==".html":
        p.Value='writer_pdf_Export'
    elif ext==".htm":
        p.Value='writer_pdf_Export'
    elif ext==".xls":
        p.Value='calc_pdf_Export'
    elif ext==".tif":
        p.Value='draw_pdf_Export'
    elif ext==".tiff":
        p.Value='draw_pdf_Export'
    properties.append(p)
    return tuple(properties) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T15:33:27.657

您是否可以使包含超大复选框的行更大一些？

这将是一个 hack，而不是你所要求的，但它可能会在比等待修复更短的时间内产生结果。

我检查了 Office 2003 和 OpenOffice 3 中的复选框，发现虽然 Office 允许在对象上使用透明背景，但 OpenOffice 不允许。在 2.4 的发行说明中提到了表单对象的透明背景，但我找不到在复选框上指定它的方法。

据我所见，“普通打印”和打印预览中的透明复选框背景甚至可能是一种黑客攻击，因为似乎没有指示透明背景的属性（背景颜色为默认，而办公室有背景透明）。

然而，积极的是，印刷是可以的。打印到可以定义文件名的基于文件的打印机将是解决方案。也许 Cups 有一个打印到 pdf 文件的打印机？（在这种情况下，您不会使用 PDF 导出而是使用打印）。

# c - 如何生成与直方图匹配的点？

> ID：423006
> 
> 赞同：11
> 
> 时间：2009-01-08T02:10:31.487
> 
> 标签：c, algorithm, histogram, probability, numerical-analysis

我正在研究一个模拟系统。我很快就会有几个模拟输入值的真实世界分布的实验数据（直方图）。

当模拟运行时，我希望能够产生与测量分布相匹配的随机值。我宁愿这样做而不存储原始直方图。有什么好的方法

1.  将直方图映射到一组代表分布的参数？
2.  在运行时生成基于这些参数的值？

编辑：输入数据是几种不同类型事件的事件持续时间。我期望不同的类型会有不同的分布函数。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-08T02:27:52.870

至少有两种选择：

1.  对直方图进行积分并进行数值反转。
2.  拒绝

## 数值积分

来自William R. Gibbs*的《现代物理学计算》 ：*

> 人们总是可以对 [函数] 进行数值积分并反转 [ *cdf* ]，但这通常不是很令人满意，尤其是在*pdf*快速变化的情况下。

您实际上构建了一个表格，将范围`[0-1)`转换为目标分布中的适当范围。然后扔出你通常的（高质量）PRNG 并与表格一起翻译。它很麻烦，但清晰、可行且完全通用。

## 拒绝：

归一化目标直方图，然后

1.  掷骰子以`x`随机选择范围内的位置（ ）。
2.  再次抛出，如果新的随机数小于这个bin中的归一化直方图，就选择这个点。否则转到 (1)。

再次，头脑简单但清晰且有效。分布可能很慢，概率非常低（长尾峰）。

* * *

使用这两种方法，如果不需要阶跃函数直方图，您*可以使用分段多项式拟合或样条曲线来近似数据以生成平滑曲线——但将其留到以后，因为它可能是过早的优化。*

* * *

对于特殊情况，可能存在更好的方法。

所有这些都是非常标准的，如果需要更多细节，应该出现在任何数值分析教科书中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T03:09:03.413

有关该问题的更多信息将很有用。例如，直方图是什么类型的值？它们是分类的（例如颜色、字母）还是连续的（例如高度、时间）？

如果直方图超过分类数据，我认为可能难以对分布进行参数化，除非类别之间存在许多相关性。

如果直方图超过连续数据，您可能会尝试使用高斯混合来拟合分布。也就是说，尝试使用 $\sum_{i=1}^n w_i N(m_i,v_i)$ 拟合直方图，其中 m_i 和 v_i 是均值和方差。然后，当您想要生成数据时，您首先从 1..n 中以与权重 w_i 成比例的概率对 i 进行采样，然后像从任何高斯中一样对 x ~ n(m_i,v_i) 进行采样。

无论哪种方式，您都可能想了解更多关于[混合模型](http://en.wikipedia.org/wiki/Mixture_model)的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T18:17:44.747

因此，正如@dmckee 所说 ，为了生成给定的概率分布，我想要的是一个[分位数函数](http://en.wikipedia.org/wiki/Quantile_function)，它是 [累积分布函数的倒数。](http://en.wikipedia.org/wiki/Cumulative_distribution_function)

问题变成了：生成和存储描述给定连续直方图的分位数函数的最佳方法是什么？我有一种感觉，答案将很大程度上取决于输入的形状——如果它遵循任何类型的模式，应该对最一般的情况进行简化。我会在我去的时候在这里更新。

* * *

编辑：

本周我的一次谈话让我想起了这个问题。如果我放弃将直方图描述为等式，而只存储表格，我可以在 O(1) 时间内进行选择吗？事实证明，您可以在不损失任何精度的情况下，以 O(N lgN) 的构建时间为代价。

创建一个包含 N 个项目的数组。对数组进行均匀随机选择将找到概率为 1/N 的项目。对于每个项目，存储实际应选择该项目的命中分数，以及如果该项目未选择则将选择的另一项目的索引。

加权随机采样，C 实现：

```
//data structure
typedef struct wrs_data {
  double share; 
  int pair;
  int idx;
} wrs_t;

//sort helper
int wrs_sharecmp(const void* a, const void* b) {
  double delta = ((wrs_t*)a)->share - ((wrs_t*)b)->share;
  return (delta<0) ? -1 : (delta>0);
}

//Initialize the data structure
wrs_t* wrs_create(int* weights, size_t N) {
  wrs_t* data = malloc(sizeof(wrs_t));
  double sum = 0;
  int i;
  for (i=0;i<N;i++) { sum+=weights[i]; }
  for (i=0;i<N;i++) {
    //what percent of the ideal distribution is in this bucket?
    data[i].share = weights[i]/(sum/N); 
    data[i].pair = N;
    data[i].idx = i;
  }
  //sort ascending by size
  qsort(data,N, sizeof(wrs_t),wrs_sharecmp);

  int j=N-1; //the biggest bucket
  for (i=0;i<j;i++) {
    int check = i;
    double excess = 1.0 - data[check].share;
    while (excess>0 && i<j) {
      //If this bucket has less samples than a flat distribution,
      //it will be hit more frequently than it should be.  
      //So send excess hits to a bucket which has too many samples.
      data[check].pair=j; 
      // Account for the fact that the paired bucket will be hit more often,
      data[j].share -= excess;  
      excess = 1.0 - data[j].share;
      // If paired bucket now has excess hits, send to new largest bucket at j-1
      if (excess >= 0) { check=j--;} 
    }
  }
  return data;
}

int wrs_pick(wrs_t* collection, size_t N)
//O(1) weighted random sampling (after preparing the collection).
//Randomly select a bucket, and a percentage.
//If the percentage is greater than that bucket's share of hits, 
// use it's paired bucket.
{
  int idx = rand_in_range(0,N);
  double pct = rand_percent();
  if (pct > collection[idx].share) { idx = collection[idx].pair; }
  return collection[idx].idx;
} 
```

* * *

编辑 2：经过一番研究，我发现甚至可以在 O(N) 时间内完成构建。通过仔细跟踪，您无需对数组进行排序即可找到大小箱。 [在这里更新了实现](https://gist.github.com/ashelly/cc0cd6916235a04df49a)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T02:52:29.110

如果您需要提取大量具有离散点加权分布的样本，请查看[类似问题的答案](https://stackoverflow.com/questions/352670/weighted-random-selection-with-and-without-replacement#353576)。

但是，如果您需要使用直方图逼近一些连续随机函数，那么您最好的选择可能是 dmckee 的数字积分答案。或者，您可以使用锯齿，并将点存储在左侧，并在两点之间选择一个统一的数字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-20T12:08:17.747

要从直方图（原始或缩减）中进行选择， [Walker 的别名方法](http://code.activestate.com/recipes/576564) 既快速又简单。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-01-08T02:18:55.167

对于正态分布，以下可能会有所帮助：

[http://en.wikipedia.org/wiki/Normal_distribution#Generating_values_for_normal_random_variables](http://en.wikipedia.org/wiki/Normal_distribution#Generating_values_for_normal_random_variables)

# .net - Asp.Net Mvc 实用程序和帮助程序

> ID：423007
> 
> 赞同：4
> 
> 时间：2009-01-08T02:11:50.267
> 
> 标签：.net, asp.net-mvc

我对 ASP.Net Mvc 真的很陌生，但对 Asp.Net 并不陌生。我知道所有的 HtmlHelper 类，但是我在使用 Html.ActionLink 时遇到了编码问题。[我在这里](https://stackoverflow.com/questions/422929/how-do-i-bypass-the-html-encoding-when-using-html-actionlink-in-mvc)问了一个问题，并立即得到了关于使用 UrlHelper 类的答案，我什至不知道它存在。

我的问题是，还有其他类似的课程我应该注意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T02:17:28.430

[您可以在www.codeplex.com/aspnet](http://www.codeplex.com/aspnet)找到 ASP.NET MVC 的源代码。单击 Source 选项卡，选择一个版本，然后沿着 MVC 树向下导航以找到所有 MVC 优点。查看 Controller 和 View 代码以从基础对象中找到可供您使用的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T02:18:33.543

我最好的建议是快速浏览[ASP.NET MVC beta 源代码](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=18593)中的类。到目前为止，阅读库的源代码是成为其使用专家的最佳方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T20:55:48.500

*   CodePlex 上有**[MVCContrib](http://www.codeplex.com/MVCContrib)**。

*   我的问题与您的类似，但[关于 ActionResults](https://stackoverflow.com/questions/486063/what-clever-things-have-you-done-with-an-asp-net-mvc-action-method)（没有得到很多答复！）

*   不是 MVC 助手，但我今天刚刚从[JonSkeet的](http://www.yoda.arachsys.com/csharp/miscutil/usage/smartenumerable.html)[MiscUtils](http://www.yoda.arachsys.com/csharp/miscutil/)中找到了 SmartEnumerable。在使用符号生成数据时绝对非常有用，`<% %>`因为您可以遍历集合并根据当前项目是第一项还是最后一项插入特殊逻辑。

**乔恩的例子**：

```
foreach (SmartEnumerable<string>.Entry entry in
         new SmartEnumerable<string>(list))
{
    Console.WriteLine ("{0,-7} {1} ({2}) {3}",
                       entry.IsLast  ? "Last ->" : "",
                       entry.Value,
                       entry.Index,
                       entry.IsFirst ? "<- First" : "");
} 
```

**ASP.NET MVC**

`class="<% if (item.IsLast) ? "bulletpoint last" : "bulletpoint" %>"`

# gwt - GWT——托管模式字体看起来比编译版本大

> ID：423013
> 
> 赞同：0
> 
> 时间：2009-01-08T02:14:27.517
> 
> 标签：gwt

当我在我的笔记本电脑上创建一个应用程序时，它编译并呈现得很好。如果我编译页面并将其放在服务器上托管它，它仍然可以在多台计算机上正常呈现。

但是，如果我将代码传输到我的桌面并在我的桌面上运行它，那么所有字体的大小都会被弄乱。一切都大得多。正如您可能猜到的那样，这大大扰乱了我的布局。

在台式机上，我使用的是 GWT 浏览器...

关于为什么相同的代码在两台不同的机器上呈现不同的任何想法？

如果我在桌面上编译代码并将其放在服务器上，它看起来就像笔记本电脑版本（小）。

基本上我有这个：

```
Laptop
   Hosted: small
   Server: small

Desktop
   Hosted: large
   Server: small 
```

我已经针对 IE、firefox 和 safari 进行了检查。

为什么托管模式看起来不同？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T03:55:50.697

因为您在两台机器上有不同的默认字体大小和/或显示器 dpi 设置？

AIUI GWT 标准样式只是将字体大小设置为“小”，这将相对于浏览器中设置的默认字体大小。将字体设置为以像素为单位的测量值，或者更好的是，使用可以处理各种字体大小的更具流动性的布局。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T04:15:54.027

GWT Debug 浏览器使用您机器上的本机浏览器（因此在 Windows 上使用 IE，在 Mac 上使用 Safari，在 Linux 上使用 Firefox）。

这不是 GWT 问题，但某些字体在不同的浏览器中看起来不同（即使大小和样式相同）。您需要找到一种在您想要支持的所有浏览器中看起来都不错的字体和大小，然后将其设置为文本的 css 样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T03:51:04.497

这与您使用的浏览器有关，您桌面上的浏览器可能会将大字体设置为首选项。尝试恢复该浏览器的默认设置或尝试使用其他浏览器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T21:32:31.777

我也在 GWT 做一个项目，我也受到了打击，这是我的看法....

[咆哮]

这整个 html、css、javascript 球并不是随机掉落的……m *tha f* cka 是从 f *ck* ng 空间站掉落的。你会认为现在所有自称聪明的人都在研究这些东西，现在已经有了解决方案。那里有一百万个框架可以帮助避免拼凑出一个大问题，但事实是意大利面条之夜名称很久以前就开始了，并且无法清理，它被称为 html/javascript。

没有浏览器标准。有些网站只支持 IE，我会得到那个框，上面写着“对不起，你必须使用 IE”，然后邻居们不得不听到我的诅咒，因为如果你不运行 Windows，你应该怎么做？
[/咆哮]

# xml - 从 sql server 2005 中选择 xml（行显示为空）

> ID：423023
> 
> 赞同：0
> 
> 时间：2009-01-08T02:18:28.787
> 
> 标签：xml, sql-server-2005, ssms

我有一个非常长的 xml 行，它有 > 800000 个字符。“客户端”也是“服务器”。操作系统是 windows 2k8 x64。数据库和客户端一样有足够的内存。

问题是，一旦我达到了一些神奇的字符数——恰好是 43679 个 xml 字符——该行将返回 APPEARS 是什么。我称它们为“xml chars”，因为 sql server 在计算长度时显然会删除任何空格 - 我用这个 sql 执行此操作： len(convert(varchar(max), xsl)) 为什么数字是 43679 也让我感到困惑...

外面有人有这个问题吗？实际上，我已经使用 Windows 2k3 和另一台 Windows 2k8 服务器连接到同一台服务器，并且除了这台机器（实际服务器本身）之外的任何其他机器上都没有问题。

我还找到了查询结果-> sql server-> results to grid，并将 xml 的限制设置为“无限”，但它似乎仍然没有“工作”......（那些工作的将这个设置为 2mb供参考）

感谢您的任何和所有评论 - 我会尝试任何事情......它不会阻止任何工作 - 我确信这只是一个客户，但它让我发疯了！:)

更新：仅供参考-问题不在于转换-我实际上不想转换它。我在此示例中使用 convert 的唯一原因是使用 len（len 不适用于 xml 数据类型），因此我可以找到 xml 的“长度”。

问题是这个...

```
INSERT INTO someTableForXml(theXml)
VALUES ('<this><is><some><really>long xml</really></some></is></this>') 
```

现在复制并粘贴它，直到你有大约 100,000 行 xml 并插入它......当我使用以下方式选择行时：

```
SELECT * FROM someTableForXml 
```

我回到 1 行，在“网格”中，我得到了一个很好的 xml 小超链接，当我单击它时，会在新选项卡中显示“完整 xml”。但是对我来说……一旦我通过了这个奇怪的魔术数字，它就会停止这样做，并且看起来很空白。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-23T20:06:26.500

我认为这是因为您`<?xml version="1.0" encoding="UTF-16"?>`的 XML 开头没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T05:56:01.860

我认为您有两个不同的问题：

1.  SSMS 行为
2.  xml转换

**SSMS 行为**

尝试 bcp 转储到文件中，看看你得到了什么。这样你就绕过了 SSMS，这很奇怪。

或转换为 varchar(max) 以便 SSMS 将其视为 LOB 数据（但请参阅下一个信息）

**xml 转换** 43679 可能是由转换为 varchar(max) 引起的。请参阅[CAST AND CONVERT](http://msdn.microsoft.com/en-us/library/ms187928(SQL.90).aspx)和 CONVERT for XML 的样式参数。默认样式“丢弃无关紧要的空白”并且您没有上述样式。

我认为 SSMS 基于具有正确 CONVERT 的列应用非 LOB 数据的最大长度（65535），但显示它时没有空格。因此出现差异。

# java - Java中的接口：不能使实现的方法受保护或私有

> ID：423032
> 
> 赞同：29
> 
> 时间：2009-01-08T02:21:06.847
> 
> 标签：java, interface, access-specifier

我知道接口必须是公共的。但是，我不希望那样。

我希望我实现的方法只能从他们自己的包中访问，所以我希望我实现的方法受到保护。

问题是我无法保护接口或实现的方法。

什么是解决方法？是否有与此问题相关的设计模式？

从 Java 指南来看，抽象类也无法完成这项工作。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-08T02:29:13.243

读[这个](http://java.sun.com/docs/books/tutorial/java/IandI/interfaceDef.html)。

“公共访问说明符表示该接口可以被任何包中的任何类使用。**如果您不指定该接口是公共的，那么您的接口将只能被定义在与该接口相同的包中的类访问**。”

那是你要的吗？

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-08T02:29:51.743

你的类可以使用包保护并且仍然实现一个接口：

```
class Foo implements Runnable 
{
    public void run()
    {
    }
} 
```

如果您希望某些方法受到保护/打包而其他方法则不，听起来您的类有多个职责，并且应该拆分为多个。

在阅读对此和其他回复的评论后进行编辑：

如果您以某种方式认为方法的可见性会影响调用该方法的能力，请再想一想。如果不走极端，你不能阻止某人使用反射来识别你的类的方法并调用它们。但是，这不是问题：除非有人试图破解您的代码，否则他们不会调用随机方法。

相反，将私有/受保护方法视为定义子类的合同，并使用接口来定义与外界的合同。

哦，对于决定我的示例应该使用 K&R 支撑的人：如果服务条款中指定了，当然可以。否则，你就不能找到更好的事情来处理你的时间吗？

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-08T03:02:09.527

当我反对这一点时，我使用包可访问的内部或嵌套类来实现接口，将实现的方法推出公共类。

通常是因为我有一个具有特定公共 API 的类，它必须实现其他东西才能完成工作（通常是因为其他东西是伪装成接口 <grin> 的回调）——这种情况经常发生在 Comparable 之类的事情上。我不希望公共 API 被（强制公共）接口实现污染。

希望这可以帮助。

此外，如果您真的想要仅由包访问的方法，则不需要受保护的范围说明符，您需要默认（省略）范围说明符。当然，使用 protected 将允许子类看到方法。

顺便说一句，我认为接口方法被推断为公共的原因是因为只有同一个包中的类实现的接口是非常例外的；它们最常被另一个包中的某些东西调用，这意味着它们需要公开。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-13T06:31:08.533

这个问题是基于一个错误的陈述：

> *我知道接口必须是公共的*

并非如此，您可以拥有带有默认访问修饰符的接口。

> *问题是我无法使接口或实现的方法受到保护*

这里是：

```
C:\oreyes\cosas\java\interfaces>type a\*.java
a\Inter.java
package a;

interface Inter {
    public void face();
}

a\Face.java
package a;

class Face implements Inter {
    public void face() {
        System.out.println( "face" );
    }
}

C:\oreyes\cosas\java\interfaces>type b\*.java
b\Test.java

package b;
import a.Inter;
import a.Face;

public class Test {
    public static void main( String [] args ) {
        Inter inter = new Face();
        inter.face();
    }
}

C:\oreyes\cosas\java\interfaces>javac -d . a\*.java b\Test.java
b\Test.java:2: a.Inter is not public in a; cannot be accessed from outside package
import a.Inter;
        ^
b\Test.java:3: a.Face is not public in a; cannot be accessed from outside package
import a.Face;
        ^
b\Test.java:7: cannot find symbol
symbol  : class Inter
location: class b.Test
        Inter inter = new Face();
        ^
b\Test.java:7: cannot find symbol
symbol  : class Face
location: class b.Test
        Inter inter = new Face();
                          ^
4 errors

C:\oreyes\cosas\java\interfaces> 
```

因此，实现您想要的，防止在包之外使用接口和类。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-08T02:30:09.933

这是使用抽象类完成的方法。

唯一不方便的是它使您成为“子类”。

根据java指南，你应该“大部分”时间遵循这个建议，但我认为在这种情况下它会没问题。

```
public abstract class Ab { 
    protected abstract void method();
    abstract void otherMethod();
    public static void main( String [] args ) { 
        Ab a = new AbImpl();
        a.method();
        a.otherMethod();
    }
}
class AbImpl extends Ab {
    protected void method(){
        System.out.println( "method invoked from: " + this.getClass().getName() );
    }
    void otherMethod(){ 
        System.out.println("This time \"default\" access from: " + this.getClass().getName()  );
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-06-24T19:51:27.303

这是另一个解决方案，受 C++ Pimpl 习惯用法的启发。

如果您想实现一个接口，但不希望该实现公开，您可以创建一个实现该接口的匿名内部类的组合对象。

这是一个例子。假设你有这个界面：

```
public interface Iface {
    public void doSomething();
} 
```

您创建一个`Iface`类型的对象，并将您的实现放在那里：

```
public class IfaceUser {
    private int someValue;
    // Here's our implementor
    private Iface impl = new Iface() {
        public void doSomething() {
            someValue++;
        }
    };
} 
```

每当您需要调用`doSomething()`时，您都可以在您的组合`impl`对象上调用它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-12-02T23:59:41.297

我刚刚遇到这个试图构建一个受保护的方法，目的是只在测试用例中使用它。我想删除填充到数据库表中的测试数据。无论如何，我受到[@Karl Giesing](https://stackoverflow.com/users/835856/karl-giesing)[帖子的](https://stackoverflow.com/a/24395109/1024005)启发。不幸的是，它没有用。我确实想出了一种使用受保护的内部类使其工作的方法。

界面：

```
package foo;
interface SomeProtectedFoo {
    int doSomeFoo();
} 
```

然后在公共类中定义为受保护的内部类：

```
package foo;
public class MyFoo implements SomePublicFoo {
    // public stuff
    protected class ProtectedFoo implements SomeProtectedFoo {
        public int doSomeFoo() { ... }
    }
    protected ProtectedFoo pFoo;
    protected ProtectedFoo gimmeFoo() {
        return new ProtectedFoo();
    }
} 
```

然后，您只能从同一包中的其他类访问受保护的方法，因为我的测试代码如下所示：

```
package foo;
public class FooTest {
    MyFoo myFoo = new MyFoo();
    void doProtectedFoo() {
        myFoo.pFoo = myFoo.gimmeFoo();
        myFoo.pFoo.doSomeFoo();
    }
} 
```

原始海报有点晚了，但是，嘿，我刚刚找到了。:D

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-08T02:28:10.140

您可以使用封装而不是继承。

也就是说，创建你的类（它不会继承任何东西）并在其中有一个你想要扩展的对象的实例。

然后你可以只暴露你想要的。

这样做的明显缺点是您必须显式地为要公开的所有内容传递方法。而且它不会是子类...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-08T02:44:53.757

我只想创建一个抽象类。它没有害处。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-12-12T13:01:19.303

使用接口，您希望定义可以由各种实现类公开的方法。拥有一个带有受保护方法的接口并不能达到这个目的。

我猜你的问题可以通过重新设计你的类层次结构来解决。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-09-21T10:59:03.353

我认为你现在可以在 Java 9 版本中使用它。从 Java 9 的 openJdk 注释中，

> 接口中的私有方法支持曾一度考虑包含在 Java SE 8 中，作为增加对 Lambda 表达式支持的努力的一部分，但为了更好地专注于 Java SE 8 的更高优先级任务而被撤回。现在建议支持对于私有接口方法，从而使接口的非抽象方法能够在它们之间共享代码。

参考[https://bugs.openjdk.java.net/browse/JDK-8071453](https://bugs.openjdk.java.net/browse/JDK-8071453)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-04-12T22:53:42.703

解决这个问题的一种方法是（取决于情况）只创建一个匿名内部类来实现具有`protected`或`private`作用域的接口。例如：

```
public class Foo {
    interface Callback {
        void hiddenMethod();
    }

    public Foo(Callback callback) {
    }
} 
```

然后在用户中`Foo`：

```
public class Bar {
    private Foo.Callback callback = new Foo.Callback() { 
        @Override public void hiddenMethod() { ... }
    };
    private Foo foo = new Foo(callback);
} 
```

这可以使您避免以下情况：

```
public class Bar implements Foo.Callback {
    private Foo foo = new Foo(this);

    // uh-oh! the method is public!
    @Override public void hiddenMethod() { ... }
} 
```

# windows - 如何永久绕过 Windows XP 启动？

> ID：423035
> 
> 赞同：2
> 
> 时间：2009-01-08T02:22:33.910
> 
> 标签：windows, windows-xp, embedded, hibernation

我有一个适用于 Windows XP 的应用程序。此应用程序与硬件一起部署。该应用程序是在这些机器上运行的唯一应用程序。这些机器从未连接到互联网。我对这些机器绕过 Windows XP 启动的即时启动（或快速启动）选项很感兴趣。

这类似于 Windows XP 的“休眠”，但不完全一样。在休眠状态下，内存状态只从磁盘读取一次——下次系统启动时。我希望将内存状态永久存储到磁盘上，因此系统每次总是从同一个位置启动，无论它是如何关闭的。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T01:25:09.970

听起来您正在寻找 Windows Embedded 的[Hibernate Once, Resume Many](http://msdn.microsoft.com/en-us/library/bb499376.aspx)功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T14:14:50.290

如果你喜欢“休眠”，你可以使用 VMWare。

1.  在主机上安装 ArchLinux 和 VMWare。
2.  准备您的 Windows XP 作为来宾操作系统。
3.  自定义主机的启动过程，让它运行VMWare并将Windows恢复到快照。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T02:33:24.310

嗯，简短的回答是“不容易！”，但一种方法是尝试用您自己的应用程序/脚本替换 Windows shell，该应用程序/脚本启动您自己的自定义界面/状态，而不是默认的 Explorer。基本上它是使用这个 reg 键完成的：

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\shell

在进行快速谷歌搜索后，这方面的信息实际上似乎相当稀缺，但下面的这个链接提供了更多细节：

[http://www.trap17.com/index.php/how-change-windows-xp-shell_t20367.html](http://www.trap17.com/index.php/how-change-windows-xp-shell_t20367.html)

我认为，如果您在“Windows XP shell 替换”上进行 Google Groups 搜索，您可能会得到一些信息更丰富的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T13:50:27.970

您可以尝试在它们上[安装 TweakUI](http://windowsxp.mvps.org/Autologon.htm)，并让它们自动登录。一旦你这样做了，只需将你的应用程序添加到启动菜单（或在注册表中，在：

```
HKLM\Software\Microsoft\Windows\CurrentVersion\Run 
```

Jeff Atwood 在这[件事](http://www.codinghorror.com/blog/archives/000565.html)上有一个帖子。

# ruby-on-rails - Ruby 对象成员访问：这是怎么做到的？

> ID：423055
> 
> 赞同：2
> 
> 时间：2009-01-08T02:34:29.627
> 
> 标签：ruby-on-rails, ruby

看了这个问题：

[如何将对象的字段转储到控制台？](https://stackoverflow.com/questions/354547/print-ruby-object-members)

我有一个相关的问题。我对 Ruby 比较陌生，所以希望这是显而易见的。我有一个我认为是从 MIME::Types 库生成的 Ruby 对象。我正在寻找一个特定文件的简单文件类型。以下是 irb 中发生的情况：

```
>> require 'mime/types'
=> ["MIME"]
>> text = MIME::Types['text/plain; charset=us-ascii']
=> [#<MIME::Type:0x2483ee0 @simplified="text/plain", @obsolete=nil, @raw_media_type="text", @content_type="text/plain", @system=nil, @registered=true, @url=["RFC2046", "RFC3676"], @media_type="text", @encoding="quoted-printable", @sub_type="plain", @raw_sub_type="plain", @extensions=["txt", "asc", "c", "cc", "h", "hh", "cpp", "hpp", "dat", "hlp"]>, #<MIME::Type:0x2476024 @simplified="text/plain", @obsolete=nil, @raw_media_type="text", @content_type="text/plain", @system=/vms/, @registered=true, @url=nil, @media_type="text", @encoding="8bit", @sub_type="plain", @raw_sub_type="plain", @extensions=["doc"]>]
>> puts text.media_type
NoMethodError: undefined method `media_type' for #<Array:0x2483af8>
    from (irb):4 
```

我的理解是，我应该能够使用点语法访问该对象的属性——事实上，我从 ( [http://mime-types.rubyforge.org/](http://mime-types.rubyforge.org/) ) 中学到的页面正是如此！那么我怎么会得到一个“没有方法”的错误呢？我尝试了各种其他语法，但没有运气。

在此先感谢，亚伦。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T02:44:27.143

`MIME::Types`返回一个对象数组`MIME::Type`。这些对象会按您的预期响应。

```
>> puts text[0].media_type
text
=> nil 
```

Ruby 的`class`方法对于诊断此类问题很有用。

```
>> puts text.class
array
=> nil 
```

您还可以使用该`methods`方法获取对象响应的方法的完整列表。

# audio - 如何在 Windows Vista 中以编程方式启动麦克风音量控制面板？

> ID：423062
> 
> 赞同：8
> 
> 时间：2009-01-08T02:36:41.527
> 
> 标签：audio, windows-vista

我想让用户调整麦克风音量。与其重新发明轮子，我们（在 XP 中）只需启动音量控制面板（通过运行 sndvol32.exe）。

您可以通过以下方式在 Win **Vista中调出***扬声器*音量控制： SndVol.exe

 ***在 XP 中，您可以指定命令行参数 -R 来显示麦克风音量。*

任何人都知道 SndVol.exe 的命令行参数是什么来显示**Windows Vista**的麦克风音量？

或者其他方式来显示麦克风音量控制面板？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-23T22:41:24.923

我想你想要的是“control.exe mmsys.cpl,,1”

> 如果要访问混音器和其他功能，可以使用以下快捷方式：
> • 左主音量：SndVol.exe -f 0
> • 右主音量：SndVol.exe -f 49825268
> • 左混音器：SndVol.exe -r 0
> • 音量混合器右：SndVol.exe -r 49490633
> • 播放设备：control.exe mmsys.cpl,,0
> • 录音设备：control.exe mmsys.cpl,,1
> • 声音：control.exe mmsys.cpl,,2
> 来自[http://www.errorforum.com/microsoft-windows-vista-error/4636-vista-tips-tricks-tweaks.html](http://www.errorforum.com/microsoft-windows-vista-error/4636-vista-tips-tricks-tweaks.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T02:55:23.050

我对你的问题有点困惑。这为我打开了录制窗口（[参考](http://demins.blogspot.com/2007/06/windows-xp-volume-control-from-command.html)）：

```
sndvol32 -record 
```

您是否要隐藏除一个以外的所有混音器？

# apache-flex - google maps flex API：处理双击和单击？

> ID：423065
> 
> 赞同：0
> 
> 时间：2009-01-08T02:38:13.490
> 
> 标签：apache-flex, google-maps, gis

您如何区分单击鼠标单击和双击？我的单击侦听器似乎也捕获了所有双击：

[tz定位器](http://www.sustainablegis.com/projects/tz/tzMap/)

这是 flash/flex API 的一个已知问题，但 js 解决方法似乎也不能同时处理这两个问题：[code.google.com](http://code.google.com/p/gmaps-api-issues/issues/detail?id=394)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T04:42:18.893

可能需要澄清一下，但请确保您使用的是 Google Map 的 MapMouseEvent，而不是 Flash API 的点击事件（请假设此代码在`Map`子类中）：

```
public class GoogleMap extends Map 
{
    import com.google.maps.LatLng;
    import com.google.maps.Map;
    import com.google.maps.MapEvent;
    import com.google.maps.MapMouseEvent;

    public function GoogleMap():void
    {
        super();
        this.key = "YOUR_API_KEY";

        addEventListener(MapEvent.MAP_READY, _onMapReady);
        addEventListener(MapMouseEvent.CLICK, _onMapClick);
        addEventListener(MapMouseEvent.DOUBLE_CLICK, _onMapDoubleClick);
    }

    protected function _onMapClick(event:MapMouseEvent):void 
    {  
        trace("single!");
        var mousePoint:Point = new Point(mouseX, mouseY);
        var mousePointLocal:Point = globalToLocal(mousePoint);
        var mouseLatLng:LatLng = this.fromViewportToLatLng(mousePointLocal); 
    }

    protected function _onMapDoubleClick(event:MapMouseEvent):void 
    {
        trace("double!");
    }

    protected function _onMapReady(event:MapEvent):void 
    {
        trace("ready!")
    }
} 
```

# apache-flex - Flex 3 - 在使用 AS3 时，我必须在设置其属性之前添加组件吗？

> ID：423070
> 
> 赞同：3
> 
> 时间：2009-01-08T02:42:06.243
> 
> 标签：apache-flex, flex3, mxml, components

假设我有一个 Flex 3 mxml 组件，称之为 A。A 有一个名为“b”的 get/set 属性。在 AI 中还有另一个内部组件 C，它是使用 mxml 指定的。在 mxml 中“实例化”组件 A 时，我可以在声明时指定 b 的值，一切正常。但是，当我使用 Actionscript 初始化组件时，我必须先将组件添加到呈现的容器中，然后才能设置所述组件的属性（在本例中为“b”）。当属性“b”的设置器以某种方式访问​​ A 中的 C 时，就会发生这种情况。

所以，这在运行时失败（它说 C 是空的）......

```
var a:A = new A();
a.b = "woopy"; //Sets the Label (declared in mxml) withn A to "woopy"
this.addChild(a); 
```

另一方面，以下任何一项都可以

```
<customNamespace:A b="woopy"/> 
```

或者

```
var a:A = new A();
this.addChild(a);
a.b = "woopy"; //Sets the Label (declared in mxml) withn A to "woopy" 
```

如图所示，在将组件添加到容器后设置属性时，不会引发运行时错误消息。好的，这是有道理的，我想在组件被添加到容器之前，组件的内部结构并没有真正创建。不过，这有点烦人。有什么方法可以保证组件内部完全呈现而不将其添加到容器中？我不喜欢使用 actionscript 与 mxml 时的不同感觉。我想要一个解决方案，以便基本上在没有属性“参数”的 mxml 中声明 A 等同于在 AS 中使用 new 运算符声明 A。至少，就 A 的内部状态而言。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T11:46:45.160

要强制控件创建其子控件，您必须调用初始化方法。

即这应该工作：

```
var a:A = new A();
a.initialize();
a.b = "woopy";
this.addChild(a); 
```

但是，到目前为止，我在声明 mxml 控件时所做的是将内部控件绑定到脚本块中声明的公共变量。例如

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:Script>
        <![CDATA[
            [Bindable]
            public var labelText:String = "[Default]";
        ]]>
    </mx:Script>
    <mx:Label text="{labelText}"/>
</mx:Canvas> 
```

这样您就可以设置参数，而不必担心控件是否已创建。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T13:10:03.013

没错——如果 B 的 setter 作用于 C，你就会遇到问题，因为当 A 被构造时，C 肯定还不存在，即使你已经在 A 的 MXML 中声明了 C。

关于是否有任何方法可以保证组件及其子组件在不将其添加到容器的情况下完全呈现和可用，答案是否定的——框架不会在组件上执行其创建和呈现魔法，直到它以某种方式添加到通过 MXML 或 addChild() 显示列表。

当然，您可以使用 visible 或 includeInLayout 属性（例如，在您的 A 组件上将两者都设置为 false）来绕过实际显示组件，或者如果您必须在脚本中进行实例化，您可以监听 A 的初始化或 creationComplete 事件（这两个事件都表明 A 的孩子已创建并准备好执行操作），然后等待设置 B 直到您收到该通知。不过，作为一般规则，我不建议直接调用 initialize() 方法。它是一个框架方法，无论如何都会在 addChild() 之后自动调用，通常最好让框架做它的事情，而不是绕过它。

```
var a:A = new A();
a.addEventListener(FlexEvent.INITIALIZE, a_initialize);
addChild(a);

private function a_initialize(event:FlexEvent):void
{
    a.b = "woopy";
    // ... and so on
} 
```

如果你想确定的话，就这样吧。

Flex 团队的工程师 Deepa Subramaniam 最近在她的网站上发布[了一段精彩的视频](http://tv.adobe.com/#vi+f15384v1002)，详细介绍了 Flex 组件模型的详细步骤；我参加了她录制的 MAX 演讲，这很容易成为会议中最好的之一。值得一看（再看一遍，然后再看一遍），因为它的细节和全面性。她实际上在谈话中多次回答你的问题。这是很棒的东西。

祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-09T00:16:21.433

要回答您的主要问题，不，如果您想设置其属性，则不必将 AS3 实例化组件添加到显示列表中。在 MXML 中创建它与在 AS3 中创建它之间没有区别......当然，除非该组件没有正确构建。

Adobe（前身为 Macromedia）的 Flex 团队花了多年时间对 Flex 组件架构进行优化。该设计的两个重要部分与您的问题相关：

1.  他们设计了失效和验证系统，以便您可以一次设置许多属性，但是在您完成所有更改之前，更改的效果不会发生。

2.  首次实例化组件时，不会立即创建它的子组件。有一个最佳时间来做这件事，那就是在组件被添加到显示列表之后。

基本上，当 MXML 实例化组件和 AS3 实例化组件之间的行为存在差异时，这是因为构建组件时没有考虑这两个特性。

行为不正常的组件可能会执行以下操作：

```
private var label:Label;

public function get b():String
{
    return this.label.text;
}

public function set b(value:String):void
{
    this.label.text = value;
} 
```

问题是组件开发者没有考虑到Label子组件可能还没有创建！最佳实践是将值保存在一个变量中，并在稍后将其传递给子组件无效（验证周期直到组件初始化并创建子组件后才会发生）。

```
private var label:Label;

private var _b:String;

public function get b():String
{
    return this._b;
}

public function set b(value:String):void
{
    this._b = value;
    this.invalidateProperties();
}

override protected function commitProperties():void
{
    super.commitProperties();
    this.label.text = this._b;
} 
```

或者，如果您构建一个 MXML 组件，您可以执行类似的操作，但使用绑定而不是验证系统通常更容易：

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:Label text="{this.b}"/>
    <mx:Script><![CDATA[

    private var _b:String;

    [Bindable]
    public function get b():String
    {
        return this._b;
    }

    public function set b(value:String):void
    {
        this._b = value;
    }

    ]]></mx:Script>
</mx:Application> 
```

# asp.net-ajax - 奇怪的 ASP.NET AJAX 错误 / 32 位到 64 位

> ID：423071
> 
> 赞同：5
> 
> 时间：2009-01-08T02:42:19.690
> 
> 标签：asp.net-ajax, 64-bit

自从升级到 Windows 2008 64 位后，我的网站收到了一个奇怪的错误。我的大部分应用程序池都在 64 位模式下运行（除了一个，都用于旧版 ASP.NET 1.1 应用程序）。在运行 64 位的网站上，我收到了来自 ASP.NET AJAX 的错误。

```
Exception information:
   Exception type: System.NotSupportedException
   Exception message: Assembly "AjaxControlToolkit, Version=3.0.20820.16598, Culture=neutral, PublicKeyToken=28f01b0e84b6d53e" does not contain a script with hash code "e2e86ef9".

Request information:
   Request URL: http://site.com/page.aspx?_TSM_HiddenField_=ctl00_ctl00_elScripto_HiddenField&_TSM_CombinedScripts_=%3B%3BAjaxControlToolkit%2C+Version%3D3.0.20820.16598%2C+Culture%3Dneutral%2C+PublicKeyToken%3D28f01b0e84b6d53e%3Afr-FR%3A707835dd-fa4b-41d1-89e7-6df5d518ffb5%3Ae2e86ef9%3A9ea3f0e2%3A9e8e87e9%3A1df13a87%3Ad7738de7

Thread information:
   Thread ID: 21
   Thread account name: NT AUTHORITY\NETWORK SERVICE
   Is impersonating: False
   Stack trace:    at AjaxControlToolkit.ToolkitScriptManager.DeserializeScriptEntries(String serializedScriptEntries, Boolean loaded) in c:\AjaxControlToolkit_Admin\Release\AjaxControlToolkit\ToolkitScriptManager\ToolkitScriptManager.cs:line 534
  at AjaxControlToolkit.ToolkitScriptManager.OutputCombinedScriptFile(HttpContext context) in c:\AjaxControlToolkit_Admin\Release\AjaxControlToolkit\ToolkitScriptManager\ToolkitScriptManager.cs:line 264
  at AjaxControlToolkit.ToolkitScriptManager.OnInit(EventArgs e) in c:\AjaxControlToolkit_Admin\Release\AjaxControlToolkit\ToolkitScriptManager\ToolkitScriptManager.cs:line 198
  at System.Web.UI.Control.InitRecursive(Control namingContainer)
  at System.Web.UI.Control.InitRecursive(Control namingContainer)
  at System.Web.UI.Control.InitRecursive(Control namingContainer)
  at System.Web.UI.Control.InitRecursive(Control namingContainer)
  at System.Web.UI.Control.InitRecursive(Control namingContainer)
  at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) 
```

该错误似乎是 CodePlex 中的一个已知问题，但这对我没有多大帮助。这是一个解释问题的链接： [http ://dotnetdebug.ne​​t/2008/05/25/ajaxcontroltoolkit-toolkitscriptmanager-stringgethashcode-and-mixing-32bit-and-64bit-machinesprocesses/](http://dotnetdebug.net/2008/05/25/ajaxcontroltoolkit-toolkitscriptmanager-stringgethashcode-and-mixing-32bit-and-64bit-machinesprocesses/)

我没有使用负载平衡，我想知道为什么我的应用程序会在 32 位和 64 位模式之间切换。

是否必须为 64 位架构或类似的东西编译 DLL？是否有任何我应该注意的奇怪问题可能会导致我遇到此问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T19:49:43.967

看起来 String.GetHashCode() 结果会根据 dll 编译的指令集而变化。我无法解释为什么当您的 .NET 2.0+ 应用程序池都是 64 位时会在框架内发生这种情况，但是如果您愿意从 codeplex 获取最新的源代码并在工具包脚本管理器。

我不知道为什么没有根据可用的评论提交官方修复 - 也许是因为所有解决方案都像我的一样丑陋？

我试图通过使用评论之一中描述的 SHA1 哈希例程来修复它——所以首先我在 ToolkitScriptManager 类中创建了 SHA1Managed 提供程序的静态实例，如下所示：

```
public class ToolkitScriptManager : ScriptManager
{
    private static System.Security.Cryptography.SHA1Managed s = new System.Security.Cryptography.SHA1Managed(); 
```

...

然后有两个地方使用了我注释掉和替换的字符串哈希码——一次是在 SerializeScriptEntries 函数中：

```
//serializedScriptEntries.Append(scriptEntry.Name.GetHashCode().ToString("x", CultureInfo.InvariantCulture));
serializedScriptEntries.Append(Convert.ToBase64String(s.ComputeHash(System.Text.Encoding.UTF8.GetBytes(scriptEntry.Name)))); 
```

然后在 DeserializeScriptEntries 函数中一次：

```
//string hashCode = resourceName.GetHashCode().ToString("x", CultureInfo.InvariantCulture);
string hashCode = Convert.ToBase64String(s.ComputeHash(System.Text.Encoding.UTF8.GetBytes(resourceName))); 
```

也许更简单的方法可以让我们只访问 64 位 GetHashCode 方法来序列化这个字符串，以便我们在 32 位和 64 位调用中获得相同的结果......

# wpf - WPF - 参考代码中的应用程序图标

> ID：423081
> 
> 赞同：1
> 
> 时间：2009-01-08T02:47:49.600
> 
> 标签：wpf

我在项目属性中向 WPF 应用程序添加了一个图标。

如何引用该图标，以便可以将其添加到为系统托盘创建的 NotifyIcon 中。

在代码中是？

```
 System.Windows.Forms.NotifyIcon ni = new System.Windows.Forms.NotifyIcon();
  ni.Icon = new System.Drawing.Icon("MyIcon.ico"); 
```

不工作。马尔科姆

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-10T12:32:00.570

```
System.Windows.Forms.NotifyIcon ni = new System.Windows.Forms.NotifyIcon();
ni.Icon = System.Drawing.Icon.ExtractAssociatedIcon(
             System.Reflection.Assembly.GetEntryAssembly().ManifestModule.Name);
ni.Visible = true; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T05:57:58.627

I think this may be what you are looking for:

[How do I use an icon that is a resource in WPF?](https://stackoverflow.com/questions/74466/how-do-i-use-an-icon-that-is-a-resource-in-wpf)

You need to embed the icon as a resource and then you can access it from code.

# linux - Linux 上的程序化 iPod 备份

> ID：423085
> 
> 赞同：0
> 
> 时间：2009-01-08T02:51:32.590
> 
> 标签：linux, backup, ipod

Ubuntu 上是否有任何公开可用的库或 API 允许我以编程方式存档 iPod 的内容？如果不存在库或 API，我有哪些替代选项来保存 iPod 的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T02:54:49.167

看起来[gtkpod](http://www.gtkpod.org/about.html)可以做到。查看其[源代码](http://sourceforge.net/svn/?group_id=67873)可能会为您提供所需的内容。

# javascript - 使用 RegExp 匹配括号内的数字，然后将其递增

> ID：423107
> 
> 赞同：10
> 
> 时间：2009-01-08T03:04:20.677
> 
> 标签：javascript, regex, string

我一直在尝试找到一种方法来匹配 Javascript 字符串中的数字，该字符串在字符串末尾用括号括起来，然后将其递增。

假设我有一个字符串：

```
var name = "Item Name (4)"; 
```

我需要一个正则表达式来匹配 (4) 部分，然后我需要增加 4 然后将其放回字符串中。

这是我到目前为止的正则表达式：

```
\b([0-9]+)$\b 
```

此正则表达式不起作用。此外，我不知道如何提取检索到的整数并将其放回字符串中的相同位置。

谢谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-08T04:08:49.343

replace 方法可以将函数作为其第二个参数。它获取匹配项（包括子匹配项）并返回替换字符串。其他人已经提到括号需要转义。

```
"Item Name (4)".replace(/\((\d+)\)/, function(fullMatch, n) {
    return "(" + (Number(n) + 1) + ")";
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T03:27:41.347

我只能想出一种方法，分三步完成：提取、增量和替换。

```
// Tested on rhino
var name = "Item Name (4)";
var re = /\((\d+)\)/;

match = re.exec(name);
number = parseInt(match[1]) + 1;
name = name.replace(re, "(" + number + ")"); 
```

模式的重要部分：

1.  您需要转义括号以匹配文字括号
2.  您还需要使用括号来捕获数字，以便您可以从匹配中提取它。
3.  \d 匹配一个数字，比写出 [0-9] 更短更常见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T03:32:37.263

为了使这种模式起作用，您应该转义括号。此外，不需要 \b 和 $。因此

```
var s = "Item Name (4)"; 
var match = /\((\d+)\)/.exec( s ); 
var n = Number(match[1])+1; 
alert( s.replace( /\(\d+\)/, '('+n+')' ) ); 
```

david.clarke 的解决方案（已测试）

```
"Item Name (4)".replace(/\(([0-9]+)\)/, '('+(1+RegExp.$1) + ')'); 
```

但是我觉得太简洁了

**UPD**：原来 RegExp.$1 不能用作替换参数的一部分，因为它仅在 Opera 中有效

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-08T03:29:27.973

`'var name = "Item Name (4)"'.replace(/\(([\d]+)\)/, 1 + $1);`

（未经测试）

# c# - 忽略 C# 命令行程序中的 try 块

> ID：423110
> 
> 赞同：3
> 
> 时间：2009-01-08T03:05:47.617
> 
> 标签：c#, visual-studio-2008, command-line, console

我有一个 C# 命令行程序，我用 try-catch 块包装了它，以防止它崩溃控制台。但是，当我调试它时，如果在 DoStuff() 方法的某处抛出异常，Visual Studio 将在“catch”语句上中断。我希望 Visual Studio 中断发生异常的位置。最好的方法是什么？

注释掉试试？
Visual Sudio 中的设置？
#if DEBUG 语句？

```
static void Main(string[] args)
{
    try
    {
        DoStuff();
    }
    catch (Exception e)
    {  //right now I have a breakpoint here
        Console.WriteLine(e.Message);
    }
}

private void DoStuff()
{
    //I'd like VS to break here if an exception is thrown here.
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T03:19:38.600

您可以在 VS中打开[第一次机会异常。](http://blogs.msdn.com/davidklinems/archive/2005/07/18/440150.aspx)这将允许您在引发异常时立即收到通知。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T03:10:24.797

我认为将 VS 设置为[在未捕获的异常上中断](http://msdn.microsoft.com/en-us/library/d14azbfh.aspx)并将 try/catch 包装在 ifdefs 中是我将如何去做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T04:22:57.070

有一个“打破所有例外”的选项。我不确定您使用的是哪个版本的 VS，但在 VS 2008 中，您可以按 Ctrl + D、E。然后您可以单击复选框“抛出”复选框，了解您想要中断的异常类型

我相信在以前版本的 VS 中有一个 Debug 菜单项，其效果是“中断所有异常”。不幸的是，我手头没有以前的版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T05:27:22.820

以下是我为在持续集成服务器上运行的控制台工具执行此操作的方法：

```
private static void Main(string[] args)
{
  var parameters = CommandLineUtil.ParseCommandString(args);

#if DEBUG
  RunInDebugMode(parameters);
#else
  RunInReleaseMode(parameters);
#endif
}

static void RunInDebugMode(IDictionary<string,string> args)
{
  var counter = new ExceptionCounters();
  SetupDebugParameters(args);
  RunContainer(args, counter, ConsoleLog.Instance);
}

static void RunInReleaseMode(IDictionary<string,string> args)
{
  var counter = new ExceptionCounters();
  try
  {
    RunContainer(args, counter, NullLog.Instance);
  }
  catch (Exception ex)
  {
    var exception = new InvalidOperationException("Unhandled exception", ex);
    counter.Add(exception);
    Environment.ExitCode = 1;
  }
  finally
  {
    SaveExceptionLog(parameters, counter);
  }
} 
```

基本上，在发布模式下，我们捕获所有未处理的异常，将它们添加到全局异常计数器，保存到某个文件，然后以错误代码退出。

在调试中，更多异常直接出现在抛出点，此外，我们默认使用控制台记录器来查看发生了什么。

PS：ExceptionCounters、ConsoleLog 等来自[Lokad 共享库](http://rabdullin.com/shared-libraries/)

# mysql - 在 mysql 中实现消息队列表的最佳方法是什么

> ID：423111
> 
> 赞同：43
> 
> 时间：2009-01-08T03:06:09.550
> 
> 标签：mysql, job-queue

这可能是我第十次实施这样的事情，而且我从未对自己提出的解决方案感到 100% 满意。

使用 mysql 表而不是“适当的”消息传递系统的原因很有吸引力，主要是因为大多数应用程序已经使用一些关系数据库来处理其他东西（对于我一直在做的大部分事情，这往往是 mysql），而很少有应用程序使用消息系统。此外 - 关系数据库具有非常强的 ACID 属性，而消息传递系统通常没有。

第一个想法是使用：

```
创建表作业（
  id auto_increment 不是 null 主键，
  消息文本不为空，
  process_id varbinary(255) null 默认 null，
  关键jobs_key（process_id）
);

```

然后入队看起来像这样：

```
插入工作（消息）值（'blah blah'）；

```

出队看起来像这样：

```
开始;
select * from jobs where process_id is null order by id asc limit 1;
更新作业集 process_id = ? 其中 id = ?; ——无论我得到什么
犯罪;
-- 返回 (id, message) 到应用程序，完成后清理

```

表和入队看起来不错，但出队有点困扰我。回滚的可能性有多大？还是被封杀？我应该使用什么键使它成为 O(1)-ish？

还是有比我正在做的更好的解决方案？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2011-09-05T03:55:05.963

你的出队可能更简洁。您可以在没有显式事务的情况下在一个原子语句中完成，而不是依赖事务回滚：

```
UPDATE jobs SET process_id = ? WHERE process_id IS NULL ORDER BY ID ASC LIMIT 1; 
```

然后，您可以使用（括号 [] 表示可选，具体取决于您的具体情况）来拉取作业：

```
SELECT * FROM jobs WHERE process_id = ? [ORDER BY ID LIMIT 1]; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-08T05:26:23.870

我已经建立了一些消息队列系统，我不确定你指的是什么类型的消息，但在出队的情况下（这是一个词吗？）我做了你做过的同样的事情. 你的方法看起来简单、干净、可靠。并不是说我的工作是最好的，但事实证明它对于许多站点的大型监控非常有效。（错误记录、大量电子邮件营销活动、社交网络通知）

我的投票：不用担心！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-08T04:29:49.410

Brian Aker不久前谈到了[队列引擎。](http://krow.net/3132/Queue_Engine,_and_why_this_won%27_likely_happen....html)也有关于`SELECT table FROM DELETE`语法的讨论。

如果您不担心吞吐量，您可以随时使用[SELECT GET_LOCK()](http://dev.mysql.com/doc/refman/5.1/en/miscellaneous-functions.html#function_get-lock)作为互斥锁。例如：

```
SELECT GET_LOCK('READQUEUE');
SELECT * FROM jobs;
DELETE FROM JOBS WHERE ID = ?;
SELECT RELEASE_LOCK('READQUEUE'); 
```

如果你想真正花哨，把它包装在一个存储过程中。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-12-03T19:40:54.657

在 MySQL 8 中，您可以使用 new`NOWAIT`和`SKIP LOCKED`关键字来避免特殊锁​​定机制的复杂性：

```
START TRANSACTION;
SELECT id, message FROM jobs
 WHERE process_id IS NULL
 ORDER BY id ASC LIMIT 1
 FOR UPDATE SKIP LOCKED;
UPDATE jobs
 SET process_id = ?
 WHERE id = ?;
COMMIT; 
```

传统上，如果没有 hack 和不寻常的特殊表或列、不可靠的解决方案或失去并发性，这很难实现。

`SKIP LOCKED`可能会导致大量消费者出现性能问题。

然而，这仍然不能处理在事务回滚时自动标记作业完成。为此，您可能需要保存点。然而，这可能无法解决所有情况。您真的想设置一个操作以在事务失败时执行，但作为事务的一部分！

将来可能会有更多功能来帮助优化案例，例如也可以返回匹配行的更新。随时了解更改日志中的新特性和功能非常重要。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-04-15T17:57:06.003

这是我使用的一个解决方案，在没有当前线程的 process_id 的情况下工作，或者锁定表。

```
SELECT * from jobs ORDER BY ID ASC LIMIT 0,1; 
```

在 $row 数组中获取结果，然后执行：

```
DELETE from jobs WHERE ID=$row['ID']; 
```

然后获取受影响的行（mysql_affected_rows）。如果存在受影响的行，则处理 $row 数组中的作业。如果有 0 个受影响的行，则表示其他进程已经在处理选定的作业。重复上述步骤，直到没有行。

我已经使用具有 100k 行的“作业”表对此进行了测试，并产生了 20 个执行上述操作的并发进程。没有发生比赛条件。您可以修改上述查询以使用处理标志更新行，并在实际处理后删除该行：

```
while(time()-$startTime<$timeout)
{
SELECT * from jobs WHERE processing is NULL ORDER BY ID ASC LIMIT 0,1;
if (count($row)==0) break;
UPDATE jobs set processing=1 WHERE ID=$row['ID'];
if (mysql_affected_rows==0) continue;
//process your job here
DELETE from jobs WHERE ID=$row['ID'];
} 
```

不用说，您应该使用适当的消息队列（ActiveMQ、RabbitMQ 等）来完成此类工作。不过，我们不得不求助于这个解决方案，因为我们的主机在更新软件时经常会破坏东西，所以破坏的东西越少越好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T03:11:31.083

我建议使用[Quartz.NET](http://quartznet.sourceforge.net/)

它有 SQL Server、Oracle、MySql、SQLite 和 Firebird 的提供程序。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-08T05:16:42.843

[该线程](https://stackoverflow.com/questions/297280/best-way-to-use-a-db-table-as-a-message-job-queue)具有应可映射的设计信息。

去引用：

这是我过去成功使用的：

MsgQueue 表架构

MsgId 身份 -- NOT NULL
MsgTypeCode varchar(20) -- NOT NULL
SourceCode varchar(20) -- 插入消息的进程 -- NULLable
State char(1) -- 'N'new if queued, 'A'(ctive) if处理，'C'完成，默认'N' -- NOT NULL
CreateTime datetime -- 默认 GETDATE() -- NOT NULL
Msg varchar(255) -- NULLable

您的消息类型是您所期望的 - 消息符合插入过程和读取过程之间的约定，使用 XML 或您选择的其他表示形式进行结构化（在某些情况下 JSON 会很方便，例如实例）。

然后可以插入 0 到 n 进程，并且可以读取和处理消息的 0 到 n 进程，每个读取进程通常处理单个消息类型。一个进程类型的多个实例可以运行以实现负载平衡。

阅读器拉出一条消息并将状态更改为“A”ctive，同时它正在处理它。完成后，它将状态更改为“C”完成。它可以删除或不删除消息，具体取决于您是否要保留审计跟踪。State = 'N' 的消息按 MsgType/Timestamp 顺序拉取，因此在 MsgType + State + CreateTime 上有一个索引。

变化：
“E”错误的状态。
Reader 进程代码列。
状态转换的时间戳。

这为执行您所描述的许多事情提供了一个很好的、可扩展的、可见的、简单的机制。如果您对数据库有基本的了解，那么它非常简单且可扩展。由于原子状态转换事务，锁回滚等从来没有问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-28T12:26:35.320

您可以有一个中间表来维护队列的偏移量。

```
create table scan(
  scan_id int primary key,
  offset_id int
); 
```

您可能还会进行多次扫描，因此每次扫描有一个偏移量。在扫描开始时初始化 offset_id = 0。

```
begin;
select * from jobs where order by id where id > (select offset_id from scan where scan_id = 0)  asc limit 1;
update scan set offset_id = ? where scan_id = ?; -- whatever i just got
commit; 
```

您需要做的只是保持最后一个偏移量。这也将为您节省大量空间（每条记录的 process_id）。希望这听起来合乎逻辑。

# cocoa-touch - 如何在 iPhone 应用程序中存储程序变量以在程序退出后继续存在？

> ID：423114
> 
> 赞同：2
> 
> 时间：2009-01-08T03:07:23.307
> 
> 标签：cocoa-touch, persistence

退出应用程序时，我需要在 iPhone 应用程序中保留程序变量值。SDK 是否为程序员提供了非易失性内存以供使用？有多少可用？它会保持通电循环吗？通过睡眠模式？通过硬重置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T03:29:02.980

您想使用[NSUserDefaults](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)类来存储用户设置。这非常容易。它们将在设备重启、电源循环等过程中持续存在。

这是一个简短的[教程](http://icodeblog.com/2008/10/03/iphone-programming-tutorial-savingretrieving-data-using-nsuserdefaults/)，可帮助您入门。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T11:34:56.993

有许多选项可用于存储应用程序中的数据以供以后使用。正如所指出的，其中两个正在使用 NSUserDefaults 和 SQLite。另一种方法是在您的应用程序的“文档”文件夹中创建一个文件并将您的数据保存在这里。下次启动应用程序时读取文件的内容。这在[Apple 的文件和网络指南中进行了解释](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/FilesandNetworking/chapter_8_section_2.html)

即使使用数据库，请确保在应用程序沙箱的 Documents 文件夹中创建数据库的副本，以便即使在您发布应用程序更新时它仍然存在。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T03:11:10.193

您可以写入应用程序的本地存储区域或使用 sqlite 数据库。这两个选项都记录在这里，[http://developer.apple.com/iphone/library/codinghowtos/DataManagement/index.html#FILE_MANAGEMENT-WRITE_INFORMATION_LOCALLY](http://developer.apple.com/iphone/library/codinghowtos/DataManagement/index.html#FILE_MANAGEMENT-WRITE_INFORMATION_LOCALLY)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-31T20:13:11.557

```
-(void)saveToUserDefaults:(NSString*)myString
{
    NSUserDefaults *standardUserDefaults = [NSUserDefaults standardUserDefaults];

    if (standardUserDefaults) {
        [standardUserDefaults setObject:myString forKey:@"Prefs"];
        [standardUserDefaults synchronize];
    }
}

-(NSString*)retrieveFromUserDefaults
{
    NSUserDefaults *standardUserDefaults = [NSUserDefaults standardUserDefaults];
    NSString *val = nil;

    if (standardUserDefaults) 
        val = [standardUserDefaults objectForKey:@"Prefs"];

    return val;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T03:12:08.070

您最好的选择是将它们存储到您的应用程序 SQLite 数据库实例中。这与您将获得的非易失性存储器一样接近。

# .net - 初学者犀牛模拟问题

> ID：423127
> 
> 赞同：1
> 
> 时间：2009-01-08T03:12:58.537
> 
> 标签：.net, rhino-mocks

所以我是 rhino mocks 的新手，我正试图让它在我正在进行的 MVP 模式项目中运行。所以我有一个代表我的视图的接口和我的 Presenter 的一个类，如下所示：

```
public interface IView {
  string SomeData { get; set; }
}

public class Presenter {
  public IView View { get; set; }
  public void Init(IView view) {
    this.View = view;
  }

  public virtual string DoStuff(){
    return "Done stuff with " + this.View.SomeData;
  }
} 
```

我正在尝试设置一个测试来模拟该`DoStuff`方法，所以我有一个这样的基本夹具：

```
[TestMethod]
public void Test(){
  var mocks = new MockRepository();
  var view = mocks.Stub<IView>();
  var presenter = mocks.StrictMock<Presenter>();

  presenter.Init(view);

  using(mocks.Record()){
    presenter.Expect(p => p.DoStuff()).Return("Mocked result");
  }

  string result = string.Empty;
  using(mocks.Playback()){
    result = presenter.DoStuff();
  }

  Assert.AreEqual(result, "Mocked result");
} 
```

但是我不断从方法中得到一个**空引用异常**`DoStuff`（在期望设置期间），因为 View 对象为空。这就是我卡住的地方。我已经调用了`Init`分配`View`属性值的方法，并且我认为期望设置的重点是该方法本身从未被调用过？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T06:37:26.580

看起来您正在测试 Rhino Mocks。您正在嘲笑视图和演示者。我将假设模拟演示者是不可取的，你应该只模拟视图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T03:24:19.433

您还需要模拟 View 属性，而不是在模拟的演示者上调用 Init 方法。

```
presenter.Expect( p => p.View ).Return( view ); 
```

您可能还想看看 RhinoMocks 使用新的[AAA](http://ayende.com/Blog/archive/2008/05/16/Rhino-Mocks--Arrange-Act-Assert-Syntax.aspx) (Arrange-Act-Assert) 语法。

```
string expectedResult = "Done stuff with Mocked Result";

var view = MockRepository.GenerateMock<IView>();
view.Expect( v => v.SomeData ).Return( "Mocked Result" );

var presenter = new Presenter();
presenter.Init( view );

string actualResult = presenter.DoStuff();

Assert.AreEqual( expectedResult, actualResult );

view.VerifyAllExpectations(); 
```

**编辑** 再次查看此内容后，我同意@ayende 的观点，即您可能应该只模拟/存根视图而不是演示者。我将保留原始更正以使您的代码正常工作，但更新我的示例以反映后者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T06:23:03.597

从我对您的源代码和测试的了解来看，很难看出您实际尝试测试的是什么。风景？主持人？

由于您有视图的接口和演示者的类实现，我认为您想模拟视图并测试演示者。

这是小组网站（我为您发布了指向此问题的链接）：

[http://groups.google.com/group/RhinoMocks](http://groups.google.com/group/RhinoMocks)

请参阅此代码。它是从 2007 年开始的，但它可以让您了解嘲笑的要点。

[http://tech.groups.yahoo.com/group/AgileEmbedded/files/HomeGuard/](http://tech.groups.yahoo.com/group/AgileEmbedded/files/HomeGuard/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T06:59:59.467

正如其他人所写的那样，您需要决定您要测试的代码，并且只模拟其他的东西。如果您正在尝试测试演示者，那么您只想在仍然使用真实演示者的同时模拟/存根视图。像这样的东西：

```
[TestMethod]
public void Test(){
  var view = MockRepository.GenerateStub<IView>();
  var presenter = new Presenter();
  presenter.Init(view);
  view.SomeData = "Test";
  Assert.AreEqual(presenter.DoStuff(), "Done stuff with Test");
} 
```

然后，您正在测试 Presenter.DoStuff() 方法是否正确使用了视图。

希望这可以帮助。

# c++ - 这是动态内存分配吗？

> ID：423128
> 
> 赞同：1
> 
> 时间：2009-01-08T03:14:07.723
> 
> 标签：c++, c, memory, memory-management, new-operator

简单的问题：我必须`delete`还是`delete []` `c`？语言重要吗？

```
char c[] = "hello" 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-08T03:15:00.123

在 c++ 中，这不是动态内存分配。不需要`delete[]`。

你的例子基本上是一个捷径：

```
char c[6]={'h','e','l','l','o','\0'}; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-08T03:24:19.310

C++ 中的规则是，`delete[]`无论何时使用`new[]`，`delete`都使用`new`. 如果您不使用`new`，如您的示例中所示，则不需要`delete`任何东西。

在您的示例中，如果在函数中声明，则数组的六个字节`c`分配在堆栈上，而不是堆上。由于这些字节在堆栈上，因此一旦声明它们的函数返回，它们就会消失。

如果该声明在任何函数之外，那么这六个字节将分配在全局数据区域中，并在程序的整个生命周期中一直存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T04:21:38.477

当您将某些东西放在堆上时，您会动态分配内存。在这里，您在堆栈上分配变量。如果您使用的是 new 运算符或 malloc 调用，您会将变量放在堆上。

您需要使用 delete (w/new) 或 free (w/malloc) 来释放堆上的内存。当函数/方法返回时，堆栈将被自动释放。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T03:18:23.160

不，数组是在编译时调整大小的。

# design-patterns - 您如何在领域驱动设计中使用具有工厂模式的接口？

> ID：423132
> 
> 赞同：3
> 
> 时间：2009-01-08T03:16:45.517
> 
> 标签：design-patterns, oop, domain-driven-design, factory, domain-object

默认情况下为您的域对象工厂使用接口是否有意义，或者是否应该只在需要时为工厂类保留接口？

```
public IUserFactory
{
    User CreateNewUser();
}

public UserFactory : IUserFactory
{
    public User CreateNewUser()
    {
        return new User();
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-08T03:36:15.573

在你给出的例子中，我什至不明白你为什么需要去工厂。

> 工厂模式的本质是“定义一个用于创建对象的接口，但让子类决定实例化哪个类。工厂方法让一个类将实例化推迟到子类。” - 维基百科

您是否有不同类型的用户，或者用户本身就是某种类型的东西。可能是你没有把事情说清楚。我们通常在**抽象工厂方法模式中使用***接口*，我们需要处理多个相关对象族。

 **注意：不要忘记，模式可以帮助我们，这并不意味着我们必须使用它们，因为它们是可用的，无论我们是否需要它们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T03:21:26.990

并非所有东西都必须有接口；如果你有一个单一的实现，而没有理由有任何其他的，我看不出为什么要定义一个接口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T03:30:22.277

从接口创建工厂可以更轻松地使用模拟类对其进行测试，并使使用 IoC 应用程序变得更简单，因此虽然我可能不一定需要它们来实现应用程序功能，但我通常通过接口构建和调用大多数类.

如果您不考虑单元测试或 IoC 模式（除了宗教观点），我可能不会打扰。

我发现使用它们的最大痛苦，至少在 Visual Studio 中，是属性或函数上的“转到定义”跳转到接口定义，而不是类定义。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T03:31:07.160

两件事：（1）我会等到我需要（或看到迫在眉睫的需要）一个替代实现，然后再创建接口；（2）接口几乎总是使单元测试更容易，尤其是在模拟时，所以我经常来立即满足对接口的需求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-08T04:01:23.353

这是将相同问题翻译成 Java 的版本。

原始示例

```
public interface UserFactoryIF
{
   User createNewUser();
} 
```

然后执行Factory

```
public class UserFactory implements UserFactoryIF
{
     public User createNewUser()
     {
         // whatever special logic it takes to make a User
         // below is simplification
         return new User();
     }
} 
```

我认为为工厂定义接口没有任何特殊好处，因为您正在为集中式生产者定义单个接口。通常我发现我需要为同一种产品生产许多不同的实现，而我的工厂需要消耗许多不同类型的参数。也就是说，我们可能有：

```
public interface User
{
    public String getName();
    public long getId();
    public long getUUID();
    // more biz methods on the User
} 
```

工厂看起来像这样：

```
public class UserFactory {

    public static User createUserFrom(Person person) {
        // ...
        return new UserImpl( ... );
    }

    public static user createUserFrom(AmazonUser amazonUser) {
         // ... special logic for AmazonWS user
        return new UserImpl( ... );          
    }

    private static class UserImpl implements User {
       // encapsulated impl with validation semantics to
       // insure no one else in the production code can impl
       // this naively with side effects
    }
} 
```

希望这能说明问题。

# c# - 将 20 个棋子放在棋盘上随机位置的最佳方法是什么？

> ID：423135
> 
> 赞同：0
> 
> 时间：2009-01-08T03:19:01.940
> 
> 标签：c#, arrays, algorithm, random

我必须解决这个问题的一个想法是组成一个大小为 8x8 的缓冲区，用指向我的检查器的指针（全部 20 个）填充它，其余的保留 0（空），然后在缓冲区上运行洗牌算法，仅此而已（只需将其读取为 8x8 数组）

1.  我想知道是否有更好的方法来做到这一点。
2.  我需要用 C# 编写它，而我的建议不会按照我描述的方式工作

任何人 ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-08T04:57:32.193

为了搭载 Borzio 的想法，当您接近第 20 块时，有三分之一的机会您将不得不重新生成随机数并重试。有 20 件，你可能仍然安全，但如果你有 40 件，那将比 1 比 2 的机会要好，你可能会被困等待一段时间。

1.  构造板数组，全部为空。
2.  将对每个棋盘格的引用复制到列表 ( `emptySquareList`)。
3.  为您要添加的每个部分循环：
    1.  生成 和 之间的随机`0`数`emptySquareList.Length-1`。
    2.  把棋子放在那个正方形里
    3.  从 中删除正方形`emptySquareList`。

这样，您始终维护一个*空*方格列表，并从中进行选择。请注意，板数组中的索引数组也可以正常工作，并且可能更快（`Enumerable.Range(0,64)`）。

我鼓励您尝试随机检查算法以及这个算法；看看哪个更有效率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T03:27:56.930

一个 8x8 矩阵包含指向片段对象的指针 (c++) 或引用 (c#/java) 似乎是一个非常合理的设计。

您可以使用 64 个元素大的 1D 数组（您可以轻松地将 2D 索引映射到 1D 数组）并使用如下内容：

```
using System;
using System.Linq;

Piece[] board = whatever();

// New random number generator.
Random random = new Random();

// LINQ query orders each element by the next random number.
Piece[] randomBoard = (from piece in board
    orderby random.Next()
    select piece).ToArray(); 
```

注意：我不是 ac# 程序员，但这似乎是合理的。

要将 x,y 对转换为数组索引，请使用以下算法：

```
int index = (y * 8) + x; 
```

NOTE2：我不知道你是否必须遵循跳棋的放置规则，如果你这样做，你需要做一些更聪明的事情。您可能有一个 32 个元素大的数组（代表所有黑色方块）。在其中随机播放，然后将 32 个大数组中的每个元素分配给真正的 64 个元素数组的每个“黑色”方块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T03:47:34.240

如果您必须遵循放置规则，给定您的 8x8 矩阵示例，我也会将其视为 Evan 指出的一维数组——（参见他的确定 x 和 y 的数学）——

黑色和白色方块是奇数和偶数索引值；但是，嘿，你从来没有说过你需要放置规则——我还认为你不是在寻找 c# 代码，而是更多“逻辑”级别的想法......

如果您正在尝试 Linq-Challenged 解决方案，请考虑以下事项；

1.  构造“board”数组，全部为空；（64 个元素）
2.  构建由你的棋子组成的“游戏棋子”数组
3.  创建一个从 1 到 # 件的循环
4.  生成介于 1 和 # 的棋盘空间 (64) 之间的随机数
5.  如果 #4 指向的棋盘空间是 !0，重做第 4 步（或者你可以“while” !0）
6.  将块（步骤 3 中的# from loop）放入步骤 4 中的正方形 X

只有一个想法肯定会有很多——

希望能帮助到你 ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T10:55:44.173

要回答提出的问题：

1.  将第一个棋子放在尚未被占用的随机位置
2.  重复其他 19 件

说真的，您根本没有给我们足够的信息来继续回答这个问题。这里有一些问题：

*   哪些棋子？
*   哪种颜色（每种有 16 种），颜色重要吗？白人是否必须避免被黑人俘虏，反之亦然？

假设没有要遵循的规则，除了您需要将所有 20 个都放在板上，即。没有碰撞，这将做你想要的：

```
Piece[] pieces = ... your 20 pieces here
Piece[] board = new Piece[8 * 8];
Random r = new Random();
foreach (Piece piece in pieces)
{
    while (true)
    {
        Int32 location = r.Next(board.Length);
        if (board[location] == null)
        {
            board[location] = piece;
            break;
        }
    }
} 
```

一个更简单的解决方案，如果你已经在某个地方有辅助例程，就是将它们放在 64 元素数组的开头，然后打乱整个数组。这会将这 20 个棋子和 44 个空方格打乱，并将它们有效地放置在随机位置。

# sql - 报告加载项

> ID：423136
> 
> 赞同：0
> 
> 时间：2009-01-08T03:19:20.223
> 
> 标签：sql, sql-server

有人可以提供 Visual Studio 2008（不是 Visual Web Developer！）的 SQL Server Reports 加载项的下载链接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T06:06:29.433

您可以通过运行 SQL Server 安装来获得 Reporting Services 开发工具。您可以在此处下载 180 天试用版：http: [//www.microsoft.com/sqlserver/2008/en/us/trial-software.aspx](http://www.microsoft.com/sqlserver/2008/en/us/trial-software.aspx)

# c# - 如何使用 GetType GetValue 区分两个对象的属性值？

> ID：423157
> 
> 赞同：2
> 
> 时间：2009-01-08T03:30:54.460
> 
> 标签：c#, .net, reflection, object, properties

我有以下课程：

```
public class Person
{
    public String FirstName { set; get; }
    public String LastName { set; get; }
    public Role Role { set; get; }
}

public class Role
{
    public String Description { set; get; }
    public Double Salary { set; get; }
    public Boolean HasBonus { set; get; }
} 
```

我希望能够自动提取 Person1 和 Person2 之间的属性值差异，示例如下：

```
public static List<String> DiffObjectsProperties(T a, T b)
{
    List<String> differences = new List<String>();
    foreach (var p in a.GetType().GetProperties())
    {
        var v1 = p.GetValue(a, null);
        var v2 = b.GetType().GetProperty(p.Name).GetValue(b, null);

        /* What happens if property type is a class e.g. Role???
         * How do we extract property values of Role?
         * Need to come up a better way than using .Namespace != "System"
         */
        if (!v1.GetType()
            .Namespace
            .Equals("System", StringComparison.OrdinalIgnoreCase))
            continue;

        //add values to differences List
    }

    return differences;
} 
```

如何提取 Role in Person 的属性值？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T03:55:22.023

```
public static List<String> DiffObjectsProperties(object a, object b)
{
    Type type = a.GetType();
    List<String> differences = new List<String>();
    foreach (PropertyInfo p in type.GetProperties())
    {
        object aValue = p.GetValue(a, null);
        object bValue = p.GetValue(b, null);

        if (p.PropertyType.IsPrimitive || p.PropertyType == typeof(string))
        {
            if (!aValue.Equals(bValue))
                differences.Add(
                    String.Format("{0}:{1}!={2}",p.Name, aValue, bValue)
                );
        }
        else
            differences.AddRange(DiffObjectsProperties(aValue, bValue));
    }

    return differences;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T03:40:20.040

如果属性不是值类型，为什么不递归地调用 DiffObjectProperties 并将结果附加到当前列表？据推测，您需要遍历它们并以点符号表示属性的名称，以便您可以看到有什么不同 - 或者知道如果列表非空当前属性不同就足够了.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T03:45:09.970

因为我不知道如何判断：

```
var v1 = p.GetValue(a, null); 
```

是字符串名字或角色角色。我一直在尝试找出如何判断 v1 是字符串，例如 FirstName 还是类角色。因此，我不知道何时将对象属性 (Role) 递归传递回 DiffObjectsProperties 以迭代其属性值。

# ruby-on-rails - Rails 表单验证条件绕过

> ID：423160
> 
> 赞同：16
> 
> 时间：2009-01-08T03:31:34.863
> 
> 标签：ruby-on-rails, ruby, validation, model

我有一个 Rails 模型可以验证 2 个表单值的唯一性。如果这 2 个值不是唯一的，则会显示验证错误，并且“提交”按钮更改为“重新提交”。我想允许用户单击“重新提交”按钮并绕过模型验证。我想从 Rails 验证文档中做这样的事情：

> `validates_uniqueness_of :value, :unless => Proc.new { |user| user.signup_step <= 2 }`

但是我的模型中没有可以检查的值……只有具有“重新提交”值的参数。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-08T07:54:49.047

在我看来，这是最好的方法：

```
class FooBar < ActiveRecord::Base
  validates_uniqueness_of :foo, :bar, :unless => :force_submit
  attr_accessor :force_submit
end 
```

然后在您看来，请确保您将提交标签命名为

```
<%= submit_tag 'Resubmit', :name => 'foo_bar[force_submit]' %> 
```

这样，所有逻辑都在模型中，控制器代码将保持不变。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-08T03:37:18.067

试试这个：

导轨 2：`Model.save(false)`
导轨 3：`Model.save(:validate => false)`

它绕过了验证（尽管所有这些）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T03:52:52.730

对此并不积极，但您可以尝试在模型中添加一个 attr_accessor 以保存该表单之前是否已提交过一次。

只需添加

`attr_accessor :submitted`

到您的模型并在您的验证中检查它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T07:31:56.033

您只需查看提交按钮即可确定是否要执行验证。

```
def form_method
  case params[:submit]
    when "Submit" 
      'Do your validation here'
    when "Resubmit" 
      'Do not call validation routine'
  end
end 
```

# clickonce - 使用 ClickOnce 从依赖程序集中部署内容文件

> ID：423162
> 
> 赞同：7
> 
> 时间：2009-01-08T03:32:35.940
> 
> 标签：clickonce

我有一个简单的 WinForms 应用程序，我正在使用 ClickOnce 在内部进行部署。主应用程序有一个依赖程序集，该程序集在构建属性中有一些标记为“内容”和“始终复制”的 xml 模板文件，但是如果我进入项目属性，它们不会显示在应用程序文件列表中 - >发布->应用程序文件对话框。

任何人都知道如何部署这些属于依赖程序集的 Xml 文件。

@codeConcussion- 谢谢，效果很好。最后，我使用添加现有文件添加了 xml 文件并选择了“添加为链接”，这完成了同样的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T15:36:07.227

我正在使用 VS 2008 SP1，所以我不确定这对于以前的 VS 版本是否会完全一样。

您可以通过简单地将构建后事件添加到您的主项目来解决您的问题。在一个 VB.Net 项目中，即**My Project > Compile Tab > Build Events... > Edit Post Build...**。在 C# 中，**项目属性 > 构建事件 > 编辑构建后**...。一个简单的**xcopy [源文件] [目标文件夹]**命令将 xml 模板文件从依赖程序集的 bin 文件夹复制到主项目的 bin 文件夹应该可以工作。

从那里，只需确保在“发布”选项卡的“应用程序文件”对话框中选中“显示所有文件”。

另一种方法是将您的两个项目更改为构建到同一个 bin 文件夹。这很好用，但我只会在依赖程序集特定于该应用程序并且不是多个应用程序使用的库程序集时才这样做。

# c++ - Flash ActiveX：如何从内存或资源或流中加载电影？

> ID：423166
> 
> 赞同：1
> 
> 时间：2009-01-08T03:33:46.077
> 
> 标签：c++, flash, activex, ocx, shockwave

我在我的 C++ 应用程序中嵌入了一个 Flash ActiveX 控件（Flash.ocx、Flash10a.ocx 等，具体取决于您的 Flash 版本）。

我可以通过调用 LoadMovie(0, filename) 来加载 SWF 文件，但该文件需要物理上驻留在磁盘中。如何从内存（或资源或流）加载 SWF？我确信一定有办法，因为像**f-in-box**的功能这样的商业解决方案[直接从内存中加载 Flash 电影](http://www.f-in-box.org/dll/#feature_load_movie)也使用 Flash ActiveX 控件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T16:26:00.753

显然，我需要提供“支持”投票的详细信息……好吧。

首次初始化时，内部闪存缓冲区指示是否加载了电影，或者缓冲区是否在缓冲区的前四个字节中保存了属性。

gUfU - 没有加载电影。要遵循的属性....

fUfU -- .. [4bytes] 大小为整数。

然后是未压缩的电影或 SWF。编写一个 IStream 类。填写以上。另存为 szFile

```
TFlashStream *fStream = new TFlashStream(szFile);
// QI Flash 播放器

```
IPersistStreamInit * psStreamInit = 0;
shock->QueryInterface(::IID_IPersistStreamInit,  
                     (LPVOID*)&psStreamInit);
if(psStreamInit)
{
    psStreamInit->InitNew();
    psStreamInit->Load(fStream);
    psStreamInit->Release();
}
delete fStream; 
```

注意事项：当 psStreamInit->Load(fStream); 将调用 IStream::Read 来查找标题“fUfU”。

如果返回正确 psStreamInit 则调用 IStream::Read 获取缓冲区大小。

如果到目前为止一切看起来都不错，psStreamInit 然后读取 1024 字节块，直到读取耗尽。然而。对于标题和文件大小。

```
标准方法（读取）（无效 *pv，ULONG cb，ULONG *pcbRead）

```

pcbRead 无效。你可能想使用类似 IsBadReadPtr

--

迈克尔

            回答 #2

赞同：1

时间：2010-04-25T15:58:21.407

为您节省一些打字时间。它以这种方式对我有用（只是没有经过广泛测试）：

```
void flash_load_memory(FlashWidget* w, void* data, ULONG size) {
        FlashMemoryStream fStream = FlashMemoryStream(data, size);
        IPersistStreamInit* psStreamInit = NULL;
        w->mFlashInterface->QueryInterface(IID_IPersistStreamInit,(LPVOID*) &psStreamInit);
        if(psStreamInit) {
            psStreamInit->InitNew();
            psStreamInit->Load((LPSTREAM)&fStream);
            psStreamInit->Release();
        }
    }

class FlashMemoryStream : IStream {
    public:
        FlashMemoryStream(void* data,ULONG size) {
            this->data = data;
            this->size = size;
            this->pos = 0;
        }

        HRESULT STDMETHODCALLTYPE QueryInterface(REFIID riid, LPVOID* ppv) {
            return E_NOTIMPL;
        }

        ULONG STDMETHODCALLTYPE AddRef() {  
            return E_NOTIMPL;
        }

        ULONG STDMETHODCALLTYPE Release() {  
            return E_NOTIMPL;
        }

        // IStream methods
        STDMETHOD(Read) (void *pv,ULONG cb,ULONG *pcbRead) {
            if(pos == 0 && cb == 4) {
                memcpy(pv,"fUfU",4);
                pos += 4;
                return S_OK;
            }
            else if(pos == 4 && cb == 4) {
                memcpy(pv,&size,4);
                size += 8;
                pos += 4;
                return S_OK;
            }
            else {
                if(pos + cb > size) cb = size - pos;
                if(cb == 0) return S_FALSE;
                memcpy(pv,(char*)data + pos - 8,cb);
                if(pcbRead) (*pcbRead) = cb;
                pos += cb;
                return S_OK;
            }
        }

        STDMETHOD(Write) (void const *pv,ULONG cb,ULONG *pcbWritten) { return E_NOTIMPL; }
        STDMETHOD(Seek) (LARGE_INTEGER dlibMove,DWORD dwOrigin,ULARGE_INTEGER *plibNewPosition) { return E_NOTIMPL; }
        STDMETHOD(SetSize) (ULARGE_INTEGER libNewSize) { return E_NOTIMPL; }
        STDMETHOD(CopyTo) (IStream *pstm,ULARGE_INTEGER cb,ULARGE_INTEGER *pcbRead,ULARGE_INTEGER *pcbWritten) { return E_NOTIMPL; }
        STDMETHOD(Commit) (DWORD grfCommitFlags) { return E_NOTIMPL; }
        STDMETHOD(Revert) (void) { return E_NOTIMPL; }
        STDMETHOD(LockRegion) (ULARGE_INTEGER libOffset,ULARGE_INTEGER cb,DWORD dwLockType) { return E_NOTIMPL; }
        STDMETHOD(UnlockRegion) (ULARGE_INTEGER libOffset,ULARGE_INTEGER cb,DWORD dwLockType) { return E_NOTIMPL; }
        STDMETHOD(Stat) (STATSTG *pstatstg,DWORD grfStatFlag) { return E_NOTIMPL; }
        STDMETHOD(Clone) (IStream **ppstm) { return E_NOTIMPL; }

        void* data;
        ULONG size;
        ULONG pos;
    }; 
```

            回答 #3

赞同：0

时间：2009-01-08T04:13:30.240

作为一个 Flash 人，我不知道 C++ 端的任何细节，但如果你在 Flash 端向虚假协议发出请求，在 C 端你能拦截该请求并用数据流回答它吗？我的意思是：

```
var mc:MovieClip = createEmptyMovieClip( "mc", 0 );
mc.loadMovie( "fakeprotocol://"+filename ) 
```

只要响应看起来（对 Flash 来说）像一个 HTTP 流，就应该可以工作。（如果“拦截请求并返回数据流”是您寻求帮助的部分，请提前道歉。）

            回答 #4

赞同：0

时间：2009-01-21T18:12:16.137

此外.... Flash 播放器推广 IPersistStorage。flash.QI IPersistStorage pStorage.load (mystorage_as_stream)

.. 理论上。

抱歉以上内容.. 我打算发布 Flash 播放器推广 IPersistStreamInit。flash.QI IPersistStreamInit pStream.load (my_stream)

迈克尔

            回答 #5

赞同：0

时间：2009-08-29T22:24:39.810

当您尝试通过 MovieclipLoader 或 LoadMovie 从另一部电影加载电影时，此方法不起作用！！！

结果是替换调用的 SWF 文件！！...因此此方法仅适用于加载基本文件。

有人知道与 MovieClipLoader 和 LoadMovie 一起使用的更好方法吗？谢谢。

            回答 #6

赞同：0

时间：2012-06-20T17:09:27.007

MS VC ATL 示例（使用 VS 2010 SP1 + Windows SDK 7.1 构建，并在带有 Flash64_11_3_300_257.ocx / Flash32_11_3_300_257.ocx 的 Windows 7 SP1 64 位和带有 Flash32_11_3_300_257.ocx 的 Windows XP SP3 32 位上进行了测试）：

```
#pragma pack(push, 1)

typedef struct _FLASH_STREAM_HEADER
{
    DWORD m_dwSignature;
    DWORD m_dwDataSize;
} FLASH_STREAM_HEADER, *PFLASH_STREAM_HEADER;

#pragma pack(pop)

static HRESULT LoadFlashMovieFromResource(ATL::CComPtr<IShockwaveFlash>& spShockwaveFlash,
    UINT nResourceID, LPCTSTR pszResourceType = RT_RCDATA)
{
    HMODULE hModule = ATL::_AtlBaseModule.GetModuleInstance();
    ATLASSUME(hModule != NULL);

    //HINSTANCE hResourceInstance = ATL::AtlFindResourceInstance(nResourceID, pszResourceType);
    //HRSRC hResource = ::FindResource(hResourceInstance, MAKEINTRESOURCE(nResourceID),
    //  pszResourceType);

    HRSRC hResource = ::FindResource(hModule, MAKEINTRESOURCE(nResourceID), pszResourceType);

    if (hResource == NULL)
        return HRESULT_FROM_WIN32(::GetLastError());

    DWORD dwResourceDataSize = ::SizeofResource(hModule, hResource);

    if (dwResourceDataSize == 0)
        return HRESULT_FROM_WIN32(::GetLastError());

    HGLOBAL hResourceLoaded = ::LoadResource(hModule, hResource);

    if (hResourceLoaded == NULL)
        return HRESULT_FROM_WIN32(::GetLastError());

    ATL::CComPtr<IStream> spStream;

    HRESULT hResult = ::CreateStreamOnHGlobal(NULL, TRUE, &spStream);

    if (FAILED(hResult))
        return hResult;

    FLASH_STREAM_HEADER fsh = {0x55665566, dwResourceDataSize};

    ULARGE_INTEGER uli = {sizeof (fsh) + dwResourceDataSize};

    hResult = spStream->SetSize(uli);

    if (FAILED(hResult))
        return hResult;

    hResult = spStream->Write(&fsh, sizeof (fsh), NULL);

    if (FAILED(hResult))
        return hResult;

    hResult = spStream->Write(reinterpret_cast<void*>(hResourceLoaded), dwResourceDataSize, NULL);

    if (FAILED(hResult))
        return hResult;

    uli.QuadPart = 0;

    hResult = spStream->Seek(*reinterpret_cast<PLARGE_INTEGER>(&uli), STREAM_SEEK_SET, NULL);

    if (FAILED(hResult))
        return hResult;

    ATL::CComPtr<IPersistStreamInit> spPersistStreamInit;

    hResult = spShockwaveFlash.QueryInterface(&spPersistStreamInit);

    if (SUCCEEDED(hResult))
        hResult = spPersistStreamInit->Load(spStream);

    return hResult;
} 
```

        css - 我可以使用 CSS 制作多个背景图片吗？

ID：423172

赞同：319

时间：2009-01-08T03:37:17.020

标签：css, background-image

是否可以有两个背景图像？例如，我想让一个图像在顶部重复（repeat-x），另一个在整个页面上重复（repeat），其中整个页面上的图像在顶部重复的图像后面。

我发现可以通过设置html和body的背景来实现两张背景图片想要的效果：

```
html {
    background: url(images/bg.png);
}

body {
    background: url(images/bgtop.png) repeat-x;
} 
```

这是“好”的 CSS 吗？有没有更好的方法？如果我想要三个或更多背景图像怎么办？

            回答 #1

赞同：379

时间：2009-01-08T03:45:22.590

CSS3 允许这种事情，它看起来像这样：

```
body {
    background-image: url(images/bgtop.png), url(images/bg.png);
    background-repeat: repeat-x, repeat;
} 
```

[所有主流浏览器的当前版本现在都支持它](http://caniuse.com/#search=multiple%20backgrounds)，但是如果您需要支持 IE8 或更低版本，那么您可以解决它的最佳方法是拥有额外的 div：

```
<body>
    <div id="bgTopDiv">
        content here
    </div>
</body> 
```

```
body{
    background-image: url(images/bg.png);
}
#bgTopDiv{
    background-image: url(images/bgTop.png);
    background-repeat: repeat-x;
} 
```

            回答 #2

赞同：36

时间：2011-03-11T02:48:28.237

我发现在一个 div 中使用两个不同背景图像的最简单方法是使用这行代码：

```
body {
    background:url(image1.png) repeat-x, url(image2.png) repeat;
} 
```

显然，这不仅仅适用于网站的主体，您可以将其用于您想要的任何 div。

希望有帮助！如果有人需要进一步的说明或帮助，我的博客上有一篇文章会更深入地讨论这个问题 - [http://blog.thelibzter.com/css-tricks-use-two-background-images-for-one-分区](http://blog.thelibzter.com/css-tricks-use-two-background-images-for-one-div)。

            回答 #3

赞同：27

时间：2013-07-23T08:27:10.990

用这个

```
body {
background: url(images/image-1.png), url(images/image-2.png),url(images/image-3.png);
background-repeat: no-repeat, repeat-x, repeat-y;
background-position:10px 20px , 20px 30px ,15px 25px;
} 
```

一种使用背景位置调整每个图像位置的简单方法：并使用背景重复设置重复属性：为每个图像单独设置

            回答 #4

赞同：13

时间：2010-10-30T23:00:16.103

当前版本的 FF 和 IE 以及其他一些浏览器在单个 CSS2 声明中支持多个背景图像。看这里[http://dense13.com/blog/2008/08/31/multiple-background-images-with-css2/](http://dense13.com/blog/2008/08/31/multiple-background-images-with-css2/)和这里[http://www.quirksmode.org/css/multiple_backgrounds.html](http://www.quirksmode.org/css/multiple_backgrounds.html)和这里[http:// /nicolasgallagher.com/multiple-backgrounds-and-borders-with-css2/](http://nicolasgallagher.com/multiple-backgrounds-and-borders-with-css2/)

对于 IE，您可能会考虑添加一个行为。看这里：[http ://css3pie.com/](http://css3pie.com/)

            回答 #5

赞同：4

时间：2009-01-08T03:51:09.753

是的，这是可能的，并且已由流行的可用性测试网站[Silverback](http://silverbackapp.com/)实施。如果您查看源代码，您可以看到背景是由多个图像组成的，它们相互叠加。

这是一篇演示如何在[维生素](http://www.thinkvitamin.com/features/design/how-to-recreate-silverbacks-parallax)上找到效果的文章。可以在[A List Apart](http://www.alistapart.com/articles/onionskin/)上找到用于包裹这些“洋葱皮”层的类似概念。

            回答 #6

赞同：4

时间：2011-02-02T07:28:46.227

如果您想要多个背景图像但不希望它们重叠，您可以使用这个 CSS：

```
body {
  font-size: 13px;
  font-family:Century Gothic, Helvetica, sans-serif;
  color: #333;
  text-align: center;
  margin:0px;
  padding: 25px;
}

#topshadow {
  height: 62px
  width:1030px;
  margin: -62px
  background-image: url(images/top-shadow.png);
}

#pageborders {
width:1030px;
min-height:100%;
margin:auto;        
    background:url(images/mid-shadow.png);
}

#bottomshadow {
    margin:0px;
height:66px;
width:1030px;
background:url(images/bottom-shadow.png);
}

#page {
  text-align: left;
  margin:62px, 0px, 20px;
  background-color: white;
  margin:auto;
  padding:0px;
  width:1000px;
} 
```

使用此 HTML 结构：

```
<body 

<?php body_class(); ?>>

  <div id="topshadow">
  </div>

  <div id="pageborders">

    <div id="page">
    </div>
  </div>
</body> 
```

            回答 #7

赞同：2

时间：2016-04-06T18:05:05.527

```
#example1 {
    background: url(http://www.w3schools.com/css/img_flwr.gif) left top no-repeat, url(http://www.w3schools.com/css/img_flwr.gif) right bottom no-repeat, url(http://www.w3schools.com/css/paper.gif) left top repeat;
    padding: 15px;
    background-size: 150px, 130px, auto;
background-position: 50px 30px, 430px 30px, 130px 130px;
}
```

```
<!DOCTYPE html>
<html>
<head>

</head>
<body>

<div id="example1">
<h1>Lorem Ipsum Dolor</h1>
<p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>
<p>Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat.</p>
</div>

</body>
</html>
```

我们可以使用 CSS3 轻松添加多个图像。我们可以在这里详细阅读[http://www.w3schools.com/css/css3_backgrounds.asp](http://www.w3schools.com/css/css3_backgrounds.asp)

            回答 #8

赞同：1

时间：2009-01-08T03:44:13.577

您可以为顶部设置一个 div，一个背景，另一个用于主页，并将它们之间的页面内容分开，或者将内容放在另一个 z 级别的浮动 div 中。您这样做的方式可能有效，但我怀疑它是否适用于您遇到的每个浏览器。

        c++ - 重写 OnNcPaint() 会影响窗口客户区的绘制吗？

ID：423181

赞同：3

时间：2009-01-08T03:41:25.577

标签：c++, windows, mfc, onncpaint

我想改变窗口标题栏的外观，所以我决定重写`OnNcPaint()`. `CMainFrame`但是当我这样做时，我发现了一个问题。如果有另一个窗口覆盖了我的窗口，我快速拖动窗口，我的窗口客户区的内容就消失了，只有当我停止拖动时才出现。

我的覆盖`OnNcPaint()`如下：

```
void CMainFrame::OnNcPaint()
{
    CDC* pWinDC = GetWindowDC();
    //do some drawing
    ReleaseDC(pWinDC);
} 
```

我的方法有问题吗？谢谢！

            回答 #1

赞同：5

时间：2009-01-08T03:44:47.210

除非您使用设置为排除客户区域的剪切区域，否则您*可以*从`OnNcPaint()`. 所以...如果您的绘图逻辑无法修改以以其他方式排除客户端，请先设置适当的剪辑区域：

```
CRect rect;
GetWindowRect(&rect);
ScreenToClient(&rect);
CRect rectClient;
GetClientRect(&rectClient);
rectClient.OffsetRect(-rect.left, -rect.top);
rect.OffsetRect(-rect.left, -rect.top);
pWinDC->ExcludeClipRect(&rectClient);
// ...
// draw stuff here
// ...
pWinDC->SelectClipRgn(NULL); 
```

        vb.net - 如何从 OracleParameter 对象中获取值

ID：423182

赞同：2

时间：2009-01-08T03:41:39.850

标签：vb.net, oracle, odp.net

如下所示，我想从 OracleParameter 对象中获取值。它的数据类型是日期时间。

```
...

Dim cmd As New OracleCommand("stored_proc_name", cnObject)
cmd.Parameters.Add("tran_date_out", OracleDbType.Date, ParameterDirection.Output)

...

cmd.ExecuteNonQuery()

...

Dim tranDate As Date
tranDate = cmd.Parameters("tran_date_out").Value 
```

当我为 tranDate 变量赋值时，出现错误。但如果我编码如下，我只会得到日期。

```
tranDate = CDate(cmd.Parameters("tran_date_out").Value.ToString) 
```

那么如何获取 tranDate 变量的日期和时间值呢？

            回答 #1

赞同：5

时间：2009-01-08T03:58:22.393

在我的脑海中，OracleParameter.Value，当一个 out 参数时，被分配给一个奇怪的 Oracle 盒装类型。这似乎是一个完全糟糕的设计或 Oracle 的部分......但不是返回 String，而是你会得到 OracleString，等等。

每个 Oracle 类型都有一个具有系统类型的 .Value，但当然它们并不都实现了一个公共接口来公开它，所以我所做的基本上是编写一个方法来拆箱类型：

```
/// <summary>
/// The need for this method is highly annoying.
/// When Oracle sets its output parameters, the OracleParameter.Value property
/// is set to an internal Oracle type, not its equivelant System type.
/// For example, strings are returned as OracleString, DBNull is returned
/// as OracleNull, blobs are returned as OracleBinary, etc...
/// So these Oracle types need unboxed back to their normal system types.
/// </summary>
/// <param name="oracleType">Oracle type to unbox.</param>
/// <returns></returns>
internal static object UnBoxOracleType(object oracleType)
{
  if (oracleType == null)
    return null;

  Type T = oracleType.GetType();
  if (T == typeof(OracleString))
  {
    if (((OracleString)oracleType).IsNull)
      return null;
    return ((OracleString)oracleType).Value;
  }
  else if (T == typeof(OracleDecimal))
  {
    if (((OracleDecimal)oracleType).IsNull)
      return null;
    return ((OracleDecimal)oracleType).Value;
  }
  else if (T == typeof(OracleBinary))
  {
    if (((OracleBinary)oracleType).IsNull)
      return null;
    return ((OracleBinary)oracleType).Value;
  }
  else if (T == typeof(OracleBlob))
  {
    if (((OracleBlob)oracleType).IsNull)
      return null;
    return ((OracleBlob)oracleType).Value;
  }
  else if (T == typeof(OracleDate))
  {
    if (((OracleDate)oracleType).IsNull)
      return null;
    return ((OracleDate)oracleType).Value;
  }
  else if (T == typeof(OracleTimeStamp))
  {
    if (((OracleTimeStamp)oracleType).IsNull)
      return null;
    return ((OracleTimeStamp)oracleType).Value;
  }
  else // not sure how to handle these.
    return oracleType;
} 
```

这可能不是最干净的解决方案，但是……它又快又脏，而且对我有用。

只需将 OracleParameter.Value 传递给此方法。

实际上，在回答之前，我可能只阅读了您的问题的 1/2。我认为 Oracle 的 Date 类型只包含日期而不是时间。

oracle 类型 Timestamp 有日期和时间。

希望有帮助！:)

            回答 #2

赞同：1

时间：2015-12-08T16:02:50.640

我没有进行大量测试，但这里是使用反射的 CodingWithSpike 答案的不那么冗长的版本......

```
public static object UnBoxOracleType(object oracleType) {
    if(oracleType==null) {
        return null;
    }

    if((bool)oracleType.GetType().GetProperty("IsNull").GetValue(oracleType)) {
        return null;
    }
    return oracleType.GetType().GetProperty("Value").GetValue(oracleType);
} 
```

您再次将 OracleParameter.Value 传递给此方法。

或者对于更类型安全的版本，您可以这样做：

```
public static object GetValue(OracleParameter param) {
    if(param == null || param.Value==null) {
        return null;
    }

    var oracleType=param.Value;

    if((bool)oracleType.GetType().GetProperty("IsNull").GetValue(oracleType)) {
        return null;
    }
    return oracleType.GetType().GetProperty("Value").GetValue(oracleType);
} 
```

在这种情况下，您将传入 oracle 参数本身以获取值。如果您愿意，这也可以作为扩展方法实现......

        c++ - 由于我无法返回局部变量，从 C 或 C++ 函数返回字符串的最佳方法是什么？

ID：423186

赞同：18

时间：2009-01-08T03:44:27.490

标签：c++, c, memory

[作为这个问题](https://stackoverflow.com/questions/423128/is-this-dynamic-memory-allocation)的后续行动：

从我所见，这应该可以按预期工作：

```
void greet(){
  char c[] = "Hello";
  greetWith(c);
  return;
} 
```

但这会导致未定义的行为：

```
char *greet(){ 
  char c[] = "Hello";
  return c;
} 
```

如果我是对的，修复第二个问候功能的最佳方法是什么？在嵌入式环境中？在台式机上？

            回答 #1

赞同：33

时间：2009-01-08T03:52:43.947

你是绝对正确的。第二个示例中的 c 数组正在堆栈上分配，因此内存将立即被重用。特别是，如果您有类似的代码

```
 printf("%s\n",greet()); 
```

你会得到奇怪的结果，因为对 printf 的调用会重用你数组的一些空间。
解决方案是将内存分配到其他地方。例如：

```
char c[] = "Hello";

char * greet() {
    return c;
} 
```

会工作。另一种选择是在范围内静态分配它：

```
char * greet() {
    static char c[] = "Hello";
    return c;
} 
```

因为静态内存是在数据空间中与堆栈分开分配的。
您的第三个选择是通过 malloc 在堆上分配它：

```
char * greet() {
   char * c = (char *) malloc(strlen("Hello")+1);  /* +1 for the null */
   strcpy(c, "Hello");
   return c;
} 
```

但是现在您必须确保以某种方式释放内存，否则您会发生内存泄漏。
更新
其中一件看起来比我想象的更令人困惑的事情是“内存泄漏”到底是什么。泄漏是指您动态分配内存，但丢失了地址，因此无法释放。这些示例都不一定存在泄漏，但只有第三个示例甚至可能存在泄漏，因为它是唯一动态分配内存的示例。因此，假设第三个实现，您可以编写以下代码：

```
{
    /* stuff happens */
    printf("%s\n", greet());
} 
```

这有泄漏；返回指向 malloc 内存的指针，`printf`使用它，然后丢失；你不能再释放它了。另一方面，

```
{
    char * cp ;
    /* stuff happens */
    cp = greet();
    printf("%s\n", cp);
    free(cp);
} 
```

*不会*泄漏，因为指针保存在自动变量中`cp`足够长的时间来调用`free()`它。现在，即使 cp 在执行结束后立即消失，他结束大括号，因为 free 已被调用，内存被回收并且没有泄漏。

            回答 #2

赞同：12

时间：2009-01-08T03:49:44.890

如果您使用的是 C++，那么您可能需要考虑使用`std::string`从第二个函数返回字符串：

```
std::string greet() {
    char c[] = "Hello";
    return std::string(c); // note the use of the constructor call is redundant here
} 
```

或者，在单线程环境中，您可以执行以下操作：

```
char *greet() {
    static char c[] = "Hello";
    return c;
} 
```

这里`static`在全局内存区域分配空间，永远不会消失。不过，这种`static`方法充满危险。

            回答 #3

赞同：9

时间：2009-01-08T03:51:24.543

取决于嵌入式环境是否有堆，如果有，你应该 malloc 如下：

```
char* greet()
{
  char* ret = malloc(6 * sizeof(char)); // technically " * sizeof(char)" isn't needed since it is 1 by definition
  strcpy(ret,"hello");
  return ret;
} 
```

请注意，您应该稍后调用 free() 进行清理。如果您无权访问动态分配，则需要将其设置为全局变量或堆栈上的变量，但要在调用堆栈的上方。

            回答 #4

赞同：7

时间：2009-01-08T05:52:57.963

如果您需要在 C++ 中执行此操作，`std::string`那么按照 Greg Hewgill 的建议使用绝对是最简单和可维护的策略。

如果您使用的是 C，您可能会考虑返回一个指向已动态分配的空间的指针，`malloc()`如 Jesse Pepper 所建议的那样；但另一种可以避免动态分配的方法是`greet()`获取一个`char *`参数并将其输出写入那里：

```
void greet(char *buf, int size) {
    char c[] = "Hello";

    if (strlen(c) + 1 > size) {
        printf("Buffer size too small!");
        exit(1);
    }

    strcpy(buf, c);
} 
```

该`size`参数是为了安全起见，以帮助防止缓冲区溢出。如果您确切知道字符串将有多长，则没有必要。

            回答 #5

赞同：5

时间：2009-01-08T06:38:04.300

You can use either of these:

```
char const* getIt() {
    return "hello";
}

char * getIt() {
    static char thing[] = "hello";
    return thing;
}

char * getIt() {
    char str[] = "hello";
    char * thing = new char[sizeof str];
    std::strcpy(thing, str);
    return thing;
}

shared_array<char> getIt() {
    char str[] = "hello";
    shared_array<char> thing(new char[sizeof str]);
    std::strcpy(thing.get(), str);
    return thing;
} 
```

The first requires you to not write to the returned string, but also is the simplest you can get. The last uses shared_array which automatically can clean up memory if the reference to the memory is lost (the last shared_array to it goes out of scope). The last and second last must be used if you require a new string everytime you call the function.

            回答 #6

赞同：4

时间：2009-01-08T06:10:47.977

Returning malloc'd memory from a function as suggested by several of the other responses is just asking for a memory leak.  The caller would have to know you malloc'd it and then call free.  If they happened to call delete on it, the results are undefined (although probably okay).

It would be better to force the caller to provide the memory for you and then copy your string into it.  This way the caller is on notice that he/she needs to clean up.

            回答 #7

赞同：1

时间：2009-01-08T07:53:03.027

从我读过的内容来看，最安全的选择是让调用者负责分配内存来保存字符串。您还必须检查缓冲区是否足够大以容纳您的字符串：

```
char *greet(char *buf, int size) {
     char *str = "Hello!"
     if (strlen(str) + 1 > size) { // Remember the terminal null!
          return NULL;
     } 
     strcpy(buf, str);
     return buf;
}

void do_greet() {
    char buf[SIZE];
    if (greet(buf, SIZE) == NULL) {
        printf("Stupid C");
     } 
     else {} // Greeted!
} 
```

一个简单的任务需要做大量的工作......但是你有 C :-) 哎呀！猜猜我被random_hacker打败了......

            回答 #8

赞同：0

时间：2009-01-08T03:48:57.230

在堆中分配字符数组？

是否可以使用`malloc`取决于“嵌入式环境”的含义。

        django - Django 表单 - 就地编辑来自反向外键连接的数据

ID：423208

赞同：10

时间：2009-01-08T03:54:09.717

标签：django, forms, foreign-keys, reverse

我有一个人表和电话表。Phone 表在 Person 表中有一个外键，它是一个自增 ID。每个人可以有任意数量的电话号码。有没有办法让我创建一个 Django 表单来输入电话号码，同时创建一个新的 Person 条目并将它们与现有的 Person 条目一起编辑？

            回答 #1

赞同：15

时间：2009-01-08T04:11:26.500

是的，Django 的 inlineformset_factory 正是您所需要的。

文档：[模型表单集](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#id1)和[内联表单集](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#inline-formsets)

[这个片段](http://www.djangosnippets.org/snippets/1246/)应该可以帮助你作为一个例子。

        sql - 在 MySQL 或 Rails 中获取特定日期范围内每天 AVG 的最佳方法

ID：423212

赞同：5

时间：2009-01-08T03:55:53.880

标签：sql, mysql, ruby-on-rails, ruby, static-analysis

我正在尝试在 Rails 中制作图表，例如给定日期范围内每天的平均销售额

假设我有一个 products_sold 模型，它有一个“sales_price”浮动属性。但是如果某一天没有销售（例如模型/数据库中没有销售），我想简单地返回 0。

MySQL/Rails 中完成这项工作的最佳方法是什么？我知道我可以做这样的事情：

（*这个 SQL 查询可能是完全错误的方式来获得我想要的东西*）

```
SELECT avg(sales_price) AS avg, DATE_FORMAT(created_at, '%m-%d-%Y') AS date
    FROM products_sold WHERE merchant_id = 1 GROUP BY date; 
```

并得到这样的结果：

```
| 平均 | 日期 |
  23 01-03-2009
  50 01-05-2009
  34 01-07-2009
  ……

```

我想得到的是：

```
| 平均 | 日期 |
  23 01-03-2009
   0 01-04-2009
  50 01-05-2009
   0 01-06-2009
  34 01-07-2009
   0 01-08-2009
  ……

```

我可以使用 SQL 执行此操作，还是必须对结果进行后处理以查找日期范围中的哪些日期不在 SQL 结果集中？也许我需要一些子选择或 IF 语句？

感谢大家的帮助。

            回答 #1

赞同：7

时间：2009-01-08T10:16:30.100

有没有理由（除了已经提到的日期）为什么不使用 ActiveRecord 中的内置组功能功能？您似乎担心“后处理”，我认为这并不是真正值得担心的事情。

您在 Rails 中，因此您可能应该首先寻找 Rails 解决方案[1]。我的第一个想法是做类似的事情

```
Product.average(:sales_price, :group => "DATE(created_at)", :conditions => ["merchant_id=?", 1]) 
```

ActiveRecord 几乎变成了您描述的 SQL。假设在 Merchant 和 Product 之间声明了`has_many`关联，那么您可能会更好地使用它，例如：

```
ave_prices = Merchant.find(1).products.average(:sales_price, :group => "DATE(created_at)") 
```

*（我希望您将模型描述为“products_sold”是某种转录错误，顺便说一句 - 如果不是，您的类命名有点离题！）*

毕竟，您回到了起点，但您以更传统的 Rails 方式到达那里（而且 Rails 真的很重视约定！）。现在我们需要填补空白。

我假设您知道您的日期范围，假设它被定义为从`from_date`to的所有日期`to_date`。

```
date_aves = (from_date..to_date).map{|dt| [dt, 0]} 
```

这会将完整的日期列表构建为一个数组。我们不需要得到平均值的日期：

```
ave_price_dates = ave_prices.collect{|ave_price| ave_price[0]} # build an array of dates
date_aves.delete_if { |dt| ave_price.dates.index(dt[0]) } # remove zero entries for dates retrieved from DB
date_aves.concat(ave_prices)     # add the query results
date_aves.sort_by{|ave| ave[0] } # sort by date 
```

对我来说，那部分看起来有点杂乱：我认为它可以更简洁更干净。我会研究构建一个 Hash 或 Struct 而不是留在数组中。

[1] 我并不是说不要使用 SQL - ActiveRecord 无法生成最有效的查询并且您依赖`find_by_sql`. 没关系，它应该是这样的，但我认为你应该尝试仅作为最后的手段使用它。

            回答 #2

赞同：2

时间：2009-01-08T06:18:42.000

对于任何此类查询，您将需要找到一种机制来为要报告的每个日期生成一个包含一行的表。然后，您将对该表与您正在分析的数据表进行外部连接。您可能还必须使用 NVL 或 COALESCE 将空值转换为零。

困难的部分是如何生成（临时）表，其中包含您需要分析的范围的日期列表。那是特定于 DBMS 的。

不过，您将日期/时间值映射到单个日期的想法是正确的。如果您想分析每周销售额，您需要使用类似的技巧 - 将所有日期映射到 ISO 8601 日期格式，例如第 1 周的 2009-W01 。

此外，您最好将 DATE 格式映射到 2009-01-08 表示法，因为这样您就可以使用纯字符排序按日期顺序进行排序。

            回答 #3

赞同：2

时间：2009-07-18T21:47:45.623

干一点：

```
ave_prices = Merchant.find(1).products.average(:sales_price, :group => "DATE(created_at)")
date_aves = (from_date..to_date).map{|dt| [dt, ave_prices[dt.strftime "%Y-%m-%d"] || 0]} 
```

            回答 #4

赞同：0

时间：2009-01-08T06:18:13.937

MySQL 有设置返回函数吗？即在查询的每一行上返回不同值的函数？作为 PostgreSQL 的示例，您可以执行以下操作：

```
select 'foo', generate_series(3, 5); 
```

这将产生一个由 2 列和 3 行组成的结果集，其中左列每行包含“foo”，右列包含 3、4 和 5。

所以，假设你在 MySQL 中有一个等价的`generate_series()`和子查询：你需要的是`LEFT OUTER JOIN`从这个函数到你已经拥有的查询。这将确保您看到每个日期都出现在输出中：

```
SELECT
    avg(sales_price) as avg,
    DATE_FORMAT(the_date, '%m-%d-%Y') as date
FROM (select cast('2008-JAN-01' as date) + generate_series(0, 364) as the_date) date_range
LEFT OUTER JOIN products_sold on (the_date = created_at)
WHERE merchant_id = 1
GROUP BY date; 
```

您可能需要稍微调整一下才能获得适合 MySQL 的语法。

        graphical-logo - 您如何为一家软件公司起个好听的名字？

ID：423215

赞同：35

时间：2009-01-08T03:57:23.207

标签：graphical-logo

我正在开一家网页设计商店，并希望也能涉足定制软件开发。

所以我现在遇到的问题是想出公司的名字。

我想要一些很酷很时髦的东西，但我不知道去哪里寻找想法。

有人建议我以一种水果（好吧，“Apple”已经被拿走:)）或著名的船等命名，但不知何故，这些名字似乎不太合适。

所以对于那些创办企业的人，我想问一下你是怎么想出名字的，是否有人对此有任何建议？

            回答 #1

赞同：79

时间：2009-01-08T14:41:29.880

反答案：

选择“iAmurioBugFoneStickr ² Solutions”之类的东西（²应该发音为“squared”）

1.  在某事之前添加一个小写的“e”或“i”总是有帮助的，作为互联网技术的指示
2.  拥有一个无意义的拉丁词根衍生短语（例如 Verizon、Altria、Experian、Lucent）听起来清晰而有智慧
3.  始终尝试使用 CamelCase 或印刷困难的东西。它让人停下来并注意到它，就像有人注意到他们的鞋子发出吱吱声一样。
4.  将单词组合在一起是处理合并的好方法。（如 GlaxoSmithKline 以前称为 Glaxo Wellcome 和 SmithKline Beecham，或 PricewaterhouseCoopers fka Price-Waterhouse and Coopers & Lybrand）
5.  创造性的拼写错误为您提供商标保护加分。（Flickr、Cingular、NetFlix、Paychex）
6.  您总是可以通过在末尾添加一个不明确的限定名词来增加严肃的语气，例如“Group”或“International”或“Network”。
7.  什么鬼，把一堆俚语粘在一起！（自鸣得意）

            回答 #2

赞同：15

时间：2009-01-08T04:03:04.380

使用随机名称生成器：http:   [//noemata.net/nbng/](http://noemata.net/nbng/)。

            回答 #3

赞同：11

时间：2009-01-08T04:05:04.063

我用今天最难的方法找到了我的投资组合和博客的名称，试图找到一个好的、可用的域名。

我的理由是，如果您正在寻找创建在线业务，那么您将希望您的名字作为域名。很难为您的企业想出一个好名字，但想出一个实际可用的名字就更难了。

列出涉及您的业务或您希望在业务名称中包含的对象的相关单词列表，然后尝试使用域名建议工具，如[NameTumbler](http://www.nametumbler.com/)、[MakeWords](http://www.makewords.com/)或您能找到的任何其他工具。

            回答 #4

赞同：10

时间：2009-01-08T04:00:31.280

我能给出的最好建议是确保它是谷歌独有的。如果您选择一个普通名词，您将永远不会成为您自己名字的早期热门。将两个常用名词串在一起，你就可以避免这种情况。似乎是一种流行的安排。

            回答 #5

赞同：9

时间：2009-01-08T04:10:44.397

我想要一些很酷很时髦的东西

“酷而时髦”作为一个名字怎么样？

你可以接电话，“嗨：这很酷，有什么可以帮忙的吗？”

            回答 #6

赞同：7

时间：2009-01-08T04:04:32.630

对于一家小公司来说，客户的满意度比您是否有一个好名字更能推动品牌认知度。你甚至可以没有名字，如果你的名声在你之前，人们就会知道你的公司是“乔纳森·康威的商店”，并对此感到高兴。如果你花时间思考名字而不是实际*生产*，即使你有一个像 37signals 或 Fog Creek 这样的好名字，人们也不会记住或关心。

            回答 #7

赞同：5

时间：2009-01-08T04:40:15.320

按重要性排序：

1）当你把它告诉别人时，他们应该能够拼写 - 这不应该像玩电话（你不希望他们去 dig.com 或 boynboyn.com 或 boxy.com ）

2）它应该表达一些关于你公司精神的东西，不需要太多解释

3）它不应该听起来通用（避免 gobusiness.com 或 mywebflights.com 或 bestcomputing.com ）

记下几句话来描述是什么想法启发了您制作了您制作的软件而不是其他类型的软件，或者您想要做事的方式与您的竞争对手的区别......然后将这些词插入维基百科、谷歌或在词库中查找它们。

            回答 #8

赞同：5

时间：2012-04-25T11:26:03.640

许多人花太多时间搜索真实、有意义的词，却发现 .com 域已经被占用。

选择一个非常短且无意义的 .com 名称，长度为 4-6 个字母。

你可能会发现它出奇的与众不同。

            回答 #9

赞同：4

时间：2009-01-08T05:47:31.080

无论您想出什么，请确保“.com”域可用。人们记住了这个名字，并假设为“.com”。

            回答 #10

赞同：2

时间：2009-01-08T04:01:52.713

你写什么样的软件？什么市场？你想填补什么利基？你将如何在竞争中脱颖而出？

这些是我想回答的问题......名字应该来自那里。

例如，地狱犬资本——又名希腊神话中的三头犬……而地狱犬以吞并其他公司而闻名……

            回答 #11

赞同：1

时间：2013-08-18T08:42:04.913

我去像[这里](http://www.brandroot.com/names/categories/software)这样的地方寻找软件名称。有很多类似这个的网站，但我发现这个有更好的名字。只需为将来寻找的任何人添加此内容即可。

            回答 #12

赞同：0

时间：2014-01-12T20:49:03.950

尝试访问具有品牌域（例如[BrandStarters）](http://brandstarters.com/product-category/software/)的市场，这样您就可以找到可用的名称，而不是仅仅为了找出名称被采用而头脑风暴。还有其他类似的网站拥有大量域名。

            回答 #13

赞同：0

时间：2009-01-08T04:05:39.680

我们使用了一个代表我们理念的名称：ThinkBottomUp

            回答 #14

赞同：0

时间：2009-01-08T04:11:20.337

我使用了一个允许您搜索可用域名的网站（不记得 URL）。我将最大长度设置为 6 个字符，最终找到了成为公司名称的 eneset.com。

            回答 #15

赞同：0

时间：2009-01-08T05:38:02.037

我同意你应该考虑谷歌的可搜索性以及“语音”之类的东西。您希望人们在听到名称后能够将浏览器指向您的站点。

获得名称的一种方法是将一群利益相关者或可能只是感兴趣的人聚集在一个有白板的房间里。现在进行头脑风暴。

        javascript - (function(){})(); 之间的区别 和函数（）{}（）；

ID：423228

赞同：38

时间：2009-01-08T04:03:32.820

标签：javascript, syntax

**可能重复：**

  [“(function ( ) { } ) ( )” 和 “(function ( ) { } ( ) )” 在 JavaScript 中的功能是否相同？](https://stackoverflow.com/questions/5938802/are-function-and-function-functionally-equal-i)  

这是我还没有完全弄清楚的事情，但我一直在使用 function(){}() 只是因为如果我添加括号，我的 VIM 语法高亮就会出错，尽管我已经看到 (function(){}) () 很多次，也许它是 IE 的东西？

**编辑：**

```
var singleton = function() {
    // code
}();

var singleton = (function() {
    // code
})(); 
```

            回答 #1

赞同：45

时间：2009-01-08T04:36:24.360

[Peter Michaux 在An Important Pair of Parens](http://peter.michaux.ca/articles/an-important-pair-of-parens)中讨论了差异。

基本上，括号是一种约定，表示紧随其后的是立即调用的函数表达式，而不是普通函数。特别是如果函数体很长，这会减少意外，

            回答 #2

赞同：9

时间：2009-01-08T04:21:41.020

额外的一组括号使您更清楚地知道您正在构造一个函数然后调用它。这是编码风格的事情，而不是功能性的事情。

            回答 #3

赞同：4

时间：2009-01-08T04:23:06.883

```
function(){}(); 
```

在大多数浏览器中不起作用。您应该在函数周围使用括号才能执行它

```
(function(){})(); 
```

然后浏览器会知道最后一个括号应该应用于所有表达式

```
function(){} 
```

**UPD**：如果你不使用括号，浏览器可能会误解你。如果您只是调用该函数并关闭结果

```
function() {
    alert(1);
}(); 
```

然后 ff 和 ie 会抛出错误

        c# - 这种设计是个好主意吗 - 接口和抽象类

ID：423247

赞同：3

时间：2009-01-08T04:10:00.963

标签：c#, generics, interface, abstract-class

我希望能够执行以下操作：

```
//non-generic
var MyTable = new Table();
string name = MyTable.Name;
IEnumerable<String> rows = MyTable.Rows;

//generic
var MyTableGeneric = new Table<MyType>();
string name = MyTableGeneric.Name;
IEnumerable<MyType> rows = MyTableGeneric .Rows; 
```

这样的事情会不会太多：

[http://img81.imageshack.us/img81/427/diagramcm3.jpg](http://img81.imageshack.us/img81/427/diagramcm3.jpg)

还是会更好：

[http://img301.imageshack.us/img301/4136/presentation1nh9.jpg](http://img301.imageshack.us/img301/4136/presentation1nh9.jpg)

抱歉，如果这很难理解我要理解的内容，基本上我有两个对象将共享 comman 属性，但行集合将是通用的。我想以最干净的方式做到这一点。

对不起，我用 powerpoint 制作的蹩脚图表 :)

            回答 #1

赞同：8

时间：2009-01-08T04:21:41.627

我会说第二种设计更好。更少的项目和更容易的继承路径。

第一个设计具有不必要的接口，除非您正在实现其他实现接口但不从基类继承的东西，否则您实际上并不需要这些接口。

            回答 #2

赞同：2

时间：2009-01-08T06:23:18.513

`Table`a和 a 有什么区别`Table<string>`？换句话说，你能不能只使用`Table<string>`你的非泛型形式？

如果您*确实*选择了第二种选择，我建议您重命名您的一个`Rows`属性 - 您可以通过隐藏等方式拥有两个不同类型的属性，但这不会令人愉快。

`Table`你的类型实际上会有多少行为？如果它真的只是一个容器，你可能不需要接口——但如果它背后有重要的逻辑，你可能想要一个接口，以便在测试使用它的类时模拟表。

            回答 #3

赞同：1

时间：2009-01-08T06:36:01.450

我会在行中使用泛型，而不涉及基类中的字符串，并且让非泛型继承 Table 类。考虑不使用抽象类。

```
Table<T> -> Table:Table<string> 
```

        c - strerror_r 应该允许多大的尺寸？

ID：423248

赞同：35

时间：2009-01-08T04:10:27.937

标签：c, linux, standards, posix, glibc

OpenGroup POSIX.1-2001 定义了[strerror_r](http://www.opengroup.org/onlinepubs/000095399/functions/strerror.html)，[Linux 标准基础核心规范 3.1](http://refspecs.freestandards.org/LSB_3.1.0/LSB-Core-generic/LSB-Core-generic/baselib-strerror-r.html)也是如此。但是我找不到对错误消息可以合理预期的最大大小的参考。我希望有一些定义可以放在我的代码中，但我找不到。

*代码必须是线程安全的。*这就是为什么使用 strerror_r 而不是 strerror 的原因。

有人知道我可以使用的符号吗？我应该创建自己的吗？

例子

```
int result = gethostname(p_buffy, size_buffy);
int errsv = errno;
if (result < 0)
{
    char buf[256];
    char const * str = strerror_r(errsv, buf, 256);
    syslog(LOG_ERR,
             "gethostname failed; errno=%d(%s), buf='%s'",
             errsv,
             str,
             p_buffy);
     return errsv;
} 
```

**从文件：**

开放组基本规范第 6 期：

**错误**

如果出现以下情况，strerror_r() 函数可能会失败：

*   **[ERANGE]**通过 strerrbuf 和 buflen 提供的存储空间不足，无法包含生成的消息字符串。

**从来源：**

glibc-2.7/glibc-2.7/string/strerror.c:41：

```
 char *
    strerror (errnum)
         int errnum;
    {
        ...
        buf = malloc (1024); 
```

            回答 #1

赞同：13

时间：2009-01-09T08:57:07.063

对于所有情况，具有足够大的静态限制可能就足够了。如果您确实需要获取整个错误消息，您可以使用[GNU 版本的 strerror_r](http://linux.die.net/man/3/strerror_r)，或者您可以使用标准版本并使用连续更大的缓冲区轮询它，直到您获得所需的内容。例如，您可以使用类似下面的代码。

```
#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

/* Call strerror_r and get the full error message. Allocate memory for the
 * entire string with malloc. Return string. Caller must free string.
 * If malloc fails, return NULL.
 */
char *all_strerror(int n)
{
    char *s;
    size_t size;

    size = 1024;
    s = malloc(size);
    if (s == NULL)
        return NULL;

    while (strerror_r(n, s, size) == -1 && errno == ERANGE) {
        size *= 2;
        s = realloc(s, size);
        if (s == NULL)
            return NULL;
    }

    return s;
}

int main(int argc, char **argv)
{
    for (int i = 1; i < argc; ++i) {
        int n = atoi(argv[i]);
        char *s = all_strerror(n);
        printf("[%d]: %s\n", n, s);
        free(s);
    }

    return 0;
} 
```

            回答 #2

赞同：10

时间：2009-01-08T04:46:25.510

我不会担心 - 256 的缓冲区大小已经绰绰有余，而 1024 则过大了。如果需要存储错误字符串，您可以使用`strerror()`而不是`strerror_r()`，然后可以选择使用结果。`strdup()`不过，这不是线程安全的。如果您确实需要使用`strerror_r()`而不是`strerror()`为了线程安全，只需使用 256 的大小即可。在`glibc-2.7`中，最长的错误消息字符串为 50 个字符（“无效或不完整的多字节或宽字符”）。我不希望将来的错误消息会更长（在最坏的情况下，会长几个字节）。

            回答 #3

赞同：5

时间：2016-07-20T13:13:30.187

这个程序（[在这里在线运行（作为 C++）](http://coliru.stacked-crooked.com/a/673ba48e81aa49b3)）：

```
#include <stdio.h>
#include <errno.h>
#include <string.h>

int main(){
        const int limit = 5;
        int unknowns = 0;
        int maxlen = 0;
        int i=0; char* s = strerror(i);
        while(1){
            if (maxlen<strlen(s)) maxlen = strlen(s);
            if (/*BEGINS WITH "Unknown "*/ 0==strncmp("Unknown ", s , sizeof("Unknown ")-1) )
                unknowns++;
            printf("%.3d\t%s\n", i, s);
            i++; s=strerror(i);
            if ( limit == unknowns ) break;
        }
        printf("Max: %d\n", maxlen);
        return 0;
} 
```

列出并打印系统上的所有错误并跟踪最大长度。从外观上看，长度不超过**49 个**字符（纯`strlen`'s 没有最后的`\0`），所以有一些余地，64-100 应该绰绰有余。

我很好奇是否不能简单地通过返回结构来避免整个缓冲区大小协商，以及是否存在不返回结构的根本原因。所以我进行了基准测试：

```
#define _POSIX_C_SOURCE 200112L //or else the GNU version of strerror_r gets used
#include <stdio.h>
#include <errno.h>
#include <stdlib.h>
#include <string.h>

typedef struct { char data[64]; } error_str_t;
error_str_t strerror_reent(int errn) __attribute__((const));
error_str_t strerror_reent(int errn){
    error_str_t ret;
    strerror_r(errn, ret.data, sizeof(ret));
    return ret;
}

int main(int argc, char** argv){
    int reps = atoi(argv[1]);
    char buf[64];
    volatile int errn = 1;
    for(int i=0; i<reps; i++){
#ifdef VAL
        error_str_t err = strerror_reent(errn);
#else
        strerror_r(errn, buf, 64);
#endif
    }
    return 0;
} 
```

并且两者在 -O2 时的性能差异很小：

```
gcc -O2 : The VAL version is slower by about 5%
g++ -O2 -x c++ : The VAL version is faster by about 1% than the standard version compiled as C++ and by about 4% faster than the standard version compiled as C (surprisingly, even the slower C++ version beats the faster C version by about 3%). 
```

无论如何，我认为`strerror`甚至允许线程不安全是非常奇怪的。那些返回的字符串应该是指向字符串文字的指针。（请赐教，但我想不出应该在运行时合成它们的情况）。并且字符串文字根据定义是只读的，并且对只读数据的访问始终是线程安全的。

        performance - 如何加快 Eclipse 项目的“刷新”

ID：423270

赞同：9

时间：2009-01-08T04:24:52.637

标签：performance, eclipse, subclipse

我有一个相当大的 PHP 代码库（10k 个文件），我在 Windows 机器上使用 Eclipse 3.4/PDT 2，而文件托管在 Debian 文件服务器上。我通过 Windows 上的映射驱动器连接。

尽管有 1gbit 以太网连接，但进行 Eclipse 项目刷新还是很慢。最多 5 分钟。发生这种情况时，我被阻止工作。

这通常不会是一个问题，因为理论上 Eclipse 不应该经常进行完全刷新。但是，我也使用 subclipse 插件，它每次完成切换/更新时都会触发完全刷新。

我的预感是，这个过程中最慢的部分是 eclipse 一个一个地检查 10k 个文件，以了解对 samba 的更改。

代码库中有大量文件我永远不需要从 Eclipse 访问，所以我根本不需要它来检查它们。但是我不知道如何阻止它这样做。我尝试将它们标记为“派生”。这可以防止它们被包含在构建过​​程等中。但它似乎根本没有加速刷新过程。Eclipse 似乎仍在检查其更改的状态。

我还从 PDT 的“构建路径”中删除了不需要的文件夹。这确实加快了“构建工作空间”的过程，但它并没有加速构建之前的实际刷新（这是最耗时的）。

            回答 #1

赞同：8

时间：2009-01-12T05:25:15.843

谢谢大家的建议。基本上，JW 走在了正确的轨道上。在当地工作。

为此，我发现了一个名为 FileSync 的插件：http:
 [//andrei.gmxhome.de/filesync/](http://andrei.gmxhome.de/filesync/)

这会自动将更改的文件复制到网络共享。效果非常好。我现在可以在几秒钟内从 Eclipse 中进行完整的更新/切换/刷新。

            回答 #2

赞同：3

时间：2009-01-08T04:29:08.600

您必须将文件存储在共享上吗？也许您可以设置某种自动镜像，这样您就可以在本地处理文件，它们会自动复制到共享中。我处于类似的情况，我不想放弃在我自己的机器上编辑文件的速度。

            回答 #3

赞同：1

时间：2009-01-08T05:56:01.670

鉴于它已被颠覆，为什么不在本地拥有文件，并在每次提交后使用 post commit hook 更新到开发服务器上的最新版本？（或者当你想更新开发时在提交日志中有一个特定的字符串（例如'##DEPLOY##'），并且只有在提交后挂钩看到这个字符串时才运行更新）。

除了刷新速度提升之外，这种技术的优点是您可以在 eclipse 中处理损坏的文件，并且开发服务器仍然可以（尽管使用的是旧版本的代码）。

缺点是您必须进行提交才能将保存的文件推送到开发服务器上。

            回答 #4

赞同：1

时间：2015-02-19T16:19:57.627

我通过在以下位置更改“文件传输缓冲区大小”解决了这个问题：

Window->Preferences->Remote Systems-Files 并将“File transfer buffer size”-s Download (KB) 和 Upload (KB) 值改为高值，我设置为 1000 kb，默认为 40 kb

            回答 #5

赞同：0

时间：2009-01-08T06:04:35.570

通过右键单击并选择“使脱机可用”在 Windows 中使用脱机文件夹功能。

它可以在文件共享协议中节省大量时间和往返延迟。

            回答 #6

赞同：0

时间：2009-01-08T06:35:12.763

将[svn externals](http://svnbook.red-bean.com/en/1.5/svn.advanced.externals.html)与非更改内容的修订标志一起使用*可能会*阻止 subclipse 在更新时刷新这些文件。再说一次，它可能不会。由于您必须对 subversion 存储库的结构进行一些更改才能使其正常工作，因此我建议您在实际操作之前进行一些简单的测试。

        asp.net - 将 JSON 数据解析为 .NET 对象的最佳方法

ID：423294

赞同：33

时间：2009-01-08T04:41:36.393

标签：asp.net, json

将 JSON 数据解析为 .NET 对象的最佳方法是什么？我正在尝试帮助我的一个编码朋友，他正在尝试使用 ASP.net 将 JSON 字符串中的一些数据转储到数据库中。是否有任何预构建的脚本可以实现这一点？

提前感谢任何帮助。

            回答 #1

赞同：22

时间：2009-01-08T04:44:37.027

.NET Framework 3.5 具有可以简化反序列化的[JavaScriptSerializer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)类。[您还可以使用JSON.NET](http://james.newtonking.com/pages/json-net.aspx)等第三方库。

            回答 #2

赞同：14

时间：2009-01-08T05:25:40.360

实际上，您应该真正查看[DataContractJsonSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer.aspx) ，因为 JavaScriptSerializer在 .NET 3.5 框架中被列为**过时。**

诚然，ScottGu 表示这可能是一个错误，将来可能会恢复。

            回答 #3

赞同：2

时间：2009-01-08T05:16:14.030

如果您使用的是 .NET 3.5，您可能不需要第三方库。可以使用 JavaScriptSerializer 类（只是重复前面提到的内容），但您也可以访问 DataContractJsonSerializer，它为 CLR 对象和 JSON 之间的映射提供了不同的模型。

            回答 #4

赞同：0

时间：2014-11-28T15:29:48.353

可以说最快的方法是使用[JSON#](http://insidethecpu.com/2014/10/22/ultrafast-json-parsing/)，它可以避免反射和相关的性能开销——这在 Web 应用程序中可能很重要。它还为您提供了对解析过程本身的更多控制。

        mysql - 你如何在mysql中结合内部和外部连接

ID：423295

赞同：4

时间：2009-01-08T04:42:01.570

标签：mysql, inner-join, outer-join

我可以在 sybase 中做到这一点，我可以在 oracle 中做到这一点，但我没有看到如何在 mysql 中做到这一点。

我有这个：（请克制自己不要重新格式化我的sql，上次有人这样做他们改变了它，所以它不一样，使问题变得毫无意义）

```
select table1.id
from
table1
  inner join
    table2 on (table1.id = table2.id and table2.data='cat'),
table1 t1
  left outer join
    table3 on (t1.id = table3.id and table3.data = 'dog') 
```

我得到了各种毫无意义的结果。

我想从 table1 中获取所有 id 的列表，其中 table2.data = cat，然后对 table3.data = dog 的表 3 的结果进行外部连接。

我注意到我不能在两个连接子句中为 table1 指定相同的表/别名，所以这让我相信 mysql 正在单独运行连接表达式并将结果组合在一起或类似的东西。

我还尝试摆脱 from 部分中的“内部连接”并将其放在 where 子句中，这也不起作用，尽管它没有以不同的方式工作（得到不同的错误结果）

这在 sybase 或 oracle 中非常容易。

我究竟做错了什么？

            回答 #1

赞同：14

时间：2009-01-08T04:46:29.737

```
select table1.id
from
table1
  inner join
    table2 on (table1.id = table2.id and table2.data='cat')
  left outer join
    table3 on (table1.id = table3.id and table3.data = 'dog') 
```

我认为您永远不想在 from 语句中使用逗号。我相信逗号相当于说交叉连接。虽然不确定，但我认为这个查询就是你要找的。

        c++ - C语言中CoGetClassObject()的使用——访问COM对象接口

ID：423298

赞同：2

时间：2009-01-08T04:44:15.013

标签：c++, c, windows, com

**使用纯**C/C++访问应用程序接口的说明，**不带**：

*   MFC
*   ATL
*   WTL

基本上，我想使用 COM 对象。

工作示例源代码或指南 -**使用**（功能）COM 对象，**而不是**创建 COM 服务器。

问候

            回答 #1

赞同：6

时间：2009-01-08T08:38:52.887

这是一个简单的 C++ 示例：

```
CoInitialize(NULL); // absolutely essential: initialize the COM subsystem
IMyInterface* pIFace;
// create the object and obtain a pointer to the sought interface
CoCreateInstance(CLSID_MyObject, NULL, CLSCTX_ALL, IID_IMyInterface, &pIFace);
pIFace->MethodIReallyNeed(); // use the object
pIFace->Release(); // free the object
CoUninitialize(); // cleanup COM after you're done using its services 
```

从这里复制：[COM基础知识](http://netez.com/2xExplorer/shellFAQ/bg_com.html)

            回答 #2

赞同：3

时间：2009-01-08T09:03:21.637

有一篇关于 CodeProject 的文章，[COM 简介 - 它是什么以及如何使用它](http://www.codeproject.com/KB/COM/comintro.aspx)，您可能会发现它很有用。它提供了一个很好的介绍和一个有效的例子。

            回答 #3

赞同：1

时间：2009-01-08T05:10:39.127

好吧，假设你有接口声明，你只需要调用 CoInitialize 来初始化 COM，然后调用 CoCreateInstance 来获取你的实例（并使用它），然后可选地调用 CoUnInitialize 来取消初始化 COM。

            回答 #4

赞同：0

时间：2009-01-08T11:43:20.143

避免使用 codeproject（新手），并查看有关 COM 的所有 MSDN 章节。

一切都在那里，有大量的 C 和 C++ 示例代码

            回答 #5

赞同：0

时间：2009-01-08T15:35:37.680

只需参考一本关于 COM 的好书（Don Box 或 Dale Rougerson）。这些是 COM World 的良好起点。

        networking - 以太网如何接收比特并形成数据链路层帧

ID：423310

赞同：1

时间：2009-01-08T04:56:20.013

标签：networking, ethernet, osi

我很想知道物理层的传入比特是如何正确地成帧并发送到数据链路层的。操作系统如何处理这个过程。

如果您详细解释或给我一些链接/pdf，将不胜感激。

我有兴趣深入了解第 1 层和第 2 层操作。

提前谢谢。

            回答 #1

赞同：2

时间：2009-01-08T17:47:40.923

今天的好处是，除了谷歌之外，你几乎不需要记住任何东西。
[http://en.wikipedia.org/wiki/Ethernet](http://en.wikipedia.org/wiki/Ethernet)

但是，问题不在于物理层，因为它实际上是电线和电线的接口；因此物理连接。他的问题涉及OSI 模型术语中的[数据链路层。](http://en.wikipedia.org/wiki/OSI_model)

由于以太网与 OSI 模型不匹配，并且 OSI 模型是战略模型而非战术模型，因此在以太网术语中，您对[802.3 MAC 帧](http://en.wikipedia.org/wiki/IEEE_802.3)感兴趣。但是由于以太网很旧，实际上有几种不同的[EtherTypes](http://www.networkdictionary.com/networking/EtherType.php)。

            回答 #2

赞同：2

时间：2009-01-08T05:00:30.847

物理层取决于您的硬件。您可能通过以太网连接，请参见[此处](http://en.wikipedia.org/wiki/Ethernet)。操作系统在这里并没有做很多事情，它主要取决于网卡和网卡制造商编写的设备驱动程序。

            回答 #3

赞同：-3

时间：2012-12-11T17:35:23.113

为了共享数据，需要一些协议作为人类。所以这里给出了 7 层。物理层直接与硬件连接（当脉冲以比特格式发送时）。它处理接口和传输介质的机械和电气规范。操作系统只有运行应用程序的权限，不能参与任何软件。如果您想要详细信息，那么最好阅读信号和系统。

        unix - 我可以将多个目录符号链接到一个目录中吗？

ID：423320

赞同：35

时间：2009-01-08T05:05:32.693

标签：unix, symlink

我有一种感觉，我已经知道这个问题的答案，但我想我会检查一下。

我有许多不同的文件夹：

```
images_a/
images_b/
images_c/ 
```

我可以创建某种符号链接，以便这个新目录包含所有这些目录的内容吗？那就是这个新的“ `images_all`”将包含所有文件`images_a`，`images_b`并且`images_c`？

            回答 #1

赞同：14

时间：2009-01-08T05:11:27.363

不可以。您必须以符号方式链接所有单个文件。

您*可以*做的是创建一个定期运行的作业，该作业基本上删除了 中的所有现有符号链接`images_all`，然后为其他三个目录中的所有文件重新创建链接，但这有点麻烦，如下所示：

```
rm -f images_all/*
for i in images_[abc]/* ; do; ln -s $i images_all/$(basename $i) ; done 
```

请注意，在此作业运行时，其他进程可能会认为文件已暂时消失。

您还需要注意两个或多个目录中存在单个文件名的情况。

一段时间后回到这个问题，我也想到你可以尽量减少文件不可用的时间。

如果您将它们链接到*不同*的目录，则执行相对较快`mv`的操作以最大限度地减少时间。就像是：

```
mkdir images_new
for i in images_[abc]/* ; do
    ln -s $i images_new/$(basename $i)
done

# These next two commands are the minimal-time switchover.
mv images_all images_old
mv images_new images_all

rm -rf images_old 
```

我尚未对此进行测试，因此任何实施它的人都必须确认其适用性或其他方式。

            回答 #2

赞同：9

时间：2009-01-08T05:19:50.823

您可以尝试联合文件系统，例如 unionfs！

[http://www.filesystems.org/project-unionfs.html](http://www.filesystems.org/project-unionfs.html)

[http://aufs.sourceforge.net/](http://aufs.sourceforge.net/)

            回答 #3

赞同：3

时间：2019-02-13T22:02:34.457

要添加到 paxdiablo 的出色答案，我认为您可以使用 cp -s 

(-s 或 --symbolic-link) 来制作符号链接而不是文字复制

可能加快或简化将符号链接批量添加到文件夹 B 和 C 中的文件的“合并”文件夹 A 中。

（虽然我没有测试过这个）

我不记得我的头顶了，但我确定 CP 有一些选项可以不覆盖现有的，因此只有新文件的符号链接才会被“cp -s”编辑

        perl - 为什么 DynaLoader.pm 不能为 Net::SSLeay 和 Crypt::SSLeay 加载 SSleay.dll？

ID：423330

赞同：1

时间：2009-01-08T05:14:54.937

标签：perl

我有 Perl v5.10。我正在尝试安装 Net::SSLeay 1.30 和 Crypt::SSLeay 0.57。我已经安装了 OpenSSL 0.9.8e。

对于 Net::SSLeay 1.30，我按照以下步骤操作：

```
perl Makefile.PL -windows C:\openssl
制作
nmake 测试——测试失败
制作安装

perl 测试.pl

```

但我遇到了一个致命错误：

```
D:\perl\Net_SSLeay.pm-1.30>perl -w test.pl
1..20
无法为模块 Net::SSLeay: load_file 加载“D:/perl/site/lib/auto/Net/SSLeay/SSLeay.dll”：在 D:/perl/lib/DynaLoader 中找不到指定的模块。下午 203 号线。
 在 test.pl 第 25 行
在 test.pl 第 25 行的 require 中编译失败。
BEGIN failed——编译在 test.pl 第 25 行中止。

```

对于 Crypt::SSLeay 0.57，我得到了相同的结果。

            回答 #1

赞同：6

时间：2009-01-08T07:40:56.653

Randy Kobes[在 Perl Win32 邮件列表上有一个答案](http://www.mail-archive.com/perl-win32-users@listserv.activestate.com/msg32520.html)。您的 PATH 环境变量是否包含包含 libeay32.dll 或 ssleay32.dll 的目录？
您也可以在 Google 中找到许多其他答案。在这种情况下，我会将整个错误消息推送到 Google 搜索栏中。我开始删除部分错误消息，例如特定路径，直到获得[一些搜索结果](http://www.google.com/search?hl=en&client=safari&rls=en-us&q=module+Net%3A%3ASSLeay%3A+load_file%3AThe+specified+module+could+not+be+found&btnG=Search)。这几乎总是对我有用，因为我很少是第一个遇到问题的人。

            回答 #2

赞同：1

时间：2020-08-12T12:16:21.860

我对 Windows Par::Packer 也有类似的问题。生成的 myprogram.exe 无法使用 PERL_DL_DEBUG 加载 rurban 的提示

```
Can't load 'temp\7e717f68.xs.dll' for module Crypt::SSLeay: load_file:Das angegebene Modul wurde nicht gefunden at <embedded>/DynaLoader.pm line 193.
  at <embedded>/PAR/Heavy.pm line 95. 
```

我无法找出要包含在 pp 中的 dll。在这些提示之后，我只是用十六进制编辑器查看 dll 文件并找到了这个字符串：libgcc_s_dw2-1.dll - 这是要包含在我的“编译的” exe程序：

```
pp -M Crypt::SSLeay ^
   -l c:/strawberry/perl/vendor/lib/auto/Crypt/SSLeay/SSLeay.xs.dll ^
   -l c:/strawberry/c/bin/libgcc_s_dw2-1.dll .... 
```

            回答 #3

赞同：1

时间：2017-08-17T13:27:42.187

共享库通常具有外部依赖项，并且在某些操作系统上，这些依赖项需要在加载第一个共享库时立即实现，例如您的`SSLeay.dll`，通常需要两个加密库。`ldd`在 linux 上，如果找到所有库，您可以检查运行时行为。

要对此进行调试，请添加 env var PERL_DL_DEBUG=5，`set PERL_DL_DEBUG=5`然后重试或使用外部工具`depends.exe`查看究竟缺少哪些 dll。

            回答 #4

赞同：0

时间：2020-06-30T01:13:43.770

我在全新安装 Strawberry Perl 5.30 时遇到了同样的问题。谷歌搜索错误只会给出一堆未回答或半回答的问题。Rurban 使用**depends.exe**指向正确的方向。打开**ssleay.xs.dll**并等待它完成抛出错误会显示它所依赖的 5 个主要 dll。其中 2 个是 windows 核心 dll，3 个来自 openssl 和 perl。在草莓安装中，与加密相关的 2 个 dll 在`[perlinstallpath]\c\bin`文件夹中。将此添加到您的 windows**`%PATH%`**变量中，它将开始工作。

        c++ - C++ 能做什么在任何其他语言中都太难或太乱了？

ID：423335

赞同：33

时间：2009-01-08T05:17:58.237

标签：c++, unique

我仍然觉得 C++ 提供了一些无法被击败的东西。我无意在这里发起一场激烈的战争，如果你对不喜欢 C++ 有强烈的意见，请不要在这里发泄。我很想听听 C++ 大师们为什么坚持使用它。

我对 C++ 鲜为人知或未充分利用的方面特别感兴趣。

编辑：*人们，请至少粗略阅读其他回复，以确保您没有重复已经说过的话，如果您同意其他人所说的话，请点赞！*

            回答 #1

赞同：53

时间：2009-01-08T05:21:09.853

**RAII/确定性最终确定**。不，当您处理稀缺的共享资源时，垃圾收集并没有*那么好。*

**不受限制地访问操作系统 API**。

            回答 #2

赞同：39

时间：2009-01-08T08:22:09.927

*我一直使用 C++，因为对于需要结合效率和*复杂性的应用程序来说，它仍然是性能最高的通用语言。例如，我为测量行业的手持设备编写了实时表面建模软件。鉴于资源有限，Java、C# 等...只是不提供必要的性能特征，而 C 等较低级别的语言在抽象特征较弱的情况下开发速度要慢得多。C++ 开发人员可用的抽象级别范围是巨大的，在一个极端情况下，我可以重载算术运算符，这样我就可以说像*MaterialVolume = DesignSurface - GroundSurface*同时运行多个不同的堆来最有效地管理特定设备上我的应用程序的内存。将其与用于解决几乎任何常见问题的大量免费资源相结合，您就拥有了一种强大的开发语言。

C++ 仍然是大多数领域中大多数问题的最佳开发解决方案吗？可能不会，尽管在紧要关头它仍然可以用于大多数人。它仍然是高效开发高性能应用程序的最佳解决方案吗？恕我直言，毫无疑问。

            回答 #3

赞同：33

时间：2009-01-08T06:23:17.450

射中自己的脚。

没有其他语言能提供如此丰富的工具。指针、多重继承、模板、运算符重载和预处理器。

一种非常强大的语言，也为足部拍摄提供了丰富的机会。

编辑：如果我蹩脚的幽默尝试冒犯了一些人，我深表歉意。我认为 C++ 是我曾经使用过的最强大的语言——在需要时可以在汇编语言级别进行编码，并在需要时进行高级抽象。自 90 年代初以来，C++ 一直是我的主要语言。

我的回答是基于多年射击自己的脚的经验。至少 C++ 允许我优雅地做到这一点。

            回答 #4

赞同：23

时间：2009-01-08T05:56:36.820

确定性对象破坏导致一些宏伟的设计模式。例如，虽然 RAII 不像垃圾收集那样通用，但它带来了一些令人印象深刻的功能，而这些功能是 GC 无法获得的。

C++ 的独特之处还在于它具有图灵完备的预处理器。这允许您更喜欢（与 defer 相反）许多代码任务在编译时间而不是运行时间。例如，在实际代码中，您可能有一个 assert() 语句来测试从未发生过的情况。现实情况是，它迟早会发生......并且发生在凌晨 3:00，当你在度假时。C++ 预处理器断言在编译时执行相同的测试。当您坐在电脑前观看代码构建时，编译时断言在上午 8:00 到下午 5:00 之间失败；当您在夏威夷睡着时，运行时断言在凌晨 3:00 失败。在那里很容易看到胜利。

在大多数语言中，策略模式是在运行时完成的，并在类型不匹配的情况下抛出异常。在 C++ 中，策略可以在编译时通过预处理器工具完成，并且可以保证类型安全。

            回答 #5

赞同：19

时间：2009-01-08T06:04:54.993

编写内联汇编（MMX、SSE 等）。

确定性对象破坏。即真正的析构函数。使管理稀缺资源更容易。允许 RAII。

更轻松地访问结构化二进制数据。将内存区域转换为结构比解析它并将每个值复制到结构中更容易。

多重继承。并非所有事情都可以通过接口完成。有时您也想继承实际功能。

            回答 #6

赞同：13

时间：2009-01-08T06:27:58.673

我想我只是要赞扬 C++ 能够使用模板来捕获表达式并在需要时懒惰地执行它。对于那些不知道这是什么的人，[这里](https://stackoverflow.com/questions/414243/lazy-evaluation-in-c#414418)有一个例子。

            回答 #7

赞同：10

时间：2009-01-08T05:20:08.530

模板混合提供了我在其他地方没有见过的重用。使用它们，您可以构建一个具有许多行为的大型对象，就好像您是亲手编写的一样。但是其功能的所有这些小方面都可以重用，它对于实现部分接口（或整个事物）特别有用，您正在实现许多接口。生成的对象快如闪电，因为它都是内联的。

在许多情况下速度可能并不重要，但是当您编写组件软件时，用户可能会以意想不到的复杂方式组合组件来做事，内联和 C++ 的速度似乎允许创建更复杂的结构。

            回答 #8

赞同：9

时间：2009-01-08T06:34:08.817

在需要时对内存布局、对齐和访问进行绝对控制。如果您足够小心，您可以编写一些对缓存非常友好的程序。对于多处理器程序，您还可以从缓存一致性机制中消除很多减速。

（好吧，您可以在 C、汇编和可能的 Fortran 中执行此操作。但是 C++ 允许您在更高级别编写程序的其余部分。）

            回答 #9

赞同：6

时间：2009-09-01T15:19:02.930

这可能不是一个流行的答案，但我认为 C++ 的不同之处在于它的编译时功能，例如模板和#define。您可以使用这些功能对您的程序进行各种文本操作，其中大部分已在后来的语言中以简单的名义被放弃。对我来说，这比任何在 C++ 中更容易或更快的低级位摆弄更重要。

例如，C# 没有真正的宏工具。您不能将另一个文件直接#include 到源代码中，或者使用#define 将程序作为文本进行操作。想想任何时候你不得不机械地输入重复的代码，你知道有更好的方法。您甚至可能已经编写了一个程序来为您生成代码。好吧，C++ 预处理器自动化了所有这些事情。

与 C++ 模板相比，C# 中的“泛型”工具同样受到限制。C++ 允许您盲目地将点运算符应用于模板类型 T，调用（例如）可能不存在的方法，并且仅在模板实际应用于特定类时才应用正确性检查。发生这种情况时，如果您对 T 所做的所有假设实际上都成立，那么您的代码将编译。C# 不允许这样做...类型“T”基本上必须作为对象处理，即仅使用可用于所有操作的最低公分母（赋值、GetHashCode()、Equals()）。

C# 以简单的名义取消了预处理器和真正的泛型。不幸的是，当我使用 C# 时，我发现自己正在寻找这些 C++ 结构的替代品，这些结构不可避免地比 C++ 方法更臃肿和分层。例如，我见过程序员以几种臃肿的方式解决#include 的缺失问题：动态链接到外部程序集、在多个位置重新定义常量（每个项目一个文件）或从数据库中选择常量等。

正如《辛普森一家》的 Crabapple 女士曾经说过的那样，这“太蹩脚了，米尔豪斯”。

在计算机科学方面，C++ 的这些编译时特性支持诸如按名称调用参数传递之类的事情，众所周知，它比按值调用和按引用调用更强大。

同样，这可能不是流行的答案——例如，任何介绍性 C++ 文本都会警告您不要使用#define。但是多年来一直使用多种语言，并考虑到所有这些背后的理论，我认为很多人给出了不好的建议。在被称为“IT”的稀释子领域中似乎尤其如此。

            回答 #10

赞同：5

时间：2009-01-08T07:34:42.923

C# 和 Java 强制您将“main()”函数放在一个类中。我觉得这很奇怪，因为它稀释了类的含义。

对我来说，类是问题域中的一类对象。程序*不是*这样的对象。所以你的程序中不应该有一个名为“程序”的类。这相当于使用符号来表示自己的数学证明——证明——以及表示数学对象的符号。这将是奇怪和不一致的。

幸运的是，与 C# 和 Java 不同，C++ 允许使用全局函数。这让您的 main() 函数存在于外部。因此，C++ 提供了一个更简单、更一致并且可能更真实的面向对象习语的实现。因此，这是 C++ 可以做的一件事，但 C# 和 Java 不能。

            回答 #11

赞同：5

时间：2009-01-08T08:38:50.547

以最小的开销跨进程传递 POD 结构。换句话说，它使我们能够轻松处理二进制数据块。

            回答 #12

赞同：3

时间：2009-01-08T05:20:03.273

我认为运算符重载是一个非常好的功能。当然，它可能会被滥用（就像在 Boost lambda 中一样）。

            回答 #13

赞同：2

时间：2009-01-08T15:57:55.530

严格控制系统资源（尤其是内存），同时可选地提供强大的抽象机制。在这方面，我所知道的唯一可以接近 C++ 的语言是 Ada。

            回答 #14

赞同：2

时间：2009-01-09T06:49:47.677

C++ 提供了对内存的完全控制，因此使程序执行流程更加可预测。您不仅可以准确地说出内存分配和释放的时间，还可以定义自己的堆，拥有多个用于不同目的的堆，并准确说出内存数据分配到的位置。这在嵌入式/实时系统（如游戏机、手机、mp3 播放器等）上编程时经常有用，其中：

1.  对易于达到的内存有严格的上限（与 PC 相比，当你用完物理内存时它会变慢）
2.  经常有非同质的内存布局。您可能希望在一块物理内存中分配一种类型的对象，而在另一块中分配另一种类型的对象。
3.  有实时编程约束。在错误的时间意外调用垃圾收集器可能是灾难性的。

AFAIK、C ​​和 C++ 是做这种事情的唯一明智选择。

            回答 #15

赞同：-1

时间：2009-01-08T16:09:51.667

老实说，如果您愿意编写足够多的代码，您几乎可以做任何事情。

所以要回答你的问题，不，没有什么是你不能用 C++ 做的另一种语言做的。只是你有多少耐心，你愿意付出漫长的不眠之夜来让它发挥作用吗？

C++ 包装器使某些事情变得容易（因为它们可以读取头文件），例如 Office 开发。但同样，这是因为有人写了很多代码在 RCW 或“运行时可调用包装器”中为你“包装”它

编辑：你也意识到这是一个加载的问题。

        c++ - 如何阻止选定的应用程序访问互联网（C++、Win32）

ID：423345

赞同：5

时间：2009-01-08T05:25:22.623

标签：c++, winapi, windows-vista, windows-xp, tcp

我希望有一个正在运行的应用程序或服务，它可以按某个时间表禁用除特定应用程序之外的所有应用程序对 Internet 的访问。

我正在尝试创建一个可以在程序控制下打开或关闭的过滤器。不仅仅是 IP 地址和端口，我还希望能够阻止特定的应用程序，就像 Zone Alarm 和其他软件防火墙让您阻止一样。

例如，iexplore.exe、skype.exe、firefox.exe、aim.exe。但仍需要允许其他应用程序根据需要进行连接。

它必须在 Vista 和 XP 上工作，但我有点希望该方法在每个平台上都会有所不同。  

基本上，过滤器必须将网络通信绑定回发出请求的可执行文件，然后允许或拒绝它。

**更新：** 

至少在**Vista**上，看起来我想[在 WFP 的 ALE 层中](http://msdn.microsoft.com/en-us/library/aa363971(VS.85).aspx)使用过滤器。

在**XP**上，我仍在寻找最好的方法。我*真的*需要编写设备驱动程序并处理内核内容吗？我只是一个低级的应用程序开发人员。现在杀了我。

**更新 2：**

目前正在研究 Pre-Vista 系统的 PfCreateInterface 和相关的 Pf* API。

            回答 #1

赞同：3

时间：2009-01-09T04:58:34.673

您可以使用Windows 防火墙 API中的[INetFwAuthorizedApplications](http://msdn.microsoft.com/en-us/library/aa365101.aspx)接口动态更改 Vista 和 XP 的防火墙策略。

另请参阅此[问题](https://stackoverflow.com/questions/113755/programmatically-add-an-application-to-windows-firewall)。

            回答 #2

赞同：1

时间：2009-01-08T05:36:41.197

您必须编写一个设备驱动程序，根据请求流量的可执行文件过滤流量。

            回答 #3

赞同：1

时间：2010-11-23T17:56:52.320

通过使用防火墙限制其访问互联网。转到防火墙设置高级选项卡（win 7）并执行此操作

            回答 #4

赞同：0

时间：2009-01-08T05:32:42.547

我不确定，但我认为您需要通过让程序以具有有限权限的用户身份运行来做到这一点，问题是，您可以创建一个停止此类事情的用户帐户吗？

            回答 #5

赞同：0

时间：2009-01-08T05:38:09.647

您需要将所有（或至少许多）对任何正在运行的程序的 WinSock API 函数的调用重定向到您自己的替换函数。这意味着进入每个正在运行的程序的内存并劫持这些功能，这是一个……*有趣*的……练习。:-)

这可能足以让您开始，或者至少提出一些更具体的问题要问。

            回答 #6

赞同：0

时间：2009-01-08T13:19:32.243

你能把系统的winsock DLL移到一边（即重命名）并用你自己的替换它吗？您的应该提供相同的 API，但检查传入请求的进程名称...返回错误代码到被阻止的应用程序，并将来自允许应用程序的调用转发到真正的 DLL。

        asp.net-mvc - ASP.NET MVC：在母版页中动态链接到 CSS 样式表

ID：423352

赞同：2

时间：2009-01-08T05:28:34.287

标签：asp.net-mvc

我希望允许用户在我的 ASP.NET MVC 网站上自定义他们的网页，以便他们可以使用自己的样式表。在 MVC 中，样式表链接放置在母版页的部分中。如何根据用户动态链接到母版页中的 CSS（即，我将查找我的表以找到特定用户的 CSS 并链接到它）。

谢谢！

            回答 #1

赞同：2

时间：2009-01-08T05:36:27.047

我会在母版页的标记 ( [http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.contentplaceholder.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.contentplaceholder.aspx) ) 中使用 ContentPlaceHolder 并根据视图应用所需的数据你在展示。

            回答 #2

赞同：2

时间：2009-01-08T22:24:34.047

我会让你的视图特定视图模型继承自一个通用的基本视图模型，然后在这个基本视图模型上拥有一个属性，该属性会在你的控制器中设置。然后，您的母版页可以动态设置正确的 css 链接，而无需在每个视图的 ContentPlaceHolder 中重复代码。

            回答 #3

赞同：0

时间：2009-07-17T03:31:48.037

如何在 src 标签中使用旧学校将路径传递给您的自定义控制器

您的 MyCssController 根据您的逻辑重定向到自定义路径？

        c# - WebService ASP.Net SQL 的奇怪日期问题

ID：423357

赞同：1

时间：2009-01-08T05:31:11.673

标签：c#, asp.net, sql, date

我的服务器位于美国，我正在对其进行查询。远程服务器（美国）和本地的表中包含的数据相同。

问题是当我使用远程服务器的 WebService 检索数据集时。日期列显示上一个日期。例如，日期列具有“2007 年 1 月 14 日”，但检索时显示“2007 年 1 月 13 日”。

我无法确定原因，因为其他一切工作正常。

            回答 #1

赞同：1

时间：2009-01-08T05:43:22.540

数据集中的时间存在问题，至少在 .net 1.1 中是这样。数据集自动将时间调整为客户端的时区。我的猜测是您的客户端设置为比服务器更西的时区。反过来，这将时间向后推了几个小时，导致日期从 2007 年 1 月 14 日移动到 2007 年 1 月 13 日。

看看[这篇](http://support.microsoft.com/kb/842545)知识库文章。

            回答 #2

赞同：0

时间：2009-01-08T05:43:54.893

也许数据库的本地化不是数据集所期望的。我不确定确切的规格，但例如，它可能将值存储为 EDT 但希望它是 UTC。因此，您在数据库文件中看到的可能是 2007 年 1 月 14 日凌晨 12:00，但是当它本地化为美国时间时，您会得到 2007 年 1 月 13 日下午 4:00 什么的？

还要检查时间而不仅仅是日期，看看你是否能识别出一种模式。然后你也许可以相应地调整。

        java - 车辆跟踪系统/Jan08

ID：423360

赞同：-1

时间：2009-01-08T05:32:49.737

标签：java, gprs

我们正在开发具有成本效益的车辆跟踪系统，据我所知，使用 GPS 跟踪车辆成本更高。所以我们正在寻求开发使用成本更低的GPRS系统。

我怀疑是否可以仅使用 GPRS（根本不使用 GPS）来跟踪车辆。这是否可能。如果我错了，如果您有任何文档或链接有用，请更正。

在此先感谢，马赫什

            回答 #1

赞同：3

时间：2009-01-08T06:12:15.883

If you don't need an exact location you can use cell tower information and some external api to get the coordinates for each tower.
It's the same function that google uses in their mobile Maps application.

Example:
[http://www.codeproject.com/KB/mobile/DeepCast.aspx](http://www.codeproject.com/KB/mobile/DeepCast.aspx)

        file - 将文件从 Windows 即时镜像/同步到 Linux 服务器的最佳方式

ID：423362

赞同：33

时间：2009-01-08T05:34:27.533

标签：file, synchronization, mirroring

我在 Windows 机器上有一个目录，其中包含大量文件和文件夹，我需要查看这些文件和文件夹，并将文件立即（或尽可能接近）镜像/同步到本地网络上的 Linux 机器。

我调查过： - Rsync，不够实时 - WinSCP '保持目录最新' 功能，这没问题，但仅限于 500 个目录，性能很慢。

有很多共享软件风格的应用程序声称可以做到这一点，但它们看起来都很可疑。似乎某处必须有一个好的 FOSS 解决方案？

更新：只要是即时和自动的，我会对单向传输而不是完全同步感到满意。

            回答 #1

赞同：6

时间：2009-01-08T06:06:27.220

我赞同 eneset 提出的 Unison 软件。此外，如果你想寻找一些替代品 Lifehacker 有一篇关于这个主题的有趣文章[http://lifehacker.com/372175/free-ways-to-synchronize-folders-between-computers](http://lifehacker.com/372175/free-ways-to-synchronize-folders-between-computers)

标题

            回答 #2

赞同：6

时间：2009-01-10T07:10:34.850

您似乎想要实际处理 linux 服务器上的文件，就好像它们是您计算机上的本地文件一样。

您是否考虑过寻找将远程 ssh 文件夹挂载为本地驱动器的工具？

            回答 #3

赞同：5

时间：2009-01-08T05:40:16.430

看看 Unison ( [http://www.cis.upenn.edu/~bcpierce/unison/](http://www.cis.upenn.edu/~bcpierce/unison/) )。我成功地将它用于 Linux/Windows 主目录镜像。

            回答 #4

赞同：3

时间：2009-01-10T07:19:49.293

你考虑过使用[Samba](http://samba.org)吗？如果您将它们设置为共享，它将允许您在 linux 下挂载 windows 共享以及从 windows 访问 linux 目录。

        c# - 查询 SQL 2005 Analysis Services 时从 Cellset 中检测 KPI 单元

ID：423365

赞同：0

时间：2009-01-08T05:36:57.450

标签：c#, sql-server-2005, olap, mdx

给定一个可能返回 KPI 值的 MDX 查询，有没有办法查询 cellset 对象中的单元以确定它们是否真的是 KPI？这样我可以在结果中显示趋势/状态图像而不是 0\. -1 等。

            回答 #1

赞同：0

时间：2009-02-20T11:28:03.850

什么表示一个值是一个 KPI？只有你知道！

但是，如果度量名称包含字母“KPI”，也许您可​​以检测到这一点（如果在 Microsoft Analysis Services 上，某些 VB 函数（如 InStr）可以在 MDX 中使用，但仅检查整个度量名称会更简单）。

另一种方法是在多维数据集中设置成员属性，并让 MDX 基于此采取不同的行动。

        windows - 如何使用 Perl 的 Win32::IntAuth 通过单点登录进行连接？

ID：423369

赞同：4

时间：2009-01-08T05:38:21.677

标签：windows, perl, single-sign-on

我有 Perl 5.10。如何使用单点登录方法连接到服务器？我必须向服务器发送服务票证并保存服务器返回的凭据。

[`Win32::IntAuth`](http://search.cpan.org/dist/Win32-IntAuth)对这个有用吗？如何`Win32::IntAuth`在脚本中使用模块？我已经`Win32::IntAuth`在 Perl v5.10 中安装了该模块。

请为此问题提出一些解决方案和测试脚本。

    c# - 如何使用 WPF 中的 MediaPlayer 编写打开、开始播放、然后返回音频文件持续时间的方法？

ID：423373

赞同：2

时间：2009-01-08T05:41:33.463

标签：c#, wpf, audio

很明显我在下面尝试做什么，但我得到以下异常：

无法为 Duration 值“自动”返回 TimeSpan 属性值。

我很沮丧地读到那个

在 MediaOpened 发生之前，无法确定 NaturalDuration。（[链接](http://msdn.microsoft.com/en-us/library/system.windows.media.mediaplayer.naturalduration(VS.85).aspx)）

这是否意味着我必须想出一个人为的方法来打开文件，在单独的线程中等待媒体打开事件，然后仅在事件触发后才返回持续时间？

```
 public static int PlayAudio(string fileName)
    {
        try
        {
            myMediaPlayer.Stop();
            myMediaPlayer.Close();
            myMediaPlayer.Open(new Uri(filename));
            myMediaPlayer.Play();
            return myMediaPlayer.NaturalDuration.TimeSpan.Milliseconds;
        }
        catch (Exception e)
        {
            MessageBox.Show(e.Message);
            return -1;
        }
    } 
```

            回答 #1

赞同：5

时间：2009-05-29T20:54:36.480

我必须想出一个人为的方法来打开文件，在单独的线程中等待媒体打开事件，然后仅在事件触发后返回持续时间

不幸的是，这正是它的意思。以下是我刚刚想到的：

```
using System;
using System.Threading;
using System.Windows.Media;
using System.Windows.Threading;

class Program
{
    static void Main(string[] args)
    {
        var mediaFile = @"c:\path\to\mediafile.mp3";
        var duration = GetMediaDuration(mediaFile, TimeSpan.FromMilliseconds(500));
        Console.WriteLine(duration.ToString());
        Console.ReadKey();
    }

    static TimeSpan GetMediaDuration(string mediaFile)
    {
        return GetMediaDuration(mediaFile, TimeSpan.Zero);
    }

    static TimeSpan GetMediaDuration(string mediaFile, TimeSpan maxTimeToWait)
    {
        var mediaData = new MediaData() {MediaUri = new Uri(mediaFile)};

        var thread = new Thread(GetMediaDurationThreadStart);
        DateTime deadline = DateTime.Now.Add(maxTimeToWait);
        thread.Start(mediaData);

        while (!mediaData.Done && ((TimeSpan.Zero == maxTimeToWait) || (DateTime.Now < deadline)))
            Thread.Sleep(100);

        Dispatcher.FromThread(thread).InvokeShutdown();

        if (!mediaData.Done)
            throw new Exception(string.Format("GetMediaDuration timed out after {0}", maxTimeToWait));
        if (mediaData.Failure)
            throw new Exception(string.Format("MediaFailed {0}", mediaFile));

        return mediaData.Duration;
    }

    static void GetMediaDurationThreadStart(object context)
    {
        var mediaData = (MediaData) context;
        var mediaPlayer = new MediaPlayer();

        mediaPlayer.MediaOpened += 
            delegate 
                {
                    if (mediaPlayer.NaturalDuration.HasTimeSpan)
                        mediaData.Duration = mediaPlayer.NaturalDuration.TimeSpan; 
                    mediaData.Success = true; 
                    mediaPlayer.Close();
                };

        mediaPlayer.MediaFailed += 
            delegate
                {
                    mediaData.Failure = true;
                    mediaPlayer.Close();
                };

        mediaPlayer.Open(mediaData.MediaUri);

        Dispatcher.Run();
    }
}

class MediaData
{
    public Uri MediaUri;
    public TimeSpan Duration = TimeSpan.Zero;
    public bool Success;
    public bool Failure;
    public bool Done { get { return (Success || Failure); } }
} 
```

            回答 #2

赞同：3

时间：2009-05-31T08:49:50.507

是的，没有直接打开媒体文件并获取媒体时长的方法，原因是文件是在后台打开的（以支持需要很长时间才能打开的文件，例如远程服务器上的文件），所以在您调用 Open 之后，该文件尚未打开。

您最好的选择是重构您的代码，以便在不返回持续时间的情况下打开文件，然后等待 MediaOpened/MediaFailed 事件。

如果您绝对需要打开文件并返回您遇到的问题的持续时间，请尽量避免使用 Thread.Sleep ，因为它会锁定您的 UI 并记住用户可以在您等待文件时继续与 GUI 交互打开，可能会在您等待时打开另一个文件。

            回答 #3

赞同：0

时间：2009-01-08T10:37:13.833

[可以使用此问题](https://stackoverflow.com/questions/68283/viewedit-mp3-id3-data-in-c)中提到的库之一从 MP3 中的 ID3 标记和 WMA 中的类似标记获取持续时间信息。

在将文件加载到 MediaPlayer 控件之前，您可能会获得此信息。

        javascript - 如何使用 JavaScript 从完整路径中获取文件名？

ID：423376

赞同：388

时间：2009-01-08T05:43:32.150

标签：javascript

有没有办法从完整路径中获取最后一个值（基于“\”符号）？

例子：

`C:\Documents and Settings\img\recycled log.jpg`

在这种情况下，我只想`recycled log.jpg`从 JavaScript 中的完整路径中获取。

            回答 #1

赞同：800

时间：2009-01-08T05:48:18.473

```
var filename = fullPath.replace(/^.*[\\\/]/, '') 
```

这将处理路径中的 \ OR /

            回答 #2

赞同：168

时间：2014-08-09T17:15:10.623

只是为了性能，我测试了这里给出的所有答案：

```
var substringTest = function (str) {
    return str.substring(str.lastIndexOf('/')+1);
}

var replaceTest = function (str) {
    return str.replace(/^.*(\\|\/|\:)/, '');
}

var execTest = function (str) {
    return /([^\\]+)$/.exec(str)[1];
}

var splitTest = function (str) {
    return str.split('\\').pop().split('/').pop();
}

substringTest took   0.09508600000000023ms
replaceTest   took   0.049203000000000004ms
execTest      took   0.04859899999999939ms
splitTest     took   0.02505500000000005ms 
```

获胜者是**拆分和流行**风格的答案，感谢**bobince**！

            回答 #3

赞同：146

时间：2015-06-28T20:43:40.307

在 Node.js 中，您可以使用[Path 的解析模块](https://nodejs.org/api/path.html#path_path_parse_pathstring)...

```
var path = require('path');
var file = '/home/user/dir/file.txt';

var filename = path.parse(file).base;
//=> 'file.txt' 
```

            回答 #4

赞同：87

时间：2009-01-08T11:52:24.353

路径来自什么平台？Windows 路径不同于 POSIX 路径不同于 Mac OS 9 路径不同于 RISC OS 路径不同...

如果它是一个文件名可以来自不同平台的网络应用程序，那么没有一个解决方案。然而，合理的做法是同时使用 '\' (Windows) 和 '/' (Linux/Unix/Mac 以及 Windows 上的替代方案) 作为路径分隔符。这是一个非 RegExp 版本，以获得额外的乐趣：

```
var leafname= pathname.split('\\').pop().split('/').pop(); 
```

            回答 #5

赞同：31

时间：2009-06-26T21:12:33.110

Ates，您的解决方案不能防止空字符串作为输入。在这种情况下，它会失败并显示`TypeError: /([^(\\|\/|\:)]+)$/.exec(fullPath) has no properties`.

bobince，这是处理 DOS、POSIX 和 HFS 路径分隔符（和空字符串）的 nickf 版本：

```
return fullPath.replace(/^.*(\\|\/|\:)/, ''); 
```

            回答 #6

赞同：20

时间：2012-01-17T04:56:49.597

以下 JavaScript 代码行将为您提供文件名。

```
var z = location.pathname.substring(location.pathname.lastIndexOf('/')+1);
alert(z); 
```

            回答 #7

赞同：11

时间：2019-05-03T18:17:04.250

另一个

```
var filename = fullPath.split(/[\\\/]/).pop(); 
```

这里[split](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/split#Splitting_with_a_RegExp_to_include_parts_of_the_separator_in_the_result)有一个带有[字符类](https://www.regular-expressions.info/charclass.html)

的正则表达式 这两个字符必须用 '\' 转义

或者使用[数组进行拆分](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/split#Splitting_with_an_array_as_separator) 

```
var filename = fullPath.split(['/','\\']).pop(); 
```

如果需要，这将是动态将更多分隔符推入数组的方法。

如果`fullPath`由代码中的字符串显式设置，则需要[转义反斜杠](https://mathiasbynens.be/notes/javascript-escapes)！

像`"C:\\Documents and Settings\\img\\recycled log.jpg"`

            回答 #8

赞同：10

时间：2009-01-09T03:55:56.903

并不比 nickf 的[answer](https://stackoverflow.com/questions/423376/how-to-get-file-name-from-full-path-using-javascript#423385)更简洁，但是这个直接“提取”了答案，而不是用空字符串替换不需要的部分：

```
var filename = /([^\\]+)$/.exec(fullPath)[1]; 
```

            回答 #9

赞同：10

时间：2021-04-04T08:26:23.903

无需专门处理反斜杠；大多数答案不处理搜索参数。
现代方法是简单地使用[`URL`API](https://developer.mozilla.org/en-US/docs/Web/API/URL_API)并获取`pathname`属性。API 将反斜杠规范化为斜杠。
为了将结果解析`%20`为空格，只需将其传递给[`decodeURIComponent`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/decodeURIComponent).

```
const getFileName = (fileName) => new URL(fileName).pathname.split("/").pop();

// URLs need to have the scheme portion, e.g. `file://` or `https://`.
console.log(getFileName("file://C:\\Documents and Settings\\img\\recycled log.jpg")); // "recycled%20log.jpg"
console.log(decodeURIComponent(getFileName("file://C:\\Documents and Settings\\img\\recycled log.jpg"))); // "recycled log.jpg"
console.log(getFileName("https://example.com:443/path/to/file.png?size=480")); // "file.png"
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

如果您总是想要路径的最后一个*非空*部分（例如from ） ，请`.filter(Boolean)`在 the 之前添加一个。`.pop()`*`file.png``https://example.com/file.png/`* *如果您只有一个相对 URL，但仍只想获取文件名，请使用[构造函数的](https://developer.mozilla.org/en-US/docs/Web/API/URL/URL#parameters)[第二个参数`URL`](https://developer.mozilla.org/en-US/docs/Web/API/URL/URL#parameters)来传递基本来源。`"https://example.com"`足矣：`new URL(fileName, "https://example.com")`。也可以在`"https://"`你`fileName` 的前面加上 -`URL`构造函数接受`https://path/to/file.ext`一个有效的 URL。

* * *

## 回答 #10

> 赞同：8
> 
>             
> 
> 时间：2014-11-21T02:20:35.473

询问“获取不带扩展名的文件名”的问题参考here，但没有解决方案。这是从 Bobbie 的解决方案修改而来的解决方案。

```
var name_without_ext = (file_name.split('\\').pop().split('/').pop().split('.'))[0]; 
```

* * *

## 回答 #11

> 赞同：3
> 
>             
> 
> 时间：2017-01-25T15:20:40.867

我用：  

```
var lastPart = path.replace(/\\$/,'').split('\\').pop(); 
```

它取代了最后一个`\`，因此它也适用于文件夹。

* * *

## 回答 #12

> 赞同：2
> 
>             
> 
> 时间：2009-07-19T18:35:17.783

```
<script type="text/javascript">
    function test()
    {
        var path = "C:/es/h221.txt";
        var pos =path.lastIndexOf( path.charAt( path.indexOf(":")+1) );
        alert("pos=" + pos );
        var filename = path.substring( pos+1);
        alert( filename );
    }
</script>
<form name="InputForm"
      action="page2.asp"
      method="post">
    <P><input type="button" name="b1" value="test file button"
    onClick="test()">
</form> 
```

* * *

## 回答 #13

> 赞同：2
> 
>             
> 
> 时间：2018-08-07T07:35:04.440

在您的项目中包含的一个小功能是从 Windows 的完整路径以及 GNU/Linux 和 UNIX 绝对路径中确定文件名。

```
/**
 * @param {String} path Absolute path
 * @return {String} File name
 * @todo argument type checking during runtime
 * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes
 * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice
 * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/lastIndexOf
 * @example basename('/home/johndoe/github/my-package/webpack.config.js') // "webpack.config.js"
 * @example basename('C:\\Users\\johndoe\\github\\my-package\\webpack.config.js') // "webpack.config.js"
 */
function basename(path) {
  let separator = '/'

  const windowsSeparator = '\\'

  if (path.includes(windowsSeparator)) {
    separator = windowsSeparator
  }

  return path.slice(path.lastIndexOf(separator) + 1)
} 
```

* * *

## 回答 #14

> 赞同：2
> 
>             
> 
> 时间：2019-09-30T16:33:22.670

对于“文件名”和“路径”，此解决方案更加简单和通用。

```
parsePath = (path) => {
    // regex to split path (untile last / or \ to two groups '(.*[\\\/])' for path and '(.*)' (untile the end after the \ or / )for file name
    const regexPath = /^(?<path>(.*[\\\/])?)(?<filename>.*)$/;

    const match = regexPath.exec(path);
    if (path && match) {
        return {
            path: match.groups.path,
            filename: match.groups.filename
        }
    }
    throw Error("Error parsing path");
}

// example
const str = 'C:\\Documents and Settings\\img\\recycled log.jpg';
parsePath(str); 
```

​</p>

* * *

## 回答 #15

> 赞同：1
> 
>             
> 
> 时间：2011-07-29T06:09:58.977

完整的答案是：

```
<html>
    <head>
        <title>Testing File Upload Inputs</title>
        <script type="text/javascript">

        function replaceAll(txt, replace, with_this) {
            return txt.replace(new RegExp(replace, 'g'),with_this);
        }

        function showSrc() {
            document.getElementById("myframe").href = document.getElementById("myfile").value;
            var theexa = document.getElementById("myframe").href.replace("file:///","");
            var path = document.getElementById("myframe").href.replace("file:///","");
            var correctPath = replaceAll(path,"%20"," ");
            alert(correctPath);
        }
        </script>
    </head>
    <body>
        <form method="get" action="#"  >
            <input type="file"
                   id="myfile"
                   onChange="javascript:showSrc();"
                   size="30">
            <br>
            <a href="#" id="myframe"></a>
        </form>
    </body>
</html> 
```

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2010-05-25T18:21:10.940

```
<html>
    <head>
        <title>Testing File Upload Inputs</title>
        <script type="text/javascript">
            <!--
            function showSrc() {
                document.getElementById("myframe").href = document.getElementById("myfile").value;
                var theexa = document.getElementById("myframe").href.replace("file:///","");
                alert(document.getElementById("myframe").href.replace("file:///",""));
            }
            // -->
        </script>
    </head>
    <body>
        <form method="get" action="#"  >
            <input type="file" 
                   id="myfile" 
                   onChange="javascript:showSrc();" 
                   size="30">
            <br>
            <a href="#" id="myframe"></a>
        </form>
    </body>
</html> 
```

* * *

## 回答 #17

> 赞同：0
> 
>             
> 
> 时间：2016-05-20T16:54:15.310

成功为您的问题编写脚本，完整测试

```
<script src="~/Scripts/jquery-1.10.2.min.js"></script>

<p  title="text" id="FileNameShow" ></p>
<input type="file"
   id="myfile"
   onchange="javascript:showSrc();"
   size="30"> 
```

```
<script type="text/javascript">

function replaceAll(txt, replace, with_this) {
    return txt.replace(new RegExp(replace, 'g'), with_this);
}

function showSrc() {
    document.getElementById("myframe").href = document.getElementById("myfile").value;
    var theexa = document.getElementById("myframe").href.replace("file:///", "");
    var path = document.getElementById("myframe").href.replace("file:///", "");
    var correctPath = replaceAll(path, "%20", " ");
   alert(correctPath);
    var filename = correctPath.replace(/^.*[\\\/]/, '')
    $("#FileNameShow").text(filename)
} 
```

* * *

## 回答 #18

> 赞同：0
> 
>             
> 
> 时间：2022-02-09T18:02:39.303

像 PHP pathInfo 这样的简单函数：

```
function pathInfo(s) {
    s=s.match(/(.*?[\\/:])?(([^\\/:]*?)(\.[^\\/.]+?)?)(?:[?#].*)?$/);
    return {path:s[1],file:s[2],name:s[3],ext:s[4]};
}

console.log( pathInfo('c:\\folder\\file.txt') );

console.log( pathInfo('/folder/another/file.min.js?query=1') );
```

```
Type and try it:
<input oninput="document.getElementById('test').textContent=pathInfo(this.value).file" value="c:\folder\folder.name\file.ext" style="width:300px">
```

* * *

## 回答 #19

> 赞同：-3
> 
>             
> 
> 时间：2013-11-06T10:38:39.383

`var file_name = file_path.substring(file_path.lastIndexOf('/'));`

* * *

## 回答 #20

> 赞同：-3
> 
>             
> 
> 时间：2014-11-23T19:01:20.967

```
function getFileName(path, isExtension){

  var fullFileName, fileNameWithoutExtension;

  // replace \ to /
  while( path.indexOf("\\") !== -1 ){
    path = path.replace("\\", "/");
  }

  fullFileName = path.split("/").pop();
  return (isExtension) ? fullFileName : fullFileName.slice( 0, fullFileName.lastIndexOf(".") );
} 
```

# python - 在函数中使用全局变量

> ID：423379
> 
>         
> 
> 赞同：3607
> 
>         
> 
> 时间：2009-01-08T05:45:02.847
> 
>         
> 
> 标签：python, global-variables, scope

如何在函数中创建或使用全局变量？

如果我在一个函数中创建一个全局变量，如何在另一个函数中使用该全局变量？我是否需要将全局变量存储在需要访问的函数的局部变量中？

* * *

## 回答 #1

> 赞同：4803
> 
>             
> 
> 时间：2009-01-08T08:39:44.023

您可以在其他函数中使用全局变量，方法是将其声明为`global`在为其分配值的每个函数中：

```
globvar = 0

def set_globvar_to_one():
    global globvar    # Needed to modify global copy of globvar
    globvar = 1

def print_globvar():
    print(globvar)     # No need for global declaration to read value of globvar

set_globvar_to_one()
print_globvar()       # Prints 1 
```

由于不清楚`globvar = 1`是创建局部变量还是更改全局变量，Python 默认创建局部变量，并让您使用`global`关键字显式选择其他行为。

如果您想跨模块共享全局变量，请参阅其他答案。

* * *

## 回答 #2

> 赞同：840
> 
>             
> 
> 时间：2009-01-08T09:19:55.583

如果我正确理解您的情况，那么您所看到的是 Python 如何处理本地（函数）和全局（模块）命名空间的结果。

假设你有一个这样的模块：

```
# sample.py
myGlobal = 5

def func1():
    myGlobal = 42

def func2():
    print myGlobal

func1()
func2() 
```

您可能希望这会打印 42，但实际上它会打印 5。正如已经提到的，如果您向 中添加 ' `global`' 声明`func1()`，`func2()`则将打印 42。

```
def func1():
    global myGlobal
    myGlobal = 42 
```

这里发生的事情是，Python 假定*分配给*的任何名称，在函数内的任何位置，都是该函数的本地名称，除非另有明确说明。如果它只是从一个名称中*读取*，并且该名称在本地不存在，它将尝试在任何包含范围（例如模块的全局范围）中查找该名称。

因此，当您将 42 分配给 name`myGlobal`时，Python 会创建一个局部变量来隐藏同名的全局变量。该本地超出范围并在返回时被[垃圾收集；](http://www.digi.com/wiki/developer/index.php/Python_Garbage_Collection)`func1()`同时，`func2()`除了（未修改的）全局名称之外，永远看不到任何东西。请注意，这个命名空间决定发生在编译时，而不是运行时——如果你在分配给它之前读取`myGlobal`inside的值`func1()`，你会得到一个`UnboundLocalError`，因为 Python 已经决定它必须是一个局部变量，但是它还没有任何与之相关的价值。但是通过使用 ' `global`' 语句，您告诉 Python 它应该在别处寻找名称，而不是在本地分配给它。

（我相信这种行为主要源于对本地命名空间的优化——如果没有这种行为，Python 的 VM 将需要在每次将新名称分配给函数内部时执行至少三个名称查找（以确保名称没有t 已经存在于模块/内置级别），这将显着减慢非常常见的操作。）

* * *

## 回答 #3

> 赞同：257
> 
>             
> 
> 时间：2009-01-08T05:59:04.520

您可能想探索[命名空间](http://docs.python.org/reference/datamodel.html)的概念。在 Python 中，[模块是存放](http://docs.python.org/tutorial/modules.html)*全局*数据的天然场所：

> 每个模块都有自己的私有符号表，它被模块中定义的所有函数用作全局符号表。因此，模块的作者可以在模块中使用全局变量，而不必担心与用户的全局变量发生意外冲突。另一方面，如果您知道自己在做什么，则可以使用与引用其函数相同的符号来触摸模块的全局变量，`modname.itemname`.

此处描述了 global-in-a-module 的特定用法-[如何跨模块共享全局变量？](https://docs.python.org/3/faq/programming.html#how-do-i-share-global-variables-across-modules)，为了完整起见，这里共享内容：

> 在单个程序中跨模块共享信息的规范方法是创建一个特殊的配置模块（通常称为**config**或**cfg**）。只需在应用程序的所有模块中导入配置模块；然后该模块可作为全局名称使用。因为每个模块只有一个实例，所以对模块对象所做的任何更改都会在各处反映出来。例如：

> 文件：config.py

> ```
> x = 0   # Default value of the 'x' configuration setting 
> ```

> 文件：mod.py

```
import config
config.x = 1 
```

> 文件：main.py

```
import config
import mod
print config.x 
```

* * *

## 回答 #4

> 赞同：106
> 
>             
> 
> 时间：2011-07-12T12:35:08.997

Python 使用简单的启发式方法来决定它应该从哪个范围加载变量，在本地和全局之间。如果变量名出现在赋值的左侧，但未声明为全局变量，则假定它是局部变量。如果它没有出现在分配的左侧，则假定它是全局的。  

```
>>> import dis
>>> def foo():
...     global bar
...     baz = 5
...     print bar
...     print baz
...     print quux
... 
>>> dis.disassemble(foo.func_code)
  3           0 LOAD_CONST               1 (5)
              3 STORE_FAST               0 (baz)

  4           6 LOAD_GLOBAL              0 (bar)
              9 PRINT_ITEM          
             10 PRINT_NEWLINE       

  5          11 LOAD_FAST                0 (baz)
             14 PRINT_ITEM          
             15 PRINT_NEWLINE       

  6          16 LOAD_GLOBAL              1 (quux)
             19 PRINT_ITEM          
             20 PRINT_NEWLINE       
             21 LOAD_CONST               0 (None)
             24 RETURN_VALUE        
>>> 
```

看看出现在赋值左侧的 baz 如何`foo()`是唯一的`LOAD_FAST`变量。

* * *

## 回答 #5

> 赞同：70
> 
>             
> 
> 时间：2009-01-08T09:03:33.510

如果要在函数中引用全局变量，可以使用**global**关键字来声明哪些变量是全局的。您不必在所有情况下都使用它（正如这里有人错误地声称的那样） - 如果在定义此函数的函数的本地范围或范围内找不到表达式中引用的名称，则在全局范围内查找它变量。

但是，如果您分配给未在函数中声明为全局的新变量，它会被隐式声明为局部，并且它可以覆盖任何现有的同名全局变量。

此外，全局变量很有用，这与一些 OOP 狂热者声称的相反——尤其是对于较小的脚本，因为 OOP 是多余的。

* * *

## 回答 #6

> 赞同：63
> 
>             
> 
> 时间：2016-01-01T19:55:14.330

> # 如果我在一个函数中创建一个全局变量，如何在另一个函数中使用该变量？

我们可以使用以下函数创建一个全局变量：

```
def create_global_variable():
    global global_variable # must declare it to be a global first
    # modifications are thus reflected on the module's global scope
    global_variable = 'Foo' 
```

编写函数实际上并不运行它的代码。所以我们调用`create_global_variable`函数：

```
>>> create_global_variable() 
```

## 不加修改地使用全局变量

只要您不希望更改它指向的对象，您就可以使用它：

例如，

```
def use_global_variable():
    return global_variable + '!!!' 
```

现在我们可以使用全局变量：

```
>>> use_global_variable()
'Foo!!!' 
```

## 从函数内部修改全局变量

要将全局变量指向不同的对象，您需要再次使用 global 关键字：

```
def change_global_variable():
    global global_variable
    global_variable = 'Bar' 
```

请注意，编写此函数后，实际更改它的代码仍未运行：

```
>>> use_global_variable()
'Foo!!!' 
```

所以调用函数后：

```
>>> change_global_variable() 
```

我们可以看到全局变量已经改变了。该`global_variable`名称现在指向`'Bar'`：

```
>>> use_global_variable()
'Bar!!!' 
```

请注意，Python 中的“全局”并不是真正的全局——它只是模块级别的全局。所以它只适用于在它是全局的模块中编写的函数。函数会记住编写它们的模块，因此当它们被导出到其他模块时，它们仍然会在创建它们的模块中查找全局变量。

# 同名的局部变量

如果你创建一个同名的局部变量，它会覆盖一个全局变量：

```
def use_local_with_same_name_as_global():
    # bad name for a local variable, though.
    global_variable = 'Baz' 
    return global_variable + '!!!'

>>> use_local_with_same_name_as_global()
'Baz!!!' 
```

但是使用那个错误命名的局部变量并不会改变全局变量：

```
>>> use_global_variable()
'Bar!!!' 
```

请注意，您应该避免使用与全局变量同名的局部变量，除非您确切地知道自己在做什么并且有充分的理由这样做。我还没有遇到过这样的原因。

## 我们在类中得到相同的行为

后续评论询问：

> 如果我想在一个类的函数内创建一个全局变量，并想在另一个类的另一个函数内使用该变量，该怎么办？

在这里，我演示了我们在方法中获得与在常规函数中相同的行为：

```
class Foo:
    def foo(self):
        global global_variable
        global_variable = 'Foo'

class Bar:
    def bar(self):
        return global_variable + '!!!'

Foo().foo() 
```

现在：

```
>>> Bar().bar()
'Foo!!!' 
```

但我建议不要使用全局变量，而是使用类属性，以避免混淆模块命名空间。另请注意，我们在这里不使用`self`参数 - 这些可能是类方法（如果从通常的`cls`参数中改变类属性，则很方便）或静态方法（no`self`或`cls`）。

* * *

## 回答 #7

> 赞同：53
> 
>             
> 
> 时间：2014-07-04T10:23:56.797

除了已经存在的答案并使这更加混乱：

> 在 Python 中，仅在函数内部引用的变量是
>   **隐式全局**的。如果一个变量在函数体中的任何地方都被赋予了一个新值，那么它被假定为一个**local**。如果一个变量在函数内部被赋予了一个新值，那么该变量是隐式本地的，您需要将其显式声明为“全局”。
> 
>   
>   
> 
> 虽然起初有点令人惊讶，但片刻的考虑解释了这一点。一方面，对已分配的变量要求全局性提供了防止意外副作用的障碍。另一方面，如果所有全局引用都需要全局，那么您将一直使用全局。您必须将对内置函数或导入模块组件的每个引用声明为全局。这种混乱会破坏全局声明识别副作用的有用性。

资料来源：*[Python中局部变量和全局变量的规则是什么？](https://docs.python.org/2/faq/programming.html#what-are-the-rules-for-local-and-global-variables-in-python)*.

* * *

## 回答 #8

> 赞同：39
> 
>             
> 
> 时间：2013-10-03T05:41:16.520

通过并行执行，如果您不了解正在发生的事情，全局变量可能会导致意外结果。这是在多处理中使用全局变量的示例。我们可以清楚地看到每个进程都使用自己的变量副本：

```
import multiprocessing
import os
import random
import sys
import time

def worker(new_value):
    old_value = get_value()
    set_value(random.randint(1, 99))
    print('pid=[{pid}] '
          'old_value=[{old_value:2}] '
          'new_value=[{new_value:2}] '
          'get_value=[{get_value:2}]'.format(
          pid=str(os.getpid()),
          old_value=old_value,
          new_value=new_value,
          get_value=get_value()))

def get_value():
    global global_variable
    return global_variable

def set_value(new_value):
    global global_variable
    global_variable = new_value

global_variable = -1

print('before set_value(), get_value() = [%s]' % get_value())
set_value(new_value=-2)
print('after  set_value(), get_value() = [%s]' % get_value())

processPool = multiprocessing.Pool(processes=5)
processPool.map(func=worker, iterable=range(15)) 
```

**输出：**

```
before set_value(), get_value() = [-1]
after  set_value(), get_value() = [-2]
pid=[53970] old_value=[-2] new_value=[ 0] get_value=[23]
pid=[53971] old_value=[-2] new_value=[ 1] get_value=[42]
pid=[53970] old_value=[23] new_value=[ 4] get_value=[50]
pid=[53970] old_value=[50] new_value=[ 6] get_value=[14]
pid=[53971] old_value=[42] new_value=[ 5] get_value=[31]
pid=[53972] old_value=[-2] new_value=[ 2] get_value=[44]
pid=[53973] old_value=[-2] new_value=[ 3] get_value=[94]
pid=[53970] old_value=[14] new_value=[ 7] get_value=[21]
pid=[53971] old_value=[31] new_value=[ 8] get_value=[34]
pid=[53972] old_value=[44] new_value=[ 9] get_value=[59]
pid=[53973] old_value=[94] new_value=[10] get_value=[87]
pid=[53970] old_value=[21] new_value=[11] get_value=[21]
pid=[53971] old_value=[34] new_value=[12] get_value=[82]
pid=[53972] old_value=[59] new_value=[13] get_value=[ 4]
pid=[53973] old_value=[87] new_value=[14] get_value=[70] 
```

* * *

## 回答 #9

> 赞同：32
> 
>             
> 
> 时间：2013-10-13T16:07:41.167

事实证明，答案总是很简单。

这是一个小示例模块，它以一种简单的方式在`main`定义中显示：

```
def five(enterAnumber,sumation):
    global helper
    helper  = enterAnumber + sumation

def isTheNumber():
    return helper 
```

以下是如何在`main`定义中显示它：

```
import TestPy

def main():
    atest  = TestPy
    atest.five(5,8)
    print(atest.isTheNumber())

if __name__ == '__main__':
    main() 
```

这个简单的代码就是这样工作的，它会执行。我希望它有所帮助。

* * *

## 回答 #10

> 赞同：31
> 
>             
> 
> 时间：2014-12-04T06:27:43.313

你说的是使用这样的方法：

```
globvar = 5

def f():
    var = globvar
    print(var)

f()  # Prints 5 
```

但更好的方法是像这样使用全局变量：

```
globvar = 5
def f():
    global globvar
    print(globvar)
f()   #prints 5 
```

两者都给出相同的输出。

* * *

## 回答 #11

> 赞同：28
> 
>             
> 
> 时间：2014-12-20T12:45:26.753

您需要在要使用的每个函数中引用全局变量。

如下：

```
var = "test"

def printGlobalText():
    global var #wWe are telling to explicitly use the global version
    var = "global from printGlobalText fun."
    print "var from printGlobalText: " + var

def printLocalText():
    #We are NOT telling to explicitly use the global version, so we are creating a local variable
    var = "local version from printLocalText fun"
    print "var from printLocalText: " + var

printGlobalText()
printLocalText()
"""
Output Result:
var from printGlobalText: global from printGlobalText fun.
var from printLocalText: local version from printLocalText
[Finished in 0.1s]
""" 
```

* * *

## 回答 #12

> 赞同：28
> 
>             
> 
> 时间：2015-02-04T19:19:54.993

试试这个：

```
def x1():
    global x
    x += 1
    print('x1: ', x)

def x2():
    global x
    x = x+1
    print('x2: ', x)

x = 5
print('x:  ', x)
x1()
x2()

# Output:
# x:   5
# x1:  6
# x2:  7 
```

* * *

## 回答 #13

> 赞同：26
> 
>             
> 
> 时间：2009-01-09T11:56:19.457

您实际上并没有将全局存储在局部变量中，只是创建对原始全局引用所引用的同一对象的局部引用。请记住，Python 中的几乎所有内容都是引用对象的名称，在通常的操作中不会复制任何内容。

如果您不必显式指定标识符何时引用预定义的全局变量，那么您可能必须显式指定标识符何时是新的局部变量（例如，使用类似 'var' 命令见于 JavaScript）。由于在任何严肃和重要的系统中，局部变量比全局变量更常见，因此 Python 的系统在大多数情况下更有意义。

您*可以*使用一种尝试猜测的语言，如果存在则使用全局变量，如果不存在则创建局部变量。但是，这将非常容易出错。例如，导入另一个模块可能会无意中引入该名称的全局变量，从而改变程序的行为。

* * *

## 回答 #14

> 赞同：21
> 
>             
> 
> 时间：2017-04-07T18:52:13.683

如果您有一个同名的局部变量，您可能需要使用该[`globals()`函数](https://docs.python.org/3/library/functions.html#globals)。

```
globals()['your_global_var'] = 42 
```

* * *

## 回答 #15

> 赞同：18
> 
>             
> 
> 时间：2015-10-24T15:46:18.373

接下来并作为附加组件，使用一个文件来包含所有在本地声明的全局变量，然后`import as`：

文件*initval.py*：

```
Stocksin = 300
Prices = [] 
```

文件*getstocks.py*：

```
import initval as iv

def getmystocks(): 
    iv.Stocksin = getstockcount()

def getmycharts():
    for ic in range(iv.Stocksin): 
```

* * *

## 回答 #16

> 赞同：16
> 
>             
> 
> 时间：2016-01-07T20:41:19.263

写入全局数组的显式元素显然不需要全局声明，尽管写入“批发”确实有这个要求：

```
import numpy as np

hostValue = 3.14159
hostArray = np.array([2., 3.])
hostMatrix = np.array([[1.0, 0.0],[ 0.0, 1.0]])

def func1():
    global hostValue    # mandatory, else local.
    hostValue = 2.0

def func2():
    global hostValue    # mandatory, else UnboundLocalError.
    hostValue += 1.0

def func3():
    global hostArray    # mandatory, else local.
    hostArray = np.array([14., 15.])

def func4():            # no need for globals
    hostArray[0] = 123.4

def func5():            # no need for globals
    hostArray[1] += 1.0

def func6():            # no need for globals
    hostMatrix[1][1] = 12.

def func7():            # no need for globals
    hostMatrix[0][0] += 0.33

func1()
print "After func1(), hostValue = ", hostValue
func2()
print "After func2(), hostValue = ", hostValue
func3()
print "After func3(), hostArray = ", hostArray
func4()
print "After func4(), hostArray = ", hostArray
func5()
print "After func5(), hostArray = ", hostArray
func6()
print "After func6(), hostMatrix = \n", hostMatrix
func7()
print "After func7(), hostMatrix = \n", hostMatrix 
```

* * *

## 回答 #17

> 赞同：8
> 
>             
> 
> 时间：2017-09-05T14:59:14.357

我正在添加这个，因为我在其他任何答案中都没有看到它，它可能对那些在类似问题上苦苦挣扎的人有用。该[`globals()`](https://docs.python.org/library/functions.html#globals)函数返回一个可变的全局符号字典，您可以在其中“神奇地”使数据可用于其余代码。例如：

```
from pickle import load
def loaditem(name):
    with open(r"C:\pickle\file\location"+"\{}.dat".format(name), "rb") as openfile:
        globals()[name] = load(openfile)
    return True 
```

和

```
from pickle import dump
def dumpfile(name):
    with open(name+".dat", "wb") as outfile:
        dump(globals()[name], outfile)
    return True 
```

只会让您将变量转储/加载到全局命名空间中。超级方便，没有麻烦，没有大惊小怪。很确定它只是 Python 3。

* * *

## 回答 #18

> 赞同：7
> 
>             
> 
> 时间：2017-08-19T08:48:27.627

引用要显示更改的类名称空间。  

在此示例中，runner 使用文件配置中的**max**。我希望我的测试在跑步者使用它时改变**max的值。**

**主/config.py**

```
max = 15000 
```

**主/亚军.py**

```
from main import config
def check_threads():
    return max < thread_count 
```

**测试/runner_test.py**

```
from main import runner                # <----- 1\. add file
from main.runner import check_threads
class RunnerTest(unittest):
   def test_threads(self):
       runner.max = 0                  # <----- 2\. set global 
       check_threads() 
```

* * *

## 回答 #19

> 赞同：5
> 
>             
> 
> 时间：2020-05-24T21:41:53.260

## 全局变量很好——除了多处理

与不同平台/环境上的多处理相关的全局变量，一方面是 Windows/Mac OS，另一方面是 Linux，这很麻烦。

我将通过一个简单的示例向您展示这一点，指出我前段时间遇到的一个问题。

如果您想了解，为什么 Windows/MacO 和 Linux 上的情况有所不同，您需要知道，启动新进程的默认机制...

*   Windows/MacOs 是“衍生”

*   Linux 是“分叉”

它们在内存分配和初始化方面是不同的......（但我在这里不讨论）。

让我们看一下问题/示例...

```
import multiprocessing

counter = 0

def do(task_id):
    global counter
    counter +=1
    print(f'task {task_id}: counter = {counter}')

if __name__ == '__main__':

    pool = multiprocessing.Pool(processes=4)
    task_ids = list(range(4))
    pool.map(do, task_ids) 
```

### 视窗

如果你在 Windows 上运行它（我想也在 MacOS 上），你会得到以下输出......

```
task 0: counter = 1
task 1: counter = 2
task 2: counter = 3
task 3: counter = 4 
```

### Linux

如果你在 Linux 上运行它，你会得到以下结果。

```
task 0: counter = 1
task 1: counter = 1
task 2: counter = 1
task 3: counter = 1 
```

* * *

## 回答 #20

> 赞同：5
> 
>             
> 
> 时间：2020-08-28T07:53:58.057

有两种方法可以将变量声明为全局变量：

**1.在函数内部分配变量并使用全局行**

```
def declare_a_global_variable():
    global global_variable_1
    global_variable_1 = 1

# Note to use the function to global variables
declare_a_global_variable() 
```

**2\. 分配变量外部函数：**

```
global_variable_2 = 2 
```

现在我们可以在其他函数中使用这些声明的全局变量：

```
def declare_a_global_variable():
    global global_variable_1
    global_variable_1 = 1

# Note to use the function to global variables
declare_a_global_variable() 
global_variable_2 = 2

def print_variables():
    print(global_variable_1)
    print(global_variable_2)
print_variables() # prints 1 & 2 
```

**注1：**

如果您想在另一个函数中更改全局变量，例如`update_variables()`您应该在分配变量之前在该函数中使用全局行：

```
global_variable_1 = 1
global_variable_2 = 2

def update_variables():
    global global_variable_1
    global_variable_1 = 11
    global_variable_2 = 12 # will update just locally for this function

update_variables()
print(global_variable_1) # prints 11
print(global_variable_2) # prints 2 
```

**笔记2：**

列表和字典变量的注释 1 有一个例外，但在函数内不使用全局行：

```
# declaring some global variables
variable = 'peter'
list_variable_1 = ['a','b']
list_variable_2 = ['c','d']

def update_global_variables():
    """without using global line"""
    variable = 'PETER' # won't update in global scope
    list_variable_1 = ['A','B'] # won't update in global scope
    list_variable_2[0] = 'C' # updated in global scope surprisingly this way
    list_variable_2[1] = 'D' # updated in global scope surprisingly this way

update_global_variables()

print('variable is: %s'%variable) # prints peter
print('list_variable_1 is: %s'%list_variable_1) # prints ['a', 'b']
print('list_variable_2 is: %s'%list_variable_2) # prints ['C', 'D'] 
```

* * *

## 回答 #21

> 赞同：3
> 
>             
> 
> 时间：2021-04-30T19:06:10.893

虽然这已经得到解答，但我再次给出解决方案，因为我更喜欢单行这是如果您希望在函数中创建全局变量

```
def someFunc():
    x=20
    globals()['y']=50
someFunc() # invoking function so that variable Y is created globally 
print(y) # output 50
print(x) #NameError: name 'x' is not defined as x was defined locally within function 
```

* * *

## 回答 #22

> 赞同：2
> 
>             
> 
> 时间：2022-02-11T03:08:04.123

像这样的代码：

```
myVar = 12

def myFunc():
  myVar += 12 
```

**钥匙：**

如果你在字符串之外声明一个变量，它就会变成全局变量。

如果你在字符串中声明一个变量，它就会变成本地的。

如果要在字符串中声明全局变量，请在要声明的变量`global`之前使用关键字：

```
myVar = 124
def myFunc():
  global myVar2
  myVar2 = 100
myFunc()
print(myVar2) 
```

然后文档中有 100 个。

# visual-studio-2008 - CC.Net + VS 2008

> ID：423382
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-08T05:46:33.813
> 
>         
> 
> 标签：visual-studio-2008

我是 CC.Net 的新手。我想将我的 VS 2008 项目与 CC.Net 集成。我正在使用 VSS。MSBuild 或 NAnt 是否需要集成？

谁能告诉我将 CC.Net 与 VSS 集成以构建我的 Visual Studio 2008 项目的简单步骤。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T10:34:20.220

MSBuild 和 Nant 都不是必需的 - 两者都是可选的助手。

如果您在构建机器上安装了 Visual Studio，您可以让 ccnet 直接构建您的 VS 2008 项目/解决方案。

使用 VisualStudio 或 Executable 任务，请参阅：[任务](http://confluence.public.thoughtworks.org/display/CCNET/Task+Blocks)

如果您的代码是完全托管的，您可以使用 msbuild 来避免在您的构建机器上安装 Visual Studio。

您还需要一个源代码控制块和一个发布块——一般来说，[ccnet](http://confluence.public.thoughtworks.org/display/CCNET/Configuring+the+Server)上的文档非常好。

# windows - 用于确定 Service Pack 版本的 Windows API

> ID：423391
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T05:53:09.603
> 
>         
> 
> 标签：windows, windows-vista, service, pack

我们正在为 Vista 开发设备驱动程序。SPO 中有一个已知错误（已在 SP1 中修复）。我们有一个仅适用于 SP0 的解决方法（并破坏了 SP1 中的行为）。

是否有 Windows API 或其他方式来判断已安装的 Service Pack 版本？（以编程方式）。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T06:05:32.230

您可能需要函数[GetVersionEx ，特别是相关](http://msdn.microsoft.com/en-us/library/ms724451(VS.85).aspx)[OSVERSIONINFOEX](http://msdn.microsoft.com/en-us/library/ms724833(VS.85).aspx)结构的 wServicePackMajor 和 wServicePackMinor 成员。

我假设您是在驱动程序内部执行此操作，而不是从 Web 应用程序或给定 asp.net 标记的东西。

# asp.net - ASP.Net 应用程序的最佳菜单是什么？

> ID：423393
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-08T05:55:37.710
> 
>         
> 
> 标签：asp.net, javascript, html, asp.net-2.0

您发现什么可以为 ASP.Net 2.0 - 3.5 Web 应用程序提供最佳菜单？建议不必特别是 ASP.Net 控件，但可以是在 ASP.Net Web 应用程序中运行良好的其他菜单。

我希望这些建议是不需要购买或特许权使用费的选项。开源建议会更好。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T12:54:26.880

我发现最灵活的方法是使用 CSS 设置无序列表的样式，如下所示：

```
<div id="nav_main" >
<ul>
  <li id="current">Button 1</li>
  <li><a href="#">Button 2</a></li>
  <li><a href="#">Button 3</a></li>
  <li><a href="#">Button 4</a></li>
  <li><a href="#">Button 5</a></li>
</ul>
</div> 
```

您会发现许多 CSS 方法来使用悬停背景图像等设置此类列表的样式。

现在，如果您正在使用 Webforms 并且想要使用站点地图，那么我建议您使用中继器而不是使用菜单控件。通过这种方式，您可以最大程度地控制生成列表。

同样，如果您使用的是 ASP.NET MVC，则可以在站点地图上执行 foreach 以创建列表。

这当然只适用于简单的菜单，但它可以扩展到包括更复杂的菜单。我发现以下 CSS 样式的菜单非常好：[http ://www.lwis.net/free-css-drop-down-menu/](http://www.lwis.net/free-css-drop-down-menu/)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T13:01:07.413

YUI 按钮或菜单控件（适用于现有 HTML）：

[http://developer.yahoo.com/yui/examples/button/btn_example07.html](http://developer.yahoo.com/yui/examples/button/btn_example07.html)

一个很好地包装了这些控件的 ASP.NET 库，于 2008 年 12 月发布：

[http://www.codeplex.com/YUIAspNet/](http://www.codeplex.com/YUIAspNet/)

JQuery Suckerfish 菜单，使用 ul,li 元素工作：

[http://be.twixt.us/jquery/suckerFish.php](http://be.twixt.us/jquery/suckerFish.php)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T14:40:45.670

我使用 jQuery Superfish：[http](http://users.tpg.com.au/j_birch/plugins/superfish/) ://users.tpg.com.au/j_birch/plugins/superfish/ 。[其他人](http://encosia.com/2008/10/19/7-of-my-favorite-jquery-plugins-for-use-with-aspnet/)也强烈推荐。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T15:06:26.787

我也喜欢创建无序列表。它让设计师可以灵活地使用菜单。他们可以使用自己的 js+css 解决方案来创建下拉菜单或为静态菜单设置漂亮的样式。相同的 html 可以很容易地变成左手、顶部、下拉，甚至是带有 css 更改的完整站点地图。

需要注意的是，我喜欢将站点地图数据存储在分层数据结构中，并使用递归 lambda 来生成它。例如，请参阅下面的这个小型控制台应用程序及其输出。

输出html

```
<li><a href="/">First</a><li><a href="/firstsub.aspx">FirstSub</a></li><li><a hr
ef="/secondsub.aspx">SecondSub</a></li></li><li><a href="/second.aspx">Second</a
></li> 
```

源代码c#

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace SiteMapDemo
{
    class MenuItem
    {
        public Guid ID {get; set;}
        public Guid? ParentID{get;set;}
        public string Name { get; set; }
        public string Path { get; set; }
        public int Rank { get; set; }
    }
    class Program
    {
        static void Main(string[] args)
        {
            List<MenuItem> menu = new List<MenuItem>(new[]{
                new MenuItem{ID = Guid.NewGuid(), Name = "First", ParentID=null, Path="/", Rank=0},
                new MenuItem{ID = Guid.NewGuid(), Name = "Second", ParentID=null, Path="/second.aspx",Rank=1},
            });
            menu.AddRange(new[] { 
                new MenuItem{ID = Guid.NewGuid(), Name = "FirstSub", ParentID=menu[0].ID, Path="/firstsub.aspx",Rank=0},
                new MenuItem{ID = Guid.NewGuid(), Name = "SecondSub", ParentID=menu[0].ID, Path="/secondsub.aspx",Rank=1},
                });
            Func<List<MenuItem>, Guid?, string> renderMenu = null;
            renderMenu = (menus, Parent) =>
            {
                var sub = menus.Where(m => m.ParentID == Parent).OrderBy(s=>s.Rank).ToList();
                if (sub.Count > 0)
                {
                    StringBuilder sb = new StringBuilder();
                    sub.ForEach(s => { sb.Append(String.Format("<li><a href=\"{0}\">{1}</a>{2}</li>", s.Path, s.Name, renderMenu(menus, s.ID))); });
                    return sb.ToString();
                }
                return "";
            };
            Console.Write(renderMenu(menu, null));
            Console.ReadLine();
        }
    }
} 
```

# file - Using DOS Prompt and via' FTP copying files on to the server

> ID：423398
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T05:57:13.900
> 
>         
> 
> 标签：file, ftp, size

I would like when we Copy files on to the server via FTP the size of the file changes. What is the reason behind this. Does the change in the file size can make the files corrupt and the FTP process Fails ? 

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-01-08T06:00:24.517

Most likely, you are copying between Windows and Unix, and the difference in size is due to the difference between CRLF and just LF for line endings.

If it is crucial to preserve the line endings, use BIN (binary) mode to transfer the data.  The alternative is ASC (ASCII) mode, where the systems map line endings.

# python - long double 返回和 ctypes

> ID：423404
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-01-08T06:00:48.260
> 
>         
> 
> 标签：python, ctypes

我有 ac 函数，它返回一个`long double`. 我想使用 ctypes 从 python 调用这个函数，它主要工作。设置`so.func.restype = c_longdouble`可以解决问题——除了python的浮点类型是a `c_double`，所以如果返回值大于双精度，但在长双精度范围内，python仍然将inf作为返回值。我在 64 位处理器上，`sizeof(long double)`是 16 岁。

在不修改c代码的情况下解决这个问题（例如使用十进制类或numpy）有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T06:56:41.987

我不确定您是否可以在不修改 C 代码的情况下做到这一点。ctypes 似乎对 s 的支持真的很差——你根本不能像数字一样操纵它们，你所能做的就是在原生Python 类型`long double`之间来回转换它们。`float`

您甚至不能使用字节数组而不是 a 作为返回值`c_longdouble`，因为 ABI - 浮点值`%eax`不像正常返回值那样在寄存器或堆栈中返回，它们是通过硬件传递的 -特定的浮点寄存器。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2015-03-11T18:21:36.197

如果您有一个函数返回 的*子类*，`c_longdouble`它将返回 ctypes 包装的字段对象，而不是转换为 python `float`。然后，您可以从中提取字节（`memcpy`例如，使用 c_char 数组）或将对象传递给另一个 C 函数以进行进一步处理。该`snprintf`函数可以将其格式化为字符串，以便打印或转换为高精度python数字类型。

```
import ctypes
libc = ctypes.cdll['libc.so.6']
libm = ctypes.cdll['libm.so.6']

class my_longdouble(ctypes.c_longdouble):
    def __str__(self):
        size = 100
        buf = (ctypes.c_char * size)()
        libc.snprintf(buf, size, '%.35Le', self)
        return buf[:].rstrip('\0')

powl = libm.powl
powl.restype = my_longdouble
powl.argtypes = [ctypes.c_longdouble, ctypes.c_longdouble]

for i in range(1020,1030):
    res = powl(2,i)
    print '2**'+str(i), '=', str(res) 
```

输出：

```
2**1020 = 1.12355820928894744233081574424314046e+307
2**1021 = 2.24711641857789488466163148848628092e+307
2**1022 = 4.49423283715578976932326297697256183e+307
2**1023 = 8.98846567431157953864652595394512367e+307
2**1024 = 1.79769313486231590772930519078902473e+308
2**1025 = 3.59538626972463181545861038157804947e+308
2**1026 = 7.19077253944926363091722076315609893e+308
2**1027 = 1.43815450788985272618344415263121979e+309
2**1028 = 2.87630901577970545236688830526243957e+309
2**1029 = 5.75261803155941090473377661052487915e+309 
```

（请注意，我对 35 位精度的估计结果对于`long double`英特尔处理器上的计算过于乐观，因为英特尔处理器只有 64 位尾数。如果您打算转换为`%a`不基于十进制表示。）`%e``f``g`

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T07:08:54.100

如果您需要高精度浮点，请查看 GMPY。

[GMPY](http://code.google.com/p/gmpy/)是一个 C 编码的 Python 扩展模块，它包装了 GMP 库，为 Python 代码提供快速多精度算术（整数、有理数和浮点数）、随机数生成、高级数论函数等。

[GMP](http://gmplib.org/#FUNCCLASSES)包含高级浮点算术函数 ( `mpf`)。如果 C 类型 `double' 没有为应用程序提供足够的精度，这是 GMP 函数类别。此类别中大约有 65 个函数。

# tfs - Source Control Explorer Shows Pending Changes, But In Pending Changes Window does not show

> ID：423423
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T06:14:02.180
> 
>         
> 
> 标签：tfs

In TFS Source Control Explorer it shows pending changes (edit,[more]) with my name, but the Pending Changes window does not show any pending changes.

What I thought is, months ago my Visual Studio crashed, and at that time some files were checked out (which I was not aware of, due to the automatic checkout nature of TFS). Due to that, I copied a new VMImage, without undoing the pending changes (which are currently showing in Source Control Explorer). 

One of my team members wants to checkin a new version of that particular file. Now, I need to undo my pending changes.

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-01-08T06:30:39.527

It sounds like you have them checked out under a different workspace.  Try going to View->Other Windows->Source Control Explorer, then open the Workspace dropdown near the top of the screen, and select "Workspaces..."

I would suggest simply deleting any extra workspaces shown.

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2013-02-14T16:04:55.470

**重现步骤：**

1.  对 TFS 中的文件进行非冲突编辑。

2.  从源代码管理中获取最新版本的项目。

3.  有时，挂起的更改将被标记为非挂起并保存所有项目文件，从而导致团队资源管理器中没有挂起的更改。

**解决方法：**

1.  右键单击源代码资源管理器中的解决方案文件夹

2.  选择“比较”

3.  在搜索结果中，手动打开已编辑/添加的文件并保存。这会将它们注册为团队资源管理器中的“待更改”。

这是因为 TFS 显然使用文件属性而不是实际的文本比较来注册 Visual Studio 中的挂起更改。

测试环境：Windows 7、Visual Studio Ultimate 2012。

**我的主管的其他反馈：**   “不确定这次是否是问题，但是当您从 TFS 服务器断开连接时可能会发生这种情况（有时会在不明显的情况下发生）。文件 | 源代码控制 | 上线通常会修复它（并且如果您在线，则该选项不可用）。”

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2010-09-09T03:32:10.000

TFS 到处都是错误的。我认为您需要检查父文件夹并使用 TFS 电动玩具撤消所有未更改的垃圾项目。TFS 使用文件属性来指示文件是否有更改，这最糟糕，并产生大量可用性问题。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2011-09-01T13:32:46.060

如果您签出的文件不是当前解决方案的一部分，它可能会被“待更改”窗口上的“按解决方案筛选”工具栏按钮隐藏。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2013-11-18T11:50:58.740

让您更改的文件**签出以进行编辑**

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2013-12-09T21:42:41.353

我遇到了类似的问题，这是由于我的本地版本出于某种原因是“非版本控制解决方案”！这意味着我的本地并没有真正连接到 tfs 上的实际源代码。

修复：检查了覆盖选项的最新版本。我知道如果您对本地进行了很多更改，这可能会很痛苦。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2012-08-10T15:04:30.787

您是否尝试从源代码管理资源管理器视图中签出文件？

对我来说，它奏效了。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2010-02-03T10:47:26.580

我已经看到了这个问题。有时，当我在“平面显示模式”中有待处理的更改窗口时，它不会显示我的更改。我发现如果我单击带有工具提示“更改到文件夹视图”的待处理更改窗口顶部的工具栏图标，它们就会显示出来。我认为这是 Team Explorer Client 中的一个错误。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2012-06-19T18:52:06.653

我遇到了同样的问题，我重新启动了 VS，打开了解决方案，所有更改现在都显示在挂起的更改窗口中。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2013-07-16T09:37:41.210

我刚刚在**VS2012**中遇到了类似的问题。  

为了解决这个问题，我将“显示 xxx”下拉菜单切换为“显示解决方案更改”，然后返回“显示全部”。列表中丢失的文件随后重新出现。

![在此处输入图像描述](https://i.stack.imgur.com/5Ie3o.png)

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2014-09-30T15:39:11.387

*   同一台机器上的不同工作区

*   另一台机器上的不同工作区

*   TeamExplorer -> PendingChanges -> Excluded Changes （我包括这个只是因为你没有特别提到他们不在那里）

    *   特别是如果您右键单击解决方案资源管理器中的节点并选择签入

*   根据 TeamExplorer 设置过滤[@Oliver](https://stackoverflow.com/a/17673026/57883)

*   使用 Tfs 查询来查找挂起的更改以及它们挂起的工作区。

另一种选择是永久或临时授予他们覆盖您的锁的权限。然后他无论如何都可以签到。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2014-04-01T16:47:44.380

我面临同样的问题，第一个答案真的很有帮助。但如果您在不同的计算机上工作，请务必选中“显示远程工作区”。在我的情况下，文件是从家用计算机签入和编辑的，它显示了待处理的更改。删除不需要的工作区有助于解决此问题。

* * *

## 回答 #13

> 赞同：-1
> 
>             
> 
> 时间：2015-05-18T18:26:15.097

有时我不能锁定一个分支，因为用户已经检查了一些东西，但是当我向他们询问它时，挂起的合并/更改，只有文件夹没有要更改的对象。那是怎么回事？

# c# - How To Change Schema of DataSet at Runtime C# ASP.Net

> ID：423434
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T06:27:02.700
> 
>         
> 
> 标签：c#, asp.net, dataset

I would like to know how to change the schema of DataSet at Runtime

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T07:45:22.527

它是类型化的还是非类型化的`DataSet`？对于打字，这可能不是一个好主意。但对于无类型，只需操作`Columns`表上的 etc，或添加/删除表/关联。有没有什么特别痛苦的事情？还是您的意思是*适配器*的架构？

就个人而言，我很少使用`DataSet`，更喜欢实体的标准 POCO 类（可能使用 ORM，如 LINQ-to-SQL/Entity Framework/NHibernate）。但是有些人喜欢他们...

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-09-16T20:21:13.460

我们遇到了类似的问题。这就是我们所做的。数据库服务器以 GMT 存储时间。并且，Web 服务返回所有 GMT 时间。因此，在 C# 中，我们将时区设置为 UTC 并使用本地化显示。

```
 DataSet newDset = srcTable.Clone();
        DataTable dTable = newDset.Tables[0];

        for (int j = 0; j < dTable.Columns.Count; j++)
        {
            if (dTable.Columns[j].DataType.ToString() == "System.DateTime")
            {
                dTable.Columns[j].DateTimeMode = DataSetDateTime.Utc;
            }
        } 
```

# python - 如何在 Django 中保存内联表单集模型？

> ID：423437
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T06:28:41.217
> 
>         
> 
> 标签：python, django, django-forms

Formsets 有一个 .save() 方法，[文档](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#using-an-inline-formset-in-a-view)说要保存在这样的视图中：

```
if request.method == "POST":
    formset = BookInlineFormSet(request.POST, request.FILES, instance=author)
    if formset.is_valid():
        formset.save()
        # Do something.
else:
    formset = BookInlineFormSet(instance=author) 
```

我正在关注这一点，它在创建父级时有效，但是在保存现有模型时，我在 Django 中遇到异常。父级实际上是保存到数据库中的，保存相关模型时发生异常。

```
KeyError at /bcdetails/NewProds/1/

None

Request Method:     POST
Request URL:    http://rdif.local/bcdetails/NewProds/1/
Exception Type:     KeyError
Exception Value:    

None

Exception Location:     /usr/lib/python2.5/site-packages/django/forms/models.py in save_existing_objects, line 403
Python Executable:  /usr/bin/python
Python Version:     2.5.2
Python Path:    ['/usr/lib/python2.5/site-packages/paramiko-1.7.4-py2.5.egg', '/usr/lib/python2.5/site-packages/Fabric-0.0.9-py2.5.egg', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/PIL', '/usr/lib/python2.5/site-packages/gst-0.10', '/var/lib/python-support/python2.5', '/usr/lib/python2.5/site-packages/gtk-2.0', '/var/lib/python-support/python2.5/gtk-2.0', '/usr/lib/site-python', '/home/www/rdif.com/test/']
Server time:    Wed, 7 Jan 2009 23:18:19 -0700 
```

我在 Django 源代码中花了一些时间，但在那里找不到任何东西。我是否需要遍历每个表单集并仅保存已更改的模型？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T10:27:55.740

我发现了我的问题，这很尴尬。

在 Meta 类中的父模型表单`exclude = ('...',)`中，其中一个被排除的字段对于 inline_formsets 中的关系至关重要。因此，我删除了排除项并忽略了模板中的那些字段。

# c# - 什么是支持 LINQ 的优秀“移动”.NET 数据库？

> ID：423452
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-01-08T06:40:12.283
> 
>         
> 
> 标签：c#, .net, linq, embedded-database

我正在重构应用程序，我决定使用移动/嵌入式数据库。

我一直在阅读有关 SQL Server Compact Edition 的信息，但我想知道你们中是否有人知道任何其他可以使用且下载量不大的数据库，因为我当前的应用程序约为 2MB（安装程序）。SQLite 会很好，但 AFAIK LINQ-to-SQLite 的 GSoC 实现目前相当有问题。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-01-08T09:20:11.010

我曾经试用过 db40（不是精简版）——它是一个对象数据库。但是，根据您的需要，使用它可能会相当舒适。他们指出，即使是精简版，他们也支持 linq：
 [http ://www.db4o.com/s/compactframeworkdb.aspx](http://www.db4o.com/s/compactframeworkdb.aspx)

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-01-08T06:44:46.177

[VistaDB](http://www.vistadb.net/)和（如您所述）[Sql Server Compact Edition](http://www.microsoft.com/Sqlserver/2005/en/us/compact-downloads.aspx)是嵌入式数据库的两个小选项。Sql Server Compact Edition 可以与 Linq to SQL 或实体框架一起使用。我相信 VistaDB 可以与实体框架一起使用。

此外，如果您不需要关系数据库，您可能需要考虑[db4o](http://www.db4o.com/)。[Rob Conery在这里](http://blog.wekeroad.com/blog/crazy-talk-reducing-orm-friction/)写到了这个。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T06:52:13.803

我自己没有用过，但你可能想看看[BlackFish](http://www.codegear.com/products/blackfish)。我不确定它是否支持 Linq，但 Delphi 支持 Linq，所以它可能。另一个可能是[Embedded Firebird](http://www.firebirdsql.org/dotnetfirebird/blog/2005/02/embedded-firebird-and-microsoft-sql.html) - 再次，不确定 Linq 方面的事情。

# .net - AccessViolationException on OdbcDataReader.Dispose()

> ID：423458
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-08T06:42:59.360
> 
>         
> 
> 标签：.net, access-violation

I am getting this exception when disposing an OdbcDataReader just after retrieving data from the database. The reader is actually disposed while leaving a Using block. This should not be causing any errors as far as I know. Any ideas?

```
System.AccessViolationException: Attempted to read or write protected memory. This is often an indication that other memory is corrupt.
at System.Data.Common.UnsafeNativeMethods.SQLFreeStmt(OdbcStatementHandle StatementHandle, STMT Option)
at System.Data.Odbc.CMDWrapper.FreeStatementHandle(STMT stmt)
at System.Data.Odbc.OdbcDataReader.Close(Boolean disposing)
at System.Data.Odbc.OdbcDataReader.Dispose(Boolean disposing)
at System.Data.Common.DbDataReader.Dispose()
at MyNamespace.MyClass.MyFunction() in C:\myfile.vb:line 100 
```

Thanks!

EDIT: using Sybase ASE 12.5 database

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T08:08:03.137

是否抛出异常`Dispose()`？还是在那之前？投掷是不好的做法`Dispose()`，但并非闻所未闻。有时（例如，[使用 WCF](http://marcgravell.blogspot.com/2008/11/dontdontuse-using.html)）需要吞下这些，但在这种情况下，错误听起来像是不*应该*被吞下的东西。

快速搜索[`OdbcDataReader`+`AccessViolationException`](http://www.google.com/search?q=AccessViolationException+OdbcDataReader)表明这并不少见 - 但问题中没有足够的信息（数据库？场景？）来缩小范围。就个人而言，我会首先查看一些谷歌点击...（可能由您的 rdbms 过滤）。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T08:26:34.037

可能是您正在使用的 ODBC 驱动程序中的一个错误。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T10:21:01.200

一般来说，在生命周期管理方面，托管/非托管交互可能会很麻烦。

这看起来像是 OdbcDataReader 内的 dispose 和终结器之间的竞争条件，它可能正在删除一些 dispose 也尝试清理的非托管对象。他们可能都调用 SQLFreeStmt。

使用保证来清理对象 - 但它不能保证让该对象保持活动状态。[终结器可以在最后一次调用对象的实例方法期间启动。因此终结器可以在 dispose 调用期间启动。如果这发生得足够早，就好像在 dispose 之前调用了终结器。]

如果这是真的，并且如果 OBDC 对您来说是一个黑匣子，那么您能做的最好的事情就是尝试一种解决方法。

我会尝试在使用范围结束之前的最后一行添加一个 System.GC.KeepAlive(your_DbDataReader_object) 。

有关 dispose 和 finalizers 令人头疼的完整概述，请参阅：[GC 讨论](http://www.bluebytesoftware.com/blog/CommentView,guid,88e62cdf-5919-4ac7-bc33-20c06ae539ae.aspx)
这是一个非常详细的讨论。

# c# - 创建可重用 cms 模块 (C#)

> ID：423459
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T06:43:27.737
> 
>         
> 
> 标签：c#, asp.net

是否有任何包含创建自包含、可重用模块的信息的资源？

我需要创建可以快速轻松地放入项目的模块。一个例子是一个新闻模块，它将包含一个管理区域、新闻列表页面、它支持`CSS`&`JavaScript`等。

我是在抽烟还是这甚至可能？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T08:16:03.433

您的应用程序需要插件。

我有一个[插件库](http://www.thealphasite.org/es/c/librerias/monet_plugins_library)（开发中和西班牙语），您可以将其用作示例或起点。我不知道谷歌翻译会有多好，但您可以在[http://translate.google.com/translate?hl=es&ie=UTF-8&u=http://www.thealphasite.org/中查看 C# 插件教程es/sistema_de_plugins_con_c_y_net&sl=es&tl=en](http://translate.google.com/translate?hl=es&ie=UTF-8&u=http://www.thealphasite.org/es/sistema_de_plugins_con_c_y_net&sl=es&tl=en)

插件允许您将 :P 功能插入到您的应用程序中，并且通过适当的设计，它将允许您将功能从一个应用程序动态地移动到另一个应用程序。

无论如何，插件只是提供了易用性，但需要一个专门考虑他们的设计。另一方面，基本的“拿这个模块在另一个项目中使用”只是适当的封装和良好的设计。如果一个模块设计得很好，它应该能够毫不费力地移植到另一个站点或应用程序。

请记住，特别是对于 Web，“主题化”是一个复杂的主题，也就是说，使您的插件适应特定 Web 的外观是另一个定制步骤，必须包含在模块本身中。[您可以在Drupal 主题函数](http://drupal.org/node/55126)和[主题 API 文档](http://api.drupal.org/api/function/theme/6)中看到一个示例。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2010-12-13T10:40:34.807

看看[www.allnewsmanager.net](http://www.allnewsmanager.net)，也许就是你要找的。它是一个可重用的模块，免费且开源。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T09:10:12.590

不确定任何资源 - 但我自己通过使用模块的用户控件组合以及将所述用户控件加载到占位符中的通用代码文件的模板系统从头开始编写 CMS。

模板系统允许您创建一个 aspx 文件，其中包含一堆占位符（根据您的需要） - 然后您需要一个数据库或类似的数据库来管理哪些控件转到哪些占位符，在什么页面上。一个模板可以处理许多页面。

下载和研究 dotnetnuke 的架构可以启发和提供构建自己方法的想法，即使它是 VB，数据结构也同样有趣。

# java - CodeBetter.com like blogs for Java

> ID：423461
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-08T06:43:58.453
> 
>         
> 
> 标签：java, resources, blogs

I'm moving from .Net to java. So i wanted to know any good community blog site like CodeBetter.com, of java developers.

EDIT: i'm looking for something more than just coding examples, like CodeBetter.com or Artima.com, which influence your thinking.

# asp.net - 什么是 ASPXAUTH cookie？

> ID：423467
> 
>         
> 
> 赞同：81
> 
>         
> 
> 时间：2009-01-08T06:49:34.667
> 
>         
> 
> 标签：asp.net, cookies, forms-authentication

在使用 ASP.Net Forms 身份验证时，我遇到了 .ASPXAUTH cookie。我有几个问题：

*   这个 cookie 的目的是什么？

*   这个 cookie 的位置是什么？

* * *

## 回答 #1

> 赞同：87
> 
>             
> 
> 时间：2009-01-08T12:20:09.993

ASPXAUTH cookie 用于确定用户是否经过身份验证。  

至于 cookie 的位置，这取决于您的浏览器。如果您使用的是 Firefox，您可以通过单击工具 -> 选项 -> 隐私来查看 cookie。然后向下滚动到域并展开它以查看 cookie 及其值。该值使用机器密钥（位于服务器的 machine.config 或 web.config 文件中）加密，因此查看客户端上的 cookie 不会真正为您提供任何信息。您可以使用以下命令解密/查看服务器端的值：

```
HttpCookie authCookie = Request.Cookies[FormsAuthentication.FormsCookieName];//.ASPXAUTH
FormsAuthenticationTicket authTicket = FormsAuthentication.Decrypt(authCookie.Value); 
```

`authTicket`这些字段在哪里：

![在此处输入图像描述](https://i.stack.imgur.com/taZIP.png)

“ASPXAUTH 基本上是用来维护 ASP.NET 会话状态”的说法是不正确的。ASP.NET 发出一个完全不同的 cookie，名为 ASP.NET_SessionId，以跟踪会话状态。

* * *

## 回答 #2

> 赞同：12
> 
>             
> 
> 时间：2010-10-03T16:16:18.587

实际上 .ASPXAUTH cookie 并不能准确地告诉您用户何时真正通过身份验证。当用户退出应用程序时，.ASPXAUTH cookie 将从浏览器中删除。但是，如果您在短时间内返回该站点（表单身份验证 cookie 超时），并使用以下内容编辑新的 ASP.NET_SessionId cookie：

*   将“名称”字段从“ASP.NET_SessionId”更改为“.ASPXAUTH”

*   将“值”从 24 字符 sessionID 更改为旧的 448 字符身份验证字符串

刷新后，您将能够假定已通过身份验证的用户的身份，而无需在技术上再次重新进行身份验证。（再次假设您在 .ASPXAUTH 加密的身份验证字符串中存储的特定超时内执行此操作）

一篇好的[博客](http://blog.securityps.com/2013/06/session-fixation-forms-authentication.html)文章更详细地解释了这个问题。一种可能的解决方案是将 .ASPXAUTH 与 ASP 会话耦合。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2013-09-23T23:19:25.173

如果用户与 HTML 登录 URL 的交互允许 TSWPPserver 建立用户的身份，远程服务器应该生成一个 cookie 来识别用户并允许对服务器进行身份验证。cookie 的内容应该被签名和加密。这个cookie的具体实现包括签名和加密算法依赖于TSWPP服务器的实现，因为只需要服务器解析cookie的内容。如果服务器实现了 cookie，那么 cookie 必须在 HTTP 有效负载中返回，其 Content-Type 为“application/x-msts-webfeed-login”。

[http://msdn.microsoft.com/en-us/library/ee920427.aspx](http://msdn.microsoft.com/en-us/library/ee920427.aspx)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2021-12-24T09:34:38.403

在 Chrome 浏览器上 1.developer tools -F12 2.locate Application tab 3.point the left pane for cookies 你会发现它是否在登录应用程序中可用会话的 ASPXAUTH cookie

# javascript - document.getElementById 在函数中失败

> ID：423469
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T06:52:30.387
> 
>         
> 
> 标签：javascript

今晚使用 document.getElementById 时我遇到了奇怪的行为。在 Firefox 3 和 Safari 中重复。

基本上，它会在 Example1 中找到 id 为“divid”的 div。但是，在 Example2 中，它始终返回 null。这里发生了什么？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<script type="text/javascript">

addelement = function(){
    alert( document.getElementById('divid') );  
}

//Example1
window.onload = function(){ alert( document.getElementById('divid') ); }
//Example2
window.onload = addelement();

</script>
<body>

    <div id="divid" class="divclass">
        <p>Test</p>
    </div>

<body>

</html> 
```

* * *

## 回答 #1

> 赞同：16
> 
>             
> 
> 时间：2009-01-08T06:56:17.523

当您编写此行时：

```
window.onload = addelement(); 
```

...您实际上并没有将**addelement**分配给 window.onload。您正在执行**addelement**，然后将结果分配给 window.onload。

将行更改为：

```
window.onload = addelement; 
```

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-01-08T07:05:42.593

cbp 已经发布了正确答案：函数“addelement()”在 javascript 中也是一个对象“addelement”。

当你说，

```
x = addelement() ; 
```

您将 addelement() 返回的值（在这种情况下，返回值为 null）分配给变量 x。

当你说，

```
x = addelement ; 
```

您将函数 addelement() 分配给变量 x。

在将 addelement 分配给 onload 事件时，您希望在事件发生时调用该函数。所以你写它时不带括号。

```
window.onload = addelement ; 
```

（只是澄清一下，因为cbp已经给出了正确的答案，但原因可能并不明显。）

# python - Python unittest with expensive setup

> ID：423483
> 
>         
> 
> 赞同：21
> 
>         
> 
> 时间：2009-01-08T07:00:36.020
> 
>         
> 
> 标签：python, unit-testing

My test file is basically:

```
class Test(unittest.TestCase):
    def testOk():
        pass

if __name__ == "__main__":
    expensiveSetup()
    try:
        unittest.main()
    finally:
        cleanUp() 
```

However, I do wish to run my test through Netbeans testing tools, and to do that I need unittests that don't rely on an environment setup done in **main**. Looking at [Caching result of setUp() using Python unittest](https://stackoverflow.com/questions/402483/caching-result-of-setup-using-python-unittest) - it recommends using Nose. However, I don't think Netbeans supports this. I didn't find any information indicating that it does. Additionally, I am the only one here actually writing tests, so I don't want to introduce additional dependencies for the other 2 developers unless they are needed.

How can I do the setup and cleanup once for all the tests in my TestSuite?

The expensive setup here is creating some files with dummy data, as well as setting up and tearing down a simple xml-rpc server. I also have 2 test classes, one testing locally and one testing all methods over xml-rpc.

* * *

## 回答 #1

> 赞同：26
> 
>             
> 
> 时间：2009-01-08T19:12:44.620

如果您使用 Python >= 2.7（或Python >= 2.4 & <= 2.6 的[unittest2](http://pypi.python.org/pypi/unittest2)），最好的方法是使用

```
def setUpClass(cls):
    # ...
setUpClass = classmethod(setUpClass) 
```

为属于给定类的所有测试执行一次初始化。

并执行清理，使用：

```
@classmethod
def tearDownClass(cls):
    # ... 
```

另请参阅[有关 setUpClass 和 tearDownClass 类方法的 unittest 标准库文档](http://docs.python.org/py3k/library/unittest.html#setupclass-and-teardownclass)。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2011-01-02T08:31:13.207

这就是我所做的：

```
class TestSearch(unittest.TestCase):
    """General Search tests for...."""

    matcher = None
    counter      = 0
    num_of_tests = None

    def setUp(self): # pylint: disable-msg=C0103 
        """Only instantiate the matcher once"""
        if self.matcher is None:
            self.__class__.matcher = Matcher()
            self.__class__.num_of_tests = len(filter(self.isTestMethod, dir(self)))
        self.__class__.counter = self.counter + 1 

    def tearDown(self): # pylint: disable-msg=C0103
        """And kill it when done"""
        if self.counter == self.num_of_tests:
            print 'KILL KILL KILL'
            del self.__class__.matcher 
```

可悲的是（因为我确实希望我的测试是独立的和确定性的），我经常这样做（因为不到 5 分钟的系统测试也很重要）。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T14:35:18.957

首先，S. Lott 说了什么。但是！，您不想这样做。每个测试都包含 setUp 和 tearDown 是有原因的：它们有助于保持测试的确定性。

否则，如果某些测试将系统置于不良状态，您的下一个测试可能会失败。理想情况下，您的每个测试都应该是独立的。

此外，如果您坚持这样做，而不是手动编写 self.runTest1()、self.runTest2()，您可能需要进行一些内省以找到要运行的方法。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-01-10T23:07:09.397

Won't package-level initialization do it for you? From the [Nose Wiki](https://nose.readthedocs.org/en/latest/writing_tests.html?highlight=setup_package):

> nose allows tests to be grouped into
>   test packages. This allows
>   package-level setup; for instance, if
>   you need to create a test database or
>   other data fixture for your tests, you
>   may create it in package setup and
>   remove it in package teardown once per
>   test run, rather than having to create
>   and tear it down once per test module
>   or test case.
> 
>   
>   
> 
> To create package-level setup and
>   teardown methods, define setup and/or
>   teardown functions in the `__init__.py`
>   of a test package. Setup methods may
>   be named `setup`, `setup_package`, `setUp`,
>   or `setUpPackage`; teardown may be named
>   `teardown`, `teardown_package`, `tearDown`
>   or `tearDownPackage`. Execution of tests
>   in a test package begins as soon as
>   the first test module is loaded from
>   the test package.

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T08:08:44.960

`expensiveSetup()`如果运行与否，您可以保存状态。

```
__expensiveSetup_has_run = False

class ExpensiveSetupMixin(unittest.TestCase):
    def setUp(self):
        global __expensiveSetup_has_run
        super(ExpensiveSetupMixin, self).setUp()
        if __expensiveSetup_has_run is False:
            expensiveSetup()
            __expensiveSetup_has_run = True 
```

或某种变体。也许 ping xml-rpc 服务器并创建一个新服务器，如果它没有应答。

但是 AFAIK 的单元测试方式是**设置和拆卸每个**单元测试，即使它很昂贵。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2011-01-02T11:43:59.737

我对 Netbeans 一无所知，但我应该提到[zope.testrunner](http://pypi.python.org/pypi/zope.testrunner)，它支持一个漂亮的东西：层。基本上，您在单独的类中进行测试设置，并将这些类附加到测试中。这些类可以相互继承，形成一层设置。然后，测试运行程序将只调用每个设置一次，并将其状态保存在内存中，而不是设置和拆除，它只会复制相关的层上下文作为设置。

这大大加快了测试设置，并且在您测试 Zope 产品和 Plone 时使用，其中测试设置通常需要您启动 Plone CMS 服务器、创建 Plone 站点并添加大量内容，这个过程可能需要半个以上的时间分钟。对每种测试方法都这样做显然是不可能的，但是对于层，它只做一次。这缩短了测试设置*并*保护了测试方法之间的相互影响，因此意味着测试继续具有确定性。

所以我不知道 zope.testrunner 是否适合你，但值得一试。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2020-11-18T12:00:12.157

应该可以通过定义`startTestRun`, `stopTestRun`of来做到这一点`unittest.TestResult class`。回答[https://stackoverflow.com/a/64892396/2679740](https://stackoverflow.com/a/64892396/2679740)

* * *

## 回答 #8

> 赞同：-2
> 
>             
> 
> 时间：2009-01-08T11:03:35.763

如果您只有一种测试方法，则可以保证`setUp`并执行一次， . 这种方法可以做任何它想做的事情。请确保您没有任何名称以 . 开头的方法。`tearDown``runTest``test`

```
class MyExpensiveTest( unittest.TestCase ):
    def setUp( self ):
        self.resource = owThatHurts()
    def tearDown( self ):
        self.resource.flush()
        self.resource.finish()
    def runTest( self ):
        self.runTest1()
        self.tunTest2()
    def runTest1( self ):
        self.assertEquals(...)
    def runTest2( self ):
        self.assertEquals(...) 
```

它不会自动找出要运行的内容。如果添加测试方法，还必须更新 runTest。  

# blackberry - Location API not working for custom/third-party applications

> ID：423484
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T07:02:58.633
> 
>         
> 
> 标签：blackberry, geolocation, gps, rim-4.2, jsr179

I'm trying to write a simple GPS based application for my BB 8800 (with Airtel, India). 

But for some reason my code getLocation(timeout) always returns with a non-valid location (only after timing out). I tried different combinations of criteria parameters with no success. 

I'm pretty sure that the problem is not with my code because even the BlackBerry GPS demo application does not work. However, my GPS receiver is working fine because "Wayfinder", a maps application that came bundled with my BB, works fine. 

To test it further, I tried running SpotFinder and Google Maps. But they did not work either. Google Maps could determine location using cell tower info but not GPS.

Here are some more details about my environment,
 1\. Phone Model: BlackBerry 8800
 2\. Carrier:     AirTel (India)
 3\. Device Version: 4.2.168 (Platform 2.3.0.54)

Can my carrier block it? [I spoke with AirTel technical support but they wouldn't budge to help developers]

Thanks In Advance

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-30T16:20:44.570

一些运营商（如 Verizon US）阻止了第三方应用程序的 GPS。其他人只是为应用程序的白名单启用了 GPS（主要是他们自己的），但拒绝所有其他人访问 GPS。

看来您的提供商正在做这样的事情。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-12T02:36:02.847

您的运营商可以阻止它吗？绝对，我不知道在印度，但在美国，一些运营商可以并且确实限制应用程序访问 GPS，如果它们没有“批准”。鉴于您描述的情况，这似乎很有可能。

# orm - 对象关系映射问题：需要的建议

> ID：423485
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T07:04:01.097
> 
>         
> 
> 标签：orm

我一直在尝试提出一个很好的设计模式，用于将关系数据库中包含的数据映射到我创建的业务对象，但我一直碰壁。

考虑下表：

```
TYPE: typeid, description
USER: userid, username, usertypeid->TYPE.typeid, imageid->IMAGE.imageid
IMAGE: imageid, location, imagetypeid->TYPE.typeid 
```

我想收集有关特定用户的所有信息。为此创建查询并不难。

```
SELECT u.*, ut.*, i.*, it.* FROM user u
INNER JOIN type ut ON ut.typeid = u.usertypeid
INNER JOIN image i ON i.imageid = u.imageid
INNER JOIN type it ON it.typeid = i.imagetypeid
WHERE u.userid = @userid 
```

问题是字段名称发生冲突，然后我不得不为每个字段设置别名，这很快就会失控。

有没有人对这种事情有一个像样的设计模式？

我曾考虑从单个存储过程中检索多个结果，然后使用数据集遍历每个结果，但我担心一些性能问题可能会在以后咬我一口。例如，代替上面的查询，例如：

```
SELECT u.*, t.* FROM user u
INNER JOIN type t ON t.typeid = u.usertypeid
WHERE u.userid = @userid;
SELECT i.*, t.* FROM image i
INNER JOIN type t ON t.typeid = i.imagetypeid
INNER JOIN user u ON u.imageid = i.imageid
WHERE u.userid = @userid; 
```

这似乎是一个不错的解决方案？谁能预见这种方法的任何问题？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T07:15:22.090

切勿`*`在生产代码中使用 SQL 通配符。始终拼出您要检索的所有列。

然后对其中一些进行混叠似乎并不需要如此大量的额外工作。

* * *

重新评论您询问背景和推理的评论：

*   有时您并不真正需要所有表中的*每一*列，并且获取它们可能会产生不必要的成本（尤其是对于大字符串和 blob）。“除了以下例外的所有列”没有 SQL 语法。

*   您不能为使用通配符获取的列设置别名。一旦您需要为任何列设置别名，您需要扩展通配符以明确列出所有列。

*   如果表结构发生变化，例如列被重命名、重新排序、删除或添加，那么通配符会按照表中定义的位置将它们全部取出。这可能看起来很方便，但当您的应用程序依赖于结果集中由给定名称或给定位置的列时，就不是这样了。您可能会遇到神秘的错误，即您的应用程序以错误的顺序显示列（如果按位置引用列），或者将它们显示为空白（如果按名称引用列）。

    但是，如果 SQL 查询显式命名列，则可以采用“早期失败”原则。这有助于调试，因为它直接将您引导至需要编辑以说明架构更改的 SQL 查询。

# javascript - XMLHttpRequest.responseStream 在哪里定义？

> ID：423486
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T07:05:05.137
> 
>         
> 
> 标签：javascript, ajax, api, reference

看看[GoogleAPI 参考](http://code.google.com/apis/desktop/docs/gadget_apiref.html#framework.graphics)`graphics`的部分。它说它需要 a或 a 的属性。通过，我认为这意味着。`loadImage``string``responseStream``XMLHttp``XMLHttp``XMLHttpRequest`

我的问题是我在任何地方都找不到该**字段**（`responseStream`字段）的文档。我没有运气谷歌搜索它（ironc），它不在“JavaScript：权威指南”中......但这些使用它的小工具似乎工作。

[这篇文章](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=1774868&SiteID=1)说 responseStream 似乎无法从浏览器的 XMLHttpRequest 访问。那它是谁的呢？它只是 Google 桌面的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T07:11:40.927

一点也不，IIRC 它最初是由 Microsoft 开发的，并且自 v5.0 以来一直是 IE 的一部分（不确定其他浏览器）。

请参阅[W3C 页面上的 XMLHttpRequest](http://www.w3.org/TR/XMLHttpRequest/)或[Google 答案](http://code.google.com/support/bin/answer.py?answer=79663&topic=11366)。

**编辑**：终于找到我正在阅读的文章：[MSDN > MSXML 2.0](http://msdn.microsoft.com/en-us/library/ms760305(VS.85).aspx)

> **响应流**
> 
>   
>   
> 
> 如果您正在请求二进制数据，则 responseStream 属性包含二进制流中的响应数据。

# powerbuilder - Powerbuilder - SQLNRows is 0 after Datawindow update

> ID：423503
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T07:16:50.760
> 
>         
> 
> 标签：powerbuilder, datawindow

The first time I call `Update` on my DataWindow it returns 1 (success) and `SQLCA.SQLNRows` is 1\. When I do a second update on the same screen without closing it in between, `Update` returns 1 and `SQLCA.SQLNRows` is 0\. Any suggestions why this is happening?

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-09T15:39:23.077

您的问题似乎涉及到几件事。

首先，正如 John Paul 所提到的，即使没有更新行，Update() 也会返回 1。“无事可做”没有具体的返回值。

其次，正如帮助文件中提到的，SQLNRows 的值是依赖于 DBMS 的，因此在不知道所涉及的 DBMS 的情况下很难评论那里填写的值。但是，不管怎样，由于 DataWindow 发出一系列仅针对一行的 INSERT、UPDATE 和 DELETE，如果填充此值，我不希望它超过一个，无论有多少 SQL 语句数据窗口问题。发出的最后一条 SQL 语句受影响的行数应始终为 1。

如果您尝试查找受 DataWindow Update() 影响的行数，请在 Update() 之前检查**ModifiedCount() + DeletedCount()**的值。

祝你好运，

特里。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T14:39:09.540

我已经很久没有使用 PB 了，但 .Update() 的返回值不只是数据库成功执行命令（即 UPDATE）的指标吗？如果这是正确的，那么它会在成功时返回 1，即使行值实际上并没有改变。SqlNRows 是更改行数的实际指标。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2010-03-11T15:58:23.417

更新答案：您可以`Update`在`UpdateEnd`事件中获得结果。在那种情况下，你有`rowsinserted, rowsupdated,`和`rowsdeleted`。

原始答案：判断您使用 PFC 时发生的情况的一个好方法是使用 SQL Spy 服务。在非 PFC 应用程序中，您可以像`beep(1)`在 DataWindow 的`sqlpreview`事件中那样放置一个无操作的行，在该行上设置一个断点，然后使用调试器来观察正在发生的事情。您还可以使用 SQL 语句跟踪工具或数据库跟踪工具，如**连接到数据库**一书中的连接*故障排除*中所述。

 **# .net-2.0 - .Net 2.0 application from network share without FullTrust

> ID：423504
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T07:17:45.483
> 
>         
> 
> 标签：.net-2.0, caspol

I am trying to run a .Net 2.0 application from a network share without using the FullTrust permission set. I want to create a new permission set that has just the permissions my assemblies require, and then assign that to the exe on the shared path. Is it possible to do this?
From my limited experiments, I find that I am unable to do get any application working from a network share without FullTrust. I tried creating a new perm set, and also tried the Everything and other perm sets, but none seem to work. Has anyone had any experience with this?

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T08:25:37.703

您需要使用强名称对程序集进行签名，然后将您的强名称的 cas-policy 设置为完全信任。

为使用您的强名称签名的所有代码设置 FullTrust 的最简单方法是：

```
caspol.exe -q -m -ag MyZone -strong -hex [HexCodeOfYourStrongName] -noname -noversion FullTrust -name MyCode -description "Code trust for my code"'; 
```

如果您的代码被拆分为多个程序集，您需要使用该强名称对每个程序集进行签名。您可能需要`SecurityPermission`使用链接需求设置 -Attribute，以确保调用者的安全性接管。

```
[SecurityPermission(SecurityAction.LinkDemand, Flags = SecurityPermissionFlag.ControlPrincipal)] 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T08:19:49.010

在 .NET 3.5 之前，您需要完全信任共享才能从那里运行 .NET 应用程序。[肖恩在此](http://blogs.msdn.com/shawnfa/archive/2004/11/24/269423.aspx)解释说：“如果不对默认 CAS 系统进行一些修改，我们将在加载包含安全对象的程序集和授予它们策略之间处于永无止境的循环中……进入 FullTrust 列表。”

在 .NET 3.5 中，此限制通过“...默认授予一组 FullTrust，使它们的行为与直接从您的计算机上启动一样”（来自 Shawn 的另一篇文章[）](http://blogs.msdn.com/shawnfa/archive/2008/05/12/fulltrust-on-the-localintranet.aspx)克服了这一限制

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T10:40:28.057

给予强命名的程序集 FullTrust 权限听起来不错，但不幸的是，我的程序集引用了几个第三方 COM Dll，如果我对主程序集进行强命名，它们也需要强命名。我猜然后将 FullTrust 赋予 Shawn 给出的路径是最好的解决方案： CasPol.exe -pp off -m -ag 1.2 -url file://\ShawnFa-Srv/Tools/* FullTrust

# glassfish - 没有负载均衡器的 Glassfish 故障转移

> ID：423515
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T07:27:13.140
> 
>         
> 
> 标签：glassfish, cluster-computing, failover

我有一个带有两个实例的 Glassfish v2u2 集群，我想在它们之间进行故障转移。我读过的关于这个主题的每个文档都说我应该在 Glassfish 前面使用负载均衡器，比如 Apache httpd。在这种情况下，故障转移有效，但我再次遇到单点故障。Glassfish 是否能够在没有负载均衡器的情况下进行故障转移？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-06T16:06:52.097

我们解决了这个问题，我们有两个 IP 地址，它们都响应 URL。DNS 提供商 ( [DNS Made Easy](http://www.dnsmadeeasy.com) ) 将在两者之间循环。将超时设置为低将确保如果一台服务器发生故障，另一台服务器将应答。当一台服务器停止响应时，DNS Made Easy 只会发送另一台主机作为服务器来响应此 URL。您必须信任 DNS 提供商，但您可以购买具有极高可用性的 DNS 查找服务

至于高可用性，您可以设置允许会话复制的集群设置，这样用户不会丢失超过一个可能失败的请求。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T08:20:29.150

[嗯.. 根据文档 ( http://docs.jboss.org/jbossas/jboss4guide/r4/html/cluster.chapt.html](http://docs.jboss.org/jbossas/jboss4guide/r4/html/cluster.chapt.html) ) 第 16.1.2.1 章，JBoss 可以在没有负载均衡器的情况下进行故障转移。客户端拦截器。

据我所知 glassfish 集群提供节点之间的内存会话复制。如果我使用 Suns Glassfish Enterprise Application Server，我可以使用保证 99.999% 可用性的 HADB。

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2009-01-08T07:39:11.480

不，您不能在应用程序级别执行此操作。

您的选择是：

*   轮询 DNS - 将您的两个服务器都暴露在互联网上并让客户端进行负载平衡 - 这非常有吸引力，因为它肯定会启用故障转移。

*   使用不同的第 3 层负载平衡系统——例如“Windows 网络负载平衡”、“Linux 网络负载平衡”或我写的称为“ [Fluffy Linux 集群](http://code.google.com/p/fluffy-linux-cluster/)”的系统

*   使用具有故障转移热备件的单独负载平衡器

在任何这些情况下，您仍然需要确保您的数据库和会话数据等可用并且在集群成员之间同步，这在实践中要困难得多。

# java - 如何在 JTable 中控制焦点

> ID：423524
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T07:34:56.510
> 
>         
> 
> 标签：java, user-interface, swing, focus, jtable

我想要做的是当用户完成表格单元格中的数据编辑时，根据用户输入的内容将焦点移到另一个单元格上，并将该单元格转换为编辑模式，以便用户可以立即开始输入而无需执行其他操作。这样用户可以专注于他的工作，软件将“思考”接下来应该编辑哪个单元格。

简单的任务在现实生活中看起来并不那么简单……有人知道吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-01-08T10:08:59.990

请试试这个例子。

它应该让您通过输入值 u、d、l、r 来浏览表格，分别代表上、下、左、右。

希望这会给你一个关于如何做的想法。

```
import java.awt.event.ActionEvent;

import javax.swing.AbstractAction;
import javax.swing.Action;
import javax.swing.JFrame;
import javax.swing.JTable;
import javax.swing.KeyStroke;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableModel;

public class Test extends JFrame {

    private JTable table;
    private TableModel tableModel;

    public Test() {
        tableModel = new DefaultTableModel(5, 5);

        table = new JTable(tableModel);
        table.setColumnSelectionAllowed(true);

        getContentPane().add(table);

        Action handleEnter = new AbstractAction() {
            public void actionPerformed(ActionEvent e) {
                table.getCellEditor().stopCellEditing(); // store user input
                int row = table.getSelectedRow();
                int col = table.getSelectedColumn();
                String val = String.valueOf(table.getValueAt(row, col)).toLowerCase();
                if (val.equals("u"))
                    --row;
                else if (val.equals("d"))
                    ++row;
                else if (val.equals("l"))
                    --col;
                else if (val.equals("r"))
                    ++col;
                if (     row >= 0 && row < tableModel.getRowCount()
                      && col >= 0 && col < tableModel.getColumnCount()) {
                    table.changeSelection(row, col, false, false);
                    table.editCellAt(row, col);
                }
            }
        };
        // replace action for ENTER, since next row would be selected automatically
        table.getInputMap().put(KeyStroke.getKeyStroke("ENTER"), "handleEnter");
        table.getActionMap().put("handleEnter", handleEnter);
    }

    public static void main(String[] args) {
        Test test = new Test();
        test.setSize(800, 600);
        test.setVisible(true);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T08:23:31.547

您应该将 KeyListener 添加到 JTable 以获取所有键入的字符。用户按下 后`Enter`，您应该检查用户输入的单词。

编写自己的`FocusTraversalPolicy`以将其设置为表

```
table.setFocusTraversalPolicy(policy) 
```

描述`FocusTraversalPolicy`了哪个组件获得下一个焦点。在此之后，您可以致电

```
FocusManager.getCurrentManager().focusNextComponent(); 
```

编辑：我没有对此进行测试，这只是一个想法。

# java - Java 和 CANopen

> ID：423526
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-01-08T07:37:10.673
> 
>         
> 
> 标签：java, automation, network-protocols, can-bus, canopen

## 背景

我需要在笔记本电脑上创建一个 Java 程序来接收/发送 CANopen 消息。

选择 RJ45 作为网络的物理介质。我是 CANopen 和 Java 通信编程的新手。

如果我看起来不熟悉，请原谅我。事实是，我已经阅读了很多，但我仍然不知道如何开始。

## 问题

1.  除了将 PC 连接到 CANbus 网络之外，CAN-PC 适配器还有什么作用？

2.  是否可以在没有 CAN-PC 适配器的情况下将笔记本电脑连接到 CANbus 网络？

3.  如果需要 CAN-PC 适配器，我应该使用哪种适配器？PCMCIA、并口、串口、usb等？

4.  如何开始编写 java 程序来监听/编写 CANopen 消息？

5.  我应该使用哪些库？

6.  我需要创建自己的驱动程序吗？

7.  我的程序是否应该处理心跳监控、错误检测等？还是这些由 CAN-PC 适配器处理？

8.  如何从 CANbus 节点检索特定信息？

9.  EDS 文件和对象字典是如何创建的？每个节点都需要它们吗？

    10.  如何在不购买 CAN 硬件的情况下模拟 CAN 网络来测试我的 Java 程序？

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-01-08T23:27:19.130

这是很多问题。我从来没有用 Java 做过任何与 CAN 相关的编程，但让我们看看我可能会回答哪些问题：

> 1）除了将PC连接到CANbus网络之外，CAN-PC适配器还有什么作用？

这主要取决于嵌入在适配器中的 CAN 控制器。但基本上它只处理低级的东西，如总线仲裁、错误处理、重传和消息缓冲。

> 2) 是否可以在没有 CAN-PC 适配器的情况下将笔记本电脑连接到 CANbus 网络？

不。

> 3) 如果需要 CAN-PC 适配器，我应该使用哪种适配器？PCMCIA、并行、串行、USB 等？

在笔记本电脑上？我会选择USB接口。我对 Kvaser 的界面有很好的经验。

> 4）我如何开始编写java程序来监听/编写CANopen消息？

取决于您的适配器的 API。API 很可能是基于 C 的，所以我至少会从一些简单的 C 测试程序开始。CAN 接口供应商可能有一些很好的例子。

> 5）我应该使用哪些库？

可能是随您的 CAN 接口提供的接口，至少对于基本 CAN 部分。对于 CANopen 部分，有一些商业 CANopen 堆栈可用，甚至可能是免费的。我怀疑是否有任何用 Java 编写的。如果您只是进行简单的通信，您也可以自己实现 CANopen 堆栈的必要部分。

> 6) 我需要创建自己的驱动程序吗？

一般没有。取决于您的操作系统和 CAN 接口模型。为您的操作系统选择带有驱动程序的 CAN 接口。

> 7）我的程序应该处理心跳监控/错误检测等吗？还是这些由 CAN-PC 适配器处理？

CANopen 堆栈应在 CANopen 级别处理该问题。低级 CAN 总线错误处理由您的接口负责。

> 8) 如何从 CANbus 节点检索特定信息？

我不知道你在这里是什么意思。PDO 或 SDO 取决于您想要的信息类型。

> 9) EDS 文件和对象字典是如何创建的？每个节点都需要它们吗？

您通常不需要创建 EDS 文件，但可能对文档有用。对象字典在软件中实现。如果使某些东西符合标准，则 OD 的某些部分是强制性的。

> 10) 如何在不购买 CAN 硬件的情况下模拟 CAN 网络来测试我的 java 程序？

我不会...开发一个有意义的总线模拟器可能比仅仅购买一个 CAN 适配器更昂贵。请注意，许多 CAN 适配器包含双接口，因此您可以在真正的 CAN 总线上进行通信测试，而只需要适配器和几个终端电阻器之外的硬件。

# programming-languages - 命令式和疑问式代码是什么意思

> ID：423528
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T07:38:53.383
> 
>         
> 
> 标签：programming-languages, imperative-programming, interrogative-programming

我的经理让我在 ASP.net 中编写代码。我的命令式和疑问式代码是什么意思。它与程序员有什么关系？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T07:54:27.237

命令式代码不返回值。它只是做一些事情。（vb.net 中的 sub 或 c# 中的 void 返回类型）。

询问代码确实返回一个值。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T07:46:48.967

虽然我不确定它是一种“流行”的编程方式，但疑问式编程基本上可以总结为：

> 领域特定的编程语言往往在能力上是僵化的，并且依赖于图形界面或脚本语言。我们提出了一种面向问题的方法，它不需要编程知识，并且可以很容易地适应广泛的领域。疑问式编程通过使用对一系列封闭式问题的回答来“解析”用户的意图来工作。问题由外部文件中指定的上下文无关语法指导。
>   [-引用](http://portal.acm.org/citation.cfm?id=797819)

虽然命令式编程是大多数程序代码的编写方式（C 风格）。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T07:51:41.580

命令式在英语中的意思是“命令语气”。因此，似乎告诉计算机“做这个，做那个”的程序是一个命令式程序。AC程序就是一个很好的例子。

与此相反，还有其他称为声明性的语言，例如 Haskell，读起来像数学定理，似乎不需要计算机提供任何东西。

# mfc - 如何去除窗口客户区的边框？

> ID：423529
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T07:39:10.607
> 
>         
> 
> 标签：mfc, client, border, area

我不希望看到窗口客户区的边框。有什么办法可以去除它们吗？该窗口是一个 SDI（单文档）窗口。

我还注意到边框只出现在客户区的顶部和左侧（没有出现在右侧和底部）。我很困惑。

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T07:53:07.910

这样的事情对您的情况有用吗？

```
BOOL CMainFrame::PreCreateWindow(CREATESTRUCT& cs)
{
    cs.style = WS_POPUP | WS_VISIBLE;  // or others you want
    cs.dwExStyle = 0;  // or others you want

    return CFrameWnd::PreCreateWindow(cs);
} 
```

这涉及重载[CWnd::PreCreateWindow](http://msdn.microsoft.com/en-us/library/4yc5skce(VS.80).aspx)以修改定义窗口初始化参数的[CREATESTRUCT 。](http://msdn.microsoft.com/en-us/library/ms632603.aspx)

[dwExStyle](http://msdn.microsoft.com/en-us/library/61fe4bte.aspx)是指扩展样式。

# iphone - iPhone SDK：将流式音频文件保存到 Documents 文件夹

> ID：423536
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T07:45:19.813
> 
>         
> 
> 标签：iphone, core-audio

我想将一个音频文件保存到我的应用程序的 Documents 文件夹中，而我的应用程序中的一个类正在流式传输它。我怎样才能做到这一点？

是否可以将流式音频直接保存到 mp3？（如果流式传输的音频文件是 mp3 或者我必须使用 caf？）

谢谢。

 *编辑：如果我在另一个线程中运行保存并且用户退出应用程序怎么办？我知道应用程序无法在 iPhone 的后台运行，但有什么方法可以在用户退出应用程序时停止下载并删除部分保存的文件？我可以在类内或 NSURLConnection 的委托中获得退出信号吗？* 

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-09T01:43:18.623

如果您使用 NSURLConnection 或 CFNetwork 下载文件，您可以将其保存在 connectionDidFinishLoading 委托中。

看看 Matt Gallaghers
[流式传输和播放 MP3 流](http://cocoawithlove.com/2008/09/streaming-and-playing-live-mp3-stream.html)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-06-07T05:07:56.713

```
(void)applicationWillResignActive:(UIApplication *)application
{

} 
```

在 App 委托文件的上述方法中编写您的代码。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-16T12:03:59.063

如果您想在退出时清理部分保存的文件，

您可能会比从

`- (void)applicationWillTerminate:(UIApplication *)application`

在您的应用控制器中。

# c# - 用户登录技术 C# Win App

> ID：423547
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T07:52:20.657
> 
>         
> 
> 标签：c#, winforms

嗨，我在 C#(2.0) windows 应用程序和 SQL2005 数据库中做 ERP 解决方案。网络应用程序通过数据库进行通信。我使用普通技术进行用户登录和注销，保持状态位。我的问题是当我的应用程序中断时其他原因用户状态可能不会改变。这将导致用户下次无法登录。我该如何解决这个问题？你能提供任何新的用户操作技术吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T08:02:33.507

通过为每个登录维护一个会话来跟踪用户登录如何？快速而简单的解决方案是提供一个选项，让他们从“新位置”登录并使旧会话无效。然后当你去执行一个操作时，首先检查会话是否仍然有效。

更好的实现是保持会话活动并指定超时。（即如果会话是 x 分钟旧的，则使其无效。）然后您将不会看到来自旧孤立连接的“幻像登录” - 它们会自动过期。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T08:03:17.483

这里有两个常见的答案：

*   如果您尝试登录并且已经登录，请提议中断（重置）现有登录

*   使用轮询/超时 - 即让应用程序每 2 分钟（例如）调用一个方法来更新“最后一次听到的消息”；如果您在 5 分钟内没有收到某人的消息（例如），则清除该标志

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T09:59:43.613

如果您的意图是禁止在不同计算机上共享一个用户名，请在使用有效密码登录后，将该计算机上的唯一令牌记录到**staff.last_logged_at** = **@unique_token**。注销时，设置 staff.last_logged_at = ''。这样即使计算机被中断（病毒导致程序崩溃，或者不小心按下了计算机的重置按钮等，因此last_logged_at没有重置为''）用户仍然可以登录，只需检查令牌是否用户当前登录的计算机与 last_logged_at 相同。如果相同，他/她仍然可以登录。

如果某个用户尝试使用其他用户的用户名登录，只需检查某个用户计算机的机器令牌是否与其他用户的last_logged_at相同，如果不相等，则不允许登录，表示两个用户共享相同的密码.

现在如果计算机*真的很难*崩溃（处理器融化，硬盘崩溃，操作系统需要重新安装等）。必须允许用户使用其他计算机。制作一个可以**重置**用户的 last_logged_at 的**管理模块。**

 **对于@unique_token，只需使用计算机上**唯一且永久**的任何内容，比如 MAC 地址，或在操作系统设置上散列任何内容。

伪代码：

```
Logging In:

if (select count(*) from staff where staff_name = @staff_name and password = 'correct' and (last_logged_at = '' or last_logged_at = @unique_token) ) <> 0 then then

    -- allow login          
    update staff set last_logged_at = @unique_token where staff_name = @staff_name

else if (select count(*) from staff where staff_name = @staff_name and password = 'correct' and last_logged_at <> @unique_token) <> 0 then then

    -- disallow login
     throw exception "You cannot use the same user name on two or more computers.   Contact the administrator if you have any concerns"

else

    -- disallow login
    throw exception "Wrong password"

end if

Logging Out:

update staff set last_logged_at = '' where staff_name = @staff_name 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T08:53:54.293

为什么要限制用户可以登录的次数？在 Windows 中，启动应用程序的多个实例是很常见的。

我必须承认，我的 Windows 应用程序也有一部分只允许一个用户。为了查看其他用户是否已连接，我使用了类似于 Marc 的轮询算法。可以选择强制进入。

每分钟或两分钟更新一次锁定记录并不是资源密集型的（除非您有数千个用户）。

# c - 在 C 中传递多维数组

> ID：423554
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T07:56:11.040
> 
>         
> 
> 标签：c, arrays, argument-passing, dynamic

我目前正在尝试学习 C，但遇到了一个我无法解决的问题。

考虑：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define ELEMENTS 5

void make(char **array, int *array_size) {
    int i;
    char *t = "Hello, World!";

    array = malloc(ELEMENTS * sizeof(char *));

    for (i = 0; i < ELEMENTS; ++i) {
        array[i] = malloc(strlen(t) + 1 * sizeof(char));
        array[i] = strdup(t);
    }
}

int main(int argc, char **argv) {
    char **array;
    int size;
    int i;

    make(array, &size);

    for (i = 0; i < size; ++i) {
        printf("%s\n", array[i]);
    }

    return 0;
} 
```

我不知道为什么上面创建它后无法读回数组的内容。我确实花了一个小时试图理解为什么它失败但空手而归。毫无疑问，这是一件微不足道的事情。

干杯，

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-01-08T08:00:42.310

您需要将“数组”的地址传递给函数。也就是说，你需要 char ***。这是因为您需要通过为其分配内存来更改数组的值。

编辑：只是为了让它更完整，在函数声明中你需要有类似的东西

```
void make(char ***array, int *array_size) 
```

然后你需要使用它来调用它

```
make(&array, &size); 
```

在函数*make*中，分配内存

```
*array = malloc(ELEMENTS * sizeof(char *)); 
```

并相应地改变其他地方。

此外，正如 kauppi 所指出的，strdup 将为您分配内存，因此您无需对每个字符串执行 malloc。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-01-08T08:09:21.417

这是工作代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define ELEMENTS 5

void make(char ***array) {
    char *t = "Hello, World!";

    *array = malloc(ELEMENTS * sizeof(char *));

    int i;
    for (i = 0; i < ELEMENTS; ++i) {
        (*array)[i] = strdup(t);
    }
}

int main(int argc, char **argv) {
    char **array;
    make(&array);

    int i;
    for (i = 0; i < ELEMENTS; ++i) {
        printf("%s\n", array[i]);
        free(array[i]);
    }
    free(array);
    return 0;
} 
```

正如其他人发布的那样 - 有未使用的大小，并且 strdup 自己分配内存，之后释放内存很好......

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T07:59:50.813

请参阅 PolyThinker 的评论，这绝对是正确的。

除了传递数组的方式之外，您还应该检查一些其他问题：

1.  也许您应该在 make(...) 中为 array_size 分配一些东西？

2.  strdup(char*) 分配内存，array[i] 的 malloc 不是必需的。

3.  您应该在不再需要后释放所有分配的内存。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T08:05:25.140

您正在传递数组的*当前*值以作为副本（在堆栈上）。当您在 make() 中更改数组时，您只是在更改副本，而不是实际变量。尝试使用 & 通过引用传递，或将其设为 char *** 并使用 *array = ...

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T08:04:50.897

声明了 size 但没有分配任何值（我想这应该发生在函数 make 中）。

# asp.net - 在动作参数上将参数传递给模型绑定器

> ID：423591
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T08:35:19.167
> 
>         
> 
> 标签：asp.net, asp.net-mvc

我希望使用我直接在动作方法参数上制作的模型绑定器。如：

```
public ActionResult MyAction([ModelBinder(typeof(MyBinder))] string param1) 
```

但是，我需要将一个字符串传递给活页夹本身，所以我想知道你是否可以按照以下方式做一些事情：

```
public ActionResult MyAction([MyBinder("mystring")] string param1) 
```

是否可以？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T13:39:02.190

不，您不能通过属性声明传递参数。如果您查看 ModelBinderAttribute 的源代码，您会发现它的构造函数只接受一个类型参数，它没有其他属性，并且它是一个密封类。所以这条路是死胡同。

我所知道的将信息导入 ModelBinder 的唯一方法是 FormCollection 本身。

但是，您可以为您打算使用的每个参数值创建一个父绑定器类型和子类型。这很乱，但它可以在你给出的例子中工作。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2018-06-26T15:28:20.153

是的，这是可能的。您应该创建一个从 驱动的类`System.Web.Mvc.CustomModelBinder`，并覆盖该方法`GetBinder`。例如，这里的实现除了需要一个`Type`对象之外，还需要一个用于模型绑定器构造函数参数的对象数组：

```
public sealed class MyModelBinderAttribute : CustomModelBinderAttribute
{
    /// <summary>
    /// Gets or sets the type of the binder.
    /// </summary>
    /// <returns>The type of the binder.</returns>
    public Type BinderType { get; }
    /// <summary>
    /// Gets or sets the parameters for the model binder constructor.
    /// </summary>
    public object[] BinderParameters { get; }

    /// <summary>
    /// Initializes a new instance of the <see cref="T:System.Web.Mvc.ModelBinderAttribute" /> class.
    /// </summary>
    /// <param name="binderType">The type of the binder.</param>
    /// <param name="binderParameters">The parameters for the model binder constructor.</param>
    /// <exception cref="T:System.ArgumentNullException">The <paramref name="binderType" /> parameter is null.</exception>
    public MyModelBinderAttribute(Type binderType, params object[] binderParameters)
    {
        if (null == binderType)
        {
            throw new ArgumentNullException(nameof(binderType));
        }

        if (!typeof(IModelBinder).IsAssignableFrom(binderType))
        {
            throw new ArgumentException(string.Format(CultureInfo.CurrentCulture,
                "An error occurred when trying to create the IModelBinder '{0}'. Make sure that the binder has a public parameterless constructor.",
                binderType.FullName), nameof(binderType));
        }
        this.BinderType = binderType;
        this.BinderParameters = binderParameters ?? throw new ArgumentNullException(nameof(binderParameters));
    }

    /// <summary>Retrieves an instance of the model binder.</summary>
    /// <returns>A reference to an object that implements the <see cref="T:System.Web.Mvc.IModelBinder" /> interface.</returns>
    /// <exception cref="T:System.InvalidOperationException">An error occurred while an instance of the model binder was being created.</exception>
    public override IModelBinder GetBinder()
    {
        IModelBinder modelBinder;
        try
        {
            modelBinder = (IModelBinder)Activator.CreateInstance(this.BinderType, this.BinderParameters);
        }
        catch (Exception ex)
        {
            throw new InvalidOperationException(string.Format(CultureInfo.CurrentCulture,
                "An error occurred when trying to create the IModelBinder '{0}'. Make sure that the binder has a public parameterless constructor.",
                this.BinderType.FullName), ex);
        }
        return modelBinder;
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2012-03-07T10:03:37.690

只是一个想法，我正在考虑需要类似的要求，我想通过城堡服务。

我想知道您是否可以使用传递给 Binder 的 ControllerContext 并通过属性公开服务/属性或其他方式？

只是一个想法，我现在要试试这个，我会反馈

富有的

# maemo - 如何开始 Maemo 软件开发

> ID：423595
> 
>         
> 
> 赞同：17
> 
>         
> 
> 时间：2009-01-08T08:39:03.027
> 
>         
> 
> 标签：maemo

几个月前，我购买了诺基亚 N800 设备，从那时起我就渴望为它编写一些代码。我知道我正在运行的一些应用程序是用 Python 编写的，而且 Maemo 平台也有一个 Mono 端口。

基本上我要问的是：

*   Maemo 平台有推荐的开发语言吗？

*   有哪些开发工具？

*   我可以使用 Windows 或 Linux 作为我的主要开发机器吗？您推荐哪一种？为什么？

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-08-13T09:44:25.953

我强烈建议您尝试 C++ 和 QT。

[Diablo 和 Fremantle 已经很好地支持QT](http://qt4.garage.maemo.org/)，并且 Maemo (Harmattan) 的下一个版本应该[基于 QT](http://derstandard.at/fs/1246541386200/Maemo-switches-to-Qt)。

学习 QT 会比 GTK+ 容易得多，编码会更快更有趣，你的应用程序可以在各种平台上编译，你甚至可以在 Windows 中开发和调试，然后在 scratchbox 环境中简单地运行一个 qmake && make。

看看这个教程：[QT for Maemo 入门](http://wiki.forum.nokia.com/index.php/Getting_started_with_Qt_for_maemo)

您仍然需要一个 Linux 机器来为 Maemo 设备编译代码。如果您使用的是 Windows，您可以在 VirtualBox 机器中设置 ubuntu（或 kubuntu）。

[Maemo SDk +](http://maemo-sdk.garage.maemo.org/)和 Scratchbox 2 是比 Maemo SDk 和 Scratchbox 更好的选择。

就个人而言，我在 Windows 中使用 QT creator，在 VirtualBox 中使用 kubuntu 9.04，我从未如此快乐过。当我开始的时候，我尝试了“官方”的方法：Ubuntu、GTK+、C 语言和 scratchbox 1.... 那很痛苦。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-01-09T06:08:58.867

Hildon 框架由 GTK+ 扩展组成，因此语言是 C。您也可以使用 C++ 包装器 ( [maemomm](http://maemomm.garage.maemo.org/) )。或者您可以使用[pymaemo](http://pymaemo.garage.maemo.org/)来使用 Python 构建应用程序，对我来说这比 C 或 C++ 容易得多。我也看到了一个 ruby​​ 端口的尝试，但最近没有跟进那个项目。

对于开发环境，有“scratchbox”，它为您提供了一个用于编译和运行应用程序的沙箱。这是有关如何设置[暂存盒](http://maemo.org/maemo_training_material/maemo4.x/html/maemo_Getting_Started)开发环境的链接。（我确实花了很长时间来完成所有设置。）

您必须使用 Linux 作为您的开发机器，因为您的诺基亚 N800 确实是一台迷你 Linux 计算机。

如果您想拥有 IDE 体验，请尝试 Eclipse 的[ESbox](http://esbox.garage.maemo.org/)插件。

玩得开心黑客！

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-07-20T19:16:03.967

我刚刚在 Maemo.org 上找到了两个教程：

*   [为 Maemo 3.x 编写 Hildon 桌面插件](http://maemo.org/development/documentation/manuals/3-x/tutorial_desktop_plugins_bora/)

*   [如何为 maemo 4.x 编写 maemo 桌面插件](http://maemo.org/development/documentation/manuals/4-0-x/writing_hildon_desktop_plug-ins_for_maemo/)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T14:40:19.313

为了获得额外的移动乐趣，您可以获取 linux gcc 并使工具在平板电脑本身上运行，并在设备上进行编程和编译。对于这类事情的任何帮助，[Maemo Talk](http://talk.maemo.org)论坛都很棒。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-11-13T18:38:24.387

Maemo 的 Ruby 托管在[http://code.scottishclimbs.com/maemo/](http://code.scottishclimbs.com/maemo/)

我自己还没有尝试过。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-07-20T19:19:58.297

有一个用于 Maemo 开发的[Scratchbox 虚拟设备](http://www.vmware.com/appliances/directory/702)（我不确定链接是否正确），但这就是我开始破解的方式。我花了很长时间才弄清楚如何自己设置 Scratchbox。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-12-01T10:06:22.780

诺基亚一直在努力为开发人员提供工具和文档。我想说最好的起点之一是诺基亚论坛：

[http://www.forum.nokia.com/Technology_Topics/Device_Platforms/Maemo.xhtml](http://www.forum.nokia.com/Technology_Topics/Device_Platforms/Maemo.xhtml)

Maemo 开发的下一站当然是 Maemo 的总部：

[http://maemo.org/development/](http://maemo.org/development/)

这两个链接指向您必须深入了解更多信息的门户，但它们是很好的起点。现在直接回答你的问题：

*   我想这两种“推荐”的语言是 C 和 python。虽然这些都得到了很好的支持，但它们并不是您从以前的答案中看到的唯一选择。除了这些语言之外，perl 还在设备上，尽管它与在 debian 上的状态不同。

*   主要的开发工具是SDK。它允许您测试环境并为设备编译软件。您还可以使用有插件的 Eclipse。

*   建议您使用linux作为开发机器，但您可以在Windows上的虚拟机中运行它。虽然我更喜欢我的操作系统是 100% 免费的，因此选择了 debian，但诺基亚正在努力为 Windows 打造更好的开发环境。所以请放心，诺基亚不一定和我一样有偏见！:-)

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-12-01T12:46:25.477

我必须回应卡拉乔夫的回应。

目前推荐的两种方法是：

*   Python + PyGtk

*   C++ 和 Qt

使用其他任何东西，你都会让自己承受一些痛苦（除非你是 Gtk+ 的老手——既然你在问这个问题，我假设你不是）。无论如何，C++ 和 Qt 是 Maemo 的未来，而 Qt 在诸如暗黑破坏神之类的“旧”平台上运行良好。

作为调试器，我建议您选择（编译）“cgdb”。普通的旧 gdb 可能有点太简陋了。

通常，您应该使用 Qt Creator 将您的应用程序开发为“普通”Qt 应用程序，并偶尔在 Scratchbox 中对其进行测试。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2012-02-29T05:45:18.587

我主要使用 python 和 pyside 开发（我在 N900 上开发）。我的所有文件都在诺基亚 N900 中，我使用 sshfs 将我的主目录挂载到我的电脑上。然后我在我的桌面上进行开发，同时实际上将所有内容保存到手机中，并使用 SSH 远程运行它。

如果你懒得拿起设备看屏幕，你可能想使用 VNC；虽然就个人而言，我觉得它只是响应不够。

是的，我的桌面上只有我的编辑器（顺便说一下，崇高的文本）。其余的生活在移动设备上。我使用 git 来同步事物/进行备份等。

一旦你想分发你的项目，py2deb 非常适合制作包。同样，无需在桌面上安装任何东西。

如果你宁愿保守一点，SDK 是为 debian 设计的，你会在任何非基于 debian 的操作系统上遭受*很多痛苦（除非你使用虚拟机）。*被警告！:)

# c# - 如何将 c# 代码转换为 vb.net (Linq)？

> ID：423598
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T08:41:51.087
> 
>         
> 
> 标签：c#, vb.net, linq

var result = from dal.context.Funds 中的 с 选择新 { Name = c.CODE Price = c.Price };

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T08:47:24.133

我不是一个大的 VB 用户，但类似：

```
Dim result = From c In dal.context.Funds _
                 Select c.CODE, c.Price 
```

要重命名它，您可能需要`With`（猜测）：

```
Select New With {.Name = c.CODE, .Price = c.Price} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T10:32:29.303

我过去曾使用[反射器](http://www.red-gate.com/products/reflector/)进行语言转换。  

[这篇](http://diditwith.net/2007/09/24/UsingReflectorToExploreLINQ.aspx)文章表明它也可以帮助 LINQ...

# ruby - 用一个 ＃！在 Ubuntu 中运行的 ruby 中发表评论

> ID：423600
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-08T08:42:15.423
> 
>         
> 
> 标签：ruby

我是编程新手，正在尝试遵循使用 #! 的示例！用红宝石评论。

我一直收到消息：bash: matz.rb: command not found

我正在使用这个评论：#！/usr/bin/env 红宝石

我已经尝试过之后有和没有空间！以及有和没有环境。

当我使用 $ which ruby​​ 时

红宝石在：/usr/bin/ruby

我还进入了操作系统并将所有用户的 matz.rb 文件的权限更改为 rwx，但没有任何效果。我做错了什么还是我的系统设置不正确？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-01-08T08:48:37.253

`/usr/bin/env`部分很好。您需要在运行时为 bash 提供 matz.rb 的路径。如果您在带有 matz.rb 的目录中，请键入“./matz.rb”。目录“。” 表示当前目录 - 默认情况下，bash 在运行程序时不会出现在此处（就像 Windows 一样）。

env 程序 (/usr/bin/env) 在可执行搜索路径（PATH 环境变量）中搜索`ruby`程序，就像您在命令提示符下键入它一样，然后运行该程序。shebang 评论没有这样做。如果您想将您的脚本提供给其他可能没有安装 ruby​​ 的人，那么您应该使用“ `#!/usr/bin/env ruby`”注释，这样只要他们可以通过键入“ruby”来运行 ruby​​，它就可以工作。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-01-08T08:47:44.320

如果您与 matz.rb 文件位于同一目录中，请确保将其运行为

```
$ ./matz.rb 
```

而不仅仅是

```
$ matz.rb 
```

这是一个演示此工作的 shell 会话：

```
$ ls -la m*
-rwxr-xr-x  1 gareth  gareth  32  8 Jan 08:46 matz.rb
$ cat matz.rb
#!/usr/bin/env ruby
puts "Matz"
$ matz.rb
-bash: matz.rb: command not found
$ ./matz.rb
Matz 
```

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T10:42:12.747

您的文件不是在 Windows 上创建的吗？如果它有 \r\n 行尾，那会扰乱 bash。你可以用 Vim 打开它并检查：

```
vi matz.rb
:set ff=unix
:wq 
```

如果当您使用制表符完成“ff=”部分时，它显示的是 dos，那么它的文件格式错误。或者，运行 dos2unix 并尝试再次运行该文件：

```
apt-get install sysutils
dos2unix matz.rb 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T08:49:23.333

听起来你在 Unix/Linux 系统上，只是`matz.rb`在命令行上输入。如果您尝试在当前目录中执行命令，则需要像 ./matz.rb 一样调用它。“./”告诉它查看当前目录，而不仅仅是 /usr/bin 和朋友。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T15:00:29.637

我没有看到任何答案表明您更改文件的可执行模式，所以您可能想尝试做

```
chmod +x matz.rb 
```

在你去尝试做之前

```
./matz.rb 
```

此外，最好不要将 .rb 扩展名附加到文件中，例如普通的 ruby​​ / rails 脚本，例如 script/generate、script/console 等。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T15:18:11.037

您可以将“shebang”行与以下任何一种一起使用：

```
#!/usr/bin/ruby
#!/usr/bin/env ruby 
```

但是该脚本必须是可执行的（您表示它是可执行的）并且在您的 shell $PATH 中。

```
echo $PATH 
```

将脚本放在这些目录之一中，或修改您的路径，否则指定它的完整路径，例如：

```
export PATH=$PATH:/home/user/bin 
```

或其中之一：

```
./matz.rb
/home/user/bin/matz.rb 
```

您还可以运行 Ruby 解释器，将脚本文件名作为参数传递，它将被执行。如果您的系统上安装了另一个版本的 Ruby（例如，用于测试，如[Ruby Enterprise Edition、REE](http://www.rubyenterpriseedition.com/)），这将特别有用：

```
/usr/bin/ruby matz.rb
/opt/ree/bin/ruby matz.rb 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T08:44:11.753

您是否尝试过如下的 ShaBang 直接指向 ruby​​？

```
#! /usr/bin/ruby 
```

然后你从命令行调用脚本

```
./matz.rb 
```

在 Unix/Linux 系统下，命令前面的点用于在当前目录中搜索命令。如果你给出一个像 /usr/bin/ruby 这样的路径，它会在当前目录中搜索一个名为 usr...

在环境的路径变量指定的位置搜索前面没有点/的命令。

以 / 开头的命令是从指定路径的根目录开始搜索的。

在您的 ShaBang 中，您要指定解释器的确切路径，因此“/usr/bin/ruby”是正确的路径。在命令行上，您希望在其中执行脚本，您需要使用“./matz.rb”调用脚本，否则 bash 将搜索 /usr/bin/matz.rb 之类的命令，这会导致您的错误消息。

# c# - 非泛型类中的泛型方法？

> ID：423605
> 
>         
> 
> 赞同：22
> 
>         
> 
> 时间：2009-01-08T08:45:22.110
> 
>         
> 
> 标签：c#, generics

我确定我以前做过，但找不到任何例子！呃……

例如，我想将 a 转换`IList<T>`为 a `BindingList<T>`：

```
public class ListHelper
{
    public static BindingList<T> ToBindingList(IList<T> data)
    {
        BindingList<T> output = new BindingList<T>();

        foreach (T item in data)
            output.Add(item);

        return output;
    }
} 
```

* * *

## 回答 #1

> 赞同：35
> 
>             
> 
> 时间：2009-01-08T08:51:03.720

```
ToBindingList <T> (...) 
```

* * *

```
public class ListHelper
{
    public static BindingList<T> ToBindingList<T>(IList<T> data)
    {
        BindingList<T> output = new BindingList<T>();

        foreach (T item in data)
        {
            output.Add(item);
        }

        return output;
    }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2009-01-08T10:11:41.657

这不是更简单吗？

```
public static class Extensions
{
    public static BindingList<T> ToBindingList<T>(this IList<T> list)
    {
        return new BindingList<T>(list);
    }
} 
```

它是如此简单，我们不需要扩展方法......

我错过了什么吗？

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2009-01-08T08:56:03.850

您可以通过扩展方法做到这一点，它会更好。

```
public static class Extensions
{
    public static BindingList<T> ToBindingList<T>(this IList<T> list) 
    {
        BindingList<T> bindingList = new BindingList<T>();

        foreach (var item in list)
        {
            bindingList.Add(item);
        }

        return bindingList;
    }
} 
```

# sql - T-SQL：检查电子邮件格式

> ID：423606
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-01-08T08:46:24.993
> 
>         
> 
> 标签：sql, sql-server, tsql, email

我有这种情况，我需要物理数据库中的数据完整性。例如，我有一个变量 of `@email_address VARCHAR(200)`，我想检查它的值`@email_address`是否为电子邮件格式。任何人都知道如何在 T-SQL 中检查格式？

非常感谢！

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2009-01-08T09:04:19.717

我使用许多不同的错误和有效电子邮件地址测试了以下查询。它应该完成这项工作。  

```
IF (
     CHARINDEX(' ',LTRIM(RTRIM(@email_address))) = 0 
AND  LEFT(LTRIM(@email_address),1) <> '@' 
AND  RIGHT(RTRIM(@email_address),1) <> '.' 
AND  CHARINDEX('.',@email_address ,CHARINDEX('@',@email_address)) - CHARINDEX('@',@email_address ) > 1 
AND  LEN(LTRIM(RTRIM(@email_address ))) - LEN(REPLACE(LTRIM(RTRIM(@email_address)),'@','')) = 1 
AND  CHARINDEX('.',REVERSE(LTRIM(RTRIM(@email_address)))) >= 3 
AND  (CHARINDEX('.@',@email_address ) = 0 AND CHARINDEX('..',@email_address ) = 0)
)
   print 'valid email address'
ELSE
   print 'not valid' 
```

它检查这些条件：

*   没有嵌入的空格

*   '@' 不能是电子邮件地址的第一个字符

*   '。' 不能是电子邮件地址的最后一个字符

*   必须有一个“。” 在“@”之后的某个地方

*   '@' 符号是允许的

*   域名应以至少 2 个字符扩展名结尾

*   不能有像 '.@' 和 '..' 这样的模式

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-01-08T09:04:48.233

AFAIK 没有好的方法可以做到这一点。

电子邮件格式标准是如此复杂，众所周知，解析器可以运行数千行代码，但即使您要使用一种更简单的形式，它会使一些晦涩但有效的地址失败，您也必须在没有正则表达式的情况下这样做T-SQL 本身不支持（同样，我不是 100% 支持），给你留下一个简单的后备，比如：

`LIKE '%_@_%_.__%'` 

..或类似的。

我的感觉通常是你不应该在最后一刻这样做（当你插入数据库时​​）你应该在第一个机会和/或一个公共网关（实际上使 SQL 插入的控制器请求），顺便说一句，您将拥有正则表达式的优势，甚至可能是一个为您进行“真正”验证的库。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T09:03:16.583

如果您使用 SQL 2005 或 2008，您可能想看看编写 CLR 存储过程并[像这样](http://msdn.microsoft.com/en-us/magazine/cc163473.aspx)使用 .NET 正则表达式引擎。如果您使用的是 SQL 2000 或更早版本，则可以使用 VBScript 脚本引擎的正则表达式[，例如 ths](http://www.sqlteam.com/article/regular-expressions-in-t-sql)。[您还可以使用这样](http://www.codeproject.com/KB/mcpp/xpregex.aspx)的扩展存储过程

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T09:05:02.897

恐怕在 T-SQL 中没有简单的方法可以做到这一点。[要验证RFC 2822](https://www.rfc-editor.org/rfc/rfc2822#section-3.4.1)允许的所有电子邮件地址类型，您需要使用正则表达式。

更多信息[在这里](http://www.regular-expressions.info/email.html)。

如果您想简化它，您将需要定义您的范围。

# .net - 创建自定义上下文菜单

> ID：423611
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-08T08:47:46.363
> 
>         
> 
> 标签：.net, winforms, contextmenu, popupmenu

我有一个简单的对话框，我想将其显示为上下文菜单。

我可以点击右键并将其显示为没有边框的模态对话框，如果可能的话，我希望它看起来像 Windows 上下文菜单（lhs 上的栏，蓝色边框） - 有没有办法自动收集用户桌面设置，（需要同时适用于 XP、Vista）？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T08:52:29.037

Visual Studio 工具箱中有一个上下文菜单控件。用那个。

如果您需要在右键单击时显示一个无边框的对话框，这也是可能的。正如你所说，抓住右键点击甚至ShowModal。此外，您可以通过将对话框的“BorderStyle”属性设置为“无”来消除边框。

# windows - 是什么导致 MS Windows“系统”进程在编译时发疯？

> ID：423614
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T08:49:00.357
> 
>         
> 
> 标签：windows, crash

最近有几次我注意到“某些东西”导致 Windows 系统进程处于 50% 以上，并且在重新启动 PC 之前它不会退出。到目前为止发生在 Win2k 和 Win XP 上。

这特别麻烦，因为它目前似乎是由 MSVC 2005/Incredibuild 触发的，并且重新启动构建服务器并不是一件好事。

同时，“系统空闲进程”进程占用了 CPU 的其余部分，而构建步骤本身似乎也很匮乏。IE。通常编译时间不到 5 分钟的模块目前需要 20 多分钟。

我会猜测可能是病毒检查器或乌龟 svn，但会拼命地喜欢其他一些建议。

编辑：

我一直在经历这种被触发的事情，而罪魁祸首可能不会持续。这并不是说其他​​一些正在进行的进程没有做一些“愚蠢”的事情，并且正在管理系统的主动锁定，同时看起来本身是空闲的。

系统（1 个核心的 100%）和系统空闲进程共享总 CPU 的 98-100%。有时 mt.exe、link.exe、buildservice 会看到 1-2%。我正在运行 VNC 来查看机器，所以它有时会查看。

编辑 2：前一天晚上离开时，构建过程似乎进展缓慢，但再等 13 个小时后，1 小时的构建过程还没有完成。系统仍在占用 1 个核心。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T09:33:39.407

我的理解是“系统”进程是在内核中花费的时间（所以执行磁盘 I/O、网络 I/O（你确实提到了 Incredibuild）等等）——我会检查磁盘碎片、病毒检查器并可能在您的 Incredibuild 集群中的其他机器上查看这些。

由于系统空闲进程以“低”优先级运行，因此它会“占用 CPU 时间”是一条红鲱鱼——如果有的话，它只是表明有可用的 CPU 时间。处理被卡在单个处理器上的事实表明该进程正在做一些不支持多核的事情，或者有人将它的线程亲和性设置为 1。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T09:00:20.410

我注意到我使用的病毒检查软件可以从根本上减慢编译速度，但它不会超出构建结束。关闭高级和启发式检查可以改善这一点，以至于我不必完全禁用扫描仪。我已经改变了我的扫描策略，现在我使用预定的完整扫描而不是高级动态扫描，因为它会损害许多应用程序的性能。（注意我使用的是卡巴斯基的最新版本）。我还使用了一个自动备份工具（AJCBackup），在编译时也需要加以限制。

您可能还需要考虑在用于创建大量临时文件和目标文件的驱动器上禁用[Windows 索引服务](http://en.wikipedia.org/wiki/Windows_Indexing_Service)，因为在这种情况下它不会为它所获得的性能量提供太多价值。

编辑：是否检查过哪些进程实际上占用了 CPU 内核并将它们追溯到给定的应用程序？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-22T07:55:55.337

RE: smacl，来自 Windows 搜索/索引服务 (WSearch) 的工作不会归因于系统进程的 CPU 时间，它应该来自 SearchIndexer.exe/SearchFilterHost.exe 服务 (Vista+)。

您将看到的来自 System 的大部分活动将来自惰性写入器和其他磁盘访问的磁盘活动。来自系统的 CPU 活动将是因为内核活动，例如驱动程序 ( [ISR/DPC](http://msdn.microsoft.com/en-us/library/ms797921.aspx) ) 和其他内核级过滤器（*可能*包括 AV 文件和进程过滤器）。

Process Explorer ( [http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx) ) 可以帮助查看跨进程的 CPU 使用情况，包括系统。您可以使用公共[Microsoft 符号服务器](http://msdn.microsoft.com/en-us/library/b8ttk8zy(VS.71).aspx)和[此资源](http://www.microsoft.com/whdc/DevTools/Debugging/debugstart.mspx)来帮助您入门。

如果您可以使用 Xperf ( [http://msdn.microsoft.com/en-us/performance/cc825801.aspx](http://msdn.microsoft.com/en-us/performance/cc825801.aspx) ) 进行跟踪，我可以帮助您分析 CPU 时间在系统（内核）上下文中花费的位置。Xperf 在 XP 上不受官方支持，但您可以[在 XP 上进行跟踪并在其他系统上对其进行分析](http://blogs.msdn.com/pigscanfly/archive/2008/02/24/xperf-support-for-xp.aspx)。

Xperf 和 Process Explorer 应该能够准确定位导致 CPU 使用率失控的模块。甚至可能不需要符号来诊断问题；简单地说，模块名称通常可以指向正在减慢系统速度的相关组件。例如，来自 ndis.sys 的高 CPU 使用率可能指向网络中断，或者来自 aavmker4.sys 等模块的活动可能指向 AV 软件（在本例中为 Avast！）。

和往常一样，检查您的系统是否有任何更新的驱动程序和 AV 软件。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-22T03:05:06.170

我们在办公室遇到了 Kaspersky 和 ​​Incredibuild 的问题 - 编译，有时链接会挂起并且永远不会完成。

似乎只影响一些奇怪的机器，而且只有 Windows XP（Vista 似乎不受我所见的影响）。到目前为止，我发现的唯一解决方案是完全关闭卡巴斯基 - 所以如果你找到解决方案，请告诉我！

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-27T14:20:21.750

在我的办公室，Incredibuild 和 Spyware Doctor 的免疫功能之间的冲突导致了类似的问题。关闭免疫为我们解决了这个问题。

您使用什么防病毒/恶意软件？

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-10-01T11:49:45.327

在没有任何防病毒软件的干净 Windows 7 上使用 VS2003 中的 IncrediBuild 进行编译时，我遇到了同样的问题。它在 XP 和 Vista 的同一个盒子上运行良好。

# cocoa - 将文件从finder拖到webview时获取文件路径？

> ID：423623
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T08:51:44.937
> 
>         
> 
> 标签：cocoa

我正在用可可开发一个 flvplayer。我想从 finder 中拖出一个 flv 文件并将其放到 webview 窗口中（我用它来查看 flv）。但是我没有来自finder的这个文件的路径。这是我的代码：

```
 _ (void)showflv(nsstring*)aa
{               
    ..........    
    //Register to accept flv drag/drop    
    NSString *pboardType = NSCreateFileContentsPboardType(@"flv");
    NSArray *dragTypes = [NSArray arrayWithObject:pboardType];
    [self registerForDraggedTypes:dragTypes];
}

 _ (BOOL)performDragOperation:(id <NSDraggingInfo>)sender    
{
    NSPasteboard *pboard = [sender draggingPasteboard];     
    if ( [[pboard types] containsObject:NSFileContentsPboardType] ) {
    }
    return YES;
} 
```

我阅读了关于this的文档。我发现PerformDragOperation的函数可以这样写：

```
_ (BOOL)performDragOperation:(id <NSDraggingInfo>)sender
{
    NSPasteboard *pboard = [sender draggingPasteboard];

    if ( [[pboard types] containsObject:NSFileContentsPboardType] ) {
        NSFileWrapper *fileContents = [pboard readFileWrapper];
        // Perform operation using the file’s contents
    }
    return YES;
} 
```

我可以获取这个拖动文件的文件内容。但是如何获取路径？

```
NSString *fileName = [fileContents filename]; 
```

我做了一个测试，它不正确。

* * *

我做了一个测试，但是 DraggedFilePaths 不起作用。我发现代码：

```
NSPasteboard *pboard = [sender draggingPasteboard];

if ( [[pboard types] containsObject:NSFileContentsPboardType] ) {
    //NSFileWrapper *fileContents = [pboard readFileWrapper];
    // Perform operation using the file’s contents
    nslog(@"aa");
} 
```

当应用程序运行时，字符串“aa”没有出现，为什么？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-01-08T09:38:16.060

像这样：

```
NSArray *draggedFilePaths = [pboard propertyListForType:NSFilenamesPboardType]; 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2013-04-30T01:17:06.000

```
NSPasteboard *pastboard = [sender draggingPasteboard];

NSURL *URL = [NSURL URLFromPasteboard:pastboard];

NSLog(@"%@", URL); 
```

# merge - 合并分支实际上是如何工作的（在引擎盖下）？

> ID：423624
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-08T08:52:17.773
> 
>         
> 
> 标签：merge, versioning, theory

这可能是一个幼稚的问题，但是，正如对象中所问的那样，版本控制软件将分支合并回主干而不生成损坏代码的实际方法是什么？

这是一个简单的例子：我从主干中为程序“Hello World Power edition”创建了一个分支。我添加了对克林贡语的支持。这是一个彻底的改变，改变了函数 printHelloWorld() 的工作方式。

同时，由于错误 #749 导致“Hello World”被写成“Helo World”，主干中的函数 printHelloWorld() 已更改。

现在，我在这里看到的问题是：当我通过分支合并回主干时，我在 sayHello.py 文件中的函数 printHelloWorld() 中试验了一个冲突

VCS 程序如何知道如何从我的分支添加克林贡语支持**并将**错误修复保留在主干中？避免这种情况的人为驱动或软件驱动的策略是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T09:08:16.883

> VCS 程序如何知道如何从我的分支添加克林贡语支持并将错误修复保留在主干中？

VCS 对源代码的语义一无所知，它将它视为一堆文本/二进制文件。VCS 系统使用[差异](http://en.wikipedia.org/wiki/Diff3)/[合并](http://en.wikipedia.org/wiki/Merge_(revision_control))算法来检测您的和当前文件版本之间的冲突。解决此类冲突是您的责任，因为只有您知道这些更改的语义。一些像 SVN 这样的 VCS 会要求您在允许您提交更改之前使用中继中的最新更改更新您的工作副本，以确保不会丢失任何内容。

为了确保您没有破坏任何东西并且所有之前的错误修复都没有破坏，您应该使用[代码审查](http://en.wikipedia.org/wiki/Code_review)、[单元测试](http://en.wikipedia.org/wiki/Unit_testing)和其他实践。[持续集成](http://martinfowler.com/articles/continuousIntegration.html)是保持软件健康的好方法。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T08:58:19.977

在这种情况下版本控制系统无法自动合并，您必须手动进行合并。良好的单元测试将帮助您确保不会丢失任何功能。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T08:59:08.900

在您将分支合并回主干之前，版本控制系统将使用您分支后主干中的更改更新您的工作副本。它只是不允许您在没有此更新的情况下合并。这可确保您在下一次提交中获得主干中的所有错误修复。

在分支上工作的一个好策略是定期将主干中的更改移植到您的分支中。这可确保您不会偏离主干太远，导致您最终合并回主干时遇到问题。

# c - 从 C 中的文件名获取 MIME 类型

> ID：423626
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-01-08T08:52:57.117
> 
>         
> 
> 标签：c, mime-types, unix

我想使用 C 从文件名中获取 MIME 类型。有没有办法在不使用包含 MIME 类型和文件扩展名的文本文件（即 Apache 的文件`mime.types`）的情况下做到这一点？

也许有一个函数可以使用文件名获取 MIME 类型？如果不需要，我宁愿不使用文件扩展名。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2013-12-10T17:30:57.643

我刚刚为我正在处理的一个项目实现了这个。libmagic 是您正在寻找的。在 RHEL/CentOS 上，它由 file-libs 和 file-devel 提供。Debian/Ubuntu 似乎是 libmagic-dev。  

[http://darwinsys.com/file/](http://darwinsys.com/file/)

这是一些示例代码：

```
#include <stdio.h>
#include <magic.h>

int main(int argc, char **argv){
  const char *mime;
  magic_t magic;

  printf("Getting magic from %s\n", argv[1]);

  magic = magic_open(MAGIC_MIME_TYPE); 
  magic_load(magic, NULL);
  magic_compile(magic, NULL);
  mime = magic_file(magic, argv[1]);

  printf("%s\n", mime);
  magic_close(magic);

  return 0;
} 
```

下面的代码使用默认的魔法数据库 /usr/share/misc/magic。一旦你安装了开发包，libmagic 手册页就很有帮助。我知道这是一个老问题，但我在寻找相同答案时发现了它。这是我的首选解决方案。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-01-08T08:56:30.870

如果有办法做到这一点，Apache 就不需要它的`mime.types`文件了！

桌子必须在某个地方。它要么位于由您的代码解析的单独文件中，要么被硬编码到您的软件中。前者越清晰越好的解决方案...

也可以通过检查文件的内容来猜测文件的 MIME 类型，即标题字段、数据结构等。这是`file(1)`程序使用的方法，也是 Apache 的`mod_mime_magic`. 在这两种情况下，他们仍然使用单独的文本文件来存储查找规则，而不是在程序本身中硬编码任何细节。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-01-08T10:02:06.713

据我所知，unix 命令`file`使用以下选项输出 mime 字符串`-i`：

```
> file -i main.c
main.c: text/x-c charset=us-ascii 
```

# java - 在 Maven 构建中并行运行 junit 测试？

> ID：423627
> 
>         
> 
> 赞同：114
> 
>         
> 
> 时间：2009-01-08T08:53:37.320
> 
>         
> 
> 标签：java, maven, junit

我正在使用 JUnit 4.4 和 Maven，并且我有大量长期运行的集成测试。

当谈到并行化测试套件时，有一些解决方案允许我在单个测试类中并行运行每个测试方法。但是所有这些都要求我以一种或另一种方式更改测试。

我真的认为在 X 个线程中并行运行 X 个不同的测试类将是一个更清洁的解决方案。我有数百个测试，所以我并不真正关心线程化单个测试类。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：80
> 
>             
> 
> 时间：2012-02-29T11:31:18.833

使用 Maven 插件：

```
<build>
    <plugins>
    <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-plugin</artifactId>
        <version>2.7.1</version>
        <configuration>
            <parallel>classes</parallel>
            <threadCount>5</threadCount>
        </configuration>
    </plugin>
    </plugins>
</build> 
```

* * *

## 回答 #2

> 赞同：42
> 
>             
> 
> 时间：2009-07-08T14:31:26.817

从 junit 4.7 开始，现在可以在不使用 TestNG 的情况下并行运行测试。实际上，从 4.6 开始就可以了，但是在 4.7 中进行了许多修复，这将使其成为一个可行的选择。你也可以使用 spring 运行并行测试，你可以在[这里阅读](http://incodewetrustinc.blogspot.com/2009/07/run-your-junit-tests-in-parallel-with.html)

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2013-05-25T14:46:57.173

受 JUnit 的实验性**[ParallelComputer](https://github.com/junit-team/junit/blob/master/src/main/java/org/junit/experimental/ParallelComputer.java)**跑步者的启发，我构建了自己的**[ParallelSuite](https://gist.github.com/mustafau/5592409)**和**[ParallelParameterized](https://gist.github.com/mustafau/5592505)**跑步者。使用这些运行器可以轻松地并行化测试套件和参数化测试。

**ParallelSuite.java**

```
public class ParallelSuite extends Suite {

    public ParallelSuite(Class<?> klass, RunnerBuilder builder) throws InitializationError {

        super(klass, builder);

        setScheduler(new RunnerScheduler() {

            private final ExecutorService service = Executors.newFixedThreadPool(4);

            public void schedule(Runnable childStatement) {
                service.submit(childStatement);
            }

            public void finished() {
                try {
                    service.shutdown();
                    service.awaitTermination(Long.MAX_VALUE, TimeUnit.NANOSECONDS);
                } catch (InterruptedException e) {
                    e.printStackTrace(System.err);
                }
            }
        });
    }
} 
```

**ParallelParameterized.java**

```
public class ParallelParameterized extends Parameterized {

    public ParallelParameterized(Class<?> arg0) throws Throwable {

        super(arg0);

        setScheduler(new RunnerScheduler() {

            private final ExecutorService service = Executors.newFixedThreadPool(8);

            public void schedule(Runnable childStatement) {
                service.submit(childStatement);
            }

            public void finished() {
                try {
                    service.shutdown();
                    service.awaitTermination(Long.MAX_VALUE, TimeUnit.NANOSECONDS);
                } catch (InterruptedException e) {
                    e.printStackTrace(System.err);
                }
            }
        });
    }
} 
```

用法很简单。只需将**@RunWith**注释值更改为这些**Parallel***类之一。

```
@RunWith(ParallelSuite.class)
@SuiteClasses({ATest.class, BTest.class, CTest.class})
public class ABCSuite {} 
```

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2010-01-02T12:22:57.937

[tempus-fugit](http://tempusfugitlibrary.org/)提供了类似的功能，请查看文档了解详细信息。它依赖于 JUnit 4.7，您只需将测试标记为`@RunWith(ConcurrentTestRunner)`.

干杯

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2011-06-04T05:26:45.813

您可以查看开源库 - [Test Load Balancer](http://test-load-balancer.github.com)。它完全符合您的要求 - 并行运行不同的测试类。这在 ant-junit 级别集成，因此您无需更改测试。我是图书馆的作者之一。

此外，请考虑不要在线程中运行它们，因为您可能需要进程级沙箱。例如，如果您在集成测试中遇到数据库，您不希望一个测试失败，因为另一个测试在不同的线程中添加了一些数据。大多数时候，编写测试时并没有考虑到这一点。

最后，到目前为止，这个问题是如何解决的？

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T11:01:05.177

[TestNG 可以做到这一点](http://testng.org/doc/documentation-main.html#parallel-running)（这是我的第一个反应——然后我看到你已经有很多测试用例了）。

对于 JUnit，请查看[parallel-junit](http://java.net/projects/parallel-junit)。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2013-12-26T11:30:31.673

您可以使用 Junit 本身提供的 ParallelComputer 并行运行测试。这是一个小片段，可以帮助您入门。

```
Class[] cls = { TestCase1.class, TestCase2.class };
Result result = JUnitCore.runClasses(ParallelComputer.classes(), cls);
List<Failure> failures = result.getFailures(); 
```

当您需要从代码运行测试时，这将有所帮助，因为它不依赖于 Maven 或任何其他构建管理工具。

请注意，这将并行运行所有测试用例，如果您在不同测试用例之间有任何依赖关系，则可能会导致误报。无论如何，你不应该有相互依赖的测试。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2019-10-15T15:33:58.567

另一个选择：Punner，一个新的并行 junit runner 和 maven 插件。您不必更改代码，将其复制到您的 pom.xml：

```
<!-- Disable default surefire based testing -->
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-surefire-plugin</artifactId>
  <version>2.20</version>
  <configuration>
    <skip>true</skip>
  </configuration>
</plugin>

<plugin>
  <groupId>com.github.marks-yag</groupId>
  <artifactId>punner-maven-plugin</artifactId>
  <version>${version}</version>
  <configuration>
  </configuration>
  <executions>
    <execution>
      <id>test</id>
      <phase>test</phase>
      <goals>
        <goal>test</goal>
      </goals>
    </execution>
  </executions>
</plugin> 
```

Punner 可以并行运行测试方法，可以单独保持测试输出和清洁。

Punner 将减少您的 mvn 控制台输出，如下所示：

```
[INFO] --- punner-maven-plugin:0.9.13:test (test) @ ipc ---
[INFO] Punner report directory: /Users/guile/workspace/ipc/target/punner-reports
[INFO]
[INFO] com.github.yag.ipc.IPCTest.testConnectionHandler.............. PASSED
[INFO] com.github.yag.ipc.IPCTest.testSequence....................... PASSED
[INFO] com.github.yag.ipc.IPCTest.testPartialContent................. PASSED
[INFO] com.github.yag.ipc.IPCTest.testResponseContent................ PASSED
[INFO] com.github.yag.ipc.IPCTest.testPingPong....................... PASSED
[INFO] com.github.yag.ipc.IPCTest.testServerClose.................... PASSED
[INFO] com.github.yag.ipc.IPCTest.testServerSideHeartbeatTimeout..... PASSED
[INFO] com.github.yag.ipc.IPCTest.testClientSideHeartbeatTimeout..... PASSED
[INFO] com.github.yag.ipc.IPCTest.testClientSideHeartbeat............ PASSED
[INFO] com.github.yag.ipc.IPCTest.testClientReconnect................ PASSED
[INFO]
[INFO] Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 10.952 sec, Time saved: 25.919 sec. 
```

Punner 产生与万能兼容的输出，您还可以从报告目录中获取原始日志数据和降价格式报告：

```
➜  ipc git:(develop) ll target/punner-reports
total 104
-rw-r--r--   1 guile  staff    11K Oct 15 23:07 TEST-com.github.yag.ipc.IPCTest.xml
-rw-r--r--   1 guile  staff   298B Oct 15 23:07 com.github.yag.ipc.IPCTest.txt
drwxr-xr-x  12 guile  staff   384B Oct  8 00:50 logs
-rw-r--r--   1 guile  staff    33K Oct 15 23:07 report.md 
```

Punner 是我的个人项目，我编写 Punner 是为了加快 IPC 框架、细粒度锁定、日志服务、分布式工作流引擎等其他项目的单元测试阶段。它节省了我很多等待时间。

Punner 还不支持某些高级功能。如果你能尝试一下并给我一些反馈，我很高兴。

* * *

## 回答 #9

> 赞同：-3
> 
>             
> 
> 时间：2009-01-08T16:34:22.787

您可以在一分钟内将您的测试更改为 TestNg 测试（您只需要更改导入），TestNG 是并行测试中最好的。

* * *

## 回答 #10

> 赞同：-3
> 
>             
> 
> 时间：2009-04-08T08:23:56.780

您可以尝试[使用 Gridgain](http://www.gridgainsystems.com/wiki/display/GG15UG/JUnit4+-+Distributed+JUnit)，它可以让您在计算网格中运行分布测试。

# asp.net - Telerik 访问 RadGrid 中的 TextBox 列

> ID：423650
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T09:07:27.930
> 
>         
> 
> 标签：asp.net, telerik, radgrid

您是否知道如何访问添加到 radgrid 的文本框，这些文本框未绑定但用于捕获用户在该列的文本框中键入的任何与行相关的输入。发生回发时，我需要访问此数据服务器端。非常感谢您的想法谢谢

托尼

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-12T16:51:57.767

这取决于如何添加/创建这些文本框。如果“未绑定”是指它们位于模板列中，则应该能够在网格的一个事件中使用 .FindControl 来获取该文本框。同样，哪个事件将取决于导致回发发生的原因。出于此代码示例的目的，我假设您正在处理网格上的命令项

```
Private Sub radGrid_ItemCommand(ByVal source As Object, ByVal e As Telerik.WebControls.GridCommandEventArgs) Handles RadGrid1.ItemCommand
  Select Case e.CommandName
    Case "Update"
      Dim txt as Textbox
      txt = e.Item.FindControl("textboxID")
      If Not txt is Nothing Then someObject.someString = txt.Text

    Case Else
      'do something else

End Sub 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：-1
> 
>             
> 
> 时间：2012-11-06T11:01:20.447

```
Private Sub radGrid_ItemCommand(ByVal source As Object, ByVal e As Telerik.WebControls.GridCommandEventArgs) Handles RadGrid1.ItemCommand
  Select Case e.CommandName
    Case "Update"
      Dim txt as Textbox
      txt = e.Item.FindControl("textboxID")
      If Not txt is Nothing Then someObject.someString = txt.Text

    Case Else
      'do something else

End Sub 
```

# opengl - GPU上的纹理图像处理？

> ID：423663
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-01-08T09:16:13.530
> 
>         
> 
> 标签：opengl, image-processing, gpu, textures

我正在将某个场景渲染为纹理，然后我需要以某种简单的方式处理该图像。我现在这样做是使用读取纹理`glReadPixels()`然后在 CPU 上处理它。然而这太慢了，所以我正在考虑将处理转移到 GPU。  

我能想到的最简单的设置是显示一个简单的白色四边形，它在正交投影中占据整个视口，然后将图像处理位写入片段着色器。这将允许处理的许多实例并行运行以及访问处理所需的纹理的任何像素。

这是一个可行的行动方案吗？以这种方式做事很常见吗？有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T09:50:56.987

是的，这是通常的做事方式。

1.  将某些东西渲染成纹理。

2.  绘制一个带有着色器的全屏四边形，该着色器读取该纹理并执行一些操作。

简单的效果（例如灰度、颜色校正等）可以通过读取一个像素并在片段着色器中输出一个像素来完成。更复杂的操作（例如漩涡图案）可以通过从偏移位置读取一个像素并输出一个像素来完成。通过读取多个像素可以完成更复杂的操作。

在某些情况下，需要多个临时纹理。例如，高半径模糊通常是这样完成的：

1.  渲染成纹理。

2.  渲染到另一个（较小的）纹理中，使用一个将每个输出像素计算为多个源像素的平均值的着色器。

3.  使用这个较小的纹理渲染成另一个小的纹理，使用一个可以进行适当的高斯模糊或其他东西的着色器。

4.  ... 重复

但是，在上述所有情况下，每个输出像素都应该独立于其他输出像素。它可以再使用一个输入像素就好了。

一个不能很好映射的处理操作的例子是 Summed Area Table，其中每个输出像素取决于输入像素和相邻输出像素的值。尽管如此，还是可以在 GPU 上执行这些操作（[例如 pdf](http://ati.amd.com/developer/gdc/GDC2005_SATEnvironmentReflections.pdf)）。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T09:52:19.387

是的，这是进行图像处理的正常方式。如果您要为每个像素设置颜色，那么四边形的颜色并不重要。根据您的应用程序，您可能需要注意像素采样问题（即确保您从源纹理上的正确像素进行采样，而不是在两个像素之间进行采样）。

# eclipse - 同步 web 项目依赖 maven -> eclipse

> ID：423673
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T09:21:09.543
> 
>         
> 
> 标签：eclipse, maven-2

我已经安装了 m2eclipse 插件，并且同步 pom.xml 中出现的编译时依赖项没有问题。

现在，我添加了 JPA + Hibernate（或其他）依赖项，maven 在执行`mvn jetty:run`.

问题是，Eclipse 没有。因此，当我从 Eclipse 启动 Web 应用程序时，我不会在引用的 tomcat 上部署那些额外的 .jar。

有没有办法将这种 Web 运行时依赖项添加到 Eclipse 中？不太喜欢手动编辑 org.eclipse.wst.common.component 的想法。

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-01-08T09:29:03.177

我发现任何时候更新项目的 POM 都有助于重新运行 m2eclipse，否则它不会看到新的外部依赖项。

如果您在将新的依赖项（JPA + Hibernate 或其他）添加到 POM 后还没有尝试运行它，那么请试一试，看看它是否有效。

```
mvn clean install eclipse:clean eclipse:eclipse eclipse:m2eclipse 
```

请注意，执行此操作后，您可能需要刷新 Eclipse 项目才能使更改生效。

它可能不需要所有这些论点都起作用，但我在某一点上将它们全部添加，只是为了确定。您可以调整参数列表以使其达到适合您的程度。

这样做可能会破坏您对项目的一些 Eclipse 偏好，因此希望您已经在 POM 中拥有重建项目所需的一切。例如，我的一个 POM 中有一堆额外的东西，以确保在使用 maven 重建 eclipse 项目时将 springnature 和 springbuilder 之类的东西添加到我的 eclipse 项目中。

```
<build>
  <plugins>
    <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-eclipse-plugin</artifactId>
      <configuration>
        <additionalProjectnatures>
          <projectnature>
            org.springframework.ide.eclipse.core.springnature
          </projectnature>
          <projectnature>
            org.eclipse.wst.common.project.facet.core.nature
          </projectnature>
          <projectnature>
            org.eclipse.wst.common.modulecore.ModuleCoreNature
          </projectnature>
          <projectnature>
            org.eclipse.jem.workbench.JavaEMFNature
          </projectnature>
        </additionalProjectnatures>
        <additionalBuildcommands>
          <buildcommand>
            org.eclipse.wst.common.project.facet.core.builder
          </buildcommand>
          <buildcommand>
            org.eclipse.wst.validation.validationbuilder
          </buildcommand>
          <buildcommand>
            org.springframework.ide.eclipse.core.springbuilder
          </buildcommand>
        </additionalBuildcommands>
        <wtpversion>1.5</wtpversion>
      </configuration>
    </plugin>
  </plugins>
</build> 
```

*最后一点是作为警告添加的！如果他们还没有为运行 eclipse:* 命令的后果做好准备，那么他们会讨厌有人使用一个工作的 Eclipse 项目并破坏一堆配置。*

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-01-14T07:09:44.620

我找到了其他解决方案。就我而言，有 WAR 依赖于一些 JAR。一些 JAR 来自依赖项目（并且它们已部署），而一些只是简单的依赖项（hibernate、spring 等）。

我花了几个小时试图确定为什么要部署依赖项目的 JAR 和其他 - 不要。

我的解决方案是**在我的 WAR 项目中创建 WEB-INF/lib 文件夹**！通常你不需要它们，因为 Maven2 在打包阶段创建了这个库。在eclipse中这是必要的。

我的 Eclipse 是 3.6M4，m2eclipse 是 0.9.9.200912160759。

# html - 列在表格中扩展为“以百分比给出的文本框宽度”

> ID：423677
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-08T09:26:16.973
> 
>         
> 
> 标签：html, scripting, dhtml

我正在使用以下代码

**--- 编辑@annakata：**添加完整代码

```
<HTML>
 <HEAD>
  <TITLE> New Document </TITLE>
 </HEAD>

 <BODY>
  <table id="additionalContactsTable" name="additionalContactsTable"
                                        width="100%"
                                >
                                        <thead>
                                                <tr>
                                                        <th style="text-align: center" class="Ntablerow1RightDark" width="25%"><b>Last</b> </th>
                                                        <th style="text-align: center" class="Ntablerow1RightDark" width="25%"><b>First</b> </th>
                                                        <th style="text-align: center" class="Ntablerow1RightDark" width="25%"><b>Middle</b> </th>
                                                        <th style="text-align: center" class="Ntablerow1RightDark" width="25%"><b>Email</b> </th>
                                                <tr>
                                        </thead>
                                        <tbody>

                                                <tr>

<td class="NcontextlabelboldNormal" height="24">  <input maxlength="256"
        type="text" name="additionalContact" style="width: 90%;"
        value="aaaaaaaaaaa aaaaaaaaaaaaaaaaaaa aaaaaaaa aaaaaaaaaaaa aaaaa aaaaaaaaaaaaaaa" > </td>
        <td class="NcontextlabelboldNormal" height="24">  <input maxlength="256"
        type="text" name="additionalContact" style="width: 90%;"
        value="aaaaaaaaaaaaaaaaaaaaaaaaaa" > </td>
        <td class="NcontextlabelboldNormal" height="24">  <input maxlength="256"
        type="text" name="additionalContact" style="width: 90%;"
        value="aaaaaaaaaaaa aaaaaaaa aaaaaaaaaab bbbbbbbb bbbbbbbbbbbbbbbb" > </td>
        <td class="NcontextlabelboldNormal" height="24">  <input maxlength="256"
        type="text" name="additionalContact" style="width: 90%;"
        value="aaaaaaaa  aaaaaa aaaaaaa aaaaa" > </td>

 </BODY>
</HTML> 
```

当用户输入大文本时，会出现问题，文本框会展开并且表格会变形。如果我将 size="30" 放在那里，扩展问题是固定的，但在不同的分辨率下，结构的行为会有所不同。

任何修复或炒锅以优雅地实现所需？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T09:37:50.303

好的，我现在可以清楚地看到它在 IE 中的复制。

这似乎是 IE 中的一个错误（IE 在百分比方面存在臭名昭著的问题），具体取决于以下情况：

*   输入在表格中

*   并且输入的大小以百分比为单位

*   并且输入有一个超过宽度的默认值（即在标记中）

因此存在一些明显的解决方法：

*   将输入`<div>`改为浮动布局（如果语义正确，我会这样做）

*   以单位为单位的尺寸宽度，例如`em`（最好）或`px`（如果您的设计负担得起）

*   加载后用客户端脚本注入值（这是一个糟糕的解决方案，*不*要这样做）

如果您需要表格和百分比*，*我会推荐一种不明显的解决方法：

*   仅 IE 的 CSS 规则`width: expression(this.parentNode.offsetWidth*0.9);`

希望这可以帮助。

*（之前的回答请求代码已删除）*

* * *

**编辑：**基于您的示例的代码片段，适用于 IE + FF

```
<style>
/* table method */
table {width: 100%;}
th {width: 25%; text-align: center; font-weight: 700;}
td {height: 24px; width: 25%;}
td input {overflow: hidden; width: 90%; }
/* IE only correction */
* html td input {width: expression(this.parentNode.offsetWidth*0.9);}

/* float method */
#foo {width: 100%;background:blue;}
#foo div {float:left; width: 25%;}
#foo div  input {width: 90%;}
 </style>

<table>
    <thead>
            <tr>
                    <th>Last</th>
                    <th>First</th>
                    <th>Middle</th>
                    <th>Email</th>
            <tr>
    </thead>
    <tbody>
            <tr>
                <td>
                    <input maxlength="256" type="text" name="additionalContact" value="aaaaaaaaaaa aaaaaaaaaaaaaaaaaaa aaaaaaaa aaaaaaaaaaaa aaaaa aaaaaaaaaaaaaaa" /> 
                </td>
                <td>
                    <input maxlength="256" type="text" name="additionalContact" value="aaaaaaaaaaaaaaaaaaaaaaaaaa" /> 
                </td>
                <td>
                    <input maxlength="256" type="text" name="additionalContact" value="aaaaaaaaaaaa aaaaaaaa aaaaaaaaaab bbbbbbbb bbbbbbbbbbbbbbbb" /> 
                </td>
                <td>
                    <input maxlength="256" type="text" name="additionalContact" value="aaaaaaaa  aaaaaa aaaaaaa aaaaa" /> 
                </td>
            </tr>
    </tbody>
</table>

<div id="foo">
    <div>
        <input maxlength="256" type="text" name="additionalContact" value="aaaaaaaaaaa aaaaaaaaaaaaaaaaaaa aaaaaaaa aaaaaaaaaaaa aaaaa aaaaaaaaaaaaaaa" > 
    </div>
            <div>
        <input maxlength="256" type="text" name="additionalContact" value="aaaaaaaaaaaaaaaaaaaaaaaaaa" > 
    </div>
            <div>
        <input maxlength="256" type="text" name="additionalContact" value="aaaaaaaaaaaa aaaaaaaa aaaaaaaaaab bbbbbbbb bbbbbbbbbbbbbbbb" > 
    </div>
            <div>
        <input maxlength="256" type="text" name="additionalContact" value="aaaaaaaa  aaaaaa aaaaaaa aaaaa" > 
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-11T19:42:54.593

我使用以下代码来解决这个问题

```
...
<td width="100%">
  <table style="table-layout:fixed;width:100%">
    <tr>
      <td style="padding-right:7px;">
        <input style="width:100%;" type="text"/>
      </td>
    </tr>
  </table>
</td>
... 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-10-13T17:55:20.540

刚刚解决了自己这个问题，然后我就摔倒了...

将文档类型定义更改为

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> 
```

但要注意页面的其他部分不要开始跳来跳去。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-11-03T09:30:17.163

使用 CSS 规则宽度：表达式（this.parentNode.offsetWidth*0.9）；解决了我的问题..宾果！

# ruby - 在这种情况下使用收集会更好吗？

> ID：423678
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T09:27:12.277
> 
>         
> 
> 标签：ruby

我刚开始使用 Ruby，我已经编写了一些代码来对 CSV 文件进行基本解析（Line 是一个基本类，为简洁起见省略）：

```
class File

  def each_csv
    each do |line|
      yield line.split(",")
    end
  end

end

lines = Array.new

File.open("some.csv") do |file|
  file.each_csv do |csv| 
    lines << Line.new(:field1 => csv[0], :field2 => csv[1])
  end
end 
```

我有一种感觉，我最好以`collect`某种方式使用而不是将每个都推`Line`到阵列上，但我不知道该怎么做。

任何人都可以告诉我如何做到这一点，或者它是否完全正常？

**编辑：**我应该明确表示我实际上不会在生产中使用这段代码，更多的是习惯于语言的结构。不过，知道有库可以正确执行此操作仍然很有用。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T11:01:04.737

这是一个（可能很疯狂）的想法，使用 Struct 类而不是滚动您自己的简单 POD 类。但是你想要的是有一个构造函数，它接受可以从文件数据生成的所有参数。

```
Line = Struct.new(:field1, :field2, :field3) 
```

然后在算法的核心你想要这样的东西：

```
File.open("test.csv").lines.inject([]) do |result, line|
    result << Line.new(line.split(",", Line.length))
end 
```

或者更简洁和类似功能：

```
lines = File.open("test.csv").lines.map { |line| Line.new(line.split(",", Line.length)) } 
```

老实说，我并没有过多地使用 Struct 类，但我应该使用它，而且我可能会重构已经编写好的东西来使用它。它允许您按名称访问变量，例如：

```
Line.field1 = blah
Line.field2 = 1 
```

Ruby[结构](http://www.ruby-doc.org/core/classes/Struct.html)类。

因此，要**真正回答您的问题**，并查看上面的代码，我会说使用 collect/map 来执行计算会简单得多。map 功能和注入功能非常强大，我发现我经常使用它们。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T09:58:10.573

我不知道你是否知道，但是 ruby​​ 有[它自己的](http://ruby-doc.org/stdlib/libdoc/csv/rdoc/index.html)用于解析和编写 CSV 文件的类。

我找到了一个使用 collect 将 csv 文件转换为哈希数组的示例。

```
def csv_to_array(file_location)
  csv = CSV::parse(File.open(file_location, 'r') {|f| f.read })
  fields = csv.shift
  csv.collect { |record| Hash[*(0..(fields.length - 1)).collect {|index| [fields[index],record[index].to_s] }.flatten ] }
end 
```

这个例子取自[这篇文章](http://6brand.com/ruby-parsing-csv-files-quickly.html)。

如果您不熟悉 * 概念，它基本上会分解外部 [] 括号，将数组转换为逗号分隔的元素列表。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T09:58:30.700

您是否看过 FasterCSV，它完成了您在此处尝试做的事情，以及处理您在某些 CSV 文件中发现的一些脑死问题

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T10:26:11.423

看看它是如何为你工作的（函数式编程很有趣！）：

尝试使用注入。Inject 将起始“累加器”作为参数，然后是两个参数块：

```
[1,2,3].inject(0) { |sum,num| sum+num } 
```

自然是6

```
[1,2,3].inject(5) { |sum,num| sum+num } 
```

是 11

```
[1,2,3].inject(2) { |sum,num| sum*num } 
```

是 12

重点：

```
class Line
  def initialize(options)
    @options = options
  end

  def to_s
    @options[:field1]+" "+@options[:field2]
  end
end

File.open("test.csv").lines.inject([]) do |lines,line|
  split = line.split(",")
  lines << Line.new(:field1 => split[0],:field2 => split[1])
end 
```

# php - 动态创建子类

> ID：423679
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T09:27:27.143
> 
>         
> 
> 标签：php, class, oop

我正在使用 Kohana，刚刚在他们的自动加载方法中找到了这段代码

```
 // Class extension to be evaluated
        $extension = 'class '.$class.' extends '.$class.'_Core { }';

        // Start class analysis
        $core = new ReflectionClass($class.'_Core');

        if ($core->isAbstract())
        {
            // Make the extension abstract
            $extension = 'abstract '.$extension;
        }

        // Transparent class extensions are handled using eval. This is
        // a disgusting hack, but it gets the job done.
        eval($extension); 
```

基本上它的作用是当我引用一个不存在的类时（通过对象实例化，调用 class_exists() 等），Kohana 将创建一个类（例如 Foo），它扩展了一个遵循特定命名约定的库类（例如 Foo_Core）。只是好奇，有没有办法做类似的事情但不使用 eval？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T10:39:32.130

如果您正在寻找创建一个动态类，那么`eval()`goto 函数（*双关语*）就是相关的，我发现您可以将类声明放在`if-then`语句中。因此，您可以执行以下操作：

```
if(true)
{
    class foo
    {
       // methods
    }
} 
```

我用它来检查动态创建的类（来自配置文件）是否是当前的……如果是，则加载该类，否则……重新生成该类并加载新的类。因此，如果您出于类似原因希望创建动态类，这可能是一个解决方案。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T09:36:23.443

我认为你坚持[`eval()`](http://www.php.net/eval)这一点。

它被标记为“令人作呕的黑客”，这样就可以了:)

我很想知道你对这样一个空的班级做了什么......

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T09:40:42.590

如果您希望能够缓存动态创建的类，则可以将其写入文件并要求它。这可以被认为同样是hack-ish，但它是一种选择。对于创建一次并经常使用的类，它可能是一个很好的解决方案。对于每次都需要动态的类，坚持使用 eval 可能是最好的解决方案。

```
$proxyClassOnDisk = '/path/to/proxyCodeCache/' . $clazz .'.cachedProxyClass';
if ( ! file_exists($proxyClassOnDisk) ) {
    // Generate the proxy and put it into the proxy class on disk.
    file_put_contents($proxyClassOnDisk, $this->generateProxy($object));
}
require_once($proxyClassOnDisk); 
```

在此示例中，您的想法是为`$object`. `$this->generateProxy($object)`将返回看起来或多或少类似于`$extension`原始问题中的字符串。

这绝不是一个完整的实现，只是一些伪代码来显示我所描述的内容。

# reporting-services - 按 SSRS 2005 中的报告项目分组 - 文本框 - 任何解决方法？

> ID：423680
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T09:27:29.997
> 
>         
> 
> 标签：reporting-services, reporting, grouping

我想按报告项目分组，但这是不允许的。所以我尝试创建一个参数......也不允许。尝试从页脚引用...再次失败。

这有点复杂。让我解释：

我有 textbox22，它的值是：

```
=Code.Calc_Factor(Fields!xx.Value, fields!yy.Value...) 
```

这是报表中嵌入的 VB 代码，为每一行调用以计算标准因子。

现在要计算与标准因子的偏差，我使用 textbox89，其值为：

```
=(Fields!FACTOR.Value - ReportItems!textbox22.Value)/ReportItems!textbox22.Value 
```

不要混淆`Fields!FACTOR.Value`和`textbox22.Value`，它们是不同的。
`Fields!FACTOR.Value`是使用的因子，`textbox22.Value`它应该是什么（标准因子）。

现在我想创建一个组，将偏差分成 2 组，> 1% 或不。所以我尝试创建一个组：

```
=IIF(ReportItems!textbox89.Value > 1,0,1) 
```

...但随后 SSRS 抱怨使用报告项目。

我过去也遇到过使用报表项的类似问题，但这是一个新案例！

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T14:15:46.453

您是否尝试将计算字段添加到数据集中？

下面是它的工作原理：

*   当您在报表的布局视图中时，打开“数据集”工具窗口（在我的环境中它位于左侧）。

*   右键单击您正在使用的数据集并添加一个字段，您可以使用计算字段，并适当地构建您的公式

*   然后你*应该*能够在这个领域进行分组

-担

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T09:51:14.177

我不是 100% 有人不会为此提供一些神奇的解决方案，但我自己过去也遇到过类似的问题。我相信（但可能是错误的）Reporting Services 遇到的问题是它只呈现一次，而您要求它做的是在呈现它不执行的分组之前呈现数据。

我能够产生我需要的确切结果的唯一方法是使数据呈现仅在 SQL 中发生（通常通过使用表变量），然后仅将 Reporting Services 用作显示平台。这将要求您的因式分解算法在存储过程中的 T-SQL 中表达，您可能必须编写以使数据成形。这似乎是实现最终结果的唯一方法。

这具有将报表设计和演示与数据操作分开的额外功能。

抱歉，我无法提供 SSRS 解决方案，也许其他人会知道更多。

# visual-studio - 你在 Visual Studio 中为 SVN 使用哪个插件？

> ID：423687
> 
>         
> 
> 赞同：49
> 
>         
> 
> 时间：2009-01-08T09:32:14.760
> 
>         
> 
> 标签：visual-studio, svn, version-control, visualsvn, ankhsvn

我正在考虑将 SVN 用于我的 .Net 项目，并且我想知道哪些插件可用于将源代码控制功能直接集成到 Visual Studio IDE 中。

我已经知道以下 Visual Studio 扩展：

1.  [VisualSVN](http://www.visualsvn.com/)，看起来很棒但不是免费的。它被实现为低级 VS 包扩展。有人在用吗？

2.  [AnkhSVN](http://ankhsvn.open.collab.net/)，它是免费的，但我听说它有点问题。它被实现为 VS 插件扩展。有人在用吗？你遇到问题了吗？**编辑：** 2.0 版本完全重写，似乎解决了我听说的问题（与 1.x 版本有关）

3.  **编辑**：[TortoiseSVN](http://tortoisesvn.tigris.org/) + [Mindscape 的 FileExplorer VS Extension](http://www.mindscape.co.nz/Products/vsfileexplorer/default.aspx)，它不是真正的 IDE 集成，但在某种程度上简化了 Visual Studio 中 TortoiseSVN 的使用。

**编辑**：我在[这里](https://stackoverflow.com/questions/18010/is-ankhsvn-any-good)、[这里](https://stackoverflow.com/questions/283311/source-control-with-visual-studio-switch-from-visualsvn-to-ankh)和[这里](https://stackoverflow.com/questions/24045/ankhsvn-versus-visualsvn)找到了一些 AnkhSVN 和 VisualSVN 之间的比较帖子。

* * *

## 回答 #1

> 赞同：24
> 
>             
> 
> 时间：2009-01-08T09:35:45.970

过去一年我一直在使用 AnkhSVN，我从来没有遇到过问题。我在它和 TFS 之间切换，有时我认为我更喜欢 AnkhSVN 而不是 TFS。

* * *

## 回答 #2

> 赞同：18
> 
>             
> 
> 时间：2009-01-08T09:37:17.670

我使用 VisualSVN，效果很好，但你是对的，它不是免费的。在这里没有使用 Ankh 的经验。

* * *

## 回答 #3

> 赞同：11
> 
>             
> 
> 时间：2009-01-08T09:43:50.480

AnkhSVN 的早期版本（1.X）非常不稳定。最新版本 ( [v2.0.x](http://blogs.open.collab.net/svn/2008/07/ankhsvn-20-fina.html) ) 作为原生 VisualStudio 源代码控制提供程序工作，并且非常稳定。我建议您自己下载并尝试。

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2009-01-08T09:40:38.253

我也使用 AnkhSVN，它确实可以正常工作，但我倾向于使用文件系统来使用 TortoiseSVN。出于某种原因，我觉得使用 Tortoise 更安全。我认为这来自对 Visual Studio 的担忧，而不是 AnkhSsvn。

* * *

## 回答 #5

> 赞同：6
> 
>             
> 
> 时间：2009-01-08T09:39:24.623

我试过 AnkhSVN，但不喜欢它。它试图在幕后自动做太多的事情（例如，将文件添加到 SVN）。如果我确切地看到发生了什么，我更喜欢。

现在我主要使用 TortoiseSVN（在 Visual Studio 之外）或有时在 Visual Studio 中使用**[Mindscape VS FileExplorer](http://www.mindscape.co.nz/Products/vsfileexplorer/default.aspx)**（免费提供）。

注意：VS FileExplorer 插件只是在 VS 中显示一个文件浏览器，并允许您从那里调用 TortoiseSVN（它还显示 TortoiseSVN 覆盖图标）。

**更新**：

我重新安装了当前版本的 AnkhSVN 2.0.5250 并尝试在示例解决方案中重现上述问题。

结果：AnkhSVN 完全符合我的预期。我无法重现任何问题。我认为可能是时候再尝试一次 AnkhSVN 了！

**更新 2**：

我现在使用 AnkhSVN 已经有几天了，我不得不说它工作得很好。与之前的版本（1.x）相比，这是一个很大的改进。

* * *

## 回答 #6

> 赞同：5
> 
>             
> 
> 时间：2009-01-08T09:40:27.460

我使用 AnkhSVN，没有任何值得抱怨的问题。有时（大约 10 次中的 1 次？）我在尝试提交时确实遇到了一个奇怪的无法描述的错误，但重新启动 VS 总是可以解决问题。

编辑：错误实际上似乎来自数据集设计器，而不是 AnkhSVN。有时我会在尝试“读取或写入受保护的内存”时遇到错误，然后一直持续到我重新启动 VS。对困惑感到抱歉。

* * *

## 回答 #7

> 赞同：5
> 
>             
> 
> 时间：2009-05-21T13:43:47.483

我已经分别使用了 AnkhSVN 和 VisualSVN 大约 6 个月。我更喜欢 VisualSVN 仅出于一个原因：兼容性。

在我的工作中，我们使 Subversion 服务器和 TortoiseSVN 软件保持最新（有些人只使用一个版本并坚持使用多年，但这不是我们的风格）。新版本有时会出现新的工作副本格式，似乎 AnkhSVN 适应这些新格式的速度很慢。此时发生的事情是 AnkhSVN 完全崩溃：

*   所有源文件都显示为“已添加”，即使它们都已提交。

*   我们不再能够提交。出现一个错误，声称它无法识别新格式。

VisualSVN 在这方面一直“在球上”，因为我们从未遇到过与他们的软件的任何兼容性问题。仅这个因素就很容易让我转向 VisualSVN。

* * *

## 回答 #8

> 赞同：5
> 
>             
> 
> 时间：2009-10-06T12:52:16.987

[Agent SVN](http://www.zeusedit.com/agent)插件很好地集成了 Subversion 和 Visual Studio，但它也不是免费的。

* * *

## 回答 #9

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T10:27:54.960

对视觉 SVN 的另一票。老实说，我认为只是我懒惰。我可以只使用 tortoise 来完成视觉 svn 所做的所有事情，但它使我免于在程序之间切换。使用视觉 svn 获得的彩色编码警告灯很好，但没什么大不了的。

* * *

## 回答 #10

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T23:44:22.840

我使用VisualSvn，它很好。它并不昂贵，它有助于确保您包含已添加到解决方案中的所有文件。在 svn 中使用锁定时效果不是很好（但是 svn 不擅长锁定文件）。如果你想编辑一个设置了需要锁定的文件，它会在你锁定它时自动更新它（明智的），但是当你不想要它时，它最终可能会进行更新。

我也开始尝试使用[Svn Monitor](http://www.svnmonitor.com/default.shtml)并对此感到满意，但它似乎确实让我的电脑停了下来。

我尝试过旧版本的 ANKH，但一团糟并损坏了 svn 存储库（我怀疑是 1.x 版），所以我猜以后的版本会更好。

* * *

## 回答 #11

> 赞同：3
> 
>             
> 
> 时间：2009-01-23T12:11:06.363

我使用 VisualSVN，并且喜欢它。它可能不是免费的，但我发现它非常可靠，集成得非常好，并且非常值得每个许可证 49 美元。通过设置一些键绑定，提交和更新几乎成为我整个团队的第二天性（他们中的大多数人以前没有 SVN/SCC 经验）。

能够快速扫描解决方案资源管理器以查看哪些文件已更改对于密切关注编写状态报告之类的事情非常有用（但这可能是我过于专制的经理所特有的）。

“来自 SVN 的结帐解决方案”功能非常适合快速设置暑期实习生并为他们提供版本控制的温和介绍。同样，这可能特定于我们的需求，因此您可能不感兴趣。

所以对 VisualSVN 和它给我们的便利点赞。

* * *

## 回答 #12

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T22:11:54.557

我使用 AnkhSVN 的经验比 tortoise 好，但它仍然存在许多使用原生 Visual Studio 插件（如 Source Safe、TFS、Dynamic soft）**确实没有的缺陷。**.svn 文件夹和同步确实存在问题，因此您最终会花费部分时间删除 .svn 文件夹并重新开始。

这就是我的经验。一个示例是将文件夹从一个项目（在同一解决方案中）移动到另一个项目。它从不同的工作集打破了这一点。解决方案是进入文件夹并删除 .svn 文件，但这似乎需要付出很多努力。

我已经习惯了它作为我的文件系统的镜像，以及基本的 2 个开发人员文件分支。

* * *

## 回答 #13

> 赞同：1
> 
>             
> 
> 时间：2012-03-16T16:34:00.097

AnkhSVN 插件还不错。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2013-11-11T07:54:55.143

I use [vsTortoise](http://vstortoise.codeplex.com/). 

It works very nice especially when you are familiar with TortoiseSVN and it's free. 

# html - 如何在 HTML 中正确显示德语字符？

> ID：423693
> 
>         
> 
> 赞同：28
> 
>         
> 
> 时间：2009-01-08T09:35:43.023
> 
>         
> 
> 标签：html, unicode, localization

我的页面包含德语字符，并且我在 HTML 标记之间键入了文本，但浏览器以不同的方式查看某些字符。我是否需要在 HTML 中包含任何内容才能正确显示德语字符？

```
<label> ausgefüllt </label> 
```

* * *

## 回答 #1

> 赞同：72
> 
>             
> 
> 时间：2009-01-08T09:59:19.217

看来您需要一些基本的解释，不幸的是，即使是大多数程序员也无法正确理解。

像 HTML 页面这样的文件作为字节序列在 Internet 上保存和传输，但您希望它们显示为字符。为了将字节转换为字符，您需要一组称为[字符编码](http://en.wikipedia.org/wiki/Character_encoding)的规则。不幸的是，历史上出现了许多不同的字符编码来处理不同的语言。它们中的大多数基于美国[ASCII](http://en.wikipedia.org/wiki/ASCII)编码，但是一旦您有 ASCII 以外的字符（例如[德语变音符号](http://en.wikipedia.org/wiki/Germanic_umlaut)），您就需要非常小心使用哪种编码。

问题的根源在于，为了正确解码 HTML 文件，浏览器需要知道要使用哪种编码。您可以通过以下几种方式告诉它：

*   [“内容类型”HTTP 标头](http://www.w3.org/International/O-HTTP-charset)

*   [HTML 元标记](http://www.webmarketingnow.com/tips/meta-tags-uncovered.html#content-type)

*   使用[XHTML](http://en.wikipedia.org/wiki/XHTML)时的[XML 编码属性](http://www.opentag.com/xfaq_enc.htm#enc_howspecifyfordoc)

因此，您需要**选择一种编码，使用该编码保存 HTML 文件，并确保您至少以上面列出的一种方式声明该编码**（如果您使用多种方式，请确保他们同意）。至于使用什么编码，德国人经常使用[ISO/IEC 8859-15](http://en.wikipedia.org/wiki/ISO/IEC_8859-15)，但[UTF-8](http://en.wikipedia.org/wiki/UTF-8)越来越成为规范，可以同时处理任何类型的非 ASCII 字符。

* * *

## 回答 #2

> 赞同：34
> 
>             
> 
> 时间：2009-01-08T09:40:51.267

UTF-8 是你的朋友。

尝试

```
<META HTTP-EQUIV="content-type" CONTENT="text/html; charset=utf-8"> 
```

并检查您的网络服务器在标头中发送的编码。

如果您使用 PHP，您可以通过这种方式发送您自己的标头（您必须将其放在任何其他输出之前）：

```
<?php header('Content-Type: text/html; charset=utf-8'); ?> 
```

还要仔细检查您是否将文档保存为 UTF-8。

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2012-05-15T08:15:59.577

尝试博客文章*[德语字符编码问题](http://allinoneissues.blogspot.jp/2012/05/german-characters-encoding-issue.html)*(2012-05-10) 中的解决方案：

```
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"/> 
```

* * *

## 回答 #4

> 赞同：6
> 
>             
> 
> 时间：2009-01-08T09:51:41.180

你试过`&uuml;`（ü）和`&Uuml;`（ü）吗？

[您可以在此处](http://lookuptables.com/)找到如何键入其他字母。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2012-11-18T12:46:46.100

宣布`<META HTTP-EQUIV="content-type" CONTENT="text/html; charset=utf-8">`

并且在保存文件时，例如在记事本中，选择另存为 UTF-8 而不仅仅是 .txt。

这应该使字符正常。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2014-11-12T18:39:05.350

您可以尝试 utf8_encode() 或 utf8_decode() 函数。检查这些函数是否有效。

例如`<?php echo utf8_encode('ausgefüllt'); ?>`

希望它会奏效。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T09:38:17.683

听起来像是一个字符编码问题，因为文件被保存为与网络服务器所说的不同的字符编码。

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T10:53:18.403

我不喜欢使用 HTML 实体（如 %uuml;），只有当你的字符集有问题时才需要它们。

简而言之：

正确的方法是修复你的字符集。

简单的方法是只使用实体。您可能永远不会看到任何问题。

跟踪字符集错误可能非常困难。如果你给我们一个可以看到问题的 URL，我们可能会给你一个很好的提示。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2020-08-15T13:35:06.693

[![在此处输入图像描述](https://i.stack.imgur.com/d5XVD.png)](https://i.stack.imgur.com/d5XVD.png)

使用 UTF8 保存为您的文件，并使用此 META：

```
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"/> 
```

# sql-server-2005 - 撤消对数据库中表的更改

> ID：423701
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T09:38:09.740
> 
>         
> 
> 标签：sql-server-2005, xsd, commit

我的申请有以下程序。

存在一个产品数据库（20,000 行）。

我们的客户具有“导入”功能，可以在其中导入 excel 文件。

这是通过删除所有产品表行，然后进行导入来实现的——这是一件很长的事情，因为我们以编程方式对数据执行计算。

明显的问题是，如果“导入”操作失败（IO 内容），他们现在在产品表中没有/部分/curropt 数据。

我们希望如果“导入”操作失败，原始数据仍然存在。

这是 ASP.NET 应用程序，用 C# 编写，使用 SQL Server 2005 并使用我们通过 VS2005 设计工具创建的 XSD。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T09:47:14.513

1.  开始交易

2.  从表中删除数据

3.  插入新数据

4.  如果没有问题发生，提交更改

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T09:45:25.250

我会将数据导入到与您的产品表具有相同结构的表中，然后在您对导入成功感到满意后替换产品表上的数据。

这意味着用户可以在导入过程中继续使用系统，并在您更新产品表时最大限度地减少停机时间。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T09:59:06.190

在这里使用事务将是显而易见的选择。

我想我要问的第一件事是你真的需要清理整个桌子吗？是否有时间戳或可以用来限制需要刷新的数据量的东西？您能否重新设计逻辑以使用更新而不是所有删除和插入？这样你的交易会更小。

-担

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T10:11:43.463

我会采用上述交易方法。但我能看到的唯一问题是，您最终可能会在导入过程发生的整个期间锁定整个表。你可能需要考虑一下。单独的表方法可以是解决方案之一。

# java - 使用哪一个，int 或 Integer

> ID：423704
> 
>         
> 
> 赞同：71
> 
>         
> 
> 时间：2009-01-08T09:38:49.693
> 
>         
> 
> 标签：java, database, performance, types, primitive

我需要创建一个数据传输对象，用于存储从数据库中检索到的记录。在这个数据传输对象中，我需要声明一个数字字段。对于哪个更好 - **int**或**Integer**

如果我将字段定义为整数，如果我要从数据库中检索超过 2000 条记录，是否会因为“整数”类型而对性能产生任何影响！？

提前致谢。

* * *

## 回答 #1

> 赞同：141
> 
>             
> 
> 时间：2009-01-08T09:44:03.847

`Integer`是更好的选择，因为它可以处理`null`；对于`int`,`null`会变成`0`, 默默地，如果`resultSet.getInt(..)`使用的话。否则，它可能会抛出一些异常，例如“无法设置`null`为原始属性”。

性能在这里无关紧要。

*   如果您选择`int`，您最终将添加额外的处理代码；这对你没有多大好处。你的代码不会干净直接，大量的样板代码，你甚至不会获得性能。

*   让我说清楚，对于数据库，null 与零不同。有时您最终会进入预期的`0`位置。`null`想象一下用户提交了一个表单，但没有为`int`. 默认情况下，您最终会得到`0`。`not null`当该字段在数据库中时，这是有意义的，或者确实如此。

* * *

## 回答 #2

> 赞同：23
> 
>             
> 
> 时间：2009-01-08T09:54:36.150

你真的应该根据你需要你的对象做什么而不是性能成本来做出决定。一旦使用分析器确定了速度问题，就应该根据性能做出决定——这是万恶之源。

查看两者的一些功能并将其用于您的决定，例如

*   `Integer`可以`null`，`int`不能。那么`int`在*数据库*中是一个`Nullable`字段吗？

*   您需要访问`Integer`类方法吗？

*   你在做算术吗？

就个人而言，我总是选择原语而不是包装器。但这只是一种偏好，而不是基于任何技术优点。

* * *

## 回答 #3

> 赞同：12
> 
>             
> 
> 时间：2009-01-08T10:54:00.180

在我看来，将某物声明为 int 或 Integer 之间的选择只是归结为 null 是否是它的有效值。自动装箱（和自动拆箱）将处理数字必须是一种或另一种类型的任何转换问题。在几乎所有情况下，性能（正如已经指出的）也不太可能引人注目。

此外， int 应该是自然的选择，如果这是一个问题，它可能是性能最高的。如果您需要能够存储空值，那么您**必须**使用 Integer（并且还要确保对于仅采用整数的方法不会自动取消装箱空引用，因为这将导致 NullPointerException）。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2009-01-08T09:43:31.760

`Integer`理论上比 慢`int`，但是除非您处理数字，否则性能影响应该是最小的。JIT 优化也将减少性能损失。

在原始类型或引用类型方面使用更适合您的情况的一种。

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2010-11-04T06:30:04.120

int 比整数快 10 倍

我们使用 jetm 性能库测试此代码

```
int n;
EtmPoint point1 = etmMonitor.createPoint("test:objects");
for (n = 0; n < 1000000; n++) {
    Integer t = 0;
    t = 10;
    t = 11;
}

point1.collect();
EtmPoint point = etmMonitor.createPoint("test:primitives");
for (n = 0; n < 1000000; n++) {
    int t = 0;
    t = 10;
    t = 11;
}
point.collect();

etmMonitor.render(new SimpleTextRenderer()); 
```

结果：

test:objects 10.184 

test:primitives 1.151

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-03-30T06:04:13.360

为了给您一个想法，2000 Integer 会为您的查询增加大约 0.5 毫秒。如果你必须序列化这些数据，它可能会增加很多。

但是，正确性应该是第一位的。速度很快但错误是没有意义的。您必须考虑空值以及如何处理它们。（除非该列不是 NULL）您可以使用 Integer.MIN___VALUE 或者您可以使用*long*字段而不是 int 并将 Long.MIN_VALUE 用于 null。即使它比 int 大，它仍然会比 Integer 小很多倍并且效率更高。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T09:45:06.887

我想这取决于您用于访问数据库的内容。使用普通的旧 JDBC，您可以使用`int`s，而 ORM 可以静默地将它们转换为`Integers`无论如何。并且 Integer 将允许您处理*nulls*。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2015-10-17T17:43:36.720

`int`被java用于大多数计算。  `Integer`用于除原始数组之外的所有形式的集合。

使用大量临时整数来破坏垃圾收集器并在后台使用不可分析的 CPU，这将导致一切普遍放缓。每秒丢弃的临时对象过多会导致 CG 进入紧急“我现在需要内存”模式，这可能会导致延迟关键应用程序（即：实时交互式图形、物理设备控制器或通信）停止

所以对我来说，如果我有很多不做数学运算但访问很多集合的嵌套调用，例如使用映射的键，我使用 Integer 以避免在传递参数时大量自动装箱。

如果操作是数学密集型或用作循环计数器或其他面向数学的操作，并且未存储在集合中（原始数组除外），我使用原始。除了 String 之外的所有其他原语也是如此，它是一个成熟的对象。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2012-11-28T11:56:41.633

`int`不能`String`使用`toString`or强制转换为`(String)`。

`Integer`可以`String`使用`toString`or进行转换`(String)`，并且可以处理`null`.

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2017-07-12T10:03:05.157

如果你想检查一个`null`值，那么`Integer`最好，但如果你想比较整数，那么 int 可能会更好。在下面的示例中，我使用整数 c= 1000 和 d= 1000 并比较它返回 false 但在 int 的情况下它们将返回 true。

```
public class IntegerCompare {

    public static void main(String[] args) {
        int a = 1000;
        int b = 1000;

        Integer c = 1000;
        Integer d = 1000;

        if (a == b) {
            System.out.println("int Value Equals");

        }
        if (c == d) {
            System.out.println("Integer value Equals");

        } else {

            System.out.println("Integer Value Not Equals");
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2019-03-05T15:39:51.620

要涵盖的一种情况是验证。

假设我们有以下类：

```
class Foo{
    @Min(value = 10)
    int val;
} 
```

如果用户没有`val`在请求中提供值，我们会得到一个讨厌的`NumberFormatException`.

如果`int`替换为`Integer`，我们可以`@NotNull`更优雅地使用和解决这个问题。

# python - 如何从 Python 中的函数返回多个值？

> ID：423710
> 
>         
> 
> 赞同：45
> 
>         
> 
> 时间：2009-01-08T09:41:22.777
> 
>         
> 
> 标签：python, function, multiple-variable-return

如何从 Python 中的函数返回多个变量？

* * *

## 回答 #1

> 赞同：156
> 
>             
> 
> 时间：2009-01-08T09:45:54.000

您用逗号分隔要返回的值：

```
def get_name():
   # you code
   return first_name, last_name 
```

逗号表示它是一个元组，因此您可以用括号将值括起来：

```
return (first_name, last_name) 
```

然后，当您调用该函数时，您 a) 将所有值作为元组保存到一个变量中，或者 b) 用逗号分隔变量名称

```
name = get_name() # this is a tuple
first_name, last_name = get_name()
(first_name, last_name) = get_name() # You can put parentheses, but I find it ugly 
```

* * *

## 回答 #2

> 赞同：14
> 
>             
> 
> 时间：2009-01-08T09:46:15.777

这也是处理结果的代码：

```
def foo (a):
    x=a
    y=a*2
    return (x,y)

(x,y) = foo(50) 
```

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-01-08T09:42:25.567

作为元组返回，例如

```
def foo (a):
    x=a
    y=a*2
    return (x,y) 
```

# itunes - 获取可用的 iTunes 播客列表？

> ID：423714
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T09:42:43.647
> 
>         
> 
> 标签：itunes, podcast

如何获取可用的 iTunes 播客的 RSS 提要 URL？我想要一个列出 iTunes 上所有播客的提要。那可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2018-03-17T00:05:25.540

这些天有几个选择：

*   **[iTunes RSS Feed Generator](https://rss.itunes.apple.com/en-us)** RSS 格式的前 100 个播客列表，无需身份验证。

*   **[iTunes 搜索 API](https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/)** Apple 为所有 iTunes 内容（包括播客）提供了一个 API。JSON 格式，无需身份验证，速率限制为每分钟 20 次调用。

*   **[Enterprise Partner Feed](https://affiliate.itunes.apple.com/resources/documentation/itunes-enterprise-partner-feed/)**让您可以直接从 Apple 下载整个 iTunes 数据库，这样您就可以从自己的服务器上进行无限制的搜索。他们提供了一个[导入器脚本](https://affiliate.itunes.apple.com/resources/documentation/epfimporter/)来处理每天更新您的数据库。您需要[申请登录](https://itunesaffiliate.phgsupport.com/hc/en-us/requests/new)才能访问这些文件。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T09:50:34.380

与 Apple 创建的许多东西一样，向第三方开发人员公开的功能非常有限。目前，似乎不支持在 iTunes Music Store 中生成播客的 RSS 提要。您*可以*为 iTunes 商店中的信息生成一组有限的 RSS 提要，但不包括播客。

您可以使用 Apple 的[iTunes Music Store RSS Generator](http://ax.itunes.apple.com/rss)生成这些提要。

此外，这确实不是 RSS 旨在做的事情。iTunes 中的 podcast 列表非常庞大，将每个 podcast 包装在 XML 标签中会创建一个更大的文件。当您需要提供最近更新的列表时，最好使用 RSS。在 RSS 中编码整个 iTumes 播客目录不适合该类别。您还会注意到 Apple 的提要生成器仅允许您创建少数最新或热门歌曲的提要，而不是整个目录。

# windows - 提取文件的图标/缩略图

> ID：423719
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T09:44:33.847
> 
>         
> 
> 标签：windows, thumbnails, windows-shell

我想从我的项目的 windows shell 中提取文件的图标/缩略图（不同大小）。我可以毫无问题地提取缩略图，但是在处理没有缩略图视图的文件时出现了问题。问题是我无法获得 Windows 资源管理器显示的位图。我得到黑色，其中 explorer 显示出漂亮的灰色阴影。

我已经上传了 1\. 我为 html 文件获取的图像，2\. windows explorer 显示的图像，3.
 [http://www.fileflyer.com/view/seAOcBP的示例源代码](http://www.fileflyer.com/view/seAOcBP)

任何帮助在这里表示赞赏。

问候，

马诺伊

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T10:05:20.310

问题是如何保存它。要拥有渐变 Alpha 通道，您需要将其保存为 PNG。

# latex - 如何在乳胶的一个文档中混合单列和双列？

> ID：423726
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-01-08T09:46:49.553
> 
>         
> 
> 标签：latex, tex

我有一个文档，想将其创建为双列文档。这与 documentclass-command 中的 twocolumn-option 配合得很好。但是我有一些表格和图像，它们太大了，应该使用两列都包含在内。这些表格和图像应该大部分在同一页上，所以 \onecolumn 和 \twocolumn 是没有选择的（有一些例外）。我尝试了 multicol-package，但奇怪的是我这样弄丢了我的桌子。那么知道其他解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-01-08T09:49:49.873

是的，如果您只需要它用于表格和图形，请使用 *-variant：

```
 \begin{table*}

  \end{table*}
  \begin{figure*}

  \end{figure*} 
```

与他们一起，他们将占据两列。

# c# - Winform - 确定鼠标是否离开了用户控制

> ID：423728
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-08T09:48:02.920
> 
>         
> 
> 标签：c#, winforms, user-controls, mouse

我正在努力解决我认为应该很容易（ish）的事情。我在窗体底部有一个 windows 窗体和一个 flowgridlayout 面板。在这个表单中，我用 X 个用户控件动态填充它。控件都是同一类型。

目标是当用户将鼠标悬停在用户控件上时，它会打开另一个表单并将其定位在鼠标所在的位置。当鼠标离开窗体打开的窗体消失。

这几乎效果很好。问题是当用户控件里面有标签或文本框之类的东西时。它被认为已离开 UC，因此表格消失了。

我当时的想法是使用 X 和 Y 来判断它是否在 UC 内部，但我无法弄清楚。

请问：

1）最好的方法是什么？2) 我该如何编码，因为 UC 是动态的，我无法确切知道它们将在哪里。

谢谢

**编辑**

我试图找出鼠标指针但没有到达那里。下面的代码在 UC SmallTagBox_MouseLeave 事件中：

```
 Point loc = this.Location;
        Point p = this.PointToScreen(this.Location);
        Point p2 = this.PointToScreen(this.Parent.Location);

        Point ms = MousePosition;
        Rectangle screenBounds = new Rectangle(this.PointToScreen(this.Location), this.Size);
        if (!screenBounds.Contains(ms))
        {
            thw.Close();
            thw = null;
        } 
```

*   loc {X = 275 Y = 3} System.Drawing.Point

*   p {X = 808 Y = 908} System.Drawing.Point

*   p {X = 808 Y = 908} System.Drawing.Point

*   p2 {X = 545 Y = 1542} System.Drawing.Point

*   ms {X = 574 Y = 914} System.Drawing.Point

*   screenBounds {X = 808 Y = 908 宽度 = 62 高度 = 29} System.Drawing.Rectangle

我不明白 p2 （其父级）如何相对于屏幕具有更大的 Y 值。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T18:42:02.780

挂钩所有控件 MouseEnter 和 MouseLeave 事件，然后确定它是否仍在表单中是非常痛苦的。一个简单的计时器也可以完成工作：

```
 public partial class Form1 : Form {
    private Timer mTimer;
    public Form1() {
      InitializeComponent();
      mTimer = new Timer();
      mTimer.Interval = 200;
      mTimer.Tick += mTimer_Tick;
      mTimer.Enabled = true;
    }
    private void mTimer_Tick(object sender, EventArgs e) {
      if (!this.DesktopBounds.Contains(Cursor.Position)) this.Close();
    }
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T09:50:35.707

想法1）当`MouseLeave`事件触发时，您可以检查鼠标坐标（相对于屏幕）并检查它们是否仍在您的用户控件范围内。如果是，则应假定鼠标必须通过控件返回到边界之外，并且这次您可以放心地忽略该事件。

想法 2) 将`MouseEnter`事件处理程序附加到子控件。那么当鼠标进入一个时，你就会知道并且可以忽略usercontrol的`MouseLeave`事件。然后当孩子的`MouseLeave`事件触发时，再次检查用户控件`MouseEnter`。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T09:58:06.330

我想我会为`MouseLeave`您拥有的每个控件添加一个事件处理程序，并使用该`Parent`属性来查找您所追求的用户控件。我同意，虽然会有点痛苦。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T10:02:44.310

您还可以遍历控件上的所有子控件（递归），并将 MouseEnter 和 MouseLeave 事件也附加到它们。

如果鼠标在您的控制或某些子控件中，您必须做一些簿记。

# c++ - 如何将 COM 方法作为函数参数传递？和 Microsoft 编译器错误 C3867

> ID：423730
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-08T09:48:32.217
> 
>         
> 
> 标签：c++, com, function-pointers

我想将 COM 方法作为函数参数传递，但出现此错误（Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 15.00.30729.01 for 80x86）：

错误 C3867：“IDispatch::GetTypeInfoCount”：函数调用缺少参数列表；使用 '&IDispatch::GetTypeInfoCount' 创建指向成员的指针

我错过了什么？

非常感谢你。

```
#include <atlbase.h>

void update( HRESULT(*com_uint_getter)(UINT*), UINT& u )
{
   UINT tmp;
   if ( S_OK == com_uint_getter( &tmp ) ) {
      u = tmp;
   }
}

// only for compile purpose, it will not work at runtime
int main(int, char*[])
{
   // I choose IDispatch::GetTypeInfoCount just for the sake of exemplification
   CComPtr< IDispatch > ptr;
   UINT u;
   update( ptr->GetTypeInfoCount, u );
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T10:04:02.887

看起来像一个直接的 c++ 问题。

您的方法需要一个指向函数的指针。

您有一个成员函数 - （与函数不同）。

通常您需要：

1\. 将您要传递的函数更改为静态函数。

2\. 将预期的指针类型更改为成员函数指针。

处理成员函数指针的语法不是最好的......

一个标准的技巧是 (1)，然后将对象 this 指针作为参数显式传递，从而允许您调用非静态成员。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T19:43:10.737

Boost.Function 在这里也是一个合理的选择（请注意，我没有测试我在下面写的内容，因此可能需要进行一些修改 - 特别是，我不确定您是否必须调用某种 get() 方法在您的 CComPtr 对象上）：

```
#include <atlbase.h>
#include <boost/function.hpp>
#include <boost/bind.hpp>

void update( boost::function<HRESULT (UINT*)> com_uint_getter, UINT& u )
{
   UINT tmp;
   if ( S_OK == com_uint_getter( &tmp ) ) {
      u = tmp;
   }
}

// only for compile purpose, it will not work at runtime
int main(int, char*[])
{
   // I choose IDispatch::GetTypeInfoCount just for the sake of exemplification
   CComPtr< IDispatch > ptr;
   UINT u;
   update( boost::bind(&IDispatch::GetTypeInfoCount, ptr), u );
   return 0;
} 
```

这与 morechilli 提到的所有指向成员的东西相同，但它隐藏了使用它的一些更混乱的语法。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-16T12:35:06.967

正如[morechilli](https://stackoverflow.com/users/5427/morechilli)指出的，这是一个 C++ 问题。感谢我的同事 Daniele，这是解决方案：

```
#include <atlbase.h>

template < typename interface_t >
void update( interface_t* p, HRESULT (__stdcall interface_t::*com_uint_getter)(UINT*), UINT& u )
{
   UINT tmp;
   if ( S_OK == (p->*com_uint_getter)( &tmp ) ) {
      u = tmp;
   }
}

// only for compile purpose, it will not work at runtime
int main(int, char*[])
{
   // I choose IDispatch::GetTypeInfoCount just for the sake of exemplification
   CComPtr< IDispatch > ptr;
   UINT u;
   update( ptr.p, &IDispatch::GetTypeInfoCount, u );
   return 0;
} 
```

# c++ - 使用 Boost.Asio 时确保有效对象寿命的最佳方法是什么？

> ID：423739
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2009-01-08T09:52:21.227
> 
>         
> 
> 标签：c++, multithreading, boost, asynchronous, boost-asio

最近玩了很多 Boost.Asio。我非常喜欢这个库，因为它提供了一种从当今多核系统中榨取性能的绝妙方法。

我曾经问过自己几次的一个问题，我认为在使用 Asio 进行异步调用时，关于对象生命周期/所有权的问题值得一提。

我反复遇到的问题是，您经常不得不“过期”一个仍然有异步回调待处理的对象。如果该对象在调用回调之前超出范围，则不可避免地会发生爆炸。

为了解决这个问题，我已将`boost::enable_shared_from_this`模板用作大多数基于 asio 的类的基类。这工作正常，但有点麻烦：通常这也意味着保护构造函数并向类添加工厂方法以确保在 shared_ptr 内创建所有实例。

我只是想知道其他人是如何解决这个问题的。我是最好的方法吗？还是我的 Asio.Foo 都错了？

讨论... ：）

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-06-12T17:43:53.500

使用`boost::enable_shared_from_this`几乎是做到这一点的方法。此外，`boost::weak_ptr`如果您需要对不应保留对象的对象的引用，如果它们是唯一保留的引用，请查看使用。

一个很好的使用示例`weak_ptr`：我`enable_shared_from_this`在我的套接字类中使用了`boost::asio`. `boost::asio`框架是唯一通过读写处理程序存储对对象的持久引用的东西。因此，当调用套接字的析构函数时，我知道套接字已关闭，我可以在处理程序中“做一些事情”以清理该关闭的套接字。使用套接字的应用程序只有一个对它的`weak_ptr`引用，`shared_ptr`当它想要使用套接字（通常是写入它）时，它会将其提升为一个。在套接字消失的情况下，可以检查该提升是否失败，尽管套接字的关闭处理程序通常会在此之前适当地清理所有`weak_ptr`引用。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T19:48:37.513

这种事情不仅限于Asio。我最近写了一个线程池类（使用 Boost::Thread），它有几乎相同的问题——线程会调用创建它们的线程池类，以查看他们接下来必须执行的任务，使用普通指针如果线程池类在子线程仍在运行的情况下被销毁，程序就会崩溃。我通过调用线程池析构函数中的每个线程来处理它`interrupt`，然后在让析构函数返回之前等待所有线程退出。

如果我理解您的共享指针解决方案，它似乎在做同样的一般事情——确保在不再需要该项目之前不会被销毁。也是一个美观的解决方案。对于此类问题，我没有看到更好的答案。

# blackberry - 用黑莓JDE4.7开发？

> ID：423753
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T09:59:26.470
> 
>         
> 
> 标签：blackberry, rim-4.7

RIM 在发布 Blackberry Storm 之后发布了新的 Blackberry JDE4.7。黑莓风暴是否支持使用以前版本创建的程序？我听说这个版本与旧版本相比有很多变化。并且有人抱怨 Storm 有很多错误。

我应该使用 4.7 还是继续使用旧的 JDE？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-09T16:39:51.943

取决于你想做什么。如果您将应用程序的布局设计为完全独立于分辨率，您实际上将免费获得旋转。当设备旋转时，您的布局和子布局方法将再次被调用（或者如果您刚刚使用了内置字段和管理器，这都是自动的）。

您需要 4.7 JDE 做的大事包括：

*   响应特定的触摸事件（导致焦点转到字段或滚动的事件会自动映射到较旧的 API）

*   检测设备方向（虽然同样，布局已经被处理 - 如果你想在低级别使用加速度计来控制游戏或其他东西，这更重要）

底线：总体而言，向后兼容性非常好，RIM 以一种明智的方式将新的触摸界面映射到旧的 API，并且由于 Storm 还没有像 iPhone 那样起飞（大多数人认为 Bold 和 Curve 是还是更好的设备），坚持使用旧的 SDK，除非你正在做一个非常特定于 Storm 的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T14:35:59.547

Blackberry Storm 应该支持使用以前版本创建的程序。但是，有时程序会中断，无论是由于新版本中的错误还是旧版本中现已修复的错误。

4.7 API 必须进行大量更改才能支持 Storm 的新功能。

但实际上，您应该使用可以避免的最低 JDE 进行开发，以避免强迫可能尝试您的程序的人首先更新。另一方面，当然，如果你想做一个旋转界面，你将需要 4.7 JDE 和 Storm。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-11T16:25:06.650

如果您对处理输入的方式进行了任何更改，那么使用 4.7 进行开发确实会出现一些问题。如果您创建了任何自定义字段，则需要更新它们并为 4.7 和 < 4.7 提供不同的构建。字段上有更多方法，例如`moveFocus(int x, int y)`.

如果任何地方有任何文本输入，您将必须确保虚拟键盘不会覆盖或从视图中删除您需要可见的任何内容。

如果您在屏幕上手动完成了某些操作并且您不希望在运行时更改它，那么视图的自动旋转有时也是一个问题，在这种情况下，有一种方法可以强制应用程序进入特定方向。

至少我还注意到模拟器的一些问题，当使用 GaugeField 对象时，也就是说，如果你专注于 GaugeField，则无法移除焦点。不知道这个问题是否已经解决或者什么，但至少我的模拟器是这样的。

# winapi - 将逻辑处理器映射到物理处理器

> ID：423761
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T10:03:51.093
> 
>         
> 
> 标签：winapi, multicore, affinity

在双四核[GetProcessAffinityMask](http://msdn.microsoft.com/en-us/library/ms683213%28VS.85%29.aspx)（或 taskman.exe 中“设置关联”的对话框）上，将报告八个逻辑处理器。如何找出哪个逻辑处理器在哪个物理处理器上？特别是：哪些逻辑处理器在同一个物理处理器上？

**编辑：**如果无法以编程方式执行此操作，是否有人知道法线映射是什么？是第一个处理器上的前四个，第二个处理器上的后四个，还是第一个处理器上的奇数编号和第二个处理器上的偶数编号？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-01-08T10:17:00.943

您可以使用`Win32_Processor`WMI 类查询系统上的 CPU 的核心数、逻辑处理器数、体系结构、缓存内存和其他信息。

要查询系统中逻辑处理器之间的关系信息，可以使用[GetLogicalProcessorInformation](http://msdn.microsoft.com/en-us/library/ms683194(VS.85).aspx) API 函数。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2011-09-06T18:08:11.850

如果您不想自己编写代码，SysInternal 方便的 coreinfo 实用程序最接近回答您的问题。它按照 Mehrdad 的建议实现了 GetLogicalProcessorInformation。对于 Xeon E5640（四核，8 线程），您可以从 coreinfo 获得：

```
c:\App\SysInternals>Coreinfo.exe -c

Coreinfo v3.0 - Dump information on system CPU and memory topology
Copyright (C) 2008-2011 Mark Russinovich
Sysinternals - www.sysinternals.com

Logical to Physical Processor Map:
**------  Physical Processor 0 (Hyperthreaded)
--**----  Physical Processor 1 (Hyperthreaded)
----**--  Physical Processor 2 (Hyperthreaded)
------**  Physical Processor 3 (Hyperthreaded) 
```

正如该芯片所预期的那样，8 个超线程有 8 个 *，每个内核两个。但是，尚不清楚 * 的排列如何与 Windows 呈现的逻辑处理器列表相匹配。例如，任务管理器为我提供了一个对话框，用于为任何进程分配处理器关联，标记为 CPU 0 到 CPU 7。假设您可以获取 coreinfo 的输出并从左到右为逻辑处理器编号是公平的（但不是必需的）。因此“CPU 5”将是在物理处理器 2 上运行的第二个超线程。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2011-10-06T06:59:12.177

编号以顺序方式完成：首先是所有物理核心，然后是逻辑核心 [1]。

[1][启用超标题的系统上的 CPU 编号](https://stackoverflow.com/questions/1744130/cpu-numbering-on-a-hypertheading-enabled-system)

# wpf - WPF - 使用数据绑定绑定项目列表框和详细文本框

> ID：423765
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T10:05:15.007
> 
>         
> 
> 标签：wpf, data-binding

我正在尝试按照标题中的说明设置数据绑定。

我遇到的问题是绑定到一个通用列表。

任何例子都在那里。

我不能在通用列表上使用 BindingListCollectionView，所以必须使用 CollectionView。

我感到困惑的问题是在单击添加按钮时添加一个新项目我将一个新项目添加到通用列表并刷新视图。但是，如果用户没有按照列表进行操作，则现在有空项目。

我知道这是基本的，但如何正常处理？

马尔科姆

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T11:19:50.207

我在这里看到两个问题，我将尝试逐步回答。

## 带有详细视图的项目绑定列表

鉴于这些 ViewModel 类（想象每个人都实现`INotifyPRopertyChanged`）：

```
public class DataView {
    public Item SelectedItem {get; set; }
    public List<Item> Items { get; private set; }
}

public class Item {
    public string Title { get; set; }
} 
```

将`Data`实例放入 中`DataContext`，最小的 View 可能如下所示：

```
<StackPanel>
    <ListView Items="{Binding Items}" SelectedItem="{Binding SelectedItem}" />
    <TextBox Text="{Binding SelectedItem.SelectedItem.Title}" />
</StackPanel> 
```

## 添加新项目

为了能够在`Item`不立即将其添加到列表的情况下创建新对象，您可能希望将新创建的对象拆分到自己的区域中。从视觉上看，您可以将它放在新的弹出窗口中或集成到列表中，但实际上它只会在*下次*尝试添加或确认父对话框时添加到列表中。此时您还可以验证 是否`Item`足够有效以将其添加到列表中。

# c# - C# 多字符串匹配

> ID：423790
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-08T10:21:16.363
> 
>         
> 
> 标签：c#, regex, search, overlapping-matches

我需要可以匹配多次出现的模式的 C# 字符串搜索算法。例如，如果模式是 'AA' 并且字符串是 'BAAABBB' 正则表达式生成匹配结果索引 = 1，但我需要结果索引 = 1,2。我可以强制正则表达式给出这样的结果吗？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-01-08T10:26:54.590

使用前瞻模式：-

“A（？=A）”

这会找到后面跟着另一个 A 的任何 A 而不会消耗后面的 A。因此 AAA 将匹配此模式两次。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T10:52:45.503

总结所有以前的评论：

```
Dim rx As Regex = New Regex("(?=AA)")
Dim mc As MatchCollection = rx.Matches("BAAABBB") 
```

这将产生您要求的结果。

编辑：

这是 C# 版本（今天使用 VB.NET，所以我不小心继续使用 VB.NET）。

```
Regex rx = new Regex("(?=AA)");
MatchCollection mc = rx.Matches("BAAABBB"); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T10:24:43.470

任何正则表达式都可以给出[MatchCollection的数组](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.matchcollection.aspx)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T10:26:25.993

正则表达式.Matches()
 [http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.matchcollection.aspx](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.matchcollection.aspx)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-10T17:19:59.037

您真的在寻找只有两个字符长的子字符串吗？如果是这样，无论您使用什么正则表达式（或任何非正则表达式技术，就此而言），搜索 2000 万个字符串都会很慢。如果搜索字符串较长，正则表达式引擎可以使用像 Boyer-Moore 或 Knuth-Morris-Pratt 这样的搜索算法来加快搜索速度——事实上，越长越好。

顺便说一句，您所说的搜索称为*重叠匹配*；我会把它添加到标签中。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T11:33:01.990

尝试这个：

```
 System.Text.RegularExpressions.MatchCollection  matchCol;
       System.Text.RegularExpressions.Regex regX = new System.Text.RegularExpressions.Regex("(?=AA)");

        string index="",str="BAAABBB"; 
        matchCol = regX.Matches(str);
        foreach (System.Text.RegularExpressions.Match mat in matchCol)
            {
                index = index + mat.Index + ",";
            } 
```

index 的内容是您在删除最后一个逗号后要查找的内容。

# cocoa - 在将固件下载到设备时更新进度指示器

> ID：423792
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-08T10:23:08.607
> 
>         
> 
> 标签：cocoa

我正在开发一个将固件下载到设备的可可应用程序。下载进度使用 NSProgressIndicator 显示。我`-incrementBy:`在 while 循环中的 DeviceRequestTO 方法之后调用 NSProgressIndicator 的方法。但只有在将整个固件写入设备后，进度指示器才会更新。它本身就显示 100% 完成。所以我添加了`-displayIfNeeded`NSView 类的方法。现在它显示进展顺利，但这也会在固件下载完成后发生。如何同时实现进度指示和写入操作？

以下是代码：

```
while(1)
{
    int result = (*dev)->DeviceRequestTO(dev, &request);
    printf("\nBlocks Written Successfully: %d",DfuBlockCnt);
    [refToSelf performSelectorOnMainThread:@selector(notifyContent)
                        withObject:nil
                        waitUntilDone:NO];
}

//In main thread
- (void)notifyContent{
    [dnldIndicator incrementBy:1];
    [self displayIfNeeded];
} 
```

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-01-08T11:30:49.593

您需要调用的方法是`setNeedsDisplay:`，不是`displayIfNeeded`。后者的意思是“`display`如果有人派了你，就派你自己`setNeedsDisplay:YES`”。如果你不做最后一部分，视图不知道它应该显示，并且`displayIfNeeded`什么也不做。

一旦你添加了`setNeedsDisplay:`消息，你就可以删除`displayIfNeeded`消息，因为框架会定期将该消息发送到窗口（因此，发送到它的所有视图）。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T14:20:50.810

您的代码看起来与我用于更新 Mac 和 iPhone 上的 UIProgressIndicators 和 NSProgressIndicators 的代码完全一样，这些代码对我来说非常适合。我假设像 menumachine 一样，您的 while 循环存在于后台线程上（使用 performSelectorInBackground:withObject: 或 NSThread 的 detachNewThreadSelector:toTarget:withObject: 创建）。

进度指示器的 minValue 和 maxValue 设置是否正确（0 和 100 或任何您的比例）？  

更新的频率如何？也许您太快地发送了太多事件，并且 UI 没有机会正确更新。

据我所知，这段代码应该可以工作。

# c# - 处理套接字/完成两次的问题？

> ID：423794
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T10:24:06.327
> 
>         
> 
> 标签：c#, sockets, dispose, finalizer, xunit

我正在为一个打开套接字，发出请求并监听响应的类使用一些代码（不是我的，我急于添加，我一点也不信任），它以我可以的方式抛出异常在 xunit 中测试时不理解。我*假设*同样的异常发生在“现场”，但是该类被一个单例引用，所以它可能只是被隐藏了。

问题在 xunit 中表现为“System.CannotUnloadAppDomainException: Error while unloading appdomain”，内部异常是在关闭套接字时（基本上）在终结器内抛出“System.ObjectDisposedException”！没有其他对调用 close 和 dispose 的套接字的引用在 Socket 类上受到保护，所以我不清楚如何处理该对象。

此外，如果我只是捕获并吸收 ObjectDisposedException，xunit 会在它到达关闭侦听器线程的行时终止。

**我只是不明白在要求关闭之前如何处理 Socket。**

我对套接字的了解只是我发现这个问题后学到的知识，所以我不知道我是否提供了 SO 可能需要的一切。LMK 如果没有！

```
public class Foo
{
    private Socket sock = null;
    private Thread tListenerThread = null
    private bool bInitialised;
    private Object InitLock = null;
    private Object DeInitLock = null;

    public Foo()
    {
        bInitialised = false;

        InitLock = new Object();
        DeInitLock = new Object();
    }

    public bool initialise()
    {
        if (null == InitLock)
            return false;

        lock (InitLock)
        {
            if (bInitialised)
                return false;

            sock = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);
            sock.SetSocketOption(SocketOptionLevel.IP, SocketOptionName.MulticastTimeToLive, 8);
            sock.Bind( /*localIpEndPoint*/);
            sock.SetSocketOption(SocketOptionLevel.IP, SocketOptionName.AddMembership, new MulticastOption(mcIP));

            tListenerThread = new Thread(new ThreadStart(listener));
            tListenerThread.Start();

            bInitialised = true;
            return true;
        }
    }

    ~Foo()
    {
        if (bInitialised)
            deInitialise();
    }

    private void deInitialise()
    {
        if (null == DeInitLock)
            return;

        lock (DeInitLock)
        {
            if (bInitialised)
            {
                sock.Shutdown(SocketShutdown.Both); //throws System.ObjectDisposedException
                sock.Close();

                tListenerThread.Abort(); //terminates xunit test!
                tListenerThread = null;

                sock = null;

                bInitialised = false;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-01-08T10:29:23.007

如果此对象符合垃圾回收条件并且没有其他对 Socket 的引用，则*套接字的*终结器可能会在对象的终结器之前运行。我怀疑这就是这里发生的事情。

在终结器中做这么多工作通常是一个坏主意（IMO）。我完全不记得我最后一次实现终结器是什么时候了——如果你实现了 IDisposable，你应该没问题，除非你有对非托管资源的*直接*引用，这些资源几乎总是以 IntPtrs 的形式。有序关闭应该是常态——通常只有在程序关闭或有人忘记处置实例开始时才运行终结器。

（我知道你一开始就澄清这不是你的代码 - 我只是想我会解释为什么它有问题。如果你已经知道一些/所有这些，请道歉。）

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T13:50:27.487

由于垃圾收集器和终结器的工作方式，只有当您的类是非托管资源（如窗口句柄、GDI 对象、全局句柄或任何其他类型的 IntPtr ）的**直接所有者时，才必须使用终结器。**

**终结器不得尝试释放甚至使用托管资源，否则您将面临调用终结或释放对象的风险。**

我强烈建议您阅读这篇[非常重要的 Microsoft 文章](http://msdn.microsoft.com/en-us/magazine/bb985010.aspx)，详细了解垃圾收集的工作原理。此外，这是 MSDN 关于[实现 Finalize 和 Dispose 以清理非托管资源](http://msdn.microsoft.com/en-us/library/b1yfkh5e.aspx)的参考，请仔细查看底部的建议。

简而言之：

*   如果您的对象持有非托管资源，则应实现 IDisposable 并且必须实现 Finalizer。

*   如果您的对象持有一个 IDiposable 对象，它还应该自己实现 IDisposable 并显式处置该对象。

*   如果您的对象同时包含非托管和一次性，则终结器必须调用两个不同版本的 Dispose，一个释放一次性和非托管，另一个仅释放非托管。这通常使用由 Dipose() 和 Finalizer() 调用的 Dispose(bool) 函数来完成。

*   除了被释放的非托管资源和自身之外，终结器绝不能使用任何其他资源。如果不这样做，将有引用收集或处置的对象的风险，因为对象在最终确定之前会暂时复活。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T17:24:19.817

新信息：这看起来像我实际上有两个问题，但线程[似乎](http://msdn.microsoft.com/en-us/library/system.threading.threadabortexception.aspx)是相当有毒的。

从上面的 MSDN 链接：

> “ThreadAbortException 是一个可以被捕获的特殊异常，但它会在 catch 块结束时再次自动引发。”

Some very interesting community content also at that link including ["Thread.Abort is a Sign of a Poorly Designed Program"](http://msmvps.com/blogs/peterritchie/archive/2007/08/22/thead-abort-is-a-sign-of-a-poorly-designed-program.aspx).

So at least I have some ammo to get this changed now :)

# windows - 如何使用 Perl 或任何其他语言在 Windows x86-32 位上找到确切的物理内存量？

> ID：423797
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T10:25:18.757
> 
>         
> 
> 标签：windows, perl, memory-management

我需要知道使用 Perl 的 Windows 机器有多少物理内存。

我试过使用[Win32::SystemInfo](http://search.cpan.org/dist/Win32-SystemInfo)。但是，此模块指出以下警告：

> 在内存大于 2 GB 且小于 4 GB 的 Intel x86 计算机上，MemoryStatus 函数将始终为 TotalPhys 返回 2 GB。同样，如果总可用内存在 2 到 4 GB 之间，AvailPhys 将向下舍入为 2 GB。

因此，在具有 2-4 GB 物理内存的机器上，我得到了错误的答案。

有没有办法获得正确数量的物理内存？也许另一个模块？还是直接使用[Win32::API](http://search.cpan.org/dist/Win32-API)？

编辑：从人们在这里给出的评论来看，限制似乎在 Win32 API 中，而不是特定于[Win32::SystemInfo](http://search.cpan.org/dist/Win32-SystemInfo)。但是，操作系统**确实**知道***有***多少物理内存可用，因此必须有一种方法来提取该信息。如果不是在 Perl 中，那么也许是另一种语言？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-11T14:22:54.807

如评论中所述，这是[GlobalMemoryStatus](http://msdn.microsoft.com/en-us/library/aa366586.aspx)的问题，因为它可以返回高达 2GB 的答案。而[GlobalMemoryStatusEX](http://msdn.microsoft.com/en-us/library/aa366589(VS.85).aspx)解决了 2GB 限制的问题，但仅适用于 64 位系统（据我所知）。

最后，我使用了以下 Perl 代码，它使用 Win32::OLE 和 WMI 类[Win32_PhysicalMemory](http://msdn.microsoft.com/en-us/library/aa394347(VS.85).aspx)，即使在 32 位系统上也能返回正确的物理内存量：

```
use strict;
use warnings;
use English;
use Win32::OLE qw( EVENTS HRESULT in );
use Readonly;

sub get_physical_memory {
    my $machine                         = shift || '.'; # Default to local machine
    my Readonly $WMI_MEMORY_CLASS_NAME  = 'Win32_PhysicalMemory';
    my Readonly $MEGABYTE               = 1024*1024;

    my $WMI = 
        Win32::OLE->GetObject( "winmgmts:{impersonationLevel=impersonate,(security)}//$machine/" ) || die "Could not get Win32 object: $OS_ERROR";
    my $total_capacity                  = 0;

    foreach my $object ( in( $WMI->InstancesOf( $WMI_MEMORY_CLASS_NAME ) ) ) {
        $total_capacity += $object->{Capacity};
    }

    my $total_capacity_in_mb            = $total_capacity / $MEGABYTE;
    print "Total Memory : $total_capacity_in_mb \n";
    return $total_capacity_in_mb;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-09T08:55:42.277

我只能假设`Win32::SystemInfo`关注结果的警告也是关注原始 Win32 API 调用的警告，因为 Perl 本身在处理如此大的数字时当然没有问题。在这种情况下，提取准确信息的可能性看起来有点暗淡。

我还顺便听说，当前的 32 位版本的 Windows 只能在安装了 >= 4Gb 的机器上使用大约 3.2Gb 的 RAM，这可能是传闻，但这与 API 本身的限制相吻合。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-10T20:20:26.973

此信息可以从 WMI 中提取，或者如果您选择在将运行它的机器上启用 SNMP，则可以使用 SNMP。对于 WMI，我没有临时的 Perl 示例，但对于 VBScript 示例，请参见下文。

参考：   http: [//www.microsoft.com/technet/scriptcenter/guide/sas_wmi_dieu.mspx](http://www.microsoft.com/technet/scriptcenter/guide/sas_wmi_dieu.mspx)

```
strComputer = "."

Set objSWbemServices = GetObject("winmgmts:\\" & strComputer)
Set colSWbemObjectSet = _
 objSWbemServices.InstancesOf("Win32_LogicalMemoryConfiguration")

For Each objSWbemObject In colSWbemObjectSet
 Wscript.Echo "Total Physical Memory (kb): " & _
 objSWbemObject.TotalPhysicalMemory
Next 
```

在我的 XP 系统上进行了测试，它检索到了所需的结果（这里只有 1.5GB RAM，抱歉）。如果您想坚持使用 Perl，我很确定 Perl 也有 WMI 接口。如果 SNMP 是一个选项，那么总物理内存可以从 SNMP 以及使用 Perl SNMP 库之一获得。

**编辑**：刚刚注意到@Mr。Muskrat 对 Microsoft KB [http://support.microsoft.com/kb/274558](http://support.microsoft.com/kb/274558)的评论- 显然，您在 Perl 中看到的行为是 Win32 API 调用的限制，因此您最终可能会得到与 WMI 相同的结果。不幸的是，我没有 2-4GB RAM 的机器来尝试验证。

# java - 将 java.hprof.txt 转换为二进制 hprof 格式的方法？

> ID：423802
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-08T10:27:50.220
> 
>         
> 
> 标签：java, memory-leaks, profiling, hprof

我有一个 java.hprof.txt 文件（在 OutOfMemoryError 之后自动生成），我想将其转换为二进制 hprof 格式。有什么简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-14T08:42:06.333

不，没有。您必须再次将其创建为二进制 hprof。

# delphi - 在 Delphi 中使用 DBExpress 创建数据库？

> ID：423808
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T10:31:06.343
> 
>         
> 
> 标签：delphi, firebird, dbexpress

我需要使用 DBExpress 以编程方式创建一个 Firebird 数据库。我已经为 SQL 服务器做到了这一点，首先连接到 Master，然后将 Create 脚本传递给查询，但是使用 Firebird 我有一点鸡和蛋的问题。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T11:00:36.300

我从一位为 Freepascal 项目创建了一些代码的同事那里得到了一个很好的提示。它不使用 DB express，但据他说，这是使用代码创建数据库的唯一方法。此代码基于 InterBase 手册，并使用来自 gdslib / fbclient dll 的调用：

```
procedure TIBConnection.CreateDB;

var ASQLDatabaseHandle,
    ASQLTransactionHandle : pointer;
    CreateSQL : String;
    pagesize : String;
begin
  CheckDisConnected;
  {$IfDef LinkDynamically}
    InitialiseIBase60;
  {$EndIf}
  ASQLDatabaseHandle := nil;
  ASQLTransactionHandle := nil;
  CreateSQL := 'CREATE DATABASE ';
  if HostName <> '' then
    CreateSQL := CreateSQL + ''''+ HostName+':'+DatabaseName + ''''
  else
    CreateSQL := CreateSQL + '''' + DatabaseName + '''';

  if UserName <> '' then
    CreateSQL := CreateSQL + ' USER ''' + Username + '''';
  if Password <> '' then
    CreateSQL := CreateSQL + ' PASSWORD ''' + Password + '''';
  pagesize := params.Values['PAGE_SIZE'];
  if pagesize <> '' then
    CreateSQL := CreateSQL + ' PAGE_SIZE '+pagesize;

  if isc_dsql_execute_immediate(@FStatus[0],@ASQLDatabaseHandle,@ASQLTransactionHandle,length(CreateSQL),@CreateSQL[1],Dialect,nil) <> 0 then
    CheckError('CreateDB', FStatus);

  if isc_detach_database(@FStatus[0], @ASQLDatabaseHandle) <> 0 then
    CheckError('CreateDB', FStatus);

  {$IfDef LinkDynamically}
    ReleaseIBase60;
  {$EndIf}
end; 
```

诀窍是 isc_dsql_execute_immediate 函数。我希望这段代码可以帮助你。以下是此代码来源的 Freepascal 源文件的链接：

[包含 CreateDB 函数的单元](http://svn.freepascal.org/cgi-bin/viewvc.cgi/tags/release_2_2_2/packages/fcl-db/src/sqldb/interbase/ibconnection.pp?revision=11487&view=markup)

[包含 API 调用 isc_dsql_execute_immediate 的单元](http://svn.freepascal.org/cgi-bin/viewvc.cgi/tags/release_2_2_2/packages/ibase/src/ibase60.inc?revision=11487&view=markup)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-10-12T14:30:19.593

运行脚本 isql

isql -i createDB.sql

CreateDB.sql 文件包含创建数据库的命令，如下所示。

```
SET SQL DIALECT 3;
CREATE DATABASE 'C:\DATABASE\DB.FDB'
USER 'SYSDBA' PASSWORD 'masterkey'
PAGE_SIZE 4096
DEFAULT CHARACTER SET WIN1252;
QUIT; 
```

# optimization - 在具有多值节点的树中查找最小路径

> ID：423809
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-08T10:31:39.167
> 
>         
> 
> 标签：optimization, math, tree, path-finding

我的数学课远远落后，我目前正在努力为我遇到的问题找到一个体面的解决方案：我有一棵树，其中的节点是动作，并且根据多个标准“加权”：所说的行动，它将花费的时间，必要的资源，干扰等......

我想在这棵树中找到最小化成本和时间的路径，或者干扰和成本和时间等。我的问题是我不知道该怎么做，除非上来使用全局成本函数 F(cost, time, resources,...)，并使用 F(...) 的结果作为我唯一的权重应用常规树遍历算法。但是，我该如何想出 F ？像“F(cost, time, resources) = a * cost + b * time + c * resources”这样的东西感觉很“不专业”......

编辑：

我想避免使用“求和”这个词，因为我不确定这是否真的是要走的路，但本质上，这就是我正在做的事情：计算来自的每个“路径”或“分支”的总成本该顶部节点，到其中一个叶子，并选择最小化成本的“路径”或“分支”。问题是每个节点都有一个基于所需时间、财务成本、资源使用等的权重。

因此，正如斯蒂芬所说，似乎不可避免地必须提出一个公式，将所有这些参数减少到每个节点的一个全局成本，然后我可以在沿树向下移动时跨节点求和，并选择路径最小化总成本。

所以我想我的问题真的是，是否有选择该功能的方法？

感谢您的回答和评论，现在我的头脑开始变得更加清晰了。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T10:45:55.907

想出F是最重要的。如果我可以给你 6 成本和 5 时间或 5 时间和 6 成本，你更喜欢哪个？您的成本函数需要考虑到这一点。不幸的是，没有任何算法可以为你解决这个问题。在我坐下来为我正在开发的优化应用程序写 F 之前，我否认了这一点。最坏的情况，将参数留给用户修改。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T13:52:25.377

假设我们有四对 (x, y)，例如 (1, 4), (1, 5), (2, 3), (3, 3)。现在您要最小化“x 和 y”。你什么意思？如果您先最小化 x，然后再最小化 y，您最终会得到 (1, 4)。如果首先最小化 y，然后最小化 x，你会找到 (2, 3)。

除非您选择全局成本函数 F(x, y)，就像在您的观察中一样，否则我看不出“两者”的任何含义。（无论如何，一旦选择了 F，可能仍然有多个最小点。）顺便说一句，在我看来，线性组合（正乘数 a,b,c 被理解为“权重”）根本不是“不专业的” ，至少如果您不知道更合适的成本函数可能是什么。

编辑：

> 因此，正如斯蒂芬所说，似乎不可避免地必须提出一个公式，将所有这些参数减少到每个节点的一个全局成本，然后我可以在沿树向下移动时跨节点求和，并选择路径最小化总成本。

警告。实际上，只有当 F 是线性的时，这种策略才有意义。当然，成本、时间、资源等是加法函数，在某种意义上说 time(node1 -> node2 -> node3) = time(node1) + time(node2) + time(node3)，但通常情况并非如此对于 F，除非它是线性的。(即 F(cost(node1 -> node2)) = F(cost(node1) + cost(node2)) != F(cost(node1)) + F(cost(node2))。)

如果选择非线性全局成本函数，正确的策略是计算每个节点的总成本、总时间、从根到该节点的总资源，并仅计算（然后最小化）终端节点的 F。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T11:27:43.593

为什么像[A*](http://en.wikipedia.org/wiki/A_star)这样的普通图搜索算法不起作用？

对于路径成本函数，您可以使用相关标准的运行总和。到目标的距离更加困难......

它*可能*是到最近的叶子的距离，为所有或部分节点预先计算，尽管这听起来非常昂贵。根据你的树的结构，你可能会想出一个更便宜的低估 - 例如，如果它完全平衡，它是微不足道的。

# vb.net - Integer.Parse 与 CInt

> ID：423820
> 
>         
> 
> 赞同：27
> 
>         
> 
> 时间：2009-01-08T10:38:22.617
> 
>         
> 
> 标签：vb.net

基本上，我在大多数日常编程任务中都使用了CInt`Integer.Parse`和[CInt](https://msdn.microsoft.com/en-us/library/s2dy91zy.aspx)，但我对两者之间的区别有点困惑。

`Integer.Parse`VB.NET和VB.NET有什么区别`CInt`？

* * *

## 回答 #1

> 赞同：34
> 
>             
> 
> 时间：2009-01-08T11:09:48.060

`CInt`比[`Integer.Parse`](https://msdn.microsoft.com/en-us/library/b3h1hf19(v=vs.110).aspx?cs-save-lang=1&cs-lang=vb).

`CInt`将首先检查它传递的是否是整数，然后简单地转换它并返回它。如果它是双精度数，它将尝试在不先将双精度数转换为字符串的情况下对其进行转换。

从帮助`CInt`和其他[类型转换函数中看到这一点](http://msdn.microsoft.com/en-us/library/s2dy91zy.aspx)

> 小数部分。将非整数值转换为整数类型时，整数转换函数（CByte、CInt、CLng、CSByte、CShort、CUInt、CULng 和 CUShort）会删除小数部分并将值四舍五入为最接近的整数。
> 
>   
>   
> 
> 如果小数部分正好是 0.5，整数转换函数会将其四舍五入到最接近的偶数。例如，0.5 舍入为 0，1.5 和 2.5 都舍入为 2。这有时称为银行家舍入，其目的是补偿在将许多此类数字相加时可能累积的偏差。

所以简而言之，它不仅仅是将字符串转换为整数，例如将特定的舍入规则应用于分数，短循环不必要的转换等。

如果您正在做的是将字符串转换为整数，请使用[`Integer.Parse`](https://msdn.microsoft.com/en-us/library/b3h1hf19(v=vs.110).aspx?cs-save-lang=1&cs-lang=vb)(或[`Integer.TryParse`](https://msdn.microsoft.com/en-us/library/f02979c7(v=vs.110).aspx))，如果您将未知值（例如 a`variant`或`object`来自数据库）强制转换为整数，请使用`CInt`.

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-01-08T11:41:46.683

使用[ILDASM](http://en.wikipedia.org/wiki/Common_Intermediate_Language#Generation)查看一些示例代码，您可以看到 CInt 已转换为此调用：

**Microsoft.VisualBasic]Microsoft.VisualBasic.CompilerServices.Conversions::ToInteger(string)**

使用[.NET Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)，您可以提取这段代码：

```
Public Shared Function ToInteger(ByVal Value As String) As Integer
    Dim num As Integer
    If (Value Is Nothing) Then
        Return 0
    End If
    Try
        Dim num2 As Long
        If Utils.IsHexOrOctValue(Value, (num2)) Then
            Return CInt(num2)
        End If
        num = CInt(Math.Round(Conversions.ParseDouble(Value)))
    Catch exception As FormatException
        Throw New InvalidCastException(Utils.GetResourceString("InvalidCast_FromStringTo", New String() { Strings.Left(Value, &H20), "Integer" }), exception)
    End Try
    Return num
End Function 
```

您可以看到它在内部调用**Conversions.ParseDouble**。

因此，正如 Binary Worrier 已经解释的那样，使用 Integer.Parse 进行字符串强制，使用 CInt 仅进行强制转换。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2019-12-10T15:54:27.123

这是一个真正的区别： Integer.parse("1.00") 将引发错误。CInt("1.00") 将起作用

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2009-01-08T11:45:42.370

这些`<Data Type>.Parse`方法用于从表示该值的字符串中提取该类型的值（例如“2”中的 2）。`C<Data Type>`函数对表达式进行操作，并返回一个变体子类型化为所需类型（例如`CInt("2")`OR`CInt(SomeDouble + SomeDouble)`等）。

# c# - 如何获取为当前正在执行的 httphandler 配置的路径？

> ID：423821
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T10:38:41.007
> 
>         
> 
> 标签：c#, asp.net, httphandler

考虑一个可以为多个路径配置的 HttpHandler。但是根据与 url 匹配的路径，我可以选择要应用的设置。

我不想在 url 中传递参数。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T12:00:01.313

我现在没有时间写一个完整的例子，但我想这将是要走的路：

*   阅读 Web.config；

*   获取位置；

*   循环遍历位置；

*   如果位置 uri 与当前 uri 匹配（从 System.Web.HttpContext.Current 获取），则您拥有当前路径；

*   使用当前路径从您存储设置的位置检索设置。

祝你好运。

* * *

## 回答 #2

> 赞同：-1
> 
>             
> 
> 时间：2009-01-09T09:38:19.927

谢谢。我已经做到了，而且效果很好。我还使用了反射器工具来查看处理程序映射匹配是如何进行的。我似乎遇到了另一个挑战。根据应用程序池的类型，有不同的方式来配置 httphandlers。有没有一种通用的方法来获取当前池 httphandlers 的配置数据？

# linq - 在 LINQ to 对象的语句中

> ID：423840
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-08T10:48:25.107
> 
>         
> 
> 标签：linq, linq-to-objects

LINQ to objects 中是否有等效的 SQL IN 语句？

* * *

## 回答 #1

> 赞同：16
> 
>             
> 
> 时间：2009-01-08T10:59:19.843

是 -[包含](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.contains.aspx)。

```
var desiredNames = new[] { "Jon", "Marc" };

var people = new[]
{
    new { FirstName="Jon", Surname="Skeet" },
    new { FirstName="Marc", Surname="Gravell" },
    new { FirstName="Jeff", Surname="Atwood" }
};

var matches = people.Where(person => desiredNames.Contains(person.FirstName));

foreach (var person in matches)
{
    Console.WriteLine(person);
} 
```

（在 LINQ to SQL 中，这最终作为“IN”查询。）

请注意，在 LINQ to Objects 中，上述内容并不是非常有效。加入会更好：

```
var matches = from person in people
              join name in desiredNames on person.FirstName equals name
              select person; 
```

（当然，这仍然可以使用点符号来完成，但最终会有点混乱。）

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2012-04-03T12:57:48.340

在这种情况下，我会选择 Inner Join。如果我使用`contains`，它会迭代 6 次，尽管事实上只有两个匹配项。我只是想在这里强调一下，我将使用 Joins 而不是 IN 谓词。

```
var desiredNames = new[] { "Pankaj" };

var people = new[] 
{ 
    new { FirstName="Pankaj", Surname="Garg" }, 
    new { FirstName="Marc", Surname="Gravell" }, 
    new { FirstName="Jeff", Surname="Atwood" } 
};

var records = (from p in people join filtered in desiredNames on p.FirstName equals filtered select p.FirstName).ToList(); 
```

# html - 如何在 Visual Basic.NET 中“HTML 编码”Em Dash

> ID：423841
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-08T10:48:59.193
> 
>         
> 
> 标签：html, vb.net, encoding

我正在生成一些要在网站上显示的文本，并使用[HttpUtility.HtmlEncode](http://msdn.microsoft.com/en-us/library/system.web.httputility.htmlencode.aspx)来确保它看起来正确。但是，这种方法似乎没有对[Em Dash](http://en.wikipedia.org/wiki/Mdash#Em_dash)进行编码（它应该将其转换为“—”）。

我想出了一个解决方案，但我确信有更好的方法 - 一些库函数或其他东西。

```
sWebsiteText = _
    "<![CDATA[" & _
    HttpUtility.HtmlEncode(sSomeText) & _
    "]]>"

'This is the bit which seems "hacky"'
sWebsiteText = _
    sWebsiteText.Replace(HttpUtility.HtmlDecode("&#8211;"), "&#8211;") 
```

所以我的问题是 - 你将如何实现“hacky”部分？

非常感谢，

RB。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T11:29:12.403

> 由于这个字符不是 ASCII 字符，我该如何编码呢？

它不是 ASCII 字符，而是 Unicode 字符，U+2014。如果您的页面输出将是 UTF-8，在当今时代它确实应该是，您不需要对其进行 HTML 编码，只需直接输出字符即可。

> 是否还有其他可能给我带来问题的角色。

它到底给你带来了什么问题？如果你不能输出'—'，你可能不能输出任何其他非ASCII Unicode 字符，这有数千个。

将“\u2014”替换为“—” 如果你真的必须这样做，但实际上使用今天的 Unicode 感知工具，应该没有必要用标记替换每个非 ASCII Unicode 字符。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T10:56:55.777

看看[A List Apart](http://www.alistapart.com/articles/emen)，正如我在[HTML Apostrophe](https://stackoverflow.com/questions/419718/html-apostrophe)问题中所建议的那样。

破折号 — 由 表示`&#8212;`。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-06-09T09:53:24.457

Bobince 的回答为您似乎主要关心的问题提供了一个解决方案：通过更直接地声明要替换的 char 来替换您对 HtmlDecode 的使用。

改写

```
sWebsiteText.Replace(HttpUtility.HtmlDecode("&#8211;"), "&#8211;") 
```

作为

```
sWebsiteText.Replace("\u2013", "&#x2013;") 
```

（'\u2014' (dec 8212) 是破折号，'\u2013' (dec 8211) 是破折号。）

为了便于阅读，最好使用“–” 而不是“–”，因为 .Net 对 char (“\u2013”​​) 的声明也是十六进制的。但是，由于十进制表示法在 html 中似乎更常见，我个人更喜欢使用“–”。

出于重用的目的，您可能应该编写自己的 HtmlEncode 函数，在自定义 HttpUtility 中声明，以便能够从站点中的任何其他位置调用它而无需复制它。

（有类似的东西（对不起，我是用 C# 写的，忘记你的例子是在 VB 中的）：

```
/// <summary>
/// Supplies some custom processing to some HttpUtility functions.
/// </summary>
public static class CustomHttpUtility
{
    /// <summary>
    /// Html encodes a string.
    /// </summary>
    /// <param name="input">string to be encoded.</param>
    /// <returns>A html encoded string.</returns>
    public static string HtmlEncode(string input)
    {
        if (intput == null)
            return null;
        StringBuilder encodedString = new StringBuilder(
            HttpUtility.HtmlEncode(input));
        encodedString.Replace("\u2013", "&#x2013;");
        // add over missing replacements here, as for &#8212;
        encodedString.Replace("\u2014", "&#x2014;");
        //...

        return encodedString.ToString();
    }
} 
```

然后更换

```
sWebsiteText = _
    "<![CDATA[" & _
    HttpUtility.HtmlEncode(sSomeText) & _
    "]]>"
'This is the bit which seems "hacky"'
sWebsiteText = _
    sWebsiteText.Replace(HttpUtility.HtmlDecode("&#8211;"), "&#8211;") 
```

和：

```
sWebsiteText = _
    "<![CDATA[" & _
    CustomHttpUtility.HtmlEncode(sSomeText) & _
    "]]>" 
```

)

# asp.net - 是否可以锁定 ASP.net 数据集

> ID：423855
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T10:53:53.677
> 
>         
> 
> 标签：asp.net, dataset

我有一个锁定整个数据集的要求。是否可以锁定没有进一步更新数据集的 ASP.net 数据集。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T11:45:36.287

我不这么认为，但你总是可以调用`DataSet.RejectChanges`方法

[http://msdn.microsoft.com/en-us/library/system.data.dataset.rejectchanges.aspx](http://msdn.microsoft.com/en-us/library/system.data.dataset.rejectchanges.aspx)

# php - PHP标头重定向不起作用

> ID：423860
> 
>         
> 
> 赞同：28
> 
>         
> 
> 时间：2009-01-08T10:55:06.077
> 
>         
> 
> 标签：php

```
include('header.php');

$name = $_POST['name'];
$score = $_POST['score'];
$dept = $_POST['dept'];

$MyDB->prep("INSERT INTO demo (`id`,`name`,`score`,`dept`, `date`) VALUES ('','$name','$score','$dept','$date')");
// Bind a value to our :id hook
// Produces: SELECT * FROM demo_table WHERE id = '23'
$MyDB->bind(':date', $date);
// Run the query
$MyDB->run();

header('Location:index.php');
    exit; 
```

上面的代码一直给我一个重定向问题。错误如下：

> 警告：无法修改标头信息 - 标头已由 /Applications/MAMP/htdocs/testygubbins/OO/test/form 中的（输出开始于 /Applications/MAMP/htdocs/testygubbins/OO/test/header.php:15）发送。 php 在第 16 行。

我对此完全感到困惑。有谁知道我应该怎么做才能让它工作？

编辑

header.php 代码：

```
<?php
include('class.user.php');
include('class.Connection.php');

$date = date('Y-m-j');

?>
<html>
<head>
    <link rel=StyleSheet href="css/style.css" type="text/css" media=screen>
    <title>Test</title>
</head>
<body>
<div id="page"> 
```

* * *

## 回答 #1

> 赞同：52
> 
>             
> 
> 时间：2009-01-08T11:01:58.760

仔细查看您的包含 - 也许您在关闭后有一个空行？>？

这将导致一些文字空白作为输出发送，从而阻止您进行后续的标头调用。

请注意，将关闭 ?> 保留在包含文件之外是合法的，这是避免此问题的有用习惯用法。

*（编辑：查看你的标题，如果你想输出标题，你需要避免做任何 HTML 输出，或者使用输出缓冲来捕获它）。*

最后，正如[标题的 PHP 手册页](http://php.net/header)指出的那样，您应该真正使用完整的 URL 来重定向：

> 注意：HTTP/1.1 需要绝对 URI 作为*Location 的参数：* 
>   包括方案、主机名和绝对路径，但有些客户端接受相对 URI。您通常可以使用 $_SERVER['HTTP_HOST']、$_SERVER['PHP_SELF'] 和 dirname() 自己从相对的 URI 中创建绝对 URI：

* * *

## 回答 #2

> 赞同：41
> 
>             
> 
> 时间：2014-07-24T08:23:44.900

# 常见问题：

**1)**命令前不应有任何输出（即**`echo...`**或 HTML 部分）**`header(...);`**。

**2)**`header(...);`必须使用后`exit();`  

**3)**删除标签前后的所有**空格**（或**换行符）。**`<?php``?>`

**4）**  检查 php 文件（以及其他`.php`文件，即`include`d）-它们应该具有**没有 BOM**编码的 UTF8 （而不仅仅是**UTF-8**）。因为默认的**UTF8**在文件开头添加了不可见字符（称为“ **BOM** ”），所以你应该避免这种情况!!!!!!!!!!!!

**5)**使用 301 或 302 参考：

```
header("location: http://example.com",  true,  301 );  exit; 
```

**6)** **打开错误报告。并告诉错误。**

**7）**如果以上都没有帮助，使用 JAVASCRIPT 重定向（但是，不鼓励的方法），可能是自定义情况下的最后机会......：

```
echo "<script type='text/javascript'>window.top.location='http://website.com/';</script>"; exit; 
```

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2009-01-08T12:36:12.080

或者，不要考虑文件中某处的换行符或空格，您可以缓冲输出。基本上，您`ob_start()`在文件的开头和`ob_end_flush()`结尾调用。[您可以在php.net ob-start 函数描述](http://uk.php.net/ob-start)中找到更多详细信息。

**编辑：**
如果您使用缓冲，则可以在 header() 函数之前和之后输出 HTML - 然后缓冲将忽略输出并仅返回重定向标头。

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2012-07-06T11:02:59.060

试试这个 ：

```
**ob_start();**

include('header.php');

$name = $_POST['name'];
$score = $_POST['score'];
$dept = $_POST['dept'];

$MyDB->prep("INSERT INTO demo (`id`,`name`,`score`,`dept`, `date`) VALUES ('','$name','$score','$dept','$date')");
// Bind a value to our :id hook
// Produces: SELECT * FROM demo_table WHERE id = '23'
$MyDB->bind(':date', $date);
// Run the query
$MyDB->run();

header('Location:index.php');

**ob_end_flush();**

    exit; 
```

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T10:58:35.303

查看 /Applications/MAMP/htdocs/testygubbins/OO/test/header.php 第 15 行。

在那个位置，它会产生一些输出。修理它。:)

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T11:01:41.803

如果我理解正确的话，header.php（可能是一些 HTML）已经发出了一些东西，所以标题已经设置好了。您可能需要重新检查 header.php 文件中任何可能输出 HTML 或空格的部分 

**编辑：**我现在确定它是由 header.php 引起的，因为你有那些 HTML 输出。您可以通过删除“include('header.php');”来解决此问题 行并将以下代码复制到您的文件中。

```
include('class.user.php');
include('class.Connection.php');

        $date = date('Y-m-j'); 
```

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T11:02:35.577

您可能在 php 文件中的某处有一些“纯文本”，这些文件被解释为脚本输出。它甚至可能是 php 脚本标记说明符之前或之后的换行符（小于 + 问号 + "php"）。

此外，如果我没记错的话，根据 http 规范，“Location”标头只接受完整的 URL，而不是相对位置。也请记住这一点。

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T11:05:00.173

不要包含 header.php。当你要重定向时，你不应该输出 HTML。

制作一个新文件，例如。“pre.php”。把这个放进去：

```
<?php
include('class.user.php');
include('class.Connection.php');
?> 
```

然后在 header.php 中，包含它，而不是包含其他两个文件。在 form.php 中，包含 pre.php 而不是 header.php。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-06-20T11:11:43.017

您的 include 会产生输出，因此以后无法发送 http 标头。两种选择：

1.  将输出移动到包含之后的某处。

2.  使用[输出缓冲](http://www.php.net/manual/en/book.outcontrol.php)，即在脚本的最开始放置ob_start()，最后放置ob_flush()。这使 PHP 能够首先等待所有输出被收集，确定以什么顺序呈现它，然后输出它。

我建议您学习第二种选择，因为它使您更加灵活。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2013-02-19T15:21:26.383

也可以尝试 include_once() 而不是 include() 也可以工作

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2010-01-31T15:44:01.697

另请参阅您的**php**文件文本编码。我的是`UTF-8`，`BOM`它阻止了脚本工作。但是现在删除后可以完美运行`BOM`...

* * *

## 回答 #12

> 赞同：-1
> 
>             
> 
> 时间：2011-04-22T12:35:47.727

尝试使用 JavaScript 重定向：

```
<script type="text/javascript">
  window.location.href='index.php';
</script> 
```

# c# - 未知异常日期时间 C#

> ID：423865
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T10:56:35.263
> 
>         
> 
> 标签：c#, datetime, matchevaluator

我发送给 convertStringToDataSet 函数的数据是

```
 <NewDataSet>\r\n  <Table ID="Table1">
                \r\n
                <PATNAME>Doe,JaneN</PATNAME>\r\n
                <LEVEL>175</LEVEL>\r\n
                <WHEN>2007-09-13T23:00:00.0000000-05:00</WHEN>\r\n
                <NOTE>New 180-day low -- ALERT: loss of 11.6 % in 123 days</NOTE>\r\n
                <IS_BAD>32</IS_BAD>\r\n
                <NAME>202a</NAME>\r\n
                <ID>2459</ID>\r\n
                <LASTNAME>Doe</LASTNAME>\r\n
                <FIRSTNAME>Jane</FIRSTNAME>\r\n
                <MIDDLENAME>N</MIDDLENAME>\r\n
            </Table>\r\n  <Table ID="Table2">
                \r\n
                <PATNAME>Face,SmileyE</PATNAME>\r\n
                <LEVEL>124</LEVEL>\r\n
                <WHEN>2007-10-16T23:00:00.0000000-05:00</WHEN>\r\n
                <NOTE>New 180-day low -- ALERT: loss of 14.5 % in 86 days</NOTE>\r\n
                <IS_BAD>32</IS_BAD>\r\n
                <NAME>101b</NAME>\r\n
                <ID>2736</ID>\r\n
                <LASTNAME>Face</LASTNAME>\r\n
                <FIRSTNAME>Smiley</FIRSTNAME>\r\n
                <MIDDLENAME>E</MIDDLENAME>\r\n
            </Table>\r\n</NewDataSet> 
```

```
 private DataSet convertStringToDataSet(string xmlString)
        {
            // Search for datetime values of the format 
            // --> 2004-08-22T00:00:00.0000000-05:00
            string rp = @"(?\d{4}-\d{2}-\d{2})(?T\d{2}:\d{2}:\d{2}.\d{7}-)(?\d{2})(?:\d{2})";
            // Replace UTC offset value

            string fixedString = Regex.Replace( xmlString, rp, new MatchEvaluator( getHourOffset ) );

            DataSet dataSet = new DataSet();
            StringReader stringReader = new StringReader( fixedString );
            dataSet.ReadXml( stringReader );

            return dataSet;
        }

        private static string getHourOffset( Match m )
        {
            // Need to also account for Daylights Savings 
            // Time when calculating UTC offset value
            string Date=m.Result( "${date}" );
            DateTime dtLocal = DateTime.Parse( m.Result( "${date}" ) );
            DateTime dtUTC = dtLocal.ToUniversalTime();
            int hourLocalOffset = dtUTC.Hour - dtLocal.Hour;
            int hourServer = int.Parse( m.Result( "${hour}" ) );
            string newHour = ( hourServer + ( hourLocalOffset - 
                hourServer ) ).ToString( "0#" );
            string retString = m.Result( "${date}" + "${time}" +
                newHour + "${last}" );

            return retString;
        } 
```

我得到的异常字符串未被识别为有效的日期时间。从索引 2 开始有一个未知单词。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T11:10:32.440

DateTime.Parse 将尝试各种不同的模式。假设您已经有了明确的格式，我会使用[DateTime.ParseExact](http://msdn.microsoft.com/en-us/library/system.datetime.parseexact.aspx) - 这样您就知道它在寻找什么。

正如 lassevk 所说，在尝试解析之前先查看字符串。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T11:04:12.097

你有没有调试过它并在那里设置一个断点来验证你得到的字符串实际上是你期望的字符串？

另外，这个：

```
m.Result( "${date}" ) 
```

该组在哪里定义？

我会将 Regex 找到的值的提取拆分为字符串，然后将其转换。这将允许您在其中放置一个断点并检查找到的值。

# c# - 如何使用 C# 中的 TIBCO RV 获得更好的性能？

> ID：423866
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-08T10:56:41.627
> 
>         
> 
> 标签：c#, .net, optimization, tibco, tibco-rv

我正在使用**TIBCO RV .NET API** (TIBCO.Rendezvous.dll)。

您是否知道在性能方面是否有更好的方法可以**在 C# 中**从 RV 通道接收和读取消息？我发现`Message`类型 - RV 消息的逻辑包装器 - 非常重。*通过名称或索引获取字段可能会非常慢*，尤其是当我们将其视为循环/高频操作时。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-24T11:55:55.747

c# 包装器的主要问题是：

*   为任何字段访问分配（c/C++ api 为最可能的原语公开强类型快速访问器

*   在每个字段访问上标记引用（除非您计划随后更新字段并希望避免内存泄漏，否则您不需要这样做）

*   按名称查找字段需要将字符串转换为 ac 样式的 ascii 字符串

这些方面将使底层基于字段/名称的查找的开销相形见绌，当您知道需要通过按顺序遍历字段来查看消息中的每个字段时，这些开销本身就可以避免。这在 C/C++ 中很快，因为它通过内存线性工作，因此对缓存友好。

就个人而言，我们直接用 C++ CLI 封装了 C++ api（当时 .net 库的质量不达标）。这很复杂（特别是如果您有多个应用程序域），但性能接近于 C++ api（它是 C api 的一个非常薄的包装器）。

如果您的分析告诉您消息访问中的分配阻止您的应用程序以您需要/想要的速度运行，我担心您的 .net 库会出现问题。您可以使用反射来获取原生消息的底层 IntPtr，然后使用 MessageToolbaox（dll 中的内部类）中相同的外部定义函数，这些函数下拉到原生 api，每次访问内部字段的成本更快的字段查找可能会抵消消息。这显然是脆弱且难以维护的，但如果您发现与完全重新实现其包装器相比它是值得的，它可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-12-19T23:13:07.903

我也见过同样的事情。根据我的经验，与在 C++ 中访问它们相比，访问 C# Rv 消息中的字段非常慢。因此，您要避免在消息中添加和读取多个字段。

一种解决方案是不使用 Rv 自己的消息序列化。也就是说，不要用Message.AddField()添加很多字段，或者用Message.GetField()获取它们。相反，您可以将数据序列化为不透明类型（这是一个二进制缓冲区，即字节数组）。然后，您可以将此单个字段添加到消息中。

如果您所做的只是读取和写入一个字段，则开销很小。而且您应该能够非常快地序列化和反序列化您自己的代码中的数据。

# c# - NHaml配置问题：找不到模型

> ID：423876
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-08T10:59:44.973
> 
>         
> 
> 标签：c#, .net, asp.net-mvc, nhaml

我的 NHaml 配置有一点问题：

```
<configSections>
    <section name="nhaml" type="NHaml.Configuration.NHamlConfigurationSection, NHaml"/>
</configSections>

<nhaml AutoRecompile="true">
  <assemblies>
    <add assembly="Microsoft.Web.Mvc"/>
    <add assembly="MyAssembly"/>
  </assemblies>
  <namespaces>
    <add namespace="NHaml.Web.Mvc"/>
    <add namespace="MyAssembly.Models"/>
    <add namespace="System.Linq"/>
  </namespaces>
</nhaml> 
```

问题是我试图在我的视图中使用来自 MyAssembly.Models 的模型：

```
%ul
  - foreach(var v in (IQueryable<Model>)ViewData["stat"])
    %li= v.name 
```

但它一直在崩溃，告诉我 MyAssembly.Models.Model 无法识别，并问我是否缺少 using 指令。我的 web.config 或我的视图有什么问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-09T01:29:16.827

我没有使用过 NHaml，因为它是 MvcContrib 的一部分，但那时我通过在配置中指定完整的程序集名称来拥有自己的模型，例如：

```
MyAssembly, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null 
```

# .net - 有人用过 Manco.net Licensing for .Net 吗？

> ID：423889
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T11:04:01.533
> 
>         
> 
> 标签：.net, licensing

[http://www.mancosoftware.com/licensing/index.htm](http://www.mancosoftware.com/licensing/index.htm)

只是想知道你对它的想法是什么，如果它对 80 美元的收费来说相对较好。我们意识到东西仍然会被破解，但群众的预防也是值得考虑的。

任何输入表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-16T02:49:14.890

是在某种强制执行和不强制执行之间进行选择，还是您正在寻找使用该特定产品的经验？

虽然我从未特别使用过 Manco，但我使用过其他许可选项，我唯一的建议是，如果您决定完全添加许可，请坚持最低限度 - 在这种情况下，只需解锁密钥，或者他们的基本包。当您开始添加激活 Web 服务，然后您不让客户将他们的软件从一台 PC 移动到另一台 PC 时，您开始给已经为您的软件付费的普通用户带来不便，这绝不是一件好事。

你是对的，无论如何它总是会被破解，最后，你必须进行成本效益分析，以确定添加许可是否真的值得。公式如下所示：

如果（从没有许可的情况下不会支付软件费用的人购买）-（从因您的许可而被吓跑或有问题并要求退款的人失去销售）- 80 美元 > 0

然后添加许可。如果不是（即销售/客户流失 > 额外购买），则无需强制执行即可发布它，因为这样会更好（您仍然可以发布限时演示，以及仅限购买的特殊下载你的网页）

看起来他们为这个产品提供了 15 天的试用期——如果它有效，那么作为开发人员，这对你来说是值得的 80 美元，但前提是它根本不会给你的用户带来不便。如果您在试用过程中遇到任何问题，您可以肯定他们也会遇到问题，这是不值得的。

PS：Eric Sink[在他的书中谈到了这一点](http://books.google.com/books?id=h5IQuengOGIC&pg=PA241&lpg=PA241&dq=eric+sink+license+enforcement&source=bl&ots=xt8sIkvuxO&sig=VDCbRv1HZieZ7Lx86iM4drKVdOs&hl=en&sa=X&oi=book_result&resnum=1&ct=result#PPA241,M1)。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-27T07:27:46.147

我们在半年期间使用此 .net 许可产品的 3.3 版。我不确定低价版（80 美元）有多好。它似乎禁用了某些功能。我们正在使用“标准版”和“激活网络服务”。这对对我们有好处。它非常稳定，人们提供了很好的支持。Manco Software 前段时间发布了新版本。我们正在测试当前考虑升级的新功能。

# inversion-of-control - 哪些 IOC 容器适用于 Windows Azure

> ID：423896
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T11:05:09.973
> 
>         
> 
> 标签：inversion-of-control, azure

我开始掌握 Windows Azure。我通常在 Web 应用程序中使用 NInject 作为我的 IoC 容器。但是，当尝试在 Azure Web 角色中使用它时，我得到一个安全异常（与反射权限有关）。

有没有人在 Azure 中使用过其他 IoC 并取得了成功？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-21T14:44:07.773

我今天只是在使用 Azure 服务进行原型设计（但不是 Web 角色）。Autofac IoC Container for .NET 在这种情况下工作。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-22T13:35:50.033

来自 Ninject 谷歌组：[http ://groups.google.com/group/ninject/browse_thread/thread/8d5a0aff853c6b4f/20209877f8db179a?show_docid=20209877f8db179a](http://groups.google.com/group/ninject/browse_thread/thread/8d5a0aff853c6b4f/20209877f8db179a?show_docid=20209877f8db179a)

如果设置内核选项 UseReflectionBasedInjection，Ninject 将在 Azure（以及其他部分信任环境）中工作：

```
var options = new KernelOptions
{ 
    UseReflectionBasedInjection = true
}; 
var kernel = new StandardKernel(options, new ModuleA(), new ModuleB(), ...); 
```

# algorithm - 表达式树的后缀符号

> ID：423898
> 
>         
> 
> 赞同：28
> 
>         
> 
> 时间：2009-01-08T11:05:46.570
> 
>         
> 
> 标签：algorithm, language-agnostic

关于如何将表达式树转换为后缀符号有足够的资源，而且并不难。

但我必须将后缀表达式解析为表达式树。

表达式为：

> A 2 ^ 2 A * B * - B 2 ^ + AB - /

我真的不知道如何解释这个表达式。有人知道如何处理这个吗？

* * *

## 回答 #1

> 赞同：58
> 
>             
> 
> 时间：2009-01-08T11:09:05.487

创建一个堆栈，其中包含可能是树的一部分的节点

1.  将操作数推入堆栈（A、2、B 等是操作数）作为叶节点，不绑定到任何方向的任何树

2.  对于操作符，将必要的操作数从堆栈中弹出，创建一个操作符在顶部的节点，操作数挂在其下方，将新节点压入堆栈

对于您的数据：

1.  将 A 压入堆栈

2.  将 2 压入堆栈

3.  弹出 2 和 A，创建 ^-node（下面有 A 和 2），将其压入堆栈

4.  将 2 压入堆栈

5.  将 A 压入堆栈

6.  弹出 A 和 2 并组合形成 *-node

7.  等等

8.  等等

![树状结构](https://i.stack.imgur.com/kmMp9.png)

这是一个可以试验的[LINQPad程序：](http://linqpad.net)

```
// Add the following two using-directives to LINQPad:
// System.Drawing
// System.Drawing.Imaging

static Bitmap _Dummy = new Bitmap(16, 16, PixelFormat.Format24bppRgb);
static Font _Font = new Font("Arial", 12);

void Main()
{
    var elementsAsString = "A 2 ^ 2 A * B * - B 2 ^ + A B - / 2 ^";
    var elements = elementsAsString.Split(' ');

    var stack = new Stack<Node>();
    foreach (var element in elements)
        if (IsOperator(element))
        {
            Node rightOperand = stack.Pop();
            Node leftOperand = stack.Pop();
            stack.Push(new Node(element, leftOperand, rightOperand));
        }
        else
            stack.Push(new Node(element));

    Visualize(stack.Pop());
}

void Visualize(Node node)
{
    node.ToBitmap().Dump();
}

class Node
{
    public Node(string value)
        : this(value, null, null)
    {
    }

    public Node(string value, Node left, Node right)
    {
        Value = value;
        Left = left;
        Right = right;
    }

    public string Value;
    public Node Left;
    public Node Right;

    public Bitmap ToBitmap()
    {
        Size valueSize;
        using (Graphics g = Graphics.FromImage(_Dummy))
        {
            var tempSize = g.MeasureString(Value, _Font);
            valueSize = new Size((int)tempSize.Width + 4, (int)tempSize.Height + 4);
        }

        Bitmap bitmap;
        Color valueColor = Color.LightPink;
        if (Left == null && Right == null)
        {
            bitmap = new Bitmap(valueSize.Width, valueSize.Height);
            valueColor = Color.LightGreen;
        }
        else
        {
            using (var leftBitmap = Left.ToBitmap())
            using (var rightBitmap = Right.ToBitmap())
            {
                int subNodeHeight = Math.Max(leftBitmap.Height, rightBitmap.Height);
                bitmap = new Bitmap(
                    leftBitmap.Width + rightBitmap.Width + valueSize.Width,
                    valueSize.Height + 32 + subNodeHeight);

                using (var g = Graphics.FromImage(bitmap))
                {
                    int baseY  = valueSize.Height + 32;

                    int leftTop = baseY; // + (subNodeHeight - leftBitmap.Height) / 2;
                    g.DrawImage(leftBitmap, 0, leftTop);

                    int rightTop = baseY; // + (subNodeHeight - rightBitmap.Height) / 2;
                    g.DrawImage(rightBitmap, bitmap.Width - rightBitmap.Width, rightTop);

                    g.DrawLine(Pens.Black, bitmap.Width / 2 - 4, valueSize.Height, leftBitmap.Width / 2, leftTop);
                    g.DrawLine(Pens.Black, bitmap.Width / 2 + 4, valueSize.Height, bitmap.Width - rightBitmap.Width / 2, rightTop);
                }
            }
        }

        using (var g = Graphics.FromImage(bitmap))
        {
            float x = (bitmap.Width - valueSize.Width) / 2;
            using (var b = new SolidBrush(valueColor))
                g.FillRectangle(b, x, 0, valueSize.Width - 1, valueSize.Height - 1);
            g.DrawRectangle(Pens.Black, x, 0, valueSize.Width - 1, valueSize.Height - 1);
            g.DrawString(Value, _Font, Brushes.Black, x + 1, 2);
        }

        return bitmap;
    }
}

bool IsOperator(string s)
{
    switch (s)
    {
        case "*":
        case "/":
        case "^":
        case "+":
        case "-":
            return true;

        default:
            return false;
    }
} 
```

输出：

![LINQPad 输出](https://i.stack.imgur.com/40x9S.png)

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-01-08T11:10:54.720

这看起来是否正确：

```
for n in items:
    if n is argument:
        push n
    if n is operator:
        b = pop      // first pop shall yield second operand   
        a = pop      // second pop shall yield first operand
        push a+n+b
 answer = pop

A 2 ^ 2 A * B * - B 2 ^ + A B - / 
```

在你的 statment 上运行它应该会产生一个像这样演变的堆栈：

```
[A]
[A, 2]
[A^2]
[A^2, 2]
[A^2, 2, A]
[A^2, 2*A]
[A^2, 2*A, B]
[A^2, 2*A*B]
[A^2-2*A*B]
[A^2-2*A*B, B]
[A^2-2*A*B, B, 2]
[A^2-2*A*B, B^2]
[A^2-2*A*B+B^2]
[A^2-2*A*B+B^2, A]
[A^2-2*A*B+B^2, A, B]
[A^2-2*A*B+B^2, A-B]
[A^2-2*A*B+B^2/A-B] 
```

# c# - XMLTextReader.ReadSubtree 返回 XMLTextReader

> ID：423899
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T11:06:45.273
> 
>         
> 
> 标签：c#, xmlreader

我正在使用 XMLTextReader 来处理 XML 文件（而不是 XMLDocument）。我使用 XMLTextReader，所以我可以使用忽略所有空格的选项。

在某些时候，我想使用 ReadSubtree 读取节点。这将返回一个 XMLReader。如何将其转换为 XMLTextReader，以便我可以使用忽略空格选项。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T11:54:55.380

我认为您应该能够使用 XmlReader.ReadOuterXml() 方法将整个子树作为字符串返回。然后，您可以使用它来创建 StringReader 并再次使用它来创建 XmlTestReader。

笨拙，但它应该工作。

哦。顺便一提。ReadSubtree 返回一个从 XmlReader 派生的 XmlSubtreeReader，因此您不能将它直接转换为 XmlTextReader。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T11:16:14.223

您可以将返回的 XmlReader 转换为 XmlTextReader。

# php - PHP PDF 生成 - IE7/Acrobat8：“网站无法显示”

> ID：423900
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-08T11:06:54.070
> 
>         
> 
> 标签：php, pdf, internet-explorer-7, pdf-generation

我在 IE7 中显示 pdf 时遇到了一些麻烦（由 R&OS 的 ezpdf 生成）。

带有 Acrobat Reader 8.1.2 的 IE7。说“页面无法显示”

其他浏览器（如 FF3/Acrobat 8​​.1.2\. 或 IE6/Acrobat 7）对该文件没有问题。

服务器返回以下标头：

> 日期：2009 年 1 月 8 日星期四 10:52:40 GMT
> 
>   服务器：Apache/2.2.8 (Win32) mod_ssl/2.2.8 OpenSSL/0.9.8g PHP/5.2.5 DAV/2 
> 
>   X-Powered-By: PHP/5.2 .5
> 
>   过期：星期四，1981 年 11 月 19 日 08:52:00 GMT
> 
>   缓存控制：无存储，无缓存，必须重新验证，后检查 = 0，预检查 = 0
> 
>   编译指示：无缓存
> 
>   内容长度: 4750 
> 
>   Keep-Alive: timeout=5, max=100 
> 
>   Connection: Keep-Alive 
> 
>   Content-Type: application/pdf

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T12:28:52.470

> Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache

...所以 IE 不会将文件存储在 Temporary Internet Files 文件夹中。然而，用于在 IE 中直接从浏览器“打开”文件的机制通常需要从 Internet 临时文件中打开它。直接从浏览器打开文件一般是不可靠的，尤其是在 IE 中；“另存为”效果更好。

考虑用另一种方法替换 cachebusting 标头，例如向 URL 添加“？randomstring”参数。还可以考虑添加“Content-Disposition: attachment; filename=...”标头，这将阻止插件尝试在浏览器 UI 中显示文件，但无法显示该文件。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T12:27:41.427

我想我已经解决了这个问题。

问题*不在*服务器端，而是在客户端。生成的 PDF 显示在弹出窗口（javascript：window.open）和 IE7 上。

当我在重定向到 PDF 的弹出窗口中打开一个 html 文件时，它可以工作。

# python - Intranet CMS 的哪个软件 - Django 或 Joomla？

> ID：423916
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T11:12:38.600
> 
>         
> 
> 标签：python, django, content-management-system, joomla

在我的公司，我们正在考虑从 wiki 风格的 Intranet 转移到更定制的 CMS 解决方案。自然选择是 Joomla，但我们有一个特定的架构。有几百人将使用该系统。系统应该是可自我解释的（比 wiki 更容易）。

我们使用很多工具网络、应用程序并集成在 3rd 方软件中。将它们粘合在一起的优越元素是 API。例如，对于内部网工具，我们确实使用了 Django，但它没有使用 ORM，仅限于模板和 url - 每个应用程序在我们的 API 中都有足够的方法。我们不使用 Django 管理界面，因为它几乎不依赖于 ORM。

因此，Joomla 可能很难集成。每个员工都应该能够编辑大部分页面，身份验证和权限必须由我们的 API 管理。

插入 Joomla 以使用不同的身份验证过程有多难？（仅限扩展 - 没有黑客）

如果一个人比 Joomla 更了解 Django，应该使用 Django 吗？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-01-08T11:24:00.167

Django 不是 CMS。如果您想构建一个应用程序，那么您将使用 Django（但从您的帖子的声音您可以理解）。如果您只想能够编辑/存储内容并为您的用户拥有权限 - CMS 将是您的最佳选择。我真的对Joomla一无所知。模拟一个黑客来做任何你需要的身份验证应该很容易——即使这只是一个直接发送到服务器的 POST。

Django 将需要很长时间才能达到您将其用于您提到的目的的地步。需要使用管理界面（或者您正在从头开始构建 CMS）——这意味着创建模型来对您已经拥有的内容进行建模。然后您必须自定义每个模型页面，并“插入”您想要的任何身份验证系统。

很多工作。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-01-08T12:14:33.780

也许你可以检查[Django CMS](http://django-cms.org/)。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-06-25T04:43:13.427

> 在今天的会议上取消了 Plone 选项。

在我看来，Plone 对于构建 Intranet 非常强大。

一些参考资料：

*   [克隆](http://plone.org)

*   [构建内部网：Drupal 与 Plone](http://nootech.blogspot.com/2007/04/building-intranet-drupal-vs-plone.html)

*   [内网2.0](http://intranetblog.blogware.com/blog/Intranet20)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T14:19:09.223

Joomla！有认证插件；您可以编写自己的代码而无需破解内核。当有人尝试登录您的站点时，它将遍历所有已发布的身份验证插件（按照您设置的顺序），直到一个返回 true。如果您只想使用一种方法，请取消发布除您的自定义插件之外的所有其他插件。

还有，Joomla！如果您的系统支持，则已经有 LDAP 插件。

可能更困难的部分是通过 API 管理特定权限。Joomla！目前缺乏组级访问控制；它目前具有权限级别的访问控制（编辑者、发布者、管理员等...）。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T18:33:36.760

当你用 Python 标记你的问题时，你可以看看 plone ( [http://plone.org](http://plone.org) )

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2010-04-13T17:20:56.423

如果您使用 FLEXIcontent 和 FLEXiaccess，您可以获得 Joomla 的细粒度权限

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T12:38:23.123

Django CMS 的工作方式需要使用内置的 ORM 模型和管理界面。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-01-09T13:26:49.290

谢谢你的所有答案。

在今天的会议上取消了 Plone 选项。

使用 Joomla 将涉及大量编码以使其充当 Intranet 的其余部分。我认为在 Django 中编写一个 CMS（从现有的 cms 解决方案中“窃取”一些代码）会赢。Newforms 非常有趣，应该不会那么难（我已经在我自己的框架上用 PHP 编写了一个 CMS 系统——在大约 15 个站点上使用过）

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-06-30T10:26:01.623

感谢那。该系统是由上级管理人员在我背后选择的。

是银条。

*   缓慢的管理界面

*   公司里没有经验丰富的程序员知道这个产品

*   由一位平面设计师实施，他将在大约两周后离开，但“他可以做咨询，因为他将成为一名自由职业者”

我一点都不开心

再次感谢。

# asp.net - 如何在 ASP.NET 应用程序中使用图像调整大小来防止 DOS 攻击？

> ID：423918
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T11:12:56.023
> 
>         
> 
> 标签：asp.net

我目前正在开发一个网站，用户可以在其中上传图像以用作头像，我知道这让我听起来有点偏执，但我想知道如果恶意用户上传尺寸非常大的图像会吃掉服务器内存怎么办（如DOS 攻击），我已经对可以上传的文件大小（250 k）设置了限制，但是如果图像是包含一种颜色并使用一个非常低质量的设置。考虑到图片在调整大小（即未压缩）时是作为位图上传到内存中的，我想知道是否会发生这种DOS攻击，即使要检查图像尺寸也必须先上传到内存中，你听说过吗任何利用这一点的攻击？我是不是太担心了？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T11:27:19.863

尺寸应该能够在不将整个图像映射加载到内存的情况下获得？[也许您可以在wotsit.org](http://www.wotsit.org/)找到更多关于这个问题的信息。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T11:30:43.900

您必须验证图像文件确实是图像文件。问题不是对您的服务器的攻击。问题是有人上传了 ActiveX 控件而不是图像。然后，此文件会下载并安装并破坏执行下载的每台 Windows 机器。

威胁不在于你。威胁是您将成为病毒的携带者。

您必须验证每个文件以确认它*是*真实的图像文件。如果需要，您可以检查尺寸和其他内容。大多数图像处理库可以从图像中读取标题，检查像素的尺寸和数量等等。

通常，人们会根据图像制作缩略图，您也可以在打开图像后这样做。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2010-04-07T00:18:49.123

DoS 可能是也可能不是问题 - 这取决于是否有人决定以您的网站为目标。

但是，为了让您的站点扩展到 1000 多个并发用户，您可以考虑在单独的过程中处理图像处理。

当图像处理由页面代码处理时，您将面临耗尽内存、CPU 或 ASP.NET 线程的风险——瓶颈取决于您的服务器配置。

可能的解决方案：

1.  用户上传图片。

2.  图像保存到共享目录。

3.  图像路径保存到数据库中的队列中。

4.  页面返回消息“感谢上传，您的头像将很快准备就绪”。

5.  Windows 服务* 定期唤醒并检查数据库队列。

6.  该服务调整队列中等待的任何图像的大小，将输出保存到共享目录，并将它们从队列中删除。

7.  服务更新数据库，指示用户的头像已准备好。因此，下次他们访问他们的个人资料页面时，他们会看到调整后的图像。

*理想情况下，Windows 服务在与 Web 服务器不同的服务器上运行，可以扩展以满足未来的需求。

这项努力是否值得取决于您的预期流量。您可以使用负载测试工具编写脚本并模拟这些操作，以查看您的站点是否可以处理负载。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T11:25:06.717

我认为您应该简单地检查图像尺寸。只有几种格式，这并不难，然后您可以轻松过滤掉大图像。通常，您可以上传头像的网站会告诉您不仅要有小于特定文件大小的图像，还要提供图像尺寸边框，因此通常会检查这一点。

# javascript - AJAX 调用的链接不起作用

> ID：423919
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T11:13:43.527
> 
>         
> 
> 标签：javascript, ruby-on-rails, ajax, cross-browser

大家好，我正在编写一个 Rails 应用程序，我包含一些 link_to_remote 链接生成的代码是

```
<a href="#" onclick="new Ajax.Request('/b10/categories/games?category=Action', {asynchronous:true, evalScripts:true}); return false;">Test</a> 
```

这在 Safari 和 Firefox 上运行得非常好，但是当我尝试点击 IE7 和 Opera 上的链接时，它甚至没有点击服务器。

有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T13:49:52.650

使用完全限定的 URL：`http://.....`

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T11:40:01.167

无论如何，将所有这些代码都包含在`<a href>`标签中是一种不好的做法。我建议你做一个功能，例如：

```
function doAjax(url)
{
   new Ajax.Request(url, {asynchronous:true, evalScripts:true});
   return false;
} 
```

在javascript代码中。并将网址更改为：

```
<a href="#" onclick="return doAjax('/b10/categories/games?category=Action');">
Test</a> 
```

# asp.net-mvc - 在asp.net mvc中带有下拉列表的modelbinder

> ID：423920
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-01-08T11:13:57.380
> 
>         
> 
> 标签：asp.net-mvc

这是我正在尝试做的事情：

我有一个具有 TaskName 属性和**TaskPriority属性的实体****任务**。

 **现在，在 html 中我有：

```
<td><%=Html.TextBox("Task.TaskName") %></td>
<td><%=Html.DropDownList("Task.TaskPriority",new SelectList(ViewData.Model.TaskPriorities,"ID","PriorityName")) %></td> 
```

控制器动作是这样的：

```
public ActionResult Create(Task task){
    //task.TaskName has the correct value
    //task.TaskPriority is null - how should the html look so this would work ?
} 
```

**编辑**
在下面的示例中（来自 Schotime）：

```
public class Task
{
    public int name { get; set; }
    public string value { get; set; } // what if the type of the property were Dropdown ?
       // in the example I gave the Task has a property of type: TaskPriority.
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
>             
> 
> 时间：2009-01-08T12:39:54.290

这应该有效。

三类：

```
 public class Container
    {
        public string name { get; set; }
        public List<Dropdown> drops { get; set; }
    }

    public class Dropdown
    {
        public int id { get; set; }
        public string value { get; set; }
    }

    public class Task
    {
        public int name { get; set; }
        public TaskPriority priority { get; set; }
    }

    public class TaskPriority
    {
        public string value { get; set; }
        ...
    } 
```

控制器：

```
 public ActionResult Tasks()
    {
        List<dropdown> ds = new List<Dropdown>();
        ds.Add(new Dropdown() { id = 1, value = "first" });
        ds.Add(new Dropdown() { id = 2, value = "second" });

        ViewData.Model = new Container() { name = "name", drops = ds };

        return View();
    }

    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Tasks(Task drops)
    {
        //drops return values for both name and value
        return View();
    } 
```

视图：强类型`Viewpage<Container>`

```
<%= Html.BeginForm() %>
<%= Html.TextBox("drops.name") %>
<%= Html.DropDownList("drops.priority.value",new SelectList(ViewData.Model.drops,"id","value")) %>
<%= Html.SubmitButton() %>
<% Html.EndForm(); %> 
```

当我调试它按预期工作。如果您有类似的情况，不确定您做错了什么。干杯。

# c# - XmlDocument 和缓慢的架构处理

> ID：423921
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-01-08T11:14:18.987
> 
>         
> 
> 标签：c#, .net, xml, dtd, xmldocument

我有一个需要加载到 XmlDocument 中的 xml 模板文档。例如

```
myXMLDocument.Load(myXMLFile); 
```

然而，这非常慢，因为它在 dtd 中加载。我已经尝试过`"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"`dtd 和本地副本。两者或多或少都需要相同的时间。如果我通过将解析器设置为 null（例如）来加载 dtd，则会收到错误消息，例如`"Reference to undeclared entity 'nbsp'"`文档是否包含这些错误。

我需要使用 XmlDocument，因为我需要在输出文档之前操作 DOM。我怎样才能绕过这些问题？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T13:18:19.220

ChrisW 的回答听起来很有趣，但是我从这个链接实现了一个缓存解析器：http: [//msdn.microsoft.com/en-us/library/bb669135.aspx](http://msdn.microsoft.com/en-us/library/bb669135.aspx)

这将速度从大约 11.5 秒提高到了 160 毫秒，这对于现在来说可能已经足够了。如果它仍然不够快，我将实施 ChrisW 的解决方案。:)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2011-05-13T13:06:56.973

如果返回一个空的内存流，则可以避免 DTD：

```
private class DummyResolver : XmlResolver
{
   public override System.Net.ICredentials Credentials
   {
    set
    {
     // Do nothing.
    }
   }

public override object GetEntity(Uri absoluteUri, string role, Type ofObjectToReturn)
   {
    return new System.IO.MemoryStream();
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T11:20:57.350

查看 DTD 文件，网上有更多 .mod 文件的参考资料，也许这些会减慢处理速度。您也可以尝试将其中一些注释掉，其中一些但并非全部在注释中标记为“必需”。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T11:33:52.223

它很慢，因为它是从网络下载的。要解决此问题，请执行以下操作：

*   下载 DTD 引用的 *.mod 和 *.ent 文件（您的 XmlResolver 实例将告诉您正在查找的 URI 的名称）

*   将这些文件作为资源文件添加到您的项目中

*   定义 XmlResolver 的子类，其 GetEntity() 方法返回从本地资源文件创建的流

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2009-01-08T11:22:36.893

您是否尝试过创建一个虚拟解析器，它为任何 dtd 路径返回 null 并将其传递给 load 命令？就像是：

```
class DummyResolver : XmlUrlResolver 
{
    public override Uri ResolveUri (Uri baseUri, String relativeUri) 
    {
       return null;
    }
}

XmlDocument xmlDocument = new XmlDocument();
xmlDocument.XmlResolver = new DummyResolver();

xmlDocument.Load(@"whatever.xml"); 
```

# java - 如何在休眠拦截器中获取休眠会话？

> ID：423924
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-01-08T11:14:59.593
> 
>         
> 
> 标签：java, hibernate, orm

如何在休眠拦截器中获取休眠会话？

我正在尝试使用 Hibernate 通过组织 ID 透明地强制执行数据访问。我设置了一个全局过滤器来按组织 ID 过滤所有查询。现在，我需要在保存/更新之前使用实体拦截器在所有实体上设置组织 ID。

组织id来自HttpSession

我已将组织 ID 设置为 Hibernate 会话中的过滤器属性，我想在我的拦截器中检索它并用于所有插入和更新。问题是我似乎无法访问拦截器内的会话。有什么解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T20:00:24.510

如果您只需要组织 ID，则可以将其放在静态 ThreadLocal 中，然后在拦截器中访问它。

另一方面，如果您对获取会话一无所知，这取决于您的环境，您可以放弃拦截器并使用`org.hibernate.event.FlushEntityEventListener`似乎更符合您需要的方式。您可以像这样获得会话（粗略的伪代码）：

```
FlushEntityEventListener.onFlushEntity(FlushEntityEvent event)
EntityEvent entityEvent = event.getEntityEntry();
EntityPersister persister = entityEvent.getPersister();
SessionFactoryImplementor sessionFactoryImplor = persister.getFactory();
Session session = sessionFactoryImplor.getCurrentSession(); 
```

来自[Hibernate 3 On Line Docs](http://hibernate.org/hib_docs/v3/reference/en/html/objectstate-events.html)：*事件系统可以作为拦截器的补充或替代使用。*

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T22:00:23.270

你可以，但我会使用一个简单的 POJO 来保持干净分离。请记住，存储在单例中的值只能由处理 servlet 请求的同一线程访问，因此，如果您正在执行任何异步操作，则需要考虑这一点。这是一个超级基本的实现：

```
public class OrgId {
   public static ThreadLocal<Integer> orgId = new ThreadLocal<Integer>();
} 
```

Since the Organizational Id is resident in the session, you could set the value of the ThreadLocal in an early servlet filter like this (not much error checking):

```
public class OrgIdFilter implements Filter {
   public void doFilter(ServletRequest servletrequest, ServletResponse servletresponse, FilterChain filterchain) throws java.io.IOException, javax.servlet.ServletException {
      int orgId = 0;
      HttpServletRequest req = (HttpServletRequest) servletRequest;
      HttpSession session = req.getSession();
      orgId = Integer.parseInt(session.getAttribute("OrganizationalIdAttr"));
      try {
         OrgId.orgId.set(orgId);
         filterChain.doFilter(servletRequest, servletresponse);
      } finally {
         OrgId.orgId.set(null); // Important to clear after request !!
      }
   }
} 
```

This assumes that the orgId is in the session when the filter is called, but if not, you get the idea....

Then in your interceptor (or pretty much anywhere) you can get the thread's current orgId with:

```
OrgId.orgId.get();   // Might be null..... 
```

A potential snafu here is that all these components (filter, OrgId and interceptor) need to be loaded by the same class loader to ensure that the OrgId class is effectively a singleton, otherwise, with multiple instances of the ThreadLocal hanging around it won't work consistently, or at all. Needless to say, all this needs to be happening in the same VM.

I am not sure if this is the cleanest way to solve this problem, but it does get you your orgId where you need it.

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-10T05:00:07.050

When you create your Interceptor, if you can provide it with a reference to the SessionFactory, you can use [SessionFactory#getCurrentSession](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/SessionFactory.html#getCurrentSession())

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-12T17:19:11.877

Interceptor can be made BeanFactoryAware and SessionFactory can be obtained using the bean factory from which current session can be obtained.

Since it seemed like a bad design because of the circular dependency and making the Interceptor aware of Spring container, i used ThreadLocal as suggested by Nicholas

# tsql - T-SQL 小数除法精度

> ID：423925
> 
>         
> 
> 赞同：28
> 
>         
> 
> 时间：2009-01-08T11:15:02.433
> 
>         
> 
> 标签：tsql, precision

有谁知道为什么，使用 SQLServer 2005

```
SELECT CONVERT(DECIMAL(30,15),146804871.212533)/CONVERT(DECIMAL (38,9),12499999.9999) 
```

给我11.74438969709659，

但是当我将分母上的小数位增加到 15 时，我得到的答案不太准确：

```
SELECT CONVERT(DECIMAL(30,15),146804871.212533)/CONVERT(DECIMAL (38,15),12499999.9999) 
```

给我 11.74438969

* * *

## 回答 #1

> 赞同：36
> 
>             
> 
> 时间：2009-01-08T12:12:36.840

对于乘法，我们只需将每个参数中的小数位数相加（使用笔和纸）来计算输出的小数位数。

但是分裂只会让你大吃一惊。我现在要躺下。

但在 SQL 术语中，它[完全符合预期。](http://msdn.microsoft.com/en-us/library/ms190476(SQL.90).aspx)

```
--Precision = p1 - s1 + s2 + max(6, s1 + p2 + 1)
--Scale = max(6, s1 + p2 + 1)

--Scale = 15 + 38 + 1 = 54
--Precision = 30 - 15 + 9 + 54 = 72
--Max P = 38, P & S are linked, so (72,54) -> (38,20)
--So, we have 38,20 output (but we don use 20 d.p. for this sum) = 11.74438969709659
SELECT CONVERT(DECIMAL(30,15),146804871.212533)/CONVERT(DECIMAL (38,9),12499999.9999)

--Scale = 15 + 38 + 1 = 54
--Precision = 30 - 15 + 15 + 54 = 84
--Max P = 38, P & S are linked, so (84,54) -> (38,8)
--So, we have 38,8 output = 11.74438969
SELECT CONVERT(DECIMAL(30,15),146804871.212533)/CONVERT(DECIMAL (38,15),12499999.9999) 
```

如果您也将[每个](http://www.mathsteacher.com.au/year7/ch06_decimals/13_div_dec/dec.htm)数字对视为

*   146804871.212533000000000 和 12499999.999900000

*   146804871.212533000000000 和 12499999.999900000000000

* * *

## 回答 #2

> 赞同：19
> 
>             
> 
> 时间：2009-04-03T10:02:18.740

简而言之，使用 DECIMAL(25,13) 并且你会很好地进行所有计算 - 你会得到声明的正确精度：小数点前 12 位数字，之后小数点后 13 位数字。规则是：p+s 必须等于 38，这样你就安全了！为什么是这样？因为 SQL Server 中的算术实现非常糟糕！在他们修复它之前，请遵循该规则。

* * *

## 回答 #3

> 赞同：16
> 
>             
> 
> 时间：2009-12-07T13:45:41.800

我注意到，如果您将除法值转换为浮点数，它会给您正确的答案，即：

```
select 49/30                   (result = 1) 
```

会成为：

```
select 49/cast(30 as float)    (result = 1.63333333333333) 
```

* * *

## 回答 #4

> 赞同：6
> 
>             
> 
> 时间：2010-10-08T10:58:52.190

我们对神奇的过渡感到困惑，

> P & S 是相关联的，所以：

> 0.  (72,54) -> (38,29)

> 0.  (84,54) -> (38,8)

假设`(38,29)`是一个错字，应该是  `(38,20)`，以下是数学：

0.  一世。72 - 38 = 34，二。54 - 34 = 20

1.  一世。84 - 38 = 46，二。54 - 46 = 8

这就是原因：

一世。输出精度减去最大精度是我们要丢弃的数字。

ii. 然后输出比例减去我们要丢弃的东西给我们......输出比例中的剩余数字。

希望这有助于其他试图理解这一点的人。

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T11:56:47.497

转换表达式而不是参数。

```
select  CONVERT(DECIMAL(38,36),146804871.212533 / 12499999.9999) 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2017-03-16T10:09:10.847

使用以下内容可能会有所帮助：

```
SELECT COL1 * 1.0 / COL2 
```

# asp-classic - xampp 与 asp（不是 aspx）

> ID：423936
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T11:19:42.173
> 
>         
> 
> 标签：asp-classic, xampp

是否可以将 xampp (apache 2) 与 asp 一起使用（它适用于 aspx，但我想使用“普通”asp）。恕我直言，JSMB

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-01-12T15:09:30.780

谢谢，我使用 quickwebserver “解决了”这个问题。[http://www.pablosoftwaresolutions.com/](http://www.pablosoftwaresolutions.com/)
现在我可以将经典的 ASP 与 XP 家庭版一起使用（当然它不是免费的 :-( ;-)）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T12:25:16.970

从[稍微过时的页面](http://www.apachefriends.org/en/faq-xampp-windows.html#asp)：

> **Microsoft Activer 服务器页面 (ASP) 是否可以与 XAMPP 一起使用？**
> 
>   
>   
> 
> 不！和 Perl:ASP 中的 Perl Add-on 不一样！不幸的是，没有可用的 Apache 的免费实现。

编辑：但是，可以在 Apache 上运行 mod_proxy。mod_proxy 是一个反向代理，它应该允许您透明地将请求中继到 IIS。我没有使用 Apache*或*IIS 完成此操作，因此我无法在此为您提供建议。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T11:45:29.017

您的意思是“经典 ASP”？据我所知，Windows 的 ASP 只能通过 IIS 实现。对于 linux (apache)，可以使用 chilisoft 等，但它可能不是免费的，也不再可用......

# java - Java：在 Eclipse 中导出到 .jar 文件

> ID：423938
> 
>         
> 
> 赞同：56
> 
>         
> 
> 时间：2009-01-08T11:20:13.967
> 
>         
> 
> 标签：java, eclipse, executable, extract, exe

我正在尝试将 Eclipse 中的程序导出到 jar 文件中。

在我的项目中，我添加了一些图片和 PDF:s。当我导出到 jar 文件时，似乎只有`main`已编译和导出。

如果可能的话，我的意愿是将所有内容导出到 jar 文件中，因为我想将其转换为可引出的文件，例如 .exe 文件。

但是怎么做？

* * *

## 回答 #1

> 赞同：62
> 
>             
> 
> 时间：2009-01-08T11:26:39.397

无需外部插件。在**Export JAR**对话框中，确保选择*了所有*要导出的必要资源。默认情况下，导出其他资源文件（图片、配置文件等）也应该没有问题，见下面的截图。
[![JAR 导出对话框](https://i.stack.imgur.com/IsQZv.jpg)](https://i.stack.imgur.com/IsQZv.jpg)

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2009-01-08T11:32:15.423

转到文件->导出->JAR文件，在那里你可以选择“导出生成的类文件和源”并确保你的项目被选中，并且那里的所有文件夹也有！祝你好运！

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-01-08T11:21:45.087

[在这种情况下， FatJar](http://fjep.sourceforge.net/)可以为您提供帮助。

除了包含在 Eclipse 中的“导出为 Jar”功能之外，插件将所有相关的 JAR 捆绑到一个可执行的 jar 中。

插件将条目“Build Fat Jar”添加到 Java-projects 的 Context-Menu

如果您最终导出的 jar 包含其他外部 jar，这将很有用。

如果您有 Ganymede，Export Jar 对话框足以从您的项目中导出您的资源。

在 Ganymede 之后，您有：

![出口罐](https://i.stack.imgur.com/zAIv7.jpg)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-06-05T09:44:05.593

另一种选择是[WinRun4J](http://winrun4j.sourceforge.net/)。[WinRun4J](http://winrun4j.sourceforge.net/eclipseplugin.html)有一个Eclipse 插件，它允许您将应用程序导出为单个可执行文件，并嵌入必要的 jars/classes。

（完全披露：我在这个项目上工作）

# ruby-on-rails - PostgreSQL 复制策略

> ID：423943
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-01-08T11:21:50.140
> 
>         
> 
> 标签：ruby-on-rails, database, postgresql, replication

现在我们正在使用 PostgreSQL 8.3（在 Linux 上）作为我们的 Ruby on Rails Web 应用程序的数据库后端。

考虑到在 PostgreSQL 数据库上我们积极使用行级阻塞和 PL/PGSQL，我们可以使用什么来保护我们的数据——我的意思是工具、包、脚本、策略——以成功复制数据库并构建多主组合？

我也会感谢主从建议。

例如，如果我放了几台运行 Apache/Ruby 的应用服务器来获得更高的性能，最后部署了几台数据库服务器，有没有办法在 PostgreSQL 中构建多主复制？

现在我们使用 PostgreSQL WAL 机制将数据备份到文件系统。

非常感谢。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-01-08T19:39:10.433

有一些用于主从（和主多从）场景的工具，通常是基于触发器的。[Slony-I](http://slony.info/)已经提到过（稳定可靠，但操作有点困难）。对 Slony-I 有问题的人写了
[Londiste](https://developer.skype.com/SkypeGarage/DbProjects/SkyTools#head-82de8ec3ed4ef158df36d038998a1bee67b0cbe3)（由 Skype 团队）和[PyReplica](http://www.nsis.com.ar/public/wiki/PyReplicaEn)。呸，我刚刚发现 
[Mammoth](https://projects.commandprompt.com/public/replicator)已经开源了

对于多主机，有[Bucardo](http://bucardo.org/)（注意：它不是那么完美）或商业产品 - 例如由[Continuent](http://www.continuent.com)或[Cyber](http://www.postgresql.at/) ​​Tec 提供。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-01-08T19:45:19.017

如果您还没有，我建议您查看 PostgreSQL 手册的[高可用性、负载平衡和复制](http://www.postgresql.org/docs/9.0/static/high-availability.html)一章。它清楚地概述了可用的技术及其功能。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-11-25T12:23:48.007

嗯，和这里的其他人相比， [Bucardo](http://bucardo.org/)真的很好而且很稳定。它与基于 Perl 的复制系统一样精巧，支持主从复制和多主复制，具有有趣的冲突解决概念。

如果您需要简单的主从代表，我会推荐 Londiste，但对于多主需求，Bucardo 是唯一可接受的解决方案恕我直言。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T11:44:09.083

我虽然[Postgres-R](http://www.postgres-r.org/)看起来很有希望，但它仍在开发中。

据说它已经稳定下来，并声称有可能与标准问题进行整合，但它尚未实现。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-08T09:03:34.007

迟到的答案，但有一个新的开源软件用于 PostgreSQL 的异步主-主复制（也适用于 MySQL）：
 [rubyrep](http://www.rubyrep.org)

重点是简单的设置。披露：我写的。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T17:16:16.103

你可以看看[slony](http://www.slony.info/)。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-09-14T16:24:57.687

PGCluster 看起来很有希望——我们在有限的情况下使用它，没有太多问题。  

[http://pgfoundry.org/projects/pgcluster/](http://pgfoundry.org/projects/pgcluster/)

# java - 使用 Java 的圆形 Swing JButton

> ID：423950
> 
>         
> 
> 赞同：21
> 
>         
> 
> 时间：2009-01-08T11:25:30.087
> 
>         
> 
> 标签：java, swing, jbutton

好吧，我有一张图片，我想将其作为按钮（或可点击的东西）的背景。问题是这张图片是圆形的，所以我需要展示这张图片，没有任何边框等。

保存此按钮的 JComponent 具有自定义背景，因此该按钮实际上只需要显示图像。

搜索谷歌后，我无法做到这一点。我已经尝试了以下所有方法，但没有运气：

```
button.setBorderPainted(false);
button.setContentAreaFilled(false);
button.setOpaque(true); 
```

在我在背景上绘制图标后，按钮会绘制它，但会保留带有边框等丑陋的灰色背景。我还尝试使用 JLabel 和 JButton。并在其上绘制 ImageIcon，但如果用户调整窗口大小或最小化窗口，图标就会消失！

我怎样才能解决这个问题？

我只需要将图像绘制并舍入到 JComponent 并听取点击...

* * *

## 回答 #1

> 赞同：24
> 
>             
> 
> 时间：2010-09-03T09:27:13.153

创建一个新的 Jbutton：

```
 JButton addBtn = new JButton("+");
    addBtn.setBounds(x_pos, y_pos, 30, 25);
    addBtn.setBorder(new RoundedBorder(10)); //10 is the radius
    addBtn.setForeground(Color.BLUE); 
```

在为 JButton 设置边框时，调用被覆盖的`javax.swing.border.Border`类。

```
addBtn.setBorder(new RoundedBorder(10)); 
```

这是课程

```
private static class RoundedBorder implements Border {

    private int radius;

    RoundedBorder(int radius) {
        this.radius = radius;
    }

    public Insets getBorderInsets(Component c) {
        return new Insets(this.radius+1, this.radius+1, this.radius+2, this.radius);
    }

    public boolean isBorderOpaque() {
        return true;
    }

    public void paintBorder(Component c, Graphics g, int x, int y, int width, int height) {
        g.drawRoundRect(x, y, width-1, height-1, radius, radius);
    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
>             
> 
> 时间：2009-01-08T12:32:06.147

您是否尝试过以下操作？

```
button.setOpaque(false);
button.setFocusPainted(false);
button.setBorderPainted(false);
button.setContentAreaFilled(false);
setBorder(BorderFactory.createEmptyBorder(0,0,0,0)); // Especially important 
```

`setBorder(null)`可能有效，但[Sun 描述了一个错误，](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4192869)解释它是设计使 UI 在组件上设置边框，除非客户端设置不实现`UIResource`接口的非空边框。

`EmptyBorder`与其在传入 null 时由 JDK 本身设置边界，不如由客户端`EmptyBorder`自己设置（一个非常简单的解决方法）。这样就不会混淆代码中谁在做什么。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2018-12-24T16:25:08.083

我编写了一个[OvalButton](https://github.com/lukakralj/Useful_misc/blob/master/Java/ovalButton/OvalButton.java)类，它可以处理椭圆形、圆形和胶囊状的 JButton。

在您的情况下，扩展[OvalButton](https://github.com/lukakralj/Useful_misc/blob/master/Java/ovalButton/OvalButton.java)类并覆盖`getBackgroundImage()`方法以返回要设置为背景的图像。然后像往常一样添加侦听器和文本。只有单击椭圆形/圆形区域才会触发操作。

您的按钮类示例：

```
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import javax.imageio.ImageIO;

public class ImageButton extends OvalButton {

    private BufferedImage image;

    public ImageButton() {
        super(); // Default is oval/circle shape.

        setBorderThickness(0); // Oval buttons have some border by default.

        try {
            image = ImageIO.read(new File("your_image.jpg")); // Replace with the path to your image.
        } 
        catch (IOException e) {
            e.printStackTrace();
            image = null;
        }
    }

    @Override
    protected BufferedImage getBackgroundImage() {
        return image;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2013-04-09T10:43:55.630

1.  将普通按钮拖到面板上

2.  右键单击您的按钮并转到属性：

```
border              = no border
border painted      = false
contentAreaFilled   = false
focusPainted        = false
opaque              = false 
```

3.  通过导入到项目中设置 (icon) 和 (rolloverIcon)。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T19:10:43.830

我建议像这样覆盖 paint(Graphics g) 方法：

```
class JImageButton extends JComponent implements MouseListener {
    private BufferedImage img = null;

    public JImageButton(BufferedImage img) {
        this.img = img;
        setMinimumSize(new Dimension(img.getWidth(), img.getHeight()));
        setOpaque(false);
        addMouseListener(this);
    }

    public void paintComponent(Graphics g) {
        g.drawImage(img, 0, 0, img.getWidth(), img.getHeight(), null);
    }

    @Override
    public void mouseClicked(MouseEvent e) {
    }

    @Override
    public void mouseEntered(MouseEvent e) {
    }

    @Override
    public void mouseExited(MouseEvent e) {
    }

    @Override
    public void mousePressed(MouseEvent e) {
    }

    @Override
    public void mouseReleased(MouseEvent e) {
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2015-05-04T11:16:32.267

您可以尝试以下方法。它对我来说很好，我也遇到了同样的按钮问题。

```
// Jbutton
JButton imageButton = new JButton();

// Buffered Icon
BufferedImage buttonIcon = null;

try {
    // Get the image and set it to the imageicon
    buttonIcon = ImageIO.read(getClass().getClassLoader().getResource("images/login.png"));
}
catch(Exception ex) {

}

// Set the image icon here
imageButton = new JButton(new ImageIcon(buttonIcon));
imageButton.setBorderPainted(false);
imageButton.setContentAreaFilled(false);
imageButton.setFocusPainted(false);
imageButton.setOpaque(false); 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T11:29:24.713

不透明度应该设置为假，所以

```
button.setOpaque(false); 
```

可能已经是你想要的了。

* * *

## 回答 #8

> 赞同：-1
> 
>             
> 
> 时间：2016-08-10T04:42:44.513

您可以像这样为按钮创建一个空边框：  

```
button.setBorder(BorderFactory.createEmptyBorder(0,0,0,0)); 
```

# c - 如何在 Delphi 项目中包含/链接 C .lib 文件

> ID：423955
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-01-08T11:27:27.993
> 
>         
> 
> 标签：c, delphi, linker

我们有一个 .lib 文件，它的功能必须包含在 Delphi 应用程序中。

包含 .obj 文件很容易，但由于某些未知原因，这不适用于 .lib 文件。帮助对此不是很有帮助。谷歌搜索并没有太大帮助（最有用的是使用其他链接器，但如果可能的话我想避免它）。

一种解决方案可能是使用 C++ builder 创建一个包，但我不太喜欢它。

所以问题是，是否有人知道将 C .lib 文件包含到 Delphi 项目中的方法（以便可以使用该功能）？或者有没有办法将 .lib 文件拆分为 .obj 文件。

（顺便说一下，我们使用 2006 年。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-01-08T11:37:10.797

您可以使用 C++Builder 附带的 tlib.exe 工具。如果您没有 C++Builder，您可以下载免费的 C++Compiler 5.5 ( [http://cc.codegear.com/Free.aspx?id=24778](http://cc.codegear.com/Free.aspx?id=24778) ) 并使用其中的 tlib.exe。

# c++ - 在 C/C++ 中将 1 个月添加到 time_t 的简单方法

> ID：423961
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-01-08T11:29:44.197
> 
>         
> 
> 标签：c++, c, date, time-t, date-math

我有一些代码使用 Oracle 函数 add_months 将日期增加 X 个月。

我现在需要在 C/C++ 函数中重新实现相同的逻辑。由于我不想/不需要进入的原因，我不能简单地向 oracle 发出查询以获取新日期。

有谁知道将 X 个月数添加到 time_t 的简单可靠的方法？下面显示了一些计算类型的示例。

30/01/2009 + 1 个月 = 28/02/2009 

31/01/2009 + 1 个月 = 28/02/2009 

27/02/2009 + 1 个月 = 27/03/2009 

28/02/2009 + 1 个月= 31/03/2009 

31/01/2009 + 50 个月 = 31/03/2013

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-01-08T11:48:08.480

您可以为此使用[Boost.GregorianDate](http://www.boost.org/doc/libs/1_37_0/doc/html/date_time/gregorian.html)。

更具体地说，通过添加正确的 来确定月份[`date_duration`](http://www.boost.org/doc/libs/1_37_0/doc/html/date_time/gregorian.html#date_time.gregorian.date_duration)，然后使用[`end_of_month_day()`](http://www.boost.org/doc/libs/1_37_0/doc/html/date_time/gregorian.html#date_time.gregorian.date_algorithms)from the date 算法

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-01-08T11:39:24.647

转换`time_t`为`struct tm`，将 X 添加到月，将月 > 12 添加到年，然后转换回来。tm.tm_mon 是一个 int，添加 32000+ 个月应该不是问题。

[编辑] 一旦遇到更难的情况，例如将 12 个月添加到 29/02/2008，您可能会发现匹配 Oracle 会很棘手。01/03/2009 和 28/02/2008 都是合理的。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2015-07-20T03:32:38.563

**对一个非常老的问题的**真正*新答案！*

 *使用[这个免费的开源库](http://howardhinnant.github.io/date_v2.html)和一个 C++14 编译器（例如 clang），我现在可以这样写：

```
#include "date.h"

constexpr
date::year_month_day
add(date::year_month_day ymd, date::months m) noexcept
{
    using namespace date;
    auto was_last = ymd == ymd.year()/ymd.month()/last;
    ymd = ymd + m;
    if (!ymd.ok() || was_last)
        ymd = ymd.year()/ymd.month()/last;
    return ymd;
}

int
main()
{
    using namespace date;
    static_assert(add(30_d/01/2009, months{ 1}) == 28_d/02/2009, "");
    static_assert(add(31_d/01/2009, months{ 1}) == 28_d/02/2009, "");
    static_assert(add(27_d/02/2009, months{ 1}) == 27_d/03/2009, "");
    static_assert(add(28_d/02/2009, months{ 1}) == 31_d/03/2009, "");
    static_assert(add(31_d/01/2009, months{50}) == 31_d/03/2013, "");
} 
```

它编译。

请注意实际代码与 OP 的伪代码之间的显着相似性：

> 30/01/2009 + 1 个月 = 28/02/2009 
> 
>   31/01/2009 + 1 个月 = 28/02/2009 
> 
>   27/02/2009 + 1 个月 = 27/03/2009 
> 
>   28/02/2009 + 1 个月= 31/03/2009 
> 
>   31/01/2009 + 50 个月 = 31/03/2013

另请注意，编译时信息*in*会导致编译时信息*out*。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T12:51:17.887

方法**AddMonths_OracleStyle 可以满足**您的需要。

也许您想将 IsLeapYear 和 GetDaysInMonth 替换为一些图书管理员方法。

```
#include <ctime>
#include <assert.h>

bool IsLeapYear(int year) 
{
    if (year % 4 != 0) return false;
    if (year % 400 == 0) return true;
    if (year % 100 == 0) return false;
    return true;
}

int daysInMonths[] = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};

int GetDaysInMonth(int year, int month)
{
    assert(month >= 0);
    assert(month < 12);

    int days = daysInMonths[month];

    if (month == 1 && IsLeapYear(year)) // February of a leap year
        days += 1;

    return days;
}

tm AddMonths_OracleStyle(const tm &d, int months)
{
    bool isLastDayInMonth = d.tm_mday == GetDaysInMonth(d.tm_year, d.tm_mon);

    int year = d.tm_year + months / 12;
    int month = d.tm_mon + months % 12;

    if (month > 11)
    {
        year += 1;
        month -= 12;
    }

    int day;

    if (isLastDayInMonth)
        day = GetDaysInMonth(year, month); // Last day of month maps to last day of result month
    else
        day = std::min(d.tm_mday, GetDaysInMonth(year, month));

    tm result = tm();

    result.tm_year = year;
    result.tm_mon = month;
    result.tm_mday = day;

    result.tm_hour = d.tm_hour;
    result.tm_min = d.tm_min;
    result.tm_sec = d.tm_sec;

    return result;
}

time_t AddMonths_OracleStyle(const time_t &date, int months)
{
    tm d = tm();

    localtime_s(&d, &date);

    tm result = AddMonths_OracleStyle(d, months);

    return mktime(&result);
} 
```

# automation - 软件“机器人” - 流程或工作自动化

> ID：423965
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-01-08T11:31:42.977
> 
>         
> 
> 标签：automation

我一直在玩弄创建软件“机器人”的想法，以帮助开发过程的不同领域、重复性任务、自动化任务等。

我有很多想法从哪里开始。

我的问题是，作为一名自由职业者，我大部分时间都是一个人工作，而且工作往往很累，而且我不喜欢延长或“提前”截止日期。

我调查并使用了很多生产力工具。我已经调查了 CodeGeneration 并且我正在设计一个工具来生成部分代码。我使用 codeReuse 技术。等等

。任何人都对此感到难过吗？因为有任何好文章。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T12:28:41.177

我不想使用代码生成，但我开发了许多工具来帮助我完成许多重复性任务。

其中一些可以做一些好事：

**电子邮件机器人**

这些接收电子邮件并用它们做很多事情，他们需要有一些身份验证之王来保护你免受坏事的影响：

*   自动记录在数据库或 Excel 电子表格中输入的任何内容。

*   更新数据库中的某些内容。

*   将所有附件保存在特定的共享文件夹中。

*   重新启动服务器。

**生产率**

这些将执行重复的任务：

*   打印出当月的所有发票。

*   自动合并来自多个来源的数据。

*   发送 GTD 项目的提醒。

*   发送迟到的 TODO 项目的提醒。

*   自动化构建

*   自动化测试

**行政**

这些自动化了一些重复的服务器管理任务：

*   汇总服务器日志，删除常规项目并通过电子邮件发送其余项目

*   在数据库中重建索引

*   进行自动备份

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T12:24:05.693

**元编程**是一件很棒的事情。如果您可以轻松访问有关类结构的数据，那么您可以自动化一些事情。在我使用的高级语言中，我定义了一个类，例如“属性”。为街道号添加一个整数，为街道名称添加一个字符串以及对拥有债务人的引用。然后，我自动生成一个表单，其中包含街道号和街道名称的文本框、债务人参考的查找框以及保存和加载的代码都是自动生成的。它知道门牌号是一个整数，所以它的文本框只能接受整数。如果我声明一个只读属性，它还将确保文本框是只读的。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T12:31:46.240

有软件机器人，但通常你真的看不到它们。例如，考虑一个用于包装东西的机器人。有一个人在发生故障时监控机器人。当机器人出现故障时，该人会关闭机器人并进行修复。那个人就像一个程序员，操作IDE进行编译，重构等。当出现错误时，程序员修复代码并再次运行编译器。

编译不是很像机器人，但是有一些软件可以自动编译你的项目。现在这更像是一种机器人。该软件机器人还会检查代码中的内容，例如是否有足够的注释等等。

然后我们有根据我们的输入生成代码的软件。例如，我们可以使用向导轻松地在 MS Access 中创建表单。向导不会一个接一个地自动生成新的表单，因为我们需要每个表单都不同。但是表格生成器是一种类似机器人的操作工具。

当然你可以先输入每个表单的详细信息，然后运行 ​​generate，但是人们喜欢很快看到每个表单。此外，输入机制几乎已经是表单，因此您可以即时获得您创建的内容。尽管使用数据转换工具，您可以从字段名称列表创建表单描述，生成表单，并将其称为使用机器人。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T11:40:48.403

甚至有整本关于自动化软件生产的书籍，但最大的问题是，流程的自动化持续时间比流程本身更长。

大多数程序员放弃了这一点，因为他们试图一步完成所有事情，从手动编程到自动化。

软件生产中的常见自动化是通过 IDE、CodeGenerator 等完成的，直到现在几乎没有逻辑是自动化的。

我将不胜感激这个话题的任何进展。尝试将流程中的小任务自动化，然后将这些任务连接起来。一步一步走。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T12:03:46.810

编写重复任务的脚本 - 这就是您所指的？我猜您是一名 Windows 开发人员，其中脚本编写不像在 *nix 世界中那样普遍。因此你的问题。

您可能想看看软件开发领域的 *nix 方面，其中工作流程或多或少与您描述的相似（至少比 Windows 更相似）。通过 bash、perl、python 等来探索你的方式。你会得到你想要的。

附言。另请查看 nsr81 在评论中对 Windows 上类似脚本工具的帖子。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T12:50:01.803

我猜想，就像地球上几乎每个软件开发人员一样，您想编写自己编写软件的软件。不幸的是，这是一个只在纸上有效的想法。我的意思是，我们有代码生成器、DSL、转换管道、静态分析代码和生成衍生代码的 Visual Studio 插件等。但它远不及任何人们称之为“机器人”的东西。

就个人而言，我认为在这方面还需要做更多的工作。例如，IDE 应该能够根据我的实际操作*推断事物并提出建议。*例如，如果我要添加一个属性，IDE 会推断文件中其他属性具有哪些属性，以及属性本身的结构，并相应地调整属性。

任何类型的人工智能都是艰苦的工作，遗憾的是，没有如此高的投资回报率。但这肯定很有趣。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T13:19:19.640

对于某些任务，代码生成无疑是一个可行的工具。如果做得不好，可能会产生维护问题，但不一定要做得不好。请参阅[代码生成网络](http://www.codegeneration.net/)，了解相当活跃的社区，包括会议、论文等。

[Code Generation in Action](https://rads.stackoverflow.com/amzn/click/com/1930110979)是一本我想到的书。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2017-12-17T07:56:47.510

你可以试试 Robot 框架 
[http://robotframework.org/](http://robotframework.org/)

Robot Framework 是一个通用的自动化框架，它具有易于使用的表格测试数据语法，并利用关键字驱动的方法。甚至您也可以将此工具用作软件机器人 (RPA)。

* * *

## 回答 #9

> 赞同：-1
> 
>             
> 
> 时间：2015-09-24T09:51:44.677

**机器人过程自动化**

首先，有一点背景故事…… 2011 年，我是百时美施贵宝 (Bristol-Myers Squibb) 卓越承包中心的运营经理。我们正处于推出全新全球承包系统的早期阶段。这个新系统正在取代全球范围内的大量人工工作，旨在用一个系统为所有组织创建、存储和检索合同信息。可以肯定的是，这不是一项小任务，而且我们肯定低估了其范围和最终影响。像大多数组织处理这个合同管理流程一样，我们发现它比最初预期的要大 4 到 10 倍。

我们做了很多非常正确的事情，包括从头开始建立一个支持组织，他们专门研究这个特定的应用程序，并在 (7) 种语言和大多数时区成为该组织的真正主题专家。

另一方面，该应用程序也带来了自身的挑战，其中包括缺少功能、性能不佳以及运营团队需要完成的大量后端工作。这就是机器人过程自动化出现的地方。

该软件的许多“功能”对于最终用户来说太复杂了，无法使用，但需要创建合同。第一个示例是添加一个与之签订合同的“联系人”。“第三方”，如果你愿意的话。这是一件看似简单的事情，需要（7）个数据输入屏幕、一个神秘的访问点、22 分钟和一个硕士学位才能弄清楚，每一个都需要您自己完成。我们很快做出了业务决策，让运营团队代表我们的最终用户创建这些“联系人”。我们预计每年需要几千美元。我们很快通过了每周 800 个请求。由于三个 FTE 的工作，我们的积压工作不断增长，每个请求的周转时间超过两周。明显地，

手动过程非常复杂，即使是我的员工在创建它们时也会出现大量错误，即使是主题专家也是如此。由此产生的返工使问题进一步复杂化并增加了成本。我以前有一些自动化经验和使用过的产品，但这种需求比我以前遇到的更加强烈和复杂。我需要一些很棒、快速、易于实施并且不需要 IT 帮助的东西（因为它有它自己的陷阱。）我调查了许多产品，都声称做类似的事情。当然，其中之一对我来说很突出。它似乎是最有能力、最实惠并且有很好的支持选择的。我选择的产品是 Automation Anywhere，价格约为 4000.00 美元。

就此而言，我不是来推销 Automation Anywhere 或任何特定产品的。但是，我对这个工具的体验永远改变了我对机器人过程自动化真正含义的期望和理解。现在，不要误会我的意思，我不是来推销 Automation Anywhere 或任何特定产品的。但是，我对这个工具的体验永远改变了我对机器人过程自动化真正含义的期望和理解。（如果您不确定，请参见下文）

在我购买该工具并学习了一些功能的第一周之后，我能够在承包系统中实现手动创建“联系人”的流程，从两周周转到 (1) 小时周转-大约。每个条目花费了 22 分钟的 FTE 努力，最终为零。我能够从台式 PC 运行这个自动化过程，并完全自动化地处理每个请求，包括验证和确认其他外部系统的步骤，以确保比以前更好的数据质量。在第一周，我的软件成本通过节省的劳动力收回了 200% 以上，从而使这些资源能够专注于其他更高价值的任务。我不在乎你来自哪里，这是一个惊人的投资回报率！

这只是一个开始，现在我们有了这个工具，事实上它可以做的远不止我需要的这个初始任务，它成为开发我们需要的更复杂流程的功能性概念证明/原型的最有价值的资源之一弥合承包制度的空白。我能够通过企业许可证添加到原始购买中，并与我们的 IT 部门合作，以极低的总体实施成本获得更强大的基础架构。我现在拥有 (5) 台 24/7 全天候运行的专用企业服务器和 (2) 用于构建和支持自动化任务的开发许可证，我们能够继续支持承包计划，即使数量比相同数量的预期大得多我们开始时的 FTE。它成为了报道的平台，最终用户通知、系统警报、更新数据、工作流程、作业调度、监控、ETL 甚至数据输入和从其他系统迁移。由于实施此机器人过程自动化工具而避免的成本不能被夸大。通过向商业界提供及时的解决方案以及我们能够展示和促进的持续专业诚信，在不到 (1) 年的时间内成功实施到超过 48 个国家并签订了超过 120,000 份合同，这一点显而易见。之后的每一年。

它成为报告、最终用户通知、系统警报、更新数据、工作流程、作业调度、监控、ETL 甚至数据输入和从其他系统迁移的平台。

虽然机器人过程自动化这个术语目前很流行，但这些概念已经存在了一段时间。但是，请不要假设这意味着这是一种构建并忘记的情况。随着它的增长，它会增长，你需要一个强有力的计划来管理任务、资源和基础设施，以保持运行。这些工具基本上模仿了人类可以做的任何事情，而且远远超过了人类。但是，如果她/他正在使用的“源”系统之一在用户界面中发生了变化，那么人们可以相当快地改变他们在流程中的步骤。在大多数情况下，您的自动化任务需要“调整”才能进行更改。一些业务流程可能比其他业务流程更容易实现自动化，并且对于临时的“自动化任务创建者”来说，构建和/或维护可能是两个复杂的。确保您有可靠的资源来构建和维护任务。如果您计划使用 RPA 工具做不止一件事，请确保拥有可靠的监督、治理、资源和企业“冠军”，否则我向您保证，您的努力不会成功。

**机器人过程自动化定义：**

(IRPA) 机器人过程自动化研究所：“机器人过程自动化 (RPA) 是一种技术应用，它允许公司员工配置计算机软件或“机器人”来捕获和解释现有应用程序以处理交易、操纵数据、触发响应并与其他数字系统通信。”</p>

维基百科：“机器人自动化的例子包括在制造业中使用工业机器人，以及在服务行业中使用软件机器人来自动化文书流程。在后一种情况下，机器人一词的使用具有隐喻性，传达了这些软件产品与工业机器人的相似性——这些软件产品的生产是为了提供通用的自动化能力，然后在最终用户环境中进行配置以执行手动和重复性任务。同行。这个比喻很贴切，因为软件“机器人”现在正在模仿或替换与人相关的经典功能。”</p>

# visual-studio-2008 - 为什么VS2008的F10这么慢？

> ID：423966
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-01-08T11:31:50.230
> 
>         
> 
> 标签：visual-studio-2008, debugging, performance, step-into

问题标题确实说明了一切 - 比 VS2005 慢很多，每次按键都有明显的延迟（0.5 秒）。

它使单步执行代码变得很痛苦。

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-03-19T16:17:51.787

我一直在 VS2008 SP1 中看到 C++ 项目的调试性能非常缓慢。任何步进（F10/F11）甚至双击调用堆栈中的不同级别（即使在同一个文件中）。

解决方案是禁用“调试”工具栏上的“在源代码中显示线程”。

启用该选项后，上述每个操作都需要 5-20 秒。禁用后，它恢复正常。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T11:36:11.873

你在调试什么样的项目？C＃？

我注意到，当您在“自动”和“监视”窗口中监视大量变量时，单步执行代码的速度会变慢。调试器在每一步之后评估这些窗口中显示的任何表达式。

尝试关闭这些窗口，看看步进速度是否增加。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T11:49:28.383

正如 Joe90 所说，SP1 可能会有所帮助；此外，您是否发现在 IDE 中关闭不必要的窗口会提高性能？您是否有源代码控制集成，如果有，您使用什么提供程序（TFS/SourceSafe/等）

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T11:38:17.580

你有SP1吗？它可能会帮助...

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T11:54:52.353

还要确保您已禁用源服务器集成并启用“只是我的代码”。我发现源服务器集成的东西真的可以减慢速度，即使你实际上没有进入框架代码。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T12:03:47.810

从提供的答案之一 - 关闭所有其他代码窗口将性能恢复到应有的位置。

而从其他之一 - SP1 也改进了一些事情。

谢谢大家。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T13:15:10.070

一些加载项也会减慢 Visual Studio。

为此，我的同事卸载了 Devexpress。

# .net - 缺少文件或程序集 tinymcetextbox

> ID：423973
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-08T11:35:24.577
> 
>         
> 
> 标签：.net, asp.net, html, editor

我有一个项目，我正在做一些维护工作，并获得了解决方案文件等并尝试构建它，但出现以下错误：-

错误 4 无法加载文件或程序集“TinyMCETextBox”或其依赖项之一。该系统找不到指定的文件。

这是一个 .net 2.0 项目。任何人都可以给我任何指示让我开始吗？我从他们的网站下载了 tinymce 包，那里似乎没有 dll，所以我下载了 .net 2 应用程序，其中包含一个名为 Moxiecode.TinyMCE.dll 的 dll。我引用了这个 dll 但似乎仍然遇到相同的错误。谁能指出我正确的方向？

干杯

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T11:57:12.737

大概他们在某个地方部署了他们的应用程序的构建？你能不能抓住它并从那里追踪装配体？

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-01-12T16:45:28.543

我发现这是什么。有人将一个名为 TinyMCETextbox 的 AJAX 扩展器放在一起。一旦我下载并添加了对它的引用，一切似乎都运行良好。感谢您的输入

# .net - 我应该如何处理持续集成和 .NET Framework 版本

> ID：423978
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-01-08T11:39:29.527
> 
>         
> 
> 标签：.net, version-control, frameworks, continuous-integration, cruisecontrol.net

我刚刚开始迁移到 .NET Framework 3.5。我将 CruiseControl.NET 用于我们的持续集成，并想知道其他人如何设置它。

我有一个名为 NET3.5 的源代码分支，但现在我将主干保持为 2.0。

我创建了两个从主干和分支结帐的 CruiseControl 项目。

因此，即使只有一个代码库，我也有两个持续集成项目。

我认为这是正确的方法，因为我需要使用不同版本的 aspnet_merge.exe 来编译代码，这意味着两个单独的配置文件和两个持续集成项目。

这种方法可以吗，应该单独构建每个分支还是应该只是一个大型代码库，在一个巨大的构建中编译不同的发布版本？

干杯

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-01-08T12:58:52.973

我个人为分支创建了一个新的 CCNet 项目，这听起来就像你所做的那样。

这样做的好处是：

*   一个分支的变化只会导致一个项目重建

*   每个分支都有单独的构建报告/工件

*   如果一个分支中断，仍然可以构建/部署另一个分支

当您将分支合并回主干时，您可以删除额外的 Cruise 项目。

让我知道是否有我在这里遗漏的特定于您的 ASP.NET 应用程序的内容。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-01-08T12:55:45.163

切换到 TeamCity 并进行多个构建（每个分支至少一个）。在 TeamCity 中配置构建非常容易，这绝对是测试不同版本代码库（包括框架）的正确解决方案。

# linq-to-sql - 创建轻量级 Linq2Sql 代理对象

> ID：423992
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-01-08T11:47:15.817
> 
>         
> 
> 标签：linq-to-sql, json, serialization, json.net

我试图找到通过 JSON 将我的 Linq2Sql 对象发送到我的 jQuery 插件的最有效方法，最好不要为每个类添加额外的代码。

EntitySet 是主要问题，因为它们不仅会导致递归，而且当递归被忽略时（使用[JSON.NET](http://www.codeplex.com/json)的 ReferenceLoopHandling 功能），当我真正需要 1 或 2 个级别时，可以检索大量数据。当您谈论用户、角色和权限时，这会变得非常糟糕，因为您在 JSON 遇到递归和停止之前将用户角色、用户权限、角色权限和角色用户全部放在了 JSON 中。将此与我真正想要的进行比较，这只是 RoleId。

我最初的方法是发送对象的“简化”版本，我在其中反映实体并将任何 EntitySets 设置为 null，但当然在上面的示例中，Roles 被设置为 null，因此 RoleId 为 null。仅将第二级属性设置为空类型的作品，但仍然有太多的数据，因为当 JsonSerializer 进行反射时，没有被杀死的实体集（第一级）重新填充它们的关联表，我仍然得到所有那些 Permission 对象我只是不需要。

我绝对不想陷入为每个类创建一个轻量级版本并在它们上实现“From”和“To”样式的方法的情况，因为这是很多工作并且看起来很浪费。

另一种选择是在相关属性上放置一个 JsonIgnoreAttribute，但是每当需要重新生成类时，这将导致噩梦般的场景。

我目前喜欢和讨厌的最喜欢的解决方案是将类置于选择加入序列化模式，但是因为我无法向真实属性添加属性，所以我必须在部分中创建仅限 JSON 的属性班级。同样，这似乎很浪费，但我认为这是迄今为止最好的。

任何建议都感激不尽！

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-01-08T21:30:27.027

您是否尝试在 dbml 文件中设置序列化模式？

它是代码生成下的标准属性，当您将其设置为单向时，它不会生成表结构的所有其他级别。我已经将它与 silverlight 和 WCF 一起使用来发送数据，因为数据协定不允许发送额外的级别（silverlight 非常有限地限制了你能做什么和不能做什么）。

希望这可以帮助！

# java - 作为名称或标识符的保留字

> ID：423994
> 
>         
> 
> 赞同：27
> 
>         
> 
> 时间：2009-01-08T11:47:46.017
> 
>         
> 
> 标签：java, naming, reserved-words

有没有什么技巧可以将 Java 保留字用作变量、方法、类、接口、包或枚举常量名？

* * *

## 回答 #1

> 赞同：40
> 
>             
> 
> 时间：2009-01-08T12:48:22.773

这是一个有效的问题。这样的事情在其他语言中*是可能的。*在 C# 中，在标识符前面加上`@`([如前所述](https://stackoverflow.com/questions/421257/how-i-use-a-c-keyword-as-a-property-on-an-anonymous-object#421263)); 在 Delphi 中，前缀为`&`. 但是 Java 没有提供这样的功能（部分原因是它不需要像 .Net 世界那样与其他语言定义的标识符进行交互）。

* * *

## 回答 #2

> 赞同：30
> 
>             
> 
> 时间：2009-01-08T11:49:55.560

不，没有办法。这就是为什么他们被贴上“保留”的标签。

* * *

## 回答 #3

> 赞同：11
> 
>             
> 
> 时间：2009-01-08T11:54:19.793

大多数情况下，这个问题出现在“class”上，在这种情况下，习惯上写成“clazz”。

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2009-01-08T11:56:28.073

不，你不能这样做。如需更多信息，请参阅[JLS 第 3.8、3.9 节](http://java.sun.com/docs/books/jls/third_edition/html/lexical.html#3.9)

> 以下由 ASCII 字母组成的字符序列保留用作关键字，不能用作标识符（第 3.8 节）：
> 
> ```
> Keyword: one of
>         abstract    continue    for           new          switch
>         assert      default     if            package      synchronized
>         boolean     do          goto          private      this
>         break       double      implements    protected    throw
>         byte        else        import        public       throws
>         case        enum        instanceof    return       transient
>         catch       extends     int           short        try
>         char        final       interface     static       void 
>         class       finally     long          strictfp     volatile
>         const       float       native        super        while 
> ```

* * *

## 回答 #5

> 赞同：7
> 
>             
> 
> 时间：2009-01-14T20:18:06.960

严格来说你不能，除非你得到一个不符合 Java 语言规范的有缺陷的编译器实现。

**但有志者事竟成。**将以下代码复制到您的 IDE 中，将源文件编码切换为 UTF-16，然后我们开始：

```
public class HelloWorld {

    public static void main(String[] args) {

        HelloWorld.nеw();
    }

    public static void nеw () {
        System.out.println("Hello,World");
    }

} 
```

此代码是格式良好且有效的 Java 类。然而，正如你猜到的，有一个小技巧：“new”标识符中的 'е' 字符不属于 ASCII 字符集，它实际上是一个西里尔字母 'е'（发音为 'YE'）。

当前的 Java 语言规范明确允许使用 Unicode 来命名标识符，而这一点很重要。这意味着如果他们愿意，一个人可以自由地用法语、中文或俄语给她或他的班级打电话。也可以在代码中混合和匹配字母。从历史上看，拉丁字母和其他字母中的一些字母是相似的。

结果：不，您不能使用保留字作为标识符，但您可以使用看起来与保留字完全一样的标识符。

是否有人应该这样做是完全不同的事情。

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2009-01-08T11:59:15.790

就在这里。您必须使用将来的保留字。就像在 1.4 之前的代码中调用 assert() 的不同方法所发生的一样。

希望能帮助到你！

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2009-01-09T00:03:18.137

不确定您要做什么，但 $ 是标识符中的有效字符，因此您可以这样做：

`int $return = 5;`

它看起来有点奇怪，但它确实有效。

* * *

## 回答 #8

> 赞同：3
> 
>             
> 
> 时间：2012-09-12T17:21:01.150

在 Scala 中，您可以使用反引号。例如：myVarialbe.`class`

* * *

## 回答 #9

> 赞同：3
> 
>             
> 
> 时间：2016-11-25T13:18:29.353

我知道这仍然是个老问题，可能会对某人有所帮助。

可以使用 GSON 的[字段命名支持](https://sites.google.com/site/gson/gson-user-guide#TOC-JSON-Field-Naming-Support)

例如。

```
@SerializedName("new")
private String New;
public String getNew ()
{
    return New;
}
public void setNew (String aNew)
{
    New = aNew;
} 
```

* * *

## 回答 #10

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T11:49:22.550

嗯？你为什么想这么做？你可以用 l33t 编写它们，这会欺骗编译器。

```
class cl4ss {
  String r3turn() {
    return "but why?";
  }
} 
```

* * *

## 回答 #11

> 赞同：2
> 
>             
> 
> 时间：2009-01-08T16:37:49.100

**javac**编译器无法使用保留字。

**从技术上讲，一旦将类文件编译为您想要的**任何名称，您就可以在其中编辑名称：在那个阶段，VM 不在乎，因为它不再处理源代码。我相信一些混淆器使用这种技术。

* * *

## 回答 #12

> 赞同：2
> 
>             
> 
> 时间：2009-11-08T21:02:49.440

PL/1（一种 1960 年代的 IBM 大型机编程语言至今仍在使用）相当有名地要求虽然某些词在某些上下文中充当关键字，但所有词都可以用作标识符。如果您开始保持一致，这在解析器中甚至不难做到。PL/1 被认为是一种相当大的语言，语言委员会担心许多程序员不会全部学习，然后当他们尝试使用他们不知道的部分的关键字作为标识符时会感到惊讶. 所以你可以写这样的东西：

```
IF BEGIN=ELSE THEN CALL=3 ELSE CALL FOO(ENDIF) ENDIF 
```

正如其他人在这里指出的那样，不建议这样做。

Java 设计者认为语言中的关键字数量不多，并保留了该集合。他们甚至保留了“GOTO”，这实际上在任何真正的 Java 程序中都是不允许的。

* * *

## 回答 #13

> 赞同：1
> 
>             
> 
> 时间：2018-11-26T15:49:47.203

如果您确实需要使用与保留字名称相同的字段/局部变量/方法，我建议在名称末尾附加下划线：

```
// JPA entity mapping class:

private Boolean void_;

public Boolean getVoid_() { ... }
void setVoid_(Boolean void_) { ... } 
```

它比在名称开头附加字符（fVoid、aVoid、vVoid 等）更具可读性（恕我直言）

上面的代码是发生在我身上的真实案例，使用的是遗留数据库，其中`invoice`表有一个名为的字段`void`，指示文档是否已作废。******** 
```****