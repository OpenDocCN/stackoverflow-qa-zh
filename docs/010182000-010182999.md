# StackOverflow 问答 10182000-10182999

# zend-framework - Zend Framework 2 用于 Zend Framework 新手

> ID：10182000
> 
> 赞同：40
> 
> 时间：2012-04-16T21:31:10.227
> 
> 标签：zend-framework, zend-framework2

我想将 ZF2 用于即将进行的项目。但是，我发现很难理解我在那里找到的一些教程。他们中的大多数只是告诉您将内容放入文件中，而没有真正解释一切是什么或我可能拥有的任何其他选项。

有没有适合绝对 zf 初学者的书或教程？

* * *

好吧，我开始使用 Yii 直到 ZF2 发布。

Yii 简直让我大吃一惊。在两天内，我已经能够开始构建一些东西了。它非常简单，但功能强大。他们有很好的文档，如果你对 MVC 和 SQL 有很好的了解，这个框架很容易理解和使用。他们网站上的文档也非常好。有针对绝对初学者的教程。我喜欢的。Zend 可能是一个更健壮和强大的框架，但学习起来非常乏味。它缺乏 Yii 的简单性。我疯狂地试图理解所有这些配置行。

我遵循这个线程中推荐的每个教程两周并放弃了。告诉某人只输入一些代码而不解释它的含义或如何调整它并不是教授和推广框架的好方法。ZF2 发售后我会去拿。我希望他们让它变得更友好。我希望文档也有所改进，并从简单到复杂的示例。我真的很想学ZF。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-04-19T11:17:20.007

您可以阅读许多文章，这些文章可能会有所帮助：

*   [官方文档](http://packages.zendframework.com/docs/latest/manual/en/index.html)- 有有用的东西 - 特别是查看快速入门
*   [查看层，数据库抽象，配置，哦，我的！](http://mwop.net/blog/zf2-beta3.html)- View Layer & Db 的良好介绍
*   [开始编写 ZF2 模块](http://mwop.net/blog/267-Getting-started-writing-ZF2-modules.html)- 很好的模块介绍
*   [ZF2](http://akrabat.com/zend-framework-2/modules-in-zf2/)中的模块 - 另一个模块介绍
*   [使用ZF2 EventManager——](http://mwop.net/blog/266-Using-the-ZF2-EventManager.html)事件管理器介绍
*   [PHP 构造器最佳实践和原型模式](http://ralphschindler.com/2012/03/09/php-constructor-best-practices-and-the-prototype-pattern)- Zend\Db\ResultSet 使用它
*   [使用 ServiceManager 作为控制反转容器](http://techblog.shinymayhem.com/2013/09/using-servicemanager-as-inversion-of.html)- 如何使用 Zend\ServiceManager
*   [Zend\ServiceManager 配置键](http://akrabat.com/zend-framework-2/zendservicemanager-configuration-keys/)- 有用的 Zend\ServiceManager 信息

此外，这些博客类别有有用的信息：

*   Matthew Weier O'Phinney 的[ZF2 文章](http://mwop.net/blog/tag/zf2.html)
*   Rob Allen 的[ZF2 文章](http://akrabat.com/category/zend-framework-2/)
*   Matthew Setter 的[大师 Zend 框架](http://www.masterzendframework.com/blog-archive/)

图书：

*   Slavey Karadzhov 的[Learn ZF2](http://learnzf.com/book/)
*   Matthew Setter 的[Zend Framework 2 初学者](https://leanpub.com/zendframework2-for-beginners)

对于源代码：

*   [http://modules.zendframework.com/](http://modules.zendframework.com/)
*   [https://github.com/akrabat/ZF2TestApp](https://github.com/akrabat/ZF2TestApp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T13:41:59.393

Rob Allen ZF2 教程现在是官方文档的一部分：[http ://packages.zendframework.com/docs/latest/manual/en/user-guide/overview.html](http://packages.zendframework.com/docs/latest/manual/en/user-guide/overview.html)

另见这篇文章[https://stackoverflow.com/a/8894828/760703](https://stackoverflow.com/a/8894828/760703)

# jquery - jQuery 翻转

> ID：10182005
> 
> 赞同：1
> 
> 时间：2012-04-16T21:31:36.080
> 
> 标签：jquery, rollover

我只是在翻转时隐藏和显示产品描述，这样可以做得更好吗？

当鼠标进出时它有点小车

```
$("a.roll-over-trigger").hover(
   function() {
      $(this).next('.altProduct p').slideDown('300');
   },
   function() {
      $(this).next('.altProduct p').slideUp('300');
   }
); 
```

a.roll-over-trigger 是图像本身

和 .altProduct p 悬停时向上滑动超过一半的图像。

这是一个链接[http://tinyurl.com/d8dxd47](http://tinyurl.com/d8dxd47)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:56:22.733

你没有提供任何例子，只是一个猜测

```
$("a.roll-over-trigger").on('hover', function(e) {
    $(this).next('.altProduct').find('p').slideToggle('medium');
}); 
```

[这里有一个例子。](http://jsfiddle.net/heera/mXJrU/1/)

# ajax - 我怎样才能使 django 文件上传与 valums/file-uploader 一起工作

> ID：10182016
> 
> 赞同：1
> 
> 时间：2012-04-16T21:32:52.467
> 
> 标签：ajax, django, file-upload, upload

我想让 valums/file-uploader 与 django 上传一起运行，将它与模型字段（FileField）一起使用

基本的django模型：

```
class Image(models.Model):
    user = models.ForeignKey(User)
    url = models.FileField(upload_to='%Y/%m/%d') 
```

基本视图，使用非 ajax 上传：

```
def ajax_upload(request):
    if request.method == 'POST':
        newfile = Image()
        newfile.user = request.user
        file_content = ContentFile(request.FILES['file'].read())
        file_name = request.FILES['file'].name
        newfile.url.save(file_name, file_content)
        results = {'url': newfile.url, 'id': newfile.id}
        return HttpResponse(json.dumps(results))
    raise Http404 
```

问题是值上传器没有将文件放入“请求”文件中，而是将其放入 POST 中，而 django 将其作为 querydic 获取。

将它与顶级代码一起使用 django 说：

> “在”中找不到密钥“文件”

如果我改变：

```
file_content = ContentFile(request.POST) 
```

django 说：

> 预期的读取缓冲区，找到 QueryDict

我可以让它工作，但我仍然想保留 django 的本地文件上传，它更干净。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T04:15:36.593

使用[`request.body`](https://docs.djangoproject.com/en/dev/ref/request-response/)（或者`request.raw_post_data`如果早于 1.4）

# mysql - 学习符合 ACID 的事务

> ID：10182019
> 
> 赞同：2
> 
> 时间：2012-04-16T21:33:32.397
> 
> 标签：mysql

[http://imgur.com/IZgvl](http://imgur.com/IZgvl)

大家好，我一直在从 Wiley 的 MySQL 管理员圣经中学习 MySQL（完全没有 PHP 经验）。如果我提出的任何错误对您来说似乎是儿戏，我提前道歉，但我认为来这里帮助完善我的学习并没有什么坏处......

所以，在这里切入正题——我试图向自己展示符合 ACID 的事务的“原子性”和“一致性”方面。很基本。然而，当试图通过将资金从账户 ID 2 转移到不存在的“3”来强制出错时，交易拒绝恢复到之前的状态，现在可怜的哈德森在我承诺之后还差 5000 美元。谁能指出为什么会这样？谢谢！

期待成为这里的常客

-MyPreQL

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T21:37:17.683

你仍然在你的事务上运行了一个 COMMIT。当您遇到错误时，您希望改为 ROLLBACK。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T04:11:54.513

还。我知道这是微不足道的，但没有被提及，这仍然是一个常见的错误。确保您的表是引擎类型 innoDB 而不是 MyIsam。否则，所有这些提交和回滚看起来都很好，但由于 MyIsam 不支持事务并且不能符合 ACID ，因此无效:)

# google-apps-script - 如何使用脚本编辑器在 Google 电子表格中获取当前时间？

> ID：10182020
> 
> 赞同：37
> 
> 时间：2012-04-16T21:33:34.663
> 
> 标签：google-apps-script, google-sheets

可以选择编写脚本并将其绑定到触发器。问题是，如何在脚本主体中获取当前时间？

```
function myFunction() {

  var currentTime = // <<???

} 
```

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-04-16T21:38:25.107

使用 JavaScript`Date()`对象。有多种方法可以从对象中获取时间、日期、时间戳等。（[参考](http://www.w3schools.com/jsref/jsref_obj_date.asp)）

```
function myFunction() {
  var d = new Date();
  var timeStamp = d.getTime();  // Number of ms since Jan 1, 1970

  // OR:

  var currentTime = d.toLocaleTimeString(); // "12:35 PM", for instance
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2019-02-18T14:21:24.507

我在我的谷歌文档中考虑了时区，如下所示：

```
timezone = "GMT+" + new Date().getTimezoneOffset()/60
var date = Utilities.formatDate(new Date(), timezone, "yyyy-MM-dd HH:mm"); // "yyyy-MM-dd'T'HH:mm:ss'Z'" 
```

[我的 Google 文档脚本](https://github.com/andyclub/Google-Docs/blob/master/Insert%20Date.gs)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-16T21:37:36.623

使用[`Date`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date)javascript 提供的对象。对于 Google 的脚本环境来说，它并不是唯一的或特殊的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-07-24T03:17:50.423

任何说在 Google 表格中获取当前时间并不是 Google 脚本环境独有的人显然从未使用过 Google Apps 脚本。

话虽如此，你想返回当前时间是什么？脚本用户的时区？脚本所有者的时区？

脚本时区由脚本所有者在脚本编辑器中设置。`File/Spreadsheet settings`但是脚本的不同授权用户可以从Google 表格的菜单中为他们正在使用的电子表格设置时区。

我猜你想要第一个选项。您可以使用内置函数获取电子表格时区，然后使用`Utilities`该类格式化日期。

```
var timezone = SpreadsheetApp.getActive().getSpreadsheetTimeZone();

var date = Utilities.formatDate(new Date(), SpreadsheetApp.getActive().getSpreadsheetTimeZone(), "EEE, d MMM yyyy HH:mm") 
```

或者，使用 Javascript 的 date 方法获取 UTC 时间的时区偏移量，格式化时区，并将其传递到`Utilities.formatDate()`.

不过，这需要稍作调整。运行返回的偏移量`getTimezoneOffset()`与我们通常对时区的看法相矛盾。如果偏移量为正，则本地时区在 UTC 之后，就像美国时区一样。如果偏移量为负数，则本地时区早于 UTC，如亚洲/曼谷、澳大利亚东部标准时间等。

```
const now = new Date();
// getTimezoneOffset returns the offset in minutes, so we have to divide it by 60 to get the hour offset.
const offset = now.getTimezoneOffset() / 60
// Change the sign of the offset and format it
const timeZone = "GMT+" + offset * (-1) 
Logger.log(Utilities.formatDate(now, timeZone, 'EEE, d MMM yyyy HH:mm'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-11-23T07:07:03.657

该`Date`对象用于处理日期和时间。

日期对象是用`new Date()`.

```
var date= new Date();

 function myFunction() {
        var currentTime = new Date();
        Logger.log(currentTime);
    } 
```

# c++ - 学习 C++ 需要关于程序作业的帮助

> ID：10182021
> 
> 赞同：1
> 
> 时间：2012-04-16T21:33:37.763
> 
> 标签：c++

于是开始学习C++。我是一个相当不错（不是很好）的 Java 程序员，我访问了 C++ 参考站点，但我和我的合作伙伴仍然不知道是什么

```
list<int> & testSort(istream & idata, istream & sdata) 
```

方法

到目前为止，列表对象的类型是 int testSort 是我们的类

我遇到了 & 符号和 istream 数据类型的问题。

此外，如果您能解释什么是矢量数据类型，那将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T21:42:39.183

好吧，这里有一些东西要开始：

[C++ 参考](http://en.cppreference.com/w/cpp)：如果您需要查找标准类类型，这将帮助您入门。

[C++ 常见问题解答](http://www.parashift.com/c++-faq-lite/)：如果您真的迷路了，这将对您有所帮助。其中大部分是边缘情况，但有些是最佳实践。

你已经在这里找到了，这对于奇怪的情况可能是最好的。

但是对于您的具体问题，请记住，在 C++ 中，您不需要将方法放在类中。有些“自由函数”类似于方法，但不属于任何类。所以`testSort`不是一个类，也不是一个类的方法，而是一个独立的函数，很像 Java 中静态类的静态方法。

而且，`list<>`类更像是一个链表，而不是Java的`List<>`or`ArrayList`类型。该类`vector<>`是 C++ 中类似数组的类所需要的。

至于`&`符号，它表示一个引用，您应该在一些基本的 C++ 指南中查找有关值类型、指针和引用的解释。

istream 类型是流，我希望您从 Java 中熟悉它。上面的 C++ 参考在“IOStream 库”部分中有更多内容。

祝你好运，欢迎使用 C/C++！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T21:40:51.977

istream & 表示通过引用传递。引用有点像指针，只是更安全一点。我建议你买一本好的 C++ 书。由于您已经了解基本编程并且可以编程 Java，因此您可能会喜欢[Accelerated C++](http://www.acceleratedcpp.com/)。这是一本非常好的书，将帮助您快速掌握惯用的 C++

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T21:38:28.967

`&`表示C++ 中的*引用*。它与指针不同，因为它不能为 null 并且您不能对其进行指针运算。

向量和列表数据类型是标准模板库 (STL) 的一部分。它是 C++ 的一组标准数据结构，很像 java.util 集合用于 Java。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T21:38:40.087

在这种情况下，`&`符号表示它`idata`是对类型对象的引用`istream`。 是许多其他类型的输入流（、等）派生自[`istream`的标准类型。](http://www.cplusplus.com/reference/iostream/istream/)`iostream``ifstream`

# php - PHP MySQL 搜索组合列

> ID：10182027
> 
> 赞同：1
> 
> 时间：2012-04-16T21:33:58.263
> 
> 标签：php, mysql, search, sql-like

当我发现它没有按照我想要的方式搜索时，我刚刚完成了用户系统的搜索功能。

如果我有一个包含名为“fname”和“lname”的 2 列的数据库表。

在一行中，“fname”的值为“Ashley”，“lname”的值为“Staggs”。

我可以搜索“Ashley”或“Staggs”，我会正确获得结果，但如果我搜索“Ashley Staggs”，则不会显示任何结果。

我将如何正确地做到这一点？

我的 SELECT 查询如下：

```
SELECT * FROM `users` WHERE fname LIKE '%" . protect($_GET['s']) . "%' OR lname LIKE '%" . protect($_GET['s']) . "%' 
```

我知道会发生这样的事情，但这次我想不通。

谢谢，阿什利

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T21:42:14.793

'Ashley Staggs' 既不在 fname 中，也不在 lname 中，因此您的请求不会返回任何内容。您可以尝试连接您的 MySQL 字段：

```
SELECT * FROM `users` WHERE fname LIKE '%" . $_GET['s'] . "%' OR lname LIKE '%" . $_GET['s'] . "%' OR CONCAT(fname, ' ', lname) LIKE '%" . $_GET['s'] . "%' 
```

**[编辑]**更好：

```
SELECT * FROM `users`
WHERE REPLACE(CONCAT(fname, lname, fname), ' ', '')
LIKE '%" . str_replace(' ', '', protect($_GET['s'])) . "%' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T21:48:04.647

```
SELECT fname_lname FROM ( SELECT CONCAT(fname, ' ', lname) fname_lname FROM users ) users
WHERE fname_lname LIKE '%" . $_GET['s'] . "%' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-19T14:04:33.457

嘿，我想建议一个更强大的搜索，但它需要`MyISAM`表格代码是

```
$q="you search string";
$searchArray = explode(" ", $q);
$query="SELECT * FROM cmusers WHERE  MATCH (`firstname`, `lastname`, `email`) AGAINST ('";
$i=0;
foreach ($searchArray as $word) {
$query .= "+".$word."* ";
}
$query .= "' IN BOOLEAN MODE)";
$result=mysql_query($query) or die("Error founded:".mysql_error()."there is problem existing we feels a very great sorry");
$finded=mysql_num_rows($result); 
```

可以在[http://www.funnenjoy.com上看到它的工作原理](http://www.funnenjoy.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T21:48:42.777

您可以尝试这样的事情 - 它只会用空格分割搜索字符串并搜索每个单词：

```
$search = explode(' ', $_GET['s']);
$query = 'SELECT * FROM `users` WHERE 0';
foreach ($search as $v)
{
  $v = mysql_real_escape_string($v);
  $query .= " OR (`fname` LIKE '%{$v}%' OR `lname` LIKE '%{$v}%')";
}
// echo $query; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-16T21:50:48.407

关于 sp00m 答案，我的方法略有不同，但建立在相同的概念之上。

```
$search = preg_replace ( "/\s\s+/" , " " , $_GET['s']); 
```

然后使用这个查询：

```
"SELECT * FROM `users` WHERE CONCAT(fname, ' ', lname) LIKE '%" . $search . "%' OR CONCAT(lname, ' ', fname) LIKE '%" . $search . "%'" 
```

**编辑**

刚刚有了一个可以使用的想法。基本上，您可以在表中创建两个附加字段 -`fname_lname`并且`lname_fname`，使用我之前提到的正则表达式来消除不必要的空格，用于`explode()`检查字数。如果你有两个词，那么你可以使用这两个新字段，在查询中只给你两个条件。当您只有一个词时，查询中仍有两个条件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-22T05:39:33.883

我会做的

`SELECT * FROM users WHERE CONCAT(firstname, ' ', lastname) LIKE '%{$search}%'`

# android - Android 布局 - 布局正常与布局

> ID：10182033
> 
> 赞同：3
> 
> 时间：2012-04-16T21:34:28.903
> 
> 标签：android, android-layout

Android 在“layout-normal”和“layout”文件夹中处理布局的方式有什么不同吗？如果我有一个被认为是布局较小的设备，如果只有这两个选项，它将查看哪个文件夹？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T21:37:11.337

是的，在您给出的示例中，它将首先从“布局”中获取。

在确定从哪里提取资源时，将首先检查与设备匹配的布局大小文件夹（即小型设备将首先检查布局小），如果有问题的特定资源在那里不可用，那么它将检查普通的“布局”。当且仅当资源仍然不可用时，它才会开始检查与当前运行的设备不匹配的“布局大小”文件夹。

**编辑：**刚刚在小型设备上进行了测试。我的发现再次证实了我认为它会起作用的方式。如果资源存在于两者中，它肯定会从普通布局而不是小型设备上的布局正常中获取。

# django - Django为同一页面缓存不同的内容

> ID：10182037
> 
> 赞同：1
> 
> 时间：2012-04-16T21:34:42.193
> 
> 标签：django, caching

我有一个显示产品列表的页面。我在每次请求时都会显示列表中的所有产品，所以我使用的是 django 提供的标准缓存中间件。

现在我将限制显示的产品数量，并希望将每个中间结果也缓存在缓存中，因此我不需要一直生成所有页面。示例：假设我在列表中有 9 个产品，并且一次显示 3 个产品。

我将有一页包含从 0 到 2、从 3 到 5、从 6 到 8 的产品。访问所有这些产品的 URL 将是相同的。例如，是否可以使用标准缓存中间件向“Vary”标头添加一些内容？我可以在某处添加初始索引（0、3 或 6），以便我可以使用标准装饰器之一吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:39:04.740

您应该为您的问题添加更多描述，例如您正在使用的中间件和/或所涉及的视图装饰器。

我能说的是 Django 自己会关心 GET 参数，所以如果你有一个像

/list/?page=1

它的页面缓存将具有不同的缓存键

/list/?page=2

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:07:16.740

我找到了解决方案。根据#django irc 频道中的建议，我正在视图中缓存 render_to_response 返回的响应

# css - 使用现代 CSS 从第一个元素中删除上边距

> ID：10182039
> 
> 赞同：4
> 
> 时间：2012-04-16T21:34:49.640
> 
> 标签：css, html, printing, margin

是否可以使用 CSS 和**最新的 Chrome 或 Firefox**自动删除第一个`<h1>`标签的上边距，还是我仍然必须使用 jQuery？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-16T21:38:10.730

你只需要`h1:first-child { margin-top: 0px; }` [**DEMO**](http://jsfiddle.net/skram/Me5ZV/2/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-16T23:11:56.307

没有`:first-of-page`选择器所以不，你不能肯定使用 CSS。CSS 中没有办法从页面中提取所有 h1，无论他们的父母和前面的兄弟姐妹，只取第一个。
您需要更多地了解您的 h1 元素。

例子：

*   如果它也是`body > header`（或 HTML 4.01 中的#header ）的（第一个和或唯一的）孩子，则可以选择第一个 h1
*   如果所有 h1 都是兄弟姐妹，那么`h1:first-of-type`肯定是第一个
*   如果第一个 h1 就在某个部分的主导航之后，则`body > nav + section > h1`选择它。或许`body > header > nav + section > h1:first-of-type`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T21:36:48.360

```
div#content h1:first-child { margin-top:0; } 
```

AFAIK 这在 IE6 中不起作用，在 IE7 中可能有问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T21:36:57.407

伪选择器。

```
h1:first-child {
    margin-top: 0;
} 
```

请注意，Failbrowsers（IE 7 和更早版本）不支持这些，因此您可能仍需要 jQuery 备份解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-16T21:38:06.230

向 h1 标签添加一个类，例如：

```
<h1 class="first">Your text</h1> 
```

然后在css中：

```
.first
{
    margin-top: 0;
} 
```

# c# - SQL Server 数据库或 SQL Server 上的数据库

> ID：10182041
> 
> 赞同：1
> 
> 时间：2012-04-16T21:34:56.037
> 
> 标签：c#, sql-server

我正在编写将在一台计算机上使用的 windows 应用程序。我喜欢使用 SQL Server，使用存储过程检索数据，等等...我的问题是，SQL Server 数据库（在文件中）和 SQL Server 上的标准数据库有什么区别，因为我不想安装客户端 PC 上的 SQL 服务器仅用于一个应用程序。这个 SQL Server DB 可以与存储过程一起使用，还是有其他方法？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T21:39:28.543

如果您不想在客户端计算机上安装完整的 SQL Server 引擎，您可以使用专为这些场景设计的嵌入式数据库，例如[SQL Server Compact](http://weblogs.asp.net/scottgu/archive/2011/01/11/vs-2010-sp1-and-sql-ce.aspx)或[SQLite 。](http://sqlite.phxsoftware.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T21:40:13.740

你可能想看看[SQL Server Compact](http://www.microsoft.com/sqlserver/en/us/editions/compact.aspx)、[SQL Server Express](http://www.microsoft.com/sqlserver/en/us/editions/express.aspx)或类似[SQLite](http://sqlite.org/)的东西。我认为这些中的任何一个都不能真正提供一种在不安装或需要安装*其他东西*`AttachDbFileName`的情况下运行数据库引擎的方法（例如，您可以使用SQL Server 的方法，但这依赖于已经存在的 VS/Express）。

# javascript - JS 加载的 Twitter 分享按钮无法正确呈现

> ID：10182047
> 
> 赞同：0
> 
> 时间：2012-04-16T21:35:09.963
> 
> 标签：javascript, ruby-on-rails, twitter

在我的 Rails 应用程序中，我有一个“无限页面”，当您向下滚动时会加载更多博客文章。在每篇博文上，都有一个 Twitter 分享按钮。首次加载页面时，所有“首屏”共享按钮都加载得很好；该按钮正确显示，当您单击它时，将显示推文的自定义文本。

但是，向下滚动时加载的共享按钮不起作用。当您向下滚动并加载更多博客文章时，共享按钮会失去其样式（变成纯链接），并且自定义文本功能也会消失（当您单击它时，它会打开一个空白的 Twitter 窗口，没有自定义文本）。

即使我在每个按钮下加载了所有 twitter JS，它仍然无法正常工作。这是我的按钮代码：

```
 %a.twitter-share-button{"data-count" => "none", "data-text" => "#{post.title} (My new blog post!)", "data-url" => "http://www.example.com", :href => "https://twitter.com/share"} Tweet
    :javascript
        !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="http://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:15:27.983

根据[https://dev.twitter.com/discussions/6860](https://dev.twitter.com/discussions/6860)，要将多个 Twitter 按钮动态添加到页面，您需要使用：

```
twttr.render(); 
```

添加每组按钮后。此函数将呈现页面上当前的所有按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T09:35:52.620

更新：使用更新的 API，它应该是

```
twttr.widgets.load() 
```

# http - Yum 客户端配置：如何对 80 以外的端口使用基本身份验证？

> ID：10182050
> 
> 赞同：4
> 
> 时间：2012-04-16T21:35:27.970
> 
> 标签：http, authentication, yum

我在配置我使用 HTTP/Apache 提供的 Yum 存储库时遇到了问题。

我想使用 http 基本身份验证，并将侦听端口设置为 80 以外的端口，因为这个 repo 在我的 DMZ 中。我试图通过如下设置我的 baseurl 来做到这一点（来自我的 repo 文件）：

```
baseurl=http://user:password@<my-ip>:<my-non-80-port>/yum/RHEL/7/base/$basearch/ 
```

yum.conf 的文档表明您可以通过将用户名/密码添加到 URL 来进行基本的 http 身份验证，就像我在上面所做的那样。当我尝试`yum search mysql`从客户端执行操作时出现以下错误：

```
[Errno 14] HTTP Error 401: Authorization Required 
```

这向我表明，指定端口的额外“：”混淆了 yum 对我的 url 的解析。我删除了端口，将服务器设置回端口 80，它就可以工作了。

因此，您似乎无法进行基本的 http 身份验证并更改 Web 服务器侦听的端口号。我注意到新版本的 Yum 中有`username`和`password`指令，但我的版本似乎没有这个指令（我正在运行 yum-3.2.22-37.0.1.el5）。有什么解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T03:03:51.540

我通过在我的 yum 配置中添加以下行来关闭插件来解决这个问题。

```
plugins=0 
```

我认为解决方法有效，因为基本 yum 更新程序可以很好地处理来自 baseurl 的授权信息，但是一些插件（例如 fastmirror 插件）没有正确记住授权。因此，我在未启用插件的情况下的行为是，最初更新会起作用，然后它会开始失败，并出现问题中的授权错误。一旦我禁用插件，一切都开始正常工作。

# ios - NSMutableArray 或 NSMutableDictionary ：哪个最适合这种情况？

> ID：10182056
> 
> 赞同：1
> 
> 时间：2012-04-16T21:36:20.087
> 
> 标签：ios

我需要滚动浏览数千个单词以对其进行分类……以确定哪些单词具有相同的模式。（这部分有效）例如，在第 2 和第 4 位置有两个 m 的四字母单词表示模式（“-mm”）。一旦我浏览了所有的单词，我就会知道任何给定的模式有多少单词。我现在正在滚动浏览，但我遇到的问题是“记住”在任何给定模式下我有多少个单词。

我正在考虑使用 NSMutableDictionary 并且键是模式（'-mm-'），对象代表该模式的计数。这意味着每次遇到模式时，我都会在字典中查找该模式，获取键，递增键，然后将其放回字典中。

我需要有关执行此任务的决策和语法方面的帮助。

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:49:02.283

您的问题的答案是您（给定）问题的这一部分“我会知道任何给定模式有多少个单词。”。我会使用一个字典数组。您使用字典来存储键值对：已知模式和计数。并且您使用数组来存储这些 KVP 记录。因此，下次您检测到模式时，搜索该记录（字典）的数组，如果找到，则增加计数。如果没有，则创建新记录并将计数设置为 1。

添加示例代码：

```
#define kPattern @"Pattern"
#define kPatternCount @"PatternCount"

-(NSMutableDictionary *)createANewDictionaryRecord:(NSString *) newPattern
{
    int count = 1;
    NSMutableDictionary *myDictionary = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                   newPattern, kPattern,
                                   [NSString stringWithFormat:@"%i",count], kPatternCount,
                                   nil];
    return myDictionary;
}

-(void)addANewPatternToArray:(NSMutableDictionary *)newDictionary
{
   // NSMutableArray *myArrayOfDictionary = [[NSMutableArray alloc]init];  // you need to define it somewhere else and use property etc.
    [self.myArrayOfDictionary addObject:newDictionary];  //or [self.myArrayOfDictionary addObject:newDictionary];  if you follow the recommendation above.
}

-(BOOL)existingPatternLookup:(NSString *)pattern
{
    for (NSMutableDictionary *obj in self.myArrayOfDictionary)
    {
        if ([[obj objectForKey:kPattern] isEqual:pattern])
        {
            int count = [[obj objectForKey:kPatternCount] intValue] + 1;
            [obj setValue:[NSString stringWithFormat:@"%i",count] forKey:kPatternCount];
            return YES;
        } 
    }
    [self.myArrayOfDictionary addObject:[self createANewDictionaryRecord:pattern]];
    return NO;
}

-(void)testData
{
    NSMutableDictionary *newDict = [self createANewDictionaryRecord:@"mmm"];
    [self addANewPatternToArray:newDict];
}

-(void) printArray
{
    for (NSMutableDictionary * obj in self.myArrayOfDictionary)
    {
        NSLog(@"mydictionary: %@", obj);
    }
}

- (IBAction)buttonPressed:(id)sender 
{
    if ([self existingPatternLookup:@"abc"])
    {
        [self printArray];
    } else 
    {
        [self printArray];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T21:45:46.657

不是一个客观的 C 专家，但之前在 java 中解决了这个问题，我会说字典（我在 java 中做它时使用了地图）是最好的方法。检查键（模式）是否已经存在，如果增加该计数，则在字典中放置一个新的。

**编辑**

如果您不仅想获得模式的计数，而且实际上要知道哪些单词属于该模式，我会使用字符串字典来表示可变数组。在数组中存储单词，数组的键是模式（作为字符串），与上面的代码类似，但不仅仅是增加计数，您必须将新单词添加到数组中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T21:55:19.397

NSDictionary 和 NSMutableDictionary 的唯一区别是可以添加对象。我认为您的实现很好，但是英语是一种复杂的语言。使用正则表达式解析字符串比为其设置键更有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T21:58:12.530

你为什么不`NSCountedSet`改用：

[NSCountedSet 类参考](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSCountedSet_Class/Reference/Reference.html#//apple_ref/occ/cl/NSCountedSet%22)

..在 iOS 2.0 及更高版本中可用？

> 每个插入到 NSCountedSet 对象中的不同对象都有一个与之关联的计数器。NSCountedSet 跟踪插入对象的次数 [...] 因此，即使对象已多次添加到集合中，NSSet 对象中也只有一个对象实例。超类NSSet定义的count方法具有特殊意义；它返回不同对象的数量，而不是对象在集合中表示的总次数。

然后使用：

```
- (NSUInteger)countForObject:(id)anObject 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-16T22:01:36.697

使用 NSMutableArrays 的字典，并按照您的建议检查每个搜索键是否存在。如果键不存在，例如为搜索到的键类型“-mm”添加 NSMutableSet 或 NSMutableArray（取决于您的需要），然后添加到该键的集合或数组中。

# image - 帖子中的 Wordpress NextGen 滑块

> ID：10182063
> 
> 赞同：0
> 
> 时间：2012-04-16T21:37:08.703
> 
> 标签：image, wordpress, plugins, slider, nextgen-gallery

我正在为 wordpress 页面的各个博客文章配置图像滑块。想要快速做到这一点，所以考虑合并 NextGen 滑块，但它似乎更适合将图像放在 wordpress 的“页面”而不是 wordpress 的“帖子”上。

我想创建单独的帖子，每个帖子都有不同的 NextGen 滑块。使用 wordpress 框架组织这个的最佳方法是什么？

目前，我的滑块位于“mysite.com/slider”。我可以设置 NextGen 以便不同的画廊指向“mysite.com/post1”、“mysite.com/post2”等吗？如果没有，您是否找到了另一种方法来执行此任务？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T10:22:18.523

在帖子正文中使用以下简码。

```
[slideshow id,width,height] 
```

其中变量名具有直观意义。您必须转到插件设置来检索幻灯片 ID。这也意味着您可以为不同的帖子制作不同的幻灯片。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T09:27:07.050

基于 Srijans 的回答，但正确的语法是 [nggallery id=x] ，其中 'x' 等于您的画廊的 id。将此短代码插入您的帖子正文并从那里开始。

# iphone - 导航栏动画变白

> ID：10182065
> 
> 赞同：0
> 
> 时间：2012-04-16T21:37:11.850
> 
> 标签：iphone, ios, xcode, uiviewcontroller

好的，所以最初我认为我的问题与我添加的新背景有关。然而，我现在发现实际上它只是无缘无故地开始发生，我不记得了......

发生的问题是当我动画回到我的原始视图时，我将我的导航控制器栏从显示我的导航栏的 tableview 中隐藏起来。导航栏被一个白色块代替。

我不确定为什么会发生这种情况..这就是我隐藏我的酒吧的方式，因为它也有动画..

```
- (void)viewWillAppear:(BOOL)animated
{
    [self.navigationController setNavigationBarHidden:YES animated:NO]; //Hides the navigation bar
//..
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T21:39:06.543

您的视图可能不会在 -viewWillAppear 被调用时被加载（想想看，它不应该被加载）。将您的实现移至 -viewDidLoad。

编辑：这是因为当您隐藏导航栏时，如果没有将 WantsFullScreenProperty 设置为 YES，并且导航栏设置为半透明，您的视图通常不会补偿栏的高度。

# eclipse - ElasticSearch 没有出现在 Eclipse 项目资源管理器中

> ID：10182068
> 
> 赞同：0
> 
> 时间：2012-04-16T21:37:23.107
> 
> 标签：eclipse, playframework, elasticsearch

我正在使用 ElasticSearch 为我的 Web 应用程序实现搜索引擎，我正在使用 Play 框架。当我尝试安装 ElasticSearch 模块时，它在命令提示符中写入它已成功安装，但它没有像 CRUD 等其他模块那样出现在项目资源管理器中，而且当我尝试使用`@ElasticSearchable`它时也会引发它不能的错误被解析成一个类型。

我确实尝试停止应用程序并将其重新导入 Eclipse，但没有任何改变。

这是我在命令提示符下得到的。我认为这可能是我将弹性搜索文件夹放在错误的位置，我已将其添加到模块文件夹中，这是正确的位置吗？

```
~        _            _
~  _ __ | | __ _ _  _| |
~ | '_ \| |/ _' | || |_|
~ |  __/|_|\____|\__ (_)
~ |_|            |__/
~
~ play! 1.2.4, http://www.playframework.org
~
~ Resolving dependencies using C:\Users\ahmed\Documents\play\play-1.2.4\se\conf\dependencies.yml,
~
~       play->elasticsearch {0.4} (from playContributedModules)
~
~ WARNING: Some dependencies could not be downloaded (use --verbose for details),
~
~       play->elasticsearch {0.4}: missing artifact
~
~ No dependencies to install
~
~ *****************************************************************************
~ WARNING: These dependencies are missing, your application may not work properly (use --verbose for details),
~
~       play->elasticsearch {0.4}: missing artifact
~ *****************************************************************************
~
~ Some dependencies are still missing.
~ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T05:20:48.783

您没有详细描述您的安装过程，但是您是否按照[ElasticSearch 模块页面](http://www.playframework.org/modules/elasticsearch)上的说明进行操作？

在本地安装模块后（显然您已成功完成此操作），您需要将其添加到项目`dependencies.yml`文件中：

```
require:
    - play -> elasticsearch {version} 
```

然后，在命令提示符下，为您的项目执行`play dependencies`和`play eclipsify`命令。转到 Eclipse，刷新您的工作区，您应该已经准备就绪。

# jsf - 即使我没有更改值，也会在 selectOneMenu 上调用 valueChangeListener 方法

> ID：10182069
> 
> 赞同：5
> 
> 时间：2012-04-16T21:37:29.560
> 
> 标签：jsf, jsf-2

我有以下问题。当我单击“Enviar”按钮时，这会调用另一个与 selectOneMenu 关联的方法（在名为“validarSelect”的属性 valueChangeListener 中），然后调用该按钮在名为“validarBoton”的属性 actionListener 中关联的方法。我想知道，为什么会发生这种情况。我希望`valueChangeListener`不会被调用，因为我没有更改下拉列表。

这是我的页面 JSF：

```
<?xml version='1.0' encoding='windows-1252'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <f:view xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html">
<html xmlns="http://www.w3.org/1999/xhtml">
    <h:head></h:head>
    <h:body>
        <h:form>
            <h:commandButton value="Enviar..." id="validar" actionListener="#{Domiciliacion.validarBoton}"/>
            <h:selectOneMenu valueChangeListener="#{Domiciliacion.validarSelect}"
                             binding="#{Domiciliacion.selectCombo}">
                <f:selectItems value="#{Domiciliacion.lista}"/>
                <f:ajax event="valueChange" render="@this"/>
            </h:selectOneMenu>
        </h:form>
    </h:body>
</html> 
```

这就是 ManagedBean：

```
package domiciliaciontest;

import java.util.ArrayList;
import java.util.List;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped;
import javax.faces.component.html.HtmlSelectOneMenu;
import javax.faces.event.ActionEvent;
import javax.faces.event.ValueChangeEvent;

@ManagedBean(name = "Domiciliacion")
@ViewScoped

public class MB0001 {

private HtmlSelectOneMenu selectCombo;
private List<String> lista = new ArrayList<String>();

public MB0001() {
    super();
    System.out.println("Entro al constructor...");
    lista.add("Caracas");
    lista.add("Bogota");
    lista.add("Santiago");
}

public void validarBoton(ActionEvent actionEvent) {
    System.out.println("Entro a validarBoton...");
    // Add event code here...
}

public void validarSelect(ValueChangeEvent valueChangeEvent) {
    // Add event code here...
    System.out.println("Entro a validarSelect...");
}

public void setSelectCombo(HtmlSelectOneMenu selectCombo) {
    this.selectCombo = selectCombo;
}

public HtmlSelectOneMenu getSelectCombo() {
    return selectCombo;
}

public void setLista(List<String> lista) {
    this.lista = lista;
}

public List<String> getLista() {
    return lista;
}
} 
```

这是我单击“Enviar”按钮时的输出：

*   输入一个验证选择...
*   输入一个验证器Boton...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T13:32:40.673

当提交的值与初始值不同时，将调用该`valueChangeListener`方法，无论您是否*自行*更改。因此，如果当前提交的值（`"Caracas"`在您的情况下）与初始值（在您的情况下）不同，则将调用`null`该方法。`valueChangeListener`

### 也可以看看：

*   [何时使用 valueChangeListener 或 f:ajax 监听器？](https://stackoverflow.com/questions/11879138/when-to-use-valuechangelistener-or-fajax-listener)
*   [在 JSF 中向 selectOneMenu 添加“未选择”选项的最佳方法](https://stackoverflow.com/questions/11360030/best-way-to-add-a-nothing-selected-option-to-a-selectonemenu-in-jsf)

* * *

**与具体问题无关**，将其与属性结合使用`binding`给我的印象是您正在尝试实现您在针对 JSF 1.x 的文章或答案中阅读的内容。这可以作为在 JSF 1.x 中填充子下拉菜单的 hack 的一部分而被识别。对于 JSF 2.x，您*不需要*这种方法。此外，带有“validar”（“validate”）的方法名称具有误导性。你*真的*不需要一个完全值得的`Validator`吗？但如前所述，这是一个不同的问题。

### 也可以看看：

*   [在 JSF 中创建多个依赖/级联 selectOneMenu 下拉列表](https://stackoverflow.com/questions/16378099/make-multiple-dependent-cascading-selectonemenu-dropdown-lists-in-jsf)

# android - 使用 Proguard 在 res/raw 中使用 XML 文件时出现 NullPointerException

> ID：10182076
> 
> 赞同：3
> 
> 时间：2012-04-16T21:38:17.183
> 
> 标签：android, proguard, simple-framework

我在我的应用程序中使用了一个[简单的 XML 序列化](http://simple.sourceforge.net/)程序，并且似乎通过在 proguard.cfg 中使用以下行成功地将其从 Proguard 混淆中排除，这要感谢这个[SO question](https://stackoverflow.com/questions/7188056/android-simplexml-jar-proguard-problem)：

```
-keep public class org.simpleframework.**{ *; } 
-keep class org.simpleframework.xml.**{ *; } 
-keep class org.simpleframework.xml.core.**{ *; } 
-keep class org.simpleframework.xml.util.**{ *; } 
```

我能够签署和导出 apk，但是当我尝试运行我的应用程序时，它在尝试访问 res/raw 目录 (R.raw.home_screen_menu) 中的 XML 文件时崩溃并出现 NullPointerException。

我将 R.java 排除在外：

```
-keepclassmembers class **.R$* {
    public static <fields>;
} 
```

我整天都在玩这个配置文件，但没有任何运气。有没有人遇到过这个问题或类似的问题？我尝试过的最新方法是使用如下所示的“adaptresource”选项：

```
-adaptresourcefilenames    **.xml
-adaptresourcefilecontents **.xml 
```

作为参考，这里是我的 proguard.cfg 的内容：

```
#Use 5 step of optimization 
-optimizationpasses 5

#When not preverifing in a case-insensitive filing system, such as Windows. This tool will unpack your processed jars,(if using windows you should then use):
-dontusemixedcaseclassnames

#Specifies not to ignore non-public library classes. As of version 4.5, this is the default setting
-dontskipnonpubliclibraryclasses

#Preverification is irrelevant for the dex compiler and the Dalvik VM, so we can switch it off with the -dontpreverify option.
-dontpreverify

#Specifies to write out some more information during processing. If the program terminates with an exception, this option will print out the entire stack trace, instead of just the exception message.
-verbose

#The -optimizations option disables some arithmetic simplifications that Dalvik 1.0 and 1.5 can't handle. Note that the Dalvik VM also can't handle aggressive overloading (of static fields).
#To understand or change this check http://proguard.sourceforge.net/index.html#/manual/optimizations.html
-optimizations !code/simplification/arithmetic,!field/*,!class/merging/*

-dump ../bin/class_files.txt
-printseeds ../bin/seeds.txt
-printusage ../bin/unused.txt
-printmapping ../bin/mapping.txt 

-dontskipnonpubliclibraryclassmembers

#Ignore warnings for roboguice.activity.RoboAccountAuthenticatorActivity
-dontwarn roboguice.activity.RoboAccountAuthenticatorActivity

-keep public class * extends android.app.Activity
-keep public class * extends android.app.Application
-keep public class * extends android.app.Service
-keep public class * extends android.content.BroadcastReceiver
-keep public class * extends android.content.ContentProvider
-keep public class * extends android.app.backup.BackupAgentHelper
-keep public class * extends android.preference.Preference
-keep public class com.android.vending.licensing.ILicensingService
-keep class com.google.inject.Binder

# Keep annotations
-keepattributes *Annotation*
-keepattributes Signature

#To remove debug logs:
-assumenosideeffects class android.util.Log {
    public static *** d(...);
    public static *** v(...);
    public static *** w(...);
}

# Roboguice
-keepclassmembers class * {
    @com.google.inject.Inject <init>(...);
}

# SimpleXML
-keep public class org.simpleframework.**{ *; } 
-keep class org.simpleframework.xml.**{ *; } 
-keep class org.simpleframework.xml.core.**{ *; } 
-keep class org.simpleframework.xml.util.**{ *; } 
-dontwarn javax.xml.stream.**
-dontwarn javax.xml.namespace.**

-keep public class roboguice.**

# There's no way to keep all @Observes methods, so use the On*Event convention to identify event handlers
-keepclassmembers class * { 
    void *(**On*Event); 
}

-keep public class * extends android.view.View {
    public <init>(android.content.Context);
    public <init>(android.content.Context, android.util.AttributeSet);
    public <init>(android.content.Context, android.util.AttributeSet, int);
    public void set*(...);
}

-keepclasseswithmembers class * {
    native <methods>;
}

-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet);
}

-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet, int);
}

-keepclassmembers enum * {
    public static **[] values();
    public static ** valueOf(java.lang.String);
}

-keep class * implements android.os.Parcelable {
  public static final android.os.Parcelable$Creator *;
}

-keepclassmembers class * implements android.os.Parcelable {
    static android.os.Parcelable$Creator CREATOR;
}

-keepclassmembers class **.R$* {
    public static <fields>;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-02-17T09:27:11.913

我也有完全一样的问题。最后我解决了这个问题和答案。我在这里留下了最终的配置：

**构建.gradle：**

```
buildTypes {
    release {
        minifyEnabled true
        shrinkResources true
        proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
    }
}

dependencies {
    compile('org.simpleframework:simple-xml:2.7.1') {
        exclude module: 'stax'
        exclude module: 'stax-api'
        exclude module: 'xpp3'
    }
} 
```

**proguard-rules.pro**（添加到默认的 proguard 配置）

```
-dontwarn javax.xml.**

-keep public class org.simpleframework.**{ *; }
-keep class org.simpleframework.xml.**{ *; }
-keep class org.simpleframework.xml.core.**{ *; }
-keep class org.simpleframework.xml.util.**{ *; }

-keepattributes Signature
-keepattributes *Annotation*

# Ignore our XML Serialization classes
-keep public class your.annotated.pojo.models.*{
  public protected private *;
} 
```

希望它对某人有帮助

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T21:59:32.027

原来原始文件被单独留下并且没问题。问题是我的类用于带有简单 XML 序列化器注释的序列化。我在我的应用程序中添加了日志语句，并在违规行发现了这个错误：“属性 'id' 在第 2 行的类 com.xxx.ListViewItems 中没有匹配项”。这让我意识到私有的“id”变量被混淆了，Simple XML 序列化程序无法识别。下面是 ListViewItems.java 中的代码：

```
@Attribute(required=false)
private String id;  // This was being obfuscated and thus unrecognizable! 
```

这是我添加到 Proguard 以完全跳过混淆类的内容（可能有更好的方法）：

```
# Ignore our XML Serialization classes
-keep public class com.xxx.ListViewItems {
  public protected private *;
} 
```

# grails - Grails hasOne 单向

> ID：10182080
> 
> 赞同：0
> 
> 时间：2012-04-16T21:38:36.207
> 
> 标签：grails, grails-orm, relationship

目前我遇到了一些麻烦，在 Grails 中创建单向关系。

我有一个带有属性地址的类厕所。这个地址是一个单独的类。如果与地址关联的厕所对象被删除，则地址理论上可以仍然存在。如果地址被删除，厕所也将保留。

GORM 的 hasOne 不是我需要的，因为它创建了双向关系。

定义类型类的属性只会导致非持久化地址（尽管它有自己的表） - 这意味着地址与厕所对象的关联不存在

我不是很熟悉这些关系，所以我真的很感激一个解决方案或其他方式来实现我的目标

希望我的问题很清楚 - 如果没有评论，我会尝试添加进一步的解释

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:38:26.457

摘自

[http://grails.org/doc/1.0.x/guide/5.%20Object%20Relational%20Mapping%20(GORM).html](http://grails.org/doc/1.0.x/guide/5.%20Object%20Relational%20Mapping%20(GORM).html)

5.3.3 了解级联更新和删除

了解使用 GORM 时级联更新和删除的工作原理至关重要。要记住的关键部分是 belongsTo 设置，它控制哪个类“拥有”关系。无论是一对一、一对多还是多对多，如果你定义了 belongsTo 更新和删除将从拥有的类级联到它的所有物（关系的另一端）。

如果您不定义 belongsTo 则不会发生级联，您必须手动保存每个对象。

所以.....如果您不使用belongsTo，那么如果您手动保存每个对象，您应该没有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-07T18:20:36.427

为什么没有一个模拟关联的类？

```
class ToiletAddress {
  Toilet toilet
  Address address
  ...
} 
```

...然后只需将您的逻辑包装到一个服务中，您可以在其中为厕所分配地址，并删除厕所或地址。

使用约束，您可以定义它是什么类型的关联。例如 1-1、1-n（两侧）和 nm

```
static constraints = {
  address unique: ['toilet']
  toilet validator: {val, obj -> ... }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T21:57:29.557

`hasOne`如果厕所上的地址是一个没有或映射的简单关联`belongsTo`，则不会有任何操作级联。

这意味着您必须保存地址、分配地址`toilet.address`并保存厕所。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T20:20:00.547

找到了解决方案。

我遗漏的是在厕所类中实现一个接口。

问题是（提醒一下）厕所类中的地址关系没有保存到数据库中。

这是接口本身的问题——在这个接口中，getter 和 setter 被定义并且必须被实现（接口的工作方式——显然）。这里的问题是， Address-Attribute 的设置者需要 Type `IAddress`。

我重载了 setter 以接收 type 的参数`Address`。

`Toilet`通过这个改变，和之间的关系`Address`被正确地保存到数据库中——地址的ID被保存在厕所的表中。

我认为 setter 的定义只是一个错误（我对界面没有影响），但是通过这种解决方法，我无论如何都可以让它工作

希望这个解释对其他人也有帮助。

# php - PHP 发送的电子邮件主题 - Hotmail/Outlook 将 £ 显示为 Â£

> ID：10182093
> 
> 赞同：2
> 
> 时间：2012-04-16T21:39:44.687
> 
> 标签：php, email

当我使用 PHP 邮件发送包含 £ 的电子邮件时，它在 Outlook/hotmail 中显示为 Â£。在 Gmail/thunderbird 中很好。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:33:57.140

问题是，客户端不知道使用什么编码来编码主题。无论您的应用程序在`Content-Type`标头中设置什么，都仅适用于电子邮件正文，而不适用于标头。

通常这会影响以下标题：

*   学科
*   从
*   到

为了使用不同的编码，您的国际化标题行应使用以下两种方法之一进行 MIME 编码（从 RFC 2047 开始）：base64 (B) 或修改后的引用打印 (Q)。编码的主题通常如下所示：

```
Subject: =?ISO-8859-1?Q?Pr=FCfung_f=FCr?= Entwerfen von einer MIME kopfzeile 
```

这可能看起来很困难，但是 PHP 中有一个非常方便的辅助函数可以完成所有的魔法：

*   [iconv_mime_encode()](http://www.php.net/manual/en/function.iconv-mime-encode.php) - 组成一个 MIME 标头字段

或者，您可以查看以下讨论：

*   [quoted_printable_encode()](http://www.php.net/manual/en/function.quoted-printable-encode.php) - 将 8 位字符串转换为带引号的可打印字符串

直接使用前`quoted_printable_encode()`需要考虑到长行需要按一定长度分割，空格需要用下划线“_”代替。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T21:53:17.527

[就在今天，我通过使用phpmailer](http://code.google.com/a/apache-extras.org/p/phpmailer/)而不是 php 的内置修复了类似的主题编码问题`mail`：

```
$mail = new PHPMailer(true);
$mail->IsSMTP();
$mail->CharSet = "utf8";
$mail->Subject = $mail->EncodeHeader("You won £10000000!");
....
$retval = $mail->Send(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T22:05:04.793

通常我使用该`mb_convert_encoding()`功能

```
mb_convert_encoding($string, "UTF-8"); //AUTO DETECT AND CONVERT
mb_convert_encoding($string, "UTF-8", "latin1"); //MANUAL SET - CHANGE latin1 TO CURRENT ENCODING 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T21:53:47.977

尝试在您的电子邮件中使用 UTF-8 编码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-24T16:09:14.700

这对我有结果

```
<?php $subject = "=?UTF-8?B?" . base64_encode($subject) . "?="; ?> 
```

# ruby-on-rails - 如何使选择内容成为 Rails 模型的属性

> ID：10182097
> 
> 赞同：0
> 
> 时间：2012-04-16T21:39:53.390
> 
> 标签：ruby-on-rails, ruby, model, attributes

我什至很难提出我想要回答的问题，所以这是我的情况：

我正在尝试使用我在其他地方填充的现有数据库制作一个简单的股市绘图仪工具。我的应用程序已经有一个很好的动态绘图仪，可以与任何数据库一起使用，但它需要以某种方式获取数据。所以说我的模型（数据库）看起来像这样：

```
Stock:

|___ticker___|___open___|___close___|___date___|
|    aapl    |   100    |   101     | 1/1/11   |
|    aapl    |   101    |   102     | 1/2/11   |
|    goog    |   500    |   450     | 1/1/11   |
|    goog    |   450    |   451     | 1/2/11   |
... 
```

我的绘图仪例程使用类属性（我认为这是术语），它对应于数据库中的列。

我可以选择与 对应的所有数据`'aapl'`，并轻松绘制`open`和`close`对比，`date`因为我的模型已经说明了属性。

```
@stock = Stock.select_by_ticker('aapl')
>> @stock.open  #=> 100 ...
>> @stock.close #=> 101 ...
>> @stock.date  #= 1/1/11 ... 
```

所以属性是

```
{open, close, date} 
```

但如果我想比较不同股票的收盘价，我需要与每只股票相关的属性。所以基本上我想最终得到一个以股票名称作为属性的模型，每个属性都对应于数据库中该股票代码的大块。使用易于构建的范围，我想要类似的东西：

```
@stock = Stock.select_close_by_ticker('aapl','goog') 
```

属性是：

```
{aapl, goog, date} 
```

其中 aapl 和 goog 仅包含该代码的收盘价数据。如果需要，我可以运行多个数据库查询，现在我只想能够将我的数据排序到这个表单中。此外，它必须是完全动态的，所以我不能硬编码`'aapl'`，`'goog'`以及数以百万计的其他代码到我的模型中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:40:32.163

会像：

```
stocks = ['appl', 'goog']
Stock.find(:conditions => ['ticker in (?)'], stocks) 
```

适合你的场景？

# facebook - 喜欢按钮错误 - 但不是所有页面

> ID：10182101
> 
> 赞同：1
> 
> 时间：2012-04-16T21:40:18.343
> 
> 标签：facebook, facebook-graph-api, facebook-like

我的剧院页面上有一个赞按钮。例如：

[http://raleighlittleheatre.org/shows/11-12/crucible.html](http://raleighlittletheatre.org/shows/11-12/crucible.html)

奇怪的是，他们中的许多人都说出了启动信息（即使我知道有人喜欢这个页面）：

> 成为第一个推荐这个的朋友。

当我单击 Like 按钮时，它报告错误“错误”，当我单击它时，我得到：

> 顶页面时出错。如果您是页面所有者，请尝试通过 Facebook devsite 上的 linter 运行您的页面并修复任何错误。

我运行了 linter，但除了警告我的图像太小之外没有其他错误。

其他几个页面也有这个错误，虽然我确信他们没有习惯。但是，此页面没有错误，我在它们上使用了相同的代码（全部通过 CMS）：

[http://raleighlittleheatre.org/shows/11-12/firecracker.html](http://raleighlittletheatre.org/shows/11-12/firecracker.html)

显然，我创建了一个影响某些页面但不影响其他页面的错误。想法？

更奇怪的是，如果我注销 Facebook，然后我会看到 93 或 27 或一些非零数量的人（至少其中一些我是朋友，我敢肯定）喜欢这些页面。

# php - 在 PHP 中执行大型操作而不会耗尽内存？

> ID：10182103
> 
> 赞同：2
> 
> 时间：2012-04-16T21:40:32.530
> 
> 标签：php

我正在使用 dompdf 生成大约 700 个 PDF 并将它们保存到磁盘。每个都涉及一个数据库查询以获取 PDF 的信息。当我运行它时，我进入了大约 2 分钟，然后内存不足。

1.  为什么我的内存不足？每个PDF生成不应该消耗x内存，然后在完成时释放它吗？

2.  在 PHP 中进行这样的大型操作以避免扼杀您的服务器有什么好的做法？

更多信息：

*   它会在内存不足之前生成许多 PDF（大约 100 个）
*   它失败的 PDF 在任何方面都没有异常大或特殊。它们都在 4KB 到 ~500KB 之间
*   在处理过程中观察内存使用情况，它只是慢慢地爬上来，然后开始直到用完。

我无法将所见即所得的代码正确格式化，所以这里是有问题的片段的粘贴：http: [//pastie.org/3800751](http://pastie.org/3800751)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T21:55:39.803

想法：

*   增加内存限制[`ini_set`](http://uk.php.net/manual/en/function.ini-set.php)
*   使用 cron 作业，或者通常尝试使用队列异步运行每个 pdf 生成。
*   批处理（拆分）处理成一个可以在一个页面加载内处理的数字/在每个批处理后使用重定向到同一页面/使用[会话](http://php.net/manual/en/features.sessions.php)[`header`](http://uk.php.net/manual/en/function.header.php)跟踪您在每个脚本加载的位置/注意浏览器上的重定向限制

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T21:49:36.640

您的问题可能是您异步运行代码。尝试同步运行它，它可能需要很长时间，但它会起作用。此外，请确保在每个循环结束时处理您的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T21:53:23.423

尝试`memory_limit`改变`php.ini`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T21:47:51.340

一般来说，像这样的大型操作应该分叉到子进程中，每个子进程处理生成一个 PDF。如果您的 PDF 或 DB 库泄漏内存，这应该可以避免内存不足的情况。

# scala - Scala getResourceAsStream() 在加载密钥库时静默失败

> ID：10182105
> 
> 赞同：0
> 
> 时间：2012-04-16T21:40:43.943
> 
> 标签：scala, playframework-2.0, getresource

我正在尝试使用 getResourceAsStream 加载 java 密钥库，尽管没有成功。我不确定它为什么会失败，但我正在将它加载到 Play 中！2.0 来自典型文件夹内的子文件夹。

这是文件夹结构和密钥库位置：

**播放根>>应用程序>>子文件夹1>>密钥库**

以及我从中加载它的文件的位置：

**播放根>>应用程序>>子文件夹1>>scala.class**

以及我如何在里面加载它`scala.class`：

`getClass().getResourceAsStream("/keystore")`

关于出了什么问题的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T23:14:40.867

通过在路径前面加上`/`您在`keystore`包层次结构的根部要求 a 。尝试以下任一方法：

```
getClass.getResourceAsStream("/app/subfolder1/keystore")
getClass.getResourceAsStream("keystore") 
```

有关如何指定资源路径的更多详细信息，请参阅[Java 文档。](http://docs.oracle.com/javase/6/docs/technotes/guides/lang/resources.html)

# opencv - SurfDescriptorExtractor 不创建描述符矩阵

> ID：10182109
> 
> 赞同：1
> 
> 时间：2012-04-16T21:41:21.853
> 
> 标签：opencv, surf, feature-descriptor

我对 OpenCV 中的 SurfDescriptorExtractor 有疑问。它根本不会创建矩阵！

问题是我正在强加关键点，而现在，为了调试，我只使用其中的 4-5 个。我使用 cv::Keypoint 创建关键点，并使用默认构造函数。我把点的坐标和八度设置为3。其余的，我不碰它！

这是我正在做的一段代码：

```
SurfDescriptorExtractor extractor;
cv::detail::ImageFeatures &cdif = features[i];
Mat gray_image = imread(images[i], CV_LOAD_IMAGE_GRAYSCALE);
extractor.compute(gray_image, cdif.keypoints, cdif.descriptors); 
```

这就是我创建关键点的方式，这就是循环中的内容：

```
 KeyPoint kp;
  kp.octave = 3;
  kp.pt.x = jpic.x;
  kp.pt.y = jpic.y;
  features[i].keypoints.push_back(kp); 
```

那么，有没有办法强制提取器在描述符中写一些东西？

# c - glColor4f() - alpha 值的影响

> ID：10182114
> 
> 赞同：8
> 
> 时间：2012-04-16T21:41:40.007
> 
> 标签：c, opengl, opengl-es

我正在使用 glColor4f()。令人惊讶的是，更改 alpha，即第四个参数不会导致透明度发生任何变化。代码段是：

```
const GLfloat squareVertices[] = { 
0.5, 0.5, 0.0, 
-0.5, 0.5, 0.0, 
0.5, -0.5, 0.0,
-0.5, -0.5, 0.0}; 

glEnableClientState (GL_VERTEX_ARRAY);
glClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT);
glColor4f (1.0, 0.0, 0.0, 0.5);
glLoadIdentity ();       
glTranslatef(0, 0, -5);
glVertexPointer(3, GL_FLOAT, 0, squareVertices);
glDrawArrays(GL_TRIANGLE_STRIP, 0, 4); 
```

任何指向我可能出错的地方？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-16T21:45:15.787

如果要使用透明度，则需要启用混合：

`glEnable(GL_BLEND)`;

另请参阅[glBlendFunc](http://www.opengl.org/wiki/GLAPI/glBlendFunc)以设置混合功能。

# java - 带有线程的应用程序加载器

> ID：10182116
> 
> 赞同：1
> 
> 时间：2012-04-16T21:41:46.823
> 
> 标签：java, swing, awt, splash-screen

我目前正在开发一个基本的 java 项目，并且我的应用程序初始启动时间很慢。我想到了做一个应用程序加载器的想法——比如 eclipse 加载器——它加载了一个效果很好的应用程序，经过一些搜索我没有'找不到关于它的东西，但我对使用线程加载它有一个广泛的想法，但我已经迷路了。那么它是怎么做的呢？有没有比线程更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T21:46:03.780

查看 The Java Tutorials - [How to Create a Splash Screen](http://docs.oracle.com/javase/tutorial/uiswing/misc/splashscreen.html)的官方文档。

# java - 回去活动

> ID：10182123
> 
> 赞同：1
> 
> 时间：2012-04-16T21:42:34.343
> 
> 标签：java, android, android-activity

我可以从我的 mainActivity 进入我的 SoundActivity 类，这是一个菜单。但是，当我单击设备后退按钮时，它不会返回到我的 mainActivity，而只会关闭应用程序。我已将完成（）放在最后，但这似乎没有用。我也尝试过 super.backPressed() ，但也没有用。这是声音类的代码

```
import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.media.AudioManager;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.MenuItem;
import android.view.View;
import android.widget.SeekBar;
import android.widget.SeekBar.OnSeekBarChangeListener;
import android.widget.ToggleButton;

 public class SoundActivity extends Activity
    {
MediaPlayer ourSong;

private SeekBar volumeSeekbar = null;
private ToggleButton muteButton = null;
private AudioManager audioManager = null;

private AudioManager mAm;
private boolean mIsMute;
@Override 
protected void onCreate(Bundle savedInstanceState) 
{    
    // TODO Auto-generated method stub     
    super.onCreate(savedInstanceState);
    setVolumeControlStream(AudioManager.STREAM_MUSIC);
    setContentView(R.layout.soundmenu);
    initControls();

    ourSong = MediaPlayer.create(SoundActivity.this, R.raw.beat2);
    ourSong.start();

}

private void initControls()
{
    try
    {
        volumeSeekbar = (SeekBar)findViewById(R.id.sbVolumeBar);
        audioManager = (AudioManager) getSystemService(Context.AUDIO_SERVICE);
        volumeSeekbar.setMax(audioManager
                .getStreamMaxVolume(AudioManager.STREAM_MUSIC));
        volumeSeekbar.setProgress(audioManager
                .getStreamVolume(AudioManager.STREAM_MUSIC));   

        volumeSeekbar.setOnSeekBarChangeListener(new OnSeekBarChangeListener() 
        {
            public void onStopTrackingTouch(SeekBar arg0) 
            {
            }

            public void onStartTrackingTouch(SeekBar arg0) 
            {
            }

            public void onProgressChanged(SeekBar arg0, int progress, boolean arg2) 
            {
                audioManager.setStreamVolume(AudioManager.STREAM_MUSIC,
                        progress, 0);
            }
        });

        muteButton = (ToggleButton)findViewById(R.id.toggleButton1);
        muteButton.setOnClickListener(new View.OnClickListener()
        {

            public void onClick(View v) {
                // TODO Auto-generated method stub
            if(muteButton.isChecked())
            {
                AudioManager am = (AudioManager)getSystemService(Context.AUDIO_SERVICE);
                  am.setStreamMute(AudioManager.STREAM_MUSIC, true);
            }
            else
            {
                AudioManager am = (AudioManager)getSystemService(Context.AUDIO_SERVICE);
                  am.setStreamMute(AudioManager.STREAM_MUSIC, false);
            }
        }
        });
    }
    catch (Exception e) 
    {
        e.printStackTrace();
    }
}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    ourSong.release();
    finish();

    }
} 
```

如果有人可以帮助我，我将不胜感激。此刻一头雾水

好的，这是启动声音活动的 mainActivity

```
import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.media.AudioManager;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.ToggleButton;
import android.os.Bundle;

public class PinballShooterActivity extends Activity {
/** Called when the activity is first created. */
MediaPlayer ourSong;

private ToggleButton muteButton = null;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    ourSong = MediaPlayer.create(PinballShooterActivity.this, R.raw.beat2);
    ourSong.start();

    Button soundBtn = (Button) findViewById(R.id.sound); 
    soundBtn.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) { 
        // TODO Auto-generated method stub             
        startActivity(new Intent(PinballShooterActivity.this, SoundActivity.class));         
        }     
    });  

    Button highScrBtn = (Button) findViewById(R.id.highscores); 
    highScrBtn.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) { 
        // TODO Auto-generated method stub             
        startActivity(new Intent(PinballShooterActivity.this, HighScoreActivity.class));         
        }     
    });

    Button gameBtn = (Button) findViewById(R.id.startgame); 
    gameBtn.setOnClickListener(new View.OnClickListener() {

         public void onClick(View v) { 
        // TODO Auto-generated method stub             
        startActivity(new Intent(PinballShooterActivity.this, GameActivity.class));         
        }     
    });
}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    ourSong.release();
    finish();
    }
} 
```

这是android清单

```
 <uses-sdk android:minSdkVersion="10" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity 
            android:name=".SoundActivity" />
        <activity 
            android:name=".HighScoreActivity" />
        <activity 
            android:name=".GameActivity" 
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="com.pinball.shooter.GAMEACTIVITY" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
            </activity>
        <activity
            android:name=".Splash"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".PinballShooterActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action           android:name="com.pinball.shooter.faiz.PINBALLSHOOTERACTIVITY"/>

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
    </application> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T05:33:53.350

```
@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    ourSong.release();
    finish();
    }
} 
```

你的 onPause() 中有finish()。每次调用 SoundActivity 时，MainActivity 都会进入后台并调用其 onPause()，然后调用 finish() 并完成 Activity。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T08:34:19.993

正如我在上面的评论中指出的那样，问题不在于 SoundActivity，而在于 MainActivity：在启动 SoundActivity 后暂停 MainActivity 时，由于以下原因而`finish()`结束`onPause()`：

```
public class PinballShooterActivity extends Activity {

    ...

    @Override
    protected void onPause() {
        // TODO Auto-generated method stub
        super.onPause();
        ourSong.release();
        finish();
        }
    }

    ...

} 
```

只需删除即可`finish()`解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T05:43:24.380

是的，您可以通过按手机后退按钮在应用程序中的任何位置移动。您只需要使用 onBackPressed() 方法并使用一些代码行，如下所示

```
public void onBackPressed() {

     Intent start = new Intent(Current activity.this,on which activity you want to move .class);
        startActivity(start);
        finishActivity(0);
        } 
```

# objective-c - 为什么设置我的 UINavigationBar 的背景图片会影响导航栏的大小？

> ID：10182127
> 
> 赞同：5
> 
> 时间：2012-04-16T21:43:23.210
> 
> 标签：objective-c, image, user-interface, uinavigationbar

我正在做这样的事情：

```
UIImage *barBackgroundImage = [UIImage imageNamed:@"myImage.png"];
[[UINavigationBar appearance] setBackgroundImage:
                                    backgroundImage
                                   forBarMetrics:UIBarMetricsDefault]; 
```

并且生成的 UINavigationBar 比标准导航栏大得多。我知道我的图像大小可能是问题所在。有没有办法以编程方式处理这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T21:52:32.833

这就是我设置背景图像`UINavigationController`的方式。`navigationBar`

```
[self.navigationController.navigationBar setBackgroundImage:[UIImage imageNamed:@"navbar.png"] forBarMetrics:UIBarMetricsDefault];
[self.navigationController.navigationBar setTintColor:LIGHTBROWN]; 
```

**`navbar.png`**是`320x44`和 分别`640x88`为`navbar@2x.png`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T07:36:12.553

按照此链接使您的代码与 iOS4、5 和 6 兼容：[http ://robert-varga.com/?p=735](http://robert-varga.com/?p=735)

您只需在 Photoshop 或其他软件中制作一个大小为 320x44 或 640x88（用于视网膜显示）的矩形并将其导入您的项目

# objective-c - CFSocketCreateWithNative 后的潜在内存泄漏

> ID：10182128
> 
> 赞同：-1
> 
> 时间：2012-04-16T21:43:24.043
> 
> 标签：objective-c, memory-leaks, cfsocket

这让我发疯！这里有什么问题？

![在此处输入图像描述](../Images/342db90627c250d35230ca889c4db1b3.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T21:48:56.597

不能保证引用没有被另一个线程修改。在创建时将套接字分配给局部变量，修改它，设置属性并释放局部变量：

```
CFSocketRef socket = CFSocketCreateWithNative(...);
if (socket) {
    ...
    self.listeningSocket = socket;
    CFRelease(socket);
} 
```

# iphone - 我可以通过将发布日期设置在批准日期之后，将我提交的 iOS 应用程序保留在暂存区吗？

> ID：10182131
> 
> 赞同：0
> 
> 时间：2012-04-16T21:43:49.027
> 
> 标签：iphone

我听说我可以在提交应用程序时要求将我的应用程序放在暂挂区 - 这意味着，该应用程序将得到审核，但要到晚些时候才能公开（并且该日期在提交时尚未确定，例如，我们可能希望为应用程序计划一些重大的营销活动等）。

真的吗？如果属实，是否会因为缺乏紧迫性而延迟审查？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T21:47:41.200

是的，您可以在提交时给他们一个发布日期。此日期可以随时更改。因此，您可以将其设置为 2013 年，并在您知道时将其更改回正确的日期！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:23:54.343

首次向 iTunes Connect 提交应用程序时，您可以设置未来的发布日期。这将阻止您的应用在获得批准后立即上线。

提交更新时，系统会*询问*您是希望自己发布更新还是在获得批准后立即发布。

我从未见过这以任何方式影响审查过程。我相信（通常）应用程序会按照它们提交的任何顺序进行处理。

请注意，发布日期可以在审核过程*后*随时更改；以及您将应用发布到的国家/地区。

在相反的情况下（您不想延迟您的应用程序发布，而是要加速它），您可以要求“加速应用程序审查”，如果您有正当理由支持您的请求，则可能会获得批准：

[Apple：请求加急 App 审核](https://developer.apple.com/appstore/contact/appreviewteam/index.html)

有人说，将发布日期设置在批准日期之后会影响您在 iTunes Store 上“最新应用程序”列表中的位置。我没有可靠的数据来否认或证实这种情况。

# javascript - HTML5 浏览器验证 - 1 个表单，2 个按钮，需要更改验证

> ID：10182133
> 
> 赞同：1
> 
> 时间：2012-04-16T21:44:00.707
> 
> 标签：javascript, html, validation

我有一个带有两个按钮的表单 - 一个是表单末尾的“提交”按钮，在表单中间我有一个“添加”按钮，该按钮使用 Javascript 在表单中添加隐藏的输入元素，只要它被点击.

这是两个输入字段/添加按钮：

```
<input name="name" required>
<input name="email" required type="email">
<button type="submit">Add</button> 
```

然后是另一组输入字段：

```
<input name="title" required>
<button type="submit">Submit</button> 
```

这些都在一种形式中。

当我单击“添加”（但不是“标题”字段）时，我希望 HTML5 浏览器验证在“名称”和“电子邮件”字段上触发，并且浏览器验证在“标题”字段上触发（但不是“名称” ”和“输入”字段）当我单击“提交”时。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-26T12:19:34.883

您可以向您需要的字段添加或删除属性“必需”

```
 $('#field_id').attr('required','true');
                $('#field_id').removeAttr('required'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:21:30.293

我看到的唯一方法是`required`在单击时动态设置属性（或：属性）。

或者您可以添加和删除事件侦听器`invalid`，这似乎抑制了本机的“丢失”/“错误格式”通知——即使它们什么都不做（比如 preventDefaultAction 左右）。

我还尝试了带有`formnovalidate`属性的按钮并`checkValidity()`在所选元素上手动操作，但即使触发“无效”事件，也不会显示本机对话并且不会取消提交。（用歌剧测试了一切）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T02:03:55.977

您是否有任何特别的原因要首先使用 HTML5 来验证您的表单？我觉得您需要使用 Javascript 轻松完成，并且您注意到您的添加按钮无论如何都将使用 javascript。另外，为什么您的表单验证会以这种奇怪的方式进行分区？

我什至不喜欢 HTML5 验证。例如，如果您在 HTML5 电子邮件输入中键入“asdf@1”，它将接受它。现在，您可以说这在技术上是一个有效的电子邮件地址，但我认为实际上大多数人会同意他们不会接受它作为一个有效的电子邮件地址。您可以使用 IP 地址代替域，但我非常怀疑您是否可以将其用作电子邮件来登录任何现代网页。

但我离题了。要回答您的问题，您可以使用 JQuery 编写一个快速函数，该函数将根据单击的按钮覆盖表单验证。您可以通过捕获针对特定输入的 HTML5 验证引发的“无效”错误并返回 false 来绕过它。因此，当您单击提交时，您可以覆盖名称和电子邮件表单验证，反之亦然，当您单击添加按钮时。同样，我不知道您为什么要这样做，但这是一个解决方案。

# android - Android Holo 主题在模拟器中不起作用

> ID：10182134
> 
> 赞同：0
> 
> 时间：2012-04-16T21:44:03.863
> 
> 标签：android, themes, android-4.0-ice-cream-sandwich

我在/res/values-v11 中添加了一个themes.xml，并确保在那里定义的主题扩展了“@android:style/Theme.Holo.Light”或“@android:style/Theme.Holo”。在 Galaxy Nexus 上运行我的应用程序时，一切看起来都很好。

在 Android 4.0 或 4.0.3 的模拟器上运行时，新的 Holo-Theme 似乎没有生效；不显示 ActionBar 按钮等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T21:45:21.617

事实证明它有效，“问题”是模拟器默认配置为具有硬件按钮。因此将不会显示 ActionBar 溢出图标。相反，菜单项只会在按下菜单按钮时显示。

要预览在没有按钮的电话上会是什么样子，您必须创建一个 AVD 并将属性“硬件返回/主页键”设置为 false。编辑现有的 AVD 并不能实现这一点（令人困惑）。

另一个问题是旧工具。确保使用最新的模拟器系统映像和 sdk 工具/插件。重新创建avd，你应该没问题。（在这之间，我的主题在 ics 模拟器中根本不起作用，它只是没有选择全息主题）

# wcf - 使用 WCF 和 JSONP 的 Kendo Grid 插入记录

> ID：10182136
> 
> 赞同：1
> 
> 时间：2012-04-16T21:44:07.703
> 
> 标签：wcf, jsonp, kendo-ui

我有一个 WCF 服务，我在 jsonp 上配置它

我的模型是 MoviesItem

```
[DataContract]
public class MoviesItem
{
    [DataMember]
    public int MovieID { get; set; }
    [DataMember]
    public string MovieTitle { get; set; }
    [DataMember]
    public DateTime MovieReleseDate { get; set; }
} 
```

我的服务合同是 IMovieService

```
[ServiceContract]
public interface IMoviesService
{
    [WebGet( BodyStyle = WebMessageBodyStyle.Bare ,RequestFormat = WebMessageFormat.Json, ResponseFormat = WebMessageFormat.Json)]
    [OperationContract]
    IEnumerable<MoviesItem> GetMovies();

    [WebInvoke(Method = "POST",BodyStyle = WebMessageBodyStyle.Bare, RequestFormat = WebMessageFormat.Json, ResponseFormat = WebMessageFormat.Json)]
    [OperationContract]
    void AddMovies(MoviesItem movies);

} 
```

我的服务叫做 MoviesService

```
[AspNetCompatibilityRequirements(RequirementsMode =
    AspNetCompatibilityRequirementsMode.Allowed)]
public class MoviesService : IMoviesService
{

    public IEnumerable<MoviesItem> GetMovies()
    {
        using (var context = new MovieCollectionDataContext())
        {
            return context.Movies.Select(e => new MoviesItem()
            {
                MovieID = e.ID,
                MovieTitle = e.Title,
                MovieReleseDate = e.ReleaseDate

            }).Take(100).ToList();
        }
    }

    public void AddMovies(MoviesItem movies)
    {
        using (var context = new MovieCollectionDataContext())
        {

            var movie = new Movie()
            {
                Title = movies.MovieTitle,
                ReleaseDate = DateTime.Now
            };
            context.Movies.InsertOnSubmit(movie);
            context.SubmitChanges();

            //return context.Movies.Select(e => new MoviesItem()
            //{
            //    MovieID = e.ID,
            //    MovieTitle = e.Title,
            //    MovieReleseDate = e.ReleaseDate

            //}).Take(100).ToList();

        }
    }
} 
```

我的 Web.config 文件是：

```
<?xml version="1.0"?>
<configuration>
  <connectionStrings>
    <add name="moviereviewsConnectionString" connectionString="Data Source=Haseeb-PC;Initial Catalog=moviereviews;Integrated Security=True"
      providerName="System.Data.SqlClient" />
  </connectionStrings>
  <system.web>
    <compilation debug="false" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Data.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
      </assemblies>
    </compilation>
  </system.web>
  <system.serviceModel>
    <bindings>
      <webHttpBinding>
        <binding name="WebHttpBindingWithJsonP" crossDomainScriptAccessEnabled="true"/>
      </webHttpBinding>
    </bindings>
    <behaviors>
      <endpointBehaviors>
        <behavior name="webHttpBehavior">
          <webHttp helpEnabled="true"/>
        </behavior>
      </endpointBehaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true"/>
    <services>
      <service  name="MoviesService">
        <endpoint address="" behaviorConfiguration="webHttpBehavior"
                  binding="webHttpBinding" bindingConfiguration="WebHttpBindingWithJsonP" contract="IMoviesService"/>
      </service>
    </services>
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
</configuration> 
```

最后我的javascript代码代码用于绑定Kendo Grid

```
$(function () {
    BindGridWithKendoDataSource();
});

function BindGridWithKendoDataSource() {
    var dataSource1 = new kendo.data.DataSource(
        {
            transport:
                {
                    read:
                        {
                            url: "MoviesService.svc/GetMovies",
                            dataType: "jsonp",
                            //contentType:"application/javascript",
                            type: "GET"

                        },
                    create:
                        {
                            url: "MoviesService.svc/AddMovies",
                            dataType: "jsonp",
                            contentType: "application/javascript",
                            type: "POST"
                        }
                },
            parameterMap: function (data, operation) {
                if (operation !== "read") {
                    return JSON.stringify({ movies: data.models });
                }
            },
            batch: true,
            pageSize: 10,
            schema:
                {
                    //data: "d",
                    model:
                        {
                            id: "MovieID",
                            fields:
                                {
                                    MovieID: { editable: false, nullable: true },
                                    MovieTitle: { validation: { required: true} }
                                    // MovieReleaseDate: {type:"date", editable: true, validation: { required: true} }
                                }
                        }
                }
        });
    $("#MoviesGridView").kendoGrid(
        {
            dataSource: dataSource1,
            pageable: true,
            sortable: true,
            filterable: true,
            scrollable: true,
            height: 400,
            toolbar: ["create", "save", "cancel"],
            editable: "popup",
            columns:
               [
                   { field: "MovieTitle", title: "Movie Title" },
            //{ field: "MovieReleaseDate", title: "Release Date" },
                   {command: ["edit", "destroy"], title: "&nbsp;", width: "210px" }
                   ]

        });
} 
```

我的剑道网格已从 WCF 以 jsonp 格式返回的数据成功绑定，但是当我单击尝试使用剑道网格在数据库中插入记录时，我总是收到错误消息：

```
"NetworkError: 400 Bad Request - http://localhost:2382/KendoUiTest/MoviesService.svc/AddMovies?callback=jQuery17102623996303075524_1334611809600" 
```

请有人帮我解决这个问题，我如何使用 WCF 插入记录。我做错了什么我无法理解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T19:58:48.017

我已经发布了我想出的解决方案

JSONP 不接受 POST 请求，解决的主要问题是像这样正确地创建函数和参数映射函数

```
var dataSource1 = new kendo.data.DataSource(
        {
            transport:
                {
                    read:
                        {
                            url: "MoviesService.svc/GetMovies",
                            dataType: "jsonp",

                            },
                    create:
                        {
                            url: "MoviesService.svc/AddMovies",
                            dataType: "jsonp",
                                                        },
parameterMap: function (data, operation) {
                    if (operation != "read") {
                        return { jsonData: kendo.stringify(data.models) };
                    }
                }
                },

            }, and so on ............ 
```

现在像这样改变合同和服务功能

IMovieService

```
[WebGet(ResponseFormat = WebMessageFormat.Json)]
    [OperationContract]
    void AddMovies(string jsonData); 
```

现在 MoviesService 类将具有上述功能实现

```
public IEnumerable<MoviesItem> AddMovies(string jsonData)
    {
        using (var context = new MovieCollectionDataContext())
        {

            var movies = JArray.Parse(jsonData);
            foreach (var item in movies)
            {
                var movie = new Movie()
                {
                    Title = item["MovieTitle"].ToString(),
                    ReleaseDate = DateTime.Parse(item["MovieReleseDate"].ToString())
                };
                context.Movies.InsertOnSubmit(movie);
                context.SubmitChanges();
            }

            return context.Movies.Select(e => new MoviesItem()
            {
                MovieID = e.ID,
                MovieTitle = e.Title,
                MovieReleseDate = e.ReleaseDate

            }).Take(50).ToList();

        }
    } 
```

现在享受带有 JSONP 和 Kendo 的 WCF........ 太棒了

# ios5 - 使用核心动画闪烁 UILabel 问题

> ID：10182137
> 
> 赞同：3
> 
> 时间：2012-04-16T21:44:10.243
> 
> 标签：ios5, label

我想要一个使用核心动画闪烁的文本。我已经输入了以下代码，但我没有看到文本，也没有看到它闪烁。

```
// Create a blinking text
UILabel* labelText = [[UILabel alloc] initWithFrame:CGRectMake(355, 490, 400, 50)];
labelText.text = @"Tap to start";
labelText.backgroundColor = [UIColor clearColor];
[self.view addSubview:labelText];

void (^animationLabel) (void) = ^{
        labelText.alpha = 1;
};
void (^completionLabel) (BOOL) = ^(BOOL f) {
        labelText.alpha = 0;
};

NSUInteger opts =  UIViewAnimationOptionAutoreverse | UIViewAnimationOptionRepeat;
[UIView animateWithDuration:1.f delay:0 options:opts
                     animations:animationLabel completion:completionLabel]; 
```

任何的想法？我真的看不出我的方法有什么问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T07:54:26.533

有点愚蠢的错误，但将来很高兴知道 - 代码应该是

```
void (^animationLabel) (void) = ^{
        labelText.alpha = 0;
    };
    void (^completionLabel) (BOOL) = ^(BOOL f) {
        labelText.alpha = 1;
    }; 
```

由于 alpha 必须设置为 0，它应该是动画块的一部分，而不是完成块的一部分。

# ms-access - 清除新记录上的复选框，MS Access

> ID：10182139
> 
> 赞同：0
> 
> 时间：2012-04-16T21:44:15.777
> 
> 标签：ms-access, vba, checkbox

我在 MS Access 中自学 VBA。我想在创建新记录时清除一个复选框。换句话说，如果记录是新的，我希望复选框恢复为未选中状态。

我试过：

```
If Me.NewRecord = True Then
  Me.checkbox = False 
```

但这似乎不起作用。

有什么建议么？

谢谢，迈克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:10:09.807

在 Access 表单上使用正确的事件非常重要，在 Access 报告中更是如此。在这种情况下，当前事件似乎是合适的。

您可能想查看[http://office.microsoft.com/en-us/access-help/order-of-events-for-database-objects-HP005186761.aspx](http://office.microsoft.com/en-us/access-help/order-of-events-for-database-objects-HP005186761.aspx)

# c# - 如何正确处理/调试 HttpExceptions？

> ID：10182140
> 
> 赞同：0
> 
> 时间：2012-04-16T21:44:18.307
> 
> 标签：c#, asp.net

所以我最近在尝试通过 iis7 查看我一直在处理的网站时收到了这个 httpexeption。错误如下：

> 说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.Web.HttpException：无法修改 Controls 集合，因为该控件包含代码块（即 <% ... %>）。
> 
> 源错误：
> 
> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
> 
> 堆栈跟踪：
> 
> [HttpException (0x80004005)：无法修改 Controls 集合，因为控件包含代码块（即 <% ... %>）。]
> System.Web.UI.ControlCollection.AddAt(Int32 index, Control child) +8689794 Telerik。 Web.UI.RadAjaxControl.MoveUpdatePanel（控件发起者，控件更新）+132
> 
> [HttpException（0x80004005）：请查看是否在 RadCodeBlock 中包装代码块，生成异常，解决错误。] Telerik.Web.UI.RadAjaxControl.MoveUpdatePanel（控制发起者，控制更新）+180
> Telerik.Web.UI。 RadAjaxControl.PerformRender() +375
> Telerik.Web.UI.RadAjaxControl.OnPageRender(HtmlTextWriter writer, Control page) +1222
> Telerik.Web.UI.RadAjaxControl.RenderPageInAjaxMode(HtmlTextWriter writer, Control page) +95
> System.Web.UI.Control .RenderChildrenInternal(HtmlTextWriter writer, ICollection children) +256
> System.Web.UI.Control.RenderChildren(HtmlTextWriter writer) +19
> System.Web.UI.Page.Render(HtmlTextWriter writer) +29
> System.Web.UI.Adapters.ControlAdapter.Render(HtmlTextWriter writer) +21 System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter) +8703529
> System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter ) +99
> System.Web.UI.Control.RenderControl(HtmlTextWriter writer) +25
> System.Web.UI.Page.ProcessRequestMain(布尔 includeStagesBeforeAsyncPoint，布尔 includeStagesAfterAsyncPoint) +1266

在对这个问题进行研究时，我似乎找到的唯一可行的解​​决方案是将 javascript 包装在 radcodeblock 中或使用`<span runat="server">`. 这两种方法我都试过了，似乎都不管用。我也有点困惑，为什么我会收到这个错误，因为据我所知，这个网站的前一个开发人员实现的任何 javascript 都不包含任何项目`<%...%>`。

此外，我已经继续检查了我页面中的所有控件，以确保它所抱怨的上述情况实际上没有发生。换句话说，据我所知，`<%...%>`除了页面声明之外，代码中没有其他地方正在使用。IE：

```
 <%@ Page Language="C#" AutoEventWireup="true" CodeBehind="LoginPage.aspx.cs" Inherits="Datamart.UI.Reporting.Web.LoginPage" culture="auto" meta:resourcekey="PageResource1" uiculture="auto" ValidateRequest="False" %>
<%@ Register Assembly="Telerik.Web.UI" Namespace="Telerik.Web.UI" TagPrefix="telerik" %> 
```

所以我想知道我可能做错了什么，或者下一步要找出我的问题在哪里以及到底是什么。我认为发生错误的位置如下：

```
<telerik:RadScriptBlock ID="RadScriptBlock1" runat="server">  
            <script type="text/javascript">
            function onTabSelecting(sender, args) 
            {
                if ( args.get_tab().get_pageView()) 
                {
                    if (args.get_tab().get_pageView().get_id()) 
                    {
                        args.get_tab().set_postBack( false );
                    }
                }
            }
            function StopPropagation(e) 
            {
                //cancel bubbling 
                e.cancelBubble = true;
                if (e.stopPropagation)
                    e.stopPropagation();
            }

            //the following code use radconfirm to mimic the blocking of the execution thread.
            //The approach has the following limitations:
            //1\. It works inly for elements that have *click* method, e.g. links and buttons
            //2\. It cannot be used in if(!confirm) checks
            window.blockConfirm = function(text, mozEvent, oWidth, oHeight, callerObj1, oTitle) 
            {
                var ev = mozEvent ? mozEvent : window.event; //Moz support requires passing the event argument manually 
                //Cancel the event 
                ev.cancelBubble = true;
                ev.returnValue = false;
                if (ev.stopPropagation) 
                    ev.stopPropagation();
                if (ev.preventDefault) 
                    ev.preventDefault();

                //Determine who is the caller 
                var callerObj = ev.srcElement ? ev.srcElement : ev.target;

                //Call the original radconfirm and pass it all necessary parameters
                if (callerObj) 
                {
                    //Show the confirm, then when it is closing, if returned value was true, automatically call the caller's click method again.
                    var callBackFn = function(arg) 
                    {
                        if (arg) 
                        {
                            callerObj["onclick"] = "";
                            if (callerObj.click) callerObj.click(); //Works fine every time in IE, but does not work for links in Moz 
                            else if (callerObj.tagName == "A") //We assume it is a link button! 
                            {
                                try 
                                {
                                    eval(callerObj.href)
                                }
                                catch (e) { }
                            }
                        }
                    }

                    radconfirm(text, callBackFn, oWidth, oHeight, callerObj, oTitle);
                }
                return false;
            }
            function noBack() 
            {
                window.history.forward(); 
            }
            noBack();
            window.onload = noBack;
            window.onpageshow = function(evt) 
            {
                if (evt.persisted) noBack(); 
            }
            window.onunload = function() 
            {
                void (0);
            }
            </script>          
        </telerik:RadScriptBlock> 
```

这可以在我的页面正文中找到，但我尝试将其移至页面底部以及页眉，因为发现这对其他人来说是一种可能的解决方案，但无济于事。

非常感谢任何帮助或建议。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:33:32.687

听起来，由于错误，某处后面的代码正在寻找动态向页面添加控件，并且正在添加的控件上有动态内容。我会搜索执行类似操作的代码

```
Controls.Add( 
```

看看注释掉那行是否有用。这也可能是 Telerik 软件中的一个错误，因此您可以尝试在他们的论坛上发帖或通过电子邮件向他们的支持发送电子邮件，看看这个问题是否已经出现。

# html - 菜单大小和位置

> ID：10182142
> 
> 赞同：0
> 
> 时间：2012-04-16T21:44:49.360
> 
> 标签：html, css, menu

每次我打开 html 时，菜单的位置和大小都是不同的。你能帮我修一下吗？它应该在中心。谢谢你的帮助。

```
div.menu { 
    list-style:none; 
    margin:0; 
    padding:0; 
    width:100%;
    text-align:center;} 
div.menu ul{ 
    font-family: Verdana; 
    font-size:14px; 
    margin:20px; 
    padding:0;
    display:inline-block;} 
div.menu li{ 
    display:inline; } 
div.menu li a{ 
    text-decoration:none; 
    padding:5px 0; 
    width:100px; 
    background:#FBB117; 
    color:#4C4646; 
    float:left; 
    text-align:center; 
    border-left:1px solid #fff; }  
div.menu li a:hover{ 
    background:#a2b3a1; 
    color:#000 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T21:53:15.920

您可以使用边距标签使元素居中。但是，对于这项工作，您必须声明宽度，`div.menu ul`否则它将继承其父元素的宽度，`div.menu`. 所以：

```
div.menu ul{ 
    font-family: Verdana; 
    font-size:14px; 
    margin-left: auto;
    margin-right: auto;
    margin-top: 20px;
    margin-bottom: 20px;
    width: 100px; <!-- SPECIFY WIDTH -->
} 
```

# java - 在java中生成一个没有重复的随机点数组

> ID：10182145
> 
> 赞同：1
> 
> 时间：2012-04-16T21:45:03.257
> 
> 标签：java, random

我对Java相当陌生，我想生成一个长度为“数字”的随机（x，y）坐标数组，其中不包含重复项。x 或 y 值可以重复，但不能有重复的 (x,y) 坐标。输出不必是点，只是一些保存坐标的 x,y 值的方式。

我可以生成一个随机点数组，并尝试使用 Set 来确保没有重复值，但遇到了问题。我尝试使用条件“while (set.size)”和不允许重复的“add”方法来创建包含唯一点的正确大小的输出。

这是代码：

```
Set<Point> set = new HashSet<Point>();
Random position = new Random();
Point test=new Point();

do{
    test.x=position.nextInt(xx);
    test.y=position.nextInt(yy);   
    //xx and yy are the random number limits called from another part of the code
    set.add(test);     
}
while (set.size()<number);

List<Object> list = new ArrayList<Object>(set);
Object[] coord = list.toArray(); 
```

这会输出一个长度正确的数组，但每个元素都是相同的。任何人都可以提供任何帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T21:49:09.740

每次循环时，测试都指向空间中的相同变量，以修复在循环内创建一个新实例的问题——而不仅仅是在它之前一次：

```
Set<Point> set = new HashSet<Point>();
Random position = new Random();
Point test;

do{
    test = new Point();
    test.x=position.nextInt(xx);
    test.y=position.nextInt(yy);   
    //xx and yy are the random number limits called from another part of the code
    set.add(test);     
}
while (set.size()<number);

List<Object> list = new ArrayList<Object>(set);
Object[] coord = list.toArray(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T21:49:01.470

您正在修改同一个点对象。但是，由于您每次都更改 X 和 Y，因此您也会更改哈希码和点的相等性，因此您最终会在集合中多次放置相同的对象。有趣的案例。

尝试

```
do{
   test = new Point();
   test.x=position.nextInt(xx);
   test.y=position.nextInt(yy);   
   //xx and yy are the random number limits called from another part of the code
   set.add(test);     
}
while (set.size()<number); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-22T11:19:41.373

值选择随机但不重复

```
 Random rndm = new Random();
    String[] selectedNumber = new String[15];
    String[] sequanceNumber = {"1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"};

    //*****FIRST LOOP START*****//
    for(byte a = 0; a < 15;){

        int temp = rndm.nextInt(15)+1;

        //*****SECOND LOOP START*****//
        for(byte b = 0; b < 15; b++){

            String s4 = temp+"";

            //*****CHECKING CONDITION START*****//
            if(s4.equals(sequanceNumber[b]) ){

                selectedNumber[a] = s4;

                String s1 = sequanceNumber[b];
                s1 = s1.replace(s1, " ");
                sequanceNumber[b] = s1;

                a++;

            }
            //*****CHECKING CONDITION END*****//
        }
        //*****SECOND LOOP END*****//
    }
    //*****FIRST LOOP END*****//

    //*****PRINT ALL RANDOM VALUES BUT NOT REPEATED VALUES*****//
    System.out.println(Arrays.toString(selectedNumber)); 
```

# python - 自定义 Select 的源图像管理模板

> ID：10182149
> 
> 赞同：0
> 
> 时间：2012-04-16T21:45:19.640
> 
> 标签：python, django

我有这个模型：

```
class Clients(models.Model):
    name = models.CharField(max_length=150)
    user = models.ForeignKey(auth.models.User)
    def __unicode__(self):
        return self.name 
```

当我在 Admin Template 中运行此模型时，会显示一个组件和一个带有添加新*User*链接的图像。我想知道如何更改图像的链接来源。默认值为

```
/static/admin/img/admin/icon_addlink.gif 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T21:52:21.727

您需要覆盖添加客户表单的模板。 [https://docs.djangoproject.com/en/dev/ref/contrib/admin/#custom-template-options](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#custom-template-options)是您正在寻找的，尽管我会说当您升级到django 的更高版本。

# scala - Scala中的'yield'是否等同于map函数？

> ID：10182152
> 
> 赞同：7
> 
> 时间：2012-04-16T21:45:27.620
> 
> 标签：scala, haskell, map, erlang, yield

我开始学习 Scala 编程语言。我对 Erlang 和 Haskell 等 FP 语言有所了解，但我对 for/yield 表达式的含义有疑问，例如：

```
for (arg <- args) yield arg.length 
```

这将收集具有任何输入参数长度的数组。据我了解，这似乎是普通 FP 编程中的 map 函数：

```
map (\a -> a * 2) [1, 2, 3] (in Haskell) 
```

我知道 Scala 库包含 scala.collection.map 方法，所以我想知道：使用这两种风格是否有任何区别或限制，或者它们完全相同？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-16T22:03:00.563

`for ... yield`Scala 中的理解由编译器翻译为`map`,`flatMap`和`withFilter`方法调用。`for`without`yield`将被转换为`foreach`方法调用。您可以在此处找到一些示例和更多信息：

[http://tataryn.net/2011/10/whats-in-a-scala-for-comprehension/](http://tataryn.net/2011/10/whats-in-a-scala-for-comprehension/)

和这里

[http://adamwojtuniak.wordpress.com/2010/09/24/scala-for-comprehensions/](http://adamwojtuniak.wordpress.com/2010/09/24/scala-for-comprehensions/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-16T21:56:35.133

Scala 的`for`/`yield`表达式完全等同于 Haskell 中的列表/单子推导式，并且具有完全相同的功能，只要您坚持每个`for`表达式的一种类型。（不过，我不了解 Erlang。）

特别是，您的示例完全转换为`[length arg | arg <- args]`，将 Scala 方法调用`x.f`转换为 Haskell 函数应用程序`f x`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-16T22:02:00.017

for-yield 被编译成映射 - 它在 Programming in Scala 书中。

# javascript - 请帮我找bug

> ID：10182157
> 
> 赞同：-3
> 
> 时间：2012-04-16T21:46:02.250
> 
> 标签：javascript, backbone.js, coffeescript

这两张图的解释 ![图 1](../Images/29708cadb36d58fc059e83a65442d746.png) ![图 2](../Images/796d64c6d03212511514e36652293d3c.png)

## 编码

```
showUserProfile: (user_data)->
    console.log "Routers.AppRouter showUserProfile()", user_data
    window.user_profile = user_data

    playlists_both_people = user_profile['playlists']

    my_profile['playlists'].forEach (pl)-> playlists_both_people.push(pl)

    @playlists = new Playlists.Collections.PlaylistsCollection( playlists_both_people )

    $("#app").html( new Playlists.Views.User.ShowView(user_data).render().el )
    @ok() 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-16T22:04:33.757

既然每个人都打完了你，我会很好地告诉你你做错了什么。

你有一个简单的引用问题。您从`user_data`传递给您的函数的对象开始。然后，您再次参考`user_data`此处的要点：

```
window.user_profile = user_data 
```

现在您的数据如下所示：

```
window.user_profile ->-+
                       |
                       +->- {playlists: [ ], ...}
                       |
user_data ----------->-+ 
```

然后你在这里做另一个参考`user_data.playlists`：

```
playlists_both_people = user_profile['playlists'] 
```

现在你手上有这个：

```
window.user_profile ->-+
                       |
                       +->- {playlists: [ ], ...}
                       |      ^
user_data ----------->-+      |
                              |
playlists_both_people --->----+ 
```

然后你把一堆东西推到`playlists_both_people`数组上，想知道为什么它`user_data.playlists`也会改变。该图告诉您原因：您从未复制任何内容，您只是通过多个变量引用同一条数据。

你正在使用 Backbone，所以你有下划线，也许[`_.clone`](http://underscorejs.org/#clone)可以帮助你：

```
playlists_both_people = _(user_profile['playlists']).clone() 
```

这将为您提供（与此时相同）的（浅）副本，并且`user_profile.playlists`下一个不会更改.`user_data.playlists``playlists_both_people``forEach``user_data`

请注意，您仍然可能对`window.user_profile`. 你不能只用一个`_.clone`来解决这个可能的问题，你必须分别克隆每个成员，因为`_.clone`只做浅拷贝。但是，您可能拥有 jQuery 并[`$.extend`](http://api.jquery.com/jQuery.extend/)支持深度复制，因此这可能是一种选择。

我还建议不要将东西直接放入`window`. 您最好为您的应用程序设置一个命名空间，例如`window.app`，然后使用该命名空间：

```
window.app.user_profile = ... 
```

# java - 从 JVM 中检索 Tenured Generation 内存池

> ID：10182158
> 
> 赞同：1
> 
> 时间：2012-04-16T21:46:03.550
> 
> 标签：java, memory-management, jvm, memory-pool

我正在寻找一种在 JVM 中找到 Tunered Generation 池的方法，之前我尝试按名称查找此池：“Tunered Gen”，但在某些情况下，该池名为“PS Old Gen”。所以我想到了更通用的方法来找到存储所有旧对象的池。

你怎么看？也许有人可以提出另一种解决方案？

```
 public MemoryPoolMXBean findTuneredGenerationMemoryPool(){

        List<MemoryPoolMXBean> memoryPoolsList = new ArrayList<MemoryPoolMXBean>();
        for(MemoryPoolMXBean pool: ManagementFactory.getMemoryPoolMXBeans()){
            if (pool.isCollectionUsageThresholdSupported() && pool.getType().equals( MemoryType.HEAP )){
                memoryPoolsList.add( pool );
            }
        }

        Collections.sort(memoryPoolsList, new Comparator<MemoryPoolMXBean>(){
            @Override
            public int compare(MemoryPoolMXBean pool, MemoryPoolMXBean otherPool) {

                return otherPool.getType().compareTo( pool.getType() );
            }});

        int oldestGenPoolIndex = memoryPoolsList.size() - 1;
        return memoryPoolsList.get( oldestGenPoolIndex );
    } 
```

问候， 马克西姆

# installation - 如何发布我的 C++ 应用程序？

> ID：10182167
> 
> 赞同：1
> 
> 时间：2012-04-16T21:46:39.250
> 
> 标签：installation, publish, solution

我使用 Visual Studio 2010 用 C++ 制作了一个游戏。对于这个游戏，我使用了 OpenGL 和 GLUT、IrrKlang、ODE 和 fltk（所以有很多库和 dll）。我还有一个声音文件夹和一些文本文件。所有路径都是相对的，我的应用程序在环境中运行良好（调试和发布模式）。exe文件虽然不起作用。

如何为我的应用程序制作安装工具包？我的解决方案包括两个项目。

我以前用 XNA 项目做过这个，但现在完全不同了。请不要将我推荐给 msdn，因为我去过那里。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T12:01:39.697

首先，您应该决定一个设置创作工具。这是一个可以帮助您入门的列表：[http ://en.wikipedia.org/wiki/List_of_installation_software](http://en.wikipedia.org/wiki/List_of_installation_software)

之后，尝试使用该工具创建安装程序。他们中的大多数都有可能有所帮助的教程和文档。如果遇到问题，您可以提出更具体的问题。

# java - 从 HashMap 获取数据到 SQLite 数据库

> ID：10182168
> 
> 赞同：0
> 
> 时间：2012-04-16T21:46:40.010
> 
> 标签：java, android, sqlite

在我的应用程序中，我正在从服务器检索记录。记录在一个 xml 文件中。我能够毫无问题地获取文件并解析它。我将结果存储在 HashMap 中，我希望能够将这些结果放入我的应用程序的 SQLite 数据库中。

这是HashMap的代码

```
 ArrayList<HashMap<String, String>> StudentDownloads = new ArrayList<HashMap<String, String>>();

        String xml = XMLfunctions.getXML(target);

        Document doc = XMLfunctions.XMLfromString(xml);
        if(XMLfunctions.XMLfromString(xml)==null){
            Toast.makeText(this, "Badly Formed File", Toast.LENGTH_LONG).show();  
            finish();
        }          

        int numResults = XMLfunctions.numResults(doc);
        if((numResults <= 0)){
            Toast.makeText(this, "There Were No Student Results To Show", Toast.LENGTH_LONG).show();  
            finish();
        }

        NodeList nodes = doc.getElementsByTagName("Students");

        for (int i = 0; i < nodes.getLength(); i++) {                           
            HashMap<String, String> map = new HashMap<String, String>();    

            Element e = (Element)nodes.item(i);
            map.put("Student Id", "Student Id " + XMLfunctions.getValue(e, "StudentId"));
            map.put("Student Type", "Student Type" + XMLfunctions.getValue(e, "StudentType"));
            map.put("Student Location", "Student Location" + XMLfunctions.getValue(e, "StudentLocation"));
            map.put("Student Mother", "Student Mother" + XMLfunctions.getValue(e, "StudentMother"));
            StudentDownloads.add(map);}         
        }; 
```

现在在我的应用程序中，我已经创建了一个使用名为 StudentRecord 的类的数据输入表单，在我的输入表单中，我使用此函数来更新文件

```
 private void addStudent(StudentRecord newRecord){
             mDB.beginTransaction();
             try {

                    ContentValues StudentRecordToAdd = new ContentValues();
                    StudentRecordToAdd.put(Students.STUDENT_ID, newRecord.getStudentName());
                    StudentRecordToAdd.put(Student.STUDENT_TYPE, newRecord.getStudentType());
                    StudentRecordToAdd.put(Student.STUDENT_LOCATION, newRecord.getStudentLocation());
                    StudentRecordToAdd.put(Student.STUDENT_MOTHER, newRecord.getStudentMother());
                    mDB.insert(Student.STUDENT_TABLE_NAME,Student.STUDENT_ANIMALID, StudentRecordToAdd);
                    mDB.setTransactionSuccessful();
                    Toast.makeText(this,"Recorded Added ",0).show();
             } finally {
                 mDB.endTransaction();
             } 
```

将我的值从 HashMap 获取到我的 NewRecord 函数的最佳方法是什么？我看了这么久，我想我已经脑死了。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:10:57.977

如果我没看错，听起来您需要将 addStudent 函数从它现在所在的表单/活动移到某种“帮助”类中：

```
private class dbHelper {
  Database mDB; // set this up however you are doing it already

  private void addStudent(StudentRecord newRecord){
    mDB.beginTransaction();
    try {
      ContentValues StudentRecordToAdd = new ContentValues();
      StudentRecordToAdd.put(Students.STUDENT_ID, newRecord.getStudentName());
      StudentRecordToAdd.put(Student.STUDENT_TYPE, newRecord.getStudentType());
      StudentRecordToAdd.put(Student.STUDENT_LOCATION, newRecord.getStudentLocation());
      StudentRecordToAdd.put(Student.STUDENT_MOTHER, newRecord.getStudentMother());
      mDB.insert(Student.STUDENT_TABLE_NAME,Student.STUDENT_ANIMALID, StudentRecordToAdd);
      mDB.setTransactionSuccessful();
      Toast.makeText(this,"Recorded Added ",0).show();
    } finally {
      mDB.endTransaction();
    }
  }
} 
```

然后在解析 XML 时调用该助手

```
ArrayList<StudentRecord> StudentDownloads = new ArrayList<StudentRecord>();

for (int i = 0; i < nodes.getLength(); i++) {                           
  Element e = (Element)nodes.item(i);
  int id = Integer.valueOf(XMLfunctions.getValue(e, "StudentId")));
  int type = Integer.valueOf(XMLfunctions.getValue(e, "StudentType")));
  String location = XMLfunctions.getValue(e, "StudentLocation"));
  String mother = XMLfunctions.getValue(e, "StudentMother"));

  StudentRecord newRecord = new StudentRecord(id, type, location, mother);

  StudentDownloads.add(newRecord);
} 
```

然后当你完成处理时：

```
for (StudentRecord s : StudentDownloads) {
  mDBHelper.addStudent(s);
} 
```

# java - Java JMenu - 选择和取消选择功能

> ID：10182169
> 
> 赞同：5
> 
> 时间：2012-04-16T21:46:53.143
> 
> 标签：java, swing, selected, jmenu

我插入了一个没有任何 JMenuItem 的 JMenu（实例名为：exitMenu），所以我的目的是提供一种方法来退出程序而无需访问不必要的菜单项，因为我的程序只有一个 JMenu 对象（有人可能会说：WTF！ ！！ 但...）。

因此，为了捕获在这个特定的 JMenu 组件中发生的事件，我的类实现了 MenuListener 接口。众所周知，强制实现方法有三种，虽然我只需要使用一种，menuSelected() 方法。

毫无疑问，为了让我的程序更直观一点，一旦用户选择了 exitMenu，(in) 著名的弹出窗口 JOptionPane.showConfirmDialog() 就会出现在他/她需要在“是”或“否”选项之间进行选择的地方。

如果选择的选项是 YES，则完全没有问题，因为程序是通过 System.exit(0) 完成的。问题是 NO 选项，当焦点返回程序时，exitMenu 仍然处于选中状态，当然，因为我之前已经选择了。我想做的“事情”是在选择 NO 选项后立即删除对象选择，这样用户就可以再次单击它。

即使在三个强制方法（一个调用另一个）中使用 exitMenu.setSelected(false)，虽然 exitMenu 组件已“取消选择”，但仍需要单击它两次才能调用其事件侦听器。

有什么建议吗？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T21:58:20.427

我尝试的一件事是简单地`setSelected(false)`从 menuSelected(...) 方法中调用，但这有副作用。一方面，菜单似乎没有被选中，另一方面，它并不总是有效。

一种可行的解决方案是取消选择 Swing Timer 中的菜单。就像是：

```
 @Override
     public void menuSelected(MenuEvent mEvt) {
        // show JOptionPane
        // if yes selected, exit. 

        // Otherwise...
        final JMenu menu = (JMenu) mEvt.getSource();
        new Timer(200, new ActionListener() {

           @Override
           public void actionPerformed(ActionEvent e) {
              menu.setSelected(false);
              ((Timer)e.getSource()).stop();
           }
        }).start();
     } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T06:54:25.720

有两个级别，对于

*   `JMenu`有`MenuListener`

*   `JMenuItem`有`ButtonModel`

# sql-server-2008 - 无法针对多列主键使用单个列创建外键

> ID：10182170
> 
> 赞同：0
> 
> 时间：2012-04-16T21:46:55.083
> 
> 标签：sql-server-2008, constraints

我无法找出我收到错误消息的问题：

> *消息 1776，级别 16，状态 0，行 56 引用表“ Airplane_type* ”中没有与外键“FK_Airplane_make__68487DD7”中的引用列列表匹配的主键或候选键。消息 1750，级别 16，状态 0，行 56 无法创建约束。请参阅以前的错误。

这是查询的那一部分：

```
CREATE TABLE Airplane_type
(
make VARCHAR NOT NULL,
model VARCHAR NOT NULL,
type VARCHAR NOT NULL,
business_capacity INT NOT NULL,
economy_capacity INT NOT NULL,
range INT NOT NULL,
weight INT NOT NULL,
length INT NOT NULL,
wingspan INT NOT NULL,
PRIMARY KEY(make, model)
);

CREATE TABLE Airplane
(
airplane_ID VARCHAR(3) NOT NULL PRIMARY KEY,
make VARCHAR NOT NULL FOREIGN KEY REFERENCES Airplane_type(make),
model VARCHAR NOT NULL FOREIGN KEY REFERENCES Airplane_type(model)
); 
```

非常感谢任何帮助，谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T21:49:33.330

您已经在两列上创建了主键，不应该在两列而不是单独创建外键吗？您不能在单个外键中引用模型列，因为原始表中没有任何内容可以保证模型是唯一的。

```
CREATE TABLE Airplane
(
  airplane_ID VARCHAR(3) NOT NULL PRIMARY KEY,
  make VARCHAR NOT NULL,
  model VARCHAR NOT NULL,
  CONSTRAINT FK_Airplane_type FOREIGN KEY (make, model) 
    REFERENCES Airplane_type(make, model)
); 
```

另外，为什么`VARCHAR`不指定长度就使用？请阅读这篇博文：

*   [要踢的坏习惯：在没有（长度）的情况下声明 VARCHAR](https://sqlblog.org/2009/10/09/bad-habits-to-kick-declaring-varchar-without-length)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T21:50:53.403

外键引用的列必须受主键或唯一索引的约束。由于您的主键是两列（品牌、型号）的组合，因此外键也应该引用相同的组合对。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T21:58:26.177

```
CREATE TABLE Airplane_type
(
airplane_type_id not null Identity(1,1),
make VARCHAR NOT NULL,
model VARCHAR NOT NULL,
type VARCHAR NOT NULL,
business_capacity INT NOT NULL,
economy_capacity INT NOT NULL,
range INT NOT NULL,
weight INT NOT NULL,
length INT NOT NULL,
wingspan INT NOT NULL,
CONSTRAINT PK_AIRPLANE_TYPE PRIMARY KEY(airplane_type_id),
Constraint UK_Spotted_By_AARON Unique Key (make, model)
);

CREATE TABLE Airplane
(
airplane_ID VARCHAR(3) NOT NULL,
airplane_type_id int not null CONSTRAINT FK_Airplane_AirPlane_Type 
  Foreign Key References(AirPlane.Airplane_type_id),
Constraint PK_Airplane Primary Key (Airplane_id),
); 
```

据我所知，使用复合键的一部分作为约束并不是一件容易的事，如果你规范化，那就没有必要了。您让架构和型号组合不在您的飞机类型表中的飞机的方式是有效的。

# opengl - Haskell 图形程序过早关闭

> ID：10182173
> 
> 赞同：3
> 
> 时间：2012-04-16T21:47:15.347
> 
> 标签：opengl, haskell, termination

我正在使用 OpenGl 和 Haskell 编写一个程序，它应该在单击鼠标的时间和位置绘制一个矩形。但是，程序在我单击并在绘制矩形之前关闭。

```
import Graphics.Rendering.OpenGL
import Graphics.UI.GLUT
import Graphics.UI.GLUT.Callbacks.Window

main = do
  (progname, _) <- getArgsAndInitialize
  createWindow progname
  keyboardMouseCallback $= Just myKeyboardMouseCallback
  displayCallback $= display
  mainLoop

myKeyboardMouseCallback key keyState modifiers (Position x y) =
  case (key, keyState) of
    (MouseButton LeftButton, Down) -> do
      clear[ColorBuffer]
      let x = x :: GLfloat
      let y = y :: GLfloat
      renderPrimitive Quads $ do
        color $ (Color3 (1.0::GLfloat) 0 0)
        vertex $ (Vertex3 (x::GLfloat) y 0)
        vertex $ (Vertex3 (x::GLfloat) (y+0.2) 0)
        vertex $ (Vertex3 ((x+0.2)::GLfloat) (y+0.2) 0)
        vertex $ (Vertex3 ((x+0.2)::GLfloat) y 0)
      flush
    _ -> return ()

display = do
  clear [ColorBuffer]
  renderPrimitive Lines $ do
  flush 
```

是否有什么东西导致程序在其中一种方法中提前终止，或者这只是计算机告诉我我不能这样做的方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T00:51:24.347

你不能做你想做的事。在 OpenGL 程序中，您只能在*OpenGL 上下文*中发出绘图命令。此上下文始终绑定到特定线程，并且仅`displayCallback`在 GLUT 的主体中处于活动状态，因为其他回调可能会从不同的线程运行。

*但是，您可能会说：在许多/大多数平台上，GLUT 中的输入不*使用单独的线程，这意味着您理论上可以在那里发出绘图命令。但是，还有许多其他因素在您可以在何时何地发出绘图命令方面发挥作用。例如，当环境要求您使用双缓冲输出时，必须以非常特定的方式刷新缓冲区（例如，当对 X11 使用 EGL 或 GLX 时）。

简而言之：您不应该在`displayCallback`. 它存在的全部原因是您可以让 GLUT 处理与本机帧缓冲区管理相关的特定于平台的内容，并且它希望您将代码保存在正确的位置以使其工作。

相反，您要做的是创建一个可变变量（嘿，您使用的是 OpenGL；可变状态不应该让您担心），它指示是否绘制矩形以及在哪里绘制。类似（使用`Data.IORef`）：

```
main = do
  -- ...

  -- Create a mutable variable that stores a Bool and a pair of floats
  mouseStateRef <- newIORef (False, (0, 0))

  -- Pass a reference to the mutable variable to the callbacks
  keyboardMouseCallback $= Just (myKeyboardMouseCallback mouseStateRef)
  displayCallback $= (display mouseStateRef)

myKeyboardMouseCallback mouseStateRef key keyState modifiers (Position x y) =
  case key of
    MouseButton LeftButton -> do
      -- Store the current mouse pressed state and coords in the reference
      writeIORef mouseStateRef (keyState == Pressed, (x, y))
    _ -> return ()

display mouseStateRef = do
  clear [ColorBuffer]

  -- Read the state stored in the mutable reference
  (pressed, (x, y)) <- readIORef mouseStateRef

  -- Draw the quad if the mouse button is pressed
  when pressed . renderPrimitive Quads $ do
    color $ (Color3 (1.0::GLfloat) 0 0)
    vertex $ (Vertex3 (x::GLfloat) y 0)
    vertex $ (Vertex3 (x::GLfloat) (y+0.2) 0)
    vertex $ (Vertex3 ((x+0.2)::GLfloat) (y+0.2) 0)
    vertex $ (Vertex3 ((x+0.2)::GLfloat) y 0)
  flush 
```

# java - Google guava singleton Eventbus 多次触发

> ID：10182175
> 
> 赞同：0
> 
> 时间：2012-04-16T21:47:24.320
> 
> 标签：java, gwt, guava, vaadin

我使用 vaadin + spring IOC + google guava eventbus。Resources 建议使用 guava eventbus 作为单例。但是当我这样做时，我遇到了以下问题；

*   假设我同时在 3 个不同的浏览器上运行应用程序，所以我有 3 个不同的应用程序实例。

*   然后例如，当我在一个浏览器上按下一个按钮并触发一个事件时，我注意到我的带有 @subscribe 注释的相关侦听器方法被调用了 3 次！

这是我期望的正常行为，因为我将 eventbus 用作单例吗？如果不是，这里发生了什么？MainController 是一个带有自定义 Vaadin 应用范围的 spring 托管 bean

```
class MainController{
  public MainController() throws DAOException, Exception {
    EventBusFactory.getEventBusInstance().register(this);
  }

  @Subscribe
  public void addFacetEvent(FacetAddedEvent event) throws DAOException {
    getTreeTableView().addToList(event.getData());
  }
} 

class EventBusFactory{
  public static EventBus getEventBusInstance() {
        if(eventBus==null){
            eventBus=new EventBus();
        }
        return eventBus;
    }
} 
```

Ps 我也在 Vaadin 犹豫我应该使用 guava eventbus 还是 guava gwt event bus？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T12:18:40.680

简短回答：这是此配置中的正常和预期行为（您有三个 Vaadin 应用程序，因此三个`MainController`实例使用 single 管理`EventBus`）。

* * *

您所说的*自定义 Vaadin Application Scope*是指[此 Vaadin 插件](https://vaadin.com/directory#addon/spring-stuff)的范围吗？

无论如何，使用原型范围的 MainController bean 和 Vaadin App 很容易重现您的情况，如下所示：

```
public class SandpitApplication extends Application {
  private static final long serialVersionUID = 1L;
  private static final Logger log = Logger.getLogger(SandpitApplication.class);

  // https://vaadin.com/wiki/-/wiki/Main/Spring%20Integration#section-Spring+Integration-SpringContextHelperClass
  private SpringContextHelper ctx;

  @Override
  public void init() {
    // vaadin stuff
    setTheme("common");
    final Window mainWindow = new Window("Vaadin Sample Application");
    setMainWindow(mainWindow);

    // get your bean from spring
    log.info("start SandpitApplication@" + Integer.toHexString(hashCode()));
    ctx = new SpringContextHelper(this);
    // create application-wide bean
    final MainController mainController = ctx.getBean("mainController");

    mainWindow.addComponent(new Button("click to post", new Button.ClickListener() {
      @Override public void buttonClick(final ClickEvent event) {
        log.info("click on button");
        EventBusFactory.getEventBusInstance().post(
            new FacetAddedEventImpl("click-"
                + new SimpleDateFormat("HH:mm:ss").format(new Date())));
        log.info(mainController);
      }
    }));
  }
} 
```

和`MainController`类：

```
class MainController {
  private static final Logger log = Logger.getLogger(MainController.class);

  public MainController() {
    log.info("creating MainController@" + Integer.toHexString(hashCode()));
    EventBusFactory.getEventBusInstance().register(this);
  }

  @Subscribe
  public void addFacetEvent(final FacetAddedEvent event) {
    final String signature = "MC@" + Integer.toHexString(hashCode()) + ": ";
    log.info("addFacetEvent in " + signature + event);
    // getTreeTableViewBuilder returns extended ArrayList with fancy add
    getTreeTableViewBuilder().addFacetToList(signature + event.getData());
  }

  // plus other stuff like toString etc.
} 
```

当您执行以下操作时：

1.  在浏览器中启动 vaadin 应用程序 (App#1)。
2.  单击 App1# 按钮。
3.  启动另一个应用程序 (App#2)。
4.  单击 App2#按钮
5.  使用 App#1 返回选项卡。
6.  单击 App1# 按钮。

你会得到以下输出：

> 开始 SandpitApplication@75a5555a
> 创建 MainController@2e98f864
> 点击按钮 // #1
> addFacetEvent in MC@2e98f864: FacetAddedEventImpl@6b527dc6{data: click-13:42:45}
> MainController@2e98f864{treeTableViewBuilder: [MC@2e98f864: click-13: 42:45]}
> 开始 SandpitApplication@3f9e529
> 创建 MainController@2f8d604f
> 点击按钮 // #2
> addFacetEvent in MC@2e98f864: FacetAddedEventImpl@36c1fc67{data: click-13:42:47}
> addFacetEvent in MC@2f8d604f: FacetAddedEventImpl@36c1fc67{数据：click-13:42:47}
> MainController@2f8d604f{treeTableViewBuilder: [MC@2f8d604f: click-13:42:47]}
> 点击按钮 // #1
> MC@2e98f864 中的 addFacetEvent：FacetAddedEventImpl@42d32028{数据：click-13:42:49}
> MC@2f8d604f 中的 addFacetEvent：FacetAddedEventImpl@42d32028{数据：click-13:42:49}
> MainController@2e98f864{treeTableViewBuilder：[MC@2e98f864 : click-13:42:45, MC@2e98f864: click-13:42:47, MC@2e98f864: click-13:42:49]}

您现在应该看到单例`EventBus`正在管理两个应用程序范围的`MainController`bean，每个 bean 都在接收事件（因为它由 global 解析`EventBus`）。

试图猜测你想要实现什么，我会说你需要创建应用程序范围的事件总线 bean：

```
<bean id="eventBus" class="com.google.common.eventbus.EventBus"
    scope="vaadinApplication" /> 
```

* * *

关于 PS：我们在 Vaadin 项目中广泛使用标准 Guava，不需要 GWT 版本。

# android - 可滚动的按钮和图像列表减速

> ID：10182177
> 
> 赞同：0
> 
> 时间：2012-04-16T21:47:26.120
> 
> 标签：android, listview, button, imageview

我需要实现一个图像和按钮列表。我有 6 张图像作为分隔符，总共有 14 个带有自定义背景的按钮。该列表具有全屏 (800×600) 背景，分隔图像为 800×30 像素，按钮也具有相似的大小（所有按钮具有相同的背景图像）。最重要的是，我需要一个自定义滚动指示器：顶部和底部有两个闪烁的箭头。箭头应根据滚动位置显示或隐藏。

我还有其他一些 GUI 元素，包括使用 View.GONE 隐藏的 GLSurfaceView，因为列表显示在这些元素之上。

问题是，这种设置在 Galaxy Nexus 或 Desire HD 等功能相对强大的手机上运行速度太慢。

我尝试了两种不同的方法：

1.  使用基于本教程的 ListView：[http ://android.amberfog.com/?p=296](http://android.amberfog.com/?p=296)
2.  将所有按钮和图像放入一个 LinearLayout 并将其用作 ScrollView 的子项。要隐藏和显示闪烁的箭头，我通过覆盖 onScrollChanged 来确定滚动位置（[同步 ScrollView 滚动位置 - android](https://stackoverflow.com/questions/3948934/synchronise-scrollview-scroll-positions-android)）

两种实现都运行缓慢，具体取决于实际的手机。ScrollView 实现通常更快，但它在 Desire 或 Galaxy Nexus 上有明显的滞后，而 ListView 实现在 Desire HD 上很慢。

哪个是实施此类列表的最佳方式？您能否建议我一些指导方针，如何使实施快速且独立于设备？我相信列表中有大约 20 个图像和按钮对于这些手机来说应该不是问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T15:39:18.903

好的，问题似乎如下：我在同一个活动中有一个 GLSurfaceView 并且列表出现在它上面。这对于 UI 线程来说太多了，尽管列表完全与 GLSurfaceView 重叠，并且在列表出现时渲染被暂停。

我将列表移至不同的活动，现在它具有可接受的速度。但是切换到列表比较慢，当我关闭列表时，我必须重新加载表面视图，但这没关系。

# android - 监听 AUX 连接

> ID：10182181
> 
> 赞同：0
> 
> 时间：2012-04-16T21:47:56.790
> 
> 标签：android, android-intent

有什么方法可以知道 AUX 电缆是否在 Android 中连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T21:53:25.740

你说的是音频输出吗？因为如果是这样，我认为[这就是您要寻找的](http://developer.android.com/reference/android/media/AudioManager.html#isWiredHeadsetOn%28%29)

# iphone - 标记从 Internet 下载的 MP3？

> ID：10182182
> 
> 赞同：0
> 
> 时间：2012-04-16T21:47:58.647
> 
> 标签：iphone, xcode, tags, mp3, podcast

我正在构建一个包含多个播客的应用程序。每个播客都提供了将 MP3 下载到应用程序的选项。我有大约 6 个播客，并且想标记每个播客，这样当从每个播客中单击存档视图时，只有来自该特定播客节目的存档文件。

有没有办法可以在下载的 mp3 中添加标签或其他内容，然后在存档中仅搜索带有与该播客相关标签的 mp3？

顺便说一句，我正在使用 NSURLConnection 下载每个文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:02:16.127

我认为您可能以错误的方式看待这个问题。

您可以设置一个数据结构来保存有关您的文件的信息并使用它来显示您的信息，而不是标记您下载的文件。

例如。如果我这样做，我将拥有一个包含有关下载文件、标签或源的信息的 Core Data 模型，并且我会将该文件的路径存储在数据库中。这样，您可以存储您喜欢的有关下载文件的任何信息，并且可以通过它的路径访问它。

# c# - 使用 Linq，如何将 Xml 解析为仅接受构造函数中的参数的 C# 对象？

> ID：10182185
> 
> 赞同：3
> 
> 时间：2012-04-16T21:48:15.083
> 
> 标签：c#, xml, linq

假设我有一些这样的 XML：

```
<User>
    <Name>X</Name>
    <Gender>Y</Gender>
    <ImageUrl>Z</ImageUrl>
</User> 
```

我有一个名为 User 的类。

```
public class User
{
    public User(string name, string gender, string imageUrl) 
    {
        Name = name;
        Gender = gender;
        ImageUrl = imageUrl;
    }
    public string Name { get; }
    public string Gender { get; }
    public string ImageUrl { get; }
} 
```

它只接受构造函数`public User(string name, string gender, string ImageUrl)`并且不允许设置属性，使用 linq 和 c# 将此 xml 解析为这些对象的最佳方法是什么？

以粗略的方式，可以创建匿名对象，然后遍历它们以创建所需的对象。有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T21:55:26.267

您根本不需要任何匿名对象。使用[LINQ to XML](http://msdn.microsoft.com/en-us/library/bb387061.aspx)，您可以简单地从 XML 中选择*用户*节点，并通过使用从 XML 节点中选择的值调用构造函数来创建实际`User`的类实例：

```
// xml contains XML string, like in your sample
var document = XDocument.Parse(xml);
var users = document.Descendants("User")
   .Select(u => new User(
       u.Element("Name").Value,
       u.Element("Gender").Value, 
       u.Element("ImageUrl").Value
   )); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T22:23:14.013

如果您想要一种可用于大多数类的方法，这是我过去使用过的方法。

请记住，这使用反射，因此无论如何它都没有 jimmy_keen 的答案那么快。既然你提到了“高效”，这不会像他的回答那么快——把它当作它的价值：

这是代码：

```
 ConstructorInfo GetBestConstructor(XElement elm, Type itemType)
    {
        var elements = elm.Elements();

        // Get a constructor with the most parameters that
        // are provided by xml elements.
        var ctor = (
            from c in itemType.GetConstructors()
            let p = c.GetParameters()
            where
                p.Length > 0 &&
                p.Count(parm => elements.Any(e => e.Name.LocalName.Equals(parm.Name, StringComparison.InvariantCultureIgnoreCase))) == p.Length
            select c
        )
            // Put the constructor with the most matching parameters
            // at the top of the list
        .OrderByDescending(c => c.GetParameters().Length)
        .FirstOrDefault();

        return ctor;
    }

    TType Construct<TType>(XElement elm)
    {
        var ctor = GetBestConstructor(elm, typeof(TType));
        if (ctor != null)
        {
            // We found a valid contructor!
            List<object> parameters = new List<object>();

            // Build a list of parameters, deserializing as we go.
            foreach (var p in ctor.GetParameters())
            {
                var item = elm.Elements().FirstOrDefault(e => e.Name.LocalName.Equals(p.Name, StringComparison.InvariantCultureIgnoreCase));
                if (item != null)
                {
                    TypeConverter converter = TypeDescriptor.GetConverter(p.ParameterType);
                    if (converter != null &&
                        converter.CanConvertFrom(typeof(string)))
                    {
                        // Deserialize each parameter and add it.
                        var parameter = converter.ConvertFrom(item.Value);
                        parameters.Add(parameter);
                    }
                }
            }

            // Create the object, using each parameter we've deserialized
            // to pass to the constructor.
            return (TType)ctor.Invoke(parameters.ToArray());
        }
        return default(TType);
    }

    public class User
    {
        public User(string name, string gender, string imageUrl)
        {
            Name = name;
            Gender = gender;
            ImageUrl = imageUrl;
        }
        public string Name { get; protected set; }
        public string Gender { get; protected set; }
        public string ImageUrl { get; protected set; }
    }

    public IEnumerable<User> GetUsers()
    {
        XDocument doc = XDocument.Parse(@"
<User>
    <Name>X</Name>
    <Gender>Y</Gender>
    <ImageUrl>Z</ImageUrl>
</User>");

        return doc
            .Descendants("User")
            .Select(u => Construct<User>(u));
    }

    static public void Main()
    {
        var p = new Program();
        var users = p.GetUsers().ToArray();
    } 
```

可能对你的需要有点过分了，但我想我还是会把它扔在那里。

-道格

# jquery - Jquery 显示/隐藏多个表行

> ID：10182187
> 
> 赞同：4
> 
> 时间：2012-04-16T21:48:16.137
> 
> 标签：jquery, html-table, hide, rows, show

尝试使用 jquery 显示/隐藏表行。前两行有效。第三行不显示所有数据。

Jfiddle：http: [//jsfiddle.net/vcolmenar/wG8qf/1/](http://jsfiddle.net/vcolmenar/wG8qf/1/)

表主数据的 HTML 数据

```
<tr class="main">
    <td>
    <a href="#" class="main">12345</a>
    </td>
</tr>

<tr class = "data">
    <td>
    </td>
    <td>
        11111
    </td>
</tr>

<tr class="main">
    <td>
        <a href="#" class="main">12345</a>
    </td>
</tr>

<tr class = "data">
    <td>
    </td>
    <td>
        11111
    </td>
</tr>

<tr class="main">   
    <td>
        <a href="#" class="main">12345</a>
    </td>  
</tr>

<tr class = "data">
    <td>
    </td>
    <td>
        11111
    </td>
</tr>

<tr class = "data">
    <td>
    </td>
    <td>
        22222
    </td>
</tr>
<tr class = "data">
    <td>
    </td>
    <td>
        33333
    </td>
</tr>
<tr class = "data">
    <td>
    </td>
    <td>
        44444
    </td>
</tr> 
```

用于 Jquery 显示/隐藏功能的 JavaScript

```
$(document).ready(function() {
//Hide table rows with class 'min', but appear when clicked.
$(".data").hide();
$(".main").click(function() {
    $(this).parent().parent().next(".data").toggle("fast");
});
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-16T22:02:46.767

# css

tr.data {显示：无；}

# javascript

```
$(function(){
  $("#main-data-table","body").on({'click':function(event){
    event.preventDefault();
    $(this).closest("tr.main").nextUntil("tr.main").toggle("fast");
   }},
   "a.main",null);
}); 
```

# html

```
<table id="main-data-table">
<thead><tr>
    <th>Main</th>
    <th>Data</th>
</tr></thead>
<tfoot></tfoot>
<tbody>
<tr class="main">
        <td>
        <a href="#" class="main">12345</a>
        </td>
    </tr>

    <tr class = "data">
        <td>
        </td>
        <td>
            11111
        </td>
    </tr>

    <tr class="main">
        <td>
            <a href="#" class="main">12345</a>
        </td>
    </tr>

    <tr class = "data">
        <td>
        </td>
        <td>
            11111
        </td>
    </tr>

    <tr class="main">   
        <td>
            <a href="#" class="main">12345</a>
        </td>  
    </tr>

    <tr class = "data">
        <td>
        </td>
        <td>
            11111
        </td>
    </tr>

    <tr class = "data">
        <td>
        </td>
        <td>
            22222
        </td>
    </tr>
    <tr class = "data">
        <td>
        </td>
        <td>
            33333
        </td>
    </tr>
    <tr class = "data">
        <td>
        </td>
        <td>
            44444
        </td>
    </tr>
</tbody>
</table> 
```

# java - 在 Jslider 的旋钮上添加可调节的旋转图像。

> ID：10182188
> 
> 赞同：3
> 
> 时间：2012-04-16T21:48:34.733
> 
> 标签：java, swing, user-interface, jslider

JSlider 的旋钮最初只有 1 个自由度（它在轨道上水平或垂直平移）。我想为旋钮添加第二个自由度并手动旋转它。换句话说，我希望能够左右移动旋钮并旋转它。这两种运动都应该能够通过沿线性或旋转方向拖动鼠标来设置。我还没有看到这方面的代码，我想知道我该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T03:18:16.517

我将扩展`BasicSliderUI`并覆盖该`paintThumb`方法，以便您可以通过对拇指图像应用旋转变换或手动绘制旋转的拇指来以任意旋转绘制拇指。然后将此 UI 应用到您的 JSlider。

要使用鼠标和键盘控制旋转，最简单的方法可能是`MouseWheelListener`向 JSlider 添加 ，以便您使用鼠标滚轮控制拇指旋转。

# django - Django -- 将模型添加到数据库而不丢失数据

> ID：10182189
> 
> 赞同：0
> 
> 时间：2012-04-16T21:48:36.463
> 
> 标签：django, sqlite

我有一个简单的 Django 网站（实际上只是一个表单），它会询问几个问题并使用 Model.save() 将数据保存在 SQL 数据库中。很简单。不过，我想添加一个模型来进行页面计数——它只是一个带有一个字段的对象，每次调用页面的视图函数时都会增加一个字段。

现在，我对 SQL 知之甚少。我想这并不是很难做到，但我想避免因为对数据库的工作方式有一点误解而丢失或破坏我的所有数据。那么我该怎么做呢？我听说过一些第三方应用程序会实现这样的功能，但我想自己做，只是为了学习。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T21:52:42.897

我不明白为什么您现有的数据会受到影响。您正在谈论向数据库添加一个全新的表，在 Django 中只需运行`manage.py syncdb`. 这不起作用的情况是当您修改现有表时，但您没有在此处执行此操作。

我必须说，尽管学习和使用[South](http://south.aeracode.org/)在任何情况下都是有益的。拥有一个可以维护模型表的工具是一种很好的做法。

（另外，当然，您永远不会丢失任何数据，因为您的数据库已备份，对吧？对吧？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T21:51:48.963

由于您要添加新模型，因此您只需运行[syncdb](https://docs.djangoproject.com/en/dev/ref/django-admin/#syncdb)，它将为您的模型创建新表。如果要更改现有模型，则需要使用“ALTER TABLE”语句手动更新数据库架构，或者改用[South](http://south.aeracode.org/)。

# jquery - 使用 Fancybox 拒绝 jQuery 脚本的权限

> ID：10182194
> 
> 赞同：0
> 
> 时间：2012-04-16T21:48:56.447
> 
> 标签：jquery, fancybox

所有，我有以下 HTML：

```
<a class="display_songs fancybox.ajax" href="display_songs.php">View Current Playlist</a> 
```

然后我有以下jQuery：

```
$(".display_songs").fancybox({
    'maxWidth'    : 675,
    'maxHeight'   : 800,
    'fitToView'   : true,
    'closeClick'  : false,
    'openEffect'  : 'none',
    'closeEffect' : 'none',
    'scolling'    : 'no',
    'href'        : 'display_songs.php'
}); 
```

我使用以下代码加载 Fancybox 和 jQuery：

```
<script src="js/jquery.js" type="text/javascript"></script>
<script src="js/cufon-yui.js" type="text/javascript"></script>
<script src="js/cufon-replace.js" type="text/javascript"></script>
<script src="js/Century_Gothic_400.font.js" type="text/javascript"></script>
<script type="text/javascript" src="fancybox/jquery.fancybox.js"></script>
<link rel="stylesheet" type="text/css" href="fancybox/jquery.fancybox.css" media="screen" /> 
```

我加载的 jQuery 来自 Google，只是将其复制到 JS 文件中，因此我不会跨域。我得到的错误是：

```
网页错误详情

用户代理：Mozilla/4.0（兼容；MSIE 8.0；Windows NT 6.1；Trident/4.0；SLCC2；.NET CLR 2.0.50727；.NET CLR 3.5.30729；.NET CLR 3.0.30729；Media Center PC 6.0；InfoPath。 3；.NET4.0C；.NET4.0E；MS-RTC LM 8；AskTbAD2/5.14.1.20007)
时间戳：2012 年 4 月 16 日星期一 21:47:14 UTC

消息：权限被拒绝
线路：6083
字符：6
代码：0
URI：http://localhost/wedding/js/jquery.js

```

这适用于 Firefox、Chrome 等，但不适用于 IE。如果我移除 Cufon，它也不起作用。关于出了什么问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T21:19:16.273

我无法复制这个问题。检查[http://picssel.com/playground/jquery/STACK_issueIE_16apr12.html](http://picssel.com/playground/jquery/STACK_issueIE_16apr12.html)即使出现 cufon 错误，它似乎也能正常工作。

当然，我没有真正的 php 文件，而是渲染的 html。我想知道文件中是否有一些 php 进程`display_songs.php`可能会造成与 IE 和 fancybox 的冲突。

是否有任何理由在`display_songs.php`文件中包含 jQuery、cufon 和 fancybox？你可能不需要它们。

# javascript - data("key", value) 方法是否设置数据属性？

> ID：10182196
> 
> 赞同：4
> 
> 时间：2012-04-16T21:49:05.113
> 
> 标签：javascript, jquery

如果存在，jQuery`$("..").data("key", value)`方法会设置 data-key**属性**吗？

[Adam Freeman 的 Pro jQuery](http://www.apress.com/9781430240952)声明它确实：

> **提示**data 方法在设置值时也会考虑数据属性。当您指定一个键时，例如 [sic] 产品，data 方法会检查是否存在相应的 HTML5 数据属性，例如 data-product。如果存在，则将您指定的值分配给该属性。如果不是，则数据由 jQuery 内部存储。

但我认为它没有，我运行的测试表明它没有。（我检查了勘误表部分——没有）

完整代码如下，但不足之处在于，当我通过调用该`attr`方法设置 data-name 属性时，属性值发生了变化，可以在 chrome 元素选项卡中看到，并检索到`newValue`. 当我用数据方法设置时，这两个条件都不满足；似乎 using`data()`总是在内部设置值，而不是在属性上，即使存在一个。

不幸的是，[文档中唯一提到的 html5 数据属性](http://api.jquery.com/data/#data-html5)是在 data 方法的部分中，它只接受一个键，并返回伴随值；的描述`data("key", value)`似乎根本没有提到 html5 数据属性。

* * *

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.js"></script>

    <script type="text/javascript">
        $(function () {
            var oldValue = $("#d").data("name");
            alert("old value " + oldValue);

            $("#d").data("name", "Adam");
            //$("#d").attr("data-name", "Adam");

            var newValue = $("#d").attr("data-name");
            alert("new value " + newValue);
        });
    </script>
</head>
<body>
    <div id="d" data-name="none"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T21:55:09.953

我认为亚当弗里曼的描述是不正确的，或者至少不完全准确。

根据 jQuery 文档：

> 从 jQuery 1.4.3 开始，HTML 5 的数据属性将被自动拉入到 jQuery 的数据对象中。

这意味着 jQuery 将这些属性提取到它自己的内部表示中，而不是覆盖实际属性中的值。

快速阅读代码表明了这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T21:55:28.960

根据[jQuery 的 .data() 方法文档](http://api.jquery.com/data/#notes-1)：

> 请注意，此方法当前不为在 XML 文档上设置数据提供跨平台支持，因为 Internet Explorer 不允许通过 expando 属性附加数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T21:57:50.030

似乎它使用`data=`if 它存在并且不会引发错误。

[看看你自己：](https://github.com/jquery/jquery/blob/master/src/data.js#L324)

```
function dataAttr( elem, key, data ) {
    // If nothing was found internally, try to fetch any
    // data from the HTML5 data-* attribute
    if ( data === undefined && elem.nodeType === 1 ) {

        var name = "data-" + key.replace( rmultiDash, "-$1" ).toLowerCase();

        data = elem.getAttribute( name );

        if ( typeof data === "string" ) {
            try {
                data = data === "true" ? true :
                data === "false" ? false :
                data === "null" ? null :
                jQuery.isNumeric( data ) ? +data :
                    rbrace.test( data ) ? jQuery.parseJSON( data ) :
                    data;
            } catch( e ) {}

            // Make sure we set the data so it isn't changed later
            jQuery.data( elem, key, data );

        } else {
            data = undefined;
        }
    }

    return data;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-16T22:04:28.673

jQuery 的`.data()`函数根本不与 HTML5`data-*`属性交互，只是从它们中获取初始值；不过，我不完全确定**何时**完成 - 另一个答案表明它是在第一次调用时完成的`.data()`，这可能是正确的（这绝对是有道理的）。

使用`.attr()`为`data-*`属性指定新值不会修改 jQuery 已存储以使用`.data()`. 为了说明，看看[这个 jsFiddle](http://jsfiddle.net/Gj6SU/)。如果您检查`<div>`元素然后单击按钮，您可以看到虽然元素上的属性的值已更改，但两个`console.log()`调用输出相同的值。

# jquery - jquery 选择选项不起作用（按名称）

> ID：10182200
> 
> 赞同：2
> 
> 时间：2012-04-16T21:49:25.800
> 
> 标签：jquery, html

我有以下定义我的选择器的 HTML：

```
<select name="zoom_cat[]" style="margin-left:15px;">
  <option value="-1" selected="selected">All</option>
  <option value="0">News</option>
  <option value="1">Publications</option>
  <option value="2">Services</option>
  <option value="3">Industries</option>
</select> 
```

我正在尝试将所选选项设置为全部（值 -1）。由于某种原因，此 jquery 代码无效（仍选择相同的选项）：

```
$('input[name="zoom_cat[]"] option[value="-1"]').attr('selected', 'selected'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T21:52:43.743

```
$('select[name="zoom_cat[]"] option[value="-1"]').attr('selected', 'selected'); 
```

代替`input`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T21:58:20.373

正如上面的马特所说，你应该`select`在你的选择器中使用，而不是`input`，它们是不同的元素。同样设置 selected 属性不适用于 <=IE7，所以理想情况下你应该这样做`$('select[name="zoom_cat[]"]').val('-1');`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T21:58:47.327

您需要在选择器中转义特殊字符。

请参阅： [http ://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

所以试试这个：

```
$('input[name="zoom_cat\\\\[\\\\]"] option[value="-1"]').attr('selected', 'selected'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T21:56:45.430

使用`select`代替`input`

```
$('select[name="zoom_cat[]"] option[value="-1"]').attr('selected', 'selected'); 
```

工作样本：http: [//jsfiddle.net/Est9D/4/](http://jsfiddle.net/Est9D/4/)

你可以用更简单的方式来做

```
 $('select[name="zoom_cat[]"]').val("-1") 
```

示例：http: [//jsfiddle.net/Est9D/7/](http://jsfiddle.net/Est9D/7/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-19T16:58:15.067

你可以这样做：（不是某人建议的attr，而是prop）

```
$('select[name="zoom_cat[]"] option[value="-1"]').prop('selected', 'selected'); 
```

# emacs - 在 Emacs 中运行乳胶

> ID：10182205
> 
> 赞同：3
> 
> 时间：2012-04-16T21:49:47.713
> 
> 标签：emacs, latex

我曾经`latex`在`Emacs`一个`.tex`文件中启动`C-c C-c`。

我刚换了机器，需要重新配置。我已经安装了`texlive-full`，并从以前的机器复制`.emacs`到新机器。

当我在、launch`.tex`下打开一个文件，然后键入时，它会打开另一个名为 的缓冲区，如下所示：`Emacs``C-c C-c``LaTeX``*tex-shell*`

![在此处输入图像描述](../Images/ca58b8f3b35960f52413c4602221733d.png)

谁能告诉我发生了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T05:24:07.040

我现在真的不知道会发生什么，但似乎你想使用 auctex：

```
sudo apt-get install auctex 
```

并重新启动 Emacs 应该可以解决您的问题。

# java - Java 银行帐户同步示例。看不到解决方案的工作原理

> ID：10182207
> 
> 赞同：2
> 
> 时间：2012-04-16T21:49:53.273
> 
> 标签：java, synchronization, account, bank

[http://i.stack.imgur.com/D01ja.​​png](http://i.stack.imgur.com/D01ja.png)

因此，我正在阅读有关同步的 pdf，其中显示了上述示例问题。稍后，将介绍以下内容，大概是作为解决方案：

```
class Account
{
  private double balance;
  public Account(double initialDeposit) {
    balance = initialDeposit;
  }
  public synchronized double getBalance() {
    return balance;
  }
  public synchronized void setBalance(double newBalance) {
    balance = newBalance;
  }
  public synchronized void deposit (double amt) {
   //essentially still multiple steps when in bytecode!
   balance += amt;
  } 
```

我不明白这如何解决问题。也许这不是本意，但似乎暗示。我正在寻找一些关于它是否存在的确认。}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T21:53:52.180

[`synchronized`](http://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html)关键字是确保两个线程不能同时进入同步块[在同一个对象上] 。

在您的情况下，不能同时在同一对象上调用这 3 个方法，因为每个方法在`this`调用时都持有一个锁。

因此，尽管如此，`balance += amt;`它不是原子的 - 它是同步的，因此在评估此语句期间状态不可能发生变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T21:54:41.623

使用 synchronized 关键字的要点是一次只有一个线程可以访问该方法，并且图像上的模式变得不可能。

但正如下面所讨论的，setBalance 方法的存在使得滥用类并获得不希望的输出成为可能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T22:39:39.747

如果 PDF 提议将其作为最终解决方案，我会感到惊讶，因为它完全无法解决您的图像显示的问题！也许它向您展示了一种天真的尝试来解决问题，通过喷洒同步关键字来解决问题？

我会继续阅读您的 PDF - 并发布您的发现！

# apache - 重写：Apache 到 Nginx

> ID：10182213
> 
> 赞同：0
> 
> 时间：2012-04-16T21:50:30.010
> 
> 标签：apache, .htaccess, nginx, rewrite

有人可以告诉我，如何为 nginx 转换以下规则？

```
RewriteRule ^([^/]*)/?$ index.php?a=$1 [L,NC]
RewriteRule ^([^/]*)/([^/]*)/?$ index.php?a=$1&b=$2 [L,NC]
RewriteRule ^([^/]*)/([^/]*)/([^/]*)/?$ index.php?a=$1&b=$2&c=$3 [L,NC] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:22:13.003

[http://wiki.nginx.org/HttpRewriteModule#rewrite](http://wiki.nginx.org/HttpRewriteModule#rewrite)

# php - Apache mod_rewrite 不处理重写的 url？

> ID：10182214
> 
> 赞同：1
> 
> 时间：2012-04-16T21:50:35.623
> 
> 标签：php, apache, .htaccess, mod-rewrite

```
RewriteEngine on
RewriteRule ^/(.*)/settings.php$ /settings.php?session=$1
RewriteRule ^/register/(.*)/(.*) /register/$2?session=$1 
```

我将会话放在 url 中，但它不起作用。它尝试将会话视为文件：

> [2012 年 4 月 16 日星期一 17:37:05] [错误] 文件不存在：/home/delta/public_html/register/D7yuzHOn3gx

这有什么问题？

感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:13:26.030

将您的规则更改为：

```
RewriteRule ^(.*)/settings\.php$ settings.php?session=$1 [L,NC,QSA]
RewriteRule ^register/([^/]*)/(.*) register/$2?session=$1 [L,NC,QSA] 
```

并记住 RewriteRule 在第一个 slash 之后开始匹配`/`。

# perl - Perl Catalyst; configuring session expire time and flash behaviour

> ID：10182216
> 
> 赞同：0
> 
> 时间：2012-04-16T21:50:50.560
> 
> 标签：perl, session, catalyst

I just discovered that when I configure the session plugin of a Catalyst app (Catalyst::Plugin::Session) to expire, it screws with the flash data. More specifically, I'm finding that flash data no longer carries over with a new request.

Does this sound normal? How might I cope with this?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T22:16:44.543

Perfectly normal. The whole point of sessions is to be able to associated data from one request with data in another request. When you let the session for some request expire, you are saying that that request's data shouldn't have anything to do with any future request.

More specifically, the flash data is a part of the session data -- see the `_save_flash` method in the `Catalyst/Plugin/Session.pm` file, for instance. Also see the [big warning for the `delete_session` method](http://search.cpan.org/perldoc?Catalyst%3a%3aPlugin%3a%3aSession#delete_session):

> NOTE: This method will also delete your flash data.

How to cope with it? You need to persist data from a request using any scheme other than the Session plugin. Without knowing more about your app, what data you are trying to persist, and how you will associate data from an old session with a new request, I couldn't begin to make a more specific recommendation than that.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T22:17:18.183

When configuring the session for example with a database backend you'll have to add `flash_to_stash` as an option:

```
<session>
  dbi_dbh            DB
  dbi_table          sessions
  dbi_id_field       id
  dbi_data_field     session_data
  dbi_expires_field  expires
  flash_to_stash     1
  expires            3600
</session> 
```

# ruby-on-rails - 从rails中的params hash中拒绝额外的url参数

> ID：10182220
> 
> 赞同：2
> 
> 时间：2012-04-16T21:51:16.893
> 
> 标签：ruby-on-rails, api

我正在使用 Rails 构建一个 API，它可以采用很多参数。理想情况下，如果用户意外地在请求中包含了一个额外的、不必要的参数，这不会使请求模棱两可，我想正常处理它。这显然使我无法简单地写作

```
 ApiRequest.new(params) 
```

因为如果 params 哈希中有任何额外内容，则会抛出 UnknownAttributeError 。是否有一种拒绝额外属性的简单方法，或者我必须编写一个方法来在创建新对象之前手动验证请求。此外，这是否会被视为 API 的不良做法，如果发生这种情况，我是否应该使用 HTTP 400 进行响应？

谢谢，汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:44:37.670

感谢 Sergio 的建议，我最终在我的 ApiRequest 类中添加了以下初始化方法，它允许我进行批量分配，而不管哈希中的内容是什么。如果有人使用它，请确保您确保属性在需要时受到 attr_protected。

```
def initialize(params)
    params.delete_if {|k| !self.respond_to? "#{k}="}
    super
end 
```

# java - 在数据库中搜索条目时出现语法错误

> ID：10182226
> 
> 赞同：0
> 
> 时间：2012-04-16T21:52:05.967
> 
> 标签：java, android, database, eclipse, sqlite

当我尝试使用“洗衣机”作为搜索字符串在数据库中搜索特定条目以尝试查找“洗衣机”的数据库条目时，出现错误消息：

```
04-16 21:43:28.951: E/AndroidRuntime(545): FATAL EXCEPTION: main
04-16 21:43:28.951: E/AndroidRuntime(545): java.lang.RuntimeException: Unable to start   activity  ComponentInfo{com.lukeorpin.theappliancekeeper/com.lukeorpin.theappliancekeeper.EntryStatis tics}: android.database.sqlite.SQLiteException: near "Machine": syntax error: , while compiling: SELECT _id, appliance_name, appliance_wattage, energy_rates FROM ApplianceDetails WHERE appliance_name=Washing Machine 
```

更具体地说是：

```
at com.lukeorpin.theappliancekeeper.Database.getWattage(Database.java:122)
04-16 21:43:28.951: E/AndroidRuntime(545):  at com.lukeorpin.theappliancekeeper.EntryStatistics.onCreate(EntryStatistics.java:47) 
```

这是数据库搜索查询的代码：

```
public String getWattage(String spinnerChoice) {
    // TODO Auto-generated method stub
    String[] columns = new String[] { KEY_ROWID, KEY_NAME, KEY_WATTAGE, KEY_ENERGY};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, KEY_NAME + "=" + spinnerChoice, null, null, null, null);
    if (c != null){
        c.moveToFirst();
        String wattage = c.getString(2);
        return wattage;
    }
    return null;
}

public String getEnergyRate(String spinnerChoice) {
    // TODO Auto-generated method stub
    String[] columns = new String[] { KEY_ROWID, KEY_NAME, KEY_WATTAGE, KEY_ENERGY};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, KEY_NAME + "=" + spinnerChoice, null, null, null, null);
    if (c != null){
        c.moveToFirst();
        String energyRate = c.getString(3);
        return energyRate;
    }
    return null;
} 
```

这是创建该方法的原始类：

```
final String spinnerChoice = getIntent().getStringExtra("Name");
    if(spinnerChoice==null){ 
        return;
    } 

Database data = new Database(this);
    data.open();
    String returnedWattage = data.getWattage(spinnerChoice); 
    String returnedEnergyRate = data.getEnergyRate(spinnerChoice);
    data.close(); 
```

有谁知道为什么会出现此错误消息？谢谢

编辑：这是错误指向的代码行（第 122 行）：

```
Cursor c = ourDatabase.query(DATABASE_TABLE, columns, KEY_NAME + "=" + spinnerChoice, null, null, null, null); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T21:56:45.273

鉴于错误消息，您似乎没有引号来表示`appliance_name`值比较的字符串。它应该是

```
WHERE appliance_name = 'Washing Machine' 
```

我对 api 不熟悉，但您可以尝试将第 122 行更改为

```
Cursor c = ourDatabase.query(DATABASE_TABLE, columns, KEY_NAME + "='" + spinnerChoice + "'", null, null, null, null); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T21:56:58.597

您需要将搜索字符串括在单引号中（在您的 SQL 查询中）。

# java - 谷歌浏览器扩展和应用程序开发

> ID：10182227
> 
> 赞同：1
> 
> 时间：2012-04-16T21:52:07.860
> 
> 标签：java, google-chrome

我想从我的 java 应用程序开发一个 chrome 扩展/应用程序。这可能吗？如果是这样，你能指点我一些教程/资源吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:02:35.493

AFAIK（至少在我做这些事情时）chrome扩展只能用javascript编写。

一切都在这里： [http ://code.google.com/chrome/extensions/getstarted.html](http://code.google.com/chrome/extensions/getstarted.html)

# ruby-on-rails - Ruby on Rails - 整个路线中的命名约定可能存在错误

> ID：10182228
> 
> 赞同：0
> 
> 时间：2012-04-16T21:52:13.107
> 
> 标签：ruby-on-rails, ruby, routes, haml

我正在制作登录路由并将其添加到 routes.rb`resources :sign_in`

我做了一个这样的控制器：

```
class Mobile::Sign_inController < ApplicationController
  layout "mobile/application"

  def get
    respond_to do |format|
      format.html
    end

  end

  def index
    respond_to do |format|
      format.html
    end
  end

end 
```

它似乎被正确路由，但我的视图文件位于此处：

```
/app/views/mobile/sign_in.html.haml 
```

其中只有 1 行用于测试目的：

```
%strong{:class => "code", :id => "message"} Hello Signin! 
```

但是当我在浏览器中访问 url：[http://m.cmply.local:8800/signin](http://m.cmply.local:8800/signin)时，屏幕完全是白色的，浏览器中没有任何内容。

知道为什么会发生这种情况以及如何解决吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T22:03:07.740

这里有几个问题：

1.  您的控制器名称应该是`SignInsController`，而不是`Sign_inController`。考虑将您的名称更改为`UserSessionsController`或类似名称，因为这样可以更好地反映它所代表的*资源。*您仍然可以为 URL 指定一个备用名称（例如`sign_in`）。

2.  为什么你的控制器在命名空间下`Mobile`？您给出的路线并未反映这一点，但您似乎并未全部提供。该路线可能应该在以下`scope`：

    ```
    scope :module => "mobile" do
      resource :sign_in
    end 
    ```

3.  由于只有“一个”登录，它应该声明它的路线`resource :sign_in`，甚至可能`resource :sign_in, :only => [:new, :create, :destroy]`，这取决于你想要什么。这意味着该`index`动作不再存在，您可能希望将其替换为该`new`动作`。

4.  RESTful 资源默认没有`get`操作，我不确定你的意思是什么，但它应该是别的东西。

# java - 检票口和 CSS 资源

> ID：10182231
> 
> 赞同：9
> 
> 时间：2012-04-16T21:52:28.010
> 
> 标签：java, css, wicket

我一直在环顾四周，但找不到将我自己的 CSS 添加到 Wicket 网站项目的虚拟指南。但在我开始之前……我对正确的 Java 开发还很陌生，所以当我说“虚拟指南”时，我是认真的！非常感谢我在这里简单而清晰的解释！

我从这里的指南开始（[http://wicket.apache.org/start/quickstart.html](http://wicket.apache.org/start/quickstart.html)）并且运行良好。接下来，我想添加我自己的 CSS 并开始使用它。而且我进展不快。主要是因为我不知道如何在 java 中执行此操作（我来自 C#/asp.net 背景）。

无论如何，那些了解 Apache Wicket 的人已经知道这一点，但是快速入门的源代码会在如下位置创建您的代码`project/src/main/java/com/xyz`

我想我可以做的是在这里添加一个 CSS 文件夹......所以我创建了一个示例 CSS，然后我把它贴在这里：

```
project/src/main/java/com/xyz/css/conor.css

(containing something real simple like the following)

h2 {
    font-family: tahoma;
} 
```

然后我删除了我 homepage.html 中的 Wicket 默认 css 并将其更改为引用我的，如下所示：

```
<link rel="stylesheet" href="css/conor.css" type="text/css" /> 
```

但是我的页面没有注意 conor.css... 显然我做错了什么，但找不到 java 假人（又名我！）的分步指南。

我已经阅读了诸如您需要为 Eclipse 安装 Web 工具之类的内容。我确实不知道这对我有什么用，也不知道为什么它会指示我的页面使用 CSS。

很感谢任何形式的帮助！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-17T06:31:20.443

当 Wicket 解析标记并尝试提供正确的链接时，您必须帮助 Wicket 理解您的标记。

在您的情况下，您尝试链接到位于 Java 类路径中的资源。这与 Web 上下文根（位于 src/main/webapp 中）不同。类路径资源和 web 上下文资源的区别在于 Wicket 负责和控制对*类路径资源*的访问，而您的容器（即 jetty、tomcat、glassfish 等）负责和控制对 web 上下文资源的访问。

例如，当资源在 Wicket 的权限范围内时，我们可以用它做各种事情，例如变量替换、压缩、缩小、聚合。这些东西是 Wicket 的一部分。

现在到你手头的问题，因为你没有告诉 Wicket 链接的资源在它的控制之下，Wicket 假设你希望容器来处理这些。为了缓解这种情况，您应该在`<wicket:link>`标签周围添加一个标签`<link>`。

```
<head>
    ...
    <wicket:link>
    <link rel="stylesheet" href="css/conor.css" type="text/css" />
    ...
    </wicket:link>
</head> 
```

这些`<wicket:link>`标签告诉 Wicket 寻找封闭的资源并尝试在 Java 类路径上解析它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T07:39:47.803

一般来说，您应该在 project/src/main/webapp/css 中添加您的 css，然后 css/conor.css 将访问它

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-01T21:45:31.440

您可以像这样在您的 wicket java 页面中加载您的 css 文件：

```
@Override
public void renderHead(IHeaderResponse response) {
    response.render(CssHeaderItem.forReference(new CssResourceReference(myCssFile.class, "myCssFile.css")));
} 
```

如果您的项目中有 css 文件，则可以最初加载。

# c++ - 带有 c++ 的 OpenCV 库 - 详细 cv::Mat::at 在大图像上导致 SIGSEGV

> ID：10182236
> 
> 赞同：0
> 
> 时间：2012-04-16T21:52:45.630
> 
> 标签：c++, opencv

我目前正在使用 openCV-lib（2.1 版）在 C++ 中编写应用程序。任务是使用这个库的一些特性来实现一个小型数据库作为学生项目。我自己实现的中值滤波器和 boxcar 滤波器使用 cv::Mat::at 方法通过读取和写入操作访问给定图像中的单个像素。

奇怪的是：它在较小的图像上效果很好。但只有更大的图像它总是会生成一个 SIGSEGV，总是在相同的坐标上。

这是一个已知的错误还是我真的做错了什么？

这是我写的最重要的功能：

```
class point {
public:
    int x,y;
};

class ImageEntry {  
    friend class ImageDB;
private:
    string _key;
    string _filename;
    Mat *_data;
    ImageEntry* _next;
    void show(void);
public:
    void operator<<(ImageFilter* x);
    ~ImageEntry();  
    ImageEntry(string filename, string key);
    Vec3b GetPoint(int x, int y);
    point GetSize(void);
    void SetPoint(int x, int y, Vec3b color);
};

point ImageEntry::GetSize(void) {
    point iRet;
    iRet.x = _data->cols;
    iRet.y = _data->rows;
    return iRet;
}

Vec3b ImageEntry::GetPoint(int x, int y) {
    Vec3b iRet;
    iRet = _data->at<Vec3b>(x,y);
    return iRet;
}

void ImageEntry::SetPoint(int x, int y, Vec3b color) {
    _data->at<Vec3b>(x,y) = color;
}

void MedianFilter::filterImage(ImageEntry* img) {
    Vec3b Points[9];
    Vec3b NewColor;

    unsigned char ActChan[9];
    point range = img->GetSize();
    for (int act_x = 1; act_x < (range.x - 1); act_x++) {
        for (int act_y = 1; act_y < range.y - 1; act_y++) {
            Points[0] = img->GetPoint(act_x-1,act_y-1);
            Points[1] = img->GetPoint(act_x,act_y-1);
            Points[2] = img->GetPoint(act_x+1,act_y-1);
            Points[3] = img->GetPoint(act_x-1,act_y);
            Points[4] = img->GetPoint(act_x,act_y);
            Points[5] = img->GetPoint(act_x+1,act_y);
            Points[6] = img->GetPoint(act_x-1,act_y+1);
            Points[7] = img->GetPoint(act_x,act_y+1);
            Points[8] = img->GetPoint(act_x+1,act_y+1);

            for (int act_color = 0; act_color < 3; act_color++) {
                for (int i = 0; i < 9; i++) ActChan[i] = Points[i][act_color];
                SelSort9(ActChan);
                NewColor[act_color] = ActChan[4];
            }
            img->SetPoint(act_x,act_y,NewColor);
        }
    }
} 
```

我真的很感激任何建议。感谢您的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:52:28.320

如果您在[OpenCv](http://opencv.willowgarage.com/documentation/cpp/basic_structures.html#cv-mat-at)`at()`的文档中查看您在 SetPoint() 方法中使用的函数，它会说：

```
template<typename _Tp> _Tp& Mat::at(int i, int j) 
```

返回对指定矩阵元素的引用。参数：

```
i – The 0-based row index
j – The 0-based column index 
```

此外，如果您查看 GetSize() 方法，您设置`iRet.y = _data->rows`然后在该方法中`filterImage()`使用 for 循环从`act_y = 1 to iRet.y`. 第二个循环，遍历行。在这个方法结束时，你调用`SetPoint(act_x, act_y)`，它`at(act_x, act_y)`基本上又调用了。

回想一下，那`act_y`是行的索引，但现在被用作列的索引。我希望这个建议是您解决问题所需要的。

# java - 如何将字符串转换为 JSONArray？

> ID：10182237
> 
> 赞同：1
> 
> 时间：2012-04-16T21:52:52.207
> 
> 标签：java, android, json, sharedpreferences, arrays

我正在尝试将我的玩家数组保存为`JSONArray`，将其转换为字符串，将其放入`SharedPreferences`然后将其转换回来。如果`JSONArray`我尝试访问数组中的任何 Player 实例，我在使用当前尝试重新加载我的应用程序时会返回运行时异常/ClassCast 异常。

我哪里错了？

```
JSONArray savedPlayers;
SharedPreferences prefs;
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.indie);

    savedPlayers = new JSONArray();

    prefs = getSharedPreferences("appData", 0);
    String jsonString = prefs.getString("playerString", null);

    //Restores playerArray if any players have been saved in the past
    if(jsonString != null)
    {
        try 
        {

            savedPlayers = new JSONArray(JSONString);
            MyListView.players.clear();
            MyListView.ids.clear();
            for(int i = 0; i < savedPlayers.length(); i++)
            {
                MyListView.players.add(((Player) savedPlayers.get(i)).getName()); //Error
                MyListView.ids.add(((Player) savedPlayers.get(i)).getSaveId());
            }
        } 
        catch (JSONException e) 
        {
            e.printStackTrace();
        }
    }
}

//If there are savedPlayers converts the JSONArray to a string and saved it within SharedPreferences
@Override
protected void onPause() 
{
    if(savedPlayers != null)
    {
        SharedPreferences.Editor editor = getSharedPreferences("appData", 0).edit();
        String jsonString = savedPlayers.toString();
        editor.putString("playerString", jsonString).commit();
    }
    super.onPause();
} 
```

**JSON字符串：**
`["en.deco.android.livehud.Player@44eba878","en.deco.android.livehud.Player@44ebec68"]`

**日志猫：**

```
04-16 22:31:13.765: ERROR/AndroidRuntime(7496): Uncaught handler: thread main exiting due to uncaught exception
04-16 22:31:13.785: ERROR/AndroidRuntime(7496): java.lang.RuntimeException: Unable to start activity ComponentInfo{en.deco.android.livehud/en.deco.android.livehud.GUI}: java.lang.ClassCastException: java.lang.String
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2496)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at android.app.ActivityThread.access$2200(ActivityThread.java:119)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at android.os.Looper.loop(Looper.java:123)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at android.app.ActivityThread.main(ActivityThread.java:4363)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at java.lang.reflect.Method.invokeNative(Native Method)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at java.lang.reflect.Method.invoke(Method.java:521)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at dalvik.system.NativeStart.main(Native Method)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496): Caused by: java.lang.ClassCastException: java.lang.String
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at en.deco.android.livehud.GUI.onCreate(GUI.java:102)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
04-16 22:31:13.785: ERROR/AndroidRuntime(7496):     ... 11 more
04-16 22:32:57.775: ERROR/AndroidRuntime(7537): Uncaught handler: thread main exiting due to uncaught exception
04-16 22:32:57.795: ERROR/AndroidRuntime(7537): java.lang.RuntimeException: Unable to start activity ComponentInfo{en.deco.android.livehud/en.deco.android.livehud.GUI}: java.lang.ClassCastException: java.lang.String
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2496)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at android.app.ActivityThread.access$2200(ActivityThread.java:119)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at android.os.Looper.loop(Looper.java:123)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at android.app.ActivityThread.main(ActivityThread.java:4363)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at java.lang.reflect.Method.invokeNative(Native Method)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at java.lang.reflect.Method.invoke(Method.java:521)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at dalvik.system.NativeStart.main(Native Method)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537): Caused by: java.lang.ClassCastException: java.lang.String
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at en.deco.android.livehud.GUI.onCreate(GUI.java:102)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
04-16 22:32:57.795: ERROR/AndroidRuntime(7537):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:01:54.080

您当前正在使用每个 Player 对象的 toString 表示创建一个 JSONArray，这会生成一个字符串数组，其中不包含来自 Player 本身字段的任何信息。如果您打算使用 JSONArray/JSONObject 类，那么您需要为每个玩家创建一个 JSONObject 对象，并将它们添加到 JSONArray。例如，以下代码将创建一个 JSONObject，将播放器的名称添加到对象，然后将其添加到 JSONArray：

```
JSONObject playerJsonObject = new JSONObject();
playerJsonObject.put("name", player.getName());
jsonArray.put(playerJsonObject); 
```

但是，进行 JSON 序列化的一种更简单的方法是使用 GSON： [http ://code.google.com/p/google-gson/](http://code.google.com/p/google-gson/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T22:57:14.617

您应该考虑为此使用[杰克逊。](http://jackson.codehaus.org/)

您所有的序列化和反序列化代码都将消失，您的生活将变得更加简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T12:07:58.547

```
 String jsonString = savedPlayers.toString(); 
```

这是行不通的。它在数组中的每个对象（播放器）上调用 toString。数组中的对象没有覆盖 toString 方法，因此只是返回它们所在的内存空间：

```
 en.deco.android.livehud.Player@44eba878 
```

您需要在您的 Player 类中覆盖 toString，我不知道您的类是什么样的，但它会按照以下方式进行：

```
public class Player {
 String name;
 int saveId;

 public Player(String name, int saveId){
   this.name = name;
   this.saveId = saveId;
 }

 public String getName(){
  return name;
 }

 public int getSaveId(){
  return saveId();
 }

 @Override
 public String toString(){
  return "{" + "name:"+ this.name +"," + "saveId:"+ this.saveId +"}";
 }

} 
```

查看 JSON 站点以获取 JSON 应为结构的参考：http: [//www.json.org/](http://www.json.org/)

还建议您在覆盖 toString() 时覆盖 hashcode()；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T22:23:30.427

您不应该先将字符串转换为 Array 然后解析为 json array 吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-16T23:06:22.447

如果您尝试转换不适当的类型，原生 android JSON 库对发生的错误类型非常敏感。因此，添加到 JSON 对象的每个调用都必须有一个错误处理程序。

这导致了很多代码和复杂性，这应该是一个真正无痛的过程。幸运的是，有一些库可以让这种转换变得非常容易。我个人推荐 GSON 库： [http ://code.google.com/p/google-gson/](http://code.google.com/p/google-gson/)

JSON 可以轻松地将您的数据往返传输，将您的 JSON 对象自动序列化和反序列化到您的应用程序使用的 Java 类中。

通读使用页面可以看到，您只需 4 行代码即可完成转换。 [https://sites.google.com/site/gson/gson-user-guide#TOC-Serializing-and-Deserializing-Generic-Types](https://sites.google.com/site/gson/gson-user-guide#TOC-Serializing-and-Deserializing-Generic-Types)

另外，顺便说一句，@Kamal 提出了一个很好的观点，即首先在 java 中将字符串转换为数组。或者，交替使用 GSON，您可以将其从自定义类类型转换。它真的那么容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-16T23:18:34.083

GSON 非常适合 JSON 操作：

这里回答了与您相同的问题：

[无法将字符串转换为 JsonArray](https://stackoverflow.com/questions/6454889/cant-convert-string-to-jsonarray)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-06T12:06:40.223

我们需要先制作 JSON 对象。例如，如果 resp 是一个字符串（例如作为 http 响应）

```
JSONObject jsonObject = new JSONObject(resp); 
```

jsonObject 可能包含其他 JSON 对象或 JSON 数组。如何转换 JSON 取决于响应。如果 arraykey 是 JSON 对象中的一个数组，那么我们可以通过以下方式获取数组列表。

```
JSONArray arr  = jsonObject.getJSONArray("arraykey"); 
```

检查 arr 的长度，如果大于 0，则它包含 JSON 对象或 JSON 数组，具体取决于数据。可以在 [http://www.hemelix.com/JSONHandling找到一个完整的示例，其中包含有关 JSON 字符串到 JSON 数组的一些解释](http://www.hemelix.com/JSONHandling)

# database - 计算给定功能依赖的候选键

> ID：10182238
> 
> 赞同：2
> 
> 时间：2012-04-16T21:52:53.470
> 
> 标签：database, functional-dependencies

给定以下对关系 R(ABCDEFG) 的函数依赖

```
AB → CF
BG → C
AEF → C
ABG → ED
CF → AE
A → CG
AD → FE
AC → B 
```

我已经通过使用将属性放在左、中、右列中的方法计算出候选键，具体取决于它是在依赖项的左侧、右侧还是两者兼而有之。左表示该属性是必需的，中间是未知的，右表示不是键的一部分。

我懂了：

```
L | M       | R
--|---------|----
- | ABCDEFG | - 
```

从这里我计算出每个单独属性的闭包和排列：BC、BD、BE、BF、BG、CD、CF ......

我发现只有 A 和 CF 的闭包包含所有属性，因此是候选键，但是问题的解决方案也有 BFG。

有人可以解释我在计算候选键时做错了什么吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T10:54:19.063

[该算法](http://csc.lsu.edu/~jianhua/fd_slide2_09.pdf)尝试查找快捷方式（第 3 页），但在您的情况下，它找不到任何快捷方式。要确定任何特定的属性组合是否是键，您尝试确定该组合是否决定了所有其他属性。就您而言，您已经完成了所有工作；你只是错过了一些关于 BFG 的东西。

```
Logic                                    Attributes
--
BFG -> BFG, ∴ ...                       { B   FG}
BG -> C, ∴ BFG -> CF                    { BC  FG}
BFG -> CF and CF -> AE, ∴ BFG -> AE     {ABC EFG}
BFG -> AE,  ∴  BFG -> A
BFG -> A and ABG -> ED, ∴ BFG -> ED     {ABCDEFG} 
```

所以 BFG 是一个候选键。

# java - 如何使用添加到 netbeans 项目的 .jar 库中的类？

> ID：10182242
> 
> 赞同：2
> 
> 时间：2012-04-16T21:53:19.593
> 
> 标签：java, eclipse, netbeans, jar, packages

有人可以帮我解决这个问题吗？我有一个 abc.jar 文件。它里面包含 ABC.class 文件。我将 jar 文件添加到 netbeans 项目库中。但是当我写 ABC a=new ABC(); 时出现错误

错误：“找不到符号类 ABC”

有什么帮助吗？

编辑：当我单击库中的 ABC.class 文件时，我也可以看到 ABC 类的结构。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:50:26.277

答案：我发现如果 jar 只有默认包，您将无法在其中导入类。您需要在 jar 中包含默认以外的包才能导入它。您只能导入非默认包。带有默认包的东西在 Eclipse 中可以正常工作，但在 netbeans 中不能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:08:43.693

请记住使用 import 语句导入它。您可能应该阅读 jar 文件后面的文档。希望有一个使用示例 - 大部分都有。

# haskell - Haskell - 在列表中添加元组？

> ID：10182245
> 
> 赞同：1
> 
> 时间：2012-04-16T21:53:35.680
> 
> 标签：haskell

我在另一个列表中有一个元组列表，但在查找平均值时遇到了问题。

我已经检查了所提出的问题和互联网，但大多数时候它们不包括将所有元组加在一起和潜水。

我的列表元组列表是`[(String, Int)]`，我希望能够找到所有元组的平均值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T22:07:07.490

您可以使用 轻松将其转换为简单整数列表`map snd`。所以基本上，`sum $ map snd listOfTuples`把它们加在一起。（为了有效地计算平均值，您可能需要做一些更复杂的事情，但这应该会让您走上正确的轨道。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T01:28:01.890

此外，给定一个表单列表，`[(String,Int)]`您可以使用 unzip 函数，它具有类型

`[(a,b)] -> ([a],[b])`

因此，要获得看起来像 [(String,Int)] 的列表的平均值，您只需使用：

`(sum $ snd $ unzip myList) / length(myList)`

您需要更正类型，以便可以使用 fromIntegral 函数进行划分。

因此，您可以编写以下函数：

`average :: [(a,Int)] -> Double`

`average xs = (fromIntegral $ sum $ snd $ unzip xs) / (fromIntegral $ length xs)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T01:01:16.700

这是一次计算总和和长度的方法。

它不漂亮，但它有效。

```
averageTuples ts = let results = calculateSum ts 
    in (fst results)/(snd results)

calculateSum ts = foldr acc (0,0) $ zip (map snd ts) (repeat 1) where
    acc (x, y) (x', y') = (x+x', y+y')

main = print $ averageTuples [("foo", 1.09), ("bar", 2.6789), ("baz", 3.4)] 
```

请记住，`fromIntegral`如果您有所有 Ints 的列表，则可能必须使用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T22:06:04.147

如果你在网上搜索，你会发现很多`average :: (Real a, Fractional b) => [a] -> b`功能，[例如这里](https://stackoverflow.com/questions/2376981/haskell-types-frustrating-a-simple-average-function)。

所以你只需要一个 type 的函数`[(String, Int)] -> [Int]`，然后你就可以把两者放在一起。

# javascript - 最佳实践：向 authorize.net 提交表单（javascript？）

> ID：10182248
> 
> 赞同：0
> 
> 时间：2012-04-16T21:53:58.290
> 
> 标签：javascript, jquery, html, authorize.net

我正在使用 authorize.net 的 SIM 方法，它需要从用户的浏览器向其 TLS 主机提交一个普通表单。设置是在我的服务器上完成的，我只需要创建表单并在页面加载时自动发布它。

我希望它从浏览器中发布，以便用户可以在 authorize.net 的主机上填写信用卡信息并处理付款。我不想在我的服务器上使用任何信用卡信息。

在这个过程中，没有数据可供用户输入，也没有更多的选择，这一切都是在我们到达这里之前发生的。

当 onLoad() 完成时，似乎有点 jQuery 来触发提交。

这是解决问题的最佳方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T19:22:10.833

你甚至不需要 jQuery，因为它非常简单。一旦页面加载了您的表单，您只需要它自动提交您的表单。将此代码放在页面底部将为您执行此操作（假设表单名为`myform`）：

```
<script type="text/javascript">
    document.myform.submit();
</script> 
```

如果您愿意，可以轻松调整以使用 jQuery，但它应该给您正确的想法。

# objective-c - GCDAsyncUdpSocket 多播获取 HTTP 412 响应

> ID：10182253
> 
> 赞同：1
> 
> 时间：2012-04-16T21:54:33.330
> 
> 标签：objective-c, ios, http, udp, gcdasyncsocket

我正在构建一个发送多播消息 (SSDP) 并侦听来自实现该协议的设备的响应的 iOS 应用程序。我正在使用 GCDAsyncUdpSocket 创建 UDP 套接字来广播 SSDP 消息并接收响应。我遇到的问题是应用程序从网络上的所有设备接收到的消息是相同的：`HTTP 412`响应。

这是我的代码：

**初始化套接字**

```
@interface ViewController ()
{
    GCDAsyncUdpSocket *udpSocket;
}
@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    udpSocket = [[GCDAsyncUdpSocket alloc] initWithDelegate:self delegateQueue:dispatch_get_main_queue()];

    NSError *error = nil;

    if (![udpSocket bindToPort:0 error:&error])
    {
        NSLog(@"Error binding: %@", [error description]);
        return;
    }
    if (![udpSocket beginReceiving:&error])
    {
        NSLog(@"Error receiving: %@", [error description]);
        return;
    }

    [udpSocket enableBroadcast:YES error:&error];
    if (error != nil)
    {
        NSLog(@"Error enableing broadcast: %@", [error description]);
        return;
    }

    NSLog(@"Socket Created");
} 
```

**创建套接字**

```
- (IBAction)socketFind:(id)sender
{
    NSString *str = [[NSString alloc] initWithString:@"M-SEARCH * HTTP/1.1\r\nHOST: 239.255.255.250:1900\r\nMAN: \"ssdp discover\"\r\nMX: 3\r\nST: ssdp:all\r\nUSER-AGENT: iOS UPnP/1.1 TestApp/1.0\r\n\r\n"];
    NSData *data = [str dataUsingEncoding:NSUTF8StringEncoding];
    [udpSocket sendData:data toHost:@"239.255.255.250" port:1900 withTimeout:-1 tag:0];

    NSLog(@"Sent Data");
} 
```

**数据接收回调**

```
- (void)udpSocket:(GCDAsyncUdpSocket *)sock didReceiveData:(NSData *)data
      fromAddress:(NSData *)address
withFilterContext:(id)filterContext
{
    NSLog(@"Did Receive Data");
    NSString *msg = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    if (msg)
    {
        NSLog(@"Message: %@",msg);
    }
    else
    {
        NSString *host = nil;
        uint16_t port = 0;
        [GCDAsyncUdpSocket getHost:&host port:&port fromAddress:address];

        NSLog(@"Unknown Message: %@:%hu", host, port);
    }
} 
```

调用该`didReceiveData`函数时，我收到以下消息：

```
Message: HTTP/1.1 412 Precondition Failed

Connection:close

CONTENT-LENGTH:0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:09:05.997

这个问题与 M-Search 字符串有关。`sspd`我错过了and之间的冒号`discover`。如果您收到`412`回复，我会确保您正确格式化所有内容。原来，这是我的问题...

# javascript - 程序化 dijit 创建导致 dojo 事件链中断

> ID：10182258
> 
> 赞同：0
> 
> 时间：2012-04-16T21:54:50.717
> 
> 标签：javascript, onclick, dojo

我在处理 JS onClick 事件和 Dojo 时遇到了一些问题。我想要实现的是以某种方式编辑第一个内联单元格中的数据。

考虑这个 HTML：

```
<table class="datatable" id="officestable" name="officestable">
<tr>
<td>xxxxx</td>
<td>
    <button id="officeeditbtn3" data-dojo-type="dijit.form.Button" type="button" data-dojo-props="iconClass:'advanEditIcon',onClick: function() { editOfficeFieldInline(this, 3); }">Edit</button>
    <button id="officeconfigbtn3" data-dojo-type="dijit.form.Button" type="button" data-dojo-props="iconClass:'advanConfigIcon',onClick: function() { configOffice(this, 3); }">Config</button>
    <button id="officeremovebtn3" data-dojo-type="dijit.form.Button" type="button" data-dojo-props="iconClass:'advanRemoveIcon',onClick: function() { removeOffice(this, 3); }">Remove</button>
</td>
</tr> 
```

为了处理这一切，我在 javascript 中有以下（相关）方法。

```
function editOfficeFieldInline(buttonElem, officeid) {
var table = document.getElementById("officestable"); //get table
var operationsCell = buttonElem.domNode.parentNode; // get second cell where button are
var trline = operationsCell.parentNode; // get tr element
var dataCell = trline.firstChild;  // get cell where data is to be edited
var currentContent = dataCell.innerHTML;  // ... self explainable...

var tdcellHTML;
tdcellHTML = "<input id=\"editofficebox\" type=\"text\">";  // adding an input placeholder

dataCell.innerHTML = tdcellHTML;  //  replace cell content with edit box

    //  attach dijit to pre-created edit box
var editofficebox = new dijit.form.TextBox({
                                    value: currentContent,
                                    style: {
                                        width: "190px",
                                        }
                                    },
                                    "editofficebox");

addSaveCancelButtons(table,
                    operationsCell,
                    function(){
                        //  'save' actions
                        //  save new data using ajax (working!)
                        saveOfficeName(officeid, dataCell, currentContent, operationsCell);
                        },
                    function(){
                        // 'cancel' actions
                        destroyOfficeFieldInline(table, false);
                        setCellVal(dataCell, currentContent);
                        }
                    );
}

function addSaveCancelButtons(table, operationsCell, saveAction, cancelAction) {
    operationsCell.innerHTML += "<button id=\"savebutton\">Save</button>";
    operationsCell.innerHTML += "<button id=\"cancelbutton\">Cancel</button>";

    var savebutton = new dijit.form.Button({
            iconClass: "advanSaveIcon",
            onClick: saveAction
            },
            "savebutton");

    var cancelbutton = new dijit.form.Button({
            iconClass: "advanCancelIcon",
            onClick: cancelAction,
            },
            "cancelbutton");
}

// this is a generic function. parameters are not really needed in this case
function destroyOfficeFieldInline(tableElement, bNew) {
    dijit.byId("editofficebox").destroy();
    destroySaveCancelButtons();
    if (bNew) {
        destroyNewRow(tableElement);
        }
}

function destroySaveCancelButtons() {
    dijit.byId("savebutton").destroy();
    dijit.byId("cancelbutton").destroy();
}

function setCellVal(cell, val) {
    cell.innerHTML = val;
} 
```

现在，代码第一次工作。但是不知何故，如果我在单击“编辑”后单击“取消”，那么再次按“编辑”将无济于事。不会再次创建动态字段。我猜有些东西没有被正确清理，但我没有想法......这段代码有什么问题？

PS.我对实现这一目标的替代方法持开放态度......

[编辑]

我发现这些似乎是有问题的代码行：

```
operationsCell.innerHTML += "<button id=\"savebutton\">Save</button>";
operationsCell.innerHTML += "<button id=\"cancelbutton\">Cancel</button>"; 
```

一旦第一个被执行，单元格内的所有按钮都会失去它们的事件监听器，即 onclick。

有谁知道这是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T07:21:51.323

可能这个会帮助你..

首先，您必须将按钮的 id 存储在 temp 变量中，并且您必须使用该变量来销毁控件

例如

```
var temp = dijit.byId('savebutton');
temp.destroy(); 
```

我希望这能帮到您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:12:20.903

行。刚刚弄清楚发生了什么（在 Dojo 社区的帮助下），所以我回到这里分享解决方案。

innerHTMl （据说）附加了新的按钮标签，但实际上它已被替换，因为 += 运算符的工作方式。替换时，原始内容被销毁，然后重新创建，但这次没有事件侦听器/事件。

因此，解决方案是使用 dijit placeAt 方法：

```
function addSaveCancelButtons(table, operationsCell, saveAction, cancelAction) {
var savebutton = new dijit.form.Button({
    id: "savebutton",
    iconClass: "advanSaveIcon",
    label: "Guardar",
    onClick: saveAction
    }).placeAt(operationsCell);

var cancelbutton = new dijit.form.Button({
    id: "cancelbutton",
    iconClass: "advanCancelIcon",
    label: "Cancelar",
    onClick: cancelAction,
    }).placeAt(operationsCell);
} 
```

# jquery - jQuery - 动画不适用于 z-index

> ID：10182260
> 
> 赞同：0
> 
> 时间：2012-04-16T21:54:56.977
> 
> 标签：jquery, jquery-animate, z-index

我想在鼠标悬停时为两个滑块设置动画。当我不给幻灯片一个 z-index 以将它们隐藏在包装器后面时，这很好用。但是当我这样做时，动画不再起作用。

这就是我所说的：http: [//jsfiddle.net/dW85E/3/](http://jsfiddle.net/dW85E/3/)

任何建议如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:09:07.797

我注意到如果你给包装器一个绝对定位它确实有效：http: [//jsfiddle.net/dW85E/5/](http://jsfiddle.net/dW85E/5/)

# java - 如何在 java webapp 中防止空字节注入

> ID：10182261
> 
> 赞同：0
> 
> 时间：2012-04-16T21:54:59.210
> 
> 标签：java, security, web-applications, xss

如何在 java webapp 上完成空字节注入，或者更确切地说 - 如何防止它？

我应该查看请求参数的每个字节并将其“字节”值检查为 0 吗？我无法想象在请求参数中潜入一个 0 字节......可以吗？

我的主要目的是确保用于保存文件的文件名足够安全。现在，我没有寻找推荐的答案（例如）：用下划线替换所有非单词字符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:41:54.913

允许用户以任意名称存储文件是危险的。如果用户提供 会发生什么`"../../../WINDOWS/explorer.exe"`？您应该将文件名限制为仅包含已知无害的字符。

`'\0'`不知道是无害的。就 Java 而言，`'\0'`它是一个和其他任何字符一样的字符。但是，操作系统可能会将其解释`'\0'`为字符串的结尾。如果一个字符串从 Java 传递到操作系统，那么不同的解释可能会导致可利用的错误。考虑：

```
if (filename.endsWith(".txt") {
    store(filename, data);
} 
```

其中文件名是“C:\Windows\explorer.exe\0.txt”，Java 以“.txt”结尾，操作系统以“.exe”结尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T21:59:55.743

我不确定你为什么关心空字节注入。Java 不像 C/C++，其中的字符串是以 null 结尾的字符数组。

您应该绑定和验证来自 Web 层的参数和值。你如何定义“足够安全”？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-21T20:52:21.740

您有 2 个选择：

1**扫描字符串（首先将其转换为 char 数组）以查找空字节。**

2 升级到 Java 8 或 Java 7u40 并受到保护。（是的，我测试过！，它有效！）

1013 年 5 月，Oracle 修复了该问题：[http ://bugs.java.com/bugdatabase/view_bug.do?bug_id=8014846](http://bugs.java.com/bugdatabase/view_bug.do?bug_id=8014846)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-22T14:22:09.053

Java 7 更新 40（2013 年 9 月左右发布）中修复了文件名中的空字节注入。所以，它现在已经修复了一段时间，但它是一个十多年的问题，它是 Java 中的一个 NASTY 漏洞。修复记录在这里：[http ://bugs.java.com/bugdatabase/view_bug.do?bug_id=8014846](http://bugs.java.com/bugdatabase/view_bug.do?bug_id=8014846)

——戴夫·威彻斯

# c++ - 内存管理混乱 C++

> ID：10182267
> 
> 赞同：2
> 
> 时间：2012-04-16T21:55:27.000
> 
> 标签：c++, pointers, memory-management, dynamic

我无法理解 C++ 中的一些基本内存管理原则。此代码是循环的一部分，循环是将迷宫文件读入二维向量的函数的一部分。

根据 Valgrind 的说法，以下代码导致内存泄漏......

请注意，它`t`是一个`MazeNode`对象，并且`verts`是`t`类中的一个向量，其中包含指向节点对象的指针（不要与`MazeNode`对象混淆）：

```
node* top = new node(TOP, rowCount, i, t.type);
node* bot = new node(BOTTOM, rowCount, i, t.type);
node* left = new node(LEFT, rowCount, i,  t.type);
node* right = new node(RIGHT, rowCount, i, t.type);

t.verts.push_back(top);
t.verts.push_back(bot);
t.verts.push_back(left);
t.verts.push_back(right);

temp.push_back(t);

top = NULL;
bot = NULL;
left = NULL;
right = NULL;
delete top;
delete bot;
delete left;
delete right; 
```

最初我在删除它们之前没有将每个指针设置为 NULL，但会出现分配错误。所以我只是将它们设置为 NULL 并且我的代码有效。我想我真的很困惑为什么这会导致内存泄漏以及为什么我需要将指针设置为 NULL。可能有一种更简单的非指针方法可以做到这一点，但也许这个问题会帮助我更好地理解内存管理。

谢谢大家。

编辑：这是 MazeNode 类（这就是“t”）（也请原谅我写这个类的懒惰，让一切都像结构一样公开）

```
class MazeNode 
{
public:
    void setType(char c);
    char getChar();

    NodeType type;
    vector<Direction> visitedFrom;

    vector<node*> verts;
}; 
```

和节点类：

```
class node
{
public:
    node();
    node(Direction d, int r, int c, NodeType t);
    ~node(); //empty definition
    node(const node* n);
    node& operator=(const node& n);

    void addAdj(node* a, int w);
    void printAdj() const;
    string direction() const;

    void print() const;
    bool operator<(const node& n) const;

    int distance; //from start
    bool visited;
    node* prev;
    vector<Edge> adj;
    Direction dir;
    int row, col;
    NodeType type;
}; 
```

EDIT2：谢谢大家。我现在明白了这个问题。我更改了指针对象的向量，以便不再使用指针。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-16T22:00:49.143

在添加空分配之前，您的代码有一个与内存泄漏不同（更糟）的问题：存储并且可能还使用了一个杂散指针，即指向已释放内存的指针。

通过添加空分配使其成为内存泄漏会使其变得更好，但不会太多。

真正的解决方案是在调用 delete 之后不要在任何地方保留任何指针。也就是说，不要`push_back`或不要`delete`在这里。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-16T22:04:10.050

您将指针放入容器中，然后删除指针。当您的代码稍后尝试使用这些指针时，它们无效并导致崩溃。

通过在删除它们之前将指针设置为 NULL，您最终根本不会删除它们 - 删除 NULL 指针不会做任何事情。但是现在以后没有什么可以删除对象了，而且你会遇到内存泄漏。

您需要在代码中找到不再使用指针的位置，然后将其删除。

编辑：当然我应该提到一个智能指针，比如`std::shared_ptr`完全消除了这个麻烦，因为它会自动删除对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-16T21:57:45.740

您在删除它们之前将值设置为 NULL，因此您尝试删除 NULL 并且没有任何内容被删除。尝试将删除调用移到 NULL 调用之上。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-16T21:59:59.173

这种困惑正是我为这些事情创建宏的原因：

```
#define delobj(obj) (delete obj, obj = NULL) 
```

你会像这样使用它：

```
delobj(top);
delobj(bot);
delobj(left);
delobj(right); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-16T22:06:20.593

错误是使用指针向量。据你说， verts 是这样的：

```
vector<node*> verts; 
```

但它应该是这样的：

```
vector<node> verts; 
```

在第一种情况下，当您 push_back() 指针时，没关系，但是当您 pop_back 或以其他方式重新调整向量的大小时，指针是向量的“内容”，并且被取消分配，但不是指针指向，也就是节点。因此节点泄漏。但在第二种情况下，节点是向量的“一部分”，并且在重新调整向量大小的过程中被分配/解除分配。

您在此处的模式可能表示 Java/C# 背景，因为在这些语言中“新建”到容器中非常常见，但要在 C++ 中做到这一点，您需要一个智能指针容器（比如`vector<shared_ptr<node>>`或其他东西），即可能超出了问题的范围。但是在那些语言中，对引用类型的每个引用都是一个“智能指针”（或多或少），因此这是自动完成的。C++ 不是这样的。

您要么需要更改代码以使用 a `vector<node>`（并更改您推回它的方式），要么需要在向量缩小时显式取消分配节点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-16T21:59:19.977

改成：

```
delete top;
delete bot;
delete left;
delete right;

top = NULL;
bot = NULL;
left = NULL;
right = NULL; 
```

它应该工作。

# objective-c - 纹理别名和 spritesheet 之间的区别

> ID：10182271
> 
> 赞同：1
> 
> 时间：2012-04-16T21:55:42.573
> 
> 标签：objective-c, ios, cocos2d-iphone

iOS中的纹理别名和精灵表有什么区别？它们是一回事吗？

# php - 在类中设置变量时使用外部函数

> ID：10182276
> 
> 赞同：1
> 
> 时间：2012-04-16T21:56:04.970
> 
> 标签：php, class, gettext

我正在尝试在我的类中设置一些默认值，但不能使用 gettext 作为变量值

为什么这段代码会给我一个错误？

```
class Test
{
    private $defaultoptions = array('HideOwnPosts' => false,
                                    'HideClickedLinks' => false,
                                    'AutoCommentLinks' => false,
                                    'AutoCommentText' => gettext('exampletext'),
                                    'AutoOpenCount' => 5);
} 
```

我只需要依赖于我使用 gettext für i18n 的用户语言的默认值，所以我也想在这里使用 ist。

[http://codepad.org/PTlIelQ4](http://codepad.org/PTlIelQ4)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-16T21:57:37.520

您不能使用“动态”结果 ( `gettext()`) 启动类成员。只允许使用静态值。如果您需要使用函数的结果来初始化成员，那么您必须在构造函数中进行，而不是在类定义中进行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T22:28:14.753

试试这个：

```
<?php
class Test
{
    private $defaultoptions = array('HideOwnPosts' => false,
                                    'HideClickedLinks' => false,
                                    'AutoCommentLinks' => false,
                                    'AutoCommentText' => false,
                                    'AutoOpenCount' => 5);
    public function __construct() {
        $this->defaultoptions['AutoCommentText'] = gettext('exampletext');
    }
} 
```

# vb.net - 在vb中更改字符串的字体颜色

> ID：10182278
> 
> 赞同：0
> 
> 时间：2012-04-16T21:56:13.020
> 
> 标签：vb.net

如何更改字符串的字体颜色。我设置了保存字符串的标签的前景色属性，但似乎只有当字符串显示在该标签中时才有效。有没有一种方法可以设置字符串本身的颜色，使其默认显示具有该颜色的任何位置。我实际上是将此字符串作为电子邮件发送，但想以某种方式对其进行格式化，使其显示方式有所不同，但事实并非如此。有任何想法吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:02:47.750

无法在字符串的属性中设置它。但是，您也许可以通过 html 将信息作为字符串本身的文本的一部分：

```
<font color="red">你的字符串的其余部分在这里</font>
```

# php - 在服务器上保存信息并取回

> ID：10182280
> 
> 赞同：-1
> 
> 时间：2012-04-16T21:56:22.313
> 
> 标签：php, ajax, database

在我的网站上，我从表单中获取用户输入，并将其添加到查询插件中以在屏幕上输出。很高兴获得用户输入，但是一旦我刷新页面，所有输入都会丢失并重置。我如何保存用户输入，以便即使刷新页面，数据也会永久保留在那里？你能用我的代码给我看吗？

```
<html>
 <head>

<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="textualizer.min.js"></script>
</head>

<style type="text/css">

#txtlzr{color:#585856; font-size:50px; width:1200px; height:100px;
margin-left:10%;
margin-top:80px;
font-family:"futura";
position: fixed;
}
 </style>

<body>

   <div id="txtlzr"></div>
    <form action="#" method="post"/>
      <fieldset>
       <label for="kwote">Comment:</label>
       <input class="kwote" type="text" maxlength="40" id="kwote"
         placeholder="Enter a something here."/>
       <lable for="name">Name:</label>
       <input class="name" type="text" maxlength="17" id="name"
         placeholder="Enter your name."/>
       <input class="post" type="button" value="Add comment"
         onclick="add_comment();" />
     </fieldset>
   </form>

 <script language="javascript">
    var COMMENTS_FOR_DISPLAY = new Array('Thanks for the help: nick');

    // Adds a new comment, name pair to the Array feeding textualizer.
    function add_comment() {
      // Retrieve values and add them to Array.
      var new_comment = $('#kwote').val();
      COMMENTS_FOR_DISPLAY.push(new_comment + ': ' + new_name);

      // Reset <input> fields.
      $('#kwote').val('');
      $('#name').val('');
    }

    $(document).ready(function() {
      var txt = $('#txtlzr');  // The container in which to render the list

       var options = {
        rearrangeDuration: 5, // Time a character takes to reach its position
        effect: 'random',     // Animation effect the characters use to appear
        centered: true        // Centers the text relative to its container
  }

  txt.textualizer(COMMENTS_FOR_DISPLAY); // textualize it!
  txt.textualizer('start'); // start
});
</script>
  </body>
</html>
 </html> 
```

感谢克里斯顺便说一句帮助我输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:01:04.790

除了页面上的代码之外，还有很多其他内容。您必须拥有一种服务器端语言并对数据库服务器进行写入访问，然后才能执行其他任何操作。

如果你没有选择语言和平台，你可以看看[Flask 教程](http://flask.pocoo.org/docs/tutorial/)或[Django 教程。](https://docs.djangoproject.com/en/1.4/intro/tutorial01/)两者都需要您设置服务器，但使用 SQLite，一个基于文件的数据库系统，因此您还不需要处理找出数据库服务器。

# java - onCompletion() 顺序在骆驼 DSL 中是否重要？

> ID：10182281
> 
> 赞同：1
> 
> 时间：2012-04-16T21:56:23.127
> 
> 标签：java, activemq, apache-camel

我正在尝试在消息上设置一些标头，该消息在通过我的骆驼 DSL 中的处理器引用时被操纵。然而，我拥有的第一件事是.onCompletion 的处理器，它应该从交换中读取消息，获取标题并记录它们。

这必须在我的 DSL 中排在最后吗？看来我最后的 .process() 处理器可以看到我通过其余代码添加的所有新标头值，但是当我将它们全部记录在 .onCompletion 时，这些标头的值为空。这几乎就像它有一个过时的消息或交换或其他东西。为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T10:57:24.607

是的，您应该配置诸如

*   在结束的时候
*   异常
*   截距
*   错误处理程序
*   成交
*   政策
*   ETC

在您的路线*开始时。*然而 DSL 是 Camel 2.x 非常开放，因此您可以在某些地方在其他地方配置它（例如，不在开始时）。但经验法则是首先做到这一点。然后在那之后，你的常规路线。

> **旁注：请**注意，Camel 还允许您在全局级别（又称上下文范围）而不是路由上配置这些类型。例如，您可以有一个上下文范围的错误处理程序。然后只有在一个特殊的路由覆盖并且有一个路由特殊的错误处理程序。

在 Camel 3.0 以后，我们将使 DSL 更加严格，因此我们在一开始就强制执行配置。这也减少了您在常规路线中的代码帮助列表（例如按 ctrl + 空格）中看到的方法数量。因为这些配置将不再列出。

它们出现的原因是它们继承了同一个基类，这是 DSL 的基石。我们不想在当前的 2.x 行中打破这一点，因为那样有些人可能会受到影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:17:17.290

订单应该无关紧要...当路线完成时，它应该使用 Exchange 的副本，无论如何...发布您的路线，我们也许可以提供更多帮助

# c# - C# Web 服务响应数组

> ID：10182282
> 
> 赞同：1
> 
> 时间：2012-04-16T21:56:33.883
> 
> 标签：c#, xml, arrays, web-services, serialization

我最近使用 C# 构建了一个 Web 服务客户端。我选择 C# 是因为 Web 服务组件功能强大且易于使用（比 Gsoap 或 Axis IMO 更易于使用）。

我的 C# 应用程序在后台运行，并且应该返回我的应用程序的其他部分（包括 Web 应用程序、PLC 和数据库）可以存储和使用的数据。

我的回复看起来像这样：

```
[
 [
     string
     int
     []
 ]
 string
 []
 int
] 
```

ETC...

关键是返回值并不简单。我的问题是从我的应用程序的其他部分重新格式化和使用这些数据的最佳方法是什么？

我的选择是：

1.  XML
2.  JSON

我已经检查了这两条路线，但还没有找到序列化这些数据的好方法。任何人都可以提供任何建议吗？

在最坏的情况下，我可能只需要创建一个通用例程来使用 StringBuilder 构建 XML，但我希望有一些我还不知道的东西（我是 C# 的新手），这将使我的生活变得轻松。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:04:33.603

你肯定可以使用 JSON。

使用`JavaScriptSerializer`该类来序列化数据和您的确定：http: [//msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)

```
var data = new { name = "someValue", id = 1 };

var json = new System.Web.Script.Serialization.JavaScriptSerializer();

return json.Serialize(data); 
```

我还没有测试过这段代码（我现在不在我的开发机器上），但我确信它可以根据您的需要进行一些调整。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T22:09:32.833

为什么不为返回值创建 DTO 类并使用 JSON 或 XML 序列化？非常方便。

# vb.net - VB.Net 和 VS 2010 将变量附加到 URL

> ID：10182289
> 
> 赞同：0
> 
> 时间：2012-04-16T21:57:08.633
> 
> 标签：vb.net, visual-studio-2010

我是一个新手，正在编写我的第一个应用程序。我需要以下帮助：我需要检索 = GID 的登录用户，然后我需要将其附加到将启动我们的帮助台聊天客户端的 URL。我可以很容易地检索 GID，但不知道如何附加它并通过 URL 传递它。我发现了一个帖子，它指示将 url 也声明为字符串并将其连接起来。用户名将跟在 URL 末尾的“:”后面。

```
Private Sub GID()
        Dim GID As String
        GID = System.Environment.UserName

        '  System.Diagnostics.Process.Start("http://www.myurl.com/eschat/arhome.html?login=m:uid~uid:") 
```

我们从 HelpDesk 站点使用 javascript 来执行此操作，但我需要对其进行调整以在我的应用程序中工作。任何帮助将不胜感激，我希望我的问题是有道理的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T04:16:38.480

您可以使用 '&' 在 VB.NET 中连接字符串，如下所示：

```
Dim GID as String
GID =  System.Environment.UserName
Dim URL as String
URL = "http://www.myurl.com/eschat/arhome.html?login=m:uid~uid:"

System.Diagnostics.Process.Start(URL & GID) 
```

您也可以像这样将变量插入到字符串中

```
URL = String.Format("http://www.myurl.com/eschat/arhome.html?login=m:uid~uid:{0}", GID) 
```

并且 GID 将放置在“{0}”所在的任何位置，这也可以用于多个参数，您只需增加花括号内的数字，例如“{1}”、“{2}”。

MSDN 文章[在这里](http://msdn.microsoft.com/en-us/library/system.string.format.aspx#Y200)。

# jquery - 选择一个不包含 src 中单词的 img

> ID：10182290
> 
> 赞同：3
> 
> 时间：2012-04-16T21:57:16.260
> 
> 标签：jquery, selector

如果我有 4 张图片

```
<img src="img/tracker/"/>
<img src="img/tracked/"/>
<img src="img/tracking/"/>
<img src="img/track/"/> 
```

我如何使用 src 选择最后 3 张图像不包含我尝试过`$(img:not([src*="/tracker/"]))`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-16T21:59:10.233

```
$('img:not([src*="/tracker/"])')... 
```

*   选择器应该是一个字符串。

[**现场演示**](http://jsfiddle.net/8pHXw/2)

# c# - 在 C# 中实现公共接口的问题

> ID：10182291
> 
> 赞同：0
> 
> 时间：2012-04-16T21:57:21.110
> 
> 标签：c#, interface

C# 类库 - 针对 .NET2 框架。

我正在尝试在一个小类中实现一个公共接口（从第二个引用程序集公开）。该接口只有 3 种方法：一种很好，但由于某种原因，如果编译器不抱怨每个方法，我就无法实现另外两种方法：

*   我的班级“没有实现 InterFaceName.MethodName”
*   “显式接口声明中的InterFaceName.MethodName 不是接口的成员”。

编译的一种方法与其他两种方法之间的唯一区别是问题方法每个都有一个参数，该参数是 Office Interop (Word) 类型。其他参数要么是布尔型，要么是其他公共接口的成员。

如果有帮助，我可以在此处添加我的类定义，但我需要做一些解释，因为我不是另一个程序集的“所有者”（它是一个商业产品），我不确定他们的感受关于我“暴露”它...

我知道这有点模糊，但我希望以前有人遇到过这种错误。

感谢您的任何指示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:00:14.277

如果引用的程序集是针对不同版本的 Office 互操作程序集构建的，则通常会发生这种情况。

结果，即使在视觉上为“MethodName”声明的参数可能看起来与引用程序集的接口匹配，但由于程序集版本不同，方法声明实际上与引用程序集的声明不匹配。

仔细检查您使用的是完全相同版本的互操作程序集。

# python - mplayerctrl 进程屏幕问题

> ID：10182293
> 
> 赞同：0
> 
> 时间：2012-04-16T21:57:24.617
> 
> 标签：python, windows, wxpython

当我尝试通过双击“.py”文件来运行应用程序时，python 控制台屏幕会像往常一样弹出。为了防止它，我将扩展名更改为“.pyw”，但随后会弹出 mplayer.exe 控制台屏幕。我怎样才能隐藏那个屏幕。

这是屏幕截图

[http://i.imgur.com/srn9y.png](http://i.imgur.com/srn9y.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-10T15:36:13.513

该问题不再存在于[https://bitbucket.org/dav1d/mplayerctrl/commits/c680a1d99ad2/下面的修复](https://bitbucket.org/dav1d/mplayerctrl/commits/c680a1d99ad2/)

# html - 段落末尾的 CSS 块定位

> ID：10182302
> 
> 赞同：2
> 
> 时间：2012-04-16T21:57:53.073
> 
> 标签：html, css, dijkstra

我正在尝试转录一些 Edsger Dijkstra 教授的 EWD，但遇到了一个小问题。在他的写作中，他喜欢在段落末尾放置诸如“证明结束”之类的注释，当有空间时右对齐，否则放在下一行。我想重新创建这种格式，但似乎无法这样做。我真的更喜欢只使用 CSS 的解决方案，但如果这被证明是不可能的，那么 JavaScript 也是允许的。

请参阅[http://www.cs.utexas.edu/users/EWD/ewd10xx/EWD1001.PDF](http://www.cs.utexas.edu/users/EWD/ewd10xx/EWD1001.PDF)第 0 页（PDF 第 2 页）注释“Legenda 结束”和第 3 页（PDF 第 5 页）评论“评论结束”。

我尝试过使用`block / float: right`@starx 回答的 display: combo 。但是，由于它是一个浮点数，它不会将其余的文本向下移动。查看源文档，格式似乎是临时的，但似乎 Dijkstra 喜欢尽可能将其保持在同一行，或者将其移动到下一个，右对齐，如果不是。

搜索了不同的 CSS 规范，但我还无法理解实现此目的的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:00:58.347

`block`假设，你正在给元素上课。

```
.block {
    display: block;
    width: 200px; /* minimum needed to be inline */
    float: right; 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T14:50:20.107

我的建议是使用`:after`伪元素在相应段落的末尾添加标题：

```
.remark:after {
    content: 'End of Remark';
    color: red;
    display: inline-block;
    float: right;
} 
```

示例：[http ://dabblet.com/gist/2406457](http://dabblet.com/gist/2406457)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T22:38:27.557

如果此文`(End of sth)`本必须在自己的行上，则将其设为一个块（如果它是段落或 HTML5`footer`元素，它可能已经是一个块，但它不会更改任何内容；））并将文本与`text-align: right;`.
如果文本不是完全 100% 正确，那么您可以使用它的`width`或使用`padding-right`：

```
.end_of {
  display: block;
  text-align: right;
  padding-right: 20px;
} 
```

编辑：默认情况下，呈现为块的元素是 100% 宽。没有浮点数，不需要从任何浮点数中清除下一个元素或从以前的浮点数中清除块元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T15:18:43.357

如果将多余的内容向右浮动，还需要清除浮动，否则多余的内容会与其余的文本冲突。

所以这是我的解决方案。在所有主流浏览器上测试。

```
.theEnd:after {
 display:block;
 content:'End of Latin';
 text-align:right;
 white-space:nowrap;
 padding-left:1em;
 float:right;
}

.theEnd + * {clear:right} 
```

请参阅[jsFiddle](http://jsfiddle.net/drb4S/4/)。

# git - git pull 到 branch_1 并同时合并到当前分支

> ID：10182303
> 
> 赞同：3
> 
> 时间：2012-04-16T21:58:06.520
> 
> 标签：git, merge, git-checkout

我环顾四周，但没有看到这个确切的问题得到回答，所以我开始了：

```
git checkout master
git checkout -b release1
git checkout -b feature1
git checkout -b feature2 
```

我在做`feature1`，别人在做`feature2`，都被推到原点

```
git checkout -b feature1
git pull
git checkout -b feature2
git pull 
```

问题 1：我可以从它们各自的本地分支机构的来源`feature1`和`feature2`各自的本地分支机构中提取最新的信息，而无需单独检查它们并单独提取它们吗？

继续前进。. .

```
git checkout release1
git merge feature1
git merge feature2 
```

其他人确实在工作`feature2`。

问题2：我想将最新的原始分支合并`feature2`到我当前的`release1`分支中，而不是切换分支来拉取它，然后再次切换到合并它。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:56:07.133

没有办法解决（除了极端的 g​​it hacking），合并另一个分支的提交，无论是远程（`git pull`）还是本地（`git merge`），都意味着签出“目标”分支。

# ruby-on-rails - 使用 OpenXML 或其他格式在 Apple Pages 中创建简单报告

> ID：10182304
> 
> 赞同：0
> 
> 时间：2012-04-16T21:58:12.687
> 
> 标签：ruby-on-rails, ms-word, openxml

我对将一些信息从 Rails Web 应用程序输出到 Apple Pages 文档很感兴趣。我以前从来没有这样做过。据说，Apple Pages 支持 OpenXML。是否有合适的现代宝石可以帮助做到这一点？有没有比 OpenXML 更简单的方法来编写页面文件？Apple Pages 和 Microsoft Word 之间的 OpenXML 文档是否兼容？此处的信息[http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2009/07/02/5389.aspx](http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2009/07/02/5389.aspx)是否与 Apple Pages 文档相关？

我知道这是一个有点模糊的问题 - 我已经查看了一些资源，例如这个问题[在 Ruby 中创建 Microsoft Word (.docx) 文档，](https://stackoverflow.com/questions/697505/creating-microsoft-word-docx-documents-in-ruby)但它们似乎并没有为我想要实现的目标增加太多。似乎不可能将 Pages 文档另存为 Word docx（只是一个文档），所以我什至不确定使用 OpenXML 是否可行。

一个建议是使用 Azure AWS 实例并向其发布数据，该实例将具有 OpenXML sdk。

解决这个问题的合理/最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:00:53.413

[在 Ruby 中创建 Microsoft Word (.docx) 文档](https://stackoverflow.com/questions/697505/creating-microsoft-word-docx-documents-in-ruby)

也许安装支持 OpenXML 和 IronRuby 的 Mono。但是，直接使用 C# 要容易得多。

# android - Android 生成哈希字符串 sha256

> ID：10182310
> 
> 赞同：2
> 
> 时间：2012-04-16T21:58:38.613
> 
> 标签：android, hash

我正在尝试加密 url 请求、用户名和密码，然后将其发布到网页。

但是由于某种原因，eclipse说语法错误，我做错了什么？它是底部的位，它说`md.update`导致错误。

到目前为止，这是我的代码：

```
private static final String apiKey = "38m8nyev284nddci49940303094"; 
private static final String apiUser = "esdt34ds"; 

long unixTimeStamp = System.currentTimeMillis() / 1000L;

String newFeedRequest = "1.0/evoStructure?timestamp=" + unixTimeStamp;
String fixturesFeedURL = "https://secure.website.com/_services/api/" + newFeedRequest;

MessageDigest md = MessageDigest.getInstance("SHA-256");

md.update(fixturesFeedURL.getBytes("UTF-8"),apiKey.getBytes("UTF-8"),apiUser.getBytes("UTF-8")); // Change this to "UTF-16" if needed
byte[] digest = md.digest(); 
```

这是我得到的错误：

> 此行有多个标记
> 
> *   语法错误，插入“Type VariableDeclaratorId”完成FormalParameterList
> *   令牌“更新”的语法错误，此令牌后应有标识符
> *   令牌上的语法错误，应改为 AnnotationName
> *   令牌“，”的语法错误，@预期
> *   令牌“，”的语法错误，@预期

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:10:23.593

这是一个神秘的错误。但我会说你没有为 update() 使用正确的参数

[http://developer.android.com/reference/java/security/MessageDigest.html](http://developer.android.com/reference/java/security/MessageDigest.html)

API 显示 update(ByteBuffer)、update(byte[], int, int)、update(byte[])、update(byte)。看不到任何需要 (byte[], byte[], byte[]) 尝试调用

`md.update(fixturesFeedURL.getBytes("UTF-8"));`

`md.update(apiKey.getBytes("UTF-8"));`

`md.update(apiUser.getBytes("UTF-8"));`

反而

# jquery - 通过 jQuery 更新值

> ID：10182313
> 
> 赞同：0
> 
> 时间：2012-04-16T21:59:10.423
> 
> 标签：jquery, asp.net, ajax, linq

我在 Asp.net webform 上放置了一个名为 LabelTotalNumber 的标签。我想通过 jQuery 每分钟更新一个值而不刷新表单。我该怎么做？

我可以在 Page_Load 事件中这样做一次。

```
var sqlResult = (From obj in db.RequestList
                 where obj.IsApproved == "Approved"
                 select obj).count();
LabelTotalNumber.text = sqlResult; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:02:04.897

开箱即用您可以使用[UpdatePanel 和 Timer](http://msdn.microsoft.com/en-us/library/cc295400.aspx)。

如果您不喜欢 Microsoft 框的内容并想使用 jQuery/javascript，您可以定期（使用该[`window.setInterval`](https://developer.mozilla.org/en/DOM/window.setInterval)方法）向[ASP.NET PageMethod](http://encosia.com/using-jquery-to-directly-call-aspnet-ajax-page-methods/)发送 AJAX 请求（在这种情况下，基本上您将不得不给自己一点阅读 jQuery 的[文档](http://docs.jquery.com/Main_Page)/[教程](http://docs.jquery.com/Tutorials)并编写一些代码很痛苦）。

所以一个 ASP.NET PageMethod：

```
[WebMethod]
public static int Approved()
{
    return (from obj in db.RequestList
            where obj.IsApproved == "Approved"
            select obj).Count();
} 
```

然后每隔一分钟左右用 AJAX 请求敲击这个 PageMethod：

```
window.setInterval(function() {
    $.ajax({
        url: '/foo.aspx/Approved',
        type: 'POST',
        contentType: 'application/json',
        data: '{ }',
        success: function(result) {
            var count = result.d;
            // TODO: do something with the count returned by the server
            // like assigning it to a label or something:
            $('#someLabelId').html(count);
        }
    });
}, 60 * 1000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:07:09.653

您可以使用 jQuery ajax 来调用可以执行数据库操作的服务器页面。使用 setInterval 方法以特定间隔执行脚本。

```
var tid = setInterval(UpdateData, 60000);
function UpdateData() {
  $.get("yourserverpage.ashx",function(data){
   $("#yourDiv").html(data)
 });
} 
```

Assumung`yourserverpage.ashx`将在调用时处理您的数据库更新，并且 yourDiv 是您要显示更新数据的 div（假设`yourserverpage.ashx`返回要显示的标记。

# c++ - 对文件夹中的每个文件应用正则表达式搜索

> ID：10182316
> 
> 赞同：0
> 
> 时间：2012-04-16T21:59:18.020
> 
> 标签：c++, regex, directory

我必须编写一个程序来遍历给定的文件夹并使用 regex_search 来查找某个字符串的每个实例。我现在已经让 regex_search 自己工作了，我只是想弄清楚如何浏览每个文件。我想尝试使用目录，但不确定我会把它放在哪里。我是否必须将搜索文件放入我的 main 方法中，还是必须在 main 方法之外创建一个单独的函数来遍历每个文件并在 main 方法中调用它？

这就是我现在所拥有的。你们可以就如何解决这个问题提供任何提示，我们将不胜感激！

现在它的功能是读取输入文本文件并输出一个 txt 文件，该文件显示所有实例和每个外观的行号。我不需要查看它们所在的行、使用特定文件或为该程序制作输出文件，我发现的内容将简单地打印到控制台。我已经留下了我现在拥有的东西，因为我不确定我是否会以类似的方式检查每个单独的文件，只是使用不同的 cariable 名称。

```
#include <iostream>
#include <regex>
#include <string>
#include <fstream>
#include <vector>
#include <regex>
#include <iomanip>

using namespace std;

int main (int argc, char* argv[]){

// validate the command line info
if( argc < 2 ) {
    cout << "Error: Incorrect number of command line arguments\n"
            "Usage: grep\n";
    return EXIT_FAILURE;
}

//Declare the arguments of the array
    string resultSwitch = argv[1]; 
string stringToGrep = argv[2];
string folderName = argv [3];
regex reg(stringToGrep);

// Validate that the file is there and open it
ifstream infile( inputFileName );
if( !infile ) {
    cout << "Error: failed to open <" << inputFileName << ">\n"
            "Check filename, path, or it doesn't exist.\n";
    return EXIT_FAILURE;
}

while(getline(infile,currentLine))
{
    lines.push_back( currentLine ); 
            currentLineNum++;
            if( regex_search( currentLine, reg ) )
                    outFile << "Line " << currentLineNum << ": " << currentLine << endl;

}

    infile.close();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:37:39.480

读取目录/文件夹取决于操作系统。在 UNIX/Linux/MacOS 世界中，您使用`opendir()`, 和`readdir()`:

```
#include <sys/types.h>
#include <dirent.h> 
```

...

```
DIR *directory = opendir( directoryName );

if( directory == NULL )
    {
    perror( directoryName );
    exit( -2 );
    }
// Read the directory, and pull in every file that doesn't start with '.'

struct dirent *entry;
while( NULL != ( entry = readdir(directory) ) )
{
// by convention, UNIX files beginning with '.' are invisible.
// and . and .. are special anyway.
    if( entry->d_name[0] != '.'  )
        {
        // you now have a filename in entry->d_name;
        // do something with it.
        }
} 
```

# php - 从数组中构建字符串，在 PHP 中省略空值或 NULL 值

> ID：10182318
> 
> 赞同：0
> 
> 时间：2012-04-16T21:59:26.447
> 
> 标签：php, mysql, database, arrays, string

我正在尝试从 URL 参数列表构建一个数组以与数据库进行交易。基本上我有几个功能可以做不同的事情。（插入、更新等）因此取决于它具体尝试执行的操作，它可能始终不需要数据库中的所有列。

所以说我有这 5 个可能被传递的潜在参数：id、gr、bl、yw、re

如果我要插入一个新行，所有 5 列都需要某种值。如果我说更新 bl 列，那么我只传递 id 和 bl 参数。

所以我这样做是为了构建查询字符串（不是实际代码只是示例）：

```
foreach($_GET as $key => $value) {
$key = strtolower($key);
if (preg_match($acceptedGETS,$key)) $$key = $value;
}

$table_col = array (
    'p_id' => $_GET['id'],
    'p_gr' => $_GET['gr'],
    'p_bl' => $_GET['bl'],
    'p_yw' => $_GET['yw'],
    'p_re' => $_GET['re']);

$vstring = implode(',' , $table_col); 
```

现在，只要所有变量键都有一个值（或不是 NULL），它就可以完美地工作。我的问题是，如何从数组中构建字符串，但排除未传递值的键。现在，如果键缺少值，我会得到这个，例如：

网址：[http](http://www.mysite.com/myscript.php?id=4&re=9) ://www.mysite.com/myscript.php?id=4&re=9 会得到我：

4,,,,9

当我需要得到 4,9

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:05:02.070

尝试

```
$vstring = "";
$acceptedGETS = array("id", "gr", "bl", "yw", "re");
$values = array();
foreach ($_GET as $key => $value)
{
    $k = strtolower($key);
    if (!in_array($k, $acceptedGETS))
        continue;
    $values[$k] = $value;
}
$vstring = implode(",", $values); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:06:20.437

使用`$get = array_filter($_GET)`它将摆脱空值或空值。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-16T22:17:18.727

这是使用`filter_input_array`一组过滤器的另一种方法

```
$args = array(
    'id'    => FILTER_VALIDATE_INT,//if it is an integer
    'gr'    => FILTER_SANITIZE_STRIPPED,//in case it is a string
    'bl'    => FILTER_SANITIZE_STRIPPED,
    'yw'    => FILTER_SANITIZE_STRIPPED,
    're'    => FILTER_SANITIZE_STRIPPED,
);

//Filter array values to avoid bad data if nothing found NULL returned
$myInputs = filter_input_array(INPUT_GET, $args);

//if it is an array join it with coma
if(is_array($myInputs))
    $myInputs = implode(',', $myInputs); 
```

# php - 使用表单输入通过 php 构建 url。

> ID：10182320
> 
> 赞同：0
> 
> 时间：2012-04-16T21:59:55.080
> 
> 标签：php, forms

我正在尝试创建一个表单，用户可以在其中输入他们的 id（用户名），它将作为变量附加到我的 php 脚本中使用的 url 中。这就是我所拥有的。

```
<?php
if(isset($_POST['submit']))
{
    $id = $_POST['id'];
    echo 'http://example.com/default.asp?action=data&id=$id';
}
?>
<form method="post" action="<? echo $_SERVER['PHP_SELF']; ?>">
   <input type="text" name="id"><br>
   <input type="submit" name="submit" value="Submit Form"><br>
</form> 
```

它会正确收集用户的 id，如果我只是回显 $id，它会输出正确的值，但是当我尝试回显 url 时，它只会输出 $id 而不是 $id 变量的实际值。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T22:00:51.297

```
echo "http://example.com/default.asp?action=data&id=$id";
     ^---wrong quotes                                  ^--- ditto 
```

单引号字符串不插入变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T22:02:57.360

单引号不会插入变量，要么使用双引号，要么使用字符串连接......三个选项：

```
 echo "http://example.com/default.asp?action=data&id=".$id; 
```

或者

```
 echo "http://example.com/default.asp?action=data&id=$id"; 
```

或者

```
 echo 'http://example.com/default.asp?action=data&id='.$id; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T22:03:42.803

这一行：

```
echo 'http://example.com/default.asp?action=data&id=$id'; 
```

应该

```
echo 'http://example.com/default.asp?action=data&id='.$id; 
```

如果您在 PHP 中使用带字符串的单引号，它将打印字符串中的任何内容而不评估任何内容（即不评估任何变量）。因此，您可以使用双引号或像我上面那样附加变量。

# c# - 灯开关 lambda 使用

> ID：10182327
> 
> 赞同：0
> 
> 时间：2012-04-16T22:00:17.173
> 
> 标签：c#, .net, visual-studio-lightswitch

我正在编写一个 LightSwitch 应用程序，我可以提供一些建议。

我想计算与父对象相关的子对象的总数，这些子对象满足真实且与客户端相关的标准。

```
partial void OpenPositions_Compute(ref int result)
{
    foreach (Position position in this.DataWorkspace.ApplicationData.Positions)
    {
        if (position.IsPositionOpen && position.Client.Id == this.Id)
        {
            result++;
        }
    }
} 
```

我确实尝试在不使用 foreach 循环的情况下计算客户拥有的职位数量，我想出了这个：

```
partial void TotalPositons_Compute(ref int result)
{
    result += this.Position.Count();
} 
```

问题 1：是否有可能以更好/更有效的方式编写代码片段 1？也许作为一个 lambda 方程？（或类似于第二个代码片段）

问题 2：除了代码的可读性之外，lambda 方程还有什么好处？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:11:09.467

问题一：

```
partial void OpenPositions_Compute(ref int result)
{
    result = this.DataWorkspace.ApplicationData.Positions
        .Count(p => p.IsPositionOpen && position.Client.Id == this.Id);
} 
```

问题2：

这取决于使用情况。在这种情况下，最大的优势是代码简洁，因为您可以使用 LINQ 而无需重新实现计数功能。有时可以提高性能。再次以 LINQ 为例，LINQ 使用延迟执行来防止在需要时执行代码。

通常，lambda 不是解决方案，而是解决方案的一部分。使用 LINQ 通常是解决此类问题的方法。

# solr - 如何在 solr 嵌套查询语法中转义引号？

> ID：10182328
> 
> 赞同：4
> 
> 时间：2012-04-16T22:00:18.363
> 
> 标签：solr, solr-query-syntax

即我想用嵌套查询语法搜索短语，所以

```
_query_:"{!dismax qf=myfield}"how now"" 
```

第一级如何解决这个问题？如何解决任何级别的问题？`_query_:"_query_:"{!dismax qf=myfield}"how now"""`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:48:48.163

一种选择是取消引用本地参数中的参数：

`_query_:"{!dismax qf=myfield v=$query1}"`然后在 URL 的末尾添加`query1="how how"`并执行该 foreach 查询，但更改为 query2 query3 等。

见本页底部

[http://wiki.apache.org/solr/LocalParams](http://wiki.apache.org/solr/LocalParams)

# javascript - document.onkeypress 不起作用，如何解决？

> ID：10182329
> 
> 赞同：5
> 
> 时间：2012-04-16T22:00:21.570
> 
> 标签：javascript

以下代码是否有任何理由不应该在我的控制台日志中返回任何内容？！

```
document.onkeypress =  zx();

function zx(){
    console.log(event.keyCode);
} // zx 
```

`window.onkeypress`也不起作用。

已经进行了其他尝试，例如：

```
document.onkeypress =  zx(event);

function zx(event){
    console.log(event.keyCode);
} // zx 
```

-

```
document.onkeypress =  zx;

function zx(){
    console.log(event.keyCode);
} // zx 
```

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-16T22:02:36.070

省略调用时的括号，您不需要指定它们。

解决方案：

```
document.onkeypress =  zx;
function zx(e){
    var charCode = (typeof e.which == "number") ? e.which : e.keyCode
    console.log(charCode);
} 
```

### [演示](http://jsfiddle.net/RXXYj/125/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T22:03:24.183

当附加`function`到`event`你不需要`()`

做就是了：

```
document.onkeypress =  zx; //note! don't use the ()

function zx(){
    console.log(event.keyCode);
} // zx 
```

如果您使用的是 chrome，请尝试通过

```
function zx(e){
    var key = e.which || e.keyCode;
    console.log(key);
} // zx 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T22:14:21.697

尝试这个

```
document.onkeypress = displayunicode;
function displayunicode(event){
    var charCode = (typeof event.which == "number") ? event.which : event.keyCode
    console.log(charCode )
} 
```

这将起作用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-16T22:29:02.927

您的函数需要定义“事件”。

```
// assign a reference to zx; but don't call zx
document.onkeypress =  zx;

// event needs to be defined
function zx(event){
    console.log(event.keyCode);
} 
```

keyCode 有时为 0

请参阅此页面：[MDN 上的 event.keyCode](https://developer.mozilla.org/en/Document_Object_Model_%28DOM%29/event.keyCode)

您可能想使用 event.which

```
 document.onkeypress = zx;
    function zx(event) {
        console.log(String.fromCharCode(event.which));
    } 
```

# scala - Scala NodeSeq reduce/foldLeft 带换行符

> ID：10182332
> 
> 赞同：1
> 
> 时间：2012-04-16T22:00:41.193
> 
> 标签：scala, newline, reduce, xmlnode

假设这很简单，但很难用换行符打印出 html 标签的 NodeSeq（所以当我在 Web 浏览器中查看源代码时，我可以从上到下扫描）

照原样，NodeSeq 打印为一长行。

示例代码：

```
listOfPaths map ( jsNode(_) ) reduce (_++_)

def jsNode(path: String): NodeSeq =
  <script type="text/javascript" src={"/static/js/"+path}></script> 
```

那么，如何在每个节点的末尾得到一个*\n呢？*

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T22:49:19.953

无论您使用什么来呈现 HTML，这确实是一项工作。例如，如果您使用的是[scala.xml.PrettyPrinter](http://www.scala-lang.org/api/current/scala/xml/PrettyPrinter.html)，您可以执行以下操作：

```
val printer = new xml.PrettyPrinter(80, 2)
val paths = List("script-1.js", "script-2.js")
val header = <head>{paths map ( jsNode(_) ) reduce (_++_)}</head> 
```

现在，当您调用 时`printer.format(header)`，您将获得以下信息：

```
<head>
  <script type="text/javascript" src="/static/js/script-1.js"></script>
  <script type="text/javascript" src="/static/js/script-2.js"></script>
</head> 
```

请注意，`PrettyPrinter`构造函数的第一个参数指定页面宽度，第二个参数指定缩进的空格数。

如果您只是想要快速而肮脏的东西，您可以在元素之间（或之后）放置一个文本节点：

```
paths map ( jsNode(_) ) reduce (_++ Text("\n") ++ _) 
```

但其他解决方案几乎总是更可取的。

# html - 将这种格式不佳的 HTML 转换为格式良好的 XHTML 的方法？

> ID：10182333
> 
> 赞同：1
> 
> 时间：2012-04-16T22:00:45.010
> 
> 标签：html, parsing, jsoup

我正在使用 JSoup 1.6.2。我有这个 HTML ...

```
 <a title="Subscribe to RSS feeds" href="http://domain/city/RSS" style="float:right; margin-left:10px;""> 
```

请注意标签末尾之前的杂散引号。我希望 JSoup 能以某种方式清理它。我尝试通过运行来使一切正确...

```
final org.jsoup.nodes.Document doc = Jsoup.parse(html); 
```

结果是

```
 <a title="Subscribe to RSS feeds" href="http://domain/city/RSS" style="float:right; margin-left:10px;" "=""> 
```

这仍然不是很好的形式。有没有办法可以采用格式错误的 HTMl 并使用 JSoup 使其格式正确？除此之外，是否还有另一个 HTML tidy-upper 可以完成上述示例的工作，但也允许我以 String 或 org.w3c.dom.Document 对象的形式访问生成的 HTML？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:17:59.837

你能用正则表达式替换来解决这个问题吗？我不知道如何在 Java 中做到这一点，但在 JavaScript 中它会是这样的：

```
var str = '<a title="Subscribe to RSS feeds" href="http://domain/city/RSS" style="float:right; margin-left:10px;"">';

var newStr = str.replace(/""/,'"');
//<a title="Subscribe to RSS feeds" href="http://domain/city/RSS" style="float:right; margin-left:10px;"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T10:18:16.470

基于[这个](https://stackoverflow.com/a/3154281/432836)答案，我建议您使用 JTidy 来“整理” HTML 源代码。

# overflow - 使用溢出时的文本裁剪：隐藏

> ID：10182336
> 
> 赞同：14
> 
> 时间：2012-04-16T22:00:53.510
> 
> 标签：overflow, css

我有这个简单的 html 和 css [http://jsfiddle.net/JVfVv/1/](http://jsfiddle.net/JVfVv/1/)

问题是文本在 mac 上的 safari/chrome/firefox 下被裁剪。删除 overflow: hidden 可以解决问题，但是出于其他原因，此行是必要的。删除行高：1；似乎解决了这个问题，但是我从我的重置样式表中得到了这个，我不明白为什么它会导致作物。

有人可以解释为什么会发生这种情况，以及如何解决它吗？谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-17T01:27:58.300

要回答为什么会发生这种情况的问题，我认为关键是 CSS 2.1 规范的[字体部分](http://www.w3.org/TR/CSS21/fonts.html#font-size-props)中的这个特定短语（强调我的）：

> 字体大小对应于 em 方格，这是排版中使用的一个概念。**请注意，某些字形可能会在它们的 em 方格之外流血。**

该`line-height: 1`声明将段落的高度设置为与 相同的高度`font-size`（因为该段落只有一行）。某些字符被切断的事实意味着他们的字形在他们的 em 方格之外流血（我不知道如何明确证明这是真的；我只是根据证据推测）。

至于解决方案，最直接的解决方案是使用更大的`line-height`设置，例如 1.1 或 1.2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:03:25.133

你可以设置`height`解决问题的CSS吗？

```
p {
    line-height: 1;
    overflow: hidden;
    font-family: "Helvetica Neue", Helvetica, Arial; font-size: 30px;
    height:32px; /* this appears to solve the problem */
}​ 
```

见：http: [//jsfiddle.net/JVfVv/4/](http://jsfiddle.net/JVfVv/4/)

# python - 防止来自 Python 的电子邮件被标记为垃圾邮件

> ID：10182342
> 
> 赞同：3
> 
> 时间：2012-04-16T22:01:54.790
> 
> 标签：python, django, email, outlook

我已经使用 Django 建立了一个内部公司网站。我有一个使用 send_mail() 函数向网站用户发送电子邮件的视图。

一些用户没有收到来自该网站的电子邮件，我们发现如果他们将 Outlook 配置为高垃圾邮件保护级别，来自该网站的电子邮件将被标记为垃圾邮件。

是否有任何编码技术可以使从 Python 发送的电子邮件在 Outlook 和其他电子邮件客户端看来是合法的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-16T22:07:45.210

这不是真正与 Django 相关的问题，而是更多关于发送电子邮件的内容和方式，有很多关于这个主题的精彩文章和博客文章，这是我最喜欢的一个：

[http://www.codinghorror.com/blog/2010/04/so-youd-like-to-send-some-email-through-code.html](http://www.codinghorror.com/blog/2010/04/so-youd-like-to-send-some-email-through-code.html)

当然，您总是可以采取不同的方向并让其他人为您完成工作，这几乎肯定会比运行您自己的 smtp 服务器更好。您将拥有诸如统计数据之类的好东西（例如退回、硬退回、垃圾邮件、块...）更高的可交付性...

根据我的经验，这会带来一个价格，这将少于您让事情正常运行所花费的时间:)

举个例子，我有直接使用 MailJet 和 Django 处理相当大的电子邮件发送（每周几百万）的经验，而且效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-22T12:11:54.007

对我有用的是一件缺少的简单事情。我添加了一个“text_content”参数（左起第二个），之前它是空白的。

我还以段落形式在模板中添加了一些文本。

```
 msg = EmailMultiAlternatives(
                  subject, "Please find details of Candidate in this mail", 
                  request.user.email, 
                  [round_taker.email]) 
```

我知道这听起来不那么技术性。但它可能对某些人有用。

# jquery - stopPropagation() 仅用于一个元素

> ID：10182344
> 
> 赞同：0
> 
> 时间：2012-04-16T22:02:01.390
> 
> 标签：jquery, events, types, element, bind

所以现在，我正在使用hammer.js 将一些触摸控件绑定到页面上的元素。通过在元素上向右滑动，它将添加禁用类。如果任何项目有一个禁用的类，我想，基本上，“解除绑定”双击和滑动事件仅针对该类禁用的元素。有谁知道这是否可能？

```
$('.row').hammer({
    prevent_default: false,
    drag_vertical: false
}).bind('doubletap swiperight', function(e) {
    var $this = $(this)
    if (e.type == "doubletap") {
        confirm("Do You Want To Edit Med?")
    }
    else if (e.type == "swiperight") {
        $this.removeClass('yHighlight');
        $this.addClass('gHighlight disabled');
        $this.css('opacity','.5')
    } 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:05:34.997

```
if ($this.hasClass('disabled')) return; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T22:05:48.880

您可以简单地从事件处理程序内部检查触发事件的元素是否具有该类；如果是，则返回而不做任何事情。

```
.bind('doubletap swiperight', function(e) {
    var $this = $(this);

    // ADDED CODE
    if ($this.hasClass("disabled")) {
        e.stopPropagation();
        return;
    }
    if (e.type == "doubletap") {
        confirm("Do You Want To Edit Med?")
    }
    else if (e.type == "swiperight") {
        $this.removeClass('yHighlight');
        $this.addClass('gHighlight disabled');
        $this.css('opacity','.5')
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T22:07:58.693

我建议使用内置于[`.on()`方法](http://api.jquery.com/on/)中的 jQuery 事件委托。使用`.on()`方法而不是`.bind()`. 这是一个示例，假设行的父元素的 id 为“rowparent”。

```
('.row').hammer({
    prevent_default: false,
    drag_vertical: false
});

$('#rowparent').on('doubletap swiperight', '.row:not(.disabled)', function(e) {
    var $this = $(this)
    if (e.type == "doubletap") {
        confirm("Do You Want To Edit Med?")
    }
    else if (e.type == "swiperight") {
        $this.removeClass('yHighlight');
        $this.addClass('gHighlight disabled');
        $this.css('opacity','.5')
    }
}); 
```

该`.on`方法采用可选的选择器参数。当 doubletap 或 swiperight 事件冒泡到 时`#rowparent`，jQuery 会针对该选择器测试事件的目标元素。所以这将自动“取消绑定”事件，因为它们停止匹配该选择器！

如果您有很多行，我会将此称为优于针对处理程序中的类名进行测试的其他答案；仅绑定单个事件处理程序更有效。但是，如果您只有很少的行，则仅`.hasClass`在方法主体中检查可能会更有效，因为`:not()`选择器有点重。

# flash - 使用 Adob e Flash Media Server 4.5 从实时流中生成简单的统计数据

> ID：10182349
> 
> 赞同：0
> 
> 时间：2012-04-16T22:02:33.563
> 
> 标签：flash, amazon-web-services, flash-media-server, usage-statistics

我使用 Amazon Web Services 和 Adob​​e Flash Media Server 4.5 创建了一个实时流。

我可以登录 Flash 媒体管理控制台并查看我有多少连接/断开连接，但我似乎无法找到一个可以查看简单统计数据的地方，例如唯一查看者或每个连接的连接时间.

似乎这不是默认值；但我想我可以将代码放入 XML 文件中以生成这些统计信息。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T21:46:15.277

通过各种来源，我发现使用 HTTP Streaming 和 Amazon Web Services，流被记录，内容由 Apache 提供，而 FMS 在其中没有任何作用，因此没有记录统计信息。

# c# - 如何定位窗口上的 Groupbox 内的所有文本框 - WPF

> ID：10182354
> 
> 赞同：0
> 
> 时间：2012-04-16T22:02:39.390
> 
> 标签：c#, wpf

我正在尝试设置一个 windows.resoruces 样式，该样式针对所有组框中的所有文本框（因此它不会针对在组框中找不到的文本框）

我知道我可以使用 x:key 字段，但想知道是否有办法针对整个窗口或应用程序的控件中的某些控件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:39:34.753

您可以在GroupBox 的 Style.Resources 中尝试使用[Style.TargetType](http://msdn.microsoft.com/en-us/library/system.windows.style.resources.aspx)[但](http://msdn.microsoft.com/en-us/library/system.windows.style.targettype.aspx)没有[x:key](http://msdn.microsoft.com/en-us/library/ms742804.aspx)的 TextBoxes 嵌套样式。

```
<Style TargetType="GroupBox">
    <Style.Resources>
        <Style TargetType="TextBox">
            ...
        </Style>
    </Style.Resources>
</Style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:19:38.607

您可以使用的一个技巧是定义没有 x:key 字段的文本框样式。这将适用于所有没有指定样式的文本框。

对 GroupBoxes 中的 TextBoxes 使用此 Style，不要在这些 Boxes 上使用 Style 标签，对于所有其他 TextBoxes，通过使用 Style 标签使用特定命名的 Style...

# mysql - UnwantedTokenException(found=., expected 80) JPA on Spring Web Project

> ID：10182359
> 
> 赞同：1
> 
> 时间：2012-04-16T22:02:57.157
> 
> 标签：mysql, sql, spring, jpa

当我在 myService 上使用 readAll 方法时，我看到了这个错误。在经过广泛的谷歌搜索之后，在我找不到任何有用的信息之前，有人看到这个错误是我的代码

新闻DAO

```
public interface NewsDAO extends GenericDAO<News, Serializable> {
  } 
```

新闻DAOImpl

```
public class NewsDAOImpl extends GenericJPADAOImpl<News, Serializable> implements NewsDAO { 
```

}

消息

```
@Entity
@Table(name = "News")
public class News implements Serializable {...blah blah} 
```

当我使用此方法时出现问题（它是我服务级别的方法）

```
 @Override
public List<Article> articleList() {
    return articleDAO.readAll();
} 
```

我在 spring 项目中使用 mysql 没有连接错误。任何建议都会很棒谢谢

```
UnwantedTokenException(found=., expected 80) at  org.eclipse.persistence.internal.libraries.antlr.runtime.BaseRecognizer.recoverFromMismatchedToken(BaseRecognizer.java:587)
at org.eclipse.persistence.internal.libraries.antlr.runtime.BaseRecognizer.match(BaseRecognizer.java:115)
at org.eclipse.persistence.internal.jpa.parsing.jpql.antlr.JPQLParser.rangeVariableDeclaration(JPQLParser.java:2249)
at org.eclipse.persistence.internal.jpa.parsing.jpql.antlr.JPQLParser.identificationVariableDeclaration(JPQLParser.java:2162)
at org.eclipse.persistence.internal.jpa.parsing.jpql.antlr.JPQLParser.fromClause(JPQLParser.java:2043)
at org.eclipse.persistence.internal.jpa.parsing.jpql.antlr.JPQLParser.selectStatement(JPQLParser.java:364)
at org.eclipse.persistence.internal.jpa.parsing.jpql.antlr.JPQLParser.document(JPQLParser.java:281)
at org.eclipse.persistence.internal.jpa.parsing.jpql.JPQLParser.parse(JPQLParser.java:134)
at org.eclipse.persistence.internal.jpa.parsing.jpql.JPQLParser.buildParseTree(JPQLParser.java:95)
at org.eclipse.persistence.internal.jpa.EJBQueryImpl.buildEJBQLDatabaseQuery(EJBQueryImpl.java:215)
at org.eclipse.persistence.internal.jpa.EJBQueryImpl.buildEJBQLDatabaseQuery(EJBQueryImpl.java:190)
at org.eclipse.persistence.internal.jpa.EJBQueryImpl.<init>(EJBQueryImpl.java:142)
at org.eclipse.persistence.internal.jpa.EJBQueryImpl.<init>(EJBQueryImpl.java:126)
at org.eclipse.persistence.internal.jpa.EntityManagerImpl.createQuery(EntityManagerImpl.java:1475)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240)
at $Proxy42.createQuery(Unknown Source)
at com.dcat.dao.impl.GenericJPADAOImpl.readAll(GenericJPADAOImpl.java:38)
at com.dcat.ipp.service.impl.AdminServiceImpl.getNewsList(AdminServiceImpl.java:348)
at com.dcat.ipp.service.impl.AdminServiceImpl.getNewsListAsSpot(AdminServiceImpl.java:354)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)
at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
at $Proxy48.getNewsListAsSpot(Unknown Source)
at com.dcat.ipp.controller.HomeController.getNewsSpotList(HomeController.java:144)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-05-02T10:24:09.123

就我而言，我正在使用`em.createQuery`它的原生查询。

```
EntityManager em = getEntityManager();
Query query = em.createQuery("SELECT a From Product") 
```

它得到了解决 - 当我使用本机查询时，

```
EntityManager em = getEntityManager();
Query query = em.createNativeQuery("SELECT * from tbl_product") 
```

# c++ - 汇编中的for循环有效

> ID：10182365
> 
> 赞同：-2
> 
> 时间：2012-04-16T22:03:14.400
> 
> 标签：c++, visual-studio, visual-c++, assembly, for-loop

我目前正在尝试习惯汇编程序，并且我已经在 C++ 中编写了一个 for 循环，然后我在反汇编中查看了它。我想知道是否有人可以向我解释每个步骤的作用和/或如何手动改进循环。

```
for (int i = 0; i < length; i++){
     013A17AE  mov         dword ptr [i],0  
     013A17B5  jmp         encrypt_chars+30h (13A17C0h)  
     013A17B7  mov         eax,dword ptr [i]  
     013A17BA  add         eax,1  
     013A17BD  mov         dword ptr [i],eax  
     013A17C0  mov         eax,dword ptr [i]  
     013A17C3  cmp         eax,dword ptr [length]  
     013A17C6  jge         encrypt_chars+6Bh (13A17FBh)  
temp_char = OChars [i];         // get next char from original string
     013A17C8  mov         eax,dword ptr [i]  
     013A17CB  mov         cl,byte ptr OChars (13AB138h)[eax]  
     013A17D1  mov         byte ptr [temp_char],cl 
```

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T22:11:48.183

首先，我注意到您发布的内容似乎只包含循环体的一部分。其次，看起来你编译时关闭了*所有*优化——当/如果你打开优化，如果结果看起来完全不同，不要感到惊讶。

也就是说，让我们逐行查看代码：

```
 013A17AE mov dword ptr [i],0 
```

这基本上只是`i=0`。

```
 013A17B5 jmp encrypt_chars+30h (13A17C0h) 
```

这将进入循环的开始。尽管在大多数高级语言中将测试置于循环顶部是很常见的，但在汇编语言中并非总是如此。

```
 013A17B7 mov eax,dword ptr [i]
 013A17BA add eax,1
 013A17BD mov dword ptr [i],eax 
```

这是`i++`（非常次优的）汇编语言。它正在检索 的当前值`i`，将其加一，然后将结果存储回`i`.

```
 013A17C0 mov eax,dword ptr [i]
 013A17C3 cmp eax,dword ptr [length]
 013A17C6 jge encrypt_chars+6Bh (13A17FBh) 
```

这基本上`if (i==length) /* skip forward to some code you haven't shown */`是检索 的值`i`并将其与 的值进行比较，如果大于或等于`length`，则跳转到某处。`i``length`

如果您是用汇编语言手工编写的，您通常会使用`xor eax, eax`（或`sub eax, eax`）之类的东西将寄存器归零。在大多数情况下，如果可能，您将从最大值开始倒数到零（避免循环中的比较）。您当然不会将值存储到变量中，然后立即将其取回（公平地说，如果您打开优化，编译器也可能不会这样做）。

应用它，并将“变量”移动到寄存器中，我们最终会得到以下一般顺序的东西：

```
 mov ecx, length
loop_top:
    ; stuff that wasn't pasted goes here
    dec ecx
    jnz loop_top 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:16:11.627

我将尝试用简单的英语解释这一点：

```
 013A17AE  mov         dword ptr [i],0               ; Move into i, 0
 013A17B5  jmp         encrypt_chars+30h (13A17C0h)  ; Jump to check
 013A17B7  mov         eax,dword ptr [i]             ; Load i into the accumulator (register eax)
 013A17BA  add         eax,1                         ; Increment the accumulator
 013A17BD  mov         dword ptr [i],eax             ; and put that in it, effectively adding
; 1 to i.
check:
 013A17C0  mov         eax,dword ptr [i]             ; Move i into the accumulator
 013A17C3  cmp         eax,dword ptr [length]        ; Compare it to the value in 'length',
; setting flags
 013A17C6  jge         encrypt_chars+6Bh (13A17FBh)  ; Jump if it's greater or equal. This
; address is not in your code snippet 
```

编译器更喜欢 EAX 进行算术运算。每个寄存器（过去，我不知道这是否仍然是最新的）都有某种类型的操作，它执行起来更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T22:16:14.467

这是应该更优化的部分：（
注意：你的编译器***应该***这样做，所以要么你关闭了优化，要么循环体中的某些东西阻止了这种优化）

```
mov eax,dword ptr [i]    ; Go get "i" from memory, put it in register EAX
add eax,1                ; Add one to register EAX
mov dword ptr [i],eax    ; Put register EAX back in memory "i". (now one bigger)
mov eax,dword ptr [i]    ; Go get "i" from memory, put it in EAX again. 
```

看看您将值从内存来回移动到 EAX 的频率？

您应该能够在循环开始时将“i”加载到 EAX 中，直接从 EAX 运行整个循环，并在完成后将完成的值放回“i”。（除非您的代码中的其他内容阻止了这一点）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T22:23:19.560

无论如何，此代码来自 DEBUG 构建。可以对其***进行***优化，但是 MS 编译器为这种简单的情况生成了非常好的代码。

手动做没有意义，只需在发布模式下重新构建它并阅读清单以了解如何做。

# python - 试图找出将多行处理成字典的正确循环

> ID：10182366
> 
> 赞同：0
> 
> 时间：2012-04-16T22:03:21.230
> 
> 标签：python, python-3.x

杂货库存.txt 包含

```
柠檬水 6 1.1

面包 34 1.43

筹码 47 3.76

香蕉 16 0.79

比萨饼 15 5.0

```

这是我到目前为止为它编写的代码。

```
 infile=open("grocery_stock.txt", 'r+')
    lines=infile.readlines()
    line=infile.readline()
    none= ' '
    count = 0
    index= 0
    while line !=none:
        line1=infile.readline()

        while line1 in lines:

            line1=line1.split()
            name1=str(line1[:0])
            quant1=(str(line1[:1]))
            price1=[(str(line1[:2]))]
            grocerystock[name1[0]]=(quant1,name1)

            print (grocerystock)

        line2=infile.readline()
        for line2 in line:
            line1=line2.split()
            name1=str(line1[0])
            quant1=(str(line1[1]))
            price1=[(str(line1[2]))]
            grocerystock[name1[1]]=(quant1,name1)
            print (line1[1], line[2],line1[0])
            print (grocerystock)

        line3=infile.readline()
        line4=infile.readline()
        line5=infile.readline()
    infile.close()

    grocerystock={} 
```

我这样做的原因是因为稍后在我的项目中，我将不得不删除一些键并更改一些值，所以我想要一个函数，当我读取文件以将数据转换为字典时，我可以在程序的任何地方调用该函数。

我的循环对你来说可能看起来很疯狂，但我当时只是在尝试任何突然出现在我脑海中的东西。

此外，正如您所看到的，我还没有完成第 5 行，我认为找出正确的循环而不是输入随机循环并看看会发生什么会更好。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:13:40.083

也许这会有所帮助：

```
with file('grocery_stock.txt') as f:
    lines = f.readlines()

# filter out empty lines
lines = [line for line in lines if line.strip() != '']

# split all lines
lines = [line.split() for line in lines]

# convert to a dictionary
grocerystock = dict((a, (b, c)) for a, b, c in lines)

# print
for k, v in grocerystock.items():
    print k, v 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:14:05.107

您需要的唯一循环是逐行移动数据的循环。这可以通过以下方式完成：

```
with open("grocery_stock.txt", "r+") as f:
    for line in f: # Changed to be a more elegant solution; no need to use while here.
        # Here we would split (hint) the line of text.
        dict[split_text[0]] = [split_text[1], split_text[2]] 
```

由于这是家庭作业，因此我鼓励您研究此解决方案以及其他解决方案。我不能只*给*你答案，现在可以吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T22:15:13.037

只是一些提示，因为这是硬件：

*   尝试使用上下文管理器打开文件，即[语句](http://docs.python.org/reference/compound_stmts.html#grammar-token-with_stmt)，[`with`](http://preshing.com/20110920/the-python-with-statement-by-example)
*   即使`while`没有错，在这种情况下我更喜欢 for 循环（迭代次数是固定的 - 行数）——我有时认为 while 循环是[解决停止问题的途径](http://www.cs.utep.edu/vladik/cs5315.06/homeworks.html)......
*   尝试使用[`readlines()`](http://docs.python.org/tutorial/inputoutput.html#methods-of-file-objects)，因为行数可能很少；或使用这样的东西（看起来很自然）：

    ```
    for line in f:
        # do something with line 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T22:22:14.937

当您使用`open()`并获得文件对象时，您可以迭代文件对象。像这样：

```
for line in f:
    # do something with the line 
```

我推荐上述方法，而不是`f.readline()`循环调用。

`f.readlines()`将整个文件读入内存，并建立一个输入行列表。对于非常大的文件，这可能会导致性能问题。对于您在此处使用的小文件，它可以工作，但如果您学习标准 Python 习惯用法，您可以将它用于小文件或大文件。

# asp.net-mvc-3 - 如何停止助手EditorFor中的自动填充？

> ID：10182371
> 
> 赞同：1
> 
> 时间：2012-04-16T22:03:58.150
> 
> 标签：asp.net-mvc-3, editorfor

视图模型：

```
[Required]
public int Hours { get; set; } 
```

剃刀：

```
@Html.EditorFor(m => m.Hours) 
```

输出：

```
<input type="text" value="0" name="Hours" id="Hours" 
 data-val-required="The field is required." 
 data-val-number="The field must be a number."
 data-val="true" class="text-box single-line valid"> 
```

给出了什么，为什么这个值会被自动填充为 0。它几乎绕过了验证，因为用户可以在不实际输入任何内容的情况下提交它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:07:20.573

您的属性类型是`int`默认值为 的值类型`0`。

如果您希望 Reuired 属性正常工作，请设置为`Hours` [nullable](http://msdn.microsoft.com/en-us/library/1t3y8s4s%28v=vs.80%29.aspx)：

```
[Required]
public int? Hours { get; set; } 
```

# json - 带有 Backbone.js REST API 的烧瓶

> ID：10182372
> 
> 赞同：1
> 
> 时间：2012-04-16T22:04:06.600
> 
> 标签：json, rest, backbone.js, flask

`Model.save()`在backbone.js 中，将模型数据作为POST 作为JSON 编码字符串发送到服务器。它只是一个字符串，而不是`variable=jsonString`普通的 POST 请求。所以我无法在 Flask 中以`request.form.get('variable')`. 我应该在哪里编辑代码？Flask 可以处理这样的请求吗？Backbone.js 可以像普通的 post 请求而不是 JSON 编码的字符串那样发送数据吗？

如果需要，可以提供更多信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T22:17:33.270

使用 Backbone，请求 Content-Type 标头会自动设置为“application/json”（除非您启用了 emulateJSON），因此 Flask 应该自动解析 JSON 并通过请求对象使其可用。

```
@app.route('/some_route', methods=['POST', 'GET'])
def some_route():
    if request.method == 'POST':
        """ json available through request.json """ 
```

[http://flask.pocoo.org/docs/api/#flask.Request.json](http://flask.pocoo.org/docs/api/#flask.Request.json)

# python - 使用 Python 请求库发送上传文件时遇到问题

> ID：10182377
> 
> 赞同：1
> 
> 时间：2012-04-16T22:04:33.760
> 
> 标签：python, google-app-engine, python-requests

我正在尝试修改请求库文档中的[示例](http://docs.python-requests.org/en/latest/user/quickstart/#post-a-multipart-encoded-file)，以包含从用户上传的文件（到 appengine 应用程序）。我尝试了以下方法：

```
from libs import requests

file_data = self.request.POST['file_to_upload']
the_file = file_data
send_url = "http://httpbin.org/post"
values = {
          'user_id' : '1234',
          'file_name' : 'some_file.pdf'
          }

r = requests.post(send_url, files=the_file)
logging.info(r.content) 
```

然而这会返回

```
 {
  "origin": "81.178.201.22", 
  "files": {}, 
  "form": {}, 
  "url": "http://httpbin.org/post", 
  "args": {}, 
  "headers": {
    "Content-Length": "0", 
    "Accept-Encoding": "identity, deflate, compress, gzip", 
    "Connection": "keep-alive", 
    "Accept": "*/*", 
    "User-Agent": "python-requests/0.11.1 AppEngine-Google; (+http://code.google.com/appengine)", 
    "Host": "httpbin.org", 
    "Content-Type": ""
  }, 
  "json": null, 
  "data": ""
} 
```

即没有收到文件。我也尝试将 the_file 发送为

```
file_data.file 
file_data.file.read() 
```

但是这些也失败了。最终，我想在同一个发布请求中同时包含“值”和文件，所以类似于：

```
r = requests.post(send_url, data=values, files=the_file) 
```

但是，这也不起作用-我想我需要先修复上面的代码。关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:03:01.897

您能否提供一个用于显示上传表单的 HTML 代码？有时，表单上传失败，因为它缺少一些 HTML 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:14:35.580

GAE 不支持请求库。看看这个：[在 Google App Engine 中使用 Requests python 库](https://stackoverflow.com/questions/9762685/using-the-requests-python-library-in-google-app-engine)

# javascript - Mootools 事件导致 IE7/IE8 中的无限循环

> ID：10182381
> 
> 赞同：2
> 
> 时间：2012-04-16T22:04:59.823
> 
> 标签：javascript, internet-explorer, mootools, mootools-events

我很难让它在 IE7（和 IE8）中工作。它是一个更复杂的脚本的一个非常简化的部分。所以请记住，方法和结构不能改变太多。

在IE7中，选择一种类型时，我会获得无限循环。在 FF、Chrome 和 IE9 中运行良好。它与 IE7/IE8 中的 mootools 1.1 库一起使用也很棒，但是自从我将它转换为 Mootools 1.4 后，我遇到了循环问题。

也许框架中的某种事件委托发生了变化。我真的不知道。任何帮助是极大的赞赏！

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>eventz</title>
    <script src="https://ajax.googleapis.com/ajax/libs/mootools/1.4.5/mootools-yui-compressed.js" type="text/javascript"></script>  

    <script type="text/javascript">
        var eventz = new Class({
            options: {      

            },  
            initialize: function(options) {
                this.setOptions(options);               
                this.setup();
                this.jx = 0;    

            },
            setup: function() {
                this.makeEvents();
                // ...
            },

            makeEvents : function() {
                alert("init");

                var finputs =   $$('.trig');

                finputs.removeEvents('change');
                finputs.removeEvents('click');

                finputs.each(function(r) {                  

                    $(r).addEvents({
                        'change': function(e) {                 
                            //e.preventDefault();
                            alert(r.name);                                          

                            new Event(e).stop();                                    
                            this.refresh(r);  // this needs to stay as refresh calls some ajax stuff            
                        }.bind(this)
                    });     
                }.bind(this)); 

                // ...
            },

            // refresh is called from various methods
            refresh : function(el) {    

                if(el) {
                    // count types checkboxes
                    var ob_checked = 0;
                    $$('.otypes').each(function(r) {
                        // uncheck all if clicked on "All"
                        if(el.id == 'typ-0') {
                            r.checked = false;
                        }
                        r.checked == true ? ob_checked++ : 0 ;
                    })

                    // check "All" if non selected
                    if(ob_checked == 0) {
                        $('typ-0').checked = true;
                    }
                    // uncheck "All" if some selected
                    if(el.id != 'typ-0' && ob_checked != 0) {
                        $('typ-0').checked = false;
                    }

                    // ajax call ...
                }
            }
        });
        eventz.implement(new Options);  

        window.addEvent('domready', function(){
            c = new eventz();
        });

    </script>

  </head>
  <body>
    <fieldset class="types">        
        <input type="checkbox" class="trig" name="otypes[]" value="0" id="typ-0" checked="checked">All
        <input id="typ-14" value="14" name="otypes[]" type="checkbox" class="otypes trig">Type A
        <input id="typ-17" value="17" name="otypes[]" type="checkbox" class="otypes trig">Type B
    </fieldset> 
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T08:48:28.523

基本上在 MooTools 1.4.4+ 中，更改事件已在 IE 中“标准化”：

*   看到这个代码：[https ://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Event.js#L170-183](https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.Event.js#L170-183)
*   这个问题：[https ://github.com/mootools/mootools-core/issues/2170](https://github.com/mootools/mootools-core/issues/2170)

它跟踪初始提交和修复。

关于您的代码，需要进行一些更改：

1.  `new Event(e).stop();` 必须重写为：`e.stop();`
2.  `implements`方法现在是一个突变键：`Implements`

整个事情可以简化很多。这是一个示例重构，针对性能进行了一些优化，逻辑更清晰。

[http://jsfiddle.net/M2dFy/5/](http://jsfiddle.net/M2dFy/5/)

就像是：

```
var eventz = new Class({
    options: {

    },

    Implements: [Options],

    initialize: function(options) {
        this.setOptions(options);
        this.setup();
        this.jx = 0;

    },
    setup: function() {
        this.makeEvents();
        // ...
    },

    makeEvents: function() {
        var finputs = $$('.trig');

        finputs.removeEvents('change');
        finputs.removeEvents('click');

        var self = this;
        this.type0 = $('typ-0');
        this.otypes = $$('.otypes');
        this.pause = false; // stop flag because of IE

        finputs.each(function(r) {

            r.addEvents({
                click: function(e) {
                    this.pause || self.refresh(r); // this needs to stay as refresh calls some ajax stuff            
                }
            });
        });

        // ...
    },

    // refresh is called from various methods
    refresh: function(el) {
        this.pause = true;
        if (el !== this.type0) {
            // count types checkboxes
            this.type0.set('checked', !this.otypes.some(function(other) {
                return !!other.get("checked");
            }));

            // ajax call ...
        }
        else {
            this.otypes.set('checked', false);
        }
        this.pause = false;
    }
}); 
```

现在，鉴于您拥有的代码，当您更改时`.checked`，它将触发`propertychange` 尝试使事件冒泡。

我建议`checked`通过`.set`and`.get`方法更改所有访问权限，例如。`el.set('checked', true);`/ `el.get('checked')`- id 或任何其他属性的类似用途。

希望这足以让您走上正确的道路，如果您要在 jsfiddle 中构建一个具有最小 DOM 的示例，我将很乐意再次查看它。

我这里没有 IE（mac），但我怀疑它可能会在单击非全部复选框时中断，因为这会触发。

我建议转向点击事件，尽管这会使标签无效：http: [//jsfiddle.net/M2dFy/4/](http://jsfiddle.net/M2dFy/4/)

# iphone - 如何使用 Objective C 处理关闭具有多任务处理的应用程序？

> ID：10182385
> 
> 赞同：1
> 
> 时间：2012-04-16T22:05:16.113
> 
> 标签：iphone, objective-c, ios, ios-simulator, multitasking

我在这里和那里阅读了一些关于多任务处理的点点滴滴，但我不确定我是否掌握了所有内容。基本上，我有一个在 iPhone 模拟器上运行良好的 iPhone 应用程序（我还没有支付开发费用才能部署到实际的 iPhone）。

在模拟器中，我可以毫无问题地进入和退出应用程序。当我打开多任务栏（双击主页按钮）时，我可以关闭应用程序。当我尝试重新打开它时，我得到一个错误。

我想知道，这是因为测试从多任务处理关闭和打开应用程序只能在实际的 iPhone 上进行，还是我应该听一些额外的事件？我读过这个： http: [//www.cocos2d-iphone.org/forum/topic/8767](http://www.cocos2d-iphone.org/forum/topic/8767)并添加了一些处理程序，但这篇文章感觉过时了，它并没有改变任何东西。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:07:29.113

关于 SIGKILL 的帖子是正确的。这是您的应用程序的正常行为。Xcode 只是报告上次杀死您的应用程序的原因。只需停止执行并再次运行您的应用程序，就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T03:20:38.013

正如理查德所说，这很正常。如果你想自己测试：

1.  使用 Xcode 运行应用程序。
2.  使用 Xcode 停止应用程序。（按下运行按钮右侧的停止按钮。
3.  通过在模拟器的主屏幕中单击应用程序来启动应用程序。
4.  关闭应用程序，然后从多任务栏中将其关闭。
5.  再次启动它。

祝你好运 ：）

# javascript - 如何为给定的javascript生成调用图？

> ID：10182387
> 
> 赞同：42
> 
> 时间：2012-04-16T22:05:39.770
> 
> 标签：javascript, graph, visualization, call-graph

我看过“ [https://stackoverflow.com/questions/1385335/how-to-generate-function-call-graphs-for-javascript](https://stackoverflow.com/questions/1385335/how-to-generate-function-call-graphs-for-javascript) ”，并尝试过。如果你想得到一个抽象的语法树，它工作得很好。

不幸的是，闭包编译器似乎只提供`--print_tree`,`--print_ast`和`--print_pass_graph`. 它们都对我没有用。

我想看看哪个函数调用了其他函数的图表。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-06-06T21:55:15.157

[code2flow](https://github.com/scottrogowski/code2flow)正是这样做的。完全披露，我开始了这个项目

跑步

```
$ code2flow source1.js source2.js -o out.gv 
```

然后，用 graphviz 打开 out.gv

**编辑**：目前，该项目未维护。我建议在使用 code2flow 之前尝试不同的解决方案。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-18T23:30:11.333

如果你过滤你的输出，`closure --print_tree`你会得到你想要的。

例如采取以下文件：

```
var fib = function(n) {
    if (n < 2) {
        return n;
    } else {
        return fib(n - 1) + fib(n - 2);
    }
};

console.log(fib(fib(5))); 
```

过滤输出`closure --print_tree`

```
 NAME fib 1 
                FUNCTION  1 
                                    CALL 5 
                                        NAME fib 5 
                                        SUB 5 
                                            NAME a 5 
                                            NUMBER 1.0 5 
                                    CALL 5 
                                        NAME fib 5 
                                        SUB 5 
                                            NAME a 5 
                                            NUMBER 2.0 5 
        EXPR_RESULT 9 
            CALL 9 
                GETPROP 9 
                    NAME console 9 
                    STRING log 9 
                CALL 9 
                CALL 9 
                    NAME fib 9 
                    CALL 9 
                    CALL 9 
                        NAME fib 9 
                        NUMBER 5.0 9 
```

你可以看到所有的调用语句。

我编写了以下脚本来执行此操作。

`./call_tree`

```
#! /usr/bin/env sh
function make_tree() {
    closure --print_tree $1 | grep $1
}

function parse_tree() {
    gawk -f parse_tree.awk
}

if [[ "$1" = "--tree" ]]; then
    make_tree $2
else
    make_tree $1 | parse_tree
fi 
```

`parse_tree.awk`

```
BEGIN {
    lines_c = 0
    indent_width = 4
    indent_offset = 0
    string_offset = ""
    calling = 0
    call_indent = 0
}

{
    sub(/\[source_file.*$/, "")
    sub(/\[free_call.*$/, "")
}

/SCRIPT/ {
    indent_offset = calculate_indent($0)
    root_indent = indent_offset - 1
}

/FUNCTION/ {
    pl  = get_previous_line()
    if (calculate_indent(pl) < calculate_indent($0))
        print pl
    print
}

{
    lines_v[lines_c] = $0
    lines_c += 1
}

{
    indent = calculate_indent($0)
    if (indent <= call_indent) {
        calling = 0
    }
    if (calling) {
        print
    }
}

/CALL/ {
    calling = 1
    call_indent = calculate_indent($0)
    print
}

/EXPR/{
    line_indent = calculate_indent($0)
    if (line_indent == root_indent) {
        if ($0 !~ /(FUNCTION)/) {
            print
        }
    }
}

function calculate_indent(line) {
    match(line, /^ */)
    return int(RLENGTH / indent_width) - indent_offset
}

function get_previous_line() {
    return lines_v[lines_c - 1]
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-09T18:39:48.773

我最终使用[UglifyJS2](https://github.com/mishoo/UglifyJS2)和[Dot/GraphViz](http://graphviz.org/Documentation.php)管理了这个，结合了上述答案和链接问题的答案。

对我来说，缺少的部分是如何过滤解析的 AST。事实证明，UglifyJS 有 TreeWalker 对象，它基本上对 AST 的每个节点都应用了一个函数。这是我到目前为止的代码：

```
//to be run using nodejs
var UglifyJS = require('uglify-js')
var fs = require('fs');
var util = require('util');

var file = 'path/to/file...';
//read in the code
var code = fs.readFileSync(file, "utf8");
//parse it to AST
var toplevel = UglifyJS.parse(code);
//open the output DOT file
var out = fs.openSync('path/to/output/file...', 'w');
//output the start of a directed graph in DOT notation
fs.writeSync(out, 'digraph test{\n');

//use a tree walker to examine each node
var walker = new UglifyJS.TreeWalker(function(node){
    //check for function calls
    if (node instanceof UglifyJS.AST_Call) {
        if(node.expression.name !== undefined)
        {
        //find where the calling function is defined
        var p = walker.find_parent(UglifyJS.AST_Defun);

        if(p !== undefined)
        {
            //filter out unneccessary stuff, eg calls to external libraries or constructors
            if(node.expression.name == "$" || node.expression.name == "Number" || node.expression.name =="Date")
            {
                //NOTE: $ is from jquery, and causes problems if it's in the DOT file.
                //It's also very frequent, so even replacing it with a safe string
                //results in a very cluttered graph
            }
            else
            {

                fs.writeSync(out, p.name.name);
                fs.writeSync(out, " -> ");
                fs.writeSync(out, node.expression.name);
                fs.writeSync(out, "\n");
            }
        }
        else
        {
            //it's a top level function
            fs.writeSync(out, node.expression.name);
            fs.writeSync(out, "\n");
        }

    }
}
if(node instanceof UglifyJS.AST_Defun)
{
    //defined but not called
    fs.writeSync(out, node.name.name);
    fs.writeSync(out, "\n");
}
});
//analyse the AST
toplevel.walk(walker);

//finally, write out the closing bracket
fs.writeSync(out, '}'); 
```

我用[node](http://nodejs.org/)运行它，然后将输出通过

`dot -Tpng -o graph_name.png dot_file_name.dot`

笔记：

它提供了一个非常基本的图表——只有黑白，没有格式。

正如[其他人提到](https://stackoverflow.com/a/9746719/1856824)`eval`的那样，它根本没有捕获 ajax，并且可能不是类似的东西。`with`

此外，就目前而言，它在图中包括：由其他函数调用的函数（以及因此调用其他函数的函数），独立调用的函数，以及已定义但未调用的函数。

由于这一切，它可能会遗漏相关的内容，或包含不相关的内容。不过，这是一个开始，似乎完成了我所追求的目标，也是最初导致我提出这个问题的原因。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T16:44:04.313

[https://github.com/mishoo/UglifyJS](https://github.com/mishoo/UglifyJS) 允许访问 javascript 中的 ast。

ast.coffee

```
util = require 'util'
jsp = require('uglify-js').parser

orig_code = """

var a = function (x) {
  return x * x;
};

function b (x) {
  return a(x)
}

console.log(a(5));
console.log(b(5));

"""

ast = jsp.parse(orig_code)

console.log util.inspect ast, true, null, true 
```

# pex - 安装后在 VS2010 中看不到“运行 Pex”

> ID：10182389
> 
> 赞同：0
> 
> 时间：2012-04-16T22:05:55.487
> 
> 标签：pex

我在我的 Windows 7 机器上安装了 Pex（Visual Studio 2010 Pex 0.94.51023.0 Power Tools (x64) - (English)）。但是，当我在 VS2010 中右键单击一段代码时，我没有看到“运行 Pex”选项。当我使用 VS2008 打开另一个项目时，它是可见的。知道为什么该选项没有出现在 VS2010 中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T08:06:47.420

首先，您是否尝试过重新安装 Pex？

否则，正如[这里](https://stackoverflow.com/questions/6928798/run-pex-does-not-appear-on-rightclick)所经历的，如果 Pex 认为您的项目是一个测试项目，例如因为它引用了一些单元测试框架或 Microsoft.Pex.Framework，那么 Pex 将只探索标有该`[PexMethod]`属性的方法。否则，Pex 应该允许探索任何公共方法。这可能是你的问题吗？

否则，如果您在 VS 2008 和 VS 2010 之间切换，可能会遇到[这个问题](https://stackoverflow.com/questions/6816357/running-pex-with-net-3-5-projects)。

# c# - 如何从需要日期时间的 MVC 调用存储过程

> ID：10182395
> 
> 赞同：4
> 
> 时间：2012-04-16T22:06:37.877
> 
> 标签：c#, entity-framework, stored-procedures

我想用输入参数调用这个存储过程：

```
proc [dbo].[Invoice_GetHomePageInvoices] (

      @FinancialYearStartDate datetime = null
,      @FinancialYearEndDate datetime = null 
```

问题是我通常从我的代码中调用存储过程的方式是：

```
return _db.Database.SqlQuery<HomePageInvoice>(string.Format("EXEC Invoice_GetHomePageInvoices @FinancialYearStartDate = '{0}', @FinancialYearEndDate = '{1}'", financialYear.StartDate.ToString(), financialYear.EndDate.ToString())); 
```

所以这行不通，因为我基本上已经将我的日期时间转换为字符串。

我到底该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T22:11:45.043

你应该使用**sql 参数**，基本上是这样的：

```
var startDate = new SqlParameter("FinancialYearStartDate", dateTimeValueHere);
var endDate = new SqlParameter("FinancialYearEndDate", dateTimeValueHere);

return _db.Database.SqlQuery<HomePageInvoice>("Invoice_GetHomePageInvoices", startDate, endDate); 
```

更多信息：[如何将 DbContext.Database.SqlQuery<TElement>(sql, params) 与存储过程一起使用？EF 代码优先 CTP5](https://stackoverflow.com/questions/4873607/how-to-use-dbcontext-database-sqlquerytelementsql-params-with-stored-proced)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:16:25.370

1.  将日期转换为具有特定格式的字符串。
2.  使用 SQL 代码将其转换回 sql 日期时间对象。

使用 sql server (microsoft) 时：http: [//msdn.microsoft.com/en-us/library/ms187928.aspx](http://msdn.microsoft.com/en-us/library/ms187928.aspx) "convert(datetime, '{0}', 103)", financialYear.EndDate.ToString("MM /dd/yyyy")

编辑：Ropstah 的方法实际上更好，这正是我以前的做法：P

# windows-phone-7 - 如何使用加速度计查找设备位置变化？

> ID：10182407
> 
> 赞同：2
> 
> 时间：2012-04-16T22:08:16.487
> 
> 标签：windows-phone-7, windows-phone-7.1, accelerometer

我正在设计一个 Windows Phone 7 项目，我需要确定设备的位置变化。我尝试使用加速度计，但它提供了有关我手机当前方向的信息，我不知道如何将此数据转换为位置增量。这是一些示例代码：

```
void acc_CurrentValueChanged(object sender, SensorReadingEventArgs<AccelerometerReading> e)
{
    AccelerometerReading newdata = e.SensorReading;
    Vector3 vect = newdata.Acceleration - data.Acceleration;
    //what comes here???
} 
```

当加速度计数据发生变化时，会调用上述方法。但我不知道如何将此数据转换为设备的位置变化（即我将手机沿 X 方向移动）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T08:51:33.620

[你不能这样做。](https://stackoverflow.com/a/7835988/341970)

您可以通过两次积分线性加速度来获得位置，但**误差很可怕。在实践中是没有用的。**

请参阅上面链接的答案以了解您实际可以做什么。

# mysql - 计算mysql查询中所有匹配的字段

> ID：10182408
> 
> 赞同：3
> 
> 时间：2012-04-16T22:08:40.587
> 
> 标签：mysql

我的问题是下一个：我有一个这样的 mysql 查询：

```
SELECT student_id, name, email 
FROM student 
WHERE student_id IN ('1', '2', '3') 
    OR name LIKE '%Nick%' 
    OR email LIKE '%gmail.com%' 
```

如何以mysql返回的列的形式获取匹配字段的数量 像这样：

```
 ID NAME  EMAIL           MATCHED  
1\. 1  Nick  nick@gmail.com  3  
2\. 5  Nick  nick@yahoo.com  1  
3\. 2  David david@gmail.com 2 
```

谢谢！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-16T22:16:34.903

这很丑陋，但类似

```
SELECT student_id, name, email,
   IF(student_id IN (1,2,3), 1, 0) +
   IF(name LIKE '%Nick%', 1, 0) +
   IF(email LIKE '%gmail.com%', 1, 0) AS matched
etc... 
```

应该做的伎俩。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T22:12:10.307

这应该工作

```
SELECT student_id, name, email, 
     (
        CASE WHEN student_id IN ('1', '2', '3') THEN 1 END +
        CASE WHEN name LIKE '%Nick%' THEN 1 END +
        CASE WHEN email LIKE '%gmail.com%' THEN 1 END
     ) as matched
FROM student 
WHERE student_id IN ('1', '2', '3') 
    OR name LIKE '%Nick%' 
    OR email LIKE '%gmail.com%' 
```

# bison - Flex-BISON：如何定义一个句子？

> ID：10182411
> 
> 赞同：1
> 
> 时间：2012-04-16T22:09:01.207
> 
> 标签：bison, definition, flex-lexer

在 Flex 中，您使用 [a-zA-Z][a-zA-Z0-9]* 来定义一个词。如何定义一个句子？以下是我的弹性代码：

```
%{
#include <stdio.h>
#include <string.h>
#include "y.tab.h"
%}
%%
[0-9]+                  yylval=atoi(yytext);return NUMBER;
[a-zA-Z][a-zA-Z]*       return WORD;
[a-zA-Z][a-zA-Z0-9]*    return TERM;
%% 
```

以下是野牛：

```
%{
#include <stdio.h>
#include <string.h>

void yyerror(const char *str)
{
    fprintf(stderr,"error: %s\n",str);
}

int yywrap()
{
    return 1;
}

main()
{
    yyparse();
}

%}

%token NUMBER WORD TERM 

commands: /* empty */
    | commands command
    ;
command:
    rule1
    |
    rule2
; 
```

......

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T14:36:26.487

Flex 或 lex 是词法分析器解决方案，它们的输出通常是您之前定义的令牌 whitch，它可以是一个世界、一个数字或一个术语。另一方面，yacc 或 bison 是解析器，我们在其中定义我们的语法（规则集），它应该验证您将通过的输入流，在您的情况下，这里是一个句子。

所以现在回答你的问题：经过验证的句子是由我们语法中定义的规则验证的句子，例如：“hello world”。已通过此规则验证

```
sentence : WORD WORD '.'
         ; 
```

或者这句话“我有20岁”所以规则必须是这样的

```
sentence    : words NUMBER words      /*words non terminal (list of words)*/
            ;
words       : words WORD
            | WORD
            ; 
```

因此，您可以在知道要解析的输入流的情况下定义规则。

# django - 为 Field.default 创建一个 Django 可调用对象

> ID：10182413
> 
> 赞同：1
> 
> 时间：2012-04-16T22:09:04.830
> 
> 标签：django

我正在尝试创建一个可调用对象以在创建新实例时返回用于字段的默认值。

该值的逻辑取决于模型中的其他数据。我尝试创建一个单独的课程，但没有找到正确的因素组合。例子：

在models.py中：

```
Class Box(models.Model):
    inv_id = models.CharField(max_length=16,default=gen_inv_id()) 
```

可调用对象将需要查询数据库模型并增加表值。我尝试在应用程序下的单独 .py 模块中创建一个类，但它需要一个返回值的方法。在这一点上，OO 不是我的强项。我认为该模型已失效，方法取决于它，因此似乎出现了先有鸡/先有蛋的场景。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T22:28:14.783

自永远（1.0 天之前）以来，默认关键字支持可调用对象。您的代码的问题是您没有传入可调用的（`default=gen_inv_id`），而是可调用的（）的结果`default=gen_inv_id()`。

所以你可能想做：

```
Class Box(models.Model):
    inv_id = models.CharField(max_length=16,default=gen_inv_id) 
```

查看描述此内容的最新版本的文档： [https ://docs.djangoproject.com/en/1.4/ref/models/fields/#default](https://docs.djangoproject.com/en/1.4/ref/models/fields/#default)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:13:09.587

我以前遇到过这个。您可以做的一件事是覆盖类的保存方法，以便您首先保存进行计算所需的参数，然后进行计算并重新保存。如果您要覆盖 save 方法，则需要调用 super.save() （我忘记了确切的符号是什么）

编辑： super.save 的符号是 super(Model, self).save(*args, **kwargs)

# javascript - 如何始终从 JavaScript 对象字面量调用函数，而不仅仅是在创建对象时

> ID：10182416
> 
> 赞同：1
> 
> 时间：2012-04-16T22:09:08.420
> 
> 标签：javascript, jquery, kendo-ui

我希望我的标题不会太混乱。先举个例子。我有以下代码为[Kendo UI](http://www.kendoui.com/documentation/introduction.aspx)数据源配置读取操作。我正在尝试根据所选公司 ID 过滤所有读取，但我的`getSelectedCompanyId`函数只在页面加载时被调用一次。下面的代码太长了，这里不能全部包含，所以只是摘录。

```
$(function () {
    function getSelectedCompanyId() {
        var id = $("#CompanyId").val();
        return id;
    }

    $("#CompanyId").kendoDropDownList({
        change: function () {
            grid.dataSource.read();
        }
    });
    var departmentIndexDataSource = new kendo.data.DataSource({
        transport: {
            read: {
                url: '@Url.Action("ListForCompanyIdJson", "Department")' + '?companyId=' + getSelectedCompanyId(),
                type: "GET"
            }, 
```

`ListForCompanyIdJson`调用时始终使用下拉列表中选择的值调用该操作`$("#CompanyId").kendoDropDownList()`。我希望在我调用时调用此函数`grid.dataSource.read()`。

我意识到这可能与 Kendo 的东西高度相关，但也许这是我可以通过简单的 JavaScript 闭包和一些帮助来解决的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:11:12.343

你可以安装一个替换函数，`grid.dataSource.read()`它总是先调用你的函数，然后调用`grid.dataSource.read()`.

例如：

```
grid.dataSource.oldRead = grid.dataSource.read;
grid.dataSource.read = function() {
    // call your function here
    return grid.datasource.oldRead.apply(this, arguments);
} 
```

或者，如果您希望能够有时调用一次，然后再调用一次，您可以创建一个提供新行为的新方法，并在需要时使用它：

```
grid.dataSource.myread = function() {
    // call your function here
    return grid.datasource.read.apply(this, arguments);
} 
```

# indexing - CUDA 中的棋盘索引

> ID：10182417
> 
> 赞同：1
> 
> 时间：2012-04-16T22:09:16.363
> 
> 标签：indexing, cuda

所以，这就是问题所在。我想在 CUDA 中进行计算，其中我有一个大的一维数组（代表一个晶格），我将它划分为长度为#part 的子数组，并且我希望每个线程对每个子数组进行几次计算。

更具体地说，假设我们有许多线程#threads 和许多块#blocks。该数组的大小为 N = 2 * #part * #threads * #blocks。如果我们将子数组从 1 编号到 2*#blocks*#threads，我们希望首先使用 #threads*#blocks 线程对偶数子数组进行计算，然后使用相同数量的线程对子数组进行计算具有奇数的子数组。

我认为我可以在每个线程中都有一个本地索引，它表示它的子数组将从哪里开始。

所以，我使用了以下索引：

```
localIndex = #part * (2 * threadIdx.x + var) + 2 * #part  * #Nthreads * blockIdx.x; 
```

var 是 1 或 0，取决于我们是否想让线程在具有偶数或奇数的子数组上进行计算。

我尝试运行它，但当我使用多个块时似乎出现问题。我在索引方面做错了吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:49:18.683

为什么线程首先共同执行偶数，然后是奇数子数组很重要，因为不能保证块和线程执行顺序没有任何好处？

假设您仅使用 x-dimension 为您的内核维度设置建立索引：

```
subArrayIndexEven = 2 * (blockIdx.x * blockDim.x + threadIdx.x) * part  
subArrayIndexOdd = subArrayIndexEven + part 
```

**证明：**

BLOCK_SIZE = 3
NUM_OF_BLOCKS = 2
部分 = 4

N = 2 * 3 * 2 * 4 = 48

T(threadIdx.x, blockIdx.x)
T(0, 1) -> 偶数 = 2 * (1 * 3 + 0) * 4 = 24, 奇数 = 28
T(1, 1) -> 偶数 = 2 * ( 1 * 3 + 1) * 4 = 32，奇数 = 36
T(2, 1) -> 偶数 = 2 * (1 * 3 + 2) * 4 = 40，奇数 = 44

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T22:52:57.480

```
idx = threads_per_block*blockIdx.x + threadIdx.x;
int my_even_offset, my_odd_offset, my_even_idx, my_odd_idx;

int my_offset = floor(float(idx)/float(num_part)); 
my_even_offset = 2*my_offset*num_part;
my_odd_offset = (2*my_offset+1)*num_part;

my_even_idx = idx + my_even_offset;
my_odd_idx  = idx + my_odd_offset;

//Do stuff with the indices. 
```

# asp.net-mvc - Twitter Bootstrap 与输入之间的 MVC 填充

> ID：10182418
> 
> 赞同：3
> 
> 时间：2012-04-16T22:09:18.443
> 
> 标签：asp.net-mvc, twitter-bootstrap

我正在使用 MVC 和引导程序来创建一个网站，并且大部分时间都在尝试使用它并发现以下内容：

在导航栏中创建内联表单时，我注意到输入元素之间的间距不正确。我想我发现这是由 Razor 引擎生成的标记引起的，它们彼此相邻呈现的元素之间没有空白，没有任何间距。但我不确定如何解决它。

*这是无效行为的[jsfiddle](http://jsfiddle.net/NPXgH/)。*

## 剃刀

```
@using (Html.BeginForm("JsonLogin", "Account", FormMethod.Post, new { @class = "navbar-form" }))
{
    @Html.TextBoxFor(m => m.UserName, new { @class = "input-small", placeholder = @Html.DisplayNameFor(m => m.UserName) })
    @Html.PasswordFor(m => m.Password, new { @class = "input-small", placeholder = @Html.DisplayNameFor(m => m.Password) })
} 
```

## html

```
<form class="navbar-form">
    <input type="text" class="input-small" placeholder="Email"><input type="password"  class="input-small" placeholder="Password">
</form> 
```

*这是有效行为的[jsfiddle](http://jsfiddle.net/3e3rZ/)。*

## html

```
<form class="navbar-form">
    <input type="text" class="input-small" placeholder="Email">
    <input type="password" class="input-small" placeholder="Password">
</form> 
```

关于如何解决这个问题的任何想法？我猜我在引导程序中遗漏了一些东西。​</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T23:21:09.357

据我所知，只有当输入元素是表单元素的直接子元素时，才会出现这种行为。

尝试

```
@using (Html.BeginForm("JsonLogin", "Account", FormMethod.Post, new { @class = "navbar-form" }))
{
<div>
    @Html.TextBoxFor(m => m.UserName, new { @class = "input-small", placeholder = @Html.DisplayNameFor(m => m.UserName) })
    @Html.PasswordFor(m => m.Password, new { @class = "input-small", placeholder = @Html.DisplayNameFor(m => m.Password) })
</div>
} 
```

并且您应该在输入元素之间获得空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:20:35.327

文本框上没有左边距或右边距，因此当输入元素之间没有空白时，它们应该彼此相邻。如果有空格，inline-block 元素将在元素之间呈现 4px 的边距。

要解决此问题，您可以将元素放在同一行且没有空格，或者将两个元素浮动到左侧。

# c++ - 打印队列中的数组

> ID：10182419
> 
> 赞同：1
> 
> 时间：2012-04-16T22:09:30.310
> 
> 标签：c++, arrays, queue

我在打印队列中使用的数组内容时遇到问题。

我的模板队列的一部分：

```
#include <iostream>
#include <cstdlib>
using namespace std;

template<class T>
class Queue
{
private:
    int front;      //front position
    int rear;       //rear position
    int maxQue;     //maximum number of elements in the queue
    T* items;       //points to a dynamically-allocated array code here
public:
    Queue()  // default constructor: Queue is created and empty
    {
        front = -1;
        rear = 0;
        maxQue = 10;
        items = new T[maxQue];
    }

    void Print()   // print the value of all elements in the queue
    {
        while(front != rear)
        {
            cout<<items[front];
            front++;
            if(front==rear)
               break;
            cout<<" - ";
        }
        cout<<endl;
    }

    void Enqueue(T add)      // insert x to the rear of the queue
    {                           // Precondition: the queue is not full
        if(IsFull())
        {
             cout<<"Queue is full!"<<endl;
        }
        else
        {
             items[rear] = add;
             rear++;
             rear = rear % maxQue;
        }
    }

    void Dequeue(T &x)  // delete the element from the front of the queue
    {                       // Precondition: the queue is not empty
         if(!IsEmpty())
         {
             front = (front+1)%maxQue;
             x = items[front];
         }
    }

    bool IsEmpty()   // test if the queue is empty
    {
         return (rear==front);
    } 

    bool IsFull()   // test if the queue is full
    {
         return ((rear+1)%maxQue==front);
    }

    int length()    // return the number of elements in the queue
    {
         return abs(rear-front);
    }

    ~Queue()  // Destructor:  memory for the dynamic array needs to be deallocated
    {
         delete [] items;
    }
}; 
```

主程序的一部分：

```
int main()
{
     Queue<float>FloatQueue;
     float y;
     FloatQueue.MakeEmpty();

     FloatQueue.Dequeue(y);
     FloatQueue.Enqueue(7.1);
     cout << "float length 3 = " << FloatQueue.length() << endl;

     FloatQueue.Enqueue(2.3);
     cout << "float length 4 = " << FloatQueue.length() << endl;

     FloatQueue.Enqueue(3.1);
     FloatQueue.Dequeue(y);
     cout << "The float queue contains:  ";
     FloatQueue.Print();

     return 0;
} 
```

代码编译得很好，直到它尝试打印，此时我得到了这些错误。

```
0 00000000  0x00466a7f in std::__convert_from_v() (??:??)  
1 00000000  0x00430302 in std::num_put<char, std::ostreambuf_iterator<char, std::char_traits<char> > >::_M_insert_float<double>() (??:??)  
2 00000000  0x00430da8 in std::num_put<char, std::ostreambuf_iterator<char, std::char_traits<char> > >::do_put() (??:??)  
3 00000000  0x00447455 in std::ostream::_M_insert<double>() (??:??)  
4 00000000  0x00448988 in std::ostream::operator<<() (??:??)  
5 0041CB37  Queue<float>::Print(this=0x28ff00) 
```

我已经坚持了几天了，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:34:53.327

看起来您正在实现一个固定大小的循环缓冲区。如果是这样（或者即使不是），您会遇到一些问题：

1.  如果您在从队列中取出任何内容之前排队超过队列的最大大小，则它永远不会注册为已满。
2.  如果您的“前”指针大于后指针，则您的打印功能将永远不会停止，并且前将继续直到 MAX_INT 并且可能再次循环。您没有对缓冲区的最大大小进行 mod 操作。
3.  您没有析构函数，因此每次创建和销毁这些对象之一时，缓冲区都会泄漏。
4.  您的长度函数不正确。任何时候front大于rear（这是时间的一半）都会出错。这样想，当它满了时，大小会说为零。

也许还有其他一些事情。我会重新考虑你的设计。你很接近，但你有一些数学错误。

# php - Gmagick 有像 Imagick::thresholdImage 这样的方法吗？

> ID：10182425
> 
> 赞同：0
> 
> 时间：2012-04-16T22:09:43.263
> 
> 标签：php, imagick, gmagick

我正在尝试使用 PHP 的 pecl 模块 Gmagick 创建一个脚本，以从图像中删除一些白色的背景。在命令行上，我对 imagemagick 使用以下两个命令：

```
convert source.jpg \( +clone -fx 'p{0,0}' \) \
        -compose Difference -composite  \
        -modulate 100,0 -alpha off -threshold 10% source_mask.png

convert source.jpg source_mask.png \
        -alpha Off -compose CopyOpacity -composite \
        source_transparent.png 
```

我已经能够采取最初的几个步骤：

```
$source_gm = new Gmagick();
$source_gm->readImage($source_path);

$white_gm = new Gmagick();
$white_gm->newImage($source_gm->getImageWidth(), $source_gm->getImageHeight(), 'white', 'png');

$mask_image = $source_gm->compositeImage($white_gm, Gmagick::COMPOSITE_DIFFERENCE, 0, 0);
$mask_image->modulateImage(100, 0, 0); 
```

Gmagick 模块有某种常数，应该用于阈值`Gmagick::COMPOSITE_THRESHOLD`。但是，没有关于如何使用它的提示。有人可以帮我解决门槛吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T13:15:41.580

我发现在 gmagick 中还没有 thresholdImage 函数。该功能已[在 SVN 中实现](http://svn.php.net/viewvc?view=revision&revision=323357)，但尚未发布。

# c# - 为什么 List.Contains 不适用于我的代码？

> ID：10182427
> 
> 赞同：1
> 
> 时间：2012-04-16T22:09:53.903
> 
> 标签：c#, list, contains

我正在使用 List.Contains 来判断变量是否在列表中，但它会不断返回它不在的时候。

我查阅了[MSDN](http://msdn.microsoft.com/en-us/library/bhkz42b3.aspx)，发现我必须继承 IEquatable 并实现我自己的 .Equals 方法。实际的类是从另一个类继承的，所以我**在基类中**编写了 .Equals 方法。

这是“Actividad”类的代码：

```
abstract public class Actividad:IEquatable<Actividad> {

    protected int codigo;

    [...]

    public bool  Equals(Actividad otra)
    {
        return this.Codigo == otra.Codigo;
    }   
} 
```

这是子类“Actividad_a”的定义：

```
public class Actividad_a : Actividad{ [...] } 
```

这是检查列表中是否有内容的代码：

```
private void loadDisponibles() {

    foreach (Actividad_a act in Program.Asignaturas) {

        if (!user1.ActAcademicas.Contains(act)) {
           doSomething();
        }
    }
} 
```

`Program.Asignaturas`并且`user1.ActAcademicas`都定义为`List<Actividad_a>`。

问题是`!user1.ActAcademicas.Contains(act)`无论数据是否在列表中，它总是返回 true。

我的第一个猜测是我必须从 IEquatable 继承并在每个派生类中实现 .Equals 方法，但我不太确定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:18:58.463

您正在比较 Actividad_a 并且 Contains 方法期望它实现`IEquatable<Actividad_a>`而不是`IEquatable<Actividad>`

尝试覆盖默认的 Equals 方法

```
public override bool Equals(object otra)
{
    var actividad = otra as Actividad;
    if (actividad == null) return false;
    return this.Codigo == actividad.Codigo;
} 
```

编辑：

更多信息：.NET 4.0 引入了使用称为逆变和协方差的泛型的灵活性[http://msdn.microsoft.com/en-us/library/dd799517.aspx](http://msdn.microsoft.com/en-us/library/dd799517.aspx)

> 协变和逆变泛型类型参数在分配和使用泛型类型方面提供了更大的灵活性。例如，协变类型参数使您能够进行看起来很像普通多态性的赋值。假设您有一个基类和一个派生类，分别命名为 Base 和 Derived。多态性使您能够将 Derived 的实例分配给 Base 类型的变量。同样，因为 IEnumerable(Of T) 接口的类型参数是协变的，所以可以将 IEnumerable 的实例（Visual Basic 中的 IEnumerable(Of Derived)）赋值给 IEnumerable 类型的变量
> 
> 一般来说，协变类型参数可以作为委托的返回类型，逆变类型参数可以作为参数类型。对于接口，协变类型参数可以作为接口方法的返回类型，逆变类型参数可以作为接口方法的参数类型。

出于某种原因`IEquatable<T>` [，没有进行逆变](https://stackoverflow.com/questions/3289440/why-was-iequatable-t-not-made-contravariant-in-t-for-c-sharp-4-0)，为什么您的原始方法不起作用

# c# - 使用 C# 将 MemoryStream 转换为 FileStream？

> ID：10182433
> 
> 赞同：3
> 
> 时间：2012-04-16T22:11:00.003
> 
> 标签：c#, filestream, memorystream

我正在开发一个接收 FileStream 的项目，它应该使用返回 MemoryStream 的方法接收它。

**如何将 MemoryStream 转换为 FileStream？**我无法触摸这些代码，这就是整个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:29:59.260

如果我正确理解了您的问题，则您有一个返回 MemoryStream 的方法，并且您需要将该流传递给采用 FileStream 的方法。我见过几个例子，当参数类型可能是 Stream 时，我的同事编写了带有 FileStream 参数的方法。这是一个很好的例子，说明为什么最好对参数使用派生较少的类型。

我能想到的唯一解决方案是将内存流写入临时文件：为临时文件创建文件流，将内存流复制到文件流中，然后将位置设置为零或关闭流并打开同一文件上的新流，以传递给该方法。

如果我误解了你的问题，请澄清。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:15:23.953

这已在[Convert a Stream to a FileStream in C# 中讨论过](https://stackoverflow.com/questions/3769067/convert-a-stream-to-a-filestream-in-c-sharp)

# java - 用模拟的构造函数参数模拟抽象类？

> ID：10182442
> 
> 赞同：7
> 
> 时间：2012-04-16T22:11:55.253
> 
> 标签：java, spring, unit-testing, mocking, mockito

我想使用 Mockito 对抽象类进行单元测试，如this [great answer中所述。](https://stackoverflow.com/a/4317631/589215)

诀窍是，抽象类依赖于注入其构造函数的策略。我已经创建了该策略的模拟，并且我希望我的 BaseClass 模拟实例将模拟策略用于我的单元测试。

关于如何连接它的任何建议？我目前没有使用任何 IoC 框架，但正在考虑使用 Spring。也许它会成功？

```
// abstract class to be tested w/ mock instance
abstract BaseClass
{
    // Strategy gets mocked too 
    protected BaseClass( Strategy strategy)
    {
        ...
    }
} 
```

**更新**：
根据 Mockito 邮件列表，目前没有办法将参数传递给模拟的构造函数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T16:16:43.730

我最终只是使用反射在我的基类中设置了一个私有字段，如下所示：

```
// mock the strategy dependency
Strategy strategyMock = mock( Strategy.class);
when(....).thenReturn(...);

// mock the abstract base class
BaseClass baseMock = mock(BaseClass.class, CALLS_REAL_METHODS);

// get the private streategy field
Field strategyField = baseMock.getClass().getSuperclass().getDeclaredField("_privateStrategy");

// make remove final modifier and make field accessible
Field modifiersField = Field.class.getDeclaredField("modifiers");
modifiersField.setAccessible(true);
modifiersField.setInt(strategyField, strategyField.getModifiers() & ~Modifier.FINAL);          
strategyField.setAccessible(true);

// set the strategy
strategyField.set(baseMock, strategyMock);

// do unit tests with baseMock
... 
```

如果私有字段的名称发生变化，它会中断，但它会被评论，我可以忍受。很简单，它是一行代码，我发现这比公开任何设置器或必须在我的测试中显式地继承子类更可取。

**编辑：** 所以它不再是一行代码，因为我的私有字段需要是“最终的”，需要一些额外的反射代码才能解决。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-16T22:15:45.640

我已经看到在春季上下文级别使用 Mockito 完成了这种事情。

例如：

```
<bean id="myStrategy" name="myStrategy" class="org.mockito.Mockito" factory-method="mock">
    <constructor-arg value="Strategy" />
</bean> 
```

我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T12:30:03.730

你不需要做任何特别的事情。像往常一样模拟 bean：

```
Bean bean = mock(Bean.class); 
when(bean.process()).thenReturn(somethingThatShouldBeNamedVO); 
```

只是工作:)

# c++ - C ++从函数，指针返回多维数组的最佳方式？

> ID：10182447
> 
> 赞同：1
> 
> 时间：2012-04-16T22:12:16.290
> 
> 标签：c++, arrays, function, pointers

我需要从函数返回一个类对象数组。我从研究中了解到，最好的方法是使用指针，但考虑到我的程序设计以及需要从多个 CPP 文件中访问它，这是最好的方法吗？

主文件

```
#include <class.h>
#include <functions.h>

int main(){
Class Object[2][]; //define second dimension here?
some_function(); //should return / create the array with filled in elements.
int var = arr[2][3]; // want to be able to do something like this in main
} 
```

函数.cpp

```
void some_function(){
// assign values
arr[2][3] = 1;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-16T22:16:17.573

你真的应该使用`std::vector<std::vector<Object> >`你的多维数组。使用原始数组很容易出错，而且既然您无论如何都在使用 C++，为什么不使用像`std::vector`在需要时自动调整大小一样有用的东西。

你甚至可以`vector`像这样从你的函数中返回：

`std::vector<std::vector<Object> > my_function() { /* do something */ return some_vector; }`

# java - 使用 JDOM 查询 XML 文件？像 SQL 但使用 XML？

> ID：10182450
> 
> 赞同：0
> 
> 时间：2012-04-16T22:12:33.523
> 
> 标签：java, xml, jdom

我现在正在用 LWJGL 制作一个 2D 游戏。我使用 JDOM 作为在 XML 文件中存储信息的基础。

我的 items.xml 文件的结构如下：

```
<items>
    <item>
        <id>1</id>
        <name>Item</name>
        <description>This is an item</description>
    </item>
</items> 
```

文件中会有很多项目。所以我希望能够选择一个特定的项目，其中标签与我要搜索的给定 id 匹配。我了解如何从文件中获取所有信息，但如何才能仅获取特定项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:16:32.110

使用 xpath - 我在工作中使用它处理 java 中的 xml 文件。这很不错。[http://www.ibm.com/developerworks/library/x-javaxpathapi/](http://www.ibm.com/developerworks/library/x-javaxpathapi/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T08:57:09.587

如果您真的希望 SQL 用于 XML，您还应该查看[XQuery](http://www.ibm.com/developerworks/xml/library/x-xjavaxquery/)。它是另一种以 XPath 为中心的技术。我相信[SaxonB](http://sourceforge.net/projects/saxon/files/Saxon-B/)提供了它的开源实现。实际使用它可能有点矫枉过正——取决于 XML 的复杂性。

# android - Android：从数据库中获取存储的视频

> ID：10182457
> 
> 赞同：0
> 
> 时间：2012-04-16T22:13:16.137
> 
> 标签：android, database, blob, inputstream, android-videoview

我已经在 SQLite Manager 中准备了 sqlite 数据库，并手动添加了所有数据。该数据库存储图像 (BLOB)、文本和视频 (BLOB) 文件。我不能只将 URL/SD 卡链接存储到视频，而是将整个文件存储在数据库中。我可以轻松地从数据库中获取文本和图像并显示在我的应用程序中。

对于下面的图像代码：

```
Cursor cursor = myDbHelper.getData(); // select from database text, images(BLOB) and videos(BLOB).  

...
ByteArrayInputStream inputStream = new ByteArrayInputStream(cursor.getBlob(1));  //image
Bitmap b = BitmapFactory.decodeStream(inputStream);  
ImageView iv = new ImageView(this);  
iv.setImageBitmap(b); 
```

它正在工作。但我不知道如何从 BLOB 获取视频并使用以下方法在 VideoView 字段中显示/播放：

```
ByteArrayInputStream inputStream = new ByteArrayInputStream(cursor.getBlob(2));  //video 
```

如何将 inputStream 转换为 VideoView 或其他格式以在应用程序中显示。请帮忙。

**编辑：**我在设备上存储了整个数据库（带有文本、图像和视频）。我连接外部数据库（MySQL）只是为了更新。在更新记录后，即电影，设备不再使用互联网连接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:20:00.727

给你汤姆，你只想做流媒体：

[https://stackoverflow.com/a/2059259/413127](https://stackoverflow.com/a/2059259/413127)

# java - Java 多数组排序

> ID：10182462
> 
> 赞同：2
> 
> 时间：2012-04-16T22:13:35.060
> 
> 标签：java, arrays, sorting, comparator

嗨，我目前有 4 个数组，它们都保存着不同的数据，我遇到的问题是我想按字母顺序对其中一个数组进行排序，通常我会这样做

```
class IgnoreCaseComparator implements Comparator<String> {
   public int compare(String strA, String strB) {
      return strA.compareToIgnoreCase(strB);
   }
}
IgnoreCaseComparator icc = new IgnoreCaseComparator();
java.util.Collections.sort(ARRAY,icc); 
```

ARRAY 将是我想要按字母顺序排序的数组，但是我需要将数组一起排序。

例如，假设我的数组看起来像这样

```
Pet Array: [Dog, Cat, Bird]
Owner Array: [Jim, Kyle, Joe]
Friend Array: [Jake, Jim, John]
Cat Array: [false, true, false] 
```

而且我想根据 Pet Array 进行排序，我的输出应该是这样的，其中所有第三个值现在都是第一个，第一个值现在是第三个（这太简化了，我的实际数组包含数千个输入）

```
Pet Array: [Bird, Cat, Dog]
Owner Array: [Joe, Kyle, Jim]
Friend Array: [John, Jim, Jake]
Cat Array: [false, true, false] 
```

有没有一种简单的方法可以做到这一点，我可以对一个数组进行排序并让其他数组跟随。感谢您对此问题的任何帮助。

**===编辑===**

除了我的解决方案略有不同，因为我做了一点阅读检查的答案是完美的，我在 compareTo 方法中只有一个稍微不同的返回线

```
 class Entity implements Comparable<Entity> {
        String Pet;
        String Owner;
        String Friend;
        int Cat;

        Entity(String Pet, String Owner, String Friend, int Cat) {
          this.Pet = Pet;
          this.Owner = Owner;
          this.Friend = Friend;
          this.Cat = Cat;
        }

        @Override
        public int compareTo(Entity other) {
            return this.Pet.compareToIgnoreCase(other.Pet);
        }
     } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T22:19:42.840

1.  您可以为以下字段创建一个`class Tuple`：`pet`、 和- `owner`，并为每个字段创建相关类型。`friend``cat`
2.  使这个类实现`Comparable`，基本上只是根据相关领域进行比较。`Comparator`[或者，或者 -为此类实现匹配]。
3.  创建一个`Tuple[] combinedArray`[或`List<Tuple>`]，并用您的数据填充它。
4.  现在，您可以对 combineArray 进行排序 - 并且您拥有所需的数据。
5.  剩下要做的就是迭代排序的数组并将数据传播回原始数组/列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-16T22:19:52.973

您可以声明一个对象：

```
class Entity implements Comparable<Entity> {
    Pet pet;
    Person owner;
    Friend friend;
    boolean cat;

    Entity(Pet pet, Person owner, Friend friend, boolean cat) {
      this.pet = pet;
      this.owner = owner;
      this.friend = friend;
      this.cat = cat;
    }

    public int compareTo(Entity b) {
      return pet.getName().compareToIgnoreCase(b.pet.getName());
    }
 } 
```

然后构建这些对象的数组或列表。还有那种。

```
Entity[] array = new Entity[pets.length];
for (int i = 0; i < pets.length) {
    array[i] = new Entity(pets[i], owners[i], friends[i], cats[i]);
}
Arrays.sort(array); 
```

之后，您可以将其拆分回数组。

```
for (int i = 0; i < pets.length) {
    pets[i] = array[i].pet;
    owners[i] = array[i].owner;
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T22:23:56.580

为什么不只创建一个数组，其中包含一个包含字段 Pet、Owner、Friend 和 Cat 的对象，并让比较器按您想要的字段排序。

```
class PetContainer { // Find a better name
    public String Pet, Owner, Friend;
    public bool Cat;
} 
```

然后把它们放在一个数组中

```
class IgnoreCaseComparator implements Comparator<PetContainer> {
    public int compare(PetContaier PA, PetContainer PB) {
        return PA.Pet.compareToIgnoreCase(PB.Pet);
    }
} 
```

这只是一个粗略的草图。制作一个 get 方法，而不是通过它们的字段访问它们，并为这些字段命名一些体面的名称。

希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T22:29:24.673

要在 java 中执行此操作，您需要编写自己的构造来执行此操作。

您正在寻找关联数组功能。要获得这种类型的功能，您可以使用哈希图或哈希表。

[http://docs.oracle.com/javase/1.5.0/docs/api/java/util/HashMap.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/HashMap.html)

```
public class CustomeDataType 
{
    private String owner;
    private String friend;
    private Boolean isCat;
    // etc
}

Map<String, CustomDataType > petArray = new HashMap<String, CustomeDataType>(); 
```

# c# - 更新列表视图内的 ListViewItem 中子项的值 c# (Winforms)

> ID：10182463
> 
> 赞同：1
> 
> 时间：2012-04-16T22:13:35.580
> 
> 标签：c#, winforms, listview, listviewitem

我想更新包含在 ListView 中的 ListviewItem 中的数据。The idea is when a row of the listview is selected, I click on a button and the data is updated .

我有这个代码：

```
ListView listView1 = new System.Windows.Forms.ListView();   
ListViewItem lv1 = new ListViewItem("me");    
lv1.SubItems.Add("my brother");    
listView1.Items.Add(lv1);

Button myB = new System.Windows.Forms.Button();

private void myB_Click(object sender, EventArgs e)
{
    listView1.SelectedItems[0]  ....... ;
} 
```

我知道如何进一步访问将“我的兄弟”的值修改为“我的妹妹”。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T22:26:20.383

检查是否选择了某些内容，然后访问 SelectedItems 中的第一个 ListViewItem

```
if(listView1.SelectedItems != null)
{
   ListViewItem item = listView1.SelectedItems[0];
   item.SubItems[0].Text = "Sister";
} 
```

这是[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.listviewitem.listviewsubitem.aspx)上 ListViewSubItem 类的参考

# java - 分叉线程并没有加快我的程序，我在我的情况下正确使用它吗？

> ID：10182465
> 
> 赞同：1
> 
> 时间：2012-04-16T22:13:49.347
> 
> 标签：java, multithreading

我想我用错了线程，所以我想问一下这是否是好的设计。基本上我有一个程序从队列中提取数据然后处理它（处理是纯数学，所以它 100% cpu 密集型），然后如果数据是好的，它发送到一个“好”队列，否则它要么完全丢弃，要么是它的一部分被发送回初始的“工作”队列以进行进一步处理。这就是它的高级逻辑，当我的队列在内存中时，我的程序使用了所有内核并且速度非常快。随着数据的增长，我决定使用队列服务器来存储队列，然后将处理分配到多台机器上，现在它的速度很慢（每个内核只使用了 40%-60%）。

我试图分析我的代码（使用 yourkit 和 netbeans 中的内置代码），它说大部分时间（80%）都花在了队列程序上。我想我可以通过将所有外部程序的东西推到另一个线程来保持我的程序中不断地处理数字，但这对性能没有帮助，我想知道我是不是弄错了。我不确定，但我想知道是否从现有线程（父线程）启动线程（子线程），是否必须在父线程完成之前完成子线程？

我的代码很大，不需要 99%，所以我只写它的高级版本（它可能无法编译，但应该让你知道我在做什么）。

```
public class worker {

    private static ExecutorService executor;
    static {
        final int numberOfThreads = 4;
        executor = new ThreadPoolExecutor(numberOfThreads, numberOfThreads, 1000, TimeUnit.SECONDS, new LinkedBlockingDeque<Runnable>());    
    }
    public static void main(String[] args) throws IOException, ShutdownSignalException, ConsumerCancelledException, InterruptedException {
        // TODO Auto-generated method stub
        System.out.println("starting worker..");
        //Connection information goes here
        channel.basicQos(50); //this is part of the connection, the queue server only gives 50 messages without acknowledgment

        while (true) {
            QueueingConsumer.Delivery delivery = consumer.nextDelivery(); //gets data from queue
            String message = new String(delivery.getBody());  
            executor.submit(new DoWork(channel, message, delivery));
        }

class DoWork implements Runnable{ //where the main work happens
    //setup variables, basically passing queue connection information as well as data here, so I only need to rely on one connection    
    public void run() {
        new Thread(new Awk_to_Queue(channel, delivery)).start(); //this sends an Awk_to_Queue to the queue, I launch a thread for this so my program can keep working.

        if (data is good) {
            new Thread(new Send_to_Queue("success_queue", message1, channel)).start();                
            continue;
        }  else if (Data is not good but not bad either ) {
        new Thread(new Send_to_Queue("task_queue", message2, channel)).start();             
        } 

class Send_to_Queue implements Runnable{       
    public void run() {
        //takes data in and sends to queue in the way I used to previous do it, but just does it in a thread. queue connection is passed over so I only need to have one connection
    }
}

class Awk_to_Queue implements Runnable{
    public void run() {
        //awk's queue so queue server can send one more piece of data to queue up
    }
} 
```

它在那里。如果它有点难以阅读，我很抱歉（我删除了很多东西只是为了向你展示我正在做的事情的结构）。我做错了什么，分叉线程不会影响速度（它没有看到它变得更快，也没有改变探查器的结果）？是我分叉线程（`new Thread(new Awk_to_Queue(channel, delivery)).start();`）的方式有问题，还是像我的线程设计一样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T22:23:15.063

想到两件事：

*1）读取*远程队列的唯一线程似乎是在 main() 方法中运行无限循环的主线程。不管你把东西塞进它的速度有多快，你处理它们的速度永远不会超过你把它们取出来的速度。

2) Spawning `new Thread();`s 是一个“昂贵”的操作。不断为单个短任务创建新线程只是通过内存分配和本机资源搅动。您应该将那些“队列放置”卸载到`ExecutorService`可以调整大小的一秒钟，而不是产生无限数量的线程。

# .net - C#.net tcp 客户端快速传入数据

> ID：10182468
> 
> 赞同：1
> 
> 时间：2012-04-16T22:14:15.840
> 
> 标签：.net, performance, tcp, chat

我正在为一个处理登录、聊天和配对的游戏开发客户端服务器程序。这一切都是c#.net完成的。

我遇到的问题是聊天。聊天工作正常，直到我开始从另一台计算机快速发送聊天。当我在我的笔记本电脑上加载客户端并开始粉碎密钥并尽可能快地发送它时，它会出现这样的结果。

```
Laptop:Hello  <--- this is normal
Laptop:Hello2<EOF>msgLaptop: Hello3      <-- this is what happens.  Hello3 should
   be on the third line without the <EOF>msg. 
```

似乎有些东西没有被重置，但我找不到在哪里。服务器发出正确的信息，因为我可以看到它在做什么。

客户端和服务器都使用异步套接字连接。我几乎使用 beginend 方法将数据作为长字符串发送，然后让客户端或服务器解析它。

例如像“msgtheMessage”这样的消息只是说它是一个聊天消息。

当收到数据时，它会检查标头，即“msg”，然后检查 EOF 是否将其解析出来，然后将其发送到聊天室。

有没有一种处理输入速度过快的数据的好方法？

顺便说一句，它不会像发送数据的计算机那样发生，只有接收数据的计算机才会发生这种情况，即使服务器转身并将其直接发送回发送相同数据的计算机。

# html - 我可以将 domain.com/images/ 替换为 @/images/ 之类的东西吗？

> ID：10182474
> 
> 赞同：0
> 
> 时间：2012-04-16T22:15:19.693
> 
> 标签：html

嗨，我正在本地使用 Microsoft WebMatrix 制作一个基本的 HTML 网站。当我完成网站后，我会将其上传到我的虚拟主机。

现在我正在使用[http://localhost:80/](http://localhost:80/)来查看我的网站，并且我正在使用这种代码......

```
<!--#include virtual="include/html/menu.html" --> 
```

... 包括菜单链接，这样我只需更改 1 个文件即可更改整个站点的菜单。

这就是问题所在。菜单链接必须有完整的地址，如......

```
<a href="http://domain.com/service/index.html">Service</a> 
```

以确保它们在每一页上都能正常工作。不是...

```
<a href="../service/index.html">Service</a> 
```

我可以将[http://localhost:80/service/index.html](http://localhost:80/service/index.html)作为完整的地址链接，它会起作用。但是，在将网站上传到 domain.com 时，链接会被破坏，我每次上传更新版本的网站时都必须更改它们。

有没有这样的...

```
<a href="@/service/index.html">Service</a> 
```

... 一个标志，例如@，将是站点所在的任何域？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:19:42.653

虽然开头`http://etc`是绝对路径，并且开头`../`是相对于相关文档，但开头`/`将是相对于您网站的根目录。

所以你的例子就是`<a href="/service.html">Service</a>`.

# php - 将电子邮件传送到 PHP - 缺少实际的电子邮件地址

> ID：10182480
> 
> 赞同：0
> 
> 时间：2012-04-16T22:15:55.153
> 
> 标签：php, email, pipe

我有一个电子邮件地址，可将所有消息通过管道传输到 PHP 脚本。我知道如何解析内容，但在“to”和“from”标头中的任何地方都找不到实际的电子邮件地址。那是不可用的东西吗？

所以我收到的东西看起来像这样：

```
To: Jane Doe, John Doe 
Subject: This is the subject.
Date: Mon, 16 Apr 2012 17:07:25 -0500
From: Test User 
Message-ID: 
X-Priority: 3
X-Mailer: PHPMailer 5.1 (phpmailer.sourceforge.net)
MIME-Version: 1.0
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable 
```

我只得到名字，但没有电子邮件地址。有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T22:18:06.060

你确定他们不在那里？地址往往用`< >`括号括起来，如果您在浏览器中查看它，它就会消失。如果您在浏览器中查看，请尝试查看页面的源代码，以防括号中的地址被解释为 html 标记。

# javascript - 使用中间变量而不是只返回表达式结果的原因？

> ID：10182481
> 
> 赞同：1
> 
> 时间：2012-04-16T22:16:01.437
> 
> 标签：javascript

这是一个非常基本的问题。我正在学习 Javascript，而且我对一般编程还很陌生。在很多教程中，我看到过这样的事情：

```
function add(a,b) {
    var sum = a+b;
    return sum;
} 
```

现在，对于这样一个简单的计算，在我看来，没有理由创建一个中间变量。相反，我的直觉是这样做：

```
 function add(a,b) {
    return a+b; 
} 
```

如果我使用多个步骤进行更复杂的计算，我可以理解使用中间变量的基本原理，当然它们对于条件是必要的。当事情变得更复杂时，这些教程只是试图灌输可读代码的习惯，还是第一个示例本质上更好的原因？第一种方式似乎有内存性能成本。我有什么明显的遗漏吗？

我搜索过 SO 并用谷歌搜索过，但运气不佳。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T22:18:12.793

你没有错过任何东西。你的直觉是正确的——不需要中间变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T22:19:39.567

我经常使用这样的东西来简化调试。这样我就可以在退出函数之前准确地看到返回值是什么。

它还使可伸缩性变得更加容易，因为在返回值之前可以有更多的变量飞来飞去。

在使用变量时不要贪便宜，否则你以后会为此付出代价。当然，我的意思是在比您的示例更复杂的情况下。

# wordpress - 无法为来自 google/bing 的访问者正确呈现主页

> ID：10182482
> 
> 赞同：1
> 
> 时间：2012-04-16T22:16:03.553
> 
> 标签：wordpress

我在网站上有一个奇怪的问题。当有人直接访问该网站时一切正常，但如果访问者通过 Google 搜索或 Bing 进入该网站，则主页看起来很糟糕。我在 Firefox、Chrome 和 Safari（最新版本）上注意到了这个问题。

首先，我认为这是谷歌缓存问题，下次爬虫访问主页时，它也会更新缓存的网页。

但是当我看到来自 Bing 的访问者发生同样的事情时，我开始认为这与搜索引擎无关，而且这是我在编写网站代码时做错了。

主页应该是这样的：http: [//melisayavas.com/](http://melisayavas.com/)

来自谷歌或必应：[https ://www.google.com/search?q=melisayavas](https://www.google.com/search?q=melisayavas)

![在此处输入图像描述](../Images/2925b0bdaf12241964517940a33ef9c9.png)

有谁知道问题是什么或问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:28:59.940

您的网站在 Google Chrome 18 中已损坏。我建议您先使用此浏览器修复它，这可能会解决更多与搜索引擎相关的问题。

**编辑**

我刚刚看到你的截图，这正是我在 Chrome 中看到的。

**编辑 2**

我可能完全错了，但是当我单击初始帖子[http://melisayavas.com/](http://melisayavas.com/)中的链接时，该站点已损坏。如果重新加载页面，它也会被破坏。如果我转到浏览器的 URL 栏并点击“输入”，该网站就可以了。我认为如果客户端发送Referer标头，该网站就会损坏......

**编辑 3**

我用 curl 做了一些测试来确认我的结果。此测试将产生预期的结果：

```
$ch = curl_init('http://www.melisayavas.com/');
curl_setopt($ch, CURLOPT_REFERER, 'http://stackoverflow.com/questions/10182482/homepage-not-rendered-correctly-for-visitors-coming-from-google-bing/10182607#comment13069478_10182607');
$data = curl_exec($ch);
echo $data; 
```

这将导致站点损坏：

```
$ch = curl_init('http://www.melisayavas.com/');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
curl_setopt($ch, CURLOPT_REFERER, 'http://stackoverflow.com/questions/10182482/homepage-not-rendered-correctly-for-visitors-coming-from-google-bing/10182607#comment13069478_10182607');
$data = curl_exec($ch);
echo $data; 
```

在您的请求中包含推荐人是破坏网站的原因。您的源代码中是否有任何以引用 url 为条件的部分？

** 编辑 4 **

当它来自引用 URL 时，会添加一段 HTML 代码：

```
<!-- Highlight Search Terms 0.7 ( RavanH - http://4visions.nl/en/wordpress-plugins/highlight-search-terms/ ) -->
<script type="text/javascript">
var hlst_query = new Array("http://stackoverflow.com/questions/10182482/homepage-not-rendered-correctly-for-visitors-coming-from-google-bing/10182607#comment13069478_10182607");
var hlst_areas = new Array("div.hentry","#content","#main","div.content","#middle","#container","#wrapper","article");
</script> 
```

我不熟悉 Wordpress，我相信这必须来自一个名为 Highlight Search Terms 的插件，禁用它应该可以修复您的网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:44:47.620

您有一些代码错误，例如重复的导航 div 和缺少的关闭 div 等。修复这些错误并查看它的显示方式。

[[无效] melisayavas.com 的标记验证 - W3C 标记验证器](http://validator.w3.org/check?uri=http%3A//melisayavas.com/&doctype=Inline&ss=1&group=0&user-agent=W3C_Validator/1.654)。在验证报告中向下滚动以查看行号和源代码。

# python - 编写面向对象的 MySQLdb 连接

> ID：10182487
> 
> 赞同：4
> 
> 时间：2012-04-16T22:16:17.790
> 
> 标签：python

我正在尝试学习 OOP，并且我正在使用数据库连接`MySQLdb`作为我的第一个测试。这是我到目前为止所拥有的：

```
class DBConnection:
    def __init__(self, DB_HOST, DB_PORT, DB_USER, DB_PASSWORD, DB_NAME):
        self.host = DB_HOST
        self.port = DB_PORT
        self.name = DB_NAME
        self.user = DB_USER
        self.password = DB_PASSWORD

    def get_conn(self):
        conn = MySQLdb.connect (host = self.DB_HOST, port = self.DB_PORT,
                                db = DB_NAME, user = DB_USER,
                                passwd = DB_PASSWORD)
        return conn

    def get_cursor(self):
        cursor = self.conn.cursor()
        return cursor

    def get_dict_cursor(self):
        dict_cursor = self.conn.cursor(MySQLdb.cursors.DictCursor)
        return dict_cursor 
```

以上有效吗？是否`self.conn`引用`get_conn()`或这是一个无效的引用。如何使用 python shell 建立与数据库的连接然后获取游标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T22:20:36.373

你还没有`self.conn`在任何地方定义。您只是设置`conn`为`get_conn`. 在您的构造函数中定义`self.conn`，然后更新`get_conn`为 set `self.conn`。像这样：

```
class DBConnection:
    def __init__(self, DB_HOST, DB_PORT, DB_USER, DB_PASSWORD, DB_NAME):
        self.host = DB_HOST
        self.port = DB_PORT
        self.name = DB_NAME
        self.user = DB_USER
        self.password = DB_PASSWORD
        self.conn = None

    def get_conn(self):
        self.conn = MySQLdb.connect(host = self.host,
                                    port = self.port,
                                    db = self.name,
                                    user = self.user,
                                    passwd = self.password) 
```

另外，检查是否`self.conn`首先设置，而不是每次在 中创建一个新的`get_conn`，如下所示：

```
def get_conn(self):
    if self.conn is None:
        self.conn = MySQLdb.connect(host = self.host,
                                    port = self.port,
                                    db = self.name,
                                    user = self.user,
                                    passwd = self.password)
    return self.conn 
```

最后，`get_conn`像这样调用方法：

```
mydbconnobj = DBConnection('localhost',3306,'foouser','foopass','foodbname')
mydbconn = mydbconnobj.get_conn() 
```

# ruby-on-rails - 如何在ubuntu上的rails Capistrano部署中自动将sqlite3 db文件复制到/ current？

> ID：10182493
> 
> 赞同：0
> 
> 时间：2012-04-16T22:16:39.450
> 
> 标签：ruby-on-rails, sqlite, ubuntu, ruby-on-rails-3.1, capistrano

我们的 rails 3.1.3 应用程序使用 sqlite3 运行并在 ubuntu 上使用 Capistrano 部署。每次部署后，我们必须手动将 sqlite3 db 文件从先前版本的子目录复制到 /var/www/app/current。有没有办法（请提供代码示例）部署文件可以自动将 db 文件复制到当前子目录中？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:19:46.640

在每次部署后建立一个指向 sqlite3 文件的软链接。

# jquery - Rails UJS（jQuery）没有连接数据远程链接

> ID：10182495
> 
> 赞同：2
> 
> 时间：2012-04-16T22:16:44.623
> 
> 标签：jquery, ruby-on-rails, ajax, ujs

导轨版本：3.2.1

红宝石版本：1.9.3p125

浏览器：Chrome 18.0.1025.162

开发操作系统：Mac OS/X Lion

服务器操作系统：CentOS 5

我正在尝试在我的 link_to 调用中使用 :remote，以便我可以使用 AJAX 请求 HTML 内容，并使用返回的内容填充页面的一部分。

Rails 似乎没有正确连接链路。浏览器只是将链接视为常规链接标记，并且似乎没有处理任何 Rails UJS 单击事件处理程序。

我有一个与它相关联的数据确认的链接，它正在工作，所以这表明 UJS 正在做至少一些必要的接线。

我将其他单击事件侦听器附加到同一链接以隐藏/显示将显示从 AJAX 调用返回的 HTML 的页面部分。

抱歉，如果这是在其他地方发布的，但我已经搜索了几天，还没有找到解决这个特定问题的解决方案。我看过一些相关的文章，但他们都假设正在进行 AJAX 调用，并且存在一些 Rails 渲染流或路由问题，在我的情况下，似乎根本没有任何连线。

这是一些代码：

我在视图中的链接：

```
<%= link_to image_tag("icons/24x24/attachment.png"), task_notes_path(task), :class => "section-link task-notes-link", :title => "View recent notes", :remote => true, 'data-section' => "task-notes" %> 
```

RoR 生成的输出：

```
<a href="/tasks/7/notes" class="section-link task-notes-link" data-remote="true" data-section="task-notes" title="View recent notes"><img alt="Attachment" src="/assets/icons/24x24/attachment.png"></a> 
```

这是 /task/:task_id/notes 控制器代码：

```
def index
store_return_to

@project = nil
@tasks = nil

if (params.has_key?(:project_id))
  @project = Project::find(params[:project_id])

  sort = [
    { :field => 'status', :direction => 'asc'},
    { :field => 'priority', :direction => 'asc' }
  ]

  filter = { :status => Task::STATUS_ACTIVE.to_s }

  @tasks = Task::filter_sort(:project => @project, :sort => sort, :filter => filter, :per_page => 0)
else
  @task_sort = params.has_key?(:task_sort) ? params[:task_sort] : { :field => 'priority', :direction => 'asc'}
  @task_filter = params.has_key?(:task_filter) ? params[:task_filter] : { :status => Task::STATUS_ACTIVE.to_s }
  @task_search = params.has_key?(:task_search) ? params[:task_search] : ""

  @tasks = Task::filter_sort(:search => params[:task_search], :sort => @task_sort, :filter => @task_filter, :page => params[:tasks_page], :per_page => 15)      
end

respond_to do |format|
  format.html # index.html.erb
  format.js
  format.json { render json: @tasks }
end
end 
```

最后，我在 index.js.erb 文件中的代码：

```
<% if (!@project.nil?) %>
    $('#project-<%=@project.id%>-tasks').html('<%= escape_javascript(render(@tasks)) %>');
<% else %>
    $('#project-tasks').html('<%= escape_javascript(render(@tasks)) %>');
<% end %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T04:31:47.147

Okay, so I figured it out.

Examining this HTML for the related :remote links:

```
<div class="list-item-row">
<div class="list-item-expander action-icon">
  <a href="#" title="Show/hide content pane">
    <%= image_tag "icons/24x24/plus.png", :class => "expander-image closed" %>
    <%= image_tag "icons/24x24/minus.png", :class => "expander-image opened" %>
  </a>
</div><div class="action-icon">
  <a href="#" data-section="task-description" class="section-link" title="Show details"><%= image_tag "icons/24x24/page.png" %></a>
</div><div class="action-icon">
  <%= link_to image_tag("icons/24x24/attachment.png"), task_notes_path(task), :class => "section-link task-notes-link", :title => "View recent notes", :remote => true, 'data-section' => "task-notes" %>
</div><div class="action-icon">
  <%=task_image_tag(task, 24)%>
</div><div class="action-icon">
  <div class="task-priority task-priority-<%=task.priority_str.downcase%>" title="<%=task.priority_str%> Priority"></div>
</div><div class="action-icon">
  <% unless (task.assigned_developer.nil?) %><%= link_to image_tag(task.assigned_developer.avatar.icon.url), developer_path(task.assigned_developer), :title => "Assigned to: " + task.assigned_developer.full_name %><%end%>
</div><div style="width:280px;">
  <%=link_to truncate(task.name, :length => 40, :omission => "..."), task_path(task), :title => task.name, :class => "item-show-link" %>
</div><div style="width:300px;font-size:10px;color:#777;">
  <%=truncate(task.description, :length => 50, :omission => "...")%>
</div><div style="width:90px;float:right;text-align:center;">
  <%=task.status_str%>
</div></div> 
```

The :remote links are in a DIV with the id "list-item-expander". This row had an onclick event that would expand the details of the current item below it. Here's the JS code that managed the interaction:

```
elem.find(".list-item .list-item-row").click(function(evt) {
    evt.stopPropagation();
    $.tf.listItem.showHideItem($(this));
}); 
```

Apparently the evt.stopPropation() was not allowing the :remote link's click event to bubble up high enough in the event chain to be handled by UJS. I fixed the problem by filtering out the srcElements related to the :remote link. Here's the code:

```
elem.find(".list-item .list-item-row").click(function(evt) {
    if ($(evt.srcElement).not('a').not('img').size() > 0) {
        evt.stopPropagation();
        $.tf.listItem.showHideItem($(this));
    }
}); 
```

By filtering the srcElements, the Img/A clicks are allowed to bubble up.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:20:37.763

您是否已将您的内容`rails.js`包含在 application.js/application.coffee javascript 资产打包程序中？如果不这样做。否则，您将不得不自己在 javascript/coffee 脚本中编写事件处理程序。

此外，这段代码看起来有点脏。您的 index.js.erb 代码可能至少应该包装到 $(document).ready(function(){ / *HERE* / });

您在笔记控制器中的索引操作我执行、显示、搜索和过滤。比我期望的还要多:)

关于rails 3.2中的ajax /远程事物 [http://guides.rubyonrails.org/ajax_on_rails.html](http://guides.rubyonrails.org/ajax_on_rails.html)

# python - 如何仅从特定 gmail 标签下载未读附件？

> ID：10182499
> 
> 赞同：5
> 
> 时间：2012-04-16T22:17:09.523
> 
> 标签：python, gmail, attachment, imaplib

我有一个 Python 脚本，改编自[Downloading MMS emails sent to Gmail using Python](https://stackoverflow.com/questions/7596789/downloading-mms-emails-sent-to-gmail-using-python)

```
import email, getpass, imaplib, os

detach_dir = '.' # directory where to save attachments (default: current)
user = raw_input("Enter your GMail username:")
pwd = getpass.getpass("Enter your password: ")

# connecting to the gmail imap server
m = imaplib.IMAP4_SSL("imap.gmail.com")
m.login(user,pwd)
m.select("[Gmail]/All Mail") # here you a can choose a mail box like INBOX instead
# use m.list() to get all the mailboxes

resp, items = m.search(None, 'FROM', '"Impact Stats Script"') # you could filter using the IMAP rules here (check http://www.example-code.com/csharp/imap-search-critera.asp)
items = items[0].split() # getting the mails id

for emailid in items:
    resp, data = m.fetch(emailid, "(RFC822)") # fetching the mail, "`(RFC822)`" means "get the whole stuff", but you can ask for headers only, etc
    email_body = data[0][1] # getting the mail content
    mail = email.message_from_string(email_body) # parsing the mail content to get a mail object

    #Check if any attachments at all
    if mail.get_content_maintype() != 'multipart':
        continue

    print "["+mail["From"]+"] :" + mail["Subject"]

    # we use walk to create a generator so we can iterate on the parts and forget about the recursive headach
    for part in mail.walk():
        # multipart are just containers, so we skip them
        if part.get_content_maintype() == 'multipart':
            continue

        # is this part an attachment ?
        if part.get('Content-Disposition') is None:
            continue

        filename = part.get_filename()
        counter = 1

        # if there is no filename, we create one with a counter to avoid duplicates
        if not filename:
            filename = 'part-%03d%s' % (counter, 'bin')
            counter += 1

        att_path = os.path.join(detach_dir, filename)

        #Check if its already there
        if not os.path.isfile(att_path) :
            # finally write the stuff
            fp = open(att_path, 'wb')
            fp.write(part.get_payload(decode=True))
            fp.close() 
```

我正在按主题过滤邮件并获取附件，但现在我只需要*从新*电子邮件中获取附件。我可以修改`m.search()`以仅返回未读电子邮件的方式吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-16T23:09:47.983

尝试修改这一行：

```
resp, items = m.search(None, 'FROM', '"Impact Stats Script"') 
```

到：

```
resp, items = m.search(None, 'UNSEEN', 'FROM', '"Impact Stats Script"') 
```

[Python`imaplib`文档显示只是添加更多搜索条件](http://docs.python.org/library/imaplib.html#imaplib.IMAP4.search)，IMAP[规范](https://www.rfc-editor.org/rfc/rfc3501#section-6.4.4)定义了`UNSEEN`搜索条件：

```
 UNSEEN
     Messages that do not have the \Seen flag set. 
```

# linux - 如何在linux中记录二进制数据

> ID：10182505
> 
> 赞同：0
> 
> 时间：2012-04-16T22:17:32.830
> 
> 标签：linux, binary, logging

我在网上搜索了一些用于登录Linux的软件，其中大多数是指logwatch来查看机器中的记录数据。问题是我正在寻找一种可以记录来自另一台机器的二进制数据的软件！有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-21T09:40:49.200

*[由于将评论标记为答案的](https://meta.stackexchange.com/questions/82099/answering-comment-answered-questions)功能请求仍然被拒绝，因此我在此处复制上述解决方案。*

`nc -l some_port > /var/log/log_file` – 萨诺德

# iphone - 为外部测试版分发 iphone 应用程序 - 代表客户签名

> ID：10182510
> 
> 赞同：0
> 
> 时间：2012-04-16T22:18:29.370
> 
> 标签：iphone, signing, beta

我的公司正在构建一个应用程序，我们希望外部客户在提交到应用程序商店之前先试用它。由于内部构建只能分发给公司的员工，那么在不通过应用商店的情况下将应用提供给测试版客户的最佳方式是什么？如果客户注册了开发者或企业帐户并给了我们他们的证书，是否可以代表他们签署应用程序并将其提供给他们？

谢谢！

更新：设备数量超过 100。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:28:04.073

如果您想要运行应用程序的设备少于 100 台，您可以进行临时构建并通过您自己的 Web 服务器或 TestFlight 分发它们。不过，您将需要安装它的每台设备的 UDID。我通常建议人们为此运行 Ad Hoc Helper。请参阅[iPhone ad hoc build using Xcode 4](https://stackoverflow.com/questions/5295890/iphone-ad-hoc-build-using-xcode-4)和[http://itunes.apple.com/us/app/ad-hoc-helper/id285691333?mt=8](http://itunes.apple.com/us/app/ad-hoc-helper/id285691333?mt=8)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T02:44:17.327

**我的回答*要求*设备[越狱](http://jailbrea.kr)**。

既然你说你需要超过 100 台设备，你可以[假签](http://www.saurik.com/id/8)应用程序。这将允许您根据需要安装在尽可能多的设备上。

PS 我在给你的假签名[链接上推荐选项#2。](http://www.saurik.com/id/8)

# java - 用撇号解析 XML

> ID：10182514
> 
> 赞同：2
> 
> 时间：2012-04-16T22:19:08.227
> 
> 标签：java, xml

以 BBC 新闻的 RSS 提要为例，他们的一条新闻如下：

```
<item><title>Pupils 'bullied on sports field'</title><description>bla bla.. 
```

我有一些 java 代码解析这个 - 但是，当标题包含撇号（如上）时，解析停止，所以我最终得到以下标题：**Pupils '**然后它继续并解析描述（这很好） . 我如何让它解析完整的标题？以下是我解析信息的 for 循环内部的一段代码：

```
 NodeList title = element.getElementsByTagName("title");
                    Element line = (Element) title.item(0);
                    tmp.setTitle(getCharacterDataFromElement(line).toString()); 
```

完全相同的代码用于解析描述和 pubDate 等其他元素，这些都很好。

这是 getCharacterDataFromElement 方法：

```
public static String getCharacterDataFromElement(Element e) {
    Node child = ((Node) e).getFirstChild();
    if (child instanceof CharacterData) {
        CharacterData cd = (CharacterData) child;
        return cd.getData();
    }
    return "";
} 
```

我究竟做错了什么？我使用 DocumentBuilder、DocumentBuilderFactory 和 org.w3c.dom 来处理 RSS Feed。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:26:50.413

您的 getCharacterDataFromElement 仅查看第一个子元素 - 查看是否还有其他子元素并将所有文本粘贴在一起

HTH-DF

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:44:48.770

正如 davidfrancis 建议的那样，您应该遍历`getCharacterDataFromElement()`.

或者，如果您可以使用 DOM 级别 3，则可以使用[Node.getTextContent()](http://docs.oracle.com/javase/6/docs/api/org/w3c/dom/Node.html#getTextContent%28%29)方法来代替您想要的。

```
NodeList title = element.getElementsByTagName("title");
Element line = (Element)title.item(0);
tmp.setTitle(line.getTextContent()); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-16T22:34:39.617

好吧，AFAIK，撇号是 XML 中的保留字符，因此应该编码为`&apos;`.

这意味着 BBC 新闻 RSS 提要不提供格式良好的 XML。

最好的办法是向 BBC 新闻 RSS 提要提供商发布错误报告，以便他们修复它。

# java - 具有延迟的自定义 ThreadPoolExecutor

> ID：10182516
> 
> 赞同：2
> 
> 时间：2012-04-16T22:19:27.917
> 
> 标签：java, multithreading, servlets, threadpool

我正在使用 ThreadPoolExecutor 来限制对我的 servlet 的调用，我参考了以下链接： http: [//www.softwareengineeringsolutions.com/blogs/2010/08/13/asynchronous-servlets-in-servlet-spec-3-0/](http://www.softwareengineeringsolutions.com/blogs/2010/08/13/asynchronous-servlets-in-servlet-spec-3-0/)

这给出了很好的例子。但需要添加延迟。这里怎么做。我正在维护一个同时运行的 7 个线程池。但是在所有线程完成后，新线程应该从队列中创建，我需要在此之前放置。所以每 7 次调用，我需要一个延迟，然后才能从队列中汇集更多线程并作为任务运行。

将 ScheduledThreadPoolExecutor 帮助，如果是的话如何。或者如何修改现有的 ThreadPoolExecutor 会有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T00:34:20.080

如果只需要限制 servlet 请求，使用线程池的异步请求*不是*解决问题的方法。最简单的方法是添加一个过滤器，它使用信号量之类的东西来限制传入的请求。

如果您需要使用异步请求并想要限制它们，那么只需使用有限大小的线程池。

# c++ - 如何在 QT 中设置中心小部件的大小/位置

> ID：10182526
> 
> 赞同：1
> 
> 时间：2012-04-16T22:20:03.517
> 
> 标签：c++, qt, resize, widget

我有一个中央小部件，周围有几个文档小部件。当我隐藏它时，文档会调整大小以填充空间但是，当我显示中央小部件时，它会以其默认大小显示。我希望能够像隐藏之前一样调整大小和位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T09:06:13.140

在隐藏之前做这样的事情：

```
QSize storedSize = mainwindow->getCentralWidget->size(); 
```

（假设`mainwindow`是一个`* QMainWindow`包含您正在谈论的中央小部件）

当您想将其调整回旧尺寸时：

```
mainwindow->getCentralWidget->resize(storedSize); 
```

# php - "grab" 使用 php 发布表单响应（响应是一个 txt 文件）

> ID：10182527
> 
> 赞同：1
> 
> 时间：2012-04-16T22:20:04.560
> 
> 标签：php, file, post, text-files

我有一个将文件发布到我无法控制的站点的表单，并且该站点使用基于上传文件的动态生成的文本文件进行响应。提交表单后，客户端会下载该响应。我的问题是：**如何在它到达用户之前获取此文本文件并将其复制到我的服务器**？

可能的解决方案 1：有没有办法更改此文件的标题并将其内容放入某个隐藏的 div 或 iframe？

可能的解决方案 2：我认为最好的方法是创建一个脚本，该脚本获取表单数据，然后将其重新发布到外部站点，然后获取响应并将此响应写入我的 txt 文件中的站点。不幸的是，我所有试图让这个工作的尝试都失败了。

解决方案 2 的示例：

```
<form action="mysite.com/respostScriptThatGrabsResponse.php" method="post">
    <input type="file" name="filename"/>
    <input type="submit" value="submit"/>
</from> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:25:06.703

理论＃2将是要走的路。您可以使用[cURL](http://php.net/manual/en/book.curl.php)将数据发布到外部站点。阻止成功的最可能的障碍是外部站点需要只有客户端才能拥有的 cookie 数据。

# sql - 将分隔列拆分为另一个表中的单独行的高效查询

> ID：10182533
> 
> 赞同：2
> 
> 时间：2012-04-16T22:20:56.240
> 
> 标签：sql, sql-server, sql-server-2008-r2

我有一些数据包含带有分隔数据的列。本质上同一列中有多个记录：

```
A0434168.A2367943.A18456972.A0135374.A0080362.A0084546.A0100991.A0064071.A0100858 
```

我正在尝试将此列中的数据拆分为另一个表中的单独行。这些值的长度可变，并由句点分隔。我一直在尝试使用游标为这些数据创建一个查找表。由于数据量大，游标速度过慢。

我的光标如下所示：

```
DECLARE @ptr nvarchar(160)
DECLARE @aui nvarchar(15)
DECLARE @getmrhier3 CURSOR 

SET @getmrhier3 = CURSOR FOR
    SELECT  cast(ptr as nvarchar(160)),aui
    FROM    mrhier3
    FORWARD_ONLY
OPEN @getmrhier3
FETCH NEXT
    FROM @getmrhier3 INTO @ptr, @aui

WHILE @@FETCH_STATUS = 0
BEGIN
    if(len(@ptr) > 0)
    begin
        if(charindex('.',@ptr) > 0)
        begin
            insert into mrhierlookup(hieraui,aui)
            values      (substring(@ptr,0,charindex('.',@ptr)),@aui)

            update  mrhier3
            set     ptr = substring(@ptr,charindex('.',@ptr)+1,LEN(@ptr))
            where   aui = @aui 
              and   ptr = @ptr
        end
        else
        begin
            insert into mrhierlookup(hieraui,aui)
            values      (@ptr,@aui)

            update  mrhier3
            set     ptr = ''
            where   aui = @aui 
              and   ptr = @ptr
        end
    end
    FETCH NEXT
        FROM @getmrhier3 INTO @ptr, @aui
END

CLOSE       @getmrhier3
DEALLOCATE  @getmrhier3 
```

当前版本的光标仅适用于列的前导值。所有长度都是任意的。该列的长度最多约为 150 个字符。

使用当前数据集，构建查找表可能需要几天时间。它将有几百万条记录。

为了更快地执行连接操作，是否有更好的方法可以有效（快速）地将这些数据解析到单独的表中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:30:56.370

创建拆分函数：

```
CREATE FUNCTION dbo.SplitStrings(@List NVARCHAR(MAX))
RETURNS TABLE
AS
   RETURN ( SELECT Item FROM
       ( SELECT Item = x.i.value('(./text())[1]', 'nvarchar(max)')
         FROM ( SELECT [XML] = CONVERT(XML, '<i>'
         + REPLACE(@List, '.', '</i><i>') + '</i>').query('.')
           ) AS a CROSS APPLY [XML].nodes('i') AS x(i) ) AS y
       WHERE Item IS NOT NULL
   );
GO 
```

然后摆脱所有光标和循环废话并执行以下操作：

```
INSERT dbo.mrhierlookup
(
  heiraui,
  aui
)
SELECT s.Item, m.aui
  FROM dbo.mrhier3 AS m
  CROSS APPLY dbo.SplitStrings(m.ptr) AS s
GROUP BY s.Item, m.aui; 
```

# python - Python中的导入冲突？

> ID：10182538
> 
> 赞同：0
> 
> 时间：2012-04-16T22:21:18.657
> 
> 标签：python

> **可能重复：**
> [Python：循环（或循环）导入](https://stackoverflow.com/questions/744373/python-circular-or-cyclic-imports)

我是 Python 新手，遇到了问题，但我不确定这是否是我的问题。我有两个文件，user.py 和comments.py。在 user.py 中，我做

```
from comments import Comment 
```

在comments.py我做

```
from user import User 
```

我的用户加载正常，但是当我加载导致评论的 URL 时，出现服务器错误。注释掉`from comments import Comment`修复的问题。难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:26:13.800

是的，你有一个循环导入，这会导致很多问题。如果您考虑导入时实际发生的情况，这类似于说“将代码从文件 x 复制到此文件”，但如果您从 x 复制到 y，然后从 y 复制到 x，则您已经创建一个无限循环，解释器很难确定在哪种情况下哪个模块应该取代或加载哪个模块。但是，如果您的程序架构正确，那么您不应该有任何程序。您有什么理由进行此循环导入？如果我们更仔细地看待这个问题，您可能根本不需要它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T22:27:19.817

这种循环导入是行不通的。导入一个模块实际上意味着执行其中的语句。这些`import`语句在遇到它们的那一刻就被执行，因此至少在其中一个模块中另一个模块尚未初始化，因此导入将失败。

循环依赖被认为是一种反模式。在某些情况下，它们会以某种方式自然发生，但总的来说，它们是糟糕设计的标志。

您可以通过将导入语句之一移动到模块末尾或函数级别来完成这项工作，但我建议不要使用这些“修复”。

# java - JSF 2.0 WebApp 不呈现模板

> ID：10182539
> 
> 赞同：1
> 
> 时间：2012-04-16T22:21:22.157
> 
> 标签：java, eclipse, jsf-2, facelets

我目前正在开发 JSF 2.0 WebApp，并将我的工作放在我服务器的存储库中。我买了一台新电脑并在上面检查了项目，没有问题。它显示没有错误。所以我使用的是 Eclipse IDE Helios。并在其上安装了一个 tomcat v7 服务器。我启动它，没问题。但是当我查看我的项目时，它没有正确显示。它看起来像这样：

![在此处输入图像描述](../Images/ef8cabbde11dda03229fdfc7e4fc8fbd.png) html呈现如下：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core">

<ui:composition template="/WEB-INF/templates/base.xhtml">

    <ui:define name="head">
        <style type="text/css">
            #content{margin:0 10px !important;}
        </style>        
    </ui:define>

    <ui:define name="sidebar1"></ui:define>

    <ui:define name="content">

            <h:panelGrid columns="2">
            <div class="login">
            <img src="/miloWeb/images/medical.jpg" />
            </div>
            <h:column>
            <center>
                <div class="login">
                    <h4 style="color: #FF0000;"><h:outputText value="#{loginBean.message}"/></h4><br/>
                    <ul style="list-style-type:none; width: 265px; text-align: left;" >
                        <li>User ID</li>
                        <li><h:inputText id="userId" styleClass="loginText" value="#{loginBean.user.userID}"></h:inputText></li>
                        <li>Password</li>
                        <li><h:inputSecret id="password" styleClass="loginText" value="#{loginBean.user.password}"></h:inputSecret></li>
                        <li><h:commandButton id="login" value="Login" action="#{loginBean.login}" styleClass="button"></h:commandButton></li>
                    </ul>
                </div>
            </center>
            </h:column>
            </h:panelGrid>
    </ui:define>

</ui:composition>
</html> 
```

但如果我在我原来的计算机（它工作的那台）上运行它，它应该是这样的：

![在此处输入图像描述](../Images/2cf6071173363dc739820ce9b5c47f0b.png)

html呈现如下：

```
 <?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><link type="text/css" rel="stylesheet" href="/miloWeb/faces/javax.faces.resource/theme.css?ln=primefaces-aristo" /><script type="text/javascript" src="/miloWeb/faces/javax.faces.resource/jquery/jquery.js?ln=primefaces&amp;v=3.2"></script><script type="text/javascript" src="/miloWeb/faces/javax.faces.resource/primefaces.js?ln=primefaces&amp;v=3.2"></script>
            <title>MILO</title>

        <link rel="stylesheet" type="text/css" href="/miloWeb/css/redmond/jquery-ui-1.8.11.custom.css" media="screen" />
        <link rel="stylesheet" type="text/css" href="/miloWeb/css/style.css" media="screen" />
        <link rel="stylesheet" type="text/css" href="/miloWeb/css/view.css" media="screen" />
        <link rel="stylesheet" type="text/css" href="/miloWeb/css/ezmark.css" media="screen" />

        <!--[if IE]>
            <style type="text/css"> 
                /* place css fixes for all versions of IE in this conditional comment */
                .milo #content { zoom: 1; }
                /* the above proprietary zoom property gives IE the hasLayout it may need to avoid several bugs */
            </style>
        <![endif]-->

        <script type="text/javascript" src="/miloWeb/js/jquery.ezmark.js"></script>
        <script type="text/javascript" src="/miloWeb/js/jquery.maskedinput.js"></script>
        <script type="text/javascript" src="/miloWeb/js/random.js"></script>
        <script type="text/javascript" src="/miloWeb/js/jquery-ui-1.8.11.custom.min.js"></script>

        <script type="text/javascript">
            $(document).ready(function(){
                $(".button").button();
            });

            function loading(){
                $( "#loadingPopUp" ).dialog( "open" );
                return false;
            }

            function unloading(){
                $( "#loadingPopUp" ).dialog( "close" );
                return false;
            }
        </script>
        <style type="text/css">
            #content{margin:0 10px !important;}
        </style></head><body class="milo">
    <form id="j_idt11" name="j_idt11" method="post" action="/miloWeb/faces/pages/index.xhtml;jsessionid=735F094AD14A3977F9976960A61EEB0C" class="miloForm" enctype="multipart/form-data">
    <input type="hidden" name="j_idt11" value="j_idt11" />

            <div id="container">
                <div id="header"><html xmlns="http://www.w3.org/1999/xhtml"><body>

    <div>
        <h1 class="headerTitle">MILO Chart</h1>
        <div class="headerTreadmark">Medical Information Leading Operations Chart</div>
        <div class="clear"></div>
    </div>

    <div id="headerInfo"><table>
    <tbody>
    <tr><td></td></tr></tbody>
    </table>

    </div><div id="j_idt11:j_idt42"></div><script id="j_idt11:j_idt42_s" type="text/javascript">PrimeFaces.cw('AjaxStatus','widget_j_idt11_j_idt42',{id:'j_idt11:j_idt42'});widget_j_idt11_j_idt42.bindCallback('ajaxStart',function(){loading();});widget_j_idt11_j_idt42.bindCallback('ajaxSuccess',function(){unloading();});</script></body>
</html>
                </div>

                <div id="sidebar1">             
                </div>
                <br />
                <br />
                <div id="content"><table>
<tbody>
<tr>
<td>
            <div class="login">
            <img src="/miloWeb/images/medical.jpg" />
            </div></td>
<td>
            <center>
                <div class="login">
                    <h4 style="color: #FF0000;"></h4><br />
                    <ul style="list-style-type:none; width: 265px; text-align: left;">
                        <li>User ID</li>
                        <li><input id="j_idt11:userId" type="text" name="j_idt11:userId" class="loginText" /></li>
                        <li>Password</li>
                        <li><input id="j_idt11:password" type="password" name="j_idt11:password" value="" class="loginText" /></li>
                        <li><input id="j_idt11:login" type="submit" name="j_idt11:login" value="Login" class="button" /></li>
                    </ul>
                </div>
            </center></td>
</tr>
</tbody>
</table>

                </div>

                <br class="clear" />

                <div id="footer"><div id="template_footer_id" style="text-align: center;">&copy; 2012 Bravo Technologies.
</div>
                </div>
            </div><input type="hidden" name="javax.faces.ViewState" id="javax.faces.ViewState" value="H4sIAAAAAAAAAM1WX2gcRRif3p/ExBjPtIYWSRWMStTumdjEapDmai7k8JoevZha+3DO7U5ye5nbmczM3u0FDPZFH4pQUBEhog8+9KFvfepLRUopFBpQEEERRHxVfFAEfXFm9m73LtmQWpA6D9/O7cz3ze/7fb/95i7/ApKUM/BQFdah4QobG/OQV05Cmuz97svrw29+FQexOdCPCbTmoCkIy4E+UWGIVwi2PHp8Bqgx0LhP2pSaCZCqlmxLjI+/RCHnDcIsl4H95/L6BAydFeNUuYpMMX1x6/VPU3wMxwDwqHRNUDkE6NHuL7hrYAPE5etYMEtSGenAuYhQB7/4u/jz6ve32qH2hd51BkbVfs9YhibiBqojRxgFwkXGshbJko0aWfXqtwtXb3ybunJVhWDgyZ0ur5AaJY6cFZtcoJp2urZy7PelraVB32lkp1PH3idWP7pu/3Boy9/7cEi4XvUTyb/Xt3Cw9tYlnYcsy/5wV4Yx2MzbXHjnvx75+Cb8JA725UCC2+tIpxxrJJTl27CbbdRGUUCB5mXVECvCOmJnb115+f3N2ydjIJYHfSaWxVqANSTAkOY3rfhNFwWznZXpPOjn0sfSMQQY9nfYJF1EzIbYXodljKY9SuuK9xRXdkiAbDSS13IBl6NRrKoskYNYxoJUIBbWsh13XMYyuOu0IjPkyKRWbWFURA2XypDbplE0mU3Fab2EGJUyOLwbmlOuoK4A4fCo52vxwbaU/efRSFHKEf7aYGBy76wLjFDERPNV1OQFZtclq+2zh7Q8BkOJZx231rkoYR2AQtal7ArEFytQZBgqIqHJSXUoQZNFlR1uzQU43M2csli6GplCIZ/LznoSvvHv4HdCU6c8LkB/CC8AFdeg4i0gWiagA+FYay7lO7kLRLtGsTGLlqGLxZz/cjRDKW4uklXk/HHp2bObM9WZAcVQYww8mj6TPXEktzCXlqqiWBLM0xUEpRgMT6lE9oipa+tTE54X9pzn9y6vmozeAdM6J83HM7tQoGw6igH1mGg8BUYiMpDSRl34X/TxD7Z16nLEclaAt9VSk2p5fM/s4rL6R3arvmqUpwnZs/g9spGInBXcKVrDOUegFcSGfvrs8z/Pv3ssplpXsg6xi6TWU+G+BbdWRuydyx+O3P/Bjxfa3Ty+81OcjL4f7k2totW2LMnaprYpv1q9firP/R9SUPa4F4hkIgJTTxem3m5MO08Jm03CkfdJ8KsX22UGWXMbzKQOkNwFJg7c+ymza0jrsmO9GqynqmsuYs20/zCq3NtQS08LMMBal8Bik8rL65FOhcs/MsRlJmpdF92qPUEIRtC5/Rh7+5vNv36Vqn2jrVoKVHBTnntIhyvpcCVMTChs4pTms5nZOyPwvyuqsq689xJ1Yltdt5taaSqzvv27Ojp1b6V4xmsrMaoZ36USO4WiRXVXElR2LVJ6D4TSVLrTvCvTCHi+SL1/ADdCMJVqCwAA" autocomplete="off" />
</form></body>

</html> 
```

顶部的我的图像没有显示，输入文本框丢失，命令按钮也丢失。我检查了文件，但它们似乎都在那里。

看来应用程序的模板方面不起作用，所以这就是为什么“标题”没有出现，我猜想这就是为什么其余属性不能正常工作的原因。

非常感谢任何和所有帮助。我将非常感激！

**编辑：添加 web.xml**

```
 <?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">
  <display-name>miloWeb</display-name>
  <welcome-file-list>
    <welcome-file>faces/pages/index.xhtml</welcome-file>
  </welcome-file-list>
  <listener>
    <listener-class>com.bravo.listeners.ServletListener</listener-class>
  </listener>
  <servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>/faces/*</url-pattern>
  </servlet-mapping>
  <servlet>
        <servlet-name>PdfServlet</servlet-name>
        <servlet-class>com.bravo.servlets.PdfServlet</servlet-class>
    </servlet>    
    <servlet-mapping>
        <servlet-name>PdfServlet</servlet-name>
        <url-pattern>/PdfServlet</url-pattern>
  </servlet-mapping>
  <filter>
       <filter-name>MyFacesExtensionsFilter</filter-name>
       <filter-class>org.apache.myfaces.webapp.filter.ExtensionsFilter</filter-class>
  </filter> 
  <filter-mapping>
       <filter-name>MyFacesExtensionsFilter</filter-name>
       <servlet-name>Faces Servlet</servlet-name> 
  </filter-mapping>
  <context-param>
    <description>
      This is to Have separated faces.config files            
    </description>
    <param-name>javax.faces.CONFIG_FILES</param-name>
    <param-value>
      /pages/history/faces-config.xml,
      /pages/contactInformation/faces-config.xml,
      /pages/childHealthRecord/faces-config.xml,
      /pages/dashboard/faces-config.xml,
      /pages/insurance/faces-config.xml,
      /pages/search/faces-config.xml,
      /pages/labs/faces-config.xml,
      /pages/patient/faces-config.xml,
      /pages/physical/faces-config.xml,
      /pages/notes/faces-config.xml,
      /pages/scheduler/faces-config.xml,
      /pages/settings/faces-config.xml,
      /pages/orderEntry/faces-config.xml,
      /pages/vitals/faces-config.xml
    </param-value>
  </context-param>
  <context-param>
    <param-name>javax.faces.DEFAULT_SUFFIX</param-name>
    <param-value>*.xhtml</param-value>
  </context-param>
  <context-param>
    <description>State saving method: 'client' or 'server' (=default). See JSF Specification 2.5.2</description>
    <param-name>javax.faces.STATE_SAVING_METHOD</param-name>
    <param-value>client</param-value>
  </context-param>
  <context-param>
    <param-name>javax.servlet.jsp.jstl.fmt.localizationContext</param-name>
    <param-value>resources.application</param-value>
  </context-param>
</web-app> 
```

**本地主机启动控制台中的***Tomcatv7.0 服务器的* AS ：

 **一个有效的：

```
 Apr 17, 2012 12:24:49 AM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\Program Files\Java\jre6\bin;.;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Program Files\Common Files\Microsoft Shared\Windows Live;C:\Program Files (x86)\Common Files\Microsoft Shared\Windows Live;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\WIDCOMM\Bluetooth Software\;C:\Program Files\WIDCOMM\Bluetooth Software\syswow64;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\Program Files (x86)\Common Files\Roxio Shared\10.0\DLLShared\;C:\Program Files (x86)\Common Files\Roxio Shared\DLLShared\;C:\Program Files (x86)\Windows Live\Shared;C:\Program Files (x86)\QuickTime\QTSystem\;C:\Program Files\SlikSvn\bin\;C:\Program Files\Java\jdk1.6\bin
Apr 17, 2012 12:24:50 AM org.apache.coyote.http11.Http11Protocol init
INFO: Initializing Coyote HTTP/1.1 on http-8080
Apr 17, 2012 12:24:50 AM org.apache.coyote.ajp.AjpProtocol init
INFO: Initializing Coyote AJP/1.3 on ajp-8009
Apr 17, 2012 12:24:50 AM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 909 ms
Apr 17, 2012 12:24:50 AM org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
Apr 17, 2012 12:24:50 AM org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.4
Apr 17, 2012 12:24:50 AM org.apache.catalina.startup.HostConfig deployDescriptor
INFO: Deploying configuration descriptor miloWeb.xml from C:\tomcat\conf\Catalina\localhost
Apr 17, 2012 12:25:10 AM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jsf/core is already defined
Apr 17, 2012 12:25:10 AM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://shiro.apache.org/tags is already defined
Apr 17, 2012 12:25:11 AM com.sun.faces.config.ConfigureListener contextInitialized
INFO: Initializing Mojarra 2.0.6 (FCS FCS) for context '/miloWeb'
Apr 17, 2012 12:25:13 AM com.sun.faces.spi.InjectionProviderFactory createInstance
INFO: JSF1048: PostConstruct/PreDestroy annotations present.  ManagedBeans methods marked with these annotations will have said annotations processed.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processComponent
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class 'org.apache.myfaces.custom.aliasbean.AliasBeanTagHandler' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processComponent
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class 'org.apache.myfaces.custom.aliasbean.AliasBeansScopeTagHandler' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processComponent
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class 'org.apache.myfaces.custom.calendar.HtmlInputCalendarTagHandler' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processComponent
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class 'org.apache.myfaces.custom.date.HtmlInputDateTagHandler' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processComponent
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class 'org.apache.myfaces.custom.schedule.ScheduleTagHandler' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processComponent
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class 'org.apache.myfaces.custom.tabbedpane.HtmlPanelTabbedPaneTagHandler' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processComponent
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class 'org.apache.myfaces.custom.tree.taglib.TreeTagHandler' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processValidator
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class 'org.apache.myfaces.validator.ValidatorBaseTagHandler' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processValidator
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class 'org.apache.myfaces.validator.ValidatorBaseTagHandler' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processValidator
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class 'org.apache.myfaces.validator.ValidatorBaseTagHandler' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processValidator
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class 'org.apache.myfaces.validator.ValidatorBaseTagHandler' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processHandlerClass
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class '[handler-class: null]' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processHandlerClass
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class '[handler-class: null]' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processHandlerClass
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class '[handler-class: null]' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM com.sun.faces.config.processor.FaceletTaglibConfigProcessor processHandlerClass
WARNING: JSF1029:  Application is versioned at 2.0 (either explicitly by the version of /WEB-INF/faces-config.xml or the lack of a /WEB-INF/faces-confg.xml), however class '[handler-class: null]' depends on a legacy facelet class.  The facelet artifact represented by this class will not be registered.
Apr 17, 2012 12:25:13 AM org.primefaces.webapp.PostConstructApplicationEventListener processEvent
INFO: Running on PrimeFaces 3.2
Apr 17, 2012 12:25:13 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory docs
Apr 17, 2012 12:25:14 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory examples
Apr 17, 2012 12:25:14 AM org.apache.catalina.core.ApplicationContext log
INFO: ContextListener: contextInitialized()
Apr 17, 2012 12:25:14 AM org.apache.catalina.core.ApplicationContext log
INFO: SessionListener: contextInitialized()
Apr 17, 2012 12:25:14 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory host-manager
Apr 17, 2012 12:25:14 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory manager
Apr 17, 2012 12:25:14 AM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory ROOT
Apr 17, 2012 12:25:14 AM org.apache.coyote.http11.Http11Protocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
Apr 17, 2012 12:25:14 AM org.apache.coyote.ajp.AjpProtocol start
INFO: Starting Coyote AJP/1.3 on ajp-8009
Apr 17, 2012 12:25:14 AM org.apache.catalina.startup.Catalina start
INFO: Server startup in 24304 ms 
```

一个不起作用：

```
 Apr 17, 2012 12:25:03 AM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\Program Files\Java\jre6\bin;C:\windows\Sun\Java\bin;C:\windows\system32;C:\windows;C:\Program Files\Common Files\Microsoft Shared\Windows Live;C:\Program Files (x86)\Common Files\Microsoft Shared\Windows Live;C:\windows\system32;C:\windows;C:\windows\System32\Wbem;C:\windows\System32\WindowsPowerShell\v1.0\;C:\Program Files (x86)\Windows Live\Shared;C:\Program Files (x86)\ATI Technologies\ATI.ACE\Core-Static;C:\Program Files\SlikSvn\bin\;C:\Program Files\Java\jdk1.6.0_29\bin;.
Apr 17, 2012 12:25:03 AM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:miloWeb' did not find a matching property.
Apr 17, 2012 12:25:03 AM org.apache.coyote.http11.Http11Protocol init
INFO: Initializing Coyote HTTP/1.1 on http-8080
Apr 17, 2012 12:25:03 AM org.apache.coyote.ajp.AjpProtocol init
INFO: Initializing Coyote AJP/1.3 on ajp-8009
Apr 17, 2012 12:25:03 AM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 972 ms
Apr 17, 2012 12:25:03 AM org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
Apr 17, 2012 12:25:03 AM org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.4
Apr 17, 2012 12:25:25 AM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://java.sun.com/jsf/core is already defined
Apr 17, 2012 12:25:25 AM org.apache.catalina.startup.TaglibUriRule body
INFO: TLD skipped. URI: http://shiro.apache.org/tags is already defined
Apr 17, 2012 12:25:26 AM com.sun.faces.config.ConfigureListener contextInitialized
INFO: Initializing Mojarra (1.2_12-b01-FCS) for context '/miloWeb'
Apr 17, 2012 12:25:26 AM com.sun.faces.spi.InjectionProviderFactory createInstance
INFO: JSF1048: PostConstruct/PreDestroy annotations present.  ManagedBeans methods marked with these annotations will have said annotations processed.
Apr 17, 2012 12:25:27 AM org.apache.coyote.http11.Http11Protocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
Apr 17, 2012 12:25:27 AM org.apache.coyote.ajp.AjpProtocol start
INFO: Starting Coyote AJP/1.3 on ajp-8009
Apr 17, 2012 12:25:27 AM org.apache.catalina.startup.Catalina start
INFO: Server startup in 23737 ms 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T06:02:12.383

你的 tomcat 中有正确的 Mojarra 版本吗？看起来不是这样：-/

不工作：

```
Apr 17, 2012 12:25:26 AM com.sun.faces.config.ConfigureListener contextInitialized
INFO: Initializing Mojarra (1.2_12-b01-FCS) for context '/miloWeb' 
```

在职的：

```
Apr 17, 2012 12:25:11 AM com.sun.faces.config.ConfigureListener contextInitialized
INFO: Initializing Mojarra 2.0.6 (FCS FCS) for context '/miloWeb' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T05:04:48.890

好吧，从您呈现的 html 中，很明显 JSF 不适用于您的 xhtml。它就是这样。似乎 JSF 配置不正确或 servlet 映射不正确。您可以在此处添加 web.xml，还可以从 tomcat 日志中检查 JSF 是否正确启动（在 helios 控制台视图中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T05:36:20.843

好的，我会假设它正在工作，现在没有任何项目更改它不是吗？那么可能的问题包括： 服务器更改？您是否确保 facelets jar 在您的项目或服务器中？改名？也许您的项目有一个新名称，或者您需要确保项目名称在服务器中正确映射？你破坏了你的项目？您在签入或签出项目时是否遇到任何错误？**

# java - 如果会话因其他原因被重置，如何将请求参数设置为在会话中可用

> ID：10182550
> 
> 赞同：1
> 
> 时间：2012-04-16T22:22:51.380
> 
> 标签：java, session, servlets

```
String reqParam=request.getParameter("param");

    if(reqParam!=null){
          HttpSession session=request.getSession(false);
          if(session!=null){
            session.setAttribute("reqParamInSession", reqParam);
          }
    } 
```

当调用方法时，我使用上面的代码将请求参数值设置到会话`doFilter`中。但是当用户导航到不同的体验时（假设管理商店的三个不同分店的用户将对每个分店有不同的体验），除了用户配置文件之外，会话将被清除。当用户体验发生变化时，我不管理重置会话的模块。但是即使用户改变了体验，我仍然需要我在会话中设置的参数。

有没有办法将参数与发送的每个请求相关联，而不管会话是否被更改？或者任何其他方式来处理这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T10:54:21.220

不要使用应用程序范围，就好像会话因任何原因而关闭一样，参数不会被清除。如果可以，请使用 cookie。

# cygwin - 安装旧版本的 Cygwin

> ID：10182557
> 
> 赞同：4
> 
> 时间：2012-04-16T22:23:31.897
> 
> 标签：cygwin

有什么办法可以回去安装旧版本的 Cygwin？

说我想要1.7.9版本，但是`setup.exe`Cygwin网站上的总是指向最新版本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T14:31:51.487

[http://www.cygwin.com/setup.exe](http://www.cygwin.com/setup.exe)将始终指向最新版本。cygwin.com 上唯一可用的先前版本是[“setup-legacy”](http://www.cygwin.com/win-9x.html)文件，它是 1.5.25 版，与旧版本的 Windows 兼容。由于与最新的可用软件包不兼容，不鼓励下载旧版本的 Cygwin。

也就是说，如果您确定要使用旧版本的 setup.exe，那么获得它的唯一方法就是在其他地方找到镜像的文件。只需谷歌您想要的特定版本，您应该能够轻松找到您要查找的内容。例如，download.cnet.com 有许多以前的版本：[请](http://www.google.com/#hl=en&sclient=psy-ab&q=site%3adownload.cnet.com+cygwin&oq=site%3adownload.cnet.com+cygwin&aq=f&aqi=&aql=&gs_l=hp.3...8289l15117l4l15221l35l35l15l0l0l4l381l5021l2-11j6l17l0.&psj=1&bav=on.2,or.r_gc.r_pw.r_qf.,cf.osb&fp=c2a3d8871f6dcd2c&biw=1241&bih=615)自行查看。

总之，没有“官方”方式来获取以前的 Cygwin 版本，因此您必须找到该特定版本的镜像。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-03-27T17:26:07.380

是的，请参阅此答案，但忽略有关 Postgres 的部分

[https://serverfault.com/a/532412/123651](https://serverfault.com/a/532412/123651)

2.  如果需要，请安装旧版本。有人维护 Cygwin 版本的历史档案。
    1.  浏览您需要的 setup.ini 文件的时间戳：[http ://www.crouchingtigerhiddenfruitbat.org/Cygwin/timemachine.html](http://www.crouchingtigerhiddenfruitbat.org/Cygwin/timemachine.html)
    2.  复制文件夹的地址（不是index.html）
    3.  `/setup-x86.exe -X`使用忽略设置签名的选项运行`-X`（它们未存档）。
    4.  将地址粘贴到对话框中以选择您的下载站点。然后，您将看到在此期间可用的软件包的快照。

然后选择 Cygwin 基础包以获取旧版本。

# c# - C# MD5 和 Objective C MD5 之间的差异

> ID：10182558
> 
> 赞同：0
> 
> 时间：2012-04-16T22:23:32.520
> 
> 标签：c#, objective-c, web-services, md5

我正在尝试从原生 iPhone 应用程序与 C# 服务进行通信。为了进行通信，输入的密码需要进行哈希处理，并与存储在服务器上的哈希版本进行比较。我正在尝试在 Objective C 中重新创建 C# 哈希，这就是它开始变得有趣的地方

目标 C 代码：

```
NSString * password = @"testPass123";
const char *cPassword = [password UTF8String];    

NSString * key = @"Garbage12345";
NSData * keyData = [NSData dataFromBase64String:key];
NSUInteger len = [keyData length];
unsigned char * cKey = (unsigned char *)malloc(len);
memcpy(cKey, [keyData bytes], len);

// Concatenate into one byte array
unsigned char totalString[18];
for (int i = 0; i < strlen(cPassword); i++) {
    totalString[i] = cPassword[i];
}

for (int i = 0; i < len; i++) {
    totalString[strlen(cPassword) + i] = cKey[i];
}

// DEBUG: Display byte array
for (int i = 0; i < 18; i++) {
    NSLog(@"totalString: %x", totalString[i]);
}

// **** totalString == plainTextWithSaltBytes from the C# portion ****
unsigned char result[CC_MD5_DIGEST_LENGTH];
CC_MD5(totalString, CC_MD5_DIGEST_LENGTH, result);

for (int i = 0; i < CC_MD5_DIGEST_LENGTH; i++) {
    NSLog(@"result: %02x", result[i]);
} 
```

C#代码：

```
byte[] SaltBytes = Convert.FromBase64String("Garbage12345");

// Convert plain text into a byte array.
byte[] plainTextBytes = Encoding.UTF8.GetBytes("testPass123");

// Allocate array, which will hold plain text and salt.
byte[] plainTextWithSaltBytes = new byte[plainTextBytes.Length + SaltBytes.Length];

// Copy plain text bytes into resulting array.
for (int i = 0; i < plainTextBytes.Length; i++)
    plainTextWithSaltBytes[i] = plainTextBytes[i];

// Append salt bytes to the resulting array.
for (int i = 0; i < SaltBytes.Length; i++)
    plainTextWithSaltBytes[plainTextBytes.Length + i] = SaltBytes[i];

HashAlgorithm hash = new MD5CryptoServiceProvider();

// **** plainTextWithSaltBytes == totalString from the Obj-C portion ****
// Compute hash value of our plain text with appended salt.
byte[] hashBytes = hash.ComputeHash(plainTextWithSaltBytes);

// Convert result into a base64-encoded string.
string hashValue = Convert.ToBase64String(hashBytes); 
```

在字节数组进入 MD5 部分之前，我得到了相同的结果。使用提供的虚拟数据返回：

```
74
65
73
74
50
61
73
73
31
32
33
19
aa
db
6a
07
b5
db 
```

但是，之后我得到了不同的值，不知道从那里去哪里。

有人有想法么？随时指出我做错的事情。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:33:13.577

我怀疑你的错误是第二个参数`CC_MD5`应该是输入而不是输出长度。传入输入长度应该可以解决您的直接问题。

但我认为，您应该丢弃双方的代码，并使用一些专为密码散列设计的功能。如 PBKDF2 或 bcrypt。

您将哈希发送到服务器也很奇怪。通常，您将密码发送到服务器并在那里散列。发送散列实质上改变了密码的定义，并允许不知道密码但知道散列的攻击者登录。

# multithreading - 如何计算螺纹效率的阿玛达尔定律

> ID：10182559
> 
> 赞同：2
> 
> 时间：2012-04-16T22:23:45.427
> 
> 标签：multithreading, concurrency

它很容易找到和理解 Amadahl 定律的函数定义，但是我能找到的所有工作示例要么太模糊，要么太学术/太大脑，以至于我的小豌豆大脑无法理解。

Amadahl 定律采用以下参数：`F`，不能通过多线程改进的任务的百分比，以及`N`，要使用的线程数。

**如何`F`以任何程度的准确度进行计算？**

您如何查看一段代码并确定多线程是否会对其进行改进？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:33:47.070

说你的代码的哪些部分肯定不会从多线程中受益相对容易：顺序部分。如果您必须按顺序执行一系列小步骤，多线程将无济于事，因为您总是需要等待一个步骤完成才能开始下一步。从这个意义上说，许多常见任务（不一定）不是顺序的：例如，在列表中搜索多个项目。如果要从列表中提取每个红色项目，可以在多个线程之间共享列表的一部分，并将每个部分中的所有红色项目收集到最终结果列表中。并发编程的困难在于为实际问题找到有效的方法。

在较低级别上，您可以谈论数据依赖性：特定指令或块依赖于前一个块，如果它自己使用该块的计算结果。所以（伪代码）：

```
Block one:
load r1 into r2
add r1 to r3 into r4

Block two:
load r4 into r1
add 3 to r4 into r4 
```

块二依赖于块一：它们必须按顺序执行。这里：

```
Block one:
load r1 into r2
add r1 to r3 into r4

Block two:
load r1 into r3
add 3 to r1 into r1 
```

事实并非如此。这对并发没有直接的用处，但希望它能更具体地说明这一点。它还说明了处理并发性的另一个问题：作为抽象块功能，这两个功能可以并行运行，但在此处给出的具体示例中，它们正在读取/写入一些相同的寄存器，因此编译器/流水线/无论什么都必须做更多的工作让它们一起运行。这一切都非常复杂，但在[http://www.amazon.com/Computer-Architecture-Quantitative-Approach-Edition/dp/1558605967](https://rads.stackoverflow.com/amzn/click/com/1558605967)中有很好的介绍。

哪些其他部分不能从多线程中受益取决于您的编程环境和机器架构。

至于如何获得百分比，在一个实际案例中可能会涉及一些挥手——我怀疑你永远不会得到一个准确的数字。如果您将代码划分为功能单元并分析每个功能单元的执行时间，这将为您提供大致适当的权重。那么如果一个占用 90% 执行时间的部分可以通过多线程来改进，你说你的 90% 的“任务”可以得到如此改进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:42:25.253

如果你想看看多线程可以改进什么，你应该看看*算法而不是代码。*

通常，并行算法应该从头开始设计为并行的。“并行化”代码而不是算法本身要困难得多。

查看内存访问中的依赖关系（空间依赖关系），查看操作序列（时间依赖关系），了解您的计算机体系结构，您将知道如何为您的任务构建合适的算法。

根据公式本身 - Wiki 有很好的解释[http://en.wikipedia.org/wiki/Amdahl](http://en.wikipedia.org/wiki/Amdahl) 's_law

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T22:49:03.190

Amdahl 将所有工作分为两组：完全可并行化和完全不可并行化。

将后者视为您永远无法摆脱的工作。您可以摆脱以前完美的海湾添加资源。

如果你读取一个文本文件并逐行处理它，你永远无法摆脱顺序读取文件来解析这些行。但是，您可以并行化各个行。如果读取文件需要 1 秒，那么您的代码将永远不会运行得比这更快。

对于真正的代码，你可以连接一个分析器来查看每个部分花费了多少时间。希望您可以将每个部分归为其中一个类别。完成此操作后，您可以轻松估计加速，它会非常准确。

# vb.net - 在 VB.NET 中创建一个新线程

> ID：10182563
> 
> 赞同：26
> 
> 时间：2012-04-16T22:24:15.830
> 
> 标签：vb.net, multithreading

我正在尝试使用匿名函数创建一个新线程，但我不断收到错误消息。这是我的代码：

```
New Thread(Function() 
    'Do something here
End Function).Start 
```

这是我得到的错误：

新的：

> 语法错误

结束功能：

> 'End Function' 前面必须有一个匹配的 'Function'。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-04-16T22:41:32.947

有两种方法可以做到这一点；

1.  用`AddressOf`运营商来现有的方法

    ```
    Sub MyBackgroundThread()
      Console.WriteLine("Hullo")
    End Sub 
    ```

    然后创建并启动线程；

    ```
    Dim thread As New Thread(AddressOf MyBackgroundThread)
    thread.Start() 
    ```

2.  或作为 lambda 函数。

    ```
    Dim thread as New Thread(
      Sub() 
        Console.WriteLine("Hullo")
      End Sub
    )
    thread.Start() 
    ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-17T00:08:28.083

它在 VB中称为[lambda 表达式。](http://msdn.microsoft.com/en-us/library/bb531253.aspx)语法都是错误的，您需要实际声明一个 Thread 类型的变量才能使用 New 运算符。并且您创建的 lambda 必须是您传递给 Thread 类构造函数的参数的有效替代品。其中没有一个接受返回值的委托，因此您必须使用 Sub，而不是 Function。一个随机的例子：

```
Imports System.Threading

Module Module1

    Sub Main()
        Dim t As New Thread(Sub()
                                Console.WriteLine("hello thread")
                            End Sub)
        t.Start()
        t.Join()
        Console.ReadLine()
    End Sub

End Module 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-17T13:05:44.820

所谓的必须是功能而不是子。

单行（必须返回值）：

```
Dim worker As New Thread(New ThreadStart(Function() 42)) 
```

多行：

```
Dim worker As New Thread(New ThreadStart(Function()
                                                     ' Do something here
                                                 End Function)) 
```

来源：[VB.Net 中的线程、闭包和 Lambda 表达式](http://mlindegarde.wordpress.com/2010/08/31/threading-closures-and-lambda-expressions-in-vb-net/)

# mysql - 我可以使用什么软件来自动化 MySQL 数据库中的差异数据？

> ID：10182564
> 
> 赞同：4
> 
> 时间：2012-04-16T22:24:31.340
> 
> 标签：mysql, sql, liquibase

我非常了解并喜欢用于模式迁移/模式差异的[liquibase ，但最近我有一个奇怪的用例需要支持 - 内容管理数据迁移。](http://www.liquibase.org)大多数非企业数据倾向于将大量结构化数据保存为 SQL 记录，因此将其作为 PITA 来保持此类设置同步。

所以我绝望地寻找的是一个可编写脚本的、可配置的、多平台（至少是 Windows 和 Mac OS X）的软件，它允许我区分共享一个公共模式的两个 MySQL 数据库的数据，这让我可以配置哪些表我想比较（也许还有一些其他的东西）并输出一个带有差异的 SQL 文件，以便我可以将其拼接到我的其他 liquibase 迁移文件中。

是的，我知道有来自 RedGate、DBSolo 以及它们的名称的此类工具（我对这个领域缺乏自由软件工具感到惊讶！），但它们似乎都至少有两个缺点：它们可以'不是自动化的/脚本化的和/或不是多平台的。

**TL;DR：**有谁知道 MySQL 的数据差异库/程序，最好是 Java，可以通过 Ant 或命令行编写脚本并输出 SQL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:31:06.623

您可能想尝试[SQL Workbench/J 的](http://www.sql-workbench.net) [WbDataDiff](http://www.sql-workbench.net/manual/compare-commands.html#command-data-diff)命令。

它可以在批处理模式下运行，因此可以通过命令行编写脚本。您甚至可以从 Ant 运行它，因为它是一个 Java 应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T05:03:30.807

Pt-table-sync 是 percona 工具包套件的一部分。它完全用 perl 编写，并且有可靠的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T23:27:15.310

我了解您正在寻找差异工具，但也许您也可能对提取和恢复数据子集感兴趣。

*   [http://jailer.sourceforge.net/](http://jailer.sourceforge.net/)
*   [http://www.dbunit.org/howto.html](http://www.dbunit.org/howto.html)

# javascript - 更改没有 ID 的特定实例

> ID：10182568
> 
> 赞同：0
> 
> 时间：2012-04-16T22:25:16.813
> 
> 标签：javascript, jquery

好的，假设我在一个页面上有多个链接，我希望链接在您滚动它们时改变背景颜色。我会使用这段代码：

```
$(function() {
    $('a').mouseover(function() {
        $('a').css('background-color', 'black');
    });
}); 
$(function() {
    $('a').mouseleave(function() {
        $('a').css('background-color', 'white');
    });
}); 
```

这段代码的问题是，当你翻过一个 a 时，所有的链接都会改变颜色。我可以给每个人一个特定的 ID 并为每个人创建一个特定的功能，但是有没有更有效的方法来做到这一点？编辑：此外，我可以做些什么来将原始背景颜色设置回原来的样子。如果我把背景变回白色，它可能一开始就不是白色的。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T22:26:24.927

在您的版本中，您用于`$('a')`调用该`.css()`函数。问题是`$('a')`选择页面上的所有 a 节点，而不仅仅是您将鼠标移到的节点。在 mouseover 回调函数中，`this`关键字引用作为事件发起者的节点。因此，当您`$(this)`在该函数中执行操作时，您将创建该节点的一个 jQuery 对象（称为包装集）。现在您可以在其上调用所有 jquery 函数，不包括该`.css()`函数。所以你去：

```
$(function() {
    $('a').mouseover(function() {
        $(this).css('background-color', 'black');
    });
}); 
$(function() {
    $('a').mouseleave(function() {
        $(this).css('background-color', 'white');
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T22:45:42.927

只是让你知道，你们都在漫长而艰难的道路上前进。

```
// this is like document.onload = function, 
//  this only needs to be called once, you can put 
//  all your jQuery in this one function
$(function() {
    // the following is a call to all `a` links to add jQuery's own .hover function
    // see -> http://api.jquery.com/hover/
    $("a").hover(function(eIn) { // this first function is the action taken when
                                 // user hovers over the link
        $(this).css({ 'background-color': '#000', 'color': '#fff' });
    }, function(eOut) { // this second function is what happens 
                        // when user hover away from the link
        $(this).css({ 'background-color': '', 'color': '' });
    });
}); 
```

[见工作小提琴](http://jsfiddle.net/SpYk3/8beT8/)

***此外，您不需要为此使用 JQUERY，请使用 CSS***

在 CSS 中：

```
a:hover {
    background-color: #000;
    color: #fff;
}​ 
```

[仅在此处查看 CSS](http://jsfiddle.net/SpYk3/jgcHH/)

# c# - 确定返回内部列表 作为 IEnumerable 或 ICollection ?

> ID：10182569
> 
> 赞同：5
> 
> 时间：2012-04-16T22:25:18.553
> 
> 标签：c#, collections, return, return-type

> **可能重复：**
> [Collection<T> 与 List<T> 您应该在界面上使用什么？](https://stackoverflow.com/questions/271710/collectiont-versus-listt-what-should-you-use-on-your-interfaces)

考虑这个方法——返回的变量`myVar`是 a `List<T>`，但方法的返回类型`MyMethod()`是 an `IEnumerable<T>`：

```
public IEnumerable<T> MyMethod(string stuff)
{
     var myVar = new List<T>();
     //do stuff

     return myVar;
} 
```

本质上，我想知道的是，`myVar`作为不同类型返回是否可以。

具体来说，就我的情况而言，“做事”通过 a`DataRow`并将其中的项目分配给`DataRow`对象列表。我在其他地方也有类似的情况`ICollection`和`IList`返回类型。

我想返回`IEnumerable`或返回的原因`ICollection`是我返回的数量不会超过需要。但同时，这允许调用者在需要时将返回的值转换为 a `List`。

但是，我的 return 语句返回 a`List`而不是方法的返回类型似乎很奇怪。这是正常的做法吗？这样做有什么问题吗？

**澄清（回应欺骗评论）：**

澄清一下，我很好奇的是，如果我在 body 中的 return 语句返回 a 是否可以`List<T>`，但方法头的返回类型为`IEnumerable`，或者可能`ICollection`，`Collection`等等...与 body*不同*的东西返回声明。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T22:32:00.877

它不仅没有任何问题，而且实际上是一种很好的做法：只公开严格必要的内容。这样，调用者就不能依赖该方法将返回 a 的事实`List<T>`，因此如果由于某种原因您需要更改实现以返回其他内容，您不会违反合同。但是，如果调用代码（错误地）假设该方法实际返回的内容，则调用代码*可能会中断。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-16T22:28:39.097

返回`IEnumerable<T>`类型的原因是他们的调用者无法修改列表（不将其转换回列表）。如果您注意到所有（大多数？）扩展方法都带有一个`IEnumerable<T>`参数，那么您就知道扩展方法不会修改您的列表。

其次，`List<T>`继承自`IEnumerable<T>`.

**编辑：** 正如托马斯在评论中解释的那样，`IEnumerable<T>`可以将其转换回 a`List<T>`并由调用者修改。如果您的主要目标是使其成为只读，则可以将列表返回为`myVar.AsReadOnly()`. 但是类型是`ReadOnlyCollection<T>`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-16T22:28:06.920

没有什么问题。

实际上返回具体类是满足“返回接口”要求的唯一方法。

如果你让特定类的知识潜入调用代码（`List<T> r = (List<T>)MyMethod("ff")`），可能会有缺点。但是，如果您将结果视为接口（如您所愿），那就可以了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-16T22:37:22.827

我认为这不是最优的，因为它允许调用者转换为`List<T>`，这依赖于实现细节。我会添加某种掩码，例如`Select(x=>x)`.

动态类型的调用者甚至可能不会注意到您将列表转换为`IEnumerable<T>`. 对他来说，简直了`List<T>`。

返回一个内部永久`List<T>`物`IEnumerable<T>`是非常错误的，因为它允许调用者改变你的类的内部状态。但是，由于您`List<T>`在每次调用时都返回一个新实例，它不会在其他任何地方使用，因此此参数不适用于您的示例。

# sql - 红宝石追随者查询

> ID：10182570
> 
> 赞同：1
> 
> 时间：2012-04-16T22:25:21.417
> 
> 标签：sql, ruby-on-rails

我们的 Rails 3 应用程序中有一个 SQL 查询。

`@followers`返回后面的用户 ID 数组`current_user`。

```
@followers = current_user.following
@feed_items = Micropost.where("belongs_to_id IN (?)", @followers) 
```

有没有更有效的方法来做这个查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:46:20.217

您拥有的查询无法真正优化。可以通过添加索引来加快速度`belongs_to_id`（无论如何，您几乎总是应该为外键做这件事），但这不会改变实际的查询。

不过，有一种更简洁的方式来编写`IN`查询：

```
Micropost.where(:belongs_to_id => @followers) 
```

其中`@followers`是 的值数组`belongs_to_id`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T22:49:42.050

对我来说看起来不错。

但是，如果您正在寻找代码中真正的最小字符数，您可以更改：

`Micropost.where("belongs_to_id IN (?)", @followers)`
至
`Micropost.where("belongs_to_id = ?", @followers)`

读起来容易一些。

Rails 将看到数组并执行`IN`.

与往常一样，ruby 语言的*主要*目标是可读性，因此很少有改进帮助。

至于查询效率低下，您应该检查该字段的索引。
对于每个数据库，它们往往更具体一些——您只指定了通用 sql。在你的问题中。

# java - 罐子和安卓

> ID：10182571
> 
> 赞同：0
> 
> 时间：2012-04-16T22:25:23.070
> 
> 标签：java, android, jar, intellij-idea

我试图在我的 Android 项目中使用 JAR 文件，但我一直出错。该错误已在此处多次引用，但没有一个解决方案对我有用。

我正在使用这个罐子：[http ://htmlcleaner.sourceforge.net/index.php](http://htmlcleaner.sourceforge.net/index.php)

我正在使用 IntelliJ IDE。

我尝试了以下设置的组合：

在 AndroidManifest.xml 中，以下行之一（不能同时）

```
<uses-library android:name="org.htmlcleaner.HtmlCleaner"/>
<uses-library android:name="org.htmlcleaner"/> 
```

我将 JAR 文件复制到我的 libs/ 文件夹并运行它，我得到：`INSTALL_FAILED_MISSING_SHARED_LIBRARY`

我尝试在各个地方通过项目结构设置添加 Jar 文件

```
Project Structure -> Module -> Dependencies -> Add -> Jar -> jar file
Project Structure -> Module -> Dependencies -> Add -> Library -> New Library -> jar file / lib dir

Project Structure -> Libraries -> Add -> jar file 
```

这些都不能解决问题。

我也尝试删除

我对每个 JAR 文件都有这个问题。

我的 AVD 设置：

```
Platform 2.3.1
API Level 9
Not using Any Google Maps 
```

请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:29:44.020

删除`<uses-library>`元素，因为它们不用于第三方 JAR。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:33:22.793

为桌面 JVM 编译的 Java 字节码不能在 Android 上运行。您需要使用 Dalvik 编译器编译 Java 源代码以生成 .dx 文件，这些文件可由 Android 上的 Dalvik VM 执行。

编辑：编译 java 源代码，获取包含源代码的 jar 文件，解压缩，然后将 .java 文件添加到您的构建路径。我不确定如何在 IntilliJ 中添加到构建路径，但在 eclipse 中，它就像右键单击并单击“包含”（或导入）一样简单。这将编译库的代码和您自己的代码。

# c# - 我应该对图像使用 ObservableCollection

> ID：10182572
> 
> 赞同：2
> 
> 时间：2012-04-16T22:25:23.843
> 
> 标签：c#, wpf, binding, mvvm

我正在为一个应用程序使用 mvvm 模式，该应用程序使用实体框架版本 4 从 sql ce 数据库获取数据。WPF 应用程序只有一个视图（不再需要，因为应用程序不是那么大）。我通过在我的视图模型中创建一个 observablecollection 并绑定它，在列表框中显示来自数据库的属性集合。这完全符合预期。问题是我现在有另一个列表框（在同一视图中），需要为每个属性填充图像。需要明确的是，每个属性都有一堆图像，但每个图像只分配给一个属性。

显示图像的最佳方式是什么，我想可能会为图像创建另一个 observablecollection，但我不确定如何确保只显示适当属性的图像。或者我应该简单地将列表框绑定到每个属性（房屋）的图像属性？

干杯

```
 private void Load()
    {
        PropertyList = new ObservableCollection<Property>((from property in entities.Properties.Include("Images")
                                                          select property));
        propertyView = CollectionViewSource.GetDefaultView(PropertyList);
        if (propertyView != null)
            propertyView.CurrentChanged += new System.EventHandler(propertyView_CurrentChanged);           

        RaisePropertyChanged("CurrentContact");
        RaisePropertyChanged("SaleTitle");
        RaisePropertyChanged("Address");
        RaisePropertyChanged("AuctioneerName");
        RaisePropertyChanged("AgentName");
        RaisePropertyChanged("Price");
        RaisePropertyChanged("NextBid");
        RaisePropertyChanged("Status");
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:33:45.553

这听起来显然是不同的责任（主/细节视图）。本着 MVVM 的真正精神，我会创建一个新 View 和一个新 ViewModel - 也许：

```
PropertyImagesViewModel
    - public Property Property { get; set; }
    - public IList<Image> Images { get; set; }
    - public int SelectedIndex { get; set; }

PropertyImagesView 
```

不要忘记在每个属性设置器中调用 RaisePropertyChanged()

另请注意，如果您不是一次处理一个内容，则 ObservableCollection 什么也不做。如果您只是一次更新整个集合，那么它不会给您带来任何切实的好处。

另一件事 - 如果您需要通知您的所有属性都已更改：

```
RaisePropertyChanged(null); 
```

会成功的。

# c - 使用 memcpy 从内存块中读取两个整数

> ID：10182573
> 
> 赞同：0
> 
> 时间：2012-04-16T22:25:24.250
> 
> 标签：c, memcpy

我正在尝试`void *block`使用`memcpy`. 使用以下命令可以很好地阅读第一个：

`memcpy(&test, block, sizeof(int));`

我尝试使用以下方法阅读第二个：

`memcpy(&test, block + sizeof(int), sizeof(int));`

（当然我在程序的不同执行实例中有这些状态，所以问题不在于测试被覆盖）

但我没有得到正确的结果！我在这里做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T22:38:17.207

这是非标准的：

```
void *block = ...; 
block + sizeof(int); // where does this point to? 
```

如果要进行指针运算，请先转换为已知大小的类型（指针加法隐式乘以底层类型的大小，并且`sizeof(unsigned char)`始终为 1）：

```
void *block = ...;
(unsigned char *) block + sizeof(int); 
```

或者使用更简单的版本，

```
void *block = ...;
(int *) block + 1; 
```

所以最终的代码是：

```
int test;
void *block = ...;
memcpy(&test, block, sizeof(test));
// do something...?
memcpy(&test, (int *) block + 1, sizeof(test)); 
```

或者更简单的版本，

```
int test[2];
void *block = ...;
memcpy(&test, block, sizeof(test)); 
```

**请勿执行以下操作：**

```
test = *(int *) block; 
```

`block`如果未对齐，它将在某些系统（通常是 SIGBUS）上崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T22:27:47.340

> 使用以下命令可以很好地阅读第一个：

```
memcpy(&test, block + sizeof(int), sizeof(int)); 
```

> 我尝试使用以下方法阅读第二个：

```
memcpy(&test, block + sizeof(int), sizeof(int)); 
```

那是同一段代码......所以它会做同样的事情（假设你没有修改`test`或`block`在调用之间，你没有向我们展示）。

您正在覆盖 处的第一个值`&test`。假设 test 是一个指向 int 的指针，它有足够的有效内存来保存其中两个......

```
int test[2];
memcpy(test, block, sizeof(test)); 
```

如果`test`只是一个`int`那么...

```
int a, b;
memcpy(&a, block, sizeof(a));
memcpy(&b, (int*)block + 1, sizeof(b)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T22:27:31.470

您正在读取相同的内存位置两次！您可能想要以下内容：

```
int test;
memcpy(&test, (char *)block + 0*sizeof(int), sizeof(int));
printf("%d\n",test);
memcpy(&test, (char *)block + 1*sizeof(int), sizeof(int));
printf("%d\n",test); 
```

请注意，这（故意）非常冗长；更简洁的更正是：

```
int test[2];
memcpy(test, block, 2*sizeof(int));
printf("%d\n%d\n",test[0],test[1]); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-16T22:30:11.943

您从同一地址读取两个整数。这种方式也太冗长了。尝试：

`int *a = (int *)block;`

然后你可以简单地通过`a[0]`and`a[1]`

# php - 奇怪的行为 PHP vs MySQL

> ID：10182575
> 
> 赞同：0
> 
> 时间：2012-04-16T22:25:27.910
> 
> 标签：php, mysql, html

这是 SQL：

```
TRUNCATE TABLE `dc_path`;
INSERT INTO dc_path (coords) VALUES('(40.64406436923055, -8.638539251709062)');
INSERT INTO dc_path (coords) VALUES('(40.62791121610622, -8.615193304443437)');
INSERT INTO dc_path (coords) VALUES('(40.62895347295352, -8.6625718444825)'); 
```

如果我尝试在 phpmyadmin 上执行该查询，它工作得很好，但是通过 php 它给了我这个错误：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INSERT INTO dc_path (coords) VALUES('(40.64406436923055, -8.638539251709062)');I' at line 1 
```

我尝试了很多东西，但我无法解决！

提前致谢。

编辑：

**PHP**

```
function insertPath($coords){
    $conn = connectDB();
    $coords = explode(";",$coords);
    $sql = "";

    $sql = "TRUNCATE TABLE `dc_path`; ";

    for($i=0;$i<count($coords)-1;$i++){
        $sql .= "INSERT INTO dc_path (coords) VALUES('".$coords[$i]."');";
    }
    echo $sql;
    $query = mysql_query($sql, $conn) or die(mysql_error());

    closeDB($conn);
    return true;
} 
```

$coords 变量包含以下值：

```
(40.638854101691635, -8.6515855163575);(40.629474595277166, -8.63235944213875); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T22:28:42.647

您不能在一次`mysql_query()`调用中执行多个查询。

所以将该字符串拆分为 4 个单独`;`的查询（最后没有），一切都会正常

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-16T22:28:22.577

不要使用旧的 mysql_connect API，使用 mysqli - 它支持多个语句合二为一。

在此处阅读有关不同 PHP - mySQL api 的更多信息：[http ://www.php.net/manual/en/mysqlinfo.api.choosing.php](http://www.php.net/manual/en/mysqlinfo.api.choosing.php)

那里说不建议将旧的 mysql API 用于新项目，并且已宣布长期弃用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-16T22:29:39.213

你用什么函数来运行这个？如果您使用的是 mysql_query 那么您一次只能执行一个查询，但是您可以将插入语句合并为一个

```
INSERT INTO dc_path (coords) VALUES
('(40.64406436923055, -8.638539251709062)'),
('(40.62791121610622, -8.615193304443437)'),
('(40.62895347295352, -8.6625718444825)'); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-16T22:31:57.373

```
function insertPath($coords){
    $conn = connectDB();
    $coords = explode(";",$coords);

    mysql_query("TRUNCATE TABLE `dc_path`", $conn);

    for($i=0;$i<count($coords)-1;$i++){
        mysql_query("INSERT INTO dc_path (coords) VALUES('".$coords[$i]."')", $conn);
    }

    closeDB($conn);
    return true;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-16T22:35:16.850

您不能使用 mysql_query() 查询多个语句。

像这样查询

```
for($i=0;$i<count($coords)-1;$i++){
    $sql = "INSERT INTO dc_path (coords) VALUES('".$coords[$i]."');";
    $query = mysql_query($sql, $conn) or die(mysql_error());
} 
```

# ms-access - 通过 ODBC 的 MSAccess - 怪异行为 - DSN 设置

> ID：10182576
> 
> 赞同：0
> 
> 时间：2012-04-16T22:25:31.073
> 
> 标签：ms-access, odbc, dsn

我在同一栋楼的两台机器上使用 MSAccess 数据库。Machine1 上有数据库。Machine2 有一个映射到 Machine1 上数据库的驱动器。我可以在 Machine1 上使用相同的键值并获取记录，但在 machine2 上使用相同的键值有时会找不到记录。但它就在那里。Machine1 完美运行。

正确的解决方法是添加 SQLExpress 并扩大 Access 数据库的大小，但我有理由暂时避免这样做。

我已经更改了 Machine2 上 DSN(ODBC)-MSAcess ODBC 驱动程序高级设置-中的超时设置和 MaxScanRows 设置，这似乎解决了今天的问题。我真的不知道那些高级 ODBC 设置是做什么的，这真的是我的问题。有谁知道这些设置的作用以及哪一个可能对我最有帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:14:57.193

您是否尝试过直接链接表而不是通过 ODBC

# cocoa-touch - 以编程方式获取 UITextField inputAccessoryView 的大小

> ID：10182578
> 
> 赞同：2
> 
> 时间：2012-04-16T22:26:13.490
> 
> 标签：cocoa-touch

我想确定当前键盘显示的 inputAccessoryView 的高度。如果需要，我可能可以通过 firstResponder 进行追踪，但我正在寻找更直接的东西。如果键盘与 inputAccessoryView 一起显示，则返回其高度，否则返回零。

[根据此 SO answer 中显示的代码](https://stackoverflow.com/questions/1490573/how-to-programatically-check-whether-a-keyboard-is-present-in-iphone-app)，我正在使用键盘通知来帮助获取键盘大小。一旦我知道键盘正在显示，我想获取有关输入附件视图的信息。

# iphone - iPhone上完全奇怪的字体渲染

> ID：10182582
> 
> 赞同：10
> 
> 时间：2012-04-16T22:26:25.043
> 
> 标签：iphone, objective-c, fonts

我在我的 iPhone 应用程序中嵌入了一个自定义字体，该字体以前完美呈现（在模拟器和设备上）。但今天，当我在设备上构建并运行应用程序时，它突然看起来像这样：

![不正确的字体渲染](../Images/49ef36f0040d4356b7947446d8d377bc.png)

该问题仅在物理设备上运行时存在。我以前从未见过这种现象；它到底是什么？应用程序中使用的其他字体像以前一样完美呈现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T08:48:27.333

它很奇怪，但我猜字体文件可能被 xcode 错误地压缩了。检查 xcode 是否像处理图像文件一样向字体文件添加压缩。禁用它并尝试查看是否可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T06:48:47.930

我认为您包含的字体文件已被 Xcode 损坏，请删除现有的并移动到垃圾箱并导入新的字体文件。对不起我的英语不好。

# windows-phone-7 - 从音乐中获取专辑封面 (Windows Phone 7)

> ID：10182584
> 
> 赞同：0
> 
> 时间：2012-04-16T22:26:34.607
> 
> 标签：windows-phone-7

创建一个应用程序，我不介意从 WP7 上的 Zune 应用程序的音乐文件中获取专辑封面。只是想知道这是否可能。

这是我在 WP7 上的第一个应用程序和我的第一个用户空间应用程序 - 自从...... 相当好地加快速度 - 只是这让我有点困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T11:52:59.570

你好，纳森尼尔，

抱歉，因为我不知道如何使用 Zune 或嵌入式 API 来实现，但我[找到](http://aws.amazon.com/code/Product-Advertising-API/2480)了 Amazon C# API 示例，这将 100% 帮助您从 Amazon 获取专辑封面。是的，我知道，Amazon API 有点奇怪，但即使在 mp3 文件本身根本没有专辑封面的情况下，它也确实有效。尝试进入它，祝你好运

# xpath - 通过 XPath 提取节点之间的文本

> ID：10182587
> 
> 赞同：5
> 
> 时间：2012-04-16T22:27:00.517
> 
> 标签：xpath

我正在尝试通过 XPath 读取网页的特定部分。该页面的格式不是很好，但我无法更改...

```
<root>
    <div class="textfield">
        <div class="header">First item</div>
        Here is the text of the <strong>first</strong> item.
        <div class="header">Second item</div>
        <span>Here is the text of the second item.</span>
        <div class="header">Third item</div>
        Here is the text of the third item.
    </div>
    <div class="textfield">
        Footer text
    </div>
</root> 
```

我想提取各种项目的文本，即标题 div 之间的文本（例如，“这是第一项的文本。”）。到目前为止，我已经使用了这个 XPath 表达式：

```
//text()[preceding::*[@class='header' and contains(text(),'First item')] and following::*[@class='header' and contains(text(),'Second item')]] 
```

但是，我不能硬编码结束项目名称，因为在我想抓取的页面中，项目的顺序不同（例如，“第一项”可能跟在“第三项”之后）。

任何有关如何调整我的 XPath 查询的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:21:41.617

找到了！

```
//text()[preceding::*[@class='header' and contains(text(),'First item')]][following::*[preceding::*[@class='header'][1][contains(text(),'First item')]]] 
```

事实上，您的解决方案 Aleh 不适用于文本中的标签。

现在，剩下的情况是最后一项，它后面没有带有 class=header 的元素；因此它将包括所有找到的文本，直到文档末尾。想法？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T11:12:56.080

`//*[@class='header' and contains(text(),'First item')]/following::text()[1]`将选择之后的第一个文本节点`<div class="header">First item</div>`。
`//*[@class='header' and contains(text(),'Second item')]/following::text()[1]`之后将选择第一个文本节点`<div class="header">Second item</div>`，依此类推
**编辑：**对不起，这不适用于`<strong>`案例。将更新我的答案
**EDIT2：**使用@Michiel 部分。看起来像 omg 但有效：`//div[@class='textfield'][1]//text()[preceding::*[@class='header' and contains(text(),'First item')]][following::*[preceding::*[not(self::strong) and not(self::span)][1][contains(text(),'First item')]] or not(//*[preceding::*[@class='header' and contains(text(),'First item')]])]`
似乎这应该用更好的解决方案来解决:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T21:44:26.150

为了完整起见，最终查询由整个线程中的各种建议组成：

```
//*[
    @class='textfield' and position() = 1
]
//text() [
    preceding::*[
        @class='header' and contains(text(),'First item')
    ]
][
    following::*[
        preceding::*[
            @class='header'
        ][1][
            contains(text(),'First item')
        ]
    ]
] 
```

# hadoop - 如何在 Hadoop 中以容器格式使用 Snappy

> ID：10182591
> 
> 赞同：4
> 
> 时间：2012-04-16T22:27:44.363
> 
> 标签：hadoop, compression, mapreduce

我必须使用 Snappy 来压缩 map o/p 和 map-reduce o/p。此外，这应该是可拆分的。

正如我在网上学习的那样，要让 Snappy 编写可拆分的 o/p，我们必须以类似 Container 的格式使用它。

你能建议如何去做吗？我尝试在网上找到一些示例，但找不到一个。我正在使用 Hadoop v0.20.203。

谢谢。皮尤什

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T05:10:20.207

用于输出

`conf.setOutputFormat(SequenceFileOutputFormat.class); SequenceFileOutputFormat.setOutputCompressionType(conf, CompressionType.BLOCK); SequenceFileOutputFormat.setCompressOutput(conf, true); conf.set("mapred.output.compression.codec","org.apache.hadoop.io.compress.SnappyCodec");`

用于地图输出

`Configuration conf = new Configuration(); conf.setBoolean("mapred.compress.map.output", true); conf.set("mapred.map.output.compression.codec","org.apache.hadoop.io.compress.SnappyCodec");`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-03T12:18:34.177

在为作业安装的新 API OutputFormat 中，而不是为配置安装。然后，第一部分将是：

```
Job job = new Job(conf);
...
SequenceFileOutputFormat.setOutputCompressionType(job, CompressionType.BLOCK);
SequenceFileOutputFormat.setCompressOutput(job, true);

conf.set("mapred.output.compression.codec","org.apache.hadoop.io.compress.SnappyCodec"); 
```

# ruby-on-rails - Ruby on Rails 控制台错误

> ID：10182593
> 
> 赞同：0
> 
> 时间：2012-04-16T22:27:51.180
> 
> 标签：ruby-on-rails

我正在尝试通过 Rails 控制台将一个值插入数据库，但它不起作用。

第一个命令是
u=users.create(:name=>"bob",:address=>"Dublin")

这是我运行第一个命令后的输出

```
 u=Users.create(:name=>"Ben",:address=>"Dublin")
   (0.2ms)  BEGIN
  SQL (0.3ms)  INSERT INTO `users` (`address`, `created_at`, `email`, `name`, `password`, `updated_at`) VALUES ('Dublin', '2012-04-16 23:15:48', NULL, 'Ben', NULL, '2012-04-16 23:15:48')
   (9.1ms)  COMMIT
=> #<Users id: 2, name: "Ben", password: nil, email: nil, address: "Dublin", created_at: "2012-04-16 23:15:48", updated_at: "2012-04-16 23:15:48"> 
```

这是第二个命令
t=tweets.create(:status=>"I am a tweet from bob",:user=>u)

```
NameError: undefined local variable or method `tweets' for main:Object
    from (irb):4
    from /opt/bitnami/ruby/lib/ruby/gems/1.9.1/gems/railties-3.2.1/lib/rails/commands/console.rb:47:in `start'
    from /opt/bitnami/ruby/lib/ruby/gems/1.9.1/gems/railties-3.2.1/lib/rails/commands/console.rb:8:in `start'
    from /opt/bitnami/ruby/lib/ruby/gems/1.9.1/gems/railties-3.2.1/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:29:57.637

假设你有一个`Tweet`模型，你想要

```
u = User.first
t = Tweet.create(:status => "I am a tweet from bob", :user => u) 
```

# c# - 以编程方式将新文件添加到 TFS

> ID：10182601
> 
> 赞同：3
> 
> 时间：2012-04-16T22:28:27.273
> 
> 标签：c#, tfs

我正在尝试使用 C# 将新文件添加到 TFS 源代码控制。

任何人都可以帮助我吗？

谢谢，纳雷什

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T11:42:35.157

[这是使用 TFS API 签入代码](http://blogs.msdn.com/b/buckh/archive/2012/03/10/team-foundation-version-control-client-api-example-for-tfs-2010-and-newer.aspx)的示例。

# neo4j - 使用密码进行 BFS 遍历

> ID：10182602
> 
> 赞同：1
> 
> 时间：2012-04-16T22:28:36.543
> 
> 标签：neo4j, cypher, graph-algorithm, breadth-first-search

我需要使用 BFS 遍历有向无环图 (DAG)。我通过 REST API 使用 neo4j，所以我与 neo4j 通信的主要方式是使用 Cypher。

使用 Cypher，我可以从起始节点检索一组所有路径，并从中派生 BFS 遍历。

我想知道是否有更简单的方法来使用 Cypher 进行 BFS 遍历。我期望的输出将是一组节点集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T12:22:55.763

难道你不能在长度之后对结果路径进行排序，也许从每个节点中取出最后一个节点，比如[http://bit.ly/HF0p0t](http://bit.ly/HF0p0t)

```
start n=node(1) match p = n-[*1..]->m return p, length(p), last(p) order by length(p) asc 
```

以升序取回路径？

# php - 如何设置 Facebook 页面以接收自动更新？

> ID：10182610
> 
> 赞同：0
> 
> 时间：2012-04-16T22:29:03.440
> 
> 标签：php, javascript, facebook, web-services, facebook-graph-api

我觉得不得不问这个问题真是太奇怪了，但是显然，在设置权限或设置正确的访问令牌几个小时后，我觉得我应该在这里寻求一些有经验的帮助。

我尝试了几种不同的途径来利用几个 API 向特定组织的 Facebook 页面发送自动更新，但是每次我遇到各种错误。最近的一对是：

```
• WWW-Authenticate: OAuth "Facebook Platform" "insufficient_scope" "(#200) This API call requires a valid app_id."

• OAuthException: (#200) The user hasn't authorized the application to perform this action 
```

我的应用程序“设置”->“身份验证”对话框上的“扩展权限”包括`publish_stream`：`status_update`和`manage_pages`

我已经按照[https://developers.facebook.com/docs/reference/api/page/](https://developers.facebook.com/docs/reference/api/page/)上的说明获得了一个 access_token ，我什至设置了一个 Facebook 应用程序并给它 publish_stream `Extended Permissions`。

此外，例如，当我按照此处的说明进行操作时：[http](http://www.sergiy.ca/post-on-facebook-app-wall-and-fan-page-wall-as-admin/) ://www.sergiy.ca/post-on-facebook-app-wall-and-fan-page-wall-as-admin/ - 我想出了与`access_token`我一直在尝试使用的相同。当我尝试访问我的提要（通过 graph.facebook.com/APP_ID_NUMERIC_SEQUENCE/feed）时，我会收到如下消息：

```
{
   "error": {
      "message": "An access token is required to request this resource.",
      "type": "OAuthException",
      "code": 104
   }
} 
```

**有人可以建议具体采取哪些步骤来使任何给定的 Facebook 页面成为新的，不仅*允许*外部更新，而且如何获取自动更新所需的所有相关令牌和 ID？**

正如你所看到的，我不是在问如何进行更新，而只是我想确保我在所有初始步骤中都点缀了我的所有 i 并跨越了我的 t，因为这似乎很明显我缺少一个简单的依赖步骤。

# html - 奇怪的问题：有些类没有从 CSS 文件中获取样式

> ID：10182612
> 
> 赞同：0
> 
> 时间：2012-04-16T22:29:09.083
> 
> 标签：html, css

# 描述

问题是，当我只留下 1 页 css 时。没关系

[http://jsfiddle.net/RcJX5578J/3/](http://jsfiddle.net/RcJX5578J/3/)

![在此处输入图像描述](../Images/01eb936357329eabf482d16d0a52e143.png)

但是当我使用的是多合一的 css 文件（所有页面的 css 样式的组合结果。）时，一些 div 不会从 CSS 中获取它们的样式。

[http://jsfiddle.net/RcJX5578J/1/](http://jsfiddle.net/RcJX5578J/1/)

![在此处输入图像描述](../Images/07cf98115bc8f2307a9826531c64a49c.png)

# 问题是...

我想知道，`.cont_title`当我一起使用所有 css 样式时，什么会阻止类？我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T22:33:21.547

在您的第二小提琴中，您的`.cont_title`班级上方有一组无效的字符。删除无效字符可以解决您看到的问题。

```
...
.row:hover .remove{
    opacity: 1;
}â€‹   <-- Some weird characters here

.cont_title {
    height: 40px;
    ... 
```

# java - 用 arrayList 词随机填充二维数组

> ID：10182615
> 
> 赞同：-1
> 
> 时间：2012-04-16T22:29:41.693
> 
> 标签：java, arraylist, multidimensional-array

我被困在我的 wordSearch 程序上。我正在尝试用`arrayList`用户输入的我的单词填充二维数组。有谁能够帮我？

```
import java.io.* ;
import java.util.ArrayList ;
public class WordSearchPuzzle
{
    private char[][] puzzle ;
    private ArrayList<String> puzzleWords ;
    private int letterCount = 0 ;
    private int gridDimensions;

    public WordSearchPuzzle(ArrayList<String> userSpecifiedWords)
    {
        this.puzzleWords = userSpecifiedWords ;

    }

    private void createPuzzleGrid()
    {
        int i;
        for(i = 0; i < puzzleWords.size() ; i++){
            letterCount = puzzleWords.size() + letterCount ;
        }
        gridDimensions = letterCount * 2;
        puzzle = new char[gridDimensions][gridDimensions] ;
    }

    public void fill() {

        int i, j, row, col;
        boolean added;

        for (i = 0; i < puzzleWords.size(); i++) {
            row = (int) (Math.random() * this.gridDimensions);
            col = (int) (Math.random() * this.gridDimensions);
            added = false;
            ??? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T10:33:10.967

类`Random`有[`nextInt(int n)`](http://docs.oracle.com/javase/6/docs/api/java/util/Random.html#nextInt%28int%29)方法，`List`接口有`size()`方法。

生成一个介于 0 和列表大小之间的随机索引，并从列表中获取结果索引处的单词。

# parallel-processing - 通过网络将文件夹复制到多个服务器的最快方法是什么（Python）

> ID：10182616
> 
> 赞同：1
> 
> 时间：2012-04-16T22:29:42.663
> 
> 标签：parallel-processing, multiprocessing, python-2.7

正如标题所说，我想要完成的是给定一个包（通常大小可能在 500Mb 和 1Gb 之间变化），我想同时复制大约 40 台服务器（同时），我一直在使用当时运行副本的脚本，因此我正在考虑以下可能性：

1-多进程库并为每个复制函数创建一个进程，以便它们可以同时运行；- 虽然我认为我最终可能会遇到 I/O 瓶颈，并且进程不能共享相同的数据。

2-我没有使用单一的互联网连接，而是使用一个巨大的公司广域网。

谁能告诉我是否有其他更有效的方法（更快）来实现同样的目标？或其他解决方法？（我可以从 2 核工作站运行此任务）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:38:14.477

1）我没有这方面的经验，但它看起来适合您的用例：

*   [http://code.google.com/p/pysendfile/](http://code.google.com/p/pysendfile/)

> sendfile(2) 是一个系统调用，它提供了一种将数据从一个文件描述符复制到另一个文件描述符（套接字）的“零复制”方式。短语“零复制”指的是两个描述符之间的所有数据复制完全由内核完成，没有将数据复制到用户空间缓冲区中。这在通过套接字（例如 FTP）发送文件时特别有用。

和

> **你想什么时候使用它？** 基本上任何通过网络发送文件的应用程序都可以利用 sendfile(2)。

2）另一种选择是使用[一些](https://stackoverflow.com/questions/3714501/python-torrent-library) [种子库](https://github.com/JosephSalisbury/python-bittorrent)。我最近[了解到](http://www.facebook.com/video/video.php?v=10100259101684977)（关于 torrent 的内容，跳到 31:00）facebook 通过 torrent 分发他们的日常软件更新（并在 15 分钟左右用 1.5GB 二进制文件更新了 1000 台服务器）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:27:46.010

假设您的机器有 1Gbit 连接。如果你幸运/工作，你将获得 800Mbit/s，复制每个 1GByte 需要大约 10 秒，更新这些机器需要 6-7 分钟。如果这足够好，您唯一需要做的就是有效地使用 1Gbit 来达到该目标（您从当前脚本中看到了什么？好吧 1Gbit 在 WAN 上可能是雄心勃勃的，但您可以进行类似的分析）。多处理在这里可能有帮助，也可能没有帮助……但它不会神奇地为您带来更多带宽。

如果还不够好，我会考虑：

*   去 P2P（见 miku;s answer），所以只要一台机器有一点数据，它就可以使用它自己的带宽与其他机器共享。这在某种程度上有多大帮助取决于您的网络拓扑（是否存在其他瓶颈点）。

*   查看多播，如果网络足够在您的控制之下，您可以适当地路由这些东西（这对于 WAN 来说似乎不太可能，但也许有一天在 IPv6 仙境中......）。无需将相同的数据复制 40 次（假设每次都相同），您只需广播一次，然后所有接收器同时接收它。多播 UDP 不可靠（我认为更多用于 IPTV），但已经[尝试使用多播](http://en.wikipedia.org/wiki/Pragmatic_General_Multicast)技术构建可靠的文件传输工具，例如[OpenPGM](http://code.google.com/p/openpgm/)和[MS 自己的实现](http://msdn.microsoft.com/en-us/library/ms740125.aspx)。

# javascript - 设置用双引号括起来的单词的 CSS

> ID：10182618
> 
> 赞同：1
> 
> 时间：2012-04-16T22:29:50.127
> 
> 标签：javascript, jquery, html, css, string

[这是我关于设置代码的 CSS（如果它包含保留字](https://stackoverflow.com/questions/9744630/set-css-of-code-if-it-contains-a-reserved-word)）的问题的后续问题。

**我正在尝试做的事情**：如果某些代码有引号或双引号，我想将字体的颜色设置为红色和粗体。前任。 `System.out.println( "Hello world" );` 应该将“Hello world”设置为红色。

**出了什么问题**：尽管我尽了最大努力，但我似乎无法让我的控制语句正常工作（至少我认为这是问题所在）。它将第一个双引号及以上设置为红色，但是当我告诉它在单词等于**anyword"**或**anyword'**时停止时，它将块中的其余代码设置为红色。

**HTML**

```
<html>
    <body>
        <code id="java">
            public static void main(String[] args)<br>
            {
            <pre>    int i = 120; </pre><br>
            <pre>    // Displays a message in the console </pre>
            <pre>    // This is a test </pre>
            <pre>    System.out.println( "Hello Big World!" );</pre>
            }
        </code>
    </body>
</html> 
```

* * *

**CSS**

```
.quotes
{
    font-weight: bold;
    color: #E01B1B;
} 
```

* * *

**jQuery**

```
$(document).ready(function() {
    var code  = $("#java").html(); // Get the code
    var split = code.split(' ');   // Split up each element
    var chkQ  = 0;                 // Check for quotes
    var chkC  = 0;                 // Check until end of comment line

    // Set the CSS of reserved words, digits, strings, and comments
    for (var j = 0; j < split.length; j++) {
        // Check to see if chkQ is set to true
        if (chkQ == 1) {
            // If the element matches (anyword") or (anyword'), then set
            // flag to false and continue checking the rest of the code.
            // Else, continue setting the CSS to .quotes
            if (split[j].match(/."/) || split[j].match(/.'/)) {
                split[j] = '<span class="quotes">' + split[j] + '</span>';
                chkQ = 0;
            } else {
                split[j] = '<span class="quotes">' + split[j] + '</span>';
            }
        }
        ...
        } else if (chkQ == 0 && chkC == 0) {
            ...
            // If the element matches a ("anyword) or ('anyword)...
            } else if (split[j].match(/"./) || split[j].match(/'./)) {
                split[j] = '<span class="quotes">' + split[j] + '</span>';
                chkQ = 1;
            } ...
        }
    }
    // Join all the split up elements back together!
    $("#java").html(split.join(' '));
}); 
```

* * *

**问题**：这只是我的正则表达式、控制块或完全不同的东西的问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T23:33:52.970

当您可以执行简单的全局正则表达式查找和替换时，为什么要拆分字符串：

```
<script type="text/javascript">
$(document).ready(function(){
//cache the element
   el = $('#java');
//get the HTML contained within the cached element
   code = el.html();
//return the code having executed the replace method, regex explained:
/*    
([^\w]{1}) -> look for a single character that is not an alpha character
(["']) -> then look for either a single quote or double quote
(.*?) -> then look any character, but don't be greedy
(\2) -> then look for what was found in the second group - " or '
([^\w]{1}) -> and finally look for a single character that is not an alpha character
*/
    code = code.replace(/([^\w]{1})(["'])(.*?)(\2)([^\w]{1})/gm,
//execute an anonymous callback, passing in the result for every match found
    function(match, $1, $2, $3, $4, $5, offset, original) {
//construct the replacement
        str =  $1 + '<span class="quotes">' + $2 + $3 + $4 + '</span>' + $5; 
//return the replacement
        return str; 
    });
//replace the existing HTML within the cached element
   el.html(code);
});
</script> 
```

编辑：刚刚更新它以适应嵌套引号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T00:09:21.470

我不知道您的所有要求，但您的单引号似乎有点复杂。

我已经建立了[**一个有效的演示**](http://jsfiddle.net/f7wBd/17/)（更新链接以包含嵌套引号）。

我不保证它没有错误。它分两个阶段进行替换，首先是双引号，然后是单引号，试图清除潜在的撇号（请注意，在下面的代码中，撇号的过滤器基于常见的后续字母 - 不确定您实际上可能需要多少个，如果有）。

**Javascript**

```
$(document).ready(function() {
    var code  = $("#java").html(); // Get the code
    var split = code.split('\"');  // Split up each element at the "

    // Set the CSS of reserved words, digits, strings, and comments
    for (var j = 0; j < split.length - 1; j++) {
        if (j%2 == 0) { //if first, add beginning
            split[j] = split[j] + '<span class="quotes">"';
        } else {//if second, add ending
            split[j] = split[j] + '"</span>';
        }
    }
    // Join all the split up elements back together!
    $("#java").html(split.join(""));

    code  = $("#java").html(); // Get the code
    split = code.split('\'');  // Split up each element at the '
    var openQ = 1;
    var sub1;
    var sub2;

    for (var j = 0; j < split.length - 1; j++) {
        sub1 = split[j+1].substr(0,2); //checking for a contraction of 's
        sub2 = split[j+1].substr(0,3); //checking for a contraction of 'll
        if(sub1 != "s " && sub2 != "ll ") {
          if (openQ) { //if first, add beginning
            split[j] = split[j] + '<span class="quotes">\'';
            openQ = 0;
          } else {//if second, add ending
            split[j] = split[j] + '\'</span>';
            openQ = 1;
          }
        }
        else {//add apostrophe back
            split[j] = split[j] + '\'';
        }
    }
    $("#java").html(split.join(""));
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-04T21:49:46.410

这是一个纯 JavaScript 版本：
`id`= 带引号的元素的 id
`classid`= 添加到引号的类

```
function quotes(id,classid) {
    var code  = document.getElementById(id).innerHTML; 
    var split = code.split('\"'); 
    for (var j = 0; j < split.length - 1; j++) {
        if (j%2 == 0) { 
            split[j] = split[j] + '<span class='+classid+'>"';
        } else {
            split[j] = split[j] + '"</span>';
        }
    }
    document.getElementById(id).innerHTML = split.join("");
    code  = document.getElementById(id).innerHTML;
    split = code.split('\'');
    var openQ = 1;
    var sub1;
    var sub2;
    for (var j = 0; j < split.length - 1; j++) {
        sub1 = split[j+1].substr(0,2);
        sub2 = split[j+1].substr(0,3);
        if(sub1 != "s " && sub2 != "ll ") {
          if (openQ) {
            split[j] = split[j] + '<span class='+classid+'>\'';
            openQ = 0;
          } else {
            split[j] = split[j] + '\'</span>';
            openQ = 1;
          }
        }
        else {
            split[j] = split[j] + '\'';
        }
    }
    document.getElementById(id).innerHTML = split.join("");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-08T18:34:39.577

```
String.prototype.Text2Html = function (){
  var div = document.createElement('div');
  div.appendChild(document.createTextNode(this))
  encoded=div.innerHTML;
  div.remove();
  return encoded
}

String.prototype.colorTheQuotes = function(){

  var re     = /(?:<span style=|)(?:(?:"[^"]*")|(?:'[^']*'))/gm,
      text   = this.Text2Html(),
      output = text,
      tour   = 0,
      slen   = 27;

    while ((match = re.exec(text)) != null) {
      if(match[0].startsWith("<span")) continue
      output=output.slice(0,match.index+tour*slen)+'<span class="quote">'+output.slice(match.index+tour*slen,match.index+match[0].length+tour*slen)+"</span>"+output.slice(match.index+match[0].length+tour*slen);tour++
    }
  return output
}

element=document.getElementById("color")
document.addEventListener("readystatechange",(e)=>{
  element.innerHTML=element.innerText.colorTheQuotes();
 })
```

```
.quote{
  color: red;
}
```

```
<span>System.out.println( "Hello world" );</span><br>
<span id="color">System.out.println( "Hello world" );</span>
```

# c# - 如何从需要 id 列表的 MVC 调用存储过程

> ID：10182622
> 
> 赞同：0
> 
> 时间：2012-04-16T22:30:03.407
> 
> 标签：c#, asp.net-mvc, stored-procedures

我的上一个问题得到了很好的答案，但实际上更复杂：

我需要向这个存储过程传递一个整数列表：

```
ALTER proc [dbo].[Invoice_GetHomePageInvoices] (
      @AreaIdList varchar(max)
,      @FinancialYearStartDate datetime = null
,      @FinancialYearEndDate datetime = null 
```

这是我到目前为止所拥有的：

```
public virtual IEnumerable<HomePageInvoice> GetHomePageInvoices(IList<Area> areas, FinancialYearLookup financialYear)
{
    var areaIds = areas.Select(x => x.Id).ToList();

    //return _db.Database.SqlQuery<HomePageInvoice>(string.Format("EXEC Invoice_GetHomePageInvoices @AreaIdList = '{0}', @FinancialYearStartDate = '{1}', @FinancialYearEndDate = '{2}'", areas.ToString(), financialYear.StartDate.ToString(), financialYear.EndDate.ToString()));

    var startDate = new SqlParameter("FinancialYearStartDate", financialYear.StartDate);
    var endDate = new SqlParameter("FinancialYearEndDate", financialYear.EndDate);

    return _db.Database.SqlQuery<HomePageInvoice>("Invoice_GetHomePageInvoices", startDate, endDate);
} 
```

因此对日期时间参数进行了排序。`List<int>`但是，鉴于我当前有一个和 sql 期望，你将如何将 ids 发送到存储过程`@AreaIdList varchar(max)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:32:24.040

字符串。加入？

```
String.Join(",", areaIds) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T22:53:37.910

表值参数，你真的应该阅读下面的帖子。他在解释这一切应该如何运作方面做得非常出色

[http://www.sommarskog.se/arrays-in-sql-2008.html](http://www.sommarskog.se/arrays-in-sql-2008.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T22:35:20.527

将您转换`List<int>`为逗号分隔的字符串，并将其传递给您的存储过程。

[将通用列表转换为 CSV 字符串](https://stackoverflow.com/questions/1890093/converting-a-generic-list-to-a-csv-string)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T22:38:32.293

我真的取决于你对那个列表做了什么。但是，如果您将它用于`IN`子句或类似的东西，那么我将在 C# 中构建它并将其传递给 proc：

```
StringBuilder s = new StringBuilder();
foreach (var i in areaIds)
{
    s.Append(String.Format("'{0}',", i));
}
s.TrimEnd(',');
var areas = new SqlParameter("AreaIdList", s.ToString()); 
```

然后在proc中你可以像这样使用它：

```
WHERE area IN @AreaIdList 
```

# java - 是否有在 Spring 上下文 XML 文件中创建字符串常量的简写？

> ID：10182625
> 
> 赞同：36
> 
> 时间：2012-04-16T22:30:27.787
> 
> 标签：java, spring

我需要在多个 bean 共享的 Spring 上下文 XML 文件中定义一个字符串值。

我就是这样做的：

```
<bean id="aSharedProperty" class="java.lang.String">
    <constructor-arg type="java.lang.String" value="All beans need me :)"/>
</bean> 
```

通过传递 java.lang.String 的构造函数参数来创建 java.lang.String bean 似乎很笨拙。

有捷径吗？

我知道可以使用 PropertyOverrideConfigurer 传递此属性，但我想将此属性保留在 XML 文件中。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-17T07:57:37.213

您可以`PropertyPlaceholderConfigurer`在 xml 中使用和保留值：

```
<context:property-placeholder properties-ref="myProperties"/>

<bean id="myProperties" 
    class="org.springframework.beans.factory.config.PropertiesFactoryBean">
  <property name="properties">
    <props>
      <prop key="aSharedProperty">All beans need me :)</prop>
    </props>
  </property>
</bean> 
```

然后你引用它：

```
<bean id="myBean" class="my.package.MyClass">
  <property name="someField" value="${aSharedProperty}"/>
</bean> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-04T14:48:37.977

mrembisz 提出的解决方案的简写如下：

```
<context:property-placeholder properties-ref="myProperties"/>

<util:properties id="myProperties">
    <prop key="aSharedProperty">All beans need me :)</prop>
</util:properties> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-26T10:58:28.263

我过去使用的是 SpEL 来确保一个 bean 与另一个具有相同的值：

```
<bean id="myBean" class="xxx.yyy.Foo" >
    <property name="myProperty" value="1729" />
</bean>

<bean id="copyCat" class="xxx.yyy.Bar" >
    <property name="anotherProperty" value="#{myBean.myProperty}" />
</bean> 
```

我发现这在设置值不是简单赋值时特别有用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-16T23:47:59.190

您也许可以使用以下内容：

```
<bean id="abstractParent" abstract="true">
    <property name="sharedProperty" value="All child beans need me" />
</bean>

<bean id="bean1" class="MyClass1" parent="abstractParent">
    ...non-shared properties...
</bean>

<bean id="bean2" class="MyClass2" parent="abstractParent">
    ...non-shared properties...
</bean> 
```

但是，这取决于具有相同名称的属性，因此可能不适用于您。

# xcode - 在滚动视图 xcode 中崩溃加载图像

> ID：10182627
> 
> 赞同：1
> 
> 时间：2012-04-16T22:30:49.683
> 
> 标签：xcode, crash, imageview, scrollview

我正在制作一个简单的照片库，在滚动视图中放置大约 60 张 1024x768 的图像会导致我的执行速度非常慢甚至应用程序崩溃，我做错了什么？

```
-(void)sethomeview:(UIScrollView *)selscroll numimg:(int)numimg section:(NSString *)section
{   selscroll.delegate = self;
    selscroll.contentSize = CGSizeMake(160*numimg,80);
    sezione=section;

  for (int i=1; i<numimg+1; i++)
  {
      NSString *fullpath = [[[NSBundle mainBundle] bundlePath] stringByAppendingString:[NSString stringWithFormat:@"/%@%d.jpg",sezione,i]];        
      UIButton *button = [[UIButton alloc] initWithFrame:CGRectMake((i-1)*165,0, 160, 80)];
      [button setImage:[UIImage imageWithContentsOfFile:fullpath] forState:UIControlStateNormal ];
      [button setTitle:sezione forState:UIControlStateNormal];
      [button addTarget:self action:@selector(homepremuta:) forControlEvents:UIControlEventTouchDown];
      button.tag =i;
      [selscroll addSubview:button];

  }
} 
```

# python - 使用 groupdict 将字符串解析为 dict

> ID：10182628
> 
> 赞同：2
> 
> 时间：2012-04-16T22:30:56.233
> 
> 标签：python, regex

我需要处理文本以创建字典`{name: quantity}`

文本变体：

```
2 Cardname
3 Cardname Two
1 Cardname Three

Cardname
Cardname Two
Cardname Three 
```

所以我写了一个基本的代码：

```
card_list = card_area.splitlines()
card_dict = {}

for card in card_list:
    qty_re = re.search('^\d{1,6}', card)
        if qty_re:
            qty = qty_re.group()
        else:
            qty = 1

     name_re = re.search('[A-Za-z ]+$', card)
        if name_re:
            name = name_re.group()
        else:
            name = None

     if name:
         card_dict[name] = qty 
```

第一个问题：如果字符串的某些元素不存在（没有数量或空字符串），我可以使用[groupdict 方法吗？](http://docs.python.org/library/re.html#re.MatchObject.groupdict)

第二：我也想考虑这样的格式：

```
2 x Cardname
3x Cardname Two
1 xCardname Three
1xCardname Four 
```

什么是最好的方法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:49:18.263

您可以使用单个正则表达式执行此操作：

```
import re

regex = re.compile(r'(\d*)([A-Za-z ]+)$')
card_list = ["2 Cardname", "3 Cardname Two", "Cardname Three"]
card_dict = {}

for quantity, name in (regex.match(card).groups() for card in card_list):
    if not quantity:
        quantity = 1
    card_dict[name.strip()] = int(quantity)

print(card_dict) 
```

给我们：

```
{'Cardname Two': 3, 'Cardname Three': 1, 'Cardname': 2} 
```

你不能用`groupdict()`它来实现你想要的，因为它返回一个`subgroup_name: match`not的字典`match: match`。相反，我们进行匹配，然后获取组，这为我们提供了一个包含匹配项的元组。

用额外`x`的 in 支持符号非常容易，我们只需将其添加到正则表达式中：

```
regex = re.compile(r'(\d*)x?([A-Za-z ]+)$') 
```

通过匹配`x?`，如果 x 存在，我们匹配它，如果不存在则不匹配。这里唯一的潜在问题是您的卡名是否以 x 开头。

请注意，如果您可以假设该数字将始终存在，则可以将其作为单行符执行：

```
{name.strip(): quantity for quantity, name in (regex.match(card).groups() for card in card_list)} 
```

尽管我认为这是在推动可读性的界限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T23:35:34.163

一个办法。要遵循的注意事项。

```
from collections import defaultdict
import re

# card_list = card_area.splitlines()
card_list = [
    "2 Cardname", "3 Cardname Two", "1 Cardname Three",
    "Cardname", "Cardname Two", "Cardname Three",
    "1x Cardname", "4X Cardname Two", "2 X Cardname Three",
]

card_dict = defaultdict(int)

pat = re.compile(r'(\d*)\s*(?:[xX]\s+)?(\S.*)')

for card in card_list:
    m = re.search(pat, card)
    if not m:
        continue
    if m.group(1):
        qty = int(m.group(1))
    else:
        qty = 1

    name = m.group(2)
    card_dict[name] += qty

if not card_dict:
    print("empty card_dict!")
else:
    for name in sorted(card_dict):
        print("%20s|%4d" % (name, card_dict[name])) 
```

笔记：

*   为了速度，我建议预编译正则表达式模式。

*   处理这个问题的最好方法是一个单一的正则表达式模式，它同时获取计数和卡片。我添加了一个可选模式，它可以识别带有可选“x”的卡片格式；使用一个字符类，我使它匹配大写或小写的“x”。数字和“x”之间的空格是可选的，但“x”和卡名之间必须有空格，否则“x”将被视为卡名的一部分。

*   如果你不熟悉正则表达式，这里是如何阅读这个：形成一个匹配零个或多个数字的匹配组。后跟零个或多个空白字符。这后面是另一个组，但是这个后面的组被标记，`(?:`而不是仅仅`(`因此它是一个组，但不会在输出中匹配组；该组是匹配“x”或“X”后跟一个或多个空白字符的字符类。形成另一个匹配组，它以一个非空白字符开头，后跟零个或多个任意字符。

*   我相信你想总结所有同名卡？最好的方法是`defaultdict()`像我在这里展示的那样使用。

*   如果没有合法的卡名以“x”或“X”开头，您可以更改模式以不保留“x”，即使它和卡名之间没有空格。为此，将模式更改为匹配 'x' 从 this:`(?:[xX]\s+)?` 到 this: （请注意，在之后`(?:[xX]\s*)?` 单个`+`更改为单个，因此现在将接受零个空白字符。）`*``\s`

# xpages - 如何在应用程序布局控件中保持标题栏选项卡处于活动状态？

> ID：10182630
> 
> 赞同：1
> 
> 时间：2012-04-16T22:30:58.590
> 
> 标签：xpages, xpages-extlib

我有一个使用应用程序布局控件的应用程序。UI 在标题栏部分定义了两个选项卡。UI 的侧边栏中还包含一个 Navigator 控件，允许用户选择链接以打开其他页面。我遇到的麻烦是当用户单击当前导航器中的链接时，将当前选项卡设置为活动选项卡。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T02:11:14.950

应用程序布局控件的“配置”属性是一个复杂类型，它反过来支持定义布局本身的所有属性。这些属性之一是“navigationPath”。如果 Netflix 在其网站上使用此控件，则在查看捉鬼敢死队的电影信息页面时该属性的值可能类似于：

```
/home/genres/comedies/541018 
```

因此，可以将此属性视为使用 *nix 文件路径语法在“站点地图”中描述页面当前位置的一种方式。

每个titleBarTab也是一个复杂类型；它的属性之一是“选择”。此属性旨在被赋予一个与整体布局的当前导航路径的部分或全部匹配的值。因此，继续 Netflix 示例，您可以像这样定义标签：

```
<xe:this.titleBarTabs>
    <xe:pageTreeNode
        page="/genre.xsp"
        label="Action"
        queryString="genre=action"
        selection="/home/genres/action/*" />
    <xe:pageTreeNode
        page="/genre.xsp"
        label="Comedy"
        queryString="genre=comedies"
        selection="/home/genres/comedies/*" />
    <xe:pageTreeNode
        page="/genre.xsp"
        label="Drama"
        queryString="genre=dramas"
        selection="/home/genres/dramas/*" />
</xe:this.titleBarTabs> 
```

然后，在 Ghostbusters 的页面上，因为布局的 navigationPath 属性与为 pageTreeNode 的 selection 属性定义的模式匹配，标签为“Comedy”，所以该选项卡将显示为已选中，但其他选项卡不会。

另外可能值得注意的是布局配置还包括一个名为“defaultNavigationPath”的属性。如果 navigationPath 属性没有值，则此属性的值将与每个 titleBarTab 的 selection 属性进行比较。因此，您通常希望将其设置为会导致第一个选项卡显示为选中的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:07:29.537

布鲁斯，如果我没看错的话，不久前我遇到了类似的问题。这有帮助吗？[为 TitleBar 选项卡设置 sessionScope 变量](https://stackoverflow.com/questions/9293852/titlebar-tabs-in-applicationlayout-control-extlib-generating-invalid-code)

# php - 在 PHP / MySQL 中将值组合在一起，并将其中一列的值添加到组中

> ID：10182635
> 
> 赞同：1
> 
> 时间：2012-04-16T22:31:38.397
> 
> 标签：php, mysql

我有一个如下所示的 MySQL 数据库：

```
Name: Joe
Items: 25
CreationDate: 2012-04-14 18:49:50

Name: John
Items: 89
CreationDate: 2012-04-14 18:47:17

Name: Bill
Items: 95
CreationDate: 2012-04-09 12:34:08

Name: Bob
Items: 35
CreationDate: 2012-04-09 12:18:23 
```

我想要做的是按 CreationDate 对行进行分组（仅基于一天，最后的时间不应该是一个因素）。然后将这些项目加在一起得出一个项目/天。

所以我希望输出是这样的：

```
2012-04-09 - 130 items
2012-04-14 - 114 items 
```

我已经在 MySQL 中尝试过 Group By，但我不确定我是否正确使用它：

```
$sql = mysql_query("SELECT SUM(Items), CreationDate FROM People GROUP BY CreationDate ORDER BY CreationDate DESC") or die(mysql_error());
while($row = mysql_fetch_array($sql) ) {
    echo '<p>' . $row['CreationDate'] . ' - ' . $row['SUM(Items)'] . '</p>';
} 
```

那种作品除了它只在完全匹配的创建日期（下到第二个）上对它们进行分组，我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T22:33:25.993

您需要对 CreationDate 字段使用日期函数，例如：

```
SELECT SUM(Items), DATE(CreationDate) FROM People GROUP BY DATE(CreationDate) ORDER BY CreationDate DESC 
```

但是有一个警告：使用 DATE 函数将忽略 CreationDate 上的任何索引。如果 CreationDate-field 被索引，使用 DATE-function 并对其进行分组将花费更长的时间。

# gtk - GTK 中一项操作的多个快捷方式

> ID：10182643
> 
> 赞同：8
> 
> 时间：2012-04-16T22:32:42.547
> 
> 标签：gtk, action, shortcut, vala

在 GTK+ 3 中将多个键盘快捷键绑定到一个操作的最佳方法是什么？

这几天我一直在寻找这个问题的答案，但一无所获。该函数[`gtk_accelerator_parse`](http://developer.gnome.org/gtk3/stable/gtk3-Keyboard-Accelerators.html#gtk-accelerator-parse)不支持逗号分隔的快捷方式。将多个`<accelerator>`标签放在`.ui`具有相同`action`属性和不同`key`属性的文件中也不起作用。

我不想编写一个自定义按键处理程序，这样我就可以为一个操作有两个快捷方式，但这真的是唯一的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2020-12-26T12:30:31.407

自 GTK 版本 3.12（于 2014-03-25 发布）以来，有一种称为新方法的方法[`gtk_application_set_accels_for_action()`](https://developer.gnome.org/gtk3/stable/GtkApplication.html#gtk-application-set-accels-for-action)应该会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T23:15:09.157

我找到了一种方法，但它真的很可怕。使用[`gtk_accel_group_connect`](http://developer.gnome.org/gtk3/stable/gtk3-Keyboard-Accelerators.html#gtk-accel-group-connect)我可以为我自己的功能添加额外的加速器，然后可以根据按下的键和任何修饰符触发所需的操作。然而，这感觉就像是一个 hack，因为我基本上是在创建自己的加速器到动作地图，而不是使用 GTK。

**如果有人知道，我想知道一种更好的方法。**

# javascript - $(document).ready 的不同用途

> ID：10182650
> 
> 赞同：-1
> 
> 时间：2012-04-16T22:33:17.677
> 
> 标签：javascript, jquery

将 $(docu...) 与内部定义的变量和函数一起使用，将其与函数一起使用，然后在 $(docu...) 中调用它，有什么区别/优势？

```
$(document).ready(function (){
    initialize();
});
function initialize(){
    hello
} 
```

过度使用这个：

```
$(document).ready(function (){
        hello
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T22:49:02.263

这四个选项都会产生完全相同的结果，但灵活性会降低：

## 示例 #1

```
$(document).ready(function (){
    initialize();
});

function initialize(){
    hello();
} 
```

## 示例 #2

```
$(document).ready(initialize);

function initialize(){
    hello();
} 
```

## 示例#3

```
$(document).ready(function (){
        hello();
}); 
```

## 示例 #4

```
$(document).ready(hello); 
```

在第一个示例中，您正在创建一个匿名函数，该函数将在 document.ready 时调用。该匿名函数调用一个单独的函数`initialize()`。因为`initialize()`是一个单独的函数，它也可以被其他代码调用。

在第二个示例中，您只是避免使用匿名函数并`initialize`直接传递对该函数的引用。`initialize()`这比第一个示例稍微快一点（少一个函数调用），但如果您想从处理程序调用多个函数，则灵活性较差`document.ready()`。

在第三个示例中，您只需删除外部`initialize()`函数并调用它内部的一件事，它正在从匿名函数中执行。

在第四个示例中，匿名函数再次被删除，您只需传递对该`hello`函数的直接引用，因此它将被直接调用而没有任何干预函数。

第一个选项为您提供了最大的灵活性，因为您可以在其中调用多个事物，`initialize()`也可以`initialize()`从程序中的其他位置调用。如果您不需要这些灵活性，您可以选择其他四个选项中的任何一个，因为它们都产生相同的结果，每个选项的灵活性都稍差一些。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-16T22:35:35.790

在您的第一个示例中，您可以`initialize`稍后再次使用该功能。如果将`hello`代码直接放在`$(document).ready()`'s 函数中，则以后无法再次引用该代码。

# ios - 附加调试器时iOS看门狗是否监视进程？

> ID：10182655
> 
> 赞同：0
> 
> 时间：2012-04-16T22:33:31.117
> 
> 标签：ios, networking

我正在调试一个后台任务问题，当在后台过于频繁地接收到套接字数据时，我的应用程序被看门狗杀死。

看门狗是否在调试器的上下文中执行它的操作？

我的回答是：我不相信。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:28:15.960

根据我看到的一些关于应用程序在调试器中暂停时未能响应 10 秒的日志，我会说是的，它正在监视，但它不强制执行其规则。它只是通知您。

# ruby-on-rails - 无法安装 gem rmagick [Windows 7 64 位]

> ID：10182656
> 
> 赞同：0
> 
> 时间：2012-04-16T22:33:39.687
> 
> 标签：ruby-on-rails, carrierwave, rmagick

我正在使用carrierwave 将图像上传到我的项目，并[在此处](http://railscasts.com/episodes/253-carrierwave-file-uploads)与 Ryan Bates railscasts 一起使用。

我正在使用 ruby​​ 1.9.2p290 (2011-07-09) [i386-mingw32] 和 rails 3.1.0

在这一集中它说为了使用 rmagick 你必须像这样将它安装在你的 gemfile 中

宝石文件

```
gem 'rmagick' 
```

然后运行 ​​bundle install 我得到错误

```
Installing rmagick (2.13.1) with native extensions C:/Ruby192/lib/ruby/site_ruby/1.9.1/rubygems/installer.rb:533:in `rescue in block in build_extensions': ERROR
: Failed to build gem native extension. (Gem::Installer::ExtensionBuildError)

    C:/Ruby192/bin/ruby.exe extconf.rb
checking for Ruby version >= 1.8.5... yes
Invalid drive specification.
Unable to get ImageMagick version
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --without-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=C:/Ruby192/bin/ruby 
```

所以我用谷歌搜索了 Unable to get ImageMagick version 并在[这里](http://rmagick.rubyforge.org/install-faq.html#win)找到了这个链接并按照说明下载了 RMagick-2.13.1.tar.gz，解压到 c:\rmagick，然后运行

```
ruby setup.rb command 
```

并得到以下错误。

```
c:\RMagick-2.13.1>ruby setup.rb
---> lib
---> lib/rvg
<--- lib/rvg
<--- lib
---> ext
---> ext/RMagick
C:/Ruby192/bin/ruby.exe c:/RMagick-2.13.1/ext/RMagick/extconf.rb
checking for Ruby version >= 1.8.5... yes
Invalid drive specification.
Unable to get ImageMagick version
*** c:/RMagick-2.13.1/ext/RMagick/extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options. 
```

再次出现错误无法获取 ImageMagick 版本。我认为 Imagemagick 与 Windows 安装捆绑在一起。有人对此事有任何帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T14:07:55.877

CarrierWave 确实是在 Rails 中管理图像上传的绝佳解决方案。RMagick 功能非常强大，但你不会相信我和我的朋友多年来在各种环境和操作系统（尤其是 Windows 和 Mac）中安装和升级 RMagick 和 ImageMagick 时遇到了多大的麻烦。

如果您安装了 ImageMagick，并且您不太担心性能，您可以使用[MiniMagick](https://github.com/probablycorey/mini_magick)代替 RMagick。安装它要容易得多。在您的上传器类中，您可以包含 MiniMagick：

```
class MyUploader < CarrierWave::Uploader::Base  
  include CarrierWave::MiniMagick

  ...
end 
```

图像处理工具的这种复杂性是我建议您查看我们的集成 CarrierWave 的解决方案的原因之一，而所有图像转换都在云中完成（根本不需要安装 RMagick 或 ImageMagick）。[这篇博](http://cloudinary.com/blog/ruby_on_rails_image_uploads_with_carrierwave_and_cloudinary)文描述了解决方案。只需切换您包含的 CarrierWave 插件：

```
class MyUploader < CarrierWave::Uploader::Base  
  include Cloudinary::CarrierWave

  ...
end 
```

# android - 有什么方法可以防止 android/ios 上的非法位置？

> ID：10182657
> 
> 赞同：2
> 
> 时间：2012-04-16T22:33:42.923
> 
> 标签：android, security, gps, location

我正在考虑为 android 或 ios 开发一个应用程序，但该应用程序的全部目的是基于位置的游戏，例如foursquare。问题是如果人们可以用假的位置来欺骗他们的位置，那么游戏将是非常不公平的，我想知道是否有任何方法可以确保他们给我的位置是他们实际所在的位置。

这是否有可能，或者我只需要相信用户他们正在使用他们真正的 gps 位置，而不是被黑客入侵的软件来改变它？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-29T00:44:07.150

没有适用于 iOS 和 Android 的通用代码/API 解决方案。

让这变得困难的一件事是，即使设备 API 保证了准确的位置，Android 设备也可以“root”，iOS 设备可以“越狱”，从而允许最终用户修改 API 实现。

# python - 在 Python 中检查骆驼大小写

> ID：10182664
> 
> 赞同：7
> 
> 时间：2012-04-16T22:34:37.170
> 
> 标签：python, regex, camelcasing

我想检查一个字符串是否是驼峰式大小写（布尔值）。我倾向于使用正则表达式，但任何其他优雅的解决方案都可以。我写了一个简单的正则表达式

```
(?:[A-Z])(?:[a-z])+(?:[A-Z])(?:[a-z])+ 
```

这是正确的吗？还是我错过了什么？

**编辑**

我想在格式的文本文档集合中捕获名称

```
McDowell
O'Connor
T.Kasting 
```

**编辑2**

我已经根据评论中的建议修改了我的正则表达式

```
(?:[A-Z])(?:\S?)+(?:[A-Z])(?:[a-z])+ 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-16T23:00:53.163

您可以检查字符串是否同时具有大写和小写字母。

```
def is_camel_case(s):
    return s != s.lower() and s != s.upper() and "_" not in s

tests = [
    "camel",
    "camelCase",
    "CamelCase",
    "CAMELCASE",
    "camelcase",
    "Camelcase",
    "Case",
    "camel_case",
]

for test in tests:
    print(test, is_camel_case(test)) 
```

输出：

```
camel False
camelCase True
CamelCase True
CAMELCASE False
camelcase False
Camelcase True
Case True
camel_case False 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-16T22:39:44.320

您可能想要更多类似的东西：

```
(?:[A-Z][a-z]*)+ 
```

尽管如此，这将允许所有大写字母。您可以通过以下方式避免这种情况：

```
(?:[A-Z][a-z]+)+ 
```

如果需要，使用`^`and `$`or锚定表达式。`\z`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-09-13T14:18:52.983

使用类似的库将您的字符串转换为驼峰式大小写[`inflection`](https://inflection.readthedocs.io/en/latest/#inflection.camelize)。如果它没有改变，它一定已经是骆驼案了。

```
from inflection import camelize

def is_camel_case(s):
    # return True for both 'CamelCase' and 'camelCase'
    return camelize(s) == s or camelize(s, False) == s 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T23:02:48.050

我认为您可能只需检查字符串前面是否有大写字母和小写字母 if(line =~ m/[az][AZ]/)。在给定的示例中，仅检查 lower 和 upper 失败。〜本

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-25T18:12:47.287

这个正则表达式解决方案适用于我的用例`([A-Z][a-z\S]+)([A-Z][a-z]+)`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-07T14:58:53.970

如果您不希望以大写开头的字符串 eg`Case`和`Camelcase`传递`True`. 编辑@william 的回答：

```
def is_camel_case(s):
  if s != s.lower() and s != s.upper() and "_" not in s and sum(i.isupper() for i in s[1:-1]) == 1:
      return True
  return False

tests = [
"camel",
"camelCase",
"CamelCase",
"CAMELCASE",
"camelcase",
"Camelcase",
"Case",
"camel_case",
]

for test in tests:
   print(test, is_camel_case(test)) 
```

结果：

```
camel False
camelCase True
CamelCase True
CAMELCASE False
camelcase False
Camelcase False
Case False
camel_case False 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-30T06:20:36.520

```
sub_string= 'hiSantyWhereAreYou'  `Change the string here and try`
index=[x for x,y in enumerate(list(sub_string)) if(y.isupper())] `Finding the index 
of caps`
camel_=[]
temp=0
for m in index:
    camel_.append(sub_string[temp:m])
    temp=m
if(len(index)>0):
    camel_.append(sub_string[index[-1]::])
    print('The individual camel case words are', camel_) `Output is in list`
else:
    camel_.append(sub_string)
    print('The given string is not camel Case') 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-26T19:33:56.930

[**骆驼香烟盒**](https://en.wikipedia.org/wiki/Camel_case)

> 是不带空格或标点符号的短语的做法， 表示用***单个*****大写字母****分隔单词**

 *```
def iscamelcase(string):
    non_alpha = [i for i in string if not i.isalpha()]
    substrings= string.translate({ord(i): ' ' for i in non_alpha}).split(' ')
    for string in substrings:
        if not all(char.isupper() for char in string):
            for idx,i in enumerate(string):
                if i.isupper() and idx > 0:
                    return True
    return False 
```

1.  在字符串中搜索除字符以外的其他符号并存储在 `non_alpha`
2.  *用空格替换*所有 non_alpha 符号并将它们按空格分割以创建`substrings`
3.  检查所有子字符串是否不完全大写，如果不是，大写的索引不能> 0

**输出**

```
camel False
camelCase True
CamelCase True
CAMELCASE False
camelcase False
Camelcase False
Case False
camel_case False 
```*

# jquery - 使用 .load 方法提交多阶段表单

> ID：10182667
> 
> 赞同：0
> 
> 时间：2012-04-16T22:35:02.227
> 
> 标签：jquery

我一直在[http://jsfiddle.net/xSkgH/89/](http://jsfiddle.net/xSkgH/89/)上查看这个多阶段表单，只是想知道使用 .load 方法提交表单的最佳方式。

到目前为止我一直在尝试这个：

```
<script type="text/javascript">
$(document).ready(function() {
$("#last-step").hide(300).show(300).$load("resources/process.php", 
$("#task5_booking").serialize());
}
</script> 
```

但这似乎不起作用。有什么提示吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:37:05.757

您的代码几乎没有错别字。

*   $.post 与之前的语句链接
*   以错误的方式发送带有序列化数据的发布请求。

像这样更新您的代码

```
$("#last-step").hide(300).show(300);
$.post(
   "resources/process.php",
   { data: $("#task5_booking").serialize() }
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T06:17:09.953

如果您想通过 发送 POST `load()`，请使用`serializeArray()`而不是`serialize()`.

`serialize()`返回一个字符串，而 serializeArray 返回一个对象。 `load()`如果数据是对象，则发送 POST 请求。如果数据是字符串，则`load()`发送 GET。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T23:05:24.147

```
$(function(){
 $("#last-step").hide(300,function(){
    $.post("resources/process.php", { data : $("#task5_booking").serialize()} ,function(result){
        $("#last-step").html(result).fadeIn(500);
   });
 });
}); 
```

这将最初隐藏最后一步的 div，然后提交 jQuery 帖子，一旦它得到结果，它将结果设置到该 div 并应用`fadeIn`效果。

# c# - 编译 protobuf-net 生成的代码时出错

> ID：10182668
> 
> 赞同：2
> 
> 时间：2012-04-16T22:35:04.157
> 
> 标签：c#, protocol-buffers, protobuf-net

在 protobuf-net 生成的代码中有有趣的错误。.proto 定义文件包含对象的名为“值”的字段。使用 -p:detectMissing 选项为该值生成的 protogen.exe：

```
 private int? _value;
    [global::ProtoBuf.ProtoMember(50, IsRequired = false, Name=@"value", DataFormat = global::ProtoBuf.DataFormat.TwosComplement)]
    [global::System.Xml.Serialization.XmlElement(@"value", Order = 50)]

    public int value
    {
        get { return _value ?? default(int); }
        set { _value = value; }
    }

    [global::System.Xml.Serialization.XmlIgnore]
    [global::System.ComponentModel.Browsable(false)]
    public bool valueSpecified
    {
      get { return _value != null; }
        set { if (value == (_value == null)) _value = value ? value : (int?)null; }
    }
    private bool ShouldSerializevalue() { return valueSpecified; }
    private void Resetvalue() { valueSpecified = false; } 
```

编译器产生一个错误，认为**value**是关键字而不是类属性：

> 无法确定条件表达式的类型，因为 'bool' 和 'int?' 之间没有隐式转换？

解决方法手动更改生成的代码：

```
public int valueWorkaround
{
    get { return _value ?? default(int); }
}

public bool valueSpecified
{
  get { return _value != null; }
    set { if (value == (_value == null)) _value = value ? valueWorkaround : (int?)null; }
} 
```

但是，修复代码生成也可能有意义吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:57:46.273

是的，修复代码生成是有意义的。我想，你应该向项目贡献者报告。

# javascript - 如何减少 KendoUI 折线图中的垂直线数？

> ID：10182670
> 
> 赞同：5
> 
> 时间：2012-04-16T22:35:17.953
> 
> 标签：javascript, jquery, asp.net-mvc, telerik, kendo-ui

使用 KendoUI 我需要用 KendoUI 替换现有的 DotNet Charting 折线图。有没有办法减少 KendoUI 折线图中的垂直线数？

以下是我要替换的图表和我的 KendoUi 图表的图像：

![](../Images/4f5e1e18328d8782b645595605b98d87.png)

这是我的剑道 UI 脚本：

```
jQuery('#divChart').kendoChart({ 
   title: { 
        text: "Overall Score out of 100", 
        align: "left", font: "18px Arial, Verdana, sans-serif" 
   },
   seriesDefaults: { type: "line" },
   legend: { position: "bottom" }, 
   tooltip: {  visible: true,  format: "{0}%" },
   valueAxis: 
   { 
        min: 70, 
        max: 95, 
        plotBands: 
        [
             { from: 70, to: 75, color: "#EDF5FF" },
             { from: 80, to: 85, color: "#EDF5FF" },
             { from: 90, to: 95, color: "#EDF5FF" }
        ]
    },
    series: 
    [ 
         { 
              name: "Some Product", 
              color:"004990", 
              tooltip: 
              { 
                   visible: true, 
                   template: "<b>Some Product</b><br/>Current Score: #= value # " 
               }, 
               data: [88.27,89.03,89.37,89.65,90.79,90.62,89.67,89.8,89.84,88.99,88.84,88.99,88.15,88.04,87.34,86.95,86.88,86.84,87.07,86.85,86.91,87.31,87.65,87.77,88.21,88.12,88.15,88.62,88.4,88.02,87.9,88.26,88.22,88.2,88.06,88,88.47,88.43,89.09,89.01,88.74,88.98,88.91,89.19,89.61,89.8,89.99,89.48,88.91,88.57,88.74,88.84,89.41,89.46,89.81,89.74,89.75,89.77,89.29,89.52,89.34] 
        },  
        { 
             name: "Some Market Segment", 
             color:"da7633", 
             tooltip: 
             { 
                 visible: true, 
                 template: "<b>Some Market Segment</b><br/>Current Score: #= value # " 
              }, 
              data: [79.47,79.52,79.34,79.91,80.1,79.2,79.01,78.97,78.95,78.83,78.81,78.01,77.63,77.66,76.53,74.87,75.22,75.74,75.12,74.73,74.89,74.78,74.92,74.95,74.67,74.57,75.15,75.32,75.01,74.2,73.82,73.78,72.77,72.76,71.8,71.81,72.13,72.46,72.24,72.46,72.49,72.98,73.34,74.01,74.13,74.3,74.4,74.25,73.81,73.52,73.59,73.49,73.41,73.51,73.72,73.27,74.23,73.99,73.97,73.83,73.79] } ], 
               categoryAxis:
               { 
                   labels: { rotation: -45 }, 
                   categories: [,,,,,,,,,,2008,,,,,,,,,,,,2009,,,,,,,,,,,,2010,,,,,,,,,,,,2011,,,,,,,,,,,,2012,,] 
                } 
```

});

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T15:17:24.307

当前版本无法减少主要网格线的数量。

轴支持`skip`和`step`选项，但仅适用于标签：

```
categoryAxis: {
    labels: {
        step: 2 // Render every second label
    }
} 
```

我们计划很快将此功能扩展到主要的网格线和刻度线。

此外，真正的日期轴也在制作中。它将支持常见的场景，例如开箱即用的场景。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-09T18:05:15.560

尝试这样的事情：

```
 majorGridLines: {

         visible: false
    } 
```

在你的`categoryAxis`街区内。

# javascript - 如何通过 JavaScript 检查用户是否在 Drupal 站点中登录？

> ID：10182674
> 
> 赞同：8
> 
> 时间：2012-04-16T22:35:24.193
> 
> 标签：javascript, php, drupal, drupal-7, drupal-modules

我知道如何检查用户是否通过 PHP 登录，但是当事件发生时我需要做一些样式，我为此创建了一个单独的 JavaScript 文件。这是一个 Drupal 变量还是我也可以引用的东西？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-17T06:46:52.003

使用[hook_init](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_init/7)实现创建一个[新的自定义模块。](https://drupal.org/node/1074360)

```
function [YOUR_MODULE]_init()
{
    global $user;
    drupal_add_js(array('user_js_uid' => $user->uid), 'setting');
} 
```

然后在您的 javascript 代码中，检查模块中定义的变量的值`user_js_uid`。

```
if(Drupal.settings.user_js_uid == 0)
{
    // execute code for non logged in users
}
else
{
    // execute code for logged in users
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-05-30T06:42:04.420

如果您正在等待 DOM 准备好并使用标准生成的 Drupal CSS 类，您可以执行以下操作（使用 jQuery）：

```
if( $( "body.not-logged-in" ).length )
{
    // user is not logged in
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-03-13T08:25:58.530

For Drupal 8 if you use Drupal.behaviors, you can access the user UID in settings:

```
(function($, Drupal, viewport, settings) {
  "use strict";
  Drupal.behaviors.ifCE = { //the name of our behavior
    attach: function (context, settings) {
    var userUID = settings.user.uid;
    //your code...
  }
})(jQuery, Drupal, ResponsiveBootstrapToolkit, drupalSettings); 
```

So if the `userUID === 0` then your user is not connected.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-02T09:03:35.717

The "not-logged-in" class doesn't seem to exist in vanilla Drupal 8. But there's "user-logged-in" instead. Here's one line of CSS I'm using to hide the custom "Register" menu item if a user is logged in:

```
body.user-logged-in a[href="/user/register"] {display: none; } 
```

# functional-programming - OCaml中嵌套`let .. in ..`的评估范围/顺序

> ID：10182677
> 
> 赞同：3
> 
> 时间：2012-04-16T22:35:41.183
> 
> 标签：functional-programming, ocaml, evaluation, let

我这里有一些我不是 100% 理解的小问题：

`let x = 1 in let x = x+2 in let x = x+3 in x`

我知道这个表达式的结果是6，但只是想确定这个表达式的计算顺序；先计算哪一部分？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-18T08:59:33.587

您询问了表达式中的评估*顺序*`let x=1 in let x=x+2 in ...`。顺序是“从左到右”！当你有一个链时`let a=b in let c=d in ...`，评估的顺序总是从左到右。

但是，在您的示例中，有一个令人困惑的部分：您在每个构造中使用了*相同*的变量名 , 。这很令人困惑，因为您随后会看到类似的内容，这看起来像是在“重新定义”或“更改”的值。但是在 OCAML 中实际上并没有发生“x”的“改变”！正如上面已经指出的那样，这里发生的是每次都会引入一个*新变量，因此您的示例完全等同于*`x``let``let x=x+1``x``x`

 *```
 let x = 1 in let y = x+2 in let z = y+3 in z;; 
```

请注意，这里的评估顺序也是从左到右的。（在每个构造链中它总是从左到右`let`。）在您最初的问题中，您选择将所有这些新变量称为“x”而不是`x`,`y`和`z`。这让大多数人感到困惑。最好避免这种编码风格。

但是我们如何检查我们是否正确地重命名了变量？为什么“让 x=1 在让 y=x+2 中”而不是“让 x=1 在让 x=y+2 中”？这`x=x+2`生意太混乱了！好吧，还有另一种理解评估的方式`let x=aaa in bbb`。构造

```
 let x=aaa in bbb 
```

总是可以用以下适用于 的闭包代替`aaa`，

```
 (fun x -> bbb) aaa 
```

一旦你用这种方式重写它，你可以很容易地看到两件事：首先，OCAML 不会在闭包内评估“bbb”，直到“aaa”被评估。（出于这个原因，对的求值`let x=aaa in bbb`是先求值`aaa`然后再求值`bbb`，即“从左到右”。）其次，变量“x”被限制在闭包的主体中，因此“x”不可见在表达式“aaa”中。由于这个原因，如果“aaa”包含一个名为“x”的变量，它之前必须已经定义了一些值，并且它与闭包内的“x”无关。为清楚起见，最好用不同的名称调用此变量。

在您的示例中：

```
 let x=1 in let x=x+2 in let x=x+3 in x 
```

被改写为

```
 (fun x -> let x=x+2 in let x=x+3 in x) 1 
```

然后内部`let`构造也被重写：

```
 (fun x -> (fun x -> let x=x+3 in x) x+2 ) 1
 (fun x -> (fun x -> (fun x-> x) x+3) x+2 ) 1 
```

现在让我们重命名每个函数内部的函数参数，我们可以随时在不改变代码含义的情况下这样做：

```
 (fun x -> (fun y -> (fun z -> z) y+3) x+2 ) 1 
```

这与

```
 let x=1 in let y=x+2 in let z=y+3 in z 
```

通过这种方式，您可以验证您是否已正确重命名变量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-16T22:51:33.267

想象一下括号：

```
let x = 1 in (let x = (x+2) in (let x = (x+3) in x)) 
```

然后替换 (x=1) 其中 x 它未被另一个 x 声明覆盖并消除 outermost `let`：

```
let x = (1+2) in (let x = (x+3) in x) 
```

评估：

```
let x = 3 in (let x = (x+3) in x) 
```

代替：

```
let x = (3+3) in x 
```

评估：

```
let x = 6 in x 
```

代替：

```
6 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-16T23:25:07.433

（评论有点长，所以这里有一个小的额外答案。）

正如 Chuck 所指出的，这个表达式中没有闭包。唯一的复杂性是由于范围规则。OCaml 范围规则是常用的，即名称指的是最接近（最内层）的定义。在表达式中：

```
let v = e1 in e2 
```

该变量`v`在`e1`. 如果（偶然）该名称的变量出现在 中`e1`，则它必须引用 (a different) 的某些外部定义`v`。但是新`v`的（当然）可以命名为`e2`. 因此，您的表达式等效于以下内容：

```
let x = 1 in let y = x+2 in let z = y+3 in z 
```

在我看来，这更清楚，但它具有完全相同的含义。*

# node.js - 最新版Mongoose如何根据Date字段进行查询？

> ID：10182680
> 
> 赞同：0
> 
> 时间：2012-04-16T22:35:51.653
> 
> 标签：node.js, mongodb, mongoose

我有一个模型：

```
var model = {
      created: { type: Date, default: Date.now }
    , data: { }
} 
```

...但我似乎无法根据我使用的指南根据日期进行选择。这是我正在尝试的：

```
Model.find({
    created: { $lte: new Date('2012-03-16T20:54:35.630Z') }
}).run(function(err, models) {
    // ...
}); 
```

我想知道Mongoose是否又变了……还是我做错了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T15:12:51.633

你有什么看起来不错。这是一个[工作示例](https://gist.github.com/2406640)。

你得到错误或只是没有结果？

另一个获得帮助的好地方是[这里](https://groups.google.com/forum/?fromgroups#!forum/mongoose-orm)的官方论坛。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-04T16:48:36.373

尝试改为 ... `.exec(function(err, ...`。

# php - 如何在保持顺序的同时更改数组中的键？

> ID：10182684
> 
> 赞同：18
> 
> 时间：2012-04-16T22:36:38.333
> 
> 标签：php, arrays

我该怎么做：

```
$array = array('a' => 1, 'd' => 2, 'c' => 3); //associative array

// rename $array['d'] as $array['b']
$array = replace_key_function($array, 'd', 'b');

var_export($array); // array('a' => 1, 'b' => 2, 'c' => 3); same order! 
```

我没有看到这样做的功能。有办法做到这一点吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-16T22:42:42.937

[http://ideone.com/nCZnY](http://ideone.com/nCZnY)

```
$array = array('a' => 1, 'd' => 2, 'c' => 3); //associative array

// rename $array['d'] as $array['b']
$array = replace_key_function($array, 'd', 'b');

var_export($array); // array('a' => 1, 'b' => 2, 'c' => 3); same order!

function replace_key_function($array, $key1, $key2)
{
    $keys = array_keys($array);
    $index = array_search($key1, $keys);

    if ($index !== false) {
        $keys[$index] = $key2;
        $array = array_combine($keys, $array);
    }

    return $array;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-01T14:49:58.363

接受的答案的逻辑存在缺陷。

如果你有这样的数组：

```
[
    'k1'=>'k1',
    'k2'=>'k2',
    'k3',
    'k4'=>'k4'
] 
```

并将 'k4' 替换为 'something' 您将得到如下输出：

```
[
    'k1'=>'k1',
    'k2'=>'k2',
    'something' => 'k3',
    'k4'=>'k4'
] 
```

这是解决问题的快速解决方案：

```
function replace_key_function($array, $key1, $key2)
{
    $keys = array_keys($array);
    //$index = array_search($key1, $keys);        
    $index = false;
    $i = 0;
    foreach($array as $k => $v){
        if($key1 === $k){
            $index = $i;
            break;
        }
        $i++;
    }

    if ($index !== false) {
        $keys[$index] = $key2;
        $array = array_combine($keys, $array);
    }

    return $array;
} 
```

**编辑：2014/12/03** 如果将 array_search 的第三个参数（严格）设置为 true，则接受的答案确实有效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-16T08:30:18.240

除了使用循环之外，您总是可以用 扁平化为字符串`json_encode()`，执行字符串替换，然后`json_decode()`返回数组：

```
function replaceKey($array, $old, $new)
{  
    //flatten the array into a JSON string
    $str = json_encode($array);

    // do a simple string replace.
    // variables are wrapped in quotes to ensure only exact match replacements
    // colon after the closing quote will ensure only keys are targeted 
    $str = str_replace('"'.$old.'":','"'.$new.'":',$str);

    // restore JSON string to array
    return json_decode($str, TRUE);       
} 
```

现在这不会检查与预先存在的键的冲突（很容易添加字符串比较检查），并且它可能不是大规模数组中单个替换的最佳解决方案..但是将数组展平为一个很好的部分用于替换的字符串是它有效地使替换递归，因为任何深度的匹配都在一次通过中被替换：

```
$arr = array(
    array(
         'name'     => 'Steve'
        ,'city'     => 'Los Angeles'
        ,'state'    => 'CA'
        ,'country'  => 'USA'
        ,'mother'   => array(
             'name'     => 'Jessica'
            ,'city'     => 'San Diego'
            ,'state'    => 'CA'
            ,'country'  => 'USA'
        )
    )
    ,array(
         'name'     => 'Sara'
        ,'city'     => 'Seattle'
        ,'state'    => 'WA'
        ,'country'  => 'USA'
        ,'father'   =>  array(
             'name'     => 'Eric'
            ,'city'     => 'Atlanta'
            ,'state'    => 'GA'
            ,'country'  => 'USA'
            ,'mother'   => array(
                 'name'     => 'Sharon'
                ,'city'     => 'Portland'
                ,'state'    => 'OR'
                ,'country'  => 'USA'
            )
        )
    )
);
$replaced = replaceKey($arr,'city','town');
print_r($replaced); 
```

输出

```
Array
(
    [0] => Array
        (
            [name] => Steve
            [town] => Los Angeles
            [state] => CA
            [country] => USA
            [mother] => Array
                (
                    [name] => Jessica
                    [town] => San Diego
                    [state] => CA
                    [country] => USA
                )
        )

    [1] => Array
        (
            [name] => Sara
            [town] => Seattle
            [state] => WA
            [country] => USA
            [father] => Array
                (
                    [name] => Eric
                    [town] => Atlanta
                    [state] => GA
                    [country] => USA
                    [mother] => Array
                        (
                            [name] => Sharon
                            [town] => Portland
                            [state] => OR
                            [country] => USA
                        )
                )
        )
) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-27T22:27:18.563

使用 PHP 5.3+ 的通用且简单的解决方案，使用`array_walk`：

```
$array = array('a' => 1, 'd' => 2, 'c' => 3); //associative array

$array = replace_keys($array, array('d' => 'b'));
var_export($array); // array('a' => 1, 'b' => 2, 'c' => 3); same order!

function replace_keys(array $source, array $keyMapping) {
    $target = array();
    array_walk($source,
               function ($v, $k, $keyMapping) use (&$target) {
                    $mappedKey = isset($keyMapping[$k]) ? $keyMapping[$k] : $k;
                    $target[$mappedKey] = $v;
               },
               $keyMapping);
    return $target;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-16T22:51:12.957

已经发布了一个很好的答案，但这是我的两便士：

```
$array = array('a'=>1, 'd'=>2, 'c'=>3);
// rename 'd' to 'b'
foreach($array as $k=>$v){
    if($k == 'd') { $k='b'; }
        $newarray[$k] = $v;
}
$array = $newarray; 
```

作为对 mike-purcell 的回应，这对我上面的例子来说是一种更容易接受的方法吗？

```
changeKey($array, 'd', 'b');

function changeKey($array, $oldKey, $newKey)
{
    foreach($array as $k=>$v){
        if($k == $oldKey) { $k = $newKey; }
        $returnArray[$k] = $v;
    }
    return $returnArray;
} 
```

我一直在寻求改进:)

# python - 用漂亮的汤添加父标签

> ID：10182685
> 
> 赞同：2
> 
> 时间：2012-04-16T22:36:44.807
> 
> 标签：python, html-parsing, beautifulsoup

我有许多 HTML 页面，其中包含这些代码片段的各个部分：

```
<div class="footnote" id="footnote-1">
<h3>Reference:</h3>
<table cellpadding="0" cellspacing="0" class="floater" style="margin-bottom:0;" width="100%">
<tr>
<td valign="top" width="20px">
<a href="javascript:void(0);" onclick='javascript:toggleFootnote("footnote-1");' title="click to hide this reference">1.</a>
</td>
<td>
<p> blah </p>
</td>
</tr>
</table>
</div> 
```

我可以成功解析 HTML 并提取这些相关标签

```
tags = soup.find_all(attrs={"footnote"}) 
```

现在我需要添加关于这些的新父标签，以便代码片段如下：

```
<div class="footnote-out"><CODE></div> 
```

但是我找不到在 bs4 中添加父标签的方法，以便它们支撑已识别的标签。insert()/insert_before 添加在标识的标签之后。

我从尝试字符串操作开始：

```
for tags in soup.find_all(attrs={"footnote"}):
      tags = BeautifulSoup("""<div class="footnote-out">"""+str(tags)+("</div>")) 
```

但我相信这不是最好的课程。

谢谢你的帮助。刚开始使用 bs/bs4 但似乎无法破解。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-17T13:54:33.050

这个怎么样：

```
def wrap(to_wrap, wrap_in):
    contents = to_wrap.replace_with(wrap_in)
    wrap_in.append(contents) 
```

简单的例子：

```
from bs4 import BeautifulSoup
soup = BeautifulSoup("<body><a>Some text</a></body>")
wrap(soup.a, soup.new_tag("b"))
print soup.body
# <body><b><a>Some text</a></b></body> 
```

您的文档示例：

```
for footnote in soup.find_all("div", "footnote"):
    new_tag = soup.new_tag("div")
    new_tag['class'] = 'footnote-out'
    wrap(footnote, new_tag) 
```

# javascript - .NET 中的 Ajax 不想按应有的方式加载图像

> ID：10182706
> 
> 赞同：0
> 
> 时间：2012-04-16T22:39:11.773
> 
> 标签：javascript, image, download, xmlhttprequest

我尝试使用 .NET 和 MSIE 8 获取所需内容的每一种方式都失败了：由于我无法使用“GET”预加载图像，我决定将它们放入 base64：它们可以到达客户端，但是在那里我发现 MSIE8 无法管理超过 32Kb 的 base64，所以我又失望了。所以我又回到了我在网上找到了几次的经典方法，结果如下：

```
var img = new Image();
var ajax = new ActiveXObject('Microsoft.XMLHTTP');
ajax.open("GET", url, false)
ajax.send(null);
var res = ajax.status;
if (res == 200)    // succès
{
    // this program crashes on next line as soon as 'url' points a jpg file
    var tx = rajax.responseText;
    // this program crashes on previous line except if 'url' points a text file
    img.src = tx;
} 
```

那么我该怎么做才能以这种方式加载我的图像？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T00:38:43.177

你对`src`物业有误解。

`src`接受一个 URL，而不是一个实际的图像。
您不需要任何 AJAX。

# php - Android - 连接到 wamp = 服务器问候错误

> ID：10182713
> 
> 赞同：2
> 
> 时间：2012-04-16T22:39:57.780
> 
> 标签：php, android, mysql, login, phpmyadmin

我正在尝试将 android 应用程序连接到 mysql 数据库。数据库“tardy_system”在 wamp 服务器提供的 phpmyadmin 中运行。我们有一个位于 C:/Wamp/www/Latepass 的 php 文件“login.php”作为我们的 API 后端。它的主要目标是连接到数据库并运行查询以用作解析的 JSON 数据。我们在 android 环境中的 java 代码应该连接到 index.php 代码。我们无法将 java 代码连接到 php api 后端。java代码指定查看[http://192.168.0.102:3306/Latepass/login.php](http://192.168.0.102:3306/Latepass/login.php)为文件。这个局域网地址是 wamp 服务器和数据库的当前内部地址。它目前是动态的，但我们最终会将其更改为静态 ip。在我们保存并导出android apk并运行它后，UPON“Student Login”按钮点击java代码启动，但是

连接总是失败。

php 代码可以工作，并且可以从局域网上的任何计算机访问。我们运行了一个测试查询（一切都以 FOR DEBUGGINGONLY 开头），并且能够通过 2 个浏览器（Chrome 和 Firefox）从 LAN 上的任何地方读取它。

所以 WAMP 服务器正在工作 - 因为我们可以通过网络连接到 php 文件。PHP 文件正在运行——因为它确实在浏览器中执行了一个测试查询。

问题：我认为有些东西阻止了 java 代码和 php 代码之间的连接。我们已尝试禁用所有防火墙（路由器中的硬件和 Windows 中的软件。） JSON 连接使用端口 3306。似乎没有任何过滤该端口的东西。

我的 php 代码 - Latepass/login.php

```
<?php
//turn off error reporting
error_reporting(E_ALL ^ E_NOTICE ^ E_WARNING);

//connect to mySQL
$connect = mysql_connect("localhost", "root", "") or die(mysql_error("connection error 2"));

//Select the database
mysql_select_db("tardy_system")or die("database selection error");

//Retrieve the login details via POST
$username = $_POST['username'];
$password = $_POST['password'];

//Query the table android login
$query = mysql_query("SELECT * FROM students WHERE username='$username' AND password='$password'");

//check if there any results returned
$num = mysql_num_rows($query);

//If a record was found matching the details entered in the query
if($num == 1){
    //Create a while loop that places the returned data into an array
    while($list=mysql_fetch_assoc($query)){
        //Store the returned data into a variable
        $output = $list;

        //encode the returned data in JSON format
        echo json_encode($output);

    }
    //close the connection
    mysql_close();  
}

?> 
```

学生登录活动

```
package com.android.upgrayeddapps.latepass;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONObject;

import android.app.Activity;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class StudentLoginActivity extends Activity implements OnClickListener{
    EditText etUsername;
    EditText etPassword;
    Button btnLogin;

    //Create string variables that will have the input assigned to them
    String strUsername;
    String strPassword;

    //Create a HTTPClient as the form container
    HttpClient httpclient;

    //Use HTTP POST method
    HttpPost httppost;

    //Create an array list for the input data to be sent
    ArrayList<NameValuePair> nameValuePairs;

    //Create a HTTP Response and HTTP Entity
    HttpResponse response;
    HttpEntity entity;

    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.studentlogin);

        initialise();
    } 

    private void initialise()
    {

        etUsername = (EditText) findViewById(R.id.txtbxStudentUsername);
        etPassword = (EditText) findViewById(R.id.txtbxStudentLunchID);
        btnLogin = (Button) findViewById(R.id.btnLoginStudent);
        //Set onClickListener
        btnLogin.setOnClickListener(this);
    }

    public void onClick(View v) {

        //Create new default HTTPClient
        httpclient = new DefaultHttpClient();

        //Crate new HTTP POST with URL to php file as parameter
        httppost = new HttpPost("http://192.168.0.102:3306/Latepass/login.php");        

        //Assign input text to strings
        strUsername = etUsername.getText().toString();
        strPassword = etPassword.getText().toString();

        try{

            //Create an Array List
            nameValuePairs = new ArrayList<NameValuePair>();

            //place them in an array list
            nameValuePairs.add(new BasicNameValuePair("username", strUsername));
            nameValuePairs.add(new BasicNameValuePair("password", strPassword));

            //Add array list to http post
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

            //assign executed for container to response
            response = httpclient.execute(httppost);

            //check status code, need to check status code 200
            if(response.getStatusLine().getStatusCode()== 200){
                    //assign response.getEntity()l

                    //check if entity is not null
                    if(entity !=null){
                            //create new input stream with received data assigned
                            InputStream instream = entity.getContent();

            //Create a JSON Object. Assign converted data as parameter
            JSONObject jsonResponse = new JSONObject(convertStreamToString(instream));

            //Assign JSON  responses to local strings
            String retUser = jsonResponse.getString("username");//mySQL table field
            String retPass = jsonResponse.getString("password");//mySQL table field

            //Validate login
            if(strUsername.equals(retUser)&& strPassword.equals(retPass)){

                //Create a new shared preference by getting the preference
                SharedPreferences sp = getSharedPreferences("logindetails",0);

                //Edit the shared Preferences
                SharedPreferences.Editor spedit = sp.edit();

                //Put the login details as strings
                spedit.putString("username", strUsername);
                spedit.putString("password", strPassword);

                //Close the editor
                spedit.commit();

                //Display a Toast saying login was a success
                Toast.makeText(getBaseContext(), "Success!",Toast.LENGTH_SHORT).show();

            } else{
                //Display a Toast saying it failed
                Toast.makeText(getBaseContext(), "Invalid Login Details", Toast.LENGTH_SHORT).show();
                    }
                }   

            }       

        } catch(Exception e){
            e.printStackTrace();
            //Display Toast when there is a connection error
            Toast.makeText(getBaseContext(), "Connection Error Android",Toast.LENGTH_SHORT).show();
            Log.e("YourTag", e.getMessage(), e);
        }
    }//End try/Catch

    private static String convertStreamToString(InputStream is) {
        /*
         * To convert the InputStream to String we use the BufferedReader.readLine()
         * method. We iterate until the BufferedReader return null which means
         * there's no more data to read. Each line will appended to a StringBuilder
         * and returned as String.
         */
        BufferedReader reader = new BufferedReader(new InputStreamReader(is));
        StringBuilder sb = new StringBuilder();

        String line = null;
        try {
            while ((line = reader.readLine()) != null) {
                sb.append(line + "\n");
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                is.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        return sb.toString();
    }//End ConvertStreamToString()

    public void onGotoLatePassActiviy(View View)
    {
        Intent intent = new Intent(View.getContext(), LatePassActivity.class);
        intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        StudentLoginActivity.this.finish();
    }

} 
```

问题：我是否在 wamp 的配置中遗漏了一些不允许我的 java 代码访问 php 代码的内容？

目前我收到一些[apache 错误](http://i.imgur.com/L1aW6.jpg)，导致我尝试对其进行配置。

今天：在登录过程中运行wireshark。应用了 tcp 源和目标 = 3306 过滤器。[得到这个传输](http://i.imgur.com/E6dOw.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T12:53:07.057

WAMP 服务器监听两个端口：端口 80 和端口 3306。端口 80 用于 Web 服务器，端口 3306 用于数据库服务器。

您*无法*通过端口 3306 连接到您的 Web 服务器（和 PHP）。您将访问数据库服务器，一旦它意识到客户端正在使用不同的协议，它将立即断开连接。

我的本地机器上的示例：

```
$ curl http://localhost:3306/
5.1.49-1ubuntu8.1+Yt^Y#CeV�]Sd"tIM(|[1"�Got packets out of order$ 
```

解决方法是将URL改为[http://192.168.0.102/Latepass/login.php](http://192.168.0.102/Latepass/login.php)

如果这不起作用，请确保 Web 服务器正在侦听：在命令提示符下键入`netstat -a -n -p tcp`. 你应该看到这样的东西：

```
Proto  Local Address          Foreign Address        State
TCP    0.0.0.0:80             0.0.0.0:0              LISTENING
TCP    0.0.0.0:135            0.0.0.0:0              LISTENING
TCP    0.0.0.0:445            0.0.0.0:0              LISTENING
... etc... 
```

如果您没有看到以 :80 结尾的第一行，则说明 apache 没有在侦听或您更改了端口。有关更多详细信息，请参阅 Apache 的日志。

# javascript - 为什么 setInterval 回调只执行一次？

> ID：10182714
> 
> 赞同：76
> 
> 时间：2012-04-16T22:39:59.537
> 
> 标签：javascript, callback, setinterval

我有这个计数器，但我希望它永远运行，这真的很简单，我在这里做错了什么？

```
function timer() {
  console.log("timer!")
}

window.setInterval(timer(), 1000) 
```

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2012-04-16T22:40:56.003

您使用函数调用而不是函数引用作为 setInterval 的第一个参数。像这样做：

```
function timer() {
  console.log("timer!");
}

window.setInterval(timer, 1000); 
```

或者更短（但是当函数变大时可读性也会降低）：

```
window.setInterval( function() {
  console.log("timer!");
}, 1000) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-17T12:52:42.820

`setInterval`并且`setTimeout` **必须**与回调一起使用，例如：

```
setInterval(timer, 1000); 
```

或未命名的函数：

```
setInterval( function() { console.log("timer!"); }, 1000 ); 
```

为什么您的代码不起作用 - 当您将一个函数作为参数传递给另一个带括号的函数时，例如`doSomething ( someFunc() )`您正在传递函数的结果。

当函数作为对象传递时，例如`doSomething ( someFunc )`您正在传递回调。这种方式`someFunc`作为引用传递，并在调用函数的某处执行。这与其他语言中的函数指针相同。

一个常见的错误是使用这两个函数，如[w3schools](http://www.w3schools.com/js/js_timing.asp)所示。这会隐式调用`eval`.

# javascript - 使用 fs.readFileSync() 服务 html 文件失败

> ID：10182715
> 
> 赞同：2
> 
> 时间：2012-04-16T22:40:04.227
> 
> 标签：javascript, node.js

我有这个代码（[https://gist.github.com/2402116](https://gist.github.com/2402116)）：

```
server.get('/', function(request, response) {
 var k = fs.readFileSync('./index.html','utf8');
 response.send( k );
}); 
```

尝试读取此文件：

[https://gist.github.com/2402070](https://gist.github.com/2402070)

并且浏览器不断加载并且永远不会结束。

但是，如果我从 html 文件中删除所有 js 包含的内容就可以了。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:57:51.520

`response.end()`完成向浏览器发送数据后，您需要一个。

实际上，由于您是一次发送所有数据，您只需替换`response.send(k)`为`response.end(k)`. 虽然不推荐这种方法。我强烈建议异步读取您的文件并将其逐块发送到客户端。

另请参阅： [http ://nodejs.org/api/http.html#http_response_end_data_encoding](http://nodejs.org/api/http.html#http_response_end_data_encoding)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T23:12:54.140

您[当前的服务器实现](https://gist.github.com/2402116)`index.html`除了服务于对基本 url 的请求之外什么都不做，即`'/'`. 您将需要编写进一步的代码/路由来为 js 中的请求提供服务`index.html`，即`'/app.js'`.ie 中的各种 js 文件`'/js/'`。

现在，gist 中的路由实现相当粗糙，不支持 url 匹配的许多方面。原始代码显然只是展示了一个没有资源的单页站点的概念。你会发现让你的代码工作很快就会变得很麻烦，因为你必须为每个资源请求编写一个路由，例如

```
server.get('/app.js', function(request, response) {
  var k = fs.readFileSync('./app.js','utf8');
  response.send( k );
});

server.get('/js/jquery-1.7.2.js', function(request, response) {
  var k = fs.readFileSync('./js/jquery-1.7.2.js','utf8');
  response.send( k );
});

etc... 
```

您最好查看已经存在的 node.js url 路由库（例如[director](https://github.com/flatiron/director)）或 web 框架（例如[express ），它具有对](http://expressjs.com)[路由](http://expressjs.com/guide.html#routing)（和静态文件服务）的内置支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T23:00:25.317

尝试`.toString`k 并且不发送但是`.end`

```
response.end( k.toString() ); 
```

也许发生了一些奇怪的事情，他试图评估代码

# iphone - 如何检测用户是否正在使用他的设备走路/跑步？

> ID：10182723
> 
> 赞同：0
> 
> 时间：2012-04-16T22:41:14.940
> 
> 标签：iphone, objective-c, ios, accelerometer

简单的问题很难回答：

我希望能够读取设备（和用户）是否拿着他的设备跑步/行走。我知道 iPhone 加速度计会计算加速度，因此如果用户以恒定速度运行，则不会发现任何信号。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-16T22:45:14.990

我实际上曾经这样做过……您可以做的是用加速度计和陀螺仪检测运动的频率。如果您绘制图表，您将在步行或跑步时看到周期性行为。做一些“现场”测试，你可以看到这些频率在步行和跑步之间是如何变化的。它太酷了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T09:00:00.073

尝试[动态时间规整](https://stackoverflow.com/a/6369947/341970)(DTW)。

首先，你建立一个你想识别的动作的小型“数据库”。

然后，在您的应用程序中，您将使用 DTW 的当前传感器读数与数据库中的读数进行比较，然后选择最相似的读数。

# oracle - 是否可以将 Oracle 会话/连接配置为自动大写字符串？

> ID：10182725
> 
> 赞同：1
> 
> 时间：2012-04-16T22:41:18.527
> 
> 标签：oracle

有谁知道是否可以配置 Oracle 会话或连接，以便每个持久化的字符串都自动大写？

例如，如果我调用这样的 SQL：“INSERT INTO STUDENT (name) VALUES ('john doe')”

我表中的信息将像这样持久化：

```
STUDENT
--------------------
ID   | 1
NAME | JOHN DOE 
```

我检查了这个条目，但找不到这样的东西：http: [//docs.oracle.com/cd/B19306_01/server.102/b14225/ch3globenv.htm#sthref186](http://docs.oracle.com/cd/B19306_01/server.102/b14225/ch3globenv.htm#sthref186)

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T22:45:32.763

没有会话级别的配置参数，没有。

您可以在表上编写一个触发器，该触发器`STUDENT`会自动以大写形式存储数据，但您需要为每个表都这样做。

```
CREATE TRIGGER trg_student
  BEFORE INSERT ON student
  FOR EACH ROW
BEGIN
  :new.name := upper( :new.name );
END; 
```

根据您尝试解决的问题，您可能会将会话的 NLS 设置设置为忽略大小写，以便字符串“John Doe `is considered to be equal to the string`JOHN DOE”。选项、限制和缺点会因 Oracle 的特定版本而异。

# nginx - 如何在 Nginx 中托管多个 SNI 证书

> ID：10182729
> 
> 赞同：3
> 
> 时间：2012-04-16T22:41:30.073
> 
> 标签：nginx, cname, sni

我公司的产品允许我们的用户通过选择个人子域来自定义品牌。我们在 nginx 中使用通配符匹配来处理这个问题，然后让 Rails 决定要做什么。我们在任何地方都需要 SSL，并且有一个通配符 SSL 证书，所以这一切都很好。

现在我们想提供带有 SSL 的自定义 CNAME 作为附加功能。由于我们真的不想提供数百个 IP 地址，因此我们将使用 SNI 并接受警告。使用所有这些证书设置 nginx 的最佳方法是什么？我们可以允许用户上传他们自己的证书，也可以为用户购买它们。无论哪种方式，我们如何让 nginx 看到它们并在不重新启动的情况下大规模地为它们提供服务？nginx 可以以某种方式从 mysql 动态读取它的配置，从脚本读取证书，还是将证书责任传递给 Rails？欢迎提出想法！

# sql - 防止更新不存在的行

> ID：10182738
> 
> 赞同：5
> 
> 时间：2012-04-16T22:42:37.563
> 
> 标签：sql, oracle, oracle11g

在工作中，我们有一个表格来保存设置，它基本上包含以下列：

*   `PARAMNAME`
*   `VALUE`

大多数情况下会添加新设置，但在极少数情况下会删除设置。不幸的是，这意味着任何先前可能已更新此值的脚本将继续这样做，尽管更新会导致 " `0 rows updated`" 并导致意外行为。

这种情况最近因回归测试失败而出现，但只是在对系统中的数据为何不同的原因进行了大量调查之后。

所以我的问题是：**当更新导致零行更新时，有没有办法生成错误条件？**

以下是我想到的一些选项，但没有一个是真正可取的：

*   PL/SQL 包装器，它注意到失败的更新并引发异常。
    *   不理想，因为它不会阻止任何人/脚本手动进行更新。
*   引发异常的表上的触发器。
    *   违背了我们目前逐步淘汰触发器的政策。
    *   每次删除设置时都需要更新触发器并维护过时设置列表（如果进行排除）。
    *   变异表可能存在问题（如果通过查询当前存在的设置来包含）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T23:09:27.620

PL/SQL 包装器对我来说似乎是最好的选择。触发器是淘汰的好东西，除了生成序列和插入历史记录。

如果您担心有人手动更新而不是使用 PL/SQL 包装器，只需限制用户角色，使其对表没有 UPDATE 权限，但对过程具有 EXECUTE 权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T03:44:41.883

也许您可以使用 MERGE 语句，这里是它的链接

[http://www.oracle-developer.net/display.php?id=203](http://www.oracle-developer.net/display.php?id=203)

合并语句允许您在同一查询中组合插入和更新，因此如果所需的行不存在，您可以在缓冲区表中插入一条记录以指示该行不存在，否则您可以更新所需的记录

希望能帮助到你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T22:46:46.957

不是真正的解决方案，而是一种组织事物的方法：

使用参数定义创建一个单独的表，并从参数值表链接到该表。对所需的参数定义进行引用（不允许使用空值）。

定义表`PARAMS (ID, NAME)`

实际设置表 `PARAM_VALUES (PARAM_ID, VALUE)`

（改变你的表结构也是一种非常有效的方法来唤起尚未更新的脚本中的错误......）

# python - Python导入内部差异

> ID：10182743
> 
> 赞同：2
> 
> 时间：2012-04-16T22:43:17.983
> 
> 标签：python, import, numpy, imp

我以两种不同的方式导入了一个`numpy`库。第一次`from numpy.random import mtrand`和第二次弄乱了`sys.path`.

但是，这两个模块导入的输出完全不同：

```
>>> from numpy.random import mtrand
>>> dir(mtrand)
['RandomState', '__builtins__', '__doc__', '__file__', '__name__', '__package__', '__test__', '_rand', 'beta', 'binomial', 'bytes', 'chisquare', 'dirichlet', 'exponential', 'f', 'gamma', 'geometric', 'get_state', 'gumbel', 'hypergeometric', 'laplace', 'logistic', 'lognormal', 'logseries', 'multinomial', 'multivariate_normal', 'negative_binomial', 'noncentral_chisquare', 'noncentral_f', 'normal', 'np', 'pareto', 'permutation', 'poisson', 'power', 'rand', 'randint', 'randn', 'random_integers', 'random_sample', 'rayleigh', 'seed', 'set_state', 'shuffle', 'standard_cauchy', 'standard_exponential', 'standard_gamma', 'standard_normal', 'standard_t', 'triangular', 'uniform', 'vonmises', 'wald', 'weibull', 'zipf'] 
```

第二个：

```
>>> sys.path.insert(0, '/usr/lib/pymodules/python2.7/numpy/random')
>>> import mtrand
>>> dir(mtrand)
['__builtins__', '__doc__', '__file__', '__name__', '__package__'] 
```

这种行为怎么可能？

编辑：

*   这两个测试是在不同的 python 进程中执行的。
*   弄乱 sys 路径是愚蠢的，我知道。但这不适用于普通程序，而是用于自动完成。我当然不想导入整个 numpy 包。我只想做一个`dir(mtrand)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T22:50:51.133

尝试导入扩展模块（即从共享库加载的模块）两次会导致未定义的行为。从以下文档中引用`reload()`：

> 然而，在许多情况下，扩展模块不会被设计为多次初始化，并且在重新加载时可能会以任意方式失败。

顺便说一句，这恰好适用于我的安装`numpy`：

```
>>> from numpy.random import mtrand
>>> dir(mtrand)
['RandomState', '__builtins__', '__doc__', '__file__', '__name__', '__package__', '__test__', '_rand', 'beta', 'binomial', 'bytes', 'chisquare', 'dirichlet', 'exponential', 'f', 'gamma', 'geometric', 'get_state', 'gumbel', 'hypergeometric', 'laplace', 'logistic', 'lognormal', 'logseries', 'multinomial', 'multivariate_normal', 'negative_binomial', 'noncentral_chisquare', 'noncentral_f', 'normal', 'np', 'pareto', 'permutation', 'poisson', 'power', 'rand', 'randint', 'randn', 'random_integers', 'random_sample', 'rayleigh', 'seed', 'set_state', 'shuffle', 'standard_cauchy', 'standard_exponential', 'standard_gamma', 'standard_normal', 'standard_t', 'triangular', 'uniform', 'vonmises', 'wald', 'weibull', 'zipf']
>>> sys.path.append("/usr/lib/pyshared/python2.7/numpy/random")
>>> import mtrand
>>> dir(mtrand)
['RandomState', '__builtins__', '__doc__', '__file__', '__name__', '__package__', '__test__', '_rand', 'beta', 'binomial', 'bytes', 'chisquare', 'dirichlet', 'exponential', 'f', 'gamma', 'geometric', 'get_state', 'gumbel', 'hypergeometric', 'laplace', 'logistic', 'lognormal', 'logseries', 'multinomial', 'multivariate_normal', 'negative_binomial', 'noncentral_chisquare', 'noncentral_f', 'normal', 'np', 'pareto', 'permutation', 'poisson', 'power', 'rand', 'randint', 'randn', 'random_integers', 'random_sample', 'rayleigh', 'seed', 'set_state', 'shuffle', 'standard_cauchy', 'standard_exponential', 'standard_gamma', 'standard_normal', 'standard_t', 'triangular', 'uniform', 'vonmises', 'wald', 'weibull', 'zipf'] 
```

这是未定义的行为，所以任何事情都可能发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:50:18.253

不知道为什么有人为此给你一个-1。在遇到我自己的 Python 导入问题后，我认为当你弄乱了之后，`sys.path`你已经绕过了通常会执行 的**init .py 文件。**`/usr/lib/pymodules/python2.7/numpy`并且`/usr/lib/pymodules/python2.7/numpy/random`（可能）是 python 包并包含**init** .py 文件。每当导入该包或子包中的任何内容时，默认情况下都会包含初始化文件。通过将路径指向文件树的更深层次，您绕过了这些初始化文件，从而改变了包的预期行为。

斯文也提供了很好的信息。我假设您的 2 个导入不在 Python 的同一个运行实例中。如果是，那么 Sven 的回答是相关的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T13:04:08.223

正如 Endophage 指出的那样，玩`sys.path`. 但我想我开始了它，因为我不想执行任何 Python 代码，这对于自动完成来说非常酷。我不认为这对于 c_builtin 模块来说是个大问题。但是，有些模块确实需要正确的包路径（请参阅下面关于 segfaults 的评论）。

我什至做了一个解决方法`PyQt4`，但注意到这不是唯一的解决方法：

```
sys.path.append('/usr/lib/python2.7/dist-packages/PyQt4')
try:
    import QtCore
except SystemError:
    QtCore = sys.modules['PyQt4.QtCore']
    debug.warning('Loaded a module with SystemError.') 
```

这包括捕获 a`SystemError`然后从 sys.modules 中使用它。确实这是非常愚蠢的，因为我不知道此类操作的任何副作用。正如我测试`PySide`的（这是另一个 Qt 包装器），在某些情况下会发生段错误。

所以我想出了更pythonic的解决方案来再次加载这样的模块：`from PyQt4 import QtCore`和`from numpy.random import random`.

有趣的是，使用完整路径加载这些模块的内存占用量与`sys.path`.

# javascript - 使用 jquery 追加和删除内容

> ID：10182744
> 
> 赞同：2
> 
> 时间：2012-04-16T22:43:18.557
> 
> 标签：javascript, jquery, css, html

我认为我没有正确使用.remove，因为不是从div“info”中删除“关于加拿大的信息”，而是堆叠在“关于俄罗斯的信息”之上。

js

```
if (code == 'ca') {
        $('#info').append('<p class="i">info about canada</p>');
    } else if (code == 'ru') {
    $('#info').remove('.i');
        $('#info').append('<p class="i">info about russia</p>');
    } 
```

html

```
<div id="info">
<h3>Info</h3>
</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T22:51:46.280

如果您尝试替换`#info`then 的内容，请不要使用`remove`,`empty`或`append`，只需使用`html`：

```
$('#info').html('<p class="i">info about russia</p>'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T22:46:12.893

我想通了......我用 .empty 代替。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T22:47:48.030

他们不需要将参数传递给`remove`..

做就是了：

```
$('#info .i').remove(); 
```

它将`.i`从`$('#info')`div中删除

# xml - XPath 表达式（在 XSLT 中）匹配节点的兄弟节点，直到兄弟节点根据其子节点满足条件

> ID：10182746
> 
> 赞同：1
> 
> 时间：2012-04-16T22:43:27.143
> 
> 标签：xml, xslt, xpath

我有以下标记，一个混合了 TR 和一个或两个子 TD 的表

```
 <table>
    <tr>
      <td>
         <p>XXX</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>YYYYYY</p>
      </td>
      <td>
        <p>YYYYYY</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>YYYYYY</p>
      </td>
      <td>
        <p>YYYYYY</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>YYYYYY</p>
      </td>
      <td>
        <p>YYYYYY</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>XXX</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>YYYYYY</p>
      </td>
      <td>
        <p>YYYYYY</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>YYYYYY</p>
      </td>
      <td>
        <p>YYYYYY</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>XXX</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>YYYYYY</p>
      </td>
      <td>
        <p>YYYYYY</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>YYYYYY</p>
      </td>
      <td>
        <p>YYYYYY</p>
      </td>
    </tr>
  </table> 
```

我正在尝试使用 XSLT 1.0 将其转换为

```
<AAA>
  XXX
  <BBB>YYYYY</BBB>
  <BBB>YYYYY</BBB>
  ...
</AAA>
<AAA>
  XXX
  <BBB>YYYYY</BBB>
  <BBB>YYYYY</BBB>
  ...
</AAA>
... 
```

抽象出这可能是在 XSLT 中处理嵌套循环的最佳方法，XPath 表达式放入了什么？？？下面将选择当前 TR (XXX) 的所有 TR 兄弟姐妹，它们有两个 TD 孩子，但只到下一个 TR (XXX)。我根据它们有多少 TD 子节点来区分包含 XXX 和 YYYYY 的节点。1 = XXX，2 = YYYYY。

```
<xsl:for-each select="//table/tr">
   <xsl:if test="count(td) = '1'">
      XXX
   </xsl:if>
   <xsl:for-each select="???">
      all YYYYY up until the next XXX
   </xsl:for-each>
</xsl:for-each> 
```

我有“following-sibling::tr[child::td[following-sibling::td]”，但它与 YYYYY 匹配到最后 - 我如何让它只选择那些直到下一个带有 XXX 的 TR ?

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:50:04.427

**一、XSLT 1.0 解决方案**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kFollowing" match="tr[td[2]]"
  use="generate-id(preceding-sibling::tr
                                  [not(td[2])]
                                     [1]
                   )"/>

 <xsl:template match="/*">
   <xsl:apply-templates select="tr[not(td[2])]"/>
 </xsl:template>

 <xsl:template match="tr[not(td[2])]">
  <AAA>
    <xsl:value-of select="concat('&#xA;', td/p, '&#xA;')"/>

    <xsl:apply-templates select="key('kFollowing', generate-id())"/>
  </AAA>
 </xsl:template>

 <xsl:template match="p">
  <BBB><xsl:value-of select="."/></BBB>
 </xsl:template>
</xsl:stylesheet> 
```

**当此 XSLT 1.0 转换应用于提供的 XML 文档时**：

```
<table>
    <tr>
        <td>
            <p>XXX</p>
        </td>
    </tr>
    <tr>
        <td>
            <p>YYYYYY</p>
        </td>
        <td>
            <p>YYYYYY</p>
        </td>
    </tr>
    <tr>
        <td>
            <p>YYYYYY</p>
        </td>
        <td>
            <p>YYYYYY</p>
        </td>
    </tr>
    <tr>
        <td>
            <p>YYYYYY</p>
        </td>
        <td>
            <p>YYYYYY</p>
        </td>
    </tr>
    <tr>
        <td>
            <p>XXX</p>
        </td>
    </tr>
    <tr>
        <td>
            <p>YYYYYY</p>
        </td>
        <td>
            <p>YYYYYY</p>
        </td>
    </tr>
    <tr>
        <td>
            <p>YYYYYY</p>
        </td>
        <td>
            <p>YYYYYY</p>
        </td>
    </tr>
    <tr>
        <td>
            <p>XXX</p>
        </td>
    </tr>
    <tr>
        <td>
            <p>YYYYYY</p>
        </td>
        <td>
            <p>YYYYYY</p>
        </td>
    </tr>
    <tr>
        <td>
            <p>YYYYYY</p>
        </td>
        <td>
            <p>YYYYYY</p>
        </td>
    </tr>
</table> 
```

**产生想要的正确结果**：

```
<AAA>
XXX
<BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
</AAA>
<AAA>
XXX
<BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
</AAA>
<AAA>
XXX
<BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
</AAA> 
```

**说明**：

适当地使用**[键](http://www.w3.org/TR/xslt#key)**来定义所有`tr`具有第二个子元素的元素，作为紧接在前的单个子元素`td`的函数。**[`generate-id()`](http://www.w3.org/TR/xslt#function-generate-id)**`tr`

* * *

**二、XSLT 2.0 解决方案：**

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*">
  <xsl:for-each-group group-starting-with="tr[not(td[2])]"
       select="tr">
    <xsl:apply-templates select="current-group()[1]"/>
  </xsl:for-each-group>
 </xsl:template>

 <xsl:template match="tr[not(td[2])]">
  <AAA>
    <xsl:value-of select="concat('&#xA;', td/p, '&#xA;')"/>

    <xsl:apply-templates select="current-group()[position() gt 1]"/>
  </AAA>
 </xsl:template>

 <xsl:template match="p">
  <BBB><xsl:value-of select="."/></BBB>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于同一个 XML 文档（如上）时，会产生相同的正确结果**：

```
<AAA>
XXX
<BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
</AAA>
<AAA>
XXX
<BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
</AAA>
<AAA>
XXX
<BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
   <BBB>YYYYYY</BBB>
</AAA> 
```

**说明**：

适当使用**[`xsl:for-each-group`](http://www.w3.org/TR/2007/REC-xslt20-20070123/#xsl-for-each-group)**with`group-starting-with`属性和**[`current-group()`](http://www.w3.org/TR/2007/REC-xslt20-20070123/#dt-current-group)**函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T07:18:11.413

我一直认为拥有一个完全符合您要求的 XPath 构造会很有用：序列中的所有项目，直到（包括/排除）第一个匹配某个条件的项目。我已经考虑过这样的语法，例如`expr until condition`. Saxon 和 EXSLT 尝试提供更高阶的扩展函数来满足需求，例如 saxon:leading()。可悲的是，规范中没有任何内容。尽管在 XPath 3.0 中，使用高阶函数可以很容易地自己完成。

您有时可以使用分组 (xsl:for-each-group) 来解决问题，但通常最简单和最优雅的方法是使用递归：即编写一个处理序列中第一项并调用自身的函数如果某些条件为真，则处理下一项。

另一种方法是在序列中搜索与条件匹配的第一个节点，然后使用 subsequence() 选择直到该位置的节点：

```
<xsl:variable name="positions" select="
  for $i in 1 to count($seq)
  return if (my:condition($seq[$i])) then $i else ()"/>
<xsl:apply-templates select="subsequence($seq, 1, $positions[1])"/> 
```

# asp.net - ASP.NET 默认授权数据库？

> ID：10182748
> 
> 赞同：-1
> 
> 时间：2012-04-16T22:43:31.283
> 
> 标签：asp.net, sql-server-2008, authorization

在向导创建的默认授权数据库中，一个实体有两个表。例如：

aspnet_users 和用户，aspnet_roles 和角色等。

这是什么原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:59:25.303

出了什么问题？aspnet_regsql 为认证创建的默认数据库有三张表；aspnet_users、aspnet_roles 和 aspnet_applications。为授权添加角色会增加一些，但它们仍然都是 aspnet_ 前缀。

您可以通过运行自行检查

```
aspnet_regsql -sqlexportonly 
```

并检查它产生的 SQL。当您为应用程序服务注册 SQL 时，甚至无法删除前缀。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:54:09.127

我找到了原因。由 aspnet_regsql 创建的 aspnet_ 前缀表和添加用户和角色时由网站管理工具创建的其他表（角色、配置文件、用户等）。谢谢你的建议。

# c# - 服务器客户端发送/接收简单文本

> ID：10182751
> 
> 赞同：49
> 
> 时间：2012-04-16T22:44:02.773
> 
> 标签：c#, .net, winforms, sockets

我有一个家庭作业来构建一个应用程序，它将在服务器和客户端之间发送和接收简单的字符串。我知道如何建立连接，但不知道如何发送和接收字符串。这是我的代码：

```
public partial class Form1 : Form
{
    private Thread n_server;
    private Thread n_client;
    private Thread n_send_server;
    private TcpClient client;
    private TcpListener listener;
    private int port = 2222;
    private string IP = " ";
    private Socket socket;
    public Form1()
    {
        InitializeComponent();
    }

    private void exitToolStripMenuItem_Click(object sender, EventArgs e)
    {
        Application.Exit();
    }

    public void Server()
    {
        listener = new TcpListener(IPAddress.Any, port);
        listener.Start();
        try
        {
            socket = listener.AcceptSocket();
            if (socket.Connected)
            {
                textBox2.Invoke((MethodInvoker)delegate { textBox2.Text = "Client : " + socket.RemoteEndPoint.ToString(); });
            }
        }
        catch
        {
        }
    }

    public void Client()
    {
        IP = "localhost";
        client = new TcpClient();
        try
        {
            client.Connect(IP, port);
        }

        catch (Exception ex)
        {
            MessageBox.Show("Error : " + ex.Message);
        }

        if (client.Connected)
        {
            textBox3.Invoke((MethodInvoker)delegate { textBox3.Text = "Connected..."; });

        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        n_server = new Thread(new ThreadStart(Server)); 
        n_server.IsBackground = true;
        n_server.Start();
        textBox1.Text = "Server up";
    }

    private void button2_Click(object sender, EventArgs e)
    {
        n_client = new Thread(new ThreadStart(Client));
        n_client.IsBackground = true;
        n_client.Start();
    }

    private void send()
    {
        // I want to use this method for both buttons : "send button" on server side    and "send button"
        // on client side. First I read text from textbox2 on server side or textbox3
        // on client side than accept and write the string to label2(s) or label3(c).
        // 
    }

    private void button3_Click(object sender, EventArgs e)
    {
        n_send_server = new Thread(new ThreadStart(send));
        n_send_server.IsBackground = true;
        n_send_server.Start();
    }
} 
```

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2012-04-16T23:05:43.720

以下代码从服务器发送和接收当前日期和时间

//以下代码用于服务器应用程序：

```
namespace Server
{
    class Program
    {
        const int PORT_NO = 5000;
        const string SERVER_IP = "127.0.0.1";

        static void Main(string[] args)
        {
            //---listen at the specified IP and port no.---
            IPAddress localAdd = IPAddress.Parse(SERVER_IP);
            TcpListener listener = new TcpListener(localAdd, PORT_NO);
            Console.WriteLine("Listening...");
            listener.Start();

            //---incoming client connected---
            TcpClient client = listener.AcceptTcpClient();

            //---get the incoming data through a network stream---
            NetworkStream nwStream = client.GetStream();
            byte[] buffer = new byte[client.ReceiveBufferSize];

            //---read incoming stream---
            int bytesRead = nwStream.Read(buffer, 0, client.ReceiveBufferSize);

            //---convert the data received into a string---
            string dataReceived = Encoding.ASCII.GetString(buffer, 0, bytesRead);
            Console.WriteLine("Received : " + dataReceived);

            //---write back the text to the client---
            Console.WriteLine("Sending back : " + dataReceived);
            nwStream.Write(buffer, 0, bytesRead);
            client.Close();
            listener.Stop();
            Console.ReadLine();
        }
    }
} 
```

//这是客户端的代码

```
namespace Client
{
    class Program
    {
        const int PORT_NO = 5000;
        const string SERVER_IP = "127.0.0.1";
        static void Main(string[] args)
        {
            //---data to send to the server---
            string textToSend = DateTime.Now.ToString();

            //---create a TCPClient object at the IP and port no.---
            TcpClient client = new TcpClient(SERVER_IP, PORT_NO);
            NetworkStream nwStream = client.GetStream();
            byte[] bytesToSend = ASCIIEncoding.ASCII.GetBytes(textToSend);

            //---send the text---
            Console.WriteLine("Sending : " + textToSend);
            nwStream.Write(bytesToSend, 0, bytesToSend.Length);

            //---read back the text---
            byte[] bytesToRead = new byte[client.ReceiveBufferSize];
            int bytesRead = nwStream.Read(bytesToRead, 0, client.ReceiveBufferSize);
            Console.WriteLine("Received : " + Encoding.ASCII.GetString(bytesToRead, 0, bytesRead));
            Console.ReadLine();
            client.Close();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-03-30T09:41:38.477

```
 static void Main(string[] args)
    {
        //---listen at the specified IP and port no.---
        IPAddress localAdd = IPAddress.Parse(SERVER_IP);
        TcpListener listener = new TcpListener(localAdd, PORT_NO);
        Console.WriteLine("Listening...");
        listener.Start();
        while (true)
        {
            //---incoming client connected---
            TcpClient client = listener.AcceptTcpClient();

            //---get the incoming data through a network stream---
            NetworkStream nwStream = client.GetStream();
            byte[] buffer = new byte[client.ReceiveBufferSize];

            //---read incoming stream---
            int bytesRead = nwStream.Read(buffer, 0, client.ReceiveBufferSize);

            //---convert the data received into a string---
            string dataReceived = Encoding.ASCII.GetString(buffer, 0, bytesRead);
            Console.WriteLine("Received : " + dataReceived);

            //---write back the text to the client---
            Console.WriteLine("Sending back : " + dataReceived);
            nwStream.Write(buffer, 0, bytesRead);
            client.Close();
        }
        listener.Stop();
        Console.ReadLine();
    } 
```

除了@Nudier Mena 回答之外，还保留一个while 循环以保持服务器处于侦听模式。这样我们就可以连接多个客户端实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-28T11:23:50.390

```
 public partial class Form1 : Form
    {
        private Thread n_server;
        private Thread n_client;
        private Thread n_send_server;
        private TcpClient client;
        private TcpListener listener;
        private int port = 2222;
        private string IP = " ";
        private Socket socket;
        byte[] bufferReceive = new byte[4096];
        byte[] bufferSend = new byte[4096];
        public Form1()
        {
            InitializeComponent();
        }

        private void exitToolStripMenuItem_Click(object sender, EventArgs e)
        {
            Application.Exit();
        }

        public void Server()
        {
            listener = new TcpListener(IPAddress.Any, port);
            listener.Start();
            try
            {
                socket = listener.AcceptSocket();
                if (socket.Connected)
                {
                    textBox3.Invoke((MethodInvoker)delegate { textBox3.Text = "Client        : " + socket.RemoteEndPoint.ToString(); });
                }
                while (true)
                {
                    int length = socket.Receive(bufferReceive);
                    if (length > 0)
                    {
                        label2.Invoke((MethodInvoker)delegate { label2.Text = Encoding.Unicode.GetString(bufferReceive); });
                    }
                }
            }
            catch
            {
            }
        }

        public void Client()
        {
            IP = "localhost";
            client = new TcpClient();
            try
            {
                client.Connect(IP, port);
                while (true)
                {
                    NetworkStream nts = client.GetStream();
                    int length;
                    while ((length = nts.Read(bufferReceive, 0, bufferReceive.Length)) != 0)
                    {
                       label3.Invoke((MethodInvoker)delegate { label3.Text = Encoding.Unicode.GetString(bufferReceive); });
                    }
                }
            }

            catch (Exception ex)
            {
                MessageBox.Show("Error : " + ex.Message);
            }

            if (client.Connected)
            {
                textBox3.Invoke((MethodInvoker)delegate { textBox3.Text = "Connected..."; });

            }
        }

        private void button1_Click(object sender, EventArgs e)
        {
            n_server = new Thread(new ThreadStart(Server));
            n_server.IsBackground = true;
            n_server.Start();
            textBox1.Text = "Server up";
        }

        private void button2_Click(object sender, EventArgs e)
        {
            n_client = new Thread(new ThreadStart(Client));
            n_client.IsBackground = true;
            n_client.Start();
        }

        private void send()
        {
            if (socket!=null)
            {
                bufferSend = Encoding.Unicode.GetBytes(textBox2.Text);
                socket.Send(bufferSend);
            }
            else
            {
                if (client.Connected)
                {
                    bufferSend = Encoding.Unicode.GetBytes(textBox3.Text);
                    NetworkStream nts = client.GetStream();
                    if (nts.CanWrite)
                    {
                        nts.Write(bufferSend,0,bufferSend.Length);
                    }

                }
            }
        }

        private void button3_Click(object sender, EventArgs e)
        {
            n_send_server = new Thread(new ThreadStart(send));
            n_send_server.IsBackground = true;
            n_send_server.Start();
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-21T10:39:38.367

```
bool SendReceiveTCP(string ipAddress, string sendMsg, ref string recMsg)
    {
        try
        {
            DateTime startTime=new DateTime();
            TcpClient clt = new TcpClient();
            clt.Connect(ipAddress, 8001);
            NetworkStream nts = clt.GetStream();
            nts.Write(Encoding.ASCII.GetBytes(sendMsg),0, sendMsg.Length);
            startTime = DateTime.Now;
            while (true)
            {
                if (nts.DataAvailable)
                {
                    byte[] tmpBuff = new byte[1024];
                    System.Threading.Thread.Sleep(100);
                    int readOut=nts.Read(tmpBuff, 0, 1024);
                    if (readOut > 0)
                    {
                        recMsg = Encoding.ASCII.GetString(tmpBuff, 0, readOut);
                        nts.Close();
                        clt.Close();
                        return true;
                    }
                    else
                    {
                        nts.Close();
                        clt.Close();
                        return false;
                    }
                }
                TimeSpan tps = DateTime.Now - startTime;
                if (tps.TotalMilliseconds > 2000)
                {
                    nts.Close();
                    clt.Close();
                    return false;
                }
                System.Threading.Thread.Sleep(50);
            }
        }
        catch (Exception ex)
        {
            throw ex;
        }
    } 
```

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2017-09-10T20:42:51.030

客户

```
namespace SocketKlient

{
    class Program

    {
        static Socket Klient;
        static IPEndPoint endPoint;
        static void Main(string[] args)
        {
            Klient = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
            string command;
            Console.WriteLine("Write IP address");
            command = Console.ReadLine();
            IPAddress Address;
            while(!IPAddress.TryParse(command, out Address)) 
            {
                Console.WriteLine("wrong IP format");
                command = Console.ReadLine();
            }
            Console.WriteLine("Write port");
            command = Console.ReadLine();

            int port;
            while (!int.TryParse(command, out port) && port > 0)
            {
                Console.WriteLine("Wrong port number");
                command = Console.ReadLine();
            }
            endPoint = new IPEndPoint(Address, port); 
            ConnectC(Address, port);
            while(Klient.Connected)
            {
                Console.ReadLine();
                Odesli();
            }
        }

        public static void ConnectC(IPAddress ip, int port)
        {
            IPEndPoint endPoint = new IPEndPoint(ip, port);
            Console.WriteLine("Connecting...");
            try
            {
                Klient.Connect(endPoint);
                Console.WriteLine("Connected!");
            }
            catch
            {
                Console.WriteLine("Connection fail!");
                return; 
            }
            Task t = new Task(WaitForMessages); 
            t.Start(); 
        }

        public static void SendM()
        {
            string message = "Actualy date is " + DateTime.Now; 
            byte[] buffer = Encoding.UTF8.GetBytes(message);
            Console.WriteLine("Sending: " + message);
            Klient.Send(buffer);
        }

        public static void WaitForMessages()
        {
            try
            {
                while (true)
                {
                    byte[] buffer = new byte[64]; 
                    Console.WriteLine("Waiting for answer");
                    Klient.Receive(buffer, 0, buffer.Length, 0); 

                    string message = Encoding.UTF8.GetString(buffer); 
                    Console.WriteLine("Answer: " + message); 
                }
            }
            catch
            {
                Console.WriteLine("Disconnected");
            }
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2017-09-10T20:46:53.447

服务器：

```
namespace SocketServer    
{
    class Program
    {
        static Socket klient; 
        static void Main(string[] args)
        {
            Socket server = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp); 
            IPEndPoint endPoint = new IPEndPoint(IPAddress.Any, 8888); 
            server.Bind(endPoint);
            server.Listen(20);
            while(true)
            {
                Console.WriteLine("Waiting...");
                klient = server.Accept();

                Console.WriteLine("Client connected");
                Task t = new Task(ServisClient);
                t.Start();
            }
        }

        static void ServisClient()
        {
            try
            {
                while (true)
                {
                    byte[] buffer = new byte[64];
                    Console.WriteLine("Waiting for answer...");
                    klient.Receive(buffer, 0, buffer.Length, 0);
                    string message = Encoding.UTF8.GetString(buffer);
                    Console.WriteLine("Answer: " + message);

                    string answer = "Actualy date is " + DateTime.Now;
                    buffer = Encoding.UTF8.GetBytes(answer);
                    Console.WriteLine("Sending {0}", answer);
                    klient.Send(buffer);
                }
            }
            catch
            {
                Console.WriteLine("Disconnected");
            }
        }
    }
} 
```

# network-programming - AMQP QPID 中的网络流量

> ID：10182753
> 
> 赞同：0
> 
> 时间：2012-04-16T22:44:08.177
> 
> 标签：network-programming, rabbitmq, zeromq, messagebroker, qpid

QPID AMQP

我有一个问题正在重新调整网络流量。假设我在 Machine A 上有一个 Publisher 。Qpid 代理正在 Machine B 上运行。我们有两个订阅者机器 C 和机器 D（他们都订阅相同的主题）。现在想象一个拓扑，其中
A-->B-->X-->C | D（发布者A连接到B，订阅者C和D通过中间节点X连接到代理）由A发布的匹配C和D主题的消息将被两者接收。我想知道的是边 b->x 是否会携带消息两次（一次用于 b->x->c，第二次用于 b->x->c）。或者 AMQP/qpid 框架是否足够智能，可以从 B 向 X 发送一次消息，然后向每个单独的订阅者发送副本（因此 b->x 上的网络流量较少）。我的想法是，由于 X 一无所知，并且如果我们为每个订阅者都有私有订阅队列（或者即使共享队列和浏览/复制消息而不是消费），消息将通过 b->x 传输两次

这个问题并不特定于 QPID 。我想知道其他基于代理（RabbitMQ）和无代理消息传递框架（零 MQ，LBM/UMS）的解决方案。我在一篇文章中读到 Zero Mq 试图提供更智能的解决方案[http://www.250bpm.com/pubsub#toc4](http://www.250bpm.com/pubsub#toc4)，但这似乎很复杂，因为中间跃点如何知道何时发送多个副本（我不是网络专家，所以我可能会遗漏一些明显的东西，所以任何帮助都将不胜感激）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T09:19:44.247

我假设 X 是另一个 Qpid 代理，通过“联合”功能连接到 B。在这种情况下，消息不会从 B 传输到 X 两次。

根据场景的其他要求，您可以通过不同的方式进行配置。

第一个是将 X 静态链接到 B：您在 B 上创建一个队列供 X 订阅，将该 Q 绑定到有问题的交换，以便 C 和 D 的消息匹配，然后使用 qpid-route 创建一个桥从该队列到 X 上的交换。C 和 D 现在连接并绑定到 X 上的该交换，并将按预期接收 A 发布的消息。在这种情况下，无论 C 还是 D 处于活动状态，消息都将始终从 B 流向 X。如果您添加另一个消费者 E，那么您可能需要静态添加绑定到 B 上的桥接队列。

第二种选择是使用动态路由。这将自动处理从 X 到 B 的绑定信息的传播，这样消息只会在 X 上的活动绑定需要时从 B 流向 X。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T09:56:38.750

RabbitMQ 也只会在诸如此类的中间链接上传播一次消息（并且只有在某些下游消费者实际上最终会看到该消息时才会发送消息）。

# python - 根据 Key 编辑 XML 值

> ID：10182755
> 
> 赞同：0
> 
> 时间：2012-04-16T22:44:29.733
> 
> 标签：python, xml, beautifulsoup

使用 beautifulsoup 4，如何根据名称编辑值？鉴于我知道 name = "foo"（常量和唯一），我如何读取值 "bar"（在运行时未知），并将其更改为新字符串 "baz"？

我可以使用 soup.find_all(text="foo") 读取该行，但我不知道如何方便地读取该值，或者更改字符串“bar”->“baz”

XML 摘录：

```
<djmacros>
  <macro name="foo" value="bar">
    <description>foobar</description>
  </macro>
</djmacros> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:54:55.633

我还没有尝试过，但我怀疑这样的事情可能会奏效：

```
foo_element = soup.find('macro', attrs={"name" : "foo"}) # returns the foo element
foo_element['value'] = "baz" # changes the value attribute 
```

# windows - Windows 无线-ADHOC API

> ID：10182757
> 
> 赞同：0
> 
> 时间：2012-04-16T22:44:55.503
> 
> 标签：windows, network-programming, adhoc

我可以在这里找到无线 Ad Hoc API 的参考：

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms706584(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms706584(v=vs.85).aspx)

但我无法`AdHod.idl`在我的系统中找到任何位置。我需要安装吗？

我正在使用 Windows 7 和 Microsoft Visual Studio 10 Professional。

谢谢。

# c# - 每次调用方法时存储一个数字并递增它

> ID：10182763
> 
> 赞同：0
> 
> 时间：2012-04-16T22:45:26.677
> 
> 标签：c#, random

我正在尝试让我的扭曲方法执行以下操作：

存储一个数字（结果）
生成一个随机数并将其添加到结果
我到目前为止的代码是：

```
public int twist(int min, int max)
{
    int result = 0;
    Random random = new Random();

    int y = random.Next(min, max);

    result += y;

    System.Diagnostics.Debug.WriteLine(result);
    return result;
} 
```

它所做的只是每次生成一个新数字，因为我没有存储它，我认为我不需要循环，但是我需要在每次 y 递增后存储结果，并且 y 应该只在每次扭曲时递增方法被调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T23:05:21.683

将“结果”存储在方法之外。我也倾向于使随机生成器成为静态的，并且它倾向于记住它在每次调用时生成的数字。

最好保持 Random 静态，因为正如 Marc Gravell 所述，“每次执行 new Random() 时，它都会使用时钟进行初始化。这意味着在紧密循环中，您会多次获得相同的值。您应该保留一个 Random实例并继续在同一个实例上使用 Next。”

查看 -[随机数生成器仅生成一个随机数](https://stackoverflow.com/questions/767999/random-number-generator-not-working-the-way-i-had-planned-c)以获取更多信息和报价来源。

```
private int _result = 0;
private static Random _rand = new Random();

public int twist(int min, int max)
{
    int y = _rand.Next(min, max);

    _result += y;

    System.Diagnostics.Debug.WriteLine(_result);
    return _result;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T22:46:58.807

尝试：

```
private int result;
private Random random = new Random();

public int twist(int min, int max)
{
    int y = random.Next(min, max);
    result += y;

    System.Diagnostics.Debug.WriteLine(result);
    return result;
} 
```

因为`result`需要通过多次调用同一个方法来访问，所以需要把它变成一个字段而不是一个变量。在您的版本中，每次调用都会`twist`创建一个新变量并将其设置为 0。如果将其提取到字段中，则在创建对象时将其初始化为 0，并且每次调用都会将其`twist`递增，而无需每次都重置它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T22:54:08.083

这是一个简洁的小方法，只要您迭代`IEnumerable`.

```
public IEnumerable<int> Twist(int min, int max)  {
  Random random = new Random();
  int result = 0;
  while (true) {
    result += random.Next(min, max);  // overflow pretty likely for large max
    System.Diagnostics.Debug.WriteLine(result);
    yield return result;
  }
}

// For a single element
int oneResult = Twist(1, 5).First();

// For the fifth
int fifth = Twist(1, 5).Skip(4).First(); 
```

如果您想推迟迭代，请为自己定义一个不错的扩展方法：

```
public static class EnumeratorExt {
    public static T Next<T> (this IEnumerator<T> seq) {
        if (seq.MoveNext()) {
            return seq.Current;
        }
        return default(T);
    }
}

// Now call it like so!
using (var generator = Twist(5, 10).GetEnumerator()) {
    Console.WriteLine(generator.Next());
    Console.WriteLine(generator.Next());
    Console.WriteLine(generator.Next());
    Console.WriteLine(generator.Next());
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T13:57:03.907

```
private static int result = 0;
private static Random random = new Random();

public int twist(int min, int max)
{
    int y = random.Next(min, max);
    result += y;

    System.Diagnostics.Debug.WriteLine(result);
    return result;
} 
```

基本上，您需要`result`在方法外部声明，这样它就不会每次都被创建并设置为零。

注意：如果您正在使用 .aspx.cs 文件，您可能还需要将其声明为`static`（或 Session 变量），否则它将在您网页上发生的每个操作中被重置。

注意 2：随机是静态的，因为每个实例都依赖于系统时钟，所以您只有一个实例并调用`.Next(min, max)`该实例以获取另一个随机数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-16T22:49:10.297

取决于您所说的“存储它”是什么意思。在哪里排序？全球？一份文件？数据库？我猜你的意思是一个全局的，在这种情况下，将你的结果变量声明在twist方法的范围之外

# asp.net - 在超链接字段中传递字段值和表名

> ID：10182774
> 
> 赞同：0
> 
> 时间：2012-04-16T22:46:43.660
> 
> 标签：asp.net, vb.net-2010

我试过搜索这个，但我找不到我需要的东西。我有一个网格视图，其中包含从访问数据库中填充的数据。我有一个超链接字段数据绑定到 id 字段，该字段链接到另一个页面，如 page2.aspx?field=11。

我有几个页面使用 id 进入 page2，所以我还需要通过获取名称或手动输入将记录存储在其中的表的名称发送到 page2。我找到了如何发送多个参数，但是如果我输入表名，我会收到一个错误，即找不到字段名。

```
<asp:HyperLinkField DataNavigateUrlFields="DocID,tblDocs" 
            DataNavigateUrlFormatString="Page2.aspx?field={0}&amp;tblDocs={1}" HeaderText="SendFile" 
            Text="Send"></asp:HyperLinkField> 
```

# c# - 如何将对象的字段保存到字符串

> ID：10182783
> 
> 赞同：0
> 
> 时间：2012-04-16T22:48:41.160
> 
> 标签：c#

**问题：如何将对象的值存储到字符串中？**

**objGet 持有：**

```
public string name { get; set; } 
```

**获取信息 + 将对象字段转换为字符串**

```
objGet thisIsTheObject;
string storageString; 
```

**我如何将名称存储到 storageString 中？**
我尝试了以下方法：

```
storageString = thisIsTheObject.name; 
```

我刚刚收到以下错误：
**错误：**使用未分配的局部变量

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:51:45.357

该错误意味着您正在尝试使用未初始化的对象。可能是您忘记初始化 objGet 类对象。

这将使用有效实例初始化对象

```
objGet thisIsTheObject=new objGet();
thisIsTheObject.name="set your value"; 
```

假设你有这个类的默认构造函数 avalilabe。

现在您可以访问对象属性值了

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T22:51:45.293

你初始化objGet了吗？

```
objGet thisIsTheObject = new objGet() { name = "The name" };
string storageString = thisIsTheObject.name; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T22:52:29.237

An`object`需要在使用之前被实例化，并且它的字段被初始化：

```
objGet thisIsTheObject = new objGet(); 
thisIsTheObject.name = "Your_String_Value"; 
....
....
string storageString = thisIsTheObject.name; 
```

这意味着你的类需要一个空的构造函数

```
public class objGet
{
    public objGet() { }
    public string name { get; set; }    
} 
```

# javascript - 对 WebSocket/AJAX 应用程序执行“软刷新”（仅限 JS 和 CSS）

> ID：10182793
> 
> 赞同：3
> 
> 时间：2012-04-16T22:49:21.497
> 
> 标签：javascript, html, ajax

我正在使用 websockets 开发一个应用程序，并使用 ajax 后备。

大多数逻辑驻留在应用程序、模型、视图等的客户端。

在开发过程中，我经常需要做一些小改动，并进行刷新。我这样做的方法是通过硬浏览器刷新，这基本上会重新启动整个应用程序。

这可能需要一些时间，这些是步骤：

*   从服务器获取 index.html
*   index.html 加载所有的 javascript 文件
*   javascript 创建应用程序并启动 websocket
*   在成功的 websocket 连接上，服务器将发送初始化数据
*   客户端收到来自服务器的初始化数据并生成页面

在正常情况下这是可以的，因为一旦加载应用程序，就不会再刷新了。

但这在开发过程中很痛苦，所以我想到了以下解决方案：

进行 CSS 更改后，我运行以下脚本：

```
softreset: function(){
    var queryString = '?reload=' + new Date().getTime();
    $('link[rel="stylesheet"]').each(function () {
        this.href = this.href.replace(/\?.*|$/, queryString);
    });
} 
```

这会立即重置所有 CSS，因此我不需要完全刷新。一步出路。

很多时候这还不够，我还需要新的内容，所以我想做以下事情：

*问题*

*   我需要卸载页面上的所有 JS 文件，但保存 websocket 连接的文件除外。
*   与这些文件关联的所有 DOM 元素、对象、事件都需要删除。
*   我需要从服务器获取新的 JS 文件。
*   将它们加载到页面中，并触发 onload 操作

我尝试使用我用于 CSS 的代码片段，但它并没有起到同样的作用。有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:51:40.323

我认为[live.js](http://livejs.com/)可能部分符合您的要求

# c++ - 使用 clang/llvm 的 C++ 精确垃圾收集器？

> ID：10182794
> 
> 赞同：5
> 
> 时间：2012-04-16T22:49:28.527
> 
> 标签：c++, garbage-collection, clang

好的，所以我想用 C++ 编写一个精确的“标记和清除”垃圾收集器。我希望做出一些可以帮助我的决定，因为我的所有指针都将包装在一个“RelocObject”中，并且我将为堆提供一个内存块。这看起来像这样：

```
// This class acts as an indirection to the actual object in memory so that it can be      
// relocated in the sweep phase of garbage collector
class MemBlock
{
public:
    void* Get( void ) { return m_ptr; }

private:
    MemBlock( void ) : m_ptr( NULL ){}

    void* m_ptr;
};

// This is of the same size as the above class and is directly cast to it, but is     
// typed so that we can easily debug the underlying object
template<typename _Type_>
class TypedBlock
{
public:
    _Type_* Get( void ) { return m_pObject; }

private:
    TypedBlock( void ) : m_pObject( NULL ){}

    // Pointer to actual object in memory
    _Type_* m_pObject;
};

// This is our wrapper class that every pointer is wrapped in 
template< typename _Type_ >
class RelocObject
{
public:

    RelocObject( void ) : m_pRef( NULL ) {}

    static RelocObject New( void )
    {
        RelocObject ref( (TypedBlock<_Type_>*)Allocator()->Alloc( this, sizeof(_Type_), __alignof(_Type_) ) );
        new ( ref.m_pRef->Get() ) _Type_();
        return ref;
    }

    ~RelocObject(){}

    _Type_*     operator->  ( void ) const 
    { 
        assert( m_pRef && "ERROR! Object is null\n" ); 
        return (_Type_*)m_pRef->Get(); 
    }

    // Equality
    bool operator ==(const RelocObject& rhs) const { return m_pRef->Get() == rhs.m_pRef->Get(); }
    bool operator !=(const RelocObject& rhs) const { return m_pRef->Get() != rhs.m_pRef->Get(); }

    RelocObject&    operator=   ( const RelocObject& rhs ) 
    {
        if(this == &rhs) return *this;
        m_pRef = rhs.m_pRef;
        return *this; 
    }

private:

    RelocObject( TypedBlock<_Type_>* pRef ) : m_pRef( pRef ) 
    {
        assert( m_pRef && "ERROR! Can't construct a null object\n");
    }

    RelocObject*    operator&   ( void ) { return this; }
    _Type_&     operator*   ( void ) const { return *(_Type_*)m_pRef->Get(); }

    // SS: 
    TypedBlock<_Type_>* m_pRef;
};

// We would use it like so...
typedef RelocObject<Impl::Foo> Foo;

void main( void )
{
    Foo foo = Foo::New();
} 
```

因此，为了在“RelocObject::New”中分配时找到“根”RelocObjects，我将 RelocObject 的“this”指针传递给分配器（垃圾收集器）。然后分配器检查'this'指针是否在堆的内存块范围内，如果是，那么我可以假设它不是根。

因此，当我想使用位于每个子对象内的零个或多个 RelocObjects 从根跟踪子对象时，问题就来了。

我想使用“精确”方法在类（即子对象）中找到 RelocObjects。我可以使用反射方法并让用户注册他或她的 RelocObjects 在每个类中的位置。但是，这很容易出错，所以我想自动执行此操作。

因此，我希望在编译时使用 Clang 在类中查找 RelocObjects 的偏移量，然后在程序启动时加载此信息，并在垃圾收集器的标记阶段使用它来跟踪和标记子对象。

所以我的问题是 Clang 可以帮忙吗？我听说您可以在编译期间使用其编译时挂钩收集各种类型信息。如果是这样，我应该在 Clang 中寻找什么，即有没有做这种事情的例子？

明确一点：我想使用 Clang 在 FooB 中自动查找“Foo”（这是 RelocObject 的 typedef）的偏移量，而无需用户提供任何“提示”，即他们只写：

```
class FooB
{
public:
    int m_a;
    Foo m_ptr;
}; 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:36:16.030

每当`RelocObject`实例化 a 时，它的地址都可以记录在`RelocObject`所有权数据库中，并且`sizeof(*derivedRelocObject)`该数据库将立即识别哪个`Foo`属于哪个`FooB`. 你不需要 Clang。此外，由于`Foo`将在不久之后创建`FooB`，您的所有权数据库系统可以非常简单，因为*“我已经创建，这是我的地址和大小”*调用的顺序将`RelocObject`直接在`RelocObject`它拥有的实例之前显示拥有记录。

每个`RelocObject`都有一个`ownership_been_declared`初始化为 false 的标志，在第一次使用时（这将在构造函数完成之后，因为在构造函数中不应该做任何实际工作），所以当第一次使用这些新创建的对象中的任何一个时，它会请求数据库更新它是所有权，数据库通过它的记录地址队列，可以识别哪些对象属于哪个，从它的列表中清除一些，将它们的`ownership_been_declared`标志设置为 true，你也将拥有偏移量（如果你仍然需要它们）。

* * *

ps 如果您愿意，我可以分享我多年前编写的增量垃圾收集器的代码，您可能会觉得有帮助。

# unix - 为什么1024以下的端口有特权？

> ID：10182798
> 
> 赞同：70
> 
> 时间：2012-04-16T22:49:45.313
> 
> 标签：unix, ip, port

我听说它是​​一个安全功能，但它通常看起来像是一个安全问题。如果我想编写一个使用特权端口的服务器，我不仅要担心我的代码有多安全，我还要特别担心我是否使用了`setuid`正确的权限和删除权限。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-04-16T22:52:43.457

真的。但这也意味着任何与您交谈的人都知道您必须拥有 root 权限才能运行该服务器。当您在端口 22（例如）上登录服务器时，您知道您正在与由 root 运行的进程通信（安全问题除外），因此您使用该系统的密码或您可能使用的其他信息来信任它不要信任在该系统上拥有用户帐户的任何人。

参考：[http](http://www.w3.org/Daemon/User/Installation/PrivilegedPorts.html) ://www.w3.org/Daemon/User/Installation/PrivilegedPorts.html 。

编辑以详细说明原因：许多最重要的网络服务 - telnet（是的，它仍在使用 - 令人惊讶地经常使用）、SSH、许多 HTTP 服务、FTP 等 - 涉及通过网络发送密码等重要数据。在安全设置中，某种类型的加密，无论是协议固有的 (SSH) 还是围绕协议 (stunnel、IPSec) 的加密，都可以保护数据不被在线窥探，但所有这些保护都在服务器端结束。

为了正确保护您的数据，您需要确保您正在与“真实”服务器通信。今天，安全证书是在网络（和其他地方）上执行此操作的最重要方式：您假设只有“真实”服务器才能访问证书，因此如果您验证您正在与之交谈的服务器具有该证书，您会相信它。

特权端口以非常相似的方式工作：只有 root 可以访问特权端口，所以如果您正在与特权端口通信，您就知道您正在与 root 通信。这在现代网络上不是很有用：重要的是服务器的*身份*，而不是它的 IP。在其他类型的网络中，情况并非如此：例如，在学术网络中，服务器通常由安全房间中受信任的工作人员物理控制，但学生和工作人员作为用户可以自由访问。在这种情况下，通常可以安全地假设您始终可以信任 root，因此您可以安全地登录并将私有数据发送到特权端口。如果普通用户可以监听所有端口，则您需要一个额外的层来验证特定程序是否受某些数据的信任。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-17T07:36:44.640

您没有说您使用的是什么平台，但至少在 Linux 上您可以使用功能（特别是 CAP_NET_BIND_SERVICE）来允许非 root 进程在小于 1024 的端口上侦听。例如，请参阅[Is there a way for非root进程绑定到Linux上的“特权”端口？](https://stackoverflow.com/questions/413807/is-there-a-way-for-non-root-processes-to-bind-to-privileged-ports-1024-on-l)

另一种选择是设置 iptables 规则以将流量从特权端口转发到非特权端口（我在生产中使用过它，它相当简单并且效果很好）。它也在上面的链接中描述。

# php - Magento 管理类别页面在 PHP 5.4 上失败

> ID：10182802
> 
> 赞同：2
> 
> 时间：2012-04-16T22:50:27.087
> 
> 标签：php, magento, magento-1.6

我在 1&1 上托管了一个 Magento 1.6.2 站点。由于某些已安装的扩展，我必须支持 PHP 5.3 版，但遗憾的是 1&1 的可用选项是 PHP 5.2 或他们称之为 PHP Dev 的东西。快速`phpinfo()`显示这实际上是 PHP 5.4。

我的问题是，当我设置为 5.4 时，后端的 Categories 页面会抛出 500 错误。回滚到 5.2 解决了这个问题，但这会破坏我的产品页面。在短期内我可以处理它们之间的交换，但是当站点交给客户时，这对于长期解决方案显然是不可接受的。

任何人都可以建议这种不兼容性可能在哪里，以及我可以采取哪些步骤来解决它？我最大的障碍是托管在共享服务器上，所以我不能查看 Apache 日志。

**更新：**

根据 CCBlackburn 在评论中的建议，我试图追踪错误的起源点，但我不得不承认我并不真正理解我得到的结果。类别页面的 URL 如下所示：

`example.com/index.php/admin/catalog_category/index/key/blahblah`

我认为这`Mage_Adminhtml_CatalogController`将是开始查找的地方，但是`Mage::log()`作为第一行的调用`indexAction()`未能写入日志。

我决定向上移动继承并切入构造函数，因此将以下内容添加到`Mage_Adminhtml_Controller_Action`：

```
function __construct(Zend_Controller_Request_Abstract $request, Zend_Controller_Response_Abstract $response, array $invokeArgs = array()) {
    Mage::log('construct pre');
    parent::__construct($request,$response,$invokeArgs);
    Mage::log('construct post');
} 
```

这更好，因为第一个日志调用写入文件，但第二个没有。

接下来我再次将继承上移，并将构造函数修改`Mage_Core_Controller_Varien_Action`如下：

```
public function __construct(Zend_Controller_Request_Abstract $request, Zend_Controller_Response_Abstract $response, array $invokeArgs = array())
{
    Mage::log('request: '.$request);
    $this->_request = $request;
    Mage::log('response: '.$response);
    $this->_response= $response;
    Mage::log('pre set action');
    Mage::app()->getFrontController()->setAction($this);
    Mage::log('post set action');
    $this->_construct();
} 
```

问题是这些日志调用都没有做任何事情。这让我很困惑，因为在它做任何事情之前肯定应该至少再执行一次日志调用`parent::__construct();`。`Mage_Adminhtml_Controller_Action`除非传入值存在问题，但我不知道如何检查/调试它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T08:41:26.567

我在使用 Magento 1.7 和 PHP 5.4 的 Google Chrome 和 Apple Safari 中的 OSX Lion 下遇到了同样的问题。突然 Magento 类别管理员开始给出 500 个错误，我不知道发生了什么。看来这是 PHP 5.4 的问题。起初我以为是 XDebug 导致了这个错误。然后我禁用了XDebug，问题仍然存在。它与 Firefox 一起使用更奇怪！

我的解决方案是降级到最新的 PHP 5.3，但是现在这个问题已经**从 PHP 5.4.3 得到修复**。

# r - 使用 R 中的 glmulti 包对 akaike 权重进行详尽的搜索多元回归

> ID：10182804
> 
> 赞同：6
> 
> 时间：2012-04-16T22:50:31.800
> 
> 标签：r, regression

我想知道是否有人可以帮助我理解为什么我在将脚本输入 R 时收到错误消息。对于背景信息，我正在研究***6 个不同变量（我认为是 63 个组合或模型）的影响（X )***对于我的环境科学荣誉项目，在不同空间尺度上分别计算了初级和净生态系统总产量 (Y)。我决定使用具有 akaikes 信息标准 (AIC) 的详尽搜索多元回归分析来尝试找到一组最适合的模型。（以及分层划分以比较归因于不同 X 变量的方差）我想获得权重，这样我就可以对哪些模型“最符合”标准进行排名，看看是否有一个或一组模型可以装备其余的模型，因此更可能适合数据。

我最近在 Cross Validated 的 hier.part 包上发布了一个类似的问题，得到了很好的回答，并被告知如果我将来有任何类似的问题可以来这里。

我用于 R 的包是 glmulti。[可以在这里找到](http://cran.r-project.org/web/packages/glmulti/glmulti.pdf)

我正在使用的脚本是这个

```
require(glmulti)
GPPANDDRIVER<-read.table("C:\\Databases at different scales for R\\River Rhine and Netherlands\\GPP and drivers rhineland (comma delimited).csv",header=T,sep=",")
GPP<-GPPANDDRIVER$GPP
IND_VARS<-subset(GPPANDDRIVER,select=-GPP)
#  glmulti S4 generic 
glmulti(y=GPP, xr=IND_VARS, data, exclude = c(), name = "glmulti.analysis", intercept = TRUE, marginality = FALSE, bunch=30, chunk = 1, chunks = 1,
level = 2, minsize = 0, maxsize = -1, minK = 0, maxK = -1, method = "h", crit = "aic", confsetsize = 63, popsize = 40, mutrate = 10^-3, sexrate = 0.1, imm = 0.3, plotty = TRUE, report = TRUE, deltaM = 0.05, deltaB = 0.05, conseq = 5, fitfunction = "glm", resumefile = "id", includeobjects=TRUE,) 
```

这是示例中提到的莱茵兰网站的 .csv 数据链接，[http://www.filedropper.com/gppanddriversrhinelandcommadelimited](http://www.filedropper.com/gppanddriversrhinelandcommadelimited)

我对 R 非常陌生，所以我假设***popsize***表示这个规模的复制数为 40，所以我使用了 40，我还假设***confsetsize***表示可能的模型数，由于 6 个变量，我认为是 63？

如果有人可以提供帮助，将不胜感激

感谢您的耐心和对基本问题的歉意

理查德

*编辑*我今天早上刚尝试运行该脚本，但它现在使 R 崩溃。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T14:30:30.367

这对我有用。我认为主要是不要盲目地在模型调用中包含所有参数。其中大多数都有默认值，因此（如果包编写者已经完成了他们的工作）你应该能够让它们保持原样而不用太担心（当然你应该 RTFM 并且（*尝试*）理解它们的含义。 ..)

```
dat <- read.csv("GPPdriversRhineland.csv")
library(glmulti) 
```

我决定用较短的标签重命名预测变量：

```
prednames <- c("NDVI","solar.rad","avg.temp","precip",
                "nutr.avail","water.cap")
names(dat)[1:6] <- prednames 
```

这就是拟合所有主效应组合所需的全部内容：由于您有六个预测变量，因此有 64 个 1 级模型（包括空模型）。

```
g1 <- glmulti("GPP",xr=prednames,data=dat,level=1) 
```

对于更大的计算挑战：

```
g2 <- glmulti("GPP",xr=prednames,data=dat,level=2) 
```

我相信这里有`2^(choose(6,2)+6)`= 210 万个可能的模型。我还没有仔细研究过`?glmulti`如何*停止*拟合模型。我刚开始使用它（到目前为止它已经评估了 66,000 个模型），但是它找到了一个 AIC 约为 500.5 的 2-level 模型，这比 1-level 模型集中的 518 的 min-AIC*好得多*.. .

**PS**我更多地使用设置，尝试遗传算法方法而不是穷举方法（我没有看到一种明显的方式来告诉`glmulti`“使用穷举方法，但在N次尝试后停止”）。即使比默认的遗传算法设置稍微宽松一些，它似乎仍停留在大约 504 的 AIC 上，高于我首先尝试的（部分）详尽筛选中发现的值。

例如：

```
g2 <- glmulti("GPP",xr=prednames,data=dat,level=2,marginality=TRUE,
              method="g",conseq=25,popsize=500,mutrate=1e-2) 
```

**PPS**：我在详尽案例中获得更好结果的原因是我有`marginality=FALSE`，即模型被允许省略与模型中包含的交互作用有关的主效应参数。这不一定是明智的。如果我关闭边际约束，那么遗传算法可以毫不费力地降到 AIC=499...

```
glmulti("GPP",xr=prednames,data=dat,level=2,marginality=TRUE,
              method="d") 
```

也很有用：它打印出为给定规范定义的候选模型的数量。

# google-app-engine - 使用 Go 和 Java 在 Gae 上共享 Memcache

> ID：10182805
> 
> 赞同：3
> 
> 时间：2012-04-16T22:50:35.720
> 
> 标签：google-app-engine, memcached, go

我可以从 Go 写入内存缓存并从 Java（在 appengine 上）读取它吗？

从 memcache 查看器看来，答案是否定的，因为有“Java 字符串”和“Go 字符串”类型的键。共享 []byte 怎么样？

Web-hook 和数据存储是 Java 和 Go 在 Appengine 上进行通信的唯一方式吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T09:37:25.820

我不知道你的问题的答案，但你会在[MemcacheSerialization.java](http://code.google.com/p/googleappengine/source/browse/trunk/java/src/main/com/google/appengine/api/memcache/MemcacheSerialization.java "MemcacheSerialization.java")的方法 makePbKey 中找到它的一部分。这显示了 Java 如何获取一个对象并从中生成一个键。

同样，在文件 appengine/memcache/memcache.go 中，您可以看到 AppEngine for Go 如何从 Item.Key（类型字符串）中生成密钥。请参阅 GetMulti，其中每个键都通过简单的转换从字符串转换为 [] 字节。

因此，您问题的最终答案取决于您找到一条通过 mkPbKey 和 GetMulti 产生相同密钥的路径。在我看来，如果你给 Java 一个 String 类型的键，它的长度小于 250，并且你记得在 Go 中你的键前后加上“”，它可能会起作用。（但阅读 mkPbKey 让我想知道它如何对包含 200 个代码点的字符串做出反应，所有这些都会导致 UTF-8 中的多字节编码。似乎它会产生比预期更大的密钥。）

# php - PHP 中的 URL 替换

> ID：10182806
> 
> 赞同：2
> 
> 时间：2012-04-16T22:50:44.633
> 
> 标签：php, regex

我正在尝试更改保存当前 URL 的字符串中的值。我试图得到类似的东西

```
http://myurl.com/test/begin.php?req=&srclang=english&destlang=english&service=MyMemory 
```

看起来像

```
http://myurl.com/test/end.php?req=&srclang=english&destlang=english&service=MyMemory 
```

替换`begin.php`为`end.php`.

我需要将`end.php`其存储在一个变量中，以便它可以更改，但`begin.php`可以是一个静态字符串。

我试过这个，但没有奏效：

```
$endURL   = 'end.php';
$beginURL = 'begin.php';
$newURL   = str_ireplace($beginURL,$endURL,$url); 
```

* * *

编辑：另外，如果我想更换

```
http://myurl.com/begin.php?req=&srclang=english&destlang=english&service=MyMemory 
```

和

```
http://newsite.com/end.php?req=&srclang=english&destlang=english&service=MyMemory 
```

那我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T05:30:31.080

假设您要替换 url 的脚本文件名，您可以使用以下内容：

```
<?php 
  $endURL   = 'end.php';
  $url ="http://myurl.com/test/begin.php?req=&srclang=english&destlang=english&service=MyMemory";
  $pattern = '/(.+)\/([^?\/]+)\?(.+)/';
  $replacement = '${1}/'.$endURL.'?${3}';
  $newURL = preg_replace($pattern , $replacement, $url);

   echo "url : $url <br>";
   echo "newURL : $newURL <br>";
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:54:05.510

您希望他们如何从 beigin.php 到达 end.php？似乎您可以只将 FORM 提交到 end.php 并通过 POST 或 GET 变量传递变量。

更改用户所在页面（end.php，begin.php）的唯一方法是将他们链接到该页面的另一个页面，这需要刷新页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T22:54:44.377

我最近为此制作了一个 PHP 文件，它最终看起来像这样：

```
$vars = $_SERVER["QUERY_STRING"];
$filename = $_SERVER["PHP_SELF"];
$filename = substr($filename, 4);
// for me substr removed 'abc/' in the beginning of the string, you can of course adjust this variable, this is the "end.php"-variable for you.

if (strlen($vars) > 0) $vars = '?' . $vars;
$resultURL = "http://somewhere.com" . $filename . $vars; 
```

# c# - MVC C#使用参数调用存储过程第一个参数未被识别

> ID：10182813
> 
> 赞同：1
> 
> 时间：2012-04-16T22:51:16.267
> 
> 标签：c#, asp.net-mvc, stored-procedures

有人可以向我解释一下吗？我有这个存储过程：

```
ALTER proc [dbo].[Invoice_GetHomePageInvoices] (
      @AreaIdList varchar(max)
,      @FinancialYearStartDate datetime = null
,      @FinancialYearEndDate datetime = null
) as 
```

在代码中，我试图这样称呼它：

```
var areasString = new SqlParameter("AreaIdList", "1,2");
var startDate = new SqlParameter("FinancialYearStartDate", financialYear.StartDate);
var endDate = new SqlParameter("FinancialYearEndDate", financialYear.EndDate);

return _db.Database.SqlQuery<HomePageInvoice>("Invoice_GetHomePageInvoices", areasString, startDate, endDate); 
```

我收到此错误：

> 过程或函数“Invoice_GetHomePageInvoices”需要未提供的参数“@AreaIdList”。

说什么？我已经提供了该参数。有人可以给我一些关于如何解决的见解吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T00:08:57.823

你需要这样称呼它：

```
var areasString = new SqlParameter("AreaIdList", "1,2");             
var startDate = new SqlParameter("FinancialYearStartDate", financialYear.StartDate);             
var endDate = new SqlParameter("FinancialYearEndDate", financialYear.EndDate);              
return _db.Database.SqlQuery<HomePageInvoice>("EXEC Invoice_GetHomePageInvoices @AreaIdList, @FinancialYearStartDate, @FinancialYearEndDate", areasString, startDate, endDate); 
```

我相信你也可以缩短一点，比如：

```
return _db.Database.SqlQuery<HomePageInvoice>("EXEC Invoice_GetHomePageInvoices {0}, {1}, {2}", "1,2", financialYear.StartDate, financialYear.EndDate); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:55:43.730

它可能期望参数值：

```
return _db.Database.SqlQuery<HomePageInvoice>("Invoice_GetHomePageInvoices", areasString.Value, startDate.Value, endDate.Value) 
```

# php - 在 PHP 中解析未知的 POST 参数

> ID：10182814
> 
> 赞同：0
> 
> 时间：2012-04-16T22:51:24.910
> 
> 标签：php, html, post

我有一个由客户请求表填充的 HTML 表单。用户查看每个请求，设置操作并提交。该操作被设置为 POST arg，如下所示

```
$postArray = array_keys($_POST);

[1]=>Keep [2]=>Reject [3]=>Reject [4]=>Ignore ["item id"]=>"operation" 
```

这就是我解析我的 POST args 的方式，看起来很尴尬，未使用的`$idx`. 我是 PHP 新手，有没有更流畅的方法可以做到这一点？

```
$postArray = array_keys($_POST);            
foreach($postArray as $idx => $itemId) {            
    $operation = $_POST[$itemId];
    echo "$itemId $operation </br>";
    // ...perform operation...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T22:55:10.137

```
foreach ($_POST as $key => $value) // $key will contain the name of the array key 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T22:56:10.090

你可以使用

```
foreach($_POST as $itemId => $operation ) {            
    echo "$itemId $operation </br>";
    // ...perform operation...
} 
```

反而

[http://nz.php.net/manual/en/control-structures.foreach.php](http://nz.php.net/manual/en/control-structures.foreach.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-16T22:57:30.567

如果不需要，您不必在循环中使用 $idx。可能是这样的：

```
foreach($postArray as $itemId) { 
...
} 
```

主要问题是数据结构非常混乱。也许这是组织表单输出的更好方法。可能在一些结构良好的关联数组中。我看不到表格，我不知道细节，所以很难说更多。

# ruby-on-rails - 新部署到生产，Rake db:migrate 失败

> ID：10182824
> 
> 赞同：0
> 
> 时间：2012-04-16T22:51:57.957
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, rake

尝试将新应用部署到生产环境。从基本 CentOS 构建服务器。
但是，当我尝试运行 rake 来迁移数据库时，出现以下错误

```
[root@tatp tatp_store]# bundle exec rake db:migrate
rake aborted!
uninitialized constant ActiveShipping::Base

(See full trace by running task with --trace)
[root@tatp tatp_store]# 
```

我通过它可能是与 DSL 问题类似的问题，但类似的修复不起作用。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T18:03:51.663

此问题是由 Spree Active Shipping 中的错误引起的，问题 #26 已在构建 9d4af80 中修复

# python - Django：setup.py 与复制目录

> ID：10182828
> 
> 赞同：0
> 
> 时间：2012-04-16T22:52:31.950
> 
> 标签：python, django, installation, setup.py, django-1.4

在 Windows 7 上，我在 C:\Python26 安装了 python2.6.6 我想安装 Django，所以我：

1.  将文件下载并解压到 C:\Python26\Django-1.4
2.  运行 python setup.py install
3.  通过打开 IDLE 并输入验证它已安装，导入 django

下一部分是问题......在教程中，它说现在运行 django-admin.py startproject mysite，但是 django-admin.py 没有找到，在寻找它时，我发现有一个重复在目录中

*   C:\Python26\Django-1.4\build\lib\django
*   C:\Python26\Django-1.4\django

我在 setup.cfg 中没有看到任何可以让我确保不会发生这种情况或选择不同的安装文件夹等的内容...但是在文件 C:\Python26\Django-1.4\INSTALL 中，它声明“作为替代方案，您可以将整个“django”目录复制到 python 的 site-packages 目录”

所以对于我的问题：除了避免在 Django 目录中重复代码之外，使用 setup.py install 命令与复制目录还有什么区别？还有其他优点/缺点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:56:21.677

尝试添加“C:\Python26\;C:\Python26\Scripts;” 到您的`PATH`环境变量，然后运行`django-admin.py startproject mysite`​​.

# c# - 在 IF 语句中对多个条件进行分组 C#

> ID：10182834
> 
> 赞同：0
> 
> 时间：2012-04-16T22:53:24.137
> 
> 标签：c#, if-statement, conditional-statements

我正在编写一个需要执行搜索作为必需功能之一的程序。用户应该能够使用任意数量的字段，范围从没有到全部（总共 7 个）。到目前为止，我已经成功地将每个数据输入案例分组到一个 if 语句中，如下所示：

```
List<TypeClass> myList = new List<TypeClass>

foreach TypeClass currentItem in myList

{
    if (data1 == currentItem.GetData1() || data1 == "Do Not Search" && (data2 == currentItem.GetData2() || data2 == "Do Not Search") && (data3...)

    {
        //Stuff
    }

} 
```

如果您注意到，我将每个数据字段分组在括号内，因此只有当输入的每个数据都是所需条件或“空字段”时，才能满足该语句。但是，我不能像对其他数据 2、3、4 那样对语句的第一部分进行分组...相反，即使存在其他不满足条件的搜索字段，该语句也总是被评估为真该声明。如果我使用额外的括号，程序将完全忽略 if 语句并将其视为根本没有任何情况匹配。

所以如果我这样写：

```
if ((data1 == currentIten.GetData1 || data1 == "Do Not Search") && (data2...) 
```

没有检查任何内容，并且该语句被忽略。这是正常的吗？有没有更好/更有效的方法来处理可选的搜索字段选择？

编辑：抱歉错字，每个 GetDataX 都是一个访问器，我忘了写括号 ()

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:12:01.377

你可以这样做

```
 List<string> mylist = new List<string>();
        string data1 = "test1";
        string data2 = "test2";
        string data3 = "test3";
        string data4 = "test4";

        foreach (string s in mylist)
        {
            bool found = false;

            if(data1.Equals(s) || data1.Equals("Do not Search"))
            {
                found = true;
            }

            if (data2.Equals(s) || data1.Equals("Do not Search"))
            {
                found = true;
            }

            if (data3.Equals(s) || data1.Equals("Do not Search"))
            {
                found = true;
            }

            if (data4.Equals(s) || data1.Equals("Do not Search"))
            {
                found = true;
            }

        } 
```

或者像这样的一个和条件

```
 List<string> mylist = new List<string>();
        string data1 = "test1";
        string data2 = "test2";
        string data3 = "test3";
        string data4 = "test4";

        foreach (string s in mylist)
        {
            bool found = false;
            bool notfound = false;

            if(data1.Equals(s) || data1.Equals("Do not Search"))
            {
                found = true;
            }
            else
            {
                notfound = true;
            }

            if (data2.Equals(s) || data1.Equals("Do not Search"))
            {
                found = true;
            }
            else
            {
                notfound = true;
            }
            if (data3.Equals(s) || data1.Equals("Do not Search"))
            {
                found = true;
            }
            else
            {
                notfound = true;
            }
            if (data4.Equals(s) || data1.Equals("Do not Search"))
            {
                found = true;
            }
            else
            {
                notfound = true;
            }

            // Force all to match
            if (notfound)
                return null;
        } 
```

我的偏好是这样的，尽管您可以利用搜索功能来做您需要的事情.....

```
List<string> mylist = new List<string>();

        List<string> mysearches = new List<string>();

        string data1 = "test1";
        string data2 = "test2";
        string data3 = "test3";
        string data4 = "test4";

        if(data1 != "Do not Search")
            mysearches.Add(data1);
        if (data2 != "Do not Search")
            mysearches.Add(data2);
        if (data3 != "Do not Search")
            mysearches.Add(data3);
        if (data4 != "Do not Search")
            mysearches.Add(data4);
        bool found = false;
        bool andconditionmatch = true;

        foreach (string s in mylist)
        {
            if (mysearches.Contains(s))
            {
                found = true;
            }
            else
            {
                andconditionmatch = false;
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:19:58.073

将所有可能性放在 hashset 中。

```
Hashset with all possibilities.

foreach(item in selectedItems) //you may not need this if you dont have to perform action forall selected items.
{
     if (Hashset contains item)
       //do stuff.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T23:43:00.640

我会在类中移动匹配，而不是处理 7 个单独的可能值来匹配，而是让它们成为一个名为`criteria`. 请参阅下面的示例代码：

```
public enum States
{
    None,
    Tenesee,
    Georgia,
    Colorado,
    Florida
}
class Item
{
    public States State { get; set; }
    public string Name { get; set; }
    public int ID { get; set; }

    public bool IsMatch(Item criteria)
    {
        bool match = true;
        if (criteria.State != States.None) match &= criteria.State == State;
        if (!string.IsNullOrEmpty(criteria.Name)) match &= criteria.Name.Equals(Name);
        if (criteria.ID > 0) match &= criteria.ID == ID;
        return match;
    }
    public override string ToString()
    {
        return string.Format("ID={0}, Name={1}, State={2}", ID.ToString(), Name, State.ToString());
    }
}
class Program
{

    static void Main(string[] args)
    {

        List<Item> list = new List<Item>();
        list.Add(new Item() { ID = 10016, Name = "Julia", State = States.Georgia });
        list.Add(new Item() { ID = 10017, Name = "Scott", State = States.Colorado });
        list.Add(new Item() { ID = 10018, Name = "Samantha", State = States.Tenesee });
        list.Add(new Item() { ID = 10019, Name = "Julia", State = States.Florida });

        Item criteria = new Item()
        {
            State = States.Tenesee,
            ID = 10018
        };
        List<Item> selection = list.FindAll((item) => item.IsMatch(criteria));

        foreach (var item in selection)
        {
            Console.WriteLine("{0}", item);
        }

    }
} 
```

结果 `ID=10018, Name=Samantha, State=Tenesee`

因此，您构建一个标准实例`Item`并比较是否有明确定义的属性。循环遍历所有项目并选择符合条件的项目。显然，您必须扩展`.IsMatch()`所有 7 个属性。

# android - 安卓：倒计时

> ID：10182840
> 
> 赞同：0
> 
> 时间：2012-04-16T22:53:42.167
> 
> 标签：android, countdown

我希望我的应用程序的用户可以插入一天中的一个小时，并且我想用 dd:hh:mm:ss 显示倒计时，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:56:26.833

你看过[CountDownTimer](http://developer.android.com/reference/android/os/CountDownTimer.html)类吗？似乎可以做你想做的事。

# python - Python中的二维与一维字典效率

> ID：10182841
> 
> 赞同：6
> 
> 时间：2012-04-16T22:53:48.270
> 
> 标签：python, performance, dictionary, nested, tuples

什么在内存和速度方面更有效

`d[(first,second)]`

和

`d[first][second]`,

`d`元组或字典的字典在哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-16T23:35:34.467

这是一些非常基本的测试数据，表明对于一个非常人为的示例（使用数字作为键存储“a”一百万次）使用 2 个字典要快得多。

```
$ python -m timeit 'd = {i:{j:"a" for j in range(1000)} for i in range(1000)};a = [d[i][j] for j in range(1000) for i in range(1000)];'
10 loops, best of 3: 316 msec per loop
$ python -m timeit 'd = {(i, j):"a" for j in range(1000) for i in range(1000)};a = [d[i, j] for j in range(1000) for i in range(1000)];'
10 loops, best of 3: 970 msec per loop 
```

当然，这些测试并不一定意味着什么，这取决于您要做什么。确定要存储的内容，然后进行测试。

多一点数据：

```
$ python -m timeit 'a = [(hash(i), hash(j)) for i in range(1000) for j in range(1000)]'
10 loops, best of 3: 304 msec per loop
$ python -m timeit 'a = [hash((i, j)) for i in range(1000) for j in range(1000)]'
10 loops, best of 3: 172 msec per loop
$ python -m timeit 'd = {i:{j:"a" for j in range(1000)} for i in range(1000)}'
10 loops, best of 3: 101 msec per loop
$ python -m timeit 'd = {(i, j):"a" for j in range(1000) for i in range(1000)}'
10 loops, best of 3: 645 msec per loop 
```

再一次，这显然*不代表*现实世界的使用，但在我看来，用这样的元组构建字典的成本是*巨大*的，这就是字典中的字典胜出的地方。这让我感到惊讶，我期待完全不同的结果。当我有时间时，我将不得不尝试更多的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T23:04:46.193

有点令人惊讶的是，字典的字典比 CPython 2.7 和 Pypy 1.8 中的元组更快。

我没有检查空间，但你可以用 ps 做到这一点。

# cron - cron 和 wget：如何防止 cron 用“孙子失败”消息使 syslog 混乱？

> ID：10182850
> 
> 赞同：0
> 
> 时间：2012-04-16T22:55:06.930
> 
> 标签：cron, wget, syslog, error-code

这是一个巨大的烦恼。虽然在旧`wget`版本中（即使在手册页中如此说明）整个错误代码功能从未可靠地工作过，但当前`wget`版本似乎让它工作得太可靠了。

我的`cron`工作可能被称为“穷人的 RSS”，为一个没有 RSS 选项的博客设置。我会每 15 分钟轮询一次以获取新页面。（也就是说，当它当前位于 random-blog.net/entry2147.html 时，我将 2148 存储在一个变量中并从中构建了我的 crontab，我将得到`404`s 直到 entry2148.html 页面存在。（通常是不到 20 小时的情况下）

但...

`cron``wget`每当返回“未找到”（404）（退出代码 8）时，往往会变得有点过于冗长：

```
(CRON) error grandchild #98765 failed with error code 8 
```

嗯，我知道，不是吗？！我知道该页面尚不存在，但我不需要`cron`在每次运行时都告诉我！我已经在网上搜索了答案，但不知道如何在保持`syslog`整洁的同时抑制这些不必要的消息。

不幸的是，尽管“失败”，但没有办法告诉`wget`简单地输出代码`0`（好吧，除了破解它）

关于这个问题的任何想法，有人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T08:11:56.437

您可以将这些东西包装在一个 shell 脚本中，该脚本忽略实际的退出代码并以 0 返回退出。它可能看起来像：

```
#!/bin/sh

cd /home/me/mycrondir

wget -flags tralalala tweedledom  2>&1 >>/home/me/mycrondir/myerrorlog.log

exit 0
#Eof 
```

如果 wget（或您需要的其他二进制文件）不在 $PATH 中（由 cron 提供），您可以在此脚本的顶部添加这些，例如

```
PATH=/opt/bin:$PATH; export PATH 
```

# django - 非超级用户访问 Django Admin

> ID：10182851
> 
> 赞同：0
> 
> 时间：2012-04-16T22:55:10.080
> 
> 标签：django, django-admin

我想限制管理界面的哪些部分对哪些工作人员可见 - 例如，一个人可能只负责与计费相关的项目，另一个人只负责客户支持，第三个人可能拥有完全访问权限。

我可以通过将 is_superuser 设置为 True 来提供完全访问权限，但我不希望这样（我不希望所有有权访问管理界面的员工都成为超级用户）。

我可以通过将 is_staff 设置为 True 来允许员工登录到管理界面，但是一旦登录，员工就无法访问任何内容 - 他们会看到“您无权编辑任何内容”。

我尝试了[这个问题](https://stackoverflow.com/questions/8392780/django-admin-group-permissions-to-edit-or-view-models)中描述的方法，但我得到了相同的“你没有权限”结果：

```
class MyAdmin(admin.ModelAdmin):
    def has_edit_permission(self, request):
        return True 
```

有没有办法让员工无需成为超级用户就可以访问 Django 管理界面的某些部分？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T23:05:02.843

没有这样的事情`has_edit_permission`。是`has_change_permission`。

有关这三种权限方法的更多信息，请参阅[Django ModelAdmin 文档](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.has_add_permission)：

> **`ModelAdmin.has_add_permission(self, request)`**
> 
> > `True`如果允许添加对象，则应返回，`False`否则。
> 
> **`ModelAdmin.has_change_permission(self, request, obj=None)`**
> 
> > 如果允许`True`编辑，则应返回，否则。如果是，应该返回或指示是否允许编辑这种类型的对象（例如，将被解释为意味着不允许当前用户编辑任何这种类型的对象）。`obj``False``obj``None``True``False``False`
> 
> **`ModelAdmin.has_delete_permission(self, request, obj=None)`**
> 
> > 如果允许`True`删除，则应返回，否则。如果是，应该返回或指示是否允许删除这种类型的对象（例如，将被解释为意味着不允许当前用户删除这种类型的任何对象）。`obj``False``obj``None``True``False``False`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T23:43:04.437

对于您想要做的事情，不要覆盖 has_change_permission - 除了检查“是员工”之外，只需给用户和/或用户组相应的权限（“可以更改 Xs”）。

# python - 代表 Google Apps 用户发送电子邮件

> ID：10182854
> 
> 赞同：4
> 
> 时间：2012-04-16T22:55:37.943
> 
> 标签：python, google-app-engine

根据文档，如果该用户拥有 Gmail 或 Google Apps 帐户，则可以代表当前登录的用户使用 GAE 发送电子邮件：

> 出于安全考虑，消息的发件人地址必须是应用程序管理员的电子邮件地址或应用程序的任何有效电子邮件接收地址（请参阅接收邮件）。**如果用户的帐户是 Gmail 帐户或位于由 Google Apps 管理的域中**，则发件人也可以是当前登录用户的 Google 帐户电子邮件地址。

 **以下代码适用于代表 Gmail 用户而不是 Google Apps 用户发送电子邮件。尝试从 Google Apps 用户发送邮件会导致“未经授权的发件人”错误。

```
current_user = users.get_current_user()
message = mail.EmailMessage()
message.sender = current_user.email()
message.subject = 'subject text'
message.to = 'joe@example.com'
message.body = 'body text'
if message.is_initialized():
    try:
        message.send()
    except Exception, e:
        logging.error('Unable to send email update: %s' % e)
else:
    logging.error('Email message improperly initialized') 
```

我错过了什么？还有其他我应该注意的依赖项吗？

编辑：

完整的堆栈跟踪：

```
Unauthorized sender
Traceback (most recent call last):
  File "/base/data/home/apps/s~core-comps/1.358275951854397525/handler_cs_ticket.py", line 274, in sendEmailCopyToClient
    message.send()
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/mail.py", line 900, in send
    raise ERROR_MAP[e.application_error](e.error_detail)
InvalidSenderError: Unauthorized sender 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T20:48:34.770

问题似乎在于您的应用程序正在使用联合登录，这是一项实验性功能，不适用于代表 Google Apps 帐户发送。您可以在管理控制台的“应用程序设置”页面上更改此设置。

我会将其添加到文档中。**

# java - 使用spring“cvc-elt.1：找不到元素'beans'的声明”获取错误消息。

> ID：10182857
> 
> 赞同：10
> 
> 时间：2012-04-16T22:55:58.090
> 
> 标签：java, eclipse, spring

我正在尝试设置一个简单的弹簧应用程序，但出现以下异常。这是在 eclipse indigo 中独立运行的。

```
Exception in thread "main" org.springframework.beans.factory.BeanDefinitionStoreException: Line 2 in XML document from class path resource [context.xml] is invalid; nested exception is org.xml.sax.SAXParseException: cvc-elt.1: Cannot find the declaration of element 'beans'.
org.xml.sax.SAXParseException: cvc-elt.1: Cannot find the declaration of element 'beans'.
      at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:195)
      at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(ErrorHandlerWrapper.java:131)
      at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:384)
      at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:318) 
```

这是我的代码的初始部分：

```
public static void main(String[] args) {

        try {

            BeanFactory beanfactory = new ClassPathXmlApplicationContext(
                    "context.xml");

            FirstBean bean = (FirstBean) beanfactory.getBean("show"); 
```

这是我的 context.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" 
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xmlns:aop="http://www.springframework.org/schema/aop"
 xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">
<bean id="anotherBean" class="AnotherBean" />
<bean id="show" class="FirstBean">
<constructor-arg ref="anotherBean" />
</bean>
<bean id="populateFD" class="PopulateFactData">
<constructor-arg value="localhost" />
<constructor-arg value="3309" />
</bean>
</beans> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-17T00:07:47.240

你确定你`spring-beans`在类路径上吗？

此错误通常意味着它找不到一个`spring.schemas`（在 中`spring-beans.jar`）向它解释该名称空间的含义。

其他选项是 Maven Shade 插件已损坏`spring.schemas`，但由于您没有提到 Maven，因此不太可能出现这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T23:23:52.960

也许这篇文章可以帮助你：

[在 Internet 离线模式下找不到元素“bean”的声明](https://stackoverflow.com/questions/8100965/cannot-find-the-declaration-of-element-beans-in-internet-offline-mode)

这似乎是架构配置的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-24T21:20:13.083

maven shade 插件似乎替换了 jar 中的 spring.schemas 文件，因此使用每个 jar 中的所有单独的 spring.schema 内容创建我们自己的一个应该可以解决问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-03T22:09:17.263

当我在 STS 中遇到这个问题时，我刚刚清理了项目并且它起作用了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-18T07:02:03.127

Spring Bean 版本和 xsd 定义可能不匹配。

例如 bean xsi:schemaLocation="http://www.springframework.org/schema/aop [http://www.springframework.org/schema/aop/spring-aop-3.2.xsd](http://www.springframework.org/schema/aop/spring-aop-3.2.xsd) [http://www.springframework。 org/schema/mvc](http://www.springframework.org/schema/mvc) [http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd](http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd) [http://www.springframework.org/schema/beans](http://www.springframework.org/schema/beans) [http://www.springframework.org/schema /beans/spring-beans-3.2.xsd](http://www.springframework.org/schema/beans/spring-beans-3.2.xsd) [http://www.springframework.org/schema/util](http://www.springframework.org/schema/util) [http://www.springframework.org/schema/util/spring-util-3.2.xsd](http://www.springframework.org/schema/util/spring-util-3.2.xsd) [http://www. springframework.org/schema/tx](http://www.springframework.org/schema/tx) [http://www.springframework.org/schema/tx/spring-tx.xsd](http://www.springframework.org/schema/tx/spring-tx.xsd) [http://www.springframework.org/schema/context](http://www.springframework.org/schema/context) [http://www.springframework.org/schema /context/spring-context-3.0.xsd](http://www.springframework.org/schema/context/spring-context-3.0.xsd)

而在春季版本是**3.0.5-Release**

检查类路径版本并保持它们相同。应该

# c# - 带有远程路径的 WPF 图像

> ID：10182858
> 
> 赞同：0
> 
> 时间：2012-04-16T22:56:02.410
> 
> 标签：c#, wpf

我正在尝试将图像加载到我的 Silverlight 项目中，并且我有以下 XAML：

```
<UserControl x:Class="SilverlightApplication1.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    d:DesignHeight="300" d:DesignWidth="400" xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk">

    <Grid x:Name="LayoutRoot" Background="White">
        <Image Height="150" Width="200" Source="http://wsf.cdyne.com/WeatherWS/Images/rain.gif" />
    </Grid>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T22:58:46.807

Silverlight 中的 Image 控件仅支持 PNG 和 JPEG，不支持 GIF。

[http://msdn.microsoft.com/en-us/library/system.windows.controls.image(VS.95).aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.image(VS.95).aspx)

# visual-studio - 如何从旧的 SourceSafe 废话中获得传统的 Visual Studio 解决方案？

> ID：10182865
> 
> 赞同：1
> 
> 时间：2012-04-16T22:56:38.643
> 
> 标签：visual-studio, visual-sourcesafe

如果可能的话，我必须弄清楚需要做什么才能将一个非常旧/搁置/未完成的 C# asp.net 代码库变成一个工作应用程序。

我被指出根目录中只有一些东西的来源，重要的似乎是这个数据文件夹。

它包含一大堆文件夹，主要标题为 a、b、c 等。其中包含名为 baaaaaa 或 baaaaaaa.b 之类的文件。我可以在记事本中打开其中的一些并查看平面旧 C# 源代码，但在这个组织中它基本上没有意义。

我从来没有使用过SourceSafe，但从谷歌搜索我猜这就是SourceSafe 存储文件及其更改的方式还是什么？

如果我有我所描述的但没有传统的解决方案或来源，是否可以获得具有正确名称类等的原始组织解决方案？我什至可以使用这个吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:14:45.297

您正在查看 SourceSafe 库。你需要：

1.  在您的客户端上获取 VSS（Visual Source Safe，v6.0d 仍然可用）。
2.  将其作为 VSS 库指向该根目录。

然后您应该会看到项目树并能够提取所有内容。

# jquery - 使用 Jquery 在加载时淡出。然后，在悬停时淡入，在悬停时淡出，使用 CSS

> ID：10182867
> 
> 赞同：1
> 
> 时间：2012-04-16T22:56:39.953
> 
> 标签：jquery, css

在我的博客应用程序上，当首页加载时，我希望 twitter 分享按钮（每个博客帖子一个）淡出（这样用户就知道它们在那里，但它们不会长时间分散布局）。当用户将鼠标悬停在帖子上时，我希望共享按钮淡入，然后在未悬停时再次淡出。

现在我正在使用 Jquery 在页面加载时淡出，效果很好：

```
jQuery ->
  $('.t-share').fadeOut(6800) 
```

但是，我无法让它在使用 CSS 的悬停/取消悬停时淡入/淡出。这很奇怪，因为当用户悬停/取消悬停在帖子上时，还有几个其他链接会出现/消失，这是我使用 css 转换实现的。但是，当我试图让`.t-share`div 做同样的事情时，它不起作用。按钮上的`display: none;`属性不会改变，但是对于应该淡入的其他元素它会改变。

此外，当按钮淡出时（需要 6 秒）悬停在 div 上时，我可以看到发生 CSS 转换（它还添加了边框），但它继续淡出。

这是CSS：

```
&:hover {
    .t-share {
        display:inline-block;
        position:absolute;
        right:8px;
        top:8px;
        border:2px solid red;
    } 
```

JS 是否以某种方式禁用了 CSS 过渡？

在Jquery在加载时淡出按钮后，如何使用CSS让按钮在悬停/取消悬停时淡入/淡出？

如果不可能，JS 解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:02:09.357

可能是您的 css 转换不起作用，因为当它完全淡出时，fadeOut 函数将其设置`.t-share`为`display: none`（我不确定是否如此）。您可能想对此进行测试。

与此同时，你可以选择 100% JS。这虽然不使用纯 CSS...

```
$('.t-share')
  .mouseenter(function(){ $(this).fadeIn(200); })
  .mouseleave(function(){ $(this).fadeOut(200); })
  .fadeOut(6800); 
```

# javascript - 如何在谷歌方向上制作无限多段线并将可拖动标记拟合到线上？

> ID：10182878
> 
> 赞同：2
> 
> 时间：2012-04-16T22:57:47.637
> 
> 标签：javascript, google-maps-api-3, google-maps-markers, map-directions, google-polyline

我发现可以在 google api 方向上只添加八个航点，你知道如何绕过这个限制吗？我试图显示方向api，但放弃了这个想法。现在我的解决方案是基于自己的折线，每次单击都会添加应该粘在该线上的标记，接下来随着您拖动它应该移动，这里发生的是，如果有超过 8 个点的折线与标记不再兼容。也许我的方法完全不好？如何解决这个问题？

当前代码：[jsfiddle](http://jsfiddle.net/bartek/T79as/)

标记不在折线上：

![在此处输入图像描述](../Images/4547934f72c8909b8bbdfe79a5b24f4a.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T02:04:14.397

避免将标记放置在块中间的一种方法是将标记放置在生成的多段线的末端，例如，在您的一个循环内，而不是点击的位置。

```
for (k = 0; k < next.length; k++) {
  polyline.getPath().push(next[k]);

  if (z == steps.length-1 && k == next.length-1) {
    var roadMarker = new google.maps.Marker( {
      map: map, 
      position: next[k], 
      icon: "http://labs.google.com/ridefinder/images/mm_20_green.png"
    });   
  }                        
} 
```

您还必须更改要放置在折线开头的第一个标记

这适用于[http://jsfiddle.net/T79as/3/上面的代码](http://jsfiddle.net/T79as/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:49:12.913

所以，我的解决方案是在每个重要的航路点（带有标记？）之间创建渲染 DirectionRenderner：http: [//jsfiddle.net/9T7Vg/](http://jsfiddle.net/9T7Vg/)

*   看起来与原始标记完全相同的可拖动标记
*   可立即计算的可拖动折线
*   带有字母（A、B 等）的自定义标记 - 这很困难
*   远距离的路线计算要快得多
*   路线可以有超过 8 个航点（当用户想要在标记之间放置第 9 个航点时，您可以改进脚本以自动分割路线）

所以这个解决方案实际上比谷歌地图中的原始解决方案要好，尤其是在长途路线上。

# javascript - Twitter Bootstrap 下拉菜单 - onclick 将“打开”类放在祖先 ul 而不是子 ul 上

> ID：10182880
> 
> 赞同：0
> 
> 时间：2012-04-16T22:58:00.443
> 
> 标签：javascript, twitter-bootstrap, drop-down-menu

这是我的问题，我正在尝试通过 twitter 引导程序更新来帮助朋友 - 特别是导航栏。当我单击具有下拉菜单的项目时，菜单不会打开。

## 我的问题是下拉菜单不会打开。我的调查表明，引导程序的 javascript 将开放类应用于错误的 ul，因此下拉菜单永远不会出现。

我已按照[http://twitter.github.com/bootstrap/javascript.html#dropdowns](http://twitter.github.com/bootstrap/javascript.html#dropdowns)上的说明进行了全部设置。据我所见，一切设置正确。

*我已经导出了一个自定义引导程序，其中包含下拉菜单。*

*该页面在 javascript 控制台中运行没有错误。*

根据我的调查，我发现当您单击“打印”（有一个下拉菜单）时，它实际上会转到 ul.level-0.nav 并添加“open”类。这是一个问题，因为它实际上需要将该类应用于 a.dropdown-menu。

请参阅此处的结构：

```
ul.level-0.nav
   li.dropdown
       a.dropdown-toggle
       ul.dropdown-menu 
```

所以要复制这个问题，

第 1 步：http: [//jsfiddle.net/uGGgS/1/](http://jsfiddle.net/uGGgS/1/)铬

第 2 步：打开您的 chrome 对象检查器（如果您在 firefox 中，或者如果您在 IE 中，则打开 firebug，然后下载 chrome 并为使用 IE 打自己一巴掌）

第 3 步：深入研究`li.haschild.dropdown a:contains('print')`

第 4 步：单击“打印”菜单项，注意 ul.level-0.nav 现在具有“open”类。还要注意没有显示下拉菜单:(

第 5 步：将类添加`open`到 print 下面的 ul.dropdown-toggle 并注意出现下拉菜单。

Anyone here know what I am doing wrong? I've done a w3c validate on the page and it had no errors that indicated the html page had unclosed tags.

Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:02:42.583

From my test i noticed that the older version of the `bootstrap.min.js` being included in your document is conflicting with your markup and updating it to the latest fixes the issue.

# encryption - 验证标头加密的坏主意？

> ID：10182882
> 
> 赞同：2
> 
> 时间：2012-04-16T22:58:27.417
> 
> 标签：encryption, blowfish, encryption-symmetric

我正在使用加密（河豚对称）来发送数据包。从安全的角度来看，在数据包的开头有一个标头（也与数据包的其余部分一起加密）是一个坏主意，我可以用它来验证数据包是否有效？

伪代码示例：

```
byte[] verificationHeader = [1,2,3,4,5];
receive(packet);
unencrypt(packet);
if (packet.getData().beginswith(verificationHeader)) {
   // assume packet is good, try to do something with it
} else {
   // drop packet
} 
```

我想验证它，因为任何其他应用程序都可能在我的组中广播，我不想与其他东西混在一起。

它可能会帮助黑客解密我的数据包吗？

如果这是一个坏主意，那么你能建议一个替代方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:11:22.553

至少在理论上，这是一个非常糟糕的主意——它让进行暴力攻击的人知道了一个已知的“目标”，所以当/如果他们得到正确的密钥时，就会知道它（并且很快就会知道）。

至少从安全的角度来看，将该部分保留为明文会更好。它也可能更实用——如果它无论如何都不会有用，它可以让你免于解密。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:21:41.783

我不确定这是否是个坏主意，但如果你决定是这样，那么也许你可以发送一个随机数，然后是随机数或带有标题。然后在另一边你或那个号码再次随机数。然后你不会多次发送相同的东西，但它都是加密的，所以它是不可破解的。我认为我的数学是正确的，但这个想法仍然成立。

```
ie
value = random | header;
send (random, value);
header = random | value; 
```

# performance - WaIISHost 扁平化网络角色

> ID：10182884
> 
> 赞同：1
> 
> 时间：2012-04-16T22:58:34.607
> 
> 标签：performance, iis, deployment, azure, azure-web-roles

首先，我对 Azure 很陌生。

我已使用 Web 角色成功地将 ASP.NET MVC 3 Web 应用程序部署到 Azure。该应用程序使用实体框架和 SQL Azure。

最近我做了一些更改（一些包括添加 appsettings），并尝试升级应用程序。升级时，花了相当长的时间，才Aborting。我一直通过位于[http://windows.azure.com](http://windows.azure.com)的管理门户 Silverlight 应用程序进行部署。

再次尝试无济于事时，我设置了远程桌面并再次部署。远程桌面会话非常慢，原来是因为 WaIISHost 将 CPU 设置为 100%。

IIS 管理器显示应用程序已部署并“启动”，但是我无法导航到 VM 中的站点，并且部署似乎不断尝试更新但没有成功并最终中止并重试，（在我写这篇文章时，它是目前正忙，正在等待角色开始...）。

有没有人对问题可能有任何想法？

我相信所有正确的依赖项都设置为复制本地，这是[一个可能的问题](https://stackoverflow.com/questions/8512228/microsoft-azure-mvc-3-web-role-not-starting-after-adding-twiliocontroller-base)。调试此问题非常困难，因为由于 100% 的 CPU 利用率，远程桌面会话经常挂起，并且不时回收/重新启动/重新更新 Web 角色。

谢谢，

詹姆士

PS希望其中一些至少有一些意义......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T03:53:38.453

我怀疑您的 WebRole.OnStart 和/或 Run 中是否有某些事情导致 WaIISHost 使用 100% CPU。您能否从 WebRole.OnStart 和/或 Run 中删除所有代码，然后重试。

在部署时打开 IntelliTrace 可能会有所帮助，这样您就可以下载跟踪并找出应用程序启动时发生的任何异常，甚至在网站启动之前。

# python - Python重新连接到MySQLdb

> ID：10182889
> 
> 赞同：0
> 
> 时间：2012-04-16T22:59:43.403
> 
> 标签：python, mysql

我有以下内容：

```
class DBConnection:
    def __init__(self, DB_HOST, DB_PORT, DB_USER, DB_PASSWORD, DB_NAME):
        self.host = DB_HOST
        self.port = DB_PORT
        self.name = DB_NAME
        self.user = DB_USER
        self.password = DB_PASSWORD
        self.conn = None
        self.cursor = None

    def get_conn(self):
        if self.conn is None:
            self.conn = MySQLdb.connect (host = self.host, port = self.port, db = self.name, user = self.user, passwd = self.password)
        return self.conn

    def close_conn(self):
        if self.conn:
            self.conn.close()
        return self.conn 
```

这是我尝试重新连接时的样子：

```
>>> from db_conn import DBConnection
>>> db = DBConnection(DB_HOST, DB_PORT, DB_USER, DB_PASSWORD, DB_NAME)
>>> db.get_conn()
<_mysql.connection open to '127.0.0.1' at 7fbb1b8a2420>
>>> db.close_conn()
>>> db.conn
<_mysql.connection closed at 7fbb1b8a2420>
>>> db.get_conn()
<_mysql.connection closed at 7fbb1b8a2420> 
```

为什么它不允许我重新打开连接？我将如何重新打开它，或者我需要创建一个新实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:13:48.480

您正在测试 self.conn 是否为 'None' 但它不是 - 它仍然是一个 mysql 连接对象。它的属性或方法之一会告诉您它是否打开，因此您可以对其进行测试，或者在 close_conn 中将 self.conn 设置为 None 如果这更容易的话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:15:30.373

函数“close_conn”在colseed 连接后返回self_conn。所以病毒式的 self_conn 总是正确的，对吧？

# php - 使用 PHP imageCreateFromJpeg 复制图像并保留其 EXIF/IPTC 数据？

> ID：10182890
> 
> 赞同：15
> 
> 时间：2012-04-16T22:59:44.017
> 
> 标签：php, gd, exif, iptc

我对存储有 EXIF/IPTC 数据的图像有一些问题。
当我使用`imageCreateFromJpeg`（旋转/裁剪等）时，新存储的文件不会保留 EXIF/IPTC 数据。

我当前的代码如下所示：

```
<?php
// Before executing - EXIF/IPTC data is there (checked)
$image = "/path/to/my/image.jpg";
$source = imagecreatefromjpeg($image);
$rotate = imagerotate($source,90,0);
imageJPEG($rotate,$image);
// After executing  - EXIF/IPTC data doesn't exist anymore. 
?> 
```

难道我做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-16T23:14:23.093

您没有做错任何事情，但是 GD 根本不处理 IPTC 数据的 Exif，因为它超出了 GD 的范围。

您必须使用 3rd 方库或其他 PHP 扩展从源图像中读取数据并将其重新插入到由`imagejpeg`.

以下是一些感兴趣的库：[pel（php exif 库）](http://lsolesen.github.com/pel/)，php.net 上的一个示例，展示了如何[使用 pel](http://php.net/manual/en/function.exif-thumbnail.php#84777)来做你想做的事情，[php metadata toolkit](http://ozhiker.com/electronics/pjmt/)，[iptcembed() function](http://php.net/iptcembed)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2019-06-01T19:17:26.637

下面是一个使用 gd 缩放图像，以及使用 PEL 复制 Exif 和 ICC 颜色配置文件的示例：

```
function scaleImage($inputPath, $outputPath, $scale) {
    $inputImage = imagecreatefromjpeg($inputPath);
    list($width, $height) = getimagesize($inputPath);
    $outputImage = imagecreatetruecolor($width * $scale, $height * $scale);
    imagecopyresampled($outputImage, $inputImage, 0, 0, 0, 0, $width * $scale, $height * $scale, $width, $height);
    imagejpeg($outputImage, $outputPath, 100);
}

function copyMeta($inputPath, $outputPath) {
    $inputPel = new \lsolesen\pel\PelJpeg($inputPath);
    $outputPel = new \lsolesen\pel\PelJpeg($outputPath);
    if ($exif = $inputPel->getExif()) {
        $outputPel->setExif($exif);
    }
    if ($icc = $inputPel->getIcc()) {
        $outputPel->setIcc($icc);
    }
    $outputPel->saveFile($outputPath);
}

copy('https://i.stack.imgur.com/p42W6.jpg', 'input.jpg');
scaleImage('input.jpg', 'without_icc.jpg', 0.2);
scaleImage('input.jpg', 'with_icc.jpg', 0.2);
copyMeta('input.jpg', 'with_icc.jpg'); 
```

输出图像：

[![无ICC输出](../Images/227f4b9ada427a416e61e1c7d89ba0e0.png)](https://i.stack.imgur.com/gtsSl.jpg) [![使用复制的 ICC 输出](../Images/7495b0c62b4d910aa1342c4093f75d46.png)](https://i.stack.imgur.com/2Tmn3.jpg)

输入图像：

[![原始图像](../Images/2370a09dae4c8bda1af7135f77561b46.png)](https://i.stack.imgur.com/p42W6.jpg)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-08-11T19:20:27.310

@drew010 的回答是正确的，因为没有外部库或其他程序就无法做到这一点。然而，这个答案已经很老了，现在至少有两种很好的方法。@Thiago Barcala 使用 PEL 给出了一个答案。

这是一个完全不同的使用不同的工具，即[Paul Harvey 的 PERL 脚本 exiftool](https://exiftool.org/)。我更喜欢这个解决方案，因为 exiftool 的开发和使用历史更长，文档更好，对我来说似乎更稳定可靠。PEL 更新了近 10 年，API 不稳定，有项目易手的历史，还没有达到 1.0 版本。我尝试设置它并遇到了一些障碍，但没有找到克服它们的文档，而设置 exiftool 是开箱即用的。

安装 exiftool，然后在将旧图像保存*到新路径*后运行：

```
exec('exiftool -TagsFromFile /full/path/to/original_image.jpg /full/path/to/newly_saved_image.jpg'); 
```

您必须保留这两个文件才能正常工作；如果您像原始代码一样覆盖文件，则 EXIF 数据将丢失。

确保您`php.ini`允许 exec() 调用；有时出于安全原因不允许这样做。此外，请*注意*不要在传递给该调用的任何参数中允许任何用户生成的输入，因为它可能允许攻击者在 Web 服务器的权限下执行任意命令。如果您的脚本根据某些公式生成文件名，例如只有字母数字字符，具有固定的目录路径，则 exec 调用是最安全的，然后将它们提供给 exec 调用。

如果你不想全局安装 exiftool，你可以用`exiftool`它的完整路径替换。如果您使用的是 SELinux，请确保在文件上为 exiftool 脚本设置上下文`httpd_exec_t`以允许它由 Web 服务器执行，并确保整个脚本所在的目录具有上下文`httpd_sys_content_t`或其他允许访问的上下文由网络服务器。

# zend-framework - ZendFramework 图像未加载

> ID：10182892
> 
> 赞同：1
> 
> 时间：2012-04-16T22:59:57.057
> 
> 标签：zend-framework

我有一个正在 ZendFramework 中开发的网站，我的主页上有两张社交图片。当我第一次加载页面时，图像不存在，但是如果我然后单击一个链接，如果我再单击另一个链接进一步进入站点，它们会再次消失，图像在布局文件中的 div 中，它们应该是一直以来，布局文件中的所有其他内容都与这些不同。我一直在努力解决试图从标签的 src 属性中的数据库回显图像路径的问题，但无法让它工作然后我意识到这种情况正在发生，我假设它与社交图像问题有关，因为我希望数据库图像出现的页面也没有社交链接..

对不起，我真的不知道如何解释这个问题，希望它可以解决，如果您需要有关此问题的更多信息，请随时询问！

提前致谢！

里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:04:44.893

当您为`src`图像标签的属性回显图像的路径时，您应该使用[baseUrl 帮助](http://framework.zend.com/manual/en/zend.view.helpers.html#zend.view.helpers.initial.baseurl)程序，因此该路径始终是绝对的并引用您的基本 URL。

例如，你会打电话`<?php echo $this->baseUrl('images/test.png') ?>`，这将导致类似`/zendapp/public/images`or `/images`。

我怀疑正在发生的事情是图像标签看起来像这样：`<img src="images/thepic.png" />`。您应该确保所有图像、CSS、Javascript 引用等都使用绝对路径，例如`/images`和避免`../images`、、`./images`或`images`等。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T11:28:39.410

如果不使用本机视图辅助功能`$this->baseUrl()`。只需在图片网址前添加斜杠`<img src="/images/thepic.png" alt="Some description" width="" heigth="" />`

# android - 我可以让语音识别器无限期地收听吗？

> ID：10182893
> 
> 赞同：22
> 
> 时间：2012-04-16T23:00:08.430
> 
> 标签：android

当我调用对象的`startListening`方法时`SpeechRecognizer`，语音识别器开始监听语音。我想创建一个等待特定关键字语音的服务：当用户说出这个关键字并且语音识别器检测到这个关键字时，该服务就准备好接收用户语音命令。

为此，在一个新的`SpeechRecognizer`实例化之后，我应该调用它的`startListening`方法：我可以让语音识别器无限期地听吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-16T23:26:03.857

`Android Speech recognizer`可以通过意图额外数据进行定制。请参阅[安卓文档](http://developer.android.com/reference/android/speech/RecognizerIntent.html#EXTRA_SPEECH_INPUT_COMPLETE_SILENCE_LENGTH_MILLIS)。

> 公共静态最终字符串 **EXTRA_SPEECH_INPUT_COMPLETE_SILENCE_LENGTH_MILLIS**
> 
> 在我们停止听到语音后认为输入完成应该花费的时间。[...]
> 
> 公共静态最终字符串**EXTRA_SPEECH_INPUT_MINIMUM_LENGTH_MILLIS** 自：API 级别 8
> 
> 话语的最小长度。在这段时间之前，我们不会停止录制。[...]
> 
> 公共静态最终字符串**EXTRA_SPEECH_INPUT_POSSIBLY_COMPLETE_SILENCE_LENGTH_MILLIS**
> 
> 在我们停止听到语音后认为输入可能完成所需的时间。[...]

将[EXTRA_LANGUAGE_MODEL](http://developer.android.com/reference/android/speech/RecognizerIntent.html#EXTRA_LANGUAGE_MODEL)设置 为 websearch 以仅捕获相关单词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-06-06T17:49:44.080

您可以像这样实现`onError`接口`RecognitionListener`。它不断地倾听你的活动。

```
@Override
public void onError(int error) {
    String errorMessage = getErrorText(error);
    Log.i(Constants.TAG, "FAILED " + errorMessage);
    speech.destroy();
    speech = null;
    StartListening();
}

private void StartListening() {
    speech = SpeechRecognizer.createSpeechRecognizer(this);
    speech.setRecognitionListener(this);
    recognizerIntent = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
    recognizerIntent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_PREFERENCE, "en");
    recognizerIntent.putExtra(RecognizerIntent.EXTRA_CALLING_PACKAGE, this.getPackageName());
    recognizerIntent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, RecognizerIntent.LANGUAGE_MODEL_WEB_SEARCH);
    recognizerIntent.putExtra(RecognizerIntent.EXTRA_MAX_RESULTS, 3);

    //if setting.SpeechEnable
    speech.startListening(recognizerIntent);
} 
```

# perl - perl mockmodule fork

> ID：10182894
> 
> 赞同：3
> 
> 时间：2012-04-16T23:00:17.800
> 
> 标签：perl, mocking, fork

我正在尝试使用 mockmodule 模拟对 fork 的调用。我是这样设置的...

```
my $mock = Test::MockModule->new('Foo');
$modMock->mock(fork => sub { print "here"; return 0; }); 
```

我的模块是 Foo.pm。我有过将其他模块调用加载到被测模块中的经验，并且像这样模拟模块调用似乎效果很好。但是，我的模拟打印语句从未到达（并且调用了真正的分叉）。

这是模拟 fork 等系统调用的正确方法吗？我应该加载与被测系统不同的模块吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:52:19.957

您的代码正在为 name 分配一个子例程定义`&Foo::fork`，您始终可以通过调用完全限定的函数 name或在命名空间中`Foo::fork()`使用 sigil 来执行它。`&fork``Foo`

```
package Foo;
TestModule->new('Foo')->mock(fork => sub { ... });

Foo::fork;             # calls mocked function
&fork;                 # calls mocked function
{ package Bar; &fork } # error: no &Bar::fork
fork;                  # calls builtin 
```

覆盖内置函数，以便调用 bare`fork`调用您的函数而不是内置函数，“[只能通过在编译时从模块导入名称来完成](http://search.cpan.org/perldoc?perlsub)”。如果这很难理解，只需知道`subs`pragma 满足您的这个条件：

```
package Foo;
use subs 'fork'; # compile-time import of name 'fork'
TestModule->new('Foo')->mock(fork => sub { ... });

Foo::fork;             # calls mocked function
&fork;                 # calls mocked function
fork;                  # now calls mocked function
{ package Bar; fork; } # calls builtin 
CORE::fork;            # always calls builtin 
```

# jquery - tinysort jquery对两个项目进行排序

> ID：10182895
> 
> 赞同：1
> 
> 时间：2012-04-16T23:00:18.053
> 
> 标签：jquery, ruby-on-rails, jquery-ui, sorting, jquery-plugins

我想按距离和名称进行排序。

```
(id) ----name----  ----distance----
  1     store           2
  2     shop            3
  3     market          1
  4      bazaar         2

#view
<ul id="xanim">
    <% @objects.each do |obj| %>
        <li><h3><%= obj.distance %></h3><%= obj.distance %>
    <% end %>
</ul> 
```

使用 tinysort (http://tinysort.sjeiti.com)

```
#javascript
var $Ul = $('ul#xanim');
$Ul.css({position:'relative',height:$Ul.height(),display:'block'});
var iLnH;
var $Li = $('ul#xanim>li');
$Li.each(function(i,el){
    var iY = $(el).position().top;
    $.data(el,'h',iY);
    if (i===1) iLnH = iY;
});
$Li.tsort('h3:eq(0)',{order:'asc'}).each(function(i,el){
    var $El = $(el);
    var iFr = $.data(el,'h');
    var iTo = i*iLnH;
    $El.css({position:'absolute',top:iFr}).animate({top:iTo},500);
}); 
```

仅按一列（例如，仅按距离订购：市场，商店，集市，商店）时，我的排序就很好。但是，如果两个距离相等，我还想按名称排序（例如，距离然后名称：市场、集市、商店、商店）。

如果第一个组件相等，我如何按次要组件排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:24:08.833

在 tinysort 中还不能进行多重排序。但它将是：[http ://code.google.com/p/tinysort/issues/detail?id=23](http://code.google.com/p/tinysort/issues/detail?id=23)

有一天：/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:06:08.753

您需要一个稳定的排序算法 (http://www.algorithmist.com/index.php/Stable_Sort)。首先按您的次要组件（名称）排序，然后按主要组件（距离）。稳定排序将确保具有相同距离的元素仍然按名称排序。

# ruby-on-rails - 带有 rails 和 mongoLAB 的 Heroku 项目

> ID：10182897
> 
> 赞同：0
> 
> 时间：2012-04-16T23:00:29.583
> 
> 标签：ruby-on-rails, mongodb, heroku, mlab

我有一个快速的问题。我也是rails和heroku的新手。我最近从以下 git 存储库 git://github.com/barmstrong/ribbot.git 下载了一个开源代码。我正在使用 mongo db 运行 rails 并设置了环境。决定使用 heroku 作为我的服务器解决方案，我已经在 mongoLAB 上下载了插件，但是当我尝试运行代码时，出现以下错误。但是，我可以在本地机器上顺利运行它。

```
2012-04-16T22:51:04+00:00 heroku[api]: Add-on add mongolab:starter by *******@hotmail.com
2012-04-16T22:51:04+00:00 heroku[api]: Release v2 created by *******@hotmail.com
2012-04-16T22:51:21+00:00 heroku[slugc]: Slug compilation started
2012-04-16T22:53:20+00:00 heroku[api]: Add-on add shared-database:5mb by *******@hotmail.com
2012-04-16T22:53:20+00:00 heroku[api]: Release v3 created by *******@hotmail.com
2012-04-16T22:53:21+00:00 heroku[api]: Config add RAILS_ENV, LANG, PATH, RACK_ENV, GEM_PATH by *******@hotmail.com
2012-04-16T22:53:21+00:00 heroku[api]: Release v4 created by *******@hotmail.com
2012-04-16T22:53:21+00:00 heroku[api]: Release v5 created by *******@hotmail.com
2012-04-16T22:53:21+00:00 heroku[api]: Deploy fe1b768 by *******@hotmail.com
2012-04-16T22:53:21+00:00 heroku[web.1]: State changed from created to starting
2012-04-16T22:53:22+00:00 heroku[slugc]: Slug compilation finished
2012-04-16T22:53:34+00:00 heroku[web.1]: Starting process with command `bundle exec rails server -p 44817`
2012-04-16T22:54:06+00:00 app[web.1]: [2012-04-16 22:54:06] INFO  WEBrick 1.3.1
2012-04-16T22:54:06+00:00 app[web.1]: [2012-04-16 22:54:06] INFO  ruby 1.9.2 (2011-07-09) [x86_64-linux]
2012-04-16T22:54:06+00:00 app[web.1]: [2012-04-16 22:54:06] INFO  WEBrick::HTTPServer#start: pid=1 port=44817
2012-04-16T22:54:08+00:00 heroku[web.1]: State changed from starting to up
2012-04-16T22:54:57+00:00 app[web.1]: => Booting WEBrick
2012-04-16T22:54:57+00:00 app[web.1]: => Rails 3.1.1 application starting in production on http://0.0.0.0:44817

2012-04-16T22:54:57+00:00 app[web.1]: => Ctrl-C to shutdown server
2012-04-16T22:54:57+00:00 app[web.1]: localhost:11211 failed (count: 0)
2012-04-16T22:54:57+00:00 app[web.1]: 
2012-04-16T22:54:57+00:00 app[web.1]: 
2012-04-16T22:54:57+00:00 app[web.1]: Started GET "/" for 208.124.140.154 at 2012-04-16 22:54:57 +0000
2012-04-16T22:54:58+00:00 app[web.1]: cache: [GET /] miss
2012-04-16T22:54:58+00:00 app[web.1]:   Processing by PostsController#index as HTML
2012-04-16T22:54:58+00:00 app[web.1]: Redirected to http://herokuapp.com/forums
2012-04-16T22:54:58+00:00 app[web.1]: Completed 302 Found in 114ms
2012-04-16T22:54:58+00:00 heroku[router]: GET impact-project.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=885ms status=302 bytes=93
2012-04-16T22:55:14+00:00 app[web.1]: localhost:11211 failed (count: 1)
2012-04-16T22:55:14+00:00 app[web.1]: localhost:11211 is down
2012-04-16T22:55:14+00:00 app[web.1]: 
2012-04-16T22:55:14+00:00 app[web.1]: 
2012-04-16T22:55:14+00:00 app[web.1]: Started GET "/" for 208.124.140.154 at 2012-04-16 22:55:14 +0000
2012-04-16T22:55:14+00:00 app[web.1]: cache: [GET /] miss
2012-04-16T22:55:14+00:00 app[web.1]:   Processing by PostsController#index as HTML
2012-04-16T22:55:14+00:00 app[web.1]: Redirected to http://herokuapp.com/forums
2012-04-16T22:55:14+00:00 app[web.1]: Completed 302 Found in 11ms
2012-04-16T22:55:14+00:00 heroku[router]: GET impact-project.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=528ms status=302 bytes=93
2012-04-16T22:55:57+00:00 app[web.1]: localhost:11211 failed (count: 2)
2012-04-16T22:55:57+00:00 app[web.1]: 
2012-04-16T22:55:57+00:00 app[web.1]: 
2012-04-16T22:55:57+00:00 app[web.1]: Started GET "/" for 208.124.140.154 at 2012-04-16 22:55:57 +0000
2012-04-16T22:55:57+00:00 app[web.1]: cache: [GET /] miss
2012-04-16T22:55:57+00:00 app[web.1]:   Processing by PostsController#index as HTML
2012-04-16T22:55:57+00:00 app[web.1]: Redirected to http://herokuapp.com/forums
2012-04-16T22:55:57+00:00 app[web.1]: Completed 302 Found in 4ms
2012-04-16T22:55:57+00:00 heroku[router]: GET impact-project.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=549ms status=302 bytes=93 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T15:09:28.187

我怀疑您`localhost:11211`在 Mongo 驱动程序配置中的某个地方进行了硬编码，或者没有指定使用`MONGOLAB_URI`环境中的值。

有关 MongoLab 附加文档，请参见此处：[https](https://devcenter.heroku.com/articles/mongolab) ://devcenter.heroku.com/articles/mongolab关于使用环境变量中的值的部分在这里：[https ://devcenter.heroku.com/articles/mongolab# connecting_your_heroku_application_to_your_mongodb_database](https://devcenter.heroku.com/articles/mongolab#connecting_your_heroku_application_to_your_mongodb_database)并且是特定于驱动程序的。

希望有帮助。

# c# - 这个 Nullable 的理由是什么 隐式转换运算符的行为

> ID：10182898
> 
> 赞同：33
> 
> 时间：2012-04-16T23:00:32.667
> 
> 标签：c#, .net, nullable, implicit-conversion

`Nullable`我在和隐式转换之间的交互中遇到了一些有趣的行为。我发现为引用类型从值类型提供隐式转换，它允许`Nullable`在我期望编译错误时将该类型传递给需要引用类型的函数。下面的代码演示了这一点：

```
static void Main(string[] args)
{
    PrintCatAge(new Cat(13));
    PrintCatAge(12);
    int? cat = null;
    PrintCatAge(cat);
}

private static void PrintCatAge(Cat cat)
{
    if (cat == null)
        System.Console.WriteLine("What cat?");
    else
        System.Console.WriteLine("The cat's age is {0} years", cat.Age);
}

class Cat
{
    public int Age { get; set; }
    public Cat(int age)
    {
        Age = age;
    }

    public static implicit operator Cat(int i)
    {
        System.Console.WriteLine("Implicit conversion from " + i);
        return new Cat(i);
    }
} 
```

输出：

```
The cat's age is 13 years
Implicit conversion from 12
The cat's age is 12 years
What cat? 
```

如果从中删除转换代码，`Cat`则会收到预期的错误：

`Error 3 The best overloaded method match for 'ConsoleApplication2.Program.PrintCatAge(ConsoleApplication2.Program.Cat)' has some invalid arguments`

`Error 4 Argument 1: cannot convert from 'int?' to 'ConsoleApplication2.Program.Cat`

如果您使用 ILSpy 打开可执行文件，则生成的代码如下

```
int? num = null;
Program.PrintCatAge(num.HasValue ? num.GetValueOrDefault() : null); 
```

在一个类似的实验中，我删除了转换并添加了一个重载，`PrintCatAge`它需要一个 int（不可为空）来查看编译器是否会执行类似的操作，但事实并非如此。

我明白发生了什么，但我不明白这样做的理由。这种行为对我来说是出乎意料的，而且看起来很奇怪。我在 MSDN 上的转换文档或`Nullable<T>`.

我提出的问题是，这是故意的吗？是否有解释为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-16T23:24:57.670

我之前说过（1）这是一个编译器错误，（2）这是一个新错误。第一个陈述是准确的；第二个是我在匆忙准时到达公共汽车时感到困惑。（我想到的这个错误对我来说是新的，它是一个更复杂的错误，涉及提升转换和提升增量运算符。）

这是一个长期存在的已知编译器错误。Jon Skeet 前段时间第一次引起了我的注意，我相信在某个地方有一个 StackOverflow 问题；我不记得在哪里随手。也许乔恩会。

所以，这个错误。让我们定义一个“提升”运算符。如果运算符从不可为空的值类型 S 转换为不可为空的值类型 T，那么还有一个从 S? 转换的“提升”运算符？到 T?，这样一个空的 S? 转换为空 T? 和一个非空 S？转换为 T? 通过展开 S? 到 S，将 S 转换为 T，并将 T 包装为 T?。

规范说（1）存在提升运算符的*唯一*情况是当 S 和 T 都是不可为空的值类型时，以及（2）提升和非提升转换运算符都*被*认为是否它们是转换的适用候选者，如果两者都适用，则适用转换的源类型和目标类型（已提升或未提升）用于确定最佳源类型、最佳目标类型，并最终确定所有适用转换的最佳转换。

不幸的是，实现完全违反了所有这些规则，并且这样做的方式是我们无法在不破坏许多现有程序的情况下进行更改。

首先，我们违反了提升运算符存在的规则。如果 S 和 T 都是不可为空的值类型，或者如果 S 是不可为空的值类型并且 T 是可以分配空值的任何类型，则实现认为存在提升的运算符：引用类型，可空值类型或指针类型。在所有这些情况下，我们都会产生一个提升的运算符。

在您的特定情况下，我们通过检查 null 将可空类型转换为引用类型 Cat 来提升为可空。如果源不为空，那么我们正常转换；如果是，那么我们生成一个空 Cat。

其次，我们彻底违反了当其中一个候选者是提升运算符时如何确定适用候选者的最佳源和目标类型的规则，并且我们也违反了确定哪个是最佳运算符的规则。

简而言之，如果不破坏真正的客户，就无法解决这个问题，因此我们可能会将这种行为奉为 Roslyn。我会考虑在某个时候在我的博客中记录编译器的确切行为，但如果我是你，我不会在等待那一天时屏住呼吸。

当然，许多人为这些错误道歉。

# jquery - 淡化幻灯片 Jquery 问题

> ID：10182900
> 
> 赞同：0
> 
> 时间：2012-04-16T23:00:50.953
> 
> 标签：jquery, html, slideshow

我创建了一个幻灯片，使用具有淡入淡出效果的 jquery，幻灯片的问题是如果我添加图像，它会正确显示，但是如果我添加文本而不是图像，文本会从下到上弹跳，我希望它被修复在上面。实际上这个问题很可能是因为，我正在做的是，我有六个`li`我首先启用`li`并禁用休息，现在我给第一个淡出效果和下一个淡入`li`效果`li`，现在到第一个`li`淡出和下一个`li`淡出在那个时候，文本反弹，但我不明白为什么图像不会发生这种情况，这是我的完整代码。

您可以[下载完整的项目](http://gp.stage.asentechdev1.com/slider.rar)并查看

当前 div 包含图像，如果将其替换为 h1 元素，则可以看到错误的输出

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:34:58.793

所以使用 jquery.cycle，设置淡入淡出效果就像下面这样简单。您的 HTML 应该类似于：

```
<div id="slideshow">
    <div class="slide">
        <p>Some text</p>
        <img ... />
    </div>
    <div class="slide">
        <p>Some text</p>
        <img ... />
    </div>
    <!-- more slides ... -->
</div> 
```

那么你的javascript是：

```
$('#slideshow').cycle({
    fx:'fade',
    slideExpr: '.slide'
}); 
```

淡入淡出效果 (fx) 是循环插件中的标准效果。 `slideExpr`定义一个 jquery 选择器来选择幻灯片的主（在本例中`#slideshow`）包装器中的幻灯片元素。

# javascript - CSS On悬停动态宽度背景图像

> ID：10182909
> 
> 赞同：0
> 
> 时间：2012-04-16T23:02:40.167
> 
> 标签：javascript, css, hover

我正在尝试在我的网站上的导航上创建鼠标悬停效果。导航是一个水平条，其中包含一些项目。下面的代码；

```
<ul>
  <li><a href="#">Home</a></li>
  <li><a href="#">About us</a></li>
  <li><a href="#">Our work and portfolio</a></li>
  <li><a href="#">Contact</a></li>
</ul> 
```

这有一个简单的背景颜色，每个之间`<li>`是一个边框来分隔项目。现在我想在悬停时给出一个背景图像，尽管我的问题是 - 正如你所看到的 - 每个`<li>`都有不同的宽度，因为它的内容和我的悬停图像如下；

![悬停效果](../Images/f8ed02163c7d464cb7260947c9ea8b27.png)

所以它实际上只是左右两侧的黑色阴影。右阴影必须放在绝对右侧，`<li>`而左阴影必须放在绝对左侧。

有什么办法可以做到这一点？如果使用 jQuery 或类似的东西，这不是问题。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:15:51.350

您的图像看起来像[线性渐变](https://developer.mozilla.org/en/CSS/linear-gradient)，因此您可以尝试使用

```
background-image: linear-gradient(to right, #111, #333, #111); 
```

您可能想要添加对旧浏览器的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:06:47.473

如果你想要阴影，以及变长效果。然后将图像分成三部分。并将您的标记更新为这样的内容

1.  左影
2.  中心部分
3.  右影

然后使用以下 CSS 片段

```
li a:hover:before { content: url("image/leftshadow.jpg"); }
li a:hover { background-Image: url("image/center.jpg"); }
li a:hover:after { content: url("image/rightshadow.jpg"); } 
```

# facebook - 未调用 fbDidLogin 或 fbDidNotLogin

> ID：10182912
> 
> 赞同：0
> 
> 时间：2012-04-16T23:03:19.893
> 
> 标签：facebook, sos, facebook-ios-sdk

我正在尝试将 facebook 登录集成到我现有的应用程序中。我在 AppDelegate.m 中有 openURL 和 handleOpenURL 方法，但我在单击按钮时在其中一个视图控制器中初始化 facebook 对象。所以我的 fbDidLogin 方法在 viewController 中，它永远不会被调用。也没有调用 fbDidNotLogin。

我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T08:09:47.887

而且我忘记在 AppDelegate 中实现唯一的方法：

```
- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url {
    return [[FacebookService sharedInstance].facebook handleOpenURL:url];
} 
```

FacebookService - 是我的包装单音类，包含实例 og facebook 错误是一样的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:15:23.267

[我遇到了同样的问题，这是因为我没有像教程http://developers.facebook.com/docs/mobile/ios/build/#register](http://developers.facebook.com/docs/mobile/ios/build/#register)中所说的那样在 info.plist 中设置 URL 类型

# html - 自定义引导按钮颜色背景错误 onclick

> ID：10182917
> 
> 赞同：0
> 
> 时间：2012-04-16T23:04:03.707
> 
> 标签：html, css, twitter-bootstrap, less

在 Twitter Bootstrap 中有一系列可供选择的按钮（如下所示：http: [//twitter.github.com/bootstrap/components.html](http://twitter.github.com/bootstrap/components.html)）。对于我们的项目，我们选择使用默认设置中未包含的黄色。简单地创建一个包含我想要的颜色的新 css 类。但是，当按下按钮时，背景颜色会恢复为默认的灰色背景颜色，而不是单击其他按钮时所看到的类似背景颜色。在创建按钮的过程中我错过了什么吗？

问题示例（取自FF）：

![按钮示例](../Images/bc5c3009bafc498d9fc17a91b15cf78d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:11:22.513

您需要使用 :active 伪选择器指定新颜色。当您按下按钮时，它会“激活”并且 :active 选择器开始发挥作用。当您释放鼠标按钮时，元素停止活动并且元素样式恢复正常。有点像 :hover 伪选择器，当您将指针悬停在某物上时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T03:42:44.853

我通过谷歌找到了这个问题。推荐一篇文章，一定要帮忙 **http://rubysource.com/how-to-customize-twitter-bootstrap%E2%80%99s-design-in-a-rails-app/**

# python - python 与 sqlite3

> ID：10182918
> 
> 赞同：1
> 
> 时间：2012-04-16T23:04:09.417
> 
> 标签：python, database, sqlite, command

现在我正在尝试将 python 用于 sqlite3。我的问题是，我不知道如何用 python 读取现有的“abc.db”。我的意思是我只知道 abc.db 是一个 sqlite3 文件。但是我不知道它的结构，我也需要从这个abc.db中获取信息。

我用了 ：

```
import sqlite3
try:  
        sqlite_conn = sqlite3.connect('abc')  
except sqlite3.Error, e:  
         print 'conntect sqlite database failed.'  
         sqlite_logger.error("conntect sqlite database failed, ret = %s" % e.args[0]) 
```

那么，接下来我能做什么？我需要阅读abc，如果可能的话，我想直接在终端上输出内容。可能吗？因为我需要分析这个文件中的数据。非常感谢！！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T23:14:26.427

在您的 sqlite_conn 对象中，您可以运行以下命令

```
cur = sqlite_conn.cursor()

cur.execute("SELECT name FROM sqlite_master WHERE type='table'")

    rows = cur.fetchall()

    for row in rows:
        print row[0] 
```

然后你可以`SELECT * from <Tablename>`为每个表做一个。sqlite_master 在这里是一个 sqlite 元数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:10:06.453

使用命令行 sqlite3 客户端，您可以使用以下命令查看未知数据库的架构：

```
.schema 
```

然后用 SQL 稍微研究一下，以更好地了解其中的数据。

# ruby-on-rails - 如何在 Rails 3 中创建自定义脚手架生成器？

> ID：10182919
> 
> 赞同：5
> 
> 时间：2012-04-16T23:04:12.850
> 
> 标签：ruby-on-rails, ruby

有这些railscasts。

[http://railscasts.com/episodes/218-making-generators-in-rails-3](http://railscasts.com/episodes/218-making-generators-in-rails-3)通过这篇文章，您将了解如何创建样式表和脚手架生成器。

[http://railscasts.com/episodes/216-generators-in-rails-3](http://railscasts.com/episodes/216-generators-in-rails-3)通过这个，您将了解如何添加一些文件来修改脚手架视图。

我想做两者的混合。我想创建一个还创建脚手架视图的生成器。有点像 Ryan Bates 漂亮的生成器或 web_app_theme gem (https://github.com/pilu/web-app-theme)。我一直在寻找教程或一些信息来为我指明正确的方向，但我找不到我正在寻找的确切内容。

我知道我很接近了。我已经知道如何使用 Railcast 218 创建生成器，但现在，如何让它也创建视图文件？

我想运行这样的命令...

```
rails g my_scaffold_generator Post title:string body:text 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T15:20:37.907

这可能为时已晚，无法提供帮助，但正如我在谷歌搜索相同信息时发现的那样......

在我看来，最好的方法，至少对于学习绳索，是复制然后改变现有的脚手架生成器。

所以让我绊倒的第一件事是找到默认模板，它们不在您的`rails-3.2.0`目录（或您使用的任何版本）中，而是在`railties-3.2.0`. 因此，对于我基于 RVM 的安装，它们位于：

```
/Users/leo/.rvm/gems/ruby-1.9.3-p194@gemset/gems/railties-3.2.0/lib/rails/generators/ 
```

*[注意：您的 gems 目录可能完全在其他地方，用于`$> gem environment`查找您的 gem 路径]*

这里`erb/scaffold/templates/`有你期望的文件（`new.html.erb`等`_form.html.erb`）。

您可以将这些文件复制到应用程序的根目录中，`lib/templates/erb/scaffold/`然后将使用它们而不是默认文件。

如果您想在自定义生成器中使用这些，有两种方法：

1) 用于`hook_for`从您的生成器中调用常规的 ERB 脚手架生成器。

2) 在您自己的自定义生成器中移动/处理模板，使用[Thor](http://rdoc.info/github/wycats/thor/master/Thor/Actions.html)`copy_file`中的类似方法将它们移动到位。

对此有一个不错的[Rails 指南](http://guides.rubyonrails.org/generators.html#first-contact)，尽管我发现直到我开始深入研究`.../railties-3.2.0/lib/rails/generators/...`并查看默认值的结构时才真正了解它。

# c++ - 使用哪一个，utf8 或 Ascii

> ID：10182920
> 
> 赞同：0
> 
> 时间：2012-04-16T23:04:14.340
> 
> 标签：c++, qt, utf-8, ascii

一直在用 Qt 做很多工作，它让我很震惊，我应该使用哪一个来将我的 QStrings 转换为 QByteArray 并返回？还有一些其他问题我不知道该怎么做。

例如在处理 QUrl 时。我有一个对象，其中成员之一是 QString，我将其设置如下：

```
blobByType->setBlobAbsoluteUri(request.url().toEncoded()); 
```

将其`toEncoded()`转换为 utf8，然后所有非 ASCII 字符都进行百分比编码。然后，当我将 QString 设置为 QByteArray 时，它会自动将其转换为 Ascii。

此外，当我从 QString 转换为 QByteArray 时，我目前使用 toUtf8()。

我的问题是，从 QString 转换为 QByteArray 时应该使用什么，反之亦然？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T23:10:28.420

处理英文字符时，UTF-8 和 ASCII 通常是完全一样的。不同之处在于，如果您曾经使用非英文字符，UTF-8 将能够支持它，而 ASCII 则不会。我建议使用 UTF-8 只是为了安全起见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T23:08:07.183

如果您有机会使用非英文字符，最好使用 UTF-8。使用它是标准且良好的做法，因为您永远不知道将来谁可能会重用您的代码。

# c# - C#如何在按钮数组按钮上添加图像

> ID：10182921
> 
> 赞同：0
> 
> 时间：2012-04-16T23:04:21.343
> 
> 标签：c#, asp.net, visual-studio

如何在按钮阵列的按钮上添加图像？

```
Button[] mybuttons = new Button[] {Button1,Button2}; //My button array

mybuttons[1].image=new Bitmap("Click.jpg"); ///Gives Error 
```

“System.Web.UI.WebControls.Button”不包含“Image”的定义，并且找不到接受“System.Web.UI.WebControls.Button”类型的第一个参数的扩展方法“Image”（你是缺少 using 指令或程序集引用？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:15:26.317

C# 区分大小写。此外，您需要使用[ImageButton](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.imagebutton.aspx)并为其提供 ImageUrl，而不是[Button](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.aspx)。Web 控件 Button 没有 Image 属性。

# visual-studio - 具有多个子域的 Visual Studio 本地 IIS Web 服务器项目 URL

> ID：10182922
> 
> 赞同：4
> 
> 时间：2012-04-16T23:04:24.940
> 
> 标签：visual-studio, iis, iis-7, subdomain

我想尝试在我的本地机器上测试 ASP.Net MVC 网站的虚拟主机。在MVC 项目属性文件的**Web**选项卡的Visual Studio 中，我选择了**Use Local IIS Web Server**。通过“虚拟主机”，我真正的意思是我试图确保页面为[http://sub-domain-i.my-domain.com/MyMvcProject/Controller/Action](http://sub-domain-i.my-domain.com/MyMvcProject/Controller/Action)形式的 url 正确加载，我希望在其中测试多个子域来代替子域-i。在生产中，一切都将在一台服务器上的单个 IP 地址下运行。我还希望使用通配符 ssl 证书测试 https 的这种形式的 url，但目前我无法将 Visual Studio 配置为仅测试常规 http。在担心子域之前，****我的 MVC 项目的属性文件夹的Web选项卡中的****项目 URL**字段显示“http://localhost/MyMvcProject”，一切正常。但是，将其更改为“http://sub-domain-1.my-domain.com/MyMvcProject”，然后将以下行添加到我的 C:\Windows\System32\drivers\etc\hosts 文件中，**

 **```
127.0.0.1    sub-domain-1.my-domain.com 
```

Visual Studio 产生错误“无法创建虚拟目录 [。http://sub-domain-1.my-domain.com/MyMvcProject](http://sub-domain-1.my-domain.com/MyMvcProject) ”。有谁知道我可能做错了什么？

提前谢谢了！

**编辑：** 我刚刚发现，如果我选择**Use Custom Web Server**而不是**Use Local IIS Web server**，它可以工作，并且我不会从 Visual Studio 收到弹出错误。不过，我仍然不确定为什么这个解决方案有效，或者我通过选择**使用自定义 Web 服务器**做错了什么......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-12T13:45:56.433

有点晚了，但我希望它可以帮助某人。

您需要先在 IIS 网站中创建绑定，然后才能将其添加到项目的项目 url。该绑定必须像

http | 子域-1.my-domain.com | 80 | * 或 127.0.0.1

[如何创建绑定](http://www.iis.net/configreference/system.applicationhost/sites/site/bindings/binding)**

# c# - 无法使转换器工作

> ID：10182923
> 
> 赞同：1
> 
> 时间：2012-04-16T23:04:28.913
> 
> 标签：c#, wpf, binding, ivalueconverter

我正在尝试学习如何使用 IValueConverter。我有以下转换器：

```
[ValueConversion(typeof(string), typeof(string))]
public class RequiredFieldConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value == null)
            return "";

        return value.ToString() + "*";
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value == null)
            return "";
        var str = value.ToString();
        return str+"Convert Back testing";
    }
} 
```

我在 app.xaml 文件中添加了RequiredFieldConverter 资源，我想尝试如下：

```
<TextBox Name="textBox2"  Width="120" />
<TextBox Text="{Binding ElementName=textBox2, Path=Text, Converter=RequiredFieldConverter}" Name="textBox3" Width="120" /> 
```

我希望当我在 textbox2 中键入“hello”时，它会在 textbox3 中显示“hello*”，但它不起作用。事实上，我在运行时收到以下异常：

> {“无法将“System.String”类型的对象转换为“System.Windows.Data.IValueConverter”类型。”}

我也知道值转换器功能正在工作，因为它在我这样做时工作：

```
 Content="{Binding Source={StaticResource Cliente}, Converter={StaticResource RequiredFieldConverter}}" 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-16T23:09:57.360

...当它试图解释`RequiredFieldConverter`为**对**`IValueConverter`. 您**需要**使用`StaticResource`or`DynamicResource`来引用转换器，就像您在第二个示例中所做的那样。

```
<TextBox Text="{Binding ElementName=textBox2, Path=Text, Converter={StaticResouce RequiredFieldConverter}}" Name="textBox3" Width="120" /> 
```

# nhibernate - 如何在 NHibernate 中使用 QueryOver 从连接中检索实体

> ID：10182930
> 
> 赞同：1
> 
> 时间：2012-04-16T23:05:15.270
> 
> 标签：nhibernate, queryover

我正在尝试从 QueryOver 查询中返回多个实体。我在纯文本编辑器中编写此代码，因此可能存在语法错误，但它应该可以理解这个想法。

```
public class Product
{
    public virtual int ID { get; set; }
    public virtual string ProductName { get; set; }
    public virtual List<Category> Categories { get; set; }
    public virtual List<Inventory> Inventories { get; set; }
    ...
}

public class Category
{
    public virtual int ID { get; set; }
    public virtual string CategoryName { get; set; }
    public virtual string Style { get; set; }
    public virtual Product Product { get; set; }
    ...
}

public class Inventory
{
    public virtual int ID { get; set; }
    public virtual List<Discount> Discounts { get; set; }
    public virtual Product Product { get; set; }
    public virtual bool InStock { get; set; }
    ...
}

public class Discount
{
    public virtual int ID { get; set; }
    public virtual Inventory Inventory { get; set; }
    public virtual decimal DiscountAmount { get; set; }
    ...
} 
```

现在我的目标是在单个查询中使用产品 ID 和其他几个选项来拉回类别、库存和折扣金额。我已经通过这个查询使用 HQL 来实现它：

```
var query = session.CreateQuery("select category, inventory, discount.DiscountAmount"
    + " from Product product"
    + " join product.Categories category"
    + " join product.Inventories inventory"
    + " left join inventory.Discounts discount"
    + " where product.ID = :productID"
    + " and category.Style = :style"
    + " and inventory.InStock = 1"); 
```

通过这个查询，我得到一个对象数组列表，每个对象数组都有一个 Category 实体、Inventory 实体和一个 DiscountAmount 小数。我的目标是使用 QueryOver 查询来执行相同的查询而不使用魔法字符串，但我无法让它工作。这是我到目前为止所尝试的：

```
Product productAlias = null;
Category categoryAlias = null;
...
var query = session.QueryOver<Product>(() => productAlias)
    .Where(() => productAlias.ID == productID)
    .JoinAlias(() => productAlias.Categories, () => categoryAlias)
    ...
    .Select(Projections.Property(() => categoryAlias.ID),
        Projections.Property(() => discountAlias.Inventory),
        Projections.Property(() => discount.DiscountAmount)); 
```

此查询仅拉回 Category 的 ID，虽然它确实拉回了完整的 Inventory 实体，但它使用完整的附加数据库查询来获取它。

```
 ...
    .Select(Projections.Property(() => categoryAlias),
        Projections.Property(() => inventoryAlias),
        Projections.Property(() => discountAlias.DiscountAmount)); 
```

此查询引发“无法解析属性：categoryAlias of : Product”的运行时异常。

```
 ...
    .Select(Projections.Property(() => categoryAlias.ID).WithAlias(() => ReturnClass.Category),
        Projections.Property(() => inventoryAlias.ID).WithAlias(() => ReturnClass.Inventory),
        Projections.Property(() => discountAlias.DiscountAmount).WithAlias(() => ReturnClass.DiscountAmount))
    .TransformUsing(Transformers.AliasToBean<ReturnClass>()); 
```

此查询引发“无法将 Int32 类型的对象转换为 Category 类型”的运行时异常。

```
 ...
    .Select(Projections.Property(() => categoryAlias.ID)
    .TransformUsing(Transformers.AliasToBean<Category>()) 
```

此查询返回默认类别实体。

那么有什么方法可以使用 QueryOver API 来模拟 HQL 查询，还是我唯一的选择是在 HQL 或进行多个查询之间进行选择？

编辑：为了更清楚，我真的想尽可能避免使用魔法字符串，所以我真的更喜欢强类型的 QueryOver 查询。目前我正在使用一个 QueryOver 查询，它返回 Category 和 Inventory 实体的 ID，然后分别查询它们，但由于无论如何我必须在第一个查询中点击这些表，我宁愿一次性返回它们。

编辑 2：我想要实现的确切 SQL 是

```
Select Category.ID, Category.CategoryName, Category.Style, (other Category columns),
Inventory.ID, Inventory.InStock, (other Inventory columns),
Discount.DiscountAmount
From Products as Product
Inner join Categories as Category ...
Where Product.ID = @productID
And Category.Style = @style
And ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T17:37:35.403

因此，这是一个“渴望”为我的类别加载所有子类别的示例。迭代类别集合时没有 N+1。未来是这里的关键。

```
Category catalias = null;

        var subCategories =_session.QueryOver<Category>().JoinQueryOver(x => x.SubCategories, () => catalias, JoinType.LeftOuterJoin).
            Future<Category>();

        var categories = _session.QueryOver<Category>().Where(x => x.ParentCategoryId == null).Future<Category>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T08:31:09.437

我认为您应该使用 Fetch 而不是 JoinAlias：

```
.Fetch(product => product.Categories).Eager 
```

并且不要使用 select: `.List<Product>()`// 然后通过 LINQ，您可以从 Product 获取类别和库存

# java - 如何在没有运行 mySQL 服务器的情况下记录来自 JDBC 调用的 SQL 语句？

> ID：10182936
> 
> 赞同：0
> 
> 时间：2012-04-16T23:05:58.047
> 
> 标签：java, logging, jdbc, jdbctemplate, spring-jdbc

所以，我试图弄清楚如何记录将要运行的 SQL 语句，而实际上没有一个活动的 mySQL 服务器。

我要解决的问题是现在我们正在将数据写入远程 mySQL 实例以及本地（存档数据）。我们正在登录到本地作为备份，以防远程无法访问/关闭/等。

所以，我们想做的是在本地记录 SQL 语句（我们正在使用带有变量替换的 Spring JDBC 模板），所以不像我们自己拼凑 SQL 并将其写入文件那么容易.

我确实发现[log4jdbc](http://code.google.com/p/log4jdbc/)看起来很棒，但我们仍然需要一个活动的本地 mySQL 实例，即使它只是使用黑洞引擎。我确实认为也许我们可以只在远程服务器上使用 log4jdbc，但是如果连接消失，JDBCTemplate 是否会在失败之前尝试在底层 JDBC 驱动程序对象上运行查询？大多数池化机制会在返回连接之前验证连接，因此在查询有机会运行并被记录之前它仍然会失败。

那么，谁有什么好主意呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T00:22:50.423

[在启用 bin 日志记录](http://dev.mysql.com/doc/refman/5.6/en/replication-howto-masterbaseconfig.html)的情况下运行远程 MySQL 实例。

可以备份[二进制日志](http://dev.mysql.com/doc/refman/5.6/en/binary-log.html)，如有必要，可以使用[mysqlbinlog](http://dev.mysql.com/doc/refman/5.6/en/mysqlbinlog.html)命令将其转换为 SQL，以便稍后恢复数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T21:50:28.250

Mark O'Connors 解决方案通常可能是最好的解决方案，但我们解决此问题的方法是将数据简单地写为 CSV 文件格式，以便通过 load data infile 语句准备好导入。

# java - 从会话范围检索 @Named 托管 bean

> ID：10182943
> 
> 赞同：1
> 
> 时间：2012-04-16T23:07:17.227
> 
> 标签：java, jsf, java-ee-6, cdi

我对新的 JEE6 CDI 规范有疑问，特别是 @Inject 与`@Named`似乎已经取代了 jsf 特定`@ManagedBean`（用于注册资源）和`@ManagedProperty`（用于注入）注释的注释结合使用。

假设您有一个 bean 类“ `User`”注释`@ManagedBean @SessionScoped`，并且该类的一个对象被注入到任何 bean 中，`@ManagedProperty`然后当这个对象被创建和注入时，它也被放入会话中，我可以访问会话（例如在过滤器中）并检索对象使用：

```
User user = (User)((HttpServletRequest) request).getSession().getAttribute("user"); 
```

因此，如果我尝试使用相同的逻辑（在 glassfish 3.1.2 中）`@Named @SessionScoped`，然后`@Inject`我可以确认会话中没有这种类型的对象`User`，但这是我在会话中找到的：

```
属性名称：org.jboss.weld.context.conversation.ConversationIdGenerator    
属性值：org.jboss.weld.context.conversation.ConversationIdGenerator@b374765

属性名称：org.jboss.weld.context.ConversationContext.conversations            
属性值：{}

```

我在哪里做错了？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:43:21.190

如果使用 注释 bean `@SessionScoped`，则基本上是将其生命周期绑定到 HttpSession。这并不意味着 bean 被物理注入到会话对象中。

> 假设您有一个带有 @ManagedBean @SessionScoped 注释的 bean 类“用户”，并且使用 @ManagedProperty 将此类的对象注入到任何 bean 中，那么当创建并注入该对象时，它也被放入会话中，我可以访问会话（对于过滤器中的示例）并使用以下方法检索对象：

非常重要：不要混合 JSF 和 CDI 注释。在 JSF 模板中制作您想要访问的所有 bean `@Named`，并使用 CDI`@Inject`和`@...Scoped`，这就足够了。

要回答您的问题：

```
@SessionScoped
public class User { ... }

@RequestScoped
public class SomeController { 

@Inject
User user

...
} 
```

这将在会话开始时创建并在实例化时`User`将其注入（在此示例中使用新请求）。`SomeController``SomeController`

查看[Weld 文档](http://docs.jboss.org/weld/reference/latest/en-US/html/scopescontexts.html)以更完整地了解该主题...

# django - 从结果中排除整个 QuerySet

> ID：10182945
> 
> 赞同：6
> 
> 时间：2012-04-16T23:07:31.013
> 
> 标签：django, django-models, django-queryset

我有以下型号：

```
 class LibraryEntry(models.Model):
   player = models.ForeignKey(Player)
   player_lib_song_id = models.IntegerField()
   title = models.CharField(max_length=200)
   artist = models.CharField(max_length=200)
   album = models.CharField(max_length=200)
   track = models.IntegerField()
   genre = models.CharField(max_length=50)
   duration = models.IntegerField()
   is_deleted = models.BooleanField(default=False)

   class Meta:
     unique_together = ("player", "player_lib_song_id")

   def __unicode__(self):
     return "Library Entry " + str(self.player_lib_song_id) + ": " + self.title

 class BannedSong(models.Model):
   lib_entry = models.ForeignKey(LibraryEntry)

   def __unicode__(self):
     return "Banned Library Entry " + str(self.lib_entry.title) 
```

我想做这样的查询：

```
 banned_songs = BannedSong.objects.filter(lib_entry__player=activePlayer)
 available_songs = LibraryEntry.objects.filter(player=activePlayer).exclude(banned_songs) 
```

基本上，如果一首歌曲被禁止，我想将其从我的可用歌曲集中排除。有没有办法在 Django 中做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-16T23:20:15.733

```
banned_song_ids = (BannedSong.objects.filter(lib_entry__player=activePlayer)
                                            .values_list('lib_entry', flat=True))

available_songs = (LibraryEntry.objects.filter(player=activePlayer)
                                            .exclude('id__in' = banned_song_ids)) 
```

替代方案是：

```
available_songs = (LibraryEntry.objects.filter(player=activePlayer)
                                          .filter(bannedsong__isnull = True)) 
```

# solr - 搜索多个核心并合并结果

> ID：10182946
> 
> 赞同：0
> 
> 时间：2012-04-16T23:07:41.830
> 
> 标签：solr, merge, schema

我已经设置了具有多个核心的 solr。每个核心都有自己的架构（具有共同的唯一 ID）。Core0：Id，名称 Core1：Id，类型。

我正在寻找一种将结果集生成为 ID、名称、类型的方法。有什么办法吗？

我尝试了这里建议的解决方案，但没有奏效。

## [搜索多个 SOLR 内核并返回一个结果集](https://stackoverflow.com/questions/2139030/search-multiple-solr-cores-and-return-one-result-set)

没有合并模式的原因如下：

我们每天都有成千上万的文档（pdf 文件）需要提取/插入到 solr 中进行搜索。这意味着有时会有数百万份文件。第二个要求是，在任何时间点，都可以请求对所有历史 pdf 文件执行一些处理，并将处理后的信息添加到每个文件的 solr 中。这样处理过的信息就会出现在搜索中。现在由于提取需要很长时间，因此对所有文件执行历史更新将非常困难（更新时间长）。所以我想如果我可以使用另一个核心来保留处理过的信息，它会更快。请建议是否有替代解决方案。

# ruby-on-rails - CanCan + Factory_Girl - 奇怪的行为

> ID：10182947
> 
> 赞同：1
> 
> 时间：2012-04-16T23:08:00.007
> 
> 标签：ruby-on-rails, ruby-on-rails-3, factory-bot, cancan

我有两个工厂——用户和公司。

```
FactoryGirl.define do
  factory :user do
    sequence(:email) { |n| "user#{n}@exyzample.com" }
    password "secret"
    password_confirmation "secret"
  end

  factory :customer, :parent => :user do
    role "customer"
  end

  factory :company do
    name "User Company"
    association :user, :factory => :customer
  end
end 
```

然后，当我从工厂创建公司时 - 一切都很完美，记录保存到数据库并与用户关联。很酷，但是当我尝试测试用户能力时 - 我的所有测试都失败了。

有一个例子（rails 控制台）：

```
company = Factory(:company)
=> COMMIT
Ability.new(company.user)
=> Called id for nil, which would mistakenly be 4 -- if you really wanted the id of nil, use object_id 
```

但

```
company.user 
=> #<User id: 1, email: "user1@example.com", ..., role: "customer"> 
```

和

```
Ability.new(User.find(1))
=> #<Ability:0xcf6771c> ... 
```

我很困惑。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T01:09:52.867

你能告诉我用户的初始化方法吗？我认为出现此问题是因为您未在用户或公司工厂中定义某些关联

# c# - 如何将windows phone获取的图片转ac#picturebox图片

> ID：10182948
> 
> 赞同：1
> 
> 时间：2012-04-16T23:08:04.857
> 
> 标签：c#, windows-phone-7

我有一个 Windows 手机应用程序，它拍摄一张照片并将其发送到 wcf 服务，该服务将其发送到数据库，以便另一个应用程序（Windows 窗体应用程序）可以检查数据库并获取图像。

它将数据作为字节数组添加到数据库中，但是当我检查这些值时，它们都说相同的数字，但它似乎有效，因为它们的数据在那里。

但是，当我尝试将该数据转换为图像时，它会引发异常，说明该参数无效。我已经搜索了如何做到这一点，但我发现（甚至在这里）正是我在做什么。所以我不确定出了什么问题。

这是我的 windows phone 代码：

```
if (e.TaskResult == TaskResult.OK)
        {
            var bitImage = new BitmapImage();
            bitImage.SetSource(e.ChosenPhoto);
            //image is a Image Control in the form
            ImageServiceClient client = new ImageServiceClient();

            byte[] array;
            using(var stream = new MemoryStream())
            {
                var btmMap = new WriteableBitmap(bitImage.PixelWidth, bitImage.PixelHeight);

                // write an image into the stream
                btmMap.SaveJpeg(stream, bitImage.PixelWidth, bitImage.PixelHeight, 0, 100);
                array = stream.ToArray();
            }
            client.AddImageAsync(array);
        } 
```

最后一行调用我的 wcf 服务中的 add 方法，如下所示：

```
public void AddImage(byte[] array)
    {
        var con =
            new MySqlConnection(
                "server=instance11297.db.xeround.com;User Id=Admin;Password=nomoredrama2010;port=7692;database=capstone");
       con.Open();
        string h = array.Aggregate(h, (current, b) => current + b);
        string text = "INSERT INTO images VALUES (''," + h + ")";
        Console.WriteLine(text);
        var command = new MySqlCommand(text, con);
        var result = command.ExecuteReader();
       result.Close();
    } 
```

值得注意的是，无论我是直接使用传入的数组还是将其转换为文本，它们都在数据库中显示相同。

最后，在将所有内容发送到的应用程序中，我有这个：

```
var con =
            new MySqlConnection(
                "server=instance11297.db.xeround.com;User Id=Admin;Password=nomoredrama2010;port=7692;database=capstone");
        con.Open();
        string h = "";
        string text = "select Image from images where ImageId=4";
        var command = new MySqlCommand(text, con);
        var dr = command.ExecuteReader();
        var g = new byte[] {};
        if(dr.Read())
          g = (byte[])dr[0];
        dr.Close();
        var image = Image.FromStream(new MemoryStream(g));
        pictureBox1.Image = image; 
```

但它总是在“var image = Image.FromStream(new MemoryStream(g));”上中断 说参数无效。

我发现它在获取图像后有一个大数组，但数据库中的那个只有 65 个字节，而且都说 57。

为什么它完全无视我的图像数组并将其替换为所有 57 个字节中的一个 65 个字节？

我究竟做错了什么？

****** *** ** *** ** *** ** *** ******编辑****** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ********

 **在 wcf 应用程序中启用调试器后，我终于发现了问题所在。 [http://msdn.microsoft.com/en-us/library/ff649234.aspx](http://msdn.microsoft.com/en-us/library/ff649234.aspx)（对于那些不知道的人）

我也看过这里： http: [//www.codeproject.com/Articles/9686/Save-An-Image-Into-SQL-Server-2000-Database](http://www.codeproject.com/Articles/9686/Save-An-Image-Into-SQL-Server-2000-Database)

看看为什么它会抛出“你的 sql 是错误的”类型错误，并将我的 sql 语句更改为使用添加方法而不是将值放入字符串中。

最终解决了它。其他人遇到此问题的工作代码如下所示：

```
public void AddImage(byte[] array)
    {
        var con =
            new MySqlConnection("server=instance11297.db.xeround.com;User Id=Admin;Password=nomoredrama2010;port=7692;database=capstone");
        con.Open();
        string text = "INSERT INTO images (ImageId, Image) VALUES ('',@bytes)";
        var command = new MySqlCommand(text, con);
        command.Parameters.AddWithValue("@bytes", array);
        command.ExecuteNonQuery();
        con.Close();
    } 
```

我终于可以停止用头撞墙了。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:16:47.143

你应该使用这样的东西。

//---读取缓冲区中的数据并写入ms2---

MemoryStream ms2 = new MemoryStream();

ms2.Write(b, 0, b.Lenght);

//---将其加载到 PictureBox 控件中---

pictureBox2.Image = new Bitmap(ms2);**

# c# - 使用 Html.Action() 时，PartialView ViewBag 数据在父视图中不可用

> ID：10182949
> 
> 赞同：2
> 
> 时间：2012-04-16T23:08:06.850
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, html-helper

似乎是一个简单的问题，但我显然错过了一些东西。

我有一个在 partialView 中创建的 ViewBag。PartialView 正在通过

```
@Html.Action() 
```

事实上，这就是在其中设置 ViewBag 变量的 ActionMethod。一旦设置它们在局部视图中可用，但是当我们回到从 ViewBag 调用 Html.Action() 的父级时，变量不再可用。

知道怎么来的吗？如何访问在 Html.Action() 操作方法中分配的 ViewBag 变量？

PS我看到了以下问题： [Can't access ViewBag in a partial view in ASP.NET MVC3](https://stackoverflow.com/questions/5729784/cant-access-viewbag-in-a-partial-view-in-asp-net-mvc3)

...据此，我收集到 ViewBag 变量在您仅渲染局部视图（ @Html.Partial() ）时传递，但当您通过另一个操作方法渲染局部视图时它们不会传递。

请帮忙 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T23:34:11.140

根据这个SO帖子[，子动作是否与其“父母”动作共享相同的ViewBag？](https://stackoverflow.com/questions/7737124/does-a-child-action-share-the-same-viewbag-with-its-parents-action)，子操作的 ViewData/ViewBag 无法从其父操作访问。这是有道理的，因为存储在 ViewData/ViewBag 中的信息在重定向后无法幸免，并且在内部，子操作可能在完成执行后重定向回父操作。您希望将数据存储在可以在单次重定向中幸存的位置，因此请尝试改用[TempData](http://msdn.microsoft.com/en-us/library/system.web.mvc.tempdatadictionary.aspx)并查看它是否有效。

# javascript - Safari 扩展弹出框链接

> ID：10182952
> 
> 赞同：6
> 
> 时间：2012-04-16T23:08:37.133
> 
> 标签：javascript, safari, safari-extension, popover

是否可以在 Safari 弹出窗口中使用链接？我已经完成了我能想到的所有事情，但似乎将链接添加到弹出框只会改变外观，并且不会导致任何可点击的内容，无论是使用 href 还是 onclick。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T03:35:45.500

您可以在 href 或 div 上添加 onclick 侦听器

```
.onclick = safari.application.activeBrowserWindow.openTab().url = "http://www.yourdomain.com/"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-19T07:03:27.217

```
var link = document.querySelector('#~~~');
link.addEventListener("click", function(event) {
    safari.application.activeBrowserWindow.openTab().url = "http://~~"
}) 
```

# ruby-on-rails - 将设计路线 - id 更改为用户名

> ID：10182954
> 
> 赞同：1
> 
> 时间：2012-04-16T23:08:51.197
> 
> 标签：ruby-on-rails, routing, devise

如何将设计路线从 id 更改为用户名？

我希望路径类似于

```
http://www.site.com/users/username 
```

代替

```
http://www.site.com/users/id 
```

* * *

在我看来：

```
<span>posted by: <%= link_to( t.user.username, user_path( t.user.id ) ) %></span> 
```

在我的用户模型中：

```
def to_param
    username
end 
```

但是，我收到一个路由错误，说明`uninitialized constant UsersController`.

我在 routes.rb 中设置了这些路由：

```
devise_for :users

root :to => 'tickets#index'

resources :users do
    resources :tickets
end

resources :tickets 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:20:35.047

在您的控制器中，搜索 by`username`而不是 by `id`：

```
@user = User.find_by_username(params[:id]) 
```

现在，在您看来，传递给助手`username`而不是：`id``user_path`

```
<%= link_to t.user.username, user_path(t.user.username) %> 
```

* * *

*   [将设计路线从 ID 更改为用户](https://stackoverflow.com/a/5698947/512904)名- [GearHead](https://stackoverflow.com/users/462439/gearhead)回答。

# php - 试图将两个数组合并在一起

> ID：10182955
> 
> 赞同：0
> 
> 时间：2012-04-16T23:09:12.820
> 
> 标签：php, arrays, array-merge

我有两个数组，我只是想在一个函数中合并在一起：

```
$var1=array();
$myInputVar=array();
$var1['something']['secondary_something'][]="foo1";
$var1['something']['secondary_something'][]="foo2";
$var1['something']['secondary_something'][]="foo3";

$myInputVar['something']['secondary_something'][]="foo4";
$myInputVar['something']['secondary_something'][]="foo5";

function something(&$array_, $array_new) {
   $array = array_merge($array_ , $array_new); 

    print_r($array);//for debugging

}   
something($var1, $myInputVar); 
```

现在打印：

```
Array ( [something] => Array ( [secondary_something] => Array ( [0] => foo1 [1] => foo2 [2] => foo3 ) ) ) 
```

当我期待：

```
Array ( [something] => Array ( [secondary_something] => Array ( [0] => foo1 [1] => foo2 [2] => foo3 [3] => foo4 [4] => foo5) ) ) 
```

我也试过：

```
$array = $array_ + $array_new; 
```

仍然没有打印出我的期望。

我有一种感觉，我误解了`array_merge()`函数的目的，这就是为什么它没有返回我期望它返回的结果。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:13:12.460

试试[`array_merge_recursive()`](http://php.net/array-merge-recursive)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:16:21.000

`array_merge`将从左到右工作。在你的情况下：

```
$array_['something']['secondary_something'] 
```

将被覆盖

```
$array_new['something']['secondary_something'] 
```

您可以执行以下操作：

```
function something(&$array_, $array_new) {
    $array = array_merge($array_ , $array_new); 
    return $array;
}

$var1['something']['secondary_something'] = something($var1['something']['secondary_something'], $myInputVar['something']['secondary_something']); 
```

否则，您将需要创建一个知道关联键并将适当组合数组的函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T23:27:33.267

```
function something(&$array_, $array_new) {
    foreach ($array_new as $val)
        foreach ($val as $val2)
            foreach ($val2 as $val3)
                array_push($array_['something']['secondary_something'], $val3);
    print_r($array_);//for debugging
} 
```

# c++ - Qt、多重继承、包装器或事件过滤器

> ID：10182961
> 
> 赞同：2
> 
> 时间：2012-04-16T23:10:09.187
> 
> 标签：c++, qt, qt-signals

我有几个不同的基于 QGlWidget 的显示小部件，我需要将它们嵌入到基于 MDI 或 QDockwidget 的应用程序中。但我需要在我的显示小部件中处理一些 MDI/Dock 特定事件（最小化/停靠等）

选项是：
乘以从 QGlWidget 和 QMdiSubWindow/QDockWidget 继承显示小部件。多重继承和信号/插槽有任何问题吗？

将显示器封装在 QMdiSubWindow/QDock 派生的小部件中，但随后我必须将显示器的所有外部函数包装在 Mdi/Dock 包装器小部件中。

当我创建一个新窗口时，创建一个临时 Mdi/Dock 小部件，将所有特殊信号连接到显示器中的插槽，然后将显示器连接到它并显示它。但这不适用于事件。

一些 QSignalMapper 魔术，我可以在 QGlWidget 中接收 QMdiSubWindow/QDockWidget 特定信号

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T07:04:15.887

MDI/dock 小部件是其他小部件的*容器*，因此将它们的功能与显示小部件混合并不是一个很好的解决方案，因为您最终会得到一个看起来像容器但不能包含任何东西的可怕混合小部件。并不是说 Qt 会像 Jeremy 所说的那样允许它。

如果您的 QGLWidget 需要来自其父容器的事件（例如最小化、停靠等），为什么您不能在 QGLWidget 中为它们创建伙伴方法，并在父容器执行操作时调用它们？

# java - 切换多个按钮的可见性

> ID：10182962
> 
> 赞同：1
> 
> 时间：2012-04-16T23:10:11.077
> 
> 标签：java, android, android-layout, android-intent, visibility

在我的应用程序中，我试图在 RealViewSwitcher 中切换两个透明按钮的可见性（我知道这是相当骇人听闻的）。我正在根据 RealViewSwitcher 的当前页面更改可见性。我可以让第一个按钮工作，但第二个按钮永远不会激活。这是我的代码：

///////////////

```
 if(realViewSwitcher.getCurrentScreen() == 0)
    {

        final Button btn1 = (Button)findViewById(R.id.btn1);

        btn1.setOnClickListener(new View.OnClickListener()
        {       
            @Override
            public void onClick(View v)
            {
                Intent intent = new Intent();
                intent.setAction(Intent.ACTION_VIEW);
                intent.addCategory(Intent.CATEGORY_BROWSABLE);
                intent.setData(Uri.parse("http://www.test.com"));
                startActivity(intent);

                btn1.setVisibility(View.GONE);

            }
        });
    } 

    else if(realViewSwitcher.getCurrentScreen() == 2)
    {
        final Button btn2 = (Button)findViewById(R.id.btn2);
        btn2.setVisibility(0);

        btn2.setOnClickListener(new View.OnClickListener()
        {       
            @Override
            public void onClick(View v) 
            {

                Intent intent = new Intent(Intent.ACTION_SEND); 
                String[] tos = { "info@email.com" }; 
                intent.putExtra(Intent.EXTRA_EMAIL, tos); 
                intent.putExtra(Intent.EXTRA_TEXT, "body"); 
                intent.putExtra(Intent.EXTRA_SUBJECT, "subject"); 
                intent.setType("message/rfc882"); 
                Intent.createChooser(intent, "Choose Email Client");

            }
        });
    }

    ///////////////
    //end
    ///////////////////// 
```

这是xml

```
 <Button 
        android:id="@+id/btn1"
        android:layout_width="100dp"
        android:layout_height="100dp"
        android:background="@null"/>

    <Button 
        android:id="@+id/btn2"
        android:layout_width="100dp"
        android:layout_height="100dp"
        android:background="@null"
        android:visibility="gone"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:29:50.467

您的代码只需要稍微清理一下。

1.  首先，您的按钮应声明为字段。事实上，它们只是 if 语句的实例变量。
2.  出于同样的原因，应在 if 语句之外声明单击侦听器。`onCreate()`在您喜欢的地方或任何地方声明它们。
3.  为`getCurrentWindow()`. 它比`if... else if... else if...`.

我可以建议：

```
final Button btn1 = (Button) findViewById(R.id.btn1);
final Button btn2 = (Button )findViewById(R.id.btn2);

//Inside onCreate() or similar
btn1.setOnClickListener(new View.OnClickListener() {       
    @Override
    public void onClick(View v) {
        Intent intent = new Intent();
        intent.setAction(Intent.ACTION_VIEW);
        intent.addCategory(Intent.CATEGORY_BROWSABLE);
        intent.setData(Uri.parse("http://www.test.com"));

        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);  //Required to start a new activity
        startActivity(intent);

        btn1.setVisibility(View.GONE);

    }
});

//In the same place
btn2.setOnClickListener(new View.OnClickListener() {       
    @Override
    public void onClick(View v) {
        Intent intent = new Intent(Intent.ACTION_SEND); 
        String[] tos = { "info@email.com" }; 
        intent.putExtra(Intent.EXTRA_EMAIL, tos); 
        intent.putExtra(Intent.EXTRA_TEXT, "body"); 
        intent.putExtra(Intent.EXTRA_SUBJECT, "subject"); 
        intent.setType("message/rfc882"); 
        Intent.createChooser(intent, "Choose Email");
        btn2.setVisibility(View.VISIBLE);
    }
});

//Later, in your other functional code
switch (realViewSwitcher.getCurrentScreen()) {
    case 0:
        //do your stuff
        break;
    case 2:
        //other stuff
        break;
    default: //If you need it
        throw new Exception("Oops...");
} 
```

# ember.js - 无法在 Ember.js 中获取要呈现的模板部分

> ID：10182970
> 
> 赞同：2
> 
> 时间：2012-04-16T23:11:41.690
> 
> 标签：ember.js, handlebars.js

我在让 Ember.js 获取和渲染车把模板文件时遇到了一些问题。我在浏览器的调试控制台中收到以下错误：

> 错误：<（Welcome.LoginView 的子类）：ember166> - 找不到模板“login_view”。

我的 app.js 文件中的 emberjs 代码中有以下代码：

```
Welcome = Ember.Application.create();

Welcome.LoginView = Ember.View.extend({
  templateName: 'login_view'
}); 
```

我的 index.html 文件中还有以下代码段：

```
<script type="text/x-handlebars">
  {{view Welcome.LoginView}}
</script> 
```

最后，相对于 app.js 文件，我有文件 templates/login_view.handlebars，其中包含要呈现的模板内容：

```
<form class="form-inline">
  <fieldset>
    <input type="text" name="email" placeholder="email address">
    <input type="password" name="password" placeholder="password">
    <button class="btn btn-primary" type="submit">Sign In</button>
    <!-- ... -->
  </fieldset>
</form> 
```

该错误似乎表明它无法找到车把模板。当我查看生成的 HTML 时，我在页面上看不到上面的表单。

谁能阐明我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T02:59:26.103

根据您的问题，我假设您没有使用一些为您预编译车把模板的工具。Ember 在`Ember.TEMPLATES`数组中查找模板——它不会自动查找位于`templates/`并以`.handlebars`. 如果没有为您编译模板的构建步骤，您必须自己执行此操作。

这听起来可能很复杂，但很简单，如下所示：

```
Ember.TEMPLATES["login_view"] = Ember.Handlebars.compile('TEMPLATE CODE'); 
```

您必须确保此模板定义在您想使用它**之前出现。**

* * *

另一种解决方案是将您的模板内联到您的模板中并向脚本标签`index.html`添加一个`data-template-name="login_view"`属性：

```
<script type="text/x-handlebars" data-template-name="login_view">
  <form class="form-inline">
    <!-- ... -->
  </form>
</script> 
```

但是，如果您的项目有许多模板，那么我建议您采用一个构建工具来为您提供第一个选项。

* * *

相关问题：[是否可以通过 Ajax 加载 Handlebars 模板？](https://stackoverflow.com/q/9469235/65542)

# php - wp 查询以 DSC 顺序显示每个月的一篇随机帖子

> ID：10182975
> 
> 赞同：0
> 
> 时间：2012-04-16T23:12:22.007
> 
> 标签：php, wordpress

我试图让这个 wp 查询以某种方式从每个月返回一篇文章，并显示当前安装的所有月份。如果帖子是随机的，那就太棒了。因此，每个页面重新加载时的帖子都不同。

看看我到目前为止想出了什么......

```
<?php $arhiveGrid = new WP_Query(array(

    'post_type'      => 'page'              
    'order'          => 'DESC',
    'orderby'        => 'date',
    'posts_per_page' => 99999

)); ?>

<?php if ($arhiveGrid->have_posts()) : while ($arhiveGrid->have_posts()) : $arhiveGrid->the_post();

    $retina  = wp_get_attachment_image_src( get_post_thumbnail_id( $post->ID ), 'thumb-retina' ); ?>

    <a class="arhive-grid" href="<?php bloginfo('url'); the_time('/Y/m/'); ?>" style="background-image:<?php echo $retina[0]; ?>;">

        <span><?php the_time('F Y') ?></span>

    </a>

<?php endwhile; unset($arhiveGrid); endif; ?> 
```

显然，此查询将返回我安装的每个帖子。上面的代码是我将用来为我的档案页面（不是archive.php）构建我的档案网格的代码。

网格需要每个月的图像作为背景，月份和年份作为文本覆盖，并且需要链接到正确的月份。

但是只有当上面的查询可以适应每个月的随机帖子时，代码才会起作用。

感谢您的任何帮助或指点。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-17T06:22:12.850

这个查询会给你一个随机的帖子。您可以更改“numberposts”以获取任意数量的帖子

```
<?php
$args = array( 'numberposts' => 1, 'orderby' => 'rand' );
$rand_posts = get_posts( $args );
?> 
```

**编辑**：如果您想在某个时间范围内获得随机帖子，则必须使用自定义查询。

```
$wpdb->query("SELECT * FROM $wpdb->posts where post_data >= '2012-03-01' AND post_data < '2012-03-31' ORDER BY RAND() limit 1 "); 
```

此查询将为您提供 2012 年 3 月发布的随机帖子。

现在您必须在循环中使用此查询来获取您想要的每个月的随机帖子。

# objective-c - 不支持clang错误'-I-'，归档，cocos2d

> ID：10182978
> 
> 赞同：1
> 
> 时间：2012-04-16T23:13:16.337
> 
> 标签：objective-c, xcode4, cocos2d-iphone

存档时出现以下错误（在设备上运行效果很好）。

```
clang: error: '-I-' not supported, please use -iquote instead
Command /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang failed with exit code 1 
```

我正在使用 Apple LLVM 编译器 3.1 和 cocos2d 库（似乎编译得很好）。在添加 cocos2d 库之前，我也可以存档。

在查看日志导航器时，我看到一切都编译得很好，直到它归结为我的项目的源代码，每个源文件都抛出一个 clang 错误。

我尝试了以下解决方案但没有成功： [Xcode 4 - clang error](https://stackoverflow.com/questions/8301649/xcode-4-clang-error) 将编译器更改为 LLVM-GCC 并设置我的标头搜索路径后，我仍然有 **-I- 指定两次**错误。此外，由于我完全依赖 ARC，因此代码停止在设备上运行。

我想知道我的问题有哪些可能的解决方案。如果我应该尝试独立构建 cocos2d，或者如果有一些编译设置我可以调整。

感谢您的帮助，如果我忘记了一些细节或犯了错误，请提前道歉，我对IOS dev比较陌生

ps：使用Xcode 4.3.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T17:36:44.550

在这个问题上花了几天时间后，我终于辞职了，将我的代码从使用 ARC 降级为不使用它。我现在可以成功创建存档。

问题是我现在必须花几个小时来处理内存管理，而且由于项目是为了并行编程而进行了版本控制（有几个分支），这肯定会让我们的活动停止一段时间。

如果有人找到继续使用 LLVM 编译器的方法，请告诉我，这类信息总是有用的。

# javascript - 如何查看绑定到 DOM 元素的确切事件？

> ID：10182993
> 
> 赞同：2
> 
> 时间：2012-04-16T23:15:36.623
> 
> 标签：javascript, jquery, events

我觉得我想经常这样做但不能因为我无法访问实际事件。

例如（这只是一个示例，因为我**可以**只查看 API）我试图查看 stackoverflow 的图像上传器是如何工作的，但是当我调用`$($0).data('events)`（或`$('form[action="/upload/image"] :submit').data('events')`）时，我得到`undefined`. 有没有其他方法可以查看某些事件的实际功能？

如果是这样，是否还有一种方法可以在这些事件上设置断点？

编辑：

使用`Visual Event`这是我所看到的

![在此处输入图像描述](../Images/5fbaeb4ec117542ad193bc956b5c42a4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:20:02.773

就个人而言，我混合使用 Firebug 和[Visual Event](http://www.sprymedia.co.uk/article/Visual+Event)。

**编辑：**由于定位，活动亮点并不总是完美排列。

我设法在这里找到图像提交功能： ![视觉事件示例](../Images/0a9dbe8d491ada06219f980b9a31eb6f.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:20:47.530

在最近的 jQuery 版本（从 1.7 开始）中，它们改变了事件存储方式的内部结构，请参阅[这篇博](http://blog.jquery.com/2011/11/08/building-a-slimmer-jquery/)文。

您仍然可以参加活动，但方式*有所不同*：

```
var events = jQuery._data(element, 'events'); 
```

# c++ - 从头开始在汇编中编写 for 循环

> ID：10182997
> 
> 赞同：0
> 
> 时间：2012-04-16T23:16:26.053
> 
> 标签：c++, visual-studio, visual-c++, assembly, for-loop

您好，我目前正在尝试自己学习 C++ 中的汇编。我的项目中有汇编代码，目前处于高级 c++ for 循环中，如果可能的话，我需要帮助将其转换为完全汇编，这是我目前拥有的代码：

```
char temp_char;
for (int i = 0; i < length; i++){
    temp_char = characters [i];
    __asm {                         
        push eax    
        push ecx
        movsx ecx,temp_char
        movsx eax,key   
        push ecx    
        push eax
        call test
        add esp, 8
        mov temp_char,al
        pop ecx 
        pop eax
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:33:35.523

您的`for`生产线包含三个部分。在组装级别进行思考时，有助于将它们分开。一个简单的方法是重写`for`as a `while`：

```
char temp_char;

int i = 0;
while (i < length) {
    temp_char = characters [i];
    __asm {                         
        push eax    
        push ecx
        movsx ecx,temp_char
        movsx eax,key   
        push ecx    
        push eax
        call test
        add esp, 8
        mov temp_char,al
        pop ecx 
        pop eax
    }
    i++;
} 
```

您应该能够很容易地将`int i=0`and`i++`行转换为程序集。唯一剩下的就是`while`. a 的顶部`while`通常实现为条件和跳转（或条件跳转，如果您的平台支持此类操作）。如果条件为真，则进入循环；如果条件为假，则跳过循环（跳到末尾）。a 的底部`while`只是无条件跳回循环顶部。

# mysql - 现有 mysql 表中的附加字段或单独的表

> ID：10182998
> 
> 赞同：1
> 
> 时间：2012-04-16T23:16:33.410
> 
> 标签：mysql

我一直在寻找建议，但我仍然不能 100% 确定改进这一点的最佳方法。我有一个存储大约 130K 记录的 mysql INNODB 'product' 表。杂项产品数据等大约有 80 个字段，然后我们一直在为每个供应商（成本/ID/库存）添加供应商库存数据字段 x 3，从而产生另外 35-40 个额外字段。

我们通过 loaddata 或 xml/xls 提要的 php 脚本将供应商数据提要运行到每个供应商的单独表中。然后，我们运行一个查询来更新产品中的成本/库存，并使用相关供应商表中与每个表中的 id 匹配的最新数据。然后，此过程针对我们的每个供应商提要（目前大约 15 个）运行，在某些情况下每天一次，在其他情况下两次/3/4 次，提要大小从几百到 1/3/20/30K 不等。

然后，我们运行一个脚本（由于供应商数据馈送的导入计划不同，每天运行几次）比较所有供应商的库存（来自主产品表数据），并根据当时有库存的最便宜的供应商生成价格。然后，这会更新产品表中在某处有库存的每个项目的总体最佳产品价格。

update best price 脚本从表中选择所有有库存的记录，然后进行计算，然后用价格单独更新每个产品。我们遇到的问题是，在此期间我们会变慢，有时可能只有一两分钟，但有时似乎需要 5/6 到 10 分钟，这取决于网站流量等，大概是因为产品标签正在更新和重新-索引，而每次运行最多可记录 20/30,000 条记录。

product 表是该站点最繁忙的表，当更新运行时，我们看到 cpu 上升到 300/350%。我们正在尝试确定我们最初的最佳选择是否是将存储的最佳价格和汇总库存值分离到另一个表中，并在我们提取产品数据以解决索引/锁定问题时加入该表，或者我们是否只是简单地需要迁移到仍然可以处理 db/webserver/email 等的新服务器，或者运行专用的 DB 服务器。

重新迁移或新的专用数据库服务器的问题是成本，当服务器在这些缓慢的更新周期之外以 10/20/30/40% CPU 处理良好时，这是老板的停止点。如果我们要使用数据库服务器，最简单的选择是获取一个新服务器并从中运行数据库以节省重新安装我们的自定义应用程序/邮件服务器/网站应用程序文件等。如果我们这样做，我们将能够得到放弃我们目前拥有的较低规格的服务器，或者我们真的需要考虑数据库服务器是 2 中更好的规格吗？任何帮助或一般建议将不胜感激！！！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:13:46.630

听起来您的产品表已非规范化。如果您不太确定这意味着什么，*请*继续阅读。了解这一点对您的成功至关重要。

如果我是你，我会选择这个选项：“将存储的最佳价格和汇总库存值分离到另一个表中，并在我们提取产品数据以解决索引/锁定问题时加入该表”。也就是说，我相信您应该为您的产品表和相关的供应商信息从非规范化模式切换到规范化模式。

但是，切换需要开发人员的劳动。通常，开发人员的劳动力比新的服务器硬件更昂贵。将 mySQL 数据库实例从一台服务器机器迁移到另一台机器并不难。如果您确实购买了新的服务器机器，请购买您能负担得起的最快的磁盘存储子系统。如果您使用 RAID，请使用 RAID 1-0（条带化和镜像）而不是 RAID 5。除此之外，如果您为新服务器配备 4GB 内存和双或四处理器，您应该没问题。

换句话说，购买一台具有良好磁盘存储子系统的 2012 年普通中端服务器机器。把你的 mySQL 放在新机器上（别管其他的东西）。

但是，请考虑您的应用程序需要扩展多少。

这个产品表是否已经接近几年后的大小？或者您的公司是否计划在未来几个月和几年内增加大量新产品和新供应商？如果你必须扩展这个系统，你真的必须选择第一个选项（使用开发人员的劳动力并更改为更好的、规范化的 DBMS 模式）。如果您现在咬紧牙关并进行此更改，您的系统将更容易扩展。

但是，如果您公司的产品线相当静态，那么花五万美元左右添加一台新服务器是最便宜的方法。

# jquery - 与聚焦第一个输入的脚本冲突

> ID：10182999
> 
> 赞同：0
> 
> 时间：2012-04-16T23:16:37.083
> 
> 标签：jquery, validation, input

我正在使用的脚本是否有替代方案，因为我与另一个验证脚本发生冲突？

我试图在页面加载时专注于第一个输入。

```
$(document).ready(function() {
    $('form:first *:input[type!=hidden]:first').focus();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:26:21.520

您可以使用[`autofocus`HTML5 中的属性](http://diveintohtml5.info/forms.html)并仅使用 JavaScript 作为后备，这意味着现代浏览器不会遇到该问题。

为了防止冲突，我假设您的验证库最初使用焦点进行验证，所以我认为解决它的唯一方法是在执行焦点代码**后以编程方式添加您的 JavaScript 验证库。**