# StackOverflow 问答 10689000-10689999

# entity-framework-4 - WCF 数据服务没有来自数据库更新的刷新更改

> ID：10689008
> 
> 赞同：0
> 
> 时间：2012-05-21T16:31:38.877
> 
> 标签：entity-framework-4, wcf-data-services

我在尝试刷新 Gridview 中的数据时遇到问题，问题是如果我的应用程序正在运行并且我更新了数据库上的某些内容，则新数据不会刷新，但如果我关闭应用程序并再次重新运行，则会出现更改。

这是我在构造函数中的一段代码：

```
IQueryable<GyLoadCarrier> loadCarrierQuery = queryRepository.GetGyLoadCarriers();

        LoadCarriersMfsTransportsLoader = new WcsDomainCollectionViewLoader<GyLoadCarrier>(loadCarrierQuery)
        {
            RequestTotalItemCount = true
        };

        LoadCarriersMfsTransportsLoader.LoadStarted += OnLoadCarrierMfsTransportsLoaderLoadStarted;
        LoadCarriersMfsTransportsLoader.LoadCompleted +=OnLoadCarrierMfsTransportsLoaderLoadCompleted;

        AvailableLoadCarriers = new DomainCollectionView<GyLoadCarrier>(LoadCarriersMfsTransportsLoader,
                                                                        LoadCarriersMfsTransportsLoader.Data);
        LoadCarriersMfsTransportsLoader.View = AvailableLoadCarriers;

        INotifyCollectionChanged notifyingSortLoadCarrierDestination = AvailableLoadCarriers.SortDescriptions;
        notifyingSortLoadCarrierDestination.CollectionChanged += (sender, e) => AvailableLoadCarriers.MoveToFirstPage();

        using (AvailableLoadCarriers.DeferRefresh())
        {
            AvailableLoadCarriers.PageSize = 30;
            AvailableLoadCarriers.MoveToFirstPage();
        } 
```

LoadCarriersMfsTransportsLoader.Load("LoadCarrierAddressChanged");

刷新命令只是：

```
 protected override void OnRefresh()
    {

        MfsTransportsLoader.Load(Resources.Strings.LoadingMfsTransportsProgressMessage);
    } 
```

所以知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:17:13.800

假设您使用相同的 DataServiceContext（或派生）类实例从您的客户端运行相同的查询两次（更新之前和之后），这很可能是由于 MergeOption (http://msdn.microsoft.com/en-我们/图书馆/system.data.services.client.dataservicecontext.mergeoption.aspx）。默认值 AppendOnly 阻止将更新应用于您的客户端对象，因为它们已经存在（这是为了不覆盖您可能所做的任何潜在更改）。您可以通过将 DataServiceContext.MergeOption 设置为 OverwriteChanges 来解决此问题。

# android - 通过 Android 模拟器发送短信

> ID：10689011
> 
> 赞同：1
> 
> 时间：2012-05-21T16:31:41.140
> 
> 标签：android, sms

我创建了一个安卓应用程序。现在我想通过它发送短信到一个真实的手机号码......有人可以帮我吗？互联网上提供的信息是在两个模拟器之间发送消息。但我想用真实的手机号码发送短信......请帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:25:17.310

我认为您无法将 SMS 从 Emulator 发送到真实设备，因为它没有任何号码。我添加了下面的代码，这将有助于从真实设备发送短信。

```
 PendingIntent pi = PendingIntent.getActivity(this, 0,
            new Intent(this, RoadMoveActivity.class), 0);    
    SmsManager smsManager = SmsManager.getDefault();
    smsManager.sendTextMessage(sms_phonenumber, null, sms_message, pi, null); 
```

它对我有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:57:43.330

模拟器不是真正的手机，没有号码或 SIM 卡，因此无法从外部设备发送或接收短信。从 cmd telnet 你可以使用**sms send phonenumber**

编辑 ：

```
 private SmsMessage[] getMessagesFromIntent(Intent intent) {
    SmsMessage msgs[] = null;
    Bundle bundle = intent.getExtras();
    try {
        Object pdus[] = (Object[]) bundle.get("pdus");
        msgs = new SmsMessage[pdus.length];
        for (int n = 0; n < pdus.length; n++) {
            byte[] byteData = (byte[]) pdus[n];
            msgs[n] = SmsMessage.createFromPdu(byteData);
        }
    }
    catch (Exception e) {
        Logger.getDefault().error("Fail to create an incoming SMS from pdus", e);
    }
    return msgs;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:48:57.913

请参阅此问题以了解如何在您的 android 模拟器中设置电子邮件帐户 [如何在 Android 模拟器中配置 gmail？](https://stackoverflow.com/questions/6978877/how-can-i-configure-gmail-in-android-emulator)然后使用以下代码发送电子邮件，

```
 Intent email = new Intent(Intent.ACTION_SEND);
    email.putExtra(Intent.EXTRA_EMAIL, new String[]{"youremail@yahoo.com"});          
    email.putExtra(Intent.EXTRA_SUBJECT, "subject");
    email.putExtra(Intent.EXTRA_TEXT, "message");
    email.setType("message/rfc822");
    startActivity(Intent.createChooser(email, "Choose an Email client :")); 
```

# ajax - Jquery Ajax Post -> 仅在我单步执行 ajax 调用时才有效，并且仅在某些情况下才有效.......有什么想法吗？

> ID：10689012
> 
> 赞同：0
> 
> 时间：2012-05-21T16:31:45.573
> 
> 标签：ajax, visual-studio-2010, jquery, vb.net-2010

所以，我有一个 ajax 帖子，它调用一个服务并返回一个我想在成功时解析的对象。

我在 vs2010 中运行它，它仅在我单步执行 ajax 后代码时才有效，并且仅在部分时间有效。

这个调用与我所做的其他页面基本相同，所以我真的很困惑为什么这不起作用。

```
$.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (obj) {
                    alert("Success");
                    parseStart(obj.d, id, idnum, parseType);
                },
                error: function (e) {
                    alert("Failure. :" + e);
                }
            }); 
```

这真的很标准，我不知道为什么要这样做。我只是希望有人以前经历过这样的事情。就像我说的那样，只有当我单步执行 ajax 代码然后它才会成功。如果我不通过它，就好像它永远不会成功或失败......这真的很奇怪。（所以如果我不通过它，我看不到我的警报等）我有一个建议，它可能是我从我的服务返回的对象的大小，所以我将它修剪到几乎没有并且没有帮助。

对此的任何想法方向都非常感谢。我目前很难过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:39:41.537

可能是服务器没有返回 200。可能是返回 304 未修改或临时重定向。

请参阅[.success() 和 .complete() 之间的区别？](https://stackoverflow.com/questions/5240876/difference-between-success-and-complete)

.success() 仅在您的网络服务器以 200 OK HTTP 标头响应时才被调用 - 基本上是在一切正常的情况下。

但是，无论 ajax 调用是否成功，都会调用 .complete()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:40:12.197

我想我知道它是什么。ajax 调用是异步的，对吧？所以需要一段时间才能得到响应。但是，如果此调用是通过链接或表单按钮生成的，并且您没有在此处返回 false，则将发生正常的 get 或 post。调用 $.ajax(); 后返回 false；

```
$.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (obj) {
                    alert("Success");
                    parseStart(obj.d, id, idnum, parseType);
                },
                error: function (e) {
                    alert("Failure. :" + e);
                }
            });
return false; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:20:31.207

好的，经过长时间的故障排除。我将按钮调用切换到 body onload，而不是单击按钮，这样做没有错误。这是由于我使用了一个 asp 按钮，该按钮在点击破坏我的帖子时会产生回调。然后我删除了我的 asp 按钮并用输入按钮替换了这些按钮。

# json - ExtJS：JsonStore 根本没有加载

> ID：10689014
> 
> 赞同：3
> 
> 时间：2012-05-21T16:31:52.887
> 
> 标签：json, extjs, store

我有一个 jsonstore：

```
jstore = new Ext.data.JsonStore({
    fields: ['id', 'timer', 'name', 'message'],
    root: 'data',
    autoLoad: true,
    proxy: new Ext.data.HttpProxy({
                    url: 'chat.php',
                    method: 'GET',
            }),
            remoteSort: false
}); 
```

这不是从 url 加载数据。我的 php 文件工作正常，如果我输入我的 url 与商店使用的相同 url，输出是这样的：

```
{fields: ['id', 'name', 'time', 'message'], 'data': [{id: '5', name: 'stefano', time: '2012-05-21 14:08:58', message: 'mymessage'}]} 
```

这应该是一个正确的 json 字符串，不是吗？

商店既没有通过自动加载也没有通过显式调用加载

```
jstore.load({params: {mode:'RetrieveNew', id:'-1'}}); 
```

关于可能导致这种情况的任何想法？非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T18:15:36.553

你打错了：`autoLoad`不是`autoload`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T13:31:20.973

我在商店加载时遇到了同样的问题。

为了修复它，我用 Ext.data.Store 替换了 Ext.data.JsonStore。其他参数相同。所以这是我的自动加载 ExtJS 商店的例子：

```
this.datesStore = new Ext.data.Store({
                        id: 'datestore',
                        root: 'dates',
                        autoLoad: true,
                        proxy: new Ext.data.HttpProxy({
                                    url: '/url/to/the/data',
                                    method: 'GET'
                                }),
                        fields: ['date']
                    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-18T04:41:24.457

只是添加我的解决方案：

```
var stateStore = new Ext.data.JsonStore({
    autoLoad: true,
    root: 'states',
    proxy: new Ext.data.HttpProxy({
        url: 'js/query/states.json',
        method: 'GET'
    }),
    fields: ['stateCode', 'stateName'],
});

stateStore.load(); 
```

还有我的**states.json**：

```
{
  "states": [
      { "stateCode": "01", "stateName": "Johor" },
      { "stateCode": "02", "stateName": "Kedah" },
      { "stateCode": "10", "stateName": "Selangor" }
  ]      
} 
```

希望它会帮助其他人;）

# cakephp-2.1 - cakephp211 css 问题（未正确使用）

> ID：10689015
> 
> 赞同：0
> 
> 时间：2012-05-21T16:31:53.333
> 
> 标签：cakephp-2.1

在我的 ctp 文件中，我有这个：

```
 <div class="sponsor">Image
           <?php    $this->Html->image('banner.jpg', array("alt" => "banner"));?>
     </div> 
```

这是一个CSS类：

```
 .sponsor {
            margin: auto;
            width: 728px;
            padding-top: 0px;
            padding-bottom: 15px;
            text-align: center;
               }
         .sponsor img {
            margin-top: 5px;
               } 
```

但我没有正确的结果，图像没有出现。我认为 cakephp 没有正确理解 css 文件中的类（div class='sponsor'）赞助商，而正确使用了 'div' 中的关键字 'id'。
那么我该如何解决呢？
谢谢男人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T10:08:19.317

你需要`echo`你的助手让他们输出东西！;)

# php - Codeigniter PHP 警告

> ID：10689016
> 
> 赞同：4
> 
> 时间：2012-05-21T16:31:54.323
> 
> 标签：php, codeigniter

在我的 codeigniter 应用程序中记录了以下错误消息：

```
PHP Warning:  include(application/errors/error_php.php): failed to open stream: No such file or directory in /usr/src/dv/system/core/Exceptions.php on line 167, referer: http://localhost/dc 
```

当我打开 /usr/src/dv/system/core/Exceptions.php 时，我在第 167 行得到以下信息：

```
include(APPPATH.'errors/error_php.php'); 
```

的值`APPPATH`是应用程序/

如果我附加绝对路径，即`include('/usr/src/mypath'.APPPATH.'errors/error_php.php');`它工作正常。

我该怎么办？请建议。我是代码点火器的新手。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-01-11T15:13:32.920

我对这个答案不满意，您不必为这项工作更改 php.ini。

我试图找出为什么 cwd （当前工作目录）被重置，如果这在新版本的 php 中有所不同，但找不到任何有用的东西。

然而，由于核心仍然可以访问 APPPATH 我只是将我的 index.php 文件中的行更改为

```
$application_folder = getcwd().'/../application'; 
```

这应该允许您的代码仍然可以传输。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-21T16:37:24.883

这根本不是 Codeigniter 问题。您没有在 php.ini 中正确设置 include_path。基本上，include_path 为 PHP 在包含文件时提供了许多不同的目录。

[http://www.php.net/manual/en/ini.core.php#ini.include-path](http://www.php.net/manual/en/ini.core.php#ini.include-path)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-21T16:38:41.173

在 php.ini 中，将应用程序所在的文件夹设置为 include_path。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-11T18:00:33.947

对我来说，这是因为我不小心将 application/errors 文件夹移到了另一个文件夹（application/core）中，因为我太快了，无法单击并拖动文件夹。我使用 NetBeans IDE。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-26T18:30:34.503

我认为您的根分区上的磁盘空间不足。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-22T17:30:21.920

就我而言，我发现 /application/errors 文件夹在我复制旧的错误文件夹后丢失了一切正常

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-19T07:38:53.653

我也收到了这个错误，原因是我使用了一个不存在的视图，实际上拼写错误我的控制器调用视图

# orchardcms - 从其他来源将内容同步到 Orchard CMS - 定期

> ID：10689019
> 
> 赞同：2
> 
> 时间：2012-05-21T16:32:06.837
> 
> 标签：orchardcms

我有一个包含产品的商业系统。产品被分类并且还具有属性组。

我想将商业系统中的产品**同步/更新**到 Orchard 中定义的产品项目的内容类型，以便将数据从商业系统推送到 Orchard 内容项目。

我目前的想法是使用 Contrib.Taxonomies 来表示产品的类别和属性。

ProductCategory 分类将用作站点上的商务菜单。

Orchard 站点将成为商务系统的一个渠道，所有有关产品的信息都已在商务系统中定义，并且仅由商务系统管理。

因此，在同步后，Orchard 站点应该代表商业产品数据。

所以，关于...的任何建议

在 Orchard 内容数据库和商务系统之间同步分类和产品的最佳方法是什么，以便 Orchard 将商务系统产品在类别中反映为 ProductCategory 分类中的产品内容类型？

我一直在查看 Import/Export 模块，想知道是否应该编写更具体的实现来满足我的要求。如果是这样，我会从哪里开始？如果没有，我该怎么办？

（顺便说一句，喜欢 Orchard CMS 的潜力！！）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T17:50:58.473

这将是一个很好的构建模块。我肯定会基于导入/导出功能。你应该从深入研究它的代码开始。该功能的潜力远不止导入和导出 xml 文件。例如，它处理身份的方式使其非常适合同步功能。我希望这有帮助。

# sql - SQL 数据库无法使用 ADO 更新

> ID：10689020
> 
> 赞同：0
> 
> 时间：2012-05-21T16:32:23.983
> 
> 标签：sql, vb6, ado

我无法让我的数据网格进入可编辑状态。我希望能够加载程序，让网格填充，然后能够在任何单元格内单击并编辑或添加到它并将更改保存到数据源。我已经尝试了使用“.Update”策略的常用方法，但我没有运气。我认为需要修复的第一件事是我的数据网格，它卡在只读状态，我知道 adLockTypeOptimistic 方法通过强制它进入读/写但我不知道将它放在我的代码中的确切位置? 它会进入查询字符串吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:31:41.440

在填充之前在记录集对象中设置锁定类型：

```
With rs
    .CursorLocation = adUseClient
    .CursorType = adOpenKeyset
    .LockType = adLockTypeOptimistic
    .Source = strSQL
    .ActiveConnection = dbConn
    .Open
End With 
```

在打开连接或记录集之前，您可能还需要设置`cursorlocation`连接对象的属性。

`dbConn.CursorLocation = adUseClient`

希望这对您有所帮助。我一直忽略数据绑定控件和方法，并在需要时手动加载和更新记录，因为它给了我更大的控制权。

# c# - 带有无效 URL 的 C# 多个 HTTP 发布问题

> ID：10689021
> 
> 赞同：0
> 
> 时间：2012-05-21T16:32:24.287
> 
> 标签：c#, multithreading, http-post

我在调用多个 URI 时遇到问题，目前它以其当前形式工作，但如果该站点无法访问（不存在），它会中断我需要它忽略并继续的其他调用。这是由单一发布方法构建的，但现在要求已经改变。

我对线程几乎没有经验，但这是我为创建线程所做的。

```
 private void makethread(string Url, string useproxy, string xml)
{
    //Parameters given put into list and passed with Thread.
    var urls = new List<string>() { Url, useproxy, xml };

    //Create thread

    Thread t1 = new Thread(new ParameterizedThreadStart(HttpPost));
    t1.Start(urls);

}

  public void SetUrls()
{
    String Url;
    int count = 1;

    string xml = CreateXML();
    string useproxy = "(none)";
    do
    {
        Url = objIniFile.GetString("Post", count.ToString(), "(none)");
        useproxy = objIniFile.GetString("Post", count.ToString() + "Proxy", "(none)").ToUpper() ;
        if (Url != "(none)")
        {

           // HttpPost(Url, xml , useproxy);
            makethread(Url , useproxy , xml);

        }
        count++;
    }
    while (Url != "(none)");
} 
```

SetUrls 获取 URL 以及是否需要使用代理并将其传递给上面的 make 线程方法，该方法将 xml 、 uri 和代理作为对象传递给 HTTP Post。

```
 public void HttpPost(object urls)
{

    string url= "none";
    string xml= "none";
    string useproxy = "none";

    int count = 0;
    //Splits Object to list and populate variables 
    foreach (var item in urls as List<string>)
    {
        if (count == 0) { url = item; }
        if (count == 1) { useproxy = item;  }
        if (count == 2) { xml = item; }
        count++;
    }

    string vystup = null;
    string proxy = ProxyAddress;

    string postData = xml;
    //--------------

    try
    {
        HttpRequestCachePolicy policy = new HttpRequestCachePolicy(HttpRequestCacheLevel.NoCacheNoStore);
        HttpWebRequest.DefaultCachePolicy = policy;

        byte[] buffer = Encoding.UTF8.GetBytes(postData);
        //Initialisation
        HttpWebRequest WebReq = (HttpWebRequest)WebRequest.Create(url);
        //method is post

        if (useproxy == "ON")
        {
            WebProxy myProxy = new WebProxy();
            // Create a new Uri object.
            Uri newUri = new Uri(proxy);

            // Associate the new Uri object to the myProxy object.
            myProxy.Address = newUri;
            WebReq.Proxy = myProxy;
        }

        WebReq.KeepAlive = false;
        WebReq.Method = "POST";
        WebReq.ContentType = "application/x-www-form-urlencoded";
        //The length of the buffer
        WebReq.ContentLength = buffer.Length;
        Stream PostData = WebReq.GetRequestStream();
        //write, and close.
        PostData.Write(buffer, 0, buffer.Length);
        PostData.Close();

        //Get the response handle
        HttpWebResponse WebResp = (HttpWebResponse)WebReq.GetResponse();
        //Let's show some information about the response
        Console.WriteLine(WebResp.StatusCode);
        Console.WriteLine(WebResp.Server);

        //Do not worry about response!.
        //read the response (the string), and output it.
        Stream Answer = WebResp.GetResponseStream();
        StreamReader _Answer = new StreamReader(Answer);
        vystup = _Answer.ReadToEnd();

        // MessageLog("Finished Posting " + DateTime.Now, "INFO");

        if (vystup != "OK")
        {

        }
    }
    catch (WebException ex)
    {

        Console.WriteLine(ex);
    }

}
#endregion 
```

如果我有 2 个工作 URL，它可以工作。如果我尝试 3 个 url（其中第二个无效），第一个将完成，但另一个不会，即使在第二个线程由于超时而退出之后！。

我想我没有正确使用线程，但我看不到任何帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:42:43.113

[您需要通过配置文件](http://msdn.microsoft.com/en-us/library/fb6y0fyc.aspx)或通过以下属性提高并发连接数： [DefaultConnectionLimit](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.defaultconnectionlimit.aspx)

# html - 用于捕获嵌套 html 标记中的特定内容的正则表达式

> ID：10689024
> 
> 赞同：1
> 
> 时间：2012-05-21T16:32:30.870
> 
> 标签：html, regex, tags, expression

在这个例子中：

```
<TR valign=top>
    <TD width=2>Region</TD>
    <TD width=3>number</TD>
</TR>
<TR valign=top>
    <TD width=2>camp</TD>
    <TD width=3>33210</TD>
</TR> 
```

需要一个正则表达式来查找“区域”单词并捕获相应的内容`<TR>...Region...</TR>` ，如下所示：`<tr [^ <tr]*(region)[^ <tr]*</tr>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T19:41:23.313

你可以试试这个：

```
<tr(?:(?!</tr>).)+(?:<td[^>]*>Region</td>)(?:(?!</tr>).)*</tr> 
```

基本上：

*   寻找`<tr`
*   `(?!</tr>`后跟任何不是结束标签的东西`(?!`都是否定的前瞻，它断言以下文本不存在
*   `.`匹配一个字符
*   `+`重复前瞻和匹配
*   `<td[^>]*>Region</td>`将行与“区域”匹配
*   `(?!</tr>).`- 与第 2 步相同 - 这次是可选的 ( `*`)
*   `</tr>`- 匹配结束标签

# wolfram-mathematica - 为什么 Mathematica 在定义参数时使用下划线？

> ID：10689029
> 
> 赞同：20
> 
> 时间：2012-05-21T16:33:02.047
> 
> 标签：wolfram-mathematica, mathematica-8

例如，如果我正在定义以下函数

```
exprod[n_] := Expand[Product[x + i, {i, 1, n}]] 
```

那么为什么变量n后面的下划线在函数定义中是必须的呢？这种风格从何而来，还是只针对 Mathematica 编程语言？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-21T16:44:19.063

下划线来自模式匹配。

x_ 匹配任何内容，并且 thisanything 绑定到函数主体中的名称 x。

```
l[x_ * y_] := l[x] + l[y]; 
```

然后在 l[2*z] 首先表达式 2*z 与模式 x_ * y_ 匹配。然后 x 绑定到 2 并且 y 绑定到 z。然后计算表达式 l[x] + l[y]，结果变为 l[2]+l[z]。

现在假设我们要将 e 上 l 的值定义为 1。我们写 l[e] := 1 还是 l[e_] := 1 ？

一个说 l 到（字面上）变量 e 必须是 1。另一个说 l 到某物给出 1。

[http://reference.wolfram.com/mathematica/tutorial/Introduction-Patterns.html](http://reference.wolfram.com/mathematica/tutorial/Introduction-Patterns.html)

# prolog - Prolog 家谱

> ID：10689032
> 
> 赞同：2
> 
> 时间：2012-05-21T16:33:21.973
> 
> 标签：prolog

我正在尝试在 Prolog 中为我的家庭作业编写一个家谱程序。这是代码的一部分。

```
/** a sample fact **/
parents(someone, someoneelse, child).

/** are M and F parents of the children in the given list? **/
parents(M,F,[]) :- parents(M,F,_).
parents(M,F,[First|Rest]) :- parents(M,F,First), parents(M,F,Rest).

/** are M and F parents? **/
parents(M,F) :- parents(M,F,_). 
```

当我使用与事实匹配的查询时，上面的代码有效。

```
 [trace] 25 ?- parents(someone,someoneelse).
       Call: (6) parents(someone, someoneelse) ? creep
       Call: (7) parents(someone, someoneelse, _G586) ? creep
       Exit: (7) parents(someone, someoneelse, child) ? creep
       Exit: (6) parents(someone, someoneelse) ? creep
    true 
    . 
```

但是当我尝试这个时：

```
[trace] 26 ?- parents(aa, bb).
   Call: (6) parents(aa, bb) ? creep
   Call: (7) parents(aa, bb, _G541) ? creep
   Call: (8) parents(aa, bb, _G541) ? creep
   Call: (9) parents(aa, bb, _G541) ? creep
   Call: (10) parents(aa, bb, _G541) ? 
... 
```

它不起作用，它进入一个无限循环。我在这里做错了什么？

编辑：我已经改变了代码：

```
/** a sample fact **/
parents(someone, someoneelse, child).

/** are M and F parents of the children in the given list? **/
parents(M,F,[]).
parents(M,F,[First|Rest]) :- parents(M,F,First), parents(M,F,Rest).

/** are M and F parents? **/
parents(M,F) :- parents(M,F,A), not(A=[]). 
```

现在我得到的是：

```
[trace] 3 ?- parents(a,b).
   Call: (6) parents(a, b) ? creep
   Call: (7) parents(a, b, _G514) ? creep
   Exit: (7) parents(a, b, []) ? creep
^  Call: (7) not([]=[]) ? creep
^  Fail: (7) not(user: ([]=[])) ? creep
   Redo: (7) parents(a, b, _G514) ? creep
   Call: (8) parents(a, b, _G508) ? creep
   Exit: (8) parents(a, b, []) ? creep
   Call: (8) parents(a, b, _G509) ? creep
   Exit: (8) parents(a, b, []) ? creep
   Exit: (7) parents(a, b, [[]]) ? creep
^  Call: (7) not([[]]=[]) ? creep
^  Exit: (7) not(user: ([[]]=[])) ? creep
   Exit: (6) parents(a, b) ? creep
true 
. 
```

我不明白为什么它现在失败后要重做。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:56:26.547

我有一种感觉，您将两个不同的谓词混淆为一个：

```
/** a sample fact **/
parents(someone, someoneelse, child).

/** are M and F parents of any child? **/
parents(M,F) :- parents(M,F,_).

/** are M and F parents of the children in the given list? **/
parents_of_all_children(M,F,[]).
parents_of_all_children(M,F,[First|Rest]) :-
    parents(M,F,First), parents_of_all_children(M,F,Rest). 
```

然后，您的查询是有意义的：

```
?- parents(someone, someoneelse, C).
C = child.
%-- someone & someoneelse have child "child"

?- parents(A, B).
A = someone,
B = someoneelse.
%-- all possible parent pairs out there

?- parents(aa, bb).
false.
%-- do "aa" & "bb" form a parents pair? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:41:31.017

你必须停止搜索。Prolog 将遍历所有规则并找到匹配项。如果匹配，那么它将通过扩展并重复该过程。

第 2 行是 inf 循环的原因，因为 don't care（来自最后一条规则）映射到 []。

如果您想知道一对是否是任何孩子的父母，您只需删除 2 条中间规则：

```
parents(M,F,[]) :- parents(M,F,_).
parents(M,F,[First|Rest]) :- parents(M,F,First), parents(M,F,Rest). 
```

# java - 使用 EasyMock 模拟 Hibernate 的 SessionFactory

> ID：10689033
> 
> 赞同：3
> 
> 时间：2012-05-21T16:33:38.397
> 
> 标签：java, hibernate, unit-testing, junit, easymock

我正在尝试为以下类编写单元测试：

```
@Transactional
public class EditorHelper {

private static SessionFactory sf;

static {        
    ClassPathResource hbr = new ClassPathResource("hibernate.cfg.xml");
    File hbCfg = null;

    try {
        hbCfg = hbr.getFile();
    } catch (IOException e) {
        e.printStackTrace();
    }
    if (hbCfg != null) {
        sf = new AnnotationConfiguration().configure(hbCfg).buildSessionFactory(); // <-- Stack trace points here
    }
}
public static void setSf(SessionFactory sf) {
    EditorHelper.sf = sf;
}
} 
```

还有其他一些方法，但是这个设置代码与我的问题相关。在我的单元测试中，我想模拟（使用 EasyMock）`SessionFactory`object `sf`，以及它将返回的`Session`and对象：`Transaction`

```
public class EditorTest {

    private SessionFactory sf;
    private Session s;
    private Transaction tx;
    private Long id = 1L;
    private String idStr = id.toString();

    @Before
    public void setUp() {

        sf = EasyMock.createMock(SessionFactory.class);
        s = EasyMock.createMock(Session.class);
        tx = EasyMock.createMock(Transaction.class);

        EditorHelper.setSf(sf); // <-- Stack trace points here

        EasyMock.expect(sf.getCurrentSession()).andReturn(s);
        EasyMock.expect(s.beginTransaction()).andReturn(tx);
    }
// Tests go here
} 
```

当我尝试使用 JUnit 运行它时，我收到以下错误：

```
java.lang.NoSuchFieldError: INSTANCE
    at org.hibernate.type.BasicTypeRegistry.<init>(BasicTypeRegistry.java:94)
    at org.hibernate.type.TypeResolver.<init>(TypeResolver.java:59)
    at org.hibernate.cfg.Configuration.<init>(Configuration.java:250)
    at org.hibernate.cfg.Configuration.<init>(Configuration.java:302)
    at org.hibernate.cfg.AnnotationConfiguration.<init>(AnnotationConfiguration.java:87)
    at com.mypkg.helper.EditorHelper.<clinit>(EditorHelper.java:38)
    at com.mypkg.model.EditorTest.setUp(EditorTest.java:29)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:49)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

我可以看到没有公共`INSTANCE`变量。`sf`我是 EasyMock 的新手，所以我想我的问题是：我应该告诉我的模拟返回什么`INSTANCE`，以及如何告诉它这样做？我根本不知道为什么`SessionFactory`要调用设置代码`setSf()`，所以这是另一个谜。更普遍的问题是：无论如何我应该如何模拟 SessionFactory 对象？

## 更新

我发现在不做任何事情的情况下捕获异常就可以了。我改变了我的`EditorHelper`班级如下：

```
@Transactional
public class EditorHelper {

private static SessionFactory sf;

static {    

...

    if (hbCfg != null) {
        try { // New try block lets the initializaiton fail
            sf = new AnnotationConfiguration().configure(hbCfg).buildSessionFactory();
        } catch (NoSuchFieldError e) {
            e.printStackTrace();
        }
    }
... 
```

一旦这个静态块完成，我可以将`SessionFactory`成员设置为指向我的模拟对象，一切都可以从那里开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T08:01:18.217

代码正在运行，因为它位于静态初始化块内。一旦您的测试引用`EditorHelper,`JVM 将加载该类，并且此初始化块将运行并尝试从使用配置 XML 文件配置`SessionFactory`的实例创建一个。`AnnotationConfiguration`

您要测试哪个课程？我注意到测试是`EditorTest`，课程是`EditorHelper`。这是故意的吗，您是否真的在尝试测试`Editor`课程？

# c# - 附加程序的 Log4Net 异常？

> ID：10689039
> 
> 赞同：0
> 
> 时间：2012-05-21T16:34:03.717
> 
> 标签：c#, logging, log4net

是否可以将 log4Net 异常记录到（或所有）有效的附加程序中？例如，我可能有

```
<appender name="ConsoleAppender" type="log4net.Appender.ColoredConsoleAppender">
   <!-- ... --->
</appender>

<appender name="FileAppender" type="log4net.Appender.RollingFileAppender">
  <!-- ... -->
</appender>

<!-- Event Log Appender for errors-->
<appender name="EventLogAppender" type="log4net.Appender.EventLogAppender" >
   <!-- ... -->
</appender>

<root>
  <level value="DEBUG" />
  <appender-ref ref="ConsoleAppender" />
  <appender-ref ref="FileAppender" />
  <appender-ref ref="EventLogAppender" />
</root> 
```

说`FileAppender`失败，[Log4Net 的默认行为](http://logging.apache.org/log4net/release/faq.html#reliability)是“向 System.Console.Error 和 System.Diagnostics.Trace 输出一条消息，指示无法执行日志记录”。有没有办法配置或扩展 Log4Net，以便它（或也）将此错误消息写入有效的附加程序？

# c - 如何在 makefile 中包含 *.so 文件

> ID：10689040
> 
> 赞同：4
> 
> 时间：2012-05-21T16:34:16.657
> 
> 标签：c, linux, gcc, x86-64, glibc

对于一个程序，我正在链接静态 glibc 库（我修改过）。我的 makefile 看起来像这样。

```
CXX = g++
CXXFILES = main.c

CXXFLAGS = -g -o prog -D_GNU_SOURCE
LIBS = ../../nptl/libpthread.a ../../libc.a -lpthread

all:
    $(CXX) $(CXXFILES) $(LIBS) $(CXXFLAGS) 
```

但是，我现在不想使用静态 *.a 文件，而是使用动态共享对象 *.so 文件。用makefile中的*.so文件替换*.a文件是否足够？如果不是这样做的正确方法是什么。我试图简单地将 *.a 替换为 makefile 中的 *.so 文件，但是当我这样做时，该程序似乎使用原始 glibc（而不是我修改过的）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T16:39:38.870

如果您不想使用标准库，则可能需要该`-nostdlib`标志。另外，如果你想动态链接库，你需要告诉链接器它们在哪里。 `-L/dir/containing -lc`.

如果您不想`LD_LIBRARY_PATH`在执行时设置 a ，则需要设置`rpath`, `-Wl,--rpath=/path/containing`。

# unix - remove white space line from same named files in multiple subdirectories in unix

> ID：10689041
> 
> 赞同：1
> 
> 时间：2012-05-21T16:34:19.617
> 
> 标签：unix, removing-whitespace

I have multiple files ( > 1000) with same name in different subdirectories

dir1/out.txt

```
 # white row
    1 2 3 4 5
    3 3 4 5 6 
    4 1 4 5 8
    # white row 
```

dir2/out.txt

```
 # white row  
    1 2 3 4 5
    3 3 4 5 6 

    4 1 4 5 8
    # white row 
```

dir3/out.txt

```
# white row 
1 2 3 4 5
3 3 4 5 6 
4 1 4 5 8
# white row 
```

I want to remove all white spaces (usually at heading row, tail row and in between rows.

Is there is quick way to do in Unix ? Apolozie for simple question.

Edit:

I am not trying to remove every space rather just whole lines that are white spaces

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:43:14.517

To remove just blank lines, use

```
sed -i '/^$/d' file 
```

To remove blank-lines containing spaces use

```
sed -i '/^[[:blank:]]*/$' file 
```

To remove all spaces from file, use

```
sed 's/ //g' file > file.new && /bin/mv file.new file 
```

Thats a space char, if the white space might include tab char, then use

```
sed 's/[[:blank:]]//g' file 
```

If you're using GNU sed on a linux, then you can do

```
sed -i 's/[[:blank:]]//g' file 
```

And if you want to delete blank lines, then add

```
 sed -i 's/[[:blank:]]//g;/^$/d' file 
```

* * *

You'd wrap all of this in a find cmd to get your file names like

```
 cd $baseDir ; find . -name '*.txt' -print | xargs sed -i 's/[[:blank:]]//g;/^$/d' {} 
```

Use just the first part,

```
 find . -name '*.txt' -print 
```

And adjust until you see the correct filename list appearing.

Then test the 2nd half, by forcing the find output to have just 1 test filename as output, i.e.

```
 find . -name 'myTestOut.txt' | xargs ... 
```

I don't have an easy way to test this now, but this sort of question gets asked every day here on S.O., search by `[unix] [linux] [xargs] [sed]` .

I hope this helps.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:04:21.483

This will find all the files named `out.txt` in subdirectories of present working directory and deletes while-space containing lines from each file.

```
find . -name "out.txt" -exec sed -i '/^$/d' '{}' \; 
```

**Note**: You must own write permissions to modify these files.

# grails - Cloudfoundry 是否支持需要更大内存的应用程序？

> ID：10689043
> 
> 赞同：3
> 
> 时间：2012-05-21T16:34:24.363
> 
> 标签：grails, permgen, cloud-foundry

我一直在使用 grails 开发一个网站，并使用 Cloudfoundry 对其进行演示。Grails 和 Cloudfoundry 太棒了！在 STS 中的 grails 插件和工具的支持下，它们易于使用。

我的应用程序使用 MySQL、MongoDB、SpringSecurity 等。我只在一个用户登录的情况下使用它，我会定期得到`java.lang.OutOfMemoryError: PermGen space`

我使用 grails 插件将内存增加到 1G。我试图设置 JAVA_OPTS 来增加内存，但这没有用。

我将检查内存的使用位置，但似乎一个用户和一小部分演示数据不应该推动内存限制。

Cloudfoundry 是否支持需要更大内存的应用程序？

阅读这篇[文章后](https://stackoverflow.com/questions/2535458/grails-application-hogging-too-much-memory)，我将 MaxPermSize 设置为 512M，并且不再出现内存不足错误。我在 Windows 上使用 grails cmdline，我不能设置多个 JAVA_OPTS，只使用列表中的第一个。`grails cf-env-add JAVA_OPTS "-XX:MaxPermSize=512m -Xms512M -Xmx512M"`这一设置增加了我的演示站点的稳定性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T18:44:22.537

原始海报在原始问题中有一个答案：

> 阅读[这篇](https://stackoverflow.com/questions/2535458/grails-application-hogging-too-much-memory)文章后，我将 MaxPermSize 设置为 512M，并且不再出现内存不足错误。我在 Windows 上使用 grails cmdline，我不能设置多个 JAVA_OPTS，只使用列表中的第一个。`grails cf-env-add JAVA_OPTS "-XX:MaxPermSize=512m -Xms512M -Xmx512M"`这一设置增加了我的演示站点的稳定性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:45:43.130

这是一个 PermGen 空间，在这种情况下它仅处于开发模式（或者当您使用 Tomcat 并重新部署您的应用程序几次时，它不是 CloudFoundry 案例）。

请参阅官方常见问题解答：[OMG 我在开发模式下运行 Grails 时遇到 OutOfMemoryErrors 或 PermGen Space 错误。我该怎么办？](http://www.grails.org/FAQ#Q%3a%20OMG%20I%20get%20OutOfMemoryErrors%20or%20PermGen%20Space%20errors%20when%20running%20Grails%20in%20development%20mode.%20What%20do%20I%20do?)

# windows - 查找直到该行并替换为另一个文本文件 windows 批处理脚本

> ID：10689045
> 
> 赞同：0
> 
> 时间：2012-05-21T16:34:53.623
> 
> 标签：windows, replace, find, batch-file

我正在尝试编写一个 Windows 批处理脚本，它将一直搜索到

例子：

```
example1
example2
example3
example4
    <jar href="example.jar" main="true"/> 
```

所以我想`( <jar href )` 用另一个文本替换文本的第一部分。我的意思是前 4 行将被另一个文本替换。批处理脚本中是否有任何查找直到和替换方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T01:15:27.787

您的特定场景很容易批量实施。我假设您想保留包含`<jar href`

您没有说替换文本的来源。我假设它来自另一个文件。

```
@echo off
set file1="test.txt"
set file2="replacement.txt"
set output="new.txt"

for /f "delims=:" %%N in ('findstr /n /c:"<jar href" %file1%') do (
  set /a skip=%%N-1
  goto :break
)
:break
(
  type %file2%
  more +%skip% %file1%
)>%output% 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T18:17:40.000

你可以这样做，但是使用 DOS 编辑 XML 并不是很容易，为了实现它，你首先需要像这样启动你的批处理文件：

```
@ECHO off
SETLOCAL ENABLEDELAYEDEXPANSION
::
:: script content here
::
PAUSE 
```

然后，您需要了解如何使用 '^' 字符通过延迟扩展来转义 '<' 和 '>' 字符。

我建议您也查看名为[DosTips](http://www.dostips.com/)的网站。

最后，[我编写了一个](http://thegreenoak.blogspot.com/2012/01/dos-batch-script-to-edit-property-files.html)编辑属性文件的脚本，这是一个您可以从中汲取一些想法的示例。

最后，如果您正在编辑的是纯 XML，您可能会在 dos 脚本中使用[XML Starlet取得一些成功。](http://xmlstar.sourceforge.net/)

# symfony - Symfony2：新的 Linux 机器上的空白页面和没有日志

> ID：10689047
> 
> 赞同：0
> 
> 时间：2012-05-21T16:34:58.383
> 
> 标签：symfony

我使用 RHEL 在一台新机器上部署了我的 SF2 应用程序。

“apache”下的 Check.php 表示缓存/日志的访问权限很好。

但是，当调用 app.php 或 app_dev.php 时，我得到一个空白响应，来自 app.php 的错误代码为 500，来自 app_dev.php 的错误代码为 200。

app/logs 中没有创建日志文件。

这是为“apache”用户运行的 check.php 输出：

```
******************************** 
* * * Symfony requirements check * * * 
******************************** 
php.ini used by PHP: /etc/php.ini 

** WARNING ** 
* The PHP CLI can use a different php.ini file 
* than the one used with your web server. 
* If this is the case, please ALSO launch this 
* utility from your web server. 
** WARNING ** 

** Mandatory requirements ** OK 
Checking that PHP version is at least 5.3.2 (5.3.3 installed) OK 
Checking that the "date.timezone" setting is set OK 
Checking that app/cache/ directory is writable OK 
Checking that the app/logs/ directory is writable OK 
Checking that the json_encode() is available OK 
Checking that the SQLite3 or PDO_SQLite extension is available OK 
Checking that the session_start() is available OK 
Checking that the ctype_alpha() is available OK 
Checking that the token_get_all() is available OK 
Checking that the APC version is at least 3.0.17 ** Optional checks ** OK 
Checking that the PHP-XML module is installed OK 
Checking that the token_get_all() function is available [[WARNING]] 
Checking that the mb_strlen() function is available: FAILED *** Install and enable the mbstring extension *** OK 
Checking that the iconv() function is available OK 
Checking that the utf8_decode() is available [[WARNING]] 
Checking that the posix_isatty() is available: FAILED *** Install and enable the php_posix extension (used to colorized the CLI output) *** [[WARNING]] 
Checking that the intl extension is available: FAILED *** Install and enable the intl extension (used for validators) *** OK 
Checking that a PHP accelerator is installed OK 
Checking that php.ini has short_open_tag set to off OK 
Checking that php.ini has magic_quotes_gpc set to off OK 
Checking that php.ini has register_globals set to off OK 
Checking that php.ini has session.auto_start set to off ** Optional checks (Doctrine) ** OK 
Checking that PDO is installed OK 
Checking that PDO has some drivers installed: pgsql, sqlite 
```

***编辑***

感谢您的所有提示-但遗憾的是没有效果...

*   .htaccess 正在工作
*   mod_rewrite 已启用
*   display_errors 开启
*   apache日志显示没有错误
*   AppKernel 路径很好
*   app_dev.php 中的 $kernel->loadClassCache() 可以（我在该行之后得到一个输出*echo ，但**处理*后没有响应

 ** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T13:24:10.487

这是我的错 - 我使用的是 ldap 包，但没有安装 php ldap 扩展。

对 ldap_connect 的调用以 @... 为前缀

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T19:13:52.540

检查 apache 日志 - 您可能会在其中找到它们

```
/var/log/apache2/errors.log 
```

或者，如果您在虚拟主机中设置了自定义日志记录位置

```
/var/log/apache2/errors-your-project.log 
```

调用 app_dev.php 可能会引发“您不允许从这里访问”错误，因为默认情况下它不允许从除本地主机之外的任何地方进行所有访问。

您的 apache 虚拟主机可能设置不正确。你会发现他们在

```
/etc/apache2/sites-available/your-project 
```*

# nhibernate - 流畅的 NHibernate - IndexOutOfRange

> ID：10689054
> 
> 赞同：5
> 
> 时间：2012-05-21T16:35:18.577
> 
> 标签：nhibernate, fluent-nhibernate, fluent-nhibernate-mapping, nhibernate-3

我已经阅读了所有帖子并且知道 IndexOutOfRange 通常会发生，因为一个列被引用了两次。但是根据我的映射，我看不出这是如何发生的。在配置中使用 SHOW_SQL 为 true 时，我看到一个 Insert 到`Events`表中，然后是一个`IndexOutOfRangeException`引用`RadioButtonQuestions`表的。我看不到它尝试使用的生成异常的 SQL。我尝试使用 AutoMapping，现在已将`ClassMap`这两个类切换为完整，以尝试缩小问题范围。

```
public class RadioButtonQuestion : Entity
{
    [Required]
    public virtual Event Event { get; protected internal set; }

    [Required]
    public virtual string GroupIntroText { get; set; }
}

public class Event : Entity
{
    [Required]
    public virtual string Title { get; set; }

    [Required]
    public virtual DateTime EventDate { get; set; }

    public virtual IList<RadioButtonQuestions> RadioButtonQuestions { get; protected internal set; }
}

public class RadioButtonQuestionMap : ClassMap<RadioButtonQuestion>
{
    public RadioButtonQuestionMap()
    {
        Table("RadioButtonQuestions");

        Id(x => x.Id).Column("RadioButtonQuestionId").GeneratedBy.Identity();

        Map(x => x.GroupIntroText);
        References(x => x.Event).Not.Nullable();
    }
}

public class EventMap : ClassMap<Event>
{
    public EventMap()
    {
        Id(x => x.Id).Column("EventId").GeneratedBy.Identity();
        Map(x => x.EventDate);
        Map(x => x.Title);
        HasMany(x => x.RadioButtonQuestions).AsList(x => x.Column("ListIndex")).KeyColumn("EventId").Not.Inverse().Cascade.AllDeleteOrphan().Not.KeyNullable();
    }
} 
```

生成的 SQL 看起来是正确的：

```
create table Events (
    EventId INT IDENTITY NOT NULL,
   EventDate DATETIME not null,
   Title NVARCHAR(255) not null,
   primary key (EventId)
)

create table RadioButtonQuestions (
    RadioButtonQuestionId INT IDENTITY NOT NULL,
   GroupIntroText NVARCHAR(255) not null,
   EventId INT not null,
   ListIndex INT null,
   primary key (RadioButtonQuestionId)
) 
```

这是使用 NH 3.3.0.4000 和 FNH 1.3.0.727。当我尝试保存新事件（附加 RadioButtonQuestion）时，我看到

NHibernate：插入事件（EventDate，标题）值（@p0，@p1）；@p0 = 5/21/2012 12:32:11 PM [类型：日期时间（0）]，@p1 = '我的测试事件' [类型：字符串（0）] NHibernate：选择@@IDENTITY

Events.Tests.Events.Tasks.EventTasksTests.CanCreateEvent：NHibernate.PropertyValueException：为Events.Domain.RadioButtonQuestion._Events.Domain.Event.RadioButtonQuestionsIndexBackref ----> System.IndexOutOfRangeException：一个SqlCeParameter 与ParameterIndex'3'的属性值脱水不包含在此 SqlCeParameterCollection 中。

因此，如果一个列确实被引用了两次，那么导致该行为的我的 FNH 配置有什么问题？我正在尝试与排序建立双向关系（一个事件有许多单选按钮问题）（我会保持它，因为 NH 不会处于双向关系，从我读过的内容来看）。`Event`FWIW我还通过删除from尝试将其作为单向关系`RadioButtonQuestion`，但仍然导致相同的异常。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T18:09:31.753

我在代码中使用映射（NH 3.3.1），我注意到添加 Update(false) 和 Insert(false) 可以解决问题：

```
ManyToOne(x => x.DictionaryEntity, map =>
{
    map.Column("Dictionary");
    map.Update(false);
    map.Insert(false);
    map.Cascade(Cascade.None);
    map.Fetch(FetchKind.Select);
    map.NotFound(NotFoundMode.Exception);
    map.Lazy(LazyRelation.Proxy);
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T18:41:48.037

您有一个双向关联，因此一侧应标记为 Inverse() 并且只能是 RadioButtonQuestions 集合。如果您希望集合成为所有者，则必须在 RadioButtonQuestion 类中删除对事件的引用。

此外，RadioButtonQuestions 表中的 EventId 列不可为空，如果集合映射不反向，这可能会导致问题。请参阅文档中的[注释](http://nhforge.org/doc/nh/en/index.html#collections-onetomany)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-16T11:45:10.767

我刚刚花了一个上午的时间来根除这个错误。IndexOutOfRangeException 最初让我走错了路，但我找到了原因。我的问题涉及使用多个组件的 FluentNHibernate 类映射；问题是两个属性被无意中错误地映射到同一列：

前：

```
// example is stripped for simplicity, note the column names
Component(mappedClass => mappedClass.MappedComponent1,
          map => 
          {
              map.Map(c => c.SomeProperty, "samecolumn");
          });

Component(mappedClass => mappedClass.MappedComponent2,
          map => 
          {
              map.Map(c => c.OtherProperty, "samecolumn");
          }); 
```

后：

```
Component(mappedClass => mappedClass.MappedComponent1,
          map => 
          {
              map.Map(c => c.SomeProperty, "firstcolumn");
          });

Component(mappedClass => mappedClass.MappedComponent2,
          map => 
          {
              map.Map(c => c.OtherProperty, "secondcolumn");
          }); 
```

这如何导致 IndexOutOfRangeException 对我来说并不明显。我猜有一个映射（源）属性数组和一个目标列数组，在这种情况下，目标数组对于源属性数组中的项目数来说太短了，因为一些目标列是相同的.

我认为，但值得为 FluentNHibernate 编写一个拉取请求来检查这一点并抛出更明确的异常。

# r - 创建一个空的data.frame

> ID：10689055
> 
> 赞同：564
> 
> 时间：2012-05-21T16:35:18.950
> 
> 标签：r, dataframe, r-faq

我正在尝试初始化没有任何行的 data.frame。基本上，我想为每列指定数据类型并命名它们，但没有创建任何行作为结果。

到目前为止，我能做的最好的事情是：

```
df <- data.frame(Date=as.Date("01/01/2000", format="%m/%d/%Y"), 
                 File="", User="", stringsAsFactors=FALSE)
df <- df[-1,] 
```

它创建了一个 data.frame ，其中包含我想要的所有数据类型和列名的单行，但也创建了一个无用的行，然后需要将其删除。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：746
> 
> 时间：2012-05-21T16:44:51.470

只需用空向量初始化它：

```
df <- data.frame(Date=as.Date(character()),
                 File=character(), 
                 User=character(), 
                 stringsAsFactors=FALSE) 
```

* * *

这是另一个具有不同列类型的示例：

```
df <- data.frame(Doubles=double(),
                 Ints=integer(),
                 Factors=factor(),
                 Logicals=logical(),
                 Characters=character(),
                 stringsAsFactors=FALSE)

str(df)
> str(df)
'data.frame':   0 obs. of  5 variables:
 $ Doubles   : num 
 $ Ints      : int 
 $ Factors   : Factor w/ 0 levels: 
 $ Logicals  : logi 
 $ Characters: chr 
```

**注意：**

用错误类型的空列初始化 a`data.frame`不会阻止进一步添加具有不同类型列的行。
这种方法*更安全*一点，因为您从一开始就拥有正确的列类型，因此如果您的代码依赖于某些列类型检查，即使 a 行为`data.frame`零，它也可以工作。

* * *

## 回答 #2

> 赞同：184
> 
> 时间：2015-07-02T20:05:58.183

如果您**已经有一个现有的数据框**，假设`df`有您想要的列，那么您可以通过删除所有行来创建一个空数据框：

```
empty_df = df[FALSE,] 
```

请注意，它`df`仍然包含数据，但`empty_df`不包含。

我发现这个问题是在寻找如何创建一个空行的新实例，所以我认为它可能对某些人有帮助。

* * *

## 回答 #3

> 赞同：85
> 
> 时间：2013-11-12T13:59:54.600

您可以在不指定列类型的情况下执行此操作

```
df = data.frame(matrix(vector(), 0, 3,
                dimnames=list(c(), c("Date", "File", "User"))),
                stringsAsFactors=F) 
```

* * *

## 回答 #4

> 赞同：66
> 
> 时间：2014-10-28T17:30:00.927

您可以使用`read.table`空字符串作为输入`text`，如下所示：

```
colClasses = c("Date", "character", "character")
col.names = c("Date", "File", "User")

df <- read.table(text = "",
                 colClasses = colClasses,
                 col.names = col.names) 
```

或者将 指定`col.names`为字符串：

```
df <- read.csv(text="Date,File,User", colClasses = colClasses) 
```

感谢 Richard Scriven 的改进

* * *

## 回答 #5

> 赞同：43
> 
> 时间：2015-09-02T00:03:48.710

只需声明

```
table = data.frame() 
```

当您尝试`rbind`第一行时，它将创建列

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2015-06-20T20:15:02.617

最有效的方法是使用`structure`创建一个具有类的列表`"data.frame"`：

```
structure(list(Date = as.Date(character()), File = character(), User = character()), 
          class = "data.frame")
# [1] Date File User
# <0 rows> (or 0-length row.names) 
```

为了与目前接受的答案相比，这是一个简单的基准：

```
s <- function() structure(list(Date = as.Date(character()), 
                               File = character(), 
                               User = character()), 
                          class = "data.frame")
d <- function() data.frame(Date = as.Date(character()),
                           File = character(), 
                           User = character(), 
                           stringsAsFactors = FALSE) 
library("microbenchmark")
microbenchmark(s(), d())
# Unit: microseconds
#  expr     min       lq     mean   median      uq      max neval
#   s()  58.503  66.5860  90.7682  82.1735 101.803  469.560   100
#   d() 370.644 382.5755 523.3397 420.1025 604.654 1565.711   100 
```

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2015-01-08T21:14:55.313

如果您正在寻找短促：

```
read.csv(text="col1,col2") 
```

所以你不需要单独指定列名。在填充数据框之前，您将获得默认的列类型逻辑。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2015-10-18T07:17:41.343

我使用以下代码创建了空数据框

```
df = data.frame(id = numeric(0), jobs = numeric(0)); 
```

并尝试绑定一些行以填充如下。

```
newrow = c(3, 4)
df <- rbind(df, newrow) 
```

但它开始给出不正确的列名，如下所示

```
 X3 X4
1  3  4 
```

解决方案是将 newrow 转换为 df 类型，如下所示

```
newrow = data.frame(id=3, jobs=4)
df <- rbind(df, newrow) 
```

现在在显示列名时给出正确的数据框，如下所示

```
 id nobs
1  3   4 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2016-08-22T16:35:14.307

要**创建一个空数据框**，请将所需的行数和列数传递给以下函数：

```
create_empty_table <- function(num_rows, num_cols) {
    frame <- data.frame(matrix(NA, nrow = num_rows, ncol = num_cols))
    return(frame)
} 
```

**要在指定每列的类的同时**创建一个空框架，只需将所需数据类型的向量传递给以下函数：

```
create_empty_table <- function(num_rows, num_cols, type_vec) {
  frame <- data.frame(matrix(NA, nrow = num_rows, ncol = num_cols))
  for(i in 1:ncol(frame)) {
    print(type_vec[i])
    if(type_vec[i] == 'numeric') {frame[,i] <- as.numeric(frame[,i])}
    if(type_vec[i] == 'character') {frame[,i] <- as.character(frame[,i])}
    if(type_vec[i] == 'logical') {frame[,i] <- as.logical(frame[,i])}
    if(type_vec[i] == 'factor') {frame[,i] <- as.factor(frame[,i])}
  }
  return(frame)
} 
```

使用如下：

```
df <- create_empty_table(3, 3, c('character','logical','numeric')) 
```

这使：

```
 X1  X2 X3
1 <NA> NA NA
2 <NA> NA NA
3 <NA> NA NA 
```

要确认您的选择，请运行以下命令：

```
lapply(df, class)

#output
$X1
[1] "character"

$X2
[1] "logical"

$X3
[1] "numeric" 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2017-03-03T20:10:29.380

如果您想使用动态名称（变量中的列名）创建一个空的 data.frame，这可能会有所帮助：

```
names <- c("v","u","w")
df <- data.frame()
for (k in names) df[[k]]<-as.numeric() 
```

如果需要，您也可以更改类型。喜欢：

```
names <- c("u", "v")
df <- data.frame()
df[[names[1]]] <- as.numeric()
df[[names[2]]] <- as.character() 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2017-10-10T16:51:59.443

如果您不介意不明确指定数据类型，您可以这样做：

```
headers<-c("Date","File","User")
df <- as.data.frame(matrix(,ncol=3,nrow=0))
names(df)<-headers

#then bind incoming data frame with col types to set data types
df<-rbind(df, new_df) 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2019-03-18T12:57:03.737

通过使用`data.table`，我们可以为每列指定数据类型。

```
library(data.table)    
data=data.table(a=numeric(), b=numeric(), c=numeric()) 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-05-03T01:42:25.510

如果你想`data.frame`用许多列声明这样的 a，手动键入所有列类可能会很痛苦。特别是如果您可以使用`rep`，这种方法既简单又快速（比可以这样概括的其他解决方案快约 15%）：

如果您想要的列类在 vector`colClasses`中，您可以执行以下操作：

```
library(data.table)
setnames(setDF(lapply(colClasses, function(x) eval(call(x)))), col.names) 
```

`lapply`将生成所需长度的列表，其中每个元素只是一个空类型向量，例如`numeric()`or `integer()`。

`setDF``list`通过引用 a 来转换它`data.frame`。

`setnames`通过引用添加所需的名称。

速度比较：

```
classes <- c("character", "numeric", "factor",
             "integer", "logical","raw", "complex")

NN <- 300
colClasses <- sample(classes, NN, replace = TRUE)
col.names <- paste0("V", 1:NN)

setDF(lapply(colClasses, function(x) eval(call(x))))

library(microbenchmark)
microbenchmark(times = 1000,
               read = read.table(text = "", colClasses = colClasses,
                                 col.names = col.names),
               DT = setnames(setDF(lapply(colClasses, function(x)
                 eval(call(x)))), col.names))
# Unit: milliseconds
#  expr      min       lq     mean   median       uq      max neval cld
#  read 2.598226 2.707445 3.247340 2.747835 2.800134 22.46545  1000   b
#    DT 2.257448 2.357754 2.895453 2.401408 2.453778 17.20883  1000  a 
```

它也比`structure`以类似方式使用更快：

```
microbenchmark(times = 1000,
               DT = setnames(setDF(lapply(colClasses, function(x)
                 eval(call(x)))), col.names),
               struct = eval(parse(text=paste0(
                 "structure(list(", 
                 paste(paste0(col.names, "=", 
                              colClasses, "()"), collapse = ","),
                 "), class = \"data.frame\")"))))
#Unit: milliseconds
#   expr      min       lq     mean   median       uq       max neval cld
#     DT 2.068121 2.167180 2.821868 2.211214 2.268569 143.70901  1000  a 
# struct 2.613944 2.723053 3.177748 2.767746 2.831422  21.44862  1000   b 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2019-08-28T12:55:16.297

如果您已经有一个数据框，您可以从数据框中**提取元数据（列名和类型）**（例如，如果您正在控制一个仅由某些输入触发**的 BUG ，并且需要一个空的虚拟数据框）：**

```
colums_and_types <- sapply(df, class)

# prints: "c('col1', 'col2')"
print(dput(as.character(names(colums_and_types))))

# prints: "c('integer', 'factor')"
dput(as.character(as.vector(colums_and_types))) 
```

然后使用`read.table`创建空数据框

```
read.table(text = "",
   colClasses = c('integer', 'factor'),
   col.names = c('col1', 'col2')) 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-08-05T07:01:44.033

我随时使用此功能，并更改列名和类以适应用例：

```
make_df <- function() { data.frame(name=character(),
                     profile=character(),
                     sector=character(),
                     type=character(),
                     year_range=character(),
                     link=character(),
                     stringsAsFactors = F)
}

make_df()
[1] name       profile    sector     type       year_range link      
<0 rows> (or 0-length row.names) 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-04-13T04:37:41.713

假设您的列名是动态的，您可以创建一个空的行命名矩阵并将其转换为数据框。

```
nms <- sample(LETTERS,sample(1:10))
as.data.frame(t(matrix(nrow=length(nms),ncol=0,dimnames=list(nms)))) 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-10-18T14:38:35.937

这个问题并没有具体解决我的担忧（[此处](https://stackoverflow.com/questions/52844649/how-to-set-the-types-of-columns-in-an-empty-data-frame)概述），但如果有人想使用参数化的列数且没有强制执行此操作：

```
> require(dplyr)
> dbNames <- c('a','b','c','d')
> emptyTableOut <- 
    data.frame(
        character(), 
        matrix(integer(), ncol = 3, nrow = 0), stringsAsFactors = FALSE
    ) %>% 
    setNames(nm = c(dbNames))
> glimpse(emptyTableOut)
Observations: 0
Variables: 4
$ a <chr> 
$ b <int> 
$ c <int> 
$ d <int> 
```

正如 divibisan 在相关问题上所说，

> ... [强制] 发生 [当 cbinding 矩阵及其组成类型时] 的原因是矩阵只能具有单一数据类型。当您 cbind 2 个矩阵时，结果仍然是一个矩阵，因此在转换为 data.frame 之前，所有变量都被强制转换为单一类型

# jquery - 背景的图案和颜色

> ID：10689057
> 
> 赞同：-1
> 
> 时间：2012-05-21T16:35:22.020
> 
> 标签：jquery, html, css

我需要为我的网站背景设置颜色和图案，但我不知道如何。有人能帮我吗？？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:39:40.353

如有疑问，请阅读手册：[http ://www.w3.org/TR/css3-background/](http://www.w3.org/TR/css3-background/)

```
#myElement{
    /* composite statement for background */
    background: #ff0000 url(some url) repeat-x top left;
}

#myElement{
  /* individual statements */
  background: white url("pendant.png");
  background-repeat: repeat-y;
  background-position: center;
} 
```

在这两种情况下，都有**许多**可用的选项和组合。

# performance - R - 使循环更快

> ID：10689059
> 
> 赞同：1
> 
> 时间：2012-05-21T16:35:28.050
> 
> 标签：performance, r

这个小代码片段应该循环通过一个排序的数据框。它记录在 aIndex 和 cIndex 列以及 bIndex 和 dIndex 列中有多少连续行具有相同信息。如果它们相同，它会存入计数并在下一次增加它，如果它们不同，它会存入计数并在下一次将其重置为 1。

```
for (i in 1:nrow(myFrame)) {
  if (myFrame[i, aIndex] == myFrame[i, cIndex] &
    myFrame[i, bIndex] == myFrame[i, dIndex]) {
      myFrame[i, eIndex] <- count
      count <- (count + 1)
  } else {
      myFrame[i, eIndex] <- count
      count <- 1
  }
} 
```

它已经运行了很长时间。我知道我应该尽可能地进行矢量化，但我在这里并没有真正看到它。我应该怎么做才能使这更快？

以下是运行后几行的示例：

```
aIndex bIndex cIndex dIndex eIndex
     1      2      1      2      1
     1      2      1      2      2
     1      2      4      8      3
     4      8      1      4      1
     1      4      1      4      1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T19:59:39.327

也许这会奏效。我已经修改了`rle`和`sequence`位。

```
dat <- read.table(text="aIndex bIndex cIndex dIndex
1 2 1 2
1 2 1 2
1 2 4 8
4 8 1 4
1 4 1 4", header=TRUE, as.is=TRUE,sep = " ")
dat$eIndex <-NA
#identify rows where a=c and b=d, multiply by 1 to get a numeric vector
dat$id<-(dat$aIndex==dat$cIndex & dat$bIndex==dat$dIndex)*1
#identify sequence
runs <- rle(dat$id)
#create sequence, multiply by id to keep only identicals, +1 at the end
count <-sequence(runs$lengths)*dat$id+1
#shift sequence down one notch, start with 1
dat$eIndex <-c(1,count[-length(count)])
dat

  aIndex bIndex cIndex dIndex eIndex id
1      1      2      1      2      1  1
2      1      2      1      2      2  1
3      1      2      4      8      3  0
4      4      8      1      4      1  0
5      1      4      1      4      1  1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T17:11:52.480

我认为这会做你想做的；棘手的部分是计数在差异*后*重置，这实际上使`eIndex`.

（希望）有一种更简单的方法可以做到这一点，但这就是我想出的。

```
tmprle <- rle(((myFrame$aIndex == myFrame$cIndex) & 
               (myFrame$bIndex == myFrame$dIndex)))
myFrame$eIndex <- c(1,
                    unlist(ifelse(tmprle$values, 
                                  Vectorize(seq.default)(from = 2,
                                                         length = tmprle$lengths), 
                                  lapply(tmprle$lengths, 
                                         function(x) {rep(1, each = x)})))
                    )[-(nrow(myFrame)+1)] 
```

这使

```
> myFrame
  aIndex bIndex cIndex dIndex eIndex
1      1      2      1      2      1
2      1      2      1      2      2
3      1      2      4      8      3
4      4      8      1      4      1
5      1      4      1      4      1 
```

# search - 同步（复制）IMAP 消息

> ID：10689062
> 
> 赞同：1
> 
> 时间：2012-05-21T16:35:34.150
> 
> 标签：search, imap

我有一个 imap 帐户（例如 some@gmail.com），并且我知道许多库，我可以通过这些库连接并将消息复制回我的目的地。我想实现以下，

1.  第一次，我想下载所有消息（包括已发送的文件夹），当我第一次下载时，我会将带有ID和UID的消息保存在本地某个数据库中。
2.  第二次，我不想查询下载的消息，即使它们的已读/未读状态或任何标志或已删除标志已更改或已被清除。
3.  我们的目标是在本地下载和同步每条消息，而且只有第一次。

现在我对 IMAP 消息知之甚少，他们有一些叫做 ID、UID 和 MessageID 的东西。ID 可能是当前文件夹中的偏移量，UID 是当前帐户中的数字 id，MessageID 是唯一字符串。

现在我想知道，在查询文件夹时我应该使用什么搜索，以便下载后的消息不会返回给我。

我打算使用[http://mailsystem.codeplex.com/](http://mailsystem.codeplex.com/)库，它可以使用自定义字符串进行搜索并返回 int 数组。

假设我有一个 MaxID，并且我只想下载 ID 或 UID 大于 MaxID 的消息。我应该使用哪一个？UID还是ID？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:26:50.167

您应该将 UID 与 UIDVALIDITY 结合使用。这两个值都是特定于文件夹的。

有一个信息 RFC 描述了 IMAP 客户端应该如何进行同步（[RFC-4549](https://www.rfc-editor.org/rfc/rfc4549)，第 4.3 节）。文中建议发出以下两条命令：

```
tag1 UID FETCH <lastseenuid+1>:* <descriptors>
tag2 UID FETCH 1:<lastseenuid> FLAGS 
```

第一个命令用于获取所有未知邮件的所需信息（不知道有多少邮件）。第二个命令用于同步已看到邮件的标志。

AFAIK 这种方法被广泛使用。因此，许多 IMAP 服务器包含优化以快速提供此信息。通常，网络带宽是限制因素。

# csv - 需要使用 .Bat 从 .Csv 文件一次读取一行并将标记分配给 vars

> ID：10689064
> 
> 赞同：0
> 
> 时间：2012-05-21T16:35:42.830
> 
> 标签：csv, batch-file, readline

我正在尝试使需要最少后台进程的工作自动化。通常我会使用 C#，但这是有问题的，因为我要自动化的是一个测试进程，它扫描系统以查找正在运行的进程。命令窗口很好，但除此之外的大多数东西都会有问题。作为开始这一系列测试的一部分，我试图找到一种方法来让批处理文件从 .csv 文件中一次读取一行。每行包含 4 个值（当然，用逗号分隔），这些值应该放入变量中。第一个 var 将是测试编号。启动批处理文件时，我将提供一个测试编号作为 arg，并希望它将收到的测试编号与它从文件中读取的测试编号进行比较。如果匹配，继续测试。如果不，转到下一行并将该数据读入变量中。其他一切都非常简单，但我不知道如何让它以所描述的方式一次一行地读取和解析 .csv 文件。任何帮助，将不胜感激。

仅供参考，我很清楚如何在 C# 中执行此操作，并且我知道还有许多其他解决方案会比批处理文件更好（更容易）。但是，在我们的情况下，使用这些解决方案是一个糟糕的主意，有一些具体的原因，所以我们正试图用批处理文件去老派。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T19:03:29.650

```
@echo off
rem Read theFile.csv and get 4 tokens separated by commas
for /F "tokens=1-4 delims=," %%a in (theFile.csv) do (
   rem Tokens read are placed in %%a, %%b, %%c and %%d replaceable parameters
   rem If first token is equal to first Batch file argument
   if %%a equ %1 (
      rem Continue testing here, ie
      echo %%a,%%b,%%c,%%d
   )
) 
```

# flash - 是否有任何有用的日志可用于调试客户端 Flex 问题？

> ID：10689065
> 
> 赞同：0
> 
> 时间：2012-05-21T16:35:42.960
> 
> 标签：flash, apache-flex, logging, error-handling, client-side

我开发了一个客户端遇到问题的基于 Web 的 Flex 应用程序。我无法重现他遇到的任何问题，听起来它正在以预期的方式使用。我查看了几条路径，但没有找到问题的原因，而且我没有太多访问用户机器/环境的权限。

由于一些严格的规则，我无法创建自己的自定义日志记录解决方案，将错误发送回服务器或将它们存储在客户端计算机上。

也就是说，是否有任何内置的 Flash 日志可以捕获堆栈跟踪并将它们记录在客户端的机器上（或记录*任何*与此相关的内容）？我可以让他寄给我一些东西，以便更好地了解可能发生的事情？提前致谢。

# extjs - 缩小 Extjs4 以用于生产

> ID：10689068
> 
> 赞同：2
> 
> 时间：2012-05-21T16:36:03.560
> 
> 标签：extjs, minify, extjs4.1

我一直在尝试遵循缩小 extjs4 的文档，但并没有取得太大进展……

应用结构是这样的

```
webapp
+---resources
¦   +---css
¦   +---images
¦   +---app
¦       +---controller
¦       +---model
¦       +---store
¦       +---view
¦       app.js
¦       login.js
+---WEB-INF
    +---classes
    +---spring
    ¦   +---appServlet
    +---views
        home.jsp
+---login.html 
```

web.xml 的欢迎文件列表是 login.html，其中包含 login.js 。在身份验证时，用户被重定向到包含 app.js 的 home.jsp。

我如何使用 sencha sdk 缩小这个？我已经尝试了几个选项（主要是 hacks）来查看输出是如何工作的，但是 all-classes.js 变成空的或者只有一两个类，但从来没有我在 app 文件夹中的自定义 .js？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T06:39:32.253

假设您使用的是[http://www.sencha.com/products/sdk-tools/download/](http://www.sencha.com/products/sdk-tools/download/)，sdk（afaik）基本上会爬取应用程序，试图像普通用户一样加载它。所以我建议修改 app.json 使得 url: 指向应用程序的可爬取版本。即使行为是淘汰未经身份验证的用户，也足以让 sencha 命令找到并遍历您的类结构。

我在这里假设你在你的各个类中正确使用了 requires 语句。

# javascript - Google 自定义搜索 - 从 url 参数手动加载/执行

> ID：10689070
> 
> 赞同：1
> 
> 时间：2012-05-21T16:36:10.253
> 
> 标签：javascript, ajax, google-custom-search

从谷歌自定义搜索中得到一些我似乎无法确定的奇怪行为。也许有人有线索。

我正在整理一个 Magento 网站，它有自己的内部搜索引擎——但仅限于产品。我也想在搜索结果页面上实现谷歌自定义搜索结果。我想我应该能够简单地根据 url 中的查询变量执行搜索（以返回所有非产品内容），如下所示：

```
 <section style="min-height:600px">
            <div style="background-color:#DFDFDF; min-height:800px; width:100%;">
                <div id="cse">Loading</div>
            </div>
        <script src="http://www.google.com/jsapi" type="text/javascript"></script>
        <script type="text/javascript"> 
        //<![CDATA[

            $(document).ready( function(){ 
                console.log('search initiated');
                var t = window.setTimeout( function(){ customSearch(); }, 5000 );
            });

            function customSearch(){
                var q = urlParams()['q'];
                if (q != undefined && q != ""){
                    console.log('q : %s', q); //outputs successfully

                    google.load('search', '1');
                    google.setOnLoadCallback(function () {
                        var customSearchControl = new google.search.CustomSearchControl(MY CUSTOM ID KEY);
                        var cseDrawOptions = new google.search.DrawOptions();
                        cseDrawOptions.setAutoComplete(true); //unknown if this is required... 
                        customSearchControl.draw('cse',cseDrawOptions);                    
                        customSearchControl.execute(q);

                    }, true);

                } 
            }

           function urlParams(){
                    var vars = []; 
                    var hash;
                    var index = window.location.href.indexOf('?');
                    if( index != -1 ){
                        var hashes = window.location.href.slice(index + 1).split('&');
                        for(var i = 0; i < hashes.length; i++){
                            hash = hashes[i].split('=');
                            vars.push(hash[0]);
                            vars[hash[0]] = hash[1].replace(/\+/g, " ");
                        }
                    }
                    return vars;
                }

        //]>
        </script>
        </section> 
```

我会注意到我已经从逻辑中提取了所有其他内容（但它在 magento 中的实现是相同的）。

所以行为是这样的：页面加载正常（出于测试目的，我正在延迟谷歌搜索并超时）。假设 url 中有一个查询变量，控制台会按预期跟踪。然后页面就被删除了，谷歌没有返回任何内容。“清除”......意味着页面上的所有元素都消失了，或者被谷歌加载的新页面覆盖。好像搜索控件没有创建 iframe - 它只是用`<body>`-less html 页面替换页面。

我已经准备了一些关于这个主题的文章，并查看了[API](https://developers.google.com/custom-search/docs/js/cselement-reference) - 这段代码看起来应该可以工作。但显然不是。

我错过了什么？

干杯 -

**更新**

继续搞砸这表明无论出于何种原因：

```
google.load('search', '1');
google.google.setOnLoadCallback( console.log('loaded') ) 
```

是替换页面问题的原因。然而，响应页面包含指向 google 托管的搜索模块的链接。如果我手动链接这些文件（放弃 a `google.load`），那么我可以按预期运行搜索：

```
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script src="http://www.google.com/uds/?file=search&v=1" type="text/javascript"></script>
<script type="text/javascript"> 
//<![CDATA[
  ... search logic 
```

[然后我在google 开发者](https://developers.google.com/loader/)页面上发现了另一种语法，它似乎可以按预期工作：

```
$(document).ready( function(){ 
        google.load("search", "1", {"callback" : customSearch});
    });

    function customSearch(){
        var q = urlParams()['q'];
        if (q != undefined && q != ""){
            var cseControl = new google.search.CustomSearchControl('MY CUSTOM KEY');

            var cseDrawOptions = new google.search.DrawOptions();
            cseDrawOptions.enableSearchResultsOnly()
            cseControl.draw('cse', cseDrawOptions);
            cseControl.execute(q);
        } 
    } 
```

哪个按预期工作。在这一点上唯一真正的问题是主机

**`Unsafe JavaScript attempt to access frame with URL http://mydomain from frame with URL http://www.google/cse?...`**

现在被抛出。

我不知道这两个不同版本的加载语法如何改变任何东西......但它似乎是。无论如何，我不清楚如何解决这些跨域错误。

想法会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:04:24.493

**没什么吧？**

好吧 - 我基本上已经找到了一个很好的解决方案，使用一种我认为从长远来看会更灵活的替代方法。使用 google的**RESTful API**和简单的 jquery`.ajax`调用，我可以获得良好、可控的结果，没有跨域错误：

```
<div id="cse">Loading</div>
<script>
    //https://developers.google.com/custom-search/v1/getting_started
    //https://developers.google.com/custom-search/v1/using_rest#query-params
    //https://developers.google.com/custom-search/v1/cse/list

    var _url    = "https://www.googleapis.com/customsearch/v1";
    var _key    = 'AIzaSy... your api key here'; 
    var _cx     = '001809... your engine id';
    var _q      = urlParams()['q'];                         //query param

    jQuery(document).ready(function() {

        $j.ajax({
            url     : _url,
            type    : 'GET',
            dataType : 'jsonp',
            data :{
                key : _key,
                cx  : _cx,
                q   :_q 
            },
            success     : function(data, textStatus, jqXHR){ responseHandler(data); },
            error       : function(jqXHR, textStatus, errorThrown){ console.log('error: %s'), errorThrown},
            beforeSend  : function(){ console.log('sending request')},
            crossDomain : true
        });

    });

    function responseHandler( response, status) {
        console.log(response);

        var cse = $j('#cse');  // render vars as needed...
        for (var i = 0; i < response.items.length; i++) {
            var item = response.items[i];
            cse.append( "<br>" + item.htmlTitle);
        }
    }

    function urlParams(){
        var vars = []; 
        var hash;
        var index = window.location.href.indexOf('?');
        if( index != -1 ){
            var hashes = window.location.href.slice(index + 1).split('&');
            for(var i = 0; i < hashes.length; i++){
                hash = hashes[i].split('=');
                vars.push(hash[0]);
                vars[hash[0]] = hash[1];
            }
        }
        return vars;
    }

</script> 
```

你也可以;D

干杯

# c++ - SDL - 跨平台开发

> ID：10689074
> 
> 赞同：4
> 
> 时间：2012-05-21T16:36:24.470
> 
> 标签：c++, cross-platform, sdl

在接下来的几个月里，我将参加一个小型游戏比赛。他们要求提交的内容能够在 Linux 上编译（并且在为比赛运行/评估之前）。我将使用 SDL 和 C++。我以前只在 Windows 上开发过，而且我已经非常习惯于 Visual Studio 提供的好处。我希望能够在 Windows 中使用 VS 进行开发，然后在流程快结束时将其迁移到 linux。除了确保 SDL 已经安装在 Linux 机器上之外，在整个开发过程中我还可以做些什么来简化这个过程？此外，所有这些的竞赛规则都规定：

***它还必须在开放平台上运行（我们强烈建议确保您的程序在现代风格的 GNU/Linux 上运行，因为所有评委都可以访问它）。***

我假设在 Ubuntu 中编译/运行（已经有一个家庭服务器）就足够了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:45:31.937

您的问题有点开放，但我的第一个建议是从第一**天开始就使用适当的跨平台构建系统，例如**[CMake](http://www.cmake.org) 。最后我会避免“迁移”到 Linux。您可能处于一个粗略的时间表（并且可能会遇到您没有预料到的问题）。因此，*持续*构建（工作）Linux 版本将有助于减轻您的担忧。

 ***此外，如果游戏打算仅在 Linux 下运行，为什么不将 Ubuntu 安装在某个虚拟机中并熟悉其中一种开发环境，例如 kdevelop 或 qtcreator？*与您正在开发的平台**直接*联系不会让事情变得更容易吗？

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:47:10.050

我正在开发游戏并像你一样开始。我建议您为此目的使用[SFML库。](http://sfml-dev.org/)它不是很大，而且是非常好的开始。

在那里你可以使用：

*   2D 渲染器 (OpenGL)
*   字体
*   计时器
*   围绕图像/精灵的包装器
*   后期效果/着色器
*   声音
*   网络

在[此](http://sfml-dev.org/tutorials/1.6/)页面中，您可以找到一些启动示例。****

# javascript - 无法在 javascript 中读取对象属性

> ID：10689077
> 
> 赞同：1
> 
> 时间：2012-05-21T16:36:40.613
> 
> 标签：javascript, jquery

试图通过监听对象及其属性来隐藏左/右导航文本。

工作示例：http: [//jsfiddle.net/ylokesh/9EyEu/29/](http://jsfiddle.net/ylokesh/9EyEu/29/)

但是，出现以下错误“Uncaught TypeError: Cannot call method 'hide' of undefined”

```
if(!scroller) { var scroller = {}; }

            scroller = {
                next : "#leftControl",
                prev : "#rightControl",
                videos : {
                    hideButtons : function() {
                        var obj = this;
                        obj.next.hide();
                        obj.prev.hide();
                    },
                    init : function() {
                        var obj =  this;
                        obj.hideButtons();
                    }
                },
                init : function() {
                    var obj =  this;
                    obj.videos.init(); 
                }                            
            }

scroller.init();​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:49:26.140

@Lokesh您的JavaScript错误是因为`next`and`prev`是字符串并且它们没有该`hide`方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T16:43:35.883

这是该问题的更正js：

```
var scroller = {
    next : "#leftControl",
    prev : "#rightControl",
    videos : {
        hideButtons : function() {
            $(scroller.next).hide();
            $(scroller.prev).hide();
        },
        init : function() {
            this.hideButtons();
        }
    },
    init : function() {
        scroller.videos.init(); 
    }                            
};

scroller.init();​ 
```

如您所见，我引用了`scroller`对象而不是`this`. 在您设置关键字未引用对象`var obj = this`的情况下。`this``scroller`

# html - 实现这种导航效果的最有效方法是什么？

> ID：10689079
> 
> 赞同：1
> 
> 时间：2012-05-21T16:36:47.023
> 
> 标签：html, css, navigation, mouseover

我正在尝试以尽可能小的占用空间来实现[这种](http://i.imgur.com/sKnJL.png)鼠标悬停效果。我无法显示箭头（.png），它被高度切断，我不确定如何显示高度。到目前为止，我已经尝试了几种失败的方法，希望有人可以帮助我。

我所做的是设置框的锚点样式并尝试将小箭头定位在框下方。箭头没有显示在锚框的外部，它被切断了。我尝试将箭头作为 LI 的一部分，它起作用了，但是因为锚点需要为 30px（蓝色框的高度）并且 LI 需要为 40px（框 + 箭头的高度 10px）它会显示箭头如果您将鼠标悬停在该 10px 区域而不是框上。

目前它[看起来像这样](http://i.imgur.com/dGaoI.png)。

这是我的CSS：

```
#navlist {
float:right;
}
#navlist li {
line-height:40px;
display:inline;
list-style-type: none;
margin-right: 20px;
}
#navlist li:hover {
background:url(../img/navArrow.png) no-repeat center;
background-position:50% 30px;
}
#navlist li a {
height:30px;
padding:3px 5px 3px 5px;
color:#26627f;

}
#navlist li a:hover {
background:#035173;
border-radius:3px;
color:#fff;
} 
```

这是html：

```
<ul id="navlist">
    <li><a href="#">Get a Quote</a></li>
    <li><a href="#">Learn about Life Insurance</a></li>
    <li><a href="#">Our Company</a></li>
    <li><a href="#">Get Help</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T16:50:35.630

您可以简单地将以下内容添加到您的 CSS 中：

```
#navlist li:hover a::after,
#navlist li a:hover::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    margin: 0 0 0 -1em;
    border: 1em solid transparent;
    border-top-color: #035173;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/LQDVP/2/)。

当然，这确实需要用户拥有一个实现 CSS 生成的内容和伪元素的浏览器。

* * *

**针对 OP 的评论进行了**编辑，在下面的评论中：****

 **> 不太清楚你是如何从中得到一个形状的，愿意解释一下吗？有用。有什么办法可以让箭头变小并且可以产生箱形阴影效果吗？

它之所以起作用，是因为元素的边界在 45° 处相遇，并且因为没有`height`/`width`用于产生三角形“指向”元素中心（或者，在本例中为伪元素）的元素。如果所有四个边框都可见，那么您将有一个正方形；如果顶部和底部可见，您将有一个三角形的“沙漏”，等等。

要使三角形更小，只需为边框宽度分配一个更小的单位（在上面的示例中，边框设置为`1em`，只需将其更改`5px`为浏览器可以实现的任何其他尺寸和测量单位。

负边距左（声明`-1em`中的 the `margin`）必须等于 ，`border-width`以便将伪元素沿水平轴居中放置，但可以根据需要调整它。

添加 a`box-shadow`是很困难的，因为必须分配所有四个边框来创建三角形，这`box-shadow`将是整个元素的矩形，而不仅仅是它的“可见”部分。可以模拟它，如果您可以使用另一个伪元素，在这种情况下是`::before`，但它不会具有真正的通常的“模糊性” `box-shadow`，但是，作为演示，只需复制上面的 CSS，修改`::after`to `::before`（并确保该元素`::before`出现*在*for 的声明之前`::after`，因为稍后声明的元素将在先前声明的元素之上）。调整边距和`border-top-color`属性，它应该看起来不错：

```
#navlist li:hover a::before,
#navlist li a:hover::before {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    margin: 0 0 0 -0.7em;
    border: 1em solid transparent;
    border-top-color: #ccc;
}

#navlist li:hover a::after,
#navlist li a:hover::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    margin: 0 0 0 -1em;
    border: 1em solid transparent;
    border-top-color: #035173;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/LQDVP/4/)。**

# objective-c - NSArray 和快速枚举，总是按索引顺序排列？

> ID：10689081
> 
> 赞同：8
> 
> 时间：2012-05-21T16:37:10.783
> 
> 标签：objective-c, ios

数组的快速枚举总是按索引顺序排列吗？

```
for (NSDictionary *zone in myArray)
{
    //do code
} 
```

是否总是从索引位置 0、1、2、...、n 枚举？

我更喜欢快速枚举而不是标准 for 循环，因为它使代码更易于阅读。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-21T16:39:30.960

是的，它会的：

> 对于具有明确定义顺序的集合或枚举器（例如从数组派生的 NSArray 或 NSEnumerator 实例），枚举按该顺序进行，因此只需计算迭代次数即可在需要时为您提供适当的集合索引。

[文档在这里](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocFastEnumeration.html#//apple_ref/doc/uid/TP30001163-CH18-SW4)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T16:38:19.037

要快速枚举具有索引的数组，请使用块：

```
[myArray enumerateObjectsUsingBlock:^(NSObject *object, NSUInteger idx, BOOL *stop) {
   ...
   // idx is myArray's index
}]; 
```

# c# - 使用 Reflection.SetValue 时如何提供转换？

> ID：10689083
> 
> 赞同：4
> 
> 时间：2012-05-21T16:37:20.197
> 
> 标签：c#, reflection

我有一个伪装成 int 的类，所以它重载了各种运算符；

```
public class MyId
{
    int value;
    public virtual int Value
    {
        get { return this.value; }
        set { this.value = value; }
    }

    public MyId(int value)
    {
        this.value = value;
    }

    public static implicit operator MyId(int rhs)
    {
        return new MyId(rhs);
    }

    public static implicit operator int(MyId rhs)
    {
        return rhs.Value;
    }

} 
```

但是，当我使用类似的代码时

```
PropertyInfo.SetValue(myObj, 13, null)
OR
MyId myId = 13;
int x = Convert.ToInt32(myId);
IConvertible iConvertible = x as IConvertible;
iConvertible.ToType(typeof(MyId), CultureInfo.CurrentCulture); 
```

我得到无效的演员表。我很困惑，这两个调用似乎都试图在 int 上调用 convert ，这将失败，因为 int 不理解 MyId 类型（即使所有赋值运算符都在那里）。对此有任何解决方法的想法，我确定我一定错过了一些愚蠢的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T23:08:23.277

隐式转换是 C# 构造，不能通过反射获得。此外，通过反射设置字段或属性意味着您*必须预先*提供适当的类型。您可以尝试通过使用自定义 TypeConverter（或其他一些自定义转换方式）来帮助在运行时在使用反射之前转换您的类型来规避这种情况。这是 TypeConverter 实现的粗略示例。

```
public class MyIdTypeConverter : TypeConverter
{                
    public override object ConvertFrom(ITypeDescriptorContext context,
                                       System.Globalization.CultureInfo culture,
                                       object value)
    {   
        if (value is int)
            return new MyId((int)value);
        else if (value is MyId)
            return value;
        return base.ConvertFrom(context, culture, value);
    }               
} 
```

这是我们试图设置`Custom`属性的类型。

```
public class Container
{
    [TypeConverter(typeof(MyIdTypeConverter))]
    public MyId Custom { get; set; }                
} 
```

调用它的代码必须检查属性并提前执行转换，然后才能调用`SetValue`.

```
var instance = new Container();
var type = typeof(Container);
var property = type.GetProperty("Custom");

var descriptor = TypeDescriptor.GetProperties(instance)["Custom"];
var converter = descriptor.Converter;                
property.SetValue(instance, converter.ConvertFrom(15), null); 
```

# php - 在 PHP 中检查整数是否为回文？

> ID：10689087
> 
> 赞同：1
> 
> 时间：2012-05-21T16:37:36.613
> 
> 标签：php, palindrome

> **可能重复：**
> [如何检查一个数字是否是回文？](https://stackoverflow.com/questions/199184/how-do-i-check-if-a-number-is-a-palindrome)

如果不允许将整数视为字符串并且不允许进行类型转换，我们如何确定该数字是否为回文（在 PHP 中）？

我想出的程序是：

```
function checkPalindrome($number){
    $reverse_number = 0;
    $number_backup  = $number;
    while($number > 0){
      $reverse_number = $reverse_number * 10 + $number % 10;
      $number /= 10;
    }
    return $reverse_number == $number_backup;
} 
```

在步骤“$number/=10”处，生成的结果将不是造成问题的整数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T16:46:47.490

如果不允许类型转换并且禁止字符串处理，则需要进行一些额外的计算：

```
while($number > 0){
  $lsd = $number % 10;
  $reverse_number = $reverse_number * 10 + $lsd;
  $number = ($number - $lsd) / 10;
} 
```

# c# - ASP:CHART 图例复选框系列控件

> ID：10689088
> 
> 赞同：0
> 
> 时间：2012-05-21T16:37:37.753
> 
> 标签：c#, mschart

我有一个功能齐全的动态图表控件（只是普通的 ASP.net 图表）它工作得很好，但我在尝试向图例添加复选框时遇到了问题。我正在尝试将它们添加到系列名称旁边，以便用户可以隐藏或查看相应的系列数据。该图表绘制了大约 42 名员工的数据。所以能够选择和隐藏数据是非常重要的。我已经研究了几天了，我找到了第 3 方图表工具的示例，但我需要在 MSVS 2010 标准图表工具中执行此操作。

这就是我创建图表的方式。

```
 for (int emp = 1; emp < empRowList.Length; emp++)
        {
            chartB.Series.Add(empRowList[emp]);
            chartB.Series[empRowList[emp]].ChartType = SeriesChartType.Point;
            chartB.Series[empRowList[emp]].MarkerSize = 10;
            chartB.Series[empRowList[emp]].MarkerStyle = MarkerStyle.Star4;            

            for (int month = 1; month < 12; month++)
            {
                    chartB.Series[empRowList[emp]].Points.AddXY(mfi.GetMonthName(month), employeeStats[month, emp]);
                    chartB.Series[empRowList[emp]].Points[chartB.Series[empRowList[emp]].Points.Count - 1].ToolTip = empRowList[emp] + " - " + employeeStats[month, emp];                   
            }
        } 
```

这是我格式化图表的方式

```
 chartB.DataSource = t.Tables["info"];
 chartB.DataBind();
 chartB.Legends.Add(new Legend("Legend"));
 chartB.Legends["Legend"].Alignment = StringAlignment.Center;
 chartB.Legends["Legend"].Docking = Docking.Top; 
```

我浏览了这篇文章，认为可以对其进行扩充以提供帮助，但是由于他的系列不是动态添加的，因此我不确定这是否是正确的追求方向。

[ASP .net 4 Chart Control Legend 格式根本不显示](https://stackoverflow.com/questions/8485460/asp-net-4-chart-control-legend-formatting-is-not-displaying-at-all)

我也研究过使用自定义图例，但读到它们没有链接到数据，所以我认为这也可能是错误的方向。

如果有人可以提供帮助，我将不胜感激，直到我弄清楚这一点。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T18:57:05.330

当我想做类似的事情时，这方面的一些代码会很棒。

然而，我确实在 msdn 上找到了一个帖子，指出自定义图例是不可能的。

[http://msdn.microsoft.com/en-us/library/bb677428(v=sql.100).aspx](http://msdn.microsoft.com/en-us/library/bb677428(v=sql.100).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T13:36:10.537

我能够使用上面链接中的代码找到类似于我想要的解决方案，但永远无法让图例正常工作，所以我放弃了这个想法，只是在我的图表下方动态创建了一个隐藏/显示的复选框库系列。只需要创建一个类并处理点击事件与图形的重绘并不太难。

# c++ - 基于二维数组初始化向量

> ID：10689090
> 
> 赞同：1
> 
> 时间：2012-05-21T16:37:39.240
> 
> 标签：c++

我有一个 Visual Studio 2008 C++03 应用程序，我想在其中基于二维数组初始化一个 std::vector。

例如：

```
#define DATA_SIZE 6

struct Data
{
    UINT a;
    BYTE b;
    BYTE c;
    BYTE d;

    Data()
        : /* initialize all members to 0*/
    {
    };

    explicit Data( const BYTE data[ DATA_SIZE ] )
        : a( data[ 0 ] << 16 | data[ 1 ] << 8 | data[ 2 ] ),
          b( data[ 3 ] ),
          c( data[ 4 ] ),
          d( data[ 5 ] )
    {
    };
};

inline bool operator==( const Data& lhs, const Data& rhs )
{
    return /* true if all members are equal */
};

int main( int argc, char* argv[] )
{
    const BYTE source[][ DATA_SIZE ] = 
    {
        { 0x01, 0xfe, 0xaa, 0x01, 0xcc, 0x13 },
        { 0x02, 0xa1, 0x02, 0xbb, 0x02, 0xdd }
    }

    // how should this be done?
    std::vector< Data > data_list( source[ 0 ], source[ countof( source) - 1 ] );

    ASSERT( data_list[ 0 ] == Data( source[ 0 ] ) );
    ASSERT( data_list[ 1 ] == Data( source[ 1 ] ) );
    return 0;
} 
```

有没有办法做到这一点，而无需`for`循环遍历`data`数组中的每个项目并调用`push_back`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:07:34.163

您可以做出的最少更改是：

```
std::vector< Data > data_list(
  &source[ 0 ],
  &source[ countof( source) ] ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:09:27.177

这是一种使用[Boost.Array](http://www.boost.org/libs/array/)的方法：

```
#include <cstddef>
#include <cassert>
#include <vector>
#include <boost/array.hpp>

typedef unsigned UINT;
typedef unsigned char BYTE;

std::size_t const DATA_SIZE = 6;

struct Data
{
    UINT a;
    BYTE b, c, d;

    Data() : a(), b(), c(), d() { }

    Data(boost::array<BYTE, DATA_SIZE> const& data)
      : a(data[0] << 16 | data[1] << 8 | data[2]),
        b(data[3]),
        c(data[4]),
        d(data[5])
    { }
};

inline bool operator ==(Data const& lhs, Data const& rhs)
{
    return lhs.a == rhs.a
        && lhs.b == rhs.b
        && lhs.c == rhs.c
        && lhs.d == rhs.d;
}

int main()
{
    boost::array<boost::array<BYTE, DATA_SIZE>, 2> const source =
    {{
        {{ 0x01, 0xfe, 0xaa, 0x01, 0xcc, 0x13 }},
        {{ 0x02, 0xa1, 0x02, 0xbb, 0x02, 0xdd }}
    }};

    std::vector<Data> data_list(source.begin(), source.end());

    assert(data_list[0] == Data(source[0]));
    assert(data_list[1] == Data(source[1]));
} 
```

[在线演示](http://ideone.com/IObyG)。

# javascript - 如何在 Bing Maps AJAX Control 7.0 版中绑定切片图层

> ID：10689093
> 
> 赞同：0
> 
> 时间：2012-05-21T16:37:44.863
> 
> 标签：javascript, ajax, bing-maps

我一直在尝试将 Weather Central 中的图块叠加到 Bing 地图上，但遇到了问题。我可以调用一个图块并将其推到地图上，但是，无论图块有多大，它都会将图块放在地图上的任何位置。我希望能够将其绑定到特定位置，但无法弄清楚 7.0 中的方式。在 6.3 中，规范似乎很简单：http: [//msdn.microsoft.com/en-us/library/bb429629.aspx](http://msdn.microsoft.com/en-us/library/bb429629.aspx)但在 7.0 中没有。他们在这里有一个例子：http: [//www.bingmapsportal.com/isdk/ajaxv7#TileLayers1](http://www.bingmapsportal.com/isdk/ajaxv7#TileLayers1)但即使使用他们的代码，它仍然会将瓷砖放在任何地方。

到目前为止，这是我的代码： function GetMap() {

```
 map = new Microsoft.Maps.Map(document.getElementById("mapDiv"), { credentials: "my creds" });
          var tileSource = new Microsoft.Maps.TileSource({ uriConstructor: 
          'http://datacloud.wxc.com/?type=tile&datatype=forecast&var=Temperature&time=now&bing=023212&vs=0.9&passkey=my_passkey', height: 256, width: 256});
          var tilelayer = new Microsoft.Maps.TileLayer({ mercator: tileSource, opacity: .7 });

           // Push the tile layer to the map
           map.entities.push(tilelayer); 
```

}

我在哪里执行函数 GetMap() onload。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T20:37:08.883

看起来您在请求中硬编码了一个特定的平铺四键 (023212) - 您需要将其替换为 {quadkey} 占位符以请求每个位置的适当平铺图像。IE：

```
map = new Microsoft.Maps.Map(document.getElementById("mapDiv"), { credentials: "my creds" });
var tileSource = new Microsoft.Maps.TileSource({ uriConstructor: 
  'http://datacloud.wxc.com/?type=tile&datatype=forecast&var=Temperature&time=now&bing={quadkey}&vs=0.9&passkey=my_passkey', height: 256, width: 256});
var tilelayer = new Microsoft.Maps.TileLayer({ mercator: tileSource, opacity: .7 });

// Push the tile layer to the map
map.entities.push(tilelayer); 
```

（未经测试，因为我没有访问相关服务的密钥）

# jquery-mobile - jQuery Mobile 的平移和缩放图像

> ID：10689097
> 
> 赞同：0
> 
> 时间：2012-05-21T16:37:53.123
> 
> 标签：jquery-mobile, zooming, pan

对于 jquery 移动网络应用程序的平移和缩放，我将不胜感激。我有一张建筑平面图的图像，上面有一张图像地图，我希望用户能够从他的手机查看、放大和缩小并将感兴趣的区域平移到视图中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:42:02.297

这应该可以解决问题。[http://www.photoswipe.com/](http://www.photoswipe.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T09:48:18.097

我用 OpenLayers 解决了我的问题，图像现在平移和缩放[http://dev.openlayers.org/releases/OpenLayers-2.11/examples/image-layer.html](http://dev.openlayers.org/releases/OpenLayers-2.11/examples/image-layer.html)

现在必须弄清楚如何将它与 imagemapster 结合起来.. (http://www.outsharked.com/imagemapster/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T05:11:04.107

我一直在研究同样的问题，办公室的办公桌平面图应该根据办公桌的状态（空、已分配、热坐等）以不同的颜色显示。

除此之外，如果用户单击办公桌，则应显示分配的员工/员工的详细信息。

上述要求已使用 image mapster jquery 插件实现。

并且还应该提供缩放和平移。对于缩放和平移，我找到了最适合我要求的 gzoom 插件。但与图像映射器插件一起使用时，它无法按预期工作。

感谢您对此的帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-26T12:33:44.480

我想通了，从 OpenLayers 示例中得到了我需要的一切

```
<script type="text/javascript">
        var map;

        function init(){
            map = new OpenLayers.Map('map');
            var options = {numZoomLevels: 3}
            var floorplan = new OpenLayers.Layer.Image(
            'Floorplan Map',
            '../../temp_photos/sample-floor-plan.jpg',
            new OpenLayers.Bounds(-180, -90, 180, 90),
        new OpenLayers.Size(275, 190),
            options
        );
            map.addLayer(floorplan);
            //Create a Format object
            var vector_format = new OpenLayers.Format.GeoJSON({}); 

            //Create a Protocol object using the format object just created
            var vector_protocol = new OpenLayers.Protocol.HTTP({
                url: '../../controller?action=GET_FLOOR_FEATURES',               
                format: vector_format
            });

            //Create an array of strategy objects
            var vector_strategies = [new OpenLayers.Strategy.Fixed()];

            //Create a vector layer that contains a Format, Protocol, and Strategy class
            var vector_layer = new OpenLayers.Layer.Vector('More Advanced Vector Layer',{
                protocol: vector_protocol,
                strategies: vector_strategies 
            });

            map.addLayer(vector_layer);
               //Create and add selectFeature control
            var select_feature_control = new OpenLayers.Control.SelectFeature(
            vector_layer, 
            {
                multiple: false,
                toggle: true,
                toggleKey: 'ctrlKey',
                multipleKey: 'shiftKey' 
            }
        );
            map.addControl(select_feature_control); 

            //Activate the control
            select_feature_control.activate();

            //Finally, let's add some events so we can do stuff when the user 
            //  interacts with the features
            function selected_feature(event){
                //clear out the log's contents
                document.getElementById('map_feature_log').innerHTML = '';

                //Show the current selected feature (passed in from the event object)
                var display_text = 'Clicked on: ' 
                    + '<strong>' + event.feature.attributes.location + '</strong>'
                    + ': ' + event.feature.attributes.description + '<hr />';
                document.getElementById('map_feature_log').innerHTML = display_text;

                //Show all the selected features
                document.getElementById('map_feature_log').innerHTML += 'All selected features: ';

                //Now, loop through the selected feature array 
                for(var i=0; i<vector_layer.selectedFeatures.length; i++){
                    document.getElementById('map_feature_log').innerHTML += 
                        vector_layer.selectedFeatures[i].attributes.location + ' | ';
                }
            }
            function unselected_feature(event){
                var display_text = event.feature.attributes.location + ' unselected!' + '<hr />';
                document.getElementById('map_feature_log').innerHTML = display_text;

                //Show all the selected features
                document.getElementById('map_feature_log').innerHTML += 'All selected features: ';

                //Now, loop through the selected feature array 
                for(var i=0; i<vector_layer.selectedFeatures.length; i++){
                    document.getElementById('map_feature_log').innerHTML += 
                        vector_layer.selectedFeatures[i].attributes.location + ' | ';
                }
            }

            //Register the event
            vector_layer.events.register('featureselected', this, selected_feature);
            vector_layer.events.register('featureunselected', this, unselected_feature);

           if(!map.getCenter()){
                 map.setCenter(new OpenLayers.LonLat(0, 0),1);
            }
        }
    </script> 
```

标记：图像层示例

```
 <p id="shortdesc">
        This is a floor plan for the first floor of the Science Building
    </p>

    <div id="map" class="smallmap"></div>

    <div id="docs"><div id='map_feature_log'></div>
        <p class="caption">
            This test shows how to display an image of a floorplan as a 
            base layer and then draw vectors on top of that, on a new layerage
        </p>
        <p>
            When vector is added popup appears with that vector's information
        </p>
    </div>
</body> 
```

我从服务器获取我的功能：

```
package actions;

import control_layer.Action;
import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession; 
```

/** * * @author christina */ public class GetFloorFeatures implements Action {

```
private static final int MAX_INACTIVE_INTERVAL = 900; // 15 minutes
private String view;

@Override
public boolean execute(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {
    HttpSession session = req.getSession(true);
    System.out.println("------------ In GetFloorFeatures");
    session.setMaxInactiveInterval(MAX_INACTIVE_INTERVAL);

    view = "pages/maps/displayFloorFeatures.jsp";
    return true;
}

@Override
public String getView() {
    return view;
}

@Override
public Object getModel() {
    return null;
} 
```

}

数据在 jsp 文件中被硬编码，但最终将由数据库查询生成：

```
<%@page contentType="application/json" pageEncoding="UTF-8"%>
<% response.setContentType("application/json");
//harcoded now, later will call database query to retrieve features for this floor
String floorFeatureVectors = "{\"type\": \"FeatureCollection\",\"features\":     [{\"type\":\"Feature\", \"id\":\"OpenLayers.Feature.Vector_84\",        \"properties\":{\"location\": \"Telecom Lab\",\"description\": \"Stand back, I'm going to try science!\"}, \"geometry\":{\"type\":\"Polygon\", \"coordinates\":[[[9, -52.342105263158], [9.4736842105263, -79.815789473684], [40.263157894737, -78.868421052632], [43.105263157895, -78.394736842105], [44.526315789474, -51.394736842105], [9, -52.342105263158]]]}, \"crs\":{\"type\":\"OGC\", \"properties\":{\"urn\":\"urn:ogc:def:crs:OGC:1.3:CRS84\"}}},"
    +   "{\"type\":\"Feature\", \"id\":\"OpenLayers.Feature.Vector_85\", \"properties\":{\"location\": \"MUSIC lab\",\"description\": \"Laboratory of Distributed Multimedia Information Systems and Applications \"}, \"geometry\":{\"type\":\"Polygon\", \"coordinates\":[[[-113.21052631579, 4.9736842105263], [-113.68421052632, -11.605263157895], [-76.263157894737, -13.026315789474], [-76.263157894737, -1.1842105263158], [-93.315789473684, -0.71052631578947], [-93.789473684211, 4.0263157894737], [-113.21052631579, 4.9736842105263]]]}, \"crs\":{\"type\":\"OGC\", \"properties\":{\"urn\":\"urn:ogc:def:crs:OGC:1.3:CRS84\"}}},"
    +   "{\"type\":\"Feature\", \"id\":\"OpenLayers.Feature.Vector_86\", \"properties\":{\"location\": \"Main Entrance Science Building\",\"description\": \"Caffeteria \"}, \"geometry\":{\"type\":\"Point\", \"coordinates\":[-8.0526315789474, 36.710526315789]}, \"crs\":{\"type\":\"OGC\", \"properties\":{\"urn\":\"urn:ogc:def:crs:OGC:1.3:CRS84\"}}}"

    + "]}";%><%=floorFeatureVectors%> 
```

# xslt - 在 XSLT 1.0 中扩展日期时间范围

> ID：10689099
> 
> 赞同：2
> 
> 时间：2012-05-21T16:38:08.163
> 
> 标签：xslt, datetime, xslt-1.0

我有一个我想与之交互的日期的事件的 XML 提要。

**源 XML：**

```
<?xml version="1.0" encoding="UTF-8"?>
<events>
  <event>
    <!-- various elements -->
    <start_datetime value="2012-02-09 10:00:00"/>
    <end_datetime value="2012-02-09 11:00:00"/>
    <!-- various elements -->
  </event>
  <event>
    <!-- various elements -->
    <start_datetime value="2012-02-09 10:00:00"/>
    <end_datetime value="2012-02-10 15:00:00"/>
    <!-- various elements -->
  </event>
  <!-- other events -->
</events> 
```

请注意，这`/events/event[1]`是一个在同一天开始和结束的事件；`/events/event[2]`，另一方面，跨越两天。这是我想要完成的：

1.  对于同一天的事件，不要管日期时间，只需将这些属性转换为子元素。
2.  对于跨越多天的事件，我想创建多个`<event>`元素，它们 (a) 与整体时间跨度相匹配，并且 (b) 在适当的情况下，跨越一整天的时间。

所以，我理想的 XSLT 会产生：

**所需的 XML：**

```
<?xml version="1.0" encoding="UTF-8"?>
<events>
  <event>
    <!-- various elements -->
    <start_datetime>2012-02-09 10:00:00</start_datetime>
    <end_datetime>2012-02-09 11:00:00</end_datetime>
    <!-- various elements -->
  </event>
  <event>
    <!-- various elements -->
    <start_datetime>2012-02-09 10:00:00</start_datetime>
    <end_datetime>2012-02-09 23:59:59</end_datetime>
    <!-- various elements -->
  </event>
  <event>
    <!-- various elements -->
    <start_datetime>2012-02-10 00:00:00</start_datetime>
    <end_datetime>2012-02-10 15:00:00</end_datetime>
    <!-- various elements -->
  </event>
  <!-- other events -->
</events> 
```

注意我的规则是如何得到满足的：

*   因为`/events/event[1]`发生在同一天，我们不理会它（除了将属性值更改为子元素的琐碎任务）。
*   `/events/event[2]`跨越两天，这意味着它需要两个`<event>`块（一个从开始日期时间到该日期的晚上 11:59:59，一个从结束日期的 00:00:00 到结束日期时间）。

**最后的考虑：**

*   这需要在 XSLT 1.0 中完成。

*   我不反对使用 EXSLT 的日期函数——但是，如果可以避免它们，那将是可取的。

清如泥？一如既往，感谢您的帮助。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T22:02:40.920

这是一个 XSLT 1.0 解决方案，它不使用 EXSLT 日期函数，而是使用命名模板将一个添加到给定日期，使用字符串操作函数从日期字符串中增加年、月和日

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>

   <xsl:template match="event" name="event">
      <xsl:param name="start_datetime" select="start_datetime/@value"/>
      <xsl:variable name="end_datetime" select="end_datetime/@value"/>
      <event>
         <xsl:apply-templates select="start_datetime/preceding-sibling::node()"/>
         <start_datetime>
            <xsl:value-of select="$start_datetime"/>
         </start_datetime>
         <end_datetime>
            <xsl:choose>
               <xsl:when test="substring($start_datetime, 1, 10) = substring($end_datetime ,1, 10)">
                  <xsl:value-of select="$end_datetime"/>
               </xsl:when>
               <xsl:otherwise>
                  <xsl:value-of select="concat(substring($start_datetime, 1, 10), ' 23:59:59')"/>
               </xsl:otherwise>
            </xsl:choose>
         </end_datetime>
         <xsl:apply-templates select="end_datetime/following-sibling::node()"/>
      </event>
      <xsl:if test="substring($start_datetime, 1, 10) != substring($end_datetime ,1, 10)">
         <xsl:call-template name="event">
            <xsl:with-param name="start_datetime">
               <xsl:call-template name="addOneToDate">
                  <xsl:with-param name="date" select="$start_datetime"/>
               </xsl:call-template>
            </xsl:with-param>
         </xsl:call-template>
      </xsl:if>
   </xsl:template>

   <xsl:template name="addOneToDate">
      <xsl:param name="date"/>
      <xsl:variable name="year" select="number(substring($date, 1, 4))"/>
      <xsl:variable name="month" select="number(substring($date, 6, 2))"/>
      <xsl:variable name="day" select="number(substring($date, 9, 2))"/>
      <xsl:variable name="daysInMonth">
         <xsl:choose>
            <xsl:when test="$month = 2">
               <xsl:choose>
                  <xsl:when test="($year div 4 = 0 and $year div 100 != 0) or ($year div 400 = 0)">29</xsl:when>
                  <xsl:otherwise>28</xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:when test="$month = 4 or $month = 6 or $month = 9 or $month = 11">30</xsl:when>
            <xsl:otherwise>31</xsl:otherwise>
         </xsl:choose>
      </xsl:variable>
      <xsl:choose>
         <xsl:when test="$day != $daysInMonth">
            <xsl:value-of select="concat($year, '-', format-number($month, '00'), '-', format-number($day + 1, '00'), ' 00:00:00')"/>
         </xsl:when>
         <xsl:when test="$month = 12">
            <xsl:value-of select="concat($year + 1, '-01-01 00:00:00')"/>
         </xsl:when>
         <xsl:otherwise>
            <xsl:value-of select="concat($year, '-', format-number($month + 1, '00'), '-01 00:00:00')"/>
         </xsl:otherwise>
      </xsl:choose>
   </xsl:template>
</xsl:stylesheet> 
```

应用于您的示例 XML 时，将输出以下内容

```
<events>
   <event>
      <!-- various elements -->
      <start_datetime>2012-02-09 10:00:00</start_datetime>
      <end_datetime>2012-02-09 11:00:00</end_datetime>
      <!-- various elements -->
   </event>
   <event>
      <!-- various elements -->
      <start_datetime>2012-02-09 10:00:00</start_datetime>
      <end_datetime>2012-02-09 23:59:59</end_datetime>
      <!-- various elements -->
   </event>
   <event>
      <!-- various elements -->
      <start_datetime>2012-02-10 00:00:00</start_datetime>
      <end_datetime>2012-02-10 15:00:00</end_datetime>
      <!-- various elements -->
   </event>
   <!-- other events -->
</events> 
```

我相信你会同意使用 EXSLT 会更简单......

# c# - DateTime EditorFor Template - 设置 id 和 name 属性？

> ID：10689104
> 
> 赞同：0
> 
> 时间：2012-05-21T16:38:42.873
> 
> 标签：c#, asp.net-mvc-3, editorfor

我正在尝试制作一个表单，让用户选择一个日期范围来查看一些统计数据。除非我使用“我尝试过的备用日期时间编辑器模板”，否则我无法将日期时间显示为文本框中的日期，但是我没有将它连接到表单，因为它没有id 或名称属性。

我究竟做错了什么？

## 日期时间编辑器模板

```
@inherits System.Web.Mvc.WebViewPage<DateTime>
@Html.TextBoxFor(p => p, new { @class = "datepicker span2" }) 
```

## 我试过的备用日期时间编辑器模板

```
@inherits System.Web.Mvc.WebViewPage<DateTime>
<input class="datepicker span2" type="text" value="@Model.ToShortDateString()" /> 
```

## 我的模特

```
public class ManageStatsModel
{
    [DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = "{0:MM/dd/yyyy}")]
    public DateTime MinDate { get; set; }

    [DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = "{0:MM/dd/yyyy}")]
    public DateTime MaxDate { get; set; }
} 
```

## 表格上的标记

```
@using (Html.BeginForm("Stats", "Manage", FormMethod.Post, new { @class = "form-inline" }))
{
    @Html.EditorFor(p => p.MinDate)
    <span> - </span>
    @Html.EditorFor(p => p.MaxDate)
    <button type="submit">Go</button>
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:48:27.570

尝试：

```
@inherits System.Web.Mvc.WebViewPage<DateTime>
@Html.TextBox("", ViewData.TemplateInfo.FormattedModelValue, new { @class = "datepicker span2" }) 
```

`TextBox`助手将从模型/模板层次结构中构建适当的名称。

# html - 这个目录是什么意思

> ID：10689105
> 
> 赞同：-1
> 
> 时间：2012-05-21T16:38:45.053
> 
> 标签：html

当我去上面的目录时，

../

当我进入时

/

但是我也看到这个是什么意思？

./

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T16:39:38.587

`./`表示“当前目录”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T16:46:39.427

您正在谈论的三个目录名称是 unix 样式的目录。

“./”是“当前目录”，也简称为“.”。

“../”是“父目录”（当前目录之前的目录），也简称为“..”

# c# - 如何确保在递归调用期间不更改参数？

> ID：10689107
> 
> 赞同：2
> 
> 时间：2012-05-21T16:39:03.110
> 
> 标签：c#, recursion, parameters

我有一些数据需要传递给递归函数。我想确保它不会在该函数中更改。我怎样才能做到这一点？

考虑：

```
 static List<Person> GetPeopleWithSameNameAncestors(List<Person> people)
    {
        return people.Where(person => HasAncestorWithName(person.Parents, person.Name)).ToList();
    }

    //Here, nameToLookFor is always the same for every outside call to this function
    static bool HasAncestorWithName(List<Person> lookIn, String nameToLookFor)
    {
        return lookIn.Any(p => p.Name == nameToLookFor || (p.Parents != null && HasAncestorWithName(p.Parents, nameToLookFor)));
    } 
```

实际情况更复杂，这就是为什么确保 nameToLookFor 不被更改很重要，因为有人可以很容易地做到这一点。哦，我不能碰“Person”类。

如果这不能直接实现，有没有人知道可以安全解决这个问题的模式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:53:58.660

如果您真的对此感到担心，请考虑使用[装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)来包装您的 Person 对象 - 但要包装它，以使其不可变。

```
public class PersonWrapper()
{
    Person p;

    public PersonWrapper(Person person)
    {
        prop = person;
    }

    Public string Name
    {
        get { return p.Name; }
    }
} 
```

在您的代码中传递此对象 - 您可以轻松地将列表转换为：

```
var immutablePersonList = personList.Select(p => new PersonWrapper(p)); 
```

此外，使用不可变集合类型，如 IEnumerable，而不是可变 ICollection 实现。

# asp.net - 在asp.net webforms中创建独立于源代码的网站模板

> ID：10689118
> 
> 赞同：6
> 
> 时间：2012-05-21T16:39:23.333
> 
> 标签：asp.net, templates, user-controls

我正在开发一个支持不同域上的多个商店的电子商务平台。后端已经完成（目前），我现在开始前端部分。由于该平台支持多个商店，因此我需要某种模板系统，但我还没有完全弄清楚什么是最好的方法。

这是我的要求：

*   我不想重建我的解决方案来添加新模板
*   模板存储在 /Templates/TemplateDirectoryName
*   我希望能够在模板中使用（预定义的）用户控件。
*   我使用 URL 路由，并且只有 1 个 Default.aspx 页面来控制需要加载哪些页面模板和附加代码。

到目前为止，这是我想出的：

*   在我的模板目录中，我有使用母版页创建的模板（主页主文件、默认主文件和引用默认主文件的子主文件...用于产品详细信息、浏览、搜索等）
*   我的 Default.aspx 页面根据路由值选择正确的模板

虽然这种方式可行，但我认为它不是很实用，但我越想越得出结论，没有太多其他选择可以解决这个问题。我想这就是我想问的：有没有办法在模板中使用用户控件并将模板与应用程序完全分开，这样用户就可以创建模板而不必担心站点的命名空间和结构？

亲切的问候，马克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T10:04:28.590

由于您正在引用模板的文件夹，是否可以仅更改文件夹中的 .aspx 文件，asp.net 将根据您提到的 url 路径选择模板？我认为这在 asp.net 中是可能的。
此外，DotNetNuke、Sharepoint、Joomla 等框架也有类似的概念。您可以利用它们的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:17:48.747

我提出的解决方案如下。它有一些限制，例如所有母版页都需要实现相同的占位符控件集（不足为奇）。看看，让我知道你的想法。

我像这样设置我的文件夹结构：

网站 -> 模板 -> 模板文件夹（与模板命名相同）
网站 -> 模板 -> 用户控件（用户控件存储在非模板特定文件夹中）

我定义了一个简单的模板配置类，我们可以存储/保存/加载基本模板定义：

```
public class Template
{
    public string TemplateName { get; set; }
    public string UserControlName { get; set; }
    public string MasterPageName { get; set; }

    public string TemplateFolder
    {
        get
        {
            return GetTemplateFolder(TemplateName);
        }
    }

    public string TemplateConfigFile { get { return GetTemplateConfigFile(TemplateName); } }

    private static string GetTemplateFolder(string name)
    {
        return HttpContext.Current.Server.MapPath("~/Templates/" + name + "/");
    }

    private static string GetTemplateConfigFile(string name)
    {
        return GetTemplateFolder(name) + "/" + name + ".config";
    }

    public Template()
    {

    }

    public void Save()
    {
        XmlSerializer xs = new XmlSerializer(typeof(Template));

        if (!Directory.Exists(TemplateFolder)) Directory.CreateDirectory(TemplateFolder);

        using (FileStream fs = File.OpenWrite(TemplateConfigFile))
        {
            xs.Serialize(fs, this);
        }
    }

    public static Template Load(string name)
    {
        if(!File.Exists(GetTemplateConfigFile(name))) return null;

        XmlSerializer xs = new XmlSerializer(typeof(Template));

        using (FileStream fs = File.OpenRead(GetTemplateConfigFile(name)))
        {
            Template t = (Template)xs.Deserialize(fs);

            return t;
        }
    }
} 
```

您可以通过运行以下代码来构建一些裸 xml 代码以开始使用：

```
 Template t1 = new Template() { TemplateName = "Template1", MasterPageName = "Child1.master", UserControlName = "uc1.ascx" };
    Template t2 = new Template() { TemplateName = "Template2", MasterPageName = "Child2.master", UserControlName = "uc2.ascx" };

    t1.Save();
    t2.Save(); 
```

我创建了一个基本的母版页。除了为您的默认页面提供基本占位符外，此页面可能永远不会被使用。您的所有母版页都应具有与基本页相同的占位符集，以便您的页面可以互换使用它们。请注意，我为我们的用户控件留了一个占位符。

```
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="BaseMaster.master.cs" Inherits="Templates_Masters_BaseMaster" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <asp:ContentPlaceHolder id="head" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:ContentPlaceHolder id="cphHeader" runat="server">

        </asp:ContentPlaceHolder>
        <asp:ContentPlaceHolder id="cpUserControl" runat="server">

        </asp:ContentPlaceHolder>
        <asp:ContentPlaceHolder id="cphFooter" runat="server">

        </asp:ContentPlaceHolder>
    </div>
    </form>
</body>
</html> 
```

现在，我创建了一个使用上述母版页的基本 aspx 网页。

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Templates/Masters/BaseMaster.master" AutoEventWireup="true" CodeFile="DefaultTemplated.aspx.cs" Inherits="DefaultTemplated" %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="cphHeader" Runat="Server">
</asp:Content>
<asp:Content ID="Content3" ContentPlaceHolderID="cpUserControl" Runat="Server">
</asp:Content>
<asp:Content ID="Content4" ContentPlaceHolderID="cphFooter" Runat="Server">
</asp:Content> 
```

在代码隐藏中，我们将设置基本模板。这将设置母版页并将预定义的用户控件添加到用户控件的内容占位符。如果您愿意，您可以制作一个面板或其他东西并将其添加到该固定控件中，但我认为您可能会喜欢看到如何使其与母版页一起使用。

```
public partial class DefaultTemplated : System.Web.UI.Page
{
    private Template PageTemplate
    {
        get
        {
            if (_tLoaded == null)
            {
                string template = Request.QueryString["template"];
                if (string.IsNullOrEmpty(template)) return null;

                Template t = Template.Load(template);
                _tLoaded = t;
            }

            return _tLoaded;
        }
    }

    private Template _tLoaded = null;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (PageTemplate != null)
        {
            //cpUserControl is the name of my usercontrol placeholder
            ((ContentPlaceHolder)Page.Form.FindControl("cpUserControl")).Controls.Add(
                    Page.LoadControl("~/Templates/UserControls/" + PageTemplate.UserControlName));
        }
    }

    protected void Page_PreInit(object sender, EventArgs e)
    {
        if (PageTemplate == null) return;

        this.MasterPageFile = "~/Templates/" + PageTemplate.TemplateName + "/" + PageTemplate.MasterPageName;
    }
} 
```

如果您有一个名为“Template1”的模板，您可以通过调用“Default.aspx?template=Template1”来使用它。由于您使用的是 URL 重写，因此您将使用重写将模板名称作为参数传递给页面。

可以与上述组合的另一个选项是使用 Page.ParseControl。使用它，您可以将原始 asp.net 设计器代码（仅限设计器）存储在数据库或原始文本文件中。然后你可以像这样实例化它加载它：

```
//where pnl1 is a Panel on the page.  Page.ParseControl just returns a control object, so use it anywhere.
pnl1.Controls.Add(Page.ParseControl("raw asp.net designer code here.")); 
```

一件很棒的事情是嵌套控件也很好用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T09:57:03.243

我不知道我是否理解正确：

如果您不想重建，那么我可以说 CMS 概念最适合您。

*   您可以将模板作为 HTML 存储在数据库中，然后从 DB 中取回，
*   您可以使用编辑器提供管理员功能，也可以在线编辑您的模板。

# ruby-on-rails - 如何在 Ruby on Rails 中验证 TinyMCE 长度？

> ID：10689120
> 
> 赞同：1
> 
> 时间：2012-05-21T16:39:28.247
> 
> 标签：ruby-on-rails, validation

我需要验证使用 TinyMCE 填写的 short_description 字段的长度。问题是，我必须先去除 HTML 标签字符串。尝试了几个没有运气的解决方案。希望有人能帮助我。

这是我到目前为止所得到的：

```
validates_length_of :description_short, :maximum => 300, :tokenizer => lambda { |string| strip_tags(string).split(//) }, :message => 'too long' 
```

它引发错误未定义的方法“strip_tags”#

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T09:21:23.913

要在模型中使用 strip_tags，您需要在调用它时指定它的位置：

```
ActionController::Base.helpers.strip_tags() 
```

产生给定的代码：

```
validates_length_of :description_short, :maximum => 300, 
    :tokenizer => lambda { |string| ActionController::Base.helpers.strip_tags(string).split(//) }, 
    :message => 'too long' 
```

有些人建议在模型的顶部包含*ActionController*，但这不是最佳实践，因为将所有 Helpers 加载到 de 模型中，会减慢它的速度。

# iphone - performSegueWithIdentifier if 语句不起作用

> ID：10689122
> 
> 赞同：0
> 
> 时间：2012-05-21T16:39:30.903
> 
> 标签：iphone, objective-c, ios, uitableview

我有 6 个不同的表，当其中一个表中的行被选中时（在 regionFirstTable 中重要的是哪个表），我希望它们执行一个 segue。regionFirstTable 的代码工作正常，但至于另一部分它没有 - segues 只是不工作。我知道这太混乱了，但答案应该是表面上的。

```
- (void)tableView:(UITableView *)tableView 
didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

if (tableView == self.regionsFirstTable) {
    {     if (indexPath.row==0)
        if (indexPath.section==1) {
            [self performSegueWithIdentifier:@"toAfricanFS" sender:indexPath];
        } else {
            [self performSegueWithIdentifier:@"toAfricanFS" sender:indexPath];
        }
        if (indexPath.row==1)
            if (indexPath.section==1) {
                [self performSegueWithIdentifier:@"toAsiaFS" sender:indexPath];

            } else {
                [self performSegueWithIdentifier:@"toAsiaFS" sender:indexPath];
            }
        if (indexPath.row==2)
            if (indexPath.section==1) {
                [self performSegueWithIdentifier:@"toEuropeFS" sender:indexPath];

            } else {
                [self performSegueWithIdentifier:@"toEuropeFS" sender:indexPath];
            }
        if (indexPath.row==3)
            if (indexPath.section==1) {
                [self performSegueWithIdentifier:@"toLatinFS" sender:indexPath];
            } else {
                [self performSegueWithIdentifier:@"toLatinFS" sender:indexPath];
            }
        if (indexPath.row==4)
            if (indexPath.section==1) {
                [self performSegueWithIdentifier:@"toNorthAmericaFS" sender:indexPath];
            } else {
                [self performSegueWithIdentifier:@"toNorthAmericaFS" sender:indexPath];
            }
    } //Dealing with the first UITableView, it works

    if (tableView == self.africaFirstTable) {
        [self performSegueWithIdentifier:@"fromAfricatoDone" sender:indexPath];
    } 
    if (tableView == self.asiaFirstTable) {
        [self performSegueWithIdentifier:@"fromAsiatoDone" sender:indexPath];
    } 
    if (tableView == self.europeFirstTable) {
        [self performSegueWithIdentifier:@"fromEuropetoDone" sender:indexPath];
    }
    if (tableView == self.latinAmericaFirstTable) {
        [self performSegueWithIdentifier:@"fromLatintoDone" sender:indexPath];
    } 
    if (tableView == self.northAmericaFirstTable) {
        [self performSegueWithIdentifier:@"fromNorthAmericatoDone" sender:indexPath];
    } //This whole thing is not working as it should be
}
} 
```

提前致谢！

PS我所有的表只有一个 indexPath.section

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:55:45.680

看起来你在 first 之后有太多`{`s `if`，所以你的所有检查`if ( tableView == self.northAmericaFirstTable)`都没有命中，因为它都嵌套在`if (tableView == self.regionsFirstTable)`块中

编辑：

这是固定的代码，理论上

```
- (void)tableView:(UITableView *)tableView 
didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

if (tableView == self.regionsFirstTable) {
     if (indexPath.row==0)
        if (indexPath.section==1) {
            [self performSegueWithIdentifier:@"toAfricanFS" sender:indexPath];
        } else {
            [self performSegueWithIdentifier:@"toAfricanFS" sender:indexPath];
        }
        if (indexPath.row==1)
            if (indexPath.section==1) {
                [self performSegueWithIdentifier:@"toAsiaFS" sender:indexPath];

            } else {
                [self performSegueWithIdentifier:@"toAsiaFS" sender:indexPath];
            }
        if (indexPath.row==2)
            if (indexPath.section==1) {
                [self performSegueWithIdentifier:@"toEuropeFS" sender:indexPath];

            } else {
                [self performSegueWithIdentifier:@"toEuropeFS" sender:indexPath];
            }
        if (indexPath.row==3)
            if (indexPath.section==1) {
                [self performSegueWithIdentifier:@"toLatinFS" sender:indexPath];
            } else {
                [self performSegueWithIdentifier:@"toLatinFS" sender:indexPath];
            }
        if (indexPath.row==4)
            if (indexPath.section==1) {
                [self performSegueWithIdentifier:@"toNorthAmericaFS" sender:indexPath];
            } else {
                [self performSegueWithIdentifier:@"toNorthAmericaFS" sender:indexPath];
            }
    } //Dealing with the first UITableView, it works

    if (tableView == self.africaFirstTable) {
        [self performSegueWithIdentifier:@"fromAfricatoDone" sender:indexPath];
    } 
    if (tableView == self.asiaFirstTable) {
        [self performSegueWithIdentifier:@"fromAsiatoDone" sender:indexPath];
    } 
    if (tableView == self.europeFirstTable) {
        [self performSegueWithIdentifier:@"fromEuropetoDone" sender:indexPath];
    }
    if (tableView == self.latinAmericaFirstTable) {
        [self performSegueWithIdentifier:@"fromLatintoDone" sender:indexPath];
    } 
    if (tableView == self.northAmericaFirstTable) {
        [self performSegueWithIdentifier:@"fromNorthAmericatoDone" sender:indexPath];
    } //This whole thing is not working as it should be
} 
```

# c# - SQL 作业无法运行 C#.net 控制台应用程序

> ID：10689135
> 
> 赞同：1
> 
> 时间：2012-05-21T16:40:05.053
> 
> 标签：c#, sql-server, sql-server-2008, excel, vba

我有一个简单的 excel 文件，其中包含以下代码：

```
Private Sub Workbook_Open()
   MsgBox "Hello World!"
End Sub 
```

我试图运行一个 sql 作业来打开这个 excel 文件，但它失败了，变得没有响应。在谷歌搜索中，我发现“为什么”SQL 作业无法打开 Excel 文件的原因 [Sql Server 代理上的作业未完成，但在 BIDS 中可以完成？](https://stackoverflow.com/questions/8745626/job-on-sql-server-agent-does-not-complete-but-it-does-in-bids)

所以我想用 C# 创建一个简单的控制台应用程序，它可以简单地打开 excel 文件并运行我的宏。这是我的代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Excel = Microsoft.Office.Interop.Excel;
using System.Threading;

namespace T_OpenExcel
{
class Program
{
    static void Main(string[] args)
    {

        Excel.Application xlApp;
        Excel.Workbook xlWorkBook;
        //Excel.Worksheet xlWorkSheet;

        object misValue = System.Reflection.Missing.Value;

        xlApp = new Excel.Application();
        xlWorkBook = xlApp.Workbooks.Open(@"E:\data_extracts\TestHelloWorld.xlsm", 0, true, 5, "", "", true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, "\t", false, false, 0, true, 1, 0);
        RunMacro(xlWorkBook, new Object[] { "TestHello" });

        Thread.Sleep(5000);

        xlWorkBook.Close(true, misValue, misValue);
        xlApp.Quit();
    }

    private static void RunMacro(Excel.Workbook xlWorkBook, object[] p)
    {
        //throw new NotImplementedException();
    }
}
} 
```

我可以在 IDE 中成功运行此代码。现在我想从 SSMS 中的 SQL 作业运行它，sql server 2008。

我从我的 C# 项目中获取了 T_OpenExcel.exe 文件（T_OpenExcel-->bin-->Debug-->T_OpenExcel.exe）。我创建了一个 SQL 作业。以下是我的一些详细信息：

步骤名称：OpenHelloWorldExcel 类型：操作系统（CmdExec） 运行方式：SQL Server 代理服务帐户命令：C:\Users\shress2\Documents\visual studio 2010\projects\T_OpenExcel\T_OpenExcel\bin\Debug\T_OpenExcel.exe

在运行此作业时，我得到以下状态 Start Job 'TestHelloWorld' Status Success Execute job 'TestHelloWorld' Status Error

在查看历史记录中，它显示：消息以用户身份执行：GSOPS4\SYSTEM。未处理的异常：System.Runtime.InteropServices.COMException：Microsoft Excel 无法访问文件“E:\data_extracts\TestHelloWorld.xlsm”。有几个可能的原因：
文件名或路径不存在。该文件正被另一个程序使用。您尝试保存的工作簿与当前打开的工作簿同名。在 Microsoft.Office.Interop.Excel.Workbooks.Open（字符串文件名、对象 UpdateLinks、对象只读、对象格式、对象密码、对象 WriteResPassword、对象 IgnoreReadOnlyRecommended、对象来源、对象分隔符、对象可编辑、对象通知、对象转换器、对象AddToMru, Object Local, Object CorruptLoad) at T_OpenExcel.Program.Main(String[] args) in C:\Users\shress2\documents\visual studio 2010\projects\T_OpenExcel\T_OpenExcel\Program.cs:line 23\. 进程退出代码-532462766。步骤失败。

我检查了 E:\data_extracts\TestHelloWorld.xlsm 目录，发现它工作正常。我确保我的 xlsm 文件没有被任何人使用。我无法弄清楚为什么它无法运行它。任何帮助是极大的赞赏。谢谢你的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:43:55.853

问题似乎是您试图在打开 Excel 文件时显示一个消息框，但您正在自动化它，因此没有人可以单击消息框上的按钮。其余代码无法执行，因为文件正坐在那里等待有人单击按钮。

在随后的运行中，服务器无法访问它，因为它仍然坐在那里，对普通用户不可见，等待单击按钮。因此错误。

简短版本：不要在无人看管的应用程序上提示用户输入。

# windows - 创建超出文件路径限制的文件

> ID：10689136
> 
> 赞同：1
> 
> 时间：2012-05-21T16:40:05.567
> 
> 标签：windows, file, winapi

我有一个测试，它在循环中创建一系列文件夹，直到它超过 MAX_PATH (260)。这将返回 ERROR_PATH_NOT_FOUND(0x3)。我们有一台运行此测试的构建机器，但在构建机器上它返回 ERROR_FILENAME_EXCED_RANGE (0xce)。

我的机器是 Windows 7，但构建机器是 Vista。这可能是他们返回不同值的原因吗？如果没有，有谁知道为什么会发生这种情况？

编辑：我期待得到一个错误，我正在测试一个文件系统驱动程序。我只是不明白为什么我从不同机器上的同一个测试中得到两个不同的错误代码。这是代码

homeDir << "C:\Users\me\TestFolder";

```
string childDir = "\\LongChildDirectoryName";
string dir = homeDir.str();
DWORD lastErr = ERROR_SUCCESS;
while(lastErr == ERROR_SUCCESS) 
{
    int len = dir.size();
    if(len > (MAX_PATH - 12))
    {
        CuFail(tc, "Filepath greater than max allowed should be");
    }

    dir += childDir;

    if(!CreateDirectory(dir.c_str(), NULL))
    {
        lastErr = GetLastError();
        if (lastErr == ERROR_ALREADY_EXISTS)
            lastErr = ERROR_SUCCESS;
    }
}
CuAssert(tc, "Check error is ERROR_PATH_NOT_FOUND", lastErr == ERROR_PATH_NOT_FOUND); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:04:14.080

逻辑有缺陷。如果 homeDir.str() 返回一个不存在的名称，则 CreateDirectory 的返回值将是 ERROR_PATH_NOT_FOUND。您可以通过简单地执行以下操作来演示问题：

```
string childDir("\\LongChildDirectoryName");
string dir("foo"); 
```

CreateDirectory 调用将获得路径 foo\LongChildDirectoryName，如果 foo 不存在，您将获得 ERROR_PATH_NOT_FOUND。修复只是在while循环之前添加这个：

```
CreateDirectory(dir.c_str(), NULL); 
```

您还需要在连接字符串之后而不是之前移动长度检查。使用 Alex 建议的 "\\?\" 语法也是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T02:22:55.583

要使用更长的路径，您需要使用 , 的“宽”`CreateFile()`版本`CreateFileW()`。

请参阅有关该主题的[MSDN 文章](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)：

```
HANDLE WINAPI CreateFile(
  __in      LPCTSTR lpFileName,
  __in      DWORD dwDesiredAccess,
  __in      DWORD dwShareMode,
  __in_opt  LPSECURITY_ATTRIBUTES lpSecurityAttributes,
  __in      DWORD dwCreationDisposition,
  __in      DWORD dwFlagsAndAttributes,
  __in_opt  HANDLE hTemplateFile
);

lpFileName [in]

    The name of the file or device to be created or opened.

    In the ANSI version of this function, the name is limited to MAX_PATH characters.
To extend this limit to 32,767 wide characters, call the Unicode version of the
function and prepend "\\?\" to the path. For more information, see Naming Files,
Paths, and Namespaces. 
```

# solr - SOLR 刻面比手动计数慢？

> ID：10689137
> 
> 赞同：0
> 
> 时间：2012-05-21T16:40:09.033
> 
> 标签：solr

我正在尝试使 SOLR 范围查询正常工作。我有一个包含超过 1200 万个文档的数据库，并且我通过几个参数进行过滤，例如：

```
product_category:"category1" AND product_group:"group1" AND product_manu:"manufacturer1" 
```

查询本身返回大约 700 个文档，平均在两到三秒内执行。

但是，当我想向该查询添加日期范围方面（我想查看过去 x 年内每天添加了多少产品）时，它会在 50 秒或更长时间内执行。因此，似乎只检索所有匹配的文档并在 java 中执行手动计数会更快。所以我想我一定是在刻面方面做错了什么？

这是一个多面查询示例：

```
start=0&rows=0&facet.query=productDate%3A[0999-12-26T23%3A36%3A00.000Z+TO+2012-05-22T15%3A58%3A05.232Z]&q=source%3A%22source1%22+AND+productCategory%3A%22category1%22+AND+type%3A%22type1%22&facet=true&facet.limit=-1&facet.sort=count&facet.range=productDate&facet.range.start=NOW%2FDAY-5000DAYS&facet.range.end=NOW%2FDAY%2B1DAY&facet.range.gap=%2B1DAY 
```

我唯一的解释是 SOLR 正在计算一些比我的 700 个文档更大的文档池中的字段，这些文档是由“q=”参数产生的。或者也许我应该以另一种方式过滤文档？

我已经尝试更改 filterCache 大小并且它可以工作，但是对于这样的查询来说，这似乎是一种内存浪费。毕竟聚合超过 700 个文档应该非常快，不是吗？

# wordpress - WordPress插件开发理念？这可能吗？我在正确的轨道上吗？

> ID：10689139
> 
> 赞同：-1
> 
> 时间：2012-05-21T16:40:19.317
> 
> 标签：wordpress, plugins

我对 WP 开发非常陌生。我托管了一个需要路线列表（远足、骑自行车等）的网站，我想编写一个 WordPress 插件来完成它。

有人可以告诉我我是否采取了正确的方法，以及我所提议的是否可行。

我希望该网站最终在 http://example.com/trail-guide 有一个自动生成和过滤的索引，在[http://example.com/trail-guide/trailname](http://example.com/trail-guide/trailname)[有](http://example.com/trail-guide)离散的线索信息页面. 这些数据将全部存储在单个数据库表中，其中包含每个跟踪的信息，并带有一个用于从此处添加、编辑和删除条目的管理页面。

一个 WP 插件是做这件事的最好方法，还是我应该看看别的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:36:35.197

从您描述的方式来看，您最好的选择是[注册自定义帖子类型](http://codex.wordpress.org/Function_Reference/register_post_type)。这可以通过添加到现有主题的 Functions.php 文件或创建插件来完成。

如果您不打算更改主题，我的建议是将所有内容硬编码到您的 functions.php 文件中。否则，为这个特定的工作创建一个插件将是最安全的选择。

将此功能与[自定义元框](http://codex.wordpress.org/Function_Reference/add_meta_box)和[自定义分类法](http://codex.wordpress.org/Function_Reference/register_taxonomy)结合使用，您可以使用自己的特殊数据在 Wordpress 框架内保持一切井井有条。

这意味着这些新帖子也可以随时通过标准的 Wordpress 循环或搜索框进行查询。

如果您不喜欢编写自己的函数来扩展现有框架，您可能需要查看一些插件，例如[GD Custom Posts And Taxonomies Tools](http://wordpress.org/extend/plugins/gd-taxonomies-tools/)来管理您自己的。

希望这可以帮助。

# c# - foreach 和集合的使用速度慢吗？

> ID：10689140
> 
> 赞同：4
> 
> 时间：2012-05-21T16:40:19.550
> 
> 标签：c#, winforms, performance, collections, foreach

我正在重构我的应用程序以使其更快。我正在寻找这样做的提示，并找到了以下声明：

*“ForEach 可以简化 For 循环中的代码，但它是一个沉重的对象，并且比使用 For 编写的循环慢。”*

真的吗？如果它在写的时候是真的，那么今天仍然是真的，还是 foreach 本身已经被重构以提高性能？

我对来自同一来源的这个提示有同样的问题：

*“在可能的情况下使用数组而不是集合。数组通常更有效，尤其是对于值类型。此外，尽可能将集合初始化为所需的大小。”*

## 更新

我正在寻找性能提示，因为我有一个数据库操作需要几秒钟。

我发现“使用”语句很耗时。

我通过反转 for 循环和“使用”完全解决了我的性能问题（当然，重构是必要的）。

比糖蜜慢的代码是：

```
for (int i = 1; i <= googlePlex; i++) {
    . . .
    using (OracleCommand ocmd = new OracleCommand(insert, oc)) {
    . . .
    InsertRecord();
    . . . 
```

比超速子弹还快的代码是：

```
using (OracleCommand ocmd = new OracleCommand(insert, oc)) {
    for (int i = 1; i <= googlePlex; i++) {
        . . .
        InsertRecord();
        . . . 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T16:47:40.753

简短的回答：

**难以阅读的代码最终会导致软件的行为和性能不佳。**

长答案：

在早期的 .NET 中有一种微优化建议的文化。部分原因是微软的一些内部工具（如 FxCop）在公众中广受欢迎。部分原因是 C# 已经并且渴望成为汇编、C 和 C++ 的继任者，因为它可以在性能关键应用程序的少数最热门代码路径中不受阻碍地访问原始硬件性能。当然，这确实需要比典型应用程序更多的知识和纪律。框架代码和应用程​​序代码中与性能相关的决策的后果也大不相同。

当然，这对 C# 编码文化的净影响是积极的；但是停止使用`foreach`or`is`或`""`仅仅为了保存一些 CIL 指令是荒谬的，如果你愿意的话，你最近的抖动可能会完全优化掉。

您的应用程序中可能有很多循环，并且可能**最多其中一个**可能是当前的性能瓶颈。以牺牲可读性为代价“优化”非瓶颈性能是一件非常糟糕的事情。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-21T16:42:45.557

在许多情况下确实`foreach`比等效的`for`. 这也是真的

```
for (int i = 0; i < myCollection.Length; i++) // Compiler must re-evaluate getter because value may have changed 
```

比

```
int max = myCollection.Length;
for (int i = 0; i < max; i++) 
```

但这可能根本不重要。有关非常详细的讨论，请参阅[C# 中控制结构“for”和“foreach”的性能差异](https://stackoverflow.com/questions/1124753/for-vs-foreach-loop-in-c-sharp)

您是否进行了任何分析以确定应用程序的热点？如果循环管理开销是您应该关注的地方，我会感到惊讶。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-21T16:46:53.293

您应该尝试使用 Red Gate ANTS 或类似的东西来分析您的代码 - 您会感到惊讶。

我发现在我正在编写的应用程序中，SQL 中的参数嗅探占用了 25% 的处理时间。在编写了一个在应用程序启动时嗅探参数的命令缓存之后，速度有了很大的提升。

除非您正在执行大量嵌套的 for 循环，否则我认为您不会从更改循环中看到很多性能优势。我无法想象，除了实时应用程序（例如游戏或大量运算或科学应用程序）需要这种优化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-21T16:44:33.337

是的。经典`for`比 a 快一点，`foreach`因为迭代是基于索引的，而不是像枚举器那样访问集合的元素

```
 static void Main()
    {
        const int m = 100000000;
        //just to create an array
        int[] array = new int[100000000];
        for (int x = 0; x < array.Length; x++) {
            array[x] = x;
        }

        var s1 = Stopwatch.StartNew();           
        var upperBound = array.Length;
        for (int i = 0; i < upperBound; i++)
        {

        }
        s1.Stop();
        GC.Collect();
        var s2 = Stopwatch.StartNew();
        foreach (var item in array) { 

        }
        s2.Stop();
        Console.WriteLine(((double)(s1.Elapsed.TotalMilliseconds *
            1000000) / m).ToString("0.00 ns"));
        Console.WriteLine(((double)(s2.Elapsed.TotalMilliseconds *
            1000000) / m).ToString("0.00 ns"));
        Console.Read();

        //2.49 ns
        //4.68 ns

        // In Release Mode

        //0.39 ns
        //1.05 ns

} 
```

# c - 带有微控制器的C：结构的起始地址是特定地址？

> ID：10689142
> 
> 赞同：3
> 
> 时间：2012-05-21T16:40:29.893
> 
> 标签：c, pointers, struct, c-preprocessor

我正在阅读一些关于指针和结构的东西，但我就是不明白：微控制器的头文件中有这个内容：

```
#define NVIC_BASE (SCS_BASE + 0x0100) /*< NVIC Base Address */ (1)
#define NVIC ((NVIC_Type *) NVIC_BASE) /*< NVIC configuration struct */ (2) 
```

在后面的代码中，可能会有类似的内容：

```
NVIC->ICER[0] = (1<<4); 
```

这（因为定义）是否对应于：

```
(NVIC_Type *) NVIC_BASE).ICER[0] = (1<<4); 
```

NVIC_Type 只是一个类型定义的结构，带有一些用于设置和清除中断的寄存器。很明显，（2）以某种方式管理结构起始地址是 NVIC_BASE 地址。但是怎么做？

括号（NVIC_Type *）中这个结构之后的指针（*）是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T16:46:14.487

`NVIC_BASE`是地址。这`(NVIC_Type *)`是一个强制转换，这意味着当您引用`NVIC`引用时，它将被解释为指向`NVIC_Type`结构的指针。

因此，当您编写 时`NVIC->ICER[0]`，就好像 NVIC 是一个已声明的结构，但具有一个常量地址。这样，结构的布局与外设内存映射相匹配，并且使用给定的基地址，寄存器排成一行，让您可以操作您的硬件。

此外，yes`NVIC->ICER[0] = (1<<4);`与`(*(NVIC_Type *) NVIC_BASE).ICER[0] = (1<<4);`

# java - 神秘的 Java 运行时错误

> ID：10689143
> 
> 赞同：0
> 
> 时间：2012-05-21T16:40:31.110
> 
> 标签：java, runtime-error

我写了一个很短的程序来解决一个在线评委的简单编程竞赛问题（http://acm.sgu.ru/problem.php?contest=0&problem=184），但由于某种原因，我在 21 日遇到了运行时错误测试（它没有具体说明运行时错误是什么）。所以我重写了代码，它现在没有给出运行时错误，但我不明白为什么这段代码应该工作而原来的代码没有。这是工作代码：

```
Scanner scan = new Scanner(System.in);
int[] arr1 = new int[3];
int[] arr2 = new int[3];
for (int i = 0; i <= 2; i++) arr1[i] = scan.nextInt();
for (int i = 0; i <= 2; i++) arr2[i] = scan.nextInt();
System.out.println(Math.min(arr1[0]/arr2[0], Math.min(arr1[1]/arr2[1], arr1[2]/arr2[2]))); 
```

这是非工作代码：

```
BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
String[] arr1 = in.readLine().split(" ");
String[] arr2 = in.readLine().split(" ");
int flour = Integer.parseInt(arr1[0])/Integer.parseInt(arr2[0]);
int milk = Integer.parseInt(arr1[1])/Integer.parseInt(arr2[1]);
int cabbage = Integer.parseInt(arr1[2])/Integer.parseInt(arr2[2]);
System.out.println(Math.min(cabbage, Math.min(flour, milk))); 
```

我起初尝试在非工作代码中将 BufferedReader 更改为 Scanner 并使用 in.nextLine() 但这不起作用。然后我想也许有一个被零除的情况，但问题条件排除了它，这应该仍然是工作代码中的一个问题，所以我不知道为什么第一个有效而第二个无效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:50:00.040

当输入仅由空格分隔而没有任何换行符时，它会失败。您在非工作代码中获得 NPE，或者在等待输入时，由于您的程序阻塞，您超过了此测试的 0.5 秒时间限制。

# c - 如何使用通配符搜索目录中的文件

> ID：10689149
> 
> 赞同：0
> 
> 时间：2012-05-21T16:41:03.797
> 
> 标签：c, file-io

我目前正在尝试找到一种方法来搜索特定目录中的文件（在这种情况下是 /dev/shm，这部分不需要通配符）适合包含通配符的模式，例如我有一个有的目录

```
stack_review.txt stack_overflow.txt stack_servers.txt 
```

在其中，我想返回所有符合模式 stack_*.txt 的结果，我该怎么做呢？我已经尝试了一些使用 readdir 的示例，但不幸的是还没有找到任何适用于此实现的方法，所以我非常感谢我能在这个问题上获得的任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T18:09:54.890

你正在寻找`glob()`. 来自[http://linux.die.net/man/3/glob](http://linux.die.net/man/3/glob)：

一个使用示例是以下代码，它模拟`ls -l *.c ../*.c` 在 shell 中键入：

```
glob_t globbuf;

globbuf.gl_offs = 2;
glob("*.c", GLOB_DOOFFS, NULL, &globbuf);
glob("../*.c", GLOB_DOOFFS | GLOB_APPEND, NULL, &globbuf);
globbuf.gl_pathv[0] = "ls";
globbuf.gl_pathv[1] = "-l";
execvp("ls", &globbuf.gl_pathv[0]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:44:50.183

元素可以嵌套在文件夹中吗？如果是这样，您的方法必须是递归的。

# less - 如何在less中将属性名称作为参数传递给mixin

> ID：10689152
> 
> 赞同：4
> 
> 时间：2012-05-21T16:41:22.117
> 
> 标签：less, less-mixins

我想制作一个函数/mixin，如果它已经很暗，它会使颜色变暗，但当它变亮时会变亮（标准化/极端化？）

是否可以通过传递属性名称（颜色、背景颜色、边框颜色等）来做到这一点？

```
.normalize(@color, @amount, @prop: "color") when (lightness(@color) >= 50%)
{
    @prop:lighten(@color, @amount);
}
.normalize(@color, @amount, @prop: "color") when (lightness(@color) < 50%)
{
    @prop:darken(@color, @amount);
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-22T04:08:03.397

这是目前在 less.js github 上的一个功能请求。所以在less.js 1.4中注意它..直到那时你可以像这样破解它......

```
.mixin(@prop, @value) {
    Ignore: ~"a;@{prop}:@{value}";
} 
```

不是很好，你会得到一个额外的财产，但这是目前唯一的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T17:59:49.510

受保护的 Mixins 应该是您正在寻找的，但是您不能使用变量来定义属性，只能使用它们的值。所以你可以这样做：

```
.normalize(@color, @amount) when (lightness(@color) >= 50%)
{
    color:lighten(@color, @amount);
}

.normalize(@color, @amount) when (lightness(@color) < 50%)
{
   color:darken(@color, @amount);
} 
```

所以这：

```
.class1 {
    .normalize(#ddd, 10%);
} 
```

会输出这个：

```
.class1 {
  color: #f7f7f7;
} 
```

但是您实际上不能将属性名称作为变量传递。不幸的是，这是 LESS 的一个限制，虽然我已经看到了诸如边距方向之类的解决方法，但没有办法只使用变量传递任何 ol' 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-07T08:06:58.627

在 Less 的 GitHub 上的相应[问题](https://github.com/less/less.js/issues/36)中，cloudhaed 提出了一种解决方法：

```
.blah ()      { color: black }                 // All blahs
.blah(right)  { padding-right: 20px }          // Right blahs
.blah(left)   { padding-left: 20px }           // Left blahs

@side: left;
.class { .blah(@side) } 
```

输出

```
.class { color: black; padding-left: 20px;} 
```

也许这会做？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-08T21:12:37.583

此功能自 v1.6.0 起添加：

```
@property: color;

.widget {
  @{property}: #0ee;
  background-@{property}: #999;
} 
```

编译为：

```
.widget {
  color: #0ee;
  background-color: #999;
} 
```

请参阅[http://lesscss.org/features/#variables-feature-properties](http://lesscss.org/features/#variables-feature-properties)

# multithreading - 在非 VCL 应用程序中使用同步是否危险？

> ID：10689159
> 
> 赞同：13
> 
> 时间：2012-05-21T16:42:07.197
> 
> 标签：multithreading, delphi

如果 Delphi 代码是用 synchronize 编写的，以序列化对 VCL 主线程的访问，但是这段代码在非 VCL 应用程序中使用，它会与应用程序的主线程同步还是完全没有效果？

* * *

例子：

```
procedure TMyThread.Execute;
begin

  // ... other code

  Synchronize(SomeMethod);

  // ...

end; 
```

让我们假设

*   它是一个非 VCL 应用程序，它有一个在无限循环中执行的主线程（或直到终止）
*   主线程不[`CheckSynchronize`](http://docwiki.embarcadero.com/Libraries/en/System.Classes.CheckSynchronize)直接调用或在 WakeMainThread 处理程序中调用
*   辅助线程运行并执行 Synchronize(SomeMethod) 就像上面的示例一样

线程会挂在 Synchronize(SomeMethod) 行上吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T16:48:01.307

`TThread`为非 VCL 程序提供检查同步队列的工具，因此它们可以继续使用期望同步其方法的多线程库。这[在`CheckSynchronize`](http://docwiki.embarcadero.com/Libraries/en/System.Classes.CheckSynchronize). 请记住，检查队列是应用程序的工作，而不是您的库的工作。

只要应用程序履行合同的一部分，您的使用`Synchronize`应该没问题。但是，如果没有，那么您的程序将无法正常工作，但我不知道会出现什么确切症状。悬挂当然听起来很合理。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-21T17:51:41.157

> 在非 VCL 应用程序中使用同步是否危险？

是的，这很危险。如果您的主线程没有调用`CheckSynchronize`，那么`Synchronize`将导致死锁。

> 让我们假设
> 
> *   它是一个非 VCL 应用程序，它有一个在无限循环中执行的主线程（或直到终止）
> *   主线程不`CheckSynchronize`直接调用或在`WakeMainThread`处理程序中调用
> *   辅助线程`Synchronize(SomeMethod)`像上面的示例一样运行和执行
> 
> 线会不会挂`Synchronize(SomeMethod)`在线上？

调用`Synchronize`将阻塞后台线程，直到主线程调用`CheckSynchronize`. 因此，如果主线程从不调用`CheckSynchronize`，后台线程将无限期阻塞。

以下程序说明了这一点：

```
program TheBigSleep;

{$APPTYPE CONSOLE}

uses
  SysUtils, Classes, Windows;

type
  TMyThread = class(TThread)
  protected
    procedure Execute; override;
  end;

procedure TMyThread.Execute;
begin
  Synchronize(SysUtils.Beep);
end;

begin
  with TMyThread.Create do
    WaitForSingleObject(Handle, INFINITE);
    //don't call WaitFor since that, in turn, calls CheckSynchronize
end. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T17:39:02.743

Since you are putting the Delphi code in a library for other apps to use, I would not advise using `Synchronize()` at all, since you thread has no concept of what is going on outside of itself. A better choice is to have the thread expose a callback event that the thread can call in its own context when needed, and then let the app provide a callback function handler that decides the best way to synchronize with the app's main thread as needed.

# scala - 采用 Seq[T] 返回 String 而不是 Seq[Char] 的方法

> ID：10689161
> 
> 赞同：12
> 
> 时间：2012-05-21T16:42:22.447
> 
> 标签：scala, scala-collections

我想实现可以任意`Seq[T]`返回`Seq[T]`的方法。但是当`String`提供时它也应该返回`String`。

由于从to的一些隐式转换而传递`String`作品，但我得到了回报。有可能回来吗？`String``WrappedString extends IndexedSeq[Char]``Seq[Char]``String`

```
val sx: Seq[Int] = firstAndLast(List(1, 2, 3, 4))
val s1: Seq[Char] = firstAndLast("Foo Bar")
val s2: String = firstAndLast("Foo Bar")  //incompatible types error

def firstAndLast[T](seq: Seq[T]) = Seq(seq.head, seq.last) 
```

`firstAndLast()`实现无关紧要，这只是一个例子。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-21T16:59:13.920

对的，这是可能的。您必须要求其中一个花哨`CanBuildFrom`的 s：

```
import scala.collection.generic.CanBuildFrom

def firstAndLast[CC, A, That](seq: CC)(implicit asSeq: CC => Seq[A], cbf: CanBuildFrom[CC, A, That]): That = {
  val b = cbf(seq)
  b.sizeHint(2)
  b += seq.head
  b += seq.last
  b.result
} 
```

这也适用于数组。奖励：示例中的所有行都将按预期编译和工作。

# python - 将所有变量输出到 Mako 模板

> ID：10689162
> 
> 赞同：4
> 
> 时间：2012-05-21T16:42:24.207
> 
> 标签：python, templates, mako

我无法轻松访问代码，我只使用 Mako 模板，我想知道模板可用的所有值，我可以使用它们。

有没有办法在模板中添加一些东西，以便输出结果包含所有变量（递归）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-17T13:58:42.057

您正在寻找[上下文对象](http://docs.makotemplates.org/en/latest/runtime.html#mako.runtime.Context)。玩了一两分钟后：

```
${context.keys()}    # list of direct variable names
${context.__dict__}  # probably more along what you're looking for. 
```

[关于Mako 运行时环境](http://docs.makotemplates.org/en/latest/runtime.html)的整个部分可能值得一读，尤其是“[所有内置名称](http://docs.makotemplates.org/en/latest/runtime.html#all-the-built-in-names)”部分。您可能会发现我刚刚发布的另一篇相关文章：

[Mako 如何检查变量是否存在。](https://stackoverflow.com/questions/12006720/pylons-mako-how-to-check-if-variable-exist-or-not/12006824#12006824)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:11:12.307

让我们试试这个我认为这一定有帮助：

```
${globals()} 
```

# php - 从操作表单调用 PHP 函数

> ID：10689164
> 
> 赞同：1
> 
> 时间：2012-05-21T16:42:40.797
> 
> 标签：php, forms, function

我想将我的 PHP 文件合并到一个通用类文件中，但我不确定如何调用该函数而不是 .php 页面。如何在 HTML 页面的表单部分调用 sendEmail()？

* * *

```
HMTL
<form action="form_class.php" id="frmAirport" method="post">
Full Name: <span style="white-space: pre;"> 
</span><input name="name" type="text" /><br /><br />
Email Address: <input name="email" type="text" /><br /><br />
Subject: <span style="white-space: pre;">       
</span><input name="subject" type="text" /><br /><br />
<textarea id="txtComments" cols="30" rows="10">Comments</textarea><br />
<input type="submit" value="Send" />
</form> 
```

* * *

```
<?php
function addPerson() {
//do stuff here 
}

function sendEmail() {
//do some stuff here 

}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:48:45.097

您不能直接调用 PHP 函数。但是，如果 php 文件的格式设置为您在此处仅使用两个函数显示的方式，则您可以将标志作为 POST 字段传入，并让逻辑块根据该标志确定哪个函数调用。这并不理想，但可以满足您的目的。但是，这将强制页面刷新，并且您可能必须在函数返回后加载不同的页面，因此您可能希望简单地将其实现为 ajax 调用以避免页面刷新。

根据您的评论进行编辑（使用 jQuery Ajax）：

> 我正在使用 .ajax() jQuery 函数。我的意图是创建一个 php 文件，其中包含用于不同 html 表单的多个函数。– 汤森森

那么在这种情况下，您可以让您的文件包含逻辑块，以将请求“路由”到正确的函数并最终返​​回结果。

我将尝试基于一些简单的 jQuery 为您想要做的事情提供一个选项。假设你有这样的事情：

Java 脚本：

```
$("#button1").click(function(e){ 
    e.preventDefault(); // prevents submit event if button is a submit
    ajax_route('ap'); 
}); 
$("#button2").click(function(e){ 
    e.preventDefault(); // prevents submit event if button is a submit
    ajax_route('se'); 
});

function ajax_route(action_requested){ 
    $.post("ajax_handler.php", {action : action_requested}, function(data){
        if (data.length>0){ 
            alert("Hoorah! Completed the action requested: "+action_requested); 
        } 
    })
} 
```

PHP（在 ajax_handler.php 内）

```
<?php
// make sure u have an action to take
if(isset($_POST['action']) 
    switch($_POST['action']){
        case 'ap': addPerson(); break;
        case 'se': sendEmail(); break;
        default: break;
    }
}

function addPerson() {
    //do stuff here 
}

function sendEmail() {
    //do some stuff here 
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:44:57.580

你不能。PHP 仅在服务器上运行。您可以使用 javascript AJAX 调用在服务器上调用 php 脚本，或者使用常规表单提交，但直接从客户端 html 调用特定的 PHP 函数？不可能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:56:01.363

我不确定我是否理解正确，但要调用函数/方法，您可以使用隐藏输入：

```
<!-- form -->
<input type="hidden" name="action" value="sendEmail" />

// handle file
<?php
$actionObject = new Actions();
if (method_exists($actionObject, $_POST['action'])) {
    $actionObject->{$_POST['action']};
}
?> 
```

AddPerson 和 sendEmail 听起来它们不应该是一类的方法。尝试仅使用与方法女巫相关的类。要调用方法，您可以将其定义为静态，或者您必须创建类的实例，然后调用方法。

# jquery - 重用 jQuery UI 对话框会清除其所有字段

> ID：10689169
> 
> 赞同：0
> 
> 时间：2012-05-21T16:43:02.243
> 
> 标签：jquery, jquery-ui, jquery-ui-dialog

使用 jQuery-UI 对话框从用户那里获取一些输入。
按下该`Esc`键时，对话框关闭而不清除其字段。单击`Save`或`Cancel`清除字段时。
这很好，除了我对某些字段使用水印文本框并且我不希望它们像其他字段一样被清除。

我是否应该更改清除字段的代码（我似乎找不到它......）？
我应该在每次打开对话框之前初始化水印文本框吗？

对话框 javacript：

```
$(function () {
    $("#GetSomeData").dialog({
    autoOpen: false,
    modal: true,
    resizable: false,
    width: "550px",
    buttons: {
        "Save": function () {
            // saving data to DB
            $(this).dialog("close");
        },
        "Cancel": function () {
            $(this).dialog("close");
        }
    }
}); 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:47:38.037

初始化一次水印，每次打开都克隆对话内容。

```
$(function () {
    // init watermark for #GetSomeData here

    var dialog = $("#GetSomeData").clone().appendTo('body').dialog({
        autoOpen: false,
        modal: true,
        resizable: false,
        width: "550px",
        buttons: {
            "Save": function () {
                // saving data to DB
                dialog.dialog("destroy").remove();
            },
            "Cancel": function () {
                dialog.dialog("destroy").remove();
            }
        }
    });
}); 
```

# android - 如何在设备启动时启动服务？

> ID：10689170
> 
> 赞同：0
> 
> 时间：2012-05-21T16:43:03.397
> 
> 标签：android, service, broadcastreceiver

> **可能重复：**
> [尝试在 Android 上启动服务](https://stackoverflow.com/questions/2784441/trying-to-start-a-service-on-boot-on-android)

广播接收器

```
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

public class StartActivityAtBoot extends BroadcastReceiver{

    @Override
    public void onReceive(Context context, Intent intent) {
        if ("android.intent.action.BOOT_COMPLETED".equals(intent.getAction())) {
            Intent i = new Intent(context, CompareIMSI.class);
            context.startService(i);
        }
    }
} 
```

比较SIM.java

```
import android.app.Service;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.IBinder;
import android.telephony.TelephonyManager;
import android.widget.Toast;

public class CompareIMSI extends Service{

    Context context;
    TelephonyManager operator;

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public void onCreate() {
        super.onCreate();
        Toast.makeText(this, "Service Created", Toast.LENGTH_LONG).show();
        //compareSIM();
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        Toast.makeText(this, "Service Destroyed", Toast.LENGTH_LONG).show();
    }

    @Override
    public void onStart(Intent intent, int startId) {
        super.onStart(intent, startId);
        Toast.makeText(this, "Service Started", Toast.LENGTH_LONG).show();
        compareSIM();
    }

    public void compareSIM(){

        final String STORAGE = "Storage";
        SharedPreferences unique = getSharedPreferences(STORAGE, 0);
        final String storedIMSI = unique.getString("simIMSI", "");
        final String currentIMSI = getSubscriberId().toString();

        if (!storedIMSI.equals(currentIMSI)){
            Intent i = new Intent(CompareIMSI.this, ScreenLockActivity.class);
            startActivity(i);
        }
    }

    public String getSubscriberId(){

        String IMSI = null;
        String serviceName = Context.TELEPHONY_SERVICE;
        TelephonyManager m_telephonyManager = (TelephonyManager) getSystemService(serviceName);
        IMSI = m_telephonyManager.getSubscriberId();
        return IMSI;
    }
} 
```

我希望应用程序在启动时启动 compareSIM 服务，在启动过程中，此服务将运行，因为当前连接的 SIM 卡 IMSI 将被检索并与已保存的 IMSI 匹配，一旦它们不同，用户将被带到登录布局。我想在启动过程中执行此操作，但未能执行...请在编码方面给我建议，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:58:51.630

按照以下步骤在 BOOT 上说明您的服务：

**第 1 步：**在 AndroidManifest.xml 中添加 BOOT_COMPLETED 权限：

```
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"></uses-permission> 
```

**第 2 步：**在 AndroidManifest.xml 中将您的 Reciver 注册为：

```
<receiver android:name=".StartActivityAtBoot" android:label="@string/app_name"> 
    <intent-filter> 
       <action android:name="android.intent.action.BOOT_COMPLETED" /> 
       <category android:name="android.intent.category.LAUNCHER" /> 
    </intent-filter> 
</receiver> 
```

**第 3 步：**在 AndroidManifest.xml 中将您的服务注册为：

```
<service android:name=".CompareIMSI"> </service> 
```

**第 3 步：**在 StartActivityAtBoot 中启动您的服务：

```
 public class StartActivityAtBoot extends BroadcastReceiver
{
    static final String ACTION = "android.intent.action.BOOT_COMPLETED";
    public void onReceive(Context context, Intent intent) 
    {
        if (intent.getAction().equals(ACTION)) 
        {
                  context.startService(new Intent(context, 
                  CompareIMSI.class), null);
             Toast.makeText(context, "CompareIMSI service has started!", Toast.LENGTH_LONG).show();
        }
    }
} 
```

这都是关于在启动时启动服务。谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:50:13.360

您需要在 Android 清单中注册 BroadcastReceiver，如下所示：

```
<receiver android:name=".StartActivityAtBoot">
    <intent-filter>
        <action android:name="android.intent.action.BOOT_COMPLETED" />
    </intent-filter>
</receiver> 
```

还要确保您在清单中具有此权限：

```
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:53:45.313

检查您的 androidManifest 文件。您需要在 androidManifest 文件中添加接收器。

```
 <receiver android:name=".......StartActivityAtBoot" >
        <intent-filter>
            <action android:name="android.intent.action.BOOT_COMPLETED" />
            <category android:name="android.intent.category.HOME" />
        </intent-filter>
    </receiver> 
```

# mysql - Rails 3 - MySQL 客户端库版本不正确！为错误的客户端库版本编译的 Gem

> ID：10689177
> 
> 赞同：14
> 
> 时间：2012-05-21T16:43:37.997
> 
> 标签：mysql, ruby-on-rails, ruby, gem, mysql2

我克隆了 github repo [https://github.com/8bitpal/hackful](https://github.com/8bitpal/hackful)，运行“bundle install”，现在运行“rake db:create”。但我收到一条错误消息：

```
Incorrect MySQL client library version! This gem was compiled for 5.0.45 but the client library is 5.5.15. 
```

试图找出有关我的 mysql 设置的更多信息：

```
$ mysql_config --version
$ 5.0.45

$ mysql
$ mysql> SELECT version();
+-----------+
| version() |
+-----------+
| 5.1.57    | 
+-----------+ 
```

由于我很少做 sysadmin 的工作，我对如何解释这些信息感到有点迷茫，即为什么提到“客户端库 5.5.15”，使用 mysql2 gem 时那种最低版本的 mysql 版本？

无论如何，我对 SO 做了更多的研究，发现这个线程 [Ruby mysql2 gemcompiled for wrong mysql client library version](https://stackoverflow.com/questions/8141985/ruby-mysql2-gem-compiled-for-wrong-mysql-client-library-version)。这个问题和我的类似：

> 使用 apt-get 将 MySQL 更新到 5.5 后，mysql2 gem 停止工作。
> 
> 这是错误：
> 
> MySQL 客户端库版本不正确！此 gem 是为 5.5.17 编译的，但客户端库是 5.1.58。（运行时错误）

该线程中的答案：

> 我在使用 Ubuntu Server 11.04 和 Percona Server 时遇到了同样的错误，我所做的是：
> 
> 将 /usr/lib/libmysqlclient.so.16.0.0 替换为 /usr/lib/libmysqlclient.so.18.0.0

我的问题是我没有这样的文件：

```
ls /usr/lib/mysql
libdbug.a       libmyisam.a     libmysqlclient.a    libmysqlclient_r.a  libmystrings.a      libvio.a
libheap.a       libmyisammrg.a      libmysqlclient.la   libmysqlclient_r.la libmysys.a 
```

大多数其他具有类似主题的主题都是关于 Windows 的，但我在 OS X 上。有什么想法可以尝试下一步吗？有关我的设置的更多信息：OS X Lion、rvm、Rails 3.1.3、ruby 1.9.2p290。宝石清单：

```
*** LOCAL GEMS ***

actionmailer (3.1.3)
actionpack (3.1.3)
activemodel (3.1.3)
activerecord (3.1.3)
activeresource (3.1.3)
activesupport (3.1.3)
addressable (2.2.7)
arel (2.2.1)
bcrypt-ruby (3.0.1)
builder (3.0.0)
bundler (1.0.21)
cancan (1.6.5)
capybara (1.1.2)
capybara-webkit (0.10.1)
childprocess (0.3.0)
coderay (1.0.5)
coffee-rails (3.1.1)
coffee-script (2.2.0)
coffee-script-source (1.2.0)
cucumber (1.1.4)
cucumber-rails (1.2.1)
database_cleaner (0.7.1)
delayed_job (3.0.0)
delayed_job_active_record (0.3.1)
devise (2.0.0)
diff-lcs (1.1.3)
erubis (2.7.0)
execjs (1.3.0)
factory_girl (2.6.3)
factory_girl_rails (1.7.0)
faker (1.0.1)
fakeweb (1.3.0)
ffi (1.0.11)
fileutils (0.7)
gherkin (2.7.6)
growl (1.0.3)
guard (1.0.3)
guard-bundler (0.1.3)
guard-cucumber (0.7.5)
guard-rspec (0.7.2)
guard-spork (0.8.0)
hike (1.2.1)
i18n (0.6.0)
jquery-rails (1.0.19)
json (1.6.5)
launchy (2.0.5)
libv8 (3.3.10.4 x86_64-darwin-11)
mail (2.3.0)
make_voteable (0.1.1)
method_source (0.7.1)
mime-types (1.17.2)
multi_json (1.0.4)
mysql (2.8.1)
mysql2 (0.3.11)
nokogiri (1.5.0)
orm_adapter (0.0.6)
polyglot (0.3.3)
pry (0.9.8.4)
rack (1.3.6)
rack-cache (1.1)
rack-mount (0.8.3)
rack-ssl (1.3.2)
rack-test (0.6.1)
rails (3.1.3)
rails_autolink (1.0.5)
railties (3.1.3)
rake (0.9.2.2)
rb-fsevent (0.9.1)
rdiscount (1.6.8)
rdoc (3.12)
rest-client (1.6.7)
rmagick (2.13.1)
rspec (2.8.0)
rspec-core (2.8.0)
rspec-expectations (2.8.0)
rspec-mocks (2.8.0)
rspec-rails (2.8.1)
rubyzip (0.9.5)
sass (3.1.12)
sass-rails (3.1.5)
selenium-webdriver (2.18.0)
slop (2.4.4)
spork (0.9.2)
sprockets (2.0.3)
sqlite3 (1.3.5)
term-ansicolor (1.0.7)
therubyracer (0.9.9)
thor (0.14.6)
tilt (1.3.3)
treetop (1.4.10)
tzinfo (0.3.31)
uglifier (1.2.2)
warden (1.1.0)
xpath (0.1.4) 
```

**更新** 我检查了为 mysql 安装的自制软件。当我理解正确时，这应该是mysql客户端库版本：

```
$ ls /usr/local/Cellar/mysql
$ 5.5.15 
```

现在我需要将 mysql_config 更新到 5.5.15？

**更新 2** 已解决。这个成功了：

```
gem install mysql2 -- --with-mysql-config=/usr/local/Cellar/mysql/5.5.15/bin/mysql_config 
```

来源：[为特定的 mysql 客户端版本安装 mysql2 gem？](https://stackoverflow.com/questions/7139210/install-the-mysql2-gem-for-a-specific-mysql-client-version)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-09-05T08:25:32.810

升级自制软件包后出现此问题。只需要告诉 mysql2 gem 重新编译它的非 ruby​​ 组件。

假设 homebrew 设置正确，以下应该可以解决问题：

```
gem uninstall mysql2
gem install mysql2 # or bundle install 
```

（取决于您的捆绑器配置，您可能需要做一些更复杂的事情，但这对我来说已经足够了）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T22:58:03.290

我已经根据本教程解决了这个问题，它帮助我安装了正确版本的 mysql for rails [http://blog.mmediasys.com/2011/07/07/installing-mysql-on-windows-7-x64-and -使用红宝石与它/](http://blog.mmediasys.com/2011/07/07/installing-mysql-on-windows-7-x64-and-using-ruby-with-it/)

# android-layout - 重叠的 HTML 内容在 WebView 中，使用时： webview.getSettings().setLayoutAlgorithm(LayoutAlgorithm.SINGLE_COLUMN);

> ID：10689180
> 
> 赞同：3
> 
> 时间：2012-05-21T16:43:44.757
> 
> 标签：android-layout, android-webview, html-encode

所以我将一些简单的 HTML 加载到 webview 中。html 格式为：（它是提取的 html，因此没有正文标记。

```
<p>..blah</p> 
<div style="text-align:center;">
<a href="http://services.runescape.com/m=rswikiimages/en/2012/5/combat1-18140712.jpg"    target="_blank">
<img src="http://services.runescape.com/m=rswikiimages/en/2012/5/combat1_thumb-18140804.jpg"></a></div>
<p>..blah</p> 
```

在 webview 活动类中，我添加：

```
webInfo = "<body style=\"color:white;font-size:15px\">" + webInfo + "</body>";
//for setting the size and color of the text 
```

我使用以下内容加载html：

```
webview.loadDataWithBaseURL(null,webInfo,"text/html","UTF-8",null);
// webInfo is an html string 
```

我执行以下操作，使其不会水平滚动，并且图像适合屏幕。

```
webview.getSettings().setLayoutAlgorithm(LayoutAlgorithm.SINGLE_COLUMN);| 
```

如果我不使用`SINGLE_COLUMN`，我总是水平滚动，即使文本很好地适合页面。我以为它终于解决了这个问题，但是当我加载它时，我得到了重叠的 html。如果我用手指稍微放大或缩小，这会自行修复。

这是正在发生的事情的图片：

![在此处输入图像描述](../Images/e209e3fd14094fbeacd844e5698fcad4.png)

**问题 1：** 如何解决该问题并显示图像以使其适合屏幕并且不需要水平滚动？

**问题 2：** 我也一直难以摆脱奇怪的符号，我的 's 显示真的很奇怪。尝试使用几种不同的编码，如 UTF-8、US-ACSII 和许多 Windows 编码，但似乎没有一个努力摆脱符号。

我希望我已经很清楚了，感谢任何帮助，我一直在摆弄这个 O_O ...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-12-12T10:39:41.757

**添加 webview 设置：**

`webSettings.setLayoutAlgorithm(LayoutAlgorithm.TEXT_AUTOSIZING)`//处理字体重叠。

# node.js - 构建工具：具有多个组件的 Coffeescript/Node 项目

> ID：10689182
> 
> 赞同：10
> 
> 时间：2012-05-21T16:43:44.867
> 
> 标签：node.js, mobile, build, coffeescript, angularjs

我正在工作中开始一个项目，并且想知道最好使用的构建工具是什么。

整个事情都是用 CoffeeScript 编写的，客户端使用 AngularJS，服务器使用 NodeJS。

该应用程序有几个组件：

*   iPad 应用程序
*   iPhone 应用程序（与 ipad 不同的功能）
*   应用程序的 CMS
*   一个 NodeJS 服务器

所有这些之间有大量的共享代码，同样都是用 CoffeeScript 编写的。

我想要一个构建工具，我可以在其中列出哪个应用程序使用了哪些代码（其中大部分是共享的），并且它将每个应用程序的 javascript 文件构建到一个单独的文件夹中。

例如，我会设置一个名为“/compiled/ipad/”的文件夹，其中包含 index.html，以及 js、css、img 等文件夹。我会列出我想要放入 /compiled/ipad/js 的已编译咖啡文件（其中一些来自 /src/shared/*.coffee，一些来自 /src/ipad/*.coffee 等）以及我想将哪些文件放入 /compiled/ipad/css。我也希望它能够轻松地连接我想要的文件。

它还会将我的测试从 /src/test/ipad 编译成 /compiled/test/ipad/*.js。

我所有的客户端单元测试都是使用[testacular](https://github.com/vojtajina/testacular)编写的，我还不确定我会用什么来编写服务器端单元测试。

什么构建工具/配置是这里最好的方法？生成文件？像咕噜一样的东西？老实说，我对整个构建场景都很陌生。

**编辑**：决定使用 Browserify。您可以在此处找到我的解决方案以使其与 Angular 一起使用：[https ://groups.google.com/forum/#!topic/angular/ytoVaikOcCs](https://groups.google.com/forum/#!topic/angular/ytoVaikOcCs)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T17:43:21.823

就我个人而言，我认为在 javascript 或 coffeescript 中编写服务器端代码的驱动力也延伸到了您的构建工具链：所以也坚持在那里使用 javascript/coffeescript。这将允许您从构建工具轻松地自动化您的服务器/客户端任务 - 我怀疑使用 make 之类的另一个工具是否有意义（您只是在 node.js 命令调用周围编写包装器）。建议，按结构化排序：

*   [node.js](http://blog.millermedeiros.com/node-js-as-a-build-script/)：只需在 javascript 中滚动构建脚本，然后使用 node.js 调用它们。我想类似于 shell 脚本。我不推荐这条路线。
*   [jake](http://howtonode.org/intro-to-jake) or [cake](http://coffeescript.org/documentation/docs/cake.html)：我来自 java 世界，所以这些让我想起蚂蚁也就不足为奇了。我更喜欢coffeescript，因此更喜欢蛋糕。
*   [grunt](http://net.tutsplus.com/tutorials/javascript-ajax/meeting-grunt-the-build-tool-for-javascript/)：我以前没有听说过这个，所以我不能给出太多建议。它让我想起了 maven，当然……我只能说……构建工具倾向于强制执行的结构越多，它的灵活性就越低。它是一种权衡。只要您以“构建工具”的方式进行操作，就可以节省大量时间。但是，如果您遇到特定于应用程序的问题，则要解决它可能是一件非常痛苦的事情。

当然，您可以使用其他一些您已经熟悉的其他语言的构建工具：rake、maven、ant、gradle 等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T18:27:25.327

我根据需要使用节点模块在 Cakefile 中完成了几乎所有完全相同的事情。

使用每个文件的路径设置一些作为数组的全局变量，将这些文件连接到您指定的编译目录中的一个文件中，然后将该文件编译为 js。

对于样式，显然与没有编译的连接相同。

```
fs = require 'fs'
path = require 'path'
{spawn, exec} = require 'child_process'
parser = require('uglify-js').parser
uglify = require('uglify-js').uglify
cleanCss = require 'clean-css'

coffees = 
 [
  "/src/shared/file1.coffee"
  "/src/shared/file2.coffee"
  "/src/ipad/file1.coffee"
 ]

tests = 
  [
   "/src/ipad/tests.coffee"
  ]

styles = 
 [
  "/src/ipad/styles1.css"
  "/src/shared/styles2.css"
 ]

concatenate = (destinationFile, files, type) ->
  newContents = new Array
  remaining = files.length
  for file, index in files then do (file, index) ->
      fs.readFile file, 'utf8', (err, fileContents) ->
          throw err if err
          newContents[index] = fileContents
          if --remaining is 0
              fs.writeFile destinationFile, newContents.join '\n\n', 'utf8', (err) ->
                throw err if err
              if type is 'styles'
                 minifyCss fileName
              else
                 compileCoffee fileName

 compileCoffee = (file) ->
    exec "coffee -c #{file}", (err) ->
       throw err if err
       # delete coffee file leaving only js
       fs.unlink 'path/specifying/compiled_coffee', (err) -> 
          throw err if err
          minifyJs file

 minifyJs = (file) ->
  fs.readFile f, 'utf8', (err, contents) ->
      ast = parser.parse contents
      ast = uglify.ast_mangle ast 
      ast = uglify.ast_squeeze ast
      minified = uglify.gen_code ast

      writeMinified file, minified

writeMinified = (file, contents) ->
   fs.writeFile file, contents, 'utf8', (err) -> throw err if err  

minifyCss = (file) ->
    fs.readFile file, 'utf8', (err, contents) ->
    throw err if err
    minimized = cleanCss.process contents
    clean = minimized.replace 'app/assets', ''

    fs.writeFile file, clean, 'utf8', (err) ->
        throw err if err

task 'compile_coffees', 'concat, compile, and minify coffees', ->
  concatenate '/compiled/ipad/code.coffee', coffees, 'coffee'

task 'concat_styles', 'concat and minify styles', ->
  concatenate '/compiled/ipad/css/styles.css', styles, 'styles'

task 'compile_tests', 'concat, compile, and minify test', ->
  concatenate '/compiled/ipad/tests.coffee', tests, 'tests' 
```

现在这大致是我认为你所要求的。

肯定会更漂亮，尤其是有一个单独的函数来编写缩小的内容，但它确实有效。

也不是完美的样式，因为我在使用 Sass 并且在它达到缩小功能之前还有其他功能，但我想你明白了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-21T17:58:48.293

我会将所有共享代码放入 Node.js 模块并创建一个类似于以下内容的项目：

```
Project
|~apps/
| |~cms/
| | `-app.js
| |~ipad/
| | `-app.js
| |~iphone/
| | `-app.js
| `~node/
|   `-app.js
|~libs/
| |-module.js
| `-module2.js
|~specs/
| |~cms/
| | `-app.js
| |~ipad/
| | `-app.js
| |~iphone/
| | `-app.js
| `~node/
|   `-app.js
| `~libs/
|   |-module.js
|   `-module2.js
`-Makefile 
```

然后我会使用 Browserify 之类的东西（还有其他的）在需要的地方制作客户端应用程序。这样，您实际上就拥有真正的应用程序导入模块，而不是在其中说出您需要什么的构建文件。

# http - netty 能否支持 http（tcp 短连接）和 Google protobuf

> ID：10689183
> 
> 赞同：0
> 
> 时间：2012-05-21T16:43:46.663
> 
> 标签：http, netty, protocol-buffers, google-ajax-libraries

这是我的工具，对吗？

```
public ChannelPipeline getPipeline() throws Exception 
{
    ChannelPipeline p = pipeline();
    pipeline.addLast("decoder", new HttpRequestDecoder());
    p.addLast("frameDecoder", new ProtobufVarint32FrameDecoder());
    p.addLast("protobufDecoder", new ProtobufDecoder(LocalTimeProtocol.Locations.getDefaultInstance()));
    pipeline.addLast("encoder", new HttpResponseEncoder());
    p.addLast("frameEncoder", new ProtobufVarint32LengthFieldPrepender());
    p.addLast("protobufEncoder", new ProtobufEncoder());
    p.addLast("handler", new LocalTimeServerHandler());
    return p;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T09:23:39.560

不起作用。您必须编写一个处理程序来获取 HTTP 请求的内容并将请求的内容 (ChannelBuffer) 转换为 protobuf 消息。下游也需要做类似的工作。

# jquery - 我可以传入“刚刚”作为 JQuery Timeago 的时间吗？

> ID：10689185
> 
> 赞同：0
> 
> 时间：2012-05-21T16:43:50.470
> 
> 标签：jquery, timezone, timeago

我正在使用 JQuery timeago 来使我的日期更漂亮（例如“1 天前”）。是否有“刚刚”的关键字，还是我必须将 javascript 计算的时间传递给 PHP？

```
 <abbr class='timeago' title='What do I put here?'>Just Now</abbr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:09:24.510

使用 jQuery 为您插入时间戳。

```
var justnow = ISODateString(new Date());
$('abbr[title="just now"]').each(function() {
    $(this).attr('title', justnow);
}); 
```

ISODateString 是：

```
function ISODateString(d) {
    function pad(n) {
        return n < 10 ? '0' + n : n
    }
    return d.getUTCFullYear() + '-' + pad(d.getUTCMonth() + 1) + '-' + pad(d.getUTCDate()) + 'T' + pad(d.getUTCHours()) + ':' + pad(d.getUTCMinutes()) + ':' + pad(d.getUTCSeconds()) + 'Z';
} 
```

示例：http: [//jsfiddle.net/jtbowden/RZXzL/](http://jsfiddle.net/jtbowden/RZXzL/)

# python-2.7 - 将数据返回到调用子流程的原始流程

> ID：10689186
> 
> 赞同：1
> 
> 时间：2012-05-21T16:43:53.150
> 
> 标签：python-2.7, wxpython, subprocess, python-multithreading

有人告诉我将此作为一个新问题发布。[这是从 spawn 线程实例化新的 WX Python GUI](https://stackoverflow.com/questions/10679134/instantiating-a-new-wx-python-gui-from-spawn-thread)的后续行动

我将以下代码实现到从衍生线程（Thread2）调用的脚本中

```
# Function that gets invoked by Thread #2
def scriptFunction():
  # Code to instantiate GUI2; GUI2 contains wx.TextCtrl fields and a 'Done' button
  p = subprocess.Popen("python secondGui.py", bufsize=2048, shell=True,stdin=subprocess.PIPE, stdout=subprocess.PIPE)

  # Wait for a response
  p.wait()

  # Read response
  response = p.stdout.read()

  # Process entered data
  processData() 
```

在运行 GUI2 的新进程上，我希望“完成”按钮事件处理程序将 4 个数据集返回给 Thread2，然后自行销毁（GUI2）

```
def onDone(self,event):
  # This is the part I need help with; Trying to return data back to main process that instantiated this GUI (GUI2)
  process = subprocess.Popen(['python', 'MainGui.py'], shell=False, stdout=subprocess.PIPE)
  print process.communicate('input1', 'input2', 'input3', 'input4')

  # kill GUI
  self.Close() 
```

目前，此实现在新进程中生成了另一个主 GUI。我想要做的是将数据返回到原始过程。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:26:23.177

这两个脚本必须分开吗？我的意思是，您可以在一个主循环上运行多个帧，并使用 pubsub 在两者之间传输信息：http: [//www.blog.pythonlibrary.org/2010/06/27/wxpython-and-pubsub-a-simple-教程/](http://www.blog.pythonlibrary.org/2010/06/27/wxpython-and-pubsub-a-simple-tutorial/)

从理论上讲，您正在做的事情也应该有效。我听说过的其他方法包括使用 Python 的套接字服务器库来创建一个非常简单的服务器，该服务器运行两个程序可以发布和读取数据。或数据库或监视目录以进行文件更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:54:33.780

线程#2调用的函数

```
def scriptFunction():
  # Code to instantiate GUI2; GUI2 contains wx.TextCtrl fields and a 'Done' button
  p = subprocess.Popen("python secondGui.py", bufsize=2048, shell=True,stdin=subprocess.PIPE, stdout=subprocess.PIPE)

  # Wait for a response
  p.wait()

  # Read response and split the return string that contains 4 word separated by a comma
  responseArray = string.split(p.stdout.read(), ",")

  # Process entered data
  processData(responseArray) 
```

在 GUI2 上单击“完成”按钮时调用的“完成”按钮事件处理程序

```
def onDone(self,event):
  # Package 4 word inputs into string to return back to main process (Thread2)
  sys.stdout.write("%s,%s,%s,%s" % (dataInput1, dataInput2, dataInput3, dataInput4))

  # kill GUI2
  self.Close() 
```

感谢您的帮助迈克！

# java - 使用 Runtime.getRuntime().exec 从定义的目录执行文件

> ID：10689193
> 
> 赞同：21
> 
> 时间：2012-05-21T16:44:03.950
> 
> 标签：java, shell, exec

我只想从特定文件夹执行我的文件。在我的情况下 /data/data/my-package/files/. 所以我尝试了：

```
 Process process2=Runtime.getRuntime().exec("cd /data/data/my-package/files/");
 process2.waitFor();
 process2=Runtime.getRuntime().exec("./myfile"); 
```

它不起作用。谁能告诉我正确的方法。谢谢

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-05-21T18:52:10.480

应该可以使用特定的工作目录调用可执行文件[`Runtime.exec(String command, String[] envp, File dir)`](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html#exec(java.lang.String,%20java.lang.String[],%20java.io.File))

如下：

```
Process process2=Runtime.getRuntime().exec("/data/data/my-package/files/myfile",
        null, new File("/data/data/my-package/files")); 
```

也许没有完整的路径`myfile`

```
Process process2=Runtime.getRuntime().exec("myfile",
        null, new File("/data/data/my-package/files")); 
```

`Context#getFilesDir()`而不是硬编码路径也应该工作，并且比自己指定路径更安全/更干净，因为不能保证`/data/data/..` 始终是所有设备的正确路径。

```
Process process2=Runtime.getRuntime().exec("myfile",
        null, getFilesDir())); 
```

问题`cd somewhere`在于目录已针对不同的进程进行了更改，因此`exec`在新进程中的第二次调用看不到更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-01-11T12:53:50.260

当我使用以下重载方法时，它对我有用：

> **公共进程执行（字符串命令，字符串 [] envp，文件目录）**

例如：

```
File dir = new File("C:/Users/username/Desktop/Sample");
String cmd = "java -jar BatchSample.jar";
Process process = Runtime.getRuntime().exec(cmd, null, dir); 
```

该命令仅存储您要在命令行中运行的命令。`dir`只存储要执行的 .jar 文件的路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-13T21:33:02.100

一个不同的解决方案是，

从 Java 代码执行 .bat 文件

并进行所有目录更改，以及 bat 文件中的内容

例如，我的 execute.bat 文件如下所示，

```
cd flutter_app
flutter build apk
cd .. 
```

Java代码看起来像这样，

```
Process process = Runtime.getRuntime().exec("execute.bat"); 
```

# c# - 将 CookieContainer 与 WebBrowser 控件一起使用？

> ID：10689195
> 
> 赞同：0
> 
> 时间：2012-05-21T16:44:17.163
> 
> 标签：c#, webbrowser-control, cookiecontainer

我已经创建了一个`CookieContainer`并存储了其中的 cookie `HttpWebRequest`。有没有办法可以在 WebBrowser 控件上使用这个 CookieContainer ？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:58:39.957

[您可以使用GetCookieHeader](http://msdn.microsoft.com/en-us/library/system.net.cookiecontainer.getcookieheader.aspx)方法从容器中获取 cookie 值。

# c# - Entity Framework：直接通过Context获取继承类型

> ID：10689201
> 
> 赞同：1
> 
> 时间：2012-05-21T16:44:45.950
> 
> 标签：c#, entity-framework, inheritance

我有一个 TPT 继承结构，它允许我在这样的上下文中查询继承的对象：

```
from test in Context.TestBase.OfType<DerivedType1>()
select test 
```

我是否可以将这些继承的类型添加到基本上下文中，以便我可以像这样查询：

```
from test in Context.DerivedType1
select test 
```

编辑：要清楚，这是一个数据库优先结构。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:50:53.930

和（EF 4.1+ 和 EF 5.0）是`DbContext`。`DbSet`有`ObjectContext`和`ObjectSet`没有，除非你将你的第一个查询包装到一个属性中，但它只允许查询，但不允许添加、附加或删除。`ObjectSet`只允许公开基本类型，但也`DbSet`允许直接公开派生类型。

# javascript - Javascript 使用 history.pushState 更新窗口位置

> ID：10689202
> 
> 赞同：1
> 
> 时间：2012-05-21T16:44:47.167
> 
> 标签：javascript, html, javascript-events

我已将 click 事件处理程序附加到一个锚标记`checkValid`，该标记验证元素并使用 setTimeout 为 0 调用实际处理程序 [允许浏览器继续执行它]。

```
//Code is just illustration
function checkValid() {
   if(valid) {
       setTimeout(reloadDiv, 0);
   }
}

function reloadDiv() {
  console.log(window.location.href);
} 
```

相同锚标记的默认处理程序使用 更改窗口位置`history.pushState`。

我预计，由于 setTimeout(reloadDiv, 0) 我将`window.location.href`事件安排到队列末尾时会变得正确。

但它没有发生。如果我将 setTimeout 时间设置为 500 毫秒，它可以正常工作，但这似乎在浏览器和网络速度之间并没有保持不变。当网站使用时，是否有更好的方法来获取正确的 href url `history.pushState`？

*注意：*我不拥有执行代码的域

# macos - 关闭 NSPredicateEditor 动画

> ID：10689204
> 
> 赞同：1
> 
> 时间：2012-05-21T16:44:49.537
> 
> 标签：macos, nspredicateeditor

默认情况下，从 NSPredicateEditor 添加和删除行是通过动画完成的。我想摆脱那个动画，或者至少将它的持续时间设置为零，但没有运气。任何想法，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-03T00:53:51.097

这绝对不是一个好方法，但它有效：

子类化`NSPredicateEditor`并添加：

```
- (BOOL)animationShouldStart:(NSAnimation *)animation {
    animation.duration = 0.0;
    return YES;
} 
```

此方法是`NSAnimationDelegate`协议的一部分，显然由`NSPredicateEditor`. 请记住，这可能随时中断。让我们希望 Apple 添加一种禁用动画的官方方法。

# iphone - rails：调用render时如何不对模型的属性进行编码：json => model

> ID：10689208
> 
> 赞同：1
> 
> 时间：2012-05-21T16:45:08.077
> 
> 标签：iphone, ruby-on-rails, json, unicode

我在 Rails 中的一个模型（UserMessage）中有一个名为 message 的列。现在消息可以包含我从 iphone 应用程序传入的表情符号值。

例如，笑脸图标具有 U+1F604 的 unicode 值，并且由于它以 json 格式传入，因此它在我的数据库 (postgres) 中序列化为“\u{1F604}”。

现在一切都很好，直到我调用`render :json => @user_message`我的控制器。Rails 获取序列化消息“\u{1F604}”并对其调用 ActiveSupport::JSON.encode 并因此再次对其进行编码。我尝试在 UserMessage 类中覆盖 to_json 无济于事。

有人可以指出我正确的方向吗？

# slickgrid - SlickGrid：取消选择所有行

> ID：10689215
> 
> 赞同：8
> 
> 时间：2012-05-21T16:45:33.760
> 
> 标签：slickgrid

如何取消选择 Slick Grid 中的所有行？

我正在使用 RowSelectionModel 并且找不到方法。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-09T01:50:12.577

老问题，但这对我有用：

```
grid.setSelectedRows([]); 
```

来自[官方 API](https://github.com/mleibman/SlickGrid/wiki/Slick.Grid#wiki-setSelectedRows)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T17:10:15.893

```
grid.getSelectionModel().setSelectedRanges([]); 
```

# ruby - 使用 Ruby 访问文件的“更多信息”

> ID：10689217
> 
> 赞同：1
> 
> 时间：2012-05-21T16:45:43.193
> 
> 标签：ruby, filesystems, mp3

在 Mac OS X 上，右键单击文件并选择“获取信息”会显示“更多信息”部分。

我专门处理 MP3 文件，我知道我可以使用 File 类访问创建和修改的元数据，但是有没有办法获取和设置任何“更多信息”属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:18:51.283

一般来说，答案是否定的：OS X 使用特定的库来访问基于类型的文件的元数据。这些不是以通用属性方式存储在文件系统中的，而是数据固有的。例如，PNG 和 JPG 文件以不同的方式记录它们的高度和宽度，并且可以存储关于图像的不同类型的元数据。操作系统正在读取这些文件并为更多信息部分提取此信息。

然而，具体来说，答案是肯定的：您需要一个用于 Ruby 的 ID3 库，例如[taglib-ruby](http://robinst.github.com/taglib-ruby/)或[ruby​​-taglib](http://www.hakubi.us/ruby-taglib/)。有关更多信息，请参阅问题*[Ruby mp3 Id3 parsing](https://stackoverflow.com/questions/972526/ruby-mp3-id3-parsing)*。

# linux - 十六进制到二进制转换器

> ID：10689221
> 
> 赞同：0
> 
> 时间：2012-05-21T16:46:05.423
> 
> 标签：linux, bash, binary, hex, converter

如何在 bash 中将十六进制字符串（例如“d43c23F1”）转换为二进制。

不使用实用程序 bc。

十六进制：二进制

d43c23F1:11010100001111000010001111110001

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T16:56:07.853

可以`dc`改用吗？然后你可以这样做：

```
$ echo 16 i 2 o D43C23F1 p | dc
11010100001111000010001111110001 
```

否则，您可以按照 Emil 的建议使用 bash“关联数组”。有一篇[Linux Journal 文章](http://www.linuxjournal.com/content/bash-associative-arrays)详细讨论了它们。创建一个字典，将十六进制数字映射到它们的二进制表示：

```
declare -A bits
bits[A]=1010 
```

将您的十六进制字符串拆分为数字，然后在数组中查找每个数字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T16:50:45.437

每个十六进制数字正好对应四个二进制数字。制作这些映射的字典并遍历每个十六进制字符，将四位数字附加到答案中。我没有发布代码，因为我没有那么多时间，但你应该可以从这里开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T17:20:15.847

无耻地，从[这里](http://www.bashguru.com/2010/12/decimal-to-binary-conversion-shell.html)偷来的，修改了十六进制。

```
#!/bin/bash
# SCRIPT:  hex2binary.sh
# USAGE:   hex2binary.sh Hex_Number(s)
# PURPOSE: Hex to Binary Conversion. Takes input as command line
#          arguments.
#                        \\\\ ////
#                       \\  - -  //
#                           @ @
#                   ---oOOo-( )-oOOo---
#
#####################################################################
#                      Script Starts Here                           #
#####################################################################

if [ $# -eq 0 ]
then
    echo "Argument(s) not supplied "
    echo "Usage: hex2binary.sh hex_number(s)"
else
echo -e "\033[1mHEX                 \t\t BINARY\033[0m"

    while [ $# -ne 0 ]
    do
         DecNum=`printf "%d" $1`
         Binary=
         Number=$DecNum

         while [ $DecNum -ne 0 ]
         do
              Bit=$(expr $DecNum % 2)
              Binary=$Bit$Binary
              DecNum=$(expr $DecNum / 2)
         done

         echo -e "$Number              \t\t $Binary"
         shift
# Shifts command line arguments one step.Now $1 holds second argument
        unset Binary
   done

fi 
```

您必须以您的十六进制数字开头`0x`才能使其正常工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-15T10:55:17.490

尝试这个：

```
$ echo "ibase=16; obase=2; D43C23F1" | bc 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T14:30:18.660

此代码假定您的十六进制是大写的（对于可能使用大写和小写的其他基础是必需的） - 只需将函数添加到您的 bashrc

```
toupper() { #change input $@ to upper case
uppers=ABCDEFGHIJKLMNOPQRSTUVWXYZ
lowers=abcdefghijklmnopqrstuvwxyz
i=0
while ([ $i -lt ${#1} ]) do
    CUR=${1:$i:1}
    case $lowers in
        *$CUR*)CUR=${lowers%$CUR*};OUTPUT="${OUTPUT}${uppers:${#CUR}:1}";;
        *)OUTPUT="${OUTPUT}$CUR";;
    esac
    i=$((i+1))
done
printf "${OUTPUT}"
}

baseN2dec(){ #usage: baseN2dec number <base> (default base is 16)
#note base32 and base64 should really have a different string pattern ... todo
#RFC 4648 Base32 alphabet ABCDEFGHIJKLMNOPQRSTUVWXYZ234567 we use base32hex
#Base 64 is ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
STRING=0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/
i=$((${#1}-1));DEC=0;POS=1;BASE=${2:-16}
while ([ $i -ge 0 ]) do
    VAL=${1:$i:1}
    VAL=${STRING%${VAL}*}
    VAL=${#VAL}
    DEC=$(($VAL*$POS+$DEC))
    POS=$(($BASE*$POS))
    i=$(($i-1))
done
echo $DEC
}

dec2baseN(){ #usage: dec2baseN number <base>
A=$(($1/$2))
STRING=0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/
[ $A -ge $2 ] && dec2baseN ${A} $2 || printf ${STRING:$A:1}
printf ${STRING:$(($1%$2)):1}
}

dec2bin(){
dec2baseN $1 2
}

dec2hex(){
dec2baseN $1 16
} 
```

# java - java中的内联初始化块

> ID：10689224
> 
> 赞同：4
> 
> 时间：2012-05-21T16:46:25.897
> 
> 标签：java, initialization

我有一堂课

```
public class MyMain{
    public static void main(String... arg){
            Temp t = new Temp(){
                {
                    System.out.println(" instance initialize");
                }
            };

        }
    }

class Temp{
    int i;

    {
        i=9;
        System.out.println("Static"+i);
    }
    Temp(){
        System.out.println("Temp const "+i);
    }
} 
```

当我执行 main 方法时，输出如下：

```
Static9
Temp const 9
instance initialize 
```

理想情况下，块在构造函数之前执行，但内联初始化块在构造函数之后调用。为什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-21T16:51:07.130

您*正在*创建. `Temp`对于每个类，任何实例初始化程序都在构造函数主体之前执行 - 但超类在子类初始化之前进行初始化。所以执行流程是：

*   初始化器在`Object`
*   构造函数体`Object`
*   初始化器在`Temp`
*   构造函数体`Temp`
*   匿名类中的初始化器
*   匿名类中的构造函数主体（无）

我强烈建议你重构任何看起来像这样的代码——目标是清晰而不是聪明。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-21T16:52:09.117

[JLS 12.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.5)阐明了施工过程中发生的事情的顺序（强调我的）：

> 就在作为结果返回对新创建对象的引用之前，使用以下过程处理指示的构造函数以初始化新对象：
> 
> (3) 此构造函数不是以显式构造函数调用同一类中的另一个构造函数开始（使用 this）。如果此构造函数用于 Object 以外的类，则此构造函数将以显式或隐式调用超类构造函数开始（使用 super）。**使用这五个相同的步骤以递归方式评估超类构造函数调用的参数和过程。**如果该构造函数调用突然完成，则此过程出于相同的原因突然完成。否则，继续执行步骤 4。
> 
> (4)**执行该类的实例初始化器和实例变量初始化器**，将实例变量初始化器的值分配给相应的实例变量，按照它们在源代码中以文本形式出现的从左到右的顺序。如果执行这些初始化程序中的任何一个导致异常，则不会处理更多初始化程序，并且此过程会突然完成相同的异常。否则，继续执行步骤 5。
> 
> (5)**执行此构造函数的其余部分。**如果该执行突然完成，则此过程出于同样的原因突然完成。否则，此过程正常完成。

总而言之，超类构造函数（第 3 步）在实例初始化程序（第 4 步）之前执行。两者都在“此构造函数的其余部分”（您的示例中没有）之前执行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T16:52:00.740

在您正在实例化的匿名类的**基类**的构造函数之后和匿名类本身的空隐式构造函数之前调用内联初始化块。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-21T16:53:46.967

您实际创建的不是`Temp`类实例，而是某个匿名类的实例，它继承自`Temp`.

因此，首先`Temp`调用初始化器（内部的匿名块`Temp`及其构造器），然后调用匿名类中的初始化器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-21T17:07:41.483

在您的代码中

```
Temp t = new Temp(){
    {
        System.out.println(" instance initialize");
    }
}; 
```

您正在创建扩展 Temp 类的匿名类对象。

创建子类的对象：

```
initialize block from Superclass
constructor of Superclass
initialize block from Subclass
constructor of Subclass 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-21T16:58:17.947

第 1 点：需要明确的是，您有两个实例初始化器：一个在 Temp 类中，一个在在 main() 方法中创建的匿名内部类中，该方法是 Temp 的子类。

第 2 点：实例初始化程序实际上并没有在构造函数*之前*运行。[根据 JLS，它们在构造函数*期间*](http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.5)运行，在委托给超级构造函数之后以及在初始化实例字段和完成构造函数之前。

第 3 点：在您的代码中，每个初始化程序都在适当的时间正确执行。我认为您希望第二个与第一个同时执行，但这是不正确的，因为正如第 1 点所指出的，它们是两个不同类的初始化程序。

第 4 点：您可能还会对静态[初始化程序和实例初始化程序](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)感到困惑。它们是两个截然不同的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-21T16:49:26.330

该对象必须首先在内存中，然后才能对其进行任何其他操作。该对象在内存中构造，然后您的控制台打印发生。

# php - imagettftext()：计算字体大小以确保文本适合图像宽度

> ID：10689225
> 
> 赞同：4
> 
> 时间：2012-05-21T16:46:35.487
> 
> 标签：php, imagettftext, dynamic-content, dynamic-image-generation

我`imagettftext()`用来在图像上写动态文本，我希望它适合我的图像宽度。

如何通过文本长度计算字体大小？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-21T16:52:32.363

`imagettfbbox`您可以在使用函数输出之前计算 TTF 文本的边界框。不幸的是，没有直接的缩放方法来适应宽度，所以你必须自己做。

一种方法是将默认字体大小（例如 20）的文本传递给`imagettfbbox`并从中检索宽度。然后，您可以通过计算比例因子来计算文本应该小多少或大多少以适合您想要的大小：

```
scale = targetWidth / bboxWidth; 
```

然后绘制适当大小的文本：

```
fontSize = 20 * scale; 
```

使用该`imagettftext`功能。字体不会以这种方式完美地 100% 缩放，但您会得到一个非常好的近似值。

`imagettfbox` [请参阅此处](http://www.php.net/manual/en/function.imagettfbbox.php)的文档。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-21T17:14:13.337

```
while (itsTooBigAccordingToimagettftext() && $fontSize > 0) {
    $fontSize--;
} 
```

# php - 刮削时的处理时间

> ID：10689227
> 
> 赞同：-1
> 
> 时间：2012-05-21T16:46:37.753
> 
> 标签：php, function, process, timing

我有一个网站从它的姊妹网站上刮下来，但出于报告原因，我希望能够计算出任务运行所需的时间。我将如何使用 PHP 来解决这个问题，甚至可能吗？

在理想情况下，如果任务在 5 秒后无法连接到实际运行，我想终止该功能的运行并报告失败。

谢谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:10:28.597

如果您使用 cURL 进行抓取，您可以像这样使用超时功能

```
// create a new cURL resource
$ch = curl_init();

// set URL and other appropriate options including timeout
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_HEADER, false);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);  // capture the result in a string
curl_setopt($ch, CURLOPT_TIMEOUT, 5);  // The number of seconds to wait while trying to connect.
// grab the info
if (!$result = curl_exec($ch))
{
    trigger_error(curl_error($ch));
}

// close cURL resource, and free up system resources
curl_close($ch);

// process the $result 
```

# excel - 我如何识别“#VALUE！” 在 Excel 电子表格中？

> ID：10689235
> 
> 赞同：74
> 
> 时间：2012-05-21T16:47:15.410
> 
> 标签：excel, excel-formula

我想写一个公式，如果单元格 A1 显示`#VALUE!`，比如`TRUE`在单元格 B1 中。

这是我在单元格 B1 中的公式：

```
=IF(A1="#VALUE!", "TRUE", "FALSE") 
```

`FALSE`当A1没有说`#VALUE!`那部分很好时，我明白了。但是，当它确实说 时`#VALUE!`，我`#VALUE!`在单元格 B1 中出现错误，而我想让它说`TRUE`。我该怎么做呢？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2012-05-21T16:49:49.363

采用`IFERROR(value, value_if_error)`

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-05-21T17:15:47.540

`TRUE`这将返回`#VALUE!`错误（ERROR.TYPE = 3）和`FALSE`其他任何内容。

```
=IF(ISERROR(A1),ERROR.TYPE(A1)=3) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-16T10:25:05.660

在 EXCEL 2013 中，我必须使用 IF 函数 2 次：第一次使用 ISERROR 识别错误，第二次使用 ERROR.TYPE=3 识别特定类型的错误，以解决此类错误。这样您就可以区分您想要的错误和其他类型的错误。

# ms-access - 从 Access VBA 全局禁用更新/删除？

> ID：10689236
> 
> 赞同：2
> 
> 时间：2012-05-21T16:47:16.523
> 
> 标签：ms-access, vba

我希望为 Access .MDB 添加一些基本的安全性。我想做的是从 VBA 查询 Active Directory（我有这个代码），然后如果用户不在正确的组中，请关闭数据库中每个表单的允许更新、删除、插入。基本上，只允许只读。

这可能吗？我怎样才能在 VBA 中做到这一点？有没有办法在 autoexec 方法中设置一次，而不是在每个表单上设置一次？

或者是否有另一种方法在这里提供简单的安全性？例子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:58:33.433

您可以使用以下过程为单个表单设置`AllowAdditions`、`AllowDeletions`和：`AllowEdits`

```
Public Sub SetFormEdit(ByVal pName As String, _
        ByVal pReadOnly As Boolean)
    Dim frm As Form

    DoCmd.OpenForm pName, acDesign
    Set frm = Forms(pName)
    frm.AllowAdditions = pReadOnly
    frm.AllowDeletions = pReadOnly
    frm.AllowEdits = pReadOnly
    DoCmd.Close acForm, pName, acSaveYes
    Set frm = Nothing
End Sub 
```

要为您的所有表格运行该程序...

```
Public Function SetAllFormsEdit()
    Dim blnReadOnly As Boolean
    Dim frm As Object

    'load value for blnReadOnly from your existing AD code '

    For Each frm In CurrentProject.AllForms
        SetFormEdit frm.Name, blnReadOnly
    Next frm
    Set frm = Nothing
End Function 
```

然后从宏的操作中调用该`SetAllFormsEdit`函数。`RunCode``autoexec`

# sql - 新的 SQL 表值不会保留

> ID：10689241
> 
> 赞同：-1
> 
> 时间：2012-05-21T16:48:02.047
> 
> 标签：sql, vb.net

我是处理 SQL Express DB 表的新手。我有一个 Windows 应用程序，它为用户提供了一个文本框，该文本框绑定到我的数据集 (ds) 中的一个值，该值反映了我的 SQL 表 (Specs) 字段。用户可以更改文本框的数值，我可以通过设置断点来查看它在我的数据集中创建了新值（我使用*MsgBox(Ds.Specs.Rows(0).Item(10)*来确定这是真的). 但是，当我打开应用程序备份时，OLD 值再次出现在文本框中。就像我的数据集没有更新 SQL Server 表一样。

同样，我是 SQL 表的新手，并允许向导创建我的所有插入/更新/删除语句，这些语句似乎已经到位。知道为什么我的价值观不会坚持吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:54:04.657

一旦将元素放入其中，就必须调用一个数据库 submitChanges() 函数来实际存储您的新信息我不确定该命令在 VB 中是什么，但在 c# 中它的 OnItemSubmitt()。它都是.NET，所以命令应该是一样的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T19:29:59.077

在`.NET`中，您需要确保调用`AcceptChanges()`Dataset 对象上的函数。这将保存自加载或自上次`AcceptChanges()`调用以来已更改的信息。

可以在[此处](http://msdn.microsoft.com/en-us/library/system.data.dataset.acceptchanges.aspx)找到有关该功能的一些信息及其使用示例。

# templates - JSF/PrimeFaces - 模板

> ID：10689247
> 
> 赞同：15
> 
> 时间：2012-05-21T16:48:31.447
> 
> 标签：templates, jsf, layout, primefaces, facelets

我需要创建一个这样的布局，[但](http://www.primefaces.org/showcase/ui/layoutFull.jsf)所有容器都位于单独的文件中，例如：

**顶部.xhtml**

```
<p:layout fullPage="true">
        <p:layoutUnit position="north" header="#{support.applicationTitle}">
            <h:form>
                <p:menubar>
                    <p:menuitem value="Quit" icon="ui-icon-close" action="#{userController.logOut()}" />
                </p:menubar>
            </h:form>
        </p:layoutUnit> 
```

没有，`</p:layout>`因为它将在我的**footer.xhtml**上关闭，例如：

```
<p:layoutUnit position="south" header="© 2012 - 2012 PORTAL DE IDEIAS">
</p:layoutUnit></p:layout> 
```

我已经尝试了这两个文件，但我得到一个错误，告诉我我需要关闭*布局*标签，什么是正确的，但我该如何解决我的问题？这是模板的最佳方法吗？另一个问题是*布局*标签需要一个中心*layoutUnit*

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-21T16:58:22.890

这确实不是正确的做法。您的模板必须是格式良好的 XML。如果您只想指定中心单元，我建议创建一个主模板文件。

以展示网站上的示例为例，应该如下所示：

`/WEB-INF/templates/layout.xhtml`

```
<!DOCTYPE html>
<html lang="en"
     xmlns="http://www.w3.org/1999/xhtml"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:p="http://primefaces.org/ui"
>
    <h:head>
        <title>Title</title>
    </h:head>
    <h:body>
        <p:layout fullPage="true">
            <p:layoutUnit position="north" size="100" header="Top" resizable="true" closable="true" collapsible="true">
                <h:outputText value="Top unit content." />
            </p:layoutUnit>

            <p:layoutUnit position="south" size="100" header="Bottom" resizable="true" closable="true" collapsible="true">
                <h:outputText value="South unit content." />
            </p:layoutUnit>

            <p:layoutUnit position="west" size="200" header="Left" resizable="true" closable="true" collapsible="true">
                <h:form>
                    <ui:include src="../templates/themeMenu.xhtml" />
                </h:form>
            </p:layoutUnit>

            <p:layoutUnit position="east" size="200" header="Right" resizable="true" closable="true" collapsible="true" effect="drop">
                <h:outputText value="Right unit content." />
            </p:layoutUnit>

            <p:layoutUnit position="center">
                <ui:insert name="content">Put default content here, if any.</ui:insert>
            </p:layoutUnit>
        </p:layout>
    </h:body>
</html> 
```

请注意`<ui:insert>`中心单元中的 。

模板客户端可以如下所示：

`/page.xhtml`

```
<ui:composition template="/WEB-INF/templates/layout.xhtml"
     xmlns="http://www.w3.org/1999/xhtml"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:p="http://primefaces.org/ui"
>
     <ui:define name="content">
         <p>Here goes your view-specific content.</p>
     </ui:define>
</ui:composition> 
```

您通过[http://example.com/contextname/page.xhtml](http://example.com/contextname/page.xhtml)打开。

### 也可以看看：

*   [如何使用 JSF 2.0 Facelets 在 XHTML 中包含另一个 XHTML？](https://stackoverflow.com/questions/4792862/how-to-include-another-xhtml-in-xhtml-using-jsf-2-0-facelets/4793959#4793959)

如果您正在寻找高级 Facelets 模板的实时开源示例，您可能会发现[OmniFaces 展示应用程序](https://github.com/omnifaces/showcase)很有用。

# c - 减轻环形缓冲区中轮询效应的策略

> ID：10689250
> 
> 赞同：1
> 
> 时间：2012-05-21T16:48:35.710
> 
> 标签：c, pthreads, conditional-statements, polling, circular-buffer

我在 1Reader 线程/1Writer 线程设置中使用规范的环形缓冲区实现。

由于读取器在缓冲区为空时循环[写入器在缓冲区满时循环]并不断轮询控制变量，因此我调用 pthread_yield（在我的情况下只是 sched_yield 的包装器）以优先考虑系统中的其他线程. 我没有使用任何互斥锁，因为正常运行不需要它。

有没有更好的方法来减轻轮询效应（又名 CPU 燃烧）？我在考虑 pthread 的条件变量——因为我主要在没有数据 [没有空间] 时阻塞线程——但我担心会引入开销。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T16:54:47.180

使用条件变量，开销*远*低于忙等待，并且正确使用互斥锁可确保您的数据在您期望的时候确实存在（因为它们强制排序）。

此外，如果您真的不需要在一般情况下使用互斥锁，则锁争用应该很低甚至不存在。

# matlab - 选择要绘制的某些点

> ID：10689255
> 
> 赞同：0
> 
> 时间：2012-05-21T16:48:53.537
> 
> 标签：matlab, plot

我在每 100 次运行中绘制正确且功能正常的传感器的数量。

我将得到以下情节： ![结果 wrt 运行](../Images/8e2c4fefd5f2c399d92833748c9c64e9.png)

每次运行的 100 个读数有点令人困惑。如何制作matlab绘图

1.  每 5 个值 (5,15,20....)

2.  5 次运行的平均值，因此地块数为 100/5。

你能在这两种情况下提供帮助吗 谢谢

如果在原始情况下 round=10 将有 10 个柱，

使用@Richante data_to_plot = data(1:5:end); 给出的公式 将有 2 个酒吧。很好，但是当我绘制时会在第 1 轮和第 2 轮获得值。如何显示这些是针对第 1 轮和第 5 轮的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:17:24.910

您可以通过对数组进行切片来绘制每 5 个项目：

```
data = %1-by-100 array
data_to_plot = data(1:5:end); 
```

要绘制 5 次运行的平均值，您可以执行一个 for 循环：

```
data_to_plot = zeros(1, 20);
for i=1:20
  data_to_plot = mean(data((i-1)*5:i*5));
end 
```

或者一种巧妙的方法是将数组重塑为 5×20 矩阵并取第一维的平均值：

```
data_to_plot = mean(reshape(data, 5, 20)); 
```

# language-agnostic - 硬编码的密码应该加盐/散列吗？

> ID：10689257
> 
> 赞同：4
> 
> 时间：2012-05-21T16:48:55.820
> 
> 标签：language-agnostic, passwords

StackOverflow 上有很多关于简单、无数据库登录系统的问题。当我想：“这样做真的有意义吗？”时，我正要在[最近的一个上建议一种盐渍哈希方法。](https://stackoverflow.com/q/10688529/825789)

多年来，我一直在数据库中存储加盐哈希，并且我理解它为什么更安全：如果数据库遭到破坏，它包含的信息将不允许任何人登录我的系统（与我将纯文本密码存储在D b）。

但是在不涉及数据库的设置中，散列+加盐是否提供任何安全优势？我能想到的唯一原因是，如果攻击者获得了对我的服务器端代码的只读访问权限，就不可能找出任何密码。这是一个可能的情况吗？因为只要攻击者获得对文件的写入权限，他就可以做任何事情。

所以我的问题是：在设置非常简单、无数据库的登录系统时，密码应该加盐/散列，还是只存储为纯文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:00:47.243

是的，它仍然为哈希**和加盐**提供了好处。如果脚本的源代码被泄露，人们可以简单地使用硬编码密码或 google 进行哈希，并可能找到输入值。使用盐渍哈希两者都不可能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T17:16:37.110

我认为如果你能找出答案，“我的源代码被攻击者读取的可能性明显低于数据库吗？”，我认为这个问题已经为你解答了。

我建议不是 - 也许您的源不太可能泄漏，这取决于备份的方式等。即使如此，我怀疑泄漏的可能性要小得多，以至于您可以忽略风险，因为您这样做了不要忽视数据库的相同风险。数据库中的密码应该被加盐/散列的原因并不是因为数据库的某些特殊属性意味着攻击者可以查看其内容[*]，而是攻击者可以以一种或另一种方式查看各种事物。

事实上，源代码甚至可能比数据库*更*容易泄漏，因为在系统上工作的任何人都可能需要访问源代码，而不是每个在系统上工作的人都必须访问实时数据库的内容。并不是说我认为您的开发人员不诚实（如果他们是，您遇到的问题比密码泄露更严重），只是围绕共享源的后勤工作可能会引入更多（或只是不同）可能意外泄漏的方式，而不是围绕备份的后勤工作数据库。

就个人而言，在您的情况下，我会在服务器上创建一个小文件，其中包含散列/加盐密码，几乎没有其他内容。安装应用程序不同实例的用户可以生成他们自己版本的此文件，其中包含他们自己的密码，与实际应用程序代码分开。他们应该使用与源代码相同的写访问限制来锁定它。

无论您将此文件称为“只读数据库”还是“服务器代码的一部分”，都不会影响攻击者查看它的难易程度，尽管它可能会影响您是否将密码称为“硬编码” ”。

[*] 当然，对于特定的数据库、SQL 注入攻击或其他什么，存在一些特殊的潜在缺陷。这些*并不是*数据库中的密码应该加盐和散列的决定性原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-23T12:11:53.773

好吧，正如史蒂夫杰索普已经概述的那样。源代码可能会泄漏或更有可能落入某些人手中。如果您对密码进行硬编码（我所理解的），那么为什么不将其存储为两部分的数据结构 => 使用的盐和散列密码。你知道它，但它从未出现在源代码中。这也是人们对数据库连接字符串或类似内容所做的事情。使用位于其下方变量中的密钥对其进行加密。因此它永远不会出现在源代码中。除非刚刚越过，否则甚至可能不在内存转储中。

# android - 如何以编程方式确定我的 Android 应用程序正在使用哪种 XML 布局？

> ID：10689259
> 
> 赞同：10
> 
> 时间：2012-05-21T16:49:01.013
> 
> 标签：android, android-layout

如何以编程方式确定我的应用当前使用的布局（布局正常、布局大等）？我看到了 getWindowManager().getDefaultDisplay().getMetrics(metrics) 调用，但它似乎只处理屏幕密度，而不是应用程序使用的布局。我需要这些信息，因为我需要在运行时以编程方式动态更改视图的一些定位。

提前致谢。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-08T03:30:34.767

一个非常简单的方法是通过为父布局设置一个 id 和标签，在你的`onCreate()`, 你可以`findViewById()`和`getTag()`.

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:id="@+id/my_activity_view"
    android:tag="big_screen" >
        // misc views~
</RelativeLayout> 
```

然后，在你的`onCreate`方法中，

```
if(findViewById(R.id.my_activity_view).getTag().equals("big_screen")) {
    // do stuff
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-12-17T20:11:18.140

我有同样的问题。如果您正在使用`layout`// `layout-sw600dp`，`layout-sw720dp`则以下内容对我有用：

```
Configuration config = activity.getResources().getConfiguration();

if (config.smallestScreenWidthDp >= 720) {
  // sw720dp code goes here
}
else if (config.smallestScreenWidthDp >= 600) {
  // sw600dp code goes here
}
else {
  // fall-back code goes here
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-30T04:44:42.287

以下代码将为您提供帮助。我只是打印了相应的屏幕尺寸或密度类别。你可以为所欲为！

```
//Determine screen size
    if ((getResources().getConfiguration().screenLayout &Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_LARGE) 
    {     
        Log.d("Screen Size: ", "LARGE");

    }
    else if ((getResources().getConfiguration().screenLayout &      Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_NORMAL) {     
        Log.d("Screen Size: ", "NORMAL");

    } 
    else if ((getResources().getConfiguration().screenLayout &      Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_SMALL) {     
        Log.d("Screen Size: ", "SMALL");
    }
    else if ((getResources().getConfiguration().screenLayout &      Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_XLARGE) {     
        Log.d("Screen Size: ", "XLARGE");
    }
    else {
        Log.d("Screen Size: ","UNKNOWN_CATEGORY_SCREEN_SIZE");
    }

    //Determine density
    DisplayMetrics metrics = new DisplayMetrics();
        getWindowManager().getDefaultDisplay().getMetrics(metrics);
        int density = metrics.densityDpi;

        if (density==DisplayMetrics.DENSITY_HIGH) {
            Log.d("Screen Density: ","HIGH");
        }
        else if (density==DisplayMetrics.DENSITY_MEDIUM) {
            Log.d("Screen Density: ","MEDIUM");
        }
        else if (density==DisplayMetrics.DENSITY_LOW) {
            Log.d("Screen Density: ","LOW");
        }
        else if (density==DisplayMetrics.DENSITY_XHIGH) {
            Log.d("Screen Density: ","XHIGH");
        }
        else if (density==DisplayMetrics.DENSITY_XXHIGH) {
            Log.d("Screen Density: ","XXHIGH");
        }
        else {
            Log.d("Screen Density: ","UNKNOWN_CATEGORY");
        } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-26T14:41:46.173

我正在寻找同样的东西！我发现了 2 个类似的问题/答案：

[获取 ScreenLayout](https://stackoverflow.com/questions/5998264/how-do-i-get-the-generalized-screen-size)

[使用 ScreenLayout 位掩码](https://stackoverflow.com/questions/5015094/determine-device-screen-category-small-normal-large-xlarge-using-code)

虽然这三个问题本质上是相同的，但您确实需要两个答案才能得到结果。

我使用这段代码来获取我的 Activity 中的布局大小：

```
int layoutSize = getResources().getConfiguration().screenLayout;
layoutSize = layoutSize & Configuration.SCREENLAYOUT_SIZE_MASK; 
```

第一行将返回布局大小，但它将是一个几乎是`int`.

第二行将与给定掩码的布局大小。掩码的十进制值为 15，或十六进制值为 F。

返回的值介于 0 和 3 之间。屏幕尺寸对应的值以及尺寸掩码的值在`android.content.res.Configuration`类中定义为常量：[Android Configruation Documentation](http://developer.android.com/reference/android/content/res/Configuration.html#SCREENLAYOUT_SIZE_LARGE)。

在前两行之后，您需要做的就是使用某种 switch 语句将返回的值`layoutSize`与`Configuration`的预定义值进行比较`SCREENLAYOUT_SIZE_XXX`。

希望您使用它还为时不晚。我的问题是我不知道如何用确切的 Android 语言提问。这可能就是为什么同一个问题被问到而且可能应该被问到这么多不同的方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-04T00:02:36.307

这是一个老问题，但我想分享我解决这个问题的方法。

创建一个与您希望以编程方式确认的每个设置匹配的*values-**变体，您将在其中定义描述当前配置的正确值：

[![在此处输入图像描述](../Images/502ebb6d533ae7a5b890fdacd3f6d154.png)](https://i.stack.imgur.com/rMW19.png)

如您所见，布尔值*is_landscape*同时存在于*values*和*values-land*中，因此可以通过*R.bool.is_landscape*安全地访问它。

但是，唯一的区别是值：

`getResources().getBoolean(R.bool.is_landscape);`在横向模式下评估为`true`，`false`否则。

**注意**：当然可以使用它`getResources().getConfiguration().orientation`来获取当前的设备方向，尽管我选择使用这个简单熟悉的案例来使我的示例清晰明了。

重要的是要了解这种技术是通用的，使用它可以定义更复杂的值资源目录（例如*values-ldrtl-sw600dp-v23*）以支持更具体的配置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-21T16:55:14.297

```
ViewGroup view = (ViewGroup)getWindow().getDecorView();
LinearLayout content = (LinearLayout)view.getChildAt(0);
int id = content.getId(); 
```

id 告诉您正在使用哪种布局（假设您在 XML 中设置了 id 标记）。

# performance - 关于在 GAE 上放置支付/交易应用程序的一些担忧

> ID：10689263
> 
> 赞同：1
> 
> 时间：2012-05-21T16:49:16.613
> 
> 标签：performance, google-app-engine, bigtable

我正在尝试在 GAE 上构建一个类似购物车的 webapp。到目前为止，我还没有在 GAE 上部署任何东西，只是继续在本地做一些 POC ......然后，我读到了这个：

[http://borglin.net/gwt-project/?page_id=688](http://borglin.net/gwt-project/?page_id=688)

当我读完这些“弱点”时，我感到很惊讶，我很担心将应用程序放在 GAE 上是否是一个不错的选择。有人，尤其是有使用现金交易构建现实世界应用程序经验的人，请给我一些想法/分享您的想法吗？

1.  文章称GAE“没有对您的域的https支持”。这是真的吗？我以为我需要做的只是将我的域`https://www.abc.com`指向 GAE `https://abc.appspot.com`...

2.  对于 BigTable，我知道在我的应用程序中构建分析/统计功能非常困难（例如，提供每月交易摘要）。有没有人有任何经验来处理这种情况......？将数据从 BigTable 导出到 RDBMS 并执行一些 SQL ...？

3.  文章还说 BigTable 的写入性能很差：“我很幸运能在一个 GAE 请求中每秒写入 100 次。”是真的吗？我找不到任何数据来支持/反驳它..

4.  我现在在服务器端使用 SpringMVC + Objectify。对 GAE 来说太重了吗？有人说春天可以做一个漫长的冷开始......它有多冷？用 20 多个不同的页面/控制器和 20 多种实体/DAO 初始化一个应用程序需要多长时间 ..？？任何球场数字..??

ps 如果您知道任何基于 GAE 构建的真实世界应用程序，请在这里分享？因为我想知道我的应用程序能走多远（或有多大）。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:55:18.523

1）这是真的。仅 .appspot.com 支持 https。一个非常大的缺点。

2) 这不是真的，如果您需要进行复杂的连接等，您可以使用远程处理 API 进行任何类型的月度总结报告。您还可以导出数据并使用离线工具

3）我还没有看到那种写性能瓶颈，但最终的一致性需要处理。也就是说，每秒 100 次写入并不是一个小数字……

4）我会避免在appengine上使用spring。很多人都乐于使用它，但我发现启动时间很慢，这会导致问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:56:37.780

1.  自定义域的 SSL 处于[测试阶段](http://googleappengine.blogspot.com/2011/10/app-engine-ssl-for-custom-domains-in.html)。请注意，HTTPS/SSL 并非设计用于共享 IP 托管（例如 GAE），因此有一些 SSL 扩展在浏览器（SNI/VIP）上具有各种支持。

2.  Datastore 上的查询非常弱。它们也很贵。有两种方法可以进行分析：

    一个。创建一组分片计数器并在每次发生事件（= 金融交易）时更新计数器。我们使用它并且效果很好。唯一的缺点是这是“在线”分析。您不能为过去的数据添加额外的分析参数。

    湾。将（匿名）数据上传到[Google Big Query](https://developers.google.com/bigquery/)并在那里进行分析。

3.  数据存储对单个实体或实体组的写入更新限制约为 5 次/秒（有些来源说 1 次/秒）。对不同实体的并行写入没有限制。请记住，GAE 是一个分布式系统，所有应用程序都在后台使用一个 BigTable 数据库。所以这是非常可扩展的。

4.  我没有这方面的经验，但是网上有各种各样的报道。请参阅此[http://www.listry.com/blog/2010/03/google-app-engine-cold-start-guide-for](http://www.listry.com/blog/2010/03/google-app-engine-cold-start-guide-for)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T16:53:16.717

我不知道其他主题，但我可以告诉你的是，我们使用 Guice + jersey 的组合来替代 Spring :) 如果我们考虑到启动时间，它对 GAE 更好

# php - Ajax 没有输出

> ID：10689271
> 
> 赞同：1
> 
> 时间：2012-05-21T16:49:37.443
> 
> 标签：php, ajax

我正在尝试制作一个类似的系统。没有 Ajax 一切正常，但 ajax 还没有准备好。我的意思是，ajax 帖子是好的，答案是好的，但是屏幕上的输出是不好的。当我单击 LIKE 按钮时，会发生注意（没有页面刷新）。当我刷新帖子时，还有一个喜欢。` 没有 ajax，功能和一切正常

这是我的 Ajax 文件：

```
<?php
ini_set('display_errors', 1);
include_once ('../classes/comments.class.php');
$key = $_POST['key'];
$sessie = $_POST['login'];
    $like1 = new Comments();
    $like1 -> Key = $key;
    $like1 -> User = $sessie;
try{
    $feedback["status"] = "succes";
    $like1 -> addlikes();
    $feedback["message"] = $like1 -> CountLikes();

} catch (Exception $e) {
    $feedback["message"] = $e -> getMessage();
    $feedback["status"] = "error";
}

header('Content-type: application/json');
echo json_encode($feedback);
?> 
```

这里是我的 PHP 页面中的代码：

```
<script type="text/javascript">
        $(document).ready(function() {
            $("#knop").click(function() {
                var login = $("#login").text();
                var key = $("#key").text();
                $.ajax({
                    type: "POST",
                    url: "assets/ajax/check_likes.php",
                    data: { login : login , key : key},
                    success: function( msg ){
                        if ( msg.status == "success" ) {
                            $("#likes h1").text( msg.message );
                        }
                    }    
                });
                return false;
            });
        });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:43:12.810

你可以尝试在ajax文件中添加一个`exit();`after吗？`echo json_encode($feedback);`

**编辑：**还尝试使用 Firebug 中的控制台（或 chrome 检查器或其他）来检查 ajax 响应是否是有效的 json。

# python - 我有模数和私人指数。如何构造 RSA 私钥并签署消息？

> ID：10689273
> 
> 赞同：8
> 
> 时间：2012-05-21T16:49:42.467
> 
> 标签：python, cryptography, rsa, pycrypto

我是密码学和pycrypto的新手。

我有模数`n`和私有指数`d`。根据我在阅读一些文档后的理解，*私钥*由`n`和组成`d`。

我需要签署一条消息，但我不知道如何使用`pycrypto`. `RSA.construct()`方法接受一个元组。但是我必须另外提供`e`这种方法的公共指数（我没有）。

所以这是我的问题。我是否必须以`e`某种方式计算才能签署消息？

看来我应该能够通过使用`n`和`d`（构成私钥）来签署消息。我对么？我可以这样做`pycrypto`吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T18:36:35.883

Actually for decrypting a message encrypted with the public key it's enough to have the private exponent.

That also means you can sign a message, because signing basically is just *de*crypting the plaintext with the private key, which when *en*crypted with the public key will give the plaintext again. Usually you use a hash digest on the plaintext before and sign that...

The reason why you can't decrypt a message uing only `n` and `d` with `pyrcypto` is that it does a [blinding step](https://github.com/dlitz/pycrypto/blob/master/lib/Crypto/PublicKey/RSA.py#L101) during message decryption, which [involves the public exponent](https://github.com/dlitz/pycrypto/blob/master/lib/Crypto/PublicKey/_slowmath.py#L41), but isn't really needed for the decryption.

But by using some calls to the private API this step can be bypassed.

Therefore this should work:

```
from Crypto.PublicKey import RSA
from Crypto.Util.number import bytes_to_long, long_to_bytes

full = RSA.generate(2048)

# construct key using only n and d
try:
    # pycrypto >=2.5, only tested with _slowmath
    impl = RSA.RSAImplementation(use_fast_math=False)
    partial = impl.construct((full.n, 0L))
    partial.key.d = full.d
except TypeError:
    # pycrypto <=2.4.1
    partial = RSA.construct((full.n, 0L, full.d))   

pub = full.publickey()

# create message with padding
# http://en.wikipedia.org/wiki/RSA_%28algorithm%29#Padding_schemes
cleartext = ...

signature = partial.sign(cleartext, None)

print "validating message: ", pub.verify(cleartext, signature)

message = pub.encrypt(cleartext, None)

# bypassing the blinding step on decrypt
enc_msg=map(bytes_to_long, message)
dec_msg = map(partial.key._decrypt, enc_msg)

print "decrypting: "
for m in dec_msg:
    print long_to_bytes(m) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T17:02:28.930

不，你不能`e`从`d`.

`d`RSA 在和中是对称的`e`：您可以很好地互换公钥和私钥的角色。当然，我们专门选择一个保密并透露另一个——但*理论上*它们做同样的事情。自然，由于您无法从公钥中推断出私钥，因此您也无法从私钥中推断出公钥。

当然，如果您拥有私钥，则意味着*您*生成了密钥对，这意味着您在某处拥有公钥。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T18:20:33.553

如果您没有公共指数，您可能会猜到它。大多数时候，它不是随机素数，而是静态值。尝试值 65537（十六进制`0x010001`，费马的第四个数）、3、5、7、13 和 17（按此顺序）。

[编辑] 只需用私钥签名并用公钥验证，看看公钥是否正确。

注意：如果它是随机素数，它与私有指数一样难以找到；这意味着您将尝试破坏 RSA - 对于任何大于 512 位的密钥都不太可能。

# jquery - jQuery 淡出 CSS3 替换

> ID：10689274
> 
> 赞同：0
> 
> 时间：2012-05-21T16:49:46.887
> 
> 标签：jquery, ipad, css, fadeout

我知道它之前已经发布过，但没有提供我认为合适的答案，所以我会再次询问，因为我想使用与 ipad 兼容的相同代码。

有没有办法可以重写 jQuery 函数 .fadeOut 以使用 CSS3？甚至像一个jquery函数。

```
.css3fadeout() 
```

然后运行类似的序列

```
$(this).addClass('CLASS WITH FADE OUT ANIMATION');
$(this).delay(2000).hide(); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:09:59.530

[您可以使用此参考http://docs.jquery.com/Plugins/Authoring](http://docs.jquery.com/Plugins/Authoring)编写新函数/插件。

或者您可以使用此参考覆盖该函数：[http ://www.bennadel.com/blog/1624-Ask-Ben-Overriding-Core-jQuery-Methods.htm](http://www.bennadel.com/blog/1624-Ask-Ben-Overriding-Core-jQuery-Methods.htm)

# php - PHP：使用 mysql_fetch_assoc 时遇到问题

> ID：10689276
> 
> 赞同：0
> 
> 时间：2012-05-21T16:49:57.740
> 
> 标签：php, mysql

我正在尝试从我的数据库中返回结果，以便我可以创建一个用于 Adob​​e Flex 的 XML 文件，然后我将在其中填充一个谷歌地图。目前使用查尔斯我收到以下错误`mysql_fetch_assoc(): supplied argument is not a valid MySQL result resource`

这是我的功能的代码：

```
public function getBusiness ($item)
{
    $stmt = mysqli_prepare($this->connection,

    "SELECT * FROM businesses");

    $this->throwExceptionOnError();

    mysqli_stmt_execute($stmt);

    $this->throwExceptionOnError();

    $row = "";

    echo "<?xml version=\"1.0\" ?><map>";

    while(($row = mysql_fetch_assoc($stmt)) !== false)
    {
        echo "<business><businessid>" . $row["businessid"] . "</businessid>";
        echo "<type>" . $row["type"] . "</type>";
        echo "<name>" . $row["name"] . "</name>";
        echo "<street>" . $row["street"] . "</street>";
        echo "<city>" . $row["city"] . "</city>";
        echo "<country>" . $row["country"] . "</country>";
        echo "<postcode>" . $row["postcode"] . "</postcode>";
        echo "<latitude>" . $row["latitude"] . "</latitude>";
        echo "<longitude>" . $row["longitude"] . "</longitude>";
        echo "<phonenumber>" . $row["phonenumber"] . "</phonenumber>";
        echo "<email>" . $row["email"] . "</email>";
        echo "<website>" . $row["website"] . "</website>";
        echo "<logo>" . $row["logo"] . "</logo>";
        echo "<description>" . $row["description"] . "</description>";
        echo "<datesubmitted>" . $row["datesubmitted"] . "</datesubmitted></business>";
    }
    echo "</map>";

} 
```

任何人都可以提供帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T16:51:35.373

您`mysqli`用于运行语句，然后尝试将结果处理为`mysql`？是的，那是行不通的。

使用来自同一扩展的功能！它们不是交叉兼容的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:32:44.653

您应该使用[fetch_array](http://www.php.net/manual/en/mysqli-result.fetch-array.php) () 而不是 mysql_fetch_assoc()

# android - 您如何正确处理来自 android 原生应用程序的设备方向？

> ID：10689283
> 
> 赞同：0
> 
> 时间：2012-05-20T19:19:11.547
> 
> 标签：android, opengl-es

目标是制作一个简单的 2d 箭头指南针应用程序，就像[这里的](http://examples.oreilly.com/9780596804831/readme.html#HelloArrow)[iPhone 3D Programming](https://rads.stackoverflow.com/amzn/click/com/0596804822) 一书中的应用程序一样，它可以平滑地旋转以响应方向变化。

AndroidManifest.xml（订阅方向更改）

```
<activity android:name="android.app.NativeActivity"
 android:label="@string/app_name"
 android:configChanges="orientation|keyboardHidden"> 
```

AndroidApp.cpp（获取旋转角度）

```
void AndroidApp::handleCmd (int32_t cmd) {
switch (cmd) {
    case APP_CMD_CONFIG_CHANGED:
       // Your code here
    break;
  }
} 
```

RenderingEngine.cpp（存储角度以在渲染场景时旋转箭头）

```
 void RenderingEngine::OnRotate(DeviceOrientation orientation)
    {
       float angle = 0;

       switch (orientation) {
          case DeviceOrientationLandscapeLeft:
             angle = 270;
             break;

          case DeviceOrientationPortraitUpsideDown:
             angle = 180;
             break;

          case DeviceOrientationLandscapeRight:
             angle = 90;
             break;
       }

       m_desiredAngle = angle;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:45:33.093

If you want to make the rotation smooth you should use compass instead of orientation change event.

I suggest checking out the documentation for [NativeActivity](http://developer.android.com/reference/android/app/NativeActivity.html). There is an example with accelerometer:

```
// Prepare to monitor accelerometer
engine.sensorManager = ASensorManager_getInstance();
engine.accelerometerSensor = ASensorManager_getDefaultSensor(engine.sensorManager,
        ASENSOR_TYPE_ACCELEROMETER);
engine.sensorEventQueue = ASensorManager_createEventQueue(engine.sensorManager,
        state->looper, LOOPER_ID_USER, NULL, NULL); 
```

Probably there is more info in Android NDK documentation which you can find in `<ndk>/docs` directory ([source](http://developer.android.com/sdk/ndk/overview.html#docs)).

# razor - Umbraco - 使用 Razor 渲染 .Net 用户控制 (ascx) 宏

> ID：10689284
> 
> 赞同：4
> 
> 时间：2012-05-21T16:50:42.793
> 
> 标签：razor, macros, render, umbraco

我在 Umbraco 中有一个非常复杂的剃须刀脚本，我希望在其中的某个时候在其中渲染一个宏。

被称为 SuggestionBox 的宏实际上是一个用户控件 (.ascx)，传统上它在模板上使用

```
<umbraco:macro Alias="SuggestionBox" language="cshtml" runat="server"></umbraco:macro> 
```

但是现在我需要从剃刀脚本中调用它，所以我尝试了；

```
@Html.Raw(umbraco.library.RenderMacroContent("SuggestionBox", Model.Id)) 
```

也：

```
@RenderPage("SuggestionBox") 
```

没有运气，因为我确定我错误地使用了这些。

如果页面包含在母版页中，我在某处读到它可能是不可行的。

如果我像往常一样将它添加到模板中，它会起作用：

```
 <umbraco:macro Alias="EventsRenderer" language="cshtml" runat="server"></umbraco:macro>
 <div class="talkingPointPanel">
    <h3><umbraco:Item field="talkingPoinstSuggestionText" runat="server"></umbraco:Item></h3>
    <umbraco:macro Alias="SuggestionBox" language="cshtml" runat="server"></umbraco:macro>
 </div> 
```

EventsRenderer 在哪里呈现理想情况下应该包含 SuggestionBox 的页面。

使用

```
@Html.Raw(umbraco.library.RenderMacroContent("<?UMBRACO_MACRO macroAlias=\"SuggestionBox\" />", Model.Id)) 
```

给我这个错误：

```
<!-- Error generating macroContent: 'System.Web.HttpException (0x80004005): HtmlForm cannot render without a reference to the Page instance.  Make sure your form has been added to the control tree.

   at System.Web.UI.HtmlControls.HtmlForm.Render(HtmlTextWriter output)

   at System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter)

   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)

   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)

   at umbraco.presentation.templateControls.Macro.Render(HtmlTextWriter writer)

   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)

   at umbraco.library.RenderMacroContent(String Text, Int32 PageId)' --> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-10T18:44:29.420

```
<umbraco:Macro runat="server" language="cshtml">@{

HtmlTextWriter writer = new HtmlTextWriter(this.Output);
var navigation = new umbraco.presentation.templateControls.Macro();

navigation.Alias = "Navigation";
navigation.MacroAttributes.Add("ulclass", "art-vmenu");
navigation.MacroAttributes.Add("level", 2);

navigation.RenderControl(writer);   }</umbraco:Macro> 
```

尝试这样的事情。它对我有用......我制作了一个导航宏。请注意，尽管您的变量应在 toLower 中给出，但如果使用大写字母，则参数将无法通过。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T23:16:43.527

在 Umbraco 4.10+ 中要在 Razor 脚本中调用宏，请使用：

@Umbraco.RenderMacro("macroNameHere", new { propertyName1 = CurrentPage.pageProperty }))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T20:13:57.610

尝试这样的事情：

```
@Html.Raw(umbraco.library.RenderMacroContent("<?UMBRACO_MACRO macroAlias=\"SuggestionBox\" />", Model.Id)) 
```

# unit-testing - 任何人都有在 Resharper 7 EAP 中运行的 Jasmine 单元测试吗？

> ID：10689285
> 
> 赞同：8
> 
> 时间：2012-05-21T16:50:45.357
> 
> 标签：unit-testing, resharper, jasmine

我真的很想为我的 javascript 单元测试使用 R#r 测试。R#r 7 EAP 可以识别测试，但是当我启动它们时，运行器对所有测试都显示“...测试未运行”。

我找不到任何关于 R#r 测试运行器在配置/目录结构方面期望的信息。

目录结构和示例测试张贴[在这里](http://devnet.jetbrains.net/message/5460039#5460039)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T20:07:40.253

基本/硬编码的 jasmin 单元测试在 R#r 7 EAP 下工作。这意味着茉莉花被*烘焙*到 R#ri 猜测中。对此有一个未解决的问题。

```
describe('resharper jasmine testrunner', function () {
    describe('simplest possible test', function () {
        it('should execute', function() {
            expect(true).toBe(true);
        });
    });
}); 
```

[在R#r 论坛](http://devnet.jetbrains.net/message/5460322#5460322)上得到一个指针，文档注释引用是您的“包含”（或 jsTestDriver.conf 等效项）。

```
/// <reference path="../../libs/testing/jasmine/jasmine.js"/>
/// <reference path="../../libs/crunch/jquery-1.6.2.js"/> 
```

尽管现在运行，我的真正测试还没有通过。接下来研究夹具路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:35:37.293

我不确定您正在寻找的解决方案/结构有多先进，因为我自己刚刚开始研究这个，但我有一个简单的示例测试“工作”* ...（使用 Resharper 7 EAP 7.0.56.103） . 据我所知，只要您使用 <reference path="foo/path/file.js" /> 包含对其所有依赖项的引用，您就可以在任何地方/您想要的任何地方构建您的测试文件）

*这些在 ReSharper 单元测试会话窗口内传递。浏览器没有向我显示任何类型的测试信息，而是一个空白屏幕，源代码中有一些与茉莉花相关的 html。

/scripts/cheese.js

```
function Cheese() {
    return {
        isGood: true
    };
} 
```

/tests/cheeseTest.js

```
/// <reference path="/scripts/cheese.js"/>
describe('simplest possible test', function() {
    var cheese = null;
    it('cheese is good', function() {
        cheese = new Cheese();
        expect(cheese.isGood).toBe(true);
    });
}); 
```

# ruby-on-rails - ActiveRecord 上范围的关系

> ID：10689288
> 
> 赞同：5
> 
> 时间：2012-05-21T16:50:52.747
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.2

这是我的 ActiveRecord 模型，带有 Rails 3.2：

```
class User < ActiveRecord::Base
    has_one :criterion
    has_many :user_offer_choices
end

class Offer < ActiveRecord::Base
    has_many :user_offer_choices

    def seen
        user_offer_choices.where(seen: true)
    end

    def accepted
        user_offer_choices.where(accepted: true)
    end
end

class Criterion < ActiveRecord::Base
    belongs_to :user
end

class UserOfferChoice < ActiveRecord::Base
    belongs_to :user
    belongs_to :offer
end 
```

我想获得看到报价的用户的所有标准。就像是 ：

```
Offer.find(11).seen.users.criterions 
```

但我不知道如何使用 ActiveRecord

我知道我可以做类似的事情：

```
Criterion.joins(user: { user_offer_choices: :offer }).where(user: { user_offer_choices: {accepted: true, offer_id: 11}  } ) 
```

但我希望能够在报价中使用我的范围（已查看并已接受）。那么我该怎么做呢？

*编辑：* 我找到了我想要的，Arel 的合并方法：http: [//benhoskin.gs/2012/07/04/arel-merge-a-hidden-gem](http://benhoskin.gs/2012/07/04/arel-merge-a-hidden-gem)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T00:57:50.073

首先，您真正想要的是为您的选择定义一个范围。

```
class UserOfferChoice < ActiveRecord::Base
  belongs_to :user
  belongs_to :offer

  scope :seen, where(seen: true)
  scope :accepted, where(accepted: true)
end 
```

这允许您执行此操作

```
Offer.find(11).user_offer_choices.seen 
```

并获得标准：

```
Offer.find(1).user_offer_choices.seen.map{|choice| choice.user}.map{|user| user.criterion} 
```

现在，这可以通过 Offer 类中的 has many through 来清理。

```
class Offer < ActiveRecord::Base
  has_many :user_offer_choices
  has_many :users, :through => :user_offer_choices
end 
```

但这让我们接触到了用户，但跳过了范围。

```
Offer.find(1).users 
```

现在，您可以使用 Rails 3 作用域做一个技巧，而用 Rails 2.3.5 named_scopes 做不到。named_scopes 将散列作为参数，但返回一个关系。Rails 3 范围采用关系，例如来自 where 等查询方法。因此，您可以*使用您的选择类*中定义的范围在用户中定义范围！

```
class User < ActiveRecord::Base
  has_one :criterion
  has_many :user_offer_choices
  has_many :offers, :through => :user_offer_choices

  scope :seen, UserOfferChoice.seen
  scope :accepted, UserOfferChoice.accepted
end 
```

这允许我们这样做：

```
Offer.find(1).users.seen 
```

地图现在看起来像这样：

```
Offer.find(1).users.seen.map{|user| user.criterion} 
```

顺便说一句，标准的复数是标准。当我读到它时，我脑海中的听力标准，很痛苦。你可以这样做让 Rails 知道复数：

```
config/initializers/inflections.rb
ActiveSupport::Inflector.inflections do |inflect|
  inflect.plural /^criterion$/i, 'criteria'
end 
```

# powershell - 仅当 XAMPP 尚未运行时才使用批处理启动 XAMPP

> ID：10689289
> 
> 赞同：0
> 
> 时间：2012-05-21T16:50:53.290
> 
> 标签：powershell, batch-file, window, xampp

我正在为我公司软件的新部署编写一批..这是我到目前为止所拥有的......

```
wscript.exe "invisible.vbs" "apache_start.bat" /wait
wscript.exe "invisible.vbs" "mysql_start.bat" /wait
"C:\Program Files\Internet Explorer\iexplore.exe" http://localhost 
```

如你所见，这个脚本应该启动 apache，然后启动 mysql，然后用 IE 打开默认页面。

问题是如果用户运行此脚本两次，它会运行 apache 和 mysql 两次并加载两个单独的实例。我需要的解决方案是检查进程是否已经在运行，如果没有，则运行两个 wscript 命令。我对 shell 非常糟糕，所以请尝试给出具体的回应！我是一名软件工程师，而不是系统管理员。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T02:05:48.397

对于 XAMPP，apache/bin 文件夹中有一个 pv.exe 文件，XAMPP 使用它来查看服务是否正在运行。查看 WorldDrknss 在此线程中的回答以获得一些重要信息：[http ://www.apachefriends.org/f/viewtopic.php?p=80047](http://www.apachefriends.org/f/viewtopic.php?p=80047)

解决您的问题的代码是将您的 mysql_start.bat 文件修改为：

```
@echo off 
apache\bin\pv mysqld.exe %1 >nul 
if ERRORLEVEL 1 goto Process_NotFound 
echo MySQL is running 
goto END 
:Process_NotFound 
echo Process %1 is not running 
mysql\bin\mysqld.exe --defaults-file=mysql\bin\my.ini --standalone --console
goto finish 
:finish 
```

这将检查 mysqld.exe 是否正在运行。如果是的话，它只是呼应了这一点。如果没有，它会启动服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:15:51.740

作为一名软件工程师，我认为您在编写脚本方面比一些系统管理员更有优势......

使用 PowerShell 将使这一切变得容易。使用下面的模板来执行服务 - 你需要使用它两次，然后按照上面的方法启动 IE。

```
If ((Get-Process mysqlprocessname.exe)) {Write-Host Skipping MySQL}
Else { Start-Process ...} 
```

这将花费您几分钟的时间来研究使用 PowerShell 启动进程的最佳方式。此外，您可能希望通过管道将 Start-Process 传递给 Out-Null，以便脚本等待启动 IE 和 Apache。

其他人可能希望从批处理文件中使用更简单的方法。

# java - 如何验证 XML 中带注释的对象的集合

> ID：10689291
> 
> 赞同：1
> 
> 时间：2012-05-21T16:51:04.513
> 
> 标签：java, hibernate-validator

我正在查看[这篇关于使用 JSR-303 验证对象集合的帖子](https://stackoverflow.com/a/7136152/249016)。该解决方案适用于注释，但我似乎无法让它与 Hibernate Validator XML 格式化配置一起使用。

例如，我有类似这样的代码：

```
public class DataSet
{
    Collection<Data> dataCollection;
    public Collection<Data> getDataCollection() {...}
} 
```

从那里，我有一个自定义验证器/注释`DataValidator`/ `@ValidData`。

在 XML 中，我首先这样做：

```
<bean class="DataSet"
    ignore-annotations="true">
    <field name="dataCollection">
        <valid/>
        <constraint annotation="ValidData"/>
    </field>
</bean> 
```

但是，我得到以下异常：

```
Exception in thread "main" javax.validation.UnexpectedTypeException: No validator could be found for type: java.util.Collection<DataSet> 
```

所以我将`<valid>`标签与`<constraint>`XML 中的标签交换。这似乎对 XSD 架构无效，并且无法再解析 XML。

```
<bean class="DataSet"
    ignore-annotations="true">
    <field name="dataCollection">
        <constraint annotation="ValidData"/>
        <valid/>
    </field>
</bean>

Exception in thread "main" javax.validation.ValidationException: Error parsing mapping file. 
```

有谁知道我如何使用 XML 通过必须自定义验证器来验证这个集合？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:47:38.353

关键是将 XML 中的类级约束注释添加到 Data POJO 本身。

```
<bean class="DataSet"
    ignore-annotations="true">
    <field name="dataCollection">
        <valid/>
    </field>
</bean>

<bean class="Data" ignore-annotations="true">
     <class>
          <constraint annotation="ValidData"/>
     </class>
</bean> 
```

# windows-xp - 任务计划程序未在 windows xp 中运行

> ID：10689293
> 
> 赞同：1
> 
> 时间：2012-05-21T16:51:12.143
> 
> 标签：windows-xp, scheduled-tasks

我一直在研究一个系统，其中任务调度程序用于每晚运行几个应用程序。最近我注意到我安排的任务没有运行，它给出了以下错误消息

```
the scheduled task did not run because an incorrect password or user name was entered 
```

最近我更改了系统密码。这是任务调度程序失败的原因吗？我也应该更改任务计划程序中的密码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:54:14.467

是的，您应该更改任务计划程序中的密码以匹配它正在执行代码的帐户的密码。

如果它可以使用权限较低的帐户运行，我将借此机会创建一个具有完成其工作所需的最低权限的帐户，并设置任务计划程序以使用该受限帐户。

# ios - 通过 addObserver:selector:name:object 调用的多个块操作：

> ID：10689295
> 
> 赞同：1
> 
> 时间：2012-05-21T16:51:30.050
> 
> 标签：ios, nsoperationqueue, nsnotificationcenter

我有一个应用程序，其中用户操作尝试连接到在线资源。连接过程由第三方SDK 完成，成功或失败异步反馈。这由我配置为以任何一种方式发布通知的 appDelegate 处理。（即 Dropbox 风格）。

下面，假设失败，***UIAlertView***被调用的次数与执行操作的次数一样多。也就是如果我反复测试连接失败了，第一次block被调用一次，第二次block被调用两次，第3次被调用3次等等。就好像block操作没有被取消一样或从队列中删除。

```
if (!opQ) {
    opQ = [[NSOperationQueue alloc] init];
}

[[NSNotificationCenter defaultCenter] addObserverForName:LINK_NOTIFICATION_FAILURE object:nil queue:opQ usingBlock:^(NSNotification *aNotification) {

    dispatch_async(dispatch_get_main_queue(),
     ^{
        [[[UIAlertView alloc] initWithTitle:@"Network_Account_Not_Linked" message:@"Your_attempt_to_link_your_account_ended_unsuccessfully" 
          delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil] show];

        [[NSNotificationCenter defaultCenter] removeObserver:self];

     });

}]; 
```

问题似乎与***addObserverForName:object:queue:usingBlock: 有关***。我使用***addObserver:selector:name:object:***进行了测试，效果很好（每个通知执行一个选择器）。使用块更方便，使代码更具可读性并允许访问局部变量，这就是我的动机。

我在 NSBlockOperation 线程和 dispatch_async 中尝试了***[opQ cancelAllOperations] （根据调试器，此时******opQ***是“超出范围”）。此外，使用***[NSOperationQueue mainQueue]***并获得类似的失败结果。此外，我还尝试在注册通知之前从一个新的 opQ 开始...... nada。

为什么会发生多个呼叫？有没有更好的使用块的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:01:04.497

您使用的方法的 Apple 文档说：

> 要取消注册观察，请将此方法返回的对象传递给 removeObserver:。在释放 addObserverForName:object:queue:usingBlock: 指定的任何对象之前，您必须调用 removeObserver: 或 removeObserver:name:object:。

换句话说，您不能`self`在移除观察者时简单地通过。

尝试：

```
__block id observer = [[NSNotificationCenter defaultCenter] addObserverForName:LINK_NOTIFICATION_FAILURE object:nil queue:opQ usingBlock:^(NSNotification *aNotification) {

dispatch_async(dispatch_get_main_queue(),
 ^{
    [[[UIAlertView alloc] initWithTitle:@"Network_Account_Not_Linked" message:@"Your_attempt_to_link_your_account_ended_unsuccessfully" 
      delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil] show];

    [[NSNotificationCenter defaultCenter] removeObserver:observer];

 });
}]; 
```

# javascript - addClass/removeClass 不适用

> ID：10689300
> 
> 赞同：0
> 
> 时间：2012-05-21T16:51:36.473
> 
> 标签：javascript, jquery, jquery-ui

我尝试将 addClass 和 removeClass 应用于我的表中的一行，并且由于某种原因未应用 addClass 和 removeClass 样式。由于他们没有工作，我尝试使用 css，但这使我的代码更加冗余，将相同的样式应用于某些字段。任何帮助，将不胜感激。谢谢

来自萤火虫

```
<tr style="color: red; font-weight: bold; background: none repeat scroll 0% 0% rgb(255, 255, 255); cursor: pointer;" class="state-selected"><td style="padding:2.5px 0px 2.5px 2px;">Equipment</td></tr>

.state-selected {
    } 
```

我已经在我的 jsp 页面顶部定义了样式

```
<style type="text/css">
.state-selected {
    color: 'red';
    font-weight: 'bold';
}
 </style>    
$("#index tr:gt(0)").hover(

    function () {
        $(this).css({
            'background': '#e9e7e7',
            'cursor': 'pointer'
        });
    }, function () {
        $(this).css({
            'background': '#ffffff',
            'cursor': 'pointer'
        });
    }).click(function (e) {
        $("#index tr").removeClass('state-selected');
        $(this).addClass('state-selected');

    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:56:08.010

使用该`css()`调用，您正在创建内联样式。这些总是覆盖那些在样式表中定义的（除了使用时`!important`，但最好避免）。

关键是，如果您使用`css()`类名，则如果它们定义了相同的属性，则它们将不适用。首先删除您添加的 CSS 样式 ( `{'color':'', 'font-weight':''}`)，然后类名应该就位。

# wcf - WCF OperationContract 在 IE (7-9) 中为 304，但不是 Firefox 或 Chrome

> ID：10689303
> 
> 赞同：2
> 
> 时间：2012-05-21T16:51:40.470
> 
> 标签：wcf, internet-explorer, iis, iis-6, browser-cache

我有一个运行 .net 4.0 的 IIS 6 服务器，它为 IE 返回 304（未修改），但不是 Firefox 或 Chrome。我从不希望保存 .svc 文件中的这个和其他调用缓存，但始终是 200 和新数据。我没有在运行 IIS7.5 的 Win7 上的 localhost 上看到这个。响应标头具有 Cache-Content: private 并且在 IIS 6 下运行时，Fiddler 甚至不显示请求。

```
[OperationContract]
[WebGet(UriTemplate = "usertoken/populate")]
public ClientUserToken PopulateUserToken()
{
  return HttpContext.Current.Session["userToken"] as UserToken;
} 
```

我可以为每个方法添加一个 [AspNetCacheProfile("NoCachingProfile")] 并且

```
<outputCacheSettings>
    <outputCacheProfiles>
        <add name="NoCachingProfile" noStore="true" duration="0" varyByParam="none" enabled="false"/>
    </outputCacheProfiles>
</outputCacheSettings> 
```

到 web.config，但我想避免将其添加到每个操作中。是否有 IIS 设置来执行此操作，还是应该由代码驱动？为什么它只发生在 IE 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:34:02.660

这不是服务的问题，是 IE 的问题。Fiddler 没有显示任何内容，因为浏览器没有发送任何内容，它正在使用最后一个缓存的响应。如果可以，请使用 Post，否则会使每个 Get 请求看起来不同： `url: "usertoken/populate?" + new Date().getTime()` Older IE is bad with ignoring no-cache with Gets

# r - 比较一个字符串与一组字符串的相等性

> ID：10689307
> 
> 赞同：0
> 
> 时间：2012-05-21T16:52:08.383
> 
> 标签：r, dataframe

我习惯在 SQL 中枚举字符串的可能性。

像这样的东西：

```
select * from  s1b where Phases in ('Phase 2', 'Phase 3','Phase 4', 'Phase 2|Phase 3') 
```

我不能使用 sqldf，因为我的 data.frame 有 posix 日期，这些日期会被损坏。所以我必须使用原生 R 方法。

如何在没有像这样复杂的 OR 代码的情况下将 data.frame 列与一组多个字符串进行比较

```
s1btest<-subset(s1b,s1b$Phases=='Phase 2'|s1b$Phases=='Phase 3'| more conditions here) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T16:57:56.043

使用`%in%`运算符。

```
subset(s1b, Phases %in% c("Phase 2", "Phase 3")) 
```

# linux - 映射到虚拟地址空间的内核符号表 - 为什么？

> ID：10689310
> 
> 赞同：6
> 
> 时间：2012-05-21T16:52:30.757
> 
> 标签：linux, unix

什么是/proc/ksyms 和/proc/kallsyms，为什么映射到进​​程地址空间？它的用途是什么？它在系统调用期间用于内核的上下文切换吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T18:13:37.747

Solaris 联机帮助页[`ksyms(7d)`](http://docs.oracle.com/cd/E19082-01/819-2254/6n4iaov2b/index.html)对此进行了解释。数据仅供参考，内核通过`/dev/ksyms`.

Linux 通过`/proc/kallsyms`; `/proc/ksyms`- 如果存在 - 是“传统”文件，表示相同数据的子集（即已弃用）。

与 Linux/Solaris 一样，不同之处在于 Linux 版本呈现文本，而 Solaris 版本是二进制的。您可以`nm /dev/ksyms`在 Solaris 上运行以获得与`cat /proc/kallsyms`Linux 上相同类型的输出。

# objective-c - iOS：不明确的属性合成行为。继承相关

> ID：10689313
> 
> 赞同：3
> 
> 时间：2012-05-21T16:52:37.667
> 
> 标签：objective-c, ios

我正在使用`AppCode`它，它在一个非常大的项目的代码中标记了一个有趣的情况。弧前。

一个子类定义并综合了一个称为委托的属性。实际上属性声明已经被注释掉了！但该`@synthesize delegate = delegate_;`声明被抛在了脑后。

代码可以编译，大概是因为基类定义并合成了一个也称为委托的属性，并将其与同名的支持变量合成：`@synthesize delegate = delegate_;`

我的问题是：消息会发生什么被发送给代表

a) 基类方法和

b) 在子类方法中。

`AppCode`将子类中的综合语句标记为错误：

> 属性“delegate”的访问器已经与实例变量“delegate_”合成

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T18:36:17.820

该`@synthesize`指令是根据同名属性的规范（原子性、内存管理）创建访问器方法和 ivar 的简写。鉴于此，重新合成子类中的属性（无需重新声明）的工作方式与覆盖访问器方法完全相同——使用子类的实现而不是超类的实现。由于这两种情况下的实现都是由编译器创建的，因此在行为上没有明显差异。

一个区别是合成 ivar 与 ivar 具有相同的可见性`@private`，因此子类无法访问它，包括将其用作属性的支持变量。这意味着子类中的重新合成必须使用不同的 ivar 名称。如果超类有`@synthesize wildHorses = wildHorses_;`，则编译器要求子类执行类似`@synthesize wildHorses = equusFerus;`.*的操作

* * *

*如果超类使用创建的 ivar 的默认名称，`@synthesize wildHorses;`那么子类仍然必须合成一个新变量：`@synthesize wildHorses = wildHorses_;`

# django - Django：如何创建有序的兄弟姐妹

> ID：10689317
> 
> 赞同：3
> 
> 时间：2012-05-21T16:52:51.597
> 
> 标签：django, django-models, django-admin

我想创建一个模型，以适当的方式对其子模型进行排序。例如，一本书有很多章节，但章节必须按特定顺序排列。

我假设我需要在指定章节顺序的章节模型上放置一个 IntegerField，如下面的问题所示：[Ordered lists in django](https://stackoverflow.com/questions/428149/ordered-lists-in-django)

我的主要问题是，每当我想在两个现有章节之间插入新章节或以任何方式重新排序它们时，我都必须更新（几乎）书中的每一章。有没有办法（也许在我正在使用的 Django Admin 中）避免在我更改顺序时手动更改每个章节的每个索引？

正如上面链接的问题中提出的那样，我不是创建“链接列表”样式模型的忠实粉丝，因为我认为这不是创建数据库的好习惯。

建模这种关系的“正确”方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:03:04.140

使用浮点数而不是整数来避免在两个项目之间插入时更新多个项目的问题。

所以如果你想在项目 42 和项目 43 之间插入一个项目，你可以给它一个介于两者之间的 order 值（42.5），你不必更新任何其他项目。

在 x 和 y 之间插入 z... z.order = (y.order - x.order) / 2 + x.order

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T20:45:25.077

您提到的答案可能是有效处理此问题的最佳方法。可能需要原始 SQL 语句`UPDATE Chapter SET order = order + 1 WHERE book_id = <id_for_book> AND order <= <insert_index_location>`。**对于 Django 1.1+**：您可以使用`F()`如下方式在一行中编写它，但它可能仍然是使用事务的引擎盖下的 O(n) 查询。

```
Book.objects.get(id=<id_of_book>).chapter_set.filter(order__gt=<place_to_insert>).update(order=F('order')+1) 
```

# iphone - 归档错误

> ID：10689319
> 
> 赞同：2
> 
> 时间：2012-05-21T16:53:07.747
> 
> 标签：iphone, ios, xcode, archive

我没有使用 xcode 的经验，我正在尝试发布我的第一个应用程序。我创建了应用程序 ID 和分发配置文件，并将捆绑标识符设置为与分发配置文件相同。我还将代码签名标识更改为 iPhone 分发，但是当我单击存档或运行它时说“构建失败”，这是错误：

```
arm-apple-darwin10-llvm-gcc-4.2: /Users/myname/Desktop/iLibe/iOrario liceo bellinzonaBLACK/iLiBe: No such file or directory
arm-apple-darwin10-llvm-gcc-4.2: warning: '-x objective-c-header' after last input file has no effect
arm-apple-darwin10-llvm-gcc-4.2: no input files
 Command/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/llvm-gcc-4.2 failed with exit code 1 
```

有关如何解决此问题的任何建议？

# wpf - 找不到类型 imageconverter

> ID：10689320
> 
> 赞同：0
> 
> 时间：2012-05-21T16:53:08.913
> 
> 标签：wpf, xaml

我正在尝试为我的图像源绑定应用转换器。这是我的xml：

```
<Window.Resources>
        <DataTemplate x:Key="listBoxTemplate">
            <StackPanel Orientation="Horizontal">
                <StackPanel.Resources>
                    <ImageConverter x:Key="MyImageConverter" />
                </StackPanel.Resources>
                <Image Source="{Binding Path=thumb, StringFormat=/WpfTest;component/Images/{0}, Converter={StaticResource MyImageConverter}}" Height="100" Width="130" Margin="5"></Image>
                <StackPanel Orientation="Vertical" Width="247">
                    <TextBlock Text="{Binding recipeName}" Height="60" Padding="15" FontSize="16" HorizontalAlignment="Stretch" VerticalAlignment="Center"></TextBlock>
                    <TextBlock Text="{Binding cuisine}" Height="60" Padding="15" FontSize="16" HorizontalAlignment="Stretch" VerticalAlignment="Center"></TextBlock>
                </StackPanel>
            </StackPanel>
        </DataTemplate>
    </Window.Resources> 
```

这是我的 imageConverter 类：

```
using System;
using System.Windows.Data;
using System.Globalization;
using System.Windows.Media.Imaging;

public class ImageConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        string path = (string)value;

        try
        {
            //ABSOLUTE
            if (path.Length > 0 && path[0] == System.IO.Path.DirectorySeparatorChar
                || path.Length > 1 && path[1] == System.IO.Path.VolumeSeparatorChar)
                return new BitmapImage(new Uri(path));

            //RELATIVE
            return new BitmapImage(new Uri(System.IO.Directory.GetCurrentDirectory() + System.IO.Path.DirectorySeparatorChar + path));
        }
        catch (Exception)
        {
            return new BitmapImage();
        }

    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

但是当我尝试运行应用程序时，它返回“找不到类型 imageconverter”并且 VS 突出显示该部分

```
<ImageConverter x:Key="MyImageConverter" /> 
```

在上面的 xaml 中。我如何解决它？（顺便说一句，我从[Wpf 获得了 imageconverter 代码 - 相对图像源路径](https://stackoverflow.com/questions/1444699/wpf-relative-image-source-path)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:01:04.903

您需要像这样添加它的命名空间：

```
<ns:ImageConverter x:Key="MyImageConverter"/> 
```

并确保您像这样添加了更高的命名空间：

```
<DataTemplate xmlns:ns="...."> 
```

实际的命名空间取决于您的项目，但代码完成将对您有所帮助。

# java - Java将输出行替换为标准输出

> ID：10689323
> 
> 赞同：0
> 
> 时间：2012-05-21T16:53:21.937
> 
> 标签：java, command-line

> **可能重复：**
> [使用 java 写入控制台窗口中的相同位置](https://stackoverflow.com/questions/5859588/write-to-same-location-in-a-console-window-with-java)

我想知道在java中是否有一种方法可以替换您输出到终端的一行输出，这样您就可以像进度条/计数器类型的东西一样做。

我想做一些类似于打印出“插入的记录 1/1000”，然后在顶部打印“插入的记录 2/1000”，将其替换为仅显示最近的一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T16:56:52.097

打印 \r 字符，它将光标放在行首。然后写新行。

```
public static void main(String[] args) throws InterruptedException {

    System.out.print("test");

    Thread.sleep(3000);

    System.out.print('\r');

    System.out.print("lulz");

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:58:31.600

只需重新连接 System.out 管道以通过您自己的过滤器。例如`System.setOut(new MyStream(System.out));`

[https://docs.oracle.com/javase/8/docs/api/java/lang/System.html#setOut-java.io.PrintStream-](https://docs.oracle.com/javase/8/docs/api/java/lang/System.html#setOut-java.io.PrintStream-)

然后你需要实现`MyStream`：

```
public class MyStream extends PrintStream {
    private PrintStream standardOut;

    public MyStream(PrintStream standardOut) {
        this.standardOut = standardOut;
    }

    ... Then here override the appropriate methods (e.g. `println()`, etc...) to correct the output and send it to `standardOut`.
} 
```

# java - 从 java ProcessBuilder API 调用 perl WWW::Google::PageRank

> ID：10689324
> 
> 赞同：0
> 
> 时间：2012-05-21T16:53:33.250
> 
> 标签：java, perl, pagerank

我需要能够以编程方式从 java 中找到网站的 PageRank。我无法让我在 java 中找到的任何东西工作，但是这个 perl 模块看起来很有希望。这是 perl [http://metacpan.org/pod/WWW::Google::PageRank的一些文档](http://metacpan.org/pod/WWW%3a%3aGoogle%3a%3aPageRank)

我对 Perl 的唯一经验是以前从 java 调用过 perl 脚本......

我编写了这个脚本并将其放在我的 java 项目的资源文件夹中。

```
#file: pr.pl
use WWW::Google::PageRank
$loc=<>;
$gpr=WWW::Google::PageRank->new();
print $gpr->get($loc); 
```

当我在调用脚本后在命令行中键入[http://www.google.com](http://www.google.com)时，我收到了这条消息：HHTP::Response=HASH(0x1d41554)

谁能告诉我发生了什么事？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:59:16.980

在[文档](http://search.cpan.org/~ykar/WWW-Google-PageRank-0.17/lib/WWW/Google/PageRank.pm)中，他们以这种方式打印页面排名。

```
print scalar($gpr->get($loc)), "\n"; 
```

# ruby - 我可以使用元编程来动态初始化一个类吗？

> ID：10689326
> 
> 赞同：1
> 
> 时间：2012-05-21T16:53:45.373
> 
> 标签：ruby, metaprogramming

我有一个脚本可以创建这样的表：

```
class TableClass < Table  
    members :hello, :hallo, :halo  
end 
```

此脚本创建一个表，其中包含标记为“hello”、“hallo”和“halo”的列。我想动态声明“成员”部分，以便我可以使用不同脚本生成的结果来初始化此表。我对 Ruby 很陌生，对元编程的概念也很陌生，但我觉得这一定是可行的，我只是不知道怎么做。

声明后：

```
ListOfMembers= [:hello, :hallo, :halo] 
```

我试过了：

```
members ::ListOfMembers 
```

和

```
members eval ::ListOfMembers.join(",") 
```

无济于事，我不确定要搜索什么来解决这个问题。我发现的所有元编程示例都围绕类方法，似乎与这个问题无关。

废弃这个类结构可能是最好的方法，但我正在尽我所能使用现有的脚本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T16:56:00.393

只需添加`*`到数组名称中，该方法就会将每个元素作为单独的参数传递。

```
members *ListOfMembers 
```

# google-maps - 使用某些航点时，谷歌方向不会返回任何路线

> ID：10689328
> 
> 赞同：3
> 
> 时间：2012-05-21T16:53:56.417
> 
> 标签：google-maps, google-maps-api-3, google-directions-api

我正在使用谷歌方向来获取带有航点的路线。我有上一次调用 Places Api 的航路点名称。问题是，如果我打这个电话：

[https://maps.googleapis.com/maps/api/directions/json?origin=46.779704,23.577261&destination=46.564423,23.768673&waypoints=optimize:true|Belvedere,RO|Cheile+Turzii,RO&units=metric&sensor=false](https://maps.googleapis.com/maps/api/directions/json?origin=46.779704,23.577261&destination=46.564423,23.768673&waypoints=optimize:true|Belvedere,RO|Cheile+Turzii,RO&units=metric&sensor=false)

它返回一条路线。但是，如果将 Cluj-Napoca 国家剧院添加到航路点并且调用如下所示：

[https://maps.googleapis.com/maps/api/directions/json?origin=46.779704,23.577261&destination=46.564423,23.768673&waypoints=optimize:true|Belvedere,RO|Cheile+Turzii,RO|Cluj-Napoca+National+剧院，RO&units=metric&sensor=false](https://maps.googleapis.com/maps/api/directions/json?origin=46.779704,23.577261&destination=46.564423,23.768673&waypoints=optimize:true|Belvedere,RO|Cheile+Turzii,RO|Cluj-Napoca+National+Theatre,RO&units=metric&sensor=false)

它不起作用。响应没有结果。`{ "routes" : [], "status" : "ZERO_RESULTS" }`

谁能帮我理解为什么这不起作用？Ps：使用 Cluj-Napoca+International+Airport，RO 代替 Cluj-Napoca+National+Theatre，RO 航路点可以工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T17:50:31.007

您可以尝试添加航点的坐标，而不是添加它们的名称。

# ios - 如何使用 NSXMLParser 读取 URL（带有特殊字符）？

> ID：10689336
> 
> 赞同：1
> 
> 时间：2012-05-21T16:54:30.023
> 
> 标签：ios, url, nsxmlparser, encode

我下载了一个包含多个 URL 的 XML 文件。它工作正常，但是当我在 XML 中输入这样的 URL 时：

[http://eda-bea.es/pub/record_card_1.php?refpage=%252Fpub%252Fsearch_select.php&quicksearch=adra&page=1&rec=3](http://eda-bea.es/pub/record_card_1.php?refpage=%252Fpub%252Fsearch_select.php&quicksearch=adra&page=1&rec=3)

解析器停止。

据我了解，该 URL 包含特殊字符，我已寻求并提供以下代码作为可能的解决方案，其中信息在解析之前被编码为 UTF8：

```
NSString *dataString = [[NSString alloc] initWithContentsOfURL:URL encoding:NSUTF8StringEncoding error:error];
NSData *data = [dataString dataUsingEncoding:NSUTF8StringEncoding];

NSXMLParser *parser = [[NSXMLParser alloc] initWithData:data];
[parser setDelegate:self];

[parser parse]; 
```

这没用。在这个方法中停止解析

```
-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName 
                                 namespaceURI:(NSString *)namespaceURI 
                                qualifiedName:(NSString *)qName 
                                   attributes:(NSDictionary *)attributeDict 
```

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T09:42:35.560

解决方案是使用该领域

```
<![CDATA[http://eda-bea.es/pub/record_card_1.php?refpage=%252Fpub%252Fsearch_select.php&quicksearch=adra&page=1&rec=3]]> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:58:53.987

**改变答案**

此链接[http://eda-bea.es/pub/record_card_1.php?refpage=%252Fpub%252Fsearch_select.php&quicksearch=adra&page=1&rec=3](http://eda-bea.es/pub/record_card_1.php?refpage=%252Fpub%252Fsearch_select.php&quicksearch=adra&page=1&rec=3)不是 XML 文档，而是 HTML 文档。

解析器将失败，`<link rel="stylesheet" type="text/css" href="images.php/hispep.css">`因为这里没有结束链接标记。

# c# - 如何访问我的 LINQ 模型中的特定行？

> ID：10689338
> 
> 赞同：2
> 
> 时间：2012-05-21T16:54:32.220
> 
> 标签：c#, asp.net-mvc, linq

我目前有一个 linq 查询来从我的产品表中选择 5 个随机行。一旦我的模型中有集合，我如何访问特定行？我正在使用 First() 来获取我的第一行，但我不确定如果我想从该查询的第三行获取数据我会使用什么。

谢谢！

```
var Model = (from r in DB.Products select r).OrderBy(r => Guid.NewGuid()).Take(5);

var ProductID1 = Model.First().ProductID;
var ProductID3 = Model.??? 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T16:58:58.993

您应该只运行一次查询，然后使用 foreach 遍历行，或者只使用 index 属性来选择合适的产品

```
var Model = (from r in DB.Products select r).OrderBy(r => Guid.NewGuid()).Take(5).ToList();

var ProductID1 = Model[0].ProductID;
var ProductID2 = Model[1].ProductID; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T16:56:41.220

```
var Model = (from r in DB.Products select r)
             .OrderBy(r => Guid.NewGuid())
             .Take(5).ToArray(); 

var ProductID1 = Model.First().ProductID;
var ProductID3 = Model.Skip(2).First() <-- 3rd row 
```

根据 Douglas 的评论，我将 ToArray() 添加到初始查询中。否则，每次您拉出任何东西时，查询都会重新运行（因为 linq 的 .Take(n) 被延迟）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T16:55:36.230

您可以简单地遍历您的结果集合，并获取您想要的第 n 个索引。

```
Product product = null;
int index = 0;

foreach (Product p in DB.Products)
{
    if (index == 3)
    {
        product = p;
        break;
    }

    index++;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T17:00:02.827

如果将查询处理为 List，则可以通过索引直接访问每个元素：

```
var Model = (from r in DB.Products select r)
    .OrderBy(r => Guid.NewGuid())
    .Take(5)
    .ToList(); //Process into a list

var ProductID1 = Model[0].ProductID;
var ProductID3 = Model[3].ProductID;
...
var ProductID100 = Model[100].ProductID; 
```

# android - 多个列表视图？

> ID：10689339
> 
> 赞同：0
> 
> 时间：2012-05-21T16:54:33.373
> 
> 标签：android, sql, sqlite, android-listview

我正在尝试显示我正在创建的游戏的高分，有两列，一列是他们的名字，另一列是他们完成游戏所花费的移动量。

目前，它全部存储在 SQLiteDatabase 中并以列表视图的形式呈现，其中它以格式的一列显示

名字，动作

但是我想在屏幕的对面进行移动，这需要多个列表视图还是需要编辑一个列表视图或其适配器？

目前使用的代码是：

```
 datasource = new HighScoreDataSource(this);
    datasource.open(); //Open the connection

    List<HighScore> values = datasource.getAllHighScores(); //Retrieve all the data

    //Using a simple cursor adapted to show the elements
    ArrayAdapter<HighScore> adapter = new ArrayAdapter<HighScore>(this, android.R.layout.simple_list_item_1, values);
    setListAdapter(adapter); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:11:16.363

`TextViews`以您想要的方式制作两个放置的行布局并实现一个简单的自定义`ArrayAdapter`：

```
public class CustomAdapter extends ArrayAdapter<HighScore> {

    private LayoutInflater inflater;

    public CustomAdapter(Context context, int textViewResourceId,
            List<HighScore> objects) {
        super(context, textViewResourceId, objects);
        inflater = LayoutInflater.from(context);
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        if (convertView == null) {
            convertView = inflater.inflate(R.layout.new_row_layout, parent, false);
        }
        HighScore item = getItem(position); 
        TextView name = (TextView) findViewById(R.id.name_id_textview);
        name.setText(/*get the name from the item HighScore object*/);
        TextView moves = (TextView) findViewById(R.id.moves_id_textview);
        moves.setText(/*get the moves from the item HighScore object*/);
        return convertView;
    }       

} 
```

另一种选择是将您`List<HighScore> values`的列表分解为`HashMaps`（包含两个条目，一个用于名称，一个用于移动）并使用 a [`SimpleAdapter`](http://developer.android.com/reference/android/widget/SimpleAdapter.html)（使用上面的行布局）。

# php - 在 LoggerRoot.php 中找不到类“记录器”

> ID：10689340
> 
> 赞同：0
> 
> 时间：2012-05-21T16:54:40.517
> 
> 标签：php, log4php

我正在尝试在一个非常简单的站点中安装 log4php（试图了解它是如何工作的）。Apache 安装在 /etc/ 中，vhost 定义为：

DocumentRoot "/home/fferri/workspace/site-tutorial/www" ServerName tutorial.localhost php_value auto_prepend_file "/home/fferri/workspace/site-tutorial/www/ConfigureSite.php" 我的站点在 /home/fferri/workspace/ site-tutorial/www/ 和 log4php 文件夹位于 /home/fferri/workspace/site-tutorial/services/lib/log4php-0.9/src/log4php/

然后，我定义

```
define('LOG4PHP_DIR', "/home/fferri/workspace/site-tutorial/services/lib/log4php-0.9/src/log4php/"); 
```

进入 ConfigureSite.php

并且，在另一个文件中，我尝试初始化 log4php：

```
include(LOG4PHP_DIR."/Logger.php");
$log = Logger::getLogger("main");
$log->info("foo");
$log->warn("bar"); 
```

错误总是一样的：

```
Fatal error: Class 'Logger' not found in /home/fferri/workspace/site-tutorial/services/lib/log4php-0.9/src/log4php/LoggerRoot.php on line 37 
```

值得一提的是，LoggerRoot.php 和 Logger.php 在同一个文件夹中。我认为我的路径有问题，因为我的服务器和我的站点不在同一个文件夹中，但我需要一些提示

添加完整的错误堆栈跟踪：

```
 [22-May-2012 11:34:38] PHP Fatal error:  Class 'Logger' not found in /home/fferri/workspace/site-tutorial/services/lib/log4php-0.9/src/log4php/LoggerRoot.php on line 36
[22-May-2012 11:34:38] PHP Stack trace:
[22-May-2012 11:34:38] PHP   1\. {main}() /home/fferri/workspace/site-tutorial/www/index.php:0
[22-May-2012 11:34:38] PHP   2\. require_once() /home/fferri/workspace/site-tutorial/www/index.php:12
[22-May-2012 11:34:38] PHP   3\. require_once() /home/fferri/workspace/site-tutorial/www/greet_at_opening.php:11
[22-May-2012 11:34:38] PHP   4\. require_once() /home/fferri/workspace/site-tutorial/services/lib/log4php-0.9/src/log4php/Logger.php:24
[22-May-2012 11:34:38] PHP   5\. require_once() /home/fferri/workspace/site-tutorial/services/lib/log4php-0.9/src/log4php/LoggerCategory.php:27
[22-May-2012 11:34:38] PHP   6\. require_once() /home/fferri/workspace/site-tutorial/services/lib/log4php-0.9/src/log4php/spi/LoggerLoggingEvent.php:28
[22-May-2012 11:34:38] PHP   7\. require_once() /home/fferri/workspace/site-tutorial/services/lib/log4php-0.9/src/log4php/LoggerManager.php:29
[22-May-2012 11:34:38] PHP   8\. require_once() /home/fferri/workspace/site-tutorial/services/lib/log4php-0.9/src/log4php/LoggerHierarchy.php:28 
```

因此，首先，找到了 Logger，但在加载 LoggerHierarchy 时，却没有找到 Logger。为什么？？？？

已解决：错误是同时使用 log4php-0.9 和 php5。下载位于apache web（2.1）中的库，问题就解决了。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T09:49:42.720

我认为使用 `dirname(__FILE__)`会更好看。

我还以为是路...

那么可能是类名定义。你`new Logger`在 Logger.php 中调用吗？

怎么样的东西：

```
include(LOG4PHP_DIR."/Logger.php");
$log = new Logger();
$log->info("foo"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T13:19:50.623

错误是同时使用log4php-0.9和php5。下载位于apache web（2.1）中的库，问题就解决了。

# eclipse - 在 Eclipse 的 JUnit 运行器中使用 JUnit @Rule

> ID：10689342
> 
> 赞同：3
> 
> 时间：2012-05-21T16:54:44.293
> 
> 标签：eclipse, junit, junit4, junit-runner

日食 3.7.2

我刚刚`@Rule`在一些 JUnit 4 测试中实现了一个，但是当我在 Eclipse 中运行它们时，这些`MethodRule`方法没有被调用。就像 Eclipse 测试运行器无法识别`@Rule`实现，并且没有对带有注释的字段执行任何特殊操作`@Rule`。

我什至尝试使用类似“标准”的 MethodRule，`org.junit.rules.TestName`但它不能正常工作（测试的名称没有填充到实例中）。在 Eclipse 中运行时，甚至 JavaDoc 中的示例测试也会`TestName`失败。

有什么诀窍吗？Eclipse 根本不支持 JUnit[规则](http://junit.org/node/580)吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T19:05:18.977

事实证明，有人在相关项目的运行时类路径中包含了一个看似“必需”的 JAR。该 JAR 嵌入了 JUnit 包，其中不应该嵌入其他内容！所以有这个 JAR，命名为类似这样的无害的东西`our_runtime_library.jar`，其中包含一些特定于应用程序的代码以及一些未知（但旧）版本的 JUnit、Spring 以及谁知道还有什么。在将项目作为单元测试运行时，Eclipse 在该 JAR 中选择 JUnit，而不是它自己的版本（应该是，项目特定的库总是优先），即构建项目的 (Eclipse) 版本。

真是一团糟; 现在开始弄清楚谁应该为此受到 50 次鞭打。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T03:57:58.883

它应该可以工作，至少在我的 Eclipse 中（在嵌入的 JUnit 4.8 中）。所以你可以显示你的代码。

另外，JavaDoc 说：`Note that MethodRule is now deprecated, you should be using TestRule instead.`

# facebook - 优雅地扩展 Facebook 服务器端访问令牌

> ID：10689347
> 
> 赞同：2
> 
> 时间：2012-05-21T16:55:11.350
> 
> 标签：facebook, access-token, extending

我有一个曾经使用offline_access 的应用程序，显然需要更改，因为它已经消失了。

当用户在没有我们后端的情况下通过任意数量的 API 进行交互时，我们使用此权限将消息发布到用户的 facebook 墙上。我们有一个网站，iPhone、Android、Blackberry 和诺基亚手机上连接到该应用程序的几个移动应用程序，以及一个与硬件设备交互的桌面应用程序，所有这些都可能导致后端尝试发布到 facebook，但只有网站允许用户使用 facebook 进行初始授权。

据我了解，使用服务器端身份验证会获得 60 天的令牌，而获取新令牌的唯一方法是重做身份验证过程，假设用户没有更改密码，登录到 facebook，并且没有-authorized 应用程序只会显示为一系列自动重定向。

有没有其他方法可以做到这一点？例如，fb_exchange_token 到底是做什么的？它适用于这种情况还是仅适用于通过 javascript API 接收的令牌？

除了合并本机 facebook API 并为网站做同样的事情之外，我们还能为这些非网站用户界面做些什么吗？

* * *

尝试使用 fb_extend_token 毫无结果。重新运行标准身份验证会返回相同的令牌，但有效期为 60 天。稍后再做一次并没有扩展令牌。我希望这意味着我每天只能这样做一次，而不是每个令牌一次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:12:57.087

由于我使用的是服务器端流程并且用户永远看不到密钥，因此我能够稍微修改我的应用程序以使用我的 APPLICATION 令牌。这些密钥属于您的应用程序，只要他们没有撤销其权限，您就可以代表用户使用 API。用户授权令牌可能会过期，但只要用户没有从他们允许的应用程序中明确删除您的应用程序，您的令牌将继续允许您使用 /user/ URL、/me 发布到墙上/ URL 将不起作用，因为您的令牌已绑定到您的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T18:10:02.217

我相信一旦offline_access 的弃用完成，获取/交换访问令牌是做你需要的唯一方法。

在弃用之前具有离线访问权限的任何人仍然可以正常使用您的应用程序，至少 60 天。这段时间结束后，您必须重新授权用户并将其访问令牌再延长 60 天。为此，您让他们登录并授权您的应用程序（如有必要）。然后您使用 fb_exchange_token 扩展他们的访问令牌，因此有效期为 60 天。

我相信你已经看过了，但是[这篇](http://developers.facebook.com/roadmap/offline-access-removal/)文章中已经列出了所有内容，更具体地说，是关于以前使用 offline_access 的部分。我还发现[这篇](http://developers.facebook.com/blog/post/2011/05/13/how-to--handle-expired-access-tokens/)文章对升级很有用。[这](http://developers.facebook.com/docs/authentication/access-token-expiration/)是另一个链接，进一步详细说明了如何处理无效令牌。

# php - 致命错误：在非对象上调用成员函数 prepare()

> ID：10689349
> 
> 赞同：2
> 
> 时间：2012-05-21T16:55:15.870
> 
> 标签：php, mysqli

这就是我必须将发射器信息构建到 php 文件以发送到登录页面的方式

```
<form action="http://,,,.dk/activate_updater.php" method="post" name="formular" onsubmit="return validerform ()">
                                 <table border="0">
                                     <tr>
                                         <td id="tb-w_a"><p>Kategori</p></td>
                                         <td>:</td>
                                         <td>
                                         <select name="kategori">
                                         <?php
                                         $query = "SELECT id_katogori, navn FROM kategori";
                                         $result = $mysqli->query($query);
                                         while(list($id_katogori, $navn) = $result->fetch_row())
                                         {
                                             echo "<option value=\"$id_katogori\">$navn</option>";  
                                         }
                                         ?>
                                         </select>
                                         </td>
                                     </tr>
                                     <tr>
                                         <td id="tb-w_a"><p>Djnavn</p></td>
                                         <td>:</td>
                                         <td><input type="text" name="djnavn"></td>
                                     </tr>
                                     <tr>
                                         <td id="tb-w_a"><p>Facebook</p></td>
                                         <td>:</td>
                                         <td><input type="text" name="facebook"></td>
                                     </tr>
                                     <tr>
                                         <td id="tb-w_a"><p>Pris</p></td>
                                         <td>:</td>
                                         <td><input type="text" name="pris"></td>
                                     </tr>
                                     <tr>
                                         <td id="tb-w_a"><p>Booking Email</p></td>
                                         <td>:</td>
                                         <td><input type="email" name="booking"></td>
                                     </tr>
                                     <tr>
                                         <td id="tb-w_a"><p>Mobil</p></td>
                                         <td>:</td>
                                         <td><input type="text" name="mobil"></td>
                                     </tr>
                                     <tr>
                                         <td id="tb-w_a"><p>Upload Profil</p></td>
                                         <td>:</td>
                                         <td><input type="file" name="profilbillede" /></td>
                                     </tr>
                                 </table>
                             <textarea name="profiltekst" style="width:500px; height:170px;"></textarea><br />
                             <input type="submit" value="Godkend brugere" name="godkendt-brugere">
                         </form> 
```

所以新的页面文件是这样的，页面上有**错误**..

```
<?php
     if($stmt = $mysqli->prepare('UPDATE `brugere` SET `rank`=2, `katogori`=?, `djnavn`=?, `profilbillede`=?, `profiltekst`=?, `facebook`=?, `pris`=?, `booking`=?, `mobil`=? WHERE `code`=?'))
     {

         $stmt->bind_param('iiiiiiiis', $katogori, $djnavn, $profilbillede, $profiltekst, $facebook, $pris, $booking, $mobil, $g_code);
         //fra input ting ting..
         $katogori = $_POST["kategori"];
         $djnavn = $_POST["djnavn"];
         $profilbillede = $_POST["profilbillede"];
         $profiltekst = $_POST["profiltekst"];
         $facebook = $_POST["facebook"];
         $pris = $_POST["pris"];
         $booking = $_POST["booking"];
         $mobil = $_POST["mobil"];
         $g_code = $_GET["code"];

         $stmt->execute();
         $stmt->close();
         header('http://....dk/ (...));
     }
     else
     {
         echo 'Der opstod en fejl i erklÃ¦ringen: ' . $mysqli->error;
     }
 ?> 
```

但是当它进入文件/页面时会这样说......

**致命错误：在第 2 行的 /home/jesperbo/public_html/..dk/activate_updater.php 中的非对象上调用成员函数 prepare()**

就是这样说的

```
if($stmt = $mysqli->prepare('UPDATE `brugere` SET `rank`=2, `katogori`=?, `djnavn`=?, `profilbillede`=?, `profiltekst`=?, `facebook`=?, `pris`=?, `booking`=?, `mobil`=? WHERE `code`=?')) 
```

*我不是最能看到错误的人，但如果你看到我不必要的错误，那就太好了，因为它不会出现在数据库中*

**希望你能帮我解决这个问题！**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T16:58:45.387

据我所知，您从未真正创建过您的`$mysqli`对象（除非它被加载到另一个文件中，其中包括这个文件）。您需要[创建它](http://www.php.net/manual/en/mysqli.construct.php)：

```
$mysqli = new MySQLi('localhost', 'username', 'password', 'dbname');

// then
if($stmt = $mysqli->prepare('UPDATE `brugere` SET `rank`=2, `katogori`=?, `djnavn`=?, `profilbillede`=?, `profiltekst`=?, `facebook`=?, `pris`=?, `booking`=?, `mobil`=? WHERE `code`=?')) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T17:01:18.087

**发生这种情况是因为`$mysqli`不是您认为的对象。**要么你没有`MySQLi`正确地实例化这个类，要么它没有建立连接。执行 a`var_dump($mysqli)`以获取有关问题所在的更多信息。

# sas - 具有不同阴影的 sas 概率密度图

> ID：10689350
> 
> 赞同：0
> 
> 时间：2012-05-21T16:55:17.463
> 
> 标签：sas, scatter, uncertainty

我有及时的事件数据。目前它们由（黑色）标记表示，在 x 轴为时间的散点图上 y = 1。不幸的是，大约 2 小时的 x 存在不确定性。所以我想把我的黑色标记变成更像灰色香肠的形状——在这 2 小时内，每个时间点发生事件的概率相同，并且阴影不是黑色的，这样当所有事件都被绘制出来时，我可以看到密度在不同时间点的增加。

知道如何随着时间的推移将我的精确标记模糊成不同阴影的均匀概率香肠吗？

非常感谢，如果这个问题没有明确说明，请告诉我。

# regex - 使用内部文件中的字符串重命名文件的 Shell 脚本

> ID：10689357
> 
> 赞同：4
> 
> 时间：2012-05-21T16:55:52.500
> 
> 标签：regex, bash, file-rename

我一直在论坛和stackoverflow上搜索这个；它一定在某个地方，但我找不到。
我在 Mac 上，使用终端运行 shell 脚本以根据文件内容重命名一些 pdf 文件。

我有一个完整的 pdf 目录，我使用开源 pdfbox 将其导出到文本文件。生成的文件与 pdf 文件同名，但以`.txt`. 我创建了文本文件，以便可以在文件中找到格式为的字符串`Page xx Question xx`；例如`Page 43 Question 2`。鉴于此示例，我想将 pdf 文件重命名为`pg43_q2.pdf`

我认为我想要的正则表达式是这样的： `/Page\s+(\d+)Question\s+(\d+)` 但我不确定如何读取两个捕获的数字并将它们保存到可以用作文件名的字符串中。

我到目前为止的脚本是：

```
#!/bin/sh
PDF_FILE_PATH=$1
echo "Converting pdfs at $PDF_FILE_PATH"

find "$PDF_FILE_PATH" -name '*.pdf' -print0 | while IFS= read -r -d '' filename; do
   echo $filename
   java -jar pdfbox-app-1.6.0.jar ExtractText "$filename" "$filename.txt"
   NEWNAME=$(sed -n -e '/Page/s/Page\s+\(\d+\)\s+Question\s+\(\d+\).*$/pg\1_q\2/p' "$filename.txt")
   echo "Renaming pdf $filename to $NEWNAME"
   # I would do this next but the $NEWNAME is empty
   # mv "filename" "PDF_FILE_PATH$NEWNAME"
done 
```

...但是 sed 命令没有将任何内容放入 NEWNAME 变量中。

我不是特别喜欢 sed，任何建议都将不胜感激

对脚本的最新编辑使用以下 sed 命令：

```
newname=$(sed -nE -e '/Page/s/^.*Page[[:blank:]]+([0-9]+)[[:blank:]]+Question[[:blank:]]+([0-9]+).*$/pg\1_q\2.pdf/p' "$filename.txt") 
```

这在大约 50% 的情况下有效，但其余时间在我重命名文件时 newname 变量为空。

转换文件的第三行有效：

```
Unit 2 Review Page 257 Question 9  a)  12 (2)(2)(3) 
```

转换后的文件的第三行不起作用：

```
Unit 2 Review Page 258 Question 16  a)  (a – 4)(a + 7) = a(a + 7) – 4(a + 7)                             = a2 + 7a – 4a – 28                              = a2 + 3a – 28   b)  (2x + 3)(5x + 2) = 2x(5x + 2) + 3(5x + 2)                                 = 10x2 + 4x + 15x + 6                                 = 10x2 + 19x + 6  c)  (–x + 5)(x + 5) = –x(x + 5) + 5(x + 5)                              = –x2 – 5x + 5x + 25                              = –x2 + 25  d)  (3y + 4)2 = (3y + 4)(3y + 4)                     = 3y(3y + 4) + 4(3y + 4)                     = 9y2 + 12y + 12y + 16                     = 9y2 + 24y + 16  e)  (a – 3b)(4a – b) = a(4a – b) – 3b(4a – b)                                = 4a2 – ab – 12ab + 3b2                                = 4a2 – 13ab + 3b2  f)  (v – 1)(2v2 – 4v – 9) = v(2v2 – 4v – 9) – 1(2v2 – 4v – 9)                                      = 2v3 – 4v2 – 9v – 2v2 + 4v + 9                                      = 2v3 – 6v2 – 5v + 9 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:02:07.790

***删除了无用的原始答案***

```
echo 'Unit 2 Review Page 257 Question 9  a)  12 (2)(2)(3)'\
| sed -n '/Page/{s/.*Page[ ][ ]*\([0-9][0-9]*\)[ ][ ]*Question[ ][ ]*\([0-9][0-9]*\).*$/pg\1_q\2/;p;q;}' 
```

**输出**

```
pg257_q9

echo 'Unit 2 Review Page 258 Question 16  a)  (a  4)(a + 7) = a(a + 7)  4(a + 7)'\
| sed -n '/Page/{s/.*Page[ ][ ]*\([0-9][0-9]*\)[ ][ ]*Question[ ][ ]*\([0-9][0-9]*\).*$/pg\1_q\2/;p;q;}' 
```

**输出**

```
pg258_q16 
```

否则，你做对了！

（请注意，两种情况的 sed 处理是相同的）。

我包含了一个尾随`;p;q}`和一个首字母`{`，因此 sed 脚本只会处理带有“Page”的行，然后退出。

我已将 posix char 类扩展为基本术语，即`[[:digit:]]`= `[0-9]`，并将 , 替换`+`为重复初始 char 类，后跟“零或多个”字符“*”，使`[0-9][0-9]*`. 我的个人经验是，从 OReilly 的第二版 Sed 和 Awk（带有梳子绑定！）中学习了 Sun 3 上的 sed，所有 posix 的东西都是分散注意力的东西，也是错误的进一步来源。我在这方面显然是少数;-)，但我愿意承认较新的 seds 有一些很棒的功能，无论如何......

我希望这有帮助。

# haskell - Haskell 子列表

> ID：10689358
> 
> 赞同：0
> 
> 时间：2012-05-21T16:55:57.340
> 
> 标签：haskell

我必须创建一个查找特定子列表的函数。

```
function :: Integer -> Integer -> [[Integer]]
function n m = … 
```

*   如果`m`小于则`n`程序退出。
*   如果`(mod (sum [1..n]) m) /= 0`再报错。
*   否则程序应该找到子列表。
*   主要列表是从`[1..n]`

例如，如果数字是`n = 6`和`m = 7`。清单是`[1,2,3,4,5,6]`答案是`[[6,1],[5,2],[4,3]]`。

```
function 6 7
>>> [[6,1],[5,2],[4,3]] 
```

订单不是必需的。所以我已经做了这些步骤。任何帮助都会很有用。示例代码也会很有用。如果有人能解决这个问题，我将不胜感激。带有解决方案的代码对我来说非常有用。

```
 function :: Integer -> Integer -> [[Integer]]
    function n m 
      |m < n = error "m is smaller than n"
      |(mod (sum [1..n]) m) /= 0 = error "list sum doesn't devide with m"
      |otherwise = … 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:41:12.950

我会去创建所有具有 sum 属性的列表，例如使用列表理解。然后通过唯一性属性进行过滤，例如：

1.  获取第一个子列表和生成器列表的列表差异并检查下一个子列表是否包含在生成器中，
    *   然后删除一个子列表，如果它不是改变的生成器的子集
    *   或执行与 1 中相同的程序。
2.  如果更改的生成器的总和小于 m，则可以结束该过程

请注意，结果取决于您对所有子列表进行排序的方式 - 因此解决方案不是唯一的最长子列表列表，而只是具有 sum 和“唯一性”属性的众多结果之一。

* * *

## 编辑：一些代码 - 不是完美的最大解决方案

只是一些开始和思考的事情，我只收集简单的两个元素列表，否则取一个最大列表。

下一个改进将是使一个函数不仅容易收集，而且收集所有两个元素列表，然后将其推广到给定长度的子列表，也许你想看看基本的组合。

```
module Sublists where
import Data.List ((\\))

subLists :: Int -> Int -> [[Int]]
subLists n = subLists' ([],[1..n])

subLists' :: ([[Int]],[Int]) -> Int -> [[Int]]
subLists' aa m = fst (mLSubLists (tLSubLists aa m) m)

_subLists :: ([Int] -> Int -> [Int]) -> ([[Int]],[Int]) -> Int -> ([[Int]],[Int])
_subLists _ yx@(_,[ ]) _ = yx
_subLists _ yx@(_,[_]) _ = yx
_subLists f yx@(yy,xx)  m | sum xx < m = yx
                       | otherwise  = if tt == []
                                        then yx
                                        else _subLists f (tt:yy,xx\\tt) m
                       where tt = f xx m

tLSubLists :: ([[Int]],[Int]) -> Int -> ([[Int]],[Int])
tLSubLists = _subLists twoList

mLSubLists :: ([[Int]],[Int]) -> Int -> ([[Int]],[Int])
mLSubLists = _subLists manyList

twoList :: [Int] -> Int -> [Int]
twoList [ ]    _ = []
twoList [_]    _ = []
twoList xx@(x:xs) m | (x + l) < m         = []
                    |  x == l              = []
                    | (x + l) `rem` m == 0 = [x,l]
                    | otherwise           = twoList ii m
                    where l  = last xs
                          ii = init xx

manyList :: [Int] -> Int -> [Int]
manyList xx m | s < m         = []
              | s == m         = xx
              | s `rem` m == 0 = xx
              | otherwise     = manyList xs m
              where s  = sum xx
                    xs = tail xx 
```

和一些测试用例：

```
import Sublists
import Test.HUnit
import Data.List ((\\))

main = testAll

testAll = runTestTT $ TestList tests

tests :: [Test]
tests = [
   "n=6 m=7" ~: "subLists"  ~:  [[3,4],[2,5],[1,6]]
                            ~=? subLists 6 7,
   "n=6 m=7" ~: "twoList"   ~:  [1,6]
                            ~=? twoList [1..6] 7,
   "n=6 m=7" ~: "twoList"   ~:  [2,5]
                            ~=? twoList ([1..6]\\[1,6]) 7,
   "n=6 m=7" ~: "twoList"   ~:  [3,4]
                            ~=? twoList (([1..6]\\[1,6])\\[2,5]) 7,
   "n=6 m=7" ~: "manyList"  ~:  [2,3,4,5]
                            ~=? manyList [1..5] 7,
   "dummy"   ~: "dummy"     ~:  "result"
                            ~=? (\_ -> "result") "function"
                            ] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T19:26:56.923

`subsequences`中的功能`Data.List`可能会有所帮助，例如

```
subsequences "abc" == ["","a","b","ab","c","ac","bc","abc"] 
```

然后，您“只”需要过滤掉所有与您的条件不匹配的子列表。

# php - 格式化金额到数据库格式

> ID：10689365
> 
> 赞同：2
> 
> 时间：2012-05-21T16:56:24.750
> 
> 标签：php, mysql, format

嗨，我对格式化金额有疑问。
在我的输入表单上，用户可以添加和编辑格式化的金额。由于这是一个多语言程序，用户可以指定自己的格式，所以没有固定的模式。
例子：

```
250.000
250,000
250.000,00  
250,000.00 
```

可悲的是，在将它们存储到数据库之前，我必须“取消格式化”它们，否则 MySQL 会将我的数字理解为浮点数，反之亦然。

我该如何克服呢？有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:59:17.133

您可以选择允许用户输入他们想要的内容，在这种情况下，您必须进行清理（并在十进制符号的情况下进行翻译），正如您在此处猜测的那样。或者您可以限制他们输入的内容并强制他们省略千位分隔符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:07:31.313

1.  您将不得不检查客户端的本地化并相应地以这种方式解析数据。因为 2,500.00 = 2.500,00。这取决于位置。
2.  不要让用户输入“，”。
3.  有一个单独的框让用户输入小数点后的内容。
4.  让该框预填充 0.00。告诉用户这是格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T17:20:07.953

*   以正确的格式从用户那里获取输入是一个好方法，在输入区域附近放置一条可查看的格式消息。
*   您应该在用户执行提交时验证输入数据。
*   在将用户输入直接存储到数据库之前，您可以在 JavaScript 和服务器端编程语言中使用正则表达式进行验证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T10:52:01.770

好的，我终于成功了，所以我将分享我的解决方案
首先，我使用[Mootools](http://mootools.net/docs/more/Types/Number.Format "Mootools 数字.格式")在用户输入时格式化输入字段。
然后我移动了服务器端。

格式选项保存在我的应用程序中，所以这是代码

```
//get decimal separator from saved params
$dec = $params->get('decimalSep', '.');
//remove any char that's not a number or decimal separator 
//(i don't care about thousands sep)
$regex = '#[^0-9-'.preg_quote($dec).']#';

$normalized = preg_replace($regex, '', $price);
$normalized = str_replace($dec, '.', $normalized); 
```

基本上我去掉了除小数点分隔符之外的所有内容，然后用标准分隔符 ( `.`) 替换它。

它就像一个魅力。

# tomcat7 - LifeCycle 错误 - 未实现正确的接口 javax.portlet.filter.PortletFilter

> ID：10689366
> 
> 赞同：0
> 
> 时间：2012-05-21T16:56:34.510
> 
> 标签：tomcat7, gatein

我开始将一个 wep 应用程序从 Tomcat 6 更新到当前版本的 Tomcat (7-27)。当我使用以下错误消息启动服务器时出现问题：

*错误生命周期 - 无法启动对象 org.gatein.pc.portlet.container.PortletInitializationException：无法使用类 com.qnamic.railopt.web.security.portlet.PortletSecurityFilter 创建过滤器，因为它没有实现预期的接口 javax.portlet.filter。 PortletFilter 在 org.gatein.pc.portlet.impl.jsr168.ClassInstanceLifeCycle.create(ClassInstanceLifeCycle.java:85) 在 org.gatein.pc.portlet.impl.jsr168.PortletFilterImpl.start(PortletFilterImpl.java:144) 在 org. gatein.pc.portlet.impl.container.PortletFilterLifeCycle.invokeStart(PortletFilterLifeCycle.java:66) 在 org.gatein.pc.portlet.impl.container.LifeCycle.managedStart(LifeCycle.java:93) 在 org.gatein.pc。 portlet.impl.container.PortletApplicationLifeCycle.startDependents(PortletApplicationLifeCycle.java:339) 在 org.gatein.pc.portlet.impl.container.LifeCycle。managedStart(LifeCycle.java:129) 在 org.gatein.pc.mc.PortletApplicationDeployment.install(PortletApplicationDeployment.java:153) 在 org.gatein.pc.mc.PortletApplicationDeployer.add(PortletApplicationDeployer.java:216) 在 org.gatein .pc.mc.PortletApplicationDeployer.onEvent(PortletApplicationDeployer.java:185) at org.gatein.wci.impl.DefaultServletContainer.safeFireEvent(DefaultServletContainer.java:200) at org.gatein.wci.impl.DefaultServletContainer.fireEvent(DefaultServletContainer.java :219) 在 org.gatein.wci.impl.DefaultServletContainer$RegistrationImpl.registerWebApp(DefaultServletContainer.java:338) 在 org.gatein.wci 的 org.gatein.wci.impl.DefaultServletContainer.access$400(DefaultServletContainer.java:60) .tomcat.TC7ServletContainerContext.start(TC7ServletContainerContext.java:380) 在 org.gatein.wci.tomcat。TC7ServletContainerContext.lifecycleEvent(TC7ServletContainerContext.java:234) at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119) at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90) at org .apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:401) 在 org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:168) 在 org.apache.catalina.core.ContainerBase$StartChild.call (ContainerBase.java:1566) 在 org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1556) 在 java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303) 在 java. util.concurrent.FutureTask.run(FutureTask.java:138) 在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) 在 java.util.concurrent。ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) at java.lang.Thread.run(Thread.java:619) A: S: R: U: ERROR LifeCycle - 无法启动对象 org.gatein.pc.portlet.container .PortletInitializationException：无法使用类 com.qnamic.railopt.web.core.portal.ContextFilter 创建过滤器，因为它没有在 org.gatein.pc.portlet.impl.jsr168.ClassInstanceLifeCycle 实现预期的接口 javax.portlet.filter.PortletFilter .create(ClassInstanceLifeCycle.java:85) at org.gatein.pc.portlet.impl.jsr168.PortletFilterImpl.start(PortletFilterImpl.java:144) at org.gatein.pc.portlet.impl.container.PortletFilterLifeCycle.invokeStart(PortletFilterLifeCycle .java:66) 在 org.gatein.pc.portlet.impl.container.PortletApplicationLifeCycle 的 org.gatein.pc.portlet.impl.container.LifeCycle.managedStart(LifeCycle.java:93)。startDependents(PortletApplicationLifeCycle.java:339) at org.gatein.pc.portlet.impl.container.LifeCycle.managedStart(LifeCycle.java:129) at org.gatein.pc.mc.PortletApplicationDeployment.install(PortletApplicationDeployment.java:153)在 org.gatein.pc.mc.PortletApplicationDeployer.add(PortletApplicationDeployer.java:216) 在 org.gatein.pc.mc.PortletApplicationDeployer.onEvent(PortletApplicationDeployer.java:185) 在 org.gatein.wci.impl.DefaultServletContainer.safeFireEvent (DefaultServletContainer.java:200) 在 org.gatein.wci.impl.DefaultServletContainer.fireEvent(DefaultServletContainer.java:219) 在 org.gatein.wci.impl.DefaultServletContainer.access$400(DefaultServletContainer.java:60) 在 org.gatein org.gatein.wci 中的 .wci.impl.DefaultServletContainer$RegistrationImpl.registerWebApp(DefaultServletContainer.java:338)。tomcat.TC7ServletContainerContext.start(TC7ServletContainerContext.java:380) at org.gatein.wci.tomcat.TC7ServletContainerContext.lifecycleEvent(TC7ServletContainerContext.java:234) at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)在 org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90) 在 org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:401) 在 org.apache.catalina.util.LifecycleBase.start (LifecycleBase.java:168) 在 org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1566) 在 org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1556) 在java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303) 在 java.util.concurrent.FutureTask.run(FutureTask.java:138) 在 java.util。concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) 在 java.lang.Thread.run(Thread.java:619)*

com.qnamic.railopt.web.security.portlet.PortletSecurityFilter 类确实实现了接口 javax.portlet.filter.PortletFilter：

```
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.security.Principal;

import javax.portlet.ActionRequest;
import javax.portlet.ActionResponse;
import javax.portlet.EventRequest;
import javax.portlet.EventResponse;
import javax.portlet.PortletException;
import javax.portlet.PortletMode;
import javax.portlet.PortletRequest;
import javax.portlet.PortletResponse;
import javax.portlet.PortletSession;
import javax.portlet.RenderRequest;
import javax.portlet.RenderResponse;
import javax.portlet.ResourceRequest;
import javax.portlet.ResourceResponse;
import javax.portlet.filter.ActionFilter;
import javax.portlet.filter.EventFilter;
import javax.portlet.filter.FilterChain;
import javax.portlet.filter.FilterConfig;
import javax.portlet.filter.RenderFilter;
import javax.portlet.filter.ResourceFilter;

import org.apache.log4j.Logger;
import org.springframework.security.access.AccessDeniedException;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;

public class PortletSecurityFilter implements ActionFilter, EventFilter, RenderFilter, ResourceFilter { 
```

ActionFilter 确实实现了 javax.portlet.filter.PortletFilter

依赖的罐子是：

*   primefaces-3.2.jar
*   spring-core-3.0.5.RELEASE.jar
*   spring-asm-3.0.5.RELEASE.jar
*   spring-context-3.0.5.RELEASE.jar
*   spring-aop-3.0.5.RELEASE.jar
*   spring-expression-3.0.5.RELEASE.jar
*   spring-webmvc-portlet-3.0.5.RELEASE.jar
*   spring-webmvc-3.0.5.RELEASE.jar
*   spring-context-support-3.0.5.RELEASE.jar
*   **portlet-api-2.0.jar**
*   Platform-3.8.0.jar
*   jdo-2.0.jar
*   kodo-runtime.jar
*   openjpa-1.0-fast.jar
*   PlanOpt-3.8.0.jar
*   RailOptBase-3.8.0.jar
*   portletfaces-bridge-api-2.0.0-RC1.jar
*   portletfaces-bridge-impl-2.0.0-RC1.jar
*   portletfaces-logging-1.1.0.jar
*   commons-collections-3.2.1.jar
*   spring-web-3.0.5.RELEASE.jar
*   aopalliance-1.0.jar
*   spring-beans-3.0.5.RELEASE.jar
*   spring-security-web-3.0.5.RELEASE.jar
*   spring-security-core-3.0.5.RELEASE.jar
*   spring-tx-3.0.3.RELEASE.jar
*   aspectjrt-1.6.8.jar
*   aspectjweaver-1.6.8.jar
*   spring-security-config-3.0.5.RELEASE.jar
*   log4j-1.2.15.jar
*   el-api-1.0.jar
*   slf4j-api-1.5.8.jar
*   servlet-api-2.5.jar
*   jstl-1.2.jar
*   commons-lang-2.5.jar
*   RailOptIntegration-3.8.0.jar
*   google-collections-1.0.jar
*   junit-4.8.2.jar
*   commons-io-2.0.1.jar
*   el-impl-2.2.jar
*   javax.faces-2.1.7.jar

一些依赖项具有“提供”的范围，并且不包括在战争中（只要tomcat不使用它们）！

我的 portlet.xml 的一部分

```
<filter>
<filter-name>PortletSecurityFilter</filter-name>
        <filter-class>com.qnamic.railopt.web.security.portlet.PortletSecurityFilter</filter- class>
    <lifecycle>ACTION_PHASE</lifecycle>
    <lifecycle>EVENT_PHASE</lifecycle>
    <lifecycle>RENDER_PHASE</lifecycle>
    <lifecycle>RESOURCE_PHASE</lifecycle>
    <init-param>
        <name>message</name>
        <value>Security Filter</value>
    </init-param>
</filter>

<filter-mapping>
    <filter-name>PortletSecurityFilter</filter-name>
    <portlet-name>*</portlet-name>
</filter-mapping> 
```

其他依赖项位于父项目中：

*   pc-api-2.2.0-GA.jar
*   pc-controller-2.2.0-GA.jar
*   pc-portlet-2.2.0-GA.jar
*   pc-mc-2.2.0-GA.jar
*   wci-wci-2.1.1-GA.jar
*   wci-tomcat7-2.1.1-GA.jar

当我在 org.gatein.pc.portlet.impl.jsr168.ClassInstanceLifeCycle.create(...) 中调试代码时，它停在第二行

```
Class clazz = classLoader.loadClass(className);
if (expectedClass.isAssignableFrom(clazz)) {
    Class<? extends T> castedClass = clazz.asSubclass(expectedClass);
    Constructor<? extends T> ctor = castedClass.getConstructor();
    instance = ctor.newInstance();
}
else  {
    String msg = "Cannot create " + type + " with class " + className + " because it does not   implement the expected interface " + expectedClass.getName();
    throw new PortletInitializationException(msg);
} 
```

我的建议首先是类加载器存在问题，但它不应该是，因为第一行正确加载了类 PortletSecurityFilter。正如预期的那样，预期的类是 javax.portlet.filter.PortletFilter。为什么这个类是不可分配的？

我感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T15:34:24.640

我必须承认，我不知道您用来解决此问题的 GateIn 的确切版本是什么，但无论如何我可以通过简单地保留（故意）portlet-api-2.0 来使用 GateIn-3.2.0.Final-tomcat7 重现此问题.jar 在我的 war 文件的 WEB-INF/lib 目录中。然后我可以得到类似的东西：

```
28 janv. 2013 15:48:09 org.gatein.common.logging.Logger log
GRAVE: Cannot start object
org.gatein.pc.portlet.container.PortletInitializationException: Cannot create filter with class org.exoplatform.tutorial.portlet.MyPortletFilter because it does not implement the expected interface javax.portlet.filter.PortletFilter
    at org.gatein.pc.portlet.impl.jsr168.ClassInstanceLifeCycle.create(ClassInstanceLifeCycle.java:85)
    at org.gatein.pc.portlet.impl.jsr168.PortletFilterImpl.start(PortletFilterImpl.java:144)
    at org.gatein.pc.portlet.impl.container.PortletFilterLifeCycle.invokeStart(PortletFilterLifeCycle.java:66)
    at org.gatein.pc.portlet.impl.container.LifeCycle.managedStart(LifeCycle.java:93)
    at org.gatein.pc.portlet.impl.container.PortletApplicationLifeCycle.startDependents(PortletApplicationLifeCycle.java:339)
    at org.gatein.pc.portlet.impl.container.LifeCycle.managedStart(LifeCycle.java:129)
    at org.gatein.pc.portlet.impl.deployment.PortletApplicationDeployment.install(PortletApplicationDeployment.java:153)
    at org.gatein.pc.portlet.impl.deployment.PortletApplicationDeployer.add(PortletApplicationDeployer.java:199)
    at org.gatein.pc.portlet.impl.deployment.PortletApplicationDeployer.onEvent(PortletApplicationDeployer.java:168)
    at org.gatein.wci.impl.DefaultServletContainer.safeFireEvent(DefaultServletContainer.java:200)
    at org.gatein.wci.impl.DefaultServletContainer.addWebAppListener(DefaultServletContainer.java:166)
    at org.gatein.pc.portlet.impl.deployment.PortletApplicationDeployer.start(PortletApplicationDeployer.java:241)
    at org.exoplatform.portal.pc.ExoKernelIntegration.start(ExoKernelIntegration.java:178)
    at sun.reflect.GeneratedMethodAccessor53.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.exoplatform.container.LifecycleVisitor.traverse(LifecycleVisitor.java:100)
    at org.exoplatform.container.LifecycleVisitor.start(LifecycleVisitor.java:170)
    at org.exoplatform.container.ConcurrentPicoContainer.start(ConcurrentPicoContainer.java:554)
    at org.exoplatform.container.ExoContainer.start(ExoContainer.java:266)
    at org.exoplatform.container.PortalContainer.start(PortalContainer.java:667)
    at org.exoplatform.container.ExoContainer.start(ExoContainer.java:254)
    at org.exoplatform.container.RootContainer.createPortalContainer(RootContainer.java:399)
    at org.exoplatform.container.RootContainer.registerPortalContainer(RootContainer.java:266)
    at org.exoplatform.portal.application.PortalController.afterInit(PortalController.java:114)
    at org.exoplatform.container.web.AbstractHttpServlet.init(AbstractHttpServlet.java:79)
    at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1201) 
```

我可以通过简单地从我的 webapp 的 WEB-INF/lib 中删除 portlet-api-2.0.jar 来修复它（或者在提供的 maven 中定义这个依赖项）。发生这种情况仅仅是因为 jar 文件已经在 tomcat/lib 中，所以 Portlet Container 引用了从 Tomcat 的公共 ClassLoader 加载的类 javax.portlet.filter.PortletFilter，而您的 Filter 实现了类 javax.portlet.filter。 PortletFilter 已从您的 webapp 的 ClassLoader 加载（来自 WEB-INF/lib），即使这 2 个类的 FQN 相等，它们也不被视为相同的类，这就是为什么 expectedClass.isAssignableFrom(clazz)返回假。

# wpf - RotateTransform 移动我的图像以及旋转它

> ID：10689368
> 
> 赞同：1
> 
> 时间：2012-05-21T16:56:42.047
> 
> 标签：wpf, margin, offset, rotatetransform, layouttransform

好的，所以我有一个要围绕其左上角旋转的 Image 对象。我设置了一个 'X' 度的 RotateTransform。我的图像的边距设置为 (400,400,0,0)。这将它集中在画布上。

问题是当我应用不同的旋转角度时，图像会向右和向下移动。看帖子，我现在明白为什么会这样了。旋转变换计算出一个边界矩形，因此如果您旋转图像，它将有一个更大的边界矩形。边距应用于该边界矩形，这会导致实际图像随着角度的变化而向下和向右移动。

我想要的是图像的左上角在我的画布上始终精确地位于 (400,400) 处，并且图像围绕该点旋转。

我已经做了一些计算，可以通过移动左边距和上边距来让它表现出来，但只能使用以下等式在象限 1 和 4（0-90 度）和（270-360 度）中得到正确的计算：

对于 0-90 度：（只需更改边距的顶部部分。所需边距为 (400,400,0,0) Margin=(400-sin(angle)*Image.Height, 400, 0, 0);

对于 270-360 度：（只需更改页边距的 TOP 部分。所需页边距为 (400,400,0,0) Margin=(400, 400 + sin(angle)*Image.Width, 0, 0);

我已经尝试使用 RotateTransform.Transform(point) 和 Image.TranslatPoint(point) 但似乎无法让它们工作。

有人对我有什么建议吗？

我想如果我能在任何给定时间弄清楚图像的绑定矩形是什么，我就可以找出它的宽度/高度和我的图像宽度/高度之间的差异，并使用它来适当地移动边距。

我已经整理了一个小应用程序来显示我的问题。运行时，应用程序在我希望矩形左上角的位置显示一个红点。我将其简化为使用网格而不是图像。在屏幕的左上角，有一个文本框，您可以在其中指定旋转角度。文本框的右侧是两个重复按钮，如果您单击并按住它们，它们会增加和减少角度。请注意，当您更改角度时，网格的左上角如何远离红点。我希望它表现得就像你在左上角放了一个大头针，然后围绕大头针旋转它，而不从角落开始的点移动。

谢谢你的帮助。

这是示例应用程序的代码：

xml:

```
<Window x:Class="RenderTransformTester.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="900" Width="900">
    <Canvas x:Name="_canvas">
        <Grid x:Name="_gridImage"  Width="400" Height="200" Canvas.Left="400" Canvas.Top="400" Background="Navy">
            <Grid.LayoutTransform>
                <RotateTransform Angle="45" CenterX="0" CenterY="0"/>
            </Grid.LayoutTransform>
        </Grid>
        <Ellipse Fill="Red" Width="20" Height="20" Margin="390,390,0,0"/>
        <TextBox x:Name="_textBoxAngle" Width="70" Height="30" TextChanged="_textBoxAngle_TextChanged" Text="0"/>
        <RepeatButton x:Name="_buttonUp" Width="30" Height="15" Margin="70,0,0,0" Click="_buttonUp_Click"/>
        <RepeatButton x:Name="_buttonDown" Width="30" Height="15" Margin="70,15,0,0" Click="_buttonDown_Click"/>
    </Canvas>
</Window> 
```

代码隐藏：

```
using System;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media;

namespace RenderTransformTester
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow
    {
        static double _left = -1;
        static double _top = -1;

        public MainWindow()
        {
            InitializeComponent();
        }

        private void _textBoxAngle_TextChanged(object sender, TextChangedEventArgs e)
        {
            int angle;
            int.TryParse(_textBoxAngle.Text, out angle);
            angle += 720;
            angle %= 360;

            _gridImage.LayoutTransform = new RotateTransform(angle, 0, 0);
        }

        private void _buttonUp_Click(object sender, RoutedEventArgs e)
        {
            int angle;
            int.TryParse(_textBoxAngle.Text, out angle);
            angle++;
            angle = angle % 360;
            _textBoxAngle.Text = angle.ToString();
        }

        private void _buttonDown_Click(object sender, RoutedEventArgs e)
        {
            int angle;
            int.TryParse(_textBoxAngle.Text, out angle);
            angle--;
            angle = angle % 360;
            _textBoxAngle.Text = angle.ToString();
        }

        private static double RadiansToDegrees(double radians)
        {
            return radians * 180 / Math.PI;
        }

        private static double DegreesToRadians(double degrees)
        {
            return degrees * Math.PI / 180;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T18:40:10.817

你想要一个 TransformGroup 中的 TranslateTransform

```
<Grid>
    <Grid.RenderTransform>
        <TransformGroup>
            <RotateTransform Angle="45" CenterX="0" CenterY="0" />
            <TranslateTransform X="400" Y="400" />
        </TransformGroup>
    </Grid.RenderTransform>
</Grid> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:01:25.790

1.  不要`Margin`用于这种定位，使用附加`Canvas`属性，即[`Canvas.Left`](http://msdn.microsoft.com/en-us/library/system.windows.controls.canvas.left.aspx)等。
2.  您也可以使用 a[`TransformGroup`](http://msdn.microsoft.com/en-us/library/system.windows.media.transformgroup.aspx)并应用 a`TranslateTransform`和 a `RotateTransform`，大概旋转应该在翻译之前完成。

# bash - Bash - sed 替换文本

> ID：10689369
> 
> 赞同：2
> 
> 时间：2012-05-21T16:56:47.073
> 
> 标签：bash, sed

我正在尝试替换属性文件中的一行文本。例如：

```
food.type=banana 
```

使用这行代码，我可以用另一个输入的输入完全替换香蕉。

```
FOOD=apple
sed "s/food.type=.*/food.type=$FOOD/" 
```

输出：

```
food.type=apple 
```

但是，当我尝试替换的前一行文本中有一个`/`时，我无法让替换工作。例如：

```
food.type=/yellow/banana 
```

任何帮助深表感谢。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T17:03:56.620

斜杠被解读为关闭正则表达式匹配/替换模式，

做

```
sed "s@food.type=.*@food.type=$FOOD@" 
```

一些 sed 要求您转义非标准分隔符的第一个实例，即

```
sed "s\@food.type=.*@food.type=$FOOD@" 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:50:57.557

另一种选择是继续`/`用作 sed 的分隔符，并转义替换字符串中的任何斜线。bash 可以做到这一点（虽然它很神秘）：

```
sed "s/food.type=.*/food.type=${FOOD//\//\/}/" 
```

那个变量替换是相当神秘的，所以让我把它分解解释一下：

`${FOOD` 开始一个 FOOD 的变量替换，用...
`//` 替换所有出现
`\/` 的字符`/`（注意它必须在此上下文中转义）
`/` 替换
`\/` 字符串`\/`（注意这里的转义被简单地视为替换字符串的一部分）替换
`}` 结束

但这并不完全完美，因为如果替换字符串中出现其他几个字符可能会导致问题。要真正做到这一点，您可以在 bash 中进行多次替换（混乱），或者将工作外包给`sed`：

```
ESCAPEDFOOD="$(printf "%s" "$FOOD" | sed 's/[\/&]/\\&/g')"
sed "s/food.type=.*/food.type=$ESCFOOD/" 
```

同样，替换有点神秘，所以这里有一个细分：

`s/` 替换模式
`[\/&]` 中的任何字符`\`,`/`或`&`
`/` ...
`\\&` 替换字符串`\`（此处转义）后跟原始匹配
`/g` ...全局（即替换所有出现）

（是的，我知道使用`sed`来准备与 . 一起使用的字符串具有讽刺意味`sed`。）

请注意，我可能错过了一些麻烦的字符；如果是这样，它们可以添加到`[]`表达式中。

# javascript - 获取窗口开始加载

> ID：10689370
> 
> 赞同：0
> 
> 时间：2012-05-21T16:56:51.740
> 
> 标签：javascript, events, dom, onload

我有一个网站，它通过 ajax 从服务器中提取它的内容，并在请求完成后使用 Nodes 的 innerHTML 属性将新的 HTML 注入到页面中。

我有一种方法，一个事件监听器或类似的东西，当浏览器开始加载连接到新注入的 html 的数据时调用它。

如果新加载的 HTML 包含图像、链接的样式表、脚本或类似的东西，浏览器会再次开始加载 - 我可以监督这个“正在加载标志”，还是我必须解析新的 HTML，找到可能有 onLoad 的元素财产？

问候菲利普

# android - Android getlastknownlocation 返回 null

> ID：10689372
> 
> 赞同：2
> 
> 时间：2012-05-21T16:56:53.423
> 
> 标签：android, location

我正在为 GPS 提供商调用 getLastKnownLocation 并且它返回 null。文档说，如果未启用提供程序，这可能会发生，但我知道它是。如果不存在最后一个已知位置，提供者是否可以返回 null？我看不到文档在哪里说“如果不存在最后一个已知位置，可能会返回 null”

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-21T17:16:28.717

> 如果不存在最后一个已知位置，提供者是否可以返回 null？

是的。事实上，很多时候，它会返回`null`，因为没有任何东西会导致 GPS 获取修复。GPS 通常会断电以节省电池寿命。有关查找您的位置的方法，请参阅[获取用户](http://developer.android.com/guide/topics/location/obtaining-user-location.html)位置。

> 我看不到文档在哪里说“如果不存在最后一个已知位置，可能会返回 null”

该文档有其缺陷。

# c# - ListView 中的多选项目

> ID：10689373
> 
> 赞同：0
> 
> 时间：2012-05-21T16:56:55.483
> 
> 标签：c#, winforms

使用此页面中的代码开始：
[http ://www.java2s.com/Code/CSharp/GUI-Windows-Form/DragginganddroppingbetweenListView.htm](http://www.java2s.com/Code/CSharp/GUI-Windows-Form/DragginganddroppingbetweenListView.htm)

我试图找出需要添加什么来支持另外两个功能：
a）能够多选并一起移动项目。
b) 当我们双击它时，能够对单个项目进行移动。

任何更多信息，阅读材料，以帮助解决上述两个问题，可以让我走上正轨，非常感谢。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:19:27.593

在设计器中设置`MultiSelect = True`。这允许您选择 > 1 个项目。

我不确定您*的意思是“当我们双击它时能够移动单个项目”*。听起来您想`ListView`在双击某个项目时将其从一个项目移动到另一个项目。在这种情况下，创建`ListViewItem`您在双击事件中双击的副本（我认为它可能是 e.Item？），然后将其添加或插入到代码隐藏中的另一个列表中。如果要从双击的列表中删除它，只需使用`MyListView.RemoveAt`并传递该项目的索引。

就代码而言，这写起来还不错，所以我不会写出所有步骤。但这就是你想要做的，逐步的。

# postgresql - Jboss 4.2.3 数据源无法连接到 PostgreSQL

> ID：10689376
> 
> 赞同：3
> 
> 时间：2012-05-21T16:57:38.930
> 
> 标签：postgresql, jboss, datasource, fedora

我在云服务器 Fedora 16 x64 中遇到问题。我已经从 YUM 存储库安装了 PostgreSQL 9.1，它运行良好。我通过 VPN 从我的 PC 连接并使用 PGAdmin III 来管理它，我只需更改参数 listen_addresses 以分配值“*”来连接它。我已经安装了 Jboss 4.2.3 并将一个数据源文件放在部署目录中，其中包含一个使用该数据源的 EAR，该文件是 dipr-ds.xml，它具有以下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE datasources
    PUBLIC "-//JBoss//DTD JBOSS JCA Config 1.5//EN"
    "http://www.jboss.org/j2ee/dtd/jboss-ds_1_5.dtd">
<datasources>
   <local-tx-datasource>
      <jndi-name>sainvDatasource</jndi-name>
      <use-java-context>false</use-java-context>
     <connection-url>jdbc:postgresql://127.0.0.1:5432/diprinventory</connection-url>
      <driver-class>org.postgresql.Driver</driver-class>
      <user-name>postgres</user-name>
      <password>postgres</password>
   </local-tx-datasource>
</datasources> 
```

但是当我重新启动 Jboss 以部署 EAR 并尝试连接到数据库时，我收到与连接和应用程序错误相关的错误，应用程序无法正常工作，但现在我正专注于解决连接问题，以找出为什么当我使用 VPN 从我的机器管理时应用程序无法连接到 Jboss，如果它工作正常。这是堆栈跟踪：

```
Caused by: org.jboss.resource.JBossResourceException: Could not create connection; - nested throwable: (org.postgresql.util.PSQLException: FATAL: Ident authenticatio$
        at org.jboss.resource.adapter.jdbc.local.LocalManagedConnectionFactory.createManagedConnection(LocalManagedConnectionFactory.java:190)
        at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.createConnectionEventListener(InternalManagedConnectionPool.java:619)
        at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.getConnection(InternalManagedConnectionPool.java:264)
        at org.jboss.resource.connectionmanager.JBossManagedConnectionPool$BasePool.getConnection(JBossManagedConnectionPool.java:575)
        at org.jboss.resource.connectionmanager.BaseConnectionManager2.getManagedConnection(BaseConnectionManager2.java:347)
        at org.jboss.resource.connectionmanager.TxConnectionManager.getManagedConnection(TxConnectionManager.java:330)
        at org.jboss.resource.connectionmanager.BaseConnectionManager2.allocateConnection(BaseConnectionManager2.java:402)
        at org.jboss.resource.connectionmanager.BaseConnectionManager2$ConnectionManagerProxy.allocateConnection(BaseConnectionManager2.java:849)
        at org.jboss.resource.adapter.jdbc.WrapperDataSource.getConnection(WrapperDataSource.java:89)
        ... 151 more
Caused by: org.postgresql.util.PSQLException: FATAL: Ident authentication failed for user "postgres"
        at org.postgresql.core.v3.ConnectionFactoryImpl.doAuthentication(ConnectionFactoryImpl.java:291)
        at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:106)
        at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:64)
        at org.postgresql.jdbc2.AbstractJdbc2Connection.<init>(AbstractJdbc2Connection.java:123)
        at org.postgresql.jdbc3.AbstractJdbc3Connection.<init>(AbstractJdbc3Connection.java:28)
        at org.postgresql.jdbc3g.AbstractJdbc3gConnection.<init>(AbstractJdbc3gConnection.java:20)
        at org.postgresql.jdbc4.AbstractJdbc4Connection.<init>(AbstractJdbc4Connection.java:30)
        at org.postgresql.jdbc4.Jdbc4Connection.<init>(Jdbc4Connection.java:22)
        at org.postgresql.Driver.makeConnection(Driver.java:391)
        at org.postgresql.Driver.connect(Driver.java:265)
        at org.jboss.resource.adapter.jdbc.local.LocalManagedConnectionFactory.createManagedConnection(LocalManagedConnectionFactory.java:172)
        ... 159 more
2012-05-21 09:49:04,226 ERROR [org.hibernate.tool.hbm2ddl.SchemaUpdate] could not complete schema update
org.jboss.util.NestedSQLException: Could not create connection; - nested throwable: (org.postgresql.util.PSQLException: FATAL: Ident authentication failed for user "$
        at org.jboss.resource.adapter.jdbc.WrapperDataSource.getConnection(WrapperDataSource.java:95)
        at org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:47)
        at org.hibernate.tool.hbm2ddl.SuppliedConnectionProviderConnectionHelper.prepare(SuppliedConnectionProviderConnectionHelper.java:27)
        at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:127)
        at org.hibernate.impl.SessionFactoryImpl.<init>(SessionFactoryImpl.java:314)
        at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1294)
        at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:713)
        at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:127)
        at org.jboss.ejb3.entity.PersistenceUnitDeployment.start(PersistenceUnitDeployment.java:246)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.jboss.ejb3.ServiceDelegateWrapper.startService(ServiceDelegateWrapper.java:103)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.jboss.ejb3.ServiceDelegateWrapper.startService(ServiceDelegateWrapper.java:103)
        at org.jboss.system.ServiceMBeanSupport.jbossInternalStart(ServiceMBeanSupport.java:289)
        at org.jboss.system.ServiceMBeanSupport.jbossInternalLifecycle(ServiceMBeanSupport.java:245)
        at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
        at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
        at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)
        at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
        at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
        at org.jboss.system.ServiceController$ServiceProxy.invoke(ServiceController.java:978)
        at $Proxy0.start(Unknown Source)
        at org.jboss.system.ServiceController.start(ServiceController.java:417)
        at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
        at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
        at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)
        at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
        at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
        at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
        at $Proxy70.start(Unknown Source)
        at org.jboss.ejb3.JmxKernelAbstraction.install(JmxKernelAbstraction.java:120)
        at org.jboss.ejb3.Ejb3Deployment.startPersistenceUnits(Ejb3Deployment.java:627)
        at org.jboss.ejb3.Ejb3Deployment.start(Ejb3Deployment.java:351)
        at org.jboss.ejb3.Ejb3Module.startService(Ejb3Module.java:91)
        at org.jboss.system.ServiceMBeanSupport.jbossInternalStart(ServiceMBeanSupport.java:289)
        at org.jboss.system.ServiceMBeanSupport.jbossInternalLifecycle(ServiceMBeanSupport.java:245)
        at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
        at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
        at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)
        at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
        at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
        at org.jboss.system.ServiceController$ServiceProxy.invoke(ServiceController.java:978)
        at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
        at org.jboss.system.ServiceController$ServiceProxy.invoke(ServiceController.java:978)
        at $Proxy0.start(Unknown Source)
        at org.jboss.system.ServiceController.start(ServiceController.java:417)
        at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
        at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
        at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)
        at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
        at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
        at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
        at $Proxy33.start(Unknown Source)
        at org.jboss.ejb3.EJB3Deployer.start(EJB3Deployer.java:512)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
        at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
        at org.jboss.mx.interceptor.AbstractInterceptor.invoke(AbstractInterceptor.java:133)
        at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
        at org.jboss.mx.interceptor.ModelMBeanOperationInterceptor.invoke(ModelMBeanOperationInterceptor.java:142)
        at org.jboss.mx.interceptor.DynamicInterceptor.invoke(DynamicInterceptor.java:97)
        at org.jboss.system.InterceptorServiceMBeanSupport.invokeNext(InterceptorServiceMBeanSupport.java:238)
        at org.jboss.wsf.container.jboss42.DeployerInterceptor.start(DeployerInterceptor.java:87)
        at org.jboss.deployment.SubDeployerInterceptorSupport$XMBeanInterceptor.start(SubDeployerInterceptorSupport.java:188)
        at org.jboss.deployment.SubDeployerInterceptor.invoke(SubDeployerInterceptor.java:95)
        at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
        at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
        at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
        at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
        at $Proxy34.start(Unknown Source)
        at org.jboss.deployment.MainDeployer.start(MainDeployer.java:1025)
        at org.jboss.deployment.MainDeployer.start(MainDeployer.java:1015)
        at org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:819)
        at org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:782)
        at sun.reflect.GeneratedMethodAccessor21.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at sun.reflect.GeneratedMethodAccessor21.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
        at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
        at org.jboss.mx.interceptor.AbstractInterceptor.invoke(AbstractInterceptor.java:133)
        at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
        at org.jboss.mx.interceptor.ModelMBeanOperationInterceptor.invoke(ModelMBeanOperationInterceptor.java:142)
        at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
        at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
        at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
        at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
        at $Proxy9.deploy(Unknown Source)
        at org.jboss.deployment.scanner.URLDeploymentScanner.deploy(URLDeploymentScanner.java:421)
        at org.jboss.deployment.scanner.URLDeploymentScanner.scan(URLDeploymentScanner.java:634)
        at org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.doScan(AbstractDeploymentScanner.java:263)
        at org.jboss.deployment.scanner.AbstractDeploymentScanner.startService(AbstractDeploymentScanner.java:336)
        at org.jboss.system.ServiceMBeanSupport.jbossInternalStart(ServiceMBeanSupport.java:289)
        at org.jboss.system.ServiceMBeanSupport.jbossInternalLifecycle(ServiceMBeanSupport.java:245)
        at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
        at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
        at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)
        at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
        at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
        at org.jboss.system.ServiceController$ServiceProxy.invoke(ServiceController.java:978)
        at $Proxy0.start(Unknown Source)
        at org.jboss.system.ServiceController.start(ServiceController.java:417)
        at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
        at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
        at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)
        at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
        at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
                        at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
        at $Proxy4.start(Unknown Source)
        at $Proxy4.start(Unknown Source)
        at org.jboss.deployment.SARDeployer.start(SARDeployer.java:304)
        at org.jboss.deployment.MainDeployer.start(MainDeployer.java:1025)
        at org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:819)
        at org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:782)
        at org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:766)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
        at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
        at org.jboss.mx.interceptor.AbstractInterceptor.invoke(AbstractInterceptor.java:133)
        at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
        at org.jboss.mx.interceptor.ModelMBeanOperationInterceptor.invoke(ModelMBeanOperationInterceptor.java:142)
        at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
        at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
        at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
        at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
        at $Proxy5.deploy(Unknown Source)
        at org.jboss.system.server.ServerImpl.doStart(ServerImpl.java:482)
        at org.jboss.system.server.ServerImpl.start(ServerImpl.java:362)
        at org.jboss.Main.boot(Main.java:200)
        at org.jboss.Main$1.run(Main.java:508)
        at java.lang.Thread.run(Thread.java:662)
Caused by: org.jboss.resource.JBossResourceException: Could not create connection; - nested throwable: (org.postgresql.util.PSQLException: FATAL: Ident authenticatio$
        at org.jboss.resource.adapter.jdbc.local.LocalManagedConnectionFactory.createManagedConnection(LocalManagedConnectionFactory.java:190)
        at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.createConnectionEventListener(InternalManagedConnectionPool.java:619)
        at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.getConnection(InternalManagedConnectionPool.java:264)
        at org.jboss.resource.connectionmanager.JBossManagedConnectionPool$BasePool.getConnection(JBossManagedConnectionPool.java:575)
        at org.jboss.resource.connectionmanager.BaseConnectionManager2.getManagedConnection(BaseConnectionManager2.java:347)
        at org.jboss.resource.connectionmanager.TxConnectionManager.getManagedConnection(TxConnectionManager.java:330)
        at org.jboss.resource.connectionmanager.BaseConnectionManager2.allocateConnection(BaseConnectionManager2.java:402)
        at org.jboss.resource.connectionmanager.BaseConnectionManager2$ConnectionManagerProxy.allocateConnection(BaseConnectionManager2.java:849)
        at org.jboss.resource.adapter.jdbc.WrapperDataSource.getConnection(WrapperDataSource.java:89)
        ... 151 more
Caused by: org.postgresql.util.PSQLException: FATAL: Ident authentication failed for user "postgres"
        at org.postgresql.core.v3.ConnectionFactoryImpl.doAuthentication(ConnectionFactoryImpl.java:291)
        at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:106)
... 
```

我不知道是与 Jboss 相关的问题还是 PostgreSQL 的配置设置，所以我将感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T17:44:29.233

问题是 Postgres 正在尝试验证拥有调用进程的用户，即运行 JBoss 的 java 进程。参见例如：

[psql：致命：用户“postgres”的身份验证失败](https://stackoverflow.com/questions/2942485/psql-fatal-ident-authentication-failed-for-user-postgres)

# c# - 从 PDF 中的特定页面提取图像

> ID：10689382
> 
> 赞同：4
> 
> 时间：2012-05-21T16:58:00.877
> 
> 标签：c#, pdf, itextsharp

我想从 PDF 文件中提取图像。我尝试使用以下代码，它完美地从 PDF 中提取了 jpeg 图像。问题是如何从特定页面（例如第 1 页）或其他页面中提取图像。我不想阅读整个 PDF 来搜索图像。

有什么建议么？

提取图像的代码：

```
private void List<System.Drawing.Image> ExtractImages(String PDFSourcePath)
        {
            List<System.Drawing.Image> ImgList = new List<System.Drawing.Image>();

            iTextSharp.text.pdf.RandomAccessFileOrArray RAFObj = null;
            iTextSharp.text.pdf.PdfReader PDFReaderObj = null;
            iTextSharp.text.pdf.PdfObject PDFObj = null;
            iTextSharp.text.pdf.PdfStream PDFStremObj = null;

            try
            {
                RAFObj = new iTextSharp.text.pdf.RandomAccessFileOrArray(PDFSourcePath);
                PDFReaderObj = new iTextSharp.text.pdf.PdfReader(RAFObj, null);

                for (int i = 0; i <= PDFReaderObj.XrefSize - 1; i++)
                {
                    PDFObj = PDFReaderObj.GetPdfObject(i);

                    if ((PDFObj != null) && PDFObj.IsStream())
                    {
                        PDFStremObj = (iTextSharp.text.pdf.PdfStream)PDFObj;
                        iTextSharp.text.pdf.PdfObject subtype = PDFStremObj.Get(iTextSharp.text.pdf.PdfName.SUBTYPE);

                        if ((subtype != null) && subtype.ToString() == iTextSharp.text.pdf.PdfName.IMAGE.ToString())
                        {
                            byte[] bytes = iTextSharp.text.pdf.PdfReader.GetStreamBytesRaw((iTextSharp.text.pdf.PRStream)PDFStremObj);

                            if ((bytes != null))
                            {
                                try
                                {
                                    System.IO.MemoryStream MS = new System.IO.MemoryStream(bytes);

                                    MS.Position = 0;
                                    System.Drawing.Image ImgPDF = System.Drawing.Image.FromStream(MS);
                                    pictureBox1.Image = ImgPDF;
                                    MS.Close();
                                    MS.Flush();

                                }
                                catch (Exception)
                                {

                                }
                            }
                        }
                    }
                }
                PDFReaderObj.Close();
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }                
        } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T20:47:01.223

我目前没有可用的 iTextSharp 4.0，因此此代码针对 5.2，但它也应该适用于旧版本。这段代码几乎是[从这里的这篇文章](https://stackoverflow.com/questions/802269/itextsharp-extract-images)直接提升的，所以请查看该文章以及更多问题的回复。正如我在上面的评论中所说，您的代码正在从文档的角度查看所有图像，而我链接到的代码是逐页查看的。

请阅读另一篇文章中的所有评论，尤其是[这篇](https://stackoverflow.com/a/804392/231316)文章，它解释说这只**适用**于 JPG 图像。PDF 支持许多不同类型的图像，因此除非您知道您只处理 JPG，否则您需要添加大量代码。有关一些提示，请参阅[这篇文章](https://stackoverflow.com/a/9262339/231316)和[这篇文章](https://stackoverflow.com/a/3594027/231316)。

```
 string testFile = System.IO.Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Desktop), "Doc1.pdf");
        string outputPath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
        int pageNum = 1;

        PdfReader pdf = new PdfReader(testFile);
        PdfDictionary pg = pdf.GetPageN(pageNum);
        PdfDictionary res = (PdfDictionary)PdfReader.GetPdfObject(pg.Get(PdfName.RESOURCES));
        PdfDictionary xobj = (PdfDictionary)PdfReader.GetPdfObject(res.Get(PdfName.XOBJECT));
        if (xobj == null) { return; }
        foreach (PdfName name in xobj.Keys) {
            PdfObject obj = xobj.Get(name);
            if (!obj.IsIndirect()) { continue; }
            PdfDictionary tg = (PdfDictionary)PdfReader.GetPdfObject(obj);
            PdfName type = (PdfName)PdfReader.GetPdfObject(tg.Get(PdfName.SUBTYPE));
            if (!type.Equals(PdfName.IMAGE)) { continue; }
            int XrefIndex = Convert.ToInt32(((PRIndirectReference)obj).Number.ToString(System.Globalization.CultureInfo.InvariantCulture));
            PdfObject pdfObj = pdf.GetPdfObject(XrefIndex);
            PdfStream pdfStrem = (PdfStream)pdfObj;
            byte[] bytes = PdfReader.GetStreamBytesRaw((PRStream)pdfStrem);
            if (bytes == null) { continue; }
            using (System.IO.MemoryStream memStream = new System.IO.MemoryStream(bytes)) {
                memStream.Position = 0;
                System.Drawing.Image img = System.Drawing.Image.FromStream(memStream);
                if (!Directory.Exists(outputPath))
                    Directory.CreateDirectory(outputPath);

                string path = Path.Combine(outputPath, String.Format(@"{0}.jpg", pageNum));
                System.Drawing.Imaging.EncoderParameters parms = new System.Drawing.Imaging.EncoderParameters(1);
                parms.Param[0] = new System.Drawing.Imaging.EncoderParameter(System.Drawing.Imaging.Encoder.Compression, 0);
                var jpegEncoder = ImageCodecInfo.GetImageEncoders().ToList().Find(x => x.FormatID == ImageFormat.Jpeg.Guid);
                img.Save(path, jpegEncoder, parms);

            }
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T05:25:31.010

以下是我用来从 PDF 中提取图像的代码。它对我来说完全没问题。

```
//   Required: iTextSharp.dll

using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using iTextSharp.text.pdf.parser;
using Dotnet = System.Drawing.Image;
using iTextSharp.text.pdf;

namespace PDF_Parsing {
    partial class ExtractPdfImage
    {
        string imgPath = @"c:\extractedImg.png";
        private void ExtractImage(string pdfFile)
        {
            const int pageNumber = 1;
            PdfReader pdf = new PdfReader(pdfFile);
            PdfDictionary pg = pdf.GetPageN(pageNumber);
            PdfDictionary res =               (PdfDictionary)PdfReader.GetPdfObject(pg.Get(PdfName.RESOURCES));
            PdfDictionary xobj = (PdfDictionary)PdfReader.GetPdfObject(res.Get(PdfName.XOBJECT));
            foreach (PdfName name in xobj.Keys)
            {
                PdfObject obj = xobj.Get(name);
                if (obj.IsIndirect())
                {
                    PdfDictionary tg = (PdfDictionary)PdfReader.GetPdfObject(obj);
                    string width = tg.Get(PdfName.WIDTH).ToString();
                    string height = tg.Get(PdfName.HEIGHT).ToString();
                    ImageRenderInfo imgRI = ImageRenderInfo.CreateForXObject(new   Matrix(float.Parse(width), float.Parse(height)),
                        (PRIndirectReference)obj, tg);
                    RenderImage(imgRI);
                }
            }
        }

        private void RenderImage(ImageRenderInfo renderInfo)
        {
            PdfImageObject image = renderInfo.GetImage();
            using (Dotnet dotnetImg = image.GetDrawingImage())
            {
                if (dotnetImg != null)
                {
                    using (MemoryStream ms = new MemoryStream())
                    {
                        dotnetImg.Save(ms, ImageFormat.Tiff);
                        Bitmap d = new Bitmap(dotnetImg);
                        d.Save(imgPath);
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T05:39:39.843

以下代码可以很好地从特定页面中提取图像。

```
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using iTextSharp.text.pdf.parser;
using Dotnet = System.Drawing.Image;
using iTextSharp.text.pdf;
namespace PDF_Parsing
{
  partial class PDF_ImgExtraction
  {
    string imgPath;
    private void ExtractImage(string pdfFile)
    {
      const int pageNumber = 1;//Page number to extract the image from
      PdfReader pdf = new PdfReader(pdfFile);
      PdfDictionary pg = pdf.GetPageN(pageNumber);
      PdfDictionary res = (PdfDictionary)PdfReader.GetPdfObject(pg.Get(PdfName.RESOURCES));
      PdfDictionary xobj = (PdfDictionary)PdfReader.GetPdfObject(res.Get(PdfName.XOBJECT));
      foreach (PdfName name in xobj.Keys)
      {
        PdfObject obj = xobj.Get(name);
        if (obj.IsIndirect())
        {
          PdfDictionary tg = (PdfDictionary)PdfReader.GetPdfObject(obj);
          string width = tg.Get(PdfName.WIDTH).ToString();
          string height = tg.Get(PdfName.HEIGHT).ToString();
          ImageRenderInfo imgRI = ImageRenderInfo.CreateForXObject(new Matrix(float.Parse(width), float.Parse(height)), (PRIndirectReference)obj, tg);
          RenderImage(imgRI);
        }
      }
    }
    private void RenderImage(ImageRenderInfo renderInfo)
    {
      PdfImageObject image = renderInfo.GetImage();
      using (Dotnet dotnetImg = image.GetDrawingImage())
      {
        if (dotnetImg != null)
        {
          using (MemoryStream ms = new MemoryStream())
          {
            dotnetImg.Save(ms, ImageFormat.Tiff);
            Bitmap d = new Bitmap(dotnetImg);
            d.Save(imgPath);
          }
        }
      }
    }
  }
} 
```

# php - 使用 PHP 从 HTML 表中读取数据

> ID：10689387
> 
> 赞同：2
> 
> 时间：2012-05-21T16:58:32.813
> 
> 标签：php, html, web-scraping, html-table, scripting

最近我有一个问题，我想做的是从 HTML 表中读取数据并将数据抓取到一个名为`$id`. 例如我有这个代码：

```
<tr>
<td>413</td>
<td>Party Hat</td>
<td>0</td>
<td>No</td>
<td><a href="http://clubpenguincheatsnow.com/tools/swfviewer/items.swf?id=413">View SWF</a></td>
</tr> 
```

我想要做的是另一个名为的变量`$array[$i]`正在保存一个搜索查询。我希望我的 PHP 代码在表格中搜索，直到找到包含特定查询的部分。在这种情况下是“派对帽”。我希望它在找到查询后做的是查看 ID，它是名称“Party Hat”上方的“td”部分，在这种情况下，ID 是 413。在此之后，我希望变量 $id 到拿着身份证。我该怎么做呢？任何帮助将**不胜**感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:27:32.273

使用[Tidy](http://php.net/manual/en/book.tidy.php)、[DOMDocument](http://www.php.net/manual/en/class.domdocument.php)和[DOMXPath](http://www.php.net/manual/en/class.domxpath.php)（确保启用了 PHP 扩展），您可以执行以下操作：

```
<?php
$url = "http://example.org/test.html";

function get_data_from_table($id, $url)
{
    // retrieve the content of that url
    $content = file_get_contents($url);

    // repair bad HTML
    $tidy = tidy_parse_string($content);
    $tidy->cleanRepair();
    $content = (string)$tidy;

    // load into DOM
    $dom = new DOMDocument();
    $dom->loadHTML($content);

    // make xpath-able
    $xpath = new DOMXPath($dom);

    // search for the first td of each tr, where its content is $id
    $query = "//tr/td[position()=1 and normalize-space(text())='$id']";
    $elements = $xpath->query($query);
    if ($elements->length != 1) {
        // not exactly 1 result as expected? return number of hits
        return $elements->length;
    }

    // our td was found
    $element = $elements->item(0);

    // get his parent element (tr)
    $tr = $element->parentNode;
    $data = array();

    // iterate over it's td elements
    foreach ($tr->getElementsByTagName("td") as $td) {
        // retrieve the content as text
        $data[] = $td->textContent;
    }

    // return the array of <td> contents
    return $data;
}

echo '<pre>';
print_r(
    get_data_from_table(
        414,
        $url
    )
);
echo '</pre>'; 
```

您的 HTML 源代码 (http://example.org/test.html)：

```
<table><tr>
<td>413</td>
<td>Party Hat</td>
<td>0</td>
<td>No</td>
<td><a href="http://clubpenguincheatsnow.com/tools/swfviewer/items.swf?id=413">View SWF</a></td>
</tr><tr>
<td>414</td>
<td>Party Hat</td>
<td>0</td>
<td>No</td>
<td><a href="http://clubpenguincheatsnow.com/tools/swfviewer/items.swf?id=413">View SWF</a></td>
</tr> 
```

（如您所见，没有有效的 HTML，但这没关系）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T17:22:08.947

这行得通：（虽然有点难看，也许其他人可以想出更好的 xpath 解决方案）

```
$html = <<<HTML
<html>
    <body>
        <table>
            <thead>
                <tr>
                    <td>id</td>
                    <td>name</td>
                    <td>a</td>
                    <td>b</td>
                    <td>c</td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>413</td>
                    <td>Party Hat</td>
                    <td>0</td>
                    <td>No</td>
                    <td>a link</td>
                </tr>
                <tr>
                    <td>414</td>
                    <td>Party Hat 2</td>
                    <td>0</td>
                    <td>No</td>
                    <td>a link</td>
                </tr>
            </tbody>
        </table>
    </body>
</html>
HTML;

$doc = new DOMDocument();
$doc->loadHTML($html);
$domxpath = new DOMXPath($doc);

$res = $domxpath->query("//*[local-name() = 'td'][text() = 'Party Hat']/../td[position() = '1']");

var_dump($res->length, $res->item(0)->textContent); 
```

输出：

> 整数（1）
> 字符串（3）“413”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T17:01:21.690

尝试通过 loadHTML 将 html 加载到新的 DOMDocument 中，并像 XML Doc 一样使用 xpath 或其他类型的查询对其进行处理

# c# - Java 中是否有 C# Thread.CurrentThread.CurrentCulture 的替代方案？

> ID：10689388
> 
> 赞同：0
> 
> 时间：2012-05-21T16:58:35.870
> 
> 标签：c#, java, localization

`Thread.CurrentThread.CurrentCulture`Java中有没有C#的替代品？如果不是，在 Java 中存储用户选择的语言环境的最佳位置是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:20:55.243

[Locale.setDefault()](http://docs.oracle.com/javase/6/docs/api/java/util/Locale.html#setDefault%28java.util.Locale%29)为整个 JVM 设置默认语言环境，这对于客户端应用程序来说很好。对于 Web 应用程序，它不是一个有效的解决方案，但线程本地也不是，因为所有用户都使用相同的线程。在这种情况下，用户区域设置通常存储在 HTTP 会话中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:30:04.990

如果你有基于 SpringMVC 的 web 应用程序，那么有这个类`org.springframework.context.i18n.LocaleContextHolder`（[这里是 javadoc](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/context/i18n/LocaleContextHolder.html)），它可以让你访问当前的语言环境。

[在web](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/web/servlet/i18n/AcceptHeaderLocaleResolver.html)应用程序中，这可以`accept-language`根据.`DispatcherServlet`

# c++ - 浮点数的字节序

> ID：10689396
> 
> 赞同：1
> 
> 时间：2012-05-21T16:58:46.667
> 
> 标签：c++, floating-point

我想将浮点数从小端转换为大端，但无法做到。我已经成功转换了 int 数字的字节顺序，但是有人可以帮忙处理浮点数吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:23:40.353

```
#include <cstring>    // for std::memcpy
#include <algorithm>  // for std::reverse
#include <iterator>   // For C++11 std::begin() and std::end()

// converting from float to bytes for writing out
float f = 10.0;
char c[sizeof f];
std::memcpy(c,&f,sizeof f);
std::reverse(std::begin(c),std::end(c)); // begin() and end() are C++11\. For C++98 say std::reverse(c,c + sizeof f);
// ... write c to network, file, whatever ... 
```

走向另一个方向：

```
char c[] = { 41, 36, 42, 59 };
static_assert(sizeof(float) == sizeof c,"");
std::reverse(std::begin(c),std::end(c));
float f;
std::memcpy(&f,c,sizeof f); 
```

浮点值的表示是实现定义的，因此由此产生的值在不同的实现之间可能不同。也就是说，交换的 10.0 字节可能是 1.15705e-041 或其他东西，或者它可能根本不是一个有效的浮点数。

但是，任何使用 IEEE 754 的实现（大多数都这样做，并且您可以通过查看是否`std::numeric_limits<float>.is_iec559`为真来检查），应该会给您相同的结果。（`std::numeric_limits`来自`#include <limits>`。）

* * *

上面的代码将浮点数转换为字节，修改字节，然后将这些字节转换回浮点数。如果您有一些要读取为浮点数的字节值，那么您可以将 char 数组的值设置为您的字节，然后使用`memcpy()`如上所示（通过后面的行`std::reverse()`）将这些字节放入`f`.

* * *

通常人们会推荐使用 reinterpret_cast 来处理这类事情，但我认为避免强制转换是件好事。人们经常错误地使用它们并在没有意识到的情况下获得未定义的行为。在这种情况下 reinterpret_cast 可以合法使用，但我仍然认为最好避免使用它。

虽然它确实将 4 行减少到 1...

```
std::reverse(reinterpret_cast<char*>(&f),reinterpret_cast<char*>(&f) + sizeof f); 
```

这里有一个例子说明为什么你不应该使用 reinterpret_cast。以下可能会起作用，但可能会导致未定义的行为。由于它有效，您可能甚至不会注意到您做错了什么，这是可能的最不理想的结果之一。

```
char c[] = { 41, 36, 42, 59 };
static_assert(sizeof(float) == sizeof c,"");
float f = *reinterpret_cast<float*>(&c[0]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T03:50:29.560

做这些事情的正确方法是使用联合。

```
union float_int {
  float m_float;
  int32_t m_int;
}; 
```

这样您就可以将浮点数转换为整数，并且由于您已经知道如何转换整数字节序，所以一切都很好。

对于双倍，它是这样的：

```
union double_int {
  double m_float;
  int64_t m_int;
}; 
```

int32_t 和 int64_t 通常在 stdint.h 中可用，boost 提供此类，Qt 有自己的定义集。只要确保整数的大小正好等于浮点数的大小。在某些系统上，您还定义了 long double ：

```
union double_int {
  long double m_float;
  int128_t m_int;
}; 
```

如果 int128_t 不起作用，您可以像这样使用结构：

```
union long_double_int {
  long double m_float;
  struct {
    int32_t m_int_low;
    int32_t m_int_hi;
  };
}; 
```

这可能会让您认为在所有情况下，您都可以使用字节，而不是使用 int：

```
union float_int {
  float m_float;
  unsigned char m_bytes[4];
}; 
```

那时您发现不需要进行此类转换时使用的所有常用班次......因为您还可以声明：

```
union char_int {
  int m_int;
  unsigned char m_bytes[4];
}; 
```

现在你的代码看起来很简单：

```
float_int fi;
char_int ci;

fi.m_float = my_float;
ci.m_bytes[0] = fi.m_bytes[3];
ci.m_bytes[1] = fi.m_bytes[2];
ci.m_bytes[2] = fi.m_bytes[1];
ci.m_bytes[3] = fi.m_bytes[0];
// now ci.m_int is the float in the other endian

fwrite(&ci, 1, 4, f);

[...snip...]

fread(&ci, 1, 4, f);

// here ci.m_int is the float in the other endian, so restore:
fi.m_bytes[0] = ci.m_bytes[3];
fi.m_bytes[1] = ci.m_bytes[2];
fi.m_bytes[2] = ci.m_bytes[1];
fi.m_bytes[3] = ci.m_bytes[0];
my_float = fi.m_float;

// now my_float was restored from the file 
```

显然，在此示例中交换了字节顺序。如果您的程序要在 LITTLE_ENDIAN 和 BIG_ENDIAN 计算机上编译，您可能还需要知道是否确实需要进行这种交换（检查 BYTE_ENDIAN。）

# python - Django ViewDoesNotExist 错误

> ID：10689397
> 
> 赞同：0
> 
> 时间：2012-05-21T16:58:47.633
> 
> 标签：python, django

`ViewDoesNotExist`我刚刚迁移到不同的操作系统，并且在复制我完美运行的 django 项目后，我在尝试加载管理页面时遇到了错误。

我删除了`urls.py`文件中指向有问题的视图函数的行，但是 django 只是抱怨它上面的 url 指向的视图，所以我删除了它，不高兴:(。我最终删除了所有项目的 url从`logs`url 让它运行管理页面

```
Environment:

Request Method: GET
Request URL: http://localhost:8000/admin/

Django Version: 1.4
Python Version: 2.7.3
Installed Applications:
('django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'django.contrib.admin',
 'django.contrib.admindocs',
 'south',
 'uni_form',
 'treebeard',
 'dojango',
 'item',
 'letter')
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware',
 'clientms.middleware.EnforceLoginMiddleware',
 'dojango.middleware.DojoCollector')

Traceback:
File "/usr/local/lib/python2.7/dist-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/contrib/admin/sites.py" in wrapper
  213\.                 return self.admin_view(view, cacheable)(*args, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/utils/decorators.py" in _wrapped_view
  91\.                     response = view_func(request, *args, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/views/decorators/cache.py" in _wrapped_view_func
  89\.         response = view_func(request, *args, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/contrib/admin/sites.py" in inner
  196\.             return view(request, *args, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/views/decorators/cache.py" in _wrapped_view_func
  89\.         response = view_func(request, *args, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/contrib/admin/sites.py" in index
  353\.                             model_dict['admin_url'] = reverse('admin:%s_%s_changelist' % info, current_app=self.name)
File "/usr/local/lib/python2.7/dist-packages/django/core/urlresolvers.py" in reverse
  447\.                 app_list = resolver.app_dict[ns]
File "/usr/local/lib/python2.7/dist-packages/django/core/urlresolvers.py" in app_dict
  290\.             self._populate()
File "/usr/local/lib/python2.7/dist-packages/django/core/urlresolvers.py" in _populate
  253\.                     for name in pattern.reverse_dict:
File "/usr/local/lib/python2.7/dist-packages/django/core/urlresolvers.py" in reverse_dict
  276\.             self._populate()
File "/usr/local/lib/python2.7/dist-packages/django/core/urlresolvers.py" in _populate
  265\.                 lookups.appendlist(pattern.callback, (bits, p_pattern, pattern.default_args))
File "/usr/local/lib/python2.7/dist-packages/django/core/urlresolvers.py" in callback
  216\.         self._callback = get_callable(self._callback_str)
File "/usr/local/lib/python2.7/dist-packages/django/utils/functional.py" in wrapper
  27\.         result = func(*args)
File "/usr/local/lib/python2.7/dist-packages/django/core/urlresolvers.py" in get_callable
  101\.                     (lookup_view, mod_name))

Exception Type: ViewDoesNotExist at /admin/
Exception Value: Could not import letter.views.import_uploader. View does not exist in module letter.views. 
```

`setting.py`

```
# Django settings for clientms project.

import os

DEBUG = True
TEMPLATE_DEBUG = DEBUG

ADMINS = (
    # ('Your Name', 'your_email@example.com'),
)

# TODO: replace all case of 'if something:' with 'if something is None:'

MANAGERS = ADMINS

DATABASES = {
    'default': {
    'ENGINE': 'django.db.backends.postgresql_psycopg2', # Add 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
    'NAME': 'xxxx',              # Or path to database file if using sqlite3.
    'USER': 'xxxx',         # Not used with sqlite3.
    'PASSWORD': 'xxxx',     # Not used with sqlite3.
    'HOST': 'localhost',                      # Set to empty string for localhost. Not used with sqlite3.
    'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
    }
}

SITE_URL = 'http://localhost:8000'

# Local time zone for this installation. Choices can be found here:
# http://en.wikipedia.org/wiki/List_of_tz_zones_by_name
# although not all choices may be available on all operating systems.
# On Unix systems, a value of None will cause Django to use the same
# timezone as the operating system.
# If running in a Windows environment this must be set to the same as your
# system time zone.
TIME_ZONE = 'Europe/London'

COUNTRY_CODE = '+44'
USER_VARIABLES = 'bool1','bool2','bool3','bool4','bool5','int1','int2','float1','float2','float3','date1','date2','string1','string2'
# TODO: this should be used with the item history for 'client', 'file', 'alarm', 'communication' and 'letters' in the item view
SHORT_HISTORY_LENGTH = 5
LETTER_EDITOR_HEIGHT = 400  # Height of the editor for letters and templated letters

# TODO: Make sure english dates work when deployed (???)

# Language code for this installation. All choices can be found here:
# http://www.i18nguy.com/unicode/language-identifiers.html
LANGUAGE_CODE = 'en-gb'
#DATE_INPUT_FORMATS = ('%d-%m-%Y','%Y-%m-%d')

SITE_ID = 1
SITE_ROOT = os.path.realpath(os.path.dirname(__file__))

# If you set this to False, Django will make some optimizations so as not
# to load the internationalization machinery.
USE_I18N = False

# If you set this to False, Django will not format dates, numbers and
# calendars according to the current locale
USE_L10N = True
NUMBER_GROUPING = 3
THOUSAND_SEPARATOR = ','
USE_THOUSANDS_SEPARATOR =True

# Absolute filesystem path to the directory that will hold user-uploaded files.
# Example: "/home/media/media.lawrence.com/media/"
MEDIA_ROOT = ( os.path.join(SITE_ROOT, 'static/files'))

# URL that handles the media served from MEDIA_ROOT. Make sure to use a
# trailing slash.
# Examples: "http://media.lawrence.com/media/", "http://example.com/media/"
MEDIA_URL = SITE_URL+'/files/'

# Absolute path to the directory static files should be collected to.
# Don't put anything in this directory yourself; store your static files
# in apps' "static/" subdirectories and in STATICFILES_DIRS.
# Example: "/home/media/media.lawrence.com/static/"
STATIC_ROOT = ( os.path.join(SITE_ROOT, 'static/static'))

# URL prefix for static files.
# Example: "http://media.lawrence.com/static/"
STATIC_URL = '/static/'

# URL prefix for admin static files -- CSS, JavaScript and images.
# Make sure to use a trailing slash.
# Examples: "http://foo.com/static/admin/", "/static/admin/".
ADMIN_MEDIA_PREFIX = '/static/admin/'

# Additional locations of static files
STATICFILES_DIRS = (
    # Put strings here, like "/home/html/static" or "C:/www/django/static".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
    #( os.path.join(SITE_ROOT, 'static/static')),
)

# List of finder classes that know how to find static files in
# various locations.
STATICFILES_FINDERS = (
    'django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder',
#    'django.contrib.staticfiles.finders.DefaultStorageFinder',
)

# Make this unique, and don't share it with anybody.
SECRET_KEY = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'

# List of callables that know how to import templates from various sources.
TEMPLATE_LOADERS = (
    'django.template.loaders.filesystem.Loader',
    'django.template.loaders.app_directories.Loader',
#     'django.template.loaders.eggs.Loader',
)

MIDDLEWARE_CLASSES = (
    # Common
    'django.middleware.common.CommonMiddleware',
    # Session
    'django.contrib.sessions.middleware.SessionMiddleware',
    #'django.middleware.csrf.CsrfViewMiddleware',
    # Authentication
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    # Mesages (deep phython I think!)
    'django.contrib.messages.middleware.MessageMiddleware',
    # Force Login
    'clientms.middleware.EnforceLoginMiddleware',
    # Dojango Form stuff
    'dojango.middleware.DojoCollector',
)

LOGIN_URL = '/log/in/'

PUBLIC_URLS = (
    r'log/in/',
    r'admin/',
    r'static/',
    r'dojango/dojo-media/',
    r'dojango/test/',
)

ROOT_URLCONF = 'clientms.urls'

TEMPLATE_DIRS = (
    # Put strings here, like "/home/html/django_templates" or "C:/www/django/templates".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
    '/home/arthur/Software/django/clientms/login/templates',
    '/home/arthur/Software/django/clientms/ajaxuploader/templates',
    '/home/arthur/Software/django/clientms/item/templates',
    '/home/arthur/Software/django/clientms/letter/templates',
)

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    # Uncomment the next line to enable the admin:
    'django.contrib.admin',
    # Uncomment the next line to enable admin documentation:
    'django.contrib.admindocs',
    'south',
    'uni_form',
    'treebeard',
    'ajaxuploader',
    'dojango',
    'item',
    'letter',
)

# A sample logging configuration. The only tangible logging
# performed by this configuration is to send an email to
# the site admins on every HTTP 500 error.
# See http://docs.djangoproject.com/en/dev/topics/logging for
# more details on how to customize your logging configuration.
LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'handlers': {
    'mail_admins': {
        'level': 'ERROR',
        'class': 'django.utils.log.AdminEmailHandler'
    }
    },
    'loggers': {
    'django.request': {
        'handlers': ['mail_admins'],
        'level': 'ERROR',
        'propagate': True,
    },
    }
} 
```

`urls.py`

```
from django.conf.urls.defaults import patterns, include, url
from django.contrib.staticfiles.urls import staticfiles_urlpatterns

# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    # Examples:
    # url(r'^$', 'clientms.views.home', name='home'),
    # url(r'^clientms/', include('clientms.foo.urls')),
    url(r'^$', 'page.views.main_view'),
    url(r'^settings/', include('clientms.page.urls_settings')),
    url(r'^countries/$', 'page.views.test_countries'),
    url(r'^home/$', 'page.views.home_view'),
    url(r'^item/', include('clientms.item.item_urls')),
    url(r'^letter/', include('clientms.letter.urls')),

    # Uncomment the admin/doc line below to enable admin documentation:
    url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

    # Uncomment the next line to enable the admin:
    url(r'^admin/', include(admin.site.urls)),

    #url(r'^dojango/', include('dojango.urls')),
    # Logs you in and out of the app
    url(r'^log/', include('login.urls')),
)

# DEVELOPMENT ONLY !!!
urlpatterns += staticfiles_urlpatterns() 
```

为什么 django 会抱怨在项目中找不到任何视图？（这不是权限问题 [chmod]）

额外：错误页面中的任何内容都指向我的任何文件（只是django `core`、`contrib`和）`views``utils`

EXTRA！：在我加载时，`localhost:8000`我得到了不同的注释

```
[21/May/2012 17:55:43] "GET /static/messages/messages.css HTTP/1.1" 304 0
[21/May/2012 17:55:43] "GET /static/tiny_mce/tiny_mce.js HTTP/1.1" 304 0
[21/May/2012 17:55:43] "GET /static/jquery-1.7.2.min.js HTTP/1.1" 304 0
[21/May/2012 17:55:43] "GET /static/ajaxuploader/js/fileuploader.js HTTP/1.1" 404 1697
[21/May/2012 17:55:43] "GET /static/ajaxuploader/css/fileuploader.css HTTP/1.1" 404 1703
[21/May/2012 17:55:43] "GET /dojango/dojo-media/1.6.1/dojo/dojo.js HTTP/1.1" 404 3424
[21/May/2012 17:55:43] "GET /dojango/dojo-media/1.6.1/dojango/dojango.js HTTP/1.1" 404 3442
[21/May/2012 17:55:43] "GET /dojango/dojo-media/1.6.1/dijit/themes/claro/claro.css HTTP/1.1" 404 3472
[21/May/2012 17:55:43] "GET /dojango/dojo-media/1.6.1/dojo/resources/dojo.css HTTP/1.1" 404 3457
[21/May/2012 17:55:43] "GET /dojango/dojo-media/1.6.1/dojox/form/resources/FileInput.css HTTP/1.1" 404 3490
[21/May/2012 17:55:43] "GET /dojango/dojo-media/1.6.1/dojo/dojo.js HTTP/1.1" 404 3424
[21/May/2012 17:55:43] "GET /dojango/dojo-media/1.6.1/dojango/dojango.js HTTP/1.1" 404 3442
[21/May/2012 17:55:43] "GET /static/ajaxuploader/js/fileuploader.js HTTP/1.1" 404 1697
[21/May/2012 17:55:43] "GET /static/ajaxuploader/css/fileuploader.css HTTP/1.1" 404 1703 
```

所有文件夹都具有相同的权限，所以我不知道为什么它会加载一些静态文件而不是其他文件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T19:15:56.487

我能想到的一件事是 Django 1.4 中更改的文件夹结构，如果您来自 Django 1.3，请确保在安装 1.4 之前卸载 1.3 时删除 /usr/local/bin/django-admin.py . 由于安装冲突，我在 munged 文件夹结构和错误的 python 路径方面遇到了类似的问题。我做的一个有点脏的解决方案是在 1.4 中创建一个新项目，然后将旧安装中的文件复制到新的文件夹结构中，除了我留在它的位置的新 manage.py。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T18:26:29.103

很可能这里唯一的区别是您的环境。您的静态媒体将继续加载，因为它在文件系统上的相对位置和 django 知道在哪里查找（与模板相同）。它是动态的（或在您的 settings.py 中明确引用）

您可能缺少的是 PYTHONPATH 中的 django 项目

```
export PYTHONPATH=/path/to/django/project:$PYTHONPATH 
```

# architecture - 计算页面和页表的大小

> ID：10689399
> 
> 赞同：0
> 
> 时间：2012-05-21T16:58:55.650
> 
> 标签：architecture, operating-system, paging, virtual-memory

物理地址为 32 位，虚拟地址分为 10 位“偏移”，2 位“字节寻址”，剩下 20 位用于标识页面。

页面和页表的大小是多少？

我相信它：

2^10 = 1024。

保留页是 2^2 = 4

我不确定如何使用可寻址性...

再次感谢大家:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:19:18.307

让我告诉你：

在您使用的架构中，您将使用 2 ^(20 个)页面，偏移量将帮助您识别页面中的单词位置。所以页面大小是 2 ^(10)。2位可寻址性是什么？这是一个字中字节的可寻址性=>一个字中有4个字节，这2位映射到字中的字节位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T18:23:35.470

寻址机制类似于在字典中查找单词，首先找到只有第一个字母匹配的单词块，然后不断缩小。类似地，第一个 20 位定位页面，接下来的 10 位定位特定页面的字，最后 2 位定位字中的字节。

# wpf - WPF Nested Scrollviewers - 将控制权交还给父 scollviewer

> ID：10689401
> 
> 赞同：7
> 
> 时间：2012-05-21T16:59:01.720
> 
> 标签：wpf, scrollviewer

这是我的控制树的样子：

```
<window>
 <scrollviewer>
  <expander>
   <scrollviewer>
    <grid>
    </grid>
   </scrollviewer>
  </expander>
  <expander>
   <scrollviewer>
    <grid>
    </grid>
   </scrollviewer>
  </expander>
 </scrollviewer>
</window> 
```

使用鼠标滚轮，控件会自动从父滚动查看器传递到子滚动查看器，但是当我滚动到子滚动查看器的末尾时，控件不会传递回父滚动查看器。我如何实现这一目标？

扩展器、网格和滚动查看器是动态生成的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-22T19:48:23.587

我在我的应用程序中遇到了类似的问题。我通过一个依赖属性来纠正它，该属性将捕获并将事件传递给他的父母。这可以应用于任何具有滚动条的控件。但对我来说，我不需要验证它是否在卷轴的末尾发送给他的父母。您只需要在 OnValueChanged 方法中添加验证滚动是在末尾还是在顶部以发送给他的父级。

```
using System.Windows.Controls;

public static class SendMouseWheelToParent
{
   public static readonly DependencyProperty ScrollProperty
     = DependencyProperty.RegisterAttached("IsSendingMouseWheelEventToParent",
        typeof(bool),
        typeof(SendMouseWheelToParent),
        new FrameworkPropertyMetadata(OnValueChanged));

   /// <summary>
   /// Gets the IsSendingMouseWheelEventToParent for a given <see cref="TextBox"/>.
   /// </summary>
   /// <param name="control">
   /// The <see cref="TextBox"/> whose IsSendingMouseWheelEventToParent is to be retrieved.
   /// </param>
   /// <returns>
   /// The IsSendingMouseWheelEventToParent, or <see langword="null"/>
   /// if no IsSendingMouseWheelEventToParent has been set.
   /// </returns>
   public static bool? GetIsSendingMouseWheelEventToParent(Control control)
   {
       if (control == null)
           throw new ArgumentNullException("");

       return control.GetValue(ScrollProperty) as bool?;
   }

   /// <summary>
   /// Sets the IsSendingMouseWheelEventToParent for a given <see cref="TextBox"/>.
   /// </summary>
   /// <param name="control">
   /// The <see cref="TextBox"/> whose IsSendingMouseWheelEventToParent is to be set.
   /// </param>
   /// <param name="IsSendingMouseWheelEventToParent">
   /// The IsSendingMouseWheelEventToParent to set, or <see langword="null"/>
   /// to remove any existing IsSendingMouseWheelEventToParent from <paramref name="control"/>.
   /// </param>
   public static void SetIsSendingMouseWheelEventToParent(Control control, bool? sendToParent)
   {
       if (control == null)
           throw new ArgumentNullException("");

       control.SetValue(ScrollProperty, sendToParent);
   }

   private static void OnValueChanged(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)
   {
       var scrollViewer = dependencyObject as Control;
       bool? IsSendingMouseWheelEventToParent = e.NewValue as bool?;
       scrollViewer.PreviewMouseWheel -= scrollViewer_PreviewMouseWheel;

       if (IsSendingMouseWheelEventToParent != null && IsSendingMouseWheelEventToParent != false)
       {
         scrollViewer.SetValue(ScrollProperty, IsSendingMouseWheelEventToParent);
         scrollViewer.PreviewMouseWheel += scrollViewer_PreviewMouseWheel;
       }
   }

   private static void scrollViewer_PreviewMouseWheel(object sender, MouseWheelEventArgs e)
   {
       var scrollview = sender as Control;

       var eventArg = new MouseWheelEventArgs(e.MouseDevice, e.Timestamp, e.Delta);
       eventArg.RoutedEvent = UIElement.MouseWheelEvent;
       eventArg.Source = sender;
       var parent = scrollview.Parent as UIElement;
       parent.RaiseEvent(eventArg);
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-04-15T01:03:24.080

受 Janick 的回答和其他一些人的启发，我有一个实现，当内部的 ScrollViewers（包括来自 ListView、ListBox、DataGrid）滚动超过它们的顶部/底部时滚动祖先 ScrollViewers。该代码在我对一个非常相似的问题的回答中[。](https://stackoverflow.com/a/61092700/316760)

# c# - 如何通过 rs-485 串口发送和接收？

> ID：10689404
> 
> 赞同：5
> 
> 时间：2012-05-21T16:59:13.903
> 
> 标签：c#, serial-port, rs485

我想在我的 PC 和一些控制器板之间进行通信。

期望 PC 将在 RS-485 上发送板的标识符，然后它应该从板接收答案。

当我尝试接收响应时，我收到了错误的数据。

这是我的代码：

```
public void set()
    {

        SerialPort sp = new SerialPort("COM1");
        sp.Open();
        if (sp.IsOpen)
        {
            byte[] id = new byte[]{0,0,0,0,0,0,0,0,0,0};
            byte[] rec = new byte[540];
            while (!end)
            {
                sp.Write(id,0,id.Length);

                sp.Read(rec,0,rec.Length);

                //do some with rec
                //WORKING
                //do soem with rec

            }
        }
        sp.Close();
    } 
```

如果我使用 RS-232，它可以工作，但当我使用 RS-485 时就不行。

**更新 ：**

它是 RS-485 2 线。（[http://en.wikipedia.org/wiki/RS-485](http://en.wikipedia.org/wiki/RS-485)）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T04:02:27.640

我发现了问题。

```
 sp.Read(rec,0,rec.Length); 
```

`Read`是一种非阻塞方法，因此它读取缓冲区但不等待所有字节。因此，您需要使用此函数的返回值，该函数返回一个整数，其中包含可以读取的字节数。

我正在使用这个：

```
int read = 0;
int shouldRead = readData1.Length;
int len;
while (read < shouldRead )
{
    len = serialport.Read(buffer, 0, readData1.Length);
    if (len == 0)
         continue;
    Array.Copy(buffer, 0, readData1, read, len);
    read += len;
    Thread.Sleep(20);
} 
```

# sql - Microsoft Query：无法绑定多部分标识符

> ID：10689408
> 
> 赞同：1
> 
> 时间：2012-05-21T16:59:20.083
> 
> 标签：sql

我正在尝试在 Microsoft Query 中编写一个查询，它似乎是因为别名存在一些问题，但我不知道如何解决它，任何帮助将不胜感激！

```
SELECT   item."No_",
         item.Description,
         ItemLedgerEntry."Location Code",
         Sum(ItemLedgerEntry."Remaining Quantity") As Stock,
         Sum(bo."Outstanding Quantity") As BackOrder
FROM Nav50.dbo.item item, Nav50.dbo.ItemLedgerEntry ItemLedgerEntry
LEFT OUTER JOIN (   SELECT SalesLine.No_,
                    Customer.Name, SalesLine."Location Code",
                    SalesLine."Outstanding Quantity"
                    FROM Nav50.dbo.Customer Customer, Nav50.dbo.SalesLine SalesLine
                    WHERE SalesLine."Sell-to Customer No_" = Customer.No_) bo
ON ((item."No_" = bo.No_) AND (ItemLedgerEntry."Location Code" = bo."Location Code"))
WHERE item.No_ = ItemLedgerEntry."Item No_" AND ((ItemLedgerEntry."Location Code"='STHLM') AND (ItemLedgerEntry."Remaining Quantity"<>$0))
GROUP BY item."No_", item.Description, ItemLedgerEntry."Location Code" 
```

我收到的信息是：

> 无法绑定多部分标识符“item.No_”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:03:55.447

而不是使用双引号尝试使用方括号：

```
SELECT   item.[No_] 
```

已使用`JOIN`语法而不是表之间的逗号更新的完整查询。

```
SELECT   item.[No_],
         item.Description,
         ItemLedgerEntry.[Location Code],
         Sum(ItemLedgerEntry.[Remaining Quantity]) As Stock,
         Sum(bo.[Outstanding Quantity]) As BackOrder
FROM Nav50.dbo.item item
LEFT JOIN Nav50.dbo.ItemLedgerEntry ItemLedgerEntry
    ON item.[No_] = ItemLedgerEntry.[Item No_] 
LEFT OUTER JOIN 
(   
    SELECT SalesLine.[No_],
           Customer.Name, 
           SalesLine.[Location Code],
           SalesLine.[Outstanding Quantity]
    FROM Nav50.dbo.Customer Customer
    LEFT JOIN Nav50.dbo.SalesLine SalesLine
        ON SalesLine.[Sell-to Customer No_] = Customer.[No_]
) bo
    ON ((item.[No_] = bo.[No_]) 
        AND (ItemLedgerEntry.[Location Code] = bo.[Location Code]))
WHERE ((ItemLedgerEntry.[Location Code]='STHLM') 
    AND (ItemLedgerEntry.[Remaining Quantity]<>$0))
GROUP BY item.[No_], item.Description, ItemLedgerEntry.[Location Code] 
```

# html - 移动应用使用html5教程

> ID：10689409
> 
> 赞同：-1
> 
> 时间：2012-05-21T16:59:26.650
> 
> 标签：html

我是这个领域的新手，想学习使用 html5 进行移动应用程序开发。任何人都可以帮助我提供一些有用的教程或链接来学习这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T20:54:49.860

我必须推荐 phonegap 解决方案，它将帮助您构建跨设备 HTML5 应用程序，让您可以利用许多手机功能：

[phonegap api](http://docs.phonegap.com/en/1.7.0/index.html)

和

[phonegap 入门指南](http://docs.phonegap.com/en/1.7.0/guide_getting-started_index.md.html#Getting%20Started%20Guides)

# java - 通过 JMS 接收 Java 对象

> ID：10689410
> 
> 赞同：4
> 
> 时间：2012-05-21T16:59:32.827
> 
> 标签：java, object, jms, message, pojo

这真的是使用 JMS 接收 POJO 的方式吗？

```
public void onMessage(Message msg) {
     ObjectMessage objMsg = (ObjectMessage) msg;
     if(objMsg.getObject() instanceof <<sometype>>) {
        //do something 
     }
 } 
```

我是否必须强制转换为 ObjectMessage。实际上，我必须检查 msg 是否也可以转换为 ObjectMessage。

还是我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:33:32.610

引用[JMS Spring Doc](http://static.springsource.org/spring/docs/2.5.x/reference/jms.html)中的示例，正​​如您从示例中看到的那样，我们需要检查消息是否属于 TextMessage 类型，因此在您的情况下类似地，我们必须检查强制转换或检查您的对象是否是消息类型的实例，所以你有两种方法，希望这能澄清你的问题。

**例子**

```
import javax.jms.JMSException;
import javax.jms.Message;
import javax.jms.MessageListener;
import javax.jms.TextMessage;

public class ExampleListener implements MessageListener {

    public void onMessage(Message message) {
        if (message instanceof TextMessage) {
            try {
                System.out.println(((TextMessage) message).getText());
            }
            catch (JMSException ex) {
                throw new RuntimeException(ex);
            }
        }
        else {
            throw new IllegalArgumentException("Message must be of type TextMessage");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:35:02.987

AFAIK，就是这样。但是，在单个目标（队列或主题）中混合不同的消息类型和消息内的不同对象类型是非常罕见的。因此，如果您知道只需要包含 SomeType 对象的 ObjectMessages，则可以跳过 instanceof 检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T17:43:38.720

是的，您可能想检查一些例外情况。但是，使用 spring（以及 apache camel 等框架），您可以很容易地连接一个简单地处理某个类的对象的 bean。这可能值得也可能不值得开销和增加配置的复杂性以简化代码。

查看这篇文章的几页以获得描述：[http ://www.wmrichards.com/mdp.pdf](http://www.wmrichards.com/mdp.pdf)

# android - 在 xml drawable 中绘制多个矩形

> ID：10689412
> 
> 赞同：6
> 
> 时间：2012-05-21T16:59:49.727
> 
> 标签：android, drawable

我试图弄清楚如何在 android xml drawable 中创建一个 3x3 行的小矩形。
这并没有真正让我接近（2个小矩形，但它们重叠）：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:left="20dp" android:top="20dp" android:right="25dp" android:bottom="25dp" >
        <shape android:shape="rectangle">
            <stroke android:width="1px" android:color="#fff" />
            <solid android:color="#00FF0000" />
            <corners android:radius="3dp" />
        </shape>
    </item>

    <item android:left="30dp" android:top="30dp" android:right="35dp" android:bottom="25dp" >
    <shape android:shape="rectangle">
            <stroke android:width="1px" android:color="#fff" />
            <solid android:color="#00FF0000" />
            <corners android:radius="3dp" />
            <size android:width="10dp"
                  android:height="10dp"/>
        </shape>
    </item>

</layer-list> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T17:17:25.937

部分问题是图层列表中的各个项目被缩放到可绘制对象的整体大小。如[文档中所述](http://developer.android.com/guide/topics/resources/drawable-resource.html#LayerList)，您可以通过将小方块包装在`bitmap`可绘制对象中来解决此问题。这样的事情可能会奏效。首先，将基本形状定义为单独的可绘制对象：

 ~~**可绘制/square.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <stroke android:width="1px" android:color="#fff" />
    <solid android:color="#00FF0000" />
    <corners android:radius="3dp" />
    <size android:width="10dp" android:height="10dp"/>
</shape> 
```

 ~~（编辑：如果您可以执行上述操作会很好，但不幸的是，正如@Someone Somewhere 在评论中指出的那样，您无法从`<bitmap>`标签内引用形状可绘制对象。您必须将正方形创建为其余部分工作的实际位图图形。）

然后你可以定义一个不会缩放单个方块的图层列表：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <!-- first row -->
    <item android:left="20dp" android:top="20dp">
        <bitmap android:src="@drawable/square" android:gravity="top|left" />
    </item>
    <item android:left="35dp" android:top="20dp">
        <bitmap android:src="@drawable/square" android:gravity="top|left" />
    </item>
    <item android:left="50dp" android:top="20dp">
        <bitmap android:src="@drawable/square" android:gravity="top|left" />
    </item>

    <!-- second row -->
    <item android:left="20dp" android:top="35dp">
        <bitmap android:src="@drawable/square" android:gravity="top|left" />
    </item>
    <item android:left="35dp" android:top="35dp">
        <bitmap android:src="@drawable/square" android:gravity="top|left" />
    </item>
    <item android:left="50dp" android:top="35dp">
        <bitmap android:src="@drawable/square" android:gravity="top|left" />
    </item>

    <!-- third row -->
    <item android:left="20dp" android:top="50dp">
        <bitmap android:src="@drawable/square" android:gravity="top|left" />
    </item>
    <item android:left="35dp" android:top="50dp">
        <bitmap android:src="@drawable/square" android:gravity="top|left" />
    </item>
    <item android:left="50dp" android:top="50dp">
        <bitmap android:src="@drawable/square" android:gravity="top|left" />
    </item>
</layer-list> 
```

我还没有测试过这个，所以它可能有点偏离，但你应该能够调整它以获得你想要的。重要的是摆脱缩放。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:07:54.633

请参阅[图层列表的文档](http://developer.android.com/guide/topics/resources/drawable-resource.html#LayerList)。

它将清除`top`、`left`和是项目偏移量`bottom`的**维度**`right`属性：项目本身应放置在距其父级（图层列表）边界多远的位置。

 **如果您知道您的图层列表是 130 dp 宽和 130 dp 高，并且您想要 3x3 矩形，那么第一个的偏移量应该是

```
top: 10
left: 10
bottom: 90
right: 90 
```

和下一个（第一行，第二列）：

```
top: 10
left: 50
bottom: 90
right: 50 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T13:02:04.007

正如讨论已经揭示的那样，使用位图仅限于真实位图；此处不能使用其他 (XML) 可绘制对象。

ScaleDrawables 应该是适合您的解决方案。它们应该提供您需要在生成的边界框中调整其位置的属性。

然而，ScaleDrawables 的缺点是它们是为动画设计的。它们似乎以 0 级别开始，这使得它们看起来很小。此外，似乎无法在 XML 中设置级别。

如果您可以在代码中为 ScaleDrawables 设置级别，请尝试一下。

另外，请参阅[这个问题](https://stackoverflow.com/questions/8351271/android-layer-list-does-not-show-scale-drawable-item/ "这个问题")。**~~~~

# php - 正则表达式不包括表达式

> ID：10689413
> 
> 赞同：0
> 
> 时间：2012-05-21T16:59:54.637
> 
> 标签：php, regex

我正在使用正则表达式来获取
格式为**www.example.com/abc/def/xyz**
的 URL， 所以我使用了正则表达式“abc/def/.*?”
，但这也以
**www.example 格式获取 URL。 com/abc/def/xyz/Some_url**

如何获取在 xyz 级别之后不包含任何子级别的 URL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:02:41.830

您可以使用[否定字符类](http://www.regular-expressions.info/charclass.html#negated)排除剩余字符中的斜线：

```
"#abc/def/[^/]*? #" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:03:19.487

就像是：

```
abc/def/[^/]*$ 
```

确保在结尾之前`$`没有`/`字符。

# html - 输入文本值

> ID：10689424
> 
> 赞同：0
> 
> 时间：2012-05-21T17:01:06.400
> 
> 标签：html, forms, input

好的，就是这样...我需要提交一个表单，用户在输入框中输入信息，但该值还有其他文本。

例如：用户 - 输入**123**值是 - www.helloneed **123** help.com 提交

来自 url 的 123 是用户输入的内容

这是我的代码：

```
<form name="postcode" method="post" action="location.html">
<input type="text" name="post" id="post" required="required"  maxlength="8" />
<input type="submit" name="submit" value="submit" class="submit" />
</form> 
```

有任何想法吗？谢拉兹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:14:48.517

不需要 jQuery，直接使用 JavaScript。

在表单 HTML 之后直接添加以下内容：

```
<script>
document.forms.postcode.onsubmit = function(){    
    this.post.value = 'www.helloneed' + this.post.value + 'help.com';
    alert(this.post.value);
}​
</script> 
```

小提琴：http: [//jsfiddle.net/iambriansreed/ZeKUq/](http://jsfiddle.net/iambriansreed/ZeKUq/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T06:22:40.160

只需在输入标签中添加“onclick”事件并在那里编写 javascript 代码。

```
<input type="submit" name="submit" value="submit" class="submit" onclick="post.value='www.helloneed' + post.value + 'help.com';" /> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-21T17:11:32.637

您可以尝试在输入框的值中添加和附加文本。

例如 onsubmit="$('#post').val('http://www.helloneed' + $('#post').val() + 'help.com');

这可能有效：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<form name="postcode" method="post" action="location.html" onsubmit="$('#post').val('http://www.helloneed' + $('#post').val() + 'help.com'); return false">
<input type="text" name="post" id="post" required="required"  maxlength="8" />
<input type="submit" name="submit" value="submit" class="submit" />
</form> 
```

（在您的第一次测试之后，我会删除返回的错误文本）

安德鲁

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-21T17:24:04.080

在 HTML 中无法做到这一点。此类问题应在服务器端处理。

正如 iambriansreed 的回答中所述，在 JavaScript 中执行此操作很容易，但在服务器端执行此操作同样简单且更加健壮。在这种情况下，甚至不需要在客户端执行此操作；它只会使事情复杂化，因为服务器端代码无法直接知道它得到了什么（直接用户输入与启用时由客户端 JavaScript 修改的输入）。

# linux - Cuda 驱动程序调用返回错误 1 (cudaErrorMissingConfiguration)

> ID：10689426
> 
> 赞同：0
> 
> 时间：2012-05-21T17:01:13.703
> 
> 标签：linux, cuda, driver

我正在尝试使用 dlsym 在运行时加载 cuda 驱动程序 api 函数，但遇到了一个奇怪的错误。我的代码可以在我的系统上顺利运行（使用 nvcc 等编译）：

```
#include <cuda.h>
#include <stdio.h>

int main(int argc,char *argv[]){

  if(argc<3){
    printf("Usage: ./test.cu <ptx_file> <cuda_device>\n");
    exit(0);
  }

  // Error code
  CUresult error;

  // My number
  unsigned int h_var=7;

  // Initialize driver API
  error = cuInit(0);
  if((int)error!=0){
    printf("Error! cuInit returned: %d\n",(int)error); 
    exit(0);
  }

  // Get Cuda Device and give handle
  CUdevice cu_device;
  error = cuDeviceGet(&cu_device,atoi(argv[2]));
  if((int)error!=0){
    printf("Error! cuDeviceGet returned: %d\n",(int)error);
    exit(0);
  }

  // Create context to run on device 
  CUcontext cu_context;
  error = cuCtxCreate(&cu_context, 0, cu_device);
  if((int)error!=0){
    printf("Error! cuCtxCreate returned: %d\n",(int)error);
    exit(0);
  }

  // Load ptx code
  CUmodule cu_module;
  error = cuModuleLoad(&cu_module,argv[1]);
  if((int)error!=0){
    printf("Error! cuModuleLoad returned: %d\n",(int)error);
    exit(0);
  }

  // Get kernel function
  CUfunction func;
  error = cuModuleGetFunction(&func,cu_module,"testing"); 
  if((int)error!=0){
    printf("Error! cuModuleGetFunction returned: %d\n",(int)error);
    exit(0);
  }

  CUdeviceptr var;

  // Allocate device memory
  unsigned int size = sizeof(unsigned int);
  error = cuMemAlloc(&var, size);
  if((int)error!=0){
    printf("Error! cuMemAlloc returned: %d\n",(int)error);
    exit(0);
  }

  // Copy variable to host
  error = cuMemcpyHtoD(var,&h_var,size);
  if((int)error!=0){
    printf("Error! cuMemcpyHtoD returned: %d\n",(int)error);
    exit(0);
  }

  // Lauch kernel
  void *args[] = {&var};
  error = cuLaunchKernel(func, 1, 1, 1, 1, 1, 1, 0, NULL, args, NULL);
  if((int)error!=0){
    printf("Error! cuLaunchKernel returned: %d\n",(int)error);
    exit(0);
  }

  // Get result to host
  error = cuMemcpyDtoH(&h_var,var,size);
  if((int)error!=0){
    printf("Error! cuMemcpyDtoH returned: %d\n",(int)error);
    exit(0);
  }

  // Free device memory
  error = cuMemFree(var);
  if((int)error!=0){
    printf("Error! cuMemFree returned: %d\n",(int)error);
    exit(0);
  }

  // Destroy context
  error = cuCtxDestroy(cu_context);
  if((int)error!=0){
    printf("Error! cuCtxDestroy returned: %d\n",(int)error);
    exit(0);
  }

  // Print result
  printf("var: %d\n",h_var);
} 
```

使用我编写的 ptx 代码：（这是一个简单的添加，只是为了测试它是否有效）

.version 1.4 .target sm_10, map_f64_to_f32

```
.entry testing (
  .param .u64 mynum)
{

  .reg .u64 %r;
  .reg .u64 %i;
  ld.param.u64 %r,[mynum];
  ld.global.u64 %i,[%r];
  add.u64 %i,%i,3;
  st.global.u64 [%r+0],%i;
  exit;

} 
```

到现在为止还挺好。然后我获取代码并使用 dlsym 加载每个函数，如下所示：

```
 /* Lauch kernel */
  void *args[] = {&var};
  int (*_cuLaunchKernel)( void *, unsigned int, unsigned int, unsigned int, unsigned int, unsigned int, unsigned int, unsigned int, void *, void **, void ** );
  *(void **)(&_cuLaunchKernel) = dlsym(dlhandle, "cuLaunchKernel");
  (*_cuLaunchKernel)(cu_func,1 , 1, 1, 1, 1, 1, 0, NULL, args, NULL);

 /* Get result to host  */
  int (*_cuMemcpyDtoH)( void *, void *, size_t );
  *(void **)(&_cuMemcpyDtoH) = dlsym(dlhandle, "cuMemcpyHtoD");
  error = (*_cuMemcpyDtoH)(&h_var,var,size); 
```

（其余代码的逻辑相同）。我所有的函数都返回 0，这意味着一切正常，除了最后一个 _cuMemcpyDtoH ，它返回错误 1 ​​( = cudaErrorMissingConfiguration )。有人可以解释这个错误是什么意思，为什么会发生？有没有办法解决它？为什么当我在运行时加载函数时它会出现？

谢谢。

我的系统：nvcc 版本 4.1 GPU：GTX 480 NVRM 版本：NVIDIA UNIX x86_64 内核模块 285.05.32 GCC 版本：gcc 版本 4.5.2（Ubuntu/Linaro 4.5.2-8ubuntu4）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:20:54.927

对于您正在使用的驱动程序 API，错误代码 1 表示`CUDA_ERROR_INVALID_VALUE`

这个错误的原因是：

```
*(void **)(&_cuMemcpyDtoH) = dlsym(dlhandle, "cuMemcpyHtoD"); 
```

--- 您正在尝试使用错误的功能：`HtoD`而不是`DtoH`.

# java - Jibx 生成 toString 方法

> ID：10689428
> 
> 赞同：0
> 
> 时间：2012-05-21T17:01:19.660
> 
> 标签：java, maven, tostring, jibx

我目前正在使用 Jibx maven 插件从定义的模式中对 Java POJOS 进行代码生成。代码生成得很好，但我想要的是也生成 toString 方法。当我从 Schema 到 Classes 往返时，我无法手动定义 toString 方法，因为当我重新生成时它会被覆盖。而且我不想仅为 toString 方法创建一个包装类。

是否有一个标志选项或某处说我想要生成 toString 方法？？？我在网上查看了 Jibx 文档，但找不到对上述问题的直接简单答案。

任何帮助将不胜感激。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T06:02:43.747

user983022，
在 JiBX 中没有自动将代码添加到生成的 java 类的方法，但是......
您有几个选项来解决这个问题：

1.  覆盖您生成的类并添加 toString() 方法。（最简单）
2.  手动修改生成的代码，然后与 JiBX 绑定。（如果将来架构发生变化，则中断）
3.  在代码生成和绑定步骤之间添加一个 maven 插件来修改源代码。我确信有一个类似 sed 的插件可以做到这一点......如果没有，它会很容易编写。（你必须找到/编写一个可以做到这一点的插件）

我希望这有帮助！

Don
JiBX Maven 插件作者

# jquery - CSS 文件中的硬编码 URL

> ID：10689430
> 
> 赞同：2
> 
> 时间：2012-05-21T17:01:23.950
> 
> 标签：jquery, asp.net, html, css, asp.net-mvc

我正在处理的项目在 CSS 文件中有硬编码的 URL，如下所示：

```
a.edit
{
    background: url(/TestSite/Images/Edit.png) no-repeat top left;
    display: inline-block;
    width: 16px;
    height: 16px;
    padding:1px;
    margin:1px;
    text-indent: -9999px; /* hides the link text */
} 
```

当站点转移到生产环境时，这些链接会中断。我正在寻找一种解决方案，因此它只适用于网站运行的任何地方。

这是我想出的，它有效，但我想知道是否有更好的方法：

```
<script>
    $(document).ready(function () {
        $("a.edit").css('background', 'url(' + $("body").data("baseurl") + 'Images/Edit.png) no-repeat top left');
    });
</script>
<body data-baseurl="~/">...</body> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T17:05:21.453

CSS 处理相对于样式表所在位置的相对 URL。利用这一点，不要在 javascript 中重写 URL。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T17:04:43.777

在生产和开发服务器上使用相同的文件夹结构。并使用相对路径

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T17:04:24.387

真的不明白你面临的问题是什么。使用相对路径而不是绝对路径，无论托管服务提供商如何，您都会很好...

顺便说一句，还有一件事要考虑 - 如果客户端关闭 javascript 怎么办？;)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T17:04:51.827

[相对 URL](https://stackoverflow.com/questions/940451/using-relative-url-in-css-file-what-location-is-it-relative-to)怎么样？

```
a.edit
{
    background: url(Images/Edit.png) no-repeat top left;
    ...
} 
```

# uibutton - UIButton setBackgroundImage 和 viewWillAppear

> ID：10689433
> 
> 赞同：0
> 
> 时间：2012-05-21T17:01:40.893
> 
> 标签：uibutton, viewwillappear

好吧，伙计们，我遇到了 UIButton 的问题，也许这很容易解决。我有一个带有 IBAction toggleMusic 的按钮，可以更改背景图像。

```
-(IBAction)toggleMusic{
    if (gameAppDelegate.playMusic) {
        gameAppDelegate.playMusic = NO;
        [menuAudioPlayer stop];
        [botaoMusic setBackgroundImage:[UIImage imageNamed:@"bt_sound_off.png"] forState:UIControlStateNormal];
        [SoundManager playSoundFile:@"botao3" Format:@"wav" InLoop:NO];

    }
    else {
        gameAppDelegate.playMusic = YES;
        [menuAudioPlayer play];
        [botaoMusic setBackgroundImage:[UIImage imageNamed:@"bt_sound_on.png"] forState:UIControlStateNormal];
        [SoundManager playSoundFile:@"botao3" Format:@"wav" InLoop:NO];

    }
} 
```

这工作正常。playmusic (bool) 是一个存储变量，所以每次我关闭应用程序然后再打开时，应用程序已经知道它是否应该播放音乐。这也工作正常。

问题是我想在应用程序打开后立即设置正确的背景图像（音乐开/关）（不仅在我单击按钮时）。所以我把下面的代码放在视图上会出现：

```
-(void)viewWillAppear:(BOOL)animated{
    if(gameAppDelegate.playMusic)
        [botaoMusic setImage:[UIImage imageNamed:@"bt_sound_on.png"] forState:UIControlStateNormal];
    else
        [botaoMusic setImage:[UIImage imageNamed:@"bt_sound_off.png"] forState:UIControlStateNormal];

} 
```

当我介绍此代码时，应用程序在视图出现时成功识别出正确的背景图像，但是当我触摸按钮时，togglemusic 停止更改按钮背景。这可能很愚蠢，但我无法弄清楚我做错了什么......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:05:10.677

我注意到的一件事是在`viewWillAppear`你打电话

```
[botaoMusic setImage:...]; 
```

而在按钮按下你打电话

```
[botaoMusic setBackgroundImage:...]; 
```

它很可能仍在运行，只是更改了视图出现时加载的任何内容的顶部图像后面的背景图像

# python - 具有默认（自动）主键的 Django 模型 - 更新与保存条目

> ID：10689434
> 
> 赞同：0
> 
> 时间：2012-05-21T17:01:47.383
> 
> 标签：python, django, primary-key

我的 models.py 包含几个字段。默认情况下，主键由 Django 自动设置。

我有一个 Django crontab，它尝试定期更新每个条目，但无法再保存。（直到最近，我还是根据这些字段之一手动设置主键。）

有人可以建议如何解决这个问题。对于每个条目，我希望能够更新每个声明的字段并在不存在时创建。

**我的印象是 save 会根据需要创建或更新**

```
class ABC(models.Model):
    init = models.CharField(max_length=6)
    last = models.CharField(max_length=20)
    fullid = models.CharField(max_length=30) <--- used to be primary_key=True

Crontab (pseudocode)
    for x in list:
        try: 
           entry = init='abc', last='def', fullid='xyz'
           entry.save()

        except: 'unable to update.' <-- I'm now hitting the except all the time. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T05:36:31.013

使用类似的东西：

```
try: 
    abc = ABC.objects.get(fullid=id) 
except ABC.DoesNotExist: 
    ABC.objects.create(params)
else:
    abc.field = value
    abc.save() 
```

永远不要使用`try: ... except: ...`，因为这样你甚至不知道里面发生了什么故障。仅捕获您知道如何处理的“等待”异常。或者，如果您希望它防弹且不可阻挡 - 至少显示捕获的异常信息。

# java - 如何使用来自不同类的信息更新 JPanel？

> ID：10689439
> 
> 赞同：0
> 
> 时间：2012-05-21T17:02:09.877
> 
> 标签：java, jpanel, listselectionlistener

我创建了以下示例源，并且想知道我需要做什么来使用 JLabel 更新我的 JPanel，该 JLabel 具有位于 JTable 中单击的行的信息。

我还想指出，这只是一个简单的示例，因为这里的一些 SO 成员对示例代码进行了相当多的改进。所以我发布这个简单的例子作为学习的一种方式

SwingTesting（主要）

```
public class SwingTesting {

    private final JFrame frame;
    private final TablePane tablePane;
    private final JSplitPane splitPane;
    private final JPanel infoPanel;
    private final JLabel infoLabel;

    public SwingTesting() {
        tablePane = new TablePane();
        infoPanel = new JPanel();
        frame = new JFrame();

        infoLabel = new JLabel();    //this is the panel i want to add the label to
        infoPanel.add(infoLabel);

        splitPane = new JSplitPane(JSplitPane.HORIZONTAL_SPLIT, tablePane, infoPanel);

        frame.add(splitPane);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new SwingTesting();
            }
        });
    }
} 
```

表格窗格

```
public class TablePane extends JPanel {

    private final JTable table;
    private final TableModel tableModel;
    private final ListSelectionModel listSelectionModel;

    public TablePane() {
        table = new JTable();
        tableModel = createTableModel();
        table.setModel(tableModel);
        table.setSelectionMode(ListSelectionModel.SINGLE_INTERVAL_SELECTION);
        table.add(table.getTableHeader(), BorderLayout.PAGE_START);
        table.setFillsViewportHeight(true); 

        listSelectionModel = table.getSelectionModel();
        table.setSelectionModel(listSelectionModel);
        listSelectionModel.addListSelectionListener(new SharedListSelectionHandler());
        table.setSelectionModel(listSelectionModel);

        this.setLayout(new GridBagLayout());

        GridBagConstraints gbc = new GridBagConstraints();
        gbc.anchor = GridBagConstraints.NORTHWEST;
        gbc.fill = GridBagConstraints.BOTH;
        gbc.gridx = 0;
        gbc.gridy = 0;
        gbc.gridheight = 1;
        gbc.gridwidth = 3;
        gbc.insets = new Insets(5, 5, 5, 5);
        gbc.ipadx = 2;
        gbc.ipady = 2;
        gbc.weightx = 1;
        gbc.weighty = 1;

        this.add(new JScrollPane(table), gbc);
    }

    private TableModel createTableModel() {
        DefaultTableModel model = new DefaultTableModel(
            new Object[] {"Car", "Color", "Year"}, 0 
        ){
            @Override public boolean isCellEditable(int row, int column) {
                return false;
            }
        };

        addTableData(model);
        return model;
    }

    private void addTableData(DefaultTableModel model) {
        model.addRow(new Object[] {"Nissan", "Black", "2007"});
        model.addRow(new Object[] {"Toyota", "Blue", "2012"});
        model.addRow(new Object[] {"Chevrolet", "Red", "2009"});
        model.addRow(new Object[] {"Scion", "Silver", "2005"});
        model.addRow(new Object[] {"Cadilac", "Grey", "2001"});
    }

    class SharedListSelectionHandler implements ListSelectionListener {

        //When selection changes i want to add a label to the panel
        //currently it just prints out the info from the selected row    
        @Override
        public void valueChanged(ListSelectionEvent e) {
            ListSelectionModel lsm = (ListSelectionModel) e.getSource();
            String contents = "";

            if(lsm.isSelectionEmpty()) {
                System.out.println("<none>");
            } else {
                int minIndex = lsm.getMinSelectionIndex();
                int maxIndex = lsm.getMaxSelectionIndex();
                for(int i = minIndex; i <= maxIndex; i++) {
                    if(lsm.isSelectedIndex(i)) {
                        for(int j = 0; j < table.getColumnCount(); j++) {
                            contents += table.getValueAt(i, j) + " ";
                        }
                    }
                }
                System.out.println(contents);
            }
        }        
    }
} 
```

所以我想知道如何从 ListSelectionListener 访问该 JPanel。我应该将面板传递给 TablePane 类吗？还是有更合适的方法来做到这一点？

另外，我的 ListSelectionListener 出于某种原因两次打印出行信息，我是否搞砸了循环？

**编辑**

```
public class TablePane extends JPanel {

    private final JTable table;
    private final TableModel tableModel;
    private final ListSelectionModel listSelectionModel;

    private final displayPanel;

    public TablePane() {
        //removed code for reading purposes
    }

    //IDE says issue with thinking displayPanel may have already been initialized
    public TablePane(JPanel panel) {
        //this();
        //displayPanel = panel;
    }

    //ListSelectionListener uses panel.add(jlabel)

} 
```

`final`起飞就这么简单吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:07:59.023

您可以将`JLabel`对象传递给`TablePane`对象（在`TablePane`的构造函数中或通过提供自定义`setLabel()`方法）。然后您可以使用`StringBuilder`创建需要在标签上进行的文本，并使用对象的内容（通过其方法）调用`setText()`标签。`StringBuilder``toString()`

我相信你打印了 everytihn 两次，因为该`valueChanged`方法被调用了两次：一次在取消选择当前行的通知上，然后再次在选择新行的通知上。

# php - 登录脚本未执行 - Bluehost

> ID：10689444
> 
> 赞同：0
> 
> 时间：2012-05-21T17:02:46.257
> 
> 标签：php, mysql, security, login, bluehost

我有以下登录脚本，当用户点击 www.msheeksproductions.com 上登录表单上的提交按钮时，该脚本会运行。出于安全原因，我已删除数据库登录信息。

```
 <?php
error_reporting(E_ALL);
        $user = '***************';
        $pass = '***************';
        $host = '***************';
        $data = '***************';
$userN=$_POST['userN'];
$passW=$_POST['passW'];

mysql_connect($host, $user, $pass)or die("Could not connect");
mysql_select_db($data)or die("Database Not Found");

$query="SELECT userID FROM sec_login WHERE Username='$userN' AND Password='passW'";
$result=mysql_query($query) or die(mysql_error());

$user=mysql_num_rows($result);
if($user==1) {
    session_register("userN");
    header("location: ../index.php");
}
else {
echo("You have entered invalid login information.");
}
}
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body>
</body>
</html> 
```

我的问题是，如果你登陆 security.php 页面，什么都不会发生。PHP 脚本似乎根本没有被执行。我不确定我是否在某处有语法错误，或者是否是我的主机帐户的配置问题。服务器使用 PHP 5.2。有谁知道 Bluehost 是否存在此类问题的已知问题？如果有编码错误，那么显然我也很想知道。我是新手，所以我可能没有做对所有事情。

另外，我试图在 index.php 文件中再次调用该变量，该文件似乎没有返回任何数据。

```
<?php $usr=$_SESSION['username']; 
echo "User Name Is: $usr"; ?> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:30:45.730

请考虑以下几点：

*   注意 SQL 注入（被 mysql_real_escape_string 阻止）；
*   谨防会话固定/劫持；
*   当心或暴力攻击；
*   请检查[http://php.net/pdo](http://php.net/pdo)以获得更好的错误处理和查询参数....

    ```
    <?php
    error_reporting(E_ALL);
    ini_set('display_errors', 1);

    if ($_SERVER['REQUEST_METHOD'] == 'POST') {
        $user = '***************';
        $pass = '***************';
        $host = '***************';
        $data = '***************';

        mysql_connect($host, $user, $pass) or die("Could not connect");
        mysql_select_db($data) or die("Database Not Found");

        $result=mysql_query("SELECT COUNT(1) FROM sec_login WHERE Username='".mysql_real_escape_string($_POST['username'])."' AND Password='".mysql_real_escape_string($_POST['password'])."'") or die(mysql_error());

        if(mysql_result($result) == 1) {
            $_SESSION['username'] = $_POST['username'];
            header("location: ../index.php");
            exit;
        } else {
            $message = 'You have failed to provide valid credentials.';
        }
    } else {
        $message = '<form method="post">
                        <input type="text" name="username" value="username" />
                        <br />
                        <input type="password" name="password" value="password" />
                        <br />
                        <input type="submit" />
                    </form>';
    }
    ?>
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
            <title>Untitled Document</title>
        </head>

        <body>
            <?php echo $message; ?>
        </body>
    </html> 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T20:27:55.857

好吧，以防有人偶然发现这一点并需要一个例子。以下是我现在用于功能登录脚本的代码：

```
<?php
session_start();
error_reporting(E_ALL);
ini_set('display_errors', 1);

if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    $user = '***********';
    $pass = '***********';
    $host = '***********';
    $data = '***********';

    mysql_connect($host, $user, $pass) or die("Could not connect");
    mysql_select_db($data) or die("Database Not Found");

    $result=mysql_query("SELECT userID FROM sec_login WHERE Username='".mysql_real_escape_string($_POST['userN'])."' AND Password='".mysql_real_escape_string($_POST['passW'])."'") or die(mysql_error());

    if(mysql_num_rows($result) == 1) {
        $_SESSION['login']=1;
        $_SESSION['username']=$_POST['userN'];
        $session= session_name() . '=' . session_id();
        header("location: ../index.php?".$session);
        exit();
    } else {
        $message = 'You have failed to provide valid credentials.';
    }
}
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Untitled Document</title>
    </head>

    <body>
        <?php echo $message; ?>
    </body>
</html> 
```

当然，连接变量省略了。为了让其他页面获取会话变量，请确保每个页面都以（在字面上的第一行代码，甚至在您的 doctype 声明之前）开始

谢谢大家的帮助！

# python - 如何从对象中删除

> ID：10689446
> 
> 赞同：0
> 
> 时间：2012-05-21T17:03:01.377
> 
> 标签：python, class, object, containers

```
import pickle

class TasksError(Exception):
    def __init__(self, value):
        self.value = value
    def __str__(self):
        return repr(self.value)

class Task(object):
    def __init__(self, task = () ):
        if task ==():
            raise TasksError('Empty task.')
        self.name = task[0]
        self.date = task[1]
        self.priority = task[2]
        self.time = task[3]
        self.type = task[4]
        self.comment = task[5]

    def __str__(self):
        output = '''Name: %s
Date: %s
Priority: %s
Time: %s
Type: %s
Comment: %s
''' % ( self.name,
        self.date,
        self.priority,
        self.time,
        self.type,
        self.comment)
        return output

class Tasks(object):
    def __init__(self, container = []):
        self.container = [ Task(todo) for todo in container ]

    def delete(self):

        x = 0
        for todo in self.container:

             x = x + 1
             print "Task Number",x,"\n", todo
             delete = raw_input("what number task would you like to delete")
             if delete == "y":
                 del todo

        ############
        #x = 0
       # for task in self.container:
           # x = x+1
           #print "Task Number",x,"\n", task
            #delete = raw_input("what number task would you like to delete")
            #if delete == "y":
                #del(task)

    def add(self, task):
        if task == '':
            raise TasksError('Empty task')
        self.container.append( Task(task) )

    def __str__(self):
        output = '\n'.join( [ str(todo) for todo in self.container ] )
        return output

if __name__== "__main__":
    divider = '-' * 30 + '\n'

    tasks = Tasks( container = [] ) # creates a new, empty task list

    while True:
        print divider, '''Make your selection:
1\. Add new task
2\. Print all tasks
3\. Save tasks
4\. Load tasks from disk
5\. Find high priority tasks
6\. Sort by date
7\. Delete task

<ENTER> to quit
'''
        try:
            menu_choice = int(input("Select a number from the menu: "))
        except:
            print 'Goodbye!'
            break

        if menu_choice == 1:

            task = raw_input (">>> Task: ")
            date = raw_input (">>> Date as string YYYYMMDD: ")
            priority = raw_input (">>> Priority: ")
            time = raw_input (">>> Time: ")
            Type = raw_input (">>> Type Of Task: ")
            comment = raw_input (">>> Any Comments? ")
            todo = (task, date, priority, time, Type, comment)

            tasks.add( todo )
            print tasks
        elif menu_choice == 2:
            print divider, 'Printing all tasks'
            print tasks
        elif menu_choice == 3:
            print divider, 'Saving all tasks'
            tasks.save()
        elif menu_choice == 4:
            print divider, 'Loading tasks from disk'
            tasks.load()
        elif menu_choice == 5:
            print divider, 'Finding tasks by priority'
            results = tasks.find_by_priority(priority='high')
            for result in results: print result
        elif menu_choice == 6:
            print divider, 'Sorting by date'
            tasks.sort_by_date()
            print tasks
        elif menu_choice == 7:

            tasks.delete() 
```

我已经删除了部分代码（希望没有什么重要的）。添加后，我无法让 python 删除我的任务。定义为“def delete”的两种方法都给出错误消息类型错误：任务/待办事项对象不支持删除。有谁知道解决这个问题的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:12:43.940

您不会像那样从列表中删除...您的代码有两个问题：

*   如果您使用`for`循环遍历可迭代对象，则不应在循环内更改它。
*   从`del`列表中您应该使用索引。

试试这个：

```
index = 0
while index < len(self.container):
    delete = raw_input("what number task would you like to delete")
    if delete == "y":
        del self.container[index]
    else:
        index += 1 
```

# drawing - 使用独奏在屏幕上绘图

> ID：10689451
> 
> 赞同：0
> 
> 时间：2012-05-21T17:03:16.960
> 
> 标签：drawing, robotium

在我的测试用例中，我必须画一条线，或者至少画一些点来模仿用户的签名。除了通过solo.clickOnScreen点击屏幕外，有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T19:11:32.857

你可以使用solo.drag() 来画一条线。

# opencv - 用opencv为灰度图像着色

> ID：10689456
> 
> 赞同：5
> 
> 时间：2012-05-21T17:03:46.433
> 
> 标签：opencv, colors, kinect

我在一些带有 kinect 传感器的项目中使用 openNI。我想用深度图给用户像素上色。现在我有从白色到黑色的像素，但我想要从红色到黑色。我已经尝试过 alpha 混合，但我的结果只是我的像素从粉红色到黑色，因为我添加（使用 addWeight）红色 + 白色 = 粉红色。

这是我的实际代码：

```
layers = device.getDepth().clone();
cvtColor(layers, layers, CV_GRAY2BGR);

Mat red = Mat(240,320, CV_8UC3, Scalar(255,0,0));
Mat red_body; // = Mat::zeros(240,320, CV_8UC3);
red.copyTo(red_body, device.getUserMask());

addWeighted(red_body, 0.8, layers, 0.5, 0.0, layers); 
```

其中 device.getDepth() 返回带有深度图的 cv::Mat，而 device.getUserMask() 返回带有用户像素（仅白色像素）的 cv::Mat

一些忠告？

编辑：还有一件事：感[谢萨米的回答](https://stackoverflow.com/a/10690427/433685)，我已经做到了。但实际上我没有从 0 到 255 的值，而是从（例如）123-220 的值。

我将通过一个简单的 for 循环找到最小值和最大值（有更好的方法吗？），我如何将我的值从 min-max 映射到 0-255 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T18:15:33.213

首先，OpenCV 的默认颜色格式是 BGR 而不是 RGB。因此，您创建红色图像的代码应该是

```
Mat red = Mat(240,320, CV_8UC3, Scalar(0,0,255)); 
```

对于红色到黑色的颜色图，您可以使用元素乘法而不是 alpha 混合

```
Mat out = red_body.mul(layers, 1.0/255); 
```

您可以使用找到矩阵 M 的最小值和最大值

```
double minVal, maxVal;
minMaxLoc(M, &minVal, &maxVal, 0, 0); 
```

然后，您可以减去 minValue 并使用一个因子进行缩放

```
double factor = 255.0/(maxVal - minVal);    
 M = factor*(M -minValue) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T17:20:53.877

有点笨拙和缓慢，但可能会拆分图层，将 red_body（使其成为单通道 Mat，而不是 3）复制到红色通道，将它们合并回图层？

使用 reshape 获得相同的效果，但速度更快（就地）：

```
layers = device.getDepth().clone();
cvtColor(layers, layers, CV_GRAY2BGR);

Mat red = Mat(240,320, CV_8UC1, Scalar(255)); // One channel
Mat red_body; 
red.copyTo(red_body, device.getUserMask());

Mat flatLayer = layers.reshape(1,240*320); // presumed dimensions of layer
red_body.reshape(0,240*320).copyTo(flatLayer.col(0));

// layers now has the red from red_body 
```

# iphone - 启用与超出栏边界的 UINavigationBar 子视图的用户交互

> ID：10689461
> 
> 赞同：3
> 
> 时间：2012-05-21T17:04:01.657
> 
> 标签：iphone, uibutton, uinavigationbar, addsubview, subviews

我有自定义视图和按钮，已添加为 UINavigationBar 的子视图。它们的框架设置为从导航栏的中间开始并延伸到导航栏的正常边界之外。我还有另一个子视图，有时必须显示为模态视图，但在 iPhone 上。为了实现这一点，我将他的框架设置为 0,0,320,480 并将他添加为导航栏的子视图。一切看起来都不错，但是在导航栏下方显示的视图部分（即 0,44,320,456）上禁用了用户交互。

我的其他物品也出现了类似的情况。如何启用用户与这些视图的交互？有没有办法以相反的方式做到这一点，例如让视图从导航控制器的视图开始并向上延伸以覆盖导航栏？（即 0,-44,320,480）？

似乎是一个简单的任务，但我已经尝试了所有我能想到的，包括切换显示/隐藏导航栏有/没有动画以使其不碍事，但是有一个按钮我只需要显示作为的一部分导航栏，它需要位于实际的 uinavigationbar 之上。

任何帮助表示赞赏。

谢谢，~阿拉什

# mongodb - mongodb最接近字符串匹配查找

> ID：10689469
> 
> 赞同：0
> 
> 时间：2012-05-21T17:04:39.703
> 
> 标签：mongodb, query-string

mongo 中是否有任何功能可以检索最接近的字符串匹配查找。例如，数据库中的条目如下：

*   标题：“香蕉奶昔”
*   作品名称：《香蕉甜》
*   标题：“香蕉树”
*   等等……

并假设用户输入一些文本，如“bananasweetest”。有什么办法可以让我得到香蕉糖

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:11:52.583

您显然正在寻找 MongoDB 中不可用的全文功能。查看 Solr 或 ElasticSearch - MongoDB 范围之外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:44:21.403

根据您要查找的内容，您可以使用正则表达式查询来完成：[http ://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-RegularExpressions](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-RegularExpressions)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-30T22:40:13.757

从 Mongodb 开始`v2.4`，您可以通过创建索引来创建全文索引来搜索您的数据 `db.reviews.ensureIndex( { comments: "text" } )`

[文档](http://docs.mongodb.org/manual/core/index-text/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T17:44:13.757

是的，我同意 Solr 和 ElasticSearch 是不错的选择。您也可以花时间在 Jira 中对这个服务器问题进行投票：[https ://jira.mongodb.org/browse/SERVER-380](https://jira.mongodb.org/browse/SERVER-380)

# bash - Emacs 键绑定错误

> ID：10689471
> 
> 赞同：1
> 
> 时间：2012-05-21T17:04:50.297
> 
> 标签：bash, shell, emacs, key-bindings

当我尝试设置以下绑定时：

`(global-set-key "\C-M-v" 'scroll-other-window-up)`

我得到一个“键序列 RET - v 以非前缀键 RET 开头”

那是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:59:29.573

您指定的绑定是“Control-Mv”。Control-M 是不可打印字符“回车”的键序列，相当于 RET 键。RET 键已绑定，因此不能用作前缀键。

您是否打算将绑定设置为 Control+Meta+v？那将是：

```
(global-set-key "\C-\M-v" 'scroll-other-window-up) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T17:59:51.490

您使用的密钥字符串`"\C-M-v"`被翻译为`C-m`- 这也是 key `RET`。

我认为进行键绑定最简单的方法是使用[`kbd`宏](http://www.gnu.org/software/emacs/manual/html_node/emacs/Init-Rebinding.html)。当您这样做`C-h k`并看到一个描述您刚刚键入的键的字符串时，您可以将其剪切/粘贴到 kbd 的参数中：

```
(global-set-key (kbd "C-M-v") 'scroll-other-window-up) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T18:00:58.900

尝试

```
(global-set-key (kbd "C-M-v") 'scroll-other-window-up) 
```

但请注意，标准 emacs 没有*滚动其他窗口*功能！

# php - 照片库网站

> ID：10689473
> 
> 赞同：-2
> 
> 时间：2012-05-21T17:05:02.280
> 
> 标签：php, mysql, gallery, photo

根据一些在线教程，我创建了一个使用 MySQL 和 PHP 将页面存储在数据库中的基本网站。这些页面用于动态创建我喜欢的菜单。该网站的主要目的是成为一个在线绘画画廊。我可以轻松地在 HTML 中静态地创建这个站点，但我有点想尝试动态地创建它。我可以将 jpeg 存储在服务器上的文件夹中，并在页面内容中包含 HTML 链接。但是还有其他方法吗？将所有图片数据和文件名存储在数据库中是否明智，以便在用户单击菜单中的选项时检索它？任何想法将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:15:26.160

1.  多研究一点，你就有了现存最有答案的问题之一。
2.  如果静态 HTML 足以供您使用，为什么要动态执行此操作。让它变得凉爽不是正确的理由。
3.  关于将 jpeg 存储在数据库中，请阅读本文。到 BLOB 还是不到 BLOB - Microsoft Research research.microsoft.com/apps/pubs/default.aspx?id=64525

# javascript - 如何在 Chrome 控制台中查看扩展对象/数组？

> ID：10689475
> 
> 赞同：18
> 
> 时间：2012-05-21T17:05:19.770
> 
> 标签：javascript, google-chrome, google-chrome-devtools

当我有对象数组时，当我在 Chrome 控制台中键入变量的名称时，我得到了这个： ![在此处输入图像描述](../Images/b5c0d5d920b0f9a6606490b18175e258.png)

**问题：** 是否有一些选项或标志在打开时会显示在 Chrome 控制台中查询时扩展的对象和数组？

我经常使用控制台并在控制台中执行内联操作，每次修改数组时，我都必须单击所有条目以查看值。

**我不想**编写一个循环来`console.dir`输出所有数组。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2014-05-09T19:44:43.100

`console.table()`在以表格格式[整齐地显示数组](http://blog.mariusschulz.com/2013/11/13/advanced-javascript-debugging-with-consoletable)方面做得很好。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-06-15T13:49:20.040

要在不编写循环的情况下查看数组（或任何其他对象）的全部内容，可以使用[`JSON.stringify`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/stringify). 这将以 JSON 格式输出整个对象，可选择缩进。

例如：

```
console.info(JSON.stringify([{a:1,b:2}, {c:3,d:4}], null, '  ')) 
```

将输出：

```
[
  {
    "a": 1,
    "b": 2
  },
  {
    "c": 3,
    "d": 4
  }
] 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-05-21T17:16:03.733

我不知道你是否知道，但是... 点击三角形，你可以看到完整的对象，我认为这很实用。

* * *

编辑

好的，对不起，我没有阅读这部分'=.= 但您可以检查Chrome 控制台支持[Chrome 开发工具](https://developers.google.com/chrome-developer-tools/docs/console)的 firebug 的 [控制台 API ：控制台](http://getfirebug.com/wiki/index.php/Command_Line_API)

# orientdb - 连接到嵌入式 orientdb 服务器

> ID：10689476
> 
> 赞同：4
> 
> 时间：2012-05-21T17:05:20.673
> 
> 标签：orientdb

我有一个具有此默认配置的嵌入式服务器：orientdb-server-config.xml 我使用来自 maven 的 1.0 版。我无法从控制台连接到它。

这是我尝试过的命令：`connect remote:localhost/temp admin admin`

`Disconnecting from the database [null]...OK Connecting to database [remote:localhost/temp] with user 'admin'... Error: com.orientechnologies.orient.enterprise.channel.binary.ONetworkProtocolException: Binary protocol is incompatible with the Server connected: client=9, server=12`

但我有这些听众：

```
 <listener protocol="binary" port-range="2424-2430" ip-address="0.0.0.0"/>
  <listener protocol="cluster" port-range="2434-2440" ip-address="0.0.0.0"/>
  <listener protocol="http" port-range="2480-2490" ip-address="0.0.0.0"> 
```

而这个存储：`<storage loaded-at-startup="true" userPassword="admin" userName="admin" path="memory:temp" name="temp"/>`

一切都像默认的 orientdb-server-config.xml

如何从控制台连接到这个嵌入式数据库？

启动输出：

```
2012-05-21 06:57:37:496 INFO OrientDB Server v1.0 is starting up... [OServer]
2012-05-21 06:57:38:003 INFO -> Loaded memory database 'temp' [OServer]
2012-05-21 06:57:38:038 INFO Listening binary connections on 0.0.0.0:2424 [OServerNetworkListener]
2012-05-21 06:57:38:039 INFO Listening cluster connections on 0.0.0.0:2434 [OServerNetworkListener]
2012-05-21 06:57:38:040 INFO Listening http connections on 0.0.0.0:2480 [OServerNetworkListener]
2012-05-21 06:57:38:062 INFO OrientDB Server v1.0 is active. [OServer] 
```

**更新：**它正在使用`[OServer] OrientDB Server v1.0rc9`

**UPDATE2：**问题是我在服务器中有 1.0 版，并使用了 1.0rc9 的控制台客户端。但是现在当服务器运行 1.0 并且我尝试使用客户端控制台 1.0 时，一切似乎都正常。谢谢！

# wpf - WPF XAML 如何禁用上下文菜单？

> ID：10689481
> 
> 赞同：0
> 
> 时间：2012-05-21T17:05:50.530
> 
> 标签：wpf, xaml, contextmenu, hide

我正在使用一个 Infragistics 数据演示器，当用户右键单击任何未绑定字段中的文本时，它显然会自动包含一个上下文菜单。我只是想为所有未绑定的字段禁用此上下文菜单。如何？注意：我确实为 datapresenter 设置了我自己的上下文菜单设置，当单击记录时它应该仍然起作用，但是在单击单个文本字段时它不会像“自动上下文菜单”那样出现。因为我没有创建它，所以我不能将其设为空，但是使用 {x:Null} 的无键样式也不起作用，它会给出错误。

我在此处添加了示例项目的链接：（请注意，在此示例中，我尝试将子菜单放入没有菜单项的上下文菜单中，然后该菜单只有上下文菜单的“条子”-我不知道如何发布zip文件到stackoverflow

[用空白上下文菜单替换自动上下文菜单的示例 - 注释掉 xaml 上下文菜单以查看我的问题](http://community.infragistics.com/cfs-file.ashx/__key/CommunityServer.Components.PostAttachments/00.00.35.18.82/ig-sample.zip)）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:23:01.057

我在 Infragistics 的网站上看到了你的帖子，但他们没有给你答案。看来它并不特别支持您要执行的操作。这可能是一个足够的解决方法：

```
<Grid.Resources>
  <ContextMenu x:Key="cm">
    <MenuItem Header="test menu 1"/>
    <MenuItem Header="test menu 2"/>
  </ContextMenu>
  <Style TargetType="{x:Type igDP:DataRecordCellArea}">
    <Setter Property="ContextMenu" Value="{StaticResource cm}"/>
  </Style>
  <Style TargetType="{x:Type igEditors:XamTextEditor}">
    <Setter Property="ContextMenu" Value="{StaticResource cm}"/>
  </Style>
</Grid.Resources> 
```

# curl - 如何通过 cURL 提交验证码

> ID：10689483
> 
> 赞同：1
> 
> 时间：2012-05-21T17:05:59.207
> 
> 标签：curl, captcha

我正在开发一个创建第三方网站的项目，我们在该网站上显示源自原始网站的验证码图像，并且用户必须在输入表单中的验证码图像上写入文本。然后我们使用 cURL 通过 POST 方法发送表单。但它不适用于验证码。我在网上搜索了很多，我浏览过的帖子中有 80% 都说这是不可能的，而我发现其他一些帖子说他们已经成功但没有描述。我很想知道这是否可能。如果可能的话，你能帮我做吗？

我们不需要 captcha-break 或类似的东西。capthca 的输入由用户手动输入。我们只需要使用 cURL 将其发送到原始站点。

提前致谢 ：-）

这是代码，我现在尝试：

```
$ch = curl_init();
$timeout = 5;
$name=$_POST['name'];
$captcha=$_POST['code'];
$data_pass = "user=".$name."&code=".$captcha;

curl_setopt($ch,CURLOPT_URL,$url);  
curl_setopt($ch, CURLOPT_POST,1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $data_pass);
curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,$timeout);

curl_setopt($ch, CURLOPT_COOKIESESSION, TRUE);
curl_setopt($ch, CURLOPT_COOKIEJAR, "/cookiefile.txt");
curl_setopt($ch, CURLOPT_COOKIEFILE, "/cookiefile.txt");

$ret = curl_exec($ch);
curl_close($ch); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-13T09:54:12.000

您可以尝试将验证码图像卷曲到 php 文件中。

添加这两行以帮助显示验证码图像。 `ob_clean();`//清理输出缓冲区，使图像不包含错误

```
header("Content-type:image/png"); 
```

稍后使用html“ `img src`”标签在用户输入表单中显示验证码。希望能帮助到你。

# grails - Grails 应用程序不会热插拔更改

> ID：10689486
> 
> 赞同：2
> 
> 时间：2012-05-21T17:06:15.913
> 
> 标签：grails

我有几个运行良好的 grails 2.0 应用程序。但是，其中之一不会在开发中进行热插拔更改。任何想法要寻找什么？我没有故意做任何事情来配置与此相关的任何内容。

它无法在 Intellij 中进行热交换，也无法使用 grails run-app 从命令行运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T11:16:26.033

我猜你用的是windows？

这有一个问题，我遇到了同样的问题，恐怕其他人也有 -[这个链接](http://jira.grails.org/browse/GRAILS-8573)将提供一些信息。

当我使用 Grails 1.3.7 时它运行良好，一旦我升级到 2.0.0（不确定版本），我不得不一直重新启动它。我的解决方案是切换到 Linux。

# ruby-on-rails - 在heroku上部署，未初始化的常量BaseController

> ID：10689489
> 
> 赞同：-2
> 
> 时间：2012-05-21T17:07:03.540
> 
> 标签：ruby-on-rails, heroku

将我的应用程序添加到 heroku 时出现下一个错误，

```
/app/app/controllers/networks_controller.rb:1:in `<top (required)>': uninitialized constant BaseController (NameError)
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/engine.rb:417:in `block (2 levels) in eager_load!'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/engine.rb:416:in `each'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/engine.rb:416:in `block in eager_load!'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/engine.rb:414:in `each'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/engine.rb:414:in `eager_load!'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/application/finisher.rb:51:in `block in <module:Finisher>'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/initializable.rb:30:in `instance_exec'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/initializable.rb:30:in `run'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/initializable.rb:55:in `block in run_initializers'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/initializable.rb:54:in `each'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/initializable.rb:54:in `run_initializers'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/application.rb:96:in `initialize!'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/railtie/configurable.rb:30:in `method_missing'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/config/environment.rb:5:in `<top (required)>'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/config.ru:4:in `block in <main>'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.3.5/lib/rack/builder.rb:51:in `instance_eval'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.3.5/lib/rack/builder.rb:51:in `initialize'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/config.ru:1:in `new'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/config.ru:1:in `<main>'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.3.5/lib/rack/builder.rb:40:in `eval'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.3.5/lib/rack/builder.rb:40:in `parse_file'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.3.5/lib/rack/server.rb:200:in `app'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/commands/server.rb:46:in `app'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.3.5/lib/rack/server.rb:301:in `wrapped_app'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.3.5/lib/rack/server.rb:252:in `start'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/commands/server.rb:70:in `start'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/commands.rb:54:in `block in <top (required)>'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/commands.rb:49:in `tap'
2012-05-21T16:59:06+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.1.1/lib/rails/commands.rb:49:in `<top (required)>'
2012-05-21T16:59:06+00:00 app[web.1]:   from script/rails:6:in `require'
2012-05-21T16:59:06+00:00 app[web.1]:   from script/rails:6:in `<main>'
2012-05-21T16:59:07+00:00 heroku[web.1]: Process exited with status 1
2012-05-21T16:59:07+00:00 heroku[web.1]: State changed from starting to crashed 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:13:11.303

所以你`networks_controller`继承自`BaseController`. 是`BaseController`添加到git吗？

你能提供更多信息吗？至少有一个来源`NetworksController`。

# java - 在 Windows 上访问智能卡时重用 Java 密钥库

> ID：10689494
> 
> 赞同：18
> 
> 时间：2012-05-21T17:07:48.097
> 
> 标签：java, windows, api, cryptography, smartcard

我正在开发一个使用 SUNMSCAPI 访问智能卡（电子 ID）并检索一些证书的应用程序。

不久前，我可以创建密钥库并签署文件列表，而无需重新创建密钥库，但现在我一次只能签署一个文件。

签署文件列表时，第一个文件已正确签署；签署第二个文件时，我得到一个“插入智能卡”对话框，并且正在使用的智能卡显示为灰色。

有没有人见过这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T12:16:46.900

是的，我以前见过这个。

我正在为在线使用的葡萄牙身份证开发前端和中间件，其中一项特殊功能是能够签署多个文件（电子签名），这正是我们所拥有的行为！

智能卡上的安全模型确保一个身份验证只持续一个动作。签署文件是一项操作，因此我们必须缓存身份验证详细信息（PIN 码）并循环遍历我们希望签署的每个文件的身份验证过程。

# c - 延迟两个线程之间的通信

> ID：10689499
> 
> 赞同：0
> 
> 时间：2012-05-21T17:08:10.593
> 
> 标签：c, linux, multithreading, pthreads, communication

我有两个线程（我`pthreads`在 GNU/Linux 上使用）。现在他们正在使用全局变量共享信息（我知道，这不太好）。在每个周期结束时，他们必须将 5 个变量 ( `doubles`) 的值发送到另一个线程。我想在他们的沟通渠道中引入一个固定的时间延迟，

IE

> 线程1 (1kHz) <---> 10ms <---> 线程2 (1kHz)

我在想，在每个周期，我可以创建一个读取值的线程，休眠 10 毫秒，然后将其转发到另一个线程，然后死掉。这将使系统每个周期创建 2 个线程，一个用于通信通道的每个方向（每毫秒 2 个线程）。

还有其他模拟通信延迟的智能方法吗？

**更新**：我不想同步线程的通信，而是在它们之间添加延迟。如果 thread1 在时间 1s 写了一些东西，另一个线程应该只能在时间 1s + 10ms 读取它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T02:17:03.043

这听起来不像是性能问题，所以让它变得简单。不需要复杂的数据结构、额外的线程等。

为您的数据创建一个结构，为其添加一个时间戳字段。

制作一个数组以容纳至少 10 个结构。去100是安全的。不会在这里使用很多内存，所以谁在乎。哎呀，你可以在它需要增长的时候 malloc 它。

每个线程都有一个这样的数组，以及数组中的项目计数。

当一个线程准备好发送数据时，做两件事：

1.  检查它的数组中第一项的时间戳，如果足够大，则将该数据发送到另一个线程。发送后，减少计数并将数组中的其余项目向下移动一个档次。
2.  将当前/新数据添加到具有当前时间戳的数组末尾并增加计数。

重复其他线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:13:59.417

为什么不直接使用互斥锁来同步两个线程之间的通信呢？

当第一个线程需要写入数据时，它会获取互斥锁（因此其他线程在第一个更新数据时无法读取数据），更新datam，然后释放互斥锁。另一个线程在读取数据时执行类似的获取/释放方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T22:15:50.450

我不能从这个问题中完全看出作者和读者线程之间的通信是否需要可靠（如：作者线程发送的所有消息都保证被读者线程以正确的顺序看到）。如果是这样，并且如果您使用单个全局结构作为共享数据，那么您实际上是在实现一个缓冲区大小为 1 的 FIFO。线程间通信很容易出错，因此我建议您查看一些东西就像 glib 的[异步队列](http://developer.gnome.org/glib/2.30/glib-Asynchronous-Queues.html)一样。如果您需要从头开始实现自己的代码，那么查看该代码可能是一个不错的起点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T04:23:38.703

为什么不在这里使用信号量？您可以让一个线程在信号量上等待，并让另一个线程在它完成关键部分时发出信号。

# c# - 如何将表格添加到托盘中

> ID：10689500
> 
> 赞同：1
> 
> 时间：2012-05-21T17:08:11.060
> 
> 标签：c#, windows

我有个问题。我需要将 winform 添加到托盘中。例如，我想在托盘中添加时钟，为此我必须在系统托盘中添加一个小的 Winform，它将显示时间，并且还有一个小的上下文菜单来编辑设置等。

如何在系统托盘中添加此表单？（我试图在互联网上搜索任何想法，解决但无论如何我不知道如何在 C# 上实现它）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:11:40.187

您可以使用 NotifyIcon 对象并处理表单调整大小事件来隐藏表单并显示 NotifyIcon。请参阅 [http://alperguc.blogspot.com/2008/11/c-system-tray-minimize-to-tray-with.html](http://alperguc.blogspot.com/2008/11/c-system-tray-minimize-to-tray-with.html)并将[应用程序最小化到系统托盘](https://stackoverflow.com/questions/7625421/minimize-app-to-system-tray)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T17:18:06.467

Windows 支持在托盘中添加图标，其正式名称为通知区域。它不支持在那里添加任何其他内容，因此您添加 WinForm 的想法根本不可行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T17:12:09.300

查看 Windows 窗体`NotifyIcon`控件。

> 指定在通知区域中创建图标的组件。

## 查看[MSDN - NotifyIcon Class](http://msdn.microsoft.com/en-us/library/system.windows.forms.notifyicon.aspx)上的描述和示例。

# testing - 从 maven zip 程序集运行测试

> ID：10689501
> 
> 赞同：0
> 
> 时间：2012-05-21T17:08:21.307
> 
> 标签：testing, maven, zip, maven-assembly-plugin

我终于成功地让 Maven 使用程序集文件将一堆 jar 压缩在一起并将其安装到我的本地存储库中。那已经够难了……

现在我的目标是配置另一个 maven 项目，这样当我执行“mvn test”时，它会拉入那个 zip，解压它，然后从那个 zip 文件中的 jar 中运行测试。有谁知道如何做到这一点？

这是组装项目的 POM：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

<modelVersion>4.0.0</modelVersion>
<groupId>com.pason</groupId>
<artifactId>RigFocusOnDataHub</artifactId>
<name>RigFocusOnDataHub</name>
<version>12.2.0-SNAPSHOT</version>
<packaging>pom</packaging>

<dependencies>
    ...
</dependencies>

<build>
    <plugins>
        <plugin>
            <artifactId>maven-assembly-plugin</artifactId>
            <version>2.3</version>
            <configuration>
                <descriptors>
                    <descriptor>RigFocusOnDH.xml</descriptor>
                </descriptors>
            </configuration>
            <executions>
                <execution>
                    <id>zip</id>
                    <!-- this is used for inheritance merges -->
                    <phase>package</phase>
                    <!-- append to the packaging phase. -->
                    <goals>
                        <goal>single</goal>
                        <!-- goals == mojos -->
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build> 
```

这是第二个项目的 POM。不幸的是，它没有下载 RigFocusOnDataHub 的 zip 文件，而是从本地 repo 中获取所有 RigFocusOnDataHub 依赖项的 jar。

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">

<modelVersion>4.0.0</modelVersion>
<groupId>com.pason</groupId>
<artifactId>RigFocusDHSystemTest</artifactId>
<version>12.2.0-SNAPSHOT</version>
<dependencies>
    <dependency>
        <groupId>com.pason</groupId>
        <artifactId>MurphyRigFocus</artifactId>
        <version>2.0.0-SNAPSHOT</version>
        <type>test-jar</type>
    </dependency>
    <dependency>
        <groupId>com.pason</groupId>
        <artifactId>RigFocusOnDataHub</artifactId>
        <version>12.2.0-SNAPSHOT</version>
        <type>pom</type>
    </dependency>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.8.2</version>
    </dependency>
</dependencies>

<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-dependency-plugin</artifactId>
            <executions>
                <execution>
                    <id>unpack</id>
                    <phase>process-test-classes</phase>
                    <goals>
                        <goal>unpack</goal>
                    </goals>
                    <configuration>
                        <artifactItems>
                            <artifactItem>
                                <groupId>com.pason</groupId>
                                <artifactId>MurphyRigFocus</artifactId>
                                <version>2.0.0-SNAPSHOT</version>
                                <type>test-jar</type>
                                <outputDirectory>${project.build.directory}/tests/MurphyRigFocus</outputDirectory>
                            </artifactItem>
                            <artifactItem>
                                <groupId>com.pason</groupId>
                                <artifactId>RigFocusOnDataHub</artifactId>
                                <version>12.2.0-SNAPSHOT</version>
                                <type>zip</type>
                                <outputDirectory>${project.build.directory}/tests/MurphyRigFocus</outputDirectory>
                            </artifactItem>
                        </artifactItems>
                    </configuration>
                </execution>
            </executions>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.6</version>
            <configuration>
                <testClassesDirectory>${project.build.directory}/tests/MurphyRigFocus</testClassesDirectory>
                <reportsDirectory>${project.build.directory}/surefire-reports/MurphyRigFocus</reportsDirectory>
                <includes>
                    <include>**/*IT.*</include>
                </includes>
                <argLine>-Djava.library.path=${basedir}/target/classes/</argLine>
                <forkMode>pertest</forkMode>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:23:44.983

您需要：

1.  从 zip 中提取 jars - 这很容易使用 maven-dependency-plugin
2.  削减传递依赖关系，这样你的 jars 就不会在路径中结束两次 - 你可以在源代码中使用 maven-shade-plugin 或在测试项目本身中使用依赖项排除
3.  将罐子添加到您的测试类路径中，有很多方法可以做到这一点，我会先尝试在surefire配置中使用其他参数

# android - 没有为 android 第三方库附加源

> ID：10689502
> 
> 赞同：0
> 
> 时间：2012-05-21T17:08:36.897
> 
> 标签：android, eclipse-plugin, adt

今天在我的 android 项目中，我添加了一个外部 android 库（我在构建这个项目时检查了 Library android 属性），当我调试我的库代码时，eclipse 没有附加源代码，几乎不可能进行有效的调试。

有没有人也有这个问题？我在带有 Android 插件版本 18.0.0 的 Mac OSX 10.7 上使用 Eclipse Indigo

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T19:00:06.980

右键单击您的项目->构建路径->配置构建路径->库->选择要附加源的库->展开->选择源附件->编辑->输入源文件夹的路径

# entity-framework-4 - 无法使用 LINQ to Entities 和 LinqKit / PredicateBuilder 重构

> ID：10689506
> 
> 赞同：6
> 
> 时间：2012-05-21T17:09:12.180
> 
> 标签：entity-framework-4, linq-to-entities, expression-trees, predicatebuilder, linqkit

我一直在尝试将 LINQ 表达式重构为方法，并且遇到了“ `Internal .NET Framework Data Provider error 1025.`”和“ `The parameter 'xyz' was not bound in the specified LINQ to Entities query expression.`”异常。

以下是实体模型的相关部分（使用 EF 4.2 / LINQ to Entities）：

```
public class Place : Entity
{
    public string OfficialName { get; protected internal set; }
    public virtual ICollection<PlaceName> { get; protected internal set; }
}

public class PlaceName : Entity
{
    public string Text { get; protected internal set; }
    public string AsciiEquivalent { get; protected internal set; }
    public virtual Language TranslationTo { get; protected internal set; }
}

public class Language : Entity
{
    public string TwoLetterIsoCode { get; protected internal set; }
} 
```

基本的关系模型是这样的：

```
Place (1) <-----> (0..*) PlaceName (0..*) <-----> (0..1) Language 
```

我正在尝试创建一个查询，当给定 search 时，它将`term`尝试查找以OR开头的`Place`实体，其具有who或以 search 开头。（不是我遇到问题的地方，尽管它是查询的一部分，因为s 应该只匹配。）`OfficialName``term``PlaceName``Text``AsciiEquivalent``term``Language``PlaceName``CultureInfo.CurrentUICulture.TwoLetterIsoLanguageName`

以下代码**确实有效**：

```
internal static IQueryable<Place> WithName(this IQueryable<Place> queryable, 
    string term)
{
    var matchesName = OfficialNameMatches(term)
        .Or(NonOfficialNameMatches(term));
    return queryable.AsExpandable().Where(matchesName);
}

private static Expression<Func<Place, bool>> OfficialNameMatches(string term)
{
    return place => place.OfficialName.StartsWith(term);
}

private static Expression<Func<Place, bool>> NonOfficialNameMatches(string term)
{
    var currentLanguage = CultureInfo.CurrentUICulture.TwoLetterISOLanguageName;
    return place => place.Names.Any(
        name =>
        name.TranslationToLanguage != null
        &&
        name.TranslationToLanguage.TwoLetterIsoCode == currentLanguage
        &&
        (
            name.Text.StartsWith(term)
            ||
            (
                name.AsciiEquivalent != null
                &&
                name.AsciiEquivalent.StartsWith(term)
            )
        )
    );
} 
```

我接下来要做的是重构`NonOfficialNameMatches`方法以将`name => ...`表达式提取到单独的方法中，以便其他查询可以重用它。这是我尝试过的一个示例，它**不起作用**并引发异常“ `The parameter 'place' was not bound in the specified LINQ to Entities query expression.`”：

```
private static Expression<Func<Place, bool>> NonOfficialNameMatches(string term)
{
    return place => place.Names.AsQueryable().AsExpandable()
        .Any(PlaceNameMatches(term));
}

public static Expression<Func<PlaceName, bool>> PlaceNameMatches(string term)
{
    var currentLanguage = CultureInfo.CurrentUICulture.TwoLetterISOLanguageName;
    return name =>
            name.TranslationToLanguage != null
            &&
            name.TranslationToLanguage.TwoLetterIsoCode == currentLanguage
            &&
            (
                name.Text.StartsWith(term)
                ||
                (
                    name.AsciiEquivalent != null
                    &&
                    name.AsciiEquivalent.StartsWith(term)
                )
            );
} 
```

当我没有`.AsExpandable()`链时`NonOfficialNameMatches`，我会得到“ `Internal .NET Framework Data Provider error 1025.`”异常。

我在[这里遵循了其他建议，](https://stackoverflow.com/a/2957283/304832)例如调用`.Expand()`谓词的几种组合，但总是以上述异常之一结束。

**甚至可以使用带有 LinqKit / PredicateBuilder 的 LINQ to Entities 将此表达式分解为单独的方法吗？**如果是这样，怎么做？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T20:00:12.200

下面的方法应该有效：

```
private static Expression<Func<Place, bool>> NonOfficialNameMatches(string term)
{
    Expression<Func<PlaceName, bool>> placeNameExpr = PlaceNameMatches(term);
    Expression<Func<Place, bool>> placeExpr =
        place => place.Names.Any(name => placeNameExpr.Invoke(name));
    return placeExpr.Expand();
} 
```

编辑：添加额外的解释

该`PlaceNameMatches`方法在您编写时起作用。您的问题在于您如何使用该方法。如果您想分解表达式的某些部分，请按照我在上述方法中执行的 3 个步骤进行操作。

1.  将局部变量设置为由方法创建的表达式。

2.  将另一个局部变量设置为调用局部变量表达式的新表达式。

3.  调用 LinkKit`Expand`方法：这将扩展所有 Invoked 表达式

# jquery - 在 asp.net mvc 3 中更改 jquery 的默认文本验证

> ID：10689507
> 
> 赞同：1
> 
> 时间：2012-05-21T17:09:16.207
> 
> 标签：jquery, asp.net-mvc-3, validation

我正在尝试覆盖 MVC 3 项目中客户端验证的默认 jquery 文本。

显然这看起来是正确的答案，但它对我不起作用。

[jQuery 验证：更改默认错误消息](https://stackoverflow.com/questions/2457032/jquery-validation-change-default-error-message)

具体的错误文本也有点不同，它不是

“此字段是必需的。”

它是“（DynamicFieldName）字段是必需的。” 我想更改它，但在任何地方都找不到它的引用。我已经搜索了所有必需的实例。” 在整个项目中（因为我假设必须在某处定义客户端才能使其工作，但也许此文本是从后端传递的）

啊！我刚刚找到它，验证文本被设置为 html5 属性验证的一部分。凉爽的。问题解决了。

我检查了 jQuery.validator.messages 对象，我的更改正在被提取。

谁能帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:09:59.357

该值被设置为 html5 验证属性的一部分。需要从模型中的服务器端进行更改。

```
[Required(ErrorMessage="Required"] 
```

# python - 确定 GIF 在 Python 中是否透明

> ID：10689512
> 
> 赞同：14
> 
> 时间：2012-05-21T17:09:52.730
> 
> 标签：python, image, python-imaging-library, gif

我将如何检查 GIF 是否透明（甚至是部分透明）？

我通过使用 PIL 打开图像并检查图像的模式来使用 PNG 完成此操作。但无论如何，GIF 都具有相同的模式。

至于误报，我不介意完全不透明的 GIF 是否被标记为透明（假设这是一种罕见的情况），但我确实介意透明的 GIF 是否被标记为不透明。

至于图书馆，我更喜欢使用 PIL 而不是其他东西的解决方案，但无论如何都可以。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-21T17:16:21.030

```
img = Image.open(filename)
if img.mode == "RGBA" or "transparency" in img.info:
    # image uses transparency 
```

请参阅[此处](http://www.pythonware.com/library/pil/handbook/format-gif.htm)了解透明度如何与 GIF（和 8 位、调色板、PNG）一起使用。

请注意，您的误报情况*是*可能的：GIF 可以将颜色定义为透明但不使用它。不过，我想这将是非常罕见的——为什么为了透明度而丢弃颜色而不使用它呢？（你的假阴性是不可能的。）

尽管如此，如果您需要知道是否实际使用了透明度，您可以制作两个版本的图像，其中透明颜色映射到不同的颜色（例如，黑色和白色），然后比较它们。如果有任何差异，图像确实使用透明度。像这样：

```
def uses_transparency(filename):
    img = Image.open(filename)
    trans = img.info.get("transparency", None)
    if trans is not None:
        trans *= 3  # convert color number to palette table index
        palette = img.getpalette()
        imgs = []
        for bg in [0, 255]:   # map transparent color first to black, then white
            palette[trans:trans+3] = [bg] * 3
            img.putpalette(palette)
            imgs.append(img.convert("L"))
        return bool(ImageChops.difference(*imgs).getbbox())
    return False 
```

您可以使用类似的方法来查看 24 位 PNG 是否实际使用 alpha 通道，方法是将其粘贴到白色和黑色背景上并比较结果。

# iphone - 如何保存 NSDictionaries？

> ID：10689516
> 
> 赞同：0
> 
> 时间：2012-05-21T17:10:00.220
> 
> 标签：iphone, objective-c, database, xcode, nsdictionary

你能告诉我吗，我怎么能做这样的事情：

例如，我有一个应用程序，其中包含有关您的宠物的信息。但首先，您应该将宠物添加到数据库中。在特殊视图中，您输入宠物的姓名、年龄、品种、颜色等（键），然后保存。我们到了，现在您在应用程序中拥有了您的第一只宠物。但是你想添加新的宠物...

**如何使用相同的键保存所有这些字典？**您不知道如何创建字典，因为您不知道用户想要在应用程序中添加多少宠物。最简单的方法是什么？

如果用户想在应用程序中添加数千只宠物怎么办？我敢肯定，我不应该在代码中为每种可能的动物创建数千个字典。但我该怎么做呢？像 Deisy 的 dictionary1、Bruno 的 dictionary2、Hamlet 的 dictionary3 等等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T17:21:11.227

以下是它如何工作的粗略描述：

您需要在某个地方定义一个集合来保存这些宠物。

```
NSMutableSet *myPets = [[NSMutableSet alloc] init]; 
```

当用户输入数据并按下保存按钮时，视图控制器中会调用一些方法。在该方法中，您可以收集数据，如下所示：

```
NSDictionary *pet = [NSDictionary dictionaryWithObjectsAndKeys:nameField.text, @"name", breedField.text,@"breed", nil];
[myPets addObject:pet]; 
```

此时`pet`已经放入`myPets` `NSMutableSet`，编译器会释放它，所以它不再存在了。下次用户输入数据并再次按下按钮时，`pet`将创建一个新的并放入`myPets`. 不要担心创建数百万个实例，编译器会处理它。

如果您想在之后检索个别宠物，您可以执行以下操作

```
for (NSDictionary *aPet in myPets) {
   if ([[aPet objectForKey:@"name"] isEqualToString:@"Lassie"]) {
      // do what you want to do with Lassie
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T17:31:03.353

你需要一个`NSArray`来持有`NSDictionaries`。

# indexing - 为什么 SAS 不使用我的索引？

> ID：10689517
> 
> 赞同：2
> 
> 时间：2012-05-21T17:10:05.793
> 
> 标签：indexing, sas, proc-sql

我有一个按字段“A”排序的大型 SAS 数据集。我想做一个引用字段“A”和“B”的查询。为了提高性能，我在“B”上创建了一个索引。这会导致一条无用的消息：

```
INFO: Index B not used.  Sorting into index order may help. 
```

当然，对 B 进行排序会有所帮助。但这不是重点。索引适用于您已经在其他字段上排序的情况。

在类似的查询中，SAS 给出以下消息：

```
INFO: Use of index C for WHERE clause optimization canceled. 
```

关于让 SAS 使用我的索引的任何提示？在一种情况下，查询需要 2 小时才能运行，因为 SAS 不使用索引。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T13:07:13.170

如果查询没有足够的选择性 - 将大部分源记录带到结果中，索引的使用可能无助于性能，最终会使事情变得更糟。这可能就是优化器决定不使用索引的原因。

要强制使用索引，请尝试使用 IDXNAME 数据集选项（可能在两个表上）。请参阅[http://support.sas.com/documentation/cdl/en/lrdict/64316/HTML/default/viewer.htm#a000414058.htm](http://support.sas.com/documentation/cdl/en/lrdict/64316/HTML/default/viewer.htm#a000414058.htm)。

如果不查看查询并了解数据的某些特征（至少输入表的记录数和查询结果的预期大小），就很难说出最佳方法。

无论如何，为了获得最佳性能，在连接表时，两个表都需要类似地索引，并且所有连接键都需要成为索引的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:35:52.010

如果没有看到您尝试运行的查询，就无法回答这样的问题。只有当 SAS 优化器确定它会提高性能时，索引才会有用。你能展示一个你想运行的代码的简单例子吗？

# apache-flex - 带有来自 sqlite 事件的日历，用于 adobe air 应用程序

> ID：10689518
> 
> 赞同：-1
> 
> 时间：2012-05-21T17:10:06.293
> 
> 标签：apache-flex, sqlite, events, air, calendar

我正在为商店创建一个 adobe air 应用程序，我想显示一个日历，其中包含从 sqlite 数据库中挑选的事件（如 **待办事项**列表）。我搜索了很多但一无所获。如果您有任何示例，请帮助我???或者有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:59:47.683

您查看过[Flextras 日历](https://www.flextras.com/index.cfm?event=ProductHome&productID=15)吗？Flextras 是一家商业企业，但产品可免费用于生产用途；如果您需要来源或需要帮助，则必须付费。

还有其他商业日历组件。但出于自私的原因，我更喜欢我们的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T04:27:29.797

以下是创建活动日历的教程：

[http://www.thetechlabs.com/interfaces/create-a-dynamic-event-calendar-in-flex-builder-3-with-actionscript-30/](http://www.thetechlabs.com/interfaces/create-a-dynamic-event-calendar-in-flex-builder-3-with-actionscript-30/)

希望对你有帮助。

# python - 在 Python2 中导入一些 python3 模块

> ID：10689523
> 
> 赞同：5
> 
> 时间：2012-05-21T17:10:34.290
> 
> 标签：python, django, python-3.x, python-2.x

有没有办法将 Python 3 模块导入 Python 2 脚本？我想在 Django 应用程序中使用一些 Python 3 模块，但在 Internet 上没有看到任何内容。有什么线索吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T17:17:03.273

我不认为这真的可能，不。解释器的同一个实例必须处理给定应用程序中导入的每个模块，因此没有明显的方法来混合和匹配解释器。如果您需要使用 Python 3 模块完成一项离散任务，您可以尝试制作一个命令行脚本来完成您的任务，然后从您的 Python 2 应用程序中将该脚本作为子进程调用，但这至少可以说是尴尬的.

请注意，我不认为真的有很多只支持 Python 3 的模块——此时大多数模块要么支持这两个版本，要么只支持 Python 2。

# php - PHP 将文件上传到 Apache 服务器失败

> ID：10689526
> 
> 赞同：0
> 
> 时间：2012-05-21T17:10:49.937
> 
> 标签：php, apache

我有一个提交图片的表单，截图是输入标签的名称。

在 php 脚本中，我可以打印出 $_FILES['screenshot']['name']，但是当我尝试获取临时文件夹时，它会使用 $_FILES['screenshot']['tmp_name'] 保存在服务器上，我什么都得不到。

有谁知道为什么？似乎文件到达了临时文件夹，但我无法获得路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:17:01.777

据我所知，它们存储在 /tmp 中并在脚本完成时删除..

您需要使用[move_uploaded_file](http://php.net/manual/en/function.move-uploaded-file.php)将文件移动到可访问的文件夹..

IE

```
move_uploaded_file($_FILES['screenshot']['tmp_name'], '/uploads/' . $_FILES['screenshot']['name']); 
```

# java - 使用传真调制解调器拨打电话

> ID：10689528
> 
> 赞同：1
> 
> 时间：2012-05-21T17:11:09.027
> 
> 标签：java, phone-call, modem, fax

我想开发一个能够使用传真调制解调器拨打电话的应用程序。由于我是一名 Java 程序员，我想使用 Java 或 JNA 来完成。

我找到了一些关于 Windows TAPI api 的文档，但我不知道任何 C++，而且 Window 编程很难学习。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T18:12:45.680

如果您想发送/接收传真，请在此处查看 RFax：[http ://www.java4less.com/RFax_help.html](http://www.java4less.com/RFax_help.html)

它看起来非常简单易用。以下几行代码就足以发送传真：

```
// create fax producer 
producer p=new faxTextProducer(); 
p.text=this.txt.getText("Hello, \n\n this is a fax sent with RFax\n\nregards\n\nJ4L"); 
p.pageImage=new BufferedImage(800,1290,BufferedImage.INT_RGB); 
p.prepare();

  // setup modem 
 faxModem m=new faxModem(); 
 m.setPortName("COM1"); 
 m.faxClass=1;

 m.open(p); // send 
if (m.sendFax("123456789")) System.out.println("Success ***"); 
else System.out.println("Failure: " + m.lastError);

m.close(); 
```

# css - 我的身高不适用于 CSS？

> ID：10689531
> 
> 赞同：-3
> 
> 时间：2012-05-21T17:11:14.073
> 
> 标签：css, height

我有一个页面，我希望根据内容自动调整高度，但如果我这样做了`height:100%;`、`height:auto;`或`min-height:100%;`，它就不起作用。我能做些什么来解决这个问题？

这是我的网站页面：[http ://ht.io-web.com/tutor-registration](http://ht.io-web.com/tutor-registration)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:20:34.600

当您只希望它扩展到其内容的尺寸时，为什么要设置高度？如果您省略高度，它会在您用内容填充容器时根据需要扩展。
您能否更详细地描述您页面中的问题，并可能给我们一个代码示例？我会更新我的答案以更好地帮助你。

从您提供的链接来看，您似乎需要清除浮动。尝试添加`overflow:auto;`到有问题的容器 div 中。

# mediaelement.js - 如何获取 mediaelement.js 播放器状态（暂停、音量等）？

> ID：10689533
> 
> 赞同：4
> 
> 时间：2012-05-21T17:11:17.923
> 
> 标签：mediaelement.js

根据[mediaelement.js 网站](http://mediaelementjs.com/#api)上的说明，应该很容易获得播放器状态。但我不知道该怎么做。

我正在创建这样的播放器并尝试读取属性（播放器本身工作没有问题）。

```
var player = new MediaElementPlayer('.player_1')
player.play();
player.pause();
log(player.paused);
log(player.volume); 
```

但这失败了 - 两者`paused`和`volume`都是`undefined`。

我正在使用最新的 2.8.2 版本。

jsfiddle 示例：http: [//jsfiddle.net/chodorowicz/wLu2v/3/](http://jsfiddle.net/chodorowicz/wLu2v/3/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T15:24:23.790

好的，John Dyer 在 Github 支持页面上回答了我： [https ://github.com/johndyer/mediaelement/issues/497](https://github.com/johndyer/mediaelement/issues/497)

需要获取 mediaelement 本身`media`

```
new MediaElementPlayer('.player_1', {success: function(media, node, player) {
  // this will be undefined since it's the player with buttons
  alert(player.paused);
  // this will be a real value since it's the underlying mediaelement
  alert(media.paused);
}
}); 
```

[http://jsfiddle.net/H7X7X/2/](http://jsfiddle.net/H7X7X/2/)

​要稍后获取媒体元素，您可以使用以下代码

```
$('player')[0].player.media; 
```

# git - Git：如何将本地分支推送到重命名的远程分支？

> ID：10689534
> 
> 赞同：0
> 
> 时间：2012-05-21T17:11:18.627
> 
> 标签：git, push, git-push

我有一个远程存储库和一个本地存储库。我做了一个`git fetch --all`并在本地仓库中看到了我想要的分支，我想创建一个本地跟踪分支：

```
git checkout -t -b bug1000 origin/user/bug/1000 
```

我的问题是 pull 是正确的，但 push 没有设置：

```
>$ git remote show origin
* remote origin
  Fetch URL: XXX
  Push  URL: XXX
  HEAD branch: master
  Remote branches:
    maint                                      tracked
    master                                     tracked
    user/bug/1000                              tracked
    user/bug/1001                              tracked
    user/bug/1002                              tracked
  Local branches configured for 'git pull':
    bug1000     merges with remote user/bug/1000
    maint       merges with remote maint
    master      merges with remote master
  Local refs configured for 'git push':
    maint       pushes to maint       (local out of date)
    master      pushes to master      (local out of date) 
```

我的`.git/config`看起来是正确的：

```
[remote "origin"]
        fetch = +refs/heads/*:refs/remotes/origin/*
        url = XXX
[branch "master"]
        remote = origin
        merge = refs/heads/master
[branch "maint"]
        remote = origin
        merge = refs/heads/maint
[branch "bug1000"]
        remote = origin
        merge = refs/heads/user/bug/1000 
```

我已经尝试过`git push -u origin bug1000:user/bug/1000`了，但它并没有改变任何东西。

这是使用 git 1.7.10.2 （截至写作时最新稳定）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:05:42.537

您可以为该遥控器添加一个`push`条目，但如果您有很多这些，这可能会变得很麻烦：

```
[remote "origin"]
    fetch = +refs/heads/*:refs/remotes/origin/*
    url = XXX
    push = refs/heads/bug1000:refs/heads/user/bug/1000 
```

如果您添加了另一个虚拟“目录”并`bug/1000`在本地使用而不是`bug1000`，那么推送配置可能是`push = refs/heads/bug/*:refs/heads/user/bug/*`，从长远来看可能会更干净。

# javascript - 打开 APE（Ajax Push Engine）通道的数量如何影响性能？

> ID：10689541
> 
> 赞同：0
> 
> 时间：2012-05-21T17:12:04.617
> 
> 标签：javascript, ajax, django, socket.io, ape

我正在开发一个遵循响应原则的 Web 应用程序。如果任何用户发生变化，屏幕上当前可见的每个信息都会自动更新 - 实时更新。

我将 APE（Ajax 推送引擎）与 Django 结合使用，向当前打开页面的所有用户提交所需的信息。该信息可能与对象的特定实例相关，这可能导致每个用户有大量的开放通道。我说**的是最多 100 个开放频道**。

## 1\. 这个数量会影响性能吗？

## 2\. 这是好的设计还是我应该努力创建尽可能少的频道？

## 3\. APE 是一个不错的选择还是应该切换到 node.js + Socket.IO？与 APE 相比如何衡量性能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T16:09:40.580

我选择切换到 SockJS，看到这个问题：

[python Socket.IO 客户端，用于向 TornadIO2 服务器发送广播消息](https://stackoverflow.com/questions/10950365/python-socket-io-client-for-sending-broadcast-messages-to-tornadio2-server)

为什么？因为：

*   SockJS 比 Socket.IO 和 APE 更可靠、更稳定
*   性能相同（据我所知）
*   SockJS 比 APE 具有更广泛的通信协议支持
*   APE 服务器需要更多配置
*   无闪存要求

# javascript - 使用 REST 和 Javascript 处理复杂对象的最佳实践？

> ID：10689545
> 
> 赞同：0
> 
> 时间：2012-05-21T17:12:17.173
> 
> 标签：javascript, json, rest, architecture

假设您从浏览器中的 javascript 代码调用 REST 服务。您的 REST 服务以 JSON 表示形式返回一个复杂的对象层次结构。如果您想要一个具体的例子，请说保险业的索赔。处理这种情况的任何最佳做法？我只能想象它会变得非常混乱，尤其是在尝试通过 PUT/POST（创建声明或更新声明）创建或更新现有对象时。如果您不小心，我想您最终可能会陷入耦合非常紧密的混乱局面。我想如果您的客户也不是 web/javascript，也可以这样说。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:20:59.807

所以，我相信您说的是在返回、创建或编辑时应该表示资源的深度。

这确实很棘手，并且没有硬性规定。您肯定想做的一件事是展平图形，因此您没有要序列化的循环引用。

想象一下你有

```
class Claim
  property Owner

class Owner
  property list of Claims 
```

如果您逐字序列化 Claim 图，当它尝试序列化 Owner 属性时，您将有一个循环引用，因为它将序列化 Claims，这将序列化 Owners 等。

除此之外，您应该在序列化图中包含的内容应限于您认为对服务客户端请求至关重要的内容。

# javascript - 同步 window.setTimeout 回调

> ID：10689546
> 
> 赞同：0
> 
> 时间：2012-05-21T17:12:24.453
> 
> 标签：javascript, synchronization, settimeout

```
setTimeout(function() {
    console.log("1");
}
console.log("2"); 
```

基本上，我想在“2”之前输出“1”。如何将回调函数与当前的“调用者”线程同步？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:15:09.733

尝试类似：

```
setTimeout(function() {
    console.log("1");
    callback();
}
function callback(){
   console.log("2");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T17:15:20.730

你不能在 JavaScript 中阻止线程（除了`alert`和`confirm`内置），所以在你`console.log("2")`之后实现你的唯一方法`console.log("1")`是：

1.  把它放在超时函数中：

    ```
    setTimeout(function() {
        console.log("1");
        console.log("2");
    }, delay); 
    ```

    ...或在该超时函数调用的另一个函数中，尽管您已经有一个用于 的函数`setTimeout`，但不清楚（除了代码组织）为什么需要一个单独的函数。

2.  把它放在一个单独的函数中`setTimeout`，延迟时间更长：

    ```
    setTimeout(function() {
        console.log("1");
    }, delay);
    setTimeout(function() {
        console.log("2");
    }, longerDelay); 
    ```

    ...要小心，这`longerDelay`真的比`delay`你在日程安排上不会有一点混乱的时间要长得多。

注意我在上面说的是“线程”。除非您使用具有特定语法的[网络工作者，否则浏览器上的 JavaScript 是](http://www.w3.org/TR/workers/)*单线程的*。两个 JavaScript 函数不能同时运行，除了边缘情况下的浏览器错误`alert`和 ajax 完成等（至少某些版本的 Firefox 会在您等待函数时运行您的 ajax 完成回调`alert`；奇怪但真实，没有什么可以依赖的在跨浏览器甚至跨版本上），您不能在运行另一个 JavaScript 函数时暂停一个 JavaScript 函数。

# ios - uiview 在 uitablecell 之上

> ID：10689552
> 
> 赞同：0
> 
> 时间：2012-05-21T17:12:59.967
> 
> 标签：ios, uiview, uitableview

我有一个带有自定义表格视图单元格的自定义表格视图。我有一个带有三个按钮的 uiview。如何设置选择一行时，Uiview将在单元格上弹出？基本上我想要一个弹出框控制器。uiview 应该在表视图控制器内部吗？我的目标是 iphone，不能使用人们的项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:16:41.593

这取决于您的弹出视图是否完全适合单元格。

如果是这样，当您构建单元格时，添加弹出视图并标记它`hidden`。然后，当代理被告知单元格已被选中时，更改`hidden`为`NO`（您甚至可以使用`alpha`并将其包裹在里面`[UIView animateWithDuration:animations:]`以使其淡入）。

如果没有，那么您需要提前准备好弹出视图，并在选择单元格时直接将其添加到窗口中。您需要使用`frame`单元格的 和`[cell convertRect:to:]`方法来适当地定位您的视图。您还需要确保添加“背景”`UIView`以确保杂散触摸无法到达`UITableView`下方。

# javascript - 在像 iframe 一样的警报窗口中显示 HTML？

> ID：10689556
> 
> 赞同：6
> 
> 时间：2012-05-21T17:13:24.413
> 
> 标签：javascript, html

我想像 iframe 一样在警报窗口中显示 HTML ..？我可以这样做吗...

```
<script>
alert("<html><body><h1>this is alert heading</h1></html></body>")
</script> 
```

我怎样才能做到这一点..？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T17:16:33.957

如果您询问如何在警告框中显示 HTML 标记本身，请将其转义：

```
alert("\<html\>\<body\>\<h1\>this is alert heading\</h1\>\</html\>\</body\>") 
```

如果您询问如何使用 HTML 格式化警报框，则不能。正如其他答案之一所示，您需要创建一个模式对话框。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-21T17:17:01.883

我不会使用警报，而是使用弹出窗口。我建议你使用类似 jQuery Dialog 的东西，看看[http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

样本 ：

首先，创建一个 div 来包装你的 html 元素，

```
<div id='my-dialog-id' title='my dialog title'>
  <h1>this is alert heading</h1>
</div> 
```

然后在 jQuery 和 jQueryUI 中包含一些 javascript

```
 <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script>
  $(function() {
    $("#my-dialog-id").dialog(); //Here I select a div with id my-dialog-id and start the plugin.
  } );
  </script> 
```

它已经准备好了！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-21T17:15:49.093

你不能通过`alert()`.

您可以使用模态对话框来模仿它。有很多模态对话框库[——jQuery UI](http://jqueryui.com/demos/dialog/)有一个非常强大的。

# iphone - iOS5 显示一条 MIME 消息

> ID：10689558
> 
> 赞同：2
> 
> 时间：2012-05-21T17:13:53.597
> 
> 标签：iphone, objective-c, ios5, uiview, uilabel

我正在寻找向用户显示 MIME 消息的最佳方式。实际上，它不是电子邮件消息，而是封装在 MIME 正文中的新闻组 (NNTP) 消息。目前我在 UILabel 中显示它，但有几个问题，例如回复和内部链接的引用。将其显示为类似于 Apple 的内置电子邮件应用程序会很棒。

有人对此有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:33:24.233

好的，我已经从邮件中删除了 MIME 标头，并使用 ViewDidLoad 中的以下代码设置了基本的 HTML 结构...

```
//setting up html body
NSMutableString *body = [[NSMutableString alloc] init];
NSString *head = @"<HTML><HEAD></HEAD><body>";
NSString *footer = @"</body></HTML>";

//css settings
NSMutableString *css = [[NSMutableString alloc] init];
[css appendString:@"word-wrap: break-word;"];
[css appendString:@"font-family: 'Helvetica', Verdana, Arial, serif;"];
[css appendFormat:@"font-size: 11pt;"];

//building html string
[body appendString:head];
[body appendFormat:@"<div style=\"%@\">", css];

NSString *HTMLbody = [MYPLAINTEXTBODYSTRING stringByReplacingOccurrencesOfString:@"\n" withString:@"<br/>"];  
[body appendString:HTMLbody];
[body appendString:@"</div>"];
[body appendString:footer];

self.MYSTRINGBODYPROPERTY = body; 
```

...并在 UIWebView 中加载之前创建的主体。

```
[[[bodyWebView subviews] lastObject] setScrollEnabled:NO];

[bodyWebView loadHTMLString:self.body baseURL:nil];

[bodyWebView sizeToFit]; 
```

现在一切看起来都类似于 Apples Mail App。谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T18:20:52.213

虽然我还没有尝试过，但我想`WebView`最好处理这个问题。

# javascript - GridView OnSelectedIndexChanged 调用 JavaScript 函数

> ID：10689560
> 
> 赞同：0
> 
> 时间：2012-05-21T17:14:02.930
> 
> 标签：javascript, asp.net, selectedindexchanged

我可以在 GridView 的 SelectedIndexChanged 事件上调用 JS 函数吗？我提到了这两个 SO 帖子 - [帖子 1](https://stackoverflow.com/questions/9714906/call-jquery-function-on-onselectedindexchanged)和 [帖子 2](https://stackoverflow.com/questions/4973340/call-javascript-function-from-gridview-rowdeleting-event)解决了这个问题，但它们没有帮助。

我试过

```
OnSelectedIndexChanged="selectedindexchanged()" 
```

然而，作为回报，我收到了——

```
'ASP.default_aspx' does not contain a definition for 'selectedindexchanged' and no 
extension method 'selectedindexchanged' accepting a first argument of type  
'ASP.default_aspx' could be found (are you missing a using directive or an 
assembly reference?) 
```

任何人都可以确认这是否可以做到，以及是否可以正确的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:34:33.330

`OnSelectedIndexChanged`是[**服务器事件**](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.onselectedindexchanged.aspx)，而不是 javascript 事件。

服务器控件`GridView`不允许挂钩开箱即用的 javascript 方法。

您需要扩展它并创建此类方法，或使用其他可作为第 3 方的网格控件。

* * *

你可以做的，所以你不会在代码中搞砸太多，例如，使用 jQuery 连接到所有行并在单击该行上的某些内容时触发一个事件，保持返回（提交表单返回服务器）。

为此，您需要查看输出 HTML 并从那里开始。

**这是**我转移到 MVC 而不是继续使用 WebForms 的众多功能之一，在 MVC 中，您可以完全控制页面中发生的事情，并且您可以自己做所有事情，而不必担心这些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-16T23:31:30.627

使用 Row Data Bound Event 绑定您的 java 脚本函数，

```
protected void myGridView_RowDataBound(object sender, GridViewRowEventArgs e)
        {
            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                DataRowView drv = (DataRowView)e.Row.DataItem;
                e.Row.Attributes.Add("onclick", "selectedindexchanged()");
            }
        } 
```

现在，当您单击网格视图行时，`selectedindexchanged`将调用 。

# tfs - 如何使用 TFSBuild 处理构建准备好构建的工作项？

> ID：10689561
> 
> 赞同：0
> 
> 时间：2012-05-21T17:14:05.710
> 
> 标签：tfs, msbuild, nant, tfsbuild

我正在研究输出构建中包含的工作项/变更集列表的正确方法。在我当前的 NAnt 脚本化每日构建过程中，我有一个目标，它创建一个基于 TFS 查询被视为“准备构建”的票证或工作项和变更集的列表。使用 TFSBuild 处理此问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:49:38.447

在签入源代码管理时关联工作项和变更集。构建完成后，在构建摘要窗口中，您将找到构建中包含的工作项和变更集列表。

# jquery - jQuery 检查哪个选择已触发

> ID：10689563
> 
> 赞同：1
> 
> 时间：2012-05-21T17:14:22.227
> 
> 标签：jquery

我有一个 jQuery 函数，可以在两个选择标签更改中的任何一个上触发，但我的问题是我在检查哪个选择标签已触发的条件下做错了什么

```
$(document).ready(function(){
    $('#aqQuestionIoli .ConceptSelector1,#aqAnswerIoli .ConceptSelector1').on('change',function(){
        var concetp = $(this).val();
        alert(concetp);
        $.getJSON("http://localhost/Mar7ba/InformationObject/getIOsForConcept/"+concetp+"/TRUE",function(data){
            var options = '<option>Select IO</option>';
            for(var i=0;i<data.length;i++){
                options+="<option>"+data[i]+"</option>";
            }
            if ($('#aqQuestionIoli .ConceptSelector1').length){
                $("#aqIoQuesSelector").html(options);
            }
            if ($('#aqAnswerIoli .ConceptSelector1').length){
                $("#aqIoAnswerSelector").html(options);
            }
        });
    });
}); 
```

[代码html在这里](http://jsfiddle.net/QDvwK/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:20:34.597

如果你指的是这部分：

```
 if ($('#aqQuestionIoli .ConceptSelector1').length){
                $("#aqIoQuesSelector").html(options);
            }
            if ($('#aqAnswerIoli .ConceptSelector1').length){
                $("#aqIoAnswerSelector").html(options);
            } 
```

他们没有检查触发了哪个选择标签。只是检查文档是否有该元素。

尝试

```
$(document).ready(function(){
    $('#aqQuestionIoli .ConceptSelector1,#aqAnswerIoli .ConceptSelector1').on('change',function(){
        var concetp = $(this).val();
        alert(concetp);
        var thisid = this.id;
        $.getJSON("http://localhost/Mar7ba/InformationObject/getIOsForConcept/"+concetp+"/TRUE",function(data){
            var options = '<option>Select IO</option>';
            for(var i=0;i<data.length;i++){
                options+="<option>"+data[i]+"</option>";
            }
            if (thisid == 'aqQuestionIoli')){
                $("#aqIoQuesSelector").html(options);
            }
            if (thisid == 'aqAnswerIoli'){
                $("#aqIoAnswerSelector").html(options);
            }
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:28:49.193

```
$(document).ready(function(){
    $('#aqQuestionIoli .ConceptSelector1,#aqAnswerIoli .ConceptSelector1').on('change',function(){
        var concetp = $(this).val();
        alert(concetp);
        var context = this;
        $.getJSON("http://localhost/Mar7ba/InformationObject/getIOsForConcept/"+concetp+"/TRUE",function(data){
            var options = '<option>Select IO</option>';
            for(var i=0;i<data.length;i++){
                options+="<option>"+data[i]+"</option>";
            }
            if (context === $('#aqQuestionIoli .ConceptSelector1')[0]){
                $("#aqIoQuesSelector").html(options);
            }
            if (context === $('#aqAnswerIoli .ConceptSelector1')[0]){
                $("#aqIoAnswerSelector").html(options);
            }
        });
    });
}); 
```

看一个简单的例子： http: [//jsfiddle.net/6zsnx/1/](http://jsfiddle.net/6zsnx/1/) 同样，有很多方法可以做到这一点。如果我们能看到您的 HTML，我们可能会给您一个更清晰的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T17:30:22.863

您可以只使用`id`来分配选项，这样您甚至不需要检查哪些已更改：

```
var id = $(this).attr('id');
$('#' + id).html(options); 
```

我还没有测试过，但我不明白为什么那行不通（除非我错过了什么:|）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T17:31:08.883

```
$(document).ready(function(){
    $('#aqQuestionIoli .ConceptSelector1,#aqAnswerIoli .ConceptSelector1').on('change',function(){
        var concetp = $(this).val();
        var select = $(this).attr('id');
        console.log(select);
        var $this = $(this);
        // the value of select can tell which select was fired.
        $.getJSON("http://localhost/Mar7ba/InformationObject/getIOsForConcept/"+concetp+"/TRUE",function(data){
            var options = '<option>Select IO</option>';
            for(var i=0;i<data.length;i++){
                options+="<option>"+data[i]+"</option>";
            }
            $this.html(options);

        });
    });
}); 
```

# shell - 在 ksh 中调用一个单独的作业/shell 文件并等待它完成执行，然后再继续

> ID：10689572
> 
> 赞同：0
> 
> 时间：2012-05-21T17:15:04.987
> 
> 标签：shell, unix, scripting, ksh

我打算从主脚本调用一个 shell 脚本并等待它完成，然后再进一步处理主脚本，

我试过做

```
xyz_Sh &
while [[ $cnt -gt 0 ]] ; do
cnt=`ps -ef| grep "xyz_Sh" |grep -v grep |wc -l`
done 
```

我也尝试使用等待

```
. xyz_Sh & 
wait_id=$!
wait $wait_id 
```

但在这种情况下，控件不会返回到主程序，脚本在执行 xyz_Sh 后停止，我在这里缺少什么？

谢谢

阿里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:21:49.587

除非将某些内容放入后台，`xyz_Sh`否则默认的 shell 行为应该完全符合您的要求。

在 shell 脚本中，在前一个命令结束之前不会执行命令，因此：

```
xyz_Sh
//do other stuff 
```

应该完全按照您的意愿工作。

另一方面，`xyz_Sh` *如果确实*将事情放在后台，那么您应该更改`xyz_Sh`以等待其所有进程完成后再退出。这可以通过`wait`命令来完成。

# jquery - jQuery Animate Div 滚动回到顶部

> ID：10689573
> 
> 赞同：19
> 
> 时间：2012-05-21T17:15:08.027
> 
> 标签：jquery

我有一个包含以下内容的 div：

```
<div id="First">There are lots of content in here. Blah Blah Blah...</div> 
```

有`div`一个 style 属性，`overflow:auto;`所以如果任何内容溢出，就会出现一个滚动条。我在内容末尾的 div 中有一个按钮。

由于 div 内的内容可以允许深度滚动，无论如何，单击按钮会将滚动移回 div 的顶部吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-05-21T17:17:38.813

是的。使用[滚动顶部](http://api.jquery.com/scrollTop/)

只需提供您的元素和 0 值，如下所示：

```
$('#id').scrollTop(0); 
```

您还可以像这样为滚动返回顶部设置动画：

```
$('#id').animate({
   scrollTop: 0
}, 'slow'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T17:20:37.933

为此，您不需要 jQuery（甚至 JavaScript）。

## [演示](http://jsfiddle.net/syjbT/)

定义锚名称：

```
<a name="top"></a> 
```

并在底部创建指向此锚点的链接：

```
<a href="#top">back to top</a>​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T17:18:03.400

如果您正在处理 y 溢出和/或[ScrollLeft](http://api.jquery.com/scrollLeft/)处理 x 溢出，请使用[ScrollTop](http://api.jquery.com/scrollTop/)。

```
$('#yourbuttonid').click(function() {
    $('#First').scrollTop(0);//for vertical scroll
    $('#First').scrollLeft(0);//for horizontal scroll
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T17:18:11.820

```
$('#scrollToTopButton').click(function(){
    $('#First').scrollTop(0);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T17:35:33.267

杀戮！就此而言，使用 scrollTop 或 jquery ......对于这样一个简单的任务可能是不可取的。改用锚点：

```
<a name="pageTop"></a>
....
<a href="#pageTop">TOP</a> 
```

或者还有什么你想做/实现的？

# wcf - WCF 客户端使用 WS-Security 连接到 Java SOAP Web 服务

> ID：10689583
> 
> 赞同：2
> 
> 时间：2012-05-21T17:15:59.340
> 
> 标签：wcf, soap, ws-security

我在使用 SOAP 1.1 连接到 Java Web 服务的 .NET WCF 客户端时遇到问题。该服务需要 SSL 上的传输级别加密和使用 WS-Security 协议的 SOAP 安全性，两者都使用相同的证书。我已经安装了证书，并且可以连接到服务器，但是，当我发布请求时，我得到了 HTTP 500 响应。

我已经能够将 WCF 生成的 SOAP 与 Web 服务开发人员的工作示例进行比较。WCF SOAP 消息具有额外的 Timestamp 和 BinarySecurityToken 元素，这些元素在提供的示例中没有出现。我对 WS-Security 几乎一无所知，对 WCF 知之甚少，所以我希望有人能指出我正确的方向。

这是我的应用程序的配置部分：

```
 <?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="JavaServiceSoapBinding" closeTimeout="00:01:00"
            openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
            allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
            maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
            messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
            useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
              maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="TransportWithMessageCredential">
            <transport clientCredentialType="Certificate" proxyCredentialType="None"
                realm="" />
            <message clientCredentialType="Certificate" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="https://service/endpoint"
          binding="basicHttpBinding" bindingConfiguration="JavaServiceSoapBinding"
          contract="MyCode.MyService" name="MyServicePort" behaviorConfiguration="endpointBehavior">
      </endpoint>
    </client>
    <behaviors>
      <endpointBehaviors>
        <behavior name="endpointBehavior">
          <clientCredentials>
            <clientCertificate storeLocation="LocalMachine" storeName="My" findValue="A1A1A1A1" x509FindType="FindBySerialNumber"/>
            <serviceCertificate>
              <authentication certificateValidationMode="None" revocationMode="NoCheck"/>
            </serviceCertificate>
          </clientCredentials>
        </behavior>
      </endpointBehaviors>
    </behaviors>
  </system.serviceModel>
</configuration> 
```

这是我从负责服务的合作伙伴那里获得的示例 SOAP 标头：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:web="http://webservice.connector.speechanalytics.ept.avaya.com/">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <ds:Signature Id="Signature-5" xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
        <ds:SignedInfo>
          <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
          <ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
          <ds:Reference URI="#id-6">
            <ds:Transforms>
              <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
            </ds:Transforms>
            <ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
            <ds:DigestValue>blablabla=</ds:DigestValue>
          </ds:Reference>
        </ds:SignedInfo>
        <ds:SignatureValue>
          blablabla=
        </ds:SignatureValue>
        <ds:KeyInfo Id="KeyId-blablabla">
          <wsse:SecurityTokenReference wsu:Id="STRId-blablabla" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
            <ds:X509Data>
              <ds:X509IssuerSerial>
                <ds:X509IssuerName>CN=Dept,OU=Product,O=Company,L=Location,ST=BLA,C=BLA</ds:X509IssuerName>
                <ds:X509SerialNumber>1319578157</ds:X509SerialNumber>
              </ds:X509IssuerSerial>
            </ds:X509Data>
          </wsse:SecurityTokenReference>
        </ds:KeyInfo>
      </ds:Signature>
    </wsse:Security>
  </soapenv:Header>
  <soapenv:Body wsu:Id="id-6" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"> 
```

这是 WCF 生成的 SOAP 消息：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" xmlns:u="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
  <s:Header>
    <o:Security s:mustUnderstand="1" xmlns:o="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <u:Timestamp u:Id="_0">
        <u:Created>2012-05-21T15:02:36.448Z</u:Created>
        <u:Expires>2012-05-21T15:07:36.448Z</u:Expires>
      </u:Timestamp>
      <o:BinarySecurityToken u:Id="uuid-abd451ed-9bff-4cd0-b9a6-38fcd6bf9e8b-1" ValueType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3" EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">blablabla==</o:BinarySecurityToken>
      <Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
        <SignedInfo>
          <CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
          <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
          <Reference URI="#_0">
            <Transforms>
              <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
            </Transforms>
            <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
            <DigestValue>+blablabla=</DigestValue>
          </Reference>
        </SignedInfo>
        <SignatureValue>blablabla=</SignatureValue>
        <KeyInfo>
          <o:SecurityTokenReference>
            <o:Reference ValueType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3" URI="#uuid-abd451ed-9bff-4cd0-b9a6-38fcd6bf9e8b-1"/>
          </o:SecurityTokenReference>
        </KeyInfo>
      </Signature>
    </o:Security>
  </s:Header>
  <s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:39:24.807

你有任何关于服务器失败原因的详细信息吗？消息不必完全相同。尝试查看 http 500 正文是否包含某些内容，或者供应商是否可以从日志中告诉您。

接下来恢复为自定义绑定而不是基本httpbinding（[自动在线](http://webservices20.cloudapp.net/)执行此操作）并在安全元素绑定上添加属性includeTimestamp="false"。

先试试这个（并得到消息）。workign w/o BinarySecurityToken 也是可能的，但在这个阶段稍微复杂一些。

# jquery - jQuery：为什么删除可拖动的父级会破坏可拖动？

> ID：10689592
> 
> 赞同：0
> 
> 时间：2012-05-21T17:16:26.937
> 
> 标签：jquery, draggable

我遇到了这个问题，试图提高处理大量可拖动列表的性能；我尝试删除父容器，以便批处理项目会变得更快（因此每个处理都不会触发 DOM 刷新），然后重新插入容器确实会导致可拖动对象停止工作。例如

```
<div id="listParent">
<div id="listWrapper">
    <ul id="draggableList">
       <li class="draggable">Item 1</li>
       <li class="draggable">Item 2</li>
       <li class="draggable">Item 3</li>
       <li class="draggable">Item 4</li>
       <li class="draggable">Item 5</li>
       <!-- many more items here -->
    </ul>
</div>
</div>
<script type="text/javascript">
$(function() {
   $( ".draggable" ).draggable({
      revert: true
   });

   function filterItems(text) {
      var p = $('#listWrapper').remove();

      // for each <LI> element, hide the ones who do not match `text`'s value

      p.appendTo('#listParent');
   }
   // ...
});
</script> 
```

因此，例如，调用`filterItems('foo');`会使项目不再是可拖动的。我是否必须再次在`<LI>`元素上重新应用可拖动？如果是这样，那么如果我必须在之后重新申请某些东西，那么删除父母以加快流程是没有意义的，是吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:25:55.793

使用`.detach()`而不是`.remove()`保留附加的事件处理程序。这是文档的摘录。

> .remove() 方法将元素从 DOM 中取出。当您想要删除元素本身以及其中的所有内容时，请使用 .remove()。除了元素本身，所有与元素关联的绑定事件和 jQuery 数据都将被删除。**要删除元素而不删除数据和事件，请改用 .detach()。**

强调我的。

这是一个[小提琴](http://jsfiddle.net/Ypd9d/2/)。

# mysql - 在 MySQL 中使用 OR 和 HAVING 与使用 AND

> ID：10689595
> 
> 赞同：0
> 
> 时间：2012-05-21T17:16:33.953
> 
> 标签：mysql, coldfusion, large-data-volumes, having

我正在处理一个 Coldfusion8/MySQL 查询，其中我正在扫描数据库中的 AB 对，例如：

```
 S=2, M=2, L=2, XL=2 
```

我正在尝试改进最初处理此问题的脚本，该脚本将条目限制为 4 对，因为我想知道，为什么它首先选择具有**一**对匹配的所有记录，然后使用*HAVING*仅选择**所有**对匹配的记录.

这是**原始**查询，之后是我的当前版本：

```
<!--- placeholders --->
<cfparam name="s01" default="">
<cfparam name="s02" default="">
<cfparam name="s03" default="">
<cfparam name="s04" default="">
<cfparam name="q01" default="">
<cfparam name="q02" default="">
<cfparam name="q03" default="">
<cfparam name="q04" default="">
<!--- check length of user inputs --->
<cfset sizes = ListLen(s_lot_groesse,",")>
<cfset qtys   = ListLen(s_lot_menge,",")>
<!--- populate placeholders --->
<cfif sizes gt 0><cfset s01 = trim(ListGetAt(s_lot_groesse, 1,","))></cfif>
<cfif sizes gt 1><cfset s02 = trim(ListGetAt(s_lot_groesse, 2,","))></cfif>
<cfif sizes gt 2><cfset s03 = trim(ListGetAt(s_lot_groesse, 3,","))></cfif>
<cfif sizes gt 3><cfset s4 = trim(ListGetAt(s_lot_groesse, 4,","))></cfif>
<cfif qtys gt 0><cfset q01 = trim(ListGetAt(s_lot_menge, 1,","))></cfif>
<cfif qtys gt 1><cfset q02 = trim(ListGetAt(s_lot_menge, 2,","))></cfif>
<cfif qtys gt 2><cfset q03 = trim(ListGetAt(s_lot_menge, 3,","))></cfif>
<cfif qtys gt 3><cfset q04 = trim(ListGetAt(s_lot_menge, 4,","))></cfif>
<!--- query --->
<cfquery datasource="db" name="lotsuche">
SELECT styleno, count(*) as total_styles
FROM styles
WHERE 1 = 1
AND (
    <cfif s01 neq "" AND q01 neq "">(groesse = "#s01#" AND bestand >= "#q01#")</cfif>
    <cfif s02 neq "" AND q02 neq "">OR (groesse = "#s02#" AND bestand >= "#q02#")</cfif>
    <cfif s03 neq "" AND q03 neq "">OR (groesse = "#s03#" AND bestand >= "#q03#")</cfif>
    <cfif s04 neq "" AND q04 neq "">OR (groesse = "#s04#" AND bestand >= "#q04#")</cfif>
    )
GROUP BY styleno
HAVING total_styles= "#sizes#"
</cfquery> 
```

新版本：

```
<!--- build a 2D array --->
<cfscript>
    variables.lotArray = ArrayNew(2);
    variables.sizeCounter = 1;
    variables.qtyCounter = 1;
</cfscript>
<cfloop list="#LOCAL.Search.s_lot_groesse#" delimiters=", " item="size">
    <cfscript>
        variables.lotArray[variables.lotCounter][1] = size;
        variables.lotCounter = variables.lotCounter + 1;
    </cfscript>
</cfloop>
<cfloop list="#LOCAL.Search.s_lot_menge#" delimiters=", " item="qty">
    <cfscript>
        variables.lotArray[variables.qtyCounter][2] = qty;
        variables.qtyCounter = variables.qtyCounter + 1;
    </cfscript>
</cfloop>
<!--- get array length --->
<cfset variables.lotArrayLen = arrayLen(variables.lotArray)>

<!--- query --->
<cfquery datasource="ds" name="lotsuche">
SELECT art.styleNo, count(*) as total_styles
FROM styles AS art
WHERE 1 = 1
<cfloop from="1" to="#variables.lotArrayLen#" index="i">
    AND ( art.groesse = <cfqueryparam cfsqltype="cfsql_varchar" value="#variables.lotArray[i][1]#"> 
    AND art.bestand >= <cfqueryparam cfsqltype="cfsql_varchar" value="#variables.lotArray[i][2]#">
</cfloop>
GROUP BY art.styleno
<!--- HAVING anzahl = "#variables.lotArrayLen#" --->
</cfquery> 
```

**问题：**
我不明白为什么在原始查询中使用**OR**和**HAVING**，因为这不是选择具有**一**对匹配的所有记录而不是仅选择具有所有对匹配的记录吗？如果要扫描几百万个条目，哪种方法更好/更快？另外，像我一样重新考虑整个事情是否有意义？

感谢帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T18:06:16.027

HAVING 子句与聚合函数一起使用，OR 用于测试查询中的多个条件。我不确定旧查询中的 having 子句的目的。您是否彻底测试了您的新查询以确保获得预期的结果？

查看两个查询后，您的第二个查询将无法正常工作。这两条记录可能有多个需要满足的条件，并且查询可能会返回一个空记录集。

我认为您正在寻找更像这样的东西。

```
AND
 <cfloop from="1" to="#variables.lotArrayLen#" index="i">
 (  OR (art.groesse = <cfqueryparam cfsqltype="cfsql_varchar" value="#variables.lotArray[i][1]#"> 
AND art.bestand >= <cfqueryparam cfsqltype="cfsql_varchar" value="#variables.lotArray[i][2]#"> ) ) 
```

# php - 基于 URL 生成动态元标记

> ID：10689600
> 
> 赞同：3
> 
> 时间：2012-05-21T17:16:41.277
> 
> 标签：php, dynamic, meta-tags

我正在尝试为每个页面动态分配专有元标记：

即： **url.com/index.php?action=signup**

标题 - 注册标题

关键字 - 注册元关键字

说明 - 注册说明

**url.com/index.php?action=about**

标题 - 关于标题

关键字 - 关于元关键字

说明 - 关于说明

你明白了。

我正在使用数组......但还没有想出如何将每个数组分配给每个页面。

**配置文件**

```
<?php
$metas = array( 
'index.php' => array( 
'header' => 'Home Title', 
'keywords' => 'Home Meta Keywords', 
'description' => 'Home Meta Description' 
), 
'signup' => array( 
'header' => 'Signup Title', 
'keywords' => 'Signup Meta Keywords', 
'description' => 'Signup Meta Description' 
), 
'about' => array( 
'header' => 'About Title', 
'keywords' => 'About Meta Keywords', 
'description' => 'About Meta Description' 
) 
);
?> 
```

**索引.PHP**

```
<TITLE><?php echo $metas['title']; ?></TITLE>
<meta name="description" content="<?php echo $metas['description']; ?>" >
<meta name="keywords" content="<?php echo $metas['keywords']; ?>" > 
```

如何将这些值分配给每一页？？？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T17:56:46.993

你走在正确的轨道上:-)

请按以下方式进行：

```
<TITLE><?php echo $metas['index.php']['title']; ?></TITLE> 
```

您可以从 $_SERVER 超级全局数组/变量中获取脚本名称。

同样从您的 config.php 文件中删除最后 3 行，您不需要它们。

祝你好运，使用 PHP 可以确保你对使用数组有很好的了解。这是关键。

编辑：

```
$page = 'index.php';
if ( isset( $_GET['action'] ) && $_GET['action'] != "" )
{
    $page = $_GET['action'];
}

<TITLE><?php echo $metas[$page]['title']; ?></TITLE> 
```

编辑：（2012 年 5 月 27 日）

我认为这几乎就是一切：

您在 config.php 中的代码

```
<?php

$meta['INDEX']['title'] = "Home page";
$meta['INDEX']['keywords'] = "kwd1, kwd2, kwd3";
$meta['INDEX']['description'] = "Home description";

$meta['SIGNUP']['title'] = "Sign up..!";
$meta['SIGNUP']['keywords'] = "kwd1, kwd2, kwd3";
$meta['SIGNUP']['description'] = "Sign up description";

$meta['ABOUT']['title'] = "About Company";
$meta['ABOUT']['keywords'] = "kwd1, kwd2, kwd3";
$meta['ABOUT']['description'] = "About company description"; 
```

您在任何应用程序页面/屏幕（.php 文件）中的代码：

```
<?php

include "config.php";

// Choice 1: if you want to specify page hardcoded at each page then you can say $page = 'ABOUT' for about-us page and $page = 'INDEX' for home page etc.
$page = 'ABOUT';
if( strtoupper($_SERVER['REQUEST_URI'], $page) !== false )
{
    $title = $meta[$page]['title'];
    $keywords = $meta[$page]['keywords'];
    $description = $meta[$page]['description'];
}
// Now you have your meta - use it the way you want
echo $title;

// Choice 2: If you want to make it little more dynamic
// Here you don't need to define any hardcoded variable at page level as everything will be considered from the URL being requested
$page_index = array_keys($meta);

foreach($page_index as $page)
{

    if ( strpos( strtoupper($_SERVER['REQUEST_URI']), $page ) !== false)
    {
        $title = $meta[$page]['title'];
        $keywords = $meta[$page]['keywords'];
        $description = $meta[$page]['description'];
        break;
    }
}
// Now you have your meta - use it the way you want
echo $title;

?> 
```

# php - GetElementById、getAttribute 和 StrPos 的 PHP 问题

> ID：10689601
> 
> 赞同：1
> 
> 时间：2012-05-21T17:16:43.630
> 
> 标签：php

我是 PHP 的相对初学者，我正在尝试开发的网络爬虫脚本存在问题。该脚本旨在抓取一个VBulletin 论坛页面，然后解析页面上的超链接以查找包含特定“id”元素的超链接（即仅指向论坛上发布的消息线程的链接）。每个所需链接都包含一个以“thread_title_[Thread # here]”开头的“id”元素。我想出了使用 STRPOS 作为过滤器来检查收集到的链接中的每个“id”元素并检查它们是否包含片段“thread_title”的想法。不幸的是，我的努力似乎没有结果。

我将粘贴下面的代码摘录......冒着被标记为完全菜鸟的风险。;) 希望我没有做一些非常愚蠢的事情。谢谢您的帮助

```
 $d = new domdocument();

   $d->loadHTMLfile("forum3.html");

    $links = $d->getElementsByTagName('a');
    echo '<html xmlns="http://www.w3.org/1999/xhtml" encoding="utf-8" lang="ar-sa">';

    foreach ($links as $link)
    {
        $threadTitleExists = $link->getAttribute('id');
        $pos = strpos($threadTitleExists, 'thread_title');  
        $threadTitle = $link->nodeValue;
        if ($link->hasAttribute('id') && ($pos==0))
        {    
             $threadTitle = trim(preg_replace('#/\s*\([^)]*\)/', ' ', $threadTitle));
             echo "Thread number: " . $threadTitleExists . "<br>Thread title: " . $threadTitle . "<p>";
        }

         else 
         {

             continue;

         }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T18:15:24.600

换行

```
if ($link->hasAttribute('id') && $pos != false) 
```

至

```
if ($link->hasAttribute('id') && $pos !== false) 
```

[如果 haystack 以 needle 开头，则strpos()](http://php.net/manual/en/function.strpos.php)返回 0，当使用松散类型的比较运算符时，它的计算结果为 false。手册页（链接）上有一条警告，请改用`===`运算符。

# c - C中的答案模棱两可

> ID：10689608
> 
> 赞同：-1
> 
> 时间：2012-05-21T17:17:08.463
> 
> 标签：c

> **可能重复：**
> [谁能解释这些未定义的行为（i = i++ + ++i，i = i++ 等……）](https://stackoverflow.com/questions/949433/could-anyone-explain-these-undefined-behaviors-i-i-i-i-i-etc)

我听说 printf 函数从右到左执行并从左到右打印。按照这个约定，下面的程序应该给出 7,6,5。但它在我的 linux gcc 编译器上给出了 7,7,7。它依赖于编译器吗？

```
int i=5;
printf("%d %d %d\n",++i,++i,i); 
```

另外，我们可以使用 cdecl/pascal 关键字来改变 printf 的执行顺序吗？如果是，我们该怎么做？我一直在尝试这样做，但没有成功。提前谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:20:18.763

函数调用中的标准没有规定顺序，因此可以按照编译器认为合适的任何顺序评估参数。因此，如果您在评估参数时有副作用，您会得到未定义的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:20:56.657

您的代码中的评估顺序未定义，因为没有序列点。您不能中继函数参数的评估顺序，也不能更改它。

检查[http://www2.research.att.com/~bs/bs_faq2.html#evaluation-order](http://www2.research.att.com/~bs/bs_faq2.html#evaluation-order)

# php - 检查表中是否存在具有特定值的特定行

> ID：10689609
> 
> 赞同：1
> 
> 时间：2012-05-21T17:17:08.813
> 
> 标签：php, mysql

我编写了这段代码并且它可以工作，但我仍然想知道是否还有其他更好更简单的解决方案。

```
$sql = "select * from db_member where username = '$name'";
$result = mysql_query($sql) or error(mysql_error());
if(mysql_num_rows($result) < 1) 
{
error("There is no user with name '$name'.");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:21:13.460

不，没有任何其他细节，这是一个很好的解决方案。但是，您可以查看以下几点：

*   照顾好你的索引。如果您可以在某些索引列上使用 where 子句，那将是完美的
*   如果您打算在插入之前检查元素的存在，我宁愿捕捉错误而不是像您正在做的那样检查。
*   您确实可以减少开销，减少选择范围，就像另一位成员提到的那样

rgds

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:19:57.933

一种更快的方法：

```
$result = mysql_query("SELECT COUNT(1) FROM db_member WHERE username='".mysql_real_escape_string($name)."'") or die(mysql_error());
if (mysql_result($result, 0) == 0) {
    echo 'There is no user with name ' . htmlspecialchars($name, ENT_QUOTES, 'UTF-8') . '.';
} 
```

请检查[http://php.net/pdo](http://php.net/pdo)以获得更好的错误处理和查询参数....

我认为不应该再以这种方式使用 mysql_query 了。

# ruby-on-rails - 使用 rails 3.2 在生产模式下从访客那里获取城市、国家和 IP

> ID：10689618
> 
> 赞同：0
> 
> 时间：2012-05-21T17:17:41.173
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, rails-geocoder

我已经在生产服务器的项目 rails 中安装了[http://www.rubygeocoder.com/](http://www.rubygeocoder.com/)但是我的生产服务器中的这个 gem 对我来说不能正常工作......

我正在使用mongoid。

我在我的开发环境中的视图中编写了这些方法并且工作正常：

```
<%= request.ip %>   
<%= request.location.city %>    
<%= request.location.country %> 
```

我得到： `127.0.0.1 Reserved`

这个结果通常是因为我在 localhost 工作。

但是，在 linode 的生产服务器中使用 capistrano 进行部署后，这些方法出现错误，我可以在生产日志中看到下一个错误：

```
Completed 500 Internal Server Error in 909ms

ActionView::Template::Error (undefined method `location' for #<ActionDispatch::Request:0x00000005aa8570>): 
```

为什么我在生产服务器中针对这些方法出现此错误？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T09:52:15.080

问题已解决。感谢[https://github.com/alexreisner/geocoder/issues/239](https://github.com/alexreisner/geocoder/issues/239)上的 alexreisner 。

安装此 gem 后，您必须重新启动生产服务器。如果您希望该地理编码器可以正常工作。

重新启动我的 linode 服务器后，这个 gem 对我来说确实可以正常工作：D。

非常感谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:20:57.703

如果您正在开发中，请尝试使用

```
 request.remote_ip 
```

代替：

```
 request.ip 
```

我不确定它是否会起作用

# html - 元素定位 CSS

> ID：10689621
> 
> 赞同：0
> 
> 时间：2012-05-21T17:17:51.947
> 
> 标签：html, css, jquery-ui

我正在向固定大小的元素（使用 .append）添加新`span`元素。`div`当我添加许多元素时，'div' 会溢出滚动条。是否可以防止这种情况并将所有元素包装`div`在以表格格式显示的内容中？

我正在尝试的示例位于[http://jsfiddle.net/Hj3Qe/2/](http://jsfiddle.net/Hj3Qe/2/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:21:09.963

尝试：

```
#x{
    word-wrap:break-word;
}​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/Hj3Qe/3/)**。

这将使跨度保持在 div 的宽度内，尽管我不确定您在不使用表格的情况下使用表格格式寻找什么。为此，您可能希望将 CSS 规则添加 `display:inline-block;`到您的跨度中，并根据需要调整宽度。

**[jsFiddle 示例 #2](http://jsfiddle.net/j08691/Hj3Qe/4/)**。

```
span {
    width:20px;
    display:inline-block;
} 
```

# vb.net - 具有多个搜索条件的 Lambda 表达式

> ID：10689623
> 
> 赞同：3
> 
> 时间：2012-05-21T17:18:01.183
> 
> 标签：vb.net, lambda

目前我正在搜索我的列表以查找与地址匹配的客户。我需要匹配地址和城市。如何重写我的 lambda 表达式以匹配这两个条件？

CustomerList.FindAll(Function(c) c.Address = addressToMatch)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T17:20:13.363

您要查找的关键字是`AndAlso`. 它将两个单独的检查组合成一个单独的检查，评估是否`True`两个组件也是`True`

```
CustomerList.FindAll(Function(c) c.Address = addressToMatch AndAlso c.City = cityToMatch) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-17T10:04:38.417

有一个 nuget 包，可让您跨多个属性搜索字符串

## [https://www.nuget.org/packages/NinjaNye.SearchExtensions/](https://www.nuget.org/packages/NinjaNye.SearchExtensions/)

这将允许以下代码...

```
CustomerList.Search(addressToMatch, 
                    Function(c) c.Address, 
                    Function(c) c.City) 
```

当连接到 sql 数据库时，生成的 sql 将类似于：

```
SELECT [Extent1].[Address] AS [Address], 
       [Extent1].[City] AS [City]
FROM   [dbo].[Table] AS [Extent1]
WHERE ([Extent1].[Address] LIKE N'%searchTerm%') 
   OR ([Extent1].[City] LIKE N'%searchTerm%') 
```

希望这可以帮助

# python - 在 django 中组合查询

> ID：10689625
> 
> 赞同：0
> 
> 时间：2012-05-21T17:18:05.987
> 
> 标签：python, django, django-queryset

在我的应用程序中，我执行以下查找：

my_datapoint = Datapoint.objects.filter(timestamp_lte = desired_time).reverse()[0]

对于时间上不相邻的记录，我必须多次执行此操作。

有没有办法让这比拥有几个单独的查询集更有效？我可以把它们结合起来吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T17:24:23.893

这已经被问了很多次了。您可以使用`chain`

```
from itertools import chain

combined = chain(qs1, qs2, ...)
for item in combined:
    # foo 
```

完全分离查询集对象的一种替代方法是查看是否可以使用`Q`对象通过“OR”查询来完成：
[https ://docs.djangoproject.com/en/1.4/topics/db/queries/#complex-lookups-带有-q-objects](https://docs.djangoproject.com/en/1.4/topics/db/queries/#complex-lookups-with-q-objects)

*文档中的示例*

```
Poll.objects.get(
    Q(question__startswith='Who'),
    Q(pub_date=date(2005, 5, 2)) | Q(pub_date=date(2005, 5, 6))
) 
```

这个例子说“有一个问题以'谁'开头的对象，以及具有这个发布日期或那个发布日期的对象”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:43:12.277

通过“更高效”，我假设您的意思是您希望避免多次命中数据库。那样的话，你应该查询一次，然后自己循环遍历，同样使用QuerySet排序比`reverse()`

```
my_datapoint = Datapoint.objects.filter(timestamp_lte = max_desired_time).order_by('-timestamp')
def getLatest(desired_time):
    for item in my_datapoint:
        if item.timestamp <= desired_time:
            return item 
```

如果您只想要更简单的语法，请`chain`按照 jdi 的建议使用。

# javascript - 在 Javascript 中创建 KeyEvent

> ID：10689629
> 
> 赞同：3
> 
> 时间：2012-05-21T17:18:12.413
> 
> 标签：javascript, jquery, webkit, keydown, keyevent

我有以下问题 - 我正在捕获一个键事件，我需要创建一个新的更改键事件（因为 keyCode 属性似乎是只读的），然后处理新创建的 KeyEvent。我在 StackOverflow 中遇到了几篇处理类似情况的旧帖子，但是：

*   我需要它在 Webkit 下工作/在 StackOverfow 中有一个解决方案，但它只在 Gecko 中工作/

*   我需要创建另一个 KeyEvent，但不是 TextInputEvent，因为 TextInputEvent 只会让我指定要插入的字符串，而我不能这样做，因为我使用需要处理此事件的第三方工具并且我需要一个键码。

*   我试过`jQuery#trigger()`了，但它对我不起作用。我的代码如下

    ```
    var event = jQuery.event('keydown');
    event.which = 13; //I'm trying to simulate an enter
    $('iframe').contents().find('document').find('body').trigger(event); //my content is inside an iframe 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:30:23.330

```
(function($){
    $(window).load(function(){

        var e = $.Event("keydown");
        e.which = 13;
        e.keyCode = 13;
        $('iframe').contents().find('html, body').trigger(e);

    });
})(jQuery); 
```

# javascript - 谷歌地图中的动态矩形

> ID：10689630
> 
> 赞同：0
> 
> 时间：2012-05-21T17:18:18.980
> 
> 标签：javascript, xml, google-maps, dynamic

首先，我对 Javascript 很陌生，如果我的问题遇到问题，我很抱歉。

我正在 Flash 中创建一个应用程序来帮助用户计算他们的电费。然后我把这个数字写到一个 xml 文件中。

现在我正在寻找打开一个网页并显示一个谷歌地图，并且在地图上绘制了一个矩形，该矩形是根据之前生成的数字动态生成并存储在 xml 文件中的。

我完全不知道打开如何实现这一点的地方。我已经把我的地图放到了我的页面上，它可以按我想要的方式缩放 100%，但我根本无法弄清楚动态矩形部分。非常感谢任何朝着正确方向的想法或指示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T18:22:28.390

如果您只想在地图上放置一个矩形，您可以创建一个`google.maps.Rectangle`[^(api-doc)](https://developers.google.com/maps/documentation/javascript/reference#Rectangle)。如果您想在地图上创建一个矩形标签，您可能对 InfoBox Utility Library [^(wiki-page)](http://code.google.com/p/google-maps-utility-library-v3/wiki/Libraries#InfoBox)更感兴趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T18:28:16.830

[在这个最新版本](http://freezoo.alwaysdata.net/xmlrect4.html)中，XML 文件

```
<countries>
  <country name="USA" lat="40.0" lng="-100.0" width="30.0"/>
  <country name="France" lat="46.6" lng="2.7" width="10"/>
  <country name="Germany" lat="51.1" lng="10.1" width="20"/>
</countries> 
```

地图图块完成加载后立即加载。`getProjection`如果我不等待瓷砖加载完成，我将无法正确调用。文档指出，获取投影需要初始化地图，并建议收听`projection_changed`. 两种方式都有效，但我仍然觉得听 tiles_loaded 更安全，如果 xml 加载出现问题，如果地图被缩放或平移了相当大的数量，它将再次被调用。

```
 var map;
  var xmlLoaded = false;

  function initialize() {
    var mapOptions = { center: new google.maps.LatLng(30.0, 0.0), zoom: 2,
      mapTypeId: google.maps.MapTypeId.ROADMAP };

    map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
    google.maps.event.addListener(map, 'tilesloaded', loadData);
  }

  function loadData() {
    if(!xmlLoaded) {
     $.ajax({
      type: "GET",
      url: "co2data.xml",
      dataType: "xml",
      success: function(xml) {
        var countries = xml.documentElement.getElementsByTagName("country");
        for(var i = 0, country; country = countries[i]; i++) {
          var name = country.getAttribute("name");

          var lat = parseFloat(country.getAttribute("lat"));
          var lng = parseFloat(country.getAttribute("lng"));
          var point = map.getProjection().fromLatLngToPoint(new google.maps.LatLng(lat,lng));

          // width is really an arbitrary unit, relative to CO2 tonnage.
          // equals the side of the drawn square.
          // it is measured in google maps points units.
          var width = parseFloat(country.getAttribute("width"));

          makeCO2Rect(name, point, width);
        }
        xmlLoaded = true;
      }
     });
    }
  } 
```

矩形由以点为单位的宽度定义（整个世界是 256x256 点），因此在将它们的中心分配给更传统的 LatLng 时需要进行一些转换。

```
 function rectParamsToBounds(point, width) {
    var ctrX = point.x;
    var ctrY = point.y;

    var swX = ctrX - (width/2);
    var swY = ctrY - (width/2);

    var neX = ctrX + (width/2);
    var neY = ctrY + (width/2);
    return new google.maps.LatLngBounds(
        map.getProjection().fromPointToLatLng(new google.maps.Point(swX, swY)),
        map.getProjection().fromPointToLatLng(new google.maps.Point(neX, neY)));
  } 
```

最后，创建一个矩形，其国家名称进入[MarkerWithLabel](http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerwithlabel/1.1.5/)（在此处使用 v1.1.5，您可以热链接到[http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerwithlabel/ 1.1.5/src/markerwithlabel_packed.js](http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerwithlabel/1.1.5/src/markerwithlabel_packed.js)虽然我更喜欢保存本地副本）

由于拖动矩形似乎是不可能的，因此其中心的标记用作手柄。当它被拖动时，相关的矩形会随之移动。

```
 function makeCO2Rect(name, point, width) {
    var rect = new google.maps.Rectangle({
      map: map,
      bounds: rectParamsToBounds(point, width)
    });

    var marker = new MarkerWithLabel({
      map: map,
      position: map.getProjection().fromPointToLatLng(new google.maps.Point(point.x, point.y)),
      draggable: true,
      raiseOnDrag: false,
      labelContent: name,
      labelAnchor: new google.maps.Point(30, 0),
      labelClass: "labels", // the CSS class for the label
      labelStyle: {opacity: 1.0}
    });

    google.maps.event.addListener(marker, 'drag', function(event) {
      var newLatLng = event.latLng;
      var newPoint = map.getProjection().fromLatLngToPoint(newLatLng);
      rect.setBounds(rectParamsToBounds(newPoint, width));
    });
  }

  google.maps.event.addDomListener(window, 'load', initialize); 
```

标签的样式需要在 .labels CSS 类和构造函数中完成，矩形有描边颜色、粗细、不透明度和填充颜色等选项。

# javascript - 使用 xmlhttp 请求将数据上传到服务器

> ID：10689637
> 
> 赞同：0
> 
> 时间：2012-05-21T17:18:48.717
> 
> 标签：javascript, jquery, html, xmlhttprequest

我是 javascript 和 jquery 的新手。我想要实现的是将多个图像上传到服务器。我知道之前提出的类似问题，但不幸的是它们对我没有多大帮助。我想使用将图像上传到服务器一个 xml-http 请求对象。任何带有一些解释的示例都将非常有帮助。非常感谢任何形式的帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:22:31.287

您可以使用具有进度条、多文件选择和拖放功能的 ajaxUpload 插件：

[http://valums.com/ajax-upload/](http://valums.com/ajax-upload/)

# php - 如何使用 PHP 读取特定字符后的文本

> ID：10689641
> 
> 赞同：0
> 
> 时间：2012-05-21T17:19:11.243
> 
> 标签：php, scripting

最近我想做的是在特定字符之后阅读特定文本。我想要做的是读取等号后的数字。这是我的文字：

```
Lime Green = 13,
Sensei Gray = 14,
Aqua = 15,
Arctic White = 16,
Black Sunglasses = 101,
Dark Vision Goggles = 102, 
```

“=”号后面的数字是文本的 ID。我想要做的是获取文本的 ID 并将其放在变量 $id 中，任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:23:14.863

使用[爆炸](http://www.php.net/manual/en/function.explode.php)：

```
$parts = explode(' = ', rtrim($line, ',')); 
```

然后`$parts[0]`将是短语，`$parts[1]`将是 ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:24:52.847

为此使用正则表达式

```
$content="Lime Green = 13,
Sensei Gray = 14,
Aqua = 15,
Arctic White = 16,
Black Sunglasses = 101,
Dark Vision Goggles = 102,";

preg_match_all("/=(.*),/siU",$content,$output);

print_r($output[1]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T17:24:23.117

1.  设置具有不同值/名称的数组。
2.  循环遍历数组。
3.  使用explode("=") 在等号周围拆分每个字符串。
4.  获取每个数组的后半部分（explode 返回一个数组）

# vsto - VSTO 加载项和 comctl32.dll

> ID：10689642
> 
> 赞同：1
> 
> 时间：2012-05-21T17:19:26.190
> 
> 标签：vsto, comctl32

我正在使用 VSTO 4.0 和 .NET 4.0 开发 Word 和 Excel 2010 加载项。该插件集成了我们用 MFC 编写的胖客户端的一些功能。当我从加载项调用它们时，使用 Win2k 样式的 MFC 对话框（在胖客户端中它们看起来很正常）。在加载的库列表中有两个版本的 comctl32.dll：5.82 和 6.10。如何让 Word 和 Excel 使用正确版本的 comctl32.dll？我试图修改清单 Excel - 它有帮助，但这种方法不适合我。

# c# - 使用 WCF 和 ServiceModelEx 服务总线的奇怪行为

> ID：10689644
> 
> 赞同：-1
> 
> 时间：2012-05-21T17:19:29.107
> 
> 标签：c#, .net, wcf, publish-subscribe, servicemodelex

我正在使用 ServiceModelEx 的服务总线部分。（并使用 AppFabric 自动启动 WCF 服务）。我有一些奇怪的行为......

基本上，当我第一次调用服务总线时，所有正确的事件都会沿着链触发（通过查看数据库并查看记录的值来验证）。

但是在随后的调用中，没有任何反应。就好像事件永远不会发生......

.svclogs 没有显示任何有用的信息，事实上，它们甚至没有注册后续事件。

但是，对于订阅到总线的每个服务，Windows 事件日志确实显示以下错误：

```
WebHost failed to process a request.
 Sender Information: System.ServiceModel.ServiceHostingEnvironment+HostingManager/777031
 Exception: System.ServiceModel.ServiceActivationException: The service '/AcmeWidgets.WidgetFactory.Subscribers.WidgetBuilder/BuildService.svc' cannot be activated due to an exception during compilation.  The exception message is: The type 'AcmeWidgets.WidgetFactory.Subscribers.WidgetBuilder.BuildService', provided as the Service attribute value in the ServiceHost directive, or provided in the configuration element system.serviceModel/serviceHostingEnvironment/serviceActivations could not be found.. ---> System.InvalidOperationException: The type 'AcmeWidgets.WidgetFactory.Subscribers.WidgetBuilder.BuildService', provided as the Service attribute value in the ServiceHost directive, or provided in the configuration element system.serviceModel/serviceHostingEnvironment/serviceActivations could not be found.
   at System.ServiceModel.Activation.ServiceHostFactory.CreateServiceHost(String constructorString, Uri[] baseAddresses)
   at System.ServiceModel.ServiceHostingEnvironment.HostingManager.CreateService(String normalizedVirtualPath)
   at System.ServiceModel.ServiceHostingEnvironment.HostingManager.ActivateService(String normalizedVirtualPath)
   at System.ServiceModel.ServiceHostingEnvironment.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath)
   --- End of inner exception stack trace ---
   at System.ServiceModel.ServiceHostingEnvironment.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath)
   at System.ServiceModel.ServiceHostingEnvironment.EnsureServiceAvailableFast(String relativeVirtualPath)
 Process Name: w3wp
 Process ID: 3052 
```

我知道服务属性值是正确的，显然是因为它第一次运行正确。

有任何想法吗？？？

编辑 1：要添加到这种奇怪的行为，如果我在 Visual Studio 中“重建”解决方案，第一次调用总线工作，所有事件链下触发，然后所有后续调用再次失败

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T08:28:43.893

您在此处显示堆栈跟踪的代码路径并非特定于服务总线。这是一个激活错误。在我看来，这里好像存在类型加载错误。我会尝试先使用 fuslogvw 来看看

# python - 具有非平凡目录结构的 pyinstaller

> ID：10689645
> 
> 赞同：5
> 
> 时间：2012-05-21T17:19:31.837
> 
> 标签：python, windows, py2exe, pyinstaller

我编写了一个简单的 Web 应用程序，其中包含嵌入式 Web 服务器（tornado）、数据库（目前使用 sqlite 的 sqlalchemy）和整个 shabang。我想将它全部捆绑到一个独立的目录中，其中包含一个可以运行的 exe。部署场景绝对需要一键安装并像这样运行。

我试图让 py2exe 或 pyinstaller 捆绑我的代码完全失败了。问题直接与目录结构和布局有关，如下所示。我不想过多地更改目录布局。有人可以建议我如何使用 py2exe 或 pyinstaller 或任何其他合适的工具来获得它吗？

```
project/
|-> main.py

|-> libs/
    |-> tornado/ (The full git rep as a submodule)
        |-> tornado/ (The actual package)
    |-> sqlalchemy/

|-> src/
    |-> support-1.py
    |-> support-2.py

|-> static/
    -> js/
    -> img/
    -> css/

|-> templates/ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T09:23:16.537

好吧，很抱歉回答我自己的问题。但是经过多次谷歌搜索和反复试验，我设法让它工作。我将我的 setup.py（用于 py2exe）粘贴在下面，供任何有类似问题的人使用 tornado + sqlalchemy + sqlite 与 py2exe 一起工作。当我运行 python setup.py py2exe 时，最后几行提到缺少某些模块。但这对程序的执行没有影响。

```
> "['Carbon', 'Carbon.Files', '_curses', '_scproxy', 'django.utils',
> 'dummy.Process', 'pkg_resources', 'pysqlite2', 'simplejson',
> 'sqlalchemy.cprocessors', 'sqlalchemy.cresultproxy', 'tornado.epoll']" 
```

这是我的 setup.py：

```
import glob, os, sys

curr_dir = os.path.abspath('.')
pare_dir = os.path.abspath('..')

sys.path = [os.path.join(pare_dir, 'py2exe-0.6.9', 'py2exe'),
           os.path.join(curr_dir, 'src'),
           os.path.join(curr_dir, 'libs', 'tornado'),
           os.path.join(curr_dir, 'libs', 'sqlalchemy'),
           os.path.join(curr_dir, 'libs')] + sys.path

from distutils.core import setup
import py2exe

data_files = [('', ['config.json']),
              ('db', ['db/prs.db']),
              ('templates',      glob.glob('templates/*.*')),
              ('static',         glob.glob('static/*.*  ')),
              ('static/css',     glob.glob('static/css/*.*')),
              ('static/js',      glob.glob('static/js/*.*')),
              ('static/js/libs', glob.glob('static/js/libs/*.*')),
              ('static/img',     glob.glob('static/img/*.*')),
              ]

setup(console=['prs.py'], options={
    'py2exe' : {
        'includes' : ['demjson'],
        'packages' : ['sqlalchemy.dialects.sqlite'],
        }},
    data_files=data_files,
    ) 
```

# php - PHP echo 与包含 php 的 div 标签的连接

> ID：10689650
> 
> 赞同：1
> 
> 时间：2012-05-21T17:20:05.703
> 
> 标签：php, html, echo, substr

我正在使用 Javascript 隐藏/显示存储在 mysql 表中的博客文章。执行此操作的脚本是：

```
<script type="text/javascript">
    function unhide(divID) {
        var item = document.getElementById(divID);
        if (item) {
            item.className = (item.className == 'hidden') ? 'unhidden' : 'hidden';
        }
    }
</script> 
```

这链接到一些 CSS 样式：

```
.hidden {
 display: none;}
.unhidden {
 display: inline;} 
```

我通过 href 样式调用脚本作为按钮：

```
<a class=button href="javascript:unhide('first_post');">More</a> 
```

至于内容，我最初尝试如下最初显示一小段文字，然后点击链接后的其余部分：

```
<?php $var = mysql_result($result,0,"post_text"); ?>

<?php echo substr($var, 0, 400); ?>
<div id="first_post" class = "hidden">
  <?php echo substr($var, 400, 5000)?>
</div> 
```

但是，两组子字符串连接的地方有一个空格。例如，如果第一个子字符串以**“the tree's hav”**结尾，第二个子字符串以**“e eyes you know”**开头，则连接结果为**“the trees have e eyes you know”**

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:30:37.993

`<?php ?>`删除和标记之间的换行符`<div>`- 这应该可以帮助您摆脱空格。

```
<?php echo substr($var, 0, 400); ?><div id="first_post" class = "hidden"><?php echo substr($var, 400, 5000)?></div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:47:06.930

我认为您正在寻找的是您想从单词的末尾截断字符串，而不是在两者之间的某个地方提供链接。这就是我认为的永久解决方案...

当我在谷歌上搜索期望 PHP 会提供一些现成可用的东西时，发现以下 2 篇文章可能会对您有所帮助。

[http://css-tricks.com/snippets/php/truncate-string-by-words/](http://css-tricks.com/snippets/php/truncate-string-by-words/)

[如何将PHP中的字符串截断为最接近一定数量字符的单词？](https://stackoverflow.com/questions/79960/how-to-truncate-a-string-in-php-to-the-word-closest-to-a-certain-number-of-chara)

它们并不完全是您正在寻找的东西，但如果您从这些概念中获得灵感，它们会很有帮助。

# sql - 查找用户定义类型的 SQL 基本类型

> ID：10689654
> 
> 赞同：4
> 
> 时间：2012-05-21T17:20:13.660
> 
> 标签：sql, sql-server-2008

我正在使用具有大量用户定义 SQL 类型的旧数据库。我正在.NET 中编写一个方法，在该方法中我在 SqlParameter 对象中定义参数。我需要用户定义类型的底层 SQL 类型，以便在运行时动态创建参数时正确定义参数。

为此，我创建了这个过程：

```
(@typename sysname)  

AS  

SET NOCOUNT ON  

SELECT distinct
st.name as UserType,
t.precision, t.max_length,
bt.name as BaseType
FROM
dbo.syscolumns c
INNER JOIN dbo.systypes st ON st.xusertype = c.xusertype
INNER JOIN dbo.systypes bt ON bt.xusertype = c.xtype
inner join sys.types t on st.name = t.name
WHERE
st.name = 'bVendor' 
```

我想知道这是否是获取用户定义类型的底层基本类型的最佳方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T17:33:50.607

您不应该使用 systypes 或 syscolumns - 这些是向后兼容性视图，并且 sys.types 和 sys.columns 是高度首选的，除非您尝试编写适用于 SQL Server 2000+ 的代码（我也不推荐） .

要获取有关您已经知道名称的类型的信息：

```
SELECT name, precision, scale, max_length
  FROM sys.types AS t
  WHERE name = 'bVendor'; 
```

要获取数据库中所有用户定义类型的信息：

```
SELECT name, precision, scale, max_length
  FROM sys.types AS t
  WHERE is_user_defined = 1; 
```

要获取有关特定表的所有类型（系统和用户定义）的信息：

**更新**以包括基本类型：

```
SELECT 
  [column] = c.name, 
  [base type] = COALESCE(bt.name, t.name),
  [defined type] = t.name, 
  t.precision, 
  t.scale, 
  t.max_length
FROM sys.columns AS c
INNER JOIN sys.types AS t
ON c.system_type_id = t.system_type_id
AND c.user_type_id = t.user_type_id
LEFT OUTER JOIN sys.types AS bt
ON t.is_user_defined = 1
AND bt.is_user_defined = 0
AND t.system_type_id = bt.system_type_id
AND t.user_type_id <> bt.user_type_id
WHERE c.object_id = OBJECT_ID('dbo.your_table_name'); 
```

请注意，如果您使用别名类型（例如`CREATE TYPE blat FROM nvarchar(32);`），这将返回两行。如果你真的必须使用这些（[我也建议不要使用它们](https://sqlblog.org/2009/10/14/bad-habits-to-kick-using-alias-types)），那么将 join 子句更改为：

```
ON t.is_user_defined = 1
AND bt.is_user_defined = 0
AND t.system_type_id = bt.system_type_id
AND bt.user_type_id = bt.system_type_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-02T18:05:10.180

要获取数据库中所有用户定义类型的信息，您可以使用 INFORMATION_SCHEMA.DOMAINS：

```
SELECT 
   DOMAIN_SCHEMA,
   DOMAIN_NAME,
   DATA_TYPE,
   NUMERIC_PRECISION,
   NUMERIC_SCALE,
   DATETIME_PRECISION,
   CHARACTER_MAXIMUM_LENGTH

FROM 
   INFORMATION_SCHEMA.DOMAINS 
```

UPD：以下查询返回所有用户定义类型的人类可读定义：

```
 SELECT 
     DOMAIN_SCHEMA + '.' + DOMAIN_NAME AS TypeName,
     DATA_TYPE + 
        COALESCE('('+ 
           CAST(COALESCE(NUMERIC_PRECISION,DATETIME_PRECISION,CHARACTER_MAXIMUM_LENGTH) AS VARCHAR) + 
           COALESCE(',' + CAST(NUMERIC_SCALE AS VARCHAR),'') +
        ')','') AS Definition

  FROM 
  (
     SELECT 
        DOMAIN_SCHEMA,
        DOMAIN_NAME,
        DATA_TYPE,
        CASE 
           WHEN DATA_TYPE IN ('tinyint','smallint','int','bigint') THEN NULL
           ELSE NUMERIC_PRECISION
        END AS NUMERIC_PRECISION,
        NUMERIC_SCALE,
        CASE 
           WHEN DATA_TYPE IN ('smalldatetime','datetime','date') THEN NULL
           ELSE DATETIME_PRECISION
        END AS DATETIME_PRECISION,
        CHARACTER_MAXIMUM_LENGTH

     FROM 
        INFORMATION_SCHEMA.DOMAINS
  ) T 
```

（仅针对我自己使用的类型进行了测试）

# python - 如何添加两个元组（或列表）的内容？

> ID：10689656
> 
> 赞同：4
> 
> 时间：2012-05-21T17:20:15.970
> 
> 标签：python, tuples

我已经多次遇到这个问题，我找不到一个好的解决方案来将两个元组的内容加在一起。做的事情：

```
a = (1, 2)
b = (3, 4)
c = (a[0]+b[0], a[1]+b[1]) 
```

我想我看到了一种只做一次的语法，但我不记得该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:28:13.460

这也有效：

```
>>> a = (1,2)
>>> b = (3,4)
>>> c = map(sum, zip(a,b))
>>> c
[4, 6] 
```

它应该适用于包含任意数量数字的任意数量的列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:28:11.227

一个班轮：

```
map(lambda x, y: x+ y, a, b) 
```

我相信这是最有效的方法。您还可以导入`operator.add`以避免 lambda 函数。对我来说，我更喜欢更干净的全局命名空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-22T11:31:16.333

**使用生成器理解：**

```
a = (1, 2)
b = (3, 4)
result = [x + y for x, y in zip(a, b)] 
```

[4, 6]

# multithreading - 大量数据库访问使 WCF 服务无响应

> ID：10689658
> 
> 赞同：2
> 
> 时间：2012-05-21T17:20:28.257
> 
> 标签：multithreading, wcf, entity-framework

我有一个 WCF 双工服务（使用 net.tcp 绑定进行会话实例化），它可能会执行大量数据库访问。当它进入其高分贝访问例程时，它对任何 WCF 服务调用都没有响应。

我检查了 CPU 利用率，虽然很高，但不是 100%。这是在一个 4 芯盒子上。

WCF 似乎没有处理任何实际请求。不仅没有调用服务操作，而且我在 WCF 堆栈中还有一些安全自定义行为也没有被调用。这让我觉得 WCF 不知何故缺乏线程，因此无法分配新线程进行访问。

我不认为这是一个限制问题，因为我可以在该服务有几个当前会话（少于 5 个）时实现这一点。

有问题的数据库操作是数千个单行插入。这是通过每 500 次调用处理和重构的单个实体框架上下文来完成的，以减少实体框架内部缓存的内存积累。目标数据库是 SQL Express 2008 R2。

此服务中有相当数量的工作线程。所有这些都由任务并行库实例化......一些是常规的短期任务（使用 CLR 线程池），另一些是长时间运行的任务（获取自己的 CLR 线程），但这些都不是 I/O 线程（除非 CLR 正在做一些我不知道的魔法）。数据库写入发生在一个长时间运行的任务上。

是否有任何 WCF 或调试诊断工具可以报告或可视化 WCF 线程、工作线程、I/O 线程和 WCF 限制的当前状态？

**环境总结**

*   WCF 服务托管在 Windows 服务中
*   WCF 服务使用 net.tcp 双工绑定
*   WCF 服务基于会话（双工合同要求）
*   Windows 服务只有一个实例，但 WCF 服务对象的多个实例会根据 WCF 的要求进行实例化。
*   WCF 服务操作快速将工作委派给在 Windows 服务中持久存在的后台线程。所有 WCF 操作都会快速返回，然后将后台线程生成的附加结果沿 WCF 双工回调通道传递。
*   所有数据库访问都是在后台工作线程上完成的。没有 WCF 线程用于长时间运行的工作。
*   WCF 服务具有单一的自定义安全行为。没有其他行为（例如可靠的消息传递等）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:31:31.050

如果您使用会话实例化，则每个客户端连接都有一个主机服务。如果主机正在访问数据库，那么我会说它正在阻塞并且在完成之前将无法处理来自其客户端的任何其他调用。您也许可以将其工作方式更改为异步。调用 start 方法在工作线程上启动数据库活动并立即返回。要么有一个检查状态的进度方法，要么因为您使用的是双工，所以在完成时让主机向客户端发出信号。

还是 wcf 服务不接受新客户？

# c# - casmcard 包装器

> ID：10689661
> 
> 赞同：0
> 
> 时间：2012-05-21T17:20:37.570
> 
> 标签：c#, c++, smartcard

我有一个智能卡和一个用 C++ (casmcard.dll) 编写的简单 sdk。

我需要通过托管代码（C#）专门调用上述dll中的一些方法来读写一些特定的块或扇区。

找不到 casmcard.dll 包装器。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:23:52.147

听起来您需要深入研究互操作性。如果它是 COM 对象，您可以导入它并让 .net 为您创建包装器。如果它是老式的 dll 函数，那么你只需要导入它们。

互操作有点像魔法，所以你需要在地图和编组类型上搜索一下。

**编辑**

所以你的功能看起来像？

```
CasCLGetSN( IN SCARDHANDLE hCard, OUT LPBYTE pbCSNBuffer, IN DWORD cbCSNBufferSize, OUT LPDWORD pcbCSNLength ) 
```

尝试这个：

```
CasCLGetSN(ScardHandle hCard, out IntPtr pbCSNBuffer, UInt32 cbCSNBufferSize, out UInt32 pcbCSNLength) 
```

然后，您需要使用重载`Marshal.Copy()`来获取 pbCSNBuffer 的内容。还要检查 scardHandle 的定义是什么。如果它是一个结构，则声明它并将`Sequential`属性添加到它。

# java - Java和Ubuntu、java FTP服务器连接问题

> ID：10689669
> 
> 赞同：1
> 
> 时间：2012-05-21T17:20:55.207
> 
> 标签：java, ubuntu, ftp

好的，所以我已经编写了我非常简单的 JAVA ftp 服务器。我现在想在同一台机器上连接到它。我正在使用 ubuntu 11.10。我一直在尝试使用命令“ftp localhost”，但一直被拒绝连接。我一直在寻找，看来我需要安装一个ftp服务器？？......

我在问这是否是我应该做的，如果是的话，我在哪里可以找到它。或者我只是没有使用 ftp 命令吗？

源代码：

## FTPServer.java

```
import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.concurrent.ExecutorService;
 import java.util.concurrent.Executors;

public class FTPserver
{   
public static void main(String [] args)
{
    if (args.length != 1) 
        throw new IllegalArgumentException( "Parameter(s): <Port>");

    int threadPoolSize = 10;
    int port = Integer.parseInt(args[0]); 

    final ServerSocket server;
    try 
    {
        server = new ServerSocket(port);
    } 
    catch (IOException e1) 
    {
        return;
    }

    ExecutorService exec = Executors.newFixedThreadPool(threadPoolSize);

    while (true) 
    {
        try 
        {
            Socket sock = server.accept();
            exec.submit(new FTPProtocol(sock));
        } 
        catch (IOException e)
        {
            System.err.println(e.getMessage());
            return;
        }
    }
}
} 
```

## FTP协议.java

```
import java.io.IOException;
import java.io.InputStream;
 import java.io.OutputStream;
import java.net.Socket;

class FTPProtocol implements Runnable
{
static String greeting = "220 Service Ready.\r\n";
static String needPassword = "331 User name ok, need password.\r\n";
static String closing = "421 Service not available, closing control connection.\r\n";
static byte[] reply220 = null;
static byte[] reply331 = null;
static byte[] reply421 = null;

    Socket sock = null;
    public FTPProtocol(Socket so)
    {
        sock = so; 
        reply220 = greeting.getBytes();
        reply331 = needPassword.getBytes();
        reply421 = closing.getBytes();
    }

    public void run()
    { 
        handleFTPClient(sock); 
    }

    void handleFTPClient(Socket sock)
    {
        InputStream is = null;
        OutputStream os = null;
        byte[] inBuffer = new byte[1024];

        try 
        {
            is = sock.getInputStream();
            os = sock.getOutputStream();
            os.write(reply220);
            int len = is.read(inBuffer);
            System.out.write(inBuffer, 0, len);
            os.write(reply331);
            len = is.read(inBuffer);
            System.out.write(inBuffer, 0, len);
            os.write(reply421);
            sock.close();
        } 
        catch (IOException e)
        {
            System.err.println(e.getMessage());
            return;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:26:03.087

在 Linux 下，除非您是 root，否则您不能使用端口 21。而是绑定到例如 2121 并使用允许您指定端口号的客户端。

# facebook - Facebook Like Button Tag 缺失错误。我如何解决它？

> ID：10689677
> 
> 赞同：20
> 
> 时间：2012-05-21T17:21:24.363
> 
> 标签：facebook, facebook-like

我在我的 mediawiki 网站上有 facebook，当我通过调试器[http://developers.facebook.com/tools/debug](http://developers.facebook.com/tools/debug)运行它时，我得到了错误：

Admins And App ID Missing fb:admins 和 fb:app_id 标签丢失。这些标签对于 Facebook 呈现产生高点击率的新闻提要故事是必要的。

Like Button Tag Missing og:title 丢失。og:title 元标记对于 Facebook 呈现产生高点击率的新闻提要故事是必要的。

Like Button Tag Missing og:type 丢失。og:type 元标记对于 Facebook 呈现产生高点击率的新闻提要故事是必要的。

Like Button Tag Missing og:image 丢失。og:image 元标记对于 Facebook 呈现产生高点击率的新闻提要故事是必要的。

它还将其发布为“最近的活动”，而不是带有图像的帖子。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-21T20:17:21.610

“og:”标签必须在点赞按钮所指的 HTML 页面的 head 元素中（通常是按钮所在的页面）。Facebook 调试器告诉您它们不存在。它们应该如下所示：

```
<head>
    <meta property="og:title" content="My web page title" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="http://exmaple.com/image.jpg" />
    <meta property="og:url" content="http://example.com/" />
    <meta property="og:site_name" content="My site name" />
    <meta property="og:description" content="This site is awesome!" />
    <meta property="fb:app_id" content="YOUR_APP_ID" />
</head> 
```

您可以使用 fb:app_id 或 fb:admins，但不能同时使用两者。

我不明白这一点，“它还将它发布为'最近的活动'而不是带有图像的帖子。我该如何解决这个问题？” 单击“赞”按钮时，帖子会添加到用户的时间轴，并且根据他们配置隐私的方式，他们的朋友可能会看到该帖子。

# javascript - Javascript比较两个不同大小的数组并返回不在第二个数组中的项目

> ID：10689678
> 
> 赞同：0
> 
> 时间：2012-05-21T17:21:24.720
> 
> 标签：javascript, arrays, compare

我有两个数组：

```
var array1 = [a,b,c,d];
var array2 = [1,2,a,b]; 
```

我需要一个函数来返回不在第二个数组中的项目数组。

```
var notInSecond = [c,d]; 
```

有谁知道如何做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:26:08.370

```
var notInSecond = array1.slice(0); // Creates a clone of array1
for (var i = 0, j; i < array2.length; i++) {
    j = notInSecond.indexOf(array2[i]);
    if (j > -1) notInSecond.splice(j, 1);
} 
```

请记住`indexOf`for arrays 不适用于 IE8 及更低版本，必须对其进行仿真。我还假设它`array1`不包含重复项。

# jquery - jquery 验证 - 远程方法 - json

> ID：10689679
> 
> 赞同：1
> 
> 时间：2012-05-21T17:21:29.003
> 
> 标签：jquery, json, jquery-validate

使用 jQuery 验证插件 -

[http://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

想要在字段（用户名）上使用远程方法来检查用户名是否唯一（响应是 json 格式 - 不能使用 php）。因此，我看到的所有远程方法都使用 php 和在 php 文件中进行处理的函数。显然，使用json，我不能这样做。

那么使用“远程”，我将如何检查 json 响应的唯一性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:31:30.740

被`response`评估为 JSON 并且必须用于有效元素，`true`并且可以是 any或用于无效元素。`false``undefined``null`

像这样使用插件：

```
$("#your_form").validate({
  rules: {
    username: {
      required: true,
      email: true,
      remote: "check_username.php"
      // or other server side script 
      // or JSON response (must be boolean) 

    }
  }
}); 
```

上面的代码将使该`username`字段成为必需的用户名，并执行远程请求以检查给定的用户名是否已被使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:28:51.113

不确定我是否遗漏了您的问题，但您的远程验证方法应该返回`true`or `false`，仅此而已。验证插件负责其余的工作。

# ruby - Rails 应用程序加载页面的测量

> ID：10689680
> 
> 赞同：0
> 
> 时间：2012-05-21T17:21:42.457
> 
> 标签：ruby, ruby-on-rails-3, pagespeed

我想知道测量应用程序加载页面速度的最佳方法。我想看看，由于改进了 SQL 查询等，应用程序的加载页面花费了多少时间，然后将这些测量值显示到图表中会很好。

你如何解决这个问题？我的想法放在页面的开头和结束计时器上，每个值都保存到数据库中，但我不确定这是否是个好主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:32:05.543

为此，我使用了非常有用的 gem [QueryReviewer](https://github.com/nesquena/query_reviewer)。它可以分析每个 SQL 查询，提供一些有用的信息。它直接在页面上显示此交互式摘要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T06:09:31.250

如果你想测量页面的速度，那么你应该使用 Navigation Timing。在 chrome 中，加载页面，打开开发者工具并`performance.timing`在控制台中输入。这将为您提供 DNS、连接时间、服务器响应时间等等。

请注意，在浏览器中设置手动计时器*不会*为您提供上述任何信息，因为计时器只会在浏览器解析您的 javascript 时设置 - 因此是导航计时规范的原因。另外值得一提的是，谷歌分析会自动为您采样这些数据！以下是一些涵盖导航计时、GA 和许多其他前端优化工具的幻灯片：[http ://www.igvita.com/slides/2012/html5devconf/](http://www.igvita.com/slides/2012/html5devconf/)

如果您对 SQL 特别感兴趣，那么您应该查看服务器日志（而不是在浏览器中）。

# c# - 尝试使用 C# 中的目录服务帐户管理删除本地用户组时出现异常

> ID：10689681
> 
> 赞同：0
> 
> 时间：2012-05-21T17:21:43.363
> 
> 标签：c#, .net, windows, directoryservices, account-management

我正在尝试以编程方式删除本地用户组。我正在使用以下代码，这些代码是从网上的各种示例中拼凑而成的。从我读过的所有内容来看，它应该可以工作。但是 Delete 行会引发异常。

```
PrincipalContext context = new PrincipalContext( ContextType.Machine );
GroupPrincipal group = new GroupPrincipal( context );
PrincipalSearcher ps = new PrincipalSearcher( group );
PrincipalSearchResult<Principal> results = ps.FindAll();
Principal foundGroup = results.SingleOrDefault( item => item.Name == groupName );
if(foundGroup != null)
    foundGroup.Delete(); // Here occurs the InvalidOperationException 
```

这会引发一条`InvalidOperationException`消息：

> 位于路径 WinNT://LOREM/IPSUM 的 Active Directory 对象不是容器。”

当谈到这个 Active Directory 的东西时，我是一个完全的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-02-04T01:08:27.593

前段时间有人问过这个问题，但我今天遇到了这个问题。Group 和 UserPrincipal 库中似乎存在错误。这就是我为将来遇到此问题的任何人解决它的方法：

对于团体：

```
string groupName = "myGroup";

// Workaround: WinNT://DOMAIN/USER is not a container even if group is empty
using (var root = new DirectoryEntry($"WinNT://{Environment.MachineName}"))
using (var group = root.Children.Find(groupName, "group"))
{
    root.Children.Remove(group);
    result = true;
} 
```

对于用户帐户：

```
string userAccountName = "myUser";

// Workaround: WinNT://DOMAIN/USER is not a container issue
using (var root = new DirectoryEntry($"WinNT://{Environment.MachineName}"))
using (var userAccount = root.Children.Find(userAccountName))
{
    root.Children.Remove(userAccount);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:58:59.393

你能试试`PrincipalSearchResult<GroupPrincipal>`吗？

我也不确定您的 .SingleOrDefault 是否使用正确。你能试一下吗：

```
results.Where(item => item.Name == groupName).SingleOrDefault(); 
```

# extjs - Sencha carousel 停止在 carousel 上的触摸事件传播，同时在其中的画布上绘图

> ID：10689683
> 
> 赞同：1
> 
> 时间：2012-05-21T17:22:03.317
> 
> 标签：extjs, carousel

我有一个带有四个面板的旋转木马。

它工作正常，我能够从一秒导航到一秒等等。

我的第四个面板有一个用于绘图的画布。

当我开始绘图时，轮播照常更改页面，但此时我不想更改页面，因为用户正在绘图。

如何在我绘图时停止此事件，并在我选择手形工具时再次绑定该事件？

我制作了一个手绘/绘图工具按钮来更改这些设置。

我尝试过处理事件传播并使用捕获方法来阻止事情。但我无法得到预期的结果。任何帮助深表感谢。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-06T05:33:26.063

如果您要在可编辑/不可编辑模式之间切换卡片，可能类似于

```
toggleEditHandler() { 
  var nothing = function() {return false;};
  //if toggled to edit
    card.element.on('*', nothing, card);

  //else 
    card.element.un('*', nothing, card);
} 
```

请注意，这是粗略的伪代码，因为我不想假设您将如何处理您的处理程序，但这是一个通常应该可以工作的快速破解。对于它的价值，我从官方掩码对象中的代码中得到了这个想法，它可以防止动作冒泡。

# javascript - 按键事件仅触发一次

> ID：10689686
> 
> 赞同：1
> 
> 时间：2012-05-21T17:22:25.523
> 
> 标签：javascript, jquery, event-delegation

我正在这样做：

```
$(".classname").bind("keypress",function(){
    alert("event happened");
}) 
```

与上面类似的代码，只工作一次，我的意思是，第一次输入并单击 Enter 时，它可以工作，但下一次，它根本没有反应。

```
$("#id").bind("keypress",function(){
   alert("haiii");
}) 
```

第二个代码一直工作，但第一个代码只工作一次。

此外，如果第二个代码运行一次，则第一个代码甚至不会运行一次。

解决办法是什么？我想我在这里遗漏了一些规则，你能告诉他们，以便我搜索它们。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:28:25.747

事件绑定器应始终可用；如果不是，那是因为您正在更改 HTML 结构（追加或删除节点）。在您的情况下，您在运行时动态更改 HTML，您需要使用`.on()`

试试这个而不是`.bind()`：

```
 $('#id').on({
       keypress: function () { alert("hi"); }
    });

    $('.ClassName').on({
       keypress: function () { alert("hi"); }
    });

    // IF YOU KNOW CLASSNAME ELEMENTS ARE INSIDE A FIXED ELEMENT:

    $('#FixedID').on({
       keypress: function () { alert("hi"); }
    }, '.ClassName'); 
```

关于您的编码风格，您应该将事件处理程序和处理事件的函数分开。例如，处理程序也执行代码而不是这个：

```
// one function that does everything!!
$(document).ready(function() {
    // bind events
    $('#SomeID').on({

       click: function () {
         // huge wall of code that handles events
       },
       mouseenter: function () {
         // another huuuuuuuge wall of code here
       }
    )};
}); 
```

你应该有这样的东西：

```
$(document).ready(function () {
    BindHandlers();
    DoSomethingElseWithPageInit();
}); 

function BindHandlers() {
// handlers do just the handling of events; easy to see and understand
   $('#SomeID').on({
      click: function (e) { ClickOnSomeID(e); },
      mouseenter: function () { MouseEnterOnSomeID(); }
   )};
}

// here are the functions that process the event
function ClickOnSomeID(e) { ... }
function MouseEnterOnSomeID() { ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-23T13:06:37.543

正如 frenchie 所说，这是因为您的 html 结构发生了变化。这已被 .live() 正确处理，但现在 .on() 是继任者。但是你不应该在元素上使用 on() ，而是在文档上使用：

```
$(document).on("keypress", "#id", function(){
alert("event happened");
}) 
```

# c# - 在将文件保存到独立存储时设置自定义编码

> ID：10689689
> 
> 赞同：0
> 
> 时间：2012-05-21T17:22:34.520
> 
> 标签：c#, windows-phone-7, isolatedstorage

我正在将下载的文件保存到隔离存储中，我想将编码设置为 iso-8859-1，因为我正在下载的 xml 文件是以这种方式编码的。

```
var stream = new IsolatedStorageFileStream("myfile.xml", FileMode.Create, FileAccess.Write, myIsolatedStorage);
        using (StreamWriter writeFile = new StreamWriter(stream)) {
            string xml_file = e.Result.ToString();
            writeFile.WriteLine(xml_file);
            writeFile.Close();
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:35:49.023

理想的解决方案是将文件作为流下载并将其直接保存到文件中，从而保持下载的字节原样（因此不需要文本编码转换）！

此外，Windows Phone 仅支持一些基本的文本编码，如 UTF8 和 Unicode；为了在 WP 中使用另一种编码，您必须使用[Silverlight 文本编码生成器](http://www.hardcodet.net/2010/03/silverlight-text-encoding-class-generator)工具！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T17:29:06.590

您正在将结果转换为字符串，因此您正在将 UTF-16 写入流中。因此，无法匹配流和 XML 中的编码。您可以将响应流复制到隔离的存储流。

请**不要使用字符串操作**来构造、读取和写入 XML。有很多相应的类可以正确地做到这一点。在您的情况下，您可能希望使用 XmlDocument 或 XDocument 读取 XML，而不是在创建 XmlWriter 时选择指定编码保存到流中。

# php - 无法访问 AJAX 调用中的 JSON 字段

> ID：10689693
> 
> 赞同：0
> 
> 时间：2012-05-21T17:22:58.700
> 
> 标签：php, jquery, ajax, json, codeigniter

我是 Php/Jquery 编程的新手，我过去一整天都在尝试弄清楚如何从 Jquery AJAX 调用访问 JSON 字段：

我正在使用 codeingniter，在我的控制器中，相关代码是：

```
if( $this->input->is_ajax_request()) 
{
    $view_data['test'] = 'ajax';
    echo json_encode( $view_data ); 
}
else
{
    $view_data['test'] = 'not ajax';                              
    $data = array(
            'javascripts' => array(
            'js/jquery.dataTables.js',
            'js/zona/dataTable_zone.js',
            'js/zona/gestisci_zone.js',
            'js/jquery-ui-1.8.20.custom.min.js' ,
            'js/jquery.ui.error-panel.js',  
            'js/jquery.validate.min.js' ,
            'js/localization/messages_it.js'
        ),
        'style_sheets' => array(
            'css/south-street/jquery-ui-1.8.20.custom.css' => 'screen',                 
            'css/jquery.dataTables.css' => 'screen'
        ),
        'content' => $this->load->view( 'zona/gestisci_zone', $view_data, TRUE )
    );

    $this->load->view( $this->template, $data);
} 
```

` 在视图中相关代码是

```
<div id="id_test">  <p><?php echo $test ?> </p></div> 
```

在 javascript 文件中，相关的 AJAX 代码是

`$.ajax( { type:"POST", url:this_url, dataType: 'json', data: post_data,
success: function(data){

```
 console.log(data);
                                             console.log($("id_test").empty());
                                        $("#id_test").empty().append(data.test);
                                        },
                                        error: function(data){

                                        alert("error"); 
```

);`

这样AJAX输出是`Array{"test":"ajax"}`

我的预期行为是使用 `$("#id_test").empty().append(data.test);`AJAX 输出将只是单词 ajax，但它只返回一个空白 div。我尝试过以多种模式访问，但我不知道如何实现这一点。也许我因为缺乏经验而遗漏了一些东西，或者我使用了错误的方法。请问有什么建议吗？:)

经过一点调试，我得出结论，这是一个纯文本/错误的 JSON 问题。它只返回数组的文本表示，而不是 json 数组。现在，我如何从控制器发送正确的 json 数组？（我已经强制 mimetype 到 application/json 没有效果）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:32:33.793

是`dataType`和不是`datatype`。我相信这就是问题所在，似乎它没有将返回的数据解析为 json 和字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:38:23.587

我认为如果您仍然没有成功，您可能需要在 json 和 jsonp 之间切换。jQuery 有 2 个选项“json”和“jsonp”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T17:42:39.423

尝试在 ajax 调用中添加错误处理程序，以便判断它是否成功执行。我认为你必须使用**data.d**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T20:55:50.603

只是一个猜测，但是......语法错误可能吗？

```
if( $this->input->is_ajax_request()) 
{
    view_data['test'] = 'ajax';
    // dont you mean $view_data?

    echo json_encode( $view_data ); 
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T08:14:19.520

如果我对你的理解正确，为了让你`<div id="id_test"> <p><?php echo $test ?> </p></div>`被“ajax”这个词替换`$.ajax()`，试试这个：

```
$.ajax({
  type:"POST",
  url:this_url, 
  dataType: 'json',
  data: post_data, 
  success: function(data){
    $("#id_test").empty().append(data.test);
  }
}); 
```

由于您提到了`data`返回`Array{"test":"ajax"}`，您可以通过这种方式访问​​返回的 JavaScript 对象`data.test`

# powershell - 我应该如何正确终止 powershell v1.0 中的“此处字符串”？

> ID：10689698
> 
> 赞同：1
> 
> 时间：2012-05-21T17:23:17.610
> 
> 标签：powershell

我正在使用 powershell v1.0 并且在终止“此处的字符串”时遇到问题，控制台保持打开 >> 除非我执行 CTRL-C，此时我会丢失变量：

```
$test = @"
>> a
>> multiline
>> string
>> "@
>> 
```

我应该如何正确终止 powershell v1.0 中的“此处字符串”？

我也试过单引号'@无济于事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:38:29.033

您的问题中引号的错误一侧似乎有 @ 。我可以在结尾“@”之后按几次返回键，它就结束了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:36:20.403

确保结束部分 ("@) 开始该行并且不包含前导空格。

# javascript - 可能的 javascript ajax 调用竞争条件

> ID：10689702
> 
> 赞同：2
> 
> 时间：2012-05-21T17:23:44.970
> 
> 标签：javascript, ajax, race-condition

所以我在javascript中实现了这个功能：当用户打开文档时，它的数据每10秒保存一次，当用户关闭时，它会再保存一次。它似乎运作良好。这是实现：

```
var data = "blabla";
var saveagain = false;
var t1;

function onDocumentOpen() {
    saveagain = true;
    savedata();
}

function onDocumentClose() {
    saveagain = false;
    savedata();
}

function savedata() {
    if (!saveagain) clearTimeout(t1);
    SaveDataAjaxCall(data, function() {
        //data was saved
        if (saveagain) t1 = setTimeout("savedata()", 10000);
    });
} 
```

我想知道我的方法是否正确，以及它是否会在极端情况下导致一些可能的竞争条件，例如：

当从 onDocumentClose() 调用的 savedata() 实例在 if(!saveagain) 步骤之后，从 setTimeout() 的前一个计时器调用的 savedata() 实例在该步骤之前，因此它会被再次调用。这或者更奇怪的事情会发生吗？

提前致谢

编辑：

在考虑了 TJ Crowder 和 Bengi 的评论后，我最终确定了代码：

```
var data = "";
var saveagain = false;
var t1;
var beingsaved = false;

function onDocumentOpen() {
    saveagain = true;
    savedata();
}

function onDocumentClose() {
    saveagain = false;
    savedata();
}

function saveData() {
    if (beingsaved) {
        if (!saveagain) setTimeout(saveData, 100);
        return false;
    }
    beingsaved=true;

    if (!saveagain) clearTimeout(t1);

    data=getData();

    SaveDataAjaxCall(data, function() {
        //data was saved
        beingsaved=false;
        if (saveagain) t1 = setTimeout(saveData, 10000);
    });

} 
```

我想我现在已经处理了每一个场合。我认为被保存的解决方案等于 TJ Crowder 建议的原子计数。

EDIT2：嗯，我不确定我是否解决了它，因为可能存在这样一种情况，即 if(beingsaved) 在 onDocumentClose 调用设置为 true 之前被 setTimeout 调用评估。这会发生吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:30:43.937

我假设你的保存操作是异步的，所有好的 ajax 操作都应该是异步的。如果是这样，您将需要在其周围设置某种保护条件，以便两个保存触发器不会重叠。或者，当然，允许它们重叠，但在服务器端处理它（可能使用序列号或时间戳），如果后面的保存已经提交，它会忽略早期的保存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:30:46.493

不，Javascript 是单线程的（除了 WebWorkers 和 Co 等创新，它们需要在基于事件的接口上进行通信）。

因此，一旦您的同步执行开始（全局脚本、超时、ajax 事件处理程序），它就会运行并且无法停止。其他一切（新事件、0ms 超时等）将在之后安排。

您的脚本包含 2 个异步场景：超时和 ajax 回调。在你开始循环 onDocumentOpen 之后，它就像这样：

1.  执行saveData：启动ajax请求
2.  等待（直到 ajax 事件发生）
3.  执行成功回调：为 saveData 设置新的超时
4.  等待（直到发生超时事件）
5.  执行saveData：启动ajax请求
6.  等待...

...等等。

您的 onDocumentClose 只能在等待期间执行，此时没有其他执行运行。你会期待以下内容：

1.  ...执行 saveData：启动 ajax 请求
2.  什么都没发生
3.  ajax 事件：执行成功回调：为 saveData 设置新的超时
4.  什么都没发生
5.  documentClose 事件：清除超时，启动 ajax 请求
6.  什么都没发生
7.  ajax 事件：执行成功回调：不再设置新的超时。结尾。

但是当在 ajax 请求期间发生 documentClose 时，您并没有保护这种情况：

1.  ...执行 saveData：启动 ajax 请求
2.  什么都没发生
3.  ajax 事件：执行成功回调：为 saveData 设置新的超时
4.  什么都没发生
5.  超时事件：执行saveData，启动ajax请求
6.  什么都没发生
7.  documentClose 事件：清除（不存在的）超时，启动 ajax 请求（第二次）
8.  什么都没发生
9.  ajax 事件之一：执行成功回调：不再设置新的超时。
10.  什么都没发生
11.  其他 ajax 事件：执行成功回调：不再设置新的超时。结尾。

所以总会走到尽头。如果其中一个事件在某事执行期间触发，则两者之间不会发生“什么都没有发生” - 但它会一个接一个地执行。即使超时应该在 ajax 回调执行期间结束并且*在它被清除之前*结束，它也会在它结束后被清除时被取消调度：

```
var id = setTimeout(function(){
    alert("still waiting for execution"); // never alerts
}, 500);
setTimeout(function(){
    alert("still waiting for execution"); // this alerts
}, 500);
for(var d = Date.now(); Date.now()-d < 1000; ) {
    ; // wait - the timeouts end during this heavy processing
}
clearTimeout(id); 
```

# asp.net - 为什么在 Fiddler 的请求中可见的 cookie 在 Request.Cookies 集合中不可用？

> ID：10689705
> 
> 赞同：2
> 
> 时间：2012-05-21T17:23:53.830
> 
> 标签：asp.net, .net-4.0, .net-2.0, forms-authentication, single-sign-on

我正在使用相同域但不同子域的 .NET 2.0 站点和 .NET 4.0 站点之间进行 SSO。在单台机器上的开发环境中一切正常，但我无法让 4.0 生产站点接受 2.0 生产站点生成的身份验证 cookie。这两个站点位于不同的服务器上，一个运行仅安装了 2.0 框架的 IIS 6，另一个运行安装了 4.0 框架的 IIS 7.5。我已经阅读了其他问题的所有其他答案，这些问题指出了`<machineKey>`元素和元素的问题`<authentication><forms>`，相信我，所有这些东西都已正确设置，并且所有 4 个站点对这些元素具有完全相同的属性值。

起初我认为这是加密的问题，但是当我仔细查看 Fiddler 发生的事情时，我发现 auth cookie 已在请求中正确传递，但似乎在某个时候消失了，然后就没有了在 Request.Cookies 集合中可用。

4.0 生产站点位于负载均衡器后面，但目前网络场中没有其他在线服务器。负载均衡器会以某种方式丢弃 cookie 吗？cookie 是否因为不是有效的身份验证 cookie 而未添加到 Request.Cookies 集合中？如果是这样，为什么它无效？

总而言之，当我在请求的页面上执行以下操作时：

`HttpCookie AuthCookie = Request.Cookies.Get(".SSOAUTH");`

AuthCookie 为空，即使我可以在 Fiddler 的请求标头中看到具有该名称的 cookie。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T21:26:22.990

由于每台服务器上的加密算法不同，身份验证票证可能无效。当某些 MS 安全更新应用于一台服务器但未应用于另一台服务器时，可能会发生这种情况。如果 cookie 不包含有效值，它将不会被添加到`Request.Cookies`集合中，即使它是在请求中传递的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-17T17:05:32.947

我只是想添加另一个选项来说明可能导致这种情况的原因。我花了将近 2 天的时间尝试在 .NET 4.0 WebForms 应用程序和 .NET 4.5 MVC 应用程序之间实现单点登录问题。
和你一样，我确信我已经正确配置了`machineKey`and`authentication`元素。但我看到浏览器正在发送表单身份验证 Cookie，但在我的 4.5 应用程序的 Request.Cookies 中不可见。

然后我发现了这个： [http ://www.shawnmeyer.com/2013/10/sharing-forms-authentication-tickets-between-applications/](http://www.shawnmeyer.com/2013/10/sharing-forms-authentication-tickets-between-applications/)

这： [表单身份验证 SSO - 为什么 User.Identity.IsAuthenticated == false](https://stackoverflow.com/questions/21166613/forms-authentication-sso-why-does-user-identity-isauthenticated-false)

这给出了解决 FormsAuthentication Cookie 验证失败的两种不同方法。

基本上，您必须确保`httpRuntime`s 都针对相同版本的框架，或者您必须将 a 添加`compatibilityMode`到`machineKey`较新的 Web 应用程序中。无论哪种方式都对我有用 - 在 4.5 应用程序中，更改以下之一：

```
<httpRuntime targetFramework="4.0" /> 
```

或者

```
<machineKey validationKey="..."
                decryptionKey="..."
                validation="SHA1" decryption="AES" compatibilityMode="Framework20SP2"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T17:56:29.587

您可以尝试将 cookie 添加到 IIS 中的日志记录，以检查它是否通过负载平衡器。

另外，我知道很傻，但是您是否尝试过 Request.Cookies[".SSOAUTH"] 。还要查看 .count 以查看它收到了多少 cookie。

# c++ - why fails this template parameter inference?

> ID：10689709
> 
> 赞同：1
> 
> 时间：2012-05-21T17:24:14.867
> 
> 标签：c++, templates, lambda, c++11, type-inference

I'm trying to understand why this snippet fails:

```
#include <iostream>

using namespace std;

template <typename Lambda>
struct Handler
{
  bool _isCompleted;

  bool isCompleted() { return _isCompleted; }

  Lambda _l;
  Handler(Lambda&& l) : _l(l) {}

  void call() { _l(this); }
};

int main()
{
  auto l1 = new Handler( [&](decltype(l1) obj )->
{
  obj->_isCompleted = true;
  cout << " is completed?" << obj->isCompleted() << endl;
});
  l1->call();
}; 
```

g++ 4.5 fails with:

```
test.cpp: In function ‘int main()’:
test.cpp:21:17: error: expected type-specifier before ‘Handler’
test.cpp:21:17: error: expected ‘,’ or ‘;’ before ‘Handler’
test.cpp:25:2: error: expected primary-expression before ‘)’ token
test.cpp:25:2: error: expected ‘;’ before ‘)’ token
test.cpp:26:7: error: request for member ‘call’ in ‘* l1’, which is of non-class type ‘int’ 
```

my understanding is that `auto l1` should resolve to `Handler<lambdaType>*` and lambdaType should have a public function signature `void( Handler<LambdaType>*)`. I don't see any blatantly wrong with the above example (you know, besides the ugliness and the slightly pathological cyclic dependency between the lambda and the handler type)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T17:42:18.110

One problem is, as @Cat said, that template argument deduction just does not work for constructor calls. You always need to specify the template argument.

The other problem is nicely illustrated by Clang with the following snippet:

```
struct X{
  X(...){}
};

int main(){
  auto l = X([](decltype(l)& o){});
} 
```

Output:

```
t.cpp:6:26: error: variable 'l' declared with 'auto' type cannot appear in its
      own initializer
  auto l = X([](decltype(l)& o){});
                         ^
1 error generated. 
```

Obligatory standard quote:

`§7.1.6.4 [dcl.spec.auto] p3`

> Otherwise, the type of the variable is deduced from its initializer. The name of the variable being declared shall not appear in the initializer expression. [...]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T17:36:06.960

Type deduction doesn't work for constructors. `auto` will deduce the type for the expression, yes, but `new Handler()` requires explicit type. Write a factory function instead:

```
// also don't use raw owning pointers
template <typename L>
std::unique_ptr<Handler<L>> make_handler(L lambda) {
    return std::unique_ptr<Handler<L>>(new Handler<L>(lambda));
} 
```

Sure, it's repeating yourself a bit, but only once. Then you can do

```
auto l1 = make_handler([](...) { ... });
auto l2 = make_handler([](...) { ... }); 
```

and it'll work fine.

# jquery-mobile - jquery mobile中的数据图标位置

> ID：10689712
> 
> 赞同：0
> 
> 时间：2012-05-21T17:24:22.410
> 
> 标签：jquery-mobile, icons

我想在页面顶部添加 3 个数据图标：

" *" -------- "* *" ----------"*"

左-----中-----右

我使用 class="ui-btn-left" 作为左图标

右侧图标的“ui-btn-right”

居中图标的“ui-btn-center”

问题出在中心图标上，它没有出现在中心，它出现在左侧的新行

我应该怎么办 ？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T05:55:24.333

'ui-btn-center' 不起作用，因为它不是 jQuery Mobile 框架中支持的类。

您必须添加自己的一点 CSS 才能使其工作。

```
.ui-btn-center{
margin: 0 auto;
} 
```

尝试添加它，让我知道它是否有效。

# javascript - 通过 window.location.host 比较 URL？

> ID：10689721
> 
> 赞同：0
> 
> 时间：2012-05-21T17:25:21.957
> 
> 标签：javascript, url, comparison, window.location

我想比较当前网页的 URL。我的第一个想法是使用 window.location.host ：

```
if (window.location.host == example.com) {
    //code to be executed if condition is true
} 
```

但这不起作用。还有其他想法吗？

哦，好吧，我对 javascript 的教育并不多。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T17:27:11.007

你可以按照你说的去做。请记住将字符串文字放在引号中。

```
if (window.location.host == "example.com") {
    //code to be executed if condition is true
} 
```

# c# - 在没有上下文的情况下获取应用程序的完全限定根 URL？

> ID：10689726
> 
> 赞同：2
> 
> 时间：2012-05-21T17:25:57.050
> 
> 标签：c#, asp.net, .net, c#-4.0, .net-4.0

我想在没有上下文的情况下获取应用程序的完全限定根 URI。我喜欢下面的答案，但如果上下文为空，那么它会崩溃。有一个更好的方法吗？.NET API 中真的没有任何东西（甚至 4.5）吗？

[https://stackoverflow.com/a/1671440/235334](https://stackoverflow.com/a/1671440/235334)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:53:02.947

如果您在 IIS 中配置了多个绑定，它怎么知道，因为没有一个完全限定的根 URI？

我现在将它添加到 web.config，因为我有一个需要知道 URL 的电子邮件生成器，但从技术上讲，我至少有三个不同的有效 URL。

HttpContext 确实告诉您当前请求是如何被调用的。不过，您可以使用 IIS 管理 API 来[获取站点绑定](http://msdn.microsoft.com/en-us/library/microsoft.web.administration.bindingcollection%28VS.90%29.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:50:17.750

你需要一些东西来询问网址。有上下文表明您在应用程序中并且可以询问它。

如果您不在应用程序中，那么您需要获取它以便您可以询问它。IIS api 或许可以帮助您。

# internet-explorer - IE 8 和 FF 值冲突

> ID：10689730
> 
> 赞同：1
> 
> 时间：2012-05-21T17:26:09.430
> 
> 标签：internet-explorer, firefox, button

我有这个按钮

```
<input type="submit" name="forgot_pass" class="submitButton mainPageButton" id="forgotPassButton" value="Forgot Pass" /> 
```

在 Firefox 中，按钮值为“提交”，在 Internet Explorer 中为“忘记通行证”（我设置的值）。

我真的很困惑为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:35:35.010

两种浏览器都显示“忘记通行证”标题。

[http://jsfiddle.net/fb9h3/](http://jsfiddle.net/fb9h3/)

# iphone - 您如何将整个项目/应用程序复制到另一个名称？

> ID：10689732
> 
> 赞同：0
> 
> 时间：2012-05-21T17:26:27.997
> 
> 标签：iphone, xcode4

您如何将整个项目/应用程序复制到另一个名称？有时我想做一些代码更改，但我宁愿在我的代码的复制版本上尝试一下。我正在考虑将整个应用程序改成另一个名称。

这可能吗？
或者......现在想想，XCode 是否在其软件中提供某种类型的版本控制。意思是，创建一个新版本（从 1.0 到 1.1），对 v1.1 进行更改。如果我不喜欢，可以恢复到 v1.0。简洁的文字...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T18:17:41.670

听起来您迫切需要源代码控制系统。Xcode 与 git 集成，所以我会看一下。在这种情况下，您将创建（使用 git）一个分支以在 1.1 上进行实验；并且您可以轻松地在分支（1.0、1.1、...）之间切换。你可能喜欢浏览[http://git-scm.com/book](http://git-scm.com/book)

使用 git 之类的东西意味着您不需要使用 Finder 来创建项目的实验版本。这也意味着您可以轻松地在测试分支和用于发布版本的主分支之间移动代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:38:25.257

版本是可能的

但是如果你想复制....在finder中，复制项目文件夹并将其复制到其他地方。然后从该位置打开...更改版本号

# c# - XPath 到 CSS 选择器？

> ID：10689733
> 
> 赞同：0
> 
> 时间：2012-05-21T17:26:30.053
> 
> 标签：c#, xpath, css-selectors, html-agility-pack

您将如何转换以下形式的 xpath 选择器：

```
/html[1]/body[1]/table[1]/tr[3]/td[1]/table[1]/tr[1]/td[2]/table[1]/tr[1]/td[2] 
```

与它的 css 选择器等效吗？

或者，我需要为`HtmlAgilityPack.HtmlNode`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:58:30.117

我不知道为什么你绝对**需要**一个 CSS 选择器（如果不是所有的 HTML 解析器和测试套件都支持 CSS 选择器*和*XPath），但到底是什么：

```
html > body > table:nth-child(1) > tr:nth-child(3) > td:nth-child(1) > table:nth-child(1) > tr:nth-child(1) > td:nth-child(2) > table:nth-child(1) > tr:nth-child(1) > td:nth-child(2) 
```

我只是不包括伪类`html`，`body`因为它们是隐含的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T18:31:43.657

这些 div 和表中是否没有属性（id 或类）？如果有这会使 htmlagilitypack 的工作变得容易得多。

# php - 如何在phpmyadmin中进行批量sql操作

> ID：10689735
> 
> 赞同：1
> 
> 时间：2012-05-21T17:26:59.513
> 
> 标签：php, sql, phpmyadmin, cpanel

我在 cpanel phpmyadmin 下管理了大约 200 个数据库。我需要对每个操作进行类似的编辑。（2条SQL语句）

我想知道如何执行查询，以便它可以更改所有 200 个数据库中的所有表。（是否有更改所有 dbs 的功能）

执行查询没有问题，但是我觉得它效率低下，因为我现在正在做的是单击每个数据库并为该数据库执行 sql-> 必须执行 200 多次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:28:35.080

您可以开发存储过程或 php 脚本来构建动态查询并即时执行它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:34:51.417

好问题，您可以执行以下操作：

```
// Connect to your mysql server
mysql_connect(...);

// Execute command which gets you list of all database from mysql server
$rs = mysql_query("SHOW DATABASES");

// Loop through all of them and execute your sql statements;
while ( $ds = mysql_fetch_assoc($rs) )
{

    mysql_select_db( $ds['Database'] );
    $sql = "some sql";
    mysql_query($sql);
} 
```

我认为像上面这样的东西应该可以达到目的。

# c - 读取函数的返回值和缓冲区的长度不一样，C语言，ubuntu 12.04

> ID：10689737
> 
> 赞同：1
> 
> 时间：2012-05-21T17:27:09.490
> 
> 标签：c

在 ubuntu 12.04 中，我想写一个并发服务器，它可以从我的虚拟机接收 http 数据包，然后将数据包转发到我的虚拟机的原始目的地。但是当我在 C 语言中使用 read 函数读取数据包时，有时**返回值和缓冲区的长度不一样**（例如： rbyte=1024, strlen(buf)=62 ）。我检查了errno，发现errno=0，这意味着read函数没有错误。我认为这两个变量应该是完全一样的，但是对于我的程序来说，它们不是。以下是我的代码的一部分：

```
char buf[1024];
size_t rbyte = read(sFrom, buf, sizeof(buf) );
cerr << "length of buf: " << strlen(buf) << "\n";
cerr << "rbyte: " << rbyte << "\n"; 
```

我已阅读[http://pubs.opengroup.org/onlinepubs/009695399/functions/read.html](http://pubs.opengroup.org/onlinepubs/009695399/functions/read.html)以获得一些线索，但仍然不知道此错误的原因。

有谁知道原因？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T17:29:47.127

正如链接文档所述，`read`读取字节而不是字符串，因此如果输入包含零字节，您将得到一个小于读取字节数的字符串（请记住，C 使用以空字符结尾的字符串），这意味着第一个空字符决定了字符串的结尾——因此也决定了字符串的长度）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T18:55:01.370

这不是错误。的第三个参数`read()`表示可以读取的最大字节数。在达到第三个参数的大小之前它不会阻塞。

的返回指示请求`read()`时缓冲区中有多少字节。`read()`

您应该在未读取“n”字节（n = 您的消息大小）时执行循环。或直到`read()`返回 0（对于同步消息）。

提示：如果你写（客户端）空终止字符串，在服务器端你可以做一个`fdopen()`套接字描述符并使用`fgets()`（流缓冲区），它会阻塞你的代码，直到一个'\ 0'。

# python - 如何使用 pip 将 requirements.txt 文件的所有请求发送给互联网访问受阻的人？

> ID：10689738
> 
> 赞同：1
> 
> 时间：2012-05-21T17:27:10.667
> 
> 标签：python, pip

我基本上是想在我的办公室里安装一个 Python 应用程序来处理一项任务，但是其中一个要求现在不能很好地与 pybundle 一起使用，并且由于某种原因似乎无法在他们的机器上正确安装.

是否有任何其他简单的选择可以将所有要求传达给其他人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T01:38:15.630

看起来我找到了自己的答案。

```
pip install -r requirements.txt -d ./path/to/desired_package_dir 
```

这会按原样下载所有包，它们都是 .tar.gz。然后在我的例子中，这些包是通过版本控制共享的。然后其他人可以通过以下方式安装目录中的所有包：

```
pip install -r requirements.txt --download-cache=./path/to/desired_package_dir 
```

还没有100％确认这一点，但我认为它会成功......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:46:26.237

从来没有尝试过，但这不是`pip bundle`命令的用途吗？从它的输出来看`pip help bundle`，它甚至会接受一个包含包列表的输入文件。从未使用过它，不确定它会产生什么。

我认为这个想法是您将在与目标机器（操作系统等）相同但已连接但已连接的系统上运行 pip bundle，然后将其制作的包传输到未连接的机器。

# silverlight - 在设计时和运行时设置全局属性

> ID：10689740
> 
> 赞同：1
> 
> 时间：2012-05-21T17:27:22.923
> 
> 标签：silverlight, wcf-ria-services, silverlight-5.0

我正在开发一个包含 WCF RIA 服务的 Silverlight 5 应用程序。该应用程序将进行许多 Web 服务调用，并且每次调用都需要传递元素和`username`属性。其中一些调用将使用“系统管理员”用户名和密码，一些将使用用户自己的登录凭据。在所有情况下，该值将在用户登录时设置。`password``dsn``dsn`

所以我的问题是，在哪里存储所有这些？我现在将列出我的两个重要场景，希望有人可以提供帮助。

**验证**

我创建了一个自定义成员资格提供程序，它覆盖了`ValidateUser(string username, string password)`实际进行身份验证的方法。该方法中的代码使用用户提供的用户名和密码调用 Web 服务（在加载主页时出现的子窗口中）。

在子窗口中，用户可以选择他们想要使用的 DSN；但我不知道如何`ValidateUser()`在我的会员提供程序中使用该方法。

**授权**

对用户进行身份验证后，我需要服务器进行调用以获取有关用户的更多信息并将其存储为用户配置文件的一部分。这样，我以后可以在应用程序逻辑和 UI 元素中使用它。此调用将使用系统管理员凭据和用户在子窗口中选择的 DSN。

生成的代理确实`*Completed`为每个 SOAP 操作方法提供事件。我想我可以分配一个事件处理程序并在那里处理这个授权位。那么，我可以在哪里存储可以在我的客户端和服务器项目中访问它们的系统管理员凭据？

我已经实现了我的身份验证域服务，如下所示：

```
using System.ServiceModel.DomainServices.Hosting;
using System.ServiceModel.DomainServices.Server.ApplicationServices;

namespace THINKImportSystem.Web
{
  [EnableClientAccess]
  public class AuthenticationDomainService : AuthenticationBase<User>
  {
  }

  public class User : UserBase
  {
  }
} 
```

# php - 如何让我的 php 页面等待一个帖子（xml 字符串）？

> ID：10689741
> 
> 赞同：0
> 
> 时间：2012-05-21T17:27:26.393
> 
> 标签：php, xml, post

我有一个登录类，它将解析从 iOS、Android 手机发送的 xml。我不太擅长 php，我的问题是，如何让我的 php 页面等待帖子？还是我只是使用

```
$xml = $_POST['login.xml'];
  ....
  //parse
  ....
echo $responsexml; 
```

他还建议

```
$xml=readfile("php://input"); 
```

读取 xml 字符串。我对这个帖子业务感到很困惑。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:53:39.520

当 XML 字符串将通过 HTTP POST 请求发送时，例如在您的“login.xml”参数中，是的，您可以通过以下代码获取此内容：

```
$xml = $_POST['login.xml'];
// parsing here... 
```

如果您不知道参数数据将在哪个位置，您可以遍历数组 $_POST。但这是不寻常的。当你开发一个应用程序时，首先你应该在 PHP 中创建 API，然后你必须给 iOS 和 Android 应用程序的开发人员一些规范，以何种格式传输数据（或者更糟糕的是，他们会给你一些规范他们发送数据的格式）。

顺便一提。例如，我认为最简单的解决方案是发送带有数据参数“登录”和“密码”的 POST 请求。PHP 会运行一些验证并返回一些会话 ID。对于这种类型的所有请求，最好避免使用 XML，所有数据都可以通过 HTTP 请求。然后你不必解析任何东西：

```
$login = $_POST['login'];
$password = $_POST['password']; 
```

# android - USB调试Android 4.0.3 ICS：Eclipse看不到设备？

> ID：10689742
> 
> 赞同：0
> 
> 时间：2012-05-21T17:27:31.427
> 
> 标签：android, windows, eclipse, debugging, usb

我将三星 Galaxy S I9000 从 Stock Android 2.3.6 ROM 刷新到 Android 4.0.3（由 ICSSGS 团队定制 ROM，因为三星不会将 SGS 更新到 ICS）。所以，一切都很顺利，除了 Eclipse Indigo (Windows 7) 在通过 USB 调试连接时看不到设备。但是，USB 大容量存储确实有效。

所以，恕我直言，这个问题可能有两个原因：

1.  自定义 ROM 有点问题。
2.  Windows 7 上的 Eclipse Indigo 在 Android 4.0.3 上的 USB 调试确实存在问题。这可能是真的，因为 USB 大容量存储确实可以工作，所以 Windows 驱动程序和 Android 4.0.3 似乎没问题

有人有同样的问题吗？有谁知道，如果这个问题也出现在 Eclipse Indigo / Linux 中？有什么可用的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:08:48.883

在 android 系统更新（当前为 4.0.3）之后，我在 windows 7 64 位上运行的 PC 确认了驱动程序识别，但实际上没有 samsung/PC 连接处于活动状态。我不是开发者或极客......我没有遵循上面一些帖子中的技术建议......但我解决了这个问题：

我进入智能手机/设置/（下）数据使用/“更多”/（键入）USB 实用程序/消息 USB 大容量存储……”点击按钮（将存储连接到 PC）复制文件……计算机和 SD 卡”/结果：窗口 USB 实用程序...“连接 USB 电缆...大容量存储。”/ 物理连接电缆到 PC / 结果：Android 图标（绿色）确认 USB 连接与messg，“您已连接...触摸下面的按钮...这是一个窗格，”转在 USB 存储上”。触摸面板激活。Android 信息消息“关闭 USB 存储...如果您打开 USB 存储，某些应用程序...可能会停止..不可用..直到关闭 USB 存储”触摸确定按钮。带有 Android 图标（橙色）的新窗口确认 USB 存储设备正在使用中；智能手机资源管理器窗口在 PC 上弹出。重要的：Android messg 警告您“卸载”（正确弹出）USB 存储（Android SD 卡就像任何其他外部 HD 到 PC），这是通过右键单击任务栏中的 USB 图标来完成的。注意：如果右键单击没有响应（与我的电脑一样），请转到“我的电脑”/PC 并弹出您的手机，在我的情况下被视为驱动器 (F)，我将其重命名为“智能手机”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:22:17.503

三星需要专有驱动程序。

查看：

[http://www.samsung.com/us/support/downloads](http://www.samsung.com/us/support/downloads)

或者只是谷歌“/我的设备名称/ USB驱动程序”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T07:57:29.090

右击我的电脑->属性->设备管理器->右击未知设备->更新驱动软件->浏览你电脑上的驱动软件->指向：`path\adt-bundle-windows-x86-20130219\sdk\extras\google\usb_driver`

只需从 google 上找到 USB 驱动程序即可`eclipse path..\sdk\extras\google\usb_driver`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T20:25:45.447

您确实记得在未连接到计算机时启用USB调试，对吗？尝试也禁用它并连接 USB 。它可能有一个与之相关的错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T18:48:38.427

你试过这个吗？

```
sudo ./adb kill-server
sudo ./adb start-server 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-21T08:36:46.100

下载预装 Android ICS 的 (Samsung) 手机的最新驱动程序（不适用于您的手机）。这种方式可能同步管理器仍然无法工作，但我让 Eclipse 检测到我的手机进行调试。带 ICS 的 HTC Desite Z，HTC One 的驱动程序）

# android - TabListener、ActionBarSherlock Fragment 和 ListFragment、PageAdapter 的混合？一团糟

> ID：10689744
> 
> 赞同：8
> 
> 时间：2012-05-21T17:27:40.427
> 
> 标签：android, android-fragments, actionbarsherlock, android-actionbar

我有一个包含 2 个片段的活动。我决定使用 PageAdapter 在两个视图之间滑动，但是，为了接近 android 设计最佳实践，我还决定使用操作栏选项卡（固定选项卡）。我正在使用 ActionBarSherlock 和[这里的一些代码](http://developer.android.com/reference/android/app/ActionBar.html#newTab())实现选项卡。仅使用 pageadapter，活动就可以很好地工作，现在我遇到了两个问题：1）第一个片段（MatchRugbyButtonFragment）对他自己的图像进行了超印，所以如果我触摸它并移动或更改某些东西，我会看到工作片段上方的图像. 2）当我转到第二个片段时，第一个会丢失所有变量（计时器重置、计数器重置、ecc）。我必须创建 tablistener，因为一个片段是 SherlockFragment，另一个是 SherlockListFragment，这会导致无法将片段转换为 SherlockListFragment 的错误。这是活动：

```
 import java.util.ArrayList;
  import java.util.Arrays;
   import java.util.List;
    import java.util.Vector;

    import android.content.Intent;
    import android.os.Bundle;
     import android.support.v4.app.Fragment;
    import android.support.v4.app.FragmentManager;
     import android.support.v4.app.FragmentTransaction;
    import android.support.v4.app.ListFragment;
    import android.support.v4.view.ViewPager;
    import android.view.View;
    import android.widget.ArrayAdapter;
    import android.widget.Toast;

      import com.actionbarsherlock.app.ActionBar;
    import com.actionbarsherlock.app.ActionBar.Tab;
    import com.actionbarsherlock.app.SherlockFragment;
    import com.actionbarsherlock.app.SherlockFragmentActivity;
    import com.actionbarsherlock.view.Menu;
    import com.actionbarsherlock.view.MenuInflater;
    import com.actionbarsherlock.view.MenuItem;

    public class MatchRugbyFragments extends SherlockFragmentActivity implements View.OnClickListener, View.OnLongClickListener{

public static ArrayList<String> commentary;

public static ArrayAdapter<String> adapter;

// list contains fragments to instantiate in the viewpager
static List<Fragment> fragments = new Vector<Fragment>();
// page adapter between fragment list and view pager
private MyPagerAdapter mPagerAdapter;
// view pager
private ViewPager mPager;

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);     
    setContentView(R.layout.fragments_rugby);

    FragmentManager fragmentManager = getSupportFragmentManager();
    FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();

    MatchRugbyButtonFragment buttonFrag = new MatchRugbyButtonFragment();
    MatchRugbySummaryFragment listFrag = new MatchRugbySummaryFragment();
    fragmentTransaction.add(R.id.pager, buttonFrag);
    fragmentTransaction.add(R.id.pager, listFrag);
    fragmentTransaction.commit();

    // creating fragments and adding to list
    fragments.add(buttonFrag);
    fragments.add(listFrag);

    // creating adapter and linking to view pager
    this.mPagerAdapter = new MyPagerAdapter(super.getSupportFragmentManager(),fragments);
    mPager = (ViewPager) super.findViewById(R.id.pager);
    mPager.setAdapter(this.mPagerAdapter);

    String[] array = {""}; 
    commentary = new ArrayList<String>();
    commentary.addAll(Arrays.asList(array));

    adapter = new ArrayAdapter<String>(this,
            R.layout.list_item_commentary,  commentary);

    final ActionBar bar = getSupportActionBar();
    bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
    bar.setDisplayOptions(0, ActionBar.DISPLAY_SHOW_TITLE);
    bar.setHomeButtonEnabled(true);

    bar.addTab(bar.newTab()
            .setText("Comandi")
            .setTabListener(new TabListener<MatchRugbyButtonFragment>(
                    this, "comandi", MatchRugbyButtonFragment.class)));
    bar.addTab(bar.newTab()
            .setText("Riassunto")
            .setTabListener(new TabListenerList<MatchRugbySummaryFragment>(
                    this, "riassunto", MatchRugbySummaryFragment.class)));

    if (savedInstanceState != null) {
        bar.setSelectedNavigationItem(savedInstanceState.getInt("tab", 0));
    }
}

@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putInt("tab", getActionBar().getSelectedNavigationIndex());
}

//Comandi per il click prolungato
public boolean onLongClick(View view) {

    return false;
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.rugby_match_menu, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case android.R.id.home:
        // app icon in action bar clicked; go home
        Intent intent = new Intent(this, SportScoutActivity.class);
        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(intent);
        return true;
    default:
        return super.onOptionsItemSelected(item);
    }
}
public static void addCommentaryRow(String s){
    adapter.add(s);
    MatchRugbySummaryFragment f2 = (MatchRugbySummaryFragment) fragments.get(1);
    f2.setListAdapter(adapter);
}

public static String commentaryToString(){
    String sAdapter= adapter.toString();
    return sAdapter;
}

public void onClick(View arg0) {

}

/**
 * @return the commentary
 */
public  ArrayList<String> getCommentary() {
    return commentary;
}

/**
 * @param commentary the commentary to set
 */
public void setCommentary(ArrayList<String> commentary) {
    MatchRugbyFragments.commentary = commentary;
}

/**
 * @return the adapter
 */
public ArrayAdapter<String> getAdapter() {
    return adapter;
}

/**
 * @param adapter the adapter to set
 */
public void setAdapter(ArrayAdapter<String> adapter) {
    MatchRugbyFragments.adapter = adapter;
}

// page 1 fragment listener implementation
public void onPage1(String s) {    

    // page 2 fragment update

}

public static class TabListener<T> implements ActionBar.TabListener {
    private final SherlockFragmentActivity mActivity;
    private final String mTag;
    private final Class<T> mClass;
    private final Bundle mArgs;
    private android.support.v4.app.Fragment mFragment;

    public TabListener(SherlockFragmentActivity activity, String tag, Class<T> clz) {
        this(activity, tag, clz, null);
    }

    public TabListener(SherlockFragmentActivity activity, String tag, Class<T> clz, Bundle args) {
        mActivity = activity;
        mTag = tag;
        mClass = clz;
        mArgs = args;

        // Check to see if we already have a fragment for this tab, probably
        // from a previously saved state.  If so, deactivate it, because our
        // initial state is that a tab isn't shown.
        mFragment = mActivity.getSupportFragmentManager().findFragmentByTag(mTag);
        if (mFragment != null && !mFragment.isDetached()) {
            FragmentTransaction ft = mActivity.getSupportFragmentManager().beginTransaction();
            ft.detach(mFragment);
            ft.commit();
        }
    }

    public void onTabSelected(Tab tab, FragmentTransaction ft) {
        if (mFragment == null) {
            mFragment = (SherlockFragment) Fragment.instantiate(mActivity, mClass.getName(), mArgs);
            ft.add(android.R.id.content, mFragment, mTag);
        } else {
            ft.attach(mFragment);
        }
    }

    public void onTabUnselected(Tab tab, FragmentTransaction ft) {
        if (mFragment != null) {
            ft.detach(mFragment);
        }
    }

    public void onTabReselected(Tab tab, FragmentTransaction ft) {
        Toast.makeText(mActivity, "Reselected!", Toast.LENGTH_SHORT).show();
    }

}

public static class TabListenerList<T> implements ActionBar.TabListener {
    private final SherlockFragmentActivity mActivity;
    private final String mTag;
    private final Class<T> mClass;
    private final Bundle mArgs;
    private android.support.v4.app.ListFragment mFragment;

    public TabListenerList(SherlockFragmentActivity activity, String tag, Class<T> clz) {
        this(activity, tag, clz, null);
    }

    public TabListenerList(SherlockFragmentActivity activity, String tag, Class<T> clz, Bundle args) {
        mActivity = activity;
        mTag = tag;
        mClass = clz;
        mArgs = args;

        // Check to see if we already have a fragment for this tab, probably
        // from a previously saved state.  If so, deactivate it, because our
        // initial state is that a tab isn't shown.
        mFragment = (ListFragment) mActivity.getSupportFragmentManager().findFragmentByTag(mTag);
        if (mFragment != null && !mFragment.isDetached()) {
            FragmentTransaction ft = mActivity.getSupportFragmentManager().beginTransaction();
            ft.detach(mFragment);
            ft.commit();
        }
    }

    public void onTabSelected(Tab tab, FragmentTransaction ft) {
        if (mFragment == null) {
            mFragment = (ListFragment) Fragment.instantiate(mActivity, mClass.getName(), mArgs);
            ft.add(android.R.id.content, mFragment, mTag);
        } else {
            ft.attach(mFragment);
        }
    }

    public void onTabUnselected(Tab tab, FragmentTransaction ft) {
        if (mFragment != null) {
            ft.detach(mFragment);
        }
    }

    public void onTabReselected(Tab tab, FragmentTransaction ft) {
        Toast.makeText(mActivity, "Reselected!", Toast.LENGTH_SHORT).show();
    }

}
    } 
```

这是页面适配器类：

```
 package com.gmail.david.corsalini.sportscout;

    import java.util.List;

     import android.support.v4.app.Fragment;
    import android.support.v4.app.FragmentManager;
    import android.support.v4.app.FragmentPagerAdapter;

    public class MyPagerAdapter extends FragmentPagerAdapter {

    // fragments to instantiate in the viewpager
    private List<Fragment> fragments;

    // constructor
    public MyPagerAdapter(FragmentManager fm,List<Fragment> fragments) {
        super(fm);
        this.fragments = fragments;
    }

    // return access to fragment from position, required override
    @Override
    public Fragment getItem(int position) {
        return this.fragments.get(position);
    }

    // number of fragments in list, required override
    @Override
    public int getCount() {
        return this.fragments.size();
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T18:38:59.860

！！！问题解决了！！！

我不知道这是否是这里的最佳实践，但我已经解决了我的问题，感谢这个[页面](http://davidjkelley.net/?p=34)，我想分享它以帮助有需要的人。那里的操作栏是“原始的”，所以我不得不对其进行一些定制以适应 ABS。这是最后一个类，它处理选项卡和 swype 的各个方面（包括自动将选项卡放在操作栏内部或外部）：

```
 import java.util.ArrayList;
   import java.util.Arrays;
   import android.content.Context;
   import android.content.Intent;
   import android.os.Bundle;
   import android.support.v4.app.Fragment;
   import android.support.v4.app.FragmentPagerAdapter;
   import android.support.v4.app.FragmentTransaction;
   import android.support.v4.view.ViewPager;
   import android.util.Log;
   import android.view.View;
   import android.widget.ArrayAdapter;
   import com.actionbarsherlock.app.ActionBar;
   import com.actionbarsherlock.app.ActionBar.Tab;
   import com.actionbarsherlock.app.SherlockFragmentActivity;
   import com.actionbarsherlock.view.Menu;
   import com.actionbarsherlock.view.MenuInflater;
   import com.actionbarsherlock.view.MenuItem;

   public class MatchRugbyFragments extends SherlockFragmentActivity implements View.OnClickListener, View.OnLongClickListener{

public static ArrayList<String> commentary;

public static ArrayAdapter<String> adapter;

private ViewPager mViewPager;
private TabsAdapter mTabsAdapter;

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);     
    setContentView(R.layout.fragments_rugby);

    String[] array = {}; 
    commentary = new ArrayList<String>();
    commentary.addAll(Arrays.asList(array));

    adapter = new ArrayAdapter<String>(this,
            R.layout.list_item_commentary,  commentary);

    mViewPager = new ViewPager(this);
    mViewPager.setId(R.id.pager);
    setContentView(mViewPager);
    final ActionBar bar =  getSupportActionBar();
    bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
    bar.setDisplayOptions(0, ActionBar.DISPLAY_SHOW_TITLE);
    bar.setHomeButtonEnabled(true);

    mTabsAdapter = new TabsAdapter(this, mViewPager);
    mTabsAdapter.addTab(bar.newTab().setText(""+"Comandi"),
            MatchRugbyButtonFragment.class, null);
    mTabsAdapter.addTab(bar.newTab().setText(""+"Riassunto"),
            MatchRugbySummaryFragment.class, null);

}

@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putInt("tab", getActionBar().getSelectedNavigationIndex());
}

//Comandi per il click prolungato
public boolean onLongClick(View view) {

    return false;
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.rugby_match_menu, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case android.R.id.home:
        // app icon in action bar clicked; go home
        Intent intent = new Intent(this, SportScoutActivity.class);
        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(intent);
        return true;
    default:
        return super.onOptionsItemSelected(item);
    }
}
public static void addCommentaryRow(String s){
    adapter.add(s);

}

public static String commentaryToString(){
    String sAdapter= adapter.toString();
    return sAdapter;
}

public void onClick(View arg0) {

}

/**
 * @return the commentary
 */
public  ArrayList<String> getCommentary() {
    return commentary;
}

/**
 * @param commentary the commentary to set
 */
public void setCommentary(ArrayList<String> commentary) {
    MatchRugbyFragments.commentary = commentary;
}

/**
 * @return the adapter
 */
public ArrayAdapter<String> getAdapter() {
    return adapter;
}

/**
 * @param adapter the adapter to set
 */
public void setAdapter(ArrayAdapter<String> adapter) {
    MatchRugbyFragments.adapter = adapter;
}

public static class TabsAdapter extends FragmentPagerAdapter
implements ActionBar.TabListener, ViewPager.OnPageChangeListener {
    private final Context mContext;
    private final ActionBar mActionBar;
    private final ViewPager mViewPager;
    private final ArrayList<TabInfo> mTabs = new ArrayList<TabInfo>();

    static final class TabInfo {
        private final Class<?> clss;
        private final Bundle args;

        TabInfo(Class<?> _class, Bundle _args) {
            clss = _class;
            args = _args;
        }
    }

    public TabsAdapter(SherlockFragmentActivity activity, ViewPager pager) {
        super(activity.getSupportFragmentManager());
        mContext = activity;
        mActionBar = activity.getSupportActionBar();
        mViewPager = pager;
        mViewPager.setAdapter(this);
        mViewPager.setOnPageChangeListener(this);
    }

    public void addTab(ActionBar.Tab tab, Class<?> clss, Bundle args) {
        TabInfo info = new TabInfo(clss, args);
        tab.setTag(info);
        tab.setTabListener(this);
        mTabs.add(info);
        mActionBar.addTab(tab);
        notifyDataSetChanged();
    }

    public int getCount() {
        return mTabs.size();
    }

    public Fragment getItem(int position) {
        TabInfo info = mTabs.get(position);
        return Fragment.instantiate(mContext, info.clss.getName(), info.args);
    }

    public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {
    }

    public void onPageSelected(int position) {
        mActionBar.setSelectedNavigationItem(position);
    }

    public void onPageScrollStateChanged(int state) {
    }

    public void onTabSelected(Tab tab, FragmentTransaction ft) {
        mViewPager.setCurrentItem(tab.getPosition());
        Log.v("TAG", "clicked");
        Object tag = tab.getTag();
        for (int i=0; i<mTabs.size(); i++) {
            if (mTabs.get(i) == tag) {
                mViewPager.setCurrentItem(i);
            }
        }
    }

    public void onTabUnselected(Tab tab, android.app.FragmentTransaction ft) {}

    public void onTabUnselected(Tab tab, FragmentTransaction ft) {

    }

    public void onTabReselected(Tab tab, FragmentTransaction ft) {

    }

}
   } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-08T05:14:07.167

我在这里写了一个教程 - [http://lomza.totem-soft.com/tutorial-actionbarsherlock-tabs-viewpager-listfragment-with-tab-listeners-and-more/](http://lomza.totem-soft.com/tutorial-actionbarsherlock-tabs-viewpager-listfragment-with-tab-listeners-and-more/)关于这个主题。基本实现与 David 的帖子中的实现非常相似。也许，这对某人有用；）

# java - 当只期望一个值但存在多个值时抛出什么内置异常

> ID：10689746
> 
> 赞同：0
> 
> 时间：2012-05-21T17:27:45.327
> 
> 标签：java, exception

我想在一个期望只有一个元素的列表的方法中抛出一个异常，如果列表有多个元素，我想抛出一个异常。我正在尝试确定是否有适当的现有 Java 异常可以针对这种情况抛出。我试着在[这里](http://wuhrr.wordpress.com/2007/11/22/java-exceptions-list/)查看列表，但没有看到任何正确的跳出。

在这种情况下，我正在调用对象的方法，期望该方法将所述列表引用为对象的属性。所以我实际上没有传递数组，也没有传递索引作为参数。

（为澄清而编辑）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T17:29:48.023

由于您试图暗示给定的输入不是有效的输入，因此您应该使用`IllegalArgumentException`一条说明相同原因的消息。

```
throw new IllegalArgumentException("Input specified has more elements then expected"); 
```

否则，您可以拥有自己的`Exception`唯一定义条件的。

虽然我不知何故觉得它的元素数量是异常的原因，你甚至可以使用`IndexOutOfBoundsException`这在给定的场景中是有意义的。

```
throw new IndexOutOfBoundsException("Expected size is 1, submitted input has size " + list.size()); 
```

编辑：根据评论

鉴于该列表不是方法调用的一部分，而是属于其方法被调用的对象，在这种情况下`list.size() > 1`表示对象未处于正确状态，并且带有适当错误消息的自定义版本`IllegalStateException`或`IllegalStateException`本身将更合适。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T17:29:02.320

您可以创建自己的异常并抛出它。

```
public MyException extends Exception {
}

if(list.size() > 1) {
    throw new MyException("Expected only 1 element, found: " + list.size());
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T17:39:27.770

如果列表是您正在调用该方法的对象的字段，那么您可以说具有错误大小列表的对象处于错误状态，因此`IllegalStateException`是合适的。

但实际上，您应该用标量字段 ( `List<Foo>`become `Foo`) 替换列表，这样就不会出现这种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T17:31:05.170

您可以像这样在方法中抛出错误

```
public void someMethod(List<MyClass> myList) throws NullPointerException, IllegalArgumentException {
    if (myList == null)
        throw new NullPointerException("myList parameter can't be null");
    if (myList.size() > 1) {
        throw new IllegalArgumentException("myList parameter must contain only 1 parameter");
    }
    //your code here...
} 
```

最好在属性文件中设置错误消息，这样您只需要更改配置即可显示新消息，无需通过修改代码来重写错误消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T17:56:29.930

我不确定我是否理解用例，所以这个答案可能不正确，但我建议使用 AssertionError

```
List < T > answers ; // expection a list of size one
assert 1 == list . size ( ) : "The programmer expects that there will be one and only one answer"
/*
In development:  assertions enabled,
 If there are zero answers, the program will crash on the assertion.
 If there are multiple answers, the program will crash on the assertion.
 Only if there is exactly one answer will it proceed to the below line (and work correctly).
In production:  assertions disbled,
 If there are zero answers, the program will throw a RuntimeException on the below line.
 If there are multiple answers, the program will proceed to the below line (and appear to work).
 If there is only one answer, the program will proceed to the below line and wok correctly.
*/
T answer = answers . get ( 0 ) ; 
```

这种方法优于使用`if`或`switch`

1.  一些代码覆盖工具会希望您为分支编写单元测试。
2.  分支增加了圈复杂度。
3.  评估仅在开发期间执行

# python - How to read bits from a file?

> ID：10689748
> 
> 赞同：20
> 
> 时间：2012-05-21T17:28:08.070
> 
> 标签：python, io, binary

I know how to read bytes — `x.read(number_of_bytes)`, but how can I read bits in Python?

I have to read only 5 bits (not 8 bits [1 byte]) from a binary file

Any ideas or approach?

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-21T17:31:11.597

Python can only read a byte at a time. You'd need to read in a full byte, then just extract the value you want from that byte, e.g.

```
b = x.read(1)
firstfivebits = b >> 3 
```

Or if you wanted the 5 least significant bits, rather than the 5 most significant bits:

```
b = x.read(1)
lastfivebits = b & 0b11111 
```

Some other useful bit manipulation info can be found here: [http://wiki.python.org/moin/BitManipulation](http://wiki.python.org/moin/BitManipulation)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T19:31:31.773

As the accepted answer states, standard Python I/O can only read and write whole byte(s) at a time. However you can simulate such a stream of bits using this recipe for [Bitwise I/O](http://rosettacode.org/wiki/Bitwise_IO#Python).

**Updates**

After modifying the Rosetta Code's Python version to work in unchanged in both Python 2 & 3, I incorporated those changes into this answer.

In addition to that, later, after being inspired by a comment made by @mhernandez, I further modified the Rosetta Code so it supports what's called the [context manager protocol](https://docs.python.org/3/glossary.html#term-context-manager) which allows instances of both of its two classes to be used in Python [`with`](https://docs.python.org/3/reference/compound_stmts.html#with) statements. Latest version is shown below:

```
class BitWriter(object):
    def __init__(self, f):
        self.accumulator = 0
        self.bcount = 0
        self.out = f

    def __enter__(self):
        return self

    def __exit__(self, exc_type, exc_val, exc_tb):
        self.flush()

    def __del__(self):
        try:
            self.flush()
        except ValueError:   # I/O operation on closed file.
            pass

    def _writebit(self, bit):
        if self.bcount == 8:
            self.flush()
        if bit > 0:
            self.accumulator |= 1 << 7-self.bcount
        self.bcount += 1

    def writebits(self, bits, n):
        while n > 0:
            self._writebit(bits & 1 << n-1)
            n -= 1

    def flush(self):
        self.out.write(bytearray([self.accumulator]))
        self.accumulator = 0
        self.bcount = 0

class BitReader(object):
    def __init__(self, f):
        self.input = f
        self.accumulator = 0
        self.bcount = 0
        self.read = 0

    def __enter__(self):
        return self

    def __exit__(self, exc_type, exc_val, exc_tb):
        pass

    def _readbit(self):
        if not self.bcount:
            a = self.input.read(1)
            if a:
                self.accumulator = ord(a)
            self.bcount = 8
            self.read = len(a)
        rv = (self.accumulator & (1 << self.bcount-1)) >> self.bcount-1
        self.bcount -= 1
        return rv

    def readbits(self, n):
        v = 0
        while n > 0:
            v = (v << 1) | self._readbit()
            n -= 1
        return v

if __name__ == '__main__':
    import os
    import sys
    # Determine this module's name from it's file name and import it.
    module_name = os.path.splitext(os.path.basename(__file__))[0]
    bitio = __import__(module_name)

    with open('bitio_test.dat', 'wb') as outfile:
        with bitio.BitWriter(outfile) as writer:
            chars = '12345abcde'
            for ch in chars:
                writer.writebits(ord(ch), 7)

    with open('bitio_test.dat', 'rb') as infile:
        with bitio.BitReader(infile) as reader:
            chars = []
            while True:
                x = reader.readbits(7)
                if not reader.read:  # End-of-file?
                    break
                chars.append(chr(x))
            print(''.join(chars)) 
```

Another usage example showing how to "crunch" an 8-bit byte ASCII stream discarding the most significant "unused" bit...and read it back (however neither use it as a context manger).

```
import sys
import bitio

o = bitio.BitWriter(sys.stdout)
c = sys.stdin.read(1)
while len(c) > 0:
    o.writebits(ord(c), 7)
    c = sys.stdin.read(1)
o.flush() 
```

...and to "decrunch" the same stream:

```
import sys
import bitio

r = bitio.BitReader(sys.stdin)
while True:
    x = r.readbits(7)
    if not r.read:  # nothing read
        break
    sys.stdout.write(chr(x)) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-09-21T22:07:00.307

This appears at the top of a Google search for reading bits using python.

I found `bitstring` to be a good package for reading bits and also an improvement over the native capability (which isn't bad for Python 3.6) e.g.

```
# import module
from bitstring import ConstBitStream

# read file
b = ConstBitStream(filename='file.bin')

# read 5 bits
output = b.read(5)

# convert to unsigned int
integer_value = output.uint 
```

More documentation and details here: [https://pythonhosted.org/bitstring/index.html](https://pythonhosted.org/bitstring/index.html)

# c# - 如何为 C# 中的数字集构建 ADT？

> ID：10689749
> 
> 赞同：-2
> 
> 时间：2012-05-21T17:28:09.430
> 
> 标签：c#, .net

如何在 C# 中为具有以下属性的数字集构建 ADT：设置联合、交集、差异、大小、将元素添加到集合、从集合中删除元素。

谁能给我看一个使用上述操作之一的简单程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:29:35.280

微软为你构建了集合类：[`System.Collections.Generic.HashSet<T>`](http://msdn.microsoft.com/en-us/library/bb359438.aspx).

# javascript - 使用表达式数组搜索

> ID：10689752
> 
> 赞同：0
> 
> 时间：2012-05-21T17:28:13.547
> 
> 标签：javascript, regex

我正在尝试遍历一系列不允许的单词。但是我试图完全匹配这个词：例如，如果它匹配“猫”而不是“餐饮”，我想做一些事情。所以我试图测试这个词前后是否有空格，看看它是否是一个词而不是另一个词的一部分。

这是我的尝试：

```
var badWords = [
  "cat",
  "catering",
  "cattle"
];

var string = "";
for (j=0;j<badWords.length;j++) {
  var regex = "/\s" + badWords[j] + "\s/";
  if string.search(regex)) {
    alert("works");
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:38:47.100

```
var badWords = [
  "cat",
  "catering",
  "cattle"
];

var string = "cat";
for (var j=0;j<badWords.length;j++) {
  var patt = new RegExp("(^|\\b)" + badWords[j] + "(\\b|$)");
  if(patt.test(string)) {
    console.log("works");
  }
} 
```

# azure - 使用带有“被动-主动”场景的 ACS 来访问基于 ASP.NET MVC WebAPI 的 REST 服务时遇到问题

> ID：10689753
> 
> 赞同：0
> 
> 时间：2012-05-21T17:28:20.067
> 
> 标签：azure, wif, acs

我通常是 ACS、WIF 和联合身份的新手，但我一直在研究 WIF SDK 培训工具包（以及 ACS 示例）中的示例，但我在与基于 ASP.NET MVC WebAPI 的 REST 服务（托管在 Azure 上），我将 ACS 设置为 FP。如果我使用浏览器测试我的 REST 服务 ( [http://jordan-helloacs.cloudapp.net](http://jordan-helloacs.cloudapp.net) )，我将获得传统的“被动身份验证”体验，并且可以通过 Live ID 或 Google 登录（我将其设置为ACS 中的两个 IP）。

但是，我正在尝试使用一个简单的 WPF 应用程序来实现“被动-主动”体验，该应用程序通过使用

> "https://[myACSnamespace].accesscontrol.windows.net/v2/metadata/IdentityProviders.js?protocol=javascriptnotify&realm=http://jordan-helloacs.cloudapp.net/&version=1.0",

ACS 上的端点列出可用的 IP，然后托管一个 WebBrowser 控件来处理对该 IP 的登录，并提取从 ACS 返回的 ACS 令牌，然后（使用 RestSharp）在[http 上对我的端点进行 GET 调用： //jordan-helloacs.cloudapp.net](http://jordan-helloacs.cloudapp.net)。我已经成功提取了令牌（我已经尝试过 SWT 和 SAML2），但是一旦我从 WebBrowser 控件中获得了令牌，我就无法弄清楚我需要对它做什么。我见过几个不同的例子，其中令牌前面带有“OAUTH”或“WRAP access_token =”，并且只是传入了“Authorization”标头，但我所做的一切似乎都没有奏效。我的 RestSharp 客户端不断收到 302 到 ACS 登录页面。

关于我可能做错了什么的任何提示？我怎么知道如何指定 auth 标头格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T19:41:20.973

我正在写有关如何在 HTTP 标头或通过查询字符串或以下形式传递 SWT 令牌的更多信息：

如果您在 HTTP 标头中传递令牌，则应使用“授权”标头，此标头的值包含以下文本：WRAP access_token="tokenstring"，并且不需要进行 URL 编码。

```
string headerValue = string.Format("WRAP access_token=\"{0}\"", HttpUtility.UrlDecode(token)); 
var client = new WebClient();            
client.Headers.Add("Authorization", headerValue); 
```

如果您在“查询字符串”或“表单”内容中传递令牌，那么您应该使用名称/值对 as wrap_access_token=tokenstring 并且必须进行 URL 编码以构造 HTTP 请求：

```
var values = new NameValueCollection();
values.Add("wrap_access_token", token);
var client = new WebClient();
client.UploadValues("BartenderWebservice", "POST", values)); 
```

您可以使用上述任何一种方法，然后您可以将流传递给您的客户端，如下所示，一旦发送，请使用 Fiddler 或其他实用程序验证标头的正确性。

```
Stream stream = client.OpenRead(@"http://yourwcfservice.cloudapp.net/RESTfulWCFServiceEndPoint.svc/_users_");
StreamReader reader = new StreamReader(stream);
String response = reader.ReadToEnd(); 
```

正如您提到的，您在连接到 RestFulWCF 端点时收到 302 错误（转发到 ACS URL）。仅当您启用了 IIS 日志记录时，您实际上可以 RDP 到您的 Azure VM 并查看应用程序事件日志以获取有关此错误的更多详细信息。我在事件日志中看到了这个错误，并提供了有关它发生原因的更多信息。可能是您的 web.config 中的某些设置导致了此问题。

**稍后添加**

在 ASPNet MVC 场景中，在获取令牌结束时，会创建一个 cookie，然后将 cookie 传递给 ASP Net 应用程序以指示身份验证。在顶层，您需要模拟类似的东西才能使其工作。

注意：这绝不是确切的答案，但是我不得不使用这个空间“作为答案”来编写格式化的评论以更好地表达。

# c - 使用 c/c++ 双击文件夹时打开我的应用程序

> ID：10689755
> 
> 赞同：0
> 
> 时间：2012-05-21T17:28:30.057
> 
> 标签：c, windows

我想在双击文件夹时打开我的应用程序。我想将一个文件夹与我的应用程序相关联，以便在打开文件夹之前，我可以执行一些操作，然后根据操作的结果我可以决定是否打开文件夹。

有没有办法将文件夹的打开功能重定向到我的应用程序？

我正在使用 Windows 7

你能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T06:25:25.310

Very very bad idea. Write rather driver with using ZwQueryInformationFile and similar functions for purpose of this. Or write shell namespace extension and in your IShellFolder::EnumObjects implementation may show your 'super' password dialog. :-) More: [http://msdn.microsoft.com/en-us/library/windows/desktop/bb775066(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775066(v=vs.85).aspx)

# .htaccess - 如何对 /../index.php （父目录）执行 ErrorDocument 404？

> ID：10689758
> 
> 赞同：1
> 
> 时间：2012-05-21T17:28:40.537
> 
> 标签：.htaccess, parent

如果用户访问 URL：（`http://domain.com/folder/page.php?error=404`不存在）

**如何将 .htaccess 重定向到一个文件夹** `http://domain.com/page.php?error=404`。

我一直在使用`ErrorDocument 404 /index.php`重定向到它的索引页面，但我找不到如何引用它的父文件夹？

谢谢！

编辑：我还应该提一下，如果除了 mod rewrite 规则之外还有其他方法，我很感兴趣

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:38:35.603

弄清楚了...

如果我这样做，它会起作用`ErrorDocument 404 /`

然后在这种情况下，该文件夹中的任何内容都将重定向到根文件夹。我不确定它是否适用于多个文件夹或直接父文件夹。但这对我有用，因为我需要转到根目录，这是一个文件夹。

# php - PHP 输出缓冲和标头位置

> ID：10689759
> 
> 赞同：1
> 
> 时间：2012-05-21T17:28:41.363
> 
> 标签：php, authentication, ms-access, output-buffering

在我们的一台服务器上有一个非常古老的 php 身份验证脚本，如下所示：

```
ob_start();

$log = new Auth();
// returns true
$checkSession = $log->checkLog();

 if(!$checkSession){

    header("Location: ../index.php");
    exit();

  }else{

    include "content/".$_GET["content"].".php";

   }

$content = ob_get_contents();
ob_end_clean();

include "../".WEBROOT_TEMPLATE_FILE; 
```

它总是运行顺利（经过身份验证的用户能够访问该页面，未经身份验证的用户被重定向到主页）......直到今天！

由于一些完全未知的原因，当用户试图从一个由 access 2000 数据库生成的链接访问服务器页面之一时，他们总是被重定向到 index.php。

奇怪的是，将 url 直接粘贴到浏览器中时效果很好。url 是完全一样的，$_SERVER 变量在两种情况下也是一样的。我什至检查了同样相同的 HTTP 标头。

此外，如果我评论重定向，它确实有效：

```
 if(!$checkSession){

    //header("Location: ../index.php");
    //exit();

  }else{
    // that part is executed
    include "content/".$_GET["content"].".php";

   } 
```

有人在这里遇到了同样的问题，但遗憾的是没有收到任何有效的答案：[PHP if-statement ignored when header(Location: xxx) is inside](https://stackoverflow.com/questions/6149941/php-if-statement-ignored-when-headerlocation-xxx-is-inside)

任何想法 ？

在此先感谢您的帮助，

**编辑**：找到解决方案

出于某种原因，apache 服务器不喜欢由 access 2000 数据库生成的 http 请求，并发出了一个带有修改头的新请求（尤其是 http 接受）......遗憾的是，第一个请求没有初始化任何会话...因此重定向到 index.php。

所以（丑陋但有效的）解决方案对我来说是：

```
if($_SERVER['HTTP_ACCEPT']!="*/*"){
// Do your stuff
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:36:13.043

尝试这个：

```
header("Location: http://site.com/index.php"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T10:18:56.920

在之后添加`ob_start()`：

```
if(!isset($_SESSION)) {
      session_start();
} 
```

在此之后，检查任何变量`$_SESSION[]`是否已设置并具有任何值：

```
if(!isset($_SESSION['username']) || $_SESSION['username'] == "") {

  header("Location: ../index.php"); //redirect unauthorized users
  exit();
}
else {
 // your code
} 
```

**注意：**以上代码只是一个示例，使用前请根据需要进行更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T10:06:28.070

正如@MonkeyMonkey 所说，这很可能与已经发送标头/cookie 的事实有关，并且当脚本到达会话身份验证并重定向时，它无法重新发送它们。

如果您将 error_reporting 设置为 E_ALL，这应该会产生“**警告：标头已发送”。**

现在关于输出从**哪里**开始，要精确定位是非常棘手的。实际上，在 ob_start 之前包含的任何文件都可以在末尾有一个空格/制表符/换行符（在结尾**?>**之后）。

# python - TProcessPoolServer 优雅关闭？

> ID：10689772
> 
> 赞同：2
> 
> 时间：2012-05-21T17:29:43.133
> 
> 标签：python, thrift

**如何优雅地关闭 python thrift 服务器 TProcessPoolServer？**我没有找到任何文档、示例或博客文章。以下是我迄今为止的经历。

我直接在命令行 ./thrift_service.py 上运行我的 thrift 服务器，而不是在主管之下。我正在使用 python 2.6 和 thrift 0.8.0。

我最初尝试过：

```
server = TProcessPoolServer(processor, transport, tfactory, pfactory)
try:
    server.serve()
finally:
    server.stop() 
```

当我向父 python 进程发送 sigterm 时，我在输出中看到“终止”，该进程被终止，但它的子进程是孤立的并继续运行。

然后我偶然发现了[thrift server tests](http://svn.apache.org/repos/asf/thrift/trunk/test/py/TestServer.py)，并尝试了：

```
import signal
def set_alarm(server):
    def clean_shutdown(signum, frame):
        for worker in server.workers:
            logging.error("Terminating worker: {0}".format(worker))
            worker.terminate()
        logging.error("Requesting server to stop()")
        try:
            server.stop()
        except (KeyboardInterrupt, SystemExit):
            pass
        except Exception as err:
            logging.exception(err)
    def logme(s, *args, **kwargs):
        logging.error(">>> {0} <<<".format(s))
        clean_shutdown(*args, **kwargs)
    signal.signal(signal.SIGALRM, clean_shutdown)
    signal.signal(signal.SIGHUP, clean_shutdown)
    signal.signal(signal.SIGINT, clean_shutdown)
    signal.signal(signal.SIGTERM, lambda x, y: logme("SIGTERM", x, y))
server = TProcessPoolServer(processor, transport, tfactory, pfactory)
set_alarm(server)
server.serve() 
```

当我向父 python 进程发送 sigterm、sigalrm、sighup 或 sigint 时，服务器停止接受连接，但进程没有终止。

在输出中我看到：

```
ERROR:root:>>> SIGTERM <<<
ERROR:root:Terminating worker: <Process(Process-1, started daemon)>
ERROR:root:Terminating worker: <Process(Process-2, started daemon)>
ERROR:root:Terminating worker: <Process(Process-3, started daemon)>
ERROR:root:Terminating worker: <Process(Process-4, started daemon)>
ERROR:root:Terminating worker: <Process(Process-5, started daemon)>
ERROR:root:Requesting server to stop() 
```

这是意料之中的，但是随后再次捕获到信号，进程不再处于启动状态，并且要求服务器停止。这部分发生了大约十次，然后就没有更多的输出了。

```
ERROR:root:>>> SIGTERM <<<
ERROR:root:Terminating worker: <Process(Process-1, unknown daemon)>
ERROR:root:Requesting server to stop() 
```

有时，我会在多处理库中看到一个 AssertionError：

```
Traceback (most recent call last):
  File "/path/to/thrift_service.py", line 340, in clean_shutdown
    server.stop()
  File "/usr/local/lib/python2.6/dist-packages/thrift/server/TProcessPoolServer.py", line 123, in stop
    self.stopCondition.notify()
  File "/usr/lib/python2.6/multiprocessing/synchronize.py", line 223, in notify
    assert not self._wait_semaphore.acquire(False)
AssertionError 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:58:29.607

我使用信号和它公开的 postForkCallback 向 python 中的 TProcessPoolServer 添加了正常关闭。一旦初始化，TProcessPoolServer 将在每个工作进程中调用您的 postForkCallback。这允许您设置信号处理程序并正常关闭。由于工作人员捕获 SystemExit 或 KeyboardInterruptException 异常，您可以为 SIGINT 设置一个处理程序，然后在完成清理后调用 sys.exit(0) ，这将导致工作人员关闭。

```
import signal
import sys

def setupHandlers():
    signal.signal(signal.SIGINT, handleSIGINT)
    #Optionally if you want to keep the current socket connection open and working
    #tell python to make system calls non-interruptable, which is probably what you want.
    signal.siginterrupt(signal.SIGINT, False)

def handleSIGINT(sig, frame):
     #clean up state or what ever is necessary
     sys.exit(0)

server = TProcessPoolServer(processor, transport, tfactory, pfactory)
server.setPostForkCallback(setupHandlers)

#Setup handlers in main process too
setupHandlers()

#Start server
server.start() 
```

这样，每个生成的工作进程都会设置信号处理程序以正确处理正常关闭。在此示例中，我为主进程以及可能根据您的用例工作的工作人员设置了相同的处理程序，但如果需要，您可以轻松地为主进程定义不同的处理程序。请记住，处理程序将从每个进程的上下文中调用，因此您将无法在清理期间跨进程共享状态。

有关 signal.siginterrupt 的作用以及您可能需要它的原因的更多详细信息，请参见[http://docs.python.org/library/signal.html 。](http://docs.python.org/library/signal.html)

编辑：您需要使用 Crtl + C 将 SIGINT 信号发送到所有进程，或者如果它作为守护进程运行 kill -SIGINT [pids of all processes]

您可以使用 ps --ppid [parent pid] 轻松获取工作人员的 pid

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-13T07:34:26.713

程序启动后，我记录了主进程的进程号。然后根据`ps --ppid`，取回主进程的子进程，一一杀死。

我的服务的控制外壳脚本的代码：

```
function stop
{
    SERVER_PID=`cat logs/server.pid`
    SPIDS=`ps --ppid $SERVER_PID | awk '{if ($1!="PID") print $1}'`
    kill -9 $SERVER_PID
    for PID in $SPIDS
    do
        kill -9 $PID
    done
} 
```

# python - Python 类和对象

> ID：10689777
> 
> 赞同：0
> 
> 时间：2012-05-21T17:30:01.880
> 
> 标签：python

我对 Oops 有点陌生，我对 Python 类感到困惑。虽然我在高中学习 C++，但我知道我当时学的根本不是 C++（它是一种带类的 C，没有模板， STL，或命名空间）

如果我错了，请纠正我，但对我来说，类只是对象的蓝图，对吧？

现在，如果我想在 C++ 中创建一个类的实例（例如，我的类名是“动物”）

我会这样做： `animal lion;` 或者如果我有一个构造函数（带参数），那么只有我会这样做`animal tiger(4,5);`

我面临的问题是：

```
class animal:
    val = 5 
```

它只是一个基本类，没有任何构造函数或方法：

现在使用 python，我可以在不创建任何实例的情况下引用动物（我不能在 C++ 中这样做，对吧？）

```
animal.val = 7 
```

我面临的另一个问题是，我需要在创建实例时始终使用括号，否则它将引用类本身。

例如；

```
lion = animal
lion.val = 6
tiger = animal
print tiger.val 
```

它打印 6，当我想创建一个实例时，我必须使用括号，即使我没有指定任何构造函数（这在 C++ 中不是必需的），任何特殊原因或只是语言语法问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T17:35:38.130

Python 中的一切都是对象。*类是创建其他对象的对象。*

因此，当您引用 时`animal.val`，您是在引用*class*上的*class*属性。`val` *`animal`*

 *如果你想实际创建一个类型的对象`animal`，你会调用类并返回一个实例：

```
your_animal = animal() 
```

然后，您在该实例上设置的任何内容都只为该实例设置（而对类的更改在通过该类创建的所有对象之间共享）。

有关 Python 中的类的更多详细信息，请参见[此处](http://docs.python.org/tutorial/classes.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T17:36:22.623

> 现在使用 python，我可以在不创建任何实例的情况下引用动物（我不能在 C++ 中这样做，对吧？）

您已经声明了一个静态变量。如您所见，如果没有关键字，它可能会有些混乱。您所做的与`static`c++ 类中的相同

要创建实例变量，需要将其显式分配给实例。

```
class animal:     
  def __init__(self):
     self.val = 0

your_animal = animal()
your_animal.val = 3 
```

`animal.val`不再全球可用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T17:48:42.930

为了类比 C++（顺便说一句，用大写名称声明类是一种很好的做法，以区分类和成员，这是通过小写的约定）：

```
class Animal:
  val = 4 # class variable

  def __init__ (self, val = 0): # constructor (takes 0 or 1 argument)
    self.member_val = val # instance variable 
```

您调用`animal = Animal(5)`创建新实例。观看如何`Animal.val`和`animal.val`不同：

```
animal = Animal(5)
print Animal.val, animal.member_val
>>> 4 5 
```

C++ 中的等效代码是：

```
class Animal {
  public:
    Animal() { // constructor with no arguments
       this.member_val = 0;
    }

    Animal(int val) { // constructor with argument
      this.member_val = val;
    }

  public:
    int member_val; // member (instance) variable allocated for each instance
    static int val = 4; // class level static variable
} 
```

和类用法：

```
Animal animal = new Animal(5);
cout << Animal.val << " " << animal.member_val

>>> 5 4 
```*

# performance - 使用 Dapper 的批量插入花费的时间比预期的要长

> ID：10689779
> 
> 赞同：74
> 
> 时间：2012-05-21T17:30:05.037
> 
> 标签：performance, sqlbulkcopy, dapper

读完[这篇文章](https://www.gamasutra.com/view/news/170502/Indepth_SQL_Server__High_performance_inserts.php)后，我决定仔细看看我使用 Dapper 的方式。

我在一个空数据库上运行了这段代码

```
var members = new List<Member>();
for (int i = 0; i < 50000; i++)
{
    members.Add(new Member()
    {
        Username = i.toString(),
        IsActive = true
    });
}

using (var scope = new TransactionScope())
{
    connection.Execute(@"
insert Member(Username, IsActive)
values(@Username, @IsActive)", members);

    scope.Complete();
} 
```

大约花了20秒。那是 2500 次插入/秒。不错，但考虑到博客达到 45k 插入/秒，也不是很好。在 Dapper 中有没有更有效的方法来做到这一点？

另外，作为旁注，通过 Visual Studio 调试器运行此代码需要**3 多分钟！**我认为调试器会减慢它的速度，但看到这么多我真的很惊讶。

**更新**

所以这

```
using (var scope = new TransactionScope())
{
    connection.Execute(@"
insert Member(Username, IsActive)
values(@Username, @IsActive)", members);

    scope.Complete();
} 
```

还有这个

```
 connection.Execute(@"
insert Member(Username, IsActive)
values(@Username, @IsActive)", members); 
```

两者都花了 20 秒。

但这花了4秒！

```
SqlTransaction trans = connection.BeginTransaction();

connection.Execute(@"
insert Member(Username, IsActive)
values(@Username, @IsActive)", members, transaction: trans);

trans.Commit(); 
```

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-09-26T19:56:45.890

我能达到的最好成绩是使用这种方法在 4 秒内记录 50k 条记录

```
SqlTransaction trans = connection.BeginTransaction();

connection.Execute(@"
insert Member(Username, IsActive)
values(@Username, @IsActive)", members, transaction: trans);

trans.Commit(); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-01-31T15:16:26.667

我最近偶然发现了这一点，并注意到 TransactionScope 是在打开连接后创建的（我假设这是因为 Dappers Execute 不会打开连接，这与 Query 不同）。根据此处的答案 Q4：[https](https://stackoverflow.com/a/2886326/455904) ://stackoverflow.com/a/2886326/455904这不会导致 TransactionScope 处理连接。我的同事做了一些快速测试，在 TransactionScope 之外打开连接大大降低了性能。

因此更改为以下内容应该有效：

```
// Assuming the connection isn't already open
using (var scope = new TransactionScope())
{
    connection.Open();
    connection.Execute(@"
insert Member(Username, IsActive)
values(@Username, @IsActive)", members);

    scope.Complete();
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-08-10T12:38:03.497

我创建了一个扩展方法，可以让您非常快速地进行批量插入。

```
public static class DapperExtensions
{
    public static async Task BulkInsert<T>(
        this IDbConnection connection,
        string tableName,
        IReadOnlyCollection<T> items,
        Dictionary<string, Func<T, object>> dataFunc)
    {
        const int MaxBatchSize = 1000;
        const int MaxParameterSize = 2000;

        var batchSize = Math.Min((int)Math.Ceiling((double)MaxParameterSize / dataFunc.Keys.Count), MaxBatchSize);
        var numberOfBatches = (int)Math.Ceiling((double)items.Count / batchSize);
        var columnNames = dataFunc.Keys;
        var insertSql = $"INSERT INTO {tableName} ({string.Join(", ", columnNames.Select(e => $"[{e}]"))}) VALUES ";
        var sqlToExecute = new List<Tuple<string, DynamicParameters>>();

        for (var i = 0; i < numberOfBatches; i++)
        {
            var dataToInsert = items.Skip(i * batchSize)
                .Take(batchSize);
            var valueSql = GetQueries(dataToInsert, dataFunc);

            sqlToExecute.Add(Tuple.Create($"{insertSql}{string.Join(", ", valueSql.Item1)}", valueSql.Item2));
        }

        foreach (var sql in sqlToExecute)
        {
            await connection.ExecuteAsync(sql.Item1, sql.Item2, commandTimeout: int.MaxValue);
        }
    }

    private static Tuple<IEnumerable<string>, DynamicParameters> GetQueries<T>(
        IEnumerable<T> dataToInsert,
        Dictionary<string, Func<T, object>> dataFunc)
    {
        var parameters = new DynamicParameters();

        return Tuple.Create(
            dataToInsert.Select(e => $"({string.Join(", ", GenerateQueryAndParameters(e, parameters, dataFunc))})"),
            parameters);
    }

    private static IEnumerable<string> GenerateQueryAndParameters<T>(
        T entity,
        DynamicParameters parameters,
        Dictionary<string, Func<T, object>> dataFunc)
    {
        var paramTemplateFunc = new Func<Guid, string>(guid => $"@p{guid.ToString().Replace("-", "")}");
        var paramList = new List<string>();

        foreach (var key in dataFunc)
        {
            var paramName = paramTemplateFunc(Guid.NewGuid());
            parameters.Add(paramName, key.Value(entity));
            paramList.Add(paramName);
        }

        return paramList;
    }
} 
```

然后要使用此扩展方法，您将编写如下代码：

```
await dbConnection.BulkInsert(
    "MySchemaName.MyTableName",
    myCollectionOfItems,
    new Dictionary<string, Func<MyObjectToInsert, object>>
        {
            { "ColumnOne", u => u.ColumnOne },
            { "ColumnTwo", u => u.ColumnTwo },
            ...
        }); 
```

这是相当原始的，还有进一步改进的空间，例如传入事务或 commandTimeout 值，但它对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-09T08:16:19.383

我发现所有这些例子都不完整。

这是一些使用后正确关闭连接的代码，并且也正确使用事务范围来增强执行性能，基于此线程中更新和更好的答案。

```
using (var scope = new TransactionScope()) 
{
    Connection.Open();
    Connection.Execute(sqlQuery, parameters);

    scope.Complete();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-26T12:10:01.317

仅使用`Execute`一个插入语句的方法将永远不会进行批量插入或高效。即使是接受的答案 a`Transaction`也不做 a `Bulk Insert`。

如果要执行`Bulk Insert`，请使用`SqlBulkCopy` [https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy](https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy)

你不会找到比这更快的东西。

## 小巧玲珑

**免责声明**：我是[Dapper Plus项目的所有者](http://dapper-plus.net/)

该项目不是免费的，但提供所有批量操作：

*   批量插入
*   批量更新
*   批量删除
*   批量合并

（在引擎盖下使用`SqlBulkCopy`）

还有更多选项，例如输出标识值：

```
// CONFIGURE & MAP entity
DapperPlusManager.Entity<Order>()
                 .Table("Orders")
                 .Identity(x => x.ID);

// CHAIN & SAVE entity
connection.BulkInsert(orders)
          .AlsoInsert(order => order.Items);
          .Include(x => x.ThenMerge(order => order.Invoice)
                         .AlsoMerge(invoice => invoice.Items))
          .AlsoMerge(x => x.ShippingAddress); 
```

我们的库支持多个提供者：

*   SQL 服务器
*   SQL 紧凑型
*   甲骨文
*   mysql
*   PostgreSQL
*   SQLite
*   火鸟

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2014-10-01T13:03:09.673

对我来说最快的变种：

```
 var dynamicParameters = new DynamicParameters();
            var selects = new List<string>();
            for (var i = 0; i < members.Length; i++)
            {
                var member = members[i];
                var pUsername = $"u{i}";
                var pIsActive = $"a{i}";
                dynamicParameters.Add(pUsername, member.Username);
                dynamicParameters.Add(pIsActive, member.IsActive);
                selects.Add("select @{pUsername},@{pIsActive}");
            }
            con.Execute($"insert into Member(Username, IsActive){string.Join(" union all ", selects)}", dynamicParameters); 
```

生成如下的sql：

```
INSERT TABLENAME (Column1,Column2,...)
 SELECT @u0,@a0...
 UNION ALL
 SELECT @u1,@a1...
 UNION ALL
 SELECT @u2,@a2... 
```

此查询工作得更快，因为 sql 添加一组行而不是一次添加 1 行。瓶颈不是写入数据，而是在日志中写入您正在执行的操作。

此外，查看最少记录事务的规则。

# ios5 - 地理编码成功后是否保证在地标中获得名称？

> ID：10689780
> 
> 赞同：1
> 
> 时间：2012-05-21T17:30:13.717
> 
> 标签：ios5, geocoding, clgeocoder

因此，如果我输入了企业地址（所以它是正向地理编码），我肯定会在地标中获得企业名称吗？

当我尝试一些地址（例如苹果总部）时，我得到了地标中的名称。但是，似乎我并不总是得到这个名字。

或者，我可以通过名称找到营业地点吗？

对不起，如果这个问题的答案是众所周知的。我不知道如何在谷歌中输入这个。

# c++ - 重载 ++ 运算符以将 1 加到存储在数组中的值？

> ID：10689783
> 
> 赞同：0
> 
> 时间：2012-05-21T17:30:29.070
> 
> 标签：c++

好吧，标题几乎说明了这一点。我已经发布了我的代码的一部分，我不知道如何将 1 添加到三角形的边（a、b 和 c）......任何帮助将不胜感激！

```
class Triangle
{
public:
    Triangle();
    Triangle(double a, double b, double c);
    ~Triangle();
    double get_side_a() const;
    double get_side_b() const;
    double get_side_c() const;
    Triangle& operator++();
    void operator++(int dummy);
private:
    double* sides;
};

Triangle::Triangle()
{
    sides = new double[3];
    sides[0] = 0;
    sides[1] = 0;
    sides[2] = 0;
} // Constructor

Triangle::Triangle(double a, double b, double c)
{
    sides = new double[3];
    sides[0] = a;
    sides[1] = b;
    sides[2] = c;
} // Constructor with parameters

Triangle::~Triangle()
{
    if(sides)
    {
        delete[] sides;
        sides = 0;
    }
} // Destructor

double Triangle::get_side_a() const
{
    return sides[0];
} // get_side_a

double Triangle::get_side_b() const
{
    return sides[1];
} // get_side_b

double Triangle::get_side_c() const
{
    return sides[2];
} // get_side_c

Triangle& Triangle::operator++()
{
    *this = *this + 1;
    return *this;
} // Oprator ++ (prefix)

void Triangle::operator++(int dummy)
{
    ++(*this);
} // Operator ++ (postfix)

int main()
{
    Triangle tri1, tri2;

    cout << "Enter side legths for triangle 1:" << endl;
    cin >> tri1;
    cout << endl << "Enter side legths for triangle 2:" << endl;
    cin >> tri2;

    cout << endl;
    cout << tri1 << endl;
    cout << tri2 << endl;

    return 0;
} 
```

我收到一个错误：在 Triangle& Triangle::operator++()...

编辑：众所周知，C++ 会烧脑，但必须亲身体验其他东西。每个人的 10 倍。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T17:33:46.783

您将需要重载或更改逻辑`operator+`以直接在对象的两侧工作`Triangle``int``operator++``*this`

在任何一种情况下，逻辑都是这样的（对于`++`）：

```
sides[0]++;
sides[1]++;
sides[2]++; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:18:49.283

其他人已经给出了很好的答案，展示了如何修复它并指出代码中的其他问题，这是关于错误消息的更一般的答案。

错误消息指向这一行：

```
*this = *this + 1; 
```

它告诉您没有`operator+`定义允许该添加操作。

正如评论者所说，您需要实际阅读错误消息并考虑它所说的内容。

编译器是正确的，你没有定义那个操作符，所以那行当然不会编译。你期待吗？您是否还期望能够将您的类型乘以 10？还是除以2？这些操作对您的类型意味着什么？编译器如何知道该做什么？

如果编译器告诉您没有允许该表达式的运算符，则意味着您没有编写与参数类型匹配的运算符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T18:15:31.997

您的代码存在一些问题：

*   您的后缀增量不会返回旧值。代码应该遵守给定操作员的预期行为。
*   您需要实现复制以正确实现后缀增量语义。
*   您没有三角形流插入/提取运算符，这就是您的代码无法编译的原因。

尝试这样的事情：

```
#include <iostream>
#include <vector>

class Triangle
{
public:
    Triangle() : sides(3) {}
    Triangle(double a, double b, double c) : sides({a, b, c }) {}
    Triangle(Triangle const & other) : sides(other.sides) {}
    ~Triangle() {}
    void operator=(Triangle other) { sides.swap(other.sides); }
    double get_side_a() const { return sides[0]; }
    double get_side_b() const { return sides[1]; }
    double get_side_c() const { return sides[2]; }

    Triangle & operator++()
    {
        for (auto & side : sides)
            ++side;

        return *this;
    }

    Triangle operator++(int)
    {
        Triangle tmp(*this);
        ++(*this);
        return tmp;
    }

private:
    std::vector<double> sides;
};

std::ostream & operator<< (std::ostream & o, Triangle const & t)
{
    o << '('
      << t.get_side_a() << ", "
      << t.get_side_b() << ", "
      << t.get_side_c() << ')';

    return o;
}

int main()
{
    using namespace std;

    Triangle t(1, 2, 3);
    cout << t << endl;

    Triangle t1 = t++;  // (1, 2, 3) - old value returned
    cout << t1 << endl;

    Triangle t2 = ++t;  // (2, 3, 4) + (1, 1, 1) = (3, 4, 5)
    cout << t2 << endl;
} 
```

使用 g++ 编译和运行：

```
$ g++ -std=c++0x foo.cpp
$ ./a.out
(1, 2, 3)
(1, 2, 3)
(3, 4, 5) 
```

！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-21T18:00:26.317

您不需要带有参数的重载函数。编译器会将该代码视为 Triangle 对象 ++ Triangle 对象。在您的不带参数的情况下，添加上面的代码以更改每一侧。完成后，编译器将在左侧看到带有三角形对象的 ++ 运算符来执行您的代码。希望这可以帮助。

# javascript - 替换/删除两个字符之间的所有内容

> ID：10689784
> 
> 赞同：45
> 
> 时间：2012-05-21T17:30:32.097
> 
> 标签：javascript, regex

```
var alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"; 
```

我怎样才能删除和之间的所有内容`H`，`S`以便结果是`ABCDEFGHSTUVWXYZ`？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-05-21T17:33:23.310

```
var alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
console.log(  alphabet.replace(/H.*S/, 'HS')  )
```

要不就：

```
var alphabet = "ABCDEFGHSTUVWXYZ"; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-21T17:32:56.753

```
var strippedAlphabet = alphabet.replace(/H.*S/, 'HS'); 
```

# ruby-on-rails-3 - Rails 的acts_as_commentable_with_threading 和嵌套路由

> ID：10689791
> 
> 赞同：2
> 
> 时间：2012-05-21T17:30:59.090
> 
> 标签：ruby-on-rails-3, routes, nested-routes, acts-as-commentable

我有以下路线：

```
resources :organisations do
  resources :comments, only: [:create, :destroy]
  resources :events do
    resources :comments, only [:create, :destroy]
  end
end 
```

正如 AACWT 示例的文档所建议的那样，我尝试使用以下代码为事件添加注释`view/comments/_comments.html.erb`：

```
<%= form_for [commentable, Comment.new], :remote => false do |f|%> 
```

其中，由以下人员呈现`views/events/show.html.erb`：

```
<%= render :partial => "comments/comment", :locals => { :commentable => @event } %> 
```

在`@event`相应的控制器操作中分配的位置。

中的`create`方法`comments_controller.rb`：

```
def create
  @commentable = Event.find(params[:commentable][:commentable_id])
  @user_who_commented = current_user
  @comment = Comment.build_from(@commentable, @user_who_commented.id, "Comment!" )
end 
```

尽管此时这可能不正确，因为我已经尝试了许多不同的方法来使其正常工作，并且需要回到我的代码产生问题的地方。问题是它试图加载可评论的路径，在这种情况下是事件，所以它正在尝试的是`event_path`它应该是什么时候`organisation_event_path`。我如何将它传递给方法？

我的想法可能是由 proc`proc.new |organisation, event|`或类似的东西引起的，但这就是我卡住的地方。我仍在学习 Rails 以及 ActiveRecord 中的关联是如何工作的。任何指针都将不胜感激，因为它将使我不必对结构进行大量更改并将事件作为自己的资源而不是嵌套，这会产生各种其他问题。

也就是说，理想情况下，我追求实现这一目标的最佳实践方式，所以如果确实需要改变方案，那么我想我必须这样做！

# database - 为什么数据库表称为表？

> ID：10689792
> 
> 赞同：5
> 
> 时间：2012-05-21T17:31:02.813
> 
> 标签：database

我已经思考过这个问题，我找到的最合理的比喻是：

> 桌子是放置物品的表面

这似乎有点宽泛，但也许这就是概念命名的全部思想。我还搜索了谷歌和维基百科，并没有找到该术语开始的记录。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T17:36:52.390

[表](http://en.wikipedia.org/wiki/Table_(information))是一个具有多个含义的词。在这种情况下，表格是一种图表，信息按行排列。

维基百科说：

“与家具的历史关系

在中世纪的计数室里，桌子上盖着一块方格布，用来数钱。国库是英国机构的一个古老术语，用于计算欠君主的钱。因此，成堆硬币的棋盘格表是该信息的具体实现。”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T17:51:37.763

这是[来自在线词源的引述](http://www.etymonline.com/index.php?term=table)：“意思是“为了方便而排列数字或其他数字”是从 14c 后期开始记录的。（例如目录，15c 中期）。

这不是很有帮助，但是……人们倾向于命名事物和现象。为什么？所以我们可以区分一件事和另一件事。（这只是一个快速的概括。）

表格（和电子表格）是很好的图形术语，可以暗示一系列项目/东西。图形表示与家具的关系（桌子：“你可以看到桌子上的主题”）。或者在电子表格的情况下：大量数字和文本散布在纸上。

这些只是非英语母语人士的一些观点。对原始为什么问题的廉价答案是：因为有人将其命名为表格并且其他人同意。恕我直言，这是一个很好的术语...

# css - iPad 上的 iFrame 未在框架下方显示内容

> ID：10689795
> 
> 赞同：1
> 
> 时间：2012-05-21T17:31:07.267
> 
> 标签：css, ios, ipad, iframe

我在其他地方看到了这个问题，我尝试在这里实现这个解决方案：[https ://stackoverflow.com/a/8923541](https://stackoverflow.com/a/8923541)

但是，问题是整个主体随后是可滚动的，因为主体的高度已设置为 iframe 的整体高度。我根本不希望主页滚动（我们为页眉和页脚设置了高度，还有一个 iframe 可以缩放以适应页面的其余高度）。将正文设置为溢出：隐藏会关闭 iframe 中的滚动。

这是我一直在使用的一个简单的测试版本：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<head>
<title>Iframe Test</title>
<script src="js/jquery.js"></script>
<script>
$(function() {
var iframe = $("#frame");    
iframe.load(function() {
$("body").height(iframe.height());
});
});
</script>

<style>

body { overflow: hidden;}

#frame {
height: 100%;
width: 100%;
}

#maincontent {
height: 300px;
-webkit-overflow-scrolling: touch;
overflow: scroll;
}

</style>

</head>
<body>

<div id="maincontent">
<iframe src="working2.php" id="frame" name="frame" frameborder='0' scrolling="no">
<p>Your browser does not support iframes.</p>
</iframe>
</div>

</body>
</html> 
```

有没有人得到一个带有单点触摸滚动的 iframe 的实际工作示例？在花了几个小时阅读大量关于它的帖子后，我无法让它工作。我显然做错了什么，但无法弄清楚。

# java - map-reduce 代码的输出是什么？

> ID：10689797
> 
> 赞同：0
> 
> 时间：2012-05-21T17:31:09.723
> 
> 标签：java, hadoop, mapreduce

```
public static class MapClass extends MapReduceBase implements
        Mapper<LongWritable, Text, Text, IntWritable> {

    private Text word = new Text();

    public void map(LongWritable key, Text value, 
                    OutputCollector<Text, IntWritable> output, 
                    Reporter reporter) throws IOException {
      String line = value.toString();
      String num = Integer.parseInt(line);

       IntWritable one = new IntWritable(num);

        word.set(“key”);
        output.collect(word, one);

    }
}

public static class Reduce extends MapReduceBase implements
        Reducer<Text, IntWritable, Text, IntWritable> {

    public void reduce(Text key, Iterator<IntWritable> values,
            OutputCollector<Text, IntWritable> output, Reporter reporter)
            throws IOException {
        int sum = 0;
        int count = 0;
        int avg = 0;
        while (values.hasNext()) {
            sum += values.next().get();
            count++;
        }
        avg = sum / count;
        output.collect(key, new IntWritable(count));
    }
} 
```

***具体请参见 output.collect()，我正在打印键和计数值。*** *对于任何输入文件，输出是* **键 2** 请帮助我....（即使输入为 100 个，输出如何始终为 2？？ )

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:03:06.987

如果你想测试你的代码，

这是一个使用 mockito 框架的 JUNIT 测试，假设你在示例类中有你的 reducer 和 mapper。

```
@RunWith(MockitoJUnitRunner.class)
 public class TestMapper {

 @Mock
 OutputCollector<Text, IntWritable> output;

 @Mock
 Reporter reporter;

 @Test
 public void testMap() throws Exception {
    ExampleClass.MapClass mapper = new ExampleClass.MapClass();
    mapper.map(new LongWritable(0), new Text("1"), output, reporter);
    mapper.map(new LongWritable(0), new Text("2"), output, reporter);
    mapper.map(new LongWritable(0), new Text("3"), output, reporter);
    verify(output, times(1)).collect(new Text("key"), new IntWritable(1));
    verify(output, times(1)).collect(new Text("key"), new IntWritable(2));
    verify(output, times(1)).collect(new Text("key"), new IntWritable(3));
 }

 @Test
 public void testReduce() throws Exception {
    ExampleClass.Reduce reducer = new ExampleClass.Reduce();
    List<IntWritable> list = Arrays.asList(new IntWritable(1), new IntWritable(2), new IntWritable(3));

    reducer.reduce(new Text("key"), list.iterator(), output, reporter);

    verify(output, times(1)).collect(new Text("key"), new IntWritable(3));
 }
} 
```

# objective-c - 使用核心图创建分布构建？

> ID：10689804
> 
> 赞同：1
> 
> 时间：2012-05-21T17:31:28.340
> 
> 标签：objective-c, ios, xcode, distribution

我需要为我的应用程序进行分发构建。

我在我的项目中使用 Core Plot。我有我的主要项目，并在里面添加了 Core Plot 项目。我的应用程序运行良好，我准备发布它。我想存档并提交到应用商店。但问题来了。这是我的应用程序的 1.1 版（不确定这是否重要）。当我存档它时，我无法验证或提交它。它说：

```
“MyApp” does not contain a single–bundle application or contains multiple products. Please select another archive, or adjust your scheme to create a single–bundle application. 
```

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:34:55.133

我遇到了同样的问题，发现了这个： [http](http://astralbodies.net/blog/2011/03/27/xcode-4-problem-submitting-app-with-static-library/) ://astralbodies.net/blog/2011/03/27/xcode-4-problem-submitting-app-with-static-library/ 然后它就像魔术一样工作！（我试着只做部分，没有用，你必须做所有:)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T18:34:35.140

Edit your scheme, select the *Build* section, and check you only have one target ticked for *Archive*.

# mysql - 选择最频繁的

> ID：10689805
> 
> 赞同：0
> 
> 时间：2012-05-21T17:31:29.897
> 
> 标签：mysql, sql, sql-server

如果有可能使用 sql 找出出现在表中的最频繁的数字对，我会发现它。即：我有几列填充了数字：

```
num1, num2, num3, num4, num5, num6
2      3      4     5     6    7 
```

当然行数更大，但你有一个想法。目标是显示例如 10 对出现在行中的数字。

如果可能，请告诉我，或者我宁愿执行“蛮力”解决方案。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:36:50.393

尝试这个。

```
SELECT TOP 10 num1, num2, num3, num4, num5, num6
FROM MyTable
GROUP BY num1, num2, num3, num4, num5, num6
ORDER BY COUNT(*) DESC 
```

将 GROUP BY 与您想要在元组中的所有不同列一起使用。然后 ORDER BY COUNT 函数。这将获得所有不同数字集的列表。要限制结果的数量，请在 SELECT 语句中包含[TOP 10。](http://msdn.microsoft.com/en-us/library/ms189463.aspx)

注意：原始帖子同时具有 MySql 和 sql-server 标签。此解决方案适用于 SQL Server。在 MySql 中不存在 TOP 功能，您需要使用具有类似功能的[LIMIT 。](http://php.about.com/od/mysqlcommands/g/Limit_sql.htm)如果您需要有关如何使用它的更多信息，请参阅[LIMIT 文档。](http://php.about.com/od/mysqlcommands/g/Limit_sql.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:53:39.817

为了解决这个问题，您需要执行以下操作：

1.  取消透视列
2.  执行自连接以获得对
3.  总结以获得最常见的配对。

让我给出一个可以在 SQL Server 中工作的解决方案，并且在 mysql 中进行非常小的修改：

```
with allnums as (
        select id, 1 as col, num1 as num from t union all
        select id, 2 as col, num2 as num from t union all
        select id, 3 as col, num3 as num from t union all
        select id, 4 as col, num4 as num from t union all
        ...
    )
select top x an1.num, an2.num, count(*)
from allnums an1 join
     allnums an2
     on an1.id = an2.id and
        an1.col < an2.col
order by count(*) desc 
```

我不认为mysql支持“with”语法，所以你需要重复两次子查询，将结果放在临时表中，或者创建一个视图。

您还可以使用特定于数据库的构造来表达相同的想法，例如 SQL Server 中的“unpivot”。这可以在一定程度上简化 SQL，但不会简化很多。

如果每一行没有唯一的 id，那么在 SQL Server 中做的一件简单的事情就是在另一个“with”语句中使用 row_number() 函数来分配一个。或者，您可以将所有数字转换为字符串，然后将它们连接在一起。

# listview - 安卓; 将 SimpleAdapter 与 setOnItemClick 一起使用包含复选框的 Listview

> ID：10689807
> 
> 赞同：3
> 
> 时间：2012-05-21T17:31:30.833
> 
> 标签：listview, checkbox, onitemclicklistener, simpleadapter

我在一个由 SimpleAdapter 填充的 Activity（不是 ListActivity）中有一个 ListView。

```
public void updateGroupsInfoPane(){
    final ListView m_listview3 = (ListView) findViewById(R.id.memberOfList);
    mapMemberOfList.clear();
    for (String group : arrayAccountMemberOfList) {
        Map<String, Object> datum = new HashMap<String, Object>(2);
        String[] tempString = group.split(",");
        datum.put("groupname", tempString[0]);
        datum.put("groupdesc", tempString[1]);
        mapMemberOfList.add(datum);
    }
    SimpleAdapter adapter = new SimpleAdapter(this, mapMemberOfList, R.layout.membersof_list, new String[] {"groupname", "groupdesc"}, new int[] {android.R.id.text1, android.R.id.text2});
    m_listview3.setAdapter(adapter);

    m_listview3.setChoiceMode(GridView.CHOICE_MODE_MULTIPLE);
    m_listview3.setTextFilterEnabled(true);

    m_listview3.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {

            CheckBox box = (CheckBox) view.findViewById(R.id.checkbox);
            TextView text1 = (TextView) view.findViewById(android.R.id.text1);
            String tempString = text1.getText().toString();

            if (box.isChecked()){
                box.setChecked(false);
                listCurrentMembership.remove(tempString);
            }else{
                box.setChecked(true);
                listCurrentMembership.add(tempString);
            };
        }
    });
} 
```

这工作正常。问题是当我滚动此列表时，复选框一旦离开屏幕就不会重新检查正确的复选框，然后检查下一个滚动上的项目。当我将数据加载到不同的数组中时，数据是正确的。只是复选框图形是错误的。如果我不滚动，检查和取消检查会添加和删除正确的数据。

围绕这个搜索是因为回收ListView，我需要实现一个getView。

我一直在寻找一些关于如何使用 SimpleAdapter 的示例，因为一些帖子说 SimpleAdapter 已经完成了 getView，而其他示例则使用了 ListActivity。那么我如何检查框只是通过点击 ListView 项目，而不是复选框本身可能与它有关？但是我找不到一个与我正在做的事情相似的例子，以便我可以玩弄并解决这个问题。

我的 ListView 'membersof_list' 中的项目的 XML 是：

```
<RelativeLayout
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/vw1"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="horizontal">

<CheckBox android:id="@+id/checkbox"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignParentRight="true"
android:layout_gravity="right"
android:focusable="false"
android:clickable="false"
android:checked="false" />

<LinearLayout
    android:id="@+id/ll1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    >

    <TextView android:id="@android:id/text1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="?android:attr/listPreferredItemPaddingLeft"
        android:layout_marginTop="8dip"
        android:ellipsize="end"
        android:textSize="8sp"
        android:textStyle="bold"
        android:singleLine="true"
    />
</LinearLayout>
<LinearLayout
    android:id="@+id/ll2"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:layout_below="@+id/ll1"
    >

    <TextView android:id="@android:id/text2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="?android:attr/listPreferredItemPaddingLeft"
        android:ellipsize="end"
        android:textSize="6sp"
        android:singleLine="true"
    />
</LinearLayout> 
```

我只有一个数据数组，我清空了与 ListView 关联的数组，因为我确实需要在加载新的/不同的数据之前清除它，我在逗号处拆分数据以将其加载到 groupname 和 groupdesc 中。默认情况下，复选框都未选中，这就是它应该的样子。

我是 Android 编程的新手，我知道它不是最干净或最有效的代码，但一旦它开始工作，我计划重新审视它并让它变得更好。

任何建议、链接、示例都是有价值的。谢谢。

# c++ - 使用 Qt creator 编译 PythonQt

> ID：10689811
> 
> 赞同：2
> 
> 时间：2012-05-21T17:31:43.487
> 
> 标签：c++, python, qt, python-3.x, python-3.2

我正在尝试使用 Qt creator 编译[PythonQt](http://pythonqt.sourceforge.net/)，但它返回 163 错误。

> C:\Users\Kato\Desktop\Qt projects\PythonQt-build-desktop-Qt_4_7_4_for_Desktop_-_MinGW_4_4__Qt_SDK__Debug\src....\PythonQt2.0.1\src\PythonQtStdDecorators.h:46: error: Python.h: No such file or目录

和其他目录。

我安装了 python 3.2，并将 prf 文件更改为：

```
# profile to include and link Python

# Change this variable to your python version (2.5, 2.6)
win32:PYTHON_VERSION=32
unix:PYTHON_VERSION=2.6

macx {
# for macx you need to have the Python development kit installed as framework
INCLUDEPATH += /System/Library/Frameworks/Python.framework/Headers
LIBS += -F/System/Library/Frameworks -framework Python
} else:win32 {
# for windows install a Python development kit or build Python yourself from the sources
# Make sure that you set the environment variable PYTHON_PATH to point to your
# python installation (or the python sources/header files when building from source).
# Make sure that you set the environment variable PYTHON_LIB to point to
# the directory where the python libs are located.
#
# When using the prebuild Python installer, this will be:
# set PYTHON_PATH = c:\Python26
# set PYTHON_LIB  = c:\Python26\libs
PYTHON_PATH= C:\Python32
PYTHON_LIB= C:\Python32\libs
#
# When using the python sources, this will be something like:
# set PYTHON_PATH = c:\yourDir\Python-2.6.1\
# set PYTHON_LIB  = c:\yourDir\Python-2.6.1\PCbuild8\Win32

# check if debug or release
CONFIG(debug, debug|release) {
  DEBUG_EXT = _d 
} else {
  DEBUG_EXT = 
}

win32:INCLUDEPATH += $(PYTHON_PATH)/PC $(PYTHON_PATH)/include
win32:LIBS += $(PYTHON_LIB)/python$${PYTHON_VERSION}$${DEBUG_EXT}.lib

} else:unix {
# on linux, python-config is used to autodetect Python.
# make sure that you have installed a matching python-dev package.

unix:LIBS += $$system(python$${PYTHON_VERSION}-config --libs)
unix:QMAKE_CXXFLAGS += $$system(python$${PYTHON_VERSION}-config --includes)
} 
```

根据这个[构建链接](http://pythonqt.sourceforge.net/Building.html)我是对的，但同样的错误！我不知道是什么问题提前谢谢你=）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:43:45.257

[关于构建它](http://pythonqt.sourceforge.net/Building.html)的页面说它尚未使用 Python3 进行测试，可能需要进行一些更改。这几乎肯定是你看到的问题。

要确定答案，请使用 Python 2.6 或 2.7 重试。如果构建工作，那么 163 错误可能是由于 Python2/Python3 兼容性更改。

如果您必须使用 Python3，那么您唯一的选择就是修复错误。否则，只使用 Python 2.7 可能更容易。

如果您决定修复 Python3 构建问题，最好提交补丁 :-)

# asp.net-mvc - ASP MVC3，电子邮件通知服务

> ID：10689812
> 
> 赞同：1
> 
> 时间：2012-05-21T17:31:43.517
> 
> 标签：asp.net-mvc, email-notifications

我有网络应用程序（asp.net mvc3，.net 4），我正在尝试实现电子邮件通知服务。

基本上，有一个带有日期时间/内容的表格和一个要向其发送电子邮件的用户，当我们到达表格上的那个日期时间时，我想发送通知电子邮件。

我不确定这应该如何实现，是否应该有某种后台线程不断检查数据库？我觉得这样做效率很低。

你能建议一些方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:34:17.833

您将需要在某处系统上运行的服务或计划作业（我以前做过；我有共享主机，并编写了一个小应用程序，我计划在我的家用计算机上定期运行）。你可以让这个过程为你做通知，或者在你的控制器上点击一个动作，这将触发它们被发送出去。

似乎让服务查询您的数据库并发送通知是最直接的途径。但是，有几个原因可以说明您的 MVC 应用程序中的操作可能更合适，例如无法远程访问数据库或 SMTP 服务器。

您可以使用 Windows 任务计划程序或类似工具来安排作业以执行应用程序（例如控制台应用程序，或者可能是 CURL）。或者你可以使用[Quartz.net 之](http://quartznet.sourceforge.net/)类的东西来创建你自己的服务来执行作业。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:33:46.307

这不是正确的做法。您应该创建一个控制台应用程序并使用内置的调度程序任务定期运行它。

作为额外参考，请查看Ayende Rahien的[这篇文章](http://ayende.com/blog/155489/rotten-scheduling-donrsquo-t-roll-your-own)

# ios5 - NSMutableDictionary iVar 初始化失败

> ID：10689817
> 
> 赞同：0
> 
> 时间：2012-05-21T17:32:07.283
> 
> 标签：ios5, nsmutabledictionary

尝试从临时的本地 NSMutableDictionary (tmpDict) 填充 NSMutableDictionary (listContent)，但 listContent 的 init 似乎失败了，因此，来自 tmpDict 的内容无法被带入。我究竟做错了什么？

谢谢

**我的 .h 文件中的声明**

```
// .h
 NSMutableDictionary *listContent;
 ...
 @property (nonatomic, strong) NSMutableDictionary *listContent; 
```

**实施文件**

```
- (void)viewDidLoad
{
   NSMutableDictionary *tmpDict = [[NSMutableDictionary alloc] init];

   //-- populating tmpDict here ....

  //Bring to life, this dictionary
  self.listContent = [NSMutableDictionary new];

 //--- self.listContent is still not alive   
  if(!self.listContent)
     NSLog(@"listContent is not alive, yet");

//populate self.listContent with contents of tmpDict        
[self.listContent addEntriesFromDictionary:tmpDict];

//--- self.listContent is still not alive 
 if(!self.listContent)
     NSLog(@"listContent is not alive, yet");

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T11:14:46.673

从 LLDB 切换到 GBD 解决了这个问题。问题是我的字典在初始化并填充对象后被 LLBD 报告为 nil。一旦我切换到 GBD，一切都被正确初始化和补充。

# python - 保存由 Gnuplot-py 包发送到 gnuplot 程序的命令

> ID：10689818
> 
> 赞同：0
> 
> 时间：2012-05-21T17:32:10.897
> 
> 标签：python, gnuplot

我是 gnuplot 的新手。我正在使用 Unix。

我在终端上看到了命令/错误及其输出，但我也想将它们保存在文件中以用于存储目的。

gnuplot 中有一个保存命令，但它只保存模块给出的最后一个绘图或 splot 命令和最终设置。

假设我绘制了一条设置为“A”的线，在做了一些计算后，我去重新绘制了另一条设置为“B”的线

gnuplot.save() 命令只会保存最后一个命令和最新的设置。如何保存所有发出的命令？

请帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:52:54.580

我对 gnuplot-py 不是很熟悉——但如果它在执行命令时将命令写入终端，则可以使用 shell 重定向：

```
python myPythonScriptWithGnuplot.py > commandfile.gp  #redirect stdout
python myPythonScriptWithGnuplot.py 2> commandfile.gp  #redirect stderr 
```

当然，如果您从 python 向终端写入其他内容，这将无济于事......

但请注意，gnuplot-py 通过临时 FIFO 将数据发送到 gnuplot（我认为无论如何）。因此，如果您正在绘制数据（例如列表、numpy 数组等......不是类似的函数`"sin(x)"`），当您尝试绘制数据时，FIFO 将从您的系统中清除，并且您的 plot 命令将失败并抱怨它可以'找不到数据文件。

**编辑**

在（快速）查看源代码后，您似乎有几个选择。您的第一个选择：传递`debug=1`给构造函数（您可能已经这样做了）。这将导致将命令写入标准错误。使用少量（或大量）shell 魔法，您可以分离出不同的输出流。这是一个将命令中的 stderr 放入文件中的方法，同时仍将输出留在在 bash 中工作的终端上（我使用的是 bash 4.1.5——但我很确定这已经存在了一段时间）：

```
((command 3>&1 1>&2 2>&3 ) | tee command_stderr.log ) 3>&1 1>&2 2>&3
          #swap stderr/out  
                             #tee puts data in output file and to terminal
                                                      #swap stderr/stdout again. 
```

（如果有人知道的话，我很想看到一种更简洁的方式来交换这个输出流......）

或者，您可以将文件名传递给`Gnuplot`构造函数。这会将命令写入该文件。据我所知，没有任何方法可以让您将命令写入文件和 gnuplot 管道。但是，您始终可以启动多个`Gnuplot`实例并通过主实例将命令写入文件，然后每当您编写绘图命令时，告诉第二个实例到`load "filename"`. 当然，如果你使用这种方法，你可能应该指定数据应该是`inline`d。

第三种选择是放弃 gnuplot-py 转而使用 pyGnuplot，因为我仍在积极开发那个 - 如果某些东西不起作用，或者您想添加一个功能，您可以告诉我； )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:52:37.937

非 python 的答案是使用“脚本”命令。

# r - 让它成为一个函数

> ID：10689819
> 
> 赞同：0
> 
> 时间：2012-05-21T17:32:24.477
> 
> 标签：r, function

在 SO 的帮助下，我现在可以重命名数据框中的所有变量，除了选定的子集。我目前正在使用[这种方法](https://stackoverflow.com/questions/10662314/r-rename-subset-of-variables-in-data-frame/10669726#10669726)，请参阅打击（感谢[florel](https://stackoverflow.com/users/1201032/flodel)）。

我想编写一个函数，我可以在其中定义 1）我的数据，2）变量向量和 3）我想在函数中未选择的变量中添加什么前缀（请参阅下面的尝试）。我错误地认为这很容易，但我很难让该功能正常工作。

这是我编写函数的尝试，这显然不起作用。另外，如果有人推荐一个站点或一些文本，我可以阅读以更好地理解如何编写函数。

```
baRadd <- function(df, vector, suffix){names(df) <- 
                   ifelse(names(df) %in% vector,names(df), 
                   paste(suffix, names(df), sep = ".")) }

data(mtcars)
temp.mtcars <- mtcars
baRadd(temp.mtcars, c("mpg", "cyl", "disp"), "baR") 
```

初始函数形式 florel

```
data(mtcars)
# head(mtcars)

temp.mtcars <- mtcars
names(temp.mtcars) <- ifelse(names(mtcars) %in% c("mpg", "cyl", "disp"),
                         names(mtcars),
                         paste("baR", names(mtcars), sep = "."))
str(temp.mtcars)
'data.frame': 32 obs. of  11 variables:
 $ mpg     : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
 $ cyl     : num  6 6 4 6 8 6 8 4 4 6 ...
 $ disp    : num  160 160 108 258 360 ...
 $ baR.hp  : num  110 110 93 110 175 105 245 62 95 123 ...
 $ baR.drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
 $ baR.wt  : num  2.62 2.88 2.32 3.21 3.44 ...
 $ baR.qsec: num  16.5 17 18.6 19.4 17 ...
 $ baR.vs  : num  0 0 1 1 0 1 0 1 1 1 ...
 $ baR.am  : num  1 1 1 0 0 0 0 0 0 0 ...
 $ baR.gear: num  4 4 4 3 3 3 3 4 4 4 ...
 $ baR.carb: num  4 4 1 1 2 1 4 2 2 4 ... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T17:46:19.187

主要问题是您的函数不返回任何值。它只是修改 data.frame `df`，（这是评估环境的本地）然后退出。

要让它返回修改后的对象，请执行以下操作：

```
data(mtcars)
mtcars1 <- mtcars

baRadd <- function(df, vector, suffix){ 
                   names(df) <- ifelse(names(df) %in% vector,names(df), 
                                      paste(suffix, names(df), sep = ".")) 
                   return(df)}

mtcars1 <- baRadd(mtcars1, c("mpg", "cyl", "disp"), "baR") 
```

**更好**的解决方案（在我看来）是编写一个函数来创建一个修改后的名称向量，然后您可以将其分配给现有的 data.frame。

```
mtcars2 <- mtcars
baRadd2 <- function(df, vector, suffix){ 
                    newnames <- ifelse(names(df) %in% vector,names(df), 
                                       paste(suffix, names(df), sep = ".")) 
                    return(newnames)}

names(mtcars2) <- baRadd2(mtcars2, c("mpg", "cyl", "disp"), "baR") 
```

# vba - 防止 WebBrowser 控件以焦点刷新

> ID：10689821
> 
> 赞同：2
> 
> 时间：2012-05-21T17:32:30.163
> 
> 标签：vba, focus, webbrowser-control, ms-access-2007

我正在使用 Access 2007 数据库，并且在使用 ActiveX WebBrowser 控件时遇到了一些不需要的行为。该控件位于窗体上多选项卡控件的单个选项卡上。当表单加载时，我将要加载的页面的 URL 传递给它。

表单加载良好，网页也是如此。这是不受欢迎的行为开始的地方。如果我切换到表单上的不同选项卡，然后切换回来，webbrowser 控件会重新加载网页。我不想要这个。我正在显示一个实时地图（如谷歌地图），我想保留它留下的状态。

您可以通过将 webbrowser 控件添加到具有多个选项卡的表单上的选项卡来测试这一点。将 webbrowser 控件指向如下 URL：

[https://google-developers.appspot.com/maps/documentation/javascript/examples/map-simple](https://google-developers.appspot.com/maps/documentation/javascript/examples/map-simple)

当表单（和页面）加载时，移动地图，放大几个级别。切换标签并切换回来。地图将重新加载到其原始视图。我能阻止这种情况发生吗？？

这真的扼杀了我想要完成的事情。谢谢！

史蒂夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T23:21:57.350

亚历克斯-

我想出了一个解决方法。答案与您的建议一致，即从多页选项卡中删除 web 控件。我最终做的是创建一个只有 web 控件的空白表单。创建表单后，我将它作为子表单添加回我的选项卡，它*终于*正常运行了！我现在可以在表单上切换选项卡，并且网页不会重新加载。

哈利路亚！

# java - 从另一个类将 JFrame 添加到主 GUI 框架

> ID：10689825
> 
> 赞同：0
> 
> 时间：2012-05-21T17:32:46.743
> 
> 标签：java, swing, jframe

我有两节课。1.一个类包含Netbeans GUI builder生成的所有GUI代码（称之为GUI类） 2.另一个类包含一些包含方法的代码（SaveTraffic，它扩展了SwingWorker）。

在我的 SaveTraffic 中，我创建了一个框架，当我运行我的应用程序时，它会弹出并出现在我的 GUI 前面。我想将此框架添加到我想要放置它的特定位置的 GUI 中。这怎么可能？这是我的 SaveTraffic 代码

```
public class SaveTraffic extends SwingWorker<Void, String> {

    public static int k = 0;
    public GUI f = new GUI();
    public static Frame u = new Frame();
    public static JTextArea h = new JTextArea();
    JScrollPane scrollPane2 = new JScrollPane(h, JScrollPane.VERTICAL_SCROLLBAR_ALWAYS,
            JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS);

    @Override
    public Void doInBackground() throws IOException {
        u.setSize(950, 200);
        u.setLocation(0,550);
        u.add(scrollPane2);
        u.setVisible(true);
        while (f.num() != 2) {
            {
              publish("Hello World");
            }
        }
        return null;
    } //end main function

    @Override
    public void process(List<String> chunks) {
        for (final String text : chunks) {
            Runnable r = new Runnable() {

                @Override
                public void run() {
                    h.setLineWrap(true);
                    h.append(text + "\n");
                }
            };
            new Thread(r).start();
        }
    }

    @Override
    public void done() {
        System.out.println("I am DONE");

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T18:09:18.193

我在您的代码中看到了几个问题：

1.  您正在寻找[JDialog](http://docs.oracle.com/javase/7/docs/api/javax/swing/JDialog.html)而不是新框架。确保将正确的对话框所有者传递给 JDialog 的构造函数。您可以通过构造函数上的参数或调用来选择对话框是否是模态的`setModal()`。
2.  您正在 SwingWorker.publish 方法中启动新线程。那些线程修改 UI。尽管 JTextArea.append 是线程安全的，但我仍然不会使用多个线程来更新 JTextArea。这是不必要的，如果有一天你添加了一些不是线程安全的调用，你最终会陷入死锁。
3.  您正在向框架中添加组件，设置其大小并使其在未在 EDT 上运行的 SwingWorker.doInBackground() 中可见。而是在 EDT 内执行 SwingWorker 之前移动该调用。
4.  无需在 textarea 上不断将换行设置为 true。只需调用一次就足够了。
5.  我不确定“k”的用途，但我会提防静态变量。
6.  为什么你让你的 Frame 和你的 TextArea 是静态的？

（可选）我还会考虑在 SaveTraffic 中添加一个构造函数并在那里初始化大部分代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T18:12:48.423

*   不要在方法`Swing Gui`内部构建，被指定为已经存在的值`SwingWorker's``SwingWorker``add / modify / change``JComponent(s)`

*   在此方法中添加`process()`或添加值或定期附加文本`publish()``SwingWorker``JTextArea`

*   对于“监控”`SwingWorker's`状态添加[PropertyChangeListener](http://docs.oracle.com/javase/7/docs/api/java/beans/PropertyChangeListener.html)

*   [简单的例子](https://stackoverflow.com/a/6114890/714968)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T17:36:22.293

您创建了一个扩展 JPanel 的类。然后你在那里完成所有代码，并将它与你的方法类绑定。

# sql-server-2008 - sql server 的 Mule 3 JDBC 端点异常

> ID：10689827
> 
> 赞同：4
> 
> 时间：2012-05-21T17:32:52.470
> 
> 标签：sql-server-2008, jdbc, mule

我正在尝试使用 Mule JDBC 出站端点将字符串插入 SQL Server 数据库。查询是：

```
INSERT INTO ife VALUES (#[payload:java.lang.String], 0) 
```

当有效负载位于 select 语句的 where 子句中并且当我硬编码值代替有效负载表达式时，查询将起作用。但是，对于上面列出的插入语句，它会惨遭失败。我已经包含了下面的异常以及流 xml 配置。任何建议/帮助将不胜感激！

```
ERROR 2012-05-21 11:37:00,122 [[ife].IFE_InboundFlow1.stage1.02]     org.mule.exception.DefaultMessagingExceptionStrategy: 
********************************************************************************
Message               : Failed to route event via endpoint:     DefaultOutboundEndpoint{endpointUri=jdbc://insert, connector=JdbcConnector
{
  name=Database__JDBC_
  lifecycle=start
  this=11e5f
  numberOfConcurrentTransactedReceivers=4
  createMultipleTransactedReceivers=false
  connected=true
  supportedProtocols=[jdbc]
  serviceOverrides=<none>
}
,  name='endpoint.jdbc.insert', mep=ONE_WAY, properties={queryTimeout=-1,     queries=merged: {insert=INSERT INTO ife VALUES (#[payload:java.lang.String], 0)}},     transactionConfig=Transaction{factory=null, action=INDIFFERENT, timeout=0},     deleteUnacceptedMessages=false, initialState=started, responseTimeout=10000,     endpointEncoding=UTF-8, disableTransportTransformer=false}. Message payload is of type:     String
Code                  : MULE_ERROR-42999
--------------------------------------------------------------------------------
Exception stack is:
1\. com.microsoft.sqlserver.jdbc.SQLServerException: Incorrect syntax near '?'.(SQL     Code: 0, SQL State: + null) (com.microsoft.sqlserver.jdbc.SQLServerException)
  com.microsoft.sqlserver.jdbc.SQLServerException:190 (null)
2\. com.microsoft.sqlserver.jdbc.SQLServerException: Incorrect syntax near '?'. Query:     INSERT INTO ife VALUES (?, 0) Parameters: [30076](SQL Code: 0, SQL State: +     null) (java.sql.SQLException)
  org.apache.commons.dbutils.QueryRunner:540 (null)
3\. Failed to route event via endpoint:     DefaultOutboundEndpoint{endpointUri=jdbc://insert, connector=JdbcConnector
{
  name=Database__JDBC_
  lifecycle=start
  this=11e5f
  numberOfConcurrentTransactedReceivers=4
  createMultipleTransactedReceivers=false
  connected=true
  supportedProtocols=[jdbc]
  serviceOverrides=<none>
}
,  name='endpoint.jdbc.insert', mep=ONE_WAY, properties={queryTimeout=-1, queries=merged: {insert=INSERT INTO ife VALUES (#[payload:java.lang.String], 0)}}, transactionConfig=Transaction{factory=null, action=INDIFFERENT, timeout=0}, deleteUnacceptedMessages=false, initialState=started, responseTimeout=10000, endpointEncoding=UTF-8, disableTransportTransformer=false}. Message payload is of type: String (org.mule.api.transport.DispatchException)
  org.mule.transport.AbstractMessageDispatcher:107 (http://www.mulesoft.org/docs/site/current3/apidocs/org/mule/api/transport/DispatchException.html)
--------------------------------------------------------------------------------
Root Exception stack trace:
com.microsoft.sqlserver.jdbc.SQLServerException: com.microsoft.sqlserver.jdbc.SQLServerException: Incorrect syntax near '?'.
at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDriverError(SQLServerException.java:190)
at com.microsoft.sqlserver.jdbc.SQLServerParameterMetaData.<init>(SQLServerParameterMetaData.java:426)
at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.getParameterMetaData(SQLServerPreparedStatement.java:1532)
+ 3 more (set debug level logging or '-Dmule.verbose.exceptions=true' for everything) 
```

这是配置xml：

```
<spring:beans>
        <spring:bean id="Bean" name="Bean" class="org.enhydra.jdbc.standard.StandardDataSource" doc:name="Bean">
            <spring:property name="driverName" value="com.microsoft.sqlserver.jdbc.SQLServerDriver"/>
            <spring:property name="url" value="jdbc:sqlserver://localhost:1433;instanceName=SQLEXPRESS;databaseName=test;user=test;password=test;"/>
        </spring:bean>
    </spring:beans>
<jdbc:connector name="Database__JDBC_" dataSource-ref="Bean" validateConnections="true" queryTimeout="-1" pollingFrequency="0" doc:name="Database (JDBC)"/>
<flow name="test">
    <jdbc:outbound-endpoint exchange-pattern="one-way" queryKey="insert" responseTimeout="10000" mimeType="text/plain" queryTimeout="-1" connector-ref="Database__JDBC_" doc:name="Database (JDBC)">
                                <jdbc:query key="insert" value="INSERT INTO ife VALUES (#[payload:java.lang.String], 0)"/>
                            </jdbc:outbound-endpoint>
</flow> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T12:54:31.530

当我删除单引号时，它对我有用：

```
#[payload:java.lang.String] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T17:20:26.227

也许您需要将 #[payload:java.lang.String] 括在单引号中？您可以看到它试图发出查询：

```
INSERT INTO ife VALUES (?, 0); 
```

这是行不通的。

```
INSERT INTO ife VALUES ('#[payload:java.lang.String]', 0)? 
```

# twitter-bootstrap - 向 Twitter bootstrap typeahead 组件添加下拉按钮

> ID：10689830
> 
> 赞同：14
> 
> 时间：2012-05-21T17:32:58.507
> 
> 标签：twitter-bootstrap

Twitter bootstrap 带有一个非常方便的类似自动完成的组件，称为 typeahead。我正在尝试添加一个小的下拉按钮（或小部件），这样当按下 typeahead 组件时，它就像一个普通的下拉选择器，显示所有可用的数据源绑定选项（除了它的本机自动完成功能）。当前标记类似于以下内容：

```
<input type="text" 
       data-provide="typeahead"
       data-items=5
       data-source='["option 1","option 2","option 3"]'> 
```

因此，实际上需要让组件充当下拉和自动完成小部件的混合体。以前有人做过吗？谢谢...

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-09T18:21:07.960

我发现了这个出色的组件：

[源代码](https://github.com/danielfarrell/bootstrap-combobox)
[直播示例](http://dl.dropbox.com/u/21368/bootstrap-combobox/index.html)

不过有一件事，下拉按钮的背景在翻转时看起来很有趣。该修复涉及“bootstrap-combobox.css”中的一个小改动：

```
...
.combobox-container .add-on {
    float: left;
    display: block;
    width: auto;
    min-width: 16px;
    height: 18px;
    margin-right: -1px;
    padding: 4px 5px;
    font-weight: normal;
    line-height: 18px;
    color: #999999;
    text-align: center;
    text-shadow: 0 1px 0 #ffffff;
    /*   background-color: #f5f5f5; */ // <<------------ comment this line
    border: 1px solid #ccc;
    -webkit-border-radius: 3px 0 0 3px;
    -moz-border-radius: 3px 0 0 3px;
    border-radius: 3px 0 0 3px;
}
... 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-25T18:34:40.187

Fuel UX 还[提供](http://exacttarget.github.com/fuelux/#combobox)了一个基于 Bootstrap 的 Combobox。

# c# - How can I inherit and then override a resource or contents of it in .NET?

> ID：10689831
> 
> 赞同：1
> 
> 时间：2012-05-21T17:32:59.287
> 
> 标签：c#, .net, vb.net

I have a project, let's call it "BASE", that has a bunch of .CSV files as Resources. The project makes references to My.Resources.XXXXXXX in different methods where XXXXXXX is the CSV filename. I am working on a class that derives from "BASE" and I would like to change some of the .CSV files and replace the ones that are in the "BASE" project with mine. I would like the methods in the base project to use my CSV files when it calls My.Resources.XXXXXX instead of the files that are in "BASE"'s Resources. Any tips on how to do it? (any .NET language is welcome)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T18:51:48.410

This is a little hackey but works great:

In your derived class:

```
Public Class MyApplication
    Inherits BaseApplication

    Private Shared Property ResourceManager As New MyResourceManager
    Shared Sub New()
        Const fieldName As String = "resourceMan"
        'set base resource manager to my specialized resource manager using reflection'
        ReflectionHelper.SetStaticFieldValue(ResourceManager.BaseResourceManagerType, fieldName, ResourceManager)
    End Sub

    ...
End Class 
```

My Custom ResourceManager:

```
Public Class MyResourceManager
    Inherits ResourceManager

    Public Property BaseResourceManager As ResourceManager
    Public Property BaseResourceManagerType As Type
    Public Property MyResourceManager As ResourceManager = My.Resources.ResourceManager

    Public Sub New()
        MyBase.New()

        'get a reference to the resource manager for the base application to keep it around'
        Dim ass As Assembly = Assembly.Load("BaseApplication")
        BaseResourceManagerType = ass.GetType("BaseApplication.My.Resources.Resources")
        BaseResourceManager = ReflectionHelper.GetStaticPropertyValue(BaseResourceManagerType, "ResourceManager")
    End Sub

    Public Overrides Function GetString(ByVal name As String) As String
        Dim ret As String = MyResourceManager.GetString(name)
        If ret IsNot Nothing Then
            Return ret
        Else
            Return BaseResourceManager.GetString(name)
        End If
    End Function

    ... <override all the other members of ResourceManager in the same fashion as above>
End Class 
```

# php - 未捕获的 ReferenceError：未定义 jQuery

> ID：10689832
> 
> 赞同：3
> 
> 时间：2012-05-21T17:33:01.370
> 
> 标签：php, javascript, jquery, superfish

我仅在 chrome for superfish 下拉菜单中收到此错误。它在 Firefox 和 IE 中运行良好。它在 Chrome 中不起作用。菜单而不是水平列表本身是垂直的。**为保密起见，客户实际站点的域名已在下面更改**

```
<script type="text/javascript" src="http://www.domainname.com/js/jquery.js"></script>
<script type="text/javascript" src="http://www.domainname.com/js/superfish.js"></script>
<script type="text/javascript" src="http://www.domainname.com/js/hoverIntent.js"></script>
<script type="text/javascript">
    // initialise plugins
jQuery(function(){
     jQuery('ul.sf-menu').superfish();
    });
</script> 
```

我什至将其更改为以下内容并且不起作用：

```
 <script type="text/javascript">
         $(document).ready(function(){
            $('ul.sf-menu').superfish();
         })
    </script> 
```

我查看了视图源，它引用了两个头文件。这可能会导致错误。我正在使用magento。该菜单适用于网站的所有页面，但一页结帐除外。

**固定的！当它让我在 7 小时内阅读下面的内容时，它将作为答案发布**

问题不在于 javascript 本身，而在于 superfish 菜单的 css。设计布局和编码模板的开发人员将 superfish 菜单的样式表列为：

```
 <link rel="stylesheet" type="text/css" href="http://www.domainname.com/css/superfish.css" media="screen"> 
```

删除“http://www.domainname.com”并将其保留为“/css/superfish.css”后，它修复了菜单。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T17:36:02.047

尝试使用这样的符号`jQuery`会导致 a的唯一原因`ReferenceError`是：

1.  如果 jQuery 的脚本包含失败。检查您的控制台是否有 404 等。

2.  如果后面的脚本之一实际上*删除*了该`jQuery` `window`属性，例如：

    ```
    delete window.jQuery; 
    ```

    只是设置`jQuery`为`undefined`（也许通过`noConflict`）不会导致 a `ReferenceError`, 你会得到`undefined is not a function`或类似的。但是，如果您实际上删除了该属性，那么您会这样做。（IE 除外，它不允许您从`window`对象中删除属性。）

# ruby-on-rails-3 - 使用图像作为虚荣替代品

> ID：10689836
> 
> 赞同：0
> 
> 时间：2012-05-21T17:33:21.393
> 
> 标签：ruby-on-rails-3, vanity

我正在尝试将 Vanity 用于导轨。我的 ab_test /rag_price_options.rb 文件是：

```
 ab_test "Rag price options" do
      description "Different options for displaying the rag price"
      alternatives "banner_194x117_rag.png", "ccp_logo_bk.png"
      metrics :orders
    end 
```

我的指标 metrics/order.rb 是：

```
 metric "Orders" do
     description "Measures number of orders, subtotals, order number"
   end 
```

但我试图弄清楚如何将 2 张图像作为需要进入链接以显示如下内容的替代方案：

```
 <%= link_to image_tag("banner_194x117_rag.png", :alt=>'Free Rag with purchase over $99!', :width=>194, :height=>117, :style=>'display:block', :class=>'incentive'), "/blog/free-cheap-cycle-rag" %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:54:35.647

我所要做的就是：

```
 <%= link_to image_tag(ab_test(:rag_price_options), :alt=>'Free Rag with purchase over $99!', :width=>194, :height=>117, :style=>'display:block', :class=>'incentive'), "/blog/free-cheap-cycle-rag" %> 
```

# javascript - 单击导航索引数组的双重警报

> ID：10689838
> 
> 赞同：1
> 
> 时间：2012-05-21T17:33:25.213
> 
> 标签：javascript, jquery

当我点击子菜单时，我收到 2 个警报，弹出窗口首先显示 1，然后第二个弹出窗口给我 2。我希望警报按照正确的顺序为 0、1、2、3 等，按照导航大批。不是子菜单项只是数组中的以下项吗？

```
<ul id="menu">
   <li><a href="page1">Item 1</a></li>
   <li><a href="page2">Item 2</a> 
      <ul id="sub-menu">
           <li><a href="page3">Item 3</a></li>
      </ul>
   </li>
   <li><a href="page4">Item 4</a></li>
</ul> 
```

查询：

```
jQuery (function($) {
  $("#menu .menu li").each(function (index) {
     var item = $(this);
     $("a", item).click(function (e) {
        e.preventDefault();
        alert(index);
     });
  });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:44:04.777

一种不使用的方法`event.stopPropagation()`：

```
jQuery (function($) {
  $("#menu .menu li").each(function (index) {
    var item = $(this);
    $("> a", item).click(function (e) {
      e.preventDefault();
      alert(index);
    });
  });
});​ 
```

它只会触发`li`.

这是[工作示例](http://jsfiddle.net/DKe6n/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T18:10:34.280

哦，我以为你想要相对于最近的封闭 ul 的索引：http: [//jsfiddle.net/mari/68Zjt/](http://jsfiddle.net/mari/68Zjt/)

# .net - 在单个数据网格视图中使用 2 个不同的数据库列

> ID：10689839
> 
> 赞同：1
> 
> 时间：2012-05-21T17:33:28.220
> 
> 标签：.net, vb.net, winforms, datagridview

我需要显示`Full Name`在 a中调用的列`DataGridView`，但`DataSource (datatable)`没有`FullName`列。它只有`FirstName`和`LastName`列。我正在`DataGridView`这样设置：

```
Dim column As DataGridViewColumn = New DataGridViewTextBoxColumn()
column.DataPropertyName = "?" //Need FirstName + " " + LastName
column.Name = "FullName"
dgv.Columns.Add(column) 
```

如何设置`DataPropertyName`使用数据表中的`FirstName`和`LastName`列中的数据。？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T18:00:54.610

使用另一种方法。将计算列添加到数据表中。

```
Dim dc as DataColumn = dt.Columns.Add("FullName", System.Type.GetType("System.String"))
dc.Expression = "FirstName + ' ' + LastName" 
```

其中 dt 是您设置为 DataGridView 的 DataSource 的数据表。

计算列中使用的*表达式语法*规则可以**[在 MSDN 上的这个链接](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx)中找到。**
同样的规则也适用于另一个非常有用的方法：**[DataTable.Select(filterExpression)](http://msdn.microsoft.com/en-us/library/det4aw50.aspx)**方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T18:00:33.503

我不认为这是如何`DataPropertyName`工作的。[http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcolumn.datapropertyname.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcolumn.datapropertyname.aspx)

而是在数据库方面执行此操作。在您的选择（此处为 SQL Server 语法）中，执行 a `FirstName + " " + LastName as FullName`，您将得到一个 FullName 列，而不是两列。

如果您无权访问 SQL 端，则可以在代码中操作`DataTable`并创建自己的`FullName`列。我想一些 LINQ 和/或循环应该可以解决问题。

# django - Django - 从 Django 模板访问外键管理器

> ID：10689845
> 
> 赞同：6
> 
> 时间：2012-05-21T17:33:46.357
> 
> 标签：django, django-models, django-templates, django-managers

我有两个模型：

```
class Product(models.Model):
    name = models.CharField(max_length=255)

class ProductPhoto(models.Model):
    product = models.ForeignKey('Product', related_name='photos')
    is_live = models.IntegerField(choices=LIVE_CHOICES, default=1)

    live = LiveManager()

class LiveManager(Manager):
    def get_query_set(self):
        return super(LiveManager, self).get_query_set().filter(is_live=1) 
```

我正在尝试从产品详细信息模板中获取实时照片。

试过了，

```
{% for photo in product.photos.live %} 
```

这不起作用并查看了文档并找不到示例。是否可以从模板中调用外键的管理器？我应该在产品模型中创建一个返回产品照片查询集的函数吗？

谢谢你。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-21T18:27:30.977

好吧，无论如何，您使用它的方式是错误的。您只需将管理器传递给 for 循环，而不是可以迭代的查询集。但是，`photos`它本身是一个“相关管理器”，而不是实际`ProductPhoto`模型，并且相关管理器是基于列出的第一个管理器或`objects`（默认管理器）。

因为，你定义了`live`，但没有定义`objects`，你实际上并没有`objects`这个模型的经理，即 this 将失败：`ProductPhoto.objects.all()`。请记住，如果您在模型上定义自定义管理器，Django 将不再自动添加一个名为`objects`.

好消息是，因为`live`现在是默认管理器，您可以像这样使用它：

```
{% for photo in product.photos.all %} 
```

而且，你只会得到“活”的物体。坏消息是，这将破坏许多其他依赖于默认管理器作为对象的完整集合（例如管理员）的事情。您实际上是在隐藏“非活动”对象块。

你应该拥有的是：

```
class ProductPhoto(models.Model):
    product = models.ForeignKey('Product', related_name='photos')
    is_live = models.IntegerField(choices=LIVE_CHOICES, default=1)

    objects = models.Manager()
    live = LiveManager() 
```

请注意，它`objects`是手动定义的*，*它是第一个，这意味着它将保持默认管理器。但是，这将不再允许您`live`在模板中使用您的经理。一般来说，对于这样的事情，最好只使用一个管理器并向它添加一个方法来返回“活动”对象：

```
class ProductPhotoQuerySet(models.query.QuerySet):
    def live(self):
        return self.filter(is_live=1)

class ProductPhotoManager(models.Manager):
    use_for_related_fields = True

    def get_query_set(self):
        return ProductPhotoQuerySet(self.model)

    def live(self, *args, **kwargs):
        return self.get_query_set().live(*args, **kwargs) 
```

在这里，我们实际上继承了 QuerySet*和*Manager。这将允许您在`live`任何地方进行链接，而不仅仅是在前面。例如，如果您只有一个没有自定义查询集的自定义管理器，那么您将只能做`ProductPhoto.objects.live().filter(...)`而不能`ProductPhoto.objects.filter(...).live()`。

因此，然后将其添加到模型中`objects`（代替 Django 提供的默认值）：

```
class ProductPhoto(models.Model):
    product = models.ForeignKey('Product', related_name='photos')
    is_live = models.IntegerField(choices=LIVE_CHOICES, default=1)

    objects = ProductPhotoManager() 
```

最后，您将能够在模板中使用它：

```
{% for photo in product.photos.live %} 
```

# mysql - MySQL插入问题

> ID：10689853
> 
> 赞同：-1
> 
> 时间：2012-05-21T17:34:04.123
> 
> 标签：mysql, insert, replace, double-quotes

我正在尝试将数据插入包含大量单引号和双引号的表中。

```
INSERT INTO vulnerabilities_internal_test (device_type, ip_address, user_tag, 
repositoryID, severity, pluginID, pluginName, pluginText)

VALUES ("@Data.device_type~", "@Data.ip_address~", "@Data.user_tag~", 
"@Data.repositoryID~", "@Data.severity~", "@Data.pluginID~", "@Data.pluginName~", 
replace(replace("@Data.pluginText~", ',', ''), '"', '' )) 
```

我收到以下错误：

您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以了解在运行此扫描时未启用“彻底测试”附近使用的正确语法。\n\nCVE : CVE-2011-1000，第 3 行

但是数据看起来像这样：

运行此扫描时未启用“全面测试”。\n\nCVE : CVE-2011-1000

有谁知道为什么将其中一个双引号替换为单引号并引发此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:36:41.410

应该没关系。问题是您的数据应该使用斜杠 ('\') 转义所有引号。这样，您只需要在将结果返回到代码时对数据进行转义即可。

# asp.net - Global.asax - FxCop 警告冲突 CA1811 与 CA2109

> ID：10689854
> 
> 赞同：1
> 
> 时间：2012-05-21T17:34:07.680
> 
> 标签：asp.net, performance, security, global-asax, fxcop

我正在开发一个 ASP.NET 项目。投影当然有一个 Global.asax 文件。在 Global.asax.cs 文件中，它包含以下每个方法，[除了`Application_Start`] 并不是真正的空，但不需要实际实现：

```
protected void Application_Start(object sender, EventArgs e){ }
protected void Session_Start(object sender, EventArgs e){ }
protected void Session_End(object sender, EventArgs e){ }
protected void Application_Error(object sender, EventArgs e){ } 
```

我一直在慢慢启用 Visual Studio 2008 必须提供的每个 FxCop 规则，最近遇到了与上述方法有关的冲突。我遇到的第一个错误是 CA2109

```
CA2109 : Microsoft.Security : Consider making 'Global.Application_Error(object, EventArgs)' not externally visible. 
```

每种方法都会显示此错误。由于我没有手动调用这些方法中的任何一个，因此我可以通过设置每个方法来消除此警告`private`。这样做后，重新运行代码分析，我收到错误 CA1811：

```
CA1811 : Microsoft.Performance : 'Global.Application_Error(object, EventArgs)' appears to have no upstream public or protected callers. 
```

我对 Stack Overflow 社区世界中的所有人的问题是：我应该听哪个警告，应该禁止哪个警告？有没有办法同时满足这两个警告？

我是否正确假设安全胜过一切，因此我应该听 CA2109 并抑制 CA1811？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:44:45.427

CA1811 实际上是“避免未调用的私有代码”。这意味着 FXCop 认为它们没有被调用，因为没有明确的事件绑定。自动事件连线意味着它们被调用并且可以禁止此规则，或者您可以显式处理具有相同效果的事件。

“CA2109：查看可见事件处理程序”有点说同样的话。它知道它们是事件处理程序，但说为什么它们需要在课堂外可见？

这些规则并不是真的相互矛盾，它们只是不太清楚它们向你提出的建议。

# full-text-search - fts文档级索引，获取页面级结果（以dtSearch为例）

> ID：10689856
> 
> 赞同：2
> 
> 时间：2012-05-21T17:34:15.807
> 
> 标签：full-text-search, ocr, dtsearch

这不一定是特定于 dtSearch 的问题（例如，它更像是一个 fts 引擎问题），而是处理一种索引由多个页面组成的文档并获得页面级命中结果的方法。

我用谷歌搜索并搜索并没有发现任何东西，因此我的问题是：

我们有一堆来自 m 本书的扫描 n tiff 页。我们对它们进行 OCR，对它们进行全文索引并执行搜索。

我们希望搜索结果是书籍级别的（例如，搜索结果应该包含一本书），但也希望能够在页面级别获得找到的项目（以便能够有效地执行点击突出显示，例如术语*SomeTerm*在第 1 页、第 2 页和第 7 页上找到）。

问题来了：

*   如果我们一次索引页面的文本，并且 BookA 中的 Page1 包含术语*Term1*，并且同样来自 BookA 的 Page2 包含术语 Term2 *，*则搜索*Term1 AND Term2*不会产生任何结果，这是正常的
*   如果我们在一个大文本块中索引所有页面的文本，所有这些都属于同一本书，我们将无法获得找到的术语所属的页面。

dtSearch Desktop 具有这样的 PDF 索引功能：它能够从单个文档中索引所有页面的文本，但也可以通过使用 %%Page%% 符号来判断发生命中的页面。

我们正在使用自定义 DataSource 来为索引器提供数据，但我们无法确定要使用的文档结构来获得所需的结果。

如果您使用任何其他 fts 引擎（例如 Lucene/Sphinx），您将如何解决上述问题（有重复自己的风险）：

1.  您需要索引**页面的内容**
2.  页面**按逻辑分组**到文档中
3.  您需要**通过文档获取结果**
4.  高亮结果**必须**包含**页码**

谢谢你的任何建议，乔治

PS：抱歉留言太长了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T09:57:06.097

作为一个长期使用 dtsearch 的用户，我想我会通过生成和索引一个分页的 pdf 文件来回归基础，它的每一页对应于你的书的一个 ocr 文本页。

这样，您就完全独立于搜索引擎技术，让它在众所周知的 pdf 格式上做它最擅长的事情。

您的索引不会被无意义的单页文档溢出，在搜索书籍时，这些文档的数量会破坏最佳结果排序。

希望这会有所帮助，并为我的英语蹩脚感到抱歉

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T11:50:46.207

蛮力方法是拥有两种类型的索引文档：

*   页面级文档，包含页面文本、页码、书名和指示这是页面级文档的标志。
*   书本级文档，其中包含书本、书名和表明这是书本级文档的标志。

您将首先仅搜索书籍级别的文档以查找匹配的书籍。然后，您将仅在页面级文档中搜索匹配的书籍以找到匹配的页面级文档。这会让您说“termX 和 termY 出现在书 Z 中，termX 出现在第 2、47 和 293 页，termY 出现在第 1、3、5 和 293 页。”

这种方法的一个缺点是您最终会为每个页面的内容编制两次索引。

# c# - 从嵌套的局部视图向控制器发送复杂的视图模型 - MVC3

> ID：10689858
> 
> 赞同：0
> 
> 时间：2012-05-21T17:34:19.267
> 
> 标签：c#, asp.net-mvc-3, jquery

在这里寻找一些 Ajax 帮助...

我有一个相当复杂的视图，它建立在一个相当复杂的 ViewModel 之上。

在页面上，我有 3 列，其中每列代表一个完整的旅程，然后分解以显示各个航班。

每个航班都由一个包含详细信息（开始和结束位置、出发时间、到达时间、运营商等）的框表示。该框还包含一个下拉列表，列出了可以从该位置乘坐的所有其他可能的航班（例如，您可能想挂机场周围额外6小时，所以你可以选择晚一点的航班！）

无论如何，通过更改一个可能的航班，我将不得不更新整个专栏，因为乘坐稍后的航班将意味着后续航班可能不再可能了。

这导致了我的问题 - 我是否可以通过 jQuery 将复杂的视图模型传递回控制器？可以使用嵌套在 foreach 循环中的部分视图来完成吗？我想要做的就是通过 ajax 更新列，但我看不到如何将视图模型传回。我试图避免重新加载整个页面，因为这将是一个相当麻烦的搜索，所以 ajax 更新将是理想的

以下是该过程的一些精简代码：

**视图代码 (index.cshtml) - jQuery 位于主视图中**

```
@foreach (var item in Model)
{
    <div id="column-@groupCount">
        @Html.Partial("_JourneyColumnPartial", item)
    </div>
}

<script type="text/javascript">
    $(".flightItem").change(function (event) {
        alert(event.target.id);
        var cSelected = $(this).val();
        alert(cSelected);
        $.ajax({
            url: "/Search/GetChangeInfo",
            contentType: "application/json",
            type: "POST",
            dataType: "json",
            data: ({ cID: cSelected }),
            success: function (display) {
            }
        });
    });
</script> 
```

**第一部分视图的代码 (_JourneyColumnPartial.cshtml)**

```
<div class="routeContainer">
    @Html.Partial("_ColumnItemPartial", Model)
</div> 
```

**子部分视图的代码 (_ColumnItemPartial.cshtml)**

```
@{
    int journeyNumber = 1;
}
@foreach (var journey in Model.SelectedJourneys)
{
    List<JourneyDetails> list = Model.Journeys.Where(j => j.JourneyDateAndTimeID != journey && j.DepartureID == hub.DepartureID && j.ArrivalID == hub.ArrivalID).OrderBy(j => j.JourneyDateAndTime).ToList();
    <div class="box">
        <div class="journeytimes">
            <b>Depart</b> @hub.DepartureDate<br />
            <b>Arrive</b> @hub.ArrivalDate<br />
        </div>
        <div class="boxcontrols">
            <select class="flightItem" id="flightItem_@{<text>@Model.ColumnNumber</text><text>_</text><text>@journeyNumber</text>}">
                @foreach (var flight in list)
                {
                    <option value="@flight.JourneyID">@flight.ProviderName - @flight.JourneyDateAndTime</option>                                                    
                }                                            
            </select>

        </div>
        <!-- end of box -->
    </div>
    journeyNumber++;    
    <!-- end of box wrap -->
} 
```

我知道我没有包含有关 ViewModel 的详细信息，但它非常复杂，并且包含其他类的通用列表，因此它非常大。ajax/jQuery 的触发器是下拉列表的更改事件。

如果这完全没有意义，请随意说，我会尝试澄清我在寻找什么！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:38:20.033

可以通过在 jquery 调用中将数据作为 json 发送。

您可以通过简单地创建一个像 ViewModel 这样的 javascript 对象来实现这一点，然后通过`Json.Stringify`方法将该 javascript 对象转换为字符串，并将字符串值设置为`data`ajax 调用中的 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:41:09.720

我不确定您的问题是发送数据还是返回数据，但这将帮助您通过 ajax 返回数据：[http ://www.klopfenstein.net/lorenz.aspx/render-partial-view-to-string -in-asp-net-mvc](http://www.klopfenstein.net/lorenz.aspx/render-partial-view-to-string-in-asp-net-mvc)

# multithreading - Monotouch Webclient.CancelAsync ThreadInterruptedException

> ID：10689860
> 
> 赞同：1
> 
> 时间：2012-05-21T17:34:32.547
> 
> 标签：multithreading, xamarin.ios, interrupted-exception, webclient

我使用 WebClient.DownloadDataAsync() 从网络下载数据。

```
WebClient webClient;
void WebClientDownload(MediaInfo media)
{
    if (webClient == null)
    {
        webClient = new WebClient();
        webClient.DownloadProgressChanged += (sender, e) => {
            // use e.ProgressPercentage for change UIProgressView.Progress value by InvokeOnMainThread
        };
        webClient.DownloadDataCompleted += (sender, e) => {
            if (e.Cancelled == false && e.Error == null)
            {
                // saveing data
            }
        };
    }

    webClient.DownloadDataAsync(new Uri("http://..."));
} 
```

但是当我`webClient.CancelAsync();`用来取消下载时，我得到了这个异常：

```
System.Threading.ThreadInterruptedException: Thread interrupted
  at (wrapper managed-to-native) System.Threading.WaitHandle:WaitOne_internal (System.Threading.WaitHandle,intptr,int,bool)
  at System.Threading.WaitHandle.WaitOne (Int32 millisecondsTimeout, Boolean exitContext) [0x00038] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System.Threading/WaitHandle.cs:376
  at System.Net.WebAsyncResult.WaitUntilComplete (Int32 timeout, Boolean exitContext) [0x0000d] in /Developer/MonoTouch/Source/mono/mcs/class/System/System.Net/WebAsyncResult.cs:164
  at System.Net.WebConnectionStream.Read (System.Byte[] buffer, Int32 offset, Int32 size) [0x00018] in /Developer/MonoTouch/Source/mono/mcs/class/System/System.Net/WebConnectionStream.cs:327
  at System.Net.WebClient.ReadAll (System.Net.WebRequest request, System.Object userToken) [0x0010d] in /Developer/MonoTouch/Source/mono/mcs/class/System/System.Net/WebClient.cs:909
  at System.Net.WebClient.DownloadDataCore (System.Uri address, System.Object userToken) [0x0000a] in /Developer/MonoTouch/Source/mono/mcs/class/System/System.Net/WebClient.cs:246 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:09:59.800

这是一个[已知的错误](https://bugzilla.xamarin.com/show_bug.cgi?id=2483)，应该在 2.10 中修复。

# regex - 正则表达式匹配“接收：由”电子邮件标题中的时间

> ID：10689862
> 
> 赞同：1
> 
> 时间：2012-05-21T17:34:36.090
> 
> 标签：regex, perl, email, time, email-headers

在我的网站所在的共享主机上，我有一个电子邮件转发器，可以将消息作为短信发送到我的手机。然而，最近，它有点失控了。

我希望，使用 cPanel 中的*“用户级别过滤”*，我可以设置一个基于 RegEx 的过滤器，仅在 07:00:00 到 22:00:00 之间将电子邮件转发到我的手机。

此过滤器将匹配以下电子邮件标头，该标头通常出现在邮件源的 2-3 行中：

```
Received: by 99.99.99.99 with SMTP id XyXyXyXyXyXyXy;
        Tue, 15 May 2012 01:22:33 
```

...这就是我希望它起作用的方式：

```
Received: by (ANY IP) with (ANYTHING) id (ANYTHING);
        (Sun|Mon|Tue|Wed|Thu|Fri|Sat), (ANY DATE/MONTH/YEAR) (RegEx magic to match time?) 
```

当匹配成功时（例如，如果时间在 07:00:00 和 22:00:00 之间），消息将被发送到我的手机，否则它什么也不做。（当然，这与 RegEx 本身无关。）

我是一个正则表达式 n00b，但设计了以下（非工作）正则表达式，并且不知道我离它有多近或多远：

```
\bReceived: by (.*) with [a-Z] id (.*)(Sun|Mon|Tue|Weds|Thu|Fri|Sat),(.*)[0-2][2-7]:[0-2][0-9]:[0-2][0-9]\bsi 
```

有什么想法、建议或创造性的解决方案吗？我的托管服务告诉我，cPanel 中的 RegEx 需要采用 PERL 格式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T18:05:56.560

Eugene 正则表达式的修正版；

```
/\bReceived: by .*?;\s*(?:Sun|Mon|Tue|Weds|Thu|Fri|Sat),\s*\d+\s+\w+\s+\d+\s+(?:0[789]|1\d|2[01]):\d\d:\d\d\b/ 
```

此版本使用非捕获分组，并将可接受时间限制为 07:00:00 到 21:59:59。它假定时间格式是有效的——理论上它会经过 10:99:99 的时间，但我假设你不会看到那些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:57:55.767

修复了您使用[http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)工作的问题，但在很大程度上仍然不是最理想的。告诉你是否想更进一步。

```
\bReceived: by (.*) with \w+ id (.*);\s*(Sun|Mon|Tue|Weds|Thu|Fri|Sat),\s*(\d+\s+\w+\s+\d+)\s+[0-2][0-9]:[0-5][0-9]:[0-5][0-9]\b 
```

# ruby-on-rails - Rails：从控制器返回自定义 JSON 的最佳方法？

> ID：10689865
> 
> 赞同：0
> 
> 时间：2012-05-21T17:34:52.623
> 
> 标签：ruby-on-rails, json

我正在寻找在我的控制器中调用“显示”操作时返回 json 的最佳方法。我正在使用 Rails 2.3.x。

有些东西我想添加，有些我想在返回之前从对象中删除，所以只需执行以下操作之一：

```
respond_to do |format|
  format.json {
    render :json => @object.to_json
  }
end 
```

不一定会奏效。我不希望该对象中的所有内容都暴露出来。我在想我在这里有两个意见：

1.  在控制器中创建一个私有辅助方法，该方法构建一个仅包含我想要的新对象，然后将其发送。这里的问题是我有一些视图辅助方法，我无法使用这种方法。
2.  在 show.json.erb 视图中手动写出 json。这里的问题是，我似乎违背了规律，必须投入大量逻辑来解释尾随逗号之类的问题。

如果这是我返回的 HTML，我显然只会使用 .html.erb 文件，并且只包含我想要的内容。但是由于我正在处理 JSON，所以我似乎应该处理代码中的几乎所有内容，甚至不处理视图文件。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:55:26.187

你应该看看 RABL (https://github.com/nesquena/rabl)。然后你可以像这样构建你的 show.json.rabl 文件：

```
object @person
attributes :id, :name, :age 
```

在 RABL 上查看 RailsCast：[http ://railscasts.com/episodes/322-rabl](http://railscasts.com/episodes/322-rabl)

还可以查看[https://github.com/rails/jbuilder](https://github.com/rails/jbuilder) - 和 RailsCast：[http: //railscasts.com/episodes/320-jbuilder](http://railscasts.com/episodes/320-jbuilder)

# android - android - 有什么方法可以调整接近传感器？

> ID：10689867
> 
> 赞同：1
> 
> 时间：2012-05-21T17:35:13.477
> 
> 标签：android, listener, distance, android-sensors, proximity

我想调整从接近传感器获得的听者事件，以便如果用户距离设备 X 厘米（甚至 10 厘米），它会通知我。甚至可能获得每次的确切值。

出于某种原因，我收到通知，用户在每台设备上以不同的距离靠近设备。

这样的事情可能吗？有什么解决方法吗？似乎接近传感器几乎没有任何教程和信息。

# java - 序列化的最小集合

> ID：10689872
> 
> 赞同：0
> 
> 时间：2012-05-21T17:35:24.450
> 
> 标签：java, performance, serialization, collections, vector

我有一个 Java 应用程序（胖客户端、服务器、数据库）。所有服务器方法调用都返回一个向量（服务器代码最初是在几年前构建的，为了保持一致而保持不变）。无论调用什么，Vector 总是返回 2 个位置。第一个位置是一个错误对象（或 null），用于提醒客户端服务器在处理方法调用时遇到的任何问题。第二个位置是我们想要的数据。它可以是对象的 ArrayList、String、int 等；无论胖客户正在寻找什么。

我正在尝试减少占用空间并提高服务器调用的性能。我正在研究的一件事是删除返回的向量并用某些东西替换它们。我的问题是什么。如前所述，此集合将始终为 2 个位置，位置 0 作为错误对象（如果没有错误，则为 null），位置 1 作为“我的数据”。它永远不需要排序，它基本上用于返回 2 个参数的方法（并在从服务器到客户端时将它们序列化）。

除了将位置 0 和 1 传输到客户端之外，我不需要任何其他功能，因为一旦此集合到达客户端，就会检查位置 0 是否存在错误，然后将位置 1 拉出并移交给调用代码段，因为那里存储了任何对象.

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:38:40.783

创建一个类：

```
class MeaningfulNameForTheResult
{
  public Error error;
  public Object result;
} 
```

并使用它作为结果。

根据您的需要，是否将属性设为私有并添加或不添加 setter/getter，......但总体思路：创建一个具有两个您序列化的属性的类。

编辑：也许...根据您的需要，您甚至可以完全删除该对象。如果一切正常，只需返回您想要的结果对象，如果出现问题则返回错误对象。在客户端中，反序列化对象，然后检查类型。如果是，`instanceof Error`那么您知道这是一个错误，否则就是您的结果。

# parameters - modx - 当我在同上片段中使用“&documents =”参数时，分页不起作用

> ID：10689873
> 
> 赞同：0
> 
> 时间：2012-05-21T17:35:27.550
> 
> 标签：parameters, modx, ditto

我正在尝试使用包含特定 docID 的参数运行同上：

```
&documents= 
```

当我将静态 ID 代码放入块时：

```
[[Ditto? &documents=`9,239,240,242,243,246,253,257,260,261,267,269,281,285,288` &showInMenuOnly=`1` &tpl=`item_subdocs`  &summarize=`2` &paginate=`1` &paginateAlwaysShowLinks=`1`  ]]
[+previous+][+pages+][+next+] 
```

它可以工作-分页，列表下的链接-没关系，但是当我尝试动态检索该ID时-通过一些片段：

```
[[Ditto? &documents=`[[getIDs]]` &showInMenuOnly=`1` &tpl=`item_subdocs`  &summarize=`2` &paginate=`1` &paginateAlwaysShowLinks=`1`  ]]
[+previous+][+pages+][+next+] 
```

它不起作用。分页链接将消失，但是当我通过添加短语从 URL 运行页面时：

```
?start=2 
```

这是工作......谁知道发生了什么？
还从该片段运行简单的代码：

```
echo '9,239,240,242,243,246,253,257,260,261,267,269,281,285,288'; 
```

.. 不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:48:16.343

尝试让您的代码段输出值，而不仅仅是回显它们：

$输出='9,239,240,242,243,246,253,257,260,261,267,269,281,285,288';

返回$输出；

听起来很傻，但如果代码片段调用不返回某些东西，modx 可以做一些奇怪的事情。

# c - C语言中的大写

> ID：10689876
> 
> 赞同：1
> 
> 时间：2012-05-21T17:35:34.980
> 
> 标签：c, uppercase

我有这个代码：

```
void changeToCapital(char* str)
{
    int i;
    for (i=0; i<strlen(str); i++) 
    {
        str[i] =str[i] -32;
    }
} 
```

这个方法应该得到一个`char*`变量，并将其更改为大写。出于某种原因，我收到一条错误消息`EXECUTE_BAD_ACCESS`。

调用函数：

```
char* s = "itzik";
changeToCapital(s);
printf("%s\n",s); 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-21T17:38:05.663

这很可能是因为您向它传递了一个指向不可写内存的指针，例如从字符串文字中获得的指针：

```
char *ptr = "Hello";
changeToCapital(ptr); // <<== ERROR ! 
```

您可以更改调用以避免错误：

```
char ptr[] = "Hello";
changeToCapital(ptr); 
```

附带说明，您对大写的更改仅在所有字母都为小写时才有效。您应该使用`toupper(ch)`函数而不是减去 32。

```
void changeToCapital(char* str) {
    for (; *str = toupper(*str) ; str++)
        ;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T17:39:28.410

第一的：

你一直在计算`strlen`。相反，您应该将字符串的长度存储在局部变量中。

第二：您可能正在调用这样的函数：

```
char *str = "Hello World";
changeToCapital(str); 
```

这很**糟糕**。`"Hello World"`是`const`，并且不能被您的程序修改。相反，您应该将字符串指定为字符数组，以确保它是不可变的：

```
char str[] = "Hello World";
changeToCapital(str); 
```

# c#-4.0 - 为什么获取成员的行为不一致？

> ID：10689883
> 
> 赞同：0
> 
> 时间：2012-05-21T17:35:55.573
> 
> 标签：c#-4.0, roslyn

当试图在给定的编译中获取类型的集合时，我对解决问题的方法感到困惑。本质上，似乎返回结果的方法不会，反之亦然。下面是调试会话即时窗口的输出，其中`appCompilation`类型为`Compilation`(natch)。

```
**appCompilation.GlobalNamespace.GetMembers()**
Count = 14
    [0]: "Namespace Registration"
    [1]: "Namespace Payments"
    [2]: "Namespace Foo"
    [3]: "NamedType <Module>"
    [4]: "NamedType <Module>"
    [5]: "NamedType <Module>"
    [6]: "NamedType <Module>"
    [7]: "NamedType <Module>"
    [8]: "NamedType <Module>"
    [9]: "NamedType <Module>"
    [10]: "Namespace Conference"
    [11]: "Namespace System"
    [12]: "NamedType <>f__AnonymousType0<<OrderId>j__TPar>"
    [13]: "Namespace Infrastructure"
**appCompilation.GlobalNamespace.GetTypeMembers()**
{System.Linq.Enumerable.OfTypeIterator<Roslyn.Compilers.CSharp.NamedTypeSymbol>}
    source: null
**appCompilation.GlobalNamespace.GetNamespaceMembers()**
{System.Linq.Enumerable.OfTypeIterator<Roslyn.Compilers.CSharp.NamespaceSymbol>}
    source: null 
```

所以我的问题是：当我调用==`.GetTypeMembers()`的符号时，我得到空值。当我调用相同的符号时，我也会得到空值。然而，当我打电话时，我得到了大量的命名空间和类型！`Kind``Namespace``.GetNamespaceMembers()``.GetMembers()`

更奇怪的是，我可以将此语句放入监视窗口并获得非空、非空结果！

`appCompilation.GlobalNamespace.GetNamespaceMembers(), results`

可能相关：启动查询的执行似乎并没有在我预期的时候发生，但我不完全确定我应该如何甚至为什么我应该担心这个......调用`.ToList()`有时会触发执行。我原以为，虽然很多方法都提供了`CancellationToken`参数，但它们都是同步运行的。还有一个问题是各种`GetXXX()`方法都返回`ReadOnlyArray`or `IEnumerable`; 只读似乎不像 IEnumerable 那样从 LINQ 扩展方法中获得相同的行为。

从调试输出的表面扫描来看，它看起来像`GetTypeMembers`一个`GetMembers()`调用`.OfType<>`。也许是因为翻译变得无聊了？

无论如何，访问和执行查询的不一致是非常痛苦的，所以我希望有人能帮助我理解我所缺少的东西，这使得事情看起来如此不确定。

编辑：在对它进行了一点迭代之后，我发现你只需要通过符号树进行递归搜索，而且查询语法有时比 lambda 表达式更容易......哦，是的 - PEBKAC，因为它似乎即时窗口阻碍的不仅仅是帮助调试工作。

从给定编译中检索所有类型的最终传递查询示例，最多三个命名空间嵌套级别左右（需要更多测试来涵盖这些情况）：

由此（这比其他一些尝试要好得多！）

```
appCompilation.Assembly.GlobalNamespace.GetNamespaceMembers()
    .SelectMany(x => x.GetNamespaceMembers().Select(y => y.GetNamespaceMembers()))
    .SelectMany(x => x, (symbols, symbol) => symbol.GetTypeMembers())
    .SelectMany(x => x); 
```

为此（仍然没有完全递归，但现在已经足够好了）：

```
from glob in appCompilation.Assembly.GlobalNamespace
    .GetMembers()
    .OfType<NamespaceOrTypeSymbol>()
from childNs in glob
    .GetMembers()
    .OfType<NamespaceSymbol>()
from childTypes in childNs
    .GetTypeMembers()
select childTypes; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T19:38:01.430

我认为这只是即时窗口的限制，与 Roslyn 无关。

例如使用以下代码：

```
var ints = new object[] { 2 }.OfType<int>(); 
```

我在立即窗口中得到这个输出：

```
ints
{System.Linq.Enumerable.OfTypeIterator<int>}
    source: null
    System.Collections.Generic.IEnumerator<TResult>.Current: 0
    System.Collections.IEnumerator.Current: 0 
```

但是，如果我使用 a 迭代集合`foreach`，或者在监视窗口中使用 Results View，它就可以正常工作。

您看到您所做的事情的原因是因为`Enumerable.OfType()`它是使用生成迭代器类型的迭代器块编写的。迭代器类型有一些名称难以描述的字段，包括`<>3__source`保存原始源（我的示例中的数组）的字段。它还有一个具有正常名称的字段：`source`，在对 的调用中设置`GetEnumerator()`。由于您尚未调用该方法，`source`因此 is `null`.

# jquery - IE 和 jQuery 脚本的跨浏览器问题

> ID：10689884
> 
> 赞同：0
> 
> 时间：2012-05-21T17:35:56.743
> 
> 标签：jquery, internet-explorer, debugging, cross-browser

我有一点跨浏览器问题。我似乎无法让我的代码在 IE 中工作。如果有人能发现错误，我将不胜感激：

```
$(document).ready(function() {
    var timerId = 0;
    $('#timerwrap').ready(function() {
        $('#timerwrap').html("Please wait <strong id='show-time'>5</strong>");
        console.log(timerId)
        if (timerId == 0) {
            timerId = window.setInterval(function() {
                var timeCounter = $("#show-time").html();
                var updateTime = parseInt(timeCounter, 10) - 1;
                $("#show-time").html(updateTime);
                if (updateTime <= 0) {
                    clearTimeout(timerId);
                    $('#timerwrap').html("<a href='http://2ga.in/push/<?php echo("$item[seo]"); ?>/' target='_parent' title='Continue to <?php echo("$item[title]"); ?>'>Continue to...</a>");
                }
            }, 1000);
        }
    });
});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-14T12:59:49.770

```
I am not sure for solutions without full requirement or preview, but i found that it's showing an error because of using "" twice in "" so try with edited as below.

<script type="text/javascript">
// Only create tooltips when document is ready
$(document).ready(function() {
    var timerId = 0;
    $('#timerwrap').ready(function() {
        $('#timerwrap').html("Please wait <strong id='show-time'>5</strong>");
        console.log(timerId)
        if (timerId == 0) {
            timerId = window.setInterval(function() {
                var timeCounter = $("#show-time").html();
                var updateTime = parseInt(timeCounter, 10) - 1;
                $("#show-time").html(updateTime);
                if (updateTime <= 0) {
                    clearTimeout(timerId);
                    $('#timerwrap').html("<a href='http://2ga.in/push/<?php echo('$item[seo]'); ?>/' target='_parent' title='Continue to <?php echo('$item[title]'); ?>'>Continue to...</a>");
                }
            }, 1000);
        }
    });
});
</script> 
```

# c#-4.0 - 无法在表达式 system.collections.generic.linkedlist 上应用索引

> ID：10689886
> 
> 赞同：1
> 
> 时间：2012-05-21T17:36:03.513
> 
> 标签：c#-4.0, silverlight-4.0

我做了一堂课：

```
public class Node
{
    public int Id { get; set; }
    public string Name { get; set;}
    public List<Node> Successor { get; set; }

} 
```

在某些方法中，我想做以下事情

```
partice.path= new  LinkedList<Node>(); 
```

但我无法达到“.elementat()”方法和其他扩展。

ps：上面所有的类都在silverlight类库中，不知道是不是和报错有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:45:01.013

`Node`鉴于您的声明，尚不清楚您是使用框架类（如标题中所建议）还是您自己的类...

如果您使用的是框架类，请确保包括：

```
using System.Linq; 
```

在文件的顶部。此外，请确保`System.Core.dll`在您的项目中包含对的引用。

如果您使用自己的类，并且想要使用[Enumerable.ElementAt](http://msdn.microsoft.com/en-us/library/bb299233.aspx)扩展方法，则需要使您的类实现`IEnumerable<T>`.

话虽如此，您可能只想使用框架的[`LinkedList<T>`](http://msdn.microsoft.com/en-us/library/he2s3bh7.aspx)类而不是滚动您自己的...

# sql - 插入具有来自另一行的值的行，除了一个？

> ID：10689892
> 
> 赞同：3
> 
> 时间：2012-05-21T17:36:23.867
> 
> 标签：sql, sql-server-2008, sql-server-2008-r2

我正在尝试创建一个存储过程，该过程将在 id = @id 的列 a、b、c、d 中获取一行，并插入一个新行，其中 a、b、c 的值相同，但 d 会不同。

在这种情况下，大约有 50 列，尽管只有一列需要不同。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T17:41:54.260

假设`d`是 an`INT`并且您想要插入，`15`而不是 中的任何内容`dbo.oldtable`，那么：

```
INSERT dbo.newtable(a,b,c,d) 
  SELECT a,b,c,d = 15
  FROM dbo.oldtable
  WHERE id = @id; 
```

它更有可能来自一个变量，所以：

```
INSERT dbo.newtable(a,b,c,d) 
  SELECT a,b,c,d = @whatever
  FROM dbo.oldtable
  WHERE id = @id; 
```

抱歉，没有简写方式来表示“除 d 之外的所有列”……您需要单独列出它们。如果打字是问题，有一种简单的方法可以解决这个问题。打开对象资源管理器，展开您的服务器、数据库、表和有问题的表，然后将列节点拖到查询窗口上：

![在此处输入图像描述](../Images/ed90acabcf7c1bcf462a8cba42a0a7af.png)

现在您只需`d`从该列表中删除该列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:43:29.597

可能这有帮助 -

```
INSERT INTO tablename
(a, b, c, d)
VALUES
(SELECT col1, col2, col3, 'newcolvalue'
 FROM tablename
 WHERE id = @id); 
```

# java - Thread.Sleep() 冻结

> ID：10689898
> 
> 赞同：1
> 
> 时间：2012-05-21T17:36:41.653
> 
> 标签：java, applet

这是一个片段

```
kit.insertHTML(doc, doc.getLength(), "Hello", 0, 0, null);
try{
Thread.sleep(1000);
}catch(Exception e){} 
```

我正在使用`HTMLEditorKit()`和`HTMLDocument()`作为文本框。文本框应该显示“Hello”然后等待一秒钟，但是当我尝试这个时，它等待一秒钟然后输入“Hello”这个词，这不是我想要的。

我不确定为什么会发生这种情况，因为我按逻辑顺序排列。如果有人可以帮助我，那就太好了。

编辑：

有谁知道替代方案，所以我可以使用“延迟”效果？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T17:38:15.727

永远不要从 Swing 事件线程中调用 Thread.sleep(...)，因为这会使事件线程本身进入睡眠状态。由于该线程负责所有 Swing 绘制和用户交互，这将使您的应用程序进入睡眠状态。

如果您想要的只是显示延迟，请考虑使用[Swing Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)。

另一方面，如果您的事件线程受到长时间运行的任务的影响，则使用 SwingWorker（如 Guillaume 1+ 向他建议的那样）在后台执行任务。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T17:38:45.227

您正在调用`sleep`EDT（事件调度线程）。您应该避免这种情况，因为它确实会冻结 UI。

为避免这种情况，请改用[SwingWorker](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html)或按照 HFOE 的建议，使用 Swing Timer

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T15:23:07.823

`Thread.sleep`是一项长期运行的任务。当您在 EDT 中运行此类任务时，它会阻止执行所有重绘请求。在睡眠阶段发送的所有未决的重绘请求都将排队等待将来处理。

结果，当 EDT 退出`sleep`阶段时，它将所有此类重绘请求（如果启用了默认属性的合并）合并为一个执行的重绘。如果未启用合并，则所有排队的请求都将连续执行，中间没有任何时间间隔。结果似乎UI没有更新。

要纠正这种情况，请使用`SwingTimer`在特定时间间隔后定期触发的 a 或 a `SwingWorker`。

# java - 按名称仅获取 XML 直接子元素

> ID：10689900
> 
> 赞同：45
> 
> 时间：2012-05-21T17:36:42.720
> 
> 标签：java, xml, parsing, dom, xml-parsing

**我的问题是：**当存在与父元素的“孙子”同名的其他元素时，如何直接在特定父元素下获取元素。

我正在使用 Java [DOM 库](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/package-summary.html)来解析 XML[元素](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Element.html)，但遇到了麻烦。这是我正在使用的**一些（一小部分）xml：**

```
<notifications>
  <notification>
    <groups>
      <group name="zip-group.zip" zip="true">
        <file location="C:\valid\directory\" />
        <file location="C:\another\valid\file.doc" />
        <file location="C:\valid\file\here.txt" />
      </group>
    </groups>
    <file location="C:\valid\file.txt" />
    <file location="C:\valid\file.xml" />
    <file location="C:\valid\file.doc" />
  </notification>
</notifications> 
```

如您所见，有两个地方可以放置`<file>`元素。无论是在组内还是在组外。我真的希望它以这种方式构建，因为它对用户更友好。

现在，每当我调用`notificationElement.getElementsByTagName("file");`它时，它都会给我所有`<file>`元素，包括元素下的`<group>`元素。我以不同的方式处理这些文件中的每一种，所以这个功能是不可取的。

我想到了两种解决方案：

1.  `<notification>`获取文件元素的父元素并进行相应的处理（取决于是`<group>`.
2.  重命名第二个`<file>`元素以避免混淆。

这些解决方案都不像只是让事物保持原样并仅获取`<file>`元素的直接子`<notification>`元素那样可取。

我对**IMPO**的评论和关于“最佳”方法的回答持开放态度，但我对*DOM*解决方案非常感兴趣，因为这是该项目的其余部分正在使用的。谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-20T13:28:12.110

我意识到您在 5 月找到了解决此问题的方法@kentcdodds，但我现在发现了一个非常相似的问题，我认为（可能在我的用例中，但不是在您的用例中），一个解决方案。

我的 XML 格式的一个非常简单的示例如下所示：-

```
<?xml version="1.0" encoding="utf-8"?>
<rels>
    <relationship num="1">
        <relationship num="2">
            <relationship num="2.1"/>
            <relationship num="2.2"/>
        </relationship>
    </relationship>
    <relationship num="1.1"/>
    <relationship num="1.2"/>

</rels> 
```

正如您希望从这个片段中看到的那样，我想要的格式可以对 [relationship] 节点进行 N 级嵌套，所以很明显，我使用 Node.getChildNodes() 遇到的问题是我从所有级别获取所有节点层次结构，并且没有任何关于节点深度的提示。

看了一会儿**[API](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Node.html)**，我注意到实际上还有另外两种可能有用的方法：-

*   [Node.getFirstChild()](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Node.html#getFirstChild%28%29)
*   [Node.getNextSibling()](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Node.html#getNextSibling%28%29)

总之，这两种方法似乎提供了获取节点的所有直接后代元素所需的一切。下面的 jsp 代码应该给出一个关于如何实现它的相当基本的想法。对不起JSP。我现在将它滚动到一个 bean 中，但没有时间从挑选出来的代码创建一个完全工作的版本。

```
<%@page import="javax.xml.parsers.DocumentBuilderFactory,
                javax.xml.parsers.DocumentBuilder,
                org.w3c.dom.Document,
                org.w3c.dom.NodeList,
                org.w3c.dom.Node,
                org.w3c.dom.Element,
                java.io.File" %><% 
try {

    File fXmlFile = new File(application.getRealPath("/") + "/utils/forms-testbench/dom-test/test.xml");
    DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
    DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
    Document doc = dBuilder.parse(fXmlFile);
    doc.getDocumentElement().normalize();

    Element docEl = doc.getDocumentElement();       
    Node childNode = docEl.getFirstChild();     
    while( childNode.getNextSibling()!=null ){          
        childNode = childNode.getNextSibling();         
        if (childNode.getNodeType() == Node.ELEMENT_NODE) {         
            Element childElement = (Element) childNode;             
            out.println("NODE num:-" + childElement.getAttribute("num") + "<br/>\n" );          
        }       
    }

} catch (Exception e) {
    out.println("ERROR:- " + e.toString() + "<br/>\n");
}

%> 
```

此代码将给出以下输出，仅显示初始根节点的直接子元素。

```
NODE num:-1
NODE num:-1.1
NODE num:-1.2 
```

希望这对某人有所帮助。为最初的帖子干杯。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-21T17:58:27.557

您可以为此使用 XPath，使用两条路径来获取它们并以不同方式处理它们。

获取`<file>`节点的直接子节点`<notification>`use`//notification/file`和那些正在`<group>`使用的节点`//groups/group/file`。

这是一个简单的示例：

```
public class SO10689900 {
    public static void main(String[] args) throws Exception {
        DocumentBuilder db = DocumentBuilderFactory.newInstance().newDocumentBuilder();
        Document doc = db.parse(new InputSource(new StringReader("<notifications>\n" + 
                "  <notification>\n" + 
                "    <groups>\n" + 
                "      <group name=\"zip-group.zip\" zip=\"true\">\n" + 
                "        <file location=\"C:\\valid\\directory\\\" />\n" + 
                "        <file location=\"C:\\this\\file\\doesn't\\exist.grr\" />\n" + 
                "        <file location=\"C:\\valid\\file\\here.txt\" />\n" + 
                "      </group>\n" + 
                "    </groups>\n" + 
                "    <file location=\"C:\\valid\\file.txt\" />\n" + 
                "    <file location=\"C:\\valid\\file.xml\" />\n" + 
                "    <file location=\"C:\\valid\\file.doc\" />\n" + 
                "  </notification>\n" + 
                "</notifications>")));
        XPath xpath = XPathFactory.newInstance().newXPath();
        XPathExpression expr1 = xpath.compile("//notification/file");
        NodeList nodes = (NodeList)expr1.evaluate(doc, XPathConstants.NODESET);
        System.out.println("Files in //notification");
        printFiles(nodes);

        XPathExpression expr2 = xpath.compile("//groups/group/file");
        NodeList nodes2 = (NodeList)expr2.evaluate(doc, XPathConstants.NODESET);
        System.out.println("Files in //groups/group");
        printFiles(nodes2);
    }

    public static void printFiles(NodeList nodes) {
        for (int i = 0; i < nodes.getLength(); ++i) {
            Node file = nodes.item(i);
            System.out.println(file.getAttributes().getNamedItem("location"));
        }
    }
} 
```

它应该输出：

```
Files in //notification
location="C:\valid\file.txt"
location="C:\valid\file.xml"
location="C:\valid\file.doc"
Files in //groups/group
location="C:\valid\directory\"
location="C:\this\file\doesn't\exist.grr"
location="C:\valid\file\here.txt" 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-05-21T18:22:34.990

嗯，这个问题的 DOM 解决方案实际上非常简单，即使它不是太优雅。

当我遍历`filesNodeList`调用时返回的 时`notificationElement.getElementsByTagName("file")`，我只是检查父节点的名称是否为“通知”。如果不是，那么我将忽略它，因为这将由`<group>`元素处理。这是我的代码解决方案：

```
for (int j = 0; j < filesNodeList.getLength(); j++) {
  Element fileElement = (Element) filesNodeList.item(j);
  if (!fileElement.getParentNode().getNodeName().equals("notification")) {
    continue;
  }
  ...
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-21T18:24:27.700

如果你坚持使用 DOM API

```
NodeList nodeList = doc.getElementsByTagName("notification")
    .item(0).getChildNodes();

// get the immediate child (1st generation)
for (int i = 0; i < nodeList.getLength(); i++)
    switch (nodeList.item(i).getNodeType()) {
        case Node.ELEMENT_NODE:

            Element element = (Element) nodeList.item(i);
            System.out.println("element name: " + element.getNodeName());
            // check the element name
            if (element.getNodeName().equalsIgnoreCase("file"))
            {

                // do something with you "file" element (child first generation)

                System.out.println("element name: "
                    + element.getNodeName() + " attribute: "
                    + element.getAttribute("location"));

            }
    break;

} 
```

我们的第一个任务是获取元素“Notification”（在本例中为第一个 -item (0)-）及其所有子元素：

```
NodeList nodeList = doc.getElementsByTagName("notification")
    .item(0).getChildNodes(); 
```

（稍后您可以使用获取所有元素来处理所有元素）。

对于“通知”的每个孩子：

```
for (int i = 0; i < nodeList.getLength(); i++) 
```

您首先获取它的类型以查看它是否是一个元素：

```
switch (nodeList.item(i).getNodeType()) {
    case Node.ELEMENT_NODE:
        //.......
        break;  
} 
```

如果是这样，那么你得到了你的孩子的“文件”，而不是孙子的“通知”

您可以查看它们：

```
if (element.getNodeName().equalsIgnoreCase("file"))
{

    // do something with you "file" element (child first generation)

    System.out.println("element name:"
        + element.getNodeName() + " attribute: "
        + element.getAttribute("location"));

} 
```

输出是：

```
element name: file
element name:file attribute: C:\valid\file.txt
element name: file
element name:file attribute: C:\valid\file.xml
element name: file
element name:file attribute: C:\valid\file.doc 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-10-25T19:38:05.303

我在我的一个项目中遇到了同样的问题，并编写了一个小函数，它将返回一个`List<Element>`只包含直系子级的函数。基本上它检查返回的每个节点`getElementsByTagName`是否它的 parentNode 实际上是我们正在搜索子节点的节点：

```
public static List<Element> getDirectChildsByTag(Element el, String sTagName) {
        NodeList allChilds = el.getElementsByTagName(sTagName);
        List<Element> res = new ArrayList<>();

        for (int i = 0; i < allChilds.getLength(); i++) {
            if (allChilds.item(i).getParentNode().equals(el))
                res.add((Element) allChilds.item(i));
        }

        return res;
    } 
```

如果有一个名为“通知”的子节点，kentcdodds 接受的答案将返回错误的结果（例如孙子） - 例如，当元素“组”的名称为“通知”时返回孙子。我在我的项目中遇到了这种设置，这就是我想出我的功能的原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-26T04:33:28.617

我遇到了一个相关问题，即使所有“文件”节点的处理方式相似，我也只需要处理直接子节点。对于我的解决方案，我将元素的父节点与正在处理的节点进行比较，以确定元素是否是直接子节点。

```
NodeList fileNodes = parentNode.getElementsByTagName("file");
for(int i = 0; i < fileNodes.getLength(); i++){
            if(parentNode.equals(fileNodes.item(i).getParentNode())){
                if (fileNodes.item(i).getNodeType() == Node.ELEMENT_NODE) {

                    //process the child node...
                }
            }
        } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-06T21:03:12.677

我写了这个函数来通过tagName获取节点值，限制到顶层

```
public static String getValue(Element item, String tagToGet, String parentTagName) {
    NodeList n = item.getElementsByTagName(tagToGet);
    Node nodeToGet = null;
    for (int i = 0; i<n.getLength(); i++) {
        if (n.item(i).getParentNode().getNodeName().equalsIgnoreCase(parentTagName)) {
            nodeToGet = n.item(i);
        }
    }
    return getElementValue(nodeToGet);
}

public final static String getElementValue(Node elem) {
    Node child;
    if (elem != null) {
        if (elem.hasChildNodes()) {
            for (child = elem.getFirstChild(); child != null; child = child
                    .getNextSibling()) {
                if (child.getNodeType() == Node.TEXT_NODE) {
                    return child.getNodeValue();
                }
            }
        }
    }
    return "";
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-28T19:39:21.587

我最终在 Kotlin 中创建了一个扩展函数来做到这一点

```
fun Element.childrenWithTagName(name: String): List<Node> = childNodes
    .asList()
    .filter { it.nodeName == name } 
```

调用者可以像这样使用它：

```
val meta = target.newChildElement("meta-coverage")
source.childrenWithTagName("counter").forEach {
    meta.copyElementWithAttributes(it)
} 
```

作为列表实现：

```
 fun NodeList.asList(): List<Node> = InternalNodeList(this)

private class InternalNodeList(
    private val list: NodeList,
    override val size: Int = list.length
) : RandomAccess, AbstractList<Node>() {
    override fun get(index: Int): Node = list.item(index)
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-11-27T12:19:19.863

有一个不错的 LINQ 解决方案：

```
For Each child As XmlElement In From cn As XmlNode In xe.ChildNodes Where cn.Name = "file"
    ...
Next 
```

# php - 从 JSON 字符串中提取/解码变量

> ID：10689908
> 
> 赞同：1
> 
> 时间：2012-05-21T17:37:20.847
> 
> 标签：php, json, facebook-graph-api

> **可能重复：**
> [如何在 PHP 中解码 JSON 字符串？](https://stackoverflow.com/questions/1268792/how-to-decode-a-json-string-in-php)

我想`'name'`从 json 字符串中提取变量`$jsonstring`；

```
<?php

$facebookid = $_GET['fbid'];
$facebooklink = 'http://graph.facebook.com/'.$facebookid.'?fields=name';

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $facebooklink);
curl_setopt($ch, CURLOPT_HEADER, 0);
$jsonstring = curl_exec($ch);
curl_close($ch);

?> 
```

`$jsonstring`将输出如下内容：

```
{
   "name": "THIS PART IS WHAT I WANT",
   "id": "4"
} 
```

我想从上面的例子中提取“这部分是我想要的”。

我曾尝试使用 json_decode 但无法使其正常工作，此后我删除了该代码，因此无法在此处编写。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T17:40:49.873

尝试

```
ob_start();
$facebookid = $_GET['fbid'];
$facebooklink = 'http://graph.facebook.com/'.$facebookid.'?fields=name';

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $facebooklink);
curl_setopt($ch, CURLOPT_HEADER, 0);
$jsonstring = curl_exec($ch);
curl_close($ch);
$bufferstr = ob_get_contents();
ob_end_clean();
$json = json_decode($bufferstr);
echo $json->name; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:44:12.467

尝试：

```
<?php
  $foo = json_decode( $jsonstring);
  $name = $foo->name; 
  //echo $name;
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T17:44:12.777

尝试这个

```
$json_obj = json_decode($jsonstring );
echo $json_obj->name; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T17:40:21.360

```
<?php
    $json = '{"foo-bar": 12345}';

    $obj = json_decode($json);
    print $obj->{'foo-bar'}; // 12345
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T17:43:28.533

如果您的 php 版本中没有“json_decode”，您应该使用正则表达式。

```
<?php

$name = json_decode( $jsonstring )->name;

?> 
```

# r - gWidgetsWWW 错误

> ID：10689909
> 
> 赞同：1
> 
> 时间：2012-05-21T17:37:40.217
> 
> 标签：r, gwidgets

我正在尝试从小`gWidgetsWWW`插图运行以下示例。

```
library(gWidgetsWWW)    
localServerOpen("/Examples/ex-simple-gui.R", package="gWidgetsWWW") 
```

应该会打开一个新的浏览器窗口，但我不断收到此错误：

```
Error in get("..gWidgets_sessionEnv", envir = .GlobalEnv) : 
  object '..gWidgets_sessionEnv' not found 
```

关于应该做些什么来避免上述错误的任何提示？

# xsd - 如何将 complexType 限制为 XML Schema 中的特定值？

> ID：10689911
> 
> 赞同：1
> 
> 时间：2012-05-21T17:37:55.677
> 
> 标签：xsd, composition, restriction

我正在尝试在 XML Schema 中进行某种形式的组合限制。

我有一个`complexType`在其他几个中重复使用`complexTypes`。我想指定包含在 中`FieldA`时必须是一个值，`PartialType`而包含在 中时必须是`FullTypeA`不同的值`FullTypeB`。

```
<xs:complexType name="PartialType">
    <xs:sequence>
        <xs:element name="FieldA" type="xs:unsignedShort" />
        <xs:element name="FieldB" type="xs:unsignedShort" />
    </xs:sequence>
</xs:complexType>

<!-- FieldA must be 1 for FullTypeA-->
<xs:complexType name="FullTypeA">
    <xs:sequence>
        <xs:element ref="PartialType" />
        <xs:element name="FieldC" type="xs:unsignedShort" />
    </xs:sequence>
</xs:complexType>

<!-- FieldA must be 2 for FullTypeB-->
<xs:complexType name="FullTypeB">
    <xs:sequence>
        <xs:element ref="PartialType" />
        <xs:element name="FieldD" type="xs:unsignedShort" />
    </xs:sequence>
</xs:complexType> 
```

我应该如何构建我的 XML 模式以适应这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T18:21:37.843

我认为 Xsd 并不允许这样做。

实现这一目标的一种可能方法是使用`xs:restriction`

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:complexType name="PartialType">
        <xs:sequence>
            <xs:element name="FieldA" type="xs:unsignedShort" />
            <xs:element name="FieldB" type="xs:unsignedShort" />
            <xs:choice>
                <xs:element name="FieldC" type="xs:unsignedShort" />
                <xs:element name="FieldD" type="xs:unsignedShort" />
            </xs:choice>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="FullTypeA">
        <xs:complexContent>
            <xs:restriction base="PartialType">
                <xs:sequence>
                    <xs:element name="FieldA" type="xs:unsignedShort" fixed="1" />
                    <xs:element name="FieldB" type="xs:unsignedShort" />
                    <xs:element name="FieldC" type="xs:unsignedShort" />
                </xs:sequence>
            </xs:restriction>
        </xs:complexContent>
    </xs:complexType>

    <xs:complexType name="FullTypeB">
        <xs:complexContent>
            <xs:restriction base="PartialType">
                <xs:sequence>
                    <xs:element name="FieldA" type="xs:unsignedShort" fixed="2" />
                    <xs:element name="FieldB" type="xs:unsignedShort" />
                    <xs:element name="FieldD" type="xs:unsignedShort" />
                </xs:sequence>
            </xs:restriction>
        </xs:complexContent>
    </xs:complexType>

</xs:schema> 
```

**这样做的缺点很明显：您必须在*PartialType*中声明所有元素。**

另一种方法是使用`xs:extension`

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:complexType name="PartialType">
        <xs:sequence>
            <xs:element name="FieldB" type="xs:unsignedShort" />
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="FullTypeA">
        <xs:complexContent>
            <xs:extension base="PartialType">
                <xs:sequence>
                    <xs:element name="FieldA" type="xs:unsignedShort" fixed="1" />
                    <xs:element name="FieldB" type="xs:unsignedShort" />
                    <xs:element name="FieldC" type="xs:unsignedShort" />
                </xs:sequence>
            </xs:extension>
        </xs:complexContent>
    </xs:complexType>

    <xs:complexType name="FullTypeB">
        <xs:complexContent>
            <xs:extension base="PartialType">
                <xs:sequence>
                    <xs:element name="FieldA" type="xs:unsignedShort" fixed="2" />
                    <xs:element name="FieldB" type="xs:unsignedShort" />
                    <xs:element name="FieldD" type="xs:unsignedShort" />
                </xs:sequence>
            </xs:extension>
        </xs:complexContent>
    </xs:complexType>

</xs:schema> 
```

# javascript - 保持客户端库和 npm 包同步

> ID：10689914
> 
> 赞同：0
> 
> 时间：2012-05-21T17:38:13.293
> 
> 标签：javascript, node.js, testing, client-side, server-side

我试图让我的客户端和服务器端测试库保持同步（特别是 mocha、chai、sinon 和 coffee-script）。

现在我在想唯一的解决方案可能是使用符号链接到 node_modules 下的文件。还有其他想法吗？谢谢！

阿比克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:04:13.207

除了将客户端代码导入 Node.js 模块之外，您还可以使用 Browserify 之类的工具从 Node.js 模块创建客户端代码。不过，这些 Node.js 模块必须针对浏览器进行优化。

# ruby-on-rails-3 - Rails 3 路由：资源和路径

> ID：10689917
> 
> 赞同：1
> 
> 时间：2012-05-21T17:38:19.473
> 
> 标签：ruby-on-rails-3, rails-routing

我的 Rails 应用程序中有以下路线：

```
resources :settings, :path => :account, :only => [:edit, :update] 
```

这将创建以下内容：

```
edit_setting GET    /account/:id/edit(.:format) settings#edit
setting PUT    /account/:id(.:format) settings#update 
```

我如何写它所以`:id`省略？

所以用户可以访问`/account/edit`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T18:28:30.460

这可能是最直接的方法，并让您接近 Rails 约定：

```
match 'account/edit'  => 'accounts#edit',   :as => 'edit_account',  :via => :get
match 'accounts'      => 'accounts#update', :as => 'accounts',      :via => :put 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T11:04:29.317

有关详细信息，请参阅[http://guides.rubyonrails.org/routing.html#singular-resources](http://guides.rubyonrails.org/routing.html#singular-resources)，但我很确定`resource :settings, :path => :account, :only => [:edit, :update]`会起作用。

# c++ - 自定义结构化存储 IPropertySetStorage

> ID：10689929
> 
> 赞同：1
> 
> 时间：2012-05-21T17:38:53.293
> 
> 标签：c++, com, structured-storage

我正在尝试将 a 添加[`IPropertySetStorage`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379840%28v=vs.85%29.aspx)到现有[`IStorage`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa380015%28v=vs.85%29.aspx)文件中。我计划编写的属性及其值将根据我的设计进行定制（我可能会存储一些整数、一些字符串等）。我不试图符合任何现有的`IStorage`文件类型。

API 及其文档感觉是针对现有文件格式的。这是惯例，因此（到目前为止）我发现的示例只是令人困惑。

问题）

在[`IPropertySetStorage::Create`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379849%28v=vs.85%29.aspx)

1.  （参数 1）`FMTID`我会通过什么？数据字段上可以全为零吗？我可以弥补吗？
2.  （参数 2）CLSID 可以是`nullptr`? 如果不是，应该是什么？我需要弄清楚父母`IStorage`使用了什么值吗？
3.  （参数 3）最好的 propset 标志是什么？我在想，因为我将存储字符串，我应该使用`PROPSETFLAG_DEFAULT`.
4.  （参数 4）`IStorage`句柄已打开以供读取（我正在像现有运行时的插件一样运行）。我现在最好的猜测是使用`STGM_DIRECT | STGM_READWRITE | STGM_SHARE_EXCLUSIVE | STGM_CREATE`. 但我一直在[`STG_E_INVALIDFLAG`](http://msdn.microsoft.com/en-us/library/cc704587%28v=prot.10%29.aspx)

请注意，到目前为止，我还无法创建一个新`IPropertySetStorage`的`IStorage`，但我已经成功创建了一个 custom `IStream`，并在以后打开时从中读取。

任何与我正在做的事情更相关的教程链接将不胜感激。

**编辑**请注意，我的代码是从现有应用程序调用的，处理现有文件。当我的代码被调用时，我传递了文件的 root `IStorage`。这是我所有具有该`IStorage`基础的代码。

```
rootStg->OpenStorage(name, nullptr, STGM_READ | STGM_SHARE_EXCLUSIVE, nullptr, 0, &spIStg);
spIStg->QueryInterface(IID_IPropertySetStorage, reinterpret_cast<void**>(&pPropSetStg));    

pPropSetStg->Create(
  ::FMTID_UserDefinedProperties, 
  nullptr, 
  PROPSETFLAG_DEFAULT, 
  STGM_CREATE|STGM_READWRITE|STGM_DIRECT|STGM_SHARE_EXCLUSIVE , 
  &pPropStg); 
```

正如我在 #4 中指出的那样，它返回[`STG_E_INVALIDFLAG`](http://msdn.microsoft.com/en-us/library/cc704587%28v=prot.10%29.aspx).

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:44:09.377

（特别感谢@Xearinox）

当我粘贴所有相关代码时，我注意到我正在以 READ 模式打开我的存储（我首先创建一个子存储来存放我的零件），而不是 RW（RW 在创建时，但不是在它已经存在时）。这导致道具集的创建失败。

```
// see STGM_READWRITE (fix)
rootStg->OpenStorage(name, nullptr, STGM_READWRITE | STGM_SHARE_EXCLUSIVE, nullptr, 0, &spIStg);
spIStg->QueryInterface(IID_IPropertySetStorage, reinterpret_cast<void**>(&pPropSetStg));    

pPropSetStg->Create(
  ::FMTID_UserDefinedProperties, 
  nullptr, 
  PROPSETFLAG_DEFAULT, 
  STGM_CREATE|STGM_READWRITE|STGM_DIRECT|STGM_SHARE_EXCLUSIVE , 
  &pPropStg); 
```

# ios - iOS中自动续订订阅背后的逻辑是什么

> ID：10689931
> 
> 赞同：16
> 
> 时间：2012-05-21T17:39:09.063
> 
> 标签：ios, in-app-purchase, subscription

我正在与客户合作构建一个使用自动续订订阅的报亭应用程序。我似乎无法找出正确的逻辑。我了解应用内购买，但以前从未搞砸过订阅。

我似乎无法全神贯注地跟踪这一点。似乎苹果希望这尽可能地困难。

我想要一个应用程序，每月提供一本新杂志作为单一的非消耗性购买，或者允许他们订阅。

我了解在购买订阅时验证收据的概念，但之后会发生什么？应用程序是否在每次启动时都会重新检查订阅以查看订阅是否是最新的？初次购买后，续订收据从何而来？

我查看了 Urban Airship，它似乎为您跟踪了这一点 - 但我没有找到用于实现订阅的示例应用程序或教程。还有其他类似的服务吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-22T18:21:48.153

> 我想要一个应用程序，每月提供一本新杂志作为单一的非消耗性购买，或者允许他们订阅。

我认为 Apple 正是针对您的情况创建了可自动更新的应用内购买。自动更新的类比是杂志订阅，订阅在每个订阅期结束时更新。例如，您可能订阅了一年的 NYTimes，订阅结束时，NYTimes 会向您收取另一年的费用以继续订阅。

同样，使用 iTunes 自动更新，Apple 将在订阅到期时向订阅用户收费，除非用户在到期前取消订阅。为了正常工作，您（开发人员）需要先与 iTunes 核对用户的订阅是否仍然有效，然后才能授予他们访问当前月份报摊内容的权限。换句话说，您在验证用户的订阅收据后解锁内容。

在从 Apple 获取用户当前收据后，您将从 iTunes 获取的用户当前收据存储在某处（例如 NSUserDefaults）。要验证用户的收据是否仍然有效，您需要将存储的收据提交给苹果进行验证。

顺便说一句，您应该有一种方法让用户从您的应用程序中恢复他们的收据——以防他们有新设备或从头开始重新安装您的应用程序。

我同意 Apple 的文档还有很多不足之处。我们花了几个星期的繁琐工作才让我们的应用程序正常工作。看起来其他人也花费了相似的时间来使他们的工作也有效。因此，如果您不能花时间学习它，请花时间或外包此任务。

查看[应用内编程指南](https://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/Introduction/Introduction.html)，了解事物应该如何工作的描述。2011 年 WWDC 的两个应用内购买视频：“iOS 和 Mac OS X 的应用内购买”和“应用发布中的新功能”也对我们有所帮助。

其他有用的链接包括：

1.  [自动更新订阅的有限世界](http://www.marco.org/2012/01/06/autorenewable-subscription-restrictions)，
2.  [应用内购买：完整演练](http://troybrant.net/blog/2010/01/in-app-purchases-a-full-walkthrough/)，
3.  使用 PHP和[cURL 验证 Apple App Store 收据以进行应用内购买](http://ios.biomsoft.com/2011/09/18/verifying-apple-app-store-receipts-for-in-app-purchases-with-php-and-curl/)
4.  [所有关于应用内购买第 3 部分：反盗版措施](http://gamesfromwithin.com/in-app-purchases-part-3)。

您将需要最后一个链接中的代码 -createEncodedString 方法来正确地将您的收据提交到服务器进行验证。

通过这些链接，我希望我已经为您节省了大量的研究和反复试验，以使您的工作正常进行。祝你好运。

# php - 如何使用 PHP SDK 和 Graph API 将事件发布到 Facebook 粉丝专页？

> ID：10689932
> 
> 赞同：5
> 
> 时间：2012-05-21T17:39:09.253
> 
> 标签：php, facebook-graph-api, facebook-php-sdk

以下代码有效，但它以当前登录的页面管理员身份创建事件。我需要它将活动发布到粉丝页面本身。仅供参考：我的应用已被授予权限范围：`manage_pages`

```
<?php

// Initialize a Facebook instance from the PHP SDK
$config = array(
  'appId' => FACEBOOK_APP_ID,
  'secret' => FACEBOOK_APP_SECRET,
  'cookie' => false,
  'scope' => 'manage_pages,create_event'
);

$facebook = new Facebook($config);

$access_token = $facebook->getAccessToken();

$page_id = 'XXXXXXXXXXXX';

// Now, getting the PAGE Access token, using the user access token

$page_token_url = "https://graph.facebook.com/$page_id?fields=access_token&" . $access_token;
$response = file_get_contents($page_token_url);

// Parse the return value and get the Page access token
$resp_obj = json_decode($response,true);

$page_access_token = $resp_obj['access_token'];

// Declare the variables we'll use to demonstrate
// the new event-management APIs
$event_id = 0;
$event_name = "New Event API Test Event";
$event_start = time() + rand(1, 100) * rand(24, 64) * 3600;
$event_privacy = "SECRET"; // We'll make it secret so we don't annoy folks.

// We'll create an event in this example.
// We'll need create_event permission for this.
$params = array(
  'name' => $event_name,
  'start_time' => $event_start,
  'privacy_type' => $event_privacy,
  'access_token' => $page_access_token,
  'page_id' => $page_id //where $page_id is the ID of the page you are managing
);

// Create an event
$ret_obj = $facebook->api("/$page_id/events", 'POST', $params);
if(isset($ret_obj['id'])) {
  // Success
  $event_id = $ret_obj['id'];
  printMsg('Event ID: ' . $event_id);
} else {
  printMsg("Couldn't create event.");
}

// Convenience method to print simple pre-formatted text.
function printMsg($msg) {
   echo "<pre>$msg</pre>";
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-18T19:31:02.997

答案在这里： [Facebook PHP API，在页面上发布事件](https://stackoverflow.com/questions/5344622/facebook-php-api-post-an-event-on-a-page)

为方便起见，复制如下：

我认为您需要页面 access_token 以及如何获取它：

```
$page_id = "XXXXXXXXX";
$page_access_token = "";
$result = $facebook->api("/me/accounts");
foreach($result["data"] as $page) {
    if($page["id"] == $page_id) {
        $page_access_token = $page["access_token"];
        break;
    }
} 
```

确保您授予 manage_pages 权限并将 access_token 添加到 $event_info 数组。

# java - Java中静态变量的使用

> ID：10689934
> 
> 赞同：2
> 
> 时间：2012-05-21T17:39:21.840
> 
> 标签：java

我知道静态变量只在加载类时创建和初始化一次，而不是每个对象。

在下面给出的代码中，我想要做的是：我在类 A 中将一个 int 变量“a”声明为静态，并为其赋值 5。当 main 执行时，我将其值更改为 6，并使程序无限循环。所以目前“a”值为6。

现在我尝试做的是，当 A 类仍在循环时，我尝试从其他类 B 访问此变量，并且我希望在运行 B 类时应该打印 6（因为当我运行 B 类“a”值时）改为 6) 但令人惊讶的是它仍然给了我 5。

即使我将“a”声明为静态，为什么会发生这种情况？无法弄清楚这种方法有什么问题。

```
class A{
    static int a=5;

    public static void main(String args[]){
        System.out.println(A.a+"");
        a=6;
        while(true){
        }
    }
}

class B{    
    public static void main(String args[]){
        System.out.println(A.a+"");
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T17:50:41.493

您遇到的问题是您正在运行两个不同的 JVM 进程。您应该做的是在自己的线程中运行每个“主要”方法。这样他们共享（因此可以修改）相同的内存。这是您修改为使用线程的示例：

```
public class Main{
    public static int v = 5;

    public static void main(String[] args) throws Exception{
        new Thread(new A()).start();
        Thread.sleep(5000);
        new Thread(new B()).start();
    }
}

class A implements Runnable{
    public void run(){
        System.out.println(Main.v);
        Main.v = 6;
    }
}

class B implements Runnable{
    public void run(){
        System.out.println(Main.v);
    }
} 
```

旁注：虽然这个例子确实展示了这个问题的预期，但在编写一个使用多线程的*正确*Java 程序方面仍然存在很多问题。做你的研究。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:44:25.353

您正在运行两个 java 进程和两个程序。第二个类加载器加载`class A`并将其静态变量设置为 5，但没有调用`class B`调用其中定义的`class A`将其增加到 6 的静态 main() 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T17:41:04.243

你从来没有真正在 A 中运行主循环。

只需制作一种方法来更改值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T17:42:21.763

那是因为 A 的 main 方法永远不会被调用。

# php - Youtube 和 Vimeo 使用 PCRE 正则表达式嵌入代码解析器

> ID：10689935
> 
> 赞同：0
> 
> 时间：2012-05-21T17:39:23.340
> 
> 标签：php, regex

我一直在研究 Youtube 和 Vimeo 嵌入代码解析器，我试图通过使用正则表达式来解决问题。

我发现了两种模式，它们正在使用 eregi() 函数，但不幸的是不适用于 preg_match()。给出“分隔符不能是字母数字或反斜杠”错误。

如何将这些模式从 POSIX 转换为 PCRE？

对于 Youtube；

```
\/v\/(.{11})|\/embed\/(.{11}) 
```

对于 Vimeo；

```
player\.vimeo\.com\/video/([0-9]*)" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T17:43:03.743

我发现[这个](https://stackoverflow.com/questions/5830387/php-regex-find-all-youtube-video-ids-in-string/5831191#5831191)对我帮助开发的网站很有帮助。感谢并感谢[ridgerunner](https://stackoverflow.com/users/433790/ridgerunner)。

```
// Linkify youtube URLs which are not already links.
function linkifyYouTubeURLs($text) {
    $text = preg_replace('~
        # Match non-linked youtube URL in the wild. (Rev:20111012)
        https?://         # Required scheme. Either http or https.
        (?:[0-9A-Z-]+\.)? # Optional subdomain.
        (?:               # Group host alternatives.
          youtu\.be/      # Either youtu.be,
        | youtube\.com    # or youtube.com followed by
          \S*             # Allow anything up to VIDEO_ID,
          [^\w\-\s]       # but char before ID is non-ID char.
        )                 # End host alternatives.
        ([\w\-]{11})      # $1: VIDEO_ID is exactly 11 chars.
        (?=[^\w\-]|$)     # Assert next char is non-ID or EOS.
        (?!               # Assert URL is not pre-linked.
          [?=&+%\w]*      # Allow URL (query) remainder.
          (?:             # Group pre-linked alternatives.
            [\'"][^<>]*>  # Either inside a start tag,
          | </a>          # or inside <a> element text contents.
          )               # End recognized pre-linked alts.
        )                 # End negative lookahead assertion.
        [?=&+%\w-]*        # Consume any URL (query) remainder.
        ~ix', 
        '<a href="http://www.youtube.com/watch?v=$1">YouTube link: $1</a>',
        $text);
    return $text;
} 
```

您应该能够从那里删除您需要的内容，并且它可以处理所有样式的 YouTube 链接。Vimeo 从那里开始不应该太难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:58:39.367

这是给 youtube 的：`$pattern = '/\/v\/(.{11})|\/embed\/(.{11})/';`

那是给 Vimeo 的：`$pattern = '/player\.vimeo\.com\/video\/([0-9]*)/';`

使用 PCRE 时，请确保将表达式括在`/expression/`（斜杠）中，并转义所有`/`. 我注意到你有时会，有时你不会...

# ruby-on-rails - RoR 显示没有冗余信息的电子邮件

> ID：10689941
> 
> 赞同：0
> 
> 时间：2012-05-21T17:39:49.113
> 
> 标签：ruby-on-rails, ruby-on-rails-3, email, email-headers, mailman-gem

我在我的 RoR 项目中使用 Mailman

我想接收邮件并显示正文.....但是格式错误

我收到邮件并想将其另存为文本

```
message = message.body.encoded 
```

这样可行！！！

但输出不仅是邮件的正文，它还包括更多信息，如

```
f46d04451843a6499e04c08f212a Date: Mon, 21 May 2012 19:29:19 +0200 Mime-Version: 1.0 Content-Type: text/plain; charset=ISO-8859-1 Content-Transfer-Encoding: 7bit Content-ID: <4fba7b6fa56a0_1e194c540145299d@ubuntu.mail> 
```

但我不想显示像 Mime、Date 之类的信息.... 有人可以告诉我如何只获取电子邮件的正文或如何删除其他信息吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T09:20:49.167

尝试

> message = message.text_part.body.decoded

# javascript - javascript数组推送匿名函数失败

> ID：10689943
> 
> 赞同：0
> 
> 时间：2012-05-21T17:40:11.983
> 
> 标签：javascript, push

这是我今天遇到的一件事。

行

```
[].push(
  function() {return 1;},
); 
```

不好

```
[].push(
  function() {return 1;},
  function() {return 1;},
); 
```

有人知道这里发生了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T17:43:30.560

只要最后一个参数后没有逗号，两者都可以正常工作：

```
[].push(
  function() {return 1;},
  function() {return 1;}
); 
```

# php - 在 PHP 中从 EXEC 运行“git pull”

> ID：10689949
> 
> 赞同：2
> 
> 时间：2012-05-21T17:40:48.597
> 
> 标签：php, windows, git, xampp, exec

我正在尝试使用 PHP`exec`在 windows running 上运行来自 git 的拉取请求`XAmpp`。`exec`当使用or运行下面的脚本`system`并尝试访问该文件时，页面永远不会停止加载。我检查了目录的文件权限，它们都是 0777。`git status`运行正常。不确定是什么问题。

```
<?php
ignore_user_abort(true);
set_time_limit(15);
exec('git pull origin master', $o);
echo implode("\n", $o);
?> 
```

更新帐户上没有密码：

```
C:\xampp\htdocs>git pull origin master
From github.com:************
 * branch            master     -> FETCH_HEAD
Already up-to-date.

C:\xampp\htdocs> 
```

从终端运行我得到：

```
C:\xampp\htdocs>php -f update.php
PHP Warning:  PHP Startup: ming: Unable to initialize module
Module compiled with build ID=API20090626,TS,VC6
PHP    compiled with build ID=API20090626,TS,VC9
These options need to match
 in Unknown on line 0

Warning: PHP Startup: ming: Unable to initialize module
Module compiled with build ID=API20090626,TS,VC6
PHP    compiled with build ID=API20090626,TS,VC9
These options need to match
 in Unknown on line 0
From github.com:*********
 * branch            master     -> FETCH_HEAD
Already up-to-date.
C:\xampp\htdocs> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T20:24:50.413

Instead of using `exec`, which waits until the process is finished, use `passthru` and make sure you disabled output buffering. This way you'll immediately see what the problem is.

# java - 如何在android中过滤自定义ListAdapter？

> ID：10689952
> 
> 赞同：1
> 
> 时间：2012-05-21T17:41:01.483
> 
> 标签：java, android

我进行了很多搜索，但没有任何解决方案对我有用。我正在设置一个自定义 arrayadapter，它有一个 imageview 和一个 textview。我保留了一个编辑文本，我想在其中添加文本，并且我希望通过这些给定文本过滤列表，当我使用字符串类型数组适配器时，这很好用，但它在我的自定义适配器中不起作用，这是我的代码：

```
public class CurrenciesFrom extends Activity implements OnItemClickListener {

    ListView lvCurrencies;
    String[] countryCode = { "BDT Bangladesh","BBF bafa" ,"USD America", "UMK Umaka","KRW Korea",
            "INR India" };
    int[] flag = { R.drawable.bdt, R.drawable.usd, R.drawable.aud,
            R.drawable.ic_launcher ,R.drawable.usd, R.drawable.aud};
    ArrayAdapter<Currency> adapter;
    List<Currency> l;
    EditText etsearch;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.currencies);
        initializer();
        lvCurrencies.setAdapter(adapter);
        lvCurrencies.setOnItemClickListener(this);
        etsearch.addTextChangedListener(new TextWatcher() {

            @Override
            public void onTextChanged(CharSequence s, int start, int before, int count) {
                // TODO Auto-generated method stub

            }

            @Override
            public void beforeTextChanged(CharSequence s, int start, int count,
                    int after) {
                // TODO Auto-generated method stub

            }

            @Override
            public void afterTextChanged(Editable s) {
                // TODO Auto-generated method stub

                CurrenciesFrom.this.adapter.getFilter().filter(s.toString());
            }
        });
    }

    private List<Currency> getModel() {
        List<Currency> list = new ArrayList<Currency>();
        for (int i = 0; i < countryCode.length; i++) {

            list.add(get(countryCode[i], flag[i]));
        }

        list.get(1).setSelected(true); // select one item by default
        return list;
    }

    private Currency get(String s, int place) {
        return new Currency(s, place);
    }

    private void initializer() {

        lvCurrencies = (ListView) findViewById(R.id.lvCurrencies);
        etsearch=(EditText)findViewById(R.id.etSearch);
        lvCurrencies.setTextFilterEnabled(true);
        // countryCode = getResources().getStringArray(R.array.Currencies);
        l = getModel();

        Collections.sort(l, new Comparator<Currency>() {
            @Override
            public int compare(Currency c1, Currency c2) {
                return c1.getName().compareToIgnoreCase(c2.getName());
            }
        });

        adapter = new Customarrayadapter(this, l);
    } 
```

我的自定义适配器类是：

```
package com.powergroupbd.yahoo;

import java.util.List;

import android.app.Activity;
import android.graphics.Color;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.CheckBox;
import android.widget.CompoundButton;
import android.widget.ImageView;
import android.widget.TextView;

public class Customarrayadapter extends ArrayAdapter<Currency> {

    private final List<Currency> list;
    private final Activity context;

    public Customarrayadapter(Activity context, List<Currency> list) {
        super(context, R.layout.showlist, list);
        this.context = context;
        this.list = list;
    }

    static class ViewHolder {
        protected TextView text;
        protected ImageView sub;
        protected CheckBox checkbox;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View view = null;
        if (convertView == null) {
            LayoutInflater inflator = context.getLayoutInflater();
            view = inflator.inflate(R.layout.showlist, null);
            final ViewHolder viewHolder = new ViewHolder();
            viewHolder.text = (TextView) view.findViewById(R.id.label);
            viewHolder.text.setTextColor(Color.WHITE);
            viewHolder.sub = (ImageView) view.findViewById(R.id.sub);

            viewHolder.checkbox = (CheckBox) view.findViewById(R.id.check);
            viewHolder.checkbox
                    .setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
                        @Override
                        public void onCheckedChanged(CompoundButton buttonView,
                                boolean isChecked) {
                            Currency element = (Currency) viewHolder.checkbox.getTag();
                            element.setSelected(buttonView.isChecked());
                            System.out.println("Checked : " + element.getName());
                        }
                    });
            view.setTag(viewHolder);
            viewHolder.checkbox.setTag(list.get(position));
        } else {
            view = convertView;
            ((ViewHolder) view.getTag()).checkbox.setTag(list.get(position));
        }
        ViewHolder holder = (ViewHolder) view.getTag();
        holder.text.setText(list.get(position).getName());
        holder.sub.setImageResource(list.get(position).getPlace());
        holder.checkbox.setChecked(list.get(position).isSelected());
        return view;
    }
} 
```

请帮我 ：（

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:49:24.333

使用此代码，用于过滤文本

```
public void onTextChanged(CharSequence s, int start,
int before, int count)
{

    textlength = edittext.getText().length();
    text_sort.clear();
    image_sort.clear();

    for (int i = 0; i < text.length; i++)
    {
        if (textlength <= text[i].length())
        {
            if (edittext.getText().toString().
                    equalsIgnoreCase((String) text[i].subSequence(0, textlength)))
            {
                text_sort.add(text[i]);
                image_sort.add(image[i]);
            }
        }
    }

    listview.setAdapter(new MyCustomAdapter(text_sort, image_sort));

    }
} 
```

有关更多信息，请参阅此站点，它可能会对您有所帮助[http://android-helper.blogspot.in/2011/07/android-search-in-custom-listview.html](http://android-helper.blogspot.in/2011/07/android-search-in-custom-listview.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-20T00:21:51.797

接受的答案非常具有误导性，并且忽略了实际问题。OP 的子类化不正确`ArrayAdapter`。您永远不应该跟踪自己的数据列表，而是通过适当的适配器方法访问该数据。例如，`getItem(position)`。`ArrayAdapter`不保证您传递给它的实例`List`保持不变。

事实上，在过滤操作期间，它会将数据复制到新`ArrayList`实例。这意味着您在子类中使用的列表不再引用`ArrayAdapter`. 由于您在方法中访问自己的列表`getView()`；而不是从 中提取`getItem()`，任何过滤更改都将被遗漏。事实上，此时，您也破坏了从适配器中添加或删除的能力。

子类化时最重要的规则`ArrayAdapter`。永远不要保留外部数据列表。总是参考`ArrayAdapter`代替。

# google-app-engine - 使用 Google App Engine 开发模式下的会话持久性

> ID：10689961
> 
> 赞同：2
> 
> 时间：2012-05-21T17:41:22.327
> 
> 标签：google-app-engine, gwt, httpsession

我在 App Engine 中[启用了会话](https://developers.google.com/appengine/docs/java/config/appconfig#Enabling_Sessions)，在部署应用程序时效果很好。我的问题是这似乎在开发模式下不起作用。我需要一些东西来在开发模式下的某个地方（磁盘、数据存储、内存）保持会话，这样我就不必每次重新启动本地服务器时都登录我的应用程序（每次更改服务器或共享代码时） .

我通常通过在 jetty-web.xml 中定义一个 HashSessionManager 来做到这一点，但显然（并且可以理解）App Engine出于安全原因[明确禁用了该配置文件。](https://groups.google.com/forum/?fromgroups#!topic/google-appengine-java/zTukS0dWQXs)

有没有人知道在 App Engine 中实现本地会话持久性的标准方法（假设存在一种方法）？

我在 appengine-web.xml 中有以下相关行：

```
 <sessions-enabled>true</sessions-enabled>
  <async-session-persistence enabled="true" /> 
```

我正在使用 App Engine SDK 的 1.6.5 版（最新）。

以下是我采取的一些步骤：

在我扩展 RemoteServiceServlet 的服务器端类中，我添加了以下行：

```
public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response) throws Exception {
    // Added this line
    System.out.println(request.getSession().getCreationTime());
    ...
} 
```

我重新启动了开发模式服务器，加载了我的应用程序并为我的应用程序发出的每个请求获得了“1337796704817”，这表明请求之间正在使用相同的会话。然后，我重新启动了开发模式服务器，下一个请求产生了“1337796798184”，表明已经创建了一个新会话。

如下所述，我使用的是 Google Cloud SQL，并且在应用引擎设置中禁用了数据存储选项，尽管这在部署时似乎不会导致任何问题。此外，我在检查这些选项的情况下尝试了上述相同的步骤，并得到了相同的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T01:55:08.003

会话被持久化到数据存储区。只要您每次重新启动 dev_appserver 时不清除数据存储，您的会话就应该保留。检查您是否没有在每次重新启动时清除数据存储。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-07T02:40:04.750

如果您`cookie_args.domain`设置了值（如[Webapp2 Sessions](https://webapp-improved.appspot.com/api/webapp2_extras/sessions.html)中所述），那么它将无法在您的开发服务器上运行。也就是说，如果域设置为，`.mydomain.com`那么它将无法在您的开发服务器上运行`localhost:8000`。

例如，如果您`main.py`包含这样的配置对象：

```
config = {
    'webapp2_extras.sessions': {
        'secret_key': '**secret_key**',
        'cookie_args': {'domain': '.mydomain.com', 'httponly': True}
    }
} 
```

解决办法是写一些条件代码：

```
import os
domain = None if os.environ['SERVER_SOFTWARE'].startswith('Development') else '.mydomain.com'

config = {
    'webapp2_extras.sessions': {
        'secret_key': '**secret_key**',
        'cookie_args': {'domain': domain, 'httponly': True}
    }
}
WSGIApplication(Routing, config=config, debug=True) 
```

# jpa - JPA级联类型

> ID：10689962
> 
> 赞同：0
> 
> 时间：2012-05-21T17:41:29.533
> 
> 标签：jpa, cascade

我无法理解 JPA 级联类型是如何工作的，我有一个判断类，它与另一个类用户具有多对一关系，我首先创建了用户并存储在用户表中，只有当用户做出判断时，才会有新的判断记录使用该用户 id 插入到判断表中（不是但再次将同一用户重新插入到用户表中）。所以这是我在判断课上的声明：

```
@ManyToOne(cascade = { CascadeType.REFRESH, CascadeType.MERGE}) @PrimaryKeyJoinColumn
@JoinColumn(name = "user_id")
private User judge; 
```

但它抱怨

```
Caused by: org.hibernate.TransientObjectException: object references an unsaved transient instance - save the transient instance before flushing  -- com.dyihi.recseva.model.Judgement.judge -> com.dyihi.recseval.model.User 
```

这里有什么问题？谢谢

# php - 设置器、验证器和依赖注入

> ID：10689964
> 
> 赞同：2
> 
> 时间：2012-05-21T17:41:57.487
> 
> 标签：php, oop, validation, dependency-injection, setter

假设我有一个 Thing 类，并且我需要使用一些由扩展 Zend_Validate_Abstract 的 MySpecificDateValidation 类提供的特定日期验证。

在 Thing 类中，我正在考虑依赖注入并想知道这段代码是否：

```
public function SetDateBegin($dateBegin) {
    $dateValidator = new MySpecificDateValidation();
    if ($dateValidator->isValid($dateBegin)) {
        $this->dateBegin = $dateBegin;
    } else {
        throw new Exception /*...*/;
    }
} 
```

应该重构为：

```
public function SetDateBegin($dateBegin, MySpecificDateValidation $dateValidator) {
    if ($dateValidator->isValid($dateBegin)) {
        $this->dateBegin = $dateBegin;
    } else {
        throw new Exception /*...*/;
    }
} 
```

或者有一些你可以忍受的依赖？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T17:48:54.383

您的第二个选项将更容易进行[单元测试](http://en.wikipedia.org/wiki/Unit_testing)，因为您将能够模拟验证器并注入模拟[对象](http://www.phpunit.de/manual/3.0/en/mock-objects.html)而不是真实对象。

如果您尝试对第一个选项进行单元测试，您最终会测试 Thing 类以及它所依赖的任何内容，例如验证器。如果单元测试失败，则必须通过所有依赖项跟踪失败。

[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)的目的是允许您将您的类与其依赖项隔离开来，以便您单独测试每个类。

因此，从测试的角度来看，您应该始终注入所有依赖项。

# joomla - 创建子文件夹 joomla 时孤立的类别

> ID：10689965
> 
> 赞同：0
> 
> 时间：2012-05-21T17:42:06.600
> 
> 标签：joomla

我进去了`>Exten >DocMan >Category`，我被创建了一个新的子文件夹。没问题。然后，我转到子文件夹并尝试在其下创建一个子文件夹。

```
Example:          Node Tree:
Animals SM         (A)
.-Mammal M           (B)
..-Domestic CF         (C)
...-Cat F                (D)
...-Dog F                (D)
....-Herders ACE           (E)
....-Sporting BOJ          (E)
....-Terriers PSP          (E)
.....-Cairn ROR              (F)
.....-Pitbull RCF            (F)
.....-Yorkshire RMR          (F) 
```

首先，我创建了 (E) Terriers PSP。检查网站，一切都很好。然后，我创建了 (F) Yorkshire RMR。（而不是选中框并点击“添加”，我点击了链接*大错误*）

```
Category Title:  Yorkshire
Category Name: Yorkshire
Parent Item: Mammals (*big mistake*)
Ordering: Mammals (*big mistake*) 
```

现在，我的整个哺乳动物文件夹都消失了。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:56:55.503

您是否尝试通过后端或直接在数据库中删除您的子文件夹？

# css - 如何将选择与 JQuery 按钮垂直对齐？

> ID：10689967
> 
> 赞同：2
> 
> 时间：2012-05-21T17:42:08.847
> 
> 标签：css

我确信有一个简单的解决方案，但到目前为止我还没有找到它，我正准备把我的电脑扔出窗外。

任何想法如何将选择与 jQuery 按钮垂直对齐，其中按钮高度大于选择的高度。像这样：

[http://jsfiddle.net/hCCzQ/4/](http://jsfiddle.net/hCCzQ/4/)

我正在尝试对齐它们，以便选择位于按钮的中间。

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T17:49:02.293

这对我很有效：

```
select, button {
    vertical-align: middle;
}
​ 
```

**演示：http:** [//jsfiddle.net/hCCzQ/6/](http://jsfiddle.net/hCCzQ/6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:55:59.300

**试试这个：**

[http://jsfiddle.net/oscarj24/5FL4a/](http://jsfiddle.net/oscarj24/5FL4a/)

```
 $(document).ready(function() {

  var b = $("#abutton");
  var s = $('select');   

  $(b, s).css('vertical-align', 'middle');
 }); 
```

* * *

**使用 @jnylen 帖子中带有 CSS 样式的类：**

**JS：**

```
$(document).ready(function() {
    var b = $("#abutton");
    var s = $('select');   

    b.addClass('btn');
    s.addClass('ddl');
}); 
```

**CSS：**

```
.btn {
    margin: 0;
    padding: 0;
    height: 40px;
    width: 32px;
    vertical-align: middle;
}

.ddl {
    margin: 0;
    padding: 0;
    position: relative;
    top: 2px;
    vertical-align: middle;
}​ 
```

​</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T17:56:39.883

这是我能找到使其像素完美的唯一方法：

```
button {
    margin: 0;
    padding: 0;
    height: 40px;
    width: 32px;
    vertical-align: middle;
}

select {
    margin: 0;
    padding: 0;
    position: relative;
    top: 2px;
    vertical-align: middle;
} 
```

演示：http: [//jsfiddle.net/hCCzQ/12/](http://jsfiddle.net/hCCzQ/12/)

它在 Firefox 和 IE7 中看起来不错。

# iphone - 仅在设备上运行应用程序时崩溃问题

> ID：10689969
> 
> 赞同：2
> 
> 时间：2012-05-21T17:42:13.107
> 
> 标签：iphone, objective-c, ios, ipad

所以我有一个非常奇怪的问题，当我在模拟器上运行我的应用程序并插入 iPad（在插入电缆的设备上运行应用程序）时，一切正常。但是，在插入设备后在设备上运行并尝试使用该应用程序后，它崩溃了..尝试查看设备崩溃日志，我看到：

```
Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libobjc.A.dylib                 0x3672bf78 objc_msgSend + 16
1   App                     0x000ca834 -[AHAppImageData dealloc] (AHInstagramImageData.m:122)
2   libobjc.A.dylib                 0x3672d16e _objc_rootRelease + 30
3   CoreFoundation                  0x33d792e0 CFRelease + 88
4   CoreFoundation                  0x33d8ea30 -[__NSArrayM removeObjectAtIndex:] + 288
5   CoreFoundation                  0x33d84adc -[NSMutableArray removeAllObjects] + 64
6   App                     0x000f717e -[AHImageDataSource clearDataSource] (AHImageDataSource.m:53)
7   App                     0x000c0a36 __49-[AHMainViewController loadRequestWithURLString:]_block_invoke_0 (AHMainViewController.m:91)
8   libdispatch.dylib               0x32658c52 _dispatch_call_block_and_release + 6
9   libdispatch.dylib               0x3265aee0 _dispatch_main_queue_callback_4CF$VARIANT$mp + 188
10  CoreFoundation                  0x33e032a6 __CFRunLoopRun + 1262
11  CoreFoundation                  0x33d8649e CFRunLoopRunSpecific + 294
12  CoreFoundation                  0x33d86366 CFRunLoopRunInMode + 98
13  GraphicsServices                0x37d68432 GSEventRunModal + 130
14  UIKit                           0x36820cce UIApplicationMain + 1074
15  App                     0x000b2860 main (main.m:16)
16  App                     0x000b2820 0xb1000 + 6176 
```

知道为什么这只发生在设备上而不是在插入或模拟器运行应用程序时发生吗？

根据下面的评论，我正在展示负责此操作的代码：

```
 [[AHMyAppAPIClient sharedClient] getPath:requestURLPath parameters:nil 
             success:^(AFHTTPRequestOperation *operation, id response) {
                 [self.progressHUD_ hide:YES];

                 self.nextPaginationURL_ = [[response valueForKey:@"pagination"] valueForKey:@"next_url"];

                 [self.collectionView_.pullToRefreshView stopAnimating];
                 [[NSOperationQueue sharedOperationQueue] cancelAllOperations];

                 NSArray *arr = [response valueForKey:@"data"];
                 if ([arr count] > 0){
                     [[AHImageDataSource sharedDataSource] clearDataSource];
                 }

                for (NSDictionary * data in arr){
                     AHInstagramImageData * imgData = [[AHInstagramImageData alloc] initWithData:data];
                     [[AHImageDataSource sharedDataSource] addObject:imgData];
                     [imgData release];
                 }

                 dispatch_async(dispatch_get_main_queue(), ^{
                     [self.collectionView_ setContentOffset:CGPointMake(0, 0)];
                     [self.collectionView_ reloadData];

                 });

             }
             failure:^(AFHTTPRequestOperation *operation, NSError *error) {
                 [self.progressHUD_ hide:YES];
                 NSLog(@"Error fetching user data!");
                 NSLog(@"%@", error);      

             }]; 
```

这就是我设置数据源的方式：

```
extern NSString * const kClearDataSource;

@interface AHImageDataSource : NSObject
+ (AHImageDataSource *)sharedDataSource;
- (void) clearDataSource;
- (void) addObject:(id) object;
- (void) addObject:(id)object atIndex:(int) index;
- (int) count;
- (id) objectAtIndex:(int) index;
@end

NSString * const kClearDataSource = @"clearDataSource";

@interface AHImageDataSource()
{
    NSMutableArray * imageDataSource_;
}

@property (nonatomic, retain) NSMutableArray * imageDataSource_;

@end

@implementation AHImageDataSource
@synthesize imageDataSource_;

+ (AHImageDataSource *)sharedDataSource {
    static AHImageDataSource *_sharedClient = nil;
    static dispatch_once_t oncePredicate;
    dispatch_once(&oncePredicate, ^{
        _sharedClient = [[self alloc] init];
    });

    return _sharedClient;
}

- (id)init {
    self = [super init];
    if (!self) {
        return nil;
    }

    NSMutableArray * temp = [[NSMutableArray alloc] initWithCapacity:200];
    self.imageDataSource_  = temp;
    [temp release];

    return self;
}

-(void) clearDataSource
{
    if ([self.imageDataSource_ count] > 0){
        [self.imageDataSource_ removeAllObjects];
    }

}

- (void) addObject:(id) object
{
    [self.imageDataSource_ addObject:object];
}

- (void) addObject:(id)object atIndex:(int) index
{
    [self.imageDataSource_ insertObject:object atIndex:index];
}

- (int) count
{
    return [self.imageDataSource_ count];
}

- (id) objectAtIndex:(int) index
{
    if (index >= 0 && index < [self.imageDataSource_ count]){
        return [self.imageDataSource_ objectAtIndex:index];
    } 

    return nil;
}

- (void) dealloc
{
    [super dealloc];
    [imageDataSource_ release];
}

@end 
```

**编辑：**

似乎 NSZombieEnabled 似乎隐藏了这个问题。当我禁用 NSZombieEnabled 时，它现在在模拟器和设备上崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T18:23:23.350

我同意吉姆的观点，看起来像是双重释放。

我会利用 Instruments 的“**僵尸**”配置文件来测试这种情况。它只能在模拟器中完成，但应该准确地向您展示正在双重发布的内容。

一旦100％清楚，通常很容易解决这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:50:31.370

看起来您`AHInstagramImageData`通过将实例放入字典来过度释放实例，然后将保留计数降低到足以将其释放。然后，当它从字典中删除时，它会再次被释放并尝试为不再存在的对象释放内存。

发布负责的代码，您可能会获得更详细的帮助。仅靠崩溃日志是不够的。

# crystal-reports - 日期范围内每个日期的水晶报表总和

> ID：10689971
> 
> 赞同：0
> 
> 时间：2012-05-21T17:42:19.237
> 
> 标签：crystal-reports, report, summary, group-by

这是我第一次尝试堆栈溢出，所以希望大家能帮助我。我很乐意在这里开始贡献，过去它是一个非常有用的工具。

好的，所以我正在尝试编写一份报告，以图表显示制造设施的总逾期时间。我所拥有的是一组表格，列出了每个制造订单并给出了截止日期和完成日期。运行报告的人输入一个日期范围，我想生成一个图表，其中 x 轴为日期，y 轴为逾期时间总和。也许我在实现三公式技巧时遗漏了一些东西，但我无法让它发挥作用。我可以按到期日分组，但这只会给我在给定日期过期的订单总数。

我需要的是类似以下的东西，这是可绘制的：

```
 For each (date in DateRange) {
       If (Due Date < i) && (Comp Date > i) {
          Past Due Hours = Past Due Hours + manufacturing order Hours
       }
    } 
```

我知道它不在 Crystal Syntax 中，我只是想了解一下。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:13:34.307

这种问题经常出现——如果我理解正确的话。你有这样的东西吗？

```
OrderNum DueDate  CompletedDate
1        01/01/01 01/02/01
2        01/01/01 01/01/01
3        01/02/01 01/03/01
4        01/02/01 01/02/01 
```

现在您需要做的第一件事是获取一个包含所有日期的表格（还有其他类似的方法），然后加入您的数据集中，这样您最终会得到：

```
OrderNum DueDate  CompletedDate Date
1        01/01/01 01/02/01      01/01/01
2        01/01/01 01/01/01      01/01/01
3        01/02/01 01/03/01      01/01/01
4        01/02/01 01/02/01      01/01/01
1        01/01/01 01/02/01      01/02/01
2        01/01/01 01/01/01      01/02/01
3        01/02/01 01/03/01      01/02/01
4        01/02/01 01/02/01      01/02/01
1        01/01/01 01/02/01      01/03/01
2        01/01/01 01/01/01      01/03/01
3        01/02/01 01/03/01      01/03/01
4        01/02/01 01/02/01      01/03/01 
```

接下来，您需要添加一个确定订单是否为的字段`{@overdue}`：

```
if {table.duedate} < {table.date} and {table.completeddate} > {table.date} then 
 1
else 
 0; 
```

确保为空值选择默认值以避免任何异常）。

`sum({@overdue})`您现在可以创建一个图表`{table.date}`

大号

# entity-framework-4 - 将视图转换为表和 savechanges 给了我乐观的并发异常

> ID：10689972
> 
> 赞同：1
> 
> 时间：2012-05-21T17:42:20.343
> 
> 标签：entity-framework-4, view, optimistic-concurrency

我正在使用 Entity Framework 4（使用自跟踪实体），并访问一个视图，即两个表的合并。因此，当我更新视图的信息时，我将视图的 STE 发送到访问数据库的存储库。

我做了以下事情：

当我收到包含更新信息的视图时，我创建了我的 STE1 和 STE2。当我创建一个 STE 时，它是如何使用添加状态创建的。那么我如何知道状态被修改的观点的STE的状态，我用方法改变了我的两个STE的状态`MarkedAsModified`。

然后，我如何在视图的 STE 中查看这两个表的信息，我将视图中的信息传递给正确的 STE，并将 STE 中的更改应用到`objectContext`.

最后我制作了`saveChanges`. 但在这一步中，我收到一个`Optimistic concurrency exception`. 我认为这是因为 STE 从状态传递到`Added`到`Modified`所以上下文检测到在创建和之间有一些修改`SaveChanges`，但我也尝试`AcceptChanges`在 STE 中，后来标记为已修改和，最后应用更改`SaveChanges`，但是问题仍然存在。

我该如何解决这个问题？有更好的方法来使用视图和实体框架 v4？

谢谢。戴姆洛克。

编辑1：我仍然有问题。我的代码如下：

组件 myComponent = new Components(); //这是一个 STE myComponent.Rereference = myView.Reference; ... //其他属性 myComponent.MarkedAsModified(); //这是必需的，因为我要更新信息，不添加新寄存器。myContext.ApplyChanges("组件", myComponent); miContexto.SaveChanges();

在 saveChanges 中，我得到了异常：更新、插入或删除语句影响了意外数量的行 (0)。自加载实体后，实体可能已被修改或删除。刷新 ObjectStateManager 条目。

哪个是问题？我可以不修改创建的新STE吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T08:44:49.633

我找到了解决问题的方法。

在第一个解决方案中，解决方案是查询数据库以获取数据库中的现有寄存器。这会在上下文中添加实体，然后可以修改数据并正确保存更改。

但后来，我找到了避免需要在数据库中进行查询以在上下文中添加修改的实体的方法。

方法是使用以下代码：

```
Customers myCustomer = new Customers  { IDCustomer = myCustomer.IDCustomer };
myContext.Customers.Attach(myCustomer);

//update the data of the entity.

myContext.SaveChanges(); 
```

解决方案是创建一个设置主键的新实体。如果实体有 FK，它将以相同的方式指示。此时，实体具有添加状态。

稍后，是附加到上下文中，然后可以进行修改。当一个字段发生变化时，实体将其状态更改为已修改，因此当调用 saveChanges() 时，EF 更新实体，而不是尝试添加新实体。

[我在此链接](http://blogs.msdn.com/b/alexj/archive/2009/03/27/tip-9-deleting-an-object-without-retrieving-it.aspx)中找到此信息。在这篇文章中，解决方案是删除实体而不将其检索到数据库中，如果我们想修改现有寄存器，这个想法也很有效。

# android - 如何为不存在的图像选择抛出异常

> ID：10689975
> 
> 赞同：0
> 
> 时间：2012-05-21T17:42:30.327
> 
> 标签：android

在我的场景中，我从图库中选择一张图片并将其显示在同一布局的 imageView 中，我可以使用该图像处理另一个活动。但是当我单击意图按钮时没有选择任何图像时，我会强制停止。

谁有解决这个问题的想法？

```
public void onCreate(Bundle savedInstanceState){

    super.onCreate(savedInstanceState);
    setContentView (R.layout.browse_page);

    //action for browse Image

        Intent intent = new Intent();       
        intent.setType("image/*");
        intent.setAction(Intent.ACTION_GET_CONTENT);
        startActivityForResult(Intent.createChooser(intent,"Select Picture"), SELECT_PICTURE);

    //declare image and button
    image = (ImageView) findViewById (R.id.image);
    chooseNewImage = (Button) findViewById (R.id.chooseNewImage);
    grayScale = (Button) findViewById (R.id.greyscale);

    //back to previous page
    chooseNewImage.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            finish();
        }
    });

    //go to set the image to grayScale
    grayScale.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

                Intent greyScale = new Intent(browsePage.this, grayScale.class);
                greyScale.putExtra("imagePath", path_selectedImage);
                startActivity(greyScale);

        }
    }); 
}

    public void onActivityResult(int requestCode, int resultCode, Intent data) {
        if (resultCode == RESULT_OK && requestCode == SELECT_PICTURE) {

                    Uri_selectedImage = data.getData();
                    path_selectedImage = getPath(Uri_selectedImage);                   
                    image.setImageURI(Uri_selectedImage);
                    System.out.println(path_selectedImage);
                    Toast.makeText(getBaseContext(), "Your selected picture", Toast.LENGTH_SHORT).show(); 
             }

    }

    private String getPath(Uri uri) {
        // TODO Auto-generated method stub
        String[] project = {MediaStore.Images.Media.DATA};
        Cursor c = managedQuery(uri, project, null, null, null);
        startManagingCursor(c);
        int column_index = c.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
        c.moveToFirst();
        return c.getString(column_index);

} 
```

每当我没有选择图像并按下灰度按钮时，它都会强制停止。是否需要放置try-catch？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T09:04:02.487

```
 //go to set the image to grayScale     
 grayScale.setOnClickListener(new View.OnClickListener() {
       public void onClick(View v) {

          if (path_selectedImage==null){
             // show toast here
          } else {     
             Intent greyScale = new Intent(browsePage.this,grayScale.class);
             greyScale.putExtra("imagePath",path_selectedImage);
             startActivity(greyScale);          
       }
 }); 
```

# css - 覆盖 gwt DockLayoutPanel 小部件的溢出

> ID：10689976
> 
> 赞同：7
> 
> 时间：2012-05-21T17:42:30.623
> 
> 标签：css, gwt, overflow, uibinder, docklayoutpanel

我正在创建一个左侧带有导航菜单的页面，其中包含每个部分的图标。页面布局如下所示：

```
 <g:DockLayoutPanel unit="PX">
    <g:west size="55"><g:SimplePanel ui:field="navigation" /></g:west>
    <g:center>
      <g:ScrollPanel>
        <g:Whatever ui:field="content" />
      </g:ScrollPanel>
    </g:center>
  </g:DockLayoutPanel> 
```

悬停在导航栏的每个图标上应该会显示一个包含项目标题和一些子项目的气球。我通过 CSS 实现了效果，给每个气球一个相对于其图标的位置。

g:west 元素呈现为

```
<div style="
    position: absolute;
    overflow: hidden;
    left: 0px;
    top: 0px;
    bottom: 0px;
    width: 55px; "> 
```

我的问题是`overflow: hidden`。

如何告诉 DockLayoutPanel 西部元素可以溢出中心元素？

**编辑：** 我找到了一个非常可靠的解决方法

```
navigation.getElement().getParentElement().getParentElement().getStyle()
    .setOverflow(Overflow.VISIBLE); 
```

有谁知道不与 HTML 元素混淆的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-29T00:37:25.497

您可以覆盖北 div 的内联样式：

```
<ui:style>
    .dockLayoutPanel > div {
        overflow: visible !important;
    }
</ui:style>

<g:DockLayoutPanel unit="PX" width="100%" height="100%" addStyleNames="{style.dockLayoutPanel}">
    <g:north size="46">
     ...
    </g:north>
</g:DockLayoutPanel> 
```

使用 GWT 2.6.1 测试。

您可以在这里找到更多建议：[https ://github.com/gwtbootstrap/gwt-bootstrap/issues/231](https://github.com/gwtbootstrap/gwt-bootstrap/issues/231)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T19:15:24.123

另一种方法是使用[PopupPanel](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/PopupPanel.html)显示自定义气球小部件，并相应地设置样式。然后，您可以处理导航图标`MouseOverEvent`并`MouseOutEvent`设置气球的内容、显示和隐藏气球。

# git - 如何在 git 标签消息中包含换行符

> ID：10689977
> 
> 赞同：10
> 
> 时间：2012-05-21T17:42:34.057
> 
> 标签：git

当我在 git 中标记版本化代码时，我喜欢在标记消息中使用项目符号。

这可以通过带注释的标签轻松完成：

```
git tag -a v1.0.0

* Change number 1
* Change number 2
#
# Write a tag message
# 
```

但是，如果我使用 -m 选项尝试相同的标记，则标记消息不是我所期望的：

```
git tag -a v1.0.0 -m "* Change number 1\n* Change number 2"

git show v1.0.0

...

* Change number 1\n* Change number 2
.... 
```

'\n' 被解释为字符 '\' 和 'n' 而不是换行符。我想使用该`-m`选项，以便我可以自动化标记过程。

`git tag`有没有办法使用该`-m`选项包含实际的换行符？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-21T17:49:45.920

我找到的最接近的解决方案是使用多个`-m`选项，每行一个。例如：

```
git tag -a v1.0.0 -m "* Change number 1" -m "* Change number 2" 
```

来自[git-tag 手册页](http://linux.die.net/man/1/git-tag)：

```
-m <msg>
   Use the given tag message (instead of prompting). If multiple
   -m options are given, their values are concatenated as separate
   paragraphs. (...) 
```

**更新**：检查[“从命令行向 git commit -m 添加换行符”](https://stackoverflow.com/questions/5064563/add-line-break-to-git-commit-m-from-command-line)以获取更多基于 shell 的解决方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-01-01T09:59:28.620

最好的解决方案是直接从默认代码编辑器中编写提交和标记消息。

*   使用命令`git tag -a v1.0.0`并按回车键。**不要写`-m`**
*   它将打开您的默认代码编辑器，编写消息，保存并关闭文件。
*   命令行将恢复。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-21T17:58:55.913

另一种选择是将格式化的消息放在（临时）文件中，并用于`git tag -F <filename> <tag>`从该文件中读取消息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T21:23:53.653

假设您使用的是 unix shell，则换行符的语法是错误的。

```
git tag -a v1.0.0 -m "* Change number 1
* Change number 2" 
```

应该管用。

# java - Joda Time - 将一天中的毫秒数解析为 LocalTime

> ID：10689982
> 
> 赞同：0
> 
> 时间：2012-05-21T17:42:50.720
> 
> 标签：java, jodatime

我有一个简单的任务：解析一天中的毫秒数，`LocalTime`它代表一天中的某个时间。我当时在想：

```
int averageLeavingMillis = 73123961 // 20:18:xx.xxx
LocalTime localTime = new LocalTime(new Long(averageLeavingMillis)) 
```

但是当我打印时，`localTime`我收到：`21:18:43.961`比我期待的多一小时。我错过了时区的东西吗？或者我应该如何将一天中的毫秒转换为 LocalTime？

谢谢，马特奥

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T07:29:41.367

`DateTimeZone.UTC`在教师中 使用

```
int averageLeavingMillis = 73123961;     
LocalTime lt = new LocalTime(new Long(averageLeavingMillis), DateTimeZone.UTC);
System.out.println(lt); 
```

输出

```
20:18:43.961 
```

# android - 首选项屏幕文本未正确调整大小

> ID：10689983
> 
> 赞同：2
> 
> 时间：2012-05-21T17:42:51.200
> 
> 标签：android, preferenceactivity

我有一个从 pref_screen.xml 创建的首选项屏幕，该屏幕是从扩展 PreferenceActivity 并实现 OnSharedPreferenceChangeListener 的活动设置的。当我更改设置时，文本调整过大。请注意屏幕截图中的“启用恶劣天气警报”现在太大了。我的猜测是 PreferenceActivity 使用的适配器。知道如何停止吗？还是重新实例化整个视图？这里是第一个加载： ![在此处输入图像描述](../Images/b0c052d774952cf71ba0a65828f7c1b3.png)

在我将“通知”从“关闭”更改为“我的当前位置”之后

![在此处输入图像描述](../Images/7d391995af262fbd90d8634ed1b8f628.png)

# google-app-engine - 使用 Objectify Appengine 存储大型 blob

> ID：10689987
> 
> 赞同：5
> 
> 时间：2012-05-21T17:43:12.327
> 
> 标签：google-app-engine, objectify

我有一个我想使用 Objectify 持久化的类，这个类将表示大于 1MB 的数据，因此有一个 Blob 对象列表，它表示存储的字节数组的一个片段，其大小小于 1MB：

```
@Entity
public class BigBlob {

    @Id
    private Long id;
    public static final int FRAGMENT_LIMIT = 777 * 1024;
    @Serialized
    private List<Blob> fragments = new ArrayList<Blob>();

    ...

} 
```

然而，“片段”是@Serialized，这将使这个 BigBlob 类/对象的大小大于 1MB。

导致此错误：

```
com.google.apphosting.api.ApiProxy$RequestTooLargeException: The request to API call datastore_v3.Put() was too large. 
```

如果我使用 @Embedded 注释，我会收到此错误：

```
Cannot place array or collection properties inside @Embedded arrays or collections 
```

如何确保“片段”存储为单独的实体？

顺便说一句，我已经有了字节分块逻辑，它可以切分整个字节数组并将片段放入 a `List`of`Blob`所以这个问题与如何切分字节无关。

大多数情况下，我想知道的更多的是持久性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T17:50:01.900

您应该将其存储在 Blobstore 中，并将 Blobkey 保存在 Objectify 中。Objectify 工作在数据存储之上，而不是 blobstore。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T19:55:16.677

Rick 的答案确实是最好的 - 在 blobstore 中存储 blob，特别是如果您是 GAE 新手并且对数据存储有概念问题。

另一方面，使用拆分实体来存储 blob 有一些很好的理由，尤其是在存储接近 1M 边缘的数据时。您不希望使用 100MB 的 blob 来执行此操作，但 2MB 的 blob 是有意义的。

首先，您不希望序列化或嵌入。这些只是在单个实体中构造数据的简单方法。

此外，没有神奇的注释可以让您跨实体拆分 blob。您必须手动完成所有操作。您不需要实际创建“主”或根实体；只需使用由 id 定义的父级（但没有实际实体）创建所有实体片段，并使用祖先（）查询来获取所有片段。

# php - php foreach 未显示数组中的第一个值

> ID：10689990
> 
> 赞同：1
> 
> 时间：2012-05-21T17:43:27.850
> 
> 标签：php, loops, foreach, echo, associative-array

我有一个数组`($vEvents)`如下：

```
Array
(
[0] => Array
    (
        [id] => 1174
        [date] => 120411
        [name] => DR. J 'Souled Out' ~ 9pm (No Cover)
        [pubId] => 44
        [price] => 
    )

[1] => Array
    (
        [id] => 1108
        [date] => 120410
        [name] => Verb presents Open Stage ~ 9pm (No Cover)
        [pubId] => 44
        [price] => 
    )

[2] => Array
    (
        [id] => 1104
        [date] => 120409
        [name] => DR. J 'Souled Out' ~ 9pm (No Cover)
        [pubId] => 44
        [price] => 
    )
[currLimit] => 10
[eventsRemaining] => 4 
```

我在屏幕上回显它：

```
reset ($vEvents);
foreach ($vEvents as $key => &$value) {
    if ($key != 'currLimit' && $key != 'eventsRemaining'){ //Makes sure it doesn't print out the limiter value
    $m = substr($value['date'],0,2);
    $d = substr($value['date'],2,2);
    $y = '20'.substr($value['date'],4,2);
    echo date("D", mktime(0, 0, 0, $m, $d, $y)).", ".date("M", mktime(0, 0, 0, $m, $d, $y))." ".$d.", ".$y." - ".$value['name'].'<br />';
    }
} 
```

但是在我的输出中，它没有得到所有显示的数组条目，而是一直跳过第一个......输出：

```
Sat, Dec 04, 2010 - Verb presents Open Stage ~ 9pm (No Cover)
Fri, Dec 04, 2009 - DR. J 'Souled Out' ~ 9pm (No Cover) 
```

但是，我的预期输出应该是：

```
Sun, Dec 04, 2011 - DR. J 'Souled Out' ~ 9pm (No Cover)
Sat, Dec 04, 2010 - Verb presents Open Stage ~ 9pm (No Cover)
Fri, Dec 04, 2009 - DR. J 'Souled Out' ~ 9pm (No Cover) 
```

我曾尝试更改`name`键中的值等，但所有其他整个显示都很好，它总是跳过第一个键。我以前从未遇到过这个问题。想法？

当我注释掉：`if ($key != 'currLimit' && $key != 'eventsRemaining'){ //Makes sure it doesn't print out the limiter value`行时，它工作正常。第一个元素的键为零是否相关？但是为什么我的`if`检查会失败呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T18:11:14.947

PHP 在处理 0 的值时很奇怪……在大多数情况下，它会将它们视为 false。所以，

```
if ($key != 'currLimit' && $key != 'eventsRemaining') 
```

当 $key == 0 时将评估为 false。我将其更改为：

```
if ($key !== 'currLimit' && $key !== 'eventsRemaining') 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-05-21T17:47:18.343

因为这是一个数组，我会尝试使用不同类型的循环，它应该会给你预期的结果：

```
<?php

$length = count( $vEvents );

for( $i = 0; $i < $length; i ++ )
{

$key = $i;
$value = $vEvents[ $i ];

//rest of the loop code here

}
?> 
```

# android - 上下文中的 FragmentManager

> ID：10689997
> 
> 赞同：49
> 
> 时间：2012-05-21T17:43:56.567
> 
> 标签：android

我创建了一个新`View`课程。在该课程中，我需要访问`FragmentManager`，但我不知道如何。

我可以`FragmentManager`从上下文访问吗？

```
CustomView extends LinearLayout 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-05-21T18:14:31.937

仅当给定的 Context 扩展了 Activity (Post-Honeycomb) 或 FragmentActivity (pre-honeycomb) 时。

在这种情况下，您必须 100% 确保它是使用反射或 try-catch 的活动。

```
try{
  final Activity activity = (Activity) context;

  // Return the fragment manager
  return activity.getFragmentManager();

  // If using the Support lib.
  // return activity.getSupportFragmentManager(); 

} catch (ClassCastException e) {
  Log.d(TAG, "Can't get the fragment manager with this");
} 
```

我认为我建议重构，所以 a`View`实际上只是用于显示内容，实际上不应该修改您的应用程序的状态，但这是我的意见。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2014-07-23T16:19:07.173

如果您正在使用支持片段，您可能实际上想要：

```
try {
  FragmentManager fragmentManager = ((FragmentActivity) context).getSupportFragmentManager();
} catch (ClassCastException e) {
  Log.e(TAG, "Can't get fragment manager");
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-08-25T20:37:19.320

这对我有用：

```
Context mContext;
...

//Get FragmentManager
FragmentManager fragmentManager = ((Activity) mContext).getFragmentManager(); 
```

（当然你必须首先初始化mContext）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-03-28T14:03:02.560

您可以在应用程序中访问 FragmentManager（或 SupportFragmentManager） - 但正如其他答案所暗示的那样，您只能通过 Activity 实例来执行此操作。

但是，您可以通过 Activity 访问 FragmentManager，而无需使用 ActivityLifecycleCallbacks 接口直接调用任何 Activity：

```
registerActivityLifecycleCallbacks(new ActivityLifecycleCallbacks {

    @Override
    public void onActivityCreated(Activity activity, Bundle bundle) {
        activity.getFragmentManager()
        if(activity instanceof FragmentActivity) {
            ((FragmentActivity)activity).getSupportFragmentManager();
        }
        unregisterActivityLifecycleCallbacks(this);
    }

    ... 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-02-21T10:17:48.357

由于您的上下文对象不能始终直接转换为 Activity，因此这是一种更可靠的方法：

```
@Nullable
public static Activity getActivityFromContext(@NonNull Context context){
    while (context instanceof ContextWrapper) {
        if (context instanceof Activity) return (Activity) context;
        context = ((ContextWrapper)context).getBaseContext();
    }
    return null; //we failed miserably 
} 
```

# python - Python 子进程丢失了程序标准输出的 10%

> ID：10689998
> 
> 赞同：3
> 
> 时间：2012-05-21T17:43:59.050
> 
> 标签：python, subprocess

我有一个程序需要被称为 python 的子进程。该程序是用java编写的。是的，我知道...

无论如何，我需要捕获所述程序的所有输出。

不幸的是，当我使用通信 [0] 调用 subprocess.popen2 或 subprocess.Popen 时，当我使用分配给 stdout 的 subprocess.PIPE 和使用文件描述符时，我丢失了大约 10% 的输出数据（从打开的返回）分配给标准输出。

subprocess 中的文档非常明确，如果您尝试捕获子进程的所有输出，则使用 subprocess.PIPE 是不稳定的。

我目前正在使用 pexpect 将输出转储到 tmp 文件中，但由于显而易见的原因，这需要永远。

我想将所有数据保存在内存中以避免磁盘写入。

欢迎任何建议！谢谢！

```
import subprocess

cmd = 'java -Xmx2048m -cp "/home/usr/javalibs/class:/home/usr/javalibs/libs/dependency.jar" --data data --input input" 

# doesn't get all the data
#
p = subprocess.Popen(cmd, stdout=subprocess.PIPE, shell=True)
output = p.communicate()[0]

OR
# doesn't get all the data
#
fd = open("outputfile",'w')
p = subprocess.Popen(cmd, stdout=fd, shell=True)
p.communicate()
fd.close() # tried to use fd.flush() too.

# also tried
# p.wait() instead of p.communicate(), but wait doesn't really wait for the java program to finish running - it doesn't block

OR
# also fails to get all the data
#
import popen2
(rstdout, rstdin) = popen2.popen2(cmd) 
```

预期输出是一系列 ascii 行（几千行）。这些行包含一个数字和一个行尾字符

```
0\n
1\n
4\n
0\n
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T18:29:10.927

我曾经使用`subprocess`过更大的输出，`stdout`但没有看到这样的问题。很难从您所展示的内容中得出根本原因是什么。我会检查以下内容：

因为`p.wait()`没有为你工作。可能是这样的情况，当您阅读您`PIPE`的 java 程序时，仍然忙于打印最后 10%。先说正事`p.wait()`：

*   在阅读之前插入足够长的等待时间（比如 30 秒），`PIPE`你的 10% 会出现吗？
*   `p.wait()`是否会阻止您的 java 程序是值得怀疑的。您的 java 程序是否进一步子处理其他程序？
*   检查的返回值`p.wait()`。你的java程序正常终止了吗？

如果问题不在于您的并发模型，请检查您是否在 java 程序中正确打印：

*   你在你的java程序中使用了什么函数来打印`stdout`？它是倾向于还是忽略`IOException`？
*   您是否正确刷新了流？当您的 java 程序终止时，最后 10% 可能在您的缓冲区中而没有适当的刷新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T19:06:17.853

它必须与您实际调用的过程相关。您可以通过使用另一个回显行的 python 脚本进行简单测试来验证这一点：

*出.py*

```
import sys

for i in xrange(5000):
    print "%d\n" % i

sys.exit(0) 
```

*测试.py*

```
import subprocess

cmd = "python out.py"
p = subprocess.Popen(cmd, stdout=subprocess.PIPE, shell=True)
output = p.communicate()[0]

print output 
```

因此，您可以验证问题不是数据的大小，而是与您正在调用的进程的通信。

您还应该确认您正在运行的 python 版本，因为我已经阅读了有关 Popen 内部缓冲区的过去问题（但使用您建议的单独文件句柄通常为我修复）。

如果子进程调用无限期挂起，这将是一个缓冲区问题。但如果这个过程正在完成，只是缺少线条，那么 Popen 就在做它的工作。