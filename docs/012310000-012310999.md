# StackOverflow 问答 12310000-12310999

# php - 使用 PHP cURL 向 Node.js 发送 Post 请求

> ID：12310000
> 
> 赞同：4
> 
> 时间：2012-09-06T23:53:41.787
> 
> 标签：php, node.js, curl

我正在尝试通过 PHP cURL 向我的 node.js 服务器发送一个发布请求，然后向客户端发出一条消息。服务器正在工作和设置如下：

```
var app = require('http').createServer(handler)
  , io = require('socket.io').listen(app)
  , fs = require('fs')
  , qs = require('querystring')

app.listen(8000);

function handler(req, res) {
    // set up some routes
    switch(req.url) {
        case '/push':

        if (req.method == 'POST') {
            console.log("[200] " + req.method + " to " + req.url);
            var fullBody = '';

            req.on('data', function(chunk) {
                fullBody += chunk.toString();

                if (fullBody.length > 1e6) {
                    // FLOOD ATTACK OR FAULTY CLIENT, NUKE REQUEST
                    req.connection.destroy();
                }
            });

            req.on('end', function() {              
                // Send the notification!
                var json = qs.stringify(fullBody);
                console.log(json.message);

                io.sockets.emit('push', { message: json.message });

                // empty 200 OK response for now
                res.writeHead(200, "OK", {'Content-Type': 'text/html'});
                res.end();
            });    
        }

        break;

        default:
        // Null
  };
} 
```

我的PHP如下：

```
 $curl = curl_init();
    $data = array('message' => 'simple message!');

    curl_setopt($curl, CURLOPT_URL, "http://localhost:8000/push");
    curl_setopt($curl, CURLOPT_POST, 1);
    curl_setopt($curl, CURLOPT_POSTFIELDS, $data);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);

    curl_exec($curl); 
```

控制台说 json.message 未定义。为什么它是未定义的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T00:40:28.900

您错误地使用了 querystring.stringify()。在此处查看有关查询字符串方法的文档：

[http://nodejs.org/docs/v0.4.12/api/querystring.html](http://nodejs.org/docs/v0.4.12/api/querystring.html)

我相信您想要的是 JSON.stringify() 或 querystring.parse() 之类的东西，而不是应该将现有对象序列化为查询字符串的 querystring.stringify()；这与您尝试做的相反。

您想要的是将您的 fullBody 字符串转换为 JSON 对象的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T16:56:43.530

如果您的正文仅包含 JSON blob 的字符串化版本，则替换

```
var json = qs.stringify(fullBody); 
```

和

```
var json = JSON.parse(fullBody); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-29T12:08:47.130

试试这个代码

```
<?php

$data = array(
    'username' => 'tecadmin',
    'password' => '012345678'
);

$payload = json_encode($data);

// Prepare new cURL resource
$ch = curl_init('https://api.example.com');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLINFO_HEADER_OUT, true);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, $payload);

// Set HTTP Header for POST request 
curl_setopt($ch, CURLOPT_HTTPHEADER, array(
    'Content-Type: application/json',
    'Content-Length: ' . strlen($payload))
);

// Submit the POST request
$result = curl_exec($ch);

// Close cURL session handle
curl_close($ch); 
```

# xml - 不断收到“文档末尾的额外内容”错误

> ID：12310004
> 
> 赞同：1
> 
> 时间：2012-09-06T23:54:14.827
> 
> 标签：xml, xml-parsing

我目前正在为一项作业处理一个 xml 文件，但是在花费了大约一个半小时后，每当我尝试在网络浏览器中打开 xml 文件时，都会继续获得“文档末尾的额外内容”在试图找出造成这种情况的原因时，我仍然没有任何运气，所以如果有人可以帮助指出我所犯的错误或指出我正确的方向，我将不胜感激，谢谢！这是xml内容本身

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<?xml-stylesheet type="text/css" href="Access Data_Phase A_Test Program.css"?>
<client_information xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="Access Data_Client Projects_Schema.xsd"/>
<client>
        <client_ID> 1 </client_ID>
        <client_name> John Hill </client_name>
        <client_address>
                <client_address_street>
                        <client_address_street_1> 123 Broad Street </client_address_street_1>
                        <client_address_street_2> Apartment 2 </client_address_street_2>
                </client_address_street>
                <client_address_city> State College </client_address_city>
                <client_address_state> PA </client_address_state>
                <client_address_zip> 16801 </client_address_zip>
        </client_address>
        <client_phone_number> 614222333 </client_phone_number>
        <client_fax_number> 6143234444 </client_fax_number>
        <client_email> jhill@ist.psu.edu </client_email>
        <project>
                <project_number> 22 </project_number>
                <contact_person>
                        <contact_person_name> Patrick Lunney </contact_person_name>
                        <contact_person_phone_number> 5554443333 </contact_person_phone_number>
                        <contact_person_fax_number> 6667778888 </contact_person_fax_number>
                        <contact_person_email> pat@email.com </contact_person_email>
                </contact_person>
                <delivery_preference> Phone </delivery_preference>
        </project>
</client>
<client>
        <client_ID> 2 </client_ID>
        <client_name> Austin Wonderly </client_name>
        <client_address>
                <client_address_street>
                        <client_address_street_1> thompson hall </client_address_street_1>
                        <client_address_street_2> room 256 </client_address_street_2>
                </client_address_street>
                <client_address_city> University Park </client_address_city>
                <client_address_state> PA </client_address_state>
                <client_address_zip> 16802 </client_address_zip>
        </client_address>
        <client_phone_number> 7167964202 </client_phone_number>
        <client_fax_number> 7815852085 </client_fax_number>
        <client_email> ajw5293@psu.edu </client_email>
        <project>
                <project_number> 44 </project_number>
                <contact_person>
                        <contact_person_name> James Wonderly </contact_person_name>
                        <contact_person_phone_number> 7169129546 </contact_person_phone_number>
                        <contact_person_fax_number> 7166560432 </contact_person_fax_number>
                        <contact_person_email> jwonderly@aholdusa.com </contact_person_email>
                </contact_person>
                <delivery_preference> Email </delivery_preference>
        </project>
</client>
<client>
        <client_ID> 3 </client_ID>
        <client_name> Mike Jones </client_name>
        <client_address>
                <client_address_street>
                        <client_address_street_1> Park Avenue Plaza </client_address_street_1>
                        <client_address_street_2> 55 East 52nd Street </client_address_street_2>
                </client_address_street>
                <client_address_city> New York </client_address_city>
                <client_address_state> NY </client_address_state>
                <client_address_zip> 10055 </client_address_zip>
        </client_address>
        <client_phone_number> 2128105300 </client_phone_number>
        <client_fax_number> 2127543123 </client_fax_number>
        <client_email> mjones@psu.edu </client_email>
        <project>
                <project_number> 4 </project_number>
                <contact_person>
                        <contact_person_name> Tom Dombrowski </contact_person_name>
                        <contact_person_phone_number> 7815553700 </contact_person_phone_number>
                        <contact_person_fax_number> 7816326000 </contact_person_fax_number>
                        <contact_person_email> tdombrowski@msn.com </contact_person_email>
                </contact_person>
                <delivery_preference> Fax </delivery_preference>
        </project>
</client>
<client>
        <client_ID> 4 </client_ID>
        <client_name> John Neale </client_name>
        <client_address>
                <client_address_street>
                        <client_address_street_1> Four Embarcadero Center </client_address_street_1>
                        <client_address_street_2> Suite 550 </client_address_street_2>
                </client_address_street>
                <client_address_city> San Francisco </client_address_city>
                <client_address_state> CA </client_address_state>
                <client_address_zip> 94111 </client_address_zip>
        </client_address>
        <client_phone_number> 8007892742 </client_phone_number>
        <client_fax_number> 6307993834 </client_fax_number>
        <client_email> jneal@statecollege.org </client_email>
        <project>
                <project_number> 6 </project_number>
                <contact_person>
                        <contact_person_name> Tom Cyran </contact_person_name>
                        <contact_person_phone_number> 6305053700 </contact_person_phone_number>
                        <contact_person_fax_number> 6307993834 </contact_person_fax_number>
                        <contact_person_email> tcyran@slrhs.com </contact_person_email>
                </contact_person>
                <delivery_preference> Phone </delivery_preference>
        </project>
</client>
</client_information> 
```

，这也是我不断收到的错误[http://i.imgur.com/Ztg0B.png](http://i.imgur.com/Ztg0B.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T00:00:58.950

看看错误，它会准确地告诉你。第 4 行如下所示：

`<client_information xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="Access Data_Client Projects_Schema.xsd"/>`

其次是你的xml的其余部分。除了该行是一个封闭节点，因此您的 xml 的其余部分被视为无效:) 删除最后的闭包，如下所示：

`<client_information xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="Access Data_Client Projects_Schema.xsd">`

# asp.net - JQuery 验证不适用于复选框组

> ID：12310005
> 
> 赞同：1
> 
> 时间：2012-09-06T23:54:16.137
> 
> 标签：asp.net, controls, jquery-validate, checkbox, jquery-form-wizard

我无法让 JQuery 验证与一组复选框一起使用。我正在使用 ASP.NET 复选框列表生成复选框，并且我使用 JQuery 将列表中每个复选框的“名称”属性设置为相同的内容。这是写入浏览器的代码。我在第一个复选框上设置了“验证”属性，以设置必须选择至少一个复选框的规则。JQuery 验证适用于表单上的所有其他元素，但不适用于复选框列表。我还在页面上使用了一个 JQuery 表单向导，它为表单的每个“页面”触发验证，所以我无法控制如何调用验证。

```
<input id="ContentPlaceHolder1_MainContent_AreaOfInterest_0" class="ui-wizard-content     ui-helper-reset ui-state-default" type="checkbox" value="Famine" name="hello[]" validate="required:true, minlength:1">
<label for="ContentPlaceHolder1_MainContent_AreaOfInterest_0">Famine</label>
<br>
<input id="ContentPlaceHolder1_MainContent_AreaOfInterest_1" class="ui-wizard-content ui-helper-reset ui-state-default" type="checkbox" value="Events Volunteer" name="hello[]">
<label for="ContentPlaceHolder1_MainContent_AreaOfInterest_1">Events Volunteer</label> 
```

关于出了什么问题的任何想法？有很多 JQuery 脚本示例可以进行验证，但是我试图避免这种情况，因为我正在通过自定义控件生成复选框列表服务器端，以便它可以在可能或可能的不同页面中重复使用没有启用 JQuery。我正在尝试启用 JQuery 验证，同时尽可能不显眼，这样即使禁用了 JQuery，页面仍然可以工作。

以下是表单向导的相关 JQuery 包含和 JQuery 初始化脚本。我没有使用任何初始化代码进行 JQuery 验证：

```
<script type="text/javascript" src="../js/formwizard/js/bbq.js"></script>
<script type="text/javascript" src="../js/formwizard/js/jquery.form.js"></script>
<script type="text/javascript" src="../js/formwizard/js/jquery.form.wizard.js"></script>
<script type="text/javascript" src="../js/formwizard/js/jquery.validate.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#form1").formwizard({
            validationEnabled: true,
            focusFirstInput: true
        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T03:35:23.157

使用 JQuery 将每个复选框的“名称”设置为一致的值会“破坏”.NET 中的复选框列表（我认为这会发生）。基本上，使用 JQuery 表单向导和使用自定义的 .NET 复选框列表进行 JQuery 验证太复杂了。它们并不完全兼容。.NET 需要为每个复选框列表输入具有不同的名称，这与 JQuery 验证效果不佳（当然在使用表单向导时也不会）。我将尝试在表单向导中关闭 JQuery 验证（它具有此选项），以查看表单向导是否可以正常使用 .NET 验证器的验证（包括客户端验证）。我会发回我的结果！认为我最初尝试这样做并且表单向导无法正常工作，这就是为什么我开始使用带有表单向导的 JQuery 验证，所以我目前的解决方案只是删除多页表单（没有这个表单不会太长），以简化事情，并且只依赖 .NET 验证（客户端和服务器端）。有人指出，多页表单可以让用户想知道究竟还有多少字段需要填写，而至少单页表单可以让他们看到他们需要完成的内容的完整性！

这是我正在/正在使用的表单向导：

[http://thecodemine.org/](http://thecodemine.org/)

# ios - MonoTouch.Dialog：当没有 ImageUrl 时，StyledStringElement 上的默认图像

> ID：12310006
> 
> 赞同：2
> 
> 时间：2012-09-06T23:54:31.440
> 
> 标签：ios, xamarin.ios, monotouch.dialog

我正在设置`ImageUrl`a `StyledStringElement`，但不知道 url 是否存在。我想放入一个`placeholder image`在成功下载图像之前使用的：

```
 var item = new StyledStringElement(n.Title);
        item.ImageUri = new Uri(n.ImageThumbUrl); 
```

我现在明白了：

![在此处输入图像描述](../Images/799d36e81bc633706330430ef2c6971c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:15:30.807

有帮助：http: [//yusinto.blogspot.ca/2012/05/background-image-downloading-with.html](http://yusinto.blogspot.ca/2012/05/background-image-downloading-with.html)

我将其复制`StyledStringElement`到一个新的`StyledStringElementLoader`并编辑了此代码：

```
 if (extraInfo.Uri != null)
    {   img = ImageLoader.DefaultRequestImage (extraInfo.Uri, this);
        if(img==null)
            img=myLoaderImagePassedToConstructor;
    } 
```

# java - 在命令行中使用 javac 编译时出现“包 javax.inject 不存在”错误

> ID：12310013
> 
> 赞同：12
> 
> 时间：2012-09-06T23:55:16.710
> 
> 标签：java, jakarta-ee, glassfish, javac

我正在迈出学习 JSF 的第一步。我发现了这本有趣的书，名为“Core JavaServer Faces Third Edition”。

尝试编译第一个示例，您可以从以下网址下载源代码： http: [//horstmann.com/corejsf/](http://horstmann.com/corejsf/)。当我在命令行上键入以下内容时

```
javac UserBean.java 
```

我收到错误：

```
package javax.inject does not exist
package javax.enterprise.context doe not exist 
```

我已经下载了 Java EE、Ant 和 GlassFish。

这是我的命令行的快照：

```
C:\JSF-Tutorial\corejsf3-examples\javaee\ch01\login\src\java\com\corejsf>javac UserBean.java
UserBean.java:4: error: package javax.inject does not exist
import javax.inject.Named;
                   ^
UserBean.java:6: error: package javax.enterprise.context does not exist
import javax.enterprise.context.SessionScoped;
                               ^
UserBean.java:9: error: cannot find symbol
@Named("user") // or @ManagedBean(name="user")
 ^
  symbol: class Named
UserBean.java:10: error: cannot find symbol
@SessionScoped
 ^
  symbol: class SessionScoped
4 errors

C:\JSF-Tutorial\corejsf3-examples\javaee\ch01\login\src\java\com\corejsf> 
```

上周一直在谷歌搜索如何编译 Java EE 应用程序，但没有任何用处。

请有人帮我解决这个问题，我需要解决这个问题，这样我才能继续学习 JSF。

SP：在开始使用 NetBeans 编译我的 Java EE 项目之前，我想学习徒手编译 Java EE 应用程序。我更喜欢先学习使用 GlassFish，然后可能会考虑使用 Tomcat。

还有一个问题; 使用 Java EE 和 GlassFish 服务器部署我的应用程序有什么区别？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-07T21:01:45.697

您需要在编译时类路径中包含包含这些类的 JAR 文件。

在您使用 GlassFish 服务器的特定情况下，这是`/glassfish/lib/javaee.jar`. 您可以将类路径指定为命令的`-cp`（或`-classpath`）参数`javac`。它是一个分号分隔的磁盘文件系统路径字符串，指向 JAR 文件和/或类文件夹，应该包含在编译时类路径中。

```
javac -cp /path/to/glassfish/lib/javaee.jar UserBean.java 
```

`javac`一旦遇到被 引用的未知类，它将在那里查看`import`，以便它可以验证您是否以正确的方式使用它。

这在技术上与 Java EE 无关。这只是基本的Java。我建议在深入研究 Java EE 之前先了解这一点。

如果您使用的是 IDE，那么只需将目标服务器作为“目标运行时”附加到项目中即可。然后，IDE 将自动对构建路径（编译时类路径）执行所有操作。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-09-06T12:13:50.903

在 netbeans 7.3 中，您可以右键单击项目查看器中的库文件夹，选择“添加库”选项，然后从列表中选择“Java EE 6 API 库”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-12-05T05:18:32.543

在 NetBeans IDE 8.0 中，它与上述 7.3 版略有不同

1.  `Libraries`在 Java EE 中右键单击您的项目
2.  选择`Import...`
3.  根据您使用的版本进行选择`Java EE 6 API Library`或选择。`Java EE 7 API Library`
4.  点击`Import Library`按钮
5.  选择您刚刚导入的库并按下`Add Library`按钮。

# java - 如何将字节转换为其二进制字符串表示形式

> ID：12310017
> 
> 赞同：108
> 
> 时间：2012-09-06T23:56:07.720
> 
> 标签：java, binary, byte

例如，一个字节中的位`B`是`10000010`，我怎样才能将这些位`str`从字面上分配给字符串，即`str = "10000010"`.

**编辑**

我从二进制文件中读取字节，并存储在字节数组`B`中。我用`System.out.println(Integer.toBinaryString(B[i]))`. 问题是

(a) 当位以（最左边的）1 开始时，输出不正确，因为它转换`B[i]`为负 int 值。

(b) 如果位以 开头`0`，则输出忽略`0`，例如，假设`B[0]`有 00000001，则输出`1`为`00000001`

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2012-09-07T00:03:52.773

使用[`Integer#toBinaryString()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#toBinaryString%28int%29)：

```
byte b1 = (byte) 129;
String s1 = String.format("%8s", Integer.toBinaryString(b1 & 0xFF)).replace(' ', '0');
System.out.println(s1); // 10000001

byte b2 = (byte) 2;
String s2 = String.format("%8s", Integer.toBinaryString(b2 & 0xFF)).replace(' ', '0');
System.out.println(s2); // 00000010 
```

**[演示](http://ideone.com/xHojh)**。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2013-07-05T20:52:51.210

我用过这个。与其他答案类似的想法，但在任何地方都没有看到确切的方法:)

```
System.out.println(Integer.toBinaryString((b & 0xFF) + 0x100).substring(1)); 
```

`0xFF`是 255，或`11111111`（无符号字节的最大值）。 `0x100`是 256，或`100000000`

将`&`字节向上转换为整数。那时，它可以是`0`- `255`(`00000000`到`11111111`，我排除了前 24 位)。`+ 0x100`并`.substring(1)`确保会有前导零。

与 João Silva 的答案相比，我对其进行了计时，这比[João Silva 的答案](https://stackoverflow.com/a/12310078/1268003)快了 10 倍以上。[http://ideone.com/22DDK1](http://ideone.com/22DDK1)我没有包括 Pshemo 的答案，因为它没有正确填充。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-07T00:19:10.587

这是你想要的？

从字符串转换为字节

```
byte b = (byte)(int)Integer.valueOf("10000010", 2);
System.out.println(b);// output -> -126 
```

从字节转换为字符串

```
System.out.println(Integer.toBinaryString((b+256)%256));// output -> "10000010" 
```

或者正如 João Silva 在他的评论中所说的添加前导`0`，我们可以将字符串格式化为长度 8，并将生成的前导空格替换为零，所以在字符串的情况下，`" 1010"`我们将得到`"00001010"`

```
System.out.println(String.format("%8s", Integer.toBinaryString((b + 256) % 256))
                         .replace(' ', '0')); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-05-14T16:08:55.357

您可以检查字节上的每个位，然后将 0 或 1 附加到字符串。这是我为测试编写的一个小辅助方法：

```
public static String byteToString(byte b) {
    byte[] masks = { -128, 64, 32, 16, 8, 4, 2, 1 };
    StringBuilder builder = new StringBuilder();
    for (byte m : masks) {
        if ((b & m) == m) {
            builder.append('1');
        } else {
            builder.append('0');
        }
    }
    return builder.toString();
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-03-21T04:26:26.810

获取字节的每一位并转换为字符串。假设字节有 8 位，我们可以通过位移动一个一个地得到它们。例如，我们将 6 位字节的第二位向右移动，将 8 位的第二位移到最后一位，然后用 0x0001 与 (&) 清除前面的位。

```
public static String getByteBinaryString(byte b) {
    StringBuilder sb = new StringBuilder();
    for (int i = 7; i >= 0; --i) {
        sb.append(b >>> i & 1);
    }
    return sb.toString();
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-10-20T16:55:29.613

此代码将演示如何将 java int 拆分为其 4 个连续字节。然后，与低级字节/位询问相比，我们可以使用 Java 方法检查每个字节。

这是运行以下代码时的预期输出：

```
[Input] Integer value: 8549658

Integer.toBinaryString: 100000100111010100011010
Integer.toHexString: 82751a
Integer.bitCount: 10

Byte 4th Hex Str: 0
Byte 3rd Hex Str: 820000
Byte 2nd Hex Str: 7500
Byte 1st Hex Str: 1a

(1st + 2nd + 3rd + 4th (int(s)) as Integer.toHexString: 82751a
(1st + 2nd + 3rd + 4th (int(s)) ==  Integer.toHexString): true

Individual bits for each byte in a 4 byte int:
00000000 10000010 01110101 00011010 
```

这是要运行的代码：

```
public class BitsSetCount
{
    public static void main(String[] args) 
    {
        int send = 8549658;

        System.out.println( "[Input] Integer value: " + send + "\n" );
        BitsSetCount.countBits(  send );
    }

    private static void countBits(int i) 
    {
        System.out.println( "Integer.toBinaryString: " + Integer.toBinaryString(i) );
        System.out.println( "Integer.toHexString: " + Integer.toHexString(i) );
        System.out.println( "Integer.bitCount: "+ Integer.bitCount(i) );

        int d = i & 0xff000000;
        int c = i & 0xff0000;
        int b = i & 0xff00;
        int a = i & 0xff;

        System.out.println( "\nByte 4th Hex Str: " + Integer.toHexString(d) );
        System.out.println( "Byte 3rd Hex Str: " + Integer.toHexString(c) );
        System.out.println( "Byte 2nd Hex Str: " + Integer.toHexString(b) );
        System.out.println( "Byte 1st Hex Str: " + Integer.toHexString(a) );

        int all = a+b+c+d;
        System.out.println( "\n(1st + 2nd + 3rd + 4th (int(s)) as Integer.toHexString: " + Integer.toHexString(all) );

        System.out.println("(1st + 2nd + 3rd + 4th (int(s)) ==  Integer.toHexString): " + 
                Integer.toHexString(all).equals(Integer.toHexString(i) ) );

        System.out.println( "\nIndividual bits for each byte in a 4 byte int:");

        /*
         * Because we are sending the MSF bytes to a method
         * which will work on a single byte and print some
         * bits we are generalising the MSF bytes
         * by making them all the same in terms of their position
         * purely for the purpose of printing or analysis
         */
        System.out.print( 
                    getBits( (byte) (d >> 24) ) + " " + 
                    getBits( (byte) (c >> 16) ) + " " + 
                    getBits( (byte) (b >> 8) ) + " " + 
                    getBits( (byte) (a >> 0) ) 
        );

    }

    private static String getBits( byte inByte )
    {
        // Go through each bit with a mask
        StringBuilder builder = new StringBuilder();
        for ( int j = 0; j < 8; j++ )
        {
            // Shift each bit by 1 starting at zero shift
            byte tmp =  (byte) ( inByte >> j );

            // Check byte with mask 00000001 for LSB
            int expect1 = tmp & 0x01; 

            builder.append(expect1);
        }
        return ( builder.reverse().toString() );
    }

} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-02-17T21:19:47.507

对不起，我知道这有点晚了......但我有一个更简单的方法......二进制字符串：

```
//Add 128 to get a value from 0 - 255
String bs = Integer.toBinaryString(data[i]+128);
bs = getCorrectBits(bs, 8); 
```

getCorrectBits 方法：

```
private static String getCorrectBits(String bitStr, int max){
    //Create a temp string to add all the zeros
    StringBuilder sb = new StringBuilder();
    for(int i = 0; i < (max - bitStr.length()); i ++){
        sb.append("0");
    }

    return sb.toString()+ bitStr;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-05-25T13:03:33.187

```
Integer.toBinaryString((byteValue & 0xFF) + 256).substring(1) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-02-22T19:59:15.717

您可以像下面的示例一样使用***BigInteger***，尤其是如果您有**256 位**或更长：

```
String string = "10000010";
BigInteger biStr = new BigInteger(string, 2);

System.out.println("binary: " + biStr.toString(2));
System.out.println("hex: " + biStr.toString(16));
System.out.println("dec: " + biStr.toString(10)); 
```

**另一个接受字节的例子：**

```
String string = "The girl on the red dress.";

byte[] byteString = string.getBytes(Charset.forName("UTF-8"));
System.out.println("[Input String]: " + string);
System.out.println("[Encoded String UTF-8]: " + byteString);

BigInteger biStr = new BigInteger(byteString);
System.out.println("binary: " + biStr.toString(2)); // binary
System.out.println("hex: " + biStr.toString(16));   // hex or base 16
System.out.println("dec: " + biStr.toString(10));  // this is base 10 
```

**结果：**

```
[Input String]: The girl on the red dress.
[Encoded String UTF-8]: [B@70dea4e

binary: 101010001101000011001010010000001100111011010010111001001101100001000000110111101101110001000000111010001101000011001010010000001110010011001010110010000100000011001000111001001100101011100110111001100101110
hex: 546865206769726c206f6e20746865207265642064726573732e 
```

* * *

您还可以将**二进制**转换为**字节**格式

```
try {
   System.out.println("binary to byte: " + biStr.toString(2).getBytes("UTF-8"));
} catch (UnsupportedEncodingException e) {e.printStackTrace();} 
```

* * *

*注意：* 对于二进制格式的字符串格式，您可以使用以下示例

```
String.format("%256s", biStr.toString(2).replace(' ', '0'));  // this is for the 256 bit formatting 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-05-09T20:25:13.657

```
String byteToBinaryString(byte b){
    StringBuilder binaryStringBuilder = new StringBuilder();
    for(int i = 0; i < 8; i++)
        binaryStringBuilder.append(((0x80 >>> i) & b) == 0? '0':'1');
    return binaryStringBuilder.toString();
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-08-23T19:33:07.663

一个简单的答案可能是：

```
System.out.println(new BigInteger(new byte[]{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0})); // 0
System.out.println(new BigInteger(new byte[]{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1})); // 1
System.out.println(new BigInteger(new byte[]{0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0})); // 256
System.out.println(new BigInteger(new byte[]{0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0})); // 65536
System.out.println(new BigInteger(new byte[]{0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0})); // 16777216
System.out.println(new BigInteger(new byte[]{0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0})); // 4294967296
System.out.println(new BigInteger(new byte[]{0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0})); // 1099511627776
System.out.println(new BigInteger(new byte[]{0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0})); // 281474976710656
System.out.println(new BigInteger(new byte[]{0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0})); // 72057594037927936
System.out.println(new BigInteger(new byte[]{0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0})); // 18446744073709551616
System.out.println(new BigInteger(new byte[]{0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0})); // 4722366482869645213696
System.out.println(new BigInteger(new byte[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0})); // 1208925819614629174706176
System.out.println(Long.MAX_VALUE);                                              // 9223372036854775807 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-07-03T08:56:31.220

我们都知道 Java 不提供类似 unsigned 关键字的任何东西。此外，`byte`根据 Java 规范的原语表示 和 之间的`−128`值`127`。例如，如果 a`byte`是Java 将把第一个解释`cast`为and使用符号扩展。`int``bit``sign`

### 那么，如何将大于的字节转换`127`为其二进制字符串表示？

没有什么能阻止您将 a`byte`简单地视为 8 位并将这些位解释为 和 之间的`0`值`255`。此外，您需要记住，您无法将自己的解释强加于其他人的方法。如果一个方法接受 a `byte`，那么该方法接受一个介于`−128`and之间的值，`127`除非另有明确说明。

所以解决这个问题的最好方法是通过调用方法或将其转换为原始`byte`值来将值转换为值。这里有一个例子： `int``Byte.toUnsignedInt()``int``(int) signedByte & 0xFF`

```
public class BinaryOperations
{
    public static void main(String[] args)
    {
        byte forbiddenZeroBit = (byte) 0x80;

        buffer[0] = (byte) (forbiddenZeroBit & 0xFF);
        buffer[1] = (byte) ((forbiddenZeroBit | (49 << 1)) & 0xFF);
        buffer[2] = (byte) 96;
        buffer[3] = (byte) 234;

        System.out.println("8-bit header:");
        printBynary(buffer);
    }

    public static void printBuffer(byte[] buffer)
    {
        for (byte num : buffer) {
            printBynary(num);
        }
    }

    public static void printBynary(byte num)
    {
        int aux = Byte.toUnsignedInt(num);
        // int aux = (int) num & 0xFF; 
        String binary = String.format("%8s', Integer.toBinaryString(aux)).replace(' ', '0');
        System.out.println(binary);
    }
} 
```

### 输出

```
8-bit header:
10000000
11100010
01100000
11101010 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-11-03T10:03:40.790

对于那些需要将字节大量转换为二进制字符串的人来说，这只是另一个提示：使用查找表而不是一直使用那些字符串操作。这比一遍又一遍地调用转换函数要快得多

```
public class ByteConverterUtil {

  private static final String[] LOOKUP_TABLE = IntStream.range(0, Byte.MAX_VALUE - Byte.MIN_VALUE + 1)
                                                        .mapToObj(intValue -> Integer.toBinaryString(intValue + 0x100).substring(1))
                                                        .toArray(String[]::new);

  public static String convertByte(final byte byteValue) {
    return LOOKUP_TABLE[Byte.toUnsignedInt(byteValue)];
  }

  public static void main(String[] args){
    System.out.println(convertByte((byte)0)); //00000000
    System.out.println(convertByte((byte)2)); //00000010
    System.out.println(convertByte((byte)129)); //10000001
    System.out.println(convertByte((byte)255)); //11111111
  }

} 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2012-09-07T00:00:44.210

只是在这里猜测，但如果你有一个 Byte 那么你不能简单地在对象上调用 toString() 来获取值吗？或者，使用 byteValue()查看[api ？](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Byte.html#byteValue%28%29)

# wpf - 我应该依赖注入吗？我该怎么做？

> ID：12310020
> 
> 赞同：0
> 
> 时间：2012-09-06T23:56:29.907
> 
> 标签：wpf, dependency-injection, prism

好的，所以我正在使用 MVCVM（或 MVCVM）模式在 WPF 中使用 Microsoft Prism。

在我的 ChatModule 中，我有一系列视图、视图模型和一个控制器。

对于我的意见

*   ChatAreaView - 显示进来阅读的聊天消息。它托管在 TabControl 区域内，因此我可以在用户和其他用户之间建立聊天窗口，或者文件传输窗口等。
*   UserAreaView - 这是用户列表。右键单击有上下文菜单可以与它们交互......比如发送文件或耳语。
*   MessageAreaView - 这是用户键入要发送给所有其他人的消息的地方。

对于每个视图，我都有一个对应的 ViewModel。**ChatAreaViewModel、UserAreaViewModel 和 MessageAreaViewModel**。这些 ViewModel 本质上只包含属性。

例如，UserAreaViewModel 定义了一个用户类型的结构，它本质上只是一个名称。实际上这是在类之外定义的，但仍然......它使用它。它有一个 ObservableCollection 来存储当前连接的所有用户的列表。它还定义了与用户交互的 ICommand 属性。现在我有 SendFile、Whisper 和 Nudge... 打算在未来添加更多。

控制器创建这些视图和 ViewModel，并将它们结合起来。它通知它们，将 ViewModel 分配为相应的 View 的 DataContext，并设置 ViewModel 的所有初始属性。在模块的整个生命周期中，它将对用户交互做出反应并执行它已分配给每个 ViewModel 的 ICommand 属性的 DelegateCommands。这些将进一步改变 ViewModel 中属性的状态。

我使用的是 Views 和 ViewModels 的实际类型，而不是像这样的接口。

```
#region Views

ChatAreaView viewChatArea;
UserListView viewUserArea;
MessageView viewMessageArea;
LoginPromptView viewLoginPrompt;

#endregion

#region ViewModels

ChatAreaViewModel viewModelChatArea;
UserAreaViewModel viewModelUserArea;
MessageAreaViewModel viewModelMessageArea;
LoginPromptViewModel viewModelLoginPrompt;

#endregion 
```

如果我为 Views 和 ViewModels 定义接口，并在控制器中对这些接口而不是具体实现进行操作，事情会变得更整洁、耦合更少吗？然后我可以在 Module 类（本质上是每个模块的根）中将它们注册到我的 Container 中吗？

我这样做有什么好处？我将如何为每个视图实现一个接口以将它们与其他视图区分开来？除了拥有 XAML 之外，他们并没有真正做任何事情……而且 ViewModel 也没有真正做任何事情，除了具有某些属性。这些属性可能会发生变化。例如，在 UserAreaViewModel 上，我肯定想添加更多命令，以便用户可以以不同的方式与另一个用户交互。

有人可以帮我吗？在我的脑海中，我在想我应该抽象出这些东西，但我真的不知道我应该以一种合乎逻辑的方式来处理它，或者即使这样做是一个明智的主意。我有什么收获？

感谢您的时间。下图是我正在处理的示例。忽略 Add new Item 按钮和所有内容的样式......这不是我现在正在做的事情。

![聊天应用](../Images/2fcb7004bd86d7e907cb71273ac3f6f6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-22T04:29:38.583

1.  松耦合——将来可以用完全不同的实现来替换整个类。
2.  独立开发.. 可以注入一个虚拟 UI / 视图，直到最终 UI 准备好。两部分可以同时进化（在有一个共同的合同之后）。
3.  无需添加对模块的引用（实现视图）。可以使用 ConfigurationModuleCatalog 从配置文件中发现类型。

# vba - 将JPEG打印为PDF，设置纸张大小

> ID：12310021
> 
> 赞同：1
> 
> 时间：2012-09-06T23:56:34.583
> 
> 标签：vba, pdf, acrobat

使用 VBA，对于给定的 JPEG（或 GIF 或 BMP），我想将其打印为 PDF，并在打印前设置页面大小。我已经研究了几种不同的打印方式，但似乎没有一种能够做我想做的事：

*   **使用 Acrobat SDK 调用`AVDoc.Open()`, `AVDoc.GetPDDoc()`, 然后`PDDoc.Save()`**: can't choose page size using this method

*   **声明 WinAPI 函数`SetDefaultPrinter`和`ShellExecute`，用于`SetDefaultPrinter`将打印机设置为 PDF 打印驱动程序，然后调用`ShellExecute(1,"print",filepath,"",rootdirectory,1)`**：我还没有找到使用此方法设置页面大小的方法

可以使用与 Office 文档对象关联的方法设置页面大小，例如`Worksheet.PageSetup.PaperSize = xlPaper11x17`，但这仅设置该对象的页面大小，而不是我要打印的 JPEG。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T08:28:56.757

您可以将其导入 Excel 工作簿并从那里打印。这是一个基本的例子：

```
Dim ws As Worksheet
Dim pic As Picture

Set ws = ActiveSheet
ws.PageSetup.PaperSize = xlPaperA4
'Can also specify margins, etc.

ws.Range("A1").Activate
Set pic = ws.Pictures.Insert("C:\mypic.jpg")   
'Set picture size.
With pic.ShapeRange
    .LockAspectRatio = msoFalse
    .Height = Application.CentimetersToPoints(20)
    .Width = Application.CentimetersToPoints(15)
    'Or you could match the size to the paper margins from above.
End With

ws.ExportAsFixedFormat Type:=xlTypePDF, _
    Filename:="C:\mypic.pdf", OpenAfterPublish:=True 
```

在 Excel 2010 中测试。

# java - 使用 SQL 从两个表中选择数据

> ID：12310023
> 
> 赞同：0
> 
> 时间：2012-09-06T23:56:36.523
> 
> 标签：java

我有两个表由另一个表链接，如下所示：

```
ROLES(RoleID, RoleName)
EMPLOYEES(EmployeeID, E_Name, Address)
ROLE_EMPLOYEES(RoleID#,EmployeeID#). 
```

我想要一个从 ROLES 中检索所有 EMPLOYEES 和 RoleID 并显示在 Java 表单上的查询。

我试过这个但不起作用：

```
rs=st.executeQuery("SELECT EMPLOYEES.*, ROLES.* FROM EMPLOYEES JOIN ROLES");               

while(rs.next()){
    //MOVE THE CURSOR TO THE FIRST RECORD AND GET DATA
    int employeeid=rs.getInt("EmployeeID");
    String id=Integer.toString(employeeid);
    String name=rs.getString("E_Name");
    String addr=rs.getString("Address");
    String s = rs.getString("RoleID");
    jComboBox1.addItem(s.trim());

    //DISPLAY THE FIRST RECORD IN THE TEXT FIELD
    txtEmpNumber.setText(id);
    txtEmpName.setText(name);
    txtEmpAddress.setText(addr);
    jComboBox1.setSelectedItem(s);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T00:10:10.340

你可以试试这个：

```
SELECT
   EM.*, RL.*
FROM
   EMPLOYEES EM
INNER JOIN
   ROLE_EMPLOYEES REM ON REM.EmployeeID = EM.EmployeeID
INNER JOIN
   ROLES RL ON RL.RoleID = REM.RoleID 
```

仅仅通过编写关键字`JOIN`，db-engine 不知道它应该以哪种方式连接表的数据；除非您想检索笛卡尔积（这不是您的情况），否则您需要使用该`ON`子句显式设置条件。

# html - 快速响应的交互式图表/图形：SVG、Canvas 还是其他？

> ID：12310024
> 
> 赞同：115
> 
> 时间：2012-09-06T23:56:44.510
> 
> 标签：html, canvas, svg, d3.js, kineticjs

我正在尝试选择正确的技术来更新一个项目，该项目基本上在可缩放、可平移的图形中呈现数千个点。当前使用 Protovis 的实现性能不佳。在这里查看：

[http://www.planethunters.org/classify](http://www.planethunters.org/classify)

完全缩小时大约有 2000 个点。尝试使用底部的手柄放大一点，然后拖动它来平移。您会看到它非常不稳定，除非您拥有一台非常快的计算机，否则您的 CPU 使用率可能会在一个内核上达到 100%。对焦点区域的每次更改都会对 protovis 进行重绘，这非常缓慢，而且绘制的点越多越糟糕。

我想对界面进行一些更新，并更改底层的可视化技术，使其对动画和交互更加敏感。从下面的文章中，似乎可以在另一个基于 SVG 的库或基于画布的库之间进行选择：

[http://www.sitepoint.com/how-to-choose-between-canvas-and-svg/](http://www.sitepoint.com/how-to-choose-between-canvas-and-svg/)

[d3.js](http://d3js.org/)是从 Protovis 发展而来的，它是基于 SVG 的，[应该更擅长渲染动画](http://mbostock.github.com/d3/tutorial/protovis.html)。但是，我怀疑它的性能提升多少以及它的性能上限是多少。出于这个原因，我还在考虑使用[KineticJS](http://www.kineticjs.com/)等基于画布的库进行更彻底的改造。但是，在我深入使用一种或另一种方法之前，我想听听有人用这么多数据完成了类似的 Web 应用程序并听取他们的意见。

最重要的是性能，其次是易于添加其他交互功能和编程动画。一次可能不会超过 2000 个点，每个点上都有那些小误差线。**放大、缩小和平移需要平滑。**如果最新的 SVG 库在这方面表现不错，那么使用 d3 的易用性可能会超过 KineticJS 等的增加设置。但是如果使用画布有巨大的性能优势，特别是对于计算机速度较慢的人，那么我肯定会更喜欢那样做。

NYTimes 制作的使用 SVG 的应用程序示例，但动画效果仍然可以接受： [http](http://www.nytimes.com/interactive/2012/05/17/business/dealbook/how-the-facebook-offering-compares.html) ://www.nytimes.com/interactive/2012/05/17/business/dealbook/how-the-facebook-offering-compares.html . 如果我能够获得这种性能并且不必编写自己的画布绘图代码，我可能会选择 SVG。

我注意到一些用户使用了[d3.js 操作与画布渲染相结合](https://stackoverflow.com/questions/12098286/canvas-tooltip-to-appear-outside-canvas)的混合体。但是，我在网上找不到太多关于此的文档，也无法与该帖子的 OP 取得联系。如果有人对这种 DOM-to-Canvas（[演示](http://bl.ocks.org/1276463)、[代码](https://gist.github.com/1276463)）实现有任何经验，我也希望收到您的来信。它似乎是能够操纵数据和对如何呈现数据（以及因此性能）进行自定义控制的一个很好的混合体，但我想知道是否必须将所有内容加载到 DOM 中仍然会减慢速度。

我知道存在一些与此类似的问题，但没有一个问题完全相同。谢谢你的帮助。

**跟进**：我最终使用的实现在[https://github.com/zooniverse/LightCurves](https://github.com/zooniverse/LightCurves)

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2012-09-08T23:59:17.440

幸运的是，绘制 2000 个圆圈是一个非常容易测试的示例。所以这里有四种可能的实现方式，Canvas 和 SVG 各两种：

*   [画布几何缩放](http://bl.ocks.org/3680958)
*   [画布语义缩放](http://bl.ocks.org/3681006)
*   [SVG 几何缩放](http://bl.ocks.org/3680999)
*   [SVG语义缩放](http://bl.ocks.org/3680957)

这些示例使用 D3 的[缩放行为](https://github.com/mbostock/d3/wiki/Zoom-Behavior)来实现缩放和平移。除了圆圈是用 Canvas 还是 SVG 渲染之外，另一个主要区别是您是使用*几何*缩放还是*语义*缩放。

几何缩放意味着您将单个变换应用于整个视口：当您放大时，圆圈会变大。对比的语义缩放意味着您对每个圆圈单独应用变换：当您放大时，圆圈保持相同的大小，但它们会散开。Planethunters.org 目前使用语义缩放，但考虑其他情况可能会有用。

几何缩放简化了实现：您应用一次平移和缩放，然后重新渲染所有圆圈。SVG 的实现特别简单，只更新了一个“transform”属性。两个几何缩放示例的性能都感觉绰绰有余。对于语义缩放，您会注意到 D3 比 Protovis 快得多。这是因为它为每个缩放事件做的工作要少得多。（Protovis 版本必须重新计算所有元素的所有属性。）基于 Canvas 的语义缩放比 SVG 更灵活一些，但 SVG 语义缩放仍然感觉反应灵敏。

**然而，性能没有灵丹妙药，这四种可能的方法并没有开始涵盖所有可能性。**例如，您可以结合几何缩放和语义缩放，使用几何方法进行平移（更新“变换”属性）并在缩放时仅重绘单个圆圈。您甚至可以将这些技术中的一种或多种与 CSS3 转换结合起来以添加一些硬件加速（如在[分层边缘捆绑示例](http://mbostock.github.com/d3/talk/20111116/bundle.html)中），尽管这可能难以实现并且可能会引入视觉伪影。

尽管如此，我个人的偏好是**尽可能多地保留在 SVG 中，并且在渲染成为瓶颈时仅将 Canvas 用于“内循环”**。SVG 为开发提供了如此多的便利——例如 CSS、数据连接和元素检查器——因此从 Canvas 开始通常是为时过早的优化。将 Canvas 与 SVG 结合起来，就像您链接的 Facebook IPO 可视化一样，是一种灵活的方式，可以保留大多数这些便利，同时仍能获得最佳性能。我还在[Cubism.js](http://square.github.com/cubism/)中使用了这种技术，其中时间序列可视化的特殊情况非常适合位图缓存。

正如这些示例所示，您可以将 D3 与 Canvas 一起使用，即使 D3 的某些部分是特定于 SVG 的。另请参阅此[力导向图](http://bl.ocks.org/3180395)和此[碰撞检测示例](http://bl.ocks.org/3231307)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-08T11:45:37.930

我认为在**你的情况下**，画布和 svg 之间的决定不像是在“骑马”或驾驶“保时捷”之间做出决定。对我来说，这更像是关于汽车颜色的决定。

让我解释一下：假设，基于框架的操作

*   画一颗星星，
*   添加一颗星和
*   去掉一颗星

采取线性时间。因此，如果您对框架的决定是好的，它会更快一点，否则会慢一点。

如果您继续假设该框架很快，那么很明显，性能不足是由大量星星引起的，处理它们是任何框架都无法为您做的，至少我不知道对这个。

我想说的是，问题的根源导致了计算几何的一个基本问题，即：[范围搜索](http://en.wikipedia.org/wiki/Range_searching)和计算机图形学的另一个问题：[细节层次](http://en.wikipedia.org/wiki/Level_of_detail)。

为了解决您的性能问题，您需要实现一个好的预处理器，它能够非常快速地找到要显示的星星，并且可能能够根据缩放将靠近的星星聚集在一起。使您的视图保持生动和快速的唯一方法是尽可能减少要绘制的星星数量。

正如您所说，最重要的是性能，而不是我倾向于使用画布，因为它可以在没有 DOM 操作的情况下工作。它还提供了使用 webGL 的机会，从而大大提高了图形性能。

顺便说一句：你检查[过 paper.js](http://paperjs.org/)吗？它使用画布，但模拟矢量图形。

PS：[在本书中](http://shop.oreilly.com/product/0636920013044.do?sortby=publicationDate)，您可以找到关于网络图形、画布、SVG 和 DHTML 的技术、优缺点的非常详细的讨论。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-08-07T15:47:19.507

我最近在一个近乎实时的仪表板（每 5 秒刷新一次）上工作，并选择使用使用画布呈现的图表。

我们尝试了 Highcharts（基于 SVG 的 JavaScript 图表库）和 CanvasJS（基于 Canvas 的 JavaScript 图表库）。尽管 Highcharts 是一个很棒的图表 API 并且提供了更多的功能，但我们还是决定使用 CanvasJS。

我们需要在每个图表中显示至少 15 分钟的数据（可选择选择最多两个小时的范围）。

所以 15 分钟：900 点（每​​秒数据点）x2（折线和条形组合图）x4 图表 = 总共 7200 点。

使用 chrome profiler，CanvasJS 的内存从未超过 30MB，而 Highcharts 的内存使用量超过 600MB。

刷新时间为 5 秒的 CanvasJS 渲染也比 Highcharts 响应速度更快。

我们使用一个计时器（setInterval 5 秒）进行 4 次 REST API 调用，以从连接到 Elasticsearch 的后端服务器中提取数据。JQuery.post() 接收作为数据更新的每个图表。

也就是说，对于离线报告，我会使用 Highcharts，因为它的 API 更灵活。

还有声称使用 SVG 或 Canvas 的 Zing 图表，但没有看过它们。

当性能非常关键时，应考虑使用画布。SVG 的灵活性。并不是说画布框架不灵活，而是画布框架需要做更多的工作才能获得与 svg 框架相同的功能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-05-31T05:22:45.423

还可以查看 Meteor Charts，它建立在 uber fast KineticJS 框架之上：http: [//meteorcharts.com/](http://meteorcharts.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-25T16:31:44.377

我还发现，当我们将带有 SVG 图形的页面打印到 PDF 时，生成的 PDF 仍然包含基于矢量的图像，而如果您打印带有 Canvas 图形的页面，则生成的 PDF 文件中的图像会被光栅化。

# node.js - 当管道传输到可写文件流时，Node.js 请求流结束/停止

> ID：12310028
> 
> 赞同：0
> 
> 时间：2012-09-06T23:56:52.913
> 
> 标签：node.js, twitter, stream, pipe

我正在尝试使用现代 Node.js Streams 将 Twitter 的 Streaming API 中的数据通过 pipe() 传输到文件中。我正在使用我编写的名为[TweetPipe](https://github.com/peeinears/tweet-pipe)的库，它利用[了 EventStream](https://github.com/dominictarr/event-stream)和[Request](https://github.com/mikeal/request)。

设置：

```
var TweetPipe = require('tweet-pipe')
  , fs = require('fs');

var tp = new TweetPipe(myOAuthCreds);
var file = fs.createWriteStream('./tweets.json'); 
```

到 STDOUT 的管道工作并且流保持打开：

```
tp.stream('statuses/filter', { track: ['bieber'] })
  .pipe(tp.stringify())
  .pipe(process.stdout); 
```

管道向文件写入一条推文，然后流静默结束：

```
tp.stream('statuses/filter', { track: ['bieber'] })
  .pipe(tp.stringify())
  .pipe(file); 
```

谁能告诉我为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T21:52:22.197

据此[，](http://docs.nodejitsu.com/articles/advanced/streams/how-to-use-fs-create-write-stream)您应该在由 tp.create 创建的流上创建一个错误处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T19:55:08.433

从这里的情况很难说，听起来流在你预期之前就被清理了。这可以通过多种方式触发，请参见此处[https://github.com/joyent/node/blob/master/lib/stream.js#L89-112](https://github.com/joyent/node/blob/master/lib/stream.js#L89-112)

流可以发出“结束”，然后某些东西就停止了。

虽然我怀疑这是问题所在，但我担心的一件事是这个 [https://github.com/peeinears/tweet-pipe/blob/master/index.js#L173-174](https://github.com/peeinears/tweet-pipe/blob/master/index.js#L173-174) destroy 应该在发出错误*后调用。*

我通常会通过添加日志语句来调试这样的问题，直到我可以看到发生了什么不正确的事情。

您可以发布一个可以运行以重现的脚本吗？（对于额外的点，包括一个 package.json 指定依赖项:)

# python - tls中客户端的证书

> ID：12310029
> 
> 赞同：1
> 
> 时间：2012-09-06T23:56:59.083
> 
> 标签：python, openssl, ssl

我坚持了几天，仍然无法弄清楚。我只想在 python 中构建一个简单的 TLS c/s 通信。对于服务器，我使用 EC2，客户端我使用自己的笔记本电脑。我设置并测试了正常的套接字通信，一切正常。

当我从官方文档尝试[本教程](http://docs.python.org/library/ssl.html#ssl-certificates)时，我遇到了问题。对于以下客户端代码：

```
# require a certificate from the server
ssl_sock = ssl.wrap_socket(s,
                           ca_certs="/etc/ca_certs_file",
                           cert_reqs=ssl.CERT_REQUIRED) 
```

据我所知，这部分`/etc/ca_certs_file`应该是来自 CA 的一些证书。我很困惑我应该在哪里寻找它们。我实际上`/etc/ssl/certs`在 EC2 服务器上找到了一些 .pem 文件，但在客户端（我的笔记本电脑）上什么也没有。

我还尝试根据[本教程在 openssl 上](http://users.dcc.uchile.cl/~pcamacho/tutorial/crypto/openssl/openssl_intro.html)生成用户证书，我按照步骤为服务器生成`cakey.pem`,为客户端，所有这些都在我的 EC2 服务器的同一目录中。当我执行时，它输出错误：`cacert.pem``userkey.pem``usercert-req.pem``openssl ca -in usercert-req.pem -out usercert.pem`

```
Using configuration from /usr/lib/ssl/openssl.cnf
Enter pass phrase for ./demoCA/private/cakey.pem:
unable to load certificate
140420412405408:error:0906D06C:PEM routines:PEM_read_bio:no start line:pem_lib.c:696:Expecting: TRUSTED CERTIFICATE 
```

那么实际上应该如何生成这个证书文件呢？在服务器端生成，然后等待客户端通过空中请求它们，或者在客户端生成，或者从第三方获取并直接在客户端使用？

任何人都可以提供任何指导吗？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T06:39:22.047

这将创建一个自签名证书对，私钥将在同一个文件中：

```
openssl req -new -x509 -days 365 -nodes -out cert.pem -keyout cert.pem 
```

然后从服务器端的python：

```
new_client_socket, address = server_socket.accept()
secured_client_socket = ssl.wrap_socket(new_client_socket,
                                        server_side=True,
                                        certfile='cert.pem',
                                        keyfile='cert.pem',
                                        ssl_version=ssl.PROTOCOL_TLSv1) 
```

和客户端应用程序：

```
unsecured_client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client_socket = ssl.wrap_socket(unsecured_client_socket,
                                ca_certs='cert.pem',
                                cert_reqs=ssl.CERT_REQUIRED,
                                ssl_version=ssl.PROTOCOL_TLSv1) 
```

# asp.net - GridView onrowediting 事件值丢失

> ID：12310031
> 
> 赞同：0
> 
> 时间：2012-09-06T23:57:25.830
> 
> 标签：asp.net, gridview

我正在使用 c# 在 asp.net 上工作，我有一个带有文本框和下拉列表的 gridview。我使用 GridView1_RowDataBound 将数据从 sql 数据库加载到 gridview 中。

我有一个链接按钮，一旦单击它就会带来 GridView1_RowEditing 事件，这使得整行都可以进行编辑。但是当这种情况发生时，对应行的所有数据都消失了。所有的文本框和下拉列表都没有价值。

我该怎么办，所以一旦触发 RowEditing 事件，这些值就会保留在控件上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T00:37:29.093

确保在控件加载后您不是数据绑定。确保仅在确保页面未发布后才为控件填充数据。

```
If Not Page.IsPostBack Then
'Populate control
End If 
```

否则，控件数据将被重置，因为在调用事件`PreInit`之前加载了视图状态数据。`Load`

此外，请确保您已`viewstate`启用，除非您重新填充控制数据。

# html - 如何在 Mobile Safari 中“自动播放”HTML5 音频元素？

> ID：12310036
> 
> 赞同：1
> 
> 时间：2012-09-06T23:58:05.153
> 
> 标签：html, audio, mobile-safari, html5-audio

我正在将车辆仪表板显示单元应用程序移植到浏览器。最大的目标是让它在 Mobile Safari 中完全运行。

这是一个 HTML5/JS 音乐应用程序，它严重依赖 jQuery.load 通过加载页面片段来在不同的“屏幕”之间移动。

问题是当用户选择要播放的曲目时，他们会被带到“正在播放”屏幕，该屏幕应该开始播放曲目。一旦到达此屏幕，曲目就不会播放，用户需要从该屏幕显式单击播放才能开始音频播放。第一次发生这种情况后，自动播放将在应用程序的持续时间内工作。

我了解 Mobile Safari 故意设置了阻止程序以防止音频自动播放，这样 Web 应用程序就不会消耗数据，除非直接响应用户输入。

问题是，我的音频播放是直接响应用户输入的……有点。但是，在我的播放实际开始之前需要发生很多事情，并且这些事情发生在正在播放的页面中（调用 API 以获取要播放的曲目的 URL，报告用户正在播放曲目，获取曲目元数据，yatta yatta yatta） .

为了解决这个问题，我让应用程序在启动时将无声 .1s mp3 文件预加载到音频元素中。然后直接响应单击事件以转换到正在播放的屏幕，我在音频元素上调用 .play() 。

我假设直接响应用户输入调用 .play 将在正在播放的页面中随后调用 .play() 工作，因为这是我之前观察到的行为。

只是，似乎并没有什么不同。

关于如何调整我的流程以便在加载正在播放的屏幕后开始音频播放的任何想法？

编辑：在下面添加了一些代码片段

```
Vehicle.audio = {
        init: function () {
            audioElement.setAttribute("src", "/audioinit.mp3");
            audioElement.play();
        },

        play: function (source) {
            log("VEHICLE: playing audio from source " + source);

            Vehicle.audio.stop();
            audioElement.setAttribute("src", source);
            audioElement.play();
        }, 
```

响应用户选择曲目：

```
$(document).on("click", "a.play-track", function () {
    Vehicle.audio.init();
    /* my wrapper function for jQuery.load() */
    replace_wrap("nowplaying.html");
}); 
```

然后在正在播放的页面上，调用 Vehicle.audio.play()。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-05-31T19:08:14.697

> 问题是，我的音频播放是直接响应用户输入的……有点。但是，在我的播放实际开始之前需要发生很多事情，并且这些事情发生在正在播放的页面中（调用 API 以获取要播放的曲目的 URL，报告用户正在播放曲目，获取曲目元数据，yatta yatta yatta） .

尝试将“touchstart”事件监听器添加到整个“正在播放的页面”，然后同步调用`.play()`音频元素：

```
$(document).one("touchstart", function () {
  Vehicle.audio.init()
}) 
```

这样，只要 iOS 用户触摸正在播放页面上的任何位置，音频就会开始加载/播放。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-05-31T18:18:30.390

AFAIK 这是 iOS 故意设置的限制。在允许脚本开始播放之前，用户必须与设备交互（触摸/单击事件）。

# sql - JDBC 从对象更新单个字段

> ID：12310037
> 
> 赞同：0
> 
> 时间：2012-09-06T23:58:08.070
> 
> 标签：sql, jdbc, sql-update

我正在从对象对表进行 jdbc 更新。该对象有几个属性，我只想用具有值的对象更新我的表。问题是如果它们不在对象中，下面的更新语句将擦除所有省略的值。

例如：

```
 String statementStr = "update users " 
                         + "set firstName = ?, lastName = ?, email = ?, birthday = ?, "
                         + "gender = ?"
                         + "where id = ?;"; 
```

如何修改此语句以仅更新对象中的填充值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T00:06:40.003

如果我理解正确，那么您可以使用`ISNULL()`仅使用不可为空的属性更新字段，否则不更新该字段：

```
UPDATE users 
SET firstName = ISNULL(@nameParam, firstName), 
    lastName = ISNULL(@lastNameParam, lastName), 
    email = ISNULL(@emailParam, email),
    ...
WHERE id = ?; 
```

# google-app-engine - 在为 GAE Search Api 构建代码时需要帮助

> ID：12310041
> 
> 赞同：0
> 
> 时间：2012-09-06T23:58:51.423
> 
> 标签：google-app-engine, full-text-search, google-search-api

我创建了 Document，将其添加到 Index 并使用 GAE Search API 成功搜索文本。请在下面找到示例代码。

```
search.Document(
    fields=[search.TextField(name='id', value=id),
            search.TextField(name='search', value=searchT)])

options = search.QueryOptions(returned_fields=['id'])
results = search.Index(name=_D_INDEX_NAME).search(search.Query(searchTxt, options=options)) 
```

现在我无法理解如何实现下面提到的这些： 一些示例代码将不胜感激。

**要搜索精确查询的多个变体，请使用 ~ 运算符：**
~"car" # 搜索 "car" 和 "cars"
**要构建引用特定字段的查询，请在查询中同时使用字段和值，用冒号分隔：**
字段：值
字段：“作为字符串的值”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:53:29.447

添加文档时，您可以通过定义文档的字段来指定其架构。在你的情况下`id`和`search`.

要搜索仅出现在特定字段中的术语，请使用符号`field:term`

```
search.Index(name=_D_INDEX_NAME).search('search:programming') 
```

要搜索一个术语的多个变体，请使用运算符`~`

```
search.Index(name=_D_INDEX_NAME).search('~car') 
```

但是请注意，这在 dev_appserver 中不起作用。

# python - 用于套接字喋喋不休的python最小数据类型

> ID：12310042
> 
> 赞同：3
> 
> 时间：2012-09-06T23:59:11.500
> 
> 标签：python, sockets, types, byte

可以通过套接字模块发送的最小“数据包”是多少？我只需要发送 16 位数据，2 个字节，这是我必须快速发送的东西，所以我希望它尽可能小。我做了一些“实验”来找到最小的大小，我得到的东西都不小于 28 字节。

试验结果：

```
sys.getsizeof(2) = 28

sys.getsizeof(0b0001) = 28

sys.getsizeof(bytes(0b0001)) = 34

sys.getsizeof('0001') = 66

sys.getsizeof('a') = 60

sys.getsizeof(0b0001000100010001000100010001) = 28

sys.getsizeof(0b000100010001000100010001000100010001) = 32 
```

我只是想知道这是否确实是我可以发送的最小的。

* * *

我还想补充一点，python 很难使用二进制文件。我知道它不像以前那样相关，但对于某些事情来说它很方便。我这么说有两个原因：

1）我似乎无法保留变量二进制，它总是恢复为整数或其他类型。

2）经过测试，我进行了二进制到字节的转换，并将其作为大小：

```
sys.getsizeof(bytes(0b0001001001001001001001001)) = 2396778 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T00:48:19.893

`sys.getsizeof`返回 Python int 的内部大小，而不是 C int。您可以使用`struct.pack`获取 C 字节：

```
>>> import struct
>>> struct.pack('H',32768)  # default endian-ness
'\x00\x80'
>>> struct.pack('>H',32768)  # force big-endian
'\x80\x00' 
```

要发送两个显式字节：

```
>>> struct.pack('BB',100,200)
'd\xc8' 
```

请注意，字节以字符串表示。 `'d'`是 100 的 ASCII 字符，`\xc8`是 200 的十六进制表示法：

```
>>> ord('d')
100
>>> 0xc8
200 
```

您可以获得使用 创建的数据包的结果大小`.pack`。比如两条短裤和一条长的尺寸：

```
>>> struct.calcsize('>HHL')
8 
```

请参阅[结构模块文档](http://docs.python.org/library/struct.html?highlight=struct#struct)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T02:10:14.267

解决您问题的第二部分：

“二进制”是整数的表示，而不是类型。您可以使用`bin()`将二进制表示形式作为字符串。您可以将二进制字符串表示形式转换为using `int`.... `int()`例如

```
>>> x = 1234
>>> bin(x)
'0b10011010010'     # note, this is a string
>>> print int(bin(x), 2)
1234 
```

对于第二部分，我认为您一定弄错了：

```
>>> bytes(0b0001001001001001001001001)
'2396745'
>>> sys.getsizeof(bytes(0b0001001001001001001001001))
44 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-08T02:27:33.100

通过套接字发送的字节数取决于编程语言中数据值的大小。例如，通过新的 TCP 连接向“www.google.com:80”发送单个字节会导致以下数据包流：

```
A->B: 64 byte TCP SYN
B->A: 60 byte TCP SYN+ACK
A->B: 52 byte TCP ACK
A->B: 53 byte TCP packet containing a single byte payload
B->A: 52 byte TCP ACK
A->B: 52 byte TCP FIN
B->A: 52 byte TCP FIN+ACK
A->B: 52 byte TCP FIN 
```

因此，发送单字节有效负载总共需要 437 个字节。UDP 更宽容一点，导致单个字节有效负载仅发送 29 个字节。如果使用原始套接字，则可以将有效负载压缩到 21 个字节。

在任何情况下，将有效负载中的字节数减少到 1 并使用最小的协议（例如，在大多数情况下为 UDP）都与您将获得的一样好。关键尺寸是：

```
IP Header = 20 bytes
IP Header + UDP Header = 20 + 8 = 28 bytes
IP Header + TCP Header = 20 + 20 = 40 bytes 
```

所有各种网络协议都将有效负载字节数限制为整个字节。

要记住的另一件事是，在 IP 标头下方，您拥有任何底层物理层。在标准以太网的情况下，您最终会将所有内容分成 1500 字节的数据包。不管您发送 1 个字节还是 1000 个字节，最终都会在线上发送 1500 个字节。当然，这是一个巨大的过度简化，但这个想法应该已经深入人心——如果你在标准以太网上运行，那么我不会太担心发送几个字节。如果您不需要确认，请将您的使用限制为 UDP。

如果您真的有兴趣，请阅读神圣的[TCP/IP 插图](http://www.kohala.com/start/)系列。

# asp.net-mvc - Asp.net mvc4 - 移动 - 登录在移动 safari (iPad) 上无法正常工作

> ID：12310045
> 
> 赞同：2
> 
> 时间：2012-09-06T23:59:24.623
> 
> 标签：asp.net-mvc, ipad, login

登录后，Request.IsAuthenticated 的值不会保持为真。它可以在所有主要的*桌面*浏览器上完美运行，但不适用于 iPad 上的移动 safari。

我已经尝试了[使用 iPhone UIWebView 时发布的 Asp.Net Forms Authentication](https://stackoverflow.com/questions/4158550/problem-with-asp-net-forms-authentication-when-using-iphone-uiwebview)和[在 iPad 上使用 jQueryMobile 时未存储的 ASP.NET 身份验证 cookie](https://stackoverflow.com/questions/6212841/asp-net-authentication-cookies-not-stored-when-using-jquerymobile-on-ipad)的两种解决方案，但它们似乎都不起作用。知道为什么它不起作用吗？

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T20:19:56.537

抱歉挖掘了一个旧线程，但这是搜索 MVC 和 ipad 登录问题时的最佳结果之一。

我找到的解决方案是强制 web conifg 中身份验证标签的 cookieless="UseCookies" 属性。

```
<authentication mode="Forms">
  <forms loginUrl="~/LogOn" timeout="2880" cookieless="UseCookies"/>
</authentication> 
```

出于某种原因，Mobile Safari 浏览器会发送一个请求无 cookie 会话的标头，如果未设置该属性，它将默认使用会话令牌重写 url。由于某种原因，这并不总是有效，导致登录失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-23T17:12:07.917

我希望没有人会介意我在这一篇上的后期贡献。我遇到了同样的问题：无法从 iPhone Safari 浏览器登录到我的 ASP.NET MVC 4 应用程序。我最终在我的开发机器上打开了相关端口，以允许我的 iPhone 访问在 IISExpress 中运行的应用程序实例，以便我可以调试它。

我在我的应用程序代码中设置了一个断点，并从我的手机发出了相关请求。然后，我将该标头内容与我知道正在运行的请求的标头内容（来自桌面浏览器）进行了比较。我发现没有与 iPhone 请求相关的 cookie 标头信息。

所以...这使我进入了我的 iPhone 的 Safari 设置页面。出于某种原因，我的隐私设置被设置为“接受 Cookie”为“从不”。我将其更改为“来自已访问”，它解决了我的问题。根据 Google 叔叔告诉我的内容，“来自已访问”是 iPhone 的默认设置。我想如果我们想支持“从不”的情况，那么我们就必须查看实现无 cookie 表单身份验证的路径（沿着[这里](http://msdn.microsoft.com/en-us/library/aa479314.aspx)讨论的路线）。

希望对某人有所帮助:)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T09:27:52.463

好的，我通过对响应缓存的一些蛮力解决了这个问题......

```
public void Application_PreSendRequestHeaders(Object sender, EventArgs e)
{
    Response.Cache.SetCacheability(HttpCacheability.NoCache);
} 
```

这会强制将响应头设置为 `Cache-Control:no-cache`强制 iOS6 下的 Safari 停止缓存 POST。

帽子提示[https://stackoverflow.com/a/7087989/10573](https://stackoverflow.com/a/7087989/10573)

# android - android获取用户选择的微调器的值

> ID：12310050
> 
> 赞同：1
> 
> 时间：2012-09-07T00:00:14.033
> 
> 标签：android, android-spinner

我正在开发一个安卓应用程序。这就是我想要的。

有性别微调器；男性和女性。当用户选择男性时，它会出现image1，但是当用户选择女性时，image1会消失。我正在考虑使用 set.alpha(0)。

这是我的代码。

```
public class Froyo2Activity extends Activity {
    Spinner genderSpin;
    ImageView image1;
    Button submit;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_froyo2);

        addButtonListener();
    }

    public void addButtonListener(){
        submit = (Button)findViewById(R.id.submit);
        image1 = (ImageView)findViewById(R.id.imageView1);
        genderSpin = (Spinner)findViewById(R.id.gender_spin);

        submit.setOnClickListener(new OnClickListener(){            
            @Override
            public void onClick(View arg0) {                
                if(genderSpin.getSelectedItemPosition() == 1){
                    image1.setAlpha(0);
                }
            }
        });     
    }
} 
```

这是我在 res/layout 中的代码 froyo2.xml

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/widget54"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent" >

<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="wrap_content"
    android:layout_height="819dp"
    tools:context=".RelativeActivity" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:text="Welcome"
        android:textAppearance="?android:attr/textAppearanceSmall" />

    <LinearLayout
        android:id="@+id/linearLayout1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView1" >

        <TextView
            android:id="@+id/textView2"
            android:layout_width="131dp"
            android:layout_height="wrap_content"
            android:text="Priority Level"
            android:textAppearance="?android:attr/textAppearanceMedium" />

    </LinearLayout>

    <LinearLayout
        android:id="@+id/linearLayout2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignTop="@+id/linearLayout1"
        android:layout_toRightOf="@+id/linearLayout1" >

        <Spinner
            android:id="@+id/prior_spin"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:entries="@array/priorArray"
            android:prompt="@string/prior_prompt" />

    </LinearLayout>

    <LinearLayout
        android:id="@+id/linearLayout3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignTop="@+id/linearLayout2"
        android:layout_toRightOf="@+id/linearLayout2" >

    </LinearLayout>

    <EditText
        android:id="@+id/editText2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/linearLayout2"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/editText1"
        android:ems="10" >

        <requestFocus />
    </EditText>

    <TextView
        android:id="@+id/textView6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/button1"
        android:layout_alignBottom="@+id/button1"
        android:layout_alignParentLeft="true"
        android:text="Age"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Button
        android:id="@+id/button2"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/button1"
        android:layout_alignRight="@+id/button1"
        android:layout_below="@+id/button1"
        android:text="5.1" />

    <Button
        android:id="@+id/button3"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/button2"
        android:layout_alignRight="@+id/button2"
        android:layout_below="@+id/button2"
        android:text="Select ETA" />

    <TextView
        android:id="@+id/textView7"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/button1"
        android:text="BP/P"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textView8"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/button3"
        android:layout_alignBottom="@+id/button3"
        android:layout_alignLeft="@+id/textView9"
        android:text="ETA"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textView9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/button3"
        android:layout_marginTop="15dp"
        android:text="Location"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Button
        android:id="@+id/submit"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_alignRight="@+id/editText6"
        android:text="Submit 5.1" />

    <EditText
        android:id="@+id/editText3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/button3"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/button3"
        android:ems="10"
        android:inputType="textPostalAddress" />

    <EditText
        android:id="@+id/editText4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/editText3"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/editText3"
        android:ems="10" />

    <TextView
        android:id="@+id/textView10"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/textView5"
        android:layout_alignTop="@+id/editText4"
        android:layout_toLeftOf="@+id/editText4"
        android:text="Special Handling"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textView11"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/textView10"
        android:layout_below="@+id/editText4"
        android:layout_marginTop="15dp"
        android:text="Drug"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <EditText
        android:id="@+id/editText5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/editText4"
        android:layout_toRightOf="@+id/textView10"
        android:ems="10" />

    <TextView
        android:id="@+id/textView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/linearLayout2"
        android:text="Firstname"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/linearLayout2"
        android:layout_alignParentRight="true"
        android:layout_alignTop="@+id/textView4"
        android:ems="10" />

    <TextView
        android:id="@+id/textView5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/editText2"
        android:layout_alignBottom="@+id/editText2"
        android:layout_alignRight="@+id/textView4"
        android:text="Lastname"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Button
        android:id="@+id/button1"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/editText2"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/editText2"
        android:text="OriFroyoAge" />

    <EditText
        android:id="@+id/editText6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/editText5"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/editText5"
        android:ems="10" />

    <TextView
        android:id="@+id/textView12"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/editText6"
        android:layout_alignBottom="@+id/editText6"
        android:layout_alignParentLeft="true"
        android:text="Diagnostic"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <ImageView
        android:id="@+id/imageView2"
        android:layout_width="wrap_content"
        android:layout_height="300dp"
        android:layout_alignParentRight="true"
        android:layout_alignTop="@+id/imageView1"
        android:layout_toRightOf="@+id/imageView1"
        android:src="@drawable/back2" />

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="300dp"
        android:layout_below="@+id/editText6"
        android:layout_toRightOf="@+id/textView10"
        android:src="@drawable/malefull" />

    <TextView
        android:id="@+id/textView13"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignTop="@+id/imageView1"
        android:layout_marginTop="124dp"
        android:text="Injury(s)"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/textView1"
        android:layout_toRightOf="@+id/linearLayout2"
        android:layout_weight="1"
        android:text="Gender"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Spinner
        android:id="@+id/gender_spin"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignTop="@+id/textView3"
        android:entries="@array/genderArray"
        android:prompt="@string/gender_prompt" />

</RelativeLayout>
</ScrollView> 
```

这个在 res/layout-land

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/widget54"
android:layout_width="wrap_content"
android:layout_height="fill_parent" >

<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="798dp"
    android:layout_height="wrap_content"
    tools:context=".RelativeActivity" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:text="Welcome"
        android:textAppearance="?android:attr/textAppearanceSmall" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView1"
        android:text="Priority Level"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Spinner
        android:id="@+id/spinner1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView2"
        android:layout_toLeftOf="@+id/spinner2"
        android:entries="@array/priorArray"
        android:prompt="@string/prior_prompt" />

    <Spinner
        android:id="@+id/spinner2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignRight="@+id/textView3"
        android:layout_below="@+id/textView3"
        android:layout_toRightOf="@+id/textView7"
        android:entries="@array/genderArray"
        android:prompt="@string/gender_prompt" />

    <TextView
        android:id="@+id/textView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/spinner1"
        android:text="Firstname"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignRight="@+id/spinner2"
        android:layout_below="@+id/textView4"
        android:ems="10" >

        <requestFocus />
    </EditText>

    <TextView
        android:id="@+id/textView5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/editText1"
        android:text="Lastname"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <EditText
        android:id="@+id/editText2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignRight="@+id/editText1"
        android:layout_below="@+id/textView5"
        android:ems="10" />

    <TextView
        android:id="@+id/textView6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/editText2"
        android:text="Age"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Button
        android:id="@+id/button1"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignRight="@+id/textView5"
        android:layout_below="@+id/textView6"
        android:text="Age" />

    <Button
        android:id="@+id/button2"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignTop="@+id/button1"
        android:layout_toLeftOf="@+id/button3"
        android:layout_toRightOf="@+id/textView4"
        android:text="BP/P" />

    <Button
        android:id="@+id/button3"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/textView8"
        android:layout_alignRight="@+id/editText2"
        android:layout_below="@+id/textView8"
        android:text="ETA" />

    <TextView
        android:id="@+id/textView7"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/button2"
        android:layout_toRightOf="@+id/textView4"
        android:text="BP/P"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textView8"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/button2"
        android:layout_alignLeft="@+id/textView3"
        android:text="ETA"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <ImageView
        android:id="@+id/imageView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/textView1"
        android:layout_toLeftOf="@+id/imageView1"
        android:src="@drawable/malefull" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/spinner1"
        android:layout_toLeftOf="@+id/imageView2"
        android:text="Gender"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textView9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/button1"
        android:text="Location"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <EditText
        android:id="@+id/editText3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView9"
        android:layout_toLeftOf="@+id/imageView2"
        android:ems="10" />

    <TextView
        android:id="@+id/textView10"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/editText3"
        android:text="Special Handling"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <EditText
        android:id="@+id/editText4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignRight="@+id/editText3"
        android:layout_below="@+id/textView10"
        android:ems="10" />

    <TextView
        android:id="@+id/textView11"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/editText4"
        android:text="Drug(s)"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <EditText
        android:id="@+id/editText5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView11"
        android:layout_toLeftOf="@+id/imageView2"
        android:ems="10" />

    <TextView
        android:id="@+id/textView12"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/editText5"
        android:text="Diagnostic"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <EditText
        android:id="@+id/editText6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView12"
        android:layout_toLeftOf="@+id/imageView2"
        android:ems="10" />

    <Button
        android:id="@+id/submit"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/editText6"
        android:text="Submit" />

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView2"
        android:layout_alignParentRight="true"
        android:src="@drawable/back2" />

</RelativeLayout>
</ScrollView> 
```

然后我在模拟器中运行它，当点击按钮提交时，它说强制关闭应用程序。我有断点，我认为`genderSpin.getSelectedItemPosition()`是原因。但是我怎样才能获得用户为微调器选择的值？

感谢您的帮助。

===编辑解决方案。状态已关闭===

感谢那些在这方面帮助我很多的人。这是我的最终解决方案。我需要先让 SpinnerAdapter 检索所选微调器的上下文。

我也跟着教程从[这里](http://developer.android.com/guide/topics/ui/controls/spinner.html)

我的最后一个代码是

```
genderSpin = (Spinner)findViewById(R.id.gender_spin);

    ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this,
            R.array.genderArray, android.R.layout.simple_spinner_item);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    genderSpin.setAdapter(adapter);
    genderSpin.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
        public void onItemSelected(AdapterView<?> parent, View arg1, int pos, long arg3){
            String fontname = parent.getItemAtPosition(pos).toString();
            Toast.makeText(parent.getContext(), "The External Font Is " +fontname, Toast.LENGTH_LONG).show();

        }

        @Override
        public void onNothingSelected(AdapterView<?> arg0) {
            // TODO Auto-generated method stub

        }
    }); 
```

选中微调项后，如果选择女性会吐出“外部字体是女性”，如果选择男性会吐出“外部字体是男性”。谢谢你的帮助。希望这可以为寻求帮助的人提供很好的指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T07:07:32.487

您能否发布您的微调器 OnItemSelectedListener 代码。在按钮 onclick 中，只有您添加了获取微调器位置的代码。下面的代码用于获取用户选择的微调器项目。

```
 Spinner spinner = (Spinner) findViewById(R.id.spinner);
    ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(
            this, R.array.planets_array, android.R.layout.simple_spinner_item);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    spinner.setAdapter(adapter);
    spinner.setOnItemSelectedListener(listener);
    private OnItemSelectedListener listener =new OnItemSelectedListener() {
      //do what ever you want to do when item selected

    public void onItemSelected(AdapterView<?> parent, View arg1, int pos,
            long arg3) {
        // TODO Auto-generated method stub
        fontname=parent.getItemAtPosition(pos).toString();
         Toast.makeText(parent.getContext(), "The External Font Is " +fontname, Toast.LENGTH_LONG).show();
       }
       } 
```

# windows - Windows 上的 oracle 11XE 和 ODT32 - 多个问题

> ID：12310054
> 
> 赞同：0
> 
> 时间：2012-09-07T00:00:44.957
> 
> 标签：windows, oracle

我在 64 位 Windows 2008R2 上安装了 Oracle 11 XE。这是一台开发机器，因此我还安装了 Oracle Developer Tools for .NET（32 位）。这两种安装都带有它们自己的 SQLplus 版本。

我已将这两个 oracle 产品的 tnsnames.ora 和 sqlnet.ora 设置为相同，但我无法从任何一个 SQLplus 连接到本地 XE。我`ORA-12560`每次都明白。Oracle 11 XE 主页也无法启动。

```
 ---TNSNAmes.ora ----
    XE =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = DDSAP236.asxdev.asx.com.au)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = XE)
    )
  )

    EXTPROC_CONNECTION_DATA =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1))
    )
    (CONNECT_DATA =
      (SID = PLSExtProc)
      (PRESENTATION = RO)
    )
  )

    ORACLR_CONNECTION_DATA = 
  (DESCRIPTION = 
    (ADDRESS_LIST = 
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1)) 
    ) 
    (CONNECT_DATA = 
      (SID = CLRExtProc) 
      (PRESENTATION = RO) 
    ) 
  ) 
    ----END TNSNAMEs.ora---

---Listener.Ora ---
SID_LIST_LISTENER =
  (SID_LIST =
    (SID_DESC =
      (SID_NAME = PLSExtProc)
      (ORACLE_HOME = D:\Oracle\11Express\app\oracle\product\11.2.0\server)
      (PROGRAM = extproc)
    )
    (SID_DESC =
      (SID_NAME = CLRExtProc)
      (ORACLE_HOME = D:\Oracle\11Express\app\oracle\product\11.2.0\server)
      (PROGRAM = extproc)
    )
  )

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1))
      (ADDRESS = (PROTOCOL = TCP)(HOST = DMACHINE.MyDomain.com)(PORT = 1521))
    )
  )

DEFAULT_SERVICE_LISTENER = (XE)

--End listener.ora---- 
```

In`services.msc`和`lsntctrl`两者都显示`XElistener`服务已启动。

我想知道我还能检查什么？

1.  我可以在 Win2008R2 上运行 XE（32 位）吗？
2.  我可以在 Win2008R2 上同时运行 XE 和 ODTODAC32 吗？
3.  如何解决 ORA-12560 以便我可以连接到 XE 数据库？

## 附加信息

在这台机器的注册表中，`HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Note\Oracle`我有 5 个文件夹 - 有人可以确认这是否正确吗？文件夹是：

1.  `KEY_` （不确定这是否正确）
2.  `KEY_OracleClient11g_HOME`（Oracle ODT 客户端安装的主目录）
3.  `KEY_EX`（11g EX 安装的家）
4.  `ODP.Net`（ODP 安装的一部分）
5.  `OracleMTSRecoveryService`（ODP 安装的一部分）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T09:52:07.670

如果这确实是您的 TNSNAMES.ORA，那么您的语法被破坏了 - 您在连接别名（每个条目的第一行）前面有额外的空格，这可能会导致您的问题。您的 TNSNAMES.ORA 应如下所示：

```
 XE =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = DDSAP236.asxdev.asx.com.au)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = XE)
    )
  ) 
```

但是，如果您的“真实” TNSNAMES.ORA 是正确的：

*   lsnrctl status 的输出是什么？
*   您的侦听器日志包含什么？
*   sqlplus / as sysdba 工作吗？

# javascript - 将整数从 Input 推送到数组

> ID：12310055
> 
> 赞同：3
> 
> 时间：2012-09-07T00:00:49.333
> 
> 标签：javascript

嗨，我试图将数字推入数组，但似乎无法将输入链接到数组，请提供任何帮助

```
<html>
<body>
<form id="myform">
<input type="text" name="input">
<button onclick="myFunction()">Add number</button>
</form>
<br>
<div id="box"; style="border:1px solid black;width:150px;height:150px;overflow:auto">
</div>
<script>
var number= [];
function myFunction()
{
number.push=("myform")
var x=document.getElementById("box");
x.innerHTML=number.join('<br/>');
}
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T00:04:58.613

你正在分配，什么时候应该打电话。最重要的是，您获取的值是错误的。

```
number.push(document.getElementById('myform')['input'].value); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T00:03:44.203

您正在将表单的 id 添加为字符串。您必须添加该字段的值，以便以后可以获取它：

```
var number= []; 
function myFunction() 
{ 
    var input = document.getElementById('input');
    number.push(input.value);

    var x=document.getElementById("box"); 
    x.innerHTML=number.join('<br/>'); 
} 
```

# iphone - facebook示例中出现异常

> ID：12310056
> 
> 赞同：2
> 
> 时间：2012-09-07T00:00:51.897
> 
> 标签：iphone, ios, xcode

> ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[Facebook authorize:delegate:]: unrecognized selector sent to instance 0x684fe80”

```
- (void)loginToFacebook:(id) loginDelegate
{
    NSLog(@"login facebook method");

    fbServiceRequestingobj = loginDelegate;

    NSArray* permissions = [[NSArray alloc] initWithObjects:@"publish_stream", nil];
    [facebook authorize:permissions delegate:self];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T00:14:15.957

该消息非常简单：`loginDelegate`您设置为委托的参数不响应选择器。在设置参数时验证参数：

```
- (void)loginToFacebook:(id)loginDelegate
{
  assert([loginDelegate respondsToSelector:@selector(authorize:delegate:)]); 
```

在这种情况下很有可能，所讨论的选择器是`@required`您希望采用的协议的一种方法。如果是这样，那么您传递的参数`loginDelegate`将需要实现`authorize:delegate:`协议中声明的方法。

采用协议时，如果您没有实现所需的方法，编译器会通知您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T00:12:41.183

```
[facebook authorize:permissions delegate:self]; 
```

“facebook”对象是否存在此方法？我想不会，因为它说这个方法不存在会崩溃，因此“发送到实例的无法识别的选择器”。

# c++ - 为什么我不能使用 LPCRITICAL_SECTION 和 CRITICAL_SECTION

> ID：12310058
> 
> 赞同：0
> 
> 时间：2012-09-07T00:01:06.883
> 
> 标签：c++

我正在做一个共享项目。我遇到了一些标识符错误，VS C++ 2005 不知道 CRITICAL_SECTION 和 LPCRITICAL_SECTION。

```
LPCRITICAL_SECTION GetReadCS() { return &m_ReadCS; }
LPCRITICAL_SECTION GetWriteCS() { return &m_WriteCS; } 
```

和

```
CRITICAL_SECTION    m_ReadCS;
CRITICAL_SECTION    m_WriteCS; 
```

并得到了一些错误

```
warning C4183: 'GetReadCS': missing return type; assumed to be a member function returning 'int'
warning C4183: 'GetWriteCS': missing return type; assumed to be a member function returning 'int'
error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
error C2146: syntax error : missing ';' before identifier 'm_WriteCS' 
```

为什么 LPCRITICAL_SECTION 和 CRITICAL_SECTION 未定义？如何让 C++ 知道它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T00:04:27.760

你有没有包括windows.h？

```
#include <windows.h> 
```

# mysql - 再次mysql“计数不同”

> ID：12310059
> 
> 赞同：0
> 
> 时间：2012-09-07T00:01:07.460
> 
> 标签：mysql, count

我对mysql计数有一个奇怪的问题。当我执行

```
 SELECT a.inc AS inc,
       a.cls AS cls,
       a.ord AS ord,
       a.fam AS fam,
       a.subfam AS subfam,
       a.gen AS gen,
       aspec AS spec,
       asubspec AS subspec
    FROM a
    WHERE (ainc = 11) 
```

我得到：

![](../Images/d2ba29137ce622cd59aedb3129c1ca0d.png)

没关系，因为我有 2 条记录。

当我执行

```
 SELECT COUNT(DISTINCT a.inc) AS inc,
       COUNT(DISTINCT a.cls) AS cls,
       COUNT(DISTINCT a.ord) AS ord,
       COUNT(DISTINCT a.fam) AS fam,
       COUNT(DISTINCT asubfam) AS subfam,
       COUNT(DISTINCT a.gen) AS gen,
       COUNT(DISTINCT a.spec) AS spec,
       COUNT(DISTINCT a.subspec) AS subspec
    FROM a
    WHERE (a.inc = 11)
    GROUP BY a.inc 
```

我得到

![](../Images/f7171ab710d78baaa80a9e3546c2c4dc.png)

这很奇怪，因为如您所见`gen, spec and subspec`，一行中有 0 值。我知道这`count distinct`不算零值。我想计算所有值！= 0 并且在计数不同之后我想得到

```
`1 | 2 | 2 | 2 | 2 | 1 | 1 | 1 |` 
```

我也尝试：

```
SELECT COUNT(DISTINCT a.inc) AS inc,
       SUM(if(a.cls <> 0, 1, 0)) AS cls,
       SUM(if(a.ord <> 0, 1, 0)) AS ord,
       SUM(if(a.fam <> 0, 1, 0)) AS fam,
       SUM(if(a.subfam <> 0, 1, 0)) AS subfam,
       SUM(if(a.gen <> 0, 1, 0)) AS gen,
       SUM(if(a.spec <> 0, 1, 0)) AS spec,
       SUM(if(a.subspec <> 0, 1, 0)) AS subspec
  FROM a
GROUP BY a.inc 
```

和

```
SELECT COUNT(DISTINCT a.inc) AS inc,
           SUM(DISTINCT if(a.cls <> 0, 1, 0)) AS cls,
           SUM(DISTINCT if(a.ord <> 0, 1, 0)) AS ord,
           SUM(DISTINCT if(a.fam <> 0, 1, 0)) AS fam,
           SUM(DISTINCT if(a.subfam <> 0, 1, 0)) AS subfam,
           SUM(DISTINCT if(a.gen <> 0, 1, 0)) AS gen,
           SUM(DISTINCT if(a.spec <> 0, 1, 0)) AS spec,
           SUM(DISTINCT if(a.subspec <> 0, 1, 0)) AS subspec
FROM a
GROUP BY a.inc 
```

但它不起作用，因为在第一种方法中并没有区分所有大于 0 的重复值；在第二种情况下，它只给出 1 和 0 。
那么，有人可以帮我吗？先感谢您。狮子座

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T00:20:58.227

> 我知道 count distinct 不计算零值。

我不知道你从哪里得到这个想法，但它是不正确的。也许您正在考虑 NULL 值？获得所需结果的一种方法是在不同计数中将 0 视为 NULL。

尝试这样的事情（我也删除了 group by，这没有帮助）：

```
SELECT COUNT(DISTINCT case when a.inc = 0 then null else a.inc end) AS inc,
       COUNT(DISTINCT case when a.cls = 0 then null else a.cls end) AS cls,
       COUNT(DISTINCT case when a.ord = 0 then null else a.ord end) AS ord,
       COUNT(DISTINCT case when a.fam = 0 then null else a.fam end) AS fam,
       COUNT(DISTINCT case when a.subfam = 0 then null else a.subfam end) AS subfam,
       COUNT(DISTINCT case when a.gen = 0 then null else a.gen end) AS gen,
       COUNT(DISTINCT case when a.spec = 0 then null else a.spec end) AS spec,
       COUNT(DISTINCT case when a.subspec = 0 then null else a.subspec end) AS subspec
    FROM a
    WHERE (a.inc = 11) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T00:22:08.263

```
SELECT COUNT(DISTINCT a.inc) AS inc,
       COUNT(DISTINCT NULLIF(a.cls, 0)) AS cls,
       COUNT(DISTINCT NULLIF(a.ord, 0)) AS ord,
       COUNT(DISTINCT NULLIF(a.fam, 0)) AS fam,
       COUNT(DISTINCT NULLIF(a.subfam, 0)) AS subfam,
       COUNT(DISTINCT NULLIF(a.gen, 0)) AS gen,
       COUNT(DISTINCT NULLIF(a.spec, 0)) AS spec,
       COUNT(DISTINCT NULLIF(a.subspec, 0)) AS subspec
FROM a 
```

# jsf-2 - 如何使用 markInitialState 方法？

> ID：12310060
> 
> 赞同：0
> 
> 时间：2012-09-07T00:01:10.427
> 
> 标签：jsf-2, java-ee-6, myfaces, composite-component

如何使用**markInitialState** () 方法？我想保存组件的初始状态。

markInitialState 是为此吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:31:16.043

`markInitialState`[供容器/上下文使用，如此处](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIComponent.html)所示。用于`saveState(FacesContext ct)`您的需要并`restoreState(FacesContext ctx)`恢复相同的对象。干杯

# python - 使 Python 最终从本地目录中读取包

> ID：12310063
> 
> 赞同：0
> 
> 时间：2012-09-07T00:01:15.703
> 
> 标签：python, setuptools, distutils, setup.py

如果我使用安装所有软件包

```
python setup.py install --prefix=~/.local 
```

如何让 Python 从那里而不是从系统范围的版本中读取我的包？我尝试`PYTHONPATH`将编辑`~/.local/lib/python2.x/site-packages/`放在第一位，但它没有帮助。

我认为这`~/.local`是保证在 Python 2.6 及更高版本中首先阅读。这是真的？是否需要一些特殊的东西才能使它成为现实？那将解决问题。现在似乎`PYTHONPATH`路径被合并到`sys.path`但在系统范围`site-packages`目录之后的列表中，使得使用系统范围的版本而不是`~/.local`.

不幸的是，使用`pip`不是一种选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T21:18:33.603

建议您使用`virtualenv`正确的激活脚本，该脚本将负责正确设置 PYTHONPATH，而不会以任何方式弄乱系统范围的 Python 安装

[http://www.virtualenv.org/en/latest/index.html](http://www.virtualenv.org/en/latest/index.html)

# php - Wordpress query_posts('category_name='.get_the_title(). 不会返回带有空格的类别的帖子

> ID：12310066
> 
> 赞同：1
> 
> 时间：2012-09-07T00:01:37.717
> 
> 标签：php, wordpress, templates

我操纵了一个 wordpress “博客”模板，通过使用页面标题作为参考来显示特定类别的帖子。这样我就可以创建一个“新闻”页面，它会自动在页面中填充所有“新闻”类别的帖子。

这段代码完美地写在单字标题上，但它不会调用多字标题上的任何帖子。即：“在新闻中”。该页面没有中断，它只是说“对不起，没有帖子符合您的条件”。

有什么想法吗？

```
<?php
/**
 * Template Name: Category Posts Ultimate Template
 *
 * This template is the default page template. It is used to display content when someone is viewing a
 * singular view of a page ('page' post_type) unless another page template overrules this one.
 * @link http://codex.wordpress.org/Pages
 *
 * @package WooFramework
 * @subpackage Template
 */
    get_header();
    global $woo_options;
    /**
     * The Variables
     *
     * Setup default variables, overriding them if the "Theme Options" have been saved.
     */

        $settings = array(
                        'thumb_w' => 505, 
                        'thumb_h' => 284, 
                        'thumb_align' => 'alignleft',
                        'post_content' => 'excerpt'
                        );

        $settings = woo_get_dynamic_values( $settings );
    ?>
    <!-- #content Starts -->
    <div id="content" class="page col-full">

        <?php woo_main_before(); ?>

        <section id="main" class="col-left"> 

            <?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>
            <h1><?php the_title(); ?></h1>
                <?php the_content(); ?>
            <?php endwhile; else: endif; ?>

        <?php woo_loop_before(); ?> 

        <!-- Does the blog need pagination? -->
        <?php
            if ( get_query_var( 'paged') ) { $paged = get_query_var( 'paged' ); } elseif ( get_query_var( 'page') ) { $paged = get_query_var( 'page' ); } else { $paged = 1; }

            $query_args = array(
                                'post_type' => 'post', 
                                'paged' => $paged
                            );

            remove_filter( 'pre_get_posts', 'woo_exclude_categories_homepage' );

            // The Query

            query_posts('category_name='.get_the_title().'&post_status=publish,future&paged=' . get_query_var('paged'));

            if (have_posts()) { 
                $count = 0;
                while (have_posts()) { the_post(); $count++;
        ?>      

                    <!-- Post Starts -->
                    <article <?php post_class(); ?>>

                        <header>
                            <h1><a href="<?php the_permalink(); ?>" rel="bookmark" title="<?php the_title_attribute(); ?>"><?php the_title(); ?></a></h1>
                        </header>

                        <?php woo_post_meta(); ?>

                        <section class="entry fix">
                            <?php if ( isset( $settings['post_content'] ) && $settings['post_content'] != 'content' ) { woo_image( 'width=' . $settings['thumb_w'] . '&height=' . $settings['thumb_h'] . '&class=thumbnail ' . $settings['thumb_align'] ); } ?>
                            <?php global $more; $more = 0; ?>                                           
                            <?php if ( isset( $settings['post_content'] ) && $settings['post_content'] == 'content' ) { the_content(__( 'Read More...', 'woothemes' ) ); } else { the_excerpt(); } ?>
                        </section>

                        <footer class="post-more">      
                            <?php if ( isset( $settings['post_content'] ) && $settings['post_content'] == 'excerpt' ) { ?>
                            <span class="read-more"><a href="<?php the_permalink(); ?>" title="<?php esc_attr_e( 'Continue Reading &rarr;', 'woothemes' ); ?>" class="button"><?php _e( 'Continue Reading', 'woothemes' ); ?></a></span>
                            <?php } ?>
                        </footer>   

                    </article><!-- /.post -->

                <?php
                        } // End WHILE Loop

                    } else {
                ?>
                    <article <?php post_class(); ?>>
                        <p><?php _e( 'Sorry, no posts matched your criteria.', 'woothemes' ); ?></p>
                    </article><!-- /.post -->
                <?php } // End IF Statement ?> 

        <?php woo_loop_after(); ?>
        <?php woo_pagenav(); ?>
        <?php wp_reset_postdata(); ?>      
        <?php wp_reset_query(); ?>            

        </section><!-- /#main -->

        <?php woo_main_after(); ?>

        <?php get_sidebar(); ?>

    </div><!-- /#content -->

<?php get_footer(); ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T04:01:21.180

它不起作用，因为您的查询中不能有空格。与其按类别名称获取帖子，不如使用类别 slug 之类的东西。这不会有任何空格，对于“新闻中”之类的内容，它可能是“新闻中”。

这肯定取决于您的类别 slug 与标题相比如何命名，但这是我过去成功使用的东西。因此，在执行您的查询之前，我们需要获取标题并将其转换为与类别匹配的新“slug”：

```
// Replace any spaces in the title with dashes
$title_slug = strtolower(str_replace( " ", "-" , the_title_attribute('echo=0') ) );
// Get the category object by using our new title slug
$id_obj = get_category_by_slug($title_slug);
// Get the category id so that we can use that in the query
$cat_id = $id_obj->term_id; 
```

然后，您只需将您的更改`query_posts`为使用类别 ID 而不是名称：

```
query_posts( 'cat='.$cat_id.'&post_status=publish,future&paged='.get_query_var('paged') ); 
```

同样，这可能需要也可能不需要对您的标题名称和/或类别 slug 进行一些调整，但应该适合您！

# node.js - CoffeeScript 中的 Node.js module.exports

> ID：12310070
> 
> 赞同：19
> 
> 时间：2012-09-07T00:02:36.777
> 
> 标签：node.js, coffeescript

我正在研究一个简单的例子；我可以让它与 Javascript 一起工作，但我的 CoffeeScript 版本有问题。

这是person.coffee：

```
module.exports = Person

class Person 
    constructor: (@name) ->

    talk: ->
        console.log "My name is #{@name}" 
```

这里是 index.coffee：

```
Person = require "./person"
emma = new Person "Emma"
emma.talk() 
```

我期待运行 index.coffee 并看到控制台输出“我的名字是 Emma”。相反，我收到一条错误消息 TypeError: undefined in not a function。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-07T00:16:31.663

把`module.exports`线放在底部。

----人.咖啡----

```
class Person 
    constructor: (@name) ->

    talk: ->
        console.log "My name is #{@name}"

module.exports = Person 
```

* * *

```
Person = require "./person" // [Function: Person]
p = new Person "Emma" // { name: 'Emma' } 
```

当您`module.exports`在顶部分配 to 时，`Person`变量仍然是`undefined`.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-04-08T01:56:16.293

你也可以写`person.coffee`：

```
class @Person 
```

然后在中使用以下内容`index.coffee`：

```
{Person} = require './person' 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-12T14:10:35.960

你也可以写

```
module.exports = class Person
  constructor: (@name) ->
    console.log "#{@name} is a person" 
```

然后在`index.coffee`任一

```
bob = new require './person' 'Bob' 
```

或者你可以这样做

```
Person = require './person'
bob = new Person 'bob' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-03T22:43:48.743

这里的各种答案似乎理所当然地认为模块导出的唯一一个对象是类（一种“Java思维方式”）

如果您需要导出多个对象（类、函数等），最好这样编写：

```
exports.Person = class Person
    [...] 
```

```
coffee> { Person } = require "./person"
coffee> p = new Person "Emma" 
```

# bash - awk 搜索和计算标准差不同的结果

> ID：12310075
> 
> 赞同：0
> 
> 时间：2012-09-07T00:03:36.903
> 
> 标签：bash, math, awk, standard-deviation

我正在努力获取 sar 的输出并计算列的标准偏差。我可以使用文件中的单个列成功执行此操作。但是，当我在一个文件中计算同一列时，我正在剥离标题行和平均行等“坏”行，它给了我一个不同的值。

以下是我正在执行此操作的文件：

/tmp/saru.tmp

```
# cat /tmp/saru.tmp
Linux 2.6.32-279.el6.x86_64 (progserver)        09/06/2012      _x86_64_        (4 CPU)

11:09:01 PM     CPU     %user     %nice   %system   %iowait    %steal     %idle
11:10:01 PM     all      0.01      0.00      0.05      0.01      0.00     99.93
11:11:01 PM     all      0.01      0.00      0.06      0.00      0.00     99.92
11:12:01 PM     all      0.01      0.00      0.05      0.01      0.00     99.93
11:13:01 PM     all      0.01      0.00      0.05      0.00      0.00     99.93
11:14:01 PM     all      0.01      0.00      0.04      0.00      0.00     99.95
11:15:01 PM     all      0.01      0.00      0.06      0.00      0.00     99.92
11:16:01 PM     all      0.01      0.00      2.64      0.01      0.01     97.33
11:17:01 PM     all      0.02      0.00     21.96      0.00      0.08     77.94
11:18:01 PM     all      0.02      0.00     21.99      0.00      0.08     77.91
11:19:01 PM     all      0.02      0.00     22.10      0.00      0.09     77.78
11:20:01 PM     all      0.02      0.00     22.06      0.00      0.09     77.83
11:21:01 PM     all      0.02      0.00     22.10      0.03      0.11     77.75
11:22:01 PM     all      0.01      0.00     21.94      0.00      0.09     77.95
11:23:01 PM     all      0.02      0.00     22.15      0.00      0.10     77.73
11:24:01 PM     all      0.02      0.00     22.02      0.00      0.09     77.87
11:25:01 PM     all      0.02      0.00     22.03      0.00      0.13     77.82
11:26:01 PM     all      0.02      0.00     21.96      0.01      0.14     77.86
11:27:01 PM     all      0.02      0.00     22.00      0.00      0.09     77.89
11:28:01 PM     all      0.02      0.00     21.91      0.00      0.09     77.98
11:29:01 PM     all      0.03      0.00     22.02      0.02      0.08     77.85
11:30:01 PM     all      0.14      0.00     22.23      0.01      0.13     77.48
11:31:01 PM     all      0.02      0.00     22.26      0.00      0.16     77.56
11:32:01 PM     all      0.03      0.00     22.04      0.01      0.10     77.83
Average:        all      0.02      0.00     15.29      0.01      0.07     84.61 
```

/tmp/sarustriped.tmp

```
# cat /tmp/sarustriped.tmp                              
0.05
0.06
0.05
0.05
0.04
0.06
2.64
21.96
21.99
22.10
22.06
22.10
21.94
22.15
22.02
22.03
21.96
22.00
21.91
22.02
22.23
22.26
22.04 
```

基于 /tmp/saru.tmp 的计算：

```
# awk  '$1~/^[01]/ && $6~/^[0-9]/ {sum+=$6; array[NR]=$6} END {for(x=1;x<=NR;x++){sumsq+=((array[x]-(sum/NR))**2);}print sqrt(sumsq/NR)}' /tmp/saru.tmp
10.7126 
```

基于 /tmp/sarustriped.tmp 的计算（正确的）

```
# awk '{sum+=$1; array[NR]=$1} END {for(x=1;x<=NR;x++){sumsq+=((array[x]-(sum/NR))**2);}print sqrt(sumsq/NR)}' /tmp/sarustriped.tmp
9.96397 
```

有人可以帮助并告诉我为什么这些结果不同，有没有办法使用单个 awk 命令获得更正的结果。我试图这样做是为了提高性能，因此最好不要使用像 grep 这样的单独命令或其他 awk 命令。

谢谢！

# 更新

所以我尝试了这个......

```
awk  '
  $1~/^[01]/ && $6~/^[0-9]/ {
    numrec += 1
    sum    += $6
    array[numrec] = $6
  } 
  END {
    for(x=1; x<=numrec; x++)
      sumsq += ((array[x]-(sum/numrec))^2)
    print sqrt(sumsq/numrec)
  }
' saru.tmp 
```

它适用于我正在使用的 sar -u 输出。我不明白为什么它不能与其他“列表”一起使用。简而言之，尝试使用 sar -r 第 5 列。它再次给出了错误的答案……输出给出了 1.68891，但实际偏差为 0.107374……这与使用 sar -u 的命令相同。 ....如果您需要我可以提供的文件。只是不确定如何发表新的“完整”评论……所以我只是编辑了旧评论……谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T00:17:18.933

我认为错误在于您的第一条 awk 行（在 saru.tmp 上运行的行）不会忽略无效行，因此当您使用 NR 进行数学运算时，您的结果取决于跳过的行数。当您删除所有无效/跳过的行时，两个程序的结果是相同的。因此，在第一个命令中，您应该在数学中使用有效行数而不是 NR。

这个怎么样？

```
awk '
  $1 ~ /^[01]/ && $6~/^[0-9]/ {
    numrec       += 1
    sum          += $6
    array[numrec] = $6
  } 
  END {
    for(x=1; x<=numrec; x++)
      sumsq += (array[x]-(sum/numrec))^2
    print sqrt(sumsq/numrec)
  }
' saru.tmp 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T00:24:38.860

对于这样的调试问题，最简单的技术就是打印一些基本数据。您可以打印项目数、值的总和以及值的平方和（或与平均值的偏差的平方和）。这可能会告诉您两次运行之间有什么不同。有时，在累积数据时打印出正在累积的值可能会有所帮助。如果我不得不猜测，我怀疑你在计算不合适的行（空白或装饰线），所以计数不同（也许总和也不同）。

我有几个（非标准）程序来进行计算。鉴于文件中多列输出的 23 条相关行`data`，我运行：

```
$ colnum -c 6 data | pstats
# Count    = 23
# Sum(x1)  =  3.557200e+02
# Sum(x2)  =  7.785051e+03
# Mean     =  1.546609e+01
# Std Dev  =  1.018790e+01
# Variance =  1.037934e+02
# Min      =  4.000000e-02
# Max      =  2.226000e+01
$ 
```

这里的标准差是样本标准差而不是总体标准差；差异除以样本的 (N-1) 和总体的 N。

# ruby-on-rails - 如何使用 GIS 数据库测试 Rails 应用程序

> ID：12310085
> 
> 赞同：3
> 
> 时间：2012-09-07T00:04:56.543
> 
> 标签：ruby-on-rails, testing, gis, postgis, rgeo

我正在开发一个 Rails 应用程序（3.2.8），它将使用 activerecord-postgis-adapter 和 activerecord-spatialite-adapater gems 和各种 rgeo 插件。

我想以传统方式使用 Rails 单元和功能测试，但这种测试通常使用随机或垃圾数据。除了最简单的多边形和排列之外，工厂和固定装置显然无济于事。

[这个](https://stackoverflow.com/questions/8866269/gis-sample-data-for-testing-performance)问题提供了指向免费 shapefile 的链接，但使用易于理解的高质量数据为测试数据库播种似乎并不是最好的主意。例如，如果我使用美国的州和县作为我的测试数据，则会错过一个区域仅部分包含多边形的边缘情况。

测试此应用程序的最佳方法是什么？Rails 的 GIS DB 有工厂吗？有没有像 Faker 这样的使用随机数据的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-03T04:03:30.920

我正在研究一个类似的 GIS 数据库。我不知道用于测试地理数据的 Faker 之类的 gem。我相信最好的方法是自己创建种子/测试数据。我采用的方法是使用机械师使用我创建的数据创建蓝图并将其用于测试。

# css - 如何在不拉伸图像的情况下使图像的宽度达到 100%？

> ID：12310088
> 
> 赞同：1
> 
> 时间：2012-09-07T00:05:05.653
> 
> 标签：css, image, background

所以我有一个带有背景图像的 div。无论屏幕尺寸如何，我都希望背景图像始终在屏幕上显示为 100%。我希望图像按比例增长但裁剪高度。我不希望图像拉伸。到目前为止，我所拥有的是：

```
#banner {
background:url(../images/blurry.jpg) no-repeat;
width:100%; 
height:520px;
background-size:100% 100%;

} 
```

目前这是将图像拉伸到 100% 并使图像看起来被拉伸。

任何人都可以帮助我或指出正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T00:06:38.577

使用 CSS3`background-size`属性。将其设置为`cover`。像这样：

`background-size: cover;`

请注意，只有 IE9 及更高版本支持此属性值。IE8 将抱怨不支持的值。`cover`至少从过去几年开始就支持 Chrome 和 Firefox 。

# html - ID 中带有句点的 CSS 选择器

> ID：12310090
> 
> 赞同：110
> 
> 时间：2012-09-07T00:05:18.273
> 
> 标签：html, css, css-selectors

HTML 规范允许在 id 中使用句点 (.)：

`<img id="some.id" />`

但是，使用 CSS ID 选择器规则将*无法*正确匹配：

`#some.id { color: #f00; }`

[ID 选择器](http://www.w3.org/TR/CSS2/selector.html#id-selectors)的 CSS 规范没有提到这种情况。所以我假设它使用标签名称和[类选择器](http://www.w3.org/TR/CSS2/selector.html#class-html)的组合？例如，CSS 规则`a.className`将适用于`<a>`类名为 的所有锚标记 ( ) `className`，例如`<a class="className"></a>`.

是否有可能有一个外部 CSS 文件规则通过其 id 引用一个 HTML 元素，其中有一个句点？

我不希望因为 CSS 规范指定 CSS“[标识符](http://www.w3.org/TR/CSS2/syndata.html#value-def-identifier)”不包含句点作为有效字符。那么这是 HTML 和 CSS 规范之间的根本不匹配吗？使用不同类型的 CSS 选择是我唯一的选择吗？比我更聪明的人可以确认或否认这一点吗？

（我会从 HTML id 属性中删除句点以简化操作，但它是系统生成的 id，因此在这种情况下我无法更改它。）

* * *

## 回答 #1

> 赞同：218
> 
> 时间：2012-09-07T00:12:43.007

在深入研究了规范之后，我发现 CSS 规范确实允许像大多数语言一样转义[反斜杠 ( `\`) 。](http://www.w3.org/TR/CSS2/syndata.html#value-def-identifier)

因此，在我的示例中，以下规则将匹配：

```
#some\.id {
  color: #f00;
} 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-08-06T18:10:55.923

你也可以像这样使用[属性选择器](http://www.w3.org/TR/selectors/#attribute-selectors)：

```
[id='some.id'] {
  color: #f00;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-27T04:36:38.913

由于您使用的是 id，因此您还可以使用 document.getElementById() 将 id 值检查为普通字符串而不是 CSS 选择器。例如，以下也适用：

```
const myElem = document.getElementById("some.id"); 
```

唯一的缺点是，您不能像使用 querySelector 那样限制搜索范围，例如 someElement.querySelector()。但是由于 ID 应该始终是唯一的，因此使用 id 进行文档范围的搜索是有效的。

# sql - SQL - 来自 TableA 的 STRING 作为 INT 传递给 TableB

> ID：12310091
> 
> 赞同：1
> 
> 时间：2012-09-07T00:05:29.020
> 
> 标签：sql, arrays, string, int, comma

我有两张桌子，`TableA`和`TableB`。

*   `TableA`有= `ItemA`" `NVARCHAR(MAX)`1234,1235,1253,1643,2374"。
*   `TableB`有`ItemB`作为`INT(MAX)`。

我需要的是传递`STRING`from`TableA`并将`TableB`每个元素插入一个新行。

有没有更快的方法来做到这一点，而不是遍历`STRING`逗号分隔？

我会将它作为数组或列表传递，但这是无法做到的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T01:02:33.157

使用 CTE，以下应该可以工作：

**架构**

```
CREATE TABLE tbl1 (
  ItemA nvarchar(max))

INSERT INTO tbl1 VALUES ('1234,1235,1253,1643,2374') 
```

**询问**

```
;WITH tmp(Item, ItemA) as (
    SELECT LEFT(ItemA, CHARINDEX(',',ItemA+',')-1),
        STUFF(ItemA, 1, CHARINDEX(',',ItemA+','), '')
    FROM tbl1
    UNION ALL
    SELECT LEFT(ItemA, CHARINDEX(',',ItemA+',')-1),
        STUFF(ItemA, 1, CHARINDEX(',',ItemA+','), '')
    FROM tmp
    WHERE ItemA > ''
)
INSERT INTO TableB (ItemB) SELECT Item FROM tmp 
```

[小提琴](http://sqlfiddle.com/#!3/8fc98/1)

# cakephp - 在 CakePHP 中烘焙

> ID：12310092
> 
> 赞同：-3
> 
> 时间：2012-09-07T00:05:35.560
> 
> 标签：cakephp, cakephp-model, cakephp-bake

设置我的数据库并烘焙后，声明的模型关联不正确。

例如，我没有看到 hasOne，而是看到了 hasAndBelongsToMany

所以我的问题是关于在烘焙时会生成 4 个正确关联的 sql 表的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:20:43.813

快速的答案是，如果你有一个外键，如果你拒绝第一个，bake 将尝试一个 hasMany 关系或一个 hasOne，然后在另一个模型上遵循一个 belongsTo。如果你有一个连接表，它将尝试烘焙一个 hasAndBelongsToMany。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T12:48:42.123

如果您遵循 Cake 约定，那么烘焙工具通常会猜测正确的关系。

您应该阅读[模型关系](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html)页面。

# jquery - 使用日期选择器在文本字段中放置值并发送到函数

> ID：12310093
> 
> 赞同：0
> 
> 时间：2012-09-07T00:05:41.780
> 
> 标签：jquery

如何在使用函数时将日期选择器的值保留在文本区域中？

前任：

```
if($currentSelectionClass == "rowStartDate"){
    $('<input id="selectDateStart" type="text" />')
        .attr('name', 'editStartDate')
        .addClass('editStartDate')
        .appendTo(this)
        .datepicker({onSelect: startDateSubmit()});
    } 
```

以及如何将 datepicker 值发送到我的函数？

功能代码：

```
function startDateSubmit(){
            $selectDateStart = $('#selectDateStart').val();
            $.ajax({ 
                url: '/ajax/training-update.php',
                data: {action: $selectDateStart},
                type: 'POST',
                success: function(output) {
                    alert(output);
                    }
            });
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T00:08:32.827

1.  您需要指定对函数的引用，而不是调用该函数

    ```
    .datepicker({onSelect: startDateSubmit}); 
    ```

2.  您需要在函数声明中添加参数

    ```
    function startDateSubmit(selectedDate) { 
    ```

# ios - 如何在动画块中返回值？

> ID：12310095
> 
> 赞同：1
> 
> 时间：2012-09-07T00:05:52.730
> 
> 标签：ios, xcode, objective-c-blocks, uiviewanimation

我试图在包含动画块的方法中返回一个值。我在下面的代码工作得很好，但似乎应该有更好或更清洁的方法来做到这一点。有一个更好的方法吗？

```
 + (BOOL) flipImageAndTextForView:(UIView *) viewFlipImageAndText IsImageDisplayed:(BOOL) imageFlipDisplayed  flipTextView:(UITextView *) textViewDonate flipImage: (UIImageView *)pictureImage{

            __block BOOL tempBool;

        [UIView transitionWithView:viewFlipImageAndText
                          duration:0.3f
                           options:UIViewAnimationOptionTransitionFlipFromLeft
                        animations:^(void) {
                            if (imageFlipDisplayed)
                            {
                                [viewFlipImageAndText bringSubviewToFront:textViewDonate];
                                tempBool = FALSE;
                            }
                            else
                            {
                                [viewFlipImageAndText bringSubviewToFront:pictureImage];
                                tempBool = TRUE;                            
                            }
                        }
                        completion:^(BOOL finished) {
                            NSLog(@"Done!");
                        }];

        if(tempBool)
        {
            return TRUE;
        }
        else{
            return FALSE;
        }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T00:32:31.360

您的代码存在竞争条件，因为您无法保证在`flipImageAndTextForView:...`方法返回之前正确设置 tempBool。`transitionWithView:duration:options:animations:completion:`不阻塞。在任何情况下，以下几行：

```
 if(tempBool)
    {
        return TRUE;
    }
    else{
        return FALSE;
    } 
```

应该刚刚被替换为：

```
 return tempBool; 
```

如果它以您编写的方式而不是第二种方式工作，那只是这里固有竞争条件的另一个症状。

最好的办法是根本不要像这样构造你的代码。要么`imageFlipDisplayed`完全在动画块之外进行测试，要么使用完成块`transitionWithView:duration:options:animations:completion:`向其他地方发送消息，其中包含动画完成时所需的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T00:26:14.473

问题是该值仅在动画开始时设置，这可能是runLoop的下一次迭代。您可以在 UIView 动画调用之前制作相同的文本，这似乎是一件合理的事情，或者您可以将完成块消息返回给某些东西。

# mysql - 在一个 sql 中加入 3 个表

> ID：12310096
> 
> 赞同：0
> 
> 时间：2012-09-07T00:06:19.193
> 
> 标签：mysql, sql

我有 3 个表，如下所述，

```
table1 'ads'

 id     userid
 1       47
 2       47                    //ads.id  = adcat.adid
 3       45
 4       47

table2  'adcat'

  adid    catid
   1        1
   2        3
   3        3                 // adcat.catid  = categories.id
   4        3

 table3  'categories'

   id        name
    1        mathematic
    2        biolog
    3        leteratur
    4        chemi 
```

我想要的是`categories.id`从`ads.id`.

我试过这个

```
SELECT categories.id, ads.id 
FROM ads 
INNER JOIN adcat ON ads.id = adcat.adid 
INNER JOIN categories ON categories.id = adcat.catid 
```

但它不是由确切的值得出的。

obs ：我没有得到任何错误，只是不准确。任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T00:28:08.720

如果 adcat.catid = categories.id 似乎没有理由进入类别表，这是您需要的唯一值。

```
SELECT ads.id,adcat.catid
FROM ads
INNER JOIN adcat
ON ads.id=adcat.adid 
```

`$row['catid']`与此查询一起使用。

如果将来您需要更多类别的列，那么您将需要双重连接：

```
SELECT categories.id *AS id*,ads.id *AS ads_id*
FROM ads 
INNER JOIN adcat ON ads.id = adcat.adid  
INNER JOIN categories ON categories.id = adcat.catid 
```

`$row['id']`与此查询一起使用。

看到`*AS id*`和`*AS ads_id*`- 删除星星，你给列一个`ALIAS`基本上就像一个昵称，这在许多情况下很方便，但在这种情况下尤其重要，因为两列都具有相同的名称。所以现在你可以调用`$row['id']`并获取 categories.id

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T00:16:57.890

我不确定到底是什么问题，但我认为您不是在尝试基于一个 ads.id 获得所有但单行，如果是这样的话：

```
SELECT categories.id ,ads.id 
FROM ads 
INNER JOIN adcat ON ads.id = adcat.adid  
INNER JOIN categories ON categories.id = adcat.catid
WHERE ads.id = your_id_here 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T00:15:15.577

试试这个：

```
SELECT categories.id, ads.id 
FROM ads, adscat, categories
WHERE ads.id=adcat.adid
AND categories.id = adcat.catid 
```

# xml - XSLT 每 3 次插入一个类

> ID：12310097
> 
> 赞同：1
> 
> 时间：2012-09-07T00:06:19.553
> 
> 标签：xml, xslt

我想我只是提出了一个新问题，也可以帮助同样寻找解决方案的人。我想从每 3 个项目中添加一个类。

这是我的xml代码

```
<groups>
<elements>
<name>//1</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2012-03-04</PostDate>
<trackno></trackno>
</elements>

<elements>
<name>//2</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2011-03-04</PostDate>
<trackno></trackno>
</elements>

<elements>
<name>//3</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2012-07-04</PostDate>
<trackno></trackno>
</elements>

<elements>
<name>//4</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2009-01-04</PostDate>
<trackno></trackno>
</elements>

<elements>
<name>//5</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2009-02-04</PostDate>
<trackno></trackno>
</elements>

<elements>
<name>//6</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2008-06-04</PostDate>
<trackno></trackno>
</elements>

<elements>
<name>//7</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2012-01-04</PostDate>
<trackno></trackno>
</elements>

<elements>
<name>//8</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2012-05-14</PostDate>
<trackno></trackno>
</elements>

<elements>
<name>//9</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2012-05-28</PostDate>
<trackno></trackno>
</elements>

<elements>
<name>//10</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2011-02-25</PostDate>
<trackno></trackno>
</elements>

<elements>
<name>//11</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2011-12-20</PostDate>
<trackno></trackno>
</elements>

<elements>
<name>//12</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2011-11-07</PostDate>
<trackno></trackno>
</elements>

<elements>
<name>//13</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2011-07-09</PostDate>
<trackno></trackno>
</elements>

<elements>
<name>//14</name>
<BOD></BOD>
<description/>
<URL></URL>
<Hobbbies>
<Sport></Sport>
<Music></Music>
</Hobbbies>
<Height></Height>
<PostDate>2005-10-19</PostDate>
<trackno></trackno>
</elements>
</groups> 
```

这是我的 XSLT

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:template match="/">

      <html>
      <body>
        <h2>Try to display only 9 or 12</h2>
          <xsl:for-each select="/groups/elements">
            <xsl:sort select="PostDate" order="descending"/>
            <xsl:if test="not(position() > 10)">
            <b><xsl:value-of select="PostDate" /></b> - 
            <font color='red'><xsl:value-of select="name" /></font>
           <p></p>
           </xsl:if>
          </xsl:for-each>

      </body>
      </html>
    </xsl:template>

    </xsl:stylesheet> 
```

只是想要一种简单的方法来插入课程，非常感谢

我想得到

```
 <div clas="item">

        2012-07-04 - //3 

        2012-05-28 - //9 

       <div class="third"> 2012-05-14 - //8 </div>

        2012-03-04 - //1 

        2012-01-04 - //7 

        <div class="third"> 2011-12-20 - //11 </div>

        2011-11-07 - //12 

        2011-07-09 - //13 

        <div class="third">2011-03-04 - //2  </div>

        2011-02-25 - //10 
      </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T02:08:07.733

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes"/>

    <xsl:template match="/">
      <div class="item">
          <xsl:for-each select="/groups/elements">
            <xsl:sort select="PostDate" order="descending"/>
            <xsl:if test="not(position() > 10)">
                <xsl:choose>
                  <xsl:when test="position() mod 3 = 0">
                  <xsl:text>&#xA;</xsl:text>
                    <div class="third">
                      <xsl:apply-templates select="."/>
                    </div>
                  </xsl:when>
                  <xsl:otherwise>
                  <xsl:text>&#xA;</xsl:text>
                    <xsl:apply-templates select="."/>
                  </xsl:otherwise>
                </xsl:choose>
          </xsl:if>
         </xsl:for-each>
      </div>
    </xsl:template>

    <xsl:template match="elements">
      <xsl:value-of select="PostDate" />
      <xsl:text> - </xsl:text>
      <xsl:value-of select="name" />
    </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<groups>
    <elements>
        <name>//1</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2012-03-04</PostDate>
        <trackno></trackno>
    </elements>
    <elements>
        <name>//2</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2011-03-04</PostDate>
        <trackno></trackno>
    </elements>
    <elements>
        <name>//3</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2012-07-04</PostDate>
        <trackno></trackno>
    </elements>
    <elements>
        <name>//4</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2009-01-04</PostDate>
        <trackno></trackno>
    </elements>
    <elements>
        <name>//5</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2009-02-04</PostDate>
        <trackno></trackno>
    </elements>
    <elements>
        <name>//6</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2008-06-04</PostDate>
        <trackno></trackno>
    </elements>
    <elements>
        <name>//7</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2012-01-04</PostDate>
        <trackno></trackno>
    </elements>
    <elements>
        <name>//8</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2012-05-14</PostDate>
        <trackno></trackno>
    </elements>
    <elements>
        <name>//9</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2012-05-28</PostDate>
        <trackno></trackno>
    </elements>
    <elements>
        <name>//10</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2011-02-25</PostDate>
        <trackno></trackno>
    </elements>
    <elements>
        <name>//11</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2011-12-20</PostDate>
        <trackno></trackno>
    </elements>
    <elements>
        <name>//12</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2011-11-07</PostDate>
        <trackno></trackno>
    </elements>
    <elements>
        <name>//13</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2011-07-09</PostDate>
        <trackno></trackno>
    </elements>
    <elements>
        <name>//14</name>
        <BOD></BOD>
        <description/>
        <URL></URL>
        <Hobbbies>
            <Sport></Sport>
            <Music></Music>
        </Hobbbies>
        <Height></Height>
        <PostDate>2005-10-19</PostDate>
        <trackno></trackno>
    </elements>
</groups> 
```

**产生想要的正确结果：**

```
<div class="item">
2012-07-04 - //3
2012-05-28 - //9
<div class="third">2012-05-14 - //8</div>
2012-03-04 - //1
2012-01-04 - //7
<div class="third">2011-12-20 - //11</div>
2011-11-07 - //12
2011-07-09 - //13
<div class="third">2011-03-04 - //2</div>
2011-02-25 - //10</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T00:26:28.360

我有一段时间没有做过 xsl，所以我的 XSL 有点生疏了。

但是，这应该有效，其中三个对应于每 x 重复的次数

```
 <xsl:when test="position() mod 3 = 0">
     <!-- your xml render here-->
 </xsl:when>
 <xsl:otherwise><!-- your other xml here --> </xsl:otherwise> 
```

mod 运算符也适用于其他场景

# javascript - 移动 Safari - 是否有限制以防止在第一页加载时消耗大量数据？

> ID：12310104
> 
> 赞同：0
> 
> 时间：2012-09-07T00:07:28.580
> 
> 标签：javascript, ios, html, mobile-safari

我有一个 webapp，第一次加载时有一个很长的初始化序列。基本上，它使用 HTML5 localstorage API 调用外部 API 来获取完成后缓存的大量数据。

问题是，它在第​​一次尝试时从未通过 Mobile Safari 中的初始化。每次大约在同一时间，我的 AJAX 调用都会停止触发。当我刷新页面时，它会重新开始初始化，但这次成功了。

如果我清除浏览器缓存并重新开始这个过程，它总是一样的。第一次尝试失败，后续刷新成功。

我知道 Mobile Safari 中存在某些障碍来防止大量消耗数据，除非直接响应用户输入（例如 HTML5 音频标签无法“自动播放”）。

我想知道第一次加载网页是否有类似的地方会立即消耗大量数据。通过刷新，Mobile Safari 会将其视为您的明确许可。

有人知道吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-07T02:38:24.900

我建议您从一个简单、快速加载的基本 html 文件开始，它可以让您的用户立即看到一些东西——即使它只是一个简单的“正在加载...”。

然后使用 ajax 来获取您的“数据负载” `window.onload`，例如使用。理想情况下，为您的用户提供一些可以阅读或与之交互的内容，这样他们就不会注意到等待或进度指示器来知道该站点实际上正在运行。

人们不耐烦，当面对空白屏幕和浏览器加载指示器没有进展时，他们会认为您的网站在几秒钟内就坏了。

*某些障碍......防止大量数据消耗*可能正是出于这个原因，以改善用户体验并防止可怕的网页。

# solr - SOLR/Lucene 是否可以报告额外命名文档的计算分数，即使它们不在前 N 个结果中？

> ID：12310106
> 
> 赞同：1
> 
> 时间：2012-09-07T00:07:57.330
> 
> 标签：solr, lucene, full-text-search

我想向 SOLR/Lucene 提交查询，以及文档 ID 列表。从查询中，我想要通常的 top-N 得分结果，但我也想获得命名文档的分数……不管它们有多低。

谁能想到一种简单/受支持的方法在单个索引扫描中执行此操作，其中“添加”（非排名/固定包含）文档的分数与顶级文档的分数相当/相同 - N个结果？（用专门的类修补 SOLR 是可以的；我想如果没有现有的支持，我可能必须这样做。）

或者如果做不到这一点，是否可以使用后续查询进行模拟，理想情况下，命名文档分数可以缩放到与参考查询的前 N ​​大致相当？

或者——也许对我的预期用途同样好或更好——我是否可以针对包括 M（M=2 或更多）不同查询的 SOLR/Lucene 索引发出单个请求，并返回顶部的结果-N 对于任何 M 个查询，并且对于每个结果都包括其针对所有 M 个不同查询的分数？

（即使在我上面的公式中，我想要与新查询一起评分的文档列表通常也是先前查询的结果。）

解决方案，甚至只是可能的方法的片段表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T06:14:56.727

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T13:43:19.120

我不确定我是否正确理解您想要实现的目标，但不会简单

```
 q: (somequery) OR id: (1 OR 2 OR 4) 
```

足够？如果您希望两个部分都以相同的比例提升（我不确定这是否不是 Solr 的默认行为），您可能需要使用 dismax 或 edismax 并且您的查询将更改为：

```
 q: (somequery)^10 OR id: (1 OR 2 OR 4)^10 
```

然后，您将拥有由 ID 定义的元素和查询结果以相同的方式评分。

# javascript - 通过 JQuery Tree 查看文本文件

> ID：12310111
> 
> 赞同：1
> 
> 时间：2012-09-07T00:09:01.840
> 
> 标签：javascript, jquery, html, tree

我想让一个 JQuery 树通过其中一个以树格式显示我系统上的目录和文件[，](http://coderbay.com/top-jquery-tree-plugins/)如果我单击文本文件，实际文件将在新页面/同一页面上打开。JQuery Tree 插件是否支持该功能，因为我无法看到它支持的示例。同样出于我的目的，哪个 JQuery 插件最明智地实施？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T02:49:43.060

我在一个项目中使用了 jsTree，我使用常用​​的 jQuery .bind() 方法将单击、右键单击和双击事件绑定到每个元素。您可以将事件绑定到节点、获取相关 URL 并加载页面。

我不能代表其他插件，但是将这些事件绑定到 jsTree 是相当轻松的。

# objective-c - 文件名和 Xcode sim 与 ios 设备的奇怪问题

> ID：12310114
> 
> 赞同：0
> 
> 时间：2012-09-07T00:09:24.350
> 
> 标签：objective-c, ios, memory-management

我只是花了一天时间试图弄清楚为什么一些简单的代码没有从资源文件夹中加载图像。只是为了好玩，我进入查找器并将其中一个文件重命名为完全相同的名称并加载。然后我做了其他的 - 只是将它们重命名为相同的名称。我看了看，文件名前后没有任何奇怪的字符或空格。所以现在它们都可以很好地加载到模拟器中的数组中。但是现在在我的设备上，它们没有加载到数组中，返回“nil”并抛出异常。我知道 ios 设备在 sim 不区分大小写的情况下区分大小写，但我检查了这一点，命名一切正常。我唯一能想到的是我的图像是以视网膜（@2x~iphone）命名的，而我的设备不是。但是我有以相同方式命名的图像，用于视网膜，并且加载良好。

我正在使用 imageWithContentsOfFile 加载图像，并在尝试加载图像后收到内存警告。我不确定内存警告是否相关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T00:16:21.303

我认为问题可能出在您的文件命名中。请记住，您应该在应用程序中同时包含视网膜和非视网膜图形。看到您添加了“~iphone”，我假设这是一个通用应用程序，因此您的图像应命名如下：

1.  myImage~iphone.png
2.  myImage@2x~iphone.png
3.  myImage~ipad.png
4.  myImage@2x~ipad.png

然后在您的代码中，您只引用文件名的“myImage”部分，以便 iOS 可以为您整理其余部分。

例如：

```
UIImage *image = [UIImage imageNamed:@"myImage"]; 
```

# postgresql - 带有 ODBC 的 PostgreSQL：“没有参数 $1”

> ID：12310115
> 
> 赞同：1
> 
> 时间：2012-09-07T00:09:52.603
> 
> 标签：postgresql, odbc, parameterized

我有一个插入语句：

```
 `INSERT INTO billData (
      tmStart, tsDuration, eCallDir, ...
    ) VALUES (
      $1,  -- tmStart
      $2,  -- tsDuration
      $3,  -- eCallDir
      ...
    );` 
```

`我`SQLPrepare`用来编译，绑定参数`SQLBindParameter`，执行`SQLExecute`。`

 `在所有这些步骤之后，返回错误代码`42P02`（没有参数 $1）。

顺便说一句：我也在为 MS SQL Server 和 MySQL 使用几乎相同的代码，这两个数据库运行良好，所以我相信我的代码是正确的。

PS：PostgreSQL是v9.1；psqlODBC 是 v9.01.0100-1。

==================================================== ==========
更新：

并且发生以下错误：（`42601`在“，”或附近出现语法错误）当我使用“？”时 作为参数占位符：

```
 `INSERT INTO billData (
      tmStart, tsDuration, eCallDir, ...
    ) VALUES (
      **?**,  -- tmStart
      **?**,  -- tsDuration
      **?**,  -- eCallDir
      ...
    );` 
```

`==================================================== ==========
更新：`

 `根据 jwr 的建议，它在向`UseServerSidePrepare=1`ODBC 连接字符串添加选项后起作用。

非常感谢 ：-）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T06:41:07.243

虽然我确信准备好的语句适用于 PostgreSQL ODBC，但我认为该语句代码有问题。起初，我会删除注释以使此 INSERT 尽可能简单。我刚刚尝试了带有注释和冒号的多行插入，效果很好。我转换了一点我的测试 Python 代码：

```
import odbc

db = odbc.odbc('odbcalias/user/password')
c = db.cursor()
r = c.execute("""INSERT INTO billData (
        tmStart, tsDuration, eCallDir, ...
    ) VALUES (
        ?,  -- tmStart
        ?,  -- tsDuration
        ?,  -- eCallDir
        ...
    );""", (tmStart, tsDuration, eCallDir, ))
print('records inserted: %s' % (r)) 
```

你能用 ActivePython 2.7 试试吗（它已经有`odbc`模块）？

如果它可以工作，则启用 ODBC 跟踪并测试该程序。在 odbc sql 跟踪文件中应该有如下条目：

```
...
python.exe odbc 924-e8c ENTER SQLExecDirect 
        HSTMT               00A029A8
        UCHAR *             0x00B5A480 [      -3] "INSERT INTO test_table(txt) VALUES (?)\ 0"
        SDWORD                    -3

python.exe odbc 924-e8c EXIT  SQLExecDirect  with return code 0 (SQL_SUCCESS)
        HSTMT               00A029A8
        UCHAR *             0x00B5A480 [      -3] "INSERT INTO test_table(txt) VALUES (?)\ 0"
        SDWORD                    -3

python.exe odbc 924-e8c ENTER SQLNumResultCols 
        HSTMT               00A029A8
        SWORD *             0x0021FAA0

python.exe odbc 924-e8c EXIT  SQLNumResultCols  with return code 0 (SQL_SUCCESS)
        HSTMT               00A029A8
        SWORD *             0x0021FAA0 (0)

python.exe odbc 924-e8c ENTER SQLRowCount 
        HSTMT               00A029A8
        SQLLEN *            0x0021FBDC

python.exe odbc 924-e8c EXIT  SQLRowCount  with return code 0 (SQL_SUCCESS)
        HSTMT               00A029A8
        SQLLEN *            0x0021FBDC (1) 
```

然后为您的应用程序进行类似的跟踪，并尝试找出不同之处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T09:48:00.500

==================================================== ========== 更新：

根据 jwr 的建议，它在向`UseServerSidePrepare=1`ODBC 连接字符串添加选项后起作用。

非常感谢 ：-）

注意：`ByteaAsLongVarBinary=1`如果要使用 SQLBindParameter 参数化 bytea 字段，还应添加该选项。``

# vb.net - vb.net - 如何从工作日名称中获取日期编号

> ID：12310123
> 
> 赞同：0
> 
> 时间：2012-09-07T00:10:50.553
> 
> 标签：vb.net, date, dayofweek, weekday

## 长话短说：

我需要 的倒置函数`WeekdayName()`，用以下术语表示：

1.  您提供工作日**名称**（例如星期日）
2.  您将获得对应的工作日**编号**（这取决于返回的第一个工作日`WeekdayName`，例如，如果星期日是一周的第一天，您将获得 1 表示星期日）

## 背景：

我在 vb.net 中使用日期函数。到现在为止还挺好。我正在使用该功能[`WeekdayName()`](http://msdn.microsoft.com/en-us/library/t8dc1aee%28v=vs.80%29.aspx)来设置标签页的标题`TabControl`。我的自定义控件（一种日历控件）包含上述`TabControl`内容，并且可以选择要显示一周中的哪一天。

如果要显示所有日期，`TabControl`将通过迭代上述功能（由系统日历本地化和管理并由我大写）来`TabPage`填充。`WeekdayName()`

如果您只设置周二和周五，您将有两个标签页，其中包含这些标题并排序为`[Tuesday | Friday]`. 如果您决定添加星期三，现在您应该有 3 个标签页：`[Tuesday | Wednesday | Friday]`，依此类推...

为了使标签保持有序，当我需要插入要显示的标签时，我想提供标签的标题以检查新插入的工作日名称，并以这种方式解决订单。

我相信一种解决方法是创建一个带有标签标题字符串的假日期对象，以便有一个例如“星期日”日期，然后使用：[`Weekday()`](http://msdn.microsoft.com/en-us/library/82yfs2zh%28v=vs.80%29.aspx)但我希望有一个 API 解决方案。

**注意：**这**不是**：*如何从日期中获取日期*。

* * *

**编辑：**

正如我们与@jmshapland 讨论的那样，使用默认本地化和系统设置的自定义代码方法可能是：

```
Function WeekdayNumber(day as String)
    ' The following initialization does not necessary go in this function.
    ' The idea is to have a mapping between key day name and index in the
    ' same order as the WeekdayName() method with the default system settings
    Dim weekdayNamesCollection as Collection = New Collection()
    For i = 1 to WEEKDAYS
        Dim wDay as String = WeekdayName(i)
        ' add the day with a key with the same name
        weekdayNamesCollection.add(wDay, wDay)
    Next i

    If weekdayNamesCollection.ContainsKey(day) Then
        Return weekdayNamesCollection.IndexOfKey(day) + 1
    End If

    ' Raise an error as the string 'day' is not in the collection
End Sub 
```

我没有对此进行测试，因为我在没有任何框架和/或 IDE 的计算机中。但基本上，这个想法是返回集合中存储工作日名称的索引（以前，它在系统设置顺序中存储为`WeekdayName()`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:58:47.673

我认为它没有内置功能。但是，如果您使用的是 WeekdayName，那么您应该将其用于您的目的。

```
Public Function WeekDayNumber(ByVal weekName As String) As Integer

    Dim weekNames As New Dictionary(Of String, Integer)

    For i As Integer = 1 To 7
        weekNames.Add(WeekdayName(i), i)
    Next

    Return weekNames(weekName)
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T02:52:20.937

抱歉，如果格式不正确，我从不使用 VB，通常只使用 C#。但是，这应该可以满足您的需求...如果您希望一周的第一天返回 0 而不是 1，只需从 return 语句中删除 + 1。

```
Private Function FindDayOfWeek(day As String) As Integer
    Dim daysOfWeek = CultureInfo.CurrentCulture.DateTimeFormat.DayNames

    Dim counter As Integer = Array.IndexOf(daysOfWeek, WeekdayName(1))
    Dim numericDay As Integer

    For i As Integer = 0 To 6
        If counter > 6 Then
            counter = 0
        End If

        If daysOfWeek(counter) = day Then
            numericDay = i
            Exit For
        End If
        counter += 1
    Next

    Return numericDay + 1
End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-29T05:15:30.703

通过使用`val()`函数，将给出从 0 到 6 的星期数：

`intDayofWeek = val(System.DateTime.Now.DayOfWeek)`

# c++ - 递归 - 子集 - C++

> ID：12310124
> 
> 赞同：0
> 
> 时间：2012-09-07T00:11:19.733
> 
> 标签：c++, recursion

谢谢@Scotty，@paddy。仅供参考，最佳解决方案是：

```
void RecSubsets(string soFar, string rest) {
    if (rest == "") {
        cout << soFar << end;
    }
    else {
      RecSubsets(soFar + rest[0], rest.substr(1));
      RecSubsets(soFar, rest.substr(1));
    }
 }

void CanMakeSum(string set) {
    RecSubsets("", set);
 } 
```

* * *

我正在编写一个简单的程序，通过将数据分成两组（C（n-1，k-1）和C（n-1，k））并递归调用函数来计算一组中所有可能的组合。下面是我写的：

```
void RecSubsets(string soFar, string rest) {
    if (rest == "") cout << soFar << end;
    }
    else {
        for (int i = 0; i < rest.length(); i++) {
            string next = soFar + rest[i];
            string remaining = rest.substr(i+1);
            RecSubsets(next, remaining);
        }
    }
}

void CanMakeSum(string set) {
    RecSubsets("", set);
    RecSubsets("", set.substr(1));
}

int main() {    
    string set = "abcd";
    CanMakeSum(set);
    return 0;
} 
```

因此，对于“abcd”的输入字符串，它会分成 2 组（abcd 和 abc），然后通过递归调用函数来打印出组合。在这个逻辑下，输出应该是：abcd, abc, abd, ab, acd, ac, ad, a... 但是，使用上面的程序，输出是 abcd, abd, acd, ad... 我明白了从概念上讲，我想要实现的目标，但很难将其转换为代码。有人可以指出我哪里出错了吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T00:46:07.203

这是一个很好的尝试。只有两个小问题：

1.  您**不**应该“将数据分成两组 (C(n-1, k-1) & C(n-1, k))”。这就是你的递归函数的用途！

2.  `RecSubsets()`应该**总是**打印出来`soFar`。删除`if (rest == "")`.

例如：

```
void RecSubsets(string soFar, string rest) {
    // First print out "a" or wherever we are up to
    // This ensures we correctly get "ab" and "ac" without trailing characters etc
    cout << soFar << end;

    // Now print out the other combinations that begin with soFar
    // This part of your algorithm was already correct :)
    for (int i = 0; i < rest.length(); i++) {
        string next = soFar + rest[i];
        string remaining = rest.substr(i+1);
        RecSubsets(next, remaining);
    }
}

void CanMakeSum(string set)
{
    RecSubsets("", set);
    // Don't call it a second time here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T02:55:32.027

您希望在后订购而不是预订购中打印结果。另一个答案几乎是正确的，但是您太轻易地忽略了它。它没有进行排列，因为没有对字符串进行重新排序。

按您需要的顺序输出数据的正确代码是：

```
void RecSubsets(string soFar, string rest) {
    for (int i = 0; i < rest.length(); i++) {
        string next = soFar + rest[i];
        string remaining = rest.substr(i+1);
        RecSubsets(next, remaining);
    }
    if( soFar.size() > 0 ) cout << soFar << endl;
} 
```

输出：

```
abcd
abc
abd
ab
acd
ac
ad
a
bcd
bc
bd
b
cd
c
d
bcd
bc
bd
b
cd
c
d 
```

# asp.net-mvc-3 - Multiple PagedList's in View：跟踪每个列表的当前页面

> ID：12310125
> 
> 赞同：1
> 
> 时间：2012-09-07T00:11:54.007
> 
> 标签：asp.net-mvc-3, pagination, pagedlist

我希望 Troy Goode 或其他做过同样事情的人可以在这里提供帮助。我对 ASP.NET MVC 比较陌生。

我有一个带有 View 的 ASP.NET MVC3 应用程序，我在其中实现了两个 PagedList 控件，每个控件显示不同的信息源。

PagedList 控件是否提供了一种方法来跟踪 View 上其他 PagedLists 的当前页码？例如，如果我有：

```
PagedList1 (currently on page 1 of 10)
PagedList2 (currently on page 4 of 10) 
```

我更改了 PagedList1 上的页面，在 View 重新加载后，PagedList2 将保留在第 4 页上。

我考虑过使用 Session 变量，但想知道是否有更优雅的解决方案。

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T01:15:36.920

我终于想出了一个办法。

**型号**：

```
public class ChequeSearch
{
    //Search criteria
    [DisplayName("Draft Number")]
    public string DraftNumber { get; set; }

    [DisplayName("Payee")]
    public string Payee { get; set; }

    //Search results
    public int? SearchResults1Page { get; set; }
    public int? SearchResults2Page { get; set; }
    public IPagedList<Cheque> SearchResults1 { get; set; }
    public IPagedList<Cheque> SearchResults2 { get; set; }
    public string SearchButton { get; set; }
} 
```

**查看**：

在搜索结果表1下：

```
@Html.PagedListPager(Model.SearchResults1,
        page => Url.Action("Search", new RouteValueDictionary() {
            { "SearchResults1Page", page },
            { "SearchResults2Page", Model.SearchResults2Page },
            { "DraftNumber", Model.DraftNumber },
            { "Payee", Model.Payee }
        }),
        PagedListRenderOptions.DefaultPlusFirstAndLast) 
```

在搜索结果表2下：

```
@Html.PagedListPager(Model.SearchResults2,
        page => Url.Action("Search", new RouteValueDictionary() {
            { "SearchResults2Page", page },
            { "SearchResults1Page", Model.SearchResults1Page },
            { "DraftNumber", Model.DraftNumber },
            { "Payee", Model.Payee }
        }),
        PagedListRenderOptions.DefaultPlusFirstAndLast) 
```

感谢您的关注。

# objective-c - 我可以使用 presentModalViewController 显示 SplitViewController 吗？

> ID：12310129
> 
> 赞同：0
> 
> 时间：2012-09-07T00:12:46.363
> 
> 标签：objective-c, ios5, uisplitviewcontroller, xcode4.4

我不知道我想要做的事情是否可能，但因为我没有想要的结果，我猜不是。
我正在尝试并且需要做的是使用presentViewController 从以前的ViewController 调用SplitViewController。
我知道，SplitViewController 必须是 rootViewController，但我需要探索最可能的选项来实现我需要做的事情。
我有一个带按钮的 MainMenu，对于每个按钮，我都需要调用一个 SplitViewController。首先，如何做到这一点？
我要做的是：首先，在 AppDelegate 中，我调用 MainMenu，并添加为子视图和其他内容：

```
-(BOOL)application:(UIApplication*)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
   [window addSubview:self.mainMenu.view];
   [self.mainMenu presentModalViewController:self.firstMenu animated:NO]; 
   [self.window makeKeyAndVisible];

   return YES;
} 
```

然后，在 MainMenu 中，我在模态视图中调用 SecondViewController，使用以下代码：

```
SecondViewController *secV = [[SecondViewController alloc]initWithNibName:@"SecondViewController" bundle:nil];
secV.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
[self presentModalViewController:secV animated:YES]; 
```

在这个 SecondViewController 中，我正在使用以下代码创建具有 Master 和 DetailViewController 的 SplitViewController：

```
-(void)viewDidLoad{
  [super viewDidLoad];
  // Do any additional setup after loading the view from its nib.

  UISplitViewController *splitViewController = [[UISplitViewController alloc]init];

  SecondMenuViewController *secMenu = [[SecondMenuViewController alloc]init];
  UINavigationController *navLef = [[UINavigationController alloc]init];
  [navLef pushViewController:secMenu animated:NO];

  SecondMainViewController *secMain = [[SecondMainViewController alloc]init];
  UINavigationController *navRig = [[UINavigationController alloc]init];
  [navRig pushViewController:secMain animated:NO];

  splitViewController.delegate = secMain;
  splitViewController.viewControllers = [NSArray arrayWithObjects:navLef, navRig, nil];

  MainAppDelegate *mainApp = [[MainAppDelegate alloc]init];
  [mainApp changeRootViewController:splitViewController];

  navRig = nil;
  navLef = nil;
  secMain = nil;
  secMenu = nil;
  splitViewController = nil;
} 
```

如您所见，我在 MainAppDelegate 中调用一个方法来更改视图和 RootViewController，因为 SplitViewController 必须是 RootViewController。这是方法：

```
-(void)changeRootViewController:(UISplitViewController *)splitViewController{
   [self.window addSubview:splitViewController.view];
   self.window.rootViewController = splitViewController;
} 
```

我知道，这看起来像一团糟。当我运行时，SplitViewController 从不显示，所以我假设，我想要做的事情是不可能的？还是我错了？如果它是一切，我该怎么做才能在我的 MainViewController 之后显示一个 SplitViewController？
我正在使用 XCode4.4 和 iOS5 非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T00:42:37.897

一个更好的方法是让你`UISplitViewController`的根视图控制器在`application:didFinishLaunchingWithOptions:`. 然后`MainMenu`在它上面展示你的。您可以更改拆分视图控制器显示的子视图，以对应用户在您的`MainMenu`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T00:51:45.280

首先，`didFinishLaunchingWithOptions:`打电话还为时过早`presentModalViewController`。你甚至还没有一个界面！

其次，您似乎没有根视图控制器（尽管您可能从 nib 获得一个？您应该停止这样做；使用当前应用程序模板中显示的技术）。

第三，注意现在我们有了自定义的容器视图，你根本不需要使用 UISplitViewController；您可以构建自己的视图/视图控制器层次结构，这样做可能会更快乐，因为 UISplitViewController 不是一个构造良好的类。

# mercurial - 两个命名分支的 Mercurial 合并：工作目录没有祖先

> ID：12310131
> 
> 赞同：6
> 
> 时间：2012-09-07T00:12:55.487
> 
> 标签：mercurial

我有两个命名分支，SPRINT_009 和 SPRINT_010。一些变更集已提交到 SPRINT_009，我想合并到 SPRINT_010。我能够毫无问题地将 branch_one 中的变更集合并回默认值。我在将变更集从 branch_one 合并到 branch_two 时遇到问题。

```
default       A -- B -- C -- G -- H -- I -- J -- K -- L -- N -- O -- P
                         \                             \            /
SPRINT_009     D -- E -- F -----------------  ---------- ----------
                                                         \
SPRINT_010                                                M 
```

以下是我正在使用的命令：

```
hg update branch_two
hg merge branch_one 
```

但是我收到以下消息：

```
abort: merging with a working directory ancestor has no effect 
```

有谁知道我到底做错了什么？

**编辑：我添加了图表的图片。绘图是概念性的** ![在此处输入图像描述](../Images/5e1f46a5ff7670feff6ad51dc564d9ea.png)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-20T00:10:49.397

问题是我`hg pull`在尝试合并之前没有执行过。通常我们使用 TortoiseHg 在 Windows 机器上进行开发。我们在支持分支上修改了我们的一个资源的名称，从 fooBAR 到 fooBar，并遇到了[mercurial 大小写折叠](https://www.mercurial-scm.org/wiki/CaseFolding)问题。我们试图通过合并 Linux 机器上的分支来解决这个问题。我太习惯使用 TortoiseHg 以至于忘记了最基本的命令！

# c - 分段错误 C 有限状态机

> ID：12310133
> 
> 赞同：1
> 
> 时间：2012-09-07T00:13:18.517
> 
> 标签：c, segmentation-fault, switch-statement, fault, fsm

我对 C 编程相对较新，我正在尝试制作一个分隔符检查器，但由于某种原因，每次我运行我的代码并获取我的输入来检查分隔符时，它都会出现*分段错误（核心转储）*错误。

下面是主程序的代码：

```
int
main (void)
{
  char* mystring;
  printf ("Please enter a string\n");
  gets(mystring);
  if (fsm(mystring))
    {
      printf ("All matched");
    }
} 
```

似乎它从未进入子程序`fsm`，因为我在`printf`子程序的开头输入了一个权利，它从未出现过。`printf`它确实会询问我的输入，如果我把它放在子程序行之前的主程序中，它会打印出来。

这是我的原型：

```
boolean fsm(char[]); 
```

如果有任何帮助，这里是子程序的开头：

```
boolean fsm (char mystring[])
{
  printf("here\n");
  int counter = -1;
  int state = 0;
  c_stack top;
  c_init_stack (&top);
  while (1)
    {
      switch (state)
    {
    case 0:
      counter = counter + 1;
      if (is_open (*mystring))
        state = 1;
      else if (is_close (*mystring))
        state = 2;
      else if (mystring = '\0')
        state = 3;
      else
        state = 4;
      break; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T00:24:03.263

您正在尝试读入未初始化的`char*`. 仅仅声明`char *mystring`不会给你一个可以使用的字符串：你需要为字符串分配空间。

任何一个：

```
char *mystring = malloc(MAX_STRING_LENGTH); 
```

或者：

```
char mystring[MAX_STRING_LENGTH]; 
```

一旦你有一个缓冲区，使用`fgets`而不是`gets`. `fgets`允许您指定读取字符数的上限，因此`fgets`您`MAX_STRING_LEN`将只能接受与缓冲区容纳的数据一样多的数据。

实际上，由于 C 不初始化自动（局部）变量，`mystring`因此具有未定义的值。它可以指向内存的任何随机部分。当您尝试`gets`使用此内存位置时，您正在尝试写入不属于您的内存。

最后，这个带有单个`=`:的条件`else if (mystring = '\0')`是一个赋值，而不是一个相等测试。

# mysql - 我的 Sql Server .. 卡在某事上

> ID：12310134
> 
> 赞同：0
> 
> 时间：2012-09-07T00:13:20.217
> 
> 标签：mysql

> **可能重复：**
> [mysql_fetch_array() 期望参数 1 是资源，选择中给出的布尔值](https://stackoverflow.com/questions/2973202/mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-in-select)

警告：mysql_num_rows() 期望参数 1 是资源，布尔值在第 108 行的 /var/www/stalker_portal/server/lib/database.class.php 中给出 致命错误：在非对象上调用成员函数 getValueByName()在 /var/www/stalker_portal/server/lib/func.php 第 90 行

这是第 108 行 '$this->total_rows = mysql_num_rows($this->result);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T00:24:20.353

问题出在`$this->result`. 该错误告诉您未返回有效的查询结果 ( `result == FALSE`)。

# c# - 如何从 c/cpp 创建 C# 自定义控件

> ID：12310137
> 
> 赞同：1
> 
> 时间：2012-09-07T00:13:54.583
> 
> 标签：c#, c++, c, custom-controls, windows-ce

有人可以阐明如何从 vc 创建 c# 自定义控件吗？我需要创建一些将在 C# 项目中使用的图形控件，如默认控件，因为性能很重要，而且它在低性能 Windows CE 设备上，我想我必须在 c/cpp 中完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T02:39:11.870

简单直接的答案是你不能。时期。Compact Framework 不支持托管 C++ (C++/CLI)。现在我想您可以将 UI 组件创建为 COM 控件，然后手动滚动托管端的所有 COM 接口内容，但这对于构建、调试和部署来说将是一场噩梦。

您最好只使用不安全的代码，然后在 C# 代码中使用 P/Invokes 来访问您所追求的 Win32 API。对于大多数事情，您可以实现您想要的并获得良好的性能。如果您有一些绝对必须在 C 中完成以提高速度的东西，那么创建一个库，您可以通过 P/Invoke 将缓冲区传递给该库。例如，Imaging 库使用这种类型的机制来创建缩略图等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T02:57:33.367

您可以尝试用 C 编写一个完整的控件，并提供一个非常薄的包装器，以暴露您需要从 C# 中控制的内容。如果我们谈论的是表单控件，它不一定需要遵循 UserControl 或 Control 的模型，这有点复杂，而且这些控件的所有成本都花在了哪里。它非常苛刻。

您还可以研究 WPF，它试图在托管端完成更多工作，从而更快。它有其自身的复杂性。它通常会自行相当智能地合成/“bitblit”，但经常过火，但它比双缓冲表单控件更快（或可以），最终将在双缓冲模式下进行相同的合成，但随着大量虚假获胜消息的处理，速度会变慢。（过于简单化）

因此，与其说不，我认为这些是你的选择。同样，可以在一定程度上控制编写良好的 C 端渲染并获得接近原生性能。

编辑：

我错过了问题的 Windows CE 部分。我的错。我不知道我说的是否适用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T00:18:45.880

我假设您在谈论 WinForms 而不是 Silverlight。

你不需要。

Windows CE 上的 .NET 执行 CIL 的 JIT（与解释它的 Micro Framework 不同，如老式 Java）。在 C# 中编写控件并没有真正的性能损失。最昂贵的操作是绘制，如果您使用 C# 或 C++，那么您将使用 GDI 执行此操作，并且它在 GDI 的函数调用中，其中昂贵的操作所在，您唯一要节省的是托管和之间的编组本土领土，但这确实没有什么意义。

您可能想要使用 C++ 创建 Windows CE GUI 的唯一情况是，如果您正在使用视频或动画框架（如 Flash），并且如果您这样做，那么您将完全使用 C++ 而不是使用 .NET对于您的任何 GUI。

# android - 应该使用哪个 Linux 来构建 Android

> ID：12310138
> 
> 赞同：1
> 
> 时间：2012-09-07T00:14:07.470
> 
> 标签：android, linux, android-build

我必须编译最新版本的 Android。Google Docs 提供了足够的信息，但没有指导您应该使用什么。

我对 Linux 没有太多经验，也不知道应该使用哪一个。哪一个最适合我的需要？

之后，编译最新版本的 Android 需要哪些包作为先决条件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T00:21:49.283

**对于果冻豆：**

操作系统：Ubuntu（也可以在任何其他系统上执行，但对于 ubuntu/其他 debian 发行版存在详细步骤）

**工具：**

> openjdk-6-jdk python git-core android-sdk

**构建工具：**

> git-core gnupg flex bison gperf build-essential zip curl zlib1g-dev libc6-dev ib32ncurses5-dev ia32-libs x11proto-core-dev libx11-dev lib32readline5-dev lib32z-dev libgl1-mesa-dev g++-multilib mingw32 tofrodos python-降价 libxml2-utils

概述构建 jellybean 的步骤在[此处](http://forum.xda-developers.com/showthread.php?t=1762641)，官方 Google 文档[在此处](http://source.android.com/source/initializing.html)。

# php - SimpleXMLElement 文档 - 如何在 SimpleXMLElement 对象中返回子属性的值？

> ID：12310139
> 
> 赞同：0
> 
> 时间：2012-09-07T00:14:11.587
> 
> 标签：php, object, simplexml

这是 XML：

```
<Routes>
    <Route type="source">
        <Table>
            <Tablename>incoming</Tablename>
            <Fields>
                <Fieldsname ref="description" name="Route Name">description</Fieldsname>
                <Fieldsname name="CID Match">cidnum</Fieldsname>
                <Fieldsname name="DID Match">extension</Fieldsname>
                <Fieldsname ref="dest">destination</Fieldsname>
            </Fields>
        </Table>

    </Route>
</Routes> 
```

然后我在 PHP 中对其进行实例化：

```
$doc    = new SimpleXMLElement('routingConfig.xml', null, true); 
```

`print_r($doc->Route[0])`显示了这一点：

```
SimpleXMLElement Object
(
    [@attributes] => Array
        (
            [type] => source
        )

    [comment] => SimpleXMLElement Object
        (
        )

    [Table] => SimpleXMLElement Object
        (
            [Tablename] => incoming
            [comment] => SimpleXMLElement Object
                (
                )

            [Fields] => SimpleXMLElement Object
                (
                    [Fieldsname] => Array
                        (
                            [0] => description
                            [1] => cidnum
                            [2] => extension
                            [3] => destination
                        )

                    [comment] => Array
                        (
                            [0] => SimpleXMLElement Object
                                (
                                )

                            [1] => SimpleXMLElement Object
                                (
                                )

                        )

                )

        )

) 
```

注意根值如何具有`@attributes`数组。为什么`$doc->Routes[0]->Table->Fields->Fieldsname`没有`@attributes`？我意识到我可以通过它获得它`attributes()`，但是有没有办法让它包含在其中`$doc`？

**编辑** 显然`print_r()`不显示数组/对象中的*每个*值，探索所有子对象等。或者除非请求（似乎它应该全部存储在） ，否则可能`SimpleXMLElement`不会返回它。`$doc`如果你这样做`print_r($doc->Route[0]->Table->Fields->Fieldsname[0]);`，它会返回

```
SimpleXMLElement Object
(
    [@attributes] => Array
        (
            [ref] => description
            [name] => Route Name
        )

    [0] => description
) 
```

这显示了我正在寻找的数据。但是如果我做一个`print_r($doc->Route[0]->Table->Field);`数据不会出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T00:46:44.783

该`SimpleXMLElement`对象在 PHP 中做了一些非常高级的事情。它实现了 PHP 提供的许多“神奇”钩子，因此它可以在`foreach()`诸如“黑匣子”之类的情况下工作。因此，正因为如此，使用`print_r()`它会给你带来误导和不完整的信息。你不能依赖`print_r()`（或`var_dump()`）一个`SimpleXMLElement`对象。

在 a 中调试结构的方法`SimpleXMLElement`是简单地查找您所追求的元素：例如`isset($xmlnode->child)`工作之类的东西。所以`is_array($doc->Route[0]->Table->Fields->Fieldsname)`会是真的。

# python - Python计算列表中列表的元素

> ID：12310141
> 
> 赞同：4
> 
> 时间：2012-09-07T00:14:14.570
> 
> 标签：python

假设我有以下列表：

```
L=[ [0,1,1,1],[1,0,1,1],[1,1,0,1],[1,1,1,0] ] 
```

我想编写一个代码，它将获取一个像这样的列表，并告诉我每个列表中“1”的数量是否等于某个数字 x。因此，如果我输入 code(L,3)，则返回值为“True”，因为 L 中的每个列表都包含 3 个“1”。但是，如果我输入 code(L,2)，则返回值为“False”。我是所有编程的新手，所以如果我的问题难以理解，我很抱歉。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T00:15:17.720

要查看每个子列表中是否有 3 个 1，

```
all( x.count(1) == 3 for x in L ) 
```

或者作为一个函数：

```
def count_function(lst,number,value=1):
    return all( x.count(value) == number for x in lst )

L=[ [0,1,1,1],[1,0,1,1],[1,1,0,1],[1,1,1,0] ]
print(count_function(L,3)) #True
print(count_function(L,4)) #False
print(count_function(L,1,value=0)) #True 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T00:28:28.780

如果`L`是您的基本列表并且`n`是`1`您期望在每个“子列表”中的数量，则检查如下所示：

```
map(sum, l) == [n] * len(l) 
```

整个函数以及测试如下所示：

```
>>> def check(l, n):
    return map(sum, l) == [n] * len(l)

>>> L=[ [0,1,1,1],[1,0,1,1],[1,1,0,1],[1,1,1,0] ]
>>> check(L, 3)
True
>>> check(L, 2)
False 
```

**编辑：**替代解决方案包括例如：

*   [`map(lambda x: x.count(1), l) == [n] * len(l)`](http://ideone.com/lDN7U)
*   [`set(i.count(1) for i in l) == {n}`](http://ideone.com/GMxtb)（这个答案中最有效的）

但我相信最干净的方法是其他回答者[之一](https://stackoverflow.com/a/12310146/548696)给出的方法：

```
all(i.count(1) == n for i in l) 
```

它甚至是不言自明的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T00:30:55.287

假设您的列表仅包含 1 和 0，您可以很容易地计算它们：`sum(sl)`. 您可以获取子列表的唯一计数集并测试它们是否都具有三个 1，如下所示：

```
set( sum(sl) for sl in L ) == set([3]) 
```

虽然与使用该方法相比有点晦涩难懂`all()`，但此方法还允许您测试所有子列表是否具有相同数量的子列表，而无需指定数量：

```
len(set( sum(sl) for sl in L )) == 1 
```

您甚至可以“断言”子列表必须都具有相同数量的 1，并在一次操作中发现该数字：

```
[n] = set( sum(sl) for sl in L ) 
```

这会将每个子列表中 1 的数量分配给，但如果子列表不都具有相同的数字，则会`n`引发 a 。`ValueError`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T00:19:14.517

```
def all_has(count, elem, lst)
    """ensure each iterable in lst has exactly `count` of `elem`"""
    return all(sub_list.count(elem) == count for sub_list in lst)

>>> L = [ [0,1,1,1],[1,0,1,1],[1,1,0,1],[1,1,1,0] ]
>>> all_has(3, 1, L)
True
>>> all_has(2, 0, L)
False 
```

# python - 将来自不同列表的两个元素组合成一个坐标元组

> ID：12310143
> 
> 赞同：2
> 
> 时间：2012-09-07T00:14:24.347
> 
> 标签：python, list

所以我在另一个元组的两个列表中有这些元组，看起来像

```
data_tuple = ([(1,2,3),(4,5,6)(7,8,9)],[(a,b,c),(d,e,f)(g,h,i)]) 
```

我想使用每个列表中的相应索引元素构建一组坐标，使其看起来像

```
final = [(2,b),(5,e),(8,h)] 
```

这是我得到的：

```
for a in data_tuple[0]:
    x = a[1]
    for b in data_tuple[1]:
        y = b[1]
        print(x,y) 
```

现在我只想检查我的迭代/缩进是否正确，所以我不需要将它们放在列表中。现在这个特定代码的结果是

```
(2,b)
(2,e)
(2,h)
(5,b)
(5,e) 
```

依此类推，直到达到 (8,h)。

如果我把我的打印线带到左边，在第二个 for 循环下，我得到

```
(2,h)
(5,h)
(8,h) 
```

我该如何解决？对不起，如果我没有任何意义=/。正如你所知道的，我对 Python 非常陌生，所以我不熟悉很多导入模块。请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T00:18:41.460

```
>>> print [(i[0][1],i[1][1]) for i in zip(*data_tuple)]
[(2, 'b'), (5, 'e'), (8, 'h')] 
```

但通常清晰比简洁更重要

我真的不明白你原来的问题，因为它看起来像预期的那样工作，这意味着你的缩进和迭代很好..

[编辑] 这就是我想的你想要的

```
for i in range(len(data_tuple[0]):
    x,y = data_tuple[0][i][1],data_tuple[1][i][1],
    print (x,y) 
```

或者

```
>>> for numbr,letr in zip(*data_tuple):
...     x,y = numbr[1],letr[1]
...     print(x,y)
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T00:39:29.773

假设您总是想要第二个元素：

```
[ (a, b) for ((_,a,_), (_,b,_)) in zip(*data_tuple) ] 
```

请注意，这会产生您指定的结果，但与您的算法不同，后者会产生笛卡尔积。这将因此实现：

```
[ (a, b)
  for (_,a,_) in data_tuple[0]
  for (_,b,_) in data_tuple[1] ] 
```

假设您总是想要第二个元素：

```
[ (a, b) for ((_,a,_), (_,b,_)) in zip(*data_tuple) ] 
```

请注意，这会产生您指定的结果，但与您的算法不同，后者会产生笛卡尔积。这将因此实现：

```
[ (a, b)
  for (_,a,_) in data_tuple[0]
  for (_,b,_) in data_tuple[1] ] 
```

**编辑：**针对您的评论，这是我运行的会话：

```
>>> [ (a, b)
...   for (_,a,_) in data_tuple[0]
...   for (_,b,_) in data_tuple[1] ]
[(2, 'b'), (2, 'e'), (2, 'h'), (5, 'b'), (5, 'e'), (5, 'h'), (8, 'b'), (8, 'e'), (8, 'h')] 
```

这是笛卡尔积，根据您的原始代码。

但是，根据您修改后的问题，我很确定您只想要我提供的第一个代码：

```
>>> [ (a, b) for ((_,a,_), (_,b,_)) in zip(*data_tuple) ]
[(2, 'b'), (5, 'e'), (8, 'h')] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T00:35:02.323

像这样的东西？

```
>>> data_tuple = ([(1,2,3),(4,5,6),(7,8,9)],[("a","b","c"),("d","e","f"),("g","h","i")])
>>> full_numbers_list, full_letters_list = data_tuple
>>> desired_output_idx = (1,)
>>>
>>> results = []
>>> for numbers, letters in zip(full_numbers_list, full_letters_list):
...     assert len(numbers) == len(letters) # make sure assumption is met
...     for i in range(len(numbers)): 
...         if i in desired_output_idx:
...             results.append((numbers[i], letters[i]))
...
>>> results
[(2, 'b'), (5, 'e'), (8, 'h')] 
```

代替使用解包步骤，`data_tuple`您可以使用`*data_tuple`它将解包元组以输入`zip()`函数。

```
>>> zip(*data_tuple)
[((1, 2, 3), ('a', 'b', 'c')), ((4, 5, 6), ('d', 'e', 'f')), ((7, 8, 9), ('g', 'h', 'i'))]
>>>
>>> # *data_tuple is the same as:
>>> numbers, letters = data_tuple
>>> zip(numbers, letters)
[((1, 2, 3), ('a', 'b', 'c')), ((4, 5, 6), ('d', 'e', 'f')), ((7, 8, 9), ('g', 'h', 'i'))] 
```

# mfc - 如何用闪烁改变编辑器的背景颜色？

> ID：12310144
> 
> 赞同：2
> 
> 时间：2012-09-07T00:14:33.533
> 
> 标签：mfc, scintilla

如何用scintilla改变编辑器的背景颜色，我不是很了解scintilla，但确实有效，以及如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T05:46:28.187

```
SendMessage(SCI_STYLESETBACK, STYLE_DEFAULT, RGB(0,0,0)); 
```

此代码将默认样式的背景设置为黑色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T11:41:41.107

`SCI_STYLESETBACK`设置文本的背景颜色。如果它没有产生您正在寻找的结果，请发布屏幕截图。另一个可能对您有帮助的设置是`SCI_SETWHITESPACEBACK`：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-16T08:40:22.777

尝试这个;

```
SendMessage(SCI_STYLESETBACK, 32, (LPARAM)RGB(r, g, b));  // set back-color of window

SendMessage(SCI_STYLESETBACK, 33, (LPARAM)RGB(r, g, b));  // set back-color of margin 
```

# objective-c - 不带 Google 徽标的缩略图 MKMapView

> ID：12310147
> 
> 赞同：0
> 
> 时间：2012-09-07T00:15:23.307
> 
> 标签：objective-c, ios, mkmapview

我正在开发缩略图 MKMapView 以在地图上显示一个奇异点。然而，由于缩略图只有 70x61px，google logo 占据了很大比例的地图。

请您告诉我一种使用 MKMapView 的方法，以便 google 徽标不那么明显或看不到，但避免应用被拒绝，或者使用 MKMapView 的任何替代方法？

先谢谢了。

目前看起来如何：

![在此处输入图像描述](../Images/348a854ec4ebd4da95e2f27471b69c64.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T11:18:26.140

您是否研究过 Google Maps Static API？它返回常规 jpeg 地图而不是交互式地图。您也许可以制作一个 URL，为您的缩略图提供足够小的图像。我不知道根据他们的许可证是否可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T03:07:08.460

开始使用 iOS 6 测试版进行开发。MapKit 发生了重大变化，删除了 Google 作为数据提供者（以及他们的徽标）。iOS 6 的最终版本及其 SDK 将在接下来的几周内发布。因此，您也可以尽快提交 iOS 6 应用程序。

# ios - 无法使用 GCDAsyncSocket 从服务器读取数据

> ID：12310148
> 
> 赞同：1
> 
> 时间：2012-09-07T00:15:27.737
> 
> 标签：ios, cocoa, networking, gcdasyncsocket

我尝试连接到服务器并向服务器发送一些信息（如用户名、密码..），然后服务器将 ID（字符串类型）发回给我。问题是我无法获得ID。有人可以帮我吗？我是IOS编码的初学者。谢谢。

这是代码：

1.  单击按钮后，它将调用我自己的函数来获取字符串的 serverIP 和 int 的端口。
2.  然后该函数将调用此函数来连接服务器：

    ```
    (void)logInCheck {

        asyncSocket = [[GCDAsyncSocket alloc] initWithDelegate:self delegateQueue:dispatch_get_main_queue()];   
        NSError *error = nil;
        uint16_t port = serverPort;

        if (![asyncSocket connectToHost:serverIP onPort:port error:&error])
        {
            DDLogError(@"Unable to connect to due to invalid configuration: %@", error);
        }
        else
        {
            DDLogVerbose(@"Connecting...");
            [self passDataToServer];
        }
    }

    //DataPassToServer is a NSString that hold my data

    (void)passDataToServer
    {
        NSData *requestData = [DataPassToServer dataUsingEncoding:NSUTF8StringEncoding];
        [asyncSocket writeData:requestData withTimeout:-1.0 tag:0];
        [asyncSocket readDataWithTimeout:-1 tag:0];
    }

    //this function call successfully

    -(void)socket:(GCDAsyncSocket *)sock didConnectToHost:(NSString *)host port:(UInt16)port
    {
        DDLogVerbose(@"socket:didConnectToHost:%@ port:%hu", host, port);
    }

    //this function call successfully

    (void)socket:(GCDAsyncSocket *)sock didWriteDataWithTag:(long)tag
    {
        DDLogVerbose(@"socket:didWriteDataWithTag:");
    }

    //This function does not run !!! Nothing print out. 

    (void)socket:(GCDAsyncSocket *)sock didReadData:(NSData *)data withTag:(long)tag
    {
        DDLogVerbose(@"socket:didReadData:withTag:");
        NSString *response = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
        NSLog(@"ID = %@",response);
        [asyncSocket readDataWithTimeout:-1 tag:0];
    } 
    ```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T09:26:34.153

我不知道您的服务器实现，但是，大多数实现会在处理请求之前读取第一个换行符。

因此，请确保您在末尾`[DataPassToServer dataUsingEncoding:NSUTF8StringEncoding]`包含换行符 ( )。`"\n"`

您的代码看起来不错，对我有用。

# javascript - 如何在正则表达式中“计数字符”？

> ID：12310149
> 
> 赞同：2
> 
> 时间：2012-09-07T00:15:40.590
> 
> 标签：javascript, regex

我不确定计数是否是正确的词，因为对我来说有多少并不重要，但让我解释一下。我的数据将像这样格式化：`(hi,(1,2),hey),(yo,(3,(rawr),4),howdy)`我无法控制有多少维度。我想抓住最低的组
`["hi", Array[], "hey"]`，`["yo", Array[], "howdy"]`所以如果有一种方法可以“计数”，我可以计算左括号，然后计算闭括号，当它达到 0 时，这就是正则表达式结束的时候。例如：

```
(hi,(1,2),hey),(yo,(3,(rawr),4),howdy)
1---2---1----0-1---2--3----2--1------0 
```

话虽如此，*我不相信计数是可能的*，但我想要的是一个替代解决方案。这是我到目前为止所拥有的，`/\([^\(]*?\)/`但它只返回来自每个低级别组的最高级别组 aka`(1,2)`和`(rawr)`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T00:43:56.570

您可以使用堆栈来跟踪`(`and `)`。

```
Array.reduce(
    '(hi,(1,2),hey),(yo,(3,(rawr),4),howdy)',
    function(x,y){
        if(y=='(')
            return [x[0]+1, x[1]+(x[0]+1)]
        else if(y==')')
            return [x[0]-1, x[1]+(x[0]-1)]
        else
            return [x[0], x[1]+'-']
    },
    [0,'']
)[1] 
```

`firebug`在控制台中尝试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T01:23:47.667

这适用于原始用例和@Barmar 的用例 - 如果你真的想要的话，它会计算括号......

此外，我在数据字符串中添加了任意空格 - 以防万一（因为您无法控制传入的数据）

```
var results = [];
var dataString = "(hi, (1,2) , hey), ( yo,( 3, ( rawr   ), 4) ,   howdy  )";
//var dataString = "(hi, (1 , 2 ), (3, 4),   hey), (yo ,(3,(rawr ), 4), howdy)";

var dataSplit = dataString.split(",");

var trimRegex = /^\s+|\s+$/g;
var openParensRegex = /\(/;
var closeParensRegex = /\)/;
var parensRegex = /\(|\)/;

var parensCount = 0;

for (var x = 0, lenx = dataSplit.length; x < lenx; x++){
    var cleanString = dataSplit[x].replace(trimRegex, "");

    if (openParensRegex.test(cleanString)){ parensCount++; };

    if (parensCount < 2){
        results.push(cleanString.replace(parensRegex, "").replace(trimRegex, ""));
    };

    if (closeParensRegex.test(cleanString)){ parensCount--; };
};

console.log(results); 
```

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:54:24.450

以下脚本可能会有所帮助，它将识别括号级别：

```
var string="(hi,(1,2),hey),(yo,(3,(rawr),4),howdy)",i=0;
while (string.indexOf("(")>=0) {
    i++;
    string=string.replace(/\(([^()]+)\)/g,"|l"+i+"|$1|l"+i+"|");
} 
```

结果：|l2|hi,|l1|1,2|l1|,hey|l2|,|l3|yo,|l2|3,|l1|rawr|l1|,4|l2|,你好|l3|

小提琴：http: [//jsfiddle.net/GfUZh/](http://jsfiddle.net/GfUZh/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-07T00:41:36.293

如果您想获得最高级别，您可以使用正则表达式通过查找交点来实现，在这种情况下`),(`。

```
var str = '(hi,(1,2),hey),(yo,(3,(rawr),4),howdy)';
var re = /(\(.+\)),(\(.+\))/;
var results = re.exec(str);
results.shift(); // remove first item which is useless
console.log(results); //=> ["(hi,(1,2),hey)", "(yo,(3,(rawr),4),howdy)"] 
```

**演示：http:** [//jsfiddle.net/elclanrs/fFmfE/](http://jsfiddle.net/elclanrs/fFmfE/)

# ember.js - 关于 EmberJS 路由器初始化序列的文档？

> ID：12310152
> 
> 赞同：2
> 
> 时间：2012-09-07T00:15:50.277
> 
> 标签：ember.js, ember-router

任何人都可以在使用 EmberJS 路由器时对初始化序列有所了解[http://emberjs.com/guides/outlets/](http://emberjs.com/guides/outlets/)

在这个控制器中 create 没有被显式调用，每个控制器的数据何时从 Rails 服务器获取。是否仅在调用相应的 connectOutlet 时？

如果有更好的文档可用？

# sql-server - 以第一个字段为中心

> ID：12310157
> 
> 赞同：0
> 
> 时间：2012-09-07T00:16:26.517
> 
> 标签：sql-server

我不知道如何做这项工作......我必须返回我的数据看起来像这样

```
 Vendor1, sum(field1), sum(field2), sum(field3), sum(field4)...
 Vendor2, sum(field1), sum(field2), sum(field3), sum(field4)...
 Vendor3, sum(field1), sum(field2), sum(field3), sum(field4)...
 Vendor4, sum(field1), sum(field2), sum(field3), sum(field4)... 
```

但是，我的数据一直像这样返回

```
 Vendor1, field1, field2, filed3 field4...
 Vendor1, field1, field2, filed3 field4...
 Vendor1, field1, field2, filed3 field4...
 Vendor1, field1, field2, filed3 field4... 
```

这是我到目前为止所拥有的一些东西

```
select substring(a.warehouse, 2, len(a.warehouse)) as 'Name of Vendor',
 Case 
 when b.status = 3 then
 sum(b.id) over (partition by substring(a.warehouse, 2, len(a.warehouse)))
 else 0
 End as 'Number of Orders',
 Case 
 when b.status = 4 then
 sum(b.P_Name) over (partition by substring(a.warehouse, 2, len(a.warehouse)))
 else 0
 End as 'Number of Items'
 from [Table1]a
 join [Table2]b
 on a.OrderID = b.OrderID 
```

我还有许多与所示案例类似的案例陈述。

我不知道的是**`how to pivot this as a grouping`**。

我希望我能清楚地解释事情。感谢您提前提供的所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T06:30:37.810

将整个 select 语句包装在另一个 SELECT 中，然后 GROUP BY。IE：

```
SELECT a.[Name of Vendor], sum(a.[Number of Orders]), sum(a.[Number of Items]), ...
FROM
(
    select substring(a.warehouse, 2, len(a.warehouse)) as 'Name of Vendor',
    Case 
    when b.status = 3 then
    ...
) AS a
GROUP BY a.[Name of Vendor] 
```

# php - 我在 Firefox 中的 php 会话有问题

> ID：12310160
> 
> 赞同：2
> 
> 时间：2012-09-07T00:17:00.527
> 
> 标签：php, firefox

我在 Firefox 中有一个 php 会话问题

将 Firefox 更新到 Firefox 15 后，我在验证码中遇到了问题，我在所有浏览器上对其进行了测试，它运行良好！

在 php 文件的顶部，我放了这行：

```
$_SESSION['captcha']=rand(1000,9999); 
```

在文档中，我用它来显示随机验证码，但它总是显示以前的随机值而不是新的！

**-** `captcha.php`：

```
<?php
    session_start();
    header('content-type:image/jpeg');
    $text=$_SESSION['captcha'];

    $font=34;
    $height=40;
    $width=100;
    $rand=rand(-7,7);
    $image=imagecreate($width,$height);
    imagecolorallocate($image,255,255,255);
    $text_color=imagecolorallocate($image,0,50,80);

    for($i=1;$i<=8;$i++){
        $x1=rand(1,100);
        $y1=rand(1,100);
        $x2=rand(2,100);
        $y2=rand(1,100);

        imageline($image,$x1,$y1,$x2,$y2,$text_color);
    }

    $fontfile='./angelicwar.ttf';
    imagettftext($image,$font,$rand,10,35,$text_color,$fontfile,$text);
    imagejpeg($image);
?> 
```

* * *

```
<?php
    session_start();
    $_SESSION['captcha']=rand(1000,9999);
    echo "<img src='captcha.php'/>";
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T00:28:32.513

无需从脚本生成随机值，将其存储在会话中，然后提供 captcha.php，只需让 captcha.php 生成随机值，将其绘制在图像上，然后将其保存在会话中。

这样，您的验证码值始终与图像上显示的内容相匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T00:19:40.997

试试这个

```
 if (!isset($_SESSION['captcha'])) {
       $_SESSION['captcha']=rand(1000,9999); 
    } 
```

# r - 使用 knitr 时如何配置代码？

> ID：12310161
> 
> 赞同：16
> 
> 时间：2012-09-07T00:17:16.690
> 
> 标签：r, profiling, knitr, evaluate

我正在尝试建立一个工作流程来回答 SO 问题，并使用我的答案和/问题进行格式化`knitr`。 `render_markdown(strict = T )`

最近我试图在一些代码上运行分析，`profr`并且由于 的​​实现`knitr`，分析获取了所有对`evaluate`etc 的调用，这些调用支持`knitr`

例如

# 不在针织品中

如果我在平原上奔跑`R`

```
library(profr)
quantile_ex <- profr({Sys.sleep(1); example(quantile, setRNG = TRUE)}, 0.01)
quantile_ex
##                      f level time start  end  leaf source
## 9       Sys.sleep     1 0.64  0.01 0.65  TRUE   base
## 10        example     1 0.05  0.65 0.70 FALSE  utils
## 11   index.search     2 0.01  0.65 0.66 FALSE   <NA>
## 12    <Anonymous>     2 0.02  0.66 0.68 FALSE   <NA>
## 13         source     2 0.01  0.68 0.69 FALSE   base
## 14         unlink     2 0.01  0.69 0.70  TRUE   base
## 15    file.exists     3 0.01  0.65 0.66  TRUE   base
## 16     prepare_Rd     3 0.01  0.66 0.67 FALSE   <NA>
## 17            of0     3 0.01  0.67 0.68 FALSE   <NA>
## 18           file     3 0.01  0.68 0.69  TRUE   base
## 19   .getHelpFile     4 0.01  0.66 0.67 FALSE   <NA>
## 20            of1     4 0.01  0.67 0.68 FALSE   <NA>
## 21    <Anonymous>     5 0.01  0.66 0.67 FALSE   <NA>
## 22     WriteLines     5 0.01  0.67 0.68 FALSE   <NA>
## 23 lazyLoadDBexec     6 0.01  0.66 0.67 FALSE   base
## 24     writeLines     6 0.01  0.67 0.68 FALSE   base
## 25            fun     7 0.01  0.66 0.67 FALSE   <NA>
## 26         paste0     7 0.01  0.67 0.68 FALSE   base
## 27       basename     8 0.01  0.66 0.67  TRUE   base
## 28             wr     8 0.01  0.67 0.68 FALSE   <NA>
## 29         paste0     9 0.01  0.67 0.68 FALSE   base
## 30        strwrap    10 0.01  0.67 0.68 FALSE   base
## 31         lapply    11 0.01  0.67 0.68 FALSE   base
## 32       strsplit    12 0.01  0.67 0.68  TRUE   base 
```

# 使用 knitr + profr

```
render_markdown(strict = T)
library(profr)
quantile_ex <- profr({
    Sys.sleep(1)
    example(quantile, setRNG = TRUE)
}, 0.01)
quantile_ex

##                      f level time start  end  leaf source
## 8          <Anonymous>     1 0.80  0.00 0.80 FALSE   <NA>
## 9  process_group.block     2 0.80  0.00 0.80 FALSE   <NA>
## 10          call_block     3 0.80  0.00 0.80 FALSE   <NA>
## 11          block_exec     4 0.80  0.00 0.80 FALSE   <NA>
## 12            evaluate     5 0.80  0.00 0.80 FALSE   <NA>
## 13              unlist     6 0.80  0.00 0.80 FALSE   base
## 14              mapply     7 0.80  0.00 0.80 FALSE   base
## 15         <Anonymous>     8 0.80  0.00 0.80 FALSE   <NA>
## 16                 try     9 0.80  0.00 0.80 FALSE   base
## 17            tryCatch    10 0.80  0.00 0.80 FALSE   base
## 18        tryCatchList    11 0.80  0.00 0.80 FALSE   <NA>
## 19         tryCatchOne    12 0.80  0.00 0.80 FALSE   <NA>
## 20          doTryCatch    13 0.80  0.00 0.80 FALSE   <NA>
## 21 withCallingHandlers    14 0.80  0.00 0.80 FALSE   base
## 22         withVisible    15 0.80  0.00 0.80 FALSE   base
## 23                eval    16 0.80  0.00 0.80 FALSE   base
## 24                eval    17 0.80  0.00 0.80 FALSE   base
## 25               profr    18 0.80  0.00 0.80 FALSE  profr
## 26                 try    19 0.80  0.00 0.80 FALSE   base
## 27            tryCatch    20 0.80  0.00 0.80 FALSE   base
## 28        tryCatchList    21 0.80  0.00 0.80 FALSE   <NA>
## 29         tryCatchOne    22 0.80  0.00 0.80 FALSE   <NA>
## 30          doTryCatch    23 0.80  0.00 0.80 FALSE   <NA>
## 31               force    24 0.80  0.00 0.80 FALSE   base
## 32           Sys.sleep    25 0.77  0.00 0.77  TRUE   base
## 33             example    25 0.03  0.77 0.80 FALSE  utils
## 34         <Anonymous>    26 0.02  0.77 0.79 FALSE   <NA>
## 35              source    26 0.01  0.79 0.80 FALSE   base
## 36          prepare_Rd    27 0.01  0.77 0.78 FALSE   <NA>
## 37              render    27 0.01  0.78 0.79 FALSE   <NA>
## 38         withVisible    27 0.01  0.79 0.80 FALSE   base
## 39        .getHelpFile    28 0.01  0.77 0.78 FALSE   <NA>
## 40                 of0    28 0.01  0.78 0.79 FALSE   <NA>
## 41                eval    28 0.01  0.79 0.80 FALSE   base
## 42         <Anonymous>    29 0.01  0.77 0.78 FALSE   <NA>
## 43                 of1    29 0.01  0.78 0.79 FALSE   <NA>
## 44                eval    29 0.01  0.79 0.80 FALSE   base
## 45      lazyLoadDBexec    30 0.01  0.77 0.78 FALSE   base
## 46          WriteLines    30 0.01  0.78 0.79 FALSE   <NA>
## 47            quantile    30 0.01  0.79 0.80 FALSE  stats
## 48                 fun    31 0.01  0.77 0.78 FALSE   <NA>
## 49          writeLines    31 0.01  0.78 0.79  TRUE   base
## 50    quantile.default    31 0.01  0.79 0.80 FALSE  stats
## 51               fetch    32 0.01  0.77 0.78 FALSE   <NA>
## 52               paste    32 0.01  0.79 0.80  TRUE   base
## 53         <Anonymous>    33 0.01  0.77 0.78 FALSE   <NA>
## 54       existsInFrame    34 0.01  0.77 0.78  TRUE   <NA> 
```

# 使用 knitr + Rprof + profr::parse_rprof

```
tmp <- tempfile()
Rprof(tmp, interval = 0.01)
try(force(quantile_ex <- profr({
    Sys.sleep(1)
    example(quantile, setRNG = TRUE)
}, 0.01)))
Rprof(NULL)
parsed <- parse_rprof(tmp, interval = 0.01)

## Error: invalid 'envir' argument 
```

`parse_rprof`由于环境问题无法运行

# knitr + Rprof + summaryRprof

使用`utils::summaryRprof` 遗嘱阅读和总结

```
summaryRprof(tmp)

## $by.self
##       self.time self.pct total.time total.pct
## Rprof      0.01      100       0.01       100
## 
## $by.total
##                     total.time total.pct self.time self.pct
## Rprof                     0.01       100      0.01      100
## <Anonymous>               0.01       100      0.00        0
## block_exec                0.01       100      0.00        0
## call_block                0.01       100      0.00        0
## doTryCatch                0.01       100      0.00        0
## eval                      0.01       100      0.00        0
## evaluate                  0.01       100      0.00        0
## knit                      0.01       100      0.00        0
## mapply                    0.01       100      0.00        0
## process_file              0.01       100      0.00        0
## process_group.block       0.01       100      0.00        0
## try                       0.01       100      0.00        0
## tryCatch                  0.01       100      0.00        0
## tryCatchList              0.01       100      0.00        0
## tryCatchOne               0.01       100      0.00        0
## unlist                    0.01       100      0.00        0
## withCallingHandlers       0.01       100      0.00        0
## withVisible               0.01       100      0.00        0
## 
## $sample.interval
## [1] 0.01
## 
## $sampling.time
## [1] 0.01
## 
```

它似乎并没有真正描述运行的代码，只有`knitr`/`evaluate`细节。

# 问题和可能的解决方案

我目前的工作流程是在 knitr 之外运行分析，但我发现自动格式化（用 注释掉输出`##`）非常有用。

有没有人遇到过一个巧妙的解决方案，或者是否需要与包开发人员一起讨论？

我目前的想法是重写`parse_rprof`以将自身限制为高于第一次调用的调用`force`（不是默认级别 7）

# profr 的示例重写

`profr`这是*几乎*有效的重写

```
library(profr)
profr <- function(expr, interval = 0.02, quiet = TRUE) {
    tmp <- tempfile()
    on.exit(unlink(tmp))
    on.exit(unlink("Rprof.out"), add = T)
    if (quiet) {
        tc <- textConnection(NULL, "w")
        sink(tc)
        on.exit(sink(), add = TRUE)
        on.exit(close(tc), add = TRUE)
    }
    Rprof(tmp, append = TRUE, interval = interval)
    try(force(expr))
    Rprof(NULL)
    parsed <- parse_rprof(tmp, interval)
    which_force <- min(which(parsed$f == "force"))

    parsed <- parsed[parsed$level > parsed$level[which_force], ]
    parsed$level <- parsed$level - parsed$level[which_force]
    parsed
}

quantile_ex <- profr({
    Sys.sleep(1)
    example(quantile, setRNG = TRUE)
}, 0.01)
quantile_ex

##                 f level time start  end  leaf source
## 32      Sys.sleep    NA 0.90  0.00 0.90  TRUE   base
## 33        example    NA 0.03  0.90 0.93 FALSE  utils
## 34    <Anonymous>    NA 0.03  0.90 0.93 FALSE   <NA>
## 35     prepare_Rd    NA 0.01  0.90 0.91 FALSE   <NA>
## 36         render    NA 0.02  0.91 0.93 FALSE   <NA>
## 37   .getHelpFile    NA 0.01  0.90 0.91 FALSE   <NA>
## 38           %in%    NA 0.01  0.91 0.92  TRUE   base
## 39            of0    NA 0.01  0.92 0.93 FALSE   <NA>
## 40    <Anonymous>    NA 0.01  0.90 0.91 FALSE   <NA>
## 41            of1    NA 0.01  0.92 0.93 FALSE   <NA>
## 42 lazyLoadDBexec    NA 0.01  0.90 0.91 FALSE   base
## 43     WriteLines    NA 0.01  0.92 0.93 FALSE   <NA>
## 44            fun    NA 0.01  0.90 0.91 FALSE   <NA>
## 45     writeLines    NA 0.01  0.92 0.93 FALSE   base
## 46          fetch    NA 0.01  0.90 0.91  TRUE   <NA>
## 47         paste0    NA 0.01  0.92 0.93 FALSE   base
## 48          remap    NA 0.01  0.92 0.93 FALSE   <NA>
## 49           psub    NA 0.01  0.92 0.93  TRUE   <NA> 
```

然而，结果与普通的不一样`R`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-08T08:05:08.033

`profrk-setup`像这样的大块的东西怎么样

```
library(profr)

profrk <- function(expr, delay = 1, interval = 0.02, quiet) {
    profrk_marker <- function(expr) {
        eval(expr)
    }

    filter <- function(prof.out) {
        level.filter <- prof.out$level[which(prof.out == "profrk_marker")] + 
            2

        prof.out <- prof.out[prof.out$level > level.filter, ]
        time.offset <- min(prof.out$start)

        prof.out$start <- prof.out$start - time.offset
        prof.out$end <- prof.out$end - time.offset

        prof.out
    }

    filter(profr({
        Sys.sleep(delay)
        profrk_marker(substitute(expr))
    }, interval = interval, quiet = quiet))
} 
```

和一个分析块，比如

```
pr <- profrk(example(quantile, setRNG = TRUE), delay = 1, interval = 0.01, quiet = TRUE)
print(pr)

##                   f level time start  end  leaf source
## 39          example    31 0.08  0.00 0.08 FALSE  utils
## 40     index.search    32 0.01  0.00 0.01 FALSE   <NA>
## 41      <Anonymous>    32 0.05  0.01 0.06 FALSE   <NA>
## 42           source    32 0.02  0.06 0.08 FALSE   base
## 43          readRDS    33 0.01  0.00 0.01 FALSE   base
## 44       prepare_Rd    33 0.02  0.01 0.03 FALSE   <NA>
## 45           RdTags    33 0.01  0.03 0.04 FALSE   <NA>
## 46              of0    33 0.01  0.04 0.05 FALSE   <NA>
## 47           render    33 0.01  0.05 0.06 FALSE   <NA>
## 48      srcfilecopy    33 0.01  0.06 0.07 FALSE   base
## 49      withVisible    33 0.01  0.07 0.08 FALSE   base
## 50           gzfile    34 0.01  0.00 0.01  TRUE   base
## 51     .getHelpFile    34 0.02  0.01 0.03 FALSE   <NA>
## 52           sapply    34 0.01  0.03 0.04 FALSE   base
## 53              of1    34 0.01  0.04 0.05 FALSE   <NA>
## 54              of0    34 0.01  0.05 0.06 FALSE   <NA>
## 55        file.info    34 0.01  0.06 0.07 FALSE   base
## 56             eval    34 0.01  0.07 0.08 FALSE   base
## 57      <Anonymous>    35 0.02  0.01 0.03 FALSE   <NA>
## 58   simplify2array    35 0.01  0.03 0.04 FALSE   base
## 59       WriteLines    35 0.01  0.04 0.05 FALSE   <NA>
## 60              of1    35 0.01  0.05 0.06 FALSE   <NA>
## 61         .POSIXct    35 0.01  0.06 0.07 FALSE   base
## 62             eval    35 0.01  0.07 0.08 FALSE   base
## 63   lazyLoadDBexec    36 0.02  0.01 0.03 FALSE   base
## 64           unique    36 0.01  0.03 0.04  TRUE   base
## 65       writeLines    36 0.01  0.04 0.05 FALSE   base
## 66       WriteLines    36 0.01  0.05 0.06 FALSE   <NA>
## 67        structure    36 0.01  0.06 0.07  TRUE   base
## 68         quantile    36 0.01  0.07 0.08 FALSE  stats
## 69          readRDS    37 0.01  0.01 0.02  TRUE   base
## 70              fun    37 0.01  0.02 0.03 FALSE   <NA>
## 71           paste0    37 0.01  0.04 0.05 FALSE   base
## 72       writeLines    37 0.01  0.05 0.06 FALSE   base
## 73 quantile.default    37 0.01  0.07 0.08 FALSE  stats
## 74            fetch    38 0.01  0.02 0.03 FALSE   <NA>
## 75               wr    38 0.01  0.04 0.05 FALSE   <NA>
## 76           paste0    38 0.01  0.05 0.06 FALSE   base
## 77            paste    38 0.01  0.07 0.08 FALSE   base
## 78      <Anonymous>    39 0.01  0.02 0.03 FALSE   <NA>
## 79           paste0    39 0.01  0.04 0.05 FALSE   base
## 80            remap    39 0.01  0.05 0.06 FALSE   <NA>
## 81          formatC    39 0.01  0.07 0.08 FALSE   base
## 82     getFromFrame    40 0.01  0.02 0.03  TRUE   <NA>
## 83          strwrap    40 0.01  0.04 0.05 FALSE   base
## 84             psub    40 0.01  0.05 0.06  TRUE   <NA>
## 85      blank.chars    40 0.01  0.07 0.08 FALSE   <NA>
## 86           lapply    41 0.01  0.04 0.05 FALSE   base
## 87           vapply    41 0.01  0.07 0.08 FALSE   base
## 88         strsplit    42 0.01  0.04 0.05  TRUE   base
## 89              FUN    42 0.01  0.07 0.08 FALSE   <NA>
## 90            paste    43 0.01  0.07 0.08  TRUE   base 
```

我们不妨看看我希望是互动的情节，并像 profr 探索功能一样更适合名称。

```
plot(pr) 
```

![块 unnamed-chunk-1 的图](../Images/6c6a6a340a4f1f0f56854234eea2bfb2.png)

（尝试将不同延迟和间隔的形状与您的控制台捕获进行比较。）

[rpubs 上更好的示例输出](http://rpubs.com/Thell/1561)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-05T02:08:36.120

您可以使用`engine="Rscript"`在单独的 R 会话中提供评估代码的块选项。

```
# R profiling with knitr

```{r engine="Rscript"}
library(profr)
quantile_ex <- profr({Sys.sleep(1); example(quantile, setRNG = TRUE)}, 0.01)
quantile_ex
``` 
```

输出：

```
##                   f level time start  end  leaf source
## 8           example     1 0.02  0.00 0.02 FALSE  utils
## 9       <Anonymous>     2 0.01  0.00 0.01 FALSE   <NA>
## 10           source     2 0.01  0.01 0.02 FALSE   base
## 11 .Rd_format_title     3 0.01  0.00 0.01 FALSE   <NA>
## 12      withVisible     3 0.01  0.01 0.02 FALSE   base
## 13             gsub     4 0.01  0.00 0.01 FALSE   base
## 14             eval     4 0.01  0.01 0.02 FALSE   base
## 15    .Rd_get_title     5 0.01  0.00 0.01 FALSE   <NA>
## 16             eval     5 0.01  0.01 0.02 FALSE   base
## 17  .Rd_get_section     6 0.01  0.00 0.01 FALSE   <NA>
## 18         quantile     6 0.01  0.01 0.02 FALSE  stats
## 19           RdTags     7 0.01  0.00 0.01 FALSE   <NA>
## 20 quantile.default     7 0.01  0.01 0.02 FALSE  stats
## 21           sapply     8 0.01  0.00 0.01 FALSE   base
## 22             sort     8 0.01  0.01 0.02 FALSE   base
## 23           lapply     9 0.01  0.00 0.01 FALSE   base
## 24     sort.default     9 0.01  0.01 0.02 FALSE   base
## 25               [[    10 0.01  0.00 0.01  TRUE   base
## 26         sort.int    10 0.01  0.01 0.02 FALSE   base
## 27           unique    11 0.01  0.01 0.02  TRUE   base 
```

注意：所有必要的函数和变量都必须在块内定义。不会传递来自其他块的变量和函数。

# sharepoint - 将查找值保存到 SharePoint 2010

> ID：12310163
> 
> 赞同：0
> 
> 时间：2012-09-07T00:17:22.850
> 
> 标签：sharepoint

我已经弄清楚如何将记录添加到库中。我唯一想弄清楚的是如何（或者可能在哪里）从查找列表中保存用户的选择？

在下面的代码片段中，我正在保存一个新的列表项。它保存时没有错误，但字段“AwardType”和“AwardReason”是查找字段，虽然我没有收到错误，但没有任何内容保存到它们。如何保存到用户的查找字段选择？

```
using (SPSite site = new SPSite(SPContext.Current.Web.Url))
{
    using (SPWeb web = site.OpenWeb())
    {
        using (FileStream fs = (new FileInfo(fileUpload.PostedFile.FileName)).OpenRead())
        {
            SPList list = web.Lists["Awards"];
            Hashtable ht = new Hashtable();
            ht.Add("wfRecipientName", txtRecipientName.Text);
            ht.Add("Office", txtOrganization.Value);
            ht.Add("AwardType", ddAwardTypes.SelectedValue);
            ht.Add("AwardReason", ddAwardReasons.SelectedValue);

            SPFile destfile = list.RootFolder.Files.Add(fileUpload.FileName, fs, ht, false);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T06:07:59.067

Storing a lookup's value is done with SPFieldLookupValue(ID, Value).

You need to store the object returned by this method in a list item field, not a property via a hash table. In my example below, Awards list is document library and AwardType is a field of type lookup.

```
SPList list = web.Lists["Awards"];
Hashtable ht = new Hashtable();
ht.Add("Office", "Chicago"); // standard property
SPFile file = list.RootFolder.Files.Add(System.IO.Path.GetFileName(FileUpload1.PostedFile.FileName), fs, ht, true);
SPListItem item = file.Item; // get the item for the just-added file.

// assign the lookup column using SPFieldLookupValue
item["AwardType"] = new SPFieldLookupValue(
    Int32.Parse(DropDownList1.SelectedValue),
            DropDownList1.Text);
item.Update();  // to save the lookup column. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-10T10:06:07.597

您必须将 SPFieldLookUpValue 作为字符串添加到 HashTable，而不是 Lookup 的值。除了 int、string、date 之外，存储在 HashTable 上的属性将不会在 Document 创建时被解析。

```
 SPFieldLookupValue v = new SPFieldLookupValue(item["lookUpField"].ToString());
Hashtable documentProperties = new Hashtable();
documentProperties.Add("key", v.ToString());
 SPFile file = docLib.RootFolder.Files.Add("fileName", memoryStream, documentProperties, true); 
```

对于 SPUser 等复杂对象，也可以这样做。

```
SPFieldUserValue userValue = new SPFieldUserValue(web, web.CurrentUser.ID, web.CurrentUser.LoginName);
  documentProperties.Add("SPuSER", userValue.ToString()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T00:07:02.620

有趣的是，这条线

```
SPListItem item = file.Item; // get the item for the just-added file. 
```

是关键。

我在使用下面的代码时遇到了麻烦 - 查找没有持续更新！？

```
file.Item["AwardType"] = new SPFieldLookupValue(
    Int32.Parse(DropDownList1.SelectedValue),
            DropDownList1.Text); 
```

# asp.net-mvc-3 - AppHarbor 一步构建以及如何部署我的数据库

> ID：12310164
> 
> 赞同：3
> 
> 时间：2012-09-07T00:17:23.020
> 
> 标签：asp.net-mvc-3, deployment, msbuild, appharbor, dbproj

我终于达到了我的解决方案完成构建步骤所需的一切的地步：

*   下载`NuGet`软件包。
*   部署数据库（仅当它不存在时）。
*   构建解决方案。
*   运行任何升级脚本（只需一次，数据库会跟踪这些脚本）。
*   运行单元测试。
*   *成功。*

这在当地创造了各种奇迹。

现在我想我应该将我的[GitHub](http://github.com)存储库与[AppHarbor](http://appharbor.com)集成，因为 CI 对我来说是下一个合乎逻辑的步骤。

问题是，数据库正在分两步构建：

*   A`dbproj`被构建，生成一个`.dbschema`
*   我的数据库升级程序（展示了它所有的[DbUp 功能](http://dbup.github.com/)）构建了一个`BeforeBuild`目标，该目标构建和部署`dbproj`. 以及一个`AfterBuild`自行执行数据库升级程序的目标，使用尚未运行的任何 SQL 脚本更新架构。

问题是项目中的[AppHarbor](http://appharbor.com)构建服务器失败`.dbproj`，因为`SqlTasks.target`其服务器配置中缺少必需项。

我尝试快速修复手动添加该目标（以及它所依赖的其他一些目标），但这产生了一个我无法通过的错误：

> 无法从程序集 Microsoft.Data.Schema.Tasks.Sql [...] 加载“SqlBuildTask”任务

稍微挖掘一下，我发现[显然](http://www.techques.com/question/1-3988879/Getting-MSBuild-and-CruiseControl-.NET-to-build-and-deploy-VS2010-database-projects)`.dbproj`你不能在既`VS`没有也没有`TFS`安装的环境上构建项目。

我应该如何进行？我可能有几个选择：

*   手动连接到 AppHarbor 数据库并针对新的生产数据库运行在我的开发环境中生成的部署脚本。
    *这种破坏一步到位的目的。*

*   无需使用`.dbproj`数据库项目，只需在[DbUp](http://dbup.github.com) “升级程序”中包含所有基本安装表。 *这有两个问题，尽管它们可能可以解决。第一个是我应该自己创建数据库，第二个是`log4net`我用来记录数据库升级过程的表将由进程本身创建，这在我的书中是各种各样的错误。*

*   使用一些自定义数据库项目解决方案，我可以在没有此问题的情况下部署数据库。
    *我真的不知道这样的解决方案，是否存在，它们可靠吗？*

欢迎发表意见、部署文章或任何建议，在 AppHarbor 上构建 .dbproj 的快速破解也足够了。

[最后，要求AppHarbor](http://appharbor.com)包含`TFS`和/或`VS`在他们的构建服务器中是否太过牵强，构建`.dbproj`项目对于构建服务器来说听起来相当合理，对吧？

# ios - 突出显示手指下的标签

> ID：12310165
> 
> 赞同：1
> 
> 时间：2012-09-07T00:17:32.287
> 
> 标签：ios, cocoa-touch

**初始化**：

假设我有 5 个标签，标记为 1-5。这 5 个标签附加到一个`IBOutletCollection`初始化为

```
 @property (nonatomic, retain) IBOutletCollection(UILabel) NSMutableSet* myLineCollection; 
```

**我想做的事：**

当我的手指触摸并在屏幕上移动时，我想接收我的手指在哪个标签上`myLineCollection`。

我想收到这个，因为我的最终目标是将我手指当前所在标签的颜色从红色更改为蓝色。但是当我的手指移开时，它应该会恢复到原来的颜色，蓝色。

我在想我应该使用

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
```

和/或

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event 
```

和/或

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event 
```

**我一直在尝试：**

使用触摸，如果触摸在 label.window 中，或者如果触摸点是 label.frame.length 远离 label.frame.center 甚至可能是 c 的 if 语句。

我怎样才能收到当前被触摸的标签，然后对该标签做一些事情。这就是我所需要的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T00:55:04.363

希望这会对您有所帮助：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch = [touches anyObject];
    CGPoint touchPoint = [touch locationInView:self.view];
    //here loops all labels
    for(){
        if (CGRectContainsPoint([lable frame],touchPoint)) {
            //change label's background color
        }
    }
} 
```

# javascript - 使用jQuery提交动态创建的复杂表单而不刷新

> ID：12310166
> 
> 赞同：0
> 
> 时间：2012-09-07T00:17:43.097
> 
> 标签：javascript, jquery, html, forms

如何将 jQuery.post 与复杂的动态创建的表单一起使用？

这是我的代码：

```
<html>
<head>
<title></title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="/media/css/screen.css" />
<script>
var id = 0;

function removeField(fieldId) {
    $('#field_'+fieldId).hide();
}

function addField(fieldType) {
    var html = '<tr id="field_'+id+'"><td><input type="button" value="X" onclick="removeField('+id+')"/></td><td><input type="hidden" name="field_'+id+'_type" value="char"><input name="field_'+id+'_name" type="text" value="" /></td><td>'+fieldType+'</td><td><input type="checkbox"  name="field_'+id+'_unique" /></td>';
    switch (fieldType) {
        case 'char':
            html += '<td> <strong>Max length:</strong> <input name="field_'+id+'_max_length" type="text" value=""/></td>';
            break;
        case 'foreignkey':
            html += '<td> <strong>Related model:</strong> <input name="field_'+id+'_related_model" type="text" value=""/></td>';
            break;
    }
    html += '</tr>';
    $('#fields').append(html);
    id += 1;
    $('#fields').show();
}
</script>
</head>
<body>

<form action="/create_model/" method="post">

<strong>Model name:</strong> <input type="text" name="name" /><br/>
<table id="fields"><th style="width:10px;"></th><th style="width:100px;">Name</th><th style="width:50px;">Type</th><th style="width:25px;">Unique</th><th></th></tr></table>
<strong>Add field:</strong> <input type="button" value="Char" onclick="addField('char');" />
<input type="button" value="ForeignKey" onclick="addField('foreignkey');"/><br/>
<input type="submit" value="Create Model" />
</form>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T00:21:12.177

如果您的表单格式正确，您可以简单地将[jQuery 的`serialize()`函数与](http://api.jquery.com/serialize/)[`post()`函数](http://api.jquery.com/jQuery.post/)一起使用。它将在表单中为您构建参数的查询字符串。

```
var content = $("#formElement").serialize();

$.post('server.php',{'data':content},function(response){
  // request success callback
}); 
```

> ### 连载
> 
> 该`.serialize()`方法以标准 URL 编码表示法创建文本字符串。它对表示一组表单元素的 jQuery 对象进行操作。

# android - Eclipse Juno 和缺少的 Android 首选项

> ID：12310168
> 
> 赞同：2
> 
> 时间：2012-09-07T00:17:50.793
> 
> 标签：android, eclipse, preferences, adt

好的，我已经安装了 Android SDK rev 20.0.3，然后为 Java Developers 安装了 Eclipse IDE，然后使用安装软件链接从`https://dl-ssl.google.com/android/eclipse/`.

当我设置首选项以显示我的 SDK 位置时，Android 丢失了。我已经多次将其删除并重新加载到不同的位置，但没有成功使其正常工作。

我正在运行 Windows 7 32 位

这是我尝试过的：

*   在安装 ADT 插件之前，我使用“以管理员身份运行”启动了 Eclipse。
*   我重置视角并重新加载 ADT 但这也没有任何效果。
*   我尝试了不同版本的 eclipse，包括经典版和 Java EE、Indigo 和 Juno 版本。

有人有想法么？

# php - PHP 流上下文 -> 在这种情况下如何使用？

> ID：12310169
> 
> 赞同：1
> 
> 时间：2012-09-07T00:17:57.233
> 
> 标签：php, json, stream

我有一个将用户评论存储在其自己的单独 json 文件中的系统。我使用 scandir(); 在获取所有文件和文件夹的目录上，但是如何将其限制为 json 文件，我不想要其他文件，例如“。” 和数组中的“..”，因为我需要准确的计数。

我查看了 php.net 上的信息，但无法弄清楚，也许您知道可以指向我的资源，或者使用哪个函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T00:35:39.440

这是一个很好的例子，PHP 库来拯救。 `FilterIterator`是您扩展并覆盖其接受方法以仅使用您想要的文件的类。在这种情况下，我们使用标准`FilesystemIterator`来迭代目录。`RecursiveDirectoryIterator`如果要在子目录中搜索 json 文件，也可以使用 a 。此示例遍历当前目录中的 json 文件：

```
class StorageFilterIterator extends FilterIterator {

    function accept() {
        $item = $this->getInnerIterator()->current();
        return $item->isFile() && $item->getExtension() === 'json';
    }

}

$storageFiles = new StorageFilterIterator(new FilesystemIterator(__DIR__));

foreach ($storageFiles as $item) {
    echo $item;
} 
```

*`getExtension`存在于 PHP >= 5.3.6*

* * *

另一个鲜为人知的标准 PHP 库 (SPL) 部分是[iterator_to_array](http://php.net/manual/en/function.iterator-to-array.php)。因此，如果您想要一个数组中的所有项目而不是仅仅迭代它们，您可以执行以下操作：

```
$storageFiles = iterator_to_array(
    new StorageFilterIterator(new FilesystemIterator(__DIR__))
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T00:25:30.627

没有流上下文参数可以帮助您过滤掉文件类型。

假设您的 JSON 文件使用`.json`扩展名保存，您只需根据文件扩展名过滤掉数组。

您可以使用它[`readdir()`](http://php.net/readdir)来构建文件列表，或者简单地遍历从中获得的结果`scandir`并从中创建一个新数组。

这是一个使用示例`readdir`：

```
$files = array();
$dh = opendir($path);
while (($file = readdir($dh) !== false) {
    if (pathinfo($path . '/' . $file, PATHINFO_EXTENSION) !== 'json') continue;
    $files[] = $path . '/' . $file;
}

closedir($dh);

// $files now has an array of json files 
```

# android - 清单中的连接操作广播接收器等效项

> ID：12310170
> 
> 赞同：1
> 
> 时间：2012-09-07T00:18:02.473
> 
> 标签：android

我这样设置我的接收器：

```
networkReceiver = new NetworkChangesReceiver();
IntentFilter connFilter = new IntentFilter(ConnectivityManager.CONNECTIVITY_ACTION);
registerReceiver(networkReceiver, connFilter); 
```

我想在清单文件中进行设置。但是，我在意图过滤器的 android 属性中找不到 CONNECTIVITY_ACTION ......

**编辑：我设法找到了它，但在清单上我收到了这个警告：“导出的接收器不需要许可”这不是真的，因为我也有这条线：并且，通过调试，我看到接收器工作正常并且不会抛出“缺少权限”异常。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T00:21:51.463

我觉得这个就是我用的`android.net.conn.CONNECTIVITY_CHANGE`

# asp.net - ASP.NET Web API 的可行性

> ID：12310171
> 
> 赞同：0
> 
> 时间：2012-09-07T00:18:20.340
> 
> 标签：asp.net, wcf

我正在将我的三个 WP7 应用程序移植到 Android 上，它们使用我的 WCF SOAP 服务（这样我就可以赚一些钱来改变）。他们不喜欢那里的 SOAP，所以我需要将我的 WCF 服务方法复制到 Restful 服务。

几个月前，我使用 WCF REST 服务模板 40(CS) 模板创建了一个简单的工作测试服务，因此这是一种选择。但是我在网上看到很多关于使用 MVC 4 的 ASP.NET Web API 的信息。

我的问题是：这是否完全成熟并且会发展和繁荣，或者微软是否会让我全部参与其中，然后在我参与其中一年后像烫手山芋一样放弃它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T00:28:31.457

我会选择任何能完成工作的、可以支持的、同时实施起来最省力的方法。如果我在一个公平的竞争环境中，我会使用 WebAPI 运行，主要是因为它非常非常流畅。我还会使用版本化的 url 或内容协商对我的 API 进行版本化以隔离自己。

我不能代表微软，但总的来说，他们在相当长一段时间内都支持他们作为完全支持的产品发布的任何产品。我希望 WebAPI 至少与平台一样长。我认为 Microsoft 不会很快放弃对 .NET 的支持，并且我希望在可预见的将来会看到对 .NET 4.0 的支持。

# html - 如何在 Dreamweaver 中用正则表达式替换特定的 HTML 代码行？

> ID：12310188
> 
> 赞同：0
> 
> 时间：2012-09-07T00:21:23.287
> 
> 标签：html, regex, dreamweaver, replace

我想使用 Dreamweaver 中的查找和`<whatever>Some Title</whatever>`替换`<something>Some Title</something>`工具进行替换。我该如何表现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T00:32:05.427

不是 Dreamweaver 用户，但这种简单的方法适用于我的编辑器 (Emacs)：

代替：

```
<whatever>\(.*\)</whatever> 
```

和：

```
<something>\1</something> 
```

这是一种非常简单的方法，但可能无法满足您的需求。您的部分或全部`<whatever>`元素对是否占据多于一行的文本？或者你有不止一`<whatever>`对在一条线上？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-26T18:12:47.390

我想你想要的是`<whatever>`用一个标签来改变你所有的`<something>`标签而不改变你的文字，对吧？

如果是这样，您想使用正则表达式*查找和替换。*查找（在源代码中）`<whatever>(.*)</whatever>`并将其替换为`<something>$1</something>`. `$1`用作任何适合`(.*)`DW 为每个实例找到的部分的变量。

例如，您想注释 `document.NAMEOFANYFORMONTHEPAGE.WHATEVERNAME.focus();` JavaScript 文件中的所有实例，您可以使用 find: `document\.(.*)\.focus\(\);` 并将其替换为： `// document.$1.focus();`

不要忘记转义特殊字符，请在使用*全部替换之前尝试一些实例*

# esper - 生成没有窗口的去重事件流

> ID：12310194
> 
> 赞同：1
> 
> 时间：2012-09-07T00:22:05.400
> 
> 标签：esper

我正在尝试生成一个重复数据删除事件流，而不指定任何超出用于重复数据删除的窗口策略。在我的查询上使用`output first every`子句似乎具有预期的效果，但当这些查询直接插入到流中时却没有。

对于下面给出的示例，假设我试图在 4 小时内仅检测每辆车的第一个喇叭声。

```
(define-event-type! "CarEvent"
   {:license_plate java.lang.String})

(define-event-type! "HonkEvent"
   {:volume java.lang.Integer}
   :supertypes #{"CarEvent"})

(define-variant! "HonkEventDeduplicated" "HonkEvent")

(define-statement! "context-IndividualCarContext"
  "create context IndividualCarContext partition by license_plate from CarEvent")

(define-statement! "populate-HonkEventDeduplicated"
  "context IndividualCarContext
   insert into HonkEventDeduplicated
   select * from HonkEvent
     group by license_plate
     output first every 4 hours") 
```

然而——`select * from HonkEventDeduplicated`每次鸣喇叭都会触发，即使同一辆车连续鸣喇叭两次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:40:22.140

`output first every`这可以通过`std:firstunique`视图来完成，而不是使用子句过滤：

```
(define-statement!
  "populate-HonkEventDeduplicated"
  "insert into HonkEventDeduplicated
  select * from HonkEvent.win:time(4 hours).std:firstunique(license_plate)") 
```

# security - 银行在其密码生成器令牌上使用哪种 OTP（一次性密码）算法？

> ID：12310196
> 
> 赞同：4
> 
> 时间：2012-09-07T00:22:07.863
> 
> 标签：security, encryption, hash, passwords, onlinebanking

许多银行提供一些令牌设备，以便为一次性使用创建密码。我想知道他们使用哪种 OTP 算法？是HOTP还是TOTP？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T00:50:12.030

正如 aiodintsov 所说，答案不能一概而论，但技术的选择实际上取决于银行。我的猜测是`TOTP`。但是让我给出一个选择的理由。

*TOTP 使用 Unix 时间戳代替了客户端和服务器在事件计数器上保持同步的需要。该算法允许服务器选择它认为可接受的传入时间戳有多远，以校正时钟漂移。*

当您从银行收到 OTP 时，通常会说您应该在一定时限内使用该 OTP，之后该 OTP 将过期。如果银行使用`HOTP`，则 OTP 无需在一段时间后过期，而是仅在您发出另一个请求并增加计数器后才会过期。

因此，下次您收到不要求您在时间限制内使用它的 OTP 时，请确保它是使用`HOTP`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T00:38:16.290

他们可以使用他们想要的任何东西，他们选择的任何散列函数。使用 HOTP 和 TOTP。参见 RFC 4226 和 RFC 6238。我曾经有一张完全符合 RFC 4226 的 HOTP 算法的测试卡，可以将其用于身份验证解决方案（为卡提供了密钥）。

# php - 在电子邮件中发送链接

> ID：12310202
> 
> 赞同：0
> 
> 时间：2012-09-07T00:23:01.337
> 
> 标签：php, gmail

好吧，在你们笑之前 LOLZ --> 我不确定这是 GMAIL 问题还是我做错了什么，但我试图在邮件正文中插入一封电子邮件以获取激活链接。

```
$body = "Or click on this link: <a href=\"http://www.url.com/start/page.php?verify=true&id=".$url."&activate=".$ac."> Activate Your Account </a>" 
```

**好的，这里的问题是我的 GMAIL 帐户显示了这一点：（顺便说一句，它可以点击并正确路由）**

```
Or click on this link: <a href="http://www.url.com/start/page.php?verify=true&id=f22645cff5ecfd4d3c115af5&activate=75845> Activate Your Account </a> 
```

我在这里想念什么？这只是一个gmail问题吗？我该如何纠正这个？我希望它显示：**激活您的帐户**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T00:26:07.920

尝试关闭 URL 末尾的引用。

SO 语法突出显示甚至向您展示了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T00:29:26.450

1.  错误的语法，

错误应该告诉你发生了什么，

```
Parse error: syntax error, unexpected T_STRING on line x... 
```

2\. 发送 HTML 邮件，Content-type 标头必须设置为 html

我做了一些更改并对此进行了测试，试试这个工作脚本：

```
<?php
$body = 'Or click on this link: <a href="http://www.url.com/start/page.php?verify=true&id='.$url.'&activate='.$ac.'"> Activate Your Account </a>';
// To send HTML mail, the Content-type header must be set
$headers = 'From: webmaster@example.com' . "\r\n" .
$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
mail("to@gmail.com","Subject goes here",$body,$headers);
?> 
```

[PHP 邮件](http://php.net/manual/en/function.mail.php)

```
bool mail ( string $to , string $subject , string $message [, string $additional_headers [, string $additional_parameters ]] ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T00:27:02.403

当然，您在这里缺少双引号。

```
<a href="http://www.example.com/...5845> 
```

这应改为：

```
<a href="http://www.example.com/...5845"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T00:28:15.757

如果您没有设置标题，这对我有用。当然，您需要设置自己的变量。

```
 $sender_email = strip_tags($sender_email);
                $subject = "=?UTF-8?B?".base64_encode(strip_tags($title))."?=";
                $message = nl2br(strip_tags($message));
                $headers = "From: ".$sender_email.' <'.$sender_email.'>'."\r\n";
                $headers .= "MIME-Version: 1.0\r\n";
                $headers .= "Content-Type: text/html;\r\n";
                $headers .= "\tformat=flowed;\r\n";
                $headers .= "\tcharset=\"utf-8\";\r\n";
                $headers .= "\treply-type=original\r\n";
                $headers .= "Content-Transfer-Encoding: 8bit\r\n";
                $headers .= "Reply-To: ".$sender_email."\r\n";

                $body =  __('sendfriend:defaultmessage') . '<br /><br/><a href="'.$link.'" title="'.$title.'" target="_blank">'.$link.'</a><br/><br />'.$message;
                $mail = mail($recipients, $subject, $body, $headers); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T00:29:52.043

确保将电子邮件作为 HTML 电子邮件发送。

```
$headers = "From: myEmail@example.com\r\n";
$headers .= "Content-Type: text/html\r\n";
mail(...$headers); 
```

在邮件函数的末尾添加 $headers 变量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T06:07:41.667

首先在您的邮件功能中定义标题

```
 $headers = 'From: abc@example.com' . "\r\n" .
  $headers  = 'MIME-Version: 1.0' . "\r\n";
  $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n"; 
```

# java - 在 Spring 中返回字节 [] 和字符串

> ID：12310204
> 
> 赞同：1
> 
> 时间：2012-09-07T00:23:25.827
> 
> 标签：java, javascript, spring, spring-mvc, backbone.js

我正在尝试将 Java Spring 与 Backbone.js 结合使用。我正在某个后端执行搜索，并从该对象接收一个令牌以及一个字符串。我想返回该字符串和该对象，因为我希望该对象持续存在（我需要稍后使用它）。

我的一个想法是序列化对象，然后获取结果 byte[] 并将其更改为 String，然后将其与我的其他数据一起返回（可能在 json 对象中）。然后，我是否能够通过将该字符串更改为 byte[] 来将该字符串转换回对象，或者这不起作用，因为它只会将该字符串转换为字符串的 byte[] 表示，而不是对象？

如果是这样，那么我如何使用 Spring 同时返回 JSON 对象和字节 []？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T00:27:05.197

您可以通过谷歌搜索“Spring MVC tutorial json”找到大量关于如何从 Spring MVC 应用程序返回 JSON 编码数据的教程。

如果您打算在 JavaScript 应用程序中使用该数据，那么从 Java 应用程序返回编码为由 Java 序列化生成的字节数组的数据听起来不是一个好主意。如何在非 Java 环境中反序列化 Java 序列化的字节流？只需坚持使用 JSON 等跨平台、跨语言编码即可。

# xcode - cell.detailTextLabel.text 的 XCode GDB 语法？

> ID：12310213
> 
> 赞同：0
> 
> 时间：2012-09-07T00:25:30.070
> 
> 标签：xcode, uitableview, nsstring, gdb

我有一个典型的 UITableView 应用程序，其中有一些带有一些标签的单元格..

如何使用 GDB 显示以下内容？我已经在下面尝试过，但无法弄清楚语法应该是什么。

编辑：我希望能够在调试器遇到断点时显示变量的内容

```
(gdb) p (NSString*)cell.detailTextLabel.text
There is no member named detailTextLabel.
(gdb) p (NSString*)[cell.detailTextLabel.text]
A syntax error near end of expression.
(gdb) p (NSString*)[cell detailTextLabel text]
A syntax error in expression, near `]'.
(gdb) p (NSString*)[cell detailTextLabel]
$2 = (NSString *) 0x0
(gdb) p (NSString*)[[cell detailTextLabel] text]
$3 = (NSString *) 0x0 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:00:18.270

您不能在调试器中使用点符号，因此`cell.detailTextLabel.text`您必须编写`[[cell detailTextLabel] text]`. 并尝试使用命令`po`而不是`p`, 所以`po [[cell detailTextLabel] text]`. 希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T00:32:07.797

我不确定这是否是您的意思，但要记录您可以使用的标签文本：

```
NSLog(@"%@",cell.detailTextLabel.text); 
```

# ruby-on-rails - 导轨上的初始化程序中的两个线程不起作用

> ID：12310215
> 
> 赞同：5
> 
> 时间：2012-09-07T00:25:33.217
> 
> 标签：ruby-on-rails, ruby, amazon-sqs

最初我使用一个线程来收听来自亚马逊的队列并且工作得很好。

![在此处输入图像描述](../Images/222bbc14bf3e5e6be8d807830345afa4.png)

**aws.rb**

```
Thread.new do
    queue = AWS::SQS::Queue.new(SQSADDR['my_queue'])
    queue.poll do |msg|
    ... 
```

但现在我附加了另一个线程来监听另一个队列：

```
...    
Thread.new do
    queue = AWS::SQS::Queue.new(SQSADDR['my_another_queue'])
    queue.poll do |msg|
    ... 
```

现在它似乎不起作用。只有最后一个收到回复...

到底是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T03:48:38.783

你在覆盖变量`queue`吗？

# javascript - 单击时从网页中的句子中传递单个单词的最佳方法

> ID：12310217
> 
> 赞同：2
> 
> 时间：2012-09-07T00:26:01.637
> 
> 标签：javascript, jquery, django, web

说，我有：

```
<p> This is a sentence </p> 
```

而当用户点击句子中的单词（this, is, a, sentence）时，网页就会知道点击了特定的单词。js 或 jQuery 库中有什么东西吗？

我想为我在 Django 中的项目这样做，这样当他们点击一个单词时，我知道点击了句子中的哪个单词（而不是整个句子本身）。

我对此只有两个想法：

1.  将句子拆分为不同的元素，以便在单击时使用 javascript 和 getElementByID 或
2.  与 #1 类似，但我只是使用锚标记并以相同的形式传递链接和链接的值，以便我知道句子中的哪个单词被传递 () 我猜这也有问题。

有没有更好的办法？或者最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T00:30:48.563

我们这样做过一次，在整个文档上这样做是一件非常讨厌的事情，但对于一个段落来说还不错。

获取文本节点，将其拆分为空白。然后，将每个单词包装在一个 span 中并将其放回文档中。

将侦听器附加到父节点并使用委托来确定单击了哪个跨度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T00:36:13.240

我认为使用多个元素是最符合标准的方式，但是......

...使用像 courier 这样的等宽字体，由于字体的等宽性质，您可以在其中预测每个字母的宽度，您应该能够跟踪鼠标在句子中的 x 位置。

您可以使用 pageX 获取鼠标 X 坐标。它在 IE 中的 client.x。

```
 var properMethod = event.clientX || event.pageX;//This should select only the available non null property for the browsers 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T00:32:27.657

我会这样：

**html:**

```
<span>hello</span><span>world</span> 
```

**jQuery：**

```
$("span").click(function() {
  alert($(this).text());
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T00:36:12.443

[jsFiddle 演示](http://jsfiddle.net/bAFG6/)

您需要使用 javascripts 替换 html 来`.replace(regex, changedStuff)`为每个单词创建可点击事件。

```
$('p').html(function(i, old) {
    return old.replace(/\b(\w+?)\b/g, '<span class="clickable">$1</span>')
}).click(function(e) { 
    alert(e.target.innerHTML);
}); 
```

现在，如果您在单词之间单击，则会显示 html，但您明白了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T01:42:40.003

如果您不想事先将每个单词都包含在标签中，则可以在单击后尝试这样做。如果您有单独的段落，则只需转换用户在其中单击的段落。

例如（[http://jsfiddle.net/scovetta/TU9rs/1/](http://jsfiddle.net/scovetta/TU9rs/1/)）

```
$('#paragraph').live('click', function($evt) {
    var original_text = $(this).text();
    var word_list = $(this).text().split(' ');      
    var word_html = '';

    // Convert each word to an individual span
    $.each(word_list, function(_, word) {
        word_html += '<span class="word">' + word + '</span> ';
    });

    // Replace original paragraph with the spans
    $(this).text('').html(word_html);

    // Search through each span for one in the right spot
    $('#paragraph .word').each(function(_, elt) {
        var rect = elt.getBoundingClientRect();
        if ($evt.pageX >= rect.left &&
                $evt.pageY >= rect.top &&
                $evt.pageX <= rect.right &&
                $evt.pageY <= rect.bottom) {
            alert('You clicked on the word: ' + $(elt).text());
            return;
        }
    });

    // Clean up after ourselves
    $(this).html('').text(original_text);
}); 
```

​​​​​​​​​​​​</p>

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T02:06:08.620

这会将点击事件附加到指定选择器中的所有单词。如果该选择器有任何其他子元素，它会跳过它。

jsFiddle：

[http://jsfiddle.net/iambriansreed/bAExr/](http://jsfiddle.net/iambriansreed/bAExr/)

jQuery

```
$('p').each(function(){

    var $this = $(this);

    if($this.children().length) return;    

    $this.html(function(i, old) {
        return old.replace(/\b(\w+?)\b/g, '<span>$1</span>')
    });

    $this.children().click(function(e) { 
        alert(e.target.innerHTML);
    });

}); 
```

​</p>

# mysql - SQL根据日期和另一列减去两行

> ID：12310221
> 
> 赞同：6
> 
> 时间：2012-09-07T00:26:36.023
> 
> 标签：mysql, sql, group-by

我需要使用前一个日期的最近日期减去 MySQL 中的两行：

起始表：

```
Stock       Date          Price
GOOG        2012-05-20    402
GOOG        2012-05-21    432
APPL        2012-05-20    553
APPL        2012-05-21    590
FB          2012-05-20     40
FB          2012-05-21     34 
```

这是结果表：

```
Stock       Date          Price Change
GOOG        2012-05-21    30
APPL        2012-05-21    37
FB          2012-05-21    -6 
```

现在我每家公司只有两个日期，但是如果您的查询可以处理任意数量的日期，则可以加分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T00:44:27.023

我所做的是我得到两个单独的查询来获取每只股票的最大日期和最小日期。试试这个，

```
SELECT  maxList.stock, 
        maxList.Date,
        (maxlist.Price - minlist.Price) totalPrice
FROM
    (
        SELECT  a.*
        FROM    tableName a INNER JOIN
        (
            SELECT      Stock, MAX(date) maxDate
            FROM        tableName
            GROUP BY    Stock
        ) b ON  a.stock = b.stock AND
                a.date = b.maxDate
    ) maxList INNER JOIN
    (
        SELECT  a.*
        FROM    tableName a INNER JOIN
        (
            SELECT      Stock, MIN(date) minDate
            FROM        tableName
            GROUP BY    Stock
        ) b ON  a.stock = b.stock AND
                a.date = b.minDate
    ) minList ON maxList.stock = minList.stock 
```

# [*SQLFiddle 演示*](http://sqlfiddle.com/#!2/859e5/1)

**更新 1**

看到你的最后一句话：`Right now I just have two dates per company, but bonus upvotes if your query can handle any number of dates.`如果你有这样的记录怎么办？

```
FB          2012-05-20     40
FB          2012-05-21     34
FB          2012-05-22     42 
```

结果会是什么？

![在此处输入图像描述](../Images/647e755d7c4a233d36d1fccb18c07bea.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:10:16.233

我知道这已经被回答了，但是这个问题引起了我的兴趣，所以我想我会试一试。

我假设您可能想查看任意两个连续日期之间的差异。

所以对于以下数据：

```
GOOG        2012-09-07  42.34
GOOG        2012-09-06  44.56
GOOG        2012-09-01  44.32
FB          2012-09-07  17.82
FB          2012-08-05  12.98 
```

你会得到：

```
GOOG        2012-09-07  2012-09-06  -2.22
GOOG        2012-09-06  2012-09-01  0.24
FB          2012-09-07  2012-08-05  4.84 
```

我为此写的查询是：

```
SELECT t1.Stock, t1.Date AS CurrentDate, oldDate.Date AS OldDate, (t1.Price - oldDate.Price) AS PriceChange
FROM MP_StockTable t1
JOIN (SELECT t2.Stock, t2.Date AS date1, (SELECT MAX(t3.Date) FROM MP_StockTable t3 WHERE t3.Date < t2.Date AND t3.Stock = t2.Stock GROUP BY t3.Stock) AS date2 
        FROM MP_StockTable t2) AS StockDates ON StockDates.Stock = t1.Stock AND StockDates.date1 = t1.Date
JOIN MP_StockTable oldDate ON oldDate.Stock = t1.Stock AND oldDate.Date = StockDates.date2 
```

内联表基本上计算每行最接近的先前日期。所以对于上面的数据，生成的表是这样的：

```
GOOG        2012-09-07  2012-09-06
GOOG        2012-09-06  2012-09-01
GOOG        2012-09-01  NULL
FB          2012-09-07  2012-08-05
FB          2012-08-05  NULL 
```

然后我们使用该表中的两个日期来获得我们的两个价格点。

注意：我在 SQLServer 中进行测试，如果这需要对 mySql 进行一些调整，我深表歉意（使用 mySql 已经多年了，所以我忘记了差异）。

# java - 为什么我的应用程序内存不足？

> ID：12310228
> 
> 赞同：1
> 
> 时间：2012-09-07T00:27:33.610
> 
> 标签：java, android, garbage-collection, jvm, dalvik

任何人都可以理解这一点吗？它只执行了两次垃圾回收，并且有 16MB 可用空间。那么为什么分配 8MB 失败呢？

```
09-06 19:08:36.335: V/MediaPlayerService(5439): [102] isPlaying: 0
09-06 19:08:36.421: D/dalvikvm(17483): GC_FOR_MALLOC freed 13K, 39% free 16709K/27079K, external 2357K/2773K, paused 139ms
09-06 19:08:36.421: I/dalvikvm-heap(17483): Forcing collection of SoftReferences for 8520570-byte allocation
09-06 19:08:36.522: D/dalvikvm(17483): GC_FOR_MALLOC freed <1K, 39% free 16708K/27079K, external 2357K/2773K, paused 95ms
09-06 19:08:36.522: E/dalvikvm-heap(17483): Out of memory on a 8520570-byte allocation.
09-06 19:08:36.522: I/dalvikvm(17483): "Thread-19" prio=5 tid=12 RUNNABLE
09-06 19:08:36.522: I/dalvikvm(17483):   | group="main" sCount=0 dsCount=0 obj=0x411da000 self=0x3863e8
09-06 19:08:36.522: I/dalvikvm(17483):   | sysTid=17496 nice=0 sched=0/0 cgrp=default handle=3695904
09-06 19:08:36.522: I/dalvikvm(17483):   | schedstat=( 8278991686 2222930914 7642 )
09-06 19:08:36.522: I/dalvikvm(17483):   at java.io.ByteArrayOutputStream.expand(ByteArrayOutputStream.java:~91)
09-06 19:08:36.522: I/dalvikvm(17483):   at java.io.ByteArrayOutputStream.write(ByteArrayOutputStream.java:216)
09-06 19:08:36.522: I/dalvikvm(17483):   at org.jsoup.helper.DataUtil.readToByteBuffer(DataUtil.java:114)
09-06 19:08:36.522: I/dalvikvm(17483):   at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:437)
09-06 19:08:36.522: I/dalvikvm(17483):   at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:391)
09-06 19:08:36.522: I/dalvikvm(17483):   at org.jsoup.helper.HttpConnection.execute(HttpConnection.java:157)
09-06 19:08:36.522: I/dalvikvm(17483):   at org.jsoup.helper.HttpConnection.get(HttpConnection.java:146) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T01:05:06.893

我认为第二条日志行可能会让您感到困惑。措辞有点误导，但我很确定它说只有大约 10 兆免费：16709K / 27079K 大约是 61.7%，所以 16709K 大概是使用的内存量*，*而不是免费的。

但是 10 兆仍然大于请求的 8 兆。问题可能是您的应用程序已经运行了足够长的时间以产生明显的内存碎片。也就是说，总共可能有 10 兆的空闲空间，但它全部（或至少足够）分散在其他积极使用的内存中，因此没有连续的空间可以提供给您的应用程序。

# mysql - WordPress 自定义搜索

> ID：12310229
> 
> 赞同：0
> 
> 时间：2012-09-07T00:28:04.273
> 
> 标签：mysql, wordpress, woocommerce

这令人抓狂。我似乎无法弄清楚什么似乎是一件容易的事。我正在为销售二手房车的 Wordpress 网站构建自定义搜索功能。我正在使用 Woocommerce 对产品进行分类（可能并不重要，因为它只是创建了一个带有 post_type=product 而不是 post_type=post 的产品）。

我正在使用自定义字段来定义选项，例如车辆的“Class”（例如“Class A”、“Class B”、“Class C”等）和“Fuel Type”（例如“Gasoline”、“Diesel”、 '可牵引'）。因此，每个产品对于同一个 meta_key 可能有不同的 meta_value，但每个 meta_key 可能只定义一次，并且每个 meta_key 可能只有一个 meta_value。

部分搜索表单看起来像这样。（还有更多，但这就是我们目前需要担心的全部）

```
<h4>Type / Class</h4>

<label><input type="checkbox" name="a1" value="0" />All Types</label>
<label><input type="checkbox" name="a2" value="Class A" />"Class A" RV's</label>
<label><input type="checkbox" name="a3" value="Class B" />"Class B" RV's</label>
<label><input type="checkbox" name="a4" value="Class C" />"Class C" RV's</label>
<label><input type="checkbox" name="a5" value="Fifth Wheel" />Fifth Wheel RV's</label>
<label><input type="checkbox" name="a6" value="Toy Hauler" />Toy Haulers</label>
<label><input type="checkbox" name="a7" value="Travel Trailer" />Travel Trailer RV's</label>
<label><input type="checkbox" name="a8" value="Camping Trailer" />Camping Trailers</label>

<h4>Engine Type</h4>

<label><input type="checkbox" name="c1" value="0" />All Engine Types</label>
<label><input type="checkbox" name="c2" value="Gasoline" />Gasoline</label>
<label><input type="checkbox" name="c3" value="Diesel" />Diesel</label>
<label><input type="checkbox" name="c4" value="Towable" />Towable</label> 
```

发送它以运行以下查询并返回结果。

```
$result = mysql_query("
            SELECT * FROM wp_postmeta 
            WHERE 
            (meta_key= 'class' AND (meta_value = '$a2' OR meta_value = '$a3' OR meta_value = '$a4' OR meta_value = '$a5' OR meta_value = '$a6' OR meta_value = '$a7' OR meta_value = '$a8'))
            "); 
```

如果选择了一个框，则会为所选选项的 url 中的选项传递一个 true 参数 (1)（例如 site.com/search/?a2=1&a4=1 if 'Class A'和“C类”被选中）。这似乎工作正常。

但是，当我尝试使用这个新查询搜索另一个 meta_key 和它的值的组合时......

```
$result = mysql_query("
            SELECT * FROM wp_postmeta 
            WHERE 
            (meta_key= 'class' AND (meta_value = '$a2' OR meta_value = '$a3' OR meta_value = '$a4' OR meta_value = '$a5' OR meta_value = '$a6' OR meta_value = '$a7' OR meta_value = '$a8'))
            AND
            (meta_key= 'fuel' AND (meta_value = '$c2' OR meta_value = '$c3' OR meta_value = '$c4'))
            "); 
```

...它不再起作用了:(每个 meta_key 语句将独立工作，但不能使用 AND 运算符一起工作。这对我来说似乎是正确的，但它不起作用。奇怪的是，如果我在第 5 行将 AND 更改为 OR，它会起作用，但不会返回我想要的结果，因为它会扩展搜索而不是缩小搜索范围。

任何帮助是极大的赞赏。如果有人知道如何解决这个问题，我也愿意尝试其他方法，因为我可能做错了。我是一名设计师，最近刚转为程序员，我的专业水平充其量只是中等水平，所以请善待。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T23:23:39.660

这是您编写 SQL 查询的方式的错误。wp_postmeta 中的每条记录只能有一个 meta_key 值，但是您尝试匹配多个 meta_key 值，这就是为什么您没有看到返回结果的原因，因为没有记录与您的查询匹配。

为了返回您要查找的数据，您需要为要查找的每个唯一 meta_key 条件连接表。

像这样的东西应该是你想要的。

```
SELECT distinct(m1.post_id) as post_id FROM 
    wp_postmeta m1, 
    wp_postmeta m2
WHERE
    m1.post_id=m2.post_id AND
    (m1.meta_key='class' AND (m1.meta_value IN ('$a2','$a3','$a4','$a5','$a6','$a7','$a8'))) AND
    (m2.meta_key='fuel' AND (m2.meta_value IN ('$c2','$c3','$c4'))) 
```

您需要根据设置的搜索选项构建 SQL 查询。

# gnuplot - gnuplot - 仅在图例/键中增加点的大小

> ID：12310236
> 
> 赞同：18
> 
> 时间：2012-09-07T00:29:19.540
> 
> 标签：gnuplot

我有一个看起来像这样的图表：

![图片](../Images/d27af1c3e63b92f85d0443aaa6d02615.png)

我想增加图例中点的大小（是图例还是键？），但不增加图中点的大小。在图片中解释得更好。这可以实现吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-07T01:34:33.377

首先绘制没有增加符号大小的任何内容，然后绘制没有密钥的数据。

```
gnuplot> plot 1/0 ls 7 lw 6 with points t "0.0", "yourdata" ls 7 notitle 
```

对两个绘图使用相同的点样式，并根据需要重命名第一个绘图键。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-24T10:21:28.503

除非您使用实心圆圈`pt 7`（

```
plo 1/0 w p lc 1 pt 1 lw 3 ps 3 t "Data 1", "data1.dat" lc 1 pt 1 notitle,\
    1/0 w p lc 3 pt 2 lw 3 ps 3 t "Data 2", "data2.dat" lc 3 pt 2 notitle 
```

# php - PHP 将旧的 mysql_query 更改为 PDO

> ID：12310238
> 
> 赞同：6
> 
> 时间：2012-09-07T00:29:26.873
> 
> 标签：php, mysql, sql, pdo

我的代码中有一些旧的 mysql_query 查询，我想将其转换为 PDO，但正在努力工作。

我的原始代码是：

```
mysql_query("UPDATE people SET price='$price', contact='$contact', fname='$fname', lname='$lname' WHERE id='$id' AND username='$username' ")
or die(mysql_error()); 
```

现在我正在尝试：

```
$sql = "UPDATE people SET price='$price', contact='$contact', fname='$fname', lname='$lname' WHERE id='$id' AND username='$username'";
$q   = $conn->query($sql) or die("failed!"); 
```

但似乎无法让它工作，有什么想法吗？

更新代码：

```
$conn = new PDO("mysql:host=$host;dbname=$db",$user,$pass);

 // check if the form has been submitted. If it has, process the form and save it to the   database
 if (isset($_POST['submit']))
 { 
 // confirm that the 'id' value is a valid integer before getting the form data
 if (is_numeric($_POST['id']))
  {
 // get form data, making sure it is valid
 $id = $_POST['id'];
 $fname = mysql_real_escape_string(htmlspecialchars($_POST['fname']));
 $lname = mysql_real_escape_string(htmlspecialchars($_POST['lname']));
 $contact = mysql_real_escape_string(htmlspecialchars($_POST['contact']));
 $price = mysql_real_escape_string(htmlspecialchars($_POST['price']));

 // check that firstname/lastname fields are both filled in
 if ($fname == '' || $lname == '' || $contact == '' || $price == '' )
 {
 // generate error message
 $error = 'ERROR: Please fill in all required fields!';

 //error, display form
 renderForm($id, $fname, $lname, $contact, $price, $error);
 }
 else
 {
 // save the data to the database
 $username = $_SESSION['username'];

 $query = "UPDATE people 
         SET price=?, 
             contact=?, 
             fname=?, 
             lname=? 
          WHERE id=? AND 
                username=?";
$stmt = $db->prepare($query);
$stmt->bindParam(1, $price);
$stmt->bindParam(2, $contact);
$stmt->bindParam(3, $fname);
$stmt->bindParam(4, $lname);
$stmt->bindParam(5, $id);
$stmt->bindParam(6, $username);    
$stmt->execute();

 // once saved, redirect back to the view page
header("Location: view.php"); 
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T00:32:33.933

有关更多信息，请访问此链接：**[PHP PDO](http://php.net/manual/en/book.pdo.php)**

根据你的例子，

```
<?php

    $query = "UPDATE people 
             SET price=?, 
                 contact=?, 
                 fname=?, 
                 lname=? 
              WHERE id=? AND 
                    username=?";
    $stmt = $dbh->prepare($query);
    $stmt->bindParam(1, $price);
    $stmt->bindParam(2, $contact);
    $stmt->bindParam(3, $fname);
    $stmt->bindParam(4, $lname);
    $stmt->bindParam(5, $id);
    $stmt->bindParam(6, $username);    
    $stmt->execute();

?> 
```

**[PDO 准备好的语句和存储过程](http://www.php.net/manual/en/pdo.prepared-statements.php)**

![在此处输入图像描述](../Images/e9cdc6aae7cac6c94603683bf73af55f.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-07T00:37:35.503

请注意，在使用 PDO 的 mysql 驱动程序时，您**始终**必须[禁用模拟的准备好的语句](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php)：

```
$dbConnection = new PDO('mysql:dbname=dbtest;host=127.0.0.1;charset=utf8', 'user', 'pass');

$dbConnection->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
$dbConnection->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

$sql = 'UPDATE people SET';
$sql.= ' price = :price,';
$sql.= ' contact = :contact,';
$sql.= ' fname = :fname,';
$sq;.= ' lname = :lname';
$sql.= ' WHERE id= :id AND username = :username';

$stmt = $pdo->prepare($sql);

$stmt->execute(array(
    ':price' => $price,
    ':contact' => $contact,
    ':fname' => $fname,
    ':lname' => $lname,
    ':id' => $id,
    ':username' => $username,
)); 
```

正如你所看到的，我使用了命名参数，因为当你有很多它们时，你在做什么会更清楚。

*注意：[ircmaxell](https://stackoverflow.com/users/338665/ircmaxell)目前正在努力[让默认值始终使用真正的准备好的语句](https://stackoverflow.com/a/12202218/508666)，但在此之前（可能需要一些时间）你总是必须为 mysql 禁用它们。*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-07T00:37:54.883

如果您要使用 PDO，则需要查看，[`prepare()`](http://php.net/manual/en/pdo.prepare.php)否则[`execute`](http://www.php.net/manual/en/pdostatement.execute.php)您将失去 PDO 提供的安全性并保留 SQL 注入。所以，给出你的例子：

```
$conn = new PDO(/*connection info*/);

$query = $conn->prepare("UPDATE people "
                      . "SET    price    = :price, "
                      . "       contact  = :contact, "
                      . "       fname    = :fname, "
                      . "       lname    = :lname "
                      . "WHERE  id       = :id "
                      . "  AND  username = :username");
$result = $query->execute(array(
  ':price'    => $price,
  ':contact'  => $contact,
  ':fname'    => $fname,
  ':lname'    => $lname,
  ':id'       => $id,
  ':username' => $username
)); 
```

这更像是一种松散的方式，但您也[`bindParam`](http://www.php.net/manual/en/pdostatement.bindparam.php)可以明确说明它所期望的数据类型。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-07T00:48:17.157

在使用 PDO 扩展时，您需要明确的几件事是有多种方法可以完成工作。

您当前使用的方式是其中之一，包括更多。[然而，单独绑定参数](http://www.php.net/manual/en/pdostatement.bindparam.php)总是一个好主意，因为这可以防止许多问题，如 SQL 注入等等。

其他需要注意的重要事项[`statement`](http://www.php.net/manual/en/class.pdostatement.php)是[`prepare`](http://www.php.net/manual/en/pdo.prepare.php)和[`execute`](http://www.php.net/manual/en/pdostatement.execute.php)。

```
$conn = new PDO("...."); //Creating the handler

//Create the statement
$stmt = $conn -> prepare("UPDATE people SET price = :price, contact = :contact, fname = :fname, lname = :lname WHERE id= :id AND username = :username");

// Bind the params
$stml -> bindParam(":contact", $contact, PDO::PARAM_STR); //This way you can also define the DATATYPE of the parameter

//Execute
$stmt -> execute(array(
   ":price" => $price, //another way of binding the params
   ":fname" => $fname, 
   ":lname" => $lname,
   ":id" => $id, 
   ":username" => $username)); 
```

# c# - 通过客户端服务器框架将 Windows 身份传递给 SQL Server

> ID：12310239
> 
> 赞同：0
> 
> 时间：2012-09-07T00:29:41.480
> 
> 标签：c#, .net, sql-server

我有一个企业客户端服务器应用程序。它将大部分工作从客户端应用程序 (Windows 7) 传递到服务器应用程序 (Server 2008 R2)，当涉及到运行 SQL 查询 (SQL Server 2008) 时，它由服务器处理 - 注册用户作为服务器。

然后，我们的数据库中有一个使用 Active Directory 锁定的表。我们的客户端和服务器是用 .Net 4.0 编写的。我正在使用 WCF (net.tcp)。

我如何将登录的用户安全令牌从我们的 Windows 7 客户端传递到我们的服务器，以便服务器转身并使用它连接到 SQL 服务器以运行几个快速查询。

任何想法或想法，将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:01:27.923

您在谈论的是双跳场景。查看[这个](https://stackoverflow.com/questions/4334665/steps-to-enable-double-hop-delegation-in-iis7-windows-2008)关于如何设置双跳可能性的 SO 问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:42:49.367

您可能想要为 SQL 服务器访问创建一个服务帐户。

在调用数据库之前，您可以使用服务帐户在 Windows 应用程序中模拟/更改身份。因此，在执行数据库调用时，它将在模拟身份（服务帐户）下运行。有关 Windows 应用程序中的模拟，[请参阅此 MSDN 文章](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsimpersonationcontext.aspx)

# java - 将字典存储在哈希表中

> ID：12310243
> 
> 赞同：1
> 
> 时间：2012-09-07T00:31:01.223
> 
> 标签：java

我有一个正在处理的任务，我无法联系到教授来弄清楚某些事情。这个想法是我们正在编写一个字谜求解器，使用给定的一组单词，我们将其存储在 3 个不同的字典类中：线性、二进制和哈希。

因此，我们从文本文件中读取单词，对于前 2 个字典对象（线性和二进制），我们将单词存储为 ArrayList……很简单。

但是对于 HashDictionary，他希望我们将单词存储在 HashTable 中。我只是不确定哈希表的值是什么，或者你为什么要这样做。说明说我们将单词存储在哈希表中以便快速检索，但我只是不明白这是什么意思。将单词存储在数组列表中是有意义的，但我只是不确定键/值配对如何帮助字典。

也许我没有提供足够的细节，但我想也许有人会看到这样的事情，而且对他们来说很明显。

我们的每个类都有一个 contains 方法，它返回一个布尔值，表示传入的单词是否在字典中，因此线性对 arraylist 进行线性搜索，二进制对 arraylist 进行二进制搜索，并且 I'我不确定哈希值....

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T00:39:07.683

区别在于速度。两种方法都有效，但哈希表速度很快。

当您使用`ArrayList`或任何类型的`List`来查找元素时，您必须逐个检查每个列表项，直到找到所需的单词。如果该词不存在，则您已遍历整个列表。

当您使用 a`HashTable`时，您会对正在查找的单词执行一些“魔术”，即计算单词的哈希值。使用该哈希值，而不是遍历值列表，您可以立即推断在哪里找到您的单词 - 或者，如果您的单词在哈希中不存在，那么您的单词不存在。

我在这里过于简单化了，但这是一般的想法。[您可以在此处](https://stackoverflow.com/questions/730620/how-does-a-hash-table-work)找到另一个问题，其中包含有关哈希表如何工作的各种解释。

这是一个使用`HashMap`.

```
// We will map our words to their definitions; word is the key, definition is the value
Map<String, String> dictionary = new HashMap<String, String>();
map.put("hello","A common salutation");
map.put("chicken","A delightful vessel for protein");

// Later ...
map.get("chicken"); // Returns "A delightful vessel for protein"; 
```

* * *

您描述的问题要求您使用 a`HashMap`作为满足三个要求的字典的基础：

*   将单词添加到字典中
*   从字典中删除一个词
*   检查一个单词是否在字典中

使用存储键和值的映射似乎违反直觉，因为您真正想要的只是存储一个键（或只是一个值）。但是，如上所述，a`HashMap`可以非常快速地找到与键关联的值。同样，它可以非常快速地查看是否`HashMap`知道密钥。我们可以通过将每个字典单词作为键存储在 中来利用这种质量，并将`HashMap`其与垃圾值相关联（因为我们不关心它），例如`null`.

您可以看到如何满足这三个要求，如下所示。

```
Map<String, Object> map = new HashMap<String, Object>();
// Add a word
map.put('word', null);

// Remove a word
map.remove('word');

// Check for the presence of a word
map.containsKey('word'); 
```

我不想让信息过多，但我们这里的要求与称为[`Set`](http://docs.oracle.com/javase/7/docs/api/java/util/Set.html). 在 Java 中，常用`Set`的是 . [`HashSet`](http://docs.oracle.com/javase/7/docs/api/java/util/HashSet.html)，这几乎正是您在这部分家庭作业中实现的。（事实上​​，如果这不是明确指示您使用 a 的家庭作业`HashMap`，我建议您改用 a `HashSet`。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T00:42:16.650

数组很难找到东西。如果我给你`array[0] = "cat"; array[1] = "dog"; array[2] = "pikachu";`，你必须检查每个元素才能知道 jigglypuff 是否是一个词。如果我给了您`hash["cat"] = 1; hash["dog"] = 1; hash["pikachu"] = 1;"`，立即执行此操作，您只需直接查找即可。在这种特殊情况下，值 1 无关紧要，尽管您可以在其中放置有用的信息，例如您查找单词的次数，或者 1 表示真实单词，2 表示口袋妖怪的名称，或者一个真正的字典，它可以包含一个句子长的定义。不太相关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T00:40:58.540

听起来你并不真正了解哈希表。甚至[维基百科](http://en.wikipedia.org/wiki/Hash_table)对这种数据结构也有很好的解释。

您的哈希表将是一个大字符串数组（最初都是空的）。您使用单词中的字符计算哈希值，然后将单词插入表中的该位置。

当两个单词的哈希值相同时会出现问题。并且有一些解决方案。一种是在每个数组位置存储一个列表，然后将单词推到该列表中。另一种方法是按已知数量在表格中步进，直到找到空闲位置。另一种方法是使用不同的算法计算二级散列。

重点是哈希查找速度很快。计算哈希值非常快，然后您所要做的就是检查该数组位置的单词是否存在（并且与搜索单词匹配）。您遵循用于插入的哈希值冲突（在本例中为不匹配）的相同规则。

您希望您的表大小是一个大于您打算存储的元素数量的素数。您还需要一个快速发散的散列函数，以便您的数据更有可能通过散列表广泛分布（而不是在一个区域中大量聚集）。

希望这对您有所帮助，并为您指明正确的方向。

# maven - Netbeans 使用依赖项构建我的集成测试两次

> ID：12310244
> 
> 赞同：1
> 
> 时间：2012-09-07T00:31:38.390
> 
> 标签：maven, integration-testing, netbeans-7, maven-failsafe-plugin

我有一个父模块，它有以下子模块

```
<modules>
    <module>entities</module>
    <module>util</module>
    <module>ejb</module>
    <module>reports</module>
    <module>user-interface</module>
    <module>integration-tests</module>
</modules> 
```

我正在使用故障安全插件来运行集成测试。有没有办法告诉 maven 在 Netbeans 中运行集成测试之前编译它的依赖项，即实体、实用程序和 ejb？

在命令行中执行上述操作很容易。我可以去父 pom.xml 并使用以下内容

> mvn --projects util,entities,ejb,integration-tests install

但是在 Netbeans 中，当我选择集成测试项目并检查“使用依赖项构建”以执行操作，然后右键单击集成测试项目并选择构建时，Netbeans 会构建所有子项目，然后构建“集成测试”。

> 问题是：netbeans 似乎也在将集成测试添加到子项目列表中，这使得集成测试构建了两次，我的测试运行了两次。

```
Scanning for projects...
Reactor Build Order:

Utilities
Entities
Reports
EJB 
Integration Tests

[failsafe:integration-test]
builds Integration Tests

.... finishes building above modules

[failsafe:integration-test]
and then it build Integration Tests again 
```

* * *

# firebird - 将火鸟客户端连接到服务器

> ID：12310256
> 
> 赞同：5
> 
> 时间：2012-09-07T00:33:30.620
> 
> 标签：firebird

刚开始将**Firebird**与**Delphi XE**一起使用。需要一些帮助从客户端机器连接到服务器。

我可以ping服务器，所以有一个连接。但是当我`isql.exe`从 firebird/bin 文件夹运行以测试连接时，我得到一个`"statement failed, sqlstate=08006, unable to complete network request to host geith -failed to establish a network connection"`. ping geith 有效，所以我不明白那个错误。

我的连接语句是Connect geith:geidata user sysdba password masterkey；

这有效，我在服务器上运行时得到连接，但不是在客户端机器上。我已经确定`fbclient.dll`并且`gds32.dll`在 windows/system32 文件夹中。

我只在客户端机器上安装**Firebird 2.5客户端。**我没有看到它在任务管理器中作为进程运行。我需要做些什么来启动客户端服务吗？

两者都是 XP mach，**Firebird SuperServer 2.5**，也有 temp 关闭防火墙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:03:02.280

插入除端口**3050之外的防火墙**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-06T09:48:30.910

添加 Windows 防火墙设置。

**转到开始**-->**控制面板**--> **Windows 防火墙**-->**转到例外选项卡**-->**单击添加程序**--> 并选择**C:\Program Files\Firebird\Firebird_2_5\bin\fbguard.exe**

同样的方式添加**C:\Program Files\Firebird\Firebird_2_5\bin\fbserver.exe** 现在**重新启动系统** 并**检查从客户端到服务器的 firebird 连接**。

对于window7 **Windows 防火墙**-->**入站规则**-->**添加新规则**--> 添加**fbguard.exe**和**fbserver.exe**

# objective-c - 比较两个 NSURL 或一个 NSURL 和一个 NSString 的可靠方法？

> ID：12310258
> 
> 赞同：21
> 
> 时间：2012-09-07T00:33:47.407
> 
> 标签：objective-c, uiwebview, nsstring, nsurl, nsurlrequest

我最近在比较两个 NSURL 并将一个 NSURL 与一个 NSString（这是一个 URL 地址）进行比较时遇到了一个问题，情况是我从某个地方得到一个 NSURLRequest，我可能知道也可能不知道它指向的 URL 地址，我有一个 URL NSString，比如“http://m.google.com”，现在我需要检查该 NSURLRequest 中的 URL 是否与我的 URL 字符串相同：

```
[[request.URL.absoluteString lowercaseString] isEqualToString: [self.myAddress lowercaseString]]; 
```

这将返回 NO，因为它`absoluteString`给了我“http://m.google.com/”，而我的字符串是“http://m.google.com”，最后没有斜杠，即使我使用创建 NSURLRequest

```
[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://m.google.com"]] 
```

它仍然给我“http://m.google.com/” `absoluteString`，我想知道是否有任何可靠的方法可以与 NSURL 或一个 NSURL 和一个 NSString 进行比较？

1.  检查一个是否“包含”另一个，但这不可靠，因为“http://m.google.com/blabla”包含“http://m.google.com”。

2.  将 NSString 转换为 NSURL 并使用该`isEqual`方法比较两个 NSURL 并希望 NSURL 的实现`isEqual`可以弄清楚吗？

3.  基于第 2 步，但使用`standardizedURL`?将每个 NSURL 转换为标准 URL

非常感谢！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-08T15:39:32.500

如果您只关心斜杠的歧义，您可以通过知道 NSURL 路径修剪斜杠来快速免除这个问题。

但我喜欢在 NSURL 上实现一些基于标准的等价的类别方法的想法（在这种情况下，“等价”可能比等价更好）。

@RobNapier 指的是一个相关的问题，它有一个很好的答案，指向[RFC2616](http://www.ietf.org/rfc/rfc2616.txt)。url 语法的另一个相关标准是[RFC1808](http://www.w3.org/Addressing/rfc1808.txt)。

困难的部分是确定我们所说的等价性是什么意思，例如，不同的查询或片段（锚链接）呢？对于大多数这些歧义，下面的代码在允许方面犯了错误......

```
// in NSURL+uriEquivalence.m

- (BOOL)isEquivalent:(NSURL *)aURL {

    if ([self isEqual:aURL]) return YES;
    if ([[self scheme] caseInsensitiveCompare:[aURL scheme]] != NSOrderedSame) return NO;
    if ([[self host] caseInsensitiveCompare:[aURL host]] != NSOrderedSame) return NO;

    // NSURL path is smart about trimming trailing slashes
    // note case-sensitivty here
    if ([[self path] compare:[aURL path]] != NSOrderedSame) return NO;

    // at this point, we've established that the urls are equivalent according to the rfc
    // insofar as scheme, host, and paths match

    // according to rfc2616, port's can weakly match if one is missing and the
    // other is default for the scheme, but for now, let's insist on an explicit match
    if ([self port] || [aURL port]) {
        if (![[self port] isEqual:[aURL port]]) return NO;
        if (![[self query] isEqual:[aURL query]]) return NO;
    }

    // for things like user/pw, fragment, etc., seems sensible to be
    // permissive about these.
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-06-09T09:40:05.193

我知道这是回答。但我不认为，它很清楚。

我想推荐以下内容。

```
if ([[url1 absoluteString] isEqualToString:[url2 absoluteString]]) 
{
   //Add your implementation here
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-01-15T00:34:38.897

最近遇到了`[NSURL isEqual]`在比较两个 URL 时方法返回 false的情况`https://www.google.com/`，`https://www.google.com`我发现将`URLByAppendingPathComponent`带有空字符串的参数应用到两个 URL 将返回正确的结果。

所以像：

```
[[urlOne URLByAppendingPathComponent:@""] isEqual:[urlTwo URLByAppendingPathComponent:@""]] 
```

如果缺少斜杠，将添加斜杠，如果已经包含斜杠，则将其保留，因此比较将按预期进行。

在我看来，我似乎是在依靠一种奇怪的行为来解决另一种奇怪的行为，但这就是我要做的事情，除非我能以其他方式说服我 ;-)。

* * *

## 回答 #4

> 赞同：-10
> 
> 时间：2012-12-19T19:53:02.150

简单的方法是：

```
NSString*urlString=[NSString stringWithFormat:@"%@",request.URL]; 
```

所以你与 NSString 方法 isEqual 进行比较：

```
BOOL equalty=[urlString isEqual:anotherNSString]; 
```

XD

# javascript - jQuery：数据（）函数

> ID：12310259
> 
> 赞同：1
> 
> 时间：2012-09-07T00:34:00.143
> 
> 标签：javascript, jquery

我无法按照 codecademy.com 上的此问题说明进行操作。在使用 data() 函数获取存储在 'x' 的值后，我应该将其加倍，而不使用 'var' 然后将其存储在 'y' （使用 data() 函数）。我尝试了不同的“datafulDiv * 2”组合来加倍，但他们都错了。我确定这是一个我非常关心的简单问题，但如果您能提供帮助，我将不胜感激

```
$('document').ready(function() {

//get the div. 
//do not add var before this object for testing purposes!!
$datafulDiv = $('#dataful');

//get the value stored at 'x'
$datafulDiv.data('x');

//double it and store it at 'y'. again do not use var!

}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T00:37:37.750

```
$datafulDiv.data('y', ($datafulDiv.data('x')*2) ); 
```

# javascript - Three.js 文件未包含在我的 HTML 文件中

> ID：12310264
> 
> 赞同：1
> 
> 时间：2012-09-07T00:35:14.683
> 
> 标签：javascript, html, three.js

我正在学习 HTML5，我使用 Three.js 3D 引擎。按照[这个例子](http://www.aerotwist.com/tutorials/getting-started-with-three-js/)，本教程假设我将`three.js`文件包含到我的 HTML 文件中。但是，我找到了两个具有该名称的文件，因此我将两者都包含在内，但似乎没有任何效果。

在我的 html 文件中：

```
<script src="three.js/build/three.js"></script>
<script src="three.js/src/Three.js"></script> 
```

Three.js 包与我的 html 文件位于同一目录中，并且位于名为 three.js 的文件夹中。

我是否包含错误的文件？

**编辑**

当我在 Mozilla FireFox 中调试时，我收到了这条消息：

```
[13:41:04.275] ReferenceError: $ is not defined @ 
```

导致错误的行是这样的：

```
// get the DOM element to attach to
// - assume we've got jQuery to hand
var $container = $('#container'); 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T00:38:42.067

如果 js 文件在同一个目录中，你应该这样做

```
<script src="three.js"></script> 
```

属性内文件的路径`src`是相对于当前文件的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T02:29:18.227

由于 r50 它应该是：

```
<script src="three.js/build/three.min.js"></script> 
```

# function - 在 Compass/SASS 中调用函数

> ID：12310270
> 
> 赞同：1
> 
> 时间：2012-09-07T00:36:23.113
> 
> 标签：function, sass

我想在 SASS 中创建一个生成不同类的函数。像这样的东西

```
@function test($class-name) {
    @for $i from 1 through $tot-class {
        .#{$class-name}-#{$i} {
            //some rules
        }
    }
} 
```

但我不知道如何调用这个函数。我试过了

```
 @test(red); 
```

或者

```
 test(red); 
```

但它似乎不起作用。哪个是正确的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T13:42:04.667

这里的主要问题是您实际上不想使用[function](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#function_directives)，您想要一个[mixin](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#mixins)。不同之处在于函数不包含任何 CSS 规则——它们只是返回一个值（您可以将其分配给变量或在 CSS 属性声明中使用）。另一方面，mixin 没有返回值，并且可以包含完整的 CSS 规则，当该 mixin 包含到 SASS 文档中时要添加。这是您的示例作为 mixin 的样子：

```
@mixin test($class-name) {
    @for $i from 1 through $tot-class {
        .#{$class-name}-#{$i} {
            //some rules
        }
    }
} 
```

然后，您稍后将使用以下方法包含 mixin：

```
@include test(red); 
```

# java - 如何将 onTouchEvent 添加到应用程序？

> ID：12310271
> 
> 赞同：0
> 
> 时间：2012-09-07T00:37:05.000
> 
> 标签：java, android, events, touch, screen

我为 android 创建了一个非常简单的乒乓球应用程序。

看起来不错，但我有一个问题：

我尝试执行 onScreenTouch 事件，以便将球拍放置在用户的触摸位置。

我的问题是 - 在哪里添加`Obj.addOnTouchEvent(this)`？

什么对象处理屏幕触摸？什么是屏幕对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T02:11:48.443

任何图形部件都可以处理触摸事件。通常情况下使用视图或活动。

有几种处理触摸的方法，但我建议`GestureListener`：

```
public class GestureListener implements GestureDetector.OnGestureListener 
{
    MyView appliedView; //view who responses to graphical gestures

    public GestureListener(MyView currentView) 
    {
        this.appliedView = currentView;
    }

    @Override
    public boolean onScroll(MotionEvent e1, MotionEvent e2, 
            float dx,
            float dy) {
        //make your view response to gestures
        appliedView.onGestureMove(e1, e2, dx, dy);
        return true;
    }

    @Override
    public boolean onDown(MotionEvent arg0) {
        return true;
    }

    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, 
            float velocityX,
            float velocityY) {
        return true;
    }

    @Override
    public void onLongPress(MotionEvent e) {

    }

    @Override
    public void onShowPress(MotionEvent e) {

    }

    @Override
    public boolean onSingleTapUp(MotionEvent e) {
        return true;
    }
} 
```

**在您的 View 类中：**

```
public class MyView extends View 
{
    private GestureDetector gestureMgr;

    public MyView(Context context) 
    {
        super(context);
        gestureMgr= new GestureDetector(context, new GestureListener(this));
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) 
    {
        return gestureMgr.onTouchEvent(event);
    }

    public void onGestureMove(MotionEvent e1, MotionEvent e2, float dx, float dy)
    {
        //check obj is touched or not
        //do moving objects around              
    }
} 
```

# android - 使用自定义布局（背景）创建/更新 ListView

> ID：12310272
> 
> 赞同：0
> 
> 时间：2012-09-07T00:37:14.637
> 
> 标签：android, listview

我无法从 func 更改列表视图的背景

listView 通过 JSON 编码从 URL 接收数据，如下所示：

```
{"results":[
    {"db_id":"6","discount":"active","db_description":"bla bla bla ","db_num":"137","db_num2":"260"},
    {"db_id":"14","db_type":"discount","db_description":"blaaaaaaa","db_num":"39","db_num2":"46"},
    {"db_id":"18","db_type":"discount","db_description":"blaaaaaaa","db_num":"335","db_num2":"456"},
]} 
```

我的代码：

```
 ListAdapter adapter = new SimpleAdapter(
                        QueueActivity.this, QueueList,
                        R.layout.queue_row, new String[] { TAG_ID, TAG_DESCRIPTION, TAG_NUM, TAG_NUM2, TAG_IMAGE},
                        new int[] { R.id.qid, R.id.description, R.id.num, R.id.num2, R.id.list_image });

                setListAdapter(adapter); 
```

onListItemClick 我可以模拟更新背景

```
protected void onListItemClick(ListView l, View v, int position, long id) {
       super.onListItemClick(l, v, position, id);
       v.setBackgroundResource(R.drawable.listview_taken_background);   
       TextView textid = (TextView) v.findViewById(R.id.queueid);
       textid.setText("NEW TEXT")
} 
```

但我还需要从 func 更新背景，我该怎么做？

例如，命令 ***new FuncName().execute("2");*** 将第二行的背景资源设置为“R.drawable.listview_taken_background”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:14:18.107

您可以使用在此位置`ListView.getChildAt(int index)`返回您`View`的位置，然后编辑其背景。

# node.js - 尝试在节点中运行管道命令

> ID：12310285
> 
> 赞同：0
> 
> 时间：2012-09-07T00:39:08.167
> 
> 标签：node.js, command-line, process

我正在尝试`git branch | grep \*`像这样运行命令：

```
require('child_process').exec('git branch | grep \*', function(err){
  console.log(err);
}); 
```

但我不断收到错误`{ [Error: Command failed: ] killed: false, code: 1, signal: null }`

为什么会发生这种情况，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:09:43.597

你想跑`grep \*`吗？请记住，您必须在字符串中转义反斜杠。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T10:58:09.993

这意味着 grep 返回码是 1 而 grep 什么也没有。

您只需编写一个返回 1 的简单代码并在 node.js 中通过 exec 运行它，您将获得与上述相同的结果。

您可以通过 err.code 检查状态码，并在回调函数中执行诸如报告空结果之类的操作。

# android - 带有字典训练的 Tesseract 笔迹

> ID：12310287
> 
> 赞同：19
> 
> 时间：2012-09-07T00:39:20.670
> 
> 标签：android, tesseract, handwriting

我在文本文件中有一个单词词典，用换行符分隔。我想使用 Tesseract 识别笔迹，并在文本文件中输出最近的匹配行。

这是我第一次使用 Tesseract，它已经在我的项目工作区中，我只需要训练数据。

是否可以训练 Tesseract 做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-04T18:03:56.083

可以训练 tesseract 识别笔迹。以下是说明：[https ://tesseract-ocr.github.io/tessdoc/Training-Tesseract](https://tesseract-ocr.github.io/tessdoc/Training-Tesseract)

但不要期望非常好的结果。学者们通常会得到大约 90% 的准确度结果。这里有几个[单词](https://arxiv.org/pdf/1003.5893.pdf)和[数字](https://arxiv.org/pdf/1003.5898.pdf)的参考。因此，如果您的用例可以处理至少 1/10 的错误，那么这可能对您有用。

# java - 如何将服务器证书添加到本地受信任的 Java 密钥库？

> ID：12310292
> 
> 赞同：0
> 
> 时间：2012-09-07T00:39:43.843
> 
> 标签：java, web-services, ssl, ssl-certificate

我编写了 Java 客户端来访问安全服务的 Web 服务，但是 Web 服务主机使用的证书不是由证书颁发机构颁发的，而是自签名或由私有 CMS 颁发的。我收到以下错误：

```
PKIX path building failed: 
sun.security.provider.certpath.SunCertPathBuilderException: 
unable to find valid certification path to requested target 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T00:54:02.360

使用这个类

[https://confluence.atlassian.com/download/attachments/180292346/InstallCert.java?version=1&modificationDate=1315453596921](https://confluence.atlassian.com/download/attachments/180292346/InstallCert.java?version=1&modificationDate=1315453596921)

发出此命令 Java InstallCert “yourserver:sslport”</p>

ex Java InstallCert “chades:8443”</p>

另外不要忘记将您的 jssecacerts 文件复制到以下目录

Java 主页/jre[版本号]/lib/security

# git - Visual SourceSafe 关键字扩展 $History 的 Git 等效项

> ID：12310296
> 
> 赞同：1
> 
> 时间：2012-09-07T00:40:21.410
> 
> 标签：git, version-control, visual-sourcesafe

我们最近从使用 Visual SourceSafe 进行源代码控制转移到使用 Git。

尽管 SourceSafe 受到了很多批评，但它有一个非常有用的功能：[关键字扩展](http://msdn.microsoft.com/en-us/library/d826hy97%28v=vs.80%29.aspx)。可以将关键字标签添加到源文件中。当 SourceSafe 签入文件时，它会读取关键字并将信息注释添加到文件的头部。

我们发现最有用的 SourceSafe 关键字是 $History: $。在签入文件时，签入注释将作为注释添加到文件的头部。我们发现这些签入注释在用于更新对象（例如数据库中的存储过程）的 SQL 脚本中特别有用。

Git 是否有任何等效的方法在提交期间将元数据注释插入源文件？

# objective-c - 附件视图显示单元格的一半

> ID：12310298
> 
> 赞同：1
> 
> 时间：2012-09-07T00:40:37.317
> 
> 标签：objective-c, ios, xcode

我不知道如何让我的附件视图适合我的单元格。此外，当我添加一个子视图时，它会将其添加到添加的第一个子视图的右侧。我希望从右到左添加子视图。

我有这个作为我的附件视图

```
UIView *myAccessoryView = [[UIView alloc] initWithFrame:cell.accessoryView.frame]; 
```

每当我添加子视图时，我都会写这个

```
[myAccessoryView addSubview:greenCircle]; 
```

一旦它添加了另一个子视图，它就会被放置在前一个子视图的右侧，该子视图离我的单元格更远。如何反转它添加子视图的方式？如何格式化附件视图以保留在单元格上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T08:06:08.917

您正在尝试使用尚不存在的附件视图框架初始化 myAccessoryView。如果您指定 cell.accessoryType 属性，或者如果您自己创建和设置附件视图，它将在创建单元格（并添加到 tableView）之后创建，如下所示：

```
[cell setAccessoryView:myAccessoryView]; 
```

所以如果你这样做：

```
UIView *myAccessoryView = [[UIView alloc] initWithFrame:cell.accessoryView.frame];
[cell setAccessoryView:myAccessoryView]; 
```

您将拥有大小和坐标为零的附件视图。将cell设置为tableView后，accessoryView会在cell右侧获取标准原点。但它的大小仍然为零。并且您添加到附件视图的所有子视图都将设置为该原点。

方法“addSubview”不能更改子视图框架，它只是将一个视图放置到另一个视图。不知道为什么将新的子视图放置在前一个的右侧。要将您的子视图放在正确的位置，您必须手动设置它们的框架。例如：

```
UIView *greenCircle = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 30, 30)];
[myAccessoryView addSubview:greenCircle]; 
```

希望有帮助。

# r - 根据另一列的聚合结果计算一列上的数据

> ID：12310300
> 
> 赞同：1
> 
> 时间：2012-09-07T00:41:11.860
> 
> 标签：r, data.table

我想使用 data.table 来计算汇总统计数据，然后根据该结果计算第二列的统计数据。

这是使用空气质量数据的示例。

### 设置数据

（假装它是这样来的）

```
library(data.table)
dt = as.data.table(airquality)
dt[ , Season:=ifelse(Month>7, 'Fall', 'Summer')] 
```

有些月份有大风

```
## The range of monthly Wind values
dt[ , list(MinWind=min(Wind), MaxWind=max(Wind)), 
        by=c('Season', 'Month')]

---- R OUTPUT:
   Season Month MinWind MaxWind
1: Summer     5     5.7    20.1
2: Summer     6     1.7    20.7
3: Summer     7     4.1    14.9
4:   Fall     8     2.3    15.5
5:   Fall     9     2.8    16.6
> 
```

### 目标：计算按风速大于或小于 20 的月份分组的平均*季节性太阳辐射。*

我可以一步完成吗？

```
## Add a column to indicate if it was a high wind month
dt[, HighWind:=any(Wind>20), by=Month]
## Aggregate based on both HighWind and Season
dt[, list(AveSolarR=mean(Solar.R, na.rm=TRUE)), by=c("HighWind","Season")]

---- R OUTPUT:
   HighWind season AveSolarR
1:     TRUE Summer  185.9649
2:    FALSE Summer  216.4839
3:    FALSE   Fall  169.5690 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T01:05:26.233

为什么不将两者合二为一`list`？

```
dt[,list(HighWind=any(Wind>20),AveSolarR=mean(Solar.R,na.rm=T)),by=Month]
   Month HighWind AveSolarR
1:     5     TRUE  181.2963
2:     6     TRUE  190.1667
3:     7    FALSE  216.4839
4:     8    FALSE  171.8571
5:     9    FALSE  167.4333 
```

对于修改后的问题，你需要`HighWind`在语句中进行计算`by`，但我认为它使它更加复杂。

```
dt[,list(AveSolarR=mean(Solar.R,na.rm=T)),
  by=list(HighWind=Month%in%Month[Wind>20],Season)]
   HighWind Season AveSolarR
1:     TRUE Summer  185.9649
2:    FALSE Summer  216.4839
3:    FALSE   Fall  169.5690 
```

# android - 自定义扩展 TableLayout 不添加 xml TableRows

> ID：12310307
> 
> 赞同：0
> 
> 时间：2012-09-07T00:42:15.343
> 
> 标签：android, class, tablelayout

我给。

我正在尝试扩展 TableLayout 类（只是这样我就可以覆盖 onMeasure ）并且我正在扩展一个在 XML 中定义的 TableLayout。

TableLayout 出现了（我可以看到它，由于它的自定义背景），但 TableRows 没有。

即使在 Eclipse 的 XML“图形布局”中，如果我强制 TableLayout 成为我的自定义扩展类（com.example.MainApplication.TableLayout_Schedrunning），嵌套的 TableRows 也不存在。

但是，如果我将 XML 更改为 TableLayout，TableRows 就会神奇地出现。

```
<?xml version="1.0" encoding="utf-8"?>
<!-- this doesn't work-->
<com.example.MainApplication.Tablelayout_Schedrunning xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/frmlay_schedule"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_alignParentBottom="true"
android:layout_centerHorizontal="true"
android:layout_marginBottom="15dp"
android:layout_marginTop="15dp"
android:padding="2dp"
android:background="@drawable/schedrunning_background" >
<TableRow 
    android:id="@+id/tblrow_header"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginTop="10dp"
    android:layout_marginLeft="5dp"
    >
    <TextView 
        android:id="@+id/txtSchedRunningHeader"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Schedule Running"
        android:textColor="@android:color/white"
        android:textSize="13dp"/>

    <TextView 
        android:id="@+id/txtCurrScheduleRunning"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="@android:color/white"
        android:textSize="11dp"/>
</TableRow>

</com.example.MainApplication.Tablelayout_Schedrunning> 
```

再次重申——如果我将上面的自定义类更改为 simple `<TableLayout>`，TableRow 中的嵌套 TextViews 就会出现。如果我不这样做，他们就不会。我错过了什么简单的事情？

哦，TableLayout 是一个非常标准的扩展：

```
public class Tablelayout_Schedrunning extends TableLayout {

public Tablelayout_Schedrunning(Context context) {
    super(context);
    Log.w("tablelayout","simple context");
    // TODO Auto-generated constructor stub
}

public Tablelayout_Schedrunning(Context context, AttributeSet attrs) {
    super(context, attrs);
    Log.w("tablelayout","advanced, context and attrs");
    // TODO Auto-generated constructor stub
}
@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    // TODO Auto-generated method stub
    int parentWidth = MeasureSpec.getSize(widthMeasureSpec);
    int parentHeight = MeasureSpec.getSize(heightMeasureSpec);

    Log.w("tablelayout","parentWidth is " + parentWidth);
    Log.w("tablelayout","parentHeight is " + parentHeight);
    //super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    setMeasuredDimension(parentWidth, (int) (parentHeight * .4));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:54:56.340

我认为你应该在你的扩展中添加`super.onMeasure`和`setLayoutParams``View`

# php - 开源 CSS 文件生成器

> ID：12310309
> 
> 赞同：2
> 
> 时间：2012-09-07T00:42:17.713
> 
> 标签：php, css

我正在寻找一个用 PHP 实现的 CSS 生成器。这个想法是脚本获取一些输入，例如：array('element' => 'div', 'color' => '#00ff00') 并生成一个文件：

```
div {
  color : #00ff00; 
} 
```

或者类似的东西，你明白了。请不要指向某些软件或在线服务，我正在寻找可以在我的项目中使用的实际开源实现，例如 PHP 类左右。

是否有您所知道的开源实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T00:48:33.727

LESS 或 SASS...都是免费的、开源的。它们至少会为 CSS 解析和模板逻辑提供一个良好的起点（即使它可能不是正确的解决方案——参见评论）。

*   [LESS](http://lesscss.org/) - 存在 JavaScript、C#、[PHP](http://leafo.net/lessphp/)版本（可能还有其他版本）。
*   [SASS](http://en.wikipedia.org/wiki/Sass_%28stylesheet_language%29) - Ruby、JavaScript 和 PHP

与某些评论状态不同，如果您希望该工具有用，这不是一项微不足道的任务（我假设您的代码示例是从完整实现中简化的）。

有几种方法可以实现 CSS 预处理：

*   在浏览器中（JS 版本）。这会在每次页面查看时给浏览器带来大量负载，并可能[导致问题](https://stackoverflow.com/a/12228833/453277)。

*   在服务器上。这种方法通常生成然后缓存输出，因此它的速度可以接受。我喜欢这个用于开发工作，因为我可以实时看到我的变化。

*   预编译。使用这种方法，您可以独立于 Web 服务器生成最终的 CSS 并静态链接到它。这是性能最高的方法，但需要最多的手动工作。

# c# - 使用具有强类型方法的类型对象

> ID：12310310
> 
> 赞同：2
> 
> 时间：2012-09-07T00:42:23.390
> 
> 标签：c#, reflection, strong-typing

我什至不确定这是否可能，但这是我面临的问题。

基本上我有一个强类型的方法如下

```
ConsoleHelper.Start<T>() where T:IService 
```

我想要实现的是使用反射动态加载 T ，所以沿着线

```
var type = Assembly.Load("assembly").GetType("type"); 
```

然后将该类型与上面定义的强类型方法一起使用。这是可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T00:49:14.770

当然，您可以使用[MethodInfo.MakeGenericMethod](http://msdn.microsoft.com/en-us/library/system.reflection.methodinfo.makegenericmethod.aspx)来执行此操作。

```
var startMethod = typeof(ConsoleHelper).GetMethod("Start");

// Equivalent of Start<SomeType>
var typedStartMethod = startMethod.MakeGenericMethod(typeof(SomeType)); 
```

# mysql - 多个值在mysql中插入连接

> ID：12310312
> 
> 赞同：4
> 
> 时间：2012-09-07T00:42:43.377
> 
> 标签：mysql, join, insert

我有一个查询提交表中的多个项目`a`。

例如：

```
insert into a values(id,name) (5,'john'),(6,'smith'); 
```

虽然我还需要使用此 ID 从其他表中选择第三个值。

例如：

```
insert into a values(id,name,money) (5,'john',(select money from b where id=5)),(6,'smith',(select money from b where id=6)); 
```

上面的问题是它有点重复并且还使用子选择。

我想知道是否可以使用`JOIN`, 重写它（这也应该确保与给定 id 上的表 b 存在*关系*，以免它插入 NULL）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T00:46:16.803

`SELECT`每个只允许一个，`INSERT`因此您需要重新编写它以选择多行，而不是一次插入多个值。您能否创建一个临时表，其中包含两组值和`INSERT`带有 的值`JOIN`？

```
CREATE TEMPORARY TABLE _tmp_a (id INT PRIMARY KEY, name VARCHAR(255));
INSERT INTO _tmp_a (5, 'john'), (6, 'smith')
INSERT INTO a (id, name, money) SELECT _tmp_a.id, _tmp_a.name, b.money FROM _tmp_a LEFT JOIN b ON b.id=_tmp_a.id 
```

# java - Android - 项目的缩放问题

> ID：12310315
> 
> 赞同：-1
> 
> 时间：2012-09-07T00:42:59.437
> 
> 标签：java, android

我正在研究这个项目，其中涉及一个带有从数据库填充的图钉的地图。我的想法是点击地图，然后大头针会拉出信息，我已经完成了所有这些工作。我用相对布局和其中的引脚定位这些。

我的问题出在哪里，我需要缩放，所有这些都在这里，当我放大图像时，我的图钉保持在原来的位置。无论如何，当图像放大时，我可以让这些图钉放大吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T00:50:37.313

我会考虑通过确切的位置（例如纬度和经度）将图钉放置到地图上，然后图钉始终是相同大小的图像，当地图缩放时，图钉相对于那里的确切位置与下面的图像一起移动.

另一个例如将销定位在像素 100 右和 50 下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T11:09:40.197

在 Android 视图中实现类似 HTML 地图的元素：

支持在布局中作为可绘制或位图的图像 允许在 xml 中列出区域标签 允许使用剪切和粘贴 HTML 区域标签到资源 xml（即，能够获取 HTML 地图 - 和图像并在最少编辑的情况下使用它）如果图像大于设备屏幕，则支持平移支持捏缩放支持点击区域时的回调。支持将注释显示为气泡文本并在点击气泡时提供回调尝试此链接您将找到您的解决方案[https://github.com/catchthecows/AndroidImageMap](https://github.com/catchthecows/AndroidImageMap)

# asp.net-web-api - 区域内的 ApiController

> ID：12310317
> 
> 赞同：0
> 
> 时间：2012-09-07T00:43:23.860
> 
> 标签：asp.net-web-api, asp.net-mvc-areas

我想要`BlaController : ApiController`BlaController 位于 /Areas/XXX/ （或命名空间`MySolution.Areas.XXX.Controllers`）

问题是当我浏览到`http://localhost:1935/XXX/Bla/SomeAction`404时。
普通控制器 ( `: Controller`) 不会抛出 404。

*注意： SomeAction 将是例如“public string SomeAction() { return "hi"; }"，在 BlaController* *注 2：尝试过*`http://localhost:1935/api/Bla/SomeAction` *并且也没有工作*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:12:24.690

基于这个[SO question](https://stackoverflow.com/questions/9485934/how-do-i-register-a-controller-that-has-been-created-in-an-area)，看起来您需要构建自己`HttpControllerFactory`的才能使用 WebAPI 支持区域。

该问题引用了有关如何执行此操作的文章：http: [//netmvc.blogspot.com/2012/03/aspnet-mvc-4-webapi-support-areas-in.html](http://netmvc.blogspot.com/2012/03/aspnet-mvc-4-webapi-support-areas-in.html)

希望这可以帮助。

**更新：** 感谢 Bertrand，他指出了一篇关于 WebApi 对区域的支持的更新文章（默认情况下仍然没有）。更新后的链接是[http://netmvc.blogspot.be/2012/06/aspnet-mvc-4-webapi-support-areas-in.html](http://netmvc.blogspot.be/2012/06/aspnet-mvc-4-webapi-support-areas-in.html)

# css - Wordpress CSS - 菜单中图像按钮的问题在悬停时消失

> ID：12310318
> 
> 赞同：1
> 
> 时间：2012-09-07T00:43:50.167
> 
> 标签：css, wordpress

我正在尝试将社交关注链接按钮的自定义图像添加到我的网站侧边栏菜单。现在我被困在 Facebook 上作为我的第一个测试，但理想情况下想稍后再添加其他测试。（我意识到使用我选择的方法可能并不容易）

我尝试使用各种方法，到目前为止我最成功的是 DIY Themes （[本文](http://diythemes.com/thesis/rtfm/replace-wp-menu-text-links-image-sprites/)）和我的网站 style.css 上的方法，我添加的代码如下：

```
#menu-item-127 a {
    display:block; 
    height:83px; width:75px; 
    padding:0px; 
    margin-left:6px; 
    outline:none; 
    /*text-indent:-9999px;*/
    background-image:url('/wp-content/uploads/2012/09/Grunge-Facebook-Stamp-small-sprite.png');
    background-position:0 -82px;
}

#menu-item-127 a:hover { background-position:0 0px; } 
```

***问题是，当您将鼠标悬停在链接上时，背景图像会消失，***它不会像应有的那样过渡到精灵的“活动”版本。

其次，文本不会缩进屏幕，而是停留在图像的顶部（我知道上面的代码中已注释掉该部分，因为我打开和关闭它以测试发生了什么，并没有什么区别)

第三个问题是悬停激活区域太大，它拉伸了菜单栏的整个宽度，而不是正好在图像的正上方。所以如果你在图片的右边，它仍然被认为是“悬停”，即使你不能点击 FB 链接。

它似乎与我的 style.css 的其他部分有关，因为即使我删除了上述代码的 a:hover 部分，它仍然会使背景图像消失。我已经调整了每个变量并检查了我知道的每个元素，我对此感到困惑。

我的网站是americagonepostal.com。基本主题是嗡嗡声。

顺便说一句，我以前从未真正做过 CSS。我做这个网站是为了帮我的表弟，他完全是技术智障，但是是一位艺术家，所以有非常具体的审美期望。我只是在不知道自己在做什么的情况下一直在破解，因此，如果有更好的方法可以将带有链接的图像放在该侧面菜单区域中，我会全力以赴。悬停时不一定要“突出显示”，但这将是一个不错的选择。

理想情况下，我想以相同的蹩脚邮票样式添加 Facebook、Twitter 和 RSS 按钮，但水平放置。是否可以像我所做的那样使用自定义菜单将所有 3 个按钮放在一个水平面上？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T03:22:58.220

尝试这个：

```
#menu-item-127 a:hover {
background: url("/wp-content/uploads/2012/09/Grunge-Facebook-Stamp-small-sprite.png") !important; 
```

**!important**将覆盖任何继承的样式

文本缩进：更改品牌部分中的文本对齐属性：

```
#branding { border: 0 none;
            bottom: 0; 
            padding-top: 5em; 
            text-align: none;
            top: 0; } 
```

然后以相同的方式覆盖：

```
#menu-item-131 a:hover { background-position: 0 0 !important; 
                         text-indent: -999px !important;} 
```

这仅适用于 a:hover 如果您需要影响正常状态以及您必须使用内联样式（不是最佳实践，但在这种情况下将解决问题）：

```
 <li id="menu-item-131" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-131" style="text-indent:-999px"> <a href="facebook.com/AmericaGonePostal"; target="_blank">fb</a> </li> 
```

悬停激活区域过大的第三个问题：

```
#menu-item-131 a{ background-position: 0 0 !important; 
                 text-indent: -999px !important;
                 width:75px !important; } 
```

# javascript - 如何在 Rails 中将 json 呈现为没有元标记的数组数组——（将数据传递到谷歌图表 api javascript）

> ID：12310324
> 
> 赞同：2
> 
> 时间：2012-09-07T00:45:11.330
> 
> 标签：javascript, jquery, ruby-on-rails, ruby, json

在 Rails 中，这是我当前生成的一个 api 响应，作为来自 /charts_json/south_carolina.json 的响应（例如）

```
[{"d_s":0,"name":"summerville"},{"d_s":1,"name":"hilton head island"},{"d_s":2,"name":"north myrtle beach"},{"d_s":1,"name":"spartanburg"},{"d_s":12,"name":"greenville, sc"},{"d_s":0,"name":"aiken"},{"d_s":6,"name":"columbia"},{"d_s":4,"name":"myrtle beach"},{"d_s":1,"name":"simpsonville"},{"d_s":1,"name":"lancaster, sc"},{"d_s":0,"name":"north augusta"},{"d_s":0,"name":"sumter"},{"d_s":0,"name":"rock hill"},{"d_s":1,"name":"beaufort, sc"},{"d_s":1,"name":"mount pleasant"},{"d_s":21,"name":"charleston"},{"d_s":1,"name":"clemson"},{"d_s":1,"name":"anderson, sc"}] 
```

现在我需要做的是像这样将上面的内容呈现为 json 文档

```
[['0', 'summerville'], ['1', 'hilton head island'], ...etc... ] 
```

为了 SO 社区的利益和读者的澄清，如果我处理最后一件事情，我将包括我将用来完成这项工作的所有代码

除了我的charts_controller，我还生成了一个charts_json_controller 来响应json 请求——该控制器中的控制器方法的一个示例（这有点笨拙，但现在只要我能获得功能就可以了）

```
def south_carolina
    @locations = Location.find(1687).descendants #used acts_as_tree gem
    respond_to do |format|
      format.json { render json: @location.as_json(only: [:d_s, :name])}
end 
```

在视图中（横截面）

```
function drawMarkersMap() {
    var data = google.visualization.arrayToDataTable([
      ['Startups', 'Location'],
      $.ajax({url: '/charts_json/south_carolina', dataType: 'json'})
  ]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T00:55:11.770

不确定我是否理解正确，但这是一种将 json 作为数组而不是散列获取的方法。

为 Location 定义这个方法

```
上课地点
  def self.as_json_array
    as_json(仅: [:d_s, :name]).collect { |l| [l[:d_s], l[:name]] }
  结尾
结尾
```

如果需要，您可以使其更通用，但我想确保我首先了解您的要求。

然后只需在渲染行中使用该方法而不是 as_json 。

此外，听起来你知道这一点，但你真的应该只使用相同的控制器，并将任何自定义代码用于不同的格式放在你的 respond_to 块中。

# ios - 在 Xcode 中的 App 内打开 URL

> ID：12310326
> 
> 赞同：1
> 
> 时间：2012-09-07T00:45:25.650
> 
> 标签：ios, xcode, safari

在我的应用程序中，我希望在应用程序中打开一个 URL，而不是在 safari 中打开，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T00:48:52.917

如果您想在应用程序中加载网页，UIWebView 就是您的答案。

```
// example:

UIWebView *webView = [[UIWebView alloc] init];
[webView setFrame:CGRectMake(0, 0, 320, 460)];
[webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://google.com"]]];
[[self view] addSubview:webView]; 
```

如果你真的想变得花哨，你可以使用你自己的 UIApplication 子类并在你的应用程序中拦截 OpenURL 方法，然后弹出一个模式视图或类似的东西来打开你的应用程序中的 URL，当它通常会打开应用之外的 URL。

# javascript - EmberJS：将路由器拆分为多个文件

> ID：12310327
> 
> 赞同：1
> 
> 时间：2012-09-07T00:45:36.580
> 
> 标签：javascript, ember.js, ember-old-router

任何人都可以举一个很好的例子来说明如何将路由器分成多个文件，并且有没有这样做的最佳实践？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T14:07:50.363

这是我正在做的一个非常简化的版本。只需确保您以正确的顺序需要文件。

```
//router.js
App.Router = Ember.Router.extend({
  accounts: App.AccountsRoutes.extend({
    route: "/account"
  })
  // more routes here
})

//account_routes.js
App.AccountRoutes = Ember.Route.extend({
  index: Ember.Route.extend({
    route: '/',
    connectOutlets: function(router){
       // connect here
    }
  })
  // more routes here
}) 
```

# qt - 如何创建动态 QGraphicsItems

> ID：12310329
> 
> 赞同：0
> 
> 时间：2012-09-07T00:45:58.950
> 
> 标签：qt, qgraphicsitem

目前我有一个继承QGraphicsItem的类'Polygon'。我有创建和配置多边形的类“PolygonFactory”。PolygonFactory 从数据库中读取信息，并从该信息中创建多边形。我的问题是，如果我继承 QGraphicsItem，我必须将它的形状指定为常量，但我需要动态创建多边形。您可能会说“不要继承 QGraphicsItem”，但我需要这样做，因为我需要与 GraphicsScene 中的多边形进行用户交互。我希望我很清楚，但如果您需要更多信息，请告诉我。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:20:40.607

你可以在 QGraphicsItem 中绘制任何你想要的东西。对于这种情况，我建议将 QGraphicsPathItem 子类化。

你的多边形什么时候改变？每当发生这种情况时，您都可以使用新形状调用 setPath。

# iphone - Objective-C NSArray 的麻烦

> ID：12310334
> 
> 赞同：2
> 
> 时间：2012-09-07T00:46:21.940
> 
> 标签：iphone, ios, xcode, cocos2d-iphone

好的，我正在尝试在某些位置处理一副纸牌，但我被困在了某个位置。我只处理比最大值少一个。我正在尝试处理 nsarray 索引中的每个位置。

```
- (CGPoint)animateDealingToPlayer:(Player *)player withDelay:(NSTimeInterval)delay
{
    self.frame = CGRectMake(-100.0f, -100.0f, CardWidth, CardHeight);
    self.transform = CGAffineTransformMakeRotation(M_PI);

    NSArray *position = [NSArray arrayWithObjects:

                         [NSValue valueWithCGPoint:CGPointMake(0, 0)],
                         [NSValue valueWithCGPoint:CGPointMake(0, 0)],
                         [NSValue valueWithCGPoint:CGPointMake(0, 0)],
                         [NSValue valueWithCGPoint:CGPointMake(0, 0)],
                         [NSValue valueWithCGPoint:CGPointMake(10,   50)],

                         nil];

    for(int i=0; i<5; i++) {
        NSValue *value = [position objectAtIndex:i];
        CGPoint point = [value CGPointValue];
        NSLog(@"%@",NSStringFromCGPoint(point));

        self.center = point;

    }

} 
```

我在 10,50 发牌，而不是在以前的位置发牌，例如 0,0。这可能很容易解决，但我似乎不记得如何解决这个问题。请帮我。另外，请注意，我对目标 c 还有些陌生，所以如果你解决了这个问题，你可能不得不把它变笨。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:08:03.830

问题是您设置卡片位置 5 次而没有做任何动画或让卡片对象有机会在更改其位置之间重新绘制。在运行循环有机会触发之前，iOS 不会真正定位卡片。有许多可能的解决方案，但您可能应该考虑在循环中添加一个动画块，以便移动排队等待显示。

# jquery - 表格中的图像格式化程序问题

> ID：12310335
> 
> 赞同：3
> 
> 时间：2012-09-07T00:46:40.157
> 
> 标签：jquery, jqgrid, jqgrid-formatter

我是 jqGrid 的新手，我正在使用 jqGrid-4.4.0 使用 Spring MVC 显示来自 db2 数据库的值。我已经使用格式化程序选项来根据其中一列的值显示图像，这也可以正常工作。问题是，当我双击要编辑的行而不是从列中获取值时，我得到了图像 html 标记。如何显示从数据库中获得的实际值？

下面是我用来格式化的函数

```
function imageFormat( cellvalue, options, rowObject ){
    var img="";
    if(cellvalue==true){
        img= "<img src='"+CONTEXT_ROOT+"/images/icons/Light_Green_Round_16_n_g.gif'  BORDER='0'/>";
    }else{
        img= "<img src='"+CONTEXT_ROOT+"/images/icons/Light_Red_Round_16_n_g.gif'  BORDER='0'/>";
    }
    return img;
} 
```

在 colModel 我正在调用该函数

```
colModel:[
        {name:'idCasePackOptions',hidden:true,editrules:{edithidden:true, required:false}, editable:true},  
        {name:'cypharecommended',index:'cypharecommended', width:170, sorttype:"int", sortable:true, editable:true, edittype:'checkbox', editoptions: { value:"1:0" }},
        {name:'distributorapproved',index:'distributorapproved', width:170, sorttype:"int", edittype:'text', editable:true, sortable:true},
        {name:'height',index:'height', width:100, sorttype:"float", edittype:'text', editable:true,sortable:true},
        {name:'length',index:'length', width:80, align:"right",sorttype:"float", edittype:'text', editable:true, sortable:true},
        {name:'statuscode',index:'statuscode', width:90, align:"right", edittype:'text', editable:true,sorttype:"int", sortable:true, formatter:imageFormat},       
        {name:'weight',index:'weight', width:100,align:"right", edittype:'text', editable:true,sorttype:"float", sortable:true},        
        {name:'width',index:'width', width:100, editable:true, edittype:'text', sorttype:"float",sortable:true}     
    ] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T12:13:21.357

除了您正在使用的自定义格式化程序之外，您还可以声明一个[unformatter](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3acustom_formatter#unformatting)。它的定义和创建非常类似于自定义格式化程序，并遵循以下格式：

```
function imageUnFormat( cellvalue, options, cell){
    return $('img', cell).attr('src');
} 
```

其中参数如下：

> cellvalue - 未格式化的值。
> 
> options - 包含行 ID 和列模型的对象
> 
> cellobject - 一个 JQuery 单元格对象。

然后，您可以像格式化程序一样在列模型中声明它：

```
{name:'statuscode',index:'statuscode', width:90, align:"right", edittype:'text', editable:true,sorttype:"int", 
sortable:true, formatter:imageFormat, unformat:imageUnFormat}, 
```

# php - 使用 fgetcsv 然后 foreach 的 PHP 问题

> ID：12310338
> 
> 赞同：1
> 
> 时间：2012-09-07T00:47:04.753
> 
> 标签：php, foreach, fgetcsv

好的，事情就是这样。

```
if (!$fp=fopen($file,"r")) echo "The file could not be opened.<br/>";  
            while (( $data = fgetcsv ( $fp , 1000 , ',')) !== FALSE ) {
                // here, var_dump($data); shows the correct array
                $i = 0; 
                foreach ($data as $i=>$row ) {  
                   $matrix=explode( ',', $row);
                   // $matrix recieves only the first field of the csv line
                   // seems like I'm getting a field on each foreach iteration
                   // shouldn't I get the whole line each time?
                } //end foreach
            } //end while 
```

我真的没有看到这里的问题。顺便说一句，这段代码在我的本地机器上工作，在我的服务器上不起作用。都是linux的，php版本是一样的。

有什么想法吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T01:15:25.217

fgetscv() 将每一行作为数组返回。所以你的问题是这样的：

$data 是一行，它已经是一个数组。while() 循环中的每次迭代都将返回一行。没有必要爆炸。

```
$allRowsAsArray = array();
if (!$fp=fopen($file,"r")) echo "The file could not be opened.<br/>";  
while (( $data = fgetcsv ( $fp , 1000 , ',')) !== FALSE ) 
{
    $allRowsAsArray[] = $data;
}
print_r($allRowsAsArray); //Will return your entire csv as an array of rows, each row as an array. 
```

# android - 使用 Theme.Holo 时在选项菜单中显示图标

> ID：12310339
> 
> 赞同：4
> 
> 时间：2012-09-07T00:47:05.680
> 
> 标签：android, android-layout, android-ui

当`android:theme="@android:style/Theme.Holo`用作我的活动的默认主题时，菜单 xml 中定义的图标在选项菜单/操作溢出中不再可见（使用旧主题时它们是可见的。）

如何用 显示图标`Theme.Holo`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T18:18:16.060

好的，回答我自己的问题：`Theme.Holo`在动作溢出中不显示图标。那么为什么一些预装的标准应用程序有菜单图标呢？因为他们使用的是`Theme.DeviceDefault`主题，这显然与我的三星 Galaxy S II 上的 Holo 不同。

# ruby-on-rails - 始终显示 Kaminari 的分页控件

> ID：12310343
> 
> 赞同：3
> 
> 时间：2012-09-07T00:47:38.190
> 
> 标签：ruby-on-rails, ruby, pagination, kaminari

即使总页数为 1，有没有办法让 Kaminari 始终显示分页控件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T00:47:38.190

您可以在运行时扩展 Kaminari，这个过程称为 [monkey-patching]。只需在 config/initializers/kaminari_ext.rb 中创建一个文件，其中包含以下内容：

```
module Kaminari
  module Helpers
    class Paginator
      def render(&block)
        instance_eval(&block) if @options[:total_pages] >= 1
        @output_buffer
      end
    end
  end
end 
```

您需要重新启动 Rails 服务器才能使更改生效。

**如果您收到关于num_pages**为 nil的错误，您可以更改主题中的**num_pages**，将其更改为**total_pages**。最终**num_pages**将被弃用以代替**total_pages**。

例如，我必须更改**_page.html.haml**：

```
= raw("PAGE  #{page}  OF  #{total_pages}") 
```

# c# - 通过套接字发送自定义 WCF 请求

> ID：12310347
> 
> 赞同：1
> 
> 时间：2012-09-07T00:48:18.560
> 
> 标签：c#, .net, wcf, sockets, tcp

我已经看到一些关于这个主题的问题没有得到回答。我想向使用 NetTcpBinding 的自托管 WCF 应用程序发送请求。问题是，我必须使用套接字。

我已经编写了一个传输绑定元素，它打开一个 TcpListener（在 ChannelListener OnOpen 上）这工作正常，但在这种情况下 - 我将不得不使用我自己的消息框架模型。

显然，我不会实现 net.tcp 消息框架模型（[http://msdn.microsoft.com/en-us/library/ff470920%28v=prot.10%29.aspx](http://msdn.microsoft.com/en-us/library/ff470920%28v=prot.10%29.aspx)）

我读过一些帖子（包括[http://blogs.msdn.com/b/carlosfigueira/archive/2008/01/13/writing-custom-requests-to-simple-wcf-services.aspx](http://blogs.msdn.com/b/carlosfigueira/archive/2008/01/13/writing-custom-requests-to-simple-wcf-services.aspx)）这表明我应该发送一个请求并解释通过 MessageEncoder/MessageInspector 发送的字节。

这样，我基本上可以为我的每个方法/操作创建一条消息（每个请求都有微小的更改）

我尝试了这种方法，当我使用 WCF 通道（来自 ChannelFactory）时，我得到了有问题的字节（通过使用自定义 MessageEncoder）。

我已经保存了这些字节，并通过 TcpClient 发送它们 - MessageEncoder 不会启动。

当我打开一个普通频道时：

```
 ChannelFactory<ITestService> factory = new ChannelFactory<ITestService>(new    NetTcpBinding(),
            "net.tcp://localhost:76599");

        factory.CreateChannel().DoSomething(string.Empty); //gets to MessageEncoder 
```

当我通过套接字尝试相同时：

```
 TcpClient cli = new TcpClient("localhost", 76599);

        byte[] fileArray = File.ReadAllBytes("c:\\fileFromMessageEncoder.bin");
        cli.GetStream().Write(fileArray, 0, fileArray.Length); // Does not get to MessageEncoder 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T15:01:10.660

终于让它工作了。
在发送通过 MessageEncoder 获得的字节之前，我为 Net.Tcp 连接启动了默认握手。

请务必注意，端点 uri 必须是 UTF-8 编码的。

这个过程非常简单——发送协商请求，发送 End Preamble 消息（0x0C）并等待服务器返回 Preamble Ack 消息（0x0B）。

然后您可以发送二进制信封并接收来自 WCF 应用程序的响应。

我希望这篇文章可以在将来对某人有所帮助。

```
NegotiationConsts.Via via = new NegotiationConsts.Via(uri);
int arraySize = via.EndpointString.Length + 
NegotiationConsts.DefaultRequestLength;

byte[] request = new byte[arraySize];

int count = 0;
request[count++] = NegotiationConsts.Version.RECORD_TYPE;
request[count++] = NegotiationConsts.Version.MAJOR_VERSION;
request[count++] = NegotiationConsts.Version.MINOR_VERSION;

request[count++] = NegotiationConsts.Mode.RECORD_TYPE;
request[count++] = NegotiationConsts.Mode.DUPLEX;

request[count++] = NegotiationConsts.Via.RECORD_TYPE;
request[count++] = via.Length;
via.EndpointString.CopyTo(request,count);
count+=via.EndpointString.Length;

request[count++] = NegotiationConsts.WCFEncoding.RECORD_TYPE;
request[count++] = NegotiationConsts.WCFEncoding.BINARY_ENCODING;

return request; 
```

# ruby-on-rails - 测试中有很多不同的模型（rspec）？先进的

> ID：12310349
> 
> 赞同：1
> 
> 时间：2012-09-07T00:48:22.420
> 
> 标签：ruby-on-rails, ruby, rspec

我只是在寻找资深/更有经验的 Ruby/Rails 开发人员的答案，因为我认为这是一个更高级的问题。

我正在研究一个宝石，它为 AR 模型添加了一些行为。我必须针对许多不同的关联（has_many、habtm、has_one 等）测试它，并且我还必须测试为关联传递不同选项时的行为（例如：foreign_key）。现在有了所有这些不同的模型，我可以在数据库中使用同一个表，因为字段本身不需要更改，只需通过 has_many、belongs_to 等指定行为。请记住，有很多不同的选项，因此模型的数量非常大。

首先，出于可读性目的，我认为在测试本身旁边/中定义模型并不是一个坏习惯（如果我有多个使用相同模型的测试，那么我会将它们组合在一起并使用之前方法）。所以这是我的目标之一，如果您不同意，可以对此发表评论。

我不确定的第二件事是我想在所有测试中保持模型的简单/相同名称，例如“Task”，而不是 TaskWithManySubtasksAndForeignKey 或类似的丑陋的东西。问题是模型太多了，很难想出有意义和简单的名字。我不太确定这一点 - 使用相同的名称，因为它是一个常数，有点问题。我有一个代理类的解决方案，但我认为这不是最佳解决方案。我正在考虑使用像“taskModel”这样的变量（使用 let 方法），但它看起来有点冗长和不寻常。

想到的另一种选择，但我不确定是否可以轻松完成，是删除现有关联，然后定义一个新关联。所以例如添加一个has_many然后删除它，添加一个habtm ...

你会怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:21:34.650

在规范文件中定义独特的模型不一定是一个坏主意，因为它可以很容易地看到每个模型是如何定义的。这种方法的明显问题是如果您想在其他测试文件中重用模型。Rails 的方法是[在单独的文件中定义所有模型，](https://github.com/rails/rails/tree/master/activerecord/test/models)然后在需要它的测试中使用它们。

我认为这真的取决于你有多少模型以及你想要重用多少。在我的一个 gem 中，我采用了[在 spec 文件中定义模型](https://github.com/beerlington/classy_enum/blob/master/spec/classy_enum/active_record_spec.rb)的方法，在另一个 gem 中，我在[spec helper](https://github.com/beerlington/sudo_attributes/blob/master/spec/spec_helper.rb)中定义了它们，而在另一个 gem 中，我采用了 Rails 方法并为它们使用了一个[单独的目录](https://github.com/beerlington/herd/tree/master/spec/support)。如果你问我更喜欢哪一个，我可能会选择包含模型的规范，因为它都在一个地方。绝对是一个主观问题。

我有时采取的另一种方法是创建一个匿名类，保证只在该测试的生命周期内存在：

```
describe 'my test' do
  let(:my_class) do
    Class.new(Task) do
      has_many :things
      belongs_to :something_else
    end
  end

  it 'should have many things' do
    my_class.should have(100).things
  end
end 
```

# jquery - iPad jquery live('click') 问题

> ID：12310356
> 
> 赞同：1
> 
> 时间：2012-09-07T00:49:24.037
> 
> 标签：jquery, ipad, mobile-safari, modal-dialog

我有一个模式对话框，当有人使用以下功能单击覆盖时关闭它，它适用于除 iPad 和 iPhone Safari 之外的所有浏览器。

```
$(".ui-widget-overlay").live('click', function() { 
//mycode to close modal dialog
}); 
```

我试过 $(".ui-widget-overlay").click 但这不起作用。

如果 iPad 上的元素 jQuery 实时事件上没有 onclick 属性，则实时功能在 iPad[上不起作用……为什么它不起作用？](https://stackoverflow.com/questions/3344960/jquery-live-event-on-ipad-why-doesnt-it-work)

所以我尝试在 live 函数之前添加属性，但它仍然不起作用。这是我正在做的事情：

```
$(".ui-widget-overlay").attr('onclick', '');
$(".ui-widget-overlay").live('click', function() { 
//mycode to close modal dialog
}); 
```

有没有人找到解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-04T15:27:33.853

```
$j(".telephonePopup").dialog({
    open: function (event) {
        $j('.ui-widget-overlay').live("touchstart click", function() {
            $j(".telephonePopup").dialog("close");
            return false;
        });

                    // if you want also to stop scrolling while popup is displayed
        document.ontouchmove = function(e){
           e.preventDefault();
        }
    },
    close: function (event) {
        $j('html').removeClass('stop-scrolling');
        document.ontouchmove = null;
    }, 
```

# php - PHP 使用 swift mailer 通过谷歌应用程序发送电子邮件

> ID：12310362
> 
> 赞同：1
> 
> 时间：2012-09-07T00:50:18.810
> 
> 标签：php, smtp, google-apps, swiftmailer

我知道对此有一些问题，但我能找到的任何问题都没有解决我的问题。

我在 LAMP 上使用 swift mailer 4.2.1。

我启用了 openSSL： ![在此处输入图像描述](../Images/eea1f349f3a2b797ee3df5e541169d52.png)

所以我尝试使用以下代码进行 SSL 连接：

```
$transporter = Swift_SmtpTransport::newInstance('smtp.gmail.com', 465, 'ssl')
          ->setUsername('email@somedomainwithgoogleapps.com')
          ->setPassword("pwd");
        $mailer = Swift_Mailer::newInstance($transporter);
        $message = Swift_Message::newInstance($subject)
          ->setFrom(array($from => 'From name'))
          ->setTo(array($to=> $name))
          ->setBody($html_content);

        $result = $mailer->send($message); 
```

这会引发以下错误

> 在 /Swift/lib/classes/Swift/Transport/Esmtp/AuthHandler.php:171 中，未捕获的异常“Swift_TransportException”与消息“无法使用 2 个可能的身份验证器在用户名“email@somedomainwithgoogleapps.com”的 SMTP 服务器上进行身份验证

如果我将代码更改为使用 tls，例如：

```
$transporter = Swift_SmtpTransport::newInstance('smtp.gmail.com', 587, 'tls')...(rest is the same) 
```

我犯了同样的错误。如果我尝试将端口 465 与 tls 一起使用，则会出现连接超时。

如果我运行：

```
$sock = fsockopen('tls://smtp.gmail.com', 465, $errno, $errstr, 10); 
echo 'Socket is: '; 
var_dump($sock); 

echo 'Errors: ' . $errno . ' ' . $errstr; 
```

我明白了

```
Socket is: resource(2) of type (stream) Errors: 0 
```

附加信息：

```
var_dump(stream_get_transports()); 
```

返回：

> 数组（8）{[0]=>字符串（3）“tcp” [1](https://i.stack.imgur.com/LAjLr.png) =>字符串（3）“udp”[2]=>字符串（4）“unix”[3]=>字符串（3）“udg " [4]=> 字符串(3) "ssl" [5]=> 字符串(5) "sslv3" [6]=> 字符串(5) "sslv2" [7]=> 字符串(3) "tls" }

所以我有 ssl 和 tls 包装器......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T12:17:42.740

我认为你可以使用这个：

```
$transport = Swift_SmtpTransport::newInstance('smtp.googlemail.com', 465, "ssl") 
     ->setUsername('test@gmail.com') 
     ->setPassword('test'); 
```

--> smtp 使用 googlemail 而不是 gmail..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-16T03:51:30.503

您使用的密码应该是从您的“**应用程序专用密码**”生成的密码，而不是您的原始密码。

# java - Java 线程可以多次存活吗？

> ID：12310365
> 
> 赞同：4
> 
> 时间：2012-09-07T00:50:41.197
> 
> 标签：java, multithreading

好的....让我尽力解释一下....另外：这是我的世界中的一个mod。好的，所以我创建了一个线程对象

```
public static Thread KillThread = new Thread(); 
```

然后在我的主类的构造函数中，当游戏（我的工艺开始）我有

```
KillThread = new Thread(new KillAuraThread()); 
```

KillAuraThread 是线程类的名称。所以我现在创建了一个线程。是它让我生气的地方线程将运行恰好 1 秒，并且它不能运行多次，否则会破坏延迟和线程的点。

```
if(KillAura.enabled && !KillThread.isAlive())
    {
        System.out.println("Go AURA!");
        try
        {
            KillThread.start();
        }catch (Exception e)
        {
            e.printStackTrace();
        }
    } 
```

这被称为游戏中的每个滴答声，它将发送位置更新等。

现在这是我遇到问题的地方。一旦线程开始，它就变成“活动的”，当它结束时，它不再是“活动的”。但是线程只能启动一次吗？因为第一次运行后它不再工作？和想法？链接？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T00:53:27.017

是的，线程只能启动一次，不能重用线程对象。

> 多次启动一个线程是不合法的。特别是，线程一旦完成执行就可能不会重新启动。看[`java.lang.Thread.start()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.html#start%28%29)

不管这个事实如何，不要使用`Thread.State`for 线程生命周期管理。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-07T00:55:15.920

没错，线程只能运行一次，并且多次[启动/运行线程是非法的](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html#start%28%29)。您应该考虑使用`while`循环来保持线程处于活动状态。

而不是直接处理线程，您应该使用`java.util.concurrent`包内的类来定期安排固定任务，这显然是您想要做的。看看[`ThreadPoolExecutor`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ThreadPoolExecutor.html)。

# android - 平板电脑上的 Android 开发：Eclipse 会在 Windows 平板电脑上运行吗？

> ID：12310367
> 
> 赞同：4
> 
> 时间：2012-09-07T00:51:05.117
> 
> 标签：android, windows, tablet

Eclipse 和 android SDK 会在 Windows 平板电脑上运行吗？或者是否有任何其他设备可以像平板电脑一样便携（如索尼 vaio p 和索尼 vaio ux）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T00:58:40.937

[**AIDE**](https://play.google.com/store/apps/details?id=com.aide.ui&hl=en)可让您在 Android 上进行 Android 开发。它在大多数 Android 平板电脑上运行良好。

Eclipse在移植之前**不会**在 Windows RT 上运行，但平板电脑上的**Windows 8**可以轻松运行 eclipse（以及在 Windows 7 上运行的任何东西）。因此，您可以选择 Android 方式，也可以等待运行 Windows 8 的 Surface。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T01:12:16.763

是的，但这取决于平板电脑......主要特点

```
Toshiba WT200 Windows Tablet
10.1" LED-backlit capactive multi-touch display 
1366 x 768 Screen resolution
 Intel Atom N2600 1.6GHz processor
2GB DDR3 Memory
64GB Solid State Drive
3G and WiFi connectivity 
Windows 7 Professional 32bit 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-22T15:23:40.150

Windows RT 将只能运行通过 Windows 应用商店提供的应用程序，问题是 Eclipse 团队会为它创建一个版本吗？

**来自维基百科**

*只有使用 Windows 运行时（Metro 风格的应用程序）编写的软件才能在 Windows RT 上使用，Microsoft Office 2013 和 Internet Explorer 10 的桌面版本除外。开发人员将无法使用 Win32 创建在 Windows RT 上运行的应用程序蜜蜂*

在基于 Intel 的 CPU 架构 (Ivy-Bridge) 上运行的 Windows 8 Pro 应该运行 Eclipse 并与其他 Windows 应用程序完全向后兼容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T00:56:42.470

也许新的基于 Intel 的平板电脑（window 8）会运行 eclipse，或者我会得到一个 UltraBook！

# objective-c - xcode中的跨平台C++函数在windows、Linux和MAC OS中读取文件

> ID：12310368
> 
> 赞同：1
> 
> 时间：2012-09-07T00:51:17.997
> 
> 标签：objective-c

我有一个读取文件的 C++ 项目。我需要改进项目，使其还可以从 Mac Os 读取文件。我在 x-code 中创建了一个项目，到目前为止，我决定使用`#ifdef TARGET_OS_MAC`并`#import <Foundation/Foundation.h>`分离 windows 和 Mac 的代码。现在，当我在 main.cpp 文件中使用 NSString 编写 MAC-Read 文件的代码时，它不起作用，并且它给我的错误是它不知道 NSString。我尝试创建新的项目命令行和 Foundation 类型，但得到了同样的错误。如何将这两者结合起来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T01:20:36.483

你应该包括可可框架：

```
#import <Foundation/Foundation.h> 
```

# mysql - MySQL 循环遍历存储过程中的字段并在相同的结果集中返回

> ID：12310372
> 
> 赞同：-1
> 
> 时间：2012-09-07T00:51:51.593
> 
> 标签：mysql, stored-procedures

我正在尝试根据我指定为参数的任何数字在存储过程中循环选择结果集。

例子。

```
DELIMITER |
CREATE PROCEDURE Say_ma_name(IN number INT)
BEGIN
    DECLARE v_counter INT DEFAULT 0;
    DECLARE v_name CHAR;
    SELECT name INTO v_name FROM Table WHERE id = number; 
```

现在假设名称 SELECTED 是“Bob”。我想从这里生成一个返回的结果集：

```
 Bob, Bob, Bob 
```

我的脚本的其余部分如下所示：

```
 REPEAT
        SELECT CONCAT_WS(',',v_name);
        SET v_counter = V_counter + 1;
    UNTIL v_counter > number END REPEAT;
END |
DELIMITER ;

CALL Say_ma_name(1); 
```

对于那些关注的人，这将返回三（3）个单独的结果集，每个结果集都包含 Bob。我试图通过一个结果来实现这一切。问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T01:01:56.897

因此，您需要创建一个中间字符串值：

```
SET @result = '';
REPEAT
    SET @result = CONCAT(@result, ',');
    SET v_counter = V_counter + 1;
UNTIL v_counter > number END REPEAT;

SELECT TRIM(TRAILING ',' FROM @result); 
```

# ios - 字典中的块？

> ID：12310374
> 
> 赞同：6
> 
> 时间：2012-09-07T00:52:28.367
> 
> 标签：ios, cocoa-touch, websocket, objective-c-blocks, nsmutabledictionary

因此，我将块操作存储到 nsmutabledictionary 中，然后在 websocket 上返回响应时调用它们。这会将异步请求转换为块语法。这是精简的代码：

```
- (void)sendMessage:(NSString*)message responseAction:(void (^)(id))responseAction
{ 
    NSString *correlationID =  (NSString*)[[message JSONValue] objectForKey:@"correlationId"];

    [self.messageBlocks setObject:responseAction forKey:correlationID];

    NSLog(@"Sending message: %@", correlationID);
   [webSocket send:message];
}

- (void)webSocket:(SRWebSocket *)wsocket didReceiveMessage:(id)message;
{
    NSString *correlationID = (NSString*)[[message JSONValue] objectForKey:@"correlationId"];
    NSLog(@"Incoming message. CorrelationID: %@", correlationID);
    void (^action)(id) = nil;
    if (correlationID) {
        action = [messageBlocks objectForKey:correlationID];
        if (action) action([message JSONValue]);
        [messageBlocks removeObjectForKey:correlationID];
    }
} 
```

注意：服务器使用随请求发送的相关 ID 进行响应。因此，每个响应都通过该 ID 链接到每个请求。

这工作得很好，比我预期的要好。我的问题是，以这种方式运行块是否安全？正在调用 [messageBlocks removeObjectForKey:correlationID]；足以将其从内存中删除。我记得在 ARC 之前，block_release 是一个选项。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-07T00:58:37.570

您需要复制基于堆栈的块，以便将它们安全地存储在容器中。

```
[self.messageBlocks setObject:[responseAction copy] forKey:correlationID]; 
```

对于非 ARC 代码，您也需要`-autorelease`它。

```
[self.messageBlocks setObject:[[responseAction copy] autorelease] forKey:correlationID]; 
```

希望有帮助。

# php - RegEx 对这两种情况都使用一个？

> ID：12310377
> 
> 赞同：0
> 
> 时间：2012-09-07T00:53:09.917
> 
> 标签：php, regex, preg-match

好的，这是字符串

```
$string = "123456789_some_0.png"; 
```

我目前使用 preg_match 使用以下模式获取“123456789”：

```
$pattern = "/[0-9]*/i"; 
```

好吧，字符串有两种格式，我想为这种情况得出相同的结果：

```
$string = "1234-123456789_some_0.png"; 
```

并想出“12345789”并且仅从这两种情况下，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:00:43.457

假设您要捕获后跟下划线的所有数字，您可以使用以下命令：

```
$strings = array("1234-123456789_some_0.png", "123456789_some_0.png");
foreach ($strings as $string) {
  preg_match("/([0-9]+)_/", $string , $matches);
  echo $matches[1], PHP_EOL; // 123456789
} 
```

**[演示](http://ideone.com/cs9lt)**。

# r - R：在 sapply 中将变量名转换为字符串

> ID：12310378
> 
> 赞同：4
> 
> 时间：2012-09-07T00:53:15.273
> 
> 标签：r

我发现要将变量名转换为字符串，我会使用`deparse(substitute(x))`where `x`is my variable name。但是如果我想在一个 sapply 函数调用中这样做呢？

```
sapply( myDF, function(x) { hist( x, main=VariableNameAsString ) } ) 
```

当我使用 时`deparse(substitute(x))`，我得到类似`X[[1L]]`标题的东西。我想要实际的变量名。任何帮助，将不胜感激。

大卫

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-07T00:59:40.970

如果您需要名称，请遍历名称，而不是值：

```
sapply(names(myDF), function(nm) hist(myDF[[nm]], main=nm)) 
```

`mapply`或者，使用or同时遍历名称和值`Map`：

```
Map(function(name, values) hist(values, main=name),
    names(myDF), myDF) 
```

在大多数情况下，你不应该使用`deparse`并且`substitute`除非你正在做元编程（如果你不知道它是什么，你就没有这样做）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-25T21:25:35.227

这是一段对我有用的代码：

`deparse(substitute(variable))`

# iphone - 为安装 RestKit 添加 git 子模块错误

> ID：12310381
> 
> 赞同：1
> 
> 时间：2012-09-07T00:53:32.450
> 
> 标签：iphone, ios, git, restkit

我想为我的项目安装 RestKit，但是在第一步中，当我想使用终端添加 git 子模块时，它给了我这个错误：

```
command not found 
```

这是我输入的代码：

```
$ cd /path/to/MyApplication

$ git init
$ git submodule add git://github.com/RestKit/RestKit.git
$ open RestKit 
```

第一行代码有效，但是当我输入第二行时，它给了我错误，任何人都可以帮助我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T01:02:27.450

在最新版本的 XCode4 中，命令行工具（如 git）默认不安装。如果您进入“首选项”菜单，您可以从那里安装命令行实用程序。安装后您可能需要重新启动终端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T00:57:52.770

您应该首先为您的操作系统安装**git 。**

就像`apt-get install git`在 ubuntu 或`brew install git`OSX 中一样

# mysql - 为什么 HTTPD 打开的文件太多？

> ID：12310384
> 
> 赞同：1
> 
> 时间：2012-09-07T00:54:54.407
> 
> 标签：mysql, apache, io

我试图显示通过此命令打开了多少文件：

lsof | awk '{打印 $1" "$2}' | 唯一的-c | 排序 -n -r

这是结果：

```
 717 mysqld 1762
    188 httpd 5171
    185 httpd 5145
    184 httpd 5631
    184 httpd 5488
    184 httpd 5150
    184 httpd 3824
    184 httpd 3819
    184 httpd 3811
    184 httpd 3483
    184 httpd 3255
    184 httpd 3249
    184 httpd 3236
    184 httpd 3230
    183 httpd 5655
    183 httpd 5490
    183 httpd 5489
    183 httpd 5487
    183 httpd 5465
    183 httpd 5464
    183 httpd 5149
    183 httpd 4480
    183 httpd 4479
    183 httpd 4478
    183 httpd 4477
    183 httpd 4474
    183 httpd 4473
    183 httpd 4459
    183 httpd 3490
    183 httpd 3489
    183 httpd 3488
    183 httpd 3487
    183 httpd 3484
    183 httpd 3478
    183 httpd 3326
    183 httpd 3235
    183 httpd 3234
    183 httpd 3233
    183 httpd 3231
    183 httpd 3229
    183 httpd 10551
    183 httpd 10317
    183 httpd 10316
    183 httpd 10291
    182 httpd 10602
    182 httpd 10601
    182 httpd 10281
    174 httpd 5443
    174 httpd 3319
    174 httpd 10603
    174 httpd 10596
    174 httpd 10578
    174 httpd 10577
    174 httpd 10552
    174 httpd 10531
    173 httpd 10576
    173 httpd 10378
    173 httpd 10319
    173 httpd 10318
    171 httpd 3226
    137 master 1985
    118 dovecot 1854
     74 newrelic- 1880
     63 sshd 8631
     62 auth 11282
     57 fail2ban- 2107
     56 auth 11283
     49 qmgr 2007
     49 pickup 31235
     44 squid 2061
     44 memcached 1002
     41 sshd 1183
     37 squid 2059
     34 log 1857
     27 vsftpd 1206
     27 imap 7971
     24 anvil 1855
     22 config 11280
     20 rsyslogd 869
     20 init 1
     19 udevd 363
     19 crond 2042
     15 unlinkd 2063
     15 udevd 911
     15 udevd 910
     15 mysqld_sa 1246
     15 lsof 11502
     15 bash 8687
     13 acpid 895
     12 sort 11505
     12 awk 11503
     10 newrelic- 1879
     10 lsof 11506
     10 irqbalanc 884
      9 uniq 11504
      8 mingetty 2155
      3 xenwatch 23
      3 xenbus 24
      3 sync_supe 56
      3 netns 19
      3 migration 9
      3 migration 7
      3 migration 5
      3 migration 4
      3 kthreadd 2
      3 kswapd0 117
      3 kstriped 292
      3 ksoftirqd 8
      3 ksoftirqd 6
      3 ksoftirqd 3
      3 ksoftirqd 10
      3 ksnapd 296
      3 kseriod 68
      3 kjournald 318
      3 khvcd 136
      3 khelper 16
      3 kblockd/3 63
      3 kblockd/2 62
      3 kblockd/1 61
      3 kblockd/0 60
      3 kauditd 570
      3 flush-202 725
      3 events/3 14
      3 events/2 13
      3 events/1 12
      3 events/0 11
      3 crypto/3 125
      3 crypto/2 124
      3 crypto/1 123
      3 crypto/0 122
      3 cpuset 15
      3 bdi-defau 58
      3 async/mgr 20
      3 aio/3 121
      3 aio/2 120
      3 aio/1 119
      3 aio/0 118
      1 COMMAND PID 
```

伙计们，你能告诉我为什么 Apache 会打开这么多文件吗？我在 httpd.conf 禁用了 access_log 指令，但这对我没有帮助。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:02:05.610

如果您查看实际结果 ( `lsof|grep httpd`)，您将看到每个父进程都有打开的每个已加载模块的句柄，因此您的模块（例如 mod_rewrite）将位于打开文件列表中。

每个进程还将有一个文件句柄，`error_log`运行 httpd 或任何模块所需的 lib 文件，以及每个进程至少一个用于 IPC 的管道。

如果您提供大量静态文件并且您的站点很繁忙，那么您很可能会看到其中一些文件也打开了。

真的，这些都不是什么大问题。请记住，您运行的服务器进程越多，打开的文件就越多，因为每个父进程将打开许多相同的文件（特别是模块和日志文件）。

# ruby - 扩展方法不是“Ruby 方式”吗？

> ID：12310387
> 
> 赞同：4
> 
> 时间：2012-09-07T00:55:08.857
> 
> 标签：ruby, methods, coding-style, refactoring, extension-methods

在 C# 中工作时，我发现创建扩展方法非常方便。在 Ruby 中，可能看起来像：

```
class Fixnum
  is_divisible? divisor
    self % divisor == 0
  end
end 
```

但我没有看到人们以这种方式扩展内置类型。

非扩展方式是：

```
def is_divisible? dividend, divisor
  dividend % divisor == 0
end 
```

在我看来，第二种方式更难阅读 ( `is_divisible?(i, 5)`) 与`i.is_divisible? 5`. 甚至，`i.is_divisible_by? 5`.

有没有更雄辩的 Ruby 风格的方式来做这种事情？还是第一种方法是首选方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T03:16:33.543

虽然这是一个微不足道的例子，但猴子补丁通常很好。最好将方法放在类的命名空间中，而不是在茫茫荒野中四处游荡。

请记住，如果您正在编写 gem 或您打算其他人使用的东西，您的猴子补丁有可能干扰*他们的*猴子补丁。

对于像这样的简单情况，为了安全起见，最好避免它。

# svg - 为svg中的一个'set'元素设置多个'begin'属性

> ID：12310394
> 
> 赞同：0
> 
> 时间：2012-09-07T00:55:55.717
> 
> 标签：svg, mouseover, onmouseover

我目前正在创建一个交互式 SVG 世界地图，左边是世界语言列表，右边是地图。当用户将鼠标悬停在语言名称上时，使用该语言的国家/地区会更改其填充值。这很好用，直到我到达印度，那里我说旁遮普语、古吉拉特语和印地语。基本代码是这样工作的：

```
<g id="RussianL">

<path id="russia" d="blah blah blah" />

<set attributeName="fill" to="#CC3232" begin="Russian.mouseover" end="Russian.mouseout" />

</g> 
```

...其中 'Russian' 是与左侧菜单中的单词 'russian' 对应的文本对象。我可以使用相同的策略来代表印度的语言（其中 3 种需要出现在这张地图上）吗？我尝试只添加三个“开始”属性，但这导致它们都不起作用（至少在我最新的 Chrome 和 Firefox 中）。

那么，有没有办法使用内联代码来做到这一点，或者我需要使用 javascript/jquery，还是我只是使用了错误的文件类型来完成我希望完成的任务？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T06:42:05.980

您想要多个集合元素，每个元素都有自己的开始/结束。

```
<set attributeName="fill" to="blue" begin="Punjabi.mouseover" end="Punjabi.mouseout" />
<set attributeName="fill" to="orange" begin="Gujarati.mouseover" end="Gujarati.mouseout" />
<set attributeName="fill" to="pink" begin="Hindi.mouseover" end="Hindi.mouseout" /> 
```

# .net - COMException 未触发 AppDomain.UnhandledException 事件

> ID：12310395
> 
> 赞同：1
> 
> 时间：2012-09-07T00:56:20.930
> 
> 标签：.net, exception-handling, dao, unhandled-exception, comexception

我有一个控制台应用程序，其代码如下所示（简化）：

```
public static void Main(string[] args)
{
  AppDomain.CurrentDomain.UnhandledException += UnhandledExceptionTrapper;

  InsertRow();
}

private static void InsertRow();
{
  DAO.DBEngine dbEngine = new DAO.DBEngine();
  DAO.Database db = dbEngine.OpenDatabase("database_name");
  DAO.Recordset rs = db.OpenRecordset("table_name");
  DAO.Field myField = new DAO.Field();
  rs.AddNew();
  // System.Runtime.InteropServices.COMException occurs here, but only in the IDE Debugger:
  myField.Value = "oops, this value is bigger than the size of the column";
  rs.Close();
  db.Close();
}

private static void UnhandledExceptionTrapper(object sender, UnhandledExceptionEventArgs e)
{
  // Log error
  Environment.Exit(1);
} 
```

**为什么[COMException](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.comexception.aspx)不触发[UnhandledException](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)事件？**

在我的真实代码中，DAO 的东西在一个单独的类中。我尝试`catch`了 COMException 并再次抛出它，如下所示：

```
private static void InsertRow();
{
  try
  {
    ... // See code above
    myField.Value = "oops, this value is bigger than the size of the column";
  }
  catch (System.Runtime.InteropServices.COMException ex)
  {
    throw new Exception(ex.Message, ex.InnerException);
  }
  finally
  {
    rs.Close();
    db.Close();
  }
} 
```

然而，这也没有奏效。 **我不明白什么？**

顺便说一句，这确实有效，但我不想这样做：

```
 catch (System.Runtime.InteropServices.COMException ex)
  {
    // Log error
    Environment.Exit(1);
  } 
```

*让风滚草开始吧！*

# html - 使用 CSS 在我的 div 标签内移动表格

> ID：12310396
> 
> 赞同：0
> 
> 时间：2012-09-07T00:56:24.533
> 
> 标签：html, css, html-table

我的网页被 CSS 屏蔽了，这就是我遇到的问题，我只想将 URL 表移动到“正确”div 标签内更居中和更低的位置。颜色仅用于区分字段。忽略 img 链接。

这是 html 代码（对于这个作业，我不能使用 CSS 和 HTML 以外的任何东西。这段代码下面是 CSS 文件。

**代码：**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Town of Oz Info</title>
        <meta name="Zachary" content="Zachary Maltais" />
        <link rel="stylesheet" type="text/css" href="oz.css" />
        <!-- Date: 2012-09-05 -->
    </head>
    <body>

        <!--Using a div based layout to position things on the page -->

        <div id="header">
            <!-- header code goes here -->

            <h1 id="welcome">Welcome to Town of Oz</h1>

        </div>

        <div id="content">
            <!-- All main content go here -->

        </div>

        <div id="right">
            <!-- right side of screen code goes here -->

            <!-- Table for navigation -->
            <table id="navigation">
                <tr>
                    <th><img src="images/arrow.gif"></th>
                    <th><a href="home.html">Home</a></th>
                </tr>
                <tr>
                    <th><img src="images/arrow.gif"></th>
                    <th><a href="events.html">Events</a></th>
                </tr>
                <tr>
                    <th><img src="images/arrow.gif"></th>
                    <th><a href="directions.html">Directions</a></th>
                </tr>
                <tr>
                    <th><img src="images/arrow.gif"></th>
                    <th><a href="weather.html">Weather</a></th>
                </tr>
                <tr>
                    <th><img src="images/arrow.gif"></th>
                    <th><a href="wizards.html">Wizards</a></th>
                </tr>
            </table>

        </div>

        <div id="left">
            <!-- left side of screen code goes here -->
        </div>

        <div id="footer">
            <!-- footer code goes here-->

        </div>

    </body>

</html> 
```

这是CSS：

```
body {
    margin: 0px;
    padding: 0px;
}
#page {
    max-width: 950px;
    max-height: 720px;
}

#header {
    background: #ff9999;
    position: absolute;
    width: 950px;
    height: 100px;
    left: 0px;
    top: 0px;
}
#content {
    background: #9999ff;
    position: absolute;
    top: 100px;
    left: 200px;
    width: 750px;
    height: 550px;
}

#right {
    background: #ffff99;
    position: absolute;
    top: 100px;
    height: 550px;
    width: 200px;
    margin: 0px;
    padding: 0px;
}

#footer {
    background: #99ff99;
    position: absolute;
    top: 650px;
    width: 950px;
    height: 70px;
}

#navigation {
    position:absolute;
    top:200;
    left:50;
    border:dotted;
    border-color: black; 
}
#welcome {
    text-align: center;
    color: blue;
    font-style: oblique;
    font-size: 250%;
    font-family: "Perpetua";
    font-weight: bold;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:14:18.200

**试试这个**，我对#navigation 的 ccs 几乎没有什么改动

```
#navigation {
    border:dotted;
    border-color: black;
    margin: 0px auto;
    position: relative;
    top: 50px;
} 
```

如果您想放下它，只需更改最高值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T01:21:41.030

您可以为 css 添加此规则

```
#right table{margin: 20px;} 
```

# php - 打开图表操作未出现在股票代码上

> ID：12310398
> 
> 赞同：1
> 
> 时间：2012-09-07T00:56:36.977
> 
> 标签：php, facebook-graph-api

我发布了一个图表操作，我收到了一个活动 ID——这意味着 api 调用成功。但该动作不会出现在股票行情上。我可以在我的活动日志中看到它，但我认为没有其他人可以看到它，因为我必须点击“在时间轴上显示”才能让它出现。我不想让它出现在时间轴上，只要代码就足够了。

# java - Android 在使用 copyPixelsToBuffer 时如何应用 alpha 通道？

> ID：12310400
> 
> 赞同：2
> 
> 时间：2012-09-07T00:56:59.933
> 
> 标签：java, android, algorithm, colors, buffer

相关主题（尚无解决方案）：[访问 ARGB_8888 Android Bitmap 中的原始数据](https://stackoverflow.com/questions/5010545/access-to-raw-data-in-argb-8888-android-bitmap)

简而言之：使用`copyPixelFromBuffer`and时`copyPixelsToBuffer`，Android 已经在 RGB 通道上应用了 Alpha 通道。

我需要将其转换为原始 ARGB 值，反之亦然。我不知道Android如何应用它。你能告诉我公式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T12:34:04.607

Android 以 alpha 预乘形式存储位图数据。换句话说，在复制数据时不应用 alpha 值，它一直都在应用。

要转换为预乘形式，请将颜色分量与归一化的 alpha 值相乘，如下所示：

```
redPremultiplied   = red   * normalizedAlpha
greenPremultiplied = green * normalizedAlpha
bluePremultiplied  = blue  * normalizedAlpha
alphaPremultiplied = alpha 
```

在哪里

```
red             = <value between 0 and 255>
green           = <value between 0 and 255>
blue            = <value between 0 and 255>
alpha           = <value between 0 and 255>
normalizedAlpha = alpha / 255 
```

要将预乘 alpha 转换为规范形式，请将预乘分量与归一化 alpha 相除：

```
red   = redPremultiplied   / normalizedAlpha
green = greenPremultiplied / normalizedAlpha
blue  = bluePremultiplied  / normalizedAlpha
alpha = alphaPremultiplied 
```

但一定要注意 normalizedAlpha = 0！`Bitmap.copyPixelsToBuffer()`您应该注意，尽管理论上处理的数据`Bitmap.copyPixelsFromBuffer()`可以是任何格式。使用`Bitmap.getPixels()`and更安全`Bitmap.setPixels()`，因为 API 保证了这些函数处理的数据格式。特别是，您不必担心预乘和取消预乘 alpha，因为这些函数会为您处理。

# c# - await Task.Delay 似乎不起作用

> ID：12310403
> 
> 赞同：1
> 
> 时间：2012-09-07T00:57:25.890
> 
> 标签：c#, .net-4.5, async-await

我想我错过了一些东西，但我似乎无法等待在 .net 4.5 中工作

有谁知道这里的正确语法？我所看到的所有地方似乎都在使用我所拥有的。（请参阅[正确使用 Task.Delay 来延迟按键](https://stackoverflow.com/questions/11572559/proper-use-of-task-delay-to-delay-key-presses)）

![在此处输入图像描述](../Images/92a7f885322a5615af1db4b636eca26b.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T01:09:51.057

看起来您正试图从 lambda 调用异步方法。你可能`async`一开始就错过了。例如”

```
SomeMethod(async () =>
    {
        //...
        await Task.Delay(1000, cancellationToken);
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T01:02:18.113

您需要`async`使用您的方法……包含您的代码块的方法。

*   [Task.Start/Wait 和 Async/Await 有什么区别？](https://stackoverflow.com/questions/9519414/whats-the-difference-between-task-start-wait-and-async-await)

*   [http://www.itwriting.com/blog/4913-a-simple-example-of-async-and-await-in-c-5.html](http://www.itwriting.com/blog/4913-a-simple-example-of-async-and-await-in-c-5.html)

*   [http://msdn.microsoft.com/en-us/library/hh191443.aspx](http://msdn.microsoft.com/en-us/library/hh191443.aspx)

# java - 将使用 GridBagLayout 的组件全屏显示

> ID：12310406
> 
> 赞同：2
> 
> 时间：2012-09-07T00:58:03.047
> 
> 标签：java, swing, awt, layout-manager, gridbaglayout

我的问题是我想为我的项目制作更复杂的（对我而言）图形界面。首先，我使用以下代码使用全屏模式：

```
public class MainFrame extends JFrame
{
...
private Container container;
private GridBagLayout gbl;

public MainFrame()
{
GraphicsEnvironment env = GraphicsEnvironment.getLocalGraphicsEnvironment();
GraphicsDevice dev = env.getDefaultScreenDevice();
dev.setFullScreenWindow(this);
setLayoutManager();
}
...
} 
```

一切都很好。我要做的下一步是添加两个 JPanel。我想使用的布局管理器是 GridBagLayout。

```
private void setLayoutManager()
{
container = getContentPane();
gbl = new GridBagLayout();
container.setLayout(gbl);
}

private void addMenu()
{
MenuBar menu = new MenuBar();
GridBagConstraints gbc = new GridBagConstraints();
gbc.fill = GridBagConstraints.BOTH;
gbc.ipady = 0;
gbc.gridx = 0;
gbc.gridy = 0;
gbc.weightx = 1.0;
gbc.weighty = 0.05;
gbl.setConstraints(menu, gbc);
container.add(menu);
}

private void addWorkArea()
{
WorkArea area = new WorkArea();
GridBagConstraints gbc = new GridBagConstraints();
gbc.fill = GridBagConstraints.BOTH;
gbc.gridx = 0;
gbc.gridy = 1;
gbc.weightx = 1.0;
gbc.weighty = 1.0;
gbl.setConstraints(area, gbc);
container.add(area);
} 
```

结果看起来像这样：

![在此处输入图像描述](../Images/353972131f4f953e3e53b95ae29653c2.png)

这是[我的项目](http://speedy.sh/vg9WB/Program.rar)：

为什么上面有条？

更重要的是，当我单击并拖动时，所有应用程序都在移动。请帮我。对我来说，填补所有空间摆脱 JFrame 移动很重要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T01:55:16.127

当我告诉你问题出在哪里时，你会笑的...

无论出于何种原因，Java 在布局内容时都允许插入框架。也就是说，它仍然认为有标题栏和框架边框。

虽然修复非常复杂......

在您的`MainFrame`构造函数中，您需要`setUndecorated(true)`在执行任何其他操作之前调用...

```
public MainFrame() {
    setUndecorated(true); // <-- Add me
    setFullScreen();
    setResizable(false);
    setTitle("Program");
    setLayoutManager();
    addMenu();
    addWorkArea();
} 
```

我知道，非常复杂（插入讽刺：P - 说真的，当它起作用时我自己都感到惊讶）

# vb.net - 覆盖公共只读属性

> ID：12310415
> 
> 赞同：1
> 
> 时间：2012-09-07T01:00:08.420
> 
> 标签：vb.net

就在睡觉前，有点脑子放屁。但是我需要将`ReadOnly Property`一个名称从一个名称重新映射到我想要的指定名称。

我想我能做到

```
Public Readonly Property DocName as String
  Get
    Return Mybase.Name
  End Get
End Property 
```

是的，我正在尝试重新映射 XMLDocument 对象的名称属性。只是想确保只要我声明此属性然后键入：

```
Public Overrides ReadOnly Property Name As String
    Get
        Return SomeValue
    End Get
End Property 
```

我会好多哥吗？我知道我会收到`method has multiple definitions with identical signatures`消息，这使我想到了第二个问题：

如何防止`Multiple Signatures`这种类型的声明弹出错误消息？

除非我缺少这种类型的覆盖的一些声明属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T01:11:00.313

您可以使用[阴影](http://msdn.microsoft.com/en-us/library/1h3wytf6%28v=vs.100%29.aspx)来完成此操作：

```
Public Class A
    Public ReadOnly Property Name As String
        Get
            Return "Name"
        End Get
    End Property
End Class

Public Class B
    Inherits A

    Public ReadOnly Property DocName As String
        Get
            Return MyBase.Name
        End Get
    End Property

    Public Shadows ReadOnly Property Name As String
        Get
            Return "SomeValue"
        End Get
    End Property

End Class 
```

# android - Android：动态加载布局文件

> ID：12310418
> 
> 赞同：0
> 
> 时间：2012-09-07T01:00:23.453
> 
> 标签：android, xml, layout, dynamic

我有一个关于安卓的问题。假设我们有我们的主要 xml 布局文件，并通过使用（例如）FrameLayout 来定义一个占位符。还假设我们有 2 个其他 xml 布局文件显示任何内容。所以我想要做的是以编程方式将两种布局之一动态地注入到占位符中。我知道存在 Activitis、Fragments、ViewFlipper 等概念。但我觉得做这样的事情很舒服：

```
public class MainActivity extends Activity {

private FrameLayout placeHolder;
private View view1;
private View view2;

private RelativeLayout canvasPlaceHolder;
private PuzzleCanvas canvas;
private TextView infoLabel;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // init gui
    setContentView(R.layout.activity_main);

    // Load layouts from xml
    LayoutInflater factory = getLayoutInflater();
    view1 = factory.inflate(R.layout.view1, null);
    view2 = factory.inflate(R.layout.view2, null);

}
} 
```

例如，屏幕上的按钮执行如下操作：

```
@Override
public void onClick(View v) {
    placeHolder.removeView(view1);
    placeHolder.addView(view2);
} 
```

例如显示 loadingAnimation (view2) 而不是普通内容 (view1)，因此我可以在 xml 中定义舒适和独立的视图。

LayoutInflater 的使用值得称道吗？性能和内存管理呢？你怎么看待这件事？这是Android中的常见方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:21:15.607

在 xml 的框架布局上使用 'include' 标记以将您的 xml 包含在主 xml 中。您所要做的就是根据您的应用程序逻辑通过 java 切换他们的“可见性”。例如：在侦听器上，设置：

```
public void onClick(View v) {          
    innerView1.setVisibilty(View.INVISIBLE); 
    innerView2\. setVisibilty(View.VISIBLE);  
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T03:23:49.033

> // 从 xml 加载布局 LayoutInflater factory = getLayoutInflater();
> 
> ```
> view1 = factory.inflate(R.layout.view1, null);
> view2 = factory.inflate(R.layout.view2, null); 
> ```

使用 LayoutInflater 是可以的，但我建议不要直接在 onCreate 中执行此操作，如果您的布局非常复杂，可能会导致 ANR（绘制布局超过 5 秒）。由于这两个视图仅在用户反应后出现，我更喜欢使用 sendEmptyMessage 和处理程序。

```
onCreate(...){
    handler.sendEmptyMessage(1);
}

private Handler handler = new Handler(){
    @Override
    public void handleMessage(final Message msgs) {
        if(msgs.what == 1){
            view1 = factory.inflate(R.layout.view1, null);
            view2 = factory.inflate(R.layout.view2, null);
        }
    }
} 
```

# javascript - 如何检测滚动事件是否像在触摸设备上一样*仅触发一次*？

> ID：12310419
> 
> 赞同：3
> 
> 时间：2012-09-07T01:00:39.640
> 
> 标签：javascript, iphone, ios, ipad, touch

iOS 设备（可能还有 Android 设备）具有不同的滚动行为：该`scroll`事件仅在整个滚动完成后触发**一次。**

如何检测浏览器是否以这种方式运行？

我可以使用`window.Touch`或者`Modernizr.touch`但他们没有告诉我有关滚动行为的任何信息，这就像问某人是否是法国人以了解​​他们是否喜欢羊角面包，对吧？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:38:25.260

我认为您对检测是正确的，因为有些设备将同时支持触摸和鼠标行为（如 Windows 8 平板电脑），有些仅支持触摸（手机），有些仅支持鼠标（台式机）。正因为如此，我认为您不能肯定地说设备只有一种行为，因为有些设备可能同时具有两种行为。

假设你真正想做的是弄清楚你是否应该立即响应每个滚动事件，或者是否应该使用短暂的延迟来查看滚动目标的最终位置，那么你可以编写一个可以工作的混合效果无论哪种情况都很好。

```
var lastScroll = new Date();
var scrollTimer;
window.onscroll = function(e) {

    function doScroll(e) {
        // your scroll logic here
    }

    // clear any pending timer
    if (scrollTimer) {
        clearTimeout(scrollTimer);
        scrollTimer = null;
    }

    var now = new Date();
    // see if we are getting repeated scroll events
    if (now - lastScroll < 500){
        scrollTimer = setTimeout(function() {
            scrollTimer = null;
            doScroll(e);
        }, 1000);
    } else {
        // last scroll event was awhile ago, so process the first one we get
        doScroll(e);
    }
    lastScroll = now;
}; 
```

`doScroll()`将是您的滚动处理逻辑。

这为您提供了一种混合方法。它总是在最近没有滚动事件时到达的第一个滚动事件上触发。如果有一系列滚动事件，那么它会在第一个事件上触发，然后等待它们停止一秒钟。

您可能需要调整两个数字。第一个确定滚动事件必须有多接近才能考虑从相同的用户操作（当前设置为 500 毫秒）快速触发。第二个确定您等待多长时间，直到您处理当前滚动位置并假设用户停止移动滚动条（当前设置为 1s）。

# html - 加载图片时显示的漂亮照片 alt

> ID：12310423
> 
> 赞同：0
> 
> 时间：2012-09-07T01:00:50.443
> 
> 标签：html, image, prettyphoto, alt

我第一次使用漂亮的照片，非常好的工具。我想知道是否有更多人有这个问题。这并不重要，但我讨厌不做事情，因为我不理解它们。这是代码：

```
<div class="single_left">
    <a href="_img/examples/image-1.jpg" rel="prettyPhoto[gal1]" title="it works"><img src="_img/examples/thumb-1_50.jpg" alt="WHATEVER INFO" /></a>
</div> 
```

它完美地工作。但我有一个疑问。如果您查看所有代码，您会发现它非常简单。它是一个div，里面有一个`<a>`，里面有一个`<img>`thats作为缩略图。任何`<img>`你都需要添加一个 alt="" 属性。这个属性的想法是，如果某人的互联网速度很慢或图像无法加载，则会以文本格式显示一个小的描述，这将是 alt="" 的内容。在这种情况下，“WHATEVER INFO”（检查上面的代码）。因此，如果显示图像，则不应显示此替代文本。

好的...清楚

问题是，如果通过点击放大图片，使用 prettyphoto，您可以在 prettyphoto 框架的顶部看到 alt="" 文本。所以在这种情况下会显示 WHATEVER INFO。这不是它的目的，当然会破坏任何设计计划。

有谁知道为什么会这样？？

有没有办法解决这个问题，所以我可以放一些替代文字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:13:48.033

根据[这个链接](http://www.kriesi.at/support/topic/hide-title-and-alt-text-on-pretty-photo-gallery-images)，添加这个 CSS 代码`css/custom.css`来做你想做的事：

```
div.ppt, .pp_description {
    display: none !important;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T22:10:44.627

我可以让你知道我的问题的答案是这样的：

```
div.ppt {
    display: none !important;
} 
```

这将使 alt 值不显示。

我不知道的是，如果 alt 可以正常工作，图片是否未加载...至少您知道如何将其取出。

问候！！

# facebook-javascript-sdk - Facebook 客户端身份验证示例 - 添加范围

> ID：12310426
> 
> 赞同：0
> 
> 时间：2012-09-07T01:01:21.310
> 
> 标签：facebook-javascript-sdk

我正在使用 Facebook JS SDK 进行客户端身份验证，每个示例位于[此处](http://developers.facebook.com/docs/authentication/client-side/)

```
<!DOCTYPE html>
<html>
  <head>
    <title>Facebook Client-side Authentication Example</title>
  </head>
  <body>
    <div id="fb-root"></div>
    <script>
      // Load the SDK Asynchronously
      (function(d){
         var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement('script'); js.id = id; js.async = true;
         js.src = "//connect.facebook.net/en_US/all.js";
         ref.parentNode.insertBefore(js, ref);
       }(document));

      // Init the SDK upon load
      window.fbAsyncInit = function() {
        FB.init({
          appId      : 'YOUR_APP_ID', // App ID
          channelUrl : '//'+window.location.hostname+'/channel', // Path to your Channel File
          status     : true, // check login status
          cookie     : true, // enable cookies to allow the server to access the session
          xfbml      : true  // parse XFBML
        });

        // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
              if (me.name) {
                document.getElementById('auth-displayname').innerHTML = me.name;
              }
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        document.getElementById('auth-loginlink').addEventListener('click', function(){
          FB.login();
        });
        document.getElementById('auth-logoutlink').addEventListener('click', function(){
          FB.logout();
        }); 
      } 
    </script>

    <h1>Facebook Client-side Authentication Example</h1>
      <div id="auth-status">
        <div id="auth-loggedout">
          <a href="#" id="auth-loginlink">Login</a>
        </div>
        <div id="auth-loggedin" style="display:none">
          Hi, <span id="auth-displayname"></span>  
        (<a href="#" id="auth-logoutlink">logout</a>)
      </div>
    </div>

  </body>
</html> 
```

我在胡闹中无法弄清楚的是如何在此代码中添加范围参数以请求访问电子邮件地址。谁能指出我正确的方向？

谢谢！

- - 编辑 - -

我在文档中看到了这段代码

```
FB.login(function(response) {
   // handle the response
 }, {scope: 'email'}); 
```

我想我不确定如何将其合并到现有代码中，因为它不起作用

```
document.getElementById('auth-loginlink').addEventListener('click', function(){
              FB.login();
            }); 
```

如果有人可以更新上述行以合并额外的范围参数，我很想尝试一下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:04:07.590

为您提供简单的解决方案。只需将这些参数添加到`FB.login()`函数中。

```
 FB.login(function(){}, {scope: 'email'}); 
```

如果您不需要处理登录响应，则只需提供一个空函数。

# android - LinearLayout(linearLayout) 如何在我的课堂上可见？

> ID：12310431
> 
> 赞同：0
> 
> 时间：2012-09-07T01:02:04.833
> 
> 标签：android

我有两个类，“XMLParser.java”扩展了活动并导入了“ClassAsyncTask.java”（来自我自己的库）。现在我的 XMLParser 有问题，它说线性布局不可见，我该如何解决这个错误？谢谢

```
public class XMLParser extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    ClassAsyncTask aObj = new ClassAsyncTask(
            "http://www.androidpeople.com/wp-content/uploads/2010/06/example.xml", this);
    aObj.execute();

    //THIS IS MY PROBLEM, "The field ClassAsyncTask.linearLayout is not visible"
    aObj.linearLayout = new LinearLayout(this);
    aObj.linearLayout.setOrientation(1);

    /* Set the ContentView to layout for display */
    this.setContentView(aObj.linearLayout);

}

} 
```

这是由 XMLParser.java 导入的 ClassAsyncTask.java（来自我自己的库）

```
public class ClassAsyncTask extends AsyncTask<String, Void, String> {

String targetURL;
TextView name[], website[], category[];
LinearLayout linearLayout;
Context context;

public ClassAsyncTask(String site, Context ctx){
    targetURL = site;
    context = ctx;
}

@Override
protected String doInBackground(String... urls) {

    try {

        /* Handling XML */
        SAXParserFactory spf = SAXParserFactory.newInstance();
        SAXParser sp = spf.newSAXParser();
        XMLReader xr = sp.getXMLReader();

        /* Send URL to parse XML Tags */
        URL sourceUrl = new URL(targetURL);

        /* Create handler to handle XML Tags ( extends DefaultHandler ) */
        MyXMLHandler myXMLHandler = new MyXMLHandler();
        xr.setContentHandler(myXMLHandler);
        xr.parse(new InputSource(sourceUrl.openStream()));

    } catch (Exception e) {
        System.out.println("XML Pasing Excpetion = " + e);
    }
    return null;
}

/* Return-value from doInBackground */
protected void onPostExecute(String result) {

    /* Get result from MyXMLHandler SitlesList Object */
    SiteList sitesList = MyXMLHandler.sitesList;

    /* Assign TextView array length by arrayList size */
    name = new TextView[sitesList.getName().size()];
    website = new TextView[sitesList.getName().size()];
    category = new TextView[sitesList.getName().size()];

    int h = sitesList.getName().size();
    /* Set the result text in TextView and add it to layout */
    for (int i = 0; i < h; i++) {

        name[i]= new TextView(getApplicationContext());
        name[i].setText("Name = " + sitesList.getName().get(i));
        website[i]= new TextView(getApplicationContext());
        website[i].setText("Website = " + sitesList.getWebsite().get(i));
        category[i]= new TextView(getApplicationContext());
        category[i].setText("Website Category = " + sitesList.getCategory().get(i));
        linearLayout.addView(name[i]);
        linearLayout.addView(website[i]);
        linearLayout.addView(category[i]);

    }
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T01:43:32.547

我建议您不要`LinearLayout`以这种方式访问​​，而是为其设置 setter 和 getter。

在你的`ClassAsyncTask.java`

```
LinearLayout linearLayout;

public void setLinearLayout(LinearLayout linearLayout){
    this.linearLayout = linearLayout;
}

public LinearLayout getLinearLayout(){
    return linearLayout;
} 
```

然后在您的 中`XMLParser.java`，只需`LinearLayout myLinearLayout = aobj.getLinearLayout()`对布局进行您想要的编辑，然后将其返回到`ClassAsyncTask`via `aobj.setLinearLayout(myLinearLayout)`。

# javascript - 在 JavaScript Windows 8 应用程序中设置桌面壁纸

> ID：12310433
> 
> 赞同：1
> 
> 时间：2012-09-07T01:02:19.113
> 
> 标签：javascript, windows-8, desktop-wallpaper

有没有办法从用 JavaScript 编写的 Windows 8 应用程序设置桌面壁纸？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:15:59.080

不，这是不可能的。

您唯一的选择是将图像写入用户图片库（请参阅[此处](https://stackoverflow.com/questions/12225951/how-to-save-html5-canvas-as-an-image-file-in-window-8-metro-app/12230195#12230195)），然后允许用户选择它作为他们的桌面壁纸。

# iphone - Segue 不适用于动态添加的子视图

> ID：12310434
> 
> 赞同：0
> 
> 时间：2012-09-07T01:02:26.803
> 
> 标签：iphone, ios, cocoa, ios5

我有一个带有视图 A 的故事板，它位于导航控制器内。我动态地将子视图 B 添加到视图 A。子视图 B 有一个表格视图，而表格视图单元格有一个到详细视图的序列（推送）。当我单击单元格时，将调用 prepareForSegue 方法，但从不显示详细视图。如果我将序列切换到模态，则详细视图将显示在视图 A 中，子视图 B 所在的位置。

我想要发生的事情是将详细视图推送到导航控制器上，当用户返回详细视图时，它会返回视图 A，并嵌入子视图 B。

下面是我用于添加子视图的代码：

```
if(!self.homeViewController){
         self.homeViewController = [self.storyboardinstantiateViewControllerWithIdentifier:@"HomeView"];        
    }

    if(self.currentViewController != self.homeViewController)
    {            
        [self.view insertSubview:self.homeViewController.view belowSubview:self.tabBar];
        [self.currentViewController removeFromParentViewController];
    }

    self.currentViewController = self.homeViewController; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T05:08:55.173

如果没有看到您的代码（和情节提要），这可能很难诊断。然而，我发现有时让 segues 与动态加载的内容一起正常工作是一件苦差事。在某些情况下，我发现使用 UINavigationController 的 pushViewController:animated: 和 popViewController:animated 方法可能是更好的方法。您应该能够通过 UIViewcontroller.navigationController 访问 UINavigationController。

# jquery - 从 jquery 调用 MVC 操作并处理重定向或返回的部分视图

> ID：12310437
> 
> 赞同：3
> 
> 时间：2012-09-07T01:03:25.037
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-3

我想调用我的操作并让该操作返回直接呈现到视图上的结果部分视图，或者让操作重定向到服务器上的另一个页面。

但是，当我通过 jQuery 执行此操作时，它似乎将重定向的页面加载到我的目标 div 元素中，而不是干净地重定向并有效地重新加载页面/站点。

jQuery 调用：

```
$.ajax({
     type: "GET",
     url: "Myurl",
     dataType: "html",
     success: function (data) {
         // replace the context of the section with the returned partial view
         $('#upload_section').html(data);
     }
 }); 
```

MVC 动作示例

```
public ActionResult MyAction() 
{
   bool doRedirect = // some code to determine this condition
   if (doRedirect)
   {
      return RedirectToAction("MyAction", "Home");
   }
   else
   {
      // return the partial view to be shown
      return PartialView("_UploadSessionRow");
   }
} 
```

我做这一切都错了吗？有没有更好的实践方法来做到这一点？这样做的需要将出现在其他操作和 jQuery 请求中，所以我正在寻找一种通用方法来解决这个问题。

更新：感谢 Andrews 的回答，我得到了我所追求的东西，按照他的建议对我的 ajax 进行了一些修改。最终的ajax是：

```
function loadOrRedirect(options) {

    var jData = null;

    try {    
        if (options.data) {
            jData = $.parseJSON(options.data);

            if (jData.RedirectUrl) {
                window.location = jData.RedirectUrl;
            }
        }
    } catch (e) {
        // not json
    }

    if (!jData && options.callback) {
        options.callback(options.data);
    }
};

$.ajax({
     type: "GET",
     url: "Myurl",
     dataType: "html",
     success: function (data) {
         loadOrRedirect(
                       {
                          data: data,
                          callback: function (html) {
                                    replaceRow.replaceWith(html);
                                    alternateRowHighlighting();
                       }
         });
} 
```

});

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-07T01:08:13.170

您不能从 AJAX 请求重定向。您将不得不从 JavaScript 进行重定向。我会推荐这样的东西：

```
public ActionResult MyAction() 
{
   bool doRedirect = // some code to determine this condition
   if (doRedirect)
   {
      return Json(new 
      {
          RedirectUrl = Url.Action("MyAction", "Home")
      });
   }
   else
   {
      // return the partial view to be shown
      return PartialView("_UploadSessionRow");
   }
} 
```

然后在 JavaScript 方面：

```
$.ajax({
     type: "GET",
     url: "Myurl",
     dataType: "html",
     success: function (data) {
         if (data.RedirectUrl) {
             window.location = data.RedirectUrl;
         } else {
             // replace the context of the section with the returned partial view
             $('#upload_section').html(data);
         }
     }
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T01:08:07.947

您可以使用`success`回调的第二个或第三个参数来确定要做什么。无论如何，由于您使用的是 ajax，因此您将无法进行正常的重定向。您可能需要通过 javascript 进行二次重定向或将整个页面替换为从`RedirectToAction`

# rest - 如何为电子邮件发送服务设计 REST API？

> ID：12310442
> 
> 赞同：33
> 
> 时间：2012-09-07T01:04:30.393
> 
> 标签：rest

如何使用 POST、GET、PUT、DELETE 为电子邮件发送服务设计 REST API？

```
send: POST - /email
retrieve: GET - /email/{id}
delete: DELETE - /email/{id} 
```

它是设计 REST API 的正确方法吗？我觉得将 POST 映射到“发送”动作并不直观。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-09-07T03:59:41.447

你给出的方案是正确的。或者，您可以使用控制器来执行一些更复杂的操作。

在您的情况下，它可能如下所示：

```
(action)           (verb)   (URI)                             (type)
create:            POST   - /emails                         - collection
retrieve:          GET    - /email/{id}                     - resource
update:            PUT    - /email/{id}                     - resource
delete:            DELETE - /email/{id}                     - resource
send immediately:  POST   - /email/{id}/sendImmediately     - controller
just send:         POST   - /email/{id}/send                - controller
do something else: POST   - /email/{id}/someOtherActionType - controller 
```

注意新控制器和更改创建工作。后者相当主观，但合理（因为您无法真正访问“没有实际电子邮件”的 URL，就像我解释“`/email`没有”`{id}`部分的“”一样）。

其他资源：

*   [REST API 设计规则手册](http://shop.oreilly.com/product/0636920021575.do)

# python - PyPy：获取对字符串的原始访问

> ID：12310445
> 
> 赞同：3
> 
> 时间：2012-09-07T01:04:48.633
> 
> 标签：python, cpython, pypy

在 CPython 中，这有效：

```
import ctypes
ctypes.pythonapi.PyString_AsString.argtypes = (ctypes.c_void_p,)
ctypes.pythonapi.PyString_AsString.restype = ctypes.POINTER(ctypes.c_char)

s = "abc"
cs = ctypes.pythonapi.PyString_AsString(id(s))
cs[0] = "x"

print s # will print 'xbc' 
```

在 PyPy 中，它不是因为我不能以这种方式访问​​ C-API。

在 PyPy 中有什么方法可以做同样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T17:23:31.837

你不应该那样做。主要原因是 PyPy 有一个可移动的垃圾收集器，所以指向它的内容的指针可能会突然开始指向垃圾。另一个原因是我们很少有具有类似 StringAdd(a, b) 结构的选项，其中实际上没有可引用的底层 char*。这些优化默认情况下不启用，但它们可能很快就会启用。

# php - 从 AJAX 回调函数中分离数据

> ID：12310447
> 
> 赞同：0
> 
> 时间：2012-09-07T01:05:25.267
> 
> 标签：php, javascript, ajax

当我按下一个按钮时，我执行一个返回数据的 ajax 发布。该 ajax 发布更新数据并返回一个数字来告诉我该按钮是否应该突出显示。我的问题是，我希望 ajax post 回调函数返回数字和更新的信息。这在 ajax 文件上很容易做到，但我不确定如何在回调函数上做到这一点。下面是一个简单的例子。

```
$.post(ajax_file, 
{
primary_id: primary_id
}, 
function (data){
    //ajax file calls back the number 1 or the number 0\. But I want to return more
    //than just that. Maybe an array would work?    
    if (data == 1) 
      { 
      $(the_button).addClass('highlighted');            
      }     
    else if (data == 0) 
          {
          $(the_button).removeClass();
          }         
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T01:10:10.460

您需要以 JSON 格式做出响应。您的 PHP 代码将不得不使用与此类似的代码进行响应 -

```
$response = array(
  'code'=>1,
  'updates'=> $updates // this could be HTML or an array.
);

echo json_encode($response); 
```

`post()`然后你需要做的就是在你的函数中指定你期望的数据是 JSON 格式。

```
$.post(ajax_file, { primary_id: primary_id }, function (data){
    if (data.status == 1) { 
      $('.the_button').addClass('highlighted');            
    }     
    else if (data.status == 0) {
      $('.the_button').removeClass();
    }        
    // do something with data.updates 
},'json'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T01:11:18.090

而是返回一个 json。

```
data = {
  "check" : 1,
  "otherInfo" : {
  }
} 
```

然后，在客户端，做

`data.check`检查突出显示按钮的条件

并`data.otherInfo`获取其他附加信息。

`json_encode()`您可以在服务器端将 php 数组转换为 json 。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-07T01:09:54.423

返回一组信息？返回一个对象？

```
{
    "returnCode": 4,
    "returnString" : "No way man",
    "LongData" : "This quick brown fox ignored the lazy dogs."
} 
```

# android - 调用方法时如何解决 NullPointerException？

> ID：12310453
> 
> 赞同：1
> 
> 时间：2012-09-07T01:06:24.980
> 
> 标签：android, class, android-intent, methods, nullpointerexception

我是 android 的菜鸟，我在调用另一个类的方法时遇到问题。从它自己的类中调用该方法时工作正常，但是当我从另一个类中调用它时，我得到一个空指针异常。任何帮助将不胜感激。这是我的代码；

从class2调用class1中的方法：

```
BottlesActivity  inst = new BottlesActivity();
inst.call0(); 
```

第 1 类中的方法：

```
public void call0() {
    try {
        Intent callIntent = new Intent(Intent.ACTION_CALL);
        callIntent.setData(Uri.parse("tel:1234567890"/*+phonenumber0*/));
        startActivity(callIntent); //<--This line causes nullpointerexception
    } catch (ActivityNotFoundException activityException) {
        Log.e("dialing-example", "Call failed", activityException);
    }
} 
```

这是我的 Logcat

```
09-06 20:51:33.237: E/AndroidRuntime(18192): java.lang.NullPointerException
09-06 20:51:33.237: E/AndroidRuntime(18192):    at android.app.Activity.startActivityForResult(Activity.java:2893)
09-06 20:51:33.237: E/AndroidRuntime(18192):    at android.app.Activity.startActivity(Activity.java:3003)
09-06 20:51:33.237: E/AndroidRuntime(18192):    at com.bryanjrichardson.GSCC.BottlesActivity.call0(GoldandSilverCoinCalculatorActivity.java:857)
09-06 20:51:33.237: E/AndroidRuntime(18192):    at com.bryanjrichardson.GSCC.SimpleItemizedOverlay$1.onClick(SimpleItemizedOverlay.java:204)
09-06 20:51:33.237: E/AndroidRuntime(18192):    at com.android.internal.app.AlertController$ButtonHandler.handleMessage(AlertController.java:174)
09-06 20:51:33.237: E/AndroidRuntime(18192):    at android.os.Handler.dispatchMessage(Handler.java:99)
09-06 20:51:33.237: E/AndroidRuntime(18192):    at android.os.Looper.loop(Looper.java:130)
09-06 20:51:33.237: E/AndroidRuntime(18192):    at android.app.ActivityThread.main(ActivityThread.java:3859)
09-06 20:51:33.237: E/AndroidRuntime(18192):    at java.lang.reflect.Method.invokeNative(Native Method)
09-06 20:51:33.237: E/AndroidRuntime(18192):    at java.lang.reflect.Method.invoke(Method.java:507)
09-06 20:51:33.237: E/AndroidRuntime(18192):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
09-06 20:51:33.237: E/AndroidRuntime(18192):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
09-06 20:51:33.237: E/AndroidRuntime(18192):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:43:26.487

如果您的 2 个类是**2 个独立的活动**，您的情况将导致空指针异常，因为当第二个活动运行时，第一个活动停止（终止）-> 这是 Android 操作系统机制，您无法更改。

针对您的情况的解决方案：

*   (1) Activity 1 是其他的父级，这种情况适用于 Application 类或 TabHost（复杂）。

*   （2）创建像**@Zapl's answer**这样的静态方法；但它仍然不是很好，因为这个静态方法应该是常用的，而不是在 Class 1 -> modify: Create a common Class，如下所示：

这是实用程序类：

```
public class GlobalUtil
{
    public static void startUrlActivity(Context context, String url) {
    try {
        Intent callIntent = new Intent(Intent.ACTION_CALL);
        callIntent.setData(Uri.parse(url));
        context.startActivity(callIntent); //<-- pass current activity or context
        } catch (ActivityNotFoundException activityException) {
        Log.e("dialing-example", "Call failed", activityException);
        }
    }
} 
```

在任何其他活动类中，您可以调用它：

```
GlobalUtil.startUrlActivity(this, "tel:1234567890"/*+phonenumber0*/"); 
```

或者

```
GlobalUtil.startUrlActivity(getBaseContext().getApplicationContext(), "your_url"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T01:13:14.697

如果 call0() 是同一活动类的方法，这将起作用。

```
public void call0() {
    try {
        Intent callIntent = new Intent(Intent.ACTION_CALL,Uri.parse("tel:1234567890"));
        startActivity(callIntent); 
    } catch (ActivityNotFoundException activityException) {
        Log.e("dialing-example", "Call failed", activityException);
    }
} 
```

并且不要忘记在清单文件中添加它：

```
<uses-permission android:name="android.permission.CALL_PHONE"></uses-permission> 
```

我不认为这是一件好事：

```
BottlesActivity  inst = new BottlesActivity();
inst.call0(); 
```

相反，当单击按钮时，调用 call0() 如下所示：

```
public void onClick(View v) {
     switch(v.getId()){
          case R.id.idButton:
                call0();
                break;

      }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-07T01:23:17.147

你不能创造一个`Activity`你自己。`static`您可以在另一个 Activity 类中使​​用方法。

从任何活动：

```
BottlesActivity.call0(this); 
```

瓶装活动

```
public static void call0(Context context) {
    try {
        Intent callIntent = new Intent(Intent.ACTION_CALL);
        callIntent.setData(Uri.parse("tel:1234567890"/*+phonenumber0*/));
        context.startActivity(callIntent); //<--This line causes nullpointerexception
    } catch (ActivityNotFoundException activityException) {
        Log.e("dialing-example", "Call failed", activityException);
    }
} 
```

# c++ - 如何避免由带有反向引用的共享指针引用的聚合类型的两阶段构造？

> ID：12310456
> 
> 赞同：0
> 
> 时间：2012-09-07T01:06:30.497
> 
> 标签：c++, constructor, smart-pointers

假设我有一个 type`Aggregator`和一个`Aggregatee`。前者知道 s 对后者的集合`shared_ptr`。后者有一个指向前者的唯一反向指针：

```
struct Aggregatee {
  private:
    Aggregator& aggregator;
    Aggregatee(Aggregator& aggregator)
      : aggregator{aggregator} {
      // PROBLEM HERE:
      //   I want to put `this` into the aggregation list,
      //   but I have no clue how to properly refer to `this`
      //   because I don't have the smart pointer object, yet.
    }
    Aggregatee(Aggregatee const& from) { /* ... */ }
  public:
    template <typename Args...>
    static std::shared_ptr<Aggregatee> create(Args... args) {
      return std::make_shared<Aggregatee>(args...);
    }
};

struct Aggregator {
  std::set<std::shared_ptr<Aggregatee>> aggregation;
}; 
```

显然，我可以在使用私有函数之后推迟`Aggregatee`在`Aggregator`对象中注册，但它闻起来像两阶段，因为对象临时*不一致地初始化*。`make_shared``register`

 *有什么已知的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T03:42:41.247

您要避免的实际上是一种非常常见的模式：创建聚合器（容器），然后创建聚合（元素）并将其插入容器中。可以使用传递给构造函数的反向指针创建元素，然后将其插入容器或反向指针。

例如，考虑一个带有反向指针的二叉树，元素在叶子上创建并带有指向父节点的指针，并且指针立即存储在父节点中。

至于您的特定问题，它无法完成，因为`shared_ptr`在创建对象之前您无法获得对象，即使使用`enable_shared_from_this`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:34:41.973

您可以使用侵入式共享指针。由于引用计数存在于共享对象中，因此 Aggregatee 可以在其自己的构造函数中创建指向自身的共享指针。

Boost 有一个侵入式指针类型的例子，或者你可以很容易地滚动你自己的。

[http://www.boost.org/doc/libs/1_51_0/libs/smart_ptr/intrusive_ptr.html](http://www.boost.org/doc/libs/1_51_0/libs/smart_ptr/intrusive_ptr.html)

```
// shared base type contains the reference counter; how you implement the
// reference counting depends on your implementation.
struct Aggregatee : public shared {
  private:
    Aggregator& aggregator;

    Aggregatee(Aggregator& aggregator) : aggregator{aggregator} {
      // Boost allows a raw pointer to be implicitly cast to an intrusive
      // pointer, but maybe your intrusive pointer type won't.
      aggregator.aggregation.insert(intrusive_ptr<Aggregatee>(this));
    }

    Aggregatee(Aggregatee const& from) { /* ... */ }

  public:
    template <typename Args...>
    static intrusive_ptr<Aggregatee> create(Args... args) {
      return new intrusive_ptr<Aggregatee>(args...);
    }
};

struct Aggregator {
  std::set<intrusive_ptr<Aggregatee>> aggregation;
}; 
```

您必须注意的一件事是，Aggregatee 在构造后确实存储在智能指针中。

```
Aggregatee aggregatee(aggregator);  // Very bad!
intrusive_ptr<Aggregatee> aggregatee(new Aggregatee(aggregator));  // Good 
```

此外，您最好确保您的 Aggregator 持有 intrusive_ptr 直到 Aggregatee 完全构造，否则 Aggregatee 最终将在构造函数退出之前被销毁！

因此，这种方法有一些注意事项，但据我所知，这是您最接近实现您所要求的目标的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T02:00:46.687

根据您的应用程序，您可以将静态创建方法从 Aggregatee 移动到常规成员方法 Aggregator。然后您可以创建 shared_ptr 并将其存储在相同的方法中。

这假定 Aggregatee 始终与 Aggregator 相关联。*

# php - 在 PHP 中以上传的图像居中图像

> ID：12310464
> 
> 赞同：0
> 
> 时间：2012-09-07T01:08:12.567
> 
> 标签：php, image, gd

我有用户上传始终为方形的图像（可变尺寸，但始终为方形），并且我想在方形图像的中间覆盖我自己的图像（也可以是固定尺寸的方形），不管的大小。

我知道我可以使用 GD 并使用尺寸，但是有没有办法用更少的代码行自动居中它？

我不需要任何花哨的东西，只需将图像放入另一个图像的中心即可。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T01:18:06.073

我很困惑您是在问如何在 GD 中执行此操作，还是要替代 GD。如果您想使用 GD 库，您可以使用该`imagecopy()`函数并尝试如下操作：

```
<?php
$uploaded = imagecreatefrompng("../image.png"); //user uploaded
$watermark = imagecreatefrompng("../logo.png"); //watermark or logo

$x = imagesx($uploaded) / 2 - imagesx($watermark) / 2;
$y = imagesy($uploaded) / 2 - imagesy($watermark) / 2;

imagecopy($uploaded, $watermark, $x, $y, 0, 0, imagesx($watermark), imagesy($watermark));

header("Content-type: image/png");
imagepng($uploaded);

imagedestroy($uploaded);
imagedestroy($watermark); 
```

否则，您能否更具体地说明您想要什么？我的意思是，您可以使用 ImageMagick 等不同的库来实现，但不一定有*更好*的方法来实现。

# java - 为什么存在 serialVersionUID 字段？

> ID：12310465
> 
> 赞同：3
> 
> 时间：2012-09-07T01:08:13.923
> 
> 标签：java, serializable, aspects, serialversionuid

它让我对`Serializable`界面的启动感到困惑，为什么我必须将此字段合并到我的所有课程中。我知道这个接口需要一个唯一的标识符来标记这个类，但是为什么他们不能在运行时生成它。例如，他们可以使用完全限定类名的 MD5 散列或用于处理罕见情况下的重复项的类似方法来生成它（我敢肯定，当被要求生成 id 时，eclipse 会做什么）。

那么我要问的是（不，这篇文章不仅仅是对标准库的咆哮）框架到底是如何使用序列化字段的？

我想知道的原因是因为我将尝试创建一个 Aspect（用 AspectJ 或其他语言），它将使用 MD5 哈希添加 serialVersionUID 字段，并且能够以 API 可接受的方式处理冲突。

如果我能让它工作，我会发布结果。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-07T01:12:08.110

没有要求拥有该`serialVersionUID`领域。如果您不提供，Java 将根据您的类的字段和方法生成一个。

您可能要指定的原因`serialVersionUID`是为了防止在更改方法时更改值，这不会影响序列化的二进制文件。考虑类：

```
public class Person implements Serializable {
    private String name;
    public String getName() {
        return name;
    }
} 
```

没有`serialVersionUID`指定。如果你运行`serialver Person`它返回：

```
Person:    static final long serialVersionUID = 3793453319058452486L; 
```

现在您决定添加一个方法，但保持字段不变。

```
public class Person implements Serializable {
    private String name;
    public String getName() {
        return name;
    }
    public Object foo() {
        return "bar";
    }
} 
```

序列化的二进制文件仍然与旧版本完全兼容，但`serialVersionUID`不同的是：

```
Person:    static final long serialVersionUID = -6188734029437600310L; 
```

使用不同的`serialVersionUID`，反序列化将导致 serialVersionUID 不匹配错误。`serialVersionUID`解决方法是通过将其设置为任何值（我设置它）来声明您自己的值`1L`，并在字段发生更改时更改它。

另请参阅此[相关问题“什么是 serialVersionUID，我为什么要使用它？”](https://stackoverflow.com/questions/285793/what-is-a-serialversionuid-and-why-should-i-use-it) 进行更详细的讨论。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-07T01:19:18.303

> 为什么我必须在我所有的课程中加入这个领域

你没有。

> 为什么他们不能在运行时生成这个

他们会这样做，除非你自己提供。

> 我将尝试创建一个 Aspect（在 AspectJ 或其他语言中），它将使用 MD5 哈希添加 serialVersionUID 字段

那将毫无意义。你不明白它是干什么用的。在运行时生成它是默认情况下已经发生的，因此您的提案没有任何价值。该值在编译时指定它，以便吸收实际上不会破坏对象版本控制兼容性的次要类更改。您无法通过 AOP 来实现这一点。这是一个编码决定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T01:27:15.037

正如@Steve Kuo 所提到的，不需要该`serialVersionUID`字段。

这是令人沮丧的，因为它没有作为对象可序列化合同的一部分强制执行，我们团队中大约一半的开发人员这样做，而另一半则没有。大多数通常只是设置`private static final long serialVersionUID = 1L;`（尽管一些开发人员喜欢利用它作为尝试提出伪随机 Longs 的机会......）

话虽如此，我一直认为这是对可序列化对象进行版本控制的初步尝试。

假设我们有：

```
public class PersonDTO implements Serializable {

    private static final long serialVersionUID = 1L;

    private String firstName;
    private String lastName;

    // Appropriate getters/setters of course
} 
```

后来我们要添加一个新字段，`private String middleInitial`.

如果我们将 serialVersionUID 增加到 2，我们可以使用它来指示类已更改，并且旧的已序列化的具有 serialVersionUID 的 PersonDTO 实例无法使用此修改后的类定义反序列化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T01:21:39.030

## `Serializable`界面_

该接口存在于`java.io`包中。这是为了保护较小的更改而实现的，并且是为了使用户能够`write`在`save`运行时访问对象。这个接口由所有的 swing 组件实现，因为开发者可以扩展它们，以便 JVM 可以找到组件的新版本，即`Your class`。

## SerialVersionUID

`serialVersionUID`用作 Serializable 类中的版本控制。如果您没有`JVM will did it for you automatically`根据您的 Serializable 类的各个方面显式声明一个 serialVersionUID，如[`Java(TM) Object Serialization Specification`](http://java.sun.com/j2se/7/docs/api/java/io/Serializable.html)

# node.js - 带有 Args 的 Node.js 子进程问题 - 引号问题？，FFMPEG 问题？

> ID：12310468
> 
> 赞同：6
> 
> 时间：2012-09-07T01:08:31.270
> 
> 标签：node.js, command-line, process, ffmpeg, command-line-arguments

我需要能够从我的 Node.js 应用程序执行 FFMPEG。我相信这个问题可能与正确指定命令行参数有关，而不是特定于 FFMPEG，但由于我无法缩小问题范围，我提出了我的整个问题。

**我可以从命令提示符成功**执行以下命令：

```
C:\Brad\ffmpeg.exe -f dshow -i audio="Microphone (SoundMAX Integrated" testaaa.mp3 
```

FFMPEG 按预期启动，从我的音频设备录制音频，并写入 MP3 文件。现在，我尝试**在我的 Node.js 应用程序中做同样的事情**：

```
childProcess = child_process.spawn('C:\\Brad\\ffmpeg.exe', ['-f', 'dshow', '-i', 'audio="Microphone (SoundMAX Integrated"', 'testaaa.mp3']);
childProcess.stderr.on('data', function (data) {
    console.log('StdioSource received data from STDERR: ' + data);
}); 
```

**在 Node.js 中，FFMPEG 失败了！** 错误很简单：

```
[dshow @ 0000000001eded80] Could not find audio device.
audio="Microphone (SoundMAX Integrated": Input/output error 
```

考虑到可能出于某种原因这是一个奇怪的权限错误，我决定`-list_devices true`在我的 Node 应用程序中运行 FFMPEG，果然，列出了有问题的设备：

```
[dshow @ 000000000228ecc0] DirectShow video devices
[dshow @ 000000000228ecc0] Could not enumerate video devices.
[dshow @ 000000000228ecc0] DirectShow audio devices
[dshow @ 000000000228ecc0]  "Microphone (SoundMAX Integrated" 
```

**关于为什么我无法在 FFMPEG 的参数中正确指定音频输入设备，或者为什么 FFMPEG 在作为 Node.js 的子进程运行时无法识别我的音频输入设备的任何想法？**

任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-07T07:40:51.893

布兰登在正确的轨道上。当您在 Windows 命令行上的参数周围使用双引号时，shell 会将它们去掉，并且程序会看到它们没有被引用。当您使用时，`child_process.spawn()`您绕过了外壳程序，因此程序将文字引号视为参数的一部分，并且不准备处理它们。

例如，我创建了一个小节点脚本，`pargs.js`仅包含`console.log(process.argv);`使用您提供给 FFMPEG 的相同参数运行它，我得到：

```
C:\Documents and Settings\Eric Bohlman>node pargs -f dshow -i audio="Microphone(SoundMAX Integrated" testaaa.mp3
[ 'node',
  'C:\\Documents and Settings\\Eric Bohlman\\pargs',
  '-f',
  'dshow',
  '-i',
  'audio=Microphone (SoundMAX Integrated',
  'testaaa.mp3' ]

C:\Documents and Settings\Eric Bohlman> 
```

如您所见，shell 在使用引号后去掉了引号，以避免`audio=...`在空格处破坏参数。

请注意，Windows shell（至少从 XP SP3 开始）不会去掉单引号或将它们用于分组，这与 Linux 系统上常用的 bash 不同。因此，如果您正在查看某人的示例 bash 命令行并且它使用单引号，则通常必须将它们替换为双引号才能在 Windows 下工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-09-25T11:14:19.287

正如[ebolhman](https://stackoverflow.com/users/1151224/ebohlman)解释的那样生动，默认情况下，spawn 函数不会创建一个 shell 来执行命令，因此不会去掉引号，如果你仍然想使用 spawn\spawnSync，你所要做的就是将它的参数传入以下方式

```
require('child_process').spawn('ExePathHere', arrOfArguments, { shell: true }); 
```

Exe 本身将获得没有他无法处理的引号的参数

# scala - 为什么方法 main() 在 Scala 中的定义中不需要“=”？

> ID：12310469
> 
> 赞同：1
> 
> 时间：2012-09-07T01:08:43.560
> 
> 标签：scala, syntax, main, method-declaration

> **可能重复：**
> [scala：'def foo = {1}' vs 'def foo {1}'](https://stackoverflow.com/questions/1661817/scala-def-foo-1-vs-def-foo-1)

为什么在 Scala 中定义方法`main`时，不需要使用`=`?

**例子：**

```
def main(args:Array[String]) {
    ... 
```

但是如果一个人想要定义另一个函数，它就需要它。

```
def main(args:Array[String]) **=** {
... 
```

有人可以解释这种语法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T01:11:14.517

在 Scala 中，方法声明中的等号告诉编译器该方法返回了一些东西。如果没有出现等号，则编译器知道该方法不返回任何内容。这相当于`void`Java 中的方法。在 Scala 中，返回 nothing 与返回相同`Unit`。

```
scala> def noEquals(x: Int) { x + 1 }
noEquals: (x: Int)Unit

scala> val y = noEquals(5)
y: Unit = () 
```

与出现等号的示例进行比较：

```
scala> def hasEquals(x: Int) = { x + 1 }
hasEquals: (x: Int)Int

scala> val z = hasEquals(5)
z: Int = 6 
```

在 Java 中，main 方法不返回任何内容（它被声明为`void`，如`public static void main(String[] args)`）。因此，Scala 版本省略了等号。

另请注意，您可以使用等号编写 main 方法，只要该方法返回`Unit`（尽管这将违反约定）。此外，等号对于其他方法不是“必需的”......只是那些需要返回东西的方法。如果您正在编写一个不返回任何内容的方法，那么省略等号是完全可以接受的（也是适当的）。

# c++ - 如何在一堆数字中找到一个不同的值

> ID：12310479
> 
> 赞同：3
> 
> 时间：2012-09-07T01:09:55.200
> 
> 标签：c++, algorithm

这是一个大数据，包含一亿个整数，但其中与其他相同的整数有一个不同的值，例如：1,1,1,1,1,1,1,42,1,1,1, 1..但是，我不知道我的以下代码发生了什么。

```
int main() {

    vector <int> data;
    cout << "Enter same numbers " << " and a different one( negative to be end) :" << endl;
    int value;
    while (cin >> value && value > 0) {
        data.push_back(value);
    }
    int unique_value;
    int size = data.size();
    if (data[0] != data[size - 1]) {
        if (data[0] != data[2]) {
            unique_value = data[0];
        } else {
            unique_value = data[size - 1];
        }
        cout << "found the unique number: " << unique_value << endl;
        exit(0);
    }
    int low = 1;
    int high = size - 2;
    while (high > low) {
        if (data[high] != data[low]) {
            //其中必有一个是不同的，只要和data[0]就能得到结果
            if (data[high] != data[0]) {
                unique_value = data[high];
            } else {
                unique_value = data[low];
            }
            break;
        }
    }
    if (high == low) {
        unique_value = data[high];
    }
    cout << "found the unique number: " << unique_value << endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-07T01:23:29.747

对前三个元素进行排序，然后取中间一个。这是您的非唯一号码。浏览列表，并查找与它不同的数字：

```
int data[] = {7,7,7,7,7,7,42,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7};
size_t N = sizeof(data)/sizeof(data[0]);
sort(data, data+3);
int non_unique = data[1];
for (int i = 0 ; i != N ; i++) {
    if (data[i] != non_unique) {
        cout << data[i] << endl;
        break;
    }
} 
```

[链接到ideone。](http://ideone.com/Zk4a1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T01:27:13.397

假设您只允许输入*两个*可能的数字（“一个不同的值与其他整数”），您不需要全部存储它们。在这种情况下，您将输入类似`1,1,1,1,1,1,1,42,1,1,1,1`.

如果是这种情况，您可以使用类似（伪代码）：

```
firstNum = 0; firstCount = 0
secondNum = 0; secondCount = 0
while true:
    num = getNumber()
    if num < 0:
        break while

    if firstCount == 0:                  # first unique number
        firstNum = num
        firstCount = 1
        next while

    if num == firstNum:                  # copy of first
        firstCount++
        next while

    if secondCount == 0:                 # second unique number
        secondNum = num
        secondCount = 1
        next while

    if num <> secondNum:                 # third unique number (disallowed)
        print "Only two numbers allowed"
        stop run

    secondNum++                          # was the second unique number

if secondNum == 0:                       # there was < 2 unique numbers
    print "Not enough different numbers"
    stop run

if firstCount > 1 and secondCount > 1:   # there were no unique numbers
    print "No one unique number"
    stop run

if firstCount == 1:                      # Choose number with count of 1
    print "Unique number is " firstNum
else
    print "Unique number is " secondNum 
```

* * *

相反，如果可能有许多不同的数字，您将需要一个解决方案来检查每个数字与其他数字。

这可以通过多种方式完成（可能还有其他方式，这些只是最初想到的几个）：

*   慢 O(n^2) 检查每个数字与每个其他（后续）数字。
*   然后排序稍微快一些（可能是 O(log N)，然后通过排序列表检查相邻的数字。
*   如果输入范围有限，您可以为每个可能的数字使用一个计数数组，并查找最终计数为 1 的那个（确保没有其他人也这样做）。

根据您的问题文本，我认为情况并非如此，但我认为我最好也涵盖这方面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T02:39:18.513

每个人都告诉过你*他们*会怎么做，但没有回答你的问题：你的代码有什么问题？

问题是您的代码永远不会终止，因为您永远不会更改循环中的`high`and`low`值。您正在从数组的两端工作，并将两个值与数组中的第一个元素进行比较。现在，这使您的第一个 if 块变得多余，实际上有点奇怪，因为它检查第三个数组元素（没有任何边界检查）。

所以......把这部分拿出来：

```
//if (data[0] != data[size - 1]) {
//    if (data[0] != data[2]) {
//        unique_value = data[0];
//    } else {
//        unique_value = data[size - 1];
//    }
//    cout << "found the unique number: " << unique_value << endl;
//    exit(0);
//} 
```

并修复循环：

```
int low = 1;
int high = size - 1;
while (high >= low) {
    if( data[high] != data[0] )
    {
        if (data[low] == data[high]) {
            unique_value = data[high];
        } else {
            unique_value = data[0];
        }
        break;
    }
    else if( data[low] != data[0] )
    {
        unique_value = data[low];
        break;
    }
    low++;
    high--;
}

// Take out the part that compares high==low.  It was wrong, and has been made
// redundant by looping while high >= low (instead of high > low). 
```

那应该行得通。但这很奇怪。

现在，请注意，由于缓存局部性，以这种方式搜索您的数组是一个坏主意。出于优化原因，您希望将搜索限制在内存的同一部分，并且对于此算法，您没有理由不只检查数组中的三个相邻值。

事实上，您只需要检查前三个，之后您将确定非唯一值，或两者兼而有之。如果前三个元素都相同，则只需对数组的其余部分进行线性搜索，直到找到不同的值……已经指出，您甚至不必将值读入数组. 您可以即时执行此操作。

```
size_t size = data.size();

if( size < 3 ) {
    cerr << "Not enough data\n";
    exit(0);
}

int unique_val = 0;

if( data[1] == data[0] && data[2] == data[0] ) {
    int common_val = data[0];
    for( int i = 3; i < size; i ++ ) {
        if( data[i] == common_val ) continue;
        unique_val = data[i];
        break;
    } 
}
else if( data[1] != data[0] ) {
    if( data[2] == data[1] )
       unique_val = data[0];
    else
       unique_val = data[1];
}
else {
    unique_val = data[2];
}

if( unique_val == 0 ) {
    cout << "No unique value found\n";
} else {
    cout << "Unique value is " << unique_val << "\n";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T02:32:19.097

首先是您的代码有什么问题。您有一个`while`由两个变量控制的循环，`high`并且`low`在循环内没有更新，因此它将永远旋转。

至于算法，您不需要存储数字来找到不同的数字，而是可以读取前两个数字，如果它们不同，则读取第三个数字并且您有答案。如果它们相同，请保留其中一个并继续阅读数字，直到找到一个不同的数字：

```
// omitting checks for i/o errors, empty list and single number list:
// and assuming that there is one that is different
int main() {
   int first;
   int current;
   std::cin >> first >> current; 
   if (first != current) {
      int third;
      std::cin >> third;
      if (first==third) {
         std::cout << current << "\n";
      } else {
         std::cout << first << "\n";
      }
      return 0;
   }
   while (std::cin >> current && current == first) ;
   std::cout << current << "\n";
} 
```

在该草图之上，您将需要处理输入错误，以及不受该通用算法管理的极端情况（空列表、1 个元素列表、2 个元素列表）。

# asp.net-mvc - 使用 MVC VS2010 AJAX 级联下拉菜单

> ID：12310490
> 
> 赞同：0
> 
> 时间：2012-09-07T01:11:39.503
> 
> 标签：asp.net-mvc, asp.net-ajax

我正在尝试创建一个 Ajax 驱动的级联下拉列表。我发现的示例使用了 Web 服务，但是没有使用 VS2010 Web 服务。相反，我认为我会使用 MVC。我遵循了另一个教程，该教程展示了如何设置 MVC 服务，但我的迭代不起作用。因为在我认为它不应该如此艰难之前，我还没有做过 Web 服务器或 MVC 服务，但我已经搁浅了。有人可以指出我做错了什么吗？我收到此错误“编译器错误消息：CS0524：'位置'：接口无法声明类型”

请在下面查看我的代码。谢谢。理庄

```
[ServiceContract]
public interface ILocations
{
    [OperationContract]
    List<Locations> GetLocations(int ident);

    [DataContract] 
    public class Locations   <<- ERROR *******************************
    {
       int ident = 0;
       string description = string.Empty;

       [DataMember]
       public int Ident
       {
           get { return ident; }
           set { ident = value; }
       }

       [DataMember]
       public string Description
       {
           get { return description; }
           set { description = value; }
       }
    }
}

public class Locations : ILocations
{
    SqlCommand cmd = new SqlCommand();
    SqlConnection conn = new SqlConnection();
    string connString = WebConfigurationManager.ConnectionStrings["dbLocations"].ToString();

List<ILocations.Locations>GetLocations(int ident)
{
        cmd.Connection = new SqlConnection(connString);
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.CommandText = "sp_Location_Get_Children";

        cmd.Parameters.Add("@pintParentIdent", SqlDbType.Int);
        cmd.Parameters["@pintParentIdent"].Value = ident;

        List<ILocations.Locations> _location = new List<ILocations.Locations>();

        try
        {
           SqlDataAdapter da = new SqlDataAdapter(cmd);
           DataTable dtLocations = new DataTable();
           da.Fill(dtLocations);

           if (dtLocations.Rows.Count > 0)
           {
                for (int i = 0; i < dtLocations.Rows.Count; i++)
                {
                    ILocations.Locations _locInfo = new ILocations.Locations();
                    _locInfo.Ident = Convert.ToInt32(dtLocations.Rows[i]["ident"]);
                    _locInfo.Description = dtLocations.Rows[i]["description"].ToString();

                   _location.Add(_locInfo);
                }
            }
            return _location;
        }
        catch (Exception ex)
        {
            cmd.Connection.Close();
            throw;
        }
    }
 }

<ajaxToolkit:CascadingDropDown ID="cddLocations" runat="server"
         TargetControlID="ddlLocationDetail"
         Category="description"
         PromptText="Select Location"
         LoadingText="Loading..."
         ServicePath="~/App_Code/ILocations.cs"
         ServiceMethod=""
         ParentControlID="ddlRoomLocation"
         SelectedValue="ident" />
        <asp:DropDownList runat="server" ID="ddlRoomLocation" AppendDataBoundItems="True"
             DataTextField="description" DataValueField="ident"
             width="246px" CssClass="AssetMngnt-smallFont" AutoPostBack="true" 
             OnSelectedIndexChanged="ddlRoomLocation_OnSelectedIndexChanged" >
            <asp:ListItem Value="-1" Selected="True">-- Select a Location --      </asp:ListItem>
            <asp:ListItem Value="-2">-- All Printers --</asp:ListItem>
        </asp:DropDownList>

        <asp:DropDownList Visible="false" runat="server" ID="ddlLocationDetail" AppendDataBoundItems="True"
             DataTextField="description" DataValueField="ident"
             width="246px" CssClass="AssetMngnt-smallFont" AutoPostBack="true" 
             OnSelectedIndexChanged="ddlLocationDetail_OnSelectedIndexChanged" >
            <asp:ListItem Value="-1" Selected="True">-- Select a Detail --</asp:ListItem>
        </asp:DropDownList> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:21:37.367

从接口“ILocations”声明中取出类“Locations”声明。那些不能嵌套。

# javascript - 自定义调查页面并希望在时区内按时间省略，可能吗？

> ID：12310491
> 
> 赞同：0
> 
> 时间：2012-09-07T01:11:46.213
> 
> 标签：javascript, jquery, jquery-ui

所以，我想在我的网站上弹出一个调查，*除了*在我网站上的特定时间范围内。

例如，如果时间介于（本地用户/计算机时间）之间。

上午 9 点 - 下午 2 点——每周 7 天不显示调查。

这必须足够强大以覆盖美国以外的其他国家（时区）。

我一直在寻找，但还没有找到我需要的东西。这是可行的还是已经在插件等中使用...？

我的一个想法是从转换后的纪元数据中获取本地用户时间的小时/分钟，然后根据该范围进行抑制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T16:20:41.243

理论上，您可以通过以下方式进行操作：

1.  使用`Date`Javascript 中的对象，您可以读取客户端浏览器上的实际时间。
2.  然后，您检查它是否在范围内。如果是肯定的，您将显示一个对话框（即使用`JQueryUI Dialog`）。

就像是：

```
function checkForSurvey(){
   var d = new Date();
   var hours = d.getUTCHours();   // Number between 0 and 23
   if ((hours < 9) || (hours > 14)){   // 14 = 2pm
      showSurvey();
   }
}

function showSurvey(){
   $('#survey').dialog();
} 
```

显然，您可以改进我的代码，但我认为您已经了解了我的建议。

# cocoa - NSOutlineView 有 2 列

> ID：12310501
> 
> 赞同：0
> 
> 时间：2012-09-07T01:12:53.167
> 
> 标签：cocoa, nsoutlineview

我有一个 NSOutlineView 工作。到目前为止，一切都很好。

现在我正在尝试将复选框添加到每一行并且没有很多运气。

如果我在位置 0 创建一个新列并将一个复选框控件拖入其中，我会在第一列中得到一个复选框控件，但文本不再显示在第二列中。我将第二列设置为大纲列。

我通过以下方式获得回调来填充复选框列的行文本，但不是文本列（这可能是其中没有文本的原因）：

```
-(id)outlineView:objectValueForTableColumn:byItem: 
```

如果我删除复选框列，一切都会恢复正常工作。

此外，如果我只是从列中删除复选框控件，那么我会收到回调，询问第二列的文本。

将复选框添加到第一列导致它没有第二个文本的原因是什么？

复选框是第一个还是最后一个似乎并不重要，只需将其放在其中一列中即可使其无法工作。

如果我将静态文本控件添加到第二列，则会显示文本，但在编辑文本时我不再得到回调`-(id)outlineView:objectValueForTableColumn:byItem:`。

单击复选框时，我也没有收到任何回调，这可能是同一个问题。

不知道如何更好地解释这一点。这是如何设置视图的屏幕截图：

![在此处输入图像描述](../Images/1a35a14d60e21689648366c089a5efaa.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T04:49:31.310

我认为做到这一点的方法是使用基于视图的大纲，并将复选框和静态文本部分放在同一个视图中。

![/Users/janicedelmar/Desktop/IB.tiff](../Images/3b631a07eacce776b193b61ac5ba1140.png)

# css - 在 Mac 上的 Chrome 中未加载 CSS

> ID：12310510
> 
> 赞同：0
> 
> 时间：2012-09-07T01:14:15.703
> 
> 标签：css, macos, google-chrome

适用于我尝试过的所有其他浏览器/操作系统组合。

这是链接：[http ://blumingcreativity.com/](http://blumingcreativity.com/)

奇怪的是 CSS 确实在我的测试服务器上加载：http: [//pollak-labs.com/clients/tara/](http://pollak-labs.com/clients/tara/)

老实说，我不知道两者之间有什么区别。代码几乎相同，但 Chrome 出于某种原因不喜欢第一个链接的 CSS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:23:32.447

mac上有chrome插件吗？尝试禁用它们。`chrome://plugins`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T01:27:14.023

尝试清理缓存并重新加载页面。也许 Chrome 会“记住”你的 css 文件的旧版本。

```
chrome://settings/clearBrowserData 
```

（我测试了两个链接，它们在 FF 和 Chrome 上都可以正常工作）

# mysql - 如何对时间戳执行查询？

> ID：12310513
> 
> 赞同：1
> 
> 时间：2012-09-07T01:14:25.127
> 
> 标签：mysql, ruby-on-rails, ruby, date

我希望能够找到在今天之前或之后特定天数创建的条目。我有一些包含时间戳的模型。数据库中有大约 70k 条记录，因此运行 .all.each 需要很长时间。

我希望做类似的事情

```
Model.find_by_updated_at(Date.today - 1) 
```

似乎 updated_at 实际上返回类时间，而不是日期；而且因为它精确到分钟和秒，我不能做类似的事情

```
Model.find_by_updated_at(Time.now + 10000) # ten thousand seconds 
```

因为我的请求只想找到在特定日期更改的模型。

有没有办法使用 find 来做到这一点？

我想我可以编写自己的 SQL 查询而不是使用 find 但我不确定如何构造它以排除通过 hh:mm:ss 进行的搜索而只查看日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:23:13.227

您的查询正在寻找在特定时间创建的模型。您可能想要的是返回特定时间后创建的东西的东西：

```
Model.where('updated_at>=?', Date.today - 1) 
```

或者也许在一个范围内：

```
Model.where('updated_at BETWEEN ? AND ?', Date.today - 1, Date.today) 
```

有几种方法可以做到这一点。如果您经常这样做，您可能会发现创建可索引`DATE`列会更快。

另一种方法是像这样动态地进行：

```
Model.where('DATE(updated_at)=?', Date.today - 1) 
```

几乎总是可以用 ActiveRecord 术语表达您想要的内容，而不必求助于编写自己的查询。事实上，最好避免这种情况，除非你有充分的理由让你的代码更易于维护。

请记住，“一天”充其量只是一个相当模糊的概念。如果您应该按照 UTC 时间存储数据，您将需要调整开始时间和结束时间，否则您将使用 UTC 00:00:00 作为您一天的开始时间。这可能与您的期望不符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T01:34:17.823

您可以在模型上创建如下所示的方法：

```
def self.updated_on_date(date)
   where('updated_at BETWEEN ? AND ?', date.beginning_of_day, date.end_of_day)
end 
```

然后你可以这样称呼它

```
Model.updated_on_date(Date.today-1) 
```

# jquery - 本地添加行后将所有数据发送到服务器的问题

> ID：12310516
> 
> 赞同：1
> 
> 时间：2012-09-07T01:14:43.183
> 
> 标签：jquery, jqgrid

嗨，我是 jqGrid 的新手。我正在使用 jqGrid 4.4。我已经成功地使用了 Oleg 的方法

[仅在客户端上使用模式形式向 jqGrid 添加新行](https://stackoverflow.com/questions/5611065/adding-new-row-to-jqgrid-using-modal-form-on-client-only/5611519#5611519)

在本地添加行。我面临2个问题

1.  未添加到末尾的行，我该如何实现？
2.  我通过单击按钮发送所有行，如下所示：

我总是在错误块中收到警报？

```
 $("#sendButton").click(function(){
    var gridData = jQuery("#list").getRowData();
    var myJSONString = JSON.stringify(gridData);             
    var postData = myJSONString.replace(/[\"]/g, '\"');     
    alert("JSON serialized jqGrid data:\n" + postData);
    $.ajax({
        type: "POST",
        url: CONTEXT_ROOT+"/json",
        data : postData,
        dataType:"json",
        contentType: "application/json; charset=utf-8",
        success: function(response, textStatus, xhr) {
            alert("success");
        },
        error: function(xhr, textStatus, errorThrown) {
            alert("error:"+errorThrown+" textStatus : "+textStatus);
        }           
    });
}); 
```

不确定保存在 java 控制器中后需要返回什么。这是控制器中的代码。我也尝试将返回作为 void 但结果相同。还有一种更好的方法可以将来自 jsp 的 json 对象列表绑定到域对象列表。当只有一个对象（例如使用 @RequestBody 的表单中的对象）时，我尝试过 Binding，如中所述

[http://blog.springsource.org/2010/01/25/ajax-simplifications-in-spring-3-0/](http://blog.springsource.org/2010/01/25/ajax-simplifications-in-spring-3-0/)

```
@RequestMapping(value = "/json", method = RequestMethod.POST)
public ModelAndView saveNewCasePackOptions(@RequestBody List<Map> json) {

    for(Map mJson : json){  
        String idCasePkOptions = (String)mJson.get("idCasePackOptions");            
        Long idCasePackOptions = (idCasePkOptions.isEmpty())?null:new Long(idCasePkOptions);
        Short cypharecommended =  new Short((String)mJson.get("cypharecommended"));
        Short distributorapproved = new Short((String)mJson.get("distributorapproved"));
        String heightStr = (String)mJson.get("height");
        Double height = (heightStr.isEmpty())?null:new Double(heightStr);

        String lengthStr = (String)mJson.get("length");
        Double length = (lengthStr.isEmpty())?null:new Double(lengthStr);

        String weightStr = (String)mJson.get("height");
        Double weight = (weightStr.isEmpty())?null:new Double(weightStr);

        String widthStr = (String)mJson.get("width");
        Double width = (widthStr.isEmpty())?null:new Double(widthStr);      

        String stateString = (String)mJson.get("statuscode");
        stateString = (stateString.contains("Green"))?"1":"0";          
        Short statuscode = new Short(stateString);

        CasePackOptions casePkOpt = new CasePackOptions(idCasePackOptions, cypharecommended, distributorapproved, height, length, statuscode, weight, width);  

        System.out.println(casePkOpt);

        casePackOptionsService.save(casePkOpt);
    }
    ModelAndView mav = new ModelAndView();      
    mav.setViewName("casepackoptions/listPage1.jsp");
    return mav;
} 
```

任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:26:26.467

[我在这里](https://stackoverflow.com/a/12296186/315935)写了你问题第一部分的答案。

您可以从使用 Spring 的人那里得到问题第二部分的答案。这部分`myJSONString.replace(/[\"]/g, '\"')`对我来说似乎很可疑。可能您需要使用`data : {json: postData}`而不是`data : postData`. 可能您需要更改`@RequestBody`为`@RequestParam`或`@RequestParam("json")`。我自己不使用 Spring。

此外，您可以使用`$("#list").jqGrid("getGridParam", "data")`而不是`jQuery("#list").getRowData()`. 如果您使用数据的本地分页，这将特别有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T04:33:33.990

我已经让它工作了，但不确定这是否是推荐的方式。

java脚本函数是

```
$("#sendButton").click(function(){
    var gridData = jQuery("#list").getRowData();
    gridData = JSON.stringify(gridData);    
    alert("postData stringify data :\n" + postData);
    postData = postData.replace();
    $.ajax({
        type: "POST",
        url: CONTEXT_ROOT+"/json",
        data : gridData,
        contentType: "application/json; charset=utf-8",
        success: function(response, textStatus, xhr) {
            alert("success");
        },
        error: function(xhr, textStatus, errorThrown) {             
            alert("error:"+errorThrown+" textStatus : "+textStatus);
        }           
    });
}); 
```

服务器代码现在

```
@RequestMapping(value = "/json", method = RequestMethod.POST)
public @ResponseBody String saveNewCasePackOptions(@RequestBody List<Map> json) {
    for(Map mJson : json){  
        String idCasePkOptions = (String)mJson.get("idCasePackOptions");            
        Long idCasePackOptions = (idCasePkOptions.isEmpty())?null:new Long(idCasePkOptions);
        Short cypharecommended =  new Short((String)mJson.get("cypharecommended"));
        Short distributorapproved = new Short((String)mJson.get("distributorapproved"));
        String heightStr = (String)mJson.get("height");
        Double height = (heightStr.isEmpty())?null:new Double(heightStr);

        String lengthStr = (String)mJson.get("length");
        Double length = (lengthStr.isEmpty())?null:new Double(lengthStr);

        String weightStr = (String)mJson.get("height");
        Double weight = (weightStr.isEmpty())?null:new Double(weightStr);

        String widthStr = (String)mJson.get("width");
        Double width = (widthStr.isEmpty())?null:new Double(widthStr);      

        String stateString = (String)mJson.get("statuscode");           
        Short statuscode = new Short(stateString);

        CasePackOptions casePkOpt = new CasePackOptions(idCasePackOptions, cypharecommended, distributorapproved, height, length, statuscode, weight, width);  

        System.out.println(casePkOpt);

        casePackOptionsService.save(casePkOpt);
    }
    return "Success";
} 
```

感觉需要以不同方式完成的事情

1.  当我尝试使用 $("#list").jqGrid("getGridParam", "data"); 而不是 jQuery("#list").getRowData(); 我得到 id:"1" 作为我的 Json 字符串的一部分
2.  当尝试使用 data : {json: postData} 而不是 data : postData 时，firebug 中的 json 对象编码如下

json=%5B%7B%22idCasePackOptions%22%3A%221%22%2C%22cypharecommended%22%3A%221%22%2C%22distributorapproved%22%3A%222%22%2C%22height%22%3A%2214 %22%2C%22length%22%3A%2255%22%2C%22statuscode%22%3A%221%22%2C%22weight%22%3A%2214%22%2C%22width%22%3A%221%22 %7D%2C

任何的意见都将会有帮助。谢谢

# perforce - 如何将签到列出到特定分支

> ID：12310518
> 
> 赞同：0
> 
> 时间：2012-09-07T01:14:53.243
> 
> 标签：perforce

在 perforce 中，如何为某些用户签入特定分支生成报告。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T02:50:20.190

p4 更改 -u 用户名 //path/to/branch/...

您需要多次运行该命令，每个感兴趣的用户一次。

如果您刚刚开始在 Perforce 上编写这些类型的脚本和工具，您可能想要选择您最喜欢的脚本语言，并开始熟悉使用该特定脚本语言进行编程的 Perforce 扩展：[http:// www.perforce.com/perforce/doc.current/manuals/p4script/index.html](http://www.perforce.com/perforce/doc.current/manuals/p4script/index.html)

# php - PHP 和客户端之间的数据事务 - 哪种方式？

> ID：12310529
> 
> 赞同：0
> 
> 时间：2012-09-07T01:16:25.610
> 
> 标签：php

我会简短地回答我的问题。哪种方式听起来更专业？

这个？

```
PHP:
echo '<li>Link 1</li>';
echo '<li>Link 2</li>';
echo '<li>Link 3</li>';

jQuery:
for each <li>, add hover effect 
```

或这个？

```
PHP:
echo json_decode(array('Link 1', 'Link 2', Link 3'));

jQuery:
Encode json value, extract values, add hover effect 
```

还是 XML 而不是 JSON？

我问这个是因为我厌倦了编码重复的东西。我希望能够桥接事物，因此 JSON/XML 标准对我来说似乎更好一些。

你怎么看？如果我希望我的网站被桥接，我该如何改进这个逻辑？

附言。对不起，如果我不能很好地解释自己。基本上，我的 a.com 网站可能想要使用我的 b.com 新闻，因此在处理/提取这些数据时采用标准会更好。不过，我不确定我还有什么其他选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T01:31:37.887

用 JSON 编码更好，这样如果您需要创建其他应用程序访问的 Web 服务/api（例如 iphone 应用程序、android 应用程序等），它很容易解码。您应该在 PHP 端执行 json_encode，然后在 javascript 端对其进行解码，而不是其他方式

我不明白为什么 XML 如此受欢迎。我喜欢使用 JSON，因为它是面向对象的，所以很容易使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T01:36:24.340

如果最终客户是普通人（即像我们这样的最终用户），他们可能*不在乎*。在这种情况下，尽可能以最有效和最容易维护的形式编写数据事务 - JSON 是一个不错的选择。

如果最终客户是另一个实体（即新闻聚合器或其他大型文本存储库），他们可能*非常关心*您如何获取/使用他们的数据。您将不得不依赖他们的 API 以及他们如何向您公开数据。如果它们不支持，你不能只说你想要 JSON 或 XML 格式的数据 - 并且有些网站认为抓取其内容是违反条款的，所以也要小心。

# javascript - 到达 stepcarousel 中的最后一个面板后是否可以加载新的 div 内容？非动态？

> ID：12310531
> 
> 赞同：1
> 
> 时间：2012-09-07T01:16:42.490
> 
> 标签：javascript, ajax, carousel

我想你对“stepcarousel.js”脚本很熟悉；但我想知道整个脚本是否可以在固定数据存储上运行，或者如果你调用一个函数它可以继续翻转？

看看我想要做什么：

```
stepcarousel.setup({
    [...style setup...]

    contenttype: ['inline'], 

    oninit:function(){
        contentcontainer=document.getElementById('related')
    },

    onslide:function(){ 
        var d1 = document.getElementById('related'); 
        d1.insertAdjacentHTML('afterend', '<div id="two">two</div>');
    }
}) 
```

因此，当它到达面板的末尾时，它会显示“两个” txt，但不会创建一个独立的面板，因此会有一个带有很多“两个”的最后一个面板。

我想要做的是，创建一个新面板，但似乎 stepcarousel 只读取“div”的 onload 数量，而不是像调用时的新 div 一样`insertAdjacentHTML('afterend', ...)`......

任何猜测？？！

# regex - 正则表达式语法错误 - AmplifyJS

> ID：12310534
> 
> 赞同：2
> 
> 时间：2012-09-07T01:17:07.543
> 
> 标签：regex, amplifyjs

我刚刚在我的 ASP.NET MVC3 项目中添加了“amplify.js”，并得到了这一行的正则表达式语法错误：

```
key = key.replace( /[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u37f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g, "-" ); 
```

有谁知道这个正则表达式有什么问题？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T01:44:27.730

[https://github.com/appendto/amplify/issues/65](https://github.com/appendto/amplify/issues/65)

Unicode 字符 \u37f 不正确，应更正为 \u037f

```
key = key.replace( /[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u37f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g, "-" ); 
```

应该

```
key = key.replace( /[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g, "-" ); 
```

# c++ - 类模板专业化可以利用非专业化实现吗？

> ID：12310535
> 
> 赞同：2
> 
> 时间：2012-09-07T01:17:09.013
> 
> 标签：c++, template-specialization

我有一堂课：

```
template<typename T>
class Foo
{
public:
    ...
    Foo& operator=(const Foo&) { ... }
}; 
```

而且我想专门`Foo<std::string>`添加一个`Foo<std::string>::operator=(const char*)`重载并重用其余的`Foo<T>`实现。专业化是否有可能`Foo<std::string>`利用非专业化实现，或者我必须将`Foo<T>`实现移动到一个单独的基类中，`Foo<T>`而`Foo<std::string>`专业化从该基类派生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:37:58.600

模板的多个特化是不相关的类型。正如您在问题中提到的，一种常见的方法是将大部分功能移至基类以重用它。

有两个 C++1x 提案允许通过新的结构以更简洁的方式表达意图`static if`，尽管两个提案在被接受之前都有一些问题需要解决，然后你必须等待标准被批准，然后编译器赶上来......仍然就像练习一样，建议的语法不会使用明确的专业化，而是定制通用模板：

```
template<typename T>
class Foo
{
public:
    ...
    Foo& operator=(const Foo&) { ... }
    static if (std::is_same<T,std::string>::value) {
       Foo& operator=(const char*) { ... }
    }
}; 
```

# datatable - 将 CellSet 转换为 DataTable

> ID：12310541
> 
> 赞同：0
> 
> 时间：2012-09-07T01:18:09.647
> 
> 标签：datatable, mdx

作为我项目之一的一部分，我需要将单元集转换为数据表。如果此方法的调用者可以指定需要哪些维度作为列以及哪些维度需要用于行，这对于度量也是一样的，那就太好了。任何指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-12T14:24:50.237

我最近需要在我的项目中执行 MDX 查询，这严重依赖于 ADO 数据集和数据表。实际上，要求是能够在执行 MDX 查询时或多或少地看到我在 SSMS 中看到的内容。

例如，当这个 mdx 在 AdventureWorks 数据库中执行时

```
select
{[Sales Territory].[Sales Territory].[Country].&[France]} on columns,
[Product].[Category].[All Products] on Rows
from 
[Adventure Works] 
```

我们得到的结果集是：

```
 |     France
=====================================
All Products   |    $4,607,537.94 
```

对于此结果，将创建一个包含单个数据行的两列数据表。第二列中的“France”值是其标题，而不是列名。

我使用此函数将单元集转换为数据表。未提供函数 GetColumnName(num) 根据传递的 num 整数值返回列的名称。

```
Function Cellset2Datatable(ByVal cs As CellSet) As DataTable

        Dim dt As New DataTable
        Dim dc As DataColumn
        Dim dr As DataRow
        Dim i, j As Integer

        Dim num As Integer = 0
        Dim nNumberOfGroupingColumns As Integer = 0

        If cs.Axes.Count > 1 Then
            For Each m As Member In cs.Axes(1).Positions(0).Members
                num += 1
                dc = New DataColumn
                dc.ColumnName = GetColumnName(num)
                dt.Columns.Add(dc)
                nNumberOfGroupingColumns += 1
            Next
        End If

        Dim sCaption As String

        For Each p As Position In cs.Axes(0).Positions
            sCaption = ""
            For Each m As Member In p.Members
                If sCaption.Equals("") Then
                    sCaption = String.Format("[{0}]", m.Caption.Trim)
                Else
                    sCaption = String.Format("{0} / [{1}]", sCaption, m.Caption.Trim)
                End If
            Next

            num += 1
            dc = New DataColumn
            dc.ColumnName = GetColumnName(num)
            dc.Caption = sCaption
            dt.Columns.Add(dc)
        Next

        'import data

        Dim x As Integer, y As Integer
        Dim py As Position

        If nNumberOfGroupingColumns > 0 Then

            For y = 0 To cs.Axes(1).Positions.Count - 1
                py = cs.Axes(1).Positions(y)
                i = 0

                dr = dt.NewRow

                For Each m As Member In py.Members
                    dr.Item(i) = m.Caption
                    i += 1
                Next

                For x = 0 To cs.Axes(0).Positions.Count - 1
                    dr.Item(i) = cs(x, y).Value
                    i += 1
                Next

                dt.Rows.Add(dr)
            Next

        Else

            dr = dt.NewRow

            For i = 0 To cs.Axes(0).Positions.Count - 1
                dr.Item(i) = cs(i).Value
            Next

            dt.Rows.Add(dr)

        End If

        Return dt

    End Function 
```

首先，添加列。进行检查以查看垂直轴上是否存在任何“分组”列，在这种情况下添加相应的列：

```
 If cs.Axes.Count > 1 Then
        For Each m As Member In cs.Axes(1).Positions(0).Members
            num += 1
            dc = New DataColumn
            dc.ColumnName = GetColumnName(num)
            dt.Columns.Add(dc)
            nNumberOfGroupingColumns += 1
        Next
    End If 
```

下一步是添加对应于水平轴的列

```
 For Each p As Position In cs.Axes(0).Positions
        sCaption = ""
        For Each m As Member In p.Members
            If sCaption.Equals("") Then
                sCaption = String.Format("[{0}]", m.Caption.Trim)
            Else
                sCaption = String.Format("{0} / [{1}]", sCaption, m.Caption.Trim)
            End If
        Next

        num += 1
        dc = New DataColumn
        dc.ColumnName = GetColumnName(num)
        dc.Caption = sCaption
        dt.Columns.Add(dc)
    Next 
```

此步骤中的列标题用于存储所有级别值。例如 [Accessories].[France].[Internet Order Count] 变为 [Accessories] / [France] / [Internet Order Count]。最后一步是将数据导入数据表。这两种情况都在这里处理：“分组”列是否存在。

该函数不处理存在两个以上轴的情况。

我在分析服务和 MDX 方面的经验有限，我只是研究了项目需求所需的内容，因此我对我对概念的“简单”描述表示歉意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T09:21:45.000

如果在您的项目中使用[XMLA](http://en.wikipedia.org/wiki/XMLA)，您可以在 2 种格式之间进行选择：**多维数据集**或**表格行**集。

*   多维数据集：

    这种格式会给你一个cellset（你已经知道了）。

*   表格行集：

    这个应该更容易转换成数据表。

# ruby - 烘干场参数

> ID：12310542
> 
> 赞同：6
> 
> 时间：2012-09-07T01:18:23.573
> 
> 标签：ruby, documentation, yard

我已经得到了我认为是相当基本的 yard 宏用法，其中我有一个 Hash 结构，其中包含多个在多个函数之间共享的选项。我希望使用宏只是为了防止我不得不在整个地方复制这个结构，但它似乎不像那样工作。

我期望的工作是：

```
# @macro [new] my_hash
#   @param  $1 [Hash,Array<Hash>] Inputted my_hash
#   @option $1 [String] :a Value for A.
#   @option $1 [String] :b Value for B.
#   @option $1 [String] :c Value for C.

##
# my_func does stuff
# @macro my_hash h1
def my_func h1
end

## 
# other_func does stuff
# @macro my_hash h2
def other_func h2, a, b
end 
```

并正确记录 h1 和 h2。我想我已经发现至少 $1 不能像那样工作，而是从函数本身获取，但我可以调用这两个参数 h1 并在宏中用 h1 替换 $1 ，但我仍然没有得到我想要的.

[http://rubydoc.info/docs/yard/file/docs/Tags.md#macro](http://rubydoc.info/docs/yard/file/docs/Tags.md#macro)上的“定义简单宏”示例表明我可以做到这一点（请注意，我找到了带有 @!macro 的示例，有些没有但似乎都不起作用）。

我对院子不太了解，但这不起作用吗？我可以做一些类似的事情来实现我的结果吗？是否有调试功能可以解释这一点，因为庭院服务器控制台中没有出现错误？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T18:39:57.177

正如您已经在宏中指定应该为方法的第一个参数扩展它，而不是在扩展宏时不需要指定它。此外，似乎无法确定扩展宏的参数。另一件事是您可以`[new]`在这种情况下跳过，似乎最好使用`@!macro`而不是`@macro`.

```
# @!macro my_hash
#   @param  $1 [Hash,Array<Hash>] Inputted my_hash
#   @option $1 [String] :a Value for A.
#   @option $1 [String] :b Value for B.
#   @option $1 [String] :c Value for C.

##
# my_func does stuff
# @!macro my_hash
def my_func h1
end

##
# other_func does stuff
# @!macro my_hash
def other_func h2, a, b
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-21T17:49:08.413

[我相信您可以使用 YARDs Reference Tags](http://www.rubydoc.info/gems/yard/file/docs/Tags.md#Reference_Tags)完成您正在寻找的东西。

从文档：

> 如果标签的数据以`(see OBJECT)`它开头，则被视为“参考标签”。引用标签从指定的 OBJECT 按给定的标签名称逐字复制标签数据。例如，一个方法可以使用引用标记语法从给定对象复制所有@param 标记：
> 
> ```
> # @param [String] user the username for the operation
> # @param [String] host the host that this user is associated with
> # @param [Time] time the time that this operation took place
> def clean(user, host, time = Time.now) end
> 
> # @param (see #clean)
> def activate(user, host, time = Time.now) end 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-20T12:39:31.070

这适用于 yardoc 0.9.8（可能是任何版本）：

```
# @!macro my_hash
#   @param  $1 [Hash,Array<Hash>] Inputted my_hash
#   @option $1 [String] :a Value for A.
#   @option $1 [String] :b Value for B.
#   @option $1 [String] :c Value for C.

##
# my_func does stuff
# @macro my_hash
def my_func h1
end

##
# other_func does stuff
# @macro my_hash
def other_func h2, a, b
end 
```

注意缺少的感叹号！使用 调用宏时`@macro`。这是正确的[yardoc 语法](http://www.rubydoc.info/gems/yard/file/docs/Tags.md#macro)。

# java - 调整窗口大小并在其中移动内容

> ID：12310544
> 
> 赞同：3
> 
> 时间：2012-09-07T01:18:47.663
> 
> 标签：java, swing, resize, 2d-games

我有一个用java制作的简单游戏。本质上，我的编程能力比较基础，我希望能够调整游戏所在窗口的大小，而不是让图像停留在原来的位置，而只是在更大的区域显示白度。[这是一个屏幕截图。](http://sta.sh/0yoa0ib01pa)有什么简单的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T01:42:07.600

现有的两个答案似乎假设您希望调整游戏空间的大小。

### 调整游戏空间

射击游戏的游戏空间不一定能很好地调整大小。EG 当游戏宽度加倍时，左/右箭头键是否应该使船快两倍？垂直拉伸窗口是否会增加重力或射击速度？

### 填充游戏空间

按照我阅读问题的方式，您只是希望将游戏空间置于窗口的中心。可以在[这个答案](https://stackoverflow.com/a/7181197/418556)中看到 EG 。

![](../Images/c058125e61cbffae7a1f5014b1bc0aa9.png)

### 修复顶级容器的大小。

许多游戏固定大小以避免第一种方法产生的问题类型，并避免第二种方法周围的“大空白带”。这就像调用一样简单[`setResizable(false)`](http://docs.oracle.com/javase/7/docs/api/java/awt/Frame.html#setResizable%28boolean%29)。

为了使这项技术发挥最佳效果：

1.  确保进行游戏渲染的组件具有首选大小集。
2.  将它（和所有其他控件）添加到框架中。
3.  调用`frame.pack()`以确保框架的大小适合显示内容。
4.  （最后）打电话`frame.setResizable(false)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T01:30:01.620

要拉伸游戏，首先将其渲染到`Image`. 然后在立即拉伸图像的同时绘制图像。

```
Image dbImage; // The backbuffer
graphics.drawImage(dbImage, 0, 0, getWidth(), getHeight()); 
```

大多数游戏更喜欢禁用窗口大小调整以及我的引擎。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T01:25:43.990

根据我对您的问题的理解，您希望将游戏“延伸”到边界之外并将其扩展到窗口的其余部分。（如果那是错误的，哎呀：s）

为了做到这一点，你必须做出一些决定。您可以将整个游戏缩放到框架，或者只是扩展背景。但是，根据您想要进入的方向，您将不得不做不同的事情。

最后，这个决定完全取决于你。

另外你用什么来创建窗口？

# ssh - 使用 VisualVM 和 SSH 远程监控 Tomcat 7 服务器

> ID：12310545
> 
> 赞同：5
> 
> 时间：2012-09-07T01:18:51.217
> 
> 标签：ssh, tomcat7, jmx, visualvm

抱歉，如果这是重复之前提出的问题，但我已经尝试了此处和其他地方提供的解决方案，但似乎没有一个对我有用。

**场景**：我需要分析位于防火墙后面的生产 Tomcat 7 服务器。我只能通过 SSH 访问此服务器。选择的分析工具是 Visualvm，这些服务器没有安装 GUI。我尝试从运行 Ubuntu 10.04 服务器 LTS 连接的服务器和机器。

**可能的解决方案**：似乎可以通过 SSH 隧道使用 visualvm，下面给出的链接提供了非常详细的指南：

[Tomcat+VisualVM+SSH 指南](https://www.liferay.com/web/thiago.moreira/blog/-/blogs/how-to-monitor-liferay-tomcat-remotely-through-firewalls-using-visualvm)

此外，我还在 Tomcat 的 /conf 目录中添加了一个 jmxremote.access 文件，其中包含以下两行：

```
monitorRole readonly
controlRole readwrite 
```

**问题**：我按照文章中提供的步骤进行操作，一切似乎都很好。我可以使用 jmxterm 和指南中给出的连接字符串在本地（从服务器）连接到服务器中的 jmx 端口。

我按照指南配置了本地 tomcat 作为测试，Visualvm 使用连接字符串连接到这个 tomcat 实例没有问题。

但是，VisualVM 不会通过 SSH 隧道连接到远程服务器。我尝试了 JConsole，因为它更简单并且具有更好的日志记录工具，并且我收到以下消息序列：

```
FINER: [javax.management.remote.rmi.RMIConnector: jmxServiceURL=service:jmx:rmi://localhost:12009/jndi/rmi://localhost:12008/jmxrmi]  connecting...
FINER: [javax.management.remote.rmi.RMIConnector: jmxServiceURL=service:jmx:rmi://localhost:12009/jndi/rmi://localhost:12008/jmxrmi] finding stub...
FINER: [javax.management.remote.rmi.RMIConnector: jmxServiceURL=service:jmx:rmi://localhost:12009/jndi/rmi://localhost:12008/jmxrmi] connecting stub...
FINER: [javax.management.remote.rmi.RMIConnector: jmxServiceURL=service:jmx:rmi://localhost:12009/jndi/rmi://localhost:12008/jmxrmi] getting connection...
FINER: [javax.management.remote.rmi.RMIConnector: jmxServiceURL=service:jmx:rmi://localhost:12009/jndi/rmi://localhost:12008/jmxrmi] failed to connect: java.rmi.NoSuchObjectException: no such object in table 
```

关于我在这里做错了什么的任何想法？任何帮助是极大的赞赏！

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T13:48:42.253

我认为您遇到的问题（参考文章并未真正解决）是 jmx-rmi，或者更具体地说，RMI 本身的工作方式。您的 Tomcat 服务器设置如下：

1.  创建了一个配置为连接到**localhost:12009**的 RMI 远程设备。
2.  在 localhost 上创建了一个 RMI 注册表，监听端口为**localhost:12008**。

当您在本地运行时，您在 RMI 注册表中查找存根，当您调用存根以发出 jmx 调用时，它连接到**localhost:12009**，没问题。

当您通过 SSH 远程运行时，我假设您已经从远程隧道连接到端口 12008 上的 tomcat 服务器，因此当您发出请求时，您的*远程* `localhost:12008`是隧道连接`tomcatServer:12008`的，因为日志输出似乎表明您找到了 stub ok。

接下来，您的远程对存根执行，而存根又尝试连接`localhost:12009`并失败。

我的猜测是，您需要通过隧道将远程的 localhost:12008*和*localhost:12009 重定向到 tomcatServer:12008*和*tomcatServer:12009。

解决这个问题的另一种方法是放弃 RMI jmx 协议并使用[Jolokia](http://www.jolokia.org/) (HTTP)、[JMX-WS](https://blogs.oracle.com/jmxnetbeans/entry/j2ee_deployment_of_jmx_ws) (HTTP WebService) 或[JMXMP](http://docs.oracle.com/javase/1.5.0/docs/guide/jmx/overview/connectors.html) (Socket) 之类的东西。这将使您的 SSH 调谐生活变得更加轻松。如果您想尝试 JMXMP，我创建了一个名为[OpenDMK](https://github.com/nickman/OpenDMK)的 github 项目，该项目具有 mavenized 构建。您将需要[jmx-optional](https://github.com/nickman/OpenDMK/tree/master/OpenDMK/jmx-optional)包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-24T06:23:50.767

谢谢你的提问！——我有同样的基本需求。抱歉，我实际上并没有在这里添加任何新内容，但我想我会提到您提供的参考： [https ://www.liferay.com/web/thiago.moreira/blog/-/blogs/how-to-monitor- liferay-tomcat-remotely-through-firewalls-using-visualvm](https://www.liferay.com/web/thiago.moreira/blog/-/blogs/how-to-monitor-liferay-tomcat-remotely-through-firewalls-using-visualvm) 立即为我工作（仅与更新版本相关的非常小的调整——Tomcat 7 和 VisualVM 1.3.8）。在我的例子中，Tomcat 在 CentOS 6.6 上运行，监控机器是 Mac（也许这可以帮助其他人）。再次感谢。

# php - 将结果从 Sql 转换为 Json

> ID：12310552
> 
> 赞同：0
> 
> 时间：2012-09-07T01:20:18.783
> 
> 标签：php, sql, json

我有这个代码 php

```
$query2 = "SELECT * FROM hosts where cod='$stream'";
    $result2=mysql_query($query2);
    while ($row2=mysql_fetch_array($result2)) 
    {
$audio=$row2['audio'];
$def=$row2['def'];
$hosty=$row2['host'];   
    } 
```

我如何以这种格式将结果转换为 json ：

```
var sources = {"english":{"360":["bayfiles","filebox","zalaa","cramit"],"720":["cramit","180upload"]},"portugues":{"1080p":["zalaa","cramit"],"720":["cramit","180upload"]}} 
```

有可能吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T02:09:44.047

如果要创建包含所有查询的输出数组，则应使用辅助数组来获取每一行。

```
 $arrayAux=array();
 $query2 = "SELECT * FROM hosts where cod='$stream'";
    $result2=mysql_query($query2);
    while ($row2=mysql_fetch_array($result2,MYSQL_ASSOC)) 
    {
        $audio=$row2['audio'];
        $def=$row2['def'];
        $hosty=$row2['host'];  
        push_array(array("audio"=>$audio,"def"=>$def,"host"=>$hosty)); 
    }
  print(json_encode($arrayAux)); 
```

PS：我不明白您是要删除所有查询还是仅应用于一个查询。如果只有一个：

1.  消除arrayAux。
2.  消除了一段时间。
3.  并直接制作一个`print (json_encode (mysql_fetch_array ($ query2, MYSQL_ASSOC)));`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T01:21:59.670

您可以使用 PHP 函数[json_encode()](http://www.php.net/manual/en/function.json-encode.php)并将其传递到与您想要的格式匹配的数组中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T01:23:41.573

是的，这可以通过使用 PHP 的 [`json_encode()`](http://www.php.net/manual/en/function.json-encode.php)函数来实现。

> **json_encode** — 返回值的 JSON 表示

但是，为了获得多维对象，您可能必须执行更多查询，或者可能迭代您从第一个查询中获得的一些值。然后，您将在多维 PHP 数组中构建数据并`json_encode()`在整个对象上执行该函数。

```
$arr = array(
  'a' => 1, 
  'b' => 2, 
  'c' => array(
    'd'=>3,
    'e'=>4
  )
);

echo json_encode($arr);

{
  "a":1,
  "b":2,
  "c":{ 'd':3,"e":4}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T01:22:29.423

使用[`json_encode()`](http://php.net/manual/en/function.json-encode.php)：

```
echo json_encode($arr); 
```

# c# - ZeroMQ 模式用于 1 到 N，在客户端重试并为服务器连接知识

> ID：12310561
> 
> 赞同：2
> 
> 时间：2012-09-07T01:21:17.713
> 
> 标签：c#, zeromq

我一直在阅读有关所有可用模式的 ZGuide。我正在尝试将其转换为 C# GUI 环境，其中服务器和客户端需要位于与 GUI 和主要业务规则不同的线程中。

我发现懒惰的海盗示例非常有用，但是我不完全理解适合以下需求的 ZMQ 的一般模式。

*   客户

    *   向服务器发送带有确认的消息
    *   从服务器获取有关业务状态的消息
    *   具有重试逻辑和失败逻辑，以警告最终用户服务器“断开连接”或“失败”
*   服务器

    *   接收客户端消息和响应并确认
    *   根据内部状态发送额外消息
    *   对客户端重试逻辑的响应（可能是保持活动消息）
    *   具有基于接收到的保持活动消息的已知“已连接”客户端列表

目前，我对应该连接到其他人的套接字感到困惑。然后添加到这个我必须在线程边界中保留的内容。

我现在的位置如下；

|客户端 - 重试 - 请求| -> |REP - KeepAlive - 服务器|

我在示例中看到的是服务器无法将消息定向到已连接的客户端。存储所有连接客户端的地址并允许从服务器发送到这些特定客户端是否有技巧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T02:33:49.523

是的，您可以存储所有已知客户端的地址（身份）并将心跳从服务器发送到每个客户端。在服务器中使用 ROUTER。再次阅读第 3 章和第 4 章，直到它们更有意义。

# java - Java协议设计

> ID：12310571
> 
> 赞同：1
> 
> 时间：2012-09-07T01:22:34.453
> 
> 标签：java, tcp, rfc

我计划为一些 IETF 草案部署一个版本，并且需要一些代码参考或指导。我熟悉基本的 TCP 套接字，但想知道如何将需求转换为代码。

示例：[会话发起协议 (SIP) 通用日志格式 (CLF) 的格式](http://tools.ietf.org/id/draft-salgueiro-sipclf-indexed-ascii-03.txt)

想看看怎么翻译：

```
 0          7 8        15 16       23 24         31
  +-----------+-----------+-----------+-----------+
  |  Version  |           Record Length           | 0 - 3
  +-----------+-----------+-----------+-----------+

   Version (1 byte):  0x41 for this document; hexadecimal encoded.

   Record Length (6 bytes):  Hexadecimal encoded total length of this
  log record, including "Flags" and "Record Length" fields, and
  terminating line-feed. 
```

成代码。如何定义版本？哪种类型？整数，字符等？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:35:55.217

您的主要工具将是`DataOutputStream`. 它处理所有原始类型并为您处理网络字节排序。`DataInputStream`在接收器处。您的`Version`字段将使用`write()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T01:36:05.483

您会遇到一些问题，因为 Java 不包含任何无符号类型，您也可能会遇到字节序问题（Java 始终是大字节序）。如果协议规范规定存在一个 16 位无符号整数字段，那么您会将值保存在一个 32 位有符号整数中，并按每个字节将原始字节写入（或读取）网络流。请注意，InputStream 的`read()`方法将单个字节作为`int`值返回。

这是我阅读您的示例的方式：

```
InputStream stream = getNetworkInputStream();
int version = stream.read();

int recordLength0 = stream.read();
int recordLength1 = stream.read();
int recordLength2 = stream.read();
int recordLength3 = stream.read();

long recordLength = recordLength0 << 24 | recordLength1 << 16 | recordLength2 << 8 | recordLength; // perform the bitwise OR of all four values 
```

写作稍微痛苦一些。`byte`如果您确实在内部使用该类型，因为它已签名，请小心。

```
int version; long recordLength;

OutputStream stream = getNetworkOutputStream();
stream.write( version ); // the write(int) method only writes the low 8 bits of the integer value and ignores the high 24 bits.

stream.write( recordLength >> 24 ); // shift the recordLength value to the right by 8 bits
stream.write( recordLength >> 16 );
stream.write( recordLength >>  8 );
stream.write( recordLength       ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T01:39:31.290

使用[ByteBuffer](http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html)将字节转换为单个变量。它可以为您处理字节顺序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T05:00:19.383

我建议不要从头开始编写，而是使用[Jboss Netty](https://netty.io/)、[Apache Mina](http://mina.apache.org/)或[Grizzly](http://grizzly.java.net/)等应用程序。它们专门针对高性能协议开发。

这是一个用于支持 SIP 的 Grizzly[示例。](http://jfarcand.wordpress.com/2008/02/12/writing-a-tcpudp-stack-supporting-the-sip-protocol-using-the-grizzly-framework/)

# gwt - GWT CellTable 种群

> ID：12310572
> 
> 赞同：-2
> 
> 时间：2012-09-07T01:22:35.513
> 
> 标签：gwt, gwt-rpc, gwt-celltable

我想通过 RPC 调用使用来自数据库的数据填充单元表。有人可以给我一个示例应用程序来演示这一点（端到端流程）。我有点困惑，我对此很陌生。谢谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T07:37:37.223

我在开始使用 CellTable 时遇到了同样的问题。在我的例子中，我必须用不同的数据类型填充 CellTable 来表示具有 x 和 y 坐标的数据点。

我的解决方案是创建一个接口并将实现此接口的对象提供给 CellTable： **接口：**

```
 public interface IsDataTablePresentable {
       public String xValue();
       public String yValue();
    } 
```

**和 CellTable 的实例：**

```
 final CellTable<IsDataTablePresentable> dataTable = new CellTable<IsDataTablePresentable>(); 
```

**然后根据数据类型创建列，在我的例子中是一个 TextColumn，将相应的 x 值表示为字符串：**

```
 TextColumn<IsDataTablePresentable> xValueColumn = new TextColumn<IsDataTablePresentable>() {
        @Override
        public String getValue(IsDataTablePresentable object) {
            return object.xValue();
        }
    };
    dataTable.addColumn(xValueColumn, "the x-axis title"); 
```

y 值的代码看起来相同，除了我采用 y 值；）

**之后，将数据添加到 CellTable：**

```
 dataTable.setRowData(0, (ArrayList<IsDataTablePresentable>) <your field or RPC-returned ArrayList or whatever here!> ); 
```

就是这样！

**编辑：实现 IsDataTablePresentable 的类的示例：**

```
 public class timeData implements IsSerializable, IsDataTablePresentable {
    ...
       public String xValue() {
          return ""+this.time.getDate() + "." + (this.time.getMonth()+1) + "." + (this.time.getYear()+1900);
       }

       public String yValue() {
          return this.value.toString();
       }
    ...
    } 
```

**为了与服务器通信，我建议阅读 DevGuide 中的这篇文章，它也对我有帮助：** [与服务器通信 - Google Web Toolkit](https://developers.google.com/web-toolkit/doc/2.4/DevGuideServerCommunication)

# django - django 数据库作为芹菜经纪人提供连接被拒绝错误

> ID：12310575
> 
> 赞同：5
> 
> 时间：2012-09-07T01:22:56.373
> 
> 标签：django, celery, django-celery

我正在尝试按照[http://docs.celeryproject.org/en/latest/django/first-steps-with-django.html](http://docs.celeryproject.org/en/latest/django/first-steps-with-django.html)上的说明使 celery 与 django 一起使用。

至于经纪人，我正在尝试按照[http://docs.celeryproject.org/en/latest/getting-started/brokers/django.html#broker-django](http://docs.celeryproject.org/en/latest/getting-started/brokers/django.html#broker-django)上的说明设置 django 数据库。

我可以成功启动一个工人，如下所示：

```
*****-MacBook-Air:celeryproject *****$ python manage.py celery worker -E --loglevel=info /Library/Python/2.7/site-packages/django_celery-3.0.9-py2.7.egg/djcelery/loaders.py:124:
UserWarning: Using settings.DEBUG leads to a memory leak, never use
this setting in production environments!   warnings.warn("Using
settings.DEBUG leads to a memory leak, never "    --------------
celery@*****-MacBook-Air.local v3.0.9 (Chiastic Slide)  
---- **** -----   
--- * ***  * -- [Configuration]  
-- * - **** --- . broker:      django://localhost//  
- ** ---------- . app:         default:0x10b785fd0 (djcelery.loaders.DjangoLoader)  
- ** ---------- . concurrency: 4 (processes)  
- ** ---------- . events:      ON  
- ** ----------   
- *** --- * --- [Queues]   
-- ******* ---- . celery:      exchange:celery(direct) binding:celery  
--- ***** -----   

[Tasks]     . celeryapp.tasks.add  

[2012-09-06 20:03:23,711: WARNING/MainProcess] celery@*****-MacBook-Air.local has started.
[2012-09-06 20:03:24,406: WARNING/PoolWorker-3] /Library/Python/2.7/site- 
packages/django_celery-3.0.9-py2.7.egg/djcelery/loaders.py:124: UserWarning: Using settings.DEBUG leads to a memory leak, never use this setting in production environments!
warnings.warn("Using settings.DEBUG leads to a memory leak, never "
[2012-09-06 20:03:24,406: WARNING/PoolWorker-1] /Library/Python/2.7/site-packages/django_celery-3.0.9-py2.7.egg/djcelery/loaders.py:124: UserWarning: Using
settings.DEBUG leads to a memory leak, never use this setting in production environments!
warnings.warn("Using settings.DEBUG leads to a memory leak, never "
[2012-09-06 20:03:24,406: WARNING/PoolWorker-2] /Library/Python/2.7/site-packages/django_celery-3.0.9-py2.7.egg/djcelery/loaders.py:124: UserWarning: Using
settings.DEBUG leads to a memory leak, never use this setting in production environments!
warnings.warn("Using settings.DEBUG leads to a memory leak, never " 
```

[2012-09-06 20:03:24,406: WARNING/PoolWorker-4] /Library/Python/2.7/site-packages/django_celery-3.0.9-py2.7.egg/djcelery/loaders.py:124: UserWarning : 使用 settings.DEBUG 会导致内存泄漏，千万不要在生产环境中使用这个设置！warnings.warn("使用 settings.DEBUG 会导致内存泄漏，永远不要"

但是当我继续按照说明并调用在入门步骤中创建的添加任务时，我遇到了以下错误：

```
Python 2.7.1 (r271:86832, Jul 31 2011, 19:30:53)   
[GCC 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00)] on darwin  
Type "help", "copyright", "credits" or "license" for more information.  
>>> from celeryapp.tasks import add  
>>> add.delay(2,2)  
Traceback (most recent call last):  
  File "<stdin>", line 1, in <module>  
  File "/Library/Python/2.7/site-packages/celery-3.0.9-py2.7.egg/celery/app/task.py", line   343, in delay  
    return self.apply_async(args, kwargs)  
  File "/Library/Python/2.7/site-packages/celery-3.0.9-py2.7.egg/celery/app/task.py", line   458, in apply_async  
    with app.producer_or_acquire(producer) as P:  
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 17, in __enter__  
    return self.gen.next()  
  File "/Library/Python/2.7/site-packages/celery-3.0.9-py2.7.egg/celery/app/base.py", line 256, in producer_or_acquire  
    with self.amqp.producer_pool.acquire(block=True) as producer:  
  File "/Library/Python/2.7/site-packages/kombu-2.4.5-py2.7.egg/kombu/connection.py", line  712, in acquire
    R = self.prepare(R)  
  File "/Library/Python/2.7/site-packages/kombu-2.4.5-py2.7.egg/kombu/pools.py", line 54, in prepare  
    p = p()  
  File "/Library/Python/2.7/site-packages/kombu-2.4.5-py2.7.egg/kombu/pools.py", line 45, in <lambda>  
    return lambda: self.create_producer()  
  File "/Library/Python/2.7/site-packages/kombu-2.4.5-py2.7.egg/kombu/pools.py", line 42, in create_producer  
    return self.Producer(self._acquire_connection())  
  File "/Library/Python/2.7/site-packages/celery-3.0.9-py2.7.egg/celery/app/amqp.py", line 160, in __init__  
    super(TaskProducer, self).__init__(channel, exchange, *args, **kwargs)  
  File "/Library/Python/2.7/site-packages/kombu-2.4.5-py2.7.egg/kombu/messaging.py", line 83, in __init__  
    self.revive(self.channel)  
  File "/Library/Python/2.7/site-packages/kombu-2.4.5-py2.7.egg/kombu/messaging.py", line 174, in revive
    channel = self.channel = maybe_channel(channel)  
  File "/Library/Python/2.7/site-packages/kombu-2.4.5-py2.7.egg/kombu/connection.py", line 886, in maybe_channel  
    return channel.default_channel  
  File "/Library/Python/2.7/site-packages/kombu-2.4.5-py2.7.egg/kombu/connection.py", line 624, in default_channel  
    self.connection  
  File "/Library/Python/2.7/site-packages/kombu-2.4.5-py2.7.egg/kombu/connection.py", line 617, in connection  
    self._connection = self._establish_connection()  
  File "/Library/Python/2.7/site-packages/kombu-2.4.5-py2.7.egg/kombu/connection.py", line 576, in _establish_connection  
    conn = self.transport.establish_connection()  
  File "/Library/Python/2.7/site-packages/kombu-2.4.5-py2.7.egg/kombu/transport/amqplib.py", line 344, in establish_connection  
    connect_timeout=conninfo.connect_timeout)  
  File "/Library/Python/2.7/site-packages/kombu-2.4.5-py2.7.egg/kombu/transport/amqplib.py", line 154, in __init__  
    super(Connection, self).__init__(*args, **kwargs)  
  File "build/bdist.macosx-10.7-intel/egg/amqplib/client_0_8/connection.py", line 129, in __init__  
  File "build/bdist.macosx-10.7-intel/egg/amqplib/client_0_8/transport.py", line 281, in create_transport  
  File "build/bdist.macosx-10.7-intel/egg/amqplib/client_0_8/transport.py", line 85, in __init__  
socket.error: [Errno 61] Connection refused 
```

基本上，这个应用程序似乎无法与我的经纪人设置传输。

以下是我的 settings.py 的片段：

```
# Django settings for celeryproject project.
import djcelery
djcelery.setup_loader()

## Broker settings.
BROKER_URL= 'django://'
BROKER_BACKEND = "djkombu.transport.DatabaseTransport"

# List of modules to import when celery starts.
CELERY_IMPORTS = ("celeryapp.tasks", )

## Using the database to store task state and results.
#CELERY_RESULT_BACKEND = "database"
#CELERY_RESULT_DBURI = "sqlite:///mydatabase.db"

CELERY_ANNOTATIONS = {"tasks.add": {"rate_limit": "10/s"}}

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'celeryapp',
    'djcelery',
    #'djcelery.transport',
    'kombu.transport.django',
    # Uncomment the next line to enable the admin:
    # 'django.contrib.admin',
    # Uncomment the next line to enable admin documentation:
    # 'django.contrib.admindocs',
) 
```

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T01:46:10.620

尝试添加

```
import djcelery
djcelery.setup_loader() 
```

在您的代理和后端配置之后，也根据[https://devcenter.heroku.com/articles/django#running-a-worker](https://devcenter.heroku.com/articles/django#running-a-worker)指南，mb 您需要更改 INSTALLED_APPS 订单

```
'kombu.transport.django',
'djcelery' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T18:24:03.890

问题似乎是，当从交互式 shell 中对任务进行排队时，这些说明会给您留下一个未配置的加载程序。

如果你遇到了传输问题，你会在运行 celery 服务器时收到错误，而不是在排队任务时。

这对我有用：

```
>>> import djcelery
>>> djcelery.setup_loader()
>>> from myapp.tasks import add
>>> add.delay(2,2)
<AsyncResult: d43a673a-c2a5-4116-b60e-c59afa7dff51>
>>> result = add.delay(4,5)
>>> result.ready()
True
>>> result.result
9
>>> result.get()
9
>>> result.successful()
True 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-25T14:34:46.530

以前的答案应该可以正常工作。但是我`connection refused`在 django 项目中遇到了同样的错误，这是因为我忘记将 celery 设置放在 settings.py 中。要解决此问题，只需在 settings.py 中添加以下设置：

```
# CELERY SETTINGS
BROKER_URL = 'redis://localhost:6379/0'
CELERY_ACCEPT_CONTENT = ['json']
CELERY_TASK_SERIALIZER = 'json'
CELERY_RESULT_SERIALIZER = 'json' 
```

# android - 遍历Android中的指定目录

> ID：12310577
> 
> 赞同：12
> 
> 时间：2012-09-07T01:23:12.417
> 
> 标签：android, file, loops

我正在尝试在 Android 上开发一个安全应用程序，并且我想遍历特定目录的文件名，以便我可以比较目录中每个文件的哈希值。

我已经找到了如何进行散列，但是对于迭代部分，我对它的工作原理感到困惑。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-09-07T01:28:18.420

你的意思是你想递归地遍历一个目录？

像这样的东西：

```
 public void traverse (File dir) {
       if (dir.exists()) {
        File[] files = dir.listFiles();
        if (files != null) {

        for (int i = 0; i < files.length; ++i) {
            File file = files[i];
            if (file.isDirectory()) {
                traverse(file);
            } else {
                // do something here with the file
            }
        }
      }
     }
    } 
```

# php - PHP将文件上传到多个文件夹

> ID：12310580
> 
> 赞同：0
> 
> 时间：2012-09-07T01:23:24.710
> 
> 标签：php, file-upload, upload, copy

我确信对此有一个非常直接的答案，但我是 PHP 新手，找不到可以开始工作的答案。基本上我有一个带有文件上传的 PHP 表单，需要将图像发送到两个文件夹。告诉图像存储位置的当前代码如下：

```
$savepath = JPATH_SITE.DS.'images'.DS.'site'.DS.'cache'; 
```

然后上传图片后：

```
$handle->Process($savepath); 
```

作为上传过程的一部分，是否有一种简单的方法可以将文件复制到另一个文件夹？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T01:24:57.777

```
$file = "/path/to/orig/file";
$newfile = "/path/to/dest/file";
copy($file, $newfile); 
```

根据需要多次重复该`copy()`命令以复制到多个目录。

祝你好运！

# android - 更多的日食疯狂。更改布局文件将 TextViews 变成 LinearLayouts

> ID：12310588
> 
> 赞同：0
> 
> 时间：2012-09-07T01:24:55.427
> 
> 标签：android, eclipse, adt

刚刚对我的 layout.xml 进行了更改，一切都可以编译，然后我收到一个奇怪的错误，说不能将 TextView 转换为 ImageView。另一个更改，我收到一个奇怪的错误，说不能将相同的 TextView 转换为 LinearLayout ？？？事实证明，尽管一切都可以正常编译，但有时如果你不做一个干净的项目，你的 TextView 小部件可能只是指向一个相对布局！！！有谁知道为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:40:30.163

所以这就是为什么：

您可能已经在文件夹中看到了`R.java`该`gen`文件。

打开那个文件。

它包含所有（R）资源的内存地址和标识符。

当您更改布局文件时，这些内存地址会过时并指向错误的视图元素。clean/build 将删除 R.java 文件并重新创建它，这是更改视图后的必要步骤。

# c# - 无法在数据库中添加记录

> ID：12310590
> 
> 赞同：0
> 
> 时间：2012-09-07T01:25:38.530
> 
> 标签：c#, asp.net, telerik

我有这个表格，当我点击保存客户时，它
会添加记录，它将被添加到数据库中并在 gridview 上显示添加记录。
gridview 连接在数据库上。（gridview没有
问题。）

这是我的问题..
单击按钮后，我无法在数据库中添加记录。
我认为问题出在后面的代码中。

谁能帮我我的代码有什么问题？

默认.aspx

```
<body>
    <form id="form1" runat="server">
    <telerik:RadScriptManager ID="RadScriptManager1" runat="server">
        <Scripts>
            <%--Needed for JavaScript IntelliSense in VS2010--%>
            <%--For VS2008 replace RadScriptManager with ScriptManager--%>
            <asp:ScriptReference Assembly="Telerik.Web.UI" Name="Telerik.Web.UI.Common.Core.js" />
            <asp:ScriptReference Assembly="Telerik.Web.UI" Name="Telerik.Web.UI.Common.jQuery.js" />
            <asp:ScriptReference Assembly="Telerik.Web.UI" Name="Telerik.Web.UI.Common.jQueryInclude.js" />
        </Scripts>
    </telerik:RadScriptManager>

    <script type="text/javascript">
        //Put your JavaScript code here.
    </script>

    <telerik:RadAjaxManager ID="RadAjaxManager1" runat="server">
    </telerik:RadAjaxManager>
    <div>
        <div id="padding-left">
        <br />
            <div id="border">
                <div style="float: none; height: 30px; padding-bottom: 3px;">
                    <div class="padLabel" style="float: left; width: 100px; padding-top: 3px;">Customer ID:</div>
                    <div style="float: none;">
                        <telerik:RadTextBox ID="txtCustomerID" runat="server" Enabled="false" />                    
                    </div>
                </div>

                <div style="float: none; height: 30px;">
                    <div class="padLabel" style="float: left; width: 100px; padding-top: 3px;">First Name:</div>
                    <div style="float: none;">
                        <telerik:RadTextBox ID="txtFirstName" runat="server" />
                    </div>
                </div>

                <div style="float: none; height: 30px;">
                    <div class="padLabel" style="float: left; width: 100px; padding-top: 3px;">Middle Name:</div>                    
                    <div style="float: none;">
                        <telerik:RadTextBox ID="txtMiddleName" runat="server" />
                    </div>
                </div>

                <div style="float: none; height: 30px;">
                    <div class="padLabel" style="float: left; width: 100px; padding-top: 3px;">Last Name:</div>
                    <div style="float: none;">
                        <telerik:RadTextBox ID="txtLastName" runat="server" />
                    </div>
                </div>

                <div style="float: none; height: 30px;">
                    <div class="padLabel" style="float: left; width: 100px; padding-top: 3px;">Address:</div>
                    <div style="float: none;">    
                        <telerik:RadTextBox ID="txtAddress" runat="server" />
                    </div>
                </div>

                <div style="float: none; height: 30px;">
                    <div class="padLabel" style="float: left; width: 100px; padding-top: 3px;">Contact Number:</div>
                    <div style="float: none;">
                        <telerik:RadTextBox ID="txtContactNumber" runat="server" />
                    </div>
                </div>

                <div style="float: none; height: 30px;">
                    <div class="padLabel" style="float: left; width: 100px; padding-top: 3px;">Birthday:</div>
                    <div style="float: none;">    
                        <telerik:RadDatePicker ID="dpBirthday" runat="server" />  
                    </div>
                </div>

                <div style="float: none; height: 30px;">
                    <div class="padLabel" style="float: left; width: 100px; padding-top: 3px;">Age:</div>
                    <div style="float: none;">    
                        <telerik:RadTextBox ID="txtAge" runat="server" />
                    </div>
                </div>        

                <div style="float: none; height: 30px;">
                    <div class="padLabel" style="float: left; width: 100px; padding-top: 3px;">Gender:</div>
                    <div style="float: none;">    
                        <telerik:RadTextBox ID="txtGender" runat="server" />
                    </div>
                </div>

                <div style="float: none; height: 30px;">
                <div class="padLabel">
                    <asp:Label runat="server" ID="InfoMessage" />
                </div>
                </div>

                <div style="float: none; height: 30px;">
                    <div class="padLabel" style="float: none;">
                        <telerik:RadButton ID="btnSaveCustomer" runat="server" Text="Add Customer" OnClick="btnSaveCustomer_Click" />
                    </div>
                </div>
            </div>
        </div>
        <div id="padding-innerleft">
            <br />
            <div align ="right">
            <telerik:RadButton runat="server" ID="btnLogut" Text="Logout" OnClick="btnLogut_Click" />
            </div>
            <br />
            <telerik:RadGrid ID="RadGrid1" runat="server" CellSpacing="0" DataSourceID="SqlDataSource1"
                GridLines="None">
                <HeaderContextMenu CssClass="GridContextMenu GridContextMenu_Default">
                </HeaderContextMenu>
                <MasterTableView AutoGenerateColumns="False" DataKeyNames="CustomerID" DataSourceID="SqlDataSource1">
                    <CommandItemSettings ExportToPdfText="Export to PDF"></CommandItemSettings>
                    <RowIndicatorColumn FilterControlAltText="Filter RowIndicator column">
                        <HeaderStyle Width="20px"></HeaderStyle>
                    </RowIndicatorColumn>
                    <ExpandCollapseColumn FilterControlAltText="Filter ExpandColumn column">
                        <HeaderStyle Width="20px"></HeaderStyle>
                    </ExpandCollapseColumn>
                    <Columns>
                        <telerik:GridBoundColumn DataField="CustomerID" DataType="System.Int32" FilterControlAltText="Filter CustomerID column"
                            HeaderText="CustomerID" ReadOnly="True" SortExpression="CustomerID" UniqueName="CustomerID">
                        </telerik:GridBoundColumn>
                        <telerik:GridBoundColumn DataField="FirstName" FilterControlAltText="Filter FirstName column"
                            HeaderText="FirstName" SortExpression="FirstName" UniqueName="FirstName">
                        </telerik:GridBoundColumn>
                        <telerik:GridBoundColumn DataField="MiddleName" FilterControlAltText="Filter MiddleName column"
                            HeaderText="MiddleName" SortExpression="MiddleName" UniqueName="MiddleName">
                        </telerik:GridBoundColumn>
                        <telerik:GridBoundColumn DataField="LastName" FilterControlAltText="Filter LastName column"
                            HeaderText="LastName" SortExpression="LastName" UniqueName="LastName">
                        </telerik:GridBoundColumn>
                        <telerik:GridBoundColumn DataField="Address" FilterControlAltText="Filter Address column"
                            HeaderText="Address" SortExpression="Address" UniqueName="Address">
                        </telerik:GridBoundColumn>
                        <telerik:GridBoundColumn DataField="Birthday" DataType="System.DateTime" FilterControlAltText="Filter Birthday column"
                            HeaderText="Birthday" SortExpression="Birthday" UniqueName="Birthday">
                        </telerik:GridBoundColumn>
                        <telerik:GridBoundColumn DataField="Age" DataType="System.Int32" FilterControlAltText="Filter Age column"
                            HeaderText="Age" SortExpression="Age" UniqueName="Age">
                        </telerik:GridBoundColumn>
                        <telerik:GridBoundColumn DataField="Gender" FilterControlAltText="Filter Gender column"
                            HeaderText="Gender" SortExpression="Gender" UniqueName="Gender">
                        </telerik:GridBoundColumn>
                        <telerik:GridBoundColumn DataField="ContactNumber" FilterControlAltText="Filter ContactNumber column"
                            HeaderText="ContactNumber" SortExpression="ContactNumber" UniqueName="ContactNumber">
                        </telerik:GridBoundColumn>
                    </Columns>
                    <EditFormSettings>
                        <EditColumn FilterControlAltText="Filter EditCommandColumn column">
                        </EditColumn>
                    </EditFormSettings>
                </MasterTableView>
                <FilterMenu EnableImageSprites="False">
                </FilterMenu>
            </telerik:RadGrid>
            <asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:conn %>"
                SelectCommand="SELECT [CustomerID], [FirstName], [MiddleName], [LastName], [Address], [Birthday], [Age], [Gender], [ContactNumber] FROM [v.NewCustomer]">
            </asp:SqlDataSource>
        </div>
    </div>
    </form>
</body> 
```

后面的代码

```
 public partial class Default : System.Web.UI.Page 
{
    SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["conn"].ConnectionString);

    protected void btnSaveCustomer_Click(object sender, EventArgs e)
    {
        SqlCommand cmd = new SqlCommand();
        cmd.Connection = conn;
        cmd.CommandText = "Insert into v.NewCustomer(FirstName, MiddleName, LastName, Address, Birthday, Age, Gender, ContactNumber) values (@FirstName, @MiddleName, @LastName, @Address, @Birthday, @Age, @Gender, @ContactNumber)";
        cmd.Parameters.AddWithValue("@FirstName", txtFirstName.Text);
        cmd.Parameters.AddWithValue("@MiddleName", txtMiddleName.Text);
        cmd.Parameters.AddWithValue("@LastName", txtLastName.Text);
        cmd.Parameters.AddWithValue("@Address", txtAddress.Text);
        cmd.Parameters.AddWithValue("@Birthday", dpBirthday.SelectedDate);
        cmd.Parameters.AddWithValue("@Age", txtAge.Text);
        cmd.Parameters.AddWithValue("@Gender", txtGender.Text);
        cmd.Parameters.AddWithValue("@ContactNumber", txtContactNumber.Text);
        cmd.CommandType = CommandType.Text;
        conn.Open();
        cmd.ExecuteNonQuery();

        //SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["conn"].ConnectionString);
        //SqlCommand com = new SqlCommand("NewCustomer", conn);
        //com.CommandType = CommandType.StoredProcedure;
        //SqlParameter p1 = new SqlParameter("@FirstName", txtFirstName.Text);
        //SqlParameter p2 = new SqlParameter("@MiddleName", txtMiddleName.Text);
        //SqlParameter p3 = new SqlParameter("@LastName", txtLastName.Text);
        //SqlParameter p4 = new SqlParameter("@Address", txtAddress.Text);
        //SqlParameter p5 = new SqlParameter("@Birthday", dpBirthday.SelectedDate);
        //SqlParameter p6 = new SqlParameter("@Age", txtAge.Text);
        //SqlParameter p7 = new SqlParameter("@Gender", txtGender.Text);
        //SqlParameter p8 = new SqlParameter("@ContactNumber", txtContactNumber.Text);
        //com.Parameters.Add(p1);
        //com.Parameters.Add(p2);
        //com.Parameters.Add(p3);
        //com.Parameters.Add(p4);
        //com.Parameters.Add(p5);
        //com.Parameters.Add(p6);
        //com.Parameters.Add(p7);
        //com.Parameters.Add(p8);
        //conn.Open();
        //com.ExecuteNonQuery();

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T14:29:28.513

要刷新`RadGrid`并查看新添加的行，请使用`Rebind()`：

```
RadGrid1.Rebind(); 
```

# android - 使用 setText 将 EditText 设置为 null

> ID：12310592
> 
> 赞同：2
> 
> 时间：2012-09-07T01:25:50.153
> 
> 标签：android, eclipse

我进行了搜索以查看如何清除 EditText 框，并找到了许多结果，都同意。我为盒子创建了一个变量：

```
final EditText fn = (EditText) findViewById(R.id.editText1); 
```

然后我就这样使用 setText ：

```
fn = setText(""); 
```

但是，当我在 Eclipse 中实现此代码时（安装了所有插件和 sdk），我收到错误消息：“方法 setText(String) 未定义新 View.OnClickListener() {} 类型”

我究竟做错了什么？是否有一些我在其他帖子中没有提到的步骤？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:04:10.493

为了完整起见：

这部分：

```
final EditText fn = (EditText) findViewById(R.id.editText1); 
```

是正确的，前提是您当前运行的 Activity 的布局包含 ID 为“editText1”的 EditText 的声明，这里是此类布局文件的示例。此布局文件称为“ **my_layout** ”：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayoutxmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>
</LinearLayout> 
```

在您的活动中，您必须在 onCreate 中调用此方法以将上述布局文件设置为活动的布局文件：

```
public abstract class MyActivity extends Activity {

   @Override
   protected void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);
         setContentView(R.layout.my_layout);
   } 
```

鉴于上述情况，您现在可以重置 EditText 中的文本（称为“fn” - 请参阅第一个代码片段）：

```
fn.setText(""); 
```

您遇到的错误说 OnClickListener 中不存在 setText 方法，这可能源于您尝试在该 OnClickListener 中调用 setText("")。正如错误消息所解释的： OnClickListener 对 setText 方法一无所知 - 只有 EditText 知道它，因此您需要在 EditText 的引用上调用 setText("")。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-04T08:30:22.477

看起来您是`setText`在 a 的代码中调用`Listener`。`"settext" = "this.settext"`在这种情况下， this 指向那个听众。尝试调用：

```
MyClassInWhichAllThisCodeIs.this.getThatEditTextRefference().setText(""). 
```

# php - 无法连接到 MySQL 服务器

> ID：12310593
> 
> 赞同：0
> 
> 时间：2012-09-07T01:25:58.453
> 
> 标签：php, mysql

所以我在我的服务器上收到了这个错误：

```
Can't connect to MySQL server on '50.57.95.218' (111) in eval() (line 12 of /var/www/public_html/modules/php/php.module(80) : eval()'d code). 
```

现在，据我所知，我的凭据是正确的。

我在 PHPMyAdmin 中有这个：

```
USERNAME    localhost    global  SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER, CREATE TEMPORARY TABLES, SHOW VIEW 
```

这也是在我的 Drupal settings.php 中设置的，但是，由于某种原因，我收到此错误并且无法登录该站点（尽管该站点显示完美）。

我该如何解决？有什么想法跳出来吗？

如果用户凭据正确，为什么无法连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T01:29:14.283

从错误消息来看，您的 MySQL 连接字符串可能指向您服务器的外部 IP 地址。如果 MySQL 服务器在同一台机器上，请将您的主机更改为“localhost”。

如果服务器确实在单独的机器上，请确保您的防火墙设置为允许端口 3306（默认 MySQL 端口）上的传入连接，并且您用于登录的用户具有从远程主机连接的权限.

# javascript - 如何通过选择器元素将图像添加到 javascript 下拉警报消息

> ID：12310596
> 
> 赞同：2
> 
> 时间：2012-09-07T01:26:31.277
> 
> 标签：javascript, image, message, alert

正如标题含糊不清的那样，我在使用选择器和元素将图像添加到警报消息集中时遇到问题？不太热衷于命名法，但这是我到目前为止所得到的：

```
function sendalert(alert)
{
    var img;
    img = document.createElement('img');
    img.scr = 'ico/sign_warning.gif';
    img.height = 16;
    img.width = 16;

    $('#alert').text(alert).slideDown('500', function() {
    $(this).delay(5000).slideUp('500')});
} 
```

基本上，我的页面顶部有一个 div，它 .slideDown 并将消息输入显示到函数 ($alert) 中。但是，由于我必须在我的标题中有向下滑动的 div，并且这个功能更向下 - 我必须使用 .text 来设置 div 输出。

纯文本输出目前工作正常（经过几个小时的反复试验）。我现在要做的是在错误文本前添加一个小错误图标。

我很难找到 .whatever 元素？但是从列表中我发现只有 .add 和 .load 对我很重要——我都试过了，但它们都不起作用。下面是我对 .add 的尝试（基本上对 .load 使用了相同的概念）

```
function sendalert(alert)
{
    var img;
    img = document.createElement('img');
    img.scr = 'ico/sign_warning.gif';
    img.height = 16;
    img.width = 16;

    $('#alert').add(img).text(alert).slideDown('500', function() {
    $(this).delay(5000).slideUp('500')});
} 
```

我感谢任何帮助，并希望我提供了足够的信息来传达我的问题，

谢谢！

编辑：陷入困境并修复

```
img.scr = '<img src="ico/sign_warning.gif" width="16" height="16"/>'; 
```

它应该是什么

```
img.scr = 'ico/sign_warning.gif'; 
```

无论如何，它并没有解决我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:39:02.963

你有几个问题。首先，`.add()`不是你要找的方法。您可能正在寻找`.append()`. 此外，当您设置`.text()`jQuery 对象时，它将覆盖任何其他内部标记（包括子元素）。因此，即使您切换到`.append()`，您仍然会遇到问题。

所以考虑到这一切，试试这个怎么样：

```
$('#alert').text("").append(img).append(text).slideDown('500', function() {
    $(this).delay(5000).slideUp('500');
}); 
```

关键是清除警报元素内的任何内容，然后附加图像，然后是警报文本。

可能会更好（并且更容易设置样式）是在警报元素内有一个固定的图标元素和一个固定的文本区域，然后明确设置它们。但这至少应该让你走上正轨。

# apache - mod_jk 失去与 tomcat 的连接

> ID：12310601
> 
> 赞同：8
> 
> 时间：2012-09-07T01:27:50.323
> 
> 标签：apache, tomcat, ajp

我当前的生产服务器在过去几天刚刚启动时遇到问题。我正在运行 apache httpd-2.2.3 和 tomcat-5.5.20，与 mod_jk v1.3 连接，并在 tomcat 上托管了一个 Spring MVC 站点。正在发生的事情是，在启动大约 12 小时后，该网站为我们的用户挂起。当这第一次发生时，我可以在 catalina.out 中看到以下几个错误

```
WARN [org.apache.jk.core.MsgContext] Error sending end packet
java.net.SocketException: Broken pipe 
```

在查看了这个之后，我了解到这意味着用户在请求完成之前取消了请求，因此返回路径已关闭，因此数据无法返回。从网上搜索看来，这可能会导致线程在 tomcat 中保持打开状态，直到达到超时。这似乎是有道理的，因为当 tomcat 倒下时，我在 catalina.out 日志的末尾

```
All threads (200) are currently busy, waiting. Increase maxThreads (200) or check the servlet status 
```

建议是对 apache httpd.conf 中的 JkModule 设置进行以下更改

```
JkOptions +DisableReuse 
```

我这样做是在确保它对我们的网站没有任何副作用并且第二天运行良好但昨天网站冻结时出现了相同的症状。然而这一次 catalina.out 中没有任何错误，我们只是停止通过 tomcat 接收请求。我可以从应用程序日志中看到它在 17:31 收到了最后一个请求，然后在 mod_jk.log 中我可以看到以下内容

```
[Thu Sep 06 17:37:07 2012] [18784:53792] [error] ajp_connection_tcp_get_message::jk_ajp_common.c (947): (worker1) can't receive the response message from tomcat, network problems or tomcat is down (127.0.0.1:8009), err=-104
[Thu Sep 06 17:37:07 2012] [18784:53792] [error] ajp_get_reply::jk_ajp_common.c (1536): (worker1) Tomcat is down or refused connection. No response has been sent to the client (yet) 
```

然后在我的 httpd error_log

```
[Thu Sep 06 17:38:39 2012] [error] server reached MaxClients setting, consider raising the MaxClients setting 
```

所以在我收到任何错误之前是 6 分钟，然后在最大客户端错误之前是 1 分钟 30 分钟。重新启动 tomcat 也解决了这个特殊问题。

除了我提到的（下面的当前配置）之外，我们的 apache、tomcat 或连接器配置没有任何更改，但我们对我们的站点进行了更改，以便为每个用户执行更多的 Ajax 请求。所以我想了解的是，我如何最好地分析我们的系统，以了解我可以做出哪些正确的设置更改，以确保我不会使我们的服务器超载，但确实阻止了这个问题的发生。

谢谢伊恩

当前配置

**httpd.conf**

```
Timeout 300
KeepAlive on
MaxKeepAliveRequests 100
KeepAliveTimeout 15

LoadModule jk_module modules/mod_jk.so
JkLogLevel    error
JkLogStampFormat "[%a %b %d %H:%M:%S %Y] "
JkOptions     +ForwardKeySize +ForwardURICompat -ForwardDirectories +DisableReuse 
```

**worker.properties**

```
# Define 1 real worker using ajp13
worker.list=worker1
# Set properties for worker1 (ajp13)
worker.worker1.type=ajp13
worker.worker1.host=localhost
worker.worker1.port=8009
worker.worker1.lbfactor=50
worker.worker1.cachesize=10
worker.worker1.cache_timeout=600
worker.worker1.socket_keepalive=1
worker.worker1.recycle_timeout=300 
```

**httpd-mpm.conf**

```
StartServers          5
MinSpareServers       5
MaxSpareServers      10
MaxClients          150 
MaxRequestsPerChild   0 
```

Tomcat 设置只是标准的 Tomcat 设置

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-12T00:40:15.900

原来答案是改变keepalive超时。为了阻止这种情况发生，我只需要将 KeepAliveTimeout 从 15 更改为 2 并添加 5000 的 MaxRequestsPerChild。我发现这阻止了这个问题再次发生

# php - mysql_fetch_array() 期望参数 1 是资源，布尔值

> ID：12310602
> 
> 赞同：0
> 
> 时间：2012-09-07T01:28:11.213
> 
> 标签：php

美好的一天，我遇到了上面所说的错误，我找不到合适的脚本。但这是发生错误的那一行。

```
$db = mysql_connect($mysql_server, $mysql_username, $mysql_password);
   mysql_select_db($mysql_database, $db);
   $sql = "SELECT password, fullname, active FROM ".$mysql_table." WHERE username = '".$_POST['username']."'";
   $result = mysql_query($sql, $db) or trigger_error ( mysql_error ( ) );
   if ($data = mysql_fetch_array($result))
   {
      if ($crypt_pass == $data['password'] && $data['active'] != 0)
      {
         $found = true;
         $fullname = $data['fullname'];
      }
      else die(mysql_error());
   }
   mysql_close($db);
   if($found == false)
   {
      header('Location: '.$error_page);
      exit;
   }
   else
   {
      session_start();
      $_SESSION['username'] = $_POST['username'];
      $_SESSION['fullname'] = $fullname;
      $rememberme = isset($_POST['rememberme']) ? true : false;
      if ($rememberme)
      {
         setcookie('username', $_POST['username'], time() + 3600*24*30);
         setcookie('password', $_POST['password'], time() + 3600*24*30);
      }
      header('Location: '.$success_page);
      exit;
   } 
```

顺便说一句，这是一个登录表单..

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T01:30:21.570

`($data = mysql_fetch_array($result))`

如果 $result 为空数据集，则会触发此错误。在执行此操作之前检查返回的行数是否 >0。

[**mysql_num_rows**](http://php.net/manual/en/function.mysql-num-rows.php)是您应该在尝试将其放入数组之前检查返回的行。

**此外，`mysql_*`不鼓励扩展。移动到[MySQLi](http://www.php.net/manual/en/book.mysqli.php)或[PDO_MySQL](http://www.php.net/manual/en/ref.pdo-mysql.php)，用于新项目。**

# android - Android - 如果在获取 JSON 数据时没有网络连接，则会发生 App Force Close

> ID：12310605
> 
> 赞同：1
> 
> 时间：2012-09-07T01:28:53.117
> 
> 标签：android, json

我正在使用异步任务在后台从网络获取 json 数据。这很好用，但是当没有网络连接时应用程序强制关闭。

以下是代码：

```
public class MainActivity extends Activity {

    public static final int DIALOG_DOWNLOAD_JSON_PROGRESS = 0;
    public static final int DIALOG_DOWNLOAD_FULL_PHOTO_PROGRESS = 1;
    private ProgressDialog mProgressDialog;

    ArrayList<HashMap<String, Object>> MyArrList;

    @SuppressLint("NewApi")
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // Permission StrictMode
        if (android.os.Build.VERSION.SDK_INT > 9) {
            StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
            StrictMode.setThreadPolicy(policy);
        }

        // Download JSON File   
        new DownloadJSONFileAsync().execute();

    }

    @Override
    protected Dialog onCreateDialog(int id) {
        switch (id) {
        case DIALOG_DOWNLOAD_JSON_PROGRESS:
            mProgressDialog = new ProgressDialog(this);
            mProgressDialog.setMessage("Downloading.....");
            mProgressDialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
            mProgressDialog.setCancelable(true);
            mProgressDialog.show();
            return mProgressDialog;
        case DIALOG_DOWNLOAD_FULL_PHOTO_PROGRESS:
            mProgressDialog = new ProgressDialog(this);
            mProgressDialog.setMessage("Downloading.....");
            mProgressDialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
            mProgressDialog.setCancelable(true);
            mProgressDialog.show();
            return mProgressDialog; 
        default:
            return null;
        }
    }

    // Show All Content
    public void ShowAllContent()
    {
        // listView1
        final ListView lstView1 = (ListView)findViewById(R.id.listView1); 
        lstView1.setAdapter(new ImageAdapter(MainActivity.this,MyArrList));

        // OnClick
        lstView1.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View v,
                int position, long id) {
                String strImageName = MyArrList.get(position).get("ImageName").toString();
                String strImagePathFull = MyArrList.get(position).get("ImagePathFull").toString();

                new DownloadFullPhotoFileAsync().execute(strImageName,strImagePathFull); // Download file Full Photo
            }
        });
    }

    // Show Dialog Popup 
    public void showDialogPopup(String strImageName,Bitmap ImageFullPhoto)
    {

        final AlertDialog.Builder imageDialog = new AlertDialog.Builder(this);
        final LayoutInflater inflater = (LayoutInflater) this.getSystemService(LAYOUT_INFLATER_SERVICE);

          View layout = inflater.inflate(R.layout.custom_fullimage_dialog,
                  (ViewGroup) findViewById(R.id.layout_root));
          ImageView image = (ImageView) layout.findViewById(R.id.fullimage);

             try
             {
                image.setImageBitmap(ImageFullPhoto);
             } catch (Exception e) {
                 // When Error
                image.setImageResource(android.R.drawable.ic_menu_report_image);
             }

          imageDialog.setIcon(android.R.drawable.btn_star_big_on);  
          imageDialog.setTitle("View : " + strImageName);
          imageDialog.setView(layout);
          imageDialog.setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener(){

              public void onClick(DialogInterface dialog, int which) {
                  dialog.dismiss();
              }

          });

          imageDialog.create();
          imageDialog.show(); 

    }

    public class ImageAdapter extends BaseAdapter 
    {
        private Context context;
        private ArrayList<HashMap<String, Object>> MyArr = new ArrayList<HashMap<String, Object>>();

        public ImageAdapter(Context c, ArrayList<HashMap<String, Object>> myArrList) 
        {
            // TODO Auto-generated method stub
            context = c;
            MyArr = myArrList;
        }

        public int getCount() {
            // TODO Auto-generated method stub
            return MyArr.size();
        }

        public Object getItem(int position) {
            // TODO Auto-generated method stub
            return position;
        }

        public long getItemId(int position) {
            // TODO Auto-generated method stub
            return position;
        }
        public View getView(int position, View convertView, ViewGroup parent) {
            // TODO Auto-generated method stub

            LayoutInflater inflater = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

            if (convertView == null) {
                convertView = inflater.inflate(R.layout.activity_column, null); 
            }

            // ColImage
            ImageView imageView = (ImageView) convertView.findViewById(R.id.ColImgPath);
            imageView.getLayoutParams().height = 80;
            imageView.getLayoutParams().width = 80;
            imageView.setPadding(5, 5, 5, 5);
            imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
             try
             {
                 imageView.setImageBitmap((Bitmap)MyArr.get(position).get("ImageThumBitmap"));
             } catch (Exception e) {
                 // When Error
                 imageView.setImageResource(android.R.drawable.ic_menu_report_image);
             }

            // ColImgID
            TextView txtImgID = (TextView) convertView.findViewById(R.id.ColImgID);
            txtImgID.setPadding(10, 0, 0, 0);
            txtImgID.setText("ID : " + MyArr.get(position).get("ImageID").toString());

            // ColImgName
            TextView txtPicName = (TextView) convertView.findViewById(R.id.ColImgName);
            txtPicName.setPadding(50, 0, 0, 0);
            txtPicName.setText("Name : " + MyArr.get(position).get("ImageName").toString());    

            return convertView;

        }

    } 

    // Download JSON in Background
    public class DownloadJSONFileAsync extends AsyncTask<String, Void, Void> {

        protected void onPreExecute() {
            super.onPreExecute();
            showDialog(DIALOG_DOWNLOAD_JSON_PROGRESS);
        }

        @Override
        protected Void doInBackground(String... params) {       
            String url = "http://XXX.com.xxp";

            JSONArray data;
            try {
                data = new JSONArray(getJSONUrl(url));

                MyArrList = new ArrayList<HashMap<String, Object>>();
                HashMap<String, Object> map;

                for(int i = 0; i < data.length(); i++){
                    JSONObject c = data.getJSONObject(i);
                    map = new HashMap<String, Object>();
                    map.put("ImageID", (String)c.getString("ImageID"));
                    map.put("ImageName", (String)c.getString("ImageName"));

                    // Thumbnail Get ImageBitmap To Object
                    map.put("ImagePathThum", (String)c.getString("ImagePath_Thumbnail"));
                    map.put("ImageThumBitmap", (Bitmap)loadBitmap(c.getString("ImagePath_Thumbnail")));

                    // Full (for View Popup)
                    map.put("ImagePathFull", (String)c.getString("ImagePath_FullPhoto"));

                    MyArrList.add(map);
                }

            } catch (JSONException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            return null;
        }

        protected void onPostExecute(Void unused) {
            ShowAllContent(); // When Finish Show Content
            dismissDialog(DIALOG_DOWNLOAD_JSON_PROGRESS);
            removeDialog(DIALOG_DOWNLOAD_JSON_PROGRESS);
        }

    }

    // Download Full Photo in Background
    public class DownloadFullPhotoFileAsync extends AsyncTask<String, Void, Void> {

        String strImageName = "";
        String ImageFullPhoto = "";

        Bitmap ImageFullBitmap = null;

        protected void onPreExecute() {
            super.onPreExecute();
            showDialog(DIALOG_DOWNLOAD_FULL_PHOTO_PROGRESS);
        }

        @Override
        protected Void doInBackground(String... params) {
            strImageName = params[0];
            ImageFullPhoto = params[1];

            ImageFullBitmap = (Bitmap)loadBitmap(ImageFullPhoto);
            return null;
        }

        protected void onPostExecute(Void unused) {
            showDialogPopup(strImageName,ImageFullBitmap); // When Finish Show Popup
            dismissDialog(DIALOG_DOWNLOAD_FULL_PHOTO_PROGRESS);
            removeDialog(DIALOG_DOWNLOAD_FULL_PHOTO_PROGRESS);
        }

    }

    /*** Get JSON Code from URL ***/
    public String getJSONUrl(String url) {
        StringBuilder str = new StringBuilder();
        HttpClient client = new DefaultHttpClient();
        HttpGet httpGet = new HttpGet(url);
        try {
            HttpResponse response = client.execute(httpGet);
            StatusLine statusLine = response.getStatusLine();
            int statusCode = statusLine.getStatusCode();
            if (statusCode == 200) { // Download OK
                HttpEntity entity = response.getEntity();
                InputStream content = entity.getContent();
                BufferedReader reader = new BufferedReader(new InputStreamReader(content));
                String line;
                while ((line = reader.readLine()) != null) {
                    str.append(line);
                }
            } else {
                Log.e("Log", "Failed to download file..");
            }
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return str.toString();
    }

    /***** Get Image Resource from URL (Start) *****/
    private static final String TAG = "Image";
    private static final int IO_BUFFER_SIZE = 4 * 1024;
    public static Bitmap loadBitmap(String url) {
        Bitmap bitmap = null;
        InputStream in = null;
        BufferedOutputStream out = null;

        try {
            in = new BufferedInputStream(new URL(url).openStream(), IO_BUFFER_SIZE);

            final ByteArrayOutputStream dataStream = new ByteArrayOutputStream();
            out = new BufferedOutputStream(dataStream, IO_BUFFER_SIZE);
            copy(in, out);
            out.flush();

            final byte[] data = dataStream.toByteArray();
            BitmapFactory.Options options = new BitmapFactory.Options();
            //options.inSampleSize = 1;

            bitmap = BitmapFactory.decodeByteArray(data, 0, data.length,options);
        } catch (IOException e) {
            Log.e(TAG, "Could not load Bitmap from: " + url);
        } finally {
            closeStream(in);
            closeStream(out);
        }

        return bitmap;
    }

     private static void closeStream(Closeable stream) {
            if (stream != null) {
                try {
                    stream.close();
                } catch (IOException e) {
                    android.util.Log.e(TAG, "Could not close stream", e);
                }
            }
        }

     private static void copy(InputStream in, OutputStream out) throws IOException {
        byte[] b = new byte[IO_BUFFER_SIZE];
        int read;
        while ((read = in.read(b)) != -1) {
            out.write(b, 0, read);
        }
    }
     /***** Get Image Resource from URL (End) *****/

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:40:28.100

您可以在从服务器获取数据之前检查网络连接。我总是这样做：

```
private void getDataFromInternet() {

    if(InternetConnection.isConnectedToInternet(CurrentActivity.this))
        new MyAsyncTask().execute();
} 
```

在我的接收器类中，我实现了该方法：

```
public static boolean isConnectedToInternet(Context context) {
        Log.i(TAG, "Checking Internet Connection...");

        boolean found = false;

        try {
            ConnectivityManager cm = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
            NetworkInfo netInfo = cm.getActiveNetworkInfo();
            if (netInfo != null && netInfo.isConnectedOrConnecting()) {             
                found = true;
                internetStatus = 0;
            }

            android.net.NetworkInfo wifi = cm.getNetworkInfo(ConnectivityManager.TYPE_WIFI);
            android.net.NetworkInfo _3g  = cm.getNetworkInfo(ConnectivityManager.TYPE_MOBILE);
            if (wifi.isConnected())
                internetType = "WiFi";

            if (_3g.isConnected()) 
                internetType = "3G";

        } catch (Exception e) {
            Log.e("CheckConnectivity Exception", e.getMessage(), e);
        }

        if(found)
            Log.i(TAG, "Internet Connection found.");
        else
            Log.i(TAG, "Internet Connection not found.");

        return found;
    } 
```

因此，您始终了解网络连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T10:36:48.467

**这一定会对你有帮助！！！**

```
 if (!isOnline())
    {
            return ctx.getString(R.string.check_wifi);
    }

    else
    {
    // your service call goes here
    }

    public static boolean isOnline()
     {
    ConnectivityManager cm = (ConnectivityManager) ctx.getSystemService(Context.CONNECTIVITY_SERVICE);
    NetworkInfo netInfo = cm.getActiveNetworkInfo();
    if (netInfo != null && netInfo.isConnectedOrConnecting()) {
        return true;
    }
    return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T03:28:44.237

您可能会因 NullPointerException 而崩溃：

在您执行请求时，如果您没有连接`getJSONUrl`，它将抛出一个。`IOException`你抓住它`IOException`，不要重新扔它，这意味着它`getJSONUrl()`会返回`null`。然后您继续在 中使用它`null`，`new JSONArray(getJSONUrl(url));`这很可能会抛出一个`NullPointerException`.

# php - POST_ 未插入 MySQL

> ID：12310606
> 
> 赞同：-2
> 
> 时间：2012-09-07T01:29:06.657
> 
> 标签：php, mysql, insert

html页面：

```
<input size="100" value="Error Message" name="error" id="error"></td> 
```

插入.php：

```
$error=$_POST['$error'];

$sql="INSERT INTO $tbl_name(a, z, error, y, z)
      VALUES('$a','$z','$error','$y','$x')";
$result=mysql_query($sql); 
```

但是 SQL 结果是：

```
# mysql db_db -e "select * from tickets;"
+---+---+-----------+---------+--------------+
| a | z | error     | y       | x            |
+---+---+-----------+---------+--------------+
| a | z |           | y       | x            |
+---+---+-----------+---------+--------------+ 
```

我在这里想念什么？对不起格式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T01:36:50.203

`$_POST['$error'];`应该是`$_POST['error'];`。你在那里有一个额外的`$`角色。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-09-07T01:36:21.410

试试这个 ：

```
include (your_db_connection.php);

$a = $_POST['a'];
$z = $_POST['z'];
$error = $_POST['error'];
$y = $_POST['y'];

$query = "INSERT INTO your_table_name(a,z,error,y) VALUES('$a', '$z', '$error', '$y')";
$result = mysql_query($query);

echo "Insert record success."; 
```

如果我看到你的代码，你有一个重复的列。参见“z”列。

# django - 在 Django 应用程序上运行 virtualenv 会杀死我的网址

> ID：12310608
> 
> 赞同：1
> 
> 时间：2012-09-07T01:29:28.013
> 
> 标签：django, django-templates, virtualenv, django-urls

我有一个功能齐全的 Django 项目（不在 virtualenv 中），它的 url 模式如下

```
url(r'^$', 'myapp.views.Dashboard', name="dashboard"), 
```

哪些在模板中使用，例如

```
{% url 'dashboard' %} 
```

我将它移动到虚拟环境中，但是当我使用 venv 激活 venv 时`source venv/bin/activate`，我所有的 URL 标签都会给出

```
NoReverseMatch at /
Reverse for ''dashboard'' with arguments '()' and keyword arguments '{}' not found. 
```

如果我删除单引号，它会删除此错误，例如`{% url dashboard %}`很好。但是，如果没有这些引号`project-create`，则当 virtualenv 停用时，url 会失败。

有什么想法我应该看的吗？应该删除所有引号并重命名我的复合网址（例如`project-create ==> ProjectCreate`）？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T07:00:16.593

尝试使用双引号而不是单引号，看看它是否有效。正如这里提到的那样 [https://stackoverflow.com/a/854446/808236](https://stackoverflow.com/a/854446/808236)

# iphone - 使用图像作为导航栏 iOS 5

> ID：12310609
> 
> 赞同：0
> 
> 时间：2012-09-07T01:29:50.150
> 
> 标签：iphone, ios, uinavigationcontroller

我有一个包含许多视图的应用程序。每个视图都由故事板中的导航控制器控制。我想使用自定义图像作为导航栏。我已经创建了图像，但不确定实现它的过程。编码：

```
@implementation UINavigationBar (CustomImage)
- (void)drawRect:(CGRect)rect
{
    UIImage *image = [UIImage imageNamed: @"topbar.png"];
    [image drawInRect:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];
}
@end 
```

似乎不起作用。我将此代码放在视图控制器中。我应该使用不同的方法来设置视图控制器还是为导航控制器设置单独的控制器？如果是这样，我该怎么做？

这是故事板中的布局：

![在此处输入图像描述](../Images/092b1e8c672cad5281e00b93eef57101.png)

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T01:38:26.113

不确定这是否适合你的情况 100% 但你至少可以用这样的图像覆盖导航栏......

```
self.navigationItem.titleView = [[UIImageView alloc] initWithImage: navBarImage]; 
```

图像将在标题通常显示的位置居中，但如果它足够大，它将覆盖整个导航栏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T01:40:16.417

由于您使用的是 iOS 5，因此您可以这样做：

```
UIImage *image = [UIImage imageNamed:@"topbar"];
[self.navigationBar setBackgroundImage:image forBarMetrics:UIBarMetricsDefault]; 
```

您不需要子类，可以使用常规 UINavigationBar。

# php - 使用 xpath 和 SimpleXMLElement 返回空白结果？

> ID：12310617
> 
> 赞同：0
> 
> 时间：2012-09-07T01:31:11.147
> 
> 标签：php, xpath, simplexml

XML:

```
<A>
  <B type="source">
    <C>
      <D>
        <E ref="description">my_desc</E>
        <E>Some other E</E>
      </D>
    </C>
  </B>
</A> 
```

PHP：

```
$doc = new SimpleXMLElement('URL.xml', null, true);
$path = $doc->xpath('A/B[@type="source"]/C/D/E[@ref="description"]');
var_dump ($path); 
```

回报：

```
Array
(
) 
```

最终，我试图`<E>`用`ref="description"`. 我究竟做错了什么？以下指南来自： http: [//php.net/simplexmlelement.xpath](http://php.net/simplexmlelement.xpath)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T03:18:13.817

使用您提供的 XML，以下代码将打印出 E 的字符串值：

```
$doc = new SimpleXMLElement('URL.xml', null, true);
$path = $doc->xpath('/A/B[@type="source"]/C/D/E[@ref="description"]');
echo $path[0]; 
```

您需要以 / 开始查询以指定文档根目录。

你也可以只查询 //E[@ref="description"] 来找到你想要的所有 E 元素。

# php - T_PAAMAYIM_NEKUDOTAYIM 错误调用静态方法

> ID：12310620
> 
> 赞同：3
> 
> 时间：2012-09-07T01:31:52.847
> 
> 标签：php, static-methods

我有这个错误：

解析错误：语法错误，意外的 T_PAAMAYIM_NEKUDOTAYIM，期望 T_VARIABLE 在第 98 行的 blog/wp-content/plugins/plugin/php/utils/cloud_data.php 中

```
static public function set_templates()
{
    static::fetch_templates(); // line 98
}

static private function fetch_templates($folder_identifier = '')
{
    // ..
} 
```

谷歌说**T_PAAMAYIM_NEKUDOTAYIM**意味着**期待**。所以错误意味着：期待 T_VARIABLE。

但为什么？`fetch_templates()`函数将他的参数初始化为`''`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:33:45.263

`static::`是在~~5.4~~ 5.3 中引入的，可能你有较旧的 php

在您的情况下，您可以将其替换为

```
self::fetch_templates(); 
```

# jquery - jquery 一次显示隐藏的文本

> ID：12310622
> 
> 赞同：1
> 
> 时间：2012-09-07T01:32:13.977
> 
> 标签：jquery

仍然是 jquery 的学生，所以我渴望学习新东西。

好的，这是我目前遇到的问题。但不知道从哪里开始解决它。

我想要实现的是用隐藏的 tex 创建这个按钮云，让它们显示但在我按下另一个按钮时隐藏。我已经尝试过切换，但我对 JS 的了解有限。有人想帮我吗？谢谢

```
$(document).ready(function () {
    $('img.img-swap').click(function () {
        $('p.werkTxt').slideToggle('medium');
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T01:52:58.210

这将是我对如何执行此操作的想法： 1\. 在按钮单击事件处理程序上首先隐藏所有按钮文本，然后显示当前按钮文本 2\. 在按钮鼠标移出事件处理程序上 - 不确定是否要这样做这虽然显示所有按钮文本

对于更详细的代码，您需要按照人们的建议提供 HTML 片段

# objective-c - 目标 C：单位转换的类架构

> ID：12310625
> 
> 赞同：1
> 
> 时间：2012-09-07T01:33:05.743
> 
> 标签：objective-c, class, architecture, hierarchy

我是一名新手目标 c 程序员，在其他 OO 语言方面拥有丰富的经验。

目前我正在研究一个涉及一些单位转换的计算器。我最初的想法是有两个抽象类：*Measurement*和*Unit*。Unit 的子类可以是*Meter*、*Kilogram*、*Second*等。这些类将包含有关某些基本单位（可能是 SI 单位）的乘数的信息，以及一些对 UI 有用的信息，如标签和描述。测量的子类将是*Length*、*Mass*、*Time*等。这些类将包含测量的值和单位，以及确定允许的转换和进行转换所需的方法。

我开始有这样的问题，例如“我如何让任何需要它的 Length 类共享一个 Meter 类？” 和“如何存储该类型的任何测量通用的每个测量的允许单位列表？” 这让我相信我可能过度设计了我的类层次结构。我想知道是否有人对完成此任务的不同架构有建议，或者新手可能不知道的语言特性可能有助于我的实现。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T02:46:49.553

所以，我[用 Objective-C 写了一个单位转换库](https://github.com/davedelong/DDUnitConverter)，我只使用了枚举。每个转换器类（面积、长度等不同的类）中都有一个查找方法，该方法有一条`if()`语句，将指定单位的乘数返回到基本单位中。然后转换方法除以该数字或乘以该数字，具体取决于您是从该单位转换还是从该单位转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-24T10:03:49.227

我编写了一个名为[UnitsKit](https://github.com/stevemoser/UnitsKit)的度量单位库，它不仅可以进行基本转换。例如，您可以将 m/s 乘以秒并得到米或英尺或任何其他长度单位。

类结构的基本概述从包含值和派生单位的 SMQuantity 开始。派生单位由一个或多个基本单位组成，每个基本单位都有自己的维度指数。每个基本单位由名称、符号、基本单位（m是km的基本单位）、尺度、静态有理和维度组成。看一看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T01:36:20.503

看看[数量模式](http://martinfowler.com/eaaDev/quantity.html)。

重要的是这些类的行为就像不可变的值对象。

此外，《*分析模式*》一书更详细地介绍了*测量*和*观察*。也许值得一瞧。

# python - 使用 'argparse' 而不是 sys.argv

> ID：12310631
> 
> 赞同：2
> 
> 时间：2012-09-07T01:34:24.747
> 
> 标签：python, argparse, argv

我的脚本当前用于`sys.argv`检查提供给程序的输入文件。

我正在尝试使用`argparse`它，但我似乎无法让它工作。我能够设置它并添加一个参数，但是当我解析一个参数并打印该解析后的参数时，我得到了一个命名空间。我怎样才能得到一个字符串？基本上，我想将参数作为一个字符串，并打开一个具有该名称的文件。

目前，我`sys.argv`的是：

```
filename = sys.argv[1]
f = open(filename, 'r') 
```

我的`argparse`打印`Namespace`如下：

```
arg = parser.parse_args()
print arg 
```

如何使用它打开文件？我想使用`argparse`，因为参数的错误处理要容易得多。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T01:54:43.750

认为使用该`with`语句打开文件更可取（或其他东西！），如下所示：

```
# printfile.py
import argparse

parser = argparse.ArgumentParser(description="Opens a file and does cool stuff ^^")
parser.add_argument('filename', type=str, help="Path to file to open")
args = parser.parse_args()

with open(args.filename) as f:
    print '   my uber cool file:'
    print f.readlines() 
```

指定这些关键字 args 还有助于制作漂亮的 -h 帮助文本选项（非常整洁）

```
[dlam@dlam-63221:~] $ python printfile.py -h
usage: printfile.py [-h] filename

Opens a file and does cool stuff ^^

positional arguments:
    filename    Path to file to open 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T01:37:38.537

打印`arg`后跟一个点，后跟您在`argparse`设置中分配给参数的任何名称。

例子：

```
parser = argparse.ArgumentParser(description = 'Title you want')
parser.add_argument('-f', action = "store", dest = "fflag", type = str, help = "Filename to be used, stdin is default") 
```

在这种情况下，文件名将`-f`在命令行前面，并且可以通过`parser.fflag`类型访问`str`

# javascript - pushState() 关闭“记住密码”对话框

> ID：12310634
> 
> 赞同：1
> 
> 时间：2012-09-07T01:35:03.847
> 
> 标签：javascript, jquery, google-chrome, pushstate

我想我有一个有趣的问题，经过几天的思考和研究，我一直无法想出一个解决方案。

我正在编写一个受 phpMyAdmin 启发的 Web 应用程序，因此它使用框架来控制内容放置。因此，访问的任何 url 将始终是 index.php.. 除非我使用历史 API 的`pushState()`方法来更改 url 以反映框架中正在访问的页面。

然而，问题来自这种方法；登录后，用户被重定向`login.html`到`index.php`，并且在一瞬间，chrome 询问是否要我记住密码.. 当访问触发该`pushState()`方法时，那个小栏就会消失。我不希望应用程序继续提交此行为。我希望用户能够在他们希望的情况下存储他们的密码（我还没有进入 cookie，我对此还是很陌生）。

我已经尝试过考虑可以围绕访问的最后一页进行的检查，但是由于我在此类方面的经验，这并没有成功。因此，对于如何解决问题的任何想法，我们将不胜感激。

如果它有帮助，我当前的触发代码是..

```
$(window).on('load', function (){
    window.parent.history.pushState(null, "index.php", "index.php");
}); 
```

到目前为止，这种行为只发生在 Chrome 上。Firefox 和 IE 的行为符合预期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:25:59.490

避免最初的 pushstate

```
(function($) {
  var firstLoad=true;
  $(window).on('load', function (){
    if (firstLoad!==true)
      window.parent.history.pushState(null, "index.php", "index.php");
    firstLoad=false;
  });
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T01:38:31.053

试试这个

```
(function($) { 
    var isFirst = true;

    $(window).on('load', function (evt){

        if(isFirst && wasLastPage('index.html')) return;
        isFirst = false;

        window.parent.history.pushState(null, "index.php", "index.php");

    });

    function wasLastPage(pageName){
        //document.referrer only works in non IE
        var lastPage = (document.referrer)? document.referrer : '';

        return (lastPage.indexOf(pageName) === lastPage.length - pageName.length);
    }

}); 
```

# c# - 如何将单个操作绑定到 Windows 窗体中的多个事件侦听器

> ID：12310640
> 
> 赞同：0
> 
> 时间：2012-09-07T01:36:10.147
> 
> 标签：c#, winforms, visual-studio-2010

使用 Windows 窗体 ListBox，如何将双击和返回键绑定到单个操作。我拥有它的方式只是将相同的操作复制到`listBox1_MouseDoubleClick`和`listBox1_KeyUp`中。

```
public partial class MyForm : Form
{
    public MyForm()
    {
        InitializeComponent();
    }

    private void listBox1_MouseDoubleClick(object sender, MouseEventArgs e)
    {
        this.textBox1.Text = this.listBox1.SelectedItem.ToString(); // Repeated
    }

    private void listBox1_KeyUp(object sender, KeyEventArgs e)
    {
        if (e.KeyCode == Keys.Return)
        {
            this.textBox1.Text = this.listBox1.SelectedItem.ToString(); // Repeated
        }
    }
} 
```

对于两个事件来说并不是什么大问题，但有没有办法将这两个监听器绑定到单个动作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T02:28:00.733

由于两个事件委托的签名不同，因此您无法真正组合事件处理程序，特别是如果您需要键盘处理程序具有一些额外的逻辑，例如检查按下了哪个键。

但是，您可以做的是将分配放入它自己的方法中，然后从两个事件处理程序中调用它。这样你就不会违反 DRY 原则，如果你需要扩展动作，你只需要在一个地方做，如果你想对其他事件使用相同的动作，你会只需调用该方法即可。

```
public partial class MyForm : Form
{
    public MyForm()
    {
        InitializeComponent();
    }

    private void listBox1_MouseDoubleClick(object sender, MouseEventArgs e)
    {
        SyncListToTextBox();
    }

    private void listBox1_KeyUp(object sender, KeyEventArgs e)
    {
        if (e.KeyCode == Keys.Return)
        {
            SyncListToTextBox();
        }
    }

    private void SyncListToTextBox() 
    {
        this.textBox1.Text = this.listBox1.SelectedItem.ToString();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T02:28:23.260

您可以将这两个事件绑定到同一个处理程序，但在这种情况下不建议这样做。您实际上会使代码更难阅读，并且您的代码仍然会重复。在 KeyUp 事件中，您使用的是 KeyEventArgs。

因此，如果他们共享相同的处理程序，您将需要类似的东西。

```
private void CommonAction(object sender, EventArgs e)
{
  var keyEventArgs = e as KeyEventArgs;
  if(keyEventArgs!=null)
  {
    if(keyEventArgs.KeyCode == Keys.Return)
    {
      this.textBox1.Text = this.listBox1.SelectedItem.ToString(); 
    }
  }
  else
  {
    this.textBox1.Text = this.listBox1.SelectedItem.ToString(); // Still repeated
  }
} 
```

我会说让它保持原样。如果您需要在双击或按下回车键时执行更多操作，请将该逻辑移动到两个处理程序调用的单独方法中。

```
private void ListBoxItemWasSelected(string itemString)
{
  this.textBox1.Text = itemString;
  // Do more stuff
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T01:41:51.777

检查您的设计器代码！在某个地方你应该有这样的代码
`listBox1.onDoubleClick += listBox1_MouseDoubleClick;`
你所要做的就是编写一个方法

```
private void CommonAction(object sender, MouseEventArgs e){
    this.textBox1.Text = this.listBox1.SelectedItem.ToString(); 
} 
```

并改用此方法：

`listBox1.onDoubleClick += CommonAction;`

可能不准确，但是您了解基本概念吗？

# php - 自动创建变量并在不同的 PHP 页面中设置值？

> ID：12310648
> 
> 赞同：0
> 
> 时间：2012-09-07T01:37:01.403
> 
> 标签：php

我有一些页面，如 a.php、b.php、c.php 每个 php 文件都有以下构造函数。

```
var database;
function __construct() {
     $database = $this->router->database;
} 
```

我想做的是：

```
function __construct() {
     $this->router->construct();
} 
```

因此，我的路由器中的construct() 函数应该创建一个$database 变量，并为其分配“$this->router->database”。我应该能够 $database->query() 无需在我的控制器中进行任何其他更改。

我怎样才能做到这一点？它可能有一个非常基本的回复，但我现在很困惑，甚至在考虑 eval()。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:52:32.713

我对您实际上要完成的工作有点模糊，但听起来您正在尝试消除所有这些页面的重复构造函数。如果是这种情况，那么您可以创建一个父类并放入适当的代码，然后从父类继承每个其他页面。

```
class PageParent { 

  var $database;

  function __construct() {    
    $database = $this->router->database; 
  }

} 
```

你的其他文件只需要

```
class Page extends PageParent
{
  function __construct() {
    /* Call parent class's constructor first... */
    parent::__construct();

    /* then add additional code here */

  }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T01:50:19.290

我不确定你想要什么。您说这些是页面，但如果您使用的是构造函数，那么您正在查看类。如果是这种情况，那么您似乎也希望您的类具有路由器类的属性，并且能够在您的类中运行该构造函数来执行路由器构造函数所做的任何事情。

如果是这种情况，您真正想要做的是扩展路由器类。如果您不知道，如果一个类扩展了另一个类，它会自动继承父类（即您正在扩展的类）的所有属性和方法（即变量和函数），并允许您添加新的。如果一个属性或方法被设置为受保护或公共，你甚至可以用你自己的属性覆盖它们（尽管你最好知道你在做什么，否则你会得到令人讨厌的结果。）

所以一个例子可能是这样的：

```
class my_class extends router
{
    private $blah;
    // and so on; these can be accessed by using $this->blah in any function you like
    public function __construct()
    {
        // Your custom code, if any, goes here
        parent::__construct();
    }
} 
```

要记住的一件事：如果您要扩展的类是“最终”类，则不能扩展它，因此无论如何您都可能不走运。

为了更详细地分析面向对象编程（又名“OOP”）的工作原理，[PHP 文档](http://php.net/manual/en/language.oop5.php)实际上非常详尽且相对容易理解。

希望这可以帮助！

# javascript - Javascript XMLHttpRequest——只有第一个 POST 请求有效

> ID：12310649
> 
> 赞同：0
> 
> 时间：2012-09-07T01:37:08.817
> 
> 标签：javascript, ajax, post, xmlhttprequest

我正在研究用于服务器的 Javascript`XMLHttpRequest`代码`POST`。

我的代码如下所示（我从 google chrome 中的书签运行它）：

```
 var a = sometext; 
 var b = someOtherText; 
 var msg = "a=" + encodeURIComponent(a) + "&b=" + encodeURIComponent(b);
 var server = new XMLHttpRequest();
 server.open("POST", "http://localhost:3333", true);
 server.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
 server.send(msg); 
```

我正在使用 netcat 在我的计算机（Windows 7）的端口 3333 上监听。我第一次运行代码时，它运行良好，运行 netcat 的命令提示符显示`POST`请求、所有标头以及已发送数据的正确值 ( `msg`)。但是，当我再次运行脚本（在任何打开的网页上）时，我不再在命令提示符中看到任何新信息，我认为这意味着后面的`POST`命令失败（尽管当我在 Chrome 中查看 JavaScript 控制台时没有错误消息）。如果我重新启动 netcat 侦听器并重新运行脚本，第一次运行将再次正常运行，后续运行将无济于事。

关于为什么失败的任何想法？

**编辑：** 我做了更多的事情，结果发现与 localhost 的连接似乎没有被关闭（或者以某种方式被保留给`server`对象）。如果我关闭在其上运行脚本的选项卡，则会释放所持有的所有资源，并且脚本会再次运行。

有没有办法告诉 XMLHttpRequest 在完成后立即关闭？我尝试添加一个标题来做到这一点（`'Connection: close'`），但事实证明这是不允许的。我还尝试将请求更改为同步并`server.abort()`随后调用（我什至找不到很好的文档来说明该函数的确切作用），但这没有帮助。我不知道如何指定我想使用 HTTP/1.0 而不是 1.1 进行连接，这似乎可能会有所帮助。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:40:45.180

你说关闭netcat并重新启动它可以工作。也许您还没有设置 netcat 在第一个 POST 断开连接后重新打开侦听器。

根据这个[netcat 备忘单](http://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf)，你可以`-L`在 windows 上使用。

> `-L`：听得更仔细（仅支持 Windows 版本的 Netcat）。此选项使 Netcat 成为持久侦听器，在客户端断开连接后再次开始侦听

如果您想关闭连接（它不会自动关闭，直到浏览器超时），请尝试使用[有效的 HTTP response 进行响应](https://www.rfc-editor.org/rfc/rfc1945)，也许[是最小的 Full-Response`"HTTP/1.0 200 OK\r\n\r\n")`](https://www.rfc-editor.org/rfc/rfc1945#section-6)。

使用 HTTP/1.0 响应 HTTP/1.1 请求应该可以工作，因为假定浏览器（客户端）实现了旧协议（它们被设计为向后兼容）。您也可以使用 HTTP/1.1 响应进行响应，但[假定连接是持久的](https://www.rfc-editor.org/rfc/rfc2616#section-8.1.2)（即，[不会立即关闭](https://www.rfc-editor.org/rfc/rfc2616#section-14.10)）。

> 除非另有说明，客户端应该假设服务器将保持持久连接，即使在服务器错误响应之后。

编辑：犯了一个错误并使用了最小的*请求*，而不是响应。响应实际上可能更难实现为持久侦听器，因为服务器可能必须关闭（TCP）连接。也许重新创建 netcat [“最小 HTTP 侦听器”](http://en.wikipedia.org/wiki/Netcat#Setting_up_a_one-shot_webserver_on_port_8080_to_present_the_content_of_a_file)的脚本（不使用`-L`，而是循环重新打开连接）可能会更好？下一步是启动一个实际的 HTTP 服务器来提供虚拟响应 - 这不是一个坏主意，因为它可以让您有机会测试一些格式良好的响应内容。

# asp.net - Ext JS 4：Ext JS 版本 4.1.1 中的 JavaScript 异常“TypeError：Ext.resetElement 未定义”

> ID：12310650
> 
> 赞同：3
> 
> 时间：2012-09-07T01:37:28.210
> 
> 标签：asp.net, proxy, extjs

Ext JS 4.1.1 破坏了我使用 ASP.NET 设置的代理。我不得不切换回 4.1.0 版本来解决这个问题。只是想我会把这个问题扔在那里，直到它被 Sencha 解决。

**JavaScript 异常：**

“TypeError：Ext.resetElement 未定义”==>“...s.styleProxyEl ||（Ext.AbstractComponent.prototype.styleProxyEl”==> ext-all-debug.js（第 26960 行）

![在此处输入图像描述](../Images/d3a1ade7986260161a16e83fa7d0e89d.png)

```
getStyleProxy: function(cls) {

    var result = this.styleProxyEl || (Ext.AbstractComponent.prototype.styleProxyEl = Ext.resetElement.createChild({
        style: {
            position: 'absolute',
            top: '-10000px'
        }
    }, null, true));

    result.className = cls;
    return result;
}, 
```

**解决方法：**

下载 ExtJS 框架的 4.1.0 版本，而不是使用 4.1.1 版本。

[http://cdn.sencha.io/ext-4.1.0-gpl.zip](http://cdn.sencha.io/ext-4.1.0-gpl.zip)

如果有人可以准确地解释这里发生了什么，我会将他们的答案标记为正确。这是我正在使用的代理。

```
Ext.define('Ext.ux.AspWebAjaxProxy', {
    extend: 'Ext.data.proxy.Ajax',
    require: 'Ext.data',

    buildRequest: function (operation) {
        var params = Ext.applyIf(operation.params || {}, this.extraParams || {}),
                                request;
        params = Ext.applyIf(params, this.getParams(params, operation));
        if (operation.id && !params.id) {
            params.id = operation.id;
        }

        params = Ext.JSON.encode(params);

        request = Ext.create('Ext.data.Request', {
            params: params,
            action: operation.action,
            records: operation.records,
            operation: operation,
            url: operation.url
        });
        request.url = this.buildUrl(request);
        operation.request = request;
        return request;
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T04:46:50.567

确保您正在使用`Ext.onReady(function() { ... })`. ExtJS 使用在调用`Ext.resetElement`之前设置的。`onReady`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T14:41:25.283

另一个对我有用的解决方法是在使用 ext 对象之前定义这个元素：

```
Ext.resetElement = Ext.getBody(); 
```

# ios - 刷新 UIViewController

> ID：12310652
> 
> 赞同：2
> 
> 时间：2012-09-07T01:37:39.850
> 
> 标签：ios, xcode, uiviewcontroller, uitabbarcontroller

我不知道如何刷新 ViewController，我搜索了所有谷歌和这个网站，我卡住了。我的简单应用程序基于情节提要，它从 UITabBarController 开始，我希望它在每次从另一个 ViewController 更改设置时刷新。这意味着我必须 TabBar 项目一个是（带有标签的主视图）另一个是（设置）有一个简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:50:01.863

您可以在 settings 中保存更改的数据`NSUserDefaults`，然后当返回主视图时，使用 mainviewController 中的`-(void)viewWillAppear:(BOOL)animated:`方法或主视图中的方法中保存的数据`-drawView:`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T02:08:36.090

您可以使用 NSNotification 将消息从一个视图控制器发送到另一个。但我同意另一个答案，无论您是使用共享的 NSUserDefaults 还是 NSNotification（或两者），还是一个视图控制器与另一个视图控制器之间的其他一些通信方式（例如，只需给主视图控制器一些设置视图的方法控制器可以调用），你要交流的是状态；实际更改将被反映，因为您已经设置了主视图控制器`viewWillAppear`来咨询该状态并相应地构造接口。

# c# - 解决 linq2Entities 异常的任何方法 - 无法创建类型为“System.Object”的常量值。

> ID：12310653
> 
> 赞同：0
> 
> 时间：2012-09-07T01:37:47.537
> 
> 标签：c#, .net, visual-studio-2010, linq

场景是

```
void someFunc(object obj1 )
{

  using ( var ctx = getContext() )
  {
    var list = ctx.MyTable.Where ( .... ).OrderBy( ... ).Select (
      x => new PocoObject
      {
          string = x.String,
          ....
          // Command = new MyCommand { prop1 = x } // working code 
          Command = new MyCommand { prop1 = x, objProp = obj1 } // problem line
      }
      ).ToList();

      //list.ForEach( x => x.Command.objProp = obj1 ); working code
  }

} 
```

例外是

无法创建“System.Object”类型的常量值。此上下文仅支持原始类型或枚举类型

使用标记为工作代码的代码更改问题行解决了问题

有什么方法可以调整它以使其更简单，即最后没有 ForEach 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T05:49:14.160

您可以添加一个 AsEnumerable() 调用，这将阻止转换为 SQL。这将解决问题，因为 obj1 不能转换为 SQL，因为它不是原始类型。

```
void someFunc(object obj1) {
    using (var ctx = getContext()) {
        var list = ctx.MyTable
            .Where ( .... )
            .OrderBy( ... )
            .AsEnumerable() // <-- Everything below is not translated to SQL.
            .Select(x => new PocoObject {
                string = x.String,
                ....
                Command = new MyCommand { prop1 = x, objProp = obj1 }
            })
            .ToList();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T01:48:55.730

正如错误所说......“在这种情况下仅支持原始类型或枚举类型”。

匿名对象的初始化将在 SQL 中完成，基本上如下所示：

```
DECLARE @obj1 (TYPE?) = ...;
SELECT
    ...
    objProp = @obj1
... 
```

因此，除非您可以将该值存储为 SQL 变量，否则这是行不通的。

我认为没有任何解决方法，除了琐碎的和你已经尝试过的：

*   使用类型化变量，类型为原始或枚举
*   在查询执行后添加值

我想在某些情况下，您*可以*考虑将值序列化。

# iphone - iPhone - 转发父类的代表

> ID：12310654
> 
> 赞同：1
> 
> 时间：2012-09-07T01:37:53.120
> 
> 标签：iphone, ios, cocoa-touch, ipad

我有一个 UITextView 子类。UITextView 类有一些委托协议，如

```
- (void)textViewDidChange:(UITextView *)textView;
- (void)textViewDidBeginEditing:(UITextView *)textView; 
```

我想使用它们来自我的自定义类。换句话说，如果我从一个类中使用 MyCustomTextViewClass（我们称之为 classX），我必须这样做并设置委托：

```
MyCustomTextViewClass *box = [[MyCustomTextViewClass alloc] initWithFrame:
                                   CGRectMake(111.0f, 123.0f, 190.0f, 50.0f)];
// ... bla bla.. set other parameters
[box setDelegate:self]; 
```

但为了设置委托，我必须使用声明 classX

```
<MyCustomTextViewClassDelegate> 
```

为此，我必须将 UITextView 的委托协议添加到 MyCustomTextViewClass。

我该如何正确地做到这一点？

只需在 MyCustomTextViewClass 上执行此操作？

```
@protocol MyCustomTextViewClassDelegate <NSObject>
@optional
- (void)textViewDidChange:(MyCustomTextViewClass *)textView;
- (void)textViewDidBeginEditing:(MyCustomTextViewClass *)textView;
@end 
```

？？？我看不出这如何从 UITextView 转发委托协议......

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T02:46:22.217

编辑：新答案。请理解 UITextView 子类不需要声明自己的委托协议。它的工作原理是这样的：并非所有矩形都是正方形，但所有正方形都是矩形。您的 MyCustomTextView 将表现并响应 UITextView 响应的任何消息，并且它还将像 UITextView 一样向其委托发送消息。如果您想添加 UITextView 未涵盖的其他委托方法，那么您将创建一个全新的协议。

无论如何，想想为什么你需要继承 UITextView。您是否正在向其添加子视图，例如字符计数标签？在这种情况下，子类化会很有用。如果您只是创建一个 UITextView 并更改一些公开的属性，那么自定义子类可能会过大。我问的原因是因为这个问题使您似乎不太了解对象继承。不是想成为一个混蛋或任何东西，我想帮助你。

无论如何，代码：

```
//===================================
//ClassX.h
//===================================
#import "MyCustomTextView.h"

@interface ClassX : UIViewController <UITextViewDelegate>

-(void)loadTextView;

@property (nonatomic, strong) MyCustomTextView *customTextView;

@end
//===================================
//ClassX.m
//===================================
#import "ClassX.h"

@implementation ClassX
@synthesize customTextView;

-(void)loadTextView {
    if (!customTextView) {
        self.customTextView = [[MyCustomTextView alloc] initWithFrame:CGRectZero];
    customTextView.delegate = self;
    }
    customTextView.publicString = @"Public String Property!";    
}

#pragma mark UITextViewDelegate

-(void)textViewDidChange:(UITextView *)textView {
    if (textView == customTextView) {
        //THIS IS CALLED A CAST :
        MyCustomTextView *castedVariable = (MyCustomTextView *)textView;
        //now the object castedVariable will be treated as a MyCustomTextView object
        //so you can access methods and variables declared by the class
        textView.publicString = @"Hello World!"; //XCode raises an error, UITextView doesn't have this property
        castedVariable.publicString = @"Hello World!"; //this works fine
        //handle textViewDidChange method
        //you are now interacting with self.customTextView
    } else {
        //is your ClassX also in charge of 
        //a different UITextView? Handle here
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T02:01:52.073

你的问题有点不清楚。如果您只想`MyCustomTextViewClass`实现这些`UITextViewDelegate`方法，那么只需声明它即可：

```
@class MyCustomTextViewClass : UITextView <UITextViewDelegate> {
...
} 
```

如果你有一个正在创建的新协议，并且你有一个实现新协议和 的类`UITextViewDelegate`，你可以像这样声明它来实现两者：

```
@class MyDelegateClass : NSObject <UITextViewDelegate, MyCustomTextViewClassDelegate> {
...
} 
```

如果您想`MyCustomTextViewClassDelegate`要求所有与 相同的方法`UITextViewDelegate`，则将其声明为从该协议继承，如下所示：

```
@protocol MyCustomTextViewClassDelegate <UITextViewDelegate> {
...
} 
```

# android - 两个文本视图使右侧文本视图成为一行，左侧没有省略号将填充额外区域并且可以是多行

> ID：12310662
> 
> 赞同：0
> 
> 时间：2012-09-07T01:38:42.323
> 
> 标签：android, android-layout

我正在尝试创建两个`textviews`. 一个左对齐，一个右对齐。我希望右边的那个在一行中，并且有一个省略号并始终显示全文。左边会填满剩余的区域，直到它到达右边`textview`，然后它会进入第二行。

所以我的目标是有一个如下所示的显示

> ```
>  |this is a test     MY Date|
>  |title that can            |
>  |be as many lines          |
>  |as they want              | 
> ```

下面是我下面的代码的样子：

> ```
> |this is a test title MY...|
> |that can be as many       |
> |lines as they want        | 
> ```

我理论上可以将正确的 textiview 设置为静态宽度。但我肯定不希望左边的 textview 是静态宽度，因为我希望它根据视图大小而改变。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="horizontal"
android:layout_width="match_parent"
android:layout_height="match_parent">
<TextView android:id="@+id/widget_title"
    android:text="@string/widget_text" 
    android:layout_height="wrap_content" 
    android:layout_width="wrap_content" 
    android:paddingRight="70dp"
    android:textSize="24sp"
    android:textStyle="bold"
    android:padding="5dp"
    style="@style/TextViewShadow"
    android:textColor="@android:color/white"
    android:layout_weight="1"
/>
<TextView android:id="@+id/widget_date"
    android:layout_height="wrap_content" 
    android:layout_width="wrap_content"
    android:singleLine="true"
    android:textSize="24sp"
    android:textStyle="bold"
    android:padding="5dp"
    style="@style/TextViewShadow"
    android:textColor="@android:color/white" 
    android:layout_weight="1"
/>
</LinearLayout> 
```

我正在努力弄清楚如何做到这一点。我确信这只是我缺少的一些概念。请回复一个我可以用来测试的布局示例，或者至少要研究的东西或教程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:16:16.050

下面似乎是修复：

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:id="@+id/widget_layout">
<TextView android:id="@+id/widget_date"
android:layout_height="wrap_content" 
android:layout_width="wrap_content"
android:singleLine="true"
android:textSize="24sp"
android:textStyle="bold"
android:padding="5dp"
style="@style/TextViewShadow"
android:textColor="@android:color/white" 
android:layout_alignParentRight="true"
/>
<TextView android:id="@+id/widget_title"
android:text="@string/widget_text" 
android:layout_height="wrap_content" 
android:layout_width="fill_parent" 
android:textSize="24sp"
android:textStyle="bold"
android:padding="5dp"
style="@style/TextViewShadow"
android:textColor="@android:color/white"
android:layout_toLeftOf="@+id/widget_date"
/>
</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T09:50:15.583

set `android:layout_width="200dp"` the widget_title textview and the work is done ;)

# javascript - 隐藏javascript滑块的问题

> ID：12310665
> 
> 赞同：0
> 
> 时间：2012-09-07T01:39:46.423
> 
> 标签：javascript, jquery, jquery-ui, slider

过去几天我一直在研究一个 javascript 滑块，到目前为止，我一直坚持如何让 div 滑入页面并使用关闭按钮滑出页面......我找到了一些我拥有的代码试图让它工作，但这样做却非常不受欢迎。这是我在我试图用来将 div 滑出屏幕的 2 部分代码旁边添加注释的完整代码。

```
<script type="text/javascript">
$(function(){
    $(".recordrow").click(function() {
    var divid = "details-" + $(this).attr('id').split("-")[1]; //Create the id of the div
    $("#"+divid).show().animate({ "left": '50.1%'}); //Bring the div from right to left with 200px padding from the screen

});

});
function closeRecord() { // this function
 $('#details').animate({right:-1000}, 500);
}
</script>

<div class="recordrow" id="row-1">
    <p>Matthew Gia </p>
    </div>

<div class="details" id="details-1">
   ... More details of the records
   <a href="#" id="bt-close" onclick="closeRecord(); return false;">Close</a> //this button

</div>
<div class="details" id="details-2">
   ... More details of the records

</div> 
```

还有这个js小提琴

[http://jsfiddle.net/matth4ck3r/aWMg6/2/](http://jsfiddle.net/matth4ck3r/aWMg6/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:46:35.340

您的代码中存在范围问题，您可以删除该`onclick`属性并尝试：

```
$('#bt-close').click(function(e){
    $('.details').animate({right: "-=1000"}, 500);
    e.preventDefault()
}) 
```

[http://jsfiddle.net/aWMg6/10/](http://jsfiddle.net/aWMg6/10/)

另请注意，您的标记中没有 id 的元素，`details`您似乎想按类名选择元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T01:59:09.200

你也可以做这样的事情，虽然它不像未定义的答案那么干净。 [http://jsfiddle.net/aWMg6/12/](http://jsfiddle.net/aWMg6/12/)

# vim - Vim 非贪心搜索

> ID：12310668
> 
> 赞同：3
> 
> 时间：2012-09-07T01:40:11.893
> 
> 标签：vim

我正在尝试删除 csv 文件中每行的第一个逗号之前的所有内容。这些行是这样的：

```
-29.45829963684082~149.14680480957031,-000029.45829963684082, 000149.14680480957031,WGS84
-29.46190071105957~149.09509277343750,-000029.46190071105957, 000149.09509277343750,WGS84 
```

当我执行`%s/.*,\\{-}//`它时，它会删除所有内容！

如果我使用`%s/.*,//`它会删除除 WGS84 之外的所有内容，这是我所期望的。

谁能告诉我我做错了什么？我认为`\{-}`在 Vim 中强加了非贪婪匹配。

谢谢，

约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T01:43:19.910

我只会使用`[^,]*`而不是`.*`. 这将使您的正则表达式对逗号不贪婪。

至于为什么您的变体不起作用，您的正则表达式中的对象似乎是错误的。`{-}`应该是等价于`*`但不贪心，而且你*已经*习惯`*`了尽可能多地吸食。你那里也有太多的反斜杠。尝试：

```
:%s/.\{-},// 
```

反而。

当我对您的测试输入执行此操作时，我得到：

```
-000029.45829963684082, 000149.14680480957031,WGS84
-000029.46190071105957, 000149.09509277343750,WGS84 
```

正如预期的那样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T01:46:00.970

`\{-}`是 Vim 中的非贪婪匹配，所以你应该使用`\{-}`而不是`*`.

尝试：

```
%s/.\{-},// 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T01:49:15.570

另一种方法是使用 global 命令。

```
:g//normal dt, 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T01:45:44.000

这是你需要做的

```
%s/[^,]*// 
```

# c# - 寻找一种方法来做一个多行提示横幅文本框

> ID：12310674
> 
> 赞同：0
> 
> 时间：2012-09-07T01:41:07.273
> 
> 标签：c#, winforms, watermark

我试图弄清楚是否有可能以及是否有人知道如何制作此[Cue Banner(Watermark) 文本框](https://stackoverflow.com/questions/4902565/watermark-textbox-in-winforms/4902969#4902969)的多行版本。我得到了这个工作正常的单行版本，但对于我的项目，我真的需要一个多行，在加载时在框中有一段文本，当用户点击文本时，只要他们在框中输入一些内容它消失了，但是如果他们删除了他们在文本框中输入的任何内容，我的段落就会返回。我希望这是有道理的。

感谢您的任何回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-09T13:42:51.083

我搜索了一下，找到了一个更好的解决方案，适用于多行和单行文本框：

```
// Thank you author of http://nate.deepcreek.org.au/svn/tools/ComskipToCuttermaran/trunk/CSharpControls/GlassTextBox.cs

using System;
using System.Drawing;
using System.Drawing.Imaging;
using System.Runtime.InteropServices;
using System.Windows.Forms;

public class CueTextBox : TextBox 
{
    #region Fields
    private Bitmap _bitmap;
    private bool _paintedFirstTime = false;

    const int WM_PAINT = 0x000F;
    const int WM_PRINT = 0x0317;

    const int PRF_CLIENT = 0x00000004;
    const int PRF_ERASEBKGND = 0x00000008;

    private string _cue;
    #endregion

    #region Properties
    public string Cue 
    {
        get { return _cue; }
        set {
            _cue = value;
            Invalidate(true);
        }
    }

    public new BorderStyle BorderStyle 
    {
        get { return base.BorderStyle; }
        set {
            if (_paintedFirstTime)
                SetStyle(ControlStyles.UserPaint, false);
            base.BorderStyle = value;
            if (_paintedFirstTime)
                SetStyle(ControlStyles.UserPaint, true);
        }
    }

    public override bool Multiline 
    {
        get { return base.Multiline; }
        set {
            if (_paintedFirstTime)
                SetStyle(ControlStyles.UserPaint, false);
            base.Multiline = value;
            if (_paintedFirstTime)
                SetStyle(ControlStyles.UserPaint, true);
        }
    }
    #endregion

    #region Constructor
    public CueTextBox()
        : base() 
    {
        SetStyle(ControlStyles.UserPaint, false);
        SetStyle(ControlStyles.AllPaintingInWmPaint, true);
        SetStyle(ControlStyles.DoubleBuffer, true);
    }
    #endregion

    #region Functions
    [DllImport("USER32.DLL", EntryPoint = "SendMessage")]
    public static extern int SendMessage(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam);

    protected override void Dispose(bool disposing) 
    {
        if (_bitmap != null)
            _bitmap.Dispose();

        base.Dispose(disposing);
    }

    protected override void WndProc(ref Message m) 
    {
        if (m.Msg == WM_PAINT) 
        {
            _paintedFirstTime = true;
            CaptureBitmap();
            SetStyle(ControlStyles.UserPaint, true);
            base.WndProc(ref m);
            SetStyle(ControlStyles.UserPaint, false);
            return;
        }

        base.WndProc(ref m);
    }

    private void CaptureBitmap() 
    {
        if (_bitmap != null)
            _bitmap.Dispose();

        _bitmap = new Bitmap(this.ClientRectangle.Width, this.ClientRectangle.Height, PixelFormat.Format32bppArgb);

        using (var graphics = Graphics.FromImage(_bitmap)) 
        {
            int lParam = PRF_CLIENT | PRF_ERASEBKGND;

            System.IntPtr hdc = graphics.GetHdc();
            SendMessage(this.Handle, WM_PRINT, hdc, new IntPtr(lParam));
            graphics.ReleaseHdc(hdc);
        }
    }

    protected override void OnPaint(PaintEventArgs e) 
    {
        SetStyle(ControlStyles.UserPaint, true);
        if (_bitmap == null)
            e.Graphics.FillRectangle(Brushes.CornflowerBlue, ClientRectangle);
        else
            e.Graphics.DrawImageUnscaled(_bitmap, 0, 0);

        if (_cue != null && Text.Length == 0)
            e.Graphics.DrawString(_cue, Font, Brushes.Gray, -1f, 1f);

        SetStyle(ControlStyles.UserPaint, false);
    }

    protected override void OnKeyDown(KeyEventArgs e) 
    {
        base.OnKeyDown(e);
        Invalidate();
    }

    protected override void OnKeyUp(KeyEventArgs e) 
    {
        base.OnKeyUp(e);
        Invalidate();
    }

    protected override void OnMouseDown(MouseEventArgs e)     
    {
        base.OnMouseDown(e);
        Invalidate();
    }

    protected override void OnMouseMove(MouseEventArgs e) 
    {
        base.OnMouseMove(e);
        Invalidate();
    }

    protected override void OnFontChanged(EventArgs e) 
    {
        if (_paintedFirstTime)
            SetStyle(ControlStyles.UserPaint, false);
        base.OnFontChanged(e);
        if (_paintedFirstTime)
            SetStyle(ControlStyles.UserPaint, true);
    }
    #endregion
} 
```

基本上我使用了 GlassTextBox 的代码，并在 OnPaint 函数中添加了几行代码来绘制提示。

# php - 停止来自 php 函数 gzuncompress 的错误消息

> ID：12310681
> 
> 赞同：3
> 
> 时间：2012-09-07T01:42:55.497
> 
> 标签：php, error-suppression

以下 php 代码在控制台“数据错误”上输出。发生这种情况的原因是一个已知问题，但我想摆脱错误消息。

```
<?php   
    gzuncompress("foo");
?> 
```

我在网上搜索了如何抑制 php 上的错误消息并尝试了以下方法，但没有成功：

```
<?php   
    error_reporting(0); 
    ini_set("display_errors",0);
    ob_start(); 
    @gzuncompress("foo");
    ob_end_clean();
?> 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T05:25:13.043

这很可能是您指定了自定义错误处理程序。

推理：

1.  ob_start() / ob_end_clean() 是浪费时间 - 这不会抑制警告消息，只会抑制您通过回声等抽出的内容。所以放下这两行。

2.  error_reporting(0) 应该足够了——这表示“关闭所有错误”。您不会在错误日志或屏幕上看到它。但是仍然会调用自定义错误处理程序。

3.  “display_errors”将阻止它进入屏幕，但它会出现在您的日志文件中。

4.  @ 也会抑制消息 - 本质上它会临时设置“error_reporting(0)”。但是仍然会调用 cusom 错误处理程序。

因此，唯一能解决所有这些问题的是自定义错误处理程序。即使您使用 @ 抑制错误或使用 error_reporting(0)，它仍然会被调用。客户错误处理程序本身应调用 error_reporting()，如果为“0”，则应确保它不会产生错误。它可能有自己的“保留缓冲区，吐出我的消息然后恢复缓冲区”代码，这就是它绕过 ob_start() 的原因。

只有我能想到的原因：我刚刚通过控制台和 webbrowser / apache 在上面运行了您的代码，并且它很干净 - 没有显示警告等，如您所愿。

# iphone - 添加子视图会在子视图和导航栏之间留下空隙

> ID：12310683
> 
> 赞同：1
> 
> 时间：2012-09-07T01:43:23.813
> 
> 标签：iphone, ios, xcode, cocoa-touch, ios5

我有一个包含在导航控制器中的视图的故事板，底部有一个 UI 选项卡栏。我动态地将子视图添加到此视图中，但导航栏和子视图之间总是有一个空行，似乎是状态栏的宽度。在情节提要上创建的每个子视图上，我将它们的模拟指标设置为将底部栏设置为选项卡栏，状态栏设置为无，顶部栏设置为导航栏。

下面是我添加子视图的代码：

```
 if(!self.homeViewController){
         self.homeViewController = [self.storyboardinstantiateViewControllerWithIdentifier:@"HomeView"];        
    }

    if(self.currentViewController != self.homeViewController)
    {            
        [self.view insertSubview:self.homeViewController.view belowSubview:self.tabBar];
        [self.currentViewController removeFromParentViewController];
    }

    self.currentViewController = self.homeViewController; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-28T10:01:21.403

在 Storyboard 中定义的 homeViewController 上，将“Resize View From NIB”属性设置为**未勾选**（默认勾选）。这解决了我的差距问题。

# ruby-on-rails - Mongoid 持久性问题

> ID：12310686
> 
> 赞同：2
> 
> 时间：2012-09-07T01:43:33.470
> 
> 标签：ruby-on-rails, mongodb, mongoid

我试图在我的 Rails 应用程序中分配一个属性，但是，当我重新查询数据库时，分配的数据消失了。这是我的模型：

```
class Scent
  include Mongoid::Document

  field :scentid, type: Integer
  field :name
  field :price
  field :category
  field :description
  field :available, type: Boolean

  belongs_to :order
  embedded_in :cartitem

  attr_accessible :name, :price, :category, :available
end

class Cartitem
  include Mongoid::Document  

  field :quantity, type: Integer

  embeds_one :scent
  embedded_in :cart
end 
```

这是我正在运行的查询：

```
1.9.3p194 :001 > User.first.cart.cartitems.first.scent
=> nil
1.9.3p194 :060 > User.first.cart.cartitems.first.scent = Scent.first
=> #<Scent _id: 50381e2ec8bafa1710000001, _type: nil, scentid: 1, name: "gold", price"99.99", category: "fresh", description: nil, available: true, order_id: nil>
1.9.3p194 :061 > User.first.cart.cartitems.first.scent
=> nil 
```

关于为什么会发生这种情况的任何想法？谢谢您的帮助！

**编辑：**这是我的用户和购物车模型：

```
 field :firstname
  field :lastname
  field :email
  field :password
  field :password_confirmation
  field :password_digest
  field :stripeid
  field :remember_token

  has_many :orders
  embeds_many :address
  embeds_one :cart

  attr_accessible :firstname, :lastname, :email, :password, :password_confirmation
  has_secure_password
  before_save { |user| user.email = email.downcase }
  before_save :create_remember_token

  validates :firstname, presence: true, length: {maximum: 50}
  validates :lastname, presence: true, length: {maximum: 50}
  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence: true, format: {with: VALID_EMAIL_REGEX}, uniqueness:{case_sensitive: false}
  validates :password, presence: true, length: {minimum: 6}
  validates :password_confirmation, presence: true

  index({email:1}, {unique: true, name: 'email_index'})

  private
    def create_remember_token
    self.remember_token = SecureRandom.urlsafe_base64
  end
end

class Cart
  include Mongoid::Document  

  embedded_in :user
  embeds_many :cartitems

end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T01:47:00.847

你没有打电话`save`给模特。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T06:44:09.147

这是你的答案

```
user = User.first.cart.cartitems.first
user.scent = Scent.first
user.save! 
```

它会正常工作。

# hibernate - JPA/Hibernate Join 和 Fetch 单列

> ID：12310688
> 
> 赞同：5
> 
> 时间：2012-09-07T01:43:50.813
> 
> 标签：hibernate, jpa

我是 JPA/Hibernate 的新手。假设我有这两个表：

*   Employee (Id, Name, DeptId, ..) // DeptId 是外键。
*   Department (Id, DeptName, ..) // 部门单独持久化

和如下实体：

```
@Entity
public class Employee {
    @Id
    @GeneratedValue(strategy=GenerationType.IDENTITY)
    private int id;
    private String name;
    private long salary;

    @OneToOne(cascade = {CascadeType.PERSIST})
    @JoinColumn(name="DEPT_ID") 
    private Dept dept;
    ...
    }

@Entity
public class Dept {
    @Id
    @GeneratedValue(strategy=GenerationType.IDENTITY)
    private int id;
    private String name;
    ...
    **other huge collections with eager fetch ***
    } 
```

在我的应用程序 DAO 中，每当我访问 Employee 实体时，我只需要将部门名称作为员工实体的一部分，而不需要从部门表中获取其他任何内容。

1.  如何获取部门。仅名称列，而不是员工实体中的整个部门行（需要避免急切地获取部门收集的大量数据）？如果是这样，我应该使用什么注释？
2.  在这种情况下如何处理级联？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-07T06:07:49.097

The best option is to make the collection lazy loaded and then change the queries where the collection is needed to eager load (using join fetch). If you have a very good reason not to do that then you can try the following workarounds.

You can use a projection query. This will result in a [employee,name] array for each result.

```
select employee, employee.dept.name from Employee employee 
```

You can use @Formula to map an attribute in Employee table to a column in Department table (note that this solution is Hibernate-specific)

```
class Employee {

   @Formula("(select deptName from Department where Department.id = DEPT_ID)"
   String deptName;

} 
```

The other option is to create an new class DeptLite which doesn't have the collection. Map it as readonly - `@org.hibernate.annotations.Entity(mutable=false)`.

```
@Entity
public class Employee {

    @Id @GeneratedValue(strategy=GenerationType.IDENTITY)
    private int id;
    private String name;
    private long salary;

    @OneToOne(cascade = {CascadeType.PERSIST})
    @JoinColumn(name="DEPT_ID") 
    private Dept dept;

    @OneToOne(updatable=false,insertable=false)
    @JoinColumn(name="DEPT_ID") 
    private DeptLite deptLite;

    ...
}

@Entity
@org.hibernate.annotations.Entity(mutable=false)
class DeptLite  {

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T06:44:40.767

如果您想要限制实体中加载的属性，我认为有两种方法可以实现：

1.  使用[惰性属性获取](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/performance.html#performance-fetching-lazyproperties)，并在模型中注释您不想在每次检索实体时加载的属性。

2.  使用 Hibernate Projections 并限制您在每个查询中需要哪些属性，为每个属性添加一个 PropertyProjection。像这样的东西：

    ```
    Projections.projectionList().add(Projections.property("prop1")).add(Projections.property("prop2")).. 
    ```

希望这有帮助。

# windows-phone-7 - 远程服务器返回错误：NotFound。使用 HttpWebRequest 执行 HTTP Post 请求时从 Windows Phone 模拟器

> ID：12310689
> 
> 赞同：1
> 
> 时间：2012-09-07T01:44:09.757
> 
> 标签：windows-phone-7, windows-phone-8, azure-storage

好的。使用此代码有一段时间了，但今天突然间它开始给我“远程服务器返回错误：未找到”。错误。

我的 Blob 存储容器配置为“公共读取访问（仅限 Blob）”。' 我可以完美地从我桌面上的 Internet Explorer 访问该文件。

从 WP7 模拟器中的 Internet Explorer 访问时，我收到内部服务器错误 500。在我的应用程序中，我的 WebClient downloadstringAsync 给了我“远程服务器返回错误：未找到。”

不太确定发生了什么，但似乎我的 WP7 模拟器的网络搞砸了。

**更新：**重新启动。跑DSInit.exe。已删除本地数据库文件。重新运行 DSInit.exe（这次失败了）。恢复本地数据库文件。它再次起作用了。重新启动计算机。启动模拟器。它不再起作用了。:(

**更新 2：**再次运行 DSInit.exe /forcecreate。它再次起作用。

**更新 3：**重新启动。问题又回来了。

# jquery - 如何让 jQuery 解析我的错误响应，表示为有效的 json？

> ID：12310702
> 
> 赞同：24
> 
> 时间：2012-09-07T01:47:20.550
> 
> 标签：jquery, ajax

这是我的代码：

```
 $.ajax({
        url: "/api/invoice/" + newInvoice._id,
        type: 'PUT',
        data: JSON.stringify(newInvoice),
        dataType: 'json',
        contentType: "application/json; charset=utf-8"
      })
        .success(function () {
          $('#statusLine').text('Successfully submitted invoice {0}. Click here to dismiss.'.format(newInvoice._id));
        })
        .error(function (err) {
          alert(err);
        }); 
```

请求：

```
PUT http://localhost:8000/api/invoice/16211 HTTP/1.1
Host: localhost:8000
Connection: keep-alive
Content-Length: 770
Origin: http://localhost:8000
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11
Content-Type: application/json; charset=UTF-8
Accept: application/json, text/javascript, */*; q=0.01
Referer: http://localhost:8000/invoice.html?id=16211
Accept-Encoding: gzip,deflate,sdch
Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3

{"items":[{"id":... 
```

请求正文实际上是一个有效的 json，为简洁起见，我只是将其截断。

响应：

```
HTTP/1.1 409 Conflict
X-Powered-By: Express
Content-Type: application/json; charset=utf-8
Content-Length: 1386
ETag: 250542419
Connection: keep-alive

{
  "msg": "Cannot update the invoice #16211, because it has already been updated by someone else.",
  "invoice": {
    "items": [
      {... 
```

同样，响应是一个完全有效的 json，为简洁起见被截断。

正如预期的那样，处理程序是用对象`error`调用的。`err`但是，我怎样才能掌握解析的 json？当然，我可以检查响应的内容类型是否为 json，然后`err.responseText`自己解析，但这不是 jQuery ajax 应该为我做的吗？`$.get`我的意思是，当我从服务器获取对象时，它会为我的查询执行此操作。

我错过了什么？

**编辑**

这是对[https://stackoverflow.com/a/12310751/80002](https://stackoverflow.com/a/12310751/80002)的更正：

执行请求：

```
var ajax = $.ajax(... 
```

处理错误响应：

```
var res, ct = ajax.getResponseHeader("content-type") || '';
if (ct.indexOf('json') > -1) {
  res = $.parseJSON(err.responseText);
  // process the response here
} 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2014-09-11T15:08:53.547

我遇到了同样的问题，发现与@Barmar 的回答略有不同。

除了`responseText`，还有一个`responseJSON`属性，因此您可以执行以下操作：

```
var json_response = err.responseJSON.msg; 
```

如果`console.log(err);`那里有一些属性，您可能希望在页面上的错误消息中使用它们。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-09-07T01:51:26.510

对于带有非 200 ¹ [HTTP 状态码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)的错误消息，jQuery 不会解析内容。如果您真的不想自己将返回的结果解析为 JSON，则必须返回 HTTP 状态 200 并使用`success`( `done`) 回调。

这是一个好兆头，您正在使用（来自您的示例）HTTP 代码 409，我认为您应该继续这样做 - 只需咬紧牙关并在错误处理程序中手动解析 JSON。如果解析失败，则说明其他问题（如临时网络故障），但这将允许您构建一个很好的 API，您（可能还有其他人）可以使用该 API，而无需在成功函数中构建太多错误检查。

*`success`为快乐的结果而坚持，为不快乐的结果而坚持`error`。*

¹从技术上讲，任何 2xx 状态都应视为成功；[在 jQuery 中`(status >= 200 && status < 300 || status === 304)`算是成功](https://github.com/jquery/jquery/blob/05337e78fa68aac3a3d703d7cc59f145f13ea779/src/ajax.js#L477)的。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-09-07T01:56:03.063

`$.parseJSON`在错误回调中显式调用：

```
(...)
.error(function (err) {
  var msg = $.parseJSON(err).msg;
  alert(msg);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-09T20:10:21.237

获取 JSON 格式非常简单。它已经被 jQuery 推荐了。

```
var error = error.responseJSON 
```

# ruby - Ruby 是否能够确定键（或方法参数）是否是 proc？

> ID：12310705
> 
> 赞同：0
> 
> 时间：2012-09-07T01:48:49.447
> 
> 标签：ruby, proc

执行[此代码 kata](https://github.com/JiggyPete/getting_iffy)，我必须从以下方法中删除尽可能多的 if 语句：

```
#  returns permissions if user is set in security context
def get_user_permissions 
  user_permissions = Set.new
  if (@user != nil)
    user_permissions << :DEFAULT_PERMISSION
    if (has_cm_team_role) 
      user_permissions << :CM_TEAM_ROLE_PERMISSION
    end
    if (has_cm_invoice_view_role || has_invoice_finance_role)
      user_permissions << :CM_INVOICE_USER_PERMISSION
      user_permissions << :INVOICE_VIEW_PERMISSION
      user_permissions << :ACCESS_ALL_INVOICE_PERMISSION
    end
    if (has_invoice_finance_role) 
      user_permissions << :FINANCE_INVOICE_PERMISSION
    end
    if (has_application_access)
      user_permissions << :CM_INVOICE_USER_PERMISSION
    end
    if (has_application_access(:CM_INVOICE_ROLE)) 
      user_permissions << :CM_ANY_INVOICE_PERMISSION
    end
    if (has_application_access(:PA_INVOICE_ROLE)) 
      user_permissions << :PA_ANY_INVOICE_PERMISSION
    end
    if (has_application_access(:SDT_INVOICE_ROLE))
      user_permissions << :SDT_ANY_INVOICE_PERMISSION
    end
  end
  user_permissions
end 
```

我的第一次尝试**几乎**成功了，但有一些测试失败了：

```
def get_user_permissions 
  user_permissions = Set.new
  if (@user != nil)
    user_permissions << :DEFAULT_PERMISSION
    # add the permissions in another method
    add_permissions(user_permissions)
  end
  user_permissions
end

def add_permissions(user_permissions)
  # a hash where each key is a condition, and each value is a permission
  hash = {
    has_cm_team_role => :CM_TEAM_ROLE_PERMISSION,
    has_cm_invoice_view_role || has_invoice_finance_role => :CM_INVOICE_USER_PERMISSION,
    has_cm_invoice_view_role || has_invoice_finance_role => :INVOICE_VIEW_PERMISSION,
    has_cm_invoice_view_role || has_invoice_finance_role => :ACCESS_ALL_INVOICE_PERMISSION,
    has_invoice_finance_role => :FINANCE_INVOICE_PERMISSION,
    has_application_access => :CM_INVOICE_USER_PERMISSION,
    has_application_access(:CM_INVOICE_ROLE) => :CM_ANY_INVOICE_PERMISSION,
    has_application_access(:PA_INVOICE_ROLE) => :PA_ANY_INVOICE_PERMISSION,
    has_application_access(:SDT_INVOICE_ROLE) => :SDT_ANY_INVOICE_PERMISSION
  }

  # loop through the hash and add permissions if the key is true
  hash.each do |condition, permission|
    if (condition)
      user_permissions << permission
    end
  end 
```

这种方法的问题**在于**，**每个**. 所以我通过使用 Procs 来解决这个问题，如下所示：

```
def add_permissions(user_permissions)
  hash = {
    Proc.new{has_cm_team_role} => :CM_TEAM_ROLE_PERMISSION,
    Proc.new{has_cm_invoice_view_role || has_invoice_finance_role} => :CM_INVOICE_USER_PERMISSION,
    Proc.new{has_cm_invoice_view_role || has_invoice_finance_role} => :INVOICE_VIEW_PERMISSION,
    Proc.new{has_cm_invoice_view_role || has_invoice_finance_role} => :ACCESS_ALL_INVOICE_PERMISSION,
    Proc.new{has_invoice_finance_role} => :FINANCE_INVOICE_PERMISSION,
    Proc.new{has_application_access} => :CM_INVOICE_USER_PERMISSION,
    Proc.new{has_application_access(:CM_INVOICE_ROLE)} => :CM_ANY_INVOICE_PERMISSION,
    Proc.new{has_application_access(:PA_INVOICE_ROLE)} => :PA_ANY_INVOICE_PERMISSION,
    Proc.new{has_application_access(:SDT_INVOICE_ROLE)} => :SDT_ANY_INVOICE_PERMISSION
  }
  hash.each do |condition, permission|
    if (condition.call)
      user_permissions << permission
    end
  end
end 
```

**好的**，这可行，并且测试都通过了，但是我将**所有**键转换为 Procs，以便其中 3 个正确评估。我宁愿只在需要时使用 Procs，即第二个、第三个和第四个键，如下所示：

```
def add_permissions(user_permissions)
  hash = {
    # just use the method name unless a Proc is required
    has_cm_team_role => :CM_TEAM_ROLE_PERMISSION,
    # use a Proc here, so that the OR is evaluated later
    Proc.new{has_cm_invoice_view_role || has_invoice_finance_role} => :CM_INVOICE_USER_PERMISSION,
    Proc.new{has_cm_invoice_view_role || has_invoice_finance_role} => :INVOICE_VIEW_PERMISSION,
    Proc.new{has_cm_invoice_view_role || has_invoice_finance_role} => :ACCESS_ALL_INVOICE_PERMISSION,
    has_invoice_finance_role => :FINANCE_INVOICE_PERMISSION,
    has_application_access => :CM_INVOICE_USER_PERMISSION,
    has_application_access(:CM_INVOICE_ROLE) => :CM_ANY_INVOICE_PERMISSION,
    has_application_access(:PA_INVOICE_ROLE) => :PA_ANY_INVOICE_PERMISSION,
    has_application_access(:SDT_INVOICE_ROLE) => :SDT_ANY_INVOICE_PERMISSION
  } 
```

然后某种方法来确定键是否是 Proc，如果是，则调用它，但如果不是，则将条件视为任何其他键：

```
 hash.each do |condition, permission|
    if condition.is_proc?
      if (condition.call)
        user_permissions << permission
      end
    elsif condition
      user_permissions << permission
    end
  end
end 
```

有小费吗？有什么比我尝试这样做更好的想法吗？通过这样做，我是否让它变得更加循环复杂？我应该坚持使用我所有的键都是 Procs 的工作解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T02:30:35.753

`condition.is_a? Proc`满足你的条件吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T02:40:52.467

与proc问题无关。我从来没有做过代码 kata，但我认为你可以改进的地方很少。

首先，将条件作为哈希键对我来说是个坏主意。您将有许多重复的键，只有 false 和 true。
我会以另一种方式来做，并将您的权限设置为键，值将是 true 或 false。

您还有 3 次完全相同的说明，每次只需更改 2 个字母。

```
if (has_application_access(:CM_INVOICE_ROLE)) 
  user_permissions << :CM_ANY_INVOICE_PERMISSION
end
if (has_application_access(:PA_INVOICE_ROLE)) 
  user_permissions << :PA_ANY_INVOICE_PERMISSION
end
if (has_application_access(:SDT_INVOICE_ROLE))
  user_permissions << :SDT_ANY_INVOICE_PERMISSION
end 
```

可以减少到

```
%(cm pa sdt).each do |key|
    user_permissions << :"#{key}_ANY_INVOICE_PERMISSION" if has_application_access(:"#{key}_INVOICE_ROLE")
end 
```

我尝试自己这样做并得到了两个结果。一种使用散列，另一种则尽可能多地切割。

```
# Hash version
def get_user_permissions
  return Set.new if !!@user

  user_permissions_hash = {:DEFAULT_PERMISSION => true,
                           :CM_TEAM_ROLE_PERMISSION => has_cm_team_role,
                           :CM_INVOICE_USER_PERMISSION => has_cm_invoice_view_role || has_invoice_finance_role || has_application_access,
                           :INVOICE_VIEW_PERMISSION => has_cm_invoice_view_role || has_invoice_finance_role,
                           :ACCESS_ALL_INVOICE_PERMISSION => has_cm_invoice_view_role || has_invoice_finance_role,
                           :FINANCE_INVOICE_PERMISSION => has_invoice_finance_role
  }
  %(cm pa sdt).each do |key|
    user_permissions_hash[:"#{key}_ANY_INVOICE_PERMISSION"] = has_application_access(:"#{key}_INVOICE_ROLE")
  end

  return user_permissions_hash.map {|k, v| k if v}.compact.to_set
end

# Normal version
def get_user_permissions
  return (user_permissions = Set.new) if !!@user

  user_permissions << :DEFAULT_PERMISSION
  user_permissions << :CM_TEAM_ROLE_PERMISSION if has_cm_team_role
  user_permissions << :CM_INVOICE_USER_PERMISSION if has_cm_invoice_view_role || has_invoice_finance_role || has_application_access
  if (has_cm_invoice_view_role || has_invoice_finance_role)
    user_permissions << :INVOICE_VIEW_PERMISSION
    user_permissions << :ACCESS_ALL_INVOICE_PERMISSION
  end
  user_permissions << :FINANCE_INVOICE_PERMISSION if has_invoice_finance_role
  %(cm pa sdt).each do |key|
    user_permissions << :"#{key}_ANY_INVOICE_PERMISSION" if has_application_access(:"#{key}_INVOICE_ROLE")
  end

  user_permissions
end 
```

# ruby-on-rails - Rails 3 命名空间路由，适用于管理员，也适用于非管理员

> ID：12310711
> 
> 赞同：0
> 
> 时间：2012-09-07T01:49:40.843
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个客户管理区域，效果很好！

```
namespace :admin do
  root to: "base#clients"
  resources :clients
end 
```

我想要索引并显示来自 app/controllers/clients_controller.rb 的操作也适用于非管理员并保留所有管理员 CRUD，但使用上述路线时`No route matches [GET] "/clients"`，我会遇到错误预期的，因为我将路由移到了管理命名空间中。

我的问题是如何将我的非命名空间管理员操作公开给非管理员，并且仍然在我的上述路由中维护管理员命名空间操作？

-J

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T16:46:53.870

只需`resources :clients, :only => [:index, :show]`在命名空间之外添加`:admin`。有关更多选项，请参阅[http://guides.rubyonrails.org/routing.html#restricting-the-routes-created](http://guides.rubyonrails.org/routing.html#restricting-the-routes-created)。

当您进入`rake routes`终端时，您始终可以检查创建的路线。

# android - Android模拟器将未知的电话号码更改为默认号码

> ID：12310715
> 
> 赞同：1
> 
> 时间：2012-09-07T01:50:50.660
> 
> 标签：android, android-emulator

我想获取模拟器的电话号码，但是当我在setting-about phone-status中查看电话号码时，电话号码显示为“未知”。有时电话号码会显示一个号码。如何获取安卓模拟器的电话号码。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T02:18:26.253

您的模拟器没有电话号码。如果您想“呼叫”它或“发送短信”它是这样的： 1\. 在 Eclipse 中打开 DDMS 透视图。（右上角，单击新窗口小按钮 -> DDMS 2。在左侧的模拟器控制下，您应该会看到一个名为“电话操作”的部分 3。在那里您可以输入您自己的电话号码（这将是来电号码）以及打电话甚至写短信（检查短信，然后在框中编写）。 4\. 点击发送，你应该看到它进入你的模拟器。

希望这可以帮助！

# wcf - 如何在 BizTalk Server 2010 中配置 netMessagingBinding

> ID：12310716
> 
> 赞同：1
> 
> 时间：2012-09-07T01:50:54.887
> 
> 标签：wcf, azure, biztalk

我安装了 Windows Azure SDK 1.6、BizTalk Server 2010 和 Windows EAI SDK April 2012 CTP。

在使用 WCF 自定义适配器创建接收位置时，我必须使用 netMessagingBinding，它不会出现在`WCF-Custom`传输属性的绑定类型列表中。

我在 Microsoft.Net Framework 4.0.30319 下的 machine.config 文件中添加了以下部分

在 bindingExtensions 下

```
<add name="netMessagingBinding" 
     type="Microsoft.ServiceBus.Messaging.Configuration.NetMessagingBindingCollectionElement, 
    Microsoft.ServiceBus, Version=1.6.0.0, Culture=neutral, 
    PublicKeyToken=31bf3856ad364e35"/> 
```

在 bindingElementsExtension 下

```
<add name="netMessagingTransport" 
    type="Microsoft.ServiceBus.Messaging.Configuration.NetMessagingTransportExtensionElement, 
    Microsoft.ServiceBus, Version=1.6.0.0, Culture=neutral, 
    PublicKeyToken=31bf3856ad364e35"/> 
```

我还缺少什么绑定类型仍然没有出现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T08:58:07.287

[这](http://tycholien.wordpress.com/2011/10/31/bindings-for-biztalk-2010-and-azure-service-bus/)对我有用：

1.  安装适用于 .NET 的 Windows Azure 库（Azure Appfabric SDK）。请注意，Azure Appfabric [SDK 1.7](http://www.microsoft.com/en-za/download/details.aspx?id=29988)现已推出。
2.  使用为 .NET 4 设置 requiredRuntime 的文件运行[RelayConfigurationInstaller.exe](http://blog.wadewegner.com/2010/05/net-framework-4-0-and-the-azure-appfabric-sdk/)，或者通过[手动将](http://tycholien.wordpress.com/2011/10/31/bindings-for-biztalk-2010-and-azure-service-bus/)绑定元素扩展和绑定扩展添加到**32**位和 64 位机器配置来执行此操作，如上所述。
3.  重启 BTS 管理控制台

*匿名用户编辑：*

*   32 位配置在这里：%WINDIR%\Microsoft.NET\Framework\v4.0.30319\Config
*   64 位配置在这里：%WINDIR%\Microsoft.NET\Framework64\v4.0.30319\Config

# android - 具有多列的 Android SQLite 数据库

> ID：12310719
> 
> 赞同：2
> 
> 时间：2012-09-07T01:51:28.830
> 
> 标签：android, database, sqlite

所以我正在尝试创建一个包含名称、卡路里和蛋白质列的数据库。这是创建语句：

```
public class SQLHelp extends SQLiteOpenHelper{
    static final String DATABASE_NAME = "Food.db";
    static final String TABLE_FOOD = "food";
    static final String NAME_COLUMN = "FoodName";
    static final String CALORIE_COLUMN = "Calorie";
    static final String PROTEIN_COLUMN = "Protein";
    static final String FAT_COLUMN = "Fat";
    static final String COLUMN_ID = "id";

    public SQLHelp(Context c){
        super(c, DATABASE_NAME, null, 1);
    }

    public void onCreate(SQLiteDatabase db){
        String makeTable = "CREATE TABLE " + TABLE_FOOD + "("
                + NAME_COLUMN + " TEXT," + CALORIE_COLUMN + " INTEGER,"
                + PROTEIN_COLUMN + " INTEGER" + ")";
        db.execSQL(makeTable);      
    } 
```

使用以下方法将值添加到数据库中：

```
public void createFood(Food f) {
    ContentValues values = new ContentValues();
    values.put(SQLHelp.CALORIE_COLUMN, f.getCalories());
    values.put(SQLHelp.PROTEIN_COLUMN, f.getProtein());
    values.put(SQLHelp.NAME_COLUMN, f.getName());
    database.insert(SQLHelp.TABLE_FOOD, null,
            values);
} 
```

当它尝试添加时，LogCat 给我一个 SQLiteException 说蛋白质列不存在。更奇怪的是，当我运行带有注释掉的蛋白质行的代码时，一切正常。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T02:00:49.350

您的数据库助手仅在您更新版本号时更新数据库。您正在运行不包含这些列的版本 #1 数据库。

如果您将版本更改为 2，它将反映您新添加的列

```
 public SQLHelp(Context c){
        super(c, DATABASE_NAME, null, 2); //note the 2 here
    } 
```

# r - 使用ggplot2将2维数据“挤压”到热图中

> ID：12310722
> 
> 赞同：0
> 
> 时间：2012-09-07T01:51:46.917
> 
> 标签：r, ggplot2, heatmap

我有一个如下所示的数据框：

```
obj date    colour  measurement
A   01      red     10
A   02      green   20
A   03      red     5
B   01      green   10
B   02      red     30
B   03      red     50 
```

我知道如何以热图格式呈现 df[,c("obj","date","colour")]：

```
chart <- ggplot(data=temp.df,aes(x=date,y=obj,fill=colour))
chart <- chart + geom_tile() 
```

但我也想通过不透明度将“测量”变量“挤压”到图中。也就是说，对于 A-03，它将是最浅的红色，而对于 B-03，它将是最深的红色。

它在 R 和 ggplot2 中可行吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T02:09:35.417

`alpha`就是你要找的。仍在努力获得一个合理的传说。

```
 ggplot(df, aes(x=obj,y=date,fill = colour, alpha = measurement)) + 
     geom_tile() + 
     scale_fill_identity() + scale_alpha(guide = 'none')+
     theme_bw() + opts(panel.grid.major = theme_blank()) 
```

![在此处输入图像描述](../Images/22ea539129128ce3198d2ca582cb5288.png)

# xaml - 使用 C# 和 XAML 向 Metro 风格应用程序按钮添加拖放功能

> ID：12310731
> 
> 赞同：0
> 
> 时间：2012-09-07T01:53:03.667
> 
> 标签：xaml, drag-and-drop, windows-runtime, windows-store-apps, winrt-xaml

我正在尝试在我的应用程序中实现一种拖动功能。作为一个简单的例子，想象一下我有一个 2x2 正方形的按钮，所以总共有四个按钮。单击一个按钮将执行一些其他功能，但是我希望当他们按住并拖动其中一个按钮以使其执行其他操作时（理想情况下，如果您将一个按钮拖放到另一个按钮的空间中，则两个按钮将交换位置，只要我可以拖放工作，交换应该很容易）。

我已经进行了一些研究并遵循了一些教程，但似乎在所有这些步骤中都出现了错误。似乎 ListViews 和 GridViews 已经有一些拖放功能，但是我在这些视图中正确安排我的按钮（有四个以上，它们位于非常特定的位置，如图表）时遇到了麻烦，更不用说拖动了并放弃与他们合作。

我该怎么做呢？理想情况下，我可以将这些按钮标记为可拖动，然后在拖放事件中检查放置位置，如果该位置有效，则执行交换方法。我似乎无法弄清楚如何使它们可拖动或如何有一个检查放置位置的事件。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T04:01:15.507

Easy peasy，创建一个看起来像您想要的方式的自定义控件，将 ManipulationMode 设置为 TranslateX|TranslateY，处理操作增量事件以使用 Canvas 或 TranslateTransform 之类的东西更新定位，并且当操作完成时 - 使其单击或动画到新的位置。根据我的经验 - 让任何其他操作与常规 Button 类一起工作是行不通的，因为按钮是一个非常简单的控件 - 在这种情况下，创建自己的控件比尝试扩展现有的控件更容易。

# python - 创建列表时语法无效

> ID：12310733
> 
> 赞同：2
> 
> 时间：2012-09-07T01:53:50.073
> 
> 标签：python, list

因此，我试图创建 3 个不同的列表，其中一个是 1k，一个是 10k，另一个是 100k 项目中的一个，其中长满了从 1 到 1000 万的随机数，但我似乎无法弄清楚为什么它一直说它的语法无效。到目前为止，我有：

编辑：好的，它似乎已经通过一些调整解决了无效的语法问题，但仍然给了我：

```
Traceback (most recent call last):
  File "C:/Python32/funtime.py", line 16, in <module>
    print (list[1])
TypeError: 'type' object is not subscriptable 
```

这正是我输入的内容：

```
import random

def createlist(a):

    blist =[]
    count=0
    while count <= a:

        blist.append(random.randint(1,10000000))
        count= count+1
    return blist;

list1= createlist(10000);

print (list[1]) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T02:31:51.093

```
Traceback (most recent call last):
  File "C:/Python32/funtime.py", line 16, in <module>
    print (list[1])
TypeError: 'type' object is not subscriptable 
```

类型`type`的对象确实不可下标。`list`是内置列表类的名称，它是`type`. 给它下标没有任何意义，所以这显然不是你打算做的。

你的意思是`print (list1[1])`。`list1`是您绑定到由创建的列表对象的名称`createlist(10000)`。

找到这类错误的诀窍是查看 Python 给你的错误消息。它准确地告诉你问题所在，以及为什么它是一个问题。所缺少的只是实现`list`不是您要下标的对象的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T02:04:39.937

以下在我的系统上运行良好。

```
import random

def createlist(a):

    blist =[]
    count= 0
    while count <= a:
        blist.append(random.randint(1,1000000))
        count=count+1
    return blist

list1= createlist(10000)

print list1[1] 
```

[http://ideone.com/SL2bL](http://ideone.com/SL2bL) <--在这里试试。

我可能会这样做

```
import random

def createlist(a):

    return [random.randint(1,1000000) for i in xrange(a)]

list1= createlist(10000)

print list1[1] 
```

或者可能只是跳过该功能..

```
list1 = [random.randint(1,1000000) for i in xrange(a)]
print list1[1] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T02:15:39.267

一个更短的版本是：

```
>>> import random
>>> def create_list(length):
...     return [random.randint(1,1000000) for _ in range(length)] 
```

这说明了几件事：

1.  一种更紧凑的循环`x`时间方式（`for _ in range(length)`成语）
2.  [列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)式来创建列表，而不是重复调用`append`.
3.  `_`当您需要变量而不是其中的实际数据时，将其用作变量名。这是一个比较常见的约定，最常出现在列表推导中。不使用它不是问题，但它经常出现，以至于意识到它是值得的。

向@mgilson 致敬，感谢他对另一个让我想起`_`约定的答案的评论。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T02:16:08.513

使用列表理解（它的方式让你看起来很专业，哈哈）

```
[random.randint(1, 1000000) for i in range(10000)] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-07T02:24:33.310

正如其他一些答案所述，您可以轻松地将[列表理解](http://en.wikipedia.org/wiki/List_comprehension)用于这样的事情（所谓的*Pythonic*方式）：

```
somelist = [random.randint(1, 1000000) for i in xrange(10000)] 
```

列表解析在 Python 中很快，因为它是由底层 C 代码执行的。此外，使用`[xrange](http://docs.python.org/library/functions.html#xrange)`更节省内存。

注意：按照惯例，当 Python 中不使用循环控制变量时，它被命名为`_`：

```
somelist = [random.randint(1, 1000000) for _ in xrange(10000)] 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-07T02:04:53.473

`while`首先，除非您正在评估复杂的表达式，否则不要使用括号。

接下来，您使用分号返回您的`blist`. 没有必要。

最后...为什么不使用 for 循环？

```
import random

def createlist(a): 
    blist =[]

    for x in xrange(a):
        blist.append(random.randint(1,1000000))

    return blist

list1= createlist(10000)

print list1[0] 
```

# php - 如何修改相册/照片上传流程？

> ID：12310736
> 
> 赞同：1
> 
> 时间：2012-09-07T01:54:05.723
> 
> 标签：php, facebook-graph-api

我正在创建一个`FaceBook`应用程序，用户在其中选择多个图像，应用程序会从它们生成一个图像（`PHP`）。我给生成的图像 a`semi-random name - $storage_url = $rack_directory . "rack_" . mt_rand() . mt_rand() . ".png"; (e.g. rack_2128639756968968165.png)`并临时存储它。

我希望用户能够`Facebook`直接从页面而不是`downloading`然后将生成的图像上传到他们的个人资料`uploading`。

在查看此站点以及其他站点中的答案时，看起来我可以使用它：

```
 $app_id = "YOUR_APP_ID";
   $app_secret = "YOUR_APP_SECRET";
   $post_login_url = "YOUR_POST-LOGIN_URL";
   $album_name = 'YOUR_ALBUM_NAME';
   $album_description = 'YOUR_ALBUM_DESCRIPTION';

   $code = $_REQUEST["code"];

   //Obtain the access_token with publish_stream permission 
   if(empty($code))
     {
       $dialog_url= "http://www.facebook.com/dialog/oauth?"
       . "client_id=" . $app_id 
       . "&redirect_uri=" . urlencode($post_login_url)
       . "&scope=publish_stream";
       echo("<script>top.location.href='" . $dialog_url . 
       "'</script>");
   } 
   else {
     $token_url= "https://graph.facebook.com/oauth/"
     . "access_token?"
     . "client_id=" .  $app_id 
     . "&redirect_uri=" . urlencode( $post_login_url)
     . "&client_secret=" . $app_secret
     . "&code=" . $code;
     $response = file_get_contents($token_url);
     $params = null;
     parse_str($response, $params);
     $access_token = $params['access_token'];

     // Create a new album
     $graph_url = "https://graph.facebook.com/me/albums?"
     . "access_token=". $access_token;

     $postdata = http_build_query(
     array(
      'name' => $album_name,
      'message' => $album_description
        )
      );
     $opts = array('http' =>
     array(
      'method'=> 'POST',
      'header'=>
        'Content-type: application/x-www-form-urlencoded',
      'content' => $postdata
      )
     );
     $context  = stream_context_create($opts);
     $result = json_decode(file_get_contents($graph_url, false, 
       $context));

     // Get the new album ID
     $album_id = $result->id;

     //Show photo upload form and post to the Graph URL
     $graph_url = "https://graph.facebook.com/". $album_id
       . "/photos?access_token=" . $access_token;
     echo '<html><body>';
     echo '<form enctype="multipart/form-data" action="'
     .$graph_url. ' "method="POST">';
     echo 'Adding photo to album: ' . $album_name .'<br/><br/>';
     echo 'Please choose a photo: ';
     echo '<input name="source" type="file"><br/><br/>';
     echo 'Say something about this photo: ';
     echo '<input name="message" type="text"
        value=""><br/><br/>';
     echo '<input type="submit" value="Upload" /><br/>';
     echo '</form>';
     echo '</body></html>';
  } 
```

...生成一个独特的相册并上传图片...但是 - 我不想显示一个让用户浏览并上传的表单（在他们右键/控制单击并保存页面中的图像之后）。只需获取页面上显示的现有生成图像并提交即可。

有没有我可以使用的功能来完成这个过程并且唯一的表单要求是提交和上传？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T04:58:10.860

您需要的是 Facebook SDK：https://developers.facebook.com/docs/reference/php/

这使得所有这些“图形”调用变得更加简单。

从该页面粘贴：

```
// Load the facebook SDK
require_once("facebook.php");

$config = array();
$config['appId'] = 'YOUR_APP_ID';
$config['secret'] = 'YOUR_APP_SECRET';
$config['fileUpload'] = false; // optional

$facebook = new Facebook($config);

try { 
   $uid = $facebook->getUser();
catch (FacebookApiException $e) { 
   // Not logged on - you should log them on. Various methods, but redirect to $facebook->getLoginURL() is simplest. Docs: https://developers.facebook.com/docs/reference/php/facebook-getLoginUrl/
} 
```

用户登录后，您也可以通过 SDK 上传：

```
// Now upload the file
try { 
    $facebook->setFileUploadSupport('http://MyDomain.com/'); 
    $response = $facebook->api( 
      '/me/photos/', 
      'post', 
      array( 
        'message' => 'Image Cpation', 
        'source' => '@/path/to/image' // @-sign must be the first character 
      ) 
    ); 
  } 
  catch (FacebookApiException $e) { 
    error_log('Could not post image to Facebook.'); 
  } 
```

您可以使用专辑 ID 代替“我”直接上传到特定专辑。但是，通过 SDK 进行工作将比使用图形调用手动尝试所有帮助更多！

抱歉，这不是一个完整的“这里是代码”答案（还有一些工作要做），但这应该可以帮助您在不提示用户的情况下上传。

# sql-server-2008 - 是否可以在没有 BizTalk 中断的情况下修补群集 SQL Server？

> ID：12310738
> 
> 赞同：1
> 
> 时间：2012-09-07T01:54:10.437
> 
> 标签：sql-server-2008, biztalk, maintenance, biztalk-2010

我们有一个由群集 SQL 环境支持的 BizTalk Server 安装，以实现高可用性。

但是，每当修补 SQL 环境时，都会在节点故障转移过程中出现暂时中断。因此主机实例停止并且 BizTalk 关闭（如果我们移动到 CU2，主机实例将自动重新启动，但这是一个单独的问题）。

这是不可取的，因为它会阻止传入的 Web 请求并破坏打开的 Web 服务客户端。因此，是否有在不中断 BizTalk 的情况下优雅地修补 SQL Server 的策略？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T05:57:48.530

看来这是不可能的。将此标记为已接受的答案，直到有人能给我惊喜。

# c# - 通过数据迁移使应用程序在没有 SQL Server 的情况下工作？

> ID：12310743
> 
> 赞同：0
> 
> 时间：2012-09-07T01:54:47.087
> 
> 标签：c#, .net, entity-framework

我必须在使用 WinForms/C#、SQL server 和 EF 4 开发的桌面应用程序上工作。

DAL 已使用 Repository 和 UoW 模式实现。数据仅用于只读目的。您能否介绍如何通过使用来自某些文件、XML 或内存集合中的数据来删除数据库并修改应用程序以使其工作。需要对 DAL 进行一些更改。

请指导如何使用最少的更改来完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T05:26:55.810

存储库是一种抽象，因此，您只需要编写另一个实现即可。像这样的东西：

```
public interface IRepository<T>
{
  IQuerable<T> GetEntities();
}

// this works with database
public class SomeEntityDbRepository<SomeEntity> : IRepository<SomeEntity>
{
  // ...

  public IQuerable<SomeEntity> GetEntities()
  {
    return dbContext.Set<SomeEntity>();
  }
}

// this works with file storage:
public class SomeEntityFileRepository<SomeEntity> : IRepository<SomeEntity>
{
  // ...

  public IQuerable<SomeEntity> GetEntities()
  {
    using (var stream = new Filestream(/* ... */))
    {
      var serializer = /* ... */;
      var someEntities = /* ...deserialize from file */

      return someEntities.AsQuerable();
    }
  }
} 
```

然后将此实现提供给 BLL，例如，通过依赖注入。此外，您可以将 DI 容器配置放入 app.config 中，使数据源配置更加灵活。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T23:31:56.890

我终于将我的数据库转换为 SQL Server CE。

# jquery - s3Slider - 保留幻灯片位置和速度错误

> ID：12310744
> 
> 赞同：0
> 
> 时间：2012-09-07T01:54:48.460
> 
> 标签：jquery, session, slideshow

我已经在我的网站上正确实现了 s3Slider ( [http://www.serie3.info/s3slider/](http://www.serie3.info/s3slider/) )，但有几个问题需要解决。

首先，有一个与 jQuery 相关的问题，即图像交换延迟逐渐减少，因此在延长一段时间后，幻灯片会加速到图像之间几乎没有延迟的程度。我不想修改 s3Slider.js 文件，因为我认为我只会让它变得更糟。

其次，有没有办法，也许使用 PHP 会话，来保留页面之间的幻灯片（即当前图像）的位置，这样它就不会在每次单击链接时重新开始？我想要大约十几张图片，但我觉得只能看到前几张。

我已经联系了作者，但他还没有回复。

**编辑：**我修复了速度问题。作者提出了一个奇怪的条件，只要鼠标在滑块之外，间隔基本上就会减半。

# php - 如何在 smarty 中显示数组？

> ID：12310747
> 
> 赞同：2
> 
> 时间：2012-09-07T01:55:30.103
> 
> 标签：php, arrays, loops, smarty

我想用 smarty 产生一个像这样的数组结果 ['element1','element2','element3'] 。我正在使用 PHP 和 smarty。该数组由 PHP 生成，然后由 smarty 以上述格式或样式输出。我的 PHP 代码是这样的：

```
$countries = array('America','Germany','Japan'); 
```

我想在 Smarty 中显示相同的数组内容，但这次结果应该在 smarty 中显示为 this

```
['America','Germany', 'Japan'] 
```

任何人都可以帮助我吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T02:35:38.097

在此处检查[foreach 循环](http://www.smarty.net/docsv2/en/language.function.foreach)
**PHP CODE**

```
$countries = array('America','Germany','Japan');
$smarty->assign('countries', $countries); 
```

**智能代码**

```
[
{foreach from=$countries item=country}
    {assign var='total' value=$countries|@count}         {* This stores the total no. of elements in COUNTRIES array in TOTAL variable *}
    {counter assign="count"}                             {* This assigns a counter to COUNT variable *}
    '{$country}'
    {if $count lt $total}
    ,                                                    {* This condition adds ',' after each element of the array until and unless the loop reaches the last element. When the last element reached, this condition won't add ',' *}
    {/if}
{/foreach}
] 
```

# java - 如何在 Wicket 1.5 中关闭一页的重定向？

> ID：12310748
> 
> 赞同：0
> 
> 时间：2012-09-07T01:55:41.253
> 
> 标签：java, redirect, wicket, wicket-1.5

我们在 Wicket 1.5 上，因为 6 尚未发布。而且我需要关闭一页的重定向（它上面没有任何有意义的表单）。如何在 Wicket 1.5 中关闭一页的重定向？

编辑：我们在 wicket 1.5 上，因为 wicketstuff 尚未为 wicket 6 发布。没有有意义的表格意味着我们可能有一个搜索框，但没有用户必须输入有价值信息的表格。它本质上是产品视图页面。

我的意思是重定向到添加了一些 id 的同一页面。我不是 wicket 方面的专家，我听说它是​​由 AJAX 支持来解决后退按钮问题的。

Edit2：我想要的是从我的页面中删除重定向，即使它是有状态的。可以在 Wicket 中使用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T06:15:59.173

如果通过删除重定向只是意味着从 URL 中删除页面版本号，那么请查看另一个 Stack Overflow 问题：[删除 url 中的版本号](https://stackoverflow.com/questions/8602489/delete-version-number-in-url/8667136)。

如果您还想通过 AJAX 发送一些表单，Wicket 示例中有[一个示例](http://www.wicket-library.com/wicket-examples/ajax/form)。

# jquery - 使用 Jquery UI Sortable 更改边距

> ID：12310752
> 
> 赞同：4
> 
> 时间：2012-09-07T01:56:12.440
> 
> 标签：jquery, jquery-ui

如果您拖放一些元素，您会注意到一些元素之间的边距变窄了。我怎样才能解决这个问题？

**例子：**

[http://jsfiddle.net/fKQsG/](http://jsfiddle.net/fKQsG/)

![在此处输入图像描述](../Images/cdccfea8693d4a4beea629e9d54fe59c.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T01:59:07.630

看，`LI`有一个 的属性`display: inline;`，它也会计算空格。替换它，`float: left;`它会工作。

```
#sortable1 li, #sortable2 li {margin: 0 5px 5px 5px; padding: 5px; font-size: 1.2em; width: 50px; float: left; list-style-type:none; background:black; } 
```

我变了`width: 50px; float: left;`。

**更新小提琴：http: [//jsfiddle.net/fKQsG/1/](http://jsfiddle.net/fKQsG/1/)**

# android - 删除 png 中的白色像素（alpha 通道）

> ID：12310754
> 
> 赞同：0
> 
> 时间：2012-09-07T01:56:48.507
> 
> 标签：android, png

我有一个使用硬币 png 的 ImageView。png 是方形的，圆形硬币之外的所有东西都显示为白色而不是清晰。我将如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T02:04:28.720

角落在您的 png 文件中不透明。

您需要使用您最喜欢的图像编辑器事先将它们透明化，或者您可以使用在线服务[在这里](http://www.lunapic.com/editor/?action=transparent)

# python - 是否有比标准 .load 方法更快的加载 yaml 文件的方法？Django/Python

> ID：12310755
> 
> 赞同：0
> 
> 时间：2012-09-07T01:56:59.693
> 
> 标签：python, django, upload, load, yaml

我正在加载一个大的 yaml 文件，它需要很长时间。我想知道是否有比 yaml.load() 方法更快的方法。

我读过有一个 CLoader 方法，但无法运行它。

建议此 CLoader 方法的网站要求我这样做：

```
Download the source package PyYAML-3.08.tar.gz and unpack it. 
Go to the directory PyYAML-3.08 and run:
    $ python setup.py install

If you want to use LibYAML bindings, which are much faster than the pure Python version, you need to download and install LibYAML. 
Then you may build and install the bindings by executing
    $ python setup.py --with-libyaml install

In order to use LibYAML based parser and emitter, use the classes CParser and CEmitter:

    from yaml import load, dump
    try:
       from yaml import CLoader as Loader, CDumper as Dumper
    except ImportError:
       from yaml import Loader, Dumper 
```

这看起来可行，但我的 Django 项目中的任何地方都没有 setup.py 目录，因此无法安装/导入任何这些东西

谁能帮我弄清楚如何做到这一点，或者让我知道另一种更快的加载方法？

谢谢您的帮助！！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-07T08:07:51.857

我不知道什么更快 - bspymaster 的想法可能是最有用的。

当你下载 PyYAML-3.08.tar.gz 时，在存档里面会有一个 setup.py 你可以运行。

注意使用LibYAML，下载这个：[http ://pyyaml.org/download/libyaml/yaml-0.1.4.tar.gz](http://pyyaml.org/download/libyaml/yaml-0.1.4.tar.gz)

并使用[http://pyyaml.org/wiki/LibYAML中的说明运行](http://pyyaml.org/wiki/LibYAML)

你需要一套构建工具，应该安装在 linux/unix 上，对于 osx 确保安装了 xcode，我不确定 windows。

# php - 在加载另一个页面时下载文件

> ID：12310760
> 
> 赞同：0
> 
> 时间：2012-09-07T01:57:46.777
> 
> 标签：php, javascript, joomla, download

上下文是这样的：

1.  用户点击一个按钮
2.  使用页面上的新信息刷新页面（echo 用于打印 html 代码）。
3.  一个 file.txt 被创建
4.  创建的文件的下载应该会自动开始

使用下面的代码，创建了文件并显示了页面的其余部分，但没有开始下载。另外，如果我点击链接，下载不会开始，但 txt 文件会在浏览器中打开（虽然我想强制下载）。

另一方面，如果我注释 javascript 并取消注释标题说明，我会刷新正确的页面并下载 txt 文件，但该文件的内容是错误的（它包含在页面其余部分回显的 html 代码）。

=================不工作代码==================

```
 echo "
      <form name=\"fn\" action=\"index.php?option=com_comp\" method=\"post\">
      // more not related stuff
      <input type=\"image\" src=\"".JURI::root().
      "components/com_comp/images/download_icon.png\" .
      "\" name=\"downloadaddresses\">DOWNLOAD_RESULTS
      // more not related stuff";

      if($_POST['downloadaddresses_x']!=0) {

            $myfilename = "tmp/results.txt";
            $fh = fopen($myfilename, 'w');

            $recipients = $_POST['recipients'];
            $semicolon_separated = implode(";", $recipients);

            fwrite($fh, $semicolon_separated);
            fclose($fh);

            /*header('Content-disposition: attachment; filename='.$myfilename);
            header("Content-type: application/octet-stream");*/

            echo "<a href=\"".$myfilename."\" id=\"downloadlink\">
            This download should start automatically!</a>";
            echo "<script type=\"text/javascript\">
                    newwindow=function{
            window.open('".$myfilename."','name','height=400,width=200');
                    if (window.focus) {newwindow.focus()}}
                </script>";
        } 
```

=========================更多代码不起作用==================

```
 <script type="text/javascipt">  
    var el = document.getElementById('downloadlink');
    if (document.createEvent) {
        var event = document.createEvent(\"MouseEvents\");
        event.initEvent(\"click\", true, true);
        el.dispatchEvent(event);
    }
    else if (el.click) {
        el.click();
    }
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T02:03:14.943

而不是这个`click`模拟代码：

```
<script type="text/javascipt">  
var el = document.getElementById('downloadlink');
if (document.createEvent) {
    var event = document.createEvent(\"MouseEvents\");
    event.initEvent(\"click\", true, true);
    el.dispatchEvent(event);
}
else if (el.click) {
    el.click();
}
</script> 
```

你能用这个吗：

```
<script type="text/javascript">
    location.href = document.getElementById('downloadlink').getAttribute('href');
</script> 
```

# c# - 如何架构这样的项目？

> ID：12310762
> 
> 赞同：2
> 
> 时间：2012-09-07T01:58:10.017
> 
> 标签：c#, design-patterns, user-interface

说我有两个课程：

```
 ClassA{
    //properties 
    public string NAME{set;get;}
    public string ID{set;get;}
    public int AGE{set;get;}
    //Methods
    public void DoSomething();
    public void MethodA();
    private void MethodB(string name);
    private void MethodC(string name);
    public void MethodD(string name,string id);
    public string getSomething(int age);
    }

    ClassB{
    public void Hello(int input);
    public void HelloWorld(string input);
    } 
```

1）对于ClassA（可能有很多派生类），创建设计界面（GUI）的最佳方法是什么，以便我可以指定其属性值

2）对于ClassA，有没有办法创建一个设计界面（GUI），以便我可以指定调用哪个方法并指定调用方法的顺序/输入/输出？

```
 public void DoSomethingWithClassA(ClassA ca ){
    ca.MethodA();
  //  ca.MethodB(ca.NAME);
  //  ca.MethodB(ca.ID);
    ca.MethodD(ca.NAME,getSomthing(ca.AGE));

    } 
```

3）如果我有一个名为newClassA的ClassA实例，一个名为newClassB的ClassB实例，有没有办法创建一个设计界面（GUI），以便我可以指定newClassB可以调用newClassA的方法：

```
ClassA newClassA...
ClassB newClassB...

newClassB.HelloWorld(newClassA.getSomething(newClassA.AGE)); 
```

基本上我需要的是有一个设计界面（GUI），以便用户可以“可视化设计”他的类，并可以指定方法的关系/输入/输出。我觉得它有点像过滤图。

如果有人可以找出解决方案/框架/设计模式/关键字，将不胜感激。

（我应该强调设计界面对用户来说意味着 GUI，对此感到抱歉。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T02:09:52.600

我认为您正在寻找流畅的界面之类的东西。

看看这篇文章，它应该可以帮助你如何实现这个：[http ://blog.raffaeu.com/archive/2010/06/26/how-to-write-fluent-interface-with-c-and -lambda.aspx](http://blog.raffaeu.com/archive/2010/06/26/how-to-write-fluent-interface-with-c-and-lambda.aspx)

这是一个关于如何使用它的快速示例：

```
public class Person
{
    public string Name { get; set; }
    public int Age { get; set; }

    internal Person { }
}

public class PersonFactory
{
    public NameSetter CreatePerson()
    {
        return new NameSetter(new Person());
    }
}

public class NameSetter
{
    private Person person;

    internal NameSetter(Person person)
    {
        this.person = person;
    }

    public AgeSetter SetName(string name)
    {
        this.person.Name = name;
        return new AgeSetter(this.person);
    }
}

public class AgeSetter
{
    private Person person;

    internal AgeSetter(Person person)
    {
        this.person = person;
    }

    public Person SetAge(int age)
    {
        this.person.Age = age;
        return this.person;
    }
}

public class Program
{
    public void Main()
    {
        Person p = new PersonFactory()
                       .CreatePerson()
                       .SetName("Bob")
                       .SetAge(30);
    }
} 
```

我更新了示例以制作`Person`内部的构造函数。这不是强制性的，但如果您这样做，它将强制您的代码的任何用户使用流利的接口来创建`Person`.

# ajax - JSON PARSE ERROR 200 意外令牌

> ID：12310764
> 
> 赞同：0
> 
> 时间：2012-09-07T01:58:44.980
> 
> 标签：ajax, json

我从我的 jquery ajax 请求中得到了这个错误。ERROR 200 意外的令牌

这是我的 JSON：

```
{
    "data": [
        {
            "answer": "sofo",
            "email": "jk@gmail.com",
            "secretquestion": "bestfriend"
        }
    ],
    "status": 1,
    "message": "Success!"
} 
```

我在 JSONLint 上进行了验证，我得到了 Unexpected 令牌。我无法理解我的错。你有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T06:33:08.833

JSON 是有效的。反序列化时，令牌名称可能有所不同（拼写错误？）。

# android - AsyncTask 在 doInBackground() 中崩溃

> ID：12310769
> 
> 赞同：1
> 
> 时间：2012-09-07T01:59:27.227
> 
> 标签：android, crash, android-asynctask

您会看到我正在尝试在此适配器上加载一些数据，但我无法制作 AsyncTask 来显示进度对话框。

这是它给我错误的程序的完整代码。我完全修改了所以不要编辑任何 UI。

```
public class MatchNowGames extends Activity {
Games games = new Games();
Iterator iterador;
private ProgressDialog dialog;
GamesArrayAdapter adapter;
ListView lv;
public void onCreate(Bundle savedInstanceState) {       
    super.onCreate(savedInstanceState);        
    // INCIO PROGRAMA        
    setContentView(R.layout.games_list);
    lv = (ListView) this.findViewById(R.id.gamesLV);
    // Creamos el thread
    dialog = new ProgressDialog(this);
    dialog.setMessage("Cargando...");
    dialog.setTitle("Progreso");
    dialog.setCancelable(false);

    // INIT VARIABLES
    new CargandoJuegos().execute(); 
    adapter = new GamesArrayAdapter(App.context().getApplicationContext(), R.layout.games_list, games.getGames());      

}
private class CargandoJuegos extends AsyncTask<Void, Void, Void>{
    protected void onPreExecute() {
            dialog.show();
            }

     protected Void doInBackground(Void... urls) {
         // AÑADIMOS LOS JUEGOS
        try {
            games.addGames(MatchNow.serverGames);
            try {
                Thread.sleep(5000);
            } catch (InterruptedException e) {

                e.printStackTrace();
            }
        } catch (JSONException e) {}
        return null;
     }
     protected void onPostExecute(Void unused) {
         dialog.dismiss();
         lv.setAdapter(adapter);
     }

  }

} 
```

这是我们在显示进度对话框时应该做的：

```
// Start progress dialog
    try {
            games.addGames(MatchNow.serverGames);
        } catch (JSONException e) {
            e.printStackTrace();
        }
    // Finish progress dialog
    GamesArrayAdapter adapter = new GamesArrayAdapter(App.context().getApplicationContext(), R.layout.games_list, games.getGames());
    ListView lv = (ListView) this.findViewById(R.id.gamesLV);
    lv.setAdapter(adapter); 
```

非常感谢您提前=）

日志猫：

```
09-07 02:18:07.916: D/AndroidRuntime(890): Shutting down VM
09-07 02:18:07.916: W/dalvikvm(890): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
09-07 02:18:07.926: E/AndroidRuntime(890): Uncaught handler: thread main exiting due to uncaught exception
09-07 02:18:07.936: E/AndroidRuntime(890): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{match.now.play/match.now.play.MatchNowGames}: java.lang.NullPointerException
09-07 02:18:07.936: E/AndroidRuntime(890):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2417)
09-07 02:18:07.936: E/AndroidRuntime(890):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)
09-07 02:18:07.936: E/AndroidRuntime(890):  at android.app.ActivityThread.access$2200(ActivityThread.java:119)
09-07 02:18:07.936: E/AndroidRuntime(890):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
09-07 02:18:07.936: E/AndroidRuntime(890):  at android.os.Handler.dispatchMessage(Handler.java:99)
09-07 02:18:07.936: E/AndroidRuntime(890):  at android.os.Looper.loop(Looper.java:123)
09-07 02:18:07.936: E/AndroidRuntime(890):  at android.app.ActivityThread.main(ActivityThread.java:4363)
09-07 02:18:07.936: E/AndroidRuntime(890):  at java.lang.reflect.Method.invokeNative(Native Method)
09-07 02:18:07.936: E/AndroidRuntime(890):  at java.lang.reflect.Method.invoke(Method.java:521)
09-07 02:18:07.936: E/AndroidRuntime(890):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
09-07 02:18:07.936: E/AndroidRuntime(890):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
09-07 02:18:07.936: E/AndroidRuntime(890):  at dalvik.system.NativeStart.main(Native Method)
09-07 02:18:07.936: E/AndroidRuntime(890): Caused by: java.lang.NullPointerException
09-07 02:18:07.936: E/AndroidRuntime(890):  at android.app.Activity.findViewById(Activity.java:1612)
09-07 02:18:07.936: E/AndroidRuntime(890):  at match.now.play.MatchNowGames.<init>(MatchNowGames.java:40) 
```

我解决了1612行的问题，是疏忽。Logcat 确实出问题了。带来不便敬请谅解。

```
 09-07 02:18:07.936: E/AndroidRuntime(890):  at java.lang.Class.newInstanceImpl(Native Method)
    09-07 02:18:07.936: E/AndroidRuntime(890):  at java.lang.Class.newInstance(Class.java:1479)
    09-07 02:18:07.936: E/AndroidRuntime(890):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
    09-07 02:18:07.936: E/AndroidRuntime(890):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2409)
    09-07 02:18:07.936: E/AndroidRuntime(890):  ... 11 more

09-07 02:34:31.486: D/dalvikvm(930): GC freed 404 objects / 23688 bytes in 60ms
09-07 02:34:32.976: I/global(930): Default buffer size used in BufferedReader constructor. It would be better to be explicit if an 8k-char buffer is required.
09-07 02:34:32.986: I/System.out(930): {"games":[{"id":"1","image":"http:\/\/cibermaniacos.com\/images\/stories\/call_of_duty_modern_warfare_3_desvelado_dest01.jpg","name":"Call Of Duty MW3","descrip":"","modes":[{"id":"1","name":"1vs1","mode_icon":"none"},{"id":"2","name":"2vs2","mode_icon":"none"}],"console":"PS3,XBOX"},{"id":"2","image":"http:\/\/www.hry-na-mobil.eu\/data\/ikonky\/hry-na-mobil-eu\/46801\/call-of-duty-world-at-war-codww-1000x1000jpg-12.png","name":"Prueba","descrip":"afafs","modes":[{"id":"1","name":"1vs1","mode_icon":"none"},{"id":"2","name":"2vs2","mode_icon":"none"}],"console":"steam,PS3"},{"id":"4","image":"http:\/\/cibermaniacos.com\/images\/stories\/call_of_duty_modern_warfare_3_desvelado_dest01.jpg","name":"Call Of Duty MW2","descrip":"AWDAWD","modes":[{"id":"1","name":"1vs1","mode_icon":"none"},{"id":"2","name":"2vs2","mode_icon":"none"}],"console":"steam,PS3"}]}                  
09-07 02:34:33.036: I/System.out(930): Call Of Duty MW2
09-07 02:34:33.046: I/System.out(930): Call Of Duty MW3
09-07 02:34:33.068: W/dalvikvm(930): threadid=15: thread exiting with uncaught exception (group=0x4001b188)
09-07 02:34:33.068: E/AndroidRuntime(930): Uncaught handler: thread AsyncTask #1 exiting due to uncaught exception
09-07 02:34:33.086: E/AndroidRuntime(930): java.lang.RuntimeException: An error occured while executing doInBackground()
09-07 02:34:33.086: E/AndroidRuntime(930):  at android.os.AsyncTask$3.done(AsyncTask.java:200)
09-07 02:34:33.086: E/AndroidRuntime(930):  at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
09-07 02:34:33.086: E/AndroidRuntime(930):  at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
09-07 02:34:33.086: E/AndroidRuntime(930):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
09-07 02:34:33.086: E/AndroidRuntime(930):  at java.util.concurrent.FutureTask.run(FutureTask.java:137)
09-07 02:34:33.086: E/AndroidRuntime(930):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
09-07 02:34:33.086: E/AndroidRuntime(930):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
09-07 02:34:33.086: E/AndroidRuntime(930):  at java.lang.Thread.run(Thread.java:1096)
09-07 02:34:33.086: E/AndroidRuntime(930): Caused by: java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare()
09-07 02:34:33.086: E/AndroidRuntime(930):  at android.os.Handler.<init>(Handler.java:121)
09-07 02:34:33.086: E/AndroidRuntime(930):  at android.app.Activity.<init>(Activity.java:673)
09-07 02:34:33.086: E/AndroidRuntime(930):  at match.now.play.functions.Game.<init>(Game.java:52)
09-07 02:34:33.086: E/AndroidRuntime(930):  at match.now.play.functions.Games.addGames(Games.java:58)
09-07 02:34:33.086: E/AndroidRuntime(930):  at match.now.play.MatchNowGames$CargandoJuegos.doInBackground(MatchNowGames.java:67)
09-07 02:34:33.086: E/AndroidRuntime(930):  at match.now.play.MatchNowGames$CargandoJuegos.doInBackground(MatchNowGames.java:1)
09-07 02:34:33.086: E/AndroidRuntime(930):  at android.os.AsyncTask$2.call(AsyncTask.java:185)
09-07 02:34:33.086: E/AndroidRuntime(930):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
09-07 02:34:33.086: E/AndroidRuntime(930):  ... 4 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T03:11:56.783

你可以参考这个：[Can't create handler inside thread that has not called Looper.prepare() inside AsyncTask for ProgressDialog](https://stackoverflow.com/questions/3614663/cant-create-handler-inside-thread-that-has-not-called-looper-prepare-inside-a)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T12:10:00.373

看起来您的`doInBackground()`方法中唯一真正的代码是这样的：

```
 games.addGames(MatchNow.serverGames); 
```

但是，您没有向我们展示该`addGames()`方法中发生了什么。您是否正在尝试以该方法对**UI**进行操作？如果是这样，那将是一个问题。

`doInBackground()`不用于直接进行任何 UI 调用。如果在后台处理期间需要更新 UI，您通常会`publishProgress()`从内部调用`doInBackground()`trigger `onProgressUpdate()`。您可以从内部进行 UI 调用`onProgressUpdate()`。

# c - 默认 GCC 标志

> ID：12310772
> 
> 赞同：1
> 
> 时间：2012-09-07T01:59:57.517
> 
> 标签：c, gcc

我正在编写一个简单的 C 程序，我应该用缓冲区溢出来攻击它。所以，我不希望在编译时使用任何标志。如何消除使用的默认标志？

```
# readelf -p .GCC.command.line stack

String dump of section '.GCC.command.line':
  [     0]  stack.c
  [     8]  -D_FORTIFY_SOURCE=2
  [    1c]  -mtune=generic
  [    2b]  -march=i486
  [    37]  -frecord-gcc-switches
  [    4d]  -fstack-protector 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T02:08:35.097

那里唯一可以覆盖的两个选项是`-D_FORTIFY_SOURCE`and `-fstack-protector`，因此只需包含`-U_FORTIFY_SOURCE`and `-fnostack-protector`，它们实际上已经“消失”了。

您不能为“无架构”（`march`）进行编译，并且摆脱`mtune`同样没有意义。GCC 必须为*某些东西*构建代码。你已经尽可能地通用了。

`-frecord-gcc-switches`，好吧，如果没有它，您首先不会知道包含哪些开关，但是如果您真的想摆脱它，只需使用`-fnorecord-gcc-switches`.

[`-f*`选项](http://gcc.gnu.org/onlinedocs/gcc/Code-Gen-Options.html)主要是布尔标志，所以你几乎总是可以通过在前面添加来关闭它们，`no`就像我在上面所做的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T02:05:55.923

做类似的事情怎么样

```
gcc -dumpspecs > myspecs.txt 
```

根据需要编辑规范并编译

```
gcc -specs=myspecs.txt 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T02:18:34.650

如果看起来您的问题是您使用的是供应商/发行版提供的 gcc，该 gcc 已被黑客入侵以默认打开各种与安全相关的选项。其他答案有关于如何撤消更改的提示，但是如果您想使用原始的默认 gcc，最好​​自己编译并以非默认符号安装它，并将其用于您的实验。

# django - Django ModelForm is_valid 自动保存实例

> ID：12310775
> 
> 赞同：9
> 
> 时间：2012-09-07T02:00:04.340
> 
> 标签：django, modelform

我发现 Django 中的 ModelForm 非常易于使用，它节省了大量的开发时间。

但是，当我意识到 is_valid 实际上保存了 ModelForm 时，我被卡住了！我想知道这是否是预期的行为，还是我做错了什么？

发生在我身上的是

```
 form=SOME_MODEL_FORM(...., instance=cafe)
    print cafe.name # "CAFE OLD NAME"
    if request.method="POST":
        if form.is_valid():
            ### HERE the cafe instance has been changed
            print cafe.name # "CAFE NEW NAME" 
```

我使用 post_save 调试，is_valid 确实保存了模型！

我目前的解决方法是在调用 is_valid 之前将模型保存在另一个对象中，然后保存回来以覆盖 chang。这真的是黑客行为，我希望有一种更优雅的方式来实现相同的目标（在 is_valid 调用之后不保存模型）。

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-07T04:11:20.490

否`form.is_valid()`不会将新数据保存在 DB 中。但是，它会使用新属性更新实例对象，以便在您调用时可以使用它们`form.save()`。

以下是如何验证这一点：

```
>>> mc = MyModel.objects.get(id=3)
>>> mf=MyModelForm({'name': 'abcd'}, instance=mc)
>>> mc.name
u'oldName'
>>> mf.is_valid()
True
>>> mc.name
u'abcd'
>>> mc2 = MyModel.objects.get(id=3)  #get the new instance from DB
>>> mc2.name
u'OldName'
>>> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T02:57:16.567

form.is_valid() 不保存表单，它只是检查验证，顾名思义。

见这里[https://docs.djangoproject.com/en/dev/ref/forms/api/#django.forms.Form.is_valid](https://docs.djangoproject.com/en/dev/ref/forms/api/#django.forms.Form.is_valid)

在此处阅读模型表单中的 is_valid 方法 [https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#the-is-valid-method-and-errors](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#the-is-valid-method-and-errors)

# android - android 4.0 toast.cancel() 不能正常工作

> ID：12310779
> 
> 赞同：0
> 
> 时间：2012-09-07T02:00:58.493
> 
> 标签：android

在我的应用程序中，我想取消旧的吐司，并显示新的吐司。但效果不佳。

```
 Handler postHandler = new Handler();     
                        postHandler.post(new Runnable() {  
                            @Override  
                            public void run() {  

                                    if (toast != null) {  
                                        toast.cancel();
                                toast.maketext(this,"new toast",Toast.LENGTH_LONG);

                                    } 
                                    toast.show();  

                            }  
                        });  

                return false;
            }
        }); 
```

但没有显示。

logcat 显示：

```
E/AndroidRuntime( 6706): FATAL EXCEPTION: main
E/AndroidRuntime( 6706): java.lang.NullPointerException
E/AndroidRuntime( 6706):        at android.view.View.onAttachedToWindow(View.java:9533)
E/AndroidRuntime( 6706):        at android.view.View.dispatchAttachedToWindow(View.java:9786)
E/AndroidRuntime( 6706):        at android.view.ViewGroup.dispatchAttachedToWindow(ViewGroup.java:2198)
E/AndroidRuntime( 6706):        at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:957)
E/AndroidRuntime( 6706):        at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2453)
E/AndroidRuntime( 6706):        at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime( 6706):        at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime( 6706):        at android.app.ActivityThread.main(ActivityThread.java:4424)
E/AndroidRuntime( 6706):        at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime( 6706):        at java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime( 6706):        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
E/AndroidRuntime( 6706):        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
E/AndroidRuntime( 6706):        at dalvik.system.NativeStart.main(Native Method)
W/ActivityManager(  183):   Force finishing activity com.rk.youming/.Testsurfacevie 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T02:11:28.493

您的代码没有真正的意义。您引用新的 toast 并在它显示之前尝试`cancel()`它。如果你愿意，`cancel()`你必须在引用旧 toast 的对象上调用它，而不是新的。如果 toast 是`null`你不会取消（）它（因为`if`），但仍然尝试以`show()`NPE 结束。

# angularjs - 在AngularJS中按字母顺序对下拉列表进行排序

> ID：12310782
> 
> 赞同：161
> 
> 时间：2012-09-07T02:01:39.767
> 
> 标签：angularjs

我通过使用连接到控制器的 ng-options 填充下拉列表，该控制器又调用服务。不幸的是，进来的数据是一团糟，我需要能够按字母顺序对其进行排序。

你认为类似的东西`$.sortBy`会做，但不幸的是它没有做杰克。我知道我可以使用辅助方法或类似方法通过 javascript 对其进行排序`function asc(a,b)`，但我拒绝相信没有更清洁的方法可以做到这一点，而且我不想用辅助方法使控制器膨胀。原则上它是如此基本，所以我不明白为什么 AngularJS 没有这个。

有没有办法做类似的事情`$orderBy('asc')`？

例子：

```
<select ng-option="items in item.$orderBy('asc')"></select> 
```

拥有选项非常有用，`orderBy`这样您就可以在通常尝试对数据进行排序时做任何您想做的事情。

* * *

## 回答 #1

> 赞同：344
> 
> 时间：2012-09-07T03:02:13.037

Angular 有一个[orderBy](http://docs.angularjs.org/api/ng.filter:orderBy)过滤器，可以像这样使用：

```
<select ng-model="selected" ng-options="f.name for f in friends | orderBy:'name'"></select> 
```

有关示例，请参[见此小提琴。](http://jsfiddle.net/aBccw/)

值得注意的是，如果`track by`正在使用它需要出现在`orderBy`过滤器之后，如下所示：

```
<select ng-model="selected" ng-options="f.name for f in friends | orderBy:'name' track by f.id"></select> 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-09-07T03:14:40.590

您应该能够使用过滤器：`orderBy`

`orderBy`可以接受`reverse`标志的第三个选项。

```
<select ng-option="item.name for item in items | orderBy:'name':true"></select> 
```

这里项目按“名称”属性以相反的顺序排序。第二个参数可以是任何顺序函数，因此您可以按任何规则排序。

@see [http://docs.angularjs.org/api/ng.filter:orderBy](http://docs.angularjs.org/api/ng.filter:orderBy)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-26T17:06:20.173

```
var module = angular.module("example", []);

module.controller("orderByController", function ($scope) {
    $scope.orderByValue = function (value) {
        return value;
    };

    $scope.items = ["c", "b", "a"];
    $scope.objList = [
        {
            "name": "c"
        }, {
            "name": "b"
        }, {
            "name": "a"
        }];
        $scope.item = "b";
    }); 
```

[http://jsfiddle.net/Nfv42/65/](http://jsfiddle.net/Nfv42/65/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-07T04:47:02.633

对于想要在第三层对变量进行排序的任何人：

```
<select ng-option="friend.pet.name for friend in friends"></select> 
```

你可以这样做

```
<select ng-option="friend.pet.name for friend in friends | orderBy: 'pet.name'"></select> 
```

# php - 从html转换时保持ms word中textarea和textbox的值相同

> ID：12310795
> 
> 赞同：0
> 
> 时间：2012-09-07T02:04:46.673
> 
> 标签：php

假设我有这样的表格：

**html2doc.php**

```
 <form method="post" action="htmltodoc.php">
  <table>
        <tr>
            <td>
                <textarea cols="3" rows="2" name="textArea" value=<?=($_POST['textArea'])?>></textarea>
            </td>
        </tr>
        <tr>
            <td>Candidate Name:</td>
            <td colspan="3"><input type="text" name="txtCandidate" /></td>
        </tr>
        <tr>
            <td colspan="3"><input type="submit" name="submit" value="submit" /></td>
        </tr>
    </table>
    <?php
        if(isset($_POST['submit']))
        {                   
                header("Content-type: application/vnd.ms-word");
                header("Content-Disposition: attachment;Filename=html2doc.doc");
        }
    ?>
</form> 
```

**我需要的：**

当用户将数据输入文本区域和文本框时，当我将其转换为 Ms 字时，它将保留所有数据。

**问题：**

当我将其转换为word文档时，它不会显示用户以html形式输入的数据。

关于如何做的任何想法？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T02:10:44.093

`<textarea>`没有一个名为`value`. 对于`<textarea>`你不应该使用的内容`value`。您需要在标签内提供它们。以这种方式更改它：

```
<textarea cols="3" rows="2" name="textArea"><?php echo $_POST['textArea']; ?></textarea> 
```

而且，使用以 . 开头的短代码也不是一个好主意`<?`。

# ruby-on-rails-3 - 在 Rails 的文本字段中显示链接

> ID：12310798
> 
> 赞同：3
> 
> 时间：2012-09-07T02:05:18.943
> 
> 标签：ruby-on-rails-3

在我的 Rails 3.1 应用程序中，我有一个用于评论的文本字段，我希望能够允许人们包含可点击的链接（而不仅仅是显示为纯文本的 url），以及让文本字段识别用户何时拥有文本字段中的换行符（无需用户添加 html）。我怎样才能做到这一点？

如果用户将html作为href，这适用于显示链接： `<%= simple_format(@user.description) %>`

这适用于在 text_field 中识别和显示回车符中的换行符： `<%= h(@user.description).gsub(/\n/, '<br/>').html_safe %>`

但是，我还没有想出如何同时做到这两个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T03:45:52.087

这个怎么样？

```
#Doesnt work in this case
#<%= simple_format( h(@user.description).gsub(/\n/, '<br/>') ).html_safe %> 
```

**编辑：** 似乎你需要`auto_link`功能来实现这一点。尽管它已从 rails 3.1 中删除，但它可以作为 gem 使用。因此**，如果您使用的是 rails 3.1 或更高版本**，则需要从单独的 gem 中获取它

```
#in Gemfile
gem "rails_autolink", "~> 1.0.9"
#in application.rb
require 'rails_autolink'

#Run
bundle install

#now in you view use it like
<%= h auto_link(simple_format(text)) %> 
```

`auto_link`不仅转换网址，还转换可点击链接中的电子邮件地址。[在此处](http://rubydoc.info/gems/rails_autolink/1.0.9/frames)获取文档。

参考链接：

*   [http://rubygems.org/gems/rails_autolink](http://rubygems.org/gems/rails_autolink)
*   [http://apidock.com/rails/ActionView/Helpers/TextHelper/auto_link](http://apidock.com/rails/ActionView/Helpers/TextHelper/auto_link)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-08T00:21:24.703

### 使用临空宝石

[链接在这里。](https://github.com/vmg/rinku)

它出色地解决了这个问题。享受！

# windows - OpenCV - Haartraining 内存不足

> ID：12310801
> 
> 赞同：1
> 
> 时间：2012-09-07T02:06:11.053
> 
> 标签：windows, opencv

我有大约 280 张负片和 7 张正片。当我尝试在 6gb 和四核处理器机器上对这些文件执行 haartraining.exe 文件时。我收到这个错误

![在此处输入图像描述](../Images/85360dcb584b89aa42179b653bf333a9.png)

计算机有 85% 的可用内存。下面是我正在使用的命令。它使用了大约 55% 的内存然后死掉。知道我在做什么错误。

`haartraining.exe -data data/cascade -vec data/vector.vec -bg negative/infofile.txt -npos 1800 -nneg 2620 -nstages 20 -mem 1000 -mode ALL -w 24 -h 24 -nonsym`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T05:52:32.817

基于[这个线程](http://tech.groups.yahoo.com/group/OpenCV/message/53754)，看起来您可以试验`-mem`您传入的参数`haartraining.exe`。看起来您当前已`-mem`设置为`1000`. 你可以试试类似的东西`-mem 3000`吗？玩弄的价值，`-mem`看看会发生什么。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2015-05-01T10:20:41.843

-mem 1000 表示每阶段 1000 Mb 的 RAM。nmem 的 nstage 应该小于您的 RAM 容量。在 Windows 中，您可以扩展它。

# android - GDBSERVER 在启动时退出

> ID：12310803
> 
> 赞同：2
> 
> 时间：2012-09-07T02:06:22.007
> 
> 标签：android, android-ndk, remote-debugging, gdbserver

我正在尝试在 Android (Java/C/C++) 上调试混合代码。我的目标设备是 Vizio 1008。代码在模拟器上运行，我可以使用 GDB 从 Eclipse 调试它。但是，我无法在真实设备上执行此操作。

经过几天的努力，我定位了问题：

当 GDBSERVER 在设备上启动（成功）时，它会立即退出并显示消息：“请求未知寄存器 d0”。因此，不可能进行调试会话。我还尝试了 ARM 的 DS-5 调试器。GDBSERVER 保持连接状态，但在远程调试器尝试连接时退出。我尝试了 GDBSERVER 调试输出，但它没有提供任何有用的信息。

更奇怪的是，我尝试了任何我能得到的 GDBSERVER 版本，它们的行为都是这样的。但是，我从 Google NDK 的旧版本之一（3 或 4 个版本）中找到了 GDBSERVER。这个版本可以工作！！！但是，调试器（在主机上）很快就死了（分段错误），即使我知道程序没问题。

我查看了 GDBSERVER 源代码，看起来，这个错误与 GDBSERVER 检查硬件时的启动顺序有关。可能，它与浮点协处理器有关，但我不确定，因为此错误消息非常通用。

如果重要的话，我正在使用 Google NDK 在 Windows 上进行开发。代码是 99% 的 C/C++，带有 Java shell 和一些用 Java 实现的函数（线程 HTTP 调用）。同样，应用程序可以在设备上运行，并且可以在模拟器上进行调试（Java 和 C/C++）。我还可以在设备上调试 Java 部分。

有谁知道它可能是什么？以及如何解决这个问题？是维齐奥吗？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-17T22:10:57.487

听起来类似于我在尝试进行本机调试时遇到的问题。问题是设备中使用的 arm 处理器同时支持 vfp/neon 指令集和 iwmmx 指令集，并且 gdbserver 显然假设这两者是互斥的。不幸的是，要修复你需要弄乱 gdbserver 源。以下是来自[链接](https://toolchain.googletv-mirrored-source.googlecode.com/hg-history/9adf6cbbe8ec15d9eb24c034212a49f0bd4b2166/gdb/gdb/gdbserver/linux-arm-low.c)的修复。您需要在 gdbserver 源代码树中编辑文件 linux-arm-low.c：

```
static void
arm_arch_setup (void)
{
  arm_hwcap = 0;
  if (arm_get_hwcap (&arm_hwcap) == 0)
  {
    init_registers_arm ();
    return;
  }

/* gdbserver assumes that only one of VFP or IWMMXT is available, which may
 not be true.  In that case, gdbserver fails at run-time with "Unknown
 register d0 requested".  For now, pretend IWMMXT is missing when both are
 available. */
if ((arm_hwcap & HWCAP_VFP) && (arm_hwcap & HWCAP_IWMMXT))
  arm_hwcap &= ~HWCAP_IWMMXT; 
```

但是，您必须更改代码的确切位置取决于 gdb(server) 版本。我知道在 gdb 7.7 的情况下它略有不同。以这种方式更改后，您应该使用 ndk 中的 gcc 构建它，因此它与仿生和其他东西相关联。我没有确切的说明，因为我自己没有这样做。 *我应该强调，这最终更多的是一种解决方法，而不是适当的修复。*我不知道以这种方式修补的 gdbserver 在运行实际包含 iwmmx 指令的代码时如何表现。至少您可能无法获得 iwmmx 寄存器的寄存器转储。

# c++ - 如何用 c/c++ 填充我的 md5 消息

> ID：12310807
> 
> 赞同：0
> 
> 时间：2012-09-07T02:07:29.430
> 
> 标签：c++, c, md5

我正在用 c++ 编写一个程序来执行 md5 校验和。我这样做主要是因为我想我会学到很多关于 c++、校验和、OOP 以及我遇到的任何其他东西的不同的东西。

我在校验和遇到问题，我认为问题出在函数 padbuff 中，它执行消息填充。

```
#include "HashMD5.h"

int leftrotate(int x, int y);
void padbuff(uchar * buffer);

//HashMD5 constructor
HashMD5::HashMD5()
{
  Type = "md5";
  Hash = "";
}

HashMD5::HashMD5(const char * hashfile)
{
  Type = "md5";
  std::ifstream filestr;
  filestr.open(hashfile, std::fstream::in | std::fstream::binary);
  if(filestr.fail())
  {
    std::cerr << "File " << hashfile << " was not opened.\n";
    std::cerr << "Open failed with error ";
  }
}

std::string HashMD5::GetType()
{
  return this->Type;
}

std::string HashMD5::GetHash()
{
  return this->Hash;
}

bool HashMD5::is_open()
{
  return !((this->filestr).fail());
}

void HashMD5::CalcHash(unsigned int * hash)
{
  unsigned int *r, *k;
  int r2[4] = {0, 4, 9, 15};
  int r3[4] = {0, 7, 12, 19};
  int r4[4] = {0, 4, 9, 15};
  uchar * buffer;
  int bufLength = (2<<20)*8;
  int f,g,a,b,c,d, temp;
  int *head;
  uint32_t maxint = 1<<31;

  //Initialized states
  unsigned int h[4]{ 0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476};

  r = new unsigned int[64];
  k = new unsigned int[64];
  buffer = new uchar[bufLength];
  if(r==NULL || k==NULL || buffer==NULL)
  {
    std::cerr << "One of the dyn alloc failed\n";
  }

  // r specifies the per-round shift amounts
  for(int i = 0; i<16; i++)
    r[i] = 7 + (5 * ((i)%4) );

  for(int i = 16; i < 32; i++)
    r[i] = 5 + r2[i%4];

  for(int i = 32; i< 48; i++)
    r[i] = 4 + r3[i%4];

  for(int i = 48; i < 63; i++)
    r[i] = 6 + r4[i%4];

  for(int i = 0; i < 63; i++)
  {
    k[i] = floor( fabs( sin(i + 1)) * maxint);
  }

  while(!(this->filestr).eof())
  {
    //Read in 512 bits
    (this->filestr).read((char *)buffer, bufLength-512);

    padbuff(buffer);

    //The 512 bits are now 16 32-bit ints
    head = (int *)buffer;

    for(int i = 0; i < 64; i++)
    {
      if(i >=0 && i <=15)
      {
        f = (b & c) | (~b & d);
        g = i;
      }
      else if(i >= 16 && i <=31)
      {
        f = (d & b) | (~d & b);
        g = (5*i +1) % 16;
      }
      else if(i >=32 && i<=47)
      {
        f = b ^ c ^ d;
        g = (3*i + 5 ) % 16;
      }
      else
      {
        f = c ^ (b | ~d);
        g = (7*i) % 16;
      }

      temp = d;
      d = c;
      c = b;
      b = b + leftrotate((a + f + k[i] + head[g]), r[i]);
      a = temp;

    }

    h[0] +=a;
    h[1] +=b;
    h[2] +=c;
    h[3] +=d;         
  }

  delete[] r;
  delete[] k;

  hash = h;
}

int leftrotate(int x, int y)
{
   return(x<<y) | (x >> (32 -y));
}

void padbuff(uchar* buffer)
{
   int lack;
   int length = strlen((char *)buffer);
   uint64_t mes_size = length % UINT64_MAX;
   if((lack = (112 - (length % 128) ))>0)
   {
     *(buffer + length) = ('\0'+1 ) << 3;
     memset((buffer + length + 1),0x0,lack);  
     memcpy((void*)(buffer+112),(void *)&mes_size, 64);
   }

} 
```

在我的测试程序中，我在一条空消息上运行它。因此`length`在 padbuff 中为 0。然后当我这样做时`*(buffer + length) = ('\0'+1 ) << 3;`，我试图用 1 填充消息。在 Netbeans 调试器中，我将其转换`buffer`为 a`uint64_t`并显示`buffer=8`。我试图将 a`1 bit`放在缓冲区最重要的位置，所以我的演员应该是`UINT64_MAX`. 不是，所以我对填充代码的工作方式感到困惑。有人可以告诉我我在做什么以及我应该在 padbuff 中做什么吗？谢谢，我为这个冗长的问题道歉。

为了清楚填充应该做什么，这里是 Wikipedia 的填充摘录： 消息被填充，使其长度可以被 512 整除。填充的工作方式如下：首先附加一个位 1到消息的结尾。后面跟着尽可能多的零，使消息的长度最多比 512 的倍数少 64 位。剩余的位用 64 位填充，表示原始消息的长度，以 264 为模。

我主要是在为 padbuff 寻求帮助，但由于我正在努力学习，所有评论都受到赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T07:25:56.450

第一个问题是你做了什么：

1.  `length % UINT64_MAX`根本没有意义，因为长度以字节为单位，而 MAX 是您可以存储在 UINT64 中的值。
2.  您认为将 1 位放在最高有效位会给出最大值。实际上，您需要在所有位中输入 1 才能得到它。
3.  您将 1 移动 3。它只是字节长度的一半。
4.  buffer 指向的字节在 little endian 中是最不重要的。（我假设你有小端，因为调试器显示 8）。

第二个问题它应该如何工作。我不知道 padbuff 到底应该做什么，但如果你想填充并获得 UINT64_MAX，你需要这样的东西：

```
int length = strlen((char *)buffer);
int len_of_padding = sizeof(uint64_t) - length % sizeof(uint64_t);
if(len_of_padding > 0)
{
  memset((void*)(buffer + length), 0xFF, len_of_padding);
} 
```

您使用了两个 uint64 值的长度。可能是您想将下一个归零：

```
uint64_t *after = (uint64_t*)(buffer + length + len_of_padding);
*after = 0; 
```

# javascript - 单击按钮时如何创建表格并插入此标签和文本字段

> ID：12310809
> 
> 赞同：0
> 
> 时间：2012-09-07T02:08:17.247
> 
> 标签：javascript, html

我是编程新手，我创建了一个表单。当我单击添加按钮时，我想在表格中插入这些元素

我已经知道如何添加标签和文本字段，我想知道如何在表格中添加行和插入新标签和文本字段

```
<SCRIPT type="text/javascript">
var x = 1;

function add(type) {
    var newlabel = document.createElement("Label");
    newlabel.for = "Name";
    newlabel.innerHTML = "NAME: ";

    var element = document.createElement("input");
    element.setAttribute("type", type);
    element.setAttribute("name", type);
    element.setAttribute("value", "Name"+x);
    element.setAttribute("id", "Name"+x);
    element.setAttribute("style","width: 64");

    var newlabel1 = document.createElement("Label");
    newlabel1.for = "AGE";
    newlabel1.innerHTML = "AGE: ";  

    var element1 = document.createElement("input");
    element1.setAttribute("type", type);
    element1.setAttribute("name", type);
    element1.setAttribute("value", "AGE"+x);
    element1.setAttribute("id", "AGE"+x);
    element1.setAttribute("style","width: 64");

    var foo = document.getElementById("fooBar");
    foo.appendChild(newlabel);
    foo.appendChild(element);
    foo.appendChild(newlabel1);
    foo.appendChild(element1);

    x++;
}
</script>

<form id="fooBar" form name="form1" method="post" action="">
    <table id = "mytable" table border="1">
        <tr>
            <th scope="col">name: </th>
            <th scope="col">
                <label for="name"></label>
                <input type="text" name="name" id="name">
            </th>
            <th scope="col">age:</th>
            <th scope="col">
                <label for="name2"></label>
                <input type="text" name="name2" id="name2">
            </th>
        </tr>
    </table>
    <INPUT type="button" value="Add" onClick="add('text')" style="width:100px;"/>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T03:02:14.787

在您的代码中：

```
> <SCRIPT language="javascript"> 
```

脚本元素的语言属性已弃用，类型是必需的，使用：

```
<script type="text/javascript"> 
```

...

> newlabel.setAttribute("for", "Name");

[for](http://www.w3.org/TR/html401/interact/forms.html#adef-for)属性的值必须与表单控件的 ID 匹配，否则不会与该控件关联。此外，设置元素属性比使用 setAttribute 更容易、更健壮：

```
 newlabel.htmlFor = "Name"; 
```

请注意，HTML *for*属性被引用为[*htmlFor*](http://dev.w3.org/html5/spec/single-page.html#dom-label-htmlfor)属性，因为*for*是 javascript（实际上是 ECMAScript）中的保留字。

```
> newlabel.innerHTML = "NAME:    "; 
```

您可能应该附加一个文本节点，而不是使用 innerHTML 属性：

```
 newlabel.appendChild(document.createTextNode("NAME:    ")); 
```

您的 HTML 应如下所示：

```
<form id="fooBar">
  <input type="button" value="Add fields" onclick="add();">
</form> 
```

请注意，如果您使用的是[BUTTON](http://www.w3.org/TR/html401/interact/forms.html#edef-BUTTON)元素，则可能发生的情况是正在提交表单（因为按钮元素默认是提交按钮），因此正在添加字段，但由于表单提交，您不会看见。确保按钮是 type="button"。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T05:58:27.870

我让它需要反馈/评论:)

```
 <SCRIPT type="text/javascript">
var x =1;

function add(type,tabID) {

var tbody = document.getElementById(tabID).getElementsByTagName("tbody")[0];
var row = document.createElement("tr")
var data1 = document.createElement("td")    
var data2 = document.createElement("td") 
var data3 = document.createElement("td") 
var data4 = document.createElement("td") 

var newlabel = document.createElement("Label");
newlabel.for = "Name";
newlabel.innerHTML = "NAME: ";

var element = document.createElement("input");
element.setAttribute("type", type);
element.setAttribute("name", type);
element.setAttribute("value", "Name"+x);
element.setAttribute("id", "Name"+x);

var newlabel1 = document.createElement("Label");
newlabel1.for = "AGE";
newlabel1.innerHTML = "AGE: ";  

var element1 = document.createElement("input");
element1.setAttribute("type", type);
element1.setAttribute("name", type);
element1.setAttribute("value", "AGE"+x);
element1.setAttribute("id", "AGE"+x);

var foo = document.tbody;

data1.appendChild(newlabel)
data2.appendChild(element)
data3.appendChild(newlabel1)
data4.appendChild(element1)

row.appendChild(data1)
row.appendChild(data2)
row.appendChild(data3)
row.appendChild(data4)
tbody.appendChild(row);

x++;

}

</script>

<form  id="fooBar" form name="form1" method="post" action="">
 <table id = "mytable" table border="1">
 <tr>
<th scope="col">name: </th>
<th scope="col">
  <label for="name"></label>
  <input type="text" name="name" id="name">
  </th>
  <th scope="col">age:</th>
  <th scope="col">
  <label for="name2"></label>
  <input type="text" name="name2" id="name2">
</th>
  </tr>
  </table>
  <INPUT type="button" value="Add" onClick="add('text','mytable')" style="width:100px;"/>
 </form> 
```

# regex - 使用模式列表参数对数据帧进行子集化的函数

> ID：12310810
> 
> 赞同：0
> 
> 时间：2012-09-07T02:08:22.350
> 
> 标签：regex, r, function, dataframe

我有一个模式列表

```
patternlist <- list('one' = paste(c('a','b','c'),collapse="|"), 'two' = paste(1:5,collapse="|"), 'three' = paste(c('k','l','m'),collapse="|")) 
```

我想从中选择以从数据框中提取行

```
dataframez <- data.frame('letters' = c('a','b','c'), 'numbers' = 1:3, 'otherletters' = c('k','l','m')) 
```

有了这个功能

```
pattern.record <- function(x, column="letters", value="one")
{
  if (column %in% names(x))
  {
   result <- x[grep(patternlist$value, x$column, ignore.case=T),]
  }
  else
  {
    result <- NA
  }
  return(result)
} 
```

奇怪的是，当我运行它时出现错误：

```
> pattern.record(dataframez)
 Error in grep(patternlist$value, x$column, ignore.case = T) : 
  invalid 'pattern' argument 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T02:16:11.283

问题是您对``$``运算符的使用。

在您的函数中，它正在查找名为 \ 的列元素`column`

这里使用起来要简单得多``[[``

然后`x[[column]]`使用`column`定义的内容，而不是`column`名称。

中的相关行`?`$``是

> [[ 和 $ 都选择列表的单个元素。主要区别在于 $ 不允许计算索引，而 [[ 允许。x$name 等价于 x[["name", exact = FALSE]]。此外，[[ 的部分匹配行为可以使用精确参数来控制。

您正在尝试使用`value`和`column`作为*计算索引*（即*计算*`value`和定义`column`为），因此您需要``[[``.

函数变为

```
pattern.record <- function(x, column="letters", value="one", pattern_list)
{
  if (column %in% names(x))
  {
    result <- x[grep(pattern_list[[value]], x[[column]], ignore.case=T),]
  }
  else
  {
    result <- NA
  }
  return(result)
}

pattern.record(dataframez, patternlist = pattern_list)

##   letters numbers otherletters
## 1       a       1            k
## 2       b       2            l
## 3       c       3            m 
```

请注意，我还添加了一个参数`pattern_list`，因此它不依赖于`patternlist`父环境中某处存在的名为的对象（在您的情况下是全局环境。

# android - 在 android 中，当我通过调用 setChecked(true) 以编程方式设置 Radiobutton 时，不会触发 Radiogroup 的 onCheckedChanged

> ID：12310818
> 
> 赞同：3
> 
> 时间：2012-09-07T02:10:04.530
> 
> 标签：android

在我的应用程序中，我需要以编程方式设置一个单选按钮并期望触发 Radiogroup 的 onCheckedChanged，以便我可以在其中执行某些操作。

以编程方式设置单选按钮的代码。

```
 LayoutInflater inflater = LayoutInflater)getSystemService(LAYOUT_INFLATER_SERVICE);
 View view = inflater.inflate(R.layout.footer, null);
 RadioButton btn = (RadioButton)view.findViewById(R.id.footer_btn_course);
 btn.setChecked(true); 
```

在另一项活动中，我做了类似的事情：

```
 public class MainActivity extends ActivityGroup implements RadioGroup.OnCheckedChangeListener{
      protected void onCreate(Bundle savedInstanceState){
            mRadioGroup = (RadioGroup)findViewById(R.id.footer_radio);
            mRadioGroup.setOnCheckedChangeListener(this);
      }

      @Override
      public void onCheckedChanged(RadioGroup group, int checkedId){
            RadioButton btn = (RadioButton)findViewById(checkedId);
            if(btn != null){
                  do_something();
            }
      }
  } 
```

但是，看起来这种方式行不通，从未调用过 onCheckedChanged。有谁知道我应该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-02-09T05:53:11.660

初始化时触发默认的单选框。使用 clearCheck 方法将所有内容设置为未选中。然后，设置处理程序，最后设置默认值，您的处理程序将触发。

```
itemtypeGroup.clearCheck(); 
```

然后，像往常一样添加一个监听器：

```
mRadioGroup = (RadioGroup)findViewById(R.id.footer_radio);
            mRadioGroup.setOnCheckedChangeListener(this);
            mRadioGroup.clearCheck();

RadioButton btn = (RadioButton)view.findViewById(R.id.footer_btn_course);
btn.setChecked(true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-19T12:40:31.507

我有同样的问题..

这是我的方法：

```
 class Myclass extends Activity{
    protected void onCreate(Bundle savedInstanceState) {

    radiogroup = (RadioGroup) findViewById(R.id.radiogroupDecisionUncertain);
            radio1 = (RadioButton) findViewById(R.id.radiobuttonNo_U);
            radio2 = (RadioButton) findViewById(R.id.radiobuttonYes_U);
// declare the onCheckChangedListener
radiogroup.setOnCheckedChangeListener(new OnCheckedChangeListener() {

    @Override
    public void onCheckedChanged(RadioGroup group, int checkedId) {
// TODO Auto-generated method stub

    if (checkedId == radio1.getId()) { //do something

                } else { // do other thing
                }

            }
        });

radiogroup.check(radio1.getId());

}
} 
```

***请注意，我在注册监听器后设置了选中的单选按钮..***

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T06:01:53.817

而不是`btn.setChecked(true)`;

用过`btn.performClick();`这个就行了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T02:28:33.657

我不确定这个问题，但可能是您错过了参考您的广播组 ID。试试这个来看看效果（在你的内部`onCreate()`）：

```
RadioGroup rdGroup = (RadioGroup) findViewById(R.id.footer_radio);
    rdGroup.setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener() 
    {
        @Override
        public void onCheckedChanged(RadioGroup group, int checkedId) 
        {
            RadioButton btn = (RadioButton)findViewById(checkedId);
            if(btn != null){
                  do_something();
            }
        }
    }); 
```

或者可能`(RadioButton)findViewById(checkedId)`返回null。

`Spinner`如果您的情况模棱两可，请尝试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T05:55:29.923

实施`OnCheckedChangeListener`而不是`RadioGroup.onCheckedChangeListene`r 将起作用。

```
public class MainActivity extends ActivityGroup implements OnCheckedChangeListener{
.....

} 
```

# ruby-on-rails - 如何在非 Rails Ruby 项目中包含特定的 Rails 方法（或文件）？

> ID：12310825
> 
> 赞同：0
> 
> 时间：2012-09-07T02:11:10.533
> 
> 标签：ruby-on-rails, ruby

我想在一个非 Rails Ruby 项目中使用`distance_of_time_in_words`date_helper.rb Rails 文件中的方法（参见[Github ）。](https://github.com/rails/rails/blob/bd8a9701c27b4261e9d8dd84aebbde6ba784ed83/actionpack/lib/action_view/helpers/date_helper.rb#L67)

我怎样才能包括它？它需要其他文件，那么如何包含它们？

我不想包含所有 Rails，因为这会减慢开发过程。

红宝石 1.9.3

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T02:45:51.060

这种方法，`distance_of_time_in_words`在`actionpack/lib/action_view/helpers/date_helper.rb`. 所以你应该`require 'action_view'`加载`action_view/helpers`这个方法。并且该方法在 module 中定义`ActionView::Helpers::DateHelper`，您可以将其包含在您的类中。该方法是一个实例方法。

```
require 'action_view'
require 'action_view/helpers'

class Klass
    include ActionView::Helpers::DateHelper
end

c = Klass.new
c.distance_of_time_in_words( ...... ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T05:19:21.713

如果这是你想要的唯一东西，那么我就去获取[源代码](https://github.com/rails/rails/blob/bd8a9701c27b4261e9d8dd84aebbde6ba784ed83/actionpack/lib/action_view/helpers/date_helper.rb#L67)并破解它以删除依赖项（这似乎只是一些 I18n 翻译。为了支持破解，你可能可以翻译[这个](https://github.com/rails/rails/blob/bd8a9701c27b4261e9d8dd84aebbde6ba784ed83/actionpack/test/template/date_helper_test.rb#L21)测试套件.

为什么我要这样做而不是使用 gem？因为它只是一个巨大的依赖。它是如此巨大，以至于您实际上注意到它加载了所有代码。我宁愿撕掉这个方法并破解它来工作，而不是依赖所有这些（再次假设这是你从 lib 中唯一想要的东西）。

# sql - 我们怎么说变量的值放在变量所在的位置？这个叫什么名字？

> ID：12310827
> 
> 赞同：0
> 
> 时间：2012-09-07T02:11:31.813
> 
> 标签：sql, coldfusion, language-agnostic

对于家庭作业，我正在写一份报告，但不知道这叫什么：当变量的值被替换到语句中时。

**简单的例子：**

var weekDay = Thursday
print "今天是 "+ Weekday

换句话说，我想说'打印“今天是”+工作日是`_____`到“今天是星期四”' 什么去哪里`_____`？

**实际示例**

```
<cfset aTable = "bookings">
<cfquery name="client" datasource="accounts">
    SELECT * FROM #aTable#
</cfquery> 
```

什么词描述了这与陈述的关系

```
<cfset aTable = "bookings">
<cfquery name="client" datasource="accounts">
    SELECT * FROM bookings
</cfquery> 
```

你会说“在变量的值被替换为其标识符之后”吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T02:25:19.703

> `"Today is " + Weekday` **评估为** `"Today is Thursday"`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T02:25:29.547

如果通过识别字符串中的变量引用自动完成替换，则常用术语是“插值”。

如果您使用显式运算符（如 Javascript 中的“+”或“.”）执行替换。在 Perl 或 PHP 中，它被称为“连接”。

# go - 有 Go 语言的 SAML 库吗？

> ID：12310828
> 
> 赞同：6
> 
> 时间：2012-09-07T02:11:35.247
> 
> 标签：go, saml-2.0

我看到[goauth](https://github.com/alloy-d/goauth "古特")和[go-oauth](https://github.com/garyburd/go-oauth "认证") OAuth 库是为[Go Programming Language](http://golang.org/ "围棋编程语言")编写的，但是在网上搜索了几个小时后，[SAML](http://en.wikipedia.org/wiki/SAML_2.0 "SAML")却一无所获。

我想使用 Go 来实现使用 SAML 的 Web 服务的 SSO 支持，但是如果没有 Go 的 SAML 库，看起来我将不得不将 SAML 逻辑“包装”在一个单独的服务中，用另一种语言实现。

有谁知道 Go 友好的 SAML 库，或者可能有一些从 Go 程序中使用 Java、C 或 PHP 库的技巧？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-09-07T21:22:57.820

我用过[gosaml](https://github.com/mattbaird/gosaml)，效果很好，但也有来自机器人和铅笔[的 go-saml 。](https://github.com/RobotsAndPencils/go-saml)

我想在一年后，回答这个问题会很好，因为在这里为寻找 Go 的 SAML 库的人提供某种答案仍然很好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T19:59:06.130

我还没有看到 Go 的 SAML 实现，但您可以使用已经在您的应用程序前面实现它的服务器。

[Shibboleth](http://shibboleth.net)是最受支持的 SAML 实现之一。apache 模块是最成熟的，并且可能是最容易使用的方法，因为您只需将应用程序放在 apache 中的反向代理后面。还有一个 fastcgi 身份验证器，它使用相同的后端，但我不能说它易于实施。

如果您只需要一个服务提供者，最简单的 SAML 绑定是 HTTP-POST-SimpleSign。我在 python 中做了一个[概念验证实现](https://github.com/jbardin/python-saml)，试图演示我能做到的最简单的 SP。我没有声称这个模块的健壮性，但你可以看到它*可以*用不太多的代码来完成。这是假设您正在使用的身份提供者支持此绑定。与往常一样，在部署任何与安全相关的自定义代码时要小心。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-10-02T14:21:23.767

如果您想在您的断言消费者端点中验证来自 AWS IdP 的 SAML 回复，那么您最好使用[https://github.com/crewjam/saml](https://github.com/crewjam/saml)，因为它不依赖于 libxmlsec1 系统库。

由于某种原因，libxmlsec1 无法成功验证来自某些 IdP (AWS) 的 SAML 回复（可能是因为某些未定义的命名空间）。

# javascript - 当元素到达屏幕上的某个位置时触发事件

> ID：12310829
> 
> 赞同：0
> 
> 时间：2012-09-07T02:11:37.103
> 
> 标签：javascript, jquery

我想根据元素的位置触发一些功能。该元素的位置每十秒更改一次。有两个几十个功能可以触发。

我想到了这个伪代码：

```
When element position changes{
  Loop through all the coordinates to see if a function can be triggered{
     if the current element position matches the function's triggering position 
         execute the function
     }
} 
```

但是每隔几秒钟循环遍历所有可能的位置会给浏览器带来负担。因此，如果有办法让事件来做到这一点。

是否可以 ？

编辑：在 Beetroot-Beetroot 评论之后，我必须说移动的元素只在 X 横坐标上移动：所以只有一维。

这很像一个从左到右移动的水平时间线，当到达某一年时会发生一些动画。但是用户可以增加移动速度，因此不能选择固定时间来触发动画。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T11:36:56.260

必须有很多方法来实现你想要的。下面的代码利用 jQuery 处理自定义事件的能力来提供“松耦合”的观察者模式。

```
$(function() {

    //Establish the two dozen functions that will be called.
    var functionList = [
        function() {...},
        function() {...},
        function() {...},
        ...
    ];

    var gridParams = {offset:10, pitch:65};//Example grid parameters. Adjust as necessary.

    //Establish a custom event and its handler.
    var $myElement = $("#myID").data('lastIndex', -1).on('hasMoved', function() {
        $element = $(this);
        var pos = $element.position();//Position of the moved element relative to its offset parent.
        var index = Math.floor((pos.left - gridParams.offset) / gridParams.pitch);//Example algorithm for converting pos.left to grid index.
        if(index !== $element.data('lastIndex')) {//Has latest movement align the element with the next grid cell?
            functionList[index](index, $element);//Call the selected function.
            $element.data('lastIndex', index);//Remember index so it can be tested mext time.
        }
    });
});

$(function() {
    //(Existing) function that moves the element must trigger the custom 'hasMoved' event after the postition has been changed.
    function moveElement() {
        ...
        ...
        ...
        myElement.trigger('hasMoved');//loosely coupled 'hasMoved' functionality.
    }

    var movementInterval = setInterval(moveElement, 100);
}); 
```

如您所见，松耦合的一个优点是函数和调用它的代码可以在不同的范围内 -`.on('hasMoved', function() {...}`并且`myElement.trigger('hasMoved')`在不同的`$(function(){...})`结构中。

如果你想添加其他函数来改变位置`myElement`（例如第一个、上一个、下一个、最后一个函数），那么在移动元素之后，它们每个都只需要触发'hasMoved'来确保你两个中的一个合适调用了十几个函数，而无需担心范围。

您唯一需要确保的是您的两打函数的范围是这样的，以便它们可以被自定义事件处理程序调用（即它们在相同的范围或外部范围内，直到并包括全局范围）。

我不得不做出许多假设，所以上面的代码不会是 100% 正确的，但希望它能为您提供前进的道路。

# php - 如何在复选框列表中突出显示 AJAX 搜索结果而不会丢失 php 中的复选框选择？

> ID：12310830
> 
> 赞同：0
> 
> 时间：2012-09-07T02:11:41.917
> 
> 标签：php, ajax, checkboxlist

我在第一个 php 页面中有一个学生复选框列表和一个搜索框。在 ajax 页面中，我将获得搜索结果。

但问题是，如果用户选择了第一个搜索结果并再次搜索，第一次搜索的选择会丢失

如何在第一次搜索时保存选择？我尝试在会话数组中进行选择，但它不起作用

```
//check list
    $qry="select cand_id,name from candidate where inst_id=".$_SESSION['inst_id']."";
    $res=$ob->select($qry,$connect);
    while($rw=pg_fetch_row($res))
    {

        echo"<br><input type=\"checkbox\" name=\"check[]\" value=\"$rw[0]\">";echo$rw[1];echo"<br>" ;
    }
//Ajax page
if($ajaxData!="")
{
                                if($_SESSION['usertype_id']==1)
                                {
                                $qry="select cand_id,name from candidate where name like'$dataup%'  ";

                                }
                                else if($_SESSION['usertype_id']==2)
                                {
                                $qry="select cand_id,name from candidate where inst_id=".$_SESSION['inst_id']."
                                and  name like'$dataup%' ";
                                }
                                $res=$ob->select($qry,$connect);
                                $words=array();
                                $count = pg_num_rows($res);
                                if($count>0)
                                {
                                    $i=0;
                                    //echo"<div  style=\"width: 200px; height: 200px;overflow-y: auto;padding-top: 10px;padding-right: 0px;padding-bottom: 0.25in;\">";
                                    while($rw=pg_fetch_row($res))
                                    {
                                        $words[$i]=$rw[0];$i++;

                                    }

                                    $_SESSION['checkAjax']=$words;//can_id array 
```

1.  如何使用数组`$_SESSION['checkAjax']`突出显示？
2.  为什么`$_SESSION['checkAjax']`在每个 ajax 调用上都取消设置？
3.  只需要更改所选学生姓名的颜色

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T02:23:38.933

我**假设**您有这样的复选框代码：

```
<input type="checkbox" name="options[]" value="student"> Student
<input type="checkbox" name="options[]" value="teacher"> Teacher
<input type="checkbox" name="options[]" value="professor"> Professor 
```

如果是这种情况，您可以通过这种方式在服务器端检查它，我再次**假设**它是通过**POST**：

```
<input type="checkbox" name="options[]" value="student"<?php echo (in_array("student", $_POST["options"])) ? ' checked="checked"' : ''; ?>> Student
<input type="checkbox" name="options[]" value="teacher"<?php echo (in_array("teacher", $_POST["options"])) ? ' checked="checked"' : ''; ?>> Teacher
<input type="checkbox" name="options[]" value="professor"<?php echo (in_array("professor", $_POST["options"])) ? ' checked="checked"' : ''; ?>> Professor 
```

希望这可以帮助！:)

# javascript - 使用 jQuery 处理“img”点击事件并在文本框中插入“alt”属性

> ID：12310833
> 
> 赞同：2
> 
> 时间：2012-09-07T02:12:06.823
> 
> 标签：javascript, jquery, ajax, emoticons

我正在使用 PHP 和 jQuery 创建一个网络聊天页面，并且我正在添加一个表情符号功能，除了 jQuery 部分之外，一切都已完成。我的问题是当我点击表情图像时没有收到点击事件。在处理程序中，它应该获取当前消息值，从“alt”属性获取表情符号的文本版本，并将文本框值设置为其先前值+附加的表情符号文本。

这是我尝试过的：

（每个按钮显示如下`<img class="embtn" src="emoticons/happy.gif" alt=":)" />`：）

```
$(document).ready(function(){
    // Insert Emoticon
    $(".embtn").click(function(event){
        var prevMsg = $("#usermsg").val();
        var emotiText = event.target.attr("alt");
        $("#usermsg").val(prevMsg + emotiText);
    });
}); 
```

我该怎么做呢？

我使用的 jQuery 版本是 1.3。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T02:19:26.413

尝试改变：

```
var emotiText = event.target.attr("alt"); 
```

到：

```
var emotiText = $(event.target).attr("alt"); 
```

将来，当您被难住时，请检查控制台是否有错误。

# android - 具有偶数行背景颜色的自定义 SimpleCursorAdapter

> ID：12310836
> 
> 赞同：1
> 
> 时间：2012-09-07T02:12:36.103
> 
> 标签：android, list, listview, background, simplecursoradapter

我想实现一个自定义的 SimpleCursorAdapter，它仅在偶数行上显示背景颜色（在我的情况下为蓝色）。我的实现如下：

```
public class ColoredCursorAdapter extends SimpleCursorAdapter {
    String backgroundColor;

    public ColoredCursorAdapter(
            Context context,
            int layout,
            String backgroundColor,
            Cursor c,
            String[] from,
            int[] to,
            int flags) {
        super(
                context, 
                layout, 
                c, 
                from, 
                to, 
                flags);
        this.backgroundColor = backgroundColor;
    }

    @Override
    public void bindView(View view, Context context, Cursor cursor) {
        super.bindView(view, context, cursor);
        if(cursor.getPosition() % 2 == 0) {
            view.setBackgroundColor(
                    Color.parseColor(backgroundColor));
        }
    }
} 
```

一开始它工作正常，但是当我反复向下和向上滚动列表时，所有行都变成蓝色。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T02:48:11.737

当您滚动时，适配器会回收（重用）项目视图。这意味着当您来回滚动列表时，不能保证相同的项目视图将用于给定的光标位置。在您的情况下，如果当前位置是偶数，则仅设置项目视图的背景颜色，但是您当前正在处理的特定视图可能以前曾在奇数位置使用过。因此，随着时间的推移，您所有的项目视图都会获得相同的背景颜色。

解决方案很简单，为奇数和偶数光标位置设置背景颜色。就像是：

```
@Override
public void bindView(View view, Context context, Cursor cursor) {
    super.bindView(view, context, cursor);
    if(cursor.getPosition() % 2 == 0) {
        view.setBackgroundColor(
                Color.parseColor(backgroundColor));
    }else{
        view.setBackgroundColor(
                Color.parseColor(someOtherBackgroundColor));
    }
} 
```

# javascript - Luhn算法的实现

> ID：12310837
> 
> 赞同：14
> 
> 时间：2012-09-07T02:12:40.643
> 
> 标签：javascript, algorithm, luhn

我正在尝试实现信用卡号码的简单验证。[我在 Wikipedia 上](http://en.wikipedia.org/wiki/Luhn_algorithm)读到了 Luhn 算法：

> 1.  从最右边的校验位开始计数，然后向左移动，每第二位的值加倍。
> 2.  将乘积的位数（例如，10: 1 + 0 = 1, 14: 1 + 4 = 5）与原始数字中的非双位数相加。
> 3.  如果总模 10 等于 0（如果总和以 0 结尾），那么根据 Luhn 公式，该数是有效的；否则无效。

在 Wikipedia 上，对 Luhn 算法的描述非常容易理解。但是，我还在[Rosetta Code](http://rosettacode.org/wiki/Luhn_test_of_credit_card_numbers#JavaScript)和[其他地方](https://web.archive.org/web/20130621033240/http://imei.sms.eu.sk/)（存档）上看到了 Luhn 算法的其他实现。

这些实现工作得很好，但我对为什么他们可以使用数组来完成工作感到困惑。他们使用的数组似乎与 Luhn 算法无关，我看不出他们如何实现维基百科上描述的步骤。

他们为什么使用数组？它们的意义是什么，它们如何用于实现维基百科描述的算法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-11-29T08:53:22.023

不幸的是，上面的代码都不适合我。但我在[GitHub](https://gist.github.com/DiegoSalazar/4075533)上找到了一个可行的解决方案

```
// takes the form field value and returns true on valid number
function valid_credit_card(value) {
// accept only digits, dashes or spaces
    if (/[^0-9-\s]+/.test(value)) return false;

// The Luhn Algorithm. It's so pretty.
    var nCheck = 0, nDigit = 0, bEven = false;
    value = value.replace(/\D/g, "");

    for (var n = value.length - 1; n >= 0; n--) {
        var cDigit = value.charAt(n),
            nDigit = parseInt(cDigit, 10);

        if (bEven) {
            if ((nDigit *= 2) > 9) nDigit -= 9;
        }

        nCheck += nDigit;
        bEven = !bEven;
    }

    return (nCheck % 10) == 0;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-07T02:44:04.750

该数组`[0,1,2,3,4,-4,-3,-2,-1,0]`用作查找数组，用于查找 0-9 中的数字与其值的 2 倍的数字总和之间的差异。例如，对于数字 8，8 和 (2*8) = 16 -> 1+6 = 7 之间的差值为 7-8 = -1。

这是图形表示，其中 {n} 代表 n 的数字之和

```
[{0*2}-0, {1*2}-1, {2*2}-2, {3*2}-3, {4*2}-4, {5*2}-5, {6*2}-6, {7*2}-7....]
   |       |        |         |        |        |       |         |  
[  0  ,    1    ,   2    ,    3  ,     4   ,   -4  ,   -3   ,    -2  ....] 
```

您列出的算法只是对所有数字和每个偶数点求和，使用数组查找差异，并将其应用于总和。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-06-26T13:04:08.280

紧凑型 Luhn 验证器：

```
var luhn_validate = function(imei){
    return !/^\d+$/.test(imei) || (imei.split('').reduce(function(sum, d, n){ 
            return n===(imei.length-1)
                   ? 0 
                   : sum + parseInt((n%2)? d: [0,2,4,6,8,1,3,5,7,9][d]);
        }, 0)) % 10 == 0;
}; 
```

适用于 CC 和 IMEI 号码。小提琴：http: [//jsfiddle.net/8VqpN/](http://jsfiddle.net/8VqpN/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-09-03T09:59:23.843

查找表或数组可以简化算法实现 - 节省许多代码行 - 并以此提高性能......如果查找索引的计算简单 - 或更简单 - 并且数组的内存占用是可以承受的。

另一方面，有时很难理解特定的查找数组或数据结构是如何形成的，因为相关的算法实现可能看起来 - 乍一看 - 与原始算法规范或描述完全不同。

使用查找表的指示是面向数字的算法，具有简单的算术、简单的比较和同样结构化的重复模式 - 当然 - 具有相当有限的值集。

该线程中的许多答案适用于不同的查找表，并适用于不同的算法来实现相同的 Luhn 算法。大多数实现都使用查找数组来避免麻烦地计算出双位数的值：

```
var   luhnArr   =   [0,   2,   4,   6,   8,   1,   3,   5,   7,   9];
//
//                   ^    ^    ^    ^    ^    ^    ^    ^    ^    ^
//                   |    |    |    |    |    |    |    |    |    |
//
// - d-igit=index:   0    1    2    3    4    5    6    7    8    9
// - 1st 
//    calculation: 2*0  2*2  2*2  2*3  2*4  2*5  2*6  2*7  2*8  2*9 
// - intermeduate
//          value: = 0  = 2  = 4  = 6  = 8  =10  =12  =14  =16  =18
// - 2nd
//    calculation:                          1+0  1+2  1+4  1+6  1+8
//
// - final value:    0    2    4    6    8   =1   =3   =5   =7   =9
//       
var luhnFinalValue = luhnArray[d]; // d is numeric value of digit to double 
```

获取 luhnFinalValue 的等效实现如下所示：

```
var luhnIntermediateValue = d * 2; // d is numeric value of digit to double
var luhnFinalValue = (luhnIntermediateValue < 10)
        ? luhnIntermediateValue           // (d    ) * 2;
        : luhnIntermediateValue - 10 + 1; // (d - 5) * 2 + 1; 
```

其中 - 与上述真假术语中的评论 - 当然是简化的：

```
var luhnFinalValue = (d < 5) ? d : (d - 5) * 2 + 1; 
```

现在我不确定我是否“保存”了任何东西...... ;-) 特别感谢 if-then-else 的 value-formed 或short form。没有它，代码可能看起来像这样——带有“有序”块并嵌入到算法的下一个更高的上下文层中，因此是 luhnValue：

```
var luhnValue; // card number is valid when luhn values for each digit modulo 10 is 0

if (even) { // even as n-th digit from the the end of the string of digits
    luhnValue = d;
} else { // doubled digits
    if (d < 5) {
        luhnValue = d * 2;
    } else {
        lunnValue = (d - 5) * 2 + 1;
    }
} 
```

或者：

```
var luhnValue = (even) ? d : (d < 5) ? d * 2 : (d - 5) * 2 + 1; 
```

顺便说一句，使用现代的优化解释器和（及时）编译器，区别仅在于源代码，仅对可读性很重要。

已经对使用查找表和与直接编码进行比较的解释和“理由”进行了这么多，现在查找表对我来说看起来有点矫枉过正。没有的算法现在很容易完成 - 而且它看起来也很紧凑：

```
function luhnValid(cardNo) { // cardNo as a string w/ digits only
    var sum = 0, even = false;
    cardNo.split("").reverse().forEach(function(dstr){ d = parseInt(dstr);
        sum += ((even = !even) ? d : (d < 5) ? d * 2 : (d - 5) * 2 + 1);
      });
    return (sum % 10 == 0);
  } 
```

经过解释练习后，让我印象深刻的是，最初最诱人的实现 - 使用来自 @kalypto 的 reduce() 的实现 - 对我来说完全失去了它的光彩......不仅因为它在几个层面上都有缺陷，而且更是如此因为它表明花里胡哨的东西可能并不总是“敲响胜利的钟声”。但是谢谢你，@kalypto，它让我真正使用并理解了 reduce()：

```
function luhnValid2(cardNo) { // cardNo as a string w/ digits only
    var d = 0, e = false; // e = even = n-th digit counted from the end
    return ( cardNo.split("").reverse().reduce(
                 function(s,dstr){ d = parseInt(dstr); // reduce arg-0 - callback fnc
                     return (s + ((e = !e) ? d : [0,2,4,6,8,1,3,5,7,9][d]));
                   } // /end of callback fnc
                ,0 // reduce arg-1 - prev value for first iteration (sum)
                ) % 10 == 0
           );
  } 
```

要忠实于该线程，必须提及更多查找表选项：

*   只需调整双位数的 varues 怎么样 - 正如@yngum 所发布的那样
*   **正如@Simon_Weaver 所发布的那样，使用查找表**的所有内容怎么样 - 其中非双位数的值也是从查找表中获取的。
*   **仅使用一个查找表**的所有内容怎么样- 受到广泛讨论的 luhnValid() 函数中使用偏移量的启发。

后者的代码 - 使用 reduce - 可能如下所示：

```
function luhnValid3(cardNo) { // cardNo as a string w/ digits only
    var d = 0, e = false; // e = even = n-th digit counted from the end
    return ( cardNo.split("").reverse().reduce(
          function(s,dstr){ d = parseInt(dstr);
              return (s + [0,1,2,3,4,5,6,7,8,9,0,2,4,6,8,1,3,5,7,9][d+((e=!e)?0:10)]);
            }
         ,0
         ) % 10 == 0
      );
  } 
```

并且对于关闭 lunValid4() - 非常紧凑 - 并且仅使用“老式”（兼容）JavaScript - 使用一个查找表：

```
function luhnValid4(cardNo) { // cardNo as a string w/ digits only
  var s = 0, e = false, p = cardNo.length; while (p > 0) { p--;
    s += "01234567890246813579".charAt(cardNo.charAt(p)*1 + ((e=!e)?0:10)) * 1; }
  return (s % 10 == 0);
 } 
```

花冠：可以将*字符串*视为*字符的查找表*... ;-)

一个很好的查找表应用程序的完美示例是位列表中设置位的计数 - 在（解释的）高级语言（任何位操作都非常昂贵）中的一个（非常）长的 8 位字节字符串中设置的位. 查找表有 256 个条目。每个条目包含在等于条目索引的无符号 8 位整数中设置的位数。遍历字符串并获取无符号的 8 位字节相等值以从查找表中访问该字节的位数。即使对于低级语言 - 例如汇编程序/机器代码 - 查找表也是要走的路......尤其是在微码（指令）可以在一个（单个 CISC）中处理多达 256 个或更多字节的环境中） 操作说明。

一些注意事项：

*   numberString * 1 和 parseInt(numberStr) 做的差不多。
*   有一些多余的缩进，括号等......支持我的大脑更快地获得语义......但是我想省略的一些实际上是必需的......当涉及到短格式的算术运算时，值-if-then-else 表达式作为术语。
*   某些格式对您来说可能看起来很新；例如，我使用延续逗号和延续与延续在同一行，并且我“关闭”事物 - 半个制表符 - 缩进到“开始”项目。
*   所有格式都是为人类完成的，而不是计算机......“它”确实不在乎。

[算法数据](/questions/tagged/algorithm "显示标记为“算法”的问题") [结构](/questions/tagged/datastructure "显示标记为“数据结构”的问题") [luhn](/questions/tagged/luhn "显示标记为“luhn”的问题") [查找表](/questions/tagged/lookuptable "显示标记为“查找表”的问题") [信用卡](/questions/tagged/creditcard "显示标记为“信用卡”的问题") [验证](/questions/tagged/validation "显示标记为“验证”的问题") [位表](/questions/tagged/bitlist "显示标记为“位列表”的问题")

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-06-16T12:53:24.217

**Luhn 算法**的一个非常**快速**和**优雅的实现**如下：

 **```
const isLuhnValid = function luhn(array) {
      return function (number) {
        let len = number ? number.length : 0,
          bit = 1,
          sum = 0;

        while (len--) {
          sum += !(bit ^= 1) ? parseInt(number[len], 10) : array[number[len]];
        }

        return sum % 10 === 0 && sum > 0;
      };
    }([0, 2, 4, 6, 8, 1, 3, 5, 7, 9]);

console.log(isLuhnValid("4112344112344113".split(""))); // true
console.log(isLuhnValid("4112344112344114".split(""))); // false
```

在我的专用 git[存储库](https://github.com/leodido/luhn.js)中，您可以获取它并检索更多信息（例如基准链接和针对约 50 个浏览器和一些 node.js 版本的完整单元测试）。

或者你可以简单地通过**bower**或**npm**安装它。它适用于浏览器和/或节点。

```
bower install luhn-alg
npm install luhn-alg 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-13T00:31:54.307

如果你想**计算**校验和，[这个页面](https://sites.google.com/site/abapexamples/javascript/luhn-validation)的代码非常简洁，在我的随机测试中似乎有效。

**注意：**此页面上的验证算法并非全部有效。

```
// Javascript
String.prototype.luhnGet = function()
{
    var luhnArr = [[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]], sum = 0;
    this.replace(/\D+/g,"").replace(/[\d]/g, function(c, p, o){
        sum += luhnArr[ (o.length-p)&1 ][ parseInt(c,10) ]
    });
    return this + ((10 - sum%10)%10);
};

alert("54511187504546384725".luhnGet());​ 
```

这是我[对 C# 的发现](https://stackoverflow.com/a/12397836/16940)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-02-14T02:26:48.800

```
function luhnCheck(value) {
  return 0 === (value.replace(/\D/g, '').split('').reverse().map(function(d, i) {
    return +['0123456789','0246813579'][i % 2][+d];
  }).reduce(function(p, n) {
    return p + n;
  }) % 10);
} 
```

更新：这是一个没有字符串常量的较小版本：

```
function luhnCheck(value) {
  return !(value.replace(/\D/g, '').split('').reverse().reduce(function(a, d, i) {
    return a + d * (i % 2 ? 2.2 : 1) | 0;
  }, 0) % 10);
} 
```

请注意，此处使用 2.2 是为了在将 5 加倍到 9 时使加倍 d 加倍 1。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-07T02:48:53.937

代码如下：

```
var LuhnCheck = (function()
{
    var luhnArr = [0, 2, 4, 6, 8, 1, 3, 5, 7, 9];
    return function(str)
    {
        var counter = 0;
        var incNum;
        var odd = false;
        var temp = String(str).replace(/[^\d]/g, "");
        if ( temp.length == 0)
            return false;
        for (var i = temp.length-1; i >= 0; --i)
        {
            incNum = parseInt(temp.charAt(i), 10);
            counter += (odd = !odd)? incNum : luhnArr[incNum];
        }
        return (counter%10 == 0);
    }
})(); 
```

变量`counter`是奇数位的所有数字的总和，加上偶数位的数字的两倍，当双数超过 10 时，我们将两个数字相加（例如：6 * 2 -> 12 -> 1 + 2 = 3)

您要询问的 Array 是所有可能的双精度数的结果

`var luhnArr = [0, 2, 4, 6, 8, 1, 3, 5, 7, 9];`

*   0 * 2 = 0 --> 0
*   1 * 2 = 2 --> 2
*   2 * 2 = 4 --> 4
*   3 * 2 = 6 --> 6
*   4 * 2 = 8 --> 8
*   5 * 2 = 10 --> 1+0 --> 1
*   6 * 2 = 12 --> 1+2 --> 3
*   7 * 2 = 14 --> 1+4 --> 5
*   8 * 2 = 16 --> 1+6 --> 7
*   9 * 2 = 18 --> 1+8 --> 9

所以例如

```
luhnArr[3] --> 6 (6 is in 3rd position of the array, and also 3 * 2 = 6)
luhnArr[7] --> 5 (5 is in 7th position of the array, and also 7 * 2 = 14 -> 5 ) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-08T16:17:23.810

另一种选择：

```
function luhn(digits) {
    return /^\d+$/.test(digits) && !(digits.split("").reverse().map(function(checkDigit, i) { 
        checkDigit = parseInt(checkDigit, 10);
        return i % 2 == 0
            ? checkDigit
            : (checkDigit *= 2) > 9 ? checkDigit - 9 : checkDigit;
    }).reduce(function(previousValue, currentValue) {
        return previousValue + currentValue;
    }) % 10);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-04-11T07:16:30.110

替代方案 ;) 简单且最佳

```
 <script>
      // takes the form field value and returns true on valid number
    function valid_credit_card(value) {
      // accept only digits, dashes or spaces
        if (/[^0-9-\s]+/.test(value)) return false;

        // The Luhn Algorithm. It's so pretty.
        var nCheck = 0, nDigit = 0, bEven = false;
        value = value.replace(/\D/g, "");

        for (var n = value.length - 1; n >= 0; n--) {
            var cDigit = value.charAt(n),
                  nDigit = parseInt(cDigit, 10);

            if (bEven) {
                if ((nDigit *= 2) > 9) nDigit -= 9;
            }

            nCheck += nDigit;
            bEven = !bEven;
        }

        return (nCheck % 10) == 0;
    }

    console.log(valid_credit_card("5610591081018250"),"valid_credit_card Validation");
  </script> 
```

最佳解决方案在这里

*   [http://plnkr.co/edit/34aR8NUpaKRCYpgnfUbK?p=preview](http://plnkr.co/edit/34aR8NUpaKRCYpgnfUbK?p=preview)

根据所有测试用例通过

*   [http://www.paypalobjects.com/en_US/vhelp/paypalmanager_help/credit_card_numbers.htm](http://www.paypalobjects.com/en_US/vhelp/paypalmanager_help/credit_card_numbers.htm)

功劳归于

*   [https://gist.github.com/DiegoSalazar/4075533](https://gist.github.com/DiegoSalazar/4075533)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-05-19T15:47:40.297

```
const LuhnCheckCard = (number) => {
  if (/[^0-9-\s]+/.test(number) || number.length === 0)
    return false;

  return ((number.split("").map(Number).reduce((prev, digit, i) => {
    (!(( i & 1 ) ^ number.length)) && (digit *= 2);    
    (digit > 9) && (digit -= 9);    
    return prev + digit;
  }, 0) % 10) === 0);
}

console.log(LuhnCheckCard("4532015112830366")); // true
console.log(LuhnCheckCard("gdsgdsgdsg")); // false 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-01-25T02:01:20.040

在我提交了一个更糟糕的测试后，我制定了以下解决方案。

```
function valid(number){
    var splitNumber = parseInt(number.toString().split(""));
    var totalEvenValue = 0;
    var totalOddValue = 0;
    for(var i = 0; i < splitNumber.length; i++){
        if(i % 2 === 0){
            if(splitNumber[i] * 2 >= 10){
                totalEvenValue += splitNumber[i] * 2 - 9;
            } else {
                totalEvenValue += splitNumber[i] * 2;
            }
        }else {
            totalOddValue += splitNumber[i];
        }
    }
    return ((totalEvenValue + totalOddValue) %10 === 0)
}
console.log(valid(41111111111111111)); 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2019-03-20T08:32:16.183

```
def validate_credit_card_number(card_number):
if(len(str(card_number))==16):
    group1 = []
    group1_double = []
    after_group_double = []
    group1_sum = 0
    group2_sum = 0
    group2 = []
    total_final_sum = 0
    s = str(card_number)
    list1 = [int(i) for i in list(s)]
    for i in range(14, -1, -2):
        group1.append(list1[i])
    for x in group1:
        b = 0
        b = x * 2
        group1_double.append(b)
    for j in group1_double:
        if(j > 9):
            sum_of_digits = 0
            alias = str(j)
            temp1 = alias[0]
            temp2 = alias[1]
            sum_of_digits = int(temp1) + int(temp2)
            after_group_double.append(sum_of_digits)
        else:
            after_group_double.append(j)
    for i in after_group_double:
        group1_sum += i
    for i in range(15, -1, -2):
        group2.append(list1[i])
    for i in group2:
        group2_sum += i

    total_final_sum = group1_sum + group2_sum

    if(total_final_sum%10==0):
        return True
    else:
        return False

card_number= 1456734512345698 #4539869650133101  #1456734512345698 # #5239512608615007
result=validate_credit_card_number(card_number)
if(result):
    print("credit card number is valid")
else:
    print("credit card number is invalid") 
```**

# javascript - Javascript 如何强制 string.replace 不将我的字符串解释为正则表达式

> ID：12310838
> 
> 赞同：0
> 
> 时间：2012-09-07T02:12:41.267
> 
> 标签：javascript, regex

假设我有一个字符串 foo 可能有正则表达式特殊字符（例如文件路径）。

我有一个字符串 x

```
x.replace(foo, 'bar'); 
```

但我不希望 foo 被解释为正则表达式，我只是希望它用 'bar' 替换文字字符串 foo。

我该如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T02:17:58.797

如果`foo`是字符串，那么它不会被解释为正则表达式，它只会将文字字符串 foo 替换为`'bar'`.

`"aaa /bbb/ ccc".replace("/bbb/", "eee")`返回`"aaa eee ccc"`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T02:17:25.367

如果您希望*foo*被视为文字，则将其作为文字字符串传递：

```
str = x.replace('foo', 'bar'); 
```

或者，例如：

```
var path = "/bin/cat";
path = path.replace("/bin", "/usr/local/bin"); 
```

该[`replace`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)方法将正则表达式或文字字符串作为第一个参数。

# java - 带有自定义类加载器的spring asm

> ID：12310839
> 
> 赞同：1
> 
> 时间：2012-09-07T02:13:07.143
> 
> 标签：java, spring, classloader, aop, encryption

我们的应用程序通过 SSH，我们添加了一个自定义类加载器来保证类的安全，但是加密类文件后，应用程序无法启动。似乎spring使用asm加载类文件，并且由于文件被加密，它无法成功加载。有什么办法可以做到吗？或者我如何在没有asm的情况下使用spring？

# java - 设计决策：我应该为所有低级库提供线程安全版本吗？

> ID：12310845
> 
> 赞同：0
> 
> 时间：2012-09-07T02:14:51.250
> 
> 标签：java, multithreading, concurrency

我经历了一段非常痛苦的 Java 学习曲线，但我还是个新手。

我正在设计一个低级库类，将来它可能可以用于多线程环境或仅用于单线程。我对此一无所知。

**我可以让这个类的用户从外部同步。但这比提供线程安全版本效率低得多。**

这是p码。

```
Class Example{
    public int checkAndProcess(){
        WriteLock writeLock=this.getWriteLock();
        ReadLock readLock=new ReadLock(writeLock);
        int a;
        try{
            lockManager.lock(readLock);
            a=readSomething();
        }finally{
            lockManager.release(readLock);
        }
        if(a!=null){
            return a;
        }
        try{
            lockManager.lock(writeLock);
            a=doSomeProcessing();
        }finally{
            lockManager.release(writeLock);
        }
        return a;
    }
} 
```

它比从外部同步要快得多，因为 readlock 不会阻塞。它在每个方法调用中创建和垃圾收集。

问题：

**开销**。WriteLock 相当复杂，ReadLock 既便宜又简单，但它是在每个方法调用（可能还有多个）中创建的，所以仍然是开销。

我应该为每个此类提供线程安全版本吗？每个开源库都不会这样做。但是如果我不提供，让用户从外部同步，性能会降低。

或者有没有更好的方法？

编辑：

我应该拆分它吗？

将其拆分为无状态处理器和存储，并让用户创建 readLock/writeLock 来锁定？如果我这样做，商店将完全是为处理器设计的，对其他类没有多大意义，图书馆很快就会被这些东西轰炸。

这是我的真实代码。不喜欢的可以无视。

```
package lazycatTools.runtime;

import java.util.ArrayList;
import java.util.Collection;
import java.util.HashMap;
import java.util.HashSet;

import org.eclipse.core.runtime.Assert;
import org.eclipse.core.runtime.jobs.Job;
import org.osgi.framework.AllServiceListener;
import org.osgi.framework.BundleContext;
import org.osgi.framework.Constants;
import org.osgi.framework.InvalidSyntaxException;
import org.osgi.framework.ServiceEvent;
import org.osgi.framework.ServiceListener;
import org.osgi.framework.ServiceReference;

public class DynamicServiceTracker {

    private final HashMap<Long,Object> _serviceCache;
    private final HashMap<String,Long> _keyCache;

    private final MultiResourceSchedulingRule _writeLock;

    private final ServiceListener _tracker;

    private final BundleContext _context;

    public DynamicServiceTracker(BundleContext context){
        Assert.isLegal(context!=null);
        _serviceCache=new HashMap<Long,Object>();
        _keyCache=new HashMap<String,Long>();
        HashSet<Object> lockResource=new HashSet<Object>(4);
        lockResource.add(_serviceCache);
        lockResource.add(_keyCache);
        _writeLock=new MultiResourceSchedulingRule<DynamicServiceTracker,Object>(this,lockResource);
        _context=context;
        _tracker=new AllServiceListener(){

            @Override
            public void serviceChanged(ServiceEvent event) {
                if(event.getType()==ServiceEvent.UNREGISTERING){
                    ServiceReference<?> ref=event.getServiceReference();
                    Long sid=(Long)ref.getProperty(Constants.SERVICE_ID);
                    String[] classes=(String[])ref.getProperty(Constants.OBJECTCLASS);
                    boolean ungetService=false;
                    try{
                        Job.getJobManager().beginRule(_writeLock, null);
                        for(String clazz : classes){
                            if(_keyCache.get(clazz)==sid){
                                _keyCache.remove(clazz);
                                break;
                            }
                        }
                        if(_serviceCache.containsKey(sid)){
                            _serviceCache.remove(sid);
                            ungetService=true;
                        }
                    }finally{
                        Job.getJobManager().endRule(_writeLock);
                    }
                    if(ungetService){
                        //The order of ungetting a serviceReference is not important
                        _context.ungetService(ref);
                    }
                    SharedSchedulingRule readLock=new SharedSchedulingRule(_writeLock);
                    try{
                        Job.getJobManager().beginRule(readLock, null);
                        if(_serviceCache.size()==0){
                            _context.removeServiceListener(_tracker);
                        }
                    }finally{
                        Job.getJobManager().endRule(readLock);
                    }
                }
            }
        };
    }

    public Object getService(String clazz) throws Exception{
        Object cachedService=null;
        Long key;
        SharedSchedulingRule readLock=new SharedSchedulingRule(_writeLock);
        try{
            Job.getJobManager().beginRule(readLock, null);
            key=_keyCache.get(clazz);
            if(key!=null){
                cachedService=_serviceCache.get(key);
            }
        }finally{
            Job.getJobManager().endRule(readLock);
        }
        if(cachedService!=null){
            return cachedService;
        }
        ServiceReference<?> ref=_context.getServiceReference(clazz);
        Long sid=(Long)ref.getProperty(Constants.SERVICE_ID);
        Object newService=_context.getService(ref);
        try{
            Job.getJobManager().beginRule(_writeLock, null);
            key=_keyCache.get(clazz);
            if(key!=null){
                cachedService=_serviceCache.get(key);
            }else{
                _keyCache.put(clazz,sid);
                _serviceCache.put(sid, newService);
            }
        }finally{
            Job.getJobManager().endRule(_writeLock);
        }

        if(cachedService!=null){
            _context.ungetService(ref);
            return cachedService;
        }else{
            _context.addServiceListener(_tracker);
            return newService;
        }
    }

    public <Type> Type getService(Class<Type> clazz){
        Object cachedService=null;
        Long key;
        SharedSchedulingRule readLock=new SharedSchedulingRule(_writeLock);
        try{
            Job.getJobManager().beginRule(readLock, null);
            key=_keyCache.get(clazz);
            if(key!=null){
                cachedService=_serviceCache.get(key);
            }
        }finally{
            Job.getJobManager().endRule(readLock);
        }
        if(cachedService!=null){
            @SuppressWarnings("unchecked")
            Type castedService=(Type)cachedService;
            return castedService;
        }
        ServiceReference<Type> ref=_context.getServiceReference(clazz);
        Long sid=(Long)ref.getProperty(Constants.SERVICE_ID);
        Type newService=_context.getService(ref);
        try{
            Job.getJobManager().beginRule(_writeLock, null);
            key=_keyCache.get(clazz);
            if(key!=null){
                cachedService=_serviceCache.get(key);
            }else{
                _keyCache.put(clazz.getName(),sid);
                _serviceCache.put(sid, newService);
            }
        }finally{
            Job.getJobManager().endRule(_writeLock);
        }
        if(cachedService!=null){
            _context.ungetService(ref);
            @SuppressWarnings("unchecked")
            Type castedService=(Type)cachedService;
            return castedService;
        }else{
            _context.addServiceListener(_tracker);
            return newService;
        }
    }

    public Object[] getServices(String clazz,String filter) throws InvalidSyntaxException{
        ServiceReference<?>[] refs=_context.getServiceReferences(clazz,filter);
        if(refs==null){
            return null;
        }
        Object[] services=new Object[refs.length];
        int count=refs.length;
        boolean[] serviceAbsence=new boolean[refs.length];
        Long[] SIDs=new Long[refs.length];
        for(int i=0;i<=count-1;i++){
            ServiceReference<?> ref=refs[i];
            SIDs[i]=(Long)ref.getProperty(Constants.SERVICE_ID);
        }
        boolean loop=true;
        SharedSchedulingRule readLock=new SharedSchedulingRule(_writeLock);
        while(loop){
            try{
                Job.getJobManager().beginRule(readLock, null);
                for(int i=0;i<=count-1;i++){
                    if(_serviceCache.containsKey(SIDs[i])==false){
                        serviceAbsence[i]=true;
                    }
                }
            }finally{
                Job.getJobManager().endRule(readLock);
            }
            for(int i=0;i<=count-1;i++){
                if(serviceAbsence[i]==true){
                    services[i]=_context.getService(refs[i]);
                }
            }
            try{
                Job.getJobManager().beginRule(_writeLock, null);
                boolean gotNewRequire=false;
                for(int i=0;i<=count-1;i++){
                    if(_serviceCache.containsKey(SIDs[i])==false && services[i]==null){
                        serviceAbsence[i]=true;
                        gotNewRequire=true;
                    }
                }
                if(gotNewRequire==false){
                    for(int i=0;i<=count-1;i++){
                        Object service=services[i];
                        if(service!=null){
                            _serviceCache.put(SIDs[i], service);
                        }else{
                            services[i]=_serviceCache.get(SIDs[i]);
                        }
                    }
                    loop=false;
                }
            }finally{
                Job.getJobManager().endRule(_writeLock);
            }
        }
        _context.addServiceListener(_tracker);
        return services;    
    }
    public <Type> Collection<Type> getServices(Class<Type> clazz,String filter) throws InvalidSyntaxException{
        Collection<ServiceReference<Type>> refsCollection=_context.getServiceReferences(clazz,filter);
        HashMap<Integer,Type> services=new HashMap<Integer,Type>(refsCollection.size()+1,1.0f);
        if(refsCollection.size()==0){
            return services.values();
        }
        ArrayList<ServiceReference<Type>> refs=new ArrayList<ServiceReference<Type>>(refsCollection);
        int count=refs.size();
        boolean[] serviceAbsence=new boolean[refs.size()];
        Long[] SIDs=new Long[refs.size()];
        for(int i=0;i<=count-1;i++){
            ServiceReference<Type> ref=refs.get(i);
            SIDs[i]=(Long)ref.getProperty(Constants.SERVICE_ID);
        }
        boolean loop=true;
        SharedSchedulingRule readLock=new SharedSchedulingRule(_writeLock);
        while(loop){
            try{
                Job.getJobManager().beginRule(readLock, null);
                for(int i=0;i<=count-1;i++){
                    if(_serviceCache.containsKey(SIDs[i])==false){
                        serviceAbsence[i]=true;
                    }
                }
            }finally{
                Job.getJobManager().endRule(readLock);
            }
            for(int i=0;i<=count-1;i++){
                if(serviceAbsence[i]==true){
                    services.put(i, _context.getService(refs.get(i)));
                }
            }
            try{
                Job.getJobManager().beginRule(_writeLock, null);
                boolean gotNewRequire=false;
                for(int i=0;i<=count-1;i++){
                    if(_serviceCache.containsKey(SIDs[i])==false && services.containsKey(i)==false){
                        serviceAbsence[i]=true;
                        gotNewRequire=true;
                    }
                }
                if(gotNewRequire==false){
                    for(int i=0;i<=count-1;i++){
                        Object service=services.get(i);
                        if(service!=null){
                            _serviceCache.put(SIDs[i], service);
                        }else{
                            @SuppressWarnings("unchecked")
                            Type cachedService=(Type)_serviceCache.get(SIDs[i]);
                            services.put(i,cachedService);
                        }
                    }
                    loop=false;
                }
            }finally{
                Job.getJobManager().endRule(_writeLock);
            }
        }
        _context.addServiceListener(_tracker);
        return services.values();   
    }

} 
```

这是 MultiResourceSchedulingRule。

```
package lazycatTools.runtime;

import java.util.Collections;
import java.util.Set;
import java.util.HashSet;

import org.eclipse.core.runtime.Assert;
import org.eclipse.core.runtime.jobs.ISchedulingRule;

public class MultiResourceSchedulingRule<ParentType,ResourceType> extends ResourceBindingSchedulingRule<ParentType> implements IMultiResourceSchedulingRule<ParentType,ResourceType>  {

    private final Set<ResourceType> _resources;

    public MultiResourceSchedulingRule(ParentType parent){
        this(parent,new HashSet<ResourceType>());
    }
    public MultiResourceSchedulingRule(ParentType parent,Set<ResourceType> resources){
        super(parent);
        Assert.isLegal(resources!=null);
        _resources=resources;
    }
    @Override
    public boolean isConflicting(ISchedulingRule rule){
        if(rule==this){
            return true;
        }
        if(rule instanceof IResourceBindingSchedulingRule<?>){
            final IResourceBindingSchedulingRule<?> casted=(IResourceBindingSchedulingRule<?>)rule;
            if(_resources.contains(casted.getResource())){
                return true;
            }
        }
        if(rule instanceof IMultiResourceSchedulingRule<?,?>){
            final IMultiResourceSchedulingRule<?,?> casted=(IMultiResourceSchedulingRule<?,?>)rule;
            if(Collections.disjoint(_resources,casted.getResources())==false){
                return true;
            }
        }
        return false;
    }
    @Override
    public boolean contains(ISchedulingRule rule){
        if(rule==this){
            return true;
        }
        if(rule instanceof IResourceBindingSchedulingRule<?>){
            final IResourceBindingSchedulingRule<?> casted=(IResourceBindingSchedulingRule<?>)rule;
            if(_resources.contains(casted.getResource())){
                return true;
            }
        }
        if(rule instanceof IMultiResourceSchedulingRule){
            final IMultiResourceSchedulingRule<?,?> casted=(IMultiResourceSchedulingRule<?,?>)rule;
            if(_resources.containsAll(casted.getResources())){
                return true;
            }
        }
        return false;
    }
    @Override
    public Set<ResourceType> getResources() {
        return Collections.<ResourceType>unmodifiableSet(_resources);
    }   
} 
```

和 ResourceBindingSchedulingRule。

```
package lazycatTools.runtime;

import org.eclipse.core.runtime.Assert;
import org.eclipse.core.runtime.jobs.ISchedulingRule;

public class ResourceBindingSchedulingRule<ResourceType> implements IResourceBindingSchedulingRule<ResourceType> {

    private final ResourceType _resource;

    public ResourceBindingSchedulingRule(ResourceType resource){
        Assert.isLegal(resource!=null);
        _resource=resource;
    }

    /* (non-Javadoc)
     * @see lazycatTools.runtime.IResourceBindingSchedulingRule#getResource()
     */
    @Override
    public ResourceType getResource() {
        return _resource;
    }

    @Override
    public boolean contains(ISchedulingRule rule) {
        return isConflicting(rule);
    }

    @Override
    public boolean isConflicting(ISchedulingRule rule) {
        if(rule==this){
            return true;
        }
        if(rule instanceof IResourceBindingSchedulingRule<?>){
            final IResourceBindingSchedulingRule<?> casted=(IResourceBindingSchedulingRule<?>)rule;
            return _resource==casted.getResource();
        }
        return false;
    }

} 
```

SharedSchedulingRule 在示例中用作 readLock。

```
package lazycatTools.runtime;

import org.eclipse.core.runtime.jobs.ISchedulingRule;

public class SharedSchedulingRule implements ISchedulingRule {

    private final ISchedulingRule _rule;

    public SharedSchedulingRule(ISchedulingRule rule){
        _rule=rule;
    }

    @Override
    public boolean contains(ISchedulingRule rule) {
        if(rule==this){
            return true;
        }
        return _rule.contains(rule);
    }

    @Override
    public boolean isConflicting(ISchedulingRule rule) {
        if(rule==this){
            return true;
        }
        return _rule.isConflicting(rule);
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T02:51:27.567

最好的选择是让一切**不可变**。那么你就不用担心任何事情了:-)

假设这是不可能的，那么我建议**不要**让你的库线程安全。

*   线程安全通常会增加**开销**。在低级库中，您不应该强迫用户为他们可能不需要的安全性付出性能损失。
*   即使您在库级别添加线程安全，用户*仍可能必须***在更高级别**添加自己的锁定（这是因为锁定不组合）。因此，您可能实际上并没有为您的用户节省任何工作。
*   如果需要，您可以随时添加**同步包装器**。但是如果它被烘焙，你就不能删除同步。
*   它将使您自己的库代码**更简单**。您可以专注于更好的功能，而不是担心锁。

There are good examples in the Java standard library that follow this approach and logic - e.g. `ArrayList` is not thread safe.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T02:17:29.903

了解您的用户。如果您无法提前确定或无法对主题做出有根据的猜测，请不要这样做。

库发布后，听取您的用户的意见，他们会通知您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T02:20:50.630

这仅取决于您拥有什么样的用户以及他们使用您的 api 的方式。没有“永远正确”的答案。

如果您决定进行同步，请考虑使用[ReentrantReadWriteLock](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html)而不是您使用的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T02:36:46.467

这取决于您的程序将应用于什么用途，但在必要的更改之前您最好不要让您的代码过于复杂。多线程的优化可以稍后添加，但在您的程序成熟之后。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T02:43:41.813

您也许可以使其成为线程安全的，但效率更高，在常见情况下可能只有一次易失性读取。您可以提供更真实的问题版本，以便我们更好地理解。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T02:48:10.677

我同意所有先前的答案。试图找出并发使用模式可能意味着过早的优化。最好不要提供对多线程的支持并将其推送给库的用户。有点像 JCF 类；请参阅 ArrayList、LinkedList 和列表继续。

# html - 如何配置我的 route.rb 页面以重定向到视图

> ID：12310846
> 
> 赞同：0
> 
> 时间：2012-09-07T02:15:01.937
> 
> 标签：html, ruby-on-rails, ruby

在我的 route.rb 文件中，我目前有：

```
 map.connect ':controller/:action/:id'
  map.connect ':controller/:action/:id.:format'
  map.root :controller => "test" 
```

如何将我的索引页面定向到这样的内容： http: [//site.com/railstest/test/index.html](http://site.com/railstest/test/index.html)

或者只是： [http ://site.com/railstest/test.erb](http://site.com/railstest/test.erb)

最初它开始于： [http ://site.com/railstest/](http://site.com/railstest/)

这将我带到了默认的 html 页面，该页面现已被删除。我应该更改路线还是在视图文件夹中创建一个test.rb，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T04:44:06.423

绕过每个控制器，无法创建直接进入视图的路由。

因此，您现在有两种选择：

1.  将其作为静态 html 页面

    *   创建完整的 html 页面
    *   将其保存在 /public/railstest/filename.html
    *   使用网址：site.com/railstest/filename.html
    *   注意：难以维护，并且不能利用布局。
2.  创建一个将为您的视图提供服务的控制器

    *   “rails g PagesController index”的“脚本/生成 RailstestController 索引”
    *   删除它创建的 app/views/index.html.erb 并将 yourview 文件复制到该名称
    *   应该工作

# javascript - 使用 HTML 进行 Visual Basic UI 设计

> ID：12310852
> 
> 赞同：0
> 
> 时间：2012-09-07T02:15:52.920
> 
> 标签：javascript, jquery, html, css, vb6

我正在使用 Visual Basic 6 设计一个桌面应用程序，我希望它的 UI 看起来很棒。我在想是否有任何方法可以使用 HTML/CSS/JQuery 来设计交互式 UI 元素（可以通过使用浏览器控件显示 HTML，但是在单击（比如说）HTML 元素之后，我仍然需要调用我的VB函数来执行任务，我不能用Javascript来做。此外，浏览器控件是基于IE的，最好不要使用，因为它不支持大多数JQuery/CSS。所以，基本上我想要的是：

1.  基于 webkit 引擎的 VBb 的 ActiveX 控件，用于显示 HTML
2.  javascript函数调用我的VB函数的一种方式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T12:14:36.783

如果您希望您的 UI “看起来很棒”，那么 VB6 不适合您。

开箱即用，它看起来已经过时了，这并不奇怪，因为它自 1998 年左右以来就没有更新过。

你可以让它看起来更现代，但我认为（恕我直言）你很快就会发现需要购买一些第三方控件来赋予它你想要的外观和感觉。

我们使用了[CodeJock 控件套件](http://www.codejock.com/products/suitepro/?platform=com)——这些控件中的很多都支持类似于 xaml 的“标记”样式，并且可以使 VB6 应用程序看起来非常现代（带状栏界面、带有鼠标悬停效果的圆角按钮等）

# c# - 如何从 ASMX 服务获取标头响应

> ID：12310859
> 
> 赞同：1
> 
> 时间：2012-09-07T02:16:40.080
> 
> 标签：c#, asp.net-mvc-3, asmx

我得到了一个**[asmx 端点](http://www.klasselotteriet.dk/sitecore%20modules/Web/DDK.ExternalAccess/WinnerSite/WinnerSiteService.asmx?op=CreateCompetitor)**，无论好坏，该方法什么都不返回：

使用`svcutil.exe`生成代理和配置后，我调用服务并执行方法：

```
// connect
WinnerSiteServiceSoapClient client = new WinnerSiteServiceSoapClient();
// send
client.CreateCompetitor("1", "2", "3", "4", "5", 6);
// disconnect
client.Close(); 
```

但是该方法`CreateCompetitor`，正如服务文档所说，返回`void`，**我如何确保该方法被成功调用和回答？**

启动[Fiddler](http://www.fiddler2.com/fiddler2/)，我可以看到我得到了`HTTP 200`响应，但是，我怎样才能从**代理对象**中得到它呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T09:41:38.577

**简而言之：没有异常意味着请求成功。**

如您所知，代理类抽象出向服务发送请求的 HTTP 部分。这也意味着您将找不到与服务器返回的 HTTP 状态相对应的属性（除非您调整生成的代理类）。

当你通过代理类调用那个 void WebMethod 并且调用没有失败时，说明服务器已经成功接收到了。如果服务器抛出异常（可能告诉您某些参数无效——尽管它应该返回 false 或某些 XML 说明，但这是设计问题），那么您的调用将失败并出现 System.ServiceModel.FaultException。

如果存在网络问题并且请求无法以某种方式到达服务器，那么您还会收到异常：System.ServiceModel.EndpointNotFoundException。

这两个异常都是由为您处理 HTTP 的代理类引发的。

# c - GDB /“malloc_error_break”未定义

> ID：12310860
> 
> 赞同：1
> 
> 时间：2012-09-07T02:16:42.900
> 
> 标签：c, macos, memory, gdb, malloc

我正在尝试了解有关 malloc 和 free 的更多信息，因此我创建了一个实现这些功能的 dylib，并且我正在加载到一个通用系统二进制文件中。但是，它有错误，我正在尝试调试它们。

*   malloc.dylib 是我的动态库

这是 gdb 输出：

```
(gdb) set env DYLD_INSERT_LIBRARIES malloc.dylib
(gdb) break malloc_error_break
Function "malloc_error_break" not defined.
Make breakpoint pending on future shared library load? (y or [n]) n 
(gdb) r
Starting program: /bin/ls 
[+] init()
[-] myMalloc requesting: 4096 bytes
[-] memory address: 200000
bash(2035) malloc: *** error for object 0x200000: pointer being freed was not allocated
*** set a breakpoint in malloc_error_break to debug

Program terminated with signal SIGABRT, Aborted.
The program no longer exists.
(gdb) 
```

我感到困惑的是消息

```
Function "malloc_error_break" not defined. 
```

当我尝试在其上设置断点时。显然，它不会因为未知而崩溃。

有什么帮助吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T03:06:04.863

您无法设置断点的原因`malloc_error_break`是该函数是在尚未加载的共享库中定义*的*。

运行程序一次后，您应该能够设置断点。

或者，使用`start`代替`run`，当程序在 上停止时*，*`main`您应该能够在 上设置断点。*`malloc_error_break`*

# python - 当我使用 django 运行 syncdb 时，它是否指定了 mysql 的排序规则设置？

> ID：12310866
> 
> 赞同：2
> 
> 时间：2012-09-07T02:17:33.387
> 
> 标签：python, mysql, django

干净利落。我有一个新的 Django 项目。我添加了一些模型并在 settings.py 中指定了正确的 mysqldb 设置。我运行同步数据库。排序规则设置是由我的 MySQL 安装决定的，还是 syncdb 对此有发言权？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T02:49:45.137

如此处所述[https://docs.djangoproject.com/en/dev/ref/databases/#collat​​ion-settings](https://docs.djangoproject.com/en/dev/ref/databases/#collation-settings)

> 您通过直接操作数据库表来设置排序规则；Django 没有提供在模型定义上设置它的方法。

我想，这回答了你的问题，简单而甜蜜

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-21T19:54:31.353

我不知道你想达到什么目的，但在大多数情况下你可能想要 utf-8。

如果是这种情况，则在创建 MySQL 数据库时指定字符集：

```
CREATE DATABASE <dbname> CHARACTER SET utf8; 
```

# .net - C# 将 DateTime 转换为字符串导致服务器错误

> ID：12310868
> 
> 赞同：0
> 
> 时间：2012-09-07T02:18:09.703
> 
> 标签：.net, c#-4.0

这是一个非常简单的代码，我不知道为什么它有问题。

```
DateTime temp = DateTime.Now;
s = temp.ToString("yyyyMMdd"); 
```

上面的代码将起作用。但如果我将 yyyyMMdd 更改为 yyyy-MM-dd 或 yyyy-MM-dd HH:mm:tt 或任何其他形式，甚至只是 ToString()，它将在“/”应用程序中显示服务器错误。

有没有办法解决它？我想展示类似 2012-9-6 10:17:31 的内容。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T02:22:46.627

试一试怎么样

```
s = String.Format("{0:yyyy/M/d HH:mm:ss}", temp); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T02:24:27.990

您可能有影响格式的默认区域性。

尝试使用不变的文化：

```
s = temp.ToString("yyyy-MM-dd", CultureInfo.InvariantCulture); 
```

# git - git：子目录中的独立版本控制？

> ID：12310872
> 
> 赞同：1
> 
> 时间：2012-09-07T02:18:26.327
> 
> 标签：git

我有一个受 git 版本控制的项目。一切顺利。

我还有“buildtool”目录，里面有一些用于测试、部署和设置的脚本。

有时在更改分支时，我希望该目录是最新的，并且我希望它处于版本控制之下？

我如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T20:42:32.027

+1 子模块（感谢 Adrian Cornish 第一次提出建议）从技术上讲，您有两个不同的项目，它们具有松散耦合，但没有真正的源代码耦合。首先将它们放在单独的存储库中。然后要么将它们完全分开，要么使用子模块将构建内容链接到源内容。

# android - 如何从我的数据库中获取随机 rowId？

> ID：12310873
> 
> 赞同：-1
> 
> 时间：2012-09-07T02:18:25.633
> 
> 标签：android, sqlite, random

我有一个数据库，我从中获取我的问题、正确答案/选项……我希望我的应用程序自动生成随机 rowId，以便可以打乱问题。当然，已经显示的问题不应该再次显示。我想得到 10 个问题然后完成（）；..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T02:34:46.513

无需先生成随机 ID。只需插入你的行，确保你有`questionId`列。

当您想读取数据库时。做类似的事情`quizid = rand()`......

之后，您在数据库中选择带有 quizid 的行

```
SELECT * FROM quiztable WHERE questionId = quizid 
```

类似的东西会给你一个随机的数据库行。

我认为你说对了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T02:46:13.810

使用随机 rowId 是错误的方法。如果数据库被修改，ID失效了怎么办？您必须检查每个 ID 并在出现无效 ID 时重新生成。

相反，您应该在 SELECT 语句中使用 LIMIT 子句，其随机数小于表中的行数。

# c - 为什么DDK能成功编译出无效的源文件？

> ID：12310879
> 
> 赞同：2
> 
> 时间：2012-09-07T02:19:18.817
> 
> 标签：c, windows, compiler-construction, driver, wdk

首先，您可以通过 DDK 构建实用程序成功编译以下 main.c。

```
#include <ntddk.h>

NTSTATUS DriverEntry(PDRIVER_OBJECT, PUNICODE_STRING)
{
    try
    {
        leave;
    }
    except (1)
    {
    }

    return 0;
} 
```

但是，请注意：

“leave”和“except”都不是有效的 C 语言关键字。

我知道 __leave 和 __except （即带有双前导下划线）都是微软特定的关键字来扩展 C 语言，但“leave”和“except”不是。

我还确认宏没有定义“离开”和“除外”。MSDN对此没有解释。

谁能给我一个解释？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T17:39:44.450

正如 Rohan 所指出的，它们是由`warning.h`. 这些定义是为了向后兼容使用非下划线版本的旧代码。

# mongodb - mongodb副本集secondary节点改为primary不合理

> ID：12310885
> 
> 赞同：0
> 
> 时间：2012-09-07T02:21:27.567
> 
> 标签：mongodb, cluster-computing

我的 mongodb rs 配置类似于：

```
node1:shard1 primary,shard2 primary 
node2:shard1 secondary,shard2 secondary 
node3:shard1 arbiter,shard2 artbite 
```

每次读写都很多，但是昨天发现mode1变成了secondary，contrast，node2变成了primary，我很奇怪，所以发这个issue，希望大家多多指教。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T03:06:37.420

在副本集中，主要的降级成为次要的情况并不罕见，并且会出于以下三个原因之一发生。

1.  [`replSetStepDown`](http://docs.mongodb.org/manual/reference/command/replSetStepDown/#replSetStepDown)命令告诉它
2.  主节点无法联系大多数节点
3.  它认为次要节点更有资格成为主要节点并且具有更高的优先级。

如果辅助节点无法联系到主节点，或者主节点响应速度太慢，它也可以要求进行选举。选举将迫使初选下台。

[您可以在文档](http://docs.mongodb.org/manual/core/replication-internals/#replica-set-election-internals)中阅读有关此过程的更多信息

# php - PHP 评估语法

> ID：12310888
> 
> 赞同：1
> 
> 时间：2012-09-07T02:22:14.073
> 
> 标签：php, mysql, eval

我需要帮助找出 eval 函数的语法——或者即使 eval 是正确的方法。我的 mysql 数据库中有一个列，其中包含我需要运行的 PHP 函数的名称。还有一些 PHP 变量希望保留为变量，直到它们被传递给函数。以下是我到目前为止的内容：

```
eval($valRec[$key]($key,$value)); 
```

$valRec 是包含 mysql SELECT 的结果的数组。$key 是一个变量，它引用包含函数名称的列的名称。

$key 和 $value 是我需要传递给函数的 PHP 变量。

最后，我想结束：

```
functionName($key,$value); 
```

应该运行哪个 PHP。

希望我解释清楚 - 提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T02:37:40.050

eval 可能不是你想要的。看`call_user_func`和`call_user_func_array`。它们允许您调用名称在变量中的函数。

```
call_user_func($valRec[$key], $key, $value); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T02:27:32.013

您需要做的就是：

```
$valRec[$key]($key,$value); 
```

参考：[变量函数](http://www.php.net/manual/en/functions.variable-functions.php)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T02:46:45.917

在 php 中，您可以执行以下操作；

```
$func = 'strtolower';
$foo = $func($bar); 
```

所以在你的情况下，`$valRec[$key]($key,$value);`只会工作。

***[检查演示。](http://codepad.viper-7.com/1U9uDA)***

***补充：***`eval`你不工作 的原因`eval`需要将字符串作为参数，不要忘记`;`结束语句，否则会出现语法错误。所以你需要这样做：

```
eval($valRec[$key].'($key, $value);'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T02:24:19.147

我最近没用过PHP，但是这个概念`eval`是对一个字符串求值。

因此，您需要创建代表您要运行的代码行的字符串。

在您的情况下，这意味着：

```
eval($valRec[$key] . '($key, $value);'); 
```

你自己说过，你想结束`functionName($key,$value);`所以你需要制作一个字符串，然后将它传递给`eval`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T02:23:45.717

看这个例子，

```
<?php
    $string = 'cup';
    $name = 'coffee';
    $str = 'This is a $string with my $name in it.';
    echo $str. "\n";
    eval("\$str = \"$str\";");
    echo $str. "\n";
?> 
```

这是输出

```
This is a $string with my $name in it.
This is a cup with my coffee in it. 
```

你需要阅读这篇文章，**[什么时候 eval 在 php 中是邪恶的？](https://stackoverflow.com/a/951868/491243)**

# javascript - 使用嵌入式数组解析 JSON 对象，如何？

> ID：12310890
> 
> 赞同：0
> 
> 时间：2012-09-07T02:22:25.890
> 
> 标签：javascript, ajax, arrays, json, parsing

考虑以下 Javascript。我正在解析的 JSON 对象上有一个名为 History 的数组。History (resp[0].History) 数组中的每个对象都有一个 UniqueID 属性。请问如何获取数组中每个对象的 UniqueID 属性？

```
// Retrieve individual licence information.
function loadLicenceDetails(uniqueID) {
    document.body.style.cursor = 'wait';
    $('#loadingLicenceDiv').modal('show');
    $.ajax({
        type: 'POST',
        contentType: 'application/json; charset=utf-8',
        url: '/JadeLicensingWebService/default.asmx/GetLicenceDetails',
        dataType: 'json',
        data: '{"licenceHolder":"' + $.cookie("companyName") + '","uniqueID":"' + uniqueID + '"}',
        success: function (data) {
            resp = $.parseJSON(data.d);
            $('#inputLicenceName').val(resp[0].LicenceName);
            $('#licenceKeyInput').val(resp[0].LicenceKey);
            $('#selectProductType').val(resp[0].Product);
            $('#selectDuration').val(resp[0].Duration);
            $('#startDateInput').val(resp[0].StartDate);
            $('#expiryDateInput').val(resp[0].ExpiryDate);
            $('#orderedByInput').val(resp[0].OrderedBy);
// How do I get at the History.UniqueID ?
            $('#notesInput').val(resp[0].Notes);
            $('#licenceInfoHeader').html('<strong>#' + uniqueID + '</strong> - ' + resp[0].LicenceName); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T02:31:01.750

假设您的 JSON 看起来像：

```
{
  "History": [
    {
      "UniqueId": "abc"
    },
    {
      "UniqueId": "def"
    },
    {
      "UniqueId": "ghi"
    },
  ]
} 
```

你可以这样做：

```
var ids = []; // Make an array to hold the IDs
// Iterate over History items
for (var i = 0; i < resp.History.length; i++) {
  var item = resp.History[i];
  ids.push(item.UniqueId); // Put each ID in the array
} 
```

如果这不是您的 JSON 对象的样子，您能否在您的问题中添加一个示例对象，以便更清楚您在问什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T02:43:35.923

通过使用此解决：

```
$('#licenceHistoryText').val(resp[0].History[0].DateIssued); 
```

编辑，最终解决方案：

```
 $.each(resp[0].History, function (i, obj) {
        document.getElementById("licenceHistoryText").value += obj.DateIssued + ' - ' + obj.LicenceName + ' [' + obj.LicenceKey + ']\n';
    }); 
```

# php - preg_replace {可变文本}

> ID：12310894
> 
> 赞同：1
> 
> 时间：2012-09-07T02:22:44.160
> 
> 标签：php, regex

我正在寻找 preg_replace($the_expression, "", $old_text) 的正则表达式

我有这样的文字：

{一些文本} 自 1500 年代以来，Lorem Ipsum 一直是行业的标准虚拟文本，当时一位不知名的印刷商采用了一种类型的厨房并将其加扰以制作一本类型样本书。它不仅经历了 {varying text} 五个世纪，而且经历了电子排版的飞跃，基本保持不变。它在 1960 年代{一些其他文本}随着 Letraset 表的发布而普及，其中包含

我想定位大括号内的任何不同文本，以及大括号，并替换为“”（无）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T02:29:41.483

您可以使用非贪婪的正则表达式：

```
$new_text = preg_replace( '/{.*?}/', '', $old_text); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T02:24:43.513

您正在寻找的正则表达式是这样的：

```
{[^}]+} 
```

哪个匹配：

```
{     - A left curly brace
[^}]+ - Anything that is not a right curly brace, one or more times
}     - A right curly brace 
```

因此，在 中[`preg_replace()`](http://php.net/preg_replace)，它将是：

```
$new_text = preg_replace( '/{[^}]+}/', '', $old_text); 
```

# ios - 关于父对象的init方法

> ID：12310899
> 
> 赞同：0
> 
> 时间：2012-09-07T02:23:15.743
> 
> 标签：ios

Parent.h（扩展 NSObject）像这样：

```
@implementation InTParent

-(id)init
{
    NSLog(@"Parent init method");
    if (self = [super init]) {
        ;
    }
    return self;
}

-(id)initWithName:(NSString*)name;
{
    NSLog(@"Parent initWithName method");
    if (self = [self init]) {
        ;
    } 
    return self;
} 
```

Son.h(extends Parent) 像这样：

```
@implementation InTSon

-(id)init
{
    NSLog(@"Son init method");
    if (self = [super init]) {
        ;
    }
    return self;
}

-(id)initWithName:(NSString*)name;
{
    NSLog(@"Son initWithName method");
    if (self = [super initWithName:name]) {
        ;
    }
    return self;
} 
```

我用这个：`IntSon *_son = [[IntSon alloc] initWithName:@"asd"];`

为什么输出是：Son initWithName 方法 --> Parent initWithName 方法 --> Son init 方法 --> Parent init 方法

但是在 Java 中，它可能是这样的：子 initWithName 方法 --> 父 initWithName 方法 --> 父 init 方法

请帮我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T03:03:20.760

要了解这种行为，您必须了解 Objective-C 消息调度的工作原理。这是一个很好的例子来说明它。

在高层次上，每当您在任何对象上调用方法时，Objective-C 运行时都会查找提供最多派生（在类层次结构中最深）的类的实现。如果它没有找到它，它将转到下一个最衍生的，依此类推，直到`NSObject`. 当它第一次找到与选择器匹配的实现（大致方法名称）时，它将执行该实现。当您调用 时`super`，您指定将消息发送到该方法的下一个最派生类的实现。

因此，在您的代码中，您调用类`alloc`，`InTSon`该类返回一个实例，`IntSon`其`isa`指针设置为类 object `InTSon`。`isa`指针是在提升类层次结构的过程中查找方法实现的方式。

所以在你有一个`InTSon`实例之后，你调用`initWithName:`它，它会检查指向的类`isa`（这是`InTSon`这个方法的实现。它找到它，所以执行它，产生你的第一个输出：

`"Son initWithName method"`

紧接着，您调用该方法的超类实现，它会查找并执行该代码`InTParent`的实现`initWithName:`，从而产生第二个输出：

`Parent initWithName method`

现在在这里您可以看到与 Java 的偏差 - 您可以调用`init`。但是，它是指向实例的指针。因此，当运行时解析此消息时，它首先会在类中查找 的实现。当然，它会找到它并执行该方法的代码，这会为您提供第三个输出，. 接下来调用 super，它会查找并执行 的实现，并为您提供最终输出。`self``self``InTSon``init``InTSon``Son init method``InTParent``init`

总而言之，无论从类层次结构中的**哪个位置**调用方法，如果调用`self`它，它将**始终**执行该方法的最派生实现。希望这会有所帮助，如果您有任何问题，请告诉我！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T03:16:17.960

您的类图如下所示：

![类图](../Images/20a057d32c7520b7d7e983c74a20c3d4.png)

当您将`initWithName:`消息发送到您的实例时`InTSon`，系统会在`InTSon`的方法表中查找方法，并找到我们调用的方法`-[InTSon initWithName:]`。该方法简化后如下所示：

```
// -[InTSon initWithName:]
- (id)initWithName:(NSString *)name {
    return [super initWithName:name];
} 
```

这种方法可以`[super initWithName:name]`。因为它向 发送消息`super`，所以系统在 的类的超类的方法表中查找`self`。您的对象的类是`InTSon`，它的超类是`InTParent`。那么什么`-[InTSon initWithName:]`时候`[super initWithName:name]`，系统在`InTParent`方法表中查找方法。它找到我们调用的方法`-[InTParent initWithName:]`。该方法简化后如下所示：

```
// -[InTParent initWithName:]
- (id)initWithName:(NSString *)name {
    return [self init];
} 
```

这种方法可以`[self init]`。因为它向 发送消息`self`，所以系统在方法表中查找`self`的类。即使我们在`-[InTParent initWithName:]`，**`self`仍然是`InTSon`类**的一个实例。因此系统`init`在`InTSon`的方法表中查找方法。它找到我们调用的方法`-[InTSon init]`。该方法简化后如下所示：

```
// -[InTSon init]
- (id)init {
    return [super initWithName:@"sdas"];
} 
```

这个方法可以`[super initWithName:]`，所以系统在超类的（`InTParent`'s）方法表中查找并找到`-[InTParent initWithName:]`方法。正如我们刚刚看到的，`-[InTParent initWithName:]`最终调用`[InTSon init]`. 所以我们得到了无限递归，应用程序崩溃了。

要解决这个问题，您需要选择一个`InTParent`init 方法作为其**指定的初始化器**。 [您应该阅读 Apple 文档中有关指定初始化程序的信息。](http://developer.apple.com/library/ios/#documentation/general/conceptual/DevPedia-CocoaCore/MultipleInitializers.html)

您应该选择该`initWithName:`方法作为`InTParent`指定的初始化程序。此方法**不得**向`self`. 它应该**只**发送 super 指定的初始化消息（在 的情况下`NSObject`是`init`消息），并且应该将它发送到`super`. 所以你需要编写这样的`-[InTParent initWithName:]`方法：

```
- (id)initWithName:(NSString *)name {
    // init is NSObject's designated initializer, and we send it to super.
    if ((self = [super init])) {
        // your initialization code here
    }
    return self;
} 
```

通过选择一个指定的初始化器，并让您的指定初始化器只将超类的指定初始化器消息发送到`super`，您可以防止无限递归。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T02:54:16.690

因为“self”是一个“InTSon”，所以[self init]调用了“InTSon”的init方法。

# mysql - 在 MySQL 数据库中放置触发器以更新 Oracle 数据库？

> ID：12310901
> 
> 赞同：2
> 
> 时间：2012-09-07T02:23:38.443
> 
> 标签：mysql, sql, oracle, triggers

我想在 MySQL 上创建一个插入触发器，它将自动将记录插入 Oracle 数据库。我想知道是否有人对此主题有经验分享。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T02:32:21.033

像本示例中所做的那样调用一个调用 Oracle 代码[的脚本。](http://www.boosten.org/2009/using-triggers-in-mysql/)

注意：当您执行这种类型的级联时，您将失去对事务的支持（Oracle 数据库将没有内置的回滚），并且这样做可能会对性能造成非常大的影响。该脚本可以转过来简单地调用 Java 代码或其他一些可执行文件，这些可执行文件会调用您的一些通用代码以插入到 Oracle 中，或者它可以是从脚本获取传递参数的原始查询。

由于奇怪的副作用行为，这几乎肯定是一个坏主意，但它是可以实现的。我认为最好让代码针对两个不同`DataSource`的 s（在 Java/.NET 中）执行此操作，而不是在 MySQL 触发器中有一个隐藏的脚本，它尖叫着无法维护，以及为未来的开发人员隐藏失败。

# ios - iOS 我可以构建一个应用程序或服务来保持蓝牙发现设备吗

> ID：12310905
> 
> 赞同：0
> 
> 时间：2012-09-07T02:23:56.230
> 
> 标签：ios, bluetooth, push-notification, bluetooth-lowenergy

如果发现新设备，则向用户推送通知。如何开始以及任何资源/示例代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T02:40:49.687

之前的三个答案都是错误的。iOS5 引入了[Core 蓝牙框架](https://developer.apple.com/library/ios/#documentation/CoreBluetooth/Reference/CoreBluetooth_Framework/_index.html)。

但是，**此框架仅适用于 BT 4.0 LE**；毫无疑问的蓝牙。

这里也是 PDF 参考：http: [//developer.apple.com/library/ios/documentation/CoreBluetooth/Reference/CoreBluetooth_Framework/CoreBluetooth_Framework.pdf](http://developer.apple.com/library/ios/documentation/CoreBluetooth/Reference/CoreBluetooth_Framework/CoreBluetooth_Framework.pdf)

## 例子

你的类必须符合**`CBCentralManagerDelegate`**和**`CBPeripheralDelegate`**协议。

```
CBCentralManager * btCentral = [[CBCentralManager alloc] initWithDelegate:self queue:nil];

/* Create an array of services from a CBUUID to scan for */
[btCentral scanForPeripheralsWithServices:nil options:nil]; 
```

这基本上是为了让您开始扫描外围设备。您还需要实现这些**`CBCentralManagerDelegate`**方法和其他一些方法，我建议您阅读文档：

```
- (void)centralManager:(CBCentralManager *)central didConnectPeripheral:(CBPeripheral *)peripheral

- (void)centralManager:(CBCentralManager *)central didDiscoverPeripheral:(CBPeripheral *)peripheral advertisementData:(NSDictionary *)advertisementData RSSI:(NSNumber *)RSSI

- (void)centralManager:(CBCentralManager *)central didRetrieveConnectedPeripherals:(NSArray *)peripherals 
```

# ios - ipad 横向/纵向图像

> ID：12310906
> 
> 赞同：2
> 
> 时间：2012-09-07T02:24:05.713
> 
> 标签：ios, ipad, landscape, portrait

我正在处理 ipad 应用程序开发的 UI 问题（关于图像）。我已经阅读了苹果开发网站上的一些文件，但我找不到任何关于它的信息。

图像文件是否有任何文件约定来区分系统应为横向/纵向加载哪个图像。因为我看到启动图像，我们可以使用“MyLaunchImage-Portrait.png”和“MyLaunchImage-Lanscape.png”。我曾尝试将“-Landscape”、“-Portrait”、“-Landscape~ipad”、“-Portrait~ipad”添加到其他图像以供一般使用，但它失败了。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T02:59:49.853

不幸的是，除了 iPad 的启动图像之外，没有标准的约定。但是，您可以使用`NSNotificationCenter`监听方向更改事件并相应地响应它们。这是一个例子：

```
- (void)awakeFromNib
{
    //isShowingLandscapeView should be a BOOL declared in your header (.h)
    isShowingLandscapeView = NO;
    [[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(orientationChanged:)
                                                 name:UIDeviceOrientationDidChangeNotification
                                               object:nil];
}

- (void)orientationChanged:(NSNotification *)notification
{
    UIDeviceOrientation deviceOrientation = [UIDevice currentDevice].orientation;
    if (UIDeviceOrientationIsLandscape(deviceOrientation) &&
        !isShowingLandscapeView)
    {
        [myImageView setImage:[UIImage imageNamed:@"myLandscapeImage"]];
        isShowingLandscapeView = YES;
    }
    else if (UIDeviceOrientationIsPortrait(deviceOrientation) &&
             isShowingLandscapeView)
    {
        [myImageView setImage:[UIImage imageNamed:@"myPortraitImage"]];
        isShowingLandscapeView = NO;
    }
} 
```

# wpf - 根据其他 DataGrid 列显示 ToolTip

> ID：12310909
> 
> 赞同：0
> 
> 时间：2012-09-07T02:24:21.497
> 
> 标签：wpf

我有两个DataGrid： ![问题](../Images/fb2d47ad1b6551df8ef732695855acf5.png) 我需要做的是当鼠标在绿色区域上时，工具提示显示“lower_limit”，当鼠标在红色区域上时，工具提示显示“upper_limit”。

但重要的是，工具提示需要根据列 [operation_type] 和第二个网格中的相应值来确定要显示的值。

这可能吗？

非常感谢。

在此处发布 xaml 代码：

```
<DataGrid Name="dgoperations"  AutoGenerateColumns="False" Background="#FFECE9D8" BorderBrush="#FFECE9D8" Grid.Row="1" MinRowHeight="30" IsReadOnly="True" Grid.ColumnSpan="2">
                            <DataGrid.Columns>
                                <DataGridTextColumn Binding="{Binding  Path=operation_sequence,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Header="operation_sequence" Width="sizetoheader" />
                                <DataGridTextColumn Binding="{Binding  Path=operation_name,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Header="operation_name" Width="sizetoheader" />
                                <DataGridTextColumn Binding="{Binding  Path=operation_type,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Header="operation_type" Width="sizetoheader" />
                                <DataGridTemplateColumn Header="parm1" >
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBox Text="{Binding parm_1}" ToolTip="Somthins display here. Values depand on value in column[operation_type]" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T17:48:12.417

您可以为此使用[IValueConverter](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)实现；如果您不熟悉，在链接中有一个如何使用这些的基本示例。基本思想是，您将数据对象传递给转换器，它会执行逻辑并返回正确的工具提示文本。

你的实现应该是这样的。

**XAML**

```
<TextBox Text="{Binding parm_1}" 
    ToolTip="{Binding Converter={StaticResource MyTooltipConverter}}"
/> 
```

**资源**

```
<local:MyTooltipConverter x:Key="MyTooltipConverter" /> 
```

**代码**

```
public class Converter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        MyDataType dataRow = value as MyDataType;
        string tooltip;

        // set tooltip to the correct value based on the dataRow
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

# java - 如何使用列表作为值遍历 LinkedHashMap

> ID：12310914
> 
> 赞同：60
> 
> 时间：2012-09-07T02:24:52.433
> 
> 标签：java, collections, linkedhashmap

我有以下 LinkedHashMap 声明。

```
LinkedHashMap<String, ArrayList<String>> test1 
```

我的观点是我如何遍历这个哈希图。我想在下面执行此操作，为每个键获取相应的数组列表并针对该键一一打印数组列表的值。

我试过这个但只*得到*返回字符串，

```
String key = iterator.next().toString();  
ArrayList<String> value = (ArrayList<String> )test1.get(key) 
```

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2012-09-07T02:28:10.127

```
for (Map.Entry<String, ArrayList<String>> entry : test1.entrySet()) {
    String key = entry.getKey();
    ArrayList<String> value = entry.getValue();
    // now work with key and value...
} 
```

顺便说一句，您应该真正将变量声明为接口类型，例如`Map<String, List<String>>`.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-09-07T02:32:58.690

我假设你的 get 语句中有错字，它应该是 test1.get(key)。如果是这样，我不确定为什么它不返回 ArrayList ，除非您首先没有在地图中输入正确的类型。

这应该有效：

```
// populate the map
Map<String, List<String>> test1 = new LinkedHashMap<String, List<String>>();
test1.put("key1", new ArrayList<String>());
test1.put("key2", new ArrayList<String>());

// loop over the set using an entry set
for( Map.Entry<String,List<String>> entry : test1.entrySet()){
  String key = entry.getKey();
  List<String>value = entry.getValue();
  // ...
} 
```

或者你可以使用

```
// second alternative - loop over the keys and get the value per key
for( String key : test1.keySet() ){
  List<String>value = test1.get(key);
  // ...
} 
```

在声明变量（以及在通用参数中）时，您应该使用接口名称，除非您有非常具体的原因来定义使用实现。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-04-22T22:27:59.520

在 Java 8 中：

```
Map<String, List<String>> test1 = new LinkedHashMap<String, List<String>>();
test1.forEach((key,value) -> {
    System.out.println(key + " -> " + value);
}); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-09-07T02:28:36.007

您可以使用条目集并迭代允许您直接访问键和值的条目。

```
for (Entry<String, ArrayList<String>> entry : test1.entrySet()) {
     System.out.println(entry.getKey() + "/" + entry.getValue());
} 
```

> 我试过了，但只得到返回字符串

你为什么这么认为？在您的情况下，该方法[`get`](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html#get%28int%29)返回`E`选择泛型类型参数的类型`ArrayList<String>`。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-09-07T02:28:39.193

```
// iterate over the map
for(Entry<String, ArrayList<String>> entry : test1.entrySet()){
    // iterate over each entry
    for(String item : entry.getValue()){
        // print the map's key with each value in the ArrayList
        System.out.println(entry.getKey() + ": " + item);
    }
} 
```

# ruby - 如何转换 ruby gem->ruby app->从该应用程序的不同功能中创建 Web 服务

> ID：12310915
> 
> 赞同：1
> 
> 时间：2012-09-07T02:24:55.677
> 
> 标签：ruby, rubygems, fluentd

我对Ruby很陌生，所以如果我的问题听起来很傻，请原谅...

我想使用一个名为 Fluentd 的基于 Ruby 的日志框架——它可以作为 Ruby Gem 安装。

如何将其转换为常规 Ruby 应用程序，以便我可以通过 Cloud PaaS 部署它？此外，为该应用程序的功能创建 Web 服务端点的最简单/最快的方法是什么？基本上我想从一个java应用程序中使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T11:07:03.967

看看这些网址：

点击 [1] [http://guides.rubyonrails.org/debugging_rails_applications.html#the-logger](http://guides.rubyonrails.org/debugging_rails_applications.html#the-logger)

点击 [2] [https://github.com/wallyqs/fluent-logger-rails](https://github.com/wallyqs/fluent-logger-rails)

点击 [3] [http://nubyonrails.com/articles/a-hodel-3000-compliant-logger-for-the-rest-of-us](http://nubyonrails.com/articles/a-hodel-3000-compliant-logger-for-the-rest-of-us)

您可以使用 Ruby java 桥接软件，或者您可以想到 JRuby。JRuby 与 Java 紧密集成，允许将解释器嵌入到任何 Java 应用程序中，并在 Java 和 Ruby 代码之间进行完全双向访问。

就云 Paas 而言，请查看：http://www.engineyard.com/products/cloud

# sql - SQL - 使用金钱设置十进制值

> ID：12310919
> 
> 赞同：0
> 
> 时间：2012-09-07T02:26:04.727
> 
> 标签：sql

我正在尝试使用其中包含货币值的现有列，并使用它们在另一列中设置一个值，该值是小数。例如，如果我的货币价值为“8.65”，我正在尝试将与同一记录关联的十进制值/列设置为“8.6500000000”。就我而言，我需要 10 个小数点的精度。

这是我尝试的代码，它没有做任何事情（它没有给出错误，它只是没有更新任何记录）：

```
SET abc_PaidDecimal = CAST(abc_PaidAmnt AS DECIMAL(16,10))
WHERE abc_PaidDecimal <> CAST(abc_PaidAmnt AS DECIMAL(16,10)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T02:44:08.847

如果您的 abc_PaidDecimal 包含 NULL，您可以获得此行为。NULL 不能与任何其他值进行比较，它们唯一有效的比较是使用 IS NULL 或 IS NOT NULL。

所以，尝试添加`or abc_PaidDecimal IS NULL`到你的`WHERE`条款

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T02:34:59.457

8.65 和 8.6500000000000 是同一个数字。

1 和 00001 也是相同的数字。因此，在您的`where`子句中，`<>`将始终给出`false`. 这就是为什么你不更新任何东西

如果要使用此转换更新所有字段，请删除`Where`子句

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T02:54:59.977

您不需要显式将钱转换为十进制，它将被隐式转换并存储为十进制（16,10）

**但是，当**您不希望它们被平等对待时，要在 8.65 和 8.650000 之间进行比较，请将双方都转换为 varchar(26) 。

```
WHERE   CAST(abc_PaidDecimal AS VARCHAR(26)) <> CAST(abc_PaidAmnt AS VARCHAR(26)) 
```

一个例子

```
DECLARE @v1 MONEY = 23.25
        ,@v2 DECIMAL(18,6)= 23.250000

SELECT @v1 , @v2
IF  @v1 = @v2
SELECT 'same value before cast'
ELSE 
SELECT 'different value before cast'

SELECT CAST(@v1 AS VARCHAR(26)) , CAST(@v2 AS VARCHAR(26))
IF  CAST(@v1 AS VARCHAR(26)) = CAST(@v2 AS VARCHAR(26))
SELECT 'same value after cast'
ELSE 
SELECT 'different value after cast' 
```

# javascript - IE8更改文本区域上的事件侦听器不起作用

> ID：12310920
> 
> 赞同：2
> 
> 时间：2012-09-07T02:26:25.773
> 
> 标签：javascript, prototypejs

我有一个页面，我通过 AJAX 生成文本区域，如果这些文本区域发生更改，则触发事件。这适用于 IE9+ 和其他浏览器，如 Firefox、Chrome、Safari 等。问题是 IE8 及以下。他们不会触发更改事件。代码是：

文本区域看起来像：

```
<textarea name="answer8158" id="answer8158"></textarea> 
```

Javascript 看起来像：

```
document.observe('change', function(e, el) {
    if (el = e.findElement('textarea')) {
        //Do Something
    }
}); 
```

是否有使更改事件起作用的解决方法？我可以使用 PrototypeJS 或纯 JavaScript 解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T02:07:04.057

您应该详细说明如何使用 AJAX 响应，以下内容在带有 Prototype.js v 1.7.1 的 IE 6 中运行良好。我使用 DOM 和 innerHTML 来模拟您可能对 AJAX 响应所做的事情：

```
<script type="text/javascript" src="prototype.js"></script>
<script type="text/javascript">

document.observe('change', function(e, el) {
    if (el = e.findElement('textarea')) {
        alert(el.value);
    }
});

function addTextarea(el){
  var ta = document.createElement('textarea');
  ta.name = 'ta2';
  el.parentNode.insertBefore(ta, el.nextSibling);
}

function addTextarea2(){
  document.getElementById('s0').innerHTML = '<textarea></textarea>';
}
</script>

<textarea name="answer8158" id="answer8158"></textarea><br>
<button onclick="addTextarea(this);">Add using DOM</button><br>
<button onclick="addTextarea2();">Add using innerHTML</button><span id="s0"></span> 
```

如果您以编程方式更改值并期望触发更改事件，那是完全不同的。顺便说一句，我会将观察者写为：

```
document.observe('change', function(e) {
    var el = e.findElement('textarea');
    if (el) {
        alert(el.value);
    }
}); 
```

这只是几个额外的字符，而且更清晰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:14:34.150

解决方案是回到对 AJAX 中的 onchange 事件进行硬编码。不幸的是，文档观察（模糊/更改）不适用于 IE8 及以下版本。不是我喜欢编写代码的方式，而是我找到的唯一解决方案。

# c# - 只能获取邮件正文吗？

> ID：12310921
> 
> 赞同：0
> 
> 时间：2012-09-07T02:26:30.407
> 
> 标签：c#, .net, email

我使用免费的 .net 库阅读电子邮件并发布： 如果我想查看正文消息，所有免费的 .net 电子邮件库都下载正文消息和附件。如果附件的尺寸很大，我会等很长时间。示例：我使用 AE.NET.Mail 阅读最新的电子邮件：

```
 var dt = DateTime.Now;
        Console.WriteLine(dt.ToLongTimeString());
        // Connect to the IMAP server. The 'true' parameter specifies to use SSL
        // which is important (for Gmail at least)
        var ic = new ImapClient("imap.gmail.com", "yourEmail", "yourPassword",
                        ImapClient.AuthMethods.Login, 993, true);
        // Select a mailbox. Case-insensitive
        var mailCount = ic.GetMessageCount();
        ic.SelectMailbox("INBOX");
        var message = ic.GetMessage(mailCount - 1);
        var body = message.Body;
        Console.WriteLine(body);
        ic.Disconnect();
        ic.Dispose();
        Console.WriteLine(DateTime.Now.ToLongTimeString());
        Console.WriteLine((DateTime.Now - dt).TotalSeconds); 
```

结果：478,6s，附件大小为 23mb。如果我只想以最快的速度查看正文消息怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T05:36:21.537

我给你链接请关注它并尝试另一个开源邮件库它可以帮助你减少时间。[TRY THIS](http://briancaos.wordpress.com/2012/04/24/reading-mails-using-imap-and-mailsystem-net/)然后把代码如下图

```
 MailRepository rep = new MailRepository("imap.gmail.com", 993, true, @"username", "password");

    foreach (ActiveUp.Net.Mail.Message email in rep.GetUnreadMails("Inbox"))
    {

        System.Web.HttpContext.Current.Response.Write(string.Format("<p>{0}: {1}</p><p>{2}</p>", email.From, email.Subject, email.BodyHtml.Text));

    } 
```

# iphone - 使用 webview 播放 mp3 - 即使屏幕锁定也可以继续播放吗？

> ID：12310922
> 
> 赞同：0
> 
> 时间：2012-09-07T02:26:32.323
> 
> 标签：iphone, ios, uiwebview, ios5.1

我的应用程序的一部分只是启动链接到 mp3 文件的 webview - 它打开文件并播放音频。我想做的是即使用户锁定他们的 iPhone，也允许该音频继续播放。（作为旁注，有没有办法替换播放器中出现的默认 Quicktime 徽标？没什么大不了的，只是想我会问 =）

第三个问题——我也用 .m3u 链接文件做同样的事情（webview）来在一周内流式传输实时音频——在 iPhone 锁定时是否也可以继续播放？

谢谢！！

本

快速编辑：相同的 URL 在 IOS Safari 中效果很好（锁定和解锁不会影响音频。只是在我的应用程序的 webviews 中没有。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T03:14:51.770

不过，我确实找到了答案，以防有人来这里寻找。世界上最简单的事情 - 只需在标有“必需背景模式”的 plist 文件中添加一行，并在该设置项 0 的值下设置为“应用程序播放音频”。瞧！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T03:06:06.340

由于音频在 UIWebView 中，我不相信您能够在后台播放它。编辑：我错了，将“App Plays Audio”添加到 UIBackgroundModes 将使它工作，即使音频在 UIWebView 中也是如此。

您是否考虑过自己流式传输 .mp3 文件？应该很容易，你就可以设置后台流。为了让您开始，我会查看 Matt Gallagher 的 AudioStreamer 类，它可以轻松地让您从网上流式传输 .mp3 文件和其他音频文件：[https ://github.com/mattgallagher/AudioStreamer](https://github.com/mattgallagher/AudioStreamer)

# bash - 如何在 Bash shell 脚本中访问自动命名的变量

> ID：12310923
> 
> 赞同：2
> 
> 时间：2012-09-07T02:27:09.470
> 
> 标签：bash, function, variables, metadata

我有一些代码可以自动创建某个名称的变量并为其分配一些值。代码如下所示：

```
myVariableName="zappo"
eval "${myVariableName}=zappo_value" 
```

如何使用自动生成的变量名称访问该变量的值？所以，我正在寻找一些类似于以下的代码（但有效）：

```
eval "echo ${${myVariableName}}" 
```

（...可能用于 myVariableValue="$(eval "echo ${${myVariableName}}")"...）。

非常感谢您的帮助

如果您认为这种方法很疯狂并且想要提供更一般的建议，那么我正在研究的一般想法是在库中的函数中定义变量，其名称为 ${usage} 和 ${prerequisiteFunctions}。这些在函数中定义的变量将被一个询问函数访问，例如，该函数可以确保安装了先决条件等。所以这个询问函数中的一个循环是这样的：

```
for currentFunction in ${functionList}; do
    echo "function: ${currentFunction}"
    ${currentFunction} -interrogate # (This puts the function variables into memory.)
    currentInterrogationVariables="${interrogationVariables}" # The variable interrogationVariables contains a list of all function variables available for interrogation.
    for currentInterrogationVariable in ${currentInterrogationVariables}; do
        echo "content of ${currentInterrogationVariable}:"
        eval "echo ${${currentInterrogationVariable}}"
    done
done 
```

再次感谢您的任何想法！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T02:33:09.457

尝试：

```
echo ${!myVariableName} 
```

它将回显包含名称的变量`$myVariableName`

例如：

```
#!/bin/bash

VAR1="ONE"
VAR2="TWO"

VARx="VAR1"

echo ${VARx}   # prints "VAR1"
echo ${!VARx}  # prints "ONE" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T02:33:57.567

IIRC，bash 中的间接是 by `!`，所以试试`${!myVariableName}`

# ruby - 如何删除 Ox 中的元素？

> ID：12310924
> 
> 赞同：0
> 
> 时间：2012-09-07T02:27:24.183
> 
> 标签：ruby, xml, xml-parsing, gem, nokogiri

使用 Ox 解析 XML 时如何删除元素？

Ox 有一个 append 方法`- (Object) <<(node)`，但似乎没有`- (Element) remove`方法。Nokogiri 有一个`remove`功能，Ox 有一个等价物吗？

[http://www.ohler.com/ox/Ox/Element.html](http://www.ohler.com/ox/Ox/Element.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T08:07:06.077

考虑这个文件：

```
doc = Ox::Document.new(:version => '1.0')
top = Ox::Element.new('top')
top[:name] = 'sample'
doc << top 
```

现在你可以观察到：

```
doc.nodes.class => Array 
```

您的节点只是一个常规的 ruby​​ 数组。因此，您将所有 Enumerable 功能与 Ruby 的 Array 功能结合在一起。

要删除我们在上面创建的元素，您可以这样做：

```
doc.nodes.delete top 
```

或者如果您需要的话，可以使用基于索引的删除：

```
doc.nodes.delete_at 0 
```

希望这可以帮助

# vba - 使用 Outlook VBA 区分可见和不可见附件

> ID：12310925
> 
> 赞同：9
> 
> 时间：2012-09-07T02:27:27.457
> 
> 标签：vba, outlook, email-attachments

要求是将附件上传到服务器。但是，我们只想上传那些出现在 Outlook 的“消息”行（见下图）的内容，而不是电子邮件正文中的其他内容。

由于 Outlook 本身知道应该在该行中显示哪个附件，因此必须有它用来在内部区分它们的信息。

那么，我怎样才能在我的 VBA 程序中做到这一点呢？我尝试使用`MailItem.Attachments`，但所有附件都在那里，我找不到它们的任何属性可以用来区分。

**更新** 原始标题“使用 Outlook VBA 区分嵌入的附件”有点误导。所以我改了标题。

展望截图： ![展望截图](../Images/f4c271c70c5c633af857632c93f020ab.png)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-06T22:00:32.667

到目前为止，我可以测试，嵌入的附件总是有一个 MIME 内容 ID，无论它是否出现在邮件正文中。所以解决方法是检查它是否有内容ID。

这是一个计算可见附件的示例代码：

```
Sub ShowVisibleAttachmentCount()
    Const PR_ATTACH_CONTENT_ID As String = "http://schemas.microsoft.com/mapi/proptag/0x3712001F"
    Const PR_ATTACHMENT_HIDDEN As String = "http://schemas.microsoft.com/mapi/proptag/0x7FFE000B"

    Dim m As MailItem
    Dim a As Attachment
    Dim pa As PropertyAccessor
    Dim c As Integer
    Dim cid as String

    Dim body As String

    c = 0

    Set m = Application.ActiveInspector.CurrentItem
    body = m.HTMLBody

    For Each a In m.Attachments
        Set pa = a.PropertyAccessor
        cid = pa.GetProperty(PR_ATTACH_CONTENT_ID)

        If Len(cid) > 0 Then
            If InStr(body, cid) Then
            Else
                'In case that PR_ATTACHMENT_HIDDEN does not exists, 
                'an error will occur. We simply ignore this error and
                'treat it as false.
                On Error Resume Next
                If Not pa.GetProperty(PR_ATTACHMENT_HIDDEN) Then
                    c = c + 1
                End If
                On Error GoTo 0
            End If
        Else
            c = c + 1
        End If
    Next a
    MsgBox c
End Sub 
```

当我浏览所有 Outlook 电子邮件时，它会在一行中提供相同数量的附件。

**更新**

感谢 Dmitry Streblechenko 的信息，我使用 Java 电子邮件库生成的电子邮件测试了 Outlook。结果显示，当电子邮件附件包含 CID 但未出现在电子邮件正文中时，它将出现在附件行中。

**更新**

看起来仍有一些情况表明这还不够好。我生成了以下 MIME 电子邮件正文：

```
Message-ID: <1044564324.2.1360638429705.JavaMail.joe@xxxx>
Subject: Test
MIME-Version: 1.0
Content-Type: multipart/alternative; 
    boundary="----=_Part_0_1327112367.1360638429515"
Return-Path: xxxx@xxxx.xxx
X-OriginalArrivalTime: 12 Feb 2013 03:07:16.0096 (UTC) FILETIME=[0FC1B000:01CE08CE]

------=_Part_0_1327112367.1360638429515
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

TTT
------=_Part_0_1327112367.1360638429515
Content-Type: multipart/related; 
    boundary="----=_Part_1_1747887937.1360638429520"

------=_Part_1_1747887937.1360638429520
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<html><head><meta http-equiv=3D'content-type' content=3D'text/html; charset=
=3DUTF-8'></head><title>TTT</title><body><img src=3D"cid:test1.png" alt=3D'=
=E6=81=AD=E8=B4=BA=E6=96=B0=E7=A6=A7' /><p>txt</p></body></html>
------=_Part_1_1747887937.1360638429520
Content-Type: image/png
Content-Transfer-Encoding: base64
Content-ID: <test.png>

iVBORw0KGgoAAAANSUhEUgAAAIIAAAAmCAYAAAAIjkMFAAABHUlEQVR42u3Z0Q7CIAyFYd//pafx
ckFoS9ELvz8aE9mQrIfTFh8PAAAAAPgp1+t1vT9i32fm6FzP6JrKb3aulRAGARm9Z9dUAhWZY7Wm
7Hr+IvhdD+s+PhLCLNBZQZ12HI7QlBqyQohctxM8bvAFIcx2eEYIo/vuY5WAi3BzWlhZ+if7zs7T
UWtE10Asgd3bUSxWHvrMobJOtXITQkjk5Z3gdaWaqBBWouYIhdy+E+TsPNHU0CUEbjDJ49GxE0KI
nBNUheAcYbPVy9QNmRaxUvVHd7Idf0gU2QDOduVqnkinoEb4QY1Q3V2RNrMqpB0h6BqKh0gZIWT/
AzjVycwcjSMcPI3buSebZiptaLbIBQAAAAAAAAAAAAAAAP6OJyO5jJ4bZa/gAAAAAElFTkSuQmCC

------=_Part_1_1747887937.1360638429520--

------=_Part_0_1327112367.1360638429515-- 
```

请注意，我更改了正文中的引用图像内容 ID，而实际图像的内容 ID 错误（因此未引用）。但是，图像不在电子邮件的主要部分（它在替代部分的分支中）。这使得它在前景中不可见。

所以为了检测我们必须确保附件出现在主要的 MIME 部分中......寻找这样做的方法。

**更新**

进一步挖掘我到达[了这个链接](https://stackoverflow.com/questions/13987588/sending-outlook-email-with-embedded-image-using-vbs)，我又添加了一个测试 -`PR_ATTACHMENT_HIDDEN`属性。

另外值得一提的是，展望 2010 本身并不一致。我观察到，有时电子邮件列表会显示附件图标以指示附件的存在，但在检查器中打开它时没有出现任何内容。

参考：

[使用 VBS 发送带有嵌入图像的 Outlook 电子邮件](https://stackoverflow.com/questions/13987588/sending-outlook-email-with-embedded-image-using-vbs)

[MSDN - 附件属性](http://msdn.microsoft.com/en-us/library/bb446117.aspx)

[论坛 - 识别内联附件](http://www.office-outlook.com/outlook-forum/index.php/m/448695/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T22:19:54.730

某些附件始终具有 MIME 内容 ID ( `PR_ATTACH_CONTENT_ID`)，特别是来自 Lotus Notes 的邮件始终具有该标题。
真正的测试是检查`HTMLBody`属性并查看 img 标签是否实际引用了任何附件。[Redemption](http://www.dimastr.com/redemption/)允许您使用[RDOAttachment.Hidden](http://www.dimastr.com/redemption/RDOAttachment.htm)属性来区分附件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-05-04T13:38:18.447

根据@Earth Engine 的回答，这里是一个函数，它在将mailitem (item.class = olMail) 作为参数传递时返回附件的实际数量：

```
Function CountVisibleAttachment(ByVal m As MailItem) As Integer
    Const PR_ATTACH_CONTENT_ID As String = "http://schemas.microsoft.com/mapi/proptag/0x3712001F"
    Const PR_ATTACHMENT_HIDDEN As String = "http://schemas.microsoft.com/mapi/proptag/0x7FFE000B"

    Dim a As Attachment
    Dim pa As propertyAccessor
    Dim c As Integer
    Dim cid As String

    Dim body As String

    c = 0

    body = m.HTMLBody

    For Each a In m.Attachments
        Set pa = a.propertyAccessor
        cid = pa.GetProperty(PR_ATTACH_CONTENT_ID)

        If Len(cid) > 0 Then
            If InStr(body, cid) Then
            emb = emb + 1
            Else
                'In case that PR_ATTACHMENT_HIDDEN does not exists,
                'an error will occur. We simply ignore this error and
                'treat it as false.
                On Error Resume Next
                If Not pa.GetProperty(PR_ATTACHMENT_HIDDEN) Then
                    c = c + 1
                End If
                On Error GoTo 0
            End If
        Else
            c = c + 1
        End If
    Next a
    CountVisibleAttachment = c
End Function 
```

# asp.net-mvc-3 - ASP.net MVC DropLownList db.SaveChanges 不保存选择

> ID：12310929
> 
> 赞同：2
> 
> 时间：2012-09-07T02:28:06.393
> 
> 标签：asp.net-mvc-3, entity-framework, razor

我浏览了大量关于如何在 MVC 中使用 DropDownList 的教程和建议。我能够让它大部分工作，但所选项目没有保存到数据库中。我正在使用 MVC 3 和 Razor 作为视图。

我的 DropDownList 正在使用正确的值和好看的 HTML 创建。当我设置断点时，我可以看到模型中正确的选定项 ID 被发送到控制器。当视图返回索引时，DropDownList 值未设置。其他值保存得很好。

以下是相关观点。DropDownList 将 ColorModel 名称列表显示为文本，ID 为值。

```
public class ItemModel
{
    [Key]
    public int ItemID { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public virtual ColorModel Color { get; set; }
}
public class ItemEditViewModel
{
    public int ItemID { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public int ColorID { get; set; }
    public IEnumerable<SelectListItem> Colors { get; set; }
}
public class ColorModel
{
    [Key]
    public int ColorID { get; set; }
    public string Name { get; set; }
    public virtual IList<ItemModel> Items { get; set; }
} 
```

以下是控制器操作。

```
 public ActionResult Edit(int id)
    {
        ItemModel itemmodel = db.Items.Find(id);
        ItemEditViewModel itemEditModel;
        itemEditModel = new ItemEditViewModel();
        itemEditModel.ItemID = itemmodel.ItemID;
        if (itemmodel.Color != null) {
            itemEditModel.ColorID = itemmodel.Color.ColorID;
        }
        itemEditModel.Description = itemmodel.Description;
        itemEditModel.Name = itemmodel.Name;
        itemEditModel.Colors = db.Colors
            .ToList()
            .Select(x => new SelectListItem
                {
                    Text = x.Name,
                    Value = x.ColorID.ToString()
                });
        return View(itemEditModel);
    }

    [HttpPost]
    public ActionResult Edit(ItemEditViewModel itemEditModel)
    {
        if (ModelState.IsValid)
        {
            ItemModel itemmodel;
            itemmodel = new ItemModel();
            itemmodel.ItemID = itemEditModel.ItemID;
            itemmodel.Color = db.Colors.Find(itemEditModel.ColorID);
            itemmodel.Description = itemEditModel.Description;
            itemmodel.Name = itemEditModel.Name;
            db.Entry(itemmodel).State = EntityState.Modified;
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        return View(itemEditModel);
    } 
```

这个视图有这个用于 DropDownList，其他的只是 EditorFor()。

```
@Html.DropDownListFor(model => model.ColorID, Model.Colors, "Select a Color") 
```

当我`db.Color.Find(...)`在线上设置断点时，我在 itemmodel.Color 的 Locals 窗口中显示：

> {System.Data.Entity.DynamicProxies.ColorModel_0EB80C07207CA5D88E1A745B3B1293D3142FE2E644A1A5202B90E5D2DAF7C2BB}

当我展开那条线时，我可以看到我从下拉框中选择的 ColorID，但它没有保存到数据库中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T03:22:49.853

您不需要设置整个`Color`对象。只需设置`ColorId`属性。

改变

```
itemmodel.Color = db.Colors.Find(itemEditModel.ColorID); 
```

至

```
itemmodel.ColorId = itemEditModel.ColorID; 
```

**编辑**

请注意，您的数据库不会存储整个对象。中的`Color`对象`ItemModel`只是访问`ColorModel`由外键关联的实体的便捷方式。

按照惯例，外键属性的名称应该是`ColorId`. 在您的课程中添加此`int`属性`ItemModel`。

# c++ - 为什么该模板函数不编译？

> ID：12310933
> 
> 赞同：1
> 
> 时间：2012-09-07T02:28:27.817
> 
> 标签：c++, templates, gcc, linker, template-function

这是一个非常短的片段，它不能用 g++ 4.7.1 编译（顺便说一下，它也不能用 gcc 4.6.3 编译）。

```
#include <iostream>

template<typename T>
struct Foo
{
    template<typename U>
    friend std::ostream& operator<<(Foo&, U&);
};

template<typename T, typename U>
std::ostream& operator<<(Foo<T> foo, U& u)
{
    std::cout << u;
    return std::cout;
}

int main()
{
    Foo<int> f;
    f << "bar";
    return 0;
} 
```

这就是 gcc 4.7.1 的输出（4.6.3 说的几乎相同）。

> /tmp/ccNWJW6X.o: 在函数`main': main.cpp:(.text+0x15): undefined reference to`std::basic_ostream >& operator<< (Foo&, char const (&) [4])' collect2: ld 返回 1 退出状态

任何人都可以解释为什么？

**编辑**

我也尝试过 clang 3.1，它说的完全一样。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T02:44:22.503

与模板的友谊可能有点复杂......让我们看看你的代码做了什么：

```
template<typename T>
struct Foo {
    template<typename U>
    friend std::ostream& operator<<(Foo&, U&);  // [1]
};
template<typename T, typename U>
std::ostream& operator<<(Foo<T> foo, U& u) {    // [2]
    std::cout << u;
    return std::cout;
} 
```

当您`Foo`使用类型实例化时，例如`int`[1] 中的朋友声明声明了一个模板函数：

```
template <typename U>
std::ostream& operator<<(Foo<int>&,U&); 
```

但是该函数在任何地方都不存在，您在 [2] 中提供的是一个带有两个参数的模板：

```
template<typename T, typename U>
std::ostream& operator<<(Foo<T> foo, U& u); 
```

关键是在模板实例化的同时处理友元声明，此时`Foo`代表当前实例化得到的类型。

您想要做的事情有不同的选择，最简单的是将朋友声明更改为：

```
template<typename W, typename U>
friend std::ostream& operator<<(Foo<W> foo, U& u); 
```

它声明了一个带有两个参数的模板（两者`W`都`U`在这里未绑定），并在命名空间级别匹配您的定义。

另一种选择是在类模板定义中定义朋友函数，在这种情况下，您可以保留原始签名。有关不同替代方案的更多信息，请查看其他[答案](https://stackoverflow.com/a/4661372/36565)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T02:36:55.587

您实际上并没有为 Foo 编写输出运算符<<

请注意，这两个函数的签名非常不同

# ruby-on-rails - message.body.decoded 电子邮件显示一团糟

> ID：12310940
> 
> 赞同：2
> 
> 时间：2012-09-07T02:29:23.727
> 
> 标签：ruby-on-rails, ruby, email, html-email, mail-gem

我正在将电子邮件接收到我的 rails 应用程序中，但将电子邮件正文设置为将电子邮件`message.body.decoded`显示为一团糟。下面是一个例子。有没有更好的方法来显示电子邮件正文？或者，有没有一种方法可以将电子邮件转发到另一个电子邮件地址，而无需对其进行解码和重新编码？

message.body.decoded 示例：

```
--Apple-Mail=_C8C99366-9FF9-4DD0-AA35-6469D60C3701 Content-Transfer-Encoding: quoted-printable Content-Type: text/plain; charset=windows-1252 Begin forwarded message: > From: "Herringbone" <style@herringbone.com>=20 > Subject: Don't miss out on our Multi Buy Shirt Offer - ends Sunday! > Date: 6 September, 2012 7:08:15 PM PDT > To: "Nick" <nickkarrasch@gmail.com> > Reply-To: style@herringbone.com >=20 > =09 >=20 > Having trouble viewing this email? Click here to see the web version. >=20 >=20 > =09 >=20 >=20 >=20 > =09 > Dear Nick >=20 > Don't miss out on our famous Multi Buy Shirt Offer - ends this Sunday. >=20 > Shop now for new styles available instore and online! > =20 >=20 >=20 >=20 >=20 >=20 >=20 > Facebook=20 > www.facebook.com/HerringboneSydney    = Herringbone=92s official blog=20 > http://herringbonetheweave.tumblr.com/=09 >=20 >=20 >=20 > This email was sent to Nick > To ensure that our messages get to you (and don't go to your junk or = bulk email folders), > please add style@herringbone.com to your address book. >=20 > Enquiries? Contact us directly! +61 2 9362 9901 > Visit us instore! Click here for Herringbone locations > Don't want to hear from us anymore? Click here to Unsubscribe >=20 >=20 >=20 >=20 >=20 > =20 >=20 --Apple-Mail=_C8C99366-9FF9-4DD0-AA35-6469D60C3701 Content-Transfer-Encoding: quoted-printable Content-Type: text/html; charset=windows-1252 <html><head><meta http-equiv=3D"Content-Type" content=3D"text/html = charset=3Dwindows-1252"><base href=3D"x-msg://890/"></head><body = style=3D"word-wrap: break-word; -webkit-nbsp-mode: space; = -webkit-line-break: after-white-space; "><br><div><br><div>Begin = forwarded message:</div><br = class=3D"Apple-interchange-newline"><blockquote type=3D"cite"><div = style=3D"margin-top: 0px; margin-right: 0px; margin-bottom: 0px; = margin-left: 0px;"><span style=3D"font-family:'Helvetica'; = font-size:medium; color:rgba(0, 0, 0, 1.0);"><b>From: </b></span><span = style=3D"font-family:'Helvetica'; font-size:medium;">"Herringbone" = &lt;<a href=3D"mailto:style@herringbone.com">style@herringbone.com</a>&gt;= <br></span></div><div style=3D"margin-top: 0px; margin-right: 0px; = margin-bottom: 0px; margin-left: 0px;"><span = style=3D"font-family:'Helvetica'; font-size:medium; color:rgba(0, 0, 0, = 1.0);"><b>Subject: </b></span><span style=3D"font-family:'Helvetica'; = font-size:medium;"><b>Don't miss out on our Multi Buy Shirt Offer - ends = Sunday!</b><br></span></div><div style=3D"margin-top: 0px; margin-right: = 0px; margin-bottom: 0px; margin-left: 0px;"><span = style=3D"font-family:'Helvetica'; font-size:medium; color:rgba(0, 0, 0, = 1.0);"><b>Date: </b></span><span style=3D"font-family:'Helvetica'; = font-size:medium;">6 September, 2012 7:08:15 PM PDT<br></span></div><div = style=3D"margin-top: 0px; margin-right: 0px; margin-bottom: 0px; = margin-left: 0px;"><span style=3D"font-family:'Helvetica'; = font-size:medium; color:rgba(0, 0, 0, 1.0);"><b>To: </b></span><span = style=3D"font-family:'Helvetica'; font-size:medium;">"Nick" &lt;<a = href=3D"mailto:nickkarrasch@gmail.com">nickkarrasch@gmail.com</a>&gt;<br><= /span></div><div style=3D"margin-top: 0px; margin-right: 0px; = margin-bottom: 0px; margin-left: 0px;"><span = style=3D"font-family:'Helvetica'; font-size:medium; color:rgba(0, 0, 0, = 1.0);"><b>Reply-To: </b></span><span style=3D"font-family:'Helvetica'; = font-size:medium;"><a = href=3D"mailto:style@herringbone.com">style@herringbone.com</a><br></span>= </div><br><div leftmargin=3D"0" marginwidth=3D"0" topmargin=3D"0" = marginheight=3D"0" bgcolor=3D"#f7f7f7" style=3D"font-family: Helvetica; = font-size: medium; font-style: normal; font-variant: normal; = font-weight: normal; letter-spacing: normal; line-height: normal; = orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: = none; white-space: normal; widows: 2; word-spacing: 0px; = -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; "><table = width=3D"100%" cellspacing=3D"0" cellpadding=3D"0" = bgcolor=3D"#f7f7f7"><tbody><tr><td width=3D"50%">&nbsp;</td><td><table = cellpadding=3D"0" cellspacing=3D"0" width=3D"600"><tbody><tr><td = colspan=3D"3" style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"20" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr><tr><td colspan=3D"3" align=3D"center" = style=3D"text-align: center; "><font face=3D"Arial, Helvetica, = sans-serif" size=3D"1" color=3D"#666666" style=3D"font-size: 10px; = line-height: 12px; ">Having trouble viewing this email?<span = class=3D"Apple-converted-space">&nbsp;</span><a = href=3D"http://herringbone.cmail1.com/t/j-e-ghuidl-vudjkiuk-r/">Click = here to see the web version.</a></font></td></tr><tr><td colspan=3D"3" = style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"16" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr><tr><td colspan=3D"3" = bgcolor=3D"#e7e7e7" style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"1" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr><tr><td width=3D"1" bgcolor=3D"#e7e7e7" = style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"1" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td><td><table cellpadding=3D"0" = cellspacing=3D"0" width=3D"598" bgcolor=3D"#ffffff"><tbody><tr><td = colspan=3D"3" style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"53" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr><tr><td colspan=3D"3" valign=3D"top" = align=3D"center" style=3D"text-align: center; font-size: 0px; = line-height: 0; "><a href=3D"#" style=3D"text-decoration: none; "><img = src=3D"http://i3.cmail1.com/ti/j/1B/C6A/366/132258/logo.gif" width=3D"242"= height=3D"47" border=3D"0" alt=3D"Herringbone = Sidney"></a></td></tr><tr><td colspan=3D"3" style=3D"font-size: 0px; = line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"47" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr><tr><td width=3D"9" style=3D"font-size: = 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"1" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td><td><table width=3D"580" cellpadding=3D"0" = cellspacing=3D"0"><tbody><tr><td><table cellpadding=3D"0" = cellspacing=3D"0" width=3D"422" align=3D"center"><tbody><tr><td = style=3D"text-align: center; "><font face=3D"'Times New Roman', Times, = serif" size=3D"1" color=3D"#00274c" style=3D"font-size: 13px; = line-height: 15px; ">Dear Nick</font></td></tr><tr><td style=3D"font-size:= 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"19" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr><tr><td><font face=3D"Times New Roman, = Times New Roman, Times, seriff" size=3D"1" color=3D"#00274c" = style=3D"font-size: 13px; line-height: 16px; ">Don't miss out on our = famous<span class=3D"Apple-converted-space">&nbsp;</span><a = href=3D"http://herringbone.cmail1.com/t/j-l-ghuidl-vudjkiuk-j/">Multi = Buy Shirt Offer</a><span class=3D"Apple-converted-space">&nbsp;</span>- = ends this Sunday.<br><br><a = href=3D"http://herringbone.cmail1.com/t/j-l-ghuidl-vudjkiuk-t/">Shop = now</a><span class=3D"Apple-converted-space">&nbsp;</span>for new styles = available&nbsp;<a = href=3D"http://herringbone.cmail1.com/t/j-l-ghuidl-vudjkiuk-h/">instore</a= ><span class=3D"Apple-converted-space">&nbsp;</span>and<span = class=3D"Apple-converted-space">&nbsp;</span><a = href=3D"http://herringbone.cmail1.com/t/j-l-ghuidl-vudjkiuk-k/">online</a>= !<br>&nbsp;</font><img = src=3D"http://i10.cmail1.com/ti/j/1B/C6A/366/132258/text-herringbone.gif" = width=3D"186" vspace=3D"0" hspace=3D"0" align=3D"right" border=3D"0" = alt=3D"image description" label=3D"Herringbone"></td></tr><tr><td = style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"23" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr></tbody></table><table cellpadding=3D"0"= cellspacing=3D"0" bgcolor=3D"#002a4d" width=3D"580" = align=3D"center"><tbody><tr><td style=3D"font-size: 0px; line-height: 0; = "><img src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" = width=3D"1" height=3D"10" hspace=3D"0" vspace=3D"0" border=3D"0" = align=3D"left" alt=3D"img description"></td></tr><tr><td = style=3D"font-size: 0px; line-height: 0; "><a = href=3D"http://herringbone.cmail1.com/t/j-l-ghuidl-vudjkiuk-u/" = style=3D"text-decoration: none; "><img = src=3D"http://i1.cmail1.com/ei/j/FA/9FD/E2A/csimport/MainImage.120359.jpg"= width=3D"580" vspace=3D"0" hspace=3D"0" border=3D"0" align=3D"left" = alt=3D"Multi-Buy Shirt Offer" label=3D"Call to Action" = height=3D"724"></a></td></tr><tr><td style=3D"font-size: 0px; = line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"10" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr></tbody></table><table cellpadding=3D"0"= cellspacing=3D"0" width=3D"580"><tbody><tr><td bgcolor=3D"#00273e" = style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"1" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr><tr><td style=3D"font-size: 0px; = line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"19" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr><tr><td><table cellpadding=3D"0" = cellspacing=3D"0" width=3D"580"><tbody><tr><td width=3D"24" = style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"1" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td><td width=3D"35" valign=3D"middle" = style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i7.cmail1.com/ti/j/1B/C6A/366/132258/img-fb.gif" = width=3D"26" height=3D"26" vspace=3D"0" hspace=3D"0" border=3D"0" = align=3D"left" alt=3D"img description"></td><td width=3D"1" = style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i8.cmail1.com/ti/j/1B/C6A/366/132258/sep-1.gif" width=3D"1" = height=3D"39" vspace=3D"0" hspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td><td width=3D"10" style=3D"font-size: 0px; = line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"1" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td><td width=3D"220" valign=3D"middle" = style=3D"line-height: 14px; "><font face=3D"Arial, Helvetica, = sans-serif" size=3D"1" color=3D"#00273e" style=3D"line-height: 14px; = ">Facebook<span class=3D"Apple-converted-space">&nbsp;</span><br><a = href=3D"http://herringbone.cmail1.com/t/j-l-ghuidl-vudjkiuk-o/" = style=3D"text-decoration: none; color: rgb(0, 39, 62); "><font = color=3D"#00273e">www.facebook.com/HerringboneSydney</font></a></font></td= ><td width=3D"10" style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"1" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td><td width=3D"71 valign=3D" middle""=3D"" = style=3D"font-size: 0px; line-height: 0; "><a href=3D"#" = style=3D"text-decoration: none; "><img = src=3D"http://i9.cmail1.com/ti/j/1B/C6A/366/132258/partner-logo-1.gif" = width=3D"61" height=3D"39" vspace=3D"0" hspace=3D"0" border=3D"0" = align=3D"left" alt=3D"The weave"></a></td><td width=3D"1" = style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i8.cmail1.com/ti/j/1B/C6A/366/132258/sep-1.gif" width=3D"1" = height=3D"39" vspace=3D"0" hspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td><td width=3D"9" style=3D"font-size: 0px; = line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"1" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td><td width=3D"189" valign=3D"middle" = style=3D"line-height: 14px; "><font face=3D"Arial, Helvetica, = sans-serif" size=3D"1" color=3D"#00273e" style=3D"line-height: 14px; = ">Herringbone=92s official blog<span = class=3D"Apple-converted-space">&nbsp;</span><br><a = href=3D"http://herringbone.cmail1.com/t/j-l-ghuidl-vudjkiuk-b/" = style=3D"text-decoration: none; color: rgb(0, 39, 62); "><font = color=3D"#00273e">http://herringbonetheweave.tumblr.com/</font></a></font>= </td><td width=3D"10" style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"1" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr></tbody></table></td></tr><tr><td = style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"18" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr><tr><td bgcolor=3D"#00273e" = style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"1" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr></tbody></table><table cellpadding=3D"0"= cellspacing=3D"0" width=3D"580"><tbody><tr><td style=3D"font-size: 0px; = line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"19" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr><tr><td align=3D"center"><font = face=3D"Arial, Helvetica, sans-serif" size=3D"1" color=3D"#00274c" = style=3D"font-size: 10px; line-height: 14px; ">This email was sent to = Nick<br>To ensure that our messages get to you (and don't go to your = junk or bulk email folders),<br>please add<span = class=3D"Apple-converted-space">&nbsp;</span><a = href=3D"mailto:style@herringbone.com">style@herringbone.com</a><span = class=3D"Apple-converted-space">&nbsp;</span>to your address = book.<br><br>Enquiries? Contact us directly! +61 2 9362 9901<br>Visit us = instore!<span class=3D"Apple-converted-space">&nbsp;</span><a href=3D"#" = style=3D"text-decoration: none; color: rgb(0, 39, 76); "><font = color=3D"#00274c">Click here</font></a><span = class=3D"Apple-converted-space">&nbsp;</span>for Herringbone = locations<br>Don't want to hear from us anymore?<span = class=3D"Apple-converted-space">&nbsp;</span><a = href=3D"http://herringbone.cmail1.com/t/j-u-ghuidl-vudjkiuk-y/">Click = here to Unsubscribe</a></font></td></tr><tr><td style=3D"font-size: 0px; = line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"24" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img = description"></td></tr></tbody></table></td></tr></tbody></table></td><td = width=3D"9" style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"1" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr></tbody></table></td><td width=3D"1" = bgcolor=3D"#e7e7e7" style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"1" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr><tr><td colspan=3D"3" = bgcolor=3D"#e7e7e7" style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"1" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr><tr><td colspan=3D"3" = style=3D"font-size: 0px; line-height: 0; "><img = src=3D"http://i2.cmail1.com/ti/j/1B/C6A/366/132258/none.gif" width=3D"1" = height=3D"40" hspace=3D"0" vspace=3D"0" border=3D"0" align=3D"left" = alt=3D"img description"></td></tr></tbody></table></td><td = width=3D"50%">&nbsp;</td></tr></tbody></table><img = src=3D"https://cmail1.com/t/j-o-ghuidl-vudjkiuk/o.gif" width=3D"1" = height=3D"1" border=3D"0" style=3D"height: 1px !important; width: 1px = !important; border-width: 0px !important; margin: 0px !important; = padding: 0px !important; "></div></blockquote></div><br></body></html>= --Apple-Mail=_C8C99366-9FF9-4DD0-AA35-6469D60C3701-- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:44:16.767

请参阅邮件 gem 文档中的[阅读多部分电子邮件部分。](https://github.com/mikel/mail#reading-a-multipart-email)

例如，如果您想对电子邮件的 HTML 部分进行处理，则必须找到内容类型为“text/html”的部分，然后在其上调用**decode_body**。

```
mail = Mail.read('example_multipart_mail.eml')
mail.parts.each do |part|
  next unless part.content_type =~ /^text\/html/
  puts part.decode_body
end 
```

# objective-c - 改变可可窗口的大小？

> ID：12310943
> 
> 赞同：1
> 
> 时间：2012-09-07T02:29:52.057
> 
> 标签：objective-c, macos, cocoa, user-interface

我有一个窗口，当用户点击它时我需要改变它的大小。我`[self setFrame:windowFrame display:YES animate:YES]`用来完成这个。

即使窗口成功地改变了大小（我增加了它的高度），它也会随着它向上移动窗口的内容。我该如何防止这种情况发生？我希望内容保持不变。

我在 OSX Mountain Lion 上使用 Objective-C 和 Cocoa 为 OSX 开发应用程序。

编辑：约束和/或弹簧和支柱将不起作用，因为我需要在调整窗口大小后移动内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T03:02:44.673

如果您使用Interface Builder 来构建这些视图，那么我相信一种方法是设置“支柱和弹簧”。这些在“尺寸检查器”下可用，并且是“自动调整大小”标签上方的红色箭头和条形图。玩弄这些以获得您想要的效果，但总体思路是箭头控制视图大小如何调整以适应父视图大小的变化，而条形图控制视图边缘的关系随着大小的变化，到父视图的边缘。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T15:28:41.993

> 约束和/或弹簧和支柱将不起作用，因为我需要在调整窗口大小后移动内容。

在这种情况下，您应该使用[NSViewAnimation](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSViewAnimation_Class/)。

单个视图动画实际上可以对多个视图执行多个动画，您甚至可以对一个窗口执行一个动画，尽管类的名称和窗口不是 Cocoa 中的视图这一事实。

您使用 来创建一个视图动画[`initWithViewAnimations:`，它需要一个字典数组](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSViewAnimation_Class/Reference/Reference.html#//apple_ref/occ/instm/NSViewAnimation/initWithViewAnimations%3a)。每个字典都标识了目标 ( `NSViewAnimationTargetKey`) 以及对它执行的操作：更改目标的框架 ( `NSViewAnimationStartFrameKey`and `NSViewAnimationEndFrameKey`) 或淡入或淡出目标 ( `NSViewAnimationEffectKey`)。对于您的情况，您将更改目标的框架。

当用户执行导致调整窗口大小的操作时，您需要计算所需的窗口整体大小（注意调整其框架的位置，使其不会超出屏幕），以及您的视图的新框架（包括位置和大小）。所有将移动和/或改变大小的东西，为其创建一个字典并将其放入数组中。然后创建视图动画。

NSViewAnimation 是一种[NSAnimation](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSAnimation_Class)，它提供了所有的方法来启动和停止动画，监控它的进度，连接到它，以及将多个 NSAnimation 链接在一起。如果不出意外，您将需要[启动动画](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSAnimation_Class/Reference/Reference.html#//apple_ref/occ/instm/NSAnimation/startAnimation)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T17:42:10.410

在基于约束的布局中，将窗口边缘周围的视图设置为其父视图边缘的固定距离。

Xcode 会从中推断出很多可调整性；如果仍然无法正确调整大小，请调整其约束，使其宽度和/或高度不再恒定。

最简单的方法是移动视图，直到蓝线出现在编辑器中。每条蓝线对应于 HIG 中关于事物应该如何布置的规则，如果您将视图放在那里，Xcode 将创建与这些准则匹配的约束。例如，如果您将视图设置为距其父视图的右边缘 20 点，您将得到一条蓝线，如果您将视图放在那里，您将创建一个约束，即视图必须保持该距离那个边缘。

超级视图不是您可以创建基于 HIG 的约束的唯一视图。您还可以在同级视图之间创建准则约束。例如，如果您将一个按钮放在另一个按钮旁边的适当距离处，您将在该距离上看到一条蓝线，如果您放下它，您将创建一个约束，即这两个按钮必须与每个按钮保持该距离其他。

如果你想做一些真正自定义的事情，nib 编辑器右下角的三个按钮可以让你创建任何你想要的约束。您选择的内容决定了您可以创建哪些约束；笔尖编辑器的大纲视图将帮助您确保您拥有所需的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T00:12:40.117

您将不得不遍历所有子视图并根据窗口框架的增量更改它们的框架位置。

因此，如果您将窗口框架向各个方向扩展 20，则所有子视图都必须将其框架位置增加 (20,20) 以抵消窗口移动。

# php - 如何使用 PHP 保护存储在 XML 文件中的密码？

> ID：12310947
> 
> 赞同：-5
> 
> 时间：2012-09-07T02:30:18.250
> 
> 标签：php, mysql, xml, encryption, social-networking

我正在使用 PHP 和 XML 开发社交网络，但我不知道如何保护包含密码和内容的 xml 文件。我听说过有关哈希和盐的东西，但我对此一无所知。或者，我应该放弃使用 xml 而只使用 MySql 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T02:35:44.540

我个人会避免将密码存储在 XML 文件中，但是如果出于某种原因您不能更好地保护公共用户的安全，我会将它们存储在 Web 根目录之外，这样您就无法直接访问它们。您的脚本至少应该能够访问主目录。

我还会确保您的密码是使用某种加密方式存储的，这样如果有人确实访问了该文件，他们就不能只读取密码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T03:22:09.610

如果您正在谈论存储用户的凭据以访问您的站点，那么您将需要使用[bcrypt](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)积极地散列这些密码，以确保在发生违规时它们不会被轻易破解。

如果您正在谈论存储用于访问第三方服务的密码，并且您需要能够使用这些密码，那么您将需要使用可逆的方法（如 Blowfish）和某种私钥对它们进行加密。

在任何情况下都不应将密码存储在 XML 文件中。这些很容易获得，甚至可能通过您的网络服务器无意中暴露出来，并且任何人都可以通过访问特定的 URL 进行下载。

MySQL 是一个非常容易上手的数据库，所以它是一个不错的选择，而且如果你需要这样做，它的扩展性也很好。我会考虑`mysqli`为新应用程序使用或 PDO，并且有很多示例说明如何正确使用 SQL 与[placeholders](http://bobby-tables.com/php)。

如果您正在构建一个完整的应用程序，您可能希望使用像[CakePHP](http://cakephp.org/)或[CodeIgnighter](http://codeignighter.com/)这样的框架来为您提供构建基础。这些提供了许多低级应用程序支持，您需要构建您正在谈论的内容，从而在开发过程中为您节省大量时间。

# clojurescript - 您如何从 clojurescript 引用 javascript 的 this 关键字？

> ID：12310950
> 
> 赞同：10
> 
> 时间：2012-09-07T02:31:05.590
> 
> 标签：clojurescript

我正在将一些 ClojureScript 代码与带有回调函数的 JS 库调用集成。JS 库使用 JavsScript 的“this”关键字将数据传递给回调。

我可以使用 (js* "this") 让它工作。例如：

```
(libraryCall (fn [] (.log console (js* "this")))) 
```

有没有办法从 ClojureScript 中获取“this”上下文而不求助于 js*？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-07T15:54:54.900

使用内置`this-as`宏。它接受一个名称和一个主体，并评估名称绑定到 JavaScript 的主体`this`。

例如

```
(libraryCall (fn [] (this-as my-this (.log js/console my-this)))) 
```

好问题...必须深入研究编译器代码才能找到它，它根本没有很好的宣传。

我会把它加到书里。

# android - 钛 - 密度特定资源的 android 选项卡图标不起作用

> ID：12310951
> 
> 赞同：4
> 
> 时间：2012-09-07T02:31:24.243
> 
> 标签：android, titanium

所以遵循这里的概念：

[http://docs.appcelerator.com/titanium/2.1/index.html#!/guide/Using_density-specific_resources_on_Android](http://docs.appcelerator.com/titanium/2.1/index.html#!/guide/Using_density-specific_resources_on_Android)

我创建了一个文件夹

```
Resources/android/images/ 
```

然后就是：

```
high/
medium/
low/ 
```

并且在每个文件中*都有*不同密度的文件（比如about.png）

问题是当我引用它们时：

```
var aboutTab = Ti.UI.createTab({
    icon: '/images/about.png',
    title: 'about',
    window: about
}); 
```

或者正如其他人所建议的那样（即，丢失“图像”上的前导斜线）：

```
var aboutTab = Ti.UI.createTab({
    icon: 'images/about.png',
    title: 'about',
    window: about
}); 
```

然后加载应用程序，确保标签本身在那里......但图标不存在。请注意，如果我有一个普通的旧文件存在于：

```
Resources/images/about.png 
```

*然后*图标会出现......但不会出现。有没有……我在这方面遗漏了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T09:39:15.637

![在此处输入图像描述](../Images/870b044c6dcb3fa6b5a01412d00c6b46.png)请冷静地阅读并理解这是与我一起工作的“更多控制”段落。

```
var aboutTab = Ti.UI.createTab({
    icon: 'images/about.png',     // "/" remove this and try again
    title: 'about',
    window: about
}); 
```

请从您的设备或模拟器中删除您的旧应用程序。在此清洁然后构建之后，我认为这是正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T02:41:45.413

好的，所以标准答案从未对我有用。我在这里使用的是 Titanium 2.1。{在此处插入对 Ti 开发人员传统的侮辱}

解决方案很简单——不要使用这里讨论的大肆吹嘘的“智能钛密度特定解决方案”：

[http://docs.appcelerator.com/titanium/2.1/index.html#!/guide/Using_density-specific_resources_on_Android](http://docs.appcelerator.com/titanium/2.1/index.html#!/guide/Using_density-specific_resources_on_Android)

相反，使用这个简单、朴素的代码来解决您的问题！

```
var density =  (Titanium.Platform.displayCaps.dpi <= 160) ? 'low' : (Titanium.Platform.displayCaps.dpi > 160 && Titanium.Platform.displayCaps.dpi < 240) ? 'medium' : 'high'; 
var preamble = (Ti.Platform.osname === 'iphone' || (Ti.Platform.osname === 'ipad') )? 'images':'android/images/'+density + '/'; 
```

好的，所以第一位设置密度 -*注意*我现在还不知道 Ti 的正确密度读数，我只是把它放好，直到我把它们算出来 - 如果应用程序是安卓，第二位使用它一。

然后，我曾经拥有的地方：

```
var aboutTab = Ti.UI.createTab({
    icon: 'images/about.png',
    title: 'about',
    window: about
}); 
```

我现在有：

```
var aboutTab = Ti.UI.createTab({
    icon: preamble + '/about.png',
    title: 'about',
    window: about
}); 
```

就是这样！

最后一句话：我注意到，根据使用的 Titanium 版本（2.1.3 与 2.1.0）或使用的 android sdk，这可能会表现得*非常*不同。我在 2.1.0 和 4.2 android 中获得了最好的结果，这包括使用“图像”前缀（你知道，指南是如何做到的）。

我注意到的一件事是我不能同时拥有高/中/低文件夹和 hdpi 文件夹，我需要一个或另一个。

我面临的另一个问题是有时代码不会加载 android/images/ 文件夹。完全防弹的方法是使用我描述的代码，但将特定于密度的文件夹直接放在图像文件夹下，并通过 images/high/ 等引用它们。图像中的内容总是被复制，并且显示的代码始终有效，无论 Ti 版本如何。

最后一点，请确保您的图像命名区分大小写，因为它可以在 windows 模拟器中工作，但不能在实际（基于 unix 的）设备中工作。

# c# - Linq 按条件排序

> ID：12310952
> 
> 赞同：2
> 
> 时间：2012-09-07T02:31:35.223
> 
> 标签：c#, linq

我正在搜索图像列表，我想找到“最合适的”。即，如果图像集包含一个比`H`像素高的成像器，我想获得高度大于的*最短*`H`图像，如果图像集*不*包含高度大于 的图像`H`，那么我只想获取最高的整体图片。

这是我到目前为止所得到的：

```
var imageFile =
    from f in imageObj.Files
    orderby f.Height > height descending, f.Height ascending, f.Height descending
    select f; 
```

显然这是行不通的——我不知道如何在其中放置条件。

有什么建议么？

* * *

请注意，我的问题与可以预先评估条件的[问题](https://stackoverflow.com/questions/1606454/conditional-orderby-sort-order-in-linq)不同；我的取决于`f`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T02:39:07.510

`order by f.Height > height ? f.Height : 1000000 - f.Height`

首先是高于高度的图像，然后是低于高度的图像，以相反的顺序排列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T02:42:29.620

抱歉有任何错别字，我手边没有编译器，这行得通吗？

抓住所有那些>，orderB，取第一个，如果为null，取最大值？

```
 var greaterThan = imageObj.Files.Where( f => f.Height > height );
         var imageFile = greaterThan.OrderBy( f => f.Height ).FirstOrDefault() 
                     ??  imageObj.Files.OrderBy( f => f.Height ).FirstOrDefault(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T03:12:36.037

如果文件高于某个高度排序后，您可以按距该高度的距离排序：

```
var imageFile =
    from f in imageObj.Files
    orderby f.Height > height descending, Math.Abs(f.Height - height) ascending
    select f; 
```

# cakephp - 在路由文件中使用模型 cakephp

> ID：12310953
> 
> 赞同：3
> 
> 时间：2012-09-07T02:31:38.143
> 
> 标签：cakephp, cakephp-2.2

我希望在 /app/Config/routes.php 配置文件中从我的数据库中加载值。

在顶部我正在使用：`App::uses('Option', 'Model');`

我在班上打电话给我的发现：`$this->Option->find('all');`

我错过了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T10:22:44.330

我不会在 Routes 中放置任何数据库查询。这不是他们的地方（关注点分离等）。它还会减慢每个请求，并且路由不应该经常更改。

我所做的是每次创建/更新数据库路由时在 app/tmp/cache 中创建一个路由文件（您的代码会有所不同，但这就是我的做法）。

在您的路线模型中：

```
function rebuildCache() {

    $data = $this->find('all');

    $buffer = "<?php\n";

    $filename = TMP . 'cache' . DS . 'routes.php';

    foreach($data as $item) {

        $url = Router::parse('/' . $item['Route']['destination']);

        if (count($url['pass']) > 0) {

            $id = $url['pass'][count($url['pass']) - 1];

        }
        else {

            $id = null;

        }

        $buffer .= "Router::connect('/{$item['Route']['url']}', array('controller'=>'{$url['controller']}', 'action'=>'{$url['action']}', {$id}));\n";

    }

    file_put_contents($filename, $buffer);

} 
```

afterSave() 从你的路由模型调用rebuildCache()：

```
function afterSave() {

    $this->rebuildCache();  

} 
```

只需将文件包含在 Routes.php 中：

```
$routes_cache_filename = TMP . 'cache' . DS . 'routes.php';

if (file_exists($routes_cache_filename)) {

    require_once $routes_cache_filename;

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T02:51:04.497

我*认为*您必须在使用模型之前对其进行实例化：

```
App::uses('Option', 'Model');
$option = new Option();
$something = $option->find('all'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-17T06:51:01.383

```
 /*Load ClassRegistry*/
   App::uses('ClassRegistry', 'Utility');
  /**
   * Initialize model and perform find
   */
  $Cms = ClassRegistry::init('Cms'); 
  $cmsdata = $Cms->find('all'); 

  /**
   * Iterate over results and define routes
   */
  foreach ($cmsdata as $cmsrow) {
    Router::connect('/', array('controller' => $cmsrow['Cms']['controller'], 'action' => $cmsrow['Cms']['slug']));
  } 
```

# python - chilkat decryptStringENC TypeError：在方法'CkRsa_decryptStringENC'中

> ID：12310960
> 
> 赞同：0
> 
> 时间：2012-09-07T02:32:35.820
> 
> 标签：python, typeerror, chilkat

我下载了 64 位 Python 2.7 的试用版：chilkat-9.3.2-python-2.7-x86_64-linux.tar.gz。我发现了一个奇怪的问题：当我编写一种方法（如下所示的 decrypRSA() ）将解码给定的 RSA 加密字符串时，它只有在我直接在 linux 的命令行中调用它时才有效。当在其他方法中调用它来响应 http 请求时，它肯定会抛出异常。我没有在网站上找到任何解决此问题的问题。

```
Here is the exception stack track:

File "/data/api_test.xxx.com/0/v0/share/auth/utils.py", line 301, in decrypRSA
    return rsa.decryptStringENC(encodedText,False)
  File "/usr/local/lib/python2.7/site-packages/chilkat.py", line 1319, in decryptStringENC
    def decryptStringENC(self, *args): return _chilkat.CkRsa_decryptStringENC(self, *args)

TypeError: in method 'CkRsa_decryptStringENC', argument 2 of type 'char const *'

And here is the definition for decrypRSA() method:

    @staticmethod
    def decrypRSA(encodedText, publicKey):
        print ('Utils.decrypRSA()-parameters: encodeText=%s, public key=%s' % (encodedText, publicKey,))
        rsa = CkRsa()
        success = rsa.UnlockComponent("30-day trial")
        if (success != True):
            logging.info("Utils.decrypRSA(): RSA component unlock failed")
            return ''
        #  Import the public key into the RSA object:
        success = rsa.ImportPublicKey(publicKey)
        if (success != True):
            logging.info("Utils.decrypRSA(): RSA failed to import public key: %s" % rsa.lastErrorText())
            return ''
        rsa.put_EncodingMode("base64")
        rsa.put_LittleEndian(True)
        return rsa.decryptStringENC(encodedText,False) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T08:13:10.330

我不知道它是否是内部的，或者编码文本是否是您传入的东西。这可能是一个 unicode 字符串被强制转换为“char const *”以外的东西的问题。在这种情况下，您可以对字符串进行编码，也可以使用常规的 ascii 字符串代替 unicode 字符串。

看到这个：[https ://github.com/chokkan/simstring/issues/6](https://github.com/chokkan/simstring/issues/6)

# objective-c - Sharekit 未显示 Twitter、电子邮件、文本消息选项

> ID：12310961
> 
> 赞同：3
> 
> 时间：2012-09-07T02:32:38.420
> 
> 标签：objective-c, cocoa-touch, ios5, sharekit

我在版本 5 或更高版本的 iOS 应用程序上使用 ShareKit 2。我已将应用程序配置为正确使用 Facebook，当激活操作表时，这是唯一出现的选项。我想使用内置的 Twitter 共享系统，但该选项没有出现在操作表中。这是我的代码：

```
SURL *url = [NSURL URLWithString:launchUrl];
SHKItem *item = [SHKItem URL:url title:@"Title" contentType:SHKShareTypeURL];

SHKActionSheet *actionSheet = [SHKActionSheet actionSheetForItem:item];

[SHK setRootViewController:self.view.window.rootViewController];

[actionSheet showInView:self.view.window.rootViewController.view]; 
```

按照说明。我有一个自定义 DefaultSHKConfigurator 类，我想这些是相关的方法：

```
- (NSString*)sharersPlistName {
   return @"MySHKSharers.plist";
}

- (NSArray*)defaultFavoriteURLSharers {
   return [NSArray arrayWithObjects:@"SHKTwitter",@"SHKFacebook", @"SHKMail",  @"SHKTextMessage", nil];
} 
```

同样，只有 Facebook 出现作为一个选项。为了完整起见，这是我的“MySHKSharers.plist”文件（相关部分）：

```
<dict>
<key>actions</key>
<array>
    <string>SHKMail</string>
    <string>SHKTextMessage</string>
</array>
<key>services</key>
<array>
    <string>SHKTwitter</string>
    <string>SHKFacebook</string>
</array>
</dict> 
```

那么有什么想法为什么我不能让 Twitter、Mail 和 TextMessage 出现在操作表中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T15:48:15.983

如果您想配置操作表中显示的共享者，我发现这篇文章很有帮助：[https ://gist.github.com/1181552](https://gist.github.com/1181552)

我在获取要在默认操作表中显示的操作（电子邮件、短信等）时遇到了麻烦。我的解决方案是创建一个自定义操作表，然后像这样调用 Sharekit：

```
- (IBAction) getSharingSheet:(id)sender{
    UIActionSheet *sheet = [[UIActionSheet alloc] initWithTitle:@"Share"
                                                    delegate:self
                                                    cancelButtonTitle:@"Cancel"
                                                    destructiveButtonTitle:nil
                                                    otherButtonTitles:@"Facebook", @"Twitter", @"Save to Photo Library", @"Email", nil];
    [sheet showInView:self.view];
} 
```

然后是我的 didDismissWithButtonIndex：

```
- (void)actionSheet:(UIActionSheet *)actionSheet didDismissWithButtonIndex:(NSInteger)buttonIndex
{
    switch(buttonIndex)
    {
        case 0:
            SHKItem *item = //some item
            [SHKFacebook shareItem:item];
            break;
        case 1:
            SHKItem *item = //some item
            [SHKTwitter shareItem:item];
            break;
        case 2:
            SHKItem *item = //some item
            [SHKPhotoAlbum shareItem:item];
            break;
        case 3:
            SHKItem *item = //some item
            [SHKMail shareItem:item];
            break;
        default:
            break;
    }
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-25T20:38:46.603

我有同样的问题，刚刚解决了。这可能与您面临的问题相同，也可能不同。

在浏览了一下操作表是如何构建的之后，我发现在 SHK.m 中它正在从 NSUserDefaults 中提取存储的收藏夹。

```
+ (NSArray *)favoriteSharersForType:(SHKShareType)type
{
    NSArray *favoriteSharers = [[NSUserDefaults standardUserDefaults] objectForKey:[NSString stringWithFormat:@"%@%i", SHKCONFIG(favsPrefixKey), type]];
   ....
} 
```

这些存储的结果甚至优于您定义为“默认”收藏的共享服务。清除这些收藏夹可以解决问题。

# ruby-on-rails - 在 OR 而不是 AND 上合并 2 个关系

> ID：12310962
> 
> 赞同：3
> 
> 时间：2012-09-07T02:32:38.753
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我有这两段代码，每段代码都返回 Micropost 模型中的关系。

```
scope :including_replies, lambda { |user| where("microposts.in_reply_to = ?", user.id)}

def self.from_users_followed_by(user)
  followed_user_ids = user.followed_user_ids
  where("user_id IN (?) OR user_id = ?", followed_user_ids, user)
end 
```

当我运行时，`r1 = Micropost.including_replies(user)`我得到与以下 SQL 的两个结果的关系：

```
SELECT `microposts`.* FROM `microposts` WHERE (microposts.in_reply_to = 102) ORDER BY 
microposts.created_at DESC 
```

当我运行时，`r2 = Micropost.from_users_followed_by(user)`我得到一个与以下 SQL 的结果的关系：

```
SELECT `microposts`.* FROM `microposts` WHERE (user_id IN (NULL) OR user_id = 102) ORDER 
BY microposts.created_at DESC 
```

现在，当我像这样合并关系时，`r3 = r1.merge(r2)`我得到了零个结果，但期待三个。原因是 SQL 看起来像这样：

```
SELECT `microposts`.* FROM `microposts` WHERE (microposts.in_reply_to = 102) AND 
(user_id IN (NULL) OR user_id = 102) ORDER BY microposts.created_at DESC 
```

现在我需要的是在合并关系中`(microposts.in_reply_to = 102) OR (user_id IN (NULL) OR user_id = 102)` 我需要一个`OR`而不是一个。`AND`

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T03:55:38.663

不直接使用 Rails。Rails 没有公开任何将 ActiveRelation（作用域）对象与`OR`. 原因是 ActiveRelation 可能不仅包含条件（子句中描述的内容），而且还包含未明确定义`WHERE`合并的连接和其他 SQL 子句。`OR`

您可以直接使用 Arel（ActiveRelation 建立在其之上）来执行此操作，也可以使用[Squeel](https://github.com/ernie/squeel/)，它通过 DSL 公开 Arel 功能（这可能更方便）。对于 Squeel，ActiveRelations 不能被合并仍然是相关的。然而，Squeel 还提供了[Sifters](https://github.com/ernie/squeel/#sifters)，它表示您可以使用的条件（没有任何其他 SQL 子句）。不过，这将涉及将范围重写为筛选器。

# hadoop - 使用 HDFS copyFromLocalFile 时出现校验和错误

> ID：12310967
> 
> 赞同：0
> 
> 时间：2012-09-07T02:33:32.617
> 
> 标签：hadoop, checksum

```
 try {
        conf = new org.apache.hadoop.conf.Configuration();
        //conf.set("fs.default.name", "hdfs://zal:9000");
        hdfs = FileSystem.get(conf);
        Path src = new Path(urlTmpFile);
        Path dst = new Path(ipPath);
        hdfs.copyFromLocalFile(false, true, src, dst);
        //hdfs.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        log.error("updateLocalFileToHDFS failed" + e.getMessage() );
    } 
```

错误信息是校验和错误真的让我很困惑！

```
12/09/07 06:19:18 INFO fs.FSInputChecker: Found checksum error: b[0, 20]=687474703a2f2f77772e62616964752e636f6d0a
org.apache.hadoop.fs.ChecksumException: Checksum error: url.txt at 0 
```

有没有关于如何做到这一点的提示或示例？

# php - 我的 PHP 的 hash_algos() 函数不再起作用

> ID：12310970
> 
> 赞同：-2
> 
> 时间：2012-09-07T02:34:06.803
> 
> 标签：php, html, algorithm, hash

我不完全确定 PHP 的版本，但我认为它在 5.2（XAMPP 的相对新安装）中。我建立了一个网站，它严重依赖 php 函数 hash_algos() 来填充下拉列表，但最近似乎 hash_algos() 完全没有返回任何内容。此外，使用 Windows，如果 XAMPP 没有放弃它。

该网站过去可以工作，但现在不能了，我不知道为什么，我没有更改代码中的任何内容。这是网站中无法正常工作的部分

```
<select name="method" id="method">
<?
foreach(hash_algos() as $m)
{
echo "<option value=\"".$m."\">".$m."</option>";
}
?>
</select> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T02:37:03.913

您需要启用 Hash PECL 包。

这个问题可能对你有用：[How to switch hash_algos() on ? 我使用 PHP 5.2.11](https://stackoverflow.com/questions/3946638/how-to-switch-hash-algos-on-im-with-php-5-2-11)

编辑：由于您在 Windows 上，您可能必须自己编译“哈希”包。它似乎[在 PECL 网站上可用，但不再维护](http://pecl.php.net/package/hash)。

要从源代码编译，PHP 有一个[分步指南](https://wiki.php.net/internals/windows/stepbystepbuild)。

在您编译完 DLL 或获得一个 DLL 后，您需要将它添加到您的 php.ini 文件中。

您需要添加如下一行：

```
extension=php_hash.dll 
```

更多信息可在[PHP 的 Windows 站点上](http://php.net/manual/en/install.pecl.windows.php)找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-30T10:42:14.563

你忘记

```
<?php ?> 
```

语法如此

```
<html>
    <head></head>
    <body>
        <select name="method" id="method">
            <?php
                foreach(hash_algos() as $m)
                {
                    echo "<option value=\"".$m."\">".$m."</option>";
                }
            ?>
        </select>
    </body>
</html> 
```

启动服务器并运行。

# jsf - 如何强制托管 bean 首先初始化？

> ID：12310975
> 
> 赞同：3
> 
> 时间：2012-09-07T02:34:47.577
> 
> 标签：jsf

我为每个用户提供了一个导航托管 bean。

我需要它在任何其他bean之前先初始化，因为bean需要一个值。

我可以知道我该怎么做吗？

我已经尝试过`eager="true"`，但它不起作用。

任何通过 faceconfig 快速简便的解决方案将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T11:17:43.377

只需在 bean 的`@PostConstruct`.

```
@PostConstruct
public void init() {
    // Here.
} 
```

当 bean 第一次从另一个 bean 注入/引用时，它将被调用。

仅适用于应用程序范围的`eager=true`bean。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T02:57:54.127

从我看到的你应该引用另一个bean。让我们假设一个工具类可以从上下文中提取一个 bean。

基本上->

```
//Bean A
public void doSomething()
{
  String required = Utility.getBeanB().getRequiredValue();
  use(required);
}
...
//Bean B
public String getRequiredValue()
{
  return "Hi, I'm a required value";
} 
```

我有几个大型网络应用程序，它们有一个“会话 Bean”，可以存储用户偏好、共享对象等内容……而且这种方法效果很好。通过使用对 bean 的引用，您无需链接初始化。该方法将始终依赖于另一个 bean 中的方法，从而保证了初始化的顺序。

访问 bean 的方法有很多种，但我通常通过 EL 路由 ->

[在任何 Servlet 相关类中按名称获取 JSF 托管 bean](https://stackoverflow.com/questions/2633112/jsf-get-managed-bean-by-name)

祝你好运，我尽量保持“功能上的纯正”——我希望考虑到这种语言，我会发笑！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-03T15:28:58.957

这里有一些很酷的hax，以防其他解决方案由于各种情况对你不起作用......

假设我有一个`Alpha`要首先初始化的类：

```
public class Alpha {
    @PostConstruct
    public void init() {

    }
} 
```

我可以将以下方法放入`Alpha`：

```
@ManagedBean(name = "Alpha", eager = true)
public class Alpha {
    public static void requireAlpha() {
        FacesContext context = FacesContext.getCurrentInstance();
        Object alpha = context.getApplication().evaluateExpressionGet(context, "#{Alpha}", Object.class);
        System.out.println("Alpha required: " + alpha.toString());
    }

    @PostConstruct
    public void init() {

    }
} 
```

然后，在任何过早初始化的类中，只需调用：

```
Alpha.requireAlpha();
// ...
// (Code that requires Alpha to be initialized first.) 
```

如果有一个`ChildAlpha`扩展的类`Alpha`是您真正想要初始化的（而不是父类），请确保在`name=""`和 EL 表达式 ( `"#{}"`) 中都使用“ChildAlpha”。

有关更多信息，请参见此处：[在任何 Servlet 相关类中按名称获取 JSF 托管 bean](https://stackoverflow.com/questions/2633112/get-jsf-managed-bean-by-name-in-any-servlet-related-class)

# java - 检查字符串是否以某种模式结束

> ID：12310978
> 
> 赞同：60
> 
> 时间：2012-09-07T02:35:12.863
> 
> 标签：java, regex, string, pattern-matching

如果我有一个像这样的字符串：

```
This.is.a.great.place.too.work. 
```

或者：

```
This/is/a/great/place/too/work/ 
```

比我的程序应该给我的句子是有效的并且它具有“工作”。

如果我有 ：

```
This.is.a.great.place.too.work.hahahha 
```

或者：

```
This/is/a/great/place/too/work/hahahah 
```

那么我的程序不应该告诉我句子中有“工作”。

所以我正在查看java字符串以在句子末尾找到一个单词，它有或`.`之前。我怎样才能做到这一点？`,``/`

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2012-09-07T02:40:17.780

这真的很简单，[`String`](http://docs.oracle.com/javase/8/docs/api/java/lang/String.html)对象有一个[`endsWith`](http://docs.oracle.com/javase/8/docs/api/java/lang/String.html#endsWith-java.lang.String-)方法。

从您的问题来看，您似乎想要`/`,`,`或`.`作为分隔符集。

所以：

```
String str = "This.is.a.great.place.to.work.";

if (str.endsWith(".work.") || str.endsWith("/work/") || str.endsWith(",work,"))
     // ... 
```

您也可以使用该[`matches`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#matches%28java.lang.String%29)方法和一个相当简单的正则表达式来做到这一点：

```
if (str.matches(".*([.,/])work\\1$")) 
```

`[.,/]`使用指定句点、斜杠或逗号以及反向引用的字符类，`\1`以匹配找到的任何替代项（如果有）。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2012-09-07T02:49:05.603

您可以测试一个字符串是否以*work*结尾，后跟一个字符，如下所示：

```
theString.matches(".*work.$"); 
```

如果尾随字符是**可选**的，您可以使用：

```
theString.matches(".*work.?$"); 
```

要确保最后一个字符是句点`.`或斜杠`/`，您可以使用：

```
theString.matches(".*work[./]$"); 
```

要测试后跟**可选句点或斜线的***工作*，您可以使用以下命令：

 **```
theString.matches(".*work[./]?$"); 
```

要测试被句点**或斜线****包围的***工作* ，您可以这样做：

 ****```
theString.matches(".*[./]work[./]$"); 
```

如果*工作***前后的令牌** **必须相互​​匹配**，您可以这样做：

 ***```
theString.matches(".*([./])work\\1$"); 
```

* * *

您的确切要求没有精确定义，但我认为它会是这样的：

```
theString.matches(".*work[,./]?$"); 
```

换句话说：

*   零个或多个字符
*   其次是*工作*
*   后跟零或一`,` `.` **或** `/`
*   然后是输入的结尾

* * *

各种正则表达式项目的解释：

```
.               --  any character
*               --  zero or more of the preceeding expression
$               --  the end of the line/input
?               --  zero or one of the preceeding expression
[./,]           --  either a period or a slash or a comma
[abc]           --  matches a, b, or c
[abc]*          --  zero or more of (a, b, or c)
[abc]?          --  zero or one of (a, b, or c)

enclosing a pattern in parentheses is called "grouping"

([abc])blah\\1  --  a, b, or c followed by blah followed by "the first group" 
```

* * *

这是一个可以使用的测试工具：

```
class TestStuff {

    public static void main (String[] args) {

        String[] testStrings = { 
                "work.",
                "work-",
                "workp",
                "/foo/work.",
                "/bar/work",
                "baz/work.",
                "baz.funk.work.",
                "funk.work",
                "jazz/junk/foo/work.",
                "funk/punk/work/",
                "/funk/foo/bar/work",
                "/funk/foo/bar/work/",
                ".funk.foo.bar.work.",
                ".funk.foo.bar.work",
                "goo/balls/work/",
                "goo/balls/work/funk"
        };

        for (String t : testStrings) {
            print("word: " + t + "  --->  " + matchesIt(t));
        }
    }

    public static boolean matchesIt(String s) {
        return s.matches(".*([./,])work\\1?$");
    }

    public static void print(Object o) {
        String s = (o == null) ? "null" : o.toString();
        System.out.println(o);
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T02:42:26.667

当然，您可以使用[`StringTokenizer`](http://docs.oracle.com/javase/7/docs/api/java/util/StringTokenizer.html)该类将字符串与 '.' 分开。或'/'，并检查最后一个单词是否为“work”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-07T03:13:00.240

您可以使用子字符串方法：

```
 String aString = "This.is.a.great.place.too.work.";
   String aSubstring = "work";
   String endString = aString.substring(aString.length() - 
        (aSubstring.length() + 1),aString.length() - 1);
   if ( endString.equals(aSubstring) )
       System.out.println("Equal " + aString + " " + aSubstring);
   else
       System.out.println("NOT equal " + aString + " " + aSubstring); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-11T04:08:11.537

我尝试了这里提到的所有不同的方法来获取以`.`结尾的文件名中的字符索引`.[0-9][0-9]*`，例如`srcfile.1`，`srcfile.12`等等。没有任何效果。最后，以下工作： `int dotIndex = inputfilename.lastIndexOf(".");`

诡异的！这是使用 java -version：

```
openjdk version "1.8.0_131"
OpenJDK Runtime Environment (build 1.8.0_131-8u131-b11-0ubuntu1.16.10.2-b11)
OpenJDK 64-Bit Server VM (build 25.131-b11, mixed mode) 
```

此外，官方 Java 文档页面`regex`（在上面的答案之一中有一个引用）似乎没有指定如何查找该`.`字符。因为`\.`,`\\.`和`[.]`对我不起作用，除此之外我没有看到任何其他选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-28T02:26:36.620

```
 String input1 = "This.is.a.great.place.too.work.";
    String input2 = "This/is/a/great/place/too/work/";
    String input3 = "This,is,a,great,place,too,work,";
    String input4 = "This.is.a.great.place.too.work.hahahah";
    String input5 = "This/is/a/great/place/too/work/hahaha";
    String input6 = "This,is,a,great,place,too,work,hahahha";

    String regEx = ".*work[.,/]";

    System.out.println(input1.matches(regEx)); // true
    System.out.println(input2.matches(regEx)); // true
    System.out.println(input3.matches(regEx)); // true
    System.out.println(input4.matches(regEx)); // false
    System.out.println(input5.matches(regEx)); // false
    System.out.println(input6.matches(regEx)); // false 
```*********

# svn - 如何告诉 SVN 文件已被另一个工具重命名？

> ID：12310980
> 
> 赞同：4
> 
> 时间：2012-09-07T02:35:39.150
> 
> 标签：svn, rename

我将 Subversion 与一些由另一个应用程序管理的文件一起使用。我想重命名文件，但重命名必须在应用程序内完成，以便它正确更新自己的元数据。这意味着我不能简单地使用 SVN 的`rename`命令——应用程序的元数据会变得不一致。

那么我怎样才能告诉 SVN 工作副本中的文件已被此应用程序重命名，以便它以与`rename`命令相同的方式保留历史记录？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T22:33:52.177

你不需要指定你的环境，但是如果你在 Windows TortoiseSVN 上，它会为此提供一个鲜为人知且相当优雅的解决方案。假设您有一个文件 SuiteSetup.cs，您在应用程序中将其重命名为 SuiteSetup-Rev2.cs。

在 TortoiseSVN 上下文菜单上的**提交**或**检查修改**对话框中，选择旧名称（显示`missing`状态）和新名称（显示`non-versioned`状态），然后打开上下文菜单并选择**修复**移动（参考：[修复文件重命名](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-rename.html)）。如图所示，TortoiseSVN 进行所有的簿记更正以将它们转换为链接的删除-添加对，重命名或移动应该出现的方式。

*[改编自我的[TortoiseSVN 和 Subversion Cookbook，第 2 部分](http://www.simple-talk.com/dotnet/.net-framework/tortoisesvn-and-subversion-cookbook-part-2-file-operations-and-subversion-filtering/)，发表于 Simple-Talk.com。在撰写本文时，第 8 部分即将出版。]*

![修复文件移动](../Images/fe2544db9c3796e20c1150a3660d7fb3.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T13:12:11.310

您可以在事后模拟“仅记录”重命名，例如

```
rename newname oldname
svn rename oldname newname 
```

这将保留您的应用程序可能在文件中所做的任何更改，但允许 svn 在“旧名称”和“新名称”的历史记录之间建立联系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T03:37:04.160

我不认为你可以用当前的 SVN 做到这一点。使用 svn rename 命令的原因其实是因为你必须告诉 svn 重命名是什么，这样它才能准备相应的元数据。

除非 svn 改变它的设计来“猜测”你的重命名（比如 git），或者它提供一个只在元数据中执行更新的只记录重命名命令（你仍然需要弄清楚你的应用程序实际做了什么重命名并发出相应的命令） . 但是，此功能均不可用，并且至少在不久的将来也不太可能发生

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T12:31:37.900

据我所知，SVN cli 没有此功能，但 SmartSVN 有（您选择 2 个文件并按移动）。

# excel - 创建特定宏

> ID：12310981
> 
> 赞同：0
> 
> 时间：2012-09-07T02:35:41.890
> 
> 标签：excel, excel-2007, vba

我正在尝试使用 Excel 2007 为我收集的一些数据创建一个宏。我需要宏做的是，搜索一列并找到一定数量的连续零（60），如果有 60 个连续零，则删除它们。任何建议或帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T03:33:59.170

这是你正在尝试的吗？

**逻辑**：

1.  根据条件过滤范围
2.  将可见单元格上的地址存储在变量中
3.  删除 Excel 自动放入地址的“$”
4.  检查可见单元格地址是像“2:2”还是“2:2,5:64”
5.  找出开始行和结束行之间的差异
6.  如果差异 >= 说 60，则清除内容。

**代码**

```
Option Explicit

Sub Sample()
    Dim ws As Worksheet
    Dim lRow As Long, times As Long, Col As Long, i As Long
    Dim rRange As Range
    Dim addr As String, MyArray() As String, tmpAr() As String, num As String

    '~~> Change these as applicable
    Set ws = ThisWorkbook.Sheets("Sheet1")  '<~~ Sheet1
    Col = 1                                 '<~~ Col A
    num = "0"                               '<~~ Number to replace
    times = 60                              '<~~ Consecutive Cells with Numbers

    '~~> Don't change anything below this
    With ws
        lRow = .Range(ReturnName(Col) & .Rows.Count).End(xlUp).Row

        Set rRange = .Range(ReturnName(Col) & "1:" & ReturnName(Col) & lRow)

        '~~> Remove any filters
        .AutoFilterMode = False

        '~~> Filter, offset(to exclude headers)
        With rRange
          .AutoFilter Field:=1, Criteria1:="=" & num
          '~~> get the visible cells address
          addr = .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Address
        End With

        '~~> Remove any filters
        .AutoFilterMode = False

        addr = Replace(addr, "$", "")

        '~~> Check if addr has multiple ranges
        If InStr(1, addr, ",") Then
            MyArray = Split(addr, ",")

            '~~> get individual ranges
            For i = LBound(MyArray) To UBound(MyArray)
                tmpAr = Split(MyArray(i), ":")

                '~~> If difference is >= times then clear contents
                If Val(Trim(tmpAr(1))) - Val(Trim(tmpAr(0))) >= times - 1 Then
                    .Range(ReturnName(Col) & Trim(tmpAr(0)) & ":" & _
                    ReturnName(Col) & Trim(tmpAr(1))).ClearContents
                End If
            Next i
        Else
            tmpAr = Split(addr, ":")

            If Val(Trim(tmpAr(1))) - Val(Trim(tmpAr(0))) >= times - 1 Then
                .Range(ReturnName(Col) & Trim(tmpAr(0)) & ":" & _
                ReturnName(Col) & Trim(tmpAr(1))).ClearContents
            End If
        End If
    End With
End Sub

'~~~> Function to retrieve Col Names from Col Numbers
Function ReturnName(ByVal numb As Long) As String
    ReturnName = Split(Cells(, numb).Address, "$")(1)
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T03:16:25.283

虽然我有一种感觉，在你运行这个之后你会改变要求......

选择您要查看的所有单元格，然后运行以下代码：

```
Option Explicit

Sub deleteConsecutiveZeros()
    Dim rng As Excel.Range
    Dim countZeros As Long
    Dim lastCellRow As Long
    Dim iCurrentRow As Long

    Set rng = Selection
    lastCellRow = rng.Cells.SpecialCells(xlCellTypeLastCell).Row
    For iCurrentRow = lastCellRow To 1 Step -1
        If (countZeros >= 60) Then
            ActiveSheet.Range(rng.Cells(iCurrentRow + 59, 1).Address, rng.Cells(iCurrentRow, 1).Address).EntireRow.Delete
            countZeros = 0
        End If

        If (rng.Cells(iCurrentRow, 1).Value = 0 And rng.Cells(iCurrentRow, 1).Text <> vbNullString) Then
            countZeros = countZeros + 1
        Else
            countZeros = 0
        End If
    Next
End Sub 
```

# linux-kernel - 不跨越 2 次幂边界的 dma 映射

> ID：12310984
> 
> 赞同：1
> 
> 时间：2012-09-07T02:35:43.963
> 
> 标签：linux-kernel, linux-device-driver

我想为在我控制之外分配的内存缓冲区设置 DMA 映射。dma_map_single 似乎是要使用的正确 API，但我的硬件有一个限制，因此映射不能跨越某些二次幂边界，例如 1K。被映射的缓冲区的大小总是小于边界值，但在其他方面是可变的。所以看起来 DMA 池可能无法工作，因为它们需要固定大小，即使“分配”部分是我需要的。

我是否应该继续做 dma_map_single 并检查映射是否满足我的要求，如果不满足则释放映射？这会导致可能返回相同的映射，从而导致永无止境的搜索吗？如果是这样，我可以保留不合适的映射，直到找到合适的映射，然后一次性释放所有不合适的映射。然而，这些听起来并不是好主意。

有没有人有其他/更好的想法？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T22:35:05.517

如果您不能保证传递的缓冲区符合您的标准，您可能需要在 DMA 之前分配一个辅助缓冲区并复制到该缓冲区/从该缓冲区复制。在没有 IOMMU 或其他地址转换硬件的平台（例如经典 x86、ARM 等）上，DMA 映射操作实际上只是转换为物理地址。因此，如果您取消映射并使用相同的缓冲区重试，您将始终返回相同的 DMA 地址。

在大多数（所有？）其他确实有 IOMMU 的平台上，翻译仍然在块 >= PAGE_SIZE 上完成。换句话说，如果你在一个有 4K 页面的平台上，并且你在 0xABCDExxx 的缓冲区上进行 DMA 映射，你总是会得到一个像 0xFGHIJxxx 这样的 DMA 地址，其中地址“xxx”的低部分保持不变。（这是因为 IOMMU 像普通的 MMU 一样工作，只查找页面翻译，只保留低 12 位或其他任何位）

因此，基本上在所有平台上的所有情况下，您都不能使用 DMA API 来修复您传递的缓冲区的对齐方式。正如我所说，如果您传入的缓冲区不符合您的对齐要求，我认为唯一的选择是使用反弹缓冲区。DMA 池 API 是分配这些反弹缓冲区的好方法——如果您有时需要较小的缓冲区，这没问题；可以保留一些未使用的内存。

# sql - 合并两列并添加到一个新列中

> ID：12310986
> 
> 赞同：38
> 
> 时间：2012-09-07T02:36:02.303
> 
> 标签：sql, postgresql, null, concatenation

在 PostgreSQL 中，我想使用 SQL 语句来组合两列并从中创建一个新列。

我正在考虑使用`concat(...)`，但有更好的方法吗？
最好的方法是什么？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-09-07T14:45:06.223

一般来说，我同意[@kgrittn 的建议](https://stackoverflow.com/a/12311290/939860)。去吧。

但是要解决您的基本问题：如果您需要处理**null 值**[**`concat()`**](https://www.postgresql.org/docs/current/functions-string.html#FUNCTIONS-STRING-OTHER)，则新函数很有用-并且 null 在您的问题和您所指的问题中都没有被排除。`concat()`

 ****如果**您可以排除空值，那么旧的（SQL 标准）连接运算符[`||`](https://www.postgresql.org/docs/current/functions-string.html#FUNCTIONS-STRING-SQL)仍然是最佳选择，[@luis 的回答](https://stackoverflow.com/a/12311076/939860)很好：

```
SELECT col_a || col_b; 
```

**如果**您的任何一列可以为空，则在这种情况下结果将为空。您可以使用以下方法进行辩护`COALESCE`：

```
SELECT COALESCE(col_a, '') || COALESCE(col_b, ''); 
```

但是随着更多的争论，这很快就会变得乏味。这就是`concat()`进来的地方，它*永远不会*返回 null，即使*所有*参数都为 null。[根据文档](https://www.postgresql.org/docs/current/functions-string.html#FUNCTIONS-STRING-OTHER)：

> NULL 参数被忽略。

```
SELECT concat(col_a, col_b); 
```

两种选择的**剩余极端情况是*****所有*输入列都是 null**在这种情况下我们仍然得到一个空 string `''`，但可能需要 null 代替（至少我会）。一种可能的方式：

```
SELECT CASE
          WHEN col_a IS NULL THEN col_b
          WHEN col_b IS NULL THEN col_a
          ELSE col_a || col_b
       END; 
```

随着更多列的增加，这会变得更加复杂。再次，使用`concat()`但添加特殊条件的检查：

```
SELECT CASE WHEN (col_a, col_b) IS NULL THEN NULL
            ELSE concat(col_a, col_b) END; 
```

*这是如何运作的？*
`(col_a, col_b)`是行类型表达式的简写符号`ROW (col_a, col_b)`。*只有当所有*列都为空时，行类型才为空。详细解释：

*   [对一组列的 NOT NULL 约束](https://stackoverflow.com/questions/21021102/not-null-constraint-over-a-set-of-columns/21026085#21026085)

此外，用于[**`concat_ws()`**](https://www.postgresql.org/docs/current/functions-string.html)在元素之间添加分隔符（`ws`用于“带分隔符”）。

* * *

类似于凯文回答中的表达：

```
SELECT $1.zipcode || ' - ' || $1.city || ', ' || $1.state; 
```

`concat()`在 PostgreSQL 8.3（没有）中准备空值是很乏味的。一种方式（多种方式）：

```
SELECT COALESCE(
         CASE
            WHEN $1.zipcode IS NULL THEN $1.city
            WHEN $1.city    IS NULL THEN $1.zipcode
            ELSE $1.zipcode || ' - ' || $1.city
         END, '')
       || COALESCE(', ' || $1.state, ''); 
```

### 函数波动只是`STABLE`

`concat()`和`concat_ws()`是`STABLE`函数，而不是`IMMUTABLE`因为它们可以调用`timestamptz_out`依赖于语言环境设置的数据类型输出函数（如 ）。
[汤姆·莱恩的解释。](https://www.postgresql.org/message-id/flat/1409893231867-5817884.post@n5.nabble.com#1409893231867-5817884.post@n5.nabble.com)

这禁止它们在索引表达式中直接使用。如果您*知道*结果在您的情况下实际上是不可变的，则可以使用`IMMUTABLE`函数包装器解决此问题。这里的例子：

*   [PostgreSQL 是否支持“不区分重音”排序规则？](https://stackoverflow.com/questions/11005036/does-postgresql-support-accent-insensitive-collations/11007216#11007216)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-09-07T03:23:41.367

您无需存储该列即可以这种方式引用它。试试这个：

建立：

```
CREATE TABLE tbl
  (zipcode text NOT NULL, city text NOT NULL, state text NOT NULL);
INSERT INTO tbl VALUES ('10954', 'Nanuet', 'NY'); 
```

我们可以看到我们有“正确的东西”：

```
\pset border 2
SELECT * FROM tbl; 
```

```
+---------+--------+--------+
| 邮政编码 | 城市| 状态 |
+---------+--------+--------+
| 10954 | 纳努埃特 | 纽约 |
+---------+--------+--------+

```

现在添加一个具有所需“列名”的函数，该函数将表的记录类型作为其唯一参数：

```
CREATE FUNCTION combined(rec tbl)
  RETURNS text
  LANGUAGE SQL
AS $$
  SELECT $1.zipcode || ' - ' || $1.city || ', ' || $1.state;
$$; 
```

这将创建一个函数，只要指定了表名或别名，就可以将其用作表的列，如下所示：

```
SELECT *, tbl.combined FROM tbl; 
```

显示如下：

```
+---------+--------+--------+--------+
| 邮政编码 | 城市| 状态 | 结合 |
+---------+--------+--------+--------+
| 10954 | 纳努埃特 | 纽约 | 10954 - 纽约州纳努埃 |
+---------+--------+--------+--------+

```

这是因为 PostgreSQL 首先检查一个实际的列，但如果没有找到，并且标识符用关系名称或别名限定，它会查找类似上面的函数，并以行作为参数运行它，返回结果就好像它是一列一样。如果您愿意，您甚至可以对这样的“生成的列”进行索引。

因为您没有在每行中为重复数据使用额外空间，也没有在所有插入和更新上触发触发器，所以这通常比其他方法更快。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-09-07T02:49:58.810

您是否检查了字符串连接功能？就像是：

```
update table_c set column_a = column_b || column_c 
```

应该管用。更多[在这里](http://www.postgresql.org/docs/8.3/static/functions-string.html)**

# jquery - mvc3客户端验证未触发

> ID：12310995
> 
> 赞同：0
> 
> 时间：2012-09-07T02:37:04.853
> 
> 标签：jquery, asp.net-mvc-3, validation, client-side

（2012 年 9 月 14 日更新）

这是我的控制器：

```
<HttpPost()> _
Public Function Login(ByVal viewmodel As LoginViewModel) As ActionResult
    Dim result As New LoginResponse()
    Try
        Dim objUserCredentialsType As UserCredentialsType = UserProfileType.Login(viewmodel.UserName, viewmodel.Password, 0, CStr(AppSettings("softwareLicense")))
        'store user credentials in session
        HttpContext.Session.Add("_CurrentUserCredentials", objUserCredentialsType)
        FormsAuthentication.SetAuthCookie(viewmodel.UserName, viewmodel.RememberMe)
        result.Status = "Success"
        result.ReturnUrl = "~/Account/Welcome"
        Return Json(result)
    Catch ex As Exception
        result.Status = "Failed"
        result.Errors.Add(ExceptionWrapper.Wrap(ex).ExceptionMessage())
        Return Json(result)
    End Try
End Function

Public Class LoginResponse
    Public Property Status() As String
        Get
            Return m_Status
        End Get
        Set(value As String)
            m_Status = Value
        End Set
    End Property
    Private m_Status As String
    Public Property Errors() As List(Of String)
        Get
            Return m_Errors
        End Get
        Set(value As List(Of String))
            m_Errors = Value
        End Set
    End Property
    Private m_Errors As List(Of String)
    Public Property ReturnUrl() As String
        Get
            Return m_ReturnUrl
        End Get
        Set(value As String)
            m_ReturnUrl = value
        End Set
    End Property
    Private m_ReturnUrl As String
    Public Sub New()
        Errors = New List(Of String)()
    End Sub
End Class 
```

这是我的看法：

```
<section id="login">
    <div id="login-form-container" class="span6">
        @Using (Ajax.BeginForm("Login", "Account", Nothing, New AjaxOptions With {.HttpMethod = "post", .OnBegin = "LoginFormAjaxValidate"}, New With {.id = "login-form"}))
            @<fieldset>
                <legend>Log in to your account now</legend>
                <div class="row-fluid">
                    <div class="span12">
                        @Html.LabelFor(Function(m) m.UserName)
                        @Html.TextBoxFor(Function(m) m.UserName, New With {.class = "span12", .placeholder = "Username"})
                        @Html.ValidationMessageFor(Function(m) m.UserName)
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span12">
                        <label for="Password">Your password</label>
                        @Html.PasswordFor(Function(m) m.Password, New With {.class = "span12", .placeholder = "Password", .type = "password"})
                        @Html.ValidationMessageFor(Function(m) m.Password)
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span12">
                        <label for="RememberMe" class="checkbox clearfix">
                            @Html.CheckBoxFor(Function(m) m.RememberMe)
                            Remember me next time I visit
                        </label>
                    </div>
                </div>
                <button id="login-submit" type="submit" class="btn btn-primary input-small" value="submit">Log in</button>
            </fieldset>
        End Using                                  
    </div>
</section> 
```

这是视图底部的脚本：

```
<script type="text/javascript">
function LoginFormAjaxValidate() {
    $("#login-form").serialize(), function (r) {
        if (r.Status == "Success") {
            top.location.href = "@Url.Content("~/Account/Welcome")";
        }
        else {
            //Lets get the Errors from our JSON
            $.each(r.Errors, function (index, item) {
                alert(r.item);
            });
        }
    }
}
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T04:05:22.813

我不做 VB，但这是我的视图模型和 ActionMethod 在 c# 中的样子

确保您正确包含以下 javascript 文件

jquery.unobtrusive-ajax jquery.validate.unobtrusive jquery.validate

还要检查视图模型上的注释。查看呈现的 html 并确保您看到正在呈现的数据验证属性。

EX 输出应如下所示：

```
<input data-val="true" data-val-email="Invalid E-Mail Address" data-val-required="E-Mail Address is required" id="UserName" name="UserName" type="email" value="" />&nbsp;<span class="field-validation-valid" data-valmsg-for="UserName" data-valmsg-replace="true"> 
```

其余的 Ajax 选项在哪里？我看到的只是回电？？

```
 @using (Ajax.BeginForm("SignIn", "Account", null, new AjaxOptions
                                                      {
                                                          HttpMethod = "post",
                                                          UpdateTargetId = "ajax-sign-in",
                                                          InsertionMode = InsertionMode.Replace,
                                                          OnSuccess = "Success"
                                                      }, new {@autocomplete = "on"}))
{
 YOUR FORM HTML...... HERE
}

public class AccountSignInViewModel
{
    [Display(Name = "E-Mail Address")]
    [Required(ErrorMessage = "E-Mail Address is required")]
    [EmailAddress(ErrorMessage = "Invalid E-Mail Address")]
    public string UserName { get; set; }
    [Required(ErrorMessage = "Please enter a password")]
    [Display(Name = "Password")]
    public string Password { get; set; }
    [Display(Name = "Remember My Login?")]
    public bool RemeberLogin { get; set; }
}

 [HttpPost]
    public ActionResult SignIn(AccountSignInViewModel accountSignInViewModel)
    {
        if (ModelState.IsValid)
        {
            // DO SOME AUTHENTICATION STUFFS
        }
        return PartialView("_LocalSignIn");
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T12:02:01.643

通过在提交功能上手动发送表单，您不允许验证器启动。因此，您绕过了验证器及其所有不显眼的细节。

如果您想进行 ajax 回发，请改用 Ajax.BeginForm 帮助程序。它将为您提供在加载时执行阻止表单所需的钩子，并且还有一个 onsuccess 回调来执行重定向。

如果没有启用 javascript，那么它将恢复为正常形式，并且将调用 action 方法，您的控制器可以处理并适当地返回。

例子：

```
<script type="text/javascript">
    function formSuccess(result, status, xhr) {
        // result has the response object
    }

    function formFailed(xhr, status, result) {
        // params are flipped in the error handler, not sure why
    }

    function formBegin(object, xhr) {
        // return false in here if you don't want to submit the form
        return true;
    }
</script>
@using(Ajax.BeginForm("Action", "Controller", new {id = 1 /* route values */ },new AjaxOptions{ OnBegin = "formBegin", OnSuccess = "formSuccess", OnFailure = "formFailure"}, new { @class="form"/* html attributes */ } ))
{
    @*
        put your form bits in here
     *@
} 
```

硅

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T13:46:05.197

尝试添加这个：

```
function ajaxValidate() {
   return $('my-login-form').validate().form();
} 
```

并将您的表单声明更改为：

```
@Using (Ajax.BeginForm("Login", "Account", Nothing,
    New AjaxOptions With {.HttpMethod = "post",
    .UpdateTargetId = "login-form",
    .OnBegin="ajaxValidate",
    .OnSuccess = "LoginFormSuccess"},
    New With { .id = "my-login-form"})) 
```

另外，为了勇敢，我会将您的 div id="login-form" 重命名为 id="login-form-container"。如果您选择重命名该 div，则只需在 cs 和 js 代码中将“my-login-form”更新为“login-form”。

# drupal - 重用图像FIELDS在D7的文本区域插入图像？

> ID：12310996
> 
> 赞同：2
> 
> 时间：2012-09-07T02:37:35.057
> 
> 标签：drupal, wysiwyg, media, reusability, imagefield

我正在尝试建立一个包含两种主要内容类型的网站：

*   图片库（基于节点和图片字段和视图）
*   一些基于文本的内容类型，如博客

工作流程将是：

1.  在我的画廊上传和安排一些图像。
2.  创建一个博客条目并在文本中插入一些图像。

问题是我所有的图像都将通过**节点进行管理，没有一个会直接上传到服务器**。我想要一些所见即所得的编辑器，带有一个用于浏览我的画廊（**而不是服务器文件系统**）的按钮，并在 Drupal 中使用图像大小预设（以前的 ImageCache）。到目前为止，我发现的最佳选择是：

**Image Assist** ( [http://drupal.org/project/img_assist](http://drupal.org/project/img_assist) ) 在这种情况下是理想的，因为它支持视图（在开发中），并且可以配置为浏览我的自定义画廊类型节点。问题是它不受支持（没有支持 Views 的稳定版本，也无意移植到 D7）。

**图像浏览器**( [http://drupal.org/project/imagebrowser](http://drupal.org/project/imagebrowser) ) 是另一个不错的浏览器，但也不支持它，并且有 D7 版本。

我还尝试了**媒体和媒体库**，因为它们提供了一个可能满足我需求的图像浏览器，但发现了一些我无法使用它们的问题：

媒体库允许我在画廊中组织我的图像，但媒体模块提供的浏览器并不关心画廊：它以无穷无尽的页面序列显示所有图像。如果我有数百张图片（我会的），这没有任何意义。为了克服这个缺陷，Media 的 2.x 分支提供了 Views 支持。然而，媒体库尚未与该分支合作，并且已经有一年多的时间了；-(

**我的问题是：对于 Drupal 7，Image Assist 和 Image Browser 模块现在有哪些替代品？**

IMCE 之类的东西对我来说没有多大意义，因为它们适用于浏览文件系统，不一定使用 D7 图像大小预设，也没有 Views 支持。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T11:26:57.197

您可以使用[INSERT](http://drupal.org/project/insert)模块；它可以让您在正文字段中插入照片。
[Colorbox](http://drupal.org/project/colorbox)和[Media](http://drupal.org/project/media)也很棒。
祝你好运

# objective-c - 未找到 MediaPlayer/Mediaplayer.h 文件

> ID：12310998
> 
> 赞同：3
> 
> 时间：2012-09-07T02:37:44.607
> 
> 标签：objective-c, video, media-player

我正在尝试在我的 ViewController 中播放视频。Mediaplayer.framework 和所有标题都在我的 Frameworks 文件夹中，包括 MediaPlayer.h 文件。但是当我把

```
#import "TutorialViewController.h"
#import <MediaPlayer/MediaPlayer.h>

@interface TutorialViewController ()

@end

@implementation TutorialViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
[super viewDidLoad];

    MPMoviePlayerController *player =
    [[MPMoviePlayerController alloc]
     initWithContentURL:[NSURL fileURLWithPath:url]];

    [[NSNotificationCenter defaultCenter]
     addObserver:self
     selector:@selector(movieFinishedCallback:)
     name:MPMoviePlayerPlaybackDidFinishNotification
     object:player];

    //---play movie---
    [player play];
    [super viewDidLoad];
}

- (void) movieFinishedCallback:(NSNotification*) aNotification {
    MPMoviePlayerController *player = [aNotification object];
    [[NSNotificationCenter defaultCenter]
     removeObserver:self
     name:MPMoviePlayerPlaybackDidFinishNotification
     object:player];

// Do any additional setup after loading the view.
}

- (void)viewDidUnload
{
[super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:        (UIInterfaceOrientation)interfaceOrientation
{
return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

@end 
```

在我的 .m 文件中，我收到一条错误消息，指出找不到“MediaPlayer/MediaPlayer.h”文件。这是什么意思，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T02:52:47.650

从项目中删除框架并重新添加它应该可以解决这个问题。我建议你做的是打开你的项目目录，并确保当你将框架添加到你的项目时，你只引用了框架而不是复制它。如果框架存在于您的项目文件夹中，则将其删除，否则只需从您的项目中删除它的引用。

然后导航到：

> 项目导航器>>您的应用程序目标>>摘要选项卡（滚动到底部）

单击“Linked Frameworks”下的“+”，然后您可以从这里将对框架的引用重新添加到您的项目中。

![在此处输入图像描述](../Images/cb779d2ef3fa5b2ef96147b5b0717282.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-13T13:49:07.463

我希望上述一些解决方案对其他人有用......不幸的是，他们在这种情况下没有为我工作

但是......这确实对我有用......它有点“hacky”但它再次建立了项目（我现在可能刚刚达到我的最后期限）

我使用了我需要的头文件的绝对完整路径，例如

```
 #import "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS6.1.sdk/System/Library/Frameworks/MediaPlayer.framework/Headers/MediaPlayer.h" 
```

这摆脱了那个讨厌的！感叹号“找不到文件”。我将继续调查原因，因为这清楚地指出了 xCode 中的一些路径问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-03T21:35:31.063

我相信 OP 缺少`UIKit`包含。这就是发生在我身上的事。即使该框架已包含在项目中，它也会给出与上述相同的错误。